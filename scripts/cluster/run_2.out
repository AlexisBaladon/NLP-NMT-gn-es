[2023-07-26 01:02:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:02:42] [marian] Running on node19.datos.cluster.uy as process 27986 with command line:
[2023-07-26 01:02:42] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:02:42] [config] after: 0e
[2023-07-26 01:02:42] [config] after-batches: 0
[2023-07-26 01:02:42] [config] after-epochs: 10
[2023-07-26 01:02:42] [config] all-caps-every: 0
[2023-07-26 01:02:42] [config] allow-unk: false
[2023-07-26 01:02:42] [config] authors: false
[2023-07-26 01:02:42] [config] beam-size: 12
[2023-07-26 01:02:42] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:02:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:02:42] [config] bert-masking-fraction: 0.15
[2023-07-26 01:02:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:02:42] [config] bert-train-type-embeddings: true
[2023-07-26 01:02:42] [config] bert-type-vocab-size: 2
[2023-07-26 01:02:42] [config] build-info: ""
[2023-07-26 01:02:42] [config] check-gradient-nan: false
[2023-07-26 01:02:42] [config] check-nan: false
[2023-07-26 01:02:42] [config] cite: false
[2023-07-26 01:02:42] [config] clip-norm: 1
[2023-07-26 01:02:42] [config] cost-scaling:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] cost-type: ce-sum
[2023-07-26 01:02:42] [config] cpu-threads: 0
[2023-07-26 01:02:42] [config] data-threads: 8
[2023-07-26 01:02:42] [config] data-weighting: ""
[2023-07-26 01:02:42] [config] data-weighting-type: sentence
[2023-07-26 01:02:42] [config] dec-cell: gru
[2023-07-26 01:02:42] [config] dec-cell-base-depth: 2
[2023-07-26 01:02:42] [config] dec-cell-high-depth: 1
[2023-07-26 01:02:42] [config] dec-depth: 1
[2023-07-26 01:02:42] [config] devices:
[2023-07-26 01:02:42] [config]   - 0
[2023-07-26 01:02:42] [config]   - 1
[2023-07-26 01:02:42] [config] dim-emb: 512
[2023-07-26 01:02:42] [config] dim-rnn: 1024
[2023-07-26 01:02:42] [config] dim-vocabs:
[2023-07-26 01:02:42] [config]   - 0
[2023-07-26 01:02:42] [config]   - 0
[2023-07-26 01:02:42] [config] disp-first: 0
[2023-07-26 01:02:42] [config] disp-freq: 1000u
[2023-07-26 01:02:42] [config] disp-label-counts: true
[2023-07-26 01:02:42] [config] dropout-rnn: 0
[2023-07-26 01:02:42] [config] dropout-src: 0
[2023-07-26 01:02:42] [config] dropout-trg: 0
[2023-07-26 01:02:42] [config] dump-config: ""
[2023-07-26 01:02:42] [config] dynamic-gradient-scaling:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] early-stopping: 200
[2023-07-26 01:02:42] [config] early-stopping-on: first
[2023-07-26 01:02:42] [config] embedding-fix-src: false
[2023-07-26 01:02:42] [config] embedding-fix-trg: false
[2023-07-26 01:02:42] [config] embedding-normalization: false
[2023-07-26 01:02:42] [config] embedding-vectors:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] enc-cell: gru
[2023-07-26 01:02:42] [config] enc-cell-depth: 1
[2023-07-26 01:02:42] [config] enc-depth: 1
[2023-07-26 01:02:42] [config] enc-type: bidirectional
[2023-07-26 01:02:42] [config] english-title-case-every: 0
[2023-07-26 01:02:42] [config] exponential-smoothing: 0
[2023-07-26 01:02:42] [config] factor-weight: 1
[2023-07-26 01:02:42] [config] factors-combine: sum
[2023-07-26 01:02:42] [config] factors-dim-emb: 0
[2023-07-26 01:02:42] [config] gradient-checkpointing: false
[2023-07-26 01:02:42] [config] gradient-norm-average-window: 100
[2023-07-26 01:02:42] [config] guided-alignment: none
[2023-07-26 01:02:42] [config] guided-alignment-cost: mse
[2023-07-26 01:02:42] [config] guided-alignment-weight: 0.1
[2023-07-26 01:02:42] [config] ignore-model-config: false
[2023-07-26 01:02:42] [config] input-types:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] interpolate-env-vars: false
[2023-07-26 01:02:42] [config] keep-best: false
[2023-07-26 01:02:42] [config] label-smoothing: 0
[2023-07-26 01:02:42] [config] layer-normalization: false
[2023-07-26 01:02:42] [config] learn-rate: 0.0001
[2023-07-26 01:02:42] [config] lemma-dependency: ""
[2023-07-26 01:02:42] [config] lemma-dim-emb: 0
[2023-07-26 01:02:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:02:42] [config] log-level: info
[2023-07-26 01:02:42] [config] log-time-zone: ""
[2023-07-26 01:02:42] [config] logical-epoch:
[2023-07-26 01:02:42] [config]   - 1e
[2023-07-26 01:02:42] [config]   - 0
[2023-07-26 01:02:42] [config] lr-decay: 0
[2023-07-26 01:02:42] [config] lr-decay-freq: 50000
[2023-07-26 01:02:42] [config] lr-decay-inv-sqrt:
[2023-07-26 01:02:42] [config]   - 0
[2023-07-26 01:02:42] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:02:42] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:02:42] [config] lr-decay-start:
[2023-07-26 01:02:42] [config]   - 10
[2023-07-26 01:02:42] [config]   - 1
[2023-07-26 01:02:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:02:42] [config] lr-report: false
[2023-07-26 01:02:42] [config] lr-warmup: 0
[2023-07-26 01:02:42] [config] lr-warmup-at-reload: false
[2023-07-26 01:02:42] [config] lr-warmup-cycle: false
[2023-07-26 01:02:42] [config] lr-warmup-start-rate: 0
[2023-07-26 01:02:42] [config] max-length: 50
[2023-07-26 01:02:42] [config] max-length-crop: false
[2023-07-26 01:02:42] [config] max-length-factor: 3
[2023-07-26 01:02:42] [config] maxi-batch: 100
[2023-07-26 01:02:42] [config] maxi-batch-sort: trg
[2023-07-26 01:02:42] [config] mini-batch: 64
[2023-07-26 01:02:42] [config] mini-batch-fit: false
[2023-07-26 01:02:42] [config] mini-batch-fit-step: 10
[2023-07-26 01:02:42] [config] mini-batch-round-up: true
[2023-07-26 01:02:42] [config] mini-batch-track-lr: false
[2023-07-26 01:02:42] [config] mini-batch-warmup: 0
[2023-07-26 01:02:42] [config] mini-batch-words: 0
[2023-07-26 01:02:42] [config] mini-batch-words-ref: 0
[2023-07-26 01:02:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:02:42] [config] multi-loss-type: sum
[2023-07-26 01:02:42] [config] n-best: false
[2023-07-26 01:02:42] [config] no-nccl: false
[2023-07-26 01:02:42] [config] no-reload: false
[2023-07-26 01:02:42] [config] no-restore-corpus: false
[2023-07-26 01:02:42] [config] normalize: 0
[2023-07-26 01:02:42] [config] normalize-gradient: false
[2023-07-26 01:02:42] [config] num-devices: 0
[2023-07-26 01:02:42] [config] optimizer: adam
[2023-07-26 01:02:42] [config] optimizer-delay: 1
[2023-07-26 01:02:42] [config] optimizer-params:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] output-omit-bias: false
[2023-07-26 01:02:42] [config] overwrite: true
[2023-07-26 01:02:42] [config] precision:
[2023-07-26 01:02:42] [config]   - float32
[2023-07-26 01:02:42] [config]   - float32
[2023-07-26 01:02:42] [config] pretrained-model: ""
[2023-07-26 01:02:42] [config] quantize-biases: false
[2023-07-26 01:02:42] [config] quantize-bits: 0
[2023-07-26 01:02:42] [config] quantize-log-based: false
[2023-07-26 01:02:42] [config] quantize-optimization-steps: 0
[2023-07-26 01:02:42] [config] quiet: false
[2023-07-26 01:02:42] [config] quiet-translation: true
[2023-07-26 01:02:42] [config] relative-paths: false
[2023-07-26 01:02:42] [config] right-left: false
[2023-07-26 01:02:42] [config] save-freq: 10000u
[2023-07-26 01:02:42] [config] seed: 1234
[2023-07-26 01:02:42] [config] sentencepiece-alphas:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:02:42] [config] sentencepiece-options: ""
[2023-07-26 01:02:42] [config] sharding: global
[2023-07-26 01:02:42] [config] shuffle: data
[2023-07-26 01:02:42] [config] shuffle-in-ram: false
[2023-07-26 01:02:42] [config] sigterm: save-and-exit
[2023-07-26 01:02:42] [config] skip: false
[2023-07-26 01:02:42] [config] sqlite: ""
[2023-07-26 01:02:42] [config] sqlite-drop: false
[2023-07-26 01:02:42] [config] sync-freq: 200u
[2023-07-26 01:02:42] [config] sync-sgd: false
[2023-07-26 01:02:42] [config] tempdir: /tmp
[2023-07-26 01:02:42] [config] tied-embeddings: false
[2023-07-26 01:02:42] [config] tied-embeddings-all: false
[2023-07-26 01:02:42] [config] tied-embeddings-src: false
[2023-07-26 01:02:42] [config] train-embedder-rank:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] train-sets:
[2023-07-26 01:02:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:02:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:02:42] [config] transformer-aan-activation: swish
[2023-07-26 01:02:42] [config] transformer-aan-depth: 2
[2023-07-26 01:02:42] [config] transformer-aan-nogate: false
[2023-07-26 01:02:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:02:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:02:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:02:42] [config] transformer-depth-scaling: false
[2023-07-26 01:02:42] [config] transformer-dim-aan: 2048
[2023-07-26 01:02:42] [config] transformer-dim-ffn: 2048
[2023-07-26 01:02:42] [config] transformer-dropout: 0
[2023-07-26 01:02:42] [config] transformer-dropout-attention: 0
[2023-07-26 01:02:42] [config] transformer-dropout-ffn: 0
[2023-07-26 01:02:42] [config] transformer-ffn-activation: swish
[2023-07-26 01:02:42] [config] transformer-ffn-depth: 2
[2023-07-26 01:02:42] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:02:42] [config] transformer-heads: 8
[2023-07-26 01:02:42] [config] transformer-no-projection: false
[2023-07-26 01:02:42] [config] transformer-pool: false
[2023-07-26 01:02:42] [config] transformer-postprocess: dan
[2023-07-26 01:02:42] [config] transformer-postprocess-emb: d
[2023-07-26 01:02:42] [config] transformer-postprocess-top: ""
[2023-07-26 01:02:42] [config] transformer-preprocess: ""
[2023-07-26 01:02:42] [config] transformer-tied-layers:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] transformer-train-position-embeddings: false
[2023-07-26 01:02:42] [config] tsv: false
[2023-07-26 01:02:42] [config] tsv-fields: 0
[2023-07-26 01:02:42] [config] type: s2s
[2023-07-26 01:02:42] [config] ulr: false
[2023-07-26 01:02:42] [config] ulr-dim-emb: 0
[2023-07-26 01:02:42] [config] ulr-dropout: 0
[2023-07-26 01:02:42] [config] ulr-keys-vectors: ""
[2023-07-26 01:02:42] [config] ulr-query-vectors: ""
[2023-07-26 01:02:42] [config] ulr-softmax-temperature: 1
[2023-07-26 01:02:42] [config] ulr-trainable-transformation: false
[2023-07-26 01:02:42] [config] unlikelihood-loss: false
[2023-07-26 01:02:42] [config] valid-freq: 50000000
[2023-07-26 01:02:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:02:42] [config] valid-max-length: 1000
[2023-07-26 01:02:42] [config] valid-metrics:
[2023-07-26 01:02:42] [config]   - cross-entropy
[2023-07-26 01:02:42] [config]   - translation
[2023-07-26 01:02:42] [config] valid-mini-batch: 32
[2023-07-26 01:02:42] [config] valid-reset-stalled: false
[2023-07-26 01:02:42] [config] valid-script-args:
[2023-07-26 01:02:42] [config]   []
[2023-07-26 01:02:42] [config] valid-script-path: ""
[2023-07-26 01:02:42] [config] valid-sets:
[2023-07-26 01:02:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:02:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:02:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:02:42] [config] vocabs:
[2023-07-26 01:02:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:02:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:02:42] [config] word-penalty: 0
[2023-07-26 01:02:42] [config] word-scores: false
[2023-07-26 01:02:42] [config] workspace: 2048
[2023-07-26 01:02:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:02:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:02:42] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:02:42] Using asynchronous training
[2023-07-26 01:02:43] Synced seed 1234
[2023-07-26 01:02:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:02:44] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:02:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:02:44] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:02:44] [valid] No post-processing script given for validating translator
[2023-07-26 01:02:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:02:44] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:02:46] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:02:46] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:02:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:02:46] [comm] Using global sharding
[2023-07-26 01:02:46] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:02:46] [training] Using 2 GPUs
[2023-07-26 01:02:46] Training started
[2023-07-26 01:02:46] [data] Shuffling data
[2023-07-26 01:02:46] [data] Done reading 20,192 sentences
[2023-07-26 01:02:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:02:46] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:02:46] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:02:46] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:02:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:02:52] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:02:52] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:02:52] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:02:52] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:02:52] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:02:52] Allocating memory for Adam-specific shards
[2023-07-26 01:02:52] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:02:52] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:02:52] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:02:52] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:03:20] Seen 18,587 samples
[2023-07-26 01:03:20] Starting data epoch 2 in logical epoch 2
[2023-07-26 01:03:20] [data] Shuffling data
[2023-07-26 01:03:20] [data] Done reading 20,192 sentences
[2023-07-26 01:03:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:03:48] Seen 18,843 samples
[2023-07-26 01:03:48] Starting data epoch 3 in logical epoch 3
[2023-07-26 01:03:48] [data] Shuffling data
[2023-07-26 01:03:48] [data] Done reading 20,192 sentences
[2023-07-26 01:03:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:04:17] Seen 18,843 samples
[2023-07-26 01:04:17] Starting data epoch 4 in logical epoch 4
[2023-07-26 01:04:17] [data] Shuffling data
[2023-07-26 01:04:17] [data] Done reading 20,192 sentences
[2023-07-26 01:04:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:04:28] Ep. 4 : Up. 1000 : Sen. 7,188 : Cost 6.35905981 * 1,343,216 @ 768 after 1,343,216 : Time 104.30s : 12878.00 words/s : gNorm 0.0000
[2023-07-26 01:04:46] Seen 18,843 samples
[2023-07-26 01:04:46] Starting data epoch 5 in logical epoch 5
[2023-07-26 01:04:46] [data] Shuffling data
[2023-07-26 01:04:46] [data] Done reading 20,192 sentences
[2023-07-26 01:04:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:05:15] Seen 18,843 samples
[2023-07-26 01:05:15] Starting data epoch 6 in logical epoch 6
[2023-07-26 01:05:15] [data] Shuffling data
[2023-07-26 01:05:15] [data] Done reading 20,192 sentences
[2023-07-26 01:05:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:05:44] Seen 18,843 samples
[2023-07-26 01:05:44] Starting data epoch 7 in logical epoch 7
[2023-07-26 01:05:44] [data] Shuffling data
[2023-07-26 01:05:44] [data] Done reading 20,192 sentences
[2023-07-26 01:05:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:06:06] Ep. 7 : Up. 2000 : Sen. 14,138 : Cost 5.38136387 * 1,333,361 @ 1,408 after 2,676,577 : Time 98.22s : 13575.71 words/s : gNorm 0.0000
[2023-07-26 01:06:14] Seen 18,843 samples
[2023-07-26 01:06:14] Starting data epoch 8 in logical epoch 8
[2023-07-26 01:06:14] [data] Shuffling data
[2023-07-26 01:06:14] [data] Done reading 20,192 sentences
[2023-07-26 01:06:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:06:43] Seen 18,886 samples
[2023-07-26 01:06:43] Starting data epoch 9 in logical epoch 9
[2023-07-26 01:06:43] [data] Shuffling data
[2023-07-26 01:06:43] [data] Done reading 20,192 sentences
[2023-07-26 01:06:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:07:12] Seen 18,835 samples
[2023-07-26 01:07:12] Starting data epoch 10 in logical epoch 10
[2023-07-26 01:07:12] [data] Shuffling data
[2023-07-26 01:07:12] [data] Done reading 20,192 sentences
[2023-07-26 01:07:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:07:42] Seen 18,808 samples
[2023-07-26 01:07:42] Starting data epoch 11 in logical epoch 11
[2023-07-26 01:07:42] Training finished
[2023-07-26 01:07:45] [valid] Ep. 11 : Up. 2968 : cross-entropy : 106.618 : new best
[2023-07-26 01:08:48] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-26 01:08:48] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:08:52] Saving Adam parameters
[2023-07-26 01:08:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:09:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:09:07] [marian] Running on node19.datos.cluster.uy as process 11797 with command line:
[2023-07-26 01:09:07] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:09:07] [config] after: 0e
[2023-07-26 01:09:07] [config] after-batches: 0
[2023-07-26 01:09:07] [config] after-epochs: 20
[2023-07-26 01:09:07] [config] all-caps-every: 0
[2023-07-26 01:09:07] [config] allow-unk: false
[2023-07-26 01:09:07] [config] authors: false
[2023-07-26 01:09:07] [config] beam-size: 12
[2023-07-26 01:09:07] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:09:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:09:07] [config] bert-masking-fraction: 0.15
[2023-07-26 01:09:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:09:07] [config] bert-train-type-embeddings: true
[2023-07-26 01:09:07] [config] bert-type-vocab-size: 2
[2023-07-26 01:09:07] [config] build-info: ""
[2023-07-26 01:09:07] [config] check-gradient-nan: false
[2023-07-26 01:09:07] [config] check-nan: false
[2023-07-26 01:09:07] [config] cite: false
[2023-07-26 01:09:07] [config] clip-norm: 1
[2023-07-26 01:09:07] [config] cost-scaling:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] cost-type: ce-sum
[2023-07-26 01:09:07] [config] cpu-threads: 0
[2023-07-26 01:09:07] [config] data-threads: 8
[2023-07-26 01:09:07] [config] data-weighting: ""
[2023-07-26 01:09:07] [config] data-weighting-type: sentence
[2023-07-26 01:09:07] [config] dec-cell: gru
[2023-07-26 01:09:07] [config] dec-cell-base-depth: 2
[2023-07-26 01:09:07] [config] dec-cell-high-depth: 1
[2023-07-26 01:09:07] [config] dec-depth: 1
[2023-07-26 01:09:07] [config] devices:
[2023-07-26 01:09:07] [config]   - 0
[2023-07-26 01:09:07] [config]   - 1
[2023-07-26 01:09:07] [config] dim-emb: 512
[2023-07-26 01:09:07] [config] dim-rnn: 1024
[2023-07-26 01:09:07] [config] dim-vocabs:
[2023-07-26 01:09:07] [config]   - 54042
[2023-07-26 01:09:07] [config]   - 36507
[2023-07-26 01:09:07] [config] disp-first: 0
[2023-07-26 01:09:07] [config] disp-freq: 1000u
[2023-07-26 01:09:07] [config] disp-label-counts: true
[2023-07-26 01:09:07] [config] dropout-rnn: 0
[2023-07-26 01:09:07] [config] dropout-src: 0
[2023-07-26 01:09:07] [config] dropout-trg: 0
[2023-07-26 01:09:07] [config] dump-config: ""
[2023-07-26 01:09:07] [config] dynamic-gradient-scaling:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] early-stopping: 200
[2023-07-26 01:09:07] [config] early-stopping-on: first
[2023-07-26 01:09:07] [config] embedding-fix-src: false
[2023-07-26 01:09:07] [config] embedding-fix-trg: false
[2023-07-26 01:09:07] [config] embedding-normalization: false
[2023-07-26 01:09:07] [config] embedding-vectors:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] enc-cell: gru
[2023-07-26 01:09:07] [config] enc-cell-depth: 1
[2023-07-26 01:09:07] [config] enc-depth: 1
[2023-07-26 01:09:07] [config] enc-type: bidirectional
[2023-07-26 01:09:07] [config] english-title-case-every: 0
[2023-07-26 01:09:07] [config] exponential-smoothing: 0
[2023-07-26 01:09:07] [config] factor-weight: 1
[2023-07-26 01:09:07] [config] factors-combine: sum
[2023-07-26 01:09:07] [config] factors-dim-emb: 0
[2023-07-26 01:09:07] [config] gradient-checkpointing: false
[2023-07-26 01:09:07] [config] gradient-norm-average-window: 100
[2023-07-26 01:09:07] [config] guided-alignment: none
[2023-07-26 01:09:07] [config] guided-alignment-cost: mse
[2023-07-26 01:09:07] [config] guided-alignment-weight: 0.1
[2023-07-26 01:09:07] [config] ignore-model-config: false
[2023-07-26 01:09:07] [config] input-types:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] interpolate-env-vars: false
[2023-07-26 01:09:07] [config] keep-best: false
[2023-07-26 01:09:07] [config] label-smoothing: 0
[2023-07-26 01:09:07] [config] layer-normalization: false
[2023-07-26 01:09:07] [config] learn-rate: 0.0001
[2023-07-26 01:09:07] [config] lemma-dependency: ""
[2023-07-26 01:09:07] [config] lemma-dim-emb: 0
[2023-07-26 01:09:07] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:09:07] [config] log-level: info
[2023-07-26 01:09:07] [config] log-time-zone: ""
[2023-07-26 01:09:07] [config] logical-epoch:
[2023-07-26 01:09:07] [config]   - 1e
[2023-07-26 01:09:07] [config]   - 0
[2023-07-26 01:09:07] [config] lr-decay: 0
[2023-07-26 01:09:07] [config] lr-decay-freq: 50000
[2023-07-26 01:09:07] [config] lr-decay-inv-sqrt:
[2023-07-26 01:09:07] [config]   - 0
[2023-07-26 01:09:07] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:09:07] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:09:07] [config] lr-decay-start:
[2023-07-26 01:09:07] [config]   - 10
[2023-07-26 01:09:07] [config]   - 1
[2023-07-26 01:09:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:09:07] [config] lr-report: false
[2023-07-26 01:09:07] [config] lr-warmup: 0
[2023-07-26 01:09:07] [config] lr-warmup-at-reload: false
[2023-07-26 01:09:07] [config] lr-warmup-cycle: false
[2023-07-26 01:09:07] [config] lr-warmup-start-rate: 0
[2023-07-26 01:09:07] [config] max-length: 50
[2023-07-26 01:09:07] [config] max-length-crop: false
[2023-07-26 01:09:07] [config] max-length-factor: 3
[2023-07-26 01:09:07] [config] maxi-batch: 100
[2023-07-26 01:09:07] [config] maxi-batch-sort: trg
[2023-07-26 01:09:07] [config] mini-batch: 64
[2023-07-26 01:09:07] [config] mini-batch-fit: false
[2023-07-26 01:09:07] [config] mini-batch-fit-step: 10
[2023-07-26 01:09:07] [config] mini-batch-round-up: true
[2023-07-26 01:09:07] [config] mini-batch-track-lr: false
[2023-07-26 01:09:07] [config] mini-batch-warmup: 0
[2023-07-26 01:09:07] [config] mini-batch-words: 0
[2023-07-26 01:09:07] [config] mini-batch-words-ref: 0
[2023-07-26 01:09:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:09:07] [config] multi-loss-type: sum
[2023-07-26 01:09:07] [config] n-best: false
[2023-07-26 01:09:07] [config] no-nccl: false
[2023-07-26 01:09:07] [config] no-reload: false
[2023-07-26 01:09:07] [config] no-restore-corpus: false
[2023-07-26 01:09:07] [config] normalize: 0
[2023-07-26 01:09:07] [config] normalize-gradient: false
[2023-07-26 01:09:07] [config] num-devices: 0
[2023-07-26 01:09:07] [config] optimizer: adam
[2023-07-26 01:09:07] [config] optimizer-delay: 1
[2023-07-26 01:09:07] [config] optimizer-params:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] output-omit-bias: false
[2023-07-26 01:09:07] [config] overwrite: true
[2023-07-26 01:09:07] [config] precision:
[2023-07-26 01:09:07] [config]   - float32
[2023-07-26 01:09:07] [config]   - float32
[2023-07-26 01:09:07] [config] pretrained-model: ""
[2023-07-26 01:09:07] [config] quantize-biases: false
[2023-07-26 01:09:07] [config] quantize-bits: 0
[2023-07-26 01:09:07] [config] quantize-log-based: false
[2023-07-26 01:09:07] [config] quantize-optimization-steps: 0
[2023-07-26 01:09:07] [config] quiet: false
[2023-07-26 01:09:07] [config] quiet-translation: true
[2023-07-26 01:09:07] [config] relative-paths: false
[2023-07-26 01:09:07] [config] right-left: false
[2023-07-26 01:09:07] [config] save-freq: 10000u
[2023-07-26 01:09:07] [config] seed: 1234
[2023-07-26 01:09:07] [config] sentencepiece-alphas:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:09:07] [config] sentencepiece-options: ""
[2023-07-26 01:09:07] [config] sharding: global
[2023-07-26 01:09:07] [config] shuffle: data
[2023-07-26 01:09:07] [config] shuffle-in-ram: false
[2023-07-26 01:09:07] [config] sigterm: save-and-exit
[2023-07-26 01:09:07] [config] skip: false
[2023-07-26 01:09:07] [config] sqlite: ""
[2023-07-26 01:09:07] [config] sqlite-drop: false
[2023-07-26 01:09:07] [config] sync-freq: 200u
[2023-07-26 01:09:07] [config] sync-sgd: false
[2023-07-26 01:09:07] [config] tempdir: /tmp
[2023-07-26 01:09:07] [config] tied-embeddings: false
[2023-07-26 01:09:07] [config] tied-embeddings-all: false
[2023-07-26 01:09:07] [config] tied-embeddings-src: false
[2023-07-26 01:09:07] [config] train-embedder-rank:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] train-sets:
[2023-07-26 01:09:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:09:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:09:07] [config] transformer-aan-activation: swish
[2023-07-26 01:09:07] [config] transformer-aan-depth: 2
[2023-07-26 01:09:07] [config] transformer-aan-nogate: false
[2023-07-26 01:09:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:09:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:09:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:09:07] [config] transformer-depth-scaling: false
[2023-07-26 01:09:07] [config] transformer-dim-aan: 2048
[2023-07-26 01:09:07] [config] transformer-dim-ffn: 2048
[2023-07-26 01:09:07] [config] transformer-dropout: 0
[2023-07-26 01:09:07] [config] transformer-dropout-attention: 0
[2023-07-26 01:09:07] [config] transformer-dropout-ffn: 0
[2023-07-26 01:09:07] [config] transformer-ffn-activation: swish
[2023-07-26 01:09:07] [config] transformer-ffn-depth: 2
[2023-07-26 01:09:07] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:09:07] [config] transformer-heads: 8
[2023-07-26 01:09:07] [config] transformer-no-projection: false
[2023-07-26 01:09:07] [config] transformer-pool: false
[2023-07-26 01:09:07] [config] transformer-postprocess: dan
[2023-07-26 01:09:07] [config] transformer-postprocess-emb: d
[2023-07-26 01:09:07] [config] transformer-postprocess-top: ""
[2023-07-26 01:09:07] [config] transformer-preprocess: ""
[2023-07-26 01:09:07] [config] transformer-tied-layers:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] transformer-train-position-embeddings: false
[2023-07-26 01:09:07] [config] tsv: false
[2023-07-26 01:09:07] [config] tsv-fields: 0
[2023-07-26 01:09:07] [config] type: s2s
[2023-07-26 01:09:07] [config] ulr: false
[2023-07-26 01:09:07] [config] ulr-dim-emb: 0
[2023-07-26 01:09:07] [config] ulr-dropout: 0
[2023-07-26 01:09:07] [config] ulr-keys-vectors: ""
[2023-07-26 01:09:07] [config] ulr-query-vectors: ""
[2023-07-26 01:09:07] [config] ulr-softmax-temperature: 1
[2023-07-26 01:09:07] [config] ulr-trainable-transformation: false
[2023-07-26 01:09:07] [config] unlikelihood-loss: false
[2023-07-26 01:09:07] [config] valid-freq: 50000000
[2023-07-26 01:09:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:09:07] [config] valid-max-length: 1000
[2023-07-26 01:09:07] [config] valid-metrics:
[2023-07-26 01:09:07] [config]   - cross-entropy
[2023-07-26 01:09:07] [config]   - translation
[2023-07-26 01:09:07] [config] valid-mini-batch: 32
[2023-07-26 01:09:07] [config] valid-reset-stalled: false
[2023-07-26 01:09:07] [config] valid-script-args:
[2023-07-26 01:09:07] [config]   []
[2023-07-26 01:09:07] [config] valid-script-path: ""
[2023-07-26 01:09:07] [config] valid-sets:
[2023-07-26 01:09:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:09:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:09:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:09:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:09:07] [config] vocabs:
[2023-07-26 01:09:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:09:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:09:07] [config] word-penalty: 0
[2023-07-26 01:09:07] [config] word-scores: false
[2023-07-26 01:09:07] [config] workspace: 2048
[2023-07-26 01:09:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:09:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:09:07] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:09:07] Using asynchronous training
[2023-07-26 01:09:08] Synced seed 1234
[2023-07-26 01:09:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:09:08] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:09:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:09:08] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:09:08] [valid] No post-processing script given for validating translator
[2023-07-26 01:09:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:09:08] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:09:09] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:09:09] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:09:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:09:09] [comm] Using global sharding
[2023-07-26 01:09:09] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:09:09] [training] Using 2 GPUs
[2023-07-26 01:09:09] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:09:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:09:12] Loading Adam parameters
[2023-07-26 01:09:13] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:09:13] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:09:13] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:09:13] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:09:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:09:14] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-26 01:09:14] [data] Shuffling data
[2023-07-26 01:09:14] [data] Done reading 20,192 sentences
[2023-07-26 01:09:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:09:14] Training started
[2023-07-26 01:09:14] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:09:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:09:14] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:09:14] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:09:14] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:09:14] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:09:14] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:09:14] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:09:14] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:09:17] Ep. 11 : Up. 3000 : Sen. 2,304 : Cost 4.80049658 * 1,349,224 @ 896 after 4,025,801 : Time 9.59s : 140746.56 words/s : gNorm 0.0000
[2023-07-26 01:09:42] Seen 18,630 samples
[2023-07-26 01:09:42] Starting data epoch 12 in logical epoch 12
[2023-07-26 01:09:42] [data] Shuffling data
[2023-07-26 01:09:42] [data] Done reading 20,192 sentences
[2023-07-26 01:09:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:10:11] Seen 18,800 samples
[2023-07-26 01:10:11] Starting data epoch 13 in logical epoch 13
[2023-07-26 01:10:11] [data] Shuffling data
[2023-07-26 01:10:11] [data] Done reading 20,192 sentences
[2023-07-26 01:10:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:10:40] Seen 18,843 samples
[2023-07-26 01:10:40] Starting data epoch 14 in logical epoch 14
[2023-07-26 01:10:40] [data] Shuffling data
[2023-07-26 01:10:40] [data] Done reading 20,192 sentences
[2023-07-26 01:10:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:10:56] Ep. 14 : Up. 4000 : Sen. 9,640 : Cost 4.34959650 * 1,352,393 @ 448 after 5,378,194 : Time 98.12s : 13782.48 words/s : gNorm 0.0000
[2023-07-26 01:11:09] Seen 18,843 samples
[2023-07-26 01:11:09] Starting data epoch 15 in logical epoch 15
[2023-07-26 01:11:09] [data] Shuffling data
[2023-07-26 01:11:09] [data] Done reading 20,192 sentences
[2023-07-26 01:11:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:11:39] Seen 18,843 samples
[2023-07-26 01:11:39] Starting data epoch 16 in logical epoch 16
[2023-07-26 01:11:39] [data] Shuffling data
[2023-07-26 01:11:39] [data] Done reading 20,192 sentences
[2023-07-26 01:11:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:12:09] Seen 18,882 samples
[2023-07-26 01:12:09] Starting data epoch 17 in logical epoch 17
[2023-07-26 01:12:09] [data] Shuffling data
[2023-07-26 01:12:09] [data] Done reading 20,192 sentences
[2023-07-26 01:12:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:12:35] Ep. 17 : Up. 5000 : Sen. 16,608 : Cost 3.93203712 * 1,333,660 @ 2,254 after 6,711,854 : Time 99.90s : 13349.41 words/s : gNorm 0.0000
[2023-07-26 01:12:39] Seen 18,848 samples
[2023-07-26 01:12:39] Starting data epoch 18 in logical epoch 18
[2023-07-26 01:12:39] [data] Shuffling data
[2023-07-26 01:12:39] [data] Done reading 20,192 sentences
[2023-07-26 01:12:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:13:09] Seen 18,799 samples
[2023-07-26 01:13:09] Starting data epoch 19 in logical epoch 19
[2023-07-26 01:13:09] [data] Shuffling data
[2023-07-26 01:13:09] [data] Done reading 20,192 sentences
[2023-07-26 01:13:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:13:39] Seen 18,878 samples
[2023-07-26 01:13:39] Starting data epoch 20 in logical epoch 20
[2023-07-26 01:13:39] [data] Shuffling data
[2023-07-26 01:13:39] [data] Done reading 20,192 sentences
[2023-07-26 01:13:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:14:09] Seen 18,808 samples
[2023-07-26 01:14:09] Starting data epoch 21 in logical epoch 21
[2023-07-26 01:14:09] Training finished
[2023-07-26 01:14:13] [valid] Ep. 21 : Up. 5929 : cross-entropy : 103.711 : new best
[2023-07-26 01:15:15] [valid] Ep. 21 : Up. 5929 : translation : 0 : new best
[2023-07-26 01:15:15] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:15:18] Saving Adam parameters
[2023-07-26 01:15:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:15:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:15:34] [marian] Running on node19.datos.cluster.uy as process 36822 with command line:
[2023-07-26 01:15:34] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:15:34] [config] after: 0e
[2023-07-26 01:15:34] [config] after-batches: 0
[2023-07-26 01:15:34] [config] after-epochs: 30
[2023-07-26 01:15:34] [config] all-caps-every: 0
[2023-07-26 01:15:34] [config] allow-unk: false
[2023-07-26 01:15:34] [config] authors: false
[2023-07-26 01:15:34] [config] beam-size: 12
[2023-07-26 01:15:34] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:15:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:15:34] [config] bert-masking-fraction: 0.15
[2023-07-26 01:15:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:15:34] [config] bert-train-type-embeddings: true
[2023-07-26 01:15:34] [config] bert-type-vocab-size: 2
[2023-07-26 01:15:34] [config] build-info: ""
[2023-07-26 01:15:34] [config] check-gradient-nan: false
[2023-07-26 01:15:34] [config] check-nan: false
[2023-07-26 01:15:34] [config] cite: false
[2023-07-26 01:15:34] [config] clip-norm: 1
[2023-07-26 01:15:34] [config] cost-scaling:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] cost-type: ce-sum
[2023-07-26 01:15:34] [config] cpu-threads: 0
[2023-07-26 01:15:34] [config] data-threads: 8
[2023-07-26 01:15:34] [config] data-weighting: ""
[2023-07-26 01:15:34] [config] data-weighting-type: sentence
[2023-07-26 01:15:34] [config] dec-cell: gru
[2023-07-26 01:15:34] [config] dec-cell-base-depth: 2
[2023-07-26 01:15:34] [config] dec-cell-high-depth: 1
[2023-07-26 01:15:34] [config] dec-depth: 1
[2023-07-26 01:15:34] [config] devices:
[2023-07-26 01:15:34] [config]   - 0
[2023-07-26 01:15:34] [config]   - 1
[2023-07-26 01:15:34] [config] dim-emb: 512
[2023-07-26 01:15:34] [config] dim-rnn: 1024
[2023-07-26 01:15:34] [config] dim-vocabs:
[2023-07-26 01:15:34] [config]   - 54042
[2023-07-26 01:15:34] [config]   - 36507
[2023-07-26 01:15:34] [config] disp-first: 0
[2023-07-26 01:15:34] [config] disp-freq: 1000u
[2023-07-26 01:15:34] [config] disp-label-counts: true
[2023-07-26 01:15:34] [config] dropout-rnn: 0
[2023-07-26 01:15:34] [config] dropout-src: 0
[2023-07-26 01:15:34] [config] dropout-trg: 0
[2023-07-26 01:15:34] [config] dump-config: ""
[2023-07-26 01:15:34] [config] dynamic-gradient-scaling:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] early-stopping: 200
[2023-07-26 01:15:34] [config] early-stopping-on: first
[2023-07-26 01:15:34] [config] embedding-fix-src: false
[2023-07-26 01:15:34] [config] embedding-fix-trg: false
[2023-07-26 01:15:34] [config] embedding-normalization: false
[2023-07-26 01:15:34] [config] embedding-vectors:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] enc-cell: gru
[2023-07-26 01:15:34] [config] enc-cell-depth: 1
[2023-07-26 01:15:34] [config] enc-depth: 1
[2023-07-26 01:15:34] [config] enc-type: bidirectional
[2023-07-26 01:15:34] [config] english-title-case-every: 0
[2023-07-26 01:15:34] [config] exponential-smoothing: 0
[2023-07-26 01:15:34] [config] factor-weight: 1
[2023-07-26 01:15:34] [config] factors-combine: sum
[2023-07-26 01:15:34] [config] factors-dim-emb: 0
[2023-07-26 01:15:34] [config] gradient-checkpointing: false
[2023-07-26 01:15:34] [config] gradient-norm-average-window: 100
[2023-07-26 01:15:34] [config] guided-alignment: none
[2023-07-26 01:15:34] [config] guided-alignment-cost: mse
[2023-07-26 01:15:34] [config] guided-alignment-weight: 0.1
[2023-07-26 01:15:34] [config] ignore-model-config: false
[2023-07-26 01:15:34] [config] input-types:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] interpolate-env-vars: false
[2023-07-26 01:15:34] [config] keep-best: false
[2023-07-26 01:15:34] [config] label-smoothing: 0
[2023-07-26 01:15:34] [config] layer-normalization: false
[2023-07-26 01:15:34] [config] learn-rate: 0.0001
[2023-07-26 01:15:34] [config] lemma-dependency: ""
[2023-07-26 01:15:34] [config] lemma-dim-emb: 0
[2023-07-26 01:15:34] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:15:34] [config] log-level: info
[2023-07-26 01:15:34] [config] log-time-zone: ""
[2023-07-26 01:15:34] [config] logical-epoch:
[2023-07-26 01:15:34] [config]   - 1e
[2023-07-26 01:15:34] [config]   - 0
[2023-07-26 01:15:34] [config] lr-decay: 0
[2023-07-26 01:15:34] [config] lr-decay-freq: 50000
[2023-07-26 01:15:34] [config] lr-decay-inv-sqrt:
[2023-07-26 01:15:34] [config]   - 0
[2023-07-26 01:15:34] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:15:34] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:15:34] [config] lr-decay-start:
[2023-07-26 01:15:34] [config]   - 10
[2023-07-26 01:15:34] [config]   - 1
[2023-07-26 01:15:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:15:34] [config] lr-report: false
[2023-07-26 01:15:34] [config] lr-warmup: 0
[2023-07-26 01:15:34] [config] lr-warmup-at-reload: false
[2023-07-26 01:15:34] [config] lr-warmup-cycle: false
[2023-07-26 01:15:34] [config] lr-warmup-start-rate: 0
[2023-07-26 01:15:34] [config] max-length: 50
[2023-07-26 01:15:34] [config] max-length-crop: false
[2023-07-26 01:15:34] [config] max-length-factor: 3
[2023-07-26 01:15:34] [config] maxi-batch: 100
[2023-07-26 01:15:34] [config] maxi-batch-sort: trg
[2023-07-26 01:15:34] [config] mini-batch: 64
[2023-07-26 01:15:34] [config] mini-batch-fit: false
[2023-07-26 01:15:34] [config] mini-batch-fit-step: 10
[2023-07-26 01:15:34] [config] mini-batch-round-up: true
[2023-07-26 01:15:34] [config] mini-batch-track-lr: false
[2023-07-26 01:15:34] [config] mini-batch-warmup: 0
[2023-07-26 01:15:34] [config] mini-batch-words: 0
[2023-07-26 01:15:34] [config] mini-batch-words-ref: 0
[2023-07-26 01:15:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:15:34] [config] multi-loss-type: sum
[2023-07-26 01:15:34] [config] n-best: false
[2023-07-26 01:15:34] [config] no-nccl: false
[2023-07-26 01:15:34] [config] no-reload: false
[2023-07-26 01:15:34] [config] no-restore-corpus: false
[2023-07-26 01:15:34] [config] normalize: 0
[2023-07-26 01:15:34] [config] normalize-gradient: false
[2023-07-26 01:15:34] [config] num-devices: 0
[2023-07-26 01:15:34] [config] optimizer: adam
[2023-07-26 01:15:34] [config] optimizer-delay: 1
[2023-07-26 01:15:34] [config] optimizer-params:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] output-omit-bias: false
[2023-07-26 01:15:34] [config] overwrite: true
[2023-07-26 01:15:34] [config] precision:
[2023-07-26 01:15:34] [config]   - float32
[2023-07-26 01:15:34] [config]   - float32
[2023-07-26 01:15:34] [config] pretrained-model: ""
[2023-07-26 01:15:34] [config] quantize-biases: false
[2023-07-26 01:15:34] [config] quantize-bits: 0
[2023-07-26 01:15:34] [config] quantize-log-based: false
[2023-07-26 01:15:34] [config] quantize-optimization-steps: 0
[2023-07-26 01:15:34] [config] quiet: false
[2023-07-26 01:15:34] [config] quiet-translation: true
[2023-07-26 01:15:34] [config] relative-paths: false
[2023-07-26 01:15:34] [config] right-left: false
[2023-07-26 01:15:34] [config] save-freq: 10000u
[2023-07-26 01:15:34] [config] seed: 1234
[2023-07-26 01:15:34] [config] sentencepiece-alphas:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:15:34] [config] sentencepiece-options: ""
[2023-07-26 01:15:34] [config] sharding: global
[2023-07-26 01:15:34] [config] shuffle: data
[2023-07-26 01:15:34] [config] shuffle-in-ram: false
[2023-07-26 01:15:34] [config] sigterm: save-and-exit
[2023-07-26 01:15:34] [config] skip: false
[2023-07-26 01:15:34] [config] sqlite: ""
[2023-07-26 01:15:34] [config] sqlite-drop: false
[2023-07-26 01:15:34] [config] sync-freq: 200u
[2023-07-26 01:15:34] [config] sync-sgd: false
[2023-07-26 01:15:34] [config] tempdir: /tmp
[2023-07-26 01:15:34] [config] tied-embeddings: false
[2023-07-26 01:15:34] [config] tied-embeddings-all: false
[2023-07-26 01:15:34] [config] tied-embeddings-src: false
[2023-07-26 01:15:34] [config] train-embedder-rank:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] train-sets:
[2023-07-26 01:15:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:15:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:15:34] [config] transformer-aan-activation: swish
[2023-07-26 01:15:34] [config] transformer-aan-depth: 2
[2023-07-26 01:15:34] [config] transformer-aan-nogate: false
[2023-07-26 01:15:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:15:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:15:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:15:34] [config] transformer-depth-scaling: false
[2023-07-26 01:15:34] [config] transformer-dim-aan: 2048
[2023-07-26 01:15:34] [config] transformer-dim-ffn: 2048
[2023-07-26 01:15:34] [config] transformer-dropout: 0
[2023-07-26 01:15:34] [config] transformer-dropout-attention: 0
[2023-07-26 01:15:34] [config] transformer-dropout-ffn: 0
[2023-07-26 01:15:34] [config] transformer-ffn-activation: swish
[2023-07-26 01:15:34] [config] transformer-ffn-depth: 2
[2023-07-26 01:15:34] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:15:34] [config] transformer-heads: 8
[2023-07-26 01:15:34] [config] transformer-no-projection: false
[2023-07-26 01:15:34] [config] transformer-pool: false
[2023-07-26 01:15:34] [config] transformer-postprocess: dan
[2023-07-26 01:15:34] [config] transformer-postprocess-emb: d
[2023-07-26 01:15:34] [config] transformer-postprocess-top: ""
[2023-07-26 01:15:34] [config] transformer-preprocess: ""
[2023-07-26 01:15:34] [config] transformer-tied-layers:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] transformer-train-position-embeddings: false
[2023-07-26 01:15:34] [config] tsv: false
[2023-07-26 01:15:34] [config] tsv-fields: 0
[2023-07-26 01:15:34] [config] type: s2s
[2023-07-26 01:15:34] [config] ulr: false
[2023-07-26 01:15:34] [config] ulr-dim-emb: 0
[2023-07-26 01:15:34] [config] ulr-dropout: 0
[2023-07-26 01:15:34] [config] ulr-keys-vectors: ""
[2023-07-26 01:15:34] [config] ulr-query-vectors: ""
[2023-07-26 01:15:34] [config] ulr-softmax-temperature: 1
[2023-07-26 01:15:34] [config] ulr-trainable-transformation: false
[2023-07-26 01:15:34] [config] unlikelihood-loss: false
[2023-07-26 01:15:34] [config] valid-freq: 50000000
[2023-07-26 01:15:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:15:34] [config] valid-max-length: 1000
[2023-07-26 01:15:34] [config] valid-metrics:
[2023-07-26 01:15:34] [config]   - cross-entropy
[2023-07-26 01:15:34] [config]   - translation
[2023-07-26 01:15:34] [config] valid-mini-batch: 32
[2023-07-26 01:15:34] [config] valid-reset-stalled: false
[2023-07-26 01:15:34] [config] valid-script-args:
[2023-07-26 01:15:34] [config]   []
[2023-07-26 01:15:34] [config] valid-script-path: ""
[2023-07-26 01:15:34] [config] valid-sets:
[2023-07-26 01:15:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:15:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:15:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:15:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:15:34] [config] vocabs:
[2023-07-26 01:15:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:15:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:15:34] [config] word-penalty: 0
[2023-07-26 01:15:34] [config] word-scores: false
[2023-07-26 01:15:34] [config] workspace: 2048
[2023-07-26 01:15:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:15:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:15:34] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:15:34] Using asynchronous training
[2023-07-26 01:15:35] Synced seed 1234
[2023-07-26 01:15:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:15:35] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:15:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:15:35] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:15:35] [valid] No post-processing script given for validating translator
[2023-07-26 01:15:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:15:35] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:15:36] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:15:37] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:15:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:15:37] [comm] Using global sharding
[2023-07-26 01:15:37] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:15:37] [training] Using 2 GPUs
[2023-07-26 01:15:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:15:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:15:40] Loading Adam parameters
[2023-07-26 01:15:40] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:15:40] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:15:41] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:15:41] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:15:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:15:41] [data] Restoring the corpus state to epoch 21, batch 5929
[2023-07-26 01:15:41] [data] Shuffling data
[2023-07-26 01:15:41] [data] Done reading 20,192 sentences
[2023-07-26 01:15:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:15:41] Training started
[2023-07-26 01:15:41] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:15:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:15:41] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:15:41] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:15:41] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:15:41] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:15:41] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:15:41] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:15:41] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:15:48] Ep. 21 : Up. 6000 : Sen. 4,740 : Cost 3.55969501 * 1,343,605 @ 1,216 after 8,055,459 : Time 13.51s : 99425.26 words/s : gNorm 0.0000
[2023-07-26 01:16:10] Seen 18,621 samples
[2023-07-26 01:16:10] Starting data epoch 22 in logical epoch 22
[2023-07-26 01:16:10] [data] Shuffling data
[2023-07-26 01:16:10] [data] Done reading 20,192 sentences
[2023-07-26 01:16:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:16:38] Seen 18,809 samples
[2023-07-26 01:16:38] Starting data epoch 23 in logical epoch 23
[2023-07-26 01:16:38] [data] Shuffling data
[2023-07-26 01:16:38] [data] Done reading 20,192 sentences
[2023-07-26 01:16:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:17:08] Seen 18,874 samples
[2023-07-26 01:17:08] Starting data epoch 24 in logical epoch 24
[2023-07-26 01:17:08] [data] Shuffling data
[2023-07-26 01:17:08] [data] Done reading 20,192 sentences
[2023-07-26 01:17:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:17:27] Ep. 24 : Up. 7000 : Sen. 12,014 : Cost 3.19483471 * 1,338,450 @ 1,024 after 9,393,909 : Time 99.02s : 13517.49 words/s : gNorm 0.0000
[2023-07-26 01:17:38] Seen 18,812 samples
[2023-07-26 01:17:38] Starting data epoch 25 in logical epoch 25
[2023-07-26 01:17:38] [data] Shuffling data
[2023-07-26 01:17:38] [data] Done reading 20,192 sentences
[2023-07-26 01:17:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:18:08] Seen 18,889 samples
[2023-07-26 01:18:08] Starting data epoch 26 in logical epoch 26
[2023-07-26 01:18:08] [data] Shuffling data
[2023-07-26 01:18:08] [data] Done reading 20,192 sentences
[2023-07-26 01:18:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:18:38] Seen 18,797 samples
[2023-07-26 01:18:38] Starting data epoch 27 in logical epoch 27
[2023-07-26 01:18:38] [data] Shuffling data
[2023-07-26 01:18:38] [data] Done reading 20,192 sentences
[2023-07-26 01:18:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:19:09] Seen 18,843 samples
[2023-07-26 01:19:09] Starting data epoch 28 in logical epoch 28
[2023-07-26 01:19:09] [data] Shuffling data
[2023-07-26 01:19:09] [data] Done reading 20,192 sentences
[2023-07-26 01:19:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:19:09] Ep. 28 : Up. 8000 : Sen. 128 : Cost 2.85752296 * 1,338,798 @ 346 after 10,732,707 : Time 101.27s : 13219.45 words/s : gNorm 0.0000
[2023-07-26 01:19:39] Seen 18,843 samples
[2023-07-26 01:19:39] Starting data epoch 29 in logical epoch 29
[2023-07-26 01:19:39] [data] Shuffling data
[2023-07-26 01:19:39] [data] Done reading 20,192 sentences
[2023-07-26 01:19:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:20:09] Seen 18,799 samples
[2023-07-26 01:20:09] Starting data epoch 30 in logical epoch 30
[2023-07-26 01:20:09] [data] Shuffling data
[2023-07-26 01:20:09] [data] Done reading 20,192 sentences
[2023-07-26 01:20:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:20:39] Seen 18,690 samples
[2023-07-26 01:20:39] Starting data epoch 31 in logical epoch 31
[2023-07-26 01:20:39] Training finished
[2023-07-26 01:20:43] [valid] Ep. 31 : Up. 8890 : cross-entropy : 110.296 : stalled 1 times (last best: 103.711)
[2023-07-26 01:21:44] [valid] Ep. 31 : Up. 8890 : translation : 0 : new best
[2023-07-26 01:21:44] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:21:47] Saving Adam parameters
[2023-07-26 01:21:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:22:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:22:03] [marian] Running on node19.datos.cluster.uy as process 20984 with command line:
[2023-07-26 01:22:03] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:22:03] [config] after: 0e
[2023-07-26 01:22:03] [config] after-batches: 0
[2023-07-26 01:22:03] [config] after-epochs: 40
[2023-07-26 01:22:03] [config] all-caps-every: 0
[2023-07-26 01:22:03] [config] allow-unk: false
[2023-07-26 01:22:03] [config] authors: false
[2023-07-26 01:22:03] [config] beam-size: 12
[2023-07-26 01:22:03] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:22:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:22:03] [config] bert-masking-fraction: 0.15
[2023-07-26 01:22:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:22:03] [config] bert-train-type-embeddings: true
[2023-07-26 01:22:03] [config] bert-type-vocab-size: 2
[2023-07-26 01:22:03] [config] build-info: ""
[2023-07-26 01:22:03] [config] check-gradient-nan: false
[2023-07-26 01:22:03] [config] check-nan: false
[2023-07-26 01:22:03] [config] cite: false
[2023-07-26 01:22:03] [config] clip-norm: 1
[2023-07-26 01:22:03] [config] cost-scaling:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] cost-type: ce-sum
[2023-07-26 01:22:03] [config] cpu-threads: 0
[2023-07-26 01:22:03] [config] data-threads: 8
[2023-07-26 01:22:03] [config] data-weighting: ""
[2023-07-26 01:22:03] [config] data-weighting-type: sentence
[2023-07-26 01:22:03] [config] dec-cell: gru
[2023-07-26 01:22:03] [config] dec-cell-base-depth: 2
[2023-07-26 01:22:03] [config] dec-cell-high-depth: 1
[2023-07-26 01:22:03] [config] dec-depth: 1
[2023-07-26 01:22:03] [config] devices:
[2023-07-26 01:22:03] [config]   - 0
[2023-07-26 01:22:03] [config]   - 1
[2023-07-26 01:22:03] [config] dim-emb: 512
[2023-07-26 01:22:03] [config] dim-rnn: 1024
[2023-07-26 01:22:03] [config] dim-vocabs:
[2023-07-26 01:22:03] [config]   - 54042
[2023-07-26 01:22:03] [config]   - 36507
[2023-07-26 01:22:03] [config] disp-first: 0
[2023-07-26 01:22:03] [config] disp-freq: 1000u
[2023-07-26 01:22:03] [config] disp-label-counts: true
[2023-07-26 01:22:03] [config] dropout-rnn: 0
[2023-07-26 01:22:03] [config] dropout-src: 0
[2023-07-26 01:22:03] [config] dropout-trg: 0
[2023-07-26 01:22:03] [config] dump-config: ""
[2023-07-26 01:22:03] [config] dynamic-gradient-scaling:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] early-stopping: 200
[2023-07-26 01:22:03] [config] early-stopping-on: first
[2023-07-26 01:22:03] [config] embedding-fix-src: false
[2023-07-26 01:22:03] [config] embedding-fix-trg: false
[2023-07-26 01:22:03] [config] embedding-normalization: false
[2023-07-26 01:22:03] [config] embedding-vectors:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] enc-cell: gru
[2023-07-26 01:22:03] [config] enc-cell-depth: 1
[2023-07-26 01:22:03] [config] enc-depth: 1
[2023-07-26 01:22:03] [config] enc-type: bidirectional
[2023-07-26 01:22:03] [config] english-title-case-every: 0
[2023-07-26 01:22:03] [config] exponential-smoothing: 0
[2023-07-26 01:22:03] [config] factor-weight: 1
[2023-07-26 01:22:03] [config] factors-combine: sum
[2023-07-26 01:22:03] [config] factors-dim-emb: 0
[2023-07-26 01:22:03] [config] gradient-checkpointing: false
[2023-07-26 01:22:03] [config] gradient-norm-average-window: 100
[2023-07-26 01:22:03] [config] guided-alignment: none
[2023-07-26 01:22:03] [config] guided-alignment-cost: mse
[2023-07-26 01:22:03] [config] guided-alignment-weight: 0.1
[2023-07-26 01:22:03] [config] ignore-model-config: false
[2023-07-26 01:22:03] [config] input-types:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] interpolate-env-vars: false
[2023-07-26 01:22:03] [config] keep-best: false
[2023-07-26 01:22:03] [config] label-smoothing: 0
[2023-07-26 01:22:03] [config] layer-normalization: false
[2023-07-26 01:22:03] [config] learn-rate: 0.0001
[2023-07-26 01:22:03] [config] lemma-dependency: ""
[2023-07-26 01:22:03] [config] lemma-dim-emb: 0
[2023-07-26 01:22:03] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:22:03] [config] log-level: info
[2023-07-26 01:22:03] [config] log-time-zone: ""
[2023-07-26 01:22:03] [config] logical-epoch:
[2023-07-26 01:22:03] [config]   - 1e
[2023-07-26 01:22:03] [config]   - 0
[2023-07-26 01:22:03] [config] lr-decay: 0
[2023-07-26 01:22:03] [config] lr-decay-freq: 50000
[2023-07-26 01:22:03] [config] lr-decay-inv-sqrt:
[2023-07-26 01:22:03] [config]   - 0
[2023-07-26 01:22:03] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:22:03] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:22:03] [config] lr-decay-start:
[2023-07-26 01:22:03] [config]   - 10
[2023-07-26 01:22:03] [config]   - 1
[2023-07-26 01:22:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:22:03] [config] lr-report: false
[2023-07-26 01:22:03] [config] lr-warmup: 0
[2023-07-26 01:22:03] [config] lr-warmup-at-reload: false
[2023-07-26 01:22:03] [config] lr-warmup-cycle: false
[2023-07-26 01:22:03] [config] lr-warmup-start-rate: 0
[2023-07-26 01:22:03] [config] max-length: 50
[2023-07-26 01:22:03] [config] max-length-crop: false
[2023-07-26 01:22:03] [config] max-length-factor: 3
[2023-07-26 01:22:03] [config] maxi-batch: 100
[2023-07-26 01:22:03] [config] maxi-batch-sort: trg
[2023-07-26 01:22:03] [config] mini-batch: 64
[2023-07-26 01:22:03] [config] mini-batch-fit: false
[2023-07-26 01:22:03] [config] mini-batch-fit-step: 10
[2023-07-26 01:22:03] [config] mini-batch-round-up: true
[2023-07-26 01:22:03] [config] mini-batch-track-lr: false
[2023-07-26 01:22:03] [config] mini-batch-warmup: 0
[2023-07-26 01:22:03] [config] mini-batch-words: 0
[2023-07-26 01:22:03] [config] mini-batch-words-ref: 0
[2023-07-26 01:22:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:22:03] [config] multi-loss-type: sum
[2023-07-26 01:22:03] [config] n-best: false
[2023-07-26 01:22:03] [config] no-nccl: false
[2023-07-26 01:22:03] [config] no-reload: false
[2023-07-26 01:22:03] [config] no-restore-corpus: false
[2023-07-26 01:22:03] [config] normalize: 0
[2023-07-26 01:22:03] [config] normalize-gradient: false
[2023-07-26 01:22:03] [config] num-devices: 0
[2023-07-26 01:22:03] [config] optimizer: adam
[2023-07-26 01:22:03] [config] optimizer-delay: 1
[2023-07-26 01:22:03] [config] optimizer-params:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] output-omit-bias: false
[2023-07-26 01:22:03] [config] overwrite: true
[2023-07-26 01:22:03] [config] precision:
[2023-07-26 01:22:03] [config]   - float32
[2023-07-26 01:22:03] [config]   - float32
[2023-07-26 01:22:03] [config] pretrained-model: ""
[2023-07-26 01:22:03] [config] quantize-biases: false
[2023-07-26 01:22:03] [config] quantize-bits: 0
[2023-07-26 01:22:03] [config] quantize-log-based: false
[2023-07-26 01:22:03] [config] quantize-optimization-steps: 0
[2023-07-26 01:22:03] [config] quiet: false
[2023-07-26 01:22:03] [config] quiet-translation: true
[2023-07-26 01:22:03] [config] relative-paths: false
[2023-07-26 01:22:03] [config] right-left: false
[2023-07-26 01:22:03] [config] save-freq: 10000u
[2023-07-26 01:22:03] [config] seed: 1234
[2023-07-26 01:22:03] [config] sentencepiece-alphas:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:22:03] [config] sentencepiece-options: ""
[2023-07-26 01:22:03] [config] sharding: global
[2023-07-26 01:22:03] [config] shuffle: data
[2023-07-26 01:22:03] [config] shuffle-in-ram: false
[2023-07-26 01:22:03] [config] sigterm: save-and-exit
[2023-07-26 01:22:03] [config] skip: false
[2023-07-26 01:22:03] [config] sqlite: ""
[2023-07-26 01:22:03] [config] sqlite-drop: false
[2023-07-26 01:22:03] [config] sync-freq: 200u
[2023-07-26 01:22:03] [config] sync-sgd: false
[2023-07-26 01:22:03] [config] tempdir: /tmp
[2023-07-26 01:22:03] [config] tied-embeddings: false
[2023-07-26 01:22:03] [config] tied-embeddings-all: false
[2023-07-26 01:22:03] [config] tied-embeddings-src: false
[2023-07-26 01:22:03] [config] train-embedder-rank:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] train-sets:
[2023-07-26 01:22:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:22:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:22:03] [config] transformer-aan-activation: swish
[2023-07-26 01:22:03] [config] transformer-aan-depth: 2
[2023-07-26 01:22:03] [config] transformer-aan-nogate: false
[2023-07-26 01:22:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:22:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:22:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:22:03] [config] transformer-depth-scaling: false
[2023-07-26 01:22:03] [config] transformer-dim-aan: 2048
[2023-07-26 01:22:03] [config] transformer-dim-ffn: 2048
[2023-07-26 01:22:03] [config] transformer-dropout: 0
[2023-07-26 01:22:03] [config] transformer-dropout-attention: 0
[2023-07-26 01:22:03] [config] transformer-dropout-ffn: 0
[2023-07-26 01:22:03] [config] transformer-ffn-activation: swish
[2023-07-26 01:22:03] [config] transformer-ffn-depth: 2
[2023-07-26 01:22:03] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:22:03] [config] transformer-heads: 8
[2023-07-26 01:22:03] [config] transformer-no-projection: false
[2023-07-26 01:22:03] [config] transformer-pool: false
[2023-07-26 01:22:03] [config] transformer-postprocess: dan
[2023-07-26 01:22:03] [config] transformer-postprocess-emb: d
[2023-07-26 01:22:03] [config] transformer-postprocess-top: ""
[2023-07-26 01:22:03] [config] transformer-preprocess: ""
[2023-07-26 01:22:03] [config] transformer-tied-layers:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] transformer-train-position-embeddings: false
[2023-07-26 01:22:03] [config] tsv: false
[2023-07-26 01:22:03] [config] tsv-fields: 0
[2023-07-26 01:22:03] [config] type: s2s
[2023-07-26 01:22:03] [config] ulr: false
[2023-07-26 01:22:03] [config] ulr-dim-emb: 0
[2023-07-26 01:22:03] [config] ulr-dropout: 0
[2023-07-26 01:22:03] [config] ulr-keys-vectors: ""
[2023-07-26 01:22:03] [config] ulr-query-vectors: ""
[2023-07-26 01:22:03] [config] ulr-softmax-temperature: 1
[2023-07-26 01:22:03] [config] ulr-trainable-transformation: false
[2023-07-26 01:22:03] [config] unlikelihood-loss: false
[2023-07-26 01:22:03] [config] valid-freq: 50000000
[2023-07-26 01:22:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:22:03] [config] valid-max-length: 1000
[2023-07-26 01:22:03] [config] valid-metrics:
[2023-07-26 01:22:03] [config]   - cross-entropy
[2023-07-26 01:22:03] [config]   - translation
[2023-07-26 01:22:03] [config] valid-mini-batch: 32
[2023-07-26 01:22:03] [config] valid-reset-stalled: false
[2023-07-26 01:22:03] [config] valid-script-args:
[2023-07-26 01:22:03] [config]   []
[2023-07-26 01:22:03] [config] valid-script-path: ""
[2023-07-26 01:22:03] [config] valid-sets:
[2023-07-26 01:22:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:22:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:22:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:22:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:22:03] [config] vocabs:
[2023-07-26 01:22:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:22:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:22:03] [config] word-penalty: 0
[2023-07-26 01:22:03] [config] word-scores: false
[2023-07-26 01:22:03] [config] workspace: 2048
[2023-07-26 01:22:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:22:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:22:03] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:22:03] Using asynchronous training
[2023-07-26 01:22:04] Synced seed 1234
[2023-07-26 01:22:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:22:04] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:22:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:22:04] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:22:04] [valid] No post-processing script given for validating translator
[2023-07-26 01:22:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:22:04] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:22:06] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:22:06] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:22:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:22:06] [comm] Using global sharding
[2023-07-26 01:22:06] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:22:06] [training] Using 2 GPUs
[2023-07-26 01:22:06] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:22:07] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:22:09] Loading Adam parameters
[2023-07-26 01:22:09] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:22:09] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:22:10] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:22:10] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:22:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:22:10] [data] Restoring the corpus state to epoch 31, batch 8890
[2023-07-26 01:22:10] [data] Shuffling data
[2023-07-26 01:22:10] [data] Done reading 20,192 sentences
[2023-07-26 01:22:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:22:10] Training started
[2023-07-26 01:22:10] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:22:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:22:11] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:22:11] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:22:11] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:22:11] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:22:11] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:22:11] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:22:11] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:22:21] Ep. 31 : Up. 9000 : Sen. 7,203 : Cost 2.51354551 * 1,339,467 @ 1,908 after 12,072,174 : Time 16.73s : 80066.66 words/s : gNorm 0.0000
[2023-07-26 01:22:38] Seen 18,548 samples
[2023-07-26 01:22:38] Starting data epoch 32 in logical epoch 32
[2023-07-26 01:22:38] [data] Shuffling data
[2023-07-26 01:22:38] [data] Done reading 20,192 sentences
[2023-07-26 01:22:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:23:07] Seen 18,843 samples
[2023-07-26 01:23:07] Starting data epoch 33 in logical epoch 33
[2023-07-26 01:23:07] [data] Shuffling data
[2023-07-26 01:23:07] [data] Done reading 20,192 sentences
[2023-07-26 01:23:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:23:37] Seen 18,843 samples
[2023-07-26 01:23:37] Starting data epoch 34 in logical epoch 34
[2023-07-26 01:23:37] [data] Shuffling data
[2023-07-26 01:23:37] [data] Done reading 20,192 sentences
[2023-07-26 01:23:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:24:00] Ep. 34 : Up. 10000 : Sen. 14,539 : Cost 2.22906184 * 1,352,957 @ 1,984 after 13,425,131 : Time 99.03s : 13661.61 words/s : gNorm 0.0000
[2023-07-26 01:24:00] TODO: implement exponential smoothing!
[2023-07-26 01:24:00] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:24:05] Saving Adam parameters
[2023-07-26 01:24:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:24:20] Seen 18,843 samples
[2023-07-26 01:24:20] Starting data epoch 35 in logical epoch 35
[2023-07-26 01:24:20] [data] Shuffling data
[2023-07-26 01:24:20] [data] Done reading 20,192 sentences
[2023-07-26 01:24:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:24:49] Seen 18,843 samples
[2023-07-26 01:24:49] Starting data epoch 36 in logical epoch 36
[2023-07-26 01:24:49] [data] Shuffling data
[2023-07-26 01:24:49] [data] Done reading 20,192 sentences
[2023-07-26 01:24:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:25:19] Seen 18,873 samples
[2023-07-26 01:25:19] Starting data epoch 37 in logical epoch 37
[2023-07-26 01:25:19] [data] Shuffling data
[2023-07-26 01:25:19] [data] Done reading 20,192 sentences
[2023-07-26 01:25:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:25:48] Seen 18,813 samples
[2023-07-26 01:25:48] Starting data epoch 38 in logical epoch 38
[2023-07-26 01:25:48] [data] Shuffling data
[2023-07-26 01:25:48] [data] Done reading 20,192 sentences
[2023-07-26 01:25:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:25:53] Ep. 38 : Up. 11000 : Sen. 2,752 : Cost 1.94200969 * 1,342,057 @ 2,108 after 14,767,188 : Time 112.79s : 11899.22 words/s : gNorm 0.0000
[2023-07-26 01:26:18] Seen 18,843 samples
[2023-07-26 01:26:18] Starting data epoch 39 in logical epoch 39
[2023-07-26 01:26:18] [data] Shuffling data
[2023-07-26 01:26:18] [data] Done reading 20,192 sentences
[2023-07-26 01:26:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:26:48] Seen 18,876 samples
[2023-07-26 01:26:48] Starting data epoch 40 in logical epoch 40
[2023-07-26 01:26:48] [data] Shuffling data
[2023-07-26 01:26:48] [data] Done reading 20,192 sentences
[2023-07-26 01:26:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:27:18] Seen 18,810 samples
[2023-07-26 01:27:18] Starting data epoch 41 in logical epoch 41
[2023-07-26 01:27:18] Training finished
[2023-07-26 01:27:22] [valid] Ep. 41 : Up. 11852 : cross-entropy : 118.256 : stalled 2 times (last best: 103.711)
[2023-07-26 01:28:19] [valid] Ep. 41 : Up. 11852 : translation : 0 : new best
[2023-07-26 01:28:19] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:28:22] Saving Adam parameters
[2023-07-26 01:28:24] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:28:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:28:35] [marian] Running on node19.datos.cluster.uy as process 5440 with command line:
[2023-07-26 01:28:35] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:28:36] [config] after: 0e
[2023-07-26 01:28:36] [config] after-batches: 0
[2023-07-26 01:28:36] [config] after-epochs: 50
[2023-07-26 01:28:36] [config] all-caps-every: 0
[2023-07-26 01:28:36] [config] allow-unk: false
[2023-07-26 01:28:36] [config] authors: false
[2023-07-26 01:28:36] [config] beam-size: 12
[2023-07-26 01:28:36] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:28:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:28:36] [config] bert-masking-fraction: 0.15
[2023-07-26 01:28:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:28:36] [config] bert-train-type-embeddings: true
[2023-07-26 01:28:36] [config] bert-type-vocab-size: 2
[2023-07-26 01:28:36] [config] build-info: ""
[2023-07-26 01:28:36] [config] check-gradient-nan: false
[2023-07-26 01:28:36] [config] check-nan: false
[2023-07-26 01:28:36] [config] cite: false
[2023-07-26 01:28:36] [config] clip-norm: 1
[2023-07-26 01:28:36] [config] cost-scaling:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] cost-type: ce-sum
[2023-07-26 01:28:36] [config] cpu-threads: 0
[2023-07-26 01:28:36] [config] data-threads: 8
[2023-07-26 01:28:36] [config] data-weighting: ""
[2023-07-26 01:28:36] [config] data-weighting-type: sentence
[2023-07-26 01:28:36] [config] dec-cell: gru
[2023-07-26 01:28:36] [config] dec-cell-base-depth: 2
[2023-07-26 01:28:36] [config] dec-cell-high-depth: 1
[2023-07-26 01:28:36] [config] dec-depth: 1
[2023-07-26 01:28:36] [config] devices:
[2023-07-26 01:28:36] [config]   - 0
[2023-07-26 01:28:36] [config]   - 1
[2023-07-26 01:28:36] [config] dim-emb: 512
[2023-07-26 01:28:36] [config] dim-rnn: 1024
[2023-07-26 01:28:36] [config] dim-vocabs:
[2023-07-26 01:28:36] [config]   - 54042
[2023-07-26 01:28:36] [config]   - 36507
[2023-07-26 01:28:36] [config] disp-first: 0
[2023-07-26 01:28:36] [config] disp-freq: 1000u
[2023-07-26 01:28:36] [config] disp-label-counts: true
[2023-07-26 01:28:36] [config] dropout-rnn: 0
[2023-07-26 01:28:36] [config] dropout-src: 0
[2023-07-26 01:28:36] [config] dropout-trg: 0
[2023-07-26 01:28:36] [config] dump-config: ""
[2023-07-26 01:28:36] [config] dynamic-gradient-scaling:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] early-stopping: 200
[2023-07-26 01:28:36] [config] early-stopping-on: first
[2023-07-26 01:28:36] [config] embedding-fix-src: false
[2023-07-26 01:28:36] [config] embedding-fix-trg: false
[2023-07-26 01:28:36] [config] embedding-normalization: false
[2023-07-26 01:28:36] [config] embedding-vectors:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] enc-cell: gru
[2023-07-26 01:28:36] [config] enc-cell-depth: 1
[2023-07-26 01:28:36] [config] enc-depth: 1
[2023-07-26 01:28:36] [config] enc-type: bidirectional
[2023-07-26 01:28:36] [config] english-title-case-every: 0
[2023-07-26 01:28:36] [config] exponential-smoothing: 0
[2023-07-26 01:28:36] [config] factor-weight: 1
[2023-07-26 01:28:36] [config] factors-combine: sum
[2023-07-26 01:28:36] [config] factors-dim-emb: 0
[2023-07-26 01:28:36] [config] gradient-checkpointing: false
[2023-07-26 01:28:36] [config] gradient-norm-average-window: 100
[2023-07-26 01:28:36] [config] guided-alignment: none
[2023-07-26 01:28:36] [config] guided-alignment-cost: mse
[2023-07-26 01:28:36] [config] guided-alignment-weight: 0.1
[2023-07-26 01:28:36] [config] ignore-model-config: false
[2023-07-26 01:28:36] [config] input-types:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] interpolate-env-vars: false
[2023-07-26 01:28:36] [config] keep-best: false
[2023-07-26 01:28:36] [config] label-smoothing: 0
[2023-07-26 01:28:36] [config] layer-normalization: false
[2023-07-26 01:28:36] [config] learn-rate: 0.0001
[2023-07-26 01:28:36] [config] lemma-dependency: ""
[2023-07-26 01:28:36] [config] lemma-dim-emb: 0
[2023-07-26 01:28:36] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:28:36] [config] log-level: info
[2023-07-26 01:28:36] [config] log-time-zone: ""
[2023-07-26 01:28:36] [config] logical-epoch:
[2023-07-26 01:28:36] [config]   - 1e
[2023-07-26 01:28:36] [config]   - 0
[2023-07-26 01:28:36] [config] lr-decay: 0
[2023-07-26 01:28:36] [config] lr-decay-freq: 50000
[2023-07-26 01:28:36] [config] lr-decay-inv-sqrt:
[2023-07-26 01:28:36] [config]   - 0
[2023-07-26 01:28:36] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:28:36] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:28:36] [config] lr-decay-start:
[2023-07-26 01:28:36] [config]   - 10
[2023-07-26 01:28:36] [config]   - 1
[2023-07-26 01:28:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:28:36] [config] lr-report: false
[2023-07-26 01:28:36] [config] lr-warmup: 0
[2023-07-26 01:28:36] [config] lr-warmup-at-reload: false
[2023-07-26 01:28:36] [config] lr-warmup-cycle: false
[2023-07-26 01:28:36] [config] lr-warmup-start-rate: 0
[2023-07-26 01:28:36] [config] max-length: 50
[2023-07-26 01:28:36] [config] max-length-crop: false
[2023-07-26 01:28:36] [config] max-length-factor: 3
[2023-07-26 01:28:36] [config] maxi-batch: 100
[2023-07-26 01:28:36] [config] maxi-batch-sort: trg
[2023-07-26 01:28:36] [config] mini-batch: 64
[2023-07-26 01:28:36] [config] mini-batch-fit: false
[2023-07-26 01:28:36] [config] mini-batch-fit-step: 10
[2023-07-26 01:28:36] [config] mini-batch-round-up: true
[2023-07-26 01:28:36] [config] mini-batch-track-lr: false
[2023-07-26 01:28:36] [config] mini-batch-warmup: 0
[2023-07-26 01:28:36] [config] mini-batch-words: 0
[2023-07-26 01:28:36] [config] mini-batch-words-ref: 0
[2023-07-26 01:28:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:28:36] [config] multi-loss-type: sum
[2023-07-26 01:28:36] [config] n-best: false
[2023-07-26 01:28:36] [config] no-nccl: false
[2023-07-26 01:28:36] [config] no-reload: false
[2023-07-26 01:28:36] [config] no-restore-corpus: false
[2023-07-26 01:28:36] [config] normalize: 0
[2023-07-26 01:28:36] [config] normalize-gradient: false
[2023-07-26 01:28:36] [config] num-devices: 0
[2023-07-26 01:28:36] [config] optimizer: adam
[2023-07-26 01:28:36] [config] optimizer-delay: 1
[2023-07-26 01:28:36] [config] optimizer-params:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] output-omit-bias: false
[2023-07-26 01:28:36] [config] overwrite: true
[2023-07-26 01:28:36] [config] precision:
[2023-07-26 01:28:36] [config]   - float32
[2023-07-26 01:28:36] [config]   - float32
[2023-07-26 01:28:36] [config] pretrained-model: ""
[2023-07-26 01:28:36] [config] quantize-biases: false
[2023-07-26 01:28:36] [config] quantize-bits: 0
[2023-07-26 01:28:36] [config] quantize-log-based: false
[2023-07-26 01:28:36] [config] quantize-optimization-steps: 0
[2023-07-26 01:28:36] [config] quiet: false
[2023-07-26 01:28:36] [config] quiet-translation: true
[2023-07-26 01:28:36] [config] relative-paths: false
[2023-07-26 01:28:36] [config] right-left: false
[2023-07-26 01:28:36] [config] save-freq: 10000u
[2023-07-26 01:28:36] [config] seed: 1234
[2023-07-26 01:28:36] [config] sentencepiece-alphas:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:28:36] [config] sentencepiece-options: ""
[2023-07-26 01:28:36] [config] sharding: global
[2023-07-26 01:28:36] [config] shuffle: data
[2023-07-26 01:28:36] [config] shuffle-in-ram: false
[2023-07-26 01:28:36] [config] sigterm: save-and-exit
[2023-07-26 01:28:36] [config] skip: false
[2023-07-26 01:28:36] [config] sqlite: ""
[2023-07-26 01:28:36] [config] sqlite-drop: false
[2023-07-26 01:28:36] [config] sync-freq: 200u
[2023-07-26 01:28:36] [config] sync-sgd: false
[2023-07-26 01:28:36] [config] tempdir: /tmp
[2023-07-26 01:28:36] [config] tied-embeddings: false
[2023-07-26 01:28:36] [config] tied-embeddings-all: false
[2023-07-26 01:28:36] [config] tied-embeddings-src: false
[2023-07-26 01:28:36] [config] train-embedder-rank:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] train-sets:
[2023-07-26 01:28:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:28:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:28:36] [config] transformer-aan-activation: swish
[2023-07-26 01:28:36] [config] transformer-aan-depth: 2
[2023-07-26 01:28:36] [config] transformer-aan-nogate: false
[2023-07-26 01:28:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:28:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:28:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:28:36] [config] transformer-depth-scaling: false
[2023-07-26 01:28:36] [config] transformer-dim-aan: 2048
[2023-07-26 01:28:36] [config] transformer-dim-ffn: 2048
[2023-07-26 01:28:36] [config] transformer-dropout: 0
[2023-07-26 01:28:36] [config] transformer-dropout-attention: 0
[2023-07-26 01:28:36] [config] transformer-dropout-ffn: 0
[2023-07-26 01:28:36] [config] transformer-ffn-activation: swish
[2023-07-26 01:28:36] [config] transformer-ffn-depth: 2
[2023-07-26 01:28:36] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:28:36] [config] transformer-heads: 8
[2023-07-26 01:28:36] [config] transformer-no-projection: false
[2023-07-26 01:28:36] [config] transformer-pool: false
[2023-07-26 01:28:36] [config] transformer-postprocess: dan
[2023-07-26 01:28:36] [config] transformer-postprocess-emb: d
[2023-07-26 01:28:36] [config] transformer-postprocess-top: ""
[2023-07-26 01:28:36] [config] transformer-preprocess: ""
[2023-07-26 01:28:36] [config] transformer-tied-layers:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] transformer-train-position-embeddings: false
[2023-07-26 01:28:36] [config] tsv: false
[2023-07-26 01:28:36] [config] tsv-fields: 0
[2023-07-26 01:28:36] [config] type: s2s
[2023-07-26 01:28:36] [config] ulr: false
[2023-07-26 01:28:36] [config] ulr-dim-emb: 0
[2023-07-26 01:28:36] [config] ulr-dropout: 0
[2023-07-26 01:28:36] [config] ulr-keys-vectors: ""
[2023-07-26 01:28:36] [config] ulr-query-vectors: ""
[2023-07-26 01:28:36] [config] ulr-softmax-temperature: 1
[2023-07-26 01:28:36] [config] ulr-trainable-transformation: false
[2023-07-26 01:28:36] [config] unlikelihood-loss: false
[2023-07-26 01:28:36] [config] valid-freq: 50000000
[2023-07-26 01:28:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:28:36] [config] valid-max-length: 1000
[2023-07-26 01:28:36] [config] valid-metrics:
[2023-07-26 01:28:36] [config]   - cross-entropy
[2023-07-26 01:28:36] [config]   - translation
[2023-07-26 01:28:36] [config] valid-mini-batch: 32
[2023-07-26 01:28:36] [config] valid-reset-stalled: false
[2023-07-26 01:28:36] [config] valid-script-args:
[2023-07-26 01:28:36] [config]   []
[2023-07-26 01:28:36] [config] valid-script-path: ""
[2023-07-26 01:28:36] [config] valid-sets:
[2023-07-26 01:28:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:28:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:28:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:28:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:28:36] [config] vocabs:
[2023-07-26 01:28:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:28:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:28:36] [config] word-penalty: 0
[2023-07-26 01:28:36] [config] word-scores: false
[2023-07-26 01:28:36] [config] workspace: 2048
[2023-07-26 01:28:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:28:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:28:36] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:28:36] Using asynchronous training
[2023-07-26 01:28:36] Synced seed 1234
[2023-07-26 01:28:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:28:36] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:28:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:28:36] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:28:36] [valid] No post-processing script given for validating translator
[2023-07-26 01:28:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:28:36] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:28:37] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:28:37] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:28:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:28:38] [comm] Using global sharding
[2023-07-26 01:28:38] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:28:38] [training] Using 2 GPUs
[2023-07-26 01:28:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:28:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:28:40] Loading Adam parameters
[2023-07-26 01:28:41] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:28:41] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:28:41] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:28:42] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:28:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:28:42] [data] Restoring the corpus state to epoch 41, batch 11852
[2023-07-26 01:28:42] [data] Shuffling data
[2023-07-26 01:28:42] [data] Done reading 20,192 sentences
[2023-07-26 01:28:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:28:42] Training started
[2023-07-26 01:28:42] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:28:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:28:42] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:28:42] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:28:42] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:28:42] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:28:42] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:28:42] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:28:42] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:28:57] Ep. 41 : Up. 12000 : Sen. 9,687 : Cost 1.67836273 * 1,340,985 @ 2,980 after 16,108,173 : Time 20.92s : 64091.78 words/s : gNorm 0.0000
[2023-07-26 01:29:10] Seen 18,587 samples
[2023-07-26 01:29:10] Starting data epoch 42 in logical epoch 42
[2023-07-26 01:29:10] [data] Shuffling data
[2023-07-26 01:29:10] [data] Done reading 20,192 sentences
[2023-07-26 01:29:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:29:39] Seen 18,843 samples
[2023-07-26 01:29:39] Starting data epoch 43 in logical epoch 43
[2023-07-26 01:29:39] [data] Shuffling data
[2023-07-26 01:29:39] [data] Done reading 20,192 sentences
[2023-07-26 01:29:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:30:08] Seen 18,895 samples
[2023-07-26 01:30:08] Starting data epoch 44 in logical epoch 44
[2023-07-26 01:30:08] [data] Shuffling data
[2023-07-26 01:30:08] [data] Done reading 20,192 sentences
[2023-07-26 01:30:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:30:35] Ep. 44 : Up. 13000 : Sen. 16,844 : Cost 1.43682230 * 1,335,099 @ 1,088 after 17,443,272 : Time 97.77s : 13655.79 words/s : gNorm 0.0000
[2023-07-26 01:30:38] Seen 18,791 samples
[2023-07-26 01:30:38] Starting data epoch 45 in logical epoch 45
[2023-07-26 01:30:38] [data] Shuffling data
[2023-07-26 01:30:38] [data] Done reading 20,192 sentences
[2023-07-26 01:30:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:31:08] Seen 18,843 samples
[2023-07-26 01:31:08] Starting data epoch 46 in logical epoch 46
[2023-07-26 01:31:08] [data] Shuffling data
[2023-07-26 01:31:08] [data] Done reading 20,192 sentences
[2023-07-26 01:31:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:31:37] Seen 18,843 samples
[2023-07-26 01:31:37] Starting data epoch 47 in logical epoch 47
[2023-07-26 01:31:37] [data] Shuffling data
[2023-07-26 01:31:37] [data] Done reading 20,192 sentences
[2023-07-26 01:31:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:32:07] Seen 18,884 samples
[2023-07-26 01:32:07] Starting data epoch 48 in logical epoch 48
[2023-07-26 01:32:07] [data] Shuffling data
[2023-07-26 01:32:07] [data] Done reading 20,192 sentences
[2023-07-26 01:32:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:32:15] Ep. 48 : Up. 14000 : Sen. 5,079 : Cost 1.22586632 * 1,344,927 @ 1,536 after 18,788,199 : Time 100.55s : 13375.17 words/s : gNorm 0.0000
[2023-07-26 01:32:37] Seen 18,802 samples
[2023-07-26 01:32:37] Starting data epoch 49 in logical epoch 49
[2023-07-26 01:32:37] [data] Shuffling data
[2023-07-26 01:32:37] [data] Done reading 20,192 sentences
[2023-07-26 01:32:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:33:06] Seen 18,843 samples
[2023-07-26 01:33:06] Starting data epoch 50 in logical epoch 50
[2023-07-26 01:33:06] [data] Shuffling data
[2023-07-26 01:33:06] [data] Done reading 20,192 sentences
[2023-07-26 01:33:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:33:36] Seen 18,843 samples
[2023-07-26 01:33:36] Starting data epoch 51 in logical epoch 51
[2023-07-26 01:33:36] Training finished
[2023-07-26 01:33:40] [valid] Ep. 51 : Up. 14813 : cross-entropy : 130.577 : stalled 3 times (last best: 103.711)
[2023-07-26 01:34:39] [valid] Ep. 51 : Up. 14813 : translation : 0 : new best
[2023-07-26 01:34:39] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:34:42] Saving Adam parameters
[2023-07-26 01:34:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:34:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:34:56] [marian] Running on node19.datos.cluster.uy as process 29766 with command line:
[2023-07-26 01:34:56] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:34:56] [config] after: 0e
[2023-07-26 01:34:56] [config] after-batches: 0
[2023-07-26 01:34:56] [config] after-epochs: 60
[2023-07-26 01:34:56] [config] all-caps-every: 0
[2023-07-26 01:34:56] [config] allow-unk: false
[2023-07-26 01:34:56] [config] authors: false
[2023-07-26 01:34:56] [config] beam-size: 12
[2023-07-26 01:34:56] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:34:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:34:56] [config] bert-masking-fraction: 0.15
[2023-07-26 01:34:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:34:56] [config] bert-train-type-embeddings: true
[2023-07-26 01:34:56] [config] bert-type-vocab-size: 2
[2023-07-26 01:34:56] [config] build-info: ""
[2023-07-26 01:34:56] [config] check-gradient-nan: false
[2023-07-26 01:34:56] [config] check-nan: false
[2023-07-26 01:34:56] [config] cite: false
[2023-07-26 01:34:56] [config] clip-norm: 1
[2023-07-26 01:34:56] [config] cost-scaling:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] cost-type: ce-sum
[2023-07-26 01:34:56] [config] cpu-threads: 0
[2023-07-26 01:34:56] [config] data-threads: 8
[2023-07-26 01:34:56] [config] data-weighting: ""
[2023-07-26 01:34:56] [config] data-weighting-type: sentence
[2023-07-26 01:34:56] [config] dec-cell: gru
[2023-07-26 01:34:56] [config] dec-cell-base-depth: 2
[2023-07-26 01:34:56] [config] dec-cell-high-depth: 1
[2023-07-26 01:34:56] [config] dec-depth: 1
[2023-07-26 01:34:56] [config] devices:
[2023-07-26 01:34:56] [config]   - 0
[2023-07-26 01:34:56] [config]   - 1
[2023-07-26 01:34:56] [config] dim-emb: 512
[2023-07-26 01:34:56] [config] dim-rnn: 1024
[2023-07-26 01:34:56] [config] dim-vocabs:
[2023-07-26 01:34:56] [config]   - 54042
[2023-07-26 01:34:56] [config]   - 36507
[2023-07-26 01:34:56] [config] disp-first: 0
[2023-07-26 01:34:56] [config] disp-freq: 1000u
[2023-07-26 01:34:56] [config] disp-label-counts: true
[2023-07-26 01:34:56] [config] dropout-rnn: 0
[2023-07-26 01:34:56] [config] dropout-src: 0
[2023-07-26 01:34:56] [config] dropout-trg: 0
[2023-07-26 01:34:56] [config] dump-config: ""
[2023-07-26 01:34:56] [config] dynamic-gradient-scaling:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] early-stopping: 200
[2023-07-26 01:34:56] [config] early-stopping-on: first
[2023-07-26 01:34:56] [config] embedding-fix-src: false
[2023-07-26 01:34:56] [config] embedding-fix-trg: false
[2023-07-26 01:34:56] [config] embedding-normalization: false
[2023-07-26 01:34:56] [config] embedding-vectors:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] enc-cell: gru
[2023-07-26 01:34:56] [config] enc-cell-depth: 1
[2023-07-26 01:34:56] [config] enc-depth: 1
[2023-07-26 01:34:56] [config] enc-type: bidirectional
[2023-07-26 01:34:56] [config] english-title-case-every: 0
[2023-07-26 01:34:56] [config] exponential-smoothing: 0
[2023-07-26 01:34:56] [config] factor-weight: 1
[2023-07-26 01:34:56] [config] factors-combine: sum
[2023-07-26 01:34:56] [config] factors-dim-emb: 0
[2023-07-26 01:34:56] [config] gradient-checkpointing: false
[2023-07-26 01:34:56] [config] gradient-norm-average-window: 100
[2023-07-26 01:34:56] [config] guided-alignment: none
[2023-07-26 01:34:56] [config] guided-alignment-cost: mse
[2023-07-26 01:34:56] [config] guided-alignment-weight: 0.1
[2023-07-26 01:34:56] [config] ignore-model-config: false
[2023-07-26 01:34:56] [config] input-types:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] interpolate-env-vars: false
[2023-07-26 01:34:56] [config] keep-best: false
[2023-07-26 01:34:56] [config] label-smoothing: 0
[2023-07-26 01:34:56] [config] layer-normalization: false
[2023-07-26 01:34:56] [config] learn-rate: 0.0001
[2023-07-26 01:34:56] [config] lemma-dependency: ""
[2023-07-26 01:34:56] [config] lemma-dim-emb: 0
[2023-07-26 01:34:56] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:34:56] [config] log-level: info
[2023-07-26 01:34:56] [config] log-time-zone: ""
[2023-07-26 01:34:56] [config] logical-epoch:
[2023-07-26 01:34:56] [config]   - 1e
[2023-07-26 01:34:56] [config]   - 0
[2023-07-26 01:34:56] [config] lr-decay: 0
[2023-07-26 01:34:56] [config] lr-decay-freq: 50000
[2023-07-26 01:34:56] [config] lr-decay-inv-sqrt:
[2023-07-26 01:34:56] [config]   - 0
[2023-07-26 01:34:56] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:34:56] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:34:56] [config] lr-decay-start:
[2023-07-26 01:34:56] [config]   - 10
[2023-07-26 01:34:56] [config]   - 1
[2023-07-26 01:34:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:34:56] [config] lr-report: false
[2023-07-26 01:34:56] [config] lr-warmup: 0
[2023-07-26 01:34:56] [config] lr-warmup-at-reload: false
[2023-07-26 01:34:56] [config] lr-warmup-cycle: false
[2023-07-26 01:34:56] [config] lr-warmup-start-rate: 0
[2023-07-26 01:34:56] [config] max-length: 50
[2023-07-26 01:34:56] [config] max-length-crop: false
[2023-07-26 01:34:56] [config] max-length-factor: 3
[2023-07-26 01:34:56] [config] maxi-batch: 100
[2023-07-26 01:34:56] [config] maxi-batch-sort: trg
[2023-07-26 01:34:56] [config] mini-batch: 64
[2023-07-26 01:34:56] [config] mini-batch-fit: false
[2023-07-26 01:34:56] [config] mini-batch-fit-step: 10
[2023-07-26 01:34:56] [config] mini-batch-round-up: true
[2023-07-26 01:34:56] [config] mini-batch-track-lr: false
[2023-07-26 01:34:56] [config] mini-batch-warmup: 0
[2023-07-26 01:34:56] [config] mini-batch-words: 0
[2023-07-26 01:34:56] [config] mini-batch-words-ref: 0
[2023-07-26 01:34:56] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:34:56] [config] multi-loss-type: sum
[2023-07-26 01:34:56] [config] n-best: false
[2023-07-26 01:34:56] [config] no-nccl: false
[2023-07-26 01:34:56] [config] no-reload: false
[2023-07-26 01:34:56] [config] no-restore-corpus: false
[2023-07-26 01:34:56] [config] normalize: 0
[2023-07-26 01:34:56] [config] normalize-gradient: false
[2023-07-26 01:34:56] [config] num-devices: 0
[2023-07-26 01:34:56] [config] optimizer: adam
[2023-07-26 01:34:56] [config] optimizer-delay: 1
[2023-07-26 01:34:56] [config] optimizer-params:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] output-omit-bias: false
[2023-07-26 01:34:56] [config] overwrite: true
[2023-07-26 01:34:56] [config] precision:
[2023-07-26 01:34:56] [config]   - float32
[2023-07-26 01:34:56] [config]   - float32
[2023-07-26 01:34:56] [config] pretrained-model: ""
[2023-07-26 01:34:56] [config] quantize-biases: false
[2023-07-26 01:34:56] [config] quantize-bits: 0
[2023-07-26 01:34:56] [config] quantize-log-based: false
[2023-07-26 01:34:56] [config] quantize-optimization-steps: 0
[2023-07-26 01:34:56] [config] quiet: false
[2023-07-26 01:34:56] [config] quiet-translation: true
[2023-07-26 01:34:56] [config] relative-paths: false
[2023-07-26 01:34:56] [config] right-left: false
[2023-07-26 01:34:56] [config] save-freq: 10000u
[2023-07-26 01:34:56] [config] seed: 1234
[2023-07-26 01:34:56] [config] sentencepiece-alphas:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:34:56] [config] sentencepiece-options: ""
[2023-07-26 01:34:56] [config] sharding: global
[2023-07-26 01:34:56] [config] shuffle: data
[2023-07-26 01:34:56] [config] shuffle-in-ram: false
[2023-07-26 01:34:56] [config] sigterm: save-and-exit
[2023-07-26 01:34:56] [config] skip: false
[2023-07-26 01:34:56] [config] sqlite: ""
[2023-07-26 01:34:56] [config] sqlite-drop: false
[2023-07-26 01:34:56] [config] sync-freq: 200u
[2023-07-26 01:34:56] [config] sync-sgd: false
[2023-07-26 01:34:56] [config] tempdir: /tmp
[2023-07-26 01:34:56] [config] tied-embeddings: false
[2023-07-26 01:34:56] [config] tied-embeddings-all: false
[2023-07-26 01:34:56] [config] tied-embeddings-src: false
[2023-07-26 01:34:56] [config] train-embedder-rank:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] train-sets:
[2023-07-26 01:34:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:34:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:34:56] [config] transformer-aan-activation: swish
[2023-07-26 01:34:56] [config] transformer-aan-depth: 2
[2023-07-26 01:34:56] [config] transformer-aan-nogate: false
[2023-07-26 01:34:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:34:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:34:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:34:56] [config] transformer-depth-scaling: false
[2023-07-26 01:34:56] [config] transformer-dim-aan: 2048
[2023-07-26 01:34:56] [config] transformer-dim-ffn: 2048
[2023-07-26 01:34:56] [config] transformer-dropout: 0
[2023-07-26 01:34:56] [config] transformer-dropout-attention: 0
[2023-07-26 01:34:56] [config] transformer-dropout-ffn: 0
[2023-07-26 01:34:56] [config] transformer-ffn-activation: swish
[2023-07-26 01:34:56] [config] transformer-ffn-depth: 2
[2023-07-26 01:34:56] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:34:56] [config] transformer-heads: 8
[2023-07-26 01:34:56] [config] transformer-no-projection: false
[2023-07-26 01:34:56] [config] transformer-pool: false
[2023-07-26 01:34:56] [config] transformer-postprocess: dan
[2023-07-26 01:34:56] [config] transformer-postprocess-emb: d
[2023-07-26 01:34:56] [config] transformer-postprocess-top: ""
[2023-07-26 01:34:56] [config] transformer-preprocess: ""
[2023-07-26 01:34:56] [config] transformer-tied-layers:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] transformer-train-position-embeddings: false
[2023-07-26 01:34:56] [config] tsv: false
[2023-07-26 01:34:56] [config] tsv-fields: 0
[2023-07-26 01:34:56] [config] type: s2s
[2023-07-26 01:34:56] [config] ulr: false
[2023-07-26 01:34:56] [config] ulr-dim-emb: 0
[2023-07-26 01:34:56] [config] ulr-dropout: 0
[2023-07-26 01:34:56] [config] ulr-keys-vectors: ""
[2023-07-26 01:34:56] [config] ulr-query-vectors: ""
[2023-07-26 01:34:56] [config] ulr-softmax-temperature: 1
[2023-07-26 01:34:56] [config] ulr-trainable-transformation: false
[2023-07-26 01:34:56] [config] unlikelihood-loss: false
[2023-07-26 01:34:56] [config] valid-freq: 50000000
[2023-07-26 01:34:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:34:56] [config] valid-max-length: 1000
[2023-07-26 01:34:56] [config] valid-metrics:
[2023-07-26 01:34:56] [config]   - cross-entropy
[2023-07-26 01:34:56] [config]   - translation
[2023-07-26 01:34:56] [config] valid-mini-batch: 32
[2023-07-26 01:34:56] [config] valid-reset-stalled: false
[2023-07-26 01:34:56] [config] valid-script-args:
[2023-07-26 01:34:56] [config]   []
[2023-07-26 01:34:56] [config] valid-script-path: ""
[2023-07-26 01:34:56] [config] valid-sets:
[2023-07-26 01:34:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:34:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:34:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:34:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:34:56] [config] vocabs:
[2023-07-26 01:34:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:34:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:34:56] [config] word-penalty: 0
[2023-07-26 01:34:56] [config] word-scores: false
[2023-07-26 01:34:56] [config] workspace: 2048
[2023-07-26 01:34:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:34:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:34:56] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:34:56] Using asynchronous training
[2023-07-26 01:34:56] Synced seed 1234
[2023-07-26 01:34:56] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:34:56] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:34:56] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:34:56] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:34:56] [valid] No post-processing script given for validating translator
[2023-07-26 01:34:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:34:56] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:34:57] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:34:58] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:34:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:34:58] [comm] Using global sharding
[2023-07-26 01:34:58] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:34:58] [training] Using 2 GPUs
[2023-07-26 01:34:58] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:34:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:35:01] Loading Adam parameters
[2023-07-26 01:35:01] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:35:01] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:35:02] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:35:02] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:35:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:35:02] [data] Restoring the corpus state to epoch 51, batch 14813
[2023-07-26 01:35:02] [data] Shuffling data
[2023-07-26 01:35:02] [data] Done reading 20,192 sentences
[2023-07-26 01:35:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:35:02] Training started
[2023-07-26 01:35:02] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:35:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:35:03] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:35:03] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:35:03] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:35:03] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:35:03] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:35:03] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:35:03] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:35:20] Ep. 51 : Up. 15000 : Sen. 12,130 : Cost 1.02457297 * 1,338,774 @ 1,903 after 20,126,973 : Time 24.22s : 55277.48 words/s : gNorm 0.0000
[2023-07-26 01:35:30] Seen 18,587 samples
[2023-07-26 01:35:30] Starting data epoch 52 in logical epoch 52
[2023-07-26 01:35:30] [data] Shuffling data
[2023-07-26 01:35:30] [data] Done reading 20,192 sentences
[2023-07-26 01:35:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:35:59] Seen 18,843 samples
[2023-07-26 01:35:59] Starting data epoch 53 in logical epoch 53
[2023-07-26 01:35:59] [data] Shuffling data
[2023-07-26 01:35:59] [data] Done reading 20,192 sentences
[2023-07-26 01:35:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:36:29] Seen 18,843 samples
[2023-07-26 01:36:29] Starting data epoch 54 in logical epoch 54
[2023-07-26 01:36:29] [data] Shuffling data
[2023-07-26 01:36:29] [data] Done reading 20,192 sentences
[2023-07-26 01:36:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:36:59] Seen 18,843 samples
[2023-07-26 01:36:59] Starting data epoch 55 in logical epoch 55
[2023-07-26 01:36:59] [data] Shuffling data
[2023-07-26 01:36:59] [data] Done reading 20,192 sentences
[2023-07-26 01:36:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:36:59] Ep. 55 : Up. 16000 : Sen. 512 : Cost 0.86168164 * 1,341,203 @ 1,920 after 21,468,176 : Time 98.94s : 13555.91 words/s : gNorm 0.0000
[2023-07-26 01:37:28] Seen 18,843 samples
[2023-07-26 01:37:28] Starting data epoch 56 in logical epoch 56
[2023-07-26 01:37:28] [data] Shuffling data
[2023-07-26 01:37:29] [data] Done reading 20,192 sentences
[2023-07-26 01:37:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:37:59] Seen 18,843 samples
[2023-07-26 01:37:59] Starting data epoch 57 in logical epoch 57
[2023-07-26 01:37:59] [data] Shuffling data
[2023-07-26 01:37:59] [data] Done reading 20,192 sentences
[2023-07-26 01:37:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:38:29] Seen 18,843 samples
[2023-07-26 01:38:29] Starting data epoch 58 in logical epoch 58
[2023-07-26 01:38:29] [data] Shuffling data
[2023-07-26 01:38:29] [data] Done reading 20,192 sentences
[2023-07-26 01:38:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:38:41] Ep. 58 : Up. 17000 : Sen. 7,597 : Cost 0.70612657 * 1,346,309 @ 1,790 after 22,814,485 : Time 101.24s : 13298.23 words/s : gNorm 0.0000
[2023-07-26 01:38:58] Seen 18,843 samples
[2023-07-26 01:38:58] Starting data epoch 59 in logical epoch 59
[2023-07-26 01:38:58] [data] Shuffling data
[2023-07-26 01:38:58] [data] Done reading 20,192 sentences
[2023-07-26 01:38:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:39:28] Seen 18,843 samples
[2023-07-26 01:39:28] Starting data epoch 60 in logical epoch 60
[2023-07-26 01:39:28] [data] Shuffling data
[2023-07-26 01:39:28] [data] Done reading 20,192 sentences
[2023-07-26 01:39:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:39:59] Seen 18,843 samples
[2023-07-26 01:39:59] Starting data epoch 61 in logical epoch 61
[2023-07-26 01:39:59] Training finished
[2023-07-26 01:40:02] [valid] Ep. 61 : Up. 17775 : cross-entropy : 144.304 : stalled 4 times (last best: 103.711)
[2023-07-26 01:40:58] [valid] Ep. 61 : Up. 17775 : translation : 0 : new best
[2023-07-26 01:40:58] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:41:01] Saving Adam parameters
[2023-07-26 01:41:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:41:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:41:15] [marian] Running on node19.datos.cluster.uy as process 13697 with command line:
[2023-07-26 01:41:15] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:41:15] [config] after: 0e
[2023-07-26 01:41:15] [config] after-batches: 0
[2023-07-26 01:41:15] [config] after-epochs: 70
[2023-07-26 01:41:15] [config] all-caps-every: 0
[2023-07-26 01:41:15] [config] allow-unk: false
[2023-07-26 01:41:15] [config] authors: false
[2023-07-26 01:41:15] [config] beam-size: 12
[2023-07-26 01:41:15] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:41:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:41:15] [config] bert-masking-fraction: 0.15
[2023-07-26 01:41:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:41:15] [config] bert-train-type-embeddings: true
[2023-07-26 01:41:15] [config] bert-type-vocab-size: 2
[2023-07-26 01:41:15] [config] build-info: ""
[2023-07-26 01:41:15] [config] check-gradient-nan: false
[2023-07-26 01:41:15] [config] check-nan: false
[2023-07-26 01:41:15] [config] cite: false
[2023-07-26 01:41:15] [config] clip-norm: 1
[2023-07-26 01:41:15] [config] cost-scaling:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] cost-type: ce-sum
[2023-07-26 01:41:15] [config] cpu-threads: 0
[2023-07-26 01:41:15] [config] data-threads: 8
[2023-07-26 01:41:15] [config] data-weighting: ""
[2023-07-26 01:41:15] [config] data-weighting-type: sentence
[2023-07-26 01:41:15] [config] dec-cell: gru
[2023-07-26 01:41:15] [config] dec-cell-base-depth: 2
[2023-07-26 01:41:15] [config] dec-cell-high-depth: 1
[2023-07-26 01:41:15] [config] dec-depth: 1
[2023-07-26 01:41:15] [config] devices:
[2023-07-26 01:41:15] [config]   - 0
[2023-07-26 01:41:15] [config]   - 1
[2023-07-26 01:41:15] [config] dim-emb: 512
[2023-07-26 01:41:15] [config] dim-rnn: 1024
[2023-07-26 01:41:15] [config] dim-vocabs:
[2023-07-26 01:41:15] [config]   - 54042
[2023-07-26 01:41:15] [config]   - 36507
[2023-07-26 01:41:15] [config] disp-first: 0
[2023-07-26 01:41:15] [config] disp-freq: 1000u
[2023-07-26 01:41:15] [config] disp-label-counts: true
[2023-07-26 01:41:15] [config] dropout-rnn: 0
[2023-07-26 01:41:15] [config] dropout-src: 0
[2023-07-26 01:41:15] [config] dropout-trg: 0
[2023-07-26 01:41:15] [config] dump-config: ""
[2023-07-26 01:41:15] [config] dynamic-gradient-scaling:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] early-stopping: 200
[2023-07-26 01:41:15] [config] early-stopping-on: first
[2023-07-26 01:41:15] [config] embedding-fix-src: false
[2023-07-26 01:41:15] [config] embedding-fix-trg: false
[2023-07-26 01:41:15] [config] embedding-normalization: false
[2023-07-26 01:41:15] [config] embedding-vectors:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] enc-cell: gru
[2023-07-26 01:41:15] [config] enc-cell-depth: 1
[2023-07-26 01:41:15] [config] enc-depth: 1
[2023-07-26 01:41:15] [config] enc-type: bidirectional
[2023-07-26 01:41:15] [config] english-title-case-every: 0
[2023-07-26 01:41:15] [config] exponential-smoothing: 0
[2023-07-26 01:41:15] [config] factor-weight: 1
[2023-07-26 01:41:15] [config] factors-combine: sum
[2023-07-26 01:41:15] [config] factors-dim-emb: 0
[2023-07-26 01:41:15] [config] gradient-checkpointing: false
[2023-07-26 01:41:15] [config] gradient-norm-average-window: 100
[2023-07-26 01:41:15] [config] guided-alignment: none
[2023-07-26 01:41:15] [config] guided-alignment-cost: mse
[2023-07-26 01:41:15] [config] guided-alignment-weight: 0.1
[2023-07-26 01:41:15] [config] ignore-model-config: false
[2023-07-26 01:41:15] [config] input-types:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] interpolate-env-vars: false
[2023-07-26 01:41:15] [config] keep-best: false
[2023-07-26 01:41:15] [config] label-smoothing: 0
[2023-07-26 01:41:15] [config] layer-normalization: false
[2023-07-26 01:41:15] [config] learn-rate: 0.0001
[2023-07-26 01:41:15] [config] lemma-dependency: ""
[2023-07-26 01:41:15] [config] lemma-dim-emb: 0
[2023-07-26 01:41:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:41:15] [config] log-level: info
[2023-07-26 01:41:15] [config] log-time-zone: ""
[2023-07-26 01:41:15] [config] logical-epoch:
[2023-07-26 01:41:15] [config]   - 1e
[2023-07-26 01:41:15] [config]   - 0
[2023-07-26 01:41:15] [config] lr-decay: 0
[2023-07-26 01:41:15] [config] lr-decay-freq: 50000
[2023-07-26 01:41:15] [config] lr-decay-inv-sqrt:
[2023-07-26 01:41:15] [config]   - 0
[2023-07-26 01:41:15] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:41:15] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:41:15] [config] lr-decay-start:
[2023-07-26 01:41:15] [config]   - 10
[2023-07-26 01:41:15] [config]   - 1
[2023-07-26 01:41:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:41:15] [config] lr-report: false
[2023-07-26 01:41:15] [config] lr-warmup: 0
[2023-07-26 01:41:15] [config] lr-warmup-at-reload: false
[2023-07-26 01:41:15] [config] lr-warmup-cycle: false
[2023-07-26 01:41:15] [config] lr-warmup-start-rate: 0
[2023-07-26 01:41:15] [config] max-length: 50
[2023-07-26 01:41:15] [config] max-length-crop: false
[2023-07-26 01:41:15] [config] max-length-factor: 3
[2023-07-26 01:41:15] [config] maxi-batch: 100
[2023-07-26 01:41:15] [config] maxi-batch-sort: trg
[2023-07-26 01:41:15] [config] mini-batch: 64
[2023-07-26 01:41:15] [config] mini-batch-fit: false
[2023-07-26 01:41:15] [config] mini-batch-fit-step: 10
[2023-07-26 01:41:15] [config] mini-batch-round-up: true
[2023-07-26 01:41:15] [config] mini-batch-track-lr: false
[2023-07-26 01:41:15] [config] mini-batch-warmup: 0
[2023-07-26 01:41:15] [config] mini-batch-words: 0
[2023-07-26 01:41:15] [config] mini-batch-words-ref: 0
[2023-07-26 01:41:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:41:15] [config] multi-loss-type: sum
[2023-07-26 01:41:15] [config] n-best: false
[2023-07-26 01:41:15] [config] no-nccl: false
[2023-07-26 01:41:15] [config] no-reload: false
[2023-07-26 01:41:15] [config] no-restore-corpus: false
[2023-07-26 01:41:15] [config] normalize: 0
[2023-07-26 01:41:15] [config] normalize-gradient: false
[2023-07-26 01:41:15] [config] num-devices: 0
[2023-07-26 01:41:15] [config] optimizer: adam
[2023-07-26 01:41:15] [config] optimizer-delay: 1
[2023-07-26 01:41:15] [config] optimizer-params:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] output-omit-bias: false
[2023-07-26 01:41:15] [config] overwrite: true
[2023-07-26 01:41:15] [config] precision:
[2023-07-26 01:41:15] [config]   - float32
[2023-07-26 01:41:15] [config]   - float32
[2023-07-26 01:41:15] [config] pretrained-model: ""
[2023-07-26 01:41:15] [config] quantize-biases: false
[2023-07-26 01:41:15] [config] quantize-bits: 0
[2023-07-26 01:41:15] [config] quantize-log-based: false
[2023-07-26 01:41:15] [config] quantize-optimization-steps: 0
[2023-07-26 01:41:15] [config] quiet: false
[2023-07-26 01:41:15] [config] quiet-translation: true
[2023-07-26 01:41:15] [config] relative-paths: false
[2023-07-26 01:41:15] [config] right-left: false
[2023-07-26 01:41:15] [config] save-freq: 10000u
[2023-07-26 01:41:15] [config] seed: 1234
[2023-07-26 01:41:15] [config] sentencepiece-alphas:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:41:15] [config] sentencepiece-options: ""
[2023-07-26 01:41:15] [config] sharding: global
[2023-07-26 01:41:15] [config] shuffle: data
[2023-07-26 01:41:15] [config] shuffle-in-ram: false
[2023-07-26 01:41:15] [config] sigterm: save-and-exit
[2023-07-26 01:41:15] [config] skip: false
[2023-07-26 01:41:15] [config] sqlite: ""
[2023-07-26 01:41:15] [config] sqlite-drop: false
[2023-07-26 01:41:15] [config] sync-freq: 200u
[2023-07-26 01:41:15] [config] sync-sgd: false
[2023-07-26 01:41:15] [config] tempdir: /tmp
[2023-07-26 01:41:15] [config] tied-embeddings: false
[2023-07-26 01:41:15] [config] tied-embeddings-all: false
[2023-07-26 01:41:15] [config] tied-embeddings-src: false
[2023-07-26 01:41:15] [config] train-embedder-rank:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] train-sets:
[2023-07-26 01:41:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:41:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:41:15] [config] transformer-aan-activation: swish
[2023-07-26 01:41:15] [config] transformer-aan-depth: 2
[2023-07-26 01:41:15] [config] transformer-aan-nogate: false
[2023-07-26 01:41:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:41:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:41:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:41:15] [config] transformer-depth-scaling: false
[2023-07-26 01:41:15] [config] transformer-dim-aan: 2048
[2023-07-26 01:41:15] [config] transformer-dim-ffn: 2048
[2023-07-26 01:41:15] [config] transformer-dropout: 0
[2023-07-26 01:41:15] [config] transformer-dropout-attention: 0
[2023-07-26 01:41:15] [config] transformer-dropout-ffn: 0
[2023-07-26 01:41:15] [config] transformer-ffn-activation: swish
[2023-07-26 01:41:15] [config] transformer-ffn-depth: 2
[2023-07-26 01:41:15] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:41:15] [config] transformer-heads: 8
[2023-07-26 01:41:15] [config] transformer-no-projection: false
[2023-07-26 01:41:15] [config] transformer-pool: false
[2023-07-26 01:41:15] [config] transformer-postprocess: dan
[2023-07-26 01:41:15] [config] transformer-postprocess-emb: d
[2023-07-26 01:41:15] [config] transformer-postprocess-top: ""
[2023-07-26 01:41:15] [config] transformer-preprocess: ""
[2023-07-26 01:41:15] [config] transformer-tied-layers:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] transformer-train-position-embeddings: false
[2023-07-26 01:41:15] [config] tsv: false
[2023-07-26 01:41:15] [config] tsv-fields: 0
[2023-07-26 01:41:15] [config] type: s2s
[2023-07-26 01:41:15] [config] ulr: false
[2023-07-26 01:41:15] [config] ulr-dim-emb: 0
[2023-07-26 01:41:15] [config] ulr-dropout: 0
[2023-07-26 01:41:15] [config] ulr-keys-vectors: ""
[2023-07-26 01:41:15] [config] ulr-query-vectors: ""
[2023-07-26 01:41:15] [config] ulr-softmax-temperature: 1
[2023-07-26 01:41:15] [config] ulr-trainable-transformation: false
[2023-07-26 01:41:15] [config] unlikelihood-loss: false
[2023-07-26 01:41:15] [config] valid-freq: 50000000
[2023-07-26 01:41:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:41:15] [config] valid-max-length: 1000
[2023-07-26 01:41:15] [config] valid-metrics:
[2023-07-26 01:41:15] [config]   - cross-entropy
[2023-07-26 01:41:15] [config]   - translation
[2023-07-26 01:41:15] [config] valid-mini-batch: 32
[2023-07-26 01:41:15] [config] valid-reset-stalled: false
[2023-07-26 01:41:15] [config] valid-script-args:
[2023-07-26 01:41:15] [config]   []
[2023-07-26 01:41:15] [config] valid-script-path: ""
[2023-07-26 01:41:15] [config] valid-sets:
[2023-07-26 01:41:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:41:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:41:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:41:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:41:15] [config] vocabs:
[2023-07-26 01:41:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:41:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:41:15] [config] word-penalty: 0
[2023-07-26 01:41:15] [config] word-scores: false
[2023-07-26 01:41:15] [config] workspace: 2048
[2023-07-26 01:41:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:41:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:41:15] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:41:15] Using asynchronous training
[2023-07-26 01:41:15] Synced seed 1234
[2023-07-26 01:41:15] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:41:15] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:41:15] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:41:15] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:41:16] [valid] No post-processing script given for validating translator
[2023-07-26 01:41:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:41:16] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:41:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:41:17] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:41:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:41:17] [comm] Using global sharding
[2023-07-26 01:41:17] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:41:17] [training] Using 2 GPUs
[2023-07-26 01:41:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:41:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:41:20] Loading Adam parameters
[2023-07-26 01:41:20] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:41:21] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:41:21] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:41:21] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:41:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:41:21] [data] Restoring the corpus state to epoch 61, batch 17775
[2023-07-26 01:41:21] [data] Shuffling data
[2023-07-26 01:41:21] [data] Done reading 20,192 sentences
[2023-07-26 01:41:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:41:21] Training started
[2023-07-26 01:41:21] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:41:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:41:22] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:41:22] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:41:22] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:41:22] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:41:22] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:41:22] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:41:22] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:41:43] Ep. 61 : Up. 18000 : Sen. 14,539 : Cost 0.57662046 * 1,334,127 @ 60 after 24,148,612 : Time 27.85s : 47897.53 words/s : gNorm 0.0000
[2023-07-26 01:41:50] Seen 18,587 samples
[2023-07-26 01:41:50] Starting data epoch 62 in logical epoch 62
[2023-07-26 01:41:50] [data] Shuffling data
[2023-07-26 01:41:50] [data] Done reading 20,192 sentences
[2023-07-26 01:41:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:42:18] Seen 18,843 samples
[2023-07-26 01:42:18] Starting data epoch 63 in logical epoch 63
[2023-07-26 01:42:18] [data] Shuffling data
[2023-07-26 01:42:18] [data] Done reading 20,192 sentences
[2023-07-26 01:42:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:42:48] Seen 18,843 samples
[2023-07-26 01:42:48] Starting data epoch 64 in logical epoch 64
[2023-07-26 01:42:48] [data] Shuffling data
[2023-07-26 01:42:48] [data] Done reading 20,192 sentences
[2023-07-26 01:42:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:43:18] Seen 18,843 samples
[2023-07-26 01:43:18] Starting data epoch 65 in logical epoch 65
[2023-07-26 01:43:18] [data] Shuffling data
[2023-07-26 01:43:18] [data] Done reading 20,192 sentences
[2023-07-26 01:43:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:43:23] Ep. 65 : Up. 19000 : Sen. 2,929 : Cost 0.46761110 * 1,339,277 @ 1,700 after 25,487,889 : Time 99.23s : 13497.32 words/s : gNorm 0.0000
[2023-07-26 01:43:48] Seen 18,879 samples
[2023-07-26 01:43:48] Starting data epoch 66 in logical epoch 66
[2023-07-26 01:43:48] [data] Shuffling data
[2023-07-26 01:43:48] [data] Done reading 20,192 sentences
[2023-07-26 01:43:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:44:18] Seen 18,807 samples
[2023-07-26 01:44:18] Starting data epoch 67 in logical epoch 67
[2023-07-26 01:44:18] [data] Shuffling data
[2023-07-26 01:44:18] [data] Done reading 20,192 sentences
[2023-07-26 01:44:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:44:48] Seen 18,843 samples
[2023-07-26 01:44:48] Starting data epoch 68 in logical epoch 68
[2023-07-26 01:44:48] [data] Shuffling data
[2023-07-26 01:44:48] [data] Done reading 20,192 sentences
[2023-07-26 01:44:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:45:04] Ep. 68 : Up. 20000 : Sen. 10,073 : Cost 0.36838761 * 1,351,173 @ 832 after 26,839,062 : Time 101.09s : 13365.63 words/s : gNorm 0.0000
[2023-07-26 01:45:04] TODO: implement exponential smoothing!
[2023-07-26 01:45:04] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:45:08] Saving Adam parameters
[2023-07-26 01:45:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:45:31] Seen 18,843 samples
[2023-07-26 01:45:31] Starting data epoch 69 in logical epoch 69
[2023-07-26 01:45:31] [data] Shuffling data
[2023-07-26 01:45:31] [data] Done reading 20,192 sentences
[2023-07-26 01:45:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:46:00] Seen 18,843 samples
[2023-07-26 01:46:00] Starting data epoch 70 in logical epoch 70
[2023-07-26 01:46:00] [data] Shuffling data
[2023-07-26 01:46:00] [data] Done reading 20,192 sentences
[2023-07-26 01:46:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:46:30] Seen 18,879 samples
[2023-07-26 01:46:30] Starting data epoch 71 in logical epoch 71
[2023-07-26 01:46:30] Training finished
[2023-07-26 01:46:33] [valid] Ep. 71 : Up. 20736 : cross-entropy : 154.776 : stalled 5 times (last best: 103.711)
[2023-07-26 01:47:31] [valid] Ep. 71 : Up. 20736 : translation : 0 : new best
[2023-07-26 01:47:31] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:47:35] Saving Adam parameters
[2023-07-26 01:47:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:47:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:47:50] [marian] Running on node19.datos.cluster.uy as process 39057 with command line:
[2023-07-26 01:47:50] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:47:50] [config] after: 0e
[2023-07-26 01:47:50] [config] after-batches: 0
[2023-07-26 01:47:50] [config] after-epochs: 80
[2023-07-26 01:47:50] [config] all-caps-every: 0
[2023-07-26 01:47:50] [config] allow-unk: false
[2023-07-26 01:47:50] [config] authors: false
[2023-07-26 01:47:50] [config] beam-size: 12
[2023-07-26 01:47:50] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:47:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:47:50] [config] bert-masking-fraction: 0.15
[2023-07-26 01:47:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:47:50] [config] bert-train-type-embeddings: true
[2023-07-26 01:47:50] [config] bert-type-vocab-size: 2
[2023-07-26 01:47:50] [config] build-info: ""
[2023-07-26 01:47:50] [config] check-gradient-nan: false
[2023-07-26 01:47:50] [config] check-nan: false
[2023-07-26 01:47:50] [config] cite: false
[2023-07-26 01:47:50] [config] clip-norm: 1
[2023-07-26 01:47:50] [config] cost-scaling:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] cost-type: ce-sum
[2023-07-26 01:47:50] [config] cpu-threads: 0
[2023-07-26 01:47:50] [config] data-threads: 8
[2023-07-26 01:47:50] [config] data-weighting: ""
[2023-07-26 01:47:50] [config] data-weighting-type: sentence
[2023-07-26 01:47:50] [config] dec-cell: gru
[2023-07-26 01:47:50] [config] dec-cell-base-depth: 2
[2023-07-26 01:47:50] [config] dec-cell-high-depth: 1
[2023-07-26 01:47:50] [config] dec-depth: 1
[2023-07-26 01:47:50] [config] devices:
[2023-07-26 01:47:50] [config]   - 0
[2023-07-26 01:47:50] [config]   - 1
[2023-07-26 01:47:50] [config] dim-emb: 512
[2023-07-26 01:47:50] [config] dim-rnn: 1024
[2023-07-26 01:47:50] [config] dim-vocabs:
[2023-07-26 01:47:50] [config]   - 54042
[2023-07-26 01:47:50] [config]   - 36507
[2023-07-26 01:47:50] [config] disp-first: 0
[2023-07-26 01:47:50] [config] disp-freq: 1000u
[2023-07-26 01:47:50] [config] disp-label-counts: true
[2023-07-26 01:47:50] [config] dropout-rnn: 0
[2023-07-26 01:47:50] [config] dropout-src: 0
[2023-07-26 01:47:50] [config] dropout-trg: 0
[2023-07-26 01:47:50] [config] dump-config: ""
[2023-07-26 01:47:50] [config] dynamic-gradient-scaling:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] early-stopping: 200
[2023-07-26 01:47:50] [config] early-stopping-on: first
[2023-07-26 01:47:50] [config] embedding-fix-src: false
[2023-07-26 01:47:50] [config] embedding-fix-trg: false
[2023-07-26 01:47:50] [config] embedding-normalization: false
[2023-07-26 01:47:50] [config] embedding-vectors:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] enc-cell: gru
[2023-07-26 01:47:50] [config] enc-cell-depth: 1
[2023-07-26 01:47:50] [config] enc-depth: 1
[2023-07-26 01:47:50] [config] enc-type: bidirectional
[2023-07-26 01:47:50] [config] english-title-case-every: 0
[2023-07-26 01:47:50] [config] exponential-smoothing: 0
[2023-07-26 01:47:50] [config] factor-weight: 1
[2023-07-26 01:47:50] [config] factors-combine: sum
[2023-07-26 01:47:50] [config] factors-dim-emb: 0
[2023-07-26 01:47:50] [config] gradient-checkpointing: false
[2023-07-26 01:47:50] [config] gradient-norm-average-window: 100
[2023-07-26 01:47:50] [config] guided-alignment: none
[2023-07-26 01:47:50] [config] guided-alignment-cost: mse
[2023-07-26 01:47:50] [config] guided-alignment-weight: 0.1
[2023-07-26 01:47:50] [config] ignore-model-config: false
[2023-07-26 01:47:50] [config] input-types:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] interpolate-env-vars: false
[2023-07-26 01:47:50] [config] keep-best: false
[2023-07-26 01:47:50] [config] label-smoothing: 0
[2023-07-26 01:47:50] [config] layer-normalization: false
[2023-07-26 01:47:50] [config] learn-rate: 0.0001
[2023-07-26 01:47:50] [config] lemma-dependency: ""
[2023-07-26 01:47:50] [config] lemma-dim-emb: 0
[2023-07-26 01:47:50] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:47:50] [config] log-level: info
[2023-07-26 01:47:50] [config] log-time-zone: ""
[2023-07-26 01:47:50] [config] logical-epoch:
[2023-07-26 01:47:50] [config]   - 1e
[2023-07-26 01:47:50] [config]   - 0
[2023-07-26 01:47:50] [config] lr-decay: 0
[2023-07-26 01:47:50] [config] lr-decay-freq: 50000
[2023-07-26 01:47:50] [config] lr-decay-inv-sqrt:
[2023-07-26 01:47:50] [config]   - 0
[2023-07-26 01:47:50] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:47:50] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:47:50] [config] lr-decay-start:
[2023-07-26 01:47:50] [config]   - 10
[2023-07-26 01:47:50] [config]   - 1
[2023-07-26 01:47:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:47:50] [config] lr-report: false
[2023-07-26 01:47:50] [config] lr-warmup: 0
[2023-07-26 01:47:50] [config] lr-warmup-at-reload: false
[2023-07-26 01:47:50] [config] lr-warmup-cycle: false
[2023-07-26 01:47:50] [config] lr-warmup-start-rate: 0
[2023-07-26 01:47:50] [config] max-length: 50
[2023-07-26 01:47:50] [config] max-length-crop: false
[2023-07-26 01:47:50] [config] max-length-factor: 3
[2023-07-26 01:47:50] [config] maxi-batch: 100
[2023-07-26 01:47:50] [config] maxi-batch-sort: trg
[2023-07-26 01:47:50] [config] mini-batch: 64
[2023-07-26 01:47:50] [config] mini-batch-fit: false
[2023-07-26 01:47:50] [config] mini-batch-fit-step: 10
[2023-07-26 01:47:50] [config] mini-batch-round-up: true
[2023-07-26 01:47:50] [config] mini-batch-track-lr: false
[2023-07-26 01:47:50] [config] mini-batch-warmup: 0
[2023-07-26 01:47:50] [config] mini-batch-words: 0
[2023-07-26 01:47:50] [config] mini-batch-words-ref: 0
[2023-07-26 01:47:50] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:47:50] [config] multi-loss-type: sum
[2023-07-26 01:47:50] [config] n-best: false
[2023-07-26 01:47:50] [config] no-nccl: false
[2023-07-26 01:47:50] [config] no-reload: false
[2023-07-26 01:47:50] [config] no-restore-corpus: false
[2023-07-26 01:47:50] [config] normalize: 0
[2023-07-26 01:47:50] [config] normalize-gradient: false
[2023-07-26 01:47:50] [config] num-devices: 0
[2023-07-26 01:47:50] [config] optimizer: adam
[2023-07-26 01:47:50] [config] optimizer-delay: 1
[2023-07-26 01:47:50] [config] optimizer-params:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] output-omit-bias: false
[2023-07-26 01:47:50] [config] overwrite: true
[2023-07-26 01:47:50] [config] precision:
[2023-07-26 01:47:50] [config]   - float32
[2023-07-26 01:47:50] [config]   - float32
[2023-07-26 01:47:50] [config] pretrained-model: ""
[2023-07-26 01:47:50] [config] quantize-biases: false
[2023-07-26 01:47:50] [config] quantize-bits: 0
[2023-07-26 01:47:50] [config] quantize-log-based: false
[2023-07-26 01:47:50] [config] quantize-optimization-steps: 0
[2023-07-26 01:47:50] [config] quiet: false
[2023-07-26 01:47:50] [config] quiet-translation: true
[2023-07-26 01:47:50] [config] relative-paths: false
[2023-07-26 01:47:50] [config] right-left: false
[2023-07-26 01:47:50] [config] save-freq: 10000u
[2023-07-26 01:47:50] [config] seed: 1234
[2023-07-26 01:47:50] [config] sentencepiece-alphas:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:47:50] [config] sentencepiece-options: ""
[2023-07-26 01:47:50] [config] sharding: global
[2023-07-26 01:47:50] [config] shuffle: data
[2023-07-26 01:47:50] [config] shuffle-in-ram: false
[2023-07-26 01:47:50] [config] sigterm: save-and-exit
[2023-07-26 01:47:50] [config] skip: false
[2023-07-26 01:47:50] [config] sqlite: ""
[2023-07-26 01:47:50] [config] sqlite-drop: false
[2023-07-26 01:47:50] [config] sync-freq: 200u
[2023-07-26 01:47:50] [config] sync-sgd: false
[2023-07-26 01:47:50] [config] tempdir: /tmp
[2023-07-26 01:47:50] [config] tied-embeddings: false
[2023-07-26 01:47:50] [config] tied-embeddings-all: false
[2023-07-26 01:47:50] [config] tied-embeddings-src: false
[2023-07-26 01:47:50] [config] train-embedder-rank:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] train-sets:
[2023-07-26 01:47:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:47:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:47:50] [config] transformer-aan-activation: swish
[2023-07-26 01:47:50] [config] transformer-aan-depth: 2
[2023-07-26 01:47:50] [config] transformer-aan-nogate: false
[2023-07-26 01:47:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:47:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:47:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:47:50] [config] transformer-depth-scaling: false
[2023-07-26 01:47:50] [config] transformer-dim-aan: 2048
[2023-07-26 01:47:50] [config] transformer-dim-ffn: 2048
[2023-07-26 01:47:50] [config] transformer-dropout: 0
[2023-07-26 01:47:50] [config] transformer-dropout-attention: 0
[2023-07-26 01:47:50] [config] transformer-dropout-ffn: 0
[2023-07-26 01:47:50] [config] transformer-ffn-activation: swish
[2023-07-26 01:47:50] [config] transformer-ffn-depth: 2
[2023-07-26 01:47:50] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:47:50] [config] transformer-heads: 8
[2023-07-26 01:47:50] [config] transformer-no-projection: false
[2023-07-26 01:47:50] [config] transformer-pool: false
[2023-07-26 01:47:50] [config] transformer-postprocess: dan
[2023-07-26 01:47:50] [config] transformer-postprocess-emb: d
[2023-07-26 01:47:50] [config] transformer-postprocess-top: ""
[2023-07-26 01:47:50] [config] transformer-preprocess: ""
[2023-07-26 01:47:50] [config] transformer-tied-layers:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] transformer-train-position-embeddings: false
[2023-07-26 01:47:50] [config] tsv: false
[2023-07-26 01:47:50] [config] tsv-fields: 0
[2023-07-26 01:47:50] [config] type: s2s
[2023-07-26 01:47:50] [config] ulr: false
[2023-07-26 01:47:50] [config] ulr-dim-emb: 0
[2023-07-26 01:47:50] [config] ulr-dropout: 0
[2023-07-26 01:47:50] [config] ulr-keys-vectors: ""
[2023-07-26 01:47:50] [config] ulr-query-vectors: ""
[2023-07-26 01:47:50] [config] ulr-softmax-temperature: 1
[2023-07-26 01:47:50] [config] ulr-trainable-transformation: false
[2023-07-26 01:47:50] [config] unlikelihood-loss: false
[2023-07-26 01:47:50] [config] valid-freq: 50000000
[2023-07-26 01:47:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:47:50] [config] valid-max-length: 1000
[2023-07-26 01:47:50] [config] valid-metrics:
[2023-07-26 01:47:50] [config]   - cross-entropy
[2023-07-26 01:47:50] [config]   - translation
[2023-07-26 01:47:50] [config] valid-mini-batch: 32
[2023-07-26 01:47:50] [config] valid-reset-stalled: false
[2023-07-26 01:47:50] [config] valid-script-args:
[2023-07-26 01:47:50] [config]   []
[2023-07-26 01:47:50] [config] valid-script-path: ""
[2023-07-26 01:47:50] [config] valid-sets:
[2023-07-26 01:47:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:47:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:47:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:47:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:47:50] [config] vocabs:
[2023-07-26 01:47:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:47:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:47:50] [config] word-penalty: 0
[2023-07-26 01:47:50] [config] word-scores: false
[2023-07-26 01:47:50] [config] workspace: 2048
[2023-07-26 01:47:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:47:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:47:50] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:47:50] Using asynchronous training
[2023-07-26 01:47:51] Synced seed 1234
[2023-07-26 01:47:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:47:51] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:47:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:47:51] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:47:51] [valid] No post-processing script given for validating translator
[2023-07-26 01:47:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:47:51] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:47:52] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:47:52] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:47:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:47:52] [comm] Using global sharding
[2023-07-26 01:47:52] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:47:52] [training] Using 2 GPUs
[2023-07-26 01:47:52] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:47:53] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:47:55] Loading Adam parameters
[2023-07-26 01:47:56] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:47:56] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:47:56] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:47:56] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:47:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:47:57] [data] Restoring the corpus state to epoch 71, batch 20736
[2023-07-26 01:47:57] [data] Shuffling data
[2023-07-26 01:47:57] [data] Done reading 20,192 sentences
[2023-07-26 01:47:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:47:57] Training started
[2023-07-26 01:47:57] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:47:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:47:57] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:47:57] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:47:57] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:47:57] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:47:57] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:47:57] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:47:57] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:48:22] Ep. 71 : Up. 21000 : Sen. 16,978 : Cost 0.29154500 * 1,334,211 @ 622 after 28,173,273 : Time 31.39s : 42509.66 words/s : gNorm 0.0000
[2023-07-26 01:48:25] Seen 18,578 samples
[2023-07-26 01:48:25] Starting data epoch 72 in logical epoch 72
[2023-07-26 01:48:25] [data] Shuffling data
[2023-07-26 01:48:25] [data] Done reading 20,192 sentences
[2023-07-26 01:48:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:48:54] Seen 18,816 samples
[2023-07-26 01:48:54] Starting data epoch 73 in logical epoch 73
[2023-07-26 01:48:54] [data] Shuffling data
[2023-07-26 01:48:54] [data] Done reading 20,192 sentences
[2023-07-26 01:48:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:49:23] Seen 18,843 samples
[2023-07-26 01:49:23] Starting data epoch 74 in logical epoch 74
[2023-07-26 01:49:23] [data] Shuffling data
[2023-07-26 01:49:23] [data] Done reading 20,192 sentences
[2023-07-26 01:49:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:49:53] Seen 18,882 samples
[2023-07-26 01:49:53] Starting data epoch 75 in logical epoch 75
[2023-07-26 01:49:53] [data] Shuffling data
[2023-07-26 01:49:53] [data] Done reading 20,192 sentences
[2023-07-26 01:49:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:50:02] Ep. 75 : Up. 22000 : Sen. 5,427 : Cost 0.22421180 * 1,348,229 @ 52 after 29,521,502 : Time 99.21s : 13589.28 words/s : gNorm 0.0000
[2023-07-26 01:50:23] Seen 18,804 samples
[2023-07-26 01:50:23] Starting data epoch 76 in logical epoch 76
[2023-07-26 01:50:23] [data] Shuffling data
[2023-07-26 01:50:23] [data] Done reading 20,192 sentences
[2023-07-26 01:50:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:50:52] Seen 18,878 samples
[2023-07-26 01:50:52] Starting data epoch 77 in logical epoch 77
[2023-07-26 01:50:52] [data] Shuffling data
[2023-07-26 01:50:52] [data] Done reading 20,192 sentences
[2023-07-26 01:50:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:51:22] Seen 18,808 samples
[2023-07-26 01:51:22] Starting data epoch 78 in logical epoch 78
[2023-07-26 01:51:22] [data] Shuffling data
[2023-07-26 01:51:22] [data] Done reading 20,192 sentences
[2023-07-26 01:51:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:51:42] Ep. 78 : Up. 23000 : Sen. 12,462 : Cost 0.16857278 * 1,339,577 @ 2,205 after 30,861,079 : Time 100.50s : 13329.04 words/s : gNorm 0.0000
[2023-07-26 01:51:52] Seen 18,843 samples
[2023-07-26 01:51:52] Starting data epoch 79 in logical epoch 79
[2023-07-26 01:51:52] [data] Shuffling data
[2023-07-26 01:51:52] [data] Done reading 20,192 sentences
[2023-07-26 01:51:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:52:22] Seen 18,843 samples
[2023-07-26 01:52:22] Starting data epoch 80 in logical epoch 80
[2023-07-26 01:52:22] [data] Shuffling data
[2023-07-26 01:52:22] [data] Done reading 20,192 sentences
[2023-07-26 01:52:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:52:52] Seen 18,871 samples
[2023-07-26 01:52:52] Starting data epoch 81 in logical epoch 81
[2023-07-26 01:52:52] Training finished
[2023-07-26 01:52:56] [valid] Ep. 81 : Up. 23699 : cross-entropy : 165.795 : stalled 6 times (last best: 103.711)
[2023-07-26 01:53:54] [valid] Ep. 81 : Up. 23699 : translation : 0 : new best
[2023-07-26 01:53:54] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:53:59] Saving Adam parameters
[2023-07-26 01:54:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:54:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:54:13] [marian] Running on node19.datos.cluster.uy as process 23061 with command line:
[2023-07-26 01:54:13] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 01:54:13] [config] after: 0e
[2023-07-26 01:54:13] [config] after-batches: 0
[2023-07-26 01:54:13] [config] after-epochs: 90
[2023-07-26 01:54:13] [config] all-caps-every: 0
[2023-07-26 01:54:13] [config] allow-unk: false
[2023-07-26 01:54:13] [config] authors: false
[2023-07-26 01:54:13] [config] beam-size: 12
[2023-07-26 01:54:13] [config] bert-class-symbol: "[CLS]"
[2023-07-26 01:54:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 01:54:13] [config] bert-masking-fraction: 0.15
[2023-07-26 01:54:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 01:54:13] [config] bert-train-type-embeddings: true
[2023-07-26 01:54:13] [config] bert-type-vocab-size: 2
[2023-07-26 01:54:13] [config] build-info: ""
[2023-07-26 01:54:13] [config] check-gradient-nan: false
[2023-07-26 01:54:13] [config] check-nan: false
[2023-07-26 01:54:13] [config] cite: false
[2023-07-26 01:54:13] [config] clip-norm: 1
[2023-07-26 01:54:13] [config] cost-scaling:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] cost-type: ce-sum
[2023-07-26 01:54:13] [config] cpu-threads: 0
[2023-07-26 01:54:13] [config] data-threads: 8
[2023-07-26 01:54:13] [config] data-weighting: ""
[2023-07-26 01:54:13] [config] data-weighting-type: sentence
[2023-07-26 01:54:13] [config] dec-cell: gru
[2023-07-26 01:54:13] [config] dec-cell-base-depth: 2
[2023-07-26 01:54:13] [config] dec-cell-high-depth: 1
[2023-07-26 01:54:13] [config] dec-depth: 1
[2023-07-26 01:54:13] [config] devices:
[2023-07-26 01:54:13] [config]   - 0
[2023-07-26 01:54:13] [config]   - 1
[2023-07-26 01:54:13] [config] dim-emb: 512
[2023-07-26 01:54:13] [config] dim-rnn: 1024
[2023-07-26 01:54:13] [config] dim-vocabs:
[2023-07-26 01:54:13] [config]   - 54042
[2023-07-26 01:54:13] [config]   - 36507
[2023-07-26 01:54:13] [config] disp-first: 0
[2023-07-26 01:54:13] [config] disp-freq: 1000u
[2023-07-26 01:54:13] [config] disp-label-counts: true
[2023-07-26 01:54:13] [config] dropout-rnn: 0
[2023-07-26 01:54:13] [config] dropout-src: 0
[2023-07-26 01:54:13] [config] dropout-trg: 0
[2023-07-26 01:54:13] [config] dump-config: ""
[2023-07-26 01:54:13] [config] dynamic-gradient-scaling:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] early-stopping: 200
[2023-07-26 01:54:13] [config] early-stopping-on: first
[2023-07-26 01:54:13] [config] embedding-fix-src: false
[2023-07-26 01:54:13] [config] embedding-fix-trg: false
[2023-07-26 01:54:13] [config] embedding-normalization: false
[2023-07-26 01:54:13] [config] embedding-vectors:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] enc-cell: gru
[2023-07-26 01:54:13] [config] enc-cell-depth: 1
[2023-07-26 01:54:13] [config] enc-depth: 1
[2023-07-26 01:54:13] [config] enc-type: bidirectional
[2023-07-26 01:54:13] [config] english-title-case-every: 0
[2023-07-26 01:54:13] [config] exponential-smoothing: 0
[2023-07-26 01:54:13] [config] factor-weight: 1
[2023-07-26 01:54:13] [config] factors-combine: sum
[2023-07-26 01:54:13] [config] factors-dim-emb: 0
[2023-07-26 01:54:13] [config] gradient-checkpointing: false
[2023-07-26 01:54:13] [config] gradient-norm-average-window: 100
[2023-07-26 01:54:13] [config] guided-alignment: none
[2023-07-26 01:54:13] [config] guided-alignment-cost: mse
[2023-07-26 01:54:13] [config] guided-alignment-weight: 0.1
[2023-07-26 01:54:13] [config] ignore-model-config: false
[2023-07-26 01:54:13] [config] input-types:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] interpolate-env-vars: false
[2023-07-26 01:54:13] [config] keep-best: false
[2023-07-26 01:54:13] [config] label-smoothing: 0
[2023-07-26 01:54:13] [config] layer-normalization: false
[2023-07-26 01:54:13] [config] learn-rate: 0.0001
[2023-07-26 01:54:13] [config] lemma-dependency: ""
[2023-07-26 01:54:13] [config] lemma-dim-emb: 0
[2023-07-26 01:54:13] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 01:54:13] [config] log-level: info
[2023-07-26 01:54:13] [config] log-time-zone: ""
[2023-07-26 01:54:13] [config] logical-epoch:
[2023-07-26 01:54:13] [config]   - 1e
[2023-07-26 01:54:13] [config]   - 0
[2023-07-26 01:54:13] [config] lr-decay: 0
[2023-07-26 01:54:13] [config] lr-decay-freq: 50000
[2023-07-26 01:54:13] [config] lr-decay-inv-sqrt:
[2023-07-26 01:54:13] [config]   - 0
[2023-07-26 01:54:13] [config] lr-decay-repeat-warmup: false
[2023-07-26 01:54:13] [config] lr-decay-reset-optimizer: false
[2023-07-26 01:54:13] [config] lr-decay-start:
[2023-07-26 01:54:13] [config]   - 10
[2023-07-26 01:54:13] [config]   - 1
[2023-07-26 01:54:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 01:54:13] [config] lr-report: false
[2023-07-26 01:54:13] [config] lr-warmup: 0
[2023-07-26 01:54:13] [config] lr-warmup-at-reload: false
[2023-07-26 01:54:13] [config] lr-warmup-cycle: false
[2023-07-26 01:54:13] [config] lr-warmup-start-rate: 0
[2023-07-26 01:54:13] [config] max-length: 50
[2023-07-26 01:54:13] [config] max-length-crop: false
[2023-07-26 01:54:13] [config] max-length-factor: 3
[2023-07-26 01:54:13] [config] maxi-batch: 100
[2023-07-26 01:54:13] [config] maxi-batch-sort: trg
[2023-07-26 01:54:13] [config] mini-batch: 64
[2023-07-26 01:54:13] [config] mini-batch-fit: false
[2023-07-26 01:54:13] [config] mini-batch-fit-step: 10
[2023-07-26 01:54:13] [config] mini-batch-round-up: true
[2023-07-26 01:54:13] [config] mini-batch-track-lr: false
[2023-07-26 01:54:13] [config] mini-batch-warmup: 0
[2023-07-26 01:54:13] [config] mini-batch-words: 0
[2023-07-26 01:54:13] [config] mini-batch-words-ref: 0
[2023-07-26 01:54:13] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:54:13] [config] multi-loss-type: sum
[2023-07-26 01:54:13] [config] n-best: false
[2023-07-26 01:54:13] [config] no-nccl: false
[2023-07-26 01:54:13] [config] no-reload: false
[2023-07-26 01:54:13] [config] no-restore-corpus: false
[2023-07-26 01:54:13] [config] normalize: 0
[2023-07-26 01:54:13] [config] normalize-gradient: false
[2023-07-26 01:54:13] [config] num-devices: 0
[2023-07-26 01:54:13] [config] optimizer: adam
[2023-07-26 01:54:13] [config] optimizer-delay: 1
[2023-07-26 01:54:13] [config] optimizer-params:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] output-omit-bias: false
[2023-07-26 01:54:13] [config] overwrite: true
[2023-07-26 01:54:13] [config] precision:
[2023-07-26 01:54:13] [config]   - float32
[2023-07-26 01:54:13] [config]   - float32
[2023-07-26 01:54:13] [config] pretrained-model: ""
[2023-07-26 01:54:13] [config] quantize-biases: false
[2023-07-26 01:54:13] [config] quantize-bits: 0
[2023-07-26 01:54:13] [config] quantize-log-based: false
[2023-07-26 01:54:13] [config] quantize-optimization-steps: 0
[2023-07-26 01:54:13] [config] quiet: false
[2023-07-26 01:54:13] [config] quiet-translation: true
[2023-07-26 01:54:13] [config] relative-paths: false
[2023-07-26 01:54:13] [config] right-left: false
[2023-07-26 01:54:13] [config] save-freq: 10000u
[2023-07-26 01:54:13] [config] seed: 1234
[2023-07-26 01:54:13] [config] sentencepiece-alphas:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] sentencepiece-max-lines: 2000000
[2023-07-26 01:54:13] [config] sentencepiece-options: ""
[2023-07-26 01:54:13] [config] sharding: global
[2023-07-26 01:54:13] [config] shuffle: data
[2023-07-26 01:54:13] [config] shuffle-in-ram: false
[2023-07-26 01:54:13] [config] sigterm: save-and-exit
[2023-07-26 01:54:13] [config] skip: false
[2023-07-26 01:54:13] [config] sqlite: ""
[2023-07-26 01:54:13] [config] sqlite-drop: false
[2023-07-26 01:54:13] [config] sync-freq: 200u
[2023-07-26 01:54:13] [config] sync-sgd: false
[2023-07-26 01:54:13] [config] tempdir: /tmp
[2023-07-26 01:54:13] [config] tied-embeddings: false
[2023-07-26 01:54:13] [config] tied-embeddings-all: false
[2023-07-26 01:54:13] [config] tied-embeddings-src: false
[2023-07-26 01:54:13] [config] train-embedder-rank:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] train-sets:
[2023-07-26 01:54:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 01:54:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 01:54:13] [config] transformer-aan-activation: swish
[2023-07-26 01:54:13] [config] transformer-aan-depth: 2
[2023-07-26 01:54:13] [config] transformer-aan-nogate: false
[2023-07-26 01:54:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 01:54:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 01:54:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 01:54:13] [config] transformer-depth-scaling: false
[2023-07-26 01:54:13] [config] transformer-dim-aan: 2048
[2023-07-26 01:54:13] [config] transformer-dim-ffn: 2048
[2023-07-26 01:54:13] [config] transformer-dropout: 0
[2023-07-26 01:54:13] [config] transformer-dropout-attention: 0
[2023-07-26 01:54:13] [config] transformer-dropout-ffn: 0
[2023-07-26 01:54:13] [config] transformer-ffn-activation: swish
[2023-07-26 01:54:13] [config] transformer-ffn-depth: 2
[2023-07-26 01:54:13] [config] transformer-guided-alignment-layer: last
[2023-07-26 01:54:13] [config] transformer-heads: 8
[2023-07-26 01:54:13] [config] transformer-no-projection: false
[2023-07-26 01:54:13] [config] transformer-pool: false
[2023-07-26 01:54:13] [config] transformer-postprocess: dan
[2023-07-26 01:54:13] [config] transformer-postprocess-emb: d
[2023-07-26 01:54:13] [config] transformer-postprocess-top: ""
[2023-07-26 01:54:13] [config] transformer-preprocess: ""
[2023-07-26 01:54:13] [config] transformer-tied-layers:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] transformer-train-position-embeddings: false
[2023-07-26 01:54:13] [config] tsv: false
[2023-07-26 01:54:13] [config] tsv-fields: 0
[2023-07-26 01:54:13] [config] type: s2s
[2023-07-26 01:54:13] [config] ulr: false
[2023-07-26 01:54:13] [config] ulr-dim-emb: 0
[2023-07-26 01:54:13] [config] ulr-dropout: 0
[2023-07-26 01:54:13] [config] ulr-keys-vectors: ""
[2023-07-26 01:54:13] [config] ulr-query-vectors: ""
[2023-07-26 01:54:13] [config] ulr-softmax-temperature: 1
[2023-07-26 01:54:13] [config] ulr-trainable-transformation: false
[2023-07-26 01:54:13] [config] unlikelihood-loss: false
[2023-07-26 01:54:13] [config] valid-freq: 50000000
[2023-07-26 01:54:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 01:54:13] [config] valid-max-length: 1000
[2023-07-26 01:54:13] [config] valid-metrics:
[2023-07-26 01:54:13] [config]   - cross-entropy
[2023-07-26 01:54:13] [config]   - translation
[2023-07-26 01:54:13] [config] valid-mini-batch: 32
[2023-07-26 01:54:13] [config] valid-reset-stalled: false
[2023-07-26 01:54:13] [config] valid-script-args:
[2023-07-26 01:54:13] [config]   []
[2023-07-26 01:54:13] [config] valid-script-path: ""
[2023-07-26 01:54:13] [config] valid-sets:
[2023-07-26 01:54:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 01:54:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 01:54:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 01:54:13] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:54:13] [config] vocabs:
[2023-07-26 01:54:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:54:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:54:13] [config] word-penalty: 0
[2023-07-26 01:54:13] [config] word-scores: false
[2023-07-26 01:54:13] [config] workspace: 2048
[2023-07-26 01:54:13] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 01:54:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:54:13] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:54:13] Using asynchronous training
[2023-07-26 01:54:14] Synced seed 1234
[2023-07-26 01:54:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 01:54:14] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 01:54:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 01:54:14] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 01:54:14] [valid] No post-processing script given for validating translator
[2023-07-26 01:54:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 01:54:14] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 01:54:15] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 01:54:16] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 01:54:16] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 01:54:16] [comm] Using global sharding
[2023-07-26 01:54:16] [comm] NCCLCommunicators constructed successfully
[2023-07-26 01:54:16] [training] Using 2 GPUs
[2023-07-26 01:54:16] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:54:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 01:54:19] Loading Adam parameters
[2023-07-26 01:54:19] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:54:19] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:54:20] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:54:20] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:54:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 01:54:20] [data] Restoring the corpus state to epoch 81, batch 23699
[2023-07-26 01:54:20] [data] Shuffling data
[2023-07-26 01:54:20] [data] Done reading 20,192 sentences
[2023-07-26 01:54:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:54:20] Training started
[2023-07-26 01:54:20] [logits] Applying loss function for 1 factor(s)
[2023-07-26 01:54:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 01:54:20] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:54:20] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:54:20] [memory] Reserving 188 MB, device gpu0
[2023-07-26 01:54:20] [memory] Reserving 188 MB, device gpu1
[2023-07-26 01:54:20] Parameter type float32, optimization type float32, casting types false
[2023-07-26 01:54:21] [memory] Reserving 377 MB, device gpu0
[2023-07-26 01:54:21] [memory] Reserving 377 MB, device gpu1
[2023-07-26 01:54:48] Seen 18,596 samples
[2023-07-26 01:54:48] Starting data epoch 82 in logical epoch 82
[2023-07-26 01:54:48] [data] Shuffling data
[2023-07-26 01:54:48] [data] Done reading 20,192 sentences
[2023-07-26 01:54:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:54:49] Ep. 82 : Up. 24000 : Sen. 795 : Cost 0.12695187 * 1,337,533 @ 300 after 32,198,612 : Time 35.03s : 38179.50 words/s : gNorm 0.0000
[2023-07-26 01:55:17] Seen 18,806 samples
[2023-07-26 01:55:17] Starting data epoch 83 in logical epoch 83
[2023-07-26 01:55:17] [data] Shuffling data
[2023-07-26 01:55:17] [data] Done reading 20,192 sentences
[2023-07-26 01:55:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:55:46] Seen 18,886 samples
[2023-07-26 01:55:46] Starting data epoch 84 in logical epoch 84
[2023-07-26 01:55:46] [data] Shuffling data
[2023-07-26 01:55:46] [data] Done reading 20,192 sentences
[2023-07-26 01:55:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:56:16] Seen 18,800 samples
[2023-07-26 01:56:16] Starting data epoch 85 in logical epoch 85
[2023-07-26 01:56:16] [data] Shuffling data
[2023-07-26 01:56:16] [data] Done reading 20,192 sentences
[2023-07-26 01:56:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:56:28] Ep. 85 : Up. 25000 : Sen. 7,838 : Cost 0.09394769 * 1,344,522 @ 348 after 33,543,134 : Time 99.17s : 13557.29 words/s : gNorm 0.0000
[2023-07-26 01:56:46] Seen 18,843 samples
[2023-07-26 01:56:46] Starting data epoch 86 in logical epoch 86
[2023-07-26 01:56:46] [data] Shuffling data
[2023-07-26 01:56:46] [data] Done reading 20,192 sentences
[2023-07-26 01:56:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:57:16] Seen 18,843 samples
[2023-07-26 01:57:16] Starting data epoch 87 in logical epoch 87
[2023-07-26 01:57:16] [data] Shuffling data
[2023-07-26 01:57:16] [data] Done reading 20,192 sentences
[2023-07-26 01:57:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:57:46] Seen 18,886 samples
[2023-07-26 01:57:46] Starting data epoch 88 in logical epoch 88
[2023-07-26 01:57:46] [data] Shuffling data
[2023-07-26 01:57:46] [data] Done reading 20,192 sentences
[2023-07-26 01:57:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:58:09] Ep. 88 : Up. 26000 : Sen. 14,808 : Cost 0.06974749 * 1,342,938 @ 1,958 after 34,886,072 : Time 100.52s : 13359.73 words/s : gNorm 0.0000
[2023-07-26 01:58:15] Seen 18,800 samples
[2023-07-26 01:58:15] Starting data epoch 89 in logical epoch 89
[2023-07-26 01:58:15] [data] Shuffling data
[2023-07-26 01:58:15] [data] Done reading 20,192 sentences
[2023-07-26 01:58:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:58:45] Seen 18,871 samples
[2023-07-26 01:58:45] Starting data epoch 90 in logical epoch 90
[2023-07-26 01:58:45] [data] Shuffling data
[2023-07-26 01:58:45] [data] Done reading 20,192 sentences
[2023-07-26 01:58:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 01:59:15] Seen 18,854 samples
[2023-07-26 01:59:15] Starting data epoch 91 in logical epoch 91
[2023-07-26 01:59:15] Training finished
[2023-07-26 01:59:19] [valid] Ep. 91 : Up. 26661 : cross-entropy : 175.596 : stalled 7 times (last best: 103.711)
[2023-07-26 02:00:17] [valid] Ep. 91 : Up. 26661 : translation : 0 : new best
[2023-07-26 02:00:17] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:00:21] Saving Adam parameters
[2023-07-26 02:00:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:00:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:00:35] [marian] Running on node19.datos.cluster.uy as process 7628 with command line:
[2023-07-26 02:00:35] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:00:35] [config] after: 0e
[2023-07-26 02:00:35] [config] after-batches: 0
[2023-07-26 02:00:35] [config] after-epochs: 100
[2023-07-26 02:00:35] [config] all-caps-every: 0
[2023-07-26 02:00:35] [config] allow-unk: false
[2023-07-26 02:00:35] [config] authors: false
[2023-07-26 02:00:35] [config] beam-size: 12
[2023-07-26 02:00:35] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:00:35] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:00:35] [config] bert-masking-fraction: 0.15
[2023-07-26 02:00:35] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:00:35] [config] bert-train-type-embeddings: true
[2023-07-26 02:00:35] [config] bert-type-vocab-size: 2
[2023-07-26 02:00:35] [config] build-info: ""
[2023-07-26 02:00:35] [config] check-gradient-nan: false
[2023-07-26 02:00:35] [config] check-nan: false
[2023-07-26 02:00:35] [config] cite: false
[2023-07-26 02:00:35] [config] clip-norm: 1
[2023-07-26 02:00:35] [config] cost-scaling:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] cost-type: ce-sum
[2023-07-26 02:00:35] [config] cpu-threads: 0
[2023-07-26 02:00:35] [config] data-threads: 8
[2023-07-26 02:00:35] [config] data-weighting: ""
[2023-07-26 02:00:35] [config] data-weighting-type: sentence
[2023-07-26 02:00:35] [config] dec-cell: gru
[2023-07-26 02:00:35] [config] dec-cell-base-depth: 2
[2023-07-26 02:00:35] [config] dec-cell-high-depth: 1
[2023-07-26 02:00:35] [config] dec-depth: 1
[2023-07-26 02:00:35] [config] devices:
[2023-07-26 02:00:35] [config]   - 0
[2023-07-26 02:00:35] [config]   - 1
[2023-07-26 02:00:35] [config] dim-emb: 512
[2023-07-26 02:00:35] [config] dim-rnn: 1024
[2023-07-26 02:00:35] [config] dim-vocabs:
[2023-07-26 02:00:35] [config]   - 54042
[2023-07-26 02:00:35] [config]   - 36507
[2023-07-26 02:00:35] [config] disp-first: 0
[2023-07-26 02:00:35] [config] disp-freq: 1000u
[2023-07-26 02:00:35] [config] disp-label-counts: true
[2023-07-26 02:00:35] [config] dropout-rnn: 0
[2023-07-26 02:00:35] [config] dropout-src: 0
[2023-07-26 02:00:35] [config] dropout-trg: 0
[2023-07-26 02:00:35] [config] dump-config: ""
[2023-07-26 02:00:35] [config] dynamic-gradient-scaling:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] early-stopping: 200
[2023-07-26 02:00:35] [config] early-stopping-on: first
[2023-07-26 02:00:35] [config] embedding-fix-src: false
[2023-07-26 02:00:35] [config] embedding-fix-trg: false
[2023-07-26 02:00:35] [config] embedding-normalization: false
[2023-07-26 02:00:35] [config] embedding-vectors:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] enc-cell: gru
[2023-07-26 02:00:35] [config] enc-cell-depth: 1
[2023-07-26 02:00:35] [config] enc-depth: 1
[2023-07-26 02:00:35] [config] enc-type: bidirectional
[2023-07-26 02:00:35] [config] english-title-case-every: 0
[2023-07-26 02:00:35] [config] exponential-smoothing: 0
[2023-07-26 02:00:35] [config] factor-weight: 1
[2023-07-26 02:00:35] [config] factors-combine: sum
[2023-07-26 02:00:35] [config] factors-dim-emb: 0
[2023-07-26 02:00:35] [config] gradient-checkpointing: false
[2023-07-26 02:00:35] [config] gradient-norm-average-window: 100
[2023-07-26 02:00:35] [config] guided-alignment: none
[2023-07-26 02:00:35] [config] guided-alignment-cost: mse
[2023-07-26 02:00:35] [config] guided-alignment-weight: 0.1
[2023-07-26 02:00:35] [config] ignore-model-config: false
[2023-07-26 02:00:35] [config] input-types:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] interpolate-env-vars: false
[2023-07-26 02:00:35] [config] keep-best: false
[2023-07-26 02:00:35] [config] label-smoothing: 0
[2023-07-26 02:00:35] [config] layer-normalization: false
[2023-07-26 02:00:35] [config] learn-rate: 0.0001
[2023-07-26 02:00:35] [config] lemma-dependency: ""
[2023-07-26 02:00:35] [config] lemma-dim-emb: 0
[2023-07-26 02:00:35] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:00:35] [config] log-level: info
[2023-07-26 02:00:35] [config] log-time-zone: ""
[2023-07-26 02:00:35] [config] logical-epoch:
[2023-07-26 02:00:35] [config]   - 1e
[2023-07-26 02:00:35] [config]   - 0
[2023-07-26 02:00:35] [config] lr-decay: 0
[2023-07-26 02:00:35] [config] lr-decay-freq: 50000
[2023-07-26 02:00:35] [config] lr-decay-inv-sqrt:
[2023-07-26 02:00:35] [config]   - 0
[2023-07-26 02:00:35] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:00:35] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:00:35] [config] lr-decay-start:
[2023-07-26 02:00:35] [config]   - 10
[2023-07-26 02:00:35] [config]   - 1
[2023-07-26 02:00:35] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:00:35] [config] lr-report: false
[2023-07-26 02:00:35] [config] lr-warmup: 0
[2023-07-26 02:00:35] [config] lr-warmup-at-reload: false
[2023-07-26 02:00:35] [config] lr-warmup-cycle: false
[2023-07-26 02:00:35] [config] lr-warmup-start-rate: 0
[2023-07-26 02:00:35] [config] max-length: 50
[2023-07-26 02:00:35] [config] max-length-crop: false
[2023-07-26 02:00:35] [config] max-length-factor: 3
[2023-07-26 02:00:35] [config] maxi-batch: 100
[2023-07-26 02:00:35] [config] maxi-batch-sort: trg
[2023-07-26 02:00:35] [config] mini-batch: 64
[2023-07-26 02:00:35] [config] mini-batch-fit: false
[2023-07-26 02:00:35] [config] mini-batch-fit-step: 10
[2023-07-26 02:00:35] [config] mini-batch-round-up: true
[2023-07-26 02:00:35] [config] mini-batch-track-lr: false
[2023-07-26 02:00:35] [config] mini-batch-warmup: 0
[2023-07-26 02:00:35] [config] mini-batch-words: 0
[2023-07-26 02:00:35] [config] mini-batch-words-ref: 0
[2023-07-26 02:00:35] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:00:35] [config] multi-loss-type: sum
[2023-07-26 02:00:35] [config] n-best: false
[2023-07-26 02:00:35] [config] no-nccl: false
[2023-07-26 02:00:35] [config] no-reload: false
[2023-07-26 02:00:35] [config] no-restore-corpus: false
[2023-07-26 02:00:35] [config] normalize: 0
[2023-07-26 02:00:35] [config] normalize-gradient: false
[2023-07-26 02:00:35] [config] num-devices: 0
[2023-07-26 02:00:35] [config] optimizer: adam
[2023-07-26 02:00:35] [config] optimizer-delay: 1
[2023-07-26 02:00:35] [config] optimizer-params:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] output-omit-bias: false
[2023-07-26 02:00:35] [config] overwrite: true
[2023-07-26 02:00:35] [config] precision:
[2023-07-26 02:00:35] [config]   - float32
[2023-07-26 02:00:35] [config]   - float32
[2023-07-26 02:00:35] [config] pretrained-model: ""
[2023-07-26 02:00:35] [config] quantize-biases: false
[2023-07-26 02:00:35] [config] quantize-bits: 0
[2023-07-26 02:00:35] [config] quantize-log-based: false
[2023-07-26 02:00:35] [config] quantize-optimization-steps: 0
[2023-07-26 02:00:35] [config] quiet: false
[2023-07-26 02:00:35] [config] quiet-translation: true
[2023-07-26 02:00:35] [config] relative-paths: false
[2023-07-26 02:00:35] [config] right-left: false
[2023-07-26 02:00:35] [config] save-freq: 10000u
[2023-07-26 02:00:35] [config] seed: 1234
[2023-07-26 02:00:35] [config] sentencepiece-alphas:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:00:35] [config] sentencepiece-options: ""
[2023-07-26 02:00:35] [config] sharding: global
[2023-07-26 02:00:35] [config] shuffle: data
[2023-07-26 02:00:35] [config] shuffle-in-ram: false
[2023-07-26 02:00:35] [config] sigterm: save-and-exit
[2023-07-26 02:00:35] [config] skip: false
[2023-07-26 02:00:35] [config] sqlite: ""
[2023-07-26 02:00:35] [config] sqlite-drop: false
[2023-07-26 02:00:35] [config] sync-freq: 200u
[2023-07-26 02:00:35] [config] sync-sgd: false
[2023-07-26 02:00:35] [config] tempdir: /tmp
[2023-07-26 02:00:35] [config] tied-embeddings: false
[2023-07-26 02:00:35] [config] tied-embeddings-all: false
[2023-07-26 02:00:35] [config] tied-embeddings-src: false
[2023-07-26 02:00:35] [config] train-embedder-rank:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] train-sets:
[2023-07-26 02:00:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:00:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:00:35] [config] transformer-aan-activation: swish
[2023-07-26 02:00:35] [config] transformer-aan-depth: 2
[2023-07-26 02:00:35] [config] transformer-aan-nogate: false
[2023-07-26 02:00:35] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:00:35] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:00:35] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:00:35] [config] transformer-depth-scaling: false
[2023-07-26 02:00:35] [config] transformer-dim-aan: 2048
[2023-07-26 02:00:35] [config] transformer-dim-ffn: 2048
[2023-07-26 02:00:35] [config] transformer-dropout: 0
[2023-07-26 02:00:35] [config] transformer-dropout-attention: 0
[2023-07-26 02:00:35] [config] transformer-dropout-ffn: 0
[2023-07-26 02:00:35] [config] transformer-ffn-activation: swish
[2023-07-26 02:00:35] [config] transformer-ffn-depth: 2
[2023-07-26 02:00:35] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:00:35] [config] transformer-heads: 8
[2023-07-26 02:00:35] [config] transformer-no-projection: false
[2023-07-26 02:00:35] [config] transformer-pool: false
[2023-07-26 02:00:35] [config] transformer-postprocess: dan
[2023-07-26 02:00:35] [config] transformer-postprocess-emb: d
[2023-07-26 02:00:35] [config] transformer-postprocess-top: ""
[2023-07-26 02:00:35] [config] transformer-preprocess: ""
[2023-07-26 02:00:35] [config] transformer-tied-layers:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] transformer-train-position-embeddings: false
[2023-07-26 02:00:35] [config] tsv: false
[2023-07-26 02:00:35] [config] tsv-fields: 0
[2023-07-26 02:00:35] [config] type: s2s
[2023-07-26 02:00:35] [config] ulr: false
[2023-07-26 02:00:35] [config] ulr-dim-emb: 0
[2023-07-26 02:00:35] [config] ulr-dropout: 0
[2023-07-26 02:00:35] [config] ulr-keys-vectors: ""
[2023-07-26 02:00:35] [config] ulr-query-vectors: ""
[2023-07-26 02:00:35] [config] ulr-softmax-temperature: 1
[2023-07-26 02:00:35] [config] ulr-trainable-transformation: false
[2023-07-26 02:00:35] [config] unlikelihood-loss: false
[2023-07-26 02:00:35] [config] valid-freq: 50000000
[2023-07-26 02:00:35] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:00:35] [config] valid-max-length: 1000
[2023-07-26 02:00:35] [config] valid-metrics:
[2023-07-26 02:00:35] [config]   - cross-entropy
[2023-07-26 02:00:35] [config]   - translation
[2023-07-26 02:00:35] [config] valid-mini-batch: 32
[2023-07-26 02:00:35] [config] valid-reset-stalled: false
[2023-07-26 02:00:35] [config] valid-script-args:
[2023-07-26 02:00:35] [config]   []
[2023-07-26 02:00:35] [config] valid-script-path: ""
[2023-07-26 02:00:35] [config] valid-sets:
[2023-07-26 02:00:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:00:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:00:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:00:35] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:00:35] [config] vocabs:
[2023-07-26 02:00:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:00:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:00:35] [config] word-penalty: 0
[2023-07-26 02:00:35] [config] word-scores: false
[2023-07-26 02:00:35] [config] workspace: 2048
[2023-07-26 02:00:35] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:00:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:00:35] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:00:35] Using asynchronous training
[2023-07-26 02:00:36] Synced seed 1234
[2023-07-26 02:00:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:00:36] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:00:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:00:36] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:00:36] [valid] No post-processing script given for validating translator
[2023-07-26 02:00:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:00:36] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:00:37] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:00:37] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:00:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:00:37] [comm] Using global sharding
[2023-07-26 02:00:37] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:00:37] [training] Using 2 GPUs
[2023-07-26 02:00:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:00:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:00:40] Loading Adam parameters
[2023-07-26 02:00:41] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:00:41] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:00:41] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:00:41] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:00:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:00:42] [data] Restoring the corpus state to epoch 91, batch 26661
[2023-07-26 02:00:42] [data] Shuffling data
[2023-07-26 02:00:42] [data] Done reading 20,192 sentences
[2023-07-26 02:00:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:00:42] Training started
[2023-07-26 02:00:42] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:00:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:00:42] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:00:42] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:00:42] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:00:42] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:00:42] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:00:42] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:00:42] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:01:10] Seen 18,548 samples
[2023-07-26 02:01:10] Starting data epoch 92 in logical epoch 92
[2023-07-26 02:01:10] [data] Shuffling data
[2023-07-26 02:01:10] [data] Done reading 20,192 sentences
[2023-07-26 02:01:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:01:15] Ep. 92 : Up. 27000 : Sen. 3,264 : Cost 0.05279726 * 1,334,031 @ 2,304 after 36,220,103 : Time 39.12s : 34101.00 words/s : gNorm 0.0000
[2023-07-26 02:01:39] Seen 18,872 samples
[2023-07-26 02:01:39] Starting data epoch 93 in logical epoch 93
[2023-07-26 02:01:39] [data] Shuffling data
[2023-07-26 02:01:39] [data] Done reading 20,192 sentences
[2023-07-26 02:01:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:02:09] Seen 18,853 samples
[2023-07-26 02:02:09] Starting data epoch 94 in logical epoch 94
[2023-07-26 02:02:09] [data] Shuffling data
[2023-07-26 02:02:09] [data] Done reading 20,192 sentences
[2023-07-26 02:02:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:02:39] Seen 18,834 samples
[2023-07-26 02:02:39] Starting data epoch 95 in logical epoch 95
[2023-07-26 02:02:39] [data] Shuffling data
[2023-07-26 02:02:39] [data] Done reading 20,192 sentences
[2023-07-26 02:02:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:02:56] Ep. 95 : Up. 28000 : Sen. 10,230 : Cost 0.03979814 * 1,354,451 @ 407 after 37,574,554 : Time 100.70s : 13450.50 words/s : gNorm 0.0000
[2023-07-26 02:03:09] Seen 18,842 samples
[2023-07-26 02:03:09] Starting data epoch 96 in logical epoch 96
[2023-07-26 02:03:09] [data] Shuffling data
[2023-07-26 02:03:09] [data] Done reading 20,192 sentences
[2023-07-26 02:03:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:03:39] Seen 18,814 samples
[2023-07-26 02:03:39] Starting data epoch 97 in logical epoch 97
[2023-07-26 02:03:39] [data] Shuffling data
[2023-07-26 02:03:39] [data] Done reading 20,192 sentences
[2023-07-26 02:03:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:04:09] Seen 18,843 samples
[2023-07-26 02:04:09] Starting data epoch 98 in logical epoch 98
[2023-07-26 02:04:09] [data] Shuffling data
[2023-07-26 02:04:09] [data] Done reading 20,192 sentences
[2023-07-26 02:04:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:04:37] Ep. 98 : Up. 29000 : Sen. 17,151 : Cost 0.03076730 * 1,335,843 @ 1,077 after 38,910,397 : Time 101.37s : 13178.10 words/s : gNorm 0.0000
[2023-07-26 02:04:40] Seen 18,843 samples
[2023-07-26 02:04:40] Starting data epoch 99 in logical epoch 99
[2023-07-26 02:04:40] [data] Shuffling data
[2023-07-26 02:04:40] [data] Done reading 20,192 sentences
[2023-07-26 02:04:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:05:10] Seen 18,843 samples
[2023-07-26 02:05:10] Starting data epoch 100 in logical epoch 100
[2023-07-26 02:05:10] [data] Shuffling data
[2023-07-26 02:05:10] [data] Done reading 20,192 sentences
[2023-07-26 02:05:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:05:40] Seen 18,875 samples
[2023-07-26 02:05:40] Starting data epoch 101 in logical epoch 101
[2023-07-26 02:05:40] Training finished
[2023-07-26 02:05:44] [valid] Ep. 101 : Up. 29623 : cross-entropy : 182.244 : stalled 8 times (last best: 103.711)
[2023-07-26 02:06:41] [valid] Ep. 101 : Up. 29623 : translation : 0 : new best
[2023-07-26 02:06:41] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:06:45] Saving Adam parameters
[2023-07-26 02:06:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:06:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:06:58] [marian] Running on node19.datos.cluster.uy as process 32419 with command line:
[2023-07-26 02:06:58] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:06:58] [config] after: 0e
[2023-07-26 02:06:58] [config] after-batches: 0
[2023-07-26 02:06:58] [config] after-epochs: 110
[2023-07-26 02:06:58] [config] all-caps-every: 0
[2023-07-26 02:06:58] [config] allow-unk: false
[2023-07-26 02:06:58] [config] authors: false
[2023-07-26 02:06:58] [config] beam-size: 12
[2023-07-26 02:06:58] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:06:58] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:06:58] [config] bert-masking-fraction: 0.15
[2023-07-26 02:06:58] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:06:58] [config] bert-train-type-embeddings: true
[2023-07-26 02:06:58] [config] bert-type-vocab-size: 2
[2023-07-26 02:06:58] [config] build-info: ""
[2023-07-26 02:06:58] [config] check-gradient-nan: false
[2023-07-26 02:06:58] [config] check-nan: false
[2023-07-26 02:06:58] [config] cite: false
[2023-07-26 02:06:58] [config] clip-norm: 1
[2023-07-26 02:06:58] [config] cost-scaling:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] cost-type: ce-sum
[2023-07-26 02:06:58] [config] cpu-threads: 0
[2023-07-26 02:06:58] [config] data-threads: 8
[2023-07-26 02:06:58] [config] data-weighting: ""
[2023-07-26 02:06:58] [config] data-weighting-type: sentence
[2023-07-26 02:06:58] [config] dec-cell: gru
[2023-07-26 02:06:58] [config] dec-cell-base-depth: 2
[2023-07-26 02:06:58] [config] dec-cell-high-depth: 1
[2023-07-26 02:06:58] [config] dec-depth: 1
[2023-07-26 02:06:58] [config] devices:
[2023-07-26 02:06:58] [config]   - 0
[2023-07-26 02:06:58] [config]   - 1
[2023-07-26 02:06:58] [config] dim-emb: 512
[2023-07-26 02:06:58] [config] dim-rnn: 1024
[2023-07-26 02:06:58] [config] dim-vocabs:
[2023-07-26 02:06:58] [config]   - 54042
[2023-07-26 02:06:58] [config]   - 36507
[2023-07-26 02:06:58] [config] disp-first: 0
[2023-07-26 02:06:58] [config] disp-freq: 1000u
[2023-07-26 02:06:58] [config] disp-label-counts: true
[2023-07-26 02:06:58] [config] dropout-rnn: 0
[2023-07-26 02:06:58] [config] dropout-src: 0
[2023-07-26 02:06:58] [config] dropout-trg: 0
[2023-07-26 02:06:58] [config] dump-config: ""
[2023-07-26 02:06:58] [config] dynamic-gradient-scaling:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] early-stopping: 200
[2023-07-26 02:06:58] [config] early-stopping-on: first
[2023-07-26 02:06:58] [config] embedding-fix-src: false
[2023-07-26 02:06:58] [config] embedding-fix-trg: false
[2023-07-26 02:06:58] [config] embedding-normalization: false
[2023-07-26 02:06:58] [config] embedding-vectors:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] enc-cell: gru
[2023-07-26 02:06:58] [config] enc-cell-depth: 1
[2023-07-26 02:06:58] [config] enc-depth: 1
[2023-07-26 02:06:58] [config] enc-type: bidirectional
[2023-07-26 02:06:58] [config] english-title-case-every: 0
[2023-07-26 02:06:58] [config] exponential-smoothing: 0
[2023-07-26 02:06:58] [config] factor-weight: 1
[2023-07-26 02:06:58] [config] factors-combine: sum
[2023-07-26 02:06:58] [config] factors-dim-emb: 0
[2023-07-26 02:06:58] [config] gradient-checkpointing: false
[2023-07-26 02:06:58] [config] gradient-norm-average-window: 100
[2023-07-26 02:06:58] [config] guided-alignment: none
[2023-07-26 02:06:58] [config] guided-alignment-cost: mse
[2023-07-26 02:06:58] [config] guided-alignment-weight: 0.1
[2023-07-26 02:06:58] [config] ignore-model-config: false
[2023-07-26 02:06:58] [config] input-types:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] interpolate-env-vars: false
[2023-07-26 02:06:58] [config] keep-best: false
[2023-07-26 02:06:58] [config] label-smoothing: 0
[2023-07-26 02:06:58] [config] layer-normalization: false
[2023-07-26 02:06:58] [config] learn-rate: 0.0001
[2023-07-26 02:06:58] [config] lemma-dependency: ""
[2023-07-26 02:06:58] [config] lemma-dim-emb: 0
[2023-07-26 02:06:58] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:06:58] [config] log-level: info
[2023-07-26 02:06:58] [config] log-time-zone: ""
[2023-07-26 02:06:58] [config] logical-epoch:
[2023-07-26 02:06:58] [config]   - 1e
[2023-07-26 02:06:58] [config]   - 0
[2023-07-26 02:06:58] [config] lr-decay: 0
[2023-07-26 02:06:58] [config] lr-decay-freq: 50000
[2023-07-26 02:06:58] [config] lr-decay-inv-sqrt:
[2023-07-26 02:06:58] [config]   - 0
[2023-07-26 02:06:58] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:06:58] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:06:58] [config] lr-decay-start:
[2023-07-26 02:06:58] [config]   - 10
[2023-07-26 02:06:58] [config]   - 1
[2023-07-26 02:06:58] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:06:58] [config] lr-report: false
[2023-07-26 02:06:58] [config] lr-warmup: 0
[2023-07-26 02:06:58] [config] lr-warmup-at-reload: false
[2023-07-26 02:06:58] [config] lr-warmup-cycle: false
[2023-07-26 02:06:58] [config] lr-warmup-start-rate: 0
[2023-07-26 02:06:58] [config] max-length: 50
[2023-07-26 02:06:58] [config] max-length-crop: false
[2023-07-26 02:06:58] [config] max-length-factor: 3
[2023-07-26 02:06:58] [config] maxi-batch: 100
[2023-07-26 02:06:58] [config] maxi-batch-sort: trg
[2023-07-26 02:06:58] [config] mini-batch: 64
[2023-07-26 02:06:58] [config] mini-batch-fit: false
[2023-07-26 02:06:58] [config] mini-batch-fit-step: 10
[2023-07-26 02:06:58] [config] mini-batch-round-up: true
[2023-07-26 02:06:58] [config] mini-batch-track-lr: false
[2023-07-26 02:06:58] [config] mini-batch-warmup: 0
[2023-07-26 02:06:58] [config] mini-batch-words: 0
[2023-07-26 02:06:58] [config] mini-batch-words-ref: 0
[2023-07-26 02:06:58] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:06:58] [config] multi-loss-type: sum
[2023-07-26 02:06:58] [config] n-best: false
[2023-07-26 02:06:58] [config] no-nccl: false
[2023-07-26 02:06:58] [config] no-reload: false
[2023-07-26 02:06:58] [config] no-restore-corpus: false
[2023-07-26 02:06:58] [config] normalize: 0
[2023-07-26 02:06:58] [config] normalize-gradient: false
[2023-07-26 02:06:58] [config] num-devices: 0
[2023-07-26 02:06:58] [config] optimizer: adam
[2023-07-26 02:06:58] [config] optimizer-delay: 1
[2023-07-26 02:06:58] [config] optimizer-params:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] output-omit-bias: false
[2023-07-26 02:06:58] [config] overwrite: true
[2023-07-26 02:06:58] [config] precision:
[2023-07-26 02:06:58] [config]   - float32
[2023-07-26 02:06:58] [config]   - float32
[2023-07-26 02:06:58] [config] pretrained-model: ""
[2023-07-26 02:06:58] [config] quantize-biases: false
[2023-07-26 02:06:58] [config] quantize-bits: 0
[2023-07-26 02:06:58] [config] quantize-log-based: false
[2023-07-26 02:06:58] [config] quantize-optimization-steps: 0
[2023-07-26 02:06:58] [config] quiet: false
[2023-07-26 02:06:58] [config] quiet-translation: true
[2023-07-26 02:06:58] [config] relative-paths: false
[2023-07-26 02:06:58] [config] right-left: false
[2023-07-26 02:06:58] [config] save-freq: 10000u
[2023-07-26 02:06:58] [config] seed: 1234
[2023-07-26 02:06:58] [config] sentencepiece-alphas:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:06:58] [config] sentencepiece-options: ""
[2023-07-26 02:06:58] [config] sharding: global
[2023-07-26 02:06:58] [config] shuffle: data
[2023-07-26 02:06:58] [config] shuffle-in-ram: false
[2023-07-26 02:06:58] [config] sigterm: save-and-exit
[2023-07-26 02:06:58] [config] skip: false
[2023-07-26 02:06:58] [config] sqlite: ""
[2023-07-26 02:06:58] [config] sqlite-drop: false
[2023-07-26 02:06:58] [config] sync-freq: 200u
[2023-07-26 02:06:58] [config] sync-sgd: false
[2023-07-26 02:06:58] [config] tempdir: /tmp
[2023-07-26 02:06:58] [config] tied-embeddings: false
[2023-07-26 02:06:58] [config] tied-embeddings-all: false
[2023-07-26 02:06:58] [config] tied-embeddings-src: false
[2023-07-26 02:06:58] [config] train-embedder-rank:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] train-sets:
[2023-07-26 02:06:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:06:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:06:58] [config] transformer-aan-activation: swish
[2023-07-26 02:06:58] [config] transformer-aan-depth: 2
[2023-07-26 02:06:58] [config] transformer-aan-nogate: false
[2023-07-26 02:06:58] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:06:58] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:06:58] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:06:58] [config] transformer-depth-scaling: false
[2023-07-26 02:06:58] [config] transformer-dim-aan: 2048
[2023-07-26 02:06:58] [config] transformer-dim-ffn: 2048
[2023-07-26 02:06:58] [config] transformer-dropout: 0
[2023-07-26 02:06:58] [config] transformer-dropout-attention: 0
[2023-07-26 02:06:58] [config] transformer-dropout-ffn: 0
[2023-07-26 02:06:58] [config] transformer-ffn-activation: swish
[2023-07-26 02:06:58] [config] transformer-ffn-depth: 2
[2023-07-26 02:06:58] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:06:58] [config] transformer-heads: 8
[2023-07-26 02:06:58] [config] transformer-no-projection: false
[2023-07-26 02:06:58] [config] transformer-pool: false
[2023-07-26 02:06:58] [config] transformer-postprocess: dan
[2023-07-26 02:06:58] [config] transformer-postprocess-emb: d
[2023-07-26 02:06:58] [config] transformer-postprocess-top: ""
[2023-07-26 02:06:58] [config] transformer-preprocess: ""
[2023-07-26 02:06:58] [config] transformer-tied-layers:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] transformer-train-position-embeddings: false
[2023-07-26 02:06:58] [config] tsv: false
[2023-07-26 02:06:58] [config] tsv-fields: 0
[2023-07-26 02:06:58] [config] type: s2s
[2023-07-26 02:06:58] [config] ulr: false
[2023-07-26 02:06:58] [config] ulr-dim-emb: 0
[2023-07-26 02:06:58] [config] ulr-dropout: 0
[2023-07-26 02:06:58] [config] ulr-keys-vectors: ""
[2023-07-26 02:06:58] [config] ulr-query-vectors: ""
[2023-07-26 02:06:58] [config] ulr-softmax-temperature: 1
[2023-07-26 02:06:58] [config] ulr-trainable-transformation: false
[2023-07-26 02:06:58] [config] unlikelihood-loss: false
[2023-07-26 02:06:58] [config] valid-freq: 50000000
[2023-07-26 02:06:58] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:06:58] [config] valid-max-length: 1000
[2023-07-26 02:06:58] [config] valid-metrics:
[2023-07-26 02:06:58] [config]   - cross-entropy
[2023-07-26 02:06:58] [config]   - translation
[2023-07-26 02:06:58] [config] valid-mini-batch: 32
[2023-07-26 02:06:58] [config] valid-reset-stalled: false
[2023-07-26 02:06:58] [config] valid-script-args:
[2023-07-26 02:06:58] [config]   []
[2023-07-26 02:06:58] [config] valid-script-path: ""
[2023-07-26 02:06:58] [config] valid-sets:
[2023-07-26 02:06:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:06:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:06:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:06:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:06:58] [config] vocabs:
[2023-07-26 02:06:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:06:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:06:58] [config] word-penalty: 0
[2023-07-26 02:06:58] [config] word-scores: false
[2023-07-26 02:06:58] [config] workspace: 2048
[2023-07-26 02:06:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:06:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:06:58] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:06:58] Using asynchronous training
[2023-07-26 02:06:58] Synced seed 1234
[2023-07-26 02:06:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:06:58] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:06:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:06:58] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:06:58] [valid] No post-processing script given for validating translator
[2023-07-26 02:06:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:06:59] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:07:00] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:07:00] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:07:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:07:00] [comm] Using global sharding
[2023-07-26 02:07:00] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:07:00] [training] Using 2 GPUs
[2023-07-26 02:07:00] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:07:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:07:03] Loading Adam parameters
[2023-07-26 02:07:04] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:07:04] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:07:04] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:07:04] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:07:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:07:04] [data] Restoring the corpus state to epoch 101, batch 29623
[2023-07-26 02:07:04] [data] Shuffling data
[2023-07-26 02:07:04] [data] Done reading 20,192 sentences
[2023-07-26 02:07:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:07:04] Training started
[2023-07-26 02:07:04] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:07:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:07:05] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:07:05] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:07:05] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:07:05] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:07:05] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:07:05] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:07:05] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:07:33] Seen 18,555 samples
[2023-07-26 02:07:33] Starting data epoch 102 in logical epoch 102
[2023-07-26 02:07:33] [data] Shuffling data
[2023-07-26 02:07:33] [data] Done reading 20,192 sentences
[2023-07-26 02:07:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:07:42] Ep. 102 : Up. 30000 : Sen. 5,632 : Cost 0.02392099 * 1,342,286 @ 192 after 40,252,683 : Time 43.19s : 31077.71 words/s : gNorm 0.0000
[2023-07-26 02:07:42] TODO: implement exponential smoothing!
[2023-07-26 02:07:42] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:07:45] Saving Adam parameters
[2023-07-26 02:07:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:08:14] Seen 18,843 samples
[2023-07-26 02:08:14] Starting data epoch 103 in logical epoch 103
[2023-07-26 02:08:14] [data] Shuffling data
[2023-07-26 02:08:14] [data] Done reading 20,192 sentences
[2023-07-26 02:08:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:08:43] Seen 18,843 samples
[2023-07-26 02:08:43] Starting data epoch 104 in logical epoch 104
[2023-07-26 02:08:43] [data] Shuffling data
[2023-07-26 02:08:43] [data] Done reading 20,192 sentences
[2023-07-26 02:08:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:09:13] Seen 18,843 samples
[2023-07-26 02:09:13] Starting data epoch 105 in logical epoch 105
[2023-07-26 02:09:13] [data] Shuffling data
[2023-07-26 02:09:13] [data] Done reading 20,192 sentences
[2023-07-26 02:09:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:09:33] Ep. 105 : Up. 31000 : Sen. 12,498 : Cost 0.01937579 * 1,342,364 @ 2,048 after 41,595,047 : Time 111.60s : 12028.44 words/s : gNorm 0.0000
[2023-07-26 02:09:43] Seen 18,877 samples
[2023-07-26 02:09:43] Starting data epoch 106 in logical epoch 106
[2023-07-26 02:09:43] [data] Shuffling data
[2023-07-26 02:09:43] [data] Done reading 20,192 sentences
[2023-07-26 02:09:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:10:14] Seen 18,809 samples
[2023-07-26 02:10:14] Starting data epoch 107 in logical epoch 107
[2023-07-26 02:10:14] [data] Shuffling data
[2023-07-26 02:10:14] [data] Done reading 20,192 sentences
[2023-07-26 02:10:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:10:44] Seen 18,843 samples
[2023-07-26 02:10:44] Starting data epoch 108 in logical epoch 108
[2023-07-26 02:10:44] [data] Shuffling data
[2023-07-26 02:10:44] [data] Done reading 20,192 sentences
[2023-07-26 02:10:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:11:14] Seen 18,843 samples
[2023-07-26 02:11:14] Starting data epoch 109 in logical epoch 109
[2023-07-26 02:11:14] [data] Shuffling data
[2023-07-26 02:11:14] [data] Done reading 20,192 sentences
[2023-07-26 02:11:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:11:15] Ep. 109 : Up. 32000 : Sen. 576 : Cost 0.01724194 * 1,334,219 @ 1,984 after 42,929,266 : Time 101.63s : 13128.55 words/s : gNorm 0.0000
[2023-07-26 02:11:44] Seen 18,843 samples
[2023-07-26 02:11:44] Starting data epoch 110 in logical epoch 110
[2023-07-26 02:11:44] [data] Shuffling data
[2023-07-26 02:11:44] [data] Done reading 20,192 sentences
[2023-07-26 02:11:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:12:14] Seen 18,843 samples
[2023-07-26 02:12:14] Starting data epoch 111 in logical epoch 111
[2023-07-26 02:12:14] Training finished
[2023-07-26 02:12:18] [valid] Ep. 111 : Up. 32588 : cross-entropy : 189.563 : stalled 9 times (last best: 103.711)
[2023-07-26 02:13:15] [valid] Ep. 111 : Up. 32588 : translation : 0 : new best
[2023-07-26 02:13:15] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:13:19] Saving Adam parameters
[2023-07-26 02:13:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:13:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:13:31] [marian] Running on node19.datos.cluster.uy as process 17030 with command line:
[2023-07-26 02:13:31] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:13:31] [config] after: 0e
[2023-07-26 02:13:31] [config] after-batches: 0
[2023-07-26 02:13:31] [config] after-epochs: 120
[2023-07-26 02:13:31] [config] all-caps-every: 0
[2023-07-26 02:13:31] [config] allow-unk: false
[2023-07-26 02:13:31] [config] authors: false
[2023-07-26 02:13:31] [config] beam-size: 12
[2023-07-26 02:13:31] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:13:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:13:31] [config] bert-masking-fraction: 0.15
[2023-07-26 02:13:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:13:31] [config] bert-train-type-embeddings: true
[2023-07-26 02:13:31] [config] bert-type-vocab-size: 2
[2023-07-26 02:13:31] [config] build-info: ""
[2023-07-26 02:13:31] [config] check-gradient-nan: false
[2023-07-26 02:13:31] [config] check-nan: false
[2023-07-26 02:13:31] [config] cite: false
[2023-07-26 02:13:31] [config] clip-norm: 1
[2023-07-26 02:13:31] [config] cost-scaling:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] cost-type: ce-sum
[2023-07-26 02:13:31] [config] cpu-threads: 0
[2023-07-26 02:13:31] [config] data-threads: 8
[2023-07-26 02:13:31] [config] data-weighting: ""
[2023-07-26 02:13:31] [config] data-weighting-type: sentence
[2023-07-26 02:13:31] [config] dec-cell: gru
[2023-07-26 02:13:31] [config] dec-cell-base-depth: 2
[2023-07-26 02:13:31] [config] dec-cell-high-depth: 1
[2023-07-26 02:13:31] [config] dec-depth: 1
[2023-07-26 02:13:31] [config] devices:
[2023-07-26 02:13:31] [config]   - 0
[2023-07-26 02:13:31] [config]   - 1
[2023-07-26 02:13:31] [config] dim-emb: 512
[2023-07-26 02:13:31] [config] dim-rnn: 1024
[2023-07-26 02:13:31] [config] dim-vocabs:
[2023-07-26 02:13:31] [config]   - 54042
[2023-07-26 02:13:31] [config]   - 36507
[2023-07-26 02:13:31] [config] disp-first: 0
[2023-07-26 02:13:31] [config] disp-freq: 1000u
[2023-07-26 02:13:31] [config] disp-label-counts: true
[2023-07-26 02:13:31] [config] dropout-rnn: 0
[2023-07-26 02:13:31] [config] dropout-src: 0
[2023-07-26 02:13:31] [config] dropout-trg: 0
[2023-07-26 02:13:31] [config] dump-config: ""
[2023-07-26 02:13:31] [config] dynamic-gradient-scaling:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] early-stopping: 200
[2023-07-26 02:13:31] [config] early-stopping-on: first
[2023-07-26 02:13:31] [config] embedding-fix-src: false
[2023-07-26 02:13:31] [config] embedding-fix-trg: false
[2023-07-26 02:13:31] [config] embedding-normalization: false
[2023-07-26 02:13:31] [config] embedding-vectors:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] enc-cell: gru
[2023-07-26 02:13:31] [config] enc-cell-depth: 1
[2023-07-26 02:13:31] [config] enc-depth: 1
[2023-07-26 02:13:31] [config] enc-type: bidirectional
[2023-07-26 02:13:31] [config] english-title-case-every: 0
[2023-07-26 02:13:31] [config] exponential-smoothing: 0
[2023-07-26 02:13:31] [config] factor-weight: 1
[2023-07-26 02:13:31] [config] factors-combine: sum
[2023-07-26 02:13:31] [config] factors-dim-emb: 0
[2023-07-26 02:13:31] [config] gradient-checkpointing: false
[2023-07-26 02:13:31] [config] gradient-norm-average-window: 100
[2023-07-26 02:13:31] [config] guided-alignment: none
[2023-07-26 02:13:31] [config] guided-alignment-cost: mse
[2023-07-26 02:13:31] [config] guided-alignment-weight: 0.1
[2023-07-26 02:13:31] [config] ignore-model-config: false
[2023-07-26 02:13:31] [config] input-types:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] interpolate-env-vars: false
[2023-07-26 02:13:31] [config] keep-best: false
[2023-07-26 02:13:31] [config] label-smoothing: 0
[2023-07-26 02:13:31] [config] layer-normalization: false
[2023-07-26 02:13:31] [config] learn-rate: 0.0001
[2023-07-26 02:13:31] [config] lemma-dependency: ""
[2023-07-26 02:13:31] [config] lemma-dim-emb: 0
[2023-07-26 02:13:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:13:31] [config] log-level: info
[2023-07-26 02:13:31] [config] log-time-zone: ""
[2023-07-26 02:13:31] [config] logical-epoch:
[2023-07-26 02:13:31] [config]   - 1e
[2023-07-26 02:13:31] [config]   - 0
[2023-07-26 02:13:31] [config] lr-decay: 0
[2023-07-26 02:13:31] [config] lr-decay-freq: 50000
[2023-07-26 02:13:31] [config] lr-decay-inv-sqrt:
[2023-07-26 02:13:31] [config]   - 0
[2023-07-26 02:13:31] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:13:31] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:13:31] [config] lr-decay-start:
[2023-07-26 02:13:31] [config]   - 10
[2023-07-26 02:13:31] [config]   - 1
[2023-07-26 02:13:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:13:31] [config] lr-report: false
[2023-07-26 02:13:31] [config] lr-warmup: 0
[2023-07-26 02:13:31] [config] lr-warmup-at-reload: false
[2023-07-26 02:13:31] [config] lr-warmup-cycle: false
[2023-07-26 02:13:31] [config] lr-warmup-start-rate: 0
[2023-07-26 02:13:31] [config] max-length: 50
[2023-07-26 02:13:31] [config] max-length-crop: false
[2023-07-26 02:13:31] [config] max-length-factor: 3
[2023-07-26 02:13:31] [config] maxi-batch: 100
[2023-07-26 02:13:31] [config] maxi-batch-sort: trg
[2023-07-26 02:13:31] [config] mini-batch: 64
[2023-07-26 02:13:31] [config] mini-batch-fit: false
[2023-07-26 02:13:31] [config] mini-batch-fit-step: 10
[2023-07-26 02:13:31] [config] mini-batch-round-up: true
[2023-07-26 02:13:31] [config] mini-batch-track-lr: false
[2023-07-26 02:13:31] [config] mini-batch-warmup: 0
[2023-07-26 02:13:31] [config] mini-batch-words: 0
[2023-07-26 02:13:31] [config] mini-batch-words-ref: 0
[2023-07-26 02:13:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:13:31] [config] multi-loss-type: sum
[2023-07-26 02:13:31] [config] n-best: false
[2023-07-26 02:13:31] [config] no-nccl: false
[2023-07-26 02:13:31] [config] no-reload: false
[2023-07-26 02:13:31] [config] no-restore-corpus: false
[2023-07-26 02:13:31] [config] normalize: 0
[2023-07-26 02:13:31] [config] normalize-gradient: false
[2023-07-26 02:13:31] [config] num-devices: 0
[2023-07-26 02:13:31] [config] optimizer: adam
[2023-07-26 02:13:31] [config] optimizer-delay: 1
[2023-07-26 02:13:31] [config] optimizer-params:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] output-omit-bias: false
[2023-07-26 02:13:31] [config] overwrite: true
[2023-07-26 02:13:31] [config] precision:
[2023-07-26 02:13:31] [config]   - float32
[2023-07-26 02:13:31] [config]   - float32
[2023-07-26 02:13:31] [config] pretrained-model: ""
[2023-07-26 02:13:31] [config] quantize-biases: false
[2023-07-26 02:13:31] [config] quantize-bits: 0
[2023-07-26 02:13:31] [config] quantize-log-based: false
[2023-07-26 02:13:31] [config] quantize-optimization-steps: 0
[2023-07-26 02:13:31] [config] quiet: false
[2023-07-26 02:13:31] [config] quiet-translation: true
[2023-07-26 02:13:31] [config] relative-paths: false
[2023-07-26 02:13:31] [config] right-left: false
[2023-07-26 02:13:31] [config] save-freq: 10000u
[2023-07-26 02:13:31] [config] seed: 1234
[2023-07-26 02:13:31] [config] sentencepiece-alphas:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:13:31] [config] sentencepiece-options: ""
[2023-07-26 02:13:31] [config] sharding: global
[2023-07-26 02:13:31] [config] shuffle: data
[2023-07-26 02:13:31] [config] shuffle-in-ram: false
[2023-07-26 02:13:31] [config] sigterm: save-and-exit
[2023-07-26 02:13:31] [config] skip: false
[2023-07-26 02:13:31] [config] sqlite: ""
[2023-07-26 02:13:31] [config] sqlite-drop: false
[2023-07-26 02:13:31] [config] sync-freq: 200u
[2023-07-26 02:13:31] [config] sync-sgd: false
[2023-07-26 02:13:31] [config] tempdir: /tmp
[2023-07-26 02:13:31] [config] tied-embeddings: false
[2023-07-26 02:13:31] [config] tied-embeddings-all: false
[2023-07-26 02:13:31] [config] tied-embeddings-src: false
[2023-07-26 02:13:31] [config] train-embedder-rank:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] train-sets:
[2023-07-26 02:13:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:13:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:13:31] [config] transformer-aan-activation: swish
[2023-07-26 02:13:31] [config] transformer-aan-depth: 2
[2023-07-26 02:13:31] [config] transformer-aan-nogate: false
[2023-07-26 02:13:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:13:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:13:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:13:31] [config] transformer-depth-scaling: false
[2023-07-26 02:13:31] [config] transformer-dim-aan: 2048
[2023-07-26 02:13:31] [config] transformer-dim-ffn: 2048
[2023-07-26 02:13:31] [config] transformer-dropout: 0
[2023-07-26 02:13:31] [config] transformer-dropout-attention: 0
[2023-07-26 02:13:31] [config] transformer-dropout-ffn: 0
[2023-07-26 02:13:31] [config] transformer-ffn-activation: swish
[2023-07-26 02:13:31] [config] transformer-ffn-depth: 2
[2023-07-26 02:13:31] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:13:31] [config] transformer-heads: 8
[2023-07-26 02:13:31] [config] transformer-no-projection: false
[2023-07-26 02:13:31] [config] transformer-pool: false
[2023-07-26 02:13:31] [config] transformer-postprocess: dan
[2023-07-26 02:13:31] [config] transformer-postprocess-emb: d
[2023-07-26 02:13:31] [config] transformer-postprocess-top: ""
[2023-07-26 02:13:31] [config] transformer-preprocess: ""
[2023-07-26 02:13:31] [config] transformer-tied-layers:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] transformer-train-position-embeddings: false
[2023-07-26 02:13:31] [config] tsv: false
[2023-07-26 02:13:31] [config] tsv-fields: 0
[2023-07-26 02:13:31] [config] type: s2s
[2023-07-26 02:13:31] [config] ulr: false
[2023-07-26 02:13:31] [config] ulr-dim-emb: 0
[2023-07-26 02:13:31] [config] ulr-dropout: 0
[2023-07-26 02:13:31] [config] ulr-keys-vectors: ""
[2023-07-26 02:13:31] [config] ulr-query-vectors: ""
[2023-07-26 02:13:31] [config] ulr-softmax-temperature: 1
[2023-07-26 02:13:31] [config] ulr-trainable-transformation: false
[2023-07-26 02:13:31] [config] unlikelihood-loss: false
[2023-07-26 02:13:31] [config] valid-freq: 50000000
[2023-07-26 02:13:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:13:31] [config] valid-max-length: 1000
[2023-07-26 02:13:31] [config] valid-metrics:
[2023-07-26 02:13:31] [config]   - cross-entropy
[2023-07-26 02:13:31] [config]   - translation
[2023-07-26 02:13:31] [config] valid-mini-batch: 32
[2023-07-26 02:13:31] [config] valid-reset-stalled: false
[2023-07-26 02:13:31] [config] valid-script-args:
[2023-07-26 02:13:31] [config]   []
[2023-07-26 02:13:31] [config] valid-script-path: ""
[2023-07-26 02:13:31] [config] valid-sets:
[2023-07-26 02:13:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:13:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:13:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:13:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:13:31] [config] vocabs:
[2023-07-26 02:13:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:13:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:13:31] [config] word-penalty: 0
[2023-07-26 02:13:31] [config] word-scores: false
[2023-07-26 02:13:31] [config] workspace: 2048
[2023-07-26 02:13:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:13:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:13:31] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:13:31] Using asynchronous training
[2023-07-26 02:13:32] Synced seed 1234
[2023-07-26 02:13:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:13:32] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:13:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:13:32] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:13:32] [valid] No post-processing script given for validating translator
[2023-07-26 02:13:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:13:32] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:13:33] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:13:33] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:13:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:13:33] [comm] Using global sharding
[2023-07-26 02:13:33] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:13:33] [training] Using 2 GPUs
[2023-07-26 02:13:33] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:13:34] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:13:36] Loading Adam parameters
[2023-07-26 02:13:37] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:13:37] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:13:37] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:13:37] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:13:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:13:38] [data] Restoring the corpus state to epoch 111, batch 32588
[2023-07-26 02:13:38] [data] Shuffling data
[2023-07-26 02:13:38] [data] Done reading 20,192 sentences
[2023-07-26 02:13:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:13:38] Training started
[2023-07-26 02:13:38] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:13:38] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:13:38] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:13:38] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:13:38] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:13:38] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:13:38] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:13:38] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:13:38] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:14:06] Seen 18,587 samples
[2023-07-26 02:14:06] Starting data epoch 112 in logical epoch 112
[2023-07-26 02:14:06] [data] Shuffling data
[2023-07-26 02:14:06] [data] Done reading 20,192 sentences
[2023-07-26 02:14:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:14:18] Ep. 112 : Up. 33000 : Sen. 7,856 : Cost 0.01511169 * 1,340,568 @ 128 after 44,269,834 : Time 45.71s : 29327.07 words/s : gNorm 0.0000
[2023-07-26 02:14:35] Seen 18,843 samples
[2023-07-26 02:14:35] Starting data epoch 113 in logical epoch 113
[2023-07-26 02:14:35] [data] Shuffling data
[2023-07-26 02:14:35] [data] Done reading 20,192 sentences
[2023-07-26 02:14:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:15:05] Seen 18,843 samples
[2023-07-26 02:15:05] Starting data epoch 114 in logical epoch 114
[2023-07-26 02:15:05] [data] Shuffling data
[2023-07-26 02:15:05] [data] Done reading 20,192 sentences
[2023-07-26 02:15:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:15:34] Seen 18,843 samples
[2023-07-26 02:15:34] Starting data epoch 115 in logical epoch 115
[2023-07-26 02:15:34] [data] Shuffling data
[2023-07-26 02:15:34] [data] Done reading 20,192 sentences
[2023-07-26 02:15:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:15:57] Ep. 115 : Up. 34000 : Sen. 14,836 : Cost 0.01349421 * 1,341,284 @ 301 after 45,611,118 : Time 99.70s : 13453.28 words/s : gNorm 0.0000
[2023-07-26 02:16:04] Seen 18,878 samples
[2023-07-26 02:16:04] Starting data epoch 116 in logical epoch 116
[2023-07-26 02:16:04] [data] Shuffling data
[2023-07-26 02:16:04] [data] Done reading 20,192 sentences
[2023-07-26 02:16:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:16:34] Seen 18,838 samples
[2023-07-26 02:16:34] Starting data epoch 117 in logical epoch 117
[2023-07-26 02:16:34] [data] Shuffling data
[2023-07-26 02:16:34] [data] Done reading 20,192 sentences
[2023-07-26 02:16:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:17:04] Seen 18,813 samples
[2023-07-26 02:17:04] Starting data epoch 118 in logical epoch 118
[2023-07-26 02:17:04] [data] Shuffling data
[2023-07-26 02:17:04] [data] Done reading 20,192 sentences
[2023-07-26 02:17:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:17:34] Seen 18,843 samples
[2023-07-26 02:17:34] Starting data epoch 119 in logical epoch 119
[2023-07-26 02:17:34] [data] Shuffling data
[2023-07-26 02:17:34] [data] Done reading 20,192 sentences
[2023-07-26 02:17:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:17:38] Ep. 119 : Up. 35000 : Sen. 3,008 : Cost 0.01188329 * 1,341,750 @ 1,152 after 46,952,868 : Time 100.89s : 13298.79 words/s : gNorm 0.0000
[2023-07-26 02:18:04] Seen 18,876 samples
[2023-07-26 02:18:04] Starting data epoch 120 in logical epoch 120
[2023-07-26 02:18:04] [data] Shuffling data
[2023-07-26 02:18:04] [data] Done reading 20,192 sentences
[2023-07-26 02:18:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:18:33] Seen 18,810 samples
[2023-07-26 02:18:33] Starting data epoch 121 in logical epoch 121
[2023-07-26 02:18:33] Training finished
[2023-07-26 02:18:37] [valid] Ep. 121 : Up. 35549 : cross-entropy : 194.81 : stalled 10 times (last best: 103.711)
[2023-07-26 02:19:33] [valid] Ep. 121 : Up. 35549 : translation : 0 : new best
[2023-07-26 02:19:33] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:19:38] Saving Adam parameters
[2023-07-26 02:19:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:19:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:19:51] [marian] Running on node19.datos.cluster.uy as process 39983 with command line:
[2023-07-26 02:19:51] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:19:51] [config] after: 0e
[2023-07-26 02:19:51] [config] after-batches: 0
[2023-07-26 02:19:51] [config] after-epochs: 130
[2023-07-26 02:19:51] [config] all-caps-every: 0
[2023-07-26 02:19:51] [config] allow-unk: false
[2023-07-26 02:19:51] [config] authors: false
[2023-07-26 02:19:51] [config] beam-size: 12
[2023-07-26 02:19:51] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:19:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:19:51] [config] bert-masking-fraction: 0.15
[2023-07-26 02:19:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:19:51] [config] bert-train-type-embeddings: true
[2023-07-26 02:19:51] [config] bert-type-vocab-size: 2
[2023-07-26 02:19:51] [config] build-info: ""
[2023-07-26 02:19:51] [config] check-gradient-nan: false
[2023-07-26 02:19:51] [config] check-nan: false
[2023-07-26 02:19:51] [config] cite: false
[2023-07-26 02:19:51] [config] clip-norm: 1
[2023-07-26 02:19:51] [config] cost-scaling:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] cost-type: ce-sum
[2023-07-26 02:19:51] [config] cpu-threads: 0
[2023-07-26 02:19:51] [config] data-threads: 8
[2023-07-26 02:19:51] [config] data-weighting: ""
[2023-07-26 02:19:51] [config] data-weighting-type: sentence
[2023-07-26 02:19:51] [config] dec-cell: gru
[2023-07-26 02:19:51] [config] dec-cell-base-depth: 2
[2023-07-26 02:19:51] [config] dec-cell-high-depth: 1
[2023-07-26 02:19:51] [config] dec-depth: 1
[2023-07-26 02:19:51] [config] devices:
[2023-07-26 02:19:51] [config]   - 0
[2023-07-26 02:19:51] [config]   - 1
[2023-07-26 02:19:51] [config] dim-emb: 512
[2023-07-26 02:19:51] [config] dim-rnn: 1024
[2023-07-26 02:19:51] [config] dim-vocabs:
[2023-07-26 02:19:51] [config]   - 54042
[2023-07-26 02:19:51] [config]   - 36507
[2023-07-26 02:19:51] [config] disp-first: 0
[2023-07-26 02:19:51] [config] disp-freq: 1000u
[2023-07-26 02:19:51] [config] disp-label-counts: true
[2023-07-26 02:19:51] [config] dropout-rnn: 0
[2023-07-26 02:19:51] [config] dropout-src: 0
[2023-07-26 02:19:51] [config] dropout-trg: 0
[2023-07-26 02:19:51] [config] dump-config: ""
[2023-07-26 02:19:51] [config] dynamic-gradient-scaling:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] early-stopping: 200
[2023-07-26 02:19:51] [config] early-stopping-on: first
[2023-07-26 02:19:51] [config] embedding-fix-src: false
[2023-07-26 02:19:51] [config] embedding-fix-trg: false
[2023-07-26 02:19:51] [config] embedding-normalization: false
[2023-07-26 02:19:51] [config] embedding-vectors:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] enc-cell: gru
[2023-07-26 02:19:51] [config] enc-cell-depth: 1
[2023-07-26 02:19:51] [config] enc-depth: 1
[2023-07-26 02:19:51] [config] enc-type: bidirectional
[2023-07-26 02:19:51] [config] english-title-case-every: 0
[2023-07-26 02:19:51] [config] exponential-smoothing: 0
[2023-07-26 02:19:51] [config] factor-weight: 1
[2023-07-26 02:19:51] [config] factors-combine: sum
[2023-07-26 02:19:51] [config] factors-dim-emb: 0
[2023-07-26 02:19:51] [config] gradient-checkpointing: false
[2023-07-26 02:19:51] [config] gradient-norm-average-window: 100
[2023-07-26 02:19:51] [config] guided-alignment: none
[2023-07-26 02:19:51] [config] guided-alignment-cost: mse
[2023-07-26 02:19:51] [config] guided-alignment-weight: 0.1
[2023-07-26 02:19:51] [config] ignore-model-config: false
[2023-07-26 02:19:51] [config] input-types:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] interpolate-env-vars: false
[2023-07-26 02:19:51] [config] keep-best: false
[2023-07-26 02:19:51] [config] label-smoothing: 0
[2023-07-26 02:19:51] [config] layer-normalization: false
[2023-07-26 02:19:51] [config] learn-rate: 0.0001
[2023-07-26 02:19:51] [config] lemma-dependency: ""
[2023-07-26 02:19:51] [config] lemma-dim-emb: 0
[2023-07-26 02:19:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:19:51] [config] log-level: info
[2023-07-26 02:19:51] [config] log-time-zone: ""
[2023-07-26 02:19:51] [config] logical-epoch:
[2023-07-26 02:19:51] [config]   - 1e
[2023-07-26 02:19:51] [config]   - 0
[2023-07-26 02:19:51] [config] lr-decay: 0
[2023-07-26 02:19:51] [config] lr-decay-freq: 50000
[2023-07-26 02:19:51] [config] lr-decay-inv-sqrt:
[2023-07-26 02:19:51] [config]   - 0
[2023-07-26 02:19:51] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:19:51] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:19:51] [config] lr-decay-start:
[2023-07-26 02:19:51] [config]   - 10
[2023-07-26 02:19:51] [config]   - 1
[2023-07-26 02:19:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:19:51] [config] lr-report: false
[2023-07-26 02:19:51] [config] lr-warmup: 0
[2023-07-26 02:19:51] [config] lr-warmup-at-reload: false
[2023-07-26 02:19:51] [config] lr-warmup-cycle: false
[2023-07-26 02:19:51] [config] lr-warmup-start-rate: 0
[2023-07-26 02:19:51] [config] max-length: 50
[2023-07-26 02:19:51] [config] max-length-crop: false
[2023-07-26 02:19:51] [config] max-length-factor: 3
[2023-07-26 02:19:51] [config] maxi-batch: 100
[2023-07-26 02:19:51] [config] maxi-batch-sort: trg
[2023-07-26 02:19:51] [config] mini-batch: 64
[2023-07-26 02:19:51] [config] mini-batch-fit: false
[2023-07-26 02:19:51] [config] mini-batch-fit-step: 10
[2023-07-26 02:19:51] [config] mini-batch-round-up: true
[2023-07-26 02:19:51] [config] mini-batch-track-lr: false
[2023-07-26 02:19:51] [config] mini-batch-warmup: 0
[2023-07-26 02:19:51] [config] mini-batch-words: 0
[2023-07-26 02:19:51] [config] mini-batch-words-ref: 0
[2023-07-26 02:19:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:19:51] [config] multi-loss-type: sum
[2023-07-26 02:19:51] [config] n-best: false
[2023-07-26 02:19:51] [config] no-nccl: false
[2023-07-26 02:19:51] [config] no-reload: false
[2023-07-26 02:19:51] [config] no-restore-corpus: false
[2023-07-26 02:19:51] [config] normalize: 0
[2023-07-26 02:19:51] [config] normalize-gradient: false
[2023-07-26 02:19:51] [config] num-devices: 0
[2023-07-26 02:19:51] [config] optimizer: adam
[2023-07-26 02:19:51] [config] optimizer-delay: 1
[2023-07-26 02:19:51] [config] optimizer-params:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] output-omit-bias: false
[2023-07-26 02:19:51] [config] overwrite: true
[2023-07-26 02:19:51] [config] precision:
[2023-07-26 02:19:51] [config]   - float32
[2023-07-26 02:19:51] [config]   - float32
[2023-07-26 02:19:51] [config] pretrained-model: ""
[2023-07-26 02:19:51] [config] quantize-biases: false
[2023-07-26 02:19:51] [config] quantize-bits: 0
[2023-07-26 02:19:51] [config] quantize-log-based: false
[2023-07-26 02:19:51] [config] quantize-optimization-steps: 0
[2023-07-26 02:19:51] [config] quiet: false
[2023-07-26 02:19:51] [config] quiet-translation: true
[2023-07-26 02:19:51] [config] relative-paths: false
[2023-07-26 02:19:51] [config] right-left: false
[2023-07-26 02:19:51] [config] save-freq: 10000u
[2023-07-26 02:19:51] [config] seed: 1234
[2023-07-26 02:19:51] [config] sentencepiece-alphas:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:19:51] [config] sentencepiece-options: ""
[2023-07-26 02:19:51] [config] sharding: global
[2023-07-26 02:19:51] [config] shuffle: data
[2023-07-26 02:19:51] [config] shuffle-in-ram: false
[2023-07-26 02:19:51] [config] sigterm: save-and-exit
[2023-07-26 02:19:51] [config] skip: false
[2023-07-26 02:19:51] [config] sqlite: ""
[2023-07-26 02:19:51] [config] sqlite-drop: false
[2023-07-26 02:19:51] [config] sync-freq: 200u
[2023-07-26 02:19:51] [config] sync-sgd: false
[2023-07-26 02:19:51] [config] tempdir: /tmp
[2023-07-26 02:19:51] [config] tied-embeddings: false
[2023-07-26 02:19:51] [config] tied-embeddings-all: false
[2023-07-26 02:19:51] [config] tied-embeddings-src: false
[2023-07-26 02:19:51] [config] train-embedder-rank:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] train-sets:
[2023-07-26 02:19:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:19:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:19:51] [config] transformer-aan-activation: swish
[2023-07-26 02:19:51] [config] transformer-aan-depth: 2
[2023-07-26 02:19:51] [config] transformer-aan-nogate: false
[2023-07-26 02:19:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:19:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:19:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:19:51] [config] transformer-depth-scaling: false
[2023-07-26 02:19:51] [config] transformer-dim-aan: 2048
[2023-07-26 02:19:51] [config] transformer-dim-ffn: 2048
[2023-07-26 02:19:51] [config] transformer-dropout: 0
[2023-07-26 02:19:51] [config] transformer-dropout-attention: 0
[2023-07-26 02:19:51] [config] transformer-dropout-ffn: 0
[2023-07-26 02:19:51] [config] transformer-ffn-activation: swish
[2023-07-26 02:19:51] [config] transformer-ffn-depth: 2
[2023-07-26 02:19:51] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:19:51] [config] transformer-heads: 8
[2023-07-26 02:19:51] [config] transformer-no-projection: false
[2023-07-26 02:19:51] [config] transformer-pool: false
[2023-07-26 02:19:51] [config] transformer-postprocess: dan
[2023-07-26 02:19:51] [config] transformer-postprocess-emb: d
[2023-07-26 02:19:51] [config] transformer-postprocess-top: ""
[2023-07-26 02:19:51] [config] transformer-preprocess: ""
[2023-07-26 02:19:51] [config] transformer-tied-layers:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] transformer-train-position-embeddings: false
[2023-07-26 02:19:51] [config] tsv: false
[2023-07-26 02:19:51] [config] tsv-fields: 0
[2023-07-26 02:19:51] [config] type: s2s
[2023-07-26 02:19:51] [config] ulr: false
[2023-07-26 02:19:51] [config] ulr-dim-emb: 0
[2023-07-26 02:19:51] [config] ulr-dropout: 0
[2023-07-26 02:19:51] [config] ulr-keys-vectors: ""
[2023-07-26 02:19:51] [config] ulr-query-vectors: ""
[2023-07-26 02:19:51] [config] ulr-softmax-temperature: 1
[2023-07-26 02:19:51] [config] ulr-trainable-transformation: false
[2023-07-26 02:19:51] [config] unlikelihood-loss: false
[2023-07-26 02:19:51] [config] valid-freq: 50000000
[2023-07-26 02:19:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:19:51] [config] valid-max-length: 1000
[2023-07-26 02:19:51] [config] valid-metrics:
[2023-07-26 02:19:51] [config]   - cross-entropy
[2023-07-26 02:19:51] [config]   - translation
[2023-07-26 02:19:51] [config] valid-mini-batch: 32
[2023-07-26 02:19:51] [config] valid-reset-stalled: false
[2023-07-26 02:19:51] [config] valid-script-args:
[2023-07-26 02:19:51] [config]   []
[2023-07-26 02:19:51] [config] valid-script-path: ""
[2023-07-26 02:19:51] [config] valid-sets:
[2023-07-26 02:19:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:19:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:19:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:19:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:19:51] [config] vocabs:
[2023-07-26 02:19:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:19:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:19:51] [config] word-penalty: 0
[2023-07-26 02:19:51] [config] word-scores: false
[2023-07-26 02:19:51] [config] workspace: 2048
[2023-07-26 02:19:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:19:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:19:51] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:19:51] Using asynchronous training
[2023-07-26 02:19:52] Synced seed 1234
[2023-07-26 02:19:52] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:19:52] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:19:52] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:19:52] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:19:52] [valid] No post-processing script given for validating translator
[2023-07-26 02:19:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:19:52] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:19:53] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:19:53] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:19:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:19:53] [comm] Using global sharding
[2023-07-26 02:19:53] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:19:53] [training] Using 2 GPUs
[2023-07-26 02:19:53] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:19:54] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:19:56] Loading Adam parameters
[2023-07-26 02:19:56] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:19:57] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:19:57] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:19:57] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:19:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:19:57] [data] Restoring the corpus state to epoch 121, batch 35549
[2023-07-26 02:19:57] [data] Shuffling data
[2023-07-26 02:19:57] [data] Done reading 20,192 sentences
[2023-07-26 02:19:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:19:57] Training started
[2023-07-26 02:19:57] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:19:58] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:19:58] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:19:58] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:19:58] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:19:58] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:19:58] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:19:58] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:19:58] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:20:26] Seen 18,587 samples
[2023-07-26 02:20:26] Starting data epoch 122 in logical epoch 122
[2023-07-26 02:20:26] [data] Shuffling data
[2023-07-26 02:20:26] [data] Done reading 20,192 sentences
[2023-07-26 02:20:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:20:41] Ep. 122 : Up. 36000 : Sen. 10,391 : Cost 0.01025349 * 1,347,651 @ 509 after 48,300,519 : Time 49.73s : 27099.73 words/s : gNorm 0.0000
[2023-07-26 02:20:54] Seen 18,873 samples
[2023-07-26 02:20:54] Starting data epoch 123 in logical epoch 123
[2023-07-26 02:20:54] [data] Shuffling data
[2023-07-26 02:20:55] [data] Done reading 20,192 sentences
[2023-07-26 02:20:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:21:24] Seen 18,841 samples
[2023-07-26 02:21:24] Starting data epoch 124 in logical epoch 124
[2023-07-26 02:21:24] [data] Shuffling data
[2023-07-26 02:21:24] [data] Done reading 20,192 sentences
[2023-07-26 02:21:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:21:54] Seen 18,815 samples
[2023-07-26 02:21:54] Starting data epoch 125 in logical epoch 125
[2023-07-26 02:21:54] [data] Shuffling data
[2023-07-26 02:21:54] [data] Done reading 20,192 sentences
[2023-07-26 02:21:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:22:21] Ep. 125 : Up. 37000 : Sen. 17,407 : Cost 0.00957572 * 1,340,903 @ 1,087 after 49,641,422 : Time 99.79s : 13436.67 words/s : gNorm 0.0000
[2023-07-26 02:22:24] Seen 18,843 samples
[2023-07-26 02:22:24] Starting data epoch 126 in logical epoch 126
[2023-07-26 02:22:24] [data] Shuffling data
[2023-07-26 02:22:24] [data] Done reading 20,192 sentences
[2023-07-26 02:22:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:22:53] Seen 18,868 samples
[2023-07-26 02:22:53] Starting data epoch 127 in logical epoch 127
[2023-07-26 02:22:53] [data] Shuffling data
[2023-07-26 02:22:54] [data] Done reading 20,192 sentences
[2023-07-26 02:22:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:23:23] Seen 18,818 samples
[2023-07-26 02:23:23] Starting data epoch 128 in logical epoch 128
[2023-07-26 02:23:23] [data] Shuffling data
[2023-07-26 02:23:23] [data] Done reading 20,192 sentences
[2023-07-26 02:23:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:23:53] Seen 18,843 samples
[2023-07-26 02:23:53] Starting data epoch 129 in logical epoch 129
[2023-07-26 02:23:53] [data] Shuffling data
[2023-07-26 02:23:53] [data] Done reading 20,192 sentences
[2023-07-26 02:23:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:24:02] Ep. 129 : Up. 38000 : Sen. 5,510 : Cost 0.00903976 * 1,344,849 @ 384 after 50,986,271 : Time 100.80s : 13341.39 words/s : gNorm 0.0000
[2023-07-26 02:24:23] Seen 18,843 samples
[2023-07-26 02:24:23] Starting data epoch 130 in logical epoch 130
[2023-07-26 02:24:23] [data] Shuffling data
[2023-07-26 02:24:23] [data] Done reading 20,192 sentences
[2023-07-26 02:24:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:24:53] Seen 18,879 samples
[2023-07-26 02:24:53] Starting data epoch 131 in logical epoch 131
[2023-07-26 02:24:53] Training finished
[2023-07-26 02:24:57] [valid] Ep. 131 : Up. 38510 : cross-entropy : 198.708 : stalled 11 times (last best: 103.711)
[2023-07-26 02:25:53] [valid] Ep. 131 : Up. 38510 : translation : 0 : new best
[2023-07-26 02:25:53] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:25:57] Saving Adam parameters
[2023-07-26 02:25:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:26:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:26:10] [marian] Running on node19.datos.cluster.uy as process 23996 with command line:
[2023-07-26 02:26:10] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:26:10] [config] after: 0e
[2023-07-26 02:26:10] [config] after-batches: 0
[2023-07-26 02:26:10] [config] after-epochs: 140
[2023-07-26 02:26:10] [config] all-caps-every: 0
[2023-07-26 02:26:10] [config] allow-unk: false
[2023-07-26 02:26:10] [config] authors: false
[2023-07-26 02:26:10] [config] beam-size: 12
[2023-07-26 02:26:10] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:26:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:26:10] [config] bert-masking-fraction: 0.15
[2023-07-26 02:26:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:26:10] [config] bert-train-type-embeddings: true
[2023-07-26 02:26:10] [config] bert-type-vocab-size: 2
[2023-07-26 02:26:10] [config] build-info: ""
[2023-07-26 02:26:10] [config] check-gradient-nan: false
[2023-07-26 02:26:10] [config] check-nan: false
[2023-07-26 02:26:10] [config] cite: false
[2023-07-26 02:26:10] [config] clip-norm: 1
[2023-07-26 02:26:10] [config] cost-scaling:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] cost-type: ce-sum
[2023-07-26 02:26:10] [config] cpu-threads: 0
[2023-07-26 02:26:10] [config] data-threads: 8
[2023-07-26 02:26:10] [config] data-weighting: ""
[2023-07-26 02:26:10] [config] data-weighting-type: sentence
[2023-07-26 02:26:10] [config] dec-cell: gru
[2023-07-26 02:26:10] [config] dec-cell-base-depth: 2
[2023-07-26 02:26:10] [config] dec-cell-high-depth: 1
[2023-07-26 02:26:10] [config] dec-depth: 1
[2023-07-26 02:26:10] [config] devices:
[2023-07-26 02:26:10] [config]   - 0
[2023-07-26 02:26:10] [config]   - 1
[2023-07-26 02:26:10] [config] dim-emb: 512
[2023-07-26 02:26:10] [config] dim-rnn: 1024
[2023-07-26 02:26:10] [config] dim-vocabs:
[2023-07-26 02:26:10] [config]   - 54042
[2023-07-26 02:26:10] [config]   - 36507
[2023-07-26 02:26:10] [config] disp-first: 0
[2023-07-26 02:26:10] [config] disp-freq: 1000u
[2023-07-26 02:26:10] [config] disp-label-counts: true
[2023-07-26 02:26:10] [config] dropout-rnn: 0
[2023-07-26 02:26:10] [config] dropout-src: 0
[2023-07-26 02:26:10] [config] dropout-trg: 0
[2023-07-26 02:26:10] [config] dump-config: ""
[2023-07-26 02:26:10] [config] dynamic-gradient-scaling:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] early-stopping: 200
[2023-07-26 02:26:10] [config] early-stopping-on: first
[2023-07-26 02:26:10] [config] embedding-fix-src: false
[2023-07-26 02:26:10] [config] embedding-fix-trg: false
[2023-07-26 02:26:10] [config] embedding-normalization: false
[2023-07-26 02:26:10] [config] embedding-vectors:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] enc-cell: gru
[2023-07-26 02:26:10] [config] enc-cell-depth: 1
[2023-07-26 02:26:10] [config] enc-depth: 1
[2023-07-26 02:26:10] [config] enc-type: bidirectional
[2023-07-26 02:26:10] [config] english-title-case-every: 0
[2023-07-26 02:26:10] [config] exponential-smoothing: 0
[2023-07-26 02:26:10] [config] factor-weight: 1
[2023-07-26 02:26:10] [config] factors-combine: sum
[2023-07-26 02:26:10] [config] factors-dim-emb: 0
[2023-07-26 02:26:10] [config] gradient-checkpointing: false
[2023-07-26 02:26:10] [config] gradient-norm-average-window: 100
[2023-07-26 02:26:10] [config] guided-alignment: none
[2023-07-26 02:26:10] [config] guided-alignment-cost: mse
[2023-07-26 02:26:10] [config] guided-alignment-weight: 0.1
[2023-07-26 02:26:10] [config] ignore-model-config: false
[2023-07-26 02:26:10] [config] input-types:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] interpolate-env-vars: false
[2023-07-26 02:26:10] [config] keep-best: false
[2023-07-26 02:26:10] [config] label-smoothing: 0
[2023-07-26 02:26:10] [config] layer-normalization: false
[2023-07-26 02:26:10] [config] learn-rate: 0.0001
[2023-07-26 02:26:10] [config] lemma-dependency: ""
[2023-07-26 02:26:10] [config] lemma-dim-emb: 0
[2023-07-26 02:26:10] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:26:10] [config] log-level: info
[2023-07-26 02:26:10] [config] log-time-zone: ""
[2023-07-26 02:26:10] [config] logical-epoch:
[2023-07-26 02:26:10] [config]   - 1e
[2023-07-26 02:26:10] [config]   - 0
[2023-07-26 02:26:10] [config] lr-decay: 0
[2023-07-26 02:26:10] [config] lr-decay-freq: 50000
[2023-07-26 02:26:10] [config] lr-decay-inv-sqrt:
[2023-07-26 02:26:10] [config]   - 0
[2023-07-26 02:26:10] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:26:10] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:26:10] [config] lr-decay-start:
[2023-07-26 02:26:10] [config]   - 10
[2023-07-26 02:26:10] [config]   - 1
[2023-07-26 02:26:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:26:10] [config] lr-report: false
[2023-07-26 02:26:10] [config] lr-warmup: 0
[2023-07-26 02:26:10] [config] lr-warmup-at-reload: false
[2023-07-26 02:26:10] [config] lr-warmup-cycle: false
[2023-07-26 02:26:10] [config] lr-warmup-start-rate: 0
[2023-07-26 02:26:10] [config] max-length: 50
[2023-07-26 02:26:10] [config] max-length-crop: false
[2023-07-26 02:26:10] [config] max-length-factor: 3
[2023-07-26 02:26:10] [config] maxi-batch: 100
[2023-07-26 02:26:10] [config] maxi-batch-sort: trg
[2023-07-26 02:26:10] [config] mini-batch: 64
[2023-07-26 02:26:10] [config] mini-batch-fit: false
[2023-07-26 02:26:10] [config] mini-batch-fit-step: 10
[2023-07-26 02:26:10] [config] mini-batch-round-up: true
[2023-07-26 02:26:10] [config] mini-batch-track-lr: false
[2023-07-26 02:26:10] [config] mini-batch-warmup: 0
[2023-07-26 02:26:10] [config] mini-batch-words: 0
[2023-07-26 02:26:10] [config] mini-batch-words-ref: 0
[2023-07-26 02:26:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:26:10] [config] multi-loss-type: sum
[2023-07-26 02:26:10] [config] n-best: false
[2023-07-26 02:26:10] [config] no-nccl: false
[2023-07-26 02:26:10] [config] no-reload: false
[2023-07-26 02:26:10] [config] no-restore-corpus: false
[2023-07-26 02:26:10] [config] normalize: 0
[2023-07-26 02:26:10] [config] normalize-gradient: false
[2023-07-26 02:26:10] [config] num-devices: 0
[2023-07-26 02:26:10] [config] optimizer: adam
[2023-07-26 02:26:10] [config] optimizer-delay: 1
[2023-07-26 02:26:10] [config] optimizer-params:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] output-omit-bias: false
[2023-07-26 02:26:10] [config] overwrite: true
[2023-07-26 02:26:10] [config] precision:
[2023-07-26 02:26:10] [config]   - float32
[2023-07-26 02:26:10] [config]   - float32
[2023-07-26 02:26:10] [config] pretrained-model: ""
[2023-07-26 02:26:10] [config] quantize-biases: false
[2023-07-26 02:26:10] [config] quantize-bits: 0
[2023-07-26 02:26:10] [config] quantize-log-based: false
[2023-07-26 02:26:10] [config] quantize-optimization-steps: 0
[2023-07-26 02:26:10] [config] quiet: false
[2023-07-26 02:26:10] [config] quiet-translation: true
[2023-07-26 02:26:10] [config] relative-paths: false
[2023-07-26 02:26:10] [config] right-left: false
[2023-07-26 02:26:10] [config] save-freq: 10000u
[2023-07-26 02:26:10] [config] seed: 1234
[2023-07-26 02:26:10] [config] sentencepiece-alphas:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:26:10] [config] sentencepiece-options: ""
[2023-07-26 02:26:10] [config] sharding: global
[2023-07-26 02:26:10] [config] shuffle: data
[2023-07-26 02:26:10] [config] shuffle-in-ram: false
[2023-07-26 02:26:10] [config] sigterm: save-and-exit
[2023-07-26 02:26:10] [config] skip: false
[2023-07-26 02:26:10] [config] sqlite: ""
[2023-07-26 02:26:10] [config] sqlite-drop: false
[2023-07-26 02:26:10] [config] sync-freq: 200u
[2023-07-26 02:26:10] [config] sync-sgd: false
[2023-07-26 02:26:10] [config] tempdir: /tmp
[2023-07-26 02:26:10] [config] tied-embeddings: false
[2023-07-26 02:26:10] [config] tied-embeddings-all: false
[2023-07-26 02:26:10] [config] tied-embeddings-src: false
[2023-07-26 02:26:10] [config] train-embedder-rank:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] train-sets:
[2023-07-26 02:26:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:26:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:26:10] [config] transformer-aan-activation: swish
[2023-07-26 02:26:10] [config] transformer-aan-depth: 2
[2023-07-26 02:26:10] [config] transformer-aan-nogate: false
[2023-07-26 02:26:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:26:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:26:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:26:10] [config] transformer-depth-scaling: false
[2023-07-26 02:26:10] [config] transformer-dim-aan: 2048
[2023-07-26 02:26:10] [config] transformer-dim-ffn: 2048
[2023-07-26 02:26:10] [config] transformer-dropout: 0
[2023-07-26 02:26:10] [config] transformer-dropout-attention: 0
[2023-07-26 02:26:10] [config] transformer-dropout-ffn: 0
[2023-07-26 02:26:10] [config] transformer-ffn-activation: swish
[2023-07-26 02:26:10] [config] transformer-ffn-depth: 2
[2023-07-26 02:26:10] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:26:10] [config] transformer-heads: 8
[2023-07-26 02:26:10] [config] transformer-no-projection: false
[2023-07-26 02:26:10] [config] transformer-pool: false
[2023-07-26 02:26:10] [config] transformer-postprocess: dan
[2023-07-26 02:26:10] [config] transformer-postprocess-emb: d
[2023-07-26 02:26:10] [config] transformer-postprocess-top: ""
[2023-07-26 02:26:10] [config] transformer-preprocess: ""
[2023-07-26 02:26:10] [config] transformer-tied-layers:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] transformer-train-position-embeddings: false
[2023-07-26 02:26:10] [config] tsv: false
[2023-07-26 02:26:10] [config] tsv-fields: 0
[2023-07-26 02:26:10] [config] type: s2s
[2023-07-26 02:26:10] [config] ulr: false
[2023-07-26 02:26:10] [config] ulr-dim-emb: 0
[2023-07-26 02:26:10] [config] ulr-dropout: 0
[2023-07-26 02:26:10] [config] ulr-keys-vectors: ""
[2023-07-26 02:26:10] [config] ulr-query-vectors: ""
[2023-07-26 02:26:10] [config] ulr-softmax-temperature: 1
[2023-07-26 02:26:10] [config] ulr-trainable-transformation: false
[2023-07-26 02:26:10] [config] unlikelihood-loss: false
[2023-07-26 02:26:10] [config] valid-freq: 50000000
[2023-07-26 02:26:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:26:10] [config] valid-max-length: 1000
[2023-07-26 02:26:10] [config] valid-metrics:
[2023-07-26 02:26:10] [config]   - cross-entropy
[2023-07-26 02:26:10] [config]   - translation
[2023-07-26 02:26:10] [config] valid-mini-batch: 32
[2023-07-26 02:26:10] [config] valid-reset-stalled: false
[2023-07-26 02:26:10] [config] valid-script-args:
[2023-07-26 02:26:10] [config]   []
[2023-07-26 02:26:10] [config] valid-script-path: ""
[2023-07-26 02:26:10] [config] valid-sets:
[2023-07-26 02:26:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:26:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:26:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:26:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:26:10] [config] vocabs:
[2023-07-26 02:26:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:26:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:26:10] [config] word-penalty: 0
[2023-07-26 02:26:10] [config] word-scores: false
[2023-07-26 02:26:10] [config] workspace: 2048
[2023-07-26 02:26:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:26:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:26:10] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:26:10] Using asynchronous training
[2023-07-26 02:26:10] Synced seed 1234
[2023-07-26 02:26:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:26:10] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:26:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:26:10] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:26:10] [valid] No post-processing script given for validating translator
[2023-07-26 02:26:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:26:10] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:26:11] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:26:12] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:26:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:26:12] [comm] Using global sharding
[2023-07-26 02:26:12] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:26:12] [training] Using 2 GPUs
[2023-07-26 02:26:12] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:26:13] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:26:15] Loading Adam parameters
[2023-07-26 02:26:15] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:26:15] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:26:16] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:26:16] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:26:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:26:16] [data] Restoring the corpus state to epoch 131, batch 38510
[2023-07-26 02:26:16] [data] Shuffling data
[2023-07-26 02:26:16] [data] Done reading 20,192 sentences
[2023-07-26 02:26:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:26:16] Training started
[2023-07-26 02:26:16] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:26:16] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:26:16] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:26:16] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:26:17] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:26:17] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:26:17] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:26:17] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:26:17] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:26:44] Seen 18,551 samples
[2023-07-26 02:26:44] Starting data epoch 132 in logical epoch 132
[2023-07-26 02:26:44] [data] Shuffling data
[2023-07-26 02:26:44] [data] Done reading 20,192 sentences
[2023-07-26 02:26:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:27:04] Ep. 132 : Up. 39000 : Sen. 12,787 : Cost 0.00869516 * 1,336,489 @ 512 after 52,322,760 : Time 53.44s : 25008.46 words/s : gNorm 0.0000
[2023-07-26 02:27:13] Seen 18,843 samples
[2023-07-26 02:27:13] Starting data epoch 133 in logical epoch 133
[2023-07-26 02:27:13] [data] Shuffling data
[2023-07-26 02:27:13] [data] Done reading 20,192 sentences
[2023-07-26 02:27:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:27:43] Seen 18,843 samples
[2023-07-26 02:27:43] Starting data epoch 134 in logical epoch 134
[2023-07-26 02:27:43] [data] Shuffling data
[2023-07-26 02:27:43] [data] Done reading 20,192 sentences
[2023-07-26 02:27:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:28:12] Seen 18,843 samples
[2023-07-26 02:28:12] Starting data epoch 135 in logical epoch 135
[2023-07-26 02:28:12] [data] Shuffling data
[2023-07-26 02:28:12] [data] Done reading 20,192 sentences
[2023-07-26 02:28:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:28:42] Seen 18,843 samples
[2023-07-26 02:28:42] Starting data epoch 136 in logical epoch 136
[2023-07-26 02:28:42] [data] Shuffling data
[2023-07-26 02:28:42] [data] Done reading 20,192 sentences
[2023-07-26 02:28:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:28:44] Ep. 136 : Up. 40000 : Sen. 960 : Cost 0.00806153 * 1,343,899 @ 768 after 53,666,659 : Time 100.23s : 13407.96 words/s : gNorm 0.0000
[2023-07-26 02:28:44] TODO: implement exponential smoothing!
[2023-07-26 02:28:44] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:28:47] Saving Adam parameters
[2023-07-26 02:28:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:29:23] Seen 18,843 samples
[2023-07-26 02:29:23] Starting data epoch 137 in logical epoch 137
[2023-07-26 02:29:23] [data] Shuffling data
[2023-07-26 02:29:23] [data] Done reading 20,192 sentences
[2023-07-26 02:29:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:29:52] Seen 18,843 samples
[2023-07-26 02:29:52] Starting data epoch 138 in logical epoch 138
[2023-07-26 02:29:52] [data] Shuffling data
[2023-07-26 02:29:52] [data] Done reading 20,192 sentences
[2023-07-26 02:29:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:30:22] Seen 18,843 samples
[2023-07-26 02:30:22] Starting data epoch 139 in logical epoch 139
[2023-07-26 02:30:22] [data] Shuffling data
[2023-07-26 02:30:22] [data] Done reading 20,192 sentences
[2023-07-26 02:30:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:30:35] Ep. 139 : Up. 41000 : Sen. 7,935 : Cost 0.00756369 * 1,338,341 @ 1,792 after 55,005,000 : Time 110.67s : 12092.68 words/s : gNorm 0.0000
[2023-07-26 02:30:52] Seen 18,843 samples
[2023-07-26 02:30:52] Starting data epoch 140 in logical epoch 140
[2023-07-26 02:30:52] [data] Shuffling data
[2023-07-26 02:30:52] [data] Done reading 20,192 sentences
[2023-07-26 02:30:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:31:22] Seen 18,843 samples
[2023-07-26 02:31:22] Starting data epoch 141 in logical epoch 141
[2023-07-26 02:31:22] Training finished
[2023-07-26 02:31:26] [valid] Ep. 141 : Up. 41472 : cross-entropy : 202.255 : stalled 12 times (last best: 103.711)
[2023-07-26 02:32:24] [valid] Ep. 141 : Up. 41472 : translation : 0 : new best
[2023-07-26 02:32:24] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:32:27] Saving Adam parameters
[2023-07-26 02:32:28] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:32:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:32:42] [marian] Running on node19.datos.cluster.uy as process 8182 with command line:
[2023-07-26 02:32:42] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:32:42] [config] after: 0e
[2023-07-26 02:32:42] [config] after-batches: 0
[2023-07-26 02:32:42] [config] after-epochs: 150
[2023-07-26 02:32:42] [config] all-caps-every: 0
[2023-07-26 02:32:42] [config] allow-unk: false
[2023-07-26 02:32:42] [config] authors: false
[2023-07-26 02:32:42] [config] beam-size: 12
[2023-07-26 02:32:42] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:32:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:32:42] [config] bert-masking-fraction: 0.15
[2023-07-26 02:32:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:32:42] [config] bert-train-type-embeddings: true
[2023-07-26 02:32:42] [config] bert-type-vocab-size: 2
[2023-07-26 02:32:42] [config] build-info: ""
[2023-07-26 02:32:42] [config] check-gradient-nan: false
[2023-07-26 02:32:42] [config] check-nan: false
[2023-07-26 02:32:42] [config] cite: false
[2023-07-26 02:32:42] [config] clip-norm: 1
[2023-07-26 02:32:42] [config] cost-scaling:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] cost-type: ce-sum
[2023-07-26 02:32:42] [config] cpu-threads: 0
[2023-07-26 02:32:42] [config] data-threads: 8
[2023-07-26 02:32:42] [config] data-weighting: ""
[2023-07-26 02:32:42] [config] data-weighting-type: sentence
[2023-07-26 02:32:42] [config] dec-cell: gru
[2023-07-26 02:32:42] [config] dec-cell-base-depth: 2
[2023-07-26 02:32:42] [config] dec-cell-high-depth: 1
[2023-07-26 02:32:42] [config] dec-depth: 1
[2023-07-26 02:32:42] [config] devices:
[2023-07-26 02:32:42] [config]   - 0
[2023-07-26 02:32:42] [config]   - 1
[2023-07-26 02:32:42] [config] dim-emb: 512
[2023-07-26 02:32:42] [config] dim-rnn: 1024
[2023-07-26 02:32:42] [config] dim-vocabs:
[2023-07-26 02:32:42] [config]   - 54042
[2023-07-26 02:32:42] [config]   - 36507
[2023-07-26 02:32:42] [config] disp-first: 0
[2023-07-26 02:32:42] [config] disp-freq: 1000u
[2023-07-26 02:32:42] [config] disp-label-counts: true
[2023-07-26 02:32:42] [config] dropout-rnn: 0
[2023-07-26 02:32:42] [config] dropout-src: 0
[2023-07-26 02:32:42] [config] dropout-trg: 0
[2023-07-26 02:32:42] [config] dump-config: ""
[2023-07-26 02:32:42] [config] dynamic-gradient-scaling:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] early-stopping: 200
[2023-07-26 02:32:42] [config] early-stopping-on: first
[2023-07-26 02:32:42] [config] embedding-fix-src: false
[2023-07-26 02:32:42] [config] embedding-fix-trg: false
[2023-07-26 02:32:42] [config] embedding-normalization: false
[2023-07-26 02:32:42] [config] embedding-vectors:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] enc-cell: gru
[2023-07-26 02:32:42] [config] enc-cell-depth: 1
[2023-07-26 02:32:42] [config] enc-depth: 1
[2023-07-26 02:32:42] [config] enc-type: bidirectional
[2023-07-26 02:32:42] [config] english-title-case-every: 0
[2023-07-26 02:32:42] [config] exponential-smoothing: 0
[2023-07-26 02:32:42] [config] factor-weight: 1
[2023-07-26 02:32:42] [config] factors-combine: sum
[2023-07-26 02:32:42] [config] factors-dim-emb: 0
[2023-07-26 02:32:42] [config] gradient-checkpointing: false
[2023-07-26 02:32:42] [config] gradient-norm-average-window: 100
[2023-07-26 02:32:42] [config] guided-alignment: none
[2023-07-26 02:32:42] [config] guided-alignment-cost: mse
[2023-07-26 02:32:42] [config] guided-alignment-weight: 0.1
[2023-07-26 02:32:42] [config] ignore-model-config: false
[2023-07-26 02:32:42] [config] input-types:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] interpolate-env-vars: false
[2023-07-26 02:32:42] [config] keep-best: false
[2023-07-26 02:32:42] [config] label-smoothing: 0
[2023-07-26 02:32:42] [config] layer-normalization: false
[2023-07-26 02:32:42] [config] learn-rate: 0.0001
[2023-07-26 02:32:42] [config] lemma-dependency: ""
[2023-07-26 02:32:42] [config] lemma-dim-emb: 0
[2023-07-26 02:32:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:32:42] [config] log-level: info
[2023-07-26 02:32:42] [config] log-time-zone: ""
[2023-07-26 02:32:42] [config] logical-epoch:
[2023-07-26 02:32:42] [config]   - 1e
[2023-07-26 02:32:42] [config]   - 0
[2023-07-26 02:32:42] [config] lr-decay: 0
[2023-07-26 02:32:42] [config] lr-decay-freq: 50000
[2023-07-26 02:32:42] [config] lr-decay-inv-sqrt:
[2023-07-26 02:32:42] [config]   - 0
[2023-07-26 02:32:42] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:32:42] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:32:42] [config] lr-decay-start:
[2023-07-26 02:32:42] [config]   - 10
[2023-07-26 02:32:42] [config]   - 1
[2023-07-26 02:32:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:32:42] [config] lr-report: false
[2023-07-26 02:32:42] [config] lr-warmup: 0
[2023-07-26 02:32:42] [config] lr-warmup-at-reload: false
[2023-07-26 02:32:42] [config] lr-warmup-cycle: false
[2023-07-26 02:32:42] [config] lr-warmup-start-rate: 0
[2023-07-26 02:32:42] [config] max-length: 50
[2023-07-26 02:32:42] [config] max-length-crop: false
[2023-07-26 02:32:42] [config] max-length-factor: 3
[2023-07-26 02:32:42] [config] maxi-batch: 100
[2023-07-26 02:32:42] [config] maxi-batch-sort: trg
[2023-07-26 02:32:42] [config] mini-batch: 64
[2023-07-26 02:32:42] [config] mini-batch-fit: false
[2023-07-26 02:32:42] [config] mini-batch-fit-step: 10
[2023-07-26 02:32:42] [config] mini-batch-round-up: true
[2023-07-26 02:32:42] [config] mini-batch-track-lr: false
[2023-07-26 02:32:42] [config] mini-batch-warmup: 0
[2023-07-26 02:32:42] [config] mini-batch-words: 0
[2023-07-26 02:32:42] [config] mini-batch-words-ref: 0
[2023-07-26 02:32:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:32:42] [config] multi-loss-type: sum
[2023-07-26 02:32:42] [config] n-best: false
[2023-07-26 02:32:42] [config] no-nccl: false
[2023-07-26 02:32:42] [config] no-reload: false
[2023-07-26 02:32:42] [config] no-restore-corpus: false
[2023-07-26 02:32:42] [config] normalize: 0
[2023-07-26 02:32:42] [config] normalize-gradient: false
[2023-07-26 02:32:42] [config] num-devices: 0
[2023-07-26 02:32:42] [config] optimizer: adam
[2023-07-26 02:32:42] [config] optimizer-delay: 1
[2023-07-26 02:32:42] [config] optimizer-params:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] output-omit-bias: false
[2023-07-26 02:32:42] [config] overwrite: true
[2023-07-26 02:32:42] [config] precision:
[2023-07-26 02:32:42] [config]   - float32
[2023-07-26 02:32:42] [config]   - float32
[2023-07-26 02:32:42] [config] pretrained-model: ""
[2023-07-26 02:32:42] [config] quantize-biases: false
[2023-07-26 02:32:42] [config] quantize-bits: 0
[2023-07-26 02:32:42] [config] quantize-log-based: false
[2023-07-26 02:32:42] [config] quantize-optimization-steps: 0
[2023-07-26 02:32:42] [config] quiet: false
[2023-07-26 02:32:42] [config] quiet-translation: true
[2023-07-26 02:32:42] [config] relative-paths: false
[2023-07-26 02:32:42] [config] right-left: false
[2023-07-26 02:32:42] [config] save-freq: 10000u
[2023-07-26 02:32:42] [config] seed: 1234
[2023-07-26 02:32:42] [config] sentencepiece-alphas:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:32:42] [config] sentencepiece-options: ""
[2023-07-26 02:32:42] [config] sharding: global
[2023-07-26 02:32:42] [config] shuffle: data
[2023-07-26 02:32:42] [config] shuffle-in-ram: false
[2023-07-26 02:32:42] [config] sigterm: save-and-exit
[2023-07-26 02:32:42] [config] skip: false
[2023-07-26 02:32:42] [config] sqlite: ""
[2023-07-26 02:32:42] [config] sqlite-drop: false
[2023-07-26 02:32:42] [config] sync-freq: 200u
[2023-07-26 02:32:42] [config] sync-sgd: false
[2023-07-26 02:32:42] [config] tempdir: /tmp
[2023-07-26 02:32:42] [config] tied-embeddings: false
[2023-07-26 02:32:42] [config] tied-embeddings-all: false
[2023-07-26 02:32:42] [config] tied-embeddings-src: false
[2023-07-26 02:32:42] [config] train-embedder-rank:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] train-sets:
[2023-07-26 02:32:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:32:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:32:42] [config] transformer-aan-activation: swish
[2023-07-26 02:32:42] [config] transformer-aan-depth: 2
[2023-07-26 02:32:42] [config] transformer-aan-nogate: false
[2023-07-26 02:32:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:32:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:32:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:32:42] [config] transformer-depth-scaling: false
[2023-07-26 02:32:42] [config] transformer-dim-aan: 2048
[2023-07-26 02:32:42] [config] transformer-dim-ffn: 2048
[2023-07-26 02:32:42] [config] transformer-dropout: 0
[2023-07-26 02:32:42] [config] transformer-dropout-attention: 0
[2023-07-26 02:32:42] [config] transformer-dropout-ffn: 0
[2023-07-26 02:32:42] [config] transformer-ffn-activation: swish
[2023-07-26 02:32:42] [config] transformer-ffn-depth: 2
[2023-07-26 02:32:42] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:32:42] [config] transformer-heads: 8
[2023-07-26 02:32:42] [config] transformer-no-projection: false
[2023-07-26 02:32:42] [config] transformer-pool: false
[2023-07-26 02:32:42] [config] transformer-postprocess: dan
[2023-07-26 02:32:42] [config] transformer-postprocess-emb: d
[2023-07-26 02:32:42] [config] transformer-postprocess-top: ""
[2023-07-26 02:32:42] [config] transformer-preprocess: ""
[2023-07-26 02:32:42] [config] transformer-tied-layers:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] transformer-train-position-embeddings: false
[2023-07-26 02:32:42] [config] tsv: false
[2023-07-26 02:32:42] [config] tsv-fields: 0
[2023-07-26 02:32:42] [config] type: s2s
[2023-07-26 02:32:42] [config] ulr: false
[2023-07-26 02:32:42] [config] ulr-dim-emb: 0
[2023-07-26 02:32:42] [config] ulr-dropout: 0
[2023-07-26 02:32:42] [config] ulr-keys-vectors: ""
[2023-07-26 02:32:42] [config] ulr-query-vectors: ""
[2023-07-26 02:32:42] [config] ulr-softmax-temperature: 1
[2023-07-26 02:32:42] [config] ulr-trainable-transformation: false
[2023-07-26 02:32:42] [config] unlikelihood-loss: false
[2023-07-26 02:32:42] [config] valid-freq: 50000000
[2023-07-26 02:32:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:32:42] [config] valid-max-length: 1000
[2023-07-26 02:32:42] [config] valid-metrics:
[2023-07-26 02:32:42] [config]   - cross-entropy
[2023-07-26 02:32:42] [config]   - translation
[2023-07-26 02:32:42] [config] valid-mini-batch: 32
[2023-07-26 02:32:42] [config] valid-reset-stalled: false
[2023-07-26 02:32:42] [config] valid-script-args:
[2023-07-26 02:32:42] [config]   []
[2023-07-26 02:32:42] [config] valid-script-path: ""
[2023-07-26 02:32:42] [config] valid-sets:
[2023-07-26 02:32:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:32:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:32:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:32:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:32:42] [config] vocabs:
[2023-07-26 02:32:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:32:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:32:42] [config] word-penalty: 0
[2023-07-26 02:32:42] [config] word-scores: false
[2023-07-26 02:32:42] [config] workspace: 2048
[2023-07-26 02:32:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:32:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:32:42] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:32:42] Using asynchronous training
[2023-07-26 02:32:42] Synced seed 1234
[2023-07-26 02:32:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:32:42] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:32:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:32:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:32:42] [valid] No post-processing script given for validating translator
[2023-07-26 02:32:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:32:43] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:32:44] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:32:44] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:32:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:32:44] [comm] Using global sharding
[2023-07-26 02:32:44] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:32:44] [training] Using 2 GPUs
[2023-07-26 02:32:44] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:32:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:32:47] Loading Adam parameters
[2023-07-26 02:32:48] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:32:48] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:32:48] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:32:48] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:32:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:32:49] [data] Restoring the corpus state to epoch 141, batch 41472
[2023-07-26 02:32:49] [data] Shuffling data
[2023-07-26 02:32:49] [data] Done reading 20,192 sentences
[2023-07-26 02:32:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:32:49] Training started
[2023-07-26 02:32:49] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:32:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:32:49] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:32:49] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:32:49] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:32:49] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:32:49] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:32:49] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:32:49] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:33:17] Seen 18,587 samples
[2023-07-26 02:33:17] Starting data epoch 142 in logical epoch 142
[2023-07-26 02:33:17] [data] Shuffling data
[2023-07-26 02:33:17] [data] Done reading 20,192 sentences
[2023-07-26 02:33:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:33:40] Ep. 142 : Up. 42000 : Sen. 15,253 : Cost 0.00700756 * 1,353,653 @ 197 after 56,358,653 : Time 58.04s : 23322.77 words/s : gNorm 0.0000
[2023-07-26 02:33:46] Seen 18,843 samples
[2023-07-26 02:33:46] Starting data epoch 143 in logical epoch 143
[2023-07-26 02:33:46] [data] Shuffling data
[2023-07-26 02:33:46] [data] Done reading 20,192 sentences
[2023-07-26 02:33:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:34:15] Seen 18,843 samples
[2023-07-26 02:34:15] Starting data epoch 144 in logical epoch 144
[2023-07-26 02:34:15] [data] Shuffling data
[2023-07-26 02:34:15] [data] Done reading 20,192 sentences
[2023-07-26 02:34:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:34:45] Seen 18,843 samples
[2023-07-26 02:34:45] Starting data epoch 145 in logical epoch 145
[2023-07-26 02:34:45] [data] Shuffling data
[2023-07-26 02:34:45] [data] Done reading 20,192 sentences
[2023-07-26 02:34:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:35:15] Seen 18,843 samples
[2023-07-26 02:35:15] Starting data epoch 146 in logical epoch 146
[2023-07-26 02:35:15] [data] Shuffling data
[2023-07-26 02:35:15] [data] Done reading 20,192 sentences
[2023-07-26 02:35:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:35:20] Ep. 146 : Up. 43000 : Sen. 3,328 : Cost 0.00699956 * 1,342,339 @ 543 after 57,700,992 : Time 99.95s : 13430.18 words/s : gNorm 0.0000
[2023-07-26 02:35:45] Seen 18,843 samples
[2023-07-26 02:35:45] Starting data epoch 147 in logical epoch 147
[2023-07-26 02:35:45] [data] Shuffling data
[2023-07-26 02:35:45] [data] Done reading 20,192 sentences
[2023-07-26 02:35:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:36:15] Seen 18,843 samples
[2023-07-26 02:36:15] Starting data epoch 148 in logical epoch 148
[2023-07-26 02:36:15] [data] Shuffling data
[2023-07-26 02:36:15] [data] Done reading 20,192 sentences
[2023-07-26 02:36:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:36:45] Seen 18,843 samples
[2023-07-26 02:36:45] Starting data epoch 149 in logical epoch 149
[2023-07-26 02:36:45] [data] Shuffling data
[2023-07-26 02:36:45] [data] Done reading 20,192 sentences
[2023-07-26 02:36:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:37:01] Ep. 149 : Up. 44000 : Sen. 10,217 : Cost 0.00648149 * 1,325,108 @ 2,304 after 59,026,100 : Time 100.21s : 13222.77 words/s : gNorm 0.0000
[2023-07-26 02:37:14] Seen 18,843 samples
[2023-07-26 02:37:14] Starting data epoch 150 in logical epoch 150
[2023-07-26 02:37:14] [data] Shuffling data
[2023-07-26 02:37:14] [data] Done reading 20,192 sentences
[2023-07-26 02:37:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:37:44] Seen 18,877 samples
[2023-07-26 02:37:44] Starting data epoch 151 in logical epoch 151
[2023-07-26 02:37:44] Training finished
[2023-07-26 02:37:48] [valid] Ep. 151 : Up. 44437 : cross-entropy : 204.311 : stalled 13 times (last best: 103.711)
[2023-07-26 02:38:45] [valid] Ep. 151 : Up. 44437 : translation : 0 : new best
[2023-07-26 02:38:45] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:38:48] Saving Adam parameters
[2023-07-26 02:38:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:39:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:39:01] [marian] Running on node19.datos.cluster.uy as process 32673 with command line:
[2023-07-26 02:39:01] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:39:01] [config] after: 0e
[2023-07-26 02:39:01] [config] after-batches: 0
[2023-07-26 02:39:01] [config] after-epochs: 160
[2023-07-26 02:39:01] [config] all-caps-every: 0
[2023-07-26 02:39:01] [config] allow-unk: false
[2023-07-26 02:39:01] [config] authors: false
[2023-07-26 02:39:01] [config] beam-size: 12
[2023-07-26 02:39:01] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:39:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:39:01] [config] bert-masking-fraction: 0.15
[2023-07-26 02:39:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:39:01] [config] bert-train-type-embeddings: true
[2023-07-26 02:39:01] [config] bert-type-vocab-size: 2
[2023-07-26 02:39:01] [config] build-info: ""
[2023-07-26 02:39:01] [config] check-gradient-nan: false
[2023-07-26 02:39:01] [config] check-nan: false
[2023-07-26 02:39:01] [config] cite: false
[2023-07-26 02:39:01] [config] clip-norm: 1
[2023-07-26 02:39:01] [config] cost-scaling:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] cost-type: ce-sum
[2023-07-26 02:39:01] [config] cpu-threads: 0
[2023-07-26 02:39:01] [config] data-threads: 8
[2023-07-26 02:39:01] [config] data-weighting: ""
[2023-07-26 02:39:01] [config] data-weighting-type: sentence
[2023-07-26 02:39:01] [config] dec-cell: gru
[2023-07-26 02:39:01] [config] dec-cell-base-depth: 2
[2023-07-26 02:39:01] [config] dec-cell-high-depth: 1
[2023-07-26 02:39:01] [config] dec-depth: 1
[2023-07-26 02:39:01] [config] devices:
[2023-07-26 02:39:01] [config]   - 0
[2023-07-26 02:39:01] [config]   - 1
[2023-07-26 02:39:01] [config] dim-emb: 512
[2023-07-26 02:39:01] [config] dim-rnn: 1024
[2023-07-26 02:39:01] [config] dim-vocabs:
[2023-07-26 02:39:01] [config]   - 54042
[2023-07-26 02:39:01] [config]   - 36507
[2023-07-26 02:39:01] [config] disp-first: 0
[2023-07-26 02:39:01] [config] disp-freq: 1000u
[2023-07-26 02:39:01] [config] disp-label-counts: true
[2023-07-26 02:39:01] [config] dropout-rnn: 0
[2023-07-26 02:39:01] [config] dropout-src: 0
[2023-07-26 02:39:01] [config] dropout-trg: 0
[2023-07-26 02:39:01] [config] dump-config: ""
[2023-07-26 02:39:01] [config] dynamic-gradient-scaling:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] early-stopping: 200
[2023-07-26 02:39:01] [config] early-stopping-on: first
[2023-07-26 02:39:01] [config] embedding-fix-src: false
[2023-07-26 02:39:01] [config] embedding-fix-trg: false
[2023-07-26 02:39:01] [config] embedding-normalization: false
[2023-07-26 02:39:01] [config] embedding-vectors:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] enc-cell: gru
[2023-07-26 02:39:01] [config] enc-cell-depth: 1
[2023-07-26 02:39:01] [config] enc-depth: 1
[2023-07-26 02:39:01] [config] enc-type: bidirectional
[2023-07-26 02:39:01] [config] english-title-case-every: 0
[2023-07-26 02:39:01] [config] exponential-smoothing: 0
[2023-07-26 02:39:01] [config] factor-weight: 1
[2023-07-26 02:39:01] [config] factors-combine: sum
[2023-07-26 02:39:01] [config] factors-dim-emb: 0
[2023-07-26 02:39:01] [config] gradient-checkpointing: false
[2023-07-26 02:39:01] [config] gradient-norm-average-window: 100
[2023-07-26 02:39:01] [config] guided-alignment: none
[2023-07-26 02:39:01] [config] guided-alignment-cost: mse
[2023-07-26 02:39:01] [config] guided-alignment-weight: 0.1
[2023-07-26 02:39:01] [config] ignore-model-config: false
[2023-07-26 02:39:01] [config] input-types:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] interpolate-env-vars: false
[2023-07-26 02:39:01] [config] keep-best: false
[2023-07-26 02:39:01] [config] label-smoothing: 0
[2023-07-26 02:39:01] [config] layer-normalization: false
[2023-07-26 02:39:01] [config] learn-rate: 0.0001
[2023-07-26 02:39:01] [config] lemma-dependency: ""
[2023-07-26 02:39:01] [config] lemma-dim-emb: 0
[2023-07-26 02:39:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:39:01] [config] log-level: info
[2023-07-26 02:39:01] [config] log-time-zone: ""
[2023-07-26 02:39:01] [config] logical-epoch:
[2023-07-26 02:39:01] [config]   - 1e
[2023-07-26 02:39:01] [config]   - 0
[2023-07-26 02:39:01] [config] lr-decay: 0
[2023-07-26 02:39:01] [config] lr-decay-freq: 50000
[2023-07-26 02:39:01] [config] lr-decay-inv-sqrt:
[2023-07-26 02:39:01] [config]   - 0
[2023-07-26 02:39:01] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:39:01] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:39:01] [config] lr-decay-start:
[2023-07-26 02:39:01] [config]   - 10
[2023-07-26 02:39:01] [config]   - 1
[2023-07-26 02:39:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:39:01] [config] lr-report: false
[2023-07-26 02:39:01] [config] lr-warmup: 0
[2023-07-26 02:39:01] [config] lr-warmup-at-reload: false
[2023-07-26 02:39:01] [config] lr-warmup-cycle: false
[2023-07-26 02:39:01] [config] lr-warmup-start-rate: 0
[2023-07-26 02:39:01] [config] max-length: 50
[2023-07-26 02:39:01] [config] max-length-crop: false
[2023-07-26 02:39:01] [config] max-length-factor: 3
[2023-07-26 02:39:01] [config] maxi-batch: 100
[2023-07-26 02:39:01] [config] maxi-batch-sort: trg
[2023-07-26 02:39:01] [config] mini-batch: 64
[2023-07-26 02:39:01] [config] mini-batch-fit: false
[2023-07-26 02:39:01] [config] mini-batch-fit-step: 10
[2023-07-26 02:39:01] [config] mini-batch-round-up: true
[2023-07-26 02:39:01] [config] mini-batch-track-lr: false
[2023-07-26 02:39:01] [config] mini-batch-warmup: 0
[2023-07-26 02:39:01] [config] mini-batch-words: 0
[2023-07-26 02:39:01] [config] mini-batch-words-ref: 0
[2023-07-26 02:39:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:39:01] [config] multi-loss-type: sum
[2023-07-26 02:39:01] [config] n-best: false
[2023-07-26 02:39:01] [config] no-nccl: false
[2023-07-26 02:39:01] [config] no-reload: false
[2023-07-26 02:39:01] [config] no-restore-corpus: false
[2023-07-26 02:39:01] [config] normalize: 0
[2023-07-26 02:39:01] [config] normalize-gradient: false
[2023-07-26 02:39:01] [config] num-devices: 0
[2023-07-26 02:39:01] [config] optimizer: adam
[2023-07-26 02:39:01] [config] optimizer-delay: 1
[2023-07-26 02:39:01] [config] optimizer-params:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] output-omit-bias: false
[2023-07-26 02:39:01] [config] overwrite: true
[2023-07-26 02:39:01] [config] precision:
[2023-07-26 02:39:01] [config]   - float32
[2023-07-26 02:39:01] [config]   - float32
[2023-07-26 02:39:01] [config] pretrained-model: ""
[2023-07-26 02:39:01] [config] quantize-biases: false
[2023-07-26 02:39:01] [config] quantize-bits: 0
[2023-07-26 02:39:01] [config] quantize-log-based: false
[2023-07-26 02:39:01] [config] quantize-optimization-steps: 0
[2023-07-26 02:39:01] [config] quiet: false
[2023-07-26 02:39:01] [config] quiet-translation: true
[2023-07-26 02:39:01] [config] relative-paths: false
[2023-07-26 02:39:01] [config] right-left: false
[2023-07-26 02:39:01] [config] save-freq: 10000u
[2023-07-26 02:39:01] [config] seed: 1234
[2023-07-26 02:39:01] [config] sentencepiece-alphas:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:39:01] [config] sentencepiece-options: ""
[2023-07-26 02:39:01] [config] sharding: global
[2023-07-26 02:39:01] [config] shuffle: data
[2023-07-26 02:39:01] [config] shuffle-in-ram: false
[2023-07-26 02:39:01] [config] sigterm: save-and-exit
[2023-07-26 02:39:01] [config] skip: false
[2023-07-26 02:39:01] [config] sqlite: ""
[2023-07-26 02:39:01] [config] sqlite-drop: false
[2023-07-26 02:39:01] [config] sync-freq: 200u
[2023-07-26 02:39:01] [config] sync-sgd: false
[2023-07-26 02:39:01] [config] tempdir: /tmp
[2023-07-26 02:39:01] [config] tied-embeddings: false
[2023-07-26 02:39:01] [config] tied-embeddings-all: false
[2023-07-26 02:39:01] [config] tied-embeddings-src: false
[2023-07-26 02:39:01] [config] train-embedder-rank:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] train-sets:
[2023-07-26 02:39:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:39:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:39:01] [config] transformer-aan-activation: swish
[2023-07-26 02:39:01] [config] transformer-aan-depth: 2
[2023-07-26 02:39:01] [config] transformer-aan-nogate: false
[2023-07-26 02:39:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:39:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:39:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:39:01] [config] transformer-depth-scaling: false
[2023-07-26 02:39:01] [config] transformer-dim-aan: 2048
[2023-07-26 02:39:01] [config] transformer-dim-ffn: 2048
[2023-07-26 02:39:01] [config] transformer-dropout: 0
[2023-07-26 02:39:01] [config] transformer-dropout-attention: 0
[2023-07-26 02:39:01] [config] transformer-dropout-ffn: 0
[2023-07-26 02:39:01] [config] transformer-ffn-activation: swish
[2023-07-26 02:39:01] [config] transformer-ffn-depth: 2
[2023-07-26 02:39:01] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:39:01] [config] transformer-heads: 8
[2023-07-26 02:39:01] [config] transformer-no-projection: false
[2023-07-26 02:39:01] [config] transformer-pool: false
[2023-07-26 02:39:01] [config] transformer-postprocess: dan
[2023-07-26 02:39:01] [config] transformer-postprocess-emb: d
[2023-07-26 02:39:01] [config] transformer-postprocess-top: ""
[2023-07-26 02:39:01] [config] transformer-preprocess: ""
[2023-07-26 02:39:01] [config] transformer-tied-layers:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] transformer-train-position-embeddings: false
[2023-07-26 02:39:01] [config] tsv: false
[2023-07-26 02:39:01] [config] tsv-fields: 0
[2023-07-26 02:39:01] [config] type: s2s
[2023-07-26 02:39:01] [config] ulr: false
[2023-07-26 02:39:01] [config] ulr-dim-emb: 0
[2023-07-26 02:39:01] [config] ulr-dropout: 0
[2023-07-26 02:39:01] [config] ulr-keys-vectors: ""
[2023-07-26 02:39:01] [config] ulr-query-vectors: ""
[2023-07-26 02:39:01] [config] ulr-softmax-temperature: 1
[2023-07-26 02:39:01] [config] ulr-trainable-transformation: false
[2023-07-26 02:39:01] [config] unlikelihood-loss: false
[2023-07-26 02:39:01] [config] valid-freq: 50000000
[2023-07-26 02:39:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:39:01] [config] valid-max-length: 1000
[2023-07-26 02:39:01] [config] valid-metrics:
[2023-07-26 02:39:01] [config]   - cross-entropy
[2023-07-26 02:39:01] [config]   - translation
[2023-07-26 02:39:01] [config] valid-mini-batch: 32
[2023-07-26 02:39:01] [config] valid-reset-stalled: false
[2023-07-26 02:39:01] [config] valid-script-args:
[2023-07-26 02:39:01] [config]   []
[2023-07-26 02:39:01] [config] valid-script-path: ""
[2023-07-26 02:39:01] [config] valid-sets:
[2023-07-26 02:39:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:39:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:39:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:39:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:39:01] [config] vocabs:
[2023-07-26 02:39:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:39:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:39:01] [config] word-penalty: 0
[2023-07-26 02:39:01] [config] word-scores: false
[2023-07-26 02:39:01] [config] workspace: 2048
[2023-07-26 02:39:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:39:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:39:01] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:39:01] Using asynchronous training
[2023-07-26 02:39:01] Synced seed 1234
[2023-07-26 02:39:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:39:01] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:39:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:39:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:39:02] [valid] No post-processing script given for validating translator
[2023-07-26 02:39:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:39:02] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:39:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:39:03] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:39:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:39:03] [comm] Using global sharding
[2023-07-26 02:39:03] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:39:03] [training] Using 2 GPUs
[2023-07-26 02:39:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:39:04] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:39:06] Loading Adam parameters
[2023-07-26 02:39:06] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:39:07] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:39:07] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:39:07] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:39:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:39:07] [data] Restoring the corpus state to epoch 151, batch 44437
[2023-07-26 02:39:07] [data] Shuffling data
[2023-07-26 02:39:07] [data] Done reading 20,192 sentences
[2023-07-26 02:39:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:39:07] Training started
[2023-07-26 02:39:07] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:39:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:39:08] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:39:08] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:39:08] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:39:08] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:39:08] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:39:08] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:39:08] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:39:35] Seen 18,553 samples
[2023-07-26 02:39:35] Starting data epoch 152 in logical epoch 152
[2023-07-26 02:39:35] [data] Shuffling data
[2023-07-26 02:39:35] [data] Done reading 20,192 sentences
[2023-07-26 02:39:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:40:02] Ep. 152 : Up. 45000 : Sen. 17,406 : Cost 0.00676170 * 1,337,654 @ 240 after 60,363,754 : Time 60.39s : 22149.49 words/s : gNorm 0.0000
[2023-07-26 02:40:04] Seen 18,843 samples
[2023-07-26 02:40:04] Starting data epoch 153 in logical epoch 153
[2023-07-26 02:40:04] [data] Shuffling data
[2023-07-26 02:40:04] [data] Done reading 20,192 sentences
[2023-07-26 02:40:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:40:34] Seen 18,889 samples
[2023-07-26 02:40:34] Starting data epoch 154 in logical epoch 154
[2023-07-26 02:40:34] [data] Shuffling data
[2023-07-26 02:40:34] [data] Done reading 20,192 sentences
[2023-07-26 02:40:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:41:04] Seen 18,797 samples
[2023-07-26 02:41:04] Starting data epoch 155 in logical epoch 155
[2023-07-26 02:41:04] [data] Shuffling data
[2023-07-26 02:41:04] [data] Done reading 20,192 sentences
[2023-07-26 02:41:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:41:33] Seen 18,843 samples
[2023-07-26 02:41:33] Starting data epoch 156 in logical epoch 156
[2023-07-26 02:41:33] [data] Shuffling data
[2023-07-26 02:41:33] [data] Done reading 20,192 sentences
[2023-07-26 02:41:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:41:42] Ep. 156 : Up. 46000 : Sen. 5,539 : Cost 0.00591651 * 1,344,865 @ 1,856 after 61,708,619 : Time 100.34s : 13402.70 words/s : gNorm 0.0000
[2023-07-26 02:42:04] Seen 18,873 samples
[2023-07-26 02:42:04] Starting data epoch 157 in logical epoch 157
[2023-07-26 02:42:04] [data] Shuffling data
[2023-07-26 02:42:04] [data] Done reading 20,192 sentences
[2023-07-26 02:42:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:42:33] Seen 18,845 samples
[2023-07-26 02:42:33] Starting data epoch 158 in logical epoch 158
[2023-07-26 02:42:33] [data] Shuffling data
[2023-07-26 02:42:33] [data] Done reading 20,192 sentences
[2023-07-26 02:42:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:43:03] Seen 18,811 samples
[2023-07-26 02:43:03] Starting data epoch 159 in logical epoch 159
[2023-07-26 02:43:03] [data] Shuffling data
[2023-07-26 02:43:03] [data] Done reading 20,192 sentences
[2023-07-26 02:43:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:43:23] Ep. 159 : Up. 47000 : Sen. 12,630 : Cost 0.00539773 * 1,341,866 @ 1,024 after 63,050,485 : Time 100.94s : 13293.54 words/s : gNorm 0.0000
[2023-07-26 02:43:33] Seen 18,843 samples
[2023-07-26 02:43:33] Starting data epoch 160 in logical epoch 160
[2023-07-26 02:43:33] [data] Shuffling data
[2023-07-26 02:43:33] [data] Done reading 20,192 sentences
[2023-07-26 02:43:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:44:03] Seen 18,843 samples
[2023-07-26 02:44:03] Starting data epoch 161 in logical epoch 161
[2023-07-26 02:44:03] Training finished
[2023-07-26 02:44:07] [valid] Ep. 161 : Up. 47399 : cross-entropy : 207.243 : stalled 14 times (last best: 103.711)
[2023-07-26 02:45:05] [valid] Ep. 161 : Up. 47399 : translation : 0 : new best
[2023-07-26 02:45:05] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:45:09] Saving Adam parameters
[2023-07-26 02:45:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:45:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:45:22] [marian] Running on node19.datos.cluster.uy as process 17496 with command line:
[2023-07-26 02:45:22] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:45:22] [config] after: 0e
[2023-07-26 02:45:22] [config] after-batches: 0
[2023-07-26 02:45:22] [config] after-epochs: 170
[2023-07-26 02:45:22] [config] all-caps-every: 0
[2023-07-26 02:45:22] [config] allow-unk: false
[2023-07-26 02:45:22] [config] authors: false
[2023-07-26 02:45:22] [config] beam-size: 12
[2023-07-26 02:45:22] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:45:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:45:22] [config] bert-masking-fraction: 0.15
[2023-07-26 02:45:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:45:22] [config] bert-train-type-embeddings: true
[2023-07-26 02:45:22] [config] bert-type-vocab-size: 2
[2023-07-26 02:45:22] [config] build-info: ""
[2023-07-26 02:45:22] [config] check-gradient-nan: false
[2023-07-26 02:45:22] [config] check-nan: false
[2023-07-26 02:45:22] [config] cite: false
[2023-07-26 02:45:22] [config] clip-norm: 1
[2023-07-26 02:45:22] [config] cost-scaling:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] cost-type: ce-sum
[2023-07-26 02:45:22] [config] cpu-threads: 0
[2023-07-26 02:45:22] [config] data-threads: 8
[2023-07-26 02:45:22] [config] data-weighting: ""
[2023-07-26 02:45:22] [config] data-weighting-type: sentence
[2023-07-26 02:45:22] [config] dec-cell: gru
[2023-07-26 02:45:22] [config] dec-cell-base-depth: 2
[2023-07-26 02:45:22] [config] dec-cell-high-depth: 1
[2023-07-26 02:45:22] [config] dec-depth: 1
[2023-07-26 02:45:22] [config] devices:
[2023-07-26 02:45:22] [config]   - 0
[2023-07-26 02:45:22] [config]   - 1
[2023-07-26 02:45:22] [config] dim-emb: 512
[2023-07-26 02:45:22] [config] dim-rnn: 1024
[2023-07-26 02:45:22] [config] dim-vocabs:
[2023-07-26 02:45:22] [config]   - 54042
[2023-07-26 02:45:22] [config]   - 36507
[2023-07-26 02:45:22] [config] disp-first: 0
[2023-07-26 02:45:22] [config] disp-freq: 1000u
[2023-07-26 02:45:22] [config] disp-label-counts: true
[2023-07-26 02:45:22] [config] dropout-rnn: 0
[2023-07-26 02:45:22] [config] dropout-src: 0
[2023-07-26 02:45:22] [config] dropout-trg: 0
[2023-07-26 02:45:22] [config] dump-config: ""
[2023-07-26 02:45:22] [config] dynamic-gradient-scaling:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] early-stopping: 200
[2023-07-26 02:45:22] [config] early-stopping-on: first
[2023-07-26 02:45:22] [config] embedding-fix-src: false
[2023-07-26 02:45:22] [config] embedding-fix-trg: false
[2023-07-26 02:45:22] [config] embedding-normalization: false
[2023-07-26 02:45:22] [config] embedding-vectors:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] enc-cell: gru
[2023-07-26 02:45:22] [config] enc-cell-depth: 1
[2023-07-26 02:45:22] [config] enc-depth: 1
[2023-07-26 02:45:22] [config] enc-type: bidirectional
[2023-07-26 02:45:22] [config] english-title-case-every: 0
[2023-07-26 02:45:22] [config] exponential-smoothing: 0
[2023-07-26 02:45:22] [config] factor-weight: 1
[2023-07-26 02:45:22] [config] factors-combine: sum
[2023-07-26 02:45:22] [config] factors-dim-emb: 0
[2023-07-26 02:45:22] [config] gradient-checkpointing: false
[2023-07-26 02:45:22] [config] gradient-norm-average-window: 100
[2023-07-26 02:45:22] [config] guided-alignment: none
[2023-07-26 02:45:22] [config] guided-alignment-cost: mse
[2023-07-26 02:45:22] [config] guided-alignment-weight: 0.1
[2023-07-26 02:45:22] [config] ignore-model-config: false
[2023-07-26 02:45:22] [config] input-types:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] interpolate-env-vars: false
[2023-07-26 02:45:22] [config] keep-best: false
[2023-07-26 02:45:22] [config] label-smoothing: 0
[2023-07-26 02:45:22] [config] layer-normalization: false
[2023-07-26 02:45:22] [config] learn-rate: 0.0001
[2023-07-26 02:45:22] [config] lemma-dependency: ""
[2023-07-26 02:45:22] [config] lemma-dim-emb: 0
[2023-07-26 02:45:22] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:45:22] [config] log-level: info
[2023-07-26 02:45:22] [config] log-time-zone: ""
[2023-07-26 02:45:22] [config] logical-epoch:
[2023-07-26 02:45:22] [config]   - 1e
[2023-07-26 02:45:22] [config]   - 0
[2023-07-26 02:45:22] [config] lr-decay: 0
[2023-07-26 02:45:22] [config] lr-decay-freq: 50000
[2023-07-26 02:45:22] [config] lr-decay-inv-sqrt:
[2023-07-26 02:45:22] [config]   - 0
[2023-07-26 02:45:22] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:45:22] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:45:22] [config] lr-decay-start:
[2023-07-26 02:45:22] [config]   - 10
[2023-07-26 02:45:22] [config]   - 1
[2023-07-26 02:45:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:45:22] [config] lr-report: false
[2023-07-26 02:45:22] [config] lr-warmup: 0
[2023-07-26 02:45:22] [config] lr-warmup-at-reload: false
[2023-07-26 02:45:22] [config] lr-warmup-cycle: false
[2023-07-26 02:45:22] [config] lr-warmup-start-rate: 0
[2023-07-26 02:45:22] [config] max-length: 50
[2023-07-26 02:45:22] [config] max-length-crop: false
[2023-07-26 02:45:22] [config] max-length-factor: 3
[2023-07-26 02:45:22] [config] maxi-batch: 100
[2023-07-26 02:45:22] [config] maxi-batch-sort: trg
[2023-07-26 02:45:22] [config] mini-batch: 64
[2023-07-26 02:45:22] [config] mini-batch-fit: false
[2023-07-26 02:45:22] [config] mini-batch-fit-step: 10
[2023-07-26 02:45:22] [config] mini-batch-round-up: true
[2023-07-26 02:45:22] [config] mini-batch-track-lr: false
[2023-07-26 02:45:22] [config] mini-batch-warmup: 0
[2023-07-26 02:45:22] [config] mini-batch-words: 0
[2023-07-26 02:45:22] [config] mini-batch-words-ref: 0
[2023-07-26 02:45:22] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:45:22] [config] multi-loss-type: sum
[2023-07-26 02:45:22] [config] n-best: false
[2023-07-26 02:45:22] [config] no-nccl: false
[2023-07-26 02:45:22] [config] no-reload: false
[2023-07-26 02:45:22] [config] no-restore-corpus: false
[2023-07-26 02:45:22] [config] normalize: 0
[2023-07-26 02:45:22] [config] normalize-gradient: false
[2023-07-26 02:45:22] [config] num-devices: 0
[2023-07-26 02:45:22] [config] optimizer: adam
[2023-07-26 02:45:22] [config] optimizer-delay: 1
[2023-07-26 02:45:22] [config] optimizer-params:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] output-omit-bias: false
[2023-07-26 02:45:22] [config] overwrite: true
[2023-07-26 02:45:22] [config] precision:
[2023-07-26 02:45:22] [config]   - float32
[2023-07-26 02:45:22] [config]   - float32
[2023-07-26 02:45:22] [config] pretrained-model: ""
[2023-07-26 02:45:22] [config] quantize-biases: false
[2023-07-26 02:45:22] [config] quantize-bits: 0
[2023-07-26 02:45:22] [config] quantize-log-based: false
[2023-07-26 02:45:22] [config] quantize-optimization-steps: 0
[2023-07-26 02:45:22] [config] quiet: false
[2023-07-26 02:45:22] [config] quiet-translation: true
[2023-07-26 02:45:22] [config] relative-paths: false
[2023-07-26 02:45:22] [config] right-left: false
[2023-07-26 02:45:22] [config] save-freq: 10000u
[2023-07-26 02:45:22] [config] seed: 1234
[2023-07-26 02:45:22] [config] sentencepiece-alphas:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:45:22] [config] sentencepiece-options: ""
[2023-07-26 02:45:22] [config] sharding: global
[2023-07-26 02:45:22] [config] shuffle: data
[2023-07-26 02:45:22] [config] shuffle-in-ram: false
[2023-07-26 02:45:22] [config] sigterm: save-and-exit
[2023-07-26 02:45:22] [config] skip: false
[2023-07-26 02:45:22] [config] sqlite: ""
[2023-07-26 02:45:22] [config] sqlite-drop: false
[2023-07-26 02:45:22] [config] sync-freq: 200u
[2023-07-26 02:45:22] [config] sync-sgd: false
[2023-07-26 02:45:22] [config] tempdir: /tmp
[2023-07-26 02:45:22] [config] tied-embeddings: false
[2023-07-26 02:45:22] [config] tied-embeddings-all: false
[2023-07-26 02:45:22] [config] tied-embeddings-src: false
[2023-07-26 02:45:22] [config] train-embedder-rank:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] train-sets:
[2023-07-26 02:45:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:45:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:45:22] [config] transformer-aan-activation: swish
[2023-07-26 02:45:22] [config] transformer-aan-depth: 2
[2023-07-26 02:45:22] [config] transformer-aan-nogate: false
[2023-07-26 02:45:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:45:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:45:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:45:22] [config] transformer-depth-scaling: false
[2023-07-26 02:45:22] [config] transformer-dim-aan: 2048
[2023-07-26 02:45:22] [config] transformer-dim-ffn: 2048
[2023-07-26 02:45:22] [config] transformer-dropout: 0
[2023-07-26 02:45:22] [config] transformer-dropout-attention: 0
[2023-07-26 02:45:22] [config] transformer-dropout-ffn: 0
[2023-07-26 02:45:22] [config] transformer-ffn-activation: swish
[2023-07-26 02:45:22] [config] transformer-ffn-depth: 2
[2023-07-26 02:45:22] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:45:22] [config] transformer-heads: 8
[2023-07-26 02:45:22] [config] transformer-no-projection: false
[2023-07-26 02:45:22] [config] transformer-pool: false
[2023-07-26 02:45:22] [config] transformer-postprocess: dan
[2023-07-26 02:45:22] [config] transformer-postprocess-emb: d
[2023-07-26 02:45:22] [config] transformer-postprocess-top: ""
[2023-07-26 02:45:22] [config] transformer-preprocess: ""
[2023-07-26 02:45:22] [config] transformer-tied-layers:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] transformer-train-position-embeddings: false
[2023-07-26 02:45:22] [config] tsv: false
[2023-07-26 02:45:22] [config] tsv-fields: 0
[2023-07-26 02:45:22] [config] type: s2s
[2023-07-26 02:45:22] [config] ulr: false
[2023-07-26 02:45:22] [config] ulr-dim-emb: 0
[2023-07-26 02:45:22] [config] ulr-dropout: 0
[2023-07-26 02:45:22] [config] ulr-keys-vectors: ""
[2023-07-26 02:45:22] [config] ulr-query-vectors: ""
[2023-07-26 02:45:22] [config] ulr-softmax-temperature: 1
[2023-07-26 02:45:22] [config] ulr-trainable-transformation: false
[2023-07-26 02:45:22] [config] unlikelihood-loss: false
[2023-07-26 02:45:22] [config] valid-freq: 50000000
[2023-07-26 02:45:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:45:22] [config] valid-max-length: 1000
[2023-07-26 02:45:22] [config] valid-metrics:
[2023-07-26 02:45:22] [config]   - cross-entropy
[2023-07-26 02:45:22] [config]   - translation
[2023-07-26 02:45:22] [config] valid-mini-batch: 32
[2023-07-26 02:45:22] [config] valid-reset-stalled: false
[2023-07-26 02:45:22] [config] valid-script-args:
[2023-07-26 02:45:22] [config]   []
[2023-07-26 02:45:22] [config] valid-script-path: ""
[2023-07-26 02:45:22] [config] valid-sets:
[2023-07-26 02:45:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:45:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:45:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:45:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:45:22] [config] vocabs:
[2023-07-26 02:45:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:45:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:45:22] [config] word-penalty: 0
[2023-07-26 02:45:22] [config] word-scores: false
[2023-07-26 02:45:22] [config] workspace: 2048
[2023-07-26 02:45:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:45:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:45:22] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:45:22] Using asynchronous training
[2023-07-26 02:45:23] Synced seed 1234
[2023-07-26 02:45:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:45:23] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:45:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:45:23] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:45:23] [valid] No post-processing script given for validating translator
[2023-07-26 02:45:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:45:23] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:45:24] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:45:24] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:45:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:45:24] [comm] Using global sharding
[2023-07-26 02:45:24] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:45:24] [training] Using 2 GPUs
[2023-07-26 02:45:24] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:45:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:45:27] Loading Adam parameters
[2023-07-26 02:45:28] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:45:28] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:45:28] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:45:28] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:45:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:45:29] [data] Restoring the corpus state to epoch 161, batch 47399
[2023-07-26 02:45:29] [data] Shuffling data
[2023-07-26 02:45:29] [data] Done reading 20,192 sentences
[2023-07-26 02:45:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:45:29] Training started
[2023-07-26 02:45:29] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:45:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:45:29] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:45:29] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:45:29] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:45:29] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:45:29] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:45:29] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:45:29] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:45:57] Seen 18,587 samples
[2023-07-26 02:45:57] Starting data epoch 162 in logical epoch 162
[2023-07-26 02:45:57] [data] Shuffling data
[2023-07-26 02:45:57] [data] Done reading 20,192 sentences
[2023-07-26 02:45:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:46:26] Seen 18,843 samples
[2023-07-26 02:46:26] Starting data epoch 163 in logical epoch 163
[2023-07-26 02:46:26] [data] Shuffling data
[2023-07-26 02:46:26] [data] Done reading 20,192 sentences
[2023-07-26 02:46:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:46:28] Ep. 163 : Up. 48000 : Sen. 1,024 : Cost 0.00538496 * 1,340,166 @ 1,517 after 64,390,651 : Time 64.81s : 20678.68 words/s : gNorm 0.0000
[2023-07-26 02:46:56] Seen 18,843 samples
[2023-07-26 02:46:56] Starting data epoch 164 in logical epoch 164
[2023-07-26 02:46:56] [data] Shuffling data
[2023-07-26 02:46:56] [data] Done reading 20,192 sentences
[2023-07-26 02:46:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:47:25] Seen 18,843 samples
[2023-07-26 02:47:25] Starting data epoch 165 in logical epoch 165
[2023-07-26 02:47:25] [data] Shuffling data
[2023-07-26 02:47:25] [data] Done reading 20,192 sentences
[2023-07-26 02:47:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:47:55] Seen 18,865 samples
[2023-07-26 02:47:55] Starting data epoch 166 in logical epoch 166
[2023-07-26 02:47:55] [data] Shuffling data
[2023-07-26 02:47:55] [data] Done reading 20,192 sentences
[2023-07-26 02:47:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:48:08] Ep. 166 : Up. 49000 : Sen. 7,962 : Cost 0.00536009 * 1,342,652 @ 1,472 after 65,733,303 : Time 100.46s : 13364.45 words/s : gNorm 0.0000
[2023-07-26 02:48:25] Seen 18,821 samples
[2023-07-26 02:48:25] Starting data epoch 167 in logical epoch 167
[2023-07-26 02:48:25] [data] Shuffling data
[2023-07-26 02:48:25] [data] Done reading 20,192 sentences
[2023-07-26 02:48:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:48:55] Seen 18,843 samples
[2023-07-26 02:48:55] Starting data epoch 168 in logical epoch 168
[2023-07-26 02:48:55] [data] Shuffling data
[2023-07-26 02:48:55] [data] Done reading 20,192 sentences
[2023-07-26 02:48:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:49:24] Seen 18,843 samples
[2023-07-26 02:49:24] Starting data epoch 169 in logical epoch 169
[2023-07-26 02:49:24] [data] Shuffling data
[2023-07-26 02:49:24] [data] Done reading 20,192 sentences
[2023-07-26 02:49:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:49:48] Ep. 169 : Up. 50000 : Sen. 14,907 : Cost 0.00525539 * 1,340,636 @ 2,452 after 67,073,939 : Time 100.01s : 13404.69 words/s : gNorm 0.0000
[2023-07-26 02:49:48] TODO: implement exponential smoothing!
[2023-07-26 02:49:48] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:49:51] Saving Adam parameters
[2023-07-26 02:49:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:50:07] Seen 18,843 samples
[2023-07-26 02:50:07] Starting data epoch 170 in logical epoch 170
[2023-07-26 02:50:07] [data] Shuffling data
[2023-07-26 02:50:07] [data] Done reading 20,192 sentences
[2023-07-26 02:50:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:50:36] Seen 18,875 samples
[2023-07-26 02:50:36] Starting data epoch 171 in logical epoch 171
[2023-07-26 02:50:36] Training finished
[2023-07-26 02:50:40] [valid] Ep. 171 : Up. 50363 : cross-entropy : 210.208 : stalled 15 times (last best: 103.711)
[2023-07-26 02:51:36] [valid] Ep. 171 : Up. 50363 : translation : 0 : new best
[2023-07-26 02:51:36] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:51:40] Saving Adam parameters
[2023-07-26 02:51:41] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:51:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:51:54] [marian] Running on node19.datos.cluster.uy as process 1947 with command line:
[2023-07-26 02:51:54] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:51:54] [config] after: 0e
[2023-07-26 02:51:54] [config] after-batches: 0
[2023-07-26 02:51:54] [config] after-epochs: 180
[2023-07-26 02:51:54] [config] all-caps-every: 0
[2023-07-26 02:51:54] [config] allow-unk: false
[2023-07-26 02:51:54] [config] authors: false
[2023-07-26 02:51:54] [config] beam-size: 12
[2023-07-26 02:51:54] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:51:54] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:51:54] [config] bert-masking-fraction: 0.15
[2023-07-26 02:51:54] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:51:54] [config] bert-train-type-embeddings: true
[2023-07-26 02:51:54] [config] bert-type-vocab-size: 2
[2023-07-26 02:51:54] [config] build-info: ""
[2023-07-26 02:51:54] [config] check-gradient-nan: false
[2023-07-26 02:51:54] [config] check-nan: false
[2023-07-26 02:51:54] [config] cite: false
[2023-07-26 02:51:54] [config] clip-norm: 1
[2023-07-26 02:51:54] [config] cost-scaling:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] cost-type: ce-sum
[2023-07-26 02:51:54] [config] cpu-threads: 0
[2023-07-26 02:51:54] [config] data-threads: 8
[2023-07-26 02:51:54] [config] data-weighting: ""
[2023-07-26 02:51:54] [config] data-weighting-type: sentence
[2023-07-26 02:51:54] [config] dec-cell: gru
[2023-07-26 02:51:54] [config] dec-cell-base-depth: 2
[2023-07-26 02:51:54] [config] dec-cell-high-depth: 1
[2023-07-26 02:51:54] [config] dec-depth: 1
[2023-07-26 02:51:54] [config] devices:
[2023-07-26 02:51:54] [config]   - 0
[2023-07-26 02:51:54] [config]   - 1
[2023-07-26 02:51:54] [config] dim-emb: 512
[2023-07-26 02:51:54] [config] dim-rnn: 1024
[2023-07-26 02:51:54] [config] dim-vocabs:
[2023-07-26 02:51:54] [config]   - 54042
[2023-07-26 02:51:54] [config]   - 36507
[2023-07-26 02:51:54] [config] disp-first: 0
[2023-07-26 02:51:54] [config] disp-freq: 1000u
[2023-07-26 02:51:54] [config] disp-label-counts: true
[2023-07-26 02:51:54] [config] dropout-rnn: 0
[2023-07-26 02:51:54] [config] dropout-src: 0
[2023-07-26 02:51:54] [config] dropout-trg: 0
[2023-07-26 02:51:54] [config] dump-config: ""
[2023-07-26 02:51:54] [config] dynamic-gradient-scaling:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] early-stopping: 200
[2023-07-26 02:51:54] [config] early-stopping-on: first
[2023-07-26 02:51:54] [config] embedding-fix-src: false
[2023-07-26 02:51:54] [config] embedding-fix-trg: false
[2023-07-26 02:51:54] [config] embedding-normalization: false
[2023-07-26 02:51:54] [config] embedding-vectors:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] enc-cell: gru
[2023-07-26 02:51:54] [config] enc-cell-depth: 1
[2023-07-26 02:51:54] [config] enc-depth: 1
[2023-07-26 02:51:54] [config] enc-type: bidirectional
[2023-07-26 02:51:54] [config] english-title-case-every: 0
[2023-07-26 02:51:54] [config] exponential-smoothing: 0
[2023-07-26 02:51:54] [config] factor-weight: 1
[2023-07-26 02:51:54] [config] factors-combine: sum
[2023-07-26 02:51:54] [config] factors-dim-emb: 0
[2023-07-26 02:51:54] [config] gradient-checkpointing: false
[2023-07-26 02:51:54] [config] gradient-norm-average-window: 100
[2023-07-26 02:51:54] [config] guided-alignment: none
[2023-07-26 02:51:54] [config] guided-alignment-cost: mse
[2023-07-26 02:51:54] [config] guided-alignment-weight: 0.1
[2023-07-26 02:51:54] [config] ignore-model-config: false
[2023-07-26 02:51:54] [config] input-types:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] interpolate-env-vars: false
[2023-07-26 02:51:54] [config] keep-best: false
[2023-07-26 02:51:54] [config] label-smoothing: 0
[2023-07-26 02:51:54] [config] layer-normalization: false
[2023-07-26 02:51:54] [config] learn-rate: 0.0001
[2023-07-26 02:51:54] [config] lemma-dependency: ""
[2023-07-26 02:51:54] [config] lemma-dim-emb: 0
[2023-07-26 02:51:54] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:51:54] [config] log-level: info
[2023-07-26 02:51:54] [config] log-time-zone: ""
[2023-07-26 02:51:54] [config] logical-epoch:
[2023-07-26 02:51:54] [config]   - 1e
[2023-07-26 02:51:54] [config]   - 0
[2023-07-26 02:51:54] [config] lr-decay: 0
[2023-07-26 02:51:54] [config] lr-decay-freq: 50000
[2023-07-26 02:51:54] [config] lr-decay-inv-sqrt:
[2023-07-26 02:51:54] [config]   - 0
[2023-07-26 02:51:54] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:51:54] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:51:54] [config] lr-decay-start:
[2023-07-26 02:51:54] [config]   - 10
[2023-07-26 02:51:54] [config]   - 1
[2023-07-26 02:51:54] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:51:54] [config] lr-report: false
[2023-07-26 02:51:54] [config] lr-warmup: 0
[2023-07-26 02:51:54] [config] lr-warmup-at-reload: false
[2023-07-26 02:51:54] [config] lr-warmup-cycle: false
[2023-07-26 02:51:54] [config] lr-warmup-start-rate: 0
[2023-07-26 02:51:54] [config] max-length: 50
[2023-07-26 02:51:54] [config] max-length-crop: false
[2023-07-26 02:51:54] [config] max-length-factor: 3
[2023-07-26 02:51:54] [config] maxi-batch: 100
[2023-07-26 02:51:54] [config] maxi-batch-sort: trg
[2023-07-26 02:51:54] [config] mini-batch: 64
[2023-07-26 02:51:54] [config] mini-batch-fit: false
[2023-07-26 02:51:54] [config] mini-batch-fit-step: 10
[2023-07-26 02:51:54] [config] mini-batch-round-up: true
[2023-07-26 02:51:54] [config] mini-batch-track-lr: false
[2023-07-26 02:51:54] [config] mini-batch-warmup: 0
[2023-07-26 02:51:54] [config] mini-batch-words: 0
[2023-07-26 02:51:54] [config] mini-batch-words-ref: 0
[2023-07-26 02:51:54] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:51:54] [config] multi-loss-type: sum
[2023-07-26 02:51:54] [config] n-best: false
[2023-07-26 02:51:54] [config] no-nccl: false
[2023-07-26 02:51:54] [config] no-reload: false
[2023-07-26 02:51:54] [config] no-restore-corpus: false
[2023-07-26 02:51:54] [config] normalize: 0
[2023-07-26 02:51:54] [config] normalize-gradient: false
[2023-07-26 02:51:54] [config] num-devices: 0
[2023-07-26 02:51:54] [config] optimizer: adam
[2023-07-26 02:51:54] [config] optimizer-delay: 1
[2023-07-26 02:51:54] [config] optimizer-params:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] output-omit-bias: false
[2023-07-26 02:51:54] [config] overwrite: true
[2023-07-26 02:51:54] [config] precision:
[2023-07-26 02:51:54] [config]   - float32
[2023-07-26 02:51:54] [config]   - float32
[2023-07-26 02:51:54] [config] pretrained-model: ""
[2023-07-26 02:51:54] [config] quantize-biases: false
[2023-07-26 02:51:54] [config] quantize-bits: 0
[2023-07-26 02:51:54] [config] quantize-log-based: false
[2023-07-26 02:51:54] [config] quantize-optimization-steps: 0
[2023-07-26 02:51:54] [config] quiet: false
[2023-07-26 02:51:54] [config] quiet-translation: true
[2023-07-26 02:51:54] [config] relative-paths: false
[2023-07-26 02:51:54] [config] right-left: false
[2023-07-26 02:51:54] [config] save-freq: 10000u
[2023-07-26 02:51:54] [config] seed: 1234
[2023-07-26 02:51:54] [config] sentencepiece-alphas:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:51:54] [config] sentencepiece-options: ""
[2023-07-26 02:51:54] [config] sharding: global
[2023-07-26 02:51:54] [config] shuffle: data
[2023-07-26 02:51:54] [config] shuffle-in-ram: false
[2023-07-26 02:51:54] [config] sigterm: save-and-exit
[2023-07-26 02:51:54] [config] skip: false
[2023-07-26 02:51:54] [config] sqlite: ""
[2023-07-26 02:51:54] [config] sqlite-drop: false
[2023-07-26 02:51:54] [config] sync-freq: 200u
[2023-07-26 02:51:54] [config] sync-sgd: false
[2023-07-26 02:51:54] [config] tempdir: /tmp
[2023-07-26 02:51:54] [config] tied-embeddings: false
[2023-07-26 02:51:54] [config] tied-embeddings-all: false
[2023-07-26 02:51:54] [config] tied-embeddings-src: false
[2023-07-26 02:51:54] [config] train-embedder-rank:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] train-sets:
[2023-07-26 02:51:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:51:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:51:54] [config] transformer-aan-activation: swish
[2023-07-26 02:51:54] [config] transformer-aan-depth: 2
[2023-07-26 02:51:54] [config] transformer-aan-nogate: false
[2023-07-26 02:51:54] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:51:54] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:51:54] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:51:54] [config] transformer-depth-scaling: false
[2023-07-26 02:51:54] [config] transformer-dim-aan: 2048
[2023-07-26 02:51:54] [config] transformer-dim-ffn: 2048
[2023-07-26 02:51:54] [config] transformer-dropout: 0
[2023-07-26 02:51:54] [config] transformer-dropout-attention: 0
[2023-07-26 02:51:54] [config] transformer-dropout-ffn: 0
[2023-07-26 02:51:54] [config] transformer-ffn-activation: swish
[2023-07-26 02:51:54] [config] transformer-ffn-depth: 2
[2023-07-26 02:51:54] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:51:54] [config] transformer-heads: 8
[2023-07-26 02:51:54] [config] transformer-no-projection: false
[2023-07-26 02:51:54] [config] transformer-pool: false
[2023-07-26 02:51:54] [config] transformer-postprocess: dan
[2023-07-26 02:51:54] [config] transformer-postprocess-emb: d
[2023-07-26 02:51:54] [config] transformer-postprocess-top: ""
[2023-07-26 02:51:54] [config] transformer-preprocess: ""
[2023-07-26 02:51:54] [config] transformer-tied-layers:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] transformer-train-position-embeddings: false
[2023-07-26 02:51:54] [config] tsv: false
[2023-07-26 02:51:54] [config] tsv-fields: 0
[2023-07-26 02:51:54] [config] type: s2s
[2023-07-26 02:51:54] [config] ulr: false
[2023-07-26 02:51:54] [config] ulr-dim-emb: 0
[2023-07-26 02:51:54] [config] ulr-dropout: 0
[2023-07-26 02:51:54] [config] ulr-keys-vectors: ""
[2023-07-26 02:51:54] [config] ulr-query-vectors: ""
[2023-07-26 02:51:54] [config] ulr-softmax-temperature: 1
[2023-07-26 02:51:54] [config] ulr-trainable-transformation: false
[2023-07-26 02:51:54] [config] unlikelihood-loss: false
[2023-07-26 02:51:54] [config] valid-freq: 50000000
[2023-07-26 02:51:54] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:51:54] [config] valid-max-length: 1000
[2023-07-26 02:51:54] [config] valid-metrics:
[2023-07-26 02:51:54] [config]   - cross-entropy
[2023-07-26 02:51:54] [config]   - translation
[2023-07-26 02:51:54] [config] valid-mini-batch: 32
[2023-07-26 02:51:54] [config] valid-reset-stalled: false
[2023-07-26 02:51:54] [config] valid-script-args:
[2023-07-26 02:51:54] [config]   []
[2023-07-26 02:51:54] [config] valid-script-path: ""
[2023-07-26 02:51:54] [config] valid-sets:
[2023-07-26 02:51:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:51:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:51:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:51:54] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:51:54] [config] vocabs:
[2023-07-26 02:51:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:51:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:51:54] [config] word-penalty: 0
[2023-07-26 02:51:54] [config] word-scores: false
[2023-07-26 02:51:54] [config] workspace: 2048
[2023-07-26 02:51:54] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:51:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:51:54] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:51:54] Using asynchronous training
[2023-07-26 02:51:54] Synced seed 1234
[2023-07-26 02:51:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:51:54] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:51:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:51:55] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:51:55] [valid] No post-processing script given for validating translator
[2023-07-26 02:51:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:51:55] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:51:56] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:51:56] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:51:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:51:56] [comm] Using global sharding
[2023-07-26 02:51:56] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:51:56] [training] Using 2 GPUs
[2023-07-26 02:51:56] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:51:57] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:51:59] Loading Adam parameters
[2023-07-26 02:51:59] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:52:00] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:52:00] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:52:00] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:52:00] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:52:00] [data] Restoring the corpus state to epoch 171, batch 50363
[2023-07-26 02:52:00] [data] Shuffling data
[2023-07-26 02:52:00] [data] Done reading 20,192 sentences
[2023-07-26 02:52:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:52:00] Training started
[2023-07-26 02:52:00] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:52:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:52:01] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:52:01] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:52:01] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:52:01] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:52:01] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:52:01] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:52:01] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:52:28] Seen 18,555 samples
[2023-07-26 02:52:28] Starting data epoch 172 in logical epoch 172
[2023-07-26 02:52:28] [data] Shuffling data
[2023-07-26 02:52:28] [data] Done reading 20,192 sentences
[2023-07-26 02:52:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:52:57] Seen 18,843 samples
[2023-07-26 02:52:57] Starting data epoch 173 in logical epoch 173
[2023-07-26 02:52:57] [data] Shuffling data
[2023-07-26 02:52:57] [data] Done reading 20,192 sentences
[2023-07-26 02:52:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:53:02] Ep. 173 : Up. 51000 : Sen. 3,278 : Cost 0.00521156 * 1,328,151 @ 910 after 68,402,090 : Time 67.50s : 19677.33 words/s : gNorm 0.0000
[2023-07-26 02:53:27] Seen 18,843 samples
[2023-07-26 02:53:27] Starting data epoch 174 in logical epoch 174
[2023-07-26 02:53:27] [data] Shuffling data
[2023-07-26 02:53:27] [data] Done reading 20,192 sentences
[2023-07-26 02:53:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:53:57] Seen 18,843 samples
[2023-07-26 02:53:57] Starting data epoch 175 in logical epoch 175
[2023-07-26 02:53:57] [data] Shuffling data
[2023-07-26 02:53:57] [data] Done reading 20,192 sentences
[2023-07-26 02:53:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:54:27] Seen 18,843 samples
[2023-07-26 02:54:27] Starting data epoch 176 in logical epoch 176
[2023-07-26 02:54:27] [data] Shuffling data
[2023-07-26 02:54:27] [data] Done reading 20,192 sentences
[2023-07-26 02:54:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:54:43] Ep. 176 : Up. 52000 : Sen. 10,266 : Cost 0.00455547 * 1,354,765 @ 1,984 after 69,756,855 : Time 100.96s : 13419.40 words/s : gNorm 0.0000
[2023-07-26 02:54:56] Seen 18,843 samples
[2023-07-26 02:54:56] Starting data epoch 177 in logical epoch 177
[2023-07-26 02:54:56] [data] Shuffling data
[2023-07-26 02:54:56] [data] Done reading 20,192 sentences
[2023-07-26 02:54:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:55:26] Seen 18,880 samples
[2023-07-26 02:55:26] Starting data epoch 178 in logical epoch 178
[2023-07-26 02:55:26] [data] Shuffling data
[2023-07-26 02:55:26] [data] Done reading 20,192 sentences
[2023-07-26 02:55:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:55:56] Seen 18,831 samples
[2023-07-26 02:55:56] Starting data epoch 179 in logical epoch 179
[2023-07-26 02:55:56] [data] Shuffling data
[2023-07-26 02:55:56] [data] Done reading 20,192 sentences
[2023-07-26 02:55:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:56:23] Ep. 179 : Up. 53000 : Sen. 17,304 : Cost 0.00472295 * 1,341,223 @ 192 after 71,098,078 : Time 100.48s : 13348.59 words/s : gNorm 0.0000
[2023-07-26 02:56:26] Seen 18,818 samples
[2023-07-26 02:56:26] Starting data epoch 180 in logical epoch 180
[2023-07-26 02:56:26] [data] Shuffling data
[2023-07-26 02:56:26] [data] Done reading 20,192 sentences
[2023-07-26 02:56:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:56:55] Seen 18,843 samples
[2023-07-26 02:56:55] Starting data epoch 181 in logical epoch 181
[2023-07-26 02:56:55] Training finished
[2023-07-26 02:56:59] [valid] Ep. 181 : Up. 53325 : cross-entropy : 212.703 : stalled 16 times (last best: 103.711)
[2023-07-26 02:57:58] [valid] Ep. 181 : Up. 53325 : translation : 0 : new best
[2023-07-26 02:57:58] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:58:02] Saving Adam parameters
[2023-07-26 02:58:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:58:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:58:15] [marian] Running on node19.datos.cluster.uy as process 26537 with command line:
[2023-07-26 02:58:15] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 02:58:15] [config] after: 0e
[2023-07-26 02:58:15] [config] after-batches: 0
[2023-07-26 02:58:15] [config] after-epochs: 190
[2023-07-26 02:58:15] [config] all-caps-every: 0
[2023-07-26 02:58:15] [config] allow-unk: false
[2023-07-26 02:58:15] [config] authors: false
[2023-07-26 02:58:15] [config] beam-size: 12
[2023-07-26 02:58:15] [config] bert-class-symbol: "[CLS]"
[2023-07-26 02:58:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 02:58:15] [config] bert-masking-fraction: 0.15
[2023-07-26 02:58:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 02:58:15] [config] bert-train-type-embeddings: true
[2023-07-26 02:58:15] [config] bert-type-vocab-size: 2
[2023-07-26 02:58:15] [config] build-info: ""
[2023-07-26 02:58:15] [config] check-gradient-nan: false
[2023-07-26 02:58:15] [config] check-nan: false
[2023-07-26 02:58:15] [config] cite: false
[2023-07-26 02:58:15] [config] clip-norm: 1
[2023-07-26 02:58:15] [config] cost-scaling:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] cost-type: ce-sum
[2023-07-26 02:58:15] [config] cpu-threads: 0
[2023-07-26 02:58:15] [config] data-threads: 8
[2023-07-26 02:58:15] [config] data-weighting: ""
[2023-07-26 02:58:15] [config] data-weighting-type: sentence
[2023-07-26 02:58:15] [config] dec-cell: gru
[2023-07-26 02:58:15] [config] dec-cell-base-depth: 2
[2023-07-26 02:58:15] [config] dec-cell-high-depth: 1
[2023-07-26 02:58:15] [config] dec-depth: 1
[2023-07-26 02:58:15] [config] devices:
[2023-07-26 02:58:15] [config]   - 0
[2023-07-26 02:58:15] [config]   - 1
[2023-07-26 02:58:15] [config] dim-emb: 512
[2023-07-26 02:58:15] [config] dim-rnn: 1024
[2023-07-26 02:58:15] [config] dim-vocabs:
[2023-07-26 02:58:15] [config]   - 54042
[2023-07-26 02:58:15] [config]   - 36507
[2023-07-26 02:58:15] [config] disp-first: 0
[2023-07-26 02:58:15] [config] disp-freq: 1000u
[2023-07-26 02:58:15] [config] disp-label-counts: true
[2023-07-26 02:58:15] [config] dropout-rnn: 0
[2023-07-26 02:58:15] [config] dropout-src: 0
[2023-07-26 02:58:15] [config] dropout-trg: 0
[2023-07-26 02:58:15] [config] dump-config: ""
[2023-07-26 02:58:15] [config] dynamic-gradient-scaling:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] early-stopping: 200
[2023-07-26 02:58:15] [config] early-stopping-on: first
[2023-07-26 02:58:15] [config] embedding-fix-src: false
[2023-07-26 02:58:15] [config] embedding-fix-trg: false
[2023-07-26 02:58:15] [config] embedding-normalization: false
[2023-07-26 02:58:15] [config] embedding-vectors:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] enc-cell: gru
[2023-07-26 02:58:15] [config] enc-cell-depth: 1
[2023-07-26 02:58:15] [config] enc-depth: 1
[2023-07-26 02:58:15] [config] enc-type: bidirectional
[2023-07-26 02:58:15] [config] english-title-case-every: 0
[2023-07-26 02:58:15] [config] exponential-smoothing: 0
[2023-07-26 02:58:15] [config] factor-weight: 1
[2023-07-26 02:58:15] [config] factors-combine: sum
[2023-07-26 02:58:15] [config] factors-dim-emb: 0
[2023-07-26 02:58:15] [config] gradient-checkpointing: false
[2023-07-26 02:58:15] [config] gradient-norm-average-window: 100
[2023-07-26 02:58:15] [config] guided-alignment: none
[2023-07-26 02:58:15] [config] guided-alignment-cost: mse
[2023-07-26 02:58:15] [config] guided-alignment-weight: 0.1
[2023-07-26 02:58:15] [config] ignore-model-config: false
[2023-07-26 02:58:15] [config] input-types:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] interpolate-env-vars: false
[2023-07-26 02:58:15] [config] keep-best: false
[2023-07-26 02:58:15] [config] label-smoothing: 0
[2023-07-26 02:58:15] [config] layer-normalization: false
[2023-07-26 02:58:15] [config] learn-rate: 0.0001
[2023-07-26 02:58:15] [config] lemma-dependency: ""
[2023-07-26 02:58:15] [config] lemma-dim-emb: 0
[2023-07-26 02:58:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 02:58:15] [config] log-level: info
[2023-07-26 02:58:15] [config] log-time-zone: ""
[2023-07-26 02:58:15] [config] logical-epoch:
[2023-07-26 02:58:15] [config]   - 1e
[2023-07-26 02:58:15] [config]   - 0
[2023-07-26 02:58:15] [config] lr-decay: 0
[2023-07-26 02:58:15] [config] lr-decay-freq: 50000
[2023-07-26 02:58:15] [config] lr-decay-inv-sqrt:
[2023-07-26 02:58:15] [config]   - 0
[2023-07-26 02:58:15] [config] lr-decay-repeat-warmup: false
[2023-07-26 02:58:15] [config] lr-decay-reset-optimizer: false
[2023-07-26 02:58:15] [config] lr-decay-start:
[2023-07-26 02:58:15] [config]   - 10
[2023-07-26 02:58:15] [config]   - 1
[2023-07-26 02:58:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 02:58:15] [config] lr-report: false
[2023-07-26 02:58:15] [config] lr-warmup: 0
[2023-07-26 02:58:15] [config] lr-warmup-at-reload: false
[2023-07-26 02:58:15] [config] lr-warmup-cycle: false
[2023-07-26 02:58:15] [config] lr-warmup-start-rate: 0
[2023-07-26 02:58:15] [config] max-length: 50
[2023-07-26 02:58:15] [config] max-length-crop: false
[2023-07-26 02:58:15] [config] max-length-factor: 3
[2023-07-26 02:58:15] [config] maxi-batch: 100
[2023-07-26 02:58:15] [config] maxi-batch-sort: trg
[2023-07-26 02:58:15] [config] mini-batch: 64
[2023-07-26 02:58:15] [config] mini-batch-fit: false
[2023-07-26 02:58:15] [config] mini-batch-fit-step: 10
[2023-07-26 02:58:15] [config] mini-batch-round-up: true
[2023-07-26 02:58:15] [config] mini-batch-track-lr: false
[2023-07-26 02:58:15] [config] mini-batch-warmup: 0
[2023-07-26 02:58:15] [config] mini-batch-words: 0
[2023-07-26 02:58:15] [config] mini-batch-words-ref: 0
[2023-07-26 02:58:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:58:15] [config] multi-loss-type: sum
[2023-07-26 02:58:15] [config] n-best: false
[2023-07-26 02:58:15] [config] no-nccl: false
[2023-07-26 02:58:15] [config] no-reload: false
[2023-07-26 02:58:15] [config] no-restore-corpus: false
[2023-07-26 02:58:15] [config] normalize: 0
[2023-07-26 02:58:15] [config] normalize-gradient: false
[2023-07-26 02:58:15] [config] num-devices: 0
[2023-07-26 02:58:15] [config] optimizer: adam
[2023-07-26 02:58:15] [config] optimizer-delay: 1
[2023-07-26 02:58:15] [config] optimizer-params:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] output-omit-bias: false
[2023-07-26 02:58:15] [config] overwrite: true
[2023-07-26 02:58:15] [config] precision:
[2023-07-26 02:58:15] [config]   - float32
[2023-07-26 02:58:15] [config]   - float32
[2023-07-26 02:58:15] [config] pretrained-model: ""
[2023-07-26 02:58:15] [config] quantize-biases: false
[2023-07-26 02:58:15] [config] quantize-bits: 0
[2023-07-26 02:58:15] [config] quantize-log-based: false
[2023-07-26 02:58:15] [config] quantize-optimization-steps: 0
[2023-07-26 02:58:15] [config] quiet: false
[2023-07-26 02:58:15] [config] quiet-translation: true
[2023-07-26 02:58:15] [config] relative-paths: false
[2023-07-26 02:58:15] [config] right-left: false
[2023-07-26 02:58:15] [config] save-freq: 10000u
[2023-07-26 02:58:15] [config] seed: 1234
[2023-07-26 02:58:15] [config] sentencepiece-alphas:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] sentencepiece-max-lines: 2000000
[2023-07-26 02:58:15] [config] sentencepiece-options: ""
[2023-07-26 02:58:15] [config] sharding: global
[2023-07-26 02:58:15] [config] shuffle: data
[2023-07-26 02:58:15] [config] shuffle-in-ram: false
[2023-07-26 02:58:15] [config] sigterm: save-and-exit
[2023-07-26 02:58:15] [config] skip: false
[2023-07-26 02:58:15] [config] sqlite: ""
[2023-07-26 02:58:15] [config] sqlite-drop: false
[2023-07-26 02:58:15] [config] sync-freq: 200u
[2023-07-26 02:58:15] [config] sync-sgd: false
[2023-07-26 02:58:15] [config] tempdir: /tmp
[2023-07-26 02:58:15] [config] tied-embeddings: false
[2023-07-26 02:58:15] [config] tied-embeddings-all: false
[2023-07-26 02:58:15] [config] tied-embeddings-src: false
[2023-07-26 02:58:15] [config] train-embedder-rank:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] train-sets:
[2023-07-26 02:58:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 02:58:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 02:58:15] [config] transformer-aan-activation: swish
[2023-07-26 02:58:15] [config] transformer-aan-depth: 2
[2023-07-26 02:58:15] [config] transformer-aan-nogate: false
[2023-07-26 02:58:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 02:58:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 02:58:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 02:58:15] [config] transformer-depth-scaling: false
[2023-07-26 02:58:15] [config] transformer-dim-aan: 2048
[2023-07-26 02:58:15] [config] transformer-dim-ffn: 2048
[2023-07-26 02:58:15] [config] transformer-dropout: 0
[2023-07-26 02:58:15] [config] transformer-dropout-attention: 0
[2023-07-26 02:58:15] [config] transformer-dropout-ffn: 0
[2023-07-26 02:58:15] [config] transformer-ffn-activation: swish
[2023-07-26 02:58:15] [config] transformer-ffn-depth: 2
[2023-07-26 02:58:15] [config] transformer-guided-alignment-layer: last
[2023-07-26 02:58:15] [config] transformer-heads: 8
[2023-07-26 02:58:15] [config] transformer-no-projection: false
[2023-07-26 02:58:15] [config] transformer-pool: false
[2023-07-26 02:58:15] [config] transformer-postprocess: dan
[2023-07-26 02:58:15] [config] transformer-postprocess-emb: d
[2023-07-26 02:58:15] [config] transformer-postprocess-top: ""
[2023-07-26 02:58:15] [config] transformer-preprocess: ""
[2023-07-26 02:58:15] [config] transformer-tied-layers:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] transformer-train-position-embeddings: false
[2023-07-26 02:58:15] [config] tsv: false
[2023-07-26 02:58:15] [config] tsv-fields: 0
[2023-07-26 02:58:15] [config] type: s2s
[2023-07-26 02:58:15] [config] ulr: false
[2023-07-26 02:58:15] [config] ulr-dim-emb: 0
[2023-07-26 02:58:15] [config] ulr-dropout: 0
[2023-07-26 02:58:15] [config] ulr-keys-vectors: ""
[2023-07-26 02:58:15] [config] ulr-query-vectors: ""
[2023-07-26 02:58:15] [config] ulr-softmax-temperature: 1
[2023-07-26 02:58:15] [config] ulr-trainable-transformation: false
[2023-07-26 02:58:15] [config] unlikelihood-loss: false
[2023-07-26 02:58:15] [config] valid-freq: 50000000
[2023-07-26 02:58:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 02:58:15] [config] valid-max-length: 1000
[2023-07-26 02:58:15] [config] valid-metrics:
[2023-07-26 02:58:15] [config]   - cross-entropy
[2023-07-26 02:58:15] [config]   - translation
[2023-07-26 02:58:15] [config] valid-mini-batch: 32
[2023-07-26 02:58:15] [config] valid-reset-stalled: false
[2023-07-26 02:58:15] [config] valid-script-args:
[2023-07-26 02:58:15] [config]   []
[2023-07-26 02:58:15] [config] valid-script-path: ""
[2023-07-26 02:58:15] [config] valid-sets:
[2023-07-26 02:58:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 02:58:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 02:58:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 02:58:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:58:15] [config] vocabs:
[2023-07-26 02:58:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:58:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:58:15] [config] word-penalty: 0
[2023-07-26 02:58:15] [config] word-scores: false
[2023-07-26 02:58:15] [config] workspace: 2048
[2023-07-26 02:58:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 02:58:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:58:15] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:58:15] Using asynchronous training
[2023-07-26 02:58:15] Synced seed 1234
[2023-07-26 02:58:15] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 02:58:15] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 02:58:15] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 02:58:15] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 02:58:15] [valid] No post-processing script given for validating translator
[2023-07-26 02:58:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 02:58:15] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 02:58:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 02:58:17] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 02:58:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 02:58:17] [comm] Using global sharding
[2023-07-26 02:58:17] [comm] NCCLCommunicators constructed successfully
[2023-07-26 02:58:17] [training] Using 2 GPUs
[2023-07-26 02:58:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:58:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 02:58:20] Loading Adam parameters
[2023-07-26 02:58:20] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:58:21] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:58:21] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:58:21] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:58:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 02:58:21] [data] Restoring the corpus state to epoch 181, batch 53325
[2023-07-26 02:58:21] [data] Shuffling data
[2023-07-26 02:58:21] [data] Done reading 20,192 sentences
[2023-07-26 02:58:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:58:21] Training started
[2023-07-26 02:58:21] [logits] Applying loss function for 1 factor(s)
[2023-07-26 02:58:21] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 02:58:22] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:58:22] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:58:22] [memory] Reserving 188 MB, device gpu0
[2023-07-26 02:58:22] [memory] Reserving 188 MB, device gpu1
[2023-07-26 02:58:22] Parameter type float32, optimization type float32, casting types false
[2023-07-26 02:58:22] [memory] Reserving 377 MB, device gpu1
[2023-07-26 02:58:22] [memory] Reserving 377 MB, device gpu0
[2023-07-26 02:58:50] Seen 18,619 samples
[2023-07-26 02:58:50] Starting data epoch 182 in logical epoch 182
[2023-07-26 02:58:50] [data] Shuffling data
[2023-07-26 02:58:50] [data] Done reading 20,192 sentences
[2023-07-26 02:58:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:59:20] Seen 18,839 samples
[2023-07-26 02:59:20] Starting data epoch 183 in logical epoch 183
[2023-07-26 02:59:20] [data] Shuffling data
[2023-07-26 02:59:20] [data] Done reading 20,192 sentences
[2023-07-26 02:59:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 02:59:28] Ep. 183 : Up. 54000 : Sen. 5,674 : Cost 0.00458144 * 1,338,949 @ 2,261 after 72,437,027 : Time 73.14s : 18305.82 words/s : gNorm 0.0000
[2023-07-26 02:59:50] Seen 18,851 samples
[2023-07-26 02:59:50] Starting data epoch 184 in logical epoch 184
[2023-07-26 02:59:50] [data] Shuffling data
[2023-07-26 02:59:50] [data] Done reading 20,192 sentences
[2023-07-26 02:59:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:00:20] Seen 18,807 samples
[2023-07-26 03:00:20] Starting data epoch 185 in logical epoch 185
[2023-07-26 03:00:20] [data] Shuffling data
[2023-07-26 03:00:20] [data] Done reading 20,192 sentences
[2023-07-26 03:00:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:00:50] Seen 18,843 samples
[2023-07-26 03:00:50] Starting data epoch 186 in logical epoch 186
[2023-07-26 03:00:50] [data] Shuffling data
[2023-07-26 03:00:50] [data] Done reading 20,192 sentences
[2023-07-26 03:00:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:01:10] Ep. 186 : Up. 55000 : Sen. 12,823 : Cost 0.00415568 * 1,340,018 @ 719 after 73,777,045 : Time 101.92s : 13147.19 words/s : gNorm 0.0000
[2023-07-26 03:01:21] Seen 18,843 samples
[2023-07-26 03:01:21] Starting data epoch 187 in logical epoch 187
[2023-07-26 03:01:21] [data] Shuffling data
[2023-07-26 03:01:21] [data] Done reading 20,192 sentences
[2023-07-26 03:01:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:01:51] Seen 18,874 samples
[2023-07-26 03:01:51] Starting data epoch 188 in logical epoch 188
[2023-07-26 03:01:51] [data] Shuffling data
[2023-07-26 03:01:51] [data] Done reading 20,192 sentences
[2023-07-26 03:01:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:02:21] Seen 18,812 samples
[2023-07-26 03:02:21] Starting data epoch 189 in logical epoch 189
[2023-07-26 03:02:21] [data] Shuffling data
[2023-07-26 03:02:21] [data] Done reading 20,192 sentences
[2023-07-26 03:02:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:02:51] Seen 18,843 samples
[2023-07-26 03:02:51] Starting data epoch 190 in logical epoch 190
[2023-07-26 03:02:51] [data] Shuffling data
[2023-07-26 03:02:51] [data] Done reading 20,192 sentences
[2023-07-26 03:02:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:02:53] Ep. 190 : Up. 56000 : Sen. 1,024 : Cost 0.00468035 * 1,348,202 @ 1,664 after 75,125,247 : Time 102.56s : 13145.99 words/s : gNorm 0.0000
[2023-07-26 03:03:22] Seen 18,843 samples
[2023-07-26 03:03:22] Starting data epoch 191 in logical epoch 191
[2023-07-26 03:03:22] Training finished
[2023-07-26 03:03:26] [valid] Ep. 191 : Up. 56284 : cross-entropy : 214.564 : stalled 17 times (last best: 103.711)
[2023-07-26 03:04:22] [valid] Ep. 191 : Up. 56284 : translation : 0 : new best
[2023-07-26 03:04:22] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 03:04:25] Saving Adam parameters
[2023-07-26 03:04:27] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 03:04:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 03:04:39] [marian] Running on node19.datos.cluster.uy as process 10288 with command line:
[2023-07-26 03:04:39] [marian] /marian/build/marian --devices 0 1 --early-stopping 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-26 03:04:39] [config] after: 0e
[2023-07-26 03:04:39] [config] after-batches: 0
[2023-07-26 03:04:39] [config] after-epochs: 200
[2023-07-26 03:04:39] [config] all-caps-every: 0
[2023-07-26 03:04:39] [config] allow-unk: false
[2023-07-26 03:04:39] [config] authors: false
[2023-07-26 03:04:39] [config] beam-size: 12
[2023-07-26 03:04:39] [config] bert-class-symbol: "[CLS]"
[2023-07-26 03:04:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-26 03:04:39] [config] bert-masking-fraction: 0.15
[2023-07-26 03:04:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-26 03:04:39] [config] bert-train-type-embeddings: true
[2023-07-26 03:04:39] [config] bert-type-vocab-size: 2
[2023-07-26 03:04:39] [config] build-info: ""
[2023-07-26 03:04:39] [config] check-gradient-nan: false
[2023-07-26 03:04:39] [config] check-nan: false
[2023-07-26 03:04:39] [config] cite: false
[2023-07-26 03:04:39] [config] clip-norm: 1
[2023-07-26 03:04:39] [config] cost-scaling:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] cost-type: ce-sum
[2023-07-26 03:04:39] [config] cpu-threads: 0
[2023-07-26 03:04:39] [config] data-threads: 8
[2023-07-26 03:04:39] [config] data-weighting: ""
[2023-07-26 03:04:39] [config] data-weighting-type: sentence
[2023-07-26 03:04:39] [config] dec-cell: gru
[2023-07-26 03:04:39] [config] dec-cell-base-depth: 2
[2023-07-26 03:04:39] [config] dec-cell-high-depth: 1
[2023-07-26 03:04:39] [config] dec-depth: 1
[2023-07-26 03:04:39] [config] devices:
[2023-07-26 03:04:39] [config]   - 0
[2023-07-26 03:04:39] [config]   - 1
[2023-07-26 03:04:39] [config] dim-emb: 512
[2023-07-26 03:04:39] [config] dim-rnn: 1024
[2023-07-26 03:04:39] [config] dim-vocabs:
[2023-07-26 03:04:39] [config]   - 54042
[2023-07-26 03:04:39] [config]   - 36507
[2023-07-26 03:04:39] [config] disp-first: 0
[2023-07-26 03:04:39] [config] disp-freq: 1000u
[2023-07-26 03:04:39] [config] disp-label-counts: true
[2023-07-26 03:04:39] [config] dropout-rnn: 0
[2023-07-26 03:04:39] [config] dropout-src: 0
[2023-07-26 03:04:39] [config] dropout-trg: 0
[2023-07-26 03:04:39] [config] dump-config: ""
[2023-07-26 03:04:39] [config] dynamic-gradient-scaling:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] early-stopping: 200
[2023-07-26 03:04:39] [config] early-stopping-on: first
[2023-07-26 03:04:39] [config] embedding-fix-src: false
[2023-07-26 03:04:39] [config] embedding-fix-trg: false
[2023-07-26 03:04:39] [config] embedding-normalization: false
[2023-07-26 03:04:39] [config] embedding-vectors:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] enc-cell: gru
[2023-07-26 03:04:39] [config] enc-cell-depth: 1
[2023-07-26 03:04:39] [config] enc-depth: 1
[2023-07-26 03:04:39] [config] enc-type: bidirectional
[2023-07-26 03:04:39] [config] english-title-case-every: 0
[2023-07-26 03:04:39] [config] exponential-smoothing: 0
[2023-07-26 03:04:39] [config] factor-weight: 1
[2023-07-26 03:04:39] [config] factors-combine: sum
[2023-07-26 03:04:39] [config] factors-dim-emb: 0
[2023-07-26 03:04:39] [config] gradient-checkpointing: false
[2023-07-26 03:04:39] [config] gradient-norm-average-window: 100
[2023-07-26 03:04:39] [config] guided-alignment: none
[2023-07-26 03:04:39] [config] guided-alignment-cost: mse
[2023-07-26 03:04:39] [config] guided-alignment-weight: 0.1
[2023-07-26 03:04:39] [config] ignore-model-config: false
[2023-07-26 03:04:39] [config] input-types:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] interpolate-env-vars: false
[2023-07-26 03:04:39] [config] keep-best: false
[2023-07-26 03:04:39] [config] label-smoothing: 0
[2023-07-26 03:04:39] [config] layer-normalization: false
[2023-07-26 03:04:39] [config] learn-rate: 0.0001
[2023-07-26 03:04:39] [config] lemma-dependency: ""
[2023-07-26 03:04:39] [config] lemma-dim-emb: 0
[2023-07-26 03:04:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_s2s.log
[2023-07-26 03:04:39] [config] log-level: info
[2023-07-26 03:04:39] [config] log-time-zone: ""
[2023-07-26 03:04:39] [config] logical-epoch:
[2023-07-26 03:04:39] [config]   - 1e
[2023-07-26 03:04:39] [config]   - 0
[2023-07-26 03:04:39] [config] lr-decay: 0
[2023-07-26 03:04:39] [config] lr-decay-freq: 50000
[2023-07-26 03:04:39] [config] lr-decay-inv-sqrt:
[2023-07-26 03:04:39] [config]   - 0
[2023-07-26 03:04:39] [config] lr-decay-repeat-warmup: false
[2023-07-26 03:04:39] [config] lr-decay-reset-optimizer: false
[2023-07-26 03:04:39] [config] lr-decay-start:
[2023-07-26 03:04:39] [config]   - 10
[2023-07-26 03:04:39] [config]   - 1
[2023-07-26 03:04:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-26 03:04:39] [config] lr-report: false
[2023-07-26 03:04:39] [config] lr-warmup: 0
[2023-07-26 03:04:39] [config] lr-warmup-at-reload: false
[2023-07-26 03:04:39] [config] lr-warmup-cycle: false
[2023-07-26 03:04:39] [config] lr-warmup-start-rate: 0
[2023-07-26 03:04:39] [config] max-length: 50
[2023-07-26 03:04:39] [config] max-length-crop: false
[2023-07-26 03:04:39] [config] max-length-factor: 3
[2023-07-26 03:04:39] [config] maxi-batch: 100
[2023-07-26 03:04:39] [config] maxi-batch-sort: trg
[2023-07-26 03:04:39] [config] mini-batch: 64
[2023-07-26 03:04:39] [config] mini-batch-fit: false
[2023-07-26 03:04:39] [config] mini-batch-fit-step: 10
[2023-07-26 03:04:39] [config] mini-batch-round-up: true
[2023-07-26 03:04:39] [config] mini-batch-track-lr: false
[2023-07-26 03:04:39] [config] mini-batch-warmup: 0
[2023-07-26 03:04:39] [config] mini-batch-words: 0
[2023-07-26 03:04:39] [config] mini-batch-words-ref: 0
[2023-07-26 03:04:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 03:04:39] [config] multi-loss-type: sum
[2023-07-26 03:04:39] [config] n-best: false
[2023-07-26 03:04:39] [config] no-nccl: false
[2023-07-26 03:04:39] [config] no-reload: false
[2023-07-26 03:04:39] [config] no-restore-corpus: false
[2023-07-26 03:04:39] [config] normalize: 0
[2023-07-26 03:04:39] [config] normalize-gradient: false
[2023-07-26 03:04:39] [config] num-devices: 0
[2023-07-26 03:04:39] [config] optimizer: adam
[2023-07-26 03:04:39] [config] optimizer-delay: 1
[2023-07-26 03:04:39] [config] optimizer-params:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] output-omit-bias: false
[2023-07-26 03:04:39] [config] overwrite: true
[2023-07-26 03:04:39] [config] precision:
[2023-07-26 03:04:39] [config]   - float32
[2023-07-26 03:04:39] [config]   - float32
[2023-07-26 03:04:39] [config] pretrained-model: ""
[2023-07-26 03:04:39] [config] quantize-biases: false
[2023-07-26 03:04:39] [config] quantize-bits: 0
[2023-07-26 03:04:39] [config] quantize-log-based: false
[2023-07-26 03:04:39] [config] quantize-optimization-steps: 0
[2023-07-26 03:04:39] [config] quiet: false
[2023-07-26 03:04:39] [config] quiet-translation: true
[2023-07-26 03:04:39] [config] relative-paths: false
[2023-07-26 03:04:39] [config] right-left: false
[2023-07-26 03:04:39] [config] save-freq: 10000u
[2023-07-26 03:04:39] [config] seed: 1234
[2023-07-26 03:04:39] [config] sentencepiece-alphas:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] sentencepiece-max-lines: 2000000
[2023-07-26 03:04:39] [config] sentencepiece-options: ""
[2023-07-26 03:04:39] [config] sharding: global
[2023-07-26 03:04:39] [config] shuffle: data
[2023-07-26 03:04:39] [config] shuffle-in-ram: false
[2023-07-26 03:04:39] [config] sigterm: save-and-exit
[2023-07-26 03:04:39] [config] skip: false
[2023-07-26 03:04:39] [config] sqlite: ""
[2023-07-26 03:04:39] [config] sqlite-drop: false
[2023-07-26 03:04:39] [config] sync-freq: 200u
[2023-07-26 03:04:39] [config] sync-sgd: false
[2023-07-26 03:04:39] [config] tempdir: /tmp
[2023-07-26 03:04:39] [config] tied-embeddings: false
[2023-07-26 03:04:39] [config] tied-embeddings-all: false
[2023-07-26 03:04:39] [config] tied-embeddings-src: false
[2023-07-26 03:04:39] [config] train-embedder-rank:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] train-sets:
[2023-07-26 03:04:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-26 03:04:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-26 03:04:39] [config] transformer-aan-activation: swish
[2023-07-26 03:04:39] [config] transformer-aan-depth: 2
[2023-07-26 03:04:39] [config] transformer-aan-nogate: false
[2023-07-26 03:04:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-26 03:04:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-26 03:04:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-26 03:04:39] [config] transformer-depth-scaling: false
[2023-07-26 03:04:39] [config] transformer-dim-aan: 2048
[2023-07-26 03:04:39] [config] transformer-dim-ffn: 2048
[2023-07-26 03:04:39] [config] transformer-dropout: 0
[2023-07-26 03:04:39] [config] transformer-dropout-attention: 0
[2023-07-26 03:04:39] [config] transformer-dropout-ffn: 0
[2023-07-26 03:04:39] [config] transformer-ffn-activation: swish
[2023-07-26 03:04:39] [config] transformer-ffn-depth: 2
[2023-07-26 03:04:39] [config] transformer-guided-alignment-layer: last
[2023-07-26 03:04:39] [config] transformer-heads: 8
[2023-07-26 03:04:39] [config] transformer-no-projection: false
[2023-07-26 03:04:39] [config] transformer-pool: false
[2023-07-26 03:04:39] [config] transformer-postprocess: dan
[2023-07-26 03:04:39] [config] transformer-postprocess-emb: d
[2023-07-26 03:04:39] [config] transformer-postprocess-top: ""
[2023-07-26 03:04:39] [config] transformer-preprocess: ""
[2023-07-26 03:04:39] [config] transformer-tied-layers:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] transformer-train-position-embeddings: false
[2023-07-26 03:04:39] [config] tsv: false
[2023-07-26 03:04:39] [config] tsv-fields: 0
[2023-07-26 03:04:39] [config] type: s2s
[2023-07-26 03:04:39] [config] ulr: false
[2023-07-26 03:04:39] [config] ulr-dim-emb: 0
[2023-07-26 03:04:39] [config] ulr-dropout: 0
[2023-07-26 03:04:39] [config] ulr-keys-vectors: ""
[2023-07-26 03:04:39] [config] ulr-query-vectors: ""
[2023-07-26 03:04:39] [config] ulr-softmax-temperature: 1
[2023-07-26 03:04:39] [config] ulr-trainable-transformation: false
[2023-07-26 03:04:39] [config] unlikelihood-loss: false
[2023-07-26 03:04:39] [config] valid-freq: 50000000
[2023-07-26 03:04:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_s2s.log
[2023-07-26 03:04:39] [config] valid-max-length: 1000
[2023-07-26 03:04:39] [config] valid-metrics:
[2023-07-26 03:04:39] [config]   - cross-entropy
[2023-07-26 03:04:39] [config]   - translation
[2023-07-26 03:04:39] [config] valid-mini-batch: 32
[2023-07-26 03:04:39] [config] valid-reset-stalled: false
[2023-07-26 03:04:39] [config] valid-script-args:
[2023-07-26 03:04:39] [config]   []
[2023-07-26 03:04:39] [config] valid-script-path: ""
[2023-07-26 03:04:39] [config] valid-sets:
[2023-07-26 03:04:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-26 03:04:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-26 03:04:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-26 03:04:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 03:04:39] [config] vocabs:
[2023-07-26 03:04:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 03:04:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 03:04:39] [config] word-penalty: 0
[2023-07-26 03:04:39] [config] word-scores: false
[2023-07-26 03:04:39] [config] workspace: 2048
[2023-07-26 03:04:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-26 03:04:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 03:04:39] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 03:04:39] Using asynchronous training
[2023-07-26 03:04:40] Synced seed 1234
[2023-07-26 03:04:40] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-26 03:04:40] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-26 03:04:40] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-26 03:04:40] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-26 03:04:40] [valid] No post-processing script given for validating translator
[2023-07-26 03:04:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-26 03:04:40] [MPI rank 0 out of 1]: GPU[1]
[2023-07-26 03:04:41] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-26 03:04:41] [memory] Extending reserved space to 2048 MB (device gpu1)
[2023-07-26 03:04:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-26 03:04:41] [comm] Using global sharding
[2023-07-26 03:04:42] [comm] NCCLCommunicators constructed successfully
[2023-07-26 03:04:42] [training] Using 2 GPUs
[2023-07-26 03:04:42] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 03:04:42] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 03:04:44] Loading Adam parameters
[2023-07-26 03:04:45] [memory] Reserving 377 MB, device gpu0
[2023-07-26 03:04:45] [memory] Reserving 377 MB, device gpu1
[2023-07-26 03:04:45] [memory] Reserving 377 MB, device gpu0
[2023-07-26 03:04:45] [memory] Reserving 377 MB, device gpu1
[2023-07-26 03:04:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
[2023-07-26 03:04:46] [data] Restoring the corpus state to epoch 191, batch 56284
[2023-07-26 03:04:46] [data] Shuffling data
[2023-07-26 03:04:46] [data] Done reading 20,192 sentences
[2023-07-26 03:04:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:04:46] Training started
[2023-07-26 03:04:46] [logits] Applying loss function for 1 factor(s)
[2023-07-26 03:04:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-26 03:04:46] [memory] Reserving 188 MB, device gpu0
[2023-07-26 03:04:46] [memory] Reserving 188 MB, device gpu1
[2023-07-26 03:04:46] [memory] Reserving 188 MB, device gpu0
[2023-07-26 03:04:46] [memory] Reserving 188 MB, device gpu1
[2023-07-26 03:04:46] Parameter type float32, optimization type float32, casting types false
[2023-07-26 03:04:46] [memory] Reserving 377 MB, device gpu0
[2023-07-26 03:04:46] [memory] Reserving 377 MB, device gpu1
[2023-07-26 03:05:14] Seen 18,587 samples
[2023-07-26 03:05:14] Starting data epoch 192 in logical epoch 192
[2023-07-26 03:05:14] [data] Shuffling data
[2023-07-26 03:05:14] [data] Done reading 20,192 sentences
[2023-07-26 03:05:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:05:43] Seen 18,843 samples
[2023-07-26 03:05:43] Starting data epoch 193 in logical epoch 193
[2023-07-26 03:05:43] [data] Shuffling data
[2023-07-26 03:05:43] [data] Done reading 20,192 sentences
[2023-07-26 03:05:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:05:57] Ep. 193 : Up. 57000 : Sen. 8,367 : Cost 0.00453943 * 1,346,180 @ 593 after 76,471,427 : Time 76.89s : 17508.75 words/s : gNorm 0.0000
[2023-07-26 03:06:13] Seen 18,843 samples
[2023-07-26 03:06:13] Starting data epoch 194 in logical epoch 194
[2023-07-26 03:06:13] [data] Shuffling data
[2023-07-26 03:06:13] [data] Done reading 20,192 sentences
[2023-07-26 03:06:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:06:43] Seen 18,843 samples
[2023-07-26 03:06:43] Starting data epoch 195 in logical epoch 195
[2023-07-26 03:06:43] [data] Shuffling data
[2023-07-26 03:06:43] [data] Done reading 20,192 sentences
[2023-07-26 03:06:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:07:13] Seen 18,843 samples
[2023-07-26 03:07:13] Starting data epoch 196 in logical epoch 196
[2023-07-26 03:07:13] [data] Shuffling data
[2023-07-26 03:07:13] [data] Done reading 20,192 sentences
[2023-07-26 03:07:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:07:38] Ep. 196 : Up. 58000 : Sen. 15,386 : Cost 0.00422364 * 1,336,009 @ 128 after 77,807,436 : Time 101.01s : 13226.53 words/s : gNorm 0.0000
[2023-07-26 03:07:43] Seen 18,843 samples
[2023-07-26 03:07:43] Starting data epoch 197 in logical epoch 197
[2023-07-26 03:07:43] [data] Shuffling data
[2023-07-26 03:07:43] [data] Done reading 20,192 sentences
[2023-07-26 03:07:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:08:14] Seen 18,843 samples
[2023-07-26 03:08:14] Starting data epoch 198 in logical epoch 198
[2023-07-26 03:08:14] [data] Shuffling data
[2023-07-26 03:08:14] [data] Done reading 20,192 sentences
[2023-07-26 03:08:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:08:44] Seen 18,843 samples
[2023-07-26 03:08:44] Starting data epoch 199 in logical epoch 199
[2023-07-26 03:08:44] [data] Shuffling data
[2023-07-26 03:08:44] [data] Done reading 20,192 sentences
[2023-07-26 03:08:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:09:14] Seen 18,843 samples
[2023-07-26 03:09:14] Starting data epoch 200 in logical epoch 200
[2023-07-26 03:09:14] [data] Shuffling data
[2023-07-26 03:09:14] [data] Done reading 20,192 sentences
[2023-07-26 03:09:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-26 03:09:19] Ep. 200 : Up. 59000 : Sen. 3,584 : Cost 0.00376162 * 1,340,717 @ 832 after 79,148,153 : Time 101.51s : 13207.41 words/s : gNorm 0.0000
[2023-07-26 03:09:44] Seen 18,843 samples
[2023-07-26 03:09:44] Starting data epoch 201 in logical epoch 201
[2023-07-26 03:09:44] Training finished
[2023-07-26 03:09:47] [valid] Ep. 201 : Up. 59244 : cross-entropy : 216.728 : stalled 18 times (last best: 103.711)
[2023-07-26 03:10:45] [valid] Ep. 201 : Up. 59244 : translation : 0 : new best
[2023-07-26 03:10:45] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz
[2023-07-26 03:10:49] Saving Adam parameters
[2023-07-26 03:10:50] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_s2s/gn_es_scored_june_s2s.npz.optimizer.npz
