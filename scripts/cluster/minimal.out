usage: main.py [-h] --flags FLAGS [--train-sets TRAIN_SETS] --command-path
               COMMAND_PATH [--validate-each-epochs VALIDATE_EACH_EPOCHS]
               [--validation-metrics VALIDATION_METRICS] [--save-checkpoints]
               [--not-delete-model-after] [--ingest] [--train] [--transform]
               [--run-id RUN_ID] [--hyperparameter-tuning]
               [--tuning-grid-files TUNING_GRID_FILES]
               [--tuning-params-files TUNING_PARAMS_FILES]
               [--from-flags FROM_FLAGS] [--to-flags TO_FLAGS]
main.py: error: the following arguments are required: --flags
/docker/home/scripts/train_gn_es_level2_s2s_grid.sh: line 22: --from-flags: command not found
/docker/home/scripts/train_gn_es_level2_s2s_grid.sh: line 23: --to-flags: command not found
/docker/home/scripts/train_gn_es_level2_s2s_grid.sh: line 24: --validate-each-epochs: command not found
[2023-07-21 18:00:22] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 18:00:22] [valid] No post-processing script given for validating translator
[2023-07-21 18:00:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:00:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:00:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:00:22] [comm] Using global sharding
[2023-07-21 18:00:22] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:00:22] [training] Using 1 GPUs
[2023-07-21 18:00:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 18:00:30] Allocating memory for general optimizer shards
[2023-07-21 18:00:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:00:30] Loading Adam parameters
[2023-07-21 18:00:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:00:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:00:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 18:00:31] [data] Restoring the corpus state to epoch 181, batch 6975
[2023-07-21 18:00:31] [data] Shuffling data
[2023-07-21 18:00:31] [data] Done reading 20,192 sentences
[2023-07-21 18:00:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:00:31] Training started
[2023-07-21 18:00:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 18:00:31] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:00:36] Parameter type float16, optimization type float32, casting types true
[2023-07-21 18:03:20] Ep. 181 : Up. 7000 : Sen. 13,277 : Cost 2.81140685 * 16,074,491 @ 16,138 after 112,093,581 : Time 177.53s : 90547.44 words/s : gNorm 1.7939
[2023-07-21 18:05:07] Seen 20,192 samples
[2023-07-21 18:05:07] Starting data epoch 182 in logical epoch 182
[2023-07-21 18:05:07] [data] Shuffling data
[2023-07-21 18:05:08] [data] Done reading 20,192 sentences
[2023-07-21 18:05:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:09:59] Seen 20,192 samples
[2023-07-21 18:09:59] Starting data epoch 183 in logical epoch 183
[2023-07-21 18:09:59] [data] Shuffling data
[2023-07-21 18:09:59] [data] Done reading 20,192 sentences
[2023-07-21 18:09:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:14:53] Seen 20,192 samples
[2023-07-21 18:14:53] Starting data epoch 184 in logical epoch 184
[2023-07-21 18:14:53] [data] Shuffling data
[2023-07-21 18:14:53] [data] Done reading 20,192 sentences
[2023-07-21 18:14:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:19:36] Seen 20,192 samples
[2023-07-21 18:19:36] Starting data epoch 185 in logical epoch 185
[2023-07-21 18:19:36] [data] Shuffling data
[2023-07-21 18:19:36] [data] Done reading 20,192 sentences
[2023-07-21 18:19:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:24:08] Seen 20,192 samples
[2023-07-21 18:24:08] Starting data epoch 186 in logical epoch 186
[2023-07-21 18:24:08] [data] Shuffling data
[2023-07-21 18:24:08] [data] Done reading 20,192 sentences
[2023-07-21 18:24:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:28:57] Seen 20,192 samples
[2023-07-21 18:28:57] Starting data epoch 187 in logical epoch 187
[2023-07-21 18:28:57] [data] Shuffling data
[2023-07-21 18:28:57] [data] Done reading 20,192 sentences
[2023-07-21 18:28:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:33:45] Seen 20,192 samples
[2023-07-21 18:33:45] Starting data epoch 188 in logical epoch 188
[2023-07-21 18:33:45] [data] Shuffling data
[2023-07-21 18:33:45] [data] Done reading 20,192 sentences
[2023-07-21 18:33:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:38:38] Seen 20,192 samples
[2023-07-21 18:38:38] Starting data epoch 189 in logical epoch 189
[2023-07-21 18:38:38] [data] Shuffling data
[2023-07-21 18:38:38] [data] Done reading 20,192 sentences
[2023-07-21 18:38:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:43:20] Seen 20,192 samples
[2023-07-21 18:43:20] Starting data epoch 190 in logical epoch 190
[2023-07-21 18:43:20] [data] Shuffling data
[2023-07-21 18:43:20] [data] Done reading 20,192 sentences
[2023-07-21 18:43:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:48:12] Seen 20,192 samples
[2023-07-21 18:48:12] Starting data epoch 191 in logical epoch 191
[2023-07-21 18:48:12] Training finished
[2023-07-21 18:48:24] [valid] Ep. 191 : Up. 7363 : cross-entropy : 135.581 : stalled 5 times (last best: 130.991)
[2023-07-21 18:50:28] [valid] Ep. 191 : Up. 7363 : translation : 0 : new best
[2023-07-21 18:50:28] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 18:50:29] Saving Adam parameters
[2023-07-21 18:50:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 18:50:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:50:39] [marian] Running on node18.datos.cluster.uy as process 4393 with command line:
[2023-07-21 18:50:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 18:50:39] [config] after: 0e
[2023-07-21 18:50:39] [config] after-batches: 0
[2023-07-21 18:50:39] [config] after-epochs: 200
[2023-07-21 18:50:39] [config] all-caps-every: 0
[2023-07-21 18:50:39] [config] allow-unk: false
[2023-07-21 18:50:39] [config] authors: false
[2023-07-21 18:50:39] [config] beam-size: 12
[2023-07-21 18:50:39] [config] bert-class-symbol: "[CLS]"
[2023-07-21 18:50:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 18:50:39] [config] bert-masking-fraction: 0.15
[2023-07-21 18:50:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 18:50:39] [config] bert-train-type-embeddings: true
[2023-07-21 18:50:39] [config] bert-type-vocab-size: 2
[2023-07-21 18:50:39] [config] build-info: ""
[2023-07-21 18:50:39] [config] check-gradient-nan: false
[2023-07-21 18:50:39] [config] check-nan: false
[2023-07-21 18:50:39] [config] cite: false
[2023-07-21 18:50:39] [config] clip-norm: 1
[2023-07-21 18:50:39] [config] cost-scaling:
[2023-07-21 18:50:39] [config]   - 256.f
[2023-07-21 18:50:39] [config]   - 1000
[2023-07-21 18:50:39] [config]   - 2.f
[2023-07-21 18:50:39] [config]   - 256.f
[2023-07-21 18:50:39] [config] cost-type: ce-sum
[2023-07-21 18:50:39] [config] cpu-threads: 0
[2023-07-21 18:50:39] [config] data-threads: 8
[2023-07-21 18:50:39] [config] data-weighting: ""
[2023-07-21 18:50:39] [config] data-weighting-type: sentence
[2023-07-21 18:50:39] [config] dec-cell: gru
[2023-07-21 18:50:39] [config] dec-cell-base-depth: 2
[2023-07-21 18:50:39] [config] dec-cell-high-depth: 1
[2023-07-21 18:50:39] [config] dec-depth: 1
[2023-07-21 18:50:39] [config] devices:
[2023-07-21 18:50:39] [config]   - 0
[2023-07-21 18:50:39] [config] dim-emb: 512
[2023-07-21 18:50:39] [config] dim-rnn: 1024
[2023-07-21 18:50:39] [config] dim-vocabs:
[2023-07-21 18:50:39] [config]   - 16384
[2023-07-21 18:50:39] [config]   - 16384
[2023-07-21 18:50:39] [config] disp-first: 0
[2023-07-21 18:50:39] [config] disp-freq: 1000u
[2023-07-21 18:50:39] [config] disp-label-counts: true
[2023-07-21 18:50:39] [config] dropout-rnn: 0
[2023-07-21 18:50:39] [config] dropout-src: 0
[2023-07-21 18:50:39] [config] dropout-trg: 0
[2023-07-21 18:50:39] [config] dump-config: ""
[2023-07-21 18:50:39] [config] dynamic-gradient-scaling:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] early-stopping: 200
[2023-07-21 18:50:39] [config] early-stopping-on: first
[2023-07-21 18:50:39] [config] embedding-fix-src: false
[2023-07-21 18:50:39] [config] embedding-fix-trg: false
[2023-07-21 18:50:39] [config] embedding-normalization: false
[2023-07-21 18:50:39] [config] embedding-vectors:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] enc-cell: gru
[2023-07-21 18:50:39] [config] enc-cell-depth: 1
[2023-07-21 18:50:39] [config] enc-depth: 1
[2023-07-21 18:50:39] [config] enc-type: bidirectional
[2023-07-21 18:50:39] [config] english-title-case-every: 0
[2023-07-21 18:50:39] [config] exponential-smoothing: 0
[2023-07-21 18:50:39] [config] factor-weight: 1
[2023-07-21 18:50:39] [config] factors-combine: sum
[2023-07-21 18:50:39] [config] factors-dim-emb: 0
[2023-07-21 18:50:39] [config] gradient-checkpointing: false
[2023-07-21 18:50:39] [config] gradient-norm-average-window: 100
[2023-07-21 18:50:39] [config] guided-alignment: none
[2023-07-21 18:50:39] [config] guided-alignment-cost: mse
[2023-07-21 18:50:39] [config] guided-alignment-weight: 0.1
[2023-07-21 18:50:39] [config] ignore-model-config: false
[2023-07-21 18:50:39] [config] input-types:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] interpolate-env-vars: false
[2023-07-21 18:50:39] [config] keep-best: false
[2023-07-21 18:50:39] [config] label-smoothing: 0
[2023-07-21 18:50:39] [config] layer-normalization: false
[2023-07-21 18:50:39] [config] learn-rate: 0.0001
[2023-07-21 18:50:39] [config] lemma-dependency: ""
[2023-07-21 18:50:39] [config] lemma-dim-emb: 0
[2023-07-21 18:50:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 18:50:39] [config] log-level: info
[2023-07-21 18:50:39] [config] log-time-zone: ""
[2023-07-21 18:50:39] [config] logical-epoch:
[2023-07-21 18:50:39] [config]   - 1e
[2023-07-21 18:50:39] [config]   - 0
[2023-07-21 18:50:39] [config] lr-decay: 0
[2023-07-21 18:50:39] [config] lr-decay-freq: 50000
[2023-07-21 18:50:39] [config] lr-decay-inv-sqrt:
[2023-07-21 18:50:39] [config]   - 0
[2023-07-21 18:50:39] [config] lr-decay-repeat-warmup: false
[2023-07-21 18:50:39] [config] lr-decay-reset-optimizer: false
[2023-07-21 18:50:39] [config] lr-decay-start:
[2023-07-21 18:50:39] [config]   - 10
[2023-07-21 18:50:39] [config]   - 1
[2023-07-21 18:50:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 18:50:39] [config] lr-report: false
[2023-07-21 18:50:39] [config] lr-warmup: 0
[2023-07-21 18:50:39] [config] lr-warmup-at-reload: false
[2023-07-21 18:50:39] [config] lr-warmup-cycle: false
[2023-07-21 18:50:39] [config] lr-warmup-start-rate: 0
[2023-07-21 18:50:39] [config] max-length: 250
[2023-07-21 18:50:39] [config] max-length-crop: true
[2023-07-21 18:50:39] [config] max-length-factor: 3
[2023-07-21 18:50:39] [config] maxi-batch: 100
[2023-07-21 18:50:39] [config] maxi-batch-sort: trg
[2023-07-21 18:50:39] [config] mini-batch: 64
[2023-07-21 18:50:39] [config] mini-batch-fit: true
[2023-07-21 18:50:39] [config] mini-batch-fit-step: 10
[2023-07-21 18:50:39] [config] mini-batch-round-up: true
[2023-07-21 18:50:39] [config] mini-batch-track-lr: false
[2023-07-21 18:50:39] [config] mini-batch-warmup: 0
[2023-07-21 18:50:39] [config] mini-batch-words: 0
[2023-07-21 18:50:39] [config] mini-batch-words-ref: 0
[2023-07-21 18:50:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 18:50:39] [config] multi-loss-type: sum
[2023-07-21 18:50:39] [config] n-best: false
[2023-07-21 18:50:39] [config] no-nccl: false
[2023-07-21 18:50:39] [config] no-reload: false
[2023-07-21 18:50:39] [config] no-restore-corpus: false
[2023-07-21 18:50:39] [config] normalize: 0
[2023-07-21 18:50:39] [config] normalize-gradient: false
[2023-07-21 18:50:39] [config] num-devices: 0
[2023-07-21 18:50:39] [config] optimizer: adam
[2023-07-21 18:50:39] [config] optimizer-delay: 1
[2023-07-21 18:50:39] [config] optimizer-params:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] output-omit-bias: false
[2023-07-21 18:50:39] [config] overwrite: true
[2023-07-21 18:50:39] [config] precision:
[2023-07-21 18:50:39] [config]   - float16
[2023-07-21 18:50:39] [config]   - float32
[2023-07-21 18:50:39] [config] pretrained-model: ""
[2023-07-21 18:50:39] [config] quantize-biases: false
[2023-07-21 18:50:39] [config] quantize-bits: 0
[2023-07-21 18:50:39] [config] quantize-log-based: false
[2023-07-21 18:50:39] [config] quantize-optimization-steps: 0
[2023-07-21 18:50:39] [config] quiet: false
[2023-07-21 18:50:39] [config] quiet-translation: true
[2023-07-21 18:50:39] [config] relative-paths: false
[2023-07-21 18:50:39] [config] right-left: false
[2023-07-21 18:50:39] [config] save-freq: 10000u
[2023-07-21 18:50:39] [config] seed: 1234
[2023-07-21 18:50:39] [config] sentencepiece-alphas:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] sentencepiece-max-lines: 2000000
[2023-07-21 18:50:39] [config] sentencepiece-options: ""
[2023-07-21 18:50:39] [config] sharding: global
[2023-07-21 18:50:39] [config] shuffle: data
[2023-07-21 18:50:39] [config] shuffle-in-ram: false
[2023-07-21 18:50:39] [config] sigterm: save-and-exit
[2023-07-21 18:50:39] [config] skip: false
[2023-07-21 18:50:39] [config] sqlite: ""
[2023-07-21 18:50:39] [config] sqlite-drop: false
[2023-07-21 18:50:39] [config] sync-freq: 200u
[2023-07-21 18:50:39] [config] sync-sgd: false
[2023-07-21 18:50:39] [config] tempdir: /tmp
[2023-07-21 18:50:39] [config] tied-embeddings: false
[2023-07-21 18:50:39] [config] tied-embeddings-all: true
[2023-07-21 18:50:39] [config] tied-embeddings-src: false
[2023-07-21 18:50:39] [config] train-embedder-rank:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] train-sets:
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 18:50:39] [config] transformer-aan-activation: swish
[2023-07-21 18:50:39] [config] transformer-aan-depth: 2
[2023-07-21 18:50:39] [config] transformer-aan-nogate: false
[2023-07-21 18:50:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 18:50:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 18:50:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 18:50:39] [config] transformer-depth-scaling: false
[2023-07-21 18:50:39] [config] transformer-dim-aan: 2048
[2023-07-21 18:50:39] [config] transformer-dim-ffn: 2048
[2023-07-21 18:50:39] [config] transformer-dropout: 0
[2023-07-21 18:50:39] [config] transformer-dropout-attention: 0
[2023-07-21 18:50:39] [config] transformer-dropout-ffn: 0
[2023-07-21 18:50:39] [config] transformer-ffn-activation: swish
[2023-07-21 18:50:39] [config] transformer-ffn-depth: 2
[2023-07-21 18:50:39] [config] transformer-guided-alignment-layer: last
[2023-07-21 18:50:39] [config] transformer-heads: 8
[2023-07-21 18:50:39] [config] transformer-no-projection: false
[2023-07-21 18:50:39] [config] transformer-pool: false
[2023-07-21 18:50:39] [config] transformer-postprocess: dan
[2023-07-21 18:50:39] [config] transformer-postprocess-emb: d
[2023-07-21 18:50:39] [config] transformer-postprocess-top: ""
[2023-07-21 18:50:39] [config] transformer-preprocess: ""
[2023-07-21 18:50:39] [config] transformer-tied-layers:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] transformer-train-position-embeddings: false
[2023-07-21 18:50:39] [config] tsv: false
[2023-07-21 18:50:39] [config] tsv-fields: 0
[2023-07-21 18:50:39] [config] type: amun
[2023-07-21 18:50:39] [config] ulr: false
[2023-07-21 18:50:39] [config] ulr-dim-emb: 0
[2023-07-21 18:50:39] [config] ulr-dropout: 0
[2023-07-21 18:50:39] [config] ulr-keys-vectors: ""
[2023-07-21 18:50:39] [config] ulr-query-vectors: ""
[2023-07-21 18:50:39] [config] ulr-softmax-temperature: 1
[2023-07-21 18:50:39] [config] ulr-trainable-transformation: false
[2023-07-21 18:50:39] [config] unlikelihood-loss: false
[2023-07-21 18:50:39] [config] valid-freq: 50000000
[2023-07-21 18:50:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 18:50:39] [config] valid-max-length: 1000
[2023-07-21 18:50:39] [config] valid-metrics:
[2023-07-21 18:50:39] [config]   - cross-entropy
[2023-07-21 18:50:39] [config]   - translation
[2023-07-21 18:50:39] [config] valid-mini-batch: 32
[2023-07-21 18:50:39] [config] valid-reset-stalled: false
[2023-07-21 18:50:39] [config] valid-script-args:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] valid-script-path: ""
[2023-07-21 18:50:39] [config] valid-sets:
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 18:50:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 18:50:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:50:39] [config] vocabs:
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:50:39] [config] word-penalty: 0
[2023-07-21 18:50:39] [config] word-scores: false
[2023-07-21 18:50:39] [config] workspace: 5500
[2023-07-21 18:50:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:50:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:50:39] [training] Using single-device training
[2023-07-21 18:50:40] Synced seed 1234
[2023-07-21 18:50:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:50:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 18:50:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:50:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 18:50:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 18:50:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:50:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 18:50:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:50:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:50:42] [comm] Using global sharding
[2023-07-21 18:50:42] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:50:42] [training] Using 1 GPUs
[2023-07-21 18:50:42] [logits] Applying loss function for 1 factor(s)
[2023-07-21 18:50:42] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:50:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 18:50:42] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:42:18] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 19:42:18] [valid] No post-processing script given for validating translator
[2023-07-21 19:42:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:42:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 19:42:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 19:42:18] [comm] Using global sharding
[2023-07-21 19:42:18] [comm] NCCLCommunicators constructed successfully
[2023-07-21 19:42:18] [training] Using 1 GPUs
[2023-07-21 19:42:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 19:42:26] Allocating memory for general optimizer shards
[2023-07-21 19:42:26] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:42:26] Loading Adam parameters
[2023-07-21 19:42:26] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:42:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:42:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 19:42:27] [data] Restoring the corpus state to epoch 191, batch 7363
[2023-07-21 19:42:27] [data] Shuffling data
[2023-07-21 19:42:27] [data] Done reading 20,192 sentences
[2023-07-21 19:42:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:42:27] Training started
[2023-07-21 19:42:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 19:42:27] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:42:30] Parameter type float16, optimization type float32, casting types true
[2023-07-21 19:46:44] Seen 20,192 samples
[2023-07-21 19:46:44] Starting data epoch 192 in logical epoch 192
[2023-07-21 19:46:44] [data] Shuffling data
[2023-07-21 19:46:44] [data] Done reading 20,192 sentences
[2023-07-21 19:46:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:51:29] Seen 20,192 samples
[2023-07-21 19:51:29] Starting data epoch 193 in logical epoch 193
[2023-07-21 19:51:29] [data] Shuffling data
[2023-07-21 19:51:29] [data] Done reading 20,192 sentences
[2023-07-21 19:51:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:56:26] Seen 20,192 samples
[2023-07-21 19:56:26] Starting data epoch 194 in logical epoch 194
[2023-07-21 19:56:26] [data] Shuffling data
[2023-07-21 19:56:26] [data] Done reading 20,192 sentences
[2023-07-21 19:56:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:01:10] Seen 20,192 samples
[2023-07-21 20:01:10] Starting data epoch 195 in logical epoch 195
[2023-07-21 20:01:10] [data] Shuffling data
[2023-07-21 20:01:10] [data] Done reading 20,192 sentences
[2023-07-21 20:01:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:05:50] Seen 20,192 samples
[2023-07-21 20:05:50] Starting data epoch 196 in logical epoch 196
[2023-07-21 20:05:50] [data] Shuffling data
[2023-07-21 20:05:50] [data] Done reading 20,192 sentences
[2023-07-21 20:05:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:10:30] Seen 20,192 samples
[2023-07-21 20:10:30] Starting data epoch 197 in logical epoch 197
[2023-07-21 20:10:30] [data] Shuffling data
[2023-07-21 20:10:31] [data] Done reading 20,192 sentences
[2023-07-21 20:10:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:15:27] Seen 20,192 samples
[2023-07-21 20:15:27] Starting data epoch 198 in logical epoch 198
[2023-07-21 20:15:27] [data] Shuffling data
[2023-07-21 20:15:27] [data] Done reading 20,192 sentences
[2023-07-21 20:15:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:20:13] Seen 20,192 samples
[2023-07-21 20:20:13] Starting data epoch 199 in logical epoch 199
[2023-07-21 20:20:13] [data] Shuffling data
[2023-07-21 20:20:13] [data] Done reading 20,192 sentences
[2023-07-21 20:20:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:24:55] Seen 20,192 samples
[2023-07-21 20:24:55] Starting data epoch 200 in logical epoch 200
[2023-07-21 20:24:55] [data] Shuffling data
[2023-07-21 20:24:55] [data] Done reading 20,192 sentences
[2023-07-21 20:24:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:29:46] Seen 20,192 samples
[2023-07-21 20:29:46] Starting data epoch 201 in logical epoch 201
[2023-07-21 20:29:46] Training finished
[2023-07-21 20:30:02] [valid] Ep. 201 : Up. 7750 : cross-entropy : 136.262 : stalled 6 times (last best: 130.991)
[2023-07-21 20:32:27] [valid] Ep. 201 : Up. 7750 : translation : 0 : new best
[2023-07-21 20:32:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 20:32:29] Saving Adam parameters
[2023-07-21 20:32:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 20:32:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:32:37] [marian] Running on node18.datos.cluster.uy as process 10871 with command line:
[2023-07-21 20:32:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-21 20:32:37] [config] after: 0e
[2023-07-21 20:32:37] [config] after-batches: 0
[2023-07-21 20:32:37] [config] after-epochs: 10
[2023-07-21 20:32:37] [config] all-caps-every: 0
[2023-07-21 20:32:37] [config] allow-unk: false
[2023-07-21 20:32:37] [config] authors: false
[2023-07-21 20:32:37] [config] beam-size: 12
[2023-07-21 20:32:37] [config] bert-class-symbol: "[CLS]"
[2023-07-21 20:32:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 20:32:37] [config] bert-masking-fraction: 0.15
[2023-07-21 20:32:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 20:32:37] [config] bert-train-type-embeddings: true
[2023-07-21 20:32:37] [config] bert-type-vocab-size: 2
[2023-07-21 20:32:37] [config] build-info: ""
[2023-07-21 20:32:37] [config] check-gradient-nan: false
[2023-07-21 20:32:37] [config] check-nan: false
[2023-07-21 20:32:37] [config] cite: false
[2023-07-21 20:32:37] [config] clip-norm: 1
[2023-07-21 20:32:37] [config] cost-scaling:
[2023-07-21 20:32:37] [config]   - 256.f
[2023-07-21 20:32:37] [config]   - 1000
[2023-07-21 20:32:37] [config]   - 2.f
[2023-07-21 20:32:37] [config]   - 256.f
[2023-07-21 20:32:37] [config] cost-type: ce-sum
[2023-07-21 20:32:37] [config] cpu-threads: 0
[2023-07-21 20:32:37] [config] data-threads: 8
[2023-07-21 20:32:37] [config] data-weighting: ""
[2023-07-21 20:32:37] [config] data-weighting-type: sentence
[2023-07-21 20:32:37] [config] dec-cell: gru
[2023-07-21 20:32:37] [config] dec-cell-base-depth: 2
[2023-07-21 20:32:37] [config] dec-cell-high-depth: 1
[2023-07-21 20:32:37] [config] dec-depth: 1
[2023-07-21 20:32:37] [config] devices:
[2023-07-21 20:32:37] [config]   - 0
[2023-07-21 20:32:37] [config] dim-emb: 512
[2023-07-21 20:32:37] [config] dim-rnn: 1024
[2023-07-21 20:32:37] [config] dim-vocabs:
[2023-07-21 20:32:37] [config]   - 16384
[2023-07-21 20:32:37] [config]   - 16384
[2023-07-21 20:32:37] [config] disp-first: 0
[2023-07-21 20:32:37] [config] disp-freq: 1000u
[2023-07-21 20:32:37] [config] disp-label-counts: true
[2023-07-21 20:32:37] [config] dropout-rnn: 0
[2023-07-21 20:32:37] [config] dropout-src: 0
[2023-07-21 20:32:37] [config] dropout-trg: 0
[2023-07-21 20:32:37] [config] dump-config: ""
[2023-07-21 20:32:37] [config] dynamic-gradient-scaling:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] early-stopping: 200
[2023-07-21 20:32:37] [config] early-stopping-on: first
[2023-07-21 20:32:37] [config] embedding-fix-src: false
[2023-07-21 20:32:37] [config] embedding-fix-trg: false
[2023-07-21 20:32:37] [config] embedding-normalization: false
[2023-07-21 20:32:37] [config] embedding-vectors:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] enc-cell: gru
[2023-07-21 20:32:37] [config] enc-cell-depth: 1
[2023-07-21 20:32:37] [config] enc-depth: 1
[2023-07-21 20:32:37] [config] enc-type: bidirectional
[2023-07-21 20:32:37] [config] english-title-case-every: 0
[2023-07-21 20:32:37] [config] exponential-smoothing: 0
[2023-07-21 20:32:37] [config] factor-weight: 1
[2023-07-21 20:32:37] [config] factors-combine: sum
[2023-07-21 20:32:37] [config] factors-dim-emb: 0
[2023-07-21 20:32:37] [config] gradient-checkpointing: false
[2023-07-21 20:32:37] [config] gradient-norm-average-window: 100
[2023-07-21 20:32:37] [config] guided-alignment: none
[2023-07-21 20:32:37] [config] guided-alignment-cost: mse
[2023-07-21 20:32:37] [config] guided-alignment-weight: 0.1
[2023-07-21 20:32:37] [config] ignore-model-config: false
[2023-07-21 20:32:37] [config] input-types:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] interpolate-env-vars: false
[2023-07-21 20:32:37] [config] keep-best: false
[2023-07-21 20:32:37] [config] label-smoothing: 0
[2023-07-21 20:32:37] [config] layer-normalization: false
[2023-07-21 20:32:37] [config] learn-rate: 0.0001
[2023-07-21 20:32:37] [config] lemma-dependency: ""
[2023-07-21 20:32:37] [config] lemma-dim-emb: 0
[2023-07-21 20:32:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 20:32:37] [config] log-level: info
[2023-07-21 20:32:37] [config] log-time-zone: ""
[2023-07-21 20:32:37] [config] logical-epoch:
[2023-07-21 20:32:37] [config]   - 1e
[2023-07-21 20:32:37] [config]   - 0
[2023-07-21 20:32:37] [config] lr-decay: 0
[2023-07-21 20:32:37] [config] lr-decay-freq: 50000
[2023-07-21 20:32:37] [config] lr-decay-inv-sqrt:
[2023-07-21 20:32:37] [config]   - 0
[2023-07-21 20:32:37] [config] lr-decay-repeat-warmup: false
[2023-07-21 20:32:37] [config] lr-decay-reset-optimizer: false
[2023-07-21 20:32:37] [config] lr-decay-start:
[2023-07-21 20:32:37] [config]   - 10
[2023-07-21 20:32:37] [config]   - 1
[2023-07-21 20:32:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 20:32:37] [config] lr-report: false
[2023-07-21 20:32:37] [config] lr-warmup: 0
[2023-07-21 20:32:37] [config] lr-warmup-at-reload: false
[2023-07-21 20:32:37] [config] lr-warmup-cycle: false
[2023-07-21 20:32:37] [config] lr-warmup-start-rate: 0
[2023-07-21 20:32:37] [config] max-length: 300
[2023-07-21 20:32:37] [config] max-length-crop: true
[2023-07-21 20:32:37] [config] max-length-factor: 3
[2023-07-21 20:32:37] [config] maxi-batch: 100
[2023-07-21 20:32:37] [config] maxi-batch-sort: trg
[2023-07-21 20:32:37] [config] mini-batch: 64
[2023-07-21 20:32:37] [config] mini-batch-fit: true
[2023-07-21 20:32:37] [config] mini-batch-fit-step: 10
[2023-07-21 20:32:37] [config] mini-batch-round-up: true
[2023-07-21 20:32:37] [config] mini-batch-track-lr: false
[2023-07-21 20:32:37] [config] mini-batch-warmup: 0
[2023-07-21 20:32:37] [config] mini-batch-words: 0
[2023-07-21 20:32:37] [config] mini-batch-words-ref: 0
[2023-07-21 20:32:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 20:32:37] [config] multi-loss-type: sum
[2023-07-21 20:32:37] [config] n-best: false
[2023-07-21 20:32:37] [config] no-nccl: false
[2023-07-21 20:32:37] [config] no-reload: false
[2023-07-21 20:32:37] [config] no-restore-corpus: false
[2023-07-21 20:32:37] [config] normalize: 0
[2023-07-21 20:32:37] [config] normalize-gradient: false
[2023-07-21 20:32:37] [config] num-devices: 0
[2023-07-21 20:32:37] [config] optimizer: adam
[2023-07-21 20:32:37] [config] optimizer-delay: 1
[2023-07-21 20:32:37] [config] optimizer-params:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] output-omit-bias: false
[2023-07-21 20:32:37] [config] overwrite: true
[2023-07-21 20:32:37] [config] precision:
[2023-07-21 20:32:37] [config]   - float16
[2023-07-21 20:32:37] [config]   - float32
[2023-07-21 20:32:37] [config] pretrained-model: ""
[2023-07-21 20:32:37] [config] quantize-biases: false
[2023-07-21 20:32:37] [config] quantize-bits: 0
[2023-07-21 20:32:37] [config] quantize-log-based: false
[2023-07-21 20:32:37] [config] quantize-optimization-steps: 0
[2023-07-21 20:32:37] [config] quiet: false
[2023-07-21 20:32:37] [config] quiet-translation: true
[2023-07-21 20:32:37] [config] relative-paths: false
[2023-07-21 20:32:37] [config] right-left: false
[2023-07-21 20:32:37] [config] save-freq: 10000u
[2023-07-21 20:32:37] [config] seed: 1234
[2023-07-21 20:32:37] [config] sentencepiece-alphas:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] sentencepiece-max-lines: 2000000
[2023-07-21 20:32:37] [config] sentencepiece-options: ""
[2023-07-21 20:32:37] [config] sharding: global
[2023-07-21 20:32:37] [config] shuffle: data
[2023-07-21 20:32:37] [config] shuffle-in-ram: false
[2023-07-21 20:32:37] [config] sigterm: save-and-exit
[2023-07-21 20:32:37] [config] skip: false
[2023-07-21 20:32:37] [config] sqlite: ""
[2023-07-21 20:32:37] [config] sqlite-drop: false
[2023-07-21 20:32:37] [config] sync-freq: 200u
[2023-07-21 20:32:37] [config] sync-sgd: false
[2023-07-21 20:32:37] [config] tempdir: /tmp
[2023-07-21 20:32:37] [config] tied-embeddings: false
[2023-07-21 20:32:37] [config] tied-embeddings-all: true
[2023-07-21 20:32:37] [config] tied-embeddings-src: false
[2023-07-21 20:32:37] [config] train-embedder-rank:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] train-sets:
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 20:32:37] [config] transformer-aan-activation: swish
[2023-07-21 20:32:37] [config] transformer-aan-depth: 2
[2023-07-21 20:32:37] [config] transformer-aan-nogate: false
[2023-07-21 20:32:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 20:32:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 20:32:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 20:32:37] [config] transformer-depth-scaling: false
[2023-07-21 20:32:37] [config] transformer-dim-aan: 2048
[2023-07-21 20:32:37] [config] transformer-dim-ffn: 2048
[2023-07-21 20:32:37] [config] transformer-dropout: 0
[2023-07-21 20:32:37] [config] transformer-dropout-attention: 0
[2023-07-21 20:32:37] [config] transformer-dropout-ffn: 0
[2023-07-21 20:32:37] [config] transformer-ffn-activation: swish
[2023-07-21 20:32:37] [config] transformer-ffn-depth: 2
[2023-07-21 20:32:37] [config] transformer-guided-alignment-layer: last
[2023-07-21 20:32:37] [config] transformer-heads: 8
[2023-07-21 20:32:37] [config] transformer-no-projection: false
[2023-07-21 20:32:37] [config] transformer-pool: false
[2023-07-21 20:32:37] [config] transformer-postprocess: dan
[2023-07-21 20:32:37] [config] transformer-postprocess-emb: d
[2023-07-21 20:32:37] [config] transformer-postprocess-top: ""
[2023-07-21 20:32:37] [config] transformer-preprocess: ""
[2023-07-21 20:32:37] [config] transformer-tied-layers:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] transformer-train-position-embeddings: false
[2023-07-21 20:32:37] [config] tsv: false
[2023-07-21 20:32:37] [config] tsv-fields: 0
[2023-07-21 20:32:37] [config] type: amun
[2023-07-21 20:32:37] [config] ulr: false
[2023-07-21 20:32:37] [config] ulr-dim-emb: 0
[2023-07-21 20:32:37] [config] ulr-dropout: 0
[2023-07-21 20:32:37] [config] ulr-keys-vectors: ""
[2023-07-21 20:32:37] [config] ulr-query-vectors: ""
[2023-07-21 20:32:37] [config] ulr-softmax-temperature: 1
[2023-07-21 20:32:37] [config] ulr-trainable-transformation: false
[2023-07-21 20:32:37] [config] unlikelihood-loss: false
[2023-07-21 20:32:37] [config] valid-freq: 50000000
[2023-07-21 20:32:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 20:32:37] [config] valid-max-length: 1000
[2023-07-21 20:32:37] [config] valid-metrics:
[2023-07-21 20:32:37] [config]   - cross-entropy
[2023-07-21 20:32:37] [config]   - translation
[2023-07-21 20:32:37] [config] valid-mini-batch: 32
[2023-07-21 20:32:37] [config] valid-reset-stalled: false
[2023-07-21 20:32:37] [config] valid-script-args:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] valid-script-path: ""
[2023-07-21 20:32:37] [config] valid-sets:
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 20:32:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 20:32:37] [config] vocabs:
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:32:37] [config] word-penalty: 0
[2023-07-21 20:32:37] [config] word-scores: false
[2023-07-21 20:32:37] [config] workspace: 5500
[2023-07-21 20:32:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:32:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:32:37] [training] Using single-device training
[2023-07-21 20:32:38] Synced seed 1234
[2023-07-21 20:32:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:32:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 20:32:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:32:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 20:32:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 20:32:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:32:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 20:32:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 20:32:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 20:32:39] [comm] Using global sharding
[2023-07-21 20:32:39] [comm] NCCLCommunicators constructed successfully
[2023-07-21 20:32:39] [training] Using 1 GPUs
[2023-07-21 20:32:39] [logits] Applying loss function for 1 factor(s)
[2023-07-21 20:32:39] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:32:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 20:32:40] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:36:23] [batching] Done. Typical MB size is 35,811 target words
[2023-07-21 21:36:23] [valid] No post-processing script given for validating translator
[2023-07-21 21:36:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:36:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 21:36:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 21:36:23] [comm] Using global sharding
[2023-07-21 21:36:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 21:36:23] [training] Using 1 GPUs
[2023-07-21 21:36:23] Training started
[2023-07-21 21:36:23] [data] Shuffling data
[2023-07-21 21:36:23] [data] Done reading 20,192 sentences
[2023-07-21 21:36:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:36:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 21:36:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:36:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:36:34] Parameter type float16, optimization type float32, casting types true
[2023-07-21 21:36:34] Allocating memory for general optimizer shards
[2023-07-21 21:36:34] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:36:34] Allocating memory for Adam-specific shards
[2023-07-21 21:36:34] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:40:33] Seen 20,192 samples
[2023-07-21 21:40:33] Starting data epoch 2 in logical epoch 2
[2023-07-21 21:40:33] [data] Shuffling data
[2023-07-21 21:40:34] [data] Done reading 20,192 sentences
[2023-07-21 21:40:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:46:10] Seen 20,192 samples
[2023-07-21 21:46:10] Starting data epoch 3 in logical epoch 3
[2023-07-21 21:46:10] [data] Shuffling data
[2023-07-21 21:46:10] [data] Done reading 20,192 sentences
[2023-07-21 21:46:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:51:25] Seen 20,192 samples
[2023-07-21 21:51:25] Starting data epoch 4 in logical epoch 4
[2023-07-21 21:51:25] [data] Shuffling data
[2023-07-21 21:51:25] [data] Done reading 20,192 sentences
[2023-07-21 21:51:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:56:22] Seen 20,192 samples
[2023-07-21 21:56:22] Starting data epoch 5 in logical epoch 5
[2023-07-21 21:56:22] [data] Shuffling data
[2023-07-21 21:56:22] [data] Done reading 20,192 sentences
[2023-07-21 21:56:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:01:08] Seen 20,192 samples
[2023-07-21 22:01:08] Starting data epoch 6 in logical epoch 6
[2023-07-21 22:01:08] [data] Shuffling data
[2023-07-21 22:01:08] [data] Done reading 20,192 sentences
[2023-07-21 22:01:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:06:10] Seen 20,192 samples
[2023-07-21 22:06:10] Starting data epoch 7 in logical epoch 7
[2023-07-21 22:06:10] [data] Shuffling data
[2023-07-21 22:06:10] [data] Done reading 20,192 sentences
[2023-07-21 22:06:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:11:22] Seen 20,192 samples
[2023-07-21 22:11:22] Starting data epoch 8 in logical epoch 8
[2023-07-21 22:11:22] [data] Shuffling data
[2023-07-21 22:11:22] [data] Done reading 20,192 sentences
[2023-07-21 22:11:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:16:46] Seen 20,192 samples
[2023-07-21 22:16:46] Starting data epoch 9 in logical epoch 9
[2023-07-21 22:16:46] [data] Shuffling data
[2023-07-21 22:16:46] [data] Done reading 20,192 sentences
[2023-07-21 22:16:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:21:32] Seen 20,192 samples
[2023-07-21 22:21:32] Starting data epoch 10 in logical epoch 10
[2023-07-21 22:21:32] [data] Shuffling data
[2023-07-21 22:21:32] [data] Done reading 20,192 sentences
[2023-07-21 22:21:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:26:38] Seen 20,192 samples
[2023-07-21 22:26:38] Starting data epoch 11 in logical epoch 11
[2023-07-21 22:26:38] Training finished
[2023-07-21 22:26:55] [valid] Ep. 11 : Up. 389 : cross-entropy : 186.711 : new best
[2023-07-21 22:30:12] [valid] Ep. 11 : Up. 389 : translation : 0 : new best
[2023-07-21 22:30:12] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 22:30:14] Saving Adam parameters
[2023-07-21 22:30:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-21 22:30:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:30:21] [marian] Running on node18.datos.cluster.uy as process 18540 with command line:
[2023-07-21 22:30:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-21 22:30:21] [config] after: 0e
[2023-07-21 22:30:21] [config] after-batches: 0
[2023-07-21 22:30:21] [config] after-epochs: 20
[2023-07-21 22:30:21] [config] all-caps-every: 0
[2023-07-21 22:30:21] [config] allow-unk: false
[2023-07-21 22:30:21] [config] authors: false
[2023-07-21 22:30:21] [config] beam-size: 12
[2023-07-21 22:30:21] [config] bert-class-symbol: "[CLS]"
[2023-07-21 22:30:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 22:30:21] [config] bert-masking-fraction: 0.15
[2023-07-21 22:30:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 22:30:21] [config] bert-train-type-embeddings: true
[2023-07-21 22:30:21] [config] bert-type-vocab-size: 2
[2023-07-21 22:30:21] [config] build-info: ""
[2023-07-21 22:30:21] [config] check-gradient-nan: false
[2023-07-21 22:30:21] [config] check-nan: false
[2023-07-21 22:30:21] [config] cite: false
[2023-07-21 22:30:21] [config] clip-norm: 1
[2023-07-21 22:30:21] [config] cost-scaling:
[2023-07-21 22:30:21] [config]   - 256.f
[2023-07-21 22:30:21] [config]   - 1000
[2023-07-21 22:30:21] [config]   - 2.f
[2023-07-21 22:30:21] [config]   - 256.f
[2023-07-21 22:30:21] [config] cost-type: ce-sum
[2023-07-21 22:30:21] [config] cpu-threads: 0
[2023-07-21 22:30:21] [config] data-threads: 8
[2023-07-21 22:30:21] [config] data-weighting: ""
[2023-07-21 22:30:21] [config] data-weighting-type: sentence
[2023-07-21 22:30:21] [config] dec-cell: gru
[2023-07-21 22:30:21] [config] dec-cell-base-depth: 2
[2023-07-21 22:30:21] [config] dec-cell-high-depth: 1
[2023-07-21 22:30:21] [config] dec-depth: 1
[2023-07-21 22:30:21] [config] devices:
[2023-07-21 22:30:21] [config]   - 0
[2023-07-21 22:30:21] [config] dim-emb: 512
[2023-07-21 22:30:21] [config] dim-rnn: 1024
[2023-07-21 22:30:21] [config] dim-vocabs:
[2023-07-21 22:30:21] [config]   - 16384
[2023-07-21 22:30:21] [config]   - 16384
[2023-07-21 22:30:21] [config] disp-first: 0
[2023-07-21 22:30:21] [config] disp-freq: 1000u
[2023-07-21 22:30:21] [config] disp-label-counts: true
[2023-07-21 22:30:21] [config] dropout-rnn: 0
[2023-07-21 22:30:21] [config] dropout-src: 0
[2023-07-21 22:30:21] [config] dropout-trg: 0
[2023-07-21 22:30:21] [config] dump-config: ""
[2023-07-21 22:30:21] [config] dynamic-gradient-scaling:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] early-stopping: 200
[2023-07-21 22:30:21] [config] early-stopping-on: first
[2023-07-21 22:30:21] [config] embedding-fix-src: false
[2023-07-21 22:30:21] [config] embedding-fix-trg: false
[2023-07-21 22:30:21] [config] embedding-normalization: false
[2023-07-21 22:30:21] [config] embedding-vectors:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] enc-cell: gru
[2023-07-21 22:30:21] [config] enc-cell-depth: 1
[2023-07-21 22:30:21] [config] enc-depth: 1
[2023-07-21 22:30:21] [config] enc-type: bidirectional
[2023-07-21 22:30:21] [config] english-title-case-every: 0
[2023-07-21 22:30:21] [config] exponential-smoothing: 0
[2023-07-21 22:30:21] [config] factor-weight: 1
[2023-07-21 22:30:21] [config] factors-combine: sum
[2023-07-21 22:30:21] [config] factors-dim-emb: 0
[2023-07-21 22:30:21] [config] gradient-checkpointing: false
[2023-07-21 22:30:21] [config] gradient-norm-average-window: 100
[2023-07-21 22:30:21] [config] guided-alignment: none
[2023-07-21 22:30:21] [config] guided-alignment-cost: mse
[2023-07-21 22:30:21] [config] guided-alignment-weight: 0.1
[2023-07-21 22:30:21] [config] ignore-model-config: false
[2023-07-21 22:30:21] [config] input-types:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] interpolate-env-vars: false
[2023-07-21 22:30:21] [config] keep-best: false
[2023-07-21 22:30:21] [config] label-smoothing: 0
[2023-07-21 22:30:21] [config] layer-normalization: false
[2023-07-21 22:30:21] [config] learn-rate: 0.0001
[2023-07-21 22:30:21] [config] lemma-dependency: ""
[2023-07-21 22:30:21] [config] lemma-dim-emb: 0
[2023-07-21 22:30:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 22:30:21] [config] log-level: info
[2023-07-21 22:30:21] [config] log-time-zone: ""
[2023-07-21 22:30:21] [config] logical-epoch:
[2023-07-21 22:30:21] [config]   - 1e
[2023-07-21 22:30:21] [config]   - 0
[2023-07-21 22:30:21] [config] lr-decay: 0
[2023-07-21 22:30:21] [config] lr-decay-freq: 50000
[2023-07-21 22:30:21] [config] lr-decay-inv-sqrt:
[2023-07-21 22:30:21] [config]   - 0
[2023-07-21 22:30:21] [config] lr-decay-repeat-warmup: false
[2023-07-21 22:30:21] [config] lr-decay-reset-optimizer: false
[2023-07-21 22:30:21] [config] lr-decay-start:
[2023-07-21 22:30:21] [config]   - 10
[2023-07-21 22:30:21] [config]   - 1
[2023-07-21 22:30:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 22:30:21] [config] lr-report: false
[2023-07-21 22:30:21] [config] lr-warmup: 0
[2023-07-21 22:30:21] [config] lr-warmup-at-reload: false
[2023-07-21 22:30:21] [config] lr-warmup-cycle: false
[2023-07-21 22:30:21] [config] lr-warmup-start-rate: 0
[2023-07-21 22:30:21] [config] max-length: 300
[2023-07-21 22:30:21] [config] max-length-crop: true
[2023-07-21 22:30:21] [config] max-length-factor: 3
[2023-07-21 22:30:21] [config] maxi-batch: 100
[2023-07-21 22:30:21] [config] maxi-batch-sort: trg
[2023-07-21 22:30:21] [config] mini-batch: 64
[2023-07-21 22:30:21] [config] mini-batch-fit: true
[2023-07-21 22:30:21] [config] mini-batch-fit-step: 10
[2023-07-21 22:30:21] [config] mini-batch-round-up: true
[2023-07-21 22:30:21] [config] mini-batch-track-lr: false
[2023-07-21 22:30:21] [config] mini-batch-warmup: 0
[2023-07-21 22:30:21] [config] mini-batch-words: 0
[2023-07-21 22:30:21] [config] mini-batch-words-ref: 0
[2023-07-21 22:30:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 22:30:21] [config] multi-loss-type: sum
[2023-07-21 22:30:21] [config] n-best: false
[2023-07-21 22:30:21] [config] no-nccl: false
[2023-07-21 22:30:21] [config] no-reload: false
[2023-07-21 22:30:21] [config] no-restore-corpus: false
[2023-07-21 22:30:21] [config] normalize: 0
[2023-07-21 22:30:21] [config] normalize-gradient: false
[2023-07-21 22:30:21] [config] num-devices: 0
[2023-07-21 22:30:21] [config] optimizer: adam
[2023-07-21 22:30:21] [config] optimizer-delay: 1
[2023-07-21 22:30:21] [config] optimizer-params:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] output-omit-bias: false
[2023-07-21 22:30:21] [config] overwrite: true
[2023-07-21 22:30:21] [config] precision:
[2023-07-21 22:30:21] [config]   - float16
[2023-07-21 22:30:21] [config]   - float32
[2023-07-21 22:30:21] [config] pretrained-model: ""
[2023-07-21 22:30:21] [config] quantize-biases: false
[2023-07-21 22:30:21] [config] quantize-bits: 0
[2023-07-21 22:30:21] [config] quantize-log-based: false
[2023-07-21 22:30:21] [config] quantize-optimization-steps: 0
[2023-07-21 22:30:21] [config] quiet: false
[2023-07-21 22:30:21] [config] quiet-translation: true
[2023-07-21 22:30:21] [config] relative-paths: false
[2023-07-21 22:30:21] [config] right-left: false
[2023-07-21 22:30:21] [config] save-freq: 10000u
[2023-07-21 22:30:21] [config] seed: 1234
[2023-07-21 22:30:21] [config] sentencepiece-alphas:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] sentencepiece-max-lines: 2000000
[2023-07-21 22:30:21] [config] sentencepiece-options: ""
[2023-07-21 22:30:21] [config] sharding: global
[2023-07-21 22:30:21] [config] shuffle: data
[2023-07-21 22:30:21] [config] shuffle-in-ram: false
[2023-07-21 22:30:21] [config] sigterm: save-and-exit
[2023-07-21 22:30:21] [config] skip: false
[2023-07-21 22:30:21] [config] sqlite: ""
[2023-07-21 22:30:21] [config] sqlite-drop: false
[2023-07-21 22:30:21] [config] sync-freq: 200u
[2023-07-21 22:30:21] [config] sync-sgd: false
[2023-07-21 22:30:21] [config] tempdir: /tmp
[2023-07-21 22:30:21] [config] tied-embeddings: false
[2023-07-21 22:30:21] [config] tied-embeddings-all: true
[2023-07-21 22:30:21] [config] tied-embeddings-src: false
[2023-07-21 22:30:21] [config] train-embedder-rank:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] train-sets:
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 22:30:21] [config] transformer-aan-activation: swish
[2023-07-21 22:30:21] [config] transformer-aan-depth: 2
[2023-07-21 22:30:21] [config] transformer-aan-nogate: false
[2023-07-21 22:30:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 22:30:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 22:30:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 22:30:21] [config] transformer-depth-scaling: false
[2023-07-21 22:30:21] [config] transformer-dim-aan: 2048
[2023-07-21 22:30:21] [config] transformer-dim-ffn: 2048
[2023-07-21 22:30:21] [config] transformer-dropout: 0
[2023-07-21 22:30:21] [config] transformer-dropout-attention: 0
[2023-07-21 22:30:21] [config] transformer-dropout-ffn: 0
[2023-07-21 22:30:21] [config] transformer-ffn-activation: swish
[2023-07-21 22:30:21] [config] transformer-ffn-depth: 2
[2023-07-21 22:30:21] [config] transformer-guided-alignment-layer: last
[2023-07-21 22:30:21] [config] transformer-heads: 8
[2023-07-21 22:30:21] [config] transformer-no-projection: false
[2023-07-21 22:30:21] [config] transformer-pool: false
[2023-07-21 22:30:21] [config] transformer-postprocess: dan
[2023-07-21 22:30:21] [config] transformer-postprocess-emb: d
[2023-07-21 22:30:21] [config] transformer-postprocess-top: ""
[2023-07-21 22:30:21] [config] transformer-preprocess: ""
[2023-07-21 22:30:21] [config] transformer-tied-layers:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] transformer-train-position-embeddings: false
[2023-07-21 22:30:21] [config] tsv: false
[2023-07-21 22:30:21] [config] tsv-fields: 0
[2023-07-21 22:30:21] [config] type: amun
[2023-07-21 22:30:21] [config] ulr: false
[2023-07-21 22:30:21] [config] ulr-dim-emb: 0
[2023-07-21 22:30:21] [config] ulr-dropout: 0
[2023-07-21 22:30:21] [config] ulr-keys-vectors: ""
[2023-07-21 22:30:21] [config] ulr-query-vectors: ""
[2023-07-21 22:30:21] [config] ulr-softmax-temperature: 1
[2023-07-21 22:30:21] [config] ulr-trainable-transformation: false
[2023-07-21 22:30:21] [config] unlikelihood-loss: false
[2023-07-21 22:30:21] [config] valid-freq: 50000000
[2023-07-21 22:30:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 22:30:21] [config] valid-max-length: 1000
[2023-07-21 22:30:21] [config] valid-metrics:
[2023-07-21 22:30:21] [config]   - cross-entropy
[2023-07-21 22:30:21] [config]   - translation
[2023-07-21 22:30:21] [config] valid-mini-batch: 32
[2023-07-21 22:30:21] [config] valid-reset-stalled: false
[2023-07-21 22:30:21] [config] valid-script-args:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] valid-script-path: ""
[2023-07-21 22:30:21] [config] valid-sets:
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 22:30:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 22:30:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:30:21] [config] vocabs:
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:30:21] [config] word-penalty: 0
[2023-07-21 22:30:21] [config] word-scores: false
[2023-07-21 22:30:21] [config] workspace: 5500
[2023-07-21 22:30:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:30:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:30:21] [training] Using single-device training
[2023-07-21 22:30:21] Synced seed 1234
[2023-07-21 22:30:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:30:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 22:30:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:30:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 22:30:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 22:30:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:30:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 22:30:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 22:30:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 22:30:23] [comm] Using global sharding
[2023-07-21 22:30:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 22:30:23] [training] Using 1 GPUs
[2023-07-21 22:30:23] [logits] Applying loss function for 1 factor(s)
[2023-07-21 22:30:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:30:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 22:30:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:34:25] [batching] Done. Typical MB size is 35,811 target words
[2023-07-21 23:34:25] [valid] No post-processing script given for validating translator
[2023-07-21 23:34:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:34:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 23:34:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 23:34:25] [comm] Using global sharding
[2023-07-21 23:34:25] [comm] NCCLCommunicators constructed successfully
[2023-07-21 23:34:25] [training] Using 1 GPUs
[2023-07-21 23:34:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 23:34:31] Allocating memory for general optimizer shards
[2023-07-21 23:34:31] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:34:31] Loading Adam parameters
[2023-07-21 23:34:31] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:34:31] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:34:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-21 23:34:31] [data] Restoring the corpus state to epoch 11, batch 389
[2023-07-21 23:34:31] [data] Shuffling data
[2023-07-21 23:34:31] [data] Done reading 20,192 sentences
[2023-07-21 23:34:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:34:31] Training started
[2023-07-21 23:34:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 23:34:32] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:34:36] Parameter type float16, optimization type float32, casting types true
[2023-07-21 23:39:05] Seen 20,192 samples
[2023-07-21 23:39:05] Starting data epoch 12 in logical epoch 12
[2023-07-21 23:39:05] [data] Shuffling data
[2023-07-21 23:39:05] [data] Done reading 20,192 sentences
[2023-07-21 23:39:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:44:20] Seen 20,192 samples
[2023-07-21 23:44:20] Starting data epoch 13 in logical epoch 13
[2023-07-21 23:44:20] [data] Shuffling data
[2023-07-21 23:44:20] [data] Done reading 20,192 sentences
[2023-07-21 23:44:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:49:15] Seen 20,192 samples
[2023-07-21 23:49:15] Starting data epoch 14 in logical epoch 14
[2023-07-21 23:49:15] [data] Shuffling data
[2023-07-21 23:49:15] [data] Done reading 20,192 sentences
[2023-07-21 23:49:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:54:22] Seen 20,192 samples
[2023-07-21 23:54:22] Starting data epoch 15 in logical epoch 15
[2023-07-21 23:54:22] [data] Shuffling data
[2023-07-21 23:54:22] [data] Done reading 20,192 sentences
[2023-07-21 23:54:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:59:31] Seen 20,192 samples
[2023-07-21 23:59:31] Starting data epoch 16 in logical epoch 16
[2023-07-21 23:59:31] [data] Shuffling data
[2023-07-21 23:59:31] [data] Done reading 20,192 sentences
[2023-07-21 23:59:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:04:43] Seen 20,192 samples
[2023-07-22 00:04:43] Starting data epoch 17 in logical epoch 17
[2023-07-22 00:04:43] [data] Shuffling data
[2023-07-22 00:04:43] [data] Done reading 20,192 sentences
[2023-07-22 00:04:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:10:01] Seen 20,192 samples
[2023-07-22 00:10:01] Starting data epoch 18 in logical epoch 18
[2023-07-22 00:10:01] [data] Shuffling data
[2023-07-22 00:10:01] [data] Done reading 20,192 sentences
[2023-07-22 00:10:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:15:20] Seen 20,192 samples
[2023-07-22 00:15:20] Starting data epoch 19 in logical epoch 19
[2023-07-22 00:15:20] [data] Shuffling data
[2023-07-22 00:15:20] [data] Done reading 20,192 sentences
[2023-07-22 00:15:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:20:34] Seen 20,192 samples
[2023-07-22 00:20:34] Starting data epoch 20 in logical epoch 20
[2023-07-22 00:20:34] [data] Shuffling data
[2023-07-22 00:20:34] [data] Done reading 20,192 sentences
[2023-07-22 00:20:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:25:45] Seen 20,192 samples
[2023-07-22 00:25:45] Starting data epoch 21 in logical epoch 21
[2023-07-22 00:25:45] Training finished
[2023-07-22 00:25:57] [valid] Ep. 21 : Up. 776 : cross-entropy : 173.424 : new best
[2023-07-22 00:30:29] [valid] Ep. 21 : Up. 776 : translation : 0 : new best
[2023-07-22 00:30:29] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 00:30:32] Saving Adam parameters
[2023-07-22 00:30:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 00:30:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:30:40] [marian] Running on node18.datos.cluster.uy as process 26358 with command line:
[2023-07-22 00:30:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 00:30:40] [config] after: 0e
[2023-07-22 00:30:40] [config] after-batches: 0
[2023-07-22 00:30:40] [config] after-epochs: 30
[2023-07-22 00:30:40] [config] all-caps-every: 0
[2023-07-22 00:30:40] [config] allow-unk: false
[2023-07-22 00:30:40] [config] authors: false
[2023-07-22 00:30:40] [config] beam-size: 12
[2023-07-22 00:30:40] [config] bert-class-symbol: "[CLS]"
[2023-07-22 00:30:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 00:30:40] [config] bert-masking-fraction: 0.15
[2023-07-22 00:30:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 00:30:40] [config] bert-train-type-embeddings: true
[2023-07-22 00:30:40] [config] bert-type-vocab-size: 2
[2023-07-22 00:30:40] [config] build-info: ""
[2023-07-22 00:30:40] [config] check-gradient-nan: false
[2023-07-22 00:30:40] [config] check-nan: false
[2023-07-22 00:30:40] [config] cite: false
[2023-07-22 00:30:40] [config] clip-norm: 1
[2023-07-22 00:30:40] [config] cost-scaling:
[2023-07-22 00:30:40] [config]   - 256.f
[2023-07-22 00:30:40] [config]   - 1000
[2023-07-22 00:30:40] [config]   - 2.f
[2023-07-22 00:30:40] [config]   - 256.f
[2023-07-22 00:30:40] [config] cost-type: ce-sum
[2023-07-22 00:30:40] [config] cpu-threads: 0
[2023-07-22 00:30:40] [config] data-threads: 8
[2023-07-22 00:30:40] [config] data-weighting: ""
[2023-07-22 00:30:40] [config] data-weighting-type: sentence
[2023-07-22 00:30:40] [config] dec-cell: gru
[2023-07-22 00:30:40] [config] dec-cell-base-depth: 2
[2023-07-22 00:30:40] [config] dec-cell-high-depth: 1
[2023-07-22 00:30:40] [config] dec-depth: 1
[2023-07-22 00:30:40] [config] devices:
[2023-07-22 00:30:40] [config]   - 0
[2023-07-22 00:30:40] [config] dim-emb: 512
[2023-07-22 00:30:40] [config] dim-rnn: 1024
[2023-07-22 00:30:40] [config] dim-vocabs:
[2023-07-22 00:30:40] [config]   - 16384
[2023-07-22 00:30:40] [config]   - 16384
[2023-07-22 00:30:40] [config] disp-first: 0
[2023-07-22 00:30:40] [config] disp-freq: 1000u
[2023-07-22 00:30:40] [config] disp-label-counts: true
[2023-07-22 00:30:40] [config] dropout-rnn: 0
[2023-07-22 00:30:40] [config] dropout-src: 0
[2023-07-22 00:30:40] [config] dropout-trg: 0
[2023-07-22 00:30:40] [config] dump-config: ""
[2023-07-22 00:30:40] [config] dynamic-gradient-scaling:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] early-stopping: 200
[2023-07-22 00:30:40] [config] early-stopping-on: first
[2023-07-22 00:30:40] [config] embedding-fix-src: false
[2023-07-22 00:30:40] [config] embedding-fix-trg: false
[2023-07-22 00:30:40] [config] embedding-normalization: false
[2023-07-22 00:30:40] [config] embedding-vectors:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] enc-cell: gru
[2023-07-22 00:30:40] [config] enc-cell-depth: 1
[2023-07-22 00:30:40] [config] enc-depth: 1
[2023-07-22 00:30:40] [config] enc-type: bidirectional
[2023-07-22 00:30:40] [config] english-title-case-every: 0
[2023-07-22 00:30:40] [config] exponential-smoothing: 0
[2023-07-22 00:30:40] [config] factor-weight: 1
[2023-07-22 00:30:40] [config] factors-combine: sum
[2023-07-22 00:30:40] [config] factors-dim-emb: 0
[2023-07-22 00:30:40] [config] gradient-checkpointing: false
[2023-07-22 00:30:40] [config] gradient-norm-average-window: 100
[2023-07-22 00:30:40] [config] guided-alignment: none
[2023-07-22 00:30:40] [config] guided-alignment-cost: mse
[2023-07-22 00:30:40] [config] guided-alignment-weight: 0.1
[2023-07-22 00:30:40] [config] ignore-model-config: false
[2023-07-22 00:30:40] [config] input-types:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] interpolate-env-vars: false
[2023-07-22 00:30:40] [config] keep-best: false
[2023-07-22 00:30:40] [config] label-smoothing: 0
[2023-07-22 00:30:40] [config] layer-normalization: false
[2023-07-22 00:30:40] [config] learn-rate: 0.0001
[2023-07-22 00:30:40] [config] lemma-dependency: ""
[2023-07-22 00:30:40] [config] lemma-dim-emb: 0
[2023-07-22 00:30:40] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 00:30:40] [config] log-level: info
[2023-07-22 00:30:40] [config] log-time-zone: ""
[2023-07-22 00:30:40] [config] logical-epoch:
[2023-07-22 00:30:40] [config]   - 1e
[2023-07-22 00:30:40] [config]   - 0
[2023-07-22 00:30:40] [config] lr-decay: 0
[2023-07-22 00:30:40] [config] lr-decay-freq: 50000
[2023-07-22 00:30:40] [config] lr-decay-inv-sqrt:
[2023-07-22 00:30:40] [config]   - 0
[2023-07-22 00:30:40] [config] lr-decay-repeat-warmup: false
[2023-07-22 00:30:40] [config] lr-decay-reset-optimizer: false
[2023-07-22 00:30:40] [config] lr-decay-start:
[2023-07-22 00:30:40] [config]   - 10
[2023-07-22 00:30:40] [config]   - 1
[2023-07-22 00:30:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 00:30:40] [config] lr-report: false
[2023-07-22 00:30:40] [config] lr-warmup: 0
[2023-07-22 00:30:40] [config] lr-warmup-at-reload: false
[2023-07-22 00:30:40] [config] lr-warmup-cycle: false
[2023-07-22 00:30:40] [config] lr-warmup-start-rate: 0
[2023-07-22 00:30:40] [config] max-length: 300
[2023-07-22 00:30:40] [config] max-length-crop: true
[2023-07-22 00:30:40] [config] max-length-factor: 3
[2023-07-22 00:30:40] [config] maxi-batch: 100
[2023-07-22 00:30:40] [config] maxi-batch-sort: trg
[2023-07-22 00:30:40] [config] mini-batch: 64
[2023-07-22 00:30:40] [config] mini-batch-fit: true
[2023-07-22 00:30:40] [config] mini-batch-fit-step: 10
[2023-07-22 00:30:40] [config] mini-batch-round-up: true
[2023-07-22 00:30:40] [config] mini-batch-track-lr: false
[2023-07-22 00:30:40] [config] mini-batch-warmup: 0
[2023-07-22 00:30:40] [config] mini-batch-words: 0
[2023-07-22 00:30:40] [config] mini-batch-words-ref: 0
[2023-07-22 00:30:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 00:30:40] [config] multi-loss-type: sum
[2023-07-22 00:30:40] [config] n-best: false
[2023-07-22 00:30:40] [config] no-nccl: false
[2023-07-22 00:30:40] [config] no-reload: false
[2023-07-22 00:30:40] [config] no-restore-corpus: false
[2023-07-22 00:30:40] [config] normalize: 0
[2023-07-22 00:30:40] [config] normalize-gradient: false
[2023-07-22 00:30:40] [config] num-devices: 0
[2023-07-22 00:30:40] [config] optimizer: adam
[2023-07-22 00:30:40] [config] optimizer-delay: 1
[2023-07-22 00:30:40] [config] optimizer-params:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] output-omit-bias: false
[2023-07-22 00:30:40] [config] overwrite: true
[2023-07-22 00:30:40] [config] precision:
[2023-07-22 00:30:40] [config]   - float16
[2023-07-22 00:30:40] [config]   - float32
[2023-07-22 00:30:40] [config] pretrained-model: ""
[2023-07-22 00:30:40] [config] quantize-biases: false
[2023-07-22 00:30:40] [config] quantize-bits: 0
[2023-07-22 00:30:40] [config] quantize-log-based: false
[2023-07-22 00:30:40] [config] quantize-optimization-steps: 0
[2023-07-22 00:30:40] [config] quiet: false
[2023-07-22 00:30:40] [config] quiet-translation: true
[2023-07-22 00:30:40] [config] relative-paths: false
[2023-07-22 00:30:40] [config] right-left: false
[2023-07-22 00:30:40] [config] save-freq: 10000u
[2023-07-22 00:30:40] [config] seed: 1234
[2023-07-22 00:30:40] [config] sentencepiece-alphas:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] sentencepiece-max-lines: 2000000
[2023-07-22 00:30:40] [config] sentencepiece-options: ""
[2023-07-22 00:30:40] [config] sharding: global
[2023-07-22 00:30:40] [config] shuffle: data
[2023-07-22 00:30:40] [config] shuffle-in-ram: false
[2023-07-22 00:30:40] [config] sigterm: save-and-exit
[2023-07-22 00:30:40] [config] skip: false
[2023-07-22 00:30:40] [config] sqlite: ""
[2023-07-22 00:30:40] [config] sqlite-drop: false
[2023-07-22 00:30:40] [config] sync-freq: 200u
[2023-07-22 00:30:40] [config] sync-sgd: false
[2023-07-22 00:30:40] [config] tempdir: /tmp
[2023-07-22 00:30:40] [config] tied-embeddings: false
[2023-07-22 00:30:40] [config] tied-embeddings-all: true
[2023-07-22 00:30:40] [config] tied-embeddings-src: false
[2023-07-22 00:30:40] [config] train-embedder-rank:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] train-sets:
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 00:30:40] [config] transformer-aan-activation: swish
[2023-07-22 00:30:40] [config] transformer-aan-depth: 2
[2023-07-22 00:30:40] [config] transformer-aan-nogate: false
[2023-07-22 00:30:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 00:30:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 00:30:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 00:30:40] [config] transformer-depth-scaling: false
[2023-07-22 00:30:40] [config] transformer-dim-aan: 2048
[2023-07-22 00:30:40] [config] transformer-dim-ffn: 2048
[2023-07-22 00:30:40] [config] transformer-dropout: 0
[2023-07-22 00:30:40] [config] transformer-dropout-attention: 0
[2023-07-22 00:30:40] [config] transformer-dropout-ffn: 0
[2023-07-22 00:30:40] [config] transformer-ffn-activation: swish
[2023-07-22 00:30:40] [config] transformer-ffn-depth: 2
[2023-07-22 00:30:40] [config] transformer-guided-alignment-layer: last
[2023-07-22 00:30:40] [config] transformer-heads: 8
[2023-07-22 00:30:40] [config] transformer-no-projection: false
[2023-07-22 00:30:40] [config] transformer-pool: false
[2023-07-22 00:30:40] [config] transformer-postprocess: dan
[2023-07-22 00:30:40] [config] transformer-postprocess-emb: d
[2023-07-22 00:30:40] [config] transformer-postprocess-top: ""
[2023-07-22 00:30:40] [config] transformer-preprocess: ""
[2023-07-22 00:30:40] [config] transformer-tied-layers:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] transformer-train-position-embeddings: false
[2023-07-22 00:30:40] [config] tsv: false
[2023-07-22 00:30:40] [config] tsv-fields: 0
[2023-07-22 00:30:40] [config] type: amun
[2023-07-22 00:30:40] [config] ulr: false
[2023-07-22 00:30:40] [config] ulr-dim-emb: 0
[2023-07-22 00:30:40] [config] ulr-dropout: 0
[2023-07-22 00:30:40] [config] ulr-keys-vectors: ""
[2023-07-22 00:30:40] [config] ulr-query-vectors: ""
[2023-07-22 00:30:40] [config] ulr-softmax-temperature: 1
[2023-07-22 00:30:40] [config] ulr-trainable-transformation: false
[2023-07-22 00:30:40] [config] unlikelihood-loss: false
[2023-07-22 00:30:40] [config] valid-freq: 50000000
[2023-07-22 00:30:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 00:30:40] [config] valid-max-length: 1000
[2023-07-22 00:30:40] [config] valid-metrics:
[2023-07-22 00:30:40] [config]   - cross-entropy
[2023-07-22 00:30:40] [config]   - translation
[2023-07-22 00:30:40] [config] valid-mini-batch: 32
[2023-07-22 00:30:40] [config] valid-reset-stalled: false
[2023-07-22 00:30:40] [config] valid-script-args:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] valid-script-path: ""
[2023-07-22 00:30:40] [config] valid-sets:
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 00:30:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 00:30:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:30:40] [config] vocabs:
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 00:30:40] [config] word-penalty: 0
[2023-07-22 00:30:40] [config] word-scores: false
[2023-07-22 00:30:40] [config] workspace: 5500
[2023-07-22 00:30:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:30:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:30:40] [training] Using single-device training
[2023-07-22 00:30:40] Synced seed 1234
[2023-07-22 00:30:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 00:30:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 00:30:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 00:30:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 00:30:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 00:30:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:30:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 00:30:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 00:30:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 00:30:42] [comm] Using global sharding
[2023-07-22 00:30:42] [comm] NCCLCommunicators constructed successfully
[2023-07-22 00:30:42] [training] Using 1 GPUs
[2023-07-22 00:30:42] [logits] Applying loss function for 1 factor(s)
[2023-07-22 00:30:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:30:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 00:30:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:00] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 01:34:00] [valid] No post-processing script given for validating translator
[2023-07-22 01:34:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:34:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 01:34:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 01:34:01] [comm] Using global sharding
[2023-07-22 01:34:01] [comm] NCCLCommunicators constructed successfully
[2023-07-22 01:34:01] [training] Using 1 GPUs
[2023-07-22 01:34:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 01:34:09] Allocating memory for general optimizer shards
[2023-07-22 01:34:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:34:09] Loading Adam parameters
[2023-07-22 01:34:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:34:09] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 01:34:09] [data] Restoring the corpus state to epoch 21, batch 776
[2023-07-22 01:34:09] [data] Shuffling data
[2023-07-22 01:34:09] [data] Done reading 20,192 sentences
[2023-07-22 01:34:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:34:09] Training started
[2023-07-22 01:34:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 01:34:10] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:19] Parameter type float16, optimization type float32, casting types true
[2023-07-22 01:39:08] Seen 20,192 samples
[2023-07-22 01:39:08] Starting data epoch 22 in logical epoch 22
[2023-07-22 01:39:08] [data] Shuffling data
[2023-07-22 01:39:08] [data] Done reading 20,192 sentences
[2023-07-22 01:39:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:44:27] Seen 20,192 samples
[2023-07-22 01:44:27] Starting data epoch 23 in logical epoch 23
[2023-07-22 01:44:27] [data] Shuffling data
[2023-07-22 01:44:27] [data] Done reading 20,192 sentences
[2023-07-22 01:44:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:50:02] Seen 20,192 samples
[2023-07-22 01:50:02] Starting data epoch 24 in logical epoch 24
[2023-07-22 01:50:02] [data] Shuffling data
[2023-07-22 01:50:02] [data] Done reading 20,192 sentences
[2023-07-22 01:50:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:55:24] Seen 20,192 samples
[2023-07-22 01:55:24] Starting data epoch 25 in logical epoch 25
[2023-07-22 01:55:24] [data] Shuffling data
[2023-07-22 01:55:24] [data] Done reading 20,192 sentences
[2023-07-22 01:55:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:00:44] Seen 20,192 samples
[2023-07-22 02:00:44] Starting data epoch 26 in logical epoch 26
[2023-07-22 02:00:44] [data] Shuffling data
[2023-07-22 02:00:44] [data] Done reading 20,192 sentences
[2023-07-22 02:00:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:04:28] Ep. 26 : Up. 1000 : Sen. 13,971 : Cost 6.31807470 * 15,941,837 @ 17,481 after 15,941,837 : Time 1828.31s : 8719.42 words/s : gNorm 1.0954
[2023-07-22 02:06:23] Seen 20,192 samples
[2023-07-22 02:06:23] Starting data epoch 27 in logical epoch 27
[2023-07-22 02:06:23] [data] Shuffling data
[2023-07-22 02:06:23] [data] Done reading 20,192 sentences
[2023-07-22 02:06:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:11:51] Seen 20,192 samples
[2023-07-22 02:11:51] Starting data epoch 28 in logical epoch 28
[2023-07-22 02:11:51] [data] Shuffling data
[2023-07-22 02:11:51] [data] Done reading 20,192 sentences
[2023-07-22 02:11:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:17:17] Seen 20,192 samples
[2023-07-22 02:17:17] Starting data epoch 29 in logical epoch 29
[2023-07-22 02:17:17] [data] Shuffling data
[2023-07-22 02:17:17] [data] Done reading 20,192 sentences
[2023-07-22 02:17:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:22:25] Seen 20,192 samples
[2023-07-22 02:22:25] Starting data epoch 30 in logical epoch 30
[2023-07-22 02:22:25] [data] Shuffling data
[2023-07-22 02:22:25] [data] Done reading 20,192 sentences
[2023-07-22 02:22:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:27:52] Seen 20,192 samples
[2023-07-22 02:27:52] Starting data epoch 31 in logical epoch 31
[2023-07-22 02:27:52] Training finished
[2023-07-22 02:28:05] [valid] Ep. 31 : Up. 1171 : cross-entropy : 161.181 : new best
[2023-07-22 02:30:33] [valid] Ep. 31 : Up. 1171 : translation : 0 : new best
[2023-07-22 02:30:33] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 02:30:35] Saving Adam parameters
[2023-07-22 02:30:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 02:30:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:30:44] [marian] Running on node18.datos.cluster.uy as process 34156 with command line:
[2023-07-22 02:30:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 02:30:44] [config] after: 0e
[2023-07-22 02:30:44] [config] after-batches: 0
[2023-07-22 02:30:44] [config] after-epochs: 40
[2023-07-22 02:30:44] [config] all-caps-every: 0
[2023-07-22 02:30:44] [config] allow-unk: false
[2023-07-22 02:30:44] [config] authors: false
[2023-07-22 02:30:44] [config] beam-size: 12
[2023-07-22 02:30:44] [config] bert-class-symbol: "[CLS]"
[2023-07-22 02:30:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 02:30:44] [config] bert-masking-fraction: 0.15
[2023-07-22 02:30:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 02:30:44] [config] bert-train-type-embeddings: true
[2023-07-22 02:30:44] [config] bert-type-vocab-size: 2
[2023-07-22 02:30:44] [config] build-info: ""
[2023-07-22 02:30:44] [config] check-gradient-nan: false
[2023-07-22 02:30:44] [config] check-nan: false
[2023-07-22 02:30:44] [config] cite: false
[2023-07-22 02:30:44] [config] clip-norm: 1
[2023-07-22 02:30:44] [config] cost-scaling:
[2023-07-22 02:30:44] [config]   - 256.f
[2023-07-22 02:30:44] [config]   - 1000
[2023-07-22 02:30:44] [config]   - 2.f
[2023-07-22 02:30:44] [config]   - 256.f
[2023-07-22 02:30:44] [config] cost-type: ce-sum
[2023-07-22 02:30:44] [config] cpu-threads: 0
[2023-07-22 02:30:44] [config] data-threads: 8
[2023-07-22 02:30:44] [config] data-weighting: ""
[2023-07-22 02:30:44] [config] data-weighting-type: sentence
[2023-07-22 02:30:44] [config] dec-cell: gru
[2023-07-22 02:30:44] [config] dec-cell-base-depth: 2
[2023-07-22 02:30:44] [config] dec-cell-high-depth: 1
[2023-07-22 02:30:44] [config] dec-depth: 1
[2023-07-22 02:30:44] [config] devices:
[2023-07-22 02:30:44] [config]   - 0
[2023-07-22 02:30:44] [config] dim-emb: 512
[2023-07-22 02:30:44] [config] dim-rnn: 1024
[2023-07-22 02:30:44] [config] dim-vocabs:
[2023-07-22 02:30:44] [config]   - 16384
[2023-07-22 02:30:44] [config]   - 16384
[2023-07-22 02:30:44] [config] disp-first: 0
[2023-07-22 02:30:44] [config] disp-freq: 1000u
[2023-07-22 02:30:44] [config] disp-label-counts: true
[2023-07-22 02:30:44] [config] dropout-rnn: 0
[2023-07-22 02:30:44] [config] dropout-src: 0
[2023-07-22 02:30:44] [config] dropout-trg: 0
[2023-07-22 02:30:44] [config] dump-config: ""
[2023-07-22 02:30:44] [config] dynamic-gradient-scaling:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] early-stopping: 200
[2023-07-22 02:30:44] [config] early-stopping-on: first
[2023-07-22 02:30:44] [config] embedding-fix-src: false
[2023-07-22 02:30:44] [config] embedding-fix-trg: false
[2023-07-22 02:30:44] [config] embedding-normalization: false
[2023-07-22 02:30:44] [config] embedding-vectors:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] enc-cell: gru
[2023-07-22 02:30:44] [config] enc-cell-depth: 1
[2023-07-22 02:30:44] [config] enc-depth: 1
[2023-07-22 02:30:44] [config] enc-type: bidirectional
[2023-07-22 02:30:44] [config] english-title-case-every: 0
[2023-07-22 02:30:44] [config] exponential-smoothing: 0
[2023-07-22 02:30:44] [config] factor-weight: 1
[2023-07-22 02:30:44] [config] factors-combine: sum
[2023-07-22 02:30:44] [config] factors-dim-emb: 0
[2023-07-22 02:30:44] [config] gradient-checkpointing: false
[2023-07-22 02:30:44] [config] gradient-norm-average-window: 100
[2023-07-22 02:30:44] [config] guided-alignment: none
[2023-07-22 02:30:44] [config] guided-alignment-cost: mse
[2023-07-22 02:30:44] [config] guided-alignment-weight: 0.1
[2023-07-22 02:30:44] [config] ignore-model-config: false
[2023-07-22 02:30:44] [config] input-types:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] interpolate-env-vars: false
[2023-07-22 02:30:44] [config] keep-best: false
[2023-07-22 02:30:44] [config] label-smoothing: 0
[2023-07-22 02:30:44] [config] layer-normalization: false
[2023-07-22 02:30:44] [config] learn-rate: 0.0001
[2023-07-22 02:30:44] [config] lemma-dependency: ""
[2023-07-22 02:30:44] [config] lemma-dim-emb: 0
[2023-07-22 02:30:44] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 02:30:44] [config] log-level: info
[2023-07-22 02:30:44] [config] log-time-zone: ""
[2023-07-22 02:30:44] [config] logical-epoch:
[2023-07-22 02:30:44] [config]   - 1e
[2023-07-22 02:30:44] [config]   - 0
[2023-07-22 02:30:44] [config] lr-decay: 0
[2023-07-22 02:30:44] [config] lr-decay-freq: 50000
[2023-07-22 02:30:44] [config] lr-decay-inv-sqrt:
[2023-07-22 02:30:44] [config]   - 0
[2023-07-22 02:30:44] [config] lr-decay-repeat-warmup: false
[2023-07-22 02:30:44] [config] lr-decay-reset-optimizer: false
[2023-07-22 02:30:44] [config] lr-decay-start:
[2023-07-22 02:30:44] [config]   - 10
[2023-07-22 02:30:44] [config]   - 1
[2023-07-22 02:30:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 02:30:44] [config] lr-report: false
[2023-07-22 02:30:44] [config] lr-warmup: 0
[2023-07-22 02:30:44] [config] lr-warmup-at-reload: false
[2023-07-22 02:30:44] [config] lr-warmup-cycle: false
[2023-07-22 02:30:44] [config] lr-warmup-start-rate: 0
[2023-07-22 02:30:44] [config] max-length: 300
[2023-07-22 02:30:44] [config] max-length-crop: true
[2023-07-22 02:30:44] [config] max-length-factor: 3
[2023-07-22 02:30:44] [config] maxi-batch: 100
[2023-07-22 02:30:44] [config] maxi-batch-sort: trg
[2023-07-22 02:30:44] [config] mini-batch: 64
[2023-07-22 02:30:44] [config] mini-batch-fit: true
[2023-07-22 02:30:44] [config] mini-batch-fit-step: 10
[2023-07-22 02:30:44] [config] mini-batch-round-up: true
[2023-07-22 02:30:44] [config] mini-batch-track-lr: false
[2023-07-22 02:30:44] [config] mini-batch-warmup: 0
[2023-07-22 02:30:44] [config] mini-batch-words: 0
[2023-07-22 02:30:44] [config] mini-batch-words-ref: 0
[2023-07-22 02:30:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 02:30:44] [config] multi-loss-type: sum
[2023-07-22 02:30:44] [config] n-best: false
[2023-07-22 02:30:44] [config] no-nccl: false
[2023-07-22 02:30:44] [config] no-reload: false
[2023-07-22 02:30:44] [config] no-restore-corpus: false
[2023-07-22 02:30:44] [config] normalize: 0
[2023-07-22 02:30:44] [config] normalize-gradient: false
[2023-07-22 02:30:44] [config] num-devices: 0
[2023-07-22 02:30:44] [config] optimizer: adam
[2023-07-22 02:30:44] [config] optimizer-delay: 1
[2023-07-22 02:30:44] [config] optimizer-params:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] output-omit-bias: false
[2023-07-22 02:30:44] [config] overwrite: true
[2023-07-22 02:30:44] [config] precision:
[2023-07-22 02:30:44] [config]   - float16
[2023-07-22 02:30:44] [config]   - float32
[2023-07-22 02:30:44] [config] pretrained-model: ""
[2023-07-22 02:30:44] [config] quantize-biases: false
[2023-07-22 02:30:44] [config] quantize-bits: 0
[2023-07-22 02:30:44] [config] quantize-log-based: false
[2023-07-22 02:30:44] [config] quantize-optimization-steps: 0
[2023-07-22 02:30:44] [config] quiet: false
[2023-07-22 02:30:44] [config] quiet-translation: true
[2023-07-22 02:30:44] [config] relative-paths: false
[2023-07-22 02:30:44] [config] right-left: false
[2023-07-22 02:30:44] [config] save-freq: 10000u
[2023-07-22 02:30:44] [config] seed: 1234
[2023-07-22 02:30:44] [config] sentencepiece-alphas:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] sentencepiece-max-lines: 2000000
[2023-07-22 02:30:44] [config] sentencepiece-options: ""
[2023-07-22 02:30:44] [config] sharding: global
[2023-07-22 02:30:44] [config] shuffle: data
[2023-07-22 02:30:44] [config] shuffle-in-ram: false
[2023-07-22 02:30:44] [config] sigterm: save-and-exit
[2023-07-22 02:30:44] [config] skip: false
[2023-07-22 02:30:44] [config] sqlite: ""
[2023-07-22 02:30:44] [config] sqlite-drop: false
[2023-07-22 02:30:44] [config] sync-freq: 200u
[2023-07-22 02:30:44] [config] sync-sgd: false
[2023-07-22 02:30:44] [config] tempdir: /tmp
[2023-07-22 02:30:44] [config] tied-embeddings: false
[2023-07-22 02:30:44] [config] tied-embeddings-all: true
[2023-07-22 02:30:44] [config] tied-embeddings-src: false
[2023-07-22 02:30:44] [config] train-embedder-rank:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] train-sets:
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 02:30:44] [config] transformer-aan-activation: swish
[2023-07-22 02:30:44] [config] transformer-aan-depth: 2
[2023-07-22 02:30:44] [config] transformer-aan-nogate: false
[2023-07-22 02:30:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 02:30:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 02:30:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 02:30:44] [config] transformer-depth-scaling: false
[2023-07-22 02:30:44] [config] transformer-dim-aan: 2048
[2023-07-22 02:30:44] [config] transformer-dim-ffn: 2048
[2023-07-22 02:30:44] [config] transformer-dropout: 0
[2023-07-22 02:30:44] [config] transformer-dropout-attention: 0
[2023-07-22 02:30:44] [config] transformer-dropout-ffn: 0
[2023-07-22 02:30:44] [config] transformer-ffn-activation: swish
[2023-07-22 02:30:44] [config] transformer-ffn-depth: 2
[2023-07-22 02:30:44] [config] transformer-guided-alignment-layer: last
[2023-07-22 02:30:44] [config] transformer-heads: 8
[2023-07-22 02:30:44] [config] transformer-no-projection: false
[2023-07-22 02:30:44] [config] transformer-pool: false
[2023-07-22 02:30:44] [config] transformer-postprocess: dan
[2023-07-22 02:30:44] [config] transformer-postprocess-emb: d
[2023-07-22 02:30:44] [config] transformer-postprocess-top: ""
[2023-07-22 02:30:44] [config] transformer-preprocess: ""
[2023-07-22 02:30:44] [config] transformer-tied-layers:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] transformer-train-position-embeddings: false
[2023-07-22 02:30:44] [config] tsv: false
[2023-07-22 02:30:44] [config] tsv-fields: 0
[2023-07-22 02:30:44] [config] type: amun
[2023-07-22 02:30:44] [config] ulr: false
[2023-07-22 02:30:44] [config] ulr-dim-emb: 0
[2023-07-22 02:30:44] [config] ulr-dropout: 0
[2023-07-22 02:30:44] [config] ulr-keys-vectors: ""
[2023-07-22 02:30:44] [config] ulr-query-vectors: ""
[2023-07-22 02:30:44] [config] ulr-softmax-temperature: 1
[2023-07-22 02:30:44] [config] ulr-trainable-transformation: false
[2023-07-22 02:30:44] [config] unlikelihood-loss: false
[2023-07-22 02:30:44] [config] valid-freq: 50000000
[2023-07-22 02:30:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 02:30:44] [config] valid-max-length: 1000
[2023-07-22 02:30:44] [config] valid-metrics:
[2023-07-22 02:30:44] [config]   - cross-entropy
[2023-07-22 02:30:44] [config]   - translation
[2023-07-22 02:30:44] [config] valid-mini-batch: 32
[2023-07-22 02:30:44] [config] valid-reset-stalled: false
[2023-07-22 02:30:44] [config] valid-script-args:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] valid-script-path: ""
[2023-07-22 02:30:44] [config] valid-sets:
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 02:30:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 02:30:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:30:44] [config] vocabs:
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:30:44] [config] word-penalty: 0
[2023-07-22 02:30:44] [config] word-scores: false
[2023-07-22 02:30:44] [config] workspace: 5500
[2023-07-22 02:30:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:30:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:30:44] [training] Using single-device training
[2023-07-22 02:30:44] Synced seed 1234
[2023-07-22 02:30:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:30:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 02:30:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:30:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 02:30:45] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 02:30:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:30:45] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 02:30:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 02:30:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 02:30:46] [comm] Using global sharding
[2023-07-22 02:30:46] [comm] NCCLCommunicators constructed successfully
[2023-07-22 02:30:46] [training] Using 1 GPUs
[2023-07-22 02:30:46] [logits] Applying loss function for 1 factor(s)
[2023-07-22 02:30:46] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:30:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 02:30:46] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:34:23] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 03:34:23] [valid] No post-processing script given for validating translator
[2023-07-22 03:34:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:34:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 03:34:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 03:34:23] [comm] Using global sharding
[2023-07-22 03:34:23] [comm] NCCLCommunicators constructed successfully
[2023-07-22 03:34:23] [training] Using 1 GPUs
[2023-07-22 03:34:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 03:34:30] Allocating memory for general optimizer shards
[2023-07-22 03:34:30] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:34:30] Loading Adam parameters
[2023-07-22 03:34:31] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:34:31] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:34:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 03:34:31] [data] Restoring the corpus state to epoch 31, batch 1171
[2023-07-22 03:34:31] [data] Shuffling data
[2023-07-22 03:34:31] [data] Done reading 20,192 sentences
[2023-07-22 03:34:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:34:31] Training started
[2023-07-22 03:34:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 03:34:32] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:34:42] Parameter type float16, optimization type float32, casting types true
[2023-07-22 03:39:48] Seen 20,192 samples
[2023-07-22 03:39:48] Starting data epoch 32 in logical epoch 32
[2023-07-22 03:39:48] [data] Shuffling data
[2023-07-22 03:39:48] [data] Done reading 20,192 sentences
[2023-07-22 03:39:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:45:07] Seen 20,192 samples
[2023-07-22 03:45:07] Starting data epoch 33 in logical epoch 33
[2023-07-22 03:45:07] [data] Shuffling data
[2023-07-22 03:45:07] [data] Done reading 20,192 sentences
[2023-07-22 03:45:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:50:30] Seen 20,192 samples
[2023-07-22 03:50:30] Starting data epoch 34 in logical epoch 34
[2023-07-22 03:50:30] [data] Shuffling data
[2023-07-22 03:50:30] [data] Done reading 20,192 sentences
[2023-07-22 03:50:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:55:54] Seen 20,192 samples
[2023-07-22 03:55:54] Starting data epoch 35 in logical epoch 35
[2023-07-22 03:55:54] [data] Shuffling data
[2023-07-22 03:55:54] [data] Done reading 20,192 sentences
[2023-07-22 03:55:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:01:22] Seen 20,192 samples
[2023-07-22 04:01:22] Starting data epoch 36 in logical epoch 36
[2023-07-22 04:01:22] [data] Shuffling data
[2023-07-22 04:01:22] [data] Done reading 20,192 sentences
[2023-07-22 04:01:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:06:55] Seen 20,192 samples
[2023-07-22 04:06:55] Starting data epoch 37 in logical epoch 37
[2023-07-22 04:06:55] [data] Shuffling data
[2023-07-22 04:06:55] [data] Done reading 20,192 sentences
[2023-07-22 04:06:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:12:27] Seen 20,192 samples
[2023-07-22 04:12:27] Starting data epoch 38 in logical epoch 38
[2023-07-22 04:12:27] [data] Shuffling data
[2023-07-22 04:12:27] [data] Done reading 20,192 sentences
[2023-07-22 04:12:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:17:54] Seen 20,192 samples
[2023-07-22 04:17:54] Starting data epoch 39 in logical epoch 39
[2023-07-22 04:17:54] [data] Shuffling data
[2023-07-22 04:17:54] [data] Done reading 20,192 sentences
[2023-07-22 04:17:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:23:13] Seen 20,192 samples
[2023-07-22 04:23:13] Starting data epoch 40 in logical epoch 40
[2023-07-22 04:23:13] [data] Shuffling data
[2023-07-22 04:23:13] [data] Done reading 20,192 sentences
[2023-07-22 04:23:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:28:33] Seen 20,192 samples
[2023-07-22 04:28:33] Starting data epoch 41 in logical epoch 41
[2023-07-22 04:28:33] Training finished
[2023-07-22 04:28:45] [valid] Ep. 41 : Up. 1562 : cross-entropy : 153.005 : new best
[2023-07-22 04:31:06] [valid] Ep. 41 : Up. 1562 : translation : 0 : new best
[2023-07-22 04:31:06] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 04:31:08] Saving Adam parameters
[2023-07-22 04:31:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 04:31:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:31:18] [marian] Running on node18.datos.cluster.uy as process 1492 with command line:
[2023-07-22 04:31:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 04:31:18] [config] after: 0e
[2023-07-22 04:31:18] [config] after-batches: 0
[2023-07-22 04:31:18] [config] after-epochs: 50
[2023-07-22 04:31:18] [config] all-caps-every: 0
[2023-07-22 04:31:18] [config] allow-unk: false
[2023-07-22 04:31:18] [config] authors: false
[2023-07-22 04:31:18] [config] beam-size: 12
[2023-07-22 04:31:18] [config] bert-class-symbol: "[CLS]"
[2023-07-22 04:31:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 04:31:18] [config] bert-masking-fraction: 0.15
[2023-07-22 04:31:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 04:31:18] [config] bert-train-type-embeddings: true
[2023-07-22 04:31:18] [config] bert-type-vocab-size: 2
[2023-07-22 04:31:18] [config] build-info: ""
[2023-07-22 04:31:18] [config] check-gradient-nan: false
[2023-07-22 04:31:18] [config] check-nan: false
[2023-07-22 04:31:18] [config] cite: false
[2023-07-22 04:31:18] [config] clip-norm: 1
[2023-07-22 04:31:18] [config] cost-scaling:
[2023-07-22 04:31:18] [config]   - 256.f
[2023-07-22 04:31:18] [config]   - 1000
[2023-07-22 04:31:18] [config]   - 2.f
[2023-07-22 04:31:18] [config]   - 256.f
[2023-07-22 04:31:18] [config] cost-type: ce-sum
[2023-07-22 04:31:18] [config] cpu-threads: 0
[2023-07-22 04:31:18] [config] data-threads: 8
[2023-07-22 04:31:18] [config] data-weighting: ""
[2023-07-22 04:31:18] [config] data-weighting-type: sentence
[2023-07-22 04:31:18] [config] dec-cell: gru
[2023-07-22 04:31:18] [config] dec-cell-base-depth: 2
[2023-07-22 04:31:18] [config] dec-cell-high-depth: 1
[2023-07-22 04:31:18] [config] dec-depth: 1
[2023-07-22 04:31:18] [config] devices:
[2023-07-22 04:31:18] [config]   - 0
[2023-07-22 04:31:18] [config] dim-emb: 512
[2023-07-22 04:31:18] [config] dim-rnn: 1024
[2023-07-22 04:31:18] [config] dim-vocabs:
[2023-07-22 04:31:18] [config]   - 16384
[2023-07-22 04:31:18] [config]   - 16384
[2023-07-22 04:31:18] [config] disp-first: 0
[2023-07-22 04:31:18] [config] disp-freq: 1000u
[2023-07-22 04:31:18] [config] disp-label-counts: true
[2023-07-22 04:31:18] [config] dropout-rnn: 0
[2023-07-22 04:31:18] [config] dropout-src: 0
[2023-07-22 04:31:18] [config] dropout-trg: 0
[2023-07-22 04:31:18] [config] dump-config: ""
[2023-07-22 04:31:18] [config] dynamic-gradient-scaling:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] early-stopping: 200
[2023-07-22 04:31:18] [config] early-stopping-on: first
[2023-07-22 04:31:18] [config] embedding-fix-src: false
[2023-07-22 04:31:18] [config] embedding-fix-trg: false
[2023-07-22 04:31:18] [config] embedding-normalization: false
[2023-07-22 04:31:18] [config] embedding-vectors:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] enc-cell: gru
[2023-07-22 04:31:18] [config] enc-cell-depth: 1
[2023-07-22 04:31:18] [config] enc-depth: 1
[2023-07-22 04:31:18] [config] enc-type: bidirectional
[2023-07-22 04:31:18] [config] english-title-case-every: 0
[2023-07-22 04:31:18] [config] exponential-smoothing: 0
[2023-07-22 04:31:18] [config] factor-weight: 1
[2023-07-22 04:31:18] [config] factors-combine: sum
[2023-07-22 04:31:18] [config] factors-dim-emb: 0
[2023-07-22 04:31:18] [config] gradient-checkpointing: false
[2023-07-22 04:31:18] [config] gradient-norm-average-window: 100
[2023-07-22 04:31:18] [config] guided-alignment: none
[2023-07-22 04:31:18] [config] guided-alignment-cost: mse
[2023-07-22 04:31:18] [config] guided-alignment-weight: 0.1
[2023-07-22 04:31:18] [config] ignore-model-config: false
[2023-07-22 04:31:18] [config] input-types:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] interpolate-env-vars: false
[2023-07-22 04:31:18] [config] keep-best: false
[2023-07-22 04:31:18] [config] label-smoothing: 0
[2023-07-22 04:31:18] [config] layer-normalization: false
[2023-07-22 04:31:18] [config] learn-rate: 0.0001
[2023-07-22 04:31:18] [config] lemma-dependency: ""
[2023-07-22 04:31:18] [config] lemma-dim-emb: 0
[2023-07-22 04:31:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 04:31:18] [config] log-level: info
[2023-07-22 04:31:18] [config] log-time-zone: ""
[2023-07-22 04:31:18] [config] logical-epoch:
[2023-07-22 04:31:18] [config]   - 1e
[2023-07-22 04:31:18] [config]   - 0
[2023-07-22 04:31:18] [config] lr-decay: 0
[2023-07-22 04:31:18] [config] lr-decay-freq: 50000
[2023-07-22 04:31:18] [config] lr-decay-inv-sqrt:
[2023-07-22 04:31:18] [config]   - 0
[2023-07-22 04:31:18] [config] lr-decay-repeat-warmup: false
[2023-07-22 04:31:18] [config] lr-decay-reset-optimizer: false
[2023-07-22 04:31:18] [config] lr-decay-start:
[2023-07-22 04:31:18] [config]   - 10
[2023-07-22 04:31:18] [config]   - 1
[2023-07-22 04:31:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 04:31:18] [config] lr-report: false
[2023-07-22 04:31:18] [config] lr-warmup: 0
[2023-07-22 04:31:18] [config] lr-warmup-at-reload: false
[2023-07-22 04:31:18] [config] lr-warmup-cycle: false
[2023-07-22 04:31:18] [config] lr-warmup-start-rate: 0
[2023-07-22 04:31:18] [config] max-length: 300
[2023-07-22 04:31:18] [config] max-length-crop: true
[2023-07-22 04:31:18] [config] max-length-factor: 3
[2023-07-22 04:31:18] [config] maxi-batch: 100
[2023-07-22 04:31:18] [config] maxi-batch-sort: trg
[2023-07-22 04:31:18] [config] mini-batch: 64
[2023-07-22 04:31:18] [config] mini-batch-fit: true
[2023-07-22 04:31:18] [config] mini-batch-fit-step: 10
[2023-07-22 04:31:18] [config] mini-batch-round-up: true
[2023-07-22 04:31:18] [config] mini-batch-track-lr: false
[2023-07-22 04:31:18] [config] mini-batch-warmup: 0
[2023-07-22 04:31:18] [config] mini-batch-words: 0
[2023-07-22 04:31:18] [config] mini-batch-words-ref: 0
[2023-07-22 04:31:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 04:31:18] [config] multi-loss-type: sum
[2023-07-22 04:31:18] [config] n-best: false
[2023-07-22 04:31:18] [config] no-nccl: false
[2023-07-22 04:31:18] [config] no-reload: false
[2023-07-22 04:31:18] [config] no-restore-corpus: false
[2023-07-22 04:31:18] [config] normalize: 0
[2023-07-22 04:31:18] [config] normalize-gradient: false
[2023-07-22 04:31:18] [config] num-devices: 0
[2023-07-22 04:31:18] [config] optimizer: adam
[2023-07-22 04:31:18] [config] optimizer-delay: 1
[2023-07-22 04:31:18] [config] optimizer-params:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] output-omit-bias: false
[2023-07-22 04:31:18] [config] overwrite: true
[2023-07-22 04:31:18] [config] precision:
[2023-07-22 04:31:18] [config]   - float16
[2023-07-22 04:31:18] [config]   - float32
[2023-07-22 04:31:18] [config] pretrained-model: ""
[2023-07-22 04:31:18] [config] quantize-biases: false
[2023-07-22 04:31:18] [config] quantize-bits: 0
[2023-07-22 04:31:18] [config] quantize-log-based: false
[2023-07-22 04:31:18] [config] quantize-optimization-steps: 0
[2023-07-22 04:31:18] [config] quiet: false
[2023-07-22 04:31:18] [config] quiet-translation: true
[2023-07-22 04:31:18] [config] relative-paths: false
[2023-07-22 04:31:18] [config] right-left: false
[2023-07-22 04:31:18] [config] save-freq: 10000u
[2023-07-22 04:31:18] [config] seed: 1234
[2023-07-22 04:31:18] [config] sentencepiece-alphas:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] sentencepiece-max-lines: 2000000
[2023-07-22 04:31:18] [config] sentencepiece-options: ""
[2023-07-22 04:31:18] [config] sharding: global
[2023-07-22 04:31:18] [config] shuffle: data
[2023-07-22 04:31:18] [config] shuffle-in-ram: false
[2023-07-22 04:31:18] [config] sigterm: save-and-exit
[2023-07-22 04:31:18] [config] skip: false
[2023-07-22 04:31:18] [config] sqlite: ""
[2023-07-22 04:31:18] [config] sqlite-drop: false
[2023-07-22 04:31:18] [config] sync-freq: 200u
[2023-07-22 04:31:18] [config] sync-sgd: false
[2023-07-22 04:31:18] [config] tempdir: /tmp
[2023-07-22 04:31:18] [config] tied-embeddings: false
[2023-07-22 04:31:18] [config] tied-embeddings-all: true
[2023-07-22 04:31:18] [config] tied-embeddings-src: false
[2023-07-22 04:31:18] [config] train-embedder-rank:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] train-sets:
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 04:31:18] [config] transformer-aan-activation: swish
[2023-07-22 04:31:18] [config] transformer-aan-depth: 2
[2023-07-22 04:31:18] [config] transformer-aan-nogate: false
[2023-07-22 04:31:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 04:31:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 04:31:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 04:31:18] [config] transformer-depth-scaling: false
[2023-07-22 04:31:18] [config] transformer-dim-aan: 2048
[2023-07-22 04:31:18] [config] transformer-dim-ffn: 2048
[2023-07-22 04:31:18] [config] transformer-dropout: 0
[2023-07-22 04:31:18] [config] transformer-dropout-attention: 0
[2023-07-22 04:31:18] [config] transformer-dropout-ffn: 0
[2023-07-22 04:31:18] [config] transformer-ffn-activation: swish
[2023-07-22 04:31:18] [config] transformer-ffn-depth: 2
[2023-07-22 04:31:18] [config] transformer-guided-alignment-layer: last
[2023-07-22 04:31:18] [config] transformer-heads: 8
[2023-07-22 04:31:18] [config] transformer-no-projection: false
[2023-07-22 04:31:18] [config] transformer-pool: false
[2023-07-22 04:31:18] [config] transformer-postprocess: dan
[2023-07-22 04:31:18] [config] transformer-postprocess-emb: d
[2023-07-22 04:31:18] [config] transformer-postprocess-top: ""
[2023-07-22 04:31:18] [config] transformer-preprocess: ""
[2023-07-22 04:31:18] [config] transformer-tied-layers:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] transformer-train-position-embeddings: false
[2023-07-22 04:31:18] [config] tsv: false
[2023-07-22 04:31:18] [config] tsv-fields: 0
[2023-07-22 04:31:18] [config] type: amun
[2023-07-22 04:31:18] [config] ulr: false
[2023-07-22 04:31:18] [config] ulr-dim-emb: 0
[2023-07-22 04:31:18] [config] ulr-dropout: 0
[2023-07-22 04:31:18] [config] ulr-keys-vectors: ""
[2023-07-22 04:31:18] [config] ulr-query-vectors: ""
[2023-07-22 04:31:18] [config] ulr-softmax-temperature: 1
[2023-07-22 04:31:18] [config] ulr-trainable-transformation: false
[2023-07-22 04:31:18] [config] unlikelihood-loss: false
[2023-07-22 04:31:18] [config] valid-freq: 50000000
[2023-07-22 04:31:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 04:31:18] [config] valid-max-length: 1000
[2023-07-22 04:31:18] [config] valid-metrics:
[2023-07-22 04:31:18] [config]   - cross-entropy
[2023-07-22 04:31:18] [config]   - translation
[2023-07-22 04:31:18] [config] valid-mini-batch: 32
[2023-07-22 04:31:18] [config] valid-reset-stalled: false
[2023-07-22 04:31:18] [config] valid-script-args:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] valid-script-path: ""
[2023-07-22 04:31:18] [config] valid-sets:
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 04:31:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 04:31:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:31:18] [config] vocabs:
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:31:18] [config] word-penalty: 0
[2023-07-22 04:31:18] [config] word-scores: false
[2023-07-22 04:31:18] [config] workspace: 5500
[2023-07-22 04:31:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:31:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:31:18] [training] Using single-device training
[2023-07-22 04:31:18] Synced seed 1234
[2023-07-22 04:31:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:31:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 04:31:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:31:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 04:31:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 04:31:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:31:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 04:31:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 04:31:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 04:31:20] [comm] Using global sharding
[2023-07-22 04:31:20] [comm] NCCLCommunicators constructed successfully
[2023-07-22 04:31:20] [training] Using 1 GPUs
[2023-07-22 04:31:20] [logits] Applying loss function for 1 factor(s)
[2023-07-22 04:31:20] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:31:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 04:31:20] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:34:59] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 05:34:59] [valid] No post-processing script given for validating translator
[2023-07-22 05:34:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 05:34:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 05:34:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 05:34:59] [comm] Using global sharding
[2023-07-22 05:34:59] [comm] NCCLCommunicators constructed successfully
[2023-07-22 05:34:59] [training] Using 1 GPUs
[2023-07-22 05:34:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 05:35:07] Allocating memory for general optimizer shards
[2023-07-22 05:35:07] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:35:07] Loading Adam parameters
[2023-07-22 05:35:07] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:35:07] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:35:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 05:35:08] [data] Restoring the corpus state to epoch 41, batch 1562
[2023-07-22 05:35:08] [data] Shuffling data
[2023-07-22 05:35:08] [data] Done reading 20,192 sentences
[2023-07-22 05:35:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:35:08] Training started
[2023-07-22 05:35:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 05:35:08] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:35:17] Parameter type float16, optimization type float32, casting types true
[2023-07-22 05:40:14] Seen 20,192 samples
[2023-07-22 05:40:14] Starting data epoch 42 in logical epoch 42
[2023-07-22 05:40:14] [data] Shuffling data
[2023-07-22 05:40:14] [data] Done reading 20,192 sentences
[2023-07-22 05:40:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:45:41] Seen 20,192 samples
[2023-07-22 05:45:41] Starting data epoch 43 in logical epoch 43
[2023-07-22 05:45:41] [data] Shuffling data
[2023-07-22 05:45:41] [data] Done reading 20,192 sentences
[2023-07-22 05:45:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:50:57] Seen 20,192 samples
[2023-07-22 05:50:57] Starting data epoch 44 in logical epoch 44
[2023-07-22 05:50:57] [data] Shuffling data
[2023-07-22 05:50:57] [data] Done reading 20,192 sentences
[2023-07-22 05:50:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:56:08] Seen 20,192 samples
[2023-07-22 05:56:08] Starting data epoch 45 in logical epoch 45
[2023-07-22 05:56:08] [data] Shuffling data
[2023-07-22 05:56:08] [data] Done reading 20,192 sentences
[2023-07-22 05:56:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:01:15] Seen 20,192 samples
[2023-07-22 06:01:15] Starting data epoch 46 in logical epoch 46
[2023-07-22 06:01:15] [data] Shuffling data
[2023-07-22 06:01:15] [data] Done reading 20,192 sentences
[2023-07-22 06:01:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:06:42] Seen 20,192 samples
[2023-07-22 06:06:42] Starting data epoch 47 in logical epoch 47
[2023-07-22 06:06:42] [data] Shuffling data
[2023-07-22 06:06:42] [data] Done reading 20,192 sentences
[2023-07-22 06:06:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:12:01] Seen 20,192 samples
[2023-07-22 06:12:01] Starting data epoch 48 in logical epoch 48
[2023-07-22 06:12:01] [data] Shuffling data
[2023-07-22 06:12:01] [data] Done reading 20,192 sentences
[2023-07-22 06:12:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:17:21] Seen 20,192 samples
[2023-07-22 06:17:21] Starting data epoch 49 in logical epoch 49
[2023-07-22 06:17:21] [data] Shuffling data
[2023-07-22 06:17:21] [data] Done reading 20,192 sentences
[2023-07-22 06:17:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:22:31] Seen 20,192 samples
[2023-07-22 06:22:31] Starting data epoch 50 in logical epoch 50
[2023-07-22 06:22:31] [data] Shuffling data
[2023-07-22 06:22:31] [data] Done reading 20,192 sentences
[2023-07-22 06:22:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:27:47] Seen 20,192 samples
[2023-07-22 06:27:47] Starting data epoch 51 in logical epoch 51
[2023-07-22 06:27:47] Training finished
[2023-07-22 06:27:59] [valid] Ep. 51 : Up. 1949 : cross-entropy : 146.804 : new best
[2023-07-22 06:30:22] [valid] Ep. 51 : Up. 1949 : translation : 0 : new best
[2023-07-22 06:30:22] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 06:30:24] Saving Adam parameters
[2023-07-22 06:30:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 06:30:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:30:32] [marian] Running on node18.datos.cluster.uy as process 9287 with command line:
[2023-07-22 06:30:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 06:30:32] [config] after: 0e
[2023-07-22 06:30:32] [config] after-batches: 0
[2023-07-22 06:30:32] [config] after-epochs: 60
[2023-07-22 06:30:32] [config] all-caps-every: 0
[2023-07-22 06:30:32] [config] allow-unk: false
[2023-07-22 06:30:32] [config] authors: false
[2023-07-22 06:30:32] [config] beam-size: 12
[2023-07-22 06:30:32] [config] bert-class-symbol: "[CLS]"
[2023-07-22 06:30:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 06:30:32] [config] bert-masking-fraction: 0.15
[2023-07-22 06:30:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 06:30:32] [config] bert-train-type-embeddings: true
[2023-07-22 06:30:32] [config] bert-type-vocab-size: 2
[2023-07-22 06:30:32] [config] build-info: ""
[2023-07-22 06:30:32] [config] check-gradient-nan: false
[2023-07-22 06:30:32] [config] check-nan: false
[2023-07-22 06:30:32] [config] cite: false
[2023-07-22 06:30:32] [config] clip-norm: 1
[2023-07-22 06:30:32] [config] cost-scaling:
[2023-07-22 06:30:32] [config]   - 256.f
[2023-07-22 06:30:32] [config]   - 1000
[2023-07-22 06:30:32] [config]   - 2.f
[2023-07-22 06:30:32] [config]   - 256.f
[2023-07-22 06:30:32] [config] cost-type: ce-sum
[2023-07-22 06:30:32] [config] cpu-threads: 0
[2023-07-22 06:30:32] [config] data-threads: 8
[2023-07-22 06:30:32] [config] data-weighting: ""
[2023-07-22 06:30:32] [config] data-weighting-type: sentence
[2023-07-22 06:30:32] [config] dec-cell: gru
[2023-07-22 06:30:32] [config] dec-cell-base-depth: 2
[2023-07-22 06:30:32] [config] dec-cell-high-depth: 1
[2023-07-22 06:30:32] [config] dec-depth: 1
[2023-07-22 06:30:32] [config] devices:
[2023-07-22 06:30:32] [config]   - 0
[2023-07-22 06:30:32] [config] dim-emb: 512
[2023-07-22 06:30:32] [config] dim-rnn: 1024
[2023-07-22 06:30:32] [config] dim-vocabs:
[2023-07-22 06:30:32] [config]   - 16384
[2023-07-22 06:30:32] [config]   - 16384
[2023-07-22 06:30:32] [config] disp-first: 0
[2023-07-22 06:30:32] [config] disp-freq: 1000u
[2023-07-22 06:30:32] [config] disp-label-counts: true
[2023-07-22 06:30:32] [config] dropout-rnn: 0
[2023-07-22 06:30:32] [config] dropout-src: 0
[2023-07-22 06:30:32] [config] dropout-trg: 0
[2023-07-22 06:30:32] [config] dump-config: ""
[2023-07-22 06:30:32] [config] dynamic-gradient-scaling:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] early-stopping: 200
[2023-07-22 06:30:32] [config] early-stopping-on: first
[2023-07-22 06:30:32] [config] embedding-fix-src: false
[2023-07-22 06:30:32] [config] embedding-fix-trg: false
[2023-07-22 06:30:32] [config] embedding-normalization: false
[2023-07-22 06:30:32] [config] embedding-vectors:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] enc-cell: gru
[2023-07-22 06:30:32] [config] enc-cell-depth: 1
[2023-07-22 06:30:32] [config] enc-depth: 1
[2023-07-22 06:30:32] [config] enc-type: bidirectional
[2023-07-22 06:30:32] [config] english-title-case-every: 0
[2023-07-22 06:30:32] [config] exponential-smoothing: 0
[2023-07-22 06:30:32] [config] factor-weight: 1
[2023-07-22 06:30:32] [config] factors-combine: sum
[2023-07-22 06:30:32] [config] factors-dim-emb: 0
[2023-07-22 06:30:32] [config] gradient-checkpointing: false
[2023-07-22 06:30:32] [config] gradient-norm-average-window: 100
[2023-07-22 06:30:32] [config] guided-alignment: none
[2023-07-22 06:30:32] [config] guided-alignment-cost: mse
[2023-07-22 06:30:32] [config] guided-alignment-weight: 0.1
[2023-07-22 06:30:32] [config] ignore-model-config: false
[2023-07-22 06:30:32] [config] input-types:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] interpolate-env-vars: false
[2023-07-22 06:30:32] [config] keep-best: false
[2023-07-22 06:30:32] [config] label-smoothing: 0
[2023-07-22 06:30:32] [config] layer-normalization: false
[2023-07-22 06:30:32] [config] learn-rate: 0.0001
[2023-07-22 06:30:32] [config] lemma-dependency: ""
[2023-07-22 06:30:32] [config] lemma-dim-emb: 0
[2023-07-22 06:30:32] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 06:30:32] [config] log-level: info
[2023-07-22 06:30:32] [config] log-time-zone: ""
[2023-07-22 06:30:32] [config] logical-epoch:
[2023-07-22 06:30:32] [config]   - 1e
[2023-07-22 06:30:32] [config]   - 0
[2023-07-22 06:30:32] [config] lr-decay: 0
[2023-07-22 06:30:32] [config] lr-decay-freq: 50000
[2023-07-22 06:30:32] [config] lr-decay-inv-sqrt:
[2023-07-22 06:30:32] [config]   - 0
[2023-07-22 06:30:32] [config] lr-decay-repeat-warmup: false
[2023-07-22 06:30:32] [config] lr-decay-reset-optimizer: false
[2023-07-22 06:30:32] [config] lr-decay-start:
[2023-07-22 06:30:32] [config]   - 10
[2023-07-22 06:30:32] [config]   - 1
[2023-07-22 06:30:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 06:30:32] [config] lr-report: false
[2023-07-22 06:30:32] [config] lr-warmup: 0
[2023-07-22 06:30:32] [config] lr-warmup-at-reload: false
[2023-07-22 06:30:32] [config] lr-warmup-cycle: false
[2023-07-22 06:30:32] [config] lr-warmup-start-rate: 0
[2023-07-22 06:30:32] [config] max-length: 300
[2023-07-22 06:30:32] [config] max-length-crop: true
[2023-07-22 06:30:32] [config] max-length-factor: 3
[2023-07-22 06:30:32] [config] maxi-batch: 100
[2023-07-22 06:30:32] [config] maxi-batch-sort: trg
[2023-07-22 06:30:32] [config] mini-batch: 64
[2023-07-22 06:30:32] [config] mini-batch-fit: true
[2023-07-22 06:30:32] [config] mini-batch-fit-step: 10
[2023-07-22 06:30:32] [config] mini-batch-round-up: true
[2023-07-22 06:30:32] [config] mini-batch-track-lr: false
[2023-07-22 06:30:32] [config] mini-batch-warmup: 0
[2023-07-22 06:30:32] [config] mini-batch-words: 0
[2023-07-22 06:30:32] [config] mini-batch-words-ref: 0
[2023-07-22 06:30:32] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 06:30:32] [config] multi-loss-type: sum
[2023-07-22 06:30:32] [config] n-best: false
[2023-07-22 06:30:32] [config] no-nccl: false
[2023-07-22 06:30:32] [config] no-reload: false
[2023-07-22 06:30:32] [config] no-restore-corpus: false
[2023-07-22 06:30:32] [config] normalize: 0
[2023-07-22 06:30:32] [config] normalize-gradient: false
[2023-07-22 06:30:32] [config] num-devices: 0
[2023-07-22 06:30:32] [config] optimizer: adam
[2023-07-22 06:30:32] [config] optimizer-delay: 1
[2023-07-22 06:30:32] [config] optimizer-params:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] output-omit-bias: false
[2023-07-22 06:30:32] [config] overwrite: true
[2023-07-22 06:30:32] [config] precision:
[2023-07-22 06:30:32] [config]   - float16
[2023-07-22 06:30:32] [config]   - float32
[2023-07-22 06:30:32] [config] pretrained-model: ""
[2023-07-22 06:30:32] [config] quantize-biases: false
[2023-07-22 06:30:32] [config] quantize-bits: 0
[2023-07-22 06:30:32] [config] quantize-log-based: false
[2023-07-22 06:30:32] [config] quantize-optimization-steps: 0
[2023-07-22 06:30:32] [config] quiet: false
[2023-07-22 06:30:32] [config] quiet-translation: true
[2023-07-22 06:30:32] [config] relative-paths: false
[2023-07-22 06:30:32] [config] right-left: false
[2023-07-22 06:30:32] [config] save-freq: 10000u
[2023-07-22 06:30:32] [config] seed: 1234
[2023-07-22 06:30:32] [config] sentencepiece-alphas:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] sentencepiece-max-lines: 2000000
[2023-07-22 06:30:32] [config] sentencepiece-options: ""
[2023-07-22 06:30:32] [config] sharding: global
[2023-07-22 06:30:32] [config] shuffle: data
[2023-07-22 06:30:32] [config] shuffle-in-ram: false
[2023-07-22 06:30:32] [config] sigterm: save-and-exit
[2023-07-22 06:30:32] [config] skip: false
[2023-07-22 06:30:32] [config] sqlite: ""
[2023-07-22 06:30:32] [config] sqlite-drop: false
[2023-07-22 06:30:32] [config] sync-freq: 200u
[2023-07-22 06:30:32] [config] sync-sgd: false
[2023-07-22 06:30:32] [config] tempdir: /tmp
[2023-07-22 06:30:32] [config] tied-embeddings: false
[2023-07-22 06:30:32] [config] tied-embeddings-all: true
[2023-07-22 06:30:32] [config] tied-embeddings-src: false
[2023-07-22 06:30:32] [config] train-embedder-rank:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] train-sets:
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 06:30:32] [config] transformer-aan-activation: swish
[2023-07-22 06:30:32] [config] transformer-aan-depth: 2
[2023-07-22 06:30:32] [config] transformer-aan-nogate: false
[2023-07-22 06:30:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 06:30:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 06:30:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 06:30:32] [config] transformer-depth-scaling: false
[2023-07-22 06:30:32] [config] transformer-dim-aan: 2048
[2023-07-22 06:30:32] [config] transformer-dim-ffn: 2048
[2023-07-22 06:30:32] [config] transformer-dropout: 0
[2023-07-22 06:30:32] [config] transformer-dropout-attention: 0
[2023-07-22 06:30:32] [config] transformer-dropout-ffn: 0
[2023-07-22 06:30:32] [config] transformer-ffn-activation: swish
[2023-07-22 06:30:32] [config] transformer-ffn-depth: 2
[2023-07-22 06:30:32] [config] transformer-guided-alignment-layer: last
[2023-07-22 06:30:32] [config] transformer-heads: 8
[2023-07-22 06:30:32] [config] transformer-no-projection: false
[2023-07-22 06:30:32] [config] transformer-pool: false
[2023-07-22 06:30:32] [config] transformer-postprocess: dan
[2023-07-22 06:30:32] [config] transformer-postprocess-emb: d
[2023-07-22 06:30:32] [config] transformer-postprocess-top: ""
[2023-07-22 06:30:32] [config] transformer-preprocess: ""
[2023-07-22 06:30:32] [config] transformer-tied-layers:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] transformer-train-position-embeddings: false
[2023-07-22 06:30:32] [config] tsv: false
[2023-07-22 06:30:32] [config] tsv-fields: 0
[2023-07-22 06:30:32] [config] type: amun
[2023-07-22 06:30:32] [config] ulr: false
[2023-07-22 06:30:32] [config] ulr-dim-emb: 0
[2023-07-22 06:30:32] [config] ulr-dropout: 0
[2023-07-22 06:30:32] [config] ulr-keys-vectors: ""
[2023-07-22 06:30:32] [config] ulr-query-vectors: ""
[2023-07-22 06:30:32] [config] ulr-softmax-temperature: 1
[2023-07-22 06:30:32] [config] ulr-trainable-transformation: false
[2023-07-22 06:30:32] [config] unlikelihood-loss: false
[2023-07-22 06:30:32] [config] valid-freq: 50000000
[2023-07-22 06:30:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 06:30:32] [config] valid-max-length: 1000
[2023-07-22 06:30:32] [config] valid-metrics:
[2023-07-22 06:30:32] [config]   - cross-entropy
[2023-07-22 06:30:32] [config]   - translation
[2023-07-22 06:30:32] [config] valid-mini-batch: 32
[2023-07-22 06:30:32] [config] valid-reset-stalled: false
[2023-07-22 06:30:32] [config] valid-script-args:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] valid-script-path: ""
[2023-07-22 06:30:32] [config] valid-sets:
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 06:30:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 06:30:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:30:32] [config] vocabs:
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:30:32] [config] word-penalty: 0
[2023-07-22 06:30:32] [config] word-scores: false
[2023-07-22 06:30:32] [config] workspace: 5500
[2023-07-22 06:30:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:30:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:30:32] [training] Using single-device training
[2023-07-22 06:30:33] Synced seed 1234
[2023-07-22 06:30:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:30:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 06:30:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:30:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 06:30:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 06:30:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:30:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 06:30:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 06:30:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 06:30:34] [comm] Using global sharding
[2023-07-22 06:30:34] [comm] NCCLCommunicators constructed successfully
[2023-07-22 06:30:34] [training] Using 1 GPUs
[2023-07-22 06:30:34] [logits] Applying loss function for 1 factor(s)
[2023-07-22 06:30:34] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:30:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 06:30:34] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:34:37] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 07:34:37] [valid] No post-processing script given for validating translator
[2023-07-22 07:34:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:34:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 07:34:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 07:34:37] [comm] Using global sharding
[2023-07-22 07:34:37] [comm] NCCLCommunicators constructed successfully
[2023-07-22 07:34:37] [training] Using 1 GPUs
[2023-07-22 07:34:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 07:34:43] Allocating memory for general optimizer shards
[2023-07-22 07:34:43] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:34:43] Loading Adam parameters
[2023-07-22 07:34:44] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:34:44] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:34:44] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 07:34:44] [data] Restoring the corpus state to epoch 51, batch 1949
[2023-07-22 07:34:44] [data] Shuffling data
[2023-07-22 07:34:44] [data] Done reading 20,192 sentences
[2023-07-22 07:34:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:34:44] Training started
[2023-07-22 07:34:44] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 07:34:45] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:34:53] Parameter type float16, optimization type float32, casting types true
[2023-07-22 07:39:59] Seen 20,192 samples
[2023-07-22 07:39:59] Starting data epoch 52 in logical epoch 52
[2023-07-22 07:39:59] [data] Shuffling data
[2023-07-22 07:39:59] [data] Done reading 20,192 sentences
[2023-07-22 07:39:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:41:47] Ep. 52 : Up. 2000 : Sen. 7,603 : Cost 5.02863550 * 15,912,376 @ 12,218 after 31,854,216 : Time 429.76s : 37026.48 words/s : gNorm 0.9483
[2023-07-22 07:45:23] Seen 20,192 samples
[2023-07-22 07:45:23] Starting data epoch 53 in logical epoch 53
[2023-07-22 07:45:23] [data] Shuffling data
[2023-07-22 07:45:23] [data] Done reading 20,192 sentences
[2023-07-22 07:45:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:50:32] Seen 20,192 samples
[2023-07-22 07:50:32] Starting data epoch 54 in logical epoch 54
[2023-07-22 07:50:32] [data] Shuffling data
[2023-07-22 07:50:32] [data] Done reading 20,192 sentences
[2023-07-22 07:50:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:55:55] Seen 20,192 samples
[2023-07-22 07:55:55] Starting data epoch 55 in logical epoch 55
[2023-07-22 07:55:55] [data] Shuffling data
[2023-07-22 07:55:55] [data] Done reading 20,192 sentences
[2023-07-22 07:55:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:01:02] Seen 20,192 samples
[2023-07-22 08:01:02] Starting data epoch 56 in logical epoch 56
[2023-07-22 08:01:02] [data] Shuffling data
[2023-07-22 08:01:02] [data] Done reading 20,192 sentences
[2023-07-22 08:01:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:06:20] Seen 20,192 samples
[2023-07-22 08:06:20] Starting data epoch 57 in logical epoch 57
[2023-07-22 08:06:20] [data] Shuffling data
[2023-07-22 08:06:21] [data] Done reading 20,192 sentences
[2023-07-22 08:06:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:11:40] Seen 20,192 samples
[2023-07-22 08:11:40] Starting data epoch 58 in logical epoch 58
[2023-07-22 08:11:40] [data] Shuffling data
[2023-07-22 08:11:40] [data] Done reading 20,192 sentences
[2023-07-22 08:11:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:16:43] Seen 20,192 samples
[2023-07-22 08:16:43] Starting data epoch 59 in logical epoch 59
[2023-07-22 08:16:43] [data] Shuffling data
[2023-07-22 08:16:43] [data] Done reading 20,192 sentences
[2023-07-22 08:16:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:21:56] Seen 20,192 samples
[2023-07-22 08:21:56] Starting data epoch 60 in logical epoch 60
[2023-07-22 08:21:56] [data] Shuffling data
[2023-07-22 08:21:56] [data] Done reading 20,192 sentences
[2023-07-22 08:21:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:27:13] Seen 20,192 samples
[2023-07-22 08:27:13] Starting data epoch 61 in logical epoch 61
[2023-07-22 08:27:13] Training finished
[2023-07-22 08:27:26] [valid] Ep. 61 : Up. 2336 : cross-entropy : 142.415 : new best
[2023-07-22 08:29:53] [valid] Ep. 61 : Up. 2336 : translation : 0 : new best
[2023-07-22 08:29:53] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 08:29:55] Saving Adam parameters
[2023-07-22 08:29:55] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 08:30:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:30:03] [marian] Running on node18.datos.cluster.uy as process 17049 with command line:
[2023-07-22 08:30:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 08:30:03] [config] after: 0e
[2023-07-22 08:30:03] [config] after-batches: 0
[2023-07-22 08:30:03] [config] after-epochs: 70
[2023-07-22 08:30:03] [config] all-caps-every: 0
[2023-07-22 08:30:03] [config] allow-unk: false
[2023-07-22 08:30:03] [config] authors: false
[2023-07-22 08:30:03] [config] beam-size: 12
[2023-07-22 08:30:03] [config] bert-class-symbol: "[CLS]"
[2023-07-22 08:30:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 08:30:03] [config] bert-masking-fraction: 0.15
[2023-07-22 08:30:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 08:30:03] [config] bert-train-type-embeddings: true
[2023-07-22 08:30:03] [config] bert-type-vocab-size: 2
[2023-07-22 08:30:03] [config] build-info: ""
[2023-07-22 08:30:03] [config] check-gradient-nan: false
[2023-07-22 08:30:03] [config] check-nan: false
[2023-07-22 08:30:03] [config] cite: false
[2023-07-22 08:30:03] [config] clip-norm: 1
[2023-07-22 08:30:03] [config] cost-scaling:
[2023-07-22 08:30:03] [config]   - 256.f
[2023-07-22 08:30:03] [config]   - 1000
[2023-07-22 08:30:03] [config]   - 2.f
[2023-07-22 08:30:03] [config]   - 256.f
[2023-07-22 08:30:03] [config] cost-type: ce-sum
[2023-07-22 08:30:03] [config] cpu-threads: 0
[2023-07-22 08:30:03] [config] data-threads: 8
[2023-07-22 08:30:03] [config] data-weighting: ""
[2023-07-22 08:30:03] [config] data-weighting-type: sentence
[2023-07-22 08:30:03] [config] dec-cell: gru
[2023-07-22 08:30:03] [config] dec-cell-base-depth: 2
[2023-07-22 08:30:03] [config] dec-cell-high-depth: 1
[2023-07-22 08:30:03] [config] dec-depth: 1
[2023-07-22 08:30:03] [config] devices:
[2023-07-22 08:30:03] [config]   - 0
[2023-07-22 08:30:03] [config] dim-emb: 512
[2023-07-22 08:30:03] [config] dim-rnn: 1024
[2023-07-22 08:30:03] [config] dim-vocabs:
[2023-07-22 08:30:03] [config]   - 16384
[2023-07-22 08:30:03] [config]   - 16384
[2023-07-22 08:30:03] [config] disp-first: 0
[2023-07-22 08:30:03] [config] disp-freq: 1000u
[2023-07-22 08:30:03] [config] disp-label-counts: true
[2023-07-22 08:30:03] [config] dropout-rnn: 0
[2023-07-22 08:30:03] [config] dropout-src: 0
[2023-07-22 08:30:03] [config] dropout-trg: 0
[2023-07-22 08:30:03] [config] dump-config: ""
[2023-07-22 08:30:03] [config] dynamic-gradient-scaling:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] early-stopping: 200
[2023-07-22 08:30:03] [config] early-stopping-on: first
[2023-07-22 08:30:03] [config] embedding-fix-src: false
[2023-07-22 08:30:03] [config] embedding-fix-trg: false
[2023-07-22 08:30:03] [config] embedding-normalization: false
[2023-07-22 08:30:03] [config] embedding-vectors:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] enc-cell: gru
[2023-07-22 08:30:03] [config] enc-cell-depth: 1
[2023-07-22 08:30:03] [config] enc-depth: 1
[2023-07-22 08:30:03] [config] enc-type: bidirectional
[2023-07-22 08:30:03] [config] english-title-case-every: 0
[2023-07-22 08:30:03] [config] exponential-smoothing: 0
[2023-07-22 08:30:03] [config] factor-weight: 1
[2023-07-22 08:30:03] [config] factors-combine: sum
[2023-07-22 08:30:03] [config] factors-dim-emb: 0
[2023-07-22 08:30:03] [config] gradient-checkpointing: false
[2023-07-22 08:30:03] [config] gradient-norm-average-window: 100
[2023-07-22 08:30:03] [config] guided-alignment: none
[2023-07-22 08:30:03] [config] guided-alignment-cost: mse
[2023-07-22 08:30:03] [config] guided-alignment-weight: 0.1
[2023-07-22 08:30:03] [config] ignore-model-config: false
[2023-07-22 08:30:03] [config] input-types:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] interpolate-env-vars: false
[2023-07-22 08:30:03] [config] keep-best: false
[2023-07-22 08:30:03] [config] label-smoothing: 0
[2023-07-22 08:30:03] [config] layer-normalization: false
[2023-07-22 08:30:03] [config] learn-rate: 0.0001
[2023-07-22 08:30:03] [config] lemma-dependency: ""
[2023-07-22 08:30:03] [config] lemma-dim-emb: 0
[2023-07-22 08:30:03] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 08:30:03] [config] log-level: info
[2023-07-22 08:30:03] [config] log-time-zone: ""
[2023-07-22 08:30:03] [config] logical-epoch:
[2023-07-22 08:30:03] [config]   - 1e
[2023-07-22 08:30:03] [config]   - 0
[2023-07-22 08:30:03] [config] lr-decay: 0
[2023-07-22 08:30:03] [config] lr-decay-freq: 50000
[2023-07-22 08:30:03] [config] lr-decay-inv-sqrt:
[2023-07-22 08:30:03] [config]   - 0
[2023-07-22 08:30:03] [config] lr-decay-repeat-warmup: false
[2023-07-22 08:30:03] [config] lr-decay-reset-optimizer: false
[2023-07-22 08:30:03] [config] lr-decay-start:
[2023-07-22 08:30:03] [config]   - 10
[2023-07-22 08:30:03] [config]   - 1
[2023-07-22 08:30:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 08:30:03] [config] lr-report: false
[2023-07-22 08:30:03] [config] lr-warmup: 0
[2023-07-22 08:30:03] [config] lr-warmup-at-reload: false
[2023-07-22 08:30:03] [config] lr-warmup-cycle: false
[2023-07-22 08:30:03] [config] lr-warmup-start-rate: 0
[2023-07-22 08:30:03] [config] max-length: 300
[2023-07-22 08:30:03] [config] max-length-crop: true
[2023-07-22 08:30:03] [config] max-length-factor: 3
[2023-07-22 08:30:03] [config] maxi-batch: 100
[2023-07-22 08:30:03] [config] maxi-batch-sort: trg
[2023-07-22 08:30:03] [config] mini-batch: 64
[2023-07-22 08:30:03] [config] mini-batch-fit: true
[2023-07-22 08:30:03] [config] mini-batch-fit-step: 10
[2023-07-22 08:30:03] [config] mini-batch-round-up: true
[2023-07-22 08:30:03] [config] mini-batch-track-lr: false
[2023-07-22 08:30:03] [config] mini-batch-warmup: 0
[2023-07-22 08:30:03] [config] mini-batch-words: 0
[2023-07-22 08:30:03] [config] mini-batch-words-ref: 0
[2023-07-22 08:30:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 08:30:03] [config] multi-loss-type: sum
[2023-07-22 08:30:03] [config] n-best: false
[2023-07-22 08:30:03] [config] no-nccl: false
[2023-07-22 08:30:03] [config] no-reload: false
[2023-07-22 08:30:03] [config] no-restore-corpus: false
[2023-07-22 08:30:03] [config] normalize: 0
[2023-07-22 08:30:03] [config] normalize-gradient: false
[2023-07-22 08:30:03] [config] num-devices: 0
[2023-07-22 08:30:03] [config] optimizer: adam
[2023-07-22 08:30:03] [config] optimizer-delay: 1
[2023-07-22 08:30:03] [config] optimizer-params:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] output-omit-bias: false
[2023-07-22 08:30:03] [config] overwrite: true
[2023-07-22 08:30:03] [config] precision:
[2023-07-22 08:30:03] [config]   - float16
[2023-07-22 08:30:03] [config]   - float32
[2023-07-22 08:30:03] [config] pretrained-model: ""
[2023-07-22 08:30:03] [config] quantize-biases: false
[2023-07-22 08:30:03] [config] quantize-bits: 0
[2023-07-22 08:30:03] [config] quantize-log-based: false
[2023-07-22 08:30:03] [config] quantize-optimization-steps: 0
[2023-07-22 08:30:03] [config] quiet: false
[2023-07-22 08:30:03] [config] quiet-translation: true
[2023-07-22 08:30:03] [config] relative-paths: false
[2023-07-22 08:30:03] [config] right-left: false
[2023-07-22 08:30:03] [config] save-freq: 10000u
[2023-07-22 08:30:03] [config] seed: 1234
[2023-07-22 08:30:03] [config] sentencepiece-alphas:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] sentencepiece-max-lines: 2000000
[2023-07-22 08:30:03] [config] sentencepiece-options: ""
[2023-07-22 08:30:03] [config] sharding: global
[2023-07-22 08:30:03] [config] shuffle: data
[2023-07-22 08:30:03] [config] shuffle-in-ram: false
[2023-07-22 08:30:03] [config] sigterm: save-and-exit
[2023-07-22 08:30:03] [config] skip: false
[2023-07-22 08:30:03] [config] sqlite: ""
[2023-07-22 08:30:03] [config] sqlite-drop: false
[2023-07-22 08:30:03] [config] sync-freq: 200u
[2023-07-22 08:30:03] [config] sync-sgd: false
[2023-07-22 08:30:03] [config] tempdir: /tmp
[2023-07-22 08:30:03] [config] tied-embeddings: false
[2023-07-22 08:30:03] [config] tied-embeddings-all: true
[2023-07-22 08:30:03] [config] tied-embeddings-src: false
[2023-07-22 08:30:03] [config] train-embedder-rank:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] train-sets:
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 08:30:03] [config] transformer-aan-activation: swish
[2023-07-22 08:30:03] [config] transformer-aan-depth: 2
[2023-07-22 08:30:03] [config] transformer-aan-nogate: false
[2023-07-22 08:30:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 08:30:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 08:30:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 08:30:03] [config] transformer-depth-scaling: false
[2023-07-22 08:30:03] [config] transformer-dim-aan: 2048
[2023-07-22 08:30:03] [config] transformer-dim-ffn: 2048
[2023-07-22 08:30:03] [config] transformer-dropout: 0
[2023-07-22 08:30:03] [config] transformer-dropout-attention: 0
[2023-07-22 08:30:03] [config] transformer-dropout-ffn: 0
[2023-07-22 08:30:03] [config] transformer-ffn-activation: swish
[2023-07-22 08:30:03] [config] transformer-ffn-depth: 2
[2023-07-22 08:30:03] [config] transformer-guided-alignment-layer: last
[2023-07-22 08:30:03] [config] transformer-heads: 8
[2023-07-22 08:30:03] [config] transformer-no-projection: false
[2023-07-22 08:30:03] [config] transformer-pool: false
[2023-07-22 08:30:03] [config] transformer-postprocess: dan
[2023-07-22 08:30:03] [config] transformer-postprocess-emb: d
[2023-07-22 08:30:03] [config] transformer-postprocess-top: ""
[2023-07-22 08:30:03] [config] transformer-preprocess: ""
[2023-07-22 08:30:03] [config] transformer-tied-layers:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] transformer-train-position-embeddings: false
[2023-07-22 08:30:03] [config] tsv: false
[2023-07-22 08:30:03] [config] tsv-fields: 0
[2023-07-22 08:30:03] [config] type: amun
[2023-07-22 08:30:03] [config] ulr: false
[2023-07-22 08:30:03] [config] ulr-dim-emb: 0
[2023-07-22 08:30:03] [config] ulr-dropout: 0
[2023-07-22 08:30:03] [config] ulr-keys-vectors: ""
[2023-07-22 08:30:03] [config] ulr-query-vectors: ""
[2023-07-22 08:30:03] [config] ulr-softmax-temperature: 1
[2023-07-22 08:30:03] [config] ulr-trainable-transformation: false
[2023-07-22 08:30:03] [config] unlikelihood-loss: false
[2023-07-22 08:30:03] [config] valid-freq: 50000000
[2023-07-22 08:30:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 08:30:03] [config] valid-max-length: 1000
[2023-07-22 08:30:03] [config] valid-metrics:
[2023-07-22 08:30:03] [config]   - cross-entropy
[2023-07-22 08:30:03] [config]   - translation
[2023-07-22 08:30:03] [config] valid-mini-batch: 32
[2023-07-22 08:30:03] [config] valid-reset-stalled: false
[2023-07-22 08:30:03] [config] valid-script-args:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] valid-script-path: ""
[2023-07-22 08:30:03] [config] valid-sets:
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 08:30:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 08:30:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:30:03] [config] vocabs:
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:30:03] [config] word-penalty: 0
[2023-07-22 08:30:03] [config] word-scores: false
[2023-07-22 08:30:03] [config] workspace: 5500
[2023-07-22 08:30:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:30:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:30:03] [training] Using single-device training
[2023-07-22 08:30:04] Synced seed 1234
[2023-07-22 08:30:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:30:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 08:30:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:30:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 08:30:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 08:30:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:30:04] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 08:30:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 08:30:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 08:30:05] [comm] Using global sharding
[2023-07-22 08:30:06] [comm] NCCLCommunicators constructed successfully
[2023-07-22 08:30:06] [training] Using 1 GPUs
[2023-07-22 08:30:06] [logits] Applying loss function for 1 factor(s)
[2023-07-22 08:30:06] [memory] Reserving 80 MB, device gpu0
[2023-07-22 08:30:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 08:30:06] [memory] Reserving 80 MB, device gpu0
slurmstepd: error: *** JOB 2905191 ON node18 CANCELLED AT 2023-07-22T08:39:42 DUE TO TIME LIMIT ***
