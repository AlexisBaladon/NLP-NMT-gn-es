[2023-07-27 09:27:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 09:27:30] [marian] Running on node05.datos.cluster.uy as process 33702 with command line:
[2023-07-27 09:27:30] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 09:27:30] [config] after: 0e
[2023-07-27 09:27:30] [config] after-batches: 0
[2023-07-27 09:27:30] [config] after-epochs: 10
[2023-07-27 09:27:30] [config] all-caps-every: 0
[2023-07-27 09:27:30] [config] allow-unk: false
[2023-07-27 09:27:30] [config] authors: false
[2023-07-27 09:27:30] [config] beam-size: 12
[2023-07-27 09:27:30] [config] bert-class-symbol: "[CLS]"
[2023-07-27 09:27:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 09:27:30] [config] bert-masking-fraction: 0.15
[2023-07-27 09:27:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 09:27:30] [config] bert-train-type-embeddings: true
[2023-07-27 09:27:30] [config] bert-type-vocab-size: 2
[2023-07-27 09:27:30] [config] build-info: ""
[2023-07-27 09:27:30] [config] check-gradient-nan: false
[2023-07-27 09:27:30] [config] check-nan: false
[2023-07-27 09:27:30] [config] cite: false
[2023-07-27 09:27:30] [config] clip-norm: 1
[2023-07-27 09:27:30] [config] cost-scaling:
[2023-07-27 09:27:30] [config]   - 256.f
[2023-07-27 09:27:30] [config]   - 1000
[2023-07-27 09:27:30] [config]   - 2.f
[2023-07-27 09:27:30] [config]   - 256.f
[2023-07-27 09:27:30] [config] cost-type: ce-sum
[2023-07-27 09:27:30] [config] cpu-threads: 0
[2023-07-27 09:27:30] [config] data-threads: 8
[2023-07-27 09:27:30] [config] data-weighting: ""
[2023-07-27 09:27:30] [config] data-weighting-type: sentence
[2023-07-27 09:27:30] [config] dec-cell: gru
[2023-07-27 09:27:30] [config] dec-cell-base-depth: 2
[2023-07-27 09:27:30] [config] dec-cell-high-depth: 1
[2023-07-27 09:27:30] [config] dec-depth: 8
[2023-07-27 09:27:30] [config] devices:
[2023-07-27 09:27:30] [config]   - 0
[2023-07-27 09:27:30] [config] dim-emb: 512
[2023-07-27 09:27:30] [config] dim-rnn: 1024
[2023-07-27 09:27:30] [config] dim-vocabs:
[2023-07-27 09:27:30] [config]   - 16384
[2023-07-27 09:27:30] [config]   - 16384
[2023-07-27 09:27:30] [config] disp-first: 0
[2023-07-27 09:27:30] [config] disp-freq: 1000u
[2023-07-27 09:27:30] [config] disp-label-counts: true
[2023-07-27 09:27:30] [config] dropout-rnn: 0
[2023-07-27 09:27:30] [config] dropout-src: 0
[2023-07-27 09:27:30] [config] dropout-trg: 0
[2023-07-27 09:27:30] [config] dump-config: ""
[2023-07-27 09:27:30] [config] dynamic-gradient-scaling:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] early-stopping: 1000
[2023-07-27 09:27:30] [config] early-stopping-on: first
[2023-07-27 09:27:30] [config] embedding-fix-src: false
[2023-07-27 09:27:30] [config] embedding-fix-trg: false
[2023-07-27 09:27:30] [config] embedding-normalization: false
[2023-07-27 09:27:30] [config] embedding-vectors:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] enc-cell: gru
[2023-07-27 09:27:30] [config] enc-cell-depth: 1
[2023-07-27 09:27:30] [config] enc-depth: 8
[2023-07-27 09:27:30] [config] enc-type: bidirectional
[2023-07-27 09:27:30] [config] english-title-case-every: 0
[2023-07-27 09:27:30] [config] exponential-smoothing: 0
[2023-07-27 09:27:30] [config] factor-weight: 1
[2023-07-27 09:27:30] [config] factors-combine: sum
[2023-07-27 09:27:30] [config] factors-dim-emb: 0
[2023-07-27 09:27:30] [config] gradient-checkpointing: false
[2023-07-27 09:27:30] [config] gradient-norm-average-window: 100
[2023-07-27 09:27:30] [config] guided-alignment: none
[2023-07-27 09:27:30] [config] guided-alignment-cost: mse
[2023-07-27 09:27:30] [config] guided-alignment-weight: 0.1
[2023-07-27 09:27:30] [config] ignore-model-config: false
[2023-07-27 09:27:30] [config] input-types:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] interpolate-env-vars: false
[2023-07-27 09:27:30] [config] keep-best: false
[2023-07-27 09:27:30] [config] label-smoothing: 0
[2023-07-27 09:27:30] [config] layer-normalization: false
[2023-07-27 09:27:30] [config] learn-rate: 0.0001
[2023-07-27 09:27:30] [config] lemma-dependency: ""
[2023-07-27 09:27:30] [config] lemma-dim-emb: 0
[2023-07-27 09:27:30] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 09:27:30] [config] log-level: info
[2023-07-27 09:27:30] [config] log-time-zone: ""
[2023-07-27 09:27:30] [config] logical-epoch:
[2023-07-27 09:27:30] [config]   - 1e
[2023-07-27 09:27:30] [config]   - 0
[2023-07-27 09:27:30] [config] lr-decay: 0
[2023-07-27 09:27:30] [config] lr-decay-freq: 50000
[2023-07-27 09:27:30] [config] lr-decay-inv-sqrt:
[2023-07-27 09:27:30] [config]   - 0
[2023-07-27 09:27:30] [config] lr-decay-repeat-warmup: false
[2023-07-27 09:27:30] [config] lr-decay-reset-optimizer: false
[2023-07-27 09:27:30] [config] lr-decay-start:
[2023-07-27 09:27:30] [config]   - 10
[2023-07-27 09:27:30] [config]   - 1
[2023-07-27 09:27:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 09:27:30] [config] lr-report: false
[2023-07-27 09:27:30] [config] lr-warmup: 0
[2023-07-27 09:27:30] [config] lr-warmup-at-reload: false
[2023-07-27 09:27:30] [config] lr-warmup-cycle: false
[2023-07-27 09:27:30] [config] lr-warmup-start-rate: 0
[2023-07-27 09:27:30] [config] max-length: 50
[2023-07-27 09:27:30] [config] max-length-crop: true
[2023-07-27 09:27:30] [config] max-length-factor: 3
[2023-07-27 09:27:30] [config] maxi-batch: 100
[2023-07-27 09:27:30] [config] maxi-batch-sort: trg
[2023-07-27 09:27:30] [config] mini-batch: 64
[2023-07-27 09:27:30] [config] mini-batch-fit: true
[2023-07-27 09:27:30] [config] mini-batch-fit-step: 10
[2023-07-27 09:27:30] [config] mini-batch-round-up: true
[2023-07-27 09:27:30] [config] mini-batch-track-lr: false
[2023-07-27 09:27:30] [config] mini-batch-warmup: 0
[2023-07-27 09:27:30] [config] mini-batch-words: 0
[2023-07-27 09:27:30] [config] mini-batch-words-ref: 0
[2023-07-27 09:27:30] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 09:27:30] [config] multi-loss-type: sum
[2023-07-27 09:27:30] [config] n-best: false
[2023-07-27 09:27:30] [config] no-nccl: false
[2023-07-27 09:27:30] [config] no-reload: false
[2023-07-27 09:27:30] [config] no-restore-corpus: false
[2023-07-27 09:27:30] [config] normalize: 0
[2023-07-27 09:27:30] [config] normalize-gradient: false
[2023-07-27 09:27:30] [config] num-devices: 0
[2023-07-27 09:27:30] [config] optimizer: adam
[2023-07-27 09:27:30] [config] optimizer-delay: 1
[2023-07-27 09:27:30] [config] optimizer-params:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] output-omit-bias: false
[2023-07-27 09:27:30] [config] overwrite: true
[2023-07-27 09:27:30] [config] precision:
[2023-07-27 09:27:30] [config]   - float16
[2023-07-27 09:27:30] [config]   - float32
[2023-07-27 09:27:30] [config] pretrained-model: ""
[2023-07-27 09:27:30] [config] quantize-biases: false
[2023-07-27 09:27:30] [config] quantize-bits: 0
[2023-07-27 09:27:30] [config] quantize-log-based: false
[2023-07-27 09:27:30] [config] quantize-optimization-steps: 0
[2023-07-27 09:27:30] [config] quiet: false
[2023-07-27 09:27:30] [config] quiet-translation: true
[2023-07-27 09:27:30] [config] relative-paths: false
[2023-07-27 09:27:30] [config] right-left: false
[2023-07-27 09:27:30] [config] save-freq: 10000u
[2023-07-27 09:27:30] [config] seed: 1234
[2023-07-27 09:27:30] [config] sentencepiece-alphas:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] sentencepiece-max-lines: 2000000
[2023-07-27 09:27:30] [config] sentencepiece-options: ""
[2023-07-27 09:27:30] [config] sharding: global
[2023-07-27 09:27:30] [config] shuffle: data
[2023-07-27 09:27:30] [config] shuffle-in-ram: false
[2023-07-27 09:27:30] [config] sigterm: save-and-exit
[2023-07-27 09:27:30] [config] skip: false
[2023-07-27 09:27:30] [config] sqlite: ""
[2023-07-27 09:27:30] [config] sqlite-drop: false
[2023-07-27 09:27:30] [config] sync-freq: 200u
[2023-07-27 09:27:30] [config] sync-sgd: false
[2023-07-27 09:27:30] [config] tempdir: /tmp
[2023-07-27 09:27:30] [config] tied-embeddings: false
[2023-07-27 09:27:30] [config] tied-embeddings-all: true
[2023-07-27 09:27:30] [config] tied-embeddings-src: false
[2023-07-27 09:27:30] [config] train-embedder-rank:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] train-sets:
[2023-07-27 09:27:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 09:27:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 09:27:30] [config] transformer-aan-activation: swish
[2023-07-27 09:27:30] [config] transformer-aan-depth: 2
[2023-07-27 09:27:30] [config] transformer-aan-nogate: false
[2023-07-27 09:27:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 09:27:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 09:27:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 09:27:30] [config] transformer-depth-scaling: false
[2023-07-27 09:27:30] [config] transformer-dim-aan: 2048
[2023-07-27 09:27:30] [config] transformer-dim-ffn: 2048
[2023-07-27 09:27:30] [config] transformer-dropout: 0
[2023-07-27 09:27:30] [config] transformer-dropout-attention: 0
[2023-07-27 09:27:30] [config] transformer-dropout-ffn: 0
[2023-07-27 09:27:30] [config] transformer-ffn-activation: swish
[2023-07-27 09:27:30] [config] transformer-ffn-depth: 2
[2023-07-27 09:27:30] [config] transformer-guided-alignment-layer: last
[2023-07-27 09:27:30] [config] transformer-heads: 8
[2023-07-27 09:27:30] [config] transformer-no-projection: false
[2023-07-27 09:27:30] [config] transformer-pool: false
[2023-07-27 09:27:30] [config] transformer-postprocess: dan
[2023-07-27 09:27:30] [config] transformer-postprocess-emb: d
[2023-07-27 09:27:30] [config] transformer-postprocess-top: ""
[2023-07-27 09:27:30] [config] transformer-preprocess: ""
[2023-07-27 09:27:30] [config] transformer-tied-layers:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] transformer-train-position-embeddings: false
[2023-07-27 09:27:30] [config] tsv: false
[2023-07-27 09:27:30] [config] tsv-fields: 0
[2023-07-27 09:27:30] [config] type: s2s
[2023-07-27 09:27:30] [config] ulr: false
[2023-07-27 09:27:30] [config] ulr-dim-emb: 0
[2023-07-27 09:27:30] [config] ulr-dropout: 0
[2023-07-27 09:27:30] [config] ulr-keys-vectors: ""
[2023-07-27 09:27:30] [config] ulr-query-vectors: ""
[2023-07-27 09:27:30] [config] ulr-softmax-temperature: 1
[2023-07-27 09:27:30] [config] ulr-trainable-transformation: false
[2023-07-27 09:27:30] [config] unlikelihood-loss: false
[2023-07-27 09:27:30] [config] valid-freq: 50000000
[2023-07-27 09:27:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 09:27:30] [config] valid-max-length: 1000
[2023-07-27 09:27:30] [config] valid-metrics:
[2023-07-27 09:27:30] [config]   - translation
[2023-07-27 09:27:30] [config] valid-mini-batch: 32
[2023-07-27 09:27:30] [config] valid-reset-stalled: false
[2023-07-27 09:27:30] [config] valid-script-args:
[2023-07-27 09:27:30] [config]   []
[2023-07-27 09:27:30] [config] valid-script-path: ""
[2023-07-27 09:27:30] [config] valid-sets:
[2023-07-27 09:27:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 09:27:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 09:27:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 09:27:30] [config] vocabs:
[2023-07-27 09:27:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 09:27:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 09:27:30] [config] word-penalty: 0
[2023-07-27 09:27:30] [config] word-scores: false
[2023-07-27 09:27:30] [config] workspace: 5500
[2023-07-27 09:27:30] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 09:27:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 09:27:30] [training] Using single-device training
[2023-07-27 09:27:30] Synced seed 1234
[2023-07-27 09:27:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 09:27:30] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 09:27:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 09:27:30] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 09:27:30] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 09:27:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 09:27:30] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 09:27:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 09:27:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 09:27:31] [comm] Using global sharding
[2023-07-27 09:27:32] [comm] NCCLCommunicators constructed successfully
[2023-07-27 09:27:32] [training] Using 1 GPUs
[2023-07-27 09:27:32] [logits] Applying loss function for 1 factor(s)
[2023-07-27 09:27:32] [memory] Reserving 332 MB, device gpu0
[2023-07-27 09:27:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 09:27:33] [memory] Reserving 332 MB, device gpu0
[2023-07-27 09:29:04] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 09:29:04] [valid] No post-processing script given for validating translator
[2023-07-27 09:29:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 09:29:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 09:29:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 09:29:04] [comm] Using global sharding
[2023-07-27 09:29:04] [comm] NCCLCommunicators constructed successfully
[2023-07-27 09:29:04] [training] Using 1 GPUs
[2023-07-27 09:29:04] Training started
[2023-07-27 09:29:04] [data] Shuffling data
[2023-07-27 09:29:04] [data] Done reading 20,192 sentences
[2023-07-27 09:29:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:29:04] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 09:29:04] [memory] Reserving 332 MB, device gpu0
[2023-07-27 09:29:04] [memory] Reserving 332 MB, device gpu0
[2023-07-27 09:29:06] Parameter type float16, optimization type float32, casting types true
[2023-07-27 09:29:06] Allocating memory for general optimizer shards
[2023-07-27 09:29:06] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 09:29:06] Allocating memory for Adam-specific shards
[2023-07-27 09:29:06] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 09:32:22] Seen 20,192 samples
[2023-07-27 09:32:22] Starting data epoch 2 in logical epoch 2
[2023-07-27 09:32:22] [data] Shuffling data
[2023-07-27 09:32:22] [data] Done reading 20,192 sentences
[2023-07-27 09:32:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:35:57] Seen 20,192 samples
[2023-07-27 09:35:57] Starting data epoch 3 in logical epoch 3
[2023-07-27 09:35:57] [data] Shuffling data
[2023-07-27 09:35:57] [data] Done reading 20,192 sentences
[2023-07-27 09:35:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:39:40] Seen 20,192 samples
[2023-07-27 09:39:40] Starting data epoch 4 in logical epoch 4
[2023-07-27 09:39:40] [data] Shuffling data
[2023-07-27 09:39:40] [data] Done reading 20,192 sentences
[2023-07-27 09:39:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:43:35] Seen 20,192 samples
[2023-07-27 09:43:35] Starting data epoch 5 in logical epoch 5
[2023-07-27 09:43:35] [data] Shuffling data
[2023-07-27 09:43:35] [data] Done reading 20,192 sentences
[2023-07-27 09:43:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:47:37] Seen 20,192 samples
[2023-07-27 09:47:37] Starting data epoch 6 in logical epoch 6
[2023-07-27 09:47:37] [data] Shuffling data
[2023-07-27 09:47:37] [data] Done reading 20,192 sentences
[2023-07-27 09:47:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:51:25] Seen 20,192 samples
[2023-07-27 09:51:25] Starting data epoch 7 in logical epoch 7
[2023-07-27 09:51:25] [data] Shuffling data
[2023-07-27 09:51:25] [data] Done reading 20,192 sentences
[2023-07-27 09:51:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:54:58] Seen 20,192 samples
[2023-07-27 09:54:58] Starting data epoch 8 in logical epoch 8
[2023-07-27 09:54:58] [data] Shuffling data
[2023-07-27 09:54:58] [data] Done reading 20,192 sentences
[2023-07-27 09:54:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 09:58:30] Seen 20,192 samples
[2023-07-27 09:58:32] Starting data epoch 9 in logical epoch 9
[2023-07-27 09:58:32] [data] Shuffling data
[2023-07-27 09:58:33] [data] Done reading 20,192 sentences
[2023-07-27 09:58:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:02:02] Seen 20,192 samples
[2023-07-27 10:02:02] Starting data epoch 10 in logical epoch 10
[2023-07-27 10:02:02] [data] Shuffling data
[2023-07-27 10:02:02] [data] Done reading 20,192 sentences
[2023-07-27 10:02:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:05:30] Seen 20,192 samples
[2023-07-27 10:05:30] Starting data epoch 11 in logical epoch 11
[2023-07-27 10:05:30] Training finished
[2023-07-27 10:06:44] [valid] Ep. 11 : Up. 804 : translation : 0 : new best
[2023-07-27 10:06:44] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 10:06:52] Saving Adam parameters
[2023-07-27 10:06:54] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 10:07:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 10:07:12] [marian] Running on node05.datos.cluster.uy as process 36196 with command line:
[2023-07-27 10:07:12] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 10:07:12] [config] after: 0e
[2023-07-27 10:07:12] [config] after-batches: 0
[2023-07-27 10:07:12] [config] after-epochs: 20
[2023-07-27 10:07:12] [config] all-caps-every: 0
[2023-07-27 10:07:12] [config] allow-unk: false
[2023-07-27 10:07:12] [config] authors: false
[2023-07-27 10:07:12] [config] beam-size: 12
[2023-07-27 10:07:12] [config] bert-class-symbol: "[CLS]"
[2023-07-27 10:07:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 10:07:12] [config] bert-masking-fraction: 0.15
[2023-07-27 10:07:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 10:07:12] [config] bert-train-type-embeddings: true
[2023-07-27 10:07:12] [config] bert-type-vocab-size: 2
[2023-07-27 10:07:12] [config] build-info: ""
[2023-07-27 10:07:12] [config] check-gradient-nan: false
[2023-07-27 10:07:12] [config] check-nan: false
[2023-07-27 10:07:12] [config] cite: false
[2023-07-27 10:07:12] [config] clip-norm: 1
[2023-07-27 10:07:12] [config] cost-scaling:
[2023-07-27 10:07:12] [config]   - 256.f
[2023-07-27 10:07:12] [config]   - 1000
[2023-07-27 10:07:12] [config]   - 2.f
[2023-07-27 10:07:12] [config]   - 256.f
[2023-07-27 10:07:12] [config] cost-type: ce-sum
[2023-07-27 10:07:12] [config] cpu-threads: 0
[2023-07-27 10:07:12] [config] data-threads: 8
[2023-07-27 10:07:12] [config] data-weighting: ""
[2023-07-27 10:07:12] [config] data-weighting-type: sentence
[2023-07-27 10:07:12] [config] dec-cell: gru
[2023-07-27 10:07:12] [config] dec-cell-base-depth: 2
[2023-07-27 10:07:12] [config] dec-cell-high-depth: 1
[2023-07-27 10:07:12] [config] dec-depth: 8
[2023-07-27 10:07:12] [config] devices:
[2023-07-27 10:07:12] [config]   - 0
[2023-07-27 10:07:12] [config] dim-emb: 512
[2023-07-27 10:07:12] [config] dim-rnn: 1024
[2023-07-27 10:07:12] [config] dim-vocabs:
[2023-07-27 10:07:12] [config]   - 16384
[2023-07-27 10:07:12] [config]   - 16384
[2023-07-27 10:07:12] [config] disp-first: 0
[2023-07-27 10:07:12] [config] disp-freq: 1000u
[2023-07-27 10:07:12] [config] disp-label-counts: true
[2023-07-27 10:07:12] [config] dropout-rnn: 0
[2023-07-27 10:07:12] [config] dropout-src: 0
[2023-07-27 10:07:12] [config] dropout-trg: 0
[2023-07-27 10:07:12] [config] dump-config: ""
[2023-07-27 10:07:12] [config] dynamic-gradient-scaling:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] early-stopping: 1000
[2023-07-27 10:07:12] [config] early-stopping-on: first
[2023-07-27 10:07:12] [config] embedding-fix-src: false
[2023-07-27 10:07:12] [config] embedding-fix-trg: false
[2023-07-27 10:07:12] [config] embedding-normalization: false
[2023-07-27 10:07:12] [config] embedding-vectors:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] enc-cell: gru
[2023-07-27 10:07:12] [config] enc-cell-depth: 1
[2023-07-27 10:07:12] [config] enc-depth: 8
[2023-07-27 10:07:12] [config] enc-type: bidirectional
[2023-07-27 10:07:12] [config] english-title-case-every: 0
[2023-07-27 10:07:12] [config] exponential-smoothing: 0
[2023-07-27 10:07:12] [config] factor-weight: 1
[2023-07-27 10:07:12] [config] factors-combine: sum
[2023-07-27 10:07:12] [config] factors-dim-emb: 0
[2023-07-27 10:07:12] [config] gradient-checkpointing: false
[2023-07-27 10:07:12] [config] gradient-norm-average-window: 100
[2023-07-27 10:07:12] [config] guided-alignment: none
[2023-07-27 10:07:12] [config] guided-alignment-cost: mse
[2023-07-27 10:07:12] [config] guided-alignment-weight: 0.1
[2023-07-27 10:07:12] [config] ignore-model-config: false
[2023-07-27 10:07:12] [config] input-types:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] interpolate-env-vars: false
[2023-07-27 10:07:12] [config] keep-best: false
[2023-07-27 10:07:12] [config] label-smoothing: 0
[2023-07-27 10:07:12] [config] layer-normalization: false
[2023-07-27 10:07:12] [config] learn-rate: 0.0001
[2023-07-27 10:07:12] [config] lemma-dependency: ""
[2023-07-27 10:07:12] [config] lemma-dim-emb: 0
[2023-07-27 10:07:12] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 10:07:12] [config] log-level: info
[2023-07-27 10:07:12] [config] log-time-zone: ""
[2023-07-27 10:07:12] [config] logical-epoch:
[2023-07-27 10:07:12] [config]   - 1e
[2023-07-27 10:07:12] [config]   - 0
[2023-07-27 10:07:12] [config] lr-decay: 0
[2023-07-27 10:07:12] [config] lr-decay-freq: 50000
[2023-07-27 10:07:12] [config] lr-decay-inv-sqrt:
[2023-07-27 10:07:12] [config]   - 0
[2023-07-27 10:07:12] [config] lr-decay-repeat-warmup: false
[2023-07-27 10:07:12] [config] lr-decay-reset-optimizer: false
[2023-07-27 10:07:12] [config] lr-decay-start:
[2023-07-27 10:07:12] [config]   - 10
[2023-07-27 10:07:12] [config]   - 1
[2023-07-27 10:07:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 10:07:12] [config] lr-report: false
[2023-07-27 10:07:12] [config] lr-warmup: 0
[2023-07-27 10:07:12] [config] lr-warmup-at-reload: false
[2023-07-27 10:07:12] [config] lr-warmup-cycle: false
[2023-07-27 10:07:12] [config] lr-warmup-start-rate: 0
[2023-07-27 10:07:12] [config] max-length: 50
[2023-07-27 10:07:12] [config] max-length-crop: true
[2023-07-27 10:07:12] [config] max-length-factor: 3
[2023-07-27 10:07:12] [config] maxi-batch: 100
[2023-07-27 10:07:12] [config] maxi-batch-sort: trg
[2023-07-27 10:07:12] [config] mini-batch: 64
[2023-07-27 10:07:12] [config] mini-batch-fit: true
[2023-07-27 10:07:12] [config] mini-batch-fit-step: 10
[2023-07-27 10:07:12] [config] mini-batch-round-up: true
[2023-07-27 10:07:12] [config] mini-batch-track-lr: false
[2023-07-27 10:07:12] [config] mini-batch-warmup: 0
[2023-07-27 10:07:12] [config] mini-batch-words: 0
[2023-07-27 10:07:12] [config] mini-batch-words-ref: 0
[2023-07-27 10:07:12] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 10:07:12] [config] multi-loss-type: sum
[2023-07-27 10:07:12] [config] n-best: false
[2023-07-27 10:07:12] [config] no-nccl: false
[2023-07-27 10:07:12] [config] no-reload: false
[2023-07-27 10:07:12] [config] no-restore-corpus: false
[2023-07-27 10:07:12] [config] normalize: 0
[2023-07-27 10:07:12] [config] normalize-gradient: false
[2023-07-27 10:07:12] [config] num-devices: 0
[2023-07-27 10:07:12] [config] optimizer: adam
[2023-07-27 10:07:12] [config] optimizer-delay: 1
[2023-07-27 10:07:12] [config] optimizer-params:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] output-omit-bias: false
[2023-07-27 10:07:12] [config] overwrite: true
[2023-07-27 10:07:12] [config] precision:
[2023-07-27 10:07:12] [config]   - float16
[2023-07-27 10:07:12] [config]   - float32
[2023-07-27 10:07:12] [config] pretrained-model: ""
[2023-07-27 10:07:12] [config] quantize-biases: false
[2023-07-27 10:07:12] [config] quantize-bits: 0
[2023-07-27 10:07:12] [config] quantize-log-based: false
[2023-07-27 10:07:12] [config] quantize-optimization-steps: 0
[2023-07-27 10:07:12] [config] quiet: false
[2023-07-27 10:07:12] [config] quiet-translation: true
[2023-07-27 10:07:12] [config] relative-paths: false
[2023-07-27 10:07:12] [config] right-left: false
[2023-07-27 10:07:12] [config] save-freq: 10000u
[2023-07-27 10:07:12] [config] seed: 1234
[2023-07-27 10:07:12] [config] sentencepiece-alphas:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] sentencepiece-max-lines: 2000000
[2023-07-27 10:07:12] [config] sentencepiece-options: ""
[2023-07-27 10:07:12] [config] sharding: global
[2023-07-27 10:07:12] [config] shuffle: data
[2023-07-27 10:07:12] [config] shuffle-in-ram: false
[2023-07-27 10:07:12] [config] sigterm: save-and-exit
[2023-07-27 10:07:12] [config] skip: false
[2023-07-27 10:07:12] [config] sqlite: ""
[2023-07-27 10:07:12] [config] sqlite-drop: false
[2023-07-27 10:07:12] [config] sync-freq: 200u
[2023-07-27 10:07:12] [config] sync-sgd: false
[2023-07-27 10:07:12] [config] tempdir: /tmp
[2023-07-27 10:07:12] [config] tied-embeddings: false
[2023-07-27 10:07:12] [config] tied-embeddings-all: true
[2023-07-27 10:07:12] [config] tied-embeddings-src: false
[2023-07-27 10:07:12] [config] train-embedder-rank:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] train-sets:
[2023-07-27 10:07:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 10:07:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 10:07:12] [config] transformer-aan-activation: swish
[2023-07-27 10:07:12] [config] transformer-aan-depth: 2
[2023-07-27 10:07:12] [config] transformer-aan-nogate: false
[2023-07-27 10:07:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 10:07:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 10:07:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 10:07:12] [config] transformer-depth-scaling: false
[2023-07-27 10:07:12] [config] transformer-dim-aan: 2048
[2023-07-27 10:07:12] [config] transformer-dim-ffn: 2048
[2023-07-27 10:07:12] [config] transformer-dropout: 0
[2023-07-27 10:07:12] [config] transformer-dropout-attention: 0
[2023-07-27 10:07:12] [config] transformer-dropout-ffn: 0
[2023-07-27 10:07:12] [config] transformer-ffn-activation: swish
[2023-07-27 10:07:12] [config] transformer-ffn-depth: 2
[2023-07-27 10:07:12] [config] transformer-guided-alignment-layer: last
[2023-07-27 10:07:12] [config] transformer-heads: 8
[2023-07-27 10:07:12] [config] transformer-no-projection: false
[2023-07-27 10:07:12] [config] transformer-pool: false
[2023-07-27 10:07:12] [config] transformer-postprocess: dan
[2023-07-27 10:07:12] [config] transformer-postprocess-emb: d
[2023-07-27 10:07:12] [config] transformer-postprocess-top: ""
[2023-07-27 10:07:12] [config] transformer-preprocess: ""
[2023-07-27 10:07:12] [config] transformer-tied-layers:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] transformer-train-position-embeddings: false
[2023-07-27 10:07:12] [config] tsv: false
[2023-07-27 10:07:12] [config] tsv-fields: 0
[2023-07-27 10:07:12] [config] type: s2s
[2023-07-27 10:07:12] [config] ulr: false
[2023-07-27 10:07:12] [config] ulr-dim-emb: 0
[2023-07-27 10:07:12] [config] ulr-dropout: 0
[2023-07-27 10:07:12] [config] ulr-keys-vectors: ""
[2023-07-27 10:07:12] [config] ulr-query-vectors: ""
[2023-07-27 10:07:12] [config] ulr-softmax-temperature: 1
[2023-07-27 10:07:12] [config] ulr-trainable-transformation: false
[2023-07-27 10:07:12] [config] unlikelihood-loss: false
[2023-07-27 10:07:12] [config] valid-freq: 50000000
[2023-07-27 10:07:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 10:07:12] [config] valid-max-length: 1000
[2023-07-27 10:07:12] [config] valid-metrics:
[2023-07-27 10:07:12] [config]   - translation
[2023-07-27 10:07:12] [config] valid-mini-batch: 32
[2023-07-27 10:07:12] [config] valid-reset-stalled: false
[2023-07-27 10:07:12] [config] valid-script-args:
[2023-07-27 10:07:12] [config]   []
[2023-07-27 10:07:12] [config] valid-script-path: ""
[2023-07-27 10:07:12] [config] valid-sets:
[2023-07-27 10:07:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 10:07:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 10:07:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 10:07:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 10:07:12] [config] vocabs:
[2023-07-27 10:07:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 10:07:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 10:07:12] [config] word-penalty: 0
[2023-07-27 10:07:12] [config] word-scores: false
[2023-07-27 10:07:12] [config] workspace: 5500
[2023-07-27 10:07:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 10:07:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 10:07:12] [training] Using single-device training
[2023-07-27 10:07:13] Synced seed 1234
[2023-07-27 10:07:13] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 10:07:13] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 10:07:13] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 10:07:13] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 10:07:13] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 10:07:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 10:07:13] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 10:07:14] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 10:07:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 10:07:14] [comm] Using global sharding
[2023-07-27 10:07:14] [comm] NCCLCommunicators constructed successfully
[2023-07-27 10:07:14] [training] Using 1 GPUs
[2023-07-27 10:07:14] [logits] Applying loss function for 1 factor(s)
[2023-07-27 10:07:14] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:07:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 10:07:15] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:08:48] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 10:08:48] [valid] No post-processing script given for validating translator
[2023-07-27 10:08:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 10:08:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 10:08:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 10:08:48] [comm] Using global sharding
[2023-07-27 10:08:48] [comm] NCCLCommunicators constructed successfully
[2023-07-27 10:08:48] [training] Using 1 GPUs
[2023-07-27 10:08:48] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 10:08:53] Allocating memory for general optimizer shards
[2023-07-27 10:08:53] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 10:08:53] Loading Adam parameters
[2023-07-27 10:08:54] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 10:08:54] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:08:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 10:08:56] [data] Restoring the corpus state to epoch 11, batch 804
[2023-07-27 10:08:56] [data] Shuffling data
[2023-07-27 10:08:56] [data] Done reading 20,192 sentences
[2023-07-27 10:08:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:08:56] Training started
[2023-07-27 10:08:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 10:08:56] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:08:58] Parameter type float16, optimization type float32, casting types true
[2023-07-27 10:12:27] Seen 20,192 samples
[2023-07-27 10:12:27] Starting data epoch 12 in logical epoch 12
[2023-07-27 10:12:27] [data] Shuffling data
[2023-07-27 10:12:27] [data] Done reading 20,192 sentences
[2023-07-27 10:12:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:15:58] Seen 20,192 samples
[2023-07-27 10:15:58] Starting data epoch 13 in logical epoch 13
[2023-07-27 10:15:58] [data] Shuffling data
[2023-07-27 10:15:58] [data] Done reading 20,192 sentences
[2023-07-27 10:15:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:17:25] Ep. 13 : Up. 1000 : Sen. 8,618 : Cost 6.44551086 * 7,038,979 @ 5,474 after 7,038,979 : Time 517.11s : 13612.16 words/s : gNorm 1.2634
[2023-07-27 10:19:29] Seen 20,192 samples
[2023-07-27 10:19:29] Starting data epoch 14 in logical epoch 14
[2023-07-27 10:19:29] [data] Shuffling data
[2023-07-27 10:19:29] [data] Done reading 20,192 sentences
[2023-07-27 10:19:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:22:59] Seen 20,192 samples
[2023-07-27 10:22:59] Starting data epoch 15 in logical epoch 15
[2023-07-27 10:22:59] [data] Shuffling data
[2023-07-27 10:22:59] [data] Done reading 20,192 sentences
[2023-07-27 10:22:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:26:30] Seen 20,192 samples
[2023-07-27 10:26:30] Starting data epoch 16 in logical epoch 16
[2023-07-27 10:26:30] [data] Shuffling data
[2023-07-27 10:26:30] [data] Done reading 20,192 sentences
[2023-07-27 10:26:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:30:01] Seen 20,192 samples
[2023-07-27 10:30:01] Starting data epoch 17 in logical epoch 17
[2023-07-27 10:30:01] [data] Shuffling data
[2023-07-27 10:30:01] [data] Done reading 20,192 sentences
[2023-07-27 10:30:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:33:32] Seen 20,192 samples
[2023-07-27 10:33:32] Starting data epoch 18 in logical epoch 18
[2023-07-27 10:33:32] [data] Shuffling data
[2023-07-27 10:33:32] [data] Done reading 20,192 sentences
[2023-07-27 10:33:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:37:02] Seen 20,192 samples
[2023-07-27 10:37:02] Starting data epoch 19 in logical epoch 19
[2023-07-27 10:37:02] [data] Shuffling data
[2023-07-27 10:37:02] [data] Done reading 20,192 sentences
[2023-07-27 10:37:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:40:29] Seen 20,192 samples
[2023-07-27 10:40:29] Starting data epoch 20 in logical epoch 20
[2023-07-27 10:40:29] [data] Shuffling data
[2023-07-27 10:40:29] [data] Done reading 20,192 sentences
[2023-07-27 10:40:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:43:56] Seen 20,192 samples
[2023-07-27 10:43:56] Starting data epoch 21 in logical epoch 21
[2023-07-27 10:43:56] Training finished
[2023-07-27 10:45:11] [valid] Ep. 21 : Up. 1609 : translation : 0 : new best
[2023-07-27 10:45:11] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 10:45:18] Saving Adam parameters
[2023-07-27 10:45:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 10:45:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 10:45:38] [marian] Running on node05.datos.cluster.uy as process 38587 with command line:
[2023-07-27 10:45:38] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 10:45:38] [config] after: 0e
[2023-07-27 10:45:38] [config] after-batches: 0
[2023-07-27 10:45:38] [config] after-epochs: 30
[2023-07-27 10:45:38] [config] all-caps-every: 0
[2023-07-27 10:45:38] [config] allow-unk: false
[2023-07-27 10:45:38] [config] authors: false
[2023-07-27 10:45:38] [config] beam-size: 12
[2023-07-27 10:45:38] [config] bert-class-symbol: "[CLS]"
[2023-07-27 10:45:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 10:45:38] [config] bert-masking-fraction: 0.15
[2023-07-27 10:45:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 10:45:38] [config] bert-train-type-embeddings: true
[2023-07-27 10:45:38] [config] bert-type-vocab-size: 2
[2023-07-27 10:45:38] [config] build-info: ""
[2023-07-27 10:45:38] [config] check-gradient-nan: false
[2023-07-27 10:45:38] [config] check-nan: false
[2023-07-27 10:45:38] [config] cite: false
[2023-07-27 10:45:38] [config] clip-norm: 1
[2023-07-27 10:45:38] [config] cost-scaling:
[2023-07-27 10:45:38] [config]   - 256.f
[2023-07-27 10:45:38] [config]   - 1000
[2023-07-27 10:45:38] [config]   - 2.f
[2023-07-27 10:45:38] [config]   - 256.f
[2023-07-27 10:45:38] [config] cost-type: ce-sum
[2023-07-27 10:45:38] [config] cpu-threads: 0
[2023-07-27 10:45:38] [config] data-threads: 8
[2023-07-27 10:45:38] [config] data-weighting: ""
[2023-07-27 10:45:38] [config] data-weighting-type: sentence
[2023-07-27 10:45:38] [config] dec-cell: gru
[2023-07-27 10:45:38] [config] dec-cell-base-depth: 2
[2023-07-27 10:45:38] [config] dec-cell-high-depth: 1
[2023-07-27 10:45:38] [config] dec-depth: 8
[2023-07-27 10:45:38] [config] devices:
[2023-07-27 10:45:38] [config]   - 0
[2023-07-27 10:45:38] [config] dim-emb: 512
[2023-07-27 10:45:38] [config] dim-rnn: 1024
[2023-07-27 10:45:38] [config] dim-vocabs:
[2023-07-27 10:45:38] [config]   - 16384
[2023-07-27 10:45:38] [config]   - 16384
[2023-07-27 10:45:38] [config] disp-first: 0
[2023-07-27 10:45:38] [config] disp-freq: 1000u
[2023-07-27 10:45:38] [config] disp-label-counts: true
[2023-07-27 10:45:38] [config] dropout-rnn: 0
[2023-07-27 10:45:38] [config] dropout-src: 0
[2023-07-27 10:45:38] [config] dropout-trg: 0
[2023-07-27 10:45:38] [config] dump-config: ""
[2023-07-27 10:45:38] [config] dynamic-gradient-scaling:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] early-stopping: 1000
[2023-07-27 10:45:38] [config] early-stopping-on: first
[2023-07-27 10:45:38] [config] embedding-fix-src: false
[2023-07-27 10:45:38] [config] embedding-fix-trg: false
[2023-07-27 10:45:38] [config] embedding-normalization: false
[2023-07-27 10:45:38] [config] embedding-vectors:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] enc-cell: gru
[2023-07-27 10:45:38] [config] enc-cell-depth: 1
[2023-07-27 10:45:38] [config] enc-depth: 8
[2023-07-27 10:45:38] [config] enc-type: bidirectional
[2023-07-27 10:45:38] [config] english-title-case-every: 0
[2023-07-27 10:45:38] [config] exponential-smoothing: 0
[2023-07-27 10:45:38] [config] factor-weight: 1
[2023-07-27 10:45:38] [config] factors-combine: sum
[2023-07-27 10:45:38] [config] factors-dim-emb: 0
[2023-07-27 10:45:38] [config] gradient-checkpointing: false
[2023-07-27 10:45:38] [config] gradient-norm-average-window: 100
[2023-07-27 10:45:38] [config] guided-alignment: none
[2023-07-27 10:45:38] [config] guided-alignment-cost: mse
[2023-07-27 10:45:38] [config] guided-alignment-weight: 0.1
[2023-07-27 10:45:38] [config] ignore-model-config: false
[2023-07-27 10:45:38] [config] input-types:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] interpolate-env-vars: false
[2023-07-27 10:45:38] [config] keep-best: false
[2023-07-27 10:45:38] [config] label-smoothing: 0
[2023-07-27 10:45:38] [config] layer-normalization: false
[2023-07-27 10:45:38] [config] learn-rate: 0.0001
[2023-07-27 10:45:38] [config] lemma-dependency: ""
[2023-07-27 10:45:38] [config] lemma-dim-emb: 0
[2023-07-27 10:45:38] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 10:45:38] [config] log-level: info
[2023-07-27 10:45:38] [config] log-time-zone: ""
[2023-07-27 10:45:38] [config] logical-epoch:
[2023-07-27 10:45:38] [config]   - 1e
[2023-07-27 10:45:38] [config]   - 0
[2023-07-27 10:45:38] [config] lr-decay: 0
[2023-07-27 10:45:38] [config] lr-decay-freq: 50000
[2023-07-27 10:45:38] [config] lr-decay-inv-sqrt:
[2023-07-27 10:45:38] [config]   - 0
[2023-07-27 10:45:38] [config] lr-decay-repeat-warmup: false
[2023-07-27 10:45:38] [config] lr-decay-reset-optimizer: false
[2023-07-27 10:45:38] [config] lr-decay-start:
[2023-07-27 10:45:38] [config]   - 10
[2023-07-27 10:45:38] [config]   - 1
[2023-07-27 10:45:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 10:45:38] [config] lr-report: false
[2023-07-27 10:45:38] [config] lr-warmup: 0
[2023-07-27 10:45:38] [config] lr-warmup-at-reload: false
[2023-07-27 10:45:38] [config] lr-warmup-cycle: false
[2023-07-27 10:45:38] [config] lr-warmup-start-rate: 0
[2023-07-27 10:45:38] [config] max-length: 50
[2023-07-27 10:45:38] [config] max-length-crop: true
[2023-07-27 10:45:38] [config] max-length-factor: 3
[2023-07-27 10:45:38] [config] maxi-batch: 100
[2023-07-27 10:45:38] [config] maxi-batch-sort: trg
[2023-07-27 10:45:38] [config] mini-batch: 64
[2023-07-27 10:45:38] [config] mini-batch-fit: true
[2023-07-27 10:45:38] [config] mini-batch-fit-step: 10
[2023-07-27 10:45:38] [config] mini-batch-round-up: true
[2023-07-27 10:45:38] [config] mini-batch-track-lr: false
[2023-07-27 10:45:38] [config] mini-batch-warmup: 0
[2023-07-27 10:45:38] [config] mini-batch-words: 0
[2023-07-27 10:45:38] [config] mini-batch-words-ref: 0
[2023-07-27 10:45:38] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 10:45:38] [config] multi-loss-type: sum
[2023-07-27 10:45:38] [config] n-best: false
[2023-07-27 10:45:38] [config] no-nccl: false
[2023-07-27 10:45:38] [config] no-reload: false
[2023-07-27 10:45:38] [config] no-restore-corpus: false
[2023-07-27 10:45:38] [config] normalize: 0
[2023-07-27 10:45:38] [config] normalize-gradient: false
[2023-07-27 10:45:38] [config] num-devices: 0
[2023-07-27 10:45:38] [config] optimizer: adam
[2023-07-27 10:45:38] [config] optimizer-delay: 1
[2023-07-27 10:45:38] [config] optimizer-params:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] output-omit-bias: false
[2023-07-27 10:45:38] [config] overwrite: true
[2023-07-27 10:45:38] [config] precision:
[2023-07-27 10:45:38] [config]   - float16
[2023-07-27 10:45:38] [config]   - float32
[2023-07-27 10:45:38] [config] pretrained-model: ""
[2023-07-27 10:45:38] [config] quantize-biases: false
[2023-07-27 10:45:38] [config] quantize-bits: 0
[2023-07-27 10:45:38] [config] quantize-log-based: false
[2023-07-27 10:45:38] [config] quantize-optimization-steps: 0
[2023-07-27 10:45:38] [config] quiet: false
[2023-07-27 10:45:38] [config] quiet-translation: true
[2023-07-27 10:45:38] [config] relative-paths: false
[2023-07-27 10:45:38] [config] right-left: false
[2023-07-27 10:45:38] [config] save-freq: 10000u
[2023-07-27 10:45:38] [config] seed: 1234
[2023-07-27 10:45:38] [config] sentencepiece-alphas:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] sentencepiece-max-lines: 2000000
[2023-07-27 10:45:38] [config] sentencepiece-options: ""
[2023-07-27 10:45:38] [config] sharding: global
[2023-07-27 10:45:38] [config] shuffle: data
[2023-07-27 10:45:38] [config] shuffle-in-ram: false
[2023-07-27 10:45:38] [config] sigterm: save-and-exit
[2023-07-27 10:45:38] [config] skip: false
[2023-07-27 10:45:38] [config] sqlite: ""
[2023-07-27 10:45:38] [config] sqlite-drop: false
[2023-07-27 10:45:38] [config] sync-freq: 200u
[2023-07-27 10:45:38] [config] sync-sgd: false
[2023-07-27 10:45:38] [config] tempdir: /tmp
[2023-07-27 10:45:38] [config] tied-embeddings: false
[2023-07-27 10:45:38] [config] tied-embeddings-all: true
[2023-07-27 10:45:38] [config] tied-embeddings-src: false
[2023-07-27 10:45:38] [config] train-embedder-rank:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] train-sets:
[2023-07-27 10:45:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 10:45:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 10:45:38] [config] transformer-aan-activation: swish
[2023-07-27 10:45:38] [config] transformer-aan-depth: 2
[2023-07-27 10:45:38] [config] transformer-aan-nogate: false
[2023-07-27 10:45:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 10:45:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 10:45:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 10:45:38] [config] transformer-depth-scaling: false
[2023-07-27 10:45:38] [config] transformer-dim-aan: 2048
[2023-07-27 10:45:38] [config] transformer-dim-ffn: 2048
[2023-07-27 10:45:38] [config] transformer-dropout: 0
[2023-07-27 10:45:38] [config] transformer-dropout-attention: 0
[2023-07-27 10:45:38] [config] transformer-dropout-ffn: 0
[2023-07-27 10:45:38] [config] transformer-ffn-activation: swish
[2023-07-27 10:45:38] [config] transformer-ffn-depth: 2
[2023-07-27 10:45:38] [config] transformer-guided-alignment-layer: last
[2023-07-27 10:45:38] [config] transformer-heads: 8
[2023-07-27 10:45:38] [config] transformer-no-projection: false
[2023-07-27 10:45:38] [config] transformer-pool: false
[2023-07-27 10:45:38] [config] transformer-postprocess: dan
[2023-07-27 10:45:38] [config] transformer-postprocess-emb: d
[2023-07-27 10:45:38] [config] transformer-postprocess-top: ""
[2023-07-27 10:45:38] [config] transformer-preprocess: ""
[2023-07-27 10:45:38] [config] transformer-tied-layers:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] transformer-train-position-embeddings: false
[2023-07-27 10:45:38] [config] tsv: false
[2023-07-27 10:45:38] [config] tsv-fields: 0
[2023-07-27 10:45:38] [config] type: s2s
[2023-07-27 10:45:38] [config] ulr: false
[2023-07-27 10:45:38] [config] ulr-dim-emb: 0
[2023-07-27 10:45:38] [config] ulr-dropout: 0
[2023-07-27 10:45:38] [config] ulr-keys-vectors: ""
[2023-07-27 10:45:38] [config] ulr-query-vectors: ""
[2023-07-27 10:45:38] [config] ulr-softmax-temperature: 1
[2023-07-27 10:45:38] [config] ulr-trainable-transformation: false
[2023-07-27 10:45:38] [config] unlikelihood-loss: false
[2023-07-27 10:45:38] [config] valid-freq: 50000000
[2023-07-27 10:45:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 10:45:38] [config] valid-max-length: 1000
[2023-07-27 10:45:38] [config] valid-metrics:
[2023-07-27 10:45:38] [config]   - translation
[2023-07-27 10:45:38] [config] valid-mini-batch: 32
[2023-07-27 10:45:38] [config] valid-reset-stalled: false
[2023-07-27 10:45:38] [config] valid-script-args:
[2023-07-27 10:45:38] [config]   []
[2023-07-27 10:45:38] [config] valid-script-path: ""
[2023-07-27 10:45:38] [config] valid-sets:
[2023-07-27 10:45:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 10:45:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 10:45:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 10:45:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 10:45:38] [config] vocabs:
[2023-07-27 10:45:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 10:45:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 10:45:38] [config] word-penalty: 0
[2023-07-27 10:45:38] [config] word-scores: false
[2023-07-27 10:45:38] [config] workspace: 5500
[2023-07-27 10:45:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 10:45:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 10:45:38] [training] Using single-device training
[2023-07-27 10:45:38] Synced seed 1234
[2023-07-27 10:45:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 10:45:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 10:45:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 10:45:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 10:45:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 10:45:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 10:45:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 10:45:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 10:45:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 10:45:39] [comm] Using global sharding
[2023-07-27 10:45:39] [comm] NCCLCommunicators constructed successfully
[2023-07-27 10:45:39] [training] Using 1 GPUs
[2023-07-27 10:45:39] [logits] Applying loss function for 1 factor(s)
[2023-07-27 10:45:39] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:45:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 10:45:40] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:47:12] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 10:47:12] [valid] No post-processing script given for validating translator
[2023-07-27 10:47:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 10:47:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 10:47:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 10:47:12] [comm] Using global sharding
[2023-07-27 10:47:12] [comm] NCCLCommunicators constructed successfully
[2023-07-27 10:47:12] [training] Using 1 GPUs
[2023-07-27 10:47:12] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 10:47:16] Allocating memory for general optimizer shards
[2023-07-27 10:47:16] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 10:47:16] Loading Adam parameters
[2023-07-27 10:47:17] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 10:47:17] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:47:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 10:47:19] [data] Restoring the corpus state to epoch 21, batch 1609
[2023-07-27 10:47:19] [data] Shuffling data
[2023-07-27 10:47:19] [data] Done reading 20,192 sentences
[2023-07-27 10:47:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:47:19] Training started
[2023-07-27 10:47:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 10:47:19] [memory] Reserving 332 MB, device gpu0
[2023-07-27 10:47:21] Parameter type float16, optimization type float32, casting types true
[2023-07-27 10:50:43] Seen 20,192 samples
[2023-07-27 10:50:43] Starting data epoch 22 in logical epoch 22
[2023-07-27 10:50:43] [data] Shuffling data
[2023-07-27 10:50:43] [data] Done reading 20,192 sentences
[2023-07-27 10:50:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:54:11] Seen 20,192 samples
[2023-07-27 10:54:11] Starting data epoch 23 in logical epoch 23
[2023-07-27 10:54:11] [data] Shuffling data
[2023-07-27 10:54:11] [data] Done reading 20,192 sentences
[2023-07-27 10:54:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 10:57:39] Seen 20,192 samples
[2023-07-27 10:57:39] Starting data epoch 24 in logical epoch 24
[2023-07-27 10:57:39] [data] Shuffling data
[2023-07-27 10:57:39] [data] Done reading 20,192 sentences
[2023-07-27 10:57:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:01:07] Seen 20,192 samples
[2023-07-27 11:01:07] Starting data epoch 25 in logical epoch 25
[2023-07-27 11:01:07] [data] Shuffling data
[2023-07-27 11:01:07] [data] Done reading 20,192 sentences
[2023-07-27 11:01:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:04:08] Ep. 25 : Up. 2000 : Sen. 18,065 : Cost 5.49825478 * 7,074,605 @ 5,377 after 14,113,584 : Time 1016.12s : 6962.36 words/s : gNorm 1.8892
[2023-07-27 11:04:31] Seen 20,192 samples
[2023-07-27 11:04:31] Starting data epoch 26 in logical epoch 26
[2023-07-27 11:04:31] [data] Shuffling data
[2023-07-27 11:04:31] [data] Done reading 20,192 sentences
[2023-07-27 11:04:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:07:59] Seen 20,192 samples
[2023-07-27 11:07:59] Starting data epoch 27 in logical epoch 27
[2023-07-27 11:07:59] [data] Shuffling data
[2023-07-27 11:07:59] [data] Done reading 20,192 sentences
[2023-07-27 11:07:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:11:25] Seen 20,192 samples
[2023-07-27 11:11:25] Starting data epoch 28 in logical epoch 28
[2023-07-27 11:11:25] [data] Shuffling data
[2023-07-27 11:11:25] [data] Done reading 20,192 sentences
[2023-07-27 11:11:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:14:52] Seen 20,192 samples
[2023-07-27 11:14:52] Starting data epoch 29 in logical epoch 29
[2023-07-27 11:14:52] [data] Shuffling data
[2023-07-27 11:14:52] [data] Done reading 20,192 sentences
[2023-07-27 11:14:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:18:16] Seen 20,192 samples
[2023-07-27 11:18:16] Starting data epoch 30 in logical epoch 30
[2023-07-27 11:18:16] [data] Shuffling data
[2023-07-27 11:18:16] [data] Done reading 20,192 sentences
[2023-07-27 11:18:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:21:42] Seen 20,192 samples
[2023-07-27 11:21:42] Starting data epoch 31 in logical epoch 31
[2023-07-27 11:21:42] Training finished
[2023-07-27 11:22:57] [valid] Ep. 31 : Up. 2414 : translation : 0 : new best
[2023-07-27 11:22:57] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 11:23:04] Saving Adam parameters
[2023-07-27 11:23:05] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 11:23:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 11:23:24] [marian] Running on node05.datos.cluster.uy as process 639 with command line:
[2023-07-27 11:23:24] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 11:23:24] [config] after: 0e
[2023-07-27 11:23:24] [config] after-batches: 0
[2023-07-27 11:23:24] [config] after-epochs: 40
[2023-07-27 11:23:24] [config] all-caps-every: 0
[2023-07-27 11:23:24] [config] allow-unk: false
[2023-07-27 11:23:24] [config] authors: false
[2023-07-27 11:23:24] [config] beam-size: 12
[2023-07-27 11:23:24] [config] bert-class-symbol: "[CLS]"
[2023-07-27 11:23:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 11:23:24] [config] bert-masking-fraction: 0.15
[2023-07-27 11:23:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 11:23:24] [config] bert-train-type-embeddings: true
[2023-07-27 11:23:24] [config] bert-type-vocab-size: 2
[2023-07-27 11:23:24] [config] build-info: ""
[2023-07-27 11:23:24] [config] check-gradient-nan: false
[2023-07-27 11:23:24] [config] check-nan: false
[2023-07-27 11:23:24] [config] cite: false
[2023-07-27 11:23:24] [config] clip-norm: 1
[2023-07-27 11:23:24] [config] cost-scaling:
[2023-07-27 11:23:24] [config]   - 256.f
[2023-07-27 11:23:24] [config]   - 1000
[2023-07-27 11:23:24] [config]   - 2.f
[2023-07-27 11:23:24] [config]   - 256.f
[2023-07-27 11:23:24] [config] cost-type: ce-sum
[2023-07-27 11:23:24] [config] cpu-threads: 0
[2023-07-27 11:23:24] [config] data-threads: 8
[2023-07-27 11:23:24] [config] data-weighting: ""
[2023-07-27 11:23:24] [config] data-weighting-type: sentence
[2023-07-27 11:23:24] [config] dec-cell: gru
[2023-07-27 11:23:24] [config] dec-cell-base-depth: 2
[2023-07-27 11:23:24] [config] dec-cell-high-depth: 1
[2023-07-27 11:23:24] [config] dec-depth: 8
[2023-07-27 11:23:24] [config] devices:
[2023-07-27 11:23:24] [config]   - 0
[2023-07-27 11:23:24] [config] dim-emb: 512
[2023-07-27 11:23:24] [config] dim-rnn: 1024
[2023-07-27 11:23:24] [config] dim-vocabs:
[2023-07-27 11:23:24] [config]   - 16384
[2023-07-27 11:23:24] [config]   - 16384
[2023-07-27 11:23:24] [config] disp-first: 0
[2023-07-27 11:23:24] [config] disp-freq: 1000u
[2023-07-27 11:23:24] [config] disp-label-counts: true
[2023-07-27 11:23:24] [config] dropout-rnn: 0
[2023-07-27 11:23:24] [config] dropout-src: 0
[2023-07-27 11:23:24] [config] dropout-trg: 0
[2023-07-27 11:23:24] [config] dump-config: ""
[2023-07-27 11:23:24] [config] dynamic-gradient-scaling:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] early-stopping: 1000
[2023-07-27 11:23:24] [config] early-stopping-on: first
[2023-07-27 11:23:24] [config] embedding-fix-src: false
[2023-07-27 11:23:24] [config] embedding-fix-trg: false
[2023-07-27 11:23:24] [config] embedding-normalization: false
[2023-07-27 11:23:24] [config] embedding-vectors:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] enc-cell: gru
[2023-07-27 11:23:24] [config] enc-cell-depth: 1
[2023-07-27 11:23:24] [config] enc-depth: 8
[2023-07-27 11:23:24] [config] enc-type: bidirectional
[2023-07-27 11:23:24] [config] english-title-case-every: 0
[2023-07-27 11:23:24] [config] exponential-smoothing: 0
[2023-07-27 11:23:24] [config] factor-weight: 1
[2023-07-27 11:23:24] [config] factors-combine: sum
[2023-07-27 11:23:24] [config] factors-dim-emb: 0
[2023-07-27 11:23:24] [config] gradient-checkpointing: false
[2023-07-27 11:23:24] [config] gradient-norm-average-window: 100
[2023-07-27 11:23:24] [config] guided-alignment: none
[2023-07-27 11:23:24] [config] guided-alignment-cost: mse
[2023-07-27 11:23:24] [config] guided-alignment-weight: 0.1
[2023-07-27 11:23:24] [config] ignore-model-config: false
[2023-07-27 11:23:24] [config] input-types:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] interpolate-env-vars: false
[2023-07-27 11:23:24] [config] keep-best: false
[2023-07-27 11:23:24] [config] label-smoothing: 0
[2023-07-27 11:23:24] [config] layer-normalization: false
[2023-07-27 11:23:24] [config] learn-rate: 0.0001
[2023-07-27 11:23:24] [config] lemma-dependency: ""
[2023-07-27 11:23:24] [config] lemma-dim-emb: 0
[2023-07-27 11:23:24] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 11:23:24] [config] log-level: info
[2023-07-27 11:23:24] [config] log-time-zone: ""
[2023-07-27 11:23:24] [config] logical-epoch:
[2023-07-27 11:23:24] [config]   - 1e
[2023-07-27 11:23:24] [config]   - 0
[2023-07-27 11:23:24] [config] lr-decay: 0
[2023-07-27 11:23:24] [config] lr-decay-freq: 50000
[2023-07-27 11:23:24] [config] lr-decay-inv-sqrt:
[2023-07-27 11:23:24] [config]   - 0
[2023-07-27 11:23:24] [config] lr-decay-repeat-warmup: false
[2023-07-27 11:23:24] [config] lr-decay-reset-optimizer: false
[2023-07-27 11:23:24] [config] lr-decay-start:
[2023-07-27 11:23:24] [config]   - 10
[2023-07-27 11:23:24] [config]   - 1
[2023-07-27 11:23:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 11:23:24] [config] lr-report: false
[2023-07-27 11:23:24] [config] lr-warmup: 0
[2023-07-27 11:23:24] [config] lr-warmup-at-reload: false
[2023-07-27 11:23:24] [config] lr-warmup-cycle: false
[2023-07-27 11:23:24] [config] lr-warmup-start-rate: 0
[2023-07-27 11:23:24] [config] max-length: 50
[2023-07-27 11:23:24] [config] max-length-crop: true
[2023-07-27 11:23:24] [config] max-length-factor: 3
[2023-07-27 11:23:24] [config] maxi-batch: 100
[2023-07-27 11:23:24] [config] maxi-batch-sort: trg
[2023-07-27 11:23:24] [config] mini-batch: 64
[2023-07-27 11:23:24] [config] mini-batch-fit: true
[2023-07-27 11:23:24] [config] mini-batch-fit-step: 10
[2023-07-27 11:23:24] [config] mini-batch-round-up: true
[2023-07-27 11:23:24] [config] mini-batch-track-lr: false
[2023-07-27 11:23:24] [config] mini-batch-warmup: 0
[2023-07-27 11:23:24] [config] mini-batch-words: 0
[2023-07-27 11:23:24] [config] mini-batch-words-ref: 0
[2023-07-27 11:23:24] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 11:23:24] [config] multi-loss-type: sum
[2023-07-27 11:23:24] [config] n-best: false
[2023-07-27 11:23:24] [config] no-nccl: false
[2023-07-27 11:23:24] [config] no-reload: false
[2023-07-27 11:23:24] [config] no-restore-corpus: false
[2023-07-27 11:23:24] [config] normalize: 0
[2023-07-27 11:23:24] [config] normalize-gradient: false
[2023-07-27 11:23:24] [config] num-devices: 0
[2023-07-27 11:23:24] [config] optimizer: adam
[2023-07-27 11:23:24] [config] optimizer-delay: 1
[2023-07-27 11:23:24] [config] optimizer-params:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] output-omit-bias: false
[2023-07-27 11:23:24] [config] overwrite: true
[2023-07-27 11:23:24] [config] precision:
[2023-07-27 11:23:24] [config]   - float16
[2023-07-27 11:23:24] [config]   - float32
[2023-07-27 11:23:24] [config] pretrained-model: ""
[2023-07-27 11:23:24] [config] quantize-biases: false
[2023-07-27 11:23:24] [config] quantize-bits: 0
[2023-07-27 11:23:24] [config] quantize-log-based: false
[2023-07-27 11:23:24] [config] quantize-optimization-steps: 0
[2023-07-27 11:23:24] [config] quiet: false
[2023-07-27 11:23:24] [config] quiet-translation: true
[2023-07-27 11:23:24] [config] relative-paths: false
[2023-07-27 11:23:24] [config] right-left: false
[2023-07-27 11:23:24] [config] save-freq: 10000u
[2023-07-27 11:23:24] [config] seed: 1234
[2023-07-27 11:23:24] [config] sentencepiece-alphas:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] sentencepiece-max-lines: 2000000
[2023-07-27 11:23:24] [config] sentencepiece-options: ""
[2023-07-27 11:23:24] [config] sharding: global
[2023-07-27 11:23:24] [config] shuffle: data
[2023-07-27 11:23:24] [config] shuffle-in-ram: false
[2023-07-27 11:23:24] [config] sigterm: save-and-exit
[2023-07-27 11:23:24] [config] skip: false
[2023-07-27 11:23:24] [config] sqlite: ""
[2023-07-27 11:23:24] [config] sqlite-drop: false
[2023-07-27 11:23:24] [config] sync-freq: 200u
[2023-07-27 11:23:24] [config] sync-sgd: false
[2023-07-27 11:23:24] [config] tempdir: /tmp
[2023-07-27 11:23:24] [config] tied-embeddings: false
[2023-07-27 11:23:24] [config] tied-embeddings-all: true
[2023-07-27 11:23:24] [config] tied-embeddings-src: false
[2023-07-27 11:23:24] [config] train-embedder-rank:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] train-sets:
[2023-07-27 11:23:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 11:23:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 11:23:24] [config] transformer-aan-activation: swish
[2023-07-27 11:23:24] [config] transformer-aan-depth: 2
[2023-07-27 11:23:24] [config] transformer-aan-nogate: false
[2023-07-27 11:23:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 11:23:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 11:23:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 11:23:24] [config] transformer-depth-scaling: false
[2023-07-27 11:23:24] [config] transformer-dim-aan: 2048
[2023-07-27 11:23:24] [config] transformer-dim-ffn: 2048
[2023-07-27 11:23:24] [config] transformer-dropout: 0
[2023-07-27 11:23:24] [config] transformer-dropout-attention: 0
[2023-07-27 11:23:24] [config] transformer-dropout-ffn: 0
[2023-07-27 11:23:24] [config] transformer-ffn-activation: swish
[2023-07-27 11:23:24] [config] transformer-ffn-depth: 2
[2023-07-27 11:23:24] [config] transformer-guided-alignment-layer: last
[2023-07-27 11:23:24] [config] transformer-heads: 8
[2023-07-27 11:23:24] [config] transformer-no-projection: false
[2023-07-27 11:23:24] [config] transformer-pool: false
[2023-07-27 11:23:24] [config] transformer-postprocess: dan
[2023-07-27 11:23:24] [config] transformer-postprocess-emb: d
[2023-07-27 11:23:24] [config] transformer-postprocess-top: ""
[2023-07-27 11:23:24] [config] transformer-preprocess: ""
[2023-07-27 11:23:24] [config] transformer-tied-layers:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] transformer-train-position-embeddings: false
[2023-07-27 11:23:24] [config] tsv: false
[2023-07-27 11:23:24] [config] tsv-fields: 0
[2023-07-27 11:23:24] [config] type: s2s
[2023-07-27 11:23:24] [config] ulr: false
[2023-07-27 11:23:24] [config] ulr-dim-emb: 0
[2023-07-27 11:23:24] [config] ulr-dropout: 0
[2023-07-27 11:23:24] [config] ulr-keys-vectors: ""
[2023-07-27 11:23:24] [config] ulr-query-vectors: ""
[2023-07-27 11:23:24] [config] ulr-softmax-temperature: 1
[2023-07-27 11:23:24] [config] ulr-trainable-transformation: false
[2023-07-27 11:23:24] [config] unlikelihood-loss: false
[2023-07-27 11:23:24] [config] valid-freq: 50000000
[2023-07-27 11:23:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 11:23:24] [config] valid-max-length: 1000
[2023-07-27 11:23:24] [config] valid-metrics:
[2023-07-27 11:23:24] [config]   - translation
[2023-07-27 11:23:24] [config] valid-mini-batch: 32
[2023-07-27 11:23:24] [config] valid-reset-stalled: false
[2023-07-27 11:23:24] [config] valid-script-args:
[2023-07-27 11:23:24] [config]   []
[2023-07-27 11:23:24] [config] valid-script-path: ""
[2023-07-27 11:23:24] [config] valid-sets:
[2023-07-27 11:23:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 11:23:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 11:23:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 11:23:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 11:23:24] [config] vocabs:
[2023-07-27 11:23:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 11:23:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 11:23:24] [config] word-penalty: 0
[2023-07-27 11:23:24] [config] word-scores: false
[2023-07-27 11:23:24] [config] workspace: 5500
[2023-07-27 11:23:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 11:23:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 11:23:24] [training] Using single-device training
[2023-07-27 11:23:24] Synced seed 1234
[2023-07-27 11:23:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 11:23:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 11:23:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 11:23:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 11:23:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 11:23:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 11:23:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 11:23:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 11:23:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 11:23:25] [comm] Using global sharding
[2023-07-27 11:23:25] [comm] NCCLCommunicators constructed successfully
[2023-07-27 11:23:25] [training] Using 1 GPUs
[2023-07-27 11:23:25] [logits] Applying loss function for 1 factor(s)
[2023-07-27 11:23:25] [memory] Reserving 332 MB, device gpu0
[2023-07-27 11:23:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 11:23:26] [memory] Reserving 332 MB, device gpu0
[2023-07-27 11:24:58] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 11:24:58] [valid] No post-processing script given for validating translator
[2023-07-27 11:24:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 11:24:58] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 11:24:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 11:24:58] [comm] Using global sharding
[2023-07-27 11:24:58] [comm] NCCLCommunicators constructed successfully
[2023-07-27 11:24:58] [training] Using 1 GPUs
[2023-07-27 11:24:58] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 11:25:02] Allocating memory for general optimizer shards
[2023-07-27 11:25:02] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 11:25:02] Loading Adam parameters
[2023-07-27 11:25:03] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 11:25:03] [memory] Reserving 332 MB, device gpu0
[2023-07-27 11:25:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 11:25:05] [data] Restoring the corpus state to epoch 31, batch 2414
[2023-07-27 11:25:05] [data] Shuffling data
[2023-07-27 11:25:05] [data] Done reading 20,192 sentences
[2023-07-27 11:25:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:25:05] Training started
[2023-07-27 11:25:05] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 11:25:05] [memory] Reserving 332 MB, device gpu0
[2023-07-27 11:25:06] Parameter type float16, optimization type float32, casting types true
[2023-07-27 11:28:27] Seen 20,192 samples
[2023-07-27 11:28:27] Starting data epoch 32 in logical epoch 32
[2023-07-27 11:28:27] [data] Shuffling data
[2023-07-27 11:28:27] [data] Done reading 20,192 sentences
[2023-07-27 11:28:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:31:50] Seen 20,192 samples
[2023-07-27 11:31:50] Starting data epoch 33 in logical epoch 33
[2023-07-27 11:31:50] [data] Shuffling data
[2023-07-27 11:31:50] [data] Done reading 20,192 sentences
[2023-07-27 11:31:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:35:15] Seen 20,192 samples
[2023-07-27 11:35:15] Starting data epoch 34 in logical epoch 34
[2023-07-27 11:35:15] [data] Shuffling data
[2023-07-27 11:35:15] [data] Done reading 20,192 sentences
[2023-07-27 11:35:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:38:39] Seen 20,192 samples
[2023-07-27 11:38:39] Starting data epoch 35 in logical epoch 35
[2023-07-27 11:38:39] [data] Shuffling data
[2023-07-27 11:38:39] [data] Done reading 20,192 sentences
[2023-07-27 11:38:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:42:02] Seen 20,192 samples
[2023-07-27 11:42:02] Starting data epoch 36 in logical epoch 36
[2023-07-27 11:42:02] [data] Shuffling data
[2023-07-27 11:42:02] [data] Done reading 20,192 sentences
[2023-07-27 11:42:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:45:24] Seen 20,192 samples
[2023-07-27 11:45:24] Starting data epoch 37 in logical epoch 37
[2023-07-27 11:45:24] [data] Shuffling data
[2023-07-27 11:45:24] [data] Done reading 20,192 sentences
[2023-07-27 11:45:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:48:46] Seen 20,192 samples
[2023-07-27 11:48:46] Starting data epoch 38 in logical epoch 38
[2023-07-27 11:48:46] [data] Shuffling data
[2023-07-27 11:48:46] [data] Done reading 20,192 sentences
[2023-07-27 11:48:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:49:42] Ep. 38 : Up. 3000 : Sen. 5,587 : Cost 4.88669825 * 7,026,992 @ 9,366 after 21,140,576 : Time 1484.78s : 4732.69 words/s : gNorm 1.9219
[2023-07-27 11:52:07] Seen 20,192 samples
[2023-07-27 11:52:07] Starting data epoch 39 in logical epoch 39
[2023-07-27 11:52:07] [data] Shuffling data
[2023-07-27 11:52:07] [data] Done reading 20,192 sentences
[2023-07-27 11:52:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:55:26] Seen 20,192 samples
[2023-07-27 11:55:26] Starting data epoch 40 in logical epoch 40
[2023-07-27 11:55:26] [data] Shuffling data
[2023-07-27 11:55:26] [data] Done reading 20,192 sentences
[2023-07-27 11:55:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 11:58:46] Seen 20,192 samples
[2023-07-27 11:58:46] Starting data epoch 41 in logical epoch 41
[2023-07-27 11:58:46] Training finished
[2023-07-27 12:00:08] [valid] Ep. 41 : Up. 3221 : translation : 0 : new best
[2023-07-27 12:00:08] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 12:00:15] Saving Adam parameters
[2023-07-27 12:00:17] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 12:00:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 12:00:34] [marian] Running on node05.datos.cluster.uy as process 3070 with command line:
[2023-07-27 12:00:34] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 12:00:34] [config] after: 0e
[2023-07-27 12:00:34] [config] after-batches: 0
[2023-07-27 12:00:34] [config] after-epochs: 50
[2023-07-27 12:00:34] [config] all-caps-every: 0
[2023-07-27 12:00:34] [config] allow-unk: false
[2023-07-27 12:00:34] [config] authors: false
[2023-07-27 12:00:34] [config] beam-size: 12
[2023-07-27 12:00:34] [config] bert-class-symbol: "[CLS]"
[2023-07-27 12:00:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 12:00:34] [config] bert-masking-fraction: 0.15
[2023-07-27 12:00:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 12:00:34] [config] bert-train-type-embeddings: true
[2023-07-27 12:00:34] [config] bert-type-vocab-size: 2
[2023-07-27 12:00:34] [config] build-info: ""
[2023-07-27 12:00:34] [config] check-gradient-nan: false
[2023-07-27 12:00:34] [config] check-nan: false
[2023-07-27 12:00:34] [config] cite: false
[2023-07-27 12:00:34] [config] clip-norm: 1
[2023-07-27 12:00:34] [config] cost-scaling:
[2023-07-27 12:00:34] [config]   - 256.f
[2023-07-27 12:00:34] [config]   - 1000
[2023-07-27 12:00:34] [config]   - 2.f
[2023-07-27 12:00:34] [config]   - 256.f
[2023-07-27 12:00:34] [config] cost-type: ce-sum
[2023-07-27 12:00:34] [config] cpu-threads: 0
[2023-07-27 12:00:34] [config] data-threads: 8
[2023-07-27 12:00:34] [config] data-weighting: ""
[2023-07-27 12:00:34] [config] data-weighting-type: sentence
[2023-07-27 12:00:34] [config] dec-cell: gru
[2023-07-27 12:00:34] [config] dec-cell-base-depth: 2
[2023-07-27 12:00:34] [config] dec-cell-high-depth: 1
[2023-07-27 12:00:34] [config] dec-depth: 8
[2023-07-27 12:00:34] [config] devices:
[2023-07-27 12:00:34] [config]   - 0
[2023-07-27 12:00:34] [config] dim-emb: 512
[2023-07-27 12:00:34] [config] dim-rnn: 1024
[2023-07-27 12:00:34] [config] dim-vocabs:
[2023-07-27 12:00:34] [config]   - 16384
[2023-07-27 12:00:34] [config]   - 16384
[2023-07-27 12:00:34] [config] disp-first: 0
[2023-07-27 12:00:34] [config] disp-freq: 1000u
[2023-07-27 12:00:34] [config] disp-label-counts: true
[2023-07-27 12:00:34] [config] dropout-rnn: 0
[2023-07-27 12:00:34] [config] dropout-src: 0
[2023-07-27 12:00:34] [config] dropout-trg: 0
[2023-07-27 12:00:34] [config] dump-config: ""
[2023-07-27 12:00:34] [config] dynamic-gradient-scaling:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] early-stopping: 1000
[2023-07-27 12:00:34] [config] early-stopping-on: first
[2023-07-27 12:00:34] [config] embedding-fix-src: false
[2023-07-27 12:00:34] [config] embedding-fix-trg: false
[2023-07-27 12:00:34] [config] embedding-normalization: false
[2023-07-27 12:00:34] [config] embedding-vectors:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] enc-cell: gru
[2023-07-27 12:00:34] [config] enc-cell-depth: 1
[2023-07-27 12:00:34] [config] enc-depth: 8
[2023-07-27 12:00:34] [config] enc-type: bidirectional
[2023-07-27 12:00:34] [config] english-title-case-every: 0
[2023-07-27 12:00:34] [config] exponential-smoothing: 0
[2023-07-27 12:00:34] [config] factor-weight: 1
[2023-07-27 12:00:34] [config] factors-combine: sum
[2023-07-27 12:00:34] [config] factors-dim-emb: 0
[2023-07-27 12:00:34] [config] gradient-checkpointing: false
[2023-07-27 12:00:34] [config] gradient-norm-average-window: 100
[2023-07-27 12:00:34] [config] guided-alignment: none
[2023-07-27 12:00:34] [config] guided-alignment-cost: mse
[2023-07-27 12:00:34] [config] guided-alignment-weight: 0.1
[2023-07-27 12:00:34] [config] ignore-model-config: false
[2023-07-27 12:00:34] [config] input-types:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] interpolate-env-vars: false
[2023-07-27 12:00:34] [config] keep-best: false
[2023-07-27 12:00:34] [config] label-smoothing: 0
[2023-07-27 12:00:34] [config] layer-normalization: false
[2023-07-27 12:00:34] [config] learn-rate: 0.0001
[2023-07-27 12:00:34] [config] lemma-dependency: ""
[2023-07-27 12:00:34] [config] lemma-dim-emb: 0
[2023-07-27 12:00:34] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 12:00:34] [config] log-level: info
[2023-07-27 12:00:34] [config] log-time-zone: ""
[2023-07-27 12:00:34] [config] logical-epoch:
[2023-07-27 12:00:34] [config]   - 1e
[2023-07-27 12:00:34] [config]   - 0
[2023-07-27 12:00:34] [config] lr-decay: 0
[2023-07-27 12:00:34] [config] lr-decay-freq: 50000
[2023-07-27 12:00:34] [config] lr-decay-inv-sqrt:
[2023-07-27 12:00:34] [config]   - 0
[2023-07-27 12:00:34] [config] lr-decay-repeat-warmup: false
[2023-07-27 12:00:34] [config] lr-decay-reset-optimizer: false
[2023-07-27 12:00:34] [config] lr-decay-start:
[2023-07-27 12:00:34] [config]   - 10
[2023-07-27 12:00:34] [config]   - 1
[2023-07-27 12:00:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 12:00:34] [config] lr-report: false
[2023-07-27 12:00:34] [config] lr-warmup: 0
[2023-07-27 12:00:34] [config] lr-warmup-at-reload: false
[2023-07-27 12:00:34] [config] lr-warmup-cycle: false
[2023-07-27 12:00:34] [config] lr-warmup-start-rate: 0
[2023-07-27 12:00:34] [config] max-length: 50
[2023-07-27 12:00:34] [config] max-length-crop: true
[2023-07-27 12:00:34] [config] max-length-factor: 3
[2023-07-27 12:00:34] [config] maxi-batch: 100
[2023-07-27 12:00:34] [config] maxi-batch-sort: trg
[2023-07-27 12:00:34] [config] mini-batch: 64
[2023-07-27 12:00:34] [config] mini-batch-fit: true
[2023-07-27 12:00:34] [config] mini-batch-fit-step: 10
[2023-07-27 12:00:34] [config] mini-batch-round-up: true
[2023-07-27 12:00:34] [config] mini-batch-track-lr: false
[2023-07-27 12:00:34] [config] mini-batch-warmup: 0
[2023-07-27 12:00:34] [config] mini-batch-words: 0
[2023-07-27 12:00:34] [config] mini-batch-words-ref: 0
[2023-07-27 12:00:34] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 12:00:34] [config] multi-loss-type: sum
[2023-07-27 12:00:34] [config] n-best: false
[2023-07-27 12:00:34] [config] no-nccl: false
[2023-07-27 12:00:34] [config] no-reload: false
[2023-07-27 12:00:34] [config] no-restore-corpus: false
[2023-07-27 12:00:34] [config] normalize: 0
[2023-07-27 12:00:34] [config] normalize-gradient: false
[2023-07-27 12:00:34] [config] num-devices: 0
[2023-07-27 12:00:34] [config] optimizer: adam
[2023-07-27 12:00:34] [config] optimizer-delay: 1
[2023-07-27 12:00:34] [config] optimizer-params:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] output-omit-bias: false
[2023-07-27 12:00:34] [config] overwrite: true
[2023-07-27 12:00:34] [config] precision:
[2023-07-27 12:00:34] [config]   - float16
[2023-07-27 12:00:34] [config]   - float32
[2023-07-27 12:00:34] [config] pretrained-model: ""
[2023-07-27 12:00:34] [config] quantize-biases: false
[2023-07-27 12:00:34] [config] quantize-bits: 0
[2023-07-27 12:00:34] [config] quantize-log-based: false
[2023-07-27 12:00:34] [config] quantize-optimization-steps: 0
[2023-07-27 12:00:34] [config] quiet: false
[2023-07-27 12:00:34] [config] quiet-translation: true
[2023-07-27 12:00:34] [config] relative-paths: false
[2023-07-27 12:00:34] [config] right-left: false
[2023-07-27 12:00:34] [config] save-freq: 10000u
[2023-07-27 12:00:34] [config] seed: 1234
[2023-07-27 12:00:34] [config] sentencepiece-alphas:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] sentencepiece-max-lines: 2000000
[2023-07-27 12:00:34] [config] sentencepiece-options: ""
[2023-07-27 12:00:34] [config] sharding: global
[2023-07-27 12:00:34] [config] shuffle: data
[2023-07-27 12:00:34] [config] shuffle-in-ram: false
[2023-07-27 12:00:34] [config] sigterm: save-and-exit
[2023-07-27 12:00:34] [config] skip: false
[2023-07-27 12:00:34] [config] sqlite: ""
[2023-07-27 12:00:34] [config] sqlite-drop: false
[2023-07-27 12:00:34] [config] sync-freq: 200u
[2023-07-27 12:00:34] [config] sync-sgd: false
[2023-07-27 12:00:34] [config] tempdir: /tmp
[2023-07-27 12:00:34] [config] tied-embeddings: false
[2023-07-27 12:00:34] [config] tied-embeddings-all: true
[2023-07-27 12:00:34] [config] tied-embeddings-src: false
[2023-07-27 12:00:34] [config] train-embedder-rank:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] train-sets:
[2023-07-27 12:00:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 12:00:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 12:00:34] [config] transformer-aan-activation: swish
[2023-07-27 12:00:34] [config] transformer-aan-depth: 2
[2023-07-27 12:00:34] [config] transformer-aan-nogate: false
[2023-07-27 12:00:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 12:00:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 12:00:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 12:00:34] [config] transformer-depth-scaling: false
[2023-07-27 12:00:34] [config] transformer-dim-aan: 2048
[2023-07-27 12:00:34] [config] transformer-dim-ffn: 2048
[2023-07-27 12:00:34] [config] transformer-dropout: 0
[2023-07-27 12:00:34] [config] transformer-dropout-attention: 0
[2023-07-27 12:00:34] [config] transformer-dropout-ffn: 0
[2023-07-27 12:00:34] [config] transformer-ffn-activation: swish
[2023-07-27 12:00:34] [config] transformer-ffn-depth: 2
[2023-07-27 12:00:34] [config] transformer-guided-alignment-layer: last
[2023-07-27 12:00:34] [config] transformer-heads: 8
[2023-07-27 12:00:34] [config] transformer-no-projection: false
[2023-07-27 12:00:34] [config] transformer-pool: false
[2023-07-27 12:00:34] [config] transformer-postprocess: dan
[2023-07-27 12:00:34] [config] transformer-postprocess-emb: d
[2023-07-27 12:00:34] [config] transformer-postprocess-top: ""
[2023-07-27 12:00:34] [config] transformer-preprocess: ""
[2023-07-27 12:00:34] [config] transformer-tied-layers:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] transformer-train-position-embeddings: false
[2023-07-27 12:00:34] [config] tsv: false
[2023-07-27 12:00:34] [config] tsv-fields: 0
[2023-07-27 12:00:34] [config] type: s2s
[2023-07-27 12:00:34] [config] ulr: false
[2023-07-27 12:00:34] [config] ulr-dim-emb: 0
[2023-07-27 12:00:34] [config] ulr-dropout: 0
[2023-07-27 12:00:34] [config] ulr-keys-vectors: ""
[2023-07-27 12:00:34] [config] ulr-query-vectors: ""
[2023-07-27 12:00:34] [config] ulr-softmax-temperature: 1
[2023-07-27 12:00:34] [config] ulr-trainable-transformation: false
[2023-07-27 12:00:34] [config] unlikelihood-loss: false
[2023-07-27 12:00:34] [config] valid-freq: 50000000
[2023-07-27 12:00:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 12:00:34] [config] valid-max-length: 1000
[2023-07-27 12:00:34] [config] valid-metrics:
[2023-07-27 12:00:34] [config]   - translation
[2023-07-27 12:00:34] [config] valid-mini-batch: 32
[2023-07-27 12:00:34] [config] valid-reset-stalled: false
[2023-07-27 12:00:34] [config] valid-script-args:
[2023-07-27 12:00:34] [config]   []
[2023-07-27 12:00:34] [config] valid-script-path: ""
[2023-07-27 12:00:34] [config] valid-sets:
[2023-07-27 12:00:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 12:00:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 12:00:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 12:00:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 12:00:34] [config] vocabs:
[2023-07-27 12:00:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 12:00:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 12:00:34] [config] word-penalty: 0
[2023-07-27 12:00:34] [config] word-scores: false
[2023-07-27 12:00:34] [config] workspace: 5500
[2023-07-27 12:00:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 12:00:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 12:00:34] [training] Using single-device training
[2023-07-27 12:00:34] Synced seed 1234
[2023-07-27 12:00:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 12:00:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 12:00:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 12:00:34] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 12:00:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 12:00:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 12:00:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 12:00:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 12:00:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 12:00:35] [comm] Using global sharding
[2023-07-27 12:00:35] [comm] NCCLCommunicators constructed successfully
[2023-07-27 12:00:35] [training] Using 1 GPUs
[2023-07-27 12:00:35] [logits] Applying loss function for 1 factor(s)
[2023-07-27 12:00:35] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:00:35] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 12:00:36] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:02:08] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 12:02:08] [valid] No post-processing script given for validating translator
[2023-07-27 12:02:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 12:02:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 12:02:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 12:02:08] [comm] Using global sharding
[2023-07-27 12:02:08] [comm] NCCLCommunicators constructed successfully
[2023-07-27 12:02:08] [training] Using 1 GPUs
[2023-07-27 12:02:08] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 12:02:13] Allocating memory for general optimizer shards
[2023-07-27 12:02:13] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 12:02:13] Loading Adam parameters
[2023-07-27 12:02:13] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 12:02:14] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:02:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 12:02:15] [data] Restoring the corpus state to epoch 41, batch 3221
[2023-07-27 12:02:15] [data] Shuffling data
[2023-07-27 12:02:15] [data] Done reading 20,192 sentences
[2023-07-27 12:02:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:02:15] Training started
[2023-07-27 12:02:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 12:02:16] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:02:19] Parameter type float16, optimization type float32, casting types true
[2023-07-27 12:05:31] Seen 20,192 samples
[2023-07-27 12:05:31] Starting data epoch 42 in logical epoch 42
[2023-07-27 12:05:31] [data] Shuffling data
[2023-07-27 12:05:31] [data] Done reading 20,192 sentences
[2023-07-27 12:05:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:08:50] Seen 20,192 samples
[2023-07-27 12:08:50] Starting data epoch 43 in logical epoch 43
[2023-07-27 12:08:50] [data] Shuffling data
[2023-07-27 12:08:50] [data] Done reading 20,192 sentences
[2023-07-27 12:08:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:12:09] Seen 20,192 samples
[2023-07-27 12:12:09] Starting data epoch 44 in logical epoch 44
[2023-07-27 12:12:09] [data] Shuffling data
[2023-07-27 12:12:09] [data] Done reading 20,192 sentences
[2023-07-27 12:12:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:15:28] Seen 20,192 samples
[2023-07-27 12:15:28] Starting data epoch 45 in logical epoch 45
[2023-07-27 12:15:28] [data] Shuffling data
[2023-07-27 12:15:28] [data] Done reading 20,192 sentences
[2023-07-27 12:15:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:18:47] Seen 20,192 samples
[2023-07-27 12:18:47] Starting data epoch 46 in logical epoch 46
[2023-07-27 12:18:47] [data] Shuffling data
[2023-07-27 12:18:47] [data] Done reading 20,192 sentences
[2023-07-27 12:18:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:22:05] Seen 20,192 samples
[2023-07-27 12:22:05] Starting data epoch 47 in logical epoch 47
[2023-07-27 12:22:05] [data] Shuffling data
[2023-07-27 12:22:05] [data] Done reading 20,192 sentences
[2023-07-27 12:22:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:25:22] Seen 20,192 samples
[2023-07-27 12:25:22] Starting data epoch 48 in logical epoch 48
[2023-07-27 12:25:22] [data] Shuffling data
[2023-07-27 12:25:22] [data] Done reading 20,192 sentences
[2023-07-27 12:25:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:28:39] Seen 20,192 samples
[2023-07-27 12:28:39] Starting data epoch 49 in logical epoch 49
[2023-07-27 12:28:39] [data] Shuffling data
[2023-07-27 12:28:39] [data] Done reading 20,192 sentences
[2023-07-27 12:28:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:31:57] Seen 20,192 samples
[2023-07-27 12:31:57] Starting data epoch 50 in logical epoch 50
[2023-07-27 12:31:57] [data] Shuffling data
[2023-07-27 12:31:57] [data] Done reading 20,192 sentences
[2023-07-27 12:31:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:34:09] Ep. 50 : Up. 4000 : Sen. 13,669 : Cost 4.32691002 * 7,030,269 @ 5,753 after 28,170,845 : Time 1921.09s : 3659.52 words/s : gNorm 2.3568
[2023-07-27 12:35:12] Seen 20,192 samples
[2023-07-27 12:35:12] Starting data epoch 51 in logical epoch 51
[2023-07-27 12:35:12] Training finished
[2023-07-27 12:36:38] [valid] Ep. 51 : Up. 4025 : translation : 0 : new best
[2023-07-27 12:36:38] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 12:36:44] Saving Adam parameters
[2023-07-27 12:36:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 12:37:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 12:37:03] [marian] Running on node05.datos.cluster.uy as process 5372 with command line:
[2023-07-27 12:37:03] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 12:37:03] [config] after: 0e
[2023-07-27 12:37:03] [config] after-batches: 0
[2023-07-27 12:37:03] [config] after-epochs: 60
[2023-07-27 12:37:03] [config] all-caps-every: 0
[2023-07-27 12:37:03] [config] allow-unk: false
[2023-07-27 12:37:03] [config] authors: false
[2023-07-27 12:37:03] [config] beam-size: 12
[2023-07-27 12:37:03] [config] bert-class-symbol: "[CLS]"
[2023-07-27 12:37:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 12:37:03] [config] bert-masking-fraction: 0.15
[2023-07-27 12:37:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 12:37:03] [config] bert-train-type-embeddings: true
[2023-07-27 12:37:03] [config] bert-type-vocab-size: 2
[2023-07-27 12:37:03] [config] build-info: ""
[2023-07-27 12:37:03] [config] check-gradient-nan: false
[2023-07-27 12:37:03] [config] check-nan: false
[2023-07-27 12:37:03] [config] cite: false
[2023-07-27 12:37:03] [config] clip-norm: 1
[2023-07-27 12:37:03] [config] cost-scaling:
[2023-07-27 12:37:03] [config]   - 256.f
[2023-07-27 12:37:03] [config]   - 1000
[2023-07-27 12:37:03] [config]   - 2.f
[2023-07-27 12:37:03] [config]   - 256.f
[2023-07-27 12:37:03] [config] cost-type: ce-sum
[2023-07-27 12:37:03] [config] cpu-threads: 0
[2023-07-27 12:37:03] [config] data-threads: 8
[2023-07-27 12:37:03] [config] data-weighting: ""
[2023-07-27 12:37:03] [config] data-weighting-type: sentence
[2023-07-27 12:37:03] [config] dec-cell: gru
[2023-07-27 12:37:03] [config] dec-cell-base-depth: 2
[2023-07-27 12:37:03] [config] dec-cell-high-depth: 1
[2023-07-27 12:37:03] [config] dec-depth: 8
[2023-07-27 12:37:03] [config] devices:
[2023-07-27 12:37:03] [config]   - 0
[2023-07-27 12:37:03] [config] dim-emb: 512
[2023-07-27 12:37:03] [config] dim-rnn: 1024
[2023-07-27 12:37:03] [config] dim-vocabs:
[2023-07-27 12:37:03] [config]   - 16384
[2023-07-27 12:37:03] [config]   - 16384
[2023-07-27 12:37:03] [config] disp-first: 0
[2023-07-27 12:37:03] [config] disp-freq: 1000u
[2023-07-27 12:37:03] [config] disp-label-counts: true
[2023-07-27 12:37:03] [config] dropout-rnn: 0
[2023-07-27 12:37:03] [config] dropout-src: 0
[2023-07-27 12:37:03] [config] dropout-trg: 0
[2023-07-27 12:37:03] [config] dump-config: ""
[2023-07-27 12:37:03] [config] dynamic-gradient-scaling:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] early-stopping: 1000
[2023-07-27 12:37:03] [config] early-stopping-on: first
[2023-07-27 12:37:03] [config] embedding-fix-src: false
[2023-07-27 12:37:03] [config] embedding-fix-trg: false
[2023-07-27 12:37:03] [config] embedding-normalization: false
[2023-07-27 12:37:03] [config] embedding-vectors:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] enc-cell: gru
[2023-07-27 12:37:03] [config] enc-cell-depth: 1
[2023-07-27 12:37:03] [config] enc-depth: 8
[2023-07-27 12:37:03] [config] enc-type: bidirectional
[2023-07-27 12:37:03] [config] english-title-case-every: 0
[2023-07-27 12:37:03] [config] exponential-smoothing: 0
[2023-07-27 12:37:03] [config] factor-weight: 1
[2023-07-27 12:37:03] [config] factors-combine: sum
[2023-07-27 12:37:03] [config] factors-dim-emb: 0
[2023-07-27 12:37:03] [config] gradient-checkpointing: false
[2023-07-27 12:37:03] [config] gradient-norm-average-window: 100
[2023-07-27 12:37:03] [config] guided-alignment: none
[2023-07-27 12:37:03] [config] guided-alignment-cost: mse
[2023-07-27 12:37:03] [config] guided-alignment-weight: 0.1
[2023-07-27 12:37:03] [config] ignore-model-config: false
[2023-07-27 12:37:03] [config] input-types:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] interpolate-env-vars: false
[2023-07-27 12:37:03] [config] keep-best: false
[2023-07-27 12:37:03] [config] label-smoothing: 0
[2023-07-27 12:37:03] [config] layer-normalization: false
[2023-07-27 12:37:03] [config] learn-rate: 0.0001
[2023-07-27 12:37:03] [config] lemma-dependency: ""
[2023-07-27 12:37:03] [config] lemma-dim-emb: 0
[2023-07-27 12:37:03] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 12:37:03] [config] log-level: info
[2023-07-27 12:37:03] [config] log-time-zone: ""
[2023-07-27 12:37:03] [config] logical-epoch:
[2023-07-27 12:37:03] [config]   - 1e
[2023-07-27 12:37:03] [config]   - 0
[2023-07-27 12:37:03] [config] lr-decay: 0
[2023-07-27 12:37:03] [config] lr-decay-freq: 50000
[2023-07-27 12:37:03] [config] lr-decay-inv-sqrt:
[2023-07-27 12:37:03] [config]   - 0
[2023-07-27 12:37:03] [config] lr-decay-repeat-warmup: false
[2023-07-27 12:37:03] [config] lr-decay-reset-optimizer: false
[2023-07-27 12:37:03] [config] lr-decay-start:
[2023-07-27 12:37:03] [config]   - 10
[2023-07-27 12:37:03] [config]   - 1
[2023-07-27 12:37:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 12:37:03] [config] lr-report: false
[2023-07-27 12:37:03] [config] lr-warmup: 0
[2023-07-27 12:37:03] [config] lr-warmup-at-reload: false
[2023-07-27 12:37:03] [config] lr-warmup-cycle: false
[2023-07-27 12:37:03] [config] lr-warmup-start-rate: 0
[2023-07-27 12:37:03] [config] max-length: 50
[2023-07-27 12:37:03] [config] max-length-crop: true
[2023-07-27 12:37:03] [config] max-length-factor: 3
[2023-07-27 12:37:03] [config] maxi-batch: 100
[2023-07-27 12:37:03] [config] maxi-batch-sort: trg
[2023-07-27 12:37:03] [config] mini-batch: 64
[2023-07-27 12:37:03] [config] mini-batch-fit: true
[2023-07-27 12:37:03] [config] mini-batch-fit-step: 10
[2023-07-27 12:37:03] [config] mini-batch-round-up: true
[2023-07-27 12:37:03] [config] mini-batch-track-lr: false
[2023-07-27 12:37:03] [config] mini-batch-warmup: 0
[2023-07-27 12:37:03] [config] mini-batch-words: 0
[2023-07-27 12:37:03] [config] mini-batch-words-ref: 0
[2023-07-27 12:37:03] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 12:37:03] [config] multi-loss-type: sum
[2023-07-27 12:37:03] [config] n-best: false
[2023-07-27 12:37:03] [config] no-nccl: false
[2023-07-27 12:37:03] [config] no-reload: false
[2023-07-27 12:37:03] [config] no-restore-corpus: false
[2023-07-27 12:37:03] [config] normalize: 0
[2023-07-27 12:37:03] [config] normalize-gradient: false
[2023-07-27 12:37:03] [config] num-devices: 0
[2023-07-27 12:37:03] [config] optimizer: adam
[2023-07-27 12:37:03] [config] optimizer-delay: 1
[2023-07-27 12:37:03] [config] optimizer-params:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] output-omit-bias: false
[2023-07-27 12:37:03] [config] overwrite: true
[2023-07-27 12:37:03] [config] precision:
[2023-07-27 12:37:03] [config]   - float16
[2023-07-27 12:37:03] [config]   - float32
[2023-07-27 12:37:03] [config] pretrained-model: ""
[2023-07-27 12:37:03] [config] quantize-biases: false
[2023-07-27 12:37:03] [config] quantize-bits: 0
[2023-07-27 12:37:03] [config] quantize-log-based: false
[2023-07-27 12:37:03] [config] quantize-optimization-steps: 0
[2023-07-27 12:37:03] [config] quiet: false
[2023-07-27 12:37:03] [config] quiet-translation: true
[2023-07-27 12:37:03] [config] relative-paths: false
[2023-07-27 12:37:03] [config] right-left: false
[2023-07-27 12:37:03] [config] save-freq: 10000u
[2023-07-27 12:37:03] [config] seed: 1234
[2023-07-27 12:37:03] [config] sentencepiece-alphas:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] sentencepiece-max-lines: 2000000
[2023-07-27 12:37:03] [config] sentencepiece-options: ""
[2023-07-27 12:37:03] [config] sharding: global
[2023-07-27 12:37:03] [config] shuffle: data
[2023-07-27 12:37:03] [config] shuffle-in-ram: false
[2023-07-27 12:37:03] [config] sigterm: save-and-exit
[2023-07-27 12:37:03] [config] skip: false
[2023-07-27 12:37:03] [config] sqlite: ""
[2023-07-27 12:37:03] [config] sqlite-drop: false
[2023-07-27 12:37:03] [config] sync-freq: 200u
[2023-07-27 12:37:03] [config] sync-sgd: false
[2023-07-27 12:37:03] [config] tempdir: /tmp
[2023-07-27 12:37:03] [config] tied-embeddings: false
[2023-07-27 12:37:03] [config] tied-embeddings-all: true
[2023-07-27 12:37:03] [config] tied-embeddings-src: false
[2023-07-27 12:37:03] [config] train-embedder-rank:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] train-sets:
[2023-07-27 12:37:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 12:37:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 12:37:03] [config] transformer-aan-activation: swish
[2023-07-27 12:37:03] [config] transformer-aan-depth: 2
[2023-07-27 12:37:03] [config] transformer-aan-nogate: false
[2023-07-27 12:37:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 12:37:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 12:37:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 12:37:03] [config] transformer-depth-scaling: false
[2023-07-27 12:37:03] [config] transformer-dim-aan: 2048
[2023-07-27 12:37:03] [config] transformer-dim-ffn: 2048
[2023-07-27 12:37:03] [config] transformer-dropout: 0
[2023-07-27 12:37:03] [config] transformer-dropout-attention: 0
[2023-07-27 12:37:03] [config] transformer-dropout-ffn: 0
[2023-07-27 12:37:03] [config] transformer-ffn-activation: swish
[2023-07-27 12:37:03] [config] transformer-ffn-depth: 2
[2023-07-27 12:37:03] [config] transformer-guided-alignment-layer: last
[2023-07-27 12:37:03] [config] transformer-heads: 8
[2023-07-27 12:37:03] [config] transformer-no-projection: false
[2023-07-27 12:37:03] [config] transformer-pool: false
[2023-07-27 12:37:03] [config] transformer-postprocess: dan
[2023-07-27 12:37:03] [config] transformer-postprocess-emb: d
[2023-07-27 12:37:03] [config] transformer-postprocess-top: ""
[2023-07-27 12:37:03] [config] transformer-preprocess: ""
[2023-07-27 12:37:03] [config] transformer-tied-layers:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] transformer-train-position-embeddings: false
[2023-07-27 12:37:03] [config] tsv: false
[2023-07-27 12:37:03] [config] tsv-fields: 0
[2023-07-27 12:37:03] [config] type: s2s
[2023-07-27 12:37:03] [config] ulr: false
[2023-07-27 12:37:03] [config] ulr-dim-emb: 0
[2023-07-27 12:37:03] [config] ulr-dropout: 0
[2023-07-27 12:37:03] [config] ulr-keys-vectors: ""
[2023-07-27 12:37:03] [config] ulr-query-vectors: ""
[2023-07-27 12:37:03] [config] ulr-softmax-temperature: 1
[2023-07-27 12:37:03] [config] ulr-trainable-transformation: false
[2023-07-27 12:37:03] [config] unlikelihood-loss: false
[2023-07-27 12:37:03] [config] valid-freq: 50000000
[2023-07-27 12:37:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 12:37:03] [config] valid-max-length: 1000
[2023-07-27 12:37:03] [config] valid-metrics:
[2023-07-27 12:37:03] [config]   - translation
[2023-07-27 12:37:03] [config] valid-mini-batch: 32
[2023-07-27 12:37:03] [config] valid-reset-stalled: false
[2023-07-27 12:37:03] [config] valid-script-args:
[2023-07-27 12:37:03] [config]   []
[2023-07-27 12:37:03] [config] valid-script-path: ""
[2023-07-27 12:37:03] [config] valid-sets:
[2023-07-27 12:37:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 12:37:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 12:37:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 12:37:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 12:37:03] [config] vocabs:
[2023-07-27 12:37:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 12:37:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 12:37:03] [config] word-penalty: 0
[2023-07-27 12:37:03] [config] word-scores: false
[2023-07-27 12:37:03] [config] workspace: 5500
[2023-07-27 12:37:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 12:37:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 12:37:03] [training] Using single-device training
[2023-07-27 12:37:04] Synced seed 1234
[2023-07-27 12:37:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 12:37:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 12:37:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 12:37:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 12:37:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 12:37:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 12:37:04] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 12:37:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 12:37:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 12:37:04] [comm] Using global sharding
[2023-07-27 12:37:04] [comm] NCCLCommunicators constructed successfully
[2023-07-27 12:37:04] [training] Using 1 GPUs
[2023-07-27 12:37:04] [logits] Applying loss function for 1 factor(s)
[2023-07-27 12:37:04] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:37:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 12:37:05] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:38:37] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 12:38:37] [valid] No post-processing script given for validating translator
[2023-07-27 12:38:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 12:38:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 12:38:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 12:38:38] [comm] Using global sharding
[2023-07-27 12:38:38] [comm] NCCLCommunicators constructed successfully
[2023-07-27 12:38:38] [training] Using 1 GPUs
[2023-07-27 12:38:38] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 12:38:42] Allocating memory for general optimizer shards
[2023-07-27 12:38:42] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 12:38:42] Loading Adam parameters
[2023-07-27 12:38:43] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 12:38:43] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:38:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 12:38:45] [data] Restoring the corpus state to epoch 51, batch 4025
[2023-07-27 12:38:45] [data] Shuffling data
[2023-07-27 12:38:45] [data] Done reading 20,192 sentences
[2023-07-27 12:38:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:38:45] Training started
[2023-07-27 12:38:45] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 12:38:45] [memory] Reserving 332 MB, device gpu0
[2023-07-27 12:38:48] Parameter type float16, optimization type float32, casting types true
[2023-07-27 12:41:58] Seen 20,192 samples
[2023-07-27 12:41:58] Starting data epoch 52 in logical epoch 52
[2023-07-27 12:41:58] [data] Shuffling data
[2023-07-27 12:41:58] [data] Done reading 20,192 sentences
[2023-07-27 12:41:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:45:09] Seen 20,192 samples
[2023-07-27 12:45:09] Starting data epoch 53 in logical epoch 53
[2023-07-27 12:45:09] [data] Shuffling data
[2023-07-27 12:45:09] [data] Done reading 20,192 sentences
[2023-07-27 12:45:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:48:23] Seen 20,192 samples
[2023-07-27 12:48:23] Starting data epoch 54 in logical epoch 54
[2023-07-27 12:48:23] [data] Shuffling data
[2023-07-27 12:48:23] [data] Done reading 20,192 sentences
[2023-07-27 12:48:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:51:39] Seen 20,192 samples
[2023-07-27 12:51:39] Starting data epoch 55 in logical epoch 55
[2023-07-27 12:51:39] [data] Shuffling data
[2023-07-27 12:51:39] [data] Done reading 20,192 sentences
[2023-07-27 12:51:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:54:52] Seen 20,192 samples
[2023-07-27 12:54:52] Starting data epoch 56 in logical epoch 56
[2023-07-27 12:54:52] [data] Shuffling data
[2023-07-27 12:54:52] [data] Done reading 20,192 sentences
[2023-07-27 12:54:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 12:58:06] Seen 20,192 samples
[2023-07-27 12:58:06] Starting data epoch 57 in logical epoch 57
[2023-07-27 12:58:06] [data] Shuffling data
[2023-07-27 12:58:06] [data] Done reading 20,192 sentences
[2023-07-27 12:58:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:01:18] Seen 20,192 samples
[2023-07-27 13:01:18] Starting data epoch 58 in logical epoch 58
[2023-07-27 13:01:18] [data] Shuffling data
[2023-07-27 13:01:18] [data] Done reading 20,192 sentences
[2023-07-27 13:01:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:04:34] Seen 20,192 samples
[2023-07-27 13:04:34] Starting data epoch 59 in logical epoch 59
[2023-07-27 13:04:34] [data] Shuffling data
[2023-07-27 13:04:34] [data] Done reading 20,192 sentences
[2023-07-27 13:04:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:07:49] Seen 20,192 samples
[2023-07-27 13:07:49] Starting data epoch 60 in logical epoch 60
[2023-07-27 13:07:49] [data] Shuffling data
[2023-07-27 13:07:49] [data] Done reading 20,192 sentences
[2023-07-27 13:07:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:11:02] Seen 20,192 samples
[2023-07-27 13:11:02] Starting data epoch 61 in logical epoch 61
[2023-07-27 13:11:02] Training finished
[2023-07-27 13:12:21] [valid] Ep. 61 : Up. 4829 : translation : 0 : new best
[2023-07-27 13:12:21] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 13:12:27] Saving Adam parameters
[2023-07-27 13:12:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 13:12:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:12:46] [marian] Running on node05.datos.cluster.uy as process 7624 with command line:
[2023-07-27 13:12:46] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 13:12:46] [config] after: 0e
[2023-07-27 13:12:46] [config] after-batches: 0
[2023-07-27 13:12:46] [config] after-epochs: 70
[2023-07-27 13:12:46] [config] all-caps-every: 0
[2023-07-27 13:12:46] [config] allow-unk: false
[2023-07-27 13:12:46] [config] authors: false
[2023-07-27 13:12:46] [config] beam-size: 12
[2023-07-27 13:12:46] [config] bert-class-symbol: "[CLS]"
[2023-07-27 13:12:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 13:12:46] [config] bert-masking-fraction: 0.15
[2023-07-27 13:12:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 13:12:46] [config] bert-train-type-embeddings: true
[2023-07-27 13:12:46] [config] bert-type-vocab-size: 2
[2023-07-27 13:12:46] [config] build-info: ""
[2023-07-27 13:12:46] [config] check-gradient-nan: false
[2023-07-27 13:12:46] [config] check-nan: false
[2023-07-27 13:12:46] [config] cite: false
[2023-07-27 13:12:46] [config] clip-norm: 1
[2023-07-27 13:12:46] [config] cost-scaling:
[2023-07-27 13:12:46] [config]   - 256.f
[2023-07-27 13:12:46] [config]   - 1000
[2023-07-27 13:12:46] [config]   - 2.f
[2023-07-27 13:12:46] [config]   - 256.f
[2023-07-27 13:12:46] [config] cost-type: ce-sum
[2023-07-27 13:12:46] [config] cpu-threads: 0
[2023-07-27 13:12:46] [config] data-threads: 8
[2023-07-27 13:12:46] [config] data-weighting: ""
[2023-07-27 13:12:46] [config] data-weighting-type: sentence
[2023-07-27 13:12:46] [config] dec-cell: gru
[2023-07-27 13:12:46] [config] dec-cell-base-depth: 2
[2023-07-27 13:12:46] [config] dec-cell-high-depth: 1
[2023-07-27 13:12:46] [config] dec-depth: 8
[2023-07-27 13:12:46] [config] devices:
[2023-07-27 13:12:46] [config]   - 0
[2023-07-27 13:12:46] [config] dim-emb: 512
[2023-07-27 13:12:46] [config] dim-rnn: 1024
[2023-07-27 13:12:46] [config] dim-vocabs:
[2023-07-27 13:12:46] [config]   - 16384
[2023-07-27 13:12:46] [config]   - 16384
[2023-07-27 13:12:46] [config] disp-first: 0
[2023-07-27 13:12:46] [config] disp-freq: 1000u
[2023-07-27 13:12:46] [config] disp-label-counts: true
[2023-07-27 13:12:46] [config] dropout-rnn: 0
[2023-07-27 13:12:46] [config] dropout-src: 0
[2023-07-27 13:12:46] [config] dropout-trg: 0
[2023-07-27 13:12:46] [config] dump-config: ""
[2023-07-27 13:12:46] [config] dynamic-gradient-scaling:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] early-stopping: 1000
[2023-07-27 13:12:46] [config] early-stopping-on: first
[2023-07-27 13:12:46] [config] embedding-fix-src: false
[2023-07-27 13:12:46] [config] embedding-fix-trg: false
[2023-07-27 13:12:46] [config] embedding-normalization: false
[2023-07-27 13:12:46] [config] embedding-vectors:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] enc-cell: gru
[2023-07-27 13:12:46] [config] enc-cell-depth: 1
[2023-07-27 13:12:46] [config] enc-depth: 8
[2023-07-27 13:12:46] [config] enc-type: bidirectional
[2023-07-27 13:12:46] [config] english-title-case-every: 0
[2023-07-27 13:12:46] [config] exponential-smoothing: 0
[2023-07-27 13:12:46] [config] factor-weight: 1
[2023-07-27 13:12:46] [config] factors-combine: sum
[2023-07-27 13:12:46] [config] factors-dim-emb: 0
[2023-07-27 13:12:46] [config] gradient-checkpointing: false
[2023-07-27 13:12:46] [config] gradient-norm-average-window: 100
[2023-07-27 13:12:46] [config] guided-alignment: none
[2023-07-27 13:12:46] [config] guided-alignment-cost: mse
[2023-07-27 13:12:46] [config] guided-alignment-weight: 0.1
[2023-07-27 13:12:46] [config] ignore-model-config: false
[2023-07-27 13:12:46] [config] input-types:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] interpolate-env-vars: false
[2023-07-27 13:12:46] [config] keep-best: false
[2023-07-27 13:12:46] [config] label-smoothing: 0
[2023-07-27 13:12:46] [config] layer-normalization: false
[2023-07-27 13:12:46] [config] learn-rate: 0.0001
[2023-07-27 13:12:46] [config] lemma-dependency: ""
[2023-07-27 13:12:46] [config] lemma-dim-emb: 0
[2023-07-27 13:12:46] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 13:12:46] [config] log-level: info
[2023-07-27 13:12:46] [config] log-time-zone: ""
[2023-07-27 13:12:46] [config] logical-epoch:
[2023-07-27 13:12:46] [config]   - 1e
[2023-07-27 13:12:46] [config]   - 0
[2023-07-27 13:12:46] [config] lr-decay: 0
[2023-07-27 13:12:46] [config] lr-decay-freq: 50000
[2023-07-27 13:12:46] [config] lr-decay-inv-sqrt:
[2023-07-27 13:12:46] [config]   - 0
[2023-07-27 13:12:46] [config] lr-decay-repeat-warmup: false
[2023-07-27 13:12:46] [config] lr-decay-reset-optimizer: false
[2023-07-27 13:12:46] [config] lr-decay-start:
[2023-07-27 13:12:46] [config]   - 10
[2023-07-27 13:12:46] [config]   - 1
[2023-07-27 13:12:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 13:12:46] [config] lr-report: false
[2023-07-27 13:12:46] [config] lr-warmup: 0
[2023-07-27 13:12:46] [config] lr-warmup-at-reload: false
[2023-07-27 13:12:46] [config] lr-warmup-cycle: false
[2023-07-27 13:12:46] [config] lr-warmup-start-rate: 0
[2023-07-27 13:12:46] [config] max-length: 50
[2023-07-27 13:12:46] [config] max-length-crop: true
[2023-07-27 13:12:46] [config] max-length-factor: 3
[2023-07-27 13:12:46] [config] maxi-batch: 100
[2023-07-27 13:12:46] [config] maxi-batch-sort: trg
[2023-07-27 13:12:46] [config] mini-batch: 64
[2023-07-27 13:12:46] [config] mini-batch-fit: true
[2023-07-27 13:12:46] [config] mini-batch-fit-step: 10
[2023-07-27 13:12:46] [config] mini-batch-round-up: true
[2023-07-27 13:12:46] [config] mini-batch-track-lr: false
[2023-07-27 13:12:46] [config] mini-batch-warmup: 0
[2023-07-27 13:12:46] [config] mini-batch-words: 0
[2023-07-27 13:12:46] [config] mini-batch-words-ref: 0
[2023-07-27 13:12:46] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 13:12:46] [config] multi-loss-type: sum
[2023-07-27 13:12:46] [config] n-best: false
[2023-07-27 13:12:46] [config] no-nccl: false
[2023-07-27 13:12:46] [config] no-reload: false
[2023-07-27 13:12:46] [config] no-restore-corpus: false
[2023-07-27 13:12:46] [config] normalize: 0
[2023-07-27 13:12:46] [config] normalize-gradient: false
[2023-07-27 13:12:46] [config] num-devices: 0
[2023-07-27 13:12:46] [config] optimizer: adam
[2023-07-27 13:12:46] [config] optimizer-delay: 1
[2023-07-27 13:12:46] [config] optimizer-params:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] output-omit-bias: false
[2023-07-27 13:12:46] [config] overwrite: true
[2023-07-27 13:12:46] [config] precision:
[2023-07-27 13:12:46] [config]   - float16
[2023-07-27 13:12:46] [config]   - float32
[2023-07-27 13:12:46] [config] pretrained-model: ""
[2023-07-27 13:12:46] [config] quantize-biases: false
[2023-07-27 13:12:46] [config] quantize-bits: 0
[2023-07-27 13:12:46] [config] quantize-log-based: false
[2023-07-27 13:12:46] [config] quantize-optimization-steps: 0
[2023-07-27 13:12:46] [config] quiet: false
[2023-07-27 13:12:46] [config] quiet-translation: true
[2023-07-27 13:12:46] [config] relative-paths: false
[2023-07-27 13:12:46] [config] right-left: false
[2023-07-27 13:12:46] [config] save-freq: 10000u
[2023-07-27 13:12:46] [config] seed: 1234
[2023-07-27 13:12:46] [config] sentencepiece-alphas:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] sentencepiece-max-lines: 2000000
[2023-07-27 13:12:46] [config] sentencepiece-options: ""
[2023-07-27 13:12:46] [config] sharding: global
[2023-07-27 13:12:46] [config] shuffle: data
[2023-07-27 13:12:46] [config] shuffle-in-ram: false
[2023-07-27 13:12:46] [config] sigterm: save-and-exit
[2023-07-27 13:12:46] [config] skip: false
[2023-07-27 13:12:46] [config] sqlite: ""
[2023-07-27 13:12:46] [config] sqlite-drop: false
[2023-07-27 13:12:46] [config] sync-freq: 200u
[2023-07-27 13:12:46] [config] sync-sgd: false
[2023-07-27 13:12:46] [config] tempdir: /tmp
[2023-07-27 13:12:46] [config] tied-embeddings: false
[2023-07-27 13:12:46] [config] tied-embeddings-all: true
[2023-07-27 13:12:46] [config] tied-embeddings-src: false
[2023-07-27 13:12:46] [config] train-embedder-rank:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] train-sets:
[2023-07-27 13:12:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 13:12:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 13:12:46] [config] transformer-aan-activation: swish
[2023-07-27 13:12:46] [config] transformer-aan-depth: 2
[2023-07-27 13:12:46] [config] transformer-aan-nogate: false
[2023-07-27 13:12:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 13:12:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 13:12:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 13:12:46] [config] transformer-depth-scaling: false
[2023-07-27 13:12:46] [config] transformer-dim-aan: 2048
[2023-07-27 13:12:46] [config] transformer-dim-ffn: 2048
[2023-07-27 13:12:46] [config] transformer-dropout: 0
[2023-07-27 13:12:46] [config] transformer-dropout-attention: 0
[2023-07-27 13:12:46] [config] transformer-dropout-ffn: 0
[2023-07-27 13:12:46] [config] transformer-ffn-activation: swish
[2023-07-27 13:12:46] [config] transformer-ffn-depth: 2
[2023-07-27 13:12:46] [config] transformer-guided-alignment-layer: last
[2023-07-27 13:12:46] [config] transformer-heads: 8
[2023-07-27 13:12:46] [config] transformer-no-projection: false
[2023-07-27 13:12:46] [config] transformer-pool: false
[2023-07-27 13:12:46] [config] transformer-postprocess: dan
[2023-07-27 13:12:46] [config] transformer-postprocess-emb: d
[2023-07-27 13:12:46] [config] transformer-postprocess-top: ""
[2023-07-27 13:12:46] [config] transformer-preprocess: ""
[2023-07-27 13:12:46] [config] transformer-tied-layers:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] transformer-train-position-embeddings: false
[2023-07-27 13:12:46] [config] tsv: false
[2023-07-27 13:12:46] [config] tsv-fields: 0
[2023-07-27 13:12:46] [config] type: s2s
[2023-07-27 13:12:46] [config] ulr: false
[2023-07-27 13:12:46] [config] ulr-dim-emb: 0
[2023-07-27 13:12:46] [config] ulr-dropout: 0
[2023-07-27 13:12:46] [config] ulr-keys-vectors: ""
[2023-07-27 13:12:46] [config] ulr-query-vectors: ""
[2023-07-27 13:12:46] [config] ulr-softmax-temperature: 1
[2023-07-27 13:12:46] [config] ulr-trainable-transformation: false
[2023-07-27 13:12:46] [config] unlikelihood-loss: false
[2023-07-27 13:12:46] [config] valid-freq: 50000000
[2023-07-27 13:12:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 13:12:46] [config] valid-max-length: 1000
[2023-07-27 13:12:46] [config] valid-metrics:
[2023-07-27 13:12:46] [config]   - translation
[2023-07-27 13:12:46] [config] valid-mini-batch: 32
[2023-07-27 13:12:46] [config] valid-reset-stalled: false
[2023-07-27 13:12:46] [config] valid-script-args:
[2023-07-27 13:12:46] [config]   []
[2023-07-27 13:12:46] [config] valid-script-path: ""
[2023-07-27 13:12:46] [config] valid-sets:
[2023-07-27 13:12:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 13:12:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 13:12:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 13:12:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:12:46] [config] vocabs:
[2023-07-27 13:12:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 13:12:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 13:12:46] [config] word-penalty: 0
[2023-07-27 13:12:46] [config] word-scores: false
[2023-07-27 13:12:46] [config] workspace: 5500
[2023-07-27 13:12:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:12:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:12:46] [training] Using single-device training
[2023-07-27 13:12:47] Synced seed 1234
[2023-07-27 13:12:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 13:12:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 13:12:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 13:12:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 13:12:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 13:12:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:12:47] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 13:12:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 13:12:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 13:12:47] [comm] Using global sharding
[2023-07-27 13:12:47] [comm] NCCLCommunicators constructed successfully
[2023-07-27 13:12:47] [training] Using 1 GPUs
[2023-07-27 13:12:47] [logits] Applying loss function for 1 factor(s)
[2023-07-27 13:12:47] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:12:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 13:12:48] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:14:20] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 13:14:20] [valid] No post-processing script given for validating translator
[2023-07-27 13:14:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:14:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 13:14:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 13:14:21] [comm] Using global sharding
[2023-07-27 13:14:21] [comm] NCCLCommunicators constructed successfully
[2023-07-27 13:14:21] [training] Using 1 GPUs
[2023-07-27 13:14:21] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 13:14:25] Allocating memory for general optimizer shards
[2023-07-27 13:14:25] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 13:14:25] Loading Adam parameters
[2023-07-27 13:14:26] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 13:14:26] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:14:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 13:14:28] [data] Restoring the corpus state to epoch 61, batch 4829
[2023-07-27 13:14:28] [data] Shuffling data
[2023-07-27 13:14:28] [data] Done reading 20,192 sentences
[2023-07-27 13:14:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:14:28] Training started
[2023-07-27 13:14:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 13:14:28] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:14:30] Parameter type float16, optimization type float32, casting types true
[2023-07-27 13:17:40] Seen 20,192 samples
[2023-07-27 13:17:40] Starting data epoch 62 in logical epoch 62
[2023-07-27 13:17:40] [data] Shuffling data
[2023-07-27 13:17:40] [data] Done reading 20,192 sentences
[2023-07-27 13:17:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:20:55] Seen 20,192 samples
[2023-07-27 13:20:55] Starting data epoch 63 in logical epoch 63
[2023-07-27 13:20:55] [data] Shuffling data
[2023-07-27 13:20:55] [data] Done reading 20,192 sentences
[2023-07-27 13:20:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:21:14] Ep. 63 : Up. 5000 : Sen. 2,018 : Cost 3.82712245 * 7,045,361 @ 6,991 after 35,216,206 : Time 413.74s : 17028.63 words/s : gNorm 2.4765
[2023-07-27 13:24:04] Seen 20,192 samples
[2023-07-27 13:24:04] Starting data epoch 64 in logical epoch 64
[2023-07-27 13:24:04] [data] Shuffling data
[2023-07-27 13:24:04] [data] Done reading 20,192 sentences
[2023-07-27 13:24:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:27:17] Seen 20,192 samples
[2023-07-27 13:27:17] Starting data epoch 65 in logical epoch 65
[2023-07-27 13:27:17] [data] Shuffling data
[2023-07-27 13:27:17] [data] Done reading 20,192 sentences
[2023-07-27 13:27:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:30:29] Seen 20,192 samples
[2023-07-27 13:30:29] Starting data epoch 66 in logical epoch 66
[2023-07-27 13:30:29] [data] Shuffling data
[2023-07-27 13:30:29] [data] Done reading 20,192 sentences
[2023-07-27 13:30:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:33:40] Seen 20,192 samples
[2023-07-27 13:33:40] Starting data epoch 67 in logical epoch 67
[2023-07-27 13:33:40] [data] Shuffling data
[2023-07-27 13:33:40] [data] Done reading 20,192 sentences
[2023-07-27 13:33:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:36:51] Seen 20,192 samples
[2023-07-27 13:36:51] Starting data epoch 68 in logical epoch 68
[2023-07-27 13:36:51] [data] Shuffling data
[2023-07-27 13:36:51] [data] Done reading 20,192 sentences
[2023-07-27 13:36:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:40:02] Seen 20,192 samples
[2023-07-27 13:40:02] Starting data epoch 69 in logical epoch 69
[2023-07-27 13:40:02] [data] Shuffling data
[2023-07-27 13:40:02] [data] Done reading 20,192 sentences
[2023-07-27 13:40:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:43:14] Seen 20,192 samples
[2023-07-27 13:43:14] Starting data epoch 70 in logical epoch 70
[2023-07-27 13:43:14] [data] Shuffling data
[2023-07-27 13:43:14] [data] Done reading 20,192 sentences
[2023-07-27 13:43:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:46:27] Seen 20,192 samples
[2023-07-27 13:46:27] Starting data epoch 71 in logical epoch 71
[2023-07-27 13:46:27] Training finished
[2023-07-27 13:47:43] [valid] Ep. 71 : Up. 5632 : translation : 0 : new best
[2023-07-27 13:47:43] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 13:47:50] Saving Adam parameters
[2023-07-27 13:47:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 13:48:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:48:10] [marian] Running on node05.datos.cluster.uy as process 9852 with command line:
[2023-07-27 13:48:10] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 13:48:10] [config] after: 0e
[2023-07-27 13:48:10] [config] after-batches: 0
[2023-07-27 13:48:10] [config] after-epochs: 80
[2023-07-27 13:48:10] [config] all-caps-every: 0
[2023-07-27 13:48:10] [config] allow-unk: false
[2023-07-27 13:48:10] [config] authors: false
[2023-07-27 13:48:10] [config] beam-size: 12
[2023-07-27 13:48:10] [config] bert-class-symbol: "[CLS]"
[2023-07-27 13:48:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 13:48:10] [config] bert-masking-fraction: 0.15
[2023-07-27 13:48:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 13:48:10] [config] bert-train-type-embeddings: true
[2023-07-27 13:48:10] [config] bert-type-vocab-size: 2
[2023-07-27 13:48:10] [config] build-info: ""
[2023-07-27 13:48:10] [config] check-gradient-nan: false
[2023-07-27 13:48:10] [config] check-nan: false
[2023-07-27 13:48:10] [config] cite: false
[2023-07-27 13:48:10] [config] clip-norm: 1
[2023-07-27 13:48:10] [config] cost-scaling:
[2023-07-27 13:48:10] [config]   - 256.f
[2023-07-27 13:48:10] [config]   - 1000
[2023-07-27 13:48:10] [config]   - 2.f
[2023-07-27 13:48:10] [config]   - 256.f
[2023-07-27 13:48:10] [config] cost-type: ce-sum
[2023-07-27 13:48:10] [config] cpu-threads: 0
[2023-07-27 13:48:10] [config] data-threads: 8
[2023-07-27 13:48:10] [config] data-weighting: ""
[2023-07-27 13:48:10] [config] data-weighting-type: sentence
[2023-07-27 13:48:10] [config] dec-cell: gru
[2023-07-27 13:48:10] [config] dec-cell-base-depth: 2
[2023-07-27 13:48:10] [config] dec-cell-high-depth: 1
[2023-07-27 13:48:10] [config] dec-depth: 8
[2023-07-27 13:48:10] [config] devices:
[2023-07-27 13:48:10] [config]   - 0
[2023-07-27 13:48:10] [config] dim-emb: 512
[2023-07-27 13:48:10] [config] dim-rnn: 1024
[2023-07-27 13:48:10] [config] dim-vocabs:
[2023-07-27 13:48:10] [config]   - 16384
[2023-07-27 13:48:10] [config]   - 16384
[2023-07-27 13:48:10] [config] disp-first: 0
[2023-07-27 13:48:10] [config] disp-freq: 1000u
[2023-07-27 13:48:10] [config] disp-label-counts: true
[2023-07-27 13:48:10] [config] dropout-rnn: 0
[2023-07-27 13:48:10] [config] dropout-src: 0
[2023-07-27 13:48:10] [config] dropout-trg: 0
[2023-07-27 13:48:10] [config] dump-config: ""
[2023-07-27 13:48:10] [config] dynamic-gradient-scaling:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] early-stopping: 1000
[2023-07-27 13:48:10] [config] early-stopping-on: first
[2023-07-27 13:48:10] [config] embedding-fix-src: false
[2023-07-27 13:48:10] [config] embedding-fix-trg: false
[2023-07-27 13:48:10] [config] embedding-normalization: false
[2023-07-27 13:48:10] [config] embedding-vectors:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] enc-cell: gru
[2023-07-27 13:48:10] [config] enc-cell-depth: 1
[2023-07-27 13:48:10] [config] enc-depth: 8
[2023-07-27 13:48:10] [config] enc-type: bidirectional
[2023-07-27 13:48:10] [config] english-title-case-every: 0
[2023-07-27 13:48:10] [config] exponential-smoothing: 0
[2023-07-27 13:48:10] [config] factor-weight: 1
[2023-07-27 13:48:10] [config] factors-combine: sum
[2023-07-27 13:48:10] [config] factors-dim-emb: 0
[2023-07-27 13:48:10] [config] gradient-checkpointing: false
[2023-07-27 13:48:10] [config] gradient-norm-average-window: 100
[2023-07-27 13:48:10] [config] guided-alignment: none
[2023-07-27 13:48:10] [config] guided-alignment-cost: mse
[2023-07-27 13:48:10] [config] guided-alignment-weight: 0.1
[2023-07-27 13:48:10] [config] ignore-model-config: false
[2023-07-27 13:48:10] [config] input-types:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] interpolate-env-vars: false
[2023-07-27 13:48:10] [config] keep-best: false
[2023-07-27 13:48:10] [config] label-smoothing: 0
[2023-07-27 13:48:10] [config] layer-normalization: false
[2023-07-27 13:48:10] [config] learn-rate: 0.0001
[2023-07-27 13:48:10] [config] lemma-dependency: ""
[2023-07-27 13:48:10] [config] lemma-dim-emb: 0
[2023-07-27 13:48:10] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 13:48:10] [config] log-level: info
[2023-07-27 13:48:10] [config] log-time-zone: ""
[2023-07-27 13:48:10] [config] logical-epoch:
[2023-07-27 13:48:10] [config]   - 1e
[2023-07-27 13:48:10] [config]   - 0
[2023-07-27 13:48:10] [config] lr-decay: 0
[2023-07-27 13:48:10] [config] lr-decay-freq: 50000
[2023-07-27 13:48:10] [config] lr-decay-inv-sqrt:
[2023-07-27 13:48:10] [config]   - 0
[2023-07-27 13:48:10] [config] lr-decay-repeat-warmup: false
[2023-07-27 13:48:10] [config] lr-decay-reset-optimizer: false
[2023-07-27 13:48:10] [config] lr-decay-start:
[2023-07-27 13:48:10] [config]   - 10
[2023-07-27 13:48:10] [config]   - 1
[2023-07-27 13:48:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 13:48:10] [config] lr-report: false
[2023-07-27 13:48:10] [config] lr-warmup: 0
[2023-07-27 13:48:10] [config] lr-warmup-at-reload: false
[2023-07-27 13:48:10] [config] lr-warmup-cycle: false
[2023-07-27 13:48:10] [config] lr-warmup-start-rate: 0
[2023-07-27 13:48:10] [config] max-length: 50
[2023-07-27 13:48:10] [config] max-length-crop: true
[2023-07-27 13:48:10] [config] max-length-factor: 3
[2023-07-27 13:48:10] [config] maxi-batch: 100
[2023-07-27 13:48:10] [config] maxi-batch-sort: trg
[2023-07-27 13:48:10] [config] mini-batch: 64
[2023-07-27 13:48:10] [config] mini-batch-fit: true
[2023-07-27 13:48:10] [config] mini-batch-fit-step: 10
[2023-07-27 13:48:10] [config] mini-batch-round-up: true
[2023-07-27 13:48:10] [config] mini-batch-track-lr: false
[2023-07-27 13:48:10] [config] mini-batch-warmup: 0
[2023-07-27 13:48:10] [config] mini-batch-words: 0
[2023-07-27 13:48:10] [config] mini-batch-words-ref: 0
[2023-07-27 13:48:10] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 13:48:10] [config] multi-loss-type: sum
[2023-07-27 13:48:10] [config] n-best: false
[2023-07-27 13:48:10] [config] no-nccl: false
[2023-07-27 13:48:10] [config] no-reload: false
[2023-07-27 13:48:10] [config] no-restore-corpus: false
[2023-07-27 13:48:10] [config] normalize: 0
[2023-07-27 13:48:10] [config] normalize-gradient: false
[2023-07-27 13:48:10] [config] num-devices: 0
[2023-07-27 13:48:10] [config] optimizer: adam
[2023-07-27 13:48:10] [config] optimizer-delay: 1
[2023-07-27 13:48:10] [config] optimizer-params:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] output-omit-bias: false
[2023-07-27 13:48:10] [config] overwrite: true
[2023-07-27 13:48:10] [config] precision:
[2023-07-27 13:48:10] [config]   - float16
[2023-07-27 13:48:10] [config]   - float32
[2023-07-27 13:48:10] [config] pretrained-model: ""
[2023-07-27 13:48:10] [config] quantize-biases: false
[2023-07-27 13:48:10] [config] quantize-bits: 0
[2023-07-27 13:48:10] [config] quantize-log-based: false
[2023-07-27 13:48:10] [config] quantize-optimization-steps: 0
[2023-07-27 13:48:10] [config] quiet: false
[2023-07-27 13:48:10] [config] quiet-translation: true
[2023-07-27 13:48:10] [config] relative-paths: false
[2023-07-27 13:48:10] [config] right-left: false
[2023-07-27 13:48:10] [config] save-freq: 10000u
[2023-07-27 13:48:10] [config] seed: 1234
[2023-07-27 13:48:10] [config] sentencepiece-alphas:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] sentencepiece-max-lines: 2000000
[2023-07-27 13:48:10] [config] sentencepiece-options: ""
[2023-07-27 13:48:10] [config] sharding: global
[2023-07-27 13:48:10] [config] shuffle: data
[2023-07-27 13:48:10] [config] shuffle-in-ram: false
[2023-07-27 13:48:10] [config] sigterm: save-and-exit
[2023-07-27 13:48:10] [config] skip: false
[2023-07-27 13:48:10] [config] sqlite: ""
[2023-07-27 13:48:10] [config] sqlite-drop: false
[2023-07-27 13:48:10] [config] sync-freq: 200u
[2023-07-27 13:48:10] [config] sync-sgd: false
[2023-07-27 13:48:10] [config] tempdir: /tmp
[2023-07-27 13:48:10] [config] tied-embeddings: false
[2023-07-27 13:48:10] [config] tied-embeddings-all: true
[2023-07-27 13:48:10] [config] tied-embeddings-src: false
[2023-07-27 13:48:10] [config] train-embedder-rank:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] train-sets:
[2023-07-27 13:48:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 13:48:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 13:48:10] [config] transformer-aan-activation: swish
[2023-07-27 13:48:10] [config] transformer-aan-depth: 2
[2023-07-27 13:48:10] [config] transformer-aan-nogate: false
[2023-07-27 13:48:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 13:48:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 13:48:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 13:48:10] [config] transformer-depth-scaling: false
[2023-07-27 13:48:10] [config] transformer-dim-aan: 2048
[2023-07-27 13:48:10] [config] transformer-dim-ffn: 2048
[2023-07-27 13:48:10] [config] transformer-dropout: 0
[2023-07-27 13:48:10] [config] transformer-dropout-attention: 0
[2023-07-27 13:48:10] [config] transformer-dropout-ffn: 0
[2023-07-27 13:48:10] [config] transformer-ffn-activation: swish
[2023-07-27 13:48:10] [config] transformer-ffn-depth: 2
[2023-07-27 13:48:10] [config] transformer-guided-alignment-layer: last
[2023-07-27 13:48:10] [config] transformer-heads: 8
[2023-07-27 13:48:10] [config] transformer-no-projection: false
[2023-07-27 13:48:10] [config] transformer-pool: false
[2023-07-27 13:48:10] [config] transformer-postprocess: dan
[2023-07-27 13:48:10] [config] transformer-postprocess-emb: d
[2023-07-27 13:48:10] [config] transformer-postprocess-top: ""
[2023-07-27 13:48:10] [config] transformer-preprocess: ""
[2023-07-27 13:48:10] [config] transformer-tied-layers:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] transformer-train-position-embeddings: false
[2023-07-27 13:48:10] [config] tsv: false
[2023-07-27 13:48:10] [config] tsv-fields: 0
[2023-07-27 13:48:10] [config] type: s2s
[2023-07-27 13:48:10] [config] ulr: false
[2023-07-27 13:48:10] [config] ulr-dim-emb: 0
[2023-07-27 13:48:10] [config] ulr-dropout: 0
[2023-07-27 13:48:10] [config] ulr-keys-vectors: ""
[2023-07-27 13:48:10] [config] ulr-query-vectors: ""
[2023-07-27 13:48:10] [config] ulr-softmax-temperature: 1
[2023-07-27 13:48:10] [config] ulr-trainable-transformation: false
[2023-07-27 13:48:10] [config] unlikelihood-loss: false
[2023-07-27 13:48:10] [config] valid-freq: 50000000
[2023-07-27 13:48:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 13:48:10] [config] valid-max-length: 1000
[2023-07-27 13:48:10] [config] valid-metrics:
[2023-07-27 13:48:10] [config]   - translation
[2023-07-27 13:48:10] [config] valid-mini-batch: 32
[2023-07-27 13:48:10] [config] valid-reset-stalled: false
[2023-07-27 13:48:10] [config] valid-script-args:
[2023-07-27 13:48:10] [config]   []
[2023-07-27 13:48:10] [config] valid-script-path: ""
[2023-07-27 13:48:10] [config] valid-sets:
[2023-07-27 13:48:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 13:48:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 13:48:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 13:48:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:48:10] [config] vocabs:
[2023-07-27 13:48:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 13:48:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 13:48:10] [config] word-penalty: 0
[2023-07-27 13:48:10] [config] word-scores: false
[2023-07-27 13:48:10] [config] workspace: 5500
[2023-07-27 13:48:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:48:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:48:10] [training] Using single-device training
[2023-07-27 13:48:11] Synced seed 1234
[2023-07-27 13:48:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 13:48:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 13:48:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 13:48:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 13:48:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 13:48:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:48:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 13:48:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 13:48:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 13:48:12] [comm] Using global sharding
[2023-07-27 13:48:12] [comm] NCCLCommunicators constructed successfully
[2023-07-27 13:48:12] [training] Using 1 GPUs
[2023-07-27 13:48:12] [logits] Applying loss function for 1 factor(s)
[2023-07-27 13:48:12] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:48:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 13:48:13] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:49:44] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 13:49:44] [valid] No post-processing script given for validating translator
[2023-07-27 13:49:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:49:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 13:49:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 13:49:44] [comm] Using global sharding
[2023-07-27 13:49:45] [comm] NCCLCommunicators constructed successfully
[2023-07-27 13:49:45] [training] Using 1 GPUs
[2023-07-27 13:49:45] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 13:49:49] Allocating memory for general optimizer shards
[2023-07-27 13:49:49] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 13:49:49] Loading Adam parameters
[2023-07-27 13:49:50] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 13:49:50] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:49:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 13:49:52] [data] Restoring the corpus state to epoch 71, batch 5632
[2023-07-27 13:49:52] [data] Shuffling data
[2023-07-27 13:49:52] [data] Done reading 20,192 sentences
[2023-07-27 13:49:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:49:52] Training started
[2023-07-27 13:49:52] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 13:49:52] [memory] Reserving 332 MB, device gpu0
[2023-07-27 13:49:53] Parameter type float16, optimization type float32, casting types true
[2023-07-27 13:53:02] Seen 20,192 samples
[2023-07-27 13:53:02] Starting data epoch 72 in logical epoch 72
[2023-07-27 13:53:02] [data] Shuffling data
[2023-07-27 13:53:02] [data] Done reading 20,192 sentences
[2023-07-27 13:53:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:56:11] Seen 20,192 samples
[2023-07-27 13:56:11] Starting data epoch 73 in logical epoch 73
[2023-07-27 13:56:11] [data] Shuffling data
[2023-07-27 13:56:11] [data] Done reading 20,192 sentences
[2023-07-27 13:56:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 13:59:23] Seen 20,192 samples
[2023-07-27 13:59:23] Starting data epoch 74 in logical epoch 74
[2023-07-27 13:59:23] [data] Shuffling data
[2023-07-27 13:59:23] [data] Done reading 20,192 sentences
[2023-07-27 13:59:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:02:34] Seen 20,192 samples
[2023-07-27 14:02:34] Starting data epoch 75 in logical epoch 75
[2023-07-27 14:02:34] [data] Shuffling data
[2023-07-27 14:02:34] [data] Done reading 20,192 sentences
[2023-07-27 14:02:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:04:24] Ep. 75 : Up. 6000 : Sen. 11,556 : Cost 3.35765767 * 7,076,090 @ 5,708 after 42,292,296 : Time 880.15s : 8039.61 words/s : gNorm 2.8840
[2023-07-27 14:05:46] Seen 20,192 samples
[2023-07-27 14:05:46] Starting data epoch 76 in logical epoch 76
[2023-07-27 14:05:46] [data] Shuffling data
[2023-07-27 14:05:46] [data] Done reading 20,192 sentences
[2023-07-27 14:05:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:08:56] Seen 20,192 samples
[2023-07-27 14:08:56] Starting data epoch 77 in logical epoch 77
[2023-07-27 14:08:56] [data] Shuffling data
[2023-07-27 14:08:56] [data] Done reading 20,192 sentences
[2023-07-27 14:08:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:12:08] Seen 20,192 samples
[2023-07-27 14:12:08] Starting data epoch 78 in logical epoch 78
[2023-07-27 14:12:08] [data] Shuffling data
[2023-07-27 14:12:08] [data] Done reading 20,192 sentences
[2023-07-27 14:12:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:15:17] Seen 20,192 samples
[2023-07-27 14:15:17] Starting data epoch 79 in logical epoch 79
[2023-07-27 14:15:17] [data] Shuffling data
[2023-07-27 14:15:17] [data] Done reading 20,192 sentences
[2023-07-27 14:15:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:18:29] Seen 20,192 samples
[2023-07-27 14:18:29] Starting data epoch 80 in logical epoch 80
[2023-07-27 14:18:29] [data] Shuffling data
[2023-07-27 14:18:29] [data] Done reading 20,192 sentences
[2023-07-27 14:18:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:21:40] Seen 20,192 samples
[2023-07-27 14:21:40] Starting data epoch 81 in logical epoch 81
[2023-07-27 14:21:40] Training finished
[2023-07-27 14:22:54] [valid] Ep. 81 : Up. 6438 : translation : 0 : new best
[2023-07-27 14:22:54] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 14:23:02] Saving Adam parameters
[2023-07-27 14:23:04] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 14:23:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:23:24] [marian] Running on node05.datos.cluster.uy as process 12444 with command line:
[2023-07-27 14:23:24] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 14:23:24] [config] after: 0e
[2023-07-27 14:23:24] [config] after-batches: 0
[2023-07-27 14:23:24] [config] after-epochs: 90
[2023-07-27 14:23:24] [config] all-caps-every: 0
[2023-07-27 14:23:24] [config] allow-unk: false
[2023-07-27 14:23:24] [config] authors: false
[2023-07-27 14:23:24] [config] beam-size: 12
[2023-07-27 14:23:24] [config] bert-class-symbol: "[CLS]"
[2023-07-27 14:23:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 14:23:24] [config] bert-masking-fraction: 0.15
[2023-07-27 14:23:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 14:23:24] [config] bert-train-type-embeddings: true
[2023-07-27 14:23:24] [config] bert-type-vocab-size: 2
[2023-07-27 14:23:24] [config] build-info: ""
[2023-07-27 14:23:24] [config] check-gradient-nan: false
[2023-07-27 14:23:24] [config] check-nan: false
[2023-07-27 14:23:24] [config] cite: false
[2023-07-27 14:23:24] [config] clip-norm: 1
[2023-07-27 14:23:24] [config] cost-scaling:
[2023-07-27 14:23:24] [config]   - 256.f
[2023-07-27 14:23:24] [config]   - 1000
[2023-07-27 14:23:24] [config]   - 2.f
[2023-07-27 14:23:24] [config]   - 256.f
[2023-07-27 14:23:24] [config] cost-type: ce-sum
[2023-07-27 14:23:24] [config] cpu-threads: 0
[2023-07-27 14:23:24] [config] data-threads: 8
[2023-07-27 14:23:24] [config] data-weighting: ""
[2023-07-27 14:23:24] [config] data-weighting-type: sentence
[2023-07-27 14:23:24] [config] dec-cell: gru
[2023-07-27 14:23:24] [config] dec-cell-base-depth: 2
[2023-07-27 14:23:24] [config] dec-cell-high-depth: 1
[2023-07-27 14:23:24] [config] dec-depth: 8
[2023-07-27 14:23:24] [config] devices:
[2023-07-27 14:23:24] [config]   - 0
[2023-07-27 14:23:24] [config] dim-emb: 512
[2023-07-27 14:23:24] [config] dim-rnn: 1024
[2023-07-27 14:23:24] [config] dim-vocabs:
[2023-07-27 14:23:24] [config]   - 16384
[2023-07-27 14:23:24] [config]   - 16384
[2023-07-27 14:23:24] [config] disp-first: 0
[2023-07-27 14:23:24] [config] disp-freq: 1000u
[2023-07-27 14:23:24] [config] disp-label-counts: true
[2023-07-27 14:23:24] [config] dropout-rnn: 0
[2023-07-27 14:23:24] [config] dropout-src: 0
[2023-07-27 14:23:24] [config] dropout-trg: 0
[2023-07-27 14:23:24] [config] dump-config: ""
[2023-07-27 14:23:24] [config] dynamic-gradient-scaling:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] early-stopping: 1000
[2023-07-27 14:23:24] [config] early-stopping-on: first
[2023-07-27 14:23:24] [config] embedding-fix-src: false
[2023-07-27 14:23:24] [config] embedding-fix-trg: false
[2023-07-27 14:23:24] [config] embedding-normalization: false
[2023-07-27 14:23:24] [config] embedding-vectors:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] enc-cell: gru
[2023-07-27 14:23:24] [config] enc-cell-depth: 1
[2023-07-27 14:23:24] [config] enc-depth: 8
[2023-07-27 14:23:24] [config] enc-type: bidirectional
[2023-07-27 14:23:24] [config] english-title-case-every: 0
[2023-07-27 14:23:24] [config] exponential-smoothing: 0
[2023-07-27 14:23:24] [config] factor-weight: 1
[2023-07-27 14:23:24] [config] factors-combine: sum
[2023-07-27 14:23:24] [config] factors-dim-emb: 0
[2023-07-27 14:23:24] [config] gradient-checkpointing: false
[2023-07-27 14:23:24] [config] gradient-norm-average-window: 100
[2023-07-27 14:23:24] [config] guided-alignment: none
[2023-07-27 14:23:24] [config] guided-alignment-cost: mse
[2023-07-27 14:23:24] [config] guided-alignment-weight: 0.1
[2023-07-27 14:23:24] [config] ignore-model-config: false
[2023-07-27 14:23:24] [config] input-types:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] interpolate-env-vars: false
[2023-07-27 14:23:24] [config] keep-best: false
[2023-07-27 14:23:24] [config] label-smoothing: 0
[2023-07-27 14:23:24] [config] layer-normalization: false
[2023-07-27 14:23:24] [config] learn-rate: 0.0001
[2023-07-27 14:23:24] [config] lemma-dependency: ""
[2023-07-27 14:23:24] [config] lemma-dim-emb: 0
[2023-07-27 14:23:24] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 14:23:24] [config] log-level: info
[2023-07-27 14:23:24] [config] log-time-zone: ""
[2023-07-27 14:23:24] [config] logical-epoch:
[2023-07-27 14:23:24] [config]   - 1e
[2023-07-27 14:23:24] [config]   - 0
[2023-07-27 14:23:24] [config] lr-decay: 0
[2023-07-27 14:23:24] [config] lr-decay-freq: 50000
[2023-07-27 14:23:24] [config] lr-decay-inv-sqrt:
[2023-07-27 14:23:24] [config]   - 0
[2023-07-27 14:23:24] [config] lr-decay-repeat-warmup: false
[2023-07-27 14:23:24] [config] lr-decay-reset-optimizer: false
[2023-07-27 14:23:24] [config] lr-decay-start:
[2023-07-27 14:23:24] [config]   - 10
[2023-07-27 14:23:24] [config]   - 1
[2023-07-27 14:23:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 14:23:24] [config] lr-report: false
[2023-07-27 14:23:24] [config] lr-warmup: 0
[2023-07-27 14:23:24] [config] lr-warmup-at-reload: false
[2023-07-27 14:23:24] [config] lr-warmup-cycle: false
[2023-07-27 14:23:24] [config] lr-warmup-start-rate: 0
[2023-07-27 14:23:24] [config] max-length: 50
[2023-07-27 14:23:24] [config] max-length-crop: true
[2023-07-27 14:23:24] [config] max-length-factor: 3
[2023-07-27 14:23:24] [config] maxi-batch: 100
[2023-07-27 14:23:24] [config] maxi-batch-sort: trg
[2023-07-27 14:23:24] [config] mini-batch: 64
[2023-07-27 14:23:24] [config] mini-batch-fit: true
[2023-07-27 14:23:24] [config] mini-batch-fit-step: 10
[2023-07-27 14:23:24] [config] mini-batch-round-up: true
[2023-07-27 14:23:24] [config] mini-batch-track-lr: false
[2023-07-27 14:23:24] [config] mini-batch-warmup: 0
[2023-07-27 14:23:24] [config] mini-batch-words: 0
[2023-07-27 14:23:24] [config] mini-batch-words-ref: 0
[2023-07-27 14:23:24] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 14:23:24] [config] multi-loss-type: sum
[2023-07-27 14:23:24] [config] n-best: false
[2023-07-27 14:23:24] [config] no-nccl: false
[2023-07-27 14:23:24] [config] no-reload: false
[2023-07-27 14:23:24] [config] no-restore-corpus: false
[2023-07-27 14:23:24] [config] normalize: 0
[2023-07-27 14:23:24] [config] normalize-gradient: false
[2023-07-27 14:23:24] [config] num-devices: 0
[2023-07-27 14:23:24] [config] optimizer: adam
[2023-07-27 14:23:24] [config] optimizer-delay: 1
[2023-07-27 14:23:24] [config] optimizer-params:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] output-omit-bias: false
[2023-07-27 14:23:24] [config] overwrite: true
[2023-07-27 14:23:24] [config] precision:
[2023-07-27 14:23:24] [config]   - float16
[2023-07-27 14:23:24] [config]   - float32
[2023-07-27 14:23:24] [config] pretrained-model: ""
[2023-07-27 14:23:24] [config] quantize-biases: false
[2023-07-27 14:23:24] [config] quantize-bits: 0
[2023-07-27 14:23:24] [config] quantize-log-based: false
[2023-07-27 14:23:24] [config] quantize-optimization-steps: 0
[2023-07-27 14:23:24] [config] quiet: false
[2023-07-27 14:23:24] [config] quiet-translation: true
[2023-07-27 14:23:24] [config] relative-paths: false
[2023-07-27 14:23:24] [config] right-left: false
[2023-07-27 14:23:24] [config] save-freq: 10000u
[2023-07-27 14:23:24] [config] seed: 1234
[2023-07-27 14:23:24] [config] sentencepiece-alphas:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] sentencepiece-max-lines: 2000000
[2023-07-27 14:23:24] [config] sentencepiece-options: ""
[2023-07-27 14:23:24] [config] sharding: global
[2023-07-27 14:23:24] [config] shuffle: data
[2023-07-27 14:23:24] [config] shuffle-in-ram: false
[2023-07-27 14:23:24] [config] sigterm: save-and-exit
[2023-07-27 14:23:24] [config] skip: false
[2023-07-27 14:23:24] [config] sqlite: ""
[2023-07-27 14:23:24] [config] sqlite-drop: false
[2023-07-27 14:23:24] [config] sync-freq: 200u
[2023-07-27 14:23:24] [config] sync-sgd: false
[2023-07-27 14:23:24] [config] tempdir: /tmp
[2023-07-27 14:23:24] [config] tied-embeddings: false
[2023-07-27 14:23:24] [config] tied-embeddings-all: true
[2023-07-27 14:23:24] [config] tied-embeddings-src: false
[2023-07-27 14:23:24] [config] train-embedder-rank:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] train-sets:
[2023-07-27 14:23:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 14:23:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 14:23:24] [config] transformer-aan-activation: swish
[2023-07-27 14:23:24] [config] transformer-aan-depth: 2
[2023-07-27 14:23:24] [config] transformer-aan-nogate: false
[2023-07-27 14:23:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 14:23:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 14:23:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 14:23:24] [config] transformer-depth-scaling: false
[2023-07-27 14:23:24] [config] transformer-dim-aan: 2048
[2023-07-27 14:23:24] [config] transformer-dim-ffn: 2048
[2023-07-27 14:23:24] [config] transformer-dropout: 0
[2023-07-27 14:23:24] [config] transformer-dropout-attention: 0
[2023-07-27 14:23:24] [config] transformer-dropout-ffn: 0
[2023-07-27 14:23:24] [config] transformer-ffn-activation: swish
[2023-07-27 14:23:24] [config] transformer-ffn-depth: 2
[2023-07-27 14:23:24] [config] transformer-guided-alignment-layer: last
[2023-07-27 14:23:24] [config] transformer-heads: 8
[2023-07-27 14:23:24] [config] transformer-no-projection: false
[2023-07-27 14:23:24] [config] transformer-pool: false
[2023-07-27 14:23:24] [config] transformer-postprocess: dan
[2023-07-27 14:23:24] [config] transformer-postprocess-emb: d
[2023-07-27 14:23:24] [config] transformer-postprocess-top: ""
[2023-07-27 14:23:24] [config] transformer-preprocess: ""
[2023-07-27 14:23:24] [config] transformer-tied-layers:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] transformer-train-position-embeddings: false
[2023-07-27 14:23:24] [config] tsv: false
[2023-07-27 14:23:24] [config] tsv-fields: 0
[2023-07-27 14:23:24] [config] type: s2s
[2023-07-27 14:23:24] [config] ulr: false
[2023-07-27 14:23:24] [config] ulr-dim-emb: 0
[2023-07-27 14:23:24] [config] ulr-dropout: 0
[2023-07-27 14:23:24] [config] ulr-keys-vectors: ""
[2023-07-27 14:23:24] [config] ulr-query-vectors: ""
[2023-07-27 14:23:24] [config] ulr-softmax-temperature: 1
[2023-07-27 14:23:24] [config] ulr-trainable-transformation: false
[2023-07-27 14:23:24] [config] unlikelihood-loss: false
[2023-07-27 14:23:24] [config] valid-freq: 50000000
[2023-07-27 14:23:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 14:23:24] [config] valid-max-length: 1000
[2023-07-27 14:23:24] [config] valid-metrics:
[2023-07-27 14:23:24] [config]   - translation
[2023-07-27 14:23:24] [config] valid-mini-batch: 32
[2023-07-27 14:23:24] [config] valid-reset-stalled: false
[2023-07-27 14:23:24] [config] valid-script-args:
[2023-07-27 14:23:24] [config]   []
[2023-07-27 14:23:24] [config] valid-script-path: ""
[2023-07-27 14:23:24] [config] valid-sets:
[2023-07-27 14:23:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 14:23:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 14:23:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 14:23:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:23:24] [config] vocabs:
[2023-07-27 14:23:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 14:23:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 14:23:24] [config] word-penalty: 0
[2023-07-27 14:23:24] [config] word-scores: false
[2023-07-27 14:23:24] [config] workspace: 5500
[2023-07-27 14:23:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:23:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:23:24] [training] Using single-device training
[2023-07-27 14:23:24] Synced seed 1234
[2023-07-27 14:23:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 14:23:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 14:23:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 14:23:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 14:23:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 14:23:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:23:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 14:23:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 14:23:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 14:23:25] [comm] Using global sharding
[2023-07-27 14:23:25] [comm] NCCLCommunicators constructed successfully
[2023-07-27 14:23:25] [training] Using 1 GPUs
[2023-07-27 14:23:25] [logits] Applying loss function for 1 factor(s)
[2023-07-27 14:23:25] [memory] Reserving 332 MB, device gpu0
[2023-07-27 14:23:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 14:23:26] [memory] Reserving 332 MB, device gpu0
[2023-07-27 14:24:57] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 14:24:57] [valid] No post-processing script given for validating translator
[2023-07-27 14:24:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:24:58] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 14:24:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 14:24:58] [comm] Using global sharding
[2023-07-27 14:24:58] [comm] NCCLCommunicators constructed successfully
[2023-07-27 14:24:58] [training] Using 1 GPUs
[2023-07-27 14:24:58] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 14:25:02] Allocating memory for general optimizer shards
[2023-07-27 14:25:02] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 14:25:02] Loading Adam parameters
[2023-07-27 14:25:03] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 14:25:03] [memory] Reserving 332 MB, device gpu0
[2023-07-27 14:25:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 14:25:04] [data] Restoring the corpus state to epoch 81, batch 6438
[2023-07-27 14:25:04] [data] Shuffling data
[2023-07-27 14:25:05] [data] Done reading 20,192 sentences
[2023-07-27 14:25:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:25:05] Training started
[2023-07-27 14:25:05] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 14:25:05] [memory] Reserving 332 MB, device gpu0
[2023-07-27 14:25:07] Parameter type float16, optimization type float32, casting types true
[2023-07-27 14:28:10] Seen 20,192 samples
[2023-07-27 14:28:10] Starting data epoch 82 in logical epoch 82
[2023-07-27 14:28:10] [data] Shuffling data
[2023-07-27 14:28:10] [data] Done reading 20,192 sentences
[2023-07-27 14:28:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:31:21] Seen 20,192 samples
[2023-07-27 14:31:21] Starting data epoch 83 in logical epoch 83
[2023-07-27 14:31:21] [data] Shuffling data
[2023-07-27 14:31:21] [data] Done reading 20,192 sentences
[2023-07-27 14:31:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:34:32] Seen 20,192 samples
[2023-07-27 14:34:32] Starting data epoch 84 in logical epoch 84
[2023-07-27 14:34:32] [data] Shuffling data
[2023-07-27 14:34:32] [data] Done reading 20,192 sentences
[2023-07-27 14:34:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:37:42] Seen 20,192 samples
[2023-07-27 14:37:42] Starting data epoch 85 in logical epoch 85
[2023-07-27 14:37:42] [data] Shuffling data
[2023-07-27 14:37:42] [data] Done reading 20,192 sentences
[2023-07-27 14:37:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:40:54] Seen 20,192 samples
[2023-07-27 14:40:54] Starting data epoch 86 in logical epoch 86
[2023-07-27 14:40:54] [data] Shuffling data
[2023-07-27 14:40:54] [data] Done reading 20,192 sentences
[2023-07-27 14:40:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:44:06] Seen 20,192 samples
[2023-07-27 14:44:06] Starting data epoch 87 in logical epoch 87
[2023-07-27 14:44:06] [data] Shuffling data
[2023-07-27 14:44:06] [data] Done reading 20,192 sentences
[2023-07-27 14:44:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:47:08] Ep. 87 : Up. 7000 : Sen. 19,416 : Cost 2.94547510 * 7,023,503 @ 5,406 after 49,315,799 : Time 1331.28s : 5275.75 words/s : gNorm 2.8330
[2023-07-27 14:47:16] Seen 20,192 samples
[2023-07-27 14:47:16] Starting data epoch 88 in logical epoch 88
[2023-07-27 14:47:16] [data] Shuffling data
[2023-07-27 14:47:16] [data] Done reading 20,192 sentences
[2023-07-27 14:47:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:50:26] Seen 20,192 samples
[2023-07-27 14:50:26] Starting data epoch 89 in logical epoch 89
[2023-07-27 14:50:26] [data] Shuffling data
[2023-07-27 14:50:26] [data] Done reading 20,192 sentences
[2023-07-27 14:50:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:53:36] Seen 20,192 samples
[2023-07-27 14:53:36] Starting data epoch 90 in logical epoch 90
[2023-07-27 14:53:36] [data] Shuffling data
[2023-07-27 14:53:36] [data] Done reading 20,192 sentences
[2023-07-27 14:53:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:56:47] Seen 20,192 samples
[2023-07-27 14:56:47] Starting data epoch 91 in logical epoch 91
[2023-07-27 14:56:47] Training finished
[2023-07-27 14:58:01] [valid] Ep. 91 : Up. 7245 : translation : 0 : new best
[2023-07-27 14:58:01] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 14:58:08] Saving Adam parameters
[2023-07-27 14:58:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 14:58:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:58:29] [marian] Running on node05.datos.cluster.uy as process 14654 with command line:
[2023-07-27 14:58:29] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 14:58:29] [config] after: 0e
[2023-07-27 14:58:29] [config] after-batches: 0
[2023-07-27 14:58:29] [config] after-epochs: 100
[2023-07-27 14:58:29] [config] all-caps-every: 0
[2023-07-27 14:58:29] [config] allow-unk: false
[2023-07-27 14:58:29] [config] authors: false
[2023-07-27 14:58:29] [config] beam-size: 12
[2023-07-27 14:58:29] [config] bert-class-symbol: "[CLS]"
[2023-07-27 14:58:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 14:58:29] [config] bert-masking-fraction: 0.15
[2023-07-27 14:58:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 14:58:29] [config] bert-train-type-embeddings: true
[2023-07-27 14:58:29] [config] bert-type-vocab-size: 2
[2023-07-27 14:58:29] [config] build-info: ""
[2023-07-27 14:58:29] [config] check-gradient-nan: false
[2023-07-27 14:58:29] [config] check-nan: false
[2023-07-27 14:58:29] [config] cite: false
[2023-07-27 14:58:29] [config] clip-norm: 1
[2023-07-27 14:58:29] [config] cost-scaling:
[2023-07-27 14:58:29] [config]   - 256.f
[2023-07-27 14:58:29] [config]   - 1000
[2023-07-27 14:58:29] [config]   - 2.f
[2023-07-27 14:58:29] [config]   - 256.f
[2023-07-27 14:58:29] [config] cost-type: ce-sum
[2023-07-27 14:58:29] [config] cpu-threads: 0
[2023-07-27 14:58:29] [config] data-threads: 8
[2023-07-27 14:58:29] [config] data-weighting: ""
[2023-07-27 14:58:29] [config] data-weighting-type: sentence
[2023-07-27 14:58:29] [config] dec-cell: gru
[2023-07-27 14:58:29] [config] dec-cell-base-depth: 2
[2023-07-27 14:58:29] [config] dec-cell-high-depth: 1
[2023-07-27 14:58:29] [config] dec-depth: 8
[2023-07-27 14:58:29] [config] devices:
[2023-07-27 14:58:29] [config]   - 0
[2023-07-27 14:58:29] [config] dim-emb: 512
[2023-07-27 14:58:29] [config] dim-rnn: 1024
[2023-07-27 14:58:29] [config] dim-vocabs:
[2023-07-27 14:58:29] [config]   - 16384
[2023-07-27 14:58:29] [config]   - 16384
[2023-07-27 14:58:29] [config] disp-first: 0
[2023-07-27 14:58:29] [config] disp-freq: 1000u
[2023-07-27 14:58:29] [config] disp-label-counts: true
[2023-07-27 14:58:29] [config] dropout-rnn: 0
[2023-07-27 14:58:29] [config] dropout-src: 0
[2023-07-27 14:58:29] [config] dropout-trg: 0
[2023-07-27 14:58:29] [config] dump-config: ""
[2023-07-27 14:58:29] [config] dynamic-gradient-scaling:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] early-stopping: 1000
[2023-07-27 14:58:29] [config] early-stopping-on: first
[2023-07-27 14:58:29] [config] embedding-fix-src: false
[2023-07-27 14:58:29] [config] embedding-fix-trg: false
[2023-07-27 14:58:29] [config] embedding-normalization: false
[2023-07-27 14:58:29] [config] embedding-vectors:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] enc-cell: gru
[2023-07-27 14:58:29] [config] enc-cell-depth: 1
[2023-07-27 14:58:29] [config] enc-depth: 8
[2023-07-27 14:58:29] [config] enc-type: bidirectional
[2023-07-27 14:58:29] [config] english-title-case-every: 0
[2023-07-27 14:58:29] [config] exponential-smoothing: 0
[2023-07-27 14:58:29] [config] factor-weight: 1
[2023-07-27 14:58:29] [config] factors-combine: sum
[2023-07-27 14:58:29] [config] factors-dim-emb: 0
[2023-07-27 14:58:29] [config] gradient-checkpointing: false
[2023-07-27 14:58:29] [config] gradient-norm-average-window: 100
[2023-07-27 14:58:29] [config] guided-alignment: none
[2023-07-27 14:58:29] [config] guided-alignment-cost: mse
[2023-07-27 14:58:29] [config] guided-alignment-weight: 0.1
[2023-07-27 14:58:29] [config] ignore-model-config: false
[2023-07-27 14:58:29] [config] input-types:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] interpolate-env-vars: false
[2023-07-27 14:58:29] [config] keep-best: false
[2023-07-27 14:58:29] [config] label-smoothing: 0
[2023-07-27 14:58:29] [config] layer-normalization: false
[2023-07-27 14:58:29] [config] learn-rate: 0.0001
[2023-07-27 14:58:29] [config] lemma-dependency: ""
[2023-07-27 14:58:29] [config] lemma-dim-emb: 0
[2023-07-27 14:58:29] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 14:58:29] [config] log-level: info
[2023-07-27 14:58:29] [config] log-time-zone: ""
[2023-07-27 14:58:29] [config] logical-epoch:
[2023-07-27 14:58:29] [config]   - 1e
[2023-07-27 14:58:29] [config]   - 0
[2023-07-27 14:58:29] [config] lr-decay: 0
[2023-07-27 14:58:29] [config] lr-decay-freq: 50000
[2023-07-27 14:58:29] [config] lr-decay-inv-sqrt:
[2023-07-27 14:58:29] [config]   - 0
[2023-07-27 14:58:29] [config] lr-decay-repeat-warmup: false
[2023-07-27 14:58:29] [config] lr-decay-reset-optimizer: false
[2023-07-27 14:58:29] [config] lr-decay-start:
[2023-07-27 14:58:29] [config]   - 10
[2023-07-27 14:58:29] [config]   - 1
[2023-07-27 14:58:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 14:58:29] [config] lr-report: false
[2023-07-27 14:58:29] [config] lr-warmup: 0
[2023-07-27 14:58:29] [config] lr-warmup-at-reload: false
[2023-07-27 14:58:29] [config] lr-warmup-cycle: false
[2023-07-27 14:58:29] [config] lr-warmup-start-rate: 0
[2023-07-27 14:58:29] [config] max-length: 50
[2023-07-27 14:58:29] [config] max-length-crop: true
[2023-07-27 14:58:29] [config] max-length-factor: 3
[2023-07-27 14:58:29] [config] maxi-batch: 100
[2023-07-27 14:58:29] [config] maxi-batch-sort: trg
[2023-07-27 14:58:29] [config] mini-batch: 64
[2023-07-27 14:58:29] [config] mini-batch-fit: true
[2023-07-27 14:58:29] [config] mini-batch-fit-step: 10
[2023-07-27 14:58:29] [config] mini-batch-round-up: true
[2023-07-27 14:58:29] [config] mini-batch-track-lr: false
[2023-07-27 14:58:29] [config] mini-batch-warmup: 0
[2023-07-27 14:58:29] [config] mini-batch-words: 0
[2023-07-27 14:58:29] [config] mini-batch-words-ref: 0
[2023-07-27 14:58:29] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 14:58:29] [config] multi-loss-type: sum
[2023-07-27 14:58:29] [config] n-best: false
[2023-07-27 14:58:29] [config] no-nccl: false
[2023-07-27 14:58:29] [config] no-reload: false
[2023-07-27 14:58:29] [config] no-restore-corpus: false
[2023-07-27 14:58:29] [config] normalize: 0
[2023-07-27 14:58:29] [config] normalize-gradient: false
[2023-07-27 14:58:29] [config] num-devices: 0
[2023-07-27 14:58:29] [config] optimizer: adam
[2023-07-27 14:58:29] [config] optimizer-delay: 1
[2023-07-27 14:58:29] [config] optimizer-params:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] output-omit-bias: false
[2023-07-27 14:58:29] [config] overwrite: true
[2023-07-27 14:58:29] [config] precision:
[2023-07-27 14:58:29] [config]   - float16
[2023-07-27 14:58:29] [config]   - float32
[2023-07-27 14:58:29] [config] pretrained-model: ""
[2023-07-27 14:58:29] [config] quantize-biases: false
[2023-07-27 14:58:29] [config] quantize-bits: 0
[2023-07-27 14:58:29] [config] quantize-log-based: false
[2023-07-27 14:58:29] [config] quantize-optimization-steps: 0
[2023-07-27 14:58:29] [config] quiet: false
[2023-07-27 14:58:29] [config] quiet-translation: true
[2023-07-27 14:58:29] [config] relative-paths: false
[2023-07-27 14:58:29] [config] right-left: false
[2023-07-27 14:58:29] [config] save-freq: 10000u
[2023-07-27 14:58:29] [config] seed: 1234
[2023-07-27 14:58:29] [config] sentencepiece-alphas:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] sentencepiece-max-lines: 2000000
[2023-07-27 14:58:29] [config] sentencepiece-options: ""
[2023-07-27 14:58:29] [config] sharding: global
[2023-07-27 14:58:29] [config] shuffle: data
[2023-07-27 14:58:29] [config] shuffle-in-ram: false
[2023-07-27 14:58:29] [config] sigterm: save-and-exit
[2023-07-27 14:58:29] [config] skip: false
[2023-07-27 14:58:29] [config] sqlite: ""
[2023-07-27 14:58:29] [config] sqlite-drop: false
[2023-07-27 14:58:29] [config] sync-freq: 200u
[2023-07-27 14:58:29] [config] sync-sgd: false
[2023-07-27 14:58:29] [config] tempdir: /tmp
[2023-07-27 14:58:29] [config] tied-embeddings: false
[2023-07-27 14:58:29] [config] tied-embeddings-all: true
[2023-07-27 14:58:29] [config] tied-embeddings-src: false
[2023-07-27 14:58:29] [config] train-embedder-rank:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] train-sets:
[2023-07-27 14:58:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 14:58:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 14:58:29] [config] transformer-aan-activation: swish
[2023-07-27 14:58:29] [config] transformer-aan-depth: 2
[2023-07-27 14:58:29] [config] transformer-aan-nogate: false
[2023-07-27 14:58:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 14:58:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 14:58:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 14:58:29] [config] transformer-depth-scaling: false
[2023-07-27 14:58:29] [config] transformer-dim-aan: 2048
[2023-07-27 14:58:29] [config] transformer-dim-ffn: 2048
[2023-07-27 14:58:29] [config] transformer-dropout: 0
[2023-07-27 14:58:29] [config] transformer-dropout-attention: 0
[2023-07-27 14:58:29] [config] transformer-dropout-ffn: 0
[2023-07-27 14:58:29] [config] transformer-ffn-activation: swish
[2023-07-27 14:58:29] [config] transformer-ffn-depth: 2
[2023-07-27 14:58:29] [config] transformer-guided-alignment-layer: last
[2023-07-27 14:58:29] [config] transformer-heads: 8
[2023-07-27 14:58:29] [config] transformer-no-projection: false
[2023-07-27 14:58:29] [config] transformer-pool: false
[2023-07-27 14:58:29] [config] transformer-postprocess: dan
[2023-07-27 14:58:29] [config] transformer-postprocess-emb: d
[2023-07-27 14:58:29] [config] transformer-postprocess-top: ""
[2023-07-27 14:58:29] [config] transformer-preprocess: ""
[2023-07-27 14:58:29] [config] transformer-tied-layers:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] transformer-train-position-embeddings: false
[2023-07-27 14:58:29] [config] tsv: false
[2023-07-27 14:58:29] [config] tsv-fields: 0
[2023-07-27 14:58:29] [config] type: s2s
[2023-07-27 14:58:29] [config] ulr: false
[2023-07-27 14:58:29] [config] ulr-dim-emb: 0
[2023-07-27 14:58:29] [config] ulr-dropout: 0
[2023-07-27 14:58:29] [config] ulr-keys-vectors: ""
[2023-07-27 14:58:29] [config] ulr-query-vectors: ""
[2023-07-27 14:58:29] [config] ulr-softmax-temperature: 1
[2023-07-27 14:58:29] [config] ulr-trainable-transformation: false
[2023-07-27 14:58:29] [config] unlikelihood-loss: false
[2023-07-27 14:58:29] [config] valid-freq: 50000000
[2023-07-27 14:58:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 14:58:29] [config] valid-max-length: 1000
[2023-07-27 14:58:29] [config] valid-metrics:
[2023-07-27 14:58:29] [config]   - translation
[2023-07-27 14:58:29] [config] valid-mini-batch: 32
[2023-07-27 14:58:29] [config] valid-reset-stalled: false
[2023-07-27 14:58:29] [config] valid-script-args:
[2023-07-27 14:58:29] [config]   []
[2023-07-27 14:58:29] [config] valid-script-path: ""
[2023-07-27 14:58:29] [config] valid-sets:
[2023-07-27 14:58:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 14:58:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 14:58:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 14:58:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:58:29] [config] vocabs:
[2023-07-27 14:58:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 14:58:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 14:58:29] [config] word-penalty: 0
[2023-07-27 14:58:29] [config] word-scores: false
[2023-07-27 14:58:29] [config] workspace: 5500
[2023-07-27 14:58:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:58:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:58:29] [training] Using single-device training
[2023-07-27 14:58:29] Synced seed 1234
[2023-07-27 14:58:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 14:58:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 14:58:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 14:58:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 14:58:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 14:58:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:58:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 14:58:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 14:58:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 14:58:30] [comm] Using global sharding
[2023-07-27 14:58:30] [comm] NCCLCommunicators constructed successfully
[2023-07-27 14:58:30] [training] Using 1 GPUs
[2023-07-27 14:58:30] [logits] Applying loss function for 1 factor(s)
[2023-07-27 14:58:30] [memory] Reserving 332 MB, device gpu0
[2023-07-27 14:58:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 14:58:31] [memory] Reserving 332 MB, device gpu0
[2023-07-27 15:00:03] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 15:00:03] [valid] No post-processing script given for validating translator
[2023-07-27 15:00:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 15:00:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 15:00:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 15:00:04] [comm] Using global sharding
[2023-07-27 15:00:04] [comm] NCCLCommunicators constructed successfully
[2023-07-27 15:00:04] [training] Using 1 GPUs
[2023-07-27 15:00:04] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 15:00:08] Allocating memory for general optimizer shards
[2023-07-27 15:00:08] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 15:00:08] Loading Adam parameters
[2023-07-27 15:00:09] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 15:00:09] [memory] Reserving 332 MB, device gpu0
[2023-07-27 15:00:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 15:00:11] [data] Restoring the corpus state to epoch 91, batch 7245
[2023-07-27 15:00:11] [data] Shuffling data
[2023-07-27 15:00:11] [data] Done reading 20,192 sentences
[2023-07-27 15:00:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:00:11] Training started
[2023-07-27 15:00:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 15:00:11] [memory] Reserving 332 MB, device gpu0
[2023-07-27 15:00:13] Parameter type float16, optimization type float32, casting types true
[2023-07-27 15:03:19] Seen 20,192 samples
[2023-07-27 15:03:19] Starting data epoch 92 in logical epoch 92
[2023-07-27 15:03:19] [data] Shuffling data
[2023-07-27 15:03:19] [data] Done reading 20,192 sentences
[2023-07-27 15:03:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:06:29] Seen 20,192 samples
[2023-07-27 15:06:29] Starting data epoch 93 in logical epoch 93
[2023-07-27 15:06:29] [data] Shuffling data
[2023-07-27 15:06:29] [data] Done reading 20,192 sentences
[2023-07-27 15:06:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:09:39] Seen 20,192 samples
[2023-07-27 15:09:39] Starting data epoch 94 in logical epoch 94
[2023-07-27 15:09:39] [data] Shuffling data
[2023-07-27 15:09:39] [data] Done reading 20,192 sentences
[2023-07-27 15:09:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:12:49] Seen 20,192 samples
[2023-07-27 15:12:49] Starting data epoch 95 in logical epoch 95
[2023-07-27 15:12:49] [data] Shuffling data
[2023-07-27 15:12:49] [data] Done reading 20,192 sentences
[2023-07-27 15:12:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:15:58] Seen 20,192 samples
[2023-07-27 15:15:58] Starting data epoch 96 in logical epoch 96
[2023-07-27 15:15:58] [data] Shuffling data
[2023-07-27 15:15:58] [data] Done reading 20,192 sentences
[2023-07-27 15:15:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:19:08] Seen 20,192 samples
[2023-07-27 15:19:08] Starting data epoch 97 in logical epoch 97
[2023-07-27 15:19:08] [data] Shuffling data
[2023-07-27 15:19:08] [data] Done reading 20,192 sentences
[2023-07-27 15:19:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:22:17] Seen 20,192 samples
[2023-07-27 15:22:17] Starting data epoch 98 in logical epoch 98
[2023-07-27 15:22:17] [data] Shuffling data
[2023-07-27 15:22:17] [data] Done reading 20,192 sentences
[2023-07-27 15:22:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:25:26] Seen 20,192 samples
[2023-07-27 15:25:26] Starting data epoch 99 in logical epoch 99
[2023-07-27 15:25:26] [data] Shuffling data
[2023-07-27 15:25:26] [data] Done reading 20,192 sentences
[2023-07-27 15:25:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:28:36] Seen 20,192 samples
[2023-07-27 15:28:36] Starting data epoch 100 in logical epoch 100
[2023-07-27 15:28:36] [data] Shuffling data
[2023-07-27 15:28:36] [data] Done reading 20,192 sentences
[2023-07-27 15:28:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:29:52] Ep. 100 : Up. 8000 : Sen. 7,986 : Cost 2.51052213 * 7,056,961 @ 10,800 after 56,372,760 : Time 1788.12s : 3946.59 words/s : gNorm 3.1714
[2023-07-27 15:31:45] Seen 20,192 samples
[2023-07-27 15:31:45] Starting data epoch 101 in logical epoch 101
[2023-07-27 15:31:45] Training finished
[2023-07-27 15:32:58] [valid] Ep. 101 : Up. 8048 : translation : 0 : new best
[2023-07-27 15:32:58] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 15:33:08] Saving Adam parameters
[2023-07-27 15:33:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 15:33:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 15:33:28] [marian] Running on node05.datos.cluster.uy as process 16910 with command line:
[2023-07-27 15:33:28] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 15:33:29] [config] after: 0e
[2023-07-27 15:33:29] [config] after-batches: 0
[2023-07-27 15:33:29] [config] after-epochs: 110
[2023-07-27 15:33:29] [config] all-caps-every: 0
[2023-07-27 15:33:29] [config] allow-unk: false
[2023-07-27 15:33:29] [config] authors: false
[2023-07-27 15:33:29] [config] beam-size: 12
[2023-07-27 15:33:29] [config] bert-class-symbol: "[CLS]"
[2023-07-27 15:33:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 15:33:29] [config] bert-masking-fraction: 0.15
[2023-07-27 15:33:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 15:33:29] [config] bert-train-type-embeddings: true
[2023-07-27 15:33:29] [config] bert-type-vocab-size: 2
[2023-07-27 15:33:29] [config] build-info: ""
[2023-07-27 15:33:29] [config] check-gradient-nan: false
[2023-07-27 15:33:29] [config] check-nan: false
[2023-07-27 15:33:29] [config] cite: false
[2023-07-27 15:33:29] [config] clip-norm: 1
[2023-07-27 15:33:29] [config] cost-scaling:
[2023-07-27 15:33:29] [config]   - 256.f
[2023-07-27 15:33:29] [config]   - 1000
[2023-07-27 15:33:29] [config]   - 2.f
[2023-07-27 15:33:29] [config]   - 256.f
[2023-07-27 15:33:29] [config] cost-type: ce-sum
[2023-07-27 15:33:29] [config] cpu-threads: 0
[2023-07-27 15:33:29] [config] data-threads: 8
[2023-07-27 15:33:29] [config] data-weighting: ""
[2023-07-27 15:33:29] [config] data-weighting-type: sentence
[2023-07-27 15:33:29] [config] dec-cell: gru
[2023-07-27 15:33:29] [config] dec-cell-base-depth: 2
[2023-07-27 15:33:29] [config] dec-cell-high-depth: 1
[2023-07-27 15:33:29] [config] dec-depth: 8
[2023-07-27 15:33:29] [config] devices:
[2023-07-27 15:33:29] [config]   - 0
[2023-07-27 15:33:29] [config] dim-emb: 512
[2023-07-27 15:33:29] [config] dim-rnn: 1024
[2023-07-27 15:33:29] [config] dim-vocabs:
[2023-07-27 15:33:29] [config]   - 16384
[2023-07-27 15:33:29] [config]   - 16384
[2023-07-27 15:33:29] [config] disp-first: 0
[2023-07-27 15:33:29] [config] disp-freq: 1000u
[2023-07-27 15:33:29] [config] disp-label-counts: true
[2023-07-27 15:33:29] [config] dropout-rnn: 0
[2023-07-27 15:33:29] [config] dropout-src: 0
[2023-07-27 15:33:29] [config] dropout-trg: 0
[2023-07-27 15:33:29] [config] dump-config: ""
[2023-07-27 15:33:29] [config] dynamic-gradient-scaling:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] early-stopping: 1000
[2023-07-27 15:33:29] [config] early-stopping-on: first
[2023-07-27 15:33:29] [config] embedding-fix-src: false
[2023-07-27 15:33:29] [config] embedding-fix-trg: false
[2023-07-27 15:33:29] [config] embedding-normalization: false
[2023-07-27 15:33:29] [config] embedding-vectors:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] enc-cell: gru
[2023-07-27 15:33:29] [config] enc-cell-depth: 1
[2023-07-27 15:33:29] [config] enc-depth: 8
[2023-07-27 15:33:29] [config] enc-type: bidirectional
[2023-07-27 15:33:29] [config] english-title-case-every: 0
[2023-07-27 15:33:29] [config] exponential-smoothing: 0
[2023-07-27 15:33:29] [config] factor-weight: 1
[2023-07-27 15:33:29] [config] factors-combine: sum
[2023-07-27 15:33:29] [config] factors-dim-emb: 0
[2023-07-27 15:33:29] [config] gradient-checkpointing: false
[2023-07-27 15:33:29] [config] gradient-norm-average-window: 100
[2023-07-27 15:33:29] [config] guided-alignment: none
[2023-07-27 15:33:29] [config] guided-alignment-cost: mse
[2023-07-27 15:33:29] [config] guided-alignment-weight: 0.1
[2023-07-27 15:33:29] [config] ignore-model-config: false
[2023-07-27 15:33:29] [config] input-types:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] interpolate-env-vars: false
[2023-07-27 15:33:29] [config] keep-best: false
[2023-07-27 15:33:29] [config] label-smoothing: 0
[2023-07-27 15:33:29] [config] layer-normalization: false
[2023-07-27 15:33:29] [config] learn-rate: 0.0001
[2023-07-27 15:33:29] [config] lemma-dependency: ""
[2023-07-27 15:33:29] [config] lemma-dim-emb: 0
[2023-07-27 15:33:29] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 15:33:29] [config] log-level: info
[2023-07-27 15:33:29] [config] log-time-zone: ""
[2023-07-27 15:33:29] [config] logical-epoch:
[2023-07-27 15:33:29] [config]   - 1e
[2023-07-27 15:33:29] [config]   - 0
[2023-07-27 15:33:29] [config] lr-decay: 0
[2023-07-27 15:33:29] [config] lr-decay-freq: 50000
[2023-07-27 15:33:29] [config] lr-decay-inv-sqrt:
[2023-07-27 15:33:29] [config]   - 0
[2023-07-27 15:33:29] [config] lr-decay-repeat-warmup: false
[2023-07-27 15:33:29] [config] lr-decay-reset-optimizer: false
[2023-07-27 15:33:29] [config] lr-decay-start:
[2023-07-27 15:33:29] [config]   - 10
[2023-07-27 15:33:29] [config]   - 1
[2023-07-27 15:33:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 15:33:29] [config] lr-report: false
[2023-07-27 15:33:29] [config] lr-warmup: 0
[2023-07-27 15:33:29] [config] lr-warmup-at-reload: false
[2023-07-27 15:33:29] [config] lr-warmup-cycle: false
[2023-07-27 15:33:29] [config] lr-warmup-start-rate: 0
[2023-07-27 15:33:29] [config] max-length: 50
[2023-07-27 15:33:29] [config] max-length-crop: true
[2023-07-27 15:33:29] [config] max-length-factor: 3
[2023-07-27 15:33:29] [config] maxi-batch: 100
[2023-07-27 15:33:29] [config] maxi-batch-sort: trg
[2023-07-27 15:33:29] [config] mini-batch: 64
[2023-07-27 15:33:29] [config] mini-batch-fit: true
[2023-07-27 15:33:29] [config] mini-batch-fit-step: 10
[2023-07-27 15:33:29] [config] mini-batch-round-up: true
[2023-07-27 15:33:29] [config] mini-batch-track-lr: false
[2023-07-27 15:33:29] [config] mini-batch-warmup: 0
[2023-07-27 15:33:29] [config] mini-batch-words: 0
[2023-07-27 15:33:29] [config] mini-batch-words-ref: 0
[2023-07-27 15:33:29] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 15:33:29] [config] multi-loss-type: sum
[2023-07-27 15:33:29] [config] n-best: false
[2023-07-27 15:33:29] [config] no-nccl: false
[2023-07-27 15:33:29] [config] no-reload: false
[2023-07-27 15:33:29] [config] no-restore-corpus: false
[2023-07-27 15:33:29] [config] normalize: 0
[2023-07-27 15:33:29] [config] normalize-gradient: false
[2023-07-27 15:33:29] [config] num-devices: 0
[2023-07-27 15:33:29] [config] optimizer: adam
[2023-07-27 15:33:29] [config] optimizer-delay: 1
[2023-07-27 15:33:29] [config] optimizer-params:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] output-omit-bias: false
[2023-07-27 15:33:29] [config] overwrite: true
[2023-07-27 15:33:29] [config] precision:
[2023-07-27 15:33:29] [config]   - float16
[2023-07-27 15:33:29] [config]   - float32
[2023-07-27 15:33:29] [config] pretrained-model: ""
[2023-07-27 15:33:29] [config] quantize-biases: false
[2023-07-27 15:33:29] [config] quantize-bits: 0
[2023-07-27 15:33:29] [config] quantize-log-based: false
[2023-07-27 15:33:29] [config] quantize-optimization-steps: 0
[2023-07-27 15:33:29] [config] quiet: false
[2023-07-27 15:33:29] [config] quiet-translation: true
[2023-07-27 15:33:29] [config] relative-paths: false
[2023-07-27 15:33:29] [config] right-left: false
[2023-07-27 15:33:29] [config] save-freq: 10000u
[2023-07-27 15:33:29] [config] seed: 1234
[2023-07-27 15:33:29] [config] sentencepiece-alphas:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] sentencepiece-max-lines: 2000000
[2023-07-27 15:33:29] [config] sentencepiece-options: ""
[2023-07-27 15:33:29] [config] sharding: global
[2023-07-27 15:33:29] [config] shuffle: data
[2023-07-27 15:33:29] [config] shuffle-in-ram: false
[2023-07-27 15:33:29] [config] sigterm: save-and-exit
[2023-07-27 15:33:29] [config] skip: false
[2023-07-27 15:33:29] [config] sqlite: ""
[2023-07-27 15:33:29] [config] sqlite-drop: false
[2023-07-27 15:33:29] [config] sync-freq: 200u
[2023-07-27 15:33:29] [config] sync-sgd: false
[2023-07-27 15:33:29] [config] tempdir: /tmp
[2023-07-27 15:33:29] [config] tied-embeddings: false
[2023-07-27 15:33:29] [config] tied-embeddings-all: true
[2023-07-27 15:33:29] [config] tied-embeddings-src: false
[2023-07-27 15:33:29] [config] train-embedder-rank:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] train-sets:
[2023-07-27 15:33:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 15:33:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 15:33:29] [config] transformer-aan-activation: swish
[2023-07-27 15:33:29] [config] transformer-aan-depth: 2
[2023-07-27 15:33:29] [config] transformer-aan-nogate: false
[2023-07-27 15:33:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 15:33:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 15:33:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 15:33:29] [config] transformer-depth-scaling: false
[2023-07-27 15:33:29] [config] transformer-dim-aan: 2048
[2023-07-27 15:33:29] [config] transformer-dim-ffn: 2048
[2023-07-27 15:33:29] [config] transformer-dropout: 0
[2023-07-27 15:33:29] [config] transformer-dropout-attention: 0
[2023-07-27 15:33:29] [config] transformer-dropout-ffn: 0
[2023-07-27 15:33:29] [config] transformer-ffn-activation: swish
[2023-07-27 15:33:29] [config] transformer-ffn-depth: 2
[2023-07-27 15:33:29] [config] transformer-guided-alignment-layer: last
[2023-07-27 15:33:29] [config] transformer-heads: 8
[2023-07-27 15:33:29] [config] transformer-no-projection: false
[2023-07-27 15:33:29] [config] transformer-pool: false
[2023-07-27 15:33:29] [config] transformer-postprocess: dan
[2023-07-27 15:33:29] [config] transformer-postprocess-emb: d
[2023-07-27 15:33:29] [config] transformer-postprocess-top: ""
[2023-07-27 15:33:29] [config] transformer-preprocess: ""
[2023-07-27 15:33:29] [config] transformer-tied-layers:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] transformer-train-position-embeddings: false
[2023-07-27 15:33:29] [config] tsv: false
[2023-07-27 15:33:29] [config] tsv-fields: 0
[2023-07-27 15:33:29] [config] type: s2s
[2023-07-27 15:33:29] [config] ulr: false
[2023-07-27 15:33:29] [config] ulr-dim-emb: 0
[2023-07-27 15:33:29] [config] ulr-dropout: 0
[2023-07-27 15:33:29] [config] ulr-keys-vectors: ""
[2023-07-27 15:33:29] [config] ulr-query-vectors: ""
[2023-07-27 15:33:29] [config] ulr-softmax-temperature: 1
[2023-07-27 15:33:29] [config] ulr-trainable-transformation: false
[2023-07-27 15:33:29] [config] unlikelihood-loss: false
[2023-07-27 15:33:29] [config] valid-freq: 50000000
[2023-07-27 15:33:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 15:33:29] [config] valid-max-length: 1000
[2023-07-27 15:33:29] [config] valid-metrics:
[2023-07-27 15:33:29] [config]   - translation
[2023-07-27 15:33:29] [config] valid-mini-batch: 32
[2023-07-27 15:33:29] [config] valid-reset-stalled: false
[2023-07-27 15:33:29] [config] valid-script-args:
[2023-07-27 15:33:29] [config]   []
[2023-07-27 15:33:29] [config] valid-script-path: ""
[2023-07-27 15:33:29] [config] valid-sets:
[2023-07-27 15:33:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 15:33:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 15:33:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 15:33:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 15:33:29] [config] vocabs:
[2023-07-27 15:33:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 15:33:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 15:33:29] [config] word-penalty: 0
[2023-07-27 15:33:29] [config] word-scores: false
[2023-07-27 15:33:29] [config] workspace: 5500
[2023-07-27 15:33:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 15:33:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 15:33:29] [training] Using single-device training
[2023-07-27 15:33:29] Synced seed 1234
[2023-07-27 15:33:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 15:33:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 15:33:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 15:33:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 15:33:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 15:33:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 15:33:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 15:33:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 15:33:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 15:33:30] [comm] Using global sharding
[2023-07-27 15:33:30] [comm] NCCLCommunicators constructed successfully
[2023-07-27 15:33:30] [training] Using 1 GPUs
[2023-07-27 15:33:30] [logits] Applying loss function for 1 factor(s)
[2023-07-27 15:33:30] [memory] Reserving 332 MB, device gpu0
[2023-07-27 15:33:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 15:33:30] [memory] Reserving 332 MB, device gpu0
[2023-07-27 15:35:02] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 15:35:03] [valid] No post-processing script given for validating translator
[2023-07-27 15:35:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 15:35:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 15:35:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 15:35:03] [comm] Using global sharding
[2023-07-27 15:35:03] [comm] NCCLCommunicators constructed successfully
[2023-07-27 15:35:03] [training] Using 1 GPUs
[2023-07-27 15:35:03] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 15:35:08] Allocating memory for general optimizer shards
[2023-07-27 15:35:08] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 15:35:08] Loading Adam parameters
[2023-07-27 15:35:08] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 15:35:09] [memory] Reserving 332 MB, device gpu0
[2023-07-27 15:35:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 15:35:10] [data] Restoring the corpus state to epoch 101, batch 8048
[2023-07-27 15:35:10] [data] Shuffling data
[2023-07-27 15:35:10] [data] Done reading 20,192 sentences
[2023-07-27 15:35:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:35:10] Training started
[2023-07-27 15:35:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 15:35:11] [memory] Reserving 332 MB, device gpu0
[2023-07-27 15:35:13] Parameter type float16, optimization type float32, casting types true
[2023-07-27 15:38:15] Seen 20,192 samples
[2023-07-27 15:38:15] Starting data epoch 102 in logical epoch 102
[2023-07-27 15:38:15] [data] Shuffling data
[2023-07-27 15:38:15] [data] Done reading 20,192 sentences
[2023-07-27 15:38:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:41:25] Seen 20,192 samples
[2023-07-27 15:41:25] Starting data epoch 103 in logical epoch 103
[2023-07-27 15:41:25] [data] Shuffling data
[2023-07-27 15:41:25] [data] Done reading 20,192 sentences
[2023-07-27 15:41:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:44:34] Seen 20,192 samples
[2023-07-27 15:44:34] Starting data epoch 104 in logical epoch 104
[2023-07-27 15:44:34] [data] Shuffling data
[2023-07-27 15:44:34] [data] Done reading 20,192 sentences
[2023-07-27 15:44:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:47:42] Seen 20,192 samples
[2023-07-27 15:47:42] Starting data epoch 105 in logical epoch 105
[2023-07-27 15:47:42] [data] Shuffling data
[2023-07-27 15:47:42] [data] Done reading 20,192 sentences
[2023-07-27 15:47:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:50:51] Seen 20,192 samples
[2023-07-27 15:50:51] Starting data epoch 106 in logical epoch 106
[2023-07-27 15:50:51] [data] Shuffling data
[2023-07-27 15:50:51] [data] Done reading 20,192 sentences
[2023-07-27 15:50:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:53:59] Seen 20,192 samples
[2023-07-27 15:53:59] Starting data epoch 107 in logical epoch 107
[2023-07-27 15:53:59] [data] Shuffling data
[2023-07-27 15:53:59] [data] Done reading 20,192 sentences
[2023-07-27 15:53:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:57:09] Seen 20,192 samples
[2023-07-27 15:57:09] Starting data epoch 108 in logical epoch 108
[2023-07-27 15:57:09] [data] Shuffling data
[2023-07-27 15:57:09] [data] Done reading 20,192 sentences
[2023-07-27 15:57:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:00:17] Seen 20,192 samples
[2023-07-27 16:00:17] Starting data epoch 109 in logical epoch 109
[2023-07-27 16:00:17] [data] Shuffling data
[2023-07-27 16:00:17] [data] Done reading 20,192 sentences
[2023-07-27 16:00:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:03:23] Seen 20,192 samples
[2023-07-27 16:03:23] Starting data epoch 110 in logical epoch 110
[2023-07-27 16:03:23] [data] Shuffling data
[2023-07-27 16:03:23] [data] Done reading 20,192 sentences
[2023-07-27 16:03:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:06:32] Seen 20,192 samples
[2023-07-27 16:06:32] Starting data epoch 111 in logical epoch 111
[2023-07-27 16:06:32] Training finished
[2023-07-27 16:07:45] [valid] Ep. 111 : Up. 8850 : translation : 0 : new best
[2023-07-27 16:07:45] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 16:07:52] Saving Adam parameters
[2023-07-27 16:07:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 16:08:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:08:12] [marian] Running on node05.datos.cluster.uy as process 19115 with command line:
[2023-07-27 16:08:12] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 16:08:12] [config] after: 0e
[2023-07-27 16:08:12] [config] after-batches: 0
[2023-07-27 16:08:12] [config] after-epochs: 120
[2023-07-27 16:08:12] [config] all-caps-every: 0
[2023-07-27 16:08:12] [config] allow-unk: false
[2023-07-27 16:08:12] [config] authors: false
[2023-07-27 16:08:12] [config] beam-size: 12
[2023-07-27 16:08:12] [config] bert-class-symbol: "[CLS]"
[2023-07-27 16:08:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 16:08:12] [config] bert-masking-fraction: 0.15
[2023-07-27 16:08:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 16:08:12] [config] bert-train-type-embeddings: true
[2023-07-27 16:08:12] [config] bert-type-vocab-size: 2
[2023-07-27 16:08:12] [config] build-info: ""
[2023-07-27 16:08:12] [config] check-gradient-nan: false
[2023-07-27 16:08:12] [config] check-nan: false
[2023-07-27 16:08:12] [config] cite: false
[2023-07-27 16:08:12] [config] clip-norm: 1
[2023-07-27 16:08:12] [config] cost-scaling:
[2023-07-27 16:08:12] [config]   - 256.f
[2023-07-27 16:08:12] [config]   - 1000
[2023-07-27 16:08:12] [config]   - 2.f
[2023-07-27 16:08:12] [config]   - 256.f
[2023-07-27 16:08:12] [config] cost-type: ce-sum
[2023-07-27 16:08:12] [config] cpu-threads: 0
[2023-07-27 16:08:12] [config] data-threads: 8
[2023-07-27 16:08:12] [config] data-weighting: ""
[2023-07-27 16:08:12] [config] data-weighting-type: sentence
[2023-07-27 16:08:12] [config] dec-cell: gru
[2023-07-27 16:08:12] [config] dec-cell-base-depth: 2
[2023-07-27 16:08:12] [config] dec-cell-high-depth: 1
[2023-07-27 16:08:12] [config] dec-depth: 8
[2023-07-27 16:08:12] [config] devices:
[2023-07-27 16:08:12] [config]   - 0
[2023-07-27 16:08:12] [config] dim-emb: 512
[2023-07-27 16:08:12] [config] dim-rnn: 1024
[2023-07-27 16:08:12] [config] dim-vocabs:
[2023-07-27 16:08:12] [config]   - 16384
[2023-07-27 16:08:12] [config]   - 16384
[2023-07-27 16:08:12] [config] disp-first: 0
[2023-07-27 16:08:12] [config] disp-freq: 1000u
[2023-07-27 16:08:12] [config] disp-label-counts: true
[2023-07-27 16:08:12] [config] dropout-rnn: 0
[2023-07-27 16:08:12] [config] dropout-src: 0
[2023-07-27 16:08:12] [config] dropout-trg: 0
[2023-07-27 16:08:12] [config] dump-config: ""
[2023-07-27 16:08:12] [config] dynamic-gradient-scaling:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] early-stopping: 1000
[2023-07-27 16:08:12] [config] early-stopping-on: first
[2023-07-27 16:08:12] [config] embedding-fix-src: false
[2023-07-27 16:08:12] [config] embedding-fix-trg: false
[2023-07-27 16:08:12] [config] embedding-normalization: false
[2023-07-27 16:08:12] [config] embedding-vectors:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] enc-cell: gru
[2023-07-27 16:08:12] [config] enc-cell-depth: 1
[2023-07-27 16:08:12] [config] enc-depth: 8
[2023-07-27 16:08:12] [config] enc-type: bidirectional
[2023-07-27 16:08:12] [config] english-title-case-every: 0
[2023-07-27 16:08:12] [config] exponential-smoothing: 0
[2023-07-27 16:08:12] [config] factor-weight: 1
[2023-07-27 16:08:12] [config] factors-combine: sum
[2023-07-27 16:08:12] [config] factors-dim-emb: 0
[2023-07-27 16:08:12] [config] gradient-checkpointing: false
[2023-07-27 16:08:12] [config] gradient-norm-average-window: 100
[2023-07-27 16:08:12] [config] guided-alignment: none
[2023-07-27 16:08:12] [config] guided-alignment-cost: mse
[2023-07-27 16:08:12] [config] guided-alignment-weight: 0.1
[2023-07-27 16:08:12] [config] ignore-model-config: false
[2023-07-27 16:08:12] [config] input-types:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] interpolate-env-vars: false
[2023-07-27 16:08:12] [config] keep-best: false
[2023-07-27 16:08:12] [config] label-smoothing: 0
[2023-07-27 16:08:12] [config] layer-normalization: false
[2023-07-27 16:08:12] [config] learn-rate: 0.0001
[2023-07-27 16:08:12] [config] lemma-dependency: ""
[2023-07-27 16:08:12] [config] lemma-dim-emb: 0
[2023-07-27 16:08:12] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 16:08:12] [config] log-level: info
[2023-07-27 16:08:12] [config] log-time-zone: ""
[2023-07-27 16:08:12] [config] logical-epoch:
[2023-07-27 16:08:12] [config]   - 1e
[2023-07-27 16:08:12] [config]   - 0
[2023-07-27 16:08:12] [config] lr-decay: 0
[2023-07-27 16:08:12] [config] lr-decay-freq: 50000
[2023-07-27 16:08:12] [config] lr-decay-inv-sqrt:
[2023-07-27 16:08:12] [config]   - 0
[2023-07-27 16:08:12] [config] lr-decay-repeat-warmup: false
[2023-07-27 16:08:12] [config] lr-decay-reset-optimizer: false
[2023-07-27 16:08:12] [config] lr-decay-start:
[2023-07-27 16:08:12] [config]   - 10
[2023-07-27 16:08:12] [config]   - 1
[2023-07-27 16:08:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 16:08:12] [config] lr-report: false
[2023-07-27 16:08:12] [config] lr-warmup: 0
[2023-07-27 16:08:12] [config] lr-warmup-at-reload: false
[2023-07-27 16:08:12] [config] lr-warmup-cycle: false
[2023-07-27 16:08:12] [config] lr-warmup-start-rate: 0
[2023-07-27 16:08:12] [config] max-length: 50
[2023-07-27 16:08:12] [config] max-length-crop: true
[2023-07-27 16:08:12] [config] max-length-factor: 3
[2023-07-27 16:08:12] [config] maxi-batch: 100
[2023-07-27 16:08:12] [config] maxi-batch-sort: trg
[2023-07-27 16:08:12] [config] mini-batch: 64
[2023-07-27 16:08:12] [config] mini-batch-fit: true
[2023-07-27 16:08:12] [config] mini-batch-fit-step: 10
[2023-07-27 16:08:12] [config] mini-batch-round-up: true
[2023-07-27 16:08:12] [config] mini-batch-track-lr: false
[2023-07-27 16:08:12] [config] mini-batch-warmup: 0
[2023-07-27 16:08:12] [config] mini-batch-words: 0
[2023-07-27 16:08:12] [config] mini-batch-words-ref: 0
[2023-07-27 16:08:12] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 16:08:12] [config] multi-loss-type: sum
[2023-07-27 16:08:12] [config] n-best: false
[2023-07-27 16:08:12] [config] no-nccl: false
[2023-07-27 16:08:12] [config] no-reload: false
[2023-07-27 16:08:12] [config] no-restore-corpus: false
[2023-07-27 16:08:12] [config] normalize: 0
[2023-07-27 16:08:12] [config] normalize-gradient: false
[2023-07-27 16:08:12] [config] num-devices: 0
[2023-07-27 16:08:12] [config] optimizer: adam
[2023-07-27 16:08:12] [config] optimizer-delay: 1
[2023-07-27 16:08:12] [config] optimizer-params:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] output-omit-bias: false
[2023-07-27 16:08:12] [config] overwrite: true
[2023-07-27 16:08:12] [config] precision:
[2023-07-27 16:08:12] [config]   - float16
[2023-07-27 16:08:12] [config]   - float32
[2023-07-27 16:08:12] [config] pretrained-model: ""
[2023-07-27 16:08:12] [config] quantize-biases: false
[2023-07-27 16:08:12] [config] quantize-bits: 0
[2023-07-27 16:08:12] [config] quantize-log-based: false
[2023-07-27 16:08:12] [config] quantize-optimization-steps: 0
[2023-07-27 16:08:12] [config] quiet: false
[2023-07-27 16:08:12] [config] quiet-translation: true
[2023-07-27 16:08:12] [config] relative-paths: false
[2023-07-27 16:08:12] [config] right-left: false
[2023-07-27 16:08:12] [config] save-freq: 10000u
[2023-07-27 16:08:12] [config] seed: 1234
[2023-07-27 16:08:12] [config] sentencepiece-alphas:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] sentencepiece-max-lines: 2000000
[2023-07-27 16:08:12] [config] sentencepiece-options: ""
[2023-07-27 16:08:12] [config] sharding: global
[2023-07-27 16:08:12] [config] shuffle: data
[2023-07-27 16:08:12] [config] shuffle-in-ram: false
[2023-07-27 16:08:12] [config] sigterm: save-and-exit
[2023-07-27 16:08:12] [config] skip: false
[2023-07-27 16:08:12] [config] sqlite: ""
[2023-07-27 16:08:12] [config] sqlite-drop: false
[2023-07-27 16:08:12] [config] sync-freq: 200u
[2023-07-27 16:08:12] [config] sync-sgd: false
[2023-07-27 16:08:12] [config] tempdir: /tmp
[2023-07-27 16:08:12] [config] tied-embeddings: false
[2023-07-27 16:08:12] [config] tied-embeddings-all: true
[2023-07-27 16:08:12] [config] tied-embeddings-src: false
[2023-07-27 16:08:12] [config] train-embedder-rank:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] train-sets:
[2023-07-27 16:08:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 16:08:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 16:08:12] [config] transformer-aan-activation: swish
[2023-07-27 16:08:12] [config] transformer-aan-depth: 2
[2023-07-27 16:08:12] [config] transformer-aan-nogate: false
[2023-07-27 16:08:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 16:08:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 16:08:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 16:08:12] [config] transformer-depth-scaling: false
[2023-07-27 16:08:12] [config] transformer-dim-aan: 2048
[2023-07-27 16:08:12] [config] transformer-dim-ffn: 2048
[2023-07-27 16:08:12] [config] transformer-dropout: 0
[2023-07-27 16:08:12] [config] transformer-dropout-attention: 0
[2023-07-27 16:08:12] [config] transformer-dropout-ffn: 0
[2023-07-27 16:08:12] [config] transformer-ffn-activation: swish
[2023-07-27 16:08:12] [config] transformer-ffn-depth: 2
[2023-07-27 16:08:12] [config] transformer-guided-alignment-layer: last
[2023-07-27 16:08:12] [config] transformer-heads: 8
[2023-07-27 16:08:12] [config] transformer-no-projection: false
[2023-07-27 16:08:12] [config] transformer-pool: false
[2023-07-27 16:08:12] [config] transformer-postprocess: dan
[2023-07-27 16:08:12] [config] transformer-postprocess-emb: d
[2023-07-27 16:08:12] [config] transformer-postprocess-top: ""
[2023-07-27 16:08:12] [config] transformer-preprocess: ""
[2023-07-27 16:08:12] [config] transformer-tied-layers:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] transformer-train-position-embeddings: false
[2023-07-27 16:08:12] [config] tsv: false
[2023-07-27 16:08:12] [config] tsv-fields: 0
[2023-07-27 16:08:12] [config] type: s2s
[2023-07-27 16:08:12] [config] ulr: false
[2023-07-27 16:08:12] [config] ulr-dim-emb: 0
[2023-07-27 16:08:12] [config] ulr-dropout: 0
[2023-07-27 16:08:12] [config] ulr-keys-vectors: ""
[2023-07-27 16:08:12] [config] ulr-query-vectors: ""
[2023-07-27 16:08:12] [config] ulr-softmax-temperature: 1
[2023-07-27 16:08:12] [config] ulr-trainable-transformation: false
[2023-07-27 16:08:12] [config] unlikelihood-loss: false
[2023-07-27 16:08:12] [config] valid-freq: 50000000
[2023-07-27 16:08:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 16:08:12] [config] valid-max-length: 1000
[2023-07-27 16:08:12] [config] valid-metrics:
[2023-07-27 16:08:12] [config]   - translation
[2023-07-27 16:08:12] [config] valid-mini-batch: 32
[2023-07-27 16:08:12] [config] valid-reset-stalled: false
[2023-07-27 16:08:12] [config] valid-script-args:
[2023-07-27 16:08:12] [config]   []
[2023-07-27 16:08:12] [config] valid-script-path: ""
[2023-07-27 16:08:12] [config] valid-sets:
[2023-07-27 16:08:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 16:08:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 16:08:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 16:08:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:08:12] [config] vocabs:
[2023-07-27 16:08:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 16:08:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 16:08:12] [config] word-penalty: 0
[2023-07-27 16:08:12] [config] word-scores: false
[2023-07-27 16:08:12] [config] workspace: 5500
[2023-07-27 16:08:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:08:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:08:12] [training] Using single-device training
[2023-07-27 16:08:12] Synced seed 1234
[2023-07-27 16:08:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 16:08:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 16:08:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 16:08:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 16:08:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 16:08:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:08:12] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 16:08:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 16:08:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 16:08:13] [comm] Using global sharding
[2023-07-27 16:08:13] [comm] NCCLCommunicators constructed successfully
[2023-07-27 16:08:13] [training] Using 1 GPUs
[2023-07-27 16:08:13] [logits] Applying loss function for 1 factor(s)
[2023-07-27 16:08:13] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:08:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 16:08:14] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:09:46] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 16:09:46] [valid] No post-processing script given for validating translator
[2023-07-27 16:09:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:09:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 16:09:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 16:09:46] [comm] Using global sharding
[2023-07-27 16:09:46] [comm] NCCLCommunicators constructed successfully
[2023-07-27 16:09:46] [training] Using 1 GPUs
[2023-07-27 16:09:46] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 16:09:51] Allocating memory for general optimizer shards
[2023-07-27 16:09:51] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 16:09:51] Loading Adam parameters
[2023-07-27 16:09:51] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 16:09:52] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:09:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 16:09:53] [data] Restoring the corpus state to epoch 111, batch 8850
[2023-07-27 16:09:53] [data] Shuffling data
[2023-07-27 16:09:53] [data] Done reading 20,192 sentences
[2023-07-27 16:09:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:09:53] Training started
[2023-07-27 16:09:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 16:09:54] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:09:56] Parameter type float16, optimization type float32, casting types true
[2023-07-27 16:12:57] Seen 20,192 samples
[2023-07-27 16:12:57] Starting data epoch 112 in logical epoch 112
[2023-07-27 16:12:57] [data] Shuffling data
[2023-07-27 16:12:58] [data] Done reading 20,192 sentences
[2023-07-27 16:12:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:15:39] Ep. 112 : Up. 9000 : Sen. 17,543 : Cost 2.14115810 * 7,065,592 @ 4,227 after 63,438,352 : Time 353.36s : 19995.37 words/s : gNorm 2.8960
[2023-07-27 16:16:06] Seen 20,192 samples
[2023-07-27 16:16:06] Starting data epoch 113 in logical epoch 113
[2023-07-27 16:16:06] [data] Shuffling data
[2023-07-27 16:16:06] [data] Done reading 20,192 sentences
[2023-07-27 16:16:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:19:15] Seen 20,192 samples
[2023-07-27 16:19:15] Starting data epoch 114 in logical epoch 114
[2023-07-27 16:19:15] [data] Shuffling data
[2023-07-27 16:19:15] [data] Done reading 20,192 sentences
[2023-07-27 16:19:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:22:24] Seen 20,192 samples
[2023-07-27 16:22:24] Starting data epoch 115 in logical epoch 115
[2023-07-27 16:22:24] [data] Shuffling data
[2023-07-27 16:22:24] [data] Done reading 20,192 sentences
[2023-07-27 16:22:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:25:31] Seen 20,192 samples
[2023-07-27 16:25:31] Starting data epoch 116 in logical epoch 116
[2023-07-27 16:25:31] [data] Shuffling data
[2023-07-27 16:25:31] [data] Done reading 20,192 sentences
[2023-07-27 16:25:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:28:40] Seen 20,192 samples
[2023-07-27 16:28:40] Starting data epoch 117 in logical epoch 117
[2023-07-27 16:28:40] [data] Shuffling data
[2023-07-27 16:28:40] [data] Done reading 20,192 sentences
[2023-07-27 16:28:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:31:48] Seen 20,192 samples
[2023-07-27 16:31:48] Starting data epoch 118 in logical epoch 118
[2023-07-27 16:31:48] [data] Shuffling data
[2023-07-27 16:31:48] [data] Done reading 20,192 sentences
[2023-07-27 16:31:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:34:56] Seen 20,192 samples
[2023-07-27 16:34:56] Starting data epoch 119 in logical epoch 119
[2023-07-27 16:34:56] [data] Shuffling data
[2023-07-27 16:34:56] [data] Done reading 20,192 sentences
[2023-07-27 16:34:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:38:04] Seen 20,192 samples
[2023-07-27 16:38:04] Starting data epoch 120 in logical epoch 120
[2023-07-27 16:38:04] [data] Shuffling data
[2023-07-27 16:38:04] [data] Done reading 20,192 sentences
[2023-07-27 16:38:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:41:13] Seen 20,192 samples
[2023-07-27 16:41:13] Starting data epoch 121 in logical epoch 121
[2023-07-27 16:41:13] Training finished
[2023-07-27 16:42:26] [valid] Ep. 121 : Up. 9660 : translation : 0 : new best
[2023-07-27 16:42:26] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 16:42:33] Saving Adam parameters
[2023-07-27 16:42:35] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 16:42:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:42:53] [marian] Running on node05.datos.cluster.uy as process 21298 with command line:
[2023-07-27 16:42:53] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 16:42:53] [config] after: 0e
[2023-07-27 16:42:53] [config] after-batches: 0
[2023-07-27 16:42:53] [config] after-epochs: 130
[2023-07-27 16:42:53] [config] all-caps-every: 0
[2023-07-27 16:42:53] [config] allow-unk: false
[2023-07-27 16:42:53] [config] authors: false
[2023-07-27 16:42:53] [config] beam-size: 12
[2023-07-27 16:42:53] [config] bert-class-symbol: "[CLS]"
[2023-07-27 16:42:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 16:42:53] [config] bert-masking-fraction: 0.15
[2023-07-27 16:42:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 16:42:53] [config] bert-train-type-embeddings: true
[2023-07-27 16:42:53] [config] bert-type-vocab-size: 2
[2023-07-27 16:42:53] [config] build-info: ""
[2023-07-27 16:42:53] [config] check-gradient-nan: false
[2023-07-27 16:42:53] [config] check-nan: false
[2023-07-27 16:42:53] [config] cite: false
[2023-07-27 16:42:53] [config] clip-norm: 1
[2023-07-27 16:42:53] [config] cost-scaling:
[2023-07-27 16:42:53] [config]   - 256.f
[2023-07-27 16:42:53] [config]   - 1000
[2023-07-27 16:42:53] [config]   - 2.f
[2023-07-27 16:42:53] [config]   - 256.f
[2023-07-27 16:42:53] [config] cost-type: ce-sum
[2023-07-27 16:42:53] [config] cpu-threads: 0
[2023-07-27 16:42:53] [config] data-threads: 8
[2023-07-27 16:42:53] [config] data-weighting: ""
[2023-07-27 16:42:53] [config] data-weighting-type: sentence
[2023-07-27 16:42:53] [config] dec-cell: gru
[2023-07-27 16:42:53] [config] dec-cell-base-depth: 2
[2023-07-27 16:42:53] [config] dec-cell-high-depth: 1
[2023-07-27 16:42:53] [config] dec-depth: 8
[2023-07-27 16:42:53] [config] devices:
[2023-07-27 16:42:53] [config]   - 0
[2023-07-27 16:42:53] [config] dim-emb: 512
[2023-07-27 16:42:53] [config] dim-rnn: 1024
[2023-07-27 16:42:53] [config] dim-vocabs:
[2023-07-27 16:42:53] [config]   - 16384
[2023-07-27 16:42:53] [config]   - 16384
[2023-07-27 16:42:53] [config] disp-first: 0
[2023-07-27 16:42:53] [config] disp-freq: 1000u
[2023-07-27 16:42:53] [config] disp-label-counts: true
[2023-07-27 16:42:53] [config] dropout-rnn: 0
[2023-07-27 16:42:53] [config] dropout-src: 0
[2023-07-27 16:42:53] [config] dropout-trg: 0
[2023-07-27 16:42:53] [config] dump-config: ""
[2023-07-27 16:42:53] [config] dynamic-gradient-scaling:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] early-stopping: 1000
[2023-07-27 16:42:53] [config] early-stopping-on: first
[2023-07-27 16:42:53] [config] embedding-fix-src: false
[2023-07-27 16:42:53] [config] embedding-fix-trg: false
[2023-07-27 16:42:53] [config] embedding-normalization: false
[2023-07-27 16:42:53] [config] embedding-vectors:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] enc-cell: gru
[2023-07-27 16:42:53] [config] enc-cell-depth: 1
[2023-07-27 16:42:53] [config] enc-depth: 8
[2023-07-27 16:42:53] [config] enc-type: bidirectional
[2023-07-27 16:42:53] [config] english-title-case-every: 0
[2023-07-27 16:42:53] [config] exponential-smoothing: 0
[2023-07-27 16:42:53] [config] factor-weight: 1
[2023-07-27 16:42:53] [config] factors-combine: sum
[2023-07-27 16:42:53] [config] factors-dim-emb: 0
[2023-07-27 16:42:53] [config] gradient-checkpointing: false
[2023-07-27 16:42:53] [config] gradient-norm-average-window: 100
[2023-07-27 16:42:53] [config] guided-alignment: none
[2023-07-27 16:42:53] [config] guided-alignment-cost: mse
[2023-07-27 16:42:53] [config] guided-alignment-weight: 0.1
[2023-07-27 16:42:53] [config] ignore-model-config: false
[2023-07-27 16:42:53] [config] input-types:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] interpolate-env-vars: false
[2023-07-27 16:42:53] [config] keep-best: false
[2023-07-27 16:42:53] [config] label-smoothing: 0
[2023-07-27 16:42:53] [config] layer-normalization: false
[2023-07-27 16:42:53] [config] learn-rate: 0.0001
[2023-07-27 16:42:53] [config] lemma-dependency: ""
[2023-07-27 16:42:53] [config] lemma-dim-emb: 0
[2023-07-27 16:42:53] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 16:42:53] [config] log-level: info
[2023-07-27 16:42:53] [config] log-time-zone: ""
[2023-07-27 16:42:53] [config] logical-epoch:
[2023-07-27 16:42:53] [config]   - 1e
[2023-07-27 16:42:53] [config]   - 0
[2023-07-27 16:42:53] [config] lr-decay: 0
[2023-07-27 16:42:53] [config] lr-decay-freq: 50000
[2023-07-27 16:42:53] [config] lr-decay-inv-sqrt:
[2023-07-27 16:42:53] [config]   - 0
[2023-07-27 16:42:53] [config] lr-decay-repeat-warmup: false
[2023-07-27 16:42:53] [config] lr-decay-reset-optimizer: false
[2023-07-27 16:42:53] [config] lr-decay-start:
[2023-07-27 16:42:53] [config]   - 10
[2023-07-27 16:42:53] [config]   - 1
[2023-07-27 16:42:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 16:42:53] [config] lr-report: false
[2023-07-27 16:42:53] [config] lr-warmup: 0
[2023-07-27 16:42:53] [config] lr-warmup-at-reload: false
[2023-07-27 16:42:53] [config] lr-warmup-cycle: false
[2023-07-27 16:42:53] [config] lr-warmup-start-rate: 0
[2023-07-27 16:42:53] [config] max-length: 50
[2023-07-27 16:42:53] [config] max-length-crop: true
[2023-07-27 16:42:53] [config] max-length-factor: 3
[2023-07-27 16:42:53] [config] maxi-batch: 100
[2023-07-27 16:42:53] [config] maxi-batch-sort: trg
[2023-07-27 16:42:53] [config] mini-batch: 64
[2023-07-27 16:42:53] [config] mini-batch-fit: true
[2023-07-27 16:42:53] [config] mini-batch-fit-step: 10
[2023-07-27 16:42:53] [config] mini-batch-round-up: true
[2023-07-27 16:42:53] [config] mini-batch-track-lr: false
[2023-07-27 16:42:53] [config] mini-batch-warmup: 0
[2023-07-27 16:42:53] [config] mini-batch-words: 0
[2023-07-27 16:42:53] [config] mini-batch-words-ref: 0
[2023-07-27 16:42:53] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 16:42:53] [config] multi-loss-type: sum
[2023-07-27 16:42:53] [config] n-best: false
[2023-07-27 16:42:53] [config] no-nccl: false
[2023-07-27 16:42:53] [config] no-reload: false
[2023-07-27 16:42:53] [config] no-restore-corpus: false
[2023-07-27 16:42:53] [config] normalize: 0
[2023-07-27 16:42:53] [config] normalize-gradient: false
[2023-07-27 16:42:53] [config] num-devices: 0
[2023-07-27 16:42:53] [config] optimizer: adam
[2023-07-27 16:42:53] [config] optimizer-delay: 1
[2023-07-27 16:42:53] [config] optimizer-params:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] output-omit-bias: false
[2023-07-27 16:42:53] [config] overwrite: true
[2023-07-27 16:42:53] [config] precision:
[2023-07-27 16:42:53] [config]   - float16
[2023-07-27 16:42:53] [config]   - float32
[2023-07-27 16:42:53] [config] pretrained-model: ""
[2023-07-27 16:42:53] [config] quantize-biases: false
[2023-07-27 16:42:53] [config] quantize-bits: 0
[2023-07-27 16:42:53] [config] quantize-log-based: false
[2023-07-27 16:42:53] [config] quantize-optimization-steps: 0
[2023-07-27 16:42:53] [config] quiet: false
[2023-07-27 16:42:53] [config] quiet-translation: true
[2023-07-27 16:42:53] [config] relative-paths: false
[2023-07-27 16:42:53] [config] right-left: false
[2023-07-27 16:42:53] [config] save-freq: 10000u
[2023-07-27 16:42:53] [config] seed: 1234
[2023-07-27 16:42:53] [config] sentencepiece-alphas:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] sentencepiece-max-lines: 2000000
[2023-07-27 16:42:53] [config] sentencepiece-options: ""
[2023-07-27 16:42:53] [config] sharding: global
[2023-07-27 16:42:53] [config] shuffle: data
[2023-07-27 16:42:53] [config] shuffle-in-ram: false
[2023-07-27 16:42:53] [config] sigterm: save-and-exit
[2023-07-27 16:42:53] [config] skip: false
[2023-07-27 16:42:53] [config] sqlite: ""
[2023-07-27 16:42:53] [config] sqlite-drop: false
[2023-07-27 16:42:53] [config] sync-freq: 200u
[2023-07-27 16:42:53] [config] sync-sgd: false
[2023-07-27 16:42:53] [config] tempdir: /tmp
[2023-07-27 16:42:53] [config] tied-embeddings: false
[2023-07-27 16:42:53] [config] tied-embeddings-all: true
[2023-07-27 16:42:53] [config] tied-embeddings-src: false
[2023-07-27 16:42:53] [config] train-embedder-rank:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] train-sets:
[2023-07-27 16:42:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 16:42:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 16:42:53] [config] transformer-aan-activation: swish
[2023-07-27 16:42:53] [config] transformer-aan-depth: 2
[2023-07-27 16:42:53] [config] transformer-aan-nogate: false
[2023-07-27 16:42:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 16:42:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 16:42:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 16:42:53] [config] transformer-depth-scaling: false
[2023-07-27 16:42:53] [config] transformer-dim-aan: 2048
[2023-07-27 16:42:53] [config] transformer-dim-ffn: 2048
[2023-07-27 16:42:53] [config] transformer-dropout: 0
[2023-07-27 16:42:53] [config] transformer-dropout-attention: 0
[2023-07-27 16:42:53] [config] transformer-dropout-ffn: 0
[2023-07-27 16:42:53] [config] transformer-ffn-activation: swish
[2023-07-27 16:42:53] [config] transformer-ffn-depth: 2
[2023-07-27 16:42:53] [config] transformer-guided-alignment-layer: last
[2023-07-27 16:42:53] [config] transformer-heads: 8
[2023-07-27 16:42:53] [config] transformer-no-projection: false
[2023-07-27 16:42:53] [config] transformer-pool: false
[2023-07-27 16:42:53] [config] transformer-postprocess: dan
[2023-07-27 16:42:53] [config] transformer-postprocess-emb: d
[2023-07-27 16:42:53] [config] transformer-postprocess-top: ""
[2023-07-27 16:42:53] [config] transformer-preprocess: ""
[2023-07-27 16:42:53] [config] transformer-tied-layers:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] transformer-train-position-embeddings: false
[2023-07-27 16:42:53] [config] tsv: false
[2023-07-27 16:42:53] [config] tsv-fields: 0
[2023-07-27 16:42:53] [config] type: s2s
[2023-07-27 16:42:53] [config] ulr: false
[2023-07-27 16:42:53] [config] ulr-dim-emb: 0
[2023-07-27 16:42:53] [config] ulr-dropout: 0
[2023-07-27 16:42:53] [config] ulr-keys-vectors: ""
[2023-07-27 16:42:53] [config] ulr-query-vectors: ""
[2023-07-27 16:42:53] [config] ulr-softmax-temperature: 1
[2023-07-27 16:42:53] [config] ulr-trainable-transformation: false
[2023-07-27 16:42:53] [config] unlikelihood-loss: false
[2023-07-27 16:42:53] [config] valid-freq: 50000000
[2023-07-27 16:42:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 16:42:53] [config] valid-max-length: 1000
[2023-07-27 16:42:53] [config] valid-metrics:
[2023-07-27 16:42:53] [config]   - translation
[2023-07-27 16:42:53] [config] valid-mini-batch: 32
[2023-07-27 16:42:53] [config] valid-reset-stalled: false
[2023-07-27 16:42:53] [config] valid-script-args:
[2023-07-27 16:42:53] [config]   []
[2023-07-27 16:42:53] [config] valid-script-path: ""
[2023-07-27 16:42:53] [config] valid-sets:
[2023-07-27 16:42:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 16:42:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 16:42:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 16:42:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:42:53] [config] vocabs:
[2023-07-27 16:42:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 16:42:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 16:42:53] [config] word-penalty: 0
[2023-07-27 16:42:53] [config] word-scores: false
[2023-07-27 16:42:53] [config] workspace: 5500
[2023-07-27 16:42:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:42:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:42:53] [training] Using single-device training
[2023-07-27 16:42:54] Synced seed 1234
[2023-07-27 16:42:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 16:42:54] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 16:42:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 16:42:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 16:42:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 16:42:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:42:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 16:42:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 16:42:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 16:42:55] [comm] Using global sharding
[2023-07-27 16:42:55] [comm] NCCLCommunicators constructed successfully
[2023-07-27 16:42:55] [training] Using 1 GPUs
[2023-07-27 16:42:55] [logits] Applying loss function for 1 factor(s)
[2023-07-27 16:42:55] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:42:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 16:42:55] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:44:27] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 16:44:27] [valid] No post-processing script given for validating translator
[2023-07-27 16:44:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:44:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 16:44:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 16:44:28] [comm] Using global sharding
[2023-07-27 16:44:28] [comm] NCCLCommunicators constructed successfully
[2023-07-27 16:44:28] [training] Using 1 GPUs
[2023-07-27 16:44:28] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 16:44:41] Allocating memory for general optimizer shards
[2023-07-27 16:44:41] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 16:44:41] Loading Adam parameters
[2023-07-27 16:44:42] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 16:44:42] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:44:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 16:44:43] [data] Restoring the corpus state to epoch 121, batch 9660
[2023-07-27 16:44:43] [data] Shuffling data
[2023-07-27 16:44:43] [data] Done reading 20,192 sentences
[2023-07-27 16:44:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:44:43] Training started
[2023-07-27 16:44:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 16:44:44] [memory] Reserving 332 MB, device gpu0
[2023-07-27 16:44:45] Parameter type float16, optimization type float32, casting types true
[2023-07-27 16:47:47] Seen 20,192 samples
[2023-07-27 16:47:47] Starting data epoch 122 in logical epoch 122
[2023-07-27 16:47:47] [data] Shuffling data
[2023-07-27 16:47:47] [data] Done reading 20,192 sentences
[2023-07-27 16:47:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:50:55] Seen 20,192 samples
[2023-07-27 16:50:55] Starting data epoch 123 in logical epoch 123
[2023-07-27 16:50:55] [data] Shuffling data
[2023-07-27 16:50:55] [data] Done reading 20,192 sentences
[2023-07-27 16:50:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:54:03] Seen 20,192 samples
[2023-07-27 16:54:03] Starting data epoch 124 in logical epoch 124
[2023-07-27 16:54:03] [data] Shuffling data
[2023-07-27 16:54:03] [data] Done reading 20,192 sentences
[2023-07-27 16:54:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:57:12] Seen 20,192 samples
[2023-07-27 16:57:12] Starting data epoch 125 in logical epoch 125
[2023-07-27 16:57:12] [data] Shuffling data
[2023-07-27 16:57:12] [data] Done reading 20,192 sentences
[2023-07-27 16:57:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:57:48] Ep. 125 : Up. 10000 : Sen. 4,256 : Cost 1.73725998 * 6,990,623 @ 10,800 after 70,428,975 : Time 800.60s : 8731.72 words/s : gNorm 2.7844
[2023-07-27 16:57:48] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 16:57:55] Saving Adam parameters
[2023-07-27 16:57:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 17:00:34] Seen 20,192 samples
[2023-07-27 17:00:34] Starting data epoch 126 in logical epoch 126
[2023-07-27 17:00:34] [data] Shuffling data
[2023-07-27 17:00:34] [data] Done reading 20,192 sentences
[2023-07-27 17:00:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:03:41] Seen 20,192 samples
[2023-07-27 17:03:41] Starting data epoch 127 in logical epoch 127
[2023-07-27 17:03:41] [data] Shuffling data
[2023-07-27 17:03:41] [data] Done reading 20,192 sentences
[2023-07-27 17:03:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:06:47] Seen 20,192 samples
[2023-07-27 17:06:47] Starting data epoch 128 in logical epoch 128
[2023-07-27 17:06:47] [data] Shuffling data
[2023-07-27 17:06:47] [data] Done reading 20,192 sentences
[2023-07-27 17:06:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:09:54] Seen 20,192 samples
[2023-07-27 17:09:54] Starting data epoch 129 in logical epoch 129
[2023-07-27 17:09:54] [data] Shuffling data
[2023-07-27 17:09:54] [data] Done reading 20,192 sentences
[2023-07-27 17:09:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:13:02] Seen 20,192 samples
[2023-07-27 17:13:02] Starting data epoch 130 in logical epoch 130
[2023-07-27 17:13:02] [data] Shuffling data
[2023-07-27 17:13:02] [data] Done reading 20,192 sentences
[2023-07-27 17:13:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:16:04] Seen 20,192 samples
[2023-07-27 17:16:04] Starting data epoch 131 in logical epoch 131
[2023-07-27 17:16:04] Training finished
[2023-07-27 17:17:19] [valid] Ep. 131 : Up. 10464 : translation : 0 : new best
[2023-07-27 17:17:19] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 17:17:25] Saving Adam parameters
[2023-07-27 17:17:27] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 17:17:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:17:44] [marian] Running on node05.datos.cluster.uy as process 23524 with command line:
[2023-07-27 17:17:44] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 17:17:44] [config] after: 0e
[2023-07-27 17:17:44] [config] after-batches: 0
[2023-07-27 17:17:44] [config] after-epochs: 140
[2023-07-27 17:17:44] [config] all-caps-every: 0
[2023-07-27 17:17:44] [config] allow-unk: false
[2023-07-27 17:17:44] [config] authors: false
[2023-07-27 17:17:44] [config] beam-size: 12
[2023-07-27 17:17:44] [config] bert-class-symbol: "[CLS]"
[2023-07-27 17:17:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 17:17:44] [config] bert-masking-fraction: 0.15
[2023-07-27 17:17:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 17:17:44] [config] bert-train-type-embeddings: true
[2023-07-27 17:17:44] [config] bert-type-vocab-size: 2
[2023-07-27 17:17:44] [config] build-info: ""
[2023-07-27 17:17:44] [config] check-gradient-nan: false
[2023-07-27 17:17:44] [config] check-nan: false
[2023-07-27 17:17:44] [config] cite: false
[2023-07-27 17:17:44] [config] clip-norm: 1
[2023-07-27 17:17:44] [config] cost-scaling:
[2023-07-27 17:17:44] [config]   - 256.f
[2023-07-27 17:17:44] [config]   - 1000
[2023-07-27 17:17:44] [config]   - 2.f
[2023-07-27 17:17:44] [config]   - 256.f
[2023-07-27 17:17:44] [config] cost-type: ce-sum
[2023-07-27 17:17:44] [config] cpu-threads: 0
[2023-07-27 17:17:44] [config] data-threads: 8
[2023-07-27 17:17:44] [config] data-weighting: ""
[2023-07-27 17:17:44] [config] data-weighting-type: sentence
[2023-07-27 17:17:44] [config] dec-cell: gru
[2023-07-27 17:17:44] [config] dec-cell-base-depth: 2
[2023-07-27 17:17:44] [config] dec-cell-high-depth: 1
[2023-07-27 17:17:44] [config] dec-depth: 8
[2023-07-27 17:17:44] [config] devices:
[2023-07-27 17:17:44] [config]   - 0
[2023-07-27 17:17:44] [config] dim-emb: 512
[2023-07-27 17:17:44] [config] dim-rnn: 1024
[2023-07-27 17:17:44] [config] dim-vocabs:
[2023-07-27 17:17:44] [config]   - 16384
[2023-07-27 17:17:44] [config]   - 16384
[2023-07-27 17:17:44] [config] disp-first: 0
[2023-07-27 17:17:44] [config] disp-freq: 1000u
[2023-07-27 17:17:44] [config] disp-label-counts: true
[2023-07-27 17:17:44] [config] dropout-rnn: 0
[2023-07-27 17:17:44] [config] dropout-src: 0
[2023-07-27 17:17:44] [config] dropout-trg: 0
[2023-07-27 17:17:44] [config] dump-config: ""
[2023-07-27 17:17:44] [config] dynamic-gradient-scaling:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] early-stopping: 1000
[2023-07-27 17:17:44] [config] early-stopping-on: first
[2023-07-27 17:17:44] [config] embedding-fix-src: false
[2023-07-27 17:17:44] [config] embedding-fix-trg: false
[2023-07-27 17:17:44] [config] embedding-normalization: false
[2023-07-27 17:17:44] [config] embedding-vectors:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] enc-cell: gru
[2023-07-27 17:17:44] [config] enc-cell-depth: 1
[2023-07-27 17:17:44] [config] enc-depth: 8
[2023-07-27 17:17:44] [config] enc-type: bidirectional
[2023-07-27 17:17:44] [config] english-title-case-every: 0
[2023-07-27 17:17:44] [config] exponential-smoothing: 0
[2023-07-27 17:17:44] [config] factor-weight: 1
[2023-07-27 17:17:44] [config] factors-combine: sum
[2023-07-27 17:17:44] [config] factors-dim-emb: 0
[2023-07-27 17:17:44] [config] gradient-checkpointing: false
[2023-07-27 17:17:44] [config] gradient-norm-average-window: 100
[2023-07-27 17:17:44] [config] guided-alignment: none
[2023-07-27 17:17:44] [config] guided-alignment-cost: mse
[2023-07-27 17:17:44] [config] guided-alignment-weight: 0.1
[2023-07-27 17:17:44] [config] ignore-model-config: false
[2023-07-27 17:17:44] [config] input-types:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] interpolate-env-vars: false
[2023-07-27 17:17:44] [config] keep-best: false
[2023-07-27 17:17:44] [config] label-smoothing: 0
[2023-07-27 17:17:44] [config] layer-normalization: false
[2023-07-27 17:17:44] [config] learn-rate: 0.0001
[2023-07-27 17:17:44] [config] lemma-dependency: ""
[2023-07-27 17:17:44] [config] lemma-dim-emb: 0
[2023-07-27 17:17:44] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 17:17:44] [config] log-level: info
[2023-07-27 17:17:44] [config] log-time-zone: ""
[2023-07-27 17:17:44] [config] logical-epoch:
[2023-07-27 17:17:44] [config]   - 1e
[2023-07-27 17:17:44] [config]   - 0
[2023-07-27 17:17:44] [config] lr-decay: 0
[2023-07-27 17:17:44] [config] lr-decay-freq: 50000
[2023-07-27 17:17:44] [config] lr-decay-inv-sqrt:
[2023-07-27 17:17:44] [config]   - 0
[2023-07-27 17:17:44] [config] lr-decay-repeat-warmup: false
[2023-07-27 17:17:44] [config] lr-decay-reset-optimizer: false
[2023-07-27 17:17:44] [config] lr-decay-start:
[2023-07-27 17:17:44] [config]   - 10
[2023-07-27 17:17:44] [config]   - 1
[2023-07-27 17:17:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 17:17:44] [config] lr-report: false
[2023-07-27 17:17:44] [config] lr-warmup: 0
[2023-07-27 17:17:44] [config] lr-warmup-at-reload: false
[2023-07-27 17:17:44] [config] lr-warmup-cycle: false
[2023-07-27 17:17:44] [config] lr-warmup-start-rate: 0
[2023-07-27 17:17:44] [config] max-length: 50
[2023-07-27 17:17:44] [config] max-length-crop: true
[2023-07-27 17:17:44] [config] max-length-factor: 3
[2023-07-27 17:17:44] [config] maxi-batch: 100
[2023-07-27 17:17:44] [config] maxi-batch-sort: trg
[2023-07-27 17:17:44] [config] mini-batch: 64
[2023-07-27 17:17:44] [config] mini-batch-fit: true
[2023-07-27 17:17:44] [config] mini-batch-fit-step: 10
[2023-07-27 17:17:44] [config] mini-batch-round-up: true
[2023-07-27 17:17:44] [config] mini-batch-track-lr: false
[2023-07-27 17:17:44] [config] mini-batch-warmup: 0
[2023-07-27 17:17:44] [config] mini-batch-words: 0
[2023-07-27 17:17:44] [config] mini-batch-words-ref: 0
[2023-07-27 17:17:44] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 17:17:44] [config] multi-loss-type: sum
[2023-07-27 17:17:44] [config] n-best: false
[2023-07-27 17:17:44] [config] no-nccl: false
[2023-07-27 17:17:44] [config] no-reload: false
[2023-07-27 17:17:44] [config] no-restore-corpus: false
[2023-07-27 17:17:44] [config] normalize: 0
[2023-07-27 17:17:44] [config] normalize-gradient: false
[2023-07-27 17:17:44] [config] num-devices: 0
[2023-07-27 17:17:44] [config] optimizer: adam
[2023-07-27 17:17:44] [config] optimizer-delay: 1
[2023-07-27 17:17:44] [config] optimizer-params:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] output-omit-bias: false
[2023-07-27 17:17:44] [config] overwrite: true
[2023-07-27 17:17:44] [config] precision:
[2023-07-27 17:17:44] [config]   - float16
[2023-07-27 17:17:44] [config]   - float32
[2023-07-27 17:17:44] [config] pretrained-model: ""
[2023-07-27 17:17:44] [config] quantize-biases: false
[2023-07-27 17:17:44] [config] quantize-bits: 0
[2023-07-27 17:17:44] [config] quantize-log-based: false
[2023-07-27 17:17:44] [config] quantize-optimization-steps: 0
[2023-07-27 17:17:44] [config] quiet: false
[2023-07-27 17:17:44] [config] quiet-translation: true
[2023-07-27 17:17:44] [config] relative-paths: false
[2023-07-27 17:17:44] [config] right-left: false
[2023-07-27 17:17:44] [config] save-freq: 10000u
[2023-07-27 17:17:44] [config] seed: 1234
[2023-07-27 17:17:44] [config] sentencepiece-alphas:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] sentencepiece-max-lines: 2000000
[2023-07-27 17:17:44] [config] sentencepiece-options: ""
[2023-07-27 17:17:44] [config] sharding: global
[2023-07-27 17:17:44] [config] shuffle: data
[2023-07-27 17:17:44] [config] shuffle-in-ram: false
[2023-07-27 17:17:44] [config] sigterm: save-and-exit
[2023-07-27 17:17:44] [config] skip: false
[2023-07-27 17:17:44] [config] sqlite: ""
[2023-07-27 17:17:44] [config] sqlite-drop: false
[2023-07-27 17:17:44] [config] sync-freq: 200u
[2023-07-27 17:17:44] [config] sync-sgd: false
[2023-07-27 17:17:44] [config] tempdir: /tmp
[2023-07-27 17:17:44] [config] tied-embeddings: false
[2023-07-27 17:17:44] [config] tied-embeddings-all: true
[2023-07-27 17:17:44] [config] tied-embeddings-src: false
[2023-07-27 17:17:44] [config] train-embedder-rank:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] train-sets:
[2023-07-27 17:17:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 17:17:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 17:17:44] [config] transformer-aan-activation: swish
[2023-07-27 17:17:44] [config] transformer-aan-depth: 2
[2023-07-27 17:17:44] [config] transformer-aan-nogate: false
[2023-07-27 17:17:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 17:17:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 17:17:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 17:17:44] [config] transformer-depth-scaling: false
[2023-07-27 17:17:44] [config] transformer-dim-aan: 2048
[2023-07-27 17:17:44] [config] transformer-dim-ffn: 2048
[2023-07-27 17:17:44] [config] transformer-dropout: 0
[2023-07-27 17:17:44] [config] transformer-dropout-attention: 0
[2023-07-27 17:17:44] [config] transformer-dropout-ffn: 0
[2023-07-27 17:17:44] [config] transformer-ffn-activation: swish
[2023-07-27 17:17:44] [config] transformer-ffn-depth: 2
[2023-07-27 17:17:44] [config] transformer-guided-alignment-layer: last
[2023-07-27 17:17:44] [config] transformer-heads: 8
[2023-07-27 17:17:44] [config] transformer-no-projection: false
[2023-07-27 17:17:44] [config] transformer-pool: false
[2023-07-27 17:17:44] [config] transformer-postprocess: dan
[2023-07-27 17:17:44] [config] transformer-postprocess-emb: d
[2023-07-27 17:17:44] [config] transformer-postprocess-top: ""
[2023-07-27 17:17:44] [config] transformer-preprocess: ""
[2023-07-27 17:17:44] [config] transformer-tied-layers:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] transformer-train-position-embeddings: false
[2023-07-27 17:17:44] [config] tsv: false
[2023-07-27 17:17:44] [config] tsv-fields: 0
[2023-07-27 17:17:44] [config] type: s2s
[2023-07-27 17:17:44] [config] ulr: false
[2023-07-27 17:17:44] [config] ulr-dim-emb: 0
[2023-07-27 17:17:44] [config] ulr-dropout: 0
[2023-07-27 17:17:44] [config] ulr-keys-vectors: ""
[2023-07-27 17:17:44] [config] ulr-query-vectors: ""
[2023-07-27 17:17:44] [config] ulr-softmax-temperature: 1
[2023-07-27 17:17:44] [config] ulr-trainable-transformation: false
[2023-07-27 17:17:44] [config] unlikelihood-loss: false
[2023-07-27 17:17:44] [config] valid-freq: 50000000
[2023-07-27 17:17:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 17:17:44] [config] valid-max-length: 1000
[2023-07-27 17:17:44] [config] valid-metrics:
[2023-07-27 17:17:44] [config]   - translation
[2023-07-27 17:17:44] [config] valid-mini-batch: 32
[2023-07-27 17:17:44] [config] valid-reset-stalled: false
[2023-07-27 17:17:44] [config] valid-script-args:
[2023-07-27 17:17:44] [config]   []
[2023-07-27 17:17:44] [config] valid-script-path: ""
[2023-07-27 17:17:44] [config] valid-sets:
[2023-07-27 17:17:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 17:17:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 17:17:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 17:17:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:17:44] [config] vocabs:
[2023-07-27 17:17:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 17:17:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 17:17:44] [config] word-penalty: 0
[2023-07-27 17:17:44] [config] word-scores: false
[2023-07-27 17:17:44] [config] workspace: 5500
[2023-07-27 17:17:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:17:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:17:44] [training] Using single-device training
[2023-07-27 17:17:44] Synced seed 1234
[2023-07-27 17:17:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 17:17:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 17:17:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 17:17:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 17:17:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 17:17:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:17:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 17:17:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 17:17:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 17:17:45] [comm] Using global sharding
[2023-07-27 17:17:45] [comm] NCCLCommunicators constructed successfully
[2023-07-27 17:17:45] [training] Using 1 GPUs
[2023-07-27 17:17:45] [logits] Applying loss function for 1 factor(s)
[2023-07-27 17:17:45] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:17:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 17:17:46] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:19:18] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 17:19:18] [valid] No post-processing script given for validating translator
[2023-07-27 17:19:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:19:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 17:19:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 17:19:18] [comm] Using global sharding
[2023-07-27 17:19:18] [comm] NCCLCommunicators constructed successfully
[2023-07-27 17:19:18] [training] Using 1 GPUs
[2023-07-27 17:19:18] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 17:19:23] Allocating memory for general optimizer shards
[2023-07-27 17:19:23] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 17:19:23] Loading Adam parameters
[2023-07-27 17:19:24] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 17:19:24] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:19:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 17:19:25] [data] Restoring the corpus state to epoch 131, batch 10464
[2023-07-27 17:19:25] [data] Shuffling data
[2023-07-27 17:19:25] [data] Done reading 20,192 sentences
[2023-07-27 17:19:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:19:25] Training started
[2023-07-27 17:19:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 17:19:26] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:19:27] Parameter type float16, optimization type float32, casting types true
[2023-07-27 17:22:29] Seen 20,192 samples
[2023-07-27 17:22:29] Starting data epoch 132 in logical epoch 132
[2023-07-27 17:22:29] [data] Shuffling data
[2023-07-27 17:22:29] [data] Done reading 20,192 sentences
[2023-07-27 17:22:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:25:36] Seen 20,192 samples
[2023-07-27 17:25:36] Starting data epoch 133 in logical epoch 133
[2023-07-27 17:25:36] [data] Shuffling data
[2023-07-27 17:25:36] [data] Done reading 20,192 sentences
[2023-07-27 17:25:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:28:44] Seen 20,192 samples
[2023-07-27 17:28:44] Starting data epoch 134 in logical epoch 134
[2023-07-27 17:28:44] [data] Shuffling data
[2023-07-27 17:28:44] [data] Done reading 20,192 sentences
[2023-07-27 17:28:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:31:52] Seen 20,192 samples
[2023-07-27 17:31:52] Starting data epoch 135 in logical epoch 135
[2023-07-27 17:31:52] [data] Shuffling data
[2023-07-27 17:31:52] [data] Done reading 20,192 sentences
[2023-07-27 17:31:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:34:58] Seen 20,192 samples
[2023-07-27 17:34:58] Starting data epoch 136 in logical epoch 136
[2023-07-27 17:34:58] [data] Shuffling data
[2023-07-27 17:34:58] [data] Done reading 20,192 sentences
[2023-07-27 17:34:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:38:06] Seen 20,192 samples
[2023-07-27 17:38:06] Starting data epoch 137 in logical epoch 137
[2023-07-27 17:38:06] [data] Shuffling data
[2023-07-27 17:38:06] [data] Done reading 20,192 sentences
[2023-07-27 17:38:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:40:14] Ep. 137 : Up. 11000 : Sen. 14,205 : Cost 1.39075780 * 7,085,355 @ 8,346 after 77,514,330 : Time 1256.29s : 5639.89 words/s : gNorm 2.2961
[2023-07-27 17:41:14] Seen 20,192 samples
[2023-07-27 17:41:14] Starting data epoch 138 in logical epoch 138
[2023-07-27 17:41:14] [data] Shuffling data
[2023-07-27 17:41:14] [data] Done reading 20,192 sentences
[2023-07-27 17:41:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:44:21] Seen 20,192 samples
[2023-07-27 17:44:21] Starting data epoch 139 in logical epoch 139
[2023-07-27 17:44:21] [data] Shuffling data
[2023-07-27 17:44:21] [data] Done reading 20,192 sentences
[2023-07-27 17:44:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:47:28] Seen 20,192 samples
[2023-07-27 17:47:28] Starting data epoch 140 in logical epoch 140
[2023-07-27 17:47:28] [data] Shuffling data
[2023-07-27 17:47:28] [data] Done reading 20,192 sentences
[2023-07-27 17:47:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:50:35] Seen 20,192 samples
[2023-07-27 17:50:35] Starting data epoch 141 in logical epoch 141
[2023-07-27 17:50:35] Training finished
[2023-07-27 17:51:49] [valid] Ep. 141 : Up. 11267 : translation : 0 : new best
[2023-07-27 17:51:49] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 17:51:55] Saving Adam parameters
[2023-07-27 17:51:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 17:52:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:52:16] [marian] Running on node05.datos.cluster.uy as process 25875 with command line:
[2023-07-27 17:52:16] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 17:52:16] [config] after: 0e
[2023-07-27 17:52:16] [config] after-batches: 0
[2023-07-27 17:52:16] [config] after-epochs: 150
[2023-07-27 17:52:16] [config] all-caps-every: 0
[2023-07-27 17:52:16] [config] allow-unk: false
[2023-07-27 17:52:16] [config] authors: false
[2023-07-27 17:52:16] [config] beam-size: 12
[2023-07-27 17:52:16] [config] bert-class-symbol: "[CLS]"
[2023-07-27 17:52:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 17:52:16] [config] bert-masking-fraction: 0.15
[2023-07-27 17:52:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 17:52:16] [config] bert-train-type-embeddings: true
[2023-07-27 17:52:16] [config] bert-type-vocab-size: 2
[2023-07-27 17:52:16] [config] build-info: ""
[2023-07-27 17:52:16] [config] check-gradient-nan: false
[2023-07-27 17:52:16] [config] check-nan: false
[2023-07-27 17:52:16] [config] cite: false
[2023-07-27 17:52:16] [config] clip-norm: 1
[2023-07-27 17:52:16] [config] cost-scaling:
[2023-07-27 17:52:16] [config]   - 256.f
[2023-07-27 17:52:16] [config]   - 1000
[2023-07-27 17:52:16] [config]   - 2.f
[2023-07-27 17:52:16] [config]   - 256.f
[2023-07-27 17:52:16] [config] cost-type: ce-sum
[2023-07-27 17:52:16] [config] cpu-threads: 0
[2023-07-27 17:52:16] [config] data-threads: 8
[2023-07-27 17:52:16] [config] data-weighting: ""
[2023-07-27 17:52:16] [config] data-weighting-type: sentence
[2023-07-27 17:52:16] [config] dec-cell: gru
[2023-07-27 17:52:16] [config] dec-cell-base-depth: 2
[2023-07-27 17:52:16] [config] dec-cell-high-depth: 1
[2023-07-27 17:52:16] [config] dec-depth: 8
[2023-07-27 17:52:16] [config] devices:
[2023-07-27 17:52:16] [config]   - 0
[2023-07-27 17:52:16] [config] dim-emb: 512
[2023-07-27 17:52:16] [config] dim-rnn: 1024
[2023-07-27 17:52:16] [config] dim-vocabs:
[2023-07-27 17:52:16] [config]   - 16384
[2023-07-27 17:52:16] [config]   - 16384
[2023-07-27 17:52:16] [config] disp-first: 0
[2023-07-27 17:52:16] [config] disp-freq: 1000u
[2023-07-27 17:52:16] [config] disp-label-counts: true
[2023-07-27 17:52:16] [config] dropout-rnn: 0
[2023-07-27 17:52:16] [config] dropout-src: 0
[2023-07-27 17:52:16] [config] dropout-trg: 0
[2023-07-27 17:52:16] [config] dump-config: ""
[2023-07-27 17:52:16] [config] dynamic-gradient-scaling:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] early-stopping: 1000
[2023-07-27 17:52:16] [config] early-stopping-on: first
[2023-07-27 17:52:16] [config] embedding-fix-src: false
[2023-07-27 17:52:16] [config] embedding-fix-trg: false
[2023-07-27 17:52:16] [config] embedding-normalization: false
[2023-07-27 17:52:16] [config] embedding-vectors:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] enc-cell: gru
[2023-07-27 17:52:16] [config] enc-cell-depth: 1
[2023-07-27 17:52:16] [config] enc-depth: 8
[2023-07-27 17:52:16] [config] enc-type: bidirectional
[2023-07-27 17:52:16] [config] english-title-case-every: 0
[2023-07-27 17:52:16] [config] exponential-smoothing: 0
[2023-07-27 17:52:16] [config] factor-weight: 1
[2023-07-27 17:52:16] [config] factors-combine: sum
[2023-07-27 17:52:16] [config] factors-dim-emb: 0
[2023-07-27 17:52:16] [config] gradient-checkpointing: false
[2023-07-27 17:52:16] [config] gradient-norm-average-window: 100
[2023-07-27 17:52:16] [config] guided-alignment: none
[2023-07-27 17:52:16] [config] guided-alignment-cost: mse
[2023-07-27 17:52:16] [config] guided-alignment-weight: 0.1
[2023-07-27 17:52:16] [config] ignore-model-config: false
[2023-07-27 17:52:16] [config] input-types:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] interpolate-env-vars: false
[2023-07-27 17:52:16] [config] keep-best: false
[2023-07-27 17:52:16] [config] label-smoothing: 0
[2023-07-27 17:52:16] [config] layer-normalization: false
[2023-07-27 17:52:16] [config] learn-rate: 0.0001
[2023-07-27 17:52:16] [config] lemma-dependency: ""
[2023-07-27 17:52:16] [config] lemma-dim-emb: 0
[2023-07-27 17:52:16] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 17:52:16] [config] log-level: info
[2023-07-27 17:52:16] [config] log-time-zone: ""
[2023-07-27 17:52:16] [config] logical-epoch:
[2023-07-27 17:52:16] [config]   - 1e
[2023-07-27 17:52:16] [config]   - 0
[2023-07-27 17:52:16] [config] lr-decay: 0
[2023-07-27 17:52:16] [config] lr-decay-freq: 50000
[2023-07-27 17:52:16] [config] lr-decay-inv-sqrt:
[2023-07-27 17:52:16] [config]   - 0
[2023-07-27 17:52:16] [config] lr-decay-repeat-warmup: false
[2023-07-27 17:52:16] [config] lr-decay-reset-optimizer: false
[2023-07-27 17:52:16] [config] lr-decay-start:
[2023-07-27 17:52:16] [config]   - 10
[2023-07-27 17:52:16] [config]   - 1
[2023-07-27 17:52:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 17:52:16] [config] lr-report: false
[2023-07-27 17:52:16] [config] lr-warmup: 0
[2023-07-27 17:52:16] [config] lr-warmup-at-reload: false
[2023-07-27 17:52:16] [config] lr-warmup-cycle: false
[2023-07-27 17:52:16] [config] lr-warmup-start-rate: 0
[2023-07-27 17:52:16] [config] max-length: 50
[2023-07-27 17:52:16] [config] max-length-crop: true
[2023-07-27 17:52:16] [config] max-length-factor: 3
[2023-07-27 17:52:16] [config] maxi-batch: 100
[2023-07-27 17:52:16] [config] maxi-batch-sort: trg
[2023-07-27 17:52:16] [config] mini-batch: 64
[2023-07-27 17:52:16] [config] mini-batch-fit: true
[2023-07-27 17:52:16] [config] mini-batch-fit-step: 10
[2023-07-27 17:52:16] [config] mini-batch-round-up: true
[2023-07-27 17:52:16] [config] mini-batch-track-lr: false
[2023-07-27 17:52:16] [config] mini-batch-warmup: 0
[2023-07-27 17:52:16] [config] mini-batch-words: 0
[2023-07-27 17:52:16] [config] mini-batch-words-ref: 0
[2023-07-27 17:52:16] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 17:52:16] [config] multi-loss-type: sum
[2023-07-27 17:52:16] [config] n-best: false
[2023-07-27 17:52:16] [config] no-nccl: false
[2023-07-27 17:52:16] [config] no-reload: false
[2023-07-27 17:52:16] [config] no-restore-corpus: false
[2023-07-27 17:52:16] [config] normalize: 0
[2023-07-27 17:52:16] [config] normalize-gradient: false
[2023-07-27 17:52:16] [config] num-devices: 0
[2023-07-27 17:52:16] [config] optimizer: adam
[2023-07-27 17:52:16] [config] optimizer-delay: 1
[2023-07-27 17:52:16] [config] optimizer-params:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] output-omit-bias: false
[2023-07-27 17:52:16] [config] overwrite: true
[2023-07-27 17:52:16] [config] precision:
[2023-07-27 17:52:16] [config]   - float16
[2023-07-27 17:52:16] [config]   - float32
[2023-07-27 17:52:16] [config] pretrained-model: ""
[2023-07-27 17:52:16] [config] quantize-biases: false
[2023-07-27 17:52:16] [config] quantize-bits: 0
[2023-07-27 17:52:16] [config] quantize-log-based: false
[2023-07-27 17:52:16] [config] quantize-optimization-steps: 0
[2023-07-27 17:52:16] [config] quiet: false
[2023-07-27 17:52:16] [config] quiet-translation: true
[2023-07-27 17:52:16] [config] relative-paths: false
[2023-07-27 17:52:16] [config] right-left: false
[2023-07-27 17:52:16] [config] save-freq: 10000u
[2023-07-27 17:52:16] [config] seed: 1234
[2023-07-27 17:52:16] [config] sentencepiece-alphas:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] sentencepiece-max-lines: 2000000
[2023-07-27 17:52:16] [config] sentencepiece-options: ""
[2023-07-27 17:52:16] [config] sharding: global
[2023-07-27 17:52:16] [config] shuffle: data
[2023-07-27 17:52:16] [config] shuffle-in-ram: false
[2023-07-27 17:52:16] [config] sigterm: save-and-exit
[2023-07-27 17:52:16] [config] skip: false
[2023-07-27 17:52:16] [config] sqlite: ""
[2023-07-27 17:52:16] [config] sqlite-drop: false
[2023-07-27 17:52:16] [config] sync-freq: 200u
[2023-07-27 17:52:16] [config] sync-sgd: false
[2023-07-27 17:52:16] [config] tempdir: /tmp
[2023-07-27 17:52:16] [config] tied-embeddings: false
[2023-07-27 17:52:16] [config] tied-embeddings-all: true
[2023-07-27 17:52:16] [config] tied-embeddings-src: false
[2023-07-27 17:52:16] [config] train-embedder-rank:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] train-sets:
[2023-07-27 17:52:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 17:52:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 17:52:16] [config] transformer-aan-activation: swish
[2023-07-27 17:52:16] [config] transformer-aan-depth: 2
[2023-07-27 17:52:16] [config] transformer-aan-nogate: false
[2023-07-27 17:52:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 17:52:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 17:52:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 17:52:16] [config] transformer-depth-scaling: false
[2023-07-27 17:52:16] [config] transformer-dim-aan: 2048
[2023-07-27 17:52:16] [config] transformer-dim-ffn: 2048
[2023-07-27 17:52:16] [config] transformer-dropout: 0
[2023-07-27 17:52:16] [config] transformer-dropout-attention: 0
[2023-07-27 17:52:16] [config] transformer-dropout-ffn: 0
[2023-07-27 17:52:16] [config] transformer-ffn-activation: swish
[2023-07-27 17:52:16] [config] transformer-ffn-depth: 2
[2023-07-27 17:52:16] [config] transformer-guided-alignment-layer: last
[2023-07-27 17:52:16] [config] transformer-heads: 8
[2023-07-27 17:52:16] [config] transformer-no-projection: false
[2023-07-27 17:52:16] [config] transformer-pool: false
[2023-07-27 17:52:16] [config] transformer-postprocess: dan
[2023-07-27 17:52:16] [config] transformer-postprocess-emb: d
[2023-07-27 17:52:16] [config] transformer-postprocess-top: ""
[2023-07-27 17:52:16] [config] transformer-preprocess: ""
[2023-07-27 17:52:16] [config] transformer-tied-layers:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] transformer-train-position-embeddings: false
[2023-07-27 17:52:16] [config] tsv: false
[2023-07-27 17:52:16] [config] tsv-fields: 0
[2023-07-27 17:52:16] [config] type: s2s
[2023-07-27 17:52:16] [config] ulr: false
[2023-07-27 17:52:16] [config] ulr-dim-emb: 0
[2023-07-27 17:52:16] [config] ulr-dropout: 0
[2023-07-27 17:52:16] [config] ulr-keys-vectors: ""
[2023-07-27 17:52:16] [config] ulr-query-vectors: ""
[2023-07-27 17:52:16] [config] ulr-softmax-temperature: 1
[2023-07-27 17:52:16] [config] ulr-trainable-transformation: false
[2023-07-27 17:52:16] [config] unlikelihood-loss: false
[2023-07-27 17:52:16] [config] valid-freq: 50000000
[2023-07-27 17:52:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 17:52:16] [config] valid-max-length: 1000
[2023-07-27 17:52:16] [config] valid-metrics:
[2023-07-27 17:52:16] [config]   - translation
[2023-07-27 17:52:16] [config] valid-mini-batch: 32
[2023-07-27 17:52:16] [config] valid-reset-stalled: false
[2023-07-27 17:52:16] [config] valid-script-args:
[2023-07-27 17:52:16] [config]   []
[2023-07-27 17:52:16] [config] valid-script-path: ""
[2023-07-27 17:52:16] [config] valid-sets:
[2023-07-27 17:52:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 17:52:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 17:52:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 17:52:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:52:16] [config] vocabs:
[2023-07-27 17:52:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 17:52:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 17:52:16] [config] word-penalty: 0
[2023-07-27 17:52:16] [config] word-scores: false
[2023-07-27 17:52:16] [config] workspace: 5500
[2023-07-27 17:52:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:52:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:52:16] [training] Using single-device training
[2023-07-27 17:52:16] Synced seed 1234
[2023-07-27 17:52:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 17:52:17] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 17:52:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 17:52:17] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 17:52:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 17:52:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:52:17] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 17:52:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 17:52:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 17:52:17] [comm] Using global sharding
[2023-07-27 17:52:18] [comm] NCCLCommunicators constructed successfully
[2023-07-27 17:52:18] [training] Using 1 GPUs
[2023-07-27 17:52:18] [logits] Applying loss function for 1 factor(s)
[2023-07-27 17:52:18] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:52:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 17:52:18] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:53:49] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 17:53:50] [valid] No post-processing script given for validating translator
[2023-07-27 17:53:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:53:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 17:53:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 17:53:50] [comm] Using global sharding
[2023-07-27 17:53:50] [comm] NCCLCommunicators constructed successfully
[2023-07-27 17:53:50] [training] Using 1 GPUs
[2023-07-27 17:53:50] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 17:53:54] Allocating memory for general optimizer shards
[2023-07-27 17:53:54] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 17:53:54] Loading Adam parameters
[2023-07-27 17:53:55] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 17:53:55] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:53:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 17:53:57] [data] Restoring the corpus state to epoch 141, batch 11267
[2023-07-27 17:53:57] [data] Shuffling data
[2023-07-27 17:53:57] [data] Done reading 20,192 sentences
[2023-07-27 17:53:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:53:57] Training started
[2023-07-27 17:53:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 17:53:57] [memory] Reserving 332 MB, device gpu0
[2023-07-27 17:54:00] Parameter type float16, optimization type float32, casting types true
[2023-07-27 17:57:01] Seen 20,192 samples
[2023-07-27 17:57:01] Starting data epoch 142 in logical epoch 142
[2023-07-27 17:57:01] [data] Shuffling data
[2023-07-27 17:57:01] [data] Done reading 20,192 sentences
[2023-07-27 17:57:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:00:08] Seen 20,192 samples
[2023-07-27 18:00:08] Starting data epoch 143 in logical epoch 143
[2023-07-27 18:00:08] [data] Shuffling data
[2023-07-27 18:00:08] [data] Done reading 20,192 sentences
[2023-07-27 18:00:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:03:16] Seen 20,192 samples
[2023-07-27 18:03:16] Starting data epoch 144 in logical epoch 144
[2023-07-27 18:03:16] [data] Shuffling data
[2023-07-27 18:03:16] [data] Done reading 20,192 sentences
[2023-07-27 18:03:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:06:23] Seen 20,192 samples
[2023-07-27 18:06:23] Starting data epoch 145 in logical epoch 145
[2023-07-27 18:06:23] [data] Shuffling data
[2023-07-27 18:06:23] [data] Done reading 20,192 sentences
[2023-07-27 18:06:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:09:30] Seen 20,192 samples
[2023-07-27 18:09:30] Starting data epoch 146 in logical epoch 146
[2023-07-27 18:09:30] [data] Shuffling data
[2023-07-27 18:09:30] [data] Done reading 20,192 sentences
[2023-07-27 18:09:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:12:38] Seen 20,192 samples
[2023-07-27 18:12:38] Starting data epoch 147 in logical epoch 147
[2023-07-27 18:12:38] [data] Shuffling data
[2023-07-27 18:12:38] [data] Done reading 20,192 sentences
[2023-07-27 18:12:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:15:45] Seen 20,192 samples
[2023-07-27 18:15:45] Starting data epoch 148 in logical epoch 148
[2023-07-27 18:15:45] [data] Shuffling data
[2023-07-27 18:15:45] [data] Done reading 20,192 sentences
[2023-07-27 18:15:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:18:52] Seen 20,192 samples
[2023-07-27 18:18:52] Starting data epoch 149 in logical epoch 149
[2023-07-27 18:18:52] [data] Shuffling data
[2023-07-27 18:18:52] [data] Done reading 20,192 sentences
[2023-07-27 18:18:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:21:59] Seen 20,192 samples
[2023-07-27 18:21:59] Starting data epoch 150 in logical epoch 150
[2023-07-27 18:21:59] [data] Shuffling data
[2023-07-27 18:21:59] [data] Done reading 20,192 sentences
[2023-07-27 18:21:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:22:16] Ep. 150 : Up. 12000 : Sen. 2,037 : Cost 1.04985654 * 7,034,066 @ 4,049 after 84,548,396 : Time 1706.25s : 4122.53 words/s : gNorm 2.3374
[2023-07-27 18:25:06] Seen 20,192 samples
[2023-07-27 18:25:06] Starting data epoch 151 in logical epoch 151
[2023-07-27 18:25:06] Training finished
[2023-07-27 18:26:21] [valid] Ep. 151 : Up. 12074 : translation : 0 : new best
[2023-07-27 18:26:21] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 18:26:30] Saving Adam parameters
[2023-07-27 18:26:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 18:26:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 18:26:48] [marian] Running on node05.datos.cluster.uy as process 28251 with command line:
[2023-07-27 18:26:48] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 18:26:48] [config] after: 0e
[2023-07-27 18:26:48] [config] after-batches: 0
[2023-07-27 18:26:48] [config] after-epochs: 160
[2023-07-27 18:26:48] [config] all-caps-every: 0
[2023-07-27 18:26:48] [config] allow-unk: false
[2023-07-27 18:26:48] [config] authors: false
[2023-07-27 18:26:48] [config] beam-size: 12
[2023-07-27 18:26:48] [config] bert-class-symbol: "[CLS]"
[2023-07-27 18:26:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 18:26:48] [config] bert-masking-fraction: 0.15
[2023-07-27 18:26:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 18:26:48] [config] bert-train-type-embeddings: true
[2023-07-27 18:26:48] [config] bert-type-vocab-size: 2
[2023-07-27 18:26:48] [config] build-info: ""
[2023-07-27 18:26:48] [config] check-gradient-nan: false
[2023-07-27 18:26:48] [config] check-nan: false
[2023-07-27 18:26:48] [config] cite: false
[2023-07-27 18:26:48] [config] clip-norm: 1
[2023-07-27 18:26:48] [config] cost-scaling:
[2023-07-27 18:26:48] [config]   - 256.f
[2023-07-27 18:26:48] [config]   - 1000
[2023-07-27 18:26:48] [config]   - 2.f
[2023-07-27 18:26:48] [config]   - 256.f
[2023-07-27 18:26:48] [config] cost-type: ce-sum
[2023-07-27 18:26:48] [config] cpu-threads: 0
[2023-07-27 18:26:48] [config] data-threads: 8
[2023-07-27 18:26:48] [config] data-weighting: ""
[2023-07-27 18:26:48] [config] data-weighting-type: sentence
[2023-07-27 18:26:48] [config] dec-cell: gru
[2023-07-27 18:26:48] [config] dec-cell-base-depth: 2
[2023-07-27 18:26:48] [config] dec-cell-high-depth: 1
[2023-07-27 18:26:48] [config] dec-depth: 8
[2023-07-27 18:26:48] [config] devices:
[2023-07-27 18:26:48] [config]   - 0
[2023-07-27 18:26:48] [config] dim-emb: 512
[2023-07-27 18:26:48] [config] dim-rnn: 1024
[2023-07-27 18:26:48] [config] dim-vocabs:
[2023-07-27 18:26:48] [config]   - 16384
[2023-07-27 18:26:48] [config]   - 16384
[2023-07-27 18:26:48] [config] disp-first: 0
[2023-07-27 18:26:48] [config] disp-freq: 1000u
[2023-07-27 18:26:48] [config] disp-label-counts: true
[2023-07-27 18:26:48] [config] dropout-rnn: 0
[2023-07-27 18:26:48] [config] dropout-src: 0
[2023-07-27 18:26:48] [config] dropout-trg: 0
[2023-07-27 18:26:48] [config] dump-config: ""
[2023-07-27 18:26:48] [config] dynamic-gradient-scaling:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] early-stopping: 1000
[2023-07-27 18:26:48] [config] early-stopping-on: first
[2023-07-27 18:26:48] [config] embedding-fix-src: false
[2023-07-27 18:26:48] [config] embedding-fix-trg: false
[2023-07-27 18:26:48] [config] embedding-normalization: false
[2023-07-27 18:26:48] [config] embedding-vectors:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] enc-cell: gru
[2023-07-27 18:26:48] [config] enc-cell-depth: 1
[2023-07-27 18:26:48] [config] enc-depth: 8
[2023-07-27 18:26:48] [config] enc-type: bidirectional
[2023-07-27 18:26:48] [config] english-title-case-every: 0
[2023-07-27 18:26:48] [config] exponential-smoothing: 0
[2023-07-27 18:26:48] [config] factor-weight: 1
[2023-07-27 18:26:48] [config] factors-combine: sum
[2023-07-27 18:26:48] [config] factors-dim-emb: 0
[2023-07-27 18:26:48] [config] gradient-checkpointing: false
[2023-07-27 18:26:48] [config] gradient-norm-average-window: 100
[2023-07-27 18:26:48] [config] guided-alignment: none
[2023-07-27 18:26:48] [config] guided-alignment-cost: mse
[2023-07-27 18:26:48] [config] guided-alignment-weight: 0.1
[2023-07-27 18:26:48] [config] ignore-model-config: false
[2023-07-27 18:26:48] [config] input-types:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] interpolate-env-vars: false
[2023-07-27 18:26:48] [config] keep-best: false
[2023-07-27 18:26:48] [config] label-smoothing: 0
[2023-07-27 18:26:48] [config] layer-normalization: false
[2023-07-27 18:26:48] [config] learn-rate: 0.0001
[2023-07-27 18:26:48] [config] lemma-dependency: ""
[2023-07-27 18:26:48] [config] lemma-dim-emb: 0
[2023-07-27 18:26:48] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 18:26:48] [config] log-level: info
[2023-07-27 18:26:48] [config] log-time-zone: ""
[2023-07-27 18:26:48] [config] logical-epoch:
[2023-07-27 18:26:48] [config]   - 1e
[2023-07-27 18:26:48] [config]   - 0
[2023-07-27 18:26:48] [config] lr-decay: 0
[2023-07-27 18:26:48] [config] lr-decay-freq: 50000
[2023-07-27 18:26:48] [config] lr-decay-inv-sqrt:
[2023-07-27 18:26:48] [config]   - 0
[2023-07-27 18:26:48] [config] lr-decay-repeat-warmup: false
[2023-07-27 18:26:48] [config] lr-decay-reset-optimizer: false
[2023-07-27 18:26:48] [config] lr-decay-start:
[2023-07-27 18:26:48] [config]   - 10
[2023-07-27 18:26:48] [config]   - 1
[2023-07-27 18:26:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 18:26:48] [config] lr-report: false
[2023-07-27 18:26:48] [config] lr-warmup: 0
[2023-07-27 18:26:48] [config] lr-warmup-at-reload: false
[2023-07-27 18:26:48] [config] lr-warmup-cycle: false
[2023-07-27 18:26:48] [config] lr-warmup-start-rate: 0
[2023-07-27 18:26:48] [config] max-length: 50
[2023-07-27 18:26:48] [config] max-length-crop: true
[2023-07-27 18:26:48] [config] max-length-factor: 3
[2023-07-27 18:26:48] [config] maxi-batch: 100
[2023-07-27 18:26:48] [config] maxi-batch-sort: trg
[2023-07-27 18:26:48] [config] mini-batch: 64
[2023-07-27 18:26:48] [config] mini-batch-fit: true
[2023-07-27 18:26:48] [config] mini-batch-fit-step: 10
[2023-07-27 18:26:48] [config] mini-batch-round-up: true
[2023-07-27 18:26:48] [config] mini-batch-track-lr: false
[2023-07-27 18:26:48] [config] mini-batch-warmup: 0
[2023-07-27 18:26:48] [config] mini-batch-words: 0
[2023-07-27 18:26:48] [config] mini-batch-words-ref: 0
[2023-07-27 18:26:48] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 18:26:48] [config] multi-loss-type: sum
[2023-07-27 18:26:48] [config] n-best: false
[2023-07-27 18:26:48] [config] no-nccl: false
[2023-07-27 18:26:48] [config] no-reload: false
[2023-07-27 18:26:48] [config] no-restore-corpus: false
[2023-07-27 18:26:48] [config] normalize: 0
[2023-07-27 18:26:48] [config] normalize-gradient: false
[2023-07-27 18:26:48] [config] num-devices: 0
[2023-07-27 18:26:48] [config] optimizer: adam
[2023-07-27 18:26:48] [config] optimizer-delay: 1
[2023-07-27 18:26:48] [config] optimizer-params:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] output-omit-bias: false
[2023-07-27 18:26:48] [config] overwrite: true
[2023-07-27 18:26:48] [config] precision:
[2023-07-27 18:26:48] [config]   - float16
[2023-07-27 18:26:48] [config]   - float32
[2023-07-27 18:26:48] [config] pretrained-model: ""
[2023-07-27 18:26:48] [config] quantize-biases: false
[2023-07-27 18:26:48] [config] quantize-bits: 0
[2023-07-27 18:26:48] [config] quantize-log-based: false
[2023-07-27 18:26:48] [config] quantize-optimization-steps: 0
[2023-07-27 18:26:48] [config] quiet: false
[2023-07-27 18:26:48] [config] quiet-translation: true
[2023-07-27 18:26:48] [config] relative-paths: false
[2023-07-27 18:26:48] [config] right-left: false
[2023-07-27 18:26:48] [config] save-freq: 10000u
[2023-07-27 18:26:48] [config] seed: 1234
[2023-07-27 18:26:48] [config] sentencepiece-alphas:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] sentencepiece-max-lines: 2000000
[2023-07-27 18:26:48] [config] sentencepiece-options: ""
[2023-07-27 18:26:48] [config] sharding: global
[2023-07-27 18:26:48] [config] shuffle: data
[2023-07-27 18:26:48] [config] shuffle-in-ram: false
[2023-07-27 18:26:48] [config] sigterm: save-and-exit
[2023-07-27 18:26:48] [config] skip: false
[2023-07-27 18:26:48] [config] sqlite: ""
[2023-07-27 18:26:48] [config] sqlite-drop: false
[2023-07-27 18:26:48] [config] sync-freq: 200u
[2023-07-27 18:26:48] [config] sync-sgd: false
[2023-07-27 18:26:48] [config] tempdir: /tmp
[2023-07-27 18:26:48] [config] tied-embeddings: false
[2023-07-27 18:26:48] [config] tied-embeddings-all: true
[2023-07-27 18:26:48] [config] tied-embeddings-src: false
[2023-07-27 18:26:48] [config] train-embedder-rank:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] train-sets:
[2023-07-27 18:26:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 18:26:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 18:26:48] [config] transformer-aan-activation: swish
[2023-07-27 18:26:48] [config] transformer-aan-depth: 2
[2023-07-27 18:26:48] [config] transformer-aan-nogate: false
[2023-07-27 18:26:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 18:26:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 18:26:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 18:26:48] [config] transformer-depth-scaling: false
[2023-07-27 18:26:48] [config] transformer-dim-aan: 2048
[2023-07-27 18:26:48] [config] transformer-dim-ffn: 2048
[2023-07-27 18:26:48] [config] transformer-dropout: 0
[2023-07-27 18:26:48] [config] transformer-dropout-attention: 0
[2023-07-27 18:26:48] [config] transformer-dropout-ffn: 0
[2023-07-27 18:26:48] [config] transformer-ffn-activation: swish
[2023-07-27 18:26:48] [config] transformer-ffn-depth: 2
[2023-07-27 18:26:48] [config] transformer-guided-alignment-layer: last
[2023-07-27 18:26:48] [config] transformer-heads: 8
[2023-07-27 18:26:48] [config] transformer-no-projection: false
[2023-07-27 18:26:48] [config] transformer-pool: false
[2023-07-27 18:26:48] [config] transformer-postprocess: dan
[2023-07-27 18:26:48] [config] transformer-postprocess-emb: d
[2023-07-27 18:26:48] [config] transformer-postprocess-top: ""
[2023-07-27 18:26:48] [config] transformer-preprocess: ""
[2023-07-27 18:26:48] [config] transformer-tied-layers:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] transformer-train-position-embeddings: false
[2023-07-27 18:26:48] [config] tsv: false
[2023-07-27 18:26:48] [config] tsv-fields: 0
[2023-07-27 18:26:48] [config] type: s2s
[2023-07-27 18:26:48] [config] ulr: false
[2023-07-27 18:26:48] [config] ulr-dim-emb: 0
[2023-07-27 18:26:48] [config] ulr-dropout: 0
[2023-07-27 18:26:48] [config] ulr-keys-vectors: ""
[2023-07-27 18:26:48] [config] ulr-query-vectors: ""
[2023-07-27 18:26:48] [config] ulr-softmax-temperature: 1
[2023-07-27 18:26:48] [config] ulr-trainable-transformation: false
[2023-07-27 18:26:48] [config] unlikelihood-loss: false
[2023-07-27 18:26:48] [config] valid-freq: 50000000
[2023-07-27 18:26:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 18:26:48] [config] valid-max-length: 1000
[2023-07-27 18:26:48] [config] valid-metrics:
[2023-07-27 18:26:48] [config]   - translation
[2023-07-27 18:26:48] [config] valid-mini-batch: 32
[2023-07-27 18:26:48] [config] valid-reset-stalled: false
[2023-07-27 18:26:48] [config] valid-script-args:
[2023-07-27 18:26:48] [config]   []
[2023-07-27 18:26:48] [config] valid-script-path: ""
[2023-07-27 18:26:48] [config] valid-sets:
[2023-07-27 18:26:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 18:26:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 18:26:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 18:26:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 18:26:48] [config] vocabs:
[2023-07-27 18:26:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 18:26:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 18:26:48] [config] word-penalty: 0
[2023-07-27 18:26:48] [config] word-scores: false
[2023-07-27 18:26:48] [config] workspace: 5500
[2023-07-27 18:26:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 18:26:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 18:26:48] [training] Using single-device training
[2023-07-27 18:26:48] Synced seed 1234
[2023-07-27 18:26:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 18:26:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 18:26:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 18:26:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 18:26:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 18:26:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 18:26:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 18:26:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 18:26:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 18:26:49] [comm] Using global sharding
[2023-07-27 18:26:49] [comm] NCCLCommunicators constructed successfully
[2023-07-27 18:26:49] [training] Using 1 GPUs
[2023-07-27 18:26:49] [logits] Applying loss function for 1 factor(s)
[2023-07-27 18:26:49] [memory] Reserving 332 MB, device gpu0
[2023-07-27 18:26:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 18:26:50] [memory] Reserving 332 MB, device gpu0
[2023-07-27 18:28:22] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 18:28:22] [valid] No post-processing script given for validating translator
[2023-07-27 18:28:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 18:28:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 18:28:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 18:28:22] [comm] Using global sharding
[2023-07-27 18:28:22] [comm] NCCLCommunicators constructed successfully
[2023-07-27 18:28:22] [training] Using 1 GPUs
[2023-07-27 18:28:22] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 18:28:26] Allocating memory for general optimizer shards
[2023-07-27 18:28:26] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 18:28:27] Loading Adam parameters
[2023-07-27 18:28:27] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 18:28:27] [memory] Reserving 332 MB, device gpu0
[2023-07-27 18:28:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 18:28:29] [data] Restoring the corpus state to epoch 151, batch 12074
[2023-07-27 18:28:29] [data] Shuffling data
[2023-07-27 18:28:29] [data] Done reading 20,192 sentences
[2023-07-27 18:28:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:28:29] Training started
[2023-07-27 18:28:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 18:28:29] [memory] Reserving 332 MB, device gpu0
[2023-07-27 18:28:31] Parameter type float16, optimization type float32, casting types true
[2023-07-27 18:31:33] Seen 20,192 samples
[2023-07-27 18:31:33] Starting data epoch 152 in logical epoch 152
[2023-07-27 18:31:33] [data] Shuffling data
[2023-07-27 18:31:33] [data] Done reading 20,192 sentences
[2023-07-27 18:31:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:34:38] Seen 20,192 samples
[2023-07-27 18:34:38] Starting data epoch 153 in logical epoch 153
[2023-07-27 18:34:38] [data] Shuffling data
[2023-07-27 18:34:38] [data] Done reading 20,192 sentences
[2023-07-27 18:34:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:37:46] Seen 20,192 samples
[2023-07-27 18:37:46] Starting data epoch 154 in logical epoch 154
[2023-07-27 18:37:46] [data] Shuffling data
[2023-07-27 18:37:46] [data] Done reading 20,192 sentences
[2023-07-27 18:37:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:40:53] Seen 20,192 samples
[2023-07-27 18:40:53] Starting data epoch 155 in logical epoch 155
[2023-07-27 18:40:53] [data] Shuffling data
[2023-07-27 18:40:53] [data] Done reading 20,192 sentences
[2023-07-27 18:40:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:44:00] Seen 20,192 samples
[2023-07-27 18:44:00] Starting data epoch 156 in logical epoch 156
[2023-07-27 18:44:00] [data] Shuffling data
[2023-07-27 18:44:00] [data] Done reading 20,192 sentences
[2023-07-27 18:44:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:47:07] Seen 20,192 samples
[2023-07-27 18:47:07] Starting data epoch 157 in logical epoch 157
[2023-07-27 18:47:07] [data] Shuffling data
[2023-07-27 18:47:07] [data] Done reading 20,192 sentences
[2023-07-27 18:47:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:50:14] Seen 20,192 samples
[2023-07-27 18:50:14] Starting data epoch 158 in logical epoch 158
[2023-07-27 18:50:14] [data] Shuffling data
[2023-07-27 18:50:14] [data] Done reading 20,192 sentences
[2023-07-27 18:50:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:53:20] Seen 20,192 samples
[2023-07-27 18:53:20] Starting data epoch 159 in logical epoch 159
[2023-07-27 18:53:20] [data] Shuffling data
[2023-07-27 18:53:20] [data] Done reading 20,192 sentences
[2023-07-27 18:53:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:56:26] Seen 20,192 samples
[2023-07-27 18:56:27] Starting data epoch 160 in logical epoch 160
[2023-07-27 18:56:27] [data] Shuffling data
[2023-07-27 18:56:27] [data] Done reading 20,192 sentences
[2023-07-27 18:56:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:59:34] Seen 20,192 samples
[2023-07-27 18:59:34] Starting data epoch 161 in logical epoch 161
[2023-07-27 18:59:34] Training finished
[2023-07-27 19:00:49] [valid] Ep. 161 : Up. 12881 : translation : 0 : new best
[2023-07-27 19:00:49] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 19:00:56] Saving Adam parameters
[2023-07-27 19:00:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 19:01:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:01:20] [marian] Running on node05.datos.cluster.uy as process 30441 with command line:
[2023-07-27 19:01:20] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 19:01:20] [config] after: 0e
[2023-07-27 19:01:20] [config] after-batches: 0
[2023-07-27 19:01:20] [config] after-epochs: 170
[2023-07-27 19:01:20] [config] all-caps-every: 0
[2023-07-27 19:01:20] [config] allow-unk: false
[2023-07-27 19:01:20] [config] authors: false
[2023-07-27 19:01:20] [config] beam-size: 12
[2023-07-27 19:01:20] [config] bert-class-symbol: "[CLS]"
[2023-07-27 19:01:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 19:01:20] [config] bert-masking-fraction: 0.15
[2023-07-27 19:01:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 19:01:20] [config] bert-train-type-embeddings: true
[2023-07-27 19:01:20] [config] bert-type-vocab-size: 2
[2023-07-27 19:01:20] [config] build-info: ""
[2023-07-27 19:01:20] [config] check-gradient-nan: false
[2023-07-27 19:01:20] [config] check-nan: false
[2023-07-27 19:01:20] [config] cite: false
[2023-07-27 19:01:20] [config] clip-norm: 1
[2023-07-27 19:01:20] [config] cost-scaling:
[2023-07-27 19:01:20] [config]   - 256.f
[2023-07-27 19:01:20] [config]   - 1000
[2023-07-27 19:01:20] [config]   - 2.f
[2023-07-27 19:01:20] [config]   - 256.f
[2023-07-27 19:01:20] [config] cost-type: ce-sum
[2023-07-27 19:01:20] [config] cpu-threads: 0
[2023-07-27 19:01:20] [config] data-threads: 8
[2023-07-27 19:01:20] [config] data-weighting: ""
[2023-07-27 19:01:20] [config] data-weighting-type: sentence
[2023-07-27 19:01:20] [config] dec-cell: gru
[2023-07-27 19:01:20] [config] dec-cell-base-depth: 2
[2023-07-27 19:01:20] [config] dec-cell-high-depth: 1
[2023-07-27 19:01:20] [config] dec-depth: 8
[2023-07-27 19:01:20] [config] devices:
[2023-07-27 19:01:20] [config]   - 0
[2023-07-27 19:01:20] [config] dim-emb: 512
[2023-07-27 19:01:20] [config] dim-rnn: 1024
[2023-07-27 19:01:20] [config] dim-vocabs:
[2023-07-27 19:01:20] [config]   - 16384
[2023-07-27 19:01:20] [config]   - 16384
[2023-07-27 19:01:20] [config] disp-first: 0
[2023-07-27 19:01:20] [config] disp-freq: 1000u
[2023-07-27 19:01:20] [config] disp-label-counts: true
[2023-07-27 19:01:20] [config] dropout-rnn: 0
[2023-07-27 19:01:20] [config] dropout-src: 0
[2023-07-27 19:01:20] [config] dropout-trg: 0
[2023-07-27 19:01:20] [config] dump-config: ""
[2023-07-27 19:01:20] [config] dynamic-gradient-scaling:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] early-stopping: 1000
[2023-07-27 19:01:20] [config] early-stopping-on: first
[2023-07-27 19:01:20] [config] embedding-fix-src: false
[2023-07-27 19:01:20] [config] embedding-fix-trg: false
[2023-07-27 19:01:20] [config] embedding-normalization: false
[2023-07-27 19:01:20] [config] embedding-vectors:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] enc-cell: gru
[2023-07-27 19:01:20] [config] enc-cell-depth: 1
[2023-07-27 19:01:20] [config] enc-depth: 8
[2023-07-27 19:01:20] [config] enc-type: bidirectional
[2023-07-27 19:01:20] [config] english-title-case-every: 0
[2023-07-27 19:01:20] [config] exponential-smoothing: 0
[2023-07-27 19:01:20] [config] factor-weight: 1
[2023-07-27 19:01:20] [config] factors-combine: sum
[2023-07-27 19:01:20] [config] factors-dim-emb: 0
[2023-07-27 19:01:20] [config] gradient-checkpointing: false
[2023-07-27 19:01:20] [config] gradient-norm-average-window: 100
[2023-07-27 19:01:20] [config] guided-alignment: none
[2023-07-27 19:01:20] [config] guided-alignment-cost: mse
[2023-07-27 19:01:20] [config] guided-alignment-weight: 0.1
[2023-07-27 19:01:20] [config] ignore-model-config: false
[2023-07-27 19:01:20] [config] input-types:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] interpolate-env-vars: false
[2023-07-27 19:01:20] [config] keep-best: false
[2023-07-27 19:01:20] [config] label-smoothing: 0
[2023-07-27 19:01:20] [config] layer-normalization: false
[2023-07-27 19:01:20] [config] learn-rate: 0.0001
[2023-07-27 19:01:20] [config] lemma-dependency: ""
[2023-07-27 19:01:20] [config] lemma-dim-emb: 0
[2023-07-27 19:01:20] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 19:01:20] [config] log-level: info
[2023-07-27 19:01:20] [config] log-time-zone: ""
[2023-07-27 19:01:20] [config] logical-epoch:
[2023-07-27 19:01:20] [config]   - 1e
[2023-07-27 19:01:20] [config]   - 0
[2023-07-27 19:01:20] [config] lr-decay: 0
[2023-07-27 19:01:20] [config] lr-decay-freq: 50000
[2023-07-27 19:01:20] [config] lr-decay-inv-sqrt:
[2023-07-27 19:01:20] [config]   - 0
[2023-07-27 19:01:20] [config] lr-decay-repeat-warmup: false
[2023-07-27 19:01:20] [config] lr-decay-reset-optimizer: false
[2023-07-27 19:01:20] [config] lr-decay-start:
[2023-07-27 19:01:20] [config]   - 10
[2023-07-27 19:01:20] [config]   - 1
[2023-07-27 19:01:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 19:01:20] [config] lr-report: false
[2023-07-27 19:01:20] [config] lr-warmup: 0
[2023-07-27 19:01:20] [config] lr-warmup-at-reload: false
[2023-07-27 19:01:20] [config] lr-warmup-cycle: false
[2023-07-27 19:01:20] [config] lr-warmup-start-rate: 0
[2023-07-27 19:01:20] [config] max-length: 50
[2023-07-27 19:01:20] [config] max-length-crop: true
[2023-07-27 19:01:20] [config] max-length-factor: 3
[2023-07-27 19:01:20] [config] maxi-batch: 100
[2023-07-27 19:01:20] [config] maxi-batch-sort: trg
[2023-07-27 19:01:20] [config] mini-batch: 64
[2023-07-27 19:01:20] [config] mini-batch-fit: true
[2023-07-27 19:01:20] [config] mini-batch-fit-step: 10
[2023-07-27 19:01:20] [config] mini-batch-round-up: true
[2023-07-27 19:01:20] [config] mini-batch-track-lr: false
[2023-07-27 19:01:20] [config] mini-batch-warmup: 0
[2023-07-27 19:01:20] [config] mini-batch-words: 0
[2023-07-27 19:01:20] [config] mini-batch-words-ref: 0
[2023-07-27 19:01:20] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 19:01:20] [config] multi-loss-type: sum
[2023-07-27 19:01:20] [config] n-best: false
[2023-07-27 19:01:20] [config] no-nccl: false
[2023-07-27 19:01:20] [config] no-reload: false
[2023-07-27 19:01:20] [config] no-restore-corpus: false
[2023-07-27 19:01:20] [config] normalize: 0
[2023-07-27 19:01:20] [config] normalize-gradient: false
[2023-07-27 19:01:20] [config] num-devices: 0
[2023-07-27 19:01:20] [config] optimizer: adam
[2023-07-27 19:01:20] [config] optimizer-delay: 1
[2023-07-27 19:01:20] [config] optimizer-params:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] output-omit-bias: false
[2023-07-27 19:01:20] [config] overwrite: true
[2023-07-27 19:01:20] [config] precision:
[2023-07-27 19:01:20] [config]   - float16
[2023-07-27 19:01:20] [config]   - float32
[2023-07-27 19:01:20] [config] pretrained-model: ""
[2023-07-27 19:01:20] [config] quantize-biases: false
[2023-07-27 19:01:20] [config] quantize-bits: 0
[2023-07-27 19:01:20] [config] quantize-log-based: false
[2023-07-27 19:01:20] [config] quantize-optimization-steps: 0
[2023-07-27 19:01:20] [config] quiet: false
[2023-07-27 19:01:20] [config] quiet-translation: true
[2023-07-27 19:01:20] [config] relative-paths: false
[2023-07-27 19:01:20] [config] right-left: false
[2023-07-27 19:01:20] [config] save-freq: 10000u
[2023-07-27 19:01:20] [config] seed: 1234
[2023-07-27 19:01:20] [config] sentencepiece-alphas:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] sentencepiece-max-lines: 2000000
[2023-07-27 19:01:20] [config] sentencepiece-options: ""
[2023-07-27 19:01:20] [config] sharding: global
[2023-07-27 19:01:20] [config] shuffle: data
[2023-07-27 19:01:20] [config] shuffle-in-ram: false
[2023-07-27 19:01:20] [config] sigterm: save-and-exit
[2023-07-27 19:01:20] [config] skip: false
[2023-07-27 19:01:20] [config] sqlite: ""
[2023-07-27 19:01:20] [config] sqlite-drop: false
[2023-07-27 19:01:20] [config] sync-freq: 200u
[2023-07-27 19:01:20] [config] sync-sgd: false
[2023-07-27 19:01:20] [config] tempdir: /tmp
[2023-07-27 19:01:20] [config] tied-embeddings: false
[2023-07-27 19:01:20] [config] tied-embeddings-all: true
[2023-07-27 19:01:20] [config] tied-embeddings-src: false
[2023-07-27 19:01:20] [config] train-embedder-rank:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] train-sets:
[2023-07-27 19:01:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 19:01:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 19:01:20] [config] transformer-aan-activation: swish
[2023-07-27 19:01:20] [config] transformer-aan-depth: 2
[2023-07-27 19:01:20] [config] transformer-aan-nogate: false
[2023-07-27 19:01:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 19:01:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 19:01:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 19:01:20] [config] transformer-depth-scaling: false
[2023-07-27 19:01:20] [config] transformer-dim-aan: 2048
[2023-07-27 19:01:20] [config] transformer-dim-ffn: 2048
[2023-07-27 19:01:20] [config] transformer-dropout: 0
[2023-07-27 19:01:20] [config] transformer-dropout-attention: 0
[2023-07-27 19:01:20] [config] transformer-dropout-ffn: 0
[2023-07-27 19:01:20] [config] transformer-ffn-activation: swish
[2023-07-27 19:01:20] [config] transformer-ffn-depth: 2
[2023-07-27 19:01:20] [config] transformer-guided-alignment-layer: last
[2023-07-27 19:01:20] [config] transformer-heads: 8
[2023-07-27 19:01:20] [config] transformer-no-projection: false
[2023-07-27 19:01:20] [config] transformer-pool: false
[2023-07-27 19:01:20] [config] transformer-postprocess: dan
[2023-07-27 19:01:20] [config] transformer-postprocess-emb: d
[2023-07-27 19:01:20] [config] transformer-postprocess-top: ""
[2023-07-27 19:01:20] [config] transformer-preprocess: ""
[2023-07-27 19:01:20] [config] transformer-tied-layers:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] transformer-train-position-embeddings: false
[2023-07-27 19:01:20] [config] tsv: false
[2023-07-27 19:01:20] [config] tsv-fields: 0
[2023-07-27 19:01:20] [config] type: s2s
[2023-07-27 19:01:20] [config] ulr: false
[2023-07-27 19:01:20] [config] ulr-dim-emb: 0
[2023-07-27 19:01:20] [config] ulr-dropout: 0
[2023-07-27 19:01:20] [config] ulr-keys-vectors: ""
[2023-07-27 19:01:20] [config] ulr-query-vectors: ""
[2023-07-27 19:01:20] [config] ulr-softmax-temperature: 1
[2023-07-27 19:01:20] [config] ulr-trainable-transformation: false
[2023-07-27 19:01:20] [config] unlikelihood-loss: false
[2023-07-27 19:01:20] [config] valid-freq: 50000000
[2023-07-27 19:01:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 19:01:20] [config] valid-max-length: 1000
[2023-07-27 19:01:20] [config] valid-metrics:
[2023-07-27 19:01:20] [config]   - translation
[2023-07-27 19:01:20] [config] valid-mini-batch: 32
[2023-07-27 19:01:20] [config] valid-reset-stalled: false
[2023-07-27 19:01:20] [config] valid-script-args:
[2023-07-27 19:01:20] [config]   []
[2023-07-27 19:01:20] [config] valid-script-path: ""
[2023-07-27 19:01:20] [config] valid-sets:
[2023-07-27 19:01:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 19:01:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 19:01:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 19:01:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:01:20] [config] vocabs:
[2023-07-27 19:01:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 19:01:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 19:01:20] [config] word-penalty: 0
[2023-07-27 19:01:20] [config] word-scores: false
[2023-07-27 19:01:20] [config] workspace: 5500
[2023-07-27 19:01:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:01:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:01:20] [training] Using single-device training
[2023-07-27 19:01:20] Synced seed 1234
[2023-07-27 19:01:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 19:01:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 19:01:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 19:01:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 19:01:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 19:01:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:01:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 19:01:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 19:01:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 19:01:22] [comm] Using global sharding
[2023-07-27 19:01:22] [comm] NCCLCommunicators constructed successfully
[2023-07-27 19:01:22] [training] Using 1 GPUs
[2023-07-27 19:01:22] [logits] Applying loss function for 1 factor(s)
[2023-07-27 19:01:22] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:01:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 19:01:22] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:02:54] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 19:02:54] [valid] No post-processing script given for validating translator
[2023-07-27 19:02:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:02:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 19:02:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 19:02:54] [comm] Using global sharding
[2023-07-27 19:02:54] [comm] NCCLCommunicators constructed successfully
[2023-07-27 19:02:54] [training] Using 1 GPUs
[2023-07-27 19:02:54] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 19:02:59] Allocating memory for general optimizer shards
[2023-07-27 19:02:59] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 19:02:59] Loading Adam parameters
[2023-07-27 19:02:59] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 19:03:00] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:03:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 19:03:01] [data] Restoring the corpus state to epoch 161, batch 12881
[2023-07-27 19:03:01] [data] Shuffling data
[2023-07-27 19:03:01] [data] Done reading 20,192 sentences
[2023-07-27 19:03:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:03:01] Training started
[2023-07-27 19:03:01] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 19:03:02] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:03:04] Parameter type float16, optimization type float32, casting types true
[2023-07-27 19:06:04] Seen 20,192 samples
[2023-07-27 19:06:04] Starting data epoch 162 in logical epoch 162
[2023-07-27 19:06:04] [data] Shuffling data
[2023-07-27 19:06:04] [data] Done reading 20,192 sentences
[2023-07-27 19:06:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:07:34] Ep. 162 : Up. 13000 : Sen. 9,588 : Cost 0.78123337 * 7,029,399 @ 3,749 after 91,577,795 : Time 280.31s : 25077.55 words/s : gNorm 2.6891
[2023-07-27 19:09:12] Seen 20,192 samples
[2023-07-27 19:09:12] Starting data epoch 163 in logical epoch 163
[2023-07-27 19:09:12] [data] Shuffling data
[2023-07-27 19:09:12] [data] Done reading 20,192 sentences
[2023-07-27 19:09:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:12:16] Seen 20,192 samples
[2023-07-27 19:12:16] Starting data epoch 164 in logical epoch 164
[2023-07-27 19:12:16] [data] Shuffling data
[2023-07-27 19:12:16] [data] Done reading 20,192 sentences
[2023-07-27 19:12:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:15:24] Seen 20,192 samples
[2023-07-27 19:15:24] Starting data epoch 165 in logical epoch 165
[2023-07-27 19:15:24] [data] Shuffling data
[2023-07-27 19:15:24] [data] Done reading 20,192 sentences
[2023-07-27 19:15:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:18:30] Seen 20,192 samples
[2023-07-27 19:18:30] Starting data epoch 166 in logical epoch 166
[2023-07-27 19:18:30] [data] Shuffling data
[2023-07-27 19:18:30] [data] Done reading 20,192 sentences
[2023-07-27 19:18:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:21:36] Seen 20,192 samples
[2023-07-27 19:21:36] Starting data epoch 167 in logical epoch 167
[2023-07-27 19:21:36] [data] Shuffling data
[2023-07-27 19:21:36] [data] Done reading 20,192 sentences
[2023-07-27 19:21:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:24:42] Seen 20,192 samples
[2023-07-27 19:24:42] Starting data epoch 168 in logical epoch 168
[2023-07-27 19:24:42] [data] Shuffling data
[2023-07-27 19:24:42] [data] Done reading 20,192 sentences
[2023-07-27 19:24:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:27:48] Seen 20,192 samples
[2023-07-27 19:27:48] Starting data epoch 169 in logical epoch 169
[2023-07-27 19:27:48] [data] Shuffling data
[2023-07-27 19:27:48] [data] Done reading 20,192 sentences
[2023-07-27 19:27:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:30:53] Seen 20,192 samples
[2023-07-27 19:30:53] Starting data epoch 170 in logical epoch 170
[2023-07-27 19:30:53] [data] Shuffling data
[2023-07-27 19:30:53] [data] Done reading 20,192 sentences
[2023-07-27 19:30:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:34:00] Seen 20,192 samples
[2023-07-27 19:34:00] Starting data epoch 171 in logical epoch 171
[2023-07-27 19:34:00] Training finished
[2023-07-27 19:35:14] [valid] Ep. 171 : Up. 13688 : translation : 0 : new best
[2023-07-27 19:35:14] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 19:35:20] Saving Adam parameters
[2023-07-27 19:35:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 19:35:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:35:38] [marian] Running on node05.datos.cluster.uy as process 32614 with command line:
[2023-07-27 19:35:38] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 19:35:38] [config] after: 0e
[2023-07-27 19:35:38] [config] after-batches: 0
[2023-07-27 19:35:38] [config] after-epochs: 180
[2023-07-27 19:35:38] [config] all-caps-every: 0
[2023-07-27 19:35:38] [config] allow-unk: false
[2023-07-27 19:35:38] [config] authors: false
[2023-07-27 19:35:38] [config] beam-size: 12
[2023-07-27 19:35:38] [config] bert-class-symbol: "[CLS]"
[2023-07-27 19:35:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 19:35:38] [config] bert-masking-fraction: 0.15
[2023-07-27 19:35:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 19:35:38] [config] bert-train-type-embeddings: true
[2023-07-27 19:35:38] [config] bert-type-vocab-size: 2
[2023-07-27 19:35:38] [config] build-info: ""
[2023-07-27 19:35:38] [config] check-gradient-nan: false
[2023-07-27 19:35:38] [config] check-nan: false
[2023-07-27 19:35:38] [config] cite: false
[2023-07-27 19:35:38] [config] clip-norm: 1
[2023-07-27 19:35:38] [config] cost-scaling:
[2023-07-27 19:35:38] [config]   - 256.f
[2023-07-27 19:35:38] [config]   - 1000
[2023-07-27 19:35:38] [config]   - 2.f
[2023-07-27 19:35:38] [config]   - 256.f
[2023-07-27 19:35:38] [config] cost-type: ce-sum
[2023-07-27 19:35:38] [config] cpu-threads: 0
[2023-07-27 19:35:38] [config] data-threads: 8
[2023-07-27 19:35:38] [config] data-weighting: ""
[2023-07-27 19:35:38] [config] data-weighting-type: sentence
[2023-07-27 19:35:38] [config] dec-cell: gru
[2023-07-27 19:35:38] [config] dec-cell-base-depth: 2
[2023-07-27 19:35:38] [config] dec-cell-high-depth: 1
[2023-07-27 19:35:38] [config] dec-depth: 8
[2023-07-27 19:35:38] [config] devices:
[2023-07-27 19:35:38] [config]   - 0
[2023-07-27 19:35:38] [config] dim-emb: 512
[2023-07-27 19:35:38] [config] dim-rnn: 1024
[2023-07-27 19:35:38] [config] dim-vocabs:
[2023-07-27 19:35:38] [config]   - 16384
[2023-07-27 19:35:38] [config]   - 16384
[2023-07-27 19:35:38] [config] disp-first: 0
[2023-07-27 19:35:38] [config] disp-freq: 1000u
[2023-07-27 19:35:38] [config] disp-label-counts: true
[2023-07-27 19:35:38] [config] dropout-rnn: 0
[2023-07-27 19:35:38] [config] dropout-src: 0
[2023-07-27 19:35:38] [config] dropout-trg: 0
[2023-07-27 19:35:38] [config] dump-config: ""
[2023-07-27 19:35:38] [config] dynamic-gradient-scaling:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] early-stopping: 1000
[2023-07-27 19:35:38] [config] early-stopping-on: first
[2023-07-27 19:35:38] [config] embedding-fix-src: false
[2023-07-27 19:35:38] [config] embedding-fix-trg: false
[2023-07-27 19:35:38] [config] embedding-normalization: false
[2023-07-27 19:35:38] [config] embedding-vectors:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] enc-cell: gru
[2023-07-27 19:35:38] [config] enc-cell-depth: 1
[2023-07-27 19:35:38] [config] enc-depth: 8
[2023-07-27 19:35:38] [config] enc-type: bidirectional
[2023-07-27 19:35:38] [config] english-title-case-every: 0
[2023-07-27 19:35:38] [config] exponential-smoothing: 0
[2023-07-27 19:35:38] [config] factor-weight: 1
[2023-07-27 19:35:38] [config] factors-combine: sum
[2023-07-27 19:35:38] [config] factors-dim-emb: 0
[2023-07-27 19:35:38] [config] gradient-checkpointing: false
[2023-07-27 19:35:38] [config] gradient-norm-average-window: 100
[2023-07-27 19:35:38] [config] guided-alignment: none
[2023-07-27 19:35:38] [config] guided-alignment-cost: mse
[2023-07-27 19:35:38] [config] guided-alignment-weight: 0.1
[2023-07-27 19:35:38] [config] ignore-model-config: false
[2023-07-27 19:35:38] [config] input-types:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] interpolate-env-vars: false
[2023-07-27 19:35:38] [config] keep-best: false
[2023-07-27 19:35:38] [config] label-smoothing: 0
[2023-07-27 19:35:38] [config] layer-normalization: false
[2023-07-27 19:35:38] [config] learn-rate: 0.0001
[2023-07-27 19:35:38] [config] lemma-dependency: ""
[2023-07-27 19:35:38] [config] lemma-dim-emb: 0
[2023-07-27 19:35:38] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 19:35:38] [config] log-level: info
[2023-07-27 19:35:38] [config] log-time-zone: ""
[2023-07-27 19:35:38] [config] logical-epoch:
[2023-07-27 19:35:38] [config]   - 1e
[2023-07-27 19:35:38] [config]   - 0
[2023-07-27 19:35:38] [config] lr-decay: 0
[2023-07-27 19:35:38] [config] lr-decay-freq: 50000
[2023-07-27 19:35:38] [config] lr-decay-inv-sqrt:
[2023-07-27 19:35:38] [config]   - 0
[2023-07-27 19:35:38] [config] lr-decay-repeat-warmup: false
[2023-07-27 19:35:38] [config] lr-decay-reset-optimizer: false
[2023-07-27 19:35:38] [config] lr-decay-start:
[2023-07-27 19:35:38] [config]   - 10
[2023-07-27 19:35:38] [config]   - 1
[2023-07-27 19:35:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 19:35:38] [config] lr-report: false
[2023-07-27 19:35:38] [config] lr-warmup: 0
[2023-07-27 19:35:38] [config] lr-warmup-at-reload: false
[2023-07-27 19:35:38] [config] lr-warmup-cycle: false
[2023-07-27 19:35:38] [config] lr-warmup-start-rate: 0
[2023-07-27 19:35:38] [config] max-length: 50
[2023-07-27 19:35:38] [config] max-length-crop: true
[2023-07-27 19:35:38] [config] max-length-factor: 3
[2023-07-27 19:35:38] [config] maxi-batch: 100
[2023-07-27 19:35:38] [config] maxi-batch-sort: trg
[2023-07-27 19:35:38] [config] mini-batch: 64
[2023-07-27 19:35:38] [config] mini-batch-fit: true
[2023-07-27 19:35:38] [config] mini-batch-fit-step: 10
[2023-07-27 19:35:38] [config] mini-batch-round-up: true
[2023-07-27 19:35:38] [config] mini-batch-track-lr: false
[2023-07-27 19:35:38] [config] mini-batch-warmup: 0
[2023-07-27 19:35:38] [config] mini-batch-words: 0
[2023-07-27 19:35:38] [config] mini-batch-words-ref: 0
[2023-07-27 19:35:38] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 19:35:38] [config] multi-loss-type: sum
[2023-07-27 19:35:38] [config] n-best: false
[2023-07-27 19:35:38] [config] no-nccl: false
[2023-07-27 19:35:38] [config] no-reload: false
[2023-07-27 19:35:38] [config] no-restore-corpus: false
[2023-07-27 19:35:38] [config] normalize: 0
[2023-07-27 19:35:38] [config] normalize-gradient: false
[2023-07-27 19:35:38] [config] num-devices: 0
[2023-07-27 19:35:38] [config] optimizer: adam
[2023-07-27 19:35:38] [config] optimizer-delay: 1
[2023-07-27 19:35:38] [config] optimizer-params:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] output-omit-bias: false
[2023-07-27 19:35:38] [config] overwrite: true
[2023-07-27 19:35:38] [config] precision:
[2023-07-27 19:35:38] [config]   - float16
[2023-07-27 19:35:38] [config]   - float32
[2023-07-27 19:35:38] [config] pretrained-model: ""
[2023-07-27 19:35:38] [config] quantize-biases: false
[2023-07-27 19:35:38] [config] quantize-bits: 0
[2023-07-27 19:35:38] [config] quantize-log-based: false
[2023-07-27 19:35:38] [config] quantize-optimization-steps: 0
[2023-07-27 19:35:38] [config] quiet: false
[2023-07-27 19:35:38] [config] quiet-translation: true
[2023-07-27 19:35:38] [config] relative-paths: false
[2023-07-27 19:35:38] [config] right-left: false
[2023-07-27 19:35:38] [config] save-freq: 10000u
[2023-07-27 19:35:38] [config] seed: 1234
[2023-07-27 19:35:38] [config] sentencepiece-alphas:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] sentencepiece-max-lines: 2000000
[2023-07-27 19:35:38] [config] sentencepiece-options: ""
[2023-07-27 19:35:38] [config] sharding: global
[2023-07-27 19:35:38] [config] shuffle: data
[2023-07-27 19:35:38] [config] shuffle-in-ram: false
[2023-07-27 19:35:38] [config] sigterm: save-and-exit
[2023-07-27 19:35:38] [config] skip: false
[2023-07-27 19:35:38] [config] sqlite: ""
[2023-07-27 19:35:38] [config] sqlite-drop: false
[2023-07-27 19:35:38] [config] sync-freq: 200u
[2023-07-27 19:35:38] [config] sync-sgd: false
[2023-07-27 19:35:38] [config] tempdir: /tmp
[2023-07-27 19:35:38] [config] tied-embeddings: false
[2023-07-27 19:35:38] [config] tied-embeddings-all: true
[2023-07-27 19:35:38] [config] tied-embeddings-src: false
[2023-07-27 19:35:38] [config] train-embedder-rank:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] train-sets:
[2023-07-27 19:35:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 19:35:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 19:35:38] [config] transformer-aan-activation: swish
[2023-07-27 19:35:38] [config] transformer-aan-depth: 2
[2023-07-27 19:35:38] [config] transformer-aan-nogate: false
[2023-07-27 19:35:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 19:35:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 19:35:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 19:35:38] [config] transformer-depth-scaling: false
[2023-07-27 19:35:38] [config] transformer-dim-aan: 2048
[2023-07-27 19:35:38] [config] transformer-dim-ffn: 2048
[2023-07-27 19:35:38] [config] transformer-dropout: 0
[2023-07-27 19:35:38] [config] transformer-dropout-attention: 0
[2023-07-27 19:35:38] [config] transformer-dropout-ffn: 0
[2023-07-27 19:35:38] [config] transformer-ffn-activation: swish
[2023-07-27 19:35:38] [config] transformer-ffn-depth: 2
[2023-07-27 19:35:38] [config] transformer-guided-alignment-layer: last
[2023-07-27 19:35:38] [config] transformer-heads: 8
[2023-07-27 19:35:38] [config] transformer-no-projection: false
[2023-07-27 19:35:38] [config] transformer-pool: false
[2023-07-27 19:35:38] [config] transformer-postprocess: dan
[2023-07-27 19:35:38] [config] transformer-postprocess-emb: d
[2023-07-27 19:35:38] [config] transformer-postprocess-top: ""
[2023-07-27 19:35:38] [config] transformer-preprocess: ""
[2023-07-27 19:35:38] [config] transformer-tied-layers:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] transformer-train-position-embeddings: false
[2023-07-27 19:35:38] [config] tsv: false
[2023-07-27 19:35:38] [config] tsv-fields: 0
[2023-07-27 19:35:38] [config] type: s2s
[2023-07-27 19:35:38] [config] ulr: false
[2023-07-27 19:35:38] [config] ulr-dim-emb: 0
[2023-07-27 19:35:38] [config] ulr-dropout: 0
[2023-07-27 19:35:38] [config] ulr-keys-vectors: ""
[2023-07-27 19:35:38] [config] ulr-query-vectors: ""
[2023-07-27 19:35:38] [config] ulr-softmax-temperature: 1
[2023-07-27 19:35:38] [config] ulr-trainable-transformation: false
[2023-07-27 19:35:38] [config] unlikelihood-loss: false
[2023-07-27 19:35:38] [config] valid-freq: 50000000
[2023-07-27 19:35:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 19:35:38] [config] valid-max-length: 1000
[2023-07-27 19:35:38] [config] valid-metrics:
[2023-07-27 19:35:38] [config]   - translation
[2023-07-27 19:35:38] [config] valid-mini-batch: 32
[2023-07-27 19:35:38] [config] valid-reset-stalled: false
[2023-07-27 19:35:38] [config] valid-script-args:
[2023-07-27 19:35:38] [config]   []
[2023-07-27 19:35:38] [config] valid-script-path: ""
[2023-07-27 19:35:38] [config] valid-sets:
[2023-07-27 19:35:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 19:35:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 19:35:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 19:35:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:35:38] [config] vocabs:
[2023-07-27 19:35:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 19:35:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 19:35:38] [config] word-penalty: 0
[2023-07-27 19:35:38] [config] word-scores: false
[2023-07-27 19:35:38] [config] workspace: 5500
[2023-07-27 19:35:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:35:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:35:38] [training] Using single-device training
[2023-07-27 19:35:38] Synced seed 1234
[2023-07-27 19:35:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 19:35:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 19:35:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 19:35:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 19:35:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 19:35:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:35:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 19:35:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 19:35:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 19:35:39] [comm] Using global sharding
[2023-07-27 19:35:39] [comm] NCCLCommunicators constructed successfully
[2023-07-27 19:35:39] [training] Using 1 GPUs
[2023-07-27 19:35:39] [logits] Applying loss function for 1 factor(s)
[2023-07-27 19:35:39] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:35:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 19:35:40] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:37:13] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 19:37:13] [valid] No post-processing script given for validating translator
[2023-07-27 19:37:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:37:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 19:37:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 19:37:13] [comm] Using global sharding
[2023-07-27 19:37:13] [comm] NCCLCommunicators constructed successfully
[2023-07-27 19:37:13] [training] Using 1 GPUs
[2023-07-27 19:37:13] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 19:37:18] Allocating memory for general optimizer shards
[2023-07-27 19:37:18] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 19:37:18] Loading Adam parameters
[2023-07-27 19:37:18] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 19:37:18] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:37:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 19:37:20] [data] Restoring the corpus state to epoch 171, batch 13688
[2023-07-27 19:37:20] [data] Shuffling data
[2023-07-27 19:37:20] [data] Done reading 20,192 sentences
[2023-07-27 19:37:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:37:20] Training started
[2023-07-27 19:37:20] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 19:37:20] [memory] Reserving 332 MB, device gpu0
[2023-07-27 19:37:23] Parameter type float16, optimization type float32, casting types true
[2023-07-27 19:40:23] Seen 20,192 samples
[2023-07-27 19:40:23] Starting data epoch 172 in logical epoch 172
[2023-07-27 19:40:23] [data] Shuffling data
[2023-07-27 19:40:23] [data] Done reading 20,192 sentences
[2023-07-27 19:40:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:43:30] Seen 20,192 samples
[2023-07-27 19:43:30] Starting data epoch 173 in logical epoch 173
[2023-07-27 19:43:30] [data] Shuffling data
[2023-07-27 19:43:30] [data] Done reading 20,192 sentences
[2023-07-27 19:43:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:46:36] Seen 20,192 samples
[2023-07-27 19:46:36] Starting data epoch 174 in logical epoch 174
[2023-07-27 19:46:36] [data] Shuffling data
[2023-07-27 19:46:36] [data] Done reading 20,192 sentences
[2023-07-27 19:46:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:49:22] Ep. 174 : Up. 14000 : Sen. 18,010 : Cost 0.59680760 * 7,044,674 @ 2,290 after 98,622,469 : Time 729.41s : 9658.09 words/s : gNorm 1.7190
[2023-07-27 19:49:42] Seen 20,192 samples
[2023-07-27 19:49:42] Starting data epoch 175 in logical epoch 175
[2023-07-27 19:49:42] [data] Shuffling data
[2023-07-27 19:49:42] [data] Done reading 20,192 sentences
[2023-07-27 19:49:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:52:48] Seen 20,192 samples
[2023-07-27 19:52:48] Starting data epoch 176 in logical epoch 176
[2023-07-27 19:52:48] [data] Shuffling data
[2023-07-27 19:52:48] [data] Done reading 20,192 sentences
[2023-07-27 19:52:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:55:55] Seen 20,192 samples
[2023-07-27 19:55:55] Starting data epoch 177 in logical epoch 177
[2023-07-27 19:55:55] [data] Shuffling data
[2023-07-27 19:55:55] [data] Done reading 20,192 sentences
[2023-07-27 19:55:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:59:01] Seen 20,192 samples
[2023-07-27 19:59:01] Starting data epoch 178 in logical epoch 178
[2023-07-27 19:59:01] [data] Shuffling data
[2023-07-27 19:59:01] [data] Done reading 20,192 sentences
[2023-07-27 19:59:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:02:07] Seen 20,192 samples
[2023-07-27 20:02:07] Starting data epoch 179 in logical epoch 179
[2023-07-27 20:02:07] [data] Shuffling data
[2023-07-27 20:02:07] [data] Done reading 20,192 sentences
[2023-07-27 20:02:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:05:14] Seen 20,192 samples
[2023-07-27 20:05:14] Starting data epoch 180 in logical epoch 180
[2023-07-27 20:05:14] [data] Shuffling data
[2023-07-27 20:05:14] [data] Done reading 20,192 sentences
[2023-07-27 20:05:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:08:22] Seen 20,192 samples
[2023-07-27 20:08:22] Starting data epoch 181 in logical epoch 181
[2023-07-27 20:08:22] Training finished
[2023-07-27 20:09:35] [valid] Ep. 181 : Up. 14491 : translation : 0 : new best
[2023-07-27 20:09:35] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 20:09:42] Saving Adam parameters
[2023-07-27 20:09:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 20:10:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:10:00] [marian] Running on node05.datos.cluster.uy as process 34832 with command line:
[2023-07-27 20:10:00] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 20:10:00] [config] after: 0e
[2023-07-27 20:10:00] [config] after-batches: 0
[2023-07-27 20:10:00] [config] after-epochs: 190
[2023-07-27 20:10:00] [config] all-caps-every: 0
[2023-07-27 20:10:00] [config] allow-unk: false
[2023-07-27 20:10:00] [config] authors: false
[2023-07-27 20:10:00] [config] beam-size: 12
[2023-07-27 20:10:00] [config] bert-class-symbol: "[CLS]"
[2023-07-27 20:10:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 20:10:00] [config] bert-masking-fraction: 0.15
[2023-07-27 20:10:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 20:10:00] [config] bert-train-type-embeddings: true
[2023-07-27 20:10:00] [config] bert-type-vocab-size: 2
[2023-07-27 20:10:00] [config] build-info: ""
[2023-07-27 20:10:00] [config] check-gradient-nan: false
[2023-07-27 20:10:00] [config] check-nan: false
[2023-07-27 20:10:00] [config] cite: false
[2023-07-27 20:10:00] [config] clip-norm: 1
[2023-07-27 20:10:00] [config] cost-scaling:
[2023-07-27 20:10:00] [config]   - 256.f
[2023-07-27 20:10:00] [config]   - 1000
[2023-07-27 20:10:00] [config]   - 2.f
[2023-07-27 20:10:00] [config]   - 256.f
[2023-07-27 20:10:00] [config] cost-type: ce-sum
[2023-07-27 20:10:00] [config] cpu-threads: 0
[2023-07-27 20:10:00] [config] data-threads: 8
[2023-07-27 20:10:00] [config] data-weighting: ""
[2023-07-27 20:10:00] [config] data-weighting-type: sentence
[2023-07-27 20:10:00] [config] dec-cell: gru
[2023-07-27 20:10:00] [config] dec-cell-base-depth: 2
[2023-07-27 20:10:00] [config] dec-cell-high-depth: 1
[2023-07-27 20:10:00] [config] dec-depth: 8
[2023-07-27 20:10:00] [config] devices:
[2023-07-27 20:10:00] [config]   - 0
[2023-07-27 20:10:00] [config] dim-emb: 512
[2023-07-27 20:10:00] [config] dim-rnn: 1024
[2023-07-27 20:10:00] [config] dim-vocabs:
[2023-07-27 20:10:00] [config]   - 16384
[2023-07-27 20:10:00] [config]   - 16384
[2023-07-27 20:10:00] [config] disp-first: 0
[2023-07-27 20:10:00] [config] disp-freq: 1000u
[2023-07-27 20:10:00] [config] disp-label-counts: true
[2023-07-27 20:10:00] [config] dropout-rnn: 0
[2023-07-27 20:10:00] [config] dropout-src: 0
[2023-07-27 20:10:00] [config] dropout-trg: 0
[2023-07-27 20:10:00] [config] dump-config: ""
[2023-07-27 20:10:00] [config] dynamic-gradient-scaling:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] early-stopping: 1000
[2023-07-27 20:10:00] [config] early-stopping-on: first
[2023-07-27 20:10:00] [config] embedding-fix-src: false
[2023-07-27 20:10:00] [config] embedding-fix-trg: false
[2023-07-27 20:10:00] [config] embedding-normalization: false
[2023-07-27 20:10:00] [config] embedding-vectors:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] enc-cell: gru
[2023-07-27 20:10:00] [config] enc-cell-depth: 1
[2023-07-27 20:10:00] [config] enc-depth: 8
[2023-07-27 20:10:00] [config] enc-type: bidirectional
[2023-07-27 20:10:00] [config] english-title-case-every: 0
[2023-07-27 20:10:00] [config] exponential-smoothing: 0
[2023-07-27 20:10:00] [config] factor-weight: 1
[2023-07-27 20:10:00] [config] factors-combine: sum
[2023-07-27 20:10:00] [config] factors-dim-emb: 0
[2023-07-27 20:10:00] [config] gradient-checkpointing: false
[2023-07-27 20:10:00] [config] gradient-norm-average-window: 100
[2023-07-27 20:10:00] [config] guided-alignment: none
[2023-07-27 20:10:00] [config] guided-alignment-cost: mse
[2023-07-27 20:10:00] [config] guided-alignment-weight: 0.1
[2023-07-27 20:10:00] [config] ignore-model-config: false
[2023-07-27 20:10:00] [config] input-types:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] interpolate-env-vars: false
[2023-07-27 20:10:00] [config] keep-best: false
[2023-07-27 20:10:00] [config] label-smoothing: 0
[2023-07-27 20:10:00] [config] layer-normalization: false
[2023-07-27 20:10:00] [config] learn-rate: 0.0001
[2023-07-27 20:10:00] [config] lemma-dependency: ""
[2023-07-27 20:10:00] [config] lemma-dim-emb: 0
[2023-07-27 20:10:00] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 20:10:00] [config] log-level: info
[2023-07-27 20:10:00] [config] log-time-zone: ""
[2023-07-27 20:10:00] [config] logical-epoch:
[2023-07-27 20:10:00] [config]   - 1e
[2023-07-27 20:10:00] [config]   - 0
[2023-07-27 20:10:00] [config] lr-decay: 0
[2023-07-27 20:10:00] [config] lr-decay-freq: 50000
[2023-07-27 20:10:00] [config] lr-decay-inv-sqrt:
[2023-07-27 20:10:00] [config]   - 0
[2023-07-27 20:10:00] [config] lr-decay-repeat-warmup: false
[2023-07-27 20:10:00] [config] lr-decay-reset-optimizer: false
[2023-07-27 20:10:00] [config] lr-decay-start:
[2023-07-27 20:10:00] [config]   - 10
[2023-07-27 20:10:00] [config]   - 1
[2023-07-27 20:10:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 20:10:00] [config] lr-report: false
[2023-07-27 20:10:00] [config] lr-warmup: 0
[2023-07-27 20:10:00] [config] lr-warmup-at-reload: false
[2023-07-27 20:10:00] [config] lr-warmup-cycle: false
[2023-07-27 20:10:00] [config] lr-warmup-start-rate: 0
[2023-07-27 20:10:00] [config] max-length: 50
[2023-07-27 20:10:00] [config] max-length-crop: true
[2023-07-27 20:10:00] [config] max-length-factor: 3
[2023-07-27 20:10:00] [config] maxi-batch: 100
[2023-07-27 20:10:00] [config] maxi-batch-sort: trg
[2023-07-27 20:10:00] [config] mini-batch: 64
[2023-07-27 20:10:00] [config] mini-batch-fit: true
[2023-07-27 20:10:00] [config] mini-batch-fit-step: 10
[2023-07-27 20:10:00] [config] mini-batch-round-up: true
[2023-07-27 20:10:00] [config] mini-batch-track-lr: false
[2023-07-27 20:10:00] [config] mini-batch-warmup: 0
[2023-07-27 20:10:00] [config] mini-batch-words: 0
[2023-07-27 20:10:00] [config] mini-batch-words-ref: 0
[2023-07-27 20:10:00] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 20:10:00] [config] multi-loss-type: sum
[2023-07-27 20:10:00] [config] n-best: false
[2023-07-27 20:10:00] [config] no-nccl: false
[2023-07-27 20:10:00] [config] no-reload: false
[2023-07-27 20:10:00] [config] no-restore-corpus: false
[2023-07-27 20:10:00] [config] normalize: 0
[2023-07-27 20:10:00] [config] normalize-gradient: false
[2023-07-27 20:10:00] [config] num-devices: 0
[2023-07-27 20:10:00] [config] optimizer: adam
[2023-07-27 20:10:00] [config] optimizer-delay: 1
[2023-07-27 20:10:00] [config] optimizer-params:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] output-omit-bias: false
[2023-07-27 20:10:00] [config] overwrite: true
[2023-07-27 20:10:00] [config] precision:
[2023-07-27 20:10:00] [config]   - float16
[2023-07-27 20:10:00] [config]   - float32
[2023-07-27 20:10:00] [config] pretrained-model: ""
[2023-07-27 20:10:00] [config] quantize-biases: false
[2023-07-27 20:10:00] [config] quantize-bits: 0
[2023-07-27 20:10:00] [config] quantize-log-based: false
[2023-07-27 20:10:00] [config] quantize-optimization-steps: 0
[2023-07-27 20:10:00] [config] quiet: false
[2023-07-27 20:10:00] [config] quiet-translation: true
[2023-07-27 20:10:00] [config] relative-paths: false
[2023-07-27 20:10:00] [config] right-left: false
[2023-07-27 20:10:00] [config] save-freq: 10000u
[2023-07-27 20:10:00] [config] seed: 1234
[2023-07-27 20:10:00] [config] sentencepiece-alphas:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] sentencepiece-max-lines: 2000000
[2023-07-27 20:10:00] [config] sentencepiece-options: ""
[2023-07-27 20:10:00] [config] sharding: global
[2023-07-27 20:10:00] [config] shuffle: data
[2023-07-27 20:10:00] [config] shuffle-in-ram: false
[2023-07-27 20:10:00] [config] sigterm: save-and-exit
[2023-07-27 20:10:00] [config] skip: false
[2023-07-27 20:10:00] [config] sqlite: ""
[2023-07-27 20:10:00] [config] sqlite-drop: false
[2023-07-27 20:10:00] [config] sync-freq: 200u
[2023-07-27 20:10:00] [config] sync-sgd: false
[2023-07-27 20:10:00] [config] tempdir: /tmp
[2023-07-27 20:10:00] [config] tied-embeddings: false
[2023-07-27 20:10:00] [config] tied-embeddings-all: true
[2023-07-27 20:10:00] [config] tied-embeddings-src: false
[2023-07-27 20:10:00] [config] train-embedder-rank:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] train-sets:
[2023-07-27 20:10:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 20:10:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 20:10:00] [config] transformer-aan-activation: swish
[2023-07-27 20:10:00] [config] transformer-aan-depth: 2
[2023-07-27 20:10:00] [config] transformer-aan-nogate: false
[2023-07-27 20:10:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 20:10:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 20:10:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 20:10:00] [config] transformer-depth-scaling: false
[2023-07-27 20:10:00] [config] transformer-dim-aan: 2048
[2023-07-27 20:10:00] [config] transformer-dim-ffn: 2048
[2023-07-27 20:10:00] [config] transformer-dropout: 0
[2023-07-27 20:10:00] [config] transformer-dropout-attention: 0
[2023-07-27 20:10:00] [config] transformer-dropout-ffn: 0
[2023-07-27 20:10:00] [config] transformer-ffn-activation: swish
[2023-07-27 20:10:00] [config] transformer-ffn-depth: 2
[2023-07-27 20:10:00] [config] transformer-guided-alignment-layer: last
[2023-07-27 20:10:00] [config] transformer-heads: 8
[2023-07-27 20:10:00] [config] transformer-no-projection: false
[2023-07-27 20:10:00] [config] transformer-pool: false
[2023-07-27 20:10:00] [config] transformer-postprocess: dan
[2023-07-27 20:10:00] [config] transformer-postprocess-emb: d
[2023-07-27 20:10:00] [config] transformer-postprocess-top: ""
[2023-07-27 20:10:00] [config] transformer-preprocess: ""
[2023-07-27 20:10:00] [config] transformer-tied-layers:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] transformer-train-position-embeddings: false
[2023-07-27 20:10:00] [config] tsv: false
[2023-07-27 20:10:00] [config] tsv-fields: 0
[2023-07-27 20:10:00] [config] type: s2s
[2023-07-27 20:10:00] [config] ulr: false
[2023-07-27 20:10:00] [config] ulr-dim-emb: 0
[2023-07-27 20:10:00] [config] ulr-dropout: 0
[2023-07-27 20:10:00] [config] ulr-keys-vectors: ""
[2023-07-27 20:10:00] [config] ulr-query-vectors: ""
[2023-07-27 20:10:00] [config] ulr-softmax-temperature: 1
[2023-07-27 20:10:00] [config] ulr-trainable-transformation: false
[2023-07-27 20:10:00] [config] unlikelihood-loss: false
[2023-07-27 20:10:00] [config] valid-freq: 50000000
[2023-07-27 20:10:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 20:10:00] [config] valid-max-length: 1000
[2023-07-27 20:10:00] [config] valid-metrics:
[2023-07-27 20:10:00] [config]   - translation
[2023-07-27 20:10:00] [config] valid-mini-batch: 32
[2023-07-27 20:10:00] [config] valid-reset-stalled: false
[2023-07-27 20:10:00] [config] valid-script-args:
[2023-07-27 20:10:00] [config]   []
[2023-07-27 20:10:00] [config] valid-script-path: ""
[2023-07-27 20:10:00] [config] valid-sets:
[2023-07-27 20:10:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 20:10:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 20:10:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 20:10:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:10:00] [config] vocabs:
[2023-07-27 20:10:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 20:10:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 20:10:00] [config] word-penalty: 0
[2023-07-27 20:10:00] [config] word-scores: false
[2023-07-27 20:10:00] [config] workspace: 5500
[2023-07-27 20:10:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:10:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:10:00] [training] Using single-device training
[2023-07-27 20:10:00] Synced seed 1234
[2023-07-27 20:10:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 20:10:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 20:10:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 20:10:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 20:10:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 20:10:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:10:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 20:10:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 20:10:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 20:10:01] [comm] Using global sharding
[2023-07-27 20:10:01] [comm] NCCLCommunicators constructed successfully
[2023-07-27 20:10:01] [training] Using 1 GPUs
[2023-07-27 20:10:01] [logits] Applying loss function for 1 factor(s)
[2023-07-27 20:10:01] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:10:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 20:10:02] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:11:34] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 20:11:34] [valid] No post-processing script given for validating translator
[2023-07-27 20:11:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:11:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 20:11:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 20:11:34] [comm] Using global sharding
[2023-07-27 20:11:34] [comm] NCCLCommunicators constructed successfully
[2023-07-27 20:11:34] [training] Using 1 GPUs
[2023-07-27 20:11:34] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 20:11:39] Allocating memory for general optimizer shards
[2023-07-27 20:11:39] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 20:11:39] Loading Adam parameters
[2023-07-27 20:11:40] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 20:11:40] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:11:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 20:11:41] [data] Restoring the corpus state to epoch 181, batch 14491
[2023-07-27 20:11:41] [data] Shuffling data
[2023-07-27 20:11:41] [data] Done reading 20,192 sentences
[2023-07-27 20:11:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:11:41] Training started
[2023-07-27 20:11:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 20:11:42] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:11:44] Parameter type float16, optimization type float32, casting types true
[2023-07-27 20:14:45] Seen 20,192 samples
[2023-07-27 20:14:45] Starting data epoch 182 in logical epoch 182
[2023-07-27 20:14:45] [data] Shuffling data
[2023-07-27 20:14:45] [data] Done reading 20,192 sentences
[2023-07-27 20:14:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:17:53] Seen 20,192 samples
[2023-07-27 20:17:53] Starting data epoch 183 in logical epoch 183
[2023-07-27 20:17:53] [data] Shuffling data
[2023-07-27 20:17:53] [data] Done reading 20,192 sentences
[2023-07-27 20:17:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:21:01] Seen 20,192 samples
[2023-07-27 20:21:01] Starting data epoch 184 in logical epoch 184
[2023-07-27 20:21:01] [data] Shuffling data
[2023-07-27 20:21:01] [data] Done reading 20,192 sentences
[2023-07-27 20:21:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:24:07] Seen 20,192 samples
[2023-07-27 20:24:07] Starting data epoch 185 in logical epoch 185
[2023-07-27 20:24:07] [data] Shuffling data
[2023-07-27 20:24:07] [data] Done reading 20,192 sentences
[2023-07-27 20:24:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:27:14] Seen 20,192 samples
[2023-07-27 20:27:14] Starting data epoch 186 in logical epoch 186
[2023-07-27 20:27:14] [data] Shuffling data
[2023-07-27 20:27:14] [data] Done reading 20,192 sentences
[2023-07-27 20:27:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:30:20] Seen 20,192 samples
[2023-07-27 20:30:20] Starting data epoch 187 in logical epoch 187
[2023-07-27 20:30:20] [data] Shuffling data
[2023-07-27 20:30:20] [data] Done reading 20,192 sentences
[2023-07-27 20:30:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:31:20] Ep. 187 : Up. 15000 : Sen. 6,400 : Cost 0.41155094 * 7,039,496 @ 9,353 after 105,661,965 : Time 1185.88s : 5936.10 words/s : gNorm 1.4868
[2023-07-27 20:33:26] Seen 20,192 samples
[2023-07-27 20:33:26] Starting data epoch 188 in logical epoch 188
[2023-07-27 20:33:26] [data] Shuffling data
[2023-07-27 20:33:26] [data] Done reading 20,192 sentences
[2023-07-27 20:33:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:36:33] Seen 20,192 samples
[2023-07-27 20:36:33] Starting data epoch 189 in logical epoch 189
[2023-07-27 20:36:33] [data] Shuffling data
[2023-07-27 20:36:33] [data] Done reading 20,192 sentences
[2023-07-27 20:36:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:39:40] Seen 20,192 samples
[2023-07-27 20:39:40] Starting data epoch 190 in logical epoch 190
[2023-07-27 20:39:40] [data] Shuffling data
[2023-07-27 20:39:40] [data] Done reading 20,192 sentences
[2023-07-27 20:39:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:42:46] Seen 20,192 samples
[2023-07-27 20:42:46] Starting data epoch 191 in logical epoch 191
[2023-07-27 20:42:46] Training finished
[2023-07-27 20:44:02] [valid] Ep. 191 : Up. 15299 : translation : 0 : new best
[2023-07-27 20:44:02] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 20:44:08] Saving Adam parameters
[2023-07-27 20:44:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 20:44:33] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:44:33] [marian] Running on node05.datos.cluster.uy as process 37016 with command line:
[2023-07-27 20:44:33] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 20:44:33] [config] after: 0e
[2023-07-27 20:44:33] [config] after-batches: 0
[2023-07-27 20:44:33] [config] after-epochs: 200
[2023-07-27 20:44:33] [config] all-caps-every: 0
[2023-07-27 20:44:33] [config] allow-unk: false
[2023-07-27 20:44:33] [config] authors: false
[2023-07-27 20:44:33] [config] beam-size: 12
[2023-07-27 20:44:33] [config] bert-class-symbol: "[CLS]"
[2023-07-27 20:44:33] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 20:44:33] [config] bert-masking-fraction: 0.15
[2023-07-27 20:44:33] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 20:44:33] [config] bert-train-type-embeddings: true
[2023-07-27 20:44:33] [config] bert-type-vocab-size: 2
[2023-07-27 20:44:33] [config] build-info: ""
[2023-07-27 20:44:33] [config] check-gradient-nan: false
[2023-07-27 20:44:33] [config] check-nan: false
[2023-07-27 20:44:33] [config] cite: false
[2023-07-27 20:44:33] [config] clip-norm: 1
[2023-07-27 20:44:33] [config] cost-scaling:
[2023-07-27 20:44:33] [config]   - 256.f
[2023-07-27 20:44:33] [config]   - 1000
[2023-07-27 20:44:33] [config]   - 2.f
[2023-07-27 20:44:33] [config]   - 256.f
[2023-07-27 20:44:33] [config] cost-type: ce-sum
[2023-07-27 20:44:33] [config] cpu-threads: 0
[2023-07-27 20:44:33] [config] data-threads: 8
[2023-07-27 20:44:33] [config] data-weighting: ""
[2023-07-27 20:44:33] [config] data-weighting-type: sentence
[2023-07-27 20:44:33] [config] dec-cell: gru
[2023-07-27 20:44:33] [config] dec-cell-base-depth: 2
[2023-07-27 20:44:33] [config] dec-cell-high-depth: 1
[2023-07-27 20:44:33] [config] dec-depth: 8
[2023-07-27 20:44:33] [config] devices:
[2023-07-27 20:44:33] [config]   - 0
[2023-07-27 20:44:33] [config] dim-emb: 512
[2023-07-27 20:44:33] [config] dim-rnn: 1024
[2023-07-27 20:44:33] [config] dim-vocabs:
[2023-07-27 20:44:33] [config]   - 16384
[2023-07-27 20:44:33] [config]   - 16384
[2023-07-27 20:44:33] [config] disp-first: 0
[2023-07-27 20:44:33] [config] disp-freq: 1000u
[2023-07-27 20:44:33] [config] disp-label-counts: true
[2023-07-27 20:44:33] [config] dropout-rnn: 0
[2023-07-27 20:44:33] [config] dropout-src: 0
[2023-07-27 20:44:33] [config] dropout-trg: 0
[2023-07-27 20:44:33] [config] dump-config: ""
[2023-07-27 20:44:33] [config] dynamic-gradient-scaling:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] early-stopping: 1000
[2023-07-27 20:44:33] [config] early-stopping-on: first
[2023-07-27 20:44:33] [config] embedding-fix-src: false
[2023-07-27 20:44:33] [config] embedding-fix-trg: false
[2023-07-27 20:44:33] [config] embedding-normalization: false
[2023-07-27 20:44:33] [config] embedding-vectors:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] enc-cell: gru
[2023-07-27 20:44:33] [config] enc-cell-depth: 1
[2023-07-27 20:44:33] [config] enc-depth: 8
[2023-07-27 20:44:33] [config] enc-type: bidirectional
[2023-07-27 20:44:33] [config] english-title-case-every: 0
[2023-07-27 20:44:33] [config] exponential-smoothing: 0
[2023-07-27 20:44:33] [config] factor-weight: 1
[2023-07-27 20:44:33] [config] factors-combine: sum
[2023-07-27 20:44:33] [config] factors-dim-emb: 0
[2023-07-27 20:44:33] [config] gradient-checkpointing: false
[2023-07-27 20:44:33] [config] gradient-norm-average-window: 100
[2023-07-27 20:44:33] [config] guided-alignment: none
[2023-07-27 20:44:33] [config] guided-alignment-cost: mse
[2023-07-27 20:44:33] [config] guided-alignment-weight: 0.1
[2023-07-27 20:44:33] [config] ignore-model-config: false
[2023-07-27 20:44:33] [config] input-types:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] interpolate-env-vars: false
[2023-07-27 20:44:33] [config] keep-best: false
[2023-07-27 20:44:33] [config] label-smoothing: 0
[2023-07-27 20:44:33] [config] layer-normalization: false
[2023-07-27 20:44:33] [config] learn-rate: 0.0001
[2023-07-27 20:44:33] [config] lemma-dependency: ""
[2023-07-27 20:44:33] [config] lemma-dim-emb: 0
[2023-07-27 20:44:33] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 20:44:33] [config] log-level: info
[2023-07-27 20:44:33] [config] log-time-zone: ""
[2023-07-27 20:44:33] [config] logical-epoch:
[2023-07-27 20:44:33] [config]   - 1e
[2023-07-27 20:44:33] [config]   - 0
[2023-07-27 20:44:33] [config] lr-decay: 0
[2023-07-27 20:44:33] [config] lr-decay-freq: 50000
[2023-07-27 20:44:33] [config] lr-decay-inv-sqrt:
[2023-07-27 20:44:33] [config]   - 0
[2023-07-27 20:44:33] [config] lr-decay-repeat-warmup: false
[2023-07-27 20:44:33] [config] lr-decay-reset-optimizer: false
[2023-07-27 20:44:33] [config] lr-decay-start:
[2023-07-27 20:44:33] [config]   - 10
[2023-07-27 20:44:33] [config]   - 1
[2023-07-27 20:44:33] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 20:44:33] [config] lr-report: false
[2023-07-27 20:44:33] [config] lr-warmup: 0
[2023-07-27 20:44:33] [config] lr-warmup-at-reload: false
[2023-07-27 20:44:33] [config] lr-warmup-cycle: false
[2023-07-27 20:44:33] [config] lr-warmup-start-rate: 0
[2023-07-27 20:44:33] [config] max-length: 50
[2023-07-27 20:44:33] [config] max-length-crop: true
[2023-07-27 20:44:33] [config] max-length-factor: 3
[2023-07-27 20:44:33] [config] maxi-batch: 100
[2023-07-27 20:44:33] [config] maxi-batch-sort: trg
[2023-07-27 20:44:33] [config] mini-batch: 64
[2023-07-27 20:44:33] [config] mini-batch-fit: true
[2023-07-27 20:44:33] [config] mini-batch-fit-step: 10
[2023-07-27 20:44:33] [config] mini-batch-round-up: true
[2023-07-27 20:44:33] [config] mini-batch-track-lr: false
[2023-07-27 20:44:33] [config] mini-batch-warmup: 0
[2023-07-27 20:44:33] [config] mini-batch-words: 0
[2023-07-27 20:44:33] [config] mini-batch-words-ref: 0
[2023-07-27 20:44:33] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 20:44:33] [config] multi-loss-type: sum
[2023-07-27 20:44:33] [config] n-best: false
[2023-07-27 20:44:33] [config] no-nccl: false
[2023-07-27 20:44:33] [config] no-reload: false
[2023-07-27 20:44:33] [config] no-restore-corpus: false
[2023-07-27 20:44:33] [config] normalize: 0
[2023-07-27 20:44:33] [config] normalize-gradient: false
[2023-07-27 20:44:33] [config] num-devices: 0
[2023-07-27 20:44:33] [config] optimizer: adam
[2023-07-27 20:44:33] [config] optimizer-delay: 1
[2023-07-27 20:44:33] [config] optimizer-params:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] output-omit-bias: false
[2023-07-27 20:44:33] [config] overwrite: true
[2023-07-27 20:44:33] [config] precision:
[2023-07-27 20:44:33] [config]   - float16
[2023-07-27 20:44:33] [config]   - float32
[2023-07-27 20:44:33] [config] pretrained-model: ""
[2023-07-27 20:44:33] [config] quantize-biases: false
[2023-07-27 20:44:33] [config] quantize-bits: 0
[2023-07-27 20:44:33] [config] quantize-log-based: false
[2023-07-27 20:44:33] [config] quantize-optimization-steps: 0
[2023-07-27 20:44:33] [config] quiet: false
[2023-07-27 20:44:33] [config] quiet-translation: true
[2023-07-27 20:44:33] [config] relative-paths: false
[2023-07-27 20:44:33] [config] right-left: false
[2023-07-27 20:44:33] [config] save-freq: 10000u
[2023-07-27 20:44:33] [config] seed: 1234
[2023-07-27 20:44:33] [config] sentencepiece-alphas:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] sentencepiece-max-lines: 2000000
[2023-07-27 20:44:33] [config] sentencepiece-options: ""
[2023-07-27 20:44:33] [config] sharding: global
[2023-07-27 20:44:33] [config] shuffle: data
[2023-07-27 20:44:33] [config] shuffle-in-ram: false
[2023-07-27 20:44:33] [config] sigterm: save-and-exit
[2023-07-27 20:44:33] [config] skip: false
[2023-07-27 20:44:33] [config] sqlite: ""
[2023-07-27 20:44:33] [config] sqlite-drop: false
[2023-07-27 20:44:33] [config] sync-freq: 200u
[2023-07-27 20:44:33] [config] sync-sgd: false
[2023-07-27 20:44:33] [config] tempdir: /tmp
[2023-07-27 20:44:33] [config] tied-embeddings: false
[2023-07-27 20:44:33] [config] tied-embeddings-all: true
[2023-07-27 20:44:33] [config] tied-embeddings-src: false
[2023-07-27 20:44:33] [config] train-embedder-rank:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] train-sets:
[2023-07-27 20:44:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 20:44:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 20:44:33] [config] transformer-aan-activation: swish
[2023-07-27 20:44:33] [config] transformer-aan-depth: 2
[2023-07-27 20:44:33] [config] transformer-aan-nogate: false
[2023-07-27 20:44:33] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 20:44:33] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 20:44:33] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 20:44:33] [config] transformer-depth-scaling: false
[2023-07-27 20:44:33] [config] transformer-dim-aan: 2048
[2023-07-27 20:44:33] [config] transformer-dim-ffn: 2048
[2023-07-27 20:44:33] [config] transformer-dropout: 0
[2023-07-27 20:44:33] [config] transformer-dropout-attention: 0
[2023-07-27 20:44:33] [config] transformer-dropout-ffn: 0
[2023-07-27 20:44:33] [config] transformer-ffn-activation: swish
[2023-07-27 20:44:33] [config] transformer-ffn-depth: 2
[2023-07-27 20:44:33] [config] transformer-guided-alignment-layer: last
[2023-07-27 20:44:33] [config] transformer-heads: 8
[2023-07-27 20:44:33] [config] transformer-no-projection: false
[2023-07-27 20:44:33] [config] transformer-pool: false
[2023-07-27 20:44:33] [config] transformer-postprocess: dan
[2023-07-27 20:44:33] [config] transformer-postprocess-emb: d
[2023-07-27 20:44:33] [config] transformer-postprocess-top: ""
[2023-07-27 20:44:33] [config] transformer-preprocess: ""
[2023-07-27 20:44:33] [config] transformer-tied-layers:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] transformer-train-position-embeddings: false
[2023-07-27 20:44:33] [config] tsv: false
[2023-07-27 20:44:33] [config] tsv-fields: 0
[2023-07-27 20:44:33] [config] type: s2s
[2023-07-27 20:44:33] [config] ulr: false
[2023-07-27 20:44:33] [config] ulr-dim-emb: 0
[2023-07-27 20:44:33] [config] ulr-dropout: 0
[2023-07-27 20:44:33] [config] ulr-keys-vectors: ""
[2023-07-27 20:44:33] [config] ulr-query-vectors: ""
[2023-07-27 20:44:33] [config] ulr-softmax-temperature: 1
[2023-07-27 20:44:33] [config] ulr-trainable-transformation: false
[2023-07-27 20:44:33] [config] unlikelihood-loss: false
[2023-07-27 20:44:33] [config] valid-freq: 50000000
[2023-07-27 20:44:33] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 20:44:33] [config] valid-max-length: 1000
[2023-07-27 20:44:33] [config] valid-metrics:
[2023-07-27 20:44:33] [config]   - translation
[2023-07-27 20:44:33] [config] valid-mini-batch: 32
[2023-07-27 20:44:33] [config] valid-reset-stalled: false
[2023-07-27 20:44:33] [config] valid-script-args:
[2023-07-27 20:44:33] [config]   []
[2023-07-27 20:44:33] [config] valid-script-path: ""
[2023-07-27 20:44:33] [config] valid-sets:
[2023-07-27 20:44:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 20:44:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 20:44:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 20:44:33] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:44:33] [config] vocabs:
[2023-07-27 20:44:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 20:44:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 20:44:33] [config] word-penalty: 0
[2023-07-27 20:44:33] [config] word-scores: false
[2023-07-27 20:44:33] [config] workspace: 5500
[2023-07-27 20:44:33] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:44:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:44:33] [training] Using single-device training
[2023-07-27 20:44:33] Synced seed 1234
[2023-07-27 20:44:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 20:44:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 20:44:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 20:44:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 20:44:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 20:44:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:44:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 20:44:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 20:44:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 20:44:34] [comm] Using global sharding
[2023-07-27 20:44:34] [comm] NCCLCommunicators constructed successfully
[2023-07-27 20:44:34] [training] Using 1 GPUs
[2023-07-27 20:44:34] [logits] Applying loss function for 1 factor(s)
[2023-07-27 20:44:34] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:44:35] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 20:44:35] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:46:07] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 20:46:07] [valid] No post-processing script given for validating translator
[2023-07-27 20:46:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:46:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 20:46:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 20:46:07] [comm] Using global sharding
[2023-07-27 20:46:07] [comm] NCCLCommunicators constructed successfully
[2023-07-27 20:46:07] [training] Using 1 GPUs
[2023-07-27 20:46:07] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 20:46:11] Allocating memory for general optimizer shards
[2023-07-27 20:46:11] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 20:46:12] Loading Adam parameters
[2023-07-27 20:46:12] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 20:46:12] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:46:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 20:46:14] [data] Restoring the corpus state to epoch 191, batch 15299
[2023-07-27 20:46:14] [data] Shuffling data
[2023-07-27 20:46:14] [data] Done reading 20,192 sentences
[2023-07-27 20:46:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:46:14] Training started
[2023-07-27 20:46:14] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 20:46:14] [memory] Reserving 332 MB, device gpu0
[2023-07-27 20:46:17] Parameter type float16, optimization type float32, casting types true
[2023-07-27 20:49:17] Seen 20,192 samples
[2023-07-27 20:49:17] Starting data epoch 192 in logical epoch 192
[2023-07-27 20:49:17] [data] Shuffling data
[2023-07-27 20:49:17] [data] Done reading 20,192 sentences
[2023-07-27 20:49:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:52:22] Seen 20,192 samples
[2023-07-27 20:52:22] Starting data epoch 193 in logical epoch 193
[2023-07-27 20:52:22] [data] Shuffling data
[2023-07-27 20:52:22] [data] Done reading 20,192 sentences
[2023-07-27 20:52:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:55:28] Seen 20,192 samples
[2023-07-27 20:55:28] Starting data epoch 194 in logical epoch 194
[2023-07-27 20:55:28] [data] Shuffling data
[2023-07-27 20:55:28] [data] Done reading 20,192 sentences
[2023-07-27 20:55:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:58:34] Seen 20,192 samples
[2023-07-27 20:58:34] Starting data epoch 195 in logical epoch 195
[2023-07-27 20:58:34] [data] Shuffling data
[2023-07-27 20:58:34] [data] Done reading 20,192 sentences
[2023-07-27 20:58:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:01:40] Seen 20,192 samples
[2023-07-27 21:01:40] Starting data epoch 196 in logical epoch 196
[2023-07-27 21:01:40] [data] Shuffling data
[2023-07-27 21:01:40] [data] Done reading 20,192 sentences
[2023-07-27 21:01:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:04:46] Seen 20,192 samples
[2023-07-27 21:04:46] Starting data epoch 197 in logical epoch 197
[2023-07-27 21:04:46] [data] Shuffling data
[2023-07-27 21:04:46] [data] Done reading 20,192 sentences
[2023-07-27 21:04:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:07:51] Seen 20,192 samples
[2023-07-27 21:07:51] Starting data epoch 198 in logical epoch 198
[2023-07-27 21:07:51] [data] Shuffling data
[2023-07-27 21:07:51] [data] Done reading 20,192 sentences
[2023-07-27 21:07:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:10:57] Seen 20,192 samples
[2023-07-27 21:10:57] Starting data epoch 199 in logical epoch 199
[2023-07-27 21:10:57] [data] Shuffling data
[2023-07-27 21:10:57] [data] Done reading 20,192 sentences
[2023-07-27 21:10:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:13:09] Ep. 199 : Up. 16000 : Sen. 14,207 : Cost 0.29381457 * 7,027,960 @ 10,433 after 112,689,925 : Time 1622.13s : 4332.54 words/s : gNorm 1.3150
[2023-07-27 21:14:03] Seen 20,192 samples
[2023-07-27 21:14:03] Starting data epoch 200 in logical epoch 200
[2023-07-27 21:14:03] [data] Shuffling data
[2023-07-27 21:14:03] [data] Done reading 20,192 sentences
[2023-07-27 21:14:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:17:09] Seen 20,192 samples
[2023-07-27 21:17:09] Starting data epoch 201 in logical epoch 201
[2023-07-27 21:17:09] Training finished
[2023-07-27 21:18:23] [valid] Ep. 201 : Up. 16102 : translation : 0 : new best
[2023-07-27 21:18:23] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 21:18:34] Saving Adam parameters
[2023-07-27 21:18:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 21:18:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 21:18:59] [marian] Running on node05.datos.cluster.uy as process 39250 with command line:
[2023-07-27 21:18:59] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 210 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 21:18:59] [config] after: 0e
[2023-07-27 21:18:59] [config] after-batches: 0
[2023-07-27 21:18:59] [config] after-epochs: 210
[2023-07-27 21:18:59] [config] all-caps-every: 0
[2023-07-27 21:18:59] [config] allow-unk: false
[2023-07-27 21:18:59] [config] authors: false
[2023-07-27 21:18:59] [config] beam-size: 12
[2023-07-27 21:18:59] [config] bert-class-symbol: "[CLS]"
[2023-07-27 21:18:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 21:18:59] [config] bert-masking-fraction: 0.15
[2023-07-27 21:18:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 21:18:59] [config] bert-train-type-embeddings: true
[2023-07-27 21:18:59] [config] bert-type-vocab-size: 2
[2023-07-27 21:18:59] [config] build-info: ""
[2023-07-27 21:18:59] [config] check-gradient-nan: false
[2023-07-27 21:18:59] [config] check-nan: false
[2023-07-27 21:18:59] [config] cite: false
[2023-07-27 21:18:59] [config] clip-norm: 1
[2023-07-27 21:18:59] [config] cost-scaling:
[2023-07-27 21:18:59] [config]   - 256.f
[2023-07-27 21:18:59] [config]   - 1000
[2023-07-27 21:18:59] [config]   - 2.f
[2023-07-27 21:18:59] [config]   - 256.f
[2023-07-27 21:18:59] [config] cost-type: ce-sum
[2023-07-27 21:18:59] [config] cpu-threads: 0
[2023-07-27 21:18:59] [config] data-threads: 8
[2023-07-27 21:18:59] [config] data-weighting: ""
[2023-07-27 21:18:59] [config] data-weighting-type: sentence
[2023-07-27 21:18:59] [config] dec-cell: gru
[2023-07-27 21:18:59] [config] dec-cell-base-depth: 2
[2023-07-27 21:18:59] [config] dec-cell-high-depth: 1
[2023-07-27 21:18:59] [config] dec-depth: 8
[2023-07-27 21:18:59] [config] devices:
[2023-07-27 21:18:59] [config]   - 0
[2023-07-27 21:18:59] [config] dim-emb: 512
[2023-07-27 21:18:59] [config] dim-rnn: 1024
[2023-07-27 21:18:59] [config] dim-vocabs:
[2023-07-27 21:18:59] [config]   - 16384
[2023-07-27 21:18:59] [config]   - 16384
[2023-07-27 21:18:59] [config] disp-first: 0
[2023-07-27 21:18:59] [config] disp-freq: 1000u
[2023-07-27 21:18:59] [config] disp-label-counts: true
[2023-07-27 21:18:59] [config] dropout-rnn: 0
[2023-07-27 21:18:59] [config] dropout-src: 0
[2023-07-27 21:18:59] [config] dropout-trg: 0
[2023-07-27 21:18:59] [config] dump-config: ""
[2023-07-27 21:18:59] [config] dynamic-gradient-scaling:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] early-stopping: 1000
[2023-07-27 21:18:59] [config] early-stopping-on: first
[2023-07-27 21:18:59] [config] embedding-fix-src: false
[2023-07-27 21:18:59] [config] embedding-fix-trg: false
[2023-07-27 21:18:59] [config] embedding-normalization: false
[2023-07-27 21:18:59] [config] embedding-vectors:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] enc-cell: gru
[2023-07-27 21:18:59] [config] enc-cell-depth: 1
[2023-07-27 21:18:59] [config] enc-depth: 8
[2023-07-27 21:18:59] [config] enc-type: bidirectional
[2023-07-27 21:18:59] [config] english-title-case-every: 0
[2023-07-27 21:18:59] [config] exponential-smoothing: 0
[2023-07-27 21:18:59] [config] factor-weight: 1
[2023-07-27 21:18:59] [config] factors-combine: sum
[2023-07-27 21:18:59] [config] factors-dim-emb: 0
[2023-07-27 21:18:59] [config] gradient-checkpointing: false
[2023-07-27 21:18:59] [config] gradient-norm-average-window: 100
[2023-07-27 21:18:59] [config] guided-alignment: none
[2023-07-27 21:18:59] [config] guided-alignment-cost: mse
[2023-07-27 21:18:59] [config] guided-alignment-weight: 0.1
[2023-07-27 21:18:59] [config] ignore-model-config: false
[2023-07-27 21:18:59] [config] input-types:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] interpolate-env-vars: false
[2023-07-27 21:18:59] [config] keep-best: false
[2023-07-27 21:18:59] [config] label-smoothing: 0
[2023-07-27 21:18:59] [config] layer-normalization: false
[2023-07-27 21:18:59] [config] learn-rate: 0.0001
[2023-07-27 21:18:59] [config] lemma-dependency: ""
[2023-07-27 21:18:59] [config] lemma-dim-emb: 0
[2023-07-27 21:18:59] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 21:18:59] [config] log-level: info
[2023-07-27 21:18:59] [config] log-time-zone: ""
[2023-07-27 21:18:59] [config] logical-epoch:
[2023-07-27 21:18:59] [config]   - 1e
[2023-07-27 21:18:59] [config]   - 0
[2023-07-27 21:18:59] [config] lr-decay: 0
[2023-07-27 21:18:59] [config] lr-decay-freq: 50000
[2023-07-27 21:18:59] [config] lr-decay-inv-sqrt:
[2023-07-27 21:18:59] [config]   - 0
[2023-07-27 21:18:59] [config] lr-decay-repeat-warmup: false
[2023-07-27 21:18:59] [config] lr-decay-reset-optimizer: false
[2023-07-27 21:18:59] [config] lr-decay-start:
[2023-07-27 21:18:59] [config]   - 10
[2023-07-27 21:18:59] [config]   - 1
[2023-07-27 21:18:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 21:18:59] [config] lr-report: false
[2023-07-27 21:18:59] [config] lr-warmup: 0
[2023-07-27 21:18:59] [config] lr-warmup-at-reload: false
[2023-07-27 21:18:59] [config] lr-warmup-cycle: false
[2023-07-27 21:18:59] [config] lr-warmup-start-rate: 0
[2023-07-27 21:18:59] [config] max-length: 50
[2023-07-27 21:18:59] [config] max-length-crop: true
[2023-07-27 21:18:59] [config] max-length-factor: 3
[2023-07-27 21:18:59] [config] maxi-batch: 100
[2023-07-27 21:18:59] [config] maxi-batch-sort: trg
[2023-07-27 21:18:59] [config] mini-batch: 64
[2023-07-27 21:18:59] [config] mini-batch-fit: true
[2023-07-27 21:18:59] [config] mini-batch-fit-step: 10
[2023-07-27 21:18:59] [config] mini-batch-round-up: true
[2023-07-27 21:18:59] [config] mini-batch-track-lr: false
[2023-07-27 21:18:59] [config] mini-batch-warmup: 0
[2023-07-27 21:18:59] [config] mini-batch-words: 0
[2023-07-27 21:18:59] [config] mini-batch-words-ref: 0
[2023-07-27 21:18:59] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 21:18:59] [config] multi-loss-type: sum
[2023-07-27 21:18:59] [config] n-best: false
[2023-07-27 21:18:59] [config] no-nccl: false
[2023-07-27 21:18:59] [config] no-reload: false
[2023-07-27 21:18:59] [config] no-restore-corpus: false
[2023-07-27 21:18:59] [config] normalize: 0
[2023-07-27 21:18:59] [config] normalize-gradient: false
[2023-07-27 21:18:59] [config] num-devices: 0
[2023-07-27 21:18:59] [config] optimizer: adam
[2023-07-27 21:18:59] [config] optimizer-delay: 1
[2023-07-27 21:18:59] [config] optimizer-params:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] output-omit-bias: false
[2023-07-27 21:18:59] [config] overwrite: true
[2023-07-27 21:18:59] [config] precision:
[2023-07-27 21:18:59] [config]   - float16
[2023-07-27 21:18:59] [config]   - float32
[2023-07-27 21:18:59] [config] pretrained-model: ""
[2023-07-27 21:18:59] [config] quantize-biases: false
[2023-07-27 21:18:59] [config] quantize-bits: 0
[2023-07-27 21:18:59] [config] quantize-log-based: false
[2023-07-27 21:18:59] [config] quantize-optimization-steps: 0
[2023-07-27 21:18:59] [config] quiet: false
[2023-07-27 21:18:59] [config] quiet-translation: true
[2023-07-27 21:18:59] [config] relative-paths: false
[2023-07-27 21:18:59] [config] right-left: false
[2023-07-27 21:18:59] [config] save-freq: 10000u
[2023-07-27 21:18:59] [config] seed: 1234
[2023-07-27 21:18:59] [config] sentencepiece-alphas:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] sentencepiece-max-lines: 2000000
[2023-07-27 21:18:59] [config] sentencepiece-options: ""
[2023-07-27 21:18:59] [config] sharding: global
[2023-07-27 21:18:59] [config] shuffle: data
[2023-07-27 21:18:59] [config] shuffle-in-ram: false
[2023-07-27 21:18:59] [config] sigterm: save-and-exit
[2023-07-27 21:18:59] [config] skip: false
[2023-07-27 21:18:59] [config] sqlite: ""
[2023-07-27 21:18:59] [config] sqlite-drop: false
[2023-07-27 21:18:59] [config] sync-freq: 200u
[2023-07-27 21:18:59] [config] sync-sgd: false
[2023-07-27 21:18:59] [config] tempdir: /tmp
[2023-07-27 21:18:59] [config] tied-embeddings: false
[2023-07-27 21:18:59] [config] tied-embeddings-all: true
[2023-07-27 21:18:59] [config] tied-embeddings-src: false
[2023-07-27 21:18:59] [config] train-embedder-rank:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] train-sets:
[2023-07-27 21:18:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 21:18:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 21:18:59] [config] transformer-aan-activation: swish
[2023-07-27 21:18:59] [config] transformer-aan-depth: 2
[2023-07-27 21:18:59] [config] transformer-aan-nogate: false
[2023-07-27 21:18:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 21:18:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 21:18:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 21:18:59] [config] transformer-depth-scaling: false
[2023-07-27 21:18:59] [config] transformer-dim-aan: 2048
[2023-07-27 21:18:59] [config] transformer-dim-ffn: 2048
[2023-07-27 21:18:59] [config] transformer-dropout: 0
[2023-07-27 21:18:59] [config] transformer-dropout-attention: 0
[2023-07-27 21:18:59] [config] transformer-dropout-ffn: 0
[2023-07-27 21:18:59] [config] transformer-ffn-activation: swish
[2023-07-27 21:18:59] [config] transformer-ffn-depth: 2
[2023-07-27 21:18:59] [config] transformer-guided-alignment-layer: last
[2023-07-27 21:18:59] [config] transformer-heads: 8
[2023-07-27 21:18:59] [config] transformer-no-projection: false
[2023-07-27 21:18:59] [config] transformer-pool: false
[2023-07-27 21:18:59] [config] transformer-postprocess: dan
[2023-07-27 21:18:59] [config] transformer-postprocess-emb: d
[2023-07-27 21:18:59] [config] transformer-postprocess-top: ""
[2023-07-27 21:18:59] [config] transformer-preprocess: ""
[2023-07-27 21:18:59] [config] transformer-tied-layers:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] transformer-train-position-embeddings: false
[2023-07-27 21:18:59] [config] tsv: false
[2023-07-27 21:18:59] [config] tsv-fields: 0
[2023-07-27 21:18:59] [config] type: s2s
[2023-07-27 21:18:59] [config] ulr: false
[2023-07-27 21:18:59] [config] ulr-dim-emb: 0
[2023-07-27 21:18:59] [config] ulr-dropout: 0
[2023-07-27 21:18:59] [config] ulr-keys-vectors: ""
[2023-07-27 21:18:59] [config] ulr-query-vectors: ""
[2023-07-27 21:18:59] [config] ulr-softmax-temperature: 1
[2023-07-27 21:18:59] [config] ulr-trainable-transformation: false
[2023-07-27 21:18:59] [config] unlikelihood-loss: false
[2023-07-27 21:18:59] [config] valid-freq: 50000000
[2023-07-27 21:18:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 21:18:59] [config] valid-max-length: 1000
[2023-07-27 21:18:59] [config] valid-metrics:
[2023-07-27 21:18:59] [config]   - translation
[2023-07-27 21:18:59] [config] valid-mini-batch: 32
[2023-07-27 21:18:59] [config] valid-reset-stalled: false
[2023-07-27 21:18:59] [config] valid-script-args:
[2023-07-27 21:18:59] [config]   []
[2023-07-27 21:18:59] [config] valid-script-path: ""
[2023-07-27 21:18:59] [config] valid-sets:
[2023-07-27 21:18:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 21:18:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 21:18:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 21:18:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 21:18:59] [config] vocabs:
[2023-07-27 21:18:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 21:18:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 21:18:59] [config] word-penalty: 0
[2023-07-27 21:18:59] [config] word-scores: false
[2023-07-27 21:18:59] [config] workspace: 5500
[2023-07-27 21:18:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 21:18:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 21:18:59] [training] Using single-device training
[2023-07-27 21:19:00] Synced seed 1234
[2023-07-27 21:19:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 21:19:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 21:19:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 21:19:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 21:19:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 21:19:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 21:19:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 21:19:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 21:19:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 21:19:01] [comm] Using global sharding
[2023-07-27 21:19:01] [comm] NCCLCommunicators constructed successfully
[2023-07-27 21:19:01] [training] Using 1 GPUs
[2023-07-27 21:19:01] [logits] Applying loss function for 1 factor(s)
[2023-07-27 21:19:01] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:19:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 21:19:02] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:20:33] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 21:20:33] [valid] No post-processing script given for validating translator
[2023-07-27 21:20:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 21:20:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 21:20:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 21:20:33] [comm] Using global sharding
[2023-07-27 21:20:33] [comm] NCCLCommunicators constructed successfully
[2023-07-27 21:20:33] [training] Using 1 GPUs
[2023-07-27 21:20:33] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 21:20:37] Allocating memory for general optimizer shards
[2023-07-27 21:20:37] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 21:20:37] Loading Adam parameters
[2023-07-27 21:20:38] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 21:20:38] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:20:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 21:20:40] [data] Restoring the corpus state to epoch 201, batch 16102
[2023-07-27 21:20:40] [data] Shuffling data
[2023-07-27 21:20:40] [data] Done reading 20,192 sentences
[2023-07-27 21:20:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:20:40] Training started
[2023-07-27 21:20:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 21:20:40] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:20:43] Parameter type float16, optimization type float32, casting types true
[2023-07-27 21:23:41] Seen 20,192 samples
[2023-07-27 21:23:41] Starting data epoch 202 in logical epoch 202
[2023-07-27 21:23:41] [data] Shuffling data
[2023-07-27 21:23:41] [data] Done reading 20,192 sentences
[2023-07-27 21:23:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:26:47] Seen 20,192 samples
[2023-07-27 21:26:47] Starting data epoch 203 in logical epoch 203
[2023-07-27 21:26:47] [data] Shuffling data
[2023-07-27 21:26:47] [data] Done reading 20,192 sentences
[2023-07-27 21:26:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:29:53] Seen 20,192 samples
[2023-07-27 21:29:53] Starting data epoch 204 in logical epoch 204
[2023-07-27 21:29:53] [data] Shuffling data
[2023-07-27 21:29:53] [data] Done reading 20,192 sentences
[2023-07-27 21:29:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:32:59] Seen 20,192 samples
[2023-07-27 21:32:59] Starting data epoch 205 in logical epoch 205
[2023-07-27 21:32:59] [data] Shuffling data
[2023-07-27 21:32:59] [data] Done reading 20,192 sentences
[2023-07-27 21:32:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:36:04] Seen 20,192 samples
[2023-07-27 21:36:04] Starting data epoch 206 in logical epoch 206
[2023-07-27 21:36:04] [data] Shuffling data
[2023-07-27 21:36:05] [data] Done reading 20,192 sentences
[2023-07-27 21:36:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:39:08] Seen 20,192 samples
[2023-07-27 21:39:08] Starting data epoch 207 in logical epoch 207
[2023-07-27 21:39:08] [data] Shuffling data
[2023-07-27 21:39:08] [data] Done reading 20,192 sentences
[2023-07-27 21:39:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:42:14] Seen 20,192 samples
[2023-07-27 21:42:14] Starting data epoch 208 in logical epoch 208
[2023-07-27 21:42:14] [data] Shuffling data
[2023-07-27 21:42:14] [data] Done reading 20,192 sentences
[2023-07-27 21:42:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:45:19] Seen 20,192 samples
[2023-07-27 21:45:19] Starting data epoch 209 in logical epoch 209
[2023-07-27 21:45:19] [data] Shuffling data
[2023-07-27 21:45:19] [data] Done reading 20,192 sentences
[2023-07-27 21:45:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:48:25] Seen 20,192 samples
[2023-07-27 21:48:25] Starting data epoch 210 in logical epoch 210
[2023-07-27 21:48:25] [data] Shuffling data
[2023-07-27 21:48:25] [data] Done reading 20,192 sentences
[2023-07-27 21:48:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:51:30] Seen 20,192 samples
[2023-07-27 21:51:30] Starting data epoch 211 in logical epoch 211
[2023-07-27 21:51:30] Training finished
[2023-07-27 21:52:44] [valid] Ep. 211 : Up. 16904 : translation : 0 : new best
[2023-07-27 21:52:44] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 21:52:55] Saving Adam parameters
[2023-07-27 21:52:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 21:53:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 21:53:22] [marian] Running on node05.datos.cluster.uy as process 1131 with command line:
[2023-07-27 21:53:22] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 220 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 21:53:22] [config] after: 0e
[2023-07-27 21:53:22] [config] after-batches: 0
[2023-07-27 21:53:22] [config] after-epochs: 220
[2023-07-27 21:53:22] [config] all-caps-every: 0
[2023-07-27 21:53:22] [config] allow-unk: false
[2023-07-27 21:53:22] [config] authors: false
[2023-07-27 21:53:22] [config] beam-size: 12
[2023-07-27 21:53:22] [config] bert-class-symbol: "[CLS]"
[2023-07-27 21:53:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 21:53:22] [config] bert-masking-fraction: 0.15
[2023-07-27 21:53:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 21:53:22] [config] bert-train-type-embeddings: true
[2023-07-27 21:53:22] [config] bert-type-vocab-size: 2
[2023-07-27 21:53:22] [config] build-info: ""
[2023-07-27 21:53:22] [config] check-gradient-nan: false
[2023-07-27 21:53:22] [config] check-nan: false
[2023-07-27 21:53:22] [config] cite: false
[2023-07-27 21:53:22] [config] clip-norm: 1
[2023-07-27 21:53:22] [config] cost-scaling:
[2023-07-27 21:53:22] [config]   - 256.f
[2023-07-27 21:53:22] [config]   - 1000
[2023-07-27 21:53:22] [config]   - 2.f
[2023-07-27 21:53:22] [config]   - 256.f
[2023-07-27 21:53:22] [config] cost-type: ce-sum
[2023-07-27 21:53:22] [config] cpu-threads: 0
[2023-07-27 21:53:22] [config] data-threads: 8
[2023-07-27 21:53:22] [config] data-weighting: ""
[2023-07-27 21:53:22] [config] data-weighting-type: sentence
[2023-07-27 21:53:22] [config] dec-cell: gru
[2023-07-27 21:53:22] [config] dec-cell-base-depth: 2
[2023-07-27 21:53:22] [config] dec-cell-high-depth: 1
[2023-07-27 21:53:22] [config] dec-depth: 8
[2023-07-27 21:53:22] [config] devices:
[2023-07-27 21:53:22] [config]   - 0
[2023-07-27 21:53:22] [config] dim-emb: 512
[2023-07-27 21:53:22] [config] dim-rnn: 1024
[2023-07-27 21:53:22] [config] dim-vocabs:
[2023-07-27 21:53:22] [config]   - 16384
[2023-07-27 21:53:22] [config]   - 16384
[2023-07-27 21:53:22] [config] disp-first: 0
[2023-07-27 21:53:22] [config] disp-freq: 1000u
[2023-07-27 21:53:22] [config] disp-label-counts: true
[2023-07-27 21:53:22] [config] dropout-rnn: 0
[2023-07-27 21:53:22] [config] dropout-src: 0
[2023-07-27 21:53:22] [config] dropout-trg: 0
[2023-07-27 21:53:22] [config] dump-config: ""
[2023-07-27 21:53:22] [config] dynamic-gradient-scaling:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] early-stopping: 1000
[2023-07-27 21:53:22] [config] early-stopping-on: first
[2023-07-27 21:53:22] [config] embedding-fix-src: false
[2023-07-27 21:53:22] [config] embedding-fix-trg: false
[2023-07-27 21:53:22] [config] embedding-normalization: false
[2023-07-27 21:53:22] [config] embedding-vectors:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] enc-cell: gru
[2023-07-27 21:53:22] [config] enc-cell-depth: 1
[2023-07-27 21:53:22] [config] enc-depth: 8
[2023-07-27 21:53:22] [config] enc-type: bidirectional
[2023-07-27 21:53:22] [config] english-title-case-every: 0
[2023-07-27 21:53:22] [config] exponential-smoothing: 0
[2023-07-27 21:53:22] [config] factor-weight: 1
[2023-07-27 21:53:22] [config] factors-combine: sum
[2023-07-27 21:53:22] [config] factors-dim-emb: 0
[2023-07-27 21:53:22] [config] gradient-checkpointing: false
[2023-07-27 21:53:22] [config] gradient-norm-average-window: 100
[2023-07-27 21:53:22] [config] guided-alignment: none
[2023-07-27 21:53:22] [config] guided-alignment-cost: mse
[2023-07-27 21:53:22] [config] guided-alignment-weight: 0.1
[2023-07-27 21:53:22] [config] ignore-model-config: false
[2023-07-27 21:53:22] [config] input-types:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] interpolate-env-vars: false
[2023-07-27 21:53:22] [config] keep-best: false
[2023-07-27 21:53:22] [config] label-smoothing: 0
[2023-07-27 21:53:22] [config] layer-normalization: false
[2023-07-27 21:53:22] [config] learn-rate: 0.0001
[2023-07-27 21:53:22] [config] lemma-dependency: ""
[2023-07-27 21:53:22] [config] lemma-dim-emb: 0
[2023-07-27 21:53:22] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 21:53:22] [config] log-level: info
[2023-07-27 21:53:22] [config] log-time-zone: ""
[2023-07-27 21:53:22] [config] logical-epoch:
[2023-07-27 21:53:22] [config]   - 1e
[2023-07-27 21:53:22] [config]   - 0
[2023-07-27 21:53:22] [config] lr-decay: 0
[2023-07-27 21:53:22] [config] lr-decay-freq: 50000
[2023-07-27 21:53:22] [config] lr-decay-inv-sqrt:
[2023-07-27 21:53:22] [config]   - 0
[2023-07-27 21:53:22] [config] lr-decay-repeat-warmup: false
[2023-07-27 21:53:22] [config] lr-decay-reset-optimizer: false
[2023-07-27 21:53:22] [config] lr-decay-start:
[2023-07-27 21:53:22] [config]   - 10
[2023-07-27 21:53:22] [config]   - 1
[2023-07-27 21:53:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 21:53:22] [config] lr-report: false
[2023-07-27 21:53:22] [config] lr-warmup: 0
[2023-07-27 21:53:22] [config] lr-warmup-at-reload: false
[2023-07-27 21:53:22] [config] lr-warmup-cycle: false
[2023-07-27 21:53:22] [config] lr-warmup-start-rate: 0
[2023-07-27 21:53:22] [config] max-length: 50
[2023-07-27 21:53:22] [config] max-length-crop: true
[2023-07-27 21:53:22] [config] max-length-factor: 3
[2023-07-27 21:53:22] [config] maxi-batch: 100
[2023-07-27 21:53:22] [config] maxi-batch-sort: trg
[2023-07-27 21:53:22] [config] mini-batch: 64
[2023-07-27 21:53:22] [config] mini-batch-fit: true
[2023-07-27 21:53:22] [config] mini-batch-fit-step: 10
[2023-07-27 21:53:22] [config] mini-batch-round-up: true
[2023-07-27 21:53:22] [config] mini-batch-track-lr: false
[2023-07-27 21:53:22] [config] mini-batch-warmup: 0
[2023-07-27 21:53:22] [config] mini-batch-words: 0
[2023-07-27 21:53:22] [config] mini-batch-words-ref: 0
[2023-07-27 21:53:22] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 21:53:22] [config] multi-loss-type: sum
[2023-07-27 21:53:22] [config] n-best: false
[2023-07-27 21:53:22] [config] no-nccl: false
[2023-07-27 21:53:22] [config] no-reload: false
[2023-07-27 21:53:22] [config] no-restore-corpus: false
[2023-07-27 21:53:22] [config] normalize: 0
[2023-07-27 21:53:22] [config] normalize-gradient: false
[2023-07-27 21:53:22] [config] num-devices: 0
[2023-07-27 21:53:22] [config] optimizer: adam
[2023-07-27 21:53:22] [config] optimizer-delay: 1
[2023-07-27 21:53:22] [config] optimizer-params:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] output-omit-bias: false
[2023-07-27 21:53:22] [config] overwrite: true
[2023-07-27 21:53:22] [config] precision:
[2023-07-27 21:53:22] [config]   - float16
[2023-07-27 21:53:22] [config]   - float32
[2023-07-27 21:53:22] [config] pretrained-model: ""
[2023-07-27 21:53:22] [config] quantize-biases: false
[2023-07-27 21:53:22] [config] quantize-bits: 0
[2023-07-27 21:53:22] [config] quantize-log-based: false
[2023-07-27 21:53:22] [config] quantize-optimization-steps: 0
[2023-07-27 21:53:22] [config] quiet: false
[2023-07-27 21:53:22] [config] quiet-translation: true
[2023-07-27 21:53:22] [config] relative-paths: false
[2023-07-27 21:53:22] [config] right-left: false
[2023-07-27 21:53:22] [config] save-freq: 10000u
[2023-07-27 21:53:22] [config] seed: 1234
[2023-07-27 21:53:22] [config] sentencepiece-alphas:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] sentencepiece-max-lines: 2000000
[2023-07-27 21:53:22] [config] sentencepiece-options: ""
[2023-07-27 21:53:22] [config] sharding: global
[2023-07-27 21:53:22] [config] shuffle: data
[2023-07-27 21:53:22] [config] shuffle-in-ram: false
[2023-07-27 21:53:22] [config] sigterm: save-and-exit
[2023-07-27 21:53:22] [config] skip: false
[2023-07-27 21:53:22] [config] sqlite: ""
[2023-07-27 21:53:22] [config] sqlite-drop: false
[2023-07-27 21:53:22] [config] sync-freq: 200u
[2023-07-27 21:53:22] [config] sync-sgd: false
[2023-07-27 21:53:22] [config] tempdir: /tmp
[2023-07-27 21:53:22] [config] tied-embeddings: false
[2023-07-27 21:53:22] [config] tied-embeddings-all: true
[2023-07-27 21:53:22] [config] tied-embeddings-src: false
[2023-07-27 21:53:22] [config] train-embedder-rank:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] train-sets:
[2023-07-27 21:53:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 21:53:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 21:53:22] [config] transformer-aan-activation: swish
[2023-07-27 21:53:22] [config] transformer-aan-depth: 2
[2023-07-27 21:53:22] [config] transformer-aan-nogate: false
[2023-07-27 21:53:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 21:53:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 21:53:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 21:53:22] [config] transformer-depth-scaling: false
[2023-07-27 21:53:22] [config] transformer-dim-aan: 2048
[2023-07-27 21:53:22] [config] transformer-dim-ffn: 2048
[2023-07-27 21:53:22] [config] transformer-dropout: 0
[2023-07-27 21:53:22] [config] transformer-dropout-attention: 0
[2023-07-27 21:53:22] [config] transformer-dropout-ffn: 0
[2023-07-27 21:53:22] [config] transformer-ffn-activation: swish
[2023-07-27 21:53:22] [config] transformer-ffn-depth: 2
[2023-07-27 21:53:22] [config] transformer-guided-alignment-layer: last
[2023-07-27 21:53:22] [config] transformer-heads: 8
[2023-07-27 21:53:22] [config] transformer-no-projection: false
[2023-07-27 21:53:22] [config] transformer-pool: false
[2023-07-27 21:53:22] [config] transformer-postprocess: dan
[2023-07-27 21:53:22] [config] transformer-postprocess-emb: d
[2023-07-27 21:53:22] [config] transformer-postprocess-top: ""
[2023-07-27 21:53:22] [config] transformer-preprocess: ""
[2023-07-27 21:53:22] [config] transformer-tied-layers:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] transformer-train-position-embeddings: false
[2023-07-27 21:53:22] [config] tsv: false
[2023-07-27 21:53:22] [config] tsv-fields: 0
[2023-07-27 21:53:22] [config] type: s2s
[2023-07-27 21:53:22] [config] ulr: false
[2023-07-27 21:53:22] [config] ulr-dim-emb: 0
[2023-07-27 21:53:22] [config] ulr-dropout: 0
[2023-07-27 21:53:22] [config] ulr-keys-vectors: ""
[2023-07-27 21:53:22] [config] ulr-query-vectors: ""
[2023-07-27 21:53:22] [config] ulr-softmax-temperature: 1
[2023-07-27 21:53:22] [config] ulr-trainable-transformation: false
[2023-07-27 21:53:22] [config] unlikelihood-loss: false
[2023-07-27 21:53:22] [config] valid-freq: 50000000
[2023-07-27 21:53:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 21:53:22] [config] valid-max-length: 1000
[2023-07-27 21:53:22] [config] valid-metrics:
[2023-07-27 21:53:22] [config]   - translation
[2023-07-27 21:53:22] [config] valid-mini-batch: 32
[2023-07-27 21:53:22] [config] valid-reset-stalled: false
[2023-07-27 21:53:22] [config] valid-script-args:
[2023-07-27 21:53:22] [config]   []
[2023-07-27 21:53:22] [config] valid-script-path: ""
[2023-07-27 21:53:22] [config] valid-sets:
[2023-07-27 21:53:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 21:53:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 21:53:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 21:53:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 21:53:22] [config] vocabs:
[2023-07-27 21:53:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 21:53:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 21:53:22] [config] word-penalty: 0
[2023-07-27 21:53:22] [config] word-scores: false
[2023-07-27 21:53:22] [config] workspace: 5500
[2023-07-27 21:53:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 21:53:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 21:53:22] [training] Using single-device training
[2023-07-27 21:53:22] Synced seed 1234
[2023-07-27 21:53:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 21:53:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 21:53:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 21:53:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 21:53:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 21:53:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 21:53:23] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 21:53:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 21:53:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 21:53:24] [comm] Using global sharding
[2023-07-27 21:53:24] [comm] NCCLCommunicators constructed successfully
[2023-07-27 21:53:24] [training] Using 1 GPUs
[2023-07-27 21:53:24] [logits] Applying loss function for 1 factor(s)
[2023-07-27 21:53:24] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:53:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 21:53:24] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:54:55] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 21:54:55] [valid] No post-processing script given for validating translator
[2023-07-27 21:54:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 21:54:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 21:54:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 21:54:55] [comm] Using global sharding
[2023-07-27 21:54:55] [comm] NCCLCommunicators constructed successfully
[2023-07-27 21:54:55] [training] Using 1 GPUs
[2023-07-27 21:54:55] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 21:55:04] Allocating memory for general optimizer shards
[2023-07-27 21:55:04] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 21:55:04] Loading Adam parameters
[2023-07-27 21:55:04] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 21:55:05] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:55:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 21:55:06] [data] Restoring the corpus state to epoch 211, batch 16904
[2023-07-27 21:55:06] [data] Shuffling data
[2023-07-27 21:55:06] [data] Done reading 20,192 sentences
[2023-07-27 21:55:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:55:06] Training started
[2023-07-27 21:55:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 21:55:06] [memory] Reserving 332 MB, device gpu0
[2023-07-27 21:55:08] Parameter type float16, optimization type float32, casting types true
[2023-07-27 21:58:07] Seen 20,192 samples
[2023-07-27 21:58:07] Starting data epoch 212 in logical epoch 212
[2023-07-27 21:58:07] [data] Shuffling data
[2023-07-27 21:58:07] [data] Done reading 20,192 sentences
[2023-07-27 21:58:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:58:37] Ep. 212 : Up. 17000 : Sen. 3,679 : Cost 0.25033700 * 7,059,702 @ 6,125 after 119,749,627 : Time 222.53s : 31724.85 words/s : gNorm 1.1033
[2023-07-27 22:01:12] Seen 20,192 samples
[2023-07-27 22:01:12] Starting data epoch 213 in logical epoch 213
[2023-07-27 22:01:12] [data] Shuffling data
[2023-07-27 22:01:12] [data] Done reading 20,192 sentences
[2023-07-27 22:01:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:04:17] Seen 20,192 samples
[2023-07-27 22:04:17] Starting data epoch 214 in logical epoch 214
[2023-07-27 22:04:17] [data] Shuffling data
[2023-07-27 22:04:17] [data] Done reading 20,192 sentences
[2023-07-27 22:04:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:07:23] Seen 20,192 samples
[2023-07-27 22:07:23] Starting data epoch 215 in logical epoch 215
[2023-07-27 22:07:23] [data] Shuffling data
[2023-07-27 22:07:23] [data] Done reading 20,192 sentences
[2023-07-27 22:07:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:10:29] Seen 20,192 samples
[2023-07-27 22:10:29] Starting data epoch 216 in logical epoch 216
[2023-07-27 22:10:29] [data] Shuffling data
[2023-07-27 22:10:30] [data] Done reading 20,192 sentences
[2023-07-27 22:10:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:13:34] Seen 20,192 samples
[2023-07-27 22:13:34] Starting data epoch 217 in logical epoch 217
[2023-07-27 22:13:34] [data] Shuffling data
[2023-07-27 22:13:34] [data] Done reading 20,192 sentences
[2023-07-27 22:13:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:16:40] Seen 20,192 samples
[2023-07-27 22:16:40] Starting data epoch 218 in logical epoch 218
[2023-07-27 22:16:40] [data] Shuffling data
[2023-07-27 22:16:40] [data] Done reading 20,192 sentences
[2023-07-27 22:16:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:19:45] Seen 20,192 samples
[2023-07-27 22:19:45] Starting data epoch 219 in logical epoch 219
[2023-07-27 22:19:45] [data] Shuffling data
[2023-07-27 22:19:45] [data] Done reading 20,192 sentences
[2023-07-27 22:19:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:22:50] Seen 20,192 samples
[2023-07-27 22:22:50] Starting data epoch 220 in logical epoch 220
[2023-07-27 22:22:50] [data] Shuffling data
[2023-07-27 22:22:50] [data] Done reading 20,192 sentences
[2023-07-27 22:22:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:25:56] Seen 20,192 samples
[2023-07-27 22:25:56] Starting data epoch 221 in logical epoch 221
[2023-07-27 22:25:56] Training finished
[2023-07-27 22:27:12] [valid] Ep. 221 : Up. 17712 : translation : 0 : new best
[2023-07-27 22:27:12] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 22:27:19] Saving Adam parameters
[2023-07-27 22:27:21] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 22:27:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:27:41] [marian] Running on node05.datos.cluster.uy as process 3395 with command line:
[2023-07-27 22:27:41] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 230 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 22:27:41] [config] after: 0e
[2023-07-27 22:27:41] [config] after-batches: 0
[2023-07-27 22:27:41] [config] after-epochs: 230
[2023-07-27 22:27:41] [config] all-caps-every: 0
[2023-07-27 22:27:41] [config] allow-unk: false
[2023-07-27 22:27:41] [config] authors: false
[2023-07-27 22:27:41] [config] beam-size: 12
[2023-07-27 22:27:41] [config] bert-class-symbol: "[CLS]"
[2023-07-27 22:27:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 22:27:41] [config] bert-masking-fraction: 0.15
[2023-07-27 22:27:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 22:27:41] [config] bert-train-type-embeddings: true
[2023-07-27 22:27:41] [config] bert-type-vocab-size: 2
[2023-07-27 22:27:41] [config] build-info: ""
[2023-07-27 22:27:41] [config] check-gradient-nan: false
[2023-07-27 22:27:41] [config] check-nan: false
[2023-07-27 22:27:41] [config] cite: false
[2023-07-27 22:27:41] [config] clip-norm: 1
[2023-07-27 22:27:41] [config] cost-scaling:
[2023-07-27 22:27:41] [config]   - 256.f
[2023-07-27 22:27:41] [config]   - 1000
[2023-07-27 22:27:41] [config]   - 2.f
[2023-07-27 22:27:41] [config]   - 256.f
[2023-07-27 22:27:41] [config] cost-type: ce-sum
[2023-07-27 22:27:41] [config] cpu-threads: 0
[2023-07-27 22:27:41] [config] data-threads: 8
[2023-07-27 22:27:41] [config] data-weighting: ""
[2023-07-27 22:27:41] [config] data-weighting-type: sentence
[2023-07-27 22:27:41] [config] dec-cell: gru
[2023-07-27 22:27:41] [config] dec-cell-base-depth: 2
[2023-07-27 22:27:41] [config] dec-cell-high-depth: 1
[2023-07-27 22:27:41] [config] dec-depth: 8
[2023-07-27 22:27:41] [config] devices:
[2023-07-27 22:27:41] [config]   - 0
[2023-07-27 22:27:41] [config] dim-emb: 512
[2023-07-27 22:27:41] [config] dim-rnn: 1024
[2023-07-27 22:27:41] [config] dim-vocabs:
[2023-07-27 22:27:41] [config]   - 16384
[2023-07-27 22:27:41] [config]   - 16384
[2023-07-27 22:27:41] [config] disp-first: 0
[2023-07-27 22:27:41] [config] disp-freq: 1000u
[2023-07-27 22:27:41] [config] disp-label-counts: true
[2023-07-27 22:27:41] [config] dropout-rnn: 0
[2023-07-27 22:27:41] [config] dropout-src: 0
[2023-07-27 22:27:41] [config] dropout-trg: 0
[2023-07-27 22:27:41] [config] dump-config: ""
[2023-07-27 22:27:41] [config] dynamic-gradient-scaling:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] early-stopping: 1000
[2023-07-27 22:27:41] [config] early-stopping-on: first
[2023-07-27 22:27:41] [config] embedding-fix-src: false
[2023-07-27 22:27:41] [config] embedding-fix-trg: false
[2023-07-27 22:27:41] [config] embedding-normalization: false
[2023-07-27 22:27:41] [config] embedding-vectors:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] enc-cell: gru
[2023-07-27 22:27:41] [config] enc-cell-depth: 1
[2023-07-27 22:27:41] [config] enc-depth: 8
[2023-07-27 22:27:41] [config] enc-type: bidirectional
[2023-07-27 22:27:41] [config] english-title-case-every: 0
[2023-07-27 22:27:41] [config] exponential-smoothing: 0
[2023-07-27 22:27:41] [config] factor-weight: 1
[2023-07-27 22:27:41] [config] factors-combine: sum
[2023-07-27 22:27:41] [config] factors-dim-emb: 0
[2023-07-27 22:27:41] [config] gradient-checkpointing: false
[2023-07-27 22:27:41] [config] gradient-norm-average-window: 100
[2023-07-27 22:27:41] [config] guided-alignment: none
[2023-07-27 22:27:41] [config] guided-alignment-cost: mse
[2023-07-27 22:27:41] [config] guided-alignment-weight: 0.1
[2023-07-27 22:27:41] [config] ignore-model-config: false
[2023-07-27 22:27:41] [config] input-types:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] interpolate-env-vars: false
[2023-07-27 22:27:41] [config] keep-best: false
[2023-07-27 22:27:41] [config] label-smoothing: 0
[2023-07-27 22:27:41] [config] layer-normalization: false
[2023-07-27 22:27:41] [config] learn-rate: 0.0001
[2023-07-27 22:27:41] [config] lemma-dependency: ""
[2023-07-27 22:27:41] [config] lemma-dim-emb: 0
[2023-07-27 22:27:41] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 22:27:41] [config] log-level: info
[2023-07-27 22:27:41] [config] log-time-zone: ""
[2023-07-27 22:27:41] [config] logical-epoch:
[2023-07-27 22:27:41] [config]   - 1e
[2023-07-27 22:27:41] [config]   - 0
[2023-07-27 22:27:41] [config] lr-decay: 0
[2023-07-27 22:27:41] [config] lr-decay-freq: 50000
[2023-07-27 22:27:41] [config] lr-decay-inv-sqrt:
[2023-07-27 22:27:41] [config]   - 0
[2023-07-27 22:27:41] [config] lr-decay-repeat-warmup: false
[2023-07-27 22:27:41] [config] lr-decay-reset-optimizer: false
[2023-07-27 22:27:41] [config] lr-decay-start:
[2023-07-27 22:27:41] [config]   - 10
[2023-07-27 22:27:41] [config]   - 1
[2023-07-27 22:27:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 22:27:41] [config] lr-report: false
[2023-07-27 22:27:41] [config] lr-warmup: 0
[2023-07-27 22:27:41] [config] lr-warmup-at-reload: false
[2023-07-27 22:27:41] [config] lr-warmup-cycle: false
[2023-07-27 22:27:41] [config] lr-warmup-start-rate: 0
[2023-07-27 22:27:41] [config] max-length: 50
[2023-07-27 22:27:41] [config] max-length-crop: true
[2023-07-27 22:27:41] [config] max-length-factor: 3
[2023-07-27 22:27:41] [config] maxi-batch: 100
[2023-07-27 22:27:41] [config] maxi-batch-sort: trg
[2023-07-27 22:27:41] [config] mini-batch: 64
[2023-07-27 22:27:41] [config] mini-batch-fit: true
[2023-07-27 22:27:41] [config] mini-batch-fit-step: 10
[2023-07-27 22:27:41] [config] mini-batch-round-up: true
[2023-07-27 22:27:41] [config] mini-batch-track-lr: false
[2023-07-27 22:27:41] [config] mini-batch-warmup: 0
[2023-07-27 22:27:41] [config] mini-batch-words: 0
[2023-07-27 22:27:41] [config] mini-batch-words-ref: 0
[2023-07-27 22:27:41] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 22:27:41] [config] multi-loss-type: sum
[2023-07-27 22:27:41] [config] n-best: false
[2023-07-27 22:27:41] [config] no-nccl: false
[2023-07-27 22:27:41] [config] no-reload: false
[2023-07-27 22:27:41] [config] no-restore-corpus: false
[2023-07-27 22:27:41] [config] normalize: 0
[2023-07-27 22:27:41] [config] normalize-gradient: false
[2023-07-27 22:27:41] [config] num-devices: 0
[2023-07-27 22:27:41] [config] optimizer: adam
[2023-07-27 22:27:41] [config] optimizer-delay: 1
[2023-07-27 22:27:41] [config] optimizer-params:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] output-omit-bias: false
[2023-07-27 22:27:41] [config] overwrite: true
[2023-07-27 22:27:41] [config] precision:
[2023-07-27 22:27:41] [config]   - float16
[2023-07-27 22:27:41] [config]   - float32
[2023-07-27 22:27:41] [config] pretrained-model: ""
[2023-07-27 22:27:41] [config] quantize-biases: false
[2023-07-27 22:27:41] [config] quantize-bits: 0
[2023-07-27 22:27:41] [config] quantize-log-based: false
[2023-07-27 22:27:41] [config] quantize-optimization-steps: 0
[2023-07-27 22:27:41] [config] quiet: false
[2023-07-27 22:27:41] [config] quiet-translation: true
[2023-07-27 22:27:41] [config] relative-paths: false
[2023-07-27 22:27:41] [config] right-left: false
[2023-07-27 22:27:41] [config] save-freq: 10000u
[2023-07-27 22:27:41] [config] seed: 1234
[2023-07-27 22:27:41] [config] sentencepiece-alphas:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] sentencepiece-max-lines: 2000000
[2023-07-27 22:27:41] [config] sentencepiece-options: ""
[2023-07-27 22:27:41] [config] sharding: global
[2023-07-27 22:27:41] [config] shuffle: data
[2023-07-27 22:27:41] [config] shuffle-in-ram: false
[2023-07-27 22:27:41] [config] sigterm: save-and-exit
[2023-07-27 22:27:41] [config] skip: false
[2023-07-27 22:27:41] [config] sqlite: ""
[2023-07-27 22:27:41] [config] sqlite-drop: false
[2023-07-27 22:27:41] [config] sync-freq: 200u
[2023-07-27 22:27:41] [config] sync-sgd: false
[2023-07-27 22:27:41] [config] tempdir: /tmp
[2023-07-27 22:27:41] [config] tied-embeddings: false
[2023-07-27 22:27:41] [config] tied-embeddings-all: true
[2023-07-27 22:27:41] [config] tied-embeddings-src: false
[2023-07-27 22:27:41] [config] train-embedder-rank:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] train-sets:
[2023-07-27 22:27:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 22:27:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 22:27:41] [config] transformer-aan-activation: swish
[2023-07-27 22:27:41] [config] transformer-aan-depth: 2
[2023-07-27 22:27:41] [config] transformer-aan-nogate: false
[2023-07-27 22:27:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 22:27:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 22:27:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 22:27:41] [config] transformer-depth-scaling: false
[2023-07-27 22:27:41] [config] transformer-dim-aan: 2048
[2023-07-27 22:27:41] [config] transformer-dim-ffn: 2048
[2023-07-27 22:27:41] [config] transformer-dropout: 0
[2023-07-27 22:27:41] [config] transformer-dropout-attention: 0
[2023-07-27 22:27:41] [config] transformer-dropout-ffn: 0
[2023-07-27 22:27:41] [config] transformer-ffn-activation: swish
[2023-07-27 22:27:41] [config] transformer-ffn-depth: 2
[2023-07-27 22:27:41] [config] transformer-guided-alignment-layer: last
[2023-07-27 22:27:41] [config] transformer-heads: 8
[2023-07-27 22:27:41] [config] transformer-no-projection: false
[2023-07-27 22:27:41] [config] transformer-pool: false
[2023-07-27 22:27:41] [config] transformer-postprocess: dan
[2023-07-27 22:27:41] [config] transformer-postprocess-emb: d
[2023-07-27 22:27:41] [config] transformer-postprocess-top: ""
[2023-07-27 22:27:41] [config] transformer-preprocess: ""
[2023-07-27 22:27:41] [config] transformer-tied-layers:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] transformer-train-position-embeddings: false
[2023-07-27 22:27:41] [config] tsv: false
[2023-07-27 22:27:41] [config] tsv-fields: 0
[2023-07-27 22:27:41] [config] type: s2s
[2023-07-27 22:27:41] [config] ulr: false
[2023-07-27 22:27:41] [config] ulr-dim-emb: 0
[2023-07-27 22:27:41] [config] ulr-dropout: 0
[2023-07-27 22:27:41] [config] ulr-keys-vectors: ""
[2023-07-27 22:27:41] [config] ulr-query-vectors: ""
[2023-07-27 22:27:41] [config] ulr-softmax-temperature: 1
[2023-07-27 22:27:41] [config] ulr-trainable-transformation: false
[2023-07-27 22:27:41] [config] unlikelihood-loss: false
[2023-07-27 22:27:41] [config] valid-freq: 50000000
[2023-07-27 22:27:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 22:27:41] [config] valid-max-length: 1000
[2023-07-27 22:27:41] [config] valid-metrics:
[2023-07-27 22:27:41] [config]   - translation
[2023-07-27 22:27:41] [config] valid-mini-batch: 32
[2023-07-27 22:27:41] [config] valid-reset-stalled: false
[2023-07-27 22:27:41] [config] valid-script-args:
[2023-07-27 22:27:41] [config]   []
[2023-07-27 22:27:41] [config] valid-script-path: ""
[2023-07-27 22:27:41] [config] valid-sets:
[2023-07-27 22:27:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 22:27:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 22:27:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 22:27:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:27:41] [config] vocabs:
[2023-07-27 22:27:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 22:27:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 22:27:41] [config] word-penalty: 0
[2023-07-27 22:27:41] [config] word-scores: false
[2023-07-27 22:27:41] [config] workspace: 5500
[2023-07-27 22:27:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:27:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:27:41] [training] Using single-device training
[2023-07-27 22:27:42] Synced seed 1234
[2023-07-27 22:27:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 22:27:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 22:27:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 22:27:42] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 22:27:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 22:27:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:27:42] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 22:27:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 22:27:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 22:27:42] [comm] Using global sharding
[2023-07-27 22:27:42] [comm] NCCLCommunicators constructed successfully
[2023-07-27 22:27:42] [training] Using 1 GPUs
[2023-07-27 22:27:42] [logits] Applying loss function for 1 factor(s)
[2023-07-27 22:27:42] [memory] Reserving 332 MB, device gpu0
[2023-07-27 22:27:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 22:27:43] [memory] Reserving 332 MB, device gpu0
[2023-07-27 22:29:15] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 22:29:15] [valid] No post-processing script given for validating translator
[2023-07-27 22:29:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:29:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 22:29:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 22:29:15] [comm] Using global sharding
[2023-07-27 22:29:15] [comm] NCCLCommunicators constructed successfully
[2023-07-27 22:29:15] [training] Using 1 GPUs
[2023-07-27 22:29:15] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 22:29:21] Allocating memory for general optimizer shards
[2023-07-27 22:29:21] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 22:29:21] Loading Adam parameters
[2023-07-27 22:29:22] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 22:29:22] [memory] Reserving 332 MB, device gpu0
[2023-07-27 22:29:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 22:29:24] [data] Restoring the corpus state to epoch 221, batch 17712
[2023-07-27 22:29:24] [data] Shuffling data
[2023-07-27 22:29:24] [data] Done reading 20,192 sentences
[2023-07-27 22:29:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:29:24] Training started
[2023-07-27 22:29:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 22:29:24] [memory] Reserving 332 MB, device gpu0
[2023-07-27 22:29:26] Parameter type float16, optimization type float32, casting types true
[2023-07-27 22:32:26] Seen 20,192 samples
[2023-07-27 22:32:26] Starting data epoch 222 in logical epoch 222
[2023-07-27 22:32:26] [data] Shuffling data
[2023-07-27 22:32:26] [data] Done reading 20,192 sentences
[2023-07-27 22:32:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:35:31] Seen 20,192 samples
[2023-07-27 22:35:31] Starting data epoch 223 in logical epoch 223
[2023-07-27 22:35:31] [data] Shuffling data
[2023-07-27 22:35:31] [data] Done reading 20,192 sentences
[2023-07-27 22:35:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:38:35] Seen 20,192 samples
[2023-07-27 22:38:35] Starting data epoch 224 in logical epoch 224
[2023-07-27 22:38:35] [data] Shuffling data
[2023-07-27 22:38:35] [data] Done reading 20,192 sentences
[2023-07-27 22:38:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:40:25] Ep. 224 : Up. 18000 : Sen. 12,007 : Cost 0.16844571 * 7,055,766 @ 3,893 after 126,805,393 : Time 669.81s : 10534.02 words/s : gNorm 1.0457
[2023-07-27 22:41:40] Seen 20,192 samples
[2023-07-27 22:41:40] Starting data epoch 225 in logical epoch 225
[2023-07-27 22:41:40] [data] Shuffling data
[2023-07-27 22:41:40] [data] Done reading 20,192 sentences
[2023-07-27 22:41:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:44:46] Seen 20,192 samples
[2023-07-27 22:44:46] Starting data epoch 226 in logical epoch 226
[2023-07-27 22:44:46] [data] Shuffling data
[2023-07-27 22:44:46] [data] Done reading 20,192 sentences
[2023-07-27 22:44:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:47:51] Seen 20,192 samples
[2023-07-27 22:47:51] Starting data epoch 227 in logical epoch 227
[2023-07-27 22:47:51] [data] Shuffling data
[2023-07-27 22:47:51] [data] Done reading 20,192 sentences
[2023-07-27 22:47:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:50:54] Seen 20,192 samples
[2023-07-27 22:50:54] Starting data epoch 228 in logical epoch 228
[2023-07-27 22:50:54] [data] Shuffling data
[2023-07-27 22:50:54] [data] Done reading 20,192 sentences
[2023-07-27 22:50:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:53:54] Seen 20,192 samples
[2023-07-27 22:53:54] Starting data epoch 229 in logical epoch 229
[2023-07-27 22:53:54] [data] Shuffling data
[2023-07-27 22:53:54] [data] Done reading 20,192 sentences
[2023-07-27 22:53:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:56:59] Seen 20,192 samples
[2023-07-27 22:56:59] Starting data epoch 230 in logical epoch 230
[2023-07-27 22:56:59] [data] Shuffling data
[2023-07-27 22:57:00] [data] Done reading 20,192 sentences
[2023-07-27 22:57:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:00:05] Seen 20,192 samples
[2023-07-27 23:00:05] Starting data epoch 231 in logical epoch 231
[2023-07-27 23:00:05] Training finished
[2023-07-27 23:01:19] [valid] Ep. 231 : Up. 18519 : translation : 0 : new best
[2023-07-27 23:01:19] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 23:01:27] Saving Adam parameters
[2023-07-27 23:01:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 23:01:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:01:46] [marian] Running on node05.datos.cluster.uy as process 5572 with command line:
[2023-07-27 23:01:46] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz --after-epochs 240 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 8 --dec-depth 8
[2023-07-27 23:01:46] [config] after: 0e
[2023-07-27 23:01:46] [config] after-batches: 0
[2023-07-27 23:01:46] [config] after-epochs: 240
[2023-07-27 23:01:46] [config] all-caps-every: 0
[2023-07-27 23:01:46] [config] allow-unk: false
[2023-07-27 23:01:46] [config] authors: false
[2023-07-27 23:01:46] [config] beam-size: 12
[2023-07-27 23:01:46] [config] bert-class-symbol: "[CLS]"
[2023-07-27 23:01:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 23:01:46] [config] bert-masking-fraction: 0.15
[2023-07-27 23:01:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 23:01:46] [config] bert-train-type-embeddings: true
[2023-07-27 23:01:46] [config] bert-type-vocab-size: 2
[2023-07-27 23:01:46] [config] build-info: ""
[2023-07-27 23:01:46] [config] check-gradient-nan: false
[2023-07-27 23:01:46] [config] check-nan: false
[2023-07-27 23:01:46] [config] cite: false
[2023-07-27 23:01:46] [config] clip-norm: 1
[2023-07-27 23:01:46] [config] cost-scaling:
[2023-07-27 23:01:46] [config]   - 256.f
[2023-07-27 23:01:46] [config]   - 1000
[2023-07-27 23:01:46] [config]   - 2.f
[2023-07-27 23:01:46] [config]   - 256.f
[2023-07-27 23:01:46] [config] cost-type: ce-sum
[2023-07-27 23:01:46] [config] cpu-threads: 0
[2023-07-27 23:01:46] [config] data-threads: 8
[2023-07-27 23:01:46] [config] data-weighting: ""
[2023-07-27 23:01:46] [config] data-weighting-type: sentence
[2023-07-27 23:01:46] [config] dec-cell: gru
[2023-07-27 23:01:46] [config] dec-cell-base-depth: 2
[2023-07-27 23:01:46] [config] dec-cell-high-depth: 1
[2023-07-27 23:01:46] [config] dec-depth: 8
[2023-07-27 23:01:46] [config] devices:
[2023-07-27 23:01:46] [config]   - 0
[2023-07-27 23:01:46] [config] dim-emb: 512
[2023-07-27 23:01:46] [config] dim-rnn: 1024
[2023-07-27 23:01:46] [config] dim-vocabs:
[2023-07-27 23:01:46] [config]   - 16384
[2023-07-27 23:01:46] [config]   - 16384
[2023-07-27 23:01:46] [config] disp-first: 0
[2023-07-27 23:01:46] [config] disp-freq: 1000u
[2023-07-27 23:01:46] [config] disp-label-counts: true
[2023-07-27 23:01:46] [config] dropout-rnn: 0
[2023-07-27 23:01:46] [config] dropout-src: 0
[2023-07-27 23:01:46] [config] dropout-trg: 0
[2023-07-27 23:01:46] [config] dump-config: ""
[2023-07-27 23:01:46] [config] dynamic-gradient-scaling:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] early-stopping: 1000
[2023-07-27 23:01:46] [config] early-stopping-on: first
[2023-07-27 23:01:46] [config] embedding-fix-src: false
[2023-07-27 23:01:46] [config] embedding-fix-trg: false
[2023-07-27 23:01:46] [config] embedding-normalization: false
[2023-07-27 23:01:46] [config] embedding-vectors:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] enc-cell: gru
[2023-07-27 23:01:46] [config] enc-cell-depth: 1
[2023-07-27 23:01:46] [config] enc-depth: 8
[2023-07-27 23:01:46] [config] enc-type: bidirectional
[2023-07-27 23:01:46] [config] english-title-case-every: 0
[2023-07-27 23:01:46] [config] exponential-smoothing: 0
[2023-07-27 23:01:46] [config] factor-weight: 1
[2023-07-27 23:01:46] [config] factors-combine: sum
[2023-07-27 23:01:46] [config] factors-dim-emb: 0
[2023-07-27 23:01:46] [config] gradient-checkpointing: false
[2023-07-27 23:01:46] [config] gradient-norm-average-window: 100
[2023-07-27 23:01:46] [config] guided-alignment: none
[2023-07-27 23:01:46] [config] guided-alignment-cost: mse
[2023-07-27 23:01:46] [config] guided-alignment-weight: 0.1
[2023-07-27 23:01:46] [config] ignore-model-config: false
[2023-07-27 23:01:46] [config] input-types:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] interpolate-env-vars: false
[2023-07-27 23:01:46] [config] keep-best: false
[2023-07-27 23:01:46] [config] label-smoothing: 0
[2023-07-27 23:01:46] [config] layer-normalization: false
[2023-07-27 23:01:46] [config] learn-rate: 0.0001
[2023-07-27 23:01:46] [config] lemma-dependency: ""
[2023-07-27 23:01:46] [config] lemma-dim-emb: 0
[2023-07-27 23:01:46] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 23:01:46] [config] log-level: info
[2023-07-27 23:01:46] [config] log-time-zone: ""
[2023-07-27 23:01:46] [config] logical-epoch:
[2023-07-27 23:01:46] [config]   - 1e
[2023-07-27 23:01:46] [config]   - 0
[2023-07-27 23:01:46] [config] lr-decay: 0
[2023-07-27 23:01:46] [config] lr-decay-freq: 50000
[2023-07-27 23:01:46] [config] lr-decay-inv-sqrt:
[2023-07-27 23:01:46] [config]   - 0
[2023-07-27 23:01:46] [config] lr-decay-repeat-warmup: false
[2023-07-27 23:01:46] [config] lr-decay-reset-optimizer: false
[2023-07-27 23:01:46] [config] lr-decay-start:
[2023-07-27 23:01:46] [config]   - 10
[2023-07-27 23:01:46] [config]   - 1
[2023-07-27 23:01:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 23:01:46] [config] lr-report: false
[2023-07-27 23:01:46] [config] lr-warmup: 0
[2023-07-27 23:01:46] [config] lr-warmup-at-reload: false
[2023-07-27 23:01:46] [config] lr-warmup-cycle: false
[2023-07-27 23:01:46] [config] lr-warmup-start-rate: 0
[2023-07-27 23:01:46] [config] max-length: 50
[2023-07-27 23:01:46] [config] max-length-crop: true
[2023-07-27 23:01:46] [config] max-length-factor: 3
[2023-07-27 23:01:46] [config] maxi-batch: 100
[2023-07-27 23:01:46] [config] maxi-batch-sort: trg
[2023-07-27 23:01:46] [config] mini-batch: 64
[2023-07-27 23:01:46] [config] mini-batch-fit: true
[2023-07-27 23:01:46] [config] mini-batch-fit-step: 10
[2023-07-27 23:01:46] [config] mini-batch-round-up: true
[2023-07-27 23:01:46] [config] mini-batch-track-lr: false
[2023-07-27 23:01:46] [config] mini-batch-warmup: 0
[2023-07-27 23:01:46] [config] mini-batch-words: 0
[2023-07-27 23:01:46] [config] mini-batch-words-ref: 0
[2023-07-27 23:01:46] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 23:01:46] [config] multi-loss-type: sum
[2023-07-27 23:01:46] [config] n-best: false
[2023-07-27 23:01:46] [config] no-nccl: false
[2023-07-27 23:01:46] [config] no-reload: false
[2023-07-27 23:01:46] [config] no-restore-corpus: false
[2023-07-27 23:01:46] [config] normalize: 0
[2023-07-27 23:01:46] [config] normalize-gradient: false
[2023-07-27 23:01:46] [config] num-devices: 0
[2023-07-27 23:01:46] [config] optimizer: adam
[2023-07-27 23:01:46] [config] optimizer-delay: 1
[2023-07-27 23:01:46] [config] optimizer-params:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] output-omit-bias: false
[2023-07-27 23:01:46] [config] overwrite: true
[2023-07-27 23:01:46] [config] precision:
[2023-07-27 23:01:46] [config]   - float16
[2023-07-27 23:01:46] [config]   - float32
[2023-07-27 23:01:46] [config] pretrained-model: ""
[2023-07-27 23:01:46] [config] quantize-biases: false
[2023-07-27 23:01:46] [config] quantize-bits: 0
[2023-07-27 23:01:46] [config] quantize-log-based: false
[2023-07-27 23:01:46] [config] quantize-optimization-steps: 0
[2023-07-27 23:01:46] [config] quiet: false
[2023-07-27 23:01:46] [config] quiet-translation: true
[2023-07-27 23:01:46] [config] relative-paths: false
[2023-07-27 23:01:46] [config] right-left: false
[2023-07-27 23:01:46] [config] save-freq: 10000u
[2023-07-27 23:01:46] [config] seed: 1234
[2023-07-27 23:01:46] [config] sentencepiece-alphas:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] sentencepiece-max-lines: 2000000
[2023-07-27 23:01:46] [config] sentencepiece-options: ""
[2023-07-27 23:01:46] [config] sharding: global
[2023-07-27 23:01:46] [config] shuffle: data
[2023-07-27 23:01:46] [config] shuffle-in-ram: false
[2023-07-27 23:01:46] [config] sigterm: save-and-exit
[2023-07-27 23:01:46] [config] skip: false
[2023-07-27 23:01:46] [config] sqlite: ""
[2023-07-27 23:01:46] [config] sqlite-drop: false
[2023-07-27 23:01:46] [config] sync-freq: 200u
[2023-07-27 23:01:46] [config] sync-sgd: false
[2023-07-27 23:01:46] [config] tempdir: /tmp
[2023-07-27 23:01:46] [config] tied-embeddings: false
[2023-07-27 23:01:46] [config] tied-embeddings-all: true
[2023-07-27 23:01:46] [config] tied-embeddings-src: false
[2023-07-27 23:01:46] [config] train-embedder-rank:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] train-sets:
[2023-07-27 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 23:01:46] [config] transformer-aan-activation: swish
[2023-07-27 23:01:46] [config] transformer-aan-depth: 2
[2023-07-27 23:01:46] [config] transformer-aan-nogate: false
[2023-07-27 23:01:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 23:01:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 23:01:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 23:01:46] [config] transformer-depth-scaling: false
[2023-07-27 23:01:46] [config] transformer-dim-aan: 2048
[2023-07-27 23:01:46] [config] transformer-dim-ffn: 2048
[2023-07-27 23:01:46] [config] transformer-dropout: 0
[2023-07-27 23:01:46] [config] transformer-dropout-attention: 0
[2023-07-27 23:01:46] [config] transformer-dropout-ffn: 0
[2023-07-27 23:01:46] [config] transformer-ffn-activation: swish
[2023-07-27 23:01:46] [config] transformer-ffn-depth: 2
[2023-07-27 23:01:46] [config] transformer-guided-alignment-layer: last
[2023-07-27 23:01:46] [config] transformer-heads: 8
[2023-07-27 23:01:46] [config] transformer-no-projection: false
[2023-07-27 23:01:46] [config] transformer-pool: false
[2023-07-27 23:01:46] [config] transformer-postprocess: dan
[2023-07-27 23:01:46] [config] transformer-postprocess-emb: d
[2023-07-27 23:01:46] [config] transformer-postprocess-top: ""
[2023-07-27 23:01:46] [config] transformer-preprocess: ""
[2023-07-27 23:01:46] [config] transformer-tied-layers:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] transformer-train-position-embeddings: false
[2023-07-27 23:01:46] [config] tsv: false
[2023-07-27 23:01:46] [config] tsv-fields: 0
[2023-07-27 23:01:46] [config] type: s2s
[2023-07-27 23:01:46] [config] ulr: false
[2023-07-27 23:01:46] [config] ulr-dim-emb: 0
[2023-07-27 23:01:46] [config] ulr-dropout: 0
[2023-07-27 23:01:46] [config] ulr-keys-vectors: ""
[2023-07-27 23:01:46] [config] ulr-query-vectors: ""
[2023-07-27 23:01:46] [config] ulr-softmax-temperature: 1
[2023-07-27 23:01:46] [config] ulr-trainable-transformation: false
[2023-07-27 23:01:46] [config] unlikelihood-loss: false
[2023-07-27 23:01:46] [config] valid-freq: 50000000
[2023-07-27 23:01:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 23:01:46] [config] valid-max-length: 1000
[2023-07-27 23:01:46] [config] valid-metrics:
[2023-07-27 23:01:46] [config]   - translation
[2023-07-27 23:01:46] [config] valid-mini-batch: 32
[2023-07-27 23:01:46] [config] valid-reset-stalled: false
[2023-07-27 23:01:46] [config] valid-script-args:
[2023-07-27 23:01:46] [config]   []
[2023-07-27 23:01:46] [config] valid-script-path: ""
[2023-07-27 23:01:46] [config] valid-sets:
[2023-07-27 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 23:01:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 23:01:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:01:46] [config] vocabs:
[2023-07-27 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:01:46] [config] word-penalty: 0
[2023-07-27 23:01:46] [config] word-scores: false
[2023-07-27 23:01:46] [config] workspace: 5500
[2023-07-27 23:01:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:01:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:01:46] [training] Using single-device training
[2023-07-27 23:01:47] Synced seed 1234
[2023-07-27 23:01:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:01:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 23:01:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:01:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 23:01:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 23:01:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:01:47] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 23:01:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 23:01:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 23:01:48] [comm] Using global sharding
[2023-07-27 23:01:48] [comm] NCCLCommunicators constructed successfully
[2023-07-27 23:01:48] [training] Using 1 GPUs
[2023-07-27 23:01:48] [logits] Applying loss function for 1 factor(s)
[2023-07-27 23:01:48] [memory] Reserving 332 MB, device gpu0
[2023-07-27 23:01:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 23:01:49] [memory] Reserving 332 MB, device gpu0
[2023-07-27 23:03:21] [batching] Done. Typical MB size is 10,814 target words
[2023-07-27 23:03:21] [valid] No post-processing script given for validating translator
[2023-07-27 23:03:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:03:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 23:03:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 23:03:22] [comm] Using global sharding
[2023-07-27 23:03:22] [comm] NCCLCommunicators constructed successfully
[2023-07-27 23:03:22] [training] Using 1 GPUs
[2023-07-27 23:03:22] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 23:03:27] Allocating memory for general optimizer shards
[2023-07-27 23:03:27] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 23:03:27] Loading Adam parameters
[2023-07-27 23:03:27] [memory] Reserving 1330 MB, device gpu0
[2023-07-27 23:03:27] [memory] Reserving 332 MB, device gpu0
[2023-07-27 23:03:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 23:03:29] [data] Restoring the corpus state to epoch 231, batch 18519
[2023-07-27 23:03:29] [data] Shuffling data
[2023-07-27 23:03:29] [data] Done reading 20,192 sentences
[2023-07-27 23:03:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:03:29] Training started
[2023-07-27 23:03:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 23:03:30] [memory] Reserving 332 MB, device gpu0
[2023-07-27 23:03:32] Parameter type float16, optimization type float32, casting types true
[2023-07-27 23:06:31] Seen 20,192 samples
[2023-07-27 23:06:31] Starting data epoch 232 in logical epoch 232
[2023-07-27 23:06:31] [data] Shuffling data
[2023-07-27 23:06:31] [data] Done reading 20,192 sentences
[2023-07-27 23:06:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:09:36] Seen 20,192 samples
[2023-07-27 23:09:36] Starting data epoch 233 in logical epoch 233
[2023-07-27 23:09:36] [data] Shuffling data
[2023-07-27 23:09:36] [data] Done reading 20,192 sentences
[2023-07-27 23:09:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:12:41] Seen 20,192 samples
[2023-07-27 23:12:41] Starting data epoch 234 in logical epoch 234
[2023-07-27 23:12:41] [data] Shuffling data
[2023-07-27 23:12:41] [data] Done reading 20,192 sentences
[2023-07-27 23:12:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:15:46] Seen 20,192 samples
[2023-07-27 23:15:46] Starting data epoch 235 in logical epoch 235
[2023-07-27 23:15:46] [data] Shuffling data
[2023-07-27 23:15:46] [data] Done reading 20,192 sentences
[2023-07-27 23:15:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:18:51] Seen 20,192 samples
[2023-07-27 23:18:51] Starting data epoch 236 in logical epoch 236
[2023-07-27 23:18:51] [data] Shuffling data
[2023-07-27 23:18:51] [data] Done reading 20,192 sentences
[2023-07-27 23:18:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:21:56] Seen 20,192 samples
[2023-07-27 23:21:56] Starting data epoch 237 in logical epoch 237
[2023-07-27 23:21:56] [data] Shuffling data
[2023-07-27 23:21:56] [data] Done reading 20,192 sentences
[2023-07-27 23:21:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:21:59] Ep. 237 : Up. 19000 : Sen. 216 : Cost 0.13002585 * 7,040,481 @ 8,858 after 133,845,874 : Time 1117.80s : 6298.49 words/s : gNorm 0.8594
[2023-07-27 23:25:01] Seen 20,192 samples
[2023-07-27 23:25:01] Starting data epoch 238 in logical epoch 238
[2023-07-27 23:25:01] [data] Shuffling data
[2023-07-27 23:25:01] [data] Done reading 20,192 sentences
[2023-07-27 23:25:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:28:07] Seen 20,192 samples
[2023-07-27 23:28:07] Starting data epoch 239 in logical epoch 239
[2023-07-27 23:28:07] [data] Shuffling data
[2023-07-27 23:28:07] [data] Done reading 20,192 sentences
[2023-07-27 23:28:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:31:12] Seen 20,192 samples
[2023-07-27 23:31:12] Starting data epoch 240 in logical epoch 240
[2023-07-27 23:31:12] [data] Shuffling data
[2023-07-27 23:31:12] [data] Done reading 20,192 sentences
[2023-07-27 23:31:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:34:16] Seen 20,192 samples
[2023-07-27 23:34:16] Starting data epoch 241 in logical epoch 241
[2023-07-27 23:34:16] Training finished
[2023-07-27 23:35:31] [valid] Ep. 241 : Up. 19323 : translation : 0 : new best
[2023-07-27 23:35:31] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz
[2023-07-27 23:35:39] Saving Adam parameters
[2023-07-27 23:35:41] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_enc-depth_8_dec-depth_8.npz.optimizer.npz
[2023-07-27 23:36:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:36:05] [marian] Running on node05.datos.cluster.uy as process 7744 with command line:
[2023-07-27 23:36:05] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-27 23:36:05] [config] after: 0e
[2023-07-27 23:36:05] [config] after-batches: 0
[2023-07-27 23:36:05] [config] after-epochs: 10
[2023-07-27 23:36:05] [config] all-caps-every: 0
[2023-07-27 23:36:05] [config] allow-unk: false
[2023-07-27 23:36:05] [config] authors: false
[2023-07-27 23:36:05] [config] beam-size: 12
[2023-07-27 23:36:05] [config] bert-class-symbol: "[CLS]"
[2023-07-27 23:36:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 23:36:05] [config] bert-masking-fraction: 0.15
[2023-07-27 23:36:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 23:36:05] [config] bert-train-type-embeddings: true
[2023-07-27 23:36:05] [config] bert-type-vocab-size: 2
[2023-07-27 23:36:05] [config] build-info: ""
[2023-07-27 23:36:05] [config] check-gradient-nan: false
[2023-07-27 23:36:05] [config] check-nan: false
[2023-07-27 23:36:05] [config] cite: false
[2023-07-27 23:36:05] [config] clip-norm: 1
[2023-07-27 23:36:05] [config] cost-scaling:
[2023-07-27 23:36:05] [config]   - 256.f
[2023-07-27 23:36:05] [config]   - 1000
[2023-07-27 23:36:05] [config]   - 2.f
[2023-07-27 23:36:05] [config]   - 256.f
[2023-07-27 23:36:05] [config] cost-type: ce-sum
[2023-07-27 23:36:05] [config] cpu-threads: 0
[2023-07-27 23:36:05] [config] data-threads: 8
[2023-07-27 23:36:05] [config] data-weighting: ""
[2023-07-27 23:36:05] [config] data-weighting-type: sentence
[2023-07-27 23:36:05] [config] dec-cell: gru
[2023-07-27 23:36:05] [config] dec-cell-base-depth: 2
[2023-07-27 23:36:05] [config] dec-cell-high-depth: 1
[2023-07-27 23:36:05] [config] dec-depth: 1
[2023-07-27 23:36:05] [config] devices:
[2023-07-27 23:36:05] [config]   - 0
[2023-07-27 23:36:05] [config] dim-emb: 512
[2023-07-27 23:36:05] [config] dim-rnn: 1024
[2023-07-27 23:36:05] [config] dim-vocabs:
[2023-07-27 23:36:05] [config]   - 16384
[2023-07-27 23:36:05] [config]   - 16384
[2023-07-27 23:36:05] [config] disp-first: 0
[2023-07-27 23:36:05] [config] disp-freq: 1000u
[2023-07-27 23:36:05] [config] disp-label-counts: true
[2023-07-27 23:36:05] [config] dropout-rnn: 0
[2023-07-27 23:36:05] [config] dropout-src: 0
[2023-07-27 23:36:05] [config] dropout-trg: 0
[2023-07-27 23:36:05] [config] dump-config: ""
[2023-07-27 23:36:05] [config] dynamic-gradient-scaling:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] early-stopping: 1000
[2023-07-27 23:36:05] [config] early-stopping-on: first
[2023-07-27 23:36:05] [config] embedding-fix-src: false
[2023-07-27 23:36:05] [config] embedding-fix-trg: false
[2023-07-27 23:36:05] [config] embedding-normalization: false
[2023-07-27 23:36:05] [config] embedding-vectors:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] enc-cell: gru
[2023-07-27 23:36:05] [config] enc-cell-depth: 1
[2023-07-27 23:36:05] [config] enc-depth: 1
[2023-07-27 23:36:05] [config] enc-type: bidirectional
[2023-07-27 23:36:05] [config] english-title-case-every: 0
[2023-07-27 23:36:05] [config] exponential-smoothing: 0
[2023-07-27 23:36:05] [config] factor-weight: 1
[2023-07-27 23:36:05] [config] factors-combine: sum
[2023-07-27 23:36:05] [config] factors-dim-emb: 0
[2023-07-27 23:36:05] [config] gradient-checkpointing: false
[2023-07-27 23:36:05] [config] gradient-norm-average-window: 100
[2023-07-27 23:36:05] [config] guided-alignment: none
[2023-07-27 23:36:05] [config] guided-alignment-cost: mse
[2023-07-27 23:36:05] [config] guided-alignment-weight: 0.1
[2023-07-27 23:36:05] [config] ignore-model-config: false
[2023-07-27 23:36:05] [config] input-types:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] interpolate-env-vars: false
[2023-07-27 23:36:05] [config] keep-best: false
[2023-07-27 23:36:05] [config] label-smoothing: 0
[2023-07-27 23:36:05] [config] layer-normalization: false
[2023-07-27 23:36:05] [config] learn-rate: 0.0001
[2023-07-27 23:36:05] [config] lemma-dependency: ""
[2023-07-27 23:36:05] [config] lemma-dim-emb: 0
[2023-07-27 23:36:05] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 23:36:05] [config] log-level: info
[2023-07-27 23:36:05] [config] log-time-zone: ""
[2023-07-27 23:36:05] [config] logical-epoch:
[2023-07-27 23:36:05] [config]   - 1e
[2023-07-27 23:36:05] [config]   - 0
[2023-07-27 23:36:05] [config] lr-decay: 0
[2023-07-27 23:36:05] [config] lr-decay-freq: 50000
[2023-07-27 23:36:05] [config] lr-decay-inv-sqrt:
[2023-07-27 23:36:05] [config]   - 0
[2023-07-27 23:36:05] [config] lr-decay-repeat-warmup: false
[2023-07-27 23:36:05] [config] lr-decay-reset-optimizer: false
[2023-07-27 23:36:05] [config] lr-decay-start:
[2023-07-27 23:36:05] [config]   - 10
[2023-07-27 23:36:05] [config]   - 1
[2023-07-27 23:36:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 23:36:05] [config] lr-report: false
[2023-07-27 23:36:05] [config] lr-warmup: 0
[2023-07-27 23:36:05] [config] lr-warmup-at-reload: false
[2023-07-27 23:36:05] [config] lr-warmup-cycle: false
[2023-07-27 23:36:05] [config] lr-warmup-start-rate: 0
[2023-07-27 23:36:05] [config] max-length: 50
[2023-07-27 23:36:05] [config] max-length-crop: true
[2023-07-27 23:36:05] [config] max-length-factor: 3
[2023-07-27 23:36:05] [config] maxi-batch: 100
[2023-07-27 23:36:05] [config] maxi-batch-sort: trg
[2023-07-27 23:36:05] [config] mini-batch: 64
[2023-07-27 23:36:05] [config] mini-batch-fit: true
[2023-07-27 23:36:05] [config] mini-batch-fit-step: 10
[2023-07-27 23:36:05] [config] mini-batch-round-up: true
[2023-07-27 23:36:05] [config] mini-batch-track-lr: false
[2023-07-27 23:36:05] [config] mini-batch-warmup: 0
[2023-07-27 23:36:05] [config] mini-batch-words: 0
[2023-07-27 23:36:05] [config] mini-batch-words-ref: 0
[2023-07-27 23:36:05] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-27 23:36:05] [config] multi-loss-type: sum
[2023-07-27 23:36:05] [config] n-best: false
[2023-07-27 23:36:05] [config] no-nccl: false
[2023-07-27 23:36:05] [config] no-reload: false
[2023-07-27 23:36:05] [config] no-restore-corpus: false
[2023-07-27 23:36:05] [config] normalize: 0
[2023-07-27 23:36:05] [config] normalize-gradient: false
[2023-07-27 23:36:05] [config] num-devices: 0
[2023-07-27 23:36:05] [config] optimizer: adam
[2023-07-27 23:36:05] [config] optimizer-delay: 1
[2023-07-27 23:36:05] [config] optimizer-params:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] output-omit-bias: false
[2023-07-27 23:36:05] [config] overwrite: true
[2023-07-27 23:36:05] [config] precision:
[2023-07-27 23:36:05] [config]   - float16
[2023-07-27 23:36:05] [config]   - float32
[2023-07-27 23:36:05] [config] pretrained-model: ""
[2023-07-27 23:36:05] [config] quantize-biases: false
[2023-07-27 23:36:05] [config] quantize-bits: 0
[2023-07-27 23:36:05] [config] quantize-log-based: false
[2023-07-27 23:36:05] [config] quantize-optimization-steps: 0
[2023-07-27 23:36:05] [config] quiet: false
[2023-07-27 23:36:05] [config] quiet-translation: true
[2023-07-27 23:36:05] [config] relative-paths: false
[2023-07-27 23:36:05] [config] right-left: false
[2023-07-27 23:36:05] [config] save-freq: 10000u
[2023-07-27 23:36:05] [config] seed: 1234
[2023-07-27 23:36:05] [config] sentencepiece-alphas:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] sentencepiece-max-lines: 2000000
[2023-07-27 23:36:05] [config] sentencepiece-options: ""
[2023-07-27 23:36:05] [config] sharding: global
[2023-07-27 23:36:05] [config] shuffle: data
[2023-07-27 23:36:05] [config] shuffle-in-ram: false
[2023-07-27 23:36:05] [config] sigterm: save-and-exit
[2023-07-27 23:36:05] [config] skip: false
[2023-07-27 23:36:05] [config] sqlite: ""
[2023-07-27 23:36:05] [config] sqlite-drop: false
[2023-07-27 23:36:05] [config] sync-freq: 200u
[2023-07-27 23:36:05] [config] sync-sgd: false
[2023-07-27 23:36:05] [config] tempdir: /tmp
[2023-07-27 23:36:05] [config] tied-embeddings: false
[2023-07-27 23:36:05] [config] tied-embeddings-all: true
[2023-07-27 23:36:05] [config] tied-embeddings-src: false
[2023-07-27 23:36:05] [config] train-embedder-rank:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] train-sets:
[2023-07-27 23:36:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 23:36:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 23:36:05] [config] transformer-aan-activation: swish
[2023-07-27 23:36:05] [config] transformer-aan-depth: 2
[2023-07-27 23:36:05] [config] transformer-aan-nogate: false
[2023-07-27 23:36:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 23:36:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 23:36:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 23:36:05] [config] transformer-depth-scaling: false
[2023-07-27 23:36:05] [config] transformer-dim-aan: 2048
[2023-07-27 23:36:05] [config] transformer-dim-ffn: 2048
[2023-07-27 23:36:05] [config] transformer-dropout: 0
[2023-07-27 23:36:05] [config] transformer-dropout-attention: 0
[2023-07-27 23:36:05] [config] transformer-dropout-ffn: 0
[2023-07-27 23:36:05] [config] transformer-ffn-activation: swish
[2023-07-27 23:36:05] [config] transformer-ffn-depth: 2
[2023-07-27 23:36:05] [config] transformer-guided-alignment-layer: last
[2023-07-27 23:36:05] [config] transformer-heads: 8
[2023-07-27 23:36:05] [config] transformer-no-projection: false
[2023-07-27 23:36:05] [config] transformer-pool: false
[2023-07-27 23:36:05] [config] transformer-postprocess: dan
[2023-07-27 23:36:05] [config] transformer-postprocess-emb: d
[2023-07-27 23:36:05] [config] transformer-postprocess-top: ""
[2023-07-27 23:36:05] [config] transformer-preprocess: ""
[2023-07-27 23:36:05] [config] transformer-tied-layers:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] transformer-train-position-embeddings: false
[2023-07-27 23:36:05] [config] tsv: false
[2023-07-27 23:36:05] [config] tsv-fields: 0
[2023-07-27 23:36:05] [config] type: s2s
[2023-07-27 23:36:05] [config] ulr: false
[2023-07-27 23:36:05] [config] ulr-dim-emb: 0
[2023-07-27 23:36:05] [config] ulr-dropout: 0
[2023-07-27 23:36:05] [config] ulr-keys-vectors: ""
[2023-07-27 23:36:05] [config] ulr-query-vectors: ""
[2023-07-27 23:36:05] [config] ulr-softmax-temperature: 1
[2023-07-27 23:36:05] [config] ulr-trainable-transformation: false
[2023-07-27 23:36:05] [config] unlikelihood-loss: false
[2023-07-27 23:36:05] [config] valid-freq: 50000000
[2023-07-27 23:36:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 23:36:05] [config] valid-max-length: 1000
[2023-07-27 23:36:05] [config] valid-metrics:
[2023-07-27 23:36:05] [config]   - translation
[2023-07-27 23:36:05] [config] valid-mini-batch: 32
[2023-07-27 23:36:05] [config] valid-reset-stalled: false
[2023-07-27 23:36:05] [config] valid-script-args:
[2023-07-27 23:36:05] [config]   []
[2023-07-27 23:36:05] [config] valid-script-path: ""
[2023-07-27 23:36:05] [config] valid-sets:
[2023-07-27 23:36:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 23:36:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 23:36:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 23:36:05] [config] vocabs:
[2023-07-27 23:36:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:36:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:36:05] [config] word-penalty: 0
[2023-07-27 23:36:05] [config] word-scores: false
[2023-07-27 23:36:05] [config] workspace: 5500
[2023-07-27 23:36:05] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:36:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:36:05] [training] Using single-device training
[2023-07-27 23:36:05] Synced seed 1234
[2023-07-27 23:36:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:36:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 23:36:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:36:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 23:36:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 23:36:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:36:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 23:36:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 23:36:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 23:36:06] [comm] Using global sharding
[2023-07-27 23:36:06] [comm] NCCLCommunicators constructed successfully
[2023-07-27 23:36:06] [training] Using 1 GPUs
[2023-07-27 23:36:06] [logits] Applying loss function for 1 factor(s)
[2023-07-27 23:36:06] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:36:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 23:36:06] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:40:35] [batching] Done. Typical MB size is 36,030 target words
[2023-07-27 23:40:35] [valid] No post-processing script given for validating translator
[2023-07-27 23:40:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:40:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 23:40:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 23:40:35] [comm] Using global sharding
[2023-07-27 23:40:35] [comm] NCCLCommunicators constructed successfully
[2023-07-27 23:40:35] [training] Using 1 GPUs
[2023-07-27 23:40:35] Training started
[2023-07-27 23:40:35] [data] Shuffling data
[2023-07-27 23:40:35] [data] Done reading 20,192 sentences
[2023-07-27 23:40:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:40:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 23:40:35] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:40:35] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:40:38] Parameter type float16, optimization type float32, casting types true
[2023-07-27 23:40:38] Allocating memory for general optimizer shards
[2023-07-27 23:40:38] [memory] Reserving 322 MB, device gpu0
[2023-07-27 23:40:38] Allocating memory for Adam-specific shards
[2023-07-27 23:40:38] [memory] Reserving 322 MB, device gpu0
[2023-07-27 23:41:37] Seen 20,192 samples
[2023-07-27 23:41:37] Starting data epoch 2 in logical epoch 2
[2023-07-27 23:41:37] [data] Shuffling data
[2023-07-27 23:41:37] [data] Done reading 20,192 sentences
[2023-07-27 23:41:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:43:05] Seen 20,192 samples
[2023-07-27 23:43:05] Starting data epoch 3 in logical epoch 3
[2023-07-27 23:43:05] [data] Shuffling data
[2023-07-27 23:43:05] [data] Done reading 20,192 sentences
[2023-07-27 23:43:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:44:34] Seen 20,192 samples
[2023-07-27 23:44:34] Starting data epoch 4 in logical epoch 4
[2023-07-27 23:44:34] [data] Shuffling data
[2023-07-27 23:44:34] [data] Done reading 20,192 sentences
[2023-07-27 23:44:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:46:09] Seen 20,192 samples
[2023-07-27 23:46:09] Starting data epoch 5 in logical epoch 5
[2023-07-27 23:46:09] [data] Shuffling data
[2023-07-27 23:46:09] [data] Done reading 20,192 sentences
[2023-07-27 23:46:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:48:08] Seen 20,192 samples
[2023-07-27 23:48:08] Starting data epoch 6 in logical epoch 6
[2023-07-27 23:48:08] [data] Shuffling data
[2023-07-27 23:48:08] [data] Done reading 20,192 sentences
[2023-07-27 23:48:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:50:20] Seen 20,192 samples
[2023-07-27 23:50:20] Starting data epoch 7 in logical epoch 7
[2023-07-27 23:50:20] [data] Shuffling data
[2023-07-27 23:50:20] [data] Done reading 20,192 sentences
[2023-07-27 23:50:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:52:17] Seen 20,192 samples
[2023-07-27 23:52:17] Starting data epoch 8 in logical epoch 8
[2023-07-27 23:52:17] [data] Shuffling data
[2023-07-27 23:52:17] [data] Done reading 20,192 sentences
[2023-07-27 23:52:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:54:19] Seen 20,192 samples
[2023-07-27 23:54:19] Starting data epoch 9 in logical epoch 9
[2023-07-27 23:54:19] [data] Shuffling data
[2023-07-27 23:54:19] [data] Done reading 20,192 sentences
[2023-07-27 23:54:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:56:24] Seen 20,192 samples
[2023-07-27 23:56:24] Starting data epoch 10 in logical epoch 10
[2023-07-27 23:56:24] [data] Shuffling data
[2023-07-27 23:56:24] [data] Done reading 20,192 sentences
[2023-07-27 23:56:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:58:23] Seen 20,192 samples
[2023-07-27 23:58:23] Starting data epoch 11 in logical epoch 11
[2023-07-27 23:58:23] Training finished
[2023-07-27 23:58:50] [valid] Ep. 11 : Up. 275 : translation : 0 : new best
[2023-07-27 23:58:50] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-27 23:58:52] Saving Adam parameters
[2023-07-27 23:58:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-27 23:58:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:58:59] [marian] Running on node05.datos.cluster.uy as process 9314 with command line:
[2023-07-27 23:58:59] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-27 23:58:59] [config] after: 0e
[2023-07-27 23:58:59] [config] after-batches: 0
[2023-07-27 23:58:59] [config] after-epochs: 20
[2023-07-27 23:58:59] [config] all-caps-every: 0
[2023-07-27 23:58:59] [config] allow-unk: false
[2023-07-27 23:58:59] [config] authors: false
[2023-07-27 23:58:59] [config] beam-size: 12
[2023-07-27 23:58:59] [config] bert-class-symbol: "[CLS]"
[2023-07-27 23:58:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 23:58:59] [config] bert-masking-fraction: 0.15
[2023-07-27 23:58:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 23:58:59] [config] bert-train-type-embeddings: true
[2023-07-27 23:58:59] [config] bert-type-vocab-size: 2
[2023-07-27 23:58:59] [config] build-info: ""
[2023-07-27 23:58:59] [config] check-gradient-nan: false
[2023-07-27 23:58:59] [config] check-nan: false
[2023-07-27 23:58:59] [config] cite: false
[2023-07-27 23:58:59] [config] clip-norm: 1
[2023-07-27 23:58:59] [config] cost-scaling:
[2023-07-27 23:58:59] [config]   - 256.f
[2023-07-27 23:58:59] [config]   - 1000
[2023-07-27 23:58:59] [config]   - 2.f
[2023-07-27 23:58:59] [config]   - 256.f
[2023-07-27 23:58:59] [config] cost-type: ce-sum
[2023-07-27 23:58:59] [config] cpu-threads: 0
[2023-07-27 23:58:59] [config] data-threads: 8
[2023-07-27 23:58:59] [config] data-weighting: ""
[2023-07-27 23:58:59] [config] data-weighting-type: sentence
[2023-07-27 23:58:59] [config] dec-cell: gru
[2023-07-27 23:58:59] [config] dec-cell-base-depth: 2
[2023-07-27 23:58:59] [config] dec-cell-high-depth: 1
[2023-07-27 23:58:59] [config] dec-depth: 1
[2023-07-27 23:58:59] [config] devices:
[2023-07-27 23:58:59] [config]   - 0
[2023-07-27 23:58:59] [config] dim-emb: 512
[2023-07-27 23:58:59] [config] dim-rnn: 1024
[2023-07-27 23:58:59] [config] dim-vocabs:
[2023-07-27 23:58:59] [config]   - 16384
[2023-07-27 23:58:59] [config]   - 16384
[2023-07-27 23:58:59] [config] disp-first: 0
[2023-07-27 23:58:59] [config] disp-freq: 1000u
[2023-07-27 23:58:59] [config] disp-label-counts: true
[2023-07-27 23:58:59] [config] dropout-rnn: 0
[2023-07-27 23:58:59] [config] dropout-src: 0
[2023-07-27 23:58:59] [config] dropout-trg: 0
[2023-07-27 23:58:59] [config] dump-config: ""
[2023-07-27 23:58:59] [config] dynamic-gradient-scaling:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] early-stopping: 1000
[2023-07-27 23:58:59] [config] early-stopping-on: first
[2023-07-27 23:58:59] [config] embedding-fix-src: false
[2023-07-27 23:58:59] [config] embedding-fix-trg: false
[2023-07-27 23:58:59] [config] embedding-normalization: false
[2023-07-27 23:58:59] [config] embedding-vectors:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] enc-cell: gru
[2023-07-27 23:58:59] [config] enc-cell-depth: 1
[2023-07-27 23:58:59] [config] enc-depth: 1
[2023-07-27 23:58:59] [config] enc-type: bidirectional
[2023-07-27 23:58:59] [config] english-title-case-every: 0
[2023-07-27 23:58:59] [config] exponential-smoothing: 0
[2023-07-27 23:58:59] [config] factor-weight: 1
[2023-07-27 23:58:59] [config] factors-combine: sum
[2023-07-27 23:58:59] [config] factors-dim-emb: 0
[2023-07-27 23:58:59] [config] gradient-checkpointing: false
[2023-07-27 23:58:59] [config] gradient-norm-average-window: 100
[2023-07-27 23:58:59] [config] guided-alignment: none
[2023-07-27 23:58:59] [config] guided-alignment-cost: mse
[2023-07-27 23:58:59] [config] guided-alignment-weight: 0.1
[2023-07-27 23:58:59] [config] ignore-model-config: false
[2023-07-27 23:58:59] [config] input-types:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] interpolate-env-vars: false
[2023-07-27 23:58:59] [config] keep-best: false
[2023-07-27 23:58:59] [config] label-smoothing: 0
[2023-07-27 23:58:59] [config] layer-normalization: false
[2023-07-27 23:58:59] [config] learn-rate: 0.0001
[2023-07-27 23:58:59] [config] lemma-dependency: ""
[2023-07-27 23:58:59] [config] lemma-dim-emb: 0
[2023-07-27 23:58:59] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 23:58:59] [config] log-level: info
[2023-07-27 23:58:59] [config] log-time-zone: ""
[2023-07-27 23:58:59] [config] logical-epoch:
[2023-07-27 23:58:59] [config]   - 1e
[2023-07-27 23:58:59] [config]   - 0
[2023-07-27 23:58:59] [config] lr-decay: 0
[2023-07-27 23:58:59] [config] lr-decay-freq: 50000
[2023-07-27 23:58:59] [config] lr-decay-inv-sqrt:
[2023-07-27 23:58:59] [config]   - 0
[2023-07-27 23:58:59] [config] lr-decay-repeat-warmup: false
[2023-07-27 23:58:59] [config] lr-decay-reset-optimizer: false
[2023-07-27 23:58:59] [config] lr-decay-start:
[2023-07-27 23:58:59] [config]   - 10
[2023-07-27 23:58:59] [config]   - 1
[2023-07-27 23:58:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 23:58:59] [config] lr-report: false
[2023-07-27 23:58:59] [config] lr-warmup: 0
[2023-07-27 23:58:59] [config] lr-warmup-at-reload: false
[2023-07-27 23:58:59] [config] lr-warmup-cycle: false
[2023-07-27 23:58:59] [config] lr-warmup-start-rate: 0
[2023-07-27 23:58:59] [config] max-length: 50
[2023-07-27 23:58:59] [config] max-length-crop: true
[2023-07-27 23:58:59] [config] max-length-factor: 3
[2023-07-27 23:58:59] [config] maxi-batch: 100
[2023-07-27 23:58:59] [config] maxi-batch-sort: trg
[2023-07-27 23:58:59] [config] mini-batch: 64
[2023-07-27 23:58:59] [config] mini-batch-fit: true
[2023-07-27 23:58:59] [config] mini-batch-fit-step: 10
[2023-07-27 23:58:59] [config] mini-batch-round-up: true
[2023-07-27 23:58:59] [config] mini-batch-track-lr: false
[2023-07-27 23:58:59] [config] mini-batch-warmup: 0
[2023-07-27 23:58:59] [config] mini-batch-words: 0
[2023-07-27 23:58:59] [config] mini-batch-words-ref: 0
[2023-07-27 23:58:59] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-27 23:58:59] [config] multi-loss-type: sum
[2023-07-27 23:58:59] [config] n-best: false
[2023-07-27 23:58:59] [config] no-nccl: false
[2023-07-27 23:58:59] [config] no-reload: false
[2023-07-27 23:58:59] [config] no-restore-corpus: false
[2023-07-27 23:58:59] [config] normalize: 0
[2023-07-27 23:58:59] [config] normalize-gradient: false
[2023-07-27 23:58:59] [config] num-devices: 0
[2023-07-27 23:58:59] [config] optimizer: adam
[2023-07-27 23:58:59] [config] optimizer-delay: 1
[2023-07-27 23:58:59] [config] optimizer-params:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] output-omit-bias: false
[2023-07-27 23:58:59] [config] overwrite: true
[2023-07-27 23:58:59] [config] precision:
[2023-07-27 23:58:59] [config]   - float16
[2023-07-27 23:58:59] [config]   - float32
[2023-07-27 23:58:59] [config] pretrained-model: ""
[2023-07-27 23:58:59] [config] quantize-biases: false
[2023-07-27 23:58:59] [config] quantize-bits: 0
[2023-07-27 23:58:59] [config] quantize-log-based: false
[2023-07-27 23:58:59] [config] quantize-optimization-steps: 0
[2023-07-27 23:58:59] [config] quiet: false
[2023-07-27 23:58:59] [config] quiet-translation: true
[2023-07-27 23:58:59] [config] relative-paths: false
[2023-07-27 23:58:59] [config] right-left: false
[2023-07-27 23:58:59] [config] save-freq: 10000u
[2023-07-27 23:58:59] [config] seed: 1234
[2023-07-27 23:58:59] [config] sentencepiece-alphas:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] sentencepiece-max-lines: 2000000
[2023-07-27 23:58:59] [config] sentencepiece-options: ""
[2023-07-27 23:58:59] [config] sharding: global
[2023-07-27 23:58:59] [config] shuffle: data
[2023-07-27 23:58:59] [config] shuffle-in-ram: false
[2023-07-27 23:58:59] [config] sigterm: save-and-exit
[2023-07-27 23:58:59] [config] skip: false
[2023-07-27 23:58:59] [config] sqlite: ""
[2023-07-27 23:58:59] [config] sqlite-drop: false
[2023-07-27 23:58:59] [config] sync-freq: 200u
[2023-07-27 23:58:59] [config] sync-sgd: false
[2023-07-27 23:58:59] [config] tempdir: /tmp
[2023-07-27 23:58:59] [config] tied-embeddings: false
[2023-07-27 23:58:59] [config] tied-embeddings-all: true
[2023-07-27 23:58:59] [config] tied-embeddings-src: false
[2023-07-27 23:58:59] [config] train-embedder-rank:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] train-sets:
[2023-07-27 23:58:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 23:58:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 23:58:59] [config] transformer-aan-activation: swish
[2023-07-27 23:58:59] [config] transformer-aan-depth: 2
[2023-07-27 23:58:59] [config] transformer-aan-nogate: false
[2023-07-27 23:58:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 23:58:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 23:58:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 23:58:59] [config] transformer-depth-scaling: false
[2023-07-27 23:58:59] [config] transformer-dim-aan: 2048
[2023-07-27 23:58:59] [config] transformer-dim-ffn: 2048
[2023-07-27 23:58:59] [config] transformer-dropout: 0
[2023-07-27 23:58:59] [config] transformer-dropout-attention: 0
[2023-07-27 23:58:59] [config] transformer-dropout-ffn: 0
[2023-07-27 23:58:59] [config] transformer-ffn-activation: swish
[2023-07-27 23:58:59] [config] transformer-ffn-depth: 2
[2023-07-27 23:58:59] [config] transformer-guided-alignment-layer: last
[2023-07-27 23:58:59] [config] transformer-heads: 8
[2023-07-27 23:58:59] [config] transformer-no-projection: false
[2023-07-27 23:58:59] [config] transformer-pool: false
[2023-07-27 23:58:59] [config] transformer-postprocess: dan
[2023-07-27 23:58:59] [config] transformer-postprocess-emb: d
[2023-07-27 23:58:59] [config] transformer-postprocess-top: ""
[2023-07-27 23:58:59] [config] transformer-preprocess: ""
[2023-07-27 23:58:59] [config] transformer-tied-layers:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] transformer-train-position-embeddings: false
[2023-07-27 23:58:59] [config] tsv: false
[2023-07-27 23:58:59] [config] tsv-fields: 0
[2023-07-27 23:58:59] [config] type: s2s
[2023-07-27 23:58:59] [config] ulr: false
[2023-07-27 23:58:59] [config] ulr-dim-emb: 0
[2023-07-27 23:58:59] [config] ulr-dropout: 0
[2023-07-27 23:58:59] [config] ulr-keys-vectors: ""
[2023-07-27 23:58:59] [config] ulr-query-vectors: ""
[2023-07-27 23:58:59] [config] ulr-softmax-temperature: 1
[2023-07-27 23:58:59] [config] ulr-trainable-transformation: false
[2023-07-27 23:58:59] [config] unlikelihood-loss: false
[2023-07-27 23:58:59] [config] valid-freq: 50000000
[2023-07-27 23:58:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-27 23:58:59] [config] valid-max-length: 1000
[2023-07-27 23:58:59] [config] valid-metrics:
[2023-07-27 23:58:59] [config]   - translation
[2023-07-27 23:58:59] [config] valid-mini-batch: 32
[2023-07-27 23:58:59] [config] valid-reset-stalled: false
[2023-07-27 23:58:59] [config] valid-script-args:
[2023-07-27 23:58:59] [config]   []
[2023-07-27 23:58:59] [config] valid-script-path: ""
[2023-07-27 23:58:59] [config] valid-sets:
[2023-07-27 23:58:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 23:58:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 23:58:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-27 23:58:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:58:59] [config] vocabs:
[2023-07-27 23:58:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:58:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:58:59] [config] word-penalty: 0
[2023-07-27 23:58:59] [config] word-scores: false
[2023-07-27 23:58:59] [config] workspace: 5500
[2023-07-27 23:58:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:58:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:58:59] [training] Using single-device training
[2023-07-27 23:58:59] Synced seed 1234
[2023-07-27 23:58:59] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:58:59] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 23:58:59] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:58:59] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 23:58:59] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 23:58:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:58:59] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 23:59:00] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 23:59:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 23:59:00] [comm] Using global sharding
[2023-07-27 23:59:00] [comm] NCCLCommunicators constructed successfully
[2023-07-27 23:59:00] [training] Using 1 GPUs
[2023-07-27 23:59:00] [logits] Applying loss function for 1 factor(s)
[2023-07-27 23:59:00] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:59:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 23:59:00] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:03:31] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 00:03:31] [valid] No post-processing script given for validating translator
[2023-07-28 00:03:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:03:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 00:03:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 00:03:31] [comm] Using global sharding
[2023-07-28 00:03:31] [comm] NCCLCommunicators constructed successfully
[2023-07-28 00:03:31] [training] Using 1 GPUs
[2023-07-28 00:03:31] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 00:03:32] Allocating memory for general optimizer shards
[2023-07-28 00:03:32] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:03:32] Loading Adam parameters
[2023-07-28 00:03:32] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:03:33] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:03:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 00:03:33] [data] Restoring the corpus state to epoch 11, batch 275
[2023-07-28 00:03:33] [data] Shuffling data
[2023-07-28 00:03:34] [data] Done reading 20,192 sentences
[2023-07-28 00:03:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:03:34] Training started
[2023-07-28 00:03:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 00:03:35] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:03:42] Parameter type float16, optimization type float32, casting types true
[2023-07-28 00:05:18] Seen 20,192 samples
[2023-07-28 00:05:18] Starting data epoch 12 in logical epoch 12
[2023-07-28 00:05:18] [data] Shuffling data
[2023-07-28 00:05:18] [data] Done reading 20,192 sentences
[2023-07-28 00:05:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:07:10] Seen 20,192 samples
[2023-07-28 00:07:10] Starting data epoch 13 in logical epoch 13
[2023-07-28 00:07:10] [data] Shuffling data
[2023-07-28 00:07:10] [data] Done reading 20,192 sentences
[2023-07-28 00:07:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:08:55] Seen 20,192 samples
[2023-07-28 00:08:55] Starting data epoch 14 in logical epoch 14
[2023-07-28 00:08:55] [data] Shuffling data
[2023-07-28 00:08:55] [data] Done reading 20,192 sentences
[2023-07-28 00:08:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:10:43] Seen 20,192 samples
[2023-07-28 00:10:43] Starting data epoch 15 in logical epoch 15
[2023-07-28 00:10:43] [data] Shuffling data
[2023-07-28 00:10:43] [data] Done reading 20,192 sentences
[2023-07-28 00:10:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:12:21] Seen 20,192 samples
[2023-07-28 00:12:21] Starting data epoch 16 in logical epoch 16
[2023-07-28 00:12:21] [data] Shuffling data
[2023-07-28 00:12:21] [data] Done reading 20,192 sentences
[2023-07-28 00:12:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:14:01] Seen 20,192 samples
[2023-07-28 00:14:01] Starting data epoch 17 in logical epoch 17
[2023-07-28 00:14:01] [data] Shuffling data
[2023-07-28 00:14:01] [data] Done reading 20,192 sentences
[2023-07-28 00:14:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:15:28] Seen 20,192 samples
[2023-07-28 00:15:28] Starting data epoch 18 in logical epoch 18
[2023-07-28 00:15:28] [data] Shuffling data
[2023-07-28 00:15:28] [data] Done reading 20,192 sentences
[2023-07-28 00:15:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:17:04] Seen 20,192 samples
[2023-07-28 00:17:04] Starting data epoch 19 in logical epoch 19
[2023-07-28 00:17:04] [data] Shuffling data
[2023-07-28 00:17:04] [data] Done reading 20,192 sentences
[2023-07-28 00:17:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:18:43] Seen 20,192 samples
[2023-07-28 00:18:43] Starting data epoch 20 in logical epoch 20
[2023-07-28 00:18:43] [data] Shuffling data
[2023-07-28 00:18:43] [data] Done reading 20,192 sentences
[2023-07-28 00:18:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:20:21] Seen 20,192 samples
[2023-07-28 00:20:21] Starting data epoch 21 in logical epoch 21
[2023-07-28 00:20:21] Training finished
[2023-07-28 00:21:27] [valid] Ep. 21 : Up. 549 : translation : 0 : new best
[2023-07-28 00:21:27] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 00:21:29] Saving Adam parameters
[2023-07-28 00:21:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 00:21:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 00:21:36] [marian] Running on node05.datos.cluster.uy as process 10568 with command line:
[2023-07-28 00:21:36] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 00:21:36] [config] after: 0e
[2023-07-28 00:21:36] [config] after-batches: 0
[2023-07-28 00:21:36] [config] after-epochs: 30
[2023-07-28 00:21:36] [config] all-caps-every: 0
[2023-07-28 00:21:36] [config] allow-unk: false
[2023-07-28 00:21:36] [config] authors: false
[2023-07-28 00:21:36] [config] beam-size: 12
[2023-07-28 00:21:36] [config] bert-class-symbol: "[CLS]"
[2023-07-28 00:21:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 00:21:36] [config] bert-masking-fraction: 0.15
[2023-07-28 00:21:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 00:21:36] [config] bert-train-type-embeddings: true
[2023-07-28 00:21:36] [config] bert-type-vocab-size: 2
[2023-07-28 00:21:36] [config] build-info: ""
[2023-07-28 00:21:36] [config] check-gradient-nan: false
[2023-07-28 00:21:36] [config] check-nan: false
[2023-07-28 00:21:36] [config] cite: false
[2023-07-28 00:21:36] [config] clip-norm: 1
[2023-07-28 00:21:36] [config] cost-scaling:
[2023-07-28 00:21:36] [config]   - 256.f
[2023-07-28 00:21:36] [config]   - 1000
[2023-07-28 00:21:36] [config]   - 2.f
[2023-07-28 00:21:36] [config]   - 256.f
[2023-07-28 00:21:36] [config] cost-type: ce-sum
[2023-07-28 00:21:36] [config] cpu-threads: 0
[2023-07-28 00:21:36] [config] data-threads: 8
[2023-07-28 00:21:36] [config] data-weighting: ""
[2023-07-28 00:21:36] [config] data-weighting-type: sentence
[2023-07-28 00:21:36] [config] dec-cell: gru
[2023-07-28 00:21:36] [config] dec-cell-base-depth: 2
[2023-07-28 00:21:36] [config] dec-cell-high-depth: 1
[2023-07-28 00:21:36] [config] dec-depth: 1
[2023-07-28 00:21:36] [config] devices:
[2023-07-28 00:21:36] [config]   - 0
[2023-07-28 00:21:36] [config] dim-emb: 512
[2023-07-28 00:21:36] [config] dim-rnn: 1024
[2023-07-28 00:21:36] [config] dim-vocabs:
[2023-07-28 00:21:36] [config]   - 16384
[2023-07-28 00:21:36] [config]   - 16384
[2023-07-28 00:21:36] [config] disp-first: 0
[2023-07-28 00:21:36] [config] disp-freq: 1000u
[2023-07-28 00:21:36] [config] disp-label-counts: true
[2023-07-28 00:21:36] [config] dropout-rnn: 0
[2023-07-28 00:21:36] [config] dropout-src: 0
[2023-07-28 00:21:36] [config] dropout-trg: 0
[2023-07-28 00:21:36] [config] dump-config: ""
[2023-07-28 00:21:36] [config] dynamic-gradient-scaling:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] early-stopping: 1000
[2023-07-28 00:21:36] [config] early-stopping-on: first
[2023-07-28 00:21:36] [config] embedding-fix-src: false
[2023-07-28 00:21:36] [config] embedding-fix-trg: false
[2023-07-28 00:21:36] [config] embedding-normalization: false
[2023-07-28 00:21:36] [config] embedding-vectors:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] enc-cell: gru
[2023-07-28 00:21:36] [config] enc-cell-depth: 1
[2023-07-28 00:21:36] [config] enc-depth: 1
[2023-07-28 00:21:36] [config] enc-type: bidirectional
[2023-07-28 00:21:36] [config] english-title-case-every: 0
[2023-07-28 00:21:36] [config] exponential-smoothing: 0
[2023-07-28 00:21:36] [config] factor-weight: 1
[2023-07-28 00:21:36] [config] factors-combine: sum
[2023-07-28 00:21:36] [config] factors-dim-emb: 0
[2023-07-28 00:21:36] [config] gradient-checkpointing: false
[2023-07-28 00:21:36] [config] gradient-norm-average-window: 100
[2023-07-28 00:21:36] [config] guided-alignment: none
[2023-07-28 00:21:36] [config] guided-alignment-cost: mse
[2023-07-28 00:21:36] [config] guided-alignment-weight: 0.1
[2023-07-28 00:21:36] [config] ignore-model-config: false
[2023-07-28 00:21:36] [config] input-types:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] interpolate-env-vars: false
[2023-07-28 00:21:36] [config] keep-best: false
[2023-07-28 00:21:36] [config] label-smoothing: 0
[2023-07-28 00:21:36] [config] layer-normalization: false
[2023-07-28 00:21:36] [config] learn-rate: 0.0001
[2023-07-28 00:21:36] [config] lemma-dependency: ""
[2023-07-28 00:21:36] [config] lemma-dim-emb: 0
[2023-07-28 00:21:36] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 00:21:36] [config] log-level: info
[2023-07-28 00:21:36] [config] log-time-zone: ""
[2023-07-28 00:21:36] [config] logical-epoch:
[2023-07-28 00:21:36] [config]   - 1e
[2023-07-28 00:21:36] [config]   - 0
[2023-07-28 00:21:36] [config] lr-decay: 0
[2023-07-28 00:21:36] [config] lr-decay-freq: 50000
[2023-07-28 00:21:36] [config] lr-decay-inv-sqrt:
[2023-07-28 00:21:36] [config]   - 0
[2023-07-28 00:21:36] [config] lr-decay-repeat-warmup: false
[2023-07-28 00:21:36] [config] lr-decay-reset-optimizer: false
[2023-07-28 00:21:36] [config] lr-decay-start:
[2023-07-28 00:21:36] [config]   - 10
[2023-07-28 00:21:36] [config]   - 1
[2023-07-28 00:21:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 00:21:36] [config] lr-report: false
[2023-07-28 00:21:36] [config] lr-warmup: 0
[2023-07-28 00:21:36] [config] lr-warmup-at-reload: false
[2023-07-28 00:21:36] [config] lr-warmup-cycle: false
[2023-07-28 00:21:36] [config] lr-warmup-start-rate: 0
[2023-07-28 00:21:36] [config] max-length: 50
[2023-07-28 00:21:36] [config] max-length-crop: true
[2023-07-28 00:21:36] [config] max-length-factor: 3
[2023-07-28 00:21:36] [config] maxi-batch: 100
[2023-07-28 00:21:36] [config] maxi-batch-sort: trg
[2023-07-28 00:21:36] [config] mini-batch: 64
[2023-07-28 00:21:36] [config] mini-batch-fit: true
[2023-07-28 00:21:36] [config] mini-batch-fit-step: 10
[2023-07-28 00:21:36] [config] mini-batch-round-up: true
[2023-07-28 00:21:36] [config] mini-batch-track-lr: false
[2023-07-28 00:21:36] [config] mini-batch-warmup: 0
[2023-07-28 00:21:36] [config] mini-batch-words: 0
[2023-07-28 00:21:36] [config] mini-batch-words-ref: 0
[2023-07-28 00:21:36] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 00:21:36] [config] multi-loss-type: sum
[2023-07-28 00:21:36] [config] n-best: false
[2023-07-28 00:21:36] [config] no-nccl: false
[2023-07-28 00:21:36] [config] no-reload: false
[2023-07-28 00:21:36] [config] no-restore-corpus: false
[2023-07-28 00:21:36] [config] normalize: 0
[2023-07-28 00:21:36] [config] normalize-gradient: false
[2023-07-28 00:21:36] [config] num-devices: 0
[2023-07-28 00:21:36] [config] optimizer: adam
[2023-07-28 00:21:36] [config] optimizer-delay: 1
[2023-07-28 00:21:36] [config] optimizer-params:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] output-omit-bias: false
[2023-07-28 00:21:36] [config] overwrite: true
[2023-07-28 00:21:36] [config] precision:
[2023-07-28 00:21:36] [config]   - float16
[2023-07-28 00:21:36] [config]   - float32
[2023-07-28 00:21:36] [config] pretrained-model: ""
[2023-07-28 00:21:36] [config] quantize-biases: false
[2023-07-28 00:21:36] [config] quantize-bits: 0
[2023-07-28 00:21:36] [config] quantize-log-based: false
[2023-07-28 00:21:36] [config] quantize-optimization-steps: 0
[2023-07-28 00:21:36] [config] quiet: false
[2023-07-28 00:21:36] [config] quiet-translation: true
[2023-07-28 00:21:36] [config] relative-paths: false
[2023-07-28 00:21:36] [config] right-left: false
[2023-07-28 00:21:36] [config] save-freq: 10000u
[2023-07-28 00:21:36] [config] seed: 1234
[2023-07-28 00:21:36] [config] sentencepiece-alphas:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] sentencepiece-max-lines: 2000000
[2023-07-28 00:21:36] [config] sentencepiece-options: ""
[2023-07-28 00:21:36] [config] sharding: global
[2023-07-28 00:21:36] [config] shuffle: data
[2023-07-28 00:21:36] [config] shuffle-in-ram: false
[2023-07-28 00:21:36] [config] sigterm: save-and-exit
[2023-07-28 00:21:36] [config] skip: false
[2023-07-28 00:21:36] [config] sqlite: ""
[2023-07-28 00:21:36] [config] sqlite-drop: false
[2023-07-28 00:21:36] [config] sync-freq: 200u
[2023-07-28 00:21:36] [config] sync-sgd: false
[2023-07-28 00:21:36] [config] tempdir: /tmp
[2023-07-28 00:21:36] [config] tied-embeddings: false
[2023-07-28 00:21:36] [config] tied-embeddings-all: true
[2023-07-28 00:21:36] [config] tied-embeddings-src: false
[2023-07-28 00:21:36] [config] train-embedder-rank:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] train-sets:
[2023-07-28 00:21:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 00:21:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 00:21:36] [config] transformer-aan-activation: swish
[2023-07-28 00:21:36] [config] transformer-aan-depth: 2
[2023-07-28 00:21:36] [config] transformer-aan-nogate: false
[2023-07-28 00:21:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 00:21:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 00:21:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 00:21:36] [config] transformer-depth-scaling: false
[2023-07-28 00:21:36] [config] transformer-dim-aan: 2048
[2023-07-28 00:21:36] [config] transformer-dim-ffn: 2048
[2023-07-28 00:21:36] [config] transformer-dropout: 0
[2023-07-28 00:21:36] [config] transformer-dropout-attention: 0
[2023-07-28 00:21:36] [config] transformer-dropout-ffn: 0
[2023-07-28 00:21:36] [config] transformer-ffn-activation: swish
[2023-07-28 00:21:36] [config] transformer-ffn-depth: 2
[2023-07-28 00:21:36] [config] transformer-guided-alignment-layer: last
[2023-07-28 00:21:36] [config] transformer-heads: 8
[2023-07-28 00:21:36] [config] transformer-no-projection: false
[2023-07-28 00:21:36] [config] transformer-pool: false
[2023-07-28 00:21:36] [config] transformer-postprocess: dan
[2023-07-28 00:21:36] [config] transformer-postprocess-emb: d
[2023-07-28 00:21:36] [config] transformer-postprocess-top: ""
[2023-07-28 00:21:36] [config] transformer-preprocess: ""
[2023-07-28 00:21:36] [config] transformer-tied-layers:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] transformer-train-position-embeddings: false
[2023-07-28 00:21:36] [config] tsv: false
[2023-07-28 00:21:36] [config] tsv-fields: 0
[2023-07-28 00:21:36] [config] type: s2s
[2023-07-28 00:21:36] [config] ulr: false
[2023-07-28 00:21:36] [config] ulr-dim-emb: 0
[2023-07-28 00:21:36] [config] ulr-dropout: 0
[2023-07-28 00:21:36] [config] ulr-keys-vectors: ""
[2023-07-28 00:21:36] [config] ulr-query-vectors: ""
[2023-07-28 00:21:36] [config] ulr-softmax-temperature: 1
[2023-07-28 00:21:36] [config] ulr-trainable-transformation: false
[2023-07-28 00:21:36] [config] unlikelihood-loss: false
[2023-07-28 00:21:36] [config] valid-freq: 50000000
[2023-07-28 00:21:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 00:21:36] [config] valid-max-length: 1000
[2023-07-28 00:21:36] [config] valid-metrics:
[2023-07-28 00:21:36] [config]   - translation
[2023-07-28 00:21:36] [config] valid-mini-batch: 32
[2023-07-28 00:21:36] [config] valid-reset-stalled: false
[2023-07-28 00:21:36] [config] valid-script-args:
[2023-07-28 00:21:36] [config]   []
[2023-07-28 00:21:36] [config] valid-script-path: ""
[2023-07-28 00:21:36] [config] valid-sets:
[2023-07-28 00:21:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 00:21:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 00:21:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 00:21:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 00:21:36] [config] vocabs:
[2023-07-28 00:21:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 00:21:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 00:21:36] [config] word-penalty: 0
[2023-07-28 00:21:36] [config] word-scores: false
[2023-07-28 00:21:36] [config] workspace: 5500
[2023-07-28 00:21:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 00:21:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:21:36] [training] Using single-device training
[2023-07-28 00:21:37] Synced seed 1234
[2023-07-28 00:21:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 00:21:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 00:21:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 00:21:37] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 00:21:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 00:21:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:21:37] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 00:21:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 00:21:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 00:21:38] [comm] Using global sharding
[2023-07-28 00:21:38] [comm] NCCLCommunicators constructed successfully
[2023-07-28 00:21:38] [training] Using 1 GPUs
[2023-07-28 00:21:38] [logits] Applying loss function for 1 factor(s)
[2023-07-28 00:21:38] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:21:38] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 00:21:38] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:26:06] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 00:26:06] [valid] No post-processing script given for validating translator
[2023-07-28 00:26:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:26:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 00:26:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 00:26:07] [comm] Using global sharding
[2023-07-28 00:26:07] [comm] NCCLCommunicators constructed successfully
[2023-07-28 00:26:07] [training] Using 1 GPUs
[2023-07-28 00:26:07] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 00:26:08] Allocating memory for general optimizer shards
[2023-07-28 00:26:08] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:26:08] Loading Adam parameters
[2023-07-28 00:26:08] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:26:08] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:26:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 00:26:09] [data] Restoring the corpus state to epoch 21, batch 549
[2023-07-28 00:26:09] [data] Shuffling data
[2023-07-28 00:26:09] [data] Done reading 20,192 sentences
[2023-07-28 00:26:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:26:09] Training started
[2023-07-28 00:26:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 00:26:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:26:15] Parameter type float16, optimization type float32, casting types true
[2023-07-28 00:27:40] Seen 20,192 samples
[2023-07-28 00:27:40] Starting data epoch 22 in logical epoch 22
[2023-07-28 00:27:40] [data] Shuffling data
[2023-07-28 00:27:40] [data] Done reading 20,192 sentences
[2023-07-28 00:27:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:29:11] Seen 20,192 samples
[2023-07-28 00:29:11] Starting data epoch 23 in logical epoch 23
[2023-07-28 00:29:11] [data] Shuffling data
[2023-07-28 00:29:11] [data] Done reading 20,192 sentences
[2023-07-28 00:29:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:30:49] Seen 20,192 samples
[2023-07-28 00:30:49] Starting data epoch 24 in logical epoch 24
[2023-07-28 00:30:49] [data] Shuffling data
[2023-07-28 00:30:49] [data] Done reading 20,192 sentences
[2023-07-28 00:30:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:32:22] Seen 20,192 samples
[2023-07-28 00:32:22] Starting data epoch 25 in logical epoch 25
[2023-07-28 00:32:22] [data] Shuffling data
[2023-07-28 00:32:22] [data] Done reading 20,192 sentences
[2023-07-28 00:32:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:33:56] Seen 20,192 samples
[2023-07-28 00:33:56] Starting data epoch 26 in logical epoch 26
[2023-07-28 00:33:56] [data] Shuffling data
[2023-07-28 00:33:56] [data] Done reading 20,192 sentences
[2023-07-28 00:33:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:35:30] Seen 20,192 samples
[2023-07-28 00:35:30] Starting data epoch 27 in logical epoch 27
[2023-07-28 00:35:30] [data] Shuffling data
[2023-07-28 00:35:30] [data] Done reading 20,192 sentences
[2023-07-28 00:35:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:37:04] Seen 20,192 samples
[2023-07-28 00:37:04] Starting data epoch 28 in logical epoch 28
[2023-07-28 00:37:04] [data] Shuffling data
[2023-07-28 00:37:04] [data] Done reading 20,192 sentences
[2023-07-28 00:37:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:38:33] Seen 20,192 samples
[2023-07-28 00:38:33] Starting data epoch 29 in logical epoch 29
[2023-07-28 00:38:33] [data] Shuffling data
[2023-07-28 00:38:33] [data] Done reading 20,192 sentences
[2023-07-28 00:38:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:40:06] Seen 20,192 samples
[2023-07-28 00:40:06] Starting data epoch 30 in logical epoch 30
[2023-07-28 00:40:06] [data] Shuffling data
[2023-07-28 00:40:06] [data] Done reading 20,192 sentences
[2023-07-28 00:40:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:41:39] Seen 20,192 samples
[2023-07-28 00:41:39] Starting data epoch 31 in logical epoch 31
[2023-07-28 00:41:39] Training finished
[2023-07-28 00:42:22] [valid] Ep. 31 : Up. 822 : translation : 0 : new best
[2023-07-28 00:42:22] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 00:42:25] Saving Adam parameters
[2023-07-28 00:42:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 00:42:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 00:42:32] [marian] Running on node05.datos.cluster.uy as process 12039 with command line:
[2023-07-28 00:42:32] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 00:42:32] [config] after: 0e
[2023-07-28 00:42:32] [config] after-batches: 0
[2023-07-28 00:42:32] [config] after-epochs: 40
[2023-07-28 00:42:32] [config] all-caps-every: 0
[2023-07-28 00:42:32] [config] allow-unk: false
[2023-07-28 00:42:32] [config] authors: false
[2023-07-28 00:42:32] [config] beam-size: 12
[2023-07-28 00:42:32] [config] bert-class-symbol: "[CLS]"
[2023-07-28 00:42:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 00:42:32] [config] bert-masking-fraction: 0.15
[2023-07-28 00:42:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 00:42:32] [config] bert-train-type-embeddings: true
[2023-07-28 00:42:32] [config] bert-type-vocab-size: 2
[2023-07-28 00:42:32] [config] build-info: ""
[2023-07-28 00:42:32] [config] check-gradient-nan: false
[2023-07-28 00:42:32] [config] check-nan: false
[2023-07-28 00:42:32] [config] cite: false
[2023-07-28 00:42:32] [config] clip-norm: 1
[2023-07-28 00:42:32] [config] cost-scaling:
[2023-07-28 00:42:32] [config]   - 256.f
[2023-07-28 00:42:32] [config]   - 1000
[2023-07-28 00:42:32] [config]   - 2.f
[2023-07-28 00:42:32] [config]   - 256.f
[2023-07-28 00:42:32] [config] cost-type: ce-sum
[2023-07-28 00:42:32] [config] cpu-threads: 0
[2023-07-28 00:42:32] [config] data-threads: 8
[2023-07-28 00:42:32] [config] data-weighting: ""
[2023-07-28 00:42:32] [config] data-weighting-type: sentence
[2023-07-28 00:42:32] [config] dec-cell: gru
[2023-07-28 00:42:32] [config] dec-cell-base-depth: 2
[2023-07-28 00:42:32] [config] dec-cell-high-depth: 1
[2023-07-28 00:42:32] [config] dec-depth: 1
[2023-07-28 00:42:32] [config] devices:
[2023-07-28 00:42:32] [config]   - 0
[2023-07-28 00:42:32] [config] dim-emb: 512
[2023-07-28 00:42:32] [config] dim-rnn: 1024
[2023-07-28 00:42:32] [config] dim-vocabs:
[2023-07-28 00:42:32] [config]   - 16384
[2023-07-28 00:42:32] [config]   - 16384
[2023-07-28 00:42:32] [config] disp-first: 0
[2023-07-28 00:42:32] [config] disp-freq: 1000u
[2023-07-28 00:42:32] [config] disp-label-counts: true
[2023-07-28 00:42:32] [config] dropout-rnn: 0
[2023-07-28 00:42:32] [config] dropout-src: 0
[2023-07-28 00:42:32] [config] dropout-trg: 0
[2023-07-28 00:42:32] [config] dump-config: ""
[2023-07-28 00:42:32] [config] dynamic-gradient-scaling:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] early-stopping: 1000
[2023-07-28 00:42:32] [config] early-stopping-on: first
[2023-07-28 00:42:32] [config] embedding-fix-src: false
[2023-07-28 00:42:32] [config] embedding-fix-trg: false
[2023-07-28 00:42:32] [config] embedding-normalization: false
[2023-07-28 00:42:32] [config] embedding-vectors:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] enc-cell: gru
[2023-07-28 00:42:32] [config] enc-cell-depth: 1
[2023-07-28 00:42:32] [config] enc-depth: 1
[2023-07-28 00:42:32] [config] enc-type: bidirectional
[2023-07-28 00:42:32] [config] english-title-case-every: 0
[2023-07-28 00:42:32] [config] exponential-smoothing: 0
[2023-07-28 00:42:32] [config] factor-weight: 1
[2023-07-28 00:42:32] [config] factors-combine: sum
[2023-07-28 00:42:32] [config] factors-dim-emb: 0
[2023-07-28 00:42:32] [config] gradient-checkpointing: false
[2023-07-28 00:42:32] [config] gradient-norm-average-window: 100
[2023-07-28 00:42:32] [config] guided-alignment: none
[2023-07-28 00:42:32] [config] guided-alignment-cost: mse
[2023-07-28 00:42:32] [config] guided-alignment-weight: 0.1
[2023-07-28 00:42:32] [config] ignore-model-config: false
[2023-07-28 00:42:32] [config] input-types:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] interpolate-env-vars: false
[2023-07-28 00:42:32] [config] keep-best: false
[2023-07-28 00:42:32] [config] label-smoothing: 0
[2023-07-28 00:42:32] [config] layer-normalization: false
[2023-07-28 00:42:32] [config] learn-rate: 0.0001
[2023-07-28 00:42:32] [config] lemma-dependency: ""
[2023-07-28 00:42:32] [config] lemma-dim-emb: 0
[2023-07-28 00:42:32] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 00:42:32] [config] log-level: info
[2023-07-28 00:42:32] [config] log-time-zone: ""
[2023-07-28 00:42:32] [config] logical-epoch:
[2023-07-28 00:42:32] [config]   - 1e
[2023-07-28 00:42:32] [config]   - 0
[2023-07-28 00:42:32] [config] lr-decay: 0
[2023-07-28 00:42:32] [config] lr-decay-freq: 50000
[2023-07-28 00:42:32] [config] lr-decay-inv-sqrt:
[2023-07-28 00:42:32] [config]   - 0
[2023-07-28 00:42:32] [config] lr-decay-repeat-warmup: false
[2023-07-28 00:42:32] [config] lr-decay-reset-optimizer: false
[2023-07-28 00:42:32] [config] lr-decay-start:
[2023-07-28 00:42:32] [config]   - 10
[2023-07-28 00:42:32] [config]   - 1
[2023-07-28 00:42:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 00:42:32] [config] lr-report: false
[2023-07-28 00:42:32] [config] lr-warmup: 0
[2023-07-28 00:42:32] [config] lr-warmup-at-reload: false
[2023-07-28 00:42:32] [config] lr-warmup-cycle: false
[2023-07-28 00:42:32] [config] lr-warmup-start-rate: 0
[2023-07-28 00:42:32] [config] max-length: 50
[2023-07-28 00:42:32] [config] max-length-crop: true
[2023-07-28 00:42:32] [config] max-length-factor: 3
[2023-07-28 00:42:32] [config] maxi-batch: 100
[2023-07-28 00:42:32] [config] maxi-batch-sort: trg
[2023-07-28 00:42:32] [config] mini-batch: 64
[2023-07-28 00:42:32] [config] mini-batch-fit: true
[2023-07-28 00:42:32] [config] mini-batch-fit-step: 10
[2023-07-28 00:42:32] [config] mini-batch-round-up: true
[2023-07-28 00:42:32] [config] mini-batch-track-lr: false
[2023-07-28 00:42:32] [config] mini-batch-warmup: 0
[2023-07-28 00:42:32] [config] mini-batch-words: 0
[2023-07-28 00:42:32] [config] mini-batch-words-ref: 0
[2023-07-28 00:42:32] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 00:42:32] [config] multi-loss-type: sum
[2023-07-28 00:42:32] [config] n-best: false
[2023-07-28 00:42:32] [config] no-nccl: false
[2023-07-28 00:42:32] [config] no-reload: false
[2023-07-28 00:42:32] [config] no-restore-corpus: false
[2023-07-28 00:42:32] [config] normalize: 0
[2023-07-28 00:42:32] [config] normalize-gradient: false
[2023-07-28 00:42:32] [config] num-devices: 0
[2023-07-28 00:42:32] [config] optimizer: adam
[2023-07-28 00:42:32] [config] optimizer-delay: 1
[2023-07-28 00:42:32] [config] optimizer-params:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] output-omit-bias: false
[2023-07-28 00:42:32] [config] overwrite: true
[2023-07-28 00:42:32] [config] precision:
[2023-07-28 00:42:32] [config]   - float16
[2023-07-28 00:42:32] [config]   - float32
[2023-07-28 00:42:32] [config] pretrained-model: ""
[2023-07-28 00:42:32] [config] quantize-biases: false
[2023-07-28 00:42:32] [config] quantize-bits: 0
[2023-07-28 00:42:32] [config] quantize-log-based: false
[2023-07-28 00:42:32] [config] quantize-optimization-steps: 0
[2023-07-28 00:42:32] [config] quiet: false
[2023-07-28 00:42:32] [config] quiet-translation: true
[2023-07-28 00:42:32] [config] relative-paths: false
[2023-07-28 00:42:32] [config] right-left: false
[2023-07-28 00:42:32] [config] save-freq: 10000u
[2023-07-28 00:42:32] [config] seed: 1234
[2023-07-28 00:42:32] [config] sentencepiece-alphas:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] sentencepiece-max-lines: 2000000
[2023-07-28 00:42:32] [config] sentencepiece-options: ""
[2023-07-28 00:42:32] [config] sharding: global
[2023-07-28 00:42:32] [config] shuffle: data
[2023-07-28 00:42:32] [config] shuffle-in-ram: false
[2023-07-28 00:42:32] [config] sigterm: save-and-exit
[2023-07-28 00:42:32] [config] skip: false
[2023-07-28 00:42:32] [config] sqlite: ""
[2023-07-28 00:42:32] [config] sqlite-drop: false
[2023-07-28 00:42:32] [config] sync-freq: 200u
[2023-07-28 00:42:32] [config] sync-sgd: false
[2023-07-28 00:42:32] [config] tempdir: /tmp
[2023-07-28 00:42:32] [config] tied-embeddings: false
[2023-07-28 00:42:32] [config] tied-embeddings-all: true
[2023-07-28 00:42:32] [config] tied-embeddings-src: false
[2023-07-28 00:42:32] [config] train-embedder-rank:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] train-sets:
[2023-07-28 00:42:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 00:42:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 00:42:32] [config] transformer-aan-activation: swish
[2023-07-28 00:42:32] [config] transformer-aan-depth: 2
[2023-07-28 00:42:32] [config] transformer-aan-nogate: false
[2023-07-28 00:42:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 00:42:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 00:42:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 00:42:32] [config] transformer-depth-scaling: false
[2023-07-28 00:42:32] [config] transformer-dim-aan: 2048
[2023-07-28 00:42:32] [config] transformer-dim-ffn: 2048
[2023-07-28 00:42:32] [config] transformer-dropout: 0
[2023-07-28 00:42:32] [config] transformer-dropout-attention: 0
[2023-07-28 00:42:32] [config] transformer-dropout-ffn: 0
[2023-07-28 00:42:32] [config] transformer-ffn-activation: swish
[2023-07-28 00:42:32] [config] transformer-ffn-depth: 2
[2023-07-28 00:42:32] [config] transformer-guided-alignment-layer: last
[2023-07-28 00:42:32] [config] transformer-heads: 8
[2023-07-28 00:42:32] [config] transformer-no-projection: false
[2023-07-28 00:42:32] [config] transformer-pool: false
[2023-07-28 00:42:32] [config] transformer-postprocess: dan
[2023-07-28 00:42:32] [config] transformer-postprocess-emb: d
[2023-07-28 00:42:32] [config] transformer-postprocess-top: ""
[2023-07-28 00:42:32] [config] transformer-preprocess: ""
[2023-07-28 00:42:32] [config] transformer-tied-layers:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] transformer-train-position-embeddings: false
[2023-07-28 00:42:32] [config] tsv: false
[2023-07-28 00:42:32] [config] tsv-fields: 0
[2023-07-28 00:42:32] [config] type: s2s
[2023-07-28 00:42:32] [config] ulr: false
[2023-07-28 00:42:32] [config] ulr-dim-emb: 0
[2023-07-28 00:42:32] [config] ulr-dropout: 0
[2023-07-28 00:42:32] [config] ulr-keys-vectors: ""
[2023-07-28 00:42:32] [config] ulr-query-vectors: ""
[2023-07-28 00:42:32] [config] ulr-softmax-temperature: 1
[2023-07-28 00:42:32] [config] ulr-trainable-transformation: false
[2023-07-28 00:42:32] [config] unlikelihood-loss: false
[2023-07-28 00:42:32] [config] valid-freq: 50000000
[2023-07-28 00:42:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 00:42:32] [config] valid-max-length: 1000
[2023-07-28 00:42:32] [config] valid-metrics:
[2023-07-28 00:42:32] [config]   - translation
[2023-07-28 00:42:32] [config] valid-mini-batch: 32
[2023-07-28 00:42:32] [config] valid-reset-stalled: false
[2023-07-28 00:42:32] [config] valid-script-args:
[2023-07-28 00:42:32] [config]   []
[2023-07-28 00:42:32] [config] valid-script-path: ""
[2023-07-28 00:42:32] [config] valid-sets:
[2023-07-28 00:42:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 00:42:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 00:42:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 00:42:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 00:42:32] [config] vocabs:
[2023-07-28 00:42:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 00:42:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 00:42:32] [config] word-penalty: 0
[2023-07-28 00:42:32] [config] word-scores: false
[2023-07-28 00:42:32] [config] workspace: 5500
[2023-07-28 00:42:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 00:42:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:42:32] [training] Using single-device training
[2023-07-28 00:42:33] Synced seed 1234
[2023-07-28 00:42:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 00:42:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 00:42:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 00:42:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 00:42:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 00:42:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:42:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 00:42:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 00:42:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 00:42:33] [comm] Using global sharding
[2023-07-28 00:42:33] [comm] NCCLCommunicators constructed successfully
[2023-07-28 00:42:33] [training] Using 1 GPUs
[2023-07-28 00:42:33] [logits] Applying loss function for 1 factor(s)
[2023-07-28 00:42:33] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:42:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 00:42:34] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:47:02] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 00:47:02] [valid] No post-processing script given for validating translator
[2023-07-28 00:47:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:47:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 00:47:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 00:47:02] [comm] Using global sharding
[2023-07-28 00:47:02] [comm] NCCLCommunicators constructed successfully
[2023-07-28 00:47:02] [training] Using 1 GPUs
[2023-07-28 00:47:02] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 00:47:03] Allocating memory for general optimizer shards
[2023-07-28 00:47:03] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:47:03] Loading Adam parameters
[2023-07-28 00:47:03] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:47:03] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:47:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 00:47:04] [data] Restoring the corpus state to epoch 31, batch 822
[2023-07-28 00:47:04] [data] Shuffling data
[2023-07-28 00:47:04] [data] Done reading 20,192 sentences
[2023-07-28 00:47:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:47:04] Training started
[2023-07-28 00:47:04] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 00:47:04] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:47:06] Parameter type float16, optimization type float32, casting types true
[2023-07-28 00:48:40] Seen 20,192 samples
[2023-07-28 00:48:40] Starting data epoch 32 in logical epoch 32
[2023-07-28 00:48:40] [data] Shuffling data
[2023-07-28 00:48:40] [data] Done reading 20,192 sentences
[2023-07-28 00:48:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:50:10] Seen 20,192 samples
[2023-07-28 00:50:10] Starting data epoch 33 in logical epoch 33
[2023-07-28 00:50:10] [data] Shuffling data
[2023-07-28 00:50:10] [data] Done reading 20,192 sentences
[2023-07-28 00:50:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:51:43] Seen 20,192 samples
[2023-07-28 00:51:43] Starting data epoch 34 in logical epoch 34
[2023-07-28 00:51:43] [data] Shuffling data
[2023-07-28 00:51:43] [data] Done reading 20,192 sentences
[2023-07-28 00:51:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:53:17] Seen 20,192 samples
[2023-07-28 00:53:17] Starting data epoch 35 in logical epoch 35
[2023-07-28 00:53:17] [data] Shuffling data
[2023-07-28 00:53:17] [data] Done reading 20,192 sentences
[2023-07-28 00:53:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:54:49] Seen 20,192 samples
[2023-07-28 00:54:49] Starting data epoch 36 in logical epoch 36
[2023-07-28 00:54:49] [data] Shuffling data
[2023-07-28 00:54:49] [data] Done reading 20,192 sentences
[2023-07-28 00:54:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:56:24] Seen 20,192 samples
[2023-07-28 00:56:24] Starting data epoch 37 in logical epoch 37
[2023-07-28 00:56:24] [data] Shuffling data
[2023-07-28 00:56:24] [data] Done reading 20,192 sentences
[2023-07-28 00:56:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:57:18] Ep. 37 : Up. 1000 : Sen. 10,907 : Cost 6.33983040 * 20,742,856 @ 35,212 after 20,742,848 : Time 615.88s : 33679.83 words/s : gNorm 0.8793
[2023-07-28 00:57:59] Seen 20,192 samples
[2023-07-28 00:57:59] Starting data epoch 38 in logical epoch 38
[2023-07-28 00:57:59] [data] Shuffling data
[2023-07-28 00:57:59] [data] Done reading 20,192 sentences
[2023-07-28 00:57:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:59:34] Seen 20,192 samples
[2023-07-28 00:59:34] Starting data epoch 39 in logical epoch 39
[2023-07-28 00:59:34] [data] Shuffling data
[2023-07-28 00:59:34] [data] Done reading 20,192 sentences
[2023-07-28 00:59:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:01:04] Seen 20,192 samples
[2023-07-28 01:01:04] Starting data epoch 40 in logical epoch 40
[2023-07-28 01:01:04] [data] Shuffling data
[2023-07-28 01:01:04] [data] Done reading 20,192 sentences
[2023-07-28 01:01:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:02:36] Seen 20,192 samples
[2023-07-28 01:02:36] Starting data epoch 41 in logical epoch 41
[2023-07-28 01:02:36] Training finished
[2023-07-28 01:03:23] [valid] Ep. 41 : Up. 1096 : translation : 0 : new best
[2023-07-28 01:03:23] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:03:25] Saving Adam parameters
[2023-07-28 01:03:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 01:03:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:03:32] [marian] Running on node05.datos.cluster.uy as process 13529 with command line:
[2023-07-28 01:03:32] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 01:03:32] [config] after: 0e
[2023-07-28 01:03:32] [config] after-batches: 0
[2023-07-28 01:03:32] [config] after-epochs: 50
[2023-07-28 01:03:32] [config] all-caps-every: 0
[2023-07-28 01:03:32] [config] allow-unk: false
[2023-07-28 01:03:32] [config] authors: false
[2023-07-28 01:03:32] [config] beam-size: 12
[2023-07-28 01:03:32] [config] bert-class-symbol: "[CLS]"
[2023-07-28 01:03:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 01:03:32] [config] bert-masking-fraction: 0.15
[2023-07-28 01:03:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 01:03:32] [config] bert-train-type-embeddings: true
[2023-07-28 01:03:32] [config] bert-type-vocab-size: 2
[2023-07-28 01:03:32] [config] build-info: ""
[2023-07-28 01:03:32] [config] check-gradient-nan: false
[2023-07-28 01:03:32] [config] check-nan: false
[2023-07-28 01:03:32] [config] cite: false
[2023-07-28 01:03:32] [config] clip-norm: 1
[2023-07-28 01:03:32] [config] cost-scaling:
[2023-07-28 01:03:32] [config]   - 256.f
[2023-07-28 01:03:32] [config]   - 1000
[2023-07-28 01:03:32] [config]   - 2.f
[2023-07-28 01:03:32] [config]   - 256.f
[2023-07-28 01:03:32] [config] cost-type: ce-sum
[2023-07-28 01:03:32] [config] cpu-threads: 0
[2023-07-28 01:03:32] [config] data-threads: 8
[2023-07-28 01:03:32] [config] data-weighting: ""
[2023-07-28 01:03:32] [config] data-weighting-type: sentence
[2023-07-28 01:03:32] [config] dec-cell: gru
[2023-07-28 01:03:32] [config] dec-cell-base-depth: 2
[2023-07-28 01:03:32] [config] dec-cell-high-depth: 1
[2023-07-28 01:03:32] [config] dec-depth: 1
[2023-07-28 01:03:32] [config] devices:
[2023-07-28 01:03:32] [config]   - 0
[2023-07-28 01:03:32] [config] dim-emb: 512
[2023-07-28 01:03:32] [config] dim-rnn: 1024
[2023-07-28 01:03:32] [config] dim-vocabs:
[2023-07-28 01:03:32] [config]   - 16384
[2023-07-28 01:03:32] [config]   - 16384
[2023-07-28 01:03:32] [config] disp-first: 0
[2023-07-28 01:03:32] [config] disp-freq: 1000u
[2023-07-28 01:03:32] [config] disp-label-counts: true
[2023-07-28 01:03:32] [config] dropout-rnn: 0
[2023-07-28 01:03:32] [config] dropout-src: 0
[2023-07-28 01:03:32] [config] dropout-trg: 0
[2023-07-28 01:03:32] [config] dump-config: ""
[2023-07-28 01:03:32] [config] dynamic-gradient-scaling:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] early-stopping: 1000
[2023-07-28 01:03:32] [config] early-stopping-on: first
[2023-07-28 01:03:32] [config] embedding-fix-src: false
[2023-07-28 01:03:32] [config] embedding-fix-trg: false
[2023-07-28 01:03:32] [config] embedding-normalization: false
[2023-07-28 01:03:32] [config] embedding-vectors:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] enc-cell: gru
[2023-07-28 01:03:32] [config] enc-cell-depth: 1
[2023-07-28 01:03:32] [config] enc-depth: 1
[2023-07-28 01:03:32] [config] enc-type: bidirectional
[2023-07-28 01:03:32] [config] english-title-case-every: 0
[2023-07-28 01:03:32] [config] exponential-smoothing: 0
[2023-07-28 01:03:32] [config] factor-weight: 1
[2023-07-28 01:03:32] [config] factors-combine: sum
[2023-07-28 01:03:32] [config] factors-dim-emb: 0
[2023-07-28 01:03:32] [config] gradient-checkpointing: false
[2023-07-28 01:03:32] [config] gradient-norm-average-window: 100
[2023-07-28 01:03:32] [config] guided-alignment: none
[2023-07-28 01:03:32] [config] guided-alignment-cost: mse
[2023-07-28 01:03:32] [config] guided-alignment-weight: 0.1
[2023-07-28 01:03:32] [config] ignore-model-config: false
[2023-07-28 01:03:32] [config] input-types:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] interpolate-env-vars: false
[2023-07-28 01:03:32] [config] keep-best: false
[2023-07-28 01:03:32] [config] label-smoothing: 0
[2023-07-28 01:03:32] [config] layer-normalization: false
[2023-07-28 01:03:32] [config] learn-rate: 0.0001
[2023-07-28 01:03:32] [config] lemma-dependency: ""
[2023-07-28 01:03:32] [config] lemma-dim-emb: 0
[2023-07-28 01:03:32] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 01:03:32] [config] log-level: info
[2023-07-28 01:03:32] [config] log-time-zone: ""
[2023-07-28 01:03:32] [config] logical-epoch:
[2023-07-28 01:03:32] [config]   - 1e
[2023-07-28 01:03:32] [config]   - 0
[2023-07-28 01:03:32] [config] lr-decay: 0
[2023-07-28 01:03:32] [config] lr-decay-freq: 50000
[2023-07-28 01:03:32] [config] lr-decay-inv-sqrt:
[2023-07-28 01:03:32] [config]   - 0
[2023-07-28 01:03:32] [config] lr-decay-repeat-warmup: false
[2023-07-28 01:03:32] [config] lr-decay-reset-optimizer: false
[2023-07-28 01:03:32] [config] lr-decay-start:
[2023-07-28 01:03:32] [config]   - 10
[2023-07-28 01:03:32] [config]   - 1
[2023-07-28 01:03:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 01:03:32] [config] lr-report: false
[2023-07-28 01:03:32] [config] lr-warmup: 0
[2023-07-28 01:03:32] [config] lr-warmup-at-reload: false
[2023-07-28 01:03:32] [config] lr-warmup-cycle: false
[2023-07-28 01:03:32] [config] lr-warmup-start-rate: 0
[2023-07-28 01:03:32] [config] max-length: 50
[2023-07-28 01:03:32] [config] max-length-crop: true
[2023-07-28 01:03:32] [config] max-length-factor: 3
[2023-07-28 01:03:32] [config] maxi-batch: 100
[2023-07-28 01:03:32] [config] maxi-batch-sort: trg
[2023-07-28 01:03:32] [config] mini-batch: 64
[2023-07-28 01:03:32] [config] mini-batch-fit: true
[2023-07-28 01:03:32] [config] mini-batch-fit-step: 10
[2023-07-28 01:03:32] [config] mini-batch-round-up: true
[2023-07-28 01:03:32] [config] mini-batch-track-lr: false
[2023-07-28 01:03:32] [config] mini-batch-warmup: 0
[2023-07-28 01:03:32] [config] mini-batch-words: 0
[2023-07-28 01:03:32] [config] mini-batch-words-ref: 0
[2023-07-28 01:03:32] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:03:32] [config] multi-loss-type: sum
[2023-07-28 01:03:32] [config] n-best: false
[2023-07-28 01:03:32] [config] no-nccl: false
[2023-07-28 01:03:32] [config] no-reload: false
[2023-07-28 01:03:32] [config] no-restore-corpus: false
[2023-07-28 01:03:32] [config] normalize: 0
[2023-07-28 01:03:32] [config] normalize-gradient: false
[2023-07-28 01:03:32] [config] num-devices: 0
[2023-07-28 01:03:32] [config] optimizer: adam
[2023-07-28 01:03:32] [config] optimizer-delay: 1
[2023-07-28 01:03:32] [config] optimizer-params:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] output-omit-bias: false
[2023-07-28 01:03:32] [config] overwrite: true
[2023-07-28 01:03:32] [config] precision:
[2023-07-28 01:03:32] [config]   - float16
[2023-07-28 01:03:32] [config]   - float32
[2023-07-28 01:03:32] [config] pretrained-model: ""
[2023-07-28 01:03:32] [config] quantize-biases: false
[2023-07-28 01:03:32] [config] quantize-bits: 0
[2023-07-28 01:03:32] [config] quantize-log-based: false
[2023-07-28 01:03:32] [config] quantize-optimization-steps: 0
[2023-07-28 01:03:32] [config] quiet: false
[2023-07-28 01:03:32] [config] quiet-translation: true
[2023-07-28 01:03:32] [config] relative-paths: false
[2023-07-28 01:03:32] [config] right-left: false
[2023-07-28 01:03:32] [config] save-freq: 10000u
[2023-07-28 01:03:32] [config] seed: 1234
[2023-07-28 01:03:32] [config] sentencepiece-alphas:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] sentencepiece-max-lines: 2000000
[2023-07-28 01:03:32] [config] sentencepiece-options: ""
[2023-07-28 01:03:32] [config] sharding: global
[2023-07-28 01:03:32] [config] shuffle: data
[2023-07-28 01:03:32] [config] shuffle-in-ram: false
[2023-07-28 01:03:32] [config] sigterm: save-and-exit
[2023-07-28 01:03:32] [config] skip: false
[2023-07-28 01:03:32] [config] sqlite: ""
[2023-07-28 01:03:32] [config] sqlite-drop: false
[2023-07-28 01:03:32] [config] sync-freq: 200u
[2023-07-28 01:03:32] [config] sync-sgd: false
[2023-07-28 01:03:32] [config] tempdir: /tmp
[2023-07-28 01:03:32] [config] tied-embeddings: false
[2023-07-28 01:03:32] [config] tied-embeddings-all: true
[2023-07-28 01:03:32] [config] tied-embeddings-src: false
[2023-07-28 01:03:32] [config] train-embedder-rank:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] train-sets:
[2023-07-28 01:03:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 01:03:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 01:03:32] [config] transformer-aan-activation: swish
[2023-07-28 01:03:32] [config] transformer-aan-depth: 2
[2023-07-28 01:03:32] [config] transformer-aan-nogate: false
[2023-07-28 01:03:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 01:03:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 01:03:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 01:03:32] [config] transformer-depth-scaling: false
[2023-07-28 01:03:32] [config] transformer-dim-aan: 2048
[2023-07-28 01:03:32] [config] transformer-dim-ffn: 2048
[2023-07-28 01:03:32] [config] transformer-dropout: 0
[2023-07-28 01:03:32] [config] transformer-dropout-attention: 0
[2023-07-28 01:03:32] [config] transformer-dropout-ffn: 0
[2023-07-28 01:03:32] [config] transformer-ffn-activation: swish
[2023-07-28 01:03:32] [config] transformer-ffn-depth: 2
[2023-07-28 01:03:32] [config] transformer-guided-alignment-layer: last
[2023-07-28 01:03:32] [config] transformer-heads: 8
[2023-07-28 01:03:32] [config] transformer-no-projection: false
[2023-07-28 01:03:32] [config] transformer-pool: false
[2023-07-28 01:03:32] [config] transformer-postprocess: dan
[2023-07-28 01:03:32] [config] transformer-postprocess-emb: d
[2023-07-28 01:03:32] [config] transformer-postprocess-top: ""
[2023-07-28 01:03:32] [config] transformer-preprocess: ""
[2023-07-28 01:03:32] [config] transformer-tied-layers:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] transformer-train-position-embeddings: false
[2023-07-28 01:03:32] [config] tsv: false
[2023-07-28 01:03:32] [config] tsv-fields: 0
[2023-07-28 01:03:32] [config] type: s2s
[2023-07-28 01:03:32] [config] ulr: false
[2023-07-28 01:03:32] [config] ulr-dim-emb: 0
[2023-07-28 01:03:32] [config] ulr-dropout: 0
[2023-07-28 01:03:32] [config] ulr-keys-vectors: ""
[2023-07-28 01:03:32] [config] ulr-query-vectors: ""
[2023-07-28 01:03:32] [config] ulr-softmax-temperature: 1
[2023-07-28 01:03:32] [config] ulr-trainable-transformation: false
[2023-07-28 01:03:32] [config] unlikelihood-loss: false
[2023-07-28 01:03:32] [config] valid-freq: 50000000
[2023-07-28 01:03:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 01:03:32] [config] valid-max-length: 1000
[2023-07-28 01:03:32] [config] valid-metrics:
[2023-07-28 01:03:32] [config]   - translation
[2023-07-28 01:03:32] [config] valid-mini-batch: 32
[2023-07-28 01:03:32] [config] valid-reset-stalled: false
[2023-07-28 01:03:32] [config] valid-script-args:
[2023-07-28 01:03:32] [config]   []
[2023-07-28 01:03:32] [config] valid-script-path: ""
[2023-07-28 01:03:32] [config] valid-sets:
[2023-07-28 01:03:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 01:03:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 01:03:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 01:03:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:03:32] [config] vocabs:
[2023-07-28 01:03:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:03:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:03:32] [config] word-penalty: 0
[2023-07-28 01:03:32] [config] word-scores: false
[2023-07-28 01:03:32] [config] workspace: 5500
[2023-07-28 01:03:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:03:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:03:32] [training] Using single-device training
[2023-07-28 01:03:33] Synced seed 1234
[2023-07-28 01:03:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:03:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 01:03:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:03:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 01:03:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 01:03:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:03:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 01:03:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 01:03:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 01:03:33] [comm] Using global sharding
[2023-07-28 01:03:33] [comm] NCCLCommunicators constructed successfully
[2023-07-28 01:03:33] [training] Using 1 GPUs
[2023-07-28 01:03:33] [logits] Applying loss function for 1 factor(s)
[2023-07-28 01:03:33] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:03:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 01:03:34] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:08:05] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 01:08:05] [valid] No post-processing script given for validating translator
[2023-07-28 01:08:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:08:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 01:08:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 01:08:05] [comm] Using global sharding
[2023-07-28 01:08:05] [comm] NCCLCommunicators constructed successfully
[2023-07-28 01:08:05] [training] Using 1 GPUs
[2023-07-28 01:08:05] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:08:06] Allocating memory for general optimizer shards
[2023-07-28 01:08:06] [memory] Reserving 322 MB, device gpu0
[2023-07-28 01:08:06] Loading Adam parameters
[2023-07-28 01:08:07] [memory] Reserving 322 MB, device gpu0
[2023-07-28 01:08:07] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:08:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 01:08:07] [data] Restoring the corpus state to epoch 41, batch 1096
[2023-07-28 01:08:07] [data] Shuffling data
[2023-07-28 01:08:07] [data] Done reading 20,192 sentences
[2023-07-28 01:08:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:08:07] Training started
[2023-07-28 01:08:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 01:08:08] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:08:13] Parameter type float16, optimization type float32, casting types true
[2023-07-28 01:09:41] Seen 20,192 samples
[2023-07-28 01:09:41] Starting data epoch 42 in logical epoch 42
[2023-07-28 01:09:41] [data] Shuffling data
[2023-07-28 01:09:41] [data] Done reading 20,192 sentences
[2023-07-28 01:09:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:11:17] Seen 20,192 samples
[2023-07-28 01:11:17] Starting data epoch 43 in logical epoch 43
[2023-07-28 01:11:17] [data] Shuffling data
[2023-07-28 01:11:17] [data] Done reading 20,192 sentences
[2023-07-28 01:11:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:12:51] Seen 20,192 samples
[2023-07-28 01:12:51] Starting data epoch 44 in logical epoch 44
[2023-07-28 01:12:51] [data] Shuffling data
[2023-07-28 01:12:51] [data] Done reading 20,192 sentences
[2023-07-28 01:12:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:14:19] Seen 20,192 samples
[2023-07-28 01:14:19] Starting data epoch 45 in logical epoch 45
[2023-07-28 01:14:19] [data] Shuffling data
[2023-07-28 01:14:19] [data] Done reading 20,192 sentences
[2023-07-28 01:14:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:15:48] Seen 20,192 samples
[2023-07-28 01:15:48] Starting data epoch 46 in logical epoch 46
[2023-07-28 01:15:48] [data] Shuffling data
[2023-07-28 01:15:48] [data] Done reading 20,192 sentences
[2023-07-28 01:15:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:17:14] Seen 20,192 samples
[2023-07-28 01:17:14] Starting data epoch 47 in logical epoch 47
[2023-07-28 01:17:14] [data] Shuffling data
[2023-07-28 01:17:14] [data] Done reading 20,192 sentences
[2023-07-28 01:17:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:18:42] Seen 20,192 samples
[2023-07-28 01:18:42] Starting data epoch 48 in logical epoch 48
[2023-07-28 01:18:42] [data] Shuffling data
[2023-07-28 01:18:42] [data] Done reading 20,192 sentences
[2023-07-28 01:18:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:20:15] Seen 20,192 samples
[2023-07-28 01:20:15] Starting data epoch 49 in logical epoch 49
[2023-07-28 01:20:15] [data] Shuffling data
[2023-07-28 01:20:15] [data] Done reading 20,192 sentences
[2023-07-28 01:20:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:21:44] Seen 20,192 samples
[2023-07-28 01:21:44] Starting data epoch 50 in logical epoch 50
[2023-07-28 01:21:44] [data] Shuffling data
[2023-07-28 01:21:44] [data] Done reading 20,192 sentences
[2023-07-28 01:21:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:23:14] Seen 20,192 samples
[2023-07-28 01:23:14] Starting data epoch 51 in logical epoch 51
[2023-07-28 01:23:14] Training finished
[2023-07-28 01:24:12] [valid] Ep. 51 : Up. 1369 : translation : 0 : new best
[2023-07-28 01:24:12] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:24:14] Saving Adam parameters
[2023-07-28 01:24:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 01:24:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:24:24] [marian] Running on node05.datos.cluster.uy as process 14996 with command line:
[2023-07-28 01:24:24] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 01:24:24] [config] after: 0e
[2023-07-28 01:24:24] [config] after-batches: 0
[2023-07-28 01:24:24] [config] after-epochs: 60
[2023-07-28 01:24:24] [config] all-caps-every: 0
[2023-07-28 01:24:24] [config] allow-unk: false
[2023-07-28 01:24:24] [config] authors: false
[2023-07-28 01:24:24] [config] beam-size: 12
[2023-07-28 01:24:24] [config] bert-class-symbol: "[CLS]"
[2023-07-28 01:24:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 01:24:24] [config] bert-masking-fraction: 0.15
[2023-07-28 01:24:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 01:24:24] [config] bert-train-type-embeddings: true
[2023-07-28 01:24:24] [config] bert-type-vocab-size: 2
[2023-07-28 01:24:24] [config] build-info: ""
[2023-07-28 01:24:24] [config] check-gradient-nan: false
[2023-07-28 01:24:24] [config] check-nan: false
[2023-07-28 01:24:24] [config] cite: false
[2023-07-28 01:24:24] [config] clip-norm: 1
[2023-07-28 01:24:24] [config] cost-scaling:
[2023-07-28 01:24:24] [config]   - 256.f
[2023-07-28 01:24:24] [config]   - 1000
[2023-07-28 01:24:24] [config]   - 2.f
[2023-07-28 01:24:24] [config]   - 256.f
[2023-07-28 01:24:24] [config] cost-type: ce-sum
[2023-07-28 01:24:24] [config] cpu-threads: 0
[2023-07-28 01:24:24] [config] data-threads: 8
[2023-07-28 01:24:24] [config] data-weighting: ""
[2023-07-28 01:24:24] [config] data-weighting-type: sentence
[2023-07-28 01:24:24] [config] dec-cell: gru
[2023-07-28 01:24:24] [config] dec-cell-base-depth: 2
[2023-07-28 01:24:24] [config] dec-cell-high-depth: 1
[2023-07-28 01:24:24] [config] dec-depth: 1
[2023-07-28 01:24:24] [config] devices:
[2023-07-28 01:24:24] [config]   - 0
[2023-07-28 01:24:24] [config] dim-emb: 512
[2023-07-28 01:24:24] [config] dim-rnn: 1024
[2023-07-28 01:24:24] [config] dim-vocabs:
[2023-07-28 01:24:24] [config]   - 16384
[2023-07-28 01:24:24] [config]   - 16384
[2023-07-28 01:24:24] [config] disp-first: 0
[2023-07-28 01:24:24] [config] disp-freq: 1000u
[2023-07-28 01:24:24] [config] disp-label-counts: true
[2023-07-28 01:24:24] [config] dropout-rnn: 0
[2023-07-28 01:24:24] [config] dropout-src: 0
[2023-07-28 01:24:24] [config] dropout-trg: 0
[2023-07-28 01:24:24] [config] dump-config: ""
[2023-07-28 01:24:24] [config] dynamic-gradient-scaling:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] early-stopping: 1000
[2023-07-28 01:24:24] [config] early-stopping-on: first
[2023-07-28 01:24:24] [config] embedding-fix-src: false
[2023-07-28 01:24:24] [config] embedding-fix-trg: false
[2023-07-28 01:24:24] [config] embedding-normalization: false
[2023-07-28 01:24:24] [config] embedding-vectors:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] enc-cell: gru
[2023-07-28 01:24:24] [config] enc-cell-depth: 1
[2023-07-28 01:24:24] [config] enc-depth: 1
[2023-07-28 01:24:24] [config] enc-type: bidirectional
[2023-07-28 01:24:24] [config] english-title-case-every: 0
[2023-07-28 01:24:24] [config] exponential-smoothing: 0
[2023-07-28 01:24:24] [config] factor-weight: 1
[2023-07-28 01:24:24] [config] factors-combine: sum
[2023-07-28 01:24:24] [config] factors-dim-emb: 0
[2023-07-28 01:24:24] [config] gradient-checkpointing: false
[2023-07-28 01:24:24] [config] gradient-norm-average-window: 100
[2023-07-28 01:24:24] [config] guided-alignment: none
[2023-07-28 01:24:24] [config] guided-alignment-cost: mse
[2023-07-28 01:24:24] [config] guided-alignment-weight: 0.1
[2023-07-28 01:24:24] [config] ignore-model-config: false
[2023-07-28 01:24:24] [config] input-types:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] interpolate-env-vars: false
[2023-07-28 01:24:24] [config] keep-best: false
[2023-07-28 01:24:24] [config] label-smoothing: 0
[2023-07-28 01:24:24] [config] layer-normalization: false
[2023-07-28 01:24:24] [config] learn-rate: 0.0001
[2023-07-28 01:24:24] [config] lemma-dependency: ""
[2023-07-28 01:24:24] [config] lemma-dim-emb: 0
[2023-07-28 01:24:24] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 01:24:24] [config] log-level: info
[2023-07-28 01:24:24] [config] log-time-zone: ""
[2023-07-28 01:24:24] [config] logical-epoch:
[2023-07-28 01:24:24] [config]   - 1e
[2023-07-28 01:24:24] [config]   - 0
[2023-07-28 01:24:24] [config] lr-decay: 0
[2023-07-28 01:24:24] [config] lr-decay-freq: 50000
[2023-07-28 01:24:24] [config] lr-decay-inv-sqrt:
[2023-07-28 01:24:24] [config]   - 0
[2023-07-28 01:24:24] [config] lr-decay-repeat-warmup: false
[2023-07-28 01:24:24] [config] lr-decay-reset-optimizer: false
[2023-07-28 01:24:24] [config] lr-decay-start:
[2023-07-28 01:24:24] [config]   - 10
[2023-07-28 01:24:24] [config]   - 1
[2023-07-28 01:24:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 01:24:24] [config] lr-report: false
[2023-07-28 01:24:24] [config] lr-warmup: 0
[2023-07-28 01:24:24] [config] lr-warmup-at-reload: false
[2023-07-28 01:24:24] [config] lr-warmup-cycle: false
[2023-07-28 01:24:24] [config] lr-warmup-start-rate: 0
[2023-07-28 01:24:24] [config] max-length: 50
[2023-07-28 01:24:24] [config] max-length-crop: true
[2023-07-28 01:24:24] [config] max-length-factor: 3
[2023-07-28 01:24:24] [config] maxi-batch: 100
[2023-07-28 01:24:24] [config] maxi-batch-sort: trg
[2023-07-28 01:24:24] [config] mini-batch: 64
[2023-07-28 01:24:24] [config] mini-batch-fit: true
[2023-07-28 01:24:24] [config] mini-batch-fit-step: 10
[2023-07-28 01:24:24] [config] mini-batch-round-up: true
[2023-07-28 01:24:24] [config] mini-batch-track-lr: false
[2023-07-28 01:24:24] [config] mini-batch-warmup: 0
[2023-07-28 01:24:24] [config] mini-batch-words: 0
[2023-07-28 01:24:24] [config] mini-batch-words-ref: 0
[2023-07-28 01:24:24] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:24:24] [config] multi-loss-type: sum
[2023-07-28 01:24:24] [config] n-best: false
[2023-07-28 01:24:24] [config] no-nccl: false
[2023-07-28 01:24:24] [config] no-reload: false
[2023-07-28 01:24:24] [config] no-restore-corpus: false
[2023-07-28 01:24:24] [config] normalize: 0
[2023-07-28 01:24:24] [config] normalize-gradient: false
[2023-07-28 01:24:24] [config] num-devices: 0
[2023-07-28 01:24:24] [config] optimizer: adam
[2023-07-28 01:24:24] [config] optimizer-delay: 1
[2023-07-28 01:24:24] [config] optimizer-params:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] output-omit-bias: false
[2023-07-28 01:24:24] [config] overwrite: true
[2023-07-28 01:24:24] [config] precision:
[2023-07-28 01:24:24] [config]   - float16
[2023-07-28 01:24:24] [config]   - float32
[2023-07-28 01:24:24] [config] pretrained-model: ""
[2023-07-28 01:24:24] [config] quantize-biases: false
[2023-07-28 01:24:24] [config] quantize-bits: 0
[2023-07-28 01:24:24] [config] quantize-log-based: false
[2023-07-28 01:24:24] [config] quantize-optimization-steps: 0
[2023-07-28 01:24:24] [config] quiet: false
[2023-07-28 01:24:24] [config] quiet-translation: true
[2023-07-28 01:24:24] [config] relative-paths: false
[2023-07-28 01:24:24] [config] right-left: false
[2023-07-28 01:24:24] [config] save-freq: 10000u
[2023-07-28 01:24:24] [config] seed: 1234
[2023-07-28 01:24:24] [config] sentencepiece-alphas:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] sentencepiece-max-lines: 2000000
[2023-07-28 01:24:24] [config] sentencepiece-options: ""
[2023-07-28 01:24:24] [config] sharding: global
[2023-07-28 01:24:24] [config] shuffle: data
[2023-07-28 01:24:24] [config] shuffle-in-ram: false
[2023-07-28 01:24:24] [config] sigterm: save-and-exit
[2023-07-28 01:24:24] [config] skip: false
[2023-07-28 01:24:24] [config] sqlite: ""
[2023-07-28 01:24:24] [config] sqlite-drop: false
[2023-07-28 01:24:24] [config] sync-freq: 200u
[2023-07-28 01:24:24] [config] sync-sgd: false
[2023-07-28 01:24:24] [config] tempdir: /tmp
[2023-07-28 01:24:24] [config] tied-embeddings: false
[2023-07-28 01:24:24] [config] tied-embeddings-all: true
[2023-07-28 01:24:24] [config] tied-embeddings-src: false
[2023-07-28 01:24:24] [config] train-embedder-rank:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] train-sets:
[2023-07-28 01:24:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 01:24:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 01:24:24] [config] transformer-aan-activation: swish
[2023-07-28 01:24:24] [config] transformer-aan-depth: 2
[2023-07-28 01:24:24] [config] transformer-aan-nogate: false
[2023-07-28 01:24:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 01:24:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 01:24:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 01:24:24] [config] transformer-depth-scaling: false
[2023-07-28 01:24:24] [config] transformer-dim-aan: 2048
[2023-07-28 01:24:24] [config] transformer-dim-ffn: 2048
[2023-07-28 01:24:24] [config] transformer-dropout: 0
[2023-07-28 01:24:24] [config] transformer-dropout-attention: 0
[2023-07-28 01:24:24] [config] transformer-dropout-ffn: 0
[2023-07-28 01:24:24] [config] transformer-ffn-activation: swish
[2023-07-28 01:24:24] [config] transformer-ffn-depth: 2
[2023-07-28 01:24:24] [config] transformer-guided-alignment-layer: last
[2023-07-28 01:24:24] [config] transformer-heads: 8
[2023-07-28 01:24:24] [config] transformer-no-projection: false
[2023-07-28 01:24:24] [config] transformer-pool: false
[2023-07-28 01:24:24] [config] transformer-postprocess: dan
[2023-07-28 01:24:24] [config] transformer-postprocess-emb: d
[2023-07-28 01:24:24] [config] transformer-postprocess-top: ""
[2023-07-28 01:24:24] [config] transformer-preprocess: ""
[2023-07-28 01:24:24] [config] transformer-tied-layers:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] transformer-train-position-embeddings: false
[2023-07-28 01:24:24] [config] tsv: false
[2023-07-28 01:24:24] [config] tsv-fields: 0
[2023-07-28 01:24:24] [config] type: s2s
[2023-07-28 01:24:24] [config] ulr: false
[2023-07-28 01:24:24] [config] ulr-dim-emb: 0
[2023-07-28 01:24:24] [config] ulr-dropout: 0
[2023-07-28 01:24:24] [config] ulr-keys-vectors: ""
[2023-07-28 01:24:24] [config] ulr-query-vectors: ""
[2023-07-28 01:24:24] [config] ulr-softmax-temperature: 1
[2023-07-28 01:24:24] [config] ulr-trainable-transformation: false
[2023-07-28 01:24:24] [config] unlikelihood-loss: false
[2023-07-28 01:24:24] [config] valid-freq: 50000000
[2023-07-28 01:24:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 01:24:24] [config] valid-max-length: 1000
[2023-07-28 01:24:24] [config] valid-metrics:
[2023-07-28 01:24:24] [config]   - translation
[2023-07-28 01:24:24] [config] valid-mini-batch: 32
[2023-07-28 01:24:24] [config] valid-reset-stalled: false
[2023-07-28 01:24:24] [config] valid-script-args:
[2023-07-28 01:24:24] [config]   []
[2023-07-28 01:24:24] [config] valid-script-path: ""
[2023-07-28 01:24:24] [config] valid-sets:
[2023-07-28 01:24:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 01:24:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 01:24:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 01:24:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:24:24] [config] vocabs:
[2023-07-28 01:24:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:24:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:24:24] [config] word-penalty: 0
[2023-07-28 01:24:24] [config] word-scores: false
[2023-07-28 01:24:24] [config] workspace: 5500
[2023-07-28 01:24:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:24:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:24:24] [training] Using single-device training
[2023-07-28 01:24:25] Synced seed 1234
[2023-07-28 01:24:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:24:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 01:24:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:24:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 01:24:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 01:24:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:24:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 01:24:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 01:24:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 01:24:26] [comm] Using global sharding
[2023-07-28 01:24:26] [comm] NCCLCommunicators constructed successfully
[2023-07-28 01:24:26] [training] Using 1 GPUs
[2023-07-28 01:24:26] [logits] Applying loss function for 1 factor(s)
[2023-07-28 01:24:26] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:24:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 01:24:27] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:28:55] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 01:28:55] [valid] No post-processing script given for validating translator
[2023-07-28 01:28:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:28:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 01:28:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 01:28:55] [comm] Using global sharding
[2023-07-28 01:28:55] [comm] NCCLCommunicators constructed successfully
[2023-07-28 01:28:55] [training] Using 1 GPUs
[2023-07-28 01:28:55] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:28:56] Allocating memory for general optimizer shards
[2023-07-28 01:28:56] [memory] Reserving 322 MB, device gpu0
[2023-07-28 01:28:56] Loading Adam parameters
[2023-07-28 01:28:56] [memory] Reserving 322 MB, device gpu0
[2023-07-28 01:28:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:28:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 01:28:57] [data] Restoring the corpus state to epoch 51, batch 1369
[2023-07-28 01:28:57] [data] Shuffling data
[2023-07-28 01:28:57] [data] Done reading 20,192 sentences
[2023-07-28 01:28:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:28:57] Training started
[2023-07-28 01:28:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 01:28:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:29:02] Parameter type float16, optimization type float32, casting types true
[2023-07-28 01:30:23] Seen 20,192 samples
[2023-07-28 01:30:23] Starting data epoch 52 in logical epoch 52
[2023-07-28 01:30:23] [data] Shuffling data
[2023-07-28 01:30:23] [data] Done reading 20,192 sentences
[2023-07-28 01:30:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:31:48] Seen 20,192 samples
[2023-07-28 01:31:48] Starting data epoch 53 in logical epoch 53
[2023-07-28 01:31:48] [data] Shuffling data
[2023-07-28 01:31:48] [data] Done reading 20,192 sentences
[2023-07-28 01:31:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:33:11] Seen 20,192 samples
[2023-07-28 01:33:11] Starting data epoch 54 in logical epoch 54
[2023-07-28 01:33:11] [data] Shuffling data
[2023-07-28 01:33:11] [data] Done reading 20,192 sentences
[2023-07-28 01:33:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:34:40] Seen 20,192 samples
[2023-07-28 01:34:40] Starting data epoch 55 in logical epoch 55
[2023-07-28 01:34:40] [data] Shuffling data
[2023-07-28 01:34:40] [data] Done reading 20,192 sentences
[2023-07-28 01:34:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:36:06] Seen 20,192 samples
[2023-07-28 01:36:06] Starting data epoch 56 in logical epoch 56
[2023-07-28 01:36:06] [data] Shuffling data
[2023-07-28 01:36:06] [data] Done reading 20,192 sentences
[2023-07-28 01:36:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:37:30] Seen 20,192 samples
[2023-07-28 01:37:30] Starting data epoch 57 in logical epoch 57
[2023-07-28 01:37:30] [data] Shuffling data
[2023-07-28 01:37:30] [data] Done reading 20,192 sentences
[2023-07-28 01:37:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:38:53] Seen 20,192 samples
[2023-07-28 01:38:53] Starting data epoch 58 in logical epoch 58
[2023-07-28 01:38:53] [data] Shuffling data
[2023-07-28 01:38:53] [data] Done reading 20,192 sentences
[2023-07-28 01:38:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:40:18] Seen 20,192 samples
[2023-07-28 01:40:18] Starting data epoch 59 in logical epoch 59
[2023-07-28 01:40:18] [data] Shuffling data
[2023-07-28 01:40:18] [data] Done reading 20,192 sentences
[2023-07-28 01:40:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:41:41] Seen 20,192 samples
[2023-07-28 01:41:41] Starting data epoch 60 in logical epoch 60
[2023-07-28 01:41:41] [data] Shuffling data
[2023-07-28 01:41:42] [data] Done reading 20,192 sentences
[2023-07-28 01:41:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:43:07] Seen 20,192 samples
[2023-07-28 01:43:07] Starting data epoch 61 in logical epoch 61
[2023-07-28 01:43:07] Training finished
[2023-07-28 01:43:47] [valid] Ep. 61 : Up. 1640 : translation : 0 : new best
[2023-07-28 01:43:47] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:43:48] Saving Adam parameters
[2023-07-28 01:43:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 01:43:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:43:56] [marian] Running on node05.datos.cluster.uy as process 16064 with command line:
[2023-07-28 01:43:56] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 01:43:56] [config] after: 0e
[2023-07-28 01:43:56] [config] after-batches: 0
[2023-07-28 01:43:56] [config] after-epochs: 70
[2023-07-28 01:43:56] [config] all-caps-every: 0
[2023-07-28 01:43:56] [config] allow-unk: false
[2023-07-28 01:43:56] [config] authors: false
[2023-07-28 01:43:56] [config] beam-size: 12
[2023-07-28 01:43:56] [config] bert-class-symbol: "[CLS]"
[2023-07-28 01:43:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 01:43:56] [config] bert-masking-fraction: 0.15
[2023-07-28 01:43:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 01:43:56] [config] bert-train-type-embeddings: true
[2023-07-28 01:43:56] [config] bert-type-vocab-size: 2
[2023-07-28 01:43:56] [config] build-info: ""
[2023-07-28 01:43:56] [config] check-gradient-nan: false
[2023-07-28 01:43:56] [config] check-nan: false
[2023-07-28 01:43:56] [config] cite: false
[2023-07-28 01:43:56] [config] clip-norm: 1
[2023-07-28 01:43:56] [config] cost-scaling:
[2023-07-28 01:43:56] [config]   - 256.f
[2023-07-28 01:43:56] [config]   - 1000
[2023-07-28 01:43:56] [config]   - 2.f
[2023-07-28 01:43:56] [config]   - 256.f
[2023-07-28 01:43:56] [config] cost-type: ce-sum
[2023-07-28 01:43:56] [config] cpu-threads: 0
[2023-07-28 01:43:56] [config] data-threads: 8
[2023-07-28 01:43:56] [config] data-weighting: ""
[2023-07-28 01:43:56] [config] data-weighting-type: sentence
[2023-07-28 01:43:56] [config] dec-cell: gru
[2023-07-28 01:43:56] [config] dec-cell-base-depth: 2
[2023-07-28 01:43:56] [config] dec-cell-high-depth: 1
[2023-07-28 01:43:56] [config] dec-depth: 1
[2023-07-28 01:43:56] [config] devices:
[2023-07-28 01:43:56] [config]   - 0
[2023-07-28 01:43:56] [config] dim-emb: 512
[2023-07-28 01:43:56] [config] dim-rnn: 1024
[2023-07-28 01:43:56] [config] dim-vocabs:
[2023-07-28 01:43:56] [config]   - 16384
[2023-07-28 01:43:56] [config]   - 16384
[2023-07-28 01:43:56] [config] disp-first: 0
[2023-07-28 01:43:56] [config] disp-freq: 1000u
[2023-07-28 01:43:56] [config] disp-label-counts: true
[2023-07-28 01:43:56] [config] dropout-rnn: 0
[2023-07-28 01:43:56] [config] dropout-src: 0
[2023-07-28 01:43:56] [config] dropout-trg: 0
[2023-07-28 01:43:56] [config] dump-config: ""
[2023-07-28 01:43:56] [config] dynamic-gradient-scaling:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] early-stopping: 1000
[2023-07-28 01:43:56] [config] early-stopping-on: first
[2023-07-28 01:43:56] [config] embedding-fix-src: false
[2023-07-28 01:43:56] [config] embedding-fix-trg: false
[2023-07-28 01:43:56] [config] embedding-normalization: false
[2023-07-28 01:43:56] [config] embedding-vectors:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] enc-cell: gru
[2023-07-28 01:43:56] [config] enc-cell-depth: 1
[2023-07-28 01:43:56] [config] enc-depth: 1
[2023-07-28 01:43:56] [config] enc-type: bidirectional
[2023-07-28 01:43:56] [config] english-title-case-every: 0
[2023-07-28 01:43:56] [config] exponential-smoothing: 0
[2023-07-28 01:43:56] [config] factor-weight: 1
[2023-07-28 01:43:56] [config] factors-combine: sum
[2023-07-28 01:43:56] [config] factors-dim-emb: 0
[2023-07-28 01:43:56] [config] gradient-checkpointing: false
[2023-07-28 01:43:56] [config] gradient-norm-average-window: 100
[2023-07-28 01:43:56] [config] guided-alignment: none
[2023-07-28 01:43:56] [config] guided-alignment-cost: mse
[2023-07-28 01:43:56] [config] guided-alignment-weight: 0.1
[2023-07-28 01:43:56] [config] ignore-model-config: false
[2023-07-28 01:43:56] [config] input-types:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] interpolate-env-vars: false
[2023-07-28 01:43:56] [config] keep-best: false
[2023-07-28 01:43:56] [config] label-smoothing: 0
[2023-07-28 01:43:56] [config] layer-normalization: false
[2023-07-28 01:43:56] [config] learn-rate: 0.0001
[2023-07-28 01:43:56] [config] lemma-dependency: ""
[2023-07-28 01:43:56] [config] lemma-dim-emb: 0
[2023-07-28 01:43:56] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 01:43:56] [config] log-level: info
[2023-07-28 01:43:56] [config] log-time-zone: ""
[2023-07-28 01:43:56] [config] logical-epoch:
[2023-07-28 01:43:56] [config]   - 1e
[2023-07-28 01:43:56] [config]   - 0
[2023-07-28 01:43:56] [config] lr-decay: 0
[2023-07-28 01:43:56] [config] lr-decay-freq: 50000
[2023-07-28 01:43:56] [config] lr-decay-inv-sqrt:
[2023-07-28 01:43:56] [config]   - 0
[2023-07-28 01:43:56] [config] lr-decay-repeat-warmup: false
[2023-07-28 01:43:56] [config] lr-decay-reset-optimizer: false
[2023-07-28 01:43:56] [config] lr-decay-start:
[2023-07-28 01:43:56] [config]   - 10
[2023-07-28 01:43:56] [config]   - 1
[2023-07-28 01:43:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 01:43:56] [config] lr-report: false
[2023-07-28 01:43:56] [config] lr-warmup: 0
[2023-07-28 01:43:56] [config] lr-warmup-at-reload: false
[2023-07-28 01:43:56] [config] lr-warmup-cycle: false
[2023-07-28 01:43:56] [config] lr-warmup-start-rate: 0
[2023-07-28 01:43:56] [config] max-length: 50
[2023-07-28 01:43:56] [config] max-length-crop: true
[2023-07-28 01:43:56] [config] max-length-factor: 3
[2023-07-28 01:43:56] [config] maxi-batch: 100
[2023-07-28 01:43:56] [config] maxi-batch-sort: trg
[2023-07-28 01:43:56] [config] mini-batch: 64
[2023-07-28 01:43:56] [config] mini-batch-fit: true
[2023-07-28 01:43:56] [config] mini-batch-fit-step: 10
[2023-07-28 01:43:56] [config] mini-batch-round-up: true
[2023-07-28 01:43:56] [config] mini-batch-track-lr: false
[2023-07-28 01:43:56] [config] mini-batch-warmup: 0
[2023-07-28 01:43:56] [config] mini-batch-words: 0
[2023-07-28 01:43:56] [config] mini-batch-words-ref: 0
[2023-07-28 01:43:56] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:43:56] [config] multi-loss-type: sum
[2023-07-28 01:43:56] [config] n-best: false
[2023-07-28 01:43:56] [config] no-nccl: false
[2023-07-28 01:43:56] [config] no-reload: false
[2023-07-28 01:43:56] [config] no-restore-corpus: false
[2023-07-28 01:43:56] [config] normalize: 0
[2023-07-28 01:43:56] [config] normalize-gradient: false
[2023-07-28 01:43:56] [config] num-devices: 0
[2023-07-28 01:43:56] [config] optimizer: adam
[2023-07-28 01:43:56] [config] optimizer-delay: 1
[2023-07-28 01:43:56] [config] optimizer-params:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] output-omit-bias: false
[2023-07-28 01:43:56] [config] overwrite: true
[2023-07-28 01:43:56] [config] precision:
[2023-07-28 01:43:56] [config]   - float16
[2023-07-28 01:43:56] [config]   - float32
[2023-07-28 01:43:56] [config] pretrained-model: ""
[2023-07-28 01:43:56] [config] quantize-biases: false
[2023-07-28 01:43:56] [config] quantize-bits: 0
[2023-07-28 01:43:56] [config] quantize-log-based: false
[2023-07-28 01:43:56] [config] quantize-optimization-steps: 0
[2023-07-28 01:43:56] [config] quiet: false
[2023-07-28 01:43:56] [config] quiet-translation: true
[2023-07-28 01:43:56] [config] relative-paths: false
[2023-07-28 01:43:56] [config] right-left: false
[2023-07-28 01:43:56] [config] save-freq: 10000u
[2023-07-28 01:43:56] [config] seed: 1234
[2023-07-28 01:43:56] [config] sentencepiece-alphas:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] sentencepiece-max-lines: 2000000
[2023-07-28 01:43:56] [config] sentencepiece-options: ""
[2023-07-28 01:43:56] [config] sharding: global
[2023-07-28 01:43:56] [config] shuffle: data
[2023-07-28 01:43:56] [config] shuffle-in-ram: false
[2023-07-28 01:43:56] [config] sigterm: save-and-exit
[2023-07-28 01:43:56] [config] skip: false
[2023-07-28 01:43:56] [config] sqlite: ""
[2023-07-28 01:43:56] [config] sqlite-drop: false
[2023-07-28 01:43:56] [config] sync-freq: 200u
[2023-07-28 01:43:56] [config] sync-sgd: false
[2023-07-28 01:43:56] [config] tempdir: /tmp
[2023-07-28 01:43:56] [config] tied-embeddings: false
[2023-07-28 01:43:56] [config] tied-embeddings-all: true
[2023-07-28 01:43:56] [config] tied-embeddings-src: false
[2023-07-28 01:43:56] [config] train-embedder-rank:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] train-sets:
[2023-07-28 01:43:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 01:43:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 01:43:56] [config] transformer-aan-activation: swish
[2023-07-28 01:43:56] [config] transformer-aan-depth: 2
[2023-07-28 01:43:56] [config] transformer-aan-nogate: false
[2023-07-28 01:43:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 01:43:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 01:43:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 01:43:56] [config] transformer-depth-scaling: false
[2023-07-28 01:43:56] [config] transformer-dim-aan: 2048
[2023-07-28 01:43:56] [config] transformer-dim-ffn: 2048
[2023-07-28 01:43:56] [config] transformer-dropout: 0
[2023-07-28 01:43:56] [config] transformer-dropout-attention: 0
[2023-07-28 01:43:56] [config] transformer-dropout-ffn: 0
[2023-07-28 01:43:56] [config] transformer-ffn-activation: swish
[2023-07-28 01:43:56] [config] transformer-ffn-depth: 2
[2023-07-28 01:43:56] [config] transformer-guided-alignment-layer: last
[2023-07-28 01:43:56] [config] transformer-heads: 8
[2023-07-28 01:43:56] [config] transformer-no-projection: false
[2023-07-28 01:43:56] [config] transformer-pool: false
[2023-07-28 01:43:56] [config] transformer-postprocess: dan
[2023-07-28 01:43:56] [config] transformer-postprocess-emb: d
[2023-07-28 01:43:56] [config] transformer-postprocess-top: ""
[2023-07-28 01:43:56] [config] transformer-preprocess: ""
[2023-07-28 01:43:56] [config] transformer-tied-layers:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] transformer-train-position-embeddings: false
[2023-07-28 01:43:56] [config] tsv: false
[2023-07-28 01:43:56] [config] tsv-fields: 0
[2023-07-28 01:43:56] [config] type: s2s
[2023-07-28 01:43:56] [config] ulr: false
[2023-07-28 01:43:56] [config] ulr-dim-emb: 0
[2023-07-28 01:43:56] [config] ulr-dropout: 0
[2023-07-28 01:43:56] [config] ulr-keys-vectors: ""
[2023-07-28 01:43:56] [config] ulr-query-vectors: ""
[2023-07-28 01:43:56] [config] ulr-softmax-temperature: 1
[2023-07-28 01:43:56] [config] ulr-trainable-transformation: false
[2023-07-28 01:43:56] [config] unlikelihood-loss: false
[2023-07-28 01:43:56] [config] valid-freq: 50000000
[2023-07-28 01:43:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 01:43:56] [config] valid-max-length: 1000
[2023-07-28 01:43:56] [config] valid-metrics:
[2023-07-28 01:43:56] [config]   - translation
[2023-07-28 01:43:56] [config] valid-mini-batch: 32
[2023-07-28 01:43:56] [config] valid-reset-stalled: false
[2023-07-28 01:43:56] [config] valid-script-args:
[2023-07-28 01:43:56] [config]   []
[2023-07-28 01:43:56] [config] valid-script-path: ""
[2023-07-28 01:43:56] [config] valid-sets:
[2023-07-28 01:43:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 01:43:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 01:43:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 01:43:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:43:56] [config] vocabs:
[2023-07-28 01:43:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:43:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:43:56] [config] word-penalty: 0
[2023-07-28 01:43:56] [config] word-scores: false
[2023-07-28 01:43:56] [config] workspace: 5500
[2023-07-28 01:43:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:43:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:43:56] [training] Using single-device training
[2023-07-28 01:43:56] Synced seed 1234
[2023-07-28 01:43:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:43:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 01:43:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:43:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 01:43:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 01:43:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:43:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 01:43:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 01:43:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 01:43:57] [comm] Using global sharding
[2023-07-28 01:43:57] [comm] NCCLCommunicators constructed successfully
[2023-07-28 01:43:57] [training] Using 1 GPUs
[2023-07-28 01:43:57] [logits] Applying loss function for 1 factor(s)
[2023-07-28 01:43:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:43:58] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 01:43:58] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:48:26] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 01:48:26] [valid] No post-processing script given for validating translator
[2023-07-28 01:48:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:48:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 01:48:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 01:48:26] [comm] Using global sharding
[2023-07-28 01:48:26] [comm] NCCLCommunicators constructed successfully
[2023-07-28 01:48:26] [training] Using 1 GPUs
[2023-07-28 01:48:26] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 01:48:27] Allocating memory for general optimizer shards
[2023-07-28 01:48:27] [memory] Reserving 322 MB, device gpu0
[2023-07-28 01:48:27] Loading Adam parameters
[2023-07-28 01:48:27] [memory] Reserving 322 MB, device gpu0
[2023-07-28 01:48:28] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:48:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 01:48:28] [data] Restoring the corpus state to epoch 61, batch 1640
[2023-07-28 01:48:28] [data] Shuffling data
[2023-07-28 01:48:28] [data] Done reading 20,192 sentences
[2023-07-28 01:48:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:48:28] Training started
[2023-07-28 01:48:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 01:48:28] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:48:29] Parameter type float16, optimization type float32, casting types true
[2023-07-28 01:49:51] Seen 20,192 samples
[2023-07-28 01:49:51] Starting data epoch 62 in logical epoch 62
[2023-07-28 01:49:51] [data] Shuffling data
[2023-07-28 01:49:51] [data] Done reading 20,192 sentences
[2023-07-28 01:49:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:51:14] Seen 20,192 samples
[2023-07-28 01:51:14] Starting data epoch 63 in logical epoch 63
[2023-07-28 01:51:14] [data] Shuffling data
[2023-07-28 01:51:14] [data] Done reading 20,192 sentences
[2023-07-28 01:51:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:52:34] Seen 20,192 samples
[2023-07-28 01:52:34] Starting data epoch 64 in logical epoch 64
[2023-07-28 01:52:34] [data] Shuffling data
[2023-07-28 01:52:34] [data] Done reading 20,192 sentences
[2023-07-28 01:52:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:53:54] Seen 20,192 samples
[2023-07-28 01:53:54] Starting data epoch 65 in logical epoch 65
[2023-07-28 01:53:54] [data] Shuffling data
[2023-07-28 01:53:54] [data] Done reading 20,192 sentences
[2023-07-28 01:53:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:55:17] Seen 20,192 samples
[2023-07-28 01:55:17] Starting data epoch 66 in logical epoch 66
[2023-07-28 01:55:17] [data] Shuffling data
[2023-07-28 01:55:17] [data] Done reading 20,192 sentences
[2023-07-28 01:55:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:56:39] Seen 20,192 samples
[2023-07-28 01:56:39] Starting data epoch 67 in logical epoch 67
[2023-07-28 01:56:39] [data] Shuffling data
[2023-07-28 01:56:39] [data] Done reading 20,192 sentences
[2023-07-28 01:56:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:58:02] Seen 20,192 samples
[2023-07-28 01:58:02] Starting data epoch 68 in logical epoch 68
[2023-07-28 01:58:02] [data] Shuffling data
[2023-07-28 01:58:02] [data] Done reading 20,192 sentences
[2023-07-28 01:58:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:59:23] Seen 20,192 samples
[2023-07-28 01:59:23] Starting data epoch 69 in logical epoch 69
[2023-07-28 01:59:23] [data] Shuffling data
[2023-07-28 01:59:23] [data] Done reading 20,192 sentences
[2023-07-28 01:59:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:00:46] Seen 20,192 samples
[2023-07-28 02:00:46] Starting data epoch 70 in logical epoch 70
[2023-07-28 02:00:46] [data] Shuffling data
[2023-07-28 02:00:46] [data] Done reading 20,192 sentences
[2023-07-28 02:00:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:02:10] Seen 20,192 samples
[2023-07-28 02:02:10] Starting data epoch 71 in logical epoch 71
[2023-07-28 02:02:10] Training finished
[2023-07-28 02:02:51] [valid] Ep. 71 : Up. 1912 : translation : 0 : new best
[2023-07-28 02:02:51] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:02:53] Saving Adam parameters
[2023-07-28 02:02:54] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 02:03:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:03:01] [marian] Running on node05.datos.cluster.uy as process 17458 with command line:
[2023-07-28 02:03:01] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 02:03:01] [config] after: 0e
[2023-07-28 02:03:01] [config] after-batches: 0
[2023-07-28 02:03:01] [config] after-epochs: 80
[2023-07-28 02:03:01] [config] all-caps-every: 0
[2023-07-28 02:03:01] [config] allow-unk: false
[2023-07-28 02:03:01] [config] authors: false
[2023-07-28 02:03:01] [config] beam-size: 12
[2023-07-28 02:03:01] [config] bert-class-symbol: "[CLS]"
[2023-07-28 02:03:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 02:03:01] [config] bert-masking-fraction: 0.15
[2023-07-28 02:03:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 02:03:01] [config] bert-train-type-embeddings: true
[2023-07-28 02:03:01] [config] bert-type-vocab-size: 2
[2023-07-28 02:03:01] [config] build-info: ""
[2023-07-28 02:03:01] [config] check-gradient-nan: false
[2023-07-28 02:03:01] [config] check-nan: false
[2023-07-28 02:03:01] [config] cite: false
[2023-07-28 02:03:01] [config] clip-norm: 1
[2023-07-28 02:03:01] [config] cost-scaling:
[2023-07-28 02:03:01] [config]   - 256.f
[2023-07-28 02:03:01] [config]   - 1000
[2023-07-28 02:03:01] [config]   - 2.f
[2023-07-28 02:03:01] [config]   - 256.f
[2023-07-28 02:03:01] [config] cost-type: ce-sum
[2023-07-28 02:03:01] [config] cpu-threads: 0
[2023-07-28 02:03:01] [config] data-threads: 8
[2023-07-28 02:03:01] [config] data-weighting: ""
[2023-07-28 02:03:01] [config] data-weighting-type: sentence
[2023-07-28 02:03:01] [config] dec-cell: gru
[2023-07-28 02:03:01] [config] dec-cell-base-depth: 2
[2023-07-28 02:03:01] [config] dec-cell-high-depth: 1
[2023-07-28 02:03:01] [config] dec-depth: 1
[2023-07-28 02:03:01] [config] devices:
[2023-07-28 02:03:01] [config]   - 0
[2023-07-28 02:03:01] [config] dim-emb: 512
[2023-07-28 02:03:01] [config] dim-rnn: 1024
[2023-07-28 02:03:01] [config] dim-vocabs:
[2023-07-28 02:03:01] [config]   - 16384
[2023-07-28 02:03:01] [config]   - 16384
[2023-07-28 02:03:01] [config] disp-first: 0
[2023-07-28 02:03:01] [config] disp-freq: 1000u
[2023-07-28 02:03:01] [config] disp-label-counts: true
[2023-07-28 02:03:01] [config] dropout-rnn: 0
[2023-07-28 02:03:01] [config] dropout-src: 0
[2023-07-28 02:03:01] [config] dropout-trg: 0
[2023-07-28 02:03:01] [config] dump-config: ""
[2023-07-28 02:03:01] [config] dynamic-gradient-scaling:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] early-stopping: 1000
[2023-07-28 02:03:01] [config] early-stopping-on: first
[2023-07-28 02:03:01] [config] embedding-fix-src: false
[2023-07-28 02:03:01] [config] embedding-fix-trg: false
[2023-07-28 02:03:01] [config] embedding-normalization: false
[2023-07-28 02:03:01] [config] embedding-vectors:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] enc-cell: gru
[2023-07-28 02:03:01] [config] enc-cell-depth: 1
[2023-07-28 02:03:01] [config] enc-depth: 1
[2023-07-28 02:03:01] [config] enc-type: bidirectional
[2023-07-28 02:03:01] [config] english-title-case-every: 0
[2023-07-28 02:03:01] [config] exponential-smoothing: 0
[2023-07-28 02:03:01] [config] factor-weight: 1
[2023-07-28 02:03:01] [config] factors-combine: sum
[2023-07-28 02:03:01] [config] factors-dim-emb: 0
[2023-07-28 02:03:01] [config] gradient-checkpointing: false
[2023-07-28 02:03:01] [config] gradient-norm-average-window: 100
[2023-07-28 02:03:01] [config] guided-alignment: none
[2023-07-28 02:03:01] [config] guided-alignment-cost: mse
[2023-07-28 02:03:01] [config] guided-alignment-weight: 0.1
[2023-07-28 02:03:01] [config] ignore-model-config: false
[2023-07-28 02:03:01] [config] input-types:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] interpolate-env-vars: false
[2023-07-28 02:03:01] [config] keep-best: false
[2023-07-28 02:03:01] [config] label-smoothing: 0
[2023-07-28 02:03:01] [config] layer-normalization: false
[2023-07-28 02:03:01] [config] learn-rate: 0.0001
[2023-07-28 02:03:01] [config] lemma-dependency: ""
[2023-07-28 02:03:01] [config] lemma-dim-emb: 0
[2023-07-28 02:03:01] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:03:01] [config] log-level: info
[2023-07-28 02:03:01] [config] log-time-zone: ""
[2023-07-28 02:03:01] [config] logical-epoch:
[2023-07-28 02:03:01] [config]   - 1e
[2023-07-28 02:03:01] [config]   - 0
[2023-07-28 02:03:01] [config] lr-decay: 0
[2023-07-28 02:03:01] [config] lr-decay-freq: 50000
[2023-07-28 02:03:01] [config] lr-decay-inv-sqrt:
[2023-07-28 02:03:01] [config]   - 0
[2023-07-28 02:03:01] [config] lr-decay-repeat-warmup: false
[2023-07-28 02:03:01] [config] lr-decay-reset-optimizer: false
[2023-07-28 02:03:01] [config] lr-decay-start:
[2023-07-28 02:03:01] [config]   - 10
[2023-07-28 02:03:01] [config]   - 1
[2023-07-28 02:03:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 02:03:01] [config] lr-report: false
[2023-07-28 02:03:01] [config] lr-warmup: 0
[2023-07-28 02:03:01] [config] lr-warmup-at-reload: false
[2023-07-28 02:03:01] [config] lr-warmup-cycle: false
[2023-07-28 02:03:01] [config] lr-warmup-start-rate: 0
[2023-07-28 02:03:01] [config] max-length: 50
[2023-07-28 02:03:01] [config] max-length-crop: true
[2023-07-28 02:03:01] [config] max-length-factor: 3
[2023-07-28 02:03:01] [config] maxi-batch: 100
[2023-07-28 02:03:01] [config] maxi-batch-sort: trg
[2023-07-28 02:03:01] [config] mini-batch: 64
[2023-07-28 02:03:01] [config] mini-batch-fit: true
[2023-07-28 02:03:01] [config] mini-batch-fit-step: 10
[2023-07-28 02:03:01] [config] mini-batch-round-up: true
[2023-07-28 02:03:01] [config] mini-batch-track-lr: false
[2023-07-28 02:03:01] [config] mini-batch-warmup: 0
[2023-07-28 02:03:01] [config] mini-batch-words: 0
[2023-07-28 02:03:01] [config] mini-batch-words-ref: 0
[2023-07-28 02:03:01] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:03:01] [config] multi-loss-type: sum
[2023-07-28 02:03:01] [config] n-best: false
[2023-07-28 02:03:01] [config] no-nccl: false
[2023-07-28 02:03:01] [config] no-reload: false
[2023-07-28 02:03:01] [config] no-restore-corpus: false
[2023-07-28 02:03:01] [config] normalize: 0
[2023-07-28 02:03:01] [config] normalize-gradient: false
[2023-07-28 02:03:01] [config] num-devices: 0
[2023-07-28 02:03:01] [config] optimizer: adam
[2023-07-28 02:03:01] [config] optimizer-delay: 1
[2023-07-28 02:03:01] [config] optimizer-params:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] output-omit-bias: false
[2023-07-28 02:03:01] [config] overwrite: true
[2023-07-28 02:03:01] [config] precision:
[2023-07-28 02:03:01] [config]   - float16
[2023-07-28 02:03:01] [config]   - float32
[2023-07-28 02:03:01] [config] pretrained-model: ""
[2023-07-28 02:03:01] [config] quantize-biases: false
[2023-07-28 02:03:01] [config] quantize-bits: 0
[2023-07-28 02:03:01] [config] quantize-log-based: false
[2023-07-28 02:03:01] [config] quantize-optimization-steps: 0
[2023-07-28 02:03:01] [config] quiet: false
[2023-07-28 02:03:01] [config] quiet-translation: true
[2023-07-28 02:03:01] [config] relative-paths: false
[2023-07-28 02:03:01] [config] right-left: false
[2023-07-28 02:03:01] [config] save-freq: 10000u
[2023-07-28 02:03:01] [config] seed: 1234
[2023-07-28 02:03:01] [config] sentencepiece-alphas:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] sentencepiece-max-lines: 2000000
[2023-07-28 02:03:01] [config] sentencepiece-options: ""
[2023-07-28 02:03:01] [config] sharding: global
[2023-07-28 02:03:01] [config] shuffle: data
[2023-07-28 02:03:01] [config] shuffle-in-ram: false
[2023-07-28 02:03:01] [config] sigterm: save-and-exit
[2023-07-28 02:03:01] [config] skip: false
[2023-07-28 02:03:01] [config] sqlite: ""
[2023-07-28 02:03:01] [config] sqlite-drop: false
[2023-07-28 02:03:01] [config] sync-freq: 200u
[2023-07-28 02:03:01] [config] sync-sgd: false
[2023-07-28 02:03:01] [config] tempdir: /tmp
[2023-07-28 02:03:01] [config] tied-embeddings: false
[2023-07-28 02:03:01] [config] tied-embeddings-all: true
[2023-07-28 02:03:01] [config] tied-embeddings-src: false
[2023-07-28 02:03:01] [config] train-embedder-rank:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] train-sets:
[2023-07-28 02:03:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 02:03:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 02:03:01] [config] transformer-aan-activation: swish
[2023-07-28 02:03:01] [config] transformer-aan-depth: 2
[2023-07-28 02:03:01] [config] transformer-aan-nogate: false
[2023-07-28 02:03:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 02:03:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 02:03:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 02:03:01] [config] transformer-depth-scaling: false
[2023-07-28 02:03:01] [config] transformer-dim-aan: 2048
[2023-07-28 02:03:01] [config] transformer-dim-ffn: 2048
[2023-07-28 02:03:01] [config] transformer-dropout: 0
[2023-07-28 02:03:01] [config] transformer-dropout-attention: 0
[2023-07-28 02:03:01] [config] transformer-dropout-ffn: 0
[2023-07-28 02:03:01] [config] transformer-ffn-activation: swish
[2023-07-28 02:03:01] [config] transformer-ffn-depth: 2
[2023-07-28 02:03:01] [config] transformer-guided-alignment-layer: last
[2023-07-28 02:03:01] [config] transformer-heads: 8
[2023-07-28 02:03:01] [config] transformer-no-projection: false
[2023-07-28 02:03:01] [config] transformer-pool: false
[2023-07-28 02:03:01] [config] transformer-postprocess: dan
[2023-07-28 02:03:01] [config] transformer-postprocess-emb: d
[2023-07-28 02:03:01] [config] transformer-postprocess-top: ""
[2023-07-28 02:03:01] [config] transformer-preprocess: ""
[2023-07-28 02:03:01] [config] transformer-tied-layers:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] transformer-train-position-embeddings: false
[2023-07-28 02:03:01] [config] tsv: false
[2023-07-28 02:03:01] [config] tsv-fields: 0
[2023-07-28 02:03:01] [config] type: s2s
[2023-07-28 02:03:01] [config] ulr: false
[2023-07-28 02:03:01] [config] ulr-dim-emb: 0
[2023-07-28 02:03:01] [config] ulr-dropout: 0
[2023-07-28 02:03:01] [config] ulr-keys-vectors: ""
[2023-07-28 02:03:01] [config] ulr-query-vectors: ""
[2023-07-28 02:03:01] [config] ulr-softmax-temperature: 1
[2023-07-28 02:03:01] [config] ulr-trainable-transformation: false
[2023-07-28 02:03:01] [config] unlikelihood-loss: false
[2023-07-28 02:03:01] [config] valid-freq: 50000000
[2023-07-28 02:03:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:03:01] [config] valid-max-length: 1000
[2023-07-28 02:03:01] [config] valid-metrics:
[2023-07-28 02:03:01] [config]   - translation
[2023-07-28 02:03:01] [config] valid-mini-batch: 32
[2023-07-28 02:03:01] [config] valid-reset-stalled: false
[2023-07-28 02:03:01] [config] valid-script-args:
[2023-07-28 02:03:01] [config]   []
[2023-07-28 02:03:01] [config] valid-script-path: ""
[2023-07-28 02:03:01] [config] valid-sets:
[2023-07-28 02:03:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 02:03:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 02:03:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 02:03:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:03:01] [config] vocabs:
[2023-07-28 02:03:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:03:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:03:01] [config] word-penalty: 0
[2023-07-28 02:03:01] [config] word-scores: false
[2023-07-28 02:03:01] [config] workspace: 5500
[2023-07-28 02:03:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:03:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:03:01] [training] Using single-device training
[2023-07-28 02:03:01] Synced seed 1234
[2023-07-28 02:03:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:03:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 02:03:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:03:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 02:03:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 02:03:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:03:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 02:03:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:03:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:03:02] [comm] Using global sharding
[2023-07-28 02:03:02] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:03:02] [training] Using 1 GPUs
[2023-07-28 02:03:02] [logits] Applying loss function for 1 factor(s)
[2023-07-28 02:03:02] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:03:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 02:03:02] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:07:33] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 02:07:33] [valid] No post-processing script given for validating translator
[2023-07-28 02:07:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:07:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:07:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:07:33] [comm] Using global sharding
[2023-07-28 02:07:33] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:07:33] [training] Using 1 GPUs
[2023-07-28 02:07:33] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:07:34] Allocating memory for general optimizer shards
[2023-07-28 02:07:34] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:07:34] Loading Adam parameters
[2023-07-28 02:07:35] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:07:35] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:07:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 02:07:35] [data] Restoring the corpus state to epoch 71, batch 1912
[2023-07-28 02:07:35] [data] Shuffling data
[2023-07-28 02:07:35] [data] Done reading 20,192 sentences
[2023-07-28 02:07:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:07:35] Training started
[2023-07-28 02:07:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 02:07:36] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:07:41] Parameter type float16, optimization type float32, casting types true
[2023-07-28 02:08:54] Seen 20,192 samples
[2023-07-28 02:08:54] Starting data epoch 72 in logical epoch 72
[2023-07-28 02:08:54] [data] Shuffling data
[2023-07-28 02:08:54] [data] Done reading 20,192 sentences
[2023-07-28 02:08:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:10:12] Seen 20,192 samples
[2023-07-28 02:10:12] Starting data epoch 73 in logical epoch 73
[2023-07-28 02:10:12] [data] Shuffling data
[2023-07-28 02:10:12] [data] Done reading 20,192 sentences
[2023-07-28 02:10:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:11:31] Seen 20,192 samples
[2023-07-28 02:11:31] Starting data epoch 74 in logical epoch 74
[2023-07-28 02:11:31] [data] Shuffling data
[2023-07-28 02:11:31] [data] Done reading 20,192 sentences
[2023-07-28 02:11:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:11:52] Ep. 74 : Up. 2000 : Sen. 4,507 : Cost 5.01947975 * 20,803,996 @ 29,591 after 41,546,834 : Time 258.81s : 80383.45 words/s : gNorm 0.8617
[2023-07-28 02:12:51] Seen 20,192 samples
[2023-07-28 02:12:51] Starting data epoch 75 in logical epoch 75
[2023-07-28 02:12:51] [data] Shuffling data
[2023-07-28 02:12:51] [data] Done reading 20,192 sentences
[2023-07-28 02:12:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:14:12] Seen 20,192 samples
[2023-07-28 02:14:12] Starting data epoch 76 in logical epoch 76
[2023-07-28 02:14:12] [data] Shuffling data
[2023-07-28 02:14:12] [data] Done reading 20,192 sentences
[2023-07-28 02:14:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:15:32] Seen 20,192 samples
[2023-07-28 02:15:32] Starting data epoch 77 in logical epoch 77
[2023-07-28 02:15:32] [data] Shuffling data
[2023-07-28 02:15:32] [data] Done reading 20,192 sentences
[2023-07-28 02:15:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:16:53] Seen 20,192 samples
[2023-07-28 02:16:53] Starting data epoch 78 in logical epoch 78
[2023-07-28 02:16:53] [data] Shuffling data
[2023-07-28 02:16:53] [data] Done reading 20,192 sentences
[2023-07-28 02:16:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:18:14] Seen 20,192 samples
[2023-07-28 02:18:14] Starting data epoch 79 in logical epoch 79
[2023-07-28 02:18:14] [data] Shuffling data
[2023-07-28 02:18:14] [data] Done reading 20,192 sentences
[2023-07-28 02:18:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:19:33] Seen 20,192 samples
[2023-07-28 02:19:33] Starting data epoch 80 in logical epoch 80
[2023-07-28 02:19:33] [data] Shuffling data
[2023-07-28 02:19:33] [data] Done reading 20,192 sentences
[2023-07-28 02:19:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:20:55] Seen 20,192 samples
[2023-07-28 02:20:55] Starting data epoch 81 in logical epoch 81
[2023-07-28 02:20:55] Training finished
[2023-07-28 02:21:31] [valid] Ep. 81 : Up. 2184 : translation : 0 : new best
[2023-07-28 02:21:31] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:21:33] Saving Adam parameters
[2023-07-28 02:21:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 02:21:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:21:39] [marian] Running on node05.datos.cluster.uy as process 18506 with command line:
[2023-07-28 02:21:39] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 02:21:39] [config] after: 0e
[2023-07-28 02:21:39] [config] after-batches: 0
[2023-07-28 02:21:39] [config] after-epochs: 90
[2023-07-28 02:21:39] [config] all-caps-every: 0
[2023-07-28 02:21:39] [config] allow-unk: false
[2023-07-28 02:21:39] [config] authors: false
[2023-07-28 02:21:39] [config] beam-size: 12
[2023-07-28 02:21:39] [config] bert-class-symbol: "[CLS]"
[2023-07-28 02:21:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 02:21:39] [config] bert-masking-fraction: 0.15
[2023-07-28 02:21:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 02:21:39] [config] bert-train-type-embeddings: true
[2023-07-28 02:21:39] [config] bert-type-vocab-size: 2
[2023-07-28 02:21:39] [config] build-info: ""
[2023-07-28 02:21:39] [config] check-gradient-nan: false
[2023-07-28 02:21:39] [config] check-nan: false
[2023-07-28 02:21:39] [config] cite: false
[2023-07-28 02:21:39] [config] clip-norm: 1
[2023-07-28 02:21:39] [config] cost-scaling:
[2023-07-28 02:21:39] [config]   - 256.f
[2023-07-28 02:21:39] [config]   - 1000
[2023-07-28 02:21:39] [config]   - 2.f
[2023-07-28 02:21:39] [config]   - 256.f
[2023-07-28 02:21:39] [config] cost-type: ce-sum
[2023-07-28 02:21:39] [config] cpu-threads: 0
[2023-07-28 02:21:39] [config] data-threads: 8
[2023-07-28 02:21:39] [config] data-weighting: ""
[2023-07-28 02:21:39] [config] data-weighting-type: sentence
[2023-07-28 02:21:39] [config] dec-cell: gru
[2023-07-28 02:21:39] [config] dec-cell-base-depth: 2
[2023-07-28 02:21:39] [config] dec-cell-high-depth: 1
[2023-07-28 02:21:39] [config] dec-depth: 1
[2023-07-28 02:21:39] [config] devices:
[2023-07-28 02:21:39] [config]   - 0
[2023-07-28 02:21:39] [config] dim-emb: 512
[2023-07-28 02:21:39] [config] dim-rnn: 1024
[2023-07-28 02:21:39] [config] dim-vocabs:
[2023-07-28 02:21:39] [config]   - 16384
[2023-07-28 02:21:39] [config]   - 16384
[2023-07-28 02:21:39] [config] disp-first: 0
[2023-07-28 02:21:39] [config] disp-freq: 1000u
[2023-07-28 02:21:39] [config] disp-label-counts: true
[2023-07-28 02:21:39] [config] dropout-rnn: 0
[2023-07-28 02:21:39] [config] dropout-src: 0
[2023-07-28 02:21:39] [config] dropout-trg: 0
[2023-07-28 02:21:39] [config] dump-config: ""
[2023-07-28 02:21:39] [config] dynamic-gradient-scaling:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] early-stopping: 1000
[2023-07-28 02:21:39] [config] early-stopping-on: first
[2023-07-28 02:21:39] [config] embedding-fix-src: false
[2023-07-28 02:21:39] [config] embedding-fix-trg: false
[2023-07-28 02:21:39] [config] embedding-normalization: false
[2023-07-28 02:21:39] [config] embedding-vectors:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] enc-cell: gru
[2023-07-28 02:21:39] [config] enc-cell-depth: 1
[2023-07-28 02:21:39] [config] enc-depth: 1
[2023-07-28 02:21:39] [config] enc-type: bidirectional
[2023-07-28 02:21:39] [config] english-title-case-every: 0
[2023-07-28 02:21:39] [config] exponential-smoothing: 0
[2023-07-28 02:21:39] [config] factor-weight: 1
[2023-07-28 02:21:39] [config] factors-combine: sum
[2023-07-28 02:21:39] [config] factors-dim-emb: 0
[2023-07-28 02:21:39] [config] gradient-checkpointing: false
[2023-07-28 02:21:39] [config] gradient-norm-average-window: 100
[2023-07-28 02:21:39] [config] guided-alignment: none
[2023-07-28 02:21:39] [config] guided-alignment-cost: mse
[2023-07-28 02:21:39] [config] guided-alignment-weight: 0.1
[2023-07-28 02:21:39] [config] ignore-model-config: false
[2023-07-28 02:21:39] [config] input-types:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] interpolate-env-vars: false
[2023-07-28 02:21:39] [config] keep-best: false
[2023-07-28 02:21:39] [config] label-smoothing: 0
[2023-07-28 02:21:39] [config] layer-normalization: false
[2023-07-28 02:21:39] [config] learn-rate: 0.0001
[2023-07-28 02:21:39] [config] lemma-dependency: ""
[2023-07-28 02:21:39] [config] lemma-dim-emb: 0
[2023-07-28 02:21:39] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:21:39] [config] log-level: info
[2023-07-28 02:21:39] [config] log-time-zone: ""
[2023-07-28 02:21:39] [config] logical-epoch:
[2023-07-28 02:21:39] [config]   - 1e
[2023-07-28 02:21:39] [config]   - 0
[2023-07-28 02:21:39] [config] lr-decay: 0
[2023-07-28 02:21:39] [config] lr-decay-freq: 50000
[2023-07-28 02:21:39] [config] lr-decay-inv-sqrt:
[2023-07-28 02:21:39] [config]   - 0
[2023-07-28 02:21:39] [config] lr-decay-repeat-warmup: false
[2023-07-28 02:21:39] [config] lr-decay-reset-optimizer: false
[2023-07-28 02:21:39] [config] lr-decay-start:
[2023-07-28 02:21:39] [config]   - 10
[2023-07-28 02:21:39] [config]   - 1
[2023-07-28 02:21:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 02:21:39] [config] lr-report: false
[2023-07-28 02:21:39] [config] lr-warmup: 0
[2023-07-28 02:21:39] [config] lr-warmup-at-reload: false
[2023-07-28 02:21:39] [config] lr-warmup-cycle: false
[2023-07-28 02:21:39] [config] lr-warmup-start-rate: 0
[2023-07-28 02:21:39] [config] max-length: 50
[2023-07-28 02:21:39] [config] max-length-crop: true
[2023-07-28 02:21:39] [config] max-length-factor: 3
[2023-07-28 02:21:39] [config] maxi-batch: 100
[2023-07-28 02:21:39] [config] maxi-batch-sort: trg
[2023-07-28 02:21:39] [config] mini-batch: 64
[2023-07-28 02:21:39] [config] mini-batch-fit: true
[2023-07-28 02:21:39] [config] mini-batch-fit-step: 10
[2023-07-28 02:21:39] [config] mini-batch-round-up: true
[2023-07-28 02:21:39] [config] mini-batch-track-lr: false
[2023-07-28 02:21:39] [config] mini-batch-warmup: 0
[2023-07-28 02:21:39] [config] mini-batch-words: 0
[2023-07-28 02:21:39] [config] mini-batch-words-ref: 0
[2023-07-28 02:21:39] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:21:39] [config] multi-loss-type: sum
[2023-07-28 02:21:39] [config] n-best: false
[2023-07-28 02:21:39] [config] no-nccl: false
[2023-07-28 02:21:39] [config] no-reload: false
[2023-07-28 02:21:39] [config] no-restore-corpus: false
[2023-07-28 02:21:39] [config] normalize: 0
[2023-07-28 02:21:39] [config] normalize-gradient: false
[2023-07-28 02:21:39] [config] num-devices: 0
[2023-07-28 02:21:39] [config] optimizer: adam
[2023-07-28 02:21:39] [config] optimizer-delay: 1
[2023-07-28 02:21:39] [config] optimizer-params:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] output-omit-bias: false
[2023-07-28 02:21:39] [config] overwrite: true
[2023-07-28 02:21:39] [config] precision:
[2023-07-28 02:21:39] [config]   - float16
[2023-07-28 02:21:39] [config]   - float32
[2023-07-28 02:21:39] [config] pretrained-model: ""
[2023-07-28 02:21:39] [config] quantize-biases: false
[2023-07-28 02:21:39] [config] quantize-bits: 0
[2023-07-28 02:21:39] [config] quantize-log-based: false
[2023-07-28 02:21:39] [config] quantize-optimization-steps: 0
[2023-07-28 02:21:39] [config] quiet: false
[2023-07-28 02:21:39] [config] quiet-translation: true
[2023-07-28 02:21:39] [config] relative-paths: false
[2023-07-28 02:21:39] [config] right-left: false
[2023-07-28 02:21:39] [config] save-freq: 10000u
[2023-07-28 02:21:39] [config] seed: 1234
[2023-07-28 02:21:39] [config] sentencepiece-alphas:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] sentencepiece-max-lines: 2000000
[2023-07-28 02:21:39] [config] sentencepiece-options: ""
[2023-07-28 02:21:39] [config] sharding: global
[2023-07-28 02:21:39] [config] shuffle: data
[2023-07-28 02:21:39] [config] shuffle-in-ram: false
[2023-07-28 02:21:39] [config] sigterm: save-and-exit
[2023-07-28 02:21:39] [config] skip: false
[2023-07-28 02:21:39] [config] sqlite: ""
[2023-07-28 02:21:39] [config] sqlite-drop: false
[2023-07-28 02:21:39] [config] sync-freq: 200u
[2023-07-28 02:21:39] [config] sync-sgd: false
[2023-07-28 02:21:39] [config] tempdir: /tmp
[2023-07-28 02:21:39] [config] tied-embeddings: false
[2023-07-28 02:21:39] [config] tied-embeddings-all: true
[2023-07-28 02:21:39] [config] tied-embeddings-src: false
[2023-07-28 02:21:39] [config] train-embedder-rank:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] train-sets:
[2023-07-28 02:21:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 02:21:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 02:21:39] [config] transformer-aan-activation: swish
[2023-07-28 02:21:39] [config] transformer-aan-depth: 2
[2023-07-28 02:21:39] [config] transformer-aan-nogate: false
[2023-07-28 02:21:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 02:21:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 02:21:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 02:21:39] [config] transformer-depth-scaling: false
[2023-07-28 02:21:39] [config] transformer-dim-aan: 2048
[2023-07-28 02:21:39] [config] transformer-dim-ffn: 2048
[2023-07-28 02:21:39] [config] transformer-dropout: 0
[2023-07-28 02:21:39] [config] transformer-dropout-attention: 0
[2023-07-28 02:21:39] [config] transformer-dropout-ffn: 0
[2023-07-28 02:21:39] [config] transformer-ffn-activation: swish
[2023-07-28 02:21:39] [config] transformer-ffn-depth: 2
[2023-07-28 02:21:39] [config] transformer-guided-alignment-layer: last
[2023-07-28 02:21:39] [config] transformer-heads: 8
[2023-07-28 02:21:39] [config] transformer-no-projection: false
[2023-07-28 02:21:39] [config] transformer-pool: false
[2023-07-28 02:21:39] [config] transformer-postprocess: dan
[2023-07-28 02:21:39] [config] transformer-postprocess-emb: d
[2023-07-28 02:21:39] [config] transformer-postprocess-top: ""
[2023-07-28 02:21:39] [config] transformer-preprocess: ""
[2023-07-28 02:21:39] [config] transformer-tied-layers:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] transformer-train-position-embeddings: false
[2023-07-28 02:21:39] [config] tsv: false
[2023-07-28 02:21:39] [config] tsv-fields: 0
[2023-07-28 02:21:39] [config] type: s2s
[2023-07-28 02:21:39] [config] ulr: false
[2023-07-28 02:21:39] [config] ulr-dim-emb: 0
[2023-07-28 02:21:39] [config] ulr-dropout: 0
[2023-07-28 02:21:39] [config] ulr-keys-vectors: ""
[2023-07-28 02:21:39] [config] ulr-query-vectors: ""
[2023-07-28 02:21:39] [config] ulr-softmax-temperature: 1
[2023-07-28 02:21:39] [config] ulr-trainable-transformation: false
[2023-07-28 02:21:39] [config] unlikelihood-loss: false
[2023-07-28 02:21:39] [config] valid-freq: 50000000
[2023-07-28 02:21:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:21:39] [config] valid-max-length: 1000
[2023-07-28 02:21:39] [config] valid-metrics:
[2023-07-28 02:21:39] [config]   - translation
[2023-07-28 02:21:39] [config] valid-mini-batch: 32
[2023-07-28 02:21:39] [config] valid-reset-stalled: false
[2023-07-28 02:21:39] [config] valid-script-args:
[2023-07-28 02:21:39] [config]   []
[2023-07-28 02:21:39] [config] valid-script-path: ""
[2023-07-28 02:21:39] [config] valid-sets:
[2023-07-28 02:21:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 02:21:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 02:21:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 02:21:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:21:39] [config] vocabs:
[2023-07-28 02:21:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:21:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:21:39] [config] word-penalty: 0
[2023-07-28 02:21:39] [config] word-scores: false
[2023-07-28 02:21:39] [config] workspace: 5500
[2023-07-28 02:21:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:21:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:21:39] [training] Using single-device training
[2023-07-28 02:21:40] Synced seed 1234
[2023-07-28 02:21:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:21:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 02:21:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:21:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 02:21:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 02:21:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:21:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 02:21:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:21:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:21:40] [comm] Using global sharding
[2023-07-28 02:21:41] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:21:41] [training] Using 1 GPUs
[2023-07-28 02:21:41] [logits] Applying loss function for 1 factor(s)
[2023-07-28 02:21:41] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:21:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 02:21:41] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:26:09] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 02:26:09] [valid] No post-processing script given for validating translator
[2023-07-28 02:26:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:26:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:26:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:26:09] [comm] Using global sharding
[2023-07-28 02:26:10] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:26:10] [training] Using 1 GPUs
[2023-07-28 02:26:10] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:26:11] Allocating memory for general optimizer shards
[2023-07-28 02:26:11] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:26:11] Loading Adam parameters
[2023-07-28 02:26:11] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:26:11] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:26:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 02:26:11] [data] Restoring the corpus state to epoch 81, batch 2184
[2023-07-28 02:26:11] [data] Shuffling data
[2023-07-28 02:26:11] [data] Done reading 20,192 sentences
[2023-07-28 02:26:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:26:11] Training started
[2023-07-28 02:26:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 02:26:12] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:26:14] Parameter type float16, optimization type float32, casting types true
[2023-07-28 02:27:27] Seen 20,192 samples
[2023-07-28 02:27:27] Starting data epoch 82 in logical epoch 82
[2023-07-28 02:27:27] [data] Shuffling data
[2023-07-28 02:27:27] [data] Done reading 20,192 sentences
[2023-07-28 02:27:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:28:41] Seen 20,192 samples
[2023-07-28 02:28:41] Starting data epoch 83 in logical epoch 83
[2023-07-28 02:28:41] [data] Shuffling data
[2023-07-28 02:28:41] [data] Done reading 20,192 sentences
[2023-07-28 02:28:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:29:58] Seen 20,192 samples
[2023-07-28 02:29:58] Starting data epoch 84 in logical epoch 84
[2023-07-28 02:29:58] [data] Shuffling data
[2023-07-28 02:29:58] [data] Done reading 20,192 sentences
[2023-07-28 02:29:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:31:17] Seen 20,192 samples
[2023-07-28 02:31:17] Starting data epoch 85 in logical epoch 85
[2023-07-28 02:31:17] [data] Shuffling data
[2023-07-28 02:31:17] [data] Done reading 20,192 sentences
[2023-07-28 02:31:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:32:34] Seen 20,192 samples
[2023-07-28 02:32:34] Starting data epoch 86 in logical epoch 86
[2023-07-28 02:32:34] [data] Shuffling data
[2023-07-28 02:32:34] [data] Done reading 20,192 sentences
[2023-07-28 02:32:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:33:52] Seen 20,192 samples
[2023-07-28 02:33:52] Starting data epoch 87 in logical epoch 87
[2023-07-28 02:33:52] [data] Shuffling data
[2023-07-28 02:33:52] [data] Done reading 20,192 sentences
[2023-07-28 02:33:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:35:12] Seen 20,192 samples
[2023-07-28 02:35:12] Starting data epoch 88 in logical epoch 88
[2023-07-28 02:35:12] [data] Shuffling data
[2023-07-28 02:35:12] [data] Done reading 20,192 sentences
[2023-07-28 02:35:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:36:31] Seen 20,192 samples
[2023-07-28 02:36:31] Starting data epoch 89 in logical epoch 89
[2023-07-28 02:36:31] [data] Shuffling data
[2023-07-28 02:36:31] [data] Done reading 20,192 sentences
[2023-07-28 02:36:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:37:50] Seen 20,192 samples
[2023-07-28 02:37:50] Starting data epoch 90 in logical epoch 90
[2023-07-28 02:37:50] [data] Shuffling data
[2023-07-28 02:37:50] [data] Done reading 20,192 sentences
[2023-07-28 02:37:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:39:09] Seen 20,192 samples
[2023-07-28 02:39:09] Starting data epoch 91 in logical epoch 91
[2023-07-28 02:39:09] Training finished
[2023-07-28 02:39:49] [valid] Ep. 91 : Up. 2456 : translation : 0 : new best
[2023-07-28 02:39:49] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:39:51] Saving Adam parameters
[2023-07-28 02:39:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 02:39:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:39:58] [marian] Running on node05.datos.cluster.uy as process 19831 with command line:
[2023-07-28 02:39:58] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 02:39:58] [config] after: 0e
[2023-07-28 02:39:58] [config] after-batches: 0
[2023-07-28 02:39:58] [config] after-epochs: 100
[2023-07-28 02:39:58] [config] all-caps-every: 0
[2023-07-28 02:39:58] [config] allow-unk: false
[2023-07-28 02:39:58] [config] authors: false
[2023-07-28 02:39:58] [config] beam-size: 12
[2023-07-28 02:39:58] [config] bert-class-symbol: "[CLS]"
[2023-07-28 02:39:58] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 02:39:58] [config] bert-masking-fraction: 0.15
[2023-07-28 02:39:58] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 02:39:58] [config] bert-train-type-embeddings: true
[2023-07-28 02:39:58] [config] bert-type-vocab-size: 2
[2023-07-28 02:39:58] [config] build-info: ""
[2023-07-28 02:39:58] [config] check-gradient-nan: false
[2023-07-28 02:39:58] [config] check-nan: false
[2023-07-28 02:39:58] [config] cite: false
[2023-07-28 02:39:58] [config] clip-norm: 1
[2023-07-28 02:39:58] [config] cost-scaling:
[2023-07-28 02:39:58] [config]   - 256.f
[2023-07-28 02:39:58] [config]   - 1000
[2023-07-28 02:39:58] [config]   - 2.f
[2023-07-28 02:39:58] [config]   - 256.f
[2023-07-28 02:39:58] [config] cost-type: ce-sum
[2023-07-28 02:39:58] [config] cpu-threads: 0
[2023-07-28 02:39:58] [config] data-threads: 8
[2023-07-28 02:39:58] [config] data-weighting: ""
[2023-07-28 02:39:58] [config] data-weighting-type: sentence
[2023-07-28 02:39:58] [config] dec-cell: gru
[2023-07-28 02:39:58] [config] dec-cell-base-depth: 2
[2023-07-28 02:39:58] [config] dec-cell-high-depth: 1
[2023-07-28 02:39:58] [config] dec-depth: 1
[2023-07-28 02:39:58] [config] devices:
[2023-07-28 02:39:58] [config]   - 0
[2023-07-28 02:39:58] [config] dim-emb: 512
[2023-07-28 02:39:58] [config] dim-rnn: 1024
[2023-07-28 02:39:58] [config] dim-vocabs:
[2023-07-28 02:39:58] [config]   - 16384
[2023-07-28 02:39:58] [config]   - 16384
[2023-07-28 02:39:58] [config] disp-first: 0
[2023-07-28 02:39:58] [config] disp-freq: 1000u
[2023-07-28 02:39:58] [config] disp-label-counts: true
[2023-07-28 02:39:58] [config] dropout-rnn: 0
[2023-07-28 02:39:58] [config] dropout-src: 0
[2023-07-28 02:39:58] [config] dropout-trg: 0
[2023-07-28 02:39:58] [config] dump-config: ""
[2023-07-28 02:39:58] [config] dynamic-gradient-scaling:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] early-stopping: 1000
[2023-07-28 02:39:58] [config] early-stopping-on: first
[2023-07-28 02:39:58] [config] embedding-fix-src: false
[2023-07-28 02:39:58] [config] embedding-fix-trg: false
[2023-07-28 02:39:58] [config] embedding-normalization: false
[2023-07-28 02:39:58] [config] embedding-vectors:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] enc-cell: gru
[2023-07-28 02:39:58] [config] enc-cell-depth: 1
[2023-07-28 02:39:58] [config] enc-depth: 1
[2023-07-28 02:39:58] [config] enc-type: bidirectional
[2023-07-28 02:39:58] [config] english-title-case-every: 0
[2023-07-28 02:39:58] [config] exponential-smoothing: 0
[2023-07-28 02:39:58] [config] factor-weight: 1
[2023-07-28 02:39:58] [config] factors-combine: sum
[2023-07-28 02:39:58] [config] factors-dim-emb: 0
[2023-07-28 02:39:58] [config] gradient-checkpointing: false
[2023-07-28 02:39:58] [config] gradient-norm-average-window: 100
[2023-07-28 02:39:58] [config] guided-alignment: none
[2023-07-28 02:39:58] [config] guided-alignment-cost: mse
[2023-07-28 02:39:58] [config] guided-alignment-weight: 0.1
[2023-07-28 02:39:58] [config] ignore-model-config: false
[2023-07-28 02:39:58] [config] input-types:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] interpolate-env-vars: false
[2023-07-28 02:39:58] [config] keep-best: false
[2023-07-28 02:39:58] [config] label-smoothing: 0
[2023-07-28 02:39:58] [config] layer-normalization: false
[2023-07-28 02:39:58] [config] learn-rate: 0.0001
[2023-07-28 02:39:58] [config] lemma-dependency: ""
[2023-07-28 02:39:58] [config] lemma-dim-emb: 0
[2023-07-28 02:39:58] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:39:58] [config] log-level: info
[2023-07-28 02:39:58] [config] log-time-zone: ""
[2023-07-28 02:39:58] [config] logical-epoch:
[2023-07-28 02:39:58] [config]   - 1e
[2023-07-28 02:39:58] [config]   - 0
[2023-07-28 02:39:58] [config] lr-decay: 0
[2023-07-28 02:39:58] [config] lr-decay-freq: 50000
[2023-07-28 02:39:58] [config] lr-decay-inv-sqrt:
[2023-07-28 02:39:58] [config]   - 0
[2023-07-28 02:39:58] [config] lr-decay-repeat-warmup: false
[2023-07-28 02:39:58] [config] lr-decay-reset-optimizer: false
[2023-07-28 02:39:58] [config] lr-decay-start:
[2023-07-28 02:39:58] [config]   - 10
[2023-07-28 02:39:58] [config]   - 1
[2023-07-28 02:39:58] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 02:39:58] [config] lr-report: false
[2023-07-28 02:39:58] [config] lr-warmup: 0
[2023-07-28 02:39:58] [config] lr-warmup-at-reload: false
[2023-07-28 02:39:58] [config] lr-warmup-cycle: false
[2023-07-28 02:39:58] [config] lr-warmup-start-rate: 0
[2023-07-28 02:39:58] [config] max-length: 50
[2023-07-28 02:39:58] [config] max-length-crop: true
[2023-07-28 02:39:58] [config] max-length-factor: 3
[2023-07-28 02:39:58] [config] maxi-batch: 100
[2023-07-28 02:39:58] [config] maxi-batch-sort: trg
[2023-07-28 02:39:58] [config] mini-batch: 64
[2023-07-28 02:39:58] [config] mini-batch-fit: true
[2023-07-28 02:39:58] [config] mini-batch-fit-step: 10
[2023-07-28 02:39:58] [config] mini-batch-round-up: true
[2023-07-28 02:39:58] [config] mini-batch-track-lr: false
[2023-07-28 02:39:58] [config] mini-batch-warmup: 0
[2023-07-28 02:39:58] [config] mini-batch-words: 0
[2023-07-28 02:39:58] [config] mini-batch-words-ref: 0
[2023-07-28 02:39:58] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:39:58] [config] multi-loss-type: sum
[2023-07-28 02:39:58] [config] n-best: false
[2023-07-28 02:39:58] [config] no-nccl: false
[2023-07-28 02:39:58] [config] no-reload: false
[2023-07-28 02:39:58] [config] no-restore-corpus: false
[2023-07-28 02:39:58] [config] normalize: 0
[2023-07-28 02:39:58] [config] normalize-gradient: false
[2023-07-28 02:39:58] [config] num-devices: 0
[2023-07-28 02:39:58] [config] optimizer: adam
[2023-07-28 02:39:58] [config] optimizer-delay: 1
[2023-07-28 02:39:58] [config] optimizer-params:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] output-omit-bias: false
[2023-07-28 02:39:58] [config] overwrite: true
[2023-07-28 02:39:58] [config] precision:
[2023-07-28 02:39:58] [config]   - float16
[2023-07-28 02:39:58] [config]   - float32
[2023-07-28 02:39:58] [config] pretrained-model: ""
[2023-07-28 02:39:58] [config] quantize-biases: false
[2023-07-28 02:39:58] [config] quantize-bits: 0
[2023-07-28 02:39:58] [config] quantize-log-based: false
[2023-07-28 02:39:58] [config] quantize-optimization-steps: 0
[2023-07-28 02:39:58] [config] quiet: false
[2023-07-28 02:39:58] [config] quiet-translation: true
[2023-07-28 02:39:58] [config] relative-paths: false
[2023-07-28 02:39:58] [config] right-left: false
[2023-07-28 02:39:58] [config] save-freq: 10000u
[2023-07-28 02:39:58] [config] seed: 1234
[2023-07-28 02:39:58] [config] sentencepiece-alphas:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] sentencepiece-max-lines: 2000000
[2023-07-28 02:39:58] [config] sentencepiece-options: ""
[2023-07-28 02:39:58] [config] sharding: global
[2023-07-28 02:39:58] [config] shuffle: data
[2023-07-28 02:39:58] [config] shuffle-in-ram: false
[2023-07-28 02:39:58] [config] sigterm: save-and-exit
[2023-07-28 02:39:58] [config] skip: false
[2023-07-28 02:39:58] [config] sqlite: ""
[2023-07-28 02:39:58] [config] sqlite-drop: false
[2023-07-28 02:39:58] [config] sync-freq: 200u
[2023-07-28 02:39:58] [config] sync-sgd: false
[2023-07-28 02:39:58] [config] tempdir: /tmp
[2023-07-28 02:39:58] [config] tied-embeddings: false
[2023-07-28 02:39:58] [config] tied-embeddings-all: true
[2023-07-28 02:39:58] [config] tied-embeddings-src: false
[2023-07-28 02:39:58] [config] train-embedder-rank:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] train-sets:
[2023-07-28 02:39:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 02:39:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 02:39:58] [config] transformer-aan-activation: swish
[2023-07-28 02:39:58] [config] transformer-aan-depth: 2
[2023-07-28 02:39:58] [config] transformer-aan-nogate: false
[2023-07-28 02:39:58] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 02:39:58] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 02:39:58] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 02:39:58] [config] transformer-depth-scaling: false
[2023-07-28 02:39:58] [config] transformer-dim-aan: 2048
[2023-07-28 02:39:58] [config] transformer-dim-ffn: 2048
[2023-07-28 02:39:58] [config] transformer-dropout: 0
[2023-07-28 02:39:58] [config] transformer-dropout-attention: 0
[2023-07-28 02:39:58] [config] transformer-dropout-ffn: 0
[2023-07-28 02:39:58] [config] transformer-ffn-activation: swish
[2023-07-28 02:39:58] [config] transformer-ffn-depth: 2
[2023-07-28 02:39:58] [config] transformer-guided-alignment-layer: last
[2023-07-28 02:39:58] [config] transformer-heads: 8
[2023-07-28 02:39:58] [config] transformer-no-projection: false
[2023-07-28 02:39:58] [config] transformer-pool: false
[2023-07-28 02:39:58] [config] transformer-postprocess: dan
[2023-07-28 02:39:58] [config] transformer-postprocess-emb: d
[2023-07-28 02:39:58] [config] transformer-postprocess-top: ""
[2023-07-28 02:39:58] [config] transformer-preprocess: ""
[2023-07-28 02:39:58] [config] transformer-tied-layers:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] transformer-train-position-embeddings: false
[2023-07-28 02:39:58] [config] tsv: false
[2023-07-28 02:39:58] [config] tsv-fields: 0
[2023-07-28 02:39:58] [config] type: s2s
[2023-07-28 02:39:58] [config] ulr: false
[2023-07-28 02:39:58] [config] ulr-dim-emb: 0
[2023-07-28 02:39:58] [config] ulr-dropout: 0
[2023-07-28 02:39:58] [config] ulr-keys-vectors: ""
[2023-07-28 02:39:58] [config] ulr-query-vectors: ""
[2023-07-28 02:39:58] [config] ulr-softmax-temperature: 1
[2023-07-28 02:39:58] [config] ulr-trainable-transformation: false
[2023-07-28 02:39:58] [config] unlikelihood-loss: false
[2023-07-28 02:39:58] [config] valid-freq: 50000000
[2023-07-28 02:39:58] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:39:58] [config] valid-max-length: 1000
[2023-07-28 02:39:58] [config] valid-metrics:
[2023-07-28 02:39:58] [config]   - translation
[2023-07-28 02:39:58] [config] valid-mini-batch: 32
[2023-07-28 02:39:58] [config] valid-reset-stalled: false
[2023-07-28 02:39:58] [config] valid-script-args:
[2023-07-28 02:39:58] [config]   []
[2023-07-28 02:39:58] [config] valid-script-path: ""
[2023-07-28 02:39:58] [config] valid-sets:
[2023-07-28 02:39:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 02:39:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 02:39:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 02:39:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:39:58] [config] vocabs:
[2023-07-28 02:39:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:39:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:39:58] [config] word-penalty: 0
[2023-07-28 02:39:58] [config] word-scores: false
[2023-07-28 02:39:58] [config] workspace: 5500
[2023-07-28 02:39:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:39:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:39:58] [training] Using single-device training
[2023-07-28 02:39:58] Synced seed 1234
[2023-07-28 02:39:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:39:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 02:39:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:39:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 02:39:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 02:39:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:39:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 02:39:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:39:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:39:59] [comm] Using global sharding
[2023-07-28 02:39:59] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:39:59] [training] Using 1 GPUs
[2023-07-28 02:39:59] [logits] Applying loss function for 1 factor(s)
[2023-07-28 02:39:59] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:39:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 02:40:00] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:44:28] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 02:44:28] [valid] No post-processing script given for validating translator
[2023-07-28 02:44:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:44:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:44:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:44:28] [comm] Using global sharding
[2023-07-28 02:44:28] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:44:28] [training] Using 1 GPUs
[2023-07-28 02:44:28] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:44:29] Allocating memory for general optimizer shards
[2023-07-28 02:44:29] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:44:29] Loading Adam parameters
[2023-07-28 02:44:29] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:44:29] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:44:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 02:44:30] [data] Restoring the corpus state to epoch 91, batch 2456
[2023-07-28 02:44:30] [data] Shuffling data
[2023-07-28 02:44:30] [data] Done reading 20,192 sentences
[2023-07-28 02:44:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:44:30] Training started
[2023-07-28 02:44:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 02:44:30] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:44:33] Parameter type float16, optimization type float32, casting types true
[2023-07-28 02:45:43] Seen 20,192 samples
[2023-07-28 02:45:43] Starting data epoch 92 in logical epoch 92
[2023-07-28 02:45:43] [data] Shuffling data
[2023-07-28 02:45:43] [data] Done reading 20,192 sentences
[2023-07-28 02:45:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:46:55] Seen 20,192 samples
[2023-07-28 02:46:55] Starting data epoch 93 in logical epoch 93
[2023-07-28 02:46:55] [data] Shuffling data
[2023-07-28 02:46:55] [data] Done reading 20,192 sentences
[2023-07-28 02:46:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:48:10] Seen 20,192 samples
[2023-07-28 02:48:10] Starting data epoch 94 in logical epoch 94
[2023-07-28 02:48:10] [data] Shuffling data
[2023-07-28 02:48:10] [data] Done reading 20,192 sentences
[2023-07-28 02:48:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:49:28] Seen 20,192 samples
[2023-07-28 02:49:28] Starting data epoch 95 in logical epoch 95
[2023-07-28 02:49:28] [data] Shuffling data
[2023-07-28 02:49:28] [data] Done reading 20,192 sentences
[2023-07-28 02:49:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:50:46] Seen 20,192 samples
[2023-07-28 02:50:46] Starting data epoch 96 in logical epoch 96
[2023-07-28 02:50:46] [data] Shuffling data
[2023-07-28 02:50:46] [data] Done reading 20,192 sentences
[2023-07-28 02:50:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:52:04] Seen 20,192 samples
[2023-07-28 02:52:04] Starting data epoch 97 in logical epoch 97
[2023-07-28 02:52:04] [data] Shuffling data
[2023-07-28 02:52:04] [data] Done reading 20,192 sentences
[2023-07-28 02:52:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:53:21] Seen 20,192 samples
[2023-07-28 02:53:21] Starting data epoch 98 in logical epoch 98
[2023-07-28 02:53:21] [data] Shuffling data
[2023-07-28 02:53:21] [data] Done reading 20,192 sentences
[2023-07-28 02:53:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:54:39] Seen 20,192 samples
[2023-07-28 02:54:39] Starting data epoch 99 in logical epoch 99
[2023-07-28 02:54:39] [data] Shuffling data
[2023-07-28 02:54:39] [data] Done reading 20,192 sentences
[2023-07-28 02:54:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:55:58] Seen 20,192 samples
[2023-07-28 02:55:58] Starting data epoch 100 in logical epoch 100
[2023-07-28 02:55:58] [data] Shuffling data
[2023-07-28 02:55:58] [data] Done reading 20,192 sentences
[2023-07-28 02:55:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:57:16] Seen 20,192 samples
[2023-07-28 02:57:16] Starting data epoch 101 in logical epoch 101
[2023-07-28 02:57:16] Training finished
[2023-07-28 02:57:59] [valid] Ep. 101 : Up. 2728 : translation : 0 : new best
[2023-07-28 02:57:59] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:58:01] Saving Adam parameters
[2023-07-28 02:58:01] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 02:58:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:58:10] [marian] Running on node05.datos.cluster.uy as process 21151 with command line:
[2023-07-28 02:58:10] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 02:58:10] [config] after: 0e
[2023-07-28 02:58:10] [config] after-batches: 0
[2023-07-28 02:58:10] [config] after-epochs: 110
[2023-07-28 02:58:10] [config] all-caps-every: 0
[2023-07-28 02:58:10] [config] allow-unk: false
[2023-07-28 02:58:10] [config] authors: false
[2023-07-28 02:58:10] [config] beam-size: 12
[2023-07-28 02:58:10] [config] bert-class-symbol: "[CLS]"
[2023-07-28 02:58:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 02:58:10] [config] bert-masking-fraction: 0.15
[2023-07-28 02:58:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 02:58:10] [config] bert-train-type-embeddings: true
[2023-07-28 02:58:10] [config] bert-type-vocab-size: 2
[2023-07-28 02:58:10] [config] build-info: ""
[2023-07-28 02:58:10] [config] check-gradient-nan: false
[2023-07-28 02:58:10] [config] check-nan: false
[2023-07-28 02:58:10] [config] cite: false
[2023-07-28 02:58:10] [config] clip-norm: 1
[2023-07-28 02:58:10] [config] cost-scaling:
[2023-07-28 02:58:10] [config]   - 256.f
[2023-07-28 02:58:10] [config]   - 1000
[2023-07-28 02:58:10] [config]   - 2.f
[2023-07-28 02:58:10] [config]   - 256.f
[2023-07-28 02:58:10] [config] cost-type: ce-sum
[2023-07-28 02:58:10] [config] cpu-threads: 0
[2023-07-28 02:58:10] [config] data-threads: 8
[2023-07-28 02:58:10] [config] data-weighting: ""
[2023-07-28 02:58:10] [config] data-weighting-type: sentence
[2023-07-28 02:58:10] [config] dec-cell: gru
[2023-07-28 02:58:10] [config] dec-cell-base-depth: 2
[2023-07-28 02:58:10] [config] dec-cell-high-depth: 1
[2023-07-28 02:58:10] [config] dec-depth: 1
[2023-07-28 02:58:10] [config] devices:
[2023-07-28 02:58:10] [config]   - 0
[2023-07-28 02:58:10] [config] dim-emb: 512
[2023-07-28 02:58:10] [config] dim-rnn: 1024
[2023-07-28 02:58:10] [config] dim-vocabs:
[2023-07-28 02:58:10] [config]   - 16384
[2023-07-28 02:58:10] [config]   - 16384
[2023-07-28 02:58:10] [config] disp-first: 0
[2023-07-28 02:58:10] [config] disp-freq: 1000u
[2023-07-28 02:58:10] [config] disp-label-counts: true
[2023-07-28 02:58:10] [config] dropout-rnn: 0
[2023-07-28 02:58:10] [config] dropout-src: 0
[2023-07-28 02:58:10] [config] dropout-trg: 0
[2023-07-28 02:58:10] [config] dump-config: ""
[2023-07-28 02:58:10] [config] dynamic-gradient-scaling:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] early-stopping: 1000
[2023-07-28 02:58:10] [config] early-stopping-on: first
[2023-07-28 02:58:10] [config] embedding-fix-src: false
[2023-07-28 02:58:10] [config] embedding-fix-trg: false
[2023-07-28 02:58:10] [config] embedding-normalization: false
[2023-07-28 02:58:10] [config] embedding-vectors:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] enc-cell: gru
[2023-07-28 02:58:10] [config] enc-cell-depth: 1
[2023-07-28 02:58:10] [config] enc-depth: 1
[2023-07-28 02:58:10] [config] enc-type: bidirectional
[2023-07-28 02:58:10] [config] english-title-case-every: 0
[2023-07-28 02:58:10] [config] exponential-smoothing: 0
[2023-07-28 02:58:10] [config] factor-weight: 1
[2023-07-28 02:58:10] [config] factors-combine: sum
[2023-07-28 02:58:10] [config] factors-dim-emb: 0
[2023-07-28 02:58:10] [config] gradient-checkpointing: false
[2023-07-28 02:58:10] [config] gradient-norm-average-window: 100
[2023-07-28 02:58:10] [config] guided-alignment: none
[2023-07-28 02:58:10] [config] guided-alignment-cost: mse
[2023-07-28 02:58:10] [config] guided-alignment-weight: 0.1
[2023-07-28 02:58:10] [config] ignore-model-config: false
[2023-07-28 02:58:10] [config] input-types:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] interpolate-env-vars: false
[2023-07-28 02:58:10] [config] keep-best: false
[2023-07-28 02:58:10] [config] label-smoothing: 0
[2023-07-28 02:58:10] [config] layer-normalization: false
[2023-07-28 02:58:10] [config] learn-rate: 0.0001
[2023-07-28 02:58:10] [config] lemma-dependency: ""
[2023-07-28 02:58:10] [config] lemma-dim-emb: 0
[2023-07-28 02:58:10] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:58:10] [config] log-level: info
[2023-07-28 02:58:10] [config] log-time-zone: ""
[2023-07-28 02:58:10] [config] logical-epoch:
[2023-07-28 02:58:10] [config]   - 1e
[2023-07-28 02:58:10] [config]   - 0
[2023-07-28 02:58:10] [config] lr-decay: 0
[2023-07-28 02:58:10] [config] lr-decay-freq: 50000
[2023-07-28 02:58:10] [config] lr-decay-inv-sqrt:
[2023-07-28 02:58:10] [config]   - 0
[2023-07-28 02:58:10] [config] lr-decay-repeat-warmup: false
[2023-07-28 02:58:10] [config] lr-decay-reset-optimizer: false
[2023-07-28 02:58:10] [config] lr-decay-start:
[2023-07-28 02:58:10] [config]   - 10
[2023-07-28 02:58:10] [config]   - 1
[2023-07-28 02:58:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 02:58:10] [config] lr-report: false
[2023-07-28 02:58:10] [config] lr-warmup: 0
[2023-07-28 02:58:10] [config] lr-warmup-at-reload: false
[2023-07-28 02:58:10] [config] lr-warmup-cycle: false
[2023-07-28 02:58:10] [config] lr-warmup-start-rate: 0
[2023-07-28 02:58:10] [config] max-length: 50
[2023-07-28 02:58:10] [config] max-length-crop: true
[2023-07-28 02:58:10] [config] max-length-factor: 3
[2023-07-28 02:58:10] [config] maxi-batch: 100
[2023-07-28 02:58:10] [config] maxi-batch-sort: trg
[2023-07-28 02:58:10] [config] mini-batch: 64
[2023-07-28 02:58:10] [config] mini-batch-fit: true
[2023-07-28 02:58:10] [config] mini-batch-fit-step: 10
[2023-07-28 02:58:10] [config] mini-batch-round-up: true
[2023-07-28 02:58:10] [config] mini-batch-track-lr: false
[2023-07-28 02:58:10] [config] mini-batch-warmup: 0
[2023-07-28 02:58:10] [config] mini-batch-words: 0
[2023-07-28 02:58:10] [config] mini-batch-words-ref: 0
[2023-07-28 02:58:10] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 02:58:10] [config] multi-loss-type: sum
[2023-07-28 02:58:10] [config] n-best: false
[2023-07-28 02:58:10] [config] no-nccl: false
[2023-07-28 02:58:10] [config] no-reload: false
[2023-07-28 02:58:10] [config] no-restore-corpus: false
[2023-07-28 02:58:10] [config] normalize: 0
[2023-07-28 02:58:10] [config] normalize-gradient: false
[2023-07-28 02:58:10] [config] num-devices: 0
[2023-07-28 02:58:10] [config] optimizer: adam
[2023-07-28 02:58:10] [config] optimizer-delay: 1
[2023-07-28 02:58:10] [config] optimizer-params:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] output-omit-bias: false
[2023-07-28 02:58:10] [config] overwrite: true
[2023-07-28 02:58:10] [config] precision:
[2023-07-28 02:58:10] [config]   - float16
[2023-07-28 02:58:10] [config]   - float32
[2023-07-28 02:58:10] [config] pretrained-model: ""
[2023-07-28 02:58:10] [config] quantize-biases: false
[2023-07-28 02:58:10] [config] quantize-bits: 0
[2023-07-28 02:58:10] [config] quantize-log-based: false
[2023-07-28 02:58:10] [config] quantize-optimization-steps: 0
[2023-07-28 02:58:10] [config] quiet: false
[2023-07-28 02:58:10] [config] quiet-translation: true
[2023-07-28 02:58:10] [config] relative-paths: false
[2023-07-28 02:58:10] [config] right-left: false
[2023-07-28 02:58:10] [config] save-freq: 10000u
[2023-07-28 02:58:10] [config] seed: 1234
[2023-07-28 02:58:10] [config] sentencepiece-alphas:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] sentencepiece-max-lines: 2000000
[2023-07-28 02:58:10] [config] sentencepiece-options: ""
[2023-07-28 02:58:10] [config] sharding: global
[2023-07-28 02:58:10] [config] shuffle: data
[2023-07-28 02:58:10] [config] shuffle-in-ram: false
[2023-07-28 02:58:10] [config] sigterm: save-and-exit
[2023-07-28 02:58:10] [config] skip: false
[2023-07-28 02:58:10] [config] sqlite: ""
[2023-07-28 02:58:10] [config] sqlite-drop: false
[2023-07-28 02:58:10] [config] sync-freq: 200u
[2023-07-28 02:58:10] [config] sync-sgd: false
[2023-07-28 02:58:10] [config] tempdir: /tmp
[2023-07-28 02:58:10] [config] tied-embeddings: false
[2023-07-28 02:58:10] [config] tied-embeddings-all: true
[2023-07-28 02:58:10] [config] tied-embeddings-src: false
[2023-07-28 02:58:10] [config] train-embedder-rank:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] train-sets:
[2023-07-28 02:58:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 02:58:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 02:58:10] [config] transformer-aan-activation: swish
[2023-07-28 02:58:10] [config] transformer-aan-depth: 2
[2023-07-28 02:58:10] [config] transformer-aan-nogate: false
[2023-07-28 02:58:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 02:58:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 02:58:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 02:58:10] [config] transformer-depth-scaling: false
[2023-07-28 02:58:10] [config] transformer-dim-aan: 2048
[2023-07-28 02:58:10] [config] transformer-dim-ffn: 2048
[2023-07-28 02:58:10] [config] transformer-dropout: 0
[2023-07-28 02:58:10] [config] transformer-dropout-attention: 0
[2023-07-28 02:58:10] [config] transformer-dropout-ffn: 0
[2023-07-28 02:58:10] [config] transformer-ffn-activation: swish
[2023-07-28 02:58:10] [config] transformer-ffn-depth: 2
[2023-07-28 02:58:10] [config] transformer-guided-alignment-layer: last
[2023-07-28 02:58:10] [config] transformer-heads: 8
[2023-07-28 02:58:10] [config] transformer-no-projection: false
[2023-07-28 02:58:10] [config] transformer-pool: false
[2023-07-28 02:58:10] [config] transformer-postprocess: dan
[2023-07-28 02:58:10] [config] transformer-postprocess-emb: d
[2023-07-28 02:58:10] [config] transformer-postprocess-top: ""
[2023-07-28 02:58:10] [config] transformer-preprocess: ""
[2023-07-28 02:58:10] [config] transformer-tied-layers:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] transformer-train-position-embeddings: false
[2023-07-28 02:58:10] [config] tsv: false
[2023-07-28 02:58:10] [config] tsv-fields: 0
[2023-07-28 02:58:10] [config] type: s2s
[2023-07-28 02:58:10] [config] ulr: false
[2023-07-28 02:58:10] [config] ulr-dim-emb: 0
[2023-07-28 02:58:10] [config] ulr-dropout: 0
[2023-07-28 02:58:10] [config] ulr-keys-vectors: ""
[2023-07-28 02:58:10] [config] ulr-query-vectors: ""
[2023-07-28 02:58:10] [config] ulr-softmax-temperature: 1
[2023-07-28 02:58:10] [config] ulr-trainable-transformation: false
[2023-07-28 02:58:10] [config] unlikelihood-loss: false
[2023-07-28 02:58:10] [config] valid-freq: 50000000
[2023-07-28 02:58:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 02:58:10] [config] valid-max-length: 1000
[2023-07-28 02:58:10] [config] valid-metrics:
[2023-07-28 02:58:10] [config]   - translation
[2023-07-28 02:58:10] [config] valid-mini-batch: 32
[2023-07-28 02:58:10] [config] valid-reset-stalled: false
[2023-07-28 02:58:10] [config] valid-script-args:
[2023-07-28 02:58:10] [config]   []
[2023-07-28 02:58:10] [config] valid-script-path: ""
[2023-07-28 02:58:10] [config] valid-sets:
[2023-07-28 02:58:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 02:58:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 02:58:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 02:58:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:58:10] [config] vocabs:
[2023-07-28 02:58:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:58:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:58:10] [config] word-penalty: 0
[2023-07-28 02:58:10] [config] word-scores: false
[2023-07-28 02:58:10] [config] workspace: 5500
[2023-07-28 02:58:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:58:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:58:10] [training] Using single-device training
[2023-07-28 02:58:10] Synced seed 1234
[2023-07-28 02:58:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:58:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 02:58:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:58:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 02:58:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 02:58:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:58:10] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 02:58:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:58:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:58:11] [comm] Using global sharding
[2023-07-28 02:58:11] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:58:11] [training] Using 1 GPUs
[2023-07-28 02:58:11] [logits] Applying loss function for 1 factor(s)
[2023-07-28 02:58:11] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:58:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 02:58:12] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:02:40] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 03:02:40] [valid] No post-processing script given for validating translator
[2023-07-28 03:02:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:02:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:02:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:02:40] [comm] Using global sharding
[2023-07-28 03:02:40] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:02:40] [training] Using 1 GPUs
[2023-07-28 03:02:40] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:02:41] Allocating memory for general optimizer shards
[2023-07-28 03:02:41] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:02:41] Loading Adam parameters
[2023-07-28 03:02:41] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:02:42] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:02:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 03:02:42] [data] Restoring the corpus state to epoch 101, batch 2728
[2023-07-28 03:02:42] [data] Shuffling data
[2023-07-28 03:02:42] [data] Done reading 20,192 sentences
[2023-07-28 03:02:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:02:42] Training started
[2023-07-28 03:02:42] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 03:02:42] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:02:45] Parameter type float16, optimization type float32, casting types true
[2023-07-28 03:03:56] Seen 20,192 samples
[2023-07-28 03:03:56] Starting data epoch 102 in logical epoch 102
[2023-07-28 03:03:56] [data] Shuffling data
[2023-07-28 03:03:56] [data] Done reading 20,192 sentences
[2023-07-28 03:03:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:05:10] Seen 20,192 samples
[2023-07-28 03:05:10] Starting data epoch 103 in logical epoch 103
[2023-07-28 03:05:10] [data] Shuffling data
[2023-07-28 03:05:10] [data] Done reading 20,192 sentences
[2023-07-28 03:05:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:06:25] Seen 20,192 samples
[2023-07-28 03:06:25] Starting data epoch 104 in logical epoch 104
[2023-07-28 03:06:25] [data] Shuffling data
[2023-07-28 03:06:26] [data] Done reading 20,192 sentences
[2023-07-28 03:06:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:07:44] Seen 20,192 samples
[2023-07-28 03:07:44] Starting data epoch 105 in logical epoch 105
[2023-07-28 03:07:44] [data] Shuffling data
[2023-07-28 03:07:44] [data] Done reading 20,192 sentences
[2023-07-28 03:07:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:09:01] Seen 20,192 samples
[2023-07-28 03:09:01] Starting data epoch 106 in logical epoch 106
[2023-07-28 03:09:01] [data] Shuffling data
[2023-07-28 03:09:01] [data] Done reading 20,192 sentences
[2023-07-28 03:09:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:10:18] Seen 20,192 samples
[2023-07-28 03:10:18] Starting data epoch 107 in logical epoch 107
[2023-07-28 03:10:18] [data] Shuffling data
[2023-07-28 03:10:18] [data] Done reading 20,192 sentences
[2023-07-28 03:10:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:11:37] Seen 20,192 samples
[2023-07-28 03:11:37] Starting data epoch 108 in logical epoch 108
[2023-07-28 03:11:37] [data] Shuffling data
[2023-07-28 03:11:37] [data] Done reading 20,192 sentences
[2023-07-28 03:11:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:12:54] Seen 20,192 samples
[2023-07-28 03:12:54] Starting data epoch 109 in logical epoch 109
[2023-07-28 03:12:54] [data] Shuffling data
[2023-07-28 03:12:54] [data] Done reading 20,192 sentences
[2023-07-28 03:12:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:14:11] Seen 20,192 samples
[2023-07-28 03:14:11] Starting data epoch 110 in logical epoch 110
[2023-07-28 03:14:11] [data] Shuffling data
[2023-07-28 03:14:11] [data] Done reading 20,192 sentences
[2023-07-28 03:14:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:15:29] Seen 20,192 samples
[2023-07-28 03:15:29] Starting data epoch 111 in logical epoch 111
[2023-07-28 03:15:29] Training finished
[2023-07-28 03:16:12] [valid] Ep. 111 : Up. 2998 : translation : 0 : new best
[2023-07-28 03:16:12] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:16:14] Saving Adam parameters
[2023-07-28 03:16:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 03:16:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:16:21] [marian] Running on node05.datos.cluster.uy as process 22188 with command line:
[2023-07-28 03:16:21] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 03:16:21] [config] after: 0e
[2023-07-28 03:16:21] [config] after-batches: 0
[2023-07-28 03:16:21] [config] after-epochs: 120
[2023-07-28 03:16:21] [config] all-caps-every: 0
[2023-07-28 03:16:21] [config] allow-unk: false
[2023-07-28 03:16:21] [config] authors: false
[2023-07-28 03:16:21] [config] beam-size: 12
[2023-07-28 03:16:21] [config] bert-class-symbol: "[CLS]"
[2023-07-28 03:16:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 03:16:21] [config] bert-masking-fraction: 0.15
[2023-07-28 03:16:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 03:16:21] [config] bert-train-type-embeddings: true
[2023-07-28 03:16:21] [config] bert-type-vocab-size: 2
[2023-07-28 03:16:21] [config] build-info: ""
[2023-07-28 03:16:21] [config] check-gradient-nan: false
[2023-07-28 03:16:21] [config] check-nan: false
[2023-07-28 03:16:21] [config] cite: false
[2023-07-28 03:16:21] [config] clip-norm: 1
[2023-07-28 03:16:21] [config] cost-scaling:
[2023-07-28 03:16:21] [config]   - 256.f
[2023-07-28 03:16:21] [config]   - 1000
[2023-07-28 03:16:21] [config]   - 2.f
[2023-07-28 03:16:21] [config]   - 256.f
[2023-07-28 03:16:21] [config] cost-type: ce-sum
[2023-07-28 03:16:21] [config] cpu-threads: 0
[2023-07-28 03:16:21] [config] data-threads: 8
[2023-07-28 03:16:21] [config] data-weighting: ""
[2023-07-28 03:16:21] [config] data-weighting-type: sentence
[2023-07-28 03:16:21] [config] dec-cell: gru
[2023-07-28 03:16:21] [config] dec-cell-base-depth: 2
[2023-07-28 03:16:21] [config] dec-cell-high-depth: 1
[2023-07-28 03:16:21] [config] dec-depth: 1
[2023-07-28 03:16:21] [config] devices:
[2023-07-28 03:16:21] [config]   - 0
[2023-07-28 03:16:21] [config] dim-emb: 512
[2023-07-28 03:16:21] [config] dim-rnn: 1024
[2023-07-28 03:16:21] [config] dim-vocabs:
[2023-07-28 03:16:21] [config]   - 16384
[2023-07-28 03:16:21] [config]   - 16384
[2023-07-28 03:16:21] [config] disp-first: 0
[2023-07-28 03:16:21] [config] disp-freq: 1000u
[2023-07-28 03:16:21] [config] disp-label-counts: true
[2023-07-28 03:16:21] [config] dropout-rnn: 0
[2023-07-28 03:16:21] [config] dropout-src: 0
[2023-07-28 03:16:21] [config] dropout-trg: 0
[2023-07-28 03:16:21] [config] dump-config: ""
[2023-07-28 03:16:21] [config] dynamic-gradient-scaling:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] early-stopping: 1000
[2023-07-28 03:16:21] [config] early-stopping-on: first
[2023-07-28 03:16:21] [config] embedding-fix-src: false
[2023-07-28 03:16:21] [config] embedding-fix-trg: false
[2023-07-28 03:16:21] [config] embedding-normalization: false
[2023-07-28 03:16:21] [config] embedding-vectors:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] enc-cell: gru
[2023-07-28 03:16:21] [config] enc-cell-depth: 1
[2023-07-28 03:16:21] [config] enc-depth: 1
[2023-07-28 03:16:21] [config] enc-type: bidirectional
[2023-07-28 03:16:21] [config] english-title-case-every: 0
[2023-07-28 03:16:21] [config] exponential-smoothing: 0
[2023-07-28 03:16:21] [config] factor-weight: 1
[2023-07-28 03:16:21] [config] factors-combine: sum
[2023-07-28 03:16:21] [config] factors-dim-emb: 0
[2023-07-28 03:16:21] [config] gradient-checkpointing: false
[2023-07-28 03:16:21] [config] gradient-norm-average-window: 100
[2023-07-28 03:16:21] [config] guided-alignment: none
[2023-07-28 03:16:21] [config] guided-alignment-cost: mse
[2023-07-28 03:16:21] [config] guided-alignment-weight: 0.1
[2023-07-28 03:16:21] [config] ignore-model-config: false
[2023-07-28 03:16:21] [config] input-types:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] interpolate-env-vars: false
[2023-07-28 03:16:21] [config] keep-best: false
[2023-07-28 03:16:21] [config] label-smoothing: 0
[2023-07-28 03:16:21] [config] layer-normalization: false
[2023-07-28 03:16:21] [config] learn-rate: 0.0001
[2023-07-28 03:16:21] [config] lemma-dependency: ""
[2023-07-28 03:16:21] [config] lemma-dim-emb: 0
[2023-07-28 03:16:21] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 03:16:21] [config] log-level: info
[2023-07-28 03:16:21] [config] log-time-zone: ""
[2023-07-28 03:16:21] [config] logical-epoch:
[2023-07-28 03:16:21] [config]   - 1e
[2023-07-28 03:16:21] [config]   - 0
[2023-07-28 03:16:21] [config] lr-decay: 0
[2023-07-28 03:16:21] [config] lr-decay-freq: 50000
[2023-07-28 03:16:21] [config] lr-decay-inv-sqrt:
[2023-07-28 03:16:21] [config]   - 0
[2023-07-28 03:16:21] [config] lr-decay-repeat-warmup: false
[2023-07-28 03:16:21] [config] lr-decay-reset-optimizer: false
[2023-07-28 03:16:21] [config] lr-decay-start:
[2023-07-28 03:16:21] [config]   - 10
[2023-07-28 03:16:21] [config]   - 1
[2023-07-28 03:16:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 03:16:21] [config] lr-report: false
[2023-07-28 03:16:21] [config] lr-warmup: 0
[2023-07-28 03:16:21] [config] lr-warmup-at-reload: false
[2023-07-28 03:16:21] [config] lr-warmup-cycle: false
[2023-07-28 03:16:21] [config] lr-warmup-start-rate: 0
[2023-07-28 03:16:21] [config] max-length: 50
[2023-07-28 03:16:21] [config] max-length-crop: true
[2023-07-28 03:16:21] [config] max-length-factor: 3
[2023-07-28 03:16:21] [config] maxi-batch: 100
[2023-07-28 03:16:21] [config] maxi-batch-sort: trg
[2023-07-28 03:16:21] [config] mini-batch: 64
[2023-07-28 03:16:21] [config] mini-batch-fit: true
[2023-07-28 03:16:21] [config] mini-batch-fit-step: 10
[2023-07-28 03:16:21] [config] mini-batch-round-up: true
[2023-07-28 03:16:21] [config] mini-batch-track-lr: false
[2023-07-28 03:16:21] [config] mini-batch-warmup: 0
[2023-07-28 03:16:21] [config] mini-batch-words: 0
[2023-07-28 03:16:21] [config] mini-batch-words-ref: 0
[2023-07-28 03:16:21] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:16:21] [config] multi-loss-type: sum
[2023-07-28 03:16:21] [config] n-best: false
[2023-07-28 03:16:21] [config] no-nccl: false
[2023-07-28 03:16:21] [config] no-reload: false
[2023-07-28 03:16:21] [config] no-restore-corpus: false
[2023-07-28 03:16:21] [config] normalize: 0
[2023-07-28 03:16:21] [config] normalize-gradient: false
[2023-07-28 03:16:21] [config] num-devices: 0
[2023-07-28 03:16:21] [config] optimizer: adam
[2023-07-28 03:16:21] [config] optimizer-delay: 1
[2023-07-28 03:16:21] [config] optimizer-params:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] output-omit-bias: false
[2023-07-28 03:16:21] [config] overwrite: true
[2023-07-28 03:16:21] [config] precision:
[2023-07-28 03:16:21] [config]   - float16
[2023-07-28 03:16:21] [config]   - float32
[2023-07-28 03:16:21] [config] pretrained-model: ""
[2023-07-28 03:16:21] [config] quantize-biases: false
[2023-07-28 03:16:21] [config] quantize-bits: 0
[2023-07-28 03:16:21] [config] quantize-log-based: false
[2023-07-28 03:16:21] [config] quantize-optimization-steps: 0
[2023-07-28 03:16:21] [config] quiet: false
[2023-07-28 03:16:21] [config] quiet-translation: true
[2023-07-28 03:16:21] [config] relative-paths: false
[2023-07-28 03:16:21] [config] right-left: false
[2023-07-28 03:16:21] [config] save-freq: 10000u
[2023-07-28 03:16:21] [config] seed: 1234
[2023-07-28 03:16:21] [config] sentencepiece-alphas:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] sentencepiece-max-lines: 2000000
[2023-07-28 03:16:21] [config] sentencepiece-options: ""
[2023-07-28 03:16:21] [config] sharding: global
[2023-07-28 03:16:21] [config] shuffle: data
[2023-07-28 03:16:21] [config] shuffle-in-ram: false
[2023-07-28 03:16:21] [config] sigterm: save-and-exit
[2023-07-28 03:16:21] [config] skip: false
[2023-07-28 03:16:21] [config] sqlite: ""
[2023-07-28 03:16:21] [config] sqlite-drop: false
[2023-07-28 03:16:21] [config] sync-freq: 200u
[2023-07-28 03:16:21] [config] sync-sgd: false
[2023-07-28 03:16:21] [config] tempdir: /tmp
[2023-07-28 03:16:21] [config] tied-embeddings: false
[2023-07-28 03:16:21] [config] tied-embeddings-all: true
[2023-07-28 03:16:21] [config] tied-embeddings-src: false
[2023-07-28 03:16:21] [config] train-embedder-rank:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] train-sets:
[2023-07-28 03:16:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 03:16:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 03:16:21] [config] transformer-aan-activation: swish
[2023-07-28 03:16:21] [config] transformer-aan-depth: 2
[2023-07-28 03:16:21] [config] transformer-aan-nogate: false
[2023-07-28 03:16:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 03:16:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 03:16:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 03:16:21] [config] transformer-depth-scaling: false
[2023-07-28 03:16:21] [config] transformer-dim-aan: 2048
[2023-07-28 03:16:21] [config] transformer-dim-ffn: 2048
[2023-07-28 03:16:21] [config] transformer-dropout: 0
[2023-07-28 03:16:21] [config] transformer-dropout-attention: 0
[2023-07-28 03:16:21] [config] transformer-dropout-ffn: 0
[2023-07-28 03:16:21] [config] transformer-ffn-activation: swish
[2023-07-28 03:16:21] [config] transformer-ffn-depth: 2
[2023-07-28 03:16:21] [config] transformer-guided-alignment-layer: last
[2023-07-28 03:16:21] [config] transformer-heads: 8
[2023-07-28 03:16:21] [config] transformer-no-projection: false
[2023-07-28 03:16:21] [config] transformer-pool: false
[2023-07-28 03:16:21] [config] transformer-postprocess: dan
[2023-07-28 03:16:21] [config] transformer-postprocess-emb: d
[2023-07-28 03:16:21] [config] transformer-postprocess-top: ""
[2023-07-28 03:16:21] [config] transformer-preprocess: ""
[2023-07-28 03:16:21] [config] transformer-tied-layers:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] transformer-train-position-embeddings: false
[2023-07-28 03:16:21] [config] tsv: false
[2023-07-28 03:16:21] [config] tsv-fields: 0
[2023-07-28 03:16:21] [config] type: s2s
[2023-07-28 03:16:21] [config] ulr: false
[2023-07-28 03:16:21] [config] ulr-dim-emb: 0
[2023-07-28 03:16:21] [config] ulr-dropout: 0
[2023-07-28 03:16:21] [config] ulr-keys-vectors: ""
[2023-07-28 03:16:21] [config] ulr-query-vectors: ""
[2023-07-28 03:16:21] [config] ulr-softmax-temperature: 1
[2023-07-28 03:16:21] [config] ulr-trainable-transformation: false
[2023-07-28 03:16:21] [config] unlikelihood-loss: false
[2023-07-28 03:16:21] [config] valid-freq: 50000000
[2023-07-28 03:16:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 03:16:21] [config] valid-max-length: 1000
[2023-07-28 03:16:21] [config] valid-metrics:
[2023-07-28 03:16:21] [config]   - translation
[2023-07-28 03:16:21] [config] valid-mini-batch: 32
[2023-07-28 03:16:21] [config] valid-reset-stalled: false
[2023-07-28 03:16:21] [config] valid-script-args:
[2023-07-28 03:16:21] [config]   []
[2023-07-28 03:16:21] [config] valid-script-path: ""
[2023-07-28 03:16:21] [config] valid-sets:
[2023-07-28 03:16:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 03:16:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 03:16:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 03:16:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:16:21] [config] vocabs:
[2023-07-28 03:16:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:16:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:16:21] [config] word-penalty: 0
[2023-07-28 03:16:21] [config] word-scores: false
[2023-07-28 03:16:21] [config] workspace: 5500
[2023-07-28 03:16:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:16:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:16:21] [training] Using single-device training
[2023-07-28 03:16:21] Synced seed 1234
[2023-07-28 03:16:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:16:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 03:16:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:16:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 03:16:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 03:16:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:16:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 03:16:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:16:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:16:22] [comm] Using global sharding
[2023-07-28 03:16:22] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:16:22] [training] Using 1 GPUs
[2023-07-28 03:16:22] [logits] Applying loss function for 1 factor(s)
[2023-07-28 03:16:22] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:16:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 03:16:22] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:20:53] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 03:20:53] [valid] No post-processing script given for validating translator
[2023-07-28 03:20:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:20:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:20:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:20:54] [comm] Using global sharding
[2023-07-28 03:20:54] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:20:54] [training] Using 1 GPUs
[2023-07-28 03:20:54] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:20:55] Allocating memory for general optimizer shards
[2023-07-28 03:20:55] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:20:55] Loading Adam parameters
[2023-07-28 03:20:55] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:20:55] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:20:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 03:20:55] [data] Restoring the corpus state to epoch 111, batch 2998
[2023-07-28 03:20:55] [data] Shuffling data
[2023-07-28 03:20:55] [data] Done reading 20,192 sentences
[2023-07-28 03:20:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:20:55] Training started
[2023-07-28 03:20:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 03:20:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:20:57] Parameter type float16, optimization type float32, casting types true
[2023-07-28 03:21:00] Ep. 111 : Up. 3000 : Sen. 1,623 : Cost 4.37604332 * 20,861,500 @ 14,721 after 62,408,321 : Time 6.05s : 3450662.36 words/s : gNorm 0.9961
[2023-07-28 03:22:09] Seen 20,192 samples
[2023-07-28 03:22:09] Starting data epoch 112 in logical epoch 112
[2023-07-28 03:22:09] [data] Shuffling data
[2023-07-28 03:22:09] [data] Done reading 20,192 sentences
[2023-07-28 03:22:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:23:25] Seen 20,192 samples
[2023-07-28 03:23:25] Starting data epoch 113 in logical epoch 113
[2023-07-28 03:23:25] [data] Shuffling data
[2023-07-28 03:23:25] [data] Done reading 20,192 sentences
[2023-07-28 03:23:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:24:40] Seen 20,192 samples
[2023-07-28 03:24:40] Starting data epoch 114 in logical epoch 114
[2023-07-28 03:24:40] [data] Shuffling data
[2023-07-28 03:24:40] [data] Done reading 20,192 sentences
[2023-07-28 03:24:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:25:57] Seen 20,192 samples
[2023-07-28 03:25:57] Starting data epoch 115 in logical epoch 115
[2023-07-28 03:25:57] [data] Shuffling data
[2023-07-28 03:25:57] [data] Done reading 20,192 sentences
[2023-07-28 03:25:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:27:14] Seen 20,192 samples
[2023-07-28 03:27:14] Starting data epoch 116 in logical epoch 116
[2023-07-28 03:27:14] [data] Shuffling data
[2023-07-28 03:27:14] [data] Done reading 20,192 sentences
[2023-07-28 03:27:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:28:29] Seen 20,192 samples
[2023-07-28 03:28:29] Starting data epoch 117 in logical epoch 117
[2023-07-28 03:28:29] [data] Shuffling data
[2023-07-28 03:28:29] [data] Done reading 20,192 sentences
[2023-07-28 03:28:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:29:45] Seen 20,192 samples
[2023-07-28 03:29:45] Starting data epoch 118 in logical epoch 118
[2023-07-28 03:29:45] [data] Shuffling data
[2023-07-28 03:29:45] [data] Done reading 20,192 sentences
[2023-07-28 03:29:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:31:01] Seen 20,192 samples
[2023-07-28 03:31:01] Starting data epoch 119 in logical epoch 119
[2023-07-28 03:31:01] [data] Shuffling data
[2023-07-28 03:31:01] [data] Done reading 20,192 sentences
[2023-07-28 03:31:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:32:18] Seen 20,192 samples
[2023-07-28 03:32:18] Starting data epoch 120 in logical epoch 120
[2023-07-28 03:32:18] [data] Shuffling data
[2023-07-28 03:32:18] [data] Done reading 20,192 sentences
[2023-07-28 03:32:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:33:36] Seen 20,192 samples
[2023-07-28 03:33:36] Starting data epoch 121 in logical epoch 121
[2023-07-28 03:33:36] Training finished
[2023-07-28 03:34:17] [valid] Ep. 121 : Up. 3270 : translation : 0 : new best
[2023-07-28 03:34:17] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:34:19] Saving Adam parameters
[2023-07-28 03:34:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 03:34:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:34:27] [marian] Running on node05.datos.cluster.uy as process 23520 with command line:
[2023-07-28 03:34:27] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 03:34:27] [config] after: 0e
[2023-07-28 03:34:27] [config] after-batches: 0
[2023-07-28 03:34:27] [config] after-epochs: 130
[2023-07-28 03:34:27] [config] all-caps-every: 0
[2023-07-28 03:34:27] [config] allow-unk: false
[2023-07-28 03:34:27] [config] authors: false
[2023-07-28 03:34:27] [config] beam-size: 12
[2023-07-28 03:34:27] [config] bert-class-symbol: "[CLS]"
[2023-07-28 03:34:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 03:34:27] [config] bert-masking-fraction: 0.15
[2023-07-28 03:34:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 03:34:27] [config] bert-train-type-embeddings: true
[2023-07-28 03:34:27] [config] bert-type-vocab-size: 2
[2023-07-28 03:34:27] [config] build-info: ""
[2023-07-28 03:34:27] [config] check-gradient-nan: false
[2023-07-28 03:34:27] [config] check-nan: false
[2023-07-28 03:34:27] [config] cite: false
[2023-07-28 03:34:27] [config] clip-norm: 1
[2023-07-28 03:34:27] [config] cost-scaling:
[2023-07-28 03:34:27] [config]   - 256.f
[2023-07-28 03:34:27] [config]   - 1000
[2023-07-28 03:34:27] [config]   - 2.f
[2023-07-28 03:34:27] [config]   - 256.f
[2023-07-28 03:34:27] [config] cost-type: ce-sum
[2023-07-28 03:34:27] [config] cpu-threads: 0
[2023-07-28 03:34:27] [config] data-threads: 8
[2023-07-28 03:34:27] [config] data-weighting: ""
[2023-07-28 03:34:27] [config] data-weighting-type: sentence
[2023-07-28 03:34:27] [config] dec-cell: gru
[2023-07-28 03:34:27] [config] dec-cell-base-depth: 2
[2023-07-28 03:34:27] [config] dec-cell-high-depth: 1
[2023-07-28 03:34:27] [config] dec-depth: 1
[2023-07-28 03:34:27] [config] devices:
[2023-07-28 03:34:27] [config]   - 0
[2023-07-28 03:34:27] [config] dim-emb: 512
[2023-07-28 03:34:27] [config] dim-rnn: 1024
[2023-07-28 03:34:27] [config] dim-vocabs:
[2023-07-28 03:34:27] [config]   - 16384
[2023-07-28 03:34:27] [config]   - 16384
[2023-07-28 03:34:27] [config] disp-first: 0
[2023-07-28 03:34:27] [config] disp-freq: 1000u
[2023-07-28 03:34:27] [config] disp-label-counts: true
[2023-07-28 03:34:27] [config] dropout-rnn: 0
[2023-07-28 03:34:27] [config] dropout-src: 0
[2023-07-28 03:34:27] [config] dropout-trg: 0
[2023-07-28 03:34:27] [config] dump-config: ""
[2023-07-28 03:34:27] [config] dynamic-gradient-scaling:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] early-stopping: 1000
[2023-07-28 03:34:27] [config] early-stopping-on: first
[2023-07-28 03:34:27] [config] embedding-fix-src: false
[2023-07-28 03:34:27] [config] embedding-fix-trg: false
[2023-07-28 03:34:27] [config] embedding-normalization: false
[2023-07-28 03:34:27] [config] embedding-vectors:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] enc-cell: gru
[2023-07-28 03:34:27] [config] enc-cell-depth: 1
[2023-07-28 03:34:27] [config] enc-depth: 1
[2023-07-28 03:34:27] [config] enc-type: bidirectional
[2023-07-28 03:34:27] [config] english-title-case-every: 0
[2023-07-28 03:34:27] [config] exponential-smoothing: 0
[2023-07-28 03:34:27] [config] factor-weight: 1
[2023-07-28 03:34:27] [config] factors-combine: sum
[2023-07-28 03:34:27] [config] factors-dim-emb: 0
[2023-07-28 03:34:27] [config] gradient-checkpointing: false
[2023-07-28 03:34:27] [config] gradient-norm-average-window: 100
[2023-07-28 03:34:27] [config] guided-alignment: none
[2023-07-28 03:34:27] [config] guided-alignment-cost: mse
[2023-07-28 03:34:27] [config] guided-alignment-weight: 0.1
[2023-07-28 03:34:27] [config] ignore-model-config: false
[2023-07-28 03:34:27] [config] input-types:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] interpolate-env-vars: false
[2023-07-28 03:34:27] [config] keep-best: false
[2023-07-28 03:34:27] [config] label-smoothing: 0
[2023-07-28 03:34:27] [config] layer-normalization: false
[2023-07-28 03:34:27] [config] learn-rate: 0.0001
[2023-07-28 03:34:27] [config] lemma-dependency: ""
[2023-07-28 03:34:27] [config] lemma-dim-emb: 0
[2023-07-28 03:34:27] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 03:34:27] [config] log-level: info
[2023-07-28 03:34:27] [config] log-time-zone: ""
[2023-07-28 03:34:27] [config] logical-epoch:
[2023-07-28 03:34:27] [config]   - 1e
[2023-07-28 03:34:27] [config]   - 0
[2023-07-28 03:34:27] [config] lr-decay: 0
[2023-07-28 03:34:27] [config] lr-decay-freq: 50000
[2023-07-28 03:34:27] [config] lr-decay-inv-sqrt:
[2023-07-28 03:34:27] [config]   - 0
[2023-07-28 03:34:27] [config] lr-decay-repeat-warmup: false
[2023-07-28 03:34:27] [config] lr-decay-reset-optimizer: false
[2023-07-28 03:34:27] [config] lr-decay-start:
[2023-07-28 03:34:27] [config]   - 10
[2023-07-28 03:34:27] [config]   - 1
[2023-07-28 03:34:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 03:34:27] [config] lr-report: false
[2023-07-28 03:34:27] [config] lr-warmup: 0
[2023-07-28 03:34:27] [config] lr-warmup-at-reload: false
[2023-07-28 03:34:27] [config] lr-warmup-cycle: false
[2023-07-28 03:34:27] [config] lr-warmup-start-rate: 0
[2023-07-28 03:34:27] [config] max-length: 50
[2023-07-28 03:34:27] [config] max-length-crop: true
[2023-07-28 03:34:27] [config] max-length-factor: 3
[2023-07-28 03:34:27] [config] maxi-batch: 100
[2023-07-28 03:34:27] [config] maxi-batch-sort: trg
[2023-07-28 03:34:27] [config] mini-batch: 64
[2023-07-28 03:34:27] [config] mini-batch-fit: true
[2023-07-28 03:34:27] [config] mini-batch-fit-step: 10
[2023-07-28 03:34:27] [config] mini-batch-round-up: true
[2023-07-28 03:34:27] [config] mini-batch-track-lr: false
[2023-07-28 03:34:27] [config] mini-batch-warmup: 0
[2023-07-28 03:34:27] [config] mini-batch-words: 0
[2023-07-28 03:34:27] [config] mini-batch-words-ref: 0
[2023-07-28 03:34:27] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:34:27] [config] multi-loss-type: sum
[2023-07-28 03:34:27] [config] n-best: false
[2023-07-28 03:34:27] [config] no-nccl: false
[2023-07-28 03:34:27] [config] no-reload: false
[2023-07-28 03:34:27] [config] no-restore-corpus: false
[2023-07-28 03:34:27] [config] normalize: 0
[2023-07-28 03:34:27] [config] normalize-gradient: false
[2023-07-28 03:34:27] [config] num-devices: 0
[2023-07-28 03:34:27] [config] optimizer: adam
[2023-07-28 03:34:27] [config] optimizer-delay: 1
[2023-07-28 03:34:27] [config] optimizer-params:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] output-omit-bias: false
[2023-07-28 03:34:27] [config] overwrite: true
[2023-07-28 03:34:27] [config] precision:
[2023-07-28 03:34:27] [config]   - float16
[2023-07-28 03:34:27] [config]   - float32
[2023-07-28 03:34:27] [config] pretrained-model: ""
[2023-07-28 03:34:27] [config] quantize-biases: false
[2023-07-28 03:34:27] [config] quantize-bits: 0
[2023-07-28 03:34:27] [config] quantize-log-based: false
[2023-07-28 03:34:27] [config] quantize-optimization-steps: 0
[2023-07-28 03:34:27] [config] quiet: false
[2023-07-28 03:34:27] [config] quiet-translation: true
[2023-07-28 03:34:27] [config] relative-paths: false
[2023-07-28 03:34:27] [config] right-left: false
[2023-07-28 03:34:27] [config] save-freq: 10000u
[2023-07-28 03:34:27] [config] seed: 1234
[2023-07-28 03:34:27] [config] sentencepiece-alphas:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] sentencepiece-max-lines: 2000000
[2023-07-28 03:34:27] [config] sentencepiece-options: ""
[2023-07-28 03:34:27] [config] sharding: global
[2023-07-28 03:34:27] [config] shuffle: data
[2023-07-28 03:34:27] [config] shuffle-in-ram: false
[2023-07-28 03:34:27] [config] sigterm: save-and-exit
[2023-07-28 03:34:27] [config] skip: false
[2023-07-28 03:34:27] [config] sqlite: ""
[2023-07-28 03:34:27] [config] sqlite-drop: false
[2023-07-28 03:34:27] [config] sync-freq: 200u
[2023-07-28 03:34:27] [config] sync-sgd: false
[2023-07-28 03:34:27] [config] tempdir: /tmp
[2023-07-28 03:34:27] [config] tied-embeddings: false
[2023-07-28 03:34:27] [config] tied-embeddings-all: true
[2023-07-28 03:34:27] [config] tied-embeddings-src: false
[2023-07-28 03:34:27] [config] train-embedder-rank:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] train-sets:
[2023-07-28 03:34:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 03:34:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 03:34:27] [config] transformer-aan-activation: swish
[2023-07-28 03:34:27] [config] transformer-aan-depth: 2
[2023-07-28 03:34:27] [config] transformer-aan-nogate: false
[2023-07-28 03:34:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 03:34:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 03:34:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 03:34:27] [config] transformer-depth-scaling: false
[2023-07-28 03:34:27] [config] transformer-dim-aan: 2048
[2023-07-28 03:34:27] [config] transformer-dim-ffn: 2048
[2023-07-28 03:34:27] [config] transformer-dropout: 0
[2023-07-28 03:34:27] [config] transformer-dropout-attention: 0
[2023-07-28 03:34:27] [config] transformer-dropout-ffn: 0
[2023-07-28 03:34:27] [config] transformer-ffn-activation: swish
[2023-07-28 03:34:27] [config] transformer-ffn-depth: 2
[2023-07-28 03:34:27] [config] transformer-guided-alignment-layer: last
[2023-07-28 03:34:27] [config] transformer-heads: 8
[2023-07-28 03:34:27] [config] transformer-no-projection: false
[2023-07-28 03:34:27] [config] transformer-pool: false
[2023-07-28 03:34:27] [config] transformer-postprocess: dan
[2023-07-28 03:34:27] [config] transformer-postprocess-emb: d
[2023-07-28 03:34:27] [config] transformer-postprocess-top: ""
[2023-07-28 03:34:27] [config] transformer-preprocess: ""
[2023-07-28 03:34:27] [config] transformer-tied-layers:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] transformer-train-position-embeddings: false
[2023-07-28 03:34:27] [config] tsv: false
[2023-07-28 03:34:27] [config] tsv-fields: 0
[2023-07-28 03:34:27] [config] type: s2s
[2023-07-28 03:34:27] [config] ulr: false
[2023-07-28 03:34:27] [config] ulr-dim-emb: 0
[2023-07-28 03:34:27] [config] ulr-dropout: 0
[2023-07-28 03:34:27] [config] ulr-keys-vectors: ""
[2023-07-28 03:34:27] [config] ulr-query-vectors: ""
[2023-07-28 03:34:27] [config] ulr-softmax-temperature: 1
[2023-07-28 03:34:27] [config] ulr-trainable-transformation: false
[2023-07-28 03:34:27] [config] unlikelihood-loss: false
[2023-07-28 03:34:27] [config] valid-freq: 50000000
[2023-07-28 03:34:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 03:34:27] [config] valid-max-length: 1000
[2023-07-28 03:34:27] [config] valid-metrics:
[2023-07-28 03:34:27] [config]   - translation
[2023-07-28 03:34:27] [config] valid-mini-batch: 32
[2023-07-28 03:34:27] [config] valid-reset-stalled: false
[2023-07-28 03:34:27] [config] valid-script-args:
[2023-07-28 03:34:27] [config]   []
[2023-07-28 03:34:27] [config] valid-script-path: ""
[2023-07-28 03:34:27] [config] valid-sets:
[2023-07-28 03:34:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 03:34:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 03:34:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 03:34:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:34:27] [config] vocabs:
[2023-07-28 03:34:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:34:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:34:27] [config] word-penalty: 0
[2023-07-28 03:34:27] [config] word-scores: false
[2023-07-28 03:34:27] [config] workspace: 5500
[2023-07-28 03:34:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:34:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:34:27] [training] Using single-device training
[2023-07-28 03:34:27] Synced seed 1234
[2023-07-28 03:34:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:34:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 03:34:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:34:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 03:34:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 03:34:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:34:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 03:34:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:34:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:34:28] [comm] Using global sharding
[2023-07-28 03:34:28] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:34:28] [training] Using 1 GPUs
[2023-07-28 03:34:28] [logits] Applying loss function for 1 factor(s)
[2023-07-28 03:34:28] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:34:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 03:34:29] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:38:57] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 03:38:57] [valid] No post-processing script given for validating translator
[2023-07-28 03:38:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:38:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:38:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:38:57] [comm] Using global sharding
[2023-07-28 03:38:57] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:38:57] [training] Using 1 GPUs
[2023-07-28 03:38:57] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:38:58] Allocating memory for general optimizer shards
[2023-07-28 03:38:58] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:38:58] Loading Adam parameters
[2023-07-28 03:38:58] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:38:58] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:38:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 03:38:59] [data] Restoring the corpus state to epoch 121, batch 3270
[2023-07-28 03:38:59] [data] Shuffling data
[2023-07-28 03:38:59] [data] Done reading 20,192 sentences
[2023-07-28 03:38:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:38:59] Training started
[2023-07-28 03:38:59] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 03:38:59] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:38:59] Parameter type float16, optimization type float32, casting types true
[2023-07-28 03:40:11] Seen 20,192 samples
[2023-07-28 03:40:11] Starting data epoch 122 in logical epoch 122
[2023-07-28 03:40:11] [data] Shuffling data
[2023-07-28 03:40:11] [data] Done reading 20,192 sentences
[2023-07-28 03:40:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:41:26] Seen 20,192 samples
[2023-07-28 03:41:26] Starting data epoch 123 in logical epoch 123
[2023-07-28 03:41:26] [data] Shuffling data
[2023-07-28 03:41:26] [data] Done reading 20,192 sentences
[2023-07-28 03:41:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:42:39] Seen 20,192 samples
[2023-07-28 03:42:39] Starting data epoch 124 in logical epoch 124
[2023-07-28 03:42:39] [data] Shuffling data
[2023-07-28 03:42:39] [data] Done reading 20,192 sentences
[2023-07-28 03:42:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:43:56] Seen 20,192 samples
[2023-07-28 03:43:56] Starting data epoch 125 in logical epoch 125
[2023-07-28 03:43:56] [data] Shuffling data
[2023-07-28 03:43:56] [data] Done reading 20,192 sentences
[2023-07-28 03:43:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:45:13] Seen 20,192 samples
[2023-07-28 03:45:13] Starting data epoch 126 in logical epoch 126
[2023-07-28 03:45:13] [data] Shuffling data
[2023-07-28 03:45:13] [data] Done reading 20,192 sentences
[2023-07-28 03:45:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:46:30] Seen 20,192 samples
[2023-07-28 03:46:30] Starting data epoch 127 in logical epoch 127
[2023-07-28 03:46:30] [data] Shuffling data
[2023-07-28 03:46:30] [data] Done reading 20,192 sentences
[2023-07-28 03:46:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:47:48] Seen 20,192 samples
[2023-07-28 03:47:48] Starting data epoch 128 in logical epoch 128
[2023-07-28 03:47:48] [data] Shuffling data
[2023-07-28 03:47:48] [data] Done reading 20,192 sentences
[2023-07-28 03:47:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:49:04] Seen 20,192 samples
[2023-07-28 03:49:04] Starting data epoch 129 in logical epoch 129
[2023-07-28 03:49:04] [data] Shuffling data
[2023-07-28 03:49:04] [data] Done reading 20,192 sentences
[2023-07-28 03:49:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:50:22] Seen 20,192 samples
[2023-07-28 03:50:22] Starting data epoch 130 in logical epoch 130
[2023-07-28 03:50:22] [data] Shuffling data
[2023-07-28 03:50:22] [data] Done reading 20,192 sentences
[2023-07-28 03:50:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:51:41] Seen 20,192 samples
[2023-07-28 03:51:41] Starting data epoch 131 in logical epoch 131
[2023-07-28 03:51:41] Training finished
[2023-07-28 03:52:20] [valid] Ep. 131 : Up. 3546 : translation : 0 : new best
[2023-07-28 03:52:20] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:52:22] Saving Adam parameters
[2023-07-28 03:52:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 03:52:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:52:29] [marian] Running on node05.datos.cluster.uy as process 24713 with command line:
[2023-07-28 03:52:29] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 03:52:29] [config] after: 0e
[2023-07-28 03:52:29] [config] after-batches: 0
[2023-07-28 03:52:29] [config] after-epochs: 140
[2023-07-28 03:52:29] [config] all-caps-every: 0
[2023-07-28 03:52:29] [config] allow-unk: false
[2023-07-28 03:52:29] [config] authors: false
[2023-07-28 03:52:29] [config] beam-size: 12
[2023-07-28 03:52:29] [config] bert-class-symbol: "[CLS]"
[2023-07-28 03:52:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 03:52:29] [config] bert-masking-fraction: 0.15
[2023-07-28 03:52:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 03:52:29] [config] bert-train-type-embeddings: true
[2023-07-28 03:52:29] [config] bert-type-vocab-size: 2
[2023-07-28 03:52:29] [config] build-info: ""
[2023-07-28 03:52:29] [config] check-gradient-nan: false
[2023-07-28 03:52:29] [config] check-nan: false
[2023-07-28 03:52:29] [config] cite: false
[2023-07-28 03:52:29] [config] clip-norm: 1
[2023-07-28 03:52:29] [config] cost-scaling:
[2023-07-28 03:52:29] [config]   - 256.f
[2023-07-28 03:52:29] [config]   - 1000
[2023-07-28 03:52:29] [config]   - 2.f
[2023-07-28 03:52:29] [config]   - 256.f
[2023-07-28 03:52:29] [config] cost-type: ce-sum
[2023-07-28 03:52:29] [config] cpu-threads: 0
[2023-07-28 03:52:29] [config] data-threads: 8
[2023-07-28 03:52:29] [config] data-weighting: ""
[2023-07-28 03:52:29] [config] data-weighting-type: sentence
[2023-07-28 03:52:29] [config] dec-cell: gru
[2023-07-28 03:52:29] [config] dec-cell-base-depth: 2
[2023-07-28 03:52:29] [config] dec-cell-high-depth: 1
[2023-07-28 03:52:29] [config] dec-depth: 1
[2023-07-28 03:52:29] [config] devices:
[2023-07-28 03:52:29] [config]   - 0
[2023-07-28 03:52:29] [config] dim-emb: 512
[2023-07-28 03:52:29] [config] dim-rnn: 1024
[2023-07-28 03:52:29] [config] dim-vocabs:
[2023-07-28 03:52:29] [config]   - 16384
[2023-07-28 03:52:29] [config]   - 16384
[2023-07-28 03:52:29] [config] disp-first: 0
[2023-07-28 03:52:29] [config] disp-freq: 1000u
[2023-07-28 03:52:29] [config] disp-label-counts: true
[2023-07-28 03:52:29] [config] dropout-rnn: 0
[2023-07-28 03:52:29] [config] dropout-src: 0
[2023-07-28 03:52:29] [config] dropout-trg: 0
[2023-07-28 03:52:29] [config] dump-config: ""
[2023-07-28 03:52:29] [config] dynamic-gradient-scaling:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] early-stopping: 1000
[2023-07-28 03:52:29] [config] early-stopping-on: first
[2023-07-28 03:52:29] [config] embedding-fix-src: false
[2023-07-28 03:52:29] [config] embedding-fix-trg: false
[2023-07-28 03:52:29] [config] embedding-normalization: false
[2023-07-28 03:52:29] [config] embedding-vectors:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] enc-cell: gru
[2023-07-28 03:52:29] [config] enc-cell-depth: 1
[2023-07-28 03:52:29] [config] enc-depth: 1
[2023-07-28 03:52:29] [config] enc-type: bidirectional
[2023-07-28 03:52:29] [config] english-title-case-every: 0
[2023-07-28 03:52:29] [config] exponential-smoothing: 0
[2023-07-28 03:52:29] [config] factor-weight: 1
[2023-07-28 03:52:29] [config] factors-combine: sum
[2023-07-28 03:52:29] [config] factors-dim-emb: 0
[2023-07-28 03:52:29] [config] gradient-checkpointing: false
[2023-07-28 03:52:29] [config] gradient-norm-average-window: 100
[2023-07-28 03:52:29] [config] guided-alignment: none
[2023-07-28 03:52:29] [config] guided-alignment-cost: mse
[2023-07-28 03:52:29] [config] guided-alignment-weight: 0.1
[2023-07-28 03:52:29] [config] ignore-model-config: false
[2023-07-28 03:52:29] [config] input-types:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] interpolate-env-vars: false
[2023-07-28 03:52:29] [config] keep-best: false
[2023-07-28 03:52:29] [config] label-smoothing: 0
[2023-07-28 03:52:29] [config] layer-normalization: false
[2023-07-28 03:52:29] [config] learn-rate: 0.0001
[2023-07-28 03:52:29] [config] lemma-dependency: ""
[2023-07-28 03:52:29] [config] lemma-dim-emb: 0
[2023-07-28 03:52:29] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 03:52:29] [config] log-level: info
[2023-07-28 03:52:29] [config] log-time-zone: ""
[2023-07-28 03:52:29] [config] logical-epoch:
[2023-07-28 03:52:29] [config]   - 1e
[2023-07-28 03:52:29] [config]   - 0
[2023-07-28 03:52:29] [config] lr-decay: 0
[2023-07-28 03:52:29] [config] lr-decay-freq: 50000
[2023-07-28 03:52:29] [config] lr-decay-inv-sqrt:
[2023-07-28 03:52:29] [config]   - 0
[2023-07-28 03:52:29] [config] lr-decay-repeat-warmup: false
[2023-07-28 03:52:29] [config] lr-decay-reset-optimizer: false
[2023-07-28 03:52:29] [config] lr-decay-start:
[2023-07-28 03:52:29] [config]   - 10
[2023-07-28 03:52:29] [config]   - 1
[2023-07-28 03:52:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 03:52:29] [config] lr-report: false
[2023-07-28 03:52:29] [config] lr-warmup: 0
[2023-07-28 03:52:29] [config] lr-warmup-at-reload: false
[2023-07-28 03:52:29] [config] lr-warmup-cycle: false
[2023-07-28 03:52:29] [config] lr-warmup-start-rate: 0
[2023-07-28 03:52:29] [config] max-length: 50
[2023-07-28 03:52:29] [config] max-length-crop: true
[2023-07-28 03:52:29] [config] max-length-factor: 3
[2023-07-28 03:52:29] [config] maxi-batch: 100
[2023-07-28 03:52:29] [config] maxi-batch-sort: trg
[2023-07-28 03:52:29] [config] mini-batch: 64
[2023-07-28 03:52:29] [config] mini-batch-fit: true
[2023-07-28 03:52:29] [config] mini-batch-fit-step: 10
[2023-07-28 03:52:29] [config] mini-batch-round-up: true
[2023-07-28 03:52:29] [config] mini-batch-track-lr: false
[2023-07-28 03:52:29] [config] mini-batch-warmup: 0
[2023-07-28 03:52:29] [config] mini-batch-words: 0
[2023-07-28 03:52:29] [config] mini-batch-words-ref: 0
[2023-07-28 03:52:29] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:52:29] [config] multi-loss-type: sum
[2023-07-28 03:52:29] [config] n-best: false
[2023-07-28 03:52:29] [config] no-nccl: false
[2023-07-28 03:52:29] [config] no-reload: false
[2023-07-28 03:52:29] [config] no-restore-corpus: false
[2023-07-28 03:52:29] [config] normalize: 0
[2023-07-28 03:52:29] [config] normalize-gradient: false
[2023-07-28 03:52:29] [config] num-devices: 0
[2023-07-28 03:52:29] [config] optimizer: adam
[2023-07-28 03:52:29] [config] optimizer-delay: 1
[2023-07-28 03:52:29] [config] optimizer-params:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] output-omit-bias: false
[2023-07-28 03:52:29] [config] overwrite: true
[2023-07-28 03:52:29] [config] precision:
[2023-07-28 03:52:29] [config]   - float16
[2023-07-28 03:52:29] [config]   - float32
[2023-07-28 03:52:29] [config] pretrained-model: ""
[2023-07-28 03:52:29] [config] quantize-biases: false
[2023-07-28 03:52:29] [config] quantize-bits: 0
[2023-07-28 03:52:29] [config] quantize-log-based: false
[2023-07-28 03:52:29] [config] quantize-optimization-steps: 0
[2023-07-28 03:52:29] [config] quiet: false
[2023-07-28 03:52:29] [config] quiet-translation: true
[2023-07-28 03:52:29] [config] relative-paths: false
[2023-07-28 03:52:29] [config] right-left: false
[2023-07-28 03:52:29] [config] save-freq: 10000u
[2023-07-28 03:52:29] [config] seed: 1234
[2023-07-28 03:52:29] [config] sentencepiece-alphas:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] sentencepiece-max-lines: 2000000
[2023-07-28 03:52:29] [config] sentencepiece-options: ""
[2023-07-28 03:52:29] [config] sharding: global
[2023-07-28 03:52:29] [config] shuffle: data
[2023-07-28 03:52:29] [config] shuffle-in-ram: false
[2023-07-28 03:52:29] [config] sigterm: save-and-exit
[2023-07-28 03:52:29] [config] skip: false
[2023-07-28 03:52:29] [config] sqlite: ""
[2023-07-28 03:52:29] [config] sqlite-drop: false
[2023-07-28 03:52:29] [config] sync-freq: 200u
[2023-07-28 03:52:29] [config] sync-sgd: false
[2023-07-28 03:52:29] [config] tempdir: /tmp
[2023-07-28 03:52:29] [config] tied-embeddings: false
[2023-07-28 03:52:29] [config] tied-embeddings-all: true
[2023-07-28 03:52:29] [config] tied-embeddings-src: false
[2023-07-28 03:52:29] [config] train-embedder-rank:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] train-sets:
[2023-07-28 03:52:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 03:52:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 03:52:29] [config] transformer-aan-activation: swish
[2023-07-28 03:52:29] [config] transformer-aan-depth: 2
[2023-07-28 03:52:29] [config] transformer-aan-nogate: false
[2023-07-28 03:52:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 03:52:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 03:52:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 03:52:29] [config] transformer-depth-scaling: false
[2023-07-28 03:52:29] [config] transformer-dim-aan: 2048
[2023-07-28 03:52:29] [config] transformer-dim-ffn: 2048
[2023-07-28 03:52:29] [config] transformer-dropout: 0
[2023-07-28 03:52:29] [config] transformer-dropout-attention: 0
[2023-07-28 03:52:29] [config] transformer-dropout-ffn: 0
[2023-07-28 03:52:29] [config] transformer-ffn-activation: swish
[2023-07-28 03:52:29] [config] transformer-ffn-depth: 2
[2023-07-28 03:52:29] [config] transformer-guided-alignment-layer: last
[2023-07-28 03:52:29] [config] transformer-heads: 8
[2023-07-28 03:52:29] [config] transformer-no-projection: false
[2023-07-28 03:52:29] [config] transformer-pool: false
[2023-07-28 03:52:29] [config] transformer-postprocess: dan
[2023-07-28 03:52:29] [config] transformer-postprocess-emb: d
[2023-07-28 03:52:29] [config] transformer-postprocess-top: ""
[2023-07-28 03:52:29] [config] transformer-preprocess: ""
[2023-07-28 03:52:29] [config] transformer-tied-layers:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] transformer-train-position-embeddings: false
[2023-07-28 03:52:29] [config] tsv: false
[2023-07-28 03:52:29] [config] tsv-fields: 0
[2023-07-28 03:52:29] [config] type: s2s
[2023-07-28 03:52:29] [config] ulr: false
[2023-07-28 03:52:29] [config] ulr-dim-emb: 0
[2023-07-28 03:52:29] [config] ulr-dropout: 0
[2023-07-28 03:52:29] [config] ulr-keys-vectors: ""
[2023-07-28 03:52:29] [config] ulr-query-vectors: ""
[2023-07-28 03:52:29] [config] ulr-softmax-temperature: 1
[2023-07-28 03:52:29] [config] ulr-trainable-transformation: false
[2023-07-28 03:52:29] [config] unlikelihood-loss: false
[2023-07-28 03:52:29] [config] valid-freq: 50000000
[2023-07-28 03:52:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 03:52:29] [config] valid-max-length: 1000
[2023-07-28 03:52:29] [config] valid-metrics:
[2023-07-28 03:52:29] [config]   - translation
[2023-07-28 03:52:29] [config] valid-mini-batch: 32
[2023-07-28 03:52:29] [config] valid-reset-stalled: false
[2023-07-28 03:52:29] [config] valid-script-args:
[2023-07-28 03:52:29] [config]   []
[2023-07-28 03:52:29] [config] valid-script-path: ""
[2023-07-28 03:52:29] [config] valid-sets:
[2023-07-28 03:52:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 03:52:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 03:52:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 03:52:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:52:29] [config] vocabs:
[2023-07-28 03:52:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:52:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:52:29] [config] word-penalty: 0
[2023-07-28 03:52:29] [config] word-scores: false
[2023-07-28 03:52:29] [config] workspace: 5500
[2023-07-28 03:52:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:52:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:52:29] [training] Using single-device training
[2023-07-28 03:52:29] Synced seed 1234
[2023-07-28 03:52:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:52:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 03:52:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:52:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 03:52:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 03:52:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:52:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 03:52:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:52:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:52:30] [comm] Using global sharding
[2023-07-28 03:52:30] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:52:30] [training] Using 1 GPUs
[2023-07-28 03:52:30] [logits] Applying loss function for 1 factor(s)
[2023-07-28 03:52:30] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:52:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 03:52:31] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:56:59] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 03:56:59] [valid] No post-processing script given for validating translator
[2023-07-28 03:56:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:56:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:56:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:56:59] [comm] Using global sharding
[2023-07-28 03:56:59] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:56:59] [training] Using 1 GPUs
[2023-07-28 03:56:59] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 03:57:00] Allocating memory for general optimizer shards
[2023-07-28 03:57:00] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:57:00] Loading Adam parameters
[2023-07-28 03:57:00] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:57:00] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:57:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 03:57:01] [data] Restoring the corpus state to epoch 131, batch 3546
[2023-07-28 03:57:01] [data] Shuffling data
[2023-07-28 03:57:01] [data] Done reading 20,192 sentences
[2023-07-28 03:57:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:57:01] Training started
[2023-07-28 03:57:01] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 03:57:01] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:57:03] Parameter type float16, optimization type float32, casting types true
[2023-07-28 03:58:13] Seen 20,192 samples
[2023-07-28 03:58:13] Starting data epoch 132 in logical epoch 132
[2023-07-28 03:58:13] [data] Shuffling data
[2023-07-28 03:58:13] [data] Done reading 20,192 sentences
[2023-07-28 03:58:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:59:25] Seen 20,192 samples
[2023-07-28 03:59:25] Starting data epoch 133 in logical epoch 133
[2023-07-28 03:59:25] [data] Shuffling data
[2023-07-28 03:59:25] [data] Done reading 20,192 sentences
[2023-07-28 03:59:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:00:40] Seen 20,192 samples
[2023-07-28 04:00:40] Starting data epoch 134 in logical epoch 134
[2023-07-28 04:00:40] [data] Shuffling data
[2023-07-28 04:00:40] [data] Done reading 20,192 sentences
[2023-07-28 04:00:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:01:55] Seen 20,192 samples
[2023-07-28 04:01:55] Starting data epoch 135 in logical epoch 135
[2023-07-28 04:01:55] [data] Shuffling data
[2023-07-28 04:01:55] [data] Done reading 20,192 sentences
[2023-07-28 04:01:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:03:11] Seen 20,192 samples
[2023-07-28 04:03:11] Starting data epoch 136 in logical epoch 136
[2023-07-28 04:03:11] [data] Shuffling data
[2023-07-28 04:03:11] [data] Done reading 20,192 sentences
[2023-07-28 04:03:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:04:27] Seen 20,192 samples
[2023-07-28 04:04:27] Starting data epoch 137 in logical epoch 137
[2023-07-28 04:04:27] [data] Shuffling data
[2023-07-28 04:04:27] [data] Done reading 20,192 sentences
[2023-07-28 04:04:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:05:44] Seen 20,192 samples
[2023-07-28 04:05:44] Starting data epoch 138 in logical epoch 138
[2023-07-28 04:05:44] [data] Shuffling data
[2023-07-28 04:05:44] [data] Done reading 20,192 sentences
[2023-07-28 04:05:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:07:00] Seen 20,192 samples
[2023-07-28 04:07:00] Starting data epoch 139 in logical epoch 139
[2023-07-28 04:07:00] [data] Shuffling data
[2023-07-28 04:07:00] [data] Done reading 20,192 sentences
[2023-07-28 04:07:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:08:19] Seen 20,192 samples
[2023-07-28 04:08:19] Starting data epoch 140 in logical epoch 140
[2023-07-28 04:08:19] [data] Shuffling data
[2023-07-28 04:08:19] [data] Done reading 20,192 sentences
[2023-07-28 04:08:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:09:34] Seen 20,192 samples
[2023-07-28 04:09:34] Starting data epoch 141 in logical epoch 141
[2023-07-28 04:09:34] Training finished
[2023-07-28 04:10:14] [valid] Ep. 141 : Up. 3819 : translation : 0 : new best
[2023-07-28 04:10:14] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:10:16] Saving Adam parameters
[2023-07-28 04:10:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 04:10:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:10:23] [marian] Running on node05.datos.cluster.uy as process 13500 with command line:
[2023-07-28 04:10:23] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 04:10:23] [config] after: 0e
[2023-07-28 04:10:23] [config] after-batches: 0
[2023-07-28 04:10:23] [config] after-epochs: 150
[2023-07-28 04:10:23] [config] all-caps-every: 0
[2023-07-28 04:10:23] [config] allow-unk: false
[2023-07-28 04:10:23] [config] authors: false
[2023-07-28 04:10:23] [config] beam-size: 12
[2023-07-28 04:10:23] [config] bert-class-symbol: "[CLS]"
[2023-07-28 04:10:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 04:10:23] [config] bert-masking-fraction: 0.15
[2023-07-28 04:10:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 04:10:23] [config] bert-train-type-embeddings: true
[2023-07-28 04:10:23] [config] bert-type-vocab-size: 2
[2023-07-28 04:10:23] [config] build-info: ""
[2023-07-28 04:10:23] [config] check-gradient-nan: false
[2023-07-28 04:10:23] [config] check-nan: false
[2023-07-28 04:10:23] [config] cite: false
[2023-07-28 04:10:23] [config] clip-norm: 1
[2023-07-28 04:10:23] [config] cost-scaling:
[2023-07-28 04:10:23] [config]   - 256.f
[2023-07-28 04:10:23] [config]   - 1000
[2023-07-28 04:10:23] [config]   - 2.f
[2023-07-28 04:10:23] [config]   - 256.f
[2023-07-28 04:10:23] [config] cost-type: ce-sum
[2023-07-28 04:10:23] [config] cpu-threads: 0
[2023-07-28 04:10:23] [config] data-threads: 8
[2023-07-28 04:10:23] [config] data-weighting: ""
[2023-07-28 04:10:23] [config] data-weighting-type: sentence
[2023-07-28 04:10:23] [config] dec-cell: gru
[2023-07-28 04:10:23] [config] dec-cell-base-depth: 2
[2023-07-28 04:10:23] [config] dec-cell-high-depth: 1
[2023-07-28 04:10:23] [config] dec-depth: 1
[2023-07-28 04:10:23] [config] devices:
[2023-07-28 04:10:23] [config]   - 0
[2023-07-28 04:10:23] [config] dim-emb: 512
[2023-07-28 04:10:23] [config] dim-rnn: 1024
[2023-07-28 04:10:23] [config] dim-vocabs:
[2023-07-28 04:10:23] [config]   - 16384
[2023-07-28 04:10:23] [config]   - 16384
[2023-07-28 04:10:23] [config] disp-first: 0
[2023-07-28 04:10:23] [config] disp-freq: 1000u
[2023-07-28 04:10:23] [config] disp-label-counts: true
[2023-07-28 04:10:23] [config] dropout-rnn: 0
[2023-07-28 04:10:23] [config] dropout-src: 0
[2023-07-28 04:10:23] [config] dropout-trg: 0
[2023-07-28 04:10:23] [config] dump-config: ""
[2023-07-28 04:10:23] [config] dynamic-gradient-scaling:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] early-stopping: 1000
[2023-07-28 04:10:23] [config] early-stopping-on: first
[2023-07-28 04:10:23] [config] embedding-fix-src: false
[2023-07-28 04:10:23] [config] embedding-fix-trg: false
[2023-07-28 04:10:23] [config] embedding-normalization: false
[2023-07-28 04:10:23] [config] embedding-vectors:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] enc-cell: gru
[2023-07-28 04:10:23] [config] enc-cell-depth: 1
[2023-07-28 04:10:23] [config] enc-depth: 1
[2023-07-28 04:10:23] [config] enc-type: bidirectional
[2023-07-28 04:10:23] [config] english-title-case-every: 0
[2023-07-28 04:10:23] [config] exponential-smoothing: 0
[2023-07-28 04:10:23] [config] factor-weight: 1
[2023-07-28 04:10:23] [config] factors-combine: sum
[2023-07-28 04:10:23] [config] factors-dim-emb: 0
[2023-07-28 04:10:23] [config] gradient-checkpointing: false
[2023-07-28 04:10:23] [config] gradient-norm-average-window: 100
[2023-07-28 04:10:23] [config] guided-alignment: none
[2023-07-28 04:10:23] [config] guided-alignment-cost: mse
[2023-07-28 04:10:23] [config] guided-alignment-weight: 0.1
[2023-07-28 04:10:23] [config] ignore-model-config: false
[2023-07-28 04:10:23] [config] input-types:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] interpolate-env-vars: false
[2023-07-28 04:10:23] [config] keep-best: false
[2023-07-28 04:10:23] [config] label-smoothing: 0
[2023-07-28 04:10:23] [config] layer-normalization: false
[2023-07-28 04:10:23] [config] learn-rate: 0.0001
[2023-07-28 04:10:23] [config] lemma-dependency: ""
[2023-07-28 04:10:23] [config] lemma-dim-emb: 0
[2023-07-28 04:10:23] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 04:10:23] [config] log-level: info
[2023-07-28 04:10:23] [config] log-time-zone: ""
[2023-07-28 04:10:23] [config] logical-epoch:
[2023-07-28 04:10:23] [config]   - 1e
[2023-07-28 04:10:23] [config]   - 0
[2023-07-28 04:10:23] [config] lr-decay: 0
[2023-07-28 04:10:23] [config] lr-decay-freq: 50000
[2023-07-28 04:10:23] [config] lr-decay-inv-sqrt:
[2023-07-28 04:10:23] [config]   - 0
[2023-07-28 04:10:23] [config] lr-decay-repeat-warmup: false
[2023-07-28 04:10:23] [config] lr-decay-reset-optimizer: false
[2023-07-28 04:10:23] [config] lr-decay-start:
[2023-07-28 04:10:23] [config]   - 10
[2023-07-28 04:10:23] [config]   - 1
[2023-07-28 04:10:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 04:10:23] [config] lr-report: false
[2023-07-28 04:10:23] [config] lr-warmup: 0
[2023-07-28 04:10:23] [config] lr-warmup-at-reload: false
[2023-07-28 04:10:23] [config] lr-warmup-cycle: false
[2023-07-28 04:10:23] [config] lr-warmup-start-rate: 0
[2023-07-28 04:10:23] [config] max-length: 50
[2023-07-28 04:10:23] [config] max-length-crop: true
[2023-07-28 04:10:23] [config] max-length-factor: 3
[2023-07-28 04:10:23] [config] maxi-batch: 100
[2023-07-28 04:10:23] [config] maxi-batch-sort: trg
[2023-07-28 04:10:23] [config] mini-batch: 64
[2023-07-28 04:10:23] [config] mini-batch-fit: true
[2023-07-28 04:10:23] [config] mini-batch-fit-step: 10
[2023-07-28 04:10:23] [config] mini-batch-round-up: true
[2023-07-28 04:10:23] [config] mini-batch-track-lr: false
[2023-07-28 04:10:23] [config] mini-batch-warmup: 0
[2023-07-28 04:10:23] [config] mini-batch-words: 0
[2023-07-28 04:10:23] [config] mini-batch-words-ref: 0
[2023-07-28 04:10:23] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:10:23] [config] multi-loss-type: sum
[2023-07-28 04:10:23] [config] n-best: false
[2023-07-28 04:10:23] [config] no-nccl: false
[2023-07-28 04:10:23] [config] no-reload: false
[2023-07-28 04:10:23] [config] no-restore-corpus: false
[2023-07-28 04:10:23] [config] normalize: 0
[2023-07-28 04:10:23] [config] normalize-gradient: false
[2023-07-28 04:10:23] [config] num-devices: 0
[2023-07-28 04:10:23] [config] optimizer: adam
[2023-07-28 04:10:23] [config] optimizer-delay: 1
[2023-07-28 04:10:23] [config] optimizer-params:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] output-omit-bias: false
[2023-07-28 04:10:23] [config] overwrite: true
[2023-07-28 04:10:23] [config] precision:
[2023-07-28 04:10:23] [config]   - float16
[2023-07-28 04:10:23] [config]   - float32
[2023-07-28 04:10:23] [config] pretrained-model: ""
[2023-07-28 04:10:23] [config] quantize-biases: false
[2023-07-28 04:10:23] [config] quantize-bits: 0
[2023-07-28 04:10:23] [config] quantize-log-based: false
[2023-07-28 04:10:23] [config] quantize-optimization-steps: 0
[2023-07-28 04:10:23] [config] quiet: false
[2023-07-28 04:10:23] [config] quiet-translation: true
[2023-07-28 04:10:23] [config] relative-paths: false
[2023-07-28 04:10:23] [config] right-left: false
[2023-07-28 04:10:23] [config] save-freq: 10000u
[2023-07-28 04:10:23] [config] seed: 1234
[2023-07-28 04:10:23] [config] sentencepiece-alphas:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] sentencepiece-max-lines: 2000000
[2023-07-28 04:10:23] [config] sentencepiece-options: ""
[2023-07-28 04:10:23] [config] sharding: global
[2023-07-28 04:10:23] [config] shuffle: data
[2023-07-28 04:10:23] [config] shuffle-in-ram: false
[2023-07-28 04:10:23] [config] sigterm: save-and-exit
[2023-07-28 04:10:23] [config] skip: false
[2023-07-28 04:10:23] [config] sqlite: ""
[2023-07-28 04:10:23] [config] sqlite-drop: false
[2023-07-28 04:10:23] [config] sync-freq: 200u
[2023-07-28 04:10:23] [config] sync-sgd: false
[2023-07-28 04:10:23] [config] tempdir: /tmp
[2023-07-28 04:10:23] [config] tied-embeddings: false
[2023-07-28 04:10:23] [config] tied-embeddings-all: true
[2023-07-28 04:10:23] [config] tied-embeddings-src: false
[2023-07-28 04:10:23] [config] train-embedder-rank:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] train-sets:
[2023-07-28 04:10:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 04:10:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 04:10:23] [config] transformer-aan-activation: swish
[2023-07-28 04:10:23] [config] transformer-aan-depth: 2
[2023-07-28 04:10:23] [config] transformer-aan-nogate: false
[2023-07-28 04:10:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 04:10:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 04:10:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 04:10:23] [config] transformer-depth-scaling: false
[2023-07-28 04:10:23] [config] transformer-dim-aan: 2048
[2023-07-28 04:10:23] [config] transformer-dim-ffn: 2048
[2023-07-28 04:10:23] [config] transformer-dropout: 0
[2023-07-28 04:10:23] [config] transformer-dropout-attention: 0
[2023-07-28 04:10:23] [config] transformer-dropout-ffn: 0
[2023-07-28 04:10:23] [config] transformer-ffn-activation: swish
[2023-07-28 04:10:23] [config] transformer-ffn-depth: 2
[2023-07-28 04:10:23] [config] transformer-guided-alignment-layer: last
[2023-07-28 04:10:23] [config] transformer-heads: 8
[2023-07-28 04:10:23] [config] transformer-no-projection: false
[2023-07-28 04:10:23] [config] transformer-pool: false
[2023-07-28 04:10:23] [config] transformer-postprocess: dan
[2023-07-28 04:10:23] [config] transformer-postprocess-emb: d
[2023-07-28 04:10:23] [config] transformer-postprocess-top: ""
[2023-07-28 04:10:23] [config] transformer-preprocess: ""
[2023-07-28 04:10:23] [config] transformer-tied-layers:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] transformer-train-position-embeddings: false
[2023-07-28 04:10:23] [config] tsv: false
[2023-07-28 04:10:23] [config] tsv-fields: 0
[2023-07-28 04:10:23] [config] type: s2s
[2023-07-28 04:10:23] [config] ulr: false
[2023-07-28 04:10:23] [config] ulr-dim-emb: 0
[2023-07-28 04:10:23] [config] ulr-dropout: 0
[2023-07-28 04:10:23] [config] ulr-keys-vectors: ""
[2023-07-28 04:10:23] [config] ulr-query-vectors: ""
[2023-07-28 04:10:23] [config] ulr-softmax-temperature: 1
[2023-07-28 04:10:23] [config] ulr-trainable-transformation: false
[2023-07-28 04:10:23] [config] unlikelihood-loss: false
[2023-07-28 04:10:23] [config] valid-freq: 50000000
[2023-07-28 04:10:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 04:10:23] [config] valid-max-length: 1000
[2023-07-28 04:10:23] [config] valid-metrics:
[2023-07-28 04:10:23] [config]   - translation
[2023-07-28 04:10:23] [config] valid-mini-batch: 32
[2023-07-28 04:10:23] [config] valid-reset-stalled: false
[2023-07-28 04:10:23] [config] valid-script-args:
[2023-07-28 04:10:23] [config]   []
[2023-07-28 04:10:23] [config] valid-script-path: ""
[2023-07-28 04:10:23] [config] valid-sets:
[2023-07-28 04:10:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 04:10:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 04:10:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 04:10:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:10:23] [config] vocabs:
[2023-07-28 04:10:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 04:10:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 04:10:23] [config] word-penalty: 0
[2023-07-28 04:10:23] [config] word-scores: false
[2023-07-28 04:10:23] [config] workspace: 5500
[2023-07-28 04:10:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:10:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:10:23] [training] Using single-device training
[2023-07-28 04:10:24] Synced seed 1234
[2023-07-28 04:10:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 04:10:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 04:10:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 04:10:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 04:10:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 04:10:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:10:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 04:10:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 04:10:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 04:10:24] [comm] Using global sharding
[2023-07-28 04:10:24] [comm] NCCLCommunicators constructed successfully
[2023-07-28 04:10:24] [training] Using 1 GPUs
[2023-07-28 04:10:24] [logits] Applying loss function for 1 factor(s)
[2023-07-28 04:10:24] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:10:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 04:10:25] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:14:53] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 04:14:53] [valid] No post-processing script given for validating translator
[2023-07-28 04:14:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:14:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 04:14:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 04:14:53] [comm] Using global sharding
[2023-07-28 04:14:53] [comm] NCCLCommunicators constructed successfully
[2023-07-28 04:14:53] [training] Using 1 GPUs
[2023-07-28 04:14:53] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:14:55] Allocating memory for general optimizer shards
[2023-07-28 04:14:55] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:14:55] Loading Adam parameters
[2023-07-28 04:14:55] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:14:55] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:14:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 04:14:55] [data] Restoring the corpus state to epoch 141, batch 3819
[2023-07-28 04:14:55] [data] Shuffling data
[2023-07-28 04:14:55] [data] Done reading 20,192 sentences
[2023-07-28 04:14:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:14:55] Training started
[2023-07-28 04:14:55] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 04:14:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:14:57] Parameter type float16, optimization type float32, casting types true
[2023-07-28 04:16:07] Seen 20,192 samples
[2023-07-28 04:16:07] Starting data epoch 142 in logical epoch 142
[2023-07-28 04:16:07] [data] Shuffling data
[2023-07-28 04:16:07] [data] Done reading 20,192 sentences
[2023-07-28 04:16:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:17:20] Seen 20,192 samples
[2023-07-28 04:17:20] Starting data epoch 143 in logical epoch 143
[2023-07-28 04:17:20] [data] Shuffling data
[2023-07-28 04:17:20] [data] Done reading 20,192 sentences
[2023-07-28 04:17:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:18:36] Seen 20,192 samples
[2023-07-28 04:18:36] Starting data epoch 144 in logical epoch 144
[2023-07-28 04:18:36] [data] Shuffling data
[2023-07-28 04:18:36] [data] Done reading 20,192 sentences
[2023-07-28 04:18:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:19:53] Seen 20,192 samples
[2023-07-28 04:19:53] Starting data epoch 145 in logical epoch 145
[2023-07-28 04:19:53] [data] Shuffling data
[2023-07-28 04:19:53] [data] Done reading 20,192 sentences
[2023-07-28 04:19:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:21:11] Seen 20,192 samples
[2023-07-28 04:21:11] Starting data epoch 146 in logical epoch 146
[2023-07-28 04:21:11] [data] Shuffling data
[2023-07-28 04:21:11] [data] Done reading 20,192 sentences
[2023-07-28 04:21:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:22:27] Seen 20,192 samples
[2023-07-28 04:22:27] Starting data epoch 147 in logical epoch 147
[2023-07-28 04:22:27] [data] Shuffling data
[2023-07-28 04:22:27] [data] Done reading 20,192 sentences
[2023-07-28 04:22:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:23:16] Ep. 147 : Up. 4000 : Sen. 12,800 : Cost 3.96381640 * 20,748,592 @ 29,616 after 83,156,914 : Time 502.39s : 41300.16 words/s : gNorm 1.2472
[2023-07-28 04:23:45] Seen 20,192 samples
[2023-07-28 04:23:45] Starting data epoch 148 in logical epoch 148
[2023-07-28 04:23:45] [data] Shuffling data
[2023-07-28 04:23:45] [data] Done reading 20,192 sentences
[2023-07-28 04:23:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:25:02] Seen 20,192 samples
[2023-07-28 04:25:02] Starting data epoch 149 in logical epoch 149
[2023-07-28 04:25:02] [data] Shuffling data
[2023-07-28 04:25:02] [data] Done reading 20,192 sentences
[2023-07-28 04:25:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:26:18] Seen 20,192 samples
[2023-07-28 04:26:18] Starting data epoch 150 in logical epoch 150
[2023-07-28 04:26:18] [data] Shuffling data
[2023-07-28 04:26:18] [data] Done reading 20,192 sentences
[2023-07-28 04:26:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:27:36] Seen 20,192 samples
[2023-07-28 04:27:36] Starting data epoch 151 in logical epoch 151
[2023-07-28 04:27:36] Training finished
[2023-07-28 04:28:21] [valid] Ep. 151 : Up. 4092 : translation : 0 : new best
[2023-07-28 04:28:21] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:28:23] Saving Adam parameters
[2023-07-28 04:28:24] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 04:28:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:28:34] [marian] Running on node05.datos.cluster.uy as process 31606 with command line:
[2023-07-28 04:28:34] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 04:28:34] [config] after: 0e
[2023-07-28 04:28:34] [config] after-batches: 0
[2023-07-28 04:28:34] [config] after-epochs: 160
[2023-07-28 04:28:34] [config] all-caps-every: 0
[2023-07-28 04:28:34] [config] allow-unk: false
[2023-07-28 04:28:34] [config] authors: false
[2023-07-28 04:28:34] [config] beam-size: 12
[2023-07-28 04:28:34] [config] bert-class-symbol: "[CLS]"
[2023-07-28 04:28:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 04:28:34] [config] bert-masking-fraction: 0.15
[2023-07-28 04:28:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 04:28:34] [config] bert-train-type-embeddings: true
[2023-07-28 04:28:34] [config] bert-type-vocab-size: 2
[2023-07-28 04:28:34] [config] build-info: ""
[2023-07-28 04:28:34] [config] check-gradient-nan: false
[2023-07-28 04:28:34] [config] check-nan: false
[2023-07-28 04:28:34] [config] cite: false
[2023-07-28 04:28:34] [config] clip-norm: 1
[2023-07-28 04:28:34] [config] cost-scaling:
[2023-07-28 04:28:34] [config]   - 256.f
[2023-07-28 04:28:34] [config]   - 1000
[2023-07-28 04:28:34] [config]   - 2.f
[2023-07-28 04:28:34] [config]   - 256.f
[2023-07-28 04:28:34] [config] cost-type: ce-sum
[2023-07-28 04:28:34] [config] cpu-threads: 0
[2023-07-28 04:28:34] [config] data-threads: 8
[2023-07-28 04:28:34] [config] data-weighting: ""
[2023-07-28 04:28:34] [config] data-weighting-type: sentence
[2023-07-28 04:28:34] [config] dec-cell: gru
[2023-07-28 04:28:34] [config] dec-cell-base-depth: 2
[2023-07-28 04:28:34] [config] dec-cell-high-depth: 1
[2023-07-28 04:28:34] [config] dec-depth: 1
[2023-07-28 04:28:34] [config] devices:
[2023-07-28 04:28:34] [config]   - 0
[2023-07-28 04:28:34] [config] dim-emb: 512
[2023-07-28 04:28:34] [config] dim-rnn: 1024
[2023-07-28 04:28:34] [config] dim-vocabs:
[2023-07-28 04:28:34] [config]   - 16384
[2023-07-28 04:28:34] [config]   - 16384
[2023-07-28 04:28:34] [config] disp-first: 0
[2023-07-28 04:28:34] [config] disp-freq: 1000u
[2023-07-28 04:28:34] [config] disp-label-counts: true
[2023-07-28 04:28:34] [config] dropout-rnn: 0
[2023-07-28 04:28:34] [config] dropout-src: 0
[2023-07-28 04:28:34] [config] dropout-trg: 0
[2023-07-28 04:28:34] [config] dump-config: ""
[2023-07-28 04:28:34] [config] dynamic-gradient-scaling:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] early-stopping: 1000
[2023-07-28 04:28:34] [config] early-stopping-on: first
[2023-07-28 04:28:34] [config] embedding-fix-src: false
[2023-07-28 04:28:34] [config] embedding-fix-trg: false
[2023-07-28 04:28:34] [config] embedding-normalization: false
[2023-07-28 04:28:34] [config] embedding-vectors:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] enc-cell: gru
[2023-07-28 04:28:34] [config] enc-cell-depth: 1
[2023-07-28 04:28:34] [config] enc-depth: 1
[2023-07-28 04:28:34] [config] enc-type: bidirectional
[2023-07-28 04:28:34] [config] english-title-case-every: 0
[2023-07-28 04:28:34] [config] exponential-smoothing: 0
[2023-07-28 04:28:34] [config] factor-weight: 1
[2023-07-28 04:28:34] [config] factors-combine: sum
[2023-07-28 04:28:34] [config] factors-dim-emb: 0
[2023-07-28 04:28:34] [config] gradient-checkpointing: false
[2023-07-28 04:28:34] [config] gradient-norm-average-window: 100
[2023-07-28 04:28:34] [config] guided-alignment: none
[2023-07-28 04:28:34] [config] guided-alignment-cost: mse
[2023-07-28 04:28:34] [config] guided-alignment-weight: 0.1
[2023-07-28 04:28:34] [config] ignore-model-config: false
[2023-07-28 04:28:34] [config] input-types:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] interpolate-env-vars: false
[2023-07-28 04:28:34] [config] keep-best: false
[2023-07-28 04:28:34] [config] label-smoothing: 0
[2023-07-28 04:28:34] [config] layer-normalization: false
[2023-07-28 04:28:34] [config] learn-rate: 0.0001
[2023-07-28 04:28:34] [config] lemma-dependency: ""
[2023-07-28 04:28:34] [config] lemma-dim-emb: 0
[2023-07-28 04:28:34] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 04:28:34] [config] log-level: info
[2023-07-28 04:28:34] [config] log-time-zone: ""
[2023-07-28 04:28:34] [config] logical-epoch:
[2023-07-28 04:28:34] [config]   - 1e
[2023-07-28 04:28:34] [config]   - 0
[2023-07-28 04:28:34] [config] lr-decay: 0
[2023-07-28 04:28:34] [config] lr-decay-freq: 50000
[2023-07-28 04:28:34] [config] lr-decay-inv-sqrt:
[2023-07-28 04:28:34] [config]   - 0
[2023-07-28 04:28:34] [config] lr-decay-repeat-warmup: false
[2023-07-28 04:28:34] [config] lr-decay-reset-optimizer: false
[2023-07-28 04:28:34] [config] lr-decay-start:
[2023-07-28 04:28:34] [config]   - 10
[2023-07-28 04:28:34] [config]   - 1
[2023-07-28 04:28:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 04:28:34] [config] lr-report: false
[2023-07-28 04:28:34] [config] lr-warmup: 0
[2023-07-28 04:28:34] [config] lr-warmup-at-reload: false
[2023-07-28 04:28:34] [config] lr-warmup-cycle: false
[2023-07-28 04:28:34] [config] lr-warmup-start-rate: 0
[2023-07-28 04:28:34] [config] max-length: 50
[2023-07-28 04:28:34] [config] max-length-crop: true
[2023-07-28 04:28:34] [config] max-length-factor: 3
[2023-07-28 04:28:34] [config] maxi-batch: 100
[2023-07-28 04:28:34] [config] maxi-batch-sort: trg
[2023-07-28 04:28:34] [config] mini-batch: 64
[2023-07-28 04:28:34] [config] mini-batch-fit: true
[2023-07-28 04:28:34] [config] mini-batch-fit-step: 10
[2023-07-28 04:28:34] [config] mini-batch-round-up: true
[2023-07-28 04:28:34] [config] mini-batch-track-lr: false
[2023-07-28 04:28:34] [config] mini-batch-warmup: 0
[2023-07-28 04:28:34] [config] mini-batch-words: 0
[2023-07-28 04:28:34] [config] mini-batch-words-ref: 0
[2023-07-28 04:28:34] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:28:34] [config] multi-loss-type: sum
[2023-07-28 04:28:34] [config] n-best: false
[2023-07-28 04:28:34] [config] no-nccl: false
[2023-07-28 04:28:34] [config] no-reload: false
[2023-07-28 04:28:34] [config] no-restore-corpus: false
[2023-07-28 04:28:34] [config] normalize: 0
[2023-07-28 04:28:34] [config] normalize-gradient: false
[2023-07-28 04:28:34] [config] num-devices: 0
[2023-07-28 04:28:34] [config] optimizer: adam
[2023-07-28 04:28:34] [config] optimizer-delay: 1
[2023-07-28 04:28:34] [config] optimizer-params:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] output-omit-bias: false
[2023-07-28 04:28:34] [config] overwrite: true
[2023-07-28 04:28:34] [config] precision:
[2023-07-28 04:28:34] [config]   - float16
[2023-07-28 04:28:34] [config]   - float32
[2023-07-28 04:28:34] [config] pretrained-model: ""
[2023-07-28 04:28:34] [config] quantize-biases: false
[2023-07-28 04:28:34] [config] quantize-bits: 0
[2023-07-28 04:28:34] [config] quantize-log-based: false
[2023-07-28 04:28:34] [config] quantize-optimization-steps: 0
[2023-07-28 04:28:34] [config] quiet: false
[2023-07-28 04:28:34] [config] quiet-translation: true
[2023-07-28 04:28:34] [config] relative-paths: false
[2023-07-28 04:28:34] [config] right-left: false
[2023-07-28 04:28:34] [config] save-freq: 10000u
[2023-07-28 04:28:34] [config] seed: 1234
[2023-07-28 04:28:34] [config] sentencepiece-alphas:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] sentencepiece-max-lines: 2000000
[2023-07-28 04:28:34] [config] sentencepiece-options: ""
[2023-07-28 04:28:34] [config] sharding: global
[2023-07-28 04:28:34] [config] shuffle: data
[2023-07-28 04:28:34] [config] shuffle-in-ram: false
[2023-07-28 04:28:34] [config] sigterm: save-and-exit
[2023-07-28 04:28:34] [config] skip: false
[2023-07-28 04:28:34] [config] sqlite: ""
[2023-07-28 04:28:34] [config] sqlite-drop: false
[2023-07-28 04:28:34] [config] sync-freq: 200u
[2023-07-28 04:28:34] [config] sync-sgd: false
[2023-07-28 04:28:34] [config] tempdir: /tmp
[2023-07-28 04:28:34] [config] tied-embeddings: false
[2023-07-28 04:28:34] [config] tied-embeddings-all: true
[2023-07-28 04:28:34] [config] tied-embeddings-src: false
[2023-07-28 04:28:34] [config] train-embedder-rank:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] train-sets:
[2023-07-28 04:28:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 04:28:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 04:28:34] [config] transformer-aan-activation: swish
[2023-07-28 04:28:34] [config] transformer-aan-depth: 2
[2023-07-28 04:28:34] [config] transformer-aan-nogate: false
[2023-07-28 04:28:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 04:28:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 04:28:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 04:28:34] [config] transformer-depth-scaling: false
[2023-07-28 04:28:34] [config] transformer-dim-aan: 2048
[2023-07-28 04:28:34] [config] transformer-dim-ffn: 2048
[2023-07-28 04:28:34] [config] transformer-dropout: 0
[2023-07-28 04:28:34] [config] transformer-dropout-attention: 0
[2023-07-28 04:28:34] [config] transformer-dropout-ffn: 0
[2023-07-28 04:28:34] [config] transformer-ffn-activation: swish
[2023-07-28 04:28:34] [config] transformer-ffn-depth: 2
[2023-07-28 04:28:34] [config] transformer-guided-alignment-layer: last
[2023-07-28 04:28:34] [config] transformer-heads: 8
[2023-07-28 04:28:34] [config] transformer-no-projection: false
[2023-07-28 04:28:34] [config] transformer-pool: false
[2023-07-28 04:28:34] [config] transformer-postprocess: dan
[2023-07-28 04:28:34] [config] transformer-postprocess-emb: d
[2023-07-28 04:28:34] [config] transformer-postprocess-top: ""
[2023-07-28 04:28:34] [config] transformer-preprocess: ""
[2023-07-28 04:28:34] [config] transformer-tied-layers:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] transformer-train-position-embeddings: false
[2023-07-28 04:28:34] [config] tsv: false
[2023-07-28 04:28:34] [config] tsv-fields: 0
[2023-07-28 04:28:34] [config] type: s2s
[2023-07-28 04:28:34] [config] ulr: false
[2023-07-28 04:28:34] [config] ulr-dim-emb: 0
[2023-07-28 04:28:34] [config] ulr-dropout: 0
[2023-07-28 04:28:34] [config] ulr-keys-vectors: ""
[2023-07-28 04:28:34] [config] ulr-query-vectors: ""
[2023-07-28 04:28:34] [config] ulr-softmax-temperature: 1
[2023-07-28 04:28:34] [config] ulr-trainable-transformation: false
[2023-07-28 04:28:34] [config] unlikelihood-loss: false
[2023-07-28 04:28:34] [config] valid-freq: 50000000
[2023-07-28 04:28:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 04:28:34] [config] valid-max-length: 1000
[2023-07-28 04:28:34] [config] valid-metrics:
[2023-07-28 04:28:34] [config]   - translation
[2023-07-28 04:28:34] [config] valid-mini-batch: 32
[2023-07-28 04:28:34] [config] valid-reset-stalled: false
[2023-07-28 04:28:34] [config] valid-script-args:
[2023-07-28 04:28:34] [config]   []
[2023-07-28 04:28:34] [config] valid-script-path: ""
[2023-07-28 04:28:34] [config] valid-sets:
[2023-07-28 04:28:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 04:28:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 04:28:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 04:28:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:28:34] [config] vocabs:
[2023-07-28 04:28:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 04:28:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 04:28:34] [config] word-penalty: 0
[2023-07-28 04:28:34] [config] word-scores: false
[2023-07-28 04:28:34] [config] workspace: 5500
[2023-07-28 04:28:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:28:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:28:34] [training] Using single-device training
[2023-07-28 04:28:34] Synced seed 1234
[2023-07-28 04:28:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 04:28:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 04:28:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 04:28:35] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 04:28:35] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 04:28:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:28:35] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 04:28:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 04:28:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 04:28:35] [comm] Using global sharding
[2023-07-28 04:28:36] [comm] NCCLCommunicators constructed successfully
[2023-07-28 04:28:36] [training] Using 1 GPUs
[2023-07-28 04:28:36] [logits] Applying loss function for 1 factor(s)
[2023-07-28 04:28:36] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:28:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 04:28:36] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:33:07] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 04:33:07] [valid] No post-processing script given for validating translator
[2023-07-28 04:33:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:33:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 04:33:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 04:33:07] [comm] Using global sharding
[2023-07-28 04:33:07] [comm] NCCLCommunicators constructed successfully
[2023-07-28 04:33:07] [training] Using 1 GPUs
[2023-07-28 04:33:07] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:33:08] Allocating memory for general optimizer shards
[2023-07-28 04:33:08] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:33:08] Loading Adam parameters
[2023-07-28 04:33:08] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:33:08] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:33:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 04:33:09] [data] Restoring the corpus state to epoch 151, batch 4092
[2023-07-28 04:33:09] [data] Shuffling data
[2023-07-28 04:33:09] [data] Done reading 20,192 sentences
[2023-07-28 04:33:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:33:09] Training started
[2023-07-28 04:33:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 04:33:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:33:13] Parameter type float16, optimization type float32, casting types true
[2023-07-28 04:34:20] Seen 20,192 samples
[2023-07-28 04:34:20] Starting data epoch 152 in logical epoch 152
[2023-07-28 04:34:20] [data] Shuffling data
[2023-07-28 04:34:20] [data] Done reading 20,192 sentences
[2023-07-28 04:34:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:35:31] Seen 20,192 samples
[2023-07-28 04:35:31] Starting data epoch 153 in logical epoch 153
[2023-07-28 04:35:31] [data] Shuffling data
[2023-07-28 04:35:31] [data] Done reading 20,192 sentences
[2023-07-28 04:35:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:36:45] Seen 20,192 samples
[2023-07-28 04:36:45] Starting data epoch 154 in logical epoch 154
[2023-07-28 04:36:45] [data] Shuffling data
[2023-07-28 04:36:45] [data] Done reading 20,192 sentences
[2023-07-28 04:36:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:38:00] Seen 20,192 samples
[2023-07-28 04:38:00] Starting data epoch 155 in logical epoch 155
[2023-07-28 04:38:00] [data] Shuffling data
[2023-07-28 04:38:00] [data] Done reading 20,192 sentences
[2023-07-28 04:38:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:39:17] Seen 20,192 samples
[2023-07-28 04:39:17] Starting data epoch 156 in logical epoch 156
[2023-07-28 04:39:17] [data] Shuffling data
[2023-07-28 04:39:17] [data] Done reading 20,192 sentences
[2023-07-28 04:39:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:40:33] Seen 20,192 samples
[2023-07-28 04:40:33] Starting data epoch 157 in logical epoch 157
[2023-07-28 04:40:33] [data] Shuffling data
[2023-07-28 04:40:33] [data] Done reading 20,192 sentences
[2023-07-28 04:40:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:41:49] Seen 20,192 samples
[2023-07-28 04:41:49] Starting data epoch 158 in logical epoch 158
[2023-07-28 04:41:49] [data] Shuffling data
[2023-07-28 04:41:49] [data] Done reading 20,192 sentences
[2023-07-28 04:41:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:43:07] Seen 20,192 samples
[2023-07-28 04:43:07] Starting data epoch 159 in logical epoch 159
[2023-07-28 04:43:07] [data] Shuffling data
[2023-07-28 04:43:07] [data] Done reading 20,192 sentences
[2023-07-28 04:43:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:44:25] Seen 20,192 samples
[2023-07-28 04:44:25] Starting data epoch 160 in logical epoch 160
[2023-07-28 04:44:25] [data] Shuffling data
[2023-07-28 04:44:25] [data] Done reading 20,192 sentences
[2023-07-28 04:44:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:45:42] Seen 20,192 samples
[2023-07-28 04:45:42] Starting data epoch 161 in logical epoch 161
[2023-07-28 04:45:42] Training finished
[2023-07-28 04:46:25] [valid] Ep. 161 : Up. 4366 : translation : 0 : new best
[2023-07-28 04:46:25] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:46:26] Saving Adam parameters
[2023-07-28 04:46:27] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 04:46:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:46:34] [marian] Running on node05.datos.cluster.uy as process 32591 with command line:
[2023-07-28 04:46:34] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 04:46:34] [config] after: 0e
[2023-07-28 04:46:34] [config] after-batches: 0
[2023-07-28 04:46:34] [config] after-epochs: 170
[2023-07-28 04:46:34] [config] all-caps-every: 0
[2023-07-28 04:46:34] [config] allow-unk: false
[2023-07-28 04:46:34] [config] authors: false
[2023-07-28 04:46:34] [config] beam-size: 12
[2023-07-28 04:46:34] [config] bert-class-symbol: "[CLS]"
[2023-07-28 04:46:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 04:46:34] [config] bert-masking-fraction: 0.15
[2023-07-28 04:46:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 04:46:34] [config] bert-train-type-embeddings: true
[2023-07-28 04:46:34] [config] bert-type-vocab-size: 2
[2023-07-28 04:46:34] [config] build-info: ""
[2023-07-28 04:46:34] [config] check-gradient-nan: false
[2023-07-28 04:46:34] [config] check-nan: false
[2023-07-28 04:46:34] [config] cite: false
[2023-07-28 04:46:34] [config] clip-norm: 1
[2023-07-28 04:46:34] [config] cost-scaling:
[2023-07-28 04:46:34] [config]   - 256.f
[2023-07-28 04:46:34] [config]   - 1000
[2023-07-28 04:46:34] [config]   - 2.f
[2023-07-28 04:46:34] [config]   - 256.f
[2023-07-28 04:46:34] [config] cost-type: ce-sum
[2023-07-28 04:46:34] [config] cpu-threads: 0
[2023-07-28 04:46:34] [config] data-threads: 8
[2023-07-28 04:46:34] [config] data-weighting: ""
[2023-07-28 04:46:34] [config] data-weighting-type: sentence
[2023-07-28 04:46:34] [config] dec-cell: gru
[2023-07-28 04:46:34] [config] dec-cell-base-depth: 2
[2023-07-28 04:46:34] [config] dec-cell-high-depth: 1
[2023-07-28 04:46:34] [config] dec-depth: 1
[2023-07-28 04:46:34] [config] devices:
[2023-07-28 04:46:34] [config]   - 0
[2023-07-28 04:46:34] [config] dim-emb: 512
[2023-07-28 04:46:34] [config] dim-rnn: 1024
[2023-07-28 04:46:34] [config] dim-vocabs:
[2023-07-28 04:46:34] [config]   - 16384
[2023-07-28 04:46:34] [config]   - 16384
[2023-07-28 04:46:34] [config] disp-first: 0
[2023-07-28 04:46:34] [config] disp-freq: 1000u
[2023-07-28 04:46:34] [config] disp-label-counts: true
[2023-07-28 04:46:34] [config] dropout-rnn: 0
[2023-07-28 04:46:34] [config] dropout-src: 0
[2023-07-28 04:46:34] [config] dropout-trg: 0
[2023-07-28 04:46:34] [config] dump-config: ""
[2023-07-28 04:46:34] [config] dynamic-gradient-scaling:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] early-stopping: 1000
[2023-07-28 04:46:34] [config] early-stopping-on: first
[2023-07-28 04:46:34] [config] embedding-fix-src: false
[2023-07-28 04:46:34] [config] embedding-fix-trg: false
[2023-07-28 04:46:34] [config] embedding-normalization: false
[2023-07-28 04:46:34] [config] embedding-vectors:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] enc-cell: gru
[2023-07-28 04:46:34] [config] enc-cell-depth: 1
[2023-07-28 04:46:34] [config] enc-depth: 1
[2023-07-28 04:46:34] [config] enc-type: bidirectional
[2023-07-28 04:46:34] [config] english-title-case-every: 0
[2023-07-28 04:46:34] [config] exponential-smoothing: 0
[2023-07-28 04:46:34] [config] factor-weight: 1
[2023-07-28 04:46:34] [config] factors-combine: sum
[2023-07-28 04:46:34] [config] factors-dim-emb: 0
[2023-07-28 04:46:34] [config] gradient-checkpointing: false
[2023-07-28 04:46:34] [config] gradient-norm-average-window: 100
[2023-07-28 04:46:34] [config] guided-alignment: none
[2023-07-28 04:46:34] [config] guided-alignment-cost: mse
[2023-07-28 04:46:34] [config] guided-alignment-weight: 0.1
[2023-07-28 04:46:34] [config] ignore-model-config: false
[2023-07-28 04:46:34] [config] input-types:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] interpolate-env-vars: false
[2023-07-28 04:46:34] [config] keep-best: false
[2023-07-28 04:46:34] [config] label-smoothing: 0
[2023-07-28 04:46:34] [config] layer-normalization: false
[2023-07-28 04:46:34] [config] learn-rate: 0.0001
[2023-07-28 04:46:34] [config] lemma-dependency: ""
[2023-07-28 04:46:34] [config] lemma-dim-emb: 0
[2023-07-28 04:46:34] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 04:46:34] [config] log-level: info
[2023-07-28 04:46:34] [config] log-time-zone: ""
[2023-07-28 04:46:34] [config] logical-epoch:
[2023-07-28 04:46:34] [config]   - 1e
[2023-07-28 04:46:34] [config]   - 0
[2023-07-28 04:46:34] [config] lr-decay: 0
[2023-07-28 04:46:34] [config] lr-decay-freq: 50000
[2023-07-28 04:46:34] [config] lr-decay-inv-sqrt:
[2023-07-28 04:46:34] [config]   - 0
[2023-07-28 04:46:34] [config] lr-decay-repeat-warmup: false
[2023-07-28 04:46:34] [config] lr-decay-reset-optimizer: false
[2023-07-28 04:46:34] [config] lr-decay-start:
[2023-07-28 04:46:34] [config]   - 10
[2023-07-28 04:46:34] [config]   - 1
[2023-07-28 04:46:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 04:46:34] [config] lr-report: false
[2023-07-28 04:46:34] [config] lr-warmup: 0
[2023-07-28 04:46:34] [config] lr-warmup-at-reload: false
[2023-07-28 04:46:34] [config] lr-warmup-cycle: false
[2023-07-28 04:46:34] [config] lr-warmup-start-rate: 0
[2023-07-28 04:46:34] [config] max-length: 50
[2023-07-28 04:46:34] [config] max-length-crop: true
[2023-07-28 04:46:34] [config] max-length-factor: 3
[2023-07-28 04:46:34] [config] maxi-batch: 100
[2023-07-28 04:46:34] [config] maxi-batch-sort: trg
[2023-07-28 04:46:34] [config] mini-batch: 64
[2023-07-28 04:46:34] [config] mini-batch-fit: true
[2023-07-28 04:46:34] [config] mini-batch-fit-step: 10
[2023-07-28 04:46:34] [config] mini-batch-round-up: true
[2023-07-28 04:46:34] [config] mini-batch-track-lr: false
[2023-07-28 04:46:34] [config] mini-batch-warmup: 0
[2023-07-28 04:46:34] [config] mini-batch-words: 0
[2023-07-28 04:46:34] [config] mini-batch-words-ref: 0
[2023-07-28 04:46:34] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:46:34] [config] multi-loss-type: sum
[2023-07-28 04:46:34] [config] n-best: false
[2023-07-28 04:46:34] [config] no-nccl: false
[2023-07-28 04:46:34] [config] no-reload: false
[2023-07-28 04:46:34] [config] no-restore-corpus: false
[2023-07-28 04:46:34] [config] normalize: 0
[2023-07-28 04:46:34] [config] normalize-gradient: false
[2023-07-28 04:46:34] [config] num-devices: 0
[2023-07-28 04:46:34] [config] optimizer: adam
[2023-07-28 04:46:34] [config] optimizer-delay: 1
[2023-07-28 04:46:34] [config] optimizer-params:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] output-omit-bias: false
[2023-07-28 04:46:34] [config] overwrite: true
[2023-07-28 04:46:34] [config] precision:
[2023-07-28 04:46:34] [config]   - float16
[2023-07-28 04:46:34] [config]   - float32
[2023-07-28 04:46:34] [config] pretrained-model: ""
[2023-07-28 04:46:34] [config] quantize-biases: false
[2023-07-28 04:46:34] [config] quantize-bits: 0
[2023-07-28 04:46:34] [config] quantize-log-based: false
[2023-07-28 04:46:34] [config] quantize-optimization-steps: 0
[2023-07-28 04:46:34] [config] quiet: false
[2023-07-28 04:46:34] [config] quiet-translation: true
[2023-07-28 04:46:34] [config] relative-paths: false
[2023-07-28 04:46:34] [config] right-left: false
[2023-07-28 04:46:34] [config] save-freq: 10000u
[2023-07-28 04:46:34] [config] seed: 1234
[2023-07-28 04:46:34] [config] sentencepiece-alphas:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] sentencepiece-max-lines: 2000000
[2023-07-28 04:46:34] [config] sentencepiece-options: ""
[2023-07-28 04:46:34] [config] sharding: global
[2023-07-28 04:46:34] [config] shuffle: data
[2023-07-28 04:46:34] [config] shuffle-in-ram: false
[2023-07-28 04:46:34] [config] sigterm: save-and-exit
[2023-07-28 04:46:34] [config] skip: false
[2023-07-28 04:46:34] [config] sqlite: ""
[2023-07-28 04:46:34] [config] sqlite-drop: false
[2023-07-28 04:46:34] [config] sync-freq: 200u
[2023-07-28 04:46:34] [config] sync-sgd: false
[2023-07-28 04:46:34] [config] tempdir: /tmp
[2023-07-28 04:46:34] [config] tied-embeddings: false
[2023-07-28 04:46:34] [config] tied-embeddings-all: true
[2023-07-28 04:46:34] [config] tied-embeddings-src: false
[2023-07-28 04:46:34] [config] train-embedder-rank:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] train-sets:
[2023-07-28 04:46:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 04:46:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 04:46:34] [config] transformer-aan-activation: swish
[2023-07-28 04:46:34] [config] transformer-aan-depth: 2
[2023-07-28 04:46:34] [config] transformer-aan-nogate: false
[2023-07-28 04:46:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 04:46:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 04:46:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 04:46:34] [config] transformer-depth-scaling: false
[2023-07-28 04:46:34] [config] transformer-dim-aan: 2048
[2023-07-28 04:46:34] [config] transformer-dim-ffn: 2048
[2023-07-28 04:46:34] [config] transformer-dropout: 0
[2023-07-28 04:46:34] [config] transformer-dropout-attention: 0
[2023-07-28 04:46:34] [config] transformer-dropout-ffn: 0
[2023-07-28 04:46:34] [config] transformer-ffn-activation: swish
[2023-07-28 04:46:34] [config] transformer-ffn-depth: 2
[2023-07-28 04:46:34] [config] transformer-guided-alignment-layer: last
[2023-07-28 04:46:34] [config] transformer-heads: 8
[2023-07-28 04:46:34] [config] transformer-no-projection: false
[2023-07-28 04:46:34] [config] transformer-pool: false
[2023-07-28 04:46:34] [config] transformer-postprocess: dan
[2023-07-28 04:46:34] [config] transformer-postprocess-emb: d
[2023-07-28 04:46:34] [config] transformer-postprocess-top: ""
[2023-07-28 04:46:34] [config] transformer-preprocess: ""
[2023-07-28 04:46:34] [config] transformer-tied-layers:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] transformer-train-position-embeddings: false
[2023-07-28 04:46:34] [config] tsv: false
[2023-07-28 04:46:34] [config] tsv-fields: 0
[2023-07-28 04:46:34] [config] type: s2s
[2023-07-28 04:46:34] [config] ulr: false
[2023-07-28 04:46:34] [config] ulr-dim-emb: 0
[2023-07-28 04:46:34] [config] ulr-dropout: 0
[2023-07-28 04:46:34] [config] ulr-keys-vectors: ""
[2023-07-28 04:46:34] [config] ulr-query-vectors: ""
[2023-07-28 04:46:34] [config] ulr-softmax-temperature: 1
[2023-07-28 04:46:34] [config] ulr-trainable-transformation: false
[2023-07-28 04:46:34] [config] unlikelihood-loss: false
[2023-07-28 04:46:34] [config] valid-freq: 50000000
[2023-07-28 04:46:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 04:46:34] [config] valid-max-length: 1000
[2023-07-28 04:46:34] [config] valid-metrics:
[2023-07-28 04:46:34] [config]   - translation
[2023-07-28 04:46:34] [config] valid-mini-batch: 32
[2023-07-28 04:46:34] [config] valid-reset-stalled: false
[2023-07-28 04:46:34] [config] valid-script-args:
[2023-07-28 04:46:34] [config]   []
[2023-07-28 04:46:34] [config] valid-script-path: ""
[2023-07-28 04:46:34] [config] valid-sets:
[2023-07-28 04:46:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 04:46:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 04:46:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 04:46:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:46:34] [config] vocabs:
[2023-07-28 04:46:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 04:46:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 04:46:34] [config] word-penalty: 0
[2023-07-28 04:46:34] [config] word-scores: false
[2023-07-28 04:46:34] [config] workspace: 5500
[2023-07-28 04:46:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 04:46:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:46:34] [training] Using single-device training
[2023-07-28 04:46:34] Synced seed 1234
[2023-07-28 04:46:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 04:46:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 04:46:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 04:46:34] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 04:46:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 04:46:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:46:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 04:46:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 04:46:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 04:46:35] [comm] Using global sharding
[2023-07-28 04:46:35] [comm] NCCLCommunicators constructed successfully
[2023-07-28 04:46:35] [training] Using 1 GPUs
[2023-07-28 04:46:35] [logits] Applying loss function for 1 factor(s)
[2023-07-28 04:46:35] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:46:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 04:46:36] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:51:04] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 04:51:04] [valid] No post-processing script given for validating translator
[2023-07-28 04:51:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:51:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 04:51:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 04:51:04] [comm] Using global sharding
[2023-07-28 04:51:04] [comm] NCCLCommunicators constructed successfully
[2023-07-28 04:51:04] [training] Using 1 GPUs
[2023-07-28 04:51:04] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 04:51:05] Allocating memory for general optimizer shards
[2023-07-28 04:51:05] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:51:05] Loading Adam parameters
[2023-07-28 04:51:05] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:51:06] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:51:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 04:51:06] [data] Restoring the corpus state to epoch 161, batch 4366
[2023-07-28 04:51:06] [data] Shuffling data
[2023-07-28 04:51:06] [data] Done reading 20,192 sentences
[2023-07-28 04:51:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:51:06] Training started
[2023-07-28 04:51:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 04:51:06] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:51:07] Parameter type float16, optimization type float32, casting types true
[2023-07-28 04:52:17] Seen 20,192 samples
[2023-07-28 04:52:17] Starting data epoch 162 in logical epoch 162
[2023-07-28 04:52:17] [data] Shuffling data
[2023-07-28 04:52:17] [data] Done reading 20,192 sentences
[2023-07-28 04:52:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:53:30] Seen 20,192 samples
[2023-07-28 04:53:30] Starting data epoch 163 in logical epoch 163
[2023-07-28 04:53:30] [data] Shuffling data
[2023-07-28 04:53:30] [data] Done reading 20,192 sentences
[2023-07-28 04:53:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:54:44] Seen 20,192 samples
[2023-07-28 04:54:44] Starting data epoch 164 in logical epoch 164
[2023-07-28 04:54:44] [data] Shuffling data
[2023-07-28 04:54:44] [data] Done reading 20,192 sentences
[2023-07-28 04:54:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:56:01] Seen 20,192 samples
[2023-07-28 04:56:01] Starting data epoch 165 in logical epoch 165
[2023-07-28 04:56:01] [data] Shuffling data
[2023-07-28 04:56:01] [data] Done reading 20,192 sentences
[2023-07-28 04:56:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:57:18] Seen 20,192 samples
[2023-07-28 04:57:18] Starting data epoch 166 in logical epoch 166
[2023-07-28 04:57:18] [data] Shuffling data
[2023-07-28 04:57:18] [data] Done reading 20,192 sentences
[2023-07-28 04:57:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:58:34] Seen 20,192 samples
[2023-07-28 04:58:34] Starting data epoch 167 in logical epoch 167
[2023-07-28 04:58:34] [data] Shuffling data
[2023-07-28 04:58:34] [data] Done reading 20,192 sentences
[2023-07-28 04:58:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:59:51] Seen 20,192 samples
[2023-07-28 04:59:51] Starting data epoch 168 in logical epoch 168
[2023-07-28 04:59:51] [data] Shuffling data
[2023-07-28 04:59:51] [data] Done reading 20,192 sentences
[2023-07-28 04:59:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:01:07] Seen 20,192 samples
[2023-07-28 05:01:07] Starting data epoch 169 in logical epoch 169
[2023-07-28 05:01:07] [data] Shuffling data
[2023-07-28 05:01:07] [data] Done reading 20,192 sentences
[2023-07-28 05:01:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:02:21] Seen 20,192 samples
[2023-07-28 05:02:21] Starting data epoch 170 in logical epoch 170
[2023-07-28 05:02:21] [data] Shuffling data
[2023-07-28 05:02:21] [data] Done reading 20,192 sentences
[2023-07-28 05:02:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:03:37] Seen 20,192 samples
[2023-07-28 05:03:37] Starting data epoch 171 in logical epoch 171
[2023-07-28 05:03:37] Training finished
[2023-07-28 05:04:19] [valid] Ep. 171 : Up. 4637 : translation : 0 : new best
[2023-07-28 05:04:19] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:04:20] Saving Adam parameters
[2023-07-28 05:04:21] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 05:04:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:04:32] [marian] Running on node05.datos.cluster.uy as process 33944 with command line:
[2023-07-28 05:04:32] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 05:04:32] [config] after: 0e
[2023-07-28 05:04:32] [config] after-batches: 0
[2023-07-28 05:04:32] [config] after-epochs: 180
[2023-07-28 05:04:32] [config] all-caps-every: 0
[2023-07-28 05:04:32] [config] allow-unk: false
[2023-07-28 05:04:32] [config] authors: false
[2023-07-28 05:04:32] [config] beam-size: 12
[2023-07-28 05:04:32] [config] bert-class-symbol: "[CLS]"
[2023-07-28 05:04:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 05:04:32] [config] bert-masking-fraction: 0.15
[2023-07-28 05:04:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 05:04:32] [config] bert-train-type-embeddings: true
[2023-07-28 05:04:32] [config] bert-type-vocab-size: 2
[2023-07-28 05:04:32] [config] build-info: ""
[2023-07-28 05:04:32] [config] check-gradient-nan: false
[2023-07-28 05:04:32] [config] check-nan: false
[2023-07-28 05:04:32] [config] cite: false
[2023-07-28 05:04:32] [config] clip-norm: 1
[2023-07-28 05:04:32] [config] cost-scaling:
[2023-07-28 05:04:32] [config]   - 256.f
[2023-07-28 05:04:32] [config]   - 1000
[2023-07-28 05:04:32] [config]   - 2.f
[2023-07-28 05:04:32] [config]   - 256.f
[2023-07-28 05:04:32] [config] cost-type: ce-sum
[2023-07-28 05:04:32] [config] cpu-threads: 0
[2023-07-28 05:04:32] [config] data-threads: 8
[2023-07-28 05:04:32] [config] data-weighting: ""
[2023-07-28 05:04:32] [config] data-weighting-type: sentence
[2023-07-28 05:04:32] [config] dec-cell: gru
[2023-07-28 05:04:32] [config] dec-cell-base-depth: 2
[2023-07-28 05:04:32] [config] dec-cell-high-depth: 1
[2023-07-28 05:04:32] [config] dec-depth: 1
[2023-07-28 05:04:32] [config] devices:
[2023-07-28 05:04:32] [config]   - 0
[2023-07-28 05:04:32] [config] dim-emb: 512
[2023-07-28 05:04:32] [config] dim-rnn: 1024
[2023-07-28 05:04:32] [config] dim-vocabs:
[2023-07-28 05:04:32] [config]   - 16384
[2023-07-28 05:04:32] [config]   - 16384
[2023-07-28 05:04:32] [config] disp-first: 0
[2023-07-28 05:04:32] [config] disp-freq: 1000u
[2023-07-28 05:04:32] [config] disp-label-counts: true
[2023-07-28 05:04:32] [config] dropout-rnn: 0
[2023-07-28 05:04:32] [config] dropout-src: 0
[2023-07-28 05:04:32] [config] dropout-trg: 0
[2023-07-28 05:04:32] [config] dump-config: ""
[2023-07-28 05:04:32] [config] dynamic-gradient-scaling:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] early-stopping: 1000
[2023-07-28 05:04:32] [config] early-stopping-on: first
[2023-07-28 05:04:32] [config] embedding-fix-src: false
[2023-07-28 05:04:32] [config] embedding-fix-trg: false
[2023-07-28 05:04:32] [config] embedding-normalization: false
[2023-07-28 05:04:32] [config] embedding-vectors:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] enc-cell: gru
[2023-07-28 05:04:32] [config] enc-cell-depth: 1
[2023-07-28 05:04:32] [config] enc-depth: 1
[2023-07-28 05:04:32] [config] enc-type: bidirectional
[2023-07-28 05:04:32] [config] english-title-case-every: 0
[2023-07-28 05:04:32] [config] exponential-smoothing: 0
[2023-07-28 05:04:32] [config] factor-weight: 1
[2023-07-28 05:04:32] [config] factors-combine: sum
[2023-07-28 05:04:32] [config] factors-dim-emb: 0
[2023-07-28 05:04:32] [config] gradient-checkpointing: false
[2023-07-28 05:04:32] [config] gradient-norm-average-window: 100
[2023-07-28 05:04:32] [config] guided-alignment: none
[2023-07-28 05:04:32] [config] guided-alignment-cost: mse
[2023-07-28 05:04:32] [config] guided-alignment-weight: 0.1
[2023-07-28 05:04:32] [config] ignore-model-config: false
[2023-07-28 05:04:32] [config] input-types:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] interpolate-env-vars: false
[2023-07-28 05:04:32] [config] keep-best: false
[2023-07-28 05:04:32] [config] label-smoothing: 0
[2023-07-28 05:04:32] [config] layer-normalization: false
[2023-07-28 05:04:32] [config] learn-rate: 0.0001
[2023-07-28 05:04:32] [config] lemma-dependency: ""
[2023-07-28 05:04:32] [config] lemma-dim-emb: 0
[2023-07-28 05:04:32] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:04:32] [config] log-level: info
[2023-07-28 05:04:32] [config] log-time-zone: ""
[2023-07-28 05:04:32] [config] logical-epoch:
[2023-07-28 05:04:32] [config]   - 1e
[2023-07-28 05:04:32] [config]   - 0
[2023-07-28 05:04:32] [config] lr-decay: 0
[2023-07-28 05:04:32] [config] lr-decay-freq: 50000
[2023-07-28 05:04:32] [config] lr-decay-inv-sqrt:
[2023-07-28 05:04:32] [config]   - 0
[2023-07-28 05:04:32] [config] lr-decay-repeat-warmup: false
[2023-07-28 05:04:32] [config] lr-decay-reset-optimizer: false
[2023-07-28 05:04:32] [config] lr-decay-start:
[2023-07-28 05:04:32] [config]   - 10
[2023-07-28 05:04:32] [config]   - 1
[2023-07-28 05:04:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 05:04:32] [config] lr-report: false
[2023-07-28 05:04:32] [config] lr-warmup: 0
[2023-07-28 05:04:32] [config] lr-warmup-at-reload: false
[2023-07-28 05:04:32] [config] lr-warmup-cycle: false
[2023-07-28 05:04:32] [config] lr-warmup-start-rate: 0
[2023-07-28 05:04:32] [config] max-length: 50
[2023-07-28 05:04:32] [config] max-length-crop: true
[2023-07-28 05:04:32] [config] max-length-factor: 3
[2023-07-28 05:04:32] [config] maxi-batch: 100
[2023-07-28 05:04:32] [config] maxi-batch-sort: trg
[2023-07-28 05:04:32] [config] mini-batch: 64
[2023-07-28 05:04:32] [config] mini-batch-fit: true
[2023-07-28 05:04:32] [config] mini-batch-fit-step: 10
[2023-07-28 05:04:32] [config] mini-batch-round-up: true
[2023-07-28 05:04:32] [config] mini-batch-track-lr: false
[2023-07-28 05:04:32] [config] mini-batch-warmup: 0
[2023-07-28 05:04:32] [config] mini-batch-words: 0
[2023-07-28 05:04:32] [config] mini-batch-words-ref: 0
[2023-07-28 05:04:32] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:04:32] [config] multi-loss-type: sum
[2023-07-28 05:04:32] [config] n-best: false
[2023-07-28 05:04:32] [config] no-nccl: false
[2023-07-28 05:04:32] [config] no-reload: false
[2023-07-28 05:04:32] [config] no-restore-corpus: false
[2023-07-28 05:04:32] [config] normalize: 0
[2023-07-28 05:04:32] [config] normalize-gradient: false
[2023-07-28 05:04:32] [config] num-devices: 0
[2023-07-28 05:04:32] [config] optimizer: adam
[2023-07-28 05:04:32] [config] optimizer-delay: 1
[2023-07-28 05:04:32] [config] optimizer-params:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] output-omit-bias: false
[2023-07-28 05:04:32] [config] overwrite: true
[2023-07-28 05:04:32] [config] precision:
[2023-07-28 05:04:32] [config]   - float16
[2023-07-28 05:04:32] [config]   - float32
[2023-07-28 05:04:32] [config] pretrained-model: ""
[2023-07-28 05:04:32] [config] quantize-biases: false
[2023-07-28 05:04:32] [config] quantize-bits: 0
[2023-07-28 05:04:32] [config] quantize-log-based: false
[2023-07-28 05:04:32] [config] quantize-optimization-steps: 0
[2023-07-28 05:04:32] [config] quiet: false
[2023-07-28 05:04:32] [config] quiet-translation: true
[2023-07-28 05:04:32] [config] relative-paths: false
[2023-07-28 05:04:32] [config] right-left: false
[2023-07-28 05:04:32] [config] save-freq: 10000u
[2023-07-28 05:04:32] [config] seed: 1234
[2023-07-28 05:04:32] [config] sentencepiece-alphas:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] sentencepiece-max-lines: 2000000
[2023-07-28 05:04:32] [config] sentencepiece-options: ""
[2023-07-28 05:04:32] [config] sharding: global
[2023-07-28 05:04:32] [config] shuffle: data
[2023-07-28 05:04:32] [config] shuffle-in-ram: false
[2023-07-28 05:04:32] [config] sigterm: save-and-exit
[2023-07-28 05:04:32] [config] skip: false
[2023-07-28 05:04:32] [config] sqlite: ""
[2023-07-28 05:04:32] [config] sqlite-drop: false
[2023-07-28 05:04:32] [config] sync-freq: 200u
[2023-07-28 05:04:32] [config] sync-sgd: false
[2023-07-28 05:04:32] [config] tempdir: /tmp
[2023-07-28 05:04:32] [config] tied-embeddings: false
[2023-07-28 05:04:32] [config] tied-embeddings-all: true
[2023-07-28 05:04:32] [config] tied-embeddings-src: false
[2023-07-28 05:04:32] [config] train-embedder-rank:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] train-sets:
[2023-07-28 05:04:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 05:04:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 05:04:32] [config] transformer-aan-activation: swish
[2023-07-28 05:04:32] [config] transformer-aan-depth: 2
[2023-07-28 05:04:32] [config] transformer-aan-nogate: false
[2023-07-28 05:04:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 05:04:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 05:04:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 05:04:32] [config] transformer-depth-scaling: false
[2023-07-28 05:04:32] [config] transformer-dim-aan: 2048
[2023-07-28 05:04:32] [config] transformer-dim-ffn: 2048
[2023-07-28 05:04:32] [config] transformer-dropout: 0
[2023-07-28 05:04:32] [config] transformer-dropout-attention: 0
[2023-07-28 05:04:32] [config] transformer-dropout-ffn: 0
[2023-07-28 05:04:32] [config] transformer-ffn-activation: swish
[2023-07-28 05:04:32] [config] transformer-ffn-depth: 2
[2023-07-28 05:04:32] [config] transformer-guided-alignment-layer: last
[2023-07-28 05:04:32] [config] transformer-heads: 8
[2023-07-28 05:04:32] [config] transformer-no-projection: false
[2023-07-28 05:04:32] [config] transformer-pool: false
[2023-07-28 05:04:32] [config] transformer-postprocess: dan
[2023-07-28 05:04:32] [config] transformer-postprocess-emb: d
[2023-07-28 05:04:32] [config] transformer-postprocess-top: ""
[2023-07-28 05:04:32] [config] transformer-preprocess: ""
[2023-07-28 05:04:32] [config] transformer-tied-layers:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] transformer-train-position-embeddings: false
[2023-07-28 05:04:32] [config] tsv: false
[2023-07-28 05:04:32] [config] tsv-fields: 0
[2023-07-28 05:04:32] [config] type: s2s
[2023-07-28 05:04:32] [config] ulr: false
[2023-07-28 05:04:32] [config] ulr-dim-emb: 0
[2023-07-28 05:04:32] [config] ulr-dropout: 0
[2023-07-28 05:04:32] [config] ulr-keys-vectors: ""
[2023-07-28 05:04:32] [config] ulr-query-vectors: ""
[2023-07-28 05:04:32] [config] ulr-softmax-temperature: 1
[2023-07-28 05:04:32] [config] ulr-trainable-transformation: false
[2023-07-28 05:04:32] [config] unlikelihood-loss: false
[2023-07-28 05:04:32] [config] valid-freq: 50000000
[2023-07-28 05:04:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:04:32] [config] valid-max-length: 1000
[2023-07-28 05:04:32] [config] valid-metrics:
[2023-07-28 05:04:32] [config]   - translation
[2023-07-28 05:04:32] [config] valid-mini-batch: 32
[2023-07-28 05:04:32] [config] valid-reset-stalled: false
[2023-07-28 05:04:32] [config] valid-script-args:
[2023-07-28 05:04:32] [config]   []
[2023-07-28 05:04:32] [config] valid-script-path: ""
[2023-07-28 05:04:32] [config] valid-sets:
[2023-07-28 05:04:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 05:04:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 05:04:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 05:04:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:04:32] [config] vocabs:
[2023-07-28 05:04:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:04:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:04:32] [config] word-penalty: 0
[2023-07-28 05:04:32] [config] word-scores: false
[2023-07-28 05:04:32] [config] workspace: 5500
[2023-07-28 05:04:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:04:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:04:32] [training] Using single-device training
[2023-07-28 05:04:32] Synced seed 1234
[2023-07-28 05:04:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:04:32] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 05:04:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:04:32] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 05:04:32] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 05:04:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:04:32] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 05:04:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:04:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:04:33] [comm] Using global sharding
[2023-07-28 05:04:33] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:04:33] [training] Using 1 GPUs
[2023-07-28 05:04:33] [logits] Applying loss function for 1 factor(s)
[2023-07-28 05:04:33] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:04:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 05:04:33] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:09:04] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 05:09:05] [valid] No post-processing script given for validating translator
[2023-07-28 05:09:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:09:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:09:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:09:05] [comm] Using global sharding
[2023-07-28 05:09:05] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:09:05] [training] Using 1 GPUs
[2023-07-28 05:09:05] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:09:06] Allocating memory for general optimizer shards
[2023-07-28 05:09:06] [memory] Reserving 322 MB, device gpu0
[2023-07-28 05:09:06] Loading Adam parameters
[2023-07-28 05:09:06] [memory] Reserving 322 MB, device gpu0
[2023-07-28 05:09:06] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:09:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 05:09:07] [data] Restoring the corpus state to epoch 171, batch 4637
[2023-07-28 05:09:07] [data] Shuffling data
[2023-07-28 05:09:07] [data] Done reading 20,192 sentences
[2023-07-28 05:09:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:09:07] Training started
[2023-07-28 05:09:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 05:09:07] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:09:11] Parameter type float16, optimization type float32, casting types true
[2023-07-28 05:10:19] Seen 20,192 samples
[2023-07-28 05:10:19] Starting data epoch 172 in logical epoch 172
[2023-07-28 05:10:19] [data] Shuffling data
[2023-07-28 05:10:19] [data] Done reading 20,192 sentences
[2023-07-28 05:10:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:11:32] Seen 20,192 samples
[2023-07-28 05:11:32] Starting data epoch 173 in logical epoch 173
[2023-07-28 05:11:32] [data] Shuffling data
[2023-07-28 05:11:33] [data] Done reading 20,192 sentences
[2023-07-28 05:11:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:12:47] Seen 20,192 samples
[2023-07-28 05:12:47] Starting data epoch 174 in logical epoch 174
[2023-07-28 05:12:47] [data] Shuffling data
[2023-07-28 05:12:47] [data] Done reading 20,192 sentences
[2023-07-28 05:12:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:14:01] Seen 20,192 samples
[2023-07-28 05:14:01] Starting data epoch 175 in logical epoch 175
[2023-07-28 05:14:01] [data] Shuffling data
[2023-07-28 05:14:01] [data] Done reading 20,192 sentences
[2023-07-28 05:14:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:15:17] Seen 20,192 samples
[2023-07-28 05:15:17] Starting data epoch 176 in logical epoch 176
[2023-07-28 05:15:17] [data] Shuffling data
[2023-07-28 05:15:17] [data] Done reading 20,192 sentences
[2023-07-28 05:15:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:16:32] Seen 20,192 samples
[2023-07-28 05:16:32] Starting data epoch 177 in logical epoch 177
[2023-07-28 05:16:32] [data] Shuffling data
[2023-07-28 05:16:32] [data] Done reading 20,192 sentences
[2023-07-28 05:16:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:17:46] Seen 20,192 samples
[2023-07-28 05:17:46] Starting data epoch 178 in logical epoch 178
[2023-07-28 05:17:46] [data] Shuffling data
[2023-07-28 05:17:46] [data] Done reading 20,192 sentences
[2023-07-28 05:17:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:19:02] Seen 20,192 samples
[2023-07-28 05:19:02] Starting data epoch 179 in logical epoch 179
[2023-07-28 05:19:02] [data] Shuffling data
[2023-07-28 05:19:02] [data] Done reading 20,192 sentences
[2023-07-28 05:19:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:20:18] Seen 20,192 samples
[2023-07-28 05:20:18] Starting data epoch 180 in logical epoch 180
[2023-07-28 05:20:18] [data] Shuffling data
[2023-07-28 05:20:18] [data] Done reading 20,192 sentences
[2023-07-28 05:20:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:21:33] Seen 20,192 samples
[2023-07-28 05:21:33] Starting data epoch 181 in logical epoch 181
[2023-07-28 05:21:33] Training finished
[2023-07-28 05:22:13] [valid] Ep. 181 : Up. 4911 : translation : 0 : new best
[2023-07-28 05:22:13] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:22:15] Saving Adam parameters
[2023-07-28 05:22:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 05:22:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:22:24] [marian] Running on node05.datos.cluster.uy as process 39129 with command line:
[2023-07-28 05:22:24] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 05:22:24] [config] after: 0e
[2023-07-28 05:22:24] [config] after-batches: 0
[2023-07-28 05:22:24] [config] after-epochs: 190
[2023-07-28 05:22:24] [config] all-caps-every: 0
[2023-07-28 05:22:24] [config] allow-unk: false
[2023-07-28 05:22:24] [config] authors: false
[2023-07-28 05:22:24] [config] beam-size: 12
[2023-07-28 05:22:24] [config] bert-class-symbol: "[CLS]"
[2023-07-28 05:22:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 05:22:24] [config] bert-masking-fraction: 0.15
[2023-07-28 05:22:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 05:22:24] [config] bert-train-type-embeddings: true
[2023-07-28 05:22:24] [config] bert-type-vocab-size: 2
[2023-07-28 05:22:24] [config] build-info: ""
[2023-07-28 05:22:24] [config] check-gradient-nan: false
[2023-07-28 05:22:24] [config] check-nan: false
[2023-07-28 05:22:24] [config] cite: false
[2023-07-28 05:22:24] [config] clip-norm: 1
[2023-07-28 05:22:24] [config] cost-scaling:
[2023-07-28 05:22:24] [config]   - 256.f
[2023-07-28 05:22:24] [config]   - 1000
[2023-07-28 05:22:24] [config]   - 2.f
[2023-07-28 05:22:24] [config]   - 256.f
[2023-07-28 05:22:24] [config] cost-type: ce-sum
[2023-07-28 05:22:24] [config] cpu-threads: 0
[2023-07-28 05:22:24] [config] data-threads: 8
[2023-07-28 05:22:24] [config] data-weighting: ""
[2023-07-28 05:22:24] [config] data-weighting-type: sentence
[2023-07-28 05:22:24] [config] dec-cell: gru
[2023-07-28 05:22:24] [config] dec-cell-base-depth: 2
[2023-07-28 05:22:24] [config] dec-cell-high-depth: 1
[2023-07-28 05:22:24] [config] dec-depth: 1
[2023-07-28 05:22:24] [config] devices:
[2023-07-28 05:22:24] [config]   - 0
[2023-07-28 05:22:24] [config] dim-emb: 512
[2023-07-28 05:22:24] [config] dim-rnn: 1024
[2023-07-28 05:22:24] [config] dim-vocabs:
[2023-07-28 05:22:24] [config]   - 16384
[2023-07-28 05:22:24] [config]   - 16384
[2023-07-28 05:22:24] [config] disp-first: 0
[2023-07-28 05:22:24] [config] disp-freq: 1000u
[2023-07-28 05:22:24] [config] disp-label-counts: true
[2023-07-28 05:22:24] [config] dropout-rnn: 0
[2023-07-28 05:22:24] [config] dropout-src: 0
[2023-07-28 05:22:24] [config] dropout-trg: 0
[2023-07-28 05:22:24] [config] dump-config: ""
[2023-07-28 05:22:24] [config] dynamic-gradient-scaling:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] early-stopping: 1000
[2023-07-28 05:22:24] [config] early-stopping-on: first
[2023-07-28 05:22:24] [config] embedding-fix-src: false
[2023-07-28 05:22:24] [config] embedding-fix-trg: false
[2023-07-28 05:22:24] [config] embedding-normalization: false
[2023-07-28 05:22:24] [config] embedding-vectors:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] enc-cell: gru
[2023-07-28 05:22:24] [config] enc-cell-depth: 1
[2023-07-28 05:22:24] [config] enc-depth: 1
[2023-07-28 05:22:24] [config] enc-type: bidirectional
[2023-07-28 05:22:24] [config] english-title-case-every: 0
[2023-07-28 05:22:24] [config] exponential-smoothing: 0
[2023-07-28 05:22:24] [config] factor-weight: 1
[2023-07-28 05:22:24] [config] factors-combine: sum
[2023-07-28 05:22:24] [config] factors-dim-emb: 0
[2023-07-28 05:22:24] [config] gradient-checkpointing: false
[2023-07-28 05:22:24] [config] gradient-norm-average-window: 100
[2023-07-28 05:22:24] [config] guided-alignment: none
[2023-07-28 05:22:24] [config] guided-alignment-cost: mse
[2023-07-28 05:22:24] [config] guided-alignment-weight: 0.1
[2023-07-28 05:22:24] [config] ignore-model-config: false
[2023-07-28 05:22:24] [config] input-types:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] interpolate-env-vars: false
[2023-07-28 05:22:24] [config] keep-best: false
[2023-07-28 05:22:24] [config] label-smoothing: 0
[2023-07-28 05:22:24] [config] layer-normalization: false
[2023-07-28 05:22:24] [config] learn-rate: 0.0001
[2023-07-28 05:22:24] [config] lemma-dependency: ""
[2023-07-28 05:22:24] [config] lemma-dim-emb: 0
[2023-07-28 05:22:24] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:22:24] [config] log-level: info
[2023-07-28 05:22:24] [config] log-time-zone: ""
[2023-07-28 05:22:24] [config] logical-epoch:
[2023-07-28 05:22:24] [config]   - 1e
[2023-07-28 05:22:24] [config]   - 0
[2023-07-28 05:22:24] [config] lr-decay: 0
[2023-07-28 05:22:24] [config] lr-decay-freq: 50000
[2023-07-28 05:22:24] [config] lr-decay-inv-sqrt:
[2023-07-28 05:22:24] [config]   - 0
[2023-07-28 05:22:24] [config] lr-decay-repeat-warmup: false
[2023-07-28 05:22:24] [config] lr-decay-reset-optimizer: false
[2023-07-28 05:22:24] [config] lr-decay-start:
[2023-07-28 05:22:24] [config]   - 10
[2023-07-28 05:22:24] [config]   - 1
[2023-07-28 05:22:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 05:22:24] [config] lr-report: false
[2023-07-28 05:22:24] [config] lr-warmup: 0
[2023-07-28 05:22:24] [config] lr-warmup-at-reload: false
[2023-07-28 05:22:24] [config] lr-warmup-cycle: false
[2023-07-28 05:22:24] [config] lr-warmup-start-rate: 0
[2023-07-28 05:22:24] [config] max-length: 50
[2023-07-28 05:22:24] [config] max-length-crop: true
[2023-07-28 05:22:24] [config] max-length-factor: 3
[2023-07-28 05:22:24] [config] maxi-batch: 100
[2023-07-28 05:22:24] [config] maxi-batch-sort: trg
[2023-07-28 05:22:24] [config] mini-batch: 64
[2023-07-28 05:22:24] [config] mini-batch-fit: true
[2023-07-28 05:22:24] [config] mini-batch-fit-step: 10
[2023-07-28 05:22:24] [config] mini-batch-round-up: true
[2023-07-28 05:22:24] [config] mini-batch-track-lr: false
[2023-07-28 05:22:24] [config] mini-batch-warmup: 0
[2023-07-28 05:22:24] [config] mini-batch-words: 0
[2023-07-28 05:22:24] [config] mini-batch-words-ref: 0
[2023-07-28 05:22:24] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:22:24] [config] multi-loss-type: sum
[2023-07-28 05:22:24] [config] n-best: false
[2023-07-28 05:22:24] [config] no-nccl: false
[2023-07-28 05:22:24] [config] no-reload: false
[2023-07-28 05:22:24] [config] no-restore-corpus: false
[2023-07-28 05:22:24] [config] normalize: 0
[2023-07-28 05:22:24] [config] normalize-gradient: false
[2023-07-28 05:22:24] [config] num-devices: 0
[2023-07-28 05:22:24] [config] optimizer: adam
[2023-07-28 05:22:24] [config] optimizer-delay: 1
[2023-07-28 05:22:24] [config] optimizer-params:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] output-omit-bias: false
[2023-07-28 05:22:24] [config] overwrite: true
[2023-07-28 05:22:24] [config] precision:
[2023-07-28 05:22:24] [config]   - float16
[2023-07-28 05:22:24] [config]   - float32
[2023-07-28 05:22:24] [config] pretrained-model: ""
[2023-07-28 05:22:24] [config] quantize-biases: false
[2023-07-28 05:22:24] [config] quantize-bits: 0
[2023-07-28 05:22:24] [config] quantize-log-based: false
[2023-07-28 05:22:24] [config] quantize-optimization-steps: 0
[2023-07-28 05:22:24] [config] quiet: false
[2023-07-28 05:22:24] [config] quiet-translation: true
[2023-07-28 05:22:24] [config] relative-paths: false
[2023-07-28 05:22:24] [config] right-left: false
[2023-07-28 05:22:24] [config] save-freq: 10000u
[2023-07-28 05:22:24] [config] seed: 1234
[2023-07-28 05:22:24] [config] sentencepiece-alphas:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] sentencepiece-max-lines: 2000000
[2023-07-28 05:22:24] [config] sentencepiece-options: ""
[2023-07-28 05:22:24] [config] sharding: global
[2023-07-28 05:22:24] [config] shuffle: data
[2023-07-28 05:22:24] [config] shuffle-in-ram: false
[2023-07-28 05:22:24] [config] sigterm: save-and-exit
[2023-07-28 05:22:24] [config] skip: false
[2023-07-28 05:22:24] [config] sqlite: ""
[2023-07-28 05:22:24] [config] sqlite-drop: false
[2023-07-28 05:22:24] [config] sync-freq: 200u
[2023-07-28 05:22:24] [config] sync-sgd: false
[2023-07-28 05:22:24] [config] tempdir: /tmp
[2023-07-28 05:22:24] [config] tied-embeddings: false
[2023-07-28 05:22:24] [config] tied-embeddings-all: true
[2023-07-28 05:22:24] [config] tied-embeddings-src: false
[2023-07-28 05:22:24] [config] train-embedder-rank:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] train-sets:
[2023-07-28 05:22:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 05:22:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 05:22:24] [config] transformer-aan-activation: swish
[2023-07-28 05:22:24] [config] transformer-aan-depth: 2
[2023-07-28 05:22:24] [config] transformer-aan-nogate: false
[2023-07-28 05:22:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 05:22:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 05:22:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 05:22:24] [config] transformer-depth-scaling: false
[2023-07-28 05:22:24] [config] transformer-dim-aan: 2048
[2023-07-28 05:22:24] [config] transformer-dim-ffn: 2048
[2023-07-28 05:22:24] [config] transformer-dropout: 0
[2023-07-28 05:22:24] [config] transformer-dropout-attention: 0
[2023-07-28 05:22:24] [config] transformer-dropout-ffn: 0
[2023-07-28 05:22:24] [config] transformer-ffn-activation: swish
[2023-07-28 05:22:24] [config] transformer-ffn-depth: 2
[2023-07-28 05:22:24] [config] transformer-guided-alignment-layer: last
[2023-07-28 05:22:24] [config] transformer-heads: 8
[2023-07-28 05:22:24] [config] transformer-no-projection: false
[2023-07-28 05:22:24] [config] transformer-pool: false
[2023-07-28 05:22:24] [config] transformer-postprocess: dan
[2023-07-28 05:22:24] [config] transformer-postprocess-emb: d
[2023-07-28 05:22:24] [config] transformer-postprocess-top: ""
[2023-07-28 05:22:24] [config] transformer-preprocess: ""
[2023-07-28 05:22:24] [config] transformer-tied-layers:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] transformer-train-position-embeddings: false
[2023-07-28 05:22:24] [config] tsv: false
[2023-07-28 05:22:24] [config] tsv-fields: 0
[2023-07-28 05:22:24] [config] type: s2s
[2023-07-28 05:22:24] [config] ulr: false
[2023-07-28 05:22:24] [config] ulr-dim-emb: 0
[2023-07-28 05:22:24] [config] ulr-dropout: 0
[2023-07-28 05:22:24] [config] ulr-keys-vectors: ""
[2023-07-28 05:22:24] [config] ulr-query-vectors: ""
[2023-07-28 05:22:24] [config] ulr-softmax-temperature: 1
[2023-07-28 05:22:24] [config] ulr-trainable-transformation: false
[2023-07-28 05:22:24] [config] unlikelihood-loss: false
[2023-07-28 05:22:24] [config] valid-freq: 50000000
[2023-07-28 05:22:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:22:24] [config] valid-max-length: 1000
[2023-07-28 05:22:24] [config] valid-metrics:
[2023-07-28 05:22:24] [config]   - translation
[2023-07-28 05:22:24] [config] valid-mini-batch: 32
[2023-07-28 05:22:24] [config] valid-reset-stalled: false
[2023-07-28 05:22:24] [config] valid-script-args:
[2023-07-28 05:22:24] [config]   []
[2023-07-28 05:22:24] [config] valid-script-path: ""
[2023-07-28 05:22:24] [config] valid-sets:
[2023-07-28 05:22:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 05:22:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 05:22:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 05:22:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:22:24] [config] vocabs:
[2023-07-28 05:22:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:22:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:22:24] [config] word-penalty: 0
[2023-07-28 05:22:24] [config] word-scores: false
[2023-07-28 05:22:24] [config] workspace: 5500
[2023-07-28 05:22:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:22:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:22:24] [training] Using single-device training
[2023-07-28 05:22:24] Synced seed 1234
[2023-07-28 05:22:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:22:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 05:22:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:22:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 05:22:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 05:22:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:22:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 05:22:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:22:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:22:25] [comm] Using global sharding
[2023-07-28 05:22:25] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:22:25] [training] Using 1 GPUs
[2023-07-28 05:22:25] [logits] Applying loss function for 1 factor(s)
[2023-07-28 05:22:25] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:22:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 05:22:25] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:26:53] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 05:26:54] [valid] No post-processing script given for validating translator
[2023-07-28 05:26:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:26:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:26:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:26:54] [comm] Using global sharding
[2023-07-28 05:26:54] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:26:54] [training] Using 1 GPUs
[2023-07-28 05:26:54] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:26:55] Allocating memory for general optimizer shards
[2023-07-28 05:26:55] [memory] Reserving 322 MB, device gpu0
[2023-07-28 05:26:55] Loading Adam parameters
[2023-07-28 05:26:55] [memory] Reserving 322 MB, device gpu0
[2023-07-28 05:26:55] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:26:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 05:26:55] [data] Restoring the corpus state to epoch 181, batch 4911
[2023-07-28 05:26:55] [data] Shuffling data
[2023-07-28 05:26:56] [data] Done reading 20,192 sentences
[2023-07-28 05:26:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:26:56] Training started
[2023-07-28 05:26:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 05:26:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:26:56] Parameter type float16, optimization type float32, casting types true
[2023-07-28 05:28:06] Seen 20,192 samples
[2023-07-28 05:28:06] Starting data epoch 182 in logical epoch 182
[2023-07-28 05:28:06] [data] Shuffling data
[2023-07-28 05:28:06] [data] Done reading 20,192 sentences
[2023-07-28 05:28:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:29:19] Seen 20,192 samples
[2023-07-28 05:29:19] Starting data epoch 183 in logical epoch 183
[2023-07-28 05:29:19] [data] Shuffling data
[2023-07-28 05:29:19] [data] Done reading 20,192 sentences
[2023-07-28 05:29:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:30:32] Seen 20,192 samples
[2023-07-28 05:30:32] Starting data epoch 184 in logical epoch 184
[2023-07-28 05:30:32] [data] Shuffling data
[2023-07-28 05:30:32] [data] Done reading 20,192 sentences
[2023-07-28 05:30:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:30:49] Ep. 184 : Up. 5000 : Sen. 4,958 : Cost 3.62422204 * 20,748,106 @ 36,050 after 103,905,024 : Time 235.07s : 88263.55 words/s : gNorm 1.4316
[2023-07-28 05:31:47] Seen 20,192 samples
[2023-07-28 05:31:47] Starting data epoch 185 in logical epoch 185
[2023-07-28 05:31:47] [data] Shuffling data
[2023-07-28 05:31:47] [data] Done reading 20,192 sentences
[2023-07-28 05:31:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:33:03] Seen 20,192 samples
[2023-07-28 05:33:03] Starting data epoch 186 in logical epoch 186
[2023-07-28 05:33:03] [data] Shuffling data
[2023-07-28 05:33:03] [data] Done reading 20,192 sentences
[2023-07-28 05:33:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:34:18] Seen 20,192 samples
[2023-07-28 05:34:18] Starting data epoch 187 in logical epoch 187
[2023-07-28 05:34:18] [data] Shuffling data
[2023-07-28 05:34:18] [data] Done reading 20,192 sentences
[2023-07-28 05:34:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:35:35] Seen 20,192 samples
[2023-07-28 05:35:35] Starting data epoch 188 in logical epoch 188
[2023-07-28 05:35:35] [data] Shuffling data
[2023-07-28 05:35:35] [data] Done reading 20,192 sentences
[2023-07-28 05:35:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:36:51] Seen 20,192 samples
[2023-07-28 05:36:51] Starting data epoch 189 in logical epoch 189
[2023-07-28 05:36:51] [data] Shuffling data
[2023-07-28 05:36:51] [data] Done reading 20,192 sentences
[2023-07-28 05:36:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:38:07] Seen 20,192 samples
[2023-07-28 05:38:07] Starting data epoch 190 in logical epoch 190
[2023-07-28 05:38:07] [data] Shuffling data
[2023-07-28 05:38:07] [data] Done reading 20,192 sentences
[2023-07-28 05:38:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:39:23] Seen 20,192 samples
[2023-07-28 05:39:23] Starting data epoch 191 in logical epoch 191
[2023-07-28 05:39:23] Training finished
[2023-07-28 05:40:04] [valid] Ep. 191 : Up. 5188 : translation : 0 : new best
[2023-07-28 05:40:04] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:40:06] Saving Adam parameters
[2023-07-28 05:40:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 05:40:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:40:14] [marian] Running on node05.datos.cluster.uy as process 40265 with command line:
[2023-07-28 05:40:14] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 05:40:14] [config] after: 0e
[2023-07-28 05:40:14] [config] after-batches: 0
[2023-07-28 05:40:14] [config] after-epochs: 200
[2023-07-28 05:40:14] [config] all-caps-every: 0
[2023-07-28 05:40:14] [config] allow-unk: false
[2023-07-28 05:40:14] [config] authors: false
[2023-07-28 05:40:14] [config] beam-size: 12
[2023-07-28 05:40:14] [config] bert-class-symbol: "[CLS]"
[2023-07-28 05:40:14] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 05:40:14] [config] bert-masking-fraction: 0.15
[2023-07-28 05:40:14] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 05:40:14] [config] bert-train-type-embeddings: true
[2023-07-28 05:40:14] [config] bert-type-vocab-size: 2
[2023-07-28 05:40:14] [config] build-info: ""
[2023-07-28 05:40:14] [config] check-gradient-nan: false
[2023-07-28 05:40:14] [config] check-nan: false
[2023-07-28 05:40:14] [config] cite: false
[2023-07-28 05:40:14] [config] clip-norm: 1
[2023-07-28 05:40:14] [config] cost-scaling:
[2023-07-28 05:40:14] [config]   - 256.f
[2023-07-28 05:40:14] [config]   - 1000
[2023-07-28 05:40:14] [config]   - 2.f
[2023-07-28 05:40:14] [config]   - 256.f
[2023-07-28 05:40:14] [config] cost-type: ce-sum
[2023-07-28 05:40:14] [config] cpu-threads: 0
[2023-07-28 05:40:14] [config] data-threads: 8
[2023-07-28 05:40:14] [config] data-weighting: ""
[2023-07-28 05:40:14] [config] data-weighting-type: sentence
[2023-07-28 05:40:14] [config] dec-cell: gru
[2023-07-28 05:40:14] [config] dec-cell-base-depth: 2
[2023-07-28 05:40:14] [config] dec-cell-high-depth: 1
[2023-07-28 05:40:14] [config] dec-depth: 1
[2023-07-28 05:40:14] [config] devices:
[2023-07-28 05:40:14] [config]   - 0
[2023-07-28 05:40:14] [config] dim-emb: 512
[2023-07-28 05:40:14] [config] dim-rnn: 1024
[2023-07-28 05:40:14] [config] dim-vocabs:
[2023-07-28 05:40:14] [config]   - 16384
[2023-07-28 05:40:14] [config]   - 16384
[2023-07-28 05:40:14] [config] disp-first: 0
[2023-07-28 05:40:14] [config] disp-freq: 1000u
[2023-07-28 05:40:14] [config] disp-label-counts: true
[2023-07-28 05:40:14] [config] dropout-rnn: 0
[2023-07-28 05:40:14] [config] dropout-src: 0
[2023-07-28 05:40:14] [config] dropout-trg: 0
[2023-07-28 05:40:14] [config] dump-config: ""
[2023-07-28 05:40:14] [config] dynamic-gradient-scaling:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] early-stopping: 1000
[2023-07-28 05:40:14] [config] early-stopping-on: first
[2023-07-28 05:40:14] [config] embedding-fix-src: false
[2023-07-28 05:40:14] [config] embedding-fix-trg: false
[2023-07-28 05:40:14] [config] embedding-normalization: false
[2023-07-28 05:40:14] [config] embedding-vectors:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] enc-cell: gru
[2023-07-28 05:40:14] [config] enc-cell-depth: 1
[2023-07-28 05:40:14] [config] enc-depth: 1
[2023-07-28 05:40:14] [config] enc-type: bidirectional
[2023-07-28 05:40:14] [config] english-title-case-every: 0
[2023-07-28 05:40:14] [config] exponential-smoothing: 0
[2023-07-28 05:40:14] [config] factor-weight: 1
[2023-07-28 05:40:14] [config] factors-combine: sum
[2023-07-28 05:40:14] [config] factors-dim-emb: 0
[2023-07-28 05:40:14] [config] gradient-checkpointing: false
[2023-07-28 05:40:14] [config] gradient-norm-average-window: 100
[2023-07-28 05:40:14] [config] guided-alignment: none
[2023-07-28 05:40:14] [config] guided-alignment-cost: mse
[2023-07-28 05:40:14] [config] guided-alignment-weight: 0.1
[2023-07-28 05:40:14] [config] ignore-model-config: false
[2023-07-28 05:40:14] [config] input-types:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] interpolate-env-vars: false
[2023-07-28 05:40:14] [config] keep-best: false
[2023-07-28 05:40:14] [config] label-smoothing: 0
[2023-07-28 05:40:14] [config] layer-normalization: false
[2023-07-28 05:40:14] [config] learn-rate: 0.0001
[2023-07-28 05:40:14] [config] lemma-dependency: ""
[2023-07-28 05:40:14] [config] lemma-dim-emb: 0
[2023-07-28 05:40:14] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:40:14] [config] log-level: info
[2023-07-28 05:40:14] [config] log-time-zone: ""
[2023-07-28 05:40:14] [config] logical-epoch:
[2023-07-28 05:40:14] [config]   - 1e
[2023-07-28 05:40:14] [config]   - 0
[2023-07-28 05:40:14] [config] lr-decay: 0
[2023-07-28 05:40:14] [config] lr-decay-freq: 50000
[2023-07-28 05:40:14] [config] lr-decay-inv-sqrt:
[2023-07-28 05:40:14] [config]   - 0
[2023-07-28 05:40:14] [config] lr-decay-repeat-warmup: false
[2023-07-28 05:40:14] [config] lr-decay-reset-optimizer: false
[2023-07-28 05:40:14] [config] lr-decay-start:
[2023-07-28 05:40:14] [config]   - 10
[2023-07-28 05:40:14] [config]   - 1
[2023-07-28 05:40:14] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 05:40:14] [config] lr-report: false
[2023-07-28 05:40:14] [config] lr-warmup: 0
[2023-07-28 05:40:14] [config] lr-warmup-at-reload: false
[2023-07-28 05:40:14] [config] lr-warmup-cycle: false
[2023-07-28 05:40:14] [config] lr-warmup-start-rate: 0
[2023-07-28 05:40:14] [config] max-length: 50
[2023-07-28 05:40:14] [config] max-length-crop: true
[2023-07-28 05:40:14] [config] max-length-factor: 3
[2023-07-28 05:40:14] [config] maxi-batch: 100
[2023-07-28 05:40:14] [config] maxi-batch-sort: trg
[2023-07-28 05:40:14] [config] mini-batch: 64
[2023-07-28 05:40:14] [config] mini-batch-fit: true
[2023-07-28 05:40:14] [config] mini-batch-fit-step: 10
[2023-07-28 05:40:14] [config] mini-batch-round-up: true
[2023-07-28 05:40:14] [config] mini-batch-track-lr: false
[2023-07-28 05:40:14] [config] mini-batch-warmup: 0
[2023-07-28 05:40:14] [config] mini-batch-words: 0
[2023-07-28 05:40:14] [config] mini-batch-words-ref: 0
[2023-07-28 05:40:14] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:40:14] [config] multi-loss-type: sum
[2023-07-28 05:40:14] [config] n-best: false
[2023-07-28 05:40:14] [config] no-nccl: false
[2023-07-28 05:40:14] [config] no-reload: false
[2023-07-28 05:40:14] [config] no-restore-corpus: false
[2023-07-28 05:40:14] [config] normalize: 0
[2023-07-28 05:40:14] [config] normalize-gradient: false
[2023-07-28 05:40:14] [config] num-devices: 0
[2023-07-28 05:40:14] [config] optimizer: adam
[2023-07-28 05:40:14] [config] optimizer-delay: 1
[2023-07-28 05:40:14] [config] optimizer-params:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] output-omit-bias: false
[2023-07-28 05:40:14] [config] overwrite: true
[2023-07-28 05:40:14] [config] precision:
[2023-07-28 05:40:14] [config]   - float16
[2023-07-28 05:40:14] [config]   - float32
[2023-07-28 05:40:14] [config] pretrained-model: ""
[2023-07-28 05:40:14] [config] quantize-biases: false
[2023-07-28 05:40:14] [config] quantize-bits: 0
[2023-07-28 05:40:14] [config] quantize-log-based: false
[2023-07-28 05:40:14] [config] quantize-optimization-steps: 0
[2023-07-28 05:40:14] [config] quiet: false
[2023-07-28 05:40:14] [config] quiet-translation: true
[2023-07-28 05:40:14] [config] relative-paths: false
[2023-07-28 05:40:14] [config] right-left: false
[2023-07-28 05:40:14] [config] save-freq: 10000u
[2023-07-28 05:40:14] [config] seed: 1234
[2023-07-28 05:40:14] [config] sentencepiece-alphas:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] sentencepiece-max-lines: 2000000
[2023-07-28 05:40:14] [config] sentencepiece-options: ""
[2023-07-28 05:40:14] [config] sharding: global
[2023-07-28 05:40:14] [config] shuffle: data
[2023-07-28 05:40:14] [config] shuffle-in-ram: false
[2023-07-28 05:40:14] [config] sigterm: save-and-exit
[2023-07-28 05:40:14] [config] skip: false
[2023-07-28 05:40:14] [config] sqlite: ""
[2023-07-28 05:40:14] [config] sqlite-drop: false
[2023-07-28 05:40:14] [config] sync-freq: 200u
[2023-07-28 05:40:14] [config] sync-sgd: false
[2023-07-28 05:40:14] [config] tempdir: /tmp
[2023-07-28 05:40:14] [config] tied-embeddings: false
[2023-07-28 05:40:14] [config] tied-embeddings-all: true
[2023-07-28 05:40:14] [config] tied-embeddings-src: false
[2023-07-28 05:40:14] [config] train-embedder-rank:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] train-sets:
[2023-07-28 05:40:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 05:40:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 05:40:14] [config] transformer-aan-activation: swish
[2023-07-28 05:40:14] [config] transformer-aan-depth: 2
[2023-07-28 05:40:14] [config] transformer-aan-nogate: false
[2023-07-28 05:40:14] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 05:40:14] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 05:40:14] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 05:40:14] [config] transformer-depth-scaling: false
[2023-07-28 05:40:14] [config] transformer-dim-aan: 2048
[2023-07-28 05:40:14] [config] transformer-dim-ffn: 2048
[2023-07-28 05:40:14] [config] transformer-dropout: 0
[2023-07-28 05:40:14] [config] transformer-dropout-attention: 0
[2023-07-28 05:40:14] [config] transformer-dropout-ffn: 0
[2023-07-28 05:40:14] [config] transformer-ffn-activation: swish
[2023-07-28 05:40:14] [config] transformer-ffn-depth: 2
[2023-07-28 05:40:14] [config] transformer-guided-alignment-layer: last
[2023-07-28 05:40:14] [config] transformer-heads: 8
[2023-07-28 05:40:14] [config] transformer-no-projection: false
[2023-07-28 05:40:14] [config] transformer-pool: false
[2023-07-28 05:40:14] [config] transformer-postprocess: dan
[2023-07-28 05:40:14] [config] transformer-postprocess-emb: d
[2023-07-28 05:40:14] [config] transformer-postprocess-top: ""
[2023-07-28 05:40:14] [config] transformer-preprocess: ""
[2023-07-28 05:40:14] [config] transformer-tied-layers:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] transformer-train-position-embeddings: false
[2023-07-28 05:40:14] [config] tsv: false
[2023-07-28 05:40:14] [config] tsv-fields: 0
[2023-07-28 05:40:14] [config] type: s2s
[2023-07-28 05:40:14] [config] ulr: false
[2023-07-28 05:40:14] [config] ulr-dim-emb: 0
[2023-07-28 05:40:14] [config] ulr-dropout: 0
[2023-07-28 05:40:14] [config] ulr-keys-vectors: ""
[2023-07-28 05:40:14] [config] ulr-query-vectors: ""
[2023-07-28 05:40:14] [config] ulr-softmax-temperature: 1
[2023-07-28 05:40:14] [config] ulr-trainable-transformation: false
[2023-07-28 05:40:14] [config] unlikelihood-loss: false
[2023-07-28 05:40:14] [config] valid-freq: 50000000
[2023-07-28 05:40:14] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:40:14] [config] valid-max-length: 1000
[2023-07-28 05:40:14] [config] valid-metrics:
[2023-07-28 05:40:14] [config]   - translation
[2023-07-28 05:40:14] [config] valid-mini-batch: 32
[2023-07-28 05:40:14] [config] valid-reset-stalled: false
[2023-07-28 05:40:14] [config] valid-script-args:
[2023-07-28 05:40:14] [config]   []
[2023-07-28 05:40:14] [config] valid-script-path: ""
[2023-07-28 05:40:14] [config] valid-sets:
[2023-07-28 05:40:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 05:40:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 05:40:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 05:40:14] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:40:14] [config] vocabs:
[2023-07-28 05:40:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:40:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:40:14] [config] word-penalty: 0
[2023-07-28 05:40:14] [config] word-scores: false
[2023-07-28 05:40:14] [config] workspace: 5500
[2023-07-28 05:40:14] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:40:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:40:14] [training] Using single-device training
[2023-07-28 05:40:14] Synced seed 1234
[2023-07-28 05:40:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:40:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 05:40:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:40:14] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 05:40:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 05:40:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:40:14] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 05:40:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:40:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:40:15] [comm] Using global sharding
[2023-07-28 05:40:15] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:40:15] [training] Using 1 GPUs
[2023-07-28 05:40:15] [logits] Applying loss function for 1 factor(s)
[2023-07-28 05:40:15] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:40:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 05:40:15] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:44:44] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 05:44:44] [valid] No post-processing script given for validating translator
[2023-07-28 05:44:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:44:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:44:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:44:44] [comm] Using global sharding
[2023-07-28 05:44:44] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:44:44] [training] Using 1 GPUs
[2023-07-28 05:44:44] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:44:45] Allocating memory for general optimizer shards
[2023-07-28 05:44:45] [memory] Reserving 322 MB, device gpu0
[2023-07-28 05:44:45] Loading Adam parameters
[2023-07-28 05:44:45] [memory] Reserving 322 MB, device gpu0
[2023-07-28 05:44:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:44:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 05:44:46] [data] Restoring the corpus state to epoch 191, batch 5188
[2023-07-28 05:44:46] [data] Shuffling data
[2023-07-28 05:44:46] [data] Done reading 20,192 sentences
[2023-07-28 05:44:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:44:46] Training started
[2023-07-28 05:44:46] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 05:44:46] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:44:48] Parameter type float16, optimization type float32, casting types true
[2023-07-28 05:45:57] Seen 20,192 samples
[2023-07-28 05:45:57] Starting data epoch 192 in logical epoch 192
[2023-07-28 05:45:57] [data] Shuffling data
[2023-07-28 05:45:57] [data] Done reading 20,192 sentences
[2023-07-28 05:45:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:47:09] Seen 20,192 samples
[2023-07-28 05:47:09] Starting data epoch 193 in logical epoch 193
[2023-07-28 05:47:09] [data] Shuffling data
[2023-07-28 05:47:09] [data] Done reading 20,192 sentences
[2023-07-28 05:47:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:48:22] Seen 20,192 samples
[2023-07-28 05:48:22] Starting data epoch 194 in logical epoch 194
[2023-07-28 05:48:22] [data] Shuffling data
[2023-07-28 05:48:23] [data] Done reading 20,192 sentences
[2023-07-28 05:48:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:49:38] Seen 20,192 samples
[2023-07-28 05:49:38] Starting data epoch 195 in logical epoch 195
[2023-07-28 05:49:38] [data] Shuffling data
[2023-07-28 05:49:38] [data] Done reading 20,192 sentences
[2023-07-28 05:49:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:50:53] Seen 20,192 samples
[2023-07-28 05:50:53] Starting data epoch 196 in logical epoch 196
[2023-07-28 05:50:53] [data] Shuffling data
[2023-07-28 05:50:53] [data] Done reading 20,192 sentences
[2023-07-28 05:50:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:52:06] Seen 20,192 samples
[2023-07-28 05:52:06] Starting data epoch 197 in logical epoch 197
[2023-07-28 05:52:06] [data] Shuffling data
[2023-07-28 05:52:06] [data] Done reading 20,192 sentences
[2023-07-28 05:52:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:53:21] Seen 20,192 samples
[2023-07-28 05:53:21] Starting data epoch 198 in logical epoch 198
[2023-07-28 05:53:21] [data] Shuffling data
[2023-07-28 05:53:21] [data] Done reading 20,192 sentences
[2023-07-28 05:53:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:54:37] Seen 20,192 samples
[2023-07-28 05:54:37] Starting data epoch 199 in logical epoch 199
[2023-07-28 05:54:37] [data] Shuffling data
[2023-07-28 05:54:37] [data] Done reading 20,192 sentences
[2023-07-28 05:54:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:55:54] Seen 20,192 samples
[2023-07-28 05:55:54] Starting data epoch 200 in logical epoch 200
[2023-07-28 05:55:54] [data] Shuffling data
[2023-07-28 05:55:54] [data] Done reading 20,192 sentences
[2023-07-28 05:55:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:57:10] Seen 20,192 samples
[2023-07-28 05:57:10] Starting data epoch 201 in logical epoch 201
[2023-07-28 05:57:10] Training finished
[2023-07-28 05:57:54] [valid] Ep. 201 : Up. 5463 : translation : 0 : new best
[2023-07-28 05:57:54] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:57:56] Saving Adam parameters
[2023-07-28 05:57:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 05:58:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:58:03] [marian] Running on node05.datos.cluster.uy as process 931 with command line:
[2023-07-28 05:58:03] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 210 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 05:58:03] [config] after: 0e
[2023-07-28 05:58:03] [config] after-batches: 0
[2023-07-28 05:58:03] [config] after-epochs: 210
[2023-07-28 05:58:03] [config] all-caps-every: 0
[2023-07-28 05:58:03] [config] allow-unk: false
[2023-07-28 05:58:03] [config] authors: false
[2023-07-28 05:58:03] [config] beam-size: 12
[2023-07-28 05:58:03] [config] bert-class-symbol: "[CLS]"
[2023-07-28 05:58:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 05:58:03] [config] bert-masking-fraction: 0.15
[2023-07-28 05:58:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 05:58:03] [config] bert-train-type-embeddings: true
[2023-07-28 05:58:03] [config] bert-type-vocab-size: 2
[2023-07-28 05:58:03] [config] build-info: ""
[2023-07-28 05:58:03] [config] check-gradient-nan: false
[2023-07-28 05:58:03] [config] check-nan: false
[2023-07-28 05:58:03] [config] cite: false
[2023-07-28 05:58:03] [config] clip-norm: 1
[2023-07-28 05:58:03] [config] cost-scaling:
[2023-07-28 05:58:03] [config]   - 256.f
[2023-07-28 05:58:03] [config]   - 1000
[2023-07-28 05:58:03] [config]   - 2.f
[2023-07-28 05:58:03] [config]   - 256.f
[2023-07-28 05:58:03] [config] cost-type: ce-sum
[2023-07-28 05:58:03] [config] cpu-threads: 0
[2023-07-28 05:58:03] [config] data-threads: 8
[2023-07-28 05:58:03] [config] data-weighting: ""
[2023-07-28 05:58:03] [config] data-weighting-type: sentence
[2023-07-28 05:58:03] [config] dec-cell: gru
[2023-07-28 05:58:03] [config] dec-cell-base-depth: 2
[2023-07-28 05:58:03] [config] dec-cell-high-depth: 1
[2023-07-28 05:58:03] [config] dec-depth: 1
[2023-07-28 05:58:03] [config] devices:
[2023-07-28 05:58:03] [config]   - 0
[2023-07-28 05:58:03] [config] dim-emb: 512
[2023-07-28 05:58:03] [config] dim-rnn: 1024
[2023-07-28 05:58:03] [config] dim-vocabs:
[2023-07-28 05:58:03] [config]   - 16384
[2023-07-28 05:58:03] [config]   - 16384
[2023-07-28 05:58:03] [config] disp-first: 0
[2023-07-28 05:58:03] [config] disp-freq: 1000u
[2023-07-28 05:58:03] [config] disp-label-counts: true
[2023-07-28 05:58:03] [config] dropout-rnn: 0
[2023-07-28 05:58:03] [config] dropout-src: 0
[2023-07-28 05:58:03] [config] dropout-trg: 0
[2023-07-28 05:58:03] [config] dump-config: ""
[2023-07-28 05:58:03] [config] dynamic-gradient-scaling:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] early-stopping: 1000
[2023-07-28 05:58:03] [config] early-stopping-on: first
[2023-07-28 05:58:03] [config] embedding-fix-src: false
[2023-07-28 05:58:03] [config] embedding-fix-trg: false
[2023-07-28 05:58:03] [config] embedding-normalization: false
[2023-07-28 05:58:03] [config] embedding-vectors:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] enc-cell: gru
[2023-07-28 05:58:03] [config] enc-cell-depth: 1
[2023-07-28 05:58:03] [config] enc-depth: 1
[2023-07-28 05:58:03] [config] enc-type: bidirectional
[2023-07-28 05:58:03] [config] english-title-case-every: 0
[2023-07-28 05:58:03] [config] exponential-smoothing: 0
[2023-07-28 05:58:03] [config] factor-weight: 1
[2023-07-28 05:58:03] [config] factors-combine: sum
[2023-07-28 05:58:03] [config] factors-dim-emb: 0
[2023-07-28 05:58:03] [config] gradient-checkpointing: false
[2023-07-28 05:58:03] [config] gradient-norm-average-window: 100
[2023-07-28 05:58:03] [config] guided-alignment: none
[2023-07-28 05:58:03] [config] guided-alignment-cost: mse
[2023-07-28 05:58:03] [config] guided-alignment-weight: 0.1
[2023-07-28 05:58:03] [config] ignore-model-config: false
[2023-07-28 05:58:03] [config] input-types:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] interpolate-env-vars: false
[2023-07-28 05:58:03] [config] keep-best: false
[2023-07-28 05:58:03] [config] label-smoothing: 0
[2023-07-28 05:58:03] [config] layer-normalization: false
[2023-07-28 05:58:03] [config] learn-rate: 0.0001
[2023-07-28 05:58:03] [config] lemma-dependency: ""
[2023-07-28 05:58:03] [config] lemma-dim-emb: 0
[2023-07-28 05:58:03] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:58:03] [config] log-level: info
[2023-07-28 05:58:03] [config] log-time-zone: ""
[2023-07-28 05:58:03] [config] logical-epoch:
[2023-07-28 05:58:03] [config]   - 1e
[2023-07-28 05:58:03] [config]   - 0
[2023-07-28 05:58:03] [config] lr-decay: 0
[2023-07-28 05:58:03] [config] lr-decay-freq: 50000
[2023-07-28 05:58:03] [config] lr-decay-inv-sqrt:
[2023-07-28 05:58:03] [config]   - 0
[2023-07-28 05:58:03] [config] lr-decay-repeat-warmup: false
[2023-07-28 05:58:03] [config] lr-decay-reset-optimizer: false
[2023-07-28 05:58:03] [config] lr-decay-start:
[2023-07-28 05:58:03] [config]   - 10
[2023-07-28 05:58:03] [config]   - 1
[2023-07-28 05:58:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 05:58:03] [config] lr-report: false
[2023-07-28 05:58:03] [config] lr-warmup: 0
[2023-07-28 05:58:03] [config] lr-warmup-at-reload: false
[2023-07-28 05:58:03] [config] lr-warmup-cycle: false
[2023-07-28 05:58:03] [config] lr-warmup-start-rate: 0
[2023-07-28 05:58:03] [config] max-length: 50
[2023-07-28 05:58:03] [config] max-length-crop: true
[2023-07-28 05:58:03] [config] max-length-factor: 3
[2023-07-28 05:58:03] [config] maxi-batch: 100
[2023-07-28 05:58:03] [config] maxi-batch-sort: trg
[2023-07-28 05:58:03] [config] mini-batch: 64
[2023-07-28 05:58:03] [config] mini-batch-fit: true
[2023-07-28 05:58:03] [config] mini-batch-fit-step: 10
[2023-07-28 05:58:03] [config] mini-batch-round-up: true
[2023-07-28 05:58:03] [config] mini-batch-track-lr: false
[2023-07-28 05:58:03] [config] mini-batch-warmup: 0
[2023-07-28 05:58:03] [config] mini-batch-words: 0
[2023-07-28 05:58:03] [config] mini-batch-words-ref: 0
[2023-07-28 05:58:03] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 05:58:03] [config] multi-loss-type: sum
[2023-07-28 05:58:03] [config] n-best: false
[2023-07-28 05:58:03] [config] no-nccl: false
[2023-07-28 05:58:03] [config] no-reload: false
[2023-07-28 05:58:03] [config] no-restore-corpus: false
[2023-07-28 05:58:03] [config] normalize: 0
[2023-07-28 05:58:03] [config] normalize-gradient: false
[2023-07-28 05:58:03] [config] num-devices: 0
[2023-07-28 05:58:03] [config] optimizer: adam
[2023-07-28 05:58:03] [config] optimizer-delay: 1
[2023-07-28 05:58:03] [config] optimizer-params:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] output-omit-bias: false
[2023-07-28 05:58:03] [config] overwrite: true
[2023-07-28 05:58:03] [config] precision:
[2023-07-28 05:58:03] [config]   - float16
[2023-07-28 05:58:03] [config]   - float32
[2023-07-28 05:58:03] [config] pretrained-model: ""
[2023-07-28 05:58:03] [config] quantize-biases: false
[2023-07-28 05:58:03] [config] quantize-bits: 0
[2023-07-28 05:58:03] [config] quantize-log-based: false
[2023-07-28 05:58:03] [config] quantize-optimization-steps: 0
[2023-07-28 05:58:03] [config] quiet: false
[2023-07-28 05:58:03] [config] quiet-translation: true
[2023-07-28 05:58:03] [config] relative-paths: false
[2023-07-28 05:58:03] [config] right-left: false
[2023-07-28 05:58:03] [config] save-freq: 10000u
[2023-07-28 05:58:03] [config] seed: 1234
[2023-07-28 05:58:03] [config] sentencepiece-alphas:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] sentencepiece-max-lines: 2000000
[2023-07-28 05:58:03] [config] sentencepiece-options: ""
[2023-07-28 05:58:03] [config] sharding: global
[2023-07-28 05:58:03] [config] shuffle: data
[2023-07-28 05:58:03] [config] shuffle-in-ram: false
[2023-07-28 05:58:03] [config] sigterm: save-and-exit
[2023-07-28 05:58:03] [config] skip: false
[2023-07-28 05:58:03] [config] sqlite: ""
[2023-07-28 05:58:03] [config] sqlite-drop: false
[2023-07-28 05:58:03] [config] sync-freq: 200u
[2023-07-28 05:58:03] [config] sync-sgd: false
[2023-07-28 05:58:03] [config] tempdir: /tmp
[2023-07-28 05:58:03] [config] tied-embeddings: false
[2023-07-28 05:58:03] [config] tied-embeddings-all: true
[2023-07-28 05:58:03] [config] tied-embeddings-src: false
[2023-07-28 05:58:03] [config] train-embedder-rank:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] train-sets:
[2023-07-28 05:58:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 05:58:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 05:58:03] [config] transformer-aan-activation: swish
[2023-07-28 05:58:03] [config] transformer-aan-depth: 2
[2023-07-28 05:58:03] [config] transformer-aan-nogate: false
[2023-07-28 05:58:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 05:58:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 05:58:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 05:58:03] [config] transformer-depth-scaling: false
[2023-07-28 05:58:03] [config] transformer-dim-aan: 2048
[2023-07-28 05:58:03] [config] transformer-dim-ffn: 2048
[2023-07-28 05:58:03] [config] transformer-dropout: 0
[2023-07-28 05:58:03] [config] transformer-dropout-attention: 0
[2023-07-28 05:58:03] [config] transformer-dropout-ffn: 0
[2023-07-28 05:58:03] [config] transformer-ffn-activation: swish
[2023-07-28 05:58:03] [config] transformer-ffn-depth: 2
[2023-07-28 05:58:03] [config] transformer-guided-alignment-layer: last
[2023-07-28 05:58:03] [config] transformer-heads: 8
[2023-07-28 05:58:03] [config] transformer-no-projection: false
[2023-07-28 05:58:03] [config] transformer-pool: false
[2023-07-28 05:58:03] [config] transformer-postprocess: dan
[2023-07-28 05:58:03] [config] transformer-postprocess-emb: d
[2023-07-28 05:58:03] [config] transformer-postprocess-top: ""
[2023-07-28 05:58:03] [config] transformer-preprocess: ""
[2023-07-28 05:58:03] [config] transformer-tied-layers:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] transformer-train-position-embeddings: false
[2023-07-28 05:58:03] [config] tsv: false
[2023-07-28 05:58:03] [config] tsv-fields: 0
[2023-07-28 05:58:03] [config] type: s2s
[2023-07-28 05:58:03] [config] ulr: false
[2023-07-28 05:58:03] [config] ulr-dim-emb: 0
[2023-07-28 05:58:03] [config] ulr-dropout: 0
[2023-07-28 05:58:03] [config] ulr-keys-vectors: ""
[2023-07-28 05:58:03] [config] ulr-query-vectors: ""
[2023-07-28 05:58:03] [config] ulr-softmax-temperature: 1
[2023-07-28 05:58:03] [config] ulr-trainable-transformation: false
[2023-07-28 05:58:03] [config] unlikelihood-loss: false
[2023-07-28 05:58:03] [config] valid-freq: 50000000
[2023-07-28 05:58:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 05:58:03] [config] valid-max-length: 1000
[2023-07-28 05:58:03] [config] valid-metrics:
[2023-07-28 05:58:03] [config]   - translation
[2023-07-28 05:58:03] [config] valid-mini-batch: 32
[2023-07-28 05:58:03] [config] valid-reset-stalled: false
[2023-07-28 05:58:03] [config] valid-script-args:
[2023-07-28 05:58:03] [config]   []
[2023-07-28 05:58:03] [config] valid-script-path: ""
[2023-07-28 05:58:03] [config] valid-sets:
[2023-07-28 05:58:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 05:58:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 05:58:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 05:58:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:58:03] [config] vocabs:
[2023-07-28 05:58:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:58:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:58:03] [config] word-penalty: 0
[2023-07-28 05:58:03] [config] word-scores: false
[2023-07-28 05:58:03] [config] workspace: 5500
[2023-07-28 05:58:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:58:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:58:03] [training] Using single-device training
[2023-07-28 05:58:03] Synced seed 1234
[2023-07-28 05:58:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:58:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 05:58:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:58:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 05:58:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 05:58:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:58:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 05:58:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:58:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:58:04] [comm] Using global sharding
[2023-07-28 05:58:04] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:58:04] [training] Using 1 GPUs
[2023-07-28 05:58:04] [logits] Applying loss function for 1 factor(s)
[2023-07-28 05:58:04] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:58:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 05:58:04] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:02:32] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 06:02:33] [valid] No post-processing script given for validating translator
[2023-07-28 06:02:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:02:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:02:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:02:33] [comm] Using global sharding
[2023-07-28 06:02:33] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:02:33] [training] Using 1 GPUs
[2023-07-28 06:02:33] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:02:34] Allocating memory for general optimizer shards
[2023-07-28 06:02:34] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:02:34] Loading Adam parameters
[2023-07-28 06:02:34] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:02:34] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:02:34] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 06:02:34] [data] Restoring the corpus state to epoch 201, batch 5463
[2023-07-28 06:02:34] [data] Shuffling data
[2023-07-28 06:02:35] [data] Done reading 20,192 sentences
[2023-07-28 06:02:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:02:35] Training started
[2023-07-28 06:02:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 06:02:35] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:02:35] Parameter type float16, optimization type float32, casting types true
[2023-07-28 06:03:45] Seen 20,192 samples
[2023-07-28 06:03:45] Starting data epoch 202 in logical epoch 202
[2023-07-28 06:03:45] [data] Shuffling data
[2023-07-28 06:03:45] [data] Done reading 20,192 sentences
[2023-07-28 06:03:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:04:57] Seen 20,192 samples
[2023-07-28 06:04:57] Starting data epoch 203 in logical epoch 203
[2023-07-28 06:04:57] [data] Shuffling data
[2023-07-28 06:04:57] [data] Done reading 20,192 sentences
[2023-07-28 06:04:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:06:12] Seen 20,192 samples
[2023-07-28 06:06:12] Starting data epoch 204 in logical epoch 204
[2023-07-28 06:06:12] [data] Shuffling data
[2023-07-28 06:06:12] [data] Done reading 20,192 sentences
[2023-07-28 06:06:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:07:27] Seen 20,192 samples
[2023-07-28 06:07:27] Starting data epoch 205 in logical epoch 205
[2023-07-28 06:07:27] [data] Shuffling data
[2023-07-28 06:07:27] [data] Done reading 20,192 sentences
[2023-07-28 06:07:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:08:42] Seen 20,192 samples
[2023-07-28 06:08:42] Starting data epoch 206 in logical epoch 206
[2023-07-28 06:08:42] [data] Shuffling data
[2023-07-28 06:08:42] [data] Done reading 20,192 sentences
[2023-07-28 06:08:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:09:57] Seen 20,192 samples
[2023-07-28 06:09:57] Starting data epoch 207 in logical epoch 207
[2023-07-28 06:09:57] [data] Shuffling data
[2023-07-28 06:09:57] [data] Done reading 20,192 sentences
[2023-07-28 06:09:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:11:14] Seen 20,192 samples
[2023-07-28 06:11:14] Starting data epoch 208 in logical epoch 208
[2023-07-28 06:11:14] [data] Shuffling data
[2023-07-28 06:11:14] [data] Done reading 20,192 sentences
[2023-07-28 06:11:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:12:30] Seen 20,192 samples
[2023-07-28 06:12:30] Starting data epoch 209 in logical epoch 209
[2023-07-28 06:12:30] [data] Shuffling data
[2023-07-28 06:12:30] [data] Done reading 20,192 sentences
[2023-07-28 06:12:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:13:45] Seen 20,192 samples
[2023-07-28 06:13:45] Starting data epoch 210 in logical epoch 210
[2023-07-28 06:13:45] [data] Shuffling data
[2023-07-28 06:13:45] [data] Done reading 20,192 sentences
[2023-07-28 06:13:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:15:01] Seen 20,192 samples
[2023-07-28 06:15:01] Starting data epoch 211 in logical epoch 211
[2023-07-28 06:15:01] Training finished
[2023-07-28 06:15:44] [valid] Ep. 211 : Up. 5738 : translation : 0 : new best
[2023-07-28 06:15:44] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:15:45] Saving Adam parameters
[2023-07-28 06:15:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 06:15:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:15:53] [marian] Running on node05.datos.cluster.uy as process 2011 with command line:
[2023-07-28 06:15:53] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 220 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 06:15:53] [config] after: 0e
[2023-07-28 06:15:53] [config] after-batches: 0
[2023-07-28 06:15:53] [config] after-epochs: 220
[2023-07-28 06:15:53] [config] all-caps-every: 0
[2023-07-28 06:15:53] [config] allow-unk: false
[2023-07-28 06:15:53] [config] authors: false
[2023-07-28 06:15:53] [config] beam-size: 12
[2023-07-28 06:15:53] [config] bert-class-symbol: "[CLS]"
[2023-07-28 06:15:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 06:15:53] [config] bert-masking-fraction: 0.15
[2023-07-28 06:15:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 06:15:53] [config] bert-train-type-embeddings: true
[2023-07-28 06:15:53] [config] bert-type-vocab-size: 2
[2023-07-28 06:15:53] [config] build-info: ""
[2023-07-28 06:15:53] [config] check-gradient-nan: false
[2023-07-28 06:15:53] [config] check-nan: false
[2023-07-28 06:15:53] [config] cite: false
[2023-07-28 06:15:53] [config] clip-norm: 1
[2023-07-28 06:15:53] [config] cost-scaling:
[2023-07-28 06:15:53] [config]   - 256.f
[2023-07-28 06:15:53] [config]   - 1000
[2023-07-28 06:15:53] [config]   - 2.f
[2023-07-28 06:15:53] [config]   - 256.f
[2023-07-28 06:15:53] [config] cost-type: ce-sum
[2023-07-28 06:15:53] [config] cpu-threads: 0
[2023-07-28 06:15:53] [config] data-threads: 8
[2023-07-28 06:15:53] [config] data-weighting: ""
[2023-07-28 06:15:53] [config] data-weighting-type: sentence
[2023-07-28 06:15:53] [config] dec-cell: gru
[2023-07-28 06:15:53] [config] dec-cell-base-depth: 2
[2023-07-28 06:15:53] [config] dec-cell-high-depth: 1
[2023-07-28 06:15:53] [config] dec-depth: 1
[2023-07-28 06:15:53] [config] devices:
[2023-07-28 06:15:53] [config]   - 0
[2023-07-28 06:15:53] [config] dim-emb: 512
[2023-07-28 06:15:53] [config] dim-rnn: 1024
[2023-07-28 06:15:53] [config] dim-vocabs:
[2023-07-28 06:15:53] [config]   - 16384
[2023-07-28 06:15:53] [config]   - 16384
[2023-07-28 06:15:53] [config] disp-first: 0
[2023-07-28 06:15:53] [config] disp-freq: 1000u
[2023-07-28 06:15:53] [config] disp-label-counts: true
[2023-07-28 06:15:53] [config] dropout-rnn: 0
[2023-07-28 06:15:53] [config] dropout-src: 0
[2023-07-28 06:15:53] [config] dropout-trg: 0
[2023-07-28 06:15:53] [config] dump-config: ""
[2023-07-28 06:15:53] [config] dynamic-gradient-scaling:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] early-stopping: 1000
[2023-07-28 06:15:53] [config] early-stopping-on: first
[2023-07-28 06:15:53] [config] embedding-fix-src: false
[2023-07-28 06:15:53] [config] embedding-fix-trg: false
[2023-07-28 06:15:53] [config] embedding-normalization: false
[2023-07-28 06:15:53] [config] embedding-vectors:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] enc-cell: gru
[2023-07-28 06:15:53] [config] enc-cell-depth: 1
[2023-07-28 06:15:53] [config] enc-depth: 1
[2023-07-28 06:15:53] [config] enc-type: bidirectional
[2023-07-28 06:15:53] [config] english-title-case-every: 0
[2023-07-28 06:15:53] [config] exponential-smoothing: 0
[2023-07-28 06:15:53] [config] factor-weight: 1
[2023-07-28 06:15:53] [config] factors-combine: sum
[2023-07-28 06:15:53] [config] factors-dim-emb: 0
[2023-07-28 06:15:53] [config] gradient-checkpointing: false
[2023-07-28 06:15:53] [config] gradient-norm-average-window: 100
[2023-07-28 06:15:53] [config] guided-alignment: none
[2023-07-28 06:15:53] [config] guided-alignment-cost: mse
[2023-07-28 06:15:53] [config] guided-alignment-weight: 0.1
[2023-07-28 06:15:53] [config] ignore-model-config: false
[2023-07-28 06:15:53] [config] input-types:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] interpolate-env-vars: false
[2023-07-28 06:15:53] [config] keep-best: false
[2023-07-28 06:15:53] [config] label-smoothing: 0
[2023-07-28 06:15:53] [config] layer-normalization: false
[2023-07-28 06:15:53] [config] learn-rate: 0.0001
[2023-07-28 06:15:53] [config] lemma-dependency: ""
[2023-07-28 06:15:53] [config] lemma-dim-emb: 0
[2023-07-28 06:15:53] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 06:15:53] [config] log-level: info
[2023-07-28 06:15:53] [config] log-time-zone: ""
[2023-07-28 06:15:53] [config] logical-epoch:
[2023-07-28 06:15:53] [config]   - 1e
[2023-07-28 06:15:53] [config]   - 0
[2023-07-28 06:15:53] [config] lr-decay: 0
[2023-07-28 06:15:53] [config] lr-decay-freq: 50000
[2023-07-28 06:15:53] [config] lr-decay-inv-sqrt:
[2023-07-28 06:15:53] [config]   - 0
[2023-07-28 06:15:53] [config] lr-decay-repeat-warmup: false
[2023-07-28 06:15:53] [config] lr-decay-reset-optimizer: false
[2023-07-28 06:15:53] [config] lr-decay-start:
[2023-07-28 06:15:53] [config]   - 10
[2023-07-28 06:15:53] [config]   - 1
[2023-07-28 06:15:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 06:15:53] [config] lr-report: false
[2023-07-28 06:15:53] [config] lr-warmup: 0
[2023-07-28 06:15:53] [config] lr-warmup-at-reload: false
[2023-07-28 06:15:53] [config] lr-warmup-cycle: false
[2023-07-28 06:15:53] [config] lr-warmup-start-rate: 0
[2023-07-28 06:15:53] [config] max-length: 50
[2023-07-28 06:15:53] [config] max-length-crop: true
[2023-07-28 06:15:53] [config] max-length-factor: 3
[2023-07-28 06:15:53] [config] maxi-batch: 100
[2023-07-28 06:15:53] [config] maxi-batch-sort: trg
[2023-07-28 06:15:53] [config] mini-batch: 64
[2023-07-28 06:15:53] [config] mini-batch-fit: true
[2023-07-28 06:15:53] [config] mini-batch-fit-step: 10
[2023-07-28 06:15:53] [config] mini-batch-round-up: true
[2023-07-28 06:15:53] [config] mini-batch-track-lr: false
[2023-07-28 06:15:53] [config] mini-batch-warmup: 0
[2023-07-28 06:15:53] [config] mini-batch-words: 0
[2023-07-28 06:15:53] [config] mini-batch-words-ref: 0
[2023-07-28 06:15:53] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:15:53] [config] multi-loss-type: sum
[2023-07-28 06:15:53] [config] n-best: false
[2023-07-28 06:15:53] [config] no-nccl: false
[2023-07-28 06:15:53] [config] no-reload: false
[2023-07-28 06:15:53] [config] no-restore-corpus: false
[2023-07-28 06:15:53] [config] normalize: 0
[2023-07-28 06:15:53] [config] normalize-gradient: false
[2023-07-28 06:15:53] [config] num-devices: 0
[2023-07-28 06:15:53] [config] optimizer: adam
[2023-07-28 06:15:53] [config] optimizer-delay: 1
[2023-07-28 06:15:53] [config] optimizer-params:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] output-omit-bias: false
[2023-07-28 06:15:53] [config] overwrite: true
[2023-07-28 06:15:53] [config] precision:
[2023-07-28 06:15:53] [config]   - float16
[2023-07-28 06:15:53] [config]   - float32
[2023-07-28 06:15:53] [config] pretrained-model: ""
[2023-07-28 06:15:53] [config] quantize-biases: false
[2023-07-28 06:15:53] [config] quantize-bits: 0
[2023-07-28 06:15:53] [config] quantize-log-based: false
[2023-07-28 06:15:53] [config] quantize-optimization-steps: 0
[2023-07-28 06:15:53] [config] quiet: false
[2023-07-28 06:15:53] [config] quiet-translation: true
[2023-07-28 06:15:53] [config] relative-paths: false
[2023-07-28 06:15:53] [config] right-left: false
[2023-07-28 06:15:53] [config] save-freq: 10000u
[2023-07-28 06:15:53] [config] seed: 1234
[2023-07-28 06:15:53] [config] sentencepiece-alphas:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] sentencepiece-max-lines: 2000000
[2023-07-28 06:15:53] [config] sentencepiece-options: ""
[2023-07-28 06:15:53] [config] sharding: global
[2023-07-28 06:15:53] [config] shuffle: data
[2023-07-28 06:15:53] [config] shuffle-in-ram: false
[2023-07-28 06:15:53] [config] sigterm: save-and-exit
[2023-07-28 06:15:53] [config] skip: false
[2023-07-28 06:15:53] [config] sqlite: ""
[2023-07-28 06:15:53] [config] sqlite-drop: false
[2023-07-28 06:15:53] [config] sync-freq: 200u
[2023-07-28 06:15:53] [config] sync-sgd: false
[2023-07-28 06:15:53] [config] tempdir: /tmp
[2023-07-28 06:15:53] [config] tied-embeddings: false
[2023-07-28 06:15:53] [config] tied-embeddings-all: true
[2023-07-28 06:15:53] [config] tied-embeddings-src: false
[2023-07-28 06:15:53] [config] train-embedder-rank:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] train-sets:
[2023-07-28 06:15:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 06:15:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 06:15:53] [config] transformer-aan-activation: swish
[2023-07-28 06:15:53] [config] transformer-aan-depth: 2
[2023-07-28 06:15:53] [config] transformer-aan-nogate: false
[2023-07-28 06:15:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 06:15:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 06:15:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 06:15:53] [config] transformer-depth-scaling: false
[2023-07-28 06:15:53] [config] transformer-dim-aan: 2048
[2023-07-28 06:15:53] [config] transformer-dim-ffn: 2048
[2023-07-28 06:15:53] [config] transformer-dropout: 0
[2023-07-28 06:15:53] [config] transformer-dropout-attention: 0
[2023-07-28 06:15:53] [config] transformer-dropout-ffn: 0
[2023-07-28 06:15:53] [config] transformer-ffn-activation: swish
[2023-07-28 06:15:53] [config] transformer-ffn-depth: 2
[2023-07-28 06:15:53] [config] transformer-guided-alignment-layer: last
[2023-07-28 06:15:53] [config] transformer-heads: 8
[2023-07-28 06:15:53] [config] transformer-no-projection: false
[2023-07-28 06:15:53] [config] transformer-pool: false
[2023-07-28 06:15:53] [config] transformer-postprocess: dan
[2023-07-28 06:15:53] [config] transformer-postprocess-emb: d
[2023-07-28 06:15:53] [config] transformer-postprocess-top: ""
[2023-07-28 06:15:53] [config] transformer-preprocess: ""
[2023-07-28 06:15:53] [config] transformer-tied-layers:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] transformer-train-position-embeddings: false
[2023-07-28 06:15:53] [config] tsv: false
[2023-07-28 06:15:53] [config] tsv-fields: 0
[2023-07-28 06:15:53] [config] type: s2s
[2023-07-28 06:15:53] [config] ulr: false
[2023-07-28 06:15:53] [config] ulr-dim-emb: 0
[2023-07-28 06:15:53] [config] ulr-dropout: 0
[2023-07-28 06:15:53] [config] ulr-keys-vectors: ""
[2023-07-28 06:15:53] [config] ulr-query-vectors: ""
[2023-07-28 06:15:53] [config] ulr-softmax-temperature: 1
[2023-07-28 06:15:53] [config] ulr-trainable-transformation: false
[2023-07-28 06:15:53] [config] unlikelihood-loss: false
[2023-07-28 06:15:53] [config] valid-freq: 50000000
[2023-07-28 06:15:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 06:15:53] [config] valid-max-length: 1000
[2023-07-28 06:15:53] [config] valid-metrics:
[2023-07-28 06:15:53] [config]   - translation
[2023-07-28 06:15:53] [config] valid-mini-batch: 32
[2023-07-28 06:15:53] [config] valid-reset-stalled: false
[2023-07-28 06:15:53] [config] valid-script-args:
[2023-07-28 06:15:53] [config]   []
[2023-07-28 06:15:53] [config] valid-script-path: ""
[2023-07-28 06:15:53] [config] valid-sets:
[2023-07-28 06:15:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 06:15:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 06:15:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 06:15:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:15:53] [config] vocabs:
[2023-07-28 06:15:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:15:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:15:53] [config] word-penalty: 0
[2023-07-28 06:15:53] [config] word-scores: false
[2023-07-28 06:15:53] [config] workspace: 5500
[2023-07-28 06:15:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:15:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:15:53] [training] Using single-device training
[2023-07-28 06:15:53] Synced seed 1234
[2023-07-28 06:15:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:15:53] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 06:15:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:15:53] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 06:15:53] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 06:15:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:15:53] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 06:15:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:15:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:15:54] [comm] Using global sharding
[2023-07-28 06:15:54] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:15:54] [training] Using 1 GPUs
[2023-07-28 06:15:54] [logits] Applying loss function for 1 factor(s)
[2023-07-28 06:15:54] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:15:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 06:15:54] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:20:23] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 06:20:23] [valid] No post-processing script given for validating translator
[2023-07-28 06:20:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:20:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:20:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:20:23] [comm] Using global sharding
[2023-07-28 06:20:23] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:20:23] [training] Using 1 GPUs
[2023-07-28 06:20:23] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:20:24] Allocating memory for general optimizer shards
[2023-07-28 06:20:24] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:20:24] Loading Adam parameters
[2023-07-28 06:20:24] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:20:24] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:20:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 06:20:25] [data] Restoring the corpus state to epoch 211, batch 5738
[2023-07-28 06:20:25] [data] Shuffling data
[2023-07-28 06:20:25] [data] Done reading 20,192 sentences
[2023-07-28 06:20:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:20:25] Training started
[2023-07-28 06:20:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 06:20:25] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:20:29] Parameter type float16, optimization type float32, casting types true
[2023-07-28 06:21:34] Seen 20,192 samples
[2023-07-28 06:21:34] Starting data epoch 212 in logical epoch 212
[2023-07-28 06:21:34] [data] Shuffling data
[2023-07-28 06:21:34] [data] Done reading 20,192 sentences
[2023-07-28 06:21:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:22:43] Seen 20,192 samples
[2023-07-28 06:22:43] Starting data epoch 213 in logical epoch 213
[2023-07-28 06:22:43] [data] Shuffling data
[2023-07-28 06:22:43] [data] Done reading 20,192 sentences
[2023-07-28 06:22:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:23:58] Seen 20,192 samples
[2023-07-28 06:23:58] Starting data epoch 214 in logical epoch 214
[2023-07-28 06:23:58] [data] Shuffling data
[2023-07-28 06:23:58] [data] Done reading 20,192 sentences
[2023-07-28 06:23:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:25:12] Seen 20,192 samples
[2023-07-28 06:25:12] Starting data epoch 215 in logical epoch 215
[2023-07-28 06:25:12] [data] Shuffling data
[2023-07-28 06:25:12] [data] Done reading 20,192 sentences
[2023-07-28 06:25:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:26:25] Seen 20,192 samples
[2023-07-28 06:26:25] Starting data epoch 216 in logical epoch 216
[2023-07-28 06:26:25] [data] Shuffling data
[2023-07-28 06:26:25] [data] Done reading 20,192 sentences
[2023-07-28 06:26:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:27:41] Seen 20,192 samples
[2023-07-28 06:27:41] Starting data epoch 217 in logical epoch 217
[2023-07-28 06:27:41] [data] Shuffling data
[2023-07-28 06:27:41] [data] Done reading 20,192 sentences
[2023-07-28 06:27:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:28:58] Seen 20,192 samples
[2023-07-28 06:28:58] Starting data epoch 218 in logical epoch 218
[2023-07-28 06:28:58] [data] Shuffling data
[2023-07-28 06:28:58] [data] Done reading 20,192 sentences
[2023-07-28 06:28:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:30:13] Seen 20,192 samples
[2023-07-28 06:30:13] Starting data epoch 219 in logical epoch 219
[2023-07-28 06:30:13] [data] Shuffling data
[2023-07-28 06:30:13] [data] Done reading 20,192 sentences
[2023-07-28 06:30:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:31:28] Seen 20,192 samples
[2023-07-28 06:31:28] Starting data epoch 220 in logical epoch 220
[2023-07-28 06:31:28] [data] Shuffling data
[2023-07-28 06:31:28] [data] Done reading 20,192 sentences
[2023-07-28 06:31:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:32:15] Ep. 220 : Up. 6000 : Sen. 11,628 : Cost 3.30269384 * 20,642,112 @ 14,737 after 124,547,136 : Time 711.89s : 28996.34 words/s : gNorm 1.4950
[2023-07-28 06:32:44] Seen 20,192 samples
[2023-07-28 06:32:44] Starting data epoch 221 in logical epoch 221
[2023-07-28 06:32:44] Training finished
[2023-07-28 06:33:26] [valid] Ep. 221 : Up. 6011 : translation : 0 : new best
[2023-07-28 06:33:26] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:33:28] Saving Adam parameters
[2023-07-28 06:33:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 06:33:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:33:35] [marian] Running on node05.datos.cluster.uy as process 3320 with command line:
[2023-07-28 06:33:35] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 230 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 06:33:36] [config] after: 0e
[2023-07-28 06:33:36] [config] after-batches: 0
[2023-07-28 06:33:36] [config] after-epochs: 230
[2023-07-28 06:33:36] [config] all-caps-every: 0
[2023-07-28 06:33:36] [config] allow-unk: false
[2023-07-28 06:33:36] [config] authors: false
[2023-07-28 06:33:36] [config] beam-size: 12
[2023-07-28 06:33:36] [config] bert-class-symbol: "[CLS]"
[2023-07-28 06:33:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 06:33:36] [config] bert-masking-fraction: 0.15
[2023-07-28 06:33:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 06:33:36] [config] bert-train-type-embeddings: true
[2023-07-28 06:33:36] [config] bert-type-vocab-size: 2
[2023-07-28 06:33:36] [config] build-info: ""
[2023-07-28 06:33:36] [config] check-gradient-nan: false
[2023-07-28 06:33:36] [config] check-nan: false
[2023-07-28 06:33:36] [config] cite: false
[2023-07-28 06:33:36] [config] clip-norm: 1
[2023-07-28 06:33:36] [config] cost-scaling:
[2023-07-28 06:33:36] [config]   - 256.f
[2023-07-28 06:33:36] [config]   - 1000
[2023-07-28 06:33:36] [config]   - 2.f
[2023-07-28 06:33:36] [config]   - 256.f
[2023-07-28 06:33:36] [config] cost-type: ce-sum
[2023-07-28 06:33:36] [config] cpu-threads: 0
[2023-07-28 06:33:36] [config] data-threads: 8
[2023-07-28 06:33:36] [config] data-weighting: ""
[2023-07-28 06:33:36] [config] data-weighting-type: sentence
[2023-07-28 06:33:36] [config] dec-cell: gru
[2023-07-28 06:33:36] [config] dec-cell-base-depth: 2
[2023-07-28 06:33:36] [config] dec-cell-high-depth: 1
[2023-07-28 06:33:36] [config] dec-depth: 1
[2023-07-28 06:33:36] [config] devices:
[2023-07-28 06:33:36] [config]   - 0
[2023-07-28 06:33:36] [config] dim-emb: 512
[2023-07-28 06:33:36] [config] dim-rnn: 1024
[2023-07-28 06:33:36] [config] dim-vocabs:
[2023-07-28 06:33:36] [config]   - 16384
[2023-07-28 06:33:36] [config]   - 16384
[2023-07-28 06:33:36] [config] disp-first: 0
[2023-07-28 06:33:36] [config] disp-freq: 1000u
[2023-07-28 06:33:36] [config] disp-label-counts: true
[2023-07-28 06:33:36] [config] dropout-rnn: 0
[2023-07-28 06:33:36] [config] dropout-src: 0
[2023-07-28 06:33:36] [config] dropout-trg: 0
[2023-07-28 06:33:36] [config] dump-config: ""
[2023-07-28 06:33:36] [config] dynamic-gradient-scaling:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] early-stopping: 1000
[2023-07-28 06:33:36] [config] early-stopping-on: first
[2023-07-28 06:33:36] [config] embedding-fix-src: false
[2023-07-28 06:33:36] [config] embedding-fix-trg: false
[2023-07-28 06:33:36] [config] embedding-normalization: false
[2023-07-28 06:33:36] [config] embedding-vectors:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] enc-cell: gru
[2023-07-28 06:33:36] [config] enc-cell-depth: 1
[2023-07-28 06:33:36] [config] enc-depth: 1
[2023-07-28 06:33:36] [config] enc-type: bidirectional
[2023-07-28 06:33:36] [config] english-title-case-every: 0
[2023-07-28 06:33:36] [config] exponential-smoothing: 0
[2023-07-28 06:33:36] [config] factor-weight: 1
[2023-07-28 06:33:36] [config] factors-combine: sum
[2023-07-28 06:33:36] [config] factors-dim-emb: 0
[2023-07-28 06:33:36] [config] gradient-checkpointing: false
[2023-07-28 06:33:36] [config] gradient-norm-average-window: 100
[2023-07-28 06:33:36] [config] guided-alignment: none
[2023-07-28 06:33:36] [config] guided-alignment-cost: mse
[2023-07-28 06:33:36] [config] guided-alignment-weight: 0.1
[2023-07-28 06:33:36] [config] ignore-model-config: false
[2023-07-28 06:33:36] [config] input-types:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] interpolate-env-vars: false
[2023-07-28 06:33:36] [config] keep-best: false
[2023-07-28 06:33:36] [config] label-smoothing: 0
[2023-07-28 06:33:36] [config] layer-normalization: false
[2023-07-28 06:33:36] [config] learn-rate: 0.0001
[2023-07-28 06:33:36] [config] lemma-dependency: ""
[2023-07-28 06:33:36] [config] lemma-dim-emb: 0
[2023-07-28 06:33:36] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 06:33:36] [config] log-level: info
[2023-07-28 06:33:36] [config] log-time-zone: ""
[2023-07-28 06:33:36] [config] logical-epoch:
[2023-07-28 06:33:36] [config]   - 1e
[2023-07-28 06:33:36] [config]   - 0
[2023-07-28 06:33:36] [config] lr-decay: 0
[2023-07-28 06:33:36] [config] lr-decay-freq: 50000
[2023-07-28 06:33:36] [config] lr-decay-inv-sqrt:
[2023-07-28 06:33:36] [config]   - 0
[2023-07-28 06:33:36] [config] lr-decay-repeat-warmup: false
[2023-07-28 06:33:36] [config] lr-decay-reset-optimizer: false
[2023-07-28 06:33:36] [config] lr-decay-start:
[2023-07-28 06:33:36] [config]   - 10
[2023-07-28 06:33:36] [config]   - 1
[2023-07-28 06:33:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 06:33:36] [config] lr-report: false
[2023-07-28 06:33:36] [config] lr-warmup: 0
[2023-07-28 06:33:36] [config] lr-warmup-at-reload: false
[2023-07-28 06:33:36] [config] lr-warmup-cycle: false
[2023-07-28 06:33:36] [config] lr-warmup-start-rate: 0
[2023-07-28 06:33:36] [config] max-length: 50
[2023-07-28 06:33:36] [config] max-length-crop: true
[2023-07-28 06:33:36] [config] max-length-factor: 3
[2023-07-28 06:33:36] [config] maxi-batch: 100
[2023-07-28 06:33:36] [config] maxi-batch-sort: trg
[2023-07-28 06:33:36] [config] mini-batch: 64
[2023-07-28 06:33:36] [config] mini-batch-fit: true
[2023-07-28 06:33:36] [config] mini-batch-fit-step: 10
[2023-07-28 06:33:36] [config] mini-batch-round-up: true
[2023-07-28 06:33:36] [config] mini-batch-track-lr: false
[2023-07-28 06:33:36] [config] mini-batch-warmup: 0
[2023-07-28 06:33:36] [config] mini-batch-words: 0
[2023-07-28 06:33:36] [config] mini-batch-words-ref: 0
[2023-07-28 06:33:36] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:33:36] [config] multi-loss-type: sum
[2023-07-28 06:33:36] [config] n-best: false
[2023-07-28 06:33:36] [config] no-nccl: false
[2023-07-28 06:33:36] [config] no-reload: false
[2023-07-28 06:33:36] [config] no-restore-corpus: false
[2023-07-28 06:33:36] [config] normalize: 0
[2023-07-28 06:33:36] [config] normalize-gradient: false
[2023-07-28 06:33:36] [config] num-devices: 0
[2023-07-28 06:33:36] [config] optimizer: adam
[2023-07-28 06:33:36] [config] optimizer-delay: 1
[2023-07-28 06:33:36] [config] optimizer-params:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] output-omit-bias: false
[2023-07-28 06:33:36] [config] overwrite: true
[2023-07-28 06:33:36] [config] precision:
[2023-07-28 06:33:36] [config]   - float16
[2023-07-28 06:33:36] [config]   - float32
[2023-07-28 06:33:36] [config] pretrained-model: ""
[2023-07-28 06:33:36] [config] quantize-biases: false
[2023-07-28 06:33:36] [config] quantize-bits: 0
[2023-07-28 06:33:36] [config] quantize-log-based: false
[2023-07-28 06:33:36] [config] quantize-optimization-steps: 0
[2023-07-28 06:33:36] [config] quiet: false
[2023-07-28 06:33:36] [config] quiet-translation: true
[2023-07-28 06:33:36] [config] relative-paths: false
[2023-07-28 06:33:36] [config] right-left: false
[2023-07-28 06:33:36] [config] save-freq: 10000u
[2023-07-28 06:33:36] [config] seed: 1234
[2023-07-28 06:33:36] [config] sentencepiece-alphas:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] sentencepiece-max-lines: 2000000
[2023-07-28 06:33:36] [config] sentencepiece-options: ""
[2023-07-28 06:33:36] [config] sharding: global
[2023-07-28 06:33:36] [config] shuffle: data
[2023-07-28 06:33:36] [config] shuffle-in-ram: false
[2023-07-28 06:33:36] [config] sigterm: save-and-exit
[2023-07-28 06:33:36] [config] skip: false
[2023-07-28 06:33:36] [config] sqlite: ""
[2023-07-28 06:33:36] [config] sqlite-drop: false
[2023-07-28 06:33:36] [config] sync-freq: 200u
[2023-07-28 06:33:36] [config] sync-sgd: false
[2023-07-28 06:33:36] [config] tempdir: /tmp
[2023-07-28 06:33:36] [config] tied-embeddings: false
[2023-07-28 06:33:36] [config] tied-embeddings-all: true
[2023-07-28 06:33:36] [config] tied-embeddings-src: false
[2023-07-28 06:33:36] [config] train-embedder-rank:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] train-sets:
[2023-07-28 06:33:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 06:33:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 06:33:36] [config] transformer-aan-activation: swish
[2023-07-28 06:33:36] [config] transformer-aan-depth: 2
[2023-07-28 06:33:36] [config] transformer-aan-nogate: false
[2023-07-28 06:33:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 06:33:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 06:33:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 06:33:36] [config] transformer-depth-scaling: false
[2023-07-28 06:33:36] [config] transformer-dim-aan: 2048
[2023-07-28 06:33:36] [config] transformer-dim-ffn: 2048
[2023-07-28 06:33:36] [config] transformer-dropout: 0
[2023-07-28 06:33:36] [config] transformer-dropout-attention: 0
[2023-07-28 06:33:36] [config] transformer-dropout-ffn: 0
[2023-07-28 06:33:36] [config] transformer-ffn-activation: swish
[2023-07-28 06:33:36] [config] transformer-ffn-depth: 2
[2023-07-28 06:33:36] [config] transformer-guided-alignment-layer: last
[2023-07-28 06:33:36] [config] transformer-heads: 8
[2023-07-28 06:33:36] [config] transformer-no-projection: false
[2023-07-28 06:33:36] [config] transformer-pool: false
[2023-07-28 06:33:36] [config] transformer-postprocess: dan
[2023-07-28 06:33:36] [config] transformer-postprocess-emb: d
[2023-07-28 06:33:36] [config] transformer-postprocess-top: ""
[2023-07-28 06:33:36] [config] transformer-preprocess: ""
[2023-07-28 06:33:36] [config] transformer-tied-layers:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] transformer-train-position-embeddings: false
[2023-07-28 06:33:36] [config] tsv: false
[2023-07-28 06:33:36] [config] tsv-fields: 0
[2023-07-28 06:33:36] [config] type: s2s
[2023-07-28 06:33:36] [config] ulr: false
[2023-07-28 06:33:36] [config] ulr-dim-emb: 0
[2023-07-28 06:33:36] [config] ulr-dropout: 0
[2023-07-28 06:33:36] [config] ulr-keys-vectors: ""
[2023-07-28 06:33:36] [config] ulr-query-vectors: ""
[2023-07-28 06:33:36] [config] ulr-softmax-temperature: 1
[2023-07-28 06:33:36] [config] ulr-trainable-transformation: false
[2023-07-28 06:33:36] [config] unlikelihood-loss: false
[2023-07-28 06:33:36] [config] valid-freq: 50000000
[2023-07-28 06:33:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 06:33:36] [config] valid-max-length: 1000
[2023-07-28 06:33:36] [config] valid-metrics:
[2023-07-28 06:33:36] [config]   - translation
[2023-07-28 06:33:36] [config] valid-mini-batch: 32
[2023-07-28 06:33:36] [config] valid-reset-stalled: false
[2023-07-28 06:33:36] [config] valid-script-args:
[2023-07-28 06:33:36] [config]   []
[2023-07-28 06:33:36] [config] valid-script-path: ""
[2023-07-28 06:33:36] [config] valid-sets:
[2023-07-28 06:33:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 06:33:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 06:33:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 06:33:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:33:36] [config] vocabs:
[2023-07-28 06:33:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:33:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:33:36] [config] word-penalty: 0
[2023-07-28 06:33:36] [config] word-scores: false
[2023-07-28 06:33:36] [config] workspace: 5500
[2023-07-28 06:33:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:33:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:33:36] [training] Using single-device training
[2023-07-28 06:33:36] Synced seed 1234
[2023-07-28 06:33:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:33:36] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 06:33:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:33:36] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 06:33:36] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 06:33:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:33:36] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 06:33:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:33:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:33:37] [comm] Using global sharding
[2023-07-28 06:33:37] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:33:37] [training] Using 1 GPUs
[2023-07-28 06:33:37] [logits] Applying loss function for 1 factor(s)
[2023-07-28 06:33:37] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:33:37] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 06:33:37] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:38:08] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 06:38:08] [valid] No post-processing script given for validating translator
[2023-07-28 06:38:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:38:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:38:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:38:09] [comm] Using global sharding
[2023-07-28 06:38:09] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:38:09] [training] Using 1 GPUs
[2023-07-28 06:38:09] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:38:10] Allocating memory for general optimizer shards
[2023-07-28 06:38:10] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:38:10] Loading Adam parameters
[2023-07-28 06:38:10] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:38:10] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:38:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 06:38:10] [data] Restoring the corpus state to epoch 221, batch 6011
[2023-07-28 06:38:10] [data] Shuffling data
[2023-07-28 06:38:10] [data] Done reading 20,192 sentences
[2023-07-28 06:38:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:38:10] Training started
[2023-07-28 06:38:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 06:38:11] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:38:12] Parameter type float16, optimization type float32, casting types true
[2023-07-28 06:39:21] Seen 20,192 samples
[2023-07-28 06:39:21] Starting data epoch 222 in logical epoch 222
[2023-07-28 06:39:21] [data] Shuffling data
[2023-07-28 06:39:21] [data] Done reading 20,192 sentences
[2023-07-28 06:39:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:40:32] Seen 20,192 samples
[2023-07-28 06:40:32] Starting data epoch 223 in logical epoch 223
[2023-07-28 06:40:32] [data] Shuffling data
[2023-07-28 06:40:32] [data] Done reading 20,192 sentences
[2023-07-28 06:40:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:41:47] Seen 20,192 samples
[2023-07-28 06:41:47] Starting data epoch 224 in logical epoch 224
[2023-07-28 06:41:47] [data] Shuffling data
[2023-07-28 06:41:47] [data] Done reading 20,192 sentences
[2023-07-28 06:41:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:43:02] Seen 20,192 samples
[2023-07-28 06:43:02] Starting data epoch 225 in logical epoch 225
[2023-07-28 06:43:02] [data] Shuffling data
[2023-07-28 06:43:02] [data] Done reading 20,192 sentences
[2023-07-28 06:43:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:44:19] Seen 20,192 samples
[2023-07-28 06:44:19] Starting data epoch 226 in logical epoch 226
[2023-07-28 06:44:19] [data] Shuffling data
[2023-07-28 06:44:19] [data] Done reading 20,192 sentences
[2023-07-28 06:44:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:45:36] Seen 20,192 samples
[2023-07-28 06:45:36] Starting data epoch 227 in logical epoch 227
[2023-07-28 06:45:36] [data] Shuffling data
[2023-07-28 06:45:36] [data] Done reading 20,192 sentences
[2023-07-28 06:45:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:46:51] Seen 20,192 samples
[2023-07-28 06:46:51] Starting data epoch 228 in logical epoch 228
[2023-07-28 06:46:51] [data] Shuffling data
[2023-07-28 06:46:51] [data] Done reading 20,192 sentences
[2023-07-28 06:46:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:48:06] Seen 20,192 samples
[2023-07-28 06:48:06] Starting data epoch 229 in logical epoch 229
[2023-07-28 06:48:06] [data] Shuffling data
[2023-07-28 06:48:06] [data] Done reading 20,192 sentences
[2023-07-28 06:48:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:49:22] Seen 20,192 samples
[2023-07-28 06:49:22] Starting data epoch 230 in logical epoch 230
[2023-07-28 06:49:22] [data] Shuffling data
[2023-07-28 06:49:22] [data] Done reading 20,192 sentences
[2023-07-28 06:49:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:50:38] Seen 20,192 samples
[2023-07-28 06:50:38] Starting data epoch 231 in logical epoch 231
[2023-07-28 06:50:38] Training finished
[2023-07-28 06:51:17] [valid] Ep. 231 : Up. 6284 : translation : 0 : new best
[2023-07-28 06:51:17] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:51:19] Saving Adam parameters
[2023-07-28 06:51:19] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 06:51:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:51:26] [marian] Running on node05.datos.cluster.uy as process 4299 with command line:
[2023-07-28 06:51:26] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 240 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 06:51:26] [config] after: 0e
[2023-07-28 06:51:26] [config] after-batches: 0
[2023-07-28 06:51:26] [config] after-epochs: 240
[2023-07-28 06:51:26] [config] all-caps-every: 0
[2023-07-28 06:51:26] [config] allow-unk: false
[2023-07-28 06:51:26] [config] authors: false
[2023-07-28 06:51:26] [config] beam-size: 12
[2023-07-28 06:51:26] [config] bert-class-symbol: "[CLS]"
[2023-07-28 06:51:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 06:51:26] [config] bert-masking-fraction: 0.15
[2023-07-28 06:51:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 06:51:26] [config] bert-train-type-embeddings: true
[2023-07-28 06:51:26] [config] bert-type-vocab-size: 2
[2023-07-28 06:51:26] [config] build-info: ""
[2023-07-28 06:51:26] [config] check-gradient-nan: false
[2023-07-28 06:51:26] [config] check-nan: false
[2023-07-28 06:51:26] [config] cite: false
[2023-07-28 06:51:26] [config] clip-norm: 1
[2023-07-28 06:51:26] [config] cost-scaling:
[2023-07-28 06:51:26] [config]   - 256.f
[2023-07-28 06:51:26] [config]   - 1000
[2023-07-28 06:51:26] [config]   - 2.f
[2023-07-28 06:51:26] [config]   - 256.f
[2023-07-28 06:51:26] [config] cost-type: ce-sum
[2023-07-28 06:51:26] [config] cpu-threads: 0
[2023-07-28 06:51:26] [config] data-threads: 8
[2023-07-28 06:51:26] [config] data-weighting: ""
[2023-07-28 06:51:26] [config] data-weighting-type: sentence
[2023-07-28 06:51:26] [config] dec-cell: gru
[2023-07-28 06:51:26] [config] dec-cell-base-depth: 2
[2023-07-28 06:51:26] [config] dec-cell-high-depth: 1
[2023-07-28 06:51:26] [config] dec-depth: 1
[2023-07-28 06:51:26] [config] devices:
[2023-07-28 06:51:26] [config]   - 0
[2023-07-28 06:51:26] [config] dim-emb: 512
[2023-07-28 06:51:26] [config] dim-rnn: 1024
[2023-07-28 06:51:26] [config] dim-vocabs:
[2023-07-28 06:51:26] [config]   - 16384
[2023-07-28 06:51:26] [config]   - 16384
[2023-07-28 06:51:26] [config] disp-first: 0
[2023-07-28 06:51:26] [config] disp-freq: 1000u
[2023-07-28 06:51:26] [config] disp-label-counts: true
[2023-07-28 06:51:26] [config] dropout-rnn: 0
[2023-07-28 06:51:26] [config] dropout-src: 0
[2023-07-28 06:51:26] [config] dropout-trg: 0
[2023-07-28 06:51:26] [config] dump-config: ""
[2023-07-28 06:51:26] [config] dynamic-gradient-scaling:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] early-stopping: 1000
[2023-07-28 06:51:26] [config] early-stopping-on: first
[2023-07-28 06:51:26] [config] embedding-fix-src: false
[2023-07-28 06:51:26] [config] embedding-fix-trg: false
[2023-07-28 06:51:26] [config] embedding-normalization: false
[2023-07-28 06:51:26] [config] embedding-vectors:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] enc-cell: gru
[2023-07-28 06:51:26] [config] enc-cell-depth: 1
[2023-07-28 06:51:26] [config] enc-depth: 1
[2023-07-28 06:51:26] [config] enc-type: bidirectional
[2023-07-28 06:51:26] [config] english-title-case-every: 0
[2023-07-28 06:51:26] [config] exponential-smoothing: 0
[2023-07-28 06:51:26] [config] factor-weight: 1
[2023-07-28 06:51:26] [config] factors-combine: sum
[2023-07-28 06:51:26] [config] factors-dim-emb: 0
[2023-07-28 06:51:26] [config] gradient-checkpointing: false
[2023-07-28 06:51:26] [config] gradient-norm-average-window: 100
[2023-07-28 06:51:26] [config] guided-alignment: none
[2023-07-28 06:51:26] [config] guided-alignment-cost: mse
[2023-07-28 06:51:26] [config] guided-alignment-weight: 0.1
[2023-07-28 06:51:26] [config] ignore-model-config: false
[2023-07-28 06:51:26] [config] input-types:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] interpolate-env-vars: false
[2023-07-28 06:51:26] [config] keep-best: false
[2023-07-28 06:51:26] [config] label-smoothing: 0
[2023-07-28 06:51:26] [config] layer-normalization: false
[2023-07-28 06:51:26] [config] learn-rate: 0.0001
[2023-07-28 06:51:26] [config] lemma-dependency: ""
[2023-07-28 06:51:26] [config] lemma-dim-emb: 0
[2023-07-28 06:51:26] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 06:51:26] [config] log-level: info
[2023-07-28 06:51:26] [config] log-time-zone: ""
[2023-07-28 06:51:26] [config] logical-epoch:
[2023-07-28 06:51:26] [config]   - 1e
[2023-07-28 06:51:26] [config]   - 0
[2023-07-28 06:51:26] [config] lr-decay: 0
[2023-07-28 06:51:26] [config] lr-decay-freq: 50000
[2023-07-28 06:51:26] [config] lr-decay-inv-sqrt:
[2023-07-28 06:51:26] [config]   - 0
[2023-07-28 06:51:26] [config] lr-decay-repeat-warmup: false
[2023-07-28 06:51:26] [config] lr-decay-reset-optimizer: false
[2023-07-28 06:51:26] [config] lr-decay-start:
[2023-07-28 06:51:26] [config]   - 10
[2023-07-28 06:51:26] [config]   - 1
[2023-07-28 06:51:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 06:51:26] [config] lr-report: false
[2023-07-28 06:51:26] [config] lr-warmup: 0
[2023-07-28 06:51:26] [config] lr-warmup-at-reload: false
[2023-07-28 06:51:26] [config] lr-warmup-cycle: false
[2023-07-28 06:51:26] [config] lr-warmup-start-rate: 0
[2023-07-28 06:51:26] [config] max-length: 50
[2023-07-28 06:51:26] [config] max-length-crop: true
[2023-07-28 06:51:26] [config] max-length-factor: 3
[2023-07-28 06:51:26] [config] maxi-batch: 100
[2023-07-28 06:51:26] [config] maxi-batch-sort: trg
[2023-07-28 06:51:26] [config] mini-batch: 64
[2023-07-28 06:51:26] [config] mini-batch-fit: true
[2023-07-28 06:51:26] [config] mini-batch-fit-step: 10
[2023-07-28 06:51:26] [config] mini-batch-round-up: true
[2023-07-28 06:51:26] [config] mini-batch-track-lr: false
[2023-07-28 06:51:26] [config] mini-batch-warmup: 0
[2023-07-28 06:51:26] [config] mini-batch-words: 0
[2023-07-28 06:51:26] [config] mini-batch-words-ref: 0
[2023-07-28 06:51:26] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:51:26] [config] multi-loss-type: sum
[2023-07-28 06:51:26] [config] n-best: false
[2023-07-28 06:51:26] [config] no-nccl: false
[2023-07-28 06:51:26] [config] no-reload: false
[2023-07-28 06:51:26] [config] no-restore-corpus: false
[2023-07-28 06:51:26] [config] normalize: 0
[2023-07-28 06:51:26] [config] normalize-gradient: false
[2023-07-28 06:51:26] [config] num-devices: 0
[2023-07-28 06:51:26] [config] optimizer: adam
[2023-07-28 06:51:26] [config] optimizer-delay: 1
[2023-07-28 06:51:26] [config] optimizer-params:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] output-omit-bias: false
[2023-07-28 06:51:26] [config] overwrite: true
[2023-07-28 06:51:26] [config] precision:
[2023-07-28 06:51:26] [config]   - float16
[2023-07-28 06:51:26] [config]   - float32
[2023-07-28 06:51:26] [config] pretrained-model: ""
[2023-07-28 06:51:26] [config] quantize-biases: false
[2023-07-28 06:51:26] [config] quantize-bits: 0
[2023-07-28 06:51:26] [config] quantize-log-based: false
[2023-07-28 06:51:26] [config] quantize-optimization-steps: 0
[2023-07-28 06:51:26] [config] quiet: false
[2023-07-28 06:51:26] [config] quiet-translation: true
[2023-07-28 06:51:26] [config] relative-paths: false
[2023-07-28 06:51:26] [config] right-left: false
[2023-07-28 06:51:26] [config] save-freq: 10000u
[2023-07-28 06:51:26] [config] seed: 1234
[2023-07-28 06:51:26] [config] sentencepiece-alphas:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] sentencepiece-max-lines: 2000000
[2023-07-28 06:51:26] [config] sentencepiece-options: ""
[2023-07-28 06:51:26] [config] sharding: global
[2023-07-28 06:51:26] [config] shuffle: data
[2023-07-28 06:51:26] [config] shuffle-in-ram: false
[2023-07-28 06:51:26] [config] sigterm: save-and-exit
[2023-07-28 06:51:26] [config] skip: false
[2023-07-28 06:51:26] [config] sqlite: ""
[2023-07-28 06:51:26] [config] sqlite-drop: false
[2023-07-28 06:51:26] [config] sync-freq: 200u
[2023-07-28 06:51:26] [config] sync-sgd: false
[2023-07-28 06:51:26] [config] tempdir: /tmp
[2023-07-28 06:51:26] [config] tied-embeddings: false
[2023-07-28 06:51:26] [config] tied-embeddings-all: true
[2023-07-28 06:51:26] [config] tied-embeddings-src: false
[2023-07-28 06:51:26] [config] train-embedder-rank:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] train-sets:
[2023-07-28 06:51:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 06:51:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 06:51:26] [config] transformer-aan-activation: swish
[2023-07-28 06:51:26] [config] transformer-aan-depth: 2
[2023-07-28 06:51:26] [config] transformer-aan-nogate: false
[2023-07-28 06:51:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 06:51:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 06:51:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 06:51:26] [config] transformer-depth-scaling: false
[2023-07-28 06:51:26] [config] transformer-dim-aan: 2048
[2023-07-28 06:51:26] [config] transformer-dim-ffn: 2048
[2023-07-28 06:51:26] [config] transformer-dropout: 0
[2023-07-28 06:51:26] [config] transformer-dropout-attention: 0
[2023-07-28 06:51:26] [config] transformer-dropout-ffn: 0
[2023-07-28 06:51:26] [config] transformer-ffn-activation: swish
[2023-07-28 06:51:26] [config] transformer-ffn-depth: 2
[2023-07-28 06:51:26] [config] transformer-guided-alignment-layer: last
[2023-07-28 06:51:26] [config] transformer-heads: 8
[2023-07-28 06:51:26] [config] transformer-no-projection: false
[2023-07-28 06:51:26] [config] transformer-pool: false
[2023-07-28 06:51:26] [config] transformer-postprocess: dan
[2023-07-28 06:51:26] [config] transformer-postprocess-emb: d
[2023-07-28 06:51:26] [config] transformer-postprocess-top: ""
[2023-07-28 06:51:26] [config] transformer-preprocess: ""
[2023-07-28 06:51:26] [config] transformer-tied-layers:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] transformer-train-position-embeddings: false
[2023-07-28 06:51:26] [config] tsv: false
[2023-07-28 06:51:26] [config] tsv-fields: 0
[2023-07-28 06:51:26] [config] type: s2s
[2023-07-28 06:51:26] [config] ulr: false
[2023-07-28 06:51:26] [config] ulr-dim-emb: 0
[2023-07-28 06:51:26] [config] ulr-dropout: 0
[2023-07-28 06:51:26] [config] ulr-keys-vectors: ""
[2023-07-28 06:51:26] [config] ulr-query-vectors: ""
[2023-07-28 06:51:26] [config] ulr-softmax-temperature: 1
[2023-07-28 06:51:26] [config] ulr-trainable-transformation: false
[2023-07-28 06:51:26] [config] unlikelihood-loss: false
[2023-07-28 06:51:26] [config] valid-freq: 50000000
[2023-07-28 06:51:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 06:51:26] [config] valid-max-length: 1000
[2023-07-28 06:51:26] [config] valid-metrics:
[2023-07-28 06:51:26] [config]   - translation
[2023-07-28 06:51:26] [config] valid-mini-batch: 32
[2023-07-28 06:51:26] [config] valid-reset-stalled: false
[2023-07-28 06:51:26] [config] valid-script-args:
[2023-07-28 06:51:26] [config]   []
[2023-07-28 06:51:26] [config] valid-script-path: ""
[2023-07-28 06:51:26] [config] valid-sets:
[2023-07-28 06:51:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 06:51:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 06:51:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 06:51:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:51:26] [config] vocabs:
[2023-07-28 06:51:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:51:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:51:26] [config] word-penalty: 0
[2023-07-28 06:51:26] [config] word-scores: false
[2023-07-28 06:51:26] [config] workspace: 5500
[2023-07-28 06:51:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:51:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:51:26] [training] Using single-device training
[2023-07-28 06:51:26] Synced seed 1234
[2023-07-28 06:51:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:51:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 06:51:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:51:26] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 06:51:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 06:51:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:51:26] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 06:51:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:51:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:51:27] [comm] Using global sharding
[2023-07-28 06:51:27] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:51:27] [training] Using 1 GPUs
[2023-07-28 06:51:27] [logits] Applying loss function for 1 factor(s)
[2023-07-28 06:51:27] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:51:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 06:51:28] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:55:56] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 06:55:56] [valid] No post-processing script given for validating translator
[2023-07-28 06:55:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:55:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:55:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:55:56] [comm] Using global sharding
[2023-07-28 06:55:56] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:55:56] [training] Using 1 GPUs
[2023-07-28 06:55:56] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 06:55:57] Allocating memory for general optimizer shards
[2023-07-28 06:55:57] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:55:57] Loading Adam parameters
[2023-07-28 06:55:57] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:55:58] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:55:58] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 06:55:58] [data] Restoring the corpus state to epoch 231, batch 6284
[2023-07-28 06:55:58] [data] Shuffling data
[2023-07-28 06:55:58] [data] Done reading 20,192 sentences
[2023-07-28 06:55:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:55:58] Training started
[2023-07-28 06:55:58] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 06:55:58] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:56:01] Parameter type float16, optimization type float32, casting types true
[2023-07-28 06:57:08] Seen 20,192 samples
[2023-07-28 06:57:08] Starting data epoch 232 in logical epoch 232
[2023-07-28 06:57:08] [data] Shuffling data
[2023-07-28 06:57:08] [data] Done reading 20,192 sentences
[2023-07-28 06:57:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:58:19] Seen 20,192 samples
[2023-07-28 06:58:19] Starting data epoch 233 in logical epoch 233
[2023-07-28 06:58:19] [data] Shuffling data
[2023-07-28 06:58:19] [data] Done reading 20,192 sentences
[2023-07-28 06:58:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:59:35] Seen 20,192 samples
[2023-07-28 06:59:35] Starting data epoch 234 in logical epoch 234
[2023-07-28 06:59:35] [data] Shuffling data
[2023-07-28 06:59:35] [data] Done reading 20,192 sentences
[2023-07-28 06:59:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:00:51] Seen 20,192 samples
[2023-07-28 07:00:51] Starting data epoch 235 in logical epoch 235
[2023-07-28 07:00:51] [data] Shuffling data
[2023-07-28 07:00:51] [data] Done reading 20,192 sentences
[2023-07-28 07:00:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:02:08] Seen 20,192 samples
[2023-07-28 07:02:08] Starting data epoch 236 in logical epoch 236
[2023-07-28 07:02:08] [data] Shuffling data
[2023-07-28 07:02:08] [data] Done reading 20,192 sentences
[2023-07-28 07:02:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:03:24] Seen 20,192 samples
[2023-07-28 07:03:24] Starting data epoch 237 in logical epoch 237
[2023-07-28 07:03:24] [data] Shuffling data
[2023-07-28 07:03:24] [data] Done reading 20,192 sentences
[2023-07-28 07:03:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:04:39] Seen 20,192 samples
[2023-07-28 07:04:39] Starting data epoch 238 in logical epoch 238
[2023-07-28 07:04:39] [data] Shuffling data
[2023-07-28 07:04:39] [data] Done reading 20,192 sentences
[2023-07-28 07:04:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:05:54] Seen 20,192 samples
[2023-07-28 07:05:54] Starting data epoch 239 in logical epoch 239
[2023-07-28 07:05:54] [data] Shuffling data
[2023-07-28 07:05:54] [data] Done reading 20,192 sentences
[2023-07-28 07:05:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:07:10] Seen 20,192 samples
[2023-07-28 07:07:10] Starting data epoch 240 in logical epoch 240
[2023-07-28 07:07:10] [data] Shuffling data
[2023-07-28 07:07:10] [data] Done reading 20,192 sentences
[2023-07-28 07:07:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:08:26] Seen 20,192 samples
[2023-07-28 07:08:26] Starting data epoch 241 in logical epoch 241
[2023-07-28 07:08:26] Training finished
[2023-07-28 07:09:07] [valid] Ep. 241 : Up. 6556 : translation : 0 : new best
[2023-07-28 07:09:07] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:09:09] Saving Adam parameters
[2023-07-28 07:09:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 07:09:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:09:16] [marian] Running on node05.datos.cluster.uy as process 37394 with command line:
[2023-07-28 07:09:16] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 250 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 07:09:16] [config] after: 0e
[2023-07-28 07:09:16] [config] after-batches: 0
[2023-07-28 07:09:16] [config] after-epochs: 250
[2023-07-28 07:09:16] [config] all-caps-every: 0
[2023-07-28 07:09:16] [config] allow-unk: false
[2023-07-28 07:09:16] [config] authors: false
[2023-07-28 07:09:16] [config] beam-size: 12
[2023-07-28 07:09:16] [config] bert-class-symbol: "[CLS]"
[2023-07-28 07:09:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 07:09:16] [config] bert-masking-fraction: 0.15
[2023-07-28 07:09:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 07:09:16] [config] bert-train-type-embeddings: true
[2023-07-28 07:09:16] [config] bert-type-vocab-size: 2
[2023-07-28 07:09:16] [config] build-info: ""
[2023-07-28 07:09:16] [config] check-gradient-nan: false
[2023-07-28 07:09:16] [config] check-nan: false
[2023-07-28 07:09:16] [config] cite: false
[2023-07-28 07:09:16] [config] clip-norm: 1
[2023-07-28 07:09:16] [config] cost-scaling:
[2023-07-28 07:09:16] [config]   - 256.f
[2023-07-28 07:09:16] [config]   - 1000
[2023-07-28 07:09:16] [config]   - 2.f
[2023-07-28 07:09:16] [config]   - 256.f
[2023-07-28 07:09:16] [config] cost-type: ce-sum
[2023-07-28 07:09:16] [config] cpu-threads: 0
[2023-07-28 07:09:16] [config] data-threads: 8
[2023-07-28 07:09:16] [config] data-weighting: ""
[2023-07-28 07:09:16] [config] data-weighting-type: sentence
[2023-07-28 07:09:16] [config] dec-cell: gru
[2023-07-28 07:09:16] [config] dec-cell-base-depth: 2
[2023-07-28 07:09:16] [config] dec-cell-high-depth: 1
[2023-07-28 07:09:16] [config] dec-depth: 1
[2023-07-28 07:09:16] [config] devices:
[2023-07-28 07:09:16] [config]   - 0
[2023-07-28 07:09:16] [config] dim-emb: 512
[2023-07-28 07:09:16] [config] dim-rnn: 1024
[2023-07-28 07:09:16] [config] dim-vocabs:
[2023-07-28 07:09:16] [config]   - 16384
[2023-07-28 07:09:16] [config]   - 16384
[2023-07-28 07:09:16] [config] disp-first: 0
[2023-07-28 07:09:16] [config] disp-freq: 1000u
[2023-07-28 07:09:16] [config] disp-label-counts: true
[2023-07-28 07:09:16] [config] dropout-rnn: 0
[2023-07-28 07:09:16] [config] dropout-src: 0
[2023-07-28 07:09:16] [config] dropout-trg: 0
[2023-07-28 07:09:16] [config] dump-config: ""
[2023-07-28 07:09:16] [config] dynamic-gradient-scaling:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] early-stopping: 1000
[2023-07-28 07:09:16] [config] early-stopping-on: first
[2023-07-28 07:09:16] [config] embedding-fix-src: false
[2023-07-28 07:09:16] [config] embedding-fix-trg: false
[2023-07-28 07:09:16] [config] embedding-normalization: false
[2023-07-28 07:09:16] [config] embedding-vectors:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] enc-cell: gru
[2023-07-28 07:09:16] [config] enc-cell-depth: 1
[2023-07-28 07:09:16] [config] enc-depth: 1
[2023-07-28 07:09:16] [config] enc-type: bidirectional
[2023-07-28 07:09:16] [config] english-title-case-every: 0
[2023-07-28 07:09:16] [config] exponential-smoothing: 0
[2023-07-28 07:09:16] [config] factor-weight: 1
[2023-07-28 07:09:16] [config] factors-combine: sum
[2023-07-28 07:09:16] [config] factors-dim-emb: 0
[2023-07-28 07:09:16] [config] gradient-checkpointing: false
[2023-07-28 07:09:16] [config] gradient-norm-average-window: 100
[2023-07-28 07:09:16] [config] guided-alignment: none
[2023-07-28 07:09:16] [config] guided-alignment-cost: mse
[2023-07-28 07:09:16] [config] guided-alignment-weight: 0.1
[2023-07-28 07:09:16] [config] ignore-model-config: false
[2023-07-28 07:09:16] [config] input-types:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] interpolate-env-vars: false
[2023-07-28 07:09:16] [config] keep-best: false
[2023-07-28 07:09:16] [config] label-smoothing: 0
[2023-07-28 07:09:16] [config] layer-normalization: false
[2023-07-28 07:09:16] [config] learn-rate: 0.0001
[2023-07-28 07:09:16] [config] lemma-dependency: ""
[2023-07-28 07:09:16] [config] lemma-dim-emb: 0
[2023-07-28 07:09:16] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 07:09:16] [config] log-level: info
[2023-07-28 07:09:16] [config] log-time-zone: ""
[2023-07-28 07:09:16] [config] logical-epoch:
[2023-07-28 07:09:16] [config]   - 1e
[2023-07-28 07:09:16] [config]   - 0
[2023-07-28 07:09:16] [config] lr-decay: 0
[2023-07-28 07:09:16] [config] lr-decay-freq: 50000
[2023-07-28 07:09:16] [config] lr-decay-inv-sqrt:
[2023-07-28 07:09:16] [config]   - 0
[2023-07-28 07:09:16] [config] lr-decay-repeat-warmup: false
[2023-07-28 07:09:16] [config] lr-decay-reset-optimizer: false
[2023-07-28 07:09:16] [config] lr-decay-start:
[2023-07-28 07:09:16] [config]   - 10
[2023-07-28 07:09:16] [config]   - 1
[2023-07-28 07:09:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 07:09:16] [config] lr-report: false
[2023-07-28 07:09:16] [config] lr-warmup: 0
[2023-07-28 07:09:16] [config] lr-warmup-at-reload: false
[2023-07-28 07:09:16] [config] lr-warmup-cycle: false
[2023-07-28 07:09:16] [config] lr-warmup-start-rate: 0
[2023-07-28 07:09:16] [config] max-length: 50
[2023-07-28 07:09:16] [config] max-length-crop: true
[2023-07-28 07:09:16] [config] max-length-factor: 3
[2023-07-28 07:09:16] [config] maxi-batch: 100
[2023-07-28 07:09:16] [config] maxi-batch-sort: trg
[2023-07-28 07:09:16] [config] mini-batch: 64
[2023-07-28 07:09:16] [config] mini-batch-fit: true
[2023-07-28 07:09:16] [config] mini-batch-fit-step: 10
[2023-07-28 07:09:16] [config] mini-batch-round-up: true
[2023-07-28 07:09:16] [config] mini-batch-track-lr: false
[2023-07-28 07:09:16] [config] mini-batch-warmup: 0
[2023-07-28 07:09:16] [config] mini-batch-words: 0
[2023-07-28 07:09:16] [config] mini-batch-words-ref: 0
[2023-07-28 07:09:16] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:09:16] [config] multi-loss-type: sum
[2023-07-28 07:09:16] [config] n-best: false
[2023-07-28 07:09:16] [config] no-nccl: false
[2023-07-28 07:09:16] [config] no-reload: false
[2023-07-28 07:09:16] [config] no-restore-corpus: false
[2023-07-28 07:09:16] [config] normalize: 0
[2023-07-28 07:09:16] [config] normalize-gradient: false
[2023-07-28 07:09:16] [config] num-devices: 0
[2023-07-28 07:09:16] [config] optimizer: adam
[2023-07-28 07:09:16] [config] optimizer-delay: 1
[2023-07-28 07:09:16] [config] optimizer-params:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] output-omit-bias: false
[2023-07-28 07:09:16] [config] overwrite: true
[2023-07-28 07:09:16] [config] precision:
[2023-07-28 07:09:16] [config]   - float16
[2023-07-28 07:09:16] [config]   - float32
[2023-07-28 07:09:16] [config] pretrained-model: ""
[2023-07-28 07:09:16] [config] quantize-biases: false
[2023-07-28 07:09:16] [config] quantize-bits: 0
[2023-07-28 07:09:16] [config] quantize-log-based: false
[2023-07-28 07:09:16] [config] quantize-optimization-steps: 0
[2023-07-28 07:09:16] [config] quiet: false
[2023-07-28 07:09:16] [config] quiet-translation: true
[2023-07-28 07:09:16] [config] relative-paths: false
[2023-07-28 07:09:16] [config] right-left: false
[2023-07-28 07:09:16] [config] save-freq: 10000u
[2023-07-28 07:09:16] [config] seed: 1234
[2023-07-28 07:09:16] [config] sentencepiece-alphas:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] sentencepiece-max-lines: 2000000
[2023-07-28 07:09:16] [config] sentencepiece-options: ""
[2023-07-28 07:09:16] [config] sharding: global
[2023-07-28 07:09:16] [config] shuffle: data
[2023-07-28 07:09:16] [config] shuffle-in-ram: false
[2023-07-28 07:09:16] [config] sigterm: save-and-exit
[2023-07-28 07:09:16] [config] skip: false
[2023-07-28 07:09:16] [config] sqlite: ""
[2023-07-28 07:09:16] [config] sqlite-drop: false
[2023-07-28 07:09:16] [config] sync-freq: 200u
[2023-07-28 07:09:16] [config] sync-sgd: false
[2023-07-28 07:09:16] [config] tempdir: /tmp
[2023-07-28 07:09:16] [config] tied-embeddings: false
[2023-07-28 07:09:16] [config] tied-embeddings-all: true
[2023-07-28 07:09:16] [config] tied-embeddings-src: false
[2023-07-28 07:09:16] [config] train-embedder-rank:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] train-sets:
[2023-07-28 07:09:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 07:09:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 07:09:16] [config] transformer-aan-activation: swish
[2023-07-28 07:09:16] [config] transformer-aan-depth: 2
[2023-07-28 07:09:16] [config] transformer-aan-nogate: false
[2023-07-28 07:09:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 07:09:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 07:09:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 07:09:16] [config] transformer-depth-scaling: false
[2023-07-28 07:09:16] [config] transformer-dim-aan: 2048
[2023-07-28 07:09:16] [config] transformer-dim-ffn: 2048
[2023-07-28 07:09:16] [config] transformer-dropout: 0
[2023-07-28 07:09:16] [config] transformer-dropout-attention: 0
[2023-07-28 07:09:16] [config] transformer-dropout-ffn: 0
[2023-07-28 07:09:16] [config] transformer-ffn-activation: swish
[2023-07-28 07:09:16] [config] transformer-ffn-depth: 2
[2023-07-28 07:09:16] [config] transformer-guided-alignment-layer: last
[2023-07-28 07:09:16] [config] transformer-heads: 8
[2023-07-28 07:09:16] [config] transformer-no-projection: false
[2023-07-28 07:09:16] [config] transformer-pool: false
[2023-07-28 07:09:16] [config] transformer-postprocess: dan
[2023-07-28 07:09:16] [config] transformer-postprocess-emb: d
[2023-07-28 07:09:16] [config] transformer-postprocess-top: ""
[2023-07-28 07:09:16] [config] transformer-preprocess: ""
[2023-07-28 07:09:16] [config] transformer-tied-layers:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] transformer-train-position-embeddings: false
[2023-07-28 07:09:16] [config] tsv: false
[2023-07-28 07:09:16] [config] tsv-fields: 0
[2023-07-28 07:09:16] [config] type: s2s
[2023-07-28 07:09:16] [config] ulr: false
[2023-07-28 07:09:16] [config] ulr-dim-emb: 0
[2023-07-28 07:09:16] [config] ulr-dropout: 0
[2023-07-28 07:09:16] [config] ulr-keys-vectors: ""
[2023-07-28 07:09:16] [config] ulr-query-vectors: ""
[2023-07-28 07:09:16] [config] ulr-softmax-temperature: 1
[2023-07-28 07:09:16] [config] ulr-trainable-transformation: false
[2023-07-28 07:09:16] [config] unlikelihood-loss: false
[2023-07-28 07:09:16] [config] valid-freq: 50000000
[2023-07-28 07:09:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 07:09:16] [config] valid-max-length: 1000
[2023-07-28 07:09:16] [config] valid-metrics:
[2023-07-28 07:09:16] [config]   - translation
[2023-07-28 07:09:16] [config] valid-mini-batch: 32
[2023-07-28 07:09:16] [config] valid-reset-stalled: false
[2023-07-28 07:09:16] [config] valid-script-args:
[2023-07-28 07:09:16] [config]   []
[2023-07-28 07:09:16] [config] valid-script-path: ""
[2023-07-28 07:09:16] [config] valid-sets:
[2023-07-28 07:09:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 07:09:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 07:09:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 07:09:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:09:16] [config] vocabs:
[2023-07-28 07:09:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:09:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:09:16] [config] word-penalty: 0
[2023-07-28 07:09:16] [config] word-scores: false
[2023-07-28 07:09:16] [config] workspace: 5500
[2023-07-28 07:09:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:09:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:09:16] [training] Using single-device training
[2023-07-28 07:09:16] Synced seed 1234
[2023-07-28 07:09:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:09:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 07:09:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:09:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 07:09:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 07:09:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:09:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 07:09:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:09:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:09:17] [comm] Using global sharding
[2023-07-28 07:09:17] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:09:17] [training] Using 1 GPUs
[2023-07-28 07:09:17] [logits] Applying loss function for 1 factor(s)
[2023-07-28 07:09:17] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:09:17] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 07:09:17] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:13:46] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 07:13:46] [valid] No post-processing script given for validating translator
[2023-07-28 07:13:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:13:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:13:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:13:46] [comm] Using global sharding
[2023-07-28 07:13:46] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:13:46] [training] Using 1 GPUs
[2023-07-28 07:13:46] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:13:47] Allocating memory for general optimizer shards
[2023-07-28 07:13:47] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:13:47] Loading Adam parameters
[2023-07-28 07:13:47] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:13:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:13:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 07:13:48] [data] Restoring the corpus state to epoch 241, batch 6556
[2023-07-28 07:13:48] [data] Shuffling data
[2023-07-28 07:13:48] [data] Done reading 20,192 sentences
[2023-07-28 07:13:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:13:48] Training started
[2023-07-28 07:13:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 07:13:48] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:13:52] Parameter type float16, optimization type float32, casting types true
[2023-07-28 07:14:58] Seen 20,192 samples
[2023-07-28 07:14:58] Starting data epoch 242 in logical epoch 242
[2023-07-28 07:14:58] [data] Shuffling data
[2023-07-28 07:14:58] [data] Done reading 20,192 sentences
[2023-07-28 07:14:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:16:09] Seen 20,192 samples
[2023-07-28 07:16:09] Starting data epoch 243 in logical epoch 243
[2023-07-28 07:16:09] [data] Shuffling data
[2023-07-28 07:16:09] [data] Done reading 20,192 sentences
[2023-07-28 07:16:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:17:22] Seen 20,192 samples
[2023-07-28 07:17:22] Starting data epoch 244 in logical epoch 244
[2023-07-28 07:17:22] [data] Shuffling data
[2023-07-28 07:17:22] [data] Done reading 20,192 sentences
[2023-07-28 07:17:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:18:37] Seen 20,192 samples
[2023-07-28 07:18:37] Starting data epoch 245 in logical epoch 245
[2023-07-28 07:18:37] [data] Shuffling data
[2023-07-28 07:18:37] [data] Done reading 20,192 sentences
[2023-07-28 07:18:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:19:51] Seen 20,192 samples
[2023-07-28 07:19:51] Starting data epoch 246 in logical epoch 246
[2023-07-28 07:19:51] [data] Shuffling data
[2023-07-28 07:19:51] [data] Done reading 20,192 sentences
[2023-07-28 07:19:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:21:04] Seen 20,192 samples
[2023-07-28 07:21:04] Starting data epoch 247 in logical epoch 247
[2023-07-28 07:21:04] [data] Shuffling data
[2023-07-28 07:21:05] [data] Done reading 20,192 sentences
[2023-07-28 07:21:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:22:20] Seen 20,192 samples
[2023-07-28 07:22:20] Starting data epoch 248 in logical epoch 248
[2023-07-28 07:22:20] [data] Shuffling data
[2023-07-28 07:22:20] [data] Done reading 20,192 sentences
[2023-07-28 07:22:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:23:36] Seen 20,192 samples
[2023-07-28 07:23:36] Starting data epoch 249 in logical epoch 249
[2023-07-28 07:23:36] [data] Shuffling data
[2023-07-28 07:23:36] [data] Done reading 20,192 sentences
[2023-07-28 07:23:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:24:51] Seen 20,192 samples
[2023-07-28 07:24:51] Starting data epoch 250 in logical epoch 250
[2023-07-28 07:24:51] [data] Shuffling data
[2023-07-28 07:24:51] [data] Done reading 20,192 sentences
[2023-07-28 07:24:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:26:06] Seen 20,192 samples
[2023-07-28 07:26:06] Starting data epoch 251 in logical epoch 251
[2023-07-28 07:26:06] Training finished
[2023-07-28 07:26:49] [valid] Ep. 251 : Up. 6827 : translation : 0 : new best
[2023-07-28 07:26:49] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:26:51] Saving Adam parameters
[2023-07-28 07:26:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 07:26:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:26:58] [marian] Running on node05.datos.cluster.uy as process 22480 with command line:
[2023-07-28 07:26:58] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 260 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 07:26:58] [config] after: 0e
[2023-07-28 07:26:58] [config] after-batches: 0
[2023-07-28 07:26:58] [config] after-epochs: 260
[2023-07-28 07:26:58] [config] all-caps-every: 0
[2023-07-28 07:26:58] [config] allow-unk: false
[2023-07-28 07:26:58] [config] authors: false
[2023-07-28 07:26:58] [config] beam-size: 12
[2023-07-28 07:26:58] [config] bert-class-symbol: "[CLS]"
[2023-07-28 07:26:58] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 07:26:58] [config] bert-masking-fraction: 0.15
[2023-07-28 07:26:58] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 07:26:58] [config] bert-train-type-embeddings: true
[2023-07-28 07:26:58] [config] bert-type-vocab-size: 2
[2023-07-28 07:26:58] [config] build-info: ""
[2023-07-28 07:26:58] [config] check-gradient-nan: false
[2023-07-28 07:26:58] [config] check-nan: false
[2023-07-28 07:26:58] [config] cite: false
[2023-07-28 07:26:58] [config] clip-norm: 1
[2023-07-28 07:26:58] [config] cost-scaling:
[2023-07-28 07:26:58] [config]   - 256.f
[2023-07-28 07:26:58] [config]   - 1000
[2023-07-28 07:26:58] [config]   - 2.f
[2023-07-28 07:26:58] [config]   - 256.f
[2023-07-28 07:26:58] [config] cost-type: ce-sum
[2023-07-28 07:26:58] [config] cpu-threads: 0
[2023-07-28 07:26:58] [config] data-threads: 8
[2023-07-28 07:26:58] [config] data-weighting: ""
[2023-07-28 07:26:58] [config] data-weighting-type: sentence
[2023-07-28 07:26:58] [config] dec-cell: gru
[2023-07-28 07:26:58] [config] dec-cell-base-depth: 2
[2023-07-28 07:26:58] [config] dec-cell-high-depth: 1
[2023-07-28 07:26:58] [config] dec-depth: 1
[2023-07-28 07:26:58] [config] devices:
[2023-07-28 07:26:58] [config]   - 0
[2023-07-28 07:26:58] [config] dim-emb: 512
[2023-07-28 07:26:58] [config] dim-rnn: 1024
[2023-07-28 07:26:58] [config] dim-vocabs:
[2023-07-28 07:26:58] [config]   - 16384
[2023-07-28 07:26:58] [config]   - 16384
[2023-07-28 07:26:58] [config] disp-first: 0
[2023-07-28 07:26:58] [config] disp-freq: 1000u
[2023-07-28 07:26:58] [config] disp-label-counts: true
[2023-07-28 07:26:58] [config] dropout-rnn: 0
[2023-07-28 07:26:58] [config] dropout-src: 0
[2023-07-28 07:26:58] [config] dropout-trg: 0
[2023-07-28 07:26:58] [config] dump-config: ""
[2023-07-28 07:26:58] [config] dynamic-gradient-scaling:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] early-stopping: 1000
[2023-07-28 07:26:58] [config] early-stopping-on: first
[2023-07-28 07:26:58] [config] embedding-fix-src: false
[2023-07-28 07:26:58] [config] embedding-fix-trg: false
[2023-07-28 07:26:58] [config] embedding-normalization: false
[2023-07-28 07:26:58] [config] embedding-vectors:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] enc-cell: gru
[2023-07-28 07:26:58] [config] enc-cell-depth: 1
[2023-07-28 07:26:58] [config] enc-depth: 1
[2023-07-28 07:26:58] [config] enc-type: bidirectional
[2023-07-28 07:26:58] [config] english-title-case-every: 0
[2023-07-28 07:26:58] [config] exponential-smoothing: 0
[2023-07-28 07:26:58] [config] factor-weight: 1
[2023-07-28 07:26:58] [config] factors-combine: sum
[2023-07-28 07:26:58] [config] factors-dim-emb: 0
[2023-07-28 07:26:58] [config] gradient-checkpointing: false
[2023-07-28 07:26:58] [config] gradient-norm-average-window: 100
[2023-07-28 07:26:58] [config] guided-alignment: none
[2023-07-28 07:26:58] [config] guided-alignment-cost: mse
[2023-07-28 07:26:58] [config] guided-alignment-weight: 0.1
[2023-07-28 07:26:58] [config] ignore-model-config: false
[2023-07-28 07:26:58] [config] input-types:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] interpolate-env-vars: false
[2023-07-28 07:26:58] [config] keep-best: false
[2023-07-28 07:26:58] [config] label-smoothing: 0
[2023-07-28 07:26:58] [config] layer-normalization: false
[2023-07-28 07:26:58] [config] learn-rate: 0.0001
[2023-07-28 07:26:58] [config] lemma-dependency: ""
[2023-07-28 07:26:58] [config] lemma-dim-emb: 0
[2023-07-28 07:26:58] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 07:26:58] [config] log-level: info
[2023-07-28 07:26:58] [config] log-time-zone: ""
[2023-07-28 07:26:58] [config] logical-epoch:
[2023-07-28 07:26:58] [config]   - 1e
[2023-07-28 07:26:58] [config]   - 0
[2023-07-28 07:26:58] [config] lr-decay: 0
[2023-07-28 07:26:58] [config] lr-decay-freq: 50000
[2023-07-28 07:26:58] [config] lr-decay-inv-sqrt:
[2023-07-28 07:26:58] [config]   - 0
[2023-07-28 07:26:58] [config] lr-decay-repeat-warmup: false
[2023-07-28 07:26:58] [config] lr-decay-reset-optimizer: false
[2023-07-28 07:26:58] [config] lr-decay-start:
[2023-07-28 07:26:58] [config]   - 10
[2023-07-28 07:26:58] [config]   - 1
[2023-07-28 07:26:58] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 07:26:58] [config] lr-report: false
[2023-07-28 07:26:58] [config] lr-warmup: 0
[2023-07-28 07:26:58] [config] lr-warmup-at-reload: false
[2023-07-28 07:26:58] [config] lr-warmup-cycle: false
[2023-07-28 07:26:58] [config] lr-warmup-start-rate: 0
[2023-07-28 07:26:58] [config] max-length: 50
[2023-07-28 07:26:58] [config] max-length-crop: true
[2023-07-28 07:26:58] [config] max-length-factor: 3
[2023-07-28 07:26:58] [config] maxi-batch: 100
[2023-07-28 07:26:58] [config] maxi-batch-sort: trg
[2023-07-28 07:26:58] [config] mini-batch: 64
[2023-07-28 07:26:58] [config] mini-batch-fit: true
[2023-07-28 07:26:58] [config] mini-batch-fit-step: 10
[2023-07-28 07:26:58] [config] mini-batch-round-up: true
[2023-07-28 07:26:58] [config] mini-batch-track-lr: false
[2023-07-28 07:26:58] [config] mini-batch-warmup: 0
[2023-07-28 07:26:58] [config] mini-batch-words: 0
[2023-07-28 07:26:58] [config] mini-batch-words-ref: 0
[2023-07-28 07:26:58] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:26:58] [config] multi-loss-type: sum
[2023-07-28 07:26:58] [config] n-best: false
[2023-07-28 07:26:58] [config] no-nccl: false
[2023-07-28 07:26:58] [config] no-reload: false
[2023-07-28 07:26:58] [config] no-restore-corpus: false
[2023-07-28 07:26:58] [config] normalize: 0
[2023-07-28 07:26:58] [config] normalize-gradient: false
[2023-07-28 07:26:58] [config] num-devices: 0
[2023-07-28 07:26:58] [config] optimizer: adam
[2023-07-28 07:26:58] [config] optimizer-delay: 1
[2023-07-28 07:26:58] [config] optimizer-params:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] output-omit-bias: false
[2023-07-28 07:26:58] [config] overwrite: true
[2023-07-28 07:26:58] [config] precision:
[2023-07-28 07:26:58] [config]   - float16
[2023-07-28 07:26:58] [config]   - float32
[2023-07-28 07:26:58] [config] pretrained-model: ""
[2023-07-28 07:26:58] [config] quantize-biases: false
[2023-07-28 07:26:58] [config] quantize-bits: 0
[2023-07-28 07:26:58] [config] quantize-log-based: false
[2023-07-28 07:26:58] [config] quantize-optimization-steps: 0
[2023-07-28 07:26:58] [config] quiet: false
[2023-07-28 07:26:58] [config] quiet-translation: true
[2023-07-28 07:26:58] [config] relative-paths: false
[2023-07-28 07:26:58] [config] right-left: false
[2023-07-28 07:26:58] [config] save-freq: 10000u
[2023-07-28 07:26:58] [config] seed: 1234
[2023-07-28 07:26:58] [config] sentencepiece-alphas:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] sentencepiece-max-lines: 2000000
[2023-07-28 07:26:58] [config] sentencepiece-options: ""
[2023-07-28 07:26:58] [config] sharding: global
[2023-07-28 07:26:58] [config] shuffle: data
[2023-07-28 07:26:58] [config] shuffle-in-ram: false
[2023-07-28 07:26:58] [config] sigterm: save-and-exit
[2023-07-28 07:26:58] [config] skip: false
[2023-07-28 07:26:58] [config] sqlite: ""
[2023-07-28 07:26:58] [config] sqlite-drop: false
[2023-07-28 07:26:58] [config] sync-freq: 200u
[2023-07-28 07:26:58] [config] sync-sgd: false
[2023-07-28 07:26:58] [config] tempdir: /tmp
[2023-07-28 07:26:58] [config] tied-embeddings: false
[2023-07-28 07:26:58] [config] tied-embeddings-all: true
[2023-07-28 07:26:58] [config] tied-embeddings-src: false
[2023-07-28 07:26:58] [config] train-embedder-rank:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] train-sets:
[2023-07-28 07:26:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 07:26:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 07:26:58] [config] transformer-aan-activation: swish
[2023-07-28 07:26:58] [config] transformer-aan-depth: 2
[2023-07-28 07:26:58] [config] transformer-aan-nogate: false
[2023-07-28 07:26:58] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 07:26:58] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 07:26:58] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 07:26:58] [config] transformer-depth-scaling: false
[2023-07-28 07:26:58] [config] transformer-dim-aan: 2048
[2023-07-28 07:26:58] [config] transformer-dim-ffn: 2048
[2023-07-28 07:26:58] [config] transformer-dropout: 0
[2023-07-28 07:26:58] [config] transformer-dropout-attention: 0
[2023-07-28 07:26:58] [config] transformer-dropout-ffn: 0
[2023-07-28 07:26:58] [config] transformer-ffn-activation: swish
[2023-07-28 07:26:58] [config] transformer-ffn-depth: 2
[2023-07-28 07:26:58] [config] transformer-guided-alignment-layer: last
[2023-07-28 07:26:58] [config] transformer-heads: 8
[2023-07-28 07:26:58] [config] transformer-no-projection: false
[2023-07-28 07:26:58] [config] transformer-pool: false
[2023-07-28 07:26:58] [config] transformer-postprocess: dan
[2023-07-28 07:26:58] [config] transformer-postprocess-emb: d
[2023-07-28 07:26:58] [config] transformer-postprocess-top: ""
[2023-07-28 07:26:58] [config] transformer-preprocess: ""
[2023-07-28 07:26:58] [config] transformer-tied-layers:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] transformer-train-position-embeddings: false
[2023-07-28 07:26:58] [config] tsv: false
[2023-07-28 07:26:58] [config] tsv-fields: 0
[2023-07-28 07:26:58] [config] type: s2s
[2023-07-28 07:26:58] [config] ulr: false
[2023-07-28 07:26:58] [config] ulr-dim-emb: 0
[2023-07-28 07:26:58] [config] ulr-dropout: 0
[2023-07-28 07:26:58] [config] ulr-keys-vectors: ""
[2023-07-28 07:26:58] [config] ulr-query-vectors: ""
[2023-07-28 07:26:58] [config] ulr-softmax-temperature: 1
[2023-07-28 07:26:58] [config] ulr-trainable-transformation: false
[2023-07-28 07:26:58] [config] unlikelihood-loss: false
[2023-07-28 07:26:58] [config] valid-freq: 50000000
[2023-07-28 07:26:58] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 07:26:58] [config] valid-max-length: 1000
[2023-07-28 07:26:58] [config] valid-metrics:
[2023-07-28 07:26:58] [config]   - translation
[2023-07-28 07:26:58] [config] valid-mini-batch: 32
[2023-07-28 07:26:58] [config] valid-reset-stalled: false
[2023-07-28 07:26:58] [config] valid-script-args:
[2023-07-28 07:26:58] [config]   []
[2023-07-28 07:26:58] [config] valid-script-path: ""
[2023-07-28 07:26:58] [config] valid-sets:
[2023-07-28 07:26:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 07:26:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 07:26:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 07:26:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:26:58] [config] vocabs:
[2023-07-28 07:26:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:26:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:26:58] [config] word-penalty: 0
[2023-07-28 07:26:58] [config] word-scores: false
[2023-07-28 07:26:58] [config] workspace: 5500
[2023-07-28 07:26:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:26:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:26:58] [training] Using single-device training
[2023-07-28 07:26:58] Synced seed 1234
[2023-07-28 07:26:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:26:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 07:26:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:26:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 07:26:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 07:26:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:26:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 07:26:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:26:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:26:59] [comm] Using global sharding
[2023-07-28 07:26:59] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:26:59] [training] Using 1 GPUs
[2023-07-28 07:26:59] [logits] Applying loss function for 1 factor(s)
[2023-07-28 07:26:59] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:27:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 07:27:00] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:31:31] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 07:31:31] [valid] No post-processing script given for validating translator
[2023-07-28 07:31:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:31:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:31:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:31:31] [comm] Using global sharding
[2023-07-28 07:31:31] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:31:31] [training] Using 1 GPUs
[2023-07-28 07:31:31] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:31:32] Allocating memory for general optimizer shards
[2023-07-28 07:31:32] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:31:32] Loading Adam parameters
[2023-07-28 07:31:32] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:31:32] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:31:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 07:31:33] [data] Restoring the corpus state to epoch 251, batch 6827
[2023-07-28 07:31:33] [data] Shuffling data
[2023-07-28 07:31:33] [data] Done reading 20,192 sentences
[2023-07-28 07:31:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:31:33] Training started
[2023-07-28 07:31:33] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 07:31:33] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:31:35] Parameter type float16, optimization type float32, casting types true
[2023-07-28 07:32:41] Seen 20,192 samples
[2023-07-28 07:32:41] Starting data epoch 252 in logical epoch 252
[2023-07-28 07:32:41] [data] Shuffling data
[2023-07-28 07:32:41] [data] Done reading 20,192 sentences
[2023-07-28 07:32:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:33:51] Seen 20,192 samples
[2023-07-28 07:33:51] Starting data epoch 253 in logical epoch 253
[2023-07-28 07:33:51] [data] Shuffling data
[2023-07-28 07:33:52] [data] Done reading 20,192 sentences
[2023-07-28 07:33:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:35:03] Seen 20,192 samples
[2023-07-28 07:35:03] Starting data epoch 254 in logical epoch 254
[2023-07-28 07:35:03] [data] Shuffling data
[2023-07-28 07:35:03] [data] Done reading 20,192 sentences
[2023-07-28 07:35:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:36:16] Seen 20,192 samples
[2023-07-28 07:36:16] Starting data epoch 255 in logical epoch 255
[2023-07-28 07:36:16] [data] Shuffling data
[2023-07-28 07:36:16] [data] Done reading 20,192 sentences
[2023-07-28 07:36:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:37:30] Seen 20,192 samples
[2023-07-28 07:37:30] Starting data epoch 256 in logical epoch 256
[2023-07-28 07:37:30] [data] Shuffling data
[2023-07-28 07:37:30] [data] Done reading 20,192 sentences
[2023-07-28 07:37:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:38:45] Seen 20,192 samples
[2023-07-28 07:38:45] Starting data epoch 257 in logical epoch 257
[2023-07-28 07:38:45] [data] Shuffling data
[2023-07-28 07:38:45] [data] Done reading 20,192 sentences
[2023-07-28 07:38:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:39:18] Ep. 257 : Up. 7000 : Sen. 8,744 : Cost 2.98418069 * 20,883,842 @ 12,614 after 145,430,984 : Time 466.87s : 44731.97 words/s : gNorm 1.7618
[2023-07-28 07:40:00] Seen 20,192 samples
[2023-07-28 07:40:00] Starting data epoch 258 in logical epoch 258
[2023-07-28 07:40:00] [data] Shuffling data
[2023-07-28 07:40:00] [data] Done reading 20,192 sentences
[2023-07-28 07:40:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:41:14] Seen 20,192 samples
[2023-07-28 07:41:14] Starting data epoch 259 in logical epoch 259
[2023-07-28 07:41:14] [data] Shuffling data
[2023-07-28 07:41:14] [data] Done reading 20,192 sentences
[2023-07-28 07:41:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:42:30] Seen 20,192 samples
[2023-07-28 07:42:30] Starting data epoch 260 in logical epoch 260
[2023-07-28 07:42:30] [data] Shuffling data
[2023-07-28 07:42:30] [data] Done reading 20,192 sentences
[2023-07-28 07:42:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:43:46] Seen 20,192 samples
[2023-07-28 07:43:46] Starting data epoch 261 in logical epoch 261
[2023-07-28 07:43:46] Training finished
[2023-07-28 07:44:27] [valid] Ep. 261 : Up. 7098 : translation : 0 : new best
[2023-07-28 07:44:27] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:44:29] Saving Adam parameters
[2023-07-28 07:44:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 07:44:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:44:37] [marian] Running on node05.datos.cluster.uy as process 23449 with command line:
[2023-07-28 07:44:37] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 270 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 07:44:37] [config] after: 0e
[2023-07-28 07:44:37] [config] after-batches: 0
[2023-07-28 07:44:37] [config] after-epochs: 270
[2023-07-28 07:44:37] [config] all-caps-every: 0
[2023-07-28 07:44:37] [config] allow-unk: false
[2023-07-28 07:44:37] [config] authors: false
[2023-07-28 07:44:37] [config] beam-size: 12
[2023-07-28 07:44:37] [config] bert-class-symbol: "[CLS]"
[2023-07-28 07:44:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 07:44:37] [config] bert-masking-fraction: 0.15
[2023-07-28 07:44:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 07:44:37] [config] bert-train-type-embeddings: true
[2023-07-28 07:44:37] [config] bert-type-vocab-size: 2
[2023-07-28 07:44:37] [config] build-info: ""
[2023-07-28 07:44:37] [config] check-gradient-nan: false
[2023-07-28 07:44:37] [config] check-nan: false
[2023-07-28 07:44:37] [config] cite: false
[2023-07-28 07:44:37] [config] clip-norm: 1
[2023-07-28 07:44:37] [config] cost-scaling:
[2023-07-28 07:44:37] [config]   - 256.f
[2023-07-28 07:44:37] [config]   - 1000
[2023-07-28 07:44:37] [config]   - 2.f
[2023-07-28 07:44:37] [config]   - 256.f
[2023-07-28 07:44:37] [config] cost-type: ce-sum
[2023-07-28 07:44:37] [config] cpu-threads: 0
[2023-07-28 07:44:37] [config] data-threads: 8
[2023-07-28 07:44:37] [config] data-weighting: ""
[2023-07-28 07:44:37] [config] data-weighting-type: sentence
[2023-07-28 07:44:37] [config] dec-cell: gru
[2023-07-28 07:44:37] [config] dec-cell-base-depth: 2
[2023-07-28 07:44:37] [config] dec-cell-high-depth: 1
[2023-07-28 07:44:37] [config] dec-depth: 1
[2023-07-28 07:44:37] [config] devices:
[2023-07-28 07:44:37] [config]   - 0
[2023-07-28 07:44:37] [config] dim-emb: 512
[2023-07-28 07:44:37] [config] dim-rnn: 1024
[2023-07-28 07:44:37] [config] dim-vocabs:
[2023-07-28 07:44:37] [config]   - 16384
[2023-07-28 07:44:37] [config]   - 16384
[2023-07-28 07:44:37] [config] disp-first: 0
[2023-07-28 07:44:37] [config] disp-freq: 1000u
[2023-07-28 07:44:37] [config] disp-label-counts: true
[2023-07-28 07:44:37] [config] dropout-rnn: 0
[2023-07-28 07:44:37] [config] dropout-src: 0
[2023-07-28 07:44:37] [config] dropout-trg: 0
[2023-07-28 07:44:37] [config] dump-config: ""
[2023-07-28 07:44:37] [config] dynamic-gradient-scaling:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] early-stopping: 1000
[2023-07-28 07:44:37] [config] early-stopping-on: first
[2023-07-28 07:44:37] [config] embedding-fix-src: false
[2023-07-28 07:44:37] [config] embedding-fix-trg: false
[2023-07-28 07:44:37] [config] embedding-normalization: false
[2023-07-28 07:44:37] [config] embedding-vectors:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] enc-cell: gru
[2023-07-28 07:44:37] [config] enc-cell-depth: 1
[2023-07-28 07:44:37] [config] enc-depth: 1
[2023-07-28 07:44:37] [config] enc-type: bidirectional
[2023-07-28 07:44:37] [config] english-title-case-every: 0
[2023-07-28 07:44:37] [config] exponential-smoothing: 0
[2023-07-28 07:44:37] [config] factor-weight: 1
[2023-07-28 07:44:37] [config] factors-combine: sum
[2023-07-28 07:44:37] [config] factors-dim-emb: 0
[2023-07-28 07:44:37] [config] gradient-checkpointing: false
[2023-07-28 07:44:37] [config] gradient-norm-average-window: 100
[2023-07-28 07:44:37] [config] guided-alignment: none
[2023-07-28 07:44:37] [config] guided-alignment-cost: mse
[2023-07-28 07:44:37] [config] guided-alignment-weight: 0.1
[2023-07-28 07:44:37] [config] ignore-model-config: false
[2023-07-28 07:44:37] [config] input-types:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] interpolate-env-vars: false
[2023-07-28 07:44:37] [config] keep-best: false
[2023-07-28 07:44:37] [config] label-smoothing: 0
[2023-07-28 07:44:37] [config] layer-normalization: false
[2023-07-28 07:44:37] [config] learn-rate: 0.0001
[2023-07-28 07:44:37] [config] lemma-dependency: ""
[2023-07-28 07:44:37] [config] lemma-dim-emb: 0
[2023-07-28 07:44:37] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 07:44:37] [config] log-level: info
[2023-07-28 07:44:37] [config] log-time-zone: ""
[2023-07-28 07:44:37] [config] logical-epoch:
[2023-07-28 07:44:37] [config]   - 1e
[2023-07-28 07:44:37] [config]   - 0
[2023-07-28 07:44:37] [config] lr-decay: 0
[2023-07-28 07:44:37] [config] lr-decay-freq: 50000
[2023-07-28 07:44:37] [config] lr-decay-inv-sqrt:
[2023-07-28 07:44:37] [config]   - 0
[2023-07-28 07:44:37] [config] lr-decay-repeat-warmup: false
[2023-07-28 07:44:37] [config] lr-decay-reset-optimizer: false
[2023-07-28 07:44:37] [config] lr-decay-start:
[2023-07-28 07:44:37] [config]   - 10
[2023-07-28 07:44:37] [config]   - 1
[2023-07-28 07:44:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 07:44:37] [config] lr-report: false
[2023-07-28 07:44:37] [config] lr-warmup: 0
[2023-07-28 07:44:37] [config] lr-warmup-at-reload: false
[2023-07-28 07:44:37] [config] lr-warmup-cycle: false
[2023-07-28 07:44:37] [config] lr-warmup-start-rate: 0
[2023-07-28 07:44:37] [config] max-length: 50
[2023-07-28 07:44:37] [config] max-length-crop: true
[2023-07-28 07:44:37] [config] max-length-factor: 3
[2023-07-28 07:44:37] [config] maxi-batch: 100
[2023-07-28 07:44:37] [config] maxi-batch-sort: trg
[2023-07-28 07:44:37] [config] mini-batch: 64
[2023-07-28 07:44:37] [config] mini-batch-fit: true
[2023-07-28 07:44:37] [config] mini-batch-fit-step: 10
[2023-07-28 07:44:37] [config] mini-batch-round-up: true
[2023-07-28 07:44:37] [config] mini-batch-track-lr: false
[2023-07-28 07:44:37] [config] mini-batch-warmup: 0
[2023-07-28 07:44:37] [config] mini-batch-words: 0
[2023-07-28 07:44:37] [config] mini-batch-words-ref: 0
[2023-07-28 07:44:37] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:44:37] [config] multi-loss-type: sum
[2023-07-28 07:44:37] [config] n-best: false
[2023-07-28 07:44:37] [config] no-nccl: false
[2023-07-28 07:44:37] [config] no-reload: false
[2023-07-28 07:44:37] [config] no-restore-corpus: false
[2023-07-28 07:44:37] [config] normalize: 0
[2023-07-28 07:44:37] [config] normalize-gradient: false
[2023-07-28 07:44:37] [config] num-devices: 0
[2023-07-28 07:44:37] [config] optimizer: adam
[2023-07-28 07:44:37] [config] optimizer-delay: 1
[2023-07-28 07:44:37] [config] optimizer-params:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] output-omit-bias: false
[2023-07-28 07:44:37] [config] overwrite: true
[2023-07-28 07:44:37] [config] precision:
[2023-07-28 07:44:37] [config]   - float16
[2023-07-28 07:44:37] [config]   - float32
[2023-07-28 07:44:37] [config] pretrained-model: ""
[2023-07-28 07:44:37] [config] quantize-biases: false
[2023-07-28 07:44:37] [config] quantize-bits: 0
[2023-07-28 07:44:37] [config] quantize-log-based: false
[2023-07-28 07:44:37] [config] quantize-optimization-steps: 0
[2023-07-28 07:44:37] [config] quiet: false
[2023-07-28 07:44:37] [config] quiet-translation: true
[2023-07-28 07:44:37] [config] relative-paths: false
[2023-07-28 07:44:37] [config] right-left: false
[2023-07-28 07:44:37] [config] save-freq: 10000u
[2023-07-28 07:44:37] [config] seed: 1234
[2023-07-28 07:44:37] [config] sentencepiece-alphas:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] sentencepiece-max-lines: 2000000
[2023-07-28 07:44:37] [config] sentencepiece-options: ""
[2023-07-28 07:44:37] [config] sharding: global
[2023-07-28 07:44:37] [config] shuffle: data
[2023-07-28 07:44:37] [config] shuffle-in-ram: false
[2023-07-28 07:44:37] [config] sigterm: save-and-exit
[2023-07-28 07:44:37] [config] skip: false
[2023-07-28 07:44:37] [config] sqlite: ""
[2023-07-28 07:44:37] [config] sqlite-drop: false
[2023-07-28 07:44:37] [config] sync-freq: 200u
[2023-07-28 07:44:37] [config] sync-sgd: false
[2023-07-28 07:44:37] [config] tempdir: /tmp
[2023-07-28 07:44:37] [config] tied-embeddings: false
[2023-07-28 07:44:37] [config] tied-embeddings-all: true
[2023-07-28 07:44:37] [config] tied-embeddings-src: false
[2023-07-28 07:44:37] [config] train-embedder-rank:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] train-sets:
[2023-07-28 07:44:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 07:44:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 07:44:37] [config] transformer-aan-activation: swish
[2023-07-28 07:44:37] [config] transformer-aan-depth: 2
[2023-07-28 07:44:37] [config] transformer-aan-nogate: false
[2023-07-28 07:44:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 07:44:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 07:44:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 07:44:37] [config] transformer-depth-scaling: false
[2023-07-28 07:44:37] [config] transformer-dim-aan: 2048
[2023-07-28 07:44:37] [config] transformer-dim-ffn: 2048
[2023-07-28 07:44:37] [config] transformer-dropout: 0
[2023-07-28 07:44:37] [config] transformer-dropout-attention: 0
[2023-07-28 07:44:37] [config] transformer-dropout-ffn: 0
[2023-07-28 07:44:37] [config] transformer-ffn-activation: swish
[2023-07-28 07:44:37] [config] transformer-ffn-depth: 2
[2023-07-28 07:44:37] [config] transformer-guided-alignment-layer: last
[2023-07-28 07:44:37] [config] transformer-heads: 8
[2023-07-28 07:44:37] [config] transformer-no-projection: false
[2023-07-28 07:44:37] [config] transformer-pool: false
[2023-07-28 07:44:37] [config] transformer-postprocess: dan
[2023-07-28 07:44:37] [config] transformer-postprocess-emb: d
[2023-07-28 07:44:37] [config] transformer-postprocess-top: ""
[2023-07-28 07:44:37] [config] transformer-preprocess: ""
[2023-07-28 07:44:37] [config] transformer-tied-layers:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] transformer-train-position-embeddings: false
[2023-07-28 07:44:37] [config] tsv: false
[2023-07-28 07:44:37] [config] tsv-fields: 0
[2023-07-28 07:44:37] [config] type: s2s
[2023-07-28 07:44:37] [config] ulr: false
[2023-07-28 07:44:37] [config] ulr-dim-emb: 0
[2023-07-28 07:44:37] [config] ulr-dropout: 0
[2023-07-28 07:44:37] [config] ulr-keys-vectors: ""
[2023-07-28 07:44:37] [config] ulr-query-vectors: ""
[2023-07-28 07:44:37] [config] ulr-softmax-temperature: 1
[2023-07-28 07:44:37] [config] ulr-trainable-transformation: false
[2023-07-28 07:44:37] [config] unlikelihood-loss: false
[2023-07-28 07:44:37] [config] valid-freq: 50000000
[2023-07-28 07:44:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 07:44:37] [config] valid-max-length: 1000
[2023-07-28 07:44:37] [config] valid-metrics:
[2023-07-28 07:44:37] [config]   - translation
[2023-07-28 07:44:37] [config] valid-mini-batch: 32
[2023-07-28 07:44:37] [config] valid-reset-stalled: false
[2023-07-28 07:44:37] [config] valid-script-args:
[2023-07-28 07:44:37] [config]   []
[2023-07-28 07:44:37] [config] valid-script-path: ""
[2023-07-28 07:44:37] [config] valid-sets:
[2023-07-28 07:44:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 07:44:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 07:44:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 07:44:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:44:37] [config] vocabs:
[2023-07-28 07:44:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:44:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:44:37] [config] word-penalty: 0
[2023-07-28 07:44:37] [config] word-scores: false
[2023-07-28 07:44:37] [config] workspace: 5500
[2023-07-28 07:44:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:44:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:44:37] [training] Using single-device training
[2023-07-28 07:44:37] Synced seed 1234
[2023-07-28 07:44:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:44:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 07:44:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:44:37] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 07:44:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 07:44:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:44:37] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 07:44:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:44:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:44:38] [comm] Using global sharding
[2023-07-28 07:44:38] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:44:38] [training] Using 1 GPUs
[2023-07-28 07:44:38] [logits] Applying loss function for 1 factor(s)
[2023-07-28 07:44:38] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:44:38] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 07:44:38] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:49:06] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 07:49:07] [valid] No post-processing script given for validating translator
[2023-07-28 07:49:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:49:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:49:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:49:07] [comm] Using global sharding
[2023-07-28 07:49:07] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:49:07] [training] Using 1 GPUs
[2023-07-28 07:49:07] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 07:49:08] Allocating memory for general optimizer shards
[2023-07-28 07:49:08] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:49:08] Loading Adam parameters
[2023-07-28 07:49:08] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:49:08] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:49:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 07:49:09] [data] Restoring the corpus state to epoch 261, batch 7098
[2023-07-28 07:49:09] [data] Shuffling data
[2023-07-28 07:49:09] [data] Done reading 20,192 sentences
[2023-07-28 07:49:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:49:09] Training started
[2023-07-28 07:49:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 07:49:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:49:11] Parameter type float16, optimization type float32, casting types true
[2023-07-28 07:50:19] Seen 20,192 samples
[2023-07-28 07:50:19] Starting data epoch 262 in logical epoch 262
[2023-07-28 07:50:19] [data] Shuffling data
[2023-07-28 07:50:19] [data] Done reading 20,192 sentences
[2023-07-28 07:50:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:51:30] Seen 20,192 samples
[2023-07-28 07:51:30] Starting data epoch 263 in logical epoch 263
[2023-07-28 07:51:30] [data] Shuffling data
[2023-07-28 07:51:30] [data] Done reading 20,192 sentences
[2023-07-28 07:51:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:52:44] Seen 20,192 samples
[2023-07-28 07:52:44] Starting data epoch 264 in logical epoch 264
[2023-07-28 07:52:44] [data] Shuffling data
[2023-07-28 07:52:44] [data] Done reading 20,192 sentences
[2023-07-28 07:52:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:53:56] Seen 20,192 samples
[2023-07-28 07:53:56] Starting data epoch 265 in logical epoch 265
[2023-07-28 07:53:56] [data] Shuffling data
[2023-07-28 07:53:56] [data] Done reading 20,192 sentences
[2023-07-28 07:53:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:55:08] Seen 20,192 samples
[2023-07-28 07:55:08] Starting data epoch 266 in logical epoch 266
[2023-07-28 07:55:08] [data] Shuffling data
[2023-07-28 07:55:08] [data] Done reading 20,192 sentences
[2023-07-28 07:55:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:56:22] Seen 20,192 samples
[2023-07-28 07:56:22] Starting data epoch 267 in logical epoch 267
[2023-07-28 07:56:22] [data] Shuffling data
[2023-07-28 07:56:22] [data] Done reading 20,192 sentences
[2023-07-28 07:56:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:57:38] Seen 20,192 samples
[2023-07-28 07:57:38] Starting data epoch 268 in logical epoch 268
[2023-07-28 07:57:38] [data] Shuffling data
[2023-07-28 07:57:38] [data] Done reading 20,192 sentences
[2023-07-28 07:57:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:58:53] Seen 20,192 samples
[2023-07-28 07:58:53] Starting data epoch 269 in logical epoch 269
[2023-07-28 07:58:53] [data] Shuffling data
[2023-07-28 07:58:53] [data] Done reading 20,192 sentences
[2023-07-28 07:58:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:00:06] Seen 20,192 samples
[2023-07-28 08:00:06] Starting data epoch 270 in logical epoch 270
[2023-07-28 08:00:06] [data] Shuffling data
[2023-07-28 08:00:06] [data] Done reading 20,192 sentences
[2023-07-28 08:00:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:01:21] Seen 20,192 samples
[2023-07-28 08:01:21] Starting data epoch 271 in logical epoch 271
[2023-07-28 08:01:21] Training finished
[2023-07-28 08:02:02] [valid] Ep. 271 : Up. 7368 : translation : 0 : new best
[2023-07-28 08:02:02] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:02:03] Saving Adam parameters
[2023-07-28 08:02:04] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:02:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:02:11] [marian] Running on node05.datos.cluster.uy as process 24778 with command line:
[2023-07-28 08:02:11] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 280 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 08:02:11] [config] after: 0e
[2023-07-28 08:02:11] [config] after-batches: 0
[2023-07-28 08:02:11] [config] after-epochs: 280
[2023-07-28 08:02:11] [config] all-caps-every: 0
[2023-07-28 08:02:11] [config] allow-unk: false
[2023-07-28 08:02:11] [config] authors: false
[2023-07-28 08:02:11] [config] beam-size: 12
[2023-07-28 08:02:11] [config] bert-class-symbol: "[CLS]"
[2023-07-28 08:02:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 08:02:11] [config] bert-masking-fraction: 0.15
[2023-07-28 08:02:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 08:02:11] [config] bert-train-type-embeddings: true
[2023-07-28 08:02:11] [config] bert-type-vocab-size: 2
[2023-07-28 08:02:11] [config] build-info: ""
[2023-07-28 08:02:11] [config] check-gradient-nan: false
[2023-07-28 08:02:11] [config] check-nan: false
[2023-07-28 08:02:11] [config] cite: false
[2023-07-28 08:02:11] [config] clip-norm: 1
[2023-07-28 08:02:11] [config] cost-scaling:
[2023-07-28 08:02:11] [config]   - 256.f
[2023-07-28 08:02:11] [config]   - 1000
[2023-07-28 08:02:11] [config]   - 2.f
[2023-07-28 08:02:11] [config]   - 256.f
[2023-07-28 08:02:11] [config] cost-type: ce-sum
[2023-07-28 08:02:11] [config] cpu-threads: 0
[2023-07-28 08:02:11] [config] data-threads: 8
[2023-07-28 08:02:11] [config] data-weighting: ""
[2023-07-28 08:02:11] [config] data-weighting-type: sentence
[2023-07-28 08:02:11] [config] dec-cell: gru
[2023-07-28 08:02:11] [config] dec-cell-base-depth: 2
[2023-07-28 08:02:11] [config] dec-cell-high-depth: 1
[2023-07-28 08:02:11] [config] dec-depth: 1
[2023-07-28 08:02:11] [config] devices:
[2023-07-28 08:02:11] [config]   - 0
[2023-07-28 08:02:11] [config] dim-emb: 512
[2023-07-28 08:02:11] [config] dim-rnn: 1024
[2023-07-28 08:02:11] [config] dim-vocabs:
[2023-07-28 08:02:11] [config]   - 16384
[2023-07-28 08:02:11] [config]   - 16384
[2023-07-28 08:02:11] [config] disp-first: 0
[2023-07-28 08:02:11] [config] disp-freq: 1000u
[2023-07-28 08:02:11] [config] disp-label-counts: true
[2023-07-28 08:02:11] [config] dropout-rnn: 0
[2023-07-28 08:02:11] [config] dropout-src: 0
[2023-07-28 08:02:11] [config] dropout-trg: 0
[2023-07-28 08:02:11] [config] dump-config: ""
[2023-07-28 08:02:11] [config] dynamic-gradient-scaling:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] early-stopping: 1000
[2023-07-28 08:02:11] [config] early-stopping-on: first
[2023-07-28 08:02:11] [config] embedding-fix-src: false
[2023-07-28 08:02:11] [config] embedding-fix-trg: false
[2023-07-28 08:02:11] [config] embedding-normalization: false
[2023-07-28 08:02:11] [config] embedding-vectors:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] enc-cell: gru
[2023-07-28 08:02:11] [config] enc-cell-depth: 1
[2023-07-28 08:02:11] [config] enc-depth: 1
[2023-07-28 08:02:11] [config] enc-type: bidirectional
[2023-07-28 08:02:11] [config] english-title-case-every: 0
[2023-07-28 08:02:11] [config] exponential-smoothing: 0
[2023-07-28 08:02:11] [config] factor-weight: 1
[2023-07-28 08:02:11] [config] factors-combine: sum
[2023-07-28 08:02:11] [config] factors-dim-emb: 0
[2023-07-28 08:02:11] [config] gradient-checkpointing: false
[2023-07-28 08:02:11] [config] gradient-norm-average-window: 100
[2023-07-28 08:02:11] [config] guided-alignment: none
[2023-07-28 08:02:11] [config] guided-alignment-cost: mse
[2023-07-28 08:02:11] [config] guided-alignment-weight: 0.1
[2023-07-28 08:02:11] [config] ignore-model-config: false
[2023-07-28 08:02:11] [config] input-types:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] interpolate-env-vars: false
[2023-07-28 08:02:11] [config] keep-best: false
[2023-07-28 08:02:11] [config] label-smoothing: 0
[2023-07-28 08:02:11] [config] layer-normalization: false
[2023-07-28 08:02:11] [config] learn-rate: 0.0001
[2023-07-28 08:02:11] [config] lemma-dependency: ""
[2023-07-28 08:02:11] [config] lemma-dim-emb: 0
[2023-07-28 08:02:11] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:02:11] [config] log-level: info
[2023-07-28 08:02:11] [config] log-time-zone: ""
[2023-07-28 08:02:11] [config] logical-epoch:
[2023-07-28 08:02:11] [config]   - 1e
[2023-07-28 08:02:11] [config]   - 0
[2023-07-28 08:02:11] [config] lr-decay: 0
[2023-07-28 08:02:11] [config] lr-decay-freq: 50000
[2023-07-28 08:02:11] [config] lr-decay-inv-sqrt:
[2023-07-28 08:02:11] [config]   - 0
[2023-07-28 08:02:11] [config] lr-decay-repeat-warmup: false
[2023-07-28 08:02:11] [config] lr-decay-reset-optimizer: false
[2023-07-28 08:02:11] [config] lr-decay-start:
[2023-07-28 08:02:11] [config]   - 10
[2023-07-28 08:02:11] [config]   - 1
[2023-07-28 08:02:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 08:02:11] [config] lr-report: false
[2023-07-28 08:02:11] [config] lr-warmup: 0
[2023-07-28 08:02:11] [config] lr-warmup-at-reload: false
[2023-07-28 08:02:11] [config] lr-warmup-cycle: false
[2023-07-28 08:02:11] [config] lr-warmup-start-rate: 0
[2023-07-28 08:02:11] [config] max-length: 50
[2023-07-28 08:02:11] [config] max-length-crop: true
[2023-07-28 08:02:11] [config] max-length-factor: 3
[2023-07-28 08:02:11] [config] maxi-batch: 100
[2023-07-28 08:02:11] [config] maxi-batch-sort: trg
[2023-07-28 08:02:11] [config] mini-batch: 64
[2023-07-28 08:02:11] [config] mini-batch-fit: true
[2023-07-28 08:02:11] [config] mini-batch-fit-step: 10
[2023-07-28 08:02:11] [config] mini-batch-round-up: true
[2023-07-28 08:02:11] [config] mini-batch-track-lr: false
[2023-07-28 08:02:11] [config] mini-batch-warmup: 0
[2023-07-28 08:02:11] [config] mini-batch-words: 0
[2023-07-28 08:02:11] [config] mini-batch-words-ref: 0
[2023-07-28 08:02:11] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:02:11] [config] multi-loss-type: sum
[2023-07-28 08:02:11] [config] n-best: false
[2023-07-28 08:02:11] [config] no-nccl: false
[2023-07-28 08:02:11] [config] no-reload: false
[2023-07-28 08:02:11] [config] no-restore-corpus: false
[2023-07-28 08:02:11] [config] normalize: 0
[2023-07-28 08:02:11] [config] normalize-gradient: false
[2023-07-28 08:02:11] [config] num-devices: 0
[2023-07-28 08:02:11] [config] optimizer: adam
[2023-07-28 08:02:11] [config] optimizer-delay: 1
[2023-07-28 08:02:11] [config] optimizer-params:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] output-omit-bias: false
[2023-07-28 08:02:11] [config] overwrite: true
[2023-07-28 08:02:11] [config] precision:
[2023-07-28 08:02:11] [config]   - float16
[2023-07-28 08:02:11] [config]   - float32
[2023-07-28 08:02:11] [config] pretrained-model: ""
[2023-07-28 08:02:11] [config] quantize-biases: false
[2023-07-28 08:02:11] [config] quantize-bits: 0
[2023-07-28 08:02:11] [config] quantize-log-based: false
[2023-07-28 08:02:11] [config] quantize-optimization-steps: 0
[2023-07-28 08:02:11] [config] quiet: false
[2023-07-28 08:02:11] [config] quiet-translation: true
[2023-07-28 08:02:11] [config] relative-paths: false
[2023-07-28 08:02:11] [config] right-left: false
[2023-07-28 08:02:11] [config] save-freq: 10000u
[2023-07-28 08:02:11] [config] seed: 1234
[2023-07-28 08:02:11] [config] sentencepiece-alphas:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] sentencepiece-max-lines: 2000000
[2023-07-28 08:02:11] [config] sentencepiece-options: ""
[2023-07-28 08:02:11] [config] sharding: global
[2023-07-28 08:02:11] [config] shuffle: data
[2023-07-28 08:02:11] [config] shuffle-in-ram: false
[2023-07-28 08:02:11] [config] sigterm: save-and-exit
[2023-07-28 08:02:11] [config] skip: false
[2023-07-28 08:02:11] [config] sqlite: ""
[2023-07-28 08:02:11] [config] sqlite-drop: false
[2023-07-28 08:02:11] [config] sync-freq: 200u
[2023-07-28 08:02:11] [config] sync-sgd: false
[2023-07-28 08:02:11] [config] tempdir: /tmp
[2023-07-28 08:02:11] [config] tied-embeddings: false
[2023-07-28 08:02:11] [config] tied-embeddings-all: true
[2023-07-28 08:02:11] [config] tied-embeddings-src: false
[2023-07-28 08:02:11] [config] train-embedder-rank:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] train-sets:
[2023-07-28 08:02:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 08:02:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 08:02:11] [config] transformer-aan-activation: swish
[2023-07-28 08:02:11] [config] transformer-aan-depth: 2
[2023-07-28 08:02:11] [config] transformer-aan-nogate: false
[2023-07-28 08:02:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 08:02:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 08:02:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 08:02:11] [config] transformer-depth-scaling: false
[2023-07-28 08:02:11] [config] transformer-dim-aan: 2048
[2023-07-28 08:02:11] [config] transformer-dim-ffn: 2048
[2023-07-28 08:02:11] [config] transformer-dropout: 0
[2023-07-28 08:02:11] [config] transformer-dropout-attention: 0
[2023-07-28 08:02:11] [config] transformer-dropout-ffn: 0
[2023-07-28 08:02:11] [config] transformer-ffn-activation: swish
[2023-07-28 08:02:11] [config] transformer-ffn-depth: 2
[2023-07-28 08:02:11] [config] transformer-guided-alignment-layer: last
[2023-07-28 08:02:11] [config] transformer-heads: 8
[2023-07-28 08:02:11] [config] transformer-no-projection: false
[2023-07-28 08:02:11] [config] transformer-pool: false
[2023-07-28 08:02:11] [config] transformer-postprocess: dan
[2023-07-28 08:02:11] [config] transformer-postprocess-emb: d
[2023-07-28 08:02:11] [config] transformer-postprocess-top: ""
[2023-07-28 08:02:11] [config] transformer-preprocess: ""
[2023-07-28 08:02:11] [config] transformer-tied-layers:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] transformer-train-position-embeddings: false
[2023-07-28 08:02:11] [config] tsv: false
[2023-07-28 08:02:11] [config] tsv-fields: 0
[2023-07-28 08:02:11] [config] type: s2s
[2023-07-28 08:02:11] [config] ulr: false
[2023-07-28 08:02:11] [config] ulr-dim-emb: 0
[2023-07-28 08:02:11] [config] ulr-dropout: 0
[2023-07-28 08:02:11] [config] ulr-keys-vectors: ""
[2023-07-28 08:02:11] [config] ulr-query-vectors: ""
[2023-07-28 08:02:11] [config] ulr-softmax-temperature: 1
[2023-07-28 08:02:11] [config] ulr-trainable-transformation: false
[2023-07-28 08:02:11] [config] unlikelihood-loss: false
[2023-07-28 08:02:11] [config] valid-freq: 50000000
[2023-07-28 08:02:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:02:11] [config] valid-max-length: 1000
[2023-07-28 08:02:11] [config] valid-metrics:
[2023-07-28 08:02:11] [config]   - translation
[2023-07-28 08:02:11] [config] valid-mini-batch: 32
[2023-07-28 08:02:11] [config] valid-reset-stalled: false
[2023-07-28 08:02:11] [config] valid-script-args:
[2023-07-28 08:02:11] [config]   []
[2023-07-28 08:02:11] [config] valid-script-path: ""
[2023-07-28 08:02:11] [config] valid-sets:
[2023-07-28 08:02:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 08:02:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 08:02:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 08:02:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:02:11] [config] vocabs:
[2023-07-28 08:02:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:02:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:02:11] [config] word-penalty: 0
[2023-07-28 08:02:11] [config] word-scores: false
[2023-07-28 08:02:11] [config] workspace: 5500
[2023-07-28 08:02:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:02:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:02:11] [training] Using single-device training
[2023-07-28 08:02:11] Synced seed 1234
[2023-07-28 08:02:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:02:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 08:02:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:02:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 08:02:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 08:02:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:02:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 08:02:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:02:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:02:12] [comm] Using global sharding
[2023-07-28 08:02:12] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:02:12] [training] Using 1 GPUs
[2023-07-28 08:02:12] [logits] Applying loss function for 1 factor(s)
[2023-07-28 08:02:12] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:02:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 08:02:12] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:06:41] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 08:06:41] [valid] No post-processing script given for validating translator
[2023-07-28 08:06:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:06:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:06:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:06:41] [comm] Using global sharding
[2023-07-28 08:06:41] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:06:41] [training] Using 1 GPUs
[2023-07-28 08:06:41] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:06:42] Allocating memory for general optimizer shards
[2023-07-28 08:06:42] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:06:42] Loading Adam parameters
[2023-07-28 08:06:42] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:06:42] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:06:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:06:43] [data] Restoring the corpus state to epoch 271, batch 7368
[2023-07-28 08:06:43] [data] Shuffling data
[2023-07-28 08:06:43] [data] Done reading 20,192 sentences
[2023-07-28 08:06:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:06:43] Training started
[2023-07-28 08:06:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 08:06:43] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:06:44] Parameter type float16, optimization type float32, casting types true
[2023-07-28 08:07:53] Seen 20,192 samples
[2023-07-28 08:07:53] Starting data epoch 272 in logical epoch 272
[2023-07-28 08:07:53] [data] Shuffling data
[2023-07-28 08:07:53] [data] Done reading 20,192 sentences
[2023-07-28 08:07:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:09:03] Seen 20,192 samples
[2023-07-28 08:09:03] Starting data epoch 273 in logical epoch 273
[2023-07-28 08:09:03] [data] Shuffling data
[2023-07-28 08:09:03] [data] Done reading 20,192 sentences
[2023-07-28 08:09:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:10:16] Seen 20,192 samples
[2023-07-28 08:10:16] Starting data epoch 274 in logical epoch 274
[2023-07-28 08:10:16] [data] Shuffling data
[2023-07-28 08:10:16] [data] Done reading 20,192 sentences
[2023-07-28 08:10:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:11:31] Seen 20,192 samples
[2023-07-28 08:11:31] Starting data epoch 275 in logical epoch 275
[2023-07-28 08:11:31] [data] Shuffling data
[2023-07-28 08:11:31] [data] Done reading 20,192 sentences
[2023-07-28 08:11:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:12:45] Seen 20,192 samples
[2023-07-28 08:12:45] Starting data epoch 276 in logical epoch 276
[2023-07-28 08:12:45] [data] Shuffling data
[2023-07-28 08:12:45] [data] Done reading 20,192 sentences
[2023-07-28 08:12:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:13:58] Seen 20,192 samples
[2023-07-28 08:13:58] Starting data epoch 277 in logical epoch 277
[2023-07-28 08:13:58] [data] Shuffling data
[2023-07-28 08:13:58] [data] Done reading 20,192 sentences
[2023-07-28 08:13:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:15:12] Seen 20,192 samples
[2023-07-28 08:15:12] Starting data epoch 278 in logical epoch 278
[2023-07-28 08:15:12] [data] Shuffling data
[2023-07-28 08:15:12] [data] Done reading 20,192 sentences
[2023-07-28 08:15:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:16:28] Seen 20,192 samples
[2023-07-28 08:16:28] Starting data epoch 279 in logical epoch 279
[2023-07-28 08:16:28] [data] Shuffling data
[2023-07-28 08:16:28] [data] Done reading 20,192 sentences
[2023-07-28 08:16:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:17:43] Seen 20,192 samples
[2023-07-28 08:17:43] Starting data epoch 280 in logical epoch 280
[2023-07-28 08:17:43] [data] Shuffling data
[2023-07-28 08:17:43] [data] Done reading 20,192 sentences
[2023-07-28 08:17:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:18:57] Seen 20,192 samples
[2023-07-28 08:18:57] Starting data epoch 281 in logical epoch 281
[2023-07-28 08:18:57] Training finished
[2023-07-28 08:19:38] [valid] Ep. 281 : Up. 7645 : translation : 0 : new best
[2023-07-28 08:19:38] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:19:40] Saving Adam parameters
[2023-07-28 08:19:40] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:19:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:19:48] [marian] Running on node05.datos.cluster.uy as process 25748 with command line:
[2023-07-28 08:19:48] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 290 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 08:19:48] [config] after: 0e
[2023-07-28 08:19:48] [config] after-batches: 0
[2023-07-28 08:19:48] [config] after-epochs: 290
[2023-07-28 08:19:48] [config] all-caps-every: 0
[2023-07-28 08:19:48] [config] allow-unk: false
[2023-07-28 08:19:48] [config] authors: false
[2023-07-28 08:19:48] [config] beam-size: 12
[2023-07-28 08:19:48] [config] bert-class-symbol: "[CLS]"
[2023-07-28 08:19:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 08:19:48] [config] bert-masking-fraction: 0.15
[2023-07-28 08:19:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 08:19:48] [config] bert-train-type-embeddings: true
[2023-07-28 08:19:48] [config] bert-type-vocab-size: 2
[2023-07-28 08:19:48] [config] build-info: ""
[2023-07-28 08:19:48] [config] check-gradient-nan: false
[2023-07-28 08:19:48] [config] check-nan: false
[2023-07-28 08:19:48] [config] cite: false
[2023-07-28 08:19:48] [config] clip-norm: 1
[2023-07-28 08:19:48] [config] cost-scaling:
[2023-07-28 08:19:48] [config]   - 256.f
[2023-07-28 08:19:48] [config]   - 1000
[2023-07-28 08:19:48] [config]   - 2.f
[2023-07-28 08:19:48] [config]   - 256.f
[2023-07-28 08:19:48] [config] cost-type: ce-sum
[2023-07-28 08:19:48] [config] cpu-threads: 0
[2023-07-28 08:19:48] [config] data-threads: 8
[2023-07-28 08:19:48] [config] data-weighting: ""
[2023-07-28 08:19:48] [config] data-weighting-type: sentence
[2023-07-28 08:19:48] [config] dec-cell: gru
[2023-07-28 08:19:48] [config] dec-cell-base-depth: 2
[2023-07-28 08:19:48] [config] dec-cell-high-depth: 1
[2023-07-28 08:19:48] [config] dec-depth: 1
[2023-07-28 08:19:48] [config] devices:
[2023-07-28 08:19:48] [config]   - 0
[2023-07-28 08:19:48] [config] dim-emb: 512
[2023-07-28 08:19:48] [config] dim-rnn: 1024
[2023-07-28 08:19:48] [config] dim-vocabs:
[2023-07-28 08:19:48] [config]   - 16384
[2023-07-28 08:19:48] [config]   - 16384
[2023-07-28 08:19:48] [config] disp-first: 0
[2023-07-28 08:19:48] [config] disp-freq: 1000u
[2023-07-28 08:19:48] [config] disp-label-counts: true
[2023-07-28 08:19:48] [config] dropout-rnn: 0
[2023-07-28 08:19:48] [config] dropout-src: 0
[2023-07-28 08:19:48] [config] dropout-trg: 0
[2023-07-28 08:19:48] [config] dump-config: ""
[2023-07-28 08:19:48] [config] dynamic-gradient-scaling:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] early-stopping: 1000
[2023-07-28 08:19:48] [config] early-stopping-on: first
[2023-07-28 08:19:48] [config] embedding-fix-src: false
[2023-07-28 08:19:48] [config] embedding-fix-trg: false
[2023-07-28 08:19:48] [config] embedding-normalization: false
[2023-07-28 08:19:48] [config] embedding-vectors:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] enc-cell: gru
[2023-07-28 08:19:48] [config] enc-cell-depth: 1
[2023-07-28 08:19:48] [config] enc-depth: 1
[2023-07-28 08:19:48] [config] enc-type: bidirectional
[2023-07-28 08:19:48] [config] english-title-case-every: 0
[2023-07-28 08:19:48] [config] exponential-smoothing: 0
[2023-07-28 08:19:48] [config] factor-weight: 1
[2023-07-28 08:19:48] [config] factors-combine: sum
[2023-07-28 08:19:48] [config] factors-dim-emb: 0
[2023-07-28 08:19:48] [config] gradient-checkpointing: false
[2023-07-28 08:19:48] [config] gradient-norm-average-window: 100
[2023-07-28 08:19:48] [config] guided-alignment: none
[2023-07-28 08:19:48] [config] guided-alignment-cost: mse
[2023-07-28 08:19:48] [config] guided-alignment-weight: 0.1
[2023-07-28 08:19:48] [config] ignore-model-config: false
[2023-07-28 08:19:48] [config] input-types:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] interpolate-env-vars: false
[2023-07-28 08:19:48] [config] keep-best: false
[2023-07-28 08:19:48] [config] label-smoothing: 0
[2023-07-28 08:19:48] [config] layer-normalization: false
[2023-07-28 08:19:48] [config] learn-rate: 0.0001
[2023-07-28 08:19:48] [config] lemma-dependency: ""
[2023-07-28 08:19:48] [config] lemma-dim-emb: 0
[2023-07-28 08:19:48] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:19:48] [config] log-level: info
[2023-07-28 08:19:48] [config] log-time-zone: ""
[2023-07-28 08:19:48] [config] logical-epoch:
[2023-07-28 08:19:48] [config]   - 1e
[2023-07-28 08:19:48] [config]   - 0
[2023-07-28 08:19:48] [config] lr-decay: 0
[2023-07-28 08:19:48] [config] lr-decay-freq: 50000
[2023-07-28 08:19:48] [config] lr-decay-inv-sqrt:
[2023-07-28 08:19:48] [config]   - 0
[2023-07-28 08:19:48] [config] lr-decay-repeat-warmup: false
[2023-07-28 08:19:48] [config] lr-decay-reset-optimizer: false
[2023-07-28 08:19:48] [config] lr-decay-start:
[2023-07-28 08:19:48] [config]   - 10
[2023-07-28 08:19:48] [config]   - 1
[2023-07-28 08:19:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 08:19:48] [config] lr-report: false
[2023-07-28 08:19:48] [config] lr-warmup: 0
[2023-07-28 08:19:48] [config] lr-warmup-at-reload: false
[2023-07-28 08:19:48] [config] lr-warmup-cycle: false
[2023-07-28 08:19:48] [config] lr-warmup-start-rate: 0
[2023-07-28 08:19:48] [config] max-length: 50
[2023-07-28 08:19:48] [config] max-length-crop: true
[2023-07-28 08:19:48] [config] max-length-factor: 3
[2023-07-28 08:19:48] [config] maxi-batch: 100
[2023-07-28 08:19:48] [config] maxi-batch-sort: trg
[2023-07-28 08:19:48] [config] mini-batch: 64
[2023-07-28 08:19:48] [config] mini-batch-fit: true
[2023-07-28 08:19:48] [config] mini-batch-fit-step: 10
[2023-07-28 08:19:48] [config] mini-batch-round-up: true
[2023-07-28 08:19:48] [config] mini-batch-track-lr: false
[2023-07-28 08:19:48] [config] mini-batch-warmup: 0
[2023-07-28 08:19:48] [config] mini-batch-words: 0
[2023-07-28 08:19:48] [config] mini-batch-words-ref: 0
[2023-07-28 08:19:48] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:19:48] [config] multi-loss-type: sum
[2023-07-28 08:19:48] [config] n-best: false
[2023-07-28 08:19:48] [config] no-nccl: false
[2023-07-28 08:19:48] [config] no-reload: false
[2023-07-28 08:19:48] [config] no-restore-corpus: false
[2023-07-28 08:19:48] [config] normalize: 0
[2023-07-28 08:19:48] [config] normalize-gradient: false
[2023-07-28 08:19:48] [config] num-devices: 0
[2023-07-28 08:19:48] [config] optimizer: adam
[2023-07-28 08:19:48] [config] optimizer-delay: 1
[2023-07-28 08:19:48] [config] optimizer-params:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] output-omit-bias: false
[2023-07-28 08:19:48] [config] overwrite: true
[2023-07-28 08:19:48] [config] precision:
[2023-07-28 08:19:48] [config]   - float16
[2023-07-28 08:19:48] [config]   - float32
[2023-07-28 08:19:48] [config] pretrained-model: ""
[2023-07-28 08:19:48] [config] quantize-biases: false
[2023-07-28 08:19:48] [config] quantize-bits: 0
[2023-07-28 08:19:48] [config] quantize-log-based: false
[2023-07-28 08:19:48] [config] quantize-optimization-steps: 0
[2023-07-28 08:19:48] [config] quiet: false
[2023-07-28 08:19:48] [config] quiet-translation: true
[2023-07-28 08:19:48] [config] relative-paths: false
[2023-07-28 08:19:48] [config] right-left: false
[2023-07-28 08:19:48] [config] save-freq: 10000u
[2023-07-28 08:19:48] [config] seed: 1234
[2023-07-28 08:19:48] [config] sentencepiece-alphas:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] sentencepiece-max-lines: 2000000
[2023-07-28 08:19:48] [config] sentencepiece-options: ""
[2023-07-28 08:19:48] [config] sharding: global
[2023-07-28 08:19:48] [config] shuffle: data
[2023-07-28 08:19:48] [config] shuffle-in-ram: false
[2023-07-28 08:19:48] [config] sigterm: save-and-exit
[2023-07-28 08:19:48] [config] skip: false
[2023-07-28 08:19:48] [config] sqlite: ""
[2023-07-28 08:19:48] [config] sqlite-drop: false
[2023-07-28 08:19:48] [config] sync-freq: 200u
[2023-07-28 08:19:48] [config] sync-sgd: false
[2023-07-28 08:19:48] [config] tempdir: /tmp
[2023-07-28 08:19:48] [config] tied-embeddings: false
[2023-07-28 08:19:48] [config] tied-embeddings-all: true
[2023-07-28 08:19:48] [config] tied-embeddings-src: false
[2023-07-28 08:19:48] [config] train-embedder-rank:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] train-sets:
[2023-07-28 08:19:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 08:19:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 08:19:48] [config] transformer-aan-activation: swish
[2023-07-28 08:19:48] [config] transformer-aan-depth: 2
[2023-07-28 08:19:48] [config] transformer-aan-nogate: false
[2023-07-28 08:19:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 08:19:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 08:19:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 08:19:48] [config] transformer-depth-scaling: false
[2023-07-28 08:19:48] [config] transformer-dim-aan: 2048
[2023-07-28 08:19:48] [config] transformer-dim-ffn: 2048
[2023-07-28 08:19:48] [config] transformer-dropout: 0
[2023-07-28 08:19:48] [config] transformer-dropout-attention: 0
[2023-07-28 08:19:48] [config] transformer-dropout-ffn: 0
[2023-07-28 08:19:48] [config] transformer-ffn-activation: swish
[2023-07-28 08:19:48] [config] transformer-ffn-depth: 2
[2023-07-28 08:19:48] [config] transformer-guided-alignment-layer: last
[2023-07-28 08:19:48] [config] transformer-heads: 8
[2023-07-28 08:19:48] [config] transformer-no-projection: false
[2023-07-28 08:19:48] [config] transformer-pool: false
[2023-07-28 08:19:48] [config] transformer-postprocess: dan
[2023-07-28 08:19:48] [config] transformer-postprocess-emb: d
[2023-07-28 08:19:48] [config] transformer-postprocess-top: ""
[2023-07-28 08:19:48] [config] transformer-preprocess: ""
[2023-07-28 08:19:48] [config] transformer-tied-layers:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] transformer-train-position-embeddings: false
[2023-07-28 08:19:48] [config] tsv: false
[2023-07-28 08:19:48] [config] tsv-fields: 0
[2023-07-28 08:19:48] [config] type: s2s
[2023-07-28 08:19:48] [config] ulr: false
[2023-07-28 08:19:48] [config] ulr-dim-emb: 0
[2023-07-28 08:19:48] [config] ulr-dropout: 0
[2023-07-28 08:19:48] [config] ulr-keys-vectors: ""
[2023-07-28 08:19:48] [config] ulr-query-vectors: ""
[2023-07-28 08:19:48] [config] ulr-softmax-temperature: 1
[2023-07-28 08:19:48] [config] ulr-trainable-transformation: false
[2023-07-28 08:19:48] [config] unlikelihood-loss: false
[2023-07-28 08:19:48] [config] valid-freq: 50000000
[2023-07-28 08:19:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:19:48] [config] valid-max-length: 1000
[2023-07-28 08:19:48] [config] valid-metrics:
[2023-07-28 08:19:48] [config]   - translation
[2023-07-28 08:19:48] [config] valid-mini-batch: 32
[2023-07-28 08:19:48] [config] valid-reset-stalled: false
[2023-07-28 08:19:48] [config] valid-script-args:
[2023-07-28 08:19:48] [config]   []
[2023-07-28 08:19:48] [config] valid-script-path: ""
[2023-07-28 08:19:48] [config] valid-sets:
[2023-07-28 08:19:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 08:19:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 08:19:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 08:19:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:19:48] [config] vocabs:
[2023-07-28 08:19:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:19:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:19:48] [config] word-penalty: 0
[2023-07-28 08:19:48] [config] word-scores: false
[2023-07-28 08:19:48] [config] workspace: 5500
[2023-07-28 08:19:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:19:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:19:48] [training] Using single-device training
[2023-07-28 08:19:48] Synced seed 1234
[2023-07-28 08:19:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:19:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 08:19:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:19:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 08:19:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 08:19:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:19:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 08:19:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:19:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:19:49] [comm] Using global sharding
[2023-07-28 08:19:49] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:19:49] [training] Using 1 GPUs
[2023-07-28 08:19:49] [logits] Applying loss function for 1 factor(s)
[2023-07-28 08:19:49] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:19:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 08:19:49] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:24:17] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 08:24:18] [valid] No post-processing script given for validating translator
[2023-07-28 08:24:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:24:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:24:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:24:18] [comm] Using global sharding
[2023-07-28 08:24:18] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:24:18] [training] Using 1 GPUs
[2023-07-28 08:24:18] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:24:19] Allocating memory for general optimizer shards
[2023-07-28 08:24:19] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:24:19] Loading Adam parameters
[2023-07-28 08:24:19] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:24:19] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:24:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:24:19] [data] Restoring the corpus state to epoch 281, batch 7645
[2023-07-28 08:24:19] [data] Shuffling data
[2023-07-28 08:24:19] [data] Done reading 20,192 sentences
[2023-07-28 08:24:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:24:19] Training started
[2023-07-28 08:24:20] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 08:24:20] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:24:22] Parameter type float16, optimization type float32, casting types true
[2023-07-28 08:25:28] Seen 20,192 samples
[2023-07-28 08:25:28] Starting data epoch 282 in logical epoch 282
[2023-07-28 08:25:28] [data] Shuffling data
[2023-07-28 08:25:28] [data] Done reading 20,192 sentences
[2023-07-28 08:25:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:26:39] Seen 20,192 samples
[2023-07-28 08:26:39] Starting data epoch 283 in logical epoch 283
[2023-07-28 08:26:39] [data] Shuffling data
[2023-07-28 08:26:39] [data] Done reading 20,192 sentences
[2023-07-28 08:26:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:27:52] Seen 20,192 samples
[2023-07-28 08:27:52] Starting data epoch 284 in logical epoch 284
[2023-07-28 08:27:52] [data] Shuffling data
[2023-07-28 08:27:52] [data] Done reading 20,192 sentences
[2023-07-28 08:27:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:29:05] Seen 20,192 samples
[2023-07-28 08:29:05] Starting data epoch 285 in logical epoch 285
[2023-07-28 08:29:05] [data] Shuffling data
[2023-07-28 08:29:06] [data] Done reading 20,192 sentences
[2023-07-28 08:29:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:30:19] Seen 20,192 samples
[2023-07-28 08:30:19] Starting data epoch 286 in logical epoch 286
[2023-07-28 08:30:19] [data] Shuffling data
[2023-07-28 08:30:19] [data] Done reading 20,192 sentences
[2023-07-28 08:30:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:31:33] Seen 20,192 samples
[2023-07-28 08:31:33] Starting data epoch 287 in logical epoch 287
[2023-07-28 08:31:33] [data] Shuffling data
[2023-07-28 08:31:33] [data] Done reading 20,192 sentences
[2023-07-28 08:31:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:32:48] Seen 20,192 samples
[2023-07-28 08:32:48] Starting data epoch 288 in logical epoch 288
[2023-07-28 08:32:48] [data] Shuffling data
[2023-07-28 08:32:48] [data] Done reading 20,192 sentences
[2023-07-28 08:32:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:34:02] Seen 20,192 samples
[2023-07-28 08:34:02] Starting data epoch 289 in logical epoch 289
[2023-07-28 08:34:02] [data] Shuffling data
[2023-07-28 08:34:02] [data] Done reading 20,192 sentences
[2023-07-28 08:34:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:35:16] Seen 20,192 samples
[2023-07-28 08:35:16] Starting data epoch 290 in logical epoch 290
[2023-07-28 08:35:16] [data] Shuffling data
[2023-07-28 08:35:16] [data] Done reading 20,192 sentences
[2023-07-28 08:35:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:36:28] Seen 20,192 samples
[2023-07-28 08:36:28] Starting data epoch 291 in logical epoch 291
[2023-07-28 08:36:28] Training finished
[2023-07-28 08:37:08] [valid] Ep. 291 : Up. 7918 : translation : 0 : new best
[2023-07-28 08:37:08] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:37:10] Saving Adam parameters
[2023-07-28 08:37:11] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:37:17] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:37:17] [marian] Running on node05.datos.cluster.uy as process 27030 with command line:
[2023-07-28 08:37:17] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 300 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 08:37:17] [config] after: 0e
[2023-07-28 08:37:17] [config] after-batches: 0
[2023-07-28 08:37:17] [config] after-epochs: 300
[2023-07-28 08:37:17] [config] all-caps-every: 0
[2023-07-28 08:37:17] [config] allow-unk: false
[2023-07-28 08:37:17] [config] authors: false
[2023-07-28 08:37:17] [config] beam-size: 12
[2023-07-28 08:37:17] [config] bert-class-symbol: "[CLS]"
[2023-07-28 08:37:17] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 08:37:17] [config] bert-masking-fraction: 0.15
[2023-07-28 08:37:17] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 08:37:17] [config] bert-train-type-embeddings: true
[2023-07-28 08:37:17] [config] bert-type-vocab-size: 2
[2023-07-28 08:37:17] [config] build-info: ""
[2023-07-28 08:37:17] [config] check-gradient-nan: false
[2023-07-28 08:37:17] [config] check-nan: false
[2023-07-28 08:37:17] [config] cite: false
[2023-07-28 08:37:17] [config] clip-norm: 1
[2023-07-28 08:37:17] [config] cost-scaling:
[2023-07-28 08:37:17] [config]   - 256.f
[2023-07-28 08:37:17] [config]   - 1000
[2023-07-28 08:37:17] [config]   - 2.f
[2023-07-28 08:37:17] [config]   - 256.f
[2023-07-28 08:37:17] [config] cost-type: ce-sum
[2023-07-28 08:37:17] [config] cpu-threads: 0
[2023-07-28 08:37:17] [config] data-threads: 8
[2023-07-28 08:37:17] [config] data-weighting: ""
[2023-07-28 08:37:17] [config] data-weighting-type: sentence
[2023-07-28 08:37:17] [config] dec-cell: gru
[2023-07-28 08:37:17] [config] dec-cell-base-depth: 2
[2023-07-28 08:37:17] [config] dec-cell-high-depth: 1
[2023-07-28 08:37:17] [config] dec-depth: 1
[2023-07-28 08:37:17] [config] devices:
[2023-07-28 08:37:17] [config]   - 0
[2023-07-28 08:37:17] [config] dim-emb: 512
[2023-07-28 08:37:17] [config] dim-rnn: 1024
[2023-07-28 08:37:17] [config] dim-vocabs:
[2023-07-28 08:37:17] [config]   - 16384
[2023-07-28 08:37:17] [config]   - 16384
[2023-07-28 08:37:17] [config] disp-first: 0
[2023-07-28 08:37:17] [config] disp-freq: 1000u
[2023-07-28 08:37:17] [config] disp-label-counts: true
[2023-07-28 08:37:17] [config] dropout-rnn: 0
[2023-07-28 08:37:17] [config] dropout-src: 0
[2023-07-28 08:37:17] [config] dropout-trg: 0
[2023-07-28 08:37:17] [config] dump-config: ""
[2023-07-28 08:37:17] [config] dynamic-gradient-scaling:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] early-stopping: 1000
[2023-07-28 08:37:17] [config] early-stopping-on: first
[2023-07-28 08:37:17] [config] embedding-fix-src: false
[2023-07-28 08:37:17] [config] embedding-fix-trg: false
[2023-07-28 08:37:17] [config] embedding-normalization: false
[2023-07-28 08:37:17] [config] embedding-vectors:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] enc-cell: gru
[2023-07-28 08:37:17] [config] enc-cell-depth: 1
[2023-07-28 08:37:17] [config] enc-depth: 1
[2023-07-28 08:37:17] [config] enc-type: bidirectional
[2023-07-28 08:37:17] [config] english-title-case-every: 0
[2023-07-28 08:37:17] [config] exponential-smoothing: 0
[2023-07-28 08:37:17] [config] factor-weight: 1
[2023-07-28 08:37:17] [config] factors-combine: sum
[2023-07-28 08:37:17] [config] factors-dim-emb: 0
[2023-07-28 08:37:17] [config] gradient-checkpointing: false
[2023-07-28 08:37:17] [config] gradient-norm-average-window: 100
[2023-07-28 08:37:17] [config] guided-alignment: none
[2023-07-28 08:37:17] [config] guided-alignment-cost: mse
[2023-07-28 08:37:17] [config] guided-alignment-weight: 0.1
[2023-07-28 08:37:17] [config] ignore-model-config: false
[2023-07-28 08:37:17] [config] input-types:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] interpolate-env-vars: false
[2023-07-28 08:37:17] [config] keep-best: false
[2023-07-28 08:37:17] [config] label-smoothing: 0
[2023-07-28 08:37:17] [config] layer-normalization: false
[2023-07-28 08:37:17] [config] learn-rate: 0.0001
[2023-07-28 08:37:17] [config] lemma-dependency: ""
[2023-07-28 08:37:17] [config] lemma-dim-emb: 0
[2023-07-28 08:37:17] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:37:17] [config] log-level: info
[2023-07-28 08:37:17] [config] log-time-zone: ""
[2023-07-28 08:37:17] [config] logical-epoch:
[2023-07-28 08:37:17] [config]   - 1e
[2023-07-28 08:37:17] [config]   - 0
[2023-07-28 08:37:17] [config] lr-decay: 0
[2023-07-28 08:37:17] [config] lr-decay-freq: 50000
[2023-07-28 08:37:17] [config] lr-decay-inv-sqrt:
[2023-07-28 08:37:17] [config]   - 0
[2023-07-28 08:37:17] [config] lr-decay-repeat-warmup: false
[2023-07-28 08:37:17] [config] lr-decay-reset-optimizer: false
[2023-07-28 08:37:17] [config] lr-decay-start:
[2023-07-28 08:37:17] [config]   - 10
[2023-07-28 08:37:17] [config]   - 1
[2023-07-28 08:37:17] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 08:37:17] [config] lr-report: false
[2023-07-28 08:37:17] [config] lr-warmup: 0
[2023-07-28 08:37:17] [config] lr-warmup-at-reload: false
[2023-07-28 08:37:17] [config] lr-warmup-cycle: false
[2023-07-28 08:37:17] [config] lr-warmup-start-rate: 0
[2023-07-28 08:37:17] [config] max-length: 50
[2023-07-28 08:37:17] [config] max-length-crop: true
[2023-07-28 08:37:17] [config] max-length-factor: 3
[2023-07-28 08:37:17] [config] maxi-batch: 100
[2023-07-28 08:37:17] [config] maxi-batch-sort: trg
[2023-07-28 08:37:17] [config] mini-batch: 64
[2023-07-28 08:37:17] [config] mini-batch-fit: true
[2023-07-28 08:37:17] [config] mini-batch-fit-step: 10
[2023-07-28 08:37:17] [config] mini-batch-round-up: true
[2023-07-28 08:37:17] [config] mini-batch-track-lr: false
[2023-07-28 08:37:17] [config] mini-batch-warmup: 0
[2023-07-28 08:37:17] [config] mini-batch-words: 0
[2023-07-28 08:37:17] [config] mini-batch-words-ref: 0
[2023-07-28 08:37:17] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:37:17] [config] multi-loss-type: sum
[2023-07-28 08:37:17] [config] n-best: false
[2023-07-28 08:37:17] [config] no-nccl: false
[2023-07-28 08:37:17] [config] no-reload: false
[2023-07-28 08:37:17] [config] no-restore-corpus: false
[2023-07-28 08:37:17] [config] normalize: 0
[2023-07-28 08:37:17] [config] normalize-gradient: false
[2023-07-28 08:37:17] [config] num-devices: 0
[2023-07-28 08:37:17] [config] optimizer: adam
[2023-07-28 08:37:17] [config] optimizer-delay: 1
[2023-07-28 08:37:17] [config] optimizer-params:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] output-omit-bias: false
[2023-07-28 08:37:17] [config] overwrite: true
[2023-07-28 08:37:17] [config] precision:
[2023-07-28 08:37:17] [config]   - float16
[2023-07-28 08:37:17] [config]   - float32
[2023-07-28 08:37:17] [config] pretrained-model: ""
[2023-07-28 08:37:17] [config] quantize-biases: false
[2023-07-28 08:37:17] [config] quantize-bits: 0
[2023-07-28 08:37:17] [config] quantize-log-based: false
[2023-07-28 08:37:17] [config] quantize-optimization-steps: 0
[2023-07-28 08:37:17] [config] quiet: false
[2023-07-28 08:37:17] [config] quiet-translation: true
[2023-07-28 08:37:17] [config] relative-paths: false
[2023-07-28 08:37:17] [config] right-left: false
[2023-07-28 08:37:17] [config] save-freq: 10000u
[2023-07-28 08:37:17] [config] seed: 1234
[2023-07-28 08:37:17] [config] sentencepiece-alphas:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] sentencepiece-max-lines: 2000000
[2023-07-28 08:37:17] [config] sentencepiece-options: ""
[2023-07-28 08:37:17] [config] sharding: global
[2023-07-28 08:37:17] [config] shuffle: data
[2023-07-28 08:37:17] [config] shuffle-in-ram: false
[2023-07-28 08:37:17] [config] sigterm: save-and-exit
[2023-07-28 08:37:17] [config] skip: false
[2023-07-28 08:37:17] [config] sqlite: ""
[2023-07-28 08:37:17] [config] sqlite-drop: false
[2023-07-28 08:37:17] [config] sync-freq: 200u
[2023-07-28 08:37:17] [config] sync-sgd: false
[2023-07-28 08:37:17] [config] tempdir: /tmp
[2023-07-28 08:37:17] [config] tied-embeddings: false
[2023-07-28 08:37:17] [config] tied-embeddings-all: true
[2023-07-28 08:37:17] [config] tied-embeddings-src: false
[2023-07-28 08:37:17] [config] train-embedder-rank:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] train-sets:
[2023-07-28 08:37:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 08:37:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 08:37:17] [config] transformer-aan-activation: swish
[2023-07-28 08:37:17] [config] transformer-aan-depth: 2
[2023-07-28 08:37:17] [config] transformer-aan-nogate: false
[2023-07-28 08:37:17] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 08:37:17] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 08:37:17] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 08:37:17] [config] transformer-depth-scaling: false
[2023-07-28 08:37:17] [config] transformer-dim-aan: 2048
[2023-07-28 08:37:17] [config] transformer-dim-ffn: 2048
[2023-07-28 08:37:17] [config] transformer-dropout: 0
[2023-07-28 08:37:17] [config] transformer-dropout-attention: 0
[2023-07-28 08:37:17] [config] transformer-dropout-ffn: 0
[2023-07-28 08:37:17] [config] transformer-ffn-activation: swish
[2023-07-28 08:37:17] [config] transformer-ffn-depth: 2
[2023-07-28 08:37:17] [config] transformer-guided-alignment-layer: last
[2023-07-28 08:37:17] [config] transformer-heads: 8
[2023-07-28 08:37:17] [config] transformer-no-projection: false
[2023-07-28 08:37:17] [config] transformer-pool: false
[2023-07-28 08:37:17] [config] transformer-postprocess: dan
[2023-07-28 08:37:17] [config] transformer-postprocess-emb: d
[2023-07-28 08:37:17] [config] transformer-postprocess-top: ""
[2023-07-28 08:37:17] [config] transformer-preprocess: ""
[2023-07-28 08:37:17] [config] transformer-tied-layers:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] transformer-train-position-embeddings: false
[2023-07-28 08:37:17] [config] tsv: false
[2023-07-28 08:37:17] [config] tsv-fields: 0
[2023-07-28 08:37:17] [config] type: s2s
[2023-07-28 08:37:17] [config] ulr: false
[2023-07-28 08:37:17] [config] ulr-dim-emb: 0
[2023-07-28 08:37:17] [config] ulr-dropout: 0
[2023-07-28 08:37:17] [config] ulr-keys-vectors: ""
[2023-07-28 08:37:17] [config] ulr-query-vectors: ""
[2023-07-28 08:37:17] [config] ulr-softmax-temperature: 1
[2023-07-28 08:37:17] [config] ulr-trainable-transformation: false
[2023-07-28 08:37:17] [config] unlikelihood-loss: false
[2023-07-28 08:37:17] [config] valid-freq: 50000000
[2023-07-28 08:37:17] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:37:17] [config] valid-max-length: 1000
[2023-07-28 08:37:17] [config] valid-metrics:
[2023-07-28 08:37:17] [config]   - translation
[2023-07-28 08:37:17] [config] valid-mini-batch: 32
[2023-07-28 08:37:17] [config] valid-reset-stalled: false
[2023-07-28 08:37:17] [config] valid-script-args:
[2023-07-28 08:37:17] [config]   []
[2023-07-28 08:37:17] [config] valid-script-path: ""
[2023-07-28 08:37:17] [config] valid-sets:
[2023-07-28 08:37:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 08:37:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 08:37:17] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 08:37:17] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:37:17] [config] vocabs:
[2023-07-28 08:37:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:37:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:37:17] [config] word-penalty: 0
[2023-07-28 08:37:17] [config] word-scores: false
[2023-07-28 08:37:17] [config] workspace: 5500
[2023-07-28 08:37:17] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:37:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:37:17] [training] Using single-device training
[2023-07-28 08:37:17] Synced seed 1234
[2023-07-28 08:37:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:37:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 08:37:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:37:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 08:37:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 08:37:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:37:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 08:37:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:37:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:37:18] [comm] Using global sharding
[2023-07-28 08:37:18] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:37:18] [training] Using 1 GPUs
[2023-07-28 08:37:18] [logits] Applying loss function for 1 factor(s)
[2023-07-28 08:37:18] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:37:19] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 08:37:19] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:41:47] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 08:41:47] [valid] No post-processing script given for validating translator
[2023-07-28 08:41:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:41:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:41:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:41:47] [comm] Using global sharding
[2023-07-28 08:41:47] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:41:47] [training] Using 1 GPUs
[2023-07-28 08:41:47] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:41:48] Allocating memory for general optimizer shards
[2023-07-28 08:41:48] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:41:48] Loading Adam parameters
[2023-07-28 08:41:48] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:41:48] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:41:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:41:49] [data] Restoring the corpus state to epoch 291, batch 7918
[2023-07-28 08:41:49] [data] Shuffling data
[2023-07-28 08:41:49] [data] Done reading 20,192 sentences
[2023-07-28 08:41:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:41:49] Training started
[2023-07-28 08:41:49] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 08:41:49] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:41:53] Parameter type float16, optimization type float32, casting types true
[2023-07-28 08:42:57] Seen 20,192 samples
[2023-07-28 08:42:57] Starting data epoch 292 in logical epoch 292
[2023-07-28 08:42:57] [data] Shuffling data
[2023-07-28 08:42:57] [data] Done reading 20,192 sentences
[2023-07-28 08:42:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:44:06] Seen 20,192 samples
[2023-07-28 08:44:06] Starting data epoch 293 in logical epoch 293
[2023-07-28 08:44:06] [data] Shuffling data
[2023-07-28 08:44:06] [data] Done reading 20,192 sentences
[2023-07-28 08:44:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:45:19] Ep. 293 : Up. 8000 : Sen. 20,192 : Cost 2.67502499 * 20,731,076 @ 25,492 after 166,162,058 : Time 212.20s : 97694.63 words/s : gNorm 2.0693
[2023-07-28 08:45:19] Seen 20,192 samples
[2023-07-28 08:45:19] Starting data epoch 294 in logical epoch 294
[2023-07-28 08:45:19] [data] Shuffling data
[2023-07-28 08:45:19] [data] Done reading 20,192 sentences
[2023-07-28 08:45:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:46:32] Seen 20,192 samples
[2023-07-28 08:46:32] Starting data epoch 295 in logical epoch 295
[2023-07-28 08:46:32] [data] Shuffling data
[2023-07-28 08:46:32] [data] Done reading 20,192 sentences
[2023-07-28 08:46:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:47:45] Seen 20,192 samples
[2023-07-28 08:47:45] Starting data epoch 296 in logical epoch 296
[2023-07-28 08:47:45] [data] Shuffling data
[2023-07-28 08:47:45] [data] Done reading 20,192 sentences
[2023-07-28 08:47:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:48:59] Seen 20,192 samples
[2023-07-28 08:48:59] Starting data epoch 297 in logical epoch 297
[2023-07-28 08:48:59] [data] Shuffling data
[2023-07-28 08:48:59] [data] Done reading 20,192 sentences
[2023-07-28 08:48:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:50:12] Seen 20,192 samples
[2023-07-28 08:50:12] Starting data epoch 298 in logical epoch 298
[2023-07-28 08:50:12] [data] Shuffling data
[2023-07-28 08:50:12] [data] Done reading 20,192 sentences
[2023-07-28 08:50:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:51:27] Seen 20,192 samples
[2023-07-28 08:51:27] Starting data epoch 299 in logical epoch 299
[2023-07-28 08:51:27] [data] Shuffling data
[2023-07-28 08:51:27] [data] Done reading 20,192 sentences
[2023-07-28 08:51:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:52:42] Seen 20,192 samples
[2023-07-28 08:52:42] Starting data epoch 300 in logical epoch 300
[2023-07-28 08:52:42] [data] Shuffling data
[2023-07-28 08:52:42] [data] Done reading 20,192 sentences
[2023-07-28 08:52:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:53:54] Seen 20,192 samples
[2023-07-28 08:53:54] Starting data epoch 301 in logical epoch 301
[2023-07-28 08:53:54] Training finished
[2023-07-28 08:54:36] [valid] Ep. 301 : Up. 8194 : translation : 0 : new best
[2023-07-28 08:54:36] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:54:38] Saving Adam parameters
[2023-07-28 08:54:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:54:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:54:45] [marian] Running on node05.datos.cluster.uy as process 28333 with command line:
[2023-07-28 08:54:45] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 310 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 08:54:45] [config] after: 0e
[2023-07-28 08:54:45] [config] after-batches: 0
[2023-07-28 08:54:45] [config] after-epochs: 310
[2023-07-28 08:54:45] [config] all-caps-every: 0
[2023-07-28 08:54:45] [config] allow-unk: false
[2023-07-28 08:54:45] [config] authors: false
[2023-07-28 08:54:45] [config] beam-size: 12
[2023-07-28 08:54:45] [config] bert-class-symbol: "[CLS]"
[2023-07-28 08:54:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 08:54:45] [config] bert-masking-fraction: 0.15
[2023-07-28 08:54:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 08:54:45] [config] bert-train-type-embeddings: true
[2023-07-28 08:54:45] [config] bert-type-vocab-size: 2
[2023-07-28 08:54:45] [config] build-info: ""
[2023-07-28 08:54:45] [config] check-gradient-nan: false
[2023-07-28 08:54:45] [config] check-nan: false
[2023-07-28 08:54:45] [config] cite: false
[2023-07-28 08:54:45] [config] clip-norm: 1
[2023-07-28 08:54:45] [config] cost-scaling:
[2023-07-28 08:54:45] [config]   - 256.f
[2023-07-28 08:54:45] [config]   - 1000
[2023-07-28 08:54:45] [config]   - 2.f
[2023-07-28 08:54:45] [config]   - 256.f
[2023-07-28 08:54:45] [config] cost-type: ce-sum
[2023-07-28 08:54:45] [config] cpu-threads: 0
[2023-07-28 08:54:45] [config] data-threads: 8
[2023-07-28 08:54:45] [config] data-weighting: ""
[2023-07-28 08:54:45] [config] data-weighting-type: sentence
[2023-07-28 08:54:45] [config] dec-cell: gru
[2023-07-28 08:54:45] [config] dec-cell-base-depth: 2
[2023-07-28 08:54:45] [config] dec-cell-high-depth: 1
[2023-07-28 08:54:45] [config] dec-depth: 1
[2023-07-28 08:54:45] [config] devices:
[2023-07-28 08:54:45] [config]   - 0
[2023-07-28 08:54:45] [config] dim-emb: 512
[2023-07-28 08:54:45] [config] dim-rnn: 1024
[2023-07-28 08:54:45] [config] dim-vocabs:
[2023-07-28 08:54:45] [config]   - 16384
[2023-07-28 08:54:45] [config]   - 16384
[2023-07-28 08:54:45] [config] disp-first: 0
[2023-07-28 08:54:45] [config] disp-freq: 1000u
[2023-07-28 08:54:45] [config] disp-label-counts: true
[2023-07-28 08:54:45] [config] dropout-rnn: 0
[2023-07-28 08:54:45] [config] dropout-src: 0
[2023-07-28 08:54:45] [config] dropout-trg: 0
[2023-07-28 08:54:45] [config] dump-config: ""
[2023-07-28 08:54:45] [config] dynamic-gradient-scaling:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] early-stopping: 1000
[2023-07-28 08:54:45] [config] early-stopping-on: first
[2023-07-28 08:54:45] [config] embedding-fix-src: false
[2023-07-28 08:54:45] [config] embedding-fix-trg: false
[2023-07-28 08:54:45] [config] embedding-normalization: false
[2023-07-28 08:54:45] [config] embedding-vectors:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] enc-cell: gru
[2023-07-28 08:54:45] [config] enc-cell-depth: 1
[2023-07-28 08:54:45] [config] enc-depth: 1
[2023-07-28 08:54:45] [config] enc-type: bidirectional
[2023-07-28 08:54:45] [config] english-title-case-every: 0
[2023-07-28 08:54:45] [config] exponential-smoothing: 0
[2023-07-28 08:54:45] [config] factor-weight: 1
[2023-07-28 08:54:45] [config] factors-combine: sum
[2023-07-28 08:54:45] [config] factors-dim-emb: 0
[2023-07-28 08:54:45] [config] gradient-checkpointing: false
[2023-07-28 08:54:45] [config] gradient-norm-average-window: 100
[2023-07-28 08:54:45] [config] guided-alignment: none
[2023-07-28 08:54:45] [config] guided-alignment-cost: mse
[2023-07-28 08:54:45] [config] guided-alignment-weight: 0.1
[2023-07-28 08:54:45] [config] ignore-model-config: false
[2023-07-28 08:54:45] [config] input-types:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] interpolate-env-vars: false
[2023-07-28 08:54:45] [config] keep-best: false
[2023-07-28 08:54:45] [config] label-smoothing: 0
[2023-07-28 08:54:45] [config] layer-normalization: false
[2023-07-28 08:54:45] [config] learn-rate: 0.0001
[2023-07-28 08:54:45] [config] lemma-dependency: ""
[2023-07-28 08:54:45] [config] lemma-dim-emb: 0
[2023-07-28 08:54:45] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:54:45] [config] log-level: info
[2023-07-28 08:54:45] [config] log-time-zone: ""
[2023-07-28 08:54:45] [config] logical-epoch:
[2023-07-28 08:54:45] [config]   - 1e
[2023-07-28 08:54:45] [config]   - 0
[2023-07-28 08:54:45] [config] lr-decay: 0
[2023-07-28 08:54:45] [config] lr-decay-freq: 50000
[2023-07-28 08:54:45] [config] lr-decay-inv-sqrt:
[2023-07-28 08:54:45] [config]   - 0
[2023-07-28 08:54:45] [config] lr-decay-repeat-warmup: false
[2023-07-28 08:54:45] [config] lr-decay-reset-optimizer: false
[2023-07-28 08:54:45] [config] lr-decay-start:
[2023-07-28 08:54:45] [config]   - 10
[2023-07-28 08:54:45] [config]   - 1
[2023-07-28 08:54:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 08:54:45] [config] lr-report: false
[2023-07-28 08:54:45] [config] lr-warmup: 0
[2023-07-28 08:54:45] [config] lr-warmup-at-reload: false
[2023-07-28 08:54:45] [config] lr-warmup-cycle: false
[2023-07-28 08:54:45] [config] lr-warmup-start-rate: 0
[2023-07-28 08:54:45] [config] max-length: 50
[2023-07-28 08:54:45] [config] max-length-crop: true
[2023-07-28 08:54:45] [config] max-length-factor: 3
[2023-07-28 08:54:45] [config] maxi-batch: 100
[2023-07-28 08:54:45] [config] maxi-batch-sort: trg
[2023-07-28 08:54:45] [config] mini-batch: 64
[2023-07-28 08:54:45] [config] mini-batch-fit: true
[2023-07-28 08:54:45] [config] mini-batch-fit-step: 10
[2023-07-28 08:54:45] [config] mini-batch-round-up: true
[2023-07-28 08:54:45] [config] mini-batch-track-lr: false
[2023-07-28 08:54:45] [config] mini-batch-warmup: 0
[2023-07-28 08:54:45] [config] mini-batch-words: 0
[2023-07-28 08:54:45] [config] mini-batch-words-ref: 0
[2023-07-28 08:54:45] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:54:45] [config] multi-loss-type: sum
[2023-07-28 08:54:45] [config] n-best: false
[2023-07-28 08:54:45] [config] no-nccl: false
[2023-07-28 08:54:45] [config] no-reload: false
[2023-07-28 08:54:45] [config] no-restore-corpus: false
[2023-07-28 08:54:45] [config] normalize: 0
[2023-07-28 08:54:45] [config] normalize-gradient: false
[2023-07-28 08:54:45] [config] num-devices: 0
[2023-07-28 08:54:45] [config] optimizer: adam
[2023-07-28 08:54:45] [config] optimizer-delay: 1
[2023-07-28 08:54:45] [config] optimizer-params:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] output-omit-bias: false
[2023-07-28 08:54:45] [config] overwrite: true
[2023-07-28 08:54:45] [config] precision:
[2023-07-28 08:54:45] [config]   - float16
[2023-07-28 08:54:45] [config]   - float32
[2023-07-28 08:54:45] [config] pretrained-model: ""
[2023-07-28 08:54:45] [config] quantize-biases: false
[2023-07-28 08:54:45] [config] quantize-bits: 0
[2023-07-28 08:54:45] [config] quantize-log-based: false
[2023-07-28 08:54:45] [config] quantize-optimization-steps: 0
[2023-07-28 08:54:45] [config] quiet: false
[2023-07-28 08:54:45] [config] quiet-translation: true
[2023-07-28 08:54:45] [config] relative-paths: false
[2023-07-28 08:54:45] [config] right-left: false
[2023-07-28 08:54:45] [config] save-freq: 10000u
[2023-07-28 08:54:45] [config] seed: 1234
[2023-07-28 08:54:45] [config] sentencepiece-alphas:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] sentencepiece-max-lines: 2000000
[2023-07-28 08:54:45] [config] sentencepiece-options: ""
[2023-07-28 08:54:45] [config] sharding: global
[2023-07-28 08:54:45] [config] shuffle: data
[2023-07-28 08:54:45] [config] shuffle-in-ram: false
[2023-07-28 08:54:45] [config] sigterm: save-and-exit
[2023-07-28 08:54:45] [config] skip: false
[2023-07-28 08:54:45] [config] sqlite: ""
[2023-07-28 08:54:45] [config] sqlite-drop: false
[2023-07-28 08:54:45] [config] sync-freq: 200u
[2023-07-28 08:54:45] [config] sync-sgd: false
[2023-07-28 08:54:45] [config] tempdir: /tmp
[2023-07-28 08:54:45] [config] tied-embeddings: false
[2023-07-28 08:54:45] [config] tied-embeddings-all: true
[2023-07-28 08:54:45] [config] tied-embeddings-src: false
[2023-07-28 08:54:45] [config] train-embedder-rank:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] train-sets:
[2023-07-28 08:54:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 08:54:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 08:54:45] [config] transformer-aan-activation: swish
[2023-07-28 08:54:45] [config] transformer-aan-depth: 2
[2023-07-28 08:54:45] [config] transformer-aan-nogate: false
[2023-07-28 08:54:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 08:54:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 08:54:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 08:54:45] [config] transformer-depth-scaling: false
[2023-07-28 08:54:45] [config] transformer-dim-aan: 2048
[2023-07-28 08:54:45] [config] transformer-dim-ffn: 2048
[2023-07-28 08:54:45] [config] transformer-dropout: 0
[2023-07-28 08:54:45] [config] transformer-dropout-attention: 0
[2023-07-28 08:54:45] [config] transformer-dropout-ffn: 0
[2023-07-28 08:54:45] [config] transformer-ffn-activation: swish
[2023-07-28 08:54:45] [config] transformer-ffn-depth: 2
[2023-07-28 08:54:45] [config] transformer-guided-alignment-layer: last
[2023-07-28 08:54:45] [config] transformer-heads: 8
[2023-07-28 08:54:45] [config] transformer-no-projection: false
[2023-07-28 08:54:45] [config] transformer-pool: false
[2023-07-28 08:54:45] [config] transformer-postprocess: dan
[2023-07-28 08:54:45] [config] transformer-postprocess-emb: d
[2023-07-28 08:54:45] [config] transformer-postprocess-top: ""
[2023-07-28 08:54:45] [config] transformer-preprocess: ""
[2023-07-28 08:54:45] [config] transformer-tied-layers:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] transformer-train-position-embeddings: false
[2023-07-28 08:54:45] [config] tsv: false
[2023-07-28 08:54:45] [config] tsv-fields: 0
[2023-07-28 08:54:45] [config] type: s2s
[2023-07-28 08:54:45] [config] ulr: false
[2023-07-28 08:54:45] [config] ulr-dim-emb: 0
[2023-07-28 08:54:45] [config] ulr-dropout: 0
[2023-07-28 08:54:45] [config] ulr-keys-vectors: ""
[2023-07-28 08:54:45] [config] ulr-query-vectors: ""
[2023-07-28 08:54:45] [config] ulr-softmax-temperature: 1
[2023-07-28 08:54:45] [config] ulr-trainable-transformation: false
[2023-07-28 08:54:45] [config] unlikelihood-loss: false
[2023-07-28 08:54:45] [config] valid-freq: 50000000
[2023-07-28 08:54:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 08:54:45] [config] valid-max-length: 1000
[2023-07-28 08:54:45] [config] valid-metrics:
[2023-07-28 08:54:45] [config]   - translation
[2023-07-28 08:54:45] [config] valid-mini-batch: 32
[2023-07-28 08:54:45] [config] valid-reset-stalled: false
[2023-07-28 08:54:45] [config] valid-script-args:
[2023-07-28 08:54:45] [config]   []
[2023-07-28 08:54:45] [config] valid-script-path: ""
[2023-07-28 08:54:45] [config] valid-sets:
[2023-07-28 08:54:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 08:54:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 08:54:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 08:54:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:54:45] [config] vocabs:
[2023-07-28 08:54:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:54:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:54:45] [config] word-penalty: 0
[2023-07-28 08:54:45] [config] word-scores: false
[2023-07-28 08:54:45] [config] workspace: 5500
[2023-07-28 08:54:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:54:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:54:45] [training] Using single-device training
[2023-07-28 08:54:46] Synced seed 1234
[2023-07-28 08:54:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:54:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 08:54:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:54:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 08:54:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 08:54:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:54:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 08:54:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:54:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:54:46] [comm] Using global sharding
[2023-07-28 08:54:47] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:54:47] [training] Using 1 GPUs
[2023-07-28 08:54:47] [logits] Applying loss function for 1 factor(s)
[2023-07-28 08:54:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:54:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 08:54:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:59:15] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 08:59:15] [valid] No post-processing script given for validating translator
[2023-07-28 08:59:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:59:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:59:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:59:15] [comm] Using global sharding
[2023-07-28 08:59:15] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:59:15] [training] Using 1 GPUs
[2023-07-28 08:59:15] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 08:59:17] Allocating memory for general optimizer shards
[2023-07-28 08:59:17] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:59:17] Loading Adam parameters
[2023-07-28 08:59:17] [memory] Reserving 322 MB, device gpu0
[2023-07-28 08:59:17] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:59:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 08:59:17] [data] Restoring the corpus state to epoch 301, batch 8194
[2023-07-28 08:59:17] [data] Shuffling data
[2023-07-28 08:59:17] [data] Done reading 20,192 sentences
[2023-07-28 08:59:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:59:17] Training started
[2023-07-28 08:59:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 08:59:18] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:59:22] Parameter type float16, optimization type float32, casting types true
[2023-07-28 09:00:27] Seen 20,192 samples
[2023-07-28 09:00:27] Starting data epoch 302 in logical epoch 302
[2023-07-28 09:00:27] [data] Shuffling data
[2023-07-28 09:00:28] [data] Done reading 20,192 sentences
[2023-07-28 09:00:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:01:38] Seen 20,192 samples
[2023-07-28 09:01:38] Starting data epoch 303 in logical epoch 303
[2023-07-28 09:01:38] [data] Shuffling data
[2023-07-28 09:01:38] [data] Done reading 20,192 sentences
[2023-07-28 09:01:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:02:49] Seen 20,192 samples
[2023-07-28 09:02:49] Starting data epoch 304 in logical epoch 304
[2023-07-28 09:02:49] [data] Shuffling data
[2023-07-28 09:02:49] [data] Done reading 20,192 sentences
[2023-07-28 09:02:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:04:02] Seen 20,192 samples
[2023-07-28 09:04:02] Starting data epoch 305 in logical epoch 305
[2023-07-28 09:04:02] [data] Shuffling data
[2023-07-28 09:04:02] [data] Done reading 20,192 sentences
[2023-07-28 09:04:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:05:14] Seen 20,192 samples
[2023-07-28 09:05:14] Starting data epoch 306 in logical epoch 306
[2023-07-28 09:05:14] [data] Shuffling data
[2023-07-28 09:05:14] [data] Done reading 20,192 sentences
[2023-07-28 09:05:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:06:29] Seen 20,192 samples
[2023-07-28 09:06:29] Starting data epoch 307 in logical epoch 307
[2023-07-28 09:06:29] [data] Shuffling data
[2023-07-28 09:06:29] [data] Done reading 20,192 sentences
[2023-07-28 09:06:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:07:42] Seen 20,192 samples
[2023-07-28 09:07:42] Starting data epoch 308 in logical epoch 308
[2023-07-28 09:07:42] [data] Shuffling data
[2023-07-28 09:07:42] [data] Done reading 20,192 sentences
[2023-07-28 09:07:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:08:54] Seen 20,192 samples
[2023-07-28 09:08:54] Starting data epoch 309 in logical epoch 309
[2023-07-28 09:08:54] [data] Shuffling data
[2023-07-28 09:08:54] [data] Done reading 20,192 sentences
[2023-07-28 09:08:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:10:08] Seen 20,192 samples
[2023-07-28 09:10:08] Starting data epoch 310 in logical epoch 310
[2023-07-28 09:10:08] [data] Shuffling data
[2023-07-28 09:10:08] [data] Done reading 20,192 sentences
[2023-07-28 09:10:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:11:24] Seen 20,192 samples
[2023-07-28 09:11:24] Starting data epoch 311 in logical epoch 311
[2023-07-28 09:11:24] Training finished
[2023-07-28 09:12:05] [valid] Ep. 311 : Up. 8467 : translation : 0 : new best
[2023-07-28 09:12:05] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:12:07] Saving Adam parameters
[2023-07-28 09:12:07] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 09:12:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:12:15] [marian] Running on node05.datos.cluster.uy as process 29315 with command line:
[2023-07-28 09:12:15] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 320 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 09:12:15] [config] after: 0e
[2023-07-28 09:12:15] [config] after-batches: 0
[2023-07-28 09:12:15] [config] after-epochs: 320
[2023-07-28 09:12:15] [config] all-caps-every: 0
[2023-07-28 09:12:15] [config] allow-unk: false
[2023-07-28 09:12:15] [config] authors: false
[2023-07-28 09:12:15] [config] beam-size: 12
[2023-07-28 09:12:15] [config] bert-class-symbol: "[CLS]"
[2023-07-28 09:12:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 09:12:15] [config] bert-masking-fraction: 0.15
[2023-07-28 09:12:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 09:12:15] [config] bert-train-type-embeddings: true
[2023-07-28 09:12:15] [config] bert-type-vocab-size: 2
[2023-07-28 09:12:15] [config] build-info: ""
[2023-07-28 09:12:15] [config] check-gradient-nan: false
[2023-07-28 09:12:15] [config] check-nan: false
[2023-07-28 09:12:15] [config] cite: false
[2023-07-28 09:12:15] [config] clip-norm: 1
[2023-07-28 09:12:15] [config] cost-scaling:
[2023-07-28 09:12:15] [config]   - 256.f
[2023-07-28 09:12:15] [config]   - 1000
[2023-07-28 09:12:15] [config]   - 2.f
[2023-07-28 09:12:15] [config]   - 256.f
[2023-07-28 09:12:15] [config] cost-type: ce-sum
[2023-07-28 09:12:15] [config] cpu-threads: 0
[2023-07-28 09:12:15] [config] data-threads: 8
[2023-07-28 09:12:15] [config] data-weighting: ""
[2023-07-28 09:12:15] [config] data-weighting-type: sentence
[2023-07-28 09:12:15] [config] dec-cell: gru
[2023-07-28 09:12:15] [config] dec-cell-base-depth: 2
[2023-07-28 09:12:15] [config] dec-cell-high-depth: 1
[2023-07-28 09:12:15] [config] dec-depth: 1
[2023-07-28 09:12:15] [config] devices:
[2023-07-28 09:12:15] [config]   - 0
[2023-07-28 09:12:15] [config] dim-emb: 512
[2023-07-28 09:12:15] [config] dim-rnn: 1024
[2023-07-28 09:12:15] [config] dim-vocabs:
[2023-07-28 09:12:15] [config]   - 16384
[2023-07-28 09:12:15] [config]   - 16384
[2023-07-28 09:12:15] [config] disp-first: 0
[2023-07-28 09:12:15] [config] disp-freq: 1000u
[2023-07-28 09:12:15] [config] disp-label-counts: true
[2023-07-28 09:12:15] [config] dropout-rnn: 0
[2023-07-28 09:12:15] [config] dropout-src: 0
[2023-07-28 09:12:15] [config] dropout-trg: 0
[2023-07-28 09:12:15] [config] dump-config: ""
[2023-07-28 09:12:15] [config] dynamic-gradient-scaling:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] early-stopping: 1000
[2023-07-28 09:12:15] [config] early-stopping-on: first
[2023-07-28 09:12:15] [config] embedding-fix-src: false
[2023-07-28 09:12:15] [config] embedding-fix-trg: false
[2023-07-28 09:12:15] [config] embedding-normalization: false
[2023-07-28 09:12:15] [config] embedding-vectors:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] enc-cell: gru
[2023-07-28 09:12:15] [config] enc-cell-depth: 1
[2023-07-28 09:12:15] [config] enc-depth: 1
[2023-07-28 09:12:15] [config] enc-type: bidirectional
[2023-07-28 09:12:15] [config] english-title-case-every: 0
[2023-07-28 09:12:15] [config] exponential-smoothing: 0
[2023-07-28 09:12:15] [config] factor-weight: 1
[2023-07-28 09:12:15] [config] factors-combine: sum
[2023-07-28 09:12:15] [config] factors-dim-emb: 0
[2023-07-28 09:12:15] [config] gradient-checkpointing: false
[2023-07-28 09:12:15] [config] gradient-norm-average-window: 100
[2023-07-28 09:12:15] [config] guided-alignment: none
[2023-07-28 09:12:15] [config] guided-alignment-cost: mse
[2023-07-28 09:12:15] [config] guided-alignment-weight: 0.1
[2023-07-28 09:12:15] [config] ignore-model-config: false
[2023-07-28 09:12:15] [config] input-types:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] interpolate-env-vars: false
[2023-07-28 09:12:15] [config] keep-best: false
[2023-07-28 09:12:15] [config] label-smoothing: 0
[2023-07-28 09:12:15] [config] layer-normalization: false
[2023-07-28 09:12:15] [config] learn-rate: 0.0001
[2023-07-28 09:12:15] [config] lemma-dependency: ""
[2023-07-28 09:12:15] [config] lemma-dim-emb: 0
[2023-07-28 09:12:15] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 09:12:15] [config] log-level: info
[2023-07-28 09:12:15] [config] log-time-zone: ""
[2023-07-28 09:12:15] [config] logical-epoch:
[2023-07-28 09:12:15] [config]   - 1e
[2023-07-28 09:12:15] [config]   - 0
[2023-07-28 09:12:15] [config] lr-decay: 0
[2023-07-28 09:12:15] [config] lr-decay-freq: 50000
[2023-07-28 09:12:15] [config] lr-decay-inv-sqrt:
[2023-07-28 09:12:15] [config]   - 0
[2023-07-28 09:12:15] [config] lr-decay-repeat-warmup: false
[2023-07-28 09:12:15] [config] lr-decay-reset-optimizer: false
[2023-07-28 09:12:15] [config] lr-decay-start:
[2023-07-28 09:12:15] [config]   - 10
[2023-07-28 09:12:15] [config]   - 1
[2023-07-28 09:12:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 09:12:15] [config] lr-report: false
[2023-07-28 09:12:15] [config] lr-warmup: 0
[2023-07-28 09:12:15] [config] lr-warmup-at-reload: false
[2023-07-28 09:12:15] [config] lr-warmup-cycle: false
[2023-07-28 09:12:15] [config] lr-warmup-start-rate: 0
[2023-07-28 09:12:15] [config] max-length: 50
[2023-07-28 09:12:15] [config] max-length-crop: true
[2023-07-28 09:12:15] [config] max-length-factor: 3
[2023-07-28 09:12:15] [config] maxi-batch: 100
[2023-07-28 09:12:15] [config] maxi-batch-sort: trg
[2023-07-28 09:12:15] [config] mini-batch: 64
[2023-07-28 09:12:15] [config] mini-batch-fit: true
[2023-07-28 09:12:15] [config] mini-batch-fit-step: 10
[2023-07-28 09:12:15] [config] mini-batch-round-up: true
[2023-07-28 09:12:15] [config] mini-batch-track-lr: false
[2023-07-28 09:12:15] [config] mini-batch-warmup: 0
[2023-07-28 09:12:15] [config] mini-batch-words: 0
[2023-07-28 09:12:15] [config] mini-batch-words-ref: 0
[2023-07-28 09:12:15] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:12:15] [config] multi-loss-type: sum
[2023-07-28 09:12:15] [config] n-best: false
[2023-07-28 09:12:15] [config] no-nccl: false
[2023-07-28 09:12:15] [config] no-reload: false
[2023-07-28 09:12:15] [config] no-restore-corpus: false
[2023-07-28 09:12:15] [config] normalize: 0
[2023-07-28 09:12:15] [config] normalize-gradient: false
[2023-07-28 09:12:15] [config] num-devices: 0
[2023-07-28 09:12:15] [config] optimizer: adam
[2023-07-28 09:12:15] [config] optimizer-delay: 1
[2023-07-28 09:12:15] [config] optimizer-params:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] output-omit-bias: false
[2023-07-28 09:12:15] [config] overwrite: true
[2023-07-28 09:12:15] [config] precision:
[2023-07-28 09:12:15] [config]   - float16
[2023-07-28 09:12:15] [config]   - float32
[2023-07-28 09:12:15] [config] pretrained-model: ""
[2023-07-28 09:12:15] [config] quantize-biases: false
[2023-07-28 09:12:15] [config] quantize-bits: 0
[2023-07-28 09:12:15] [config] quantize-log-based: false
[2023-07-28 09:12:15] [config] quantize-optimization-steps: 0
[2023-07-28 09:12:15] [config] quiet: false
[2023-07-28 09:12:15] [config] quiet-translation: true
[2023-07-28 09:12:15] [config] relative-paths: false
[2023-07-28 09:12:15] [config] right-left: false
[2023-07-28 09:12:15] [config] save-freq: 10000u
[2023-07-28 09:12:15] [config] seed: 1234
[2023-07-28 09:12:15] [config] sentencepiece-alphas:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] sentencepiece-max-lines: 2000000
[2023-07-28 09:12:15] [config] sentencepiece-options: ""
[2023-07-28 09:12:15] [config] sharding: global
[2023-07-28 09:12:15] [config] shuffle: data
[2023-07-28 09:12:15] [config] shuffle-in-ram: false
[2023-07-28 09:12:15] [config] sigterm: save-and-exit
[2023-07-28 09:12:15] [config] skip: false
[2023-07-28 09:12:15] [config] sqlite: ""
[2023-07-28 09:12:15] [config] sqlite-drop: false
[2023-07-28 09:12:15] [config] sync-freq: 200u
[2023-07-28 09:12:15] [config] sync-sgd: false
[2023-07-28 09:12:15] [config] tempdir: /tmp
[2023-07-28 09:12:15] [config] tied-embeddings: false
[2023-07-28 09:12:15] [config] tied-embeddings-all: true
[2023-07-28 09:12:15] [config] tied-embeddings-src: false
[2023-07-28 09:12:15] [config] train-embedder-rank:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] train-sets:
[2023-07-28 09:12:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 09:12:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 09:12:15] [config] transformer-aan-activation: swish
[2023-07-28 09:12:15] [config] transformer-aan-depth: 2
[2023-07-28 09:12:15] [config] transformer-aan-nogate: false
[2023-07-28 09:12:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 09:12:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 09:12:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 09:12:15] [config] transformer-depth-scaling: false
[2023-07-28 09:12:15] [config] transformer-dim-aan: 2048
[2023-07-28 09:12:15] [config] transformer-dim-ffn: 2048
[2023-07-28 09:12:15] [config] transformer-dropout: 0
[2023-07-28 09:12:15] [config] transformer-dropout-attention: 0
[2023-07-28 09:12:15] [config] transformer-dropout-ffn: 0
[2023-07-28 09:12:15] [config] transformer-ffn-activation: swish
[2023-07-28 09:12:15] [config] transformer-ffn-depth: 2
[2023-07-28 09:12:15] [config] transformer-guided-alignment-layer: last
[2023-07-28 09:12:15] [config] transformer-heads: 8
[2023-07-28 09:12:15] [config] transformer-no-projection: false
[2023-07-28 09:12:15] [config] transformer-pool: false
[2023-07-28 09:12:15] [config] transformer-postprocess: dan
[2023-07-28 09:12:15] [config] transformer-postprocess-emb: d
[2023-07-28 09:12:15] [config] transformer-postprocess-top: ""
[2023-07-28 09:12:15] [config] transformer-preprocess: ""
[2023-07-28 09:12:15] [config] transformer-tied-layers:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] transformer-train-position-embeddings: false
[2023-07-28 09:12:15] [config] tsv: false
[2023-07-28 09:12:15] [config] tsv-fields: 0
[2023-07-28 09:12:15] [config] type: s2s
[2023-07-28 09:12:15] [config] ulr: false
[2023-07-28 09:12:15] [config] ulr-dim-emb: 0
[2023-07-28 09:12:15] [config] ulr-dropout: 0
[2023-07-28 09:12:15] [config] ulr-keys-vectors: ""
[2023-07-28 09:12:15] [config] ulr-query-vectors: ""
[2023-07-28 09:12:15] [config] ulr-softmax-temperature: 1
[2023-07-28 09:12:15] [config] ulr-trainable-transformation: false
[2023-07-28 09:12:15] [config] unlikelihood-loss: false
[2023-07-28 09:12:15] [config] valid-freq: 50000000
[2023-07-28 09:12:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 09:12:15] [config] valid-max-length: 1000
[2023-07-28 09:12:15] [config] valid-metrics:
[2023-07-28 09:12:15] [config]   - translation
[2023-07-28 09:12:15] [config] valid-mini-batch: 32
[2023-07-28 09:12:15] [config] valid-reset-stalled: false
[2023-07-28 09:12:15] [config] valid-script-args:
[2023-07-28 09:12:15] [config]   []
[2023-07-28 09:12:15] [config] valid-script-path: ""
[2023-07-28 09:12:15] [config] valid-sets:
[2023-07-28 09:12:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 09:12:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 09:12:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 09:12:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:12:15] [config] vocabs:
[2023-07-28 09:12:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:12:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:12:15] [config] word-penalty: 0
[2023-07-28 09:12:15] [config] word-scores: false
[2023-07-28 09:12:15] [config] workspace: 5500
[2023-07-28 09:12:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:12:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:12:15] [training] Using single-device training
[2023-07-28 09:12:15] Synced seed 1234
[2023-07-28 09:12:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:12:15] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 09:12:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:12:15] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 09:12:15] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 09:12:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:12:15] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 09:12:16] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:12:16] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:12:16] [comm] Using global sharding
[2023-07-28 09:12:16] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:12:16] [training] Using 1 GPUs
[2023-07-28 09:12:16] [logits] Applying loss function for 1 factor(s)
[2023-07-28 09:12:16] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:12:16] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 09:12:16] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:16:48] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 09:16:48] [valid] No post-processing script given for validating translator
[2023-07-28 09:16:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:16:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:16:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:16:48] [comm] Using global sharding
[2023-07-28 09:16:48] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:16:48] [training] Using 1 GPUs
[2023-07-28 09:16:48] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:16:49] Allocating memory for general optimizer shards
[2023-07-28 09:16:49] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:16:49] Loading Adam parameters
[2023-07-28 09:16:49] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:16:49] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:16:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 09:16:50] [data] Restoring the corpus state to epoch 311, batch 8467
[2023-07-28 09:16:50] [data] Shuffling data
[2023-07-28 09:16:50] [data] Done reading 20,192 sentences
[2023-07-28 09:16:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:16:50] Training started
[2023-07-28 09:16:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 09:16:50] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:16:52] Parameter type float16, optimization type float32, casting types true
[2023-07-28 09:18:01] Seen 20,192 samples
[2023-07-28 09:18:01] Starting data epoch 312 in logical epoch 312
[2023-07-28 09:18:01] [data] Shuffling data
[2023-07-28 09:18:01] [data] Done reading 20,192 sentences
[2023-07-28 09:18:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:19:11] Seen 20,192 samples
[2023-07-28 09:19:11] Starting data epoch 313 in logical epoch 313
[2023-07-28 09:19:11] [data] Shuffling data
[2023-07-28 09:19:11] [data] Done reading 20,192 sentences
[2023-07-28 09:19:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:20:24] Seen 20,192 samples
[2023-07-28 09:20:24] Starting data epoch 314 in logical epoch 314
[2023-07-28 09:20:24] [data] Shuffling data
[2023-07-28 09:20:24] [data] Done reading 20,192 sentences
[2023-07-28 09:20:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:21:37] Seen 20,192 samples
[2023-07-28 09:21:37] Starting data epoch 315 in logical epoch 315
[2023-07-28 09:21:37] [data] Shuffling data
[2023-07-28 09:21:37] [data] Done reading 20,192 sentences
[2023-07-28 09:21:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:22:50] Seen 20,192 samples
[2023-07-28 09:22:50] Starting data epoch 316 in logical epoch 316
[2023-07-28 09:22:50] [data] Shuffling data
[2023-07-28 09:22:50] [data] Done reading 20,192 sentences
[2023-07-28 09:22:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:24:03] Seen 20,192 samples
[2023-07-28 09:24:03] Starting data epoch 317 in logical epoch 317
[2023-07-28 09:24:03] [data] Shuffling data
[2023-07-28 09:24:03] [data] Done reading 20,192 sentences
[2023-07-28 09:24:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:25:16] Seen 20,192 samples
[2023-07-28 09:25:16] Starting data epoch 318 in logical epoch 318
[2023-07-28 09:25:16] [data] Shuffling data
[2023-07-28 09:25:16] [data] Done reading 20,192 sentences
[2023-07-28 09:25:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:26:30] Seen 20,192 samples
[2023-07-28 09:26:30] Starting data epoch 319 in logical epoch 319
[2023-07-28 09:26:30] [data] Shuffling data
[2023-07-28 09:26:30] [data] Done reading 20,192 sentences
[2023-07-28 09:26:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:27:42] Seen 20,192 samples
[2023-07-28 09:27:42] Starting data epoch 320 in logical epoch 320
[2023-07-28 09:27:42] [data] Shuffling data
[2023-07-28 09:27:42] [data] Done reading 20,192 sentences
[2023-07-28 09:27:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:28:57] Seen 20,192 samples
[2023-07-28 09:28:57] Starting data epoch 321 in logical epoch 321
[2023-07-28 09:28:57] Training finished
[2023-07-28 09:29:39] [valid] Ep. 321 : Up. 8743 : translation : 0 : new best
[2023-07-28 09:29:39] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:29:42] Saving Adam parameters
[2023-07-28 09:29:43] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 09:29:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:29:54] [marian] Running on node05.datos.cluster.uy as process 30605 with command line:
[2023-07-28 09:29:54] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 330 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 09:29:54] [config] after: 0e
[2023-07-28 09:29:54] [config] after-batches: 0
[2023-07-28 09:29:54] [config] after-epochs: 330
[2023-07-28 09:29:54] [config] all-caps-every: 0
[2023-07-28 09:29:54] [config] allow-unk: false
[2023-07-28 09:29:54] [config] authors: false
[2023-07-28 09:29:54] [config] beam-size: 12
[2023-07-28 09:29:54] [config] bert-class-symbol: "[CLS]"
[2023-07-28 09:29:54] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 09:29:54] [config] bert-masking-fraction: 0.15
[2023-07-28 09:29:54] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 09:29:54] [config] bert-train-type-embeddings: true
[2023-07-28 09:29:54] [config] bert-type-vocab-size: 2
[2023-07-28 09:29:54] [config] build-info: ""
[2023-07-28 09:29:54] [config] check-gradient-nan: false
[2023-07-28 09:29:54] [config] check-nan: false
[2023-07-28 09:29:54] [config] cite: false
[2023-07-28 09:29:54] [config] clip-norm: 1
[2023-07-28 09:29:54] [config] cost-scaling:
[2023-07-28 09:29:54] [config]   - 256.f
[2023-07-28 09:29:54] [config]   - 1000
[2023-07-28 09:29:54] [config]   - 2.f
[2023-07-28 09:29:54] [config]   - 256.f
[2023-07-28 09:29:54] [config] cost-type: ce-sum
[2023-07-28 09:29:54] [config] cpu-threads: 0
[2023-07-28 09:29:54] [config] data-threads: 8
[2023-07-28 09:29:54] [config] data-weighting: ""
[2023-07-28 09:29:54] [config] data-weighting-type: sentence
[2023-07-28 09:29:54] [config] dec-cell: gru
[2023-07-28 09:29:54] [config] dec-cell-base-depth: 2
[2023-07-28 09:29:54] [config] dec-cell-high-depth: 1
[2023-07-28 09:29:54] [config] dec-depth: 1
[2023-07-28 09:29:54] [config] devices:
[2023-07-28 09:29:54] [config]   - 0
[2023-07-28 09:29:54] [config] dim-emb: 512
[2023-07-28 09:29:54] [config] dim-rnn: 1024
[2023-07-28 09:29:54] [config] dim-vocabs:
[2023-07-28 09:29:54] [config]   - 16384
[2023-07-28 09:29:54] [config]   - 16384
[2023-07-28 09:29:54] [config] disp-first: 0
[2023-07-28 09:29:54] [config] disp-freq: 1000u
[2023-07-28 09:29:54] [config] disp-label-counts: true
[2023-07-28 09:29:54] [config] dropout-rnn: 0
[2023-07-28 09:29:54] [config] dropout-src: 0
[2023-07-28 09:29:54] [config] dropout-trg: 0
[2023-07-28 09:29:54] [config] dump-config: ""
[2023-07-28 09:29:54] [config] dynamic-gradient-scaling:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] early-stopping: 1000
[2023-07-28 09:29:54] [config] early-stopping-on: first
[2023-07-28 09:29:54] [config] embedding-fix-src: false
[2023-07-28 09:29:54] [config] embedding-fix-trg: false
[2023-07-28 09:29:54] [config] embedding-normalization: false
[2023-07-28 09:29:54] [config] embedding-vectors:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] enc-cell: gru
[2023-07-28 09:29:54] [config] enc-cell-depth: 1
[2023-07-28 09:29:54] [config] enc-depth: 1
[2023-07-28 09:29:54] [config] enc-type: bidirectional
[2023-07-28 09:29:54] [config] english-title-case-every: 0
[2023-07-28 09:29:54] [config] exponential-smoothing: 0
[2023-07-28 09:29:54] [config] factor-weight: 1
[2023-07-28 09:29:54] [config] factors-combine: sum
[2023-07-28 09:29:54] [config] factors-dim-emb: 0
[2023-07-28 09:29:54] [config] gradient-checkpointing: false
[2023-07-28 09:29:54] [config] gradient-norm-average-window: 100
[2023-07-28 09:29:54] [config] guided-alignment: none
[2023-07-28 09:29:54] [config] guided-alignment-cost: mse
[2023-07-28 09:29:54] [config] guided-alignment-weight: 0.1
[2023-07-28 09:29:54] [config] ignore-model-config: false
[2023-07-28 09:29:54] [config] input-types:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] interpolate-env-vars: false
[2023-07-28 09:29:54] [config] keep-best: false
[2023-07-28 09:29:54] [config] label-smoothing: 0
[2023-07-28 09:29:54] [config] layer-normalization: false
[2023-07-28 09:29:54] [config] learn-rate: 0.0001
[2023-07-28 09:29:54] [config] lemma-dependency: ""
[2023-07-28 09:29:54] [config] lemma-dim-emb: 0
[2023-07-28 09:29:54] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 09:29:54] [config] log-level: info
[2023-07-28 09:29:54] [config] log-time-zone: ""
[2023-07-28 09:29:54] [config] logical-epoch:
[2023-07-28 09:29:54] [config]   - 1e
[2023-07-28 09:29:54] [config]   - 0
[2023-07-28 09:29:54] [config] lr-decay: 0
[2023-07-28 09:29:54] [config] lr-decay-freq: 50000
[2023-07-28 09:29:54] [config] lr-decay-inv-sqrt:
[2023-07-28 09:29:54] [config]   - 0
[2023-07-28 09:29:54] [config] lr-decay-repeat-warmup: false
[2023-07-28 09:29:54] [config] lr-decay-reset-optimizer: false
[2023-07-28 09:29:54] [config] lr-decay-start:
[2023-07-28 09:29:54] [config]   - 10
[2023-07-28 09:29:54] [config]   - 1
[2023-07-28 09:29:54] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 09:29:54] [config] lr-report: false
[2023-07-28 09:29:54] [config] lr-warmup: 0
[2023-07-28 09:29:54] [config] lr-warmup-at-reload: false
[2023-07-28 09:29:54] [config] lr-warmup-cycle: false
[2023-07-28 09:29:54] [config] lr-warmup-start-rate: 0
[2023-07-28 09:29:54] [config] max-length: 50
[2023-07-28 09:29:54] [config] max-length-crop: true
[2023-07-28 09:29:54] [config] max-length-factor: 3
[2023-07-28 09:29:54] [config] maxi-batch: 100
[2023-07-28 09:29:54] [config] maxi-batch-sort: trg
[2023-07-28 09:29:54] [config] mini-batch: 64
[2023-07-28 09:29:54] [config] mini-batch-fit: true
[2023-07-28 09:29:54] [config] mini-batch-fit-step: 10
[2023-07-28 09:29:54] [config] mini-batch-round-up: true
[2023-07-28 09:29:54] [config] mini-batch-track-lr: false
[2023-07-28 09:29:54] [config] mini-batch-warmup: 0
[2023-07-28 09:29:54] [config] mini-batch-words: 0
[2023-07-28 09:29:54] [config] mini-batch-words-ref: 0
[2023-07-28 09:29:54] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:29:54] [config] multi-loss-type: sum
[2023-07-28 09:29:54] [config] n-best: false
[2023-07-28 09:29:54] [config] no-nccl: false
[2023-07-28 09:29:54] [config] no-reload: false
[2023-07-28 09:29:54] [config] no-restore-corpus: false
[2023-07-28 09:29:54] [config] normalize: 0
[2023-07-28 09:29:54] [config] normalize-gradient: false
[2023-07-28 09:29:54] [config] num-devices: 0
[2023-07-28 09:29:54] [config] optimizer: adam
[2023-07-28 09:29:54] [config] optimizer-delay: 1
[2023-07-28 09:29:54] [config] optimizer-params:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] output-omit-bias: false
[2023-07-28 09:29:54] [config] overwrite: true
[2023-07-28 09:29:54] [config] precision:
[2023-07-28 09:29:54] [config]   - float16
[2023-07-28 09:29:54] [config]   - float32
[2023-07-28 09:29:54] [config] pretrained-model: ""
[2023-07-28 09:29:54] [config] quantize-biases: false
[2023-07-28 09:29:54] [config] quantize-bits: 0
[2023-07-28 09:29:54] [config] quantize-log-based: false
[2023-07-28 09:29:54] [config] quantize-optimization-steps: 0
[2023-07-28 09:29:54] [config] quiet: false
[2023-07-28 09:29:54] [config] quiet-translation: true
[2023-07-28 09:29:54] [config] relative-paths: false
[2023-07-28 09:29:54] [config] right-left: false
[2023-07-28 09:29:54] [config] save-freq: 10000u
[2023-07-28 09:29:54] [config] seed: 1234
[2023-07-28 09:29:54] [config] sentencepiece-alphas:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] sentencepiece-max-lines: 2000000
[2023-07-28 09:29:54] [config] sentencepiece-options: ""
[2023-07-28 09:29:54] [config] sharding: global
[2023-07-28 09:29:54] [config] shuffle: data
[2023-07-28 09:29:54] [config] shuffle-in-ram: false
[2023-07-28 09:29:54] [config] sigterm: save-and-exit
[2023-07-28 09:29:54] [config] skip: false
[2023-07-28 09:29:54] [config] sqlite: ""
[2023-07-28 09:29:54] [config] sqlite-drop: false
[2023-07-28 09:29:54] [config] sync-freq: 200u
[2023-07-28 09:29:54] [config] sync-sgd: false
[2023-07-28 09:29:54] [config] tempdir: /tmp
[2023-07-28 09:29:54] [config] tied-embeddings: false
[2023-07-28 09:29:54] [config] tied-embeddings-all: true
[2023-07-28 09:29:54] [config] tied-embeddings-src: false
[2023-07-28 09:29:54] [config] train-embedder-rank:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] train-sets:
[2023-07-28 09:29:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 09:29:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 09:29:54] [config] transformer-aan-activation: swish
[2023-07-28 09:29:54] [config] transformer-aan-depth: 2
[2023-07-28 09:29:54] [config] transformer-aan-nogate: false
[2023-07-28 09:29:54] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 09:29:54] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 09:29:54] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 09:29:54] [config] transformer-depth-scaling: false
[2023-07-28 09:29:54] [config] transformer-dim-aan: 2048
[2023-07-28 09:29:54] [config] transformer-dim-ffn: 2048
[2023-07-28 09:29:54] [config] transformer-dropout: 0
[2023-07-28 09:29:54] [config] transformer-dropout-attention: 0
[2023-07-28 09:29:54] [config] transformer-dropout-ffn: 0
[2023-07-28 09:29:54] [config] transformer-ffn-activation: swish
[2023-07-28 09:29:54] [config] transformer-ffn-depth: 2
[2023-07-28 09:29:54] [config] transformer-guided-alignment-layer: last
[2023-07-28 09:29:54] [config] transformer-heads: 8
[2023-07-28 09:29:54] [config] transformer-no-projection: false
[2023-07-28 09:29:54] [config] transformer-pool: false
[2023-07-28 09:29:54] [config] transformer-postprocess: dan
[2023-07-28 09:29:54] [config] transformer-postprocess-emb: d
[2023-07-28 09:29:54] [config] transformer-postprocess-top: ""
[2023-07-28 09:29:54] [config] transformer-preprocess: ""
[2023-07-28 09:29:54] [config] transformer-tied-layers:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] transformer-train-position-embeddings: false
[2023-07-28 09:29:54] [config] tsv: false
[2023-07-28 09:29:54] [config] tsv-fields: 0
[2023-07-28 09:29:54] [config] type: s2s
[2023-07-28 09:29:54] [config] ulr: false
[2023-07-28 09:29:54] [config] ulr-dim-emb: 0
[2023-07-28 09:29:54] [config] ulr-dropout: 0
[2023-07-28 09:29:54] [config] ulr-keys-vectors: ""
[2023-07-28 09:29:54] [config] ulr-query-vectors: ""
[2023-07-28 09:29:54] [config] ulr-softmax-temperature: 1
[2023-07-28 09:29:54] [config] ulr-trainable-transformation: false
[2023-07-28 09:29:54] [config] unlikelihood-loss: false
[2023-07-28 09:29:54] [config] valid-freq: 50000000
[2023-07-28 09:29:54] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 09:29:54] [config] valid-max-length: 1000
[2023-07-28 09:29:54] [config] valid-metrics:
[2023-07-28 09:29:54] [config]   - translation
[2023-07-28 09:29:54] [config] valid-mini-batch: 32
[2023-07-28 09:29:54] [config] valid-reset-stalled: false
[2023-07-28 09:29:54] [config] valid-script-args:
[2023-07-28 09:29:54] [config]   []
[2023-07-28 09:29:54] [config] valid-script-path: ""
[2023-07-28 09:29:54] [config] valid-sets:
[2023-07-28 09:29:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 09:29:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 09:29:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 09:29:54] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:29:54] [config] vocabs:
[2023-07-28 09:29:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:29:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:29:54] [config] word-penalty: 0
[2023-07-28 09:29:54] [config] word-scores: false
[2023-07-28 09:29:54] [config] workspace: 5500
[2023-07-28 09:29:54] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:29:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:29:54] [training] Using single-device training
[2023-07-28 09:29:54] Synced seed 1234
[2023-07-28 09:29:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:29:54] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 09:29:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:29:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 09:29:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 09:29:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:29:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 09:29:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:29:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:29:55] [comm] Using global sharding
[2023-07-28 09:29:55] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:29:55] [training] Using 1 GPUs
[2023-07-28 09:29:55] [logits] Applying loss function for 1 factor(s)
[2023-07-28 09:29:55] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:29:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 09:29:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:34:27] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 09:34:27] [valid] No post-processing script given for validating translator
[2023-07-28 09:34:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:34:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:34:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:34:27] [comm] Using global sharding
[2023-07-28 09:34:28] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:34:28] [training] Using 1 GPUs
[2023-07-28 09:34:28] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:34:29] Allocating memory for general optimizer shards
[2023-07-28 09:34:29] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:34:29] Loading Adam parameters
[2023-07-28 09:34:29] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:34:29] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:34:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 09:34:29] [data] Restoring the corpus state to epoch 321, batch 8743
[2023-07-28 09:34:29] [data] Shuffling data
[2023-07-28 09:34:29] [data] Done reading 20,192 sentences
[2023-07-28 09:34:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:34:29] Training started
[2023-07-28 09:34:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 09:34:30] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:34:33] Parameter type float16, optimization type float32, casting types true
[2023-07-28 09:35:40] Seen 20,192 samples
[2023-07-28 09:35:40] Starting data epoch 322 in logical epoch 322
[2023-07-28 09:35:40] [data] Shuffling data
[2023-07-28 09:35:40] [data] Done reading 20,192 sentences
[2023-07-28 09:35:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:36:49] Seen 20,192 samples
[2023-07-28 09:36:49] Starting data epoch 323 in logical epoch 323
[2023-07-28 09:36:49] [data] Shuffling data
[2023-07-28 09:36:49] [data] Done reading 20,192 sentences
[2023-07-28 09:36:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:38:00] Seen 20,192 samples
[2023-07-28 09:38:00] Starting data epoch 324 in logical epoch 324
[2023-07-28 09:38:00] [data] Shuffling data
[2023-07-28 09:38:00] [data] Done reading 20,192 sentences
[2023-07-28 09:38:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:39:12] Seen 20,192 samples
[2023-07-28 09:39:12] Starting data epoch 325 in logical epoch 325
[2023-07-28 09:39:12] [data] Shuffling data
[2023-07-28 09:39:12] [data] Done reading 20,192 sentences
[2023-07-28 09:39:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:40:25] Seen 20,192 samples
[2023-07-28 09:40:25] Starting data epoch 326 in logical epoch 326
[2023-07-28 09:40:25] [data] Shuffling data
[2023-07-28 09:40:25] [data] Done reading 20,192 sentences
[2023-07-28 09:40:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:41:38] Seen 20,192 samples
[2023-07-28 09:41:38] Starting data epoch 327 in logical epoch 327
[2023-07-28 09:41:38] [data] Shuffling data
[2023-07-28 09:41:38] [data] Done reading 20,192 sentences
[2023-07-28 09:41:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:42:51] Seen 20,192 samples
[2023-07-28 09:42:51] Starting data epoch 328 in logical epoch 328
[2023-07-28 09:42:51] [data] Shuffling data
[2023-07-28 09:42:51] [data] Done reading 20,192 sentences
[2023-07-28 09:42:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:44:05] Seen 20,192 samples
[2023-07-28 09:44:05] Starting data epoch 329 in logical epoch 329
[2023-07-28 09:44:05] [data] Shuffling data
[2023-07-28 09:44:05] [data] Done reading 20,192 sentences
[2023-07-28 09:44:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:45:18] Seen 20,192 samples
[2023-07-28 09:45:18] Starting data epoch 330 in logical epoch 330
[2023-07-28 09:45:18] [data] Shuffling data
[2023-07-28 09:45:18] [data] Done reading 20,192 sentences
[2023-07-28 09:45:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:45:40] Ep. 330 : Up. 9000 : Sen. 5,228 : Cost 2.39924717 * 20,587,364 @ 19,396 after 186,749,418 : Time 672.83s : 30597.96 words/s : gNorm 2.0269
[2023-07-28 09:46:33] Seen 20,192 samples
[2023-07-28 09:46:33] Starting data epoch 331 in logical epoch 331
[2023-07-28 09:46:33] Training finished
[2023-07-28 09:47:15] [valid] Ep. 331 : Up. 9020 : translation : 0 : new best
[2023-07-28 09:47:15] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:47:17] Saving Adam parameters
[2023-07-28 09:47:17] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 09:47:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:47:24] [marian] Running on node05.datos.cluster.uy as process 31568 with command line:
[2023-07-28 09:47:24] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 340 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 09:47:24] [config] after: 0e
[2023-07-28 09:47:24] [config] after-batches: 0
[2023-07-28 09:47:24] [config] after-epochs: 340
[2023-07-28 09:47:24] [config] all-caps-every: 0
[2023-07-28 09:47:24] [config] allow-unk: false
[2023-07-28 09:47:24] [config] authors: false
[2023-07-28 09:47:24] [config] beam-size: 12
[2023-07-28 09:47:24] [config] bert-class-symbol: "[CLS]"
[2023-07-28 09:47:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 09:47:24] [config] bert-masking-fraction: 0.15
[2023-07-28 09:47:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 09:47:24] [config] bert-train-type-embeddings: true
[2023-07-28 09:47:24] [config] bert-type-vocab-size: 2
[2023-07-28 09:47:24] [config] build-info: ""
[2023-07-28 09:47:24] [config] check-gradient-nan: false
[2023-07-28 09:47:24] [config] check-nan: false
[2023-07-28 09:47:24] [config] cite: false
[2023-07-28 09:47:24] [config] clip-norm: 1
[2023-07-28 09:47:24] [config] cost-scaling:
[2023-07-28 09:47:24] [config]   - 256.f
[2023-07-28 09:47:24] [config]   - 1000
[2023-07-28 09:47:24] [config]   - 2.f
[2023-07-28 09:47:24] [config]   - 256.f
[2023-07-28 09:47:24] [config] cost-type: ce-sum
[2023-07-28 09:47:24] [config] cpu-threads: 0
[2023-07-28 09:47:24] [config] data-threads: 8
[2023-07-28 09:47:24] [config] data-weighting: ""
[2023-07-28 09:47:24] [config] data-weighting-type: sentence
[2023-07-28 09:47:24] [config] dec-cell: gru
[2023-07-28 09:47:24] [config] dec-cell-base-depth: 2
[2023-07-28 09:47:24] [config] dec-cell-high-depth: 1
[2023-07-28 09:47:24] [config] dec-depth: 1
[2023-07-28 09:47:24] [config] devices:
[2023-07-28 09:47:24] [config]   - 0
[2023-07-28 09:47:24] [config] dim-emb: 512
[2023-07-28 09:47:24] [config] dim-rnn: 1024
[2023-07-28 09:47:24] [config] dim-vocabs:
[2023-07-28 09:47:24] [config]   - 16384
[2023-07-28 09:47:24] [config]   - 16384
[2023-07-28 09:47:24] [config] disp-first: 0
[2023-07-28 09:47:24] [config] disp-freq: 1000u
[2023-07-28 09:47:24] [config] disp-label-counts: true
[2023-07-28 09:47:24] [config] dropout-rnn: 0
[2023-07-28 09:47:24] [config] dropout-src: 0
[2023-07-28 09:47:24] [config] dropout-trg: 0
[2023-07-28 09:47:24] [config] dump-config: ""
[2023-07-28 09:47:24] [config] dynamic-gradient-scaling:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] early-stopping: 1000
[2023-07-28 09:47:24] [config] early-stopping-on: first
[2023-07-28 09:47:24] [config] embedding-fix-src: false
[2023-07-28 09:47:24] [config] embedding-fix-trg: false
[2023-07-28 09:47:24] [config] embedding-normalization: false
[2023-07-28 09:47:24] [config] embedding-vectors:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] enc-cell: gru
[2023-07-28 09:47:24] [config] enc-cell-depth: 1
[2023-07-28 09:47:24] [config] enc-depth: 1
[2023-07-28 09:47:24] [config] enc-type: bidirectional
[2023-07-28 09:47:24] [config] english-title-case-every: 0
[2023-07-28 09:47:24] [config] exponential-smoothing: 0
[2023-07-28 09:47:24] [config] factor-weight: 1
[2023-07-28 09:47:24] [config] factors-combine: sum
[2023-07-28 09:47:24] [config] factors-dim-emb: 0
[2023-07-28 09:47:24] [config] gradient-checkpointing: false
[2023-07-28 09:47:24] [config] gradient-norm-average-window: 100
[2023-07-28 09:47:24] [config] guided-alignment: none
[2023-07-28 09:47:24] [config] guided-alignment-cost: mse
[2023-07-28 09:47:24] [config] guided-alignment-weight: 0.1
[2023-07-28 09:47:24] [config] ignore-model-config: false
[2023-07-28 09:47:24] [config] input-types:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] interpolate-env-vars: false
[2023-07-28 09:47:24] [config] keep-best: false
[2023-07-28 09:47:24] [config] label-smoothing: 0
[2023-07-28 09:47:24] [config] layer-normalization: false
[2023-07-28 09:47:24] [config] learn-rate: 0.0001
[2023-07-28 09:47:24] [config] lemma-dependency: ""
[2023-07-28 09:47:24] [config] lemma-dim-emb: 0
[2023-07-28 09:47:24] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 09:47:24] [config] log-level: info
[2023-07-28 09:47:24] [config] log-time-zone: ""
[2023-07-28 09:47:24] [config] logical-epoch:
[2023-07-28 09:47:24] [config]   - 1e
[2023-07-28 09:47:24] [config]   - 0
[2023-07-28 09:47:24] [config] lr-decay: 0
[2023-07-28 09:47:24] [config] lr-decay-freq: 50000
[2023-07-28 09:47:24] [config] lr-decay-inv-sqrt:
[2023-07-28 09:47:24] [config]   - 0
[2023-07-28 09:47:24] [config] lr-decay-repeat-warmup: false
[2023-07-28 09:47:24] [config] lr-decay-reset-optimizer: false
[2023-07-28 09:47:24] [config] lr-decay-start:
[2023-07-28 09:47:24] [config]   - 10
[2023-07-28 09:47:24] [config]   - 1
[2023-07-28 09:47:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 09:47:24] [config] lr-report: false
[2023-07-28 09:47:24] [config] lr-warmup: 0
[2023-07-28 09:47:24] [config] lr-warmup-at-reload: false
[2023-07-28 09:47:24] [config] lr-warmup-cycle: false
[2023-07-28 09:47:24] [config] lr-warmup-start-rate: 0
[2023-07-28 09:47:24] [config] max-length: 50
[2023-07-28 09:47:24] [config] max-length-crop: true
[2023-07-28 09:47:24] [config] max-length-factor: 3
[2023-07-28 09:47:24] [config] maxi-batch: 100
[2023-07-28 09:47:24] [config] maxi-batch-sort: trg
[2023-07-28 09:47:24] [config] mini-batch: 64
[2023-07-28 09:47:24] [config] mini-batch-fit: true
[2023-07-28 09:47:24] [config] mini-batch-fit-step: 10
[2023-07-28 09:47:24] [config] mini-batch-round-up: true
[2023-07-28 09:47:24] [config] mini-batch-track-lr: false
[2023-07-28 09:47:24] [config] mini-batch-warmup: 0
[2023-07-28 09:47:24] [config] mini-batch-words: 0
[2023-07-28 09:47:24] [config] mini-batch-words-ref: 0
[2023-07-28 09:47:24] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:47:24] [config] multi-loss-type: sum
[2023-07-28 09:47:24] [config] n-best: false
[2023-07-28 09:47:24] [config] no-nccl: false
[2023-07-28 09:47:24] [config] no-reload: false
[2023-07-28 09:47:24] [config] no-restore-corpus: false
[2023-07-28 09:47:24] [config] normalize: 0
[2023-07-28 09:47:24] [config] normalize-gradient: false
[2023-07-28 09:47:24] [config] num-devices: 0
[2023-07-28 09:47:24] [config] optimizer: adam
[2023-07-28 09:47:24] [config] optimizer-delay: 1
[2023-07-28 09:47:24] [config] optimizer-params:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] output-omit-bias: false
[2023-07-28 09:47:24] [config] overwrite: true
[2023-07-28 09:47:24] [config] precision:
[2023-07-28 09:47:24] [config]   - float16
[2023-07-28 09:47:24] [config]   - float32
[2023-07-28 09:47:24] [config] pretrained-model: ""
[2023-07-28 09:47:24] [config] quantize-biases: false
[2023-07-28 09:47:24] [config] quantize-bits: 0
[2023-07-28 09:47:24] [config] quantize-log-based: false
[2023-07-28 09:47:24] [config] quantize-optimization-steps: 0
[2023-07-28 09:47:24] [config] quiet: false
[2023-07-28 09:47:24] [config] quiet-translation: true
[2023-07-28 09:47:24] [config] relative-paths: false
[2023-07-28 09:47:24] [config] right-left: false
[2023-07-28 09:47:24] [config] save-freq: 10000u
[2023-07-28 09:47:24] [config] seed: 1234
[2023-07-28 09:47:24] [config] sentencepiece-alphas:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] sentencepiece-max-lines: 2000000
[2023-07-28 09:47:24] [config] sentencepiece-options: ""
[2023-07-28 09:47:24] [config] sharding: global
[2023-07-28 09:47:24] [config] shuffle: data
[2023-07-28 09:47:24] [config] shuffle-in-ram: false
[2023-07-28 09:47:24] [config] sigterm: save-and-exit
[2023-07-28 09:47:24] [config] skip: false
[2023-07-28 09:47:24] [config] sqlite: ""
[2023-07-28 09:47:24] [config] sqlite-drop: false
[2023-07-28 09:47:24] [config] sync-freq: 200u
[2023-07-28 09:47:24] [config] sync-sgd: false
[2023-07-28 09:47:24] [config] tempdir: /tmp
[2023-07-28 09:47:24] [config] tied-embeddings: false
[2023-07-28 09:47:24] [config] tied-embeddings-all: true
[2023-07-28 09:47:24] [config] tied-embeddings-src: false
[2023-07-28 09:47:24] [config] train-embedder-rank:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] train-sets:
[2023-07-28 09:47:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 09:47:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 09:47:24] [config] transformer-aan-activation: swish
[2023-07-28 09:47:24] [config] transformer-aan-depth: 2
[2023-07-28 09:47:24] [config] transformer-aan-nogate: false
[2023-07-28 09:47:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 09:47:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 09:47:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 09:47:24] [config] transformer-depth-scaling: false
[2023-07-28 09:47:24] [config] transformer-dim-aan: 2048
[2023-07-28 09:47:24] [config] transformer-dim-ffn: 2048
[2023-07-28 09:47:24] [config] transformer-dropout: 0
[2023-07-28 09:47:24] [config] transformer-dropout-attention: 0
[2023-07-28 09:47:24] [config] transformer-dropout-ffn: 0
[2023-07-28 09:47:24] [config] transformer-ffn-activation: swish
[2023-07-28 09:47:24] [config] transformer-ffn-depth: 2
[2023-07-28 09:47:24] [config] transformer-guided-alignment-layer: last
[2023-07-28 09:47:24] [config] transformer-heads: 8
[2023-07-28 09:47:24] [config] transformer-no-projection: false
[2023-07-28 09:47:24] [config] transformer-pool: false
[2023-07-28 09:47:24] [config] transformer-postprocess: dan
[2023-07-28 09:47:24] [config] transformer-postprocess-emb: d
[2023-07-28 09:47:24] [config] transformer-postprocess-top: ""
[2023-07-28 09:47:24] [config] transformer-preprocess: ""
[2023-07-28 09:47:24] [config] transformer-tied-layers:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] transformer-train-position-embeddings: false
[2023-07-28 09:47:24] [config] tsv: false
[2023-07-28 09:47:24] [config] tsv-fields: 0
[2023-07-28 09:47:24] [config] type: s2s
[2023-07-28 09:47:24] [config] ulr: false
[2023-07-28 09:47:24] [config] ulr-dim-emb: 0
[2023-07-28 09:47:24] [config] ulr-dropout: 0
[2023-07-28 09:47:24] [config] ulr-keys-vectors: ""
[2023-07-28 09:47:24] [config] ulr-query-vectors: ""
[2023-07-28 09:47:24] [config] ulr-softmax-temperature: 1
[2023-07-28 09:47:24] [config] ulr-trainable-transformation: false
[2023-07-28 09:47:24] [config] unlikelihood-loss: false
[2023-07-28 09:47:24] [config] valid-freq: 50000000
[2023-07-28 09:47:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 09:47:24] [config] valid-max-length: 1000
[2023-07-28 09:47:24] [config] valid-metrics:
[2023-07-28 09:47:24] [config]   - translation
[2023-07-28 09:47:24] [config] valid-mini-batch: 32
[2023-07-28 09:47:24] [config] valid-reset-stalled: false
[2023-07-28 09:47:24] [config] valid-script-args:
[2023-07-28 09:47:24] [config]   []
[2023-07-28 09:47:24] [config] valid-script-path: ""
[2023-07-28 09:47:24] [config] valid-sets:
[2023-07-28 09:47:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 09:47:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 09:47:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 09:47:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:47:24] [config] vocabs:
[2023-07-28 09:47:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:47:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:47:24] [config] word-penalty: 0
[2023-07-28 09:47:24] [config] word-scores: false
[2023-07-28 09:47:24] [config] workspace: 5500
[2023-07-28 09:47:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:47:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:47:24] [training] Using single-device training
[2023-07-28 09:47:25] Synced seed 1234
[2023-07-28 09:47:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:47:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 09:47:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:47:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 09:47:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 09:47:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:47:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 09:47:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:47:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:47:25] [comm] Using global sharding
[2023-07-28 09:47:26] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:47:26] [training] Using 1 GPUs
[2023-07-28 09:47:26] [logits] Applying loss function for 1 factor(s)
[2023-07-28 09:47:26] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:47:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 09:47:26] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:51:54] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 09:51:54] [valid] No post-processing script given for validating translator
[2023-07-28 09:51:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:51:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:51:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:51:54] [comm] Using global sharding
[2023-07-28 09:51:54] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:51:54] [training] Using 1 GPUs
[2023-07-28 09:51:54] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 09:51:56] Allocating memory for general optimizer shards
[2023-07-28 09:51:56] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:51:56] Loading Adam parameters
[2023-07-28 09:51:56] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:51:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:51:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 09:51:56] [data] Restoring the corpus state to epoch 331, batch 9020
[2023-07-28 09:51:56] [data] Shuffling data
[2023-07-28 09:51:56] [data] Done reading 20,192 sentences
[2023-07-28 09:51:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:51:56] Training started
[2023-07-28 09:51:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 09:51:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:52:01] Parameter type float16, optimization type float32, casting types true
[2023-07-28 09:53:06] Seen 20,192 samples
[2023-07-28 09:53:06] Starting data epoch 332 in logical epoch 332
[2023-07-28 09:53:06] [data] Shuffling data
[2023-07-28 09:53:06] [data] Done reading 20,192 sentences
[2023-07-28 09:53:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:54:14] Seen 20,192 samples
[2023-07-28 09:54:14] Starting data epoch 333 in logical epoch 333
[2023-07-28 09:54:14] [data] Shuffling data
[2023-07-28 09:54:14] [data] Done reading 20,192 sentences
[2023-07-28 09:54:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:55:25] Seen 20,192 samples
[2023-07-28 09:55:25] Starting data epoch 334 in logical epoch 334
[2023-07-28 09:55:25] [data] Shuffling data
[2023-07-28 09:55:25] [data] Done reading 20,192 sentences
[2023-07-28 09:55:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:56:37] Seen 20,192 samples
[2023-07-28 09:56:37] Starting data epoch 335 in logical epoch 335
[2023-07-28 09:56:37] [data] Shuffling data
[2023-07-28 09:56:37] [data] Done reading 20,192 sentences
[2023-07-28 09:56:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:57:49] Seen 20,192 samples
[2023-07-28 09:57:49] Starting data epoch 336 in logical epoch 336
[2023-07-28 09:57:49] [data] Shuffling data
[2023-07-28 09:57:49] [data] Done reading 20,192 sentences
[2023-07-28 09:57:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:59:00] Seen 20,192 samples
[2023-07-28 09:59:00] Starting data epoch 337 in logical epoch 337
[2023-07-28 09:59:00] [data] Shuffling data
[2023-07-28 09:59:00] [data] Done reading 20,192 sentences
[2023-07-28 09:59:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:00:14] Seen 20,192 samples
[2023-07-28 10:00:14] Starting data epoch 338 in logical epoch 338
[2023-07-28 10:00:14] [data] Shuffling data
[2023-07-28 10:00:14] [data] Done reading 20,192 sentences
[2023-07-28 10:00:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:01:28] Seen 20,192 samples
[2023-07-28 10:01:28] Starting data epoch 339 in logical epoch 339
[2023-07-28 10:01:28] [data] Shuffling data
[2023-07-28 10:01:28] [data] Done reading 20,192 sentences
[2023-07-28 10:01:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:02:43] Seen 20,192 samples
[2023-07-28 10:02:43] Starting data epoch 340 in logical epoch 340
[2023-07-28 10:02:43] [data] Shuffling data
[2023-07-28 10:02:43] [data] Done reading 20,192 sentences
[2023-07-28 10:02:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:03:55] Seen 20,192 samples
[2023-07-28 10:03:55] Starting data epoch 341 in logical epoch 341
[2023-07-28 10:03:55] Training finished
[2023-07-28 10:04:36] [valid] Ep. 341 : Up. 9291 : translation : 0 : new best
[2023-07-28 10:04:36] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:04:38] Saving Adam parameters
[2023-07-28 10:04:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:04:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:04:45] [marian] Running on node05.datos.cluster.uy as process 32869 with command line:
[2023-07-28 10:04:45] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 350 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 10:04:45] [config] after: 0e
[2023-07-28 10:04:45] [config] after-batches: 0
[2023-07-28 10:04:45] [config] after-epochs: 350
[2023-07-28 10:04:45] [config] all-caps-every: 0
[2023-07-28 10:04:45] [config] allow-unk: false
[2023-07-28 10:04:45] [config] authors: false
[2023-07-28 10:04:45] [config] beam-size: 12
[2023-07-28 10:04:45] [config] bert-class-symbol: "[CLS]"
[2023-07-28 10:04:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 10:04:45] [config] bert-masking-fraction: 0.15
[2023-07-28 10:04:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 10:04:45] [config] bert-train-type-embeddings: true
[2023-07-28 10:04:45] [config] bert-type-vocab-size: 2
[2023-07-28 10:04:45] [config] build-info: ""
[2023-07-28 10:04:45] [config] check-gradient-nan: false
[2023-07-28 10:04:45] [config] check-nan: false
[2023-07-28 10:04:45] [config] cite: false
[2023-07-28 10:04:45] [config] clip-norm: 1
[2023-07-28 10:04:45] [config] cost-scaling:
[2023-07-28 10:04:45] [config]   - 256.f
[2023-07-28 10:04:45] [config]   - 1000
[2023-07-28 10:04:45] [config]   - 2.f
[2023-07-28 10:04:45] [config]   - 256.f
[2023-07-28 10:04:45] [config] cost-type: ce-sum
[2023-07-28 10:04:45] [config] cpu-threads: 0
[2023-07-28 10:04:45] [config] data-threads: 8
[2023-07-28 10:04:45] [config] data-weighting: ""
[2023-07-28 10:04:45] [config] data-weighting-type: sentence
[2023-07-28 10:04:45] [config] dec-cell: gru
[2023-07-28 10:04:45] [config] dec-cell-base-depth: 2
[2023-07-28 10:04:45] [config] dec-cell-high-depth: 1
[2023-07-28 10:04:45] [config] dec-depth: 1
[2023-07-28 10:04:45] [config] devices:
[2023-07-28 10:04:45] [config]   - 0
[2023-07-28 10:04:45] [config] dim-emb: 512
[2023-07-28 10:04:45] [config] dim-rnn: 1024
[2023-07-28 10:04:45] [config] dim-vocabs:
[2023-07-28 10:04:45] [config]   - 16384
[2023-07-28 10:04:45] [config]   - 16384
[2023-07-28 10:04:45] [config] disp-first: 0
[2023-07-28 10:04:45] [config] disp-freq: 1000u
[2023-07-28 10:04:45] [config] disp-label-counts: true
[2023-07-28 10:04:45] [config] dropout-rnn: 0
[2023-07-28 10:04:45] [config] dropout-src: 0
[2023-07-28 10:04:45] [config] dropout-trg: 0
[2023-07-28 10:04:45] [config] dump-config: ""
[2023-07-28 10:04:45] [config] dynamic-gradient-scaling:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] early-stopping: 1000
[2023-07-28 10:04:45] [config] early-stopping-on: first
[2023-07-28 10:04:45] [config] embedding-fix-src: false
[2023-07-28 10:04:45] [config] embedding-fix-trg: false
[2023-07-28 10:04:45] [config] embedding-normalization: false
[2023-07-28 10:04:45] [config] embedding-vectors:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] enc-cell: gru
[2023-07-28 10:04:45] [config] enc-cell-depth: 1
[2023-07-28 10:04:45] [config] enc-depth: 1
[2023-07-28 10:04:45] [config] enc-type: bidirectional
[2023-07-28 10:04:45] [config] english-title-case-every: 0
[2023-07-28 10:04:45] [config] exponential-smoothing: 0
[2023-07-28 10:04:45] [config] factor-weight: 1
[2023-07-28 10:04:45] [config] factors-combine: sum
[2023-07-28 10:04:45] [config] factors-dim-emb: 0
[2023-07-28 10:04:45] [config] gradient-checkpointing: false
[2023-07-28 10:04:45] [config] gradient-norm-average-window: 100
[2023-07-28 10:04:45] [config] guided-alignment: none
[2023-07-28 10:04:45] [config] guided-alignment-cost: mse
[2023-07-28 10:04:45] [config] guided-alignment-weight: 0.1
[2023-07-28 10:04:45] [config] ignore-model-config: false
[2023-07-28 10:04:45] [config] input-types:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] interpolate-env-vars: false
[2023-07-28 10:04:45] [config] keep-best: false
[2023-07-28 10:04:45] [config] label-smoothing: 0
[2023-07-28 10:04:45] [config] layer-normalization: false
[2023-07-28 10:04:45] [config] learn-rate: 0.0001
[2023-07-28 10:04:45] [config] lemma-dependency: ""
[2023-07-28 10:04:45] [config] lemma-dim-emb: 0
[2023-07-28 10:04:45] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:04:45] [config] log-level: info
[2023-07-28 10:04:45] [config] log-time-zone: ""
[2023-07-28 10:04:45] [config] logical-epoch:
[2023-07-28 10:04:45] [config]   - 1e
[2023-07-28 10:04:45] [config]   - 0
[2023-07-28 10:04:45] [config] lr-decay: 0
[2023-07-28 10:04:45] [config] lr-decay-freq: 50000
[2023-07-28 10:04:45] [config] lr-decay-inv-sqrt:
[2023-07-28 10:04:45] [config]   - 0
[2023-07-28 10:04:45] [config] lr-decay-repeat-warmup: false
[2023-07-28 10:04:45] [config] lr-decay-reset-optimizer: false
[2023-07-28 10:04:45] [config] lr-decay-start:
[2023-07-28 10:04:45] [config]   - 10
[2023-07-28 10:04:45] [config]   - 1
[2023-07-28 10:04:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 10:04:45] [config] lr-report: false
[2023-07-28 10:04:45] [config] lr-warmup: 0
[2023-07-28 10:04:45] [config] lr-warmup-at-reload: false
[2023-07-28 10:04:45] [config] lr-warmup-cycle: false
[2023-07-28 10:04:45] [config] lr-warmup-start-rate: 0
[2023-07-28 10:04:45] [config] max-length: 50
[2023-07-28 10:04:45] [config] max-length-crop: true
[2023-07-28 10:04:45] [config] max-length-factor: 3
[2023-07-28 10:04:45] [config] maxi-batch: 100
[2023-07-28 10:04:45] [config] maxi-batch-sort: trg
[2023-07-28 10:04:45] [config] mini-batch: 64
[2023-07-28 10:04:45] [config] mini-batch-fit: true
[2023-07-28 10:04:45] [config] mini-batch-fit-step: 10
[2023-07-28 10:04:45] [config] mini-batch-round-up: true
[2023-07-28 10:04:45] [config] mini-batch-track-lr: false
[2023-07-28 10:04:45] [config] mini-batch-warmup: 0
[2023-07-28 10:04:45] [config] mini-batch-words: 0
[2023-07-28 10:04:45] [config] mini-batch-words-ref: 0
[2023-07-28 10:04:45] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:04:45] [config] multi-loss-type: sum
[2023-07-28 10:04:45] [config] n-best: false
[2023-07-28 10:04:45] [config] no-nccl: false
[2023-07-28 10:04:45] [config] no-reload: false
[2023-07-28 10:04:45] [config] no-restore-corpus: false
[2023-07-28 10:04:45] [config] normalize: 0
[2023-07-28 10:04:45] [config] normalize-gradient: false
[2023-07-28 10:04:45] [config] num-devices: 0
[2023-07-28 10:04:45] [config] optimizer: adam
[2023-07-28 10:04:45] [config] optimizer-delay: 1
[2023-07-28 10:04:45] [config] optimizer-params:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] output-omit-bias: false
[2023-07-28 10:04:45] [config] overwrite: true
[2023-07-28 10:04:45] [config] precision:
[2023-07-28 10:04:45] [config]   - float16
[2023-07-28 10:04:45] [config]   - float32
[2023-07-28 10:04:45] [config] pretrained-model: ""
[2023-07-28 10:04:45] [config] quantize-biases: false
[2023-07-28 10:04:45] [config] quantize-bits: 0
[2023-07-28 10:04:45] [config] quantize-log-based: false
[2023-07-28 10:04:45] [config] quantize-optimization-steps: 0
[2023-07-28 10:04:45] [config] quiet: false
[2023-07-28 10:04:45] [config] quiet-translation: true
[2023-07-28 10:04:45] [config] relative-paths: false
[2023-07-28 10:04:45] [config] right-left: false
[2023-07-28 10:04:45] [config] save-freq: 10000u
[2023-07-28 10:04:45] [config] seed: 1234
[2023-07-28 10:04:45] [config] sentencepiece-alphas:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] sentencepiece-max-lines: 2000000
[2023-07-28 10:04:45] [config] sentencepiece-options: ""
[2023-07-28 10:04:45] [config] sharding: global
[2023-07-28 10:04:45] [config] shuffle: data
[2023-07-28 10:04:45] [config] shuffle-in-ram: false
[2023-07-28 10:04:45] [config] sigterm: save-and-exit
[2023-07-28 10:04:45] [config] skip: false
[2023-07-28 10:04:45] [config] sqlite: ""
[2023-07-28 10:04:45] [config] sqlite-drop: false
[2023-07-28 10:04:45] [config] sync-freq: 200u
[2023-07-28 10:04:45] [config] sync-sgd: false
[2023-07-28 10:04:45] [config] tempdir: /tmp
[2023-07-28 10:04:45] [config] tied-embeddings: false
[2023-07-28 10:04:45] [config] tied-embeddings-all: true
[2023-07-28 10:04:45] [config] tied-embeddings-src: false
[2023-07-28 10:04:45] [config] train-embedder-rank:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] train-sets:
[2023-07-28 10:04:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 10:04:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 10:04:45] [config] transformer-aan-activation: swish
[2023-07-28 10:04:45] [config] transformer-aan-depth: 2
[2023-07-28 10:04:45] [config] transformer-aan-nogate: false
[2023-07-28 10:04:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 10:04:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 10:04:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 10:04:45] [config] transformer-depth-scaling: false
[2023-07-28 10:04:45] [config] transformer-dim-aan: 2048
[2023-07-28 10:04:45] [config] transformer-dim-ffn: 2048
[2023-07-28 10:04:45] [config] transformer-dropout: 0
[2023-07-28 10:04:45] [config] transformer-dropout-attention: 0
[2023-07-28 10:04:45] [config] transformer-dropout-ffn: 0
[2023-07-28 10:04:45] [config] transformer-ffn-activation: swish
[2023-07-28 10:04:45] [config] transformer-ffn-depth: 2
[2023-07-28 10:04:45] [config] transformer-guided-alignment-layer: last
[2023-07-28 10:04:45] [config] transformer-heads: 8
[2023-07-28 10:04:45] [config] transformer-no-projection: false
[2023-07-28 10:04:45] [config] transformer-pool: false
[2023-07-28 10:04:45] [config] transformer-postprocess: dan
[2023-07-28 10:04:45] [config] transformer-postprocess-emb: d
[2023-07-28 10:04:45] [config] transformer-postprocess-top: ""
[2023-07-28 10:04:45] [config] transformer-preprocess: ""
[2023-07-28 10:04:45] [config] transformer-tied-layers:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] transformer-train-position-embeddings: false
[2023-07-28 10:04:45] [config] tsv: false
[2023-07-28 10:04:45] [config] tsv-fields: 0
[2023-07-28 10:04:45] [config] type: s2s
[2023-07-28 10:04:45] [config] ulr: false
[2023-07-28 10:04:45] [config] ulr-dim-emb: 0
[2023-07-28 10:04:45] [config] ulr-dropout: 0
[2023-07-28 10:04:45] [config] ulr-keys-vectors: ""
[2023-07-28 10:04:45] [config] ulr-query-vectors: ""
[2023-07-28 10:04:45] [config] ulr-softmax-temperature: 1
[2023-07-28 10:04:45] [config] ulr-trainable-transformation: false
[2023-07-28 10:04:45] [config] unlikelihood-loss: false
[2023-07-28 10:04:45] [config] valid-freq: 50000000
[2023-07-28 10:04:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:04:45] [config] valid-max-length: 1000
[2023-07-28 10:04:45] [config] valid-metrics:
[2023-07-28 10:04:45] [config]   - translation
[2023-07-28 10:04:45] [config] valid-mini-batch: 32
[2023-07-28 10:04:45] [config] valid-reset-stalled: false
[2023-07-28 10:04:45] [config] valid-script-args:
[2023-07-28 10:04:45] [config]   []
[2023-07-28 10:04:45] [config] valid-script-path: ""
[2023-07-28 10:04:45] [config] valid-sets:
[2023-07-28 10:04:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 10:04:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 10:04:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 10:04:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:04:45] [config] vocabs:
[2023-07-28 10:04:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:04:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:04:45] [config] word-penalty: 0
[2023-07-28 10:04:45] [config] word-scores: false
[2023-07-28 10:04:45] [config] workspace: 5500
[2023-07-28 10:04:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:04:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:04:45] [training] Using single-device training
[2023-07-28 10:04:46] Synced seed 1234
[2023-07-28 10:04:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:04:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 10:04:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:04:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 10:04:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 10:04:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:04:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 10:04:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:04:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:04:47] [comm] Using global sharding
[2023-07-28 10:04:47] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:04:47] [training] Using 1 GPUs
[2023-07-28 10:04:47] [logits] Applying loss function for 1 factor(s)
[2023-07-28 10:04:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:04:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 10:04:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:09:15] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 10:09:15] [valid] No post-processing script given for validating translator
[2023-07-28 10:09:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:09:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:09:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:09:15] [comm] Using global sharding
[2023-07-28 10:09:15] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:09:15] [training] Using 1 GPUs
[2023-07-28 10:09:15] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:09:16] Allocating memory for general optimizer shards
[2023-07-28 10:09:16] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:09:16] Loading Adam parameters
[2023-07-28 10:09:17] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:09:17] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:09:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:09:17] [data] Restoring the corpus state to epoch 341, batch 9291
[2023-07-28 10:09:17] [data] Shuffling data
[2023-07-28 10:09:17] [data] Done reading 20,192 sentences
[2023-07-28 10:09:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:09:17] Training started
[2023-07-28 10:09:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 10:09:18] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:09:20] Parameter type float16, optimization type float32, casting types true
[2023-07-28 10:10:28] Seen 20,192 samples
[2023-07-28 10:10:28] Starting data epoch 342 in logical epoch 342
[2023-07-28 10:10:28] [data] Shuffling data
[2023-07-28 10:10:28] [data] Done reading 20,192 sentences
[2023-07-28 10:10:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:11:38] Seen 20,192 samples
[2023-07-28 10:11:38] Starting data epoch 343 in logical epoch 343
[2023-07-28 10:11:38] [data] Shuffling data
[2023-07-28 10:11:38] [data] Done reading 20,192 sentences
[2023-07-28 10:11:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:12:51] Seen 20,192 samples
[2023-07-28 10:12:51] Starting data epoch 344 in logical epoch 344
[2023-07-28 10:12:51] [data] Shuffling data
[2023-07-28 10:12:51] [data] Done reading 20,192 sentences
[2023-07-28 10:12:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:14:03] Seen 20,192 samples
[2023-07-28 10:14:03] Starting data epoch 345 in logical epoch 345
[2023-07-28 10:14:03] [data] Shuffling data
[2023-07-28 10:14:03] [data] Done reading 20,192 sentences
[2023-07-28 10:14:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:15:18] Seen 20,192 samples
[2023-07-28 10:15:18] Starting data epoch 346 in logical epoch 346
[2023-07-28 10:15:18] [data] Shuffling data
[2023-07-28 10:15:18] [data] Done reading 20,192 sentences
[2023-07-28 10:15:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:16:32] Seen 20,192 samples
[2023-07-28 10:16:32] Starting data epoch 347 in logical epoch 347
[2023-07-28 10:16:32] [data] Shuffling data
[2023-07-28 10:16:32] [data] Done reading 20,192 sentences
[2023-07-28 10:16:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:17:46] Seen 20,192 samples
[2023-07-28 10:17:46] Starting data epoch 348 in logical epoch 348
[2023-07-28 10:17:46] [data] Shuffling data
[2023-07-28 10:17:46] [data] Done reading 20,192 sentences
[2023-07-28 10:17:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:19:00] Seen 20,192 samples
[2023-07-28 10:19:01] Starting data epoch 349 in logical epoch 349
[2023-07-28 10:19:01] [data] Shuffling data
[2023-07-28 10:19:01] [data] Done reading 20,192 sentences
[2023-07-28 10:19:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:20:16] Seen 20,192 samples
[2023-07-28 10:20:16] Starting data epoch 350 in logical epoch 350
[2023-07-28 10:20:16] [data] Shuffling data
[2023-07-28 10:20:16] [data] Done reading 20,192 sentences
[2023-07-28 10:20:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:21:31] Seen 20,192 samples
[2023-07-28 10:21:31] Starting data epoch 351 in logical epoch 351
[2023-07-28 10:21:31] Training finished
[2023-07-28 10:22:11] [valid] Ep. 351 : Up. 9566 : translation : 0 : new best
[2023-07-28 10:22:11] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:22:13] Saving Adam parameters
[2023-07-28 10:22:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:22:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:22:20] [marian] Running on node05.datos.cluster.uy as process 34039 with command line:
[2023-07-28 10:22:20] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 360 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 10:22:20] [config] after: 0e
[2023-07-28 10:22:20] [config] after-batches: 0
[2023-07-28 10:22:20] [config] after-epochs: 360
[2023-07-28 10:22:20] [config] all-caps-every: 0
[2023-07-28 10:22:20] [config] allow-unk: false
[2023-07-28 10:22:20] [config] authors: false
[2023-07-28 10:22:20] [config] beam-size: 12
[2023-07-28 10:22:20] [config] bert-class-symbol: "[CLS]"
[2023-07-28 10:22:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 10:22:20] [config] bert-masking-fraction: 0.15
[2023-07-28 10:22:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 10:22:20] [config] bert-train-type-embeddings: true
[2023-07-28 10:22:20] [config] bert-type-vocab-size: 2
[2023-07-28 10:22:20] [config] build-info: ""
[2023-07-28 10:22:20] [config] check-gradient-nan: false
[2023-07-28 10:22:20] [config] check-nan: false
[2023-07-28 10:22:20] [config] cite: false
[2023-07-28 10:22:20] [config] clip-norm: 1
[2023-07-28 10:22:20] [config] cost-scaling:
[2023-07-28 10:22:20] [config]   - 256.f
[2023-07-28 10:22:20] [config]   - 1000
[2023-07-28 10:22:20] [config]   - 2.f
[2023-07-28 10:22:20] [config]   - 256.f
[2023-07-28 10:22:20] [config] cost-type: ce-sum
[2023-07-28 10:22:20] [config] cpu-threads: 0
[2023-07-28 10:22:20] [config] data-threads: 8
[2023-07-28 10:22:20] [config] data-weighting: ""
[2023-07-28 10:22:20] [config] data-weighting-type: sentence
[2023-07-28 10:22:20] [config] dec-cell: gru
[2023-07-28 10:22:20] [config] dec-cell-base-depth: 2
[2023-07-28 10:22:20] [config] dec-cell-high-depth: 1
[2023-07-28 10:22:20] [config] dec-depth: 1
[2023-07-28 10:22:20] [config] devices:
[2023-07-28 10:22:20] [config]   - 0
[2023-07-28 10:22:20] [config] dim-emb: 512
[2023-07-28 10:22:20] [config] dim-rnn: 1024
[2023-07-28 10:22:20] [config] dim-vocabs:
[2023-07-28 10:22:20] [config]   - 16384
[2023-07-28 10:22:20] [config]   - 16384
[2023-07-28 10:22:20] [config] disp-first: 0
[2023-07-28 10:22:20] [config] disp-freq: 1000u
[2023-07-28 10:22:20] [config] disp-label-counts: true
[2023-07-28 10:22:20] [config] dropout-rnn: 0
[2023-07-28 10:22:20] [config] dropout-src: 0
[2023-07-28 10:22:20] [config] dropout-trg: 0
[2023-07-28 10:22:20] [config] dump-config: ""
[2023-07-28 10:22:20] [config] dynamic-gradient-scaling:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] early-stopping: 1000
[2023-07-28 10:22:20] [config] early-stopping-on: first
[2023-07-28 10:22:20] [config] embedding-fix-src: false
[2023-07-28 10:22:20] [config] embedding-fix-trg: false
[2023-07-28 10:22:20] [config] embedding-normalization: false
[2023-07-28 10:22:20] [config] embedding-vectors:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] enc-cell: gru
[2023-07-28 10:22:20] [config] enc-cell-depth: 1
[2023-07-28 10:22:20] [config] enc-depth: 1
[2023-07-28 10:22:20] [config] enc-type: bidirectional
[2023-07-28 10:22:20] [config] english-title-case-every: 0
[2023-07-28 10:22:20] [config] exponential-smoothing: 0
[2023-07-28 10:22:20] [config] factor-weight: 1
[2023-07-28 10:22:20] [config] factors-combine: sum
[2023-07-28 10:22:20] [config] factors-dim-emb: 0
[2023-07-28 10:22:20] [config] gradient-checkpointing: false
[2023-07-28 10:22:20] [config] gradient-norm-average-window: 100
[2023-07-28 10:22:20] [config] guided-alignment: none
[2023-07-28 10:22:20] [config] guided-alignment-cost: mse
[2023-07-28 10:22:20] [config] guided-alignment-weight: 0.1
[2023-07-28 10:22:20] [config] ignore-model-config: false
[2023-07-28 10:22:20] [config] input-types:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] interpolate-env-vars: false
[2023-07-28 10:22:20] [config] keep-best: false
[2023-07-28 10:22:20] [config] label-smoothing: 0
[2023-07-28 10:22:20] [config] layer-normalization: false
[2023-07-28 10:22:20] [config] learn-rate: 0.0001
[2023-07-28 10:22:20] [config] lemma-dependency: ""
[2023-07-28 10:22:20] [config] lemma-dim-emb: 0
[2023-07-28 10:22:20] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:22:20] [config] log-level: info
[2023-07-28 10:22:20] [config] log-time-zone: ""
[2023-07-28 10:22:20] [config] logical-epoch:
[2023-07-28 10:22:20] [config]   - 1e
[2023-07-28 10:22:20] [config]   - 0
[2023-07-28 10:22:20] [config] lr-decay: 0
[2023-07-28 10:22:20] [config] lr-decay-freq: 50000
[2023-07-28 10:22:20] [config] lr-decay-inv-sqrt:
[2023-07-28 10:22:20] [config]   - 0
[2023-07-28 10:22:20] [config] lr-decay-repeat-warmup: false
[2023-07-28 10:22:20] [config] lr-decay-reset-optimizer: false
[2023-07-28 10:22:20] [config] lr-decay-start:
[2023-07-28 10:22:20] [config]   - 10
[2023-07-28 10:22:20] [config]   - 1
[2023-07-28 10:22:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 10:22:20] [config] lr-report: false
[2023-07-28 10:22:20] [config] lr-warmup: 0
[2023-07-28 10:22:20] [config] lr-warmup-at-reload: false
[2023-07-28 10:22:20] [config] lr-warmup-cycle: false
[2023-07-28 10:22:20] [config] lr-warmup-start-rate: 0
[2023-07-28 10:22:20] [config] max-length: 50
[2023-07-28 10:22:20] [config] max-length-crop: true
[2023-07-28 10:22:20] [config] max-length-factor: 3
[2023-07-28 10:22:20] [config] maxi-batch: 100
[2023-07-28 10:22:20] [config] maxi-batch-sort: trg
[2023-07-28 10:22:20] [config] mini-batch: 64
[2023-07-28 10:22:20] [config] mini-batch-fit: true
[2023-07-28 10:22:20] [config] mini-batch-fit-step: 10
[2023-07-28 10:22:20] [config] mini-batch-round-up: true
[2023-07-28 10:22:20] [config] mini-batch-track-lr: false
[2023-07-28 10:22:20] [config] mini-batch-warmup: 0
[2023-07-28 10:22:20] [config] mini-batch-words: 0
[2023-07-28 10:22:20] [config] mini-batch-words-ref: 0
[2023-07-28 10:22:20] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:22:20] [config] multi-loss-type: sum
[2023-07-28 10:22:20] [config] n-best: false
[2023-07-28 10:22:20] [config] no-nccl: false
[2023-07-28 10:22:20] [config] no-reload: false
[2023-07-28 10:22:20] [config] no-restore-corpus: false
[2023-07-28 10:22:20] [config] normalize: 0
[2023-07-28 10:22:20] [config] normalize-gradient: false
[2023-07-28 10:22:20] [config] num-devices: 0
[2023-07-28 10:22:20] [config] optimizer: adam
[2023-07-28 10:22:20] [config] optimizer-delay: 1
[2023-07-28 10:22:20] [config] optimizer-params:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] output-omit-bias: false
[2023-07-28 10:22:20] [config] overwrite: true
[2023-07-28 10:22:20] [config] precision:
[2023-07-28 10:22:20] [config]   - float16
[2023-07-28 10:22:20] [config]   - float32
[2023-07-28 10:22:20] [config] pretrained-model: ""
[2023-07-28 10:22:20] [config] quantize-biases: false
[2023-07-28 10:22:20] [config] quantize-bits: 0
[2023-07-28 10:22:20] [config] quantize-log-based: false
[2023-07-28 10:22:20] [config] quantize-optimization-steps: 0
[2023-07-28 10:22:20] [config] quiet: false
[2023-07-28 10:22:20] [config] quiet-translation: true
[2023-07-28 10:22:20] [config] relative-paths: false
[2023-07-28 10:22:20] [config] right-left: false
[2023-07-28 10:22:20] [config] save-freq: 10000u
[2023-07-28 10:22:20] [config] seed: 1234
[2023-07-28 10:22:20] [config] sentencepiece-alphas:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] sentencepiece-max-lines: 2000000
[2023-07-28 10:22:20] [config] sentencepiece-options: ""
[2023-07-28 10:22:20] [config] sharding: global
[2023-07-28 10:22:20] [config] shuffle: data
[2023-07-28 10:22:20] [config] shuffle-in-ram: false
[2023-07-28 10:22:20] [config] sigterm: save-and-exit
[2023-07-28 10:22:20] [config] skip: false
[2023-07-28 10:22:20] [config] sqlite: ""
[2023-07-28 10:22:20] [config] sqlite-drop: false
[2023-07-28 10:22:20] [config] sync-freq: 200u
[2023-07-28 10:22:20] [config] sync-sgd: false
[2023-07-28 10:22:20] [config] tempdir: /tmp
[2023-07-28 10:22:20] [config] tied-embeddings: false
[2023-07-28 10:22:20] [config] tied-embeddings-all: true
[2023-07-28 10:22:20] [config] tied-embeddings-src: false
[2023-07-28 10:22:20] [config] train-embedder-rank:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] train-sets:
[2023-07-28 10:22:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 10:22:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 10:22:20] [config] transformer-aan-activation: swish
[2023-07-28 10:22:20] [config] transformer-aan-depth: 2
[2023-07-28 10:22:20] [config] transformer-aan-nogate: false
[2023-07-28 10:22:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 10:22:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 10:22:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 10:22:20] [config] transformer-depth-scaling: false
[2023-07-28 10:22:20] [config] transformer-dim-aan: 2048
[2023-07-28 10:22:20] [config] transformer-dim-ffn: 2048
[2023-07-28 10:22:20] [config] transformer-dropout: 0
[2023-07-28 10:22:20] [config] transformer-dropout-attention: 0
[2023-07-28 10:22:20] [config] transformer-dropout-ffn: 0
[2023-07-28 10:22:20] [config] transformer-ffn-activation: swish
[2023-07-28 10:22:20] [config] transformer-ffn-depth: 2
[2023-07-28 10:22:20] [config] transformer-guided-alignment-layer: last
[2023-07-28 10:22:20] [config] transformer-heads: 8
[2023-07-28 10:22:20] [config] transformer-no-projection: false
[2023-07-28 10:22:20] [config] transformer-pool: false
[2023-07-28 10:22:20] [config] transformer-postprocess: dan
[2023-07-28 10:22:20] [config] transformer-postprocess-emb: d
[2023-07-28 10:22:20] [config] transformer-postprocess-top: ""
[2023-07-28 10:22:20] [config] transformer-preprocess: ""
[2023-07-28 10:22:20] [config] transformer-tied-layers:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] transformer-train-position-embeddings: false
[2023-07-28 10:22:20] [config] tsv: false
[2023-07-28 10:22:20] [config] tsv-fields: 0
[2023-07-28 10:22:20] [config] type: s2s
[2023-07-28 10:22:20] [config] ulr: false
[2023-07-28 10:22:20] [config] ulr-dim-emb: 0
[2023-07-28 10:22:20] [config] ulr-dropout: 0
[2023-07-28 10:22:20] [config] ulr-keys-vectors: ""
[2023-07-28 10:22:20] [config] ulr-query-vectors: ""
[2023-07-28 10:22:20] [config] ulr-softmax-temperature: 1
[2023-07-28 10:22:20] [config] ulr-trainable-transformation: false
[2023-07-28 10:22:20] [config] unlikelihood-loss: false
[2023-07-28 10:22:20] [config] valid-freq: 50000000
[2023-07-28 10:22:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:22:20] [config] valid-max-length: 1000
[2023-07-28 10:22:20] [config] valid-metrics:
[2023-07-28 10:22:20] [config]   - translation
[2023-07-28 10:22:20] [config] valid-mini-batch: 32
[2023-07-28 10:22:20] [config] valid-reset-stalled: false
[2023-07-28 10:22:20] [config] valid-script-args:
[2023-07-28 10:22:20] [config]   []
[2023-07-28 10:22:20] [config] valid-script-path: ""
[2023-07-28 10:22:20] [config] valid-sets:
[2023-07-28 10:22:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 10:22:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 10:22:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 10:22:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:22:20] [config] vocabs:
[2023-07-28 10:22:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:22:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:22:20] [config] word-penalty: 0
[2023-07-28 10:22:20] [config] word-scores: false
[2023-07-28 10:22:20] [config] workspace: 5500
[2023-07-28 10:22:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:22:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:22:20] [training] Using single-device training
[2023-07-28 10:22:21] Synced seed 1234
[2023-07-28 10:22:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:22:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 10:22:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:22:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 10:22:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 10:22:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:22:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 10:22:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:22:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:22:22] [comm] Using global sharding
[2023-07-28 10:22:22] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:22:22] [training] Using 1 GPUs
[2023-07-28 10:22:22] [logits] Applying loss function for 1 factor(s)
[2023-07-28 10:22:22] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:22:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 10:22:22] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:26:50] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 10:26:51] [valid] No post-processing script given for validating translator
[2023-07-28 10:26:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:26:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:26:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:26:51] [comm] Using global sharding
[2023-07-28 10:26:51] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:26:51] [training] Using 1 GPUs
[2023-07-28 10:26:51] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:26:52] Allocating memory for general optimizer shards
[2023-07-28 10:26:52] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:26:52] Loading Adam parameters
[2023-07-28 10:26:52] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:26:53] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:26:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:26:53] [data] Restoring the corpus state to epoch 351, batch 9566
[2023-07-28 10:26:53] [data] Shuffling data
[2023-07-28 10:26:53] [data] Done reading 20,192 sentences
[2023-07-28 10:26:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:26:53] Training started
[2023-07-28 10:26:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 10:26:53] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:26:55] Parameter type float16, optimization type float32, casting types true
[2023-07-28 10:28:02] Seen 20,192 samples
[2023-07-28 10:28:02] Starting data epoch 352 in logical epoch 352
[2023-07-28 10:28:02] [data] Shuffling data
[2023-07-28 10:28:02] [data] Done reading 20,192 sentences
[2023-07-28 10:28:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:29:10] Seen 20,192 samples
[2023-07-28 10:29:10] Starting data epoch 353 in logical epoch 353
[2023-07-28 10:29:10] [data] Shuffling data
[2023-07-28 10:29:11] [data] Done reading 20,192 sentences
[2023-07-28 10:29:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:30:20] Seen 20,192 samples
[2023-07-28 10:30:20] Starting data epoch 354 in logical epoch 354
[2023-07-28 10:30:20] [data] Shuffling data
[2023-07-28 10:30:20] [data] Done reading 20,192 sentences
[2023-07-28 10:30:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:31:30] Seen 20,192 samples
[2023-07-28 10:31:30] Starting data epoch 355 in logical epoch 355
[2023-07-28 10:31:30] [data] Shuffling data
[2023-07-28 10:31:30] [data] Done reading 20,192 sentences
[2023-07-28 10:31:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:32:43] Seen 20,192 samples
[2023-07-28 10:32:43] Starting data epoch 356 in logical epoch 356
[2023-07-28 10:32:43] [data] Shuffling data
[2023-07-28 10:32:43] [data] Done reading 20,192 sentences
[2023-07-28 10:32:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:33:57] Seen 20,192 samples
[2023-07-28 10:33:57] Starting data epoch 357 in logical epoch 357
[2023-07-28 10:33:57] [data] Shuffling data
[2023-07-28 10:33:57] [data] Done reading 20,192 sentences
[2023-07-28 10:33:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:35:12] Seen 20,192 samples
[2023-07-28 10:35:12] Starting data epoch 358 in logical epoch 358
[2023-07-28 10:35:12] [data] Shuffling data
[2023-07-28 10:35:12] [data] Done reading 20,192 sentences
[2023-07-28 10:35:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:36:26] Seen 20,192 samples
[2023-07-28 10:36:26] Starting data epoch 359 in logical epoch 359
[2023-07-28 10:36:26] [data] Shuffling data
[2023-07-28 10:36:26] [data] Done reading 20,192 sentences
[2023-07-28 10:36:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:37:41] Seen 20,192 samples
[2023-07-28 10:37:41] Starting data epoch 360 in logical epoch 360
[2023-07-28 10:37:41] [data] Shuffling data
[2023-07-28 10:37:41] [data] Done reading 20,192 sentences
[2023-07-28 10:37:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:38:55] Seen 20,192 samples
[2023-07-28 10:38:55] Starting data epoch 361 in logical epoch 361
[2023-07-28 10:38:55] Training finished
[2023-07-28 10:39:36] [valid] Ep. 361 : Up. 9838 : translation : 0 : new best
[2023-07-28 10:39:36] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:39:38] Saving Adam parameters
[2023-07-28 10:39:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:39:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:39:46] [marian] Running on node05.datos.cluster.uy as process 38970 with command line:
[2023-07-28 10:39:46] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 370 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 10:39:46] [config] after: 0e
[2023-07-28 10:39:46] [config] after-batches: 0
[2023-07-28 10:39:46] [config] after-epochs: 370
[2023-07-28 10:39:46] [config] all-caps-every: 0
[2023-07-28 10:39:46] [config] allow-unk: false
[2023-07-28 10:39:46] [config] authors: false
[2023-07-28 10:39:46] [config] beam-size: 12
[2023-07-28 10:39:46] [config] bert-class-symbol: "[CLS]"
[2023-07-28 10:39:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 10:39:46] [config] bert-masking-fraction: 0.15
[2023-07-28 10:39:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 10:39:46] [config] bert-train-type-embeddings: true
[2023-07-28 10:39:46] [config] bert-type-vocab-size: 2
[2023-07-28 10:39:46] [config] build-info: ""
[2023-07-28 10:39:46] [config] check-gradient-nan: false
[2023-07-28 10:39:46] [config] check-nan: false
[2023-07-28 10:39:46] [config] cite: false
[2023-07-28 10:39:46] [config] clip-norm: 1
[2023-07-28 10:39:46] [config] cost-scaling:
[2023-07-28 10:39:46] [config]   - 256.f
[2023-07-28 10:39:46] [config]   - 1000
[2023-07-28 10:39:46] [config]   - 2.f
[2023-07-28 10:39:46] [config]   - 256.f
[2023-07-28 10:39:46] [config] cost-type: ce-sum
[2023-07-28 10:39:46] [config] cpu-threads: 0
[2023-07-28 10:39:46] [config] data-threads: 8
[2023-07-28 10:39:46] [config] data-weighting: ""
[2023-07-28 10:39:46] [config] data-weighting-type: sentence
[2023-07-28 10:39:46] [config] dec-cell: gru
[2023-07-28 10:39:46] [config] dec-cell-base-depth: 2
[2023-07-28 10:39:46] [config] dec-cell-high-depth: 1
[2023-07-28 10:39:46] [config] dec-depth: 1
[2023-07-28 10:39:46] [config] devices:
[2023-07-28 10:39:46] [config]   - 0
[2023-07-28 10:39:46] [config] dim-emb: 512
[2023-07-28 10:39:46] [config] dim-rnn: 1024
[2023-07-28 10:39:46] [config] dim-vocabs:
[2023-07-28 10:39:46] [config]   - 16384
[2023-07-28 10:39:46] [config]   - 16384
[2023-07-28 10:39:46] [config] disp-first: 0
[2023-07-28 10:39:46] [config] disp-freq: 1000u
[2023-07-28 10:39:46] [config] disp-label-counts: true
[2023-07-28 10:39:46] [config] dropout-rnn: 0
[2023-07-28 10:39:46] [config] dropout-src: 0
[2023-07-28 10:39:46] [config] dropout-trg: 0
[2023-07-28 10:39:46] [config] dump-config: ""
[2023-07-28 10:39:46] [config] dynamic-gradient-scaling:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] early-stopping: 1000
[2023-07-28 10:39:46] [config] early-stopping-on: first
[2023-07-28 10:39:46] [config] embedding-fix-src: false
[2023-07-28 10:39:46] [config] embedding-fix-trg: false
[2023-07-28 10:39:46] [config] embedding-normalization: false
[2023-07-28 10:39:46] [config] embedding-vectors:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] enc-cell: gru
[2023-07-28 10:39:46] [config] enc-cell-depth: 1
[2023-07-28 10:39:46] [config] enc-depth: 1
[2023-07-28 10:39:46] [config] enc-type: bidirectional
[2023-07-28 10:39:46] [config] english-title-case-every: 0
[2023-07-28 10:39:46] [config] exponential-smoothing: 0
[2023-07-28 10:39:46] [config] factor-weight: 1
[2023-07-28 10:39:46] [config] factors-combine: sum
[2023-07-28 10:39:46] [config] factors-dim-emb: 0
[2023-07-28 10:39:46] [config] gradient-checkpointing: false
[2023-07-28 10:39:46] [config] gradient-norm-average-window: 100
[2023-07-28 10:39:46] [config] guided-alignment: none
[2023-07-28 10:39:46] [config] guided-alignment-cost: mse
[2023-07-28 10:39:46] [config] guided-alignment-weight: 0.1
[2023-07-28 10:39:46] [config] ignore-model-config: false
[2023-07-28 10:39:46] [config] input-types:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] interpolate-env-vars: false
[2023-07-28 10:39:46] [config] keep-best: false
[2023-07-28 10:39:46] [config] label-smoothing: 0
[2023-07-28 10:39:46] [config] layer-normalization: false
[2023-07-28 10:39:46] [config] learn-rate: 0.0001
[2023-07-28 10:39:46] [config] lemma-dependency: ""
[2023-07-28 10:39:46] [config] lemma-dim-emb: 0
[2023-07-28 10:39:46] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:39:46] [config] log-level: info
[2023-07-28 10:39:46] [config] log-time-zone: ""
[2023-07-28 10:39:46] [config] logical-epoch:
[2023-07-28 10:39:46] [config]   - 1e
[2023-07-28 10:39:46] [config]   - 0
[2023-07-28 10:39:46] [config] lr-decay: 0
[2023-07-28 10:39:46] [config] lr-decay-freq: 50000
[2023-07-28 10:39:46] [config] lr-decay-inv-sqrt:
[2023-07-28 10:39:46] [config]   - 0
[2023-07-28 10:39:46] [config] lr-decay-repeat-warmup: false
[2023-07-28 10:39:46] [config] lr-decay-reset-optimizer: false
[2023-07-28 10:39:46] [config] lr-decay-start:
[2023-07-28 10:39:46] [config]   - 10
[2023-07-28 10:39:46] [config]   - 1
[2023-07-28 10:39:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 10:39:46] [config] lr-report: false
[2023-07-28 10:39:46] [config] lr-warmup: 0
[2023-07-28 10:39:46] [config] lr-warmup-at-reload: false
[2023-07-28 10:39:46] [config] lr-warmup-cycle: false
[2023-07-28 10:39:46] [config] lr-warmup-start-rate: 0
[2023-07-28 10:39:46] [config] max-length: 50
[2023-07-28 10:39:46] [config] max-length-crop: true
[2023-07-28 10:39:46] [config] max-length-factor: 3
[2023-07-28 10:39:46] [config] maxi-batch: 100
[2023-07-28 10:39:46] [config] maxi-batch-sort: trg
[2023-07-28 10:39:46] [config] mini-batch: 64
[2023-07-28 10:39:46] [config] mini-batch-fit: true
[2023-07-28 10:39:46] [config] mini-batch-fit-step: 10
[2023-07-28 10:39:46] [config] mini-batch-round-up: true
[2023-07-28 10:39:46] [config] mini-batch-track-lr: false
[2023-07-28 10:39:46] [config] mini-batch-warmup: 0
[2023-07-28 10:39:46] [config] mini-batch-words: 0
[2023-07-28 10:39:46] [config] mini-batch-words-ref: 0
[2023-07-28 10:39:46] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:39:46] [config] multi-loss-type: sum
[2023-07-28 10:39:46] [config] n-best: false
[2023-07-28 10:39:46] [config] no-nccl: false
[2023-07-28 10:39:46] [config] no-reload: false
[2023-07-28 10:39:46] [config] no-restore-corpus: false
[2023-07-28 10:39:46] [config] normalize: 0
[2023-07-28 10:39:46] [config] normalize-gradient: false
[2023-07-28 10:39:46] [config] num-devices: 0
[2023-07-28 10:39:46] [config] optimizer: adam
[2023-07-28 10:39:46] [config] optimizer-delay: 1
[2023-07-28 10:39:46] [config] optimizer-params:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] output-omit-bias: false
[2023-07-28 10:39:46] [config] overwrite: true
[2023-07-28 10:39:46] [config] precision:
[2023-07-28 10:39:46] [config]   - float16
[2023-07-28 10:39:46] [config]   - float32
[2023-07-28 10:39:46] [config] pretrained-model: ""
[2023-07-28 10:39:46] [config] quantize-biases: false
[2023-07-28 10:39:46] [config] quantize-bits: 0
[2023-07-28 10:39:46] [config] quantize-log-based: false
[2023-07-28 10:39:46] [config] quantize-optimization-steps: 0
[2023-07-28 10:39:46] [config] quiet: false
[2023-07-28 10:39:46] [config] quiet-translation: true
[2023-07-28 10:39:46] [config] relative-paths: false
[2023-07-28 10:39:46] [config] right-left: false
[2023-07-28 10:39:46] [config] save-freq: 10000u
[2023-07-28 10:39:46] [config] seed: 1234
[2023-07-28 10:39:46] [config] sentencepiece-alphas:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] sentencepiece-max-lines: 2000000
[2023-07-28 10:39:46] [config] sentencepiece-options: ""
[2023-07-28 10:39:46] [config] sharding: global
[2023-07-28 10:39:46] [config] shuffle: data
[2023-07-28 10:39:46] [config] shuffle-in-ram: false
[2023-07-28 10:39:46] [config] sigterm: save-and-exit
[2023-07-28 10:39:46] [config] skip: false
[2023-07-28 10:39:46] [config] sqlite: ""
[2023-07-28 10:39:46] [config] sqlite-drop: false
[2023-07-28 10:39:46] [config] sync-freq: 200u
[2023-07-28 10:39:46] [config] sync-sgd: false
[2023-07-28 10:39:46] [config] tempdir: /tmp
[2023-07-28 10:39:46] [config] tied-embeddings: false
[2023-07-28 10:39:46] [config] tied-embeddings-all: true
[2023-07-28 10:39:46] [config] tied-embeddings-src: false
[2023-07-28 10:39:46] [config] train-embedder-rank:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] train-sets:
[2023-07-28 10:39:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 10:39:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 10:39:46] [config] transformer-aan-activation: swish
[2023-07-28 10:39:46] [config] transformer-aan-depth: 2
[2023-07-28 10:39:46] [config] transformer-aan-nogate: false
[2023-07-28 10:39:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 10:39:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 10:39:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 10:39:46] [config] transformer-depth-scaling: false
[2023-07-28 10:39:46] [config] transformer-dim-aan: 2048
[2023-07-28 10:39:46] [config] transformer-dim-ffn: 2048
[2023-07-28 10:39:46] [config] transformer-dropout: 0
[2023-07-28 10:39:46] [config] transformer-dropout-attention: 0
[2023-07-28 10:39:46] [config] transformer-dropout-ffn: 0
[2023-07-28 10:39:46] [config] transformer-ffn-activation: swish
[2023-07-28 10:39:46] [config] transformer-ffn-depth: 2
[2023-07-28 10:39:46] [config] transformer-guided-alignment-layer: last
[2023-07-28 10:39:46] [config] transformer-heads: 8
[2023-07-28 10:39:46] [config] transformer-no-projection: false
[2023-07-28 10:39:46] [config] transformer-pool: false
[2023-07-28 10:39:46] [config] transformer-postprocess: dan
[2023-07-28 10:39:46] [config] transformer-postprocess-emb: d
[2023-07-28 10:39:46] [config] transformer-postprocess-top: ""
[2023-07-28 10:39:46] [config] transformer-preprocess: ""
[2023-07-28 10:39:46] [config] transformer-tied-layers:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] transformer-train-position-embeddings: false
[2023-07-28 10:39:46] [config] tsv: false
[2023-07-28 10:39:46] [config] tsv-fields: 0
[2023-07-28 10:39:46] [config] type: s2s
[2023-07-28 10:39:46] [config] ulr: false
[2023-07-28 10:39:46] [config] ulr-dim-emb: 0
[2023-07-28 10:39:46] [config] ulr-dropout: 0
[2023-07-28 10:39:46] [config] ulr-keys-vectors: ""
[2023-07-28 10:39:46] [config] ulr-query-vectors: ""
[2023-07-28 10:39:46] [config] ulr-softmax-temperature: 1
[2023-07-28 10:39:46] [config] ulr-trainable-transformation: false
[2023-07-28 10:39:46] [config] unlikelihood-loss: false
[2023-07-28 10:39:46] [config] valid-freq: 50000000
[2023-07-28 10:39:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:39:46] [config] valid-max-length: 1000
[2023-07-28 10:39:46] [config] valid-metrics:
[2023-07-28 10:39:46] [config]   - translation
[2023-07-28 10:39:46] [config] valid-mini-batch: 32
[2023-07-28 10:39:46] [config] valid-reset-stalled: false
[2023-07-28 10:39:46] [config] valid-script-args:
[2023-07-28 10:39:46] [config]   []
[2023-07-28 10:39:46] [config] valid-script-path: ""
[2023-07-28 10:39:46] [config] valid-sets:
[2023-07-28 10:39:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 10:39:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 10:39:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 10:39:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:39:46] [config] vocabs:
[2023-07-28 10:39:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:39:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:39:46] [config] word-penalty: 0
[2023-07-28 10:39:46] [config] word-scores: false
[2023-07-28 10:39:46] [config] workspace: 5500
[2023-07-28 10:39:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:39:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:39:46] [training] Using single-device training
[2023-07-28 10:39:46] Synced seed 1234
[2023-07-28 10:39:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:39:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 10:39:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:39:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 10:39:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 10:39:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:39:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 10:39:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:39:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:39:47] [comm] Using global sharding
[2023-07-28 10:39:47] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:39:47] [training] Using 1 GPUs
[2023-07-28 10:39:47] [logits] Applying loss function for 1 factor(s)
[2023-07-28 10:39:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:39:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 10:39:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:44:16] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 10:44:16] [valid] No post-processing script given for validating translator
[2023-07-28 10:44:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:44:16] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:44:16] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:44:16] [comm] Using global sharding
[2023-07-28 10:44:16] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:44:16] [training] Using 1 GPUs
[2023-07-28 10:44:16] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:44:17] Allocating memory for general optimizer shards
[2023-07-28 10:44:17] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:44:17] Loading Adam parameters
[2023-07-28 10:44:17] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:44:17] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:44:18] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:44:18] [data] Restoring the corpus state to epoch 361, batch 9838
[2023-07-28 10:44:18] [data] Shuffling data
[2023-07-28 10:44:18] [data] Done reading 20,192 sentences
[2023-07-28 10:44:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:44:18] Training started
[2023-07-28 10:44:18] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 10:44:19] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:44:23] Parameter type float16, optimization type float32, casting types true
[2023-07-28 10:45:28] Seen 20,192 samples
[2023-07-28 10:45:28] Starting data epoch 362 in logical epoch 362
[2023-07-28 10:45:28] [data] Shuffling data
[2023-07-28 10:45:28] [data] Done reading 20,192 sentences
[2023-07-28 10:45:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:46:36] Seen 20,192 samples
[2023-07-28 10:46:36] Starting data epoch 363 in logical epoch 363
[2023-07-28 10:46:36] [data] Shuffling data
[2023-07-28 10:46:36] [data] Done reading 20,192 sentences
[2023-07-28 10:46:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:47:48] Seen 20,192 samples
[2023-07-28 10:47:48] Starting data epoch 364 in logical epoch 364
[2023-07-28 10:47:48] [data] Shuffling data
[2023-07-28 10:47:48] [data] Done reading 20,192 sentences
[2023-07-28 10:47:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:48:59] Seen 20,192 samples
[2023-07-28 10:48:59] Starting data epoch 365 in logical epoch 365
[2023-07-28 10:48:59] [data] Shuffling data
[2023-07-28 10:48:59] [data] Done reading 20,192 sentences
[2023-07-28 10:48:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:50:12] Seen 20,192 samples
[2023-07-28 10:50:12] Starting data epoch 366 in logical epoch 366
[2023-07-28 10:50:12] [data] Shuffling data
[2023-07-28 10:50:12] [data] Done reading 20,192 sentences
[2023-07-28 10:50:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:51:13] Ep. 366 : Up. 10000 : Sen. 17,758 : Cost 2.09972429 * 20,718,952 @ 36,050 after 207,468,383 : Time 417.74s : 49597.53 words/s : gNorm 1.9249
[2023-07-28 10:51:13] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:51:15] Saving Adam parameters
[2023-07-28 10:51:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:51:31] Seen 20,192 samples
[2023-07-28 10:51:31] Starting data epoch 367 in logical epoch 367
[2023-07-28 10:51:31] [data] Shuffling data
[2023-07-28 10:51:31] [data] Done reading 20,192 sentences
[2023-07-28 10:51:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:52:43] Seen 20,192 samples
[2023-07-28 10:52:43] Starting data epoch 368 in logical epoch 368
[2023-07-28 10:52:43] [data] Shuffling data
[2023-07-28 10:52:43] [data] Done reading 20,192 sentences
[2023-07-28 10:52:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:53:54] Seen 20,192 samples
[2023-07-28 10:53:54] Starting data epoch 369 in logical epoch 369
[2023-07-28 10:53:54] [data] Shuffling data
[2023-07-28 10:53:54] [data] Done reading 20,192 sentences
[2023-07-28 10:53:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:55:06] Seen 20,192 samples
[2023-07-28 10:55:06] Starting data epoch 370 in logical epoch 370
[2023-07-28 10:55:06] [data] Shuffling data
[2023-07-28 10:55:06] [data] Done reading 20,192 sentences
[2023-07-28 10:55:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:56:17] Seen 20,192 samples
[2023-07-28 10:56:17] Starting data epoch 371 in logical epoch 371
[2023-07-28 10:56:17] Training finished
[2023-07-28 10:56:58] [valid] Ep. 371 : Up. 10114 : translation : 0 : new best
[2023-07-28 10:56:58] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:57:00] Saving Adam parameters
[2023-07-28 10:57:01] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 10:57:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:57:08] [marian] Running on node05.datos.cluster.uy as process 40246 with command line:
[2023-07-28 10:57:08] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 380 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 10:57:08] [config] after: 0e
[2023-07-28 10:57:08] [config] after-batches: 0
[2023-07-28 10:57:08] [config] after-epochs: 380
[2023-07-28 10:57:08] [config] all-caps-every: 0
[2023-07-28 10:57:08] [config] allow-unk: false
[2023-07-28 10:57:08] [config] authors: false
[2023-07-28 10:57:08] [config] beam-size: 12
[2023-07-28 10:57:08] [config] bert-class-symbol: "[CLS]"
[2023-07-28 10:57:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 10:57:08] [config] bert-masking-fraction: 0.15
[2023-07-28 10:57:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 10:57:08] [config] bert-train-type-embeddings: true
[2023-07-28 10:57:08] [config] bert-type-vocab-size: 2
[2023-07-28 10:57:08] [config] build-info: ""
[2023-07-28 10:57:08] [config] check-gradient-nan: false
[2023-07-28 10:57:08] [config] check-nan: false
[2023-07-28 10:57:08] [config] cite: false
[2023-07-28 10:57:08] [config] clip-norm: 1
[2023-07-28 10:57:08] [config] cost-scaling:
[2023-07-28 10:57:08] [config]   - 256.f
[2023-07-28 10:57:08] [config]   - 1000
[2023-07-28 10:57:08] [config]   - 2.f
[2023-07-28 10:57:08] [config]   - 256.f
[2023-07-28 10:57:08] [config] cost-type: ce-sum
[2023-07-28 10:57:08] [config] cpu-threads: 0
[2023-07-28 10:57:08] [config] data-threads: 8
[2023-07-28 10:57:08] [config] data-weighting: ""
[2023-07-28 10:57:08] [config] data-weighting-type: sentence
[2023-07-28 10:57:08] [config] dec-cell: gru
[2023-07-28 10:57:08] [config] dec-cell-base-depth: 2
[2023-07-28 10:57:08] [config] dec-cell-high-depth: 1
[2023-07-28 10:57:08] [config] dec-depth: 1
[2023-07-28 10:57:08] [config] devices:
[2023-07-28 10:57:08] [config]   - 0
[2023-07-28 10:57:08] [config] dim-emb: 512
[2023-07-28 10:57:08] [config] dim-rnn: 1024
[2023-07-28 10:57:08] [config] dim-vocabs:
[2023-07-28 10:57:08] [config]   - 16384
[2023-07-28 10:57:08] [config]   - 16384
[2023-07-28 10:57:08] [config] disp-first: 0
[2023-07-28 10:57:08] [config] disp-freq: 1000u
[2023-07-28 10:57:08] [config] disp-label-counts: true
[2023-07-28 10:57:08] [config] dropout-rnn: 0
[2023-07-28 10:57:08] [config] dropout-src: 0
[2023-07-28 10:57:08] [config] dropout-trg: 0
[2023-07-28 10:57:08] [config] dump-config: ""
[2023-07-28 10:57:08] [config] dynamic-gradient-scaling:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] early-stopping: 1000
[2023-07-28 10:57:08] [config] early-stopping-on: first
[2023-07-28 10:57:08] [config] embedding-fix-src: false
[2023-07-28 10:57:08] [config] embedding-fix-trg: false
[2023-07-28 10:57:08] [config] embedding-normalization: false
[2023-07-28 10:57:08] [config] embedding-vectors:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] enc-cell: gru
[2023-07-28 10:57:08] [config] enc-cell-depth: 1
[2023-07-28 10:57:08] [config] enc-depth: 1
[2023-07-28 10:57:08] [config] enc-type: bidirectional
[2023-07-28 10:57:08] [config] english-title-case-every: 0
[2023-07-28 10:57:08] [config] exponential-smoothing: 0
[2023-07-28 10:57:08] [config] factor-weight: 1
[2023-07-28 10:57:08] [config] factors-combine: sum
[2023-07-28 10:57:08] [config] factors-dim-emb: 0
[2023-07-28 10:57:08] [config] gradient-checkpointing: false
[2023-07-28 10:57:08] [config] gradient-norm-average-window: 100
[2023-07-28 10:57:08] [config] guided-alignment: none
[2023-07-28 10:57:08] [config] guided-alignment-cost: mse
[2023-07-28 10:57:08] [config] guided-alignment-weight: 0.1
[2023-07-28 10:57:08] [config] ignore-model-config: false
[2023-07-28 10:57:08] [config] input-types:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] interpolate-env-vars: false
[2023-07-28 10:57:08] [config] keep-best: false
[2023-07-28 10:57:08] [config] label-smoothing: 0
[2023-07-28 10:57:08] [config] layer-normalization: false
[2023-07-28 10:57:08] [config] learn-rate: 0.0001
[2023-07-28 10:57:08] [config] lemma-dependency: ""
[2023-07-28 10:57:08] [config] lemma-dim-emb: 0
[2023-07-28 10:57:08] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:57:08] [config] log-level: info
[2023-07-28 10:57:08] [config] log-time-zone: ""
[2023-07-28 10:57:08] [config] logical-epoch:
[2023-07-28 10:57:08] [config]   - 1e
[2023-07-28 10:57:08] [config]   - 0
[2023-07-28 10:57:08] [config] lr-decay: 0
[2023-07-28 10:57:08] [config] lr-decay-freq: 50000
[2023-07-28 10:57:08] [config] lr-decay-inv-sqrt:
[2023-07-28 10:57:08] [config]   - 0
[2023-07-28 10:57:08] [config] lr-decay-repeat-warmup: false
[2023-07-28 10:57:08] [config] lr-decay-reset-optimizer: false
[2023-07-28 10:57:08] [config] lr-decay-start:
[2023-07-28 10:57:08] [config]   - 10
[2023-07-28 10:57:08] [config]   - 1
[2023-07-28 10:57:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 10:57:08] [config] lr-report: false
[2023-07-28 10:57:08] [config] lr-warmup: 0
[2023-07-28 10:57:08] [config] lr-warmup-at-reload: false
[2023-07-28 10:57:08] [config] lr-warmup-cycle: false
[2023-07-28 10:57:08] [config] lr-warmup-start-rate: 0
[2023-07-28 10:57:08] [config] max-length: 50
[2023-07-28 10:57:08] [config] max-length-crop: true
[2023-07-28 10:57:08] [config] max-length-factor: 3
[2023-07-28 10:57:08] [config] maxi-batch: 100
[2023-07-28 10:57:08] [config] maxi-batch-sort: trg
[2023-07-28 10:57:08] [config] mini-batch: 64
[2023-07-28 10:57:08] [config] mini-batch-fit: true
[2023-07-28 10:57:08] [config] mini-batch-fit-step: 10
[2023-07-28 10:57:08] [config] mini-batch-round-up: true
[2023-07-28 10:57:08] [config] mini-batch-track-lr: false
[2023-07-28 10:57:08] [config] mini-batch-warmup: 0
[2023-07-28 10:57:08] [config] mini-batch-words: 0
[2023-07-28 10:57:08] [config] mini-batch-words-ref: 0
[2023-07-28 10:57:08] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 10:57:08] [config] multi-loss-type: sum
[2023-07-28 10:57:08] [config] n-best: false
[2023-07-28 10:57:08] [config] no-nccl: false
[2023-07-28 10:57:08] [config] no-reload: false
[2023-07-28 10:57:08] [config] no-restore-corpus: false
[2023-07-28 10:57:08] [config] normalize: 0
[2023-07-28 10:57:08] [config] normalize-gradient: false
[2023-07-28 10:57:08] [config] num-devices: 0
[2023-07-28 10:57:08] [config] optimizer: adam
[2023-07-28 10:57:08] [config] optimizer-delay: 1
[2023-07-28 10:57:08] [config] optimizer-params:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] output-omit-bias: false
[2023-07-28 10:57:08] [config] overwrite: true
[2023-07-28 10:57:08] [config] precision:
[2023-07-28 10:57:08] [config]   - float16
[2023-07-28 10:57:08] [config]   - float32
[2023-07-28 10:57:08] [config] pretrained-model: ""
[2023-07-28 10:57:08] [config] quantize-biases: false
[2023-07-28 10:57:08] [config] quantize-bits: 0
[2023-07-28 10:57:08] [config] quantize-log-based: false
[2023-07-28 10:57:08] [config] quantize-optimization-steps: 0
[2023-07-28 10:57:08] [config] quiet: false
[2023-07-28 10:57:08] [config] quiet-translation: true
[2023-07-28 10:57:08] [config] relative-paths: false
[2023-07-28 10:57:08] [config] right-left: false
[2023-07-28 10:57:08] [config] save-freq: 10000u
[2023-07-28 10:57:08] [config] seed: 1234
[2023-07-28 10:57:08] [config] sentencepiece-alphas:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] sentencepiece-max-lines: 2000000
[2023-07-28 10:57:08] [config] sentencepiece-options: ""
[2023-07-28 10:57:08] [config] sharding: global
[2023-07-28 10:57:08] [config] shuffle: data
[2023-07-28 10:57:08] [config] shuffle-in-ram: false
[2023-07-28 10:57:08] [config] sigterm: save-and-exit
[2023-07-28 10:57:08] [config] skip: false
[2023-07-28 10:57:08] [config] sqlite: ""
[2023-07-28 10:57:08] [config] sqlite-drop: false
[2023-07-28 10:57:08] [config] sync-freq: 200u
[2023-07-28 10:57:08] [config] sync-sgd: false
[2023-07-28 10:57:08] [config] tempdir: /tmp
[2023-07-28 10:57:08] [config] tied-embeddings: false
[2023-07-28 10:57:08] [config] tied-embeddings-all: true
[2023-07-28 10:57:08] [config] tied-embeddings-src: false
[2023-07-28 10:57:08] [config] train-embedder-rank:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] train-sets:
[2023-07-28 10:57:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 10:57:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 10:57:08] [config] transformer-aan-activation: swish
[2023-07-28 10:57:08] [config] transformer-aan-depth: 2
[2023-07-28 10:57:08] [config] transformer-aan-nogate: false
[2023-07-28 10:57:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 10:57:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 10:57:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 10:57:08] [config] transformer-depth-scaling: false
[2023-07-28 10:57:08] [config] transformer-dim-aan: 2048
[2023-07-28 10:57:08] [config] transformer-dim-ffn: 2048
[2023-07-28 10:57:08] [config] transformer-dropout: 0
[2023-07-28 10:57:08] [config] transformer-dropout-attention: 0
[2023-07-28 10:57:08] [config] transformer-dropout-ffn: 0
[2023-07-28 10:57:08] [config] transformer-ffn-activation: swish
[2023-07-28 10:57:08] [config] transformer-ffn-depth: 2
[2023-07-28 10:57:08] [config] transformer-guided-alignment-layer: last
[2023-07-28 10:57:08] [config] transformer-heads: 8
[2023-07-28 10:57:08] [config] transformer-no-projection: false
[2023-07-28 10:57:08] [config] transformer-pool: false
[2023-07-28 10:57:08] [config] transformer-postprocess: dan
[2023-07-28 10:57:08] [config] transformer-postprocess-emb: d
[2023-07-28 10:57:08] [config] transformer-postprocess-top: ""
[2023-07-28 10:57:08] [config] transformer-preprocess: ""
[2023-07-28 10:57:08] [config] transformer-tied-layers:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] transformer-train-position-embeddings: false
[2023-07-28 10:57:08] [config] tsv: false
[2023-07-28 10:57:08] [config] tsv-fields: 0
[2023-07-28 10:57:08] [config] type: s2s
[2023-07-28 10:57:08] [config] ulr: false
[2023-07-28 10:57:08] [config] ulr-dim-emb: 0
[2023-07-28 10:57:08] [config] ulr-dropout: 0
[2023-07-28 10:57:08] [config] ulr-keys-vectors: ""
[2023-07-28 10:57:08] [config] ulr-query-vectors: ""
[2023-07-28 10:57:08] [config] ulr-softmax-temperature: 1
[2023-07-28 10:57:08] [config] ulr-trainable-transformation: false
[2023-07-28 10:57:08] [config] unlikelihood-loss: false
[2023-07-28 10:57:08] [config] valid-freq: 50000000
[2023-07-28 10:57:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 10:57:08] [config] valid-max-length: 1000
[2023-07-28 10:57:08] [config] valid-metrics:
[2023-07-28 10:57:08] [config]   - translation
[2023-07-28 10:57:08] [config] valid-mini-batch: 32
[2023-07-28 10:57:08] [config] valid-reset-stalled: false
[2023-07-28 10:57:08] [config] valid-script-args:
[2023-07-28 10:57:08] [config]   []
[2023-07-28 10:57:08] [config] valid-script-path: ""
[2023-07-28 10:57:08] [config] valid-sets:
[2023-07-28 10:57:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 10:57:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 10:57:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 10:57:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:57:08] [config] vocabs:
[2023-07-28 10:57:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:57:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:57:08] [config] word-penalty: 0
[2023-07-28 10:57:08] [config] word-scores: false
[2023-07-28 10:57:08] [config] workspace: 5500
[2023-07-28 10:57:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:57:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:57:08] [training] Using single-device training
[2023-07-28 10:57:08] Synced seed 1234
[2023-07-28 10:57:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:57:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 10:57:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:57:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 10:57:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 10:57:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:57:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 10:57:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:57:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:57:09] [comm] Using global sharding
[2023-07-28 10:57:09] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:57:09] [training] Using 1 GPUs
[2023-07-28 10:57:09] [logits] Applying loss function for 1 factor(s)
[2023-07-28 10:57:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:57:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 10:57:10] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:01:38] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 11:01:38] [valid] No post-processing script given for validating translator
[2023-07-28 11:01:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:01:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:01:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:01:38] [comm] Using global sharding
[2023-07-28 11:01:38] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:01:38] [training] Using 1 GPUs
[2023-07-28 11:01:38] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:01:39] Allocating memory for general optimizer shards
[2023-07-28 11:01:39] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:01:39] Loading Adam parameters
[2023-07-28 11:01:39] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:01:39] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:01:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 11:01:40] [data] Restoring the corpus state to epoch 371, batch 10114
[2023-07-28 11:01:40] [data] Shuffling data
[2023-07-28 11:01:40] [data] Done reading 20,192 sentences
[2023-07-28 11:01:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:01:40] Training started
[2023-07-28 11:01:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 11:01:40] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:01:42] Parameter type float16, optimization type float32, casting types true
[2023-07-28 11:02:48] Seen 20,192 samples
[2023-07-28 11:02:48] Starting data epoch 372 in logical epoch 372
[2023-07-28 11:02:48] [data] Shuffling data
[2023-07-28 11:02:48] [data] Done reading 20,192 sentences
[2023-07-28 11:02:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:03:54] Seen 20,192 samples
[2023-07-28 11:03:54] Starting data epoch 373 in logical epoch 373
[2023-07-28 11:03:54] [data] Shuffling data
[2023-07-28 11:03:54] [data] Done reading 20,192 sentences
[2023-07-28 11:03:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:05:04] Seen 20,192 samples
[2023-07-28 11:05:04] Starting data epoch 374 in logical epoch 374
[2023-07-28 11:05:04] [data] Shuffling data
[2023-07-28 11:05:04] [data] Done reading 20,192 sentences
[2023-07-28 11:05:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:06:17] Seen 20,192 samples
[2023-07-28 11:06:17] Starting data epoch 375 in logical epoch 375
[2023-07-28 11:06:17] [data] Shuffling data
[2023-07-28 11:06:17] [data] Done reading 20,192 sentences
[2023-07-28 11:06:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:07:27] Seen 20,192 samples
[2023-07-28 11:07:27] Starting data epoch 376 in logical epoch 376
[2023-07-28 11:07:27] [data] Shuffling data
[2023-07-28 11:07:27] [data] Done reading 20,192 sentences
[2023-07-28 11:07:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:08:40] Seen 20,192 samples
[2023-07-28 11:08:40] Starting data epoch 377 in logical epoch 377
[2023-07-28 11:08:40] [data] Shuffling data
[2023-07-28 11:08:40] [data] Done reading 20,192 sentences
[2023-07-28 11:08:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:09:53] Seen 20,192 samples
[2023-07-28 11:09:53] Starting data epoch 378 in logical epoch 378
[2023-07-28 11:09:53] [data] Shuffling data
[2023-07-28 11:09:53] [data] Done reading 20,192 sentences
[2023-07-28 11:09:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:11:06] Seen 20,192 samples
[2023-07-28 11:11:06] Starting data epoch 379 in logical epoch 379
[2023-07-28 11:11:06] [data] Shuffling data
[2023-07-28 11:11:06] [data] Done reading 20,192 sentences
[2023-07-28 11:11:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:12:19] Seen 20,192 samples
[2023-07-28 11:12:19] Starting data epoch 380 in logical epoch 380
[2023-07-28 11:12:19] [data] Shuffling data
[2023-07-28 11:12:19] [data] Done reading 20,192 sentences
[2023-07-28 11:12:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:13:31] Seen 20,192 samples
[2023-07-28 11:13:31] Starting data epoch 381 in logical epoch 381
[2023-07-28 11:13:31] Training finished
[2023-07-28 11:14:13] [valid] Ep. 381 : Up. 10388 : translation : 0 : new best
[2023-07-28 11:14:13] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:14:15] Saving Adam parameters
[2023-07-28 11:14:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 11:14:25] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:14:25] [marian] Running on node05.datos.cluster.uy as process 561 with command line:
[2023-07-28 11:14:25] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 390 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 11:14:25] [config] after: 0e
[2023-07-28 11:14:25] [config] after-batches: 0
[2023-07-28 11:14:25] [config] after-epochs: 390
[2023-07-28 11:14:25] [config] all-caps-every: 0
[2023-07-28 11:14:25] [config] allow-unk: false
[2023-07-28 11:14:25] [config] authors: false
[2023-07-28 11:14:25] [config] beam-size: 12
[2023-07-28 11:14:25] [config] bert-class-symbol: "[CLS]"
[2023-07-28 11:14:25] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 11:14:25] [config] bert-masking-fraction: 0.15
[2023-07-28 11:14:25] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 11:14:25] [config] bert-train-type-embeddings: true
[2023-07-28 11:14:25] [config] bert-type-vocab-size: 2
[2023-07-28 11:14:25] [config] build-info: ""
[2023-07-28 11:14:25] [config] check-gradient-nan: false
[2023-07-28 11:14:25] [config] check-nan: false
[2023-07-28 11:14:25] [config] cite: false
[2023-07-28 11:14:25] [config] clip-norm: 1
[2023-07-28 11:14:25] [config] cost-scaling:
[2023-07-28 11:14:25] [config]   - 256.f
[2023-07-28 11:14:25] [config]   - 1000
[2023-07-28 11:14:25] [config]   - 2.f
[2023-07-28 11:14:25] [config]   - 256.f
[2023-07-28 11:14:25] [config] cost-type: ce-sum
[2023-07-28 11:14:25] [config] cpu-threads: 0
[2023-07-28 11:14:25] [config] data-threads: 8
[2023-07-28 11:14:25] [config] data-weighting: ""
[2023-07-28 11:14:25] [config] data-weighting-type: sentence
[2023-07-28 11:14:25] [config] dec-cell: gru
[2023-07-28 11:14:25] [config] dec-cell-base-depth: 2
[2023-07-28 11:14:25] [config] dec-cell-high-depth: 1
[2023-07-28 11:14:25] [config] dec-depth: 1
[2023-07-28 11:14:25] [config] devices:
[2023-07-28 11:14:25] [config]   - 0
[2023-07-28 11:14:25] [config] dim-emb: 512
[2023-07-28 11:14:25] [config] dim-rnn: 1024
[2023-07-28 11:14:25] [config] dim-vocabs:
[2023-07-28 11:14:25] [config]   - 16384
[2023-07-28 11:14:25] [config]   - 16384
[2023-07-28 11:14:25] [config] disp-first: 0
[2023-07-28 11:14:25] [config] disp-freq: 1000u
[2023-07-28 11:14:25] [config] disp-label-counts: true
[2023-07-28 11:14:25] [config] dropout-rnn: 0
[2023-07-28 11:14:25] [config] dropout-src: 0
[2023-07-28 11:14:25] [config] dropout-trg: 0
[2023-07-28 11:14:25] [config] dump-config: ""
[2023-07-28 11:14:25] [config] dynamic-gradient-scaling:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] early-stopping: 1000
[2023-07-28 11:14:25] [config] early-stopping-on: first
[2023-07-28 11:14:25] [config] embedding-fix-src: false
[2023-07-28 11:14:25] [config] embedding-fix-trg: false
[2023-07-28 11:14:25] [config] embedding-normalization: false
[2023-07-28 11:14:25] [config] embedding-vectors:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] enc-cell: gru
[2023-07-28 11:14:25] [config] enc-cell-depth: 1
[2023-07-28 11:14:25] [config] enc-depth: 1
[2023-07-28 11:14:25] [config] enc-type: bidirectional
[2023-07-28 11:14:25] [config] english-title-case-every: 0
[2023-07-28 11:14:25] [config] exponential-smoothing: 0
[2023-07-28 11:14:25] [config] factor-weight: 1
[2023-07-28 11:14:25] [config] factors-combine: sum
[2023-07-28 11:14:25] [config] factors-dim-emb: 0
[2023-07-28 11:14:25] [config] gradient-checkpointing: false
[2023-07-28 11:14:25] [config] gradient-norm-average-window: 100
[2023-07-28 11:14:25] [config] guided-alignment: none
[2023-07-28 11:14:25] [config] guided-alignment-cost: mse
[2023-07-28 11:14:25] [config] guided-alignment-weight: 0.1
[2023-07-28 11:14:25] [config] ignore-model-config: false
[2023-07-28 11:14:25] [config] input-types:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] interpolate-env-vars: false
[2023-07-28 11:14:25] [config] keep-best: false
[2023-07-28 11:14:25] [config] label-smoothing: 0
[2023-07-28 11:14:25] [config] layer-normalization: false
[2023-07-28 11:14:25] [config] learn-rate: 0.0001
[2023-07-28 11:14:25] [config] lemma-dependency: ""
[2023-07-28 11:14:25] [config] lemma-dim-emb: 0
[2023-07-28 11:14:25] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 11:14:25] [config] log-level: info
[2023-07-28 11:14:25] [config] log-time-zone: ""
[2023-07-28 11:14:25] [config] logical-epoch:
[2023-07-28 11:14:25] [config]   - 1e
[2023-07-28 11:14:25] [config]   - 0
[2023-07-28 11:14:25] [config] lr-decay: 0
[2023-07-28 11:14:25] [config] lr-decay-freq: 50000
[2023-07-28 11:14:25] [config] lr-decay-inv-sqrt:
[2023-07-28 11:14:25] [config]   - 0
[2023-07-28 11:14:25] [config] lr-decay-repeat-warmup: false
[2023-07-28 11:14:25] [config] lr-decay-reset-optimizer: false
[2023-07-28 11:14:25] [config] lr-decay-start:
[2023-07-28 11:14:25] [config]   - 10
[2023-07-28 11:14:25] [config]   - 1
[2023-07-28 11:14:25] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 11:14:25] [config] lr-report: false
[2023-07-28 11:14:25] [config] lr-warmup: 0
[2023-07-28 11:14:25] [config] lr-warmup-at-reload: false
[2023-07-28 11:14:25] [config] lr-warmup-cycle: false
[2023-07-28 11:14:25] [config] lr-warmup-start-rate: 0
[2023-07-28 11:14:25] [config] max-length: 50
[2023-07-28 11:14:25] [config] max-length-crop: true
[2023-07-28 11:14:25] [config] max-length-factor: 3
[2023-07-28 11:14:25] [config] maxi-batch: 100
[2023-07-28 11:14:25] [config] maxi-batch-sort: trg
[2023-07-28 11:14:25] [config] mini-batch: 64
[2023-07-28 11:14:25] [config] mini-batch-fit: true
[2023-07-28 11:14:25] [config] mini-batch-fit-step: 10
[2023-07-28 11:14:25] [config] mini-batch-round-up: true
[2023-07-28 11:14:25] [config] mini-batch-track-lr: false
[2023-07-28 11:14:25] [config] mini-batch-warmup: 0
[2023-07-28 11:14:25] [config] mini-batch-words: 0
[2023-07-28 11:14:25] [config] mini-batch-words-ref: 0
[2023-07-28 11:14:25] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:14:25] [config] multi-loss-type: sum
[2023-07-28 11:14:25] [config] n-best: false
[2023-07-28 11:14:25] [config] no-nccl: false
[2023-07-28 11:14:25] [config] no-reload: false
[2023-07-28 11:14:25] [config] no-restore-corpus: false
[2023-07-28 11:14:25] [config] normalize: 0
[2023-07-28 11:14:25] [config] normalize-gradient: false
[2023-07-28 11:14:25] [config] num-devices: 0
[2023-07-28 11:14:25] [config] optimizer: adam
[2023-07-28 11:14:25] [config] optimizer-delay: 1
[2023-07-28 11:14:25] [config] optimizer-params:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] output-omit-bias: false
[2023-07-28 11:14:25] [config] overwrite: true
[2023-07-28 11:14:25] [config] precision:
[2023-07-28 11:14:25] [config]   - float16
[2023-07-28 11:14:25] [config]   - float32
[2023-07-28 11:14:25] [config] pretrained-model: ""
[2023-07-28 11:14:25] [config] quantize-biases: false
[2023-07-28 11:14:25] [config] quantize-bits: 0
[2023-07-28 11:14:25] [config] quantize-log-based: false
[2023-07-28 11:14:25] [config] quantize-optimization-steps: 0
[2023-07-28 11:14:25] [config] quiet: false
[2023-07-28 11:14:25] [config] quiet-translation: true
[2023-07-28 11:14:25] [config] relative-paths: false
[2023-07-28 11:14:25] [config] right-left: false
[2023-07-28 11:14:25] [config] save-freq: 10000u
[2023-07-28 11:14:25] [config] seed: 1234
[2023-07-28 11:14:25] [config] sentencepiece-alphas:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] sentencepiece-max-lines: 2000000
[2023-07-28 11:14:25] [config] sentencepiece-options: ""
[2023-07-28 11:14:25] [config] sharding: global
[2023-07-28 11:14:25] [config] shuffle: data
[2023-07-28 11:14:25] [config] shuffle-in-ram: false
[2023-07-28 11:14:25] [config] sigterm: save-and-exit
[2023-07-28 11:14:25] [config] skip: false
[2023-07-28 11:14:25] [config] sqlite: ""
[2023-07-28 11:14:25] [config] sqlite-drop: false
[2023-07-28 11:14:25] [config] sync-freq: 200u
[2023-07-28 11:14:25] [config] sync-sgd: false
[2023-07-28 11:14:25] [config] tempdir: /tmp
[2023-07-28 11:14:25] [config] tied-embeddings: false
[2023-07-28 11:14:25] [config] tied-embeddings-all: true
[2023-07-28 11:14:25] [config] tied-embeddings-src: false
[2023-07-28 11:14:25] [config] train-embedder-rank:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] train-sets:
[2023-07-28 11:14:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 11:14:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 11:14:25] [config] transformer-aan-activation: swish
[2023-07-28 11:14:25] [config] transformer-aan-depth: 2
[2023-07-28 11:14:25] [config] transformer-aan-nogate: false
[2023-07-28 11:14:25] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 11:14:25] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 11:14:25] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 11:14:25] [config] transformer-depth-scaling: false
[2023-07-28 11:14:25] [config] transformer-dim-aan: 2048
[2023-07-28 11:14:25] [config] transformer-dim-ffn: 2048
[2023-07-28 11:14:25] [config] transformer-dropout: 0
[2023-07-28 11:14:25] [config] transformer-dropout-attention: 0
[2023-07-28 11:14:25] [config] transformer-dropout-ffn: 0
[2023-07-28 11:14:25] [config] transformer-ffn-activation: swish
[2023-07-28 11:14:25] [config] transformer-ffn-depth: 2
[2023-07-28 11:14:25] [config] transformer-guided-alignment-layer: last
[2023-07-28 11:14:25] [config] transformer-heads: 8
[2023-07-28 11:14:25] [config] transformer-no-projection: false
[2023-07-28 11:14:25] [config] transformer-pool: false
[2023-07-28 11:14:25] [config] transformer-postprocess: dan
[2023-07-28 11:14:25] [config] transformer-postprocess-emb: d
[2023-07-28 11:14:25] [config] transformer-postprocess-top: ""
[2023-07-28 11:14:25] [config] transformer-preprocess: ""
[2023-07-28 11:14:25] [config] transformer-tied-layers:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] transformer-train-position-embeddings: false
[2023-07-28 11:14:25] [config] tsv: false
[2023-07-28 11:14:25] [config] tsv-fields: 0
[2023-07-28 11:14:25] [config] type: s2s
[2023-07-28 11:14:25] [config] ulr: false
[2023-07-28 11:14:25] [config] ulr-dim-emb: 0
[2023-07-28 11:14:25] [config] ulr-dropout: 0
[2023-07-28 11:14:25] [config] ulr-keys-vectors: ""
[2023-07-28 11:14:25] [config] ulr-query-vectors: ""
[2023-07-28 11:14:25] [config] ulr-softmax-temperature: 1
[2023-07-28 11:14:25] [config] ulr-trainable-transformation: false
[2023-07-28 11:14:25] [config] unlikelihood-loss: false
[2023-07-28 11:14:25] [config] valid-freq: 50000000
[2023-07-28 11:14:25] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 11:14:25] [config] valid-max-length: 1000
[2023-07-28 11:14:25] [config] valid-metrics:
[2023-07-28 11:14:25] [config]   - translation
[2023-07-28 11:14:25] [config] valid-mini-batch: 32
[2023-07-28 11:14:25] [config] valid-reset-stalled: false
[2023-07-28 11:14:25] [config] valid-script-args:
[2023-07-28 11:14:25] [config]   []
[2023-07-28 11:14:25] [config] valid-script-path: ""
[2023-07-28 11:14:25] [config] valid-sets:
[2023-07-28 11:14:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 11:14:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 11:14:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 11:14:25] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:14:25] [config] vocabs:
[2023-07-28 11:14:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:14:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:14:25] [config] word-penalty: 0
[2023-07-28 11:14:25] [config] word-scores: false
[2023-07-28 11:14:25] [config] workspace: 5500
[2023-07-28 11:14:25] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:14:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:14:25] [training] Using single-device training
[2023-07-28 11:14:25] Synced seed 1234
[2023-07-28 11:14:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:14:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 11:14:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:14:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 11:14:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 11:14:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:14:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 11:14:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:14:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:14:26] [comm] Using global sharding
[2023-07-28 11:14:26] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:14:26] [training] Using 1 GPUs
[2023-07-28 11:14:26] [logits] Applying loss function for 1 factor(s)
[2023-07-28 11:14:26] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:14:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 11:14:26] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:18:55] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 11:18:55] [valid] No post-processing script given for validating translator
[2023-07-28 11:18:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:18:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:18:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:18:55] [comm] Using global sharding
[2023-07-28 11:18:55] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:18:55] [training] Using 1 GPUs
[2023-07-28 11:18:55] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:18:56] Allocating memory for general optimizer shards
[2023-07-28 11:18:56] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:18:56] Loading Adam parameters
[2023-07-28 11:18:56] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:18:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:18:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 11:18:57] [data] Restoring the corpus state to epoch 381, batch 10388
[2023-07-28 11:18:57] [data] Shuffling data
[2023-07-28 11:18:57] [data] Done reading 20,192 sentences
[2023-07-28 11:18:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:18:57] Training started
[2023-07-28 11:18:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 11:18:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:19:00] Parameter type float16, optimization type float32, casting types true
[2023-07-28 11:20:01] Seen 20,192 samples
[2023-07-28 11:20:01] Starting data epoch 382 in logical epoch 382
[2023-07-28 11:20:01] [data] Shuffling data
[2023-07-28 11:20:01] [data] Done reading 20,192 sentences
[2023-07-28 11:20:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:21:09] Seen 20,192 samples
[2023-07-28 11:21:09] Starting data epoch 383 in logical epoch 383
[2023-07-28 11:21:09] [data] Shuffling data
[2023-07-28 11:21:09] [data] Done reading 20,192 sentences
[2023-07-28 11:21:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:22:21] Seen 20,192 samples
[2023-07-28 11:22:21] Starting data epoch 384 in logical epoch 384
[2023-07-28 11:22:21] [data] Shuffling data
[2023-07-28 11:22:21] [data] Done reading 20,192 sentences
[2023-07-28 11:22:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:23:35] Seen 20,192 samples
[2023-07-28 11:23:35] Starting data epoch 385 in logical epoch 385
[2023-07-28 11:23:35] [data] Shuffling data
[2023-07-28 11:23:35] [data] Done reading 20,192 sentences
[2023-07-28 11:23:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:24:48] Seen 20,192 samples
[2023-07-28 11:24:48] Starting data epoch 386 in logical epoch 386
[2023-07-28 11:24:48] [data] Shuffling data
[2023-07-28 11:24:48] [data] Done reading 20,192 sentences
[2023-07-28 11:24:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:26:00] Seen 20,192 samples
[2023-07-28 11:26:00] Starting data epoch 387 in logical epoch 387
[2023-07-28 11:26:00] [data] Shuffling data
[2023-07-28 11:26:00] [data] Done reading 20,192 sentences
[2023-07-28 11:26:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:27:12] Seen 20,192 samples
[2023-07-28 11:27:12] Starting data epoch 388 in logical epoch 388
[2023-07-28 11:27:12] [data] Shuffling data
[2023-07-28 11:27:12] [data] Done reading 20,192 sentences
[2023-07-28 11:27:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:28:25] Seen 20,192 samples
[2023-07-28 11:28:25] Starting data epoch 389 in logical epoch 389
[2023-07-28 11:28:25] [data] Shuffling data
[2023-07-28 11:28:25] [data] Done reading 20,192 sentences
[2023-07-28 11:28:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:29:39] Seen 20,192 samples
[2023-07-28 11:29:39] Starting data epoch 390 in logical epoch 390
[2023-07-28 11:29:39] [data] Shuffling data
[2023-07-28 11:29:39] [data] Done reading 20,192 sentences
[2023-07-28 11:29:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:30:52] Seen 20,192 samples
[2023-07-28 11:30:52] Starting data epoch 391 in logical epoch 391
[2023-07-28 11:30:52] Training finished
[2023-07-28 11:31:34] [valid] Ep. 391 : Up. 10660 : translation : 0 : new best
[2023-07-28 11:31:34] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:31:36] Saving Adam parameters
[2023-07-28 11:31:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 11:31:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:31:43] [marian] Running on node05.datos.cluster.uy as process 1933 with command line:
[2023-07-28 11:31:43] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 400 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 11:31:43] [config] after: 0e
[2023-07-28 11:31:43] [config] after-batches: 0
[2023-07-28 11:31:43] [config] after-epochs: 400
[2023-07-28 11:31:43] [config] all-caps-every: 0
[2023-07-28 11:31:43] [config] allow-unk: false
[2023-07-28 11:31:43] [config] authors: false
[2023-07-28 11:31:43] [config] beam-size: 12
[2023-07-28 11:31:43] [config] bert-class-symbol: "[CLS]"
[2023-07-28 11:31:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 11:31:43] [config] bert-masking-fraction: 0.15
[2023-07-28 11:31:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 11:31:43] [config] bert-train-type-embeddings: true
[2023-07-28 11:31:43] [config] bert-type-vocab-size: 2
[2023-07-28 11:31:43] [config] build-info: ""
[2023-07-28 11:31:43] [config] check-gradient-nan: false
[2023-07-28 11:31:43] [config] check-nan: false
[2023-07-28 11:31:43] [config] cite: false
[2023-07-28 11:31:43] [config] clip-norm: 1
[2023-07-28 11:31:43] [config] cost-scaling:
[2023-07-28 11:31:43] [config]   - 256.f
[2023-07-28 11:31:43] [config]   - 1000
[2023-07-28 11:31:43] [config]   - 2.f
[2023-07-28 11:31:43] [config]   - 256.f
[2023-07-28 11:31:43] [config] cost-type: ce-sum
[2023-07-28 11:31:43] [config] cpu-threads: 0
[2023-07-28 11:31:43] [config] data-threads: 8
[2023-07-28 11:31:43] [config] data-weighting: ""
[2023-07-28 11:31:43] [config] data-weighting-type: sentence
[2023-07-28 11:31:43] [config] dec-cell: gru
[2023-07-28 11:31:43] [config] dec-cell-base-depth: 2
[2023-07-28 11:31:43] [config] dec-cell-high-depth: 1
[2023-07-28 11:31:43] [config] dec-depth: 1
[2023-07-28 11:31:43] [config] devices:
[2023-07-28 11:31:43] [config]   - 0
[2023-07-28 11:31:43] [config] dim-emb: 512
[2023-07-28 11:31:43] [config] dim-rnn: 1024
[2023-07-28 11:31:43] [config] dim-vocabs:
[2023-07-28 11:31:43] [config]   - 16384
[2023-07-28 11:31:43] [config]   - 16384
[2023-07-28 11:31:43] [config] disp-first: 0
[2023-07-28 11:31:43] [config] disp-freq: 1000u
[2023-07-28 11:31:43] [config] disp-label-counts: true
[2023-07-28 11:31:43] [config] dropout-rnn: 0
[2023-07-28 11:31:43] [config] dropout-src: 0
[2023-07-28 11:31:43] [config] dropout-trg: 0
[2023-07-28 11:31:43] [config] dump-config: ""
[2023-07-28 11:31:43] [config] dynamic-gradient-scaling:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] early-stopping: 1000
[2023-07-28 11:31:43] [config] early-stopping-on: first
[2023-07-28 11:31:43] [config] embedding-fix-src: false
[2023-07-28 11:31:43] [config] embedding-fix-trg: false
[2023-07-28 11:31:43] [config] embedding-normalization: false
[2023-07-28 11:31:43] [config] embedding-vectors:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] enc-cell: gru
[2023-07-28 11:31:43] [config] enc-cell-depth: 1
[2023-07-28 11:31:43] [config] enc-depth: 1
[2023-07-28 11:31:43] [config] enc-type: bidirectional
[2023-07-28 11:31:43] [config] english-title-case-every: 0
[2023-07-28 11:31:43] [config] exponential-smoothing: 0
[2023-07-28 11:31:43] [config] factor-weight: 1
[2023-07-28 11:31:43] [config] factors-combine: sum
[2023-07-28 11:31:43] [config] factors-dim-emb: 0
[2023-07-28 11:31:43] [config] gradient-checkpointing: false
[2023-07-28 11:31:43] [config] gradient-norm-average-window: 100
[2023-07-28 11:31:43] [config] guided-alignment: none
[2023-07-28 11:31:43] [config] guided-alignment-cost: mse
[2023-07-28 11:31:43] [config] guided-alignment-weight: 0.1
[2023-07-28 11:31:43] [config] ignore-model-config: false
[2023-07-28 11:31:43] [config] input-types:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] interpolate-env-vars: false
[2023-07-28 11:31:43] [config] keep-best: false
[2023-07-28 11:31:43] [config] label-smoothing: 0
[2023-07-28 11:31:43] [config] layer-normalization: false
[2023-07-28 11:31:43] [config] learn-rate: 0.0001
[2023-07-28 11:31:43] [config] lemma-dependency: ""
[2023-07-28 11:31:43] [config] lemma-dim-emb: 0
[2023-07-28 11:31:43] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 11:31:43] [config] log-level: info
[2023-07-28 11:31:43] [config] log-time-zone: ""
[2023-07-28 11:31:43] [config] logical-epoch:
[2023-07-28 11:31:43] [config]   - 1e
[2023-07-28 11:31:43] [config]   - 0
[2023-07-28 11:31:43] [config] lr-decay: 0
[2023-07-28 11:31:43] [config] lr-decay-freq: 50000
[2023-07-28 11:31:43] [config] lr-decay-inv-sqrt:
[2023-07-28 11:31:43] [config]   - 0
[2023-07-28 11:31:43] [config] lr-decay-repeat-warmup: false
[2023-07-28 11:31:43] [config] lr-decay-reset-optimizer: false
[2023-07-28 11:31:43] [config] lr-decay-start:
[2023-07-28 11:31:43] [config]   - 10
[2023-07-28 11:31:43] [config]   - 1
[2023-07-28 11:31:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 11:31:43] [config] lr-report: false
[2023-07-28 11:31:43] [config] lr-warmup: 0
[2023-07-28 11:31:43] [config] lr-warmup-at-reload: false
[2023-07-28 11:31:43] [config] lr-warmup-cycle: false
[2023-07-28 11:31:43] [config] lr-warmup-start-rate: 0
[2023-07-28 11:31:43] [config] max-length: 50
[2023-07-28 11:31:43] [config] max-length-crop: true
[2023-07-28 11:31:43] [config] max-length-factor: 3
[2023-07-28 11:31:43] [config] maxi-batch: 100
[2023-07-28 11:31:43] [config] maxi-batch-sort: trg
[2023-07-28 11:31:43] [config] mini-batch: 64
[2023-07-28 11:31:43] [config] mini-batch-fit: true
[2023-07-28 11:31:43] [config] mini-batch-fit-step: 10
[2023-07-28 11:31:43] [config] mini-batch-round-up: true
[2023-07-28 11:31:43] [config] mini-batch-track-lr: false
[2023-07-28 11:31:43] [config] mini-batch-warmup: 0
[2023-07-28 11:31:43] [config] mini-batch-words: 0
[2023-07-28 11:31:43] [config] mini-batch-words-ref: 0
[2023-07-28 11:31:43] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:31:43] [config] multi-loss-type: sum
[2023-07-28 11:31:43] [config] n-best: false
[2023-07-28 11:31:43] [config] no-nccl: false
[2023-07-28 11:31:43] [config] no-reload: false
[2023-07-28 11:31:43] [config] no-restore-corpus: false
[2023-07-28 11:31:43] [config] normalize: 0
[2023-07-28 11:31:43] [config] normalize-gradient: false
[2023-07-28 11:31:43] [config] num-devices: 0
[2023-07-28 11:31:43] [config] optimizer: adam
[2023-07-28 11:31:43] [config] optimizer-delay: 1
[2023-07-28 11:31:43] [config] optimizer-params:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] output-omit-bias: false
[2023-07-28 11:31:43] [config] overwrite: true
[2023-07-28 11:31:43] [config] precision:
[2023-07-28 11:31:43] [config]   - float16
[2023-07-28 11:31:43] [config]   - float32
[2023-07-28 11:31:43] [config] pretrained-model: ""
[2023-07-28 11:31:43] [config] quantize-biases: false
[2023-07-28 11:31:43] [config] quantize-bits: 0
[2023-07-28 11:31:43] [config] quantize-log-based: false
[2023-07-28 11:31:43] [config] quantize-optimization-steps: 0
[2023-07-28 11:31:43] [config] quiet: false
[2023-07-28 11:31:43] [config] quiet-translation: true
[2023-07-28 11:31:43] [config] relative-paths: false
[2023-07-28 11:31:43] [config] right-left: false
[2023-07-28 11:31:43] [config] save-freq: 10000u
[2023-07-28 11:31:43] [config] seed: 1234
[2023-07-28 11:31:43] [config] sentencepiece-alphas:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] sentencepiece-max-lines: 2000000
[2023-07-28 11:31:43] [config] sentencepiece-options: ""
[2023-07-28 11:31:43] [config] sharding: global
[2023-07-28 11:31:43] [config] shuffle: data
[2023-07-28 11:31:43] [config] shuffle-in-ram: false
[2023-07-28 11:31:43] [config] sigterm: save-and-exit
[2023-07-28 11:31:43] [config] skip: false
[2023-07-28 11:31:43] [config] sqlite: ""
[2023-07-28 11:31:43] [config] sqlite-drop: false
[2023-07-28 11:31:43] [config] sync-freq: 200u
[2023-07-28 11:31:43] [config] sync-sgd: false
[2023-07-28 11:31:43] [config] tempdir: /tmp
[2023-07-28 11:31:43] [config] tied-embeddings: false
[2023-07-28 11:31:43] [config] tied-embeddings-all: true
[2023-07-28 11:31:43] [config] tied-embeddings-src: false
[2023-07-28 11:31:43] [config] train-embedder-rank:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] train-sets:
[2023-07-28 11:31:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 11:31:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 11:31:43] [config] transformer-aan-activation: swish
[2023-07-28 11:31:43] [config] transformer-aan-depth: 2
[2023-07-28 11:31:43] [config] transformer-aan-nogate: false
[2023-07-28 11:31:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 11:31:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 11:31:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 11:31:43] [config] transformer-depth-scaling: false
[2023-07-28 11:31:43] [config] transformer-dim-aan: 2048
[2023-07-28 11:31:43] [config] transformer-dim-ffn: 2048
[2023-07-28 11:31:43] [config] transformer-dropout: 0
[2023-07-28 11:31:43] [config] transformer-dropout-attention: 0
[2023-07-28 11:31:43] [config] transformer-dropout-ffn: 0
[2023-07-28 11:31:43] [config] transformer-ffn-activation: swish
[2023-07-28 11:31:43] [config] transformer-ffn-depth: 2
[2023-07-28 11:31:43] [config] transformer-guided-alignment-layer: last
[2023-07-28 11:31:43] [config] transformer-heads: 8
[2023-07-28 11:31:43] [config] transformer-no-projection: false
[2023-07-28 11:31:43] [config] transformer-pool: false
[2023-07-28 11:31:43] [config] transformer-postprocess: dan
[2023-07-28 11:31:43] [config] transformer-postprocess-emb: d
[2023-07-28 11:31:43] [config] transformer-postprocess-top: ""
[2023-07-28 11:31:43] [config] transformer-preprocess: ""
[2023-07-28 11:31:43] [config] transformer-tied-layers:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] transformer-train-position-embeddings: false
[2023-07-28 11:31:43] [config] tsv: false
[2023-07-28 11:31:43] [config] tsv-fields: 0
[2023-07-28 11:31:43] [config] type: s2s
[2023-07-28 11:31:43] [config] ulr: false
[2023-07-28 11:31:43] [config] ulr-dim-emb: 0
[2023-07-28 11:31:43] [config] ulr-dropout: 0
[2023-07-28 11:31:43] [config] ulr-keys-vectors: ""
[2023-07-28 11:31:43] [config] ulr-query-vectors: ""
[2023-07-28 11:31:43] [config] ulr-softmax-temperature: 1
[2023-07-28 11:31:43] [config] ulr-trainable-transformation: false
[2023-07-28 11:31:43] [config] unlikelihood-loss: false
[2023-07-28 11:31:43] [config] valid-freq: 50000000
[2023-07-28 11:31:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 11:31:43] [config] valid-max-length: 1000
[2023-07-28 11:31:43] [config] valid-metrics:
[2023-07-28 11:31:43] [config]   - translation
[2023-07-28 11:31:43] [config] valid-mini-batch: 32
[2023-07-28 11:31:43] [config] valid-reset-stalled: false
[2023-07-28 11:31:43] [config] valid-script-args:
[2023-07-28 11:31:43] [config]   []
[2023-07-28 11:31:43] [config] valid-script-path: ""
[2023-07-28 11:31:43] [config] valid-sets:
[2023-07-28 11:31:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 11:31:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 11:31:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 11:31:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:31:43] [config] vocabs:
[2023-07-28 11:31:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:31:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:31:43] [config] word-penalty: 0
[2023-07-28 11:31:43] [config] word-scores: false
[2023-07-28 11:31:43] [config] workspace: 5500
[2023-07-28 11:31:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:31:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:31:43] [training] Using single-device training
[2023-07-28 11:31:44] Synced seed 1234
[2023-07-28 11:31:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:31:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 11:31:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:31:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 11:31:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 11:31:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:31:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 11:31:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:31:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:31:44] [comm] Using global sharding
[2023-07-28 11:31:44] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:31:44] [training] Using 1 GPUs
[2023-07-28 11:31:44] [logits] Applying loss function for 1 factor(s)
[2023-07-28 11:31:44] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:31:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 11:31:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:36:13] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 11:36:13] [valid] No post-processing script given for validating translator
[2023-07-28 11:36:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:36:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:36:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:36:13] [comm] Using global sharding
[2023-07-28 11:36:13] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:36:13] [training] Using 1 GPUs
[2023-07-28 11:36:13] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:36:15] Allocating memory for general optimizer shards
[2023-07-28 11:36:15] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:36:15] Loading Adam parameters
[2023-07-28 11:36:15] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:36:15] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:36:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 11:36:15] [data] Restoring the corpus state to epoch 391, batch 10660
[2023-07-28 11:36:15] [data] Shuffling data
[2023-07-28 11:36:15] [data] Done reading 20,192 sentences
[2023-07-28 11:36:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:36:15] Training started
[2023-07-28 11:36:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 11:36:16] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:36:19] Parameter type float16, optimization type float32, casting types true
[2023-07-28 11:37:23] Seen 20,192 samples
[2023-07-28 11:37:23] Starting data epoch 392 in logical epoch 392
[2023-07-28 11:37:23] [data] Shuffling data
[2023-07-28 11:37:23] [data] Done reading 20,192 sentences
[2023-07-28 11:37:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:38:33] Seen 20,192 samples
[2023-07-28 11:38:33] Starting data epoch 393 in logical epoch 393
[2023-07-28 11:38:33] [data] Shuffling data
[2023-07-28 11:38:33] [data] Done reading 20,192 sentences
[2023-07-28 11:38:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:39:43] Seen 20,192 samples
[2023-07-28 11:39:43] Starting data epoch 394 in logical epoch 394
[2023-07-28 11:39:43] [data] Shuffling data
[2023-07-28 11:39:43] [data] Done reading 20,192 sentences
[2023-07-28 11:39:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:40:56] Seen 20,192 samples
[2023-07-28 11:40:56] Starting data epoch 395 in logical epoch 395
[2023-07-28 11:40:56] [data] Shuffling data
[2023-07-28 11:40:56] [data] Done reading 20,192 sentences
[2023-07-28 11:40:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:42:06] Seen 20,192 samples
[2023-07-28 11:42:06] Starting data epoch 396 in logical epoch 396
[2023-07-28 11:42:06] [data] Shuffling data
[2023-07-28 11:42:06] [data] Done reading 20,192 sentences
[2023-07-28 11:42:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:43:17] Seen 20,192 samples
[2023-07-28 11:43:17] Starting data epoch 397 in logical epoch 397
[2023-07-28 11:43:17] [data] Shuffling data
[2023-07-28 11:43:17] [data] Done reading 20,192 sentences
[2023-07-28 11:43:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:44:28] Seen 20,192 samples
[2023-07-28 11:44:28] Starting data epoch 398 in logical epoch 398
[2023-07-28 11:44:28] [data] Shuffling data
[2023-07-28 11:44:28] [data] Done reading 20,192 sentences
[2023-07-28 11:44:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:45:43] Seen 20,192 samples
[2023-07-28 11:45:43] Starting data epoch 399 in logical epoch 399
[2023-07-28 11:45:43] [data] Shuffling data
[2023-07-28 11:45:43] [data] Done reading 20,192 sentences
[2023-07-28 11:45:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:46:57] Seen 20,192 samples
[2023-07-28 11:46:57] Starting data epoch 400 in logical epoch 400
[2023-07-28 11:46:57] [data] Shuffling data
[2023-07-28 11:46:57] [data] Done reading 20,192 sentences
[2023-07-28 11:46:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:48:11] Seen 20,192 samples
[2023-07-28 11:48:11] Starting data epoch 401 in logical epoch 401
[2023-07-28 11:48:11] Training finished
[2023-07-28 11:48:51] [valid] Ep. 401 : Up. 10936 : translation : 0 : new best
[2023-07-28 11:48:51] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:48:53] Saving Adam parameters
[2023-07-28 11:48:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 11:49:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:49:01] [marian] Running on node05.datos.cluster.uy as process 2903 with command line:
[2023-07-28 11:49:01] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 410 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 11:49:01] [config] after: 0e
[2023-07-28 11:49:01] [config] after-batches: 0
[2023-07-28 11:49:01] [config] after-epochs: 410
[2023-07-28 11:49:01] [config] all-caps-every: 0
[2023-07-28 11:49:01] [config] allow-unk: false
[2023-07-28 11:49:01] [config] authors: false
[2023-07-28 11:49:01] [config] beam-size: 12
[2023-07-28 11:49:01] [config] bert-class-symbol: "[CLS]"
[2023-07-28 11:49:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 11:49:01] [config] bert-masking-fraction: 0.15
[2023-07-28 11:49:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 11:49:01] [config] bert-train-type-embeddings: true
[2023-07-28 11:49:01] [config] bert-type-vocab-size: 2
[2023-07-28 11:49:01] [config] build-info: ""
[2023-07-28 11:49:01] [config] check-gradient-nan: false
[2023-07-28 11:49:01] [config] check-nan: false
[2023-07-28 11:49:01] [config] cite: false
[2023-07-28 11:49:01] [config] clip-norm: 1
[2023-07-28 11:49:01] [config] cost-scaling:
[2023-07-28 11:49:01] [config]   - 256.f
[2023-07-28 11:49:01] [config]   - 1000
[2023-07-28 11:49:01] [config]   - 2.f
[2023-07-28 11:49:01] [config]   - 256.f
[2023-07-28 11:49:01] [config] cost-type: ce-sum
[2023-07-28 11:49:01] [config] cpu-threads: 0
[2023-07-28 11:49:01] [config] data-threads: 8
[2023-07-28 11:49:01] [config] data-weighting: ""
[2023-07-28 11:49:01] [config] data-weighting-type: sentence
[2023-07-28 11:49:01] [config] dec-cell: gru
[2023-07-28 11:49:01] [config] dec-cell-base-depth: 2
[2023-07-28 11:49:01] [config] dec-cell-high-depth: 1
[2023-07-28 11:49:01] [config] dec-depth: 1
[2023-07-28 11:49:01] [config] devices:
[2023-07-28 11:49:01] [config]   - 0
[2023-07-28 11:49:01] [config] dim-emb: 512
[2023-07-28 11:49:01] [config] dim-rnn: 1024
[2023-07-28 11:49:01] [config] dim-vocabs:
[2023-07-28 11:49:01] [config]   - 16384
[2023-07-28 11:49:01] [config]   - 16384
[2023-07-28 11:49:01] [config] disp-first: 0
[2023-07-28 11:49:01] [config] disp-freq: 1000u
[2023-07-28 11:49:01] [config] disp-label-counts: true
[2023-07-28 11:49:01] [config] dropout-rnn: 0
[2023-07-28 11:49:01] [config] dropout-src: 0
[2023-07-28 11:49:01] [config] dropout-trg: 0
[2023-07-28 11:49:01] [config] dump-config: ""
[2023-07-28 11:49:01] [config] dynamic-gradient-scaling:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] early-stopping: 1000
[2023-07-28 11:49:01] [config] early-stopping-on: first
[2023-07-28 11:49:01] [config] embedding-fix-src: false
[2023-07-28 11:49:01] [config] embedding-fix-trg: false
[2023-07-28 11:49:01] [config] embedding-normalization: false
[2023-07-28 11:49:01] [config] embedding-vectors:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] enc-cell: gru
[2023-07-28 11:49:01] [config] enc-cell-depth: 1
[2023-07-28 11:49:01] [config] enc-depth: 1
[2023-07-28 11:49:01] [config] enc-type: bidirectional
[2023-07-28 11:49:01] [config] english-title-case-every: 0
[2023-07-28 11:49:01] [config] exponential-smoothing: 0
[2023-07-28 11:49:01] [config] factor-weight: 1
[2023-07-28 11:49:01] [config] factors-combine: sum
[2023-07-28 11:49:01] [config] factors-dim-emb: 0
[2023-07-28 11:49:01] [config] gradient-checkpointing: false
[2023-07-28 11:49:01] [config] gradient-norm-average-window: 100
[2023-07-28 11:49:01] [config] guided-alignment: none
[2023-07-28 11:49:01] [config] guided-alignment-cost: mse
[2023-07-28 11:49:01] [config] guided-alignment-weight: 0.1
[2023-07-28 11:49:01] [config] ignore-model-config: false
[2023-07-28 11:49:01] [config] input-types:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] interpolate-env-vars: false
[2023-07-28 11:49:01] [config] keep-best: false
[2023-07-28 11:49:01] [config] label-smoothing: 0
[2023-07-28 11:49:01] [config] layer-normalization: false
[2023-07-28 11:49:01] [config] learn-rate: 0.0001
[2023-07-28 11:49:01] [config] lemma-dependency: ""
[2023-07-28 11:49:01] [config] lemma-dim-emb: 0
[2023-07-28 11:49:01] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 11:49:01] [config] log-level: info
[2023-07-28 11:49:01] [config] log-time-zone: ""
[2023-07-28 11:49:01] [config] logical-epoch:
[2023-07-28 11:49:01] [config]   - 1e
[2023-07-28 11:49:01] [config]   - 0
[2023-07-28 11:49:01] [config] lr-decay: 0
[2023-07-28 11:49:01] [config] lr-decay-freq: 50000
[2023-07-28 11:49:01] [config] lr-decay-inv-sqrt:
[2023-07-28 11:49:01] [config]   - 0
[2023-07-28 11:49:01] [config] lr-decay-repeat-warmup: false
[2023-07-28 11:49:01] [config] lr-decay-reset-optimizer: false
[2023-07-28 11:49:01] [config] lr-decay-start:
[2023-07-28 11:49:01] [config]   - 10
[2023-07-28 11:49:01] [config]   - 1
[2023-07-28 11:49:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 11:49:01] [config] lr-report: false
[2023-07-28 11:49:01] [config] lr-warmup: 0
[2023-07-28 11:49:01] [config] lr-warmup-at-reload: false
[2023-07-28 11:49:01] [config] lr-warmup-cycle: false
[2023-07-28 11:49:01] [config] lr-warmup-start-rate: 0
[2023-07-28 11:49:01] [config] max-length: 50
[2023-07-28 11:49:01] [config] max-length-crop: true
[2023-07-28 11:49:01] [config] max-length-factor: 3
[2023-07-28 11:49:01] [config] maxi-batch: 100
[2023-07-28 11:49:01] [config] maxi-batch-sort: trg
[2023-07-28 11:49:01] [config] mini-batch: 64
[2023-07-28 11:49:01] [config] mini-batch-fit: true
[2023-07-28 11:49:01] [config] mini-batch-fit-step: 10
[2023-07-28 11:49:01] [config] mini-batch-round-up: true
[2023-07-28 11:49:01] [config] mini-batch-track-lr: false
[2023-07-28 11:49:01] [config] mini-batch-warmup: 0
[2023-07-28 11:49:01] [config] mini-batch-words: 0
[2023-07-28 11:49:01] [config] mini-batch-words-ref: 0
[2023-07-28 11:49:01] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:49:01] [config] multi-loss-type: sum
[2023-07-28 11:49:01] [config] n-best: false
[2023-07-28 11:49:01] [config] no-nccl: false
[2023-07-28 11:49:01] [config] no-reload: false
[2023-07-28 11:49:01] [config] no-restore-corpus: false
[2023-07-28 11:49:01] [config] normalize: 0
[2023-07-28 11:49:01] [config] normalize-gradient: false
[2023-07-28 11:49:01] [config] num-devices: 0
[2023-07-28 11:49:01] [config] optimizer: adam
[2023-07-28 11:49:01] [config] optimizer-delay: 1
[2023-07-28 11:49:01] [config] optimizer-params:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] output-omit-bias: false
[2023-07-28 11:49:01] [config] overwrite: true
[2023-07-28 11:49:01] [config] precision:
[2023-07-28 11:49:01] [config]   - float16
[2023-07-28 11:49:01] [config]   - float32
[2023-07-28 11:49:01] [config] pretrained-model: ""
[2023-07-28 11:49:01] [config] quantize-biases: false
[2023-07-28 11:49:01] [config] quantize-bits: 0
[2023-07-28 11:49:01] [config] quantize-log-based: false
[2023-07-28 11:49:01] [config] quantize-optimization-steps: 0
[2023-07-28 11:49:01] [config] quiet: false
[2023-07-28 11:49:01] [config] quiet-translation: true
[2023-07-28 11:49:01] [config] relative-paths: false
[2023-07-28 11:49:01] [config] right-left: false
[2023-07-28 11:49:01] [config] save-freq: 10000u
[2023-07-28 11:49:01] [config] seed: 1234
[2023-07-28 11:49:01] [config] sentencepiece-alphas:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] sentencepiece-max-lines: 2000000
[2023-07-28 11:49:01] [config] sentencepiece-options: ""
[2023-07-28 11:49:01] [config] sharding: global
[2023-07-28 11:49:01] [config] shuffle: data
[2023-07-28 11:49:01] [config] shuffle-in-ram: false
[2023-07-28 11:49:01] [config] sigterm: save-and-exit
[2023-07-28 11:49:01] [config] skip: false
[2023-07-28 11:49:01] [config] sqlite: ""
[2023-07-28 11:49:01] [config] sqlite-drop: false
[2023-07-28 11:49:01] [config] sync-freq: 200u
[2023-07-28 11:49:01] [config] sync-sgd: false
[2023-07-28 11:49:01] [config] tempdir: /tmp
[2023-07-28 11:49:01] [config] tied-embeddings: false
[2023-07-28 11:49:01] [config] tied-embeddings-all: true
[2023-07-28 11:49:01] [config] tied-embeddings-src: false
[2023-07-28 11:49:01] [config] train-embedder-rank:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] train-sets:
[2023-07-28 11:49:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 11:49:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 11:49:01] [config] transformer-aan-activation: swish
[2023-07-28 11:49:01] [config] transformer-aan-depth: 2
[2023-07-28 11:49:01] [config] transformer-aan-nogate: false
[2023-07-28 11:49:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 11:49:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 11:49:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 11:49:01] [config] transformer-depth-scaling: false
[2023-07-28 11:49:01] [config] transformer-dim-aan: 2048
[2023-07-28 11:49:01] [config] transformer-dim-ffn: 2048
[2023-07-28 11:49:01] [config] transformer-dropout: 0
[2023-07-28 11:49:01] [config] transformer-dropout-attention: 0
[2023-07-28 11:49:01] [config] transformer-dropout-ffn: 0
[2023-07-28 11:49:01] [config] transformer-ffn-activation: swish
[2023-07-28 11:49:01] [config] transformer-ffn-depth: 2
[2023-07-28 11:49:01] [config] transformer-guided-alignment-layer: last
[2023-07-28 11:49:01] [config] transformer-heads: 8
[2023-07-28 11:49:01] [config] transformer-no-projection: false
[2023-07-28 11:49:01] [config] transformer-pool: false
[2023-07-28 11:49:01] [config] transformer-postprocess: dan
[2023-07-28 11:49:01] [config] transformer-postprocess-emb: d
[2023-07-28 11:49:01] [config] transformer-postprocess-top: ""
[2023-07-28 11:49:01] [config] transformer-preprocess: ""
[2023-07-28 11:49:01] [config] transformer-tied-layers:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] transformer-train-position-embeddings: false
[2023-07-28 11:49:01] [config] tsv: false
[2023-07-28 11:49:01] [config] tsv-fields: 0
[2023-07-28 11:49:01] [config] type: s2s
[2023-07-28 11:49:01] [config] ulr: false
[2023-07-28 11:49:01] [config] ulr-dim-emb: 0
[2023-07-28 11:49:01] [config] ulr-dropout: 0
[2023-07-28 11:49:01] [config] ulr-keys-vectors: ""
[2023-07-28 11:49:01] [config] ulr-query-vectors: ""
[2023-07-28 11:49:01] [config] ulr-softmax-temperature: 1
[2023-07-28 11:49:01] [config] ulr-trainable-transformation: false
[2023-07-28 11:49:01] [config] unlikelihood-loss: false
[2023-07-28 11:49:01] [config] valid-freq: 50000000
[2023-07-28 11:49:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 11:49:01] [config] valid-max-length: 1000
[2023-07-28 11:49:01] [config] valid-metrics:
[2023-07-28 11:49:01] [config]   - translation
[2023-07-28 11:49:01] [config] valid-mini-batch: 32
[2023-07-28 11:49:01] [config] valid-reset-stalled: false
[2023-07-28 11:49:01] [config] valid-script-args:
[2023-07-28 11:49:01] [config]   []
[2023-07-28 11:49:01] [config] valid-script-path: ""
[2023-07-28 11:49:01] [config] valid-sets:
[2023-07-28 11:49:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 11:49:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 11:49:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 11:49:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:49:01] [config] vocabs:
[2023-07-28 11:49:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:49:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:49:01] [config] word-penalty: 0
[2023-07-28 11:49:01] [config] word-scores: false
[2023-07-28 11:49:01] [config] workspace: 5500
[2023-07-28 11:49:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:49:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:49:01] [training] Using single-device training
[2023-07-28 11:49:01] Synced seed 1234
[2023-07-28 11:49:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:49:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 11:49:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:49:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 11:49:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 11:49:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:49:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 11:49:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:49:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:49:02] [comm] Using global sharding
[2023-07-28 11:49:02] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:49:02] [training] Using 1 GPUs
[2023-07-28 11:49:02] [logits] Applying loss function for 1 factor(s)
[2023-07-28 11:49:02] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:49:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 11:49:02] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:53:30] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 11:53:31] [valid] No post-processing script given for validating translator
[2023-07-28 11:53:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:53:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:53:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:53:31] [comm] Using global sharding
[2023-07-28 11:53:31] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:53:31] [training] Using 1 GPUs
[2023-07-28 11:53:31] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 11:53:32] Allocating memory for general optimizer shards
[2023-07-28 11:53:32] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:53:32] Loading Adam parameters
[2023-07-28 11:53:32] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:53:32] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:53:32] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 11:53:32] [data] Restoring the corpus state to epoch 401, batch 10936
[2023-07-28 11:53:32] [data] Shuffling data
[2023-07-28 11:53:32] [data] Done reading 20,192 sentences
[2023-07-28 11:53:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:53:33] Training started
[2023-07-28 11:53:33] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 11:53:33] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:53:37] Parameter type float16, optimization type float32, casting types true
[2023-07-28 11:54:41] Seen 20,192 samples
[2023-07-28 11:54:41] Starting data epoch 402 in logical epoch 402
[2023-07-28 11:54:41] [data] Shuffling data
[2023-07-28 11:54:41] [data] Done reading 20,192 sentences
[2023-07-28 11:54:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:55:50] Seen 20,192 samples
[2023-07-28 11:55:50] Starting data epoch 403 in logical epoch 403
[2023-07-28 11:55:50] [data] Shuffling data
[2023-07-28 11:55:50] [data] Done reading 20,192 sentences
[2023-07-28 11:55:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:56:14] Ep. 403 : Up. 11000 : Sen. 7,121 : Cost 1.85898304 * 20,702,554 @ 15,206 after 228,170,918 : Time 163.26s : 126808.50 words/s : gNorm 1.9931
[2023-07-28 11:57:01] Seen 20,192 samples
[2023-07-28 11:57:01] Starting data epoch 404 in logical epoch 404
[2023-07-28 11:57:01] [data] Shuffling data
[2023-07-28 11:57:01] [data] Done reading 20,192 sentences
[2023-07-28 11:57:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:58:14] Seen 20,192 samples
[2023-07-28 11:58:14] Starting data epoch 405 in logical epoch 405
[2023-07-28 11:58:14] [data] Shuffling data
[2023-07-28 11:58:14] [data] Done reading 20,192 sentences
[2023-07-28 11:58:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:59:26] Seen 20,192 samples
[2023-07-28 11:59:26] Starting data epoch 406 in logical epoch 406
[2023-07-28 11:59:26] [data] Shuffling data
[2023-07-28 11:59:26] [data] Done reading 20,192 sentences
[2023-07-28 11:59:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:00:36] Seen 20,192 samples
[2023-07-28 12:00:36] Starting data epoch 407 in logical epoch 407
[2023-07-28 12:00:36] [data] Shuffling data
[2023-07-28 12:00:36] [data] Done reading 20,192 sentences
[2023-07-28 12:00:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:01:47] Seen 20,192 samples
[2023-07-28 12:01:47] Starting data epoch 408 in logical epoch 408
[2023-07-28 12:01:47] [data] Shuffling data
[2023-07-28 12:01:47] [data] Done reading 20,192 sentences
[2023-07-28 12:01:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:02:57] Seen 20,192 samples
[2023-07-28 12:02:57] Starting data epoch 409 in logical epoch 409
[2023-07-28 12:02:57] [data] Shuffling data
[2023-07-28 12:02:57] [data] Done reading 20,192 sentences
[2023-07-28 12:02:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:04:09] Seen 20,192 samples
[2023-07-28 12:04:09] Starting data epoch 410 in logical epoch 410
[2023-07-28 12:04:09] [data] Shuffling data
[2023-07-28 12:04:09] [data] Done reading 20,192 sentences
[2023-07-28 12:04:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:05:20] Seen 20,192 samples
[2023-07-28 12:05:20] Starting data epoch 411 in logical epoch 411
[2023-07-28 12:05:20] Training finished
[2023-07-28 12:06:03] [valid] Ep. 411 : Up. 11207 : translation : 0 : new best
[2023-07-28 12:06:03] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 12:06:09] Saving Adam parameters
[2023-07-28 12:06:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 12:06:17] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:06:17] [marian] Running on node05.datos.cluster.uy as process 4197 with command line:
[2023-07-28 12:06:17] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 420 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 12:06:17] [config] after: 0e
[2023-07-28 12:06:17] [config] after-batches: 0
[2023-07-28 12:06:17] [config] after-epochs: 420
[2023-07-28 12:06:17] [config] all-caps-every: 0
[2023-07-28 12:06:17] [config] allow-unk: false
[2023-07-28 12:06:17] [config] authors: false
[2023-07-28 12:06:17] [config] beam-size: 12
[2023-07-28 12:06:17] [config] bert-class-symbol: "[CLS]"
[2023-07-28 12:06:17] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 12:06:17] [config] bert-masking-fraction: 0.15
[2023-07-28 12:06:17] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 12:06:17] [config] bert-train-type-embeddings: true
[2023-07-28 12:06:17] [config] bert-type-vocab-size: 2
[2023-07-28 12:06:17] [config] build-info: ""
[2023-07-28 12:06:17] [config] check-gradient-nan: false
[2023-07-28 12:06:17] [config] check-nan: false
[2023-07-28 12:06:17] [config] cite: false
[2023-07-28 12:06:17] [config] clip-norm: 1
[2023-07-28 12:06:17] [config] cost-scaling:
[2023-07-28 12:06:17] [config]   - 256.f
[2023-07-28 12:06:17] [config]   - 1000
[2023-07-28 12:06:17] [config]   - 2.f
[2023-07-28 12:06:17] [config]   - 256.f
[2023-07-28 12:06:17] [config] cost-type: ce-sum
[2023-07-28 12:06:17] [config] cpu-threads: 0
[2023-07-28 12:06:17] [config] data-threads: 8
[2023-07-28 12:06:17] [config] data-weighting: ""
[2023-07-28 12:06:17] [config] data-weighting-type: sentence
[2023-07-28 12:06:17] [config] dec-cell: gru
[2023-07-28 12:06:17] [config] dec-cell-base-depth: 2
[2023-07-28 12:06:17] [config] dec-cell-high-depth: 1
[2023-07-28 12:06:17] [config] dec-depth: 1
[2023-07-28 12:06:17] [config] devices:
[2023-07-28 12:06:17] [config]   - 0
[2023-07-28 12:06:17] [config] dim-emb: 512
[2023-07-28 12:06:17] [config] dim-rnn: 1024
[2023-07-28 12:06:17] [config] dim-vocabs:
[2023-07-28 12:06:17] [config]   - 16384
[2023-07-28 12:06:17] [config]   - 16384
[2023-07-28 12:06:17] [config] disp-first: 0
[2023-07-28 12:06:17] [config] disp-freq: 1000u
[2023-07-28 12:06:17] [config] disp-label-counts: true
[2023-07-28 12:06:17] [config] dropout-rnn: 0
[2023-07-28 12:06:17] [config] dropout-src: 0
[2023-07-28 12:06:17] [config] dropout-trg: 0
[2023-07-28 12:06:17] [config] dump-config: ""
[2023-07-28 12:06:17] [config] dynamic-gradient-scaling:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] early-stopping: 1000
[2023-07-28 12:06:17] [config] early-stopping-on: first
[2023-07-28 12:06:17] [config] embedding-fix-src: false
[2023-07-28 12:06:17] [config] embedding-fix-trg: false
[2023-07-28 12:06:17] [config] embedding-normalization: false
[2023-07-28 12:06:17] [config] embedding-vectors:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] enc-cell: gru
[2023-07-28 12:06:17] [config] enc-cell-depth: 1
[2023-07-28 12:06:17] [config] enc-depth: 1
[2023-07-28 12:06:17] [config] enc-type: bidirectional
[2023-07-28 12:06:17] [config] english-title-case-every: 0
[2023-07-28 12:06:17] [config] exponential-smoothing: 0
[2023-07-28 12:06:17] [config] factor-weight: 1
[2023-07-28 12:06:17] [config] factors-combine: sum
[2023-07-28 12:06:17] [config] factors-dim-emb: 0
[2023-07-28 12:06:17] [config] gradient-checkpointing: false
[2023-07-28 12:06:17] [config] gradient-norm-average-window: 100
[2023-07-28 12:06:17] [config] guided-alignment: none
[2023-07-28 12:06:17] [config] guided-alignment-cost: mse
[2023-07-28 12:06:17] [config] guided-alignment-weight: 0.1
[2023-07-28 12:06:17] [config] ignore-model-config: false
[2023-07-28 12:06:17] [config] input-types:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] interpolate-env-vars: false
[2023-07-28 12:06:17] [config] keep-best: false
[2023-07-28 12:06:17] [config] label-smoothing: 0
[2023-07-28 12:06:17] [config] layer-normalization: false
[2023-07-28 12:06:17] [config] learn-rate: 0.0001
[2023-07-28 12:06:17] [config] lemma-dependency: ""
[2023-07-28 12:06:17] [config] lemma-dim-emb: 0
[2023-07-28 12:06:17] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 12:06:17] [config] log-level: info
[2023-07-28 12:06:17] [config] log-time-zone: ""
[2023-07-28 12:06:17] [config] logical-epoch:
[2023-07-28 12:06:17] [config]   - 1e
[2023-07-28 12:06:17] [config]   - 0
[2023-07-28 12:06:17] [config] lr-decay: 0
[2023-07-28 12:06:17] [config] lr-decay-freq: 50000
[2023-07-28 12:06:17] [config] lr-decay-inv-sqrt:
[2023-07-28 12:06:17] [config]   - 0
[2023-07-28 12:06:17] [config] lr-decay-repeat-warmup: false
[2023-07-28 12:06:17] [config] lr-decay-reset-optimizer: false
[2023-07-28 12:06:17] [config] lr-decay-start:
[2023-07-28 12:06:17] [config]   - 10
[2023-07-28 12:06:17] [config]   - 1
[2023-07-28 12:06:17] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 12:06:17] [config] lr-report: false
[2023-07-28 12:06:17] [config] lr-warmup: 0
[2023-07-28 12:06:17] [config] lr-warmup-at-reload: false
[2023-07-28 12:06:17] [config] lr-warmup-cycle: false
[2023-07-28 12:06:17] [config] lr-warmup-start-rate: 0
[2023-07-28 12:06:17] [config] max-length: 50
[2023-07-28 12:06:17] [config] max-length-crop: true
[2023-07-28 12:06:17] [config] max-length-factor: 3
[2023-07-28 12:06:17] [config] maxi-batch: 100
[2023-07-28 12:06:17] [config] maxi-batch-sort: trg
[2023-07-28 12:06:17] [config] mini-batch: 64
[2023-07-28 12:06:17] [config] mini-batch-fit: true
[2023-07-28 12:06:17] [config] mini-batch-fit-step: 10
[2023-07-28 12:06:17] [config] mini-batch-round-up: true
[2023-07-28 12:06:17] [config] mini-batch-track-lr: false
[2023-07-28 12:06:17] [config] mini-batch-warmup: 0
[2023-07-28 12:06:17] [config] mini-batch-words: 0
[2023-07-28 12:06:17] [config] mini-batch-words-ref: 0
[2023-07-28 12:06:17] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 12:06:17] [config] multi-loss-type: sum
[2023-07-28 12:06:17] [config] n-best: false
[2023-07-28 12:06:17] [config] no-nccl: false
[2023-07-28 12:06:17] [config] no-reload: false
[2023-07-28 12:06:17] [config] no-restore-corpus: false
[2023-07-28 12:06:17] [config] normalize: 0
[2023-07-28 12:06:17] [config] normalize-gradient: false
[2023-07-28 12:06:17] [config] num-devices: 0
[2023-07-28 12:06:17] [config] optimizer: adam
[2023-07-28 12:06:17] [config] optimizer-delay: 1
[2023-07-28 12:06:17] [config] optimizer-params:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] output-omit-bias: false
[2023-07-28 12:06:17] [config] overwrite: true
[2023-07-28 12:06:17] [config] precision:
[2023-07-28 12:06:17] [config]   - float16
[2023-07-28 12:06:17] [config]   - float32
[2023-07-28 12:06:17] [config] pretrained-model: ""
[2023-07-28 12:06:17] [config] quantize-biases: false
[2023-07-28 12:06:17] [config] quantize-bits: 0
[2023-07-28 12:06:17] [config] quantize-log-based: false
[2023-07-28 12:06:17] [config] quantize-optimization-steps: 0
[2023-07-28 12:06:17] [config] quiet: false
[2023-07-28 12:06:17] [config] quiet-translation: true
[2023-07-28 12:06:17] [config] relative-paths: false
[2023-07-28 12:06:17] [config] right-left: false
[2023-07-28 12:06:17] [config] save-freq: 10000u
[2023-07-28 12:06:17] [config] seed: 1234
[2023-07-28 12:06:17] [config] sentencepiece-alphas:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] sentencepiece-max-lines: 2000000
[2023-07-28 12:06:17] [config] sentencepiece-options: ""
[2023-07-28 12:06:17] [config] sharding: global
[2023-07-28 12:06:17] [config] shuffle: data
[2023-07-28 12:06:17] [config] shuffle-in-ram: false
[2023-07-28 12:06:17] [config] sigterm: save-and-exit
[2023-07-28 12:06:17] [config] skip: false
[2023-07-28 12:06:17] [config] sqlite: ""
[2023-07-28 12:06:17] [config] sqlite-drop: false
[2023-07-28 12:06:17] [config] sync-freq: 200u
[2023-07-28 12:06:17] [config] sync-sgd: false
[2023-07-28 12:06:17] [config] tempdir: /tmp
[2023-07-28 12:06:17] [config] tied-embeddings: false
[2023-07-28 12:06:17] [config] tied-embeddings-all: true
[2023-07-28 12:06:17] [config] tied-embeddings-src: false
[2023-07-28 12:06:17] [config] train-embedder-rank:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] train-sets:
[2023-07-28 12:06:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 12:06:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 12:06:17] [config] transformer-aan-activation: swish
[2023-07-28 12:06:17] [config] transformer-aan-depth: 2
[2023-07-28 12:06:17] [config] transformer-aan-nogate: false
[2023-07-28 12:06:17] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 12:06:17] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 12:06:17] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 12:06:17] [config] transformer-depth-scaling: false
[2023-07-28 12:06:17] [config] transformer-dim-aan: 2048
[2023-07-28 12:06:17] [config] transformer-dim-ffn: 2048
[2023-07-28 12:06:17] [config] transformer-dropout: 0
[2023-07-28 12:06:17] [config] transformer-dropout-attention: 0
[2023-07-28 12:06:17] [config] transformer-dropout-ffn: 0
[2023-07-28 12:06:17] [config] transformer-ffn-activation: swish
[2023-07-28 12:06:17] [config] transformer-ffn-depth: 2
[2023-07-28 12:06:17] [config] transformer-guided-alignment-layer: last
[2023-07-28 12:06:17] [config] transformer-heads: 8
[2023-07-28 12:06:17] [config] transformer-no-projection: false
[2023-07-28 12:06:17] [config] transformer-pool: false
[2023-07-28 12:06:17] [config] transformer-postprocess: dan
[2023-07-28 12:06:17] [config] transformer-postprocess-emb: d
[2023-07-28 12:06:17] [config] transformer-postprocess-top: ""
[2023-07-28 12:06:17] [config] transformer-preprocess: ""
[2023-07-28 12:06:17] [config] transformer-tied-layers:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] transformer-train-position-embeddings: false
[2023-07-28 12:06:17] [config] tsv: false
[2023-07-28 12:06:17] [config] tsv-fields: 0
[2023-07-28 12:06:17] [config] type: s2s
[2023-07-28 12:06:17] [config] ulr: false
[2023-07-28 12:06:17] [config] ulr-dim-emb: 0
[2023-07-28 12:06:17] [config] ulr-dropout: 0
[2023-07-28 12:06:17] [config] ulr-keys-vectors: ""
[2023-07-28 12:06:17] [config] ulr-query-vectors: ""
[2023-07-28 12:06:17] [config] ulr-softmax-temperature: 1
[2023-07-28 12:06:17] [config] ulr-trainable-transformation: false
[2023-07-28 12:06:17] [config] unlikelihood-loss: false
[2023-07-28 12:06:17] [config] valid-freq: 50000000
[2023-07-28 12:06:17] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 12:06:17] [config] valid-max-length: 1000
[2023-07-28 12:06:17] [config] valid-metrics:
[2023-07-28 12:06:17] [config]   - translation
[2023-07-28 12:06:17] [config] valid-mini-batch: 32
[2023-07-28 12:06:17] [config] valid-reset-stalled: false
[2023-07-28 12:06:17] [config] valid-script-args:
[2023-07-28 12:06:17] [config]   []
[2023-07-28 12:06:17] [config] valid-script-path: ""
[2023-07-28 12:06:17] [config] valid-sets:
[2023-07-28 12:06:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 12:06:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 12:06:17] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 12:06:17] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:06:17] [config] vocabs:
[2023-07-28 12:06:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 12:06:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 12:06:17] [config] word-penalty: 0
[2023-07-28 12:06:17] [config] word-scores: false
[2023-07-28 12:06:17] [config] workspace: 5500
[2023-07-28 12:06:17] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:06:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:06:17] [training] Using single-device training
[2023-07-28 12:06:18] Synced seed 1234
[2023-07-28 12:06:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 12:06:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 12:06:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 12:06:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 12:06:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 12:06:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:06:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 12:06:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 12:06:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 12:06:18] [comm] Using global sharding
[2023-07-28 12:06:18] [comm] NCCLCommunicators constructed successfully
[2023-07-28 12:06:18] [training] Using 1 GPUs
[2023-07-28 12:06:18] [logits] Applying loss function for 1 factor(s)
[2023-07-28 12:06:18] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:06:19] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 12:06:19] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:10:47] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 12:10:47] [valid] No post-processing script given for validating translator
[2023-07-28 12:10:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:10:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 12:10:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 12:10:47] [comm] Using global sharding
[2023-07-28 12:10:47] [comm] NCCLCommunicators constructed successfully
[2023-07-28 12:10:47] [training] Using 1 GPUs
[2023-07-28 12:10:47] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 12:10:48] Allocating memory for general optimizer shards
[2023-07-28 12:10:48] [memory] Reserving 322 MB, device gpu0
[2023-07-28 12:10:48] Loading Adam parameters
[2023-07-28 12:10:48] [memory] Reserving 322 MB, device gpu0
[2023-07-28 12:10:48] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:10:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 12:10:49] [data] Restoring the corpus state to epoch 411, batch 11207
[2023-07-28 12:10:49] [data] Shuffling data
[2023-07-28 12:10:49] [data] Done reading 20,192 sentences
[2023-07-28 12:10:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:10:49] Training started
[2023-07-28 12:10:49] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 12:10:49] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:10:51] Parameter type float16, optimization type float32, casting types true
[2023-07-28 12:11:57] Seen 20,192 samples
[2023-07-28 12:11:57] Starting data epoch 412 in logical epoch 412
[2023-07-28 12:11:57] [data] Shuffling data
[2023-07-28 12:11:57] [data] Done reading 20,192 sentences
[2023-07-28 12:11:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:13:07] Seen 20,192 samples
[2023-07-28 12:13:07] Starting data epoch 413 in logical epoch 413
[2023-07-28 12:13:07] [data] Shuffling data
[2023-07-28 12:13:07] [data] Done reading 20,192 sentences
[2023-07-28 12:13:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:14:17] Seen 20,192 samples
[2023-07-28 12:14:17] Starting data epoch 414 in logical epoch 414
[2023-07-28 12:14:17] [data] Shuffling data
[2023-07-28 12:14:17] [data] Done reading 20,192 sentences
[2023-07-28 12:14:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:15:28] Seen 20,192 samples
[2023-07-28 12:15:28] Starting data epoch 415 in logical epoch 415
[2023-07-28 12:15:28] [data] Shuffling data
[2023-07-28 12:15:28] [data] Done reading 20,192 sentences
[2023-07-28 12:15:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:16:40] Seen 20,192 samples
[2023-07-28 12:16:41] Starting data epoch 416 in logical epoch 416
[2023-07-28 12:16:41] [data] Shuffling data
[2023-07-28 12:16:41] [data] Done reading 20,192 sentences
[2023-07-28 12:16:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:17:54] Seen 20,192 samples
[2023-07-28 12:17:54] Starting data epoch 417 in logical epoch 417
[2023-07-28 12:17:54] [data] Shuffling data
[2023-07-28 12:17:54] [data] Done reading 20,192 sentences
[2023-07-28 12:17:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:19:07] Seen 20,192 samples
[2023-07-28 12:19:07] Starting data epoch 418 in logical epoch 418
[2023-07-28 12:19:07] [data] Shuffling data
[2023-07-28 12:19:07] [data] Done reading 20,192 sentences
[2023-07-28 12:19:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:20:18] Seen 20,192 samples
[2023-07-28 12:20:18] Starting data epoch 419 in logical epoch 419
[2023-07-28 12:20:18] [data] Shuffling data
[2023-07-28 12:20:18] [data] Done reading 20,192 sentences
[2023-07-28 12:20:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:21:32] Seen 20,192 samples
[2023-07-28 12:21:33] Starting data epoch 420 in logical epoch 420
[2023-07-28 12:21:33] [data] Shuffling data
[2023-07-28 12:21:33] [data] Done reading 20,192 sentences
[2023-07-28 12:21:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:22:45] Seen 20,192 samples
[2023-07-28 12:22:46] Starting data epoch 421 in logical epoch 421
[2023-07-28 12:22:46] Training finished
[2023-07-28 12:23:29] [valid] Ep. 421 : Up. 11478 : translation : 0 : new best
[2023-07-28 12:23:29] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 12:23:32] Saving Adam parameters
[2023-07-28 12:23:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 12:23:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:23:41] [marian] Running on node05.datos.cluster.uy as process 5489 with command line:
[2023-07-28 12:23:41] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz --after-epochs 430 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.0
[2023-07-28 12:23:41] [config] after: 0e
[2023-07-28 12:23:41] [config] after-batches: 0
[2023-07-28 12:23:41] [config] after-epochs: 430
[2023-07-28 12:23:41] [config] all-caps-every: 0
[2023-07-28 12:23:41] [config] allow-unk: false
[2023-07-28 12:23:41] [config] authors: false
[2023-07-28 12:23:41] [config] beam-size: 12
[2023-07-28 12:23:41] [config] bert-class-symbol: "[CLS]"
[2023-07-28 12:23:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 12:23:41] [config] bert-masking-fraction: 0.15
[2023-07-28 12:23:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 12:23:41] [config] bert-train-type-embeddings: true
[2023-07-28 12:23:41] [config] bert-type-vocab-size: 2
[2023-07-28 12:23:41] [config] build-info: ""
[2023-07-28 12:23:41] [config] check-gradient-nan: false
[2023-07-28 12:23:41] [config] check-nan: false
[2023-07-28 12:23:41] [config] cite: false
[2023-07-28 12:23:41] [config] clip-norm: 1
[2023-07-28 12:23:41] [config] cost-scaling:
[2023-07-28 12:23:41] [config]   - 256.f
[2023-07-28 12:23:41] [config]   - 1000
[2023-07-28 12:23:41] [config]   - 2.f
[2023-07-28 12:23:41] [config]   - 256.f
[2023-07-28 12:23:41] [config] cost-type: ce-sum
[2023-07-28 12:23:41] [config] cpu-threads: 0
[2023-07-28 12:23:41] [config] data-threads: 8
[2023-07-28 12:23:41] [config] data-weighting: ""
[2023-07-28 12:23:41] [config] data-weighting-type: sentence
[2023-07-28 12:23:41] [config] dec-cell: gru
[2023-07-28 12:23:41] [config] dec-cell-base-depth: 2
[2023-07-28 12:23:41] [config] dec-cell-high-depth: 1
[2023-07-28 12:23:41] [config] dec-depth: 1
[2023-07-28 12:23:41] [config] devices:
[2023-07-28 12:23:41] [config]   - 0
[2023-07-28 12:23:41] [config] dim-emb: 512
[2023-07-28 12:23:41] [config] dim-rnn: 1024
[2023-07-28 12:23:41] [config] dim-vocabs:
[2023-07-28 12:23:41] [config]   - 16384
[2023-07-28 12:23:41] [config]   - 16384
[2023-07-28 12:23:41] [config] disp-first: 0
[2023-07-28 12:23:41] [config] disp-freq: 1000u
[2023-07-28 12:23:41] [config] disp-label-counts: true
[2023-07-28 12:23:41] [config] dropout-rnn: 0
[2023-07-28 12:23:41] [config] dropout-src: 0
[2023-07-28 12:23:41] [config] dropout-trg: 0
[2023-07-28 12:23:41] [config] dump-config: ""
[2023-07-28 12:23:41] [config] dynamic-gradient-scaling:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] early-stopping: 1000
[2023-07-28 12:23:41] [config] early-stopping-on: first
[2023-07-28 12:23:41] [config] embedding-fix-src: false
[2023-07-28 12:23:41] [config] embedding-fix-trg: false
[2023-07-28 12:23:41] [config] embedding-normalization: false
[2023-07-28 12:23:41] [config] embedding-vectors:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] enc-cell: gru
[2023-07-28 12:23:41] [config] enc-cell-depth: 1
[2023-07-28 12:23:41] [config] enc-depth: 1
[2023-07-28 12:23:41] [config] enc-type: bidirectional
[2023-07-28 12:23:41] [config] english-title-case-every: 0
[2023-07-28 12:23:41] [config] exponential-smoothing: 0
[2023-07-28 12:23:41] [config] factor-weight: 1
[2023-07-28 12:23:41] [config] factors-combine: sum
[2023-07-28 12:23:41] [config] factors-dim-emb: 0
[2023-07-28 12:23:41] [config] gradient-checkpointing: false
[2023-07-28 12:23:41] [config] gradient-norm-average-window: 100
[2023-07-28 12:23:41] [config] guided-alignment: none
[2023-07-28 12:23:41] [config] guided-alignment-cost: mse
[2023-07-28 12:23:41] [config] guided-alignment-weight: 0.1
[2023-07-28 12:23:41] [config] ignore-model-config: false
[2023-07-28 12:23:41] [config] input-types:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] interpolate-env-vars: false
[2023-07-28 12:23:41] [config] keep-best: false
[2023-07-28 12:23:41] [config] label-smoothing: 0
[2023-07-28 12:23:41] [config] layer-normalization: false
[2023-07-28 12:23:41] [config] learn-rate: 0.0001
[2023-07-28 12:23:41] [config] lemma-dependency: ""
[2023-07-28 12:23:41] [config] lemma-dim-emb: 0
[2023-07-28 12:23:41] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 12:23:41] [config] log-level: info
[2023-07-28 12:23:41] [config] log-time-zone: ""
[2023-07-28 12:23:41] [config] logical-epoch:
[2023-07-28 12:23:41] [config]   - 1e
[2023-07-28 12:23:41] [config]   - 0
[2023-07-28 12:23:41] [config] lr-decay: 0
[2023-07-28 12:23:41] [config] lr-decay-freq: 50000
[2023-07-28 12:23:41] [config] lr-decay-inv-sqrt:
[2023-07-28 12:23:41] [config]   - 0
[2023-07-28 12:23:41] [config] lr-decay-repeat-warmup: false
[2023-07-28 12:23:41] [config] lr-decay-reset-optimizer: false
[2023-07-28 12:23:41] [config] lr-decay-start:
[2023-07-28 12:23:41] [config]   - 10
[2023-07-28 12:23:41] [config]   - 1
[2023-07-28 12:23:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 12:23:41] [config] lr-report: false
[2023-07-28 12:23:41] [config] lr-warmup: 0
[2023-07-28 12:23:41] [config] lr-warmup-at-reload: false
[2023-07-28 12:23:41] [config] lr-warmup-cycle: false
[2023-07-28 12:23:41] [config] lr-warmup-start-rate: 0
[2023-07-28 12:23:41] [config] max-length: 50
[2023-07-28 12:23:41] [config] max-length-crop: true
[2023-07-28 12:23:41] [config] max-length-factor: 3
[2023-07-28 12:23:41] [config] maxi-batch: 100
[2023-07-28 12:23:41] [config] maxi-batch-sort: trg
[2023-07-28 12:23:41] [config] mini-batch: 64
[2023-07-28 12:23:41] [config] mini-batch-fit: true
[2023-07-28 12:23:41] [config] mini-batch-fit-step: 10
[2023-07-28 12:23:41] [config] mini-batch-round-up: true
[2023-07-28 12:23:41] [config] mini-batch-track-lr: false
[2023-07-28 12:23:41] [config] mini-batch-warmup: 0
[2023-07-28 12:23:41] [config] mini-batch-words: 0
[2023-07-28 12:23:41] [config] mini-batch-words-ref: 0
[2023-07-28 12:23:41] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 12:23:41] [config] multi-loss-type: sum
[2023-07-28 12:23:41] [config] n-best: false
[2023-07-28 12:23:41] [config] no-nccl: false
[2023-07-28 12:23:41] [config] no-reload: false
[2023-07-28 12:23:41] [config] no-restore-corpus: false
[2023-07-28 12:23:41] [config] normalize: 0
[2023-07-28 12:23:41] [config] normalize-gradient: false
[2023-07-28 12:23:41] [config] num-devices: 0
[2023-07-28 12:23:41] [config] optimizer: adam
[2023-07-28 12:23:41] [config] optimizer-delay: 1
[2023-07-28 12:23:41] [config] optimizer-params:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] output-omit-bias: false
[2023-07-28 12:23:41] [config] overwrite: true
[2023-07-28 12:23:41] [config] precision:
[2023-07-28 12:23:41] [config]   - float16
[2023-07-28 12:23:41] [config]   - float32
[2023-07-28 12:23:41] [config] pretrained-model: ""
[2023-07-28 12:23:41] [config] quantize-biases: false
[2023-07-28 12:23:41] [config] quantize-bits: 0
[2023-07-28 12:23:41] [config] quantize-log-based: false
[2023-07-28 12:23:41] [config] quantize-optimization-steps: 0
[2023-07-28 12:23:41] [config] quiet: false
[2023-07-28 12:23:41] [config] quiet-translation: true
[2023-07-28 12:23:41] [config] relative-paths: false
[2023-07-28 12:23:41] [config] right-left: false
[2023-07-28 12:23:41] [config] save-freq: 10000u
[2023-07-28 12:23:41] [config] seed: 1234
[2023-07-28 12:23:41] [config] sentencepiece-alphas:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] sentencepiece-max-lines: 2000000
[2023-07-28 12:23:41] [config] sentencepiece-options: ""
[2023-07-28 12:23:41] [config] sharding: global
[2023-07-28 12:23:41] [config] shuffle: data
[2023-07-28 12:23:41] [config] shuffle-in-ram: false
[2023-07-28 12:23:41] [config] sigterm: save-and-exit
[2023-07-28 12:23:41] [config] skip: false
[2023-07-28 12:23:41] [config] sqlite: ""
[2023-07-28 12:23:41] [config] sqlite-drop: false
[2023-07-28 12:23:41] [config] sync-freq: 200u
[2023-07-28 12:23:41] [config] sync-sgd: false
[2023-07-28 12:23:41] [config] tempdir: /tmp
[2023-07-28 12:23:41] [config] tied-embeddings: false
[2023-07-28 12:23:41] [config] tied-embeddings-all: true
[2023-07-28 12:23:41] [config] tied-embeddings-src: false
[2023-07-28 12:23:41] [config] train-embedder-rank:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] train-sets:
[2023-07-28 12:23:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 12:23:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 12:23:41] [config] transformer-aan-activation: swish
[2023-07-28 12:23:41] [config] transformer-aan-depth: 2
[2023-07-28 12:23:41] [config] transformer-aan-nogate: false
[2023-07-28 12:23:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 12:23:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 12:23:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 12:23:41] [config] transformer-depth-scaling: false
[2023-07-28 12:23:41] [config] transformer-dim-aan: 2048
[2023-07-28 12:23:41] [config] transformer-dim-ffn: 2048
[2023-07-28 12:23:41] [config] transformer-dropout: 0
[2023-07-28 12:23:41] [config] transformer-dropout-attention: 0
[2023-07-28 12:23:41] [config] transformer-dropout-ffn: 0
[2023-07-28 12:23:41] [config] transformer-ffn-activation: swish
[2023-07-28 12:23:41] [config] transformer-ffn-depth: 2
[2023-07-28 12:23:41] [config] transformer-guided-alignment-layer: last
[2023-07-28 12:23:41] [config] transformer-heads: 8
[2023-07-28 12:23:41] [config] transformer-no-projection: false
[2023-07-28 12:23:41] [config] transformer-pool: false
[2023-07-28 12:23:41] [config] transformer-postprocess: dan
[2023-07-28 12:23:41] [config] transformer-postprocess-emb: d
[2023-07-28 12:23:41] [config] transformer-postprocess-top: ""
[2023-07-28 12:23:41] [config] transformer-preprocess: ""
[2023-07-28 12:23:41] [config] transformer-tied-layers:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] transformer-train-position-embeddings: false
[2023-07-28 12:23:41] [config] tsv: false
[2023-07-28 12:23:41] [config] tsv-fields: 0
[2023-07-28 12:23:41] [config] type: s2s
[2023-07-28 12:23:41] [config] ulr: false
[2023-07-28 12:23:41] [config] ulr-dim-emb: 0
[2023-07-28 12:23:41] [config] ulr-dropout: 0
[2023-07-28 12:23:41] [config] ulr-keys-vectors: ""
[2023-07-28 12:23:41] [config] ulr-query-vectors: ""
[2023-07-28 12:23:41] [config] ulr-softmax-temperature: 1
[2023-07-28 12:23:41] [config] ulr-trainable-transformation: false
[2023-07-28 12:23:41] [config] unlikelihood-loss: false
[2023-07-28 12:23:41] [config] valid-freq: 50000000
[2023-07-28 12:23:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from4_to6.log
[2023-07-28 12:23:41] [config] valid-max-length: 1000
[2023-07-28 12:23:41] [config] valid-metrics:
[2023-07-28 12:23:41] [config]   - translation
[2023-07-28 12:23:41] [config] valid-mini-batch: 32
[2023-07-28 12:23:41] [config] valid-reset-stalled: false
[2023-07-28 12:23:41] [config] valid-script-args:
[2023-07-28 12:23:41] [config]   []
[2023-07-28 12:23:41] [config] valid-script-path: ""
[2023-07-28 12:23:41] [config] valid-sets:
[2023-07-28 12:23:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 12:23:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 12:23:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from4_to6.txt
[2023-07-28 12:23:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:23:41] [config] vocabs:
[2023-07-28 12:23:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 12:23:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 12:23:41] [config] word-penalty: 0
[2023-07-28 12:23:41] [config] word-scores: false
[2023-07-28 12:23:41] [config] workspace: 5500
[2023-07-28 12:23:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:23:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:23:41] [training] Using single-device training
[2023-07-28 12:23:41] Synced seed 1234
[2023-07-28 12:23:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 12:23:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 12:23:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 12:23:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 12:23:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 12:23:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:23:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 12:23:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 12:23:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 12:23:42] [comm] Using global sharding
[2023-07-28 12:23:42] [comm] NCCLCommunicators constructed successfully
[2023-07-28 12:23:42] [training] Using 1 GPUs
[2023-07-28 12:23:42] [logits] Applying loss function for 1 factor(s)
[2023-07-28 12:23:42] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:23:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 12:23:43] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:28:11] [batching] Done. Typical MB size is 36,030 target words
[2023-07-28 12:28:12] [valid] No post-processing script given for validating translator
[2023-07-28 12:28:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:28:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 12:28:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 12:28:12] [comm] Using global sharding
[2023-07-28 12:28:13] [comm] NCCLCommunicators constructed successfully
[2023-07-28 12:28:13] [training] Using 1 GPUs
[2023-07-28 12:28:13] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 12:28:14] Allocating memory for general optimizer shards
[2023-07-28 12:28:14] [memory] Reserving 322 MB, device gpu0
[2023-07-28 12:28:14] Loading Adam parameters
[2023-07-28 12:28:14] [memory] Reserving 322 MB, device gpu0
[2023-07-28 12:28:14] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:28:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
[2023-07-28 12:28:15] [data] Restoring the corpus state to epoch 421, batch 11478
[2023-07-28 12:28:15] [data] Shuffling data
[2023-07-28 12:28:15] [data] Done reading 20,192 sentences
[2023-07-28 12:28:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:28:15] Training started
[2023-07-28 12:28:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 12:28:15] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:28:18] Parameter type float16, optimization type float32, casting types true
[2023-07-28 12:29:22] Seen 20,192 samples
[2023-07-28 12:29:22] Starting data epoch 422 in logical epoch 422
[2023-07-28 12:29:22] [data] Shuffling data
[2023-07-28 12:29:22] [data] Done reading 20,192 sentences
[2023-07-28 12:29:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:30:27] Seen 20,192 samples
[2023-07-28 12:30:27] Starting data epoch 423 in logical epoch 423
[2023-07-28 12:30:27] [data] Shuffling data
[2023-07-28 12:30:27] [data] Done reading 20,192 sentences
[2023-07-28 12:30:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:31:38] Seen 20,192 samples
[2023-07-28 12:31:38] Starting data epoch 424 in logical epoch 424
[2023-07-28 12:31:38] [data] Shuffling data
[2023-07-28 12:31:38] [data] Done reading 20,192 sentences
[2023-07-28 12:31:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:32:51] Seen 20,192 samples
[2023-07-28 12:32:51] Starting data epoch 425 in logical epoch 425
[2023-07-28 12:32:51] [data] Shuffling data
[2023-07-28 12:32:51] [data] Done reading 20,192 sentences
[2023-07-28 12:32:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:34:03] Seen 20,192 samples
[2023-07-28 12:34:03] Starting data epoch 426 in logical epoch 426
[2023-07-28 12:34:03] [data] Shuffling data
[2023-07-28 12:34:03] [data] Done reading 20,192 sentences
[2023-07-28 12:34:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:35:17] Seen 20,192 samples
[2023-07-28 12:35:17] Starting data epoch 427 in logical epoch 427
[2023-07-28 12:35:17] [data] Shuffling data
[2023-07-28 12:35:17] [data] Done reading 20,192 sentences
[2023-07-28 12:35:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:36:29] Seen 20,192 samples
[2023-07-28 12:36:29] Starting data epoch 428 in logical epoch 428
[2023-07-28 12:36:29] [data] Shuffling data
[2023-07-28 12:36:29] [data] Done reading 20,192 sentences
[2023-07-28 12:36:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:37:44] Seen 20,192 samples
[2023-07-28 12:37:44] Starting data epoch 429 in logical epoch 429
[2023-07-28 12:37:44] [data] Shuffling data
[2023-07-28 12:37:44] [data] Done reading 20,192 sentences
[2023-07-28 12:37:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:38:57] Seen 20,192 samples
[2023-07-28 12:38:57] Starting data epoch 430 in logical epoch 430
[2023-07-28 12:38:57] [data] Shuffling data
[2023-07-28 12:38:57] [data] Done reading 20,192 sentences
[2023-07-28 12:38:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:40:10] Seen 20,192 samples
[2023-07-28 12:40:10] Starting data epoch 431 in logical epoch 431
[2023-07-28 12:40:10] Training finished
[2023-07-28 12:40:53] [valid] Ep. 431 : Up. 11755 : translation : 0 : new best
[2023-07-28 12:40:53] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz
[2023-07-28 12:40:55] Saving Adam parameters
[2023-07-28 12:40:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from4_to6/lvl2_grid_gn_es_s2s_from4_to6_dropout-rnn_0.0.npz.optimizer.npz
Early stopping after 240 epochs
Early stopping after 430 epochs
