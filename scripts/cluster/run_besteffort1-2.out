[2023-07-28 21:27:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 21:27:39] [marian] Running on node01.datos.cluster.uy as process 18257 with command line:
[2023-07-28 21:27:39] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 21:27:39] [config] after: 0e
[2023-07-28 21:27:39] [config] after-batches: 0
[2023-07-28 21:27:39] [config] after-epochs: 10
[2023-07-28 21:27:39] [config] all-caps-every: 0
[2023-07-28 21:27:39] [config] allow-unk: false
[2023-07-28 21:27:39] [config] authors: false
[2023-07-28 21:27:39] [config] beam-size: 12
[2023-07-28 21:27:39] [config] bert-class-symbol: "[CLS]"
[2023-07-28 21:27:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 21:27:39] [config] bert-masking-fraction: 0.15
[2023-07-28 21:27:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 21:27:39] [config] bert-train-type-embeddings: true
[2023-07-28 21:27:39] [config] bert-type-vocab-size: 2
[2023-07-28 21:27:39] [config] build-info: ""
[2023-07-28 21:27:39] [config] check-gradient-nan: false
[2023-07-28 21:27:39] [config] check-nan: false
[2023-07-28 21:27:39] [config] cite: false
[2023-07-28 21:27:39] [config] clip-norm: 1
[2023-07-28 21:27:39] [config] cost-scaling:
[2023-07-28 21:27:39] [config]   - 256.f
[2023-07-28 21:27:39] [config]   - 1000
[2023-07-28 21:27:39] [config]   - 2.f
[2023-07-28 21:27:39] [config]   - 256.f
[2023-07-28 21:27:39] [config] cost-type: ce-sum
[2023-07-28 21:27:39] [config] cpu-threads: 0
[2023-07-28 21:27:39] [config] data-threads: 8
[2023-07-28 21:27:39] [config] data-weighting: ""
[2023-07-28 21:27:39] [config] data-weighting-type: sentence
[2023-07-28 21:27:39] [config] dec-cell: gru
[2023-07-28 21:27:39] [config] dec-cell-base-depth: 2
[2023-07-28 21:27:39] [config] dec-cell-high-depth: 1
[2023-07-28 21:27:39] [config] dec-depth: 1
[2023-07-28 21:27:39] [config] devices:
[2023-07-28 21:27:39] [config]   - 0
[2023-07-28 21:27:39] [config] dim-emb: 512
[2023-07-28 21:27:39] [config] dim-rnn: 1024
[2023-07-28 21:27:39] [config] dim-vocabs:
[2023-07-28 21:27:39] [config]   - 16384
[2023-07-28 21:27:39] [config]   - 16384
[2023-07-28 21:27:39] [config] disp-first: 0
[2023-07-28 21:27:39] [config] disp-freq: 1000u
[2023-07-28 21:27:39] [config] disp-label-counts: true
[2023-07-28 21:27:39] [config] dropout-rnn: 0
[2023-07-28 21:27:39] [config] dropout-src: 0
[2023-07-28 21:27:39] [config] dropout-trg: 0
[2023-07-28 21:27:39] [config] dump-config: ""
[2023-07-28 21:27:39] [config] dynamic-gradient-scaling:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] early-stopping: 1000
[2023-07-28 21:27:39] [config] early-stopping-on: first
[2023-07-28 21:27:39] [config] embedding-fix-src: false
[2023-07-28 21:27:39] [config] embedding-fix-trg: false
[2023-07-28 21:27:39] [config] embedding-normalization: false
[2023-07-28 21:27:39] [config] embedding-vectors:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] enc-cell: gru
[2023-07-28 21:27:39] [config] enc-cell-depth: 1
[2023-07-28 21:27:39] [config] enc-depth: 1
[2023-07-28 21:27:39] [config] enc-type: bidirectional
[2023-07-28 21:27:39] [config] english-title-case-every: 0
[2023-07-28 21:27:39] [config] exponential-smoothing: 0
[2023-07-28 21:27:39] [config] factor-weight: 1
[2023-07-28 21:27:39] [config] factors-combine: sum
[2023-07-28 21:27:39] [config] factors-dim-emb: 0
[2023-07-28 21:27:39] [config] gradient-checkpointing: false
[2023-07-28 21:27:39] [config] gradient-norm-average-window: 100
[2023-07-28 21:27:39] [config] guided-alignment: none
[2023-07-28 21:27:39] [config] guided-alignment-cost: mse
[2023-07-28 21:27:39] [config] guided-alignment-weight: 0.1
[2023-07-28 21:27:39] [config] ignore-model-config: false
[2023-07-28 21:27:39] [config] input-types:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] interpolate-env-vars: false
[2023-07-28 21:27:39] [config] keep-best: false
[2023-07-28 21:27:39] [config] label-smoothing: 0
[2023-07-28 21:27:39] [config] layer-normalization: false
[2023-07-28 21:27:39] [config] learn-rate: 0.0001
[2023-07-28 21:27:39] [config] lemma-dependency: ""
[2023-07-28 21:27:39] [config] lemma-dim-emb: 0
[2023-07-28 21:27:39] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 21:27:39] [config] log-level: info
[2023-07-28 21:27:39] [config] log-time-zone: ""
[2023-07-28 21:27:39] [config] logical-epoch:
[2023-07-28 21:27:39] [config]   - 1e
[2023-07-28 21:27:39] [config]   - 0
[2023-07-28 21:27:39] [config] lr-decay: 0
[2023-07-28 21:27:39] [config] lr-decay-freq: 50000
[2023-07-28 21:27:39] [config] lr-decay-inv-sqrt:
[2023-07-28 21:27:39] [config]   - 0
[2023-07-28 21:27:39] [config] lr-decay-repeat-warmup: false
[2023-07-28 21:27:39] [config] lr-decay-reset-optimizer: false
[2023-07-28 21:27:39] [config] lr-decay-start:
[2023-07-28 21:27:39] [config]   - 10
[2023-07-28 21:27:39] [config]   - 1
[2023-07-28 21:27:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 21:27:39] [config] lr-report: false
[2023-07-28 21:27:39] [config] lr-warmup: 0
[2023-07-28 21:27:39] [config] lr-warmup-at-reload: false
[2023-07-28 21:27:39] [config] lr-warmup-cycle: false
[2023-07-28 21:27:39] [config] lr-warmup-start-rate: 0
[2023-07-28 21:27:39] [config] max-length: 250
[2023-07-28 21:27:39] [config] max-length-crop: true
[2023-07-28 21:27:39] [config] max-length-factor: 3
[2023-07-28 21:27:39] [config] maxi-batch: 100
[2023-07-28 21:27:39] [config] maxi-batch-sort: trg
[2023-07-28 21:27:39] [config] mini-batch: 64
[2023-07-28 21:27:39] [config] mini-batch-fit: true
[2023-07-28 21:27:39] [config] mini-batch-fit-step: 10
[2023-07-28 21:27:39] [config] mini-batch-round-up: true
[2023-07-28 21:27:39] [config] mini-batch-track-lr: false
[2023-07-28 21:27:39] [config] mini-batch-warmup: 0
[2023-07-28 21:27:39] [config] mini-batch-words: 0
[2023-07-28 21:27:39] [config] mini-batch-words-ref: 0
[2023-07-28 21:27:39] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 21:27:39] [config] multi-loss-type: sum
[2023-07-28 21:27:39] [config] n-best: false
[2023-07-28 21:27:39] [config] no-nccl: false
[2023-07-28 21:27:39] [config] no-reload: false
[2023-07-28 21:27:39] [config] no-restore-corpus: false
[2023-07-28 21:27:39] [config] normalize: 0
[2023-07-28 21:27:39] [config] normalize-gradient: false
[2023-07-28 21:27:39] [config] num-devices: 0
[2023-07-28 21:27:39] [config] optimizer: adam
[2023-07-28 21:27:39] [config] optimizer-delay: 1
[2023-07-28 21:27:39] [config] optimizer-params:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] output-omit-bias: false
[2023-07-28 21:27:39] [config] overwrite: true
[2023-07-28 21:27:39] [config] precision:
[2023-07-28 21:27:39] [config]   - float16
[2023-07-28 21:27:39] [config]   - float32
[2023-07-28 21:27:39] [config] pretrained-model: ""
[2023-07-28 21:27:39] [config] quantize-biases: false
[2023-07-28 21:27:39] [config] quantize-bits: 0
[2023-07-28 21:27:39] [config] quantize-log-based: false
[2023-07-28 21:27:39] [config] quantize-optimization-steps: 0
[2023-07-28 21:27:39] [config] quiet: false
[2023-07-28 21:27:39] [config] quiet-translation: true
[2023-07-28 21:27:39] [config] relative-paths: false
[2023-07-28 21:27:39] [config] right-left: false
[2023-07-28 21:27:39] [config] save-freq: 10000u
[2023-07-28 21:27:39] [config] seed: 1234
[2023-07-28 21:27:39] [config] sentencepiece-alphas:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] sentencepiece-max-lines: 2000000
[2023-07-28 21:27:39] [config] sentencepiece-options: ""
[2023-07-28 21:27:39] [config] sharding: global
[2023-07-28 21:27:39] [config] shuffle: data
[2023-07-28 21:27:39] [config] shuffle-in-ram: false
[2023-07-28 21:27:39] [config] sigterm: save-and-exit
[2023-07-28 21:27:39] [config] skip: false
[2023-07-28 21:27:39] [config] sqlite: ""
[2023-07-28 21:27:39] [config] sqlite-drop: false
[2023-07-28 21:27:39] [config] sync-freq: 200u
[2023-07-28 21:27:39] [config] sync-sgd: false
[2023-07-28 21:27:39] [config] tempdir: /tmp
[2023-07-28 21:27:39] [config] tied-embeddings: false
[2023-07-28 21:27:39] [config] tied-embeddings-all: true
[2023-07-28 21:27:39] [config] tied-embeddings-src: false
[2023-07-28 21:27:39] [config] train-embedder-rank:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] train-sets:
[2023-07-28 21:27:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 21:27:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 21:27:39] [config] transformer-aan-activation: swish
[2023-07-28 21:27:39] [config] transformer-aan-depth: 2
[2023-07-28 21:27:39] [config] transformer-aan-nogate: false
[2023-07-28 21:27:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 21:27:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 21:27:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 21:27:39] [config] transformer-depth-scaling: false
[2023-07-28 21:27:39] [config] transformer-dim-aan: 2048
[2023-07-28 21:27:39] [config] transformer-dim-ffn: 2048
[2023-07-28 21:27:39] [config] transformer-dropout: 0
[2023-07-28 21:27:39] [config] transformer-dropout-attention: 0
[2023-07-28 21:27:39] [config] transformer-dropout-ffn: 0
[2023-07-28 21:27:39] [config] transformer-ffn-activation: swish
[2023-07-28 21:27:39] [config] transformer-ffn-depth: 2
[2023-07-28 21:27:39] [config] transformer-guided-alignment-layer: last
[2023-07-28 21:27:39] [config] transformer-heads: 8
[2023-07-28 21:27:39] [config] transformer-no-projection: false
[2023-07-28 21:27:39] [config] transformer-pool: false
[2023-07-28 21:27:39] [config] transformer-postprocess: dan
[2023-07-28 21:27:39] [config] transformer-postprocess-emb: d
[2023-07-28 21:27:39] [config] transformer-postprocess-top: ""
[2023-07-28 21:27:39] [config] transformer-preprocess: ""
[2023-07-28 21:27:39] [config] transformer-tied-layers:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] transformer-train-position-embeddings: false
[2023-07-28 21:27:39] [config] tsv: false
[2023-07-28 21:27:39] [config] tsv-fields: 0
[2023-07-28 21:27:39] [config] type: s2s
[2023-07-28 21:27:39] [config] ulr: false
[2023-07-28 21:27:39] [config] ulr-dim-emb: 0
[2023-07-28 21:27:39] [config] ulr-dropout: 0
[2023-07-28 21:27:39] [config] ulr-keys-vectors: ""
[2023-07-28 21:27:39] [config] ulr-query-vectors: ""
[2023-07-28 21:27:39] [config] ulr-softmax-temperature: 1
[2023-07-28 21:27:39] [config] ulr-trainable-transformation: false
[2023-07-28 21:27:39] [config] unlikelihood-loss: false
[2023-07-28 21:27:39] [config] valid-freq: 50000000
[2023-07-28 21:27:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 21:27:39] [config] valid-max-length: 1000
[2023-07-28 21:27:39] [config] valid-metrics:
[2023-07-28 21:27:39] [config]   - translation
[2023-07-28 21:27:39] [config] valid-mini-batch: 32
[2023-07-28 21:27:39] [config] valid-reset-stalled: false
[2023-07-28 21:27:39] [config] valid-script-args:
[2023-07-28 21:27:39] [config]   []
[2023-07-28 21:27:39] [config] valid-script-path: ""
[2023-07-28 21:27:39] [config] valid-sets:
[2023-07-28 21:27:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 21:27:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 21:27:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 21:27:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 21:27:39] [config] vocabs:
[2023-07-28 21:27:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 21:27:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 21:27:39] [config] word-penalty: 0
[2023-07-28 21:27:39] [config] word-scores: false
[2023-07-28 21:27:39] [config] workspace: 5500
[2023-07-28 21:27:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 21:27:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 21:27:39] [training] Using single-device training
[2023-07-28 21:27:40] Synced seed 1234
[2023-07-28 21:27:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 21:27:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 21:27:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 21:27:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 21:27:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 21:27:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 21:27:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 21:27:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 21:27:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 21:27:42] [comm] Using global sharding
[2023-07-28 21:27:42] [comm] NCCLCommunicators constructed successfully
[2023-07-28 21:27:42] [training] Using 1 GPUs
[2023-07-28 21:27:42] [logits] Applying loss function for 1 factor(s)
[2023-07-28 21:27:42] [memory] Reserving 80 MB, device gpu0
[2023-07-28 21:27:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 21:27:50] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:04:40] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 22:04:40] [valid] No post-processing script given for validating translator
[2023-07-28 22:04:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 22:04:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 22:04:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 22:04:40] [comm] Using global sharding
[2023-07-28 22:04:40] [comm] NCCLCommunicators constructed successfully
[2023-07-28 22:04:40] [training] Using 1 GPUs
[2023-07-28 22:04:40] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 22:04:49] Allocating memory for general optimizer shards
[2023-07-28 22:04:49] [memory] Reserving 322 MB, device gpu0
[2023-07-28 22:04:49] Loading Adam parameters
[2023-07-28 22:04:49] [memory] Reserving 322 MB, device gpu0
[2023-07-28 22:04:49] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:04:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 22:04:49] [data] Restoring the corpus state to epoch 301, batch 11635
[2023-07-28 22:04:49] [data] Shuffling data
[2023-07-28 22:04:49] [data] Done reading 20,192 sentences
[2023-07-28 22:04:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:04:50] Training started
[2023-07-28 22:04:50] Training finished
[2023-07-28 22:04:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 22:04:55] [marian] Running on node01.datos.cluster.uy as process 20680 with command line:
[2023-07-28 22:04:55] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 22:04:55] [config] after: 0e
[2023-07-28 22:04:55] [config] after-batches: 0
[2023-07-28 22:04:55] [config] after-epochs: 20
[2023-07-28 22:04:55] [config] all-caps-every: 0
[2023-07-28 22:04:55] [config] allow-unk: false
[2023-07-28 22:04:55] [config] authors: false
[2023-07-28 22:04:55] [config] beam-size: 12
[2023-07-28 22:04:55] [config] bert-class-symbol: "[CLS]"
[2023-07-28 22:04:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 22:04:55] [config] bert-masking-fraction: 0.15
[2023-07-28 22:04:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 22:04:55] [config] bert-train-type-embeddings: true
[2023-07-28 22:04:55] [config] bert-type-vocab-size: 2
[2023-07-28 22:04:55] [config] build-info: ""
[2023-07-28 22:04:55] [config] check-gradient-nan: false
[2023-07-28 22:04:55] [config] check-nan: false
[2023-07-28 22:04:55] [config] cite: false
[2023-07-28 22:04:55] [config] clip-norm: 1
[2023-07-28 22:04:55] [config] cost-scaling:
[2023-07-28 22:04:55] [config]   - 256.f
[2023-07-28 22:04:55] [config]   - 1000
[2023-07-28 22:04:55] [config]   - 2.f
[2023-07-28 22:04:55] [config]   - 256.f
[2023-07-28 22:04:55] [config] cost-type: ce-sum
[2023-07-28 22:04:55] [config] cpu-threads: 0
[2023-07-28 22:04:55] [config] data-threads: 8
[2023-07-28 22:04:55] [config] data-weighting: ""
[2023-07-28 22:04:55] [config] data-weighting-type: sentence
[2023-07-28 22:04:55] [config] dec-cell: gru
[2023-07-28 22:04:55] [config] dec-cell-base-depth: 2
[2023-07-28 22:04:55] [config] dec-cell-high-depth: 1
[2023-07-28 22:04:55] [config] dec-depth: 1
[2023-07-28 22:04:55] [config] devices:
[2023-07-28 22:04:55] [config]   - 0
[2023-07-28 22:04:55] [config] dim-emb: 512
[2023-07-28 22:04:55] [config] dim-rnn: 1024
[2023-07-28 22:04:55] [config] dim-vocabs:
[2023-07-28 22:04:55] [config]   - 16384
[2023-07-28 22:04:55] [config]   - 16384
[2023-07-28 22:04:55] [config] disp-first: 0
[2023-07-28 22:04:55] [config] disp-freq: 1000u
[2023-07-28 22:04:55] [config] disp-label-counts: true
[2023-07-28 22:04:55] [config] dropout-rnn: 0
[2023-07-28 22:04:55] [config] dropout-src: 0
[2023-07-28 22:04:55] [config] dropout-trg: 0
[2023-07-28 22:04:55] [config] dump-config: ""
[2023-07-28 22:04:55] [config] dynamic-gradient-scaling:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] early-stopping: 1000
[2023-07-28 22:04:55] [config] early-stopping-on: first
[2023-07-28 22:04:55] [config] embedding-fix-src: false
[2023-07-28 22:04:55] [config] embedding-fix-trg: false
[2023-07-28 22:04:55] [config] embedding-normalization: false
[2023-07-28 22:04:55] [config] embedding-vectors:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] enc-cell: gru
[2023-07-28 22:04:55] [config] enc-cell-depth: 1
[2023-07-28 22:04:55] [config] enc-depth: 1
[2023-07-28 22:04:55] [config] enc-type: bidirectional
[2023-07-28 22:04:55] [config] english-title-case-every: 0
[2023-07-28 22:04:55] [config] exponential-smoothing: 0
[2023-07-28 22:04:55] [config] factor-weight: 1
[2023-07-28 22:04:55] [config] factors-combine: sum
[2023-07-28 22:04:55] [config] factors-dim-emb: 0
[2023-07-28 22:04:55] [config] gradient-checkpointing: false
[2023-07-28 22:04:55] [config] gradient-norm-average-window: 100
[2023-07-28 22:04:55] [config] guided-alignment: none
[2023-07-28 22:04:55] [config] guided-alignment-cost: mse
[2023-07-28 22:04:55] [config] guided-alignment-weight: 0.1
[2023-07-28 22:04:55] [config] ignore-model-config: false
[2023-07-28 22:04:55] [config] input-types:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] interpolate-env-vars: false
[2023-07-28 22:04:55] [config] keep-best: false
[2023-07-28 22:04:55] [config] label-smoothing: 0
[2023-07-28 22:04:55] [config] layer-normalization: false
[2023-07-28 22:04:55] [config] learn-rate: 0.0001
[2023-07-28 22:04:55] [config] lemma-dependency: ""
[2023-07-28 22:04:55] [config] lemma-dim-emb: 0
[2023-07-28 22:04:55] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 22:04:55] [config] log-level: info
[2023-07-28 22:04:55] [config] log-time-zone: ""
[2023-07-28 22:04:55] [config] logical-epoch:
[2023-07-28 22:04:55] [config]   - 1e
[2023-07-28 22:04:55] [config]   - 0
[2023-07-28 22:04:55] [config] lr-decay: 0
[2023-07-28 22:04:55] [config] lr-decay-freq: 50000
[2023-07-28 22:04:55] [config] lr-decay-inv-sqrt:
[2023-07-28 22:04:55] [config]   - 0
[2023-07-28 22:04:55] [config] lr-decay-repeat-warmup: false
[2023-07-28 22:04:55] [config] lr-decay-reset-optimizer: false
[2023-07-28 22:04:55] [config] lr-decay-start:
[2023-07-28 22:04:55] [config]   - 10
[2023-07-28 22:04:55] [config]   - 1
[2023-07-28 22:04:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 22:04:55] [config] lr-report: false
[2023-07-28 22:04:55] [config] lr-warmup: 0
[2023-07-28 22:04:55] [config] lr-warmup-at-reload: false
[2023-07-28 22:04:55] [config] lr-warmup-cycle: false
[2023-07-28 22:04:55] [config] lr-warmup-start-rate: 0
[2023-07-28 22:04:55] [config] max-length: 250
[2023-07-28 22:04:55] [config] max-length-crop: true
[2023-07-28 22:04:55] [config] max-length-factor: 3
[2023-07-28 22:04:55] [config] maxi-batch: 100
[2023-07-28 22:04:55] [config] maxi-batch-sort: trg
[2023-07-28 22:04:55] [config] mini-batch: 64
[2023-07-28 22:04:55] [config] mini-batch-fit: true
[2023-07-28 22:04:55] [config] mini-batch-fit-step: 10
[2023-07-28 22:04:55] [config] mini-batch-round-up: true
[2023-07-28 22:04:55] [config] mini-batch-track-lr: false
[2023-07-28 22:04:55] [config] mini-batch-warmup: 0
[2023-07-28 22:04:55] [config] mini-batch-words: 0
[2023-07-28 22:04:55] [config] mini-batch-words-ref: 0
[2023-07-28 22:04:55] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 22:04:55] [config] multi-loss-type: sum
[2023-07-28 22:04:55] [config] n-best: false
[2023-07-28 22:04:55] [config] no-nccl: false
[2023-07-28 22:04:55] [config] no-reload: false
[2023-07-28 22:04:55] [config] no-restore-corpus: false
[2023-07-28 22:04:55] [config] normalize: 0
[2023-07-28 22:04:55] [config] normalize-gradient: false
[2023-07-28 22:04:55] [config] num-devices: 0
[2023-07-28 22:04:55] [config] optimizer: adam
[2023-07-28 22:04:55] [config] optimizer-delay: 1
[2023-07-28 22:04:55] [config] optimizer-params:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] output-omit-bias: false
[2023-07-28 22:04:55] [config] overwrite: true
[2023-07-28 22:04:55] [config] precision:
[2023-07-28 22:04:55] [config]   - float16
[2023-07-28 22:04:55] [config]   - float32
[2023-07-28 22:04:55] [config] pretrained-model: ""
[2023-07-28 22:04:55] [config] quantize-biases: false
[2023-07-28 22:04:55] [config] quantize-bits: 0
[2023-07-28 22:04:55] [config] quantize-log-based: false
[2023-07-28 22:04:55] [config] quantize-optimization-steps: 0
[2023-07-28 22:04:55] [config] quiet: false
[2023-07-28 22:04:55] [config] quiet-translation: true
[2023-07-28 22:04:55] [config] relative-paths: false
[2023-07-28 22:04:55] [config] right-left: false
[2023-07-28 22:04:55] [config] save-freq: 10000u
[2023-07-28 22:04:55] [config] seed: 1234
[2023-07-28 22:04:55] [config] sentencepiece-alphas:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] sentencepiece-max-lines: 2000000
[2023-07-28 22:04:55] [config] sentencepiece-options: ""
[2023-07-28 22:04:55] [config] sharding: global
[2023-07-28 22:04:55] [config] shuffle: data
[2023-07-28 22:04:55] [config] shuffle-in-ram: false
[2023-07-28 22:04:55] [config] sigterm: save-and-exit
[2023-07-28 22:04:55] [config] skip: false
[2023-07-28 22:04:55] [config] sqlite: ""
[2023-07-28 22:04:55] [config] sqlite-drop: false
[2023-07-28 22:04:55] [config] sync-freq: 200u
[2023-07-28 22:04:55] [config] sync-sgd: false
[2023-07-28 22:04:55] [config] tempdir: /tmp
[2023-07-28 22:04:55] [config] tied-embeddings: false
[2023-07-28 22:04:55] [config] tied-embeddings-all: true
[2023-07-28 22:04:55] [config] tied-embeddings-src: false
[2023-07-28 22:04:55] [config] train-embedder-rank:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] train-sets:
[2023-07-28 22:04:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 22:04:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 22:04:55] [config] transformer-aan-activation: swish
[2023-07-28 22:04:55] [config] transformer-aan-depth: 2
[2023-07-28 22:04:55] [config] transformer-aan-nogate: false
[2023-07-28 22:04:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 22:04:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 22:04:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 22:04:55] [config] transformer-depth-scaling: false
[2023-07-28 22:04:55] [config] transformer-dim-aan: 2048
[2023-07-28 22:04:55] [config] transformer-dim-ffn: 2048
[2023-07-28 22:04:55] [config] transformer-dropout: 0
[2023-07-28 22:04:55] [config] transformer-dropout-attention: 0
[2023-07-28 22:04:55] [config] transformer-dropout-ffn: 0
[2023-07-28 22:04:55] [config] transformer-ffn-activation: swish
[2023-07-28 22:04:55] [config] transformer-ffn-depth: 2
[2023-07-28 22:04:55] [config] transformer-guided-alignment-layer: last
[2023-07-28 22:04:55] [config] transformer-heads: 8
[2023-07-28 22:04:55] [config] transformer-no-projection: false
[2023-07-28 22:04:55] [config] transformer-pool: false
[2023-07-28 22:04:55] [config] transformer-postprocess: dan
[2023-07-28 22:04:55] [config] transformer-postprocess-emb: d
[2023-07-28 22:04:55] [config] transformer-postprocess-top: ""
[2023-07-28 22:04:55] [config] transformer-preprocess: ""
[2023-07-28 22:04:55] [config] transformer-tied-layers:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] transformer-train-position-embeddings: false
[2023-07-28 22:04:55] [config] tsv: false
[2023-07-28 22:04:55] [config] tsv-fields: 0
[2023-07-28 22:04:55] [config] type: s2s
[2023-07-28 22:04:55] [config] ulr: false
[2023-07-28 22:04:55] [config] ulr-dim-emb: 0
[2023-07-28 22:04:55] [config] ulr-dropout: 0
[2023-07-28 22:04:55] [config] ulr-keys-vectors: ""
[2023-07-28 22:04:55] [config] ulr-query-vectors: ""
[2023-07-28 22:04:55] [config] ulr-softmax-temperature: 1
[2023-07-28 22:04:55] [config] ulr-trainable-transformation: false
[2023-07-28 22:04:55] [config] unlikelihood-loss: false
[2023-07-28 22:04:55] [config] valid-freq: 50000000
[2023-07-28 22:04:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 22:04:55] [config] valid-max-length: 1000
[2023-07-28 22:04:55] [config] valid-metrics:
[2023-07-28 22:04:55] [config]   - translation
[2023-07-28 22:04:55] [config] valid-mini-batch: 32
[2023-07-28 22:04:55] [config] valid-reset-stalled: false
[2023-07-28 22:04:55] [config] valid-script-args:
[2023-07-28 22:04:55] [config]   []
[2023-07-28 22:04:55] [config] valid-script-path: ""
[2023-07-28 22:04:55] [config] valid-sets:
[2023-07-28 22:04:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 22:04:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 22:04:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 22:04:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 22:04:55] [config] vocabs:
[2023-07-28 22:04:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 22:04:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 22:04:55] [config] word-penalty: 0
[2023-07-28 22:04:55] [config] word-scores: false
[2023-07-28 22:04:55] [config] workspace: 5500
[2023-07-28 22:04:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 22:04:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 22:04:55] [training] Using single-device training
[2023-07-28 22:04:56] Synced seed 1234
[2023-07-28 22:04:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 22:04:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 22:04:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 22:04:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 22:04:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 22:04:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 22:04:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 22:04:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 22:04:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 22:04:57] [comm] Using global sharding
[2023-07-28 22:04:57] [comm] NCCLCommunicators constructed successfully
[2023-07-28 22:04:57] [training] Using 1 GPUs
[2023-07-28 22:04:57] [logits] Applying loss function for 1 factor(s)
[2023-07-28 22:04:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:04:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 22:04:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:41:47] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 22:41:47] [valid] No post-processing script given for validating translator
[2023-07-28 22:41:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 22:41:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 22:41:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 22:41:48] [comm] Using global sharding
[2023-07-28 22:41:48] [comm] NCCLCommunicators constructed successfully
[2023-07-28 22:41:48] [training] Using 1 GPUs
[2023-07-28 22:41:48] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 22:41:50] Allocating memory for general optimizer shards
[2023-07-28 22:41:50] [memory] Reserving 322 MB, device gpu0
[2023-07-28 22:41:50] Loading Adam parameters
[2023-07-28 22:41:50] [memory] Reserving 322 MB, device gpu0
[2023-07-28 22:41:50] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:41:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 22:41:51] [data] Restoring the corpus state to epoch 301, batch 11635
[2023-07-28 22:41:51] [data] Shuffling data
[2023-07-28 22:41:51] [data] Done reading 20,192 sentences
[2023-07-28 22:41:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:41:51] Training started
[2023-07-28 22:41:51] Training finished
[2023-07-28 22:41:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 22:41:54] [marian] Running on node01.datos.cluster.uy as process 22969 with command line:
[2023-07-28 22:41:54] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 22:41:54] [config] after: 0e
[2023-07-28 22:41:54] [config] after-batches: 0
[2023-07-28 22:41:54] [config] after-epochs: 30
[2023-07-28 22:41:54] [config] all-caps-every: 0
[2023-07-28 22:41:54] [config] allow-unk: false
[2023-07-28 22:41:54] [config] authors: false
[2023-07-28 22:41:54] [config] beam-size: 12
[2023-07-28 22:41:54] [config] bert-class-symbol: "[CLS]"
[2023-07-28 22:41:54] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 22:41:54] [config] bert-masking-fraction: 0.15
[2023-07-28 22:41:54] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 22:41:54] [config] bert-train-type-embeddings: true
[2023-07-28 22:41:54] [config] bert-type-vocab-size: 2
[2023-07-28 22:41:54] [config] build-info: ""
[2023-07-28 22:41:54] [config] check-gradient-nan: false
[2023-07-28 22:41:54] [config] check-nan: false
[2023-07-28 22:41:54] [config] cite: false
[2023-07-28 22:41:54] [config] clip-norm: 1
[2023-07-28 22:41:54] [config] cost-scaling:
[2023-07-28 22:41:54] [config]   - 256.f
[2023-07-28 22:41:54] [config]   - 1000
[2023-07-28 22:41:54] [config]   - 2.f
[2023-07-28 22:41:54] [config]   - 256.f
[2023-07-28 22:41:54] [config] cost-type: ce-sum
[2023-07-28 22:41:54] [config] cpu-threads: 0
[2023-07-28 22:41:54] [config] data-threads: 8
[2023-07-28 22:41:54] [config] data-weighting: ""
[2023-07-28 22:41:54] [config] data-weighting-type: sentence
[2023-07-28 22:41:54] [config] dec-cell: gru
[2023-07-28 22:41:54] [config] dec-cell-base-depth: 2
[2023-07-28 22:41:54] [config] dec-cell-high-depth: 1
[2023-07-28 22:41:54] [config] dec-depth: 1
[2023-07-28 22:41:54] [config] devices:
[2023-07-28 22:41:54] [config]   - 0
[2023-07-28 22:41:54] [config] dim-emb: 512
[2023-07-28 22:41:54] [config] dim-rnn: 1024
[2023-07-28 22:41:54] [config] dim-vocabs:
[2023-07-28 22:41:54] [config]   - 16384
[2023-07-28 22:41:54] [config]   - 16384
[2023-07-28 22:41:54] [config] disp-first: 0
[2023-07-28 22:41:54] [config] disp-freq: 1000u
[2023-07-28 22:41:54] [config] disp-label-counts: true
[2023-07-28 22:41:54] [config] dropout-rnn: 0
[2023-07-28 22:41:54] [config] dropout-src: 0
[2023-07-28 22:41:54] [config] dropout-trg: 0
[2023-07-28 22:41:54] [config] dump-config: ""
[2023-07-28 22:41:54] [config] dynamic-gradient-scaling:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] early-stopping: 1000
[2023-07-28 22:41:54] [config] early-stopping-on: first
[2023-07-28 22:41:54] [config] embedding-fix-src: false
[2023-07-28 22:41:54] [config] embedding-fix-trg: false
[2023-07-28 22:41:54] [config] embedding-normalization: false
[2023-07-28 22:41:54] [config] embedding-vectors:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] enc-cell: gru
[2023-07-28 22:41:54] [config] enc-cell-depth: 1
[2023-07-28 22:41:54] [config] enc-depth: 1
[2023-07-28 22:41:54] [config] enc-type: bidirectional
[2023-07-28 22:41:54] [config] english-title-case-every: 0
[2023-07-28 22:41:54] [config] exponential-smoothing: 0
[2023-07-28 22:41:54] [config] factor-weight: 1
[2023-07-28 22:41:54] [config] factors-combine: sum
[2023-07-28 22:41:54] [config] factors-dim-emb: 0
[2023-07-28 22:41:54] [config] gradient-checkpointing: false
[2023-07-28 22:41:54] [config] gradient-norm-average-window: 100
[2023-07-28 22:41:54] [config] guided-alignment: none
[2023-07-28 22:41:54] [config] guided-alignment-cost: mse
[2023-07-28 22:41:54] [config] guided-alignment-weight: 0.1
[2023-07-28 22:41:54] [config] ignore-model-config: false
[2023-07-28 22:41:54] [config] input-types:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] interpolate-env-vars: false
[2023-07-28 22:41:54] [config] keep-best: false
[2023-07-28 22:41:54] [config] label-smoothing: 0
[2023-07-28 22:41:54] [config] layer-normalization: false
[2023-07-28 22:41:54] [config] learn-rate: 0.0001
[2023-07-28 22:41:54] [config] lemma-dependency: ""
[2023-07-28 22:41:54] [config] lemma-dim-emb: 0
[2023-07-28 22:41:54] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 22:41:54] [config] log-level: info
[2023-07-28 22:41:54] [config] log-time-zone: ""
[2023-07-28 22:41:54] [config] logical-epoch:
[2023-07-28 22:41:54] [config]   - 1e
[2023-07-28 22:41:54] [config]   - 0
[2023-07-28 22:41:54] [config] lr-decay: 0
[2023-07-28 22:41:54] [config] lr-decay-freq: 50000
[2023-07-28 22:41:54] [config] lr-decay-inv-sqrt:
[2023-07-28 22:41:54] [config]   - 0
[2023-07-28 22:41:54] [config] lr-decay-repeat-warmup: false
[2023-07-28 22:41:54] [config] lr-decay-reset-optimizer: false
[2023-07-28 22:41:54] [config] lr-decay-start:
[2023-07-28 22:41:54] [config]   - 10
[2023-07-28 22:41:54] [config]   - 1
[2023-07-28 22:41:54] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 22:41:54] [config] lr-report: false
[2023-07-28 22:41:54] [config] lr-warmup: 0
[2023-07-28 22:41:54] [config] lr-warmup-at-reload: false
[2023-07-28 22:41:54] [config] lr-warmup-cycle: false
[2023-07-28 22:41:54] [config] lr-warmup-start-rate: 0
[2023-07-28 22:41:54] [config] max-length: 250
[2023-07-28 22:41:54] [config] max-length-crop: true
[2023-07-28 22:41:54] [config] max-length-factor: 3
[2023-07-28 22:41:54] [config] maxi-batch: 100
[2023-07-28 22:41:54] [config] maxi-batch-sort: trg
[2023-07-28 22:41:54] [config] mini-batch: 64
[2023-07-28 22:41:54] [config] mini-batch-fit: true
[2023-07-28 22:41:54] [config] mini-batch-fit-step: 10
[2023-07-28 22:41:54] [config] mini-batch-round-up: true
[2023-07-28 22:41:54] [config] mini-batch-track-lr: false
[2023-07-28 22:41:54] [config] mini-batch-warmup: 0
[2023-07-28 22:41:54] [config] mini-batch-words: 0
[2023-07-28 22:41:54] [config] mini-batch-words-ref: 0
[2023-07-28 22:41:54] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 22:41:54] [config] multi-loss-type: sum
[2023-07-28 22:41:54] [config] n-best: false
[2023-07-28 22:41:54] [config] no-nccl: false
[2023-07-28 22:41:54] [config] no-reload: false
[2023-07-28 22:41:54] [config] no-restore-corpus: false
[2023-07-28 22:41:54] [config] normalize: 0
[2023-07-28 22:41:54] [config] normalize-gradient: false
[2023-07-28 22:41:54] [config] num-devices: 0
[2023-07-28 22:41:54] [config] optimizer: adam
[2023-07-28 22:41:54] [config] optimizer-delay: 1
[2023-07-28 22:41:54] [config] optimizer-params:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] output-omit-bias: false
[2023-07-28 22:41:54] [config] overwrite: true
[2023-07-28 22:41:54] [config] precision:
[2023-07-28 22:41:54] [config]   - float16
[2023-07-28 22:41:54] [config]   - float32
[2023-07-28 22:41:54] [config] pretrained-model: ""
[2023-07-28 22:41:54] [config] quantize-biases: false
[2023-07-28 22:41:54] [config] quantize-bits: 0
[2023-07-28 22:41:54] [config] quantize-log-based: false
[2023-07-28 22:41:54] [config] quantize-optimization-steps: 0
[2023-07-28 22:41:54] [config] quiet: false
[2023-07-28 22:41:54] [config] quiet-translation: true
[2023-07-28 22:41:54] [config] relative-paths: false
[2023-07-28 22:41:54] [config] right-left: false
[2023-07-28 22:41:54] [config] save-freq: 10000u
[2023-07-28 22:41:54] [config] seed: 1234
[2023-07-28 22:41:54] [config] sentencepiece-alphas:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] sentencepiece-max-lines: 2000000
[2023-07-28 22:41:54] [config] sentencepiece-options: ""
[2023-07-28 22:41:54] [config] sharding: global
[2023-07-28 22:41:54] [config] shuffle: data
[2023-07-28 22:41:54] [config] shuffle-in-ram: false
[2023-07-28 22:41:54] [config] sigterm: save-and-exit
[2023-07-28 22:41:54] [config] skip: false
[2023-07-28 22:41:54] [config] sqlite: ""
[2023-07-28 22:41:54] [config] sqlite-drop: false
[2023-07-28 22:41:54] [config] sync-freq: 200u
[2023-07-28 22:41:54] [config] sync-sgd: false
[2023-07-28 22:41:54] [config] tempdir: /tmp
[2023-07-28 22:41:54] [config] tied-embeddings: false
[2023-07-28 22:41:54] [config] tied-embeddings-all: true
[2023-07-28 22:41:54] [config] tied-embeddings-src: false
[2023-07-28 22:41:54] [config] train-embedder-rank:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] train-sets:
[2023-07-28 22:41:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 22:41:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 22:41:54] [config] transformer-aan-activation: swish
[2023-07-28 22:41:54] [config] transformer-aan-depth: 2
[2023-07-28 22:41:54] [config] transformer-aan-nogate: false
[2023-07-28 22:41:54] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 22:41:54] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 22:41:54] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 22:41:54] [config] transformer-depth-scaling: false
[2023-07-28 22:41:54] [config] transformer-dim-aan: 2048
[2023-07-28 22:41:54] [config] transformer-dim-ffn: 2048
[2023-07-28 22:41:54] [config] transformer-dropout: 0
[2023-07-28 22:41:54] [config] transformer-dropout-attention: 0
[2023-07-28 22:41:54] [config] transformer-dropout-ffn: 0
[2023-07-28 22:41:54] [config] transformer-ffn-activation: swish
[2023-07-28 22:41:54] [config] transformer-ffn-depth: 2
[2023-07-28 22:41:54] [config] transformer-guided-alignment-layer: last
[2023-07-28 22:41:54] [config] transformer-heads: 8
[2023-07-28 22:41:54] [config] transformer-no-projection: false
[2023-07-28 22:41:54] [config] transformer-pool: false
[2023-07-28 22:41:54] [config] transformer-postprocess: dan
[2023-07-28 22:41:54] [config] transformer-postprocess-emb: d
[2023-07-28 22:41:54] [config] transformer-postprocess-top: ""
[2023-07-28 22:41:54] [config] transformer-preprocess: ""
[2023-07-28 22:41:54] [config] transformer-tied-layers:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] transformer-train-position-embeddings: false
[2023-07-28 22:41:54] [config] tsv: false
[2023-07-28 22:41:54] [config] tsv-fields: 0
[2023-07-28 22:41:54] [config] type: s2s
[2023-07-28 22:41:54] [config] ulr: false
[2023-07-28 22:41:54] [config] ulr-dim-emb: 0
[2023-07-28 22:41:54] [config] ulr-dropout: 0
[2023-07-28 22:41:54] [config] ulr-keys-vectors: ""
[2023-07-28 22:41:54] [config] ulr-query-vectors: ""
[2023-07-28 22:41:54] [config] ulr-softmax-temperature: 1
[2023-07-28 22:41:54] [config] ulr-trainable-transformation: false
[2023-07-28 22:41:54] [config] unlikelihood-loss: false
[2023-07-28 22:41:54] [config] valid-freq: 50000000
[2023-07-28 22:41:54] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 22:41:54] [config] valid-max-length: 1000
[2023-07-28 22:41:54] [config] valid-metrics:
[2023-07-28 22:41:54] [config]   - translation
[2023-07-28 22:41:54] [config] valid-mini-batch: 32
[2023-07-28 22:41:54] [config] valid-reset-stalled: false
[2023-07-28 22:41:54] [config] valid-script-args:
[2023-07-28 22:41:54] [config]   []
[2023-07-28 22:41:54] [config] valid-script-path: ""
[2023-07-28 22:41:54] [config] valid-sets:
[2023-07-28 22:41:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 22:41:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 22:41:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 22:41:54] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 22:41:54] [config] vocabs:
[2023-07-28 22:41:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 22:41:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 22:41:54] [config] word-penalty: 0
[2023-07-28 22:41:54] [config] word-scores: false
[2023-07-28 22:41:54] [config] workspace: 5500
[2023-07-28 22:41:54] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 22:41:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 22:41:54] [training] Using single-device training
[2023-07-28 22:41:55] Synced seed 1234
[2023-07-28 22:41:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 22:41:55] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 22:41:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 22:41:55] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 22:41:55] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 22:41:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 22:41:55] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 22:41:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 22:41:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 22:41:56] [comm] Using global sharding
[2023-07-28 22:41:56] [comm] NCCLCommunicators constructed successfully
[2023-07-28 22:41:56] [training] Using 1 GPUs
[2023-07-28 22:41:56] [logits] Applying loss function for 1 factor(s)
[2023-07-28 22:41:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:41:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 22:41:56] [memory] Reserving 80 MB, device gpu0
[2023-07-28 23:18:55] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 23:18:55] [valid] No post-processing script given for validating translator
[2023-07-28 23:18:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:18:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 23:18:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 23:18:56] [comm] Using global sharding
[2023-07-28 23:18:56] [comm] NCCLCommunicators constructed successfully
[2023-07-28 23:18:56] [training] Using 1 GPUs
[2023-07-28 23:18:56] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 23:18:57] Allocating memory for general optimizer shards
[2023-07-28 23:18:57] [memory] Reserving 322 MB, device gpu0
[2023-07-28 23:18:57] Loading Adam parameters
[2023-07-28 23:18:57] [memory] Reserving 322 MB, device gpu0
[2023-07-28 23:18:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 23:18:58] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 23:18:58] [data] Restoring the corpus state to epoch 311, batch 12027
[2023-07-28 23:18:58] [data] Shuffling data
[2023-07-28 23:18:58] [data] Done reading 20,192 sentences
[2023-07-28 23:18:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 23:18:58] Training started
[2023-07-28 23:18:58] Training finished
[2023-07-28 23:19:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:19:01] [marian] Running on node01.datos.cluster.uy as process 25599 with command line:
[2023-07-28 23:19:01] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 23:19:02] [config] after: 0e
[2023-07-28 23:19:02] [config] after-batches: 0
[2023-07-28 23:19:02] [config] after-epochs: 40
[2023-07-28 23:19:02] [config] all-caps-every: 0
[2023-07-28 23:19:02] [config] allow-unk: false
[2023-07-28 23:19:02] [config] authors: false
[2023-07-28 23:19:02] [config] beam-size: 12
[2023-07-28 23:19:02] [config] bert-class-symbol: "[CLS]"
[2023-07-28 23:19:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 23:19:02] [config] bert-masking-fraction: 0.15
[2023-07-28 23:19:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 23:19:02] [config] bert-train-type-embeddings: true
[2023-07-28 23:19:02] [config] bert-type-vocab-size: 2
[2023-07-28 23:19:02] [config] build-info: ""
[2023-07-28 23:19:02] [config] check-gradient-nan: false
[2023-07-28 23:19:02] [config] check-nan: false
[2023-07-28 23:19:02] [config] cite: false
[2023-07-28 23:19:02] [config] clip-norm: 1
[2023-07-28 23:19:02] [config] cost-scaling:
[2023-07-28 23:19:02] [config]   - 256.f
[2023-07-28 23:19:02] [config]   - 1000
[2023-07-28 23:19:02] [config]   - 2.f
[2023-07-28 23:19:02] [config]   - 256.f
[2023-07-28 23:19:02] [config] cost-type: ce-sum
[2023-07-28 23:19:02] [config] cpu-threads: 0
[2023-07-28 23:19:02] [config] data-threads: 8
[2023-07-28 23:19:02] [config] data-weighting: ""
[2023-07-28 23:19:02] [config] data-weighting-type: sentence
[2023-07-28 23:19:02] [config] dec-cell: gru
[2023-07-28 23:19:02] [config] dec-cell-base-depth: 2
[2023-07-28 23:19:02] [config] dec-cell-high-depth: 1
[2023-07-28 23:19:02] [config] dec-depth: 1
[2023-07-28 23:19:02] [config] devices:
[2023-07-28 23:19:02] [config]   - 0
[2023-07-28 23:19:02] [config] dim-emb: 512
[2023-07-28 23:19:02] [config] dim-rnn: 1024
[2023-07-28 23:19:02] [config] dim-vocabs:
[2023-07-28 23:19:02] [config]   - 16384
[2023-07-28 23:19:02] [config]   - 16384
[2023-07-28 23:19:02] [config] disp-first: 0
[2023-07-28 23:19:02] [config] disp-freq: 1000u
[2023-07-28 23:19:02] [config] disp-label-counts: true
[2023-07-28 23:19:02] [config] dropout-rnn: 0
[2023-07-28 23:19:02] [config] dropout-src: 0
[2023-07-28 23:19:02] [config] dropout-trg: 0
[2023-07-28 23:19:02] [config] dump-config: ""
[2023-07-28 23:19:02] [config] dynamic-gradient-scaling:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] early-stopping: 1000
[2023-07-28 23:19:02] [config] early-stopping-on: first
[2023-07-28 23:19:02] [config] embedding-fix-src: false
[2023-07-28 23:19:02] [config] embedding-fix-trg: false
[2023-07-28 23:19:02] [config] embedding-normalization: false
[2023-07-28 23:19:02] [config] embedding-vectors:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] enc-cell: gru
[2023-07-28 23:19:02] [config] enc-cell-depth: 1
[2023-07-28 23:19:02] [config] enc-depth: 1
[2023-07-28 23:19:02] [config] enc-type: bidirectional
[2023-07-28 23:19:02] [config] english-title-case-every: 0
[2023-07-28 23:19:02] [config] exponential-smoothing: 0
[2023-07-28 23:19:02] [config] factor-weight: 1
[2023-07-28 23:19:02] [config] factors-combine: sum
[2023-07-28 23:19:02] [config] factors-dim-emb: 0
[2023-07-28 23:19:02] [config] gradient-checkpointing: false
[2023-07-28 23:19:02] [config] gradient-norm-average-window: 100
[2023-07-28 23:19:02] [config] guided-alignment: none
[2023-07-28 23:19:02] [config] guided-alignment-cost: mse
[2023-07-28 23:19:02] [config] guided-alignment-weight: 0.1
[2023-07-28 23:19:02] [config] ignore-model-config: false
[2023-07-28 23:19:02] [config] input-types:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] interpolate-env-vars: false
[2023-07-28 23:19:02] [config] keep-best: false
[2023-07-28 23:19:02] [config] label-smoothing: 0
[2023-07-28 23:19:02] [config] layer-normalization: false
[2023-07-28 23:19:02] [config] learn-rate: 0.0001
[2023-07-28 23:19:02] [config] lemma-dependency: ""
[2023-07-28 23:19:02] [config] lemma-dim-emb: 0
[2023-07-28 23:19:02] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 23:19:02] [config] log-level: info
[2023-07-28 23:19:02] [config] log-time-zone: ""
[2023-07-28 23:19:02] [config] logical-epoch:
[2023-07-28 23:19:02] [config]   - 1e
[2023-07-28 23:19:02] [config]   - 0
[2023-07-28 23:19:02] [config] lr-decay: 0
[2023-07-28 23:19:02] [config] lr-decay-freq: 50000
[2023-07-28 23:19:02] [config] lr-decay-inv-sqrt:
[2023-07-28 23:19:02] [config]   - 0
[2023-07-28 23:19:02] [config] lr-decay-repeat-warmup: false
[2023-07-28 23:19:02] [config] lr-decay-reset-optimizer: false
[2023-07-28 23:19:02] [config] lr-decay-start:
[2023-07-28 23:19:02] [config]   - 10
[2023-07-28 23:19:02] [config]   - 1
[2023-07-28 23:19:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 23:19:02] [config] lr-report: false
[2023-07-28 23:19:02] [config] lr-warmup: 0
[2023-07-28 23:19:02] [config] lr-warmup-at-reload: false
[2023-07-28 23:19:02] [config] lr-warmup-cycle: false
[2023-07-28 23:19:02] [config] lr-warmup-start-rate: 0
[2023-07-28 23:19:02] [config] max-length: 250
[2023-07-28 23:19:02] [config] max-length-crop: true
[2023-07-28 23:19:02] [config] max-length-factor: 3
[2023-07-28 23:19:02] [config] maxi-batch: 100
[2023-07-28 23:19:02] [config] maxi-batch-sort: trg
[2023-07-28 23:19:02] [config] mini-batch: 64
[2023-07-28 23:19:02] [config] mini-batch-fit: true
[2023-07-28 23:19:02] [config] mini-batch-fit-step: 10
[2023-07-28 23:19:02] [config] mini-batch-round-up: true
[2023-07-28 23:19:02] [config] mini-batch-track-lr: false
[2023-07-28 23:19:02] [config] mini-batch-warmup: 0
[2023-07-28 23:19:02] [config] mini-batch-words: 0
[2023-07-28 23:19:02] [config] mini-batch-words-ref: 0
[2023-07-28 23:19:02] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 23:19:02] [config] multi-loss-type: sum
[2023-07-28 23:19:02] [config] n-best: false
[2023-07-28 23:19:02] [config] no-nccl: false
[2023-07-28 23:19:02] [config] no-reload: false
[2023-07-28 23:19:02] [config] no-restore-corpus: false
[2023-07-28 23:19:02] [config] normalize: 0
[2023-07-28 23:19:02] [config] normalize-gradient: false
[2023-07-28 23:19:02] [config] num-devices: 0
[2023-07-28 23:19:02] [config] optimizer: adam
[2023-07-28 23:19:02] [config] optimizer-delay: 1
[2023-07-28 23:19:02] [config] optimizer-params:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] output-omit-bias: false
[2023-07-28 23:19:02] [config] overwrite: true
[2023-07-28 23:19:02] [config] precision:
[2023-07-28 23:19:02] [config]   - float16
[2023-07-28 23:19:02] [config]   - float32
[2023-07-28 23:19:02] [config] pretrained-model: ""
[2023-07-28 23:19:02] [config] quantize-biases: false
[2023-07-28 23:19:02] [config] quantize-bits: 0
[2023-07-28 23:19:02] [config] quantize-log-based: false
[2023-07-28 23:19:02] [config] quantize-optimization-steps: 0
[2023-07-28 23:19:02] [config] quiet: false
[2023-07-28 23:19:02] [config] quiet-translation: true
[2023-07-28 23:19:02] [config] relative-paths: false
[2023-07-28 23:19:02] [config] right-left: false
[2023-07-28 23:19:02] [config] save-freq: 10000u
[2023-07-28 23:19:02] [config] seed: 1234
[2023-07-28 23:19:02] [config] sentencepiece-alphas:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] sentencepiece-max-lines: 2000000
[2023-07-28 23:19:02] [config] sentencepiece-options: ""
[2023-07-28 23:19:02] [config] sharding: global
[2023-07-28 23:19:02] [config] shuffle: data
[2023-07-28 23:19:02] [config] shuffle-in-ram: false
[2023-07-28 23:19:02] [config] sigterm: save-and-exit
[2023-07-28 23:19:02] [config] skip: false
[2023-07-28 23:19:02] [config] sqlite: ""
[2023-07-28 23:19:02] [config] sqlite-drop: false
[2023-07-28 23:19:02] [config] sync-freq: 200u
[2023-07-28 23:19:02] [config] sync-sgd: false
[2023-07-28 23:19:02] [config] tempdir: /tmp
[2023-07-28 23:19:02] [config] tied-embeddings: false
[2023-07-28 23:19:02] [config] tied-embeddings-all: true
[2023-07-28 23:19:02] [config] tied-embeddings-src: false
[2023-07-28 23:19:02] [config] train-embedder-rank:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] train-sets:
[2023-07-28 23:19:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 23:19:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 23:19:02] [config] transformer-aan-activation: swish
[2023-07-28 23:19:02] [config] transformer-aan-depth: 2
[2023-07-28 23:19:02] [config] transformer-aan-nogate: false
[2023-07-28 23:19:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 23:19:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 23:19:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 23:19:02] [config] transformer-depth-scaling: false
[2023-07-28 23:19:02] [config] transformer-dim-aan: 2048
[2023-07-28 23:19:02] [config] transformer-dim-ffn: 2048
[2023-07-28 23:19:02] [config] transformer-dropout: 0
[2023-07-28 23:19:02] [config] transformer-dropout-attention: 0
[2023-07-28 23:19:02] [config] transformer-dropout-ffn: 0
[2023-07-28 23:19:02] [config] transformer-ffn-activation: swish
[2023-07-28 23:19:02] [config] transformer-ffn-depth: 2
[2023-07-28 23:19:02] [config] transformer-guided-alignment-layer: last
[2023-07-28 23:19:02] [config] transformer-heads: 8
[2023-07-28 23:19:02] [config] transformer-no-projection: false
[2023-07-28 23:19:02] [config] transformer-pool: false
[2023-07-28 23:19:02] [config] transformer-postprocess: dan
[2023-07-28 23:19:02] [config] transformer-postprocess-emb: d
[2023-07-28 23:19:02] [config] transformer-postprocess-top: ""
[2023-07-28 23:19:02] [config] transformer-preprocess: ""
[2023-07-28 23:19:02] [config] transformer-tied-layers:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] transformer-train-position-embeddings: false
[2023-07-28 23:19:02] [config] tsv: false
[2023-07-28 23:19:02] [config] tsv-fields: 0
[2023-07-28 23:19:02] [config] type: s2s
[2023-07-28 23:19:02] [config] ulr: false
[2023-07-28 23:19:02] [config] ulr-dim-emb: 0
[2023-07-28 23:19:02] [config] ulr-dropout: 0
[2023-07-28 23:19:02] [config] ulr-keys-vectors: ""
[2023-07-28 23:19:02] [config] ulr-query-vectors: ""
[2023-07-28 23:19:02] [config] ulr-softmax-temperature: 1
[2023-07-28 23:19:02] [config] ulr-trainable-transformation: false
[2023-07-28 23:19:02] [config] unlikelihood-loss: false
[2023-07-28 23:19:02] [config] valid-freq: 50000000
[2023-07-28 23:19:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 23:19:02] [config] valid-max-length: 1000
[2023-07-28 23:19:02] [config] valid-metrics:
[2023-07-28 23:19:02] [config]   - translation
[2023-07-28 23:19:02] [config] valid-mini-batch: 32
[2023-07-28 23:19:02] [config] valid-reset-stalled: false
[2023-07-28 23:19:02] [config] valid-script-args:
[2023-07-28 23:19:02] [config]   []
[2023-07-28 23:19:02] [config] valid-script-path: ""
[2023-07-28 23:19:02] [config] valid-sets:
[2023-07-28 23:19:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 23:19:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 23:19:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 23:19:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:19:02] [config] vocabs:
[2023-07-28 23:19:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 23:19:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 23:19:02] [config] word-penalty: 0
[2023-07-28 23:19:02] [config] word-scores: false
[2023-07-28 23:19:02] [config] workspace: 5500
[2023-07-28 23:19:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:19:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:19:02] [training] Using single-device training
[2023-07-28 23:19:02] Synced seed 1234
[2023-07-28 23:19:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 23:19:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 23:19:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 23:19:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 23:19:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 23:19:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:19:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 23:19:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 23:19:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 23:19:03] [comm] Using global sharding
[2023-07-28 23:19:03] [comm] NCCLCommunicators constructed successfully
[2023-07-28 23:19:03] [training] Using 1 GPUs
[2023-07-28 23:19:03] [logits] Applying loss function for 1 factor(s)
[2023-07-28 23:19:03] [memory] Reserving 80 MB, device gpu0
[2023-07-28 23:19:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 23:19:04] [memory] Reserving 80 MB, device gpu0
[2023-07-28 23:55:53] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 23:55:53] [valid] No post-processing script given for validating translator
[2023-07-28 23:55:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:55:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 23:55:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 23:55:53] [comm] Using global sharding
[2023-07-28 23:55:53] [comm] NCCLCommunicators constructed successfully
[2023-07-28 23:55:53] [training] Using 1 GPUs
[2023-07-28 23:55:53] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 23:55:57] Allocating memory for general optimizer shards
[2023-07-28 23:55:57] [memory] Reserving 322 MB, device gpu0
[2023-07-28 23:55:57] Loading Adam parameters
[2023-07-28 23:55:57] [memory] Reserving 322 MB, device gpu0
[2023-07-28 23:55:57] [memory] Reserving 80 MB, device gpu0
[2023-07-28 23:55:58] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 23:55:58] [data] Restoring the corpus state to epoch 311, batch 12027
[2023-07-28 23:55:58] [data] Shuffling data
[2023-07-28 23:55:58] [data] Done reading 20,192 sentences
[2023-07-28 23:55:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 23:55:58] Training started
[2023-07-28 23:55:58] Training finished
[2023-07-28 23:56:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:56:02] [marian] Running on node01.datos.cluster.uy as process 27888 with command line:
[2023-07-28 23:56:02] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 23:56:02] [config] after: 0e
[2023-07-28 23:56:02] [config] after-batches: 0
[2023-07-28 23:56:02] [config] after-epochs: 50
[2023-07-28 23:56:02] [config] all-caps-every: 0
[2023-07-28 23:56:02] [config] allow-unk: false
[2023-07-28 23:56:02] [config] authors: false
[2023-07-28 23:56:02] [config] beam-size: 12
[2023-07-28 23:56:02] [config] bert-class-symbol: "[CLS]"
[2023-07-28 23:56:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 23:56:02] [config] bert-masking-fraction: 0.15
[2023-07-28 23:56:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 23:56:02] [config] bert-train-type-embeddings: true
[2023-07-28 23:56:02] [config] bert-type-vocab-size: 2
[2023-07-28 23:56:02] [config] build-info: ""
[2023-07-28 23:56:02] [config] check-gradient-nan: false
[2023-07-28 23:56:02] [config] check-nan: false
[2023-07-28 23:56:02] [config] cite: false
[2023-07-28 23:56:02] [config] clip-norm: 1
[2023-07-28 23:56:02] [config] cost-scaling:
[2023-07-28 23:56:02] [config]   - 256.f
[2023-07-28 23:56:02] [config]   - 1000
[2023-07-28 23:56:02] [config]   - 2.f
[2023-07-28 23:56:02] [config]   - 256.f
[2023-07-28 23:56:02] [config] cost-type: ce-sum
[2023-07-28 23:56:02] [config] cpu-threads: 0
[2023-07-28 23:56:02] [config] data-threads: 8
[2023-07-28 23:56:02] [config] data-weighting: ""
[2023-07-28 23:56:02] [config] data-weighting-type: sentence
[2023-07-28 23:56:02] [config] dec-cell: gru
[2023-07-28 23:56:02] [config] dec-cell-base-depth: 2
[2023-07-28 23:56:02] [config] dec-cell-high-depth: 1
[2023-07-28 23:56:02] [config] dec-depth: 1
[2023-07-28 23:56:02] [config] devices:
[2023-07-28 23:56:02] [config]   - 0
[2023-07-28 23:56:02] [config] dim-emb: 512
[2023-07-28 23:56:02] [config] dim-rnn: 1024
[2023-07-28 23:56:02] [config] dim-vocabs:
[2023-07-28 23:56:02] [config]   - 16384
[2023-07-28 23:56:02] [config]   - 16384
[2023-07-28 23:56:02] [config] disp-first: 0
[2023-07-28 23:56:02] [config] disp-freq: 1000u
[2023-07-28 23:56:02] [config] disp-label-counts: true
[2023-07-28 23:56:02] [config] dropout-rnn: 0
[2023-07-28 23:56:02] [config] dropout-src: 0
[2023-07-28 23:56:02] [config] dropout-trg: 0
[2023-07-28 23:56:02] [config] dump-config: ""
[2023-07-28 23:56:02] [config] dynamic-gradient-scaling:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] early-stopping: 1000
[2023-07-28 23:56:02] [config] early-stopping-on: first
[2023-07-28 23:56:02] [config] embedding-fix-src: false
[2023-07-28 23:56:02] [config] embedding-fix-trg: false
[2023-07-28 23:56:02] [config] embedding-normalization: false
[2023-07-28 23:56:02] [config] embedding-vectors:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] enc-cell: gru
[2023-07-28 23:56:02] [config] enc-cell-depth: 1
[2023-07-28 23:56:02] [config] enc-depth: 1
[2023-07-28 23:56:02] [config] enc-type: bidirectional
[2023-07-28 23:56:02] [config] english-title-case-every: 0
[2023-07-28 23:56:02] [config] exponential-smoothing: 0
[2023-07-28 23:56:02] [config] factor-weight: 1
[2023-07-28 23:56:02] [config] factors-combine: sum
[2023-07-28 23:56:02] [config] factors-dim-emb: 0
[2023-07-28 23:56:02] [config] gradient-checkpointing: false
[2023-07-28 23:56:02] [config] gradient-norm-average-window: 100
[2023-07-28 23:56:02] [config] guided-alignment: none
[2023-07-28 23:56:02] [config] guided-alignment-cost: mse
[2023-07-28 23:56:02] [config] guided-alignment-weight: 0.1
[2023-07-28 23:56:02] [config] ignore-model-config: false
[2023-07-28 23:56:02] [config] input-types:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] interpolate-env-vars: false
[2023-07-28 23:56:02] [config] keep-best: false
[2023-07-28 23:56:02] [config] label-smoothing: 0
[2023-07-28 23:56:02] [config] layer-normalization: false
[2023-07-28 23:56:02] [config] learn-rate: 0.0001
[2023-07-28 23:56:02] [config] lemma-dependency: ""
[2023-07-28 23:56:02] [config] lemma-dim-emb: 0
[2023-07-28 23:56:02] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 23:56:02] [config] log-level: info
[2023-07-28 23:56:02] [config] log-time-zone: ""
[2023-07-28 23:56:02] [config] logical-epoch:
[2023-07-28 23:56:02] [config]   - 1e
[2023-07-28 23:56:02] [config]   - 0
[2023-07-28 23:56:02] [config] lr-decay: 0
[2023-07-28 23:56:02] [config] lr-decay-freq: 50000
[2023-07-28 23:56:02] [config] lr-decay-inv-sqrt:
[2023-07-28 23:56:02] [config]   - 0
[2023-07-28 23:56:02] [config] lr-decay-repeat-warmup: false
[2023-07-28 23:56:02] [config] lr-decay-reset-optimizer: false
[2023-07-28 23:56:02] [config] lr-decay-start:
[2023-07-28 23:56:02] [config]   - 10
[2023-07-28 23:56:02] [config]   - 1
[2023-07-28 23:56:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 23:56:02] [config] lr-report: false
[2023-07-28 23:56:02] [config] lr-warmup: 0
[2023-07-28 23:56:02] [config] lr-warmup-at-reload: false
[2023-07-28 23:56:02] [config] lr-warmup-cycle: false
[2023-07-28 23:56:02] [config] lr-warmup-start-rate: 0
[2023-07-28 23:56:02] [config] max-length: 250
[2023-07-28 23:56:02] [config] max-length-crop: true
[2023-07-28 23:56:02] [config] max-length-factor: 3
[2023-07-28 23:56:02] [config] maxi-batch: 100
[2023-07-28 23:56:02] [config] maxi-batch-sort: trg
[2023-07-28 23:56:02] [config] mini-batch: 64
[2023-07-28 23:56:02] [config] mini-batch-fit: true
[2023-07-28 23:56:02] [config] mini-batch-fit-step: 10
[2023-07-28 23:56:02] [config] mini-batch-round-up: true
[2023-07-28 23:56:02] [config] mini-batch-track-lr: false
[2023-07-28 23:56:02] [config] mini-batch-warmup: 0
[2023-07-28 23:56:02] [config] mini-batch-words: 0
[2023-07-28 23:56:02] [config] mini-batch-words-ref: 0
[2023-07-28 23:56:02] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 23:56:02] [config] multi-loss-type: sum
[2023-07-28 23:56:02] [config] n-best: false
[2023-07-28 23:56:02] [config] no-nccl: false
[2023-07-28 23:56:02] [config] no-reload: false
[2023-07-28 23:56:02] [config] no-restore-corpus: false
[2023-07-28 23:56:02] [config] normalize: 0
[2023-07-28 23:56:02] [config] normalize-gradient: false
[2023-07-28 23:56:02] [config] num-devices: 0
[2023-07-28 23:56:02] [config] optimizer: adam
[2023-07-28 23:56:02] [config] optimizer-delay: 1
[2023-07-28 23:56:02] [config] optimizer-params:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] output-omit-bias: false
[2023-07-28 23:56:02] [config] overwrite: true
[2023-07-28 23:56:02] [config] precision:
[2023-07-28 23:56:02] [config]   - float16
[2023-07-28 23:56:02] [config]   - float32
[2023-07-28 23:56:02] [config] pretrained-model: ""
[2023-07-28 23:56:02] [config] quantize-biases: false
[2023-07-28 23:56:02] [config] quantize-bits: 0
[2023-07-28 23:56:02] [config] quantize-log-based: false
[2023-07-28 23:56:02] [config] quantize-optimization-steps: 0
[2023-07-28 23:56:02] [config] quiet: false
[2023-07-28 23:56:02] [config] quiet-translation: true
[2023-07-28 23:56:02] [config] relative-paths: false
[2023-07-28 23:56:02] [config] right-left: false
[2023-07-28 23:56:02] [config] save-freq: 10000u
[2023-07-28 23:56:02] [config] seed: 1234
[2023-07-28 23:56:02] [config] sentencepiece-alphas:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] sentencepiece-max-lines: 2000000
[2023-07-28 23:56:02] [config] sentencepiece-options: ""
[2023-07-28 23:56:02] [config] sharding: global
[2023-07-28 23:56:02] [config] shuffle: data
[2023-07-28 23:56:02] [config] shuffle-in-ram: false
[2023-07-28 23:56:02] [config] sigterm: save-and-exit
[2023-07-28 23:56:02] [config] skip: false
[2023-07-28 23:56:02] [config] sqlite: ""
[2023-07-28 23:56:02] [config] sqlite-drop: false
[2023-07-28 23:56:02] [config] sync-freq: 200u
[2023-07-28 23:56:02] [config] sync-sgd: false
[2023-07-28 23:56:02] [config] tempdir: /tmp
[2023-07-28 23:56:02] [config] tied-embeddings: false
[2023-07-28 23:56:02] [config] tied-embeddings-all: true
[2023-07-28 23:56:02] [config] tied-embeddings-src: false
[2023-07-28 23:56:02] [config] train-embedder-rank:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] train-sets:
[2023-07-28 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 23:56:02] [config] transformer-aan-activation: swish
[2023-07-28 23:56:02] [config] transformer-aan-depth: 2
[2023-07-28 23:56:02] [config] transformer-aan-nogate: false
[2023-07-28 23:56:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 23:56:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 23:56:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 23:56:02] [config] transformer-depth-scaling: false
[2023-07-28 23:56:02] [config] transformer-dim-aan: 2048
[2023-07-28 23:56:02] [config] transformer-dim-ffn: 2048
[2023-07-28 23:56:02] [config] transformer-dropout: 0
[2023-07-28 23:56:02] [config] transformer-dropout-attention: 0
[2023-07-28 23:56:02] [config] transformer-dropout-ffn: 0
[2023-07-28 23:56:02] [config] transformer-ffn-activation: swish
[2023-07-28 23:56:02] [config] transformer-ffn-depth: 2
[2023-07-28 23:56:02] [config] transformer-guided-alignment-layer: last
[2023-07-28 23:56:02] [config] transformer-heads: 8
[2023-07-28 23:56:02] [config] transformer-no-projection: false
[2023-07-28 23:56:02] [config] transformer-pool: false
[2023-07-28 23:56:02] [config] transformer-postprocess: dan
[2023-07-28 23:56:02] [config] transformer-postprocess-emb: d
[2023-07-28 23:56:02] [config] transformer-postprocess-top: ""
[2023-07-28 23:56:02] [config] transformer-preprocess: ""
[2023-07-28 23:56:02] [config] transformer-tied-layers:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] transformer-train-position-embeddings: false
[2023-07-28 23:56:02] [config] tsv: false
[2023-07-28 23:56:02] [config] tsv-fields: 0
[2023-07-28 23:56:02] [config] type: s2s
[2023-07-28 23:56:02] [config] ulr: false
[2023-07-28 23:56:02] [config] ulr-dim-emb: 0
[2023-07-28 23:56:02] [config] ulr-dropout: 0
[2023-07-28 23:56:02] [config] ulr-keys-vectors: ""
[2023-07-28 23:56:02] [config] ulr-query-vectors: ""
[2023-07-28 23:56:02] [config] ulr-softmax-temperature: 1
[2023-07-28 23:56:02] [config] ulr-trainable-transformation: false
[2023-07-28 23:56:02] [config] unlikelihood-loss: false
[2023-07-28 23:56:02] [config] valid-freq: 50000000
[2023-07-28 23:56:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 23:56:02] [config] valid-max-length: 1000
[2023-07-28 23:56:02] [config] valid-metrics:
[2023-07-28 23:56:02] [config]   - translation
[2023-07-28 23:56:02] [config] valid-mini-batch: 32
[2023-07-28 23:56:02] [config] valid-reset-stalled: false
[2023-07-28 23:56:02] [config] valid-script-args:
[2023-07-28 23:56:02] [config]   []
[2023-07-28 23:56:02] [config] valid-script-path: ""
[2023-07-28 23:56:02] [config] valid-sets:
[2023-07-28 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 23:56:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 23:56:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:56:02] [config] vocabs:
[2023-07-28 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 23:56:02] [config] word-penalty: 0
[2023-07-28 23:56:02] [config] word-scores: false
[2023-07-28 23:56:02] [config] workspace: 5500
[2023-07-28 23:56:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:56:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:56:02] [training] Using single-device training
[2023-07-28 23:56:02] Synced seed 1234
[2023-07-28 23:56:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 23:56:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 23:56:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 23:56:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 23:56:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 23:56:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:56:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 23:56:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 23:56:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 23:56:04] [comm] Using global sharding
[2023-07-28 23:56:04] [comm] NCCLCommunicators constructed successfully
[2023-07-28 23:56:04] [training] Using 1 GPUs
[2023-07-28 23:56:04] [logits] Applying loss function for 1 factor(s)
[2023-07-28 23:56:04] [memory] Reserving 80 MB, device gpu0
[2023-07-28 23:56:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 23:56:04] [memory] Reserving 80 MB, device gpu0
[2023-07-29 00:32:55] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 00:32:55] [valid] No post-processing script given for validating translator
[2023-07-29 00:32:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 00:32:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 00:32:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 00:32:55] [comm] Using global sharding
[2023-07-29 00:32:55] [comm] NCCLCommunicators constructed successfully
[2023-07-29 00:32:55] [training] Using 1 GPUs
[2023-07-29 00:32:55] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 00:32:56] Allocating memory for general optimizer shards
[2023-07-29 00:32:56] [memory] Reserving 322 MB, device gpu0
[2023-07-29 00:32:56] Loading Adam parameters
[2023-07-29 00:32:56] [memory] Reserving 322 MB, device gpu0
[2023-07-29 00:32:56] [memory] Reserving 80 MB, device gpu0
[2023-07-29 00:32:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 00:32:56] [data] Restoring the corpus state to epoch 311, batch 12027
[2023-07-29 00:32:56] [data] Shuffling data
[2023-07-29 00:32:56] [data] Done reading 20,192 sentences
[2023-07-29 00:32:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:32:56] Training started
[2023-07-29 00:32:56] Training finished
[2023-07-29 00:33:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 00:33:00] [marian] Running on node01.datos.cluster.uy as process 30204 with command line:
[2023-07-29 00:33:00] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 00:33:00] [config] after: 0e
[2023-07-29 00:33:00] [config] after-batches: 0
[2023-07-29 00:33:00] [config] after-epochs: 60
[2023-07-29 00:33:00] [config] all-caps-every: 0
[2023-07-29 00:33:00] [config] allow-unk: false
[2023-07-29 00:33:00] [config] authors: false
[2023-07-29 00:33:00] [config] beam-size: 12
[2023-07-29 00:33:00] [config] bert-class-symbol: "[CLS]"
[2023-07-29 00:33:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 00:33:00] [config] bert-masking-fraction: 0.15
[2023-07-29 00:33:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 00:33:00] [config] bert-train-type-embeddings: true
[2023-07-29 00:33:00] [config] bert-type-vocab-size: 2
[2023-07-29 00:33:00] [config] build-info: ""
[2023-07-29 00:33:00] [config] check-gradient-nan: false
[2023-07-29 00:33:00] [config] check-nan: false
[2023-07-29 00:33:00] [config] cite: false
[2023-07-29 00:33:00] [config] clip-norm: 1
[2023-07-29 00:33:00] [config] cost-scaling:
[2023-07-29 00:33:00] [config]   - 256.f
[2023-07-29 00:33:00] [config]   - 1000
[2023-07-29 00:33:00] [config]   - 2.f
[2023-07-29 00:33:00] [config]   - 256.f
[2023-07-29 00:33:00] [config] cost-type: ce-sum
[2023-07-29 00:33:00] [config] cpu-threads: 0
[2023-07-29 00:33:00] [config] data-threads: 8
[2023-07-29 00:33:00] [config] data-weighting: ""
[2023-07-29 00:33:00] [config] data-weighting-type: sentence
[2023-07-29 00:33:00] [config] dec-cell: gru
[2023-07-29 00:33:00] [config] dec-cell-base-depth: 2
[2023-07-29 00:33:00] [config] dec-cell-high-depth: 1
[2023-07-29 00:33:00] [config] dec-depth: 1
[2023-07-29 00:33:00] [config] devices:
[2023-07-29 00:33:00] [config]   - 0
[2023-07-29 00:33:00] [config] dim-emb: 512
[2023-07-29 00:33:00] [config] dim-rnn: 1024
[2023-07-29 00:33:00] [config] dim-vocabs:
[2023-07-29 00:33:00] [config]   - 16384
[2023-07-29 00:33:00] [config]   - 16384
[2023-07-29 00:33:00] [config] disp-first: 0
[2023-07-29 00:33:00] [config] disp-freq: 1000u
[2023-07-29 00:33:00] [config] disp-label-counts: true
[2023-07-29 00:33:00] [config] dropout-rnn: 0
[2023-07-29 00:33:00] [config] dropout-src: 0
[2023-07-29 00:33:00] [config] dropout-trg: 0
[2023-07-29 00:33:00] [config] dump-config: ""
[2023-07-29 00:33:00] [config] dynamic-gradient-scaling:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] early-stopping: 1000
[2023-07-29 00:33:00] [config] early-stopping-on: first
[2023-07-29 00:33:00] [config] embedding-fix-src: false
[2023-07-29 00:33:00] [config] embedding-fix-trg: false
[2023-07-29 00:33:00] [config] embedding-normalization: false
[2023-07-29 00:33:00] [config] embedding-vectors:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] enc-cell: gru
[2023-07-29 00:33:00] [config] enc-cell-depth: 1
[2023-07-29 00:33:00] [config] enc-depth: 1
[2023-07-29 00:33:00] [config] enc-type: bidirectional
[2023-07-29 00:33:00] [config] english-title-case-every: 0
[2023-07-29 00:33:00] [config] exponential-smoothing: 0
[2023-07-29 00:33:00] [config] factor-weight: 1
[2023-07-29 00:33:00] [config] factors-combine: sum
[2023-07-29 00:33:00] [config] factors-dim-emb: 0
[2023-07-29 00:33:00] [config] gradient-checkpointing: false
[2023-07-29 00:33:00] [config] gradient-norm-average-window: 100
[2023-07-29 00:33:00] [config] guided-alignment: none
[2023-07-29 00:33:00] [config] guided-alignment-cost: mse
[2023-07-29 00:33:00] [config] guided-alignment-weight: 0.1
[2023-07-29 00:33:00] [config] ignore-model-config: false
[2023-07-29 00:33:00] [config] input-types:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] interpolate-env-vars: false
[2023-07-29 00:33:00] [config] keep-best: false
[2023-07-29 00:33:00] [config] label-smoothing: 0
[2023-07-29 00:33:00] [config] layer-normalization: false
[2023-07-29 00:33:00] [config] learn-rate: 0.0001
[2023-07-29 00:33:00] [config] lemma-dependency: ""
[2023-07-29 00:33:00] [config] lemma-dim-emb: 0
[2023-07-29 00:33:00] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 00:33:00] [config] log-level: info
[2023-07-29 00:33:00] [config] log-time-zone: ""
[2023-07-29 00:33:00] [config] logical-epoch:
[2023-07-29 00:33:00] [config]   - 1e
[2023-07-29 00:33:00] [config]   - 0
[2023-07-29 00:33:00] [config] lr-decay: 0
[2023-07-29 00:33:00] [config] lr-decay-freq: 50000
[2023-07-29 00:33:00] [config] lr-decay-inv-sqrt:
[2023-07-29 00:33:00] [config]   - 0
[2023-07-29 00:33:00] [config] lr-decay-repeat-warmup: false
[2023-07-29 00:33:00] [config] lr-decay-reset-optimizer: false
[2023-07-29 00:33:00] [config] lr-decay-start:
[2023-07-29 00:33:00] [config]   - 10
[2023-07-29 00:33:00] [config]   - 1
[2023-07-29 00:33:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 00:33:00] [config] lr-report: false
[2023-07-29 00:33:00] [config] lr-warmup: 0
[2023-07-29 00:33:00] [config] lr-warmup-at-reload: false
[2023-07-29 00:33:00] [config] lr-warmup-cycle: false
[2023-07-29 00:33:00] [config] lr-warmup-start-rate: 0
[2023-07-29 00:33:00] [config] max-length: 250
[2023-07-29 00:33:00] [config] max-length-crop: true
[2023-07-29 00:33:00] [config] max-length-factor: 3
[2023-07-29 00:33:00] [config] maxi-batch: 100
[2023-07-29 00:33:00] [config] maxi-batch-sort: trg
[2023-07-29 00:33:00] [config] mini-batch: 64
[2023-07-29 00:33:00] [config] mini-batch-fit: true
[2023-07-29 00:33:00] [config] mini-batch-fit-step: 10
[2023-07-29 00:33:00] [config] mini-batch-round-up: true
[2023-07-29 00:33:00] [config] mini-batch-track-lr: false
[2023-07-29 00:33:00] [config] mini-batch-warmup: 0
[2023-07-29 00:33:00] [config] mini-batch-words: 0
[2023-07-29 00:33:00] [config] mini-batch-words-ref: 0
[2023-07-29 00:33:00] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 00:33:00] [config] multi-loss-type: sum
[2023-07-29 00:33:00] [config] n-best: false
[2023-07-29 00:33:00] [config] no-nccl: false
[2023-07-29 00:33:00] [config] no-reload: false
[2023-07-29 00:33:00] [config] no-restore-corpus: false
[2023-07-29 00:33:00] [config] normalize: 0
[2023-07-29 00:33:00] [config] normalize-gradient: false
[2023-07-29 00:33:00] [config] num-devices: 0
[2023-07-29 00:33:00] [config] optimizer: adam
[2023-07-29 00:33:00] [config] optimizer-delay: 1
[2023-07-29 00:33:00] [config] optimizer-params:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] output-omit-bias: false
[2023-07-29 00:33:00] [config] overwrite: true
[2023-07-29 00:33:00] [config] precision:
[2023-07-29 00:33:00] [config]   - float16
[2023-07-29 00:33:00] [config]   - float32
[2023-07-29 00:33:00] [config] pretrained-model: ""
[2023-07-29 00:33:00] [config] quantize-biases: false
[2023-07-29 00:33:00] [config] quantize-bits: 0
[2023-07-29 00:33:00] [config] quantize-log-based: false
[2023-07-29 00:33:00] [config] quantize-optimization-steps: 0
[2023-07-29 00:33:00] [config] quiet: false
[2023-07-29 00:33:00] [config] quiet-translation: true
[2023-07-29 00:33:00] [config] relative-paths: false
[2023-07-29 00:33:00] [config] right-left: false
[2023-07-29 00:33:00] [config] save-freq: 10000u
[2023-07-29 00:33:00] [config] seed: 1234
[2023-07-29 00:33:00] [config] sentencepiece-alphas:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] sentencepiece-max-lines: 2000000
[2023-07-29 00:33:00] [config] sentencepiece-options: ""
[2023-07-29 00:33:00] [config] sharding: global
[2023-07-29 00:33:00] [config] shuffle: data
[2023-07-29 00:33:00] [config] shuffle-in-ram: false
[2023-07-29 00:33:00] [config] sigterm: save-and-exit
[2023-07-29 00:33:00] [config] skip: false
[2023-07-29 00:33:00] [config] sqlite: ""
[2023-07-29 00:33:00] [config] sqlite-drop: false
[2023-07-29 00:33:00] [config] sync-freq: 200u
[2023-07-29 00:33:00] [config] sync-sgd: false
[2023-07-29 00:33:00] [config] tempdir: /tmp
[2023-07-29 00:33:00] [config] tied-embeddings: false
[2023-07-29 00:33:00] [config] tied-embeddings-all: true
[2023-07-29 00:33:00] [config] tied-embeddings-src: false
[2023-07-29 00:33:00] [config] train-embedder-rank:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] train-sets:
[2023-07-29 00:33:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 00:33:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 00:33:00] [config] transformer-aan-activation: swish
[2023-07-29 00:33:00] [config] transformer-aan-depth: 2
[2023-07-29 00:33:00] [config] transformer-aan-nogate: false
[2023-07-29 00:33:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 00:33:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 00:33:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 00:33:00] [config] transformer-depth-scaling: false
[2023-07-29 00:33:00] [config] transformer-dim-aan: 2048
[2023-07-29 00:33:00] [config] transformer-dim-ffn: 2048
[2023-07-29 00:33:00] [config] transformer-dropout: 0
[2023-07-29 00:33:00] [config] transformer-dropout-attention: 0
[2023-07-29 00:33:00] [config] transformer-dropout-ffn: 0
[2023-07-29 00:33:00] [config] transformer-ffn-activation: swish
[2023-07-29 00:33:00] [config] transformer-ffn-depth: 2
[2023-07-29 00:33:00] [config] transformer-guided-alignment-layer: last
[2023-07-29 00:33:00] [config] transformer-heads: 8
[2023-07-29 00:33:00] [config] transformer-no-projection: false
[2023-07-29 00:33:00] [config] transformer-pool: false
[2023-07-29 00:33:00] [config] transformer-postprocess: dan
[2023-07-29 00:33:00] [config] transformer-postprocess-emb: d
[2023-07-29 00:33:00] [config] transformer-postprocess-top: ""
[2023-07-29 00:33:00] [config] transformer-preprocess: ""
[2023-07-29 00:33:00] [config] transformer-tied-layers:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] transformer-train-position-embeddings: false
[2023-07-29 00:33:00] [config] tsv: false
[2023-07-29 00:33:00] [config] tsv-fields: 0
[2023-07-29 00:33:00] [config] type: s2s
[2023-07-29 00:33:00] [config] ulr: false
[2023-07-29 00:33:00] [config] ulr-dim-emb: 0
[2023-07-29 00:33:00] [config] ulr-dropout: 0
[2023-07-29 00:33:00] [config] ulr-keys-vectors: ""
[2023-07-29 00:33:00] [config] ulr-query-vectors: ""
[2023-07-29 00:33:00] [config] ulr-softmax-temperature: 1
[2023-07-29 00:33:00] [config] ulr-trainable-transformation: false
[2023-07-29 00:33:00] [config] unlikelihood-loss: false
[2023-07-29 00:33:00] [config] valid-freq: 50000000
[2023-07-29 00:33:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 00:33:00] [config] valid-max-length: 1000
[2023-07-29 00:33:00] [config] valid-metrics:
[2023-07-29 00:33:00] [config]   - translation
[2023-07-29 00:33:00] [config] valid-mini-batch: 32
[2023-07-29 00:33:00] [config] valid-reset-stalled: false
[2023-07-29 00:33:00] [config] valid-script-args:
[2023-07-29 00:33:00] [config]   []
[2023-07-29 00:33:00] [config] valid-script-path: ""
[2023-07-29 00:33:00] [config] valid-sets:
[2023-07-29 00:33:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 00:33:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 00:33:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 00:33:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 00:33:00] [config] vocabs:
[2023-07-29 00:33:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 00:33:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 00:33:00] [config] word-penalty: 0
[2023-07-29 00:33:00] [config] word-scores: false
[2023-07-29 00:33:00] [config] workspace: 5500
[2023-07-29 00:33:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 00:33:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 00:33:00] [training] Using single-device training
[2023-07-29 00:33:00] Synced seed 1234
[2023-07-29 00:33:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 00:33:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 00:33:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 00:33:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 00:33:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 00:33:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 00:33:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 00:33:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 00:33:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 00:33:01] [comm] Using global sharding
[2023-07-29 00:33:01] [comm] NCCLCommunicators constructed successfully
[2023-07-29 00:33:01] [training] Using 1 GPUs
[2023-07-29 00:33:01] [logits] Applying loss function for 1 factor(s)
[2023-07-29 00:33:01] [memory] Reserving 80 MB, device gpu0
[2023-07-29 00:33:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 00:33:01] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:09:52] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 01:09:52] [valid] No post-processing script given for validating translator
[2023-07-29 01:09:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 01:09:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 01:09:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 01:09:53] [comm] Using global sharding
[2023-07-29 01:09:53] [comm] NCCLCommunicators constructed successfully
[2023-07-29 01:09:53] [training] Using 1 GPUs
[2023-07-29 01:09:53] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 01:09:57] Allocating memory for general optimizer shards
[2023-07-29 01:09:57] [memory] Reserving 322 MB, device gpu0
[2023-07-29 01:09:57] Loading Adam parameters
[2023-07-29 01:09:58] [memory] Reserving 322 MB, device gpu0
[2023-07-29 01:09:58] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:09:58] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 01:09:58] [data] Restoring the corpus state to epoch 321, batch 12417
[2023-07-29 01:09:58] [data] Shuffling data
[2023-07-29 01:09:58] [data] Done reading 20,192 sentences
[2023-07-29 01:09:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 01:09:58] Training started
[2023-07-29 01:09:58] Training finished
[2023-07-29 01:10:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 01:10:02] [marian] Running on node01.datos.cluster.uy as process 32853 with command line:
[2023-07-29 01:10:02] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 01:10:02] [config] after: 0e
[2023-07-29 01:10:02] [config] after-batches: 0
[2023-07-29 01:10:02] [config] after-epochs: 70
[2023-07-29 01:10:02] [config] all-caps-every: 0
[2023-07-29 01:10:02] [config] allow-unk: false
[2023-07-29 01:10:02] [config] authors: false
[2023-07-29 01:10:02] [config] beam-size: 12
[2023-07-29 01:10:02] [config] bert-class-symbol: "[CLS]"
[2023-07-29 01:10:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 01:10:02] [config] bert-masking-fraction: 0.15
[2023-07-29 01:10:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 01:10:02] [config] bert-train-type-embeddings: true
[2023-07-29 01:10:02] [config] bert-type-vocab-size: 2
[2023-07-29 01:10:02] [config] build-info: ""
[2023-07-29 01:10:02] [config] check-gradient-nan: false
[2023-07-29 01:10:02] [config] check-nan: false
[2023-07-29 01:10:02] [config] cite: false
[2023-07-29 01:10:02] [config] clip-norm: 1
[2023-07-29 01:10:02] [config] cost-scaling:
[2023-07-29 01:10:02] [config]   - 256.f
[2023-07-29 01:10:02] [config]   - 1000
[2023-07-29 01:10:02] [config]   - 2.f
[2023-07-29 01:10:02] [config]   - 256.f
[2023-07-29 01:10:02] [config] cost-type: ce-sum
[2023-07-29 01:10:02] [config] cpu-threads: 0
[2023-07-29 01:10:02] [config] data-threads: 8
[2023-07-29 01:10:02] [config] data-weighting: ""
[2023-07-29 01:10:02] [config] data-weighting-type: sentence
[2023-07-29 01:10:02] [config] dec-cell: gru
[2023-07-29 01:10:02] [config] dec-cell-base-depth: 2
[2023-07-29 01:10:02] [config] dec-cell-high-depth: 1
[2023-07-29 01:10:02] [config] dec-depth: 1
[2023-07-29 01:10:02] [config] devices:
[2023-07-29 01:10:02] [config]   - 0
[2023-07-29 01:10:02] [config] dim-emb: 512
[2023-07-29 01:10:02] [config] dim-rnn: 1024
[2023-07-29 01:10:02] [config] dim-vocabs:
[2023-07-29 01:10:02] [config]   - 16384
[2023-07-29 01:10:02] [config]   - 16384
[2023-07-29 01:10:02] [config] disp-first: 0
[2023-07-29 01:10:02] [config] disp-freq: 1000u
[2023-07-29 01:10:02] [config] disp-label-counts: true
[2023-07-29 01:10:02] [config] dropout-rnn: 0
[2023-07-29 01:10:02] [config] dropout-src: 0
[2023-07-29 01:10:02] [config] dropout-trg: 0
[2023-07-29 01:10:02] [config] dump-config: ""
[2023-07-29 01:10:02] [config] dynamic-gradient-scaling:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] early-stopping: 1000
[2023-07-29 01:10:02] [config] early-stopping-on: first
[2023-07-29 01:10:02] [config] embedding-fix-src: false
[2023-07-29 01:10:02] [config] embedding-fix-trg: false
[2023-07-29 01:10:02] [config] embedding-normalization: false
[2023-07-29 01:10:02] [config] embedding-vectors:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] enc-cell: gru
[2023-07-29 01:10:02] [config] enc-cell-depth: 1
[2023-07-29 01:10:02] [config] enc-depth: 1
[2023-07-29 01:10:02] [config] enc-type: bidirectional
[2023-07-29 01:10:02] [config] english-title-case-every: 0
[2023-07-29 01:10:02] [config] exponential-smoothing: 0
[2023-07-29 01:10:02] [config] factor-weight: 1
[2023-07-29 01:10:02] [config] factors-combine: sum
[2023-07-29 01:10:02] [config] factors-dim-emb: 0
[2023-07-29 01:10:02] [config] gradient-checkpointing: false
[2023-07-29 01:10:02] [config] gradient-norm-average-window: 100
[2023-07-29 01:10:02] [config] guided-alignment: none
[2023-07-29 01:10:02] [config] guided-alignment-cost: mse
[2023-07-29 01:10:02] [config] guided-alignment-weight: 0.1
[2023-07-29 01:10:02] [config] ignore-model-config: false
[2023-07-29 01:10:02] [config] input-types:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] interpolate-env-vars: false
[2023-07-29 01:10:02] [config] keep-best: false
[2023-07-29 01:10:02] [config] label-smoothing: 0
[2023-07-29 01:10:02] [config] layer-normalization: false
[2023-07-29 01:10:02] [config] learn-rate: 0.0001
[2023-07-29 01:10:02] [config] lemma-dependency: ""
[2023-07-29 01:10:02] [config] lemma-dim-emb: 0
[2023-07-29 01:10:02] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 01:10:02] [config] log-level: info
[2023-07-29 01:10:02] [config] log-time-zone: ""
[2023-07-29 01:10:02] [config] logical-epoch:
[2023-07-29 01:10:02] [config]   - 1e
[2023-07-29 01:10:02] [config]   - 0
[2023-07-29 01:10:02] [config] lr-decay: 0
[2023-07-29 01:10:02] [config] lr-decay-freq: 50000
[2023-07-29 01:10:02] [config] lr-decay-inv-sqrt:
[2023-07-29 01:10:02] [config]   - 0
[2023-07-29 01:10:02] [config] lr-decay-repeat-warmup: false
[2023-07-29 01:10:02] [config] lr-decay-reset-optimizer: false
[2023-07-29 01:10:02] [config] lr-decay-start:
[2023-07-29 01:10:02] [config]   - 10
[2023-07-29 01:10:02] [config]   - 1
[2023-07-29 01:10:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 01:10:02] [config] lr-report: false
[2023-07-29 01:10:02] [config] lr-warmup: 0
[2023-07-29 01:10:02] [config] lr-warmup-at-reload: false
[2023-07-29 01:10:02] [config] lr-warmup-cycle: false
[2023-07-29 01:10:02] [config] lr-warmup-start-rate: 0
[2023-07-29 01:10:02] [config] max-length: 250
[2023-07-29 01:10:02] [config] max-length-crop: true
[2023-07-29 01:10:02] [config] max-length-factor: 3
[2023-07-29 01:10:02] [config] maxi-batch: 100
[2023-07-29 01:10:02] [config] maxi-batch-sort: trg
[2023-07-29 01:10:02] [config] mini-batch: 64
[2023-07-29 01:10:02] [config] mini-batch-fit: true
[2023-07-29 01:10:02] [config] mini-batch-fit-step: 10
[2023-07-29 01:10:02] [config] mini-batch-round-up: true
[2023-07-29 01:10:02] [config] mini-batch-track-lr: false
[2023-07-29 01:10:02] [config] mini-batch-warmup: 0
[2023-07-29 01:10:02] [config] mini-batch-words: 0
[2023-07-29 01:10:02] [config] mini-batch-words-ref: 0
[2023-07-29 01:10:02] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 01:10:02] [config] multi-loss-type: sum
[2023-07-29 01:10:02] [config] n-best: false
[2023-07-29 01:10:02] [config] no-nccl: false
[2023-07-29 01:10:02] [config] no-reload: false
[2023-07-29 01:10:02] [config] no-restore-corpus: false
[2023-07-29 01:10:02] [config] normalize: 0
[2023-07-29 01:10:02] [config] normalize-gradient: false
[2023-07-29 01:10:02] [config] num-devices: 0
[2023-07-29 01:10:02] [config] optimizer: adam
[2023-07-29 01:10:02] [config] optimizer-delay: 1
[2023-07-29 01:10:02] [config] optimizer-params:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] output-omit-bias: false
[2023-07-29 01:10:02] [config] overwrite: true
[2023-07-29 01:10:02] [config] precision:
[2023-07-29 01:10:02] [config]   - float16
[2023-07-29 01:10:02] [config]   - float32
[2023-07-29 01:10:02] [config] pretrained-model: ""
[2023-07-29 01:10:02] [config] quantize-biases: false
[2023-07-29 01:10:02] [config] quantize-bits: 0
[2023-07-29 01:10:02] [config] quantize-log-based: false
[2023-07-29 01:10:02] [config] quantize-optimization-steps: 0
[2023-07-29 01:10:02] [config] quiet: false
[2023-07-29 01:10:02] [config] quiet-translation: true
[2023-07-29 01:10:02] [config] relative-paths: false
[2023-07-29 01:10:02] [config] right-left: false
[2023-07-29 01:10:02] [config] save-freq: 10000u
[2023-07-29 01:10:02] [config] seed: 1234
[2023-07-29 01:10:02] [config] sentencepiece-alphas:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] sentencepiece-max-lines: 2000000
[2023-07-29 01:10:02] [config] sentencepiece-options: ""
[2023-07-29 01:10:02] [config] sharding: global
[2023-07-29 01:10:02] [config] shuffle: data
[2023-07-29 01:10:02] [config] shuffle-in-ram: false
[2023-07-29 01:10:02] [config] sigterm: save-and-exit
[2023-07-29 01:10:02] [config] skip: false
[2023-07-29 01:10:02] [config] sqlite: ""
[2023-07-29 01:10:02] [config] sqlite-drop: false
[2023-07-29 01:10:02] [config] sync-freq: 200u
[2023-07-29 01:10:02] [config] sync-sgd: false
[2023-07-29 01:10:02] [config] tempdir: /tmp
[2023-07-29 01:10:02] [config] tied-embeddings: false
[2023-07-29 01:10:02] [config] tied-embeddings-all: true
[2023-07-29 01:10:02] [config] tied-embeddings-src: false
[2023-07-29 01:10:02] [config] train-embedder-rank:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] train-sets:
[2023-07-29 01:10:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 01:10:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 01:10:02] [config] transformer-aan-activation: swish
[2023-07-29 01:10:02] [config] transformer-aan-depth: 2
[2023-07-29 01:10:02] [config] transformer-aan-nogate: false
[2023-07-29 01:10:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 01:10:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 01:10:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 01:10:02] [config] transformer-depth-scaling: false
[2023-07-29 01:10:02] [config] transformer-dim-aan: 2048
[2023-07-29 01:10:02] [config] transformer-dim-ffn: 2048
[2023-07-29 01:10:02] [config] transformer-dropout: 0
[2023-07-29 01:10:02] [config] transformer-dropout-attention: 0
[2023-07-29 01:10:02] [config] transformer-dropout-ffn: 0
[2023-07-29 01:10:02] [config] transformer-ffn-activation: swish
[2023-07-29 01:10:02] [config] transformer-ffn-depth: 2
[2023-07-29 01:10:02] [config] transformer-guided-alignment-layer: last
[2023-07-29 01:10:02] [config] transformer-heads: 8
[2023-07-29 01:10:02] [config] transformer-no-projection: false
[2023-07-29 01:10:02] [config] transformer-pool: false
[2023-07-29 01:10:02] [config] transformer-postprocess: dan
[2023-07-29 01:10:02] [config] transformer-postprocess-emb: d
[2023-07-29 01:10:02] [config] transformer-postprocess-top: ""
[2023-07-29 01:10:02] [config] transformer-preprocess: ""
[2023-07-29 01:10:02] [config] transformer-tied-layers:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] transformer-train-position-embeddings: false
[2023-07-29 01:10:02] [config] tsv: false
[2023-07-29 01:10:02] [config] tsv-fields: 0
[2023-07-29 01:10:02] [config] type: s2s
[2023-07-29 01:10:02] [config] ulr: false
[2023-07-29 01:10:02] [config] ulr-dim-emb: 0
[2023-07-29 01:10:02] [config] ulr-dropout: 0
[2023-07-29 01:10:02] [config] ulr-keys-vectors: ""
[2023-07-29 01:10:02] [config] ulr-query-vectors: ""
[2023-07-29 01:10:02] [config] ulr-softmax-temperature: 1
[2023-07-29 01:10:02] [config] ulr-trainable-transformation: false
[2023-07-29 01:10:02] [config] unlikelihood-loss: false
[2023-07-29 01:10:02] [config] valid-freq: 50000000
[2023-07-29 01:10:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 01:10:02] [config] valid-max-length: 1000
[2023-07-29 01:10:02] [config] valid-metrics:
[2023-07-29 01:10:02] [config]   - translation
[2023-07-29 01:10:02] [config] valid-mini-batch: 32
[2023-07-29 01:10:02] [config] valid-reset-stalled: false
[2023-07-29 01:10:02] [config] valid-script-args:
[2023-07-29 01:10:02] [config]   []
[2023-07-29 01:10:02] [config] valid-script-path: ""
[2023-07-29 01:10:02] [config] valid-sets:
[2023-07-29 01:10:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 01:10:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 01:10:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 01:10:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 01:10:02] [config] vocabs:
[2023-07-29 01:10:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 01:10:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 01:10:02] [config] word-penalty: 0
[2023-07-29 01:10:02] [config] word-scores: false
[2023-07-29 01:10:02] [config] workspace: 5500
[2023-07-29 01:10:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 01:10:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 01:10:02] [training] Using single-device training
[2023-07-29 01:10:02] Synced seed 1234
[2023-07-29 01:10:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 01:10:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 01:10:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 01:10:02] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 01:10:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 01:10:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 01:10:02] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 01:10:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 01:10:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 01:10:03] [comm] Using global sharding
[2023-07-29 01:10:03] [comm] NCCLCommunicators constructed successfully
[2023-07-29 01:10:03] [training] Using 1 GPUs
[2023-07-29 01:10:03] [logits] Applying loss function for 1 factor(s)
[2023-07-29 01:10:03] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:10:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 01:10:04] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:46:54] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 01:46:54] [valid] No post-processing script given for validating translator
[2023-07-29 01:46:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 01:46:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 01:46:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 01:46:54] [comm] Using global sharding
[2023-07-29 01:46:54] [comm] NCCLCommunicators constructed successfully
[2023-07-29 01:46:54] [training] Using 1 GPUs
[2023-07-29 01:46:54] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 01:46:56] Allocating memory for general optimizer shards
[2023-07-29 01:46:56] [memory] Reserving 322 MB, device gpu0
[2023-07-29 01:46:56] Loading Adam parameters
[2023-07-29 01:46:56] [memory] Reserving 322 MB, device gpu0
[2023-07-29 01:46:56] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:46:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 01:46:56] [data] Restoring the corpus state to epoch 321, batch 12417
[2023-07-29 01:46:56] [data] Shuffling data
[2023-07-29 01:46:56] [data] Done reading 20,192 sentences
[2023-07-29 01:46:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 01:46:57] Training started
[2023-07-29 01:46:57] Training finished
[2023-07-29 01:47:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 01:47:03] [marian] Running on node01.datos.cluster.uy as process 36544 with command line:
[2023-07-29 01:47:03] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 01:47:03] [config] after: 0e
[2023-07-29 01:47:03] [config] after-batches: 0
[2023-07-29 01:47:03] [config] after-epochs: 80
[2023-07-29 01:47:03] [config] all-caps-every: 0
[2023-07-29 01:47:03] [config] allow-unk: false
[2023-07-29 01:47:03] [config] authors: false
[2023-07-29 01:47:03] [config] beam-size: 12
[2023-07-29 01:47:03] [config] bert-class-symbol: "[CLS]"
[2023-07-29 01:47:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 01:47:03] [config] bert-masking-fraction: 0.15
[2023-07-29 01:47:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 01:47:03] [config] bert-train-type-embeddings: true
[2023-07-29 01:47:03] [config] bert-type-vocab-size: 2
[2023-07-29 01:47:03] [config] build-info: ""
[2023-07-29 01:47:03] [config] check-gradient-nan: false
[2023-07-29 01:47:03] [config] check-nan: false
[2023-07-29 01:47:03] [config] cite: false
[2023-07-29 01:47:03] [config] clip-norm: 1
[2023-07-29 01:47:03] [config] cost-scaling:
[2023-07-29 01:47:03] [config]   - 256.f
[2023-07-29 01:47:03] [config]   - 1000
[2023-07-29 01:47:03] [config]   - 2.f
[2023-07-29 01:47:03] [config]   - 256.f
[2023-07-29 01:47:03] [config] cost-type: ce-sum
[2023-07-29 01:47:03] [config] cpu-threads: 0
[2023-07-29 01:47:03] [config] data-threads: 8
[2023-07-29 01:47:03] [config] data-weighting: ""
[2023-07-29 01:47:03] [config] data-weighting-type: sentence
[2023-07-29 01:47:03] [config] dec-cell: gru
[2023-07-29 01:47:03] [config] dec-cell-base-depth: 2
[2023-07-29 01:47:03] [config] dec-cell-high-depth: 1
[2023-07-29 01:47:03] [config] dec-depth: 1
[2023-07-29 01:47:03] [config] devices:
[2023-07-29 01:47:03] [config]   - 0
[2023-07-29 01:47:03] [config] dim-emb: 512
[2023-07-29 01:47:03] [config] dim-rnn: 1024
[2023-07-29 01:47:03] [config] dim-vocabs:
[2023-07-29 01:47:03] [config]   - 16384
[2023-07-29 01:47:03] [config]   - 16384
[2023-07-29 01:47:03] [config] disp-first: 0
[2023-07-29 01:47:03] [config] disp-freq: 1000u
[2023-07-29 01:47:03] [config] disp-label-counts: true
[2023-07-29 01:47:03] [config] dropout-rnn: 0
[2023-07-29 01:47:03] [config] dropout-src: 0
[2023-07-29 01:47:03] [config] dropout-trg: 0
[2023-07-29 01:47:03] [config] dump-config: ""
[2023-07-29 01:47:03] [config] dynamic-gradient-scaling:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] early-stopping: 1000
[2023-07-29 01:47:03] [config] early-stopping-on: first
[2023-07-29 01:47:03] [config] embedding-fix-src: false
[2023-07-29 01:47:03] [config] embedding-fix-trg: false
[2023-07-29 01:47:03] [config] embedding-normalization: false
[2023-07-29 01:47:03] [config] embedding-vectors:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] enc-cell: gru
[2023-07-29 01:47:03] [config] enc-cell-depth: 1
[2023-07-29 01:47:03] [config] enc-depth: 1
[2023-07-29 01:47:03] [config] enc-type: bidirectional
[2023-07-29 01:47:03] [config] english-title-case-every: 0
[2023-07-29 01:47:03] [config] exponential-smoothing: 0
[2023-07-29 01:47:03] [config] factor-weight: 1
[2023-07-29 01:47:03] [config] factors-combine: sum
[2023-07-29 01:47:03] [config] factors-dim-emb: 0
[2023-07-29 01:47:03] [config] gradient-checkpointing: false
[2023-07-29 01:47:03] [config] gradient-norm-average-window: 100
[2023-07-29 01:47:03] [config] guided-alignment: none
[2023-07-29 01:47:03] [config] guided-alignment-cost: mse
[2023-07-29 01:47:03] [config] guided-alignment-weight: 0.1
[2023-07-29 01:47:03] [config] ignore-model-config: false
[2023-07-29 01:47:03] [config] input-types:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] interpolate-env-vars: false
[2023-07-29 01:47:03] [config] keep-best: false
[2023-07-29 01:47:03] [config] label-smoothing: 0
[2023-07-29 01:47:03] [config] layer-normalization: false
[2023-07-29 01:47:03] [config] learn-rate: 0.0001
[2023-07-29 01:47:03] [config] lemma-dependency: ""
[2023-07-29 01:47:03] [config] lemma-dim-emb: 0
[2023-07-29 01:47:03] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 01:47:03] [config] log-level: info
[2023-07-29 01:47:03] [config] log-time-zone: ""
[2023-07-29 01:47:03] [config] logical-epoch:
[2023-07-29 01:47:03] [config]   - 1e
[2023-07-29 01:47:03] [config]   - 0
[2023-07-29 01:47:03] [config] lr-decay: 0
[2023-07-29 01:47:03] [config] lr-decay-freq: 50000
[2023-07-29 01:47:03] [config] lr-decay-inv-sqrt:
[2023-07-29 01:47:03] [config]   - 0
[2023-07-29 01:47:03] [config] lr-decay-repeat-warmup: false
[2023-07-29 01:47:03] [config] lr-decay-reset-optimizer: false
[2023-07-29 01:47:03] [config] lr-decay-start:
[2023-07-29 01:47:03] [config]   - 10
[2023-07-29 01:47:03] [config]   - 1
[2023-07-29 01:47:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 01:47:03] [config] lr-report: false
[2023-07-29 01:47:03] [config] lr-warmup: 0
[2023-07-29 01:47:03] [config] lr-warmup-at-reload: false
[2023-07-29 01:47:03] [config] lr-warmup-cycle: false
[2023-07-29 01:47:03] [config] lr-warmup-start-rate: 0
[2023-07-29 01:47:03] [config] max-length: 250
[2023-07-29 01:47:03] [config] max-length-crop: true
[2023-07-29 01:47:03] [config] max-length-factor: 3
[2023-07-29 01:47:03] [config] maxi-batch: 100
[2023-07-29 01:47:03] [config] maxi-batch-sort: trg
[2023-07-29 01:47:03] [config] mini-batch: 64
[2023-07-29 01:47:03] [config] mini-batch-fit: true
[2023-07-29 01:47:03] [config] mini-batch-fit-step: 10
[2023-07-29 01:47:03] [config] mini-batch-round-up: true
[2023-07-29 01:47:03] [config] mini-batch-track-lr: false
[2023-07-29 01:47:03] [config] mini-batch-warmup: 0
[2023-07-29 01:47:03] [config] mini-batch-words: 0
[2023-07-29 01:47:03] [config] mini-batch-words-ref: 0
[2023-07-29 01:47:03] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 01:47:03] [config] multi-loss-type: sum
[2023-07-29 01:47:03] [config] n-best: false
[2023-07-29 01:47:03] [config] no-nccl: false
[2023-07-29 01:47:03] [config] no-reload: false
[2023-07-29 01:47:03] [config] no-restore-corpus: false
[2023-07-29 01:47:03] [config] normalize: 0
[2023-07-29 01:47:03] [config] normalize-gradient: false
[2023-07-29 01:47:03] [config] num-devices: 0
[2023-07-29 01:47:03] [config] optimizer: adam
[2023-07-29 01:47:03] [config] optimizer-delay: 1
[2023-07-29 01:47:03] [config] optimizer-params:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] output-omit-bias: false
[2023-07-29 01:47:03] [config] overwrite: true
[2023-07-29 01:47:03] [config] precision:
[2023-07-29 01:47:03] [config]   - float16
[2023-07-29 01:47:03] [config]   - float32
[2023-07-29 01:47:03] [config] pretrained-model: ""
[2023-07-29 01:47:03] [config] quantize-biases: false
[2023-07-29 01:47:03] [config] quantize-bits: 0
[2023-07-29 01:47:03] [config] quantize-log-based: false
[2023-07-29 01:47:03] [config] quantize-optimization-steps: 0
[2023-07-29 01:47:03] [config] quiet: false
[2023-07-29 01:47:03] [config] quiet-translation: true
[2023-07-29 01:47:03] [config] relative-paths: false
[2023-07-29 01:47:03] [config] right-left: false
[2023-07-29 01:47:03] [config] save-freq: 10000u
[2023-07-29 01:47:03] [config] seed: 1234
[2023-07-29 01:47:03] [config] sentencepiece-alphas:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] sentencepiece-max-lines: 2000000
[2023-07-29 01:47:03] [config] sentencepiece-options: ""
[2023-07-29 01:47:03] [config] sharding: global
[2023-07-29 01:47:03] [config] shuffle: data
[2023-07-29 01:47:03] [config] shuffle-in-ram: false
[2023-07-29 01:47:03] [config] sigterm: save-and-exit
[2023-07-29 01:47:03] [config] skip: false
[2023-07-29 01:47:03] [config] sqlite: ""
[2023-07-29 01:47:03] [config] sqlite-drop: false
[2023-07-29 01:47:03] [config] sync-freq: 200u
[2023-07-29 01:47:03] [config] sync-sgd: false
[2023-07-29 01:47:03] [config] tempdir: /tmp
[2023-07-29 01:47:03] [config] tied-embeddings: false
[2023-07-29 01:47:03] [config] tied-embeddings-all: true
[2023-07-29 01:47:03] [config] tied-embeddings-src: false
[2023-07-29 01:47:03] [config] train-embedder-rank:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] train-sets:
[2023-07-29 01:47:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 01:47:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 01:47:03] [config] transformer-aan-activation: swish
[2023-07-29 01:47:03] [config] transformer-aan-depth: 2
[2023-07-29 01:47:03] [config] transformer-aan-nogate: false
[2023-07-29 01:47:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 01:47:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 01:47:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 01:47:03] [config] transformer-depth-scaling: false
[2023-07-29 01:47:03] [config] transformer-dim-aan: 2048
[2023-07-29 01:47:03] [config] transformer-dim-ffn: 2048
[2023-07-29 01:47:03] [config] transformer-dropout: 0
[2023-07-29 01:47:03] [config] transformer-dropout-attention: 0
[2023-07-29 01:47:03] [config] transformer-dropout-ffn: 0
[2023-07-29 01:47:03] [config] transformer-ffn-activation: swish
[2023-07-29 01:47:03] [config] transformer-ffn-depth: 2
[2023-07-29 01:47:03] [config] transformer-guided-alignment-layer: last
[2023-07-29 01:47:03] [config] transformer-heads: 8
[2023-07-29 01:47:03] [config] transformer-no-projection: false
[2023-07-29 01:47:03] [config] transformer-pool: false
[2023-07-29 01:47:03] [config] transformer-postprocess: dan
[2023-07-29 01:47:03] [config] transformer-postprocess-emb: d
[2023-07-29 01:47:03] [config] transformer-postprocess-top: ""
[2023-07-29 01:47:03] [config] transformer-preprocess: ""
[2023-07-29 01:47:03] [config] transformer-tied-layers:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] transformer-train-position-embeddings: false
[2023-07-29 01:47:03] [config] tsv: false
[2023-07-29 01:47:03] [config] tsv-fields: 0
[2023-07-29 01:47:03] [config] type: s2s
[2023-07-29 01:47:03] [config] ulr: false
[2023-07-29 01:47:03] [config] ulr-dim-emb: 0
[2023-07-29 01:47:03] [config] ulr-dropout: 0
[2023-07-29 01:47:03] [config] ulr-keys-vectors: ""
[2023-07-29 01:47:03] [config] ulr-query-vectors: ""
[2023-07-29 01:47:03] [config] ulr-softmax-temperature: 1
[2023-07-29 01:47:03] [config] ulr-trainable-transformation: false
[2023-07-29 01:47:03] [config] unlikelihood-loss: false
[2023-07-29 01:47:03] [config] valid-freq: 50000000
[2023-07-29 01:47:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 01:47:03] [config] valid-max-length: 1000
[2023-07-29 01:47:03] [config] valid-metrics:
[2023-07-29 01:47:03] [config]   - translation
[2023-07-29 01:47:03] [config] valid-mini-batch: 32
[2023-07-29 01:47:03] [config] valid-reset-stalled: false
[2023-07-29 01:47:03] [config] valid-script-args:
[2023-07-29 01:47:03] [config]   []
[2023-07-29 01:47:03] [config] valid-script-path: ""
[2023-07-29 01:47:03] [config] valid-sets:
[2023-07-29 01:47:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 01:47:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 01:47:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 01:47:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 01:47:03] [config] vocabs:
[2023-07-29 01:47:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 01:47:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 01:47:03] [config] word-penalty: 0
[2023-07-29 01:47:03] [config] word-scores: false
[2023-07-29 01:47:03] [config] workspace: 5500
[2023-07-29 01:47:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 01:47:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 01:47:03] [training] Using single-device training
[2023-07-29 01:47:03] Synced seed 1234
[2023-07-29 01:47:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 01:47:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 01:47:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 01:47:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 01:47:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 01:47:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 01:47:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 01:47:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 01:47:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 01:47:05] [comm] Using global sharding
[2023-07-29 01:47:05] [comm] NCCLCommunicators constructed successfully
[2023-07-29 01:47:05] [training] Using 1 GPUs
[2023-07-29 01:47:05] [logits] Applying loss function for 1 factor(s)
[2023-07-29 01:47:05] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:47:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 01:47:05] [memory] Reserving 80 MB, device gpu0
[2023-07-29 02:23:54] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 02:23:54] [valid] No post-processing script given for validating translator
[2023-07-29 02:23:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 02:23:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 02:23:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 02:23:54] [comm] Using global sharding
[2023-07-29 02:23:54] [comm] NCCLCommunicators constructed successfully
[2023-07-29 02:23:54] [training] Using 1 GPUs
[2023-07-29 02:23:54] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 02:23:59] Allocating memory for general optimizer shards
[2023-07-29 02:23:59] [memory] Reserving 322 MB, device gpu0
[2023-07-29 02:23:59] Loading Adam parameters
[2023-07-29 02:23:59] [memory] Reserving 322 MB, device gpu0
[2023-07-29 02:23:59] [memory] Reserving 80 MB, device gpu0
[2023-07-29 02:23:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 02:23:59] [data] Restoring the corpus state to epoch 321, batch 12417
[2023-07-29 02:23:59] [data] Shuffling data
[2023-07-29 02:24:00] [data] Done reading 20,192 sentences
[2023-07-29 02:24:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 02:24:00] Training started
[2023-07-29 02:24:00] Training finished
[2023-07-29 02:24:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 02:24:05] [marian] Running on node01.datos.cluster.uy as process 38926 with command line:
[2023-07-29 02:24:05] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 02:24:05] [config] after: 0e
[2023-07-29 02:24:05] [config] after-batches: 0
[2023-07-29 02:24:05] [config] after-epochs: 90
[2023-07-29 02:24:05] [config] all-caps-every: 0
[2023-07-29 02:24:05] [config] allow-unk: false
[2023-07-29 02:24:05] [config] authors: false
[2023-07-29 02:24:05] [config] beam-size: 12
[2023-07-29 02:24:05] [config] bert-class-symbol: "[CLS]"
[2023-07-29 02:24:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 02:24:05] [config] bert-masking-fraction: 0.15
[2023-07-29 02:24:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 02:24:05] [config] bert-train-type-embeddings: true
[2023-07-29 02:24:05] [config] bert-type-vocab-size: 2
[2023-07-29 02:24:05] [config] build-info: ""
[2023-07-29 02:24:05] [config] check-gradient-nan: false
[2023-07-29 02:24:05] [config] check-nan: false
[2023-07-29 02:24:05] [config] cite: false
[2023-07-29 02:24:05] [config] clip-norm: 1
[2023-07-29 02:24:05] [config] cost-scaling:
[2023-07-29 02:24:05] [config]   - 256.f
[2023-07-29 02:24:05] [config]   - 1000
[2023-07-29 02:24:05] [config]   - 2.f
[2023-07-29 02:24:05] [config]   - 256.f
[2023-07-29 02:24:05] [config] cost-type: ce-sum
[2023-07-29 02:24:05] [config] cpu-threads: 0
[2023-07-29 02:24:05] [config] data-threads: 8
[2023-07-29 02:24:05] [config] data-weighting: ""
[2023-07-29 02:24:05] [config] data-weighting-type: sentence
[2023-07-29 02:24:05] [config] dec-cell: gru
[2023-07-29 02:24:05] [config] dec-cell-base-depth: 2
[2023-07-29 02:24:05] [config] dec-cell-high-depth: 1
[2023-07-29 02:24:05] [config] dec-depth: 1
[2023-07-29 02:24:05] [config] devices:
[2023-07-29 02:24:05] [config]   - 0
[2023-07-29 02:24:05] [config] dim-emb: 512
[2023-07-29 02:24:05] [config] dim-rnn: 1024
[2023-07-29 02:24:05] [config] dim-vocabs:
[2023-07-29 02:24:05] [config]   - 16384
[2023-07-29 02:24:05] [config]   - 16384
[2023-07-29 02:24:05] [config] disp-first: 0
[2023-07-29 02:24:05] [config] disp-freq: 1000u
[2023-07-29 02:24:05] [config] disp-label-counts: true
[2023-07-29 02:24:05] [config] dropout-rnn: 0
[2023-07-29 02:24:05] [config] dropout-src: 0
[2023-07-29 02:24:05] [config] dropout-trg: 0
[2023-07-29 02:24:05] [config] dump-config: ""
[2023-07-29 02:24:05] [config] dynamic-gradient-scaling:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] early-stopping: 1000
[2023-07-29 02:24:05] [config] early-stopping-on: first
[2023-07-29 02:24:05] [config] embedding-fix-src: false
[2023-07-29 02:24:05] [config] embedding-fix-trg: false
[2023-07-29 02:24:05] [config] embedding-normalization: false
[2023-07-29 02:24:05] [config] embedding-vectors:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] enc-cell: gru
[2023-07-29 02:24:05] [config] enc-cell-depth: 1
[2023-07-29 02:24:05] [config] enc-depth: 1
[2023-07-29 02:24:05] [config] enc-type: bidirectional
[2023-07-29 02:24:05] [config] english-title-case-every: 0
[2023-07-29 02:24:05] [config] exponential-smoothing: 0
[2023-07-29 02:24:05] [config] factor-weight: 1
[2023-07-29 02:24:05] [config] factors-combine: sum
[2023-07-29 02:24:05] [config] factors-dim-emb: 0
[2023-07-29 02:24:05] [config] gradient-checkpointing: false
[2023-07-29 02:24:05] [config] gradient-norm-average-window: 100
[2023-07-29 02:24:05] [config] guided-alignment: none
[2023-07-29 02:24:05] [config] guided-alignment-cost: mse
[2023-07-29 02:24:05] [config] guided-alignment-weight: 0.1
[2023-07-29 02:24:05] [config] ignore-model-config: false
[2023-07-29 02:24:05] [config] input-types:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] interpolate-env-vars: false
[2023-07-29 02:24:05] [config] keep-best: false
[2023-07-29 02:24:05] [config] label-smoothing: 0
[2023-07-29 02:24:05] [config] layer-normalization: false
[2023-07-29 02:24:05] [config] learn-rate: 0.0001
[2023-07-29 02:24:05] [config] lemma-dependency: ""
[2023-07-29 02:24:05] [config] lemma-dim-emb: 0
[2023-07-29 02:24:05] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 02:24:05] [config] log-level: info
[2023-07-29 02:24:05] [config] log-time-zone: ""
[2023-07-29 02:24:05] [config] logical-epoch:
[2023-07-29 02:24:05] [config]   - 1e
[2023-07-29 02:24:05] [config]   - 0
[2023-07-29 02:24:05] [config] lr-decay: 0
[2023-07-29 02:24:05] [config] lr-decay-freq: 50000
[2023-07-29 02:24:05] [config] lr-decay-inv-sqrt:
[2023-07-29 02:24:05] [config]   - 0
[2023-07-29 02:24:05] [config] lr-decay-repeat-warmup: false
[2023-07-29 02:24:05] [config] lr-decay-reset-optimizer: false
[2023-07-29 02:24:05] [config] lr-decay-start:
[2023-07-29 02:24:05] [config]   - 10
[2023-07-29 02:24:05] [config]   - 1
[2023-07-29 02:24:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 02:24:05] [config] lr-report: false
[2023-07-29 02:24:05] [config] lr-warmup: 0
[2023-07-29 02:24:05] [config] lr-warmup-at-reload: false
[2023-07-29 02:24:05] [config] lr-warmup-cycle: false
[2023-07-29 02:24:05] [config] lr-warmup-start-rate: 0
[2023-07-29 02:24:05] [config] max-length: 250
[2023-07-29 02:24:05] [config] max-length-crop: true
[2023-07-29 02:24:05] [config] max-length-factor: 3
[2023-07-29 02:24:05] [config] maxi-batch: 100
[2023-07-29 02:24:05] [config] maxi-batch-sort: trg
[2023-07-29 02:24:05] [config] mini-batch: 64
[2023-07-29 02:24:05] [config] mini-batch-fit: true
[2023-07-29 02:24:05] [config] mini-batch-fit-step: 10
[2023-07-29 02:24:05] [config] mini-batch-round-up: true
[2023-07-29 02:24:05] [config] mini-batch-track-lr: false
[2023-07-29 02:24:05] [config] mini-batch-warmup: 0
[2023-07-29 02:24:05] [config] mini-batch-words: 0
[2023-07-29 02:24:05] [config] mini-batch-words-ref: 0
[2023-07-29 02:24:05] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 02:24:05] [config] multi-loss-type: sum
[2023-07-29 02:24:05] [config] n-best: false
[2023-07-29 02:24:05] [config] no-nccl: false
[2023-07-29 02:24:05] [config] no-reload: false
[2023-07-29 02:24:05] [config] no-restore-corpus: false
[2023-07-29 02:24:05] [config] normalize: 0
[2023-07-29 02:24:05] [config] normalize-gradient: false
[2023-07-29 02:24:05] [config] num-devices: 0
[2023-07-29 02:24:05] [config] optimizer: adam
[2023-07-29 02:24:05] [config] optimizer-delay: 1
[2023-07-29 02:24:05] [config] optimizer-params:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] output-omit-bias: false
[2023-07-29 02:24:05] [config] overwrite: true
[2023-07-29 02:24:05] [config] precision:
[2023-07-29 02:24:05] [config]   - float16
[2023-07-29 02:24:05] [config]   - float32
[2023-07-29 02:24:05] [config] pretrained-model: ""
[2023-07-29 02:24:05] [config] quantize-biases: false
[2023-07-29 02:24:05] [config] quantize-bits: 0
[2023-07-29 02:24:05] [config] quantize-log-based: false
[2023-07-29 02:24:05] [config] quantize-optimization-steps: 0
[2023-07-29 02:24:05] [config] quiet: false
[2023-07-29 02:24:05] [config] quiet-translation: true
[2023-07-29 02:24:05] [config] relative-paths: false
[2023-07-29 02:24:05] [config] right-left: false
[2023-07-29 02:24:05] [config] save-freq: 10000u
[2023-07-29 02:24:05] [config] seed: 1234
[2023-07-29 02:24:05] [config] sentencepiece-alphas:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] sentencepiece-max-lines: 2000000
[2023-07-29 02:24:05] [config] sentencepiece-options: ""
[2023-07-29 02:24:05] [config] sharding: global
[2023-07-29 02:24:05] [config] shuffle: data
[2023-07-29 02:24:05] [config] shuffle-in-ram: false
[2023-07-29 02:24:05] [config] sigterm: save-and-exit
[2023-07-29 02:24:05] [config] skip: false
[2023-07-29 02:24:05] [config] sqlite: ""
[2023-07-29 02:24:05] [config] sqlite-drop: false
[2023-07-29 02:24:05] [config] sync-freq: 200u
[2023-07-29 02:24:05] [config] sync-sgd: false
[2023-07-29 02:24:05] [config] tempdir: /tmp
[2023-07-29 02:24:05] [config] tied-embeddings: false
[2023-07-29 02:24:05] [config] tied-embeddings-all: true
[2023-07-29 02:24:05] [config] tied-embeddings-src: false
[2023-07-29 02:24:05] [config] train-embedder-rank:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] train-sets:
[2023-07-29 02:24:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 02:24:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 02:24:05] [config] transformer-aan-activation: swish
[2023-07-29 02:24:05] [config] transformer-aan-depth: 2
[2023-07-29 02:24:05] [config] transformer-aan-nogate: false
[2023-07-29 02:24:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 02:24:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 02:24:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 02:24:05] [config] transformer-depth-scaling: false
[2023-07-29 02:24:05] [config] transformer-dim-aan: 2048
[2023-07-29 02:24:05] [config] transformer-dim-ffn: 2048
[2023-07-29 02:24:05] [config] transformer-dropout: 0
[2023-07-29 02:24:05] [config] transformer-dropout-attention: 0
[2023-07-29 02:24:05] [config] transformer-dropout-ffn: 0
[2023-07-29 02:24:05] [config] transformer-ffn-activation: swish
[2023-07-29 02:24:05] [config] transformer-ffn-depth: 2
[2023-07-29 02:24:05] [config] transformer-guided-alignment-layer: last
[2023-07-29 02:24:05] [config] transformer-heads: 8
[2023-07-29 02:24:05] [config] transformer-no-projection: false
[2023-07-29 02:24:05] [config] transformer-pool: false
[2023-07-29 02:24:05] [config] transformer-postprocess: dan
[2023-07-29 02:24:05] [config] transformer-postprocess-emb: d
[2023-07-29 02:24:05] [config] transformer-postprocess-top: ""
[2023-07-29 02:24:05] [config] transformer-preprocess: ""
[2023-07-29 02:24:05] [config] transformer-tied-layers:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] transformer-train-position-embeddings: false
[2023-07-29 02:24:05] [config] tsv: false
[2023-07-29 02:24:05] [config] tsv-fields: 0
[2023-07-29 02:24:05] [config] type: s2s
[2023-07-29 02:24:05] [config] ulr: false
[2023-07-29 02:24:05] [config] ulr-dim-emb: 0
[2023-07-29 02:24:05] [config] ulr-dropout: 0
[2023-07-29 02:24:05] [config] ulr-keys-vectors: ""
[2023-07-29 02:24:05] [config] ulr-query-vectors: ""
[2023-07-29 02:24:05] [config] ulr-softmax-temperature: 1
[2023-07-29 02:24:05] [config] ulr-trainable-transformation: false
[2023-07-29 02:24:05] [config] unlikelihood-loss: false
[2023-07-29 02:24:05] [config] valid-freq: 50000000
[2023-07-29 02:24:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 02:24:05] [config] valid-max-length: 1000
[2023-07-29 02:24:05] [config] valid-metrics:
[2023-07-29 02:24:05] [config]   - translation
[2023-07-29 02:24:05] [config] valid-mini-batch: 32
[2023-07-29 02:24:05] [config] valid-reset-stalled: false
[2023-07-29 02:24:05] [config] valid-script-args:
[2023-07-29 02:24:05] [config]   []
[2023-07-29 02:24:05] [config] valid-script-path: ""
[2023-07-29 02:24:05] [config] valid-sets:
[2023-07-29 02:24:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 02:24:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 02:24:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 02:24:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 02:24:05] [config] vocabs:
[2023-07-29 02:24:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 02:24:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 02:24:05] [config] word-penalty: 0
[2023-07-29 02:24:05] [config] word-scores: false
[2023-07-29 02:24:05] [config] workspace: 5500
[2023-07-29 02:24:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 02:24:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 02:24:05] [training] Using single-device training
[2023-07-29 02:24:06] Synced seed 1234
[2023-07-29 02:24:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 02:24:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 02:24:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 02:24:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 02:24:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 02:24:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 02:24:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 02:24:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 02:24:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 02:24:07] [comm] Using global sharding
[2023-07-29 02:24:07] [comm] NCCLCommunicators constructed successfully
[2023-07-29 02:24:07] [training] Using 1 GPUs
[2023-07-29 02:24:07] [logits] Applying loss function for 1 factor(s)
[2023-07-29 02:24:07] [memory] Reserving 80 MB, device gpu0
[2023-07-29 02:24:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 02:24:07] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:00:56] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 03:00:56] [valid] No post-processing script given for validating translator
[2023-07-29 03:00:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 03:00:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 03:00:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 03:00:56] [comm] Using global sharding
[2023-07-29 03:00:56] [comm] NCCLCommunicators constructed successfully
[2023-07-29 03:00:56] [training] Using 1 GPUs
[2023-07-29 03:00:56] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 03:00:58] Allocating memory for general optimizer shards
[2023-07-29 03:00:58] [memory] Reserving 322 MB, device gpu0
[2023-07-29 03:00:58] Loading Adam parameters
[2023-07-29 03:00:58] [memory] Reserving 322 MB, device gpu0
[2023-07-29 03:00:58] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:00:58] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 03:00:58] [data] Restoring the corpus state to epoch 331, batch 12806
[2023-07-29 03:00:58] [data] Shuffling data
[2023-07-29 03:00:58] [data] Done reading 20,192 sentences
[2023-07-29 03:00:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:00:58] Training started
[2023-07-29 03:00:58] Training finished
[2023-07-29 03:01:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 03:01:01] [marian] Running on node01.datos.cluster.uy as process 654 with command line:
[2023-07-29 03:01:01] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 03:01:01] [config] after: 0e
[2023-07-29 03:01:01] [config] after-batches: 0
[2023-07-29 03:01:01] [config] after-epochs: 100
[2023-07-29 03:01:01] [config] all-caps-every: 0
[2023-07-29 03:01:01] [config] allow-unk: false
[2023-07-29 03:01:01] [config] authors: false
[2023-07-29 03:01:01] [config] beam-size: 12
[2023-07-29 03:01:01] [config] bert-class-symbol: "[CLS]"
[2023-07-29 03:01:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 03:01:01] [config] bert-masking-fraction: 0.15
[2023-07-29 03:01:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 03:01:01] [config] bert-train-type-embeddings: true
[2023-07-29 03:01:01] [config] bert-type-vocab-size: 2
[2023-07-29 03:01:01] [config] build-info: ""
[2023-07-29 03:01:01] [config] check-gradient-nan: false
[2023-07-29 03:01:01] [config] check-nan: false
[2023-07-29 03:01:01] [config] cite: false
[2023-07-29 03:01:01] [config] clip-norm: 1
[2023-07-29 03:01:01] [config] cost-scaling:
[2023-07-29 03:01:01] [config]   - 256.f
[2023-07-29 03:01:01] [config]   - 1000
[2023-07-29 03:01:01] [config]   - 2.f
[2023-07-29 03:01:01] [config]   - 256.f
[2023-07-29 03:01:01] [config] cost-type: ce-sum
[2023-07-29 03:01:01] [config] cpu-threads: 0
[2023-07-29 03:01:01] [config] data-threads: 8
[2023-07-29 03:01:01] [config] data-weighting: ""
[2023-07-29 03:01:01] [config] data-weighting-type: sentence
[2023-07-29 03:01:01] [config] dec-cell: gru
[2023-07-29 03:01:01] [config] dec-cell-base-depth: 2
[2023-07-29 03:01:01] [config] dec-cell-high-depth: 1
[2023-07-29 03:01:01] [config] dec-depth: 1
[2023-07-29 03:01:01] [config] devices:
[2023-07-29 03:01:01] [config]   - 0
[2023-07-29 03:01:01] [config] dim-emb: 512
[2023-07-29 03:01:01] [config] dim-rnn: 1024
[2023-07-29 03:01:01] [config] dim-vocabs:
[2023-07-29 03:01:01] [config]   - 16384
[2023-07-29 03:01:01] [config]   - 16384
[2023-07-29 03:01:01] [config] disp-first: 0
[2023-07-29 03:01:01] [config] disp-freq: 1000u
[2023-07-29 03:01:01] [config] disp-label-counts: true
[2023-07-29 03:01:01] [config] dropout-rnn: 0
[2023-07-29 03:01:01] [config] dropout-src: 0
[2023-07-29 03:01:01] [config] dropout-trg: 0
[2023-07-29 03:01:01] [config] dump-config: ""
[2023-07-29 03:01:01] [config] dynamic-gradient-scaling:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] early-stopping: 1000
[2023-07-29 03:01:01] [config] early-stopping-on: first
[2023-07-29 03:01:01] [config] embedding-fix-src: false
[2023-07-29 03:01:01] [config] embedding-fix-trg: false
[2023-07-29 03:01:01] [config] embedding-normalization: false
[2023-07-29 03:01:01] [config] embedding-vectors:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] enc-cell: gru
[2023-07-29 03:01:01] [config] enc-cell-depth: 1
[2023-07-29 03:01:01] [config] enc-depth: 1
[2023-07-29 03:01:01] [config] enc-type: bidirectional
[2023-07-29 03:01:01] [config] english-title-case-every: 0
[2023-07-29 03:01:01] [config] exponential-smoothing: 0
[2023-07-29 03:01:01] [config] factor-weight: 1
[2023-07-29 03:01:01] [config] factors-combine: sum
[2023-07-29 03:01:01] [config] factors-dim-emb: 0
[2023-07-29 03:01:01] [config] gradient-checkpointing: false
[2023-07-29 03:01:01] [config] gradient-norm-average-window: 100
[2023-07-29 03:01:01] [config] guided-alignment: none
[2023-07-29 03:01:01] [config] guided-alignment-cost: mse
[2023-07-29 03:01:01] [config] guided-alignment-weight: 0.1
[2023-07-29 03:01:01] [config] ignore-model-config: false
[2023-07-29 03:01:01] [config] input-types:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] interpolate-env-vars: false
[2023-07-29 03:01:01] [config] keep-best: false
[2023-07-29 03:01:01] [config] label-smoothing: 0
[2023-07-29 03:01:01] [config] layer-normalization: false
[2023-07-29 03:01:01] [config] learn-rate: 0.0001
[2023-07-29 03:01:01] [config] lemma-dependency: ""
[2023-07-29 03:01:01] [config] lemma-dim-emb: 0
[2023-07-29 03:01:01] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 03:01:01] [config] log-level: info
[2023-07-29 03:01:01] [config] log-time-zone: ""
[2023-07-29 03:01:01] [config] logical-epoch:
[2023-07-29 03:01:01] [config]   - 1e
[2023-07-29 03:01:01] [config]   - 0
[2023-07-29 03:01:01] [config] lr-decay: 0
[2023-07-29 03:01:01] [config] lr-decay-freq: 50000
[2023-07-29 03:01:01] [config] lr-decay-inv-sqrt:
[2023-07-29 03:01:01] [config]   - 0
[2023-07-29 03:01:01] [config] lr-decay-repeat-warmup: false
[2023-07-29 03:01:01] [config] lr-decay-reset-optimizer: false
[2023-07-29 03:01:01] [config] lr-decay-start:
[2023-07-29 03:01:01] [config]   - 10
[2023-07-29 03:01:01] [config]   - 1
[2023-07-29 03:01:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 03:01:01] [config] lr-report: false
[2023-07-29 03:01:01] [config] lr-warmup: 0
[2023-07-29 03:01:01] [config] lr-warmup-at-reload: false
[2023-07-29 03:01:01] [config] lr-warmup-cycle: false
[2023-07-29 03:01:01] [config] lr-warmup-start-rate: 0
[2023-07-29 03:01:01] [config] max-length: 250
[2023-07-29 03:01:01] [config] max-length-crop: true
[2023-07-29 03:01:01] [config] max-length-factor: 3
[2023-07-29 03:01:01] [config] maxi-batch: 100
[2023-07-29 03:01:01] [config] maxi-batch-sort: trg
[2023-07-29 03:01:01] [config] mini-batch: 64
[2023-07-29 03:01:01] [config] mini-batch-fit: true
[2023-07-29 03:01:01] [config] mini-batch-fit-step: 10
[2023-07-29 03:01:01] [config] mini-batch-round-up: true
[2023-07-29 03:01:01] [config] mini-batch-track-lr: false
[2023-07-29 03:01:01] [config] mini-batch-warmup: 0
[2023-07-29 03:01:01] [config] mini-batch-words: 0
[2023-07-29 03:01:01] [config] mini-batch-words-ref: 0
[2023-07-29 03:01:01] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 03:01:01] [config] multi-loss-type: sum
[2023-07-29 03:01:01] [config] n-best: false
[2023-07-29 03:01:01] [config] no-nccl: false
[2023-07-29 03:01:01] [config] no-reload: false
[2023-07-29 03:01:01] [config] no-restore-corpus: false
[2023-07-29 03:01:01] [config] normalize: 0
[2023-07-29 03:01:01] [config] normalize-gradient: false
[2023-07-29 03:01:01] [config] num-devices: 0
[2023-07-29 03:01:01] [config] optimizer: adam
[2023-07-29 03:01:01] [config] optimizer-delay: 1
[2023-07-29 03:01:01] [config] optimizer-params:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] output-omit-bias: false
[2023-07-29 03:01:01] [config] overwrite: true
[2023-07-29 03:01:01] [config] precision:
[2023-07-29 03:01:01] [config]   - float16
[2023-07-29 03:01:01] [config]   - float32
[2023-07-29 03:01:01] [config] pretrained-model: ""
[2023-07-29 03:01:01] [config] quantize-biases: false
[2023-07-29 03:01:01] [config] quantize-bits: 0
[2023-07-29 03:01:01] [config] quantize-log-based: false
[2023-07-29 03:01:01] [config] quantize-optimization-steps: 0
[2023-07-29 03:01:01] [config] quiet: false
[2023-07-29 03:01:01] [config] quiet-translation: true
[2023-07-29 03:01:01] [config] relative-paths: false
[2023-07-29 03:01:01] [config] right-left: false
[2023-07-29 03:01:01] [config] save-freq: 10000u
[2023-07-29 03:01:01] [config] seed: 1234
[2023-07-29 03:01:01] [config] sentencepiece-alphas:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] sentencepiece-max-lines: 2000000
[2023-07-29 03:01:01] [config] sentencepiece-options: ""
[2023-07-29 03:01:01] [config] sharding: global
[2023-07-29 03:01:01] [config] shuffle: data
[2023-07-29 03:01:01] [config] shuffle-in-ram: false
[2023-07-29 03:01:01] [config] sigterm: save-and-exit
[2023-07-29 03:01:01] [config] skip: false
[2023-07-29 03:01:01] [config] sqlite: ""
[2023-07-29 03:01:01] [config] sqlite-drop: false
[2023-07-29 03:01:01] [config] sync-freq: 200u
[2023-07-29 03:01:01] [config] sync-sgd: false
[2023-07-29 03:01:01] [config] tempdir: /tmp
[2023-07-29 03:01:01] [config] tied-embeddings: false
[2023-07-29 03:01:01] [config] tied-embeddings-all: true
[2023-07-29 03:01:01] [config] tied-embeddings-src: false
[2023-07-29 03:01:01] [config] train-embedder-rank:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] train-sets:
[2023-07-29 03:01:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 03:01:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 03:01:01] [config] transformer-aan-activation: swish
[2023-07-29 03:01:01] [config] transformer-aan-depth: 2
[2023-07-29 03:01:01] [config] transformer-aan-nogate: false
[2023-07-29 03:01:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 03:01:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 03:01:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 03:01:01] [config] transformer-depth-scaling: false
[2023-07-29 03:01:01] [config] transformer-dim-aan: 2048
[2023-07-29 03:01:01] [config] transformer-dim-ffn: 2048
[2023-07-29 03:01:01] [config] transformer-dropout: 0
[2023-07-29 03:01:01] [config] transformer-dropout-attention: 0
[2023-07-29 03:01:01] [config] transformer-dropout-ffn: 0
[2023-07-29 03:01:01] [config] transformer-ffn-activation: swish
[2023-07-29 03:01:01] [config] transformer-ffn-depth: 2
[2023-07-29 03:01:01] [config] transformer-guided-alignment-layer: last
[2023-07-29 03:01:01] [config] transformer-heads: 8
[2023-07-29 03:01:01] [config] transformer-no-projection: false
[2023-07-29 03:01:01] [config] transformer-pool: false
[2023-07-29 03:01:01] [config] transformer-postprocess: dan
[2023-07-29 03:01:01] [config] transformer-postprocess-emb: d
[2023-07-29 03:01:01] [config] transformer-postprocess-top: ""
[2023-07-29 03:01:01] [config] transformer-preprocess: ""
[2023-07-29 03:01:01] [config] transformer-tied-layers:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] transformer-train-position-embeddings: false
[2023-07-29 03:01:01] [config] tsv: false
[2023-07-29 03:01:01] [config] tsv-fields: 0
[2023-07-29 03:01:01] [config] type: s2s
[2023-07-29 03:01:01] [config] ulr: false
[2023-07-29 03:01:01] [config] ulr-dim-emb: 0
[2023-07-29 03:01:01] [config] ulr-dropout: 0
[2023-07-29 03:01:01] [config] ulr-keys-vectors: ""
[2023-07-29 03:01:01] [config] ulr-query-vectors: ""
[2023-07-29 03:01:01] [config] ulr-softmax-temperature: 1
[2023-07-29 03:01:01] [config] ulr-trainable-transformation: false
[2023-07-29 03:01:01] [config] unlikelihood-loss: false
[2023-07-29 03:01:01] [config] valid-freq: 50000000
[2023-07-29 03:01:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 03:01:01] [config] valid-max-length: 1000
[2023-07-29 03:01:01] [config] valid-metrics:
[2023-07-29 03:01:01] [config]   - translation
[2023-07-29 03:01:01] [config] valid-mini-batch: 32
[2023-07-29 03:01:01] [config] valid-reset-stalled: false
[2023-07-29 03:01:01] [config] valid-script-args:
[2023-07-29 03:01:01] [config]   []
[2023-07-29 03:01:01] [config] valid-script-path: ""
[2023-07-29 03:01:01] [config] valid-sets:
[2023-07-29 03:01:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 03:01:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 03:01:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 03:01:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 03:01:01] [config] vocabs:
[2023-07-29 03:01:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 03:01:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 03:01:01] [config] word-penalty: 0
[2023-07-29 03:01:01] [config] word-scores: false
[2023-07-29 03:01:01] [config] workspace: 5500
[2023-07-29 03:01:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 03:01:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 03:01:01] [training] Using single-device training
[2023-07-29 03:01:02] Synced seed 1234
[2023-07-29 03:01:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 03:01:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 03:01:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 03:01:02] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 03:01:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 03:01:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 03:01:02] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 03:01:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 03:01:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 03:01:03] [comm] Using global sharding
[2023-07-29 03:01:03] [comm] NCCLCommunicators constructed successfully
[2023-07-29 03:01:03] [training] Using 1 GPUs
[2023-07-29 03:01:03] [logits] Applying loss function for 1 factor(s)
[2023-07-29 03:01:03] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:01:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 03:01:03] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:38:02] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 03:38:02] [valid] No post-processing script given for validating translator
[2023-07-29 03:38:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 03:38:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 03:38:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 03:38:02] [comm] Using global sharding
[2023-07-29 03:38:02] [comm] NCCLCommunicators constructed successfully
[2023-07-29 03:38:02] [training] Using 1 GPUs
[2023-07-29 03:38:02] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 03:38:03] Allocating memory for general optimizer shards
[2023-07-29 03:38:03] [memory] Reserving 322 MB, device gpu0
[2023-07-29 03:38:03] Loading Adam parameters
[2023-07-29 03:38:03] [memory] Reserving 322 MB, device gpu0
[2023-07-29 03:38:03] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:38:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 03:38:04] [data] Restoring the corpus state to epoch 331, batch 12806
[2023-07-29 03:38:04] [data] Shuffling data
[2023-07-29 03:38:04] [data] Done reading 20,192 sentences
[2023-07-29 03:38:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:38:04] Training started
[2023-07-29 03:38:04] Training finished
[2023-07-29 03:38:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 03:38:07] [marian] Running on node01.datos.cluster.uy as process 3440 with command line:
[2023-07-29 03:38:07] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 03:38:07] [config] after: 0e
[2023-07-29 03:38:07] [config] after-batches: 0
[2023-07-29 03:38:07] [config] after-epochs: 110
[2023-07-29 03:38:07] [config] all-caps-every: 0
[2023-07-29 03:38:07] [config] allow-unk: false
[2023-07-29 03:38:07] [config] authors: false
[2023-07-29 03:38:07] [config] beam-size: 12
[2023-07-29 03:38:07] [config] bert-class-symbol: "[CLS]"
[2023-07-29 03:38:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 03:38:07] [config] bert-masking-fraction: 0.15
[2023-07-29 03:38:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 03:38:07] [config] bert-train-type-embeddings: true
[2023-07-29 03:38:07] [config] bert-type-vocab-size: 2
[2023-07-29 03:38:07] [config] build-info: ""
[2023-07-29 03:38:07] [config] check-gradient-nan: false
[2023-07-29 03:38:07] [config] check-nan: false
[2023-07-29 03:38:07] [config] cite: false
[2023-07-29 03:38:07] [config] clip-norm: 1
[2023-07-29 03:38:07] [config] cost-scaling:
[2023-07-29 03:38:07] [config]   - 256.f
[2023-07-29 03:38:07] [config]   - 1000
[2023-07-29 03:38:07] [config]   - 2.f
[2023-07-29 03:38:07] [config]   - 256.f
[2023-07-29 03:38:07] [config] cost-type: ce-sum
[2023-07-29 03:38:07] [config] cpu-threads: 0
[2023-07-29 03:38:07] [config] data-threads: 8
[2023-07-29 03:38:07] [config] data-weighting: ""
[2023-07-29 03:38:07] [config] data-weighting-type: sentence
[2023-07-29 03:38:07] [config] dec-cell: gru
[2023-07-29 03:38:07] [config] dec-cell-base-depth: 2
[2023-07-29 03:38:07] [config] dec-cell-high-depth: 1
[2023-07-29 03:38:07] [config] dec-depth: 1
[2023-07-29 03:38:07] [config] devices:
[2023-07-29 03:38:07] [config]   - 0
[2023-07-29 03:38:07] [config] dim-emb: 512
[2023-07-29 03:38:07] [config] dim-rnn: 1024
[2023-07-29 03:38:07] [config] dim-vocabs:
[2023-07-29 03:38:07] [config]   - 16384
[2023-07-29 03:38:07] [config]   - 16384
[2023-07-29 03:38:07] [config] disp-first: 0
[2023-07-29 03:38:07] [config] disp-freq: 1000u
[2023-07-29 03:38:07] [config] disp-label-counts: true
[2023-07-29 03:38:07] [config] dropout-rnn: 0
[2023-07-29 03:38:07] [config] dropout-src: 0
[2023-07-29 03:38:07] [config] dropout-trg: 0
[2023-07-29 03:38:07] [config] dump-config: ""
[2023-07-29 03:38:07] [config] dynamic-gradient-scaling:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] early-stopping: 1000
[2023-07-29 03:38:07] [config] early-stopping-on: first
[2023-07-29 03:38:07] [config] embedding-fix-src: false
[2023-07-29 03:38:07] [config] embedding-fix-trg: false
[2023-07-29 03:38:07] [config] embedding-normalization: false
[2023-07-29 03:38:07] [config] embedding-vectors:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] enc-cell: gru
[2023-07-29 03:38:07] [config] enc-cell-depth: 1
[2023-07-29 03:38:07] [config] enc-depth: 1
[2023-07-29 03:38:07] [config] enc-type: bidirectional
[2023-07-29 03:38:07] [config] english-title-case-every: 0
[2023-07-29 03:38:07] [config] exponential-smoothing: 0
[2023-07-29 03:38:07] [config] factor-weight: 1
[2023-07-29 03:38:07] [config] factors-combine: sum
[2023-07-29 03:38:07] [config] factors-dim-emb: 0
[2023-07-29 03:38:07] [config] gradient-checkpointing: false
[2023-07-29 03:38:07] [config] gradient-norm-average-window: 100
[2023-07-29 03:38:07] [config] guided-alignment: none
[2023-07-29 03:38:07] [config] guided-alignment-cost: mse
[2023-07-29 03:38:07] [config] guided-alignment-weight: 0.1
[2023-07-29 03:38:07] [config] ignore-model-config: false
[2023-07-29 03:38:07] [config] input-types:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] interpolate-env-vars: false
[2023-07-29 03:38:07] [config] keep-best: false
[2023-07-29 03:38:07] [config] label-smoothing: 0
[2023-07-29 03:38:07] [config] layer-normalization: false
[2023-07-29 03:38:07] [config] learn-rate: 0.0001
[2023-07-29 03:38:07] [config] lemma-dependency: ""
[2023-07-29 03:38:07] [config] lemma-dim-emb: 0
[2023-07-29 03:38:07] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 03:38:07] [config] log-level: info
[2023-07-29 03:38:07] [config] log-time-zone: ""
[2023-07-29 03:38:07] [config] logical-epoch:
[2023-07-29 03:38:07] [config]   - 1e
[2023-07-29 03:38:07] [config]   - 0
[2023-07-29 03:38:07] [config] lr-decay: 0
[2023-07-29 03:38:07] [config] lr-decay-freq: 50000
[2023-07-29 03:38:07] [config] lr-decay-inv-sqrt:
[2023-07-29 03:38:07] [config]   - 0
[2023-07-29 03:38:07] [config] lr-decay-repeat-warmup: false
[2023-07-29 03:38:07] [config] lr-decay-reset-optimizer: false
[2023-07-29 03:38:07] [config] lr-decay-start:
[2023-07-29 03:38:07] [config]   - 10
[2023-07-29 03:38:07] [config]   - 1
[2023-07-29 03:38:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 03:38:07] [config] lr-report: false
[2023-07-29 03:38:07] [config] lr-warmup: 0
[2023-07-29 03:38:07] [config] lr-warmup-at-reload: false
[2023-07-29 03:38:07] [config] lr-warmup-cycle: false
[2023-07-29 03:38:07] [config] lr-warmup-start-rate: 0
[2023-07-29 03:38:07] [config] max-length: 250
[2023-07-29 03:38:07] [config] max-length-crop: true
[2023-07-29 03:38:07] [config] max-length-factor: 3
[2023-07-29 03:38:07] [config] maxi-batch: 100
[2023-07-29 03:38:07] [config] maxi-batch-sort: trg
[2023-07-29 03:38:07] [config] mini-batch: 64
[2023-07-29 03:38:07] [config] mini-batch-fit: true
[2023-07-29 03:38:07] [config] mini-batch-fit-step: 10
[2023-07-29 03:38:07] [config] mini-batch-round-up: true
[2023-07-29 03:38:07] [config] mini-batch-track-lr: false
[2023-07-29 03:38:07] [config] mini-batch-warmup: 0
[2023-07-29 03:38:07] [config] mini-batch-words: 0
[2023-07-29 03:38:07] [config] mini-batch-words-ref: 0
[2023-07-29 03:38:07] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 03:38:07] [config] multi-loss-type: sum
[2023-07-29 03:38:07] [config] n-best: false
[2023-07-29 03:38:07] [config] no-nccl: false
[2023-07-29 03:38:07] [config] no-reload: false
[2023-07-29 03:38:07] [config] no-restore-corpus: false
[2023-07-29 03:38:07] [config] normalize: 0
[2023-07-29 03:38:07] [config] normalize-gradient: false
[2023-07-29 03:38:07] [config] num-devices: 0
[2023-07-29 03:38:07] [config] optimizer: adam
[2023-07-29 03:38:07] [config] optimizer-delay: 1
[2023-07-29 03:38:07] [config] optimizer-params:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] output-omit-bias: false
[2023-07-29 03:38:07] [config] overwrite: true
[2023-07-29 03:38:07] [config] precision:
[2023-07-29 03:38:07] [config]   - float16
[2023-07-29 03:38:07] [config]   - float32
[2023-07-29 03:38:07] [config] pretrained-model: ""
[2023-07-29 03:38:07] [config] quantize-biases: false
[2023-07-29 03:38:07] [config] quantize-bits: 0
[2023-07-29 03:38:07] [config] quantize-log-based: false
[2023-07-29 03:38:07] [config] quantize-optimization-steps: 0
[2023-07-29 03:38:07] [config] quiet: false
[2023-07-29 03:38:07] [config] quiet-translation: true
[2023-07-29 03:38:07] [config] relative-paths: false
[2023-07-29 03:38:07] [config] right-left: false
[2023-07-29 03:38:07] [config] save-freq: 10000u
[2023-07-29 03:38:07] [config] seed: 1234
[2023-07-29 03:38:07] [config] sentencepiece-alphas:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] sentencepiece-max-lines: 2000000
[2023-07-29 03:38:07] [config] sentencepiece-options: ""
[2023-07-29 03:38:07] [config] sharding: global
[2023-07-29 03:38:07] [config] shuffle: data
[2023-07-29 03:38:07] [config] shuffle-in-ram: false
[2023-07-29 03:38:07] [config] sigterm: save-and-exit
[2023-07-29 03:38:07] [config] skip: false
[2023-07-29 03:38:07] [config] sqlite: ""
[2023-07-29 03:38:07] [config] sqlite-drop: false
[2023-07-29 03:38:07] [config] sync-freq: 200u
[2023-07-29 03:38:07] [config] sync-sgd: false
[2023-07-29 03:38:07] [config] tempdir: /tmp
[2023-07-29 03:38:07] [config] tied-embeddings: false
[2023-07-29 03:38:07] [config] tied-embeddings-all: true
[2023-07-29 03:38:07] [config] tied-embeddings-src: false
[2023-07-29 03:38:07] [config] train-embedder-rank:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] train-sets:
[2023-07-29 03:38:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 03:38:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 03:38:07] [config] transformer-aan-activation: swish
[2023-07-29 03:38:07] [config] transformer-aan-depth: 2
[2023-07-29 03:38:07] [config] transformer-aan-nogate: false
[2023-07-29 03:38:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 03:38:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 03:38:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 03:38:07] [config] transformer-depth-scaling: false
[2023-07-29 03:38:07] [config] transformer-dim-aan: 2048
[2023-07-29 03:38:07] [config] transformer-dim-ffn: 2048
[2023-07-29 03:38:07] [config] transformer-dropout: 0
[2023-07-29 03:38:07] [config] transformer-dropout-attention: 0
[2023-07-29 03:38:07] [config] transformer-dropout-ffn: 0
[2023-07-29 03:38:07] [config] transformer-ffn-activation: swish
[2023-07-29 03:38:07] [config] transformer-ffn-depth: 2
[2023-07-29 03:38:07] [config] transformer-guided-alignment-layer: last
[2023-07-29 03:38:07] [config] transformer-heads: 8
[2023-07-29 03:38:07] [config] transformer-no-projection: false
[2023-07-29 03:38:07] [config] transformer-pool: false
[2023-07-29 03:38:07] [config] transformer-postprocess: dan
[2023-07-29 03:38:07] [config] transformer-postprocess-emb: d
[2023-07-29 03:38:07] [config] transformer-postprocess-top: ""
[2023-07-29 03:38:07] [config] transformer-preprocess: ""
[2023-07-29 03:38:07] [config] transformer-tied-layers:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] transformer-train-position-embeddings: false
[2023-07-29 03:38:07] [config] tsv: false
[2023-07-29 03:38:07] [config] tsv-fields: 0
[2023-07-29 03:38:07] [config] type: s2s
[2023-07-29 03:38:07] [config] ulr: false
[2023-07-29 03:38:07] [config] ulr-dim-emb: 0
[2023-07-29 03:38:07] [config] ulr-dropout: 0
[2023-07-29 03:38:07] [config] ulr-keys-vectors: ""
[2023-07-29 03:38:07] [config] ulr-query-vectors: ""
[2023-07-29 03:38:07] [config] ulr-softmax-temperature: 1
[2023-07-29 03:38:07] [config] ulr-trainable-transformation: false
[2023-07-29 03:38:07] [config] unlikelihood-loss: false
[2023-07-29 03:38:07] [config] valid-freq: 50000000
[2023-07-29 03:38:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 03:38:07] [config] valid-max-length: 1000
[2023-07-29 03:38:07] [config] valid-metrics:
[2023-07-29 03:38:07] [config]   - translation
[2023-07-29 03:38:07] [config] valid-mini-batch: 32
[2023-07-29 03:38:07] [config] valid-reset-stalled: false
[2023-07-29 03:38:07] [config] valid-script-args:
[2023-07-29 03:38:07] [config]   []
[2023-07-29 03:38:07] [config] valid-script-path: ""
[2023-07-29 03:38:07] [config] valid-sets:
[2023-07-29 03:38:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 03:38:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 03:38:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 03:38:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 03:38:07] [config] vocabs:
[2023-07-29 03:38:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 03:38:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 03:38:07] [config] word-penalty: 0
[2023-07-29 03:38:07] [config] word-scores: false
[2023-07-29 03:38:07] [config] workspace: 5500
[2023-07-29 03:38:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 03:38:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 03:38:07] [training] Using single-device training
[2023-07-29 03:38:08] Synced seed 1234
[2023-07-29 03:38:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 03:38:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 03:38:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 03:38:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 03:38:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 03:38:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 03:38:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 03:38:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 03:38:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 03:38:09] [comm] Using global sharding
[2023-07-29 03:38:09] [comm] NCCLCommunicators constructed successfully
[2023-07-29 03:38:09] [training] Using 1 GPUs
[2023-07-29 03:38:09] [logits] Applying loss function for 1 factor(s)
[2023-07-29 03:38:09] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:38:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 03:38:09] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:14:59] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 04:14:59] [valid] No post-processing script given for validating translator
[2023-07-29 04:14:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:14:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 04:14:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 04:14:59] [comm] Using global sharding
[2023-07-29 04:14:59] [comm] NCCLCommunicators constructed successfully
[2023-07-29 04:14:59] [training] Using 1 GPUs
[2023-07-29 04:14:59] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 04:15:00] Allocating memory for general optimizer shards
[2023-07-29 04:15:00] [memory] Reserving 322 MB, device gpu0
[2023-07-29 04:15:00] Loading Adam parameters
[2023-07-29 04:15:00] [memory] Reserving 322 MB, device gpu0
[2023-07-29 04:15:01] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:15:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 04:15:01] [data] Restoring the corpus state to epoch 341, batch 13197
[2023-07-29 04:15:01] [data] Shuffling data
[2023-07-29 04:15:01] [data] Done reading 20,192 sentences
[2023-07-29 04:15:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 04:15:01] Training started
[2023-07-29 04:15:01] Training finished
[2023-07-29 04:15:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:15:04] [marian] Running on node01.datos.cluster.uy as process 6101 with command line:
[2023-07-29 04:15:04] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 04:15:04] [config] after: 0e
[2023-07-29 04:15:04] [config] after-batches: 0
[2023-07-29 04:15:04] [config] after-epochs: 120
[2023-07-29 04:15:04] [config] all-caps-every: 0
[2023-07-29 04:15:04] [config] allow-unk: false
[2023-07-29 04:15:04] [config] authors: false
[2023-07-29 04:15:04] [config] beam-size: 12
[2023-07-29 04:15:04] [config] bert-class-symbol: "[CLS]"
[2023-07-29 04:15:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 04:15:04] [config] bert-masking-fraction: 0.15
[2023-07-29 04:15:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 04:15:04] [config] bert-train-type-embeddings: true
[2023-07-29 04:15:04] [config] bert-type-vocab-size: 2
[2023-07-29 04:15:04] [config] build-info: ""
[2023-07-29 04:15:04] [config] check-gradient-nan: false
[2023-07-29 04:15:04] [config] check-nan: false
[2023-07-29 04:15:04] [config] cite: false
[2023-07-29 04:15:04] [config] clip-norm: 1
[2023-07-29 04:15:04] [config] cost-scaling:
[2023-07-29 04:15:04] [config]   - 256.f
[2023-07-29 04:15:04] [config]   - 1000
[2023-07-29 04:15:04] [config]   - 2.f
[2023-07-29 04:15:04] [config]   - 256.f
[2023-07-29 04:15:04] [config] cost-type: ce-sum
[2023-07-29 04:15:04] [config] cpu-threads: 0
[2023-07-29 04:15:04] [config] data-threads: 8
[2023-07-29 04:15:04] [config] data-weighting: ""
[2023-07-29 04:15:04] [config] data-weighting-type: sentence
[2023-07-29 04:15:04] [config] dec-cell: gru
[2023-07-29 04:15:04] [config] dec-cell-base-depth: 2
[2023-07-29 04:15:04] [config] dec-cell-high-depth: 1
[2023-07-29 04:15:04] [config] dec-depth: 1
[2023-07-29 04:15:04] [config] devices:
[2023-07-29 04:15:04] [config]   - 0
[2023-07-29 04:15:04] [config] dim-emb: 512
[2023-07-29 04:15:04] [config] dim-rnn: 1024
[2023-07-29 04:15:04] [config] dim-vocabs:
[2023-07-29 04:15:04] [config]   - 16384
[2023-07-29 04:15:04] [config]   - 16384
[2023-07-29 04:15:04] [config] disp-first: 0
[2023-07-29 04:15:04] [config] disp-freq: 1000u
[2023-07-29 04:15:04] [config] disp-label-counts: true
[2023-07-29 04:15:04] [config] dropout-rnn: 0
[2023-07-29 04:15:04] [config] dropout-src: 0
[2023-07-29 04:15:04] [config] dropout-trg: 0
[2023-07-29 04:15:04] [config] dump-config: ""
[2023-07-29 04:15:04] [config] dynamic-gradient-scaling:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] early-stopping: 1000
[2023-07-29 04:15:04] [config] early-stopping-on: first
[2023-07-29 04:15:04] [config] embedding-fix-src: false
[2023-07-29 04:15:04] [config] embedding-fix-trg: false
[2023-07-29 04:15:04] [config] embedding-normalization: false
[2023-07-29 04:15:04] [config] embedding-vectors:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] enc-cell: gru
[2023-07-29 04:15:04] [config] enc-cell-depth: 1
[2023-07-29 04:15:04] [config] enc-depth: 1
[2023-07-29 04:15:04] [config] enc-type: bidirectional
[2023-07-29 04:15:04] [config] english-title-case-every: 0
[2023-07-29 04:15:04] [config] exponential-smoothing: 0
[2023-07-29 04:15:04] [config] factor-weight: 1
[2023-07-29 04:15:04] [config] factors-combine: sum
[2023-07-29 04:15:04] [config] factors-dim-emb: 0
[2023-07-29 04:15:04] [config] gradient-checkpointing: false
[2023-07-29 04:15:04] [config] gradient-norm-average-window: 100
[2023-07-29 04:15:04] [config] guided-alignment: none
[2023-07-29 04:15:04] [config] guided-alignment-cost: mse
[2023-07-29 04:15:04] [config] guided-alignment-weight: 0.1
[2023-07-29 04:15:04] [config] ignore-model-config: false
[2023-07-29 04:15:04] [config] input-types:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] interpolate-env-vars: false
[2023-07-29 04:15:04] [config] keep-best: false
[2023-07-29 04:15:04] [config] label-smoothing: 0
[2023-07-29 04:15:04] [config] layer-normalization: false
[2023-07-29 04:15:04] [config] learn-rate: 0.0001
[2023-07-29 04:15:04] [config] lemma-dependency: ""
[2023-07-29 04:15:04] [config] lemma-dim-emb: 0
[2023-07-29 04:15:04] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 04:15:04] [config] log-level: info
[2023-07-29 04:15:04] [config] log-time-zone: ""
[2023-07-29 04:15:04] [config] logical-epoch:
[2023-07-29 04:15:04] [config]   - 1e
[2023-07-29 04:15:04] [config]   - 0
[2023-07-29 04:15:04] [config] lr-decay: 0
[2023-07-29 04:15:04] [config] lr-decay-freq: 50000
[2023-07-29 04:15:04] [config] lr-decay-inv-sqrt:
[2023-07-29 04:15:04] [config]   - 0
[2023-07-29 04:15:04] [config] lr-decay-repeat-warmup: false
[2023-07-29 04:15:04] [config] lr-decay-reset-optimizer: false
[2023-07-29 04:15:04] [config] lr-decay-start:
[2023-07-29 04:15:04] [config]   - 10
[2023-07-29 04:15:04] [config]   - 1
[2023-07-29 04:15:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 04:15:04] [config] lr-report: false
[2023-07-29 04:15:04] [config] lr-warmup: 0
[2023-07-29 04:15:04] [config] lr-warmup-at-reload: false
[2023-07-29 04:15:04] [config] lr-warmup-cycle: false
[2023-07-29 04:15:04] [config] lr-warmup-start-rate: 0
[2023-07-29 04:15:04] [config] max-length: 250
[2023-07-29 04:15:04] [config] max-length-crop: true
[2023-07-29 04:15:04] [config] max-length-factor: 3
[2023-07-29 04:15:04] [config] maxi-batch: 100
[2023-07-29 04:15:04] [config] maxi-batch-sort: trg
[2023-07-29 04:15:04] [config] mini-batch: 64
[2023-07-29 04:15:04] [config] mini-batch-fit: true
[2023-07-29 04:15:04] [config] mini-batch-fit-step: 10
[2023-07-29 04:15:04] [config] mini-batch-round-up: true
[2023-07-29 04:15:04] [config] mini-batch-track-lr: false
[2023-07-29 04:15:04] [config] mini-batch-warmup: 0
[2023-07-29 04:15:04] [config] mini-batch-words: 0
[2023-07-29 04:15:04] [config] mini-batch-words-ref: 0
[2023-07-29 04:15:04] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 04:15:04] [config] multi-loss-type: sum
[2023-07-29 04:15:04] [config] n-best: false
[2023-07-29 04:15:04] [config] no-nccl: false
[2023-07-29 04:15:04] [config] no-reload: false
[2023-07-29 04:15:04] [config] no-restore-corpus: false
[2023-07-29 04:15:04] [config] normalize: 0
[2023-07-29 04:15:04] [config] normalize-gradient: false
[2023-07-29 04:15:04] [config] num-devices: 0
[2023-07-29 04:15:04] [config] optimizer: adam
[2023-07-29 04:15:04] [config] optimizer-delay: 1
[2023-07-29 04:15:04] [config] optimizer-params:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] output-omit-bias: false
[2023-07-29 04:15:04] [config] overwrite: true
[2023-07-29 04:15:04] [config] precision:
[2023-07-29 04:15:04] [config]   - float16
[2023-07-29 04:15:04] [config]   - float32
[2023-07-29 04:15:04] [config] pretrained-model: ""
[2023-07-29 04:15:04] [config] quantize-biases: false
[2023-07-29 04:15:04] [config] quantize-bits: 0
[2023-07-29 04:15:04] [config] quantize-log-based: false
[2023-07-29 04:15:04] [config] quantize-optimization-steps: 0
[2023-07-29 04:15:04] [config] quiet: false
[2023-07-29 04:15:04] [config] quiet-translation: true
[2023-07-29 04:15:04] [config] relative-paths: false
[2023-07-29 04:15:04] [config] right-left: false
[2023-07-29 04:15:04] [config] save-freq: 10000u
[2023-07-29 04:15:04] [config] seed: 1234
[2023-07-29 04:15:04] [config] sentencepiece-alphas:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] sentencepiece-max-lines: 2000000
[2023-07-29 04:15:04] [config] sentencepiece-options: ""
[2023-07-29 04:15:04] [config] sharding: global
[2023-07-29 04:15:04] [config] shuffle: data
[2023-07-29 04:15:04] [config] shuffle-in-ram: false
[2023-07-29 04:15:04] [config] sigterm: save-and-exit
[2023-07-29 04:15:04] [config] skip: false
[2023-07-29 04:15:04] [config] sqlite: ""
[2023-07-29 04:15:04] [config] sqlite-drop: false
[2023-07-29 04:15:04] [config] sync-freq: 200u
[2023-07-29 04:15:04] [config] sync-sgd: false
[2023-07-29 04:15:04] [config] tempdir: /tmp
[2023-07-29 04:15:04] [config] tied-embeddings: false
[2023-07-29 04:15:04] [config] tied-embeddings-all: true
[2023-07-29 04:15:04] [config] tied-embeddings-src: false
[2023-07-29 04:15:04] [config] train-embedder-rank:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] train-sets:
[2023-07-29 04:15:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 04:15:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 04:15:04] [config] transformer-aan-activation: swish
[2023-07-29 04:15:04] [config] transformer-aan-depth: 2
[2023-07-29 04:15:04] [config] transformer-aan-nogate: false
[2023-07-29 04:15:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 04:15:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 04:15:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 04:15:04] [config] transformer-depth-scaling: false
[2023-07-29 04:15:04] [config] transformer-dim-aan: 2048
[2023-07-29 04:15:04] [config] transformer-dim-ffn: 2048
[2023-07-29 04:15:04] [config] transformer-dropout: 0
[2023-07-29 04:15:04] [config] transformer-dropout-attention: 0
[2023-07-29 04:15:04] [config] transformer-dropout-ffn: 0
[2023-07-29 04:15:04] [config] transformer-ffn-activation: swish
[2023-07-29 04:15:04] [config] transformer-ffn-depth: 2
[2023-07-29 04:15:04] [config] transformer-guided-alignment-layer: last
[2023-07-29 04:15:04] [config] transformer-heads: 8
[2023-07-29 04:15:04] [config] transformer-no-projection: false
[2023-07-29 04:15:04] [config] transformer-pool: false
[2023-07-29 04:15:04] [config] transformer-postprocess: dan
[2023-07-29 04:15:04] [config] transformer-postprocess-emb: d
[2023-07-29 04:15:04] [config] transformer-postprocess-top: ""
[2023-07-29 04:15:04] [config] transformer-preprocess: ""
[2023-07-29 04:15:04] [config] transformer-tied-layers:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] transformer-train-position-embeddings: false
[2023-07-29 04:15:04] [config] tsv: false
[2023-07-29 04:15:04] [config] tsv-fields: 0
[2023-07-29 04:15:04] [config] type: s2s
[2023-07-29 04:15:04] [config] ulr: false
[2023-07-29 04:15:04] [config] ulr-dim-emb: 0
[2023-07-29 04:15:04] [config] ulr-dropout: 0
[2023-07-29 04:15:04] [config] ulr-keys-vectors: ""
[2023-07-29 04:15:04] [config] ulr-query-vectors: ""
[2023-07-29 04:15:04] [config] ulr-softmax-temperature: 1
[2023-07-29 04:15:04] [config] ulr-trainable-transformation: false
[2023-07-29 04:15:04] [config] unlikelihood-loss: false
[2023-07-29 04:15:04] [config] valid-freq: 50000000
[2023-07-29 04:15:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 04:15:04] [config] valid-max-length: 1000
[2023-07-29 04:15:04] [config] valid-metrics:
[2023-07-29 04:15:04] [config]   - translation
[2023-07-29 04:15:04] [config] valid-mini-batch: 32
[2023-07-29 04:15:04] [config] valid-reset-stalled: false
[2023-07-29 04:15:04] [config] valid-script-args:
[2023-07-29 04:15:04] [config]   []
[2023-07-29 04:15:04] [config] valid-script-path: ""
[2023-07-29 04:15:04] [config] valid-sets:
[2023-07-29 04:15:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 04:15:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 04:15:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 04:15:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:15:04] [config] vocabs:
[2023-07-29 04:15:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 04:15:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 04:15:04] [config] word-penalty: 0
[2023-07-29 04:15:04] [config] word-scores: false
[2023-07-29 04:15:04] [config] workspace: 5500
[2023-07-29 04:15:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:15:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:15:04] [training] Using single-device training
[2023-07-29 04:15:05] Synced seed 1234
[2023-07-29 04:15:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 04:15:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 04:15:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 04:15:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 04:15:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 04:15:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:15:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 04:15:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 04:15:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 04:15:06] [comm] Using global sharding
[2023-07-29 04:15:06] [comm] NCCLCommunicators constructed successfully
[2023-07-29 04:15:06] [training] Using 1 GPUs
[2023-07-29 04:15:06] [logits] Applying loss function for 1 factor(s)
[2023-07-29 04:15:06] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:15:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 04:15:06] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:51:55] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 04:51:55] [valid] No post-processing script given for validating translator
[2023-07-29 04:51:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:51:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 04:51:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 04:51:56] [comm] Using global sharding
[2023-07-29 04:51:56] [comm] NCCLCommunicators constructed successfully
[2023-07-29 04:51:56] [training] Using 1 GPUs
[2023-07-29 04:51:56] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 04:51:57] Allocating memory for general optimizer shards
[2023-07-29 04:51:57] [memory] Reserving 322 MB, device gpu0
[2023-07-29 04:51:57] Loading Adam parameters
[2023-07-29 04:51:57] [memory] Reserving 322 MB, device gpu0
[2023-07-29 04:51:57] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:51:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 04:51:57] [data] Restoring the corpus state to epoch 341, batch 13197
[2023-07-29 04:51:57] [data] Shuffling data
[2023-07-29 04:51:57] [data] Done reading 20,192 sentences
[2023-07-29 04:51:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 04:51:58] Training started
[2023-07-29 04:51:58] Training finished
[2023-07-29 04:52:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:52:01] [marian] Running on node01.datos.cluster.uy as process 8413 with command line:
[2023-07-29 04:52:01] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 04:52:01] [config] after: 0e
[2023-07-29 04:52:01] [config] after-batches: 0
[2023-07-29 04:52:01] [config] after-epochs: 130
[2023-07-29 04:52:01] [config] all-caps-every: 0
[2023-07-29 04:52:01] [config] allow-unk: false
[2023-07-29 04:52:01] [config] authors: false
[2023-07-29 04:52:01] [config] beam-size: 12
[2023-07-29 04:52:01] [config] bert-class-symbol: "[CLS]"
[2023-07-29 04:52:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 04:52:01] [config] bert-masking-fraction: 0.15
[2023-07-29 04:52:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 04:52:01] [config] bert-train-type-embeddings: true
[2023-07-29 04:52:01] [config] bert-type-vocab-size: 2
[2023-07-29 04:52:01] [config] build-info: ""
[2023-07-29 04:52:01] [config] check-gradient-nan: false
[2023-07-29 04:52:01] [config] check-nan: false
[2023-07-29 04:52:01] [config] cite: false
[2023-07-29 04:52:01] [config] clip-norm: 1
[2023-07-29 04:52:01] [config] cost-scaling:
[2023-07-29 04:52:01] [config]   - 256.f
[2023-07-29 04:52:01] [config]   - 1000
[2023-07-29 04:52:01] [config]   - 2.f
[2023-07-29 04:52:01] [config]   - 256.f
[2023-07-29 04:52:01] [config] cost-type: ce-sum
[2023-07-29 04:52:01] [config] cpu-threads: 0
[2023-07-29 04:52:01] [config] data-threads: 8
[2023-07-29 04:52:01] [config] data-weighting: ""
[2023-07-29 04:52:01] [config] data-weighting-type: sentence
[2023-07-29 04:52:01] [config] dec-cell: gru
[2023-07-29 04:52:01] [config] dec-cell-base-depth: 2
[2023-07-29 04:52:01] [config] dec-cell-high-depth: 1
[2023-07-29 04:52:01] [config] dec-depth: 1
[2023-07-29 04:52:01] [config] devices:
[2023-07-29 04:52:01] [config]   - 0
[2023-07-29 04:52:01] [config] dim-emb: 512
[2023-07-29 04:52:01] [config] dim-rnn: 1024
[2023-07-29 04:52:01] [config] dim-vocabs:
[2023-07-29 04:52:01] [config]   - 16384
[2023-07-29 04:52:01] [config]   - 16384
[2023-07-29 04:52:01] [config] disp-first: 0
[2023-07-29 04:52:01] [config] disp-freq: 1000u
[2023-07-29 04:52:01] [config] disp-label-counts: true
[2023-07-29 04:52:01] [config] dropout-rnn: 0
[2023-07-29 04:52:01] [config] dropout-src: 0
[2023-07-29 04:52:01] [config] dropout-trg: 0
[2023-07-29 04:52:01] [config] dump-config: ""
[2023-07-29 04:52:01] [config] dynamic-gradient-scaling:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] early-stopping: 1000
[2023-07-29 04:52:01] [config] early-stopping-on: first
[2023-07-29 04:52:01] [config] embedding-fix-src: false
[2023-07-29 04:52:01] [config] embedding-fix-trg: false
[2023-07-29 04:52:01] [config] embedding-normalization: false
[2023-07-29 04:52:01] [config] embedding-vectors:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] enc-cell: gru
[2023-07-29 04:52:01] [config] enc-cell-depth: 1
[2023-07-29 04:52:01] [config] enc-depth: 1
[2023-07-29 04:52:01] [config] enc-type: bidirectional
[2023-07-29 04:52:01] [config] english-title-case-every: 0
[2023-07-29 04:52:01] [config] exponential-smoothing: 0
[2023-07-29 04:52:01] [config] factor-weight: 1
[2023-07-29 04:52:01] [config] factors-combine: sum
[2023-07-29 04:52:01] [config] factors-dim-emb: 0
[2023-07-29 04:52:01] [config] gradient-checkpointing: false
[2023-07-29 04:52:01] [config] gradient-norm-average-window: 100
[2023-07-29 04:52:01] [config] guided-alignment: none
[2023-07-29 04:52:01] [config] guided-alignment-cost: mse
[2023-07-29 04:52:01] [config] guided-alignment-weight: 0.1
[2023-07-29 04:52:01] [config] ignore-model-config: false
[2023-07-29 04:52:01] [config] input-types:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] interpolate-env-vars: false
[2023-07-29 04:52:01] [config] keep-best: false
[2023-07-29 04:52:01] [config] label-smoothing: 0
[2023-07-29 04:52:01] [config] layer-normalization: false
[2023-07-29 04:52:01] [config] learn-rate: 0.0001
[2023-07-29 04:52:01] [config] lemma-dependency: ""
[2023-07-29 04:52:01] [config] lemma-dim-emb: 0
[2023-07-29 04:52:01] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 04:52:01] [config] log-level: info
[2023-07-29 04:52:01] [config] log-time-zone: ""
[2023-07-29 04:52:01] [config] logical-epoch:
[2023-07-29 04:52:01] [config]   - 1e
[2023-07-29 04:52:01] [config]   - 0
[2023-07-29 04:52:01] [config] lr-decay: 0
[2023-07-29 04:52:01] [config] lr-decay-freq: 50000
[2023-07-29 04:52:01] [config] lr-decay-inv-sqrt:
[2023-07-29 04:52:01] [config]   - 0
[2023-07-29 04:52:01] [config] lr-decay-repeat-warmup: false
[2023-07-29 04:52:01] [config] lr-decay-reset-optimizer: false
[2023-07-29 04:52:01] [config] lr-decay-start:
[2023-07-29 04:52:01] [config]   - 10
[2023-07-29 04:52:01] [config]   - 1
[2023-07-29 04:52:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 04:52:01] [config] lr-report: false
[2023-07-29 04:52:01] [config] lr-warmup: 0
[2023-07-29 04:52:01] [config] lr-warmup-at-reload: false
[2023-07-29 04:52:01] [config] lr-warmup-cycle: false
[2023-07-29 04:52:01] [config] lr-warmup-start-rate: 0
[2023-07-29 04:52:01] [config] max-length: 250
[2023-07-29 04:52:01] [config] max-length-crop: true
[2023-07-29 04:52:01] [config] max-length-factor: 3
[2023-07-29 04:52:01] [config] maxi-batch: 100
[2023-07-29 04:52:01] [config] maxi-batch-sort: trg
[2023-07-29 04:52:01] [config] mini-batch: 64
[2023-07-29 04:52:01] [config] mini-batch-fit: true
[2023-07-29 04:52:01] [config] mini-batch-fit-step: 10
[2023-07-29 04:52:01] [config] mini-batch-round-up: true
[2023-07-29 04:52:01] [config] mini-batch-track-lr: false
[2023-07-29 04:52:01] [config] mini-batch-warmup: 0
[2023-07-29 04:52:01] [config] mini-batch-words: 0
[2023-07-29 04:52:01] [config] mini-batch-words-ref: 0
[2023-07-29 04:52:01] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 04:52:01] [config] multi-loss-type: sum
[2023-07-29 04:52:01] [config] n-best: false
[2023-07-29 04:52:01] [config] no-nccl: false
[2023-07-29 04:52:01] [config] no-reload: false
[2023-07-29 04:52:01] [config] no-restore-corpus: false
[2023-07-29 04:52:01] [config] normalize: 0
[2023-07-29 04:52:01] [config] normalize-gradient: false
[2023-07-29 04:52:01] [config] num-devices: 0
[2023-07-29 04:52:01] [config] optimizer: adam
[2023-07-29 04:52:01] [config] optimizer-delay: 1
[2023-07-29 04:52:01] [config] optimizer-params:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] output-omit-bias: false
[2023-07-29 04:52:01] [config] overwrite: true
[2023-07-29 04:52:01] [config] precision:
[2023-07-29 04:52:01] [config]   - float16
[2023-07-29 04:52:01] [config]   - float32
[2023-07-29 04:52:01] [config] pretrained-model: ""
[2023-07-29 04:52:01] [config] quantize-biases: false
[2023-07-29 04:52:01] [config] quantize-bits: 0
[2023-07-29 04:52:01] [config] quantize-log-based: false
[2023-07-29 04:52:01] [config] quantize-optimization-steps: 0
[2023-07-29 04:52:01] [config] quiet: false
[2023-07-29 04:52:01] [config] quiet-translation: true
[2023-07-29 04:52:01] [config] relative-paths: false
[2023-07-29 04:52:01] [config] right-left: false
[2023-07-29 04:52:01] [config] save-freq: 10000u
[2023-07-29 04:52:01] [config] seed: 1234
[2023-07-29 04:52:01] [config] sentencepiece-alphas:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] sentencepiece-max-lines: 2000000
[2023-07-29 04:52:01] [config] sentencepiece-options: ""
[2023-07-29 04:52:01] [config] sharding: global
[2023-07-29 04:52:01] [config] shuffle: data
[2023-07-29 04:52:01] [config] shuffle-in-ram: false
[2023-07-29 04:52:01] [config] sigterm: save-and-exit
[2023-07-29 04:52:01] [config] skip: false
[2023-07-29 04:52:01] [config] sqlite: ""
[2023-07-29 04:52:01] [config] sqlite-drop: false
[2023-07-29 04:52:01] [config] sync-freq: 200u
[2023-07-29 04:52:01] [config] sync-sgd: false
[2023-07-29 04:52:01] [config] tempdir: /tmp
[2023-07-29 04:52:01] [config] tied-embeddings: false
[2023-07-29 04:52:01] [config] tied-embeddings-all: true
[2023-07-29 04:52:01] [config] tied-embeddings-src: false
[2023-07-29 04:52:01] [config] train-embedder-rank:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] train-sets:
[2023-07-29 04:52:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 04:52:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 04:52:01] [config] transformer-aan-activation: swish
[2023-07-29 04:52:01] [config] transformer-aan-depth: 2
[2023-07-29 04:52:01] [config] transformer-aan-nogate: false
[2023-07-29 04:52:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 04:52:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 04:52:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 04:52:01] [config] transformer-depth-scaling: false
[2023-07-29 04:52:01] [config] transformer-dim-aan: 2048
[2023-07-29 04:52:01] [config] transformer-dim-ffn: 2048
[2023-07-29 04:52:01] [config] transformer-dropout: 0
[2023-07-29 04:52:01] [config] transformer-dropout-attention: 0
[2023-07-29 04:52:01] [config] transformer-dropout-ffn: 0
[2023-07-29 04:52:01] [config] transformer-ffn-activation: swish
[2023-07-29 04:52:01] [config] transformer-ffn-depth: 2
[2023-07-29 04:52:01] [config] transformer-guided-alignment-layer: last
[2023-07-29 04:52:01] [config] transformer-heads: 8
[2023-07-29 04:52:01] [config] transformer-no-projection: false
[2023-07-29 04:52:01] [config] transformer-pool: false
[2023-07-29 04:52:01] [config] transformer-postprocess: dan
[2023-07-29 04:52:01] [config] transformer-postprocess-emb: d
[2023-07-29 04:52:01] [config] transformer-postprocess-top: ""
[2023-07-29 04:52:01] [config] transformer-preprocess: ""
[2023-07-29 04:52:01] [config] transformer-tied-layers:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] transformer-train-position-embeddings: false
[2023-07-29 04:52:01] [config] tsv: false
[2023-07-29 04:52:01] [config] tsv-fields: 0
[2023-07-29 04:52:01] [config] type: s2s
[2023-07-29 04:52:01] [config] ulr: false
[2023-07-29 04:52:01] [config] ulr-dim-emb: 0
[2023-07-29 04:52:01] [config] ulr-dropout: 0
[2023-07-29 04:52:01] [config] ulr-keys-vectors: ""
[2023-07-29 04:52:01] [config] ulr-query-vectors: ""
[2023-07-29 04:52:01] [config] ulr-softmax-temperature: 1
[2023-07-29 04:52:01] [config] ulr-trainable-transformation: false
[2023-07-29 04:52:01] [config] unlikelihood-loss: false
[2023-07-29 04:52:01] [config] valid-freq: 50000000
[2023-07-29 04:52:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 04:52:01] [config] valid-max-length: 1000
[2023-07-29 04:52:01] [config] valid-metrics:
[2023-07-29 04:52:01] [config]   - translation
[2023-07-29 04:52:01] [config] valid-mini-batch: 32
[2023-07-29 04:52:01] [config] valid-reset-stalled: false
[2023-07-29 04:52:01] [config] valid-script-args:
[2023-07-29 04:52:01] [config]   []
[2023-07-29 04:52:01] [config] valid-script-path: ""
[2023-07-29 04:52:01] [config] valid-sets:
[2023-07-29 04:52:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 04:52:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 04:52:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 04:52:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:52:01] [config] vocabs:
[2023-07-29 04:52:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 04:52:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 04:52:01] [config] word-penalty: 0
[2023-07-29 04:52:01] [config] word-scores: false
[2023-07-29 04:52:01] [config] workspace: 5500
[2023-07-29 04:52:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:52:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:52:01] [training] Using single-device training
[2023-07-29 04:52:01] Synced seed 1234
[2023-07-29 04:52:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 04:52:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 04:52:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 04:52:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 04:52:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 04:52:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:52:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 04:52:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 04:52:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 04:52:02] [comm] Using global sharding
[2023-07-29 04:52:02] [comm] NCCLCommunicators constructed successfully
[2023-07-29 04:52:02] [training] Using 1 GPUs
[2023-07-29 04:52:02] [logits] Applying loss function for 1 factor(s)
[2023-07-29 04:52:02] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:52:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 04:52:03] [memory] Reserving 80 MB, device gpu0
[2023-07-29 05:29:01] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 05:29:01] [valid] No post-processing script given for validating translator
[2023-07-29 05:29:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 05:29:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 05:29:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 05:29:01] [comm] Using global sharding
[2023-07-29 05:29:01] [comm] NCCLCommunicators constructed successfully
[2023-07-29 05:29:01] [training] Using 1 GPUs
[2023-07-29 05:29:01] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 05:29:02] Allocating memory for general optimizer shards
[2023-07-29 05:29:02] [memory] Reserving 322 MB, device gpu0
[2023-07-29 05:29:02] Loading Adam parameters
[2023-07-29 05:29:02] [memory] Reserving 322 MB, device gpu0
[2023-07-29 05:29:02] [memory] Reserving 80 MB, device gpu0
[2023-07-29 05:29:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 05:29:03] [data] Restoring the corpus state to epoch 341, batch 13197
[2023-07-29 05:29:03] [data] Shuffling data
[2023-07-29 05:29:03] [data] Done reading 20,192 sentences
[2023-07-29 05:29:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:29:03] Training started
[2023-07-29 05:29:03] Training finished
[2023-07-29 05:29:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 05:29:06] [marian] Running on node01.datos.cluster.uy as process 10700 with command line:
[2023-07-29 05:29:06] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 05:29:06] [config] after: 0e
[2023-07-29 05:29:06] [config] after-batches: 0
[2023-07-29 05:29:06] [config] after-epochs: 140
[2023-07-29 05:29:06] [config] all-caps-every: 0
[2023-07-29 05:29:06] [config] allow-unk: false
[2023-07-29 05:29:06] [config] authors: false
[2023-07-29 05:29:06] [config] beam-size: 12
[2023-07-29 05:29:06] [config] bert-class-symbol: "[CLS]"
[2023-07-29 05:29:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 05:29:06] [config] bert-masking-fraction: 0.15
[2023-07-29 05:29:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 05:29:06] [config] bert-train-type-embeddings: true
[2023-07-29 05:29:06] [config] bert-type-vocab-size: 2
[2023-07-29 05:29:06] [config] build-info: ""
[2023-07-29 05:29:06] [config] check-gradient-nan: false
[2023-07-29 05:29:06] [config] check-nan: false
[2023-07-29 05:29:06] [config] cite: false
[2023-07-29 05:29:06] [config] clip-norm: 1
[2023-07-29 05:29:06] [config] cost-scaling:
[2023-07-29 05:29:06] [config]   - 256.f
[2023-07-29 05:29:06] [config]   - 1000
[2023-07-29 05:29:06] [config]   - 2.f
[2023-07-29 05:29:06] [config]   - 256.f
[2023-07-29 05:29:06] [config] cost-type: ce-sum
[2023-07-29 05:29:06] [config] cpu-threads: 0
[2023-07-29 05:29:06] [config] data-threads: 8
[2023-07-29 05:29:06] [config] data-weighting: ""
[2023-07-29 05:29:06] [config] data-weighting-type: sentence
[2023-07-29 05:29:06] [config] dec-cell: gru
[2023-07-29 05:29:06] [config] dec-cell-base-depth: 2
[2023-07-29 05:29:06] [config] dec-cell-high-depth: 1
[2023-07-29 05:29:06] [config] dec-depth: 1
[2023-07-29 05:29:06] [config] devices:
[2023-07-29 05:29:06] [config]   - 0
[2023-07-29 05:29:06] [config] dim-emb: 512
[2023-07-29 05:29:06] [config] dim-rnn: 1024
[2023-07-29 05:29:06] [config] dim-vocabs:
[2023-07-29 05:29:06] [config]   - 16384
[2023-07-29 05:29:06] [config]   - 16384
[2023-07-29 05:29:06] [config] disp-first: 0
[2023-07-29 05:29:06] [config] disp-freq: 1000u
[2023-07-29 05:29:06] [config] disp-label-counts: true
[2023-07-29 05:29:06] [config] dropout-rnn: 0
[2023-07-29 05:29:06] [config] dropout-src: 0
[2023-07-29 05:29:06] [config] dropout-trg: 0
[2023-07-29 05:29:06] [config] dump-config: ""
[2023-07-29 05:29:06] [config] dynamic-gradient-scaling:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] early-stopping: 1000
[2023-07-29 05:29:06] [config] early-stopping-on: first
[2023-07-29 05:29:06] [config] embedding-fix-src: false
[2023-07-29 05:29:06] [config] embedding-fix-trg: false
[2023-07-29 05:29:06] [config] embedding-normalization: false
[2023-07-29 05:29:06] [config] embedding-vectors:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] enc-cell: gru
[2023-07-29 05:29:06] [config] enc-cell-depth: 1
[2023-07-29 05:29:06] [config] enc-depth: 1
[2023-07-29 05:29:06] [config] enc-type: bidirectional
[2023-07-29 05:29:06] [config] english-title-case-every: 0
[2023-07-29 05:29:06] [config] exponential-smoothing: 0
[2023-07-29 05:29:06] [config] factor-weight: 1
[2023-07-29 05:29:06] [config] factors-combine: sum
[2023-07-29 05:29:06] [config] factors-dim-emb: 0
[2023-07-29 05:29:06] [config] gradient-checkpointing: false
[2023-07-29 05:29:06] [config] gradient-norm-average-window: 100
[2023-07-29 05:29:06] [config] guided-alignment: none
[2023-07-29 05:29:06] [config] guided-alignment-cost: mse
[2023-07-29 05:29:06] [config] guided-alignment-weight: 0.1
[2023-07-29 05:29:06] [config] ignore-model-config: false
[2023-07-29 05:29:06] [config] input-types:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] interpolate-env-vars: false
[2023-07-29 05:29:06] [config] keep-best: false
[2023-07-29 05:29:06] [config] label-smoothing: 0
[2023-07-29 05:29:06] [config] layer-normalization: false
[2023-07-29 05:29:06] [config] learn-rate: 0.0001
[2023-07-29 05:29:06] [config] lemma-dependency: ""
[2023-07-29 05:29:06] [config] lemma-dim-emb: 0
[2023-07-29 05:29:06] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 05:29:06] [config] log-level: info
[2023-07-29 05:29:06] [config] log-time-zone: ""
[2023-07-29 05:29:06] [config] logical-epoch:
[2023-07-29 05:29:06] [config]   - 1e
[2023-07-29 05:29:06] [config]   - 0
[2023-07-29 05:29:06] [config] lr-decay: 0
[2023-07-29 05:29:06] [config] lr-decay-freq: 50000
[2023-07-29 05:29:06] [config] lr-decay-inv-sqrt:
[2023-07-29 05:29:06] [config]   - 0
[2023-07-29 05:29:06] [config] lr-decay-repeat-warmup: false
[2023-07-29 05:29:06] [config] lr-decay-reset-optimizer: false
[2023-07-29 05:29:06] [config] lr-decay-start:
[2023-07-29 05:29:06] [config]   - 10
[2023-07-29 05:29:06] [config]   - 1
[2023-07-29 05:29:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 05:29:06] [config] lr-report: false
[2023-07-29 05:29:06] [config] lr-warmup: 0
[2023-07-29 05:29:06] [config] lr-warmup-at-reload: false
[2023-07-29 05:29:06] [config] lr-warmup-cycle: false
[2023-07-29 05:29:06] [config] lr-warmup-start-rate: 0
[2023-07-29 05:29:06] [config] max-length: 250
[2023-07-29 05:29:06] [config] max-length-crop: true
[2023-07-29 05:29:06] [config] max-length-factor: 3
[2023-07-29 05:29:06] [config] maxi-batch: 100
[2023-07-29 05:29:06] [config] maxi-batch-sort: trg
[2023-07-29 05:29:06] [config] mini-batch: 64
[2023-07-29 05:29:06] [config] mini-batch-fit: true
[2023-07-29 05:29:06] [config] mini-batch-fit-step: 10
[2023-07-29 05:29:06] [config] mini-batch-round-up: true
[2023-07-29 05:29:06] [config] mini-batch-track-lr: false
[2023-07-29 05:29:06] [config] mini-batch-warmup: 0
[2023-07-29 05:29:06] [config] mini-batch-words: 0
[2023-07-29 05:29:06] [config] mini-batch-words-ref: 0
[2023-07-29 05:29:06] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 05:29:06] [config] multi-loss-type: sum
[2023-07-29 05:29:06] [config] n-best: false
[2023-07-29 05:29:06] [config] no-nccl: false
[2023-07-29 05:29:06] [config] no-reload: false
[2023-07-29 05:29:06] [config] no-restore-corpus: false
[2023-07-29 05:29:06] [config] normalize: 0
[2023-07-29 05:29:06] [config] normalize-gradient: false
[2023-07-29 05:29:06] [config] num-devices: 0
[2023-07-29 05:29:06] [config] optimizer: adam
[2023-07-29 05:29:06] [config] optimizer-delay: 1
[2023-07-29 05:29:06] [config] optimizer-params:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] output-omit-bias: false
[2023-07-29 05:29:06] [config] overwrite: true
[2023-07-29 05:29:06] [config] precision:
[2023-07-29 05:29:06] [config]   - float16
[2023-07-29 05:29:06] [config]   - float32
[2023-07-29 05:29:06] [config] pretrained-model: ""
[2023-07-29 05:29:06] [config] quantize-biases: false
[2023-07-29 05:29:06] [config] quantize-bits: 0
[2023-07-29 05:29:06] [config] quantize-log-based: false
[2023-07-29 05:29:06] [config] quantize-optimization-steps: 0
[2023-07-29 05:29:06] [config] quiet: false
[2023-07-29 05:29:06] [config] quiet-translation: true
[2023-07-29 05:29:06] [config] relative-paths: false
[2023-07-29 05:29:06] [config] right-left: false
[2023-07-29 05:29:06] [config] save-freq: 10000u
[2023-07-29 05:29:06] [config] seed: 1234
[2023-07-29 05:29:06] [config] sentencepiece-alphas:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] sentencepiece-max-lines: 2000000
[2023-07-29 05:29:06] [config] sentencepiece-options: ""
[2023-07-29 05:29:06] [config] sharding: global
[2023-07-29 05:29:06] [config] shuffle: data
[2023-07-29 05:29:06] [config] shuffle-in-ram: false
[2023-07-29 05:29:06] [config] sigterm: save-and-exit
[2023-07-29 05:29:06] [config] skip: false
[2023-07-29 05:29:06] [config] sqlite: ""
[2023-07-29 05:29:06] [config] sqlite-drop: false
[2023-07-29 05:29:06] [config] sync-freq: 200u
[2023-07-29 05:29:06] [config] sync-sgd: false
[2023-07-29 05:29:06] [config] tempdir: /tmp
[2023-07-29 05:29:06] [config] tied-embeddings: false
[2023-07-29 05:29:06] [config] tied-embeddings-all: true
[2023-07-29 05:29:06] [config] tied-embeddings-src: false
[2023-07-29 05:29:06] [config] train-embedder-rank:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] train-sets:
[2023-07-29 05:29:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 05:29:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 05:29:06] [config] transformer-aan-activation: swish
[2023-07-29 05:29:06] [config] transformer-aan-depth: 2
[2023-07-29 05:29:06] [config] transformer-aan-nogate: false
[2023-07-29 05:29:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 05:29:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 05:29:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 05:29:06] [config] transformer-depth-scaling: false
[2023-07-29 05:29:06] [config] transformer-dim-aan: 2048
[2023-07-29 05:29:06] [config] transformer-dim-ffn: 2048
[2023-07-29 05:29:06] [config] transformer-dropout: 0
[2023-07-29 05:29:06] [config] transformer-dropout-attention: 0
[2023-07-29 05:29:06] [config] transformer-dropout-ffn: 0
[2023-07-29 05:29:06] [config] transformer-ffn-activation: swish
[2023-07-29 05:29:06] [config] transformer-ffn-depth: 2
[2023-07-29 05:29:06] [config] transformer-guided-alignment-layer: last
[2023-07-29 05:29:06] [config] transformer-heads: 8
[2023-07-29 05:29:06] [config] transformer-no-projection: false
[2023-07-29 05:29:06] [config] transformer-pool: false
[2023-07-29 05:29:06] [config] transformer-postprocess: dan
[2023-07-29 05:29:06] [config] transformer-postprocess-emb: d
[2023-07-29 05:29:06] [config] transformer-postprocess-top: ""
[2023-07-29 05:29:06] [config] transformer-preprocess: ""
[2023-07-29 05:29:06] [config] transformer-tied-layers:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] transformer-train-position-embeddings: false
[2023-07-29 05:29:06] [config] tsv: false
[2023-07-29 05:29:06] [config] tsv-fields: 0
[2023-07-29 05:29:06] [config] type: s2s
[2023-07-29 05:29:06] [config] ulr: false
[2023-07-29 05:29:06] [config] ulr-dim-emb: 0
[2023-07-29 05:29:06] [config] ulr-dropout: 0
[2023-07-29 05:29:06] [config] ulr-keys-vectors: ""
[2023-07-29 05:29:06] [config] ulr-query-vectors: ""
[2023-07-29 05:29:06] [config] ulr-softmax-temperature: 1
[2023-07-29 05:29:06] [config] ulr-trainable-transformation: false
[2023-07-29 05:29:06] [config] unlikelihood-loss: false
[2023-07-29 05:29:06] [config] valid-freq: 50000000
[2023-07-29 05:29:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 05:29:06] [config] valid-max-length: 1000
[2023-07-29 05:29:06] [config] valid-metrics:
[2023-07-29 05:29:06] [config]   - translation
[2023-07-29 05:29:06] [config] valid-mini-batch: 32
[2023-07-29 05:29:06] [config] valid-reset-stalled: false
[2023-07-29 05:29:06] [config] valid-script-args:
[2023-07-29 05:29:06] [config]   []
[2023-07-29 05:29:06] [config] valid-script-path: ""
[2023-07-29 05:29:06] [config] valid-sets:
[2023-07-29 05:29:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 05:29:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 05:29:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 05:29:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 05:29:06] [config] vocabs:
[2023-07-29 05:29:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 05:29:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 05:29:06] [config] word-penalty: 0
[2023-07-29 05:29:06] [config] word-scores: false
[2023-07-29 05:29:06] [config] workspace: 5500
[2023-07-29 05:29:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 05:29:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 05:29:06] [training] Using single-device training
[2023-07-29 05:29:06] Synced seed 1234
[2023-07-29 05:29:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 05:29:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 05:29:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 05:29:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 05:29:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 05:29:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 05:29:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 05:29:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 05:29:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 05:29:07] [comm] Using global sharding
[2023-07-29 05:29:07] [comm] NCCLCommunicators constructed successfully
[2023-07-29 05:29:07] [training] Using 1 GPUs
[2023-07-29 05:29:07] [logits] Applying loss function for 1 factor(s)
[2023-07-29 05:29:07] [memory] Reserving 80 MB, device gpu0
[2023-07-29 05:29:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 05:29:08] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:06:07] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 06:06:07] [valid] No post-processing script given for validating translator
[2023-07-29 06:06:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 06:06:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 06:06:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 06:06:08] [comm] Using global sharding
[2023-07-29 06:06:08] [comm] NCCLCommunicators constructed successfully
[2023-07-29 06:06:08] [training] Using 1 GPUs
[2023-07-29 06:06:08] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 06:06:09] Allocating memory for general optimizer shards
[2023-07-29 06:06:09] [memory] Reserving 322 MB, device gpu0
[2023-07-29 06:06:09] Loading Adam parameters
[2023-07-29 06:06:09] [memory] Reserving 322 MB, device gpu0
[2023-07-29 06:06:09] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:06:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 06:06:10] [data] Restoring the corpus state to epoch 351, batch 13587
[2023-07-29 06:06:10] [data] Shuffling data
[2023-07-29 06:06:10] [data] Done reading 20,192 sentences
[2023-07-29 06:06:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:06:10] Training started
[2023-07-29 06:06:10] Training finished
[2023-07-29 06:06:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 06:06:14] [marian] Running on node01.datos.cluster.uy as process 12989 with command line:
[2023-07-29 06:06:14] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 06:06:14] [config] after: 0e
[2023-07-29 06:06:14] [config] after-batches: 0
[2023-07-29 06:06:14] [config] after-epochs: 150
[2023-07-29 06:06:14] [config] all-caps-every: 0
[2023-07-29 06:06:14] [config] allow-unk: false
[2023-07-29 06:06:14] [config] authors: false
[2023-07-29 06:06:14] [config] beam-size: 12
[2023-07-29 06:06:14] [config] bert-class-symbol: "[CLS]"
[2023-07-29 06:06:14] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 06:06:14] [config] bert-masking-fraction: 0.15
[2023-07-29 06:06:14] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 06:06:14] [config] bert-train-type-embeddings: true
[2023-07-29 06:06:14] [config] bert-type-vocab-size: 2
[2023-07-29 06:06:14] [config] build-info: ""
[2023-07-29 06:06:14] [config] check-gradient-nan: false
[2023-07-29 06:06:14] [config] check-nan: false
[2023-07-29 06:06:14] [config] cite: false
[2023-07-29 06:06:14] [config] clip-norm: 1
[2023-07-29 06:06:14] [config] cost-scaling:
[2023-07-29 06:06:14] [config]   - 256.f
[2023-07-29 06:06:14] [config]   - 1000
[2023-07-29 06:06:14] [config]   - 2.f
[2023-07-29 06:06:14] [config]   - 256.f
[2023-07-29 06:06:14] [config] cost-type: ce-sum
[2023-07-29 06:06:14] [config] cpu-threads: 0
[2023-07-29 06:06:14] [config] data-threads: 8
[2023-07-29 06:06:14] [config] data-weighting: ""
[2023-07-29 06:06:14] [config] data-weighting-type: sentence
[2023-07-29 06:06:14] [config] dec-cell: gru
[2023-07-29 06:06:14] [config] dec-cell-base-depth: 2
[2023-07-29 06:06:14] [config] dec-cell-high-depth: 1
[2023-07-29 06:06:14] [config] dec-depth: 1
[2023-07-29 06:06:14] [config] devices:
[2023-07-29 06:06:14] [config]   - 0
[2023-07-29 06:06:14] [config] dim-emb: 512
[2023-07-29 06:06:14] [config] dim-rnn: 1024
[2023-07-29 06:06:14] [config] dim-vocabs:
[2023-07-29 06:06:14] [config]   - 16384
[2023-07-29 06:06:14] [config]   - 16384
[2023-07-29 06:06:14] [config] disp-first: 0
[2023-07-29 06:06:14] [config] disp-freq: 1000u
[2023-07-29 06:06:14] [config] disp-label-counts: true
[2023-07-29 06:06:14] [config] dropout-rnn: 0
[2023-07-29 06:06:14] [config] dropout-src: 0
[2023-07-29 06:06:14] [config] dropout-trg: 0
[2023-07-29 06:06:14] [config] dump-config: ""
[2023-07-29 06:06:14] [config] dynamic-gradient-scaling:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] early-stopping: 1000
[2023-07-29 06:06:14] [config] early-stopping-on: first
[2023-07-29 06:06:14] [config] embedding-fix-src: false
[2023-07-29 06:06:14] [config] embedding-fix-trg: false
[2023-07-29 06:06:14] [config] embedding-normalization: false
[2023-07-29 06:06:14] [config] embedding-vectors:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] enc-cell: gru
[2023-07-29 06:06:14] [config] enc-cell-depth: 1
[2023-07-29 06:06:14] [config] enc-depth: 1
[2023-07-29 06:06:14] [config] enc-type: bidirectional
[2023-07-29 06:06:14] [config] english-title-case-every: 0
[2023-07-29 06:06:14] [config] exponential-smoothing: 0
[2023-07-29 06:06:14] [config] factor-weight: 1
[2023-07-29 06:06:14] [config] factors-combine: sum
[2023-07-29 06:06:14] [config] factors-dim-emb: 0
[2023-07-29 06:06:14] [config] gradient-checkpointing: false
[2023-07-29 06:06:14] [config] gradient-norm-average-window: 100
[2023-07-29 06:06:14] [config] guided-alignment: none
[2023-07-29 06:06:14] [config] guided-alignment-cost: mse
[2023-07-29 06:06:14] [config] guided-alignment-weight: 0.1
[2023-07-29 06:06:14] [config] ignore-model-config: false
[2023-07-29 06:06:14] [config] input-types:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] interpolate-env-vars: false
[2023-07-29 06:06:14] [config] keep-best: false
[2023-07-29 06:06:14] [config] label-smoothing: 0
[2023-07-29 06:06:14] [config] layer-normalization: false
[2023-07-29 06:06:14] [config] learn-rate: 0.0001
[2023-07-29 06:06:14] [config] lemma-dependency: ""
[2023-07-29 06:06:14] [config] lemma-dim-emb: 0
[2023-07-29 06:06:14] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 06:06:14] [config] log-level: info
[2023-07-29 06:06:14] [config] log-time-zone: ""
[2023-07-29 06:06:14] [config] logical-epoch:
[2023-07-29 06:06:14] [config]   - 1e
[2023-07-29 06:06:14] [config]   - 0
[2023-07-29 06:06:14] [config] lr-decay: 0
[2023-07-29 06:06:14] [config] lr-decay-freq: 50000
[2023-07-29 06:06:14] [config] lr-decay-inv-sqrt:
[2023-07-29 06:06:14] [config]   - 0
[2023-07-29 06:06:14] [config] lr-decay-repeat-warmup: false
[2023-07-29 06:06:14] [config] lr-decay-reset-optimizer: false
[2023-07-29 06:06:14] [config] lr-decay-start:
[2023-07-29 06:06:14] [config]   - 10
[2023-07-29 06:06:14] [config]   - 1
[2023-07-29 06:06:14] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 06:06:14] [config] lr-report: false
[2023-07-29 06:06:14] [config] lr-warmup: 0
[2023-07-29 06:06:14] [config] lr-warmup-at-reload: false
[2023-07-29 06:06:14] [config] lr-warmup-cycle: false
[2023-07-29 06:06:14] [config] lr-warmup-start-rate: 0
[2023-07-29 06:06:14] [config] max-length: 250
[2023-07-29 06:06:14] [config] max-length-crop: true
[2023-07-29 06:06:14] [config] max-length-factor: 3
[2023-07-29 06:06:14] [config] maxi-batch: 100
[2023-07-29 06:06:14] [config] maxi-batch-sort: trg
[2023-07-29 06:06:14] [config] mini-batch: 64
[2023-07-29 06:06:14] [config] mini-batch-fit: true
[2023-07-29 06:06:14] [config] mini-batch-fit-step: 10
[2023-07-29 06:06:14] [config] mini-batch-round-up: true
[2023-07-29 06:06:14] [config] mini-batch-track-lr: false
[2023-07-29 06:06:14] [config] mini-batch-warmup: 0
[2023-07-29 06:06:14] [config] mini-batch-words: 0
[2023-07-29 06:06:14] [config] mini-batch-words-ref: 0
[2023-07-29 06:06:14] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 06:06:14] [config] multi-loss-type: sum
[2023-07-29 06:06:14] [config] n-best: false
[2023-07-29 06:06:14] [config] no-nccl: false
[2023-07-29 06:06:14] [config] no-reload: false
[2023-07-29 06:06:14] [config] no-restore-corpus: false
[2023-07-29 06:06:14] [config] normalize: 0
[2023-07-29 06:06:14] [config] normalize-gradient: false
[2023-07-29 06:06:14] [config] num-devices: 0
[2023-07-29 06:06:14] [config] optimizer: adam
[2023-07-29 06:06:14] [config] optimizer-delay: 1
[2023-07-29 06:06:14] [config] optimizer-params:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] output-omit-bias: false
[2023-07-29 06:06:14] [config] overwrite: true
[2023-07-29 06:06:14] [config] precision:
[2023-07-29 06:06:14] [config]   - float16
[2023-07-29 06:06:14] [config]   - float32
[2023-07-29 06:06:14] [config] pretrained-model: ""
[2023-07-29 06:06:14] [config] quantize-biases: false
[2023-07-29 06:06:14] [config] quantize-bits: 0
[2023-07-29 06:06:14] [config] quantize-log-based: false
[2023-07-29 06:06:14] [config] quantize-optimization-steps: 0
[2023-07-29 06:06:14] [config] quiet: false
[2023-07-29 06:06:14] [config] quiet-translation: true
[2023-07-29 06:06:14] [config] relative-paths: false
[2023-07-29 06:06:14] [config] right-left: false
[2023-07-29 06:06:14] [config] save-freq: 10000u
[2023-07-29 06:06:14] [config] seed: 1234
[2023-07-29 06:06:14] [config] sentencepiece-alphas:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] sentencepiece-max-lines: 2000000
[2023-07-29 06:06:14] [config] sentencepiece-options: ""
[2023-07-29 06:06:14] [config] sharding: global
[2023-07-29 06:06:14] [config] shuffle: data
[2023-07-29 06:06:14] [config] shuffle-in-ram: false
[2023-07-29 06:06:14] [config] sigterm: save-and-exit
[2023-07-29 06:06:14] [config] skip: false
[2023-07-29 06:06:14] [config] sqlite: ""
[2023-07-29 06:06:14] [config] sqlite-drop: false
[2023-07-29 06:06:14] [config] sync-freq: 200u
[2023-07-29 06:06:14] [config] sync-sgd: false
[2023-07-29 06:06:14] [config] tempdir: /tmp
[2023-07-29 06:06:14] [config] tied-embeddings: false
[2023-07-29 06:06:14] [config] tied-embeddings-all: true
[2023-07-29 06:06:14] [config] tied-embeddings-src: false
[2023-07-29 06:06:14] [config] train-embedder-rank:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] train-sets:
[2023-07-29 06:06:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 06:06:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 06:06:14] [config] transformer-aan-activation: swish
[2023-07-29 06:06:14] [config] transformer-aan-depth: 2
[2023-07-29 06:06:14] [config] transformer-aan-nogate: false
[2023-07-29 06:06:14] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 06:06:14] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 06:06:14] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 06:06:14] [config] transformer-depth-scaling: false
[2023-07-29 06:06:14] [config] transformer-dim-aan: 2048
[2023-07-29 06:06:14] [config] transformer-dim-ffn: 2048
[2023-07-29 06:06:14] [config] transformer-dropout: 0
[2023-07-29 06:06:14] [config] transformer-dropout-attention: 0
[2023-07-29 06:06:14] [config] transformer-dropout-ffn: 0
[2023-07-29 06:06:14] [config] transformer-ffn-activation: swish
[2023-07-29 06:06:14] [config] transformer-ffn-depth: 2
[2023-07-29 06:06:14] [config] transformer-guided-alignment-layer: last
[2023-07-29 06:06:14] [config] transformer-heads: 8
[2023-07-29 06:06:14] [config] transformer-no-projection: false
[2023-07-29 06:06:14] [config] transformer-pool: false
[2023-07-29 06:06:14] [config] transformer-postprocess: dan
[2023-07-29 06:06:14] [config] transformer-postprocess-emb: d
[2023-07-29 06:06:14] [config] transformer-postprocess-top: ""
[2023-07-29 06:06:14] [config] transformer-preprocess: ""
[2023-07-29 06:06:14] [config] transformer-tied-layers:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] transformer-train-position-embeddings: false
[2023-07-29 06:06:14] [config] tsv: false
[2023-07-29 06:06:14] [config] tsv-fields: 0
[2023-07-29 06:06:14] [config] type: s2s
[2023-07-29 06:06:14] [config] ulr: false
[2023-07-29 06:06:14] [config] ulr-dim-emb: 0
[2023-07-29 06:06:14] [config] ulr-dropout: 0
[2023-07-29 06:06:14] [config] ulr-keys-vectors: ""
[2023-07-29 06:06:14] [config] ulr-query-vectors: ""
[2023-07-29 06:06:14] [config] ulr-softmax-temperature: 1
[2023-07-29 06:06:14] [config] ulr-trainable-transformation: false
[2023-07-29 06:06:14] [config] unlikelihood-loss: false
[2023-07-29 06:06:14] [config] valid-freq: 50000000
[2023-07-29 06:06:14] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 06:06:14] [config] valid-max-length: 1000
[2023-07-29 06:06:14] [config] valid-metrics:
[2023-07-29 06:06:14] [config]   - translation
[2023-07-29 06:06:14] [config] valid-mini-batch: 32
[2023-07-29 06:06:14] [config] valid-reset-stalled: false
[2023-07-29 06:06:14] [config] valid-script-args:
[2023-07-29 06:06:14] [config]   []
[2023-07-29 06:06:14] [config] valid-script-path: ""
[2023-07-29 06:06:14] [config] valid-sets:
[2023-07-29 06:06:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 06:06:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 06:06:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 06:06:14] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 06:06:14] [config] vocabs:
[2023-07-29 06:06:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 06:06:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 06:06:14] [config] word-penalty: 0
[2023-07-29 06:06:14] [config] word-scores: false
[2023-07-29 06:06:14] [config] workspace: 5500
[2023-07-29 06:06:14] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 06:06:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 06:06:14] [training] Using single-device training
[2023-07-29 06:06:14] Synced seed 1234
[2023-07-29 06:06:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 06:06:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 06:06:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 06:06:14] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 06:06:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 06:06:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 06:06:14] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 06:06:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 06:06:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 06:06:15] [comm] Using global sharding
[2023-07-29 06:06:15] [comm] NCCLCommunicators constructed successfully
[2023-07-29 06:06:15] [training] Using 1 GPUs
[2023-07-29 06:06:15] [logits] Applying loss function for 1 factor(s)
[2023-07-29 06:06:15] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:06:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 06:06:15] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:43:06] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 06:43:06] [valid] No post-processing script given for validating translator
[2023-07-29 06:43:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 06:43:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 06:43:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 06:43:06] [comm] Using global sharding
[2023-07-29 06:43:06] [comm] NCCLCommunicators constructed successfully
[2023-07-29 06:43:06] [training] Using 1 GPUs
[2023-07-29 06:43:06] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 06:43:07] Allocating memory for general optimizer shards
[2023-07-29 06:43:07] [memory] Reserving 322 MB, device gpu0
[2023-07-29 06:43:07] Loading Adam parameters
[2023-07-29 06:43:08] [memory] Reserving 322 MB, device gpu0
[2023-07-29 06:43:08] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:43:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 06:43:08] [data] Restoring the corpus state to epoch 351, batch 13587
[2023-07-29 06:43:08] [data] Shuffling data
[2023-07-29 06:43:08] [data] Done reading 20,192 sentences
[2023-07-29 06:43:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:43:08] Training started
[2023-07-29 06:43:08] Training finished
[2023-07-29 06:43:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 06:43:11] [marian] Running on node01.datos.cluster.uy as process 15259 with command line:
[2023-07-29 06:43:11] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 06:43:11] [config] after: 0e
[2023-07-29 06:43:11] [config] after-batches: 0
[2023-07-29 06:43:11] [config] after-epochs: 160
[2023-07-29 06:43:11] [config] all-caps-every: 0
[2023-07-29 06:43:11] [config] allow-unk: false
[2023-07-29 06:43:11] [config] authors: false
[2023-07-29 06:43:11] [config] beam-size: 12
[2023-07-29 06:43:11] [config] bert-class-symbol: "[CLS]"
[2023-07-29 06:43:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 06:43:11] [config] bert-masking-fraction: 0.15
[2023-07-29 06:43:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 06:43:11] [config] bert-train-type-embeddings: true
[2023-07-29 06:43:11] [config] bert-type-vocab-size: 2
[2023-07-29 06:43:11] [config] build-info: ""
[2023-07-29 06:43:11] [config] check-gradient-nan: false
[2023-07-29 06:43:11] [config] check-nan: false
[2023-07-29 06:43:11] [config] cite: false
[2023-07-29 06:43:11] [config] clip-norm: 1
[2023-07-29 06:43:11] [config] cost-scaling:
[2023-07-29 06:43:11] [config]   - 256.f
[2023-07-29 06:43:11] [config]   - 1000
[2023-07-29 06:43:11] [config]   - 2.f
[2023-07-29 06:43:11] [config]   - 256.f
[2023-07-29 06:43:11] [config] cost-type: ce-sum
[2023-07-29 06:43:11] [config] cpu-threads: 0
[2023-07-29 06:43:11] [config] data-threads: 8
[2023-07-29 06:43:11] [config] data-weighting: ""
[2023-07-29 06:43:11] [config] data-weighting-type: sentence
[2023-07-29 06:43:11] [config] dec-cell: gru
[2023-07-29 06:43:11] [config] dec-cell-base-depth: 2
[2023-07-29 06:43:11] [config] dec-cell-high-depth: 1
[2023-07-29 06:43:11] [config] dec-depth: 1
[2023-07-29 06:43:11] [config] devices:
[2023-07-29 06:43:11] [config]   - 0
[2023-07-29 06:43:11] [config] dim-emb: 512
[2023-07-29 06:43:11] [config] dim-rnn: 1024
[2023-07-29 06:43:11] [config] dim-vocabs:
[2023-07-29 06:43:11] [config]   - 16384
[2023-07-29 06:43:11] [config]   - 16384
[2023-07-29 06:43:11] [config] disp-first: 0
[2023-07-29 06:43:11] [config] disp-freq: 1000u
[2023-07-29 06:43:11] [config] disp-label-counts: true
[2023-07-29 06:43:11] [config] dropout-rnn: 0
[2023-07-29 06:43:11] [config] dropout-src: 0
[2023-07-29 06:43:11] [config] dropout-trg: 0
[2023-07-29 06:43:11] [config] dump-config: ""
[2023-07-29 06:43:11] [config] dynamic-gradient-scaling:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] early-stopping: 1000
[2023-07-29 06:43:11] [config] early-stopping-on: first
[2023-07-29 06:43:11] [config] embedding-fix-src: false
[2023-07-29 06:43:11] [config] embedding-fix-trg: false
[2023-07-29 06:43:11] [config] embedding-normalization: false
[2023-07-29 06:43:11] [config] embedding-vectors:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] enc-cell: gru
[2023-07-29 06:43:11] [config] enc-cell-depth: 1
[2023-07-29 06:43:11] [config] enc-depth: 1
[2023-07-29 06:43:11] [config] enc-type: bidirectional
[2023-07-29 06:43:11] [config] english-title-case-every: 0
[2023-07-29 06:43:11] [config] exponential-smoothing: 0
[2023-07-29 06:43:11] [config] factor-weight: 1
[2023-07-29 06:43:11] [config] factors-combine: sum
[2023-07-29 06:43:11] [config] factors-dim-emb: 0
[2023-07-29 06:43:11] [config] gradient-checkpointing: false
[2023-07-29 06:43:11] [config] gradient-norm-average-window: 100
[2023-07-29 06:43:11] [config] guided-alignment: none
[2023-07-29 06:43:11] [config] guided-alignment-cost: mse
[2023-07-29 06:43:11] [config] guided-alignment-weight: 0.1
[2023-07-29 06:43:11] [config] ignore-model-config: false
[2023-07-29 06:43:11] [config] input-types:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] interpolate-env-vars: false
[2023-07-29 06:43:11] [config] keep-best: false
[2023-07-29 06:43:11] [config] label-smoothing: 0
[2023-07-29 06:43:11] [config] layer-normalization: false
[2023-07-29 06:43:11] [config] learn-rate: 0.0001
[2023-07-29 06:43:11] [config] lemma-dependency: ""
[2023-07-29 06:43:11] [config] lemma-dim-emb: 0
[2023-07-29 06:43:11] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 06:43:11] [config] log-level: info
[2023-07-29 06:43:11] [config] log-time-zone: ""
[2023-07-29 06:43:11] [config] logical-epoch:
[2023-07-29 06:43:11] [config]   - 1e
[2023-07-29 06:43:11] [config]   - 0
[2023-07-29 06:43:11] [config] lr-decay: 0
[2023-07-29 06:43:11] [config] lr-decay-freq: 50000
[2023-07-29 06:43:11] [config] lr-decay-inv-sqrt:
[2023-07-29 06:43:11] [config]   - 0
[2023-07-29 06:43:11] [config] lr-decay-repeat-warmup: false
[2023-07-29 06:43:11] [config] lr-decay-reset-optimizer: false
[2023-07-29 06:43:11] [config] lr-decay-start:
[2023-07-29 06:43:11] [config]   - 10
[2023-07-29 06:43:11] [config]   - 1
[2023-07-29 06:43:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 06:43:11] [config] lr-report: false
[2023-07-29 06:43:11] [config] lr-warmup: 0
[2023-07-29 06:43:11] [config] lr-warmup-at-reload: false
[2023-07-29 06:43:11] [config] lr-warmup-cycle: false
[2023-07-29 06:43:11] [config] lr-warmup-start-rate: 0
[2023-07-29 06:43:11] [config] max-length: 250
[2023-07-29 06:43:11] [config] max-length-crop: true
[2023-07-29 06:43:11] [config] max-length-factor: 3
[2023-07-29 06:43:11] [config] maxi-batch: 100
[2023-07-29 06:43:11] [config] maxi-batch-sort: trg
[2023-07-29 06:43:11] [config] mini-batch: 64
[2023-07-29 06:43:11] [config] mini-batch-fit: true
[2023-07-29 06:43:11] [config] mini-batch-fit-step: 10
[2023-07-29 06:43:11] [config] mini-batch-round-up: true
[2023-07-29 06:43:11] [config] mini-batch-track-lr: false
[2023-07-29 06:43:11] [config] mini-batch-warmup: 0
[2023-07-29 06:43:11] [config] mini-batch-words: 0
[2023-07-29 06:43:11] [config] mini-batch-words-ref: 0
[2023-07-29 06:43:11] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 06:43:11] [config] multi-loss-type: sum
[2023-07-29 06:43:11] [config] n-best: false
[2023-07-29 06:43:11] [config] no-nccl: false
[2023-07-29 06:43:11] [config] no-reload: false
[2023-07-29 06:43:11] [config] no-restore-corpus: false
[2023-07-29 06:43:11] [config] normalize: 0
[2023-07-29 06:43:11] [config] normalize-gradient: false
[2023-07-29 06:43:11] [config] num-devices: 0
[2023-07-29 06:43:11] [config] optimizer: adam
[2023-07-29 06:43:11] [config] optimizer-delay: 1
[2023-07-29 06:43:11] [config] optimizer-params:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] output-omit-bias: false
[2023-07-29 06:43:11] [config] overwrite: true
[2023-07-29 06:43:11] [config] precision:
[2023-07-29 06:43:11] [config]   - float16
[2023-07-29 06:43:11] [config]   - float32
[2023-07-29 06:43:11] [config] pretrained-model: ""
[2023-07-29 06:43:11] [config] quantize-biases: false
[2023-07-29 06:43:11] [config] quantize-bits: 0
[2023-07-29 06:43:11] [config] quantize-log-based: false
[2023-07-29 06:43:11] [config] quantize-optimization-steps: 0
[2023-07-29 06:43:11] [config] quiet: false
[2023-07-29 06:43:11] [config] quiet-translation: true
[2023-07-29 06:43:11] [config] relative-paths: false
[2023-07-29 06:43:11] [config] right-left: false
[2023-07-29 06:43:11] [config] save-freq: 10000u
[2023-07-29 06:43:11] [config] seed: 1234
[2023-07-29 06:43:11] [config] sentencepiece-alphas:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] sentencepiece-max-lines: 2000000
[2023-07-29 06:43:11] [config] sentencepiece-options: ""
[2023-07-29 06:43:11] [config] sharding: global
[2023-07-29 06:43:11] [config] shuffle: data
[2023-07-29 06:43:11] [config] shuffle-in-ram: false
[2023-07-29 06:43:11] [config] sigterm: save-and-exit
[2023-07-29 06:43:11] [config] skip: false
[2023-07-29 06:43:11] [config] sqlite: ""
[2023-07-29 06:43:11] [config] sqlite-drop: false
[2023-07-29 06:43:11] [config] sync-freq: 200u
[2023-07-29 06:43:11] [config] sync-sgd: false
[2023-07-29 06:43:11] [config] tempdir: /tmp
[2023-07-29 06:43:11] [config] tied-embeddings: false
[2023-07-29 06:43:11] [config] tied-embeddings-all: true
[2023-07-29 06:43:11] [config] tied-embeddings-src: false
[2023-07-29 06:43:11] [config] train-embedder-rank:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] train-sets:
[2023-07-29 06:43:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 06:43:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 06:43:11] [config] transformer-aan-activation: swish
[2023-07-29 06:43:11] [config] transformer-aan-depth: 2
[2023-07-29 06:43:11] [config] transformer-aan-nogate: false
[2023-07-29 06:43:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 06:43:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 06:43:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 06:43:11] [config] transformer-depth-scaling: false
[2023-07-29 06:43:11] [config] transformer-dim-aan: 2048
[2023-07-29 06:43:11] [config] transformer-dim-ffn: 2048
[2023-07-29 06:43:11] [config] transformer-dropout: 0
[2023-07-29 06:43:11] [config] transformer-dropout-attention: 0
[2023-07-29 06:43:11] [config] transformer-dropout-ffn: 0
[2023-07-29 06:43:11] [config] transformer-ffn-activation: swish
[2023-07-29 06:43:11] [config] transformer-ffn-depth: 2
[2023-07-29 06:43:11] [config] transformer-guided-alignment-layer: last
[2023-07-29 06:43:11] [config] transformer-heads: 8
[2023-07-29 06:43:11] [config] transformer-no-projection: false
[2023-07-29 06:43:11] [config] transformer-pool: false
[2023-07-29 06:43:11] [config] transformer-postprocess: dan
[2023-07-29 06:43:11] [config] transformer-postprocess-emb: d
[2023-07-29 06:43:11] [config] transformer-postprocess-top: ""
[2023-07-29 06:43:11] [config] transformer-preprocess: ""
[2023-07-29 06:43:11] [config] transformer-tied-layers:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] transformer-train-position-embeddings: false
[2023-07-29 06:43:11] [config] tsv: false
[2023-07-29 06:43:11] [config] tsv-fields: 0
[2023-07-29 06:43:11] [config] type: s2s
[2023-07-29 06:43:11] [config] ulr: false
[2023-07-29 06:43:11] [config] ulr-dim-emb: 0
[2023-07-29 06:43:11] [config] ulr-dropout: 0
[2023-07-29 06:43:11] [config] ulr-keys-vectors: ""
[2023-07-29 06:43:11] [config] ulr-query-vectors: ""
[2023-07-29 06:43:11] [config] ulr-softmax-temperature: 1
[2023-07-29 06:43:11] [config] ulr-trainable-transformation: false
[2023-07-29 06:43:11] [config] unlikelihood-loss: false
[2023-07-29 06:43:11] [config] valid-freq: 50000000
[2023-07-29 06:43:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 06:43:11] [config] valid-max-length: 1000
[2023-07-29 06:43:11] [config] valid-metrics:
[2023-07-29 06:43:11] [config]   - translation
[2023-07-29 06:43:11] [config] valid-mini-batch: 32
[2023-07-29 06:43:11] [config] valid-reset-stalled: false
[2023-07-29 06:43:11] [config] valid-script-args:
[2023-07-29 06:43:11] [config]   []
[2023-07-29 06:43:11] [config] valid-script-path: ""
[2023-07-29 06:43:11] [config] valid-sets:
[2023-07-29 06:43:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 06:43:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 06:43:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 06:43:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 06:43:11] [config] vocabs:
[2023-07-29 06:43:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 06:43:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 06:43:11] [config] word-penalty: 0
[2023-07-29 06:43:11] [config] word-scores: false
[2023-07-29 06:43:11] [config] workspace: 5500
[2023-07-29 06:43:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 06:43:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 06:43:11] [training] Using single-device training
[2023-07-29 06:43:12] Synced seed 1234
[2023-07-29 06:43:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 06:43:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 06:43:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 06:43:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 06:43:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 06:43:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 06:43:12] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 06:43:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 06:43:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 06:43:13] [comm] Using global sharding
[2023-07-29 06:43:13] [comm] NCCLCommunicators constructed successfully
[2023-07-29 06:43:13] [training] Using 1 GPUs
[2023-07-29 06:43:13] [logits] Applying loss function for 1 factor(s)
[2023-07-29 06:43:13] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:43:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 06:43:13] [memory] Reserving 80 MB, device gpu0
[2023-07-29 07:20:03] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 07:20:03] [valid] No post-processing script given for validating translator
[2023-07-29 07:20:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:20:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 07:20:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 07:20:03] [comm] Using global sharding
[2023-07-29 07:20:03] [comm] NCCLCommunicators constructed successfully
[2023-07-29 07:20:03] [training] Using 1 GPUs
[2023-07-29 07:20:03] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 07:20:05] Allocating memory for general optimizer shards
[2023-07-29 07:20:05] [memory] Reserving 322 MB, device gpu0
[2023-07-29 07:20:05] Loading Adam parameters
[2023-07-29 07:20:05] [memory] Reserving 322 MB, device gpu0
[2023-07-29 07:20:05] [memory] Reserving 80 MB, device gpu0
[2023-07-29 07:20:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 07:20:05] [data] Restoring the corpus state to epoch 361, batch 13973
[2023-07-29 07:20:05] [data] Shuffling data
[2023-07-29 07:20:05] [data] Done reading 20,192 sentences
[2023-07-29 07:20:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 07:20:05] Training started
[2023-07-29 07:20:05] Training finished
[2023-07-29 07:20:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:20:09] [marian] Running on node01.datos.cluster.uy as process 17888 with command line:
[2023-07-29 07:20:09] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 07:20:09] [config] after: 0e
[2023-07-29 07:20:09] [config] after-batches: 0
[2023-07-29 07:20:09] [config] after-epochs: 170
[2023-07-29 07:20:09] [config] all-caps-every: 0
[2023-07-29 07:20:09] [config] allow-unk: false
[2023-07-29 07:20:09] [config] authors: false
[2023-07-29 07:20:09] [config] beam-size: 12
[2023-07-29 07:20:09] [config] bert-class-symbol: "[CLS]"
[2023-07-29 07:20:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 07:20:09] [config] bert-masking-fraction: 0.15
[2023-07-29 07:20:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 07:20:09] [config] bert-train-type-embeddings: true
[2023-07-29 07:20:09] [config] bert-type-vocab-size: 2
[2023-07-29 07:20:09] [config] build-info: ""
[2023-07-29 07:20:09] [config] check-gradient-nan: false
[2023-07-29 07:20:09] [config] check-nan: false
[2023-07-29 07:20:09] [config] cite: false
[2023-07-29 07:20:09] [config] clip-norm: 1
[2023-07-29 07:20:09] [config] cost-scaling:
[2023-07-29 07:20:09] [config]   - 256.f
[2023-07-29 07:20:09] [config]   - 1000
[2023-07-29 07:20:09] [config]   - 2.f
[2023-07-29 07:20:09] [config]   - 256.f
[2023-07-29 07:20:09] [config] cost-type: ce-sum
[2023-07-29 07:20:09] [config] cpu-threads: 0
[2023-07-29 07:20:09] [config] data-threads: 8
[2023-07-29 07:20:09] [config] data-weighting: ""
[2023-07-29 07:20:09] [config] data-weighting-type: sentence
[2023-07-29 07:20:09] [config] dec-cell: gru
[2023-07-29 07:20:09] [config] dec-cell-base-depth: 2
[2023-07-29 07:20:09] [config] dec-cell-high-depth: 1
[2023-07-29 07:20:09] [config] dec-depth: 1
[2023-07-29 07:20:09] [config] devices:
[2023-07-29 07:20:09] [config]   - 0
[2023-07-29 07:20:09] [config] dim-emb: 512
[2023-07-29 07:20:09] [config] dim-rnn: 1024
[2023-07-29 07:20:09] [config] dim-vocabs:
[2023-07-29 07:20:09] [config]   - 16384
[2023-07-29 07:20:09] [config]   - 16384
[2023-07-29 07:20:09] [config] disp-first: 0
[2023-07-29 07:20:09] [config] disp-freq: 1000u
[2023-07-29 07:20:09] [config] disp-label-counts: true
[2023-07-29 07:20:09] [config] dropout-rnn: 0
[2023-07-29 07:20:09] [config] dropout-src: 0
[2023-07-29 07:20:09] [config] dropout-trg: 0
[2023-07-29 07:20:09] [config] dump-config: ""
[2023-07-29 07:20:09] [config] dynamic-gradient-scaling:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] early-stopping: 1000
[2023-07-29 07:20:09] [config] early-stopping-on: first
[2023-07-29 07:20:09] [config] embedding-fix-src: false
[2023-07-29 07:20:09] [config] embedding-fix-trg: false
[2023-07-29 07:20:09] [config] embedding-normalization: false
[2023-07-29 07:20:09] [config] embedding-vectors:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] enc-cell: gru
[2023-07-29 07:20:09] [config] enc-cell-depth: 1
[2023-07-29 07:20:09] [config] enc-depth: 1
[2023-07-29 07:20:09] [config] enc-type: bidirectional
[2023-07-29 07:20:09] [config] english-title-case-every: 0
[2023-07-29 07:20:09] [config] exponential-smoothing: 0
[2023-07-29 07:20:09] [config] factor-weight: 1
[2023-07-29 07:20:09] [config] factors-combine: sum
[2023-07-29 07:20:09] [config] factors-dim-emb: 0
[2023-07-29 07:20:09] [config] gradient-checkpointing: false
[2023-07-29 07:20:09] [config] gradient-norm-average-window: 100
[2023-07-29 07:20:09] [config] guided-alignment: none
[2023-07-29 07:20:09] [config] guided-alignment-cost: mse
[2023-07-29 07:20:09] [config] guided-alignment-weight: 0.1
[2023-07-29 07:20:09] [config] ignore-model-config: false
[2023-07-29 07:20:09] [config] input-types:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] interpolate-env-vars: false
[2023-07-29 07:20:09] [config] keep-best: false
[2023-07-29 07:20:09] [config] label-smoothing: 0
[2023-07-29 07:20:09] [config] layer-normalization: false
[2023-07-29 07:20:09] [config] learn-rate: 0.0001
[2023-07-29 07:20:09] [config] lemma-dependency: ""
[2023-07-29 07:20:09] [config] lemma-dim-emb: 0
[2023-07-29 07:20:09] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 07:20:09] [config] log-level: info
[2023-07-29 07:20:09] [config] log-time-zone: ""
[2023-07-29 07:20:09] [config] logical-epoch:
[2023-07-29 07:20:09] [config]   - 1e
[2023-07-29 07:20:09] [config]   - 0
[2023-07-29 07:20:09] [config] lr-decay: 0
[2023-07-29 07:20:09] [config] lr-decay-freq: 50000
[2023-07-29 07:20:09] [config] lr-decay-inv-sqrt:
[2023-07-29 07:20:09] [config]   - 0
[2023-07-29 07:20:09] [config] lr-decay-repeat-warmup: false
[2023-07-29 07:20:09] [config] lr-decay-reset-optimizer: false
[2023-07-29 07:20:09] [config] lr-decay-start:
[2023-07-29 07:20:09] [config]   - 10
[2023-07-29 07:20:09] [config]   - 1
[2023-07-29 07:20:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 07:20:09] [config] lr-report: false
[2023-07-29 07:20:09] [config] lr-warmup: 0
[2023-07-29 07:20:09] [config] lr-warmup-at-reload: false
[2023-07-29 07:20:09] [config] lr-warmup-cycle: false
[2023-07-29 07:20:09] [config] lr-warmup-start-rate: 0
[2023-07-29 07:20:09] [config] max-length: 250
[2023-07-29 07:20:09] [config] max-length-crop: true
[2023-07-29 07:20:09] [config] max-length-factor: 3
[2023-07-29 07:20:09] [config] maxi-batch: 100
[2023-07-29 07:20:09] [config] maxi-batch-sort: trg
[2023-07-29 07:20:09] [config] mini-batch: 64
[2023-07-29 07:20:09] [config] mini-batch-fit: true
[2023-07-29 07:20:09] [config] mini-batch-fit-step: 10
[2023-07-29 07:20:09] [config] mini-batch-round-up: true
[2023-07-29 07:20:09] [config] mini-batch-track-lr: false
[2023-07-29 07:20:09] [config] mini-batch-warmup: 0
[2023-07-29 07:20:09] [config] mini-batch-words: 0
[2023-07-29 07:20:09] [config] mini-batch-words-ref: 0
[2023-07-29 07:20:09] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 07:20:09] [config] multi-loss-type: sum
[2023-07-29 07:20:09] [config] n-best: false
[2023-07-29 07:20:09] [config] no-nccl: false
[2023-07-29 07:20:09] [config] no-reload: false
[2023-07-29 07:20:09] [config] no-restore-corpus: false
[2023-07-29 07:20:09] [config] normalize: 0
[2023-07-29 07:20:09] [config] normalize-gradient: false
[2023-07-29 07:20:09] [config] num-devices: 0
[2023-07-29 07:20:09] [config] optimizer: adam
[2023-07-29 07:20:09] [config] optimizer-delay: 1
[2023-07-29 07:20:09] [config] optimizer-params:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] output-omit-bias: false
[2023-07-29 07:20:09] [config] overwrite: true
[2023-07-29 07:20:09] [config] precision:
[2023-07-29 07:20:09] [config]   - float16
[2023-07-29 07:20:09] [config]   - float32
[2023-07-29 07:20:09] [config] pretrained-model: ""
[2023-07-29 07:20:09] [config] quantize-biases: false
[2023-07-29 07:20:09] [config] quantize-bits: 0
[2023-07-29 07:20:09] [config] quantize-log-based: false
[2023-07-29 07:20:09] [config] quantize-optimization-steps: 0
[2023-07-29 07:20:09] [config] quiet: false
[2023-07-29 07:20:09] [config] quiet-translation: true
[2023-07-29 07:20:09] [config] relative-paths: false
[2023-07-29 07:20:09] [config] right-left: false
[2023-07-29 07:20:09] [config] save-freq: 10000u
[2023-07-29 07:20:09] [config] seed: 1234
[2023-07-29 07:20:09] [config] sentencepiece-alphas:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] sentencepiece-max-lines: 2000000
[2023-07-29 07:20:09] [config] sentencepiece-options: ""
[2023-07-29 07:20:09] [config] sharding: global
[2023-07-29 07:20:09] [config] shuffle: data
[2023-07-29 07:20:09] [config] shuffle-in-ram: false
[2023-07-29 07:20:09] [config] sigterm: save-and-exit
[2023-07-29 07:20:09] [config] skip: false
[2023-07-29 07:20:09] [config] sqlite: ""
[2023-07-29 07:20:09] [config] sqlite-drop: false
[2023-07-29 07:20:09] [config] sync-freq: 200u
[2023-07-29 07:20:09] [config] sync-sgd: false
[2023-07-29 07:20:09] [config] tempdir: /tmp
[2023-07-29 07:20:09] [config] tied-embeddings: false
[2023-07-29 07:20:09] [config] tied-embeddings-all: true
[2023-07-29 07:20:09] [config] tied-embeddings-src: false
[2023-07-29 07:20:09] [config] train-embedder-rank:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] train-sets:
[2023-07-29 07:20:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 07:20:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 07:20:09] [config] transformer-aan-activation: swish
[2023-07-29 07:20:09] [config] transformer-aan-depth: 2
[2023-07-29 07:20:09] [config] transformer-aan-nogate: false
[2023-07-29 07:20:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 07:20:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 07:20:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 07:20:09] [config] transformer-depth-scaling: false
[2023-07-29 07:20:09] [config] transformer-dim-aan: 2048
[2023-07-29 07:20:09] [config] transformer-dim-ffn: 2048
[2023-07-29 07:20:09] [config] transformer-dropout: 0
[2023-07-29 07:20:09] [config] transformer-dropout-attention: 0
[2023-07-29 07:20:09] [config] transformer-dropout-ffn: 0
[2023-07-29 07:20:09] [config] transformer-ffn-activation: swish
[2023-07-29 07:20:09] [config] transformer-ffn-depth: 2
[2023-07-29 07:20:09] [config] transformer-guided-alignment-layer: last
[2023-07-29 07:20:09] [config] transformer-heads: 8
[2023-07-29 07:20:09] [config] transformer-no-projection: false
[2023-07-29 07:20:09] [config] transformer-pool: false
[2023-07-29 07:20:09] [config] transformer-postprocess: dan
[2023-07-29 07:20:09] [config] transformer-postprocess-emb: d
[2023-07-29 07:20:09] [config] transformer-postprocess-top: ""
[2023-07-29 07:20:09] [config] transformer-preprocess: ""
[2023-07-29 07:20:09] [config] transformer-tied-layers:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] transformer-train-position-embeddings: false
[2023-07-29 07:20:09] [config] tsv: false
[2023-07-29 07:20:09] [config] tsv-fields: 0
[2023-07-29 07:20:09] [config] type: s2s
[2023-07-29 07:20:09] [config] ulr: false
[2023-07-29 07:20:09] [config] ulr-dim-emb: 0
[2023-07-29 07:20:09] [config] ulr-dropout: 0
[2023-07-29 07:20:09] [config] ulr-keys-vectors: ""
[2023-07-29 07:20:09] [config] ulr-query-vectors: ""
[2023-07-29 07:20:09] [config] ulr-softmax-temperature: 1
[2023-07-29 07:20:09] [config] ulr-trainable-transformation: false
[2023-07-29 07:20:09] [config] unlikelihood-loss: false
[2023-07-29 07:20:09] [config] valid-freq: 50000000
[2023-07-29 07:20:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 07:20:09] [config] valid-max-length: 1000
[2023-07-29 07:20:09] [config] valid-metrics:
[2023-07-29 07:20:09] [config]   - translation
[2023-07-29 07:20:09] [config] valid-mini-batch: 32
[2023-07-29 07:20:09] [config] valid-reset-stalled: false
[2023-07-29 07:20:09] [config] valid-script-args:
[2023-07-29 07:20:09] [config]   []
[2023-07-29 07:20:09] [config] valid-script-path: ""
[2023-07-29 07:20:09] [config] valid-sets:
[2023-07-29 07:20:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 07:20:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 07:20:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 07:20:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:20:09] [config] vocabs:
[2023-07-29 07:20:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 07:20:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 07:20:09] [config] word-penalty: 0
[2023-07-29 07:20:09] [config] word-scores: false
[2023-07-29 07:20:09] [config] workspace: 5500
[2023-07-29 07:20:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:20:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:20:09] [training] Using single-device training
[2023-07-29 07:20:09] Synced seed 1234
[2023-07-29 07:20:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 07:20:09] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 07:20:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 07:20:09] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 07:20:09] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 07:20:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:20:09] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 07:20:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 07:20:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 07:20:10] [comm] Using global sharding
[2023-07-29 07:20:10] [comm] NCCLCommunicators constructed successfully
[2023-07-29 07:20:10] [training] Using 1 GPUs
[2023-07-29 07:20:10] [logits] Applying loss function for 1 factor(s)
[2023-07-29 07:20:10] [memory] Reserving 80 MB, device gpu0
[2023-07-29 07:20:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 07:20:10] [memory] Reserving 80 MB, device gpu0
[2023-07-29 07:57:01] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 07:57:01] [valid] No post-processing script given for validating translator
[2023-07-29 07:57:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:57:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 07:57:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 07:57:01] [comm] Using global sharding
[2023-07-29 07:57:01] [comm] NCCLCommunicators constructed successfully
[2023-07-29 07:57:01] [training] Using 1 GPUs
[2023-07-29 07:57:01] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 07:57:02] Allocating memory for general optimizer shards
[2023-07-29 07:57:02] [memory] Reserving 322 MB, device gpu0
[2023-07-29 07:57:02] Loading Adam parameters
[2023-07-29 07:57:02] [memory] Reserving 322 MB, device gpu0
[2023-07-29 07:57:02] [memory] Reserving 80 MB, device gpu0
[2023-07-29 07:57:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 07:57:03] [data] Restoring the corpus state to epoch 361, batch 13973
[2023-07-29 07:57:03] [data] Shuffling data
[2023-07-29 07:57:03] [data] Done reading 20,192 sentences
[2023-07-29 07:57:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 07:57:03] Training started
[2023-07-29 07:57:03] Training finished
[2023-07-29 07:57:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:57:06] [marian] Running on node01.datos.cluster.uy as process 20196 with command line:
[2023-07-29 07:57:06] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 07:57:06] [config] after: 0e
[2023-07-29 07:57:06] [config] after-batches: 0
[2023-07-29 07:57:06] [config] after-epochs: 180
[2023-07-29 07:57:06] [config] all-caps-every: 0
[2023-07-29 07:57:06] [config] allow-unk: false
[2023-07-29 07:57:06] [config] authors: false
[2023-07-29 07:57:06] [config] beam-size: 12
[2023-07-29 07:57:06] [config] bert-class-symbol: "[CLS]"
[2023-07-29 07:57:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 07:57:06] [config] bert-masking-fraction: 0.15
[2023-07-29 07:57:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 07:57:06] [config] bert-train-type-embeddings: true
[2023-07-29 07:57:06] [config] bert-type-vocab-size: 2
[2023-07-29 07:57:06] [config] build-info: ""
[2023-07-29 07:57:06] [config] check-gradient-nan: false
[2023-07-29 07:57:06] [config] check-nan: false
[2023-07-29 07:57:06] [config] cite: false
[2023-07-29 07:57:06] [config] clip-norm: 1
[2023-07-29 07:57:06] [config] cost-scaling:
[2023-07-29 07:57:06] [config]   - 256.f
[2023-07-29 07:57:06] [config]   - 1000
[2023-07-29 07:57:06] [config]   - 2.f
[2023-07-29 07:57:06] [config]   - 256.f
[2023-07-29 07:57:06] [config] cost-type: ce-sum
[2023-07-29 07:57:06] [config] cpu-threads: 0
[2023-07-29 07:57:06] [config] data-threads: 8
[2023-07-29 07:57:06] [config] data-weighting: ""
[2023-07-29 07:57:06] [config] data-weighting-type: sentence
[2023-07-29 07:57:06] [config] dec-cell: gru
[2023-07-29 07:57:06] [config] dec-cell-base-depth: 2
[2023-07-29 07:57:06] [config] dec-cell-high-depth: 1
[2023-07-29 07:57:06] [config] dec-depth: 1
[2023-07-29 07:57:06] [config] devices:
[2023-07-29 07:57:06] [config]   - 0
[2023-07-29 07:57:06] [config] dim-emb: 512
[2023-07-29 07:57:06] [config] dim-rnn: 1024
[2023-07-29 07:57:06] [config] dim-vocabs:
[2023-07-29 07:57:06] [config]   - 16384
[2023-07-29 07:57:06] [config]   - 16384
[2023-07-29 07:57:06] [config] disp-first: 0
[2023-07-29 07:57:06] [config] disp-freq: 1000u
[2023-07-29 07:57:06] [config] disp-label-counts: true
[2023-07-29 07:57:06] [config] dropout-rnn: 0
[2023-07-29 07:57:06] [config] dropout-src: 0
[2023-07-29 07:57:06] [config] dropout-trg: 0
[2023-07-29 07:57:06] [config] dump-config: ""
[2023-07-29 07:57:06] [config] dynamic-gradient-scaling:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] early-stopping: 1000
[2023-07-29 07:57:06] [config] early-stopping-on: first
[2023-07-29 07:57:06] [config] embedding-fix-src: false
[2023-07-29 07:57:06] [config] embedding-fix-trg: false
[2023-07-29 07:57:06] [config] embedding-normalization: false
[2023-07-29 07:57:06] [config] embedding-vectors:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] enc-cell: gru
[2023-07-29 07:57:06] [config] enc-cell-depth: 1
[2023-07-29 07:57:06] [config] enc-depth: 1
[2023-07-29 07:57:06] [config] enc-type: bidirectional
[2023-07-29 07:57:06] [config] english-title-case-every: 0
[2023-07-29 07:57:06] [config] exponential-smoothing: 0
[2023-07-29 07:57:06] [config] factor-weight: 1
[2023-07-29 07:57:06] [config] factors-combine: sum
[2023-07-29 07:57:06] [config] factors-dim-emb: 0
[2023-07-29 07:57:06] [config] gradient-checkpointing: false
[2023-07-29 07:57:06] [config] gradient-norm-average-window: 100
[2023-07-29 07:57:06] [config] guided-alignment: none
[2023-07-29 07:57:06] [config] guided-alignment-cost: mse
[2023-07-29 07:57:06] [config] guided-alignment-weight: 0.1
[2023-07-29 07:57:06] [config] ignore-model-config: false
[2023-07-29 07:57:06] [config] input-types:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] interpolate-env-vars: false
[2023-07-29 07:57:06] [config] keep-best: false
[2023-07-29 07:57:06] [config] label-smoothing: 0
[2023-07-29 07:57:06] [config] layer-normalization: false
[2023-07-29 07:57:06] [config] learn-rate: 0.0001
[2023-07-29 07:57:06] [config] lemma-dependency: ""
[2023-07-29 07:57:06] [config] lemma-dim-emb: 0
[2023-07-29 07:57:06] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 07:57:06] [config] log-level: info
[2023-07-29 07:57:06] [config] log-time-zone: ""
[2023-07-29 07:57:06] [config] logical-epoch:
[2023-07-29 07:57:06] [config]   - 1e
[2023-07-29 07:57:06] [config]   - 0
[2023-07-29 07:57:06] [config] lr-decay: 0
[2023-07-29 07:57:06] [config] lr-decay-freq: 50000
[2023-07-29 07:57:06] [config] lr-decay-inv-sqrt:
[2023-07-29 07:57:06] [config]   - 0
[2023-07-29 07:57:06] [config] lr-decay-repeat-warmup: false
[2023-07-29 07:57:06] [config] lr-decay-reset-optimizer: false
[2023-07-29 07:57:06] [config] lr-decay-start:
[2023-07-29 07:57:06] [config]   - 10
[2023-07-29 07:57:06] [config]   - 1
[2023-07-29 07:57:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 07:57:06] [config] lr-report: false
[2023-07-29 07:57:06] [config] lr-warmup: 0
[2023-07-29 07:57:06] [config] lr-warmup-at-reload: false
[2023-07-29 07:57:06] [config] lr-warmup-cycle: false
[2023-07-29 07:57:06] [config] lr-warmup-start-rate: 0
[2023-07-29 07:57:06] [config] max-length: 250
[2023-07-29 07:57:06] [config] max-length-crop: true
[2023-07-29 07:57:06] [config] max-length-factor: 3
[2023-07-29 07:57:06] [config] maxi-batch: 100
[2023-07-29 07:57:06] [config] maxi-batch-sort: trg
[2023-07-29 07:57:06] [config] mini-batch: 64
[2023-07-29 07:57:06] [config] mini-batch-fit: true
[2023-07-29 07:57:06] [config] mini-batch-fit-step: 10
[2023-07-29 07:57:06] [config] mini-batch-round-up: true
[2023-07-29 07:57:06] [config] mini-batch-track-lr: false
[2023-07-29 07:57:06] [config] mini-batch-warmup: 0
[2023-07-29 07:57:06] [config] mini-batch-words: 0
[2023-07-29 07:57:06] [config] mini-batch-words-ref: 0
[2023-07-29 07:57:06] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 07:57:06] [config] multi-loss-type: sum
[2023-07-29 07:57:06] [config] n-best: false
[2023-07-29 07:57:06] [config] no-nccl: false
[2023-07-29 07:57:06] [config] no-reload: false
[2023-07-29 07:57:06] [config] no-restore-corpus: false
[2023-07-29 07:57:06] [config] normalize: 0
[2023-07-29 07:57:06] [config] normalize-gradient: false
[2023-07-29 07:57:06] [config] num-devices: 0
[2023-07-29 07:57:06] [config] optimizer: adam
[2023-07-29 07:57:06] [config] optimizer-delay: 1
[2023-07-29 07:57:06] [config] optimizer-params:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] output-omit-bias: false
[2023-07-29 07:57:06] [config] overwrite: true
[2023-07-29 07:57:06] [config] precision:
[2023-07-29 07:57:06] [config]   - float16
[2023-07-29 07:57:06] [config]   - float32
[2023-07-29 07:57:06] [config] pretrained-model: ""
[2023-07-29 07:57:06] [config] quantize-biases: false
[2023-07-29 07:57:06] [config] quantize-bits: 0
[2023-07-29 07:57:06] [config] quantize-log-based: false
[2023-07-29 07:57:06] [config] quantize-optimization-steps: 0
[2023-07-29 07:57:06] [config] quiet: false
[2023-07-29 07:57:06] [config] quiet-translation: true
[2023-07-29 07:57:06] [config] relative-paths: false
[2023-07-29 07:57:06] [config] right-left: false
[2023-07-29 07:57:06] [config] save-freq: 10000u
[2023-07-29 07:57:06] [config] seed: 1234
[2023-07-29 07:57:06] [config] sentencepiece-alphas:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] sentencepiece-max-lines: 2000000
[2023-07-29 07:57:06] [config] sentencepiece-options: ""
[2023-07-29 07:57:06] [config] sharding: global
[2023-07-29 07:57:06] [config] shuffle: data
[2023-07-29 07:57:06] [config] shuffle-in-ram: false
[2023-07-29 07:57:06] [config] sigterm: save-and-exit
[2023-07-29 07:57:06] [config] skip: false
[2023-07-29 07:57:06] [config] sqlite: ""
[2023-07-29 07:57:06] [config] sqlite-drop: false
[2023-07-29 07:57:06] [config] sync-freq: 200u
[2023-07-29 07:57:06] [config] sync-sgd: false
[2023-07-29 07:57:06] [config] tempdir: /tmp
[2023-07-29 07:57:06] [config] tied-embeddings: false
[2023-07-29 07:57:06] [config] tied-embeddings-all: true
[2023-07-29 07:57:06] [config] tied-embeddings-src: false
[2023-07-29 07:57:06] [config] train-embedder-rank:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] train-sets:
[2023-07-29 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 07:57:06] [config] transformer-aan-activation: swish
[2023-07-29 07:57:06] [config] transformer-aan-depth: 2
[2023-07-29 07:57:06] [config] transformer-aan-nogate: false
[2023-07-29 07:57:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 07:57:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 07:57:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 07:57:06] [config] transformer-depth-scaling: false
[2023-07-29 07:57:06] [config] transformer-dim-aan: 2048
[2023-07-29 07:57:06] [config] transformer-dim-ffn: 2048
[2023-07-29 07:57:06] [config] transformer-dropout: 0
[2023-07-29 07:57:06] [config] transformer-dropout-attention: 0
[2023-07-29 07:57:06] [config] transformer-dropout-ffn: 0
[2023-07-29 07:57:06] [config] transformer-ffn-activation: swish
[2023-07-29 07:57:06] [config] transformer-ffn-depth: 2
[2023-07-29 07:57:06] [config] transformer-guided-alignment-layer: last
[2023-07-29 07:57:06] [config] transformer-heads: 8
[2023-07-29 07:57:06] [config] transformer-no-projection: false
[2023-07-29 07:57:06] [config] transformer-pool: false
[2023-07-29 07:57:06] [config] transformer-postprocess: dan
[2023-07-29 07:57:06] [config] transformer-postprocess-emb: d
[2023-07-29 07:57:06] [config] transformer-postprocess-top: ""
[2023-07-29 07:57:06] [config] transformer-preprocess: ""
[2023-07-29 07:57:06] [config] transformer-tied-layers:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] transformer-train-position-embeddings: false
[2023-07-29 07:57:06] [config] tsv: false
[2023-07-29 07:57:06] [config] tsv-fields: 0
[2023-07-29 07:57:06] [config] type: s2s
[2023-07-29 07:57:06] [config] ulr: false
[2023-07-29 07:57:06] [config] ulr-dim-emb: 0
[2023-07-29 07:57:06] [config] ulr-dropout: 0
[2023-07-29 07:57:06] [config] ulr-keys-vectors: ""
[2023-07-29 07:57:06] [config] ulr-query-vectors: ""
[2023-07-29 07:57:06] [config] ulr-softmax-temperature: 1
[2023-07-29 07:57:06] [config] ulr-trainable-transformation: false
[2023-07-29 07:57:06] [config] unlikelihood-loss: false
[2023-07-29 07:57:06] [config] valid-freq: 50000000
[2023-07-29 07:57:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 07:57:06] [config] valid-max-length: 1000
[2023-07-29 07:57:06] [config] valid-metrics:
[2023-07-29 07:57:06] [config]   - translation
[2023-07-29 07:57:06] [config] valid-mini-batch: 32
[2023-07-29 07:57:06] [config] valid-reset-stalled: false
[2023-07-29 07:57:06] [config] valid-script-args:
[2023-07-29 07:57:06] [config]   []
[2023-07-29 07:57:06] [config] valid-script-path: ""
[2023-07-29 07:57:06] [config] valid-sets:
[2023-07-29 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 07:57:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 07:57:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:57:06] [config] vocabs:
[2023-07-29 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 07:57:06] [config] word-penalty: 0
[2023-07-29 07:57:06] [config] word-scores: false
[2023-07-29 07:57:06] [config] workspace: 5500
[2023-07-29 07:57:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:57:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:57:06] [training] Using single-device training
[2023-07-29 07:57:07] Synced seed 1234
[2023-07-29 07:57:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 07:57:07] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 07:57:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 07:57:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 07:57:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 07:57:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:57:07] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 07:57:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 07:57:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 07:57:08] [comm] Using global sharding
[2023-07-29 07:57:08] [comm] NCCLCommunicators constructed successfully
[2023-07-29 07:57:08] [training] Using 1 GPUs
[2023-07-29 07:57:08] [logits] Applying loss function for 1 factor(s)
[2023-07-29 07:57:08] [memory] Reserving 80 MB, device gpu0
[2023-07-29 07:57:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 07:57:08] [memory] Reserving 80 MB, device gpu0
[2023-07-29 08:33:58] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 08:33:58] [valid] No post-processing script given for validating translator
[2023-07-29 08:33:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 08:33:58] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 08:33:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 08:33:58] [comm] Using global sharding
[2023-07-29 08:33:58] [comm] NCCLCommunicators constructed successfully
[2023-07-29 08:33:58] [training] Using 1 GPUs
[2023-07-29 08:33:58] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 08:33:59] Allocating memory for general optimizer shards
[2023-07-29 08:33:59] [memory] Reserving 322 MB, device gpu0
[2023-07-29 08:33:59] Loading Adam parameters
[2023-07-29 08:33:59] [memory] Reserving 322 MB, device gpu0
[2023-07-29 08:33:59] [memory] Reserving 80 MB, device gpu0
[2023-07-29 08:34:00] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 08:34:00] [data] Restoring the corpus state to epoch 361, batch 13973
[2023-07-29 08:34:00] [data] Shuffling data
[2023-07-29 08:34:00] [data] Done reading 20,192 sentences
[2023-07-29 08:34:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:34:00] Training started
[2023-07-29 08:34:00] Training finished
[2023-07-29 08:34:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 08:34:03] [marian] Running on node01.datos.cluster.uy as process 22487 with command line:
[2023-07-29 08:34:03] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 08:34:03] [config] after: 0e
[2023-07-29 08:34:03] [config] after-batches: 0
[2023-07-29 08:34:03] [config] after-epochs: 190
[2023-07-29 08:34:03] [config] all-caps-every: 0
[2023-07-29 08:34:03] [config] allow-unk: false
[2023-07-29 08:34:03] [config] authors: false
[2023-07-29 08:34:03] [config] beam-size: 12
[2023-07-29 08:34:03] [config] bert-class-symbol: "[CLS]"
[2023-07-29 08:34:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 08:34:03] [config] bert-masking-fraction: 0.15
[2023-07-29 08:34:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 08:34:03] [config] bert-train-type-embeddings: true
[2023-07-29 08:34:03] [config] bert-type-vocab-size: 2
[2023-07-29 08:34:03] [config] build-info: ""
[2023-07-29 08:34:03] [config] check-gradient-nan: false
[2023-07-29 08:34:03] [config] check-nan: false
[2023-07-29 08:34:03] [config] cite: false
[2023-07-29 08:34:03] [config] clip-norm: 1
[2023-07-29 08:34:03] [config] cost-scaling:
[2023-07-29 08:34:03] [config]   - 256.f
[2023-07-29 08:34:03] [config]   - 1000
[2023-07-29 08:34:03] [config]   - 2.f
[2023-07-29 08:34:03] [config]   - 256.f
[2023-07-29 08:34:03] [config] cost-type: ce-sum
[2023-07-29 08:34:03] [config] cpu-threads: 0
[2023-07-29 08:34:03] [config] data-threads: 8
[2023-07-29 08:34:03] [config] data-weighting: ""
[2023-07-29 08:34:03] [config] data-weighting-type: sentence
[2023-07-29 08:34:03] [config] dec-cell: gru
[2023-07-29 08:34:03] [config] dec-cell-base-depth: 2
[2023-07-29 08:34:03] [config] dec-cell-high-depth: 1
[2023-07-29 08:34:03] [config] dec-depth: 1
[2023-07-29 08:34:03] [config] devices:
[2023-07-29 08:34:03] [config]   - 0
[2023-07-29 08:34:03] [config] dim-emb: 512
[2023-07-29 08:34:03] [config] dim-rnn: 1024
[2023-07-29 08:34:03] [config] dim-vocabs:
[2023-07-29 08:34:03] [config]   - 16384
[2023-07-29 08:34:03] [config]   - 16384
[2023-07-29 08:34:03] [config] disp-first: 0
[2023-07-29 08:34:03] [config] disp-freq: 1000u
[2023-07-29 08:34:03] [config] disp-label-counts: true
[2023-07-29 08:34:03] [config] dropout-rnn: 0
[2023-07-29 08:34:03] [config] dropout-src: 0
[2023-07-29 08:34:03] [config] dropout-trg: 0
[2023-07-29 08:34:03] [config] dump-config: ""
[2023-07-29 08:34:03] [config] dynamic-gradient-scaling:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] early-stopping: 1000
[2023-07-29 08:34:03] [config] early-stopping-on: first
[2023-07-29 08:34:03] [config] embedding-fix-src: false
[2023-07-29 08:34:03] [config] embedding-fix-trg: false
[2023-07-29 08:34:03] [config] embedding-normalization: false
[2023-07-29 08:34:03] [config] embedding-vectors:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] enc-cell: gru
[2023-07-29 08:34:03] [config] enc-cell-depth: 1
[2023-07-29 08:34:03] [config] enc-depth: 1
[2023-07-29 08:34:03] [config] enc-type: bidirectional
[2023-07-29 08:34:03] [config] english-title-case-every: 0
[2023-07-29 08:34:03] [config] exponential-smoothing: 0
[2023-07-29 08:34:03] [config] factor-weight: 1
[2023-07-29 08:34:03] [config] factors-combine: sum
[2023-07-29 08:34:03] [config] factors-dim-emb: 0
[2023-07-29 08:34:03] [config] gradient-checkpointing: false
[2023-07-29 08:34:03] [config] gradient-norm-average-window: 100
[2023-07-29 08:34:03] [config] guided-alignment: none
[2023-07-29 08:34:03] [config] guided-alignment-cost: mse
[2023-07-29 08:34:03] [config] guided-alignment-weight: 0.1
[2023-07-29 08:34:03] [config] ignore-model-config: false
[2023-07-29 08:34:03] [config] input-types:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] interpolate-env-vars: false
[2023-07-29 08:34:03] [config] keep-best: false
[2023-07-29 08:34:03] [config] label-smoothing: 0
[2023-07-29 08:34:03] [config] layer-normalization: false
[2023-07-29 08:34:03] [config] learn-rate: 0.0001
[2023-07-29 08:34:03] [config] lemma-dependency: ""
[2023-07-29 08:34:03] [config] lemma-dim-emb: 0
[2023-07-29 08:34:03] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 08:34:03] [config] log-level: info
[2023-07-29 08:34:03] [config] log-time-zone: ""
[2023-07-29 08:34:03] [config] logical-epoch:
[2023-07-29 08:34:03] [config]   - 1e
[2023-07-29 08:34:03] [config]   - 0
[2023-07-29 08:34:03] [config] lr-decay: 0
[2023-07-29 08:34:03] [config] lr-decay-freq: 50000
[2023-07-29 08:34:03] [config] lr-decay-inv-sqrt:
[2023-07-29 08:34:03] [config]   - 0
[2023-07-29 08:34:03] [config] lr-decay-repeat-warmup: false
[2023-07-29 08:34:03] [config] lr-decay-reset-optimizer: false
[2023-07-29 08:34:03] [config] lr-decay-start:
[2023-07-29 08:34:03] [config]   - 10
[2023-07-29 08:34:03] [config]   - 1
[2023-07-29 08:34:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 08:34:03] [config] lr-report: false
[2023-07-29 08:34:03] [config] lr-warmup: 0
[2023-07-29 08:34:03] [config] lr-warmup-at-reload: false
[2023-07-29 08:34:03] [config] lr-warmup-cycle: false
[2023-07-29 08:34:03] [config] lr-warmup-start-rate: 0
[2023-07-29 08:34:03] [config] max-length: 250
[2023-07-29 08:34:03] [config] max-length-crop: true
[2023-07-29 08:34:03] [config] max-length-factor: 3
[2023-07-29 08:34:03] [config] maxi-batch: 100
[2023-07-29 08:34:03] [config] maxi-batch-sort: trg
[2023-07-29 08:34:03] [config] mini-batch: 64
[2023-07-29 08:34:03] [config] mini-batch-fit: true
[2023-07-29 08:34:03] [config] mini-batch-fit-step: 10
[2023-07-29 08:34:03] [config] mini-batch-round-up: true
[2023-07-29 08:34:03] [config] mini-batch-track-lr: false
[2023-07-29 08:34:03] [config] mini-batch-warmup: 0
[2023-07-29 08:34:03] [config] mini-batch-words: 0
[2023-07-29 08:34:03] [config] mini-batch-words-ref: 0
[2023-07-29 08:34:03] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 08:34:03] [config] multi-loss-type: sum
[2023-07-29 08:34:03] [config] n-best: false
[2023-07-29 08:34:03] [config] no-nccl: false
[2023-07-29 08:34:03] [config] no-reload: false
[2023-07-29 08:34:03] [config] no-restore-corpus: false
[2023-07-29 08:34:03] [config] normalize: 0
[2023-07-29 08:34:03] [config] normalize-gradient: false
[2023-07-29 08:34:03] [config] num-devices: 0
[2023-07-29 08:34:03] [config] optimizer: adam
[2023-07-29 08:34:03] [config] optimizer-delay: 1
[2023-07-29 08:34:03] [config] optimizer-params:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] output-omit-bias: false
[2023-07-29 08:34:03] [config] overwrite: true
[2023-07-29 08:34:03] [config] precision:
[2023-07-29 08:34:03] [config]   - float16
[2023-07-29 08:34:03] [config]   - float32
[2023-07-29 08:34:03] [config] pretrained-model: ""
[2023-07-29 08:34:03] [config] quantize-biases: false
[2023-07-29 08:34:03] [config] quantize-bits: 0
[2023-07-29 08:34:03] [config] quantize-log-based: false
[2023-07-29 08:34:03] [config] quantize-optimization-steps: 0
[2023-07-29 08:34:03] [config] quiet: false
[2023-07-29 08:34:03] [config] quiet-translation: true
[2023-07-29 08:34:03] [config] relative-paths: false
[2023-07-29 08:34:03] [config] right-left: false
[2023-07-29 08:34:03] [config] save-freq: 10000u
[2023-07-29 08:34:03] [config] seed: 1234
[2023-07-29 08:34:03] [config] sentencepiece-alphas:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] sentencepiece-max-lines: 2000000
[2023-07-29 08:34:03] [config] sentencepiece-options: ""
[2023-07-29 08:34:03] [config] sharding: global
[2023-07-29 08:34:03] [config] shuffle: data
[2023-07-29 08:34:03] [config] shuffle-in-ram: false
[2023-07-29 08:34:03] [config] sigterm: save-and-exit
[2023-07-29 08:34:03] [config] skip: false
[2023-07-29 08:34:03] [config] sqlite: ""
[2023-07-29 08:34:03] [config] sqlite-drop: false
[2023-07-29 08:34:03] [config] sync-freq: 200u
[2023-07-29 08:34:03] [config] sync-sgd: false
[2023-07-29 08:34:03] [config] tempdir: /tmp
[2023-07-29 08:34:03] [config] tied-embeddings: false
[2023-07-29 08:34:03] [config] tied-embeddings-all: true
[2023-07-29 08:34:03] [config] tied-embeddings-src: false
[2023-07-29 08:34:03] [config] train-embedder-rank:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] train-sets:
[2023-07-29 08:34:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 08:34:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 08:34:03] [config] transformer-aan-activation: swish
[2023-07-29 08:34:03] [config] transformer-aan-depth: 2
[2023-07-29 08:34:03] [config] transformer-aan-nogate: false
[2023-07-29 08:34:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 08:34:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 08:34:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 08:34:03] [config] transformer-depth-scaling: false
[2023-07-29 08:34:03] [config] transformer-dim-aan: 2048
[2023-07-29 08:34:03] [config] transformer-dim-ffn: 2048
[2023-07-29 08:34:03] [config] transformer-dropout: 0
[2023-07-29 08:34:03] [config] transformer-dropout-attention: 0
[2023-07-29 08:34:03] [config] transformer-dropout-ffn: 0
[2023-07-29 08:34:03] [config] transformer-ffn-activation: swish
[2023-07-29 08:34:03] [config] transformer-ffn-depth: 2
[2023-07-29 08:34:03] [config] transformer-guided-alignment-layer: last
[2023-07-29 08:34:03] [config] transformer-heads: 8
[2023-07-29 08:34:03] [config] transformer-no-projection: false
[2023-07-29 08:34:03] [config] transformer-pool: false
[2023-07-29 08:34:03] [config] transformer-postprocess: dan
[2023-07-29 08:34:03] [config] transformer-postprocess-emb: d
[2023-07-29 08:34:03] [config] transformer-postprocess-top: ""
[2023-07-29 08:34:03] [config] transformer-preprocess: ""
[2023-07-29 08:34:03] [config] transformer-tied-layers:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] transformer-train-position-embeddings: false
[2023-07-29 08:34:03] [config] tsv: false
[2023-07-29 08:34:03] [config] tsv-fields: 0
[2023-07-29 08:34:03] [config] type: s2s
[2023-07-29 08:34:03] [config] ulr: false
[2023-07-29 08:34:03] [config] ulr-dim-emb: 0
[2023-07-29 08:34:03] [config] ulr-dropout: 0
[2023-07-29 08:34:03] [config] ulr-keys-vectors: ""
[2023-07-29 08:34:03] [config] ulr-query-vectors: ""
[2023-07-29 08:34:03] [config] ulr-softmax-temperature: 1
[2023-07-29 08:34:03] [config] ulr-trainable-transformation: false
[2023-07-29 08:34:03] [config] unlikelihood-loss: false
[2023-07-29 08:34:03] [config] valid-freq: 50000000
[2023-07-29 08:34:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 08:34:03] [config] valid-max-length: 1000
[2023-07-29 08:34:03] [config] valid-metrics:
[2023-07-29 08:34:03] [config]   - translation
[2023-07-29 08:34:03] [config] valid-mini-batch: 32
[2023-07-29 08:34:03] [config] valid-reset-stalled: false
[2023-07-29 08:34:03] [config] valid-script-args:
[2023-07-29 08:34:03] [config]   []
[2023-07-29 08:34:03] [config] valid-script-path: ""
[2023-07-29 08:34:03] [config] valid-sets:
[2023-07-29 08:34:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 08:34:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 08:34:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 08:34:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 08:34:03] [config] vocabs:
[2023-07-29 08:34:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 08:34:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 08:34:03] [config] word-penalty: 0
[2023-07-29 08:34:03] [config] word-scores: false
[2023-07-29 08:34:03] [config] workspace: 5500
[2023-07-29 08:34:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 08:34:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 08:34:03] [training] Using single-device training
[2023-07-29 08:34:03] Synced seed 1234
[2023-07-29 08:34:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 08:34:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 08:34:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 08:34:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 08:34:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 08:34:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 08:34:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 08:34:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 08:34:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 08:34:04] [comm] Using global sharding
[2023-07-29 08:34:04] [comm] NCCLCommunicators constructed successfully
[2023-07-29 08:34:04] [training] Using 1 GPUs
[2023-07-29 08:34:04] [logits] Applying loss function for 1 factor(s)
[2023-07-29 08:34:04] [memory] Reserving 80 MB, device gpu0
[2023-07-29 08:34:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 08:34:05] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:10:54] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 09:10:54] [valid] No post-processing script given for validating translator
[2023-07-29 09:10:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 09:10:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 09:10:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 09:10:54] [comm] Using global sharding
[2023-07-29 09:10:54] [comm] NCCLCommunicators constructed successfully
[2023-07-29 09:10:54] [training] Using 1 GPUs
[2023-07-29 09:10:54] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 09:10:55] Allocating memory for general optimizer shards
[2023-07-29 09:10:55] [memory] Reserving 322 MB, device gpu0
[2023-07-29 09:10:55] Loading Adam parameters
[2023-07-29 09:10:56] [memory] Reserving 322 MB, device gpu0
[2023-07-29 09:10:56] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:10:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 09:10:56] [data] Restoring the corpus state to epoch 371, batch 14360
[2023-07-29 09:10:56] [data] Shuffling data
[2023-07-29 09:10:56] [data] Done reading 20,192 sentences
[2023-07-29 09:10:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 09:10:56] Training started
[2023-07-29 09:10:56] Training finished
[2023-07-29 09:11:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 09:11:00] [marian] Running on node01.datos.cluster.uy as process 24779 with command line:
[2023-07-29 09:11:00] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 09:11:00] [config] after: 0e
[2023-07-29 09:11:00] [config] after-batches: 0
[2023-07-29 09:11:00] [config] after-epochs: 200
[2023-07-29 09:11:00] [config] all-caps-every: 0
[2023-07-29 09:11:00] [config] allow-unk: false
[2023-07-29 09:11:00] [config] authors: false
[2023-07-29 09:11:00] [config] beam-size: 12
[2023-07-29 09:11:00] [config] bert-class-symbol: "[CLS]"
[2023-07-29 09:11:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 09:11:00] [config] bert-masking-fraction: 0.15
[2023-07-29 09:11:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 09:11:00] [config] bert-train-type-embeddings: true
[2023-07-29 09:11:00] [config] bert-type-vocab-size: 2
[2023-07-29 09:11:00] [config] build-info: ""
[2023-07-29 09:11:00] [config] check-gradient-nan: false
[2023-07-29 09:11:00] [config] check-nan: false
[2023-07-29 09:11:00] [config] cite: false
[2023-07-29 09:11:00] [config] clip-norm: 1
[2023-07-29 09:11:00] [config] cost-scaling:
[2023-07-29 09:11:00] [config]   - 256.f
[2023-07-29 09:11:00] [config]   - 1000
[2023-07-29 09:11:00] [config]   - 2.f
[2023-07-29 09:11:00] [config]   - 256.f
[2023-07-29 09:11:00] [config] cost-type: ce-sum
[2023-07-29 09:11:00] [config] cpu-threads: 0
[2023-07-29 09:11:00] [config] data-threads: 8
[2023-07-29 09:11:00] [config] data-weighting: ""
[2023-07-29 09:11:00] [config] data-weighting-type: sentence
[2023-07-29 09:11:00] [config] dec-cell: gru
[2023-07-29 09:11:00] [config] dec-cell-base-depth: 2
[2023-07-29 09:11:00] [config] dec-cell-high-depth: 1
[2023-07-29 09:11:00] [config] dec-depth: 1
[2023-07-29 09:11:00] [config] devices:
[2023-07-29 09:11:00] [config]   - 0
[2023-07-29 09:11:00] [config] dim-emb: 512
[2023-07-29 09:11:00] [config] dim-rnn: 1024
[2023-07-29 09:11:00] [config] dim-vocabs:
[2023-07-29 09:11:00] [config]   - 16384
[2023-07-29 09:11:00] [config]   - 16384
[2023-07-29 09:11:00] [config] disp-first: 0
[2023-07-29 09:11:00] [config] disp-freq: 1000u
[2023-07-29 09:11:00] [config] disp-label-counts: true
[2023-07-29 09:11:00] [config] dropout-rnn: 0
[2023-07-29 09:11:00] [config] dropout-src: 0
[2023-07-29 09:11:00] [config] dropout-trg: 0
[2023-07-29 09:11:00] [config] dump-config: ""
[2023-07-29 09:11:00] [config] dynamic-gradient-scaling:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] early-stopping: 1000
[2023-07-29 09:11:00] [config] early-stopping-on: first
[2023-07-29 09:11:00] [config] embedding-fix-src: false
[2023-07-29 09:11:00] [config] embedding-fix-trg: false
[2023-07-29 09:11:00] [config] embedding-normalization: false
[2023-07-29 09:11:00] [config] embedding-vectors:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] enc-cell: gru
[2023-07-29 09:11:00] [config] enc-cell-depth: 1
[2023-07-29 09:11:00] [config] enc-depth: 1
[2023-07-29 09:11:00] [config] enc-type: bidirectional
[2023-07-29 09:11:00] [config] english-title-case-every: 0
[2023-07-29 09:11:00] [config] exponential-smoothing: 0
[2023-07-29 09:11:00] [config] factor-weight: 1
[2023-07-29 09:11:00] [config] factors-combine: sum
[2023-07-29 09:11:00] [config] factors-dim-emb: 0
[2023-07-29 09:11:00] [config] gradient-checkpointing: false
[2023-07-29 09:11:00] [config] gradient-norm-average-window: 100
[2023-07-29 09:11:00] [config] guided-alignment: none
[2023-07-29 09:11:00] [config] guided-alignment-cost: mse
[2023-07-29 09:11:00] [config] guided-alignment-weight: 0.1
[2023-07-29 09:11:00] [config] ignore-model-config: false
[2023-07-29 09:11:00] [config] input-types:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] interpolate-env-vars: false
[2023-07-29 09:11:00] [config] keep-best: false
[2023-07-29 09:11:00] [config] label-smoothing: 0
[2023-07-29 09:11:00] [config] layer-normalization: false
[2023-07-29 09:11:00] [config] learn-rate: 0.0001
[2023-07-29 09:11:00] [config] lemma-dependency: ""
[2023-07-29 09:11:00] [config] lemma-dim-emb: 0
[2023-07-29 09:11:00] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 09:11:00] [config] log-level: info
[2023-07-29 09:11:00] [config] log-time-zone: ""
[2023-07-29 09:11:00] [config] logical-epoch:
[2023-07-29 09:11:00] [config]   - 1e
[2023-07-29 09:11:00] [config]   - 0
[2023-07-29 09:11:00] [config] lr-decay: 0
[2023-07-29 09:11:00] [config] lr-decay-freq: 50000
[2023-07-29 09:11:00] [config] lr-decay-inv-sqrt:
[2023-07-29 09:11:00] [config]   - 0
[2023-07-29 09:11:00] [config] lr-decay-repeat-warmup: false
[2023-07-29 09:11:00] [config] lr-decay-reset-optimizer: false
[2023-07-29 09:11:00] [config] lr-decay-start:
[2023-07-29 09:11:00] [config]   - 10
[2023-07-29 09:11:00] [config]   - 1
[2023-07-29 09:11:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 09:11:00] [config] lr-report: false
[2023-07-29 09:11:00] [config] lr-warmup: 0
[2023-07-29 09:11:00] [config] lr-warmup-at-reload: false
[2023-07-29 09:11:00] [config] lr-warmup-cycle: false
[2023-07-29 09:11:00] [config] lr-warmup-start-rate: 0
[2023-07-29 09:11:00] [config] max-length: 250
[2023-07-29 09:11:00] [config] max-length-crop: true
[2023-07-29 09:11:00] [config] max-length-factor: 3
[2023-07-29 09:11:00] [config] maxi-batch: 100
[2023-07-29 09:11:00] [config] maxi-batch-sort: trg
[2023-07-29 09:11:00] [config] mini-batch: 64
[2023-07-29 09:11:00] [config] mini-batch-fit: true
[2023-07-29 09:11:00] [config] mini-batch-fit-step: 10
[2023-07-29 09:11:00] [config] mini-batch-round-up: true
[2023-07-29 09:11:00] [config] mini-batch-track-lr: false
[2023-07-29 09:11:00] [config] mini-batch-warmup: 0
[2023-07-29 09:11:00] [config] mini-batch-words: 0
[2023-07-29 09:11:00] [config] mini-batch-words-ref: 0
[2023-07-29 09:11:00] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 09:11:00] [config] multi-loss-type: sum
[2023-07-29 09:11:00] [config] n-best: false
[2023-07-29 09:11:00] [config] no-nccl: false
[2023-07-29 09:11:00] [config] no-reload: false
[2023-07-29 09:11:00] [config] no-restore-corpus: false
[2023-07-29 09:11:00] [config] normalize: 0
[2023-07-29 09:11:00] [config] normalize-gradient: false
[2023-07-29 09:11:00] [config] num-devices: 0
[2023-07-29 09:11:00] [config] optimizer: adam
[2023-07-29 09:11:00] [config] optimizer-delay: 1
[2023-07-29 09:11:00] [config] optimizer-params:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] output-omit-bias: false
[2023-07-29 09:11:00] [config] overwrite: true
[2023-07-29 09:11:00] [config] precision:
[2023-07-29 09:11:00] [config]   - float16
[2023-07-29 09:11:00] [config]   - float32
[2023-07-29 09:11:00] [config] pretrained-model: ""
[2023-07-29 09:11:00] [config] quantize-biases: false
[2023-07-29 09:11:00] [config] quantize-bits: 0
[2023-07-29 09:11:00] [config] quantize-log-based: false
[2023-07-29 09:11:00] [config] quantize-optimization-steps: 0
[2023-07-29 09:11:00] [config] quiet: false
[2023-07-29 09:11:00] [config] quiet-translation: true
[2023-07-29 09:11:00] [config] relative-paths: false
[2023-07-29 09:11:00] [config] right-left: false
[2023-07-29 09:11:00] [config] save-freq: 10000u
[2023-07-29 09:11:00] [config] seed: 1234
[2023-07-29 09:11:00] [config] sentencepiece-alphas:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] sentencepiece-max-lines: 2000000
[2023-07-29 09:11:00] [config] sentencepiece-options: ""
[2023-07-29 09:11:00] [config] sharding: global
[2023-07-29 09:11:00] [config] shuffle: data
[2023-07-29 09:11:00] [config] shuffle-in-ram: false
[2023-07-29 09:11:00] [config] sigterm: save-and-exit
[2023-07-29 09:11:00] [config] skip: false
[2023-07-29 09:11:00] [config] sqlite: ""
[2023-07-29 09:11:00] [config] sqlite-drop: false
[2023-07-29 09:11:00] [config] sync-freq: 200u
[2023-07-29 09:11:00] [config] sync-sgd: false
[2023-07-29 09:11:00] [config] tempdir: /tmp
[2023-07-29 09:11:00] [config] tied-embeddings: false
[2023-07-29 09:11:00] [config] tied-embeddings-all: true
[2023-07-29 09:11:00] [config] tied-embeddings-src: false
[2023-07-29 09:11:00] [config] train-embedder-rank:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] train-sets:
[2023-07-29 09:11:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 09:11:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 09:11:00] [config] transformer-aan-activation: swish
[2023-07-29 09:11:00] [config] transformer-aan-depth: 2
[2023-07-29 09:11:00] [config] transformer-aan-nogate: false
[2023-07-29 09:11:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 09:11:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 09:11:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 09:11:00] [config] transformer-depth-scaling: false
[2023-07-29 09:11:00] [config] transformer-dim-aan: 2048
[2023-07-29 09:11:00] [config] transformer-dim-ffn: 2048
[2023-07-29 09:11:00] [config] transformer-dropout: 0
[2023-07-29 09:11:00] [config] transformer-dropout-attention: 0
[2023-07-29 09:11:00] [config] transformer-dropout-ffn: 0
[2023-07-29 09:11:00] [config] transformer-ffn-activation: swish
[2023-07-29 09:11:00] [config] transformer-ffn-depth: 2
[2023-07-29 09:11:00] [config] transformer-guided-alignment-layer: last
[2023-07-29 09:11:00] [config] transformer-heads: 8
[2023-07-29 09:11:00] [config] transformer-no-projection: false
[2023-07-29 09:11:00] [config] transformer-pool: false
[2023-07-29 09:11:00] [config] transformer-postprocess: dan
[2023-07-29 09:11:00] [config] transformer-postprocess-emb: d
[2023-07-29 09:11:00] [config] transformer-postprocess-top: ""
[2023-07-29 09:11:00] [config] transformer-preprocess: ""
[2023-07-29 09:11:00] [config] transformer-tied-layers:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] transformer-train-position-embeddings: false
[2023-07-29 09:11:00] [config] tsv: false
[2023-07-29 09:11:00] [config] tsv-fields: 0
[2023-07-29 09:11:00] [config] type: s2s
[2023-07-29 09:11:00] [config] ulr: false
[2023-07-29 09:11:00] [config] ulr-dim-emb: 0
[2023-07-29 09:11:00] [config] ulr-dropout: 0
[2023-07-29 09:11:00] [config] ulr-keys-vectors: ""
[2023-07-29 09:11:00] [config] ulr-query-vectors: ""
[2023-07-29 09:11:00] [config] ulr-softmax-temperature: 1
[2023-07-29 09:11:00] [config] ulr-trainable-transformation: false
[2023-07-29 09:11:00] [config] unlikelihood-loss: false
[2023-07-29 09:11:00] [config] valid-freq: 50000000
[2023-07-29 09:11:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 09:11:00] [config] valid-max-length: 1000
[2023-07-29 09:11:00] [config] valid-metrics:
[2023-07-29 09:11:00] [config]   - translation
[2023-07-29 09:11:00] [config] valid-mini-batch: 32
[2023-07-29 09:11:00] [config] valid-reset-stalled: false
[2023-07-29 09:11:00] [config] valid-script-args:
[2023-07-29 09:11:00] [config]   []
[2023-07-29 09:11:00] [config] valid-script-path: ""
[2023-07-29 09:11:00] [config] valid-sets:
[2023-07-29 09:11:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 09:11:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 09:11:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 09:11:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 09:11:00] [config] vocabs:
[2023-07-29 09:11:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 09:11:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 09:11:00] [config] word-penalty: 0
[2023-07-29 09:11:00] [config] word-scores: false
[2023-07-29 09:11:00] [config] workspace: 5500
[2023-07-29 09:11:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 09:11:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 09:11:00] [training] Using single-device training
[2023-07-29 09:11:00] Synced seed 1234
[2023-07-29 09:11:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 09:11:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 09:11:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 09:11:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 09:11:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 09:11:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 09:11:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 09:11:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 09:11:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 09:11:01] [comm] Using global sharding
[2023-07-29 09:11:01] [comm] NCCLCommunicators constructed successfully
[2023-07-29 09:11:01] [training] Using 1 GPUs
[2023-07-29 09:11:01] [logits] Applying loss function for 1 factor(s)
[2023-07-29 09:11:01] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:11:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 09:11:02] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:47:52] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 09:47:52] [valid] No post-processing script given for validating translator
[2023-07-29 09:47:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 09:47:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 09:47:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 09:47:52] [comm] Using global sharding
[2023-07-29 09:47:52] [comm] NCCLCommunicators constructed successfully
[2023-07-29 09:47:52] [training] Using 1 GPUs
[2023-07-29 09:47:52] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 09:47:53] Allocating memory for general optimizer shards
[2023-07-29 09:47:53] [memory] Reserving 322 MB, device gpu0
[2023-07-29 09:47:53] Loading Adam parameters
[2023-07-29 09:47:53] [memory] Reserving 322 MB, device gpu0
[2023-07-29 09:47:53] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:47:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 09:47:54] [data] Restoring the corpus state to epoch 371, batch 14360
[2023-07-29 09:47:54] [data] Shuffling data
[2023-07-29 09:47:54] [data] Done reading 20,192 sentences
[2023-07-29 09:47:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 09:47:54] Training started
[2023-07-29 09:47:54] Training finished
[2023-07-29 09:47:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 09:47:58] [marian] Running on node01.datos.cluster.uy as process 27425 with command line:
[2023-07-29 09:47:58] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 210 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 09:47:58] [config] after: 0e
[2023-07-29 09:47:58] [config] after-batches: 0
[2023-07-29 09:47:58] [config] after-epochs: 210
[2023-07-29 09:47:58] [config] all-caps-every: 0
[2023-07-29 09:47:58] [config] allow-unk: false
[2023-07-29 09:47:58] [config] authors: false
[2023-07-29 09:47:58] [config] beam-size: 12
[2023-07-29 09:47:58] [config] bert-class-symbol: "[CLS]"
[2023-07-29 09:47:58] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 09:47:58] [config] bert-masking-fraction: 0.15
[2023-07-29 09:47:58] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 09:47:58] [config] bert-train-type-embeddings: true
[2023-07-29 09:47:58] [config] bert-type-vocab-size: 2
[2023-07-29 09:47:58] [config] build-info: ""
[2023-07-29 09:47:58] [config] check-gradient-nan: false
[2023-07-29 09:47:58] [config] check-nan: false
[2023-07-29 09:47:58] [config] cite: false
[2023-07-29 09:47:58] [config] clip-norm: 1
[2023-07-29 09:47:58] [config] cost-scaling:
[2023-07-29 09:47:58] [config]   - 256.f
[2023-07-29 09:47:58] [config]   - 1000
[2023-07-29 09:47:58] [config]   - 2.f
[2023-07-29 09:47:58] [config]   - 256.f
[2023-07-29 09:47:58] [config] cost-type: ce-sum
[2023-07-29 09:47:58] [config] cpu-threads: 0
[2023-07-29 09:47:58] [config] data-threads: 8
[2023-07-29 09:47:58] [config] data-weighting: ""
[2023-07-29 09:47:58] [config] data-weighting-type: sentence
[2023-07-29 09:47:58] [config] dec-cell: gru
[2023-07-29 09:47:58] [config] dec-cell-base-depth: 2
[2023-07-29 09:47:58] [config] dec-cell-high-depth: 1
[2023-07-29 09:47:58] [config] dec-depth: 1
[2023-07-29 09:47:58] [config] devices:
[2023-07-29 09:47:58] [config]   - 0
[2023-07-29 09:47:58] [config] dim-emb: 512
[2023-07-29 09:47:58] [config] dim-rnn: 1024
[2023-07-29 09:47:58] [config] dim-vocabs:
[2023-07-29 09:47:58] [config]   - 16384
[2023-07-29 09:47:58] [config]   - 16384
[2023-07-29 09:47:58] [config] disp-first: 0
[2023-07-29 09:47:58] [config] disp-freq: 1000u
[2023-07-29 09:47:58] [config] disp-label-counts: true
[2023-07-29 09:47:58] [config] dropout-rnn: 0
[2023-07-29 09:47:58] [config] dropout-src: 0
[2023-07-29 09:47:58] [config] dropout-trg: 0
[2023-07-29 09:47:58] [config] dump-config: ""
[2023-07-29 09:47:58] [config] dynamic-gradient-scaling:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] early-stopping: 1000
[2023-07-29 09:47:58] [config] early-stopping-on: first
[2023-07-29 09:47:58] [config] embedding-fix-src: false
[2023-07-29 09:47:58] [config] embedding-fix-trg: false
[2023-07-29 09:47:58] [config] embedding-normalization: false
[2023-07-29 09:47:58] [config] embedding-vectors:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] enc-cell: gru
[2023-07-29 09:47:58] [config] enc-cell-depth: 1
[2023-07-29 09:47:58] [config] enc-depth: 1
[2023-07-29 09:47:58] [config] enc-type: bidirectional
[2023-07-29 09:47:58] [config] english-title-case-every: 0
[2023-07-29 09:47:58] [config] exponential-smoothing: 0
[2023-07-29 09:47:58] [config] factor-weight: 1
[2023-07-29 09:47:58] [config] factors-combine: sum
[2023-07-29 09:47:58] [config] factors-dim-emb: 0
[2023-07-29 09:47:58] [config] gradient-checkpointing: false
[2023-07-29 09:47:58] [config] gradient-norm-average-window: 100
[2023-07-29 09:47:58] [config] guided-alignment: none
[2023-07-29 09:47:58] [config] guided-alignment-cost: mse
[2023-07-29 09:47:58] [config] guided-alignment-weight: 0.1
[2023-07-29 09:47:58] [config] ignore-model-config: false
[2023-07-29 09:47:58] [config] input-types:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] interpolate-env-vars: false
[2023-07-29 09:47:58] [config] keep-best: false
[2023-07-29 09:47:58] [config] label-smoothing: 0
[2023-07-29 09:47:58] [config] layer-normalization: false
[2023-07-29 09:47:58] [config] learn-rate: 0.0001
[2023-07-29 09:47:58] [config] lemma-dependency: ""
[2023-07-29 09:47:58] [config] lemma-dim-emb: 0
[2023-07-29 09:47:58] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 09:47:58] [config] log-level: info
[2023-07-29 09:47:58] [config] log-time-zone: ""
[2023-07-29 09:47:58] [config] logical-epoch:
[2023-07-29 09:47:58] [config]   - 1e
[2023-07-29 09:47:58] [config]   - 0
[2023-07-29 09:47:58] [config] lr-decay: 0
[2023-07-29 09:47:58] [config] lr-decay-freq: 50000
[2023-07-29 09:47:58] [config] lr-decay-inv-sqrt:
[2023-07-29 09:47:58] [config]   - 0
[2023-07-29 09:47:58] [config] lr-decay-repeat-warmup: false
[2023-07-29 09:47:58] [config] lr-decay-reset-optimizer: false
[2023-07-29 09:47:58] [config] lr-decay-start:
[2023-07-29 09:47:58] [config]   - 10
[2023-07-29 09:47:58] [config]   - 1
[2023-07-29 09:47:58] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 09:47:58] [config] lr-report: false
[2023-07-29 09:47:58] [config] lr-warmup: 0
[2023-07-29 09:47:58] [config] lr-warmup-at-reload: false
[2023-07-29 09:47:58] [config] lr-warmup-cycle: false
[2023-07-29 09:47:58] [config] lr-warmup-start-rate: 0
[2023-07-29 09:47:58] [config] max-length: 250
[2023-07-29 09:47:58] [config] max-length-crop: true
[2023-07-29 09:47:58] [config] max-length-factor: 3
[2023-07-29 09:47:58] [config] maxi-batch: 100
[2023-07-29 09:47:58] [config] maxi-batch-sort: trg
[2023-07-29 09:47:58] [config] mini-batch: 64
[2023-07-29 09:47:58] [config] mini-batch-fit: true
[2023-07-29 09:47:58] [config] mini-batch-fit-step: 10
[2023-07-29 09:47:58] [config] mini-batch-round-up: true
[2023-07-29 09:47:58] [config] mini-batch-track-lr: false
[2023-07-29 09:47:58] [config] mini-batch-warmup: 0
[2023-07-29 09:47:58] [config] mini-batch-words: 0
[2023-07-29 09:47:58] [config] mini-batch-words-ref: 0
[2023-07-29 09:47:58] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 09:47:58] [config] multi-loss-type: sum
[2023-07-29 09:47:58] [config] n-best: false
[2023-07-29 09:47:58] [config] no-nccl: false
[2023-07-29 09:47:58] [config] no-reload: false
[2023-07-29 09:47:58] [config] no-restore-corpus: false
[2023-07-29 09:47:58] [config] normalize: 0
[2023-07-29 09:47:58] [config] normalize-gradient: false
[2023-07-29 09:47:58] [config] num-devices: 0
[2023-07-29 09:47:58] [config] optimizer: adam
[2023-07-29 09:47:58] [config] optimizer-delay: 1
[2023-07-29 09:47:58] [config] optimizer-params:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] output-omit-bias: false
[2023-07-29 09:47:58] [config] overwrite: true
[2023-07-29 09:47:58] [config] precision:
[2023-07-29 09:47:58] [config]   - float16
[2023-07-29 09:47:58] [config]   - float32
[2023-07-29 09:47:58] [config] pretrained-model: ""
[2023-07-29 09:47:58] [config] quantize-biases: false
[2023-07-29 09:47:58] [config] quantize-bits: 0
[2023-07-29 09:47:58] [config] quantize-log-based: false
[2023-07-29 09:47:58] [config] quantize-optimization-steps: 0
[2023-07-29 09:47:58] [config] quiet: false
[2023-07-29 09:47:58] [config] quiet-translation: true
[2023-07-29 09:47:58] [config] relative-paths: false
[2023-07-29 09:47:58] [config] right-left: false
[2023-07-29 09:47:58] [config] save-freq: 10000u
[2023-07-29 09:47:58] [config] seed: 1234
[2023-07-29 09:47:58] [config] sentencepiece-alphas:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] sentencepiece-max-lines: 2000000
[2023-07-29 09:47:58] [config] sentencepiece-options: ""
[2023-07-29 09:47:58] [config] sharding: global
[2023-07-29 09:47:58] [config] shuffle: data
[2023-07-29 09:47:58] [config] shuffle-in-ram: false
[2023-07-29 09:47:58] [config] sigterm: save-and-exit
[2023-07-29 09:47:58] [config] skip: false
[2023-07-29 09:47:58] [config] sqlite: ""
[2023-07-29 09:47:58] [config] sqlite-drop: false
[2023-07-29 09:47:58] [config] sync-freq: 200u
[2023-07-29 09:47:58] [config] sync-sgd: false
[2023-07-29 09:47:58] [config] tempdir: /tmp
[2023-07-29 09:47:58] [config] tied-embeddings: false
[2023-07-29 09:47:58] [config] tied-embeddings-all: true
[2023-07-29 09:47:58] [config] tied-embeddings-src: false
[2023-07-29 09:47:58] [config] train-embedder-rank:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] train-sets:
[2023-07-29 09:47:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 09:47:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 09:47:58] [config] transformer-aan-activation: swish
[2023-07-29 09:47:58] [config] transformer-aan-depth: 2
[2023-07-29 09:47:58] [config] transformer-aan-nogate: false
[2023-07-29 09:47:58] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 09:47:58] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 09:47:58] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 09:47:58] [config] transformer-depth-scaling: false
[2023-07-29 09:47:58] [config] transformer-dim-aan: 2048
[2023-07-29 09:47:58] [config] transformer-dim-ffn: 2048
[2023-07-29 09:47:58] [config] transformer-dropout: 0
[2023-07-29 09:47:58] [config] transformer-dropout-attention: 0
[2023-07-29 09:47:58] [config] transformer-dropout-ffn: 0
[2023-07-29 09:47:58] [config] transformer-ffn-activation: swish
[2023-07-29 09:47:58] [config] transformer-ffn-depth: 2
[2023-07-29 09:47:58] [config] transformer-guided-alignment-layer: last
[2023-07-29 09:47:58] [config] transformer-heads: 8
[2023-07-29 09:47:58] [config] transformer-no-projection: false
[2023-07-29 09:47:58] [config] transformer-pool: false
[2023-07-29 09:47:58] [config] transformer-postprocess: dan
[2023-07-29 09:47:58] [config] transformer-postprocess-emb: d
[2023-07-29 09:47:58] [config] transformer-postprocess-top: ""
[2023-07-29 09:47:58] [config] transformer-preprocess: ""
[2023-07-29 09:47:58] [config] transformer-tied-layers:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] transformer-train-position-embeddings: false
[2023-07-29 09:47:58] [config] tsv: false
[2023-07-29 09:47:58] [config] tsv-fields: 0
[2023-07-29 09:47:58] [config] type: s2s
[2023-07-29 09:47:58] [config] ulr: false
[2023-07-29 09:47:58] [config] ulr-dim-emb: 0
[2023-07-29 09:47:58] [config] ulr-dropout: 0
[2023-07-29 09:47:58] [config] ulr-keys-vectors: ""
[2023-07-29 09:47:58] [config] ulr-query-vectors: ""
[2023-07-29 09:47:58] [config] ulr-softmax-temperature: 1
[2023-07-29 09:47:58] [config] ulr-trainable-transformation: false
[2023-07-29 09:47:58] [config] unlikelihood-loss: false
[2023-07-29 09:47:58] [config] valid-freq: 50000000
[2023-07-29 09:47:58] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 09:47:58] [config] valid-max-length: 1000
[2023-07-29 09:47:58] [config] valid-metrics:
[2023-07-29 09:47:58] [config]   - translation
[2023-07-29 09:47:58] [config] valid-mini-batch: 32
[2023-07-29 09:47:58] [config] valid-reset-stalled: false
[2023-07-29 09:47:58] [config] valid-script-args:
[2023-07-29 09:47:58] [config]   []
[2023-07-29 09:47:58] [config] valid-script-path: ""
[2023-07-29 09:47:58] [config] valid-sets:
[2023-07-29 09:47:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 09:47:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 09:47:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 09:47:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 09:47:58] [config] vocabs:
[2023-07-29 09:47:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 09:47:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 09:47:58] [config] word-penalty: 0
[2023-07-29 09:47:58] [config] word-scores: false
[2023-07-29 09:47:58] [config] workspace: 5500
[2023-07-29 09:47:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 09:47:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 09:47:58] [training] Using single-device training
[2023-07-29 09:47:59] Synced seed 1234
[2023-07-29 09:47:59] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 09:47:59] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 09:47:59] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 09:47:59] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 09:47:59] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 09:47:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 09:47:59] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 09:48:00] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 09:48:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 09:48:00] [comm] Using global sharding
[2023-07-29 09:48:00] [comm] NCCLCommunicators constructed successfully
[2023-07-29 09:48:00] [training] Using 1 GPUs
[2023-07-29 09:48:00] [logits] Applying loss function for 1 factor(s)
[2023-07-29 09:48:00] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:48:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 09:48:00] [memory] Reserving 80 MB, device gpu0
[2023-07-29 10:24:50] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 10:24:50] [valid] No post-processing script given for validating translator
[2023-07-29 10:24:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 10:24:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 10:24:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 10:24:50] [comm] Using global sharding
[2023-07-29 10:24:51] [comm] NCCLCommunicators constructed successfully
[2023-07-29 10:24:51] [training] Using 1 GPUs
[2023-07-29 10:24:51] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 10:24:51] Allocating memory for general optimizer shards
[2023-07-29 10:24:51] [memory] Reserving 322 MB, device gpu0
[2023-07-29 10:24:51] Loading Adam parameters
[2023-07-29 10:24:51] [memory] Reserving 322 MB, device gpu0
[2023-07-29 10:24:52] [memory] Reserving 80 MB, device gpu0
[2023-07-29 10:24:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 10:24:52] [data] Restoring the corpus state to epoch 371, batch 14360
[2023-07-29 10:24:52] [data] Shuffling data
[2023-07-29 10:24:52] [data] Done reading 20,192 sentences
[2023-07-29 10:24:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:24:52] Training started
[2023-07-29 10:24:52] Training finished
[2023-07-29 10:24:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 10:24:56] [marian] Running on node01.datos.cluster.uy as process 29722 with command line:
[2023-07-29 10:24:56] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 220 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 10:24:56] [config] after: 0e
[2023-07-29 10:24:56] [config] after-batches: 0
[2023-07-29 10:24:56] [config] after-epochs: 220
[2023-07-29 10:24:56] [config] all-caps-every: 0
[2023-07-29 10:24:56] [config] allow-unk: false
[2023-07-29 10:24:56] [config] authors: false
[2023-07-29 10:24:56] [config] beam-size: 12
[2023-07-29 10:24:56] [config] bert-class-symbol: "[CLS]"
[2023-07-29 10:24:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 10:24:56] [config] bert-masking-fraction: 0.15
[2023-07-29 10:24:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 10:24:56] [config] bert-train-type-embeddings: true
[2023-07-29 10:24:56] [config] bert-type-vocab-size: 2
[2023-07-29 10:24:56] [config] build-info: ""
[2023-07-29 10:24:56] [config] check-gradient-nan: false
[2023-07-29 10:24:56] [config] check-nan: false
[2023-07-29 10:24:56] [config] cite: false
[2023-07-29 10:24:56] [config] clip-norm: 1
[2023-07-29 10:24:56] [config] cost-scaling:
[2023-07-29 10:24:56] [config]   - 256.f
[2023-07-29 10:24:56] [config]   - 1000
[2023-07-29 10:24:56] [config]   - 2.f
[2023-07-29 10:24:56] [config]   - 256.f
[2023-07-29 10:24:56] [config] cost-type: ce-sum
[2023-07-29 10:24:56] [config] cpu-threads: 0
[2023-07-29 10:24:56] [config] data-threads: 8
[2023-07-29 10:24:56] [config] data-weighting: ""
[2023-07-29 10:24:56] [config] data-weighting-type: sentence
[2023-07-29 10:24:56] [config] dec-cell: gru
[2023-07-29 10:24:56] [config] dec-cell-base-depth: 2
[2023-07-29 10:24:56] [config] dec-cell-high-depth: 1
[2023-07-29 10:24:56] [config] dec-depth: 1
[2023-07-29 10:24:56] [config] devices:
[2023-07-29 10:24:56] [config]   - 0
[2023-07-29 10:24:56] [config] dim-emb: 512
[2023-07-29 10:24:56] [config] dim-rnn: 1024
[2023-07-29 10:24:56] [config] dim-vocabs:
[2023-07-29 10:24:56] [config]   - 16384
[2023-07-29 10:24:56] [config]   - 16384
[2023-07-29 10:24:56] [config] disp-first: 0
[2023-07-29 10:24:56] [config] disp-freq: 1000u
[2023-07-29 10:24:56] [config] disp-label-counts: true
[2023-07-29 10:24:56] [config] dropout-rnn: 0
[2023-07-29 10:24:56] [config] dropout-src: 0
[2023-07-29 10:24:56] [config] dropout-trg: 0
[2023-07-29 10:24:56] [config] dump-config: ""
[2023-07-29 10:24:56] [config] dynamic-gradient-scaling:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] early-stopping: 1000
[2023-07-29 10:24:56] [config] early-stopping-on: first
[2023-07-29 10:24:56] [config] embedding-fix-src: false
[2023-07-29 10:24:56] [config] embedding-fix-trg: false
[2023-07-29 10:24:56] [config] embedding-normalization: false
[2023-07-29 10:24:56] [config] embedding-vectors:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] enc-cell: gru
[2023-07-29 10:24:56] [config] enc-cell-depth: 1
[2023-07-29 10:24:56] [config] enc-depth: 1
[2023-07-29 10:24:56] [config] enc-type: bidirectional
[2023-07-29 10:24:56] [config] english-title-case-every: 0
[2023-07-29 10:24:56] [config] exponential-smoothing: 0
[2023-07-29 10:24:56] [config] factor-weight: 1
[2023-07-29 10:24:56] [config] factors-combine: sum
[2023-07-29 10:24:56] [config] factors-dim-emb: 0
[2023-07-29 10:24:56] [config] gradient-checkpointing: false
[2023-07-29 10:24:56] [config] gradient-norm-average-window: 100
[2023-07-29 10:24:56] [config] guided-alignment: none
[2023-07-29 10:24:56] [config] guided-alignment-cost: mse
[2023-07-29 10:24:56] [config] guided-alignment-weight: 0.1
[2023-07-29 10:24:56] [config] ignore-model-config: false
[2023-07-29 10:24:56] [config] input-types:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] interpolate-env-vars: false
[2023-07-29 10:24:56] [config] keep-best: false
[2023-07-29 10:24:56] [config] label-smoothing: 0
[2023-07-29 10:24:56] [config] layer-normalization: false
[2023-07-29 10:24:56] [config] learn-rate: 0.0001
[2023-07-29 10:24:56] [config] lemma-dependency: ""
[2023-07-29 10:24:56] [config] lemma-dim-emb: 0
[2023-07-29 10:24:56] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 10:24:56] [config] log-level: info
[2023-07-29 10:24:56] [config] log-time-zone: ""
[2023-07-29 10:24:56] [config] logical-epoch:
[2023-07-29 10:24:56] [config]   - 1e
[2023-07-29 10:24:56] [config]   - 0
[2023-07-29 10:24:56] [config] lr-decay: 0
[2023-07-29 10:24:56] [config] lr-decay-freq: 50000
[2023-07-29 10:24:56] [config] lr-decay-inv-sqrt:
[2023-07-29 10:24:56] [config]   - 0
[2023-07-29 10:24:56] [config] lr-decay-repeat-warmup: false
[2023-07-29 10:24:56] [config] lr-decay-reset-optimizer: false
[2023-07-29 10:24:56] [config] lr-decay-start:
[2023-07-29 10:24:56] [config]   - 10
[2023-07-29 10:24:56] [config]   - 1
[2023-07-29 10:24:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 10:24:56] [config] lr-report: false
[2023-07-29 10:24:56] [config] lr-warmup: 0
[2023-07-29 10:24:56] [config] lr-warmup-at-reload: false
[2023-07-29 10:24:56] [config] lr-warmup-cycle: false
[2023-07-29 10:24:56] [config] lr-warmup-start-rate: 0
[2023-07-29 10:24:56] [config] max-length: 250
[2023-07-29 10:24:56] [config] max-length-crop: true
[2023-07-29 10:24:56] [config] max-length-factor: 3
[2023-07-29 10:24:56] [config] maxi-batch: 100
[2023-07-29 10:24:56] [config] maxi-batch-sort: trg
[2023-07-29 10:24:56] [config] mini-batch: 64
[2023-07-29 10:24:56] [config] mini-batch-fit: true
[2023-07-29 10:24:56] [config] mini-batch-fit-step: 10
[2023-07-29 10:24:56] [config] mini-batch-round-up: true
[2023-07-29 10:24:56] [config] mini-batch-track-lr: false
[2023-07-29 10:24:56] [config] mini-batch-warmup: 0
[2023-07-29 10:24:56] [config] mini-batch-words: 0
[2023-07-29 10:24:56] [config] mini-batch-words-ref: 0
[2023-07-29 10:24:56] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 10:24:56] [config] multi-loss-type: sum
[2023-07-29 10:24:56] [config] n-best: false
[2023-07-29 10:24:56] [config] no-nccl: false
[2023-07-29 10:24:56] [config] no-reload: false
[2023-07-29 10:24:56] [config] no-restore-corpus: false
[2023-07-29 10:24:56] [config] normalize: 0
[2023-07-29 10:24:56] [config] normalize-gradient: false
[2023-07-29 10:24:56] [config] num-devices: 0
[2023-07-29 10:24:56] [config] optimizer: adam
[2023-07-29 10:24:56] [config] optimizer-delay: 1
[2023-07-29 10:24:56] [config] optimizer-params:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] output-omit-bias: false
[2023-07-29 10:24:56] [config] overwrite: true
[2023-07-29 10:24:56] [config] precision:
[2023-07-29 10:24:56] [config]   - float16
[2023-07-29 10:24:56] [config]   - float32
[2023-07-29 10:24:56] [config] pretrained-model: ""
[2023-07-29 10:24:56] [config] quantize-biases: false
[2023-07-29 10:24:56] [config] quantize-bits: 0
[2023-07-29 10:24:56] [config] quantize-log-based: false
[2023-07-29 10:24:56] [config] quantize-optimization-steps: 0
[2023-07-29 10:24:56] [config] quiet: false
[2023-07-29 10:24:56] [config] quiet-translation: true
[2023-07-29 10:24:56] [config] relative-paths: false
[2023-07-29 10:24:56] [config] right-left: false
[2023-07-29 10:24:56] [config] save-freq: 10000u
[2023-07-29 10:24:56] [config] seed: 1234
[2023-07-29 10:24:56] [config] sentencepiece-alphas:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] sentencepiece-max-lines: 2000000
[2023-07-29 10:24:56] [config] sentencepiece-options: ""
[2023-07-29 10:24:56] [config] sharding: global
[2023-07-29 10:24:56] [config] shuffle: data
[2023-07-29 10:24:56] [config] shuffle-in-ram: false
[2023-07-29 10:24:56] [config] sigterm: save-and-exit
[2023-07-29 10:24:56] [config] skip: false
[2023-07-29 10:24:56] [config] sqlite: ""
[2023-07-29 10:24:56] [config] sqlite-drop: false
[2023-07-29 10:24:56] [config] sync-freq: 200u
[2023-07-29 10:24:56] [config] sync-sgd: false
[2023-07-29 10:24:56] [config] tempdir: /tmp
[2023-07-29 10:24:56] [config] tied-embeddings: false
[2023-07-29 10:24:56] [config] tied-embeddings-all: true
[2023-07-29 10:24:56] [config] tied-embeddings-src: false
[2023-07-29 10:24:56] [config] train-embedder-rank:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] train-sets:
[2023-07-29 10:24:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 10:24:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 10:24:56] [config] transformer-aan-activation: swish
[2023-07-29 10:24:56] [config] transformer-aan-depth: 2
[2023-07-29 10:24:56] [config] transformer-aan-nogate: false
[2023-07-29 10:24:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 10:24:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 10:24:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 10:24:56] [config] transformer-depth-scaling: false
[2023-07-29 10:24:56] [config] transformer-dim-aan: 2048
[2023-07-29 10:24:56] [config] transformer-dim-ffn: 2048
[2023-07-29 10:24:56] [config] transformer-dropout: 0
[2023-07-29 10:24:56] [config] transformer-dropout-attention: 0
[2023-07-29 10:24:56] [config] transformer-dropout-ffn: 0
[2023-07-29 10:24:56] [config] transformer-ffn-activation: swish
[2023-07-29 10:24:56] [config] transformer-ffn-depth: 2
[2023-07-29 10:24:56] [config] transformer-guided-alignment-layer: last
[2023-07-29 10:24:56] [config] transformer-heads: 8
[2023-07-29 10:24:56] [config] transformer-no-projection: false
[2023-07-29 10:24:56] [config] transformer-pool: false
[2023-07-29 10:24:56] [config] transformer-postprocess: dan
[2023-07-29 10:24:56] [config] transformer-postprocess-emb: d
[2023-07-29 10:24:56] [config] transformer-postprocess-top: ""
[2023-07-29 10:24:56] [config] transformer-preprocess: ""
[2023-07-29 10:24:56] [config] transformer-tied-layers:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] transformer-train-position-embeddings: false
[2023-07-29 10:24:56] [config] tsv: false
[2023-07-29 10:24:56] [config] tsv-fields: 0
[2023-07-29 10:24:56] [config] type: s2s
[2023-07-29 10:24:56] [config] ulr: false
[2023-07-29 10:24:56] [config] ulr-dim-emb: 0
[2023-07-29 10:24:56] [config] ulr-dropout: 0
[2023-07-29 10:24:56] [config] ulr-keys-vectors: ""
[2023-07-29 10:24:56] [config] ulr-query-vectors: ""
[2023-07-29 10:24:56] [config] ulr-softmax-temperature: 1
[2023-07-29 10:24:56] [config] ulr-trainable-transformation: false
[2023-07-29 10:24:56] [config] unlikelihood-loss: false
[2023-07-29 10:24:56] [config] valid-freq: 50000000
[2023-07-29 10:24:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 10:24:56] [config] valid-max-length: 1000
[2023-07-29 10:24:56] [config] valid-metrics:
[2023-07-29 10:24:56] [config]   - translation
[2023-07-29 10:24:56] [config] valid-mini-batch: 32
[2023-07-29 10:24:56] [config] valid-reset-stalled: false
[2023-07-29 10:24:56] [config] valid-script-args:
[2023-07-29 10:24:56] [config]   []
[2023-07-29 10:24:56] [config] valid-script-path: ""
[2023-07-29 10:24:56] [config] valid-sets:
[2023-07-29 10:24:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 10:24:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 10:24:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 10:24:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 10:24:56] [config] vocabs:
[2023-07-29 10:24:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 10:24:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 10:24:56] [config] word-penalty: 0
[2023-07-29 10:24:56] [config] word-scores: false
[2023-07-29 10:24:56] [config] workspace: 5500
[2023-07-29 10:24:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 10:24:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 10:24:56] [training] Using single-device training
[2023-07-29 10:24:56] Synced seed 1234
[2023-07-29 10:24:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 10:24:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 10:24:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 10:24:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 10:24:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 10:24:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 10:24:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 10:24:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 10:24:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 10:24:57] [comm] Using global sharding
[2023-07-29 10:24:57] [comm] NCCLCommunicators constructed successfully
[2023-07-29 10:24:57] [training] Using 1 GPUs
[2023-07-29 10:24:57] [logits] Applying loss function for 1 factor(s)
[2023-07-29 10:24:57] [memory] Reserving 80 MB, device gpu0
[2023-07-29 10:24:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 10:24:57] [memory] Reserving 80 MB, device gpu0
[2023-07-29 11:01:48] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 11:01:48] [valid] No post-processing script given for validating translator
[2023-07-29 11:01:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 11:01:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 11:01:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 11:01:48] [comm] Using global sharding
[2023-07-29 11:01:48] [comm] NCCLCommunicators constructed successfully
[2023-07-29 11:01:48] [training] Using 1 GPUs
[2023-07-29 11:01:48] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 11:01:50] Allocating memory for general optimizer shards
[2023-07-29 11:01:50] [memory] Reserving 322 MB, device gpu0
[2023-07-29 11:01:50] Loading Adam parameters
[2023-07-29 11:01:50] [memory] Reserving 322 MB, device gpu0
[2023-07-29 11:01:50] [memory] Reserving 80 MB, device gpu0
[2023-07-29 11:01:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 11:01:50] [data] Restoring the corpus state to epoch 381, batch 14747
[2023-07-29 11:01:50] [data] Shuffling data
[2023-07-29 11:01:50] [data] Done reading 20,192 sentences
[2023-07-29 11:01:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:01:50] Training started
[2023-07-29 11:01:50] Training finished
Early stopping after 220 epochs
