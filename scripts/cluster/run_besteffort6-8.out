[2023-07-27 13:54:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:54:29] [marian] Running on node18.datos.cluster.uy as process 26764 with command line:
[2023-07-27 13:54:29] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 13:54:29] [config] after: 0e
[2023-07-27 13:54:29] [config] after-batches: 0
[2023-07-27 13:54:29] [config] after-epochs: 10
[2023-07-27 13:54:29] [config] all-caps-every: 0
[2023-07-27 13:54:29] [config] allow-unk: false
[2023-07-27 13:54:29] [config] authors: false
[2023-07-27 13:54:29] [config] beam-size: 12
[2023-07-27 13:54:29] [config] bert-class-symbol: "[CLS]"
[2023-07-27 13:54:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 13:54:29] [config] bert-masking-fraction: 0.15
[2023-07-27 13:54:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 13:54:29] [config] bert-train-type-embeddings: true
[2023-07-27 13:54:29] [config] bert-type-vocab-size: 2
[2023-07-27 13:54:29] [config] build-info: ""
[2023-07-27 13:54:29] [config] check-gradient-nan: false
[2023-07-27 13:54:29] [config] check-nan: false
[2023-07-27 13:54:29] [config] cite: false
[2023-07-27 13:54:29] [config] clip-norm: 1
[2023-07-27 13:54:29] [config] cost-scaling:
[2023-07-27 13:54:29] [config]   - 256.f
[2023-07-27 13:54:29] [config]   - 1000
[2023-07-27 13:54:29] [config]   - 2.f
[2023-07-27 13:54:29] [config]   - 256.f
[2023-07-27 13:54:29] [config] cost-type: ce-sum
[2023-07-27 13:54:29] [config] cpu-threads: 0
[2023-07-27 13:54:29] [config] data-threads: 8
[2023-07-27 13:54:29] [config] data-weighting: ""
[2023-07-27 13:54:29] [config] data-weighting-type: sentence
[2023-07-27 13:54:29] [config] dec-cell: gru
[2023-07-27 13:54:29] [config] dec-cell-base-depth: 2
[2023-07-27 13:54:29] [config] dec-cell-high-depth: 1
[2023-07-27 13:54:29] [config] dec-depth: 1
[2023-07-27 13:54:29] [config] devices:
[2023-07-27 13:54:29] [config]   - 0
[2023-07-27 13:54:29] [config] dim-emb: 512
[2023-07-27 13:54:29] [config] dim-rnn: 1024
[2023-07-27 13:54:29] [config] dim-vocabs:
[2023-07-27 13:54:29] [config]   - 16384
[2023-07-27 13:54:29] [config]   - 16384
[2023-07-27 13:54:29] [config] disp-first: 0
[2023-07-27 13:54:29] [config] disp-freq: 1000u
[2023-07-27 13:54:29] [config] disp-label-counts: true
[2023-07-27 13:54:29] [config] dropout-rnn: 0
[2023-07-27 13:54:29] [config] dropout-src: 0
[2023-07-27 13:54:29] [config] dropout-trg: 0
[2023-07-27 13:54:29] [config] dump-config: ""
[2023-07-27 13:54:29] [config] dynamic-gradient-scaling:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] early-stopping: 1000
[2023-07-27 13:54:29] [config] early-stopping-on: first
[2023-07-27 13:54:29] [config] embedding-fix-src: false
[2023-07-27 13:54:29] [config] embedding-fix-trg: false
[2023-07-27 13:54:29] [config] embedding-normalization: false
[2023-07-27 13:54:29] [config] embedding-vectors:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] enc-cell: gru
[2023-07-27 13:54:29] [config] enc-cell-depth: 1
[2023-07-27 13:54:29] [config] enc-depth: 1
[2023-07-27 13:54:29] [config] enc-type: bidirectional
[2023-07-27 13:54:29] [config] english-title-case-every: 0
[2023-07-27 13:54:29] [config] exponential-smoothing: 0
[2023-07-27 13:54:29] [config] factor-weight: 1
[2023-07-27 13:54:29] [config] factors-combine: sum
[2023-07-27 13:54:29] [config] factors-dim-emb: 0
[2023-07-27 13:54:29] [config] gradient-checkpointing: false
[2023-07-27 13:54:29] [config] gradient-norm-average-window: 100
[2023-07-27 13:54:29] [config] guided-alignment: none
[2023-07-27 13:54:29] [config] guided-alignment-cost: mse
[2023-07-27 13:54:29] [config] guided-alignment-weight: 0.1
[2023-07-27 13:54:29] [config] ignore-model-config: false
[2023-07-27 13:54:29] [config] input-types:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] interpolate-env-vars: false
[2023-07-27 13:54:29] [config] keep-best: false
[2023-07-27 13:54:29] [config] label-smoothing: 0
[2023-07-27 13:54:29] [config] layer-normalization: false
[2023-07-27 13:54:29] [config] learn-rate: 0.0001
[2023-07-27 13:54:29] [config] lemma-dependency: ""
[2023-07-27 13:54:29] [config] lemma-dim-emb: 0
[2023-07-27 13:54:29] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 13:54:29] [config] log-level: info
[2023-07-27 13:54:29] [config] log-time-zone: ""
[2023-07-27 13:54:29] [config] logical-epoch:
[2023-07-27 13:54:29] [config]   - 1e
[2023-07-27 13:54:29] [config]   - 0
[2023-07-27 13:54:29] [config] lr-decay: 0
[2023-07-27 13:54:29] [config] lr-decay-freq: 50000
[2023-07-27 13:54:29] [config] lr-decay-inv-sqrt:
[2023-07-27 13:54:29] [config]   - 0
[2023-07-27 13:54:29] [config] lr-decay-repeat-warmup: false
[2023-07-27 13:54:29] [config] lr-decay-reset-optimizer: false
[2023-07-27 13:54:29] [config] lr-decay-start:
[2023-07-27 13:54:29] [config]   - 10
[2023-07-27 13:54:29] [config]   - 1
[2023-07-27 13:54:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 13:54:29] [config] lr-report: false
[2023-07-27 13:54:29] [config] lr-warmup: 0
[2023-07-27 13:54:29] [config] lr-warmup-at-reload: false
[2023-07-27 13:54:29] [config] lr-warmup-cycle: false
[2023-07-27 13:54:29] [config] lr-warmup-start-rate: 0
[2023-07-27 13:54:29] [config] max-length: 250
[2023-07-27 13:54:29] [config] max-length-crop: true
[2023-07-27 13:54:29] [config] max-length-factor: 3
[2023-07-27 13:54:29] [config] maxi-batch: 100
[2023-07-27 13:54:29] [config] maxi-batch-sort: trg
[2023-07-27 13:54:29] [config] mini-batch: 64
[2023-07-27 13:54:29] [config] mini-batch-fit: true
[2023-07-27 13:54:29] [config] mini-batch-fit-step: 10
[2023-07-27 13:54:29] [config] mini-batch-round-up: true
[2023-07-27 13:54:29] [config] mini-batch-track-lr: false
[2023-07-27 13:54:29] [config] mini-batch-warmup: 0
[2023-07-27 13:54:29] [config] mini-batch-words: 0
[2023-07-27 13:54:29] [config] mini-batch-words-ref: 0
[2023-07-27 13:54:29] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 13:54:29] [config] multi-loss-type: sum
[2023-07-27 13:54:29] [config] n-best: false
[2023-07-27 13:54:29] [config] no-nccl: false
[2023-07-27 13:54:29] [config] no-reload: false
[2023-07-27 13:54:29] [config] no-restore-corpus: false
[2023-07-27 13:54:29] [config] normalize: 0
[2023-07-27 13:54:29] [config] normalize-gradient: false
[2023-07-27 13:54:29] [config] num-devices: 0
[2023-07-27 13:54:29] [config] optimizer: adam
[2023-07-27 13:54:29] [config] optimizer-delay: 1
[2023-07-27 13:54:29] [config] optimizer-params:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] output-omit-bias: false
[2023-07-27 13:54:29] [config] overwrite: true
[2023-07-27 13:54:29] [config] precision:
[2023-07-27 13:54:29] [config]   - float16
[2023-07-27 13:54:29] [config]   - float32
[2023-07-27 13:54:29] [config] pretrained-model: ""
[2023-07-27 13:54:29] [config] quantize-biases: false
[2023-07-27 13:54:29] [config] quantize-bits: 0
[2023-07-27 13:54:29] [config] quantize-log-based: false
[2023-07-27 13:54:29] [config] quantize-optimization-steps: 0
[2023-07-27 13:54:29] [config] quiet: false
[2023-07-27 13:54:29] [config] quiet-translation: true
[2023-07-27 13:54:29] [config] relative-paths: false
[2023-07-27 13:54:29] [config] right-left: false
[2023-07-27 13:54:29] [config] save-freq: 10000u
[2023-07-27 13:54:29] [config] seed: 1234
[2023-07-27 13:54:29] [config] sentencepiece-alphas:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] sentencepiece-max-lines: 2000000
[2023-07-27 13:54:29] [config] sentencepiece-options: ""
[2023-07-27 13:54:29] [config] sharding: global
[2023-07-27 13:54:29] [config] shuffle: data
[2023-07-27 13:54:29] [config] shuffle-in-ram: false
[2023-07-27 13:54:29] [config] sigterm: save-and-exit
[2023-07-27 13:54:29] [config] skip: false
[2023-07-27 13:54:29] [config] sqlite: ""
[2023-07-27 13:54:29] [config] sqlite-drop: false
[2023-07-27 13:54:29] [config] sync-freq: 200u
[2023-07-27 13:54:29] [config] sync-sgd: false
[2023-07-27 13:54:29] [config] tempdir: /tmp
[2023-07-27 13:54:29] [config] tied-embeddings: false
[2023-07-27 13:54:29] [config] tied-embeddings-all: true
[2023-07-27 13:54:29] [config] tied-embeddings-src: false
[2023-07-27 13:54:29] [config] train-embedder-rank:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] train-sets:
[2023-07-27 13:54:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 13:54:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 13:54:29] [config] transformer-aan-activation: swish
[2023-07-27 13:54:29] [config] transformer-aan-depth: 2
[2023-07-27 13:54:29] [config] transformer-aan-nogate: false
[2023-07-27 13:54:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 13:54:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 13:54:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 13:54:29] [config] transformer-depth-scaling: false
[2023-07-27 13:54:29] [config] transformer-dim-aan: 2048
[2023-07-27 13:54:29] [config] transformer-dim-ffn: 2048
[2023-07-27 13:54:29] [config] transformer-dropout: 0
[2023-07-27 13:54:29] [config] transformer-dropout-attention: 0
[2023-07-27 13:54:29] [config] transformer-dropout-ffn: 0
[2023-07-27 13:54:29] [config] transformer-ffn-activation: swish
[2023-07-27 13:54:29] [config] transformer-ffn-depth: 2
[2023-07-27 13:54:29] [config] transformer-guided-alignment-layer: last
[2023-07-27 13:54:29] [config] transformer-heads: 8
[2023-07-27 13:54:29] [config] transformer-no-projection: false
[2023-07-27 13:54:29] [config] transformer-pool: false
[2023-07-27 13:54:29] [config] transformer-postprocess: dan
[2023-07-27 13:54:29] [config] transformer-postprocess-emb: d
[2023-07-27 13:54:29] [config] transformer-postprocess-top: ""
[2023-07-27 13:54:29] [config] transformer-preprocess: ""
[2023-07-27 13:54:29] [config] transformer-tied-layers:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] transformer-train-position-embeddings: false
[2023-07-27 13:54:29] [config] tsv: false
[2023-07-27 13:54:29] [config] tsv-fields: 0
[2023-07-27 13:54:29] [config] type: s2s
[2023-07-27 13:54:29] [config] ulr: false
[2023-07-27 13:54:29] [config] ulr-dim-emb: 0
[2023-07-27 13:54:29] [config] ulr-dropout: 0
[2023-07-27 13:54:29] [config] ulr-keys-vectors: ""
[2023-07-27 13:54:29] [config] ulr-query-vectors: ""
[2023-07-27 13:54:29] [config] ulr-softmax-temperature: 1
[2023-07-27 13:54:29] [config] ulr-trainable-transformation: false
[2023-07-27 13:54:29] [config] unlikelihood-loss: false
[2023-07-27 13:54:29] [config] valid-freq: 50000000
[2023-07-27 13:54:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 13:54:29] [config] valid-max-length: 1000
[2023-07-27 13:54:29] [config] valid-metrics:
[2023-07-27 13:54:29] [config]   - translation
[2023-07-27 13:54:29] [config] valid-mini-batch: 32
[2023-07-27 13:54:29] [config] valid-reset-stalled: false
[2023-07-27 13:54:29] [config] valid-script-args:
[2023-07-27 13:54:29] [config]   []
[2023-07-27 13:54:29] [config] valid-script-path: ""
[2023-07-27 13:54:29] [config] valid-sets:
[2023-07-27 13:54:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 13:54:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 13:54:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 13:54:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:54:29] [config] vocabs:
[2023-07-27 13:54:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 13:54:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 13:54:29] [config] word-penalty: 0
[2023-07-27 13:54:29] [config] word-scores: false
[2023-07-27 13:54:29] [config] workspace: 5500
[2023-07-27 13:54:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 13:54:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:54:29] [training] Using single-device training
[2023-07-27 13:54:29] Synced seed 1234
[2023-07-27 13:54:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 13:54:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 13:54:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 13:54:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 13:54:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 13:54:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 13:54:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 13:54:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 13:54:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 13:54:30] [comm] Using global sharding
[2023-07-27 13:54:30] [comm] NCCLCommunicators constructed successfully
[2023-07-27 13:54:30] [training] Using 1 GPUs
[2023-07-27 13:54:30] [logits] Applying loss function for 1 factor(s)
[2023-07-27 13:54:30] [memory] Reserving 80 MB, device gpu0
[2023-07-27 13:54:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 13:54:33] [memory] Reserving 80 MB, device gpu0
[2023-07-27 14:41:48] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 14:41:48] [valid] No post-processing script given for validating translator
[2023-07-27 14:41:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:41:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 14:41:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 14:41:48] [comm] Using global sharding
[2023-07-27 14:41:48] [comm] NCCLCommunicators constructed successfully
[2023-07-27 14:41:48] [training] Using 1 GPUs
[2023-07-27 14:41:48] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 14:41:49] Allocating memory for general optimizer shards
[2023-07-27 14:41:49] [memory] Reserving 322 MB, device gpu0
[2023-07-27 14:41:49] Loading Adam parameters
[2023-07-27 14:41:49] [memory] Reserving 322 MB, device gpu0
[2023-07-27 14:41:49] [memory] Reserving 80 MB, device gpu0
[2023-07-27 14:41:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 14:41:50] [data] Restoring the corpus state to epoch 31, batch 1166
[2023-07-27 14:41:50] [data] Shuffling data
[2023-07-27 14:41:50] [data] Done reading 20,192 sentences
[2023-07-27 14:41:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 14:41:50] Training started
[2023-07-27 14:41:50] Training finished
[2023-07-27 14:41:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:41:53] [marian] Running on node18.datos.cluster.uy as process 29704 with command line:
[2023-07-27 14:41:53] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 14:41:53] [config] after: 0e
[2023-07-27 14:41:53] [config] after-batches: 0
[2023-07-27 14:41:53] [config] after-epochs: 20
[2023-07-27 14:41:53] [config] all-caps-every: 0
[2023-07-27 14:41:53] [config] allow-unk: false
[2023-07-27 14:41:53] [config] authors: false
[2023-07-27 14:41:53] [config] beam-size: 12
[2023-07-27 14:41:53] [config] bert-class-symbol: "[CLS]"
[2023-07-27 14:41:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 14:41:53] [config] bert-masking-fraction: 0.15
[2023-07-27 14:41:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 14:41:53] [config] bert-train-type-embeddings: true
[2023-07-27 14:41:53] [config] bert-type-vocab-size: 2
[2023-07-27 14:41:53] [config] build-info: ""
[2023-07-27 14:41:53] [config] check-gradient-nan: false
[2023-07-27 14:41:53] [config] check-nan: false
[2023-07-27 14:41:53] [config] cite: false
[2023-07-27 14:41:53] [config] clip-norm: 1
[2023-07-27 14:41:53] [config] cost-scaling:
[2023-07-27 14:41:53] [config]   - 256.f
[2023-07-27 14:41:53] [config]   - 1000
[2023-07-27 14:41:53] [config]   - 2.f
[2023-07-27 14:41:53] [config]   - 256.f
[2023-07-27 14:41:53] [config] cost-type: ce-sum
[2023-07-27 14:41:53] [config] cpu-threads: 0
[2023-07-27 14:41:53] [config] data-threads: 8
[2023-07-27 14:41:53] [config] data-weighting: ""
[2023-07-27 14:41:53] [config] data-weighting-type: sentence
[2023-07-27 14:41:53] [config] dec-cell: gru
[2023-07-27 14:41:53] [config] dec-cell-base-depth: 2
[2023-07-27 14:41:53] [config] dec-cell-high-depth: 1
[2023-07-27 14:41:53] [config] dec-depth: 1
[2023-07-27 14:41:53] [config] devices:
[2023-07-27 14:41:53] [config]   - 0
[2023-07-27 14:41:53] [config] dim-emb: 512
[2023-07-27 14:41:53] [config] dim-rnn: 1024
[2023-07-27 14:41:53] [config] dim-vocabs:
[2023-07-27 14:41:53] [config]   - 16384
[2023-07-27 14:41:53] [config]   - 16384
[2023-07-27 14:41:53] [config] disp-first: 0
[2023-07-27 14:41:53] [config] disp-freq: 1000u
[2023-07-27 14:41:53] [config] disp-label-counts: true
[2023-07-27 14:41:53] [config] dropout-rnn: 0
[2023-07-27 14:41:53] [config] dropout-src: 0
[2023-07-27 14:41:53] [config] dropout-trg: 0
[2023-07-27 14:41:53] [config] dump-config: ""
[2023-07-27 14:41:53] [config] dynamic-gradient-scaling:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] early-stopping: 1000
[2023-07-27 14:41:53] [config] early-stopping-on: first
[2023-07-27 14:41:53] [config] embedding-fix-src: false
[2023-07-27 14:41:53] [config] embedding-fix-trg: false
[2023-07-27 14:41:53] [config] embedding-normalization: false
[2023-07-27 14:41:53] [config] embedding-vectors:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] enc-cell: gru
[2023-07-27 14:41:53] [config] enc-cell-depth: 1
[2023-07-27 14:41:53] [config] enc-depth: 1
[2023-07-27 14:41:53] [config] enc-type: bidirectional
[2023-07-27 14:41:53] [config] english-title-case-every: 0
[2023-07-27 14:41:53] [config] exponential-smoothing: 0
[2023-07-27 14:41:53] [config] factor-weight: 1
[2023-07-27 14:41:53] [config] factors-combine: sum
[2023-07-27 14:41:53] [config] factors-dim-emb: 0
[2023-07-27 14:41:53] [config] gradient-checkpointing: false
[2023-07-27 14:41:53] [config] gradient-norm-average-window: 100
[2023-07-27 14:41:53] [config] guided-alignment: none
[2023-07-27 14:41:53] [config] guided-alignment-cost: mse
[2023-07-27 14:41:53] [config] guided-alignment-weight: 0.1
[2023-07-27 14:41:53] [config] ignore-model-config: false
[2023-07-27 14:41:53] [config] input-types:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] interpolate-env-vars: false
[2023-07-27 14:41:53] [config] keep-best: false
[2023-07-27 14:41:53] [config] label-smoothing: 0
[2023-07-27 14:41:53] [config] layer-normalization: false
[2023-07-27 14:41:53] [config] learn-rate: 0.0001
[2023-07-27 14:41:53] [config] lemma-dependency: ""
[2023-07-27 14:41:53] [config] lemma-dim-emb: 0
[2023-07-27 14:41:53] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 14:41:53] [config] log-level: info
[2023-07-27 14:41:53] [config] log-time-zone: ""
[2023-07-27 14:41:53] [config] logical-epoch:
[2023-07-27 14:41:53] [config]   - 1e
[2023-07-27 14:41:53] [config]   - 0
[2023-07-27 14:41:53] [config] lr-decay: 0
[2023-07-27 14:41:53] [config] lr-decay-freq: 50000
[2023-07-27 14:41:53] [config] lr-decay-inv-sqrt:
[2023-07-27 14:41:53] [config]   - 0
[2023-07-27 14:41:53] [config] lr-decay-repeat-warmup: false
[2023-07-27 14:41:53] [config] lr-decay-reset-optimizer: false
[2023-07-27 14:41:53] [config] lr-decay-start:
[2023-07-27 14:41:53] [config]   - 10
[2023-07-27 14:41:53] [config]   - 1
[2023-07-27 14:41:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 14:41:53] [config] lr-report: false
[2023-07-27 14:41:53] [config] lr-warmup: 0
[2023-07-27 14:41:53] [config] lr-warmup-at-reload: false
[2023-07-27 14:41:53] [config] lr-warmup-cycle: false
[2023-07-27 14:41:53] [config] lr-warmup-start-rate: 0
[2023-07-27 14:41:53] [config] max-length: 250
[2023-07-27 14:41:53] [config] max-length-crop: true
[2023-07-27 14:41:53] [config] max-length-factor: 3
[2023-07-27 14:41:53] [config] maxi-batch: 100
[2023-07-27 14:41:53] [config] maxi-batch-sort: trg
[2023-07-27 14:41:53] [config] mini-batch: 64
[2023-07-27 14:41:53] [config] mini-batch-fit: true
[2023-07-27 14:41:53] [config] mini-batch-fit-step: 10
[2023-07-27 14:41:53] [config] mini-batch-round-up: true
[2023-07-27 14:41:53] [config] mini-batch-track-lr: false
[2023-07-27 14:41:53] [config] mini-batch-warmup: 0
[2023-07-27 14:41:53] [config] mini-batch-words: 0
[2023-07-27 14:41:53] [config] mini-batch-words-ref: 0
[2023-07-27 14:41:53] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 14:41:53] [config] multi-loss-type: sum
[2023-07-27 14:41:53] [config] n-best: false
[2023-07-27 14:41:53] [config] no-nccl: false
[2023-07-27 14:41:53] [config] no-reload: false
[2023-07-27 14:41:53] [config] no-restore-corpus: false
[2023-07-27 14:41:53] [config] normalize: 0
[2023-07-27 14:41:53] [config] normalize-gradient: false
[2023-07-27 14:41:53] [config] num-devices: 0
[2023-07-27 14:41:53] [config] optimizer: adam
[2023-07-27 14:41:53] [config] optimizer-delay: 1
[2023-07-27 14:41:53] [config] optimizer-params:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] output-omit-bias: false
[2023-07-27 14:41:53] [config] overwrite: true
[2023-07-27 14:41:53] [config] precision:
[2023-07-27 14:41:53] [config]   - float16
[2023-07-27 14:41:53] [config]   - float32
[2023-07-27 14:41:53] [config] pretrained-model: ""
[2023-07-27 14:41:53] [config] quantize-biases: false
[2023-07-27 14:41:53] [config] quantize-bits: 0
[2023-07-27 14:41:53] [config] quantize-log-based: false
[2023-07-27 14:41:53] [config] quantize-optimization-steps: 0
[2023-07-27 14:41:53] [config] quiet: false
[2023-07-27 14:41:53] [config] quiet-translation: true
[2023-07-27 14:41:53] [config] relative-paths: false
[2023-07-27 14:41:53] [config] right-left: false
[2023-07-27 14:41:53] [config] save-freq: 10000u
[2023-07-27 14:41:53] [config] seed: 1234
[2023-07-27 14:41:53] [config] sentencepiece-alphas:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] sentencepiece-max-lines: 2000000
[2023-07-27 14:41:53] [config] sentencepiece-options: ""
[2023-07-27 14:41:53] [config] sharding: global
[2023-07-27 14:41:53] [config] shuffle: data
[2023-07-27 14:41:53] [config] shuffle-in-ram: false
[2023-07-27 14:41:53] [config] sigterm: save-and-exit
[2023-07-27 14:41:53] [config] skip: false
[2023-07-27 14:41:53] [config] sqlite: ""
[2023-07-27 14:41:53] [config] sqlite-drop: false
[2023-07-27 14:41:53] [config] sync-freq: 200u
[2023-07-27 14:41:53] [config] sync-sgd: false
[2023-07-27 14:41:53] [config] tempdir: /tmp
[2023-07-27 14:41:53] [config] tied-embeddings: false
[2023-07-27 14:41:53] [config] tied-embeddings-all: true
[2023-07-27 14:41:53] [config] tied-embeddings-src: false
[2023-07-27 14:41:53] [config] train-embedder-rank:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] train-sets:
[2023-07-27 14:41:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 14:41:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 14:41:53] [config] transformer-aan-activation: swish
[2023-07-27 14:41:53] [config] transformer-aan-depth: 2
[2023-07-27 14:41:53] [config] transformer-aan-nogate: false
[2023-07-27 14:41:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 14:41:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 14:41:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 14:41:53] [config] transformer-depth-scaling: false
[2023-07-27 14:41:53] [config] transformer-dim-aan: 2048
[2023-07-27 14:41:53] [config] transformer-dim-ffn: 2048
[2023-07-27 14:41:53] [config] transformer-dropout: 0
[2023-07-27 14:41:53] [config] transformer-dropout-attention: 0
[2023-07-27 14:41:53] [config] transformer-dropout-ffn: 0
[2023-07-27 14:41:53] [config] transformer-ffn-activation: swish
[2023-07-27 14:41:53] [config] transformer-ffn-depth: 2
[2023-07-27 14:41:53] [config] transformer-guided-alignment-layer: last
[2023-07-27 14:41:53] [config] transformer-heads: 8
[2023-07-27 14:41:53] [config] transformer-no-projection: false
[2023-07-27 14:41:53] [config] transformer-pool: false
[2023-07-27 14:41:53] [config] transformer-postprocess: dan
[2023-07-27 14:41:53] [config] transformer-postprocess-emb: d
[2023-07-27 14:41:53] [config] transformer-postprocess-top: ""
[2023-07-27 14:41:53] [config] transformer-preprocess: ""
[2023-07-27 14:41:53] [config] transformer-tied-layers:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] transformer-train-position-embeddings: false
[2023-07-27 14:41:53] [config] tsv: false
[2023-07-27 14:41:53] [config] tsv-fields: 0
[2023-07-27 14:41:53] [config] type: s2s
[2023-07-27 14:41:53] [config] ulr: false
[2023-07-27 14:41:53] [config] ulr-dim-emb: 0
[2023-07-27 14:41:53] [config] ulr-dropout: 0
[2023-07-27 14:41:53] [config] ulr-keys-vectors: ""
[2023-07-27 14:41:53] [config] ulr-query-vectors: ""
[2023-07-27 14:41:53] [config] ulr-softmax-temperature: 1
[2023-07-27 14:41:53] [config] ulr-trainable-transformation: false
[2023-07-27 14:41:53] [config] unlikelihood-loss: false
[2023-07-27 14:41:53] [config] valid-freq: 50000000
[2023-07-27 14:41:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 14:41:53] [config] valid-max-length: 1000
[2023-07-27 14:41:53] [config] valid-metrics:
[2023-07-27 14:41:53] [config]   - translation
[2023-07-27 14:41:53] [config] valid-mini-batch: 32
[2023-07-27 14:41:53] [config] valid-reset-stalled: false
[2023-07-27 14:41:53] [config] valid-script-args:
[2023-07-27 14:41:53] [config]   []
[2023-07-27 14:41:53] [config] valid-script-path: ""
[2023-07-27 14:41:53] [config] valid-sets:
[2023-07-27 14:41:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 14:41:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 14:41:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 14:41:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:41:53] [config] vocabs:
[2023-07-27 14:41:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 14:41:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 14:41:53] [config] word-penalty: 0
[2023-07-27 14:41:53] [config] word-scores: false
[2023-07-27 14:41:53] [config] workspace: 5500
[2023-07-27 14:41:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 14:41:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:41:53] [training] Using single-device training
[2023-07-27 14:41:54] Synced seed 1234
[2023-07-27 14:41:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 14:41:54] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 14:41:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 14:41:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 14:41:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 14:41:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 14:41:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 14:41:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 14:41:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 14:41:54] [comm] Using global sharding
[2023-07-27 14:41:55] [comm] NCCLCommunicators constructed successfully
[2023-07-27 14:41:55] [training] Using 1 GPUs
[2023-07-27 14:41:55] [logits] Applying loss function for 1 factor(s)
[2023-07-27 14:41:55] [memory] Reserving 80 MB, device gpu0
[2023-07-27 14:41:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 14:41:55] [memory] Reserving 80 MB, device gpu0
[2023-07-27 15:31:55] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 15:31:56] [valid] No post-processing script given for validating translator
[2023-07-27 15:31:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 15:31:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 15:31:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 15:31:56] [comm] Using global sharding
[2023-07-27 15:31:56] [comm] NCCLCommunicators constructed successfully
[2023-07-27 15:31:56] [training] Using 1 GPUs
[2023-07-27 15:31:56] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 15:31:57] Allocating memory for general optimizer shards
[2023-07-27 15:31:57] [memory] Reserving 322 MB, device gpu0
[2023-07-27 15:31:57] Loading Adam parameters
[2023-07-27 15:31:57] [memory] Reserving 322 MB, device gpu0
[2023-07-27 15:31:57] [memory] Reserving 80 MB, device gpu0
[2023-07-27 15:31:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 15:31:57] [data] Restoring the corpus state to epoch 31, batch 1166
[2023-07-27 15:31:57] [data] Shuffling data
[2023-07-27 15:31:57] [data] Done reading 20,192 sentences
[2023-07-27 15:31:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 15:31:58] Training started
[2023-07-27 15:31:58] Training finished
[2023-07-27 15:32:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 15:32:01] [marian] Running on node18.datos.cluster.uy as process 33085 with command line:
[2023-07-27 15:32:01] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 15:32:01] [config] after: 0e
[2023-07-27 15:32:01] [config] after-batches: 0
[2023-07-27 15:32:01] [config] after-epochs: 30
[2023-07-27 15:32:01] [config] all-caps-every: 0
[2023-07-27 15:32:01] [config] allow-unk: false
[2023-07-27 15:32:01] [config] authors: false
[2023-07-27 15:32:01] [config] beam-size: 12
[2023-07-27 15:32:01] [config] bert-class-symbol: "[CLS]"
[2023-07-27 15:32:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 15:32:01] [config] bert-masking-fraction: 0.15
[2023-07-27 15:32:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 15:32:01] [config] bert-train-type-embeddings: true
[2023-07-27 15:32:01] [config] bert-type-vocab-size: 2
[2023-07-27 15:32:01] [config] build-info: ""
[2023-07-27 15:32:01] [config] check-gradient-nan: false
[2023-07-27 15:32:01] [config] check-nan: false
[2023-07-27 15:32:01] [config] cite: false
[2023-07-27 15:32:01] [config] clip-norm: 1
[2023-07-27 15:32:01] [config] cost-scaling:
[2023-07-27 15:32:01] [config]   - 256.f
[2023-07-27 15:32:01] [config]   - 1000
[2023-07-27 15:32:01] [config]   - 2.f
[2023-07-27 15:32:01] [config]   - 256.f
[2023-07-27 15:32:01] [config] cost-type: ce-sum
[2023-07-27 15:32:01] [config] cpu-threads: 0
[2023-07-27 15:32:01] [config] data-threads: 8
[2023-07-27 15:32:01] [config] data-weighting: ""
[2023-07-27 15:32:01] [config] data-weighting-type: sentence
[2023-07-27 15:32:01] [config] dec-cell: gru
[2023-07-27 15:32:01] [config] dec-cell-base-depth: 2
[2023-07-27 15:32:01] [config] dec-cell-high-depth: 1
[2023-07-27 15:32:01] [config] dec-depth: 1
[2023-07-27 15:32:01] [config] devices:
[2023-07-27 15:32:01] [config]   - 0
[2023-07-27 15:32:01] [config] dim-emb: 512
[2023-07-27 15:32:01] [config] dim-rnn: 1024
[2023-07-27 15:32:01] [config] dim-vocabs:
[2023-07-27 15:32:01] [config]   - 16384
[2023-07-27 15:32:01] [config]   - 16384
[2023-07-27 15:32:01] [config] disp-first: 0
[2023-07-27 15:32:01] [config] disp-freq: 1000u
[2023-07-27 15:32:01] [config] disp-label-counts: true
[2023-07-27 15:32:01] [config] dropout-rnn: 0
[2023-07-27 15:32:01] [config] dropout-src: 0
[2023-07-27 15:32:01] [config] dropout-trg: 0
[2023-07-27 15:32:01] [config] dump-config: ""
[2023-07-27 15:32:01] [config] dynamic-gradient-scaling:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] early-stopping: 1000
[2023-07-27 15:32:01] [config] early-stopping-on: first
[2023-07-27 15:32:01] [config] embedding-fix-src: false
[2023-07-27 15:32:01] [config] embedding-fix-trg: false
[2023-07-27 15:32:01] [config] embedding-normalization: false
[2023-07-27 15:32:01] [config] embedding-vectors:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] enc-cell: gru
[2023-07-27 15:32:01] [config] enc-cell-depth: 1
[2023-07-27 15:32:01] [config] enc-depth: 1
[2023-07-27 15:32:01] [config] enc-type: bidirectional
[2023-07-27 15:32:01] [config] english-title-case-every: 0
[2023-07-27 15:32:01] [config] exponential-smoothing: 0
[2023-07-27 15:32:01] [config] factor-weight: 1
[2023-07-27 15:32:01] [config] factors-combine: sum
[2023-07-27 15:32:01] [config] factors-dim-emb: 0
[2023-07-27 15:32:01] [config] gradient-checkpointing: false
[2023-07-27 15:32:01] [config] gradient-norm-average-window: 100
[2023-07-27 15:32:01] [config] guided-alignment: none
[2023-07-27 15:32:01] [config] guided-alignment-cost: mse
[2023-07-27 15:32:01] [config] guided-alignment-weight: 0.1
[2023-07-27 15:32:01] [config] ignore-model-config: false
[2023-07-27 15:32:01] [config] input-types:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] interpolate-env-vars: false
[2023-07-27 15:32:01] [config] keep-best: false
[2023-07-27 15:32:01] [config] label-smoothing: 0
[2023-07-27 15:32:01] [config] layer-normalization: false
[2023-07-27 15:32:01] [config] learn-rate: 0.0001
[2023-07-27 15:32:01] [config] lemma-dependency: ""
[2023-07-27 15:32:01] [config] lemma-dim-emb: 0
[2023-07-27 15:32:01] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 15:32:01] [config] log-level: info
[2023-07-27 15:32:01] [config] log-time-zone: ""
[2023-07-27 15:32:01] [config] logical-epoch:
[2023-07-27 15:32:01] [config]   - 1e
[2023-07-27 15:32:01] [config]   - 0
[2023-07-27 15:32:01] [config] lr-decay: 0
[2023-07-27 15:32:01] [config] lr-decay-freq: 50000
[2023-07-27 15:32:01] [config] lr-decay-inv-sqrt:
[2023-07-27 15:32:01] [config]   - 0
[2023-07-27 15:32:01] [config] lr-decay-repeat-warmup: false
[2023-07-27 15:32:01] [config] lr-decay-reset-optimizer: false
[2023-07-27 15:32:01] [config] lr-decay-start:
[2023-07-27 15:32:01] [config]   - 10
[2023-07-27 15:32:01] [config]   - 1
[2023-07-27 15:32:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 15:32:01] [config] lr-report: false
[2023-07-27 15:32:01] [config] lr-warmup: 0
[2023-07-27 15:32:01] [config] lr-warmup-at-reload: false
[2023-07-27 15:32:01] [config] lr-warmup-cycle: false
[2023-07-27 15:32:01] [config] lr-warmup-start-rate: 0
[2023-07-27 15:32:01] [config] max-length: 250
[2023-07-27 15:32:01] [config] max-length-crop: true
[2023-07-27 15:32:01] [config] max-length-factor: 3
[2023-07-27 15:32:01] [config] maxi-batch: 100
[2023-07-27 15:32:01] [config] maxi-batch-sort: trg
[2023-07-27 15:32:01] [config] mini-batch: 64
[2023-07-27 15:32:01] [config] mini-batch-fit: true
[2023-07-27 15:32:01] [config] mini-batch-fit-step: 10
[2023-07-27 15:32:01] [config] mini-batch-round-up: true
[2023-07-27 15:32:01] [config] mini-batch-track-lr: false
[2023-07-27 15:32:01] [config] mini-batch-warmup: 0
[2023-07-27 15:32:01] [config] mini-batch-words: 0
[2023-07-27 15:32:01] [config] mini-batch-words-ref: 0
[2023-07-27 15:32:01] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 15:32:01] [config] multi-loss-type: sum
[2023-07-27 15:32:01] [config] n-best: false
[2023-07-27 15:32:01] [config] no-nccl: false
[2023-07-27 15:32:01] [config] no-reload: false
[2023-07-27 15:32:01] [config] no-restore-corpus: false
[2023-07-27 15:32:01] [config] normalize: 0
[2023-07-27 15:32:01] [config] normalize-gradient: false
[2023-07-27 15:32:01] [config] num-devices: 0
[2023-07-27 15:32:01] [config] optimizer: adam
[2023-07-27 15:32:01] [config] optimizer-delay: 1
[2023-07-27 15:32:01] [config] optimizer-params:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] output-omit-bias: false
[2023-07-27 15:32:01] [config] overwrite: true
[2023-07-27 15:32:01] [config] precision:
[2023-07-27 15:32:01] [config]   - float16
[2023-07-27 15:32:01] [config]   - float32
[2023-07-27 15:32:01] [config] pretrained-model: ""
[2023-07-27 15:32:01] [config] quantize-biases: false
[2023-07-27 15:32:01] [config] quantize-bits: 0
[2023-07-27 15:32:01] [config] quantize-log-based: false
[2023-07-27 15:32:01] [config] quantize-optimization-steps: 0
[2023-07-27 15:32:01] [config] quiet: false
[2023-07-27 15:32:01] [config] quiet-translation: true
[2023-07-27 15:32:01] [config] relative-paths: false
[2023-07-27 15:32:01] [config] right-left: false
[2023-07-27 15:32:01] [config] save-freq: 10000u
[2023-07-27 15:32:01] [config] seed: 1234
[2023-07-27 15:32:01] [config] sentencepiece-alphas:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] sentencepiece-max-lines: 2000000
[2023-07-27 15:32:01] [config] sentencepiece-options: ""
[2023-07-27 15:32:01] [config] sharding: global
[2023-07-27 15:32:01] [config] shuffle: data
[2023-07-27 15:32:01] [config] shuffle-in-ram: false
[2023-07-27 15:32:01] [config] sigterm: save-and-exit
[2023-07-27 15:32:01] [config] skip: false
[2023-07-27 15:32:01] [config] sqlite: ""
[2023-07-27 15:32:01] [config] sqlite-drop: false
[2023-07-27 15:32:01] [config] sync-freq: 200u
[2023-07-27 15:32:01] [config] sync-sgd: false
[2023-07-27 15:32:01] [config] tempdir: /tmp
[2023-07-27 15:32:01] [config] tied-embeddings: false
[2023-07-27 15:32:01] [config] tied-embeddings-all: true
[2023-07-27 15:32:01] [config] tied-embeddings-src: false
[2023-07-27 15:32:01] [config] train-embedder-rank:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] train-sets:
[2023-07-27 15:32:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 15:32:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 15:32:01] [config] transformer-aan-activation: swish
[2023-07-27 15:32:01] [config] transformer-aan-depth: 2
[2023-07-27 15:32:01] [config] transformer-aan-nogate: false
[2023-07-27 15:32:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 15:32:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 15:32:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 15:32:01] [config] transformer-depth-scaling: false
[2023-07-27 15:32:01] [config] transformer-dim-aan: 2048
[2023-07-27 15:32:01] [config] transformer-dim-ffn: 2048
[2023-07-27 15:32:01] [config] transformer-dropout: 0
[2023-07-27 15:32:01] [config] transformer-dropout-attention: 0
[2023-07-27 15:32:01] [config] transformer-dropout-ffn: 0
[2023-07-27 15:32:01] [config] transformer-ffn-activation: swish
[2023-07-27 15:32:01] [config] transformer-ffn-depth: 2
[2023-07-27 15:32:01] [config] transformer-guided-alignment-layer: last
[2023-07-27 15:32:01] [config] transformer-heads: 8
[2023-07-27 15:32:01] [config] transformer-no-projection: false
[2023-07-27 15:32:01] [config] transformer-pool: false
[2023-07-27 15:32:01] [config] transformer-postprocess: dan
[2023-07-27 15:32:01] [config] transformer-postprocess-emb: d
[2023-07-27 15:32:01] [config] transformer-postprocess-top: ""
[2023-07-27 15:32:01] [config] transformer-preprocess: ""
[2023-07-27 15:32:01] [config] transformer-tied-layers:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] transformer-train-position-embeddings: false
[2023-07-27 15:32:01] [config] tsv: false
[2023-07-27 15:32:01] [config] tsv-fields: 0
[2023-07-27 15:32:01] [config] type: s2s
[2023-07-27 15:32:01] [config] ulr: false
[2023-07-27 15:32:01] [config] ulr-dim-emb: 0
[2023-07-27 15:32:01] [config] ulr-dropout: 0
[2023-07-27 15:32:01] [config] ulr-keys-vectors: ""
[2023-07-27 15:32:01] [config] ulr-query-vectors: ""
[2023-07-27 15:32:01] [config] ulr-softmax-temperature: 1
[2023-07-27 15:32:01] [config] ulr-trainable-transformation: false
[2023-07-27 15:32:01] [config] unlikelihood-loss: false
[2023-07-27 15:32:01] [config] valid-freq: 50000000
[2023-07-27 15:32:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 15:32:01] [config] valid-max-length: 1000
[2023-07-27 15:32:01] [config] valid-metrics:
[2023-07-27 15:32:01] [config]   - translation
[2023-07-27 15:32:01] [config] valid-mini-batch: 32
[2023-07-27 15:32:01] [config] valid-reset-stalled: false
[2023-07-27 15:32:01] [config] valid-script-args:
[2023-07-27 15:32:01] [config]   []
[2023-07-27 15:32:01] [config] valid-script-path: ""
[2023-07-27 15:32:01] [config] valid-sets:
[2023-07-27 15:32:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 15:32:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 15:32:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 15:32:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 15:32:01] [config] vocabs:
[2023-07-27 15:32:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 15:32:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 15:32:01] [config] word-penalty: 0
[2023-07-27 15:32:01] [config] word-scores: false
[2023-07-27 15:32:01] [config] workspace: 5500
[2023-07-27 15:32:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 15:32:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 15:32:01] [training] Using single-device training
[2023-07-27 15:32:01] Synced seed 1234
[2023-07-27 15:32:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 15:32:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 15:32:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 15:32:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 15:32:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 15:32:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 15:32:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 15:32:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 15:32:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 15:32:02] [comm] Using global sharding
[2023-07-27 15:32:02] [comm] NCCLCommunicators constructed successfully
[2023-07-27 15:32:02] [training] Using 1 GPUs
[2023-07-27 15:32:02] [logits] Applying loss function for 1 factor(s)
[2023-07-27 15:32:02] [memory] Reserving 80 MB, device gpu0
[2023-07-27 15:32:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 15:32:02] [memory] Reserving 80 MB, device gpu0
[2023-07-27 16:18:51] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 16:18:51] [valid] No post-processing script given for validating translator
[2023-07-27 16:18:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:18:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 16:18:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 16:18:51] [comm] Using global sharding
[2023-07-27 16:18:51] [comm] NCCLCommunicators constructed successfully
[2023-07-27 16:18:51] [training] Using 1 GPUs
[2023-07-27 16:18:51] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 16:18:52] Allocating memory for general optimizer shards
[2023-07-27 16:18:52] [memory] Reserving 322 MB, device gpu0
[2023-07-27 16:18:52] Loading Adam parameters
[2023-07-27 16:18:52] [memory] Reserving 322 MB, device gpu0
[2023-07-27 16:18:52] [memory] Reserving 80 MB, device gpu0
[2023-07-27 16:18:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 16:18:52] [data] Restoring the corpus state to epoch 31, batch 1166
[2023-07-27 16:18:52] [data] Shuffling data
[2023-07-27 16:18:53] [data] Done reading 20,192 sentences
[2023-07-27 16:18:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 16:18:53] Training started
[2023-07-27 16:18:53] Training finished
[2023-07-27 16:18:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:18:56] [marian] Running on node18.datos.cluster.uy as process 35957 with command line:
[2023-07-27 16:18:56] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 16:18:56] [config] after: 0e
[2023-07-27 16:18:56] [config] after-batches: 0
[2023-07-27 16:18:56] [config] after-epochs: 40
[2023-07-27 16:18:56] [config] all-caps-every: 0
[2023-07-27 16:18:56] [config] allow-unk: false
[2023-07-27 16:18:56] [config] authors: false
[2023-07-27 16:18:56] [config] beam-size: 12
[2023-07-27 16:18:56] [config] bert-class-symbol: "[CLS]"
[2023-07-27 16:18:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 16:18:56] [config] bert-masking-fraction: 0.15
[2023-07-27 16:18:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 16:18:56] [config] bert-train-type-embeddings: true
[2023-07-27 16:18:56] [config] bert-type-vocab-size: 2
[2023-07-27 16:18:56] [config] build-info: ""
[2023-07-27 16:18:56] [config] check-gradient-nan: false
[2023-07-27 16:18:56] [config] check-nan: false
[2023-07-27 16:18:56] [config] cite: false
[2023-07-27 16:18:56] [config] clip-norm: 1
[2023-07-27 16:18:56] [config] cost-scaling:
[2023-07-27 16:18:56] [config]   - 256.f
[2023-07-27 16:18:56] [config]   - 1000
[2023-07-27 16:18:56] [config]   - 2.f
[2023-07-27 16:18:56] [config]   - 256.f
[2023-07-27 16:18:56] [config] cost-type: ce-sum
[2023-07-27 16:18:56] [config] cpu-threads: 0
[2023-07-27 16:18:56] [config] data-threads: 8
[2023-07-27 16:18:56] [config] data-weighting: ""
[2023-07-27 16:18:56] [config] data-weighting-type: sentence
[2023-07-27 16:18:56] [config] dec-cell: gru
[2023-07-27 16:18:56] [config] dec-cell-base-depth: 2
[2023-07-27 16:18:56] [config] dec-cell-high-depth: 1
[2023-07-27 16:18:56] [config] dec-depth: 1
[2023-07-27 16:18:56] [config] devices:
[2023-07-27 16:18:56] [config]   - 0
[2023-07-27 16:18:56] [config] dim-emb: 512
[2023-07-27 16:18:56] [config] dim-rnn: 1024
[2023-07-27 16:18:56] [config] dim-vocabs:
[2023-07-27 16:18:56] [config]   - 16384
[2023-07-27 16:18:56] [config]   - 16384
[2023-07-27 16:18:56] [config] disp-first: 0
[2023-07-27 16:18:56] [config] disp-freq: 1000u
[2023-07-27 16:18:56] [config] disp-label-counts: true
[2023-07-27 16:18:56] [config] dropout-rnn: 0
[2023-07-27 16:18:56] [config] dropout-src: 0
[2023-07-27 16:18:56] [config] dropout-trg: 0
[2023-07-27 16:18:56] [config] dump-config: ""
[2023-07-27 16:18:56] [config] dynamic-gradient-scaling:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] early-stopping: 1000
[2023-07-27 16:18:56] [config] early-stopping-on: first
[2023-07-27 16:18:56] [config] embedding-fix-src: false
[2023-07-27 16:18:56] [config] embedding-fix-trg: false
[2023-07-27 16:18:56] [config] embedding-normalization: false
[2023-07-27 16:18:56] [config] embedding-vectors:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] enc-cell: gru
[2023-07-27 16:18:56] [config] enc-cell-depth: 1
[2023-07-27 16:18:56] [config] enc-depth: 1
[2023-07-27 16:18:56] [config] enc-type: bidirectional
[2023-07-27 16:18:56] [config] english-title-case-every: 0
[2023-07-27 16:18:56] [config] exponential-smoothing: 0
[2023-07-27 16:18:56] [config] factor-weight: 1
[2023-07-27 16:18:56] [config] factors-combine: sum
[2023-07-27 16:18:56] [config] factors-dim-emb: 0
[2023-07-27 16:18:56] [config] gradient-checkpointing: false
[2023-07-27 16:18:56] [config] gradient-norm-average-window: 100
[2023-07-27 16:18:56] [config] guided-alignment: none
[2023-07-27 16:18:56] [config] guided-alignment-cost: mse
[2023-07-27 16:18:56] [config] guided-alignment-weight: 0.1
[2023-07-27 16:18:56] [config] ignore-model-config: false
[2023-07-27 16:18:56] [config] input-types:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] interpolate-env-vars: false
[2023-07-27 16:18:56] [config] keep-best: false
[2023-07-27 16:18:56] [config] label-smoothing: 0
[2023-07-27 16:18:56] [config] layer-normalization: false
[2023-07-27 16:18:56] [config] learn-rate: 0.0001
[2023-07-27 16:18:56] [config] lemma-dependency: ""
[2023-07-27 16:18:56] [config] lemma-dim-emb: 0
[2023-07-27 16:18:56] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 16:18:56] [config] log-level: info
[2023-07-27 16:18:56] [config] log-time-zone: ""
[2023-07-27 16:18:56] [config] logical-epoch:
[2023-07-27 16:18:56] [config]   - 1e
[2023-07-27 16:18:56] [config]   - 0
[2023-07-27 16:18:56] [config] lr-decay: 0
[2023-07-27 16:18:56] [config] lr-decay-freq: 50000
[2023-07-27 16:18:56] [config] lr-decay-inv-sqrt:
[2023-07-27 16:18:56] [config]   - 0
[2023-07-27 16:18:56] [config] lr-decay-repeat-warmup: false
[2023-07-27 16:18:56] [config] lr-decay-reset-optimizer: false
[2023-07-27 16:18:56] [config] lr-decay-start:
[2023-07-27 16:18:56] [config]   - 10
[2023-07-27 16:18:56] [config]   - 1
[2023-07-27 16:18:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 16:18:56] [config] lr-report: false
[2023-07-27 16:18:56] [config] lr-warmup: 0
[2023-07-27 16:18:56] [config] lr-warmup-at-reload: false
[2023-07-27 16:18:56] [config] lr-warmup-cycle: false
[2023-07-27 16:18:56] [config] lr-warmup-start-rate: 0
[2023-07-27 16:18:56] [config] max-length: 250
[2023-07-27 16:18:56] [config] max-length-crop: true
[2023-07-27 16:18:56] [config] max-length-factor: 3
[2023-07-27 16:18:56] [config] maxi-batch: 100
[2023-07-27 16:18:56] [config] maxi-batch-sort: trg
[2023-07-27 16:18:56] [config] mini-batch: 64
[2023-07-27 16:18:56] [config] mini-batch-fit: true
[2023-07-27 16:18:56] [config] mini-batch-fit-step: 10
[2023-07-27 16:18:56] [config] mini-batch-round-up: true
[2023-07-27 16:18:56] [config] mini-batch-track-lr: false
[2023-07-27 16:18:56] [config] mini-batch-warmup: 0
[2023-07-27 16:18:56] [config] mini-batch-words: 0
[2023-07-27 16:18:56] [config] mini-batch-words-ref: 0
[2023-07-27 16:18:56] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 16:18:56] [config] multi-loss-type: sum
[2023-07-27 16:18:56] [config] n-best: false
[2023-07-27 16:18:56] [config] no-nccl: false
[2023-07-27 16:18:56] [config] no-reload: false
[2023-07-27 16:18:56] [config] no-restore-corpus: false
[2023-07-27 16:18:56] [config] normalize: 0
[2023-07-27 16:18:56] [config] normalize-gradient: false
[2023-07-27 16:18:56] [config] num-devices: 0
[2023-07-27 16:18:56] [config] optimizer: adam
[2023-07-27 16:18:56] [config] optimizer-delay: 1
[2023-07-27 16:18:56] [config] optimizer-params:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] output-omit-bias: false
[2023-07-27 16:18:56] [config] overwrite: true
[2023-07-27 16:18:56] [config] precision:
[2023-07-27 16:18:56] [config]   - float16
[2023-07-27 16:18:56] [config]   - float32
[2023-07-27 16:18:56] [config] pretrained-model: ""
[2023-07-27 16:18:56] [config] quantize-biases: false
[2023-07-27 16:18:56] [config] quantize-bits: 0
[2023-07-27 16:18:56] [config] quantize-log-based: false
[2023-07-27 16:18:56] [config] quantize-optimization-steps: 0
[2023-07-27 16:18:56] [config] quiet: false
[2023-07-27 16:18:56] [config] quiet-translation: true
[2023-07-27 16:18:56] [config] relative-paths: false
[2023-07-27 16:18:56] [config] right-left: false
[2023-07-27 16:18:56] [config] save-freq: 10000u
[2023-07-27 16:18:56] [config] seed: 1234
[2023-07-27 16:18:56] [config] sentencepiece-alphas:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] sentencepiece-max-lines: 2000000
[2023-07-27 16:18:56] [config] sentencepiece-options: ""
[2023-07-27 16:18:56] [config] sharding: global
[2023-07-27 16:18:56] [config] shuffle: data
[2023-07-27 16:18:56] [config] shuffle-in-ram: false
[2023-07-27 16:18:56] [config] sigterm: save-and-exit
[2023-07-27 16:18:56] [config] skip: false
[2023-07-27 16:18:56] [config] sqlite: ""
[2023-07-27 16:18:56] [config] sqlite-drop: false
[2023-07-27 16:18:56] [config] sync-freq: 200u
[2023-07-27 16:18:56] [config] sync-sgd: false
[2023-07-27 16:18:56] [config] tempdir: /tmp
[2023-07-27 16:18:56] [config] tied-embeddings: false
[2023-07-27 16:18:56] [config] tied-embeddings-all: true
[2023-07-27 16:18:56] [config] tied-embeddings-src: false
[2023-07-27 16:18:56] [config] train-embedder-rank:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] train-sets:
[2023-07-27 16:18:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 16:18:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 16:18:56] [config] transformer-aan-activation: swish
[2023-07-27 16:18:56] [config] transformer-aan-depth: 2
[2023-07-27 16:18:56] [config] transformer-aan-nogate: false
[2023-07-27 16:18:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 16:18:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 16:18:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 16:18:56] [config] transformer-depth-scaling: false
[2023-07-27 16:18:56] [config] transformer-dim-aan: 2048
[2023-07-27 16:18:56] [config] transformer-dim-ffn: 2048
[2023-07-27 16:18:56] [config] transformer-dropout: 0
[2023-07-27 16:18:56] [config] transformer-dropout-attention: 0
[2023-07-27 16:18:56] [config] transformer-dropout-ffn: 0
[2023-07-27 16:18:56] [config] transformer-ffn-activation: swish
[2023-07-27 16:18:56] [config] transformer-ffn-depth: 2
[2023-07-27 16:18:56] [config] transformer-guided-alignment-layer: last
[2023-07-27 16:18:56] [config] transformer-heads: 8
[2023-07-27 16:18:56] [config] transformer-no-projection: false
[2023-07-27 16:18:56] [config] transformer-pool: false
[2023-07-27 16:18:56] [config] transformer-postprocess: dan
[2023-07-27 16:18:56] [config] transformer-postprocess-emb: d
[2023-07-27 16:18:56] [config] transformer-postprocess-top: ""
[2023-07-27 16:18:56] [config] transformer-preprocess: ""
[2023-07-27 16:18:56] [config] transformer-tied-layers:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] transformer-train-position-embeddings: false
[2023-07-27 16:18:56] [config] tsv: false
[2023-07-27 16:18:56] [config] tsv-fields: 0
[2023-07-27 16:18:56] [config] type: s2s
[2023-07-27 16:18:56] [config] ulr: false
[2023-07-27 16:18:56] [config] ulr-dim-emb: 0
[2023-07-27 16:18:56] [config] ulr-dropout: 0
[2023-07-27 16:18:56] [config] ulr-keys-vectors: ""
[2023-07-27 16:18:56] [config] ulr-query-vectors: ""
[2023-07-27 16:18:56] [config] ulr-softmax-temperature: 1
[2023-07-27 16:18:56] [config] ulr-trainable-transformation: false
[2023-07-27 16:18:56] [config] unlikelihood-loss: false
[2023-07-27 16:18:56] [config] valid-freq: 50000000
[2023-07-27 16:18:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 16:18:56] [config] valid-max-length: 1000
[2023-07-27 16:18:56] [config] valid-metrics:
[2023-07-27 16:18:56] [config]   - translation
[2023-07-27 16:18:56] [config] valid-mini-batch: 32
[2023-07-27 16:18:56] [config] valid-reset-stalled: false
[2023-07-27 16:18:56] [config] valid-script-args:
[2023-07-27 16:18:56] [config]   []
[2023-07-27 16:18:56] [config] valid-script-path: ""
[2023-07-27 16:18:56] [config] valid-sets:
[2023-07-27 16:18:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 16:18:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 16:18:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 16:18:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:18:56] [config] vocabs:
[2023-07-27 16:18:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 16:18:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 16:18:56] [config] word-penalty: 0
[2023-07-27 16:18:56] [config] word-scores: false
[2023-07-27 16:18:56] [config] workspace: 5500
[2023-07-27 16:18:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 16:18:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:18:56] [training] Using single-device training
[2023-07-27 16:18:56] Synced seed 1234
[2023-07-27 16:18:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 16:18:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 16:18:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 16:18:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 16:18:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 16:18:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 16:18:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 16:18:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 16:18:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 16:18:57] [comm] Using global sharding
[2023-07-27 16:18:57] [comm] NCCLCommunicators constructed successfully
[2023-07-27 16:18:57] [training] Using 1 GPUs
[2023-07-27 16:18:57] [logits] Applying loss function for 1 factor(s)
[2023-07-27 16:18:57] [memory] Reserving 80 MB, device gpu0
[2023-07-27 16:18:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 16:18:57] [memory] Reserving 80 MB, device gpu0
[2023-07-27 17:06:50] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 17:06:50] [valid] No post-processing script given for validating translator
[2023-07-27 17:06:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:06:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 17:06:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 17:06:50] [comm] Using global sharding
[2023-07-27 17:06:50] [comm] NCCLCommunicators constructed successfully
[2023-07-27 17:06:50] [training] Using 1 GPUs
[2023-07-27 17:06:50] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 17:06:52] Allocating memory for general optimizer shards
[2023-07-27 17:06:52] [memory] Reserving 322 MB, device gpu0
[2023-07-27 17:06:52] Loading Adam parameters
[2023-07-27 17:06:52] [memory] Reserving 322 MB, device gpu0
[2023-07-27 17:06:52] [memory] Reserving 80 MB, device gpu0
[2023-07-27 17:06:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 17:06:52] [data] Restoring the corpus state to epoch 41, batch 1555
[2023-07-27 17:06:52] [data] Shuffling data
[2023-07-27 17:06:52] [data] Done reading 20,192 sentences
[2023-07-27 17:06:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:06:52] Training started
[2023-07-27 17:06:52] Training finished
[2023-07-27 17:06:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:06:55] [marian] Running on node18.datos.cluster.uy as process 39225 with command line:
[2023-07-27 17:06:55] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 17:06:55] [config] after: 0e
[2023-07-27 17:06:55] [config] after-batches: 0
[2023-07-27 17:06:55] [config] after-epochs: 50
[2023-07-27 17:06:55] [config] all-caps-every: 0
[2023-07-27 17:06:55] [config] allow-unk: false
[2023-07-27 17:06:55] [config] authors: false
[2023-07-27 17:06:55] [config] beam-size: 12
[2023-07-27 17:06:55] [config] bert-class-symbol: "[CLS]"
[2023-07-27 17:06:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 17:06:55] [config] bert-masking-fraction: 0.15
[2023-07-27 17:06:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 17:06:55] [config] bert-train-type-embeddings: true
[2023-07-27 17:06:55] [config] bert-type-vocab-size: 2
[2023-07-27 17:06:55] [config] build-info: ""
[2023-07-27 17:06:55] [config] check-gradient-nan: false
[2023-07-27 17:06:55] [config] check-nan: false
[2023-07-27 17:06:55] [config] cite: false
[2023-07-27 17:06:55] [config] clip-norm: 1
[2023-07-27 17:06:55] [config] cost-scaling:
[2023-07-27 17:06:55] [config]   - 256.f
[2023-07-27 17:06:55] [config]   - 1000
[2023-07-27 17:06:55] [config]   - 2.f
[2023-07-27 17:06:55] [config]   - 256.f
[2023-07-27 17:06:55] [config] cost-type: ce-sum
[2023-07-27 17:06:55] [config] cpu-threads: 0
[2023-07-27 17:06:55] [config] data-threads: 8
[2023-07-27 17:06:55] [config] data-weighting: ""
[2023-07-27 17:06:55] [config] data-weighting-type: sentence
[2023-07-27 17:06:55] [config] dec-cell: gru
[2023-07-27 17:06:55] [config] dec-cell-base-depth: 2
[2023-07-27 17:06:55] [config] dec-cell-high-depth: 1
[2023-07-27 17:06:55] [config] dec-depth: 1
[2023-07-27 17:06:55] [config] devices:
[2023-07-27 17:06:55] [config]   - 0
[2023-07-27 17:06:55] [config] dim-emb: 512
[2023-07-27 17:06:55] [config] dim-rnn: 1024
[2023-07-27 17:06:55] [config] dim-vocabs:
[2023-07-27 17:06:55] [config]   - 16384
[2023-07-27 17:06:55] [config]   - 16384
[2023-07-27 17:06:55] [config] disp-first: 0
[2023-07-27 17:06:55] [config] disp-freq: 1000u
[2023-07-27 17:06:55] [config] disp-label-counts: true
[2023-07-27 17:06:55] [config] dropout-rnn: 0
[2023-07-27 17:06:55] [config] dropout-src: 0
[2023-07-27 17:06:55] [config] dropout-trg: 0
[2023-07-27 17:06:55] [config] dump-config: ""
[2023-07-27 17:06:55] [config] dynamic-gradient-scaling:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] early-stopping: 1000
[2023-07-27 17:06:55] [config] early-stopping-on: first
[2023-07-27 17:06:55] [config] embedding-fix-src: false
[2023-07-27 17:06:55] [config] embedding-fix-trg: false
[2023-07-27 17:06:55] [config] embedding-normalization: false
[2023-07-27 17:06:55] [config] embedding-vectors:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] enc-cell: gru
[2023-07-27 17:06:55] [config] enc-cell-depth: 1
[2023-07-27 17:06:55] [config] enc-depth: 1
[2023-07-27 17:06:55] [config] enc-type: bidirectional
[2023-07-27 17:06:55] [config] english-title-case-every: 0
[2023-07-27 17:06:55] [config] exponential-smoothing: 0
[2023-07-27 17:06:55] [config] factor-weight: 1
[2023-07-27 17:06:55] [config] factors-combine: sum
[2023-07-27 17:06:55] [config] factors-dim-emb: 0
[2023-07-27 17:06:55] [config] gradient-checkpointing: false
[2023-07-27 17:06:55] [config] gradient-norm-average-window: 100
[2023-07-27 17:06:55] [config] guided-alignment: none
[2023-07-27 17:06:55] [config] guided-alignment-cost: mse
[2023-07-27 17:06:55] [config] guided-alignment-weight: 0.1
[2023-07-27 17:06:55] [config] ignore-model-config: false
[2023-07-27 17:06:55] [config] input-types:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] interpolate-env-vars: false
[2023-07-27 17:06:55] [config] keep-best: false
[2023-07-27 17:06:55] [config] label-smoothing: 0
[2023-07-27 17:06:55] [config] layer-normalization: false
[2023-07-27 17:06:55] [config] learn-rate: 0.0001
[2023-07-27 17:06:55] [config] lemma-dependency: ""
[2023-07-27 17:06:55] [config] lemma-dim-emb: 0
[2023-07-27 17:06:55] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 17:06:55] [config] log-level: info
[2023-07-27 17:06:55] [config] log-time-zone: ""
[2023-07-27 17:06:55] [config] logical-epoch:
[2023-07-27 17:06:55] [config]   - 1e
[2023-07-27 17:06:55] [config]   - 0
[2023-07-27 17:06:55] [config] lr-decay: 0
[2023-07-27 17:06:55] [config] lr-decay-freq: 50000
[2023-07-27 17:06:55] [config] lr-decay-inv-sqrt:
[2023-07-27 17:06:55] [config]   - 0
[2023-07-27 17:06:55] [config] lr-decay-repeat-warmup: false
[2023-07-27 17:06:55] [config] lr-decay-reset-optimizer: false
[2023-07-27 17:06:55] [config] lr-decay-start:
[2023-07-27 17:06:55] [config]   - 10
[2023-07-27 17:06:55] [config]   - 1
[2023-07-27 17:06:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 17:06:55] [config] lr-report: false
[2023-07-27 17:06:55] [config] lr-warmup: 0
[2023-07-27 17:06:55] [config] lr-warmup-at-reload: false
[2023-07-27 17:06:55] [config] lr-warmup-cycle: false
[2023-07-27 17:06:55] [config] lr-warmup-start-rate: 0
[2023-07-27 17:06:55] [config] max-length: 250
[2023-07-27 17:06:55] [config] max-length-crop: true
[2023-07-27 17:06:55] [config] max-length-factor: 3
[2023-07-27 17:06:55] [config] maxi-batch: 100
[2023-07-27 17:06:55] [config] maxi-batch-sort: trg
[2023-07-27 17:06:55] [config] mini-batch: 64
[2023-07-27 17:06:55] [config] mini-batch-fit: true
[2023-07-27 17:06:55] [config] mini-batch-fit-step: 10
[2023-07-27 17:06:55] [config] mini-batch-round-up: true
[2023-07-27 17:06:55] [config] mini-batch-track-lr: false
[2023-07-27 17:06:55] [config] mini-batch-warmup: 0
[2023-07-27 17:06:55] [config] mini-batch-words: 0
[2023-07-27 17:06:55] [config] mini-batch-words-ref: 0
[2023-07-27 17:06:55] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 17:06:55] [config] multi-loss-type: sum
[2023-07-27 17:06:55] [config] n-best: false
[2023-07-27 17:06:55] [config] no-nccl: false
[2023-07-27 17:06:55] [config] no-reload: false
[2023-07-27 17:06:55] [config] no-restore-corpus: false
[2023-07-27 17:06:55] [config] normalize: 0
[2023-07-27 17:06:55] [config] normalize-gradient: false
[2023-07-27 17:06:55] [config] num-devices: 0
[2023-07-27 17:06:55] [config] optimizer: adam
[2023-07-27 17:06:55] [config] optimizer-delay: 1
[2023-07-27 17:06:55] [config] optimizer-params:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] output-omit-bias: false
[2023-07-27 17:06:55] [config] overwrite: true
[2023-07-27 17:06:55] [config] precision:
[2023-07-27 17:06:55] [config]   - float16
[2023-07-27 17:06:55] [config]   - float32
[2023-07-27 17:06:55] [config] pretrained-model: ""
[2023-07-27 17:06:55] [config] quantize-biases: false
[2023-07-27 17:06:55] [config] quantize-bits: 0
[2023-07-27 17:06:55] [config] quantize-log-based: false
[2023-07-27 17:06:55] [config] quantize-optimization-steps: 0
[2023-07-27 17:06:55] [config] quiet: false
[2023-07-27 17:06:55] [config] quiet-translation: true
[2023-07-27 17:06:55] [config] relative-paths: false
[2023-07-27 17:06:55] [config] right-left: false
[2023-07-27 17:06:55] [config] save-freq: 10000u
[2023-07-27 17:06:55] [config] seed: 1234
[2023-07-27 17:06:55] [config] sentencepiece-alphas:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] sentencepiece-max-lines: 2000000
[2023-07-27 17:06:55] [config] sentencepiece-options: ""
[2023-07-27 17:06:55] [config] sharding: global
[2023-07-27 17:06:55] [config] shuffle: data
[2023-07-27 17:06:55] [config] shuffle-in-ram: false
[2023-07-27 17:06:55] [config] sigterm: save-and-exit
[2023-07-27 17:06:55] [config] skip: false
[2023-07-27 17:06:55] [config] sqlite: ""
[2023-07-27 17:06:55] [config] sqlite-drop: false
[2023-07-27 17:06:55] [config] sync-freq: 200u
[2023-07-27 17:06:55] [config] sync-sgd: false
[2023-07-27 17:06:55] [config] tempdir: /tmp
[2023-07-27 17:06:55] [config] tied-embeddings: false
[2023-07-27 17:06:55] [config] tied-embeddings-all: true
[2023-07-27 17:06:55] [config] tied-embeddings-src: false
[2023-07-27 17:06:55] [config] train-embedder-rank:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] train-sets:
[2023-07-27 17:06:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 17:06:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 17:06:55] [config] transformer-aan-activation: swish
[2023-07-27 17:06:55] [config] transformer-aan-depth: 2
[2023-07-27 17:06:55] [config] transformer-aan-nogate: false
[2023-07-27 17:06:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 17:06:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 17:06:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 17:06:55] [config] transformer-depth-scaling: false
[2023-07-27 17:06:55] [config] transformer-dim-aan: 2048
[2023-07-27 17:06:55] [config] transformer-dim-ffn: 2048
[2023-07-27 17:06:55] [config] transformer-dropout: 0
[2023-07-27 17:06:55] [config] transformer-dropout-attention: 0
[2023-07-27 17:06:55] [config] transformer-dropout-ffn: 0
[2023-07-27 17:06:55] [config] transformer-ffn-activation: swish
[2023-07-27 17:06:55] [config] transformer-ffn-depth: 2
[2023-07-27 17:06:55] [config] transformer-guided-alignment-layer: last
[2023-07-27 17:06:55] [config] transformer-heads: 8
[2023-07-27 17:06:55] [config] transformer-no-projection: false
[2023-07-27 17:06:55] [config] transformer-pool: false
[2023-07-27 17:06:55] [config] transformer-postprocess: dan
[2023-07-27 17:06:55] [config] transformer-postprocess-emb: d
[2023-07-27 17:06:55] [config] transformer-postprocess-top: ""
[2023-07-27 17:06:55] [config] transformer-preprocess: ""
[2023-07-27 17:06:55] [config] transformer-tied-layers:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] transformer-train-position-embeddings: false
[2023-07-27 17:06:55] [config] tsv: false
[2023-07-27 17:06:55] [config] tsv-fields: 0
[2023-07-27 17:06:55] [config] type: s2s
[2023-07-27 17:06:55] [config] ulr: false
[2023-07-27 17:06:55] [config] ulr-dim-emb: 0
[2023-07-27 17:06:55] [config] ulr-dropout: 0
[2023-07-27 17:06:55] [config] ulr-keys-vectors: ""
[2023-07-27 17:06:55] [config] ulr-query-vectors: ""
[2023-07-27 17:06:55] [config] ulr-softmax-temperature: 1
[2023-07-27 17:06:55] [config] ulr-trainable-transformation: false
[2023-07-27 17:06:55] [config] unlikelihood-loss: false
[2023-07-27 17:06:55] [config] valid-freq: 50000000
[2023-07-27 17:06:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 17:06:55] [config] valid-max-length: 1000
[2023-07-27 17:06:55] [config] valid-metrics:
[2023-07-27 17:06:55] [config]   - translation
[2023-07-27 17:06:55] [config] valid-mini-batch: 32
[2023-07-27 17:06:55] [config] valid-reset-stalled: false
[2023-07-27 17:06:55] [config] valid-script-args:
[2023-07-27 17:06:55] [config]   []
[2023-07-27 17:06:55] [config] valid-script-path: ""
[2023-07-27 17:06:55] [config] valid-sets:
[2023-07-27 17:06:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 17:06:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 17:06:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 17:06:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:06:55] [config] vocabs:
[2023-07-27 17:06:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 17:06:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 17:06:55] [config] word-penalty: 0
[2023-07-27 17:06:55] [config] word-scores: false
[2023-07-27 17:06:55] [config] workspace: 5500
[2023-07-27 17:06:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 17:06:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:06:55] [training] Using single-device training
[2023-07-27 17:06:56] Synced seed 1234
[2023-07-27 17:06:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 17:06:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 17:06:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 17:06:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 17:06:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 17:06:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:06:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 17:06:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 17:06:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 17:06:57] [comm] Using global sharding
[2023-07-27 17:06:57] [comm] NCCLCommunicators constructed successfully
[2023-07-27 17:06:57] [training] Using 1 GPUs
[2023-07-27 17:06:57] [logits] Applying loss function for 1 factor(s)
[2023-07-27 17:06:57] [memory] Reserving 80 MB, device gpu0
[2023-07-27 17:06:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 17:06:58] [memory] Reserving 80 MB, device gpu0
[2023-07-27 17:56:27] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 17:56:27] [valid] No post-processing script given for validating translator
[2023-07-27 17:56:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 17:56:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 17:56:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 17:56:28] [comm] Using global sharding
[2023-07-27 17:56:28] [comm] NCCLCommunicators constructed successfully
[2023-07-27 17:56:28] [training] Using 1 GPUs
[2023-07-27 17:56:28] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 17:56:32] Allocating memory for general optimizer shards
[2023-07-27 17:56:32] [memory] Reserving 322 MB, device gpu0
[2023-07-27 17:56:32] Loading Adam parameters
[2023-07-27 17:56:32] [memory] Reserving 322 MB, device gpu0
[2023-07-27 17:56:32] [memory] Reserving 80 MB, device gpu0
[2023-07-27 17:56:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 17:56:33] [data] Restoring the corpus state to epoch 41, batch 1555
[2023-07-27 17:56:33] [data] Shuffling data
[2023-07-27 17:56:33] [data] Done reading 20,192 sentences
[2023-07-27 17:56:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 17:56:33] Training started
[2023-07-27 17:56:33] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 17:56:33] [memory] Reserving 80 MB, device gpu0
[2023-07-27 17:56:41] Parameter type float16, optimization type float32, casting types true
[2023-07-27 18:01:34] Seen 20,192 samples
[2023-07-27 18:01:34] Starting data epoch 42 in logical epoch 42
[2023-07-27 18:01:34] [data] Shuffling data
[2023-07-27 18:01:34] [data] Done reading 20,192 sentences
[2023-07-27 18:01:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:06:43] Seen 20,192 samples
[2023-07-27 18:06:43] Starting data epoch 43 in logical epoch 43
[2023-07-27 18:06:43] [data] Shuffling data
[2023-07-27 18:06:43] [data] Done reading 20,192 sentences
[2023-07-27 18:06:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:11:55] Seen 20,192 samples
[2023-07-27 18:11:55] Starting data epoch 44 in logical epoch 44
[2023-07-27 18:11:55] [data] Shuffling data
[2023-07-27 18:11:55] [data] Done reading 20,192 sentences
[2023-07-27 18:11:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:16:59] Seen 20,192 samples
[2023-07-27 18:16:59] Starting data epoch 45 in logical epoch 45
[2023-07-27 18:16:59] [data] Shuffling data
[2023-07-27 18:16:59] [data] Done reading 20,192 sentences
[2023-07-27 18:16:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:21:49] Seen 20,192 samples
[2023-07-27 18:21:49] Starting data epoch 46 in logical epoch 46
[2023-07-27 18:21:49] [data] Shuffling data
[2023-07-27 18:21:49] [data] Done reading 20,192 sentences
[2023-07-27 18:21:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:27:04] Seen 20,192 samples
[2023-07-27 18:27:04] Starting data epoch 47 in logical epoch 47
[2023-07-27 18:27:04] [data] Shuffling data
[2023-07-27 18:27:05] [data] Done reading 20,192 sentences
[2023-07-27 18:27:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:32:02] Seen 20,192 samples
[2023-07-27 18:32:02] Starting data epoch 48 in logical epoch 48
[2023-07-27 18:32:02] [data] Shuffling data
[2023-07-27 18:32:02] [data] Done reading 20,192 sentences
[2023-07-27 18:32:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:37:12] Seen 20,192 samples
[2023-07-27 18:37:12] Starting data epoch 49 in logical epoch 49
[2023-07-27 18:37:12] [data] Shuffling data
[2023-07-27 18:37:12] [data] Done reading 20,192 sentences
[2023-07-27 18:37:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:42:16] Seen 20,192 samples
[2023-07-27 18:42:16] Starting data epoch 50 in logical epoch 50
[2023-07-27 18:42:16] [data] Shuffling data
[2023-07-27 18:42:16] [data] Done reading 20,192 sentences
[2023-07-27 18:42:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 18:47:24] Seen 20,192 samples
[2023-07-27 18:47:24] Starting data epoch 51 in logical epoch 51
[2023-07-27 18:47:24] Training finished
[2023-07-27 18:50:09] [valid] Ep. 51 : Up. 1942 : translation : 0 : new best
[2023-07-27 18:50:09] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 18:50:10] Saving Adam parameters
[2023-07-27 18:50:11] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 18:50:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 18:50:18] [marian] Running on node18.datos.cluster.uy as process 5571 with command line:
[2023-07-27 18:50:18] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 18:50:18] [config] after: 0e
[2023-07-27 18:50:18] [config] after-batches: 0
[2023-07-27 18:50:18] [config] after-epochs: 60
[2023-07-27 18:50:18] [config] all-caps-every: 0
[2023-07-27 18:50:18] [config] allow-unk: false
[2023-07-27 18:50:18] [config] authors: false
[2023-07-27 18:50:18] [config] beam-size: 12
[2023-07-27 18:50:18] [config] bert-class-symbol: "[CLS]"
[2023-07-27 18:50:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 18:50:18] [config] bert-masking-fraction: 0.15
[2023-07-27 18:50:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 18:50:18] [config] bert-train-type-embeddings: true
[2023-07-27 18:50:18] [config] bert-type-vocab-size: 2
[2023-07-27 18:50:18] [config] build-info: ""
[2023-07-27 18:50:18] [config] check-gradient-nan: false
[2023-07-27 18:50:18] [config] check-nan: false
[2023-07-27 18:50:18] [config] cite: false
[2023-07-27 18:50:18] [config] clip-norm: 1
[2023-07-27 18:50:18] [config] cost-scaling:
[2023-07-27 18:50:18] [config]   - 256.f
[2023-07-27 18:50:18] [config]   - 1000
[2023-07-27 18:50:18] [config]   - 2.f
[2023-07-27 18:50:18] [config]   - 256.f
[2023-07-27 18:50:18] [config] cost-type: ce-sum
[2023-07-27 18:50:18] [config] cpu-threads: 0
[2023-07-27 18:50:18] [config] data-threads: 8
[2023-07-27 18:50:18] [config] data-weighting: ""
[2023-07-27 18:50:18] [config] data-weighting-type: sentence
[2023-07-27 18:50:18] [config] dec-cell: gru
[2023-07-27 18:50:18] [config] dec-cell-base-depth: 2
[2023-07-27 18:50:18] [config] dec-cell-high-depth: 1
[2023-07-27 18:50:18] [config] dec-depth: 1
[2023-07-27 18:50:18] [config] devices:
[2023-07-27 18:50:18] [config]   - 0
[2023-07-27 18:50:18] [config] dim-emb: 512
[2023-07-27 18:50:18] [config] dim-rnn: 1024
[2023-07-27 18:50:18] [config] dim-vocabs:
[2023-07-27 18:50:18] [config]   - 16384
[2023-07-27 18:50:18] [config]   - 16384
[2023-07-27 18:50:18] [config] disp-first: 0
[2023-07-27 18:50:18] [config] disp-freq: 1000u
[2023-07-27 18:50:18] [config] disp-label-counts: true
[2023-07-27 18:50:18] [config] dropout-rnn: 0
[2023-07-27 18:50:18] [config] dropout-src: 0
[2023-07-27 18:50:18] [config] dropout-trg: 0
[2023-07-27 18:50:18] [config] dump-config: ""
[2023-07-27 18:50:18] [config] dynamic-gradient-scaling:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] early-stopping: 1000
[2023-07-27 18:50:18] [config] early-stopping-on: first
[2023-07-27 18:50:18] [config] embedding-fix-src: false
[2023-07-27 18:50:18] [config] embedding-fix-trg: false
[2023-07-27 18:50:18] [config] embedding-normalization: false
[2023-07-27 18:50:18] [config] embedding-vectors:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] enc-cell: gru
[2023-07-27 18:50:18] [config] enc-cell-depth: 1
[2023-07-27 18:50:18] [config] enc-depth: 1
[2023-07-27 18:50:18] [config] enc-type: bidirectional
[2023-07-27 18:50:18] [config] english-title-case-every: 0
[2023-07-27 18:50:18] [config] exponential-smoothing: 0
[2023-07-27 18:50:18] [config] factor-weight: 1
[2023-07-27 18:50:18] [config] factors-combine: sum
[2023-07-27 18:50:18] [config] factors-dim-emb: 0
[2023-07-27 18:50:18] [config] gradient-checkpointing: false
[2023-07-27 18:50:18] [config] gradient-norm-average-window: 100
[2023-07-27 18:50:18] [config] guided-alignment: none
[2023-07-27 18:50:18] [config] guided-alignment-cost: mse
[2023-07-27 18:50:18] [config] guided-alignment-weight: 0.1
[2023-07-27 18:50:18] [config] ignore-model-config: false
[2023-07-27 18:50:18] [config] input-types:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] interpolate-env-vars: false
[2023-07-27 18:50:18] [config] keep-best: false
[2023-07-27 18:50:18] [config] label-smoothing: 0
[2023-07-27 18:50:18] [config] layer-normalization: false
[2023-07-27 18:50:18] [config] learn-rate: 0.0001
[2023-07-27 18:50:18] [config] lemma-dependency: ""
[2023-07-27 18:50:18] [config] lemma-dim-emb: 0
[2023-07-27 18:50:18] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 18:50:18] [config] log-level: info
[2023-07-27 18:50:18] [config] log-time-zone: ""
[2023-07-27 18:50:18] [config] logical-epoch:
[2023-07-27 18:50:18] [config]   - 1e
[2023-07-27 18:50:18] [config]   - 0
[2023-07-27 18:50:18] [config] lr-decay: 0
[2023-07-27 18:50:18] [config] lr-decay-freq: 50000
[2023-07-27 18:50:18] [config] lr-decay-inv-sqrt:
[2023-07-27 18:50:18] [config]   - 0
[2023-07-27 18:50:18] [config] lr-decay-repeat-warmup: false
[2023-07-27 18:50:18] [config] lr-decay-reset-optimizer: false
[2023-07-27 18:50:18] [config] lr-decay-start:
[2023-07-27 18:50:18] [config]   - 10
[2023-07-27 18:50:18] [config]   - 1
[2023-07-27 18:50:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 18:50:18] [config] lr-report: false
[2023-07-27 18:50:18] [config] lr-warmup: 0
[2023-07-27 18:50:18] [config] lr-warmup-at-reload: false
[2023-07-27 18:50:18] [config] lr-warmup-cycle: false
[2023-07-27 18:50:18] [config] lr-warmup-start-rate: 0
[2023-07-27 18:50:18] [config] max-length: 250
[2023-07-27 18:50:18] [config] max-length-crop: true
[2023-07-27 18:50:18] [config] max-length-factor: 3
[2023-07-27 18:50:18] [config] maxi-batch: 100
[2023-07-27 18:50:18] [config] maxi-batch-sort: trg
[2023-07-27 18:50:18] [config] mini-batch: 64
[2023-07-27 18:50:18] [config] mini-batch-fit: true
[2023-07-27 18:50:18] [config] mini-batch-fit-step: 10
[2023-07-27 18:50:18] [config] mini-batch-round-up: true
[2023-07-27 18:50:18] [config] mini-batch-track-lr: false
[2023-07-27 18:50:18] [config] mini-batch-warmup: 0
[2023-07-27 18:50:18] [config] mini-batch-words: 0
[2023-07-27 18:50:18] [config] mini-batch-words-ref: 0
[2023-07-27 18:50:18] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 18:50:18] [config] multi-loss-type: sum
[2023-07-27 18:50:18] [config] n-best: false
[2023-07-27 18:50:18] [config] no-nccl: false
[2023-07-27 18:50:18] [config] no-reload: false
[2023-07-27 18:50:18] [config] no-restore-corpus: false
[2023-07-27 18:50:18] [config] normalize: 0
[2023-07-27 18:50:18] [config] normalize-gradient: false
[2023-07-27 18:50:18] [config] num-devices: 0
[2023-07-27 18:50:18] [config] optimizer: adam
[2023-07-27 18:50:18] [config] optimizer-delay: 1
[2023-07-27 18:50:18] [config] optimizer-params:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] output-omit-bias: false
[2023-07-27 18:50:18] [config] overwrite: true
[2023-07-27 18:50:18] [config] precision:
[2023-07-27 18:50:18] [config]   - float16
[2023-07-27 18:50:18] [config]   - float32
[2023-07-27 18:50:18] [config] pretrained-model: ""
[2023-07-27 18:50:18] [config] quantize-biases: false
[2023-07-27 18:50:18] [config] quantize-bits: 0
[2023-07-27 18:50:18] [config] quantize-log-based: false
[2023-07-27 18:50:18] [config] quantize-optimization-steps: 0
[2023-07-27 18:50:18] [config] quiet: false
[2023-07-27 18:50:18] [config] quiet-translation: true
[2023-07-27 18:50:18] [config] relative-paths: false
[2023-07-27 18:50:18] [config] right-left: false
[2023-07-27 18:50:18] [config] save-freq: 10000u
[2023-07-27 18:50:18] [config] seed: 1234
[2023-07-27 18:50:18] [config] sentencepiece-alphas:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] sentencepiece-max-lines: 2000000
[2023-07-27 18:50:18] [config] sentencepiece-options: ""
[2023-07-27 18:50:18] [config] sharding: global
[2023-07-27 18:50:18] [config] shuffle: data
[2023-07-27 18:50:18] [config] shuffle-in-ram: false
[2023-07-27 18:50:18] [config] sigterm: save-and-exit
[2023-07-27 18:50:18] [config] skip: false
[2023-07-27 18:50:18] [config] sqlite: ""
[2023-07-27 18:50:18] [config] sqlite-drop: false
[2023-07-27 18:50:18] [config] sync-freq: 200u
[2023-07-27 18:50:18] [config] sync-sgd: false
[2023-07-27 18:50:18] [config] tempdir: /tmp
[2023-07-27 18:50:18] [config] tied-embeddings: false
[2023-07-27 18:50:18] [config] tied-embeddings-all: true
[2023-07-27 18:50:18] [config] tied-embeddings-src: false
[2023-07-27 18:50:18] [config] train-embedder-rank:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] train-sets:
[2023-07-27 18:50:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 18:50:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 18:50:18] [config] transformer-aan-activation: swish
[2023-07-27 18:50:18] [config] transformer-aan-depth: 2
[2023-07-27 18:50:18] [config] transformer-aan-nogate: false
[2023-07-27 18:50:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 18:50:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 18:50:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 18:50:18] [config] transformer-depth-scaling: false
[2023-07-27 18:50:18] [config] transformer-dim-aan: 2048
[2023-07-27 18:50:18] [config] transformer-dim-ffn: 2048
[2023-07-27 18:50:18] [config] transformer-dropout: 0
[2023-07-27 18:50:18] [config] transformer-dropout-attention: 0
[2023-07-27 18:50:18] [config] transformer-dropout-ffn: 0
[2023-07-27 18:50:18] [config] transformer-ffn-activation: swish
[2023-07-27 18:50:18] [config] transformer-ffn-depth: 2
[2023-07-27 18:50:18] [config] transformer-guided-alignment-layer: last
[2023-07-27 18:50:18] [config] transformer-heads: 8
[2023-07-27 18:50:18] [config] transformer-no-projection: false
[2023-07-27 18:50:18] [config] transformer-pool: false
[2023-07-27 18:50:18] [config] transformer-postprocess: dan
[2023-07-27 18:50:18] [config] transformer-postprocess-emb: d
[2023-07-27 18:50:18] [config] transformer-postprocess-top: ""
[2023-07-27 18:50:18] [config] transformer-preprocess: ""
[2023-07-27 18:50:18] [config] transformer-tied-layers:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] transformer-train-position-embeddings: false
[2023-07-27 18:50:18] [config] tsv: false
[2023-07-27 18:50:18] [config] tsv-fields: 0
[2023-07-27 18:50:18] [config] type: s2s
[2023-07-27 18:50:18] [config] ulr: false
[2023-07-27 18:50:18] [config] ulr-dim-emb: 0
[2023-07-27 18:50:18] [config] ulr-dropout: 0
[2023-07-27 18:50:18] [config] ulr-keys-vectors: ""
[2023-07-27 18:50:18] [config] ulr-query-vectors: ""
[2023-07-27 18:50:18] [config] ulr-softmax-temperature: 1
[2023-07-27 18:50:18] [config] ulr-trainable-transformation: false
[2023-07-27 18:50:18] [config] unlikelihood-loss: false
[2023-07-27 18:50:18] [config] valid-freq: 50000000
[2023-07-27 18:50:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 18:50:18] [config] valid-max-length: 1000
[2023-07-27 18:50:18] [config] valid-metrics:
[2023-07-27 18:50:18] [config]   - translation
[2023-07-27 18:50:18] [config] valid-mini-batch: 32
[2023-07-27 18:50:18] [config] valid-reset-stalled: false
[2023-07-27 18:50:18] [config] valid-script-args:
[2023-07-27 18:50:18] [config]   []
[2023-07-27 18:50:18] [config] valid-script-path: ""
[2023-07-27 18:50:18] [config] valid-sets:
[2023-07-27 18:50:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 18:50:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 18:50:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 18:50:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 18:50:18] [config] vocabs:
[2023-07-27 18:50:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 18:50:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 18:50:18] [config] word-penalty: 0
[2023-07-27 18:50:18] [config] word-scores: false
[2023-07-27 18:50:18] [config] workspace: 5500
[2023-07-27 18:50:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 18:50:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 18:50:18] [training] Using single-device training
[2023-07-27 18:50:18] Synced seed 1234
[2023-07-27 18:50:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 18:50:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 18:50:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 18:50:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 18:50:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 18:50:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 18:50:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 18:50:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 18:50:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 18:50:19] [comm] Using global sharding
[2023-07-27 18:50:19] [comm] NCCLCommunicators constructed successfully
[2023-07-27 18:50:19] [training] Using 1 GPUs
[2023-07-27 18:50:19] [logits] Applying loss function for 1 factor(s)
[2023-07-27 18:50:19] [memory] Reserving 80 MB, device gpu0
[2023-07-27 18:50:19] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 18:50:20] [memory] Reserving 80 MB, device gpu0
[2023-07-27 19:39:09] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 19:39:09] [valid] No post-processing script given for validating translator
[2023-07-27 19:39:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:39:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 19:39:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 19:39:09] [comm] Using global sharding
[2023-07-27 19:39:09] [comm] NCCLCommunicators constructed successfully
[2023-07-27 19:39:09] [training] Using 1 GPUs
[2023-07-27 19:39:09] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 19:39:10] Allocating memory for general optimizer shards
[2023-07-27 19:39:10] [memory] Reserving 322 MB, device gpu0
[2023-07-27 19:39:10] Loading Adam parameters
[2023-07-27 19:39:10] [memory] Reserving 322 MB, device gpu0
[2023-07-27 19:39:10] [memory] Reserving 80 MB, device gpu0
[2023-07-27 19:39:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 19:39:11] [data] Restoring the corpus state to epoch 61, batch 2328
[2023-07-27 19:39:11] [data] Shuffling data
[2023-07-27 19:39:11] [data] Done reading 20,192 sentences
[2023-07-27 19:39:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 19:39:11] Training started
[2023-07-27 19:39:11] Training finished
[2023-07-27 19:39:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:39:14] [marian] Running on node18.datos.cluster.uy as process 8552 with command line:
[2023-07-27 19:39:14] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 19:39:14] [config] after: 0e
[2023-07-27 19:39:14] [config] after-batches: 0
[2023-07-27 19:39:14] [config] after-epochs: 70
[2023-07-27 19:39:14] [config] all-caps-every: 0
[2023-07-27 19:39:14] [config] allow-unk: false
[2023-07-27 19:39:14] [config] authors: false
[2023-07-27 19:39:14] [config] beam-size: 12
[2023-07-27 19:39:14] [config] bert-class-symbol: "[CLS]"
[2023-07-27 19:39:14] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 19:39:14] [config] bert-masking-fraction: 0.15
[2023-07-27 19:39:14] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 19:39:14] [config] bert-train-type-embeddings: true
[2023-07-27 19:39:14] [config] bert-type-vocab-size: 2
[2023-07-27 19:39:14] [config] build-info: ""
[2023-07-27 19:39:14] [config] check-gradient-nan: false
[2023-07-27 19:39:14] [config] check-nan: false
[2023-07-27 19:39:14] [config] cite: false
[2023-07-27 19:39:14] [config] clip-norm: 1
[2023-07-27 19:39:14] [config] cost-scaling:
[2023-07-27 19:39:14] [config]   - 256.f
[2023-07-27 19:39:14] [config]   - 1000
[2023-07-27 19:39:14] [config]   - 2.f
[2023-07-27 19:39:14] [config]   - 256.f
[2023-07-27 19:39:14] [config] cost-type: ce-sum
[2023-07-27 19:39:14] [config] cpu-threads: 0
[2023-07-27 19:39:14] [config] data-threads: 8
[2023-07-27 19:39:14] [config] data-weighting: ""
[2023-07-27 19:39:14] [config] data-weighting-type: sentence
[2023-07-27 19:39:14] [config] dec-cell: gru
[2023-07-27 19:39:14] [config] dec-cell-base-depth: 2
[2023-07-27 19:39:14] [config] dec-cell-high-depth: 1
[2023-07-27 19:39:14] [config] dec-depth: 1
[2023-07-27 19:39:14] [config] devices:
[2023-07-27 19:39:14] [config]   - 0
[2023-07-27 19:39:14] [config] dim-emb: 512
[2023-07-27 19:39:14] [config] dim-rnn: 1024
[2023-07-27 19:39:14] [config] dim-vocabs:
[2023-07-27 19:39:14] [config]   - 16384
[2023-07-27 19:39:14] [config]   - 16384
[2023-07-27 19:39:14] [config] disp-first: 0
[2023-07-27 19:39:14] [config] disp-freq: 1000u
[2023-07-27 19:39:14] [config] disp-label-counts: true
[2023-07-27 19:39:14] [config] dropout-rnn: 0
[2023-07-27 19:39:14] [config] dropout-src: 0
[2023-07-27 19:39:14] [config] dropout-trg: 0
[2023-07-27 19:39:14] [config] dump-config: ""
[2023-07-27 19:39:14] [config] dynamic-gradient-scaling:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] early-stopping: 1000
[2023-07-27 19:39:14] [config] early-stopping-on: first
[2023-07-27 19:39:14] [config] embedding-fix-src: false
[2023-07-27 19:39:14] [config] embedding-fix-trg: false
[2023-07-27 19:39:14] [config] embedding-normalization: false
[2023-07-27 19:39:14] [config] embedding-vectors:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] enc-cell: gru
[2023-07-27 19:39:14] [config] enc-cell-depth: 1
[2023-07-27 19:39:14] [config] enc-depth: 1
[2023-07-27 19:39:14] [config] enc-type: bidirectional
[2023-07-27 19:39:14] [config] english-title-case-every: 0
[2023-07-27 19:39:14] [config] exponential-smoothing: 0
[2023-07-27 19:39:14] [config] factor-weight: 1
[2023-07-27 19:39:14] [config] factors-combine: sum
[2023-07-27 19:39:14] [config] factors-dim-emb: 0
[2023-07-27 19:39:14] [config] gradient-checkpointing: false
[2023-07-27 19:39:14] [config] gradient-norm-average-window: 100
[2023-07-27 19:39:14] [config] guided-alignment: none
[2023-07-27 19:39:14] [config] guided-alignment-cost: mse
[2023-07-27 19:39:14] [config] guided-alignment-weight: 0.1
[2023-07-27 19:39:14] [config] ignore-model-config: false
[2023-07-27 19:39:14] [config] input-types:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] interpolate-env-vars: false
[2023-07-27 19:39:14] [config] keep-best: false
[2023-07-27 19:39:14] [config] label-smoothing: 0
[2023-07-27 19:39:14] [config] layer-normalization: false
[2023-07-27 19:39:14] [config] learn-rate: 0.0001
[2023-07-27 19:39:14] [config] lemma-dependency: ""
[2023-07-27 19:39:14] [config] lemma-dim-emb: 0
[2023-07-27 19:39:14] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 19:39:14] [config] log-level: info
[2023-07-27 19:39:14] [config] log-time-zone: ""
[2023-07-27 19:39:14] [config] logical-epoch:
[2023-07-27 19:39:14] [config]   - 1e
[2023-07-27 19:39:14] [config]   - 0
[2023-07-27 19:39:14] [config] lr-decay: 0
[2023-07-27 19:39:14] [config] lr-decay-freq: 50000
[2023-07-27 19:39:14] [config] lr-decay-inv-sqrt:
[2023-07-27 19:39:14] [config]   - 0
[2023-07-27 19:39:14] [config] lr-decay-repeat-warmup: false
[2023-07-27 19:39:14] [config] lr-decay-reset-optimizer: false
[2023-07-27 19:39:14] [config] lr-decay-start:
[2023-07-27 19:39:14] [config]   - 10
[2023-07-27 19:39:14] [config]   - 1
[2023-07-27 19:39:14] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 19:39:14] [config] lr-report: false
[2023-07-27 19:39:14] [config] lr-warmup: 0
[2023-07-27 19:39:14] [config] lr-warmup-at-reload: false
[2023-07-27 19:39:14] [config] lr-warmup-cycle: false
[2023-07-27 19:39:14] [config] lr-warmup-start-rate: 0
[2023-07-27 19:39:14] [config] max-length: 250
[2023-07-27 19:39:14] [config] max-length-crop: true
[2023-07-27 19:39:14] [config] max-length-factor: 3
[2023-07-27 19:39:14] [config] maxi-batch: 100
[2023-07-27 19:39:14] [config] maxi-batch-sort: trg
[2023-07-27 19:39:14] [config] mini-batch: 64
[2023-07-27 19:39:14] [config] mini-batch-fit: true
[2023-07-27 19:39:14] [config] mini-batch-fit-step: 10
[2023-07-27 19:39:14] [config] mini-batch-round-up: true
[2023-07-27 19:39:14] [config] mini-batch-track-lr: false
[2023-07-27 19:39:14] [config] mini-batch-warmup: 0
[2023-07-27 19:39:14] [config] mini-batch-words: 0
[2023-07-27 19:39:14] [config] mini-batch-words-ref: 0
[2023-07-27 19:39:14] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 19:39:14] [config] multi-loss-type: sum
[2023-07-27 19:39:14] [config] n-best: false
[2023-07-27 19:39:14] [config] no-nccl: false
[2023-07-27 19:39:14] [config] no-reload: false
[2023-07-27 19:39:14] [config] no-restore-corpus: false
[2023-07-27 19:39:14] [config] normalize: 0
[2023-07-27 19:39:14] [config] normalize-gradient: false
[2023-07-27 19:39:14] [config] num-devices: 0
[2023-07-27 19:39:14] [config] optimizer: adam
[2023-07-27 19:39:14] [config] optimizer-delay: 1
[2023-07-27 19:39:14] [config] optimizer-params:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] output-omit-bias: false
[2023-07-27 19:39:14] [config] overwrite: true
[2023-07-27 19:39:14] [config] precision:
[2023-07-27 19:39:14] [config]   - float16
[2023-07-27 19:39:14] [config]   - float32
[2023-07-27 19:39:14] [config] pretrained-model: ""
[2023-07-27 19:39:14] [config] quantize-biases: false
[2023-07-27 19:39:14] [config] quantize-bits: 0
[2023-07-27 19:39:14] [config] quantize-log-based: false
[2023-07-27 19:39:14] [config] quantize-optimization-steps: 0
[2023-07-27 19:39:14] [config] quiet: false
[2023-07-27 19:39:14] [config] quiet-translation: true
[2023-07-27 19:39:14] [config] relative-paths: false
[2023-07-27 19:39:14] [config] right-left: false
[2023-07-27 19:39:14] [config] save-freq: 10000u
[2023-07-27 19:39:14] [config] seed: 1234
[2023-07-27 19:39:14] [config] sentencepiece-alphas:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] sentencepiece-max-lines: 2000000
[2023-07-27 19:39:14] [config] sentencepiece-options: ""
[2023-07-27 19:39:14] [config] sharding: global
[2023-07-27 19:39:14] [config] shuffle: data
[2023-07-27 19:39:14] [config] shuffle-in-ram: false
[2023-07-27 19:39:14] [config] sigterm: save-and-exit
[2023-07-27 19:39:14] [config] skip: false
[2023-07-27 19:39:14] [config] sqlite: ""
[2023-07-27 19:39:14] [config] sqlite-drop: false
[2023-07-27 19:39:14] [config] sync-freq: 200u
[2023-07-27 19:39:14] [config] sync-sgd: false
[2023-07-27 19:39:14] [config] tempdir: /tmp
[2023-07-27 19:39:14] [config] tied-embeddings: false
[2023-07-27 19:39:14] [config] tied-embeddings-all: true
[2023-07-27 19:39:14] [config] tied-embeddings-src: false
[2023-07-27 19:39:14] [config] train-embedder-rank:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] train-sets:
[2023-07-27 19:39:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 19:39:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 19:39:14] [config] transformer-aan-activation: swish
[2023-07-27 19:39:14] [config] transformer-aan-depth: 2
[2023-07-27 19:39:14] [config] transformer-aan-nogate: false
[2023-07-27 19:39:14] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 19:39:14] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 19:39:14] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 19:39:14] [config] transformer-depth-scaling: false
[2023-07-27 19:39:14] [config] transformer-dim-aan: 2048
[2023-07-27 19:39:14] [config] transformer-dim-ffn: 2048
[2023-07-27 19:39:14] [config] transformer-dropout: 0
[2023-07-27 19:39:14] [config] transformer-dropout-attention: 0
[2023-07-27 19:39:14] [config] transformer-dropout-ffn: 0
[2023-07-27 19:39:14] [config] transformer-ffn-activation: swish
[2023-07-27 19:39:14] [config] transformer-ffn-depth: 2
[2023-07-27 19:39:14] [config] transformer-guided-alignment-layer: last
[2023-07-27 19:39:14] [config] transformer-heads: 8
[2023-07-27 19:39:14] [config] transformer-no-projection: false
[2023-07-27 19:39:14] [config] transformer-pool: false
[2023-07-27 19:39:14] [config] transformer-postprocess: dan
[2023-07-27 19:39:14] [config] transformer-postprocess-emb: d
[2023-07-27 19:39:14] [config] transformer-postprocess-top: ""
[2023-07-27 19:39:14] [config] transformer-preprocess: ""
[2023-07-27 19:39:14] [config] transformer-tied-layers:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] transformer-train-position-embeddings: false
[2023-07-27 19:39:14] [config] tsv: false
[2023-07-27 19:39:14] [config] tsv-fields: 0
[2023-07-27 19:39:14] [config] type: s2s
[2023-07-27 19:39:14] [config] ulr: false
[2023-07-27 19:39:14] [config] ulr-dim-emb: 0
[2023-07-27 19:39:14] [config] ulr-dropout: 0
[2023-07-27 19:39:14] [config] ulr-keys-vectors: ""
[2023-07-27 19:39:14] [config] ulr-query-vectors: ""
[2023-07-27 19:39:14] [config] ulr-softmax-temperature: 1
[2023-07-27 19:39:14] [config] ulr-trainable-transformation: false
[2023-07-27 19:39:14] [config] unlikelihood-loss: false
[2023-07-27 19:39:14] [config] valid-freq: 50000000
[2023-07-27 19:39:14] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 19:39:14] [config] valid-max-length: 1000
[2023-07-27 19:39:14] [config] valid-metrics:
[2023-07-27 19:39:14] [config]   - translation
[2023-07-27 19:39:14] [config] valid-mini-batch: 32
[2023-07-27 19:39:14] [config] valid-reset-stalled: false
[2023-07-27 19:39:14] [config] valid-script-args:
[2023-07-27 19:39:14] [config]   []
[2023-07-27 19:39:14] [config] valid-script-path: ""
[2023-07-27 19:39:14] [config] valid-sets:
[2023-07-27 19:39:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 19:39:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 19:39:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 19:39:14] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:39:14] [config] vocabs:
[2023-07-27 19:39:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 19:39:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 19:39:14] [config] word-penalty: 0
[2023-07-27 19:39:14] [config] word-scores: false
[2023-07-27 19:39:14] [config] workspace: 5500
[2023-07-27 19:39:14] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 19:39:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:39:14] [training] Using single-device training
[2023-07-27 19:39:15] Synced seed 1234
[2023-07-27 19:39:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 19:39:15] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 19:39:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 19:39:15] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 19:39:15] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 19:39:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 19:39:15] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 19:39:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 19:39:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 19:39:15] [comm] Using global sharding
[2023-07-27 19:39:15] [comm] NCCLCommunicators constructed successfully
[2023-07-27 19:39:15] [training] Using 1 GPUs
[2023-07-27 19:39:15] [logits] Applying loss function for 1 factor(s)
[2023-07-27 19:39:15] [memory] Reserving 80 MB, device gpu0
[2023-07-27 19:39:16] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 19:39:16] [memory] Reserving 80 MB, device gpu0
[2023-07-27 20:27:20] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 20:27:20] [valid] No post-processing script given for validating translator
[2023-07-27 20:27:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:27:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 20:27:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 20:27:20] [comm] Using global sharding
[2023-07-27 20:27:20] [comm] NCCLCommunicators constructed successfully
[2023-07-27 20:27:20] [training] Using 1 GPUs
[2023-07-27 20:27:20] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 20:27:23] Allocating memory for general optimizer shards
[2023-07-27 20:27:23] [memory] Reserving 322 MB, device gpu0
[2023-07-27 20:27:23] Loading Adam parameters
[2023-07-27 20:27:23] [memory] Reserving 322 MB, device gpu0
[2023-07-27 20:27:23] [memory] Reserving 80 MB, device gpu0
[2023-07-27 20:27:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 20:27:23] [data] Restoring the corpus state to epoch 71, batch 2712
[2023-07-27 20:27:23] [data] Shuffling data
[2023-07-27 20:27:23] [data] Done reading 20,192 sentences
[2023-07-27 20:27:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 20:27:23] Training started
[2023-07-27 20:27:23] Training finished
[2023-07-27 20:27:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:27:27] [marian] Running on node18.datos.cluster.uy as process 11831 with command line:
[2023-07-27 20:27:27] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 20:27:27] [config] after: 0e
[2023-07-27 20:27:27] [config] after-batches: 0
[2023-07-27 20:27:27] [config] after-epochs: 80
[2023-07-27 20:27:27] [config] all-caps-every: 0
[2023-07-27 20:27:27] [config] allow-unk: false
[2023-07-27 20:27:27] [config] authors: false
[2023-07-27 20:27:27] [config] beam-size: 12
[2023-07-27 20:27:27] [config] bert-class-symbol: "[CLS]"
[2023-07-27 20:27:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 20:27:27] [config] bert-masking-fraction: 0.15
[2023-07-27 20:27:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 20:27:27] [config] bert-train-type-embeddings: true
[2023-07-27 20:27:27] [config] bert-type-vocab-size: 2
[2023-07-27 20:27:27] [config] build-info: ""
[2023-07-27 20:27:27] [config] check-gradient-nan: false
[2023-07-27 20:27:27] [config] check-nan: false
[2023-07-27 20:27:27] [config] cite: false
[2023-07-27 20:27:27] [config] clip-norm: 1
[2023-07-27 20:27:27] [config] cost-scaling:
[2023-07-27 20:27:27] [config]   - 256.f
[2023-07-27 20:27:27] [config]   - 1000
[2023-07-27 20:27:27] [config]   - 2.f
[2023-07-27 20:27:27] [config]   - 256.f
[2023-07-27 20:27:27] [config] cost-type: ce-sum
[2023-07-27 20:27:27] [config] cpu-threads: 0
[2023-07-27 20:27:27] [config] data-threads: 8
[2023-07-27 20:27:27] [config] data-weighting: ""
[2023-07-27 20:27:27] [config] data-weighting-type: sentence
[2023-07-27 20:27:27] [config] dec-cell: gru
[2023-07-27 20:27:27] [config] dec-cell-base-depth: 2
[2023-07-27 20:27:27] [config] dec-cell-high-depth: 1
[2023-07-27 20:27:27] [config] dec-depth: 1
[2023-07-27 20:27:27] [config] devices:
[2023-07-27 20:27:27] [config]   - 0
[2023-07-27 20:27:27] [config] dim-emb: 512
[2023-07-27 20:27:27] [config] dim-rnn: 1024
[2023-07-27 20:27:27] [config] dim-vocabs:
[2023-07-27 20:27:27] [config]   - 16384
[2023-07-27 20:27:27] [config]   - 16384
[2023-07-27 20:27:27] [config] disp-first: 0
[2023-07-27 20:27:27] [config] disp-freq: 1000u
[2023-07-27 20:27:27] [config] disp-label-counts: true
[2023-07-27 20:27:27] [config] dropout-rnn: 0
[2023-07-27 20:27:27] [config] dropout-src: 0
[2023-07-27 20:27:27] [config] dropout-trg: 0
[2023-07-27 20:27:27] [config] dump-config: ""
[2023-07-27 20:27:27] [config] dynamic-gradient-scaling:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] early-stopping: 1000
[2023-07-27 20:27:27] [config] early-stopping-on: first
[2023-07-27 20:27:27] [config] embedding-fix-src: false
[2023-07-27 20:27:27] [config] embedding-fix-trg: false
[2023-07-27 20:27:27] [config] embedding-normalization: false
[2023-07-27 20:27:27] [config] embedding-vectors:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] enc-cell: gru
[2023-07-27 20:27:27] [config] enc-cell-depth: 1
[2023-07-27 20:27:27] [config] enc-depth: 1
[2023-07-27 20:27:27] [config] enc-type: bidirectional
[2023-07-27 20:27:27] [config] english-title-case-every: 0
[2023-07-27 20:27:27] [config] exponential-smoothing: 0
[2023-07-27 20:27:27] [config] factor-weight: 1
[2023-07-27 20:27:27] [config] factors-combine: sum
[2023-07-27 20:27:27] [config] factors-dim-emb: 0
[2023-07-27 20:27:27] [config] gradient-checkpointing: false
[2023-07-27 20:27:27] [config] gradient-norm-average-window: 100
[2023-07-27 20:27:27] [config] guided-alignment: none
[2023-07-27 20:27:27] [config] guided-alignment-cost: mse
[2023-07-27 20:27:27] [config] guided-alignment-weight: 0.1
[2023-07-27 20:27:27] [config] ignore-model-config: false
[2023-07-27 20:27:27] [config] input-types:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] interpolate-env-vars: false
[2023-07-27 20:27:27] [config] keep-best: false
[2023-07-27 20:27:27] [config] label-smoothing: 0
[2023-07-27 20:27:27] [config] layer-normalization: false
[2023-07-27 20:27:27] [config] learn-rate: 0.0001
[2023-07-27 20:27:27] [config] lemma-dependency: ""
[2023-07-27 20:27:27] [config] lemma-dim-emb: 0
[2023-07-27 20:27:27] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 20:27:27] [config] log-level: info
[2023-07-27 20:27:27] [config] log-time-zone: ""
[2023-07-27 20:27:27] [config] logical-epoch:
[2023-07-27 20:27:27] [config]   - 1e
[2023-07-27 20:27:27] [config]   - 0
[2023-07-27 20:27:27] [config] lr-decay: 0
[2023-07-27 20:27:27] [config] lr-decay-freq: 50000
[2023-07-27 20:27:27] [config] lr-decay-inv-sqrt:
[2023-07-27 20:27:27] [config]   - 0
[2023-07-27 20:27:27] [config] lr-decay-repeat-warmup: false
[2023-07-27 20:27:27] [config] lr-decay-reset-optimizer: false
[2023-07-27 20:27:27] [config] lr-decay-start:
[2023-07-27 20:27:27] [config]   - 10
[2023-07-27 20:27:27] [config]   - 1
[2023-07-27 20:27:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 20:27:27] [config] lr-report: false
[2023-07-27 20:27:27] [config] lr-warmup: 0
[2023-07-27 20:27:27] [config] lr-warmup-at-reload: false
[2023-07-27 20:27:27] [config] lr-warmup-cycle: false
[2023-07-27 20:27:27] [config] lr-warmup-start-rate: 0
[2023-07-27 20:27:27] [config] max-length: 250
[2023-07-27 20:27:27] [config] max-length-crop: true
[2023-07-27 20:27:27] [config] max-length-factor: 3
[2023-07-27 20:27:27] [config] maxi-batch: 100
[2023-07-27 20:27:27] [config] maxi-batch-sort: trg
[2023-07-27 20:27:27] [config] mini-batch: 64
[2023-07-27 20:27:27] [config] mini-batch-fit: true
[2023-07-27 20:27:27] [config] mini-batch-fit-step: 10
[2023-07-27 20:27:27] [config] mini-batch-round-up: true
[2023-07-27 20:27:27] [config] mini-batch-track-lr: false
[2023-07-27 20:27:27] [config] mini-batch-warmup: 0
[2023-07-27 20:27:27] [config] mini-batch-words: 0
[2023-07-27 20:27:27] [config] mini-batch-words-ref: 0
[2023-07-27 20:27:27] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 20:27:27] [config] multi-loss-type: sum
[2023-07-27 20:27:27] [config] n-best: false
[2023-07-27 20:27:27] [config] no-nccl: false
[2023-07-27 20:27:27] [config] no-reload: false
[2023-07-27 20:27:27] [config] no-restore-corpus: false
[2023-07-27 20:27:27] [config] normalize: 0
[2023-07-27 20:27:27] [config] normalize-gradient: false
[2023-07-27 20:27:27] [config] num-devices: 0
[2023-07-27 20:27:27] [config] optimizer: adam
[2023-07-27 20:27:27] [config] optimizer-delay: 1
[2023-07-27 20:27:27] [config] optimizer-params:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] output-omit-bias: false
[2023-07-27 20:27:27] [config] overwrite: true
[2023-07-27 20:27:27] [config] precision:
[2023-07-27 20:27:27] [config]   - float16
[2023-07-27 20:27:27] [config]   - float32
[2023-07-27 20:27:27] [config] pretrained-model: ""
[2023-07-27 20:27:27] [config] quantize-biases: false
[2023-07-27 20:27:27] [config] quantize-bits: 0
[2023-07-27 20:27:27] [config] quantize-log-based: false
[2023-07-27 20:27:27] [config] quantize-optimization-steps: 0
[2023-07-27 20:27:27] [config] quiet: false
[2023-07-27 20:27:27] [config] quiet-translation: true
[2023-07-27 20:27:27] [config] relative-paths: false
[2023-07-27 20:27:27] [config] right-left: false
[2023-07-27 20:27:27] [config] save-freq: 10000u
[2023-07-27 20:27:27] [config] seed: 1234
[2023-07-27 20:27:27] [config] sentencepiece-alphas:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] sentencepiece-max-lines: 2000000
[2023-07-27 20:27:27] [config] sentencepiece-options: ""
[2023-07-27 20:27:27] [config] sharding: global
[2023-07-27 20:27:27] [config] shuffle: data
[2023-07-27 20:27:27] [config] shuffle-in-ram: false
[2023-07-27 20:27:27] [config] sigterm: save-and-exit
[2023-07-27 20:27:27] [config] skip: false
[2023-07-27 20:27:27] [config] sqlite: ""
[2023-07-27 20:27:27] [config] sqlite-drop: false
[2023-07-27 20:27:27] [config] sync-freq: 200u
[2023-07-27 20:27:27] [config] sync-sgd: false
[2023-07-27 20:27:27] [config] tempdir: /tmp
[2023-07-27 20:27:27] [config] tied-embeddings: false
[2023-07-27 20:27:27] [config] tied-embeddings-all: true
[2023-07-27 20:27:27] [config] tied-embeddings-src: false
[2023-07-27 20:27:27] [config] train-embedder-rank:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] train-sets:
[2023-07-27 20:27:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 20:27:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 20:27:27] [config] transformer-aan-activation: swish
[2023-07-27 20:27:27] [config] transformer-aan-depth: 2
[2023-07-27 20:27:27] [config] transformer-aan-nogate: false
[2023-07-27 20:27:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 20:27:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 20:27:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 20:27:27] [config] transformer-depth-scaling: false
[2023-07-27 20:27:27] [config] transformer-dim-aan: 2048
[2023-07-27 20:27:27] [config] transformer-dim-ffn: 2048
[2023-07-27 20:27:27] [config] transformer-dropout: 0
[2023-07-27 20:27:27] [config] transformer-dropout-attention: 0
[2023-07-27 20:27:27] [config] transformer-dropout-ffn: 0
[2023-07-27 20:27:27] [config] transformer-ffn-activation: swish
[2023-07-27 20:27:27] [config] transformer-ffn-depth: 2
[2023-07-27 20:27:27] [config] transformer-guided-alignment-layer: last
[2023-07-27 20:27:27] [config] transformer-heads: 8
[2023-07-27 20:27:27] [config] transformer-no-projection: false
[2023-07-27 20:27:27] [config] transformer-pool: false
[2023-07-27 20:27:27] [config] transformer-postprocess: dan
[2023-07-27 20:27:27] [config] transformer-postprocess-emb: d
[2023-07-27 20:27:27] [config] transformer-postprocess-top: ""
[2023-07-27 20:27:27] [config] transformer-preprocess: ""
[2023-07-27 20:27:27] [config] transformer-tied-layers:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] transformer-train-position-embeddings: false
[2023-07-27 20:27:27] [config] tsv: false
[2023-07-27 20:27:27] [config] tsv-fields: 0
[2023-07-27 20:27:27] [config] type: s2s
[2023-07-27 20:27:27] [config] ulr: false
[2023-07-27 20:27:27] [config] ulr-dim-emb: 0
[2023-07-27 20:27:27] [config] ulr-dropout: 0
[2023-07-27 20:27:27] [config] ulr-keys-vectors: ""
[2023-07-27 20:27:27] [config] ulr-query-vectors: ""
[2023-07-27 20:27:27] [config] ulr-softmax-temperature: 1
[2023-07-27 20:27:27] [config] ulr-trainable-transformation: false
[2023-07-27 20:27:27] [config] unlikelihood-loss: false
[2023-07-27 20:27:27] [config] valid-freq: 50000000
[2023-07-27 20:27:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 20:27:27] [config] valid-max-length: 1000
[2023-07-27 20:27:27] [config] valid-metrics:
[2023-07-27 20:27:27] [config]   - translation
[2023-07-27 20:27:27] [config] valid-mini-batch: 32
[2023-07-27 20:27:27] [config] valid-reset-stalled: false
[2023-07-27 20:27:27] [config] valid-script-args:
[2023-07-27 20:27:27] [config]   []
[2023-07-27 20:27:27] [config] valid-script-path: ""
[2023-07-27 20:27:27] [config] valid-sets:
[2023-07-27 20:27:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 20:27:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 20:27:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 20:27:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:27:27] [config] vocabs:
[2023-07-27 20:27:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 20:27:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 20:27:27] [config] word-penalty: 0
[2023-07-27 20:27:27] [config] word-scores: false
[2023-07-27 20:27:27] [config] workspace: 5500
[2023-07-27 20:27:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 20:27:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:27:27] [training] Using single-device training
[2023-07-27 20:27:27] Synced seed 1234
[2023-07-27 20:27:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 20:27:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 20:27:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 20:27:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 20:27:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 20:27:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 20:27:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 20:27:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 20:27:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 20:27:28] [comm] Using global sharding
[2023-07-27 20:27:28] [comm] NCCLCommunicators constructed successfully
[2023-07-27 20:27:28] [training] Using 1 GPUs
[2023-07-27 20:27:28] [logits] Applying loss function for 1 factor(s)
[2023-07-27 20:27:28] [memory] Reserving 80 MB, device gpu0
[2023-07-27 20:27:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 20:27:28] [memory] Reserving 80 MB, device gpu0
[2023-07-27 21:17:35] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 21:17:35] [valid] No post-processing script given for validating translator
[2023-07-27 21:17:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 21:17:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 21:17:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 21:17:35] [comm] Using global sharding
[2023-07-27 21:17:35] [comm] NCCLCommunicators constructed successfully
[2023-07-27 21:17:35] [training] Using 1 GPUs
[2023-07-27 21:17:35] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 21:17:40] Allocating memory for general optimizer shards
[2023-07-27 21:17:40] [memory] Reserving 322 MB, device gpu0
[2023-07-27 21:17:40] Loading Adam parameters
[2023-07-27 21:17:40] [memory] Reserving 322 MB, device gpu0
[2023-07-27 21:17:41] [memory] Reserving 80 MB, device gpu0
[2023-07-27 21:17:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 21:17:41] [data] Restoring the corpus state to epoch 71, batch 2712
[2023-07-27 21:17:41] [data] Shuffling data
[2023-07-27 21:17:41] [data] Done reading 20,192 sentences
[2023-07-27 21:17:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:17:41] Training started
[2023-07-27 21:17:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-27 21:17:41] [memory] Reserving 80 MB, device gpu0
[2023-07-27 21:17:47] Parameter type float16, optimization type float32, casting types true
[2023-07-27 21:22:21] Seen 20,192 samples
[2023-07-27 21:22:21] Starting data epoch 72 in logical epoch 72
[2023-07-27 21:22:21] [data] Shuffling data
[2023-07-27 21:22:21] [data] Done reading 20,192 sentences
[2023-07-27 21:22:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:27:08] Seen 20,192 samples
[2023-07-27 21:27:08] Starting data epoch 73 in logical epoch 73
[2023-07-27 21:27:08] [data] Shuffling data
[2023-07-27 21:27:08] [data] Done reading 20,192 sentences
[2023-07-27 21:27:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:32:14] Seen 20,192 samples
[2023-07-27 21:32:14] Starting data epoch 74 in logical epoch 74
[2023-07-27 21:32:14] [data] Shuffling data
[2023-07-27 21:32:14] [data] Done reading 20,192 sentences
[2023-07-27 21:32:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:37:19] Seen 20,192 samples
[2023-07-27 21:37:19] Starting data epoch 75 in logical epoch 75
[2023-07-27 21:37:19] [data] Shuffling data
[2023-07-27 21:37:19] [data] Done reading 20,192 sentences
[2023-07-27 21:37:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:42:20] Seen 20,192 samples
[2023-07-27 21:42:20] Starting data epoch 76 in logical epoch 76
[2023-07-27 21:42:20] [data] Shuffling data
[2023-07-27 21:42:20] [data] Done reading 20,192 sentences
[2023-07-27 21:42:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:47:24] Seen 20,192 samples
[2023-07-27 21:47:24] Starting data epoch 77 in logical epoch 77
[2023-07-27 21:47:24] [data] Shuffling data
[2023-07-27 21:47:24] [data] Done reading 20,192 sentences
[2023-07-27 21:47:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:52:18] Seen 20,192 samples
[2023-07-27 21:52:18] Starting data epoch 78 in logical epoch 78
[2023-07-27 21:52:18] [data] Shuffling data
[2023-07-27 21:52:18] [data] Done reading 20,192 sentences
[2023-07-27 21:52:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 21:54:23] Ep. 78 : Up. 3000 : Sen. 9,784 : Cost 4.40822458 * 16,069,652 @ 9,615 after 48,051,652 : Time 2207.96s : 7278.06 words/s : gNorm 1.0472
[2023-07-27 21:57:30] Seen 20,192 samples
[2023-07-27 21:57:30] Starting data epoch 79 in logical epoch 79
[2023-07-27 21:57:30] [data] Shuffling data
[2023-07-27 21:57:30] [data] Done reading 20,192 sentences
[2023-07-27 21:57:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:02:42] Seen 20,192 samples
[2023-07-27 22:02:42] Starting data epoch 80 in logical epoch 80
[2023-07-27 22:02:42] [data] Shuffling data
[2023-07-27 22:02:42] [data] Done reading 20,192 sentences
[2023-07-27 22:02:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:07:46] Seen 20,192 samples
[2023-07-27 22:07:46] Starting data epoch 81 in logical epoch 81
[2023-07-27 22:07:46] Training finished
[2023-07-27 22:09:52] [valid] Ep. 81 : Up. 3100 : translation : 0 : new best
[2023-07-27 22:09:52] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 22:09:55] Saving Adam parameters
[2023-07-27 22:09:55] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 22:10:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:10:06] [marian] Running on node18.datos.cluster.uy as process 18337 with command line:
[2023-07-27 22:10:06] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 22:10:06] [config] after: 0e
[2023-07-27 22:10:06] [config] after-batches: 0
[2023-07-27 22:10:06] [config] after-epochs: 90
[2023-07-27 22:10:06] [config] all-caps-every: 0
[2023-07-27 22:10:06] [config] allow-unk: false
[2023-07-27 22:10:06] [config] authors: false
[2023-07-27 22:10:06] [config] beam-size: 12
[2023-07-27 22:10:06] [config] bert-class-symbol: "[CLS]"
[2023-07-27 22:10:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 22:10:06] [config] bert-masking-fraction: 0.15
[2023-07-27 22:10:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 22:10:06] [config] bert-train-type-embeddings: true
[2023-07-27 22:10:06] [config] bert-type-vocab-size: 2
[2023-07-27 22:10:06] [config] build-info: ""
[2023-07-27 22:10:06] [config] check-gradient-nan: false
[2023-07-27 22:10:06] [config] check-nan: false
[2023-07-27 22:10:06] [config] cite: false
[2023-07-27 22:10:06] [config] clip-norm: 1
[2023-07-27 22:10:06] [config] cost-scaling:
[2023-07-27 22:10:06] [config]   - 256.f
[2023-07-27 22:10:06] [config]   - 1000
[2023-07-27 22:10:06] [config]   - 2.f
[2023-07-27 22:10:06] [config]   - 256.f
[2023-07-27 22:10:06] [config] cost-type: ce-sum
[2023-07-27 22:10:06] [config] cpu-threads: 0
[2023-07-27 22:10:06] [config] data-threads: 8
[2023-07-27 22:10:06] [config] data-weighting: ""
[2023-07-27 22:10:06] [config] data-weighting-type: sentence
[2023-07-27 22:10:06] [config] dec-cell: gru
[2023-07-27 22:10:06] [config] dec-cell-base-depth: 2
[2023-07-27 22:10:06] [config] dec-cell-high-depth: 1
[2023-07-27 22:10:06] [config] dec-depth: 1
[2023-07-27 22:10:06] [config] devices:
[2023-07-27 22:10:06] [config]   - 0
[2023-07-27 22:10:06] [config] dim-emb: 512
[2023-07-27 22:10:06] [config] dim-rnn: 1024
[2023-07-27 22:10:06] [config] dim-vocabs:
[2023-07-27 22:10:06] [config]   - 16384
[2023-07-27 22:10:06] [config]   - 16384
[2023-07-27 22:10:06] [config] disp-first: 0
[2023-07-27 22:10:06] [config] disp-freq: 1000u
[2023-07-27 22:10:06] [config] disp-label-counts: true
[2023-07-27 22:10:06] [config] dropout-rnn: 0
[2023-07-27 22:10:06] [config] dropout-src: 0
[2023-07-27 22:10:06] [config] dropout-trg: 0
[2023-07-27 22:10:06] [config] dump-config: ""
[2023-07-27 22:10:06] [config] dynamic-gradient-scaling:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] early-stopping: 1000
[2023-07-27 22:10:06] [config] early-stopping-on: first
[2023-07-27 22:10:06] [config] embedding-fix-src: false
[2023-07-27 22:10:06] [config] embedding-fix-trg: false
[2023-07-27 22:10:06] [config] embedding-normalization: false
[2023-07-27 22:10:06] [config] embedding-vectors:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] enc-cell: gru
[2023-07-27 22:10:06] [config] enc-cell-depth: 1
[2023-07-27 22:10:06] [config] enc-depth: 1
[2023-07-27 22:10:06] [config] enc-type: bidirectional
[2023-07-27 22:10:06] [config] english-title-case-every: 0
[2023-07-27 22:10:06] [config] exponential-smoothing: 0
[2023-07-27 22:10:06] [config] factor-weight: 1
[2023-07-27 22:10:06] [config] factors-combine: sum
[2023-07-27 22:10:06] [config] factors-dim-emb: 0
[2023-07-27 22:10:06] [config] gradient-checkpointing: false
[2023-07-27 22:10:06] [config] gradient-norm-average-window: 100
[2023-07-27 22:10:06] [config] guided-alignment: none
[2023-07-27 22:10:06] [config] guided-alignment-cost: mse
[2023-07-27 22:10:06] [config] guided-alignment-weight: 0.1
[2023-07-27 22:10:06] [config] ignore-model-config: false
[2023-07-27 22:10:06] [config] input-types:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] interpolate-env-vars: false
[2023-07-27 22:10:06] [config] keep-best: false
[2023-07-27 22:10:06] [config] label-smoothing: 0
[2023-07-27 22:10:06] [config] layer-normalization: false
[2023-07-27 22:10:06] [config] learn-rate: 0.0001
[2023-07-27 22:10:06] [config] lemma-dependency: ""
[2023-07-27 22:10:06] [config] lemma-dim-emb: 0
[2023-07-27 22:10:06] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 22:10:06] [config] log-level: info
[2023-07-27 22:10:06] [config] log-time-zone: ""
[2023-07-27 22:10:06] [config] logical-epoch:
[2023-07-27 22:10:06] [config]   - 1e
[2023-07-27 22:10:06] [config]   - 0
[2023-07-27 22:10:06] [config] lr-decay: 0
[2023-07-27 22:10:06] [config] lr-decay-freq: 50000
[2023-07-27 22:10:06] [config] lr-decay-inv-sqrt:
[2023-07-27 22:10:06] [config]   - 0
[2023-07-27 22:10:06] [config] lr-decay-repeat-warmup: false
[2023-07-27 22:10:06] [config] lr-decay-reset-optimizer: false
[2023-07-27 22:10:06] [config] lr-decay-start:
[2023-07-27 22:10:06] [config]   - 10
[2023-07-27 22:10:06] [config]   - 1
[2023-07-27 22:10:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 22:10:06] [config] lr-report: false
[2023-07-27 22:10:06] [config] lr-warmup: 0
[2023-07-27 22:10:06] [config] lr-warmup-at-reload: false
[2023-07-27 22:10:06] [config] lr-warmup-cycle: false
[2023-07-27 22:10:06] [config] lr-warmup-start-rate: 0
[2023-07-27 22:10:06] [config] max-length: 250
[2023-07-27 22:10:06] [config] max-length-crop: true
[2023-07-27 22:10:06] [config] max-length-factor: 3
[2023-07-27 22:10:06] [config] maxi-batch: 100
[2023-07-27 22:10:06] [config] maxi-batch-sort: trg
[2023-07-27 22:10:06] [config] mini-batch: 64
[2023-07-27 22:10:06] [config] mini-batch-fit: true
[2023-07-27 22:10:06] [config] mini-batch-fit-step: 10
[2023-07-27 22:10:06] [config] mini-batch-round-up: true
[2023-07-27 22:10:06] [config] mini-batch-track-lr: false
[2023-07-27 22:10:06] [config] mini-batch-warmup: 0
[2023-07-27 22:10:06] [config] mini-batch-words: 0
[2023-07-27 22:10:06] [config] mini-batch-words-ref: 0
[2023-07-27 22:10:06] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 22:10:06] [config] multi-loss-type: sum
[2023-07-27 22:10:06] [config] n-best: false
[2023-07-27 22:10:06] [config] no-nccl: false
[2023-07-27 22:10:06] [config] no-reload: false
[2023-07-27 22:10:06] [config] no-restore-corpus: false
[2023-07-27 22:10:06] [config] normalize: 0
[2023-07-27 22:10:06] [config] normalize-gradient: false
[2023-07-27 22:10:06] [config] num-devices: 0
[2023-07-27 22:10:06] [config] optimizer: adam
[2023-07-27 22:10:06] [config] optimizer-delay: 1
[2023-07-27 22:10:06] [config] optimizer-params:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] output-omit-bias: false
[2023-07-27 22:10:06] [config] overwrite: true
[2023-07-27 22:10:06] [config] precision:
[2023-07-27 22:10:06] [config]   - float16
[2023-07-27 22:10:06] [config]   - float32
[2023-07-27 22:10:06] [config] pretrained-model: ""
[2023-07-27 22:10:06] [config] quantize-biases: false
[2023-07-27 22:10:06] [config] quantize-bits: 0
[2023-07-27 22:10:06] [config] quantize-log-based: false
[2023-07-27 22:10:06] [config] quantize-optimization-steps: 0
[2023-07-27 22:10:06] [config] quiet: false
[2023-07-27 22:10:06] [config] quiet-translation: true
[2023-07-27 22:10:06] [config] relative-paths: false
[2023-07-27 22:10:06] [config] right-left: false
[2023-07-27 22:10:06] [config] save-freq: 10000u
[2023-07-27 22:10:06] [config] seed: 1234
[2023-07-27 22:10:06] [config] sentencepiece-alphas:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] sentencepiece-max-lines: 2000000
[2023-07-27 22:10:06] [config] sentencepiece-options: ""
[2023-07-27 22:10:06] [config] sharding: global
[2023-07-27 22:10:06] [config] shuffle: data
[2023-07-27 22:10:06] [config] shuffle-in-ram: false
[2023-07-27 22:10:06] [config] sigterm: save-and-exit
[2023-07-27 22:10:06] [config] skip: false
[2023-07-27 22:10:06] [config] sqlite: ""
[2023-07-27 22:10:06] [config] sqlite-drop: false
[2023-07-27 22:10:06] [config] sync-freq: 200u
[2023-07-27 22:10:06] [config] sync-sgd: false
[2023-07-27 22:10:06] [config] tempdir: /tmp
[2023-07-27 22:10:06] [config] tied-embeddings: false
[2023-07-27 22:10:06] [config] tied-embeddings-all: true
[2023-07-27 22:10:06] [config] tied-embeddings-src: false
[2023-07-27 22:10:06] [config] train-embedder-rank:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] train-sets:
[2023-07-27 22:10:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 22:10:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 22:10:06] [config] transformer-aan-activation: swish
[2023-07-27 22:10:06] [config] transformer-aan-depth: 2
[2023-07-27 22:10:06] [config] transformer-aan-nogate: false
[2023-07-27 22:10:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 22:10:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 22:10:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 22:10:06] [config] transformer-depth-scaling: false
[2023-07-27 22:10:06] [config] transformer-dim-aan: 2048
[2023-07-27 22:10:06] [config] transformer-dim-ffn: 2048
[2023-07-27 22:10:06] [config] transformer-dropout: 0
[2023-07-27 22:10:06] [config] transformer-dropout-attention: 0
[2023-07-27 22:10:06] [config] transformer-dropout-ffn: 0
[2023-07-27 22:10:06] [config] transformer-ffn-activation: swish
[2023-07-27 22:10:06] [config] transformer-ffn-depth: 2
[2023-07-27 22:10:06] [config] transformer-guided-alignment-layer: last
[2023-07-27 22:10:06] [config] transformer-heads: 8
[2023-07-27 22:10:06] [config] transformer-no-projection: false
[2023-07-27 22:10:06] [config] transformer-pool: false
[2023-07-27 22:10:06] [config] transformer-postprocess: dan
[2023-07-27 22:10:06] [config] transformer-postprocess-emb: d
[2023-07-27 22:10:06] [config] transformer-postprocess-top: ""
[2023-07-27 22:10:06] [config] transformer-preprocess: ""
[2023-07-27 22:10:06] [config] transformer-tied-layers:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] transformer-train-position-embeddings: false
[2023-07-27 22:10:06] [config] tsv: false
[2023-07-27 22:10:06] [config] tsv-fields: 0
[2023-07-27 22:10:06] [config] type: s2s
[2023-07-27 22:10:06] [config] ulr: false
[2023-07-27 22:10:06] [config] ulr-dim-emb: 0
[2023-07-27 22:10:06] [config] ulr-dropout: 0
[2023-07-27 22:10:06] [config] ulr-keys-vectors: ""
[2023-07-27 22:10:06] [config] ulr-query-vectors: ""
[2023-07-27 22:10:06] [config] ulr-softmax-temperature: 1
[2023-07-27 22:10:06] [config] ulr-trainable-transformation: false
[2023-07-27 22:10:06] [config] unlikelihood-loss: false
[2023-07-27 22:10:06] [config] valid-freq: 50000000
[2023-07-27 22:10:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 22:10:06] [config] valid-max-length: 1000
[2023-07-27 22:10:06] [config] valid-metrics:
[2023-07-27 22:10:06] [config]   - translation
[2023-07-27 22:10:06] [config] valid-mini-batch: 32
[2023-07-27 22:10:06] [config] valid-reset-stalled: false
[2023-07-27 22:10:06] [config] valid-script-args:
[2023-07-27 22:10:06] [config]   []
[2023-07-27 22:10:06] [config] valid-script-path: ""
[2023-07-27 22:10:06] [config] valid-sets:
[2023-07-27 22:10:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 22:10:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 22:10:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 22:10:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:10:06] [config] vocabs:
[2023-07-27 22:10:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 22:10:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 22:10:06] [config] word-penalty: 0
[2023-07-27 22:10:06] [config] word-scores: false
[2023-07-27 22:10:06] [config] workspace: 5500
[2023-07-27 22:10:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:10:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:10:06] [training] Using single-device training
[2023-07-27 22:10:06] Synced seed 1234
[2023-07-27 22:10:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 22:10:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 22:10:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 22:10:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 22:10:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 22:10:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:10:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 22:10:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 22:10:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 22:10:07] [comm] Using global sharding
[2023-07-27 22:10:07] [comm] NCCLCommunicators constructed successfully
[2023-07-27 22:10:07] [training] Using 1 GPUs
[2023-07-27 22:10:07] [logits] Applying loss function for 1 factor(s)
[2023-07-27 22:10:07] [memory] Reserving 80 MB, device gpu0
[2023-07-27 22:10:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 22:10:08] [memory] Reserving 80 MB, device gpu0
[2023-07-27 22:56:41] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 22:56:41] [valid] No post-processing script given for validating translator
[2023-07-27 22:56:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:56:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 22:56:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 22:56:41] [comm] Using global sharding
[2023-07-27 22:56:41] [comm] NCCLCommunicators constructed successfully
[2023-07-27 22:56:41] [training] Using 1 GPUs
[2023-07-27 22:56:41] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 22:56:49] Allocating memory for general optimizer shards
[2023-07-27 22:56:49] [memory] Reserving 322 MB, device gpu0
[2023-07-27 22:56:49] Loading Adam parameters
[2023-07-27 22:56:49] [memory] Reserving 322 MB, device gpu0
[2023-07-27 22:56:49] [memory] Reserving 80 MB, device gpu0
[2023-07-27 22:56:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 22:56:50] [data] Restoring the corpus state to epoch 91, batch 3488
[2023-07-27 22:56:50] [data] Shuffling data
[2023-07-27 22:56:50] [data] Done reading 20,192 sentences
[2023-07-27 22:56:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 22:56:50] Training started
[2023-07-27 22:56:50] Training finished
[2023-07-27 22:56:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:56:55] [marian] Running on node18.datos.cluster.uy as process 21533 with command line:
[2023-07-27 22:56:55] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 22:56:55] [config] after: 0e
[2023-07-27 22:56:55] [config] after-batches: 0
[2023-07-27 22:56:55] [config] after-epochs: 100
[2023-07-27 22:56:55] [config] all-caps-every: 0
[2023-07-27 22:56:55] [config] allow-unk: false
[2023-07-27 22:56:55] [config] authors: false
[2023-07-27 22:56:55] [config] beam-size: 12
[2023-07-27 22:56:55] [config] bert-class-symbol: "[CLS]"
[2023-07-27 22:56:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 22:56:55] [config] bert-masking-fraction: 0.15
[2023-07-27 22:56:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 22:56:55] [config] bert-train-type-embeddings: true
[2023-07-27 22:56:55] [config] bert-type-vocab-size: 2
[2023-07-27 22:56:55] [config] build-info: ""
[2023-07-27 22:56:55] [config] check-gradient-nan: false
[2023-07-27 22:56:55] [config] check-nan: false
[2023-07-27 22:56:55] [config] cite: false
[2023-07-27 22:56:55] [config] clip-norm: 1
[2023-07-27 22:56:55] [config] cost-scaling:
[2023-07-27 22:56:55] [config]   - 256.f
[2023-07-27 22:56:55] [config]   - 1000
[2023-07-27 22:56:55] [config]   - 2.f
[2023-07-27 22:56:55] [config]   - 256.f
[2023-07-27 22:56:55] [config] cost-type: ce-sum
[2023-07-27 22:56:55] [config] cpu-threads: 0
[2023-07-27 22:56:55] [config] data-threads: 8
[2023-07-27 22:56:55] [config] data-weighting: ""
[2023-07-27 22:56:55] [config] data-weighting-type: sentence
[2023-07-27 22:56:55] [config] dec-cell: gru
[2023-07-27 22:56:55] [config] dec-cell-base-depth: 2
[2023-07-27 22:56:55] [config] dec-cell-high-depth: 1
[2023-07-27 22:56:55] [config] dec-depth: 1
[2023-07-27 22:56:55] [config] devices:
[2023-07-27 22:56:55] [config]   - 0
[2023-07-27 22:56:55] [config] dim-emb: 512
[2023-07-27 22:56:55] [config] dim-rnn: 1024
[2023-07-27 22:56:55] [config] dim-vocabs:
[2023-07-27 22:56:55] [config]   - 16384
[2023-07-27 22:56:55] [config]   - 16384
[2023-07-27 22:56:55] [config] disp-first: 0
[2023-07-27 22:56:55] [config] disp-freq: 1000u
[2023-07-27 22:56:55] [config] disp-label-counts: true
[2023-07-27 22:56:55] [config] dropout-rnn: 0
[2023-07-27 22:56:55] [config] dropout-src: 0
[2023-07-27 22:56:55] [config] dropout-trg: 0
[2023-07-27 22:56:55] [config] dump-config: ""
[2023-07-27 22:56:55] [config] dynamic-gradient-scaling:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] early-stopping: 1000
[2023-07-27 22:56:55] [config] early-stopping-on: first
[2023-07-27 22:56:55] [config] embedding-fix-src: false
[2023-07-27 22:56:55] [config] embedding-fix-trg: false
[2023-07-27 22:56:55] [config] embedding-normalization: false
[2023-07-27 22:56:55] [config] embedding-vectors:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] enc-cell: gru
[2023-07-27 22:56:55] [config] enc-cell-depth: 1
[2023-07-27 22:56:55] [config] enc-depth: 1
[2023-07-27 22:56:55] [config] enc-type: bidirectional
[2023-07-27 22:56:55] [config] english-title-case-every: 0
[2023-07-27 22:56:55] [config] exponential-smoothing: 0
[2023-07-27 22:56:55] [config] factor-weight: 1
[2023-07-27 22:56:55] [config] factors-combine: sum
[2023-07-27 22:56:55] [config] factors-dim-emb: 0
[2023-07-27 22:56:55] [config] gradient-checkpointing: false
[2023-07-27 22:56:55] [config] gradient-norm-average-window: 100
[2023-07-27 22:56:55] [config] guided-alignment: none
[2023-07-27 22:56:55] [config] guided-alignment-cost: mse
[2023-07-27 22:56:55] [config] guided-alignment-weight: 0.1
[2023-07-27 22:56:55] [config] ignore-model-config: false
[2023-07-27 22:56:55] [config] input-types:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] interpolate-env-vars: false
[2023-07-27 22:56:55] [config] keep-best: false
[2023-07-27 22:56:55] [config] label-smoothing: 0
[2023-07-27 22:56:55] [config] layer-normalization: false
[2023-07-27 22:56:55] [config] learn-rate: 0.0001
[2023-07-27 22:56:55] [config] lemma-dependency: ""
[2023-07-27 22:56:55] [config] lemma-dim-emb: 0
[2023-07-27 22:56:55] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 22:56:55] [config] log-level: info
[2023-07-27 22:56:55] [config] log-time-zone: ""
[2023-07-27 22:56:55] [config] logical-epoch:
[2023-07-27 22:56:55] [config]   - 1e
[2023-07-27 22:56:55] [config]   - 0
[2023-07-27 22:56:55] [config] lr-decay: 0
[2023-07-27 22:56:55] [config] lr-decay-freq: 50000
[2023-07-27 22:56:55] [config] lr-decay-inv-sqrt:
[2023-07-27 22:56:55] [config]   - 0
[2023-07-27 22:56:55] [config] lr-decay-repeat-warmup: false
[2023-07-27 22:56:55] [config] lr-decay-reset-optimizer: false
[2023-07-27 22:56:55] [config] lr-decay-start:
[2023-07-27 22:56:55] [config]   - 10
[2023-07-27 22:56:55] [config]   - 1
[2023-07-27 22:56:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 22:56:55] [config] lr-report: false
[2023-07-27 22:56:55] [config] lr-warmup: 0
[2023-07-27 22:56:55] [config] lr-warmup-at-reload: false
[2023-07-27 22:56:55] [config] lr-warmup-cycle: false
[2023-07-27 22:56:55] [config] lr-warmup-start-rate: 0
[2023-07-27 22:56:55] [config] max-length: 250
[2023-07-27 22:56:55] [config] max-length-crop: true
[2023-07-27 22:56:55] [config] max-length-factor: 3
[2023-07-27 22:56:55] [config] maxi-batch: 100
[2023-07-27 22:56:55] [config] maxi-batch-sort: trg
[2023-07-27 22:56:55] [config] mini-batch: 64
[2023-07-27 22:56:55] [config] mini-batch-fit: true
[2023-07-27 22:56:55] [config] mini-batch-fit-step: 10
[2023-07-27 22:56:55] [config] mini-batch-round-up: true
[2023-07-27 22:56:55] [config] mini-batch-track-lr: false
[2023-07-27 22:56:55] [config] mini-batch-warmup: 0
[2023-07-27 22:56:55] [config] mini-batch-words: 0
[2023-07-27 22:56:55] [config] mini-batch-words-ref: 0
[2023-07-27 22:56:55] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 22:56:55] [config] multi-loss-type: sum
[2023-07-27 22:56:55] [config] n-best: false
[2023-07-27 22:56:55] [config] no-nccl: false
[2023-07-27 22:56:55] [config] no-reload: false
[2023-07-27 22:56:55] [config] no-restore-corpus: false
[2023-07-27 22:56:55] [config] normalize: 0
[2023-07-27 22:56:55] [config] normalize-gradient: false
[2023-07-27 22:56:55] [config] num-devices: 0
[2023-07-27 22:56:55] [config] optimizer: adam
[2023-07-27 22:56:55] [config] optimizer-delay: 1
[2023-07-27 22:56:55] [config] optimizer-params:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] output-omit-bias: false
[2023-07-27 22:56:55] [config] overwrite: true
[2023-07-27 22:56:55] [config] precision:
[2023-07-27 22:56:55] [config]   - float16
[2023-07-27 22:56:55] [config]   - float32
[2023-07-27 22:56:55] [config] pretrained-model: ""
[2023-07-27 22:56:55] [config] quantize-biases: false
[2023-07-27 22:56:55] [config] quantize-bits: 0
[2023-07-27 22:56:55] [config] quantize-log-based: false
[2023-07-27 22:56:55] [config] quantize-optimization-steps: 0
[2023-07-27 22:56:55] [config] quiet: false
[2023-07-27 22:56:55] [config] quiet-translation: true
[2023-07-27 22:56:55] [config] relative-paths: false
[2023-07-27 22:56:55] [config] right-left: false
[2023-07-27 22:56:55] [config] save-freq: 10000u
[2023-07-27 22:56:55] [config] seed: 1234
[2023-07-27 22:56:55] [config] sentencepiece-alphas:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] sentencepiece-max-lines: 2000000
[2023-07-27 22:56:55] [config] sentencepiece-options: ""
[2023-07-27 22:56:55] [config] sharding: global
[2023-07-27 22:56:55] [config] shuffle: data
[2023-07-27 22:56:55] [config] shuffle-in-ram: false
[2023-07-27 22:56:55] [config] sigterm: save-and-exit
[2023-07-27 22:56:55] [config] skip: false
[2023-07-27 22:56:55] [config] sqlite: ""
[2023-07-27 22:56:55] [config] sqlite-drop: false
[2023-07-27 22:56:55] [config] sync-freq: 200u
[2023-07-27 22:56:55] [config] sync-sgd: false
[2023-07-27 22:56:55] [config] tempdir: /tmp
[2023-07-27 22:56:55] [config] tied-embeddings: false
[2023-07-27 22:56:55] [config] tied-embeddings-all: true
[2023-07-27 22:56:55] [config] tied-embeddings-src: false
[2023-07-27 22:56:55] [config] train-embedder-rank:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] train-sets:
[2023-07-27 22:56:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 22:56:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 22:56:55] [config] transformer-aan-activation: swish
[2023-07-27 22:56:55] [config] transformer-aan-depth: 2
[2023-07-27 22:56:55] [config] transformer-aan-nogate: false
[2023-07-27 22:56:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 22:56:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 22:56:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 22:56:55] [config] transformer-depth-scaling: false
[2023-07-27 22:56:55] [config] transformer-dim-aan: 2048
[2023-07-27 22:56:55] [config] transformer-dim-ffn: 2048
[2023-07-27 22:56:55] [config] transformer-dropout: 0
[2023-07-27 22:56:55] [config] transformer-dropout-attention: 0
[2023-07-27 22:56:55] [config] transformer-dropout-ffn: 0
[2023-07-27 22:56:55] [config] transformer-ffn-activation: swish
[2023-07-27 22:56:55] [config] transformer-ffn-depth: 2
[2023-07-27 22:56:55] [config] transformer-guided-alignment-layer: last
[2023-07-27 22:56:55] [config] transformer-heads: 8
[2023-07-27 22:56:55] [config] transformer-no-projection: false
[2023-07-27 22:56:55] [config] transformer-pool: false
[2023-07-27 22:56:55] [config] transformer-postprocess: dan
[2023-07-27 22:56:55] [config] transformer-postprocess-emb: d
[2023-07-27 22:56:55] [config] transformer-postprocess-top: ""
[2023-07-27 22:56:55] [config] transformer-preprocess: ""
[2023-07-27 22:56:55] [config] transformer-tied-layers:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] transformer-train-position-embeddings: false
[2023-07-27 22:56:55] [config] tsv: false
[2023-07-27 22:56:55] [config] tsv-fields: 0
[2023-07-27 22:56:55] [config] type: s2s
[2023-07-27 22:56:55] [config] ulr: false
[2023-07-27 22:56:55] [config] ulr-dim-emb: 0
[2023-07-27 22:56:55] [config] ulr-dropout: 0
[2023-07-27 22:56:55] [config] ulr-keys-vectors: ""
[2023-07-27 22:56:55] [config] ulr-query-vectors: ""
[2023-07-27 22:56:55] [config] ulr-softmax-temperature: 1
[2023-07-27 22:56:55] [config] ulr-trainable-transformation: false
[2023-07-27 22:56:55] [config] unlikelihood-loss: false
[2023-07-27 22:56:55] [config] valid-freq: 50000000
[2023-07-27 22:56:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 22:56:55] [config] valid-max-length: 1000
[2023-07-27 22:56:55] [config] valid-metrics:
[2023-07-27 22:56:55] [config]   - translation
[2023-07-27 22:56:55] [config] valid-mini-batch: 32
[2023-07-27 22:56:55] [config] valid-reset-stalled: false
[2023-07-27 22:56:55] [config] valid-script-args:
[2023-07-27 22:56:55] [config]   []
[2023-07-27 22:56:55] [config] valid-script-path: ""
[2023-07-27 22:56:55] [config] valid-sets:
[2023-07-27 22:56:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 22:56:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 22:56:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 22:56:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:56:55] [config] vocabs:
[2023-07-27 22:56:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 22:56:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 22:56:55] [config] word-penalty: 0
[2023-07-27 22:56:55] [config] word-scores: false
[2023-07-27 22:56:55] [config] workspace: 5500
[2023-07-27 22:56:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 22:56:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:56:55] [training] Using single-device training
[2023-07-27 22:56:55] Synced seed 1234
[2023-07-27 22:56:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 22:56:55] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 22:56:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 22:56:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 22:56:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 22:56:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 22:56:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 22:56:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 22:56:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 22:56:56] [comm] Using global sharding
[2023-07-27 22:56:56] [comm] NCCLCommunicators constructed successfully
[2023-07-27 22:56:56] [training] Using 1 GPUs
[2023-07-27 22:56:56] [logits] Applying loss function for 1 factor(s)
[2023-07-27 22:56:56] [memory] Reserving 80 MB, device gpu0
[2023-07-27 22:56:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 22:56:57] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:45:01] [batching] Done. Typical MB size is 35,869 target words
[2023-07-27 23:45:02] [valid] No post-processing script given for validating translator
[2023-07-27 23:45:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:45:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 23:45:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 23:45:02] [comm] Using global sharding
[2023-07-27 23:45:02] [comm] NCCLCommunicators constructed successfully
[2023-07-27 23:45:02] [training] Using 1 GPUs
[2023-07-27 23:45:02] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 23:45:08] Allocating memory for general optimizer shards
[2023-07-27 23:45:08] [memory] Reserving 322 MB, device gpu0
[2023-07-27 23:45:08] Loading Adam parameters
[2023-07-27 23:45:08] [memory] Reserving 322 MB, device gpu0
[2023-07-27 23:45:08] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:45:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-27 23:45:08] [data] Restoring the corpus state to epoch 101, batch 3879
[2023-07-27 23:45:08] [data] Shuffling data
[2023-07-27 23:45:08] [data] Done reading 20,192 sentences
[2023-07-27 23:45:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-27 23:45:08] Training started
[2023-07-27 23:45:08] Training finished
[2023-07-27 23:45:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:45:12] [marian] Running on node18.datos.cluster.uy as process 24469 with command line:
[2023-07-27 23:45:12] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-27 23:45:12] [config] after: 0e
[2023-07-27 23:45:12] [config] after-batches: 0
[2023-07-27 23:45:12] [config] after-epochs: 110
[2023-07-27 23:45:12] [config] all-caps-every: 0
[2023-07-27 23:45:12] [config] allow-unk: false
[2023-07-27 23:45:12] [config] authors: false
[2023-07-27 23:45:12] [config] beam-size: 12
[2023-07-27 23:45:12] [config] bert-class-symbol: "[CLS]"
[2023-07-27 23:45:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-27 23:45:12] [config] bert-masking-fraction: 0.15
[2023-07-27 23:45:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-27 23:45:12] [config] bert-train-type-embeddings: true
[2023-07-27 23:45:12] [config] bert-type-vocab-size: 2
[2023-07-27 23:45:12] [config] build-info: ""
[2023-07-27 23:45:12] [config] check-gradient-nan: false
[2023-07-27 23:45:12] [config] check-nan: false
[2023-07-27 23:45:12] [config] cite: false
[2023-07-27 23:45:12] [config] clip-norm: 1
[2023-07-27 23:45:12] [config] cost-scaling:
[2023-07-27 23:45:12] [config]   - 256.f
[2023-07-27 23:45:12] [config]   - 1000
[2023-07-27 23:45:12] [config]   - 2.f
[2023-07-27 23:45:12] [config]   - 256.f
[2023-07-27 23:45:12] [config] cost-type: ce-sum
[2023-07-27 23:45:12] [config] cpu-threads: 0
[2023-07-27 23:45:12] [config] data-threads: 8
[2023-07-27 23:45:12] [config] data-weighting: ""
[2023-07-27 23:45:12] [config] data-weighting-type: sentence
[2023-07-27 23:45:12] [config] dec-cell: gru
[2023-07-27 23:45:12] [config] dec-cell-base-depth: 2
[2023-07-27 23:45:12] [config] dec-cell-high-depth: 1
[2023-07-27 23:45:12] [config] dec-depth: 1
[2023-07-27 23:45:12] [config] devices:
[2023-07-27 23:45:12] [config]   - 0
[2023-07-27 23:45:12] [config] dim-emb: 512
[2023-07-27 23:45:12] [config] dim-rnn: 1024
[2023-07-27 23:45:12] [config] dim-vocabs:
[2023-07-27 23:45:12] [config]   - 16384
[2023-07-27 23:45:12] [config]   - 16384
[2023-07-27 23:45:12] [config] disp-first: 0
[2023-07-27 23:45:12] [config] disp-freq: 1000u
[2023-07-27 23:45:12] [config] disp-label-counts: true
[2023-07-27 23:45:12] [config] dropout-rnn: 0
[2023-07-27 23:45:12] [config] dropout-src: 0
[2023-07-27 23:45:12] [config] dropout-trg: 0
[2023-07-27 23:45:12] [config] dump-config: ""
[2023-07-27 23:45:12] [config] dynamic-gradient-scaling:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] early-stopping: 1000
[2023-07-27 23:45:12] [config] early-stopping-on: first
[2023-07-27 23:45:12] [config] embedding-fix-src: false
[2023-07-27 23:45:12] [config] embedding-fix-trg: false
[2023-07-27 23:45:12] [config] embedding-normalization: false
[2023-07-27 23:45:12] [config] embedding-vectors:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] enc-cell: gru
[2023-07-27 23:45:12] [config] enc-cell-depth: 1
[2023-07-27 23:45:12] [config] enc-depth: 1
[2023-07-27 23:45:12] [config] enc-type: bidirectional
[2023-07-27 23:45:12] [config] english-title-case-every: 0
[2023-07-27 23:45:12] [config] exponential-smoothing: 0
[2023-07-27 23:45:12] [config] factor-weight: 1
[2023-07-27 23:45:12] [config] factors-combine: sum
[2023-07-27 23:45:12] [config] factors-dim-emb: 0
[2023-07-27 23:45:12] [config] gradient-checkpointing: false
[2023-07-27 23:45:12] [config] gradient-norm-average-window: 100
[2023-07-27 23:45:12] [config] guided-alignment: none
[2023-07-27 23:45:12] [config] guided-alignment-cost: mse
[2023-07-27 23:45:12] [config] guided-alignment-weight: 0.1
[2023-07-27 23:45:12] [config] ignore-model-config: false
[2023-07-27 23:45:12] [config] input-types:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] interpolate-env-vars: false
[2023-07-27 23:45:12] [config] keep-best: false
[2023-07-27 23:45:12] [config] label-smoothing: 0
[2023-07-27 23:45:12] [config] layer-normalization: false
[2023-07-27 23:45:12] [config] learn-rate: 0.0001
[2023-07-27 23:45:12] [config] lemma-dependency: ""
[2023-07-27 23:45:12] [config] lemma-dim-emb: 0
[2023-07-27 23:45:12] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 23:45:12] [config] log-level: info
[2023-07-27 23:45:12] [config] log-time-zone: ""
[2023-07-27 23:45:12] [config] logical-epoch:
[2023-07-27 23:45:12] [config]   - 1e
[2023-07-27 23:45:12] [config]   - 0
[2023-07-27 23:45:12] [config] lr-decay: 0
[2023-07-27 23:45:12] [config] lr-decay-freq: 50000
[2023-07-27 23:45:12] [config] lr-decay-inv-sqrt:
[2023-07-27 23:45:12] [config]   - 0
[2023-07-27 23:45:12] [config] lr-decay-repeat-warmup: false
[2023-07-27 23:45:12] [config] lr-decay-reset-optimizer: false
[2023-07-27 23:45:12] [config] lr-decay-start:
[2023-07-27 23:45:12] [config]   - 10
[2023-07-27 23:45:12] [config]   - 1
[2023-07-27 23:45:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-27 23:45:12] [config] lr-report: false
[2023-07-27 23:45:12] [config] lr-warmup: 0
[2023-07-27 23:45:12] [config] lr-warmup-at-reload: false
[2023-07-27 23:45:12] [config] lr-warmup-cycle: false
[2023-07-27 23:45:12] [config] lr-warmup-start-rate: 0
[2023-07-27 23:45:12] [config] max-length: 250
[2023-07-27 23:45:12] [config] max-length-crop: true
[2023-07-27 23:45:12] [config] max-length-factor: 3
[2023-07-27 23:45:12] [config] maxi-batch: 100
[2023-07-27 23:45:12] [config] maxi-batch-sort: trg
[2023-07-27 23:45:12] [config] mini-batch: 64
[2023-07-27 23:45:12] [config] mini-batch-fit: true
[2023-07-27 23:45:12] [config] mini-batch-fit-step: 10
[2023-07-27 23:45:12] [config] mini-batch-round-up: true
[2023-07-27 23:45:12] [config] mini-batch-track-lr: false
[2023-07-27 23:45:12] [config] mini-batch-warmup: 0
[2023-07-27 23:45:12] [config] mini-batch-words: 0
[2023-07-27 23:45:12] [config] mini-batch-words-ref: 0
[2023-07-27 23:45:12] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-27 23:45:12] [config] multi-loss-type: sum
[2023-07-27 23:45:12] [config] n-best: false
[2023-07-27 23:45:12] [config] no-nccl: false
[2023-07-27 23:45:12] [config] no-reload: false
[2023-07-27 23:45:12] [config] no-restore-corpus: false
[2023-07-27 23:45:12] [config] normalize: 0
[2023-07-27 23:45:12] [config] normalize-gradient: false
[2023-07-27 23:45:12] [config] num-devices: 0
[2023-07-27 23:45:12] [config] optimizer: adam
[2023-07-27 23:45:12] [config] optimizer-delay: 1
[2023-07-27 23:45:12] [config] optimizer-params:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] output-omit-bias: false
[2023-07-27 23:45:12] [config] overwrite: true
[2023-07-27 23:45:12] [config] precision:
[2023-07-27 23:45:12] [config]   - float16
[2023-07-27 23:45:12] [config]   - float32
[2023-07-27 23:45:12] [config] pretrained-model: ""
[2023-07-27 23:45:12] [config] quantize-biases: false
[2023-07-27 23:45:12] [config] quantize-bits: 0
[2023-07-27 23:45:12] [config] quantize-log-based: false
[2023-07-27 23:45:12] [config] quantize-optimization-steps: 0
[2023-07-27 23:45:12] [config] quiet: false
[2023-07-27 23:45:12] [config] quiet-translation: true
[2023-07-27 23:45:12] [config] relative-paths: false
[2023-07-27 23:45:12] [config] right-left: false
[2023-07-27 23:45:12] [config] save-freq: 10000u
[2023-07-27 23:45:12] [config] seed: 1234
[2023-07-27 23:45:12] [config] sentencepiece-alphas:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] sentencepiece-max-lines: 2000000
[2023-07-27 23:45:12] [config] sentencepiece-options: ""
[2023-07-27 23:45:12] [config] sharding: global
[2023-07-27 23:45:12] [config] shuffle: data
[2023-07-27 23:45:12] [config] shuffle-in-ram: false
[2023-07-27 23:45:12] [config] sigterm: save-and-exit
[2023-07-27 23:45:12] [config] skip: false
[2023-07-27 23:45:12] [config] sqlite: ""
[2023-07-27 23:45:12] [config] sqlite-drop: false
[2023-07-27 23:45:12] [config] sync-freq: 200u
[2023-07-27 23:45:12] [config] sync-sgd: false
[2023-07-27 23:45:12] [config] tempdir: /tmp
[2023-07-27 23:45:12] [config] tied-embeddings: false
[2023-07-27 23:45:12] [config] tied-embeddings-all: true
[2023-07-27 23:45:12] [config] tied-embeddings-src: false
[2023-07-27 23:45:12] [config] train-embedder-rank:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] train-sets:
[2023-07-27 23:45:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-27 23:45:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-27 23:45:12] [config] transformer-aan-activation: swish
[2023-07-27 23:45:12] [config] transformer-aan-depth: 2
[2023-07-27 23:45:12] [config] transformer-aan-nogate: false
[2023-07-27 23:45:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-27 23:45:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-27 23:45:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-27 23:45:12] [config] transformer-depth-scaling: false
[2023-07-27 23:45:12] [config] transformer-dim-aan: 2048
[2023-07-27 23:45:12] [config] transformer-dim-ffn: 2048
[2023-07-27 23:45:12] [config] transformer-dropout: 0
[2023-07-27 23:45:12] [config] transformer-dropout-attention: 0
[2023-07-27 23:45:12] [config] transformer-dropout-ffn: 0
[2023-07-27 23:45:12] [config] transformer-ffn-activation: swish
[2023-07-27 23:45:12] [config] transformer-ffn-depth: 2
[2023-07-27 23:45:12] [config] transformer-guided-alignment-layer: last
[2023-07-27 23:45:12] [config] transformer-heads: 8
[2023-07-27 23:45:12] [config] transformer-no-projection: false
[2023-07-27 23:45:12] [config] transformer-pool: false
[2023-07-27 23:45:12] [config] transformer-postprocess: dan
[2023-07-27 23:45:12] [config] transformer-postprocess-emb: d
[2023-07-27 23:45:12] [config] transformer-postprocess-top: ""
[2023-07-27 23:45:12] [config] transformer-preprocess: ""
[2023-07-27 23:45:12] [config] transformer-tied-layers:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] transformer-train-position-embeddings: false
[2023-07-27 23:45:12] [config] tsv: false
[2023-07-27 23:45:12] [config] tsv-fields: 0
[2023-07-27 23:45:12] [config] type: s2s
[2023-07-27 23:45:12] [config] ulr: false
[2023-07-27 23:45:12] [config] ulr-dim-emb: 0
[2023-07-27 23:45:12] [config] ulr-dropout: 0
[2023-07-27 23:45:12] [config] ulr-keys-vectors: ""
[2023-07-27 23:45:12] [config] ulr-query-vectors: ""
[2023-07-27 23:45:12] [config] ulr-softmax-temperature: 1
[2023-07-27 23:45:12] [config] ulr-trainable-transformation: false
[2023-07-27 23:45:12] [config] unlikelihood-loss: false
[2023-07-27 23:45:12] [config] valid-freq: 50000000
[2023-07-27 23:45:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-27 23:45:12] [config] valid-max-length: 1000
[2023-07-27 23:45:12] [config] valid-metrics:
[2023-07-27 23:45:12] [config]   - translation
[2023-07-27 23:45:12] [config] valid-mini-batch: 32
[2023-07-27 23:45:12] [config] valid-reset-stalled: false
[2023-07-27 23:45:12] [config] valid-script-args:
[2023-07-27 23:45:12] [config]   []
[2023-07-27 23:45:12] [config] valid-script-path: ""
[2023-07-27 23:45:12] [config] valid-sets:
[2023-07-27 23:45:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-27 23:45:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-27 23:45:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-27 23:45:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:45:12] [config] vocabs:
[2023-07-27 23:45:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:45:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:45:12] [config] word-penalty: 0
[2023-07-27 23:45:12] [config] word-scores: false
[2023-07-27 23:45:12] [config] workspace: 5500
[2023-07-27 23:45:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-27 23:45:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:45:12] [training] Using single-device training
[2023-07-27 23:45:13] Synced seed 1234
[2023-07-27 23:45:13] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-27 23:45:13] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-27 23:45:13] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-27 23:45:13] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-27 23:45:13] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-27 23:45:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-27 23:45:13] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-27 23:45:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-27 23:45:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-27 23:45:13] [comm] Using global sharding
[2023-07-27 23:45:13] [comm] NCCLCommunicators constructed successfully
[2023-07-27 23:45:13] [training] Using 1 GPUs
[2023-07-27 23:45:13] [logits] Applying loss function for 1 factor(s)
[2023-07-27 23:45:13] [memory] Reserving 80 MB, device gpu0
[2023-07-27 23:45:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-27 23:45:14] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:34:19] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 00:34:19] [valid] No post-processing script given for validating translator
[2023-07-28 00:34:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 00:34:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 00:34:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 00:34:19] [comm] Using global sharding
[2023-07-28 00:34:20] [comm] NCCLCommunicators constructed successfully
[2023-07-28 00:34:20] [training] Using 1 GPUs
[2023-07-28 00:34:20] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 00:34:27] Allocating memory for general optimizer shards
[2023-07-28 00:34:27] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:34:27] Loading Adam parameters
[2023-07-28 00:34:27] [memory] Reserving 322 MB, device gpu0
[2023-07-28 00:34:27] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:34:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 00:34:27] [data] Restoring the corpus state to epoch 101, batch 3879
[2023-07-28 00:34:27] [data] Shuffling data
[2023-07-28 00:34:27] [data] Done reading 20,192 sentences
[2023-07-28 00:34:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:34:27] Training started
[2023-07-28 00:34:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 00:34:28] [memory] Reserving 80 MB, device gpu0
[2023-07-28 00:34:34] Parameter type float16, optimization type float32, casting types true
[2023-07-28 00:39:16] Seen 20,192 samples
[2023-07-28 00:39:16] Starting data epoch 102 in logical epoch 102
[2023-07-28 00:39:16] [data] Shuffling data
[2023-07-28 00:39:16] [data] Done reading 20,192 sentences
[2023-07-28 00:39:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:44:12] Seen 20,192 samples
[2023-07-28 00:44:12] Starting data epoch 103 in logical epoch 103
[2023-07-28 00:44:12] [data] Shuffling data
[2023-07-28 00:44:12] [data] Done reading 20,192 sentences
[2023-07-28 00:44:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:49:19] Seen 20,192 samples
[2023-07-28 00:49:19] Starting data epoch 104 in logical epoch 104
[2023-07-28 00:49:19] [data] Shuffling data
[2023-07-28 00:49:19] [data] Done reading 20,192 sentences
[2023-07-28 00:49:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:49:58] Ep. 104 : Up. 4000 : Sen. 2,220 : Cost 3.95473099 * 15,923,925 @ 17,433 after 63,975,575 : Time 938.94s : 16959.39 words/s : gNorm 1.2333
[2023-07-28 00:53:49] Seen 20,192 samples
[2023-07-28 00:53:49] Starting data epoch 105 in logical epoch 105
[2023-07-28 00:53:49] [data] Shuffling data
[2023-07-28 00:53:49] [data] Done reading 20,192 sentences
[2023-07-28 00:53:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 00:58:17] Seen 20,192 samples
[2023-07-28 00:58:17] Starting data epoch 106 in logical epoch 106
[2023-07-28 00:58:17] [data] Shuffling data
[2023-07-28 00:58:17] [data] Done reading 20,192 sentences
[2023-07-28 00:58:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:02:46] Seen 20,192 samples
[2023-07-28 01:02:46] Starting data epoch 107 in logical epoch 107
[2023-07-28 01:02:46] [data] Shuffling data
[2023-07-28 01:02:46] [data] Done reading 20,192 sentences
[2023-07-28 01:02:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:07:21] Seen 20,192 samples
[2023-07-28 01:07:21] Starting data epoch 108 in logical epoch 108
[2023-07-28 01:07:21] [data] Shuffling data
[2023-07-28 01:07:21] [data] Done reading 20,192 sentences
[2023-07-28 01:07:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:12:21] Seen 20,192 samples
[2023-07-28 01:12:21] Starting data epoch 109 in logical epoch 109
[2023-07-28 01:12:21] [data] Shuffling data
[2023-07-28 01:12:21] [data] Done reading 20,192 sentences
[2023-07-28 01:12:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:17:13] Seen 20,192 samples
[2023-07-28 01:17:13] Starting data epoch 110 in logical epoch 110
[2023-07-28 01:17:13] [data] Shuffling data
[2023-07-28 01:17:13] [data] Done reading 20,192 sentences
[2023-07-28 01:17:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 01:21:59] Seen 20,192 samples
[2023-07-28 01:21:59] Starting data epoch 111 in logical epoch 111
[2023-07-28 01:21:59] Training finished
[2023-07-28 01:24:34] [valid] Ep. 111 : Up. 4265 : translation : 0 : new best
[2023-07-28 01:24:34] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 01:24:36] Saving Adam parameters
[2023-07-28 01:24:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 01:24:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:24:43] [marian] Running on node18.datos.cluster.uy as process 31261 with command line:
[2023-07-28 01:24:43] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 01:24:43] [config] after: 0e
[2023-07-28 01:24:43] [config] after-batches: 0
[2023-07-28 01:24:43] [config] after-epochs: 120
[2023-07-28 01:24:43] [config] all-caps-every: 0
[2023-07-28 01:24:43] [config] allow-unk: false
[2023-07-28 01:24:43] [config] authors: false
[2023-07-28 01:24:43] [config] beam-size: 12
[2023-07-28 01:24:43] [config] bert-class-symbol: "[CLS]"
[2023-07-28 01:24:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 01:24:43] [config] bert-masking-fraction: 0.15
[2023-07-28 01:24:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 01:24:43] [config] bert-train-type-embeddings: true
[2023-07-28 01:24:43] [config] bert-type-vocab-size: 2
[2023-07-28 01:24:43] [config] build-info: ""
[2023-07-28 01:24:43] [config] check-gradient-nan: false
[2023-07-28 01:24:43] [config] check-nan: false
[2023-07-28 01:24:43] [config] cite: false
[2023-07-28 01:24:43] [config] clip-norm: 1
[2023-07-28 01:24:43] [config] cost-scaling:
[2023-07-28 01:24:43] [config]   - 256.f
[2023-07-28 01:24:43] [config]   - 1000
[2023-07-28 01:24:43] [config]   - 2.f
[2023-07-28 01:24:43] [config]   - 256.f
[2023-07-28 01:24:43] [config] cost-type: ce-sum
[2023-07-28 01:24:43] [config] cpu-threads: 0
[2023-07-28 01:24:43] [config] data-threads: 8
[2023-07-28 01:24:43] [config] data-weighting: ""
[2023-07-28 01:24:43] [config] data-weighting-type: sentence
[2023-07-28 01:24:43] [config] dec-cell: gru
[2023-07-28 01:24:43] [config] dec-cell-base-depth: 2
[2023-07-28 01:24:43] [config] dec-cell-high-depth: 1
[2023-07-28 01:24:43] [config] dec-depth: 1
[2023-07-28 01:24:43] [config] devices:
[2023-07-28 01:24:43] [config]   - 0
[2023-07-28 01:24:43] [config] dim-emb: 512
[2023-07-28 01:24:43] [config] dim-rnn: 1024
[2023-07-28 01:24:43] [config] dim-vocabs:
[2023-07-28 01:24:43] [config]   - 16384
[2023-07-28 01:24:43] [config]   - 16384
[2023-07-28 01:24:43] [config] disp-first: 0
[2023-07-28 01:24:43] [config] disp-freq: 1000u
[2023-07-28 01:24:43] [config] disp-label-counts: true
[2023-07-28 01:24:43] [config] dropout-rnn: 0
[2023-07-28 01:24:43] [config] dropout-src: 0
[2023-07-28 01:24:43] [config] dropout-trg: 0
[2023-07-28 01:24:43] [config] dump-config: ""
[2023-07-28 01:24:43] [config] dynamic-gradient-scaling:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] early-stopping: 1000
[2023-07-28 01:24:43] [config] early-stopping-on: first
[2023-07-28 01:24:43] [config] embedding-fix-src: false
[2023-07-28 01:24:43] [config] embedding-fix-trg: false
[2023-07-28 01:24:43] [config] embedding-normalization: false
[2023-07-28 01:24:43] [config] embedding-vectors:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] enc-cell: gru
[2023-07-28 01:24:43] [config] enc-cell-depth: 1
[2023-07-28 01:24:43] [config] enc-depth: 1
[2023-07-28 01:24:43] [config] enc-type: bidirectional
[2023-07-28 01:24:43] [config] english-title-case-every: 0
[2023-07-28 01:24:43] [config] exponential-smoothing: 0
[2023-07-28 01:24:43] [config] factor-weight: 1
[2023-07-28 01:24:43] [config] factors-combine: sum
[2023-07-28 01:24:43] [config] factors-dim-emb: 0
[2023-07-28 01:24:43] [config] gradient-checkpointing: false
[2023-07-28 01:24:43] [config] gradient-norm-average-window: 100
[2023-07-28 01:24:43] [config] guided-alignment: none
[2023-07-28 01:24:43] [config] guided-alignment-cost: mse
[2023-07-28 01:24:43] [config] guided-alignment-weight: 0.1
[2023-07-28 01:24:43] [config] ignore-model-config: false
[2023-07-28 01:24:43] [config] input-types:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] interpolate-env-vars: false
[2023-07-28 01:24:43] [config] keep-best: false
[2023-07-28 01:24:43] [config] label-smoothing: 0
[2023-07-28 01:24:43] [config] layer-normalization: false
[2023-07-28 01:24:43] [config] learn-rate: 0.0001
[2023-07-28 01:24:43] [config] lemma-dependency: ""
[2023-07-28 01:24:43] [config] lemma-dim-emb: 0
[2023-07-28 01:24:43] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 01:24:43] [config] log-level: info
[2023-07-28 01:24:43] [config] log-time-zone: ""
[2023-07-28 01:24:43] [config] logical-epoch:
[2023-07-28 01:24:43] [config]   - 1e
[2023-07-28 01:24:43] [config]   - 0
[2023-07-28 01:24:43] [config] lr-decay: 0
[2023-07-28 01:24:43] [config] lr-decay-freq: 50000
[2023-07-28 01:24:43] [config] lr-decay-inv-sqrt:
[2023-07-28 01:24:43] [config]   - 0
[2023-07-28 01:24:43] [config] lr-decay-repeat-warmup: false
[2023-07-28 01:24:43] [config] lr-decay-reset-optimizer: false
[2023-07-28 01:24:43] [config] lr-decay-start:
[2023-07-28 01:24:43] [config]   - 10
[2023-07-28 01:24:43] [config]   - 1
[2023-07-28 01:24:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 01:24:43] [config] lr-report: false
[2023-07-28 01:24:43] [config] lr-warmup: 0
[2023-07-28 01:24:43] [config] lr-warmup-at-reload: false
[2023-07-28 01:24:43] [config] lr-warmup-cycle: false
[2023-07-28 01:24:43] [config] lr-warmup-start-rate: 0
[2023-07-28 01:24:43] [config] max-length: 250
[2023-07-28 01:24:43] [config] max-length-crop: true
[2023-07-28 01:24:43] [config] max-length-factor: 3
[2023-07-28 01:24:43] [config] maxi-batch: 100
[2023-07-28 01:24:43] [config] maxi-batch-sort: trg
[2023-07-28 01:24:43] [config] mini-batch: 64
[2023-07-28 01:24:43] [config] mini-batch-fit: true
[2023-07-28 01:24:43] [config] mini-batch-fit-step: 10
[2023-07-28 01:24:43] [config] mini-batch-round-up: true
[2023-07-28 01:24:43] [config] mini-batch-track-lr: false
[2023-07-28 01:24:43] [config] mini-batch-warmup: 0
[2023-07-28 01:24:43] [config] mini-batch-words: 0
[2023-07-28 01:24:43] [config] mini-batch-words-ref: 0
[2023-07-28 01:24:43] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 01:24:43] [config] multi-loss-type: sum
[2023-07-28 01:24:43] [config] n-best: false
[2023-07-28 01:24:43] [config] no-nccl: false
[2023-07-28 01:24:43] [config] no-reload: false
[2023-07-28 01:24:43] [config] no-restore-corpus: false
[2023-07-28 01:24:43] [config] normalize: 0
[2023-07-28 01:24:43] [config] normalize-gradient: false
[2023-07-28 01:24:43] [config] num-devices: 0
[2023-07-28 01:24:43] [config] optimizer: adam
[2023-07-28 01:24:43] [config] optimizer-delay: 1
[2023-07-28 01:24:43] [config] optimizer-params:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] output-omit-bias: false
[2023-07-28 01:24:43] [config] overwrite: true
[2023-07-28 01:24:43] [config] precision:
[2023-07-28 01:24:43] [config]   - float16
[2023-07-28 01:24:43] [config]   - float32
[2023-07-28 01:24:43] [config] pretrained-model: ""
[2023-07-28 01:24:43] [config] quantize-biases: false
[2023-07-28 01:24:43] [config] quantize-bits: 0
[2023-07-28 01:24:43] [config] quantize-log-based: false
[2023-07-28 01:24:43] [config] quantize-optimization-steps: 0
[2023-07-28 01:24:43] [config] quiet: false
[2023-07-28 01:24:43] [config] quiet-translation: true
[2023-07-28 01:24:43] [config] relative-paths: false
[2023-07-28 01:24:43] [config] right-left: false
[2023-07-28 01:24:43] [config] save-freq: 10000u
[2023-07-28 01:24:43] [config] seed: 1234
[2023-07-28 01:24:43] [config] sentencepiece-alphas:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] sentencepiece-max-lines: 2000000
[2023-07-28 01:24:43] [config] sentencepiece-options: ""
[2023-07-28 01:24:43] [config] sharding: global
[2023-07-28 01:24:43] [config] shuffle: data
[2023-07-28 01:24:43] [config] shuffle-in-ram: false
[2023-07-28 01:24:43] [config] sigterm: save-and-exit
[2023-07-28 01:24:43] [config] skip: false
[2023-07-28 01:24:43] [config] sqlite: ""
[2023-07-28 01:24:43] [config] sqlite-drop: false
[2023-07-28 01:24:43] [config] sync-freq: 200u
[2023-07-28 01:24:43] [config] sync-sgd: false
[2023-07-28 01:24:43] [config] tempdir: /tmp
[2023-07-28 01:24:43] [config] tied-embeddings: false
[2023-07-28 01:24:43] [config] tied-embeddings-all: true
[2023-07-28 01:24:43] [config] tied-embeddings-src: false
[2023-07-28 01:24:43] [config] train-embedder-rank:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] train-sets:
[2023-07-28 01:24:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 01:24:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 01:24:43] [config] transformer-aan-activation: swish
[2023-07-28 01:24:43] [config] transformer-aan-depth: 2
[2023-07-28 01:24:43] [config] transformer-aan-nogate: false
[2023-07-28 01:24:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 01:24:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 01:24:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 01:24:43] [config] transformer-depth-scaling: false
[2023-07-28 01:24:43] [config] transformer-dim-aan: 2048
[2023-07-28 01:24:43] [config] transformer-dim-ffn: 2048
[2023-07-28 01:24:43] [config] transformer-dropout: 0
[2023-07-28 01:24:43] [config] transformer-dropout-attention: 0
[2023-07-28 01:24:43] [config] transformer-dropout-ffn: 0
[2023-07-28 01:24:43] [config] transformer-ffn-activation: swish
[2023-07-28 01:24:43] [config] transformer-ffn-depth: 2
[2023-07-28 01:24:43] [config] transformer-guided-alignment-layer: last
[2023-07-28 01:24:43] [config] transformer-heads: 8
[2023-07-28 01:24:43] [config] transformer-no-projection: false
[2023-07-28 01:24:43] [config] transformer-pool: false
[2023-07-28 01:24:43] [config] transformer-postprocess: dan
[2023-07-28 01:24:43] [config] transformer-postprocess-emb: d
[2023-07-28 01:24:43] [config] transformer-postprocess-top: ""
[2023-07-28 01:24:43] [config] transformer-preprocess: ""
[2023-07-28 01:24:43] [config] transformer-tied-layers:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] transformer-train-position-embeddings: false
[2023-07-28 01:24:43] [config] tsv: false
[2023-07-28 01:24:43] [config] tsv-fields: 0
[2023-07-28 01:24:43] [config] type: s2s
[2023-07-28 01:24:43] [config] ulr: false
[2023-07-28 01:24:43] [config] ulr-dim-emb: 0
[2023-07-28 01:24:43] [config] ulr-dropout: 0
[2023-07-28 01:24:43] [config] ulr-keys-vectors: ""
[2023-07-28 01:24:43] [config] ulr-query-vectors: ""
[2023-07-28 01:24:43] [config] ulr-softmax-temperature: 1
[2023-07-28 01:24:43] [config] ulr-trainable-transformation: false
[2023-07-28 01:24:43] [config] unlikelihood-loss: false
[2023-07-28 01:24:43] [config] valid-freq: 50000000
[2023-07-28 01:24:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 01:24:43] [config] valid-max-length: 1000
[2023-07-28 01:24:43] [config] valid-metrics:
[2023-07-28 01:24:43] [config]   - translation
[2023-07-28 01:24:43] [config] valid-mini-batch: 32
[2023-07-28 01:24:43] [config] valid-reset-stalled: false
[2023-07-28 01:24:43] [config] valid-script-args:
[2023-07-28 01:24:43] [config]   []
[2023-07-28 01:24:43] [config] valid-script-path: ""
[2023-07-28 01:24:43] [config] valid-sets:
[2023-07-28 01:24:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 01:24:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 01:24:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 01:24:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:24:43] [config] vocabs:
[2023-07-28 01:24:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:24:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:24:43] [config] word-penalty: 0
[2023-07-28 01:24:43] [config] word-scores: false
[2023-07-28 01:24:43] [config] workspace: 5500
[2023-07-28 01:24:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 01:24:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:24:43] [training] Using single-device training
[2023-07-28 01:24:43] Synced seed 1234
[2023-07-28 01:24:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 01:24:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 01:24:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 01:24:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 01:24:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 01:24:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 01:24:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 01:24:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 01:24:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 01:24:44] [comm] Using global sharding
[2023-07-28 01:24:44] [comm] NCCLCommunicators constructed successfully
[2023-07-28 01:24:44] [training] Using 1 GPUs
[2023-07-28 01:24:44] [logits] Applying loss function for 1 factor(s)
[2023-07-28 01:24:44] [memory] Reserving 80 MB, device gpu0
[2023-07-28 01:24:44] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 01:24:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:12:44] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 02:12:44] [valid] No post-processing script given for validating translator
[2023-07-28 02:12:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:12:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:12:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:12:44] [comm] Using global sharding
[2023-07-28 02:12:44] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:12:44] [training] Using 1 GPUs
[2023-07-28 02:12:44] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 02:12:45] Allocating memory for general optimizer shards
[2023-07-28 02:12:45] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:12:45] Loading Adam parameters
[2023-07-28 02:12:45] [memory] Reserving 322 MB, device gpu0
[2023-07-28 02:12:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:12:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 02:12:46] [data] Restoring the corpus state to epoch 121, batch 4654
[2023-07-28 02:12:46] [data] Shuffling data
[2023-07-28 02:12:46] [data] Done reading 20,192 sentences
[2023-07-28 02:12:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 02:12:46] Training started
[2023-07-28 02:12:46] Training finished
[2023-07-28 02:12:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:12:50] [marian] Running on node18.datos.cluster.uy as process 34196 with command line:
[2023-07-28 02:12:50] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 02:12:50] [config] after: 0e
[2023-07-28 02:12:50] [config] after-batches: 0
[2023-07-28 02:12:50] [config] after-epochs: 130
[2023-07-28 02:12:50] [config] all-caps-every: 0
[2023-07-28 02:12:50] [config] allow-unk: false
[2023-07-28 02:12:50] [config] authors: false
[2023-07-28 02:12:50] [config] beam-size: 12
[2023-07-28 02:12:50] [config] bert-class-symbol: "[CLS]"
[2023-07-28 02:12:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 02:12:50] [config] bert-masking-fraction: 0.15
[2023-07-28 02:12:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 02:12:50] [config] bert-train-type-embeddings: true
[2023-07-28 02:12:50] [config] bert-type-vocab-size: 2
[2023-07-28 02:12:50] [config] build-info: ""
[2023-07-28 02:12:50] [config] check-gradient-nan: false
[2023-07-28 02:12:50] [config] check-nan: false
[2023-07-28 02:12:50] [config] cite: false
[2023-07-28 02:12:50] [config] clip-norm: 1
[2023-07-28 02:12:50] [config] cost-scaling:
[2023-07-28 02:12:50] [config]   - 256.f
[2023-07-28 02:12:50] [config]   - 1000
[2023-07-28 02:12:50] [config]   - 2.f
[2023-07-28 02:12:50] [config]   - 256.f
[2023-07-28 02:12:50] [config] cost-type: ce-sum
[2023-07-28 02:12:50] [config] cpu-threads: 0
[2023-07-28 02:12:50] [config] data-threads: 8
[2023-07-28 02:12:50] [config] data-weighting: ""
[2023-07-28 02:12:50] [config] data-weighting-type: sentence
[2023-07-28 02:12:50] [config] dec-cell: gru
[2023-07-28 02:12:50] [config] dec-cell-base-depth: 2
[2023-07-28 02:12:50] [config] dec-cell-high-depth: 1
[2023-07-28 02:12:50] [config] dec-depth: 1
[2023-07-28 02:12:50] [config] devices:
[2023-07-28 02:12:50] [config]   - 0
[2023-07-28 02:12:50] [config] dim-emb: 512
[2023-07-28 02:12:50] [config] dim-rnn: 1024
[2023-07-28 02:12:50] [config] dim-vocabs:
[2023-07-28 02:12:50] [config]   - 16384
[2023-07-28 02:12:50] [config]   - 16384
[2023-07-28 02:12:50] [config] disp-first: 0
[2023-07-28 02:12:50] [config] disp-freq: 1000u
[2023-07-28 02:12:50] [config] disp-label-counts: true
[2023-07-28 02:12:50] [config] dropout-rnn: 0
[2023-07-28 02:12:50] [config] dropout-src: 0
[2023-07-28 02:12:50] [config] dropout-trg: 0
[2023-07-28 02:12:50] [config] dump-config: ""
[2023-07-28 02:12:50] [config] dynamic-gradient-scaling:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] early-stopping: 1000
[2023-07-28 02:12:50] [config] early-stopping-on: first
[2023-07-28 02:12:50] [config] embedding-fix-src: false
[2023-07-28 02:12:50] [config] embedding-fix-trg: false
[2023-07-28 02:12:50] [config] embedding-normalization: false
[2023-07-28 02:12:50] [config] embedding-vectors:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] enc-cell: gru
[2023-07-28 02:12:50] [config] enc-cell-depth: 1
[2023-07-28 02:12:50] [config] enc-depth: 1
[2023-07-28 02:12:50] [config] enc-type: bidirectional
[2023-07-28 02:12:50] [config] english-title-case-every: 0
[2023-07-28 02:12:50] [config] exponential-smoothing: 0
[2023-07-28 02:12:50] [config] factor-weight: 1
[2023-07-28 02:12:50] [config] factors-combine: sum
[2023-07-28 02:12:50] [config] factors-dim-emb: 0
[2023-07-28 02:12:50] [config] gradient-checkpointing: false
[2023-07-28 02:12:50] [config] gradient-norm-average-window: 100
[2023-07-28 02:12:50] [config] guided-alignment: none
[2023-07-28 02:12:50] [config] guided-alignment-cost: mse
[2023-07-28 02:12:50] [config] guided-alignment-weight: 0.1
[2023-07-28 02:12:50] [config] ignore-model-config: false
[2023-07-28 02:12:50] [config] input-types:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] interpolate-env-vars: false
[2023-07-28 02:12:50] [config] keep-best: false
[2023-07-28 02:12:50] [config] label-smoothing: 0
[2023-07-28 02:12:50] [config] layer-normalization: false
[2023-07-28 02:12:50] [config] learn-rate: 0.0001
[2023-07-28 02:12:50] [config] lemma-dependency: ""
[2023-07-28 02:12:50] [config] lemma-dim-emb: 0
[2023-07-28 02:12:50] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 02:12:50] [config] log-level: info
[2023-07-28 02:12:50] [config] log-time-zone: ""
[2023-07-28 02:12:50] [config] logical-epoch:
[2023-07-28 02:12:50] [config]   - 1e
[2023-07-28 02:12:50] [config]   - 0
[2023-07-28 02:12:50] [config] lr-decay: 0
[2023-07-28 02:12:50] [config] lr-decay-freq: 50000
[2023-07-28 02:12:50] [config] lr-decay-inv-sqrt:
[2023-07-28 02:12:50] [config]   - 0
[2023-07-28 02:12:50] [config] lr-decay-repeat-warmup: false
[2023-07-28 02:12:50] [config] lr-decay-reset-optimizer: false
[2023-07-28 02:12:50] [config] lr-decay-start:
[2023-07-28 02:12:50] [config]   - 10
[2023-07-28 02:12:50] [config]   - 1
[2023-07-28 02:12:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 02:12:50] [config] lr-report: false
[2023-07-28 02:12:50] [config] lr-warmup: 0
[2023-07-28 02:12:50] [config] lr-warmup-at-reload: false
[2023-07-28 02:12:50] [config] lr-warmup-cycle: false
[2023-07-28 02:12:50] [config] lr-warmup-start-rate: 0
[2023-07-28 02:12:50] [config] max-length: 250
[2023-07-28 02:12:50] [config] max-length-crop: true
[2023-07-28 02:12:50] [config] max-length-factor: 3
[2023-07-28 02:12:50] [config] maxi-batch: 100
[2023-07-28 02:12:50] [config] maxi-batch-sort: trg
[2023-07-28 02:12:50] [config] mini-batch: 64
[2023-07-28 02:12:50] [config] mini-batch-fit: true
[2023-07-28 02:12:50] [config] mini-batch-fit-step: 10
[2023-07-28 02:12:50] [config] mini-batch-round-up: true
[2023-07-28 02:12:50] [config] mini-batch-track-lr: false
[2023-07-28 02:12:50] [config] mini-batch-warmup: 0
[2023-07-28 02:12:50] [config] mini-batch-words: 0
[2023-07-28 02:12:50] [config] mini-batch-words-ref: 0
[2023-07-28 02:12:50] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 02:12:50] [config] multi-loss-type: sum
[2023-07-28 02:12:50] [config] n-best: false
[2023-07-28 02:12:50] [config] no-nccl: false
[2023-07-28 02:12:50] [config] no-reload: false
[2023-07-28 02:12:50] [config] no-restore-corpus: false
[2023-07-28 02:12:50] [config] normalize: 0
[2023-07-28 02:12:50] [config] normalize-gradient: false
[2023-07-28 02:12:50] [config] num-devices: 0
[2023-07-28 02:12:50] [config] optimizer: adam
[2023-07-28 02:12:50] [config] optimizer-delay: 1
[2023-07-28 02:12:50] [config] optimizer-params:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] output-omit-bias: false
[2023-07-28 02:12:50] [config] overwrite: true
[2023-07-28 02:12:50] [config] precision:
[2023-07-28 02:12:50] [config]   - float16
[2023-07-28 02:12:50] [config]   - float32
[2023-07-28 02:12:50] [config] pretrained-model: ""
[2023-07-28 02:12:50] [config] quantize-biases: false
[2023-07-28 02:12:50] [config] quantize-bits: 0
[2023-07-28 02:12:50] [config] quantize-log-based: false
[2023-07-28 02:12:50] [config] quantize-optimization-steps: 0
[2023-07-28 02:12:50] [config] quiet: false
[2023-07-28 02:12:50] [config] quiet-translation: true
[2023-07-28 02:12:50] [config] relative-paths: false
[2023-07-28 02:12:50] [config] right-left: false
[2023-07-28 02:12:50] [config] save-freq: 10000u
[2023-07-28 02:12:50] [config] seed: 1234
[2023-07-28 02:12:50] [config] sentencepiece-alphas:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] sentencepiece-max-lines: 2000000
[2023-07-28 02:12:50] [config] sentencepiece-options: ""
[2023-07-28 02:12:50] [config] sharding: global
[2023-07-28 02:12:50] [config] shuffle: data
[2023-07-28 02:12:50] [config] shuffle-in-ram: false
[2023-07-28 02:12:50] [config] sigterm: save-and-exit
[2023-07-28 02:12:50] [config] skip: false
[2023-07-28 02:12:50] [config] sqlite: ""
[2023-07-28 02:12:50] [config] sqlite-drop: false
[2023-07-28 02:12:50] [config] sync-freq: 200u
[2023-07-28 02:12:50] [config] sync-sgd: false
[2023-07-28 02:12:50] [config] tempdir: /tmp
[2023-07-28 02:12:50] [config] tied-embeddings: false
[2023-07-28 02:12:50] [config] tied-embeddings-all: true
[2023-07-28 02:12:50] [config] tied-embeddings-src: false
[2023-07-28 02:12:50] [config] train-embedder-rank:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] train-sets:
[2023-07-28 02:12:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 02:12:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 02:12:50] [config] transformer-aan-activation: swish
[2023-07-28 02:12:50] [config] transformer-aan-depth: 2
[2023-07-28 02:12:50] [config] transformer-aan-nogate: false
[2023-07-28 02:12:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 02:12:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 02:12:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 02:12:50] [config] transformer-depth-scaling: false
[2023-07-28 02:12:50] [config] transformer-dim-aan: 2048
[2023-07-28 02:12:50] [config] transformer-dim-ffn: 2048
[2023-07-28 02:12:50] [config] transformer-dropout: 0
[2023-07-28 02:12:50] [config] transformer-dropout-attention: 0
[2023-07-28 02:12:50] [config] transformer-dropout-ffn: 0
[2023-07-28 02:12:50] [config] transformer-ffn-activation: swish
[2023-07-28 02:12:50] [config] transformer-ffn-depth: 2
[2023-07-28 02:12:50] [config] transformer-guided-alignment-layer: last
[2023-07-28 02:12:50] [config] transformer-heads: 8
[2023-07-28 02:12:50] [config] transformer-no-projection: false
[2023-07-28 02:12:50] [config] transformer-pool: false
[2023-07-28 02:12:50] [config] transformer-postprocess: dan
[2023-07-28 02:12:50] [config] transformer-postprocess-emb: d
[2023-07-28 02:12:50] [config] transformer-postprocess-top: ""
[2023-07-28 02:12:50] [config] transformer-preprocess: ""
[2023-07-28 02:12:50] [config] transformer-tied-layers:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] transformer-train-position-embeddings: false
[2023-07-28 02:12:50] [config] tsv: false
[2023-07-28 02:12:50] [config] tsv-fields: 0
[2023-07-28 02:12:50] [config] type: s2s
[2023-07-28 02:12:50] [config] ulr: false
[2023-07-28 02:12:50] [config] ulr-dim-emb: 0
[2023-07-28 02:12:50] [config] ulr-dropout: 0
[2023-07-28 02:12:50] [config] ulr-keys-vectors: ""
[2023-07-28 02:12:50] [config] ulr-query-vectors: ""
[2023-07-28 02:12:50] [config] ulr-softmax-temperature: 1
[2023-07-28 02:12:50] [config] ulr-trainable-transformation: false
[2023-07-28 02:12:50] [config] unlikelihood-loss: false
[2023-07-28 02:12:50] [config] valid-freq: 50000000
[2023-07-28 02:12:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 02:12:50] [config] valid-max-length: 1000
[2023-07-28 02:12:50] [config] valid-metrics:
[2023-07-28 02:12:50] [config]   - translation
[2023-07-28 02:12:50] [config] valid-mini-batch: 32
[2023-07-28 02:12:50] [config] valid-reset-stalled: false
[2023-07-28 02:12:50] [config] valid-script-args:
[2023-07-28 02:12:50] [config]   []
[2023-07-28 02:12:50] [config] valid-script-path: ""
[2023-07-28 02:12:50] [config] valid-sets:
[2023-07-28 02:12:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 02:12:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 02:12:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 02:12:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:12:50] [config] vocabs:
[2023-07-28 02:12:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:12:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:12:50] [config] word-penalty: 0
[2023-07-28 02:12:50] [config] word-scores: false
[2023-07-28 02:12:50] [config] workspace: 5500
[2023-07-28 02:12:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 02:12:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:12:50] [training] Using single-device training
[2023-07-28 02:12:50] Synced seed 1234
[2023-07-28 02:12:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 02:12:50] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 02:12:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 02:12:50] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 02:12:50] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 02:12:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 02:12:50] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 02:12:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 02:12:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 02:12:51] [comm] Using global sharding
[2023-07-28 02:12:51] [comm] NCCLCommunicators constructed successfully
[2023-07-28 02:12:51] [training] Using 1 GPUs
[2023-07-28 02:12:51] [logits] Applying loss function for 1 factor(s)
[2023-07-28 02:12:51] [memory] Reserving 80 MB, device gpu0
[2023-07-28 02:12:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 02:12:51] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:00:11] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 03:00:11] [valid] No post-processing script given for validating translator
[2023-07-28 03:00:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:00:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:00:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:00:11] [comm] Using global sharding
[2023-07-28 03:00:11] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:00:11] [training] Using 1 GPUs
[2023-07-28 03:00:11] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 03:00:14] Allocating memory for general optimizer shards
[2023-07-28 03:00:14] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:00:14] Loading Adam parameters
[2023-07-28 03:00:14] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:00:14] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:00:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 03:00:14] [data] Restoring the corpus state to epoch 131, batch 5041
[2023-07-28 03:00:14] [data] Shuffling data
[2023-07-28 03:00:14] [data] Done reading 20,192 sentences
[2023-07-28 03:00:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:00:14] Training started
[2023-07-28 03:00:14] Training finished
[2023-07-28 03:00:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:00:18] [marian] Running on node18.datos.cluster.uy as process 37450 with command line:
[2023-07-28 03:00:18] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 03:00:18] [config] after: 0e
[2023-07-28 03:00:18] [config] after-batches: 0
[2023-07-28 03:00:18] [config] after-epochs: 140
[2023-07-28 03:00:18] [config] all-caps-every: 0
[2023-07-28 03:00:18] [config] allow-unk: false
[2023-07-28 03:00:18] [config] authors: false
[2023-07-28 03:00:18] [config] beam-size: 12
[2023-07-28 03:00:18] [config] bert-class-symbol: "[CLS]"
[2023-07-28 03:00:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 03:00:18] [config] bert-masking-fraction: 0.15
[2023-07-28 03:00:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 03:00:18] [config] bert-train-type-embeddings: true
[2023-07-28 03:00:18] [config] bert-type-vocab-size: 2
[2023-07-28 03:00:18] [config] build-info: ""
[2023-07-28 03:00:18] [config] check-gradient-nan: false
[2023-07-28 03:00:18] [config] check-nan: false
[2023-07-28 03:00:18] [config] cite: false
[2023-07-28 03:00:18] [config] clip-norm: 1
[2023-07-28 03:00:18] [config] cost-scaling:
[2023-07-28 03:00:18] [config]   - 256.f
[2023-07-28 03:00:18] [config]   - 1000
[2023-07-28 03:00:18] [config]   - 2.f
[2023-07-28 03:00:18] [config]   - 256.f
[2023-07-28 03:00:18] [config] cost-type: ce-sum
[2023-07-28 03:00:18] [config] cpu-threads: 0
[2023-07-28 03:00:18] [config] data-threads: 8
[2023-07-28 03:00:18] [config] data-weighting: ""
[2023-07-28 03:00:18] [config] data-weighting-type: sentence
[2023-07-28 03:00:18] [config] dec-cell: gru
[2023-07-28 03:00:18] [config] dec-cell-base-depth: 2
[2023-07-28 03:00:18] [config] dec-cell-high-depth: 1
[2023-07-28 03:00:18] [config] dec-depth: 1
[2023-07-28 03:00:18] [config] devices:
[2023-07-28 03:00:18] [config]   - 0
[2023-07-28 03:00:18] [config] dim-emb: 512
[2023-07-28 03:00:18] [config] dim-rnn: 1024
[2023-07-28 03:00:18] [config] dim-vocabs:
[2023-07-28 03:00:18] [config]   - 16384
[2023-07-28 03:00:18] [config]   - 16384
[2023-07-28 03:00:18] [config] disp-first: 0
[2023-07-28 03:00:18] [config] disp-freq: 1000u
[2023-07-28 03:00:18] [config] disp-label-counts: true
[2023-07-28 03:00:18] [config] dropout-rnn: 0
[2023-07-28 03:00:18] [config] dropout-src: 0
[2023-07-28 03:00:18] [config] dropout-trg: 0
[2023-07-28 03:00:18] [config] dump-config: ""
[2023-07-28 03:00:18] [config] dynamic-gradient-scaling:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] early-stopping: 1000
[2023-07-28 03:00:18] [config] early-stopping-on: first
[2023-07-28 03:00:18] [config] embedding-fix-src: false
[2023-07-28 03:00:18] [config] embedding-fix-trg: false
[2023-07-28 03:00:18] [config] embedding-normalization: false
[2023-07-28 03:00:18] [config] embedding-vectors:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] enc-cell: gru
[2023-07-28 03:00:18] [config] enc-cell-depth: 1
[2023-07-28 03:00:18] [config] enc-depth: 1
[2023-07-28 03:00:18] [config] enc-type: bidirectional
[2023-07-28 03:00:18] [config] english-title-case-every: 0
[2023-07-28 03:00:18] [config] exponential-smoothing: 0
[2023-07-28 03:00:18] [config] factor-weight: 1
[2023-07-28 03:00:18] [config] factors-combine: sum
[2023-07-28 03:00:18] [config] factors-dim-emb: 0
[2023-07-28 03:00:18] [config] gradient-checkpointing: false
[2023-07-28 03:00:18] [config] gradient-norm-average-window: 100
[2023-07-28 03:00:18] [config] guided-alignment: none
[2023-07-28 03:00:18] [config] guided-alignment-cost: mse
[2023-07-28 03:00:18] [config] guided-alignment-weight: 0.1
[2023-07-28 03:00:18] [config] ignore-model-config: false
[2023-07-28 03:00:18] [config] input-types:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] interpolate-env-vars: false
[2023-07-28 03:00:18] [config] keep-best: false
[2023-07-28 03:00:18] [config] label-smoothing: 0
[2023-07-28 03:00:18] [config] layer-normalization: false
[2023-07-28 03:00:18] [config] learn-rate: 0.0001
[2023-07-28 03:00:18] [config] lemma-dependency: ""
[2023-07-28 03:00:18] [config] lemma-dim-emb: 0
[2023-07-28 03:00:18] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 03:00:18] [config] log-level: info
[2023-07-28 03:00:18] [config] log-time-zone: ""
[2023-07-28 03:00:18] [config] logical-epoch:
[2023-07-28 03:00:18] [config]   - 1e
[2023-07-28 03:00:18] [config]   - 0
[2023-07-28 03:00:18] [config] lr-decay: 0
[2023-07-28 03:00:18] [config] lr-decay-freq: 50000
[2023-07-28 03:00:18] [config] lr-decay-inv-sqrt:
[2023-07-28 03:00:18] [config]   - 0
[2023-07-28 03:00:18] [config] lr-decay-repeat-warmup: false
[2023-07-28 03:00:18] [config] lr-decay-reset-optimizer: false
[2023-07-28 03:00:18] [config] lr-decay-start:
[2023-07-28 03:00:18] [config]   - 10
[2023-07-28 03:00:18] [config]   - 1
[2023-07-28 03:00:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 03:00:18] [config] lr-report: false
[2023-07-28 03:00:18] [config] lr-warmup: 0
[2023-07-28 03:00:18] [config] lr-warmup-at-reload: false
[2023-07-28 03:00:18] [config] lr-warmup-cycle: false
[2023-07-28 03:00:18] [config] lr-warmup-start-rate: 0
[2023-07-28 03:00:18] [config] max-length: 250
[2023-07-28 03:00:18] [config] max-length-crop: true
[2023-07-28 03:00:18] [config] max-length-factor: 3
[2023-07-28 03:00:18] [config] maxi-batch: 100
[2023-07-28 03:00:18] [config] maxi-batch-sort: trg
[2023-07-28 03:00:18] [config] mini-batch: 64
[2023-07-28 03:00:18] [config] mini-batch-fit: true
[2023-07-28 03:00:18] [config] mini-batch-fit-step: 10
[2023-07-28 03:00:18] [config] mini-batch-round-up: true
[2023-07-28 03:00:18] [config] mini-batch-track-lr: false
[2023-07-28 03:00:18] [config] mini-batch-warmup: 0
[2023-07-28 03:00:18] [config] mini-batch-words: 0
[2023-07-28 03:00:18] [config] mini-batch-words-ref: 0
[2023-07-28 03:00:18] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 03:00:18] [config] multi-loss-type: sum
[2023-07-28 03:00:18] [config] n-best: false
[2023-07-28 03:00:18] [config] no-nccl: false
[2023-07-28 03:00:18] [config] no-reload: false
[2023-07-28 03:00:18] [config] no-restore-corpus: false
[2023-07-28 03:00:18] [config] normalize: 0
[2023-07-28 03:00:18] [config] normalize-gradient: false
[2023-07-28 03:00:18] [config] num-devices: 0
[2023-07-28 03:00:18] [config] optimizer: adam
[2023-07-28 03:00:18] [config] optimizer-delay: 1
[2023-07-28 03:00:18] [config] optimizer-params:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] output-omit-bias: false
[2023-07-28 03:00:18] [config] overwrite: true
[2023-07-28 03:00:18] [config] precision:
[2023-07-28 03:00:18] [config]   - float16
[2023-07-28 03:00:18] [config]   - float32
[2023-07-28 03:00:18] [config] pretrained-model: ""
[2023-07-28 03:00:18] [config] quantize-biases: false
[2023-07-28 03:00:18] [config] quantize-bits: 0
[2023-07-28 03:00:18] [config] quantize-log-based: false
[2023-07-28 03:00:18] [config] quantize-optimization-steps: 0
[2023-07-28 03:00:18] [config] quiet: false
[2023-07-28 03:00:18] [config] quiet-translation: true
[2023-07-28 03:00:18] [config] relative-paths: false
[2023-07-28 03:00:18] [config] right-left: false
[2023-07-28 03:00:18] [config] save-freq: 10000u
[2023-07-28 03:00:18] [config] seed: 1234
[2023-07-28 03:00:18] [config] sentencepiece-alphas:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] sentencepiece-max-lines: 2000000
[2023-07-28 03:00:18] [config] sentencepiece-options: ""
[2023-07-28 03:00:18] [config] sharding: global
[2023-07-28 03:00:18] [config] shuffle: data
[2023-07-28 03:00:18] [config] shuffle-in-ram: false
[2023-07-28 03:00:18] [config] sigterm: save-and-exit
[2023-07-28 03:00:18] [config] skip: false
[2023-07-28 03:00:18] [config] sqlite: ""
[2023-07-28 03:00:18] [config] sqlite-drop: false
[2023-07-28 03:00:18] [config] sync-freq: 200u
[2023-07-28 03:00:18] [config] sync-sgd: false
[2023-07-28 03:00:18] [config] tempdir: /tmp
[2023-07-28 03:00:18] [config] tied-embeddings: false
[2023-07-28 03:00:18] [config] tied-embeddings-all: true
[2023-07-28 03:00:18] [config] tied-embeddings-src: false
[2023-07-28 03:00:18] [config] train-embedder-rank:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] train-sets:
[2023-07-28 03:00:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 03:00:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 03:00:18] [config] transformer-aan-activation: swish
[2023-07-28 03:00:18] [config] transformer-aan-depth: 2
[2023-07-28 03:00:18] [config] transformer-aan-nogate: false
[2023-07-28 03:00:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 03:00:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 03:00:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 03:00:18] [config] transformer-depth-scaling: false
[2023-07-28 03:00:18] [config] transformer-dim-aan: 2048
[2023-07-28 03:00:18] [config] transformer-dim-ffn: 2048
[2023-07-28 03:00:18] [config] transformer-dropout: 0
[2023-07-28 03:00:18] [config] transformer-dropout-attention: 0
[2023-07-28 03:00:18] [config] transformer-dropout-ffn: 0
[2023-07-28 03:00:18] [config] transformer-ffn-activation: swish
[2023-07-28 03:00:18] [config] transformer-ffn-depth: 2
[2023-07-28 03:00:18] [config] transformer-guided-alignment-layer: last
[2023-07-28 03:00:18] [config] transformer-heads: 8
[2023-07-28 03:00:18] [config] transformer-no-projection: false
[2023-07-28 03:00:18] [config] transformer-pool: false
[2023-07-28 03:00:18] [config] transformer-postprocess: dan
[2023-07-28 03:00:18] [config] transformer-postprocess-emb: d
[2023-07-28 03:00:18] [config] transformer-postprocess-top: ""
[2023-07-28 03:00:18] [config] transformer-preprocess: ""
[2023-07-28 03:00:18] [config] transformer-tied-layers:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] transformer-train-position-embeddings: false
[2023-07-28 03:00:18] [config] tsv: false
[2023-07-28 03:00:18] [config] tsv-fields: 0
[2023-07-28 03:00:18] [config] type: s2s
[2023-07-28 03:00:18] [config] ulr: false
[2023-07-28 03:00:18] [config] ulr-dim-emb: 0
[2023-07-28 03:00:18] [config] ulr-dropout: 0
[2023-07-28 03:00:18] [config] ulr-keys-vectors: ""
[2023-07-28 03:00:18] [config] ulr-query-vectors: ""
[2023-07-28 03:00:18] [config] ulr-softmax-temperature: 1
[2023-07-28 03:00:18] [config] ulr-trainable-transformation: false
[2023-07-28 03:00:18] [config] unlikelihood-loss: false
[2023-07-28 03:00:18] [config] valid-freq: 50000000
[2023-07-28 03:00:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 03:00:18] [config] valid-max-length: 1000
[2023-07-28 03:00:18] [config] valid-metrics:
[2023-07-28 03:00:18] [config]   - translation
[2023-07-28 03:00:18] [config] valid-mini-batch: 32
[2023-07-28 03:00:18] [config] valid-reset-stalled: false
[2023-07-28 03:00:18] [config] valid-script-args:
[2023-07-28 03:00:18] [config]   []
[2023-07-28 03:00:18] [config] valid-script-path: ""
[2023-07-28 03:00:18] [config] valid-sets:
[2023-07-28 03:00:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 03:00:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 03:00:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 03:00:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:00:18] [config] vocabs:
[2023-07-28 03:00:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:00:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:00:18] [config] word-penalty: 0
[2023-07-28 03:00:18] [config] word-scores: false
[2023-07-28 03:00:18] [config] workspace: 5500
[2023-07-28 03:00:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:00:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:00:18] [training] Using single-device training
[2023-07-28 03:00:18] Synced seed 1234
[2023-07-28 03:00:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:00:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 03:00:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:00:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 03:00:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 03:00:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:00:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 03:00:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:00:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:00:19] [comm] Using global sharding
[2023-07-28 03:00:19] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:00:19] [training] Using 1 GPUs
[2023-07-28 03:00:19] [logits] Applying loss function for 1 factor(s)
[2023-07-28 03:00:19] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:00:19] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 03:00:20] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:48:45] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 03:48:45] [valid] No post-processing script given for validating translator
[2023-07-28 03:48:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:48:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:48:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:48:45] [comm] Using global sharding
[2023-07-28 03:48:45] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:48:45] [training] Using 1 GPUs
[2023-07-28 03:48:45] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 03:48:47] Allocating memory for general optimizer shards
[2023-07-28 03:48:47] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:48:47] Loading Adam parameters
[2023-07-28 03:48:47] [memory] Reserving 322 MB, device gpu0
[2023-07-28 03:48:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:48:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 03:48:47] [data] Restoring the corpus state to epoch 141, batch 5427
[2023-07-28 03:48:47] [data] Shuffling data
[2023-07-28 03:48:47] [data] Done reading 20,192 sentences
[2023-07-28 03:48:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 03:48:47] Training started
[2023-07-28 03:48:47] Training finished
[2023-07-28 03:48:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:48:51] [marian] Running on node18.datos.cluster.uy as process 40428 with command line:
[2023-07-28 03:48:51] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 03:48:51] [config] after: 0e
[2023-07-28 03:48:51] [config] after-batches: 0
[2023-07-28 03:48:51] [config] after-epochs: 150
[2023-07-28 03:48:51] [config] all-caps-every: 0
[2023-07-28 03:48:51] [config] allow-unk: false
[2023-07-28 03:48:51] [config] authors: false
[2023-07-28 03:48:51] [config] beam-size: 12
[2023-07-28 03:48:51] [config] bert-class-symbol: "[CLS]"
[2023-07-28 03:48:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 03:48:51] [config] bert-masking-fraction: 0.15
[2023-07-28 03:48:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 03:48:51] [config] bert-train-type-embeddings: true
[2023-07-28 03:48:51] [config] bert-type-vocab-size: 2
[2023-07-28 03:48:51] [config] build-info: ""
[2023-07-28 03:48:51] [config] check-gradient-nan: false
[2023-07-28 03:48:51] [config] check-nan: false
[2023-07-28 03:48:51] [config] cite: false
[2023-07-28 03:48:51] [config] clip-norm: 1
[2023-07-28 03:48:51] [config] cost-scaling:
[2023-07-28 03:48:51] [config]   - 256.f
[2023-07-28 03:48:51] [config]   - 1000
[2023-07-28 03:48:51] [config]   - 2.f
[2023-07-28 03:48:51] [config]   - 256.f
[2023-07-28 03:48:51] [config] cost-type: ce-sum
[2023-07-28 03:48:51] [config] cpu-threads: 0
[2023-07-28 03:48:51] [config] data-threads: 8
[2023-07-28 03:48:51] [config] data-weighting: ""
[2023-07-28 03:48:51] [config] data-weighting-type: sentence
[2023-07-28 03:48:51] [config] dec-cell: gru
[2023-07-28 03:48:51] [config] dec-cell-base-depth: 2
[2023-07-28 03:48:51] [config] dec-cell-high-depth: 1
[2023-07-28 03:48:51] [config] dec-depth: 1
[2023-07-28 03:48:51] [config] devices:
[2023-07-28 03:48:51] [config]   - 0
[2023-07-28 03:48:51] [config] dim-emb: 512
[2023-07-28 03:48:51] [config] dim-rnn: 1024
[2023-07-28 03:48:51] [config] dim-vocabs:
[2023-07-28 03:48:51] [config]   - 16384
[2023-07-28 03:48:51] [config]   - 16384
[2023-07-28 03:48:51] [config] disp-first: 0
[2023-07-28 03:48:51] [config] disp-freq: 1000u
[2023-07-28 03:48:51] [config] disp-label-counts: true
[2023-07-28 03:48:51] [config] dropout-rnn: 0
[2023-07-28 03:48:51] [config] dropout-src: 0
[2023-07-28 03:48:51] [config] dropout-trg: 0
[2023-07-28 03:48:51] [config] dump-config: ""
[2023-07-28 03:48:51] [config] dynamic-gradient-scaling:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] early-stopping: 1000
[2023-07-28 03:48:51] [config] early-stopping-on: first
[2023-07-28 03:48:51] [config] embedding-fix-src: false
[2023-07-28 03:48:51] [config] embedding-fix-trg: false
[2023-07-28 03:48:51] [config] embedding-normalization: false
[2023-07-28 03:48:51] [config] embedding-vectors:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] enc-cell: gru
[2023-07-28 03:48:51] [config] enc-cell-depth: 1
[2023-07-28 03:48:51] [config] enc-depth: 1
[2023-07-28 03:48:51] [config] enc-type: bidirectional
[2023-07-28 03:48:51] [config] english-title-case-every: 0
[2023-07-28 03:48:51] [config] exponential-smoothing: 0
[2023-07-28 03:48:51] [config] factor-weight: 1
[2023-07-28 03:48:51] [config] factors-combine: sum
[2023-07-28 03:48:51] [config] factors-dim-emb: 0
[2023-07-28 03:48:51] [config] gradient-checkpointing: false
[2023-07-28 03:48:51] [config] gradient-norm-average-window: 100
[2023-07-28 03:48:51] [config] guided-alignment: none
[2023-07-28 03:48:51] [config] guided-alignment-cost: mse
[2023-07-28 03:48:51] [config] guided-alignment-weight: 0.1
[2023-07-28 03:48:51] [config] ignore-model-config: false
[2023-07-28 03:48:51] [config] input-types:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] interpolate-env-vars: false
[2023-07-28 03:48:51] [config] keep-best: false
[2023-07-28 03:48:51] [config] label-smoothing: 0
[2023-07-28 03:48:51] [config] layer-normalization: false
[2023-07-28 03:48:51] [config] learn-rate: 0.0001
[2023-07-28 03:48:51] [config] lemma-dependency: ""
[2023-07-28 03:48:51] [config] lemma-dim-emb: 0
[2023-07-28 03:48:51] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 03:48:51] [config] log-level: info
[2023-07-28 03:48:51] [config] log-time-zone: ""
[2023-07-28 03:48:51] [config] logical-epoch:
[2023-07-28 03:48:51] [config]   - 1e
[2023-07-28 03:48:51] [config]   - 0
[2023-07-28 03:48:51] [config] lr-decay: 0
[2023-07-28 03:48:51] [config] lr-decay-freq: 50000
[2023-07-28 03:48:51] [config] lr-decay-inv-sqrt:
[2023-07-28 03:48:51] [config]   - 0
[2023-07-28 03:48:51] [config] lr-decay-repeat-warmup: false
[2023-07-28 03:48:51] [config] lr-decay-reset-optimizer: false
[2023-07-28 03:48:51] [config] lr-decay-start:
[2023-07-28 03:48:51] [config]   - 10
[2023-07-28 03:48:51] [config]   - 1
[2023-07-28 03:48:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 03:48:51] [config] lr-report: false
[2023-07-28 03:48:51] [config] lr-warmup: 0
[2023-07-28 03:48:51] [config] lr-warmup-at-reload: false
[2023-07-28 03:48:51] [config] lr-warmup-cycle: false
[2023-07-28 03:48:51] [config] lr-warmup-start-rate: 0
[2023-07-28 03:48:51] [config] max-length: 250
[2023-07-28 03:48:51] [config] max-length-crop: true
[2023-07-28 03:48:51] [config] max-length-factor: 3
[2023-07-28 03:48:51] [config] maxi-batch: 100
[2023-07-28 03:48:51] [config] maxi-batch-sort: trg
[2023-07-28 03:48:51] [config] mini-batch: 64
[2023-07-28 03:48:51] [config] mini-batch-fit: true
[2023-07-28 03:48:51] [config] mini-batch-fit-step: 10
[2023-07-28 03:48:51] [config] mini-batch-round-up: true
[2023-07-28 03:48:51] [config] mini-batch-track-lr: false
[2023-07-28 03:48:51] [config] mini-batch-warmup: 0
[2023-07-28 03:48:51] [config] mini-batch-words: 0
[2023-07-28 03:48:51] [config] mini-batch-words-ref: 0
[2023-07-28 03:48:51] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 03:48:51] [config] multi-loss-type: sum
[2023-07-28 03:48:51] [config] n-best: false
[2023-07-28 03:48:51] [config] no-nccl: false
[2023-07-28 03:48:51] [config] no-reload: false
[2023-07-28 03:48:51] [config] no-restore-corpus: false
[2023-07-28 03:48:51] [config] normalize: 0
[2023-07-28 03:48:51] [config] normalize-gradient: false
[2023-07-28 03:48:51] [config] num-devices: 0
[2023-07-28 03:48:51] [config] optimizer: adam
[2023-07-28 03:48:51] [config] optimizer-delay: 1
[2023-07-28 03:48:51] [config] optimizer-params:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] output-omit-bias: false
[2023-07-28 03:48:51] [config] overwrite: true
[2023-07-28 03:48:51] [config] precision:
[2023-07-28 03:48:51] [config]   - float16
[2023-07-28 03:48:51] [config]   - float32
[2023-07-28 03:48:51] [config] pretrained-model: ""
[2023-07-28 03:48:51] [config] quantize-biases: false
[2023-07-28 03:48:51] [config] quantize-bits: 0
[2023-07-28 03:48:51] [config] quantize-log-based: false
[2023-07-28 03:48:51] [config] quantize-optimization-steps: 0
[2023-07-28 03:48:51] [config] quiet: false
[2023-07-28 03:48:51] [config] quiet-translation: true
[2023-07-28 03:48:51] [config] relative-paths: false
[2023-07-28 03:48:51] [config] right-left: false
[2023-07-28 03:48:51] [config] save-freq: 10000u
[2023-07-28 03:48:51] [config] seed: 1234
[2023-07-28 03:48:51] [config] sentencepiece-alphas:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] sentencepiece-max-lines: 2000000
[2023-07-28 03:48:51] [config] sentencepiece-options: ""
[2023-07-28 03:48:51] [config] sharding: global
[2023-07-28 03:48:51] [config] shuffle: data
[2023-07-28 03:48:51] [config] shuffle-in-ram: false
[2023-07-28 03:48:51] [config] sigterm: save-and-exit
[2023-07-28 03:48:51] [config] skip: false
[2023-07-28 03:48:51] [config] sqlite: ""
[2023-07-28 03:48:51] [config] sqlite-drop: false
[2023-07-28 03:48:51] [config] sync-freq: 200u
[2023-07-28 03:48:51] [config] sync-sgd: false
[2023-07-28 03:48:51] [config] tempdir: /tmp
[2023-07-28 03:48:51] [config] tied-embeddings: false
[2023-07-28 03:48:51] [config] tied-embeddings-all: true
[2023-07-28 03:48:51] [config] tied-embeddings-src: false
[2023-07-28 03:48:51] [config] train-embedder-rank:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] train-sets:
[2023-07-28 03:48:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 03:48:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 03:48:51] [config] transformer-aan-activation: swish
[2023-07-28 03:48:51] [config] transformer-aan-depth: 2
[2023-07-28 03:48:51] [config] transformer-aan-nogate: false
[2023-07-28 03:48:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 03:48:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 03:48:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 03:48:51] [config] transformer-depth-scaling: false
[2023-07-28 03:48:51] [config] transformer-dim-aan: 2048
[2023-07-28 03:48:51] [config] transformer-dim-ffn: 2048
[2023-07-28 03:48:51] [config] transformer-dropout: 0
[2023-07-28 03:48:51] [config] transformer-dropout-attention: 0
[2023-07-28 03:48:51] [config] transformer-dropout-ffn: 0
[2023-07-28 03:48:51] [config] transformer-ffn-activation: swish
[2023-07-28 03:48:51] [config] transformer-ffn-depth: 2
[2023-07-28 03:48:51] [config] transformer-guided-alignment-layer: last
[2023-07-28 03:48:51] [config] transformer-heads: 8
[2023-07-28 03:48:51] [config] transformer-no-projection: false
[2023-07-28 03:48:51] [config] transformer-pool: false
[2023-07-28 03:48:51] [config] transformer-postprocess: dan
[2023-07-28 03:48:51] [config] transformer-postprocess-emb: d
[2023-07-28 03:48:51] [config] transformer-postprocess-top: ""
[2023-07-28 03:48:51] [config] transformer-preprocess: ""
[2023-07-28 03:48:51] [config] transformer-tied-layers:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] transformer-train-position-embeddings: false
[2023-07-28 03:48:51] [config] tsv: false
[2023-07-28 03:48:51] [config] tsv-fields: 0
[2023-07-28 03:48:51] [config] type: s2s
[2023-07-28 03:48:51] [config] ulr: false
[2023-07-28 03:48:51] [config] ulr-dim-emb: 0
[2023-07-28 03:48:51] [config] ulr-dropout: 0
[2023-07-28 03:48:51] [config] ulr-keys-vectors: ""
[2023-07-28 03:48:51] [config] ulr-query-vectors: ""
[2023-07-28 03:48:51] [config] ulr-softmax-temperature: 1
[2023-07-28 03:48:51] [config] ulr-trainable-transformation: false
[2023-07-28 03:48:51] [config] unlikelihood-loss: false
[2023-07-28 03:48:51] [config] valid-freq: 50000000
[2023-07-28 03:48:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 03:48:51] [config] valid-max-length: 1000
[2023-07-28 03:48:51] [config] valid-metrics:
[2023-07-28 03:48:51] [config]   - translation
[2023-07-28 03:48:51] [config] valid-mini-batch: 32
[2023-07-28 03:48:51] [config] valid-reset-stalled: false
[2023-07-28 03:48:51] [config] valid-script-args:
[2023-07-28 03:48:51] [config]   []
[2023-07-28 03:48:51] [config] valid-script-path: ""
[2023-07-28 03:48:51] [config] valid-sets:
[2023-07-28 03:48:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 03:48:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 03:48:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 03:48:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:48:51] [config] vocabs:
[2023-07-28 03:48:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:48:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:48:51] [config] word-penalty: 0
[2023-07-28 03:48:51] [config] word-scores: false
[2023-07-28 03:48:51] [config] workspace: 5500
[2023-07-28 03:48:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 03:48:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:48:51] [training] Using single-device training
[2023-07-28 03:48:51] Synced seed 1234
[2023-07-28 03:48:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 03:48:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 03:48:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 03:48:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 03:48:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 03:48:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 03:48:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 03:48:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 03:48:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 03:48:52] [comm] Using global sharding
[2023-07-28 03:48:52] [comm] NCCLCommunicators constructed successfully
[2023-07-28 03:48:52] [training] Using 1 GPUs
[2023-07-28 03:48:52] [logits] Applying loss function for 1 factor(s)
[2023-07-28 03:48:52] [memory] Reserving 80 MB, device gpu0
[2023-07-28 03:48:52] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 03:48:52] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:37:57] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 04:37:57] [valid] No post-processing script given for validating translator
[2023-07-28 04:37:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 04:37:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 04:37:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 04:37:57] [comm] Using global sharding
[2023-07-28 04:37:57] [comm] NCCLCommunicators constructed successfully
[2023-07-28 04:37:57] [training] Using 1 GPUs
[2023-07-28 04:37:57] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 04:37:58] Allocating memory for general optimizer shards
[2023-07-28 04:37:58] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:37:58] Loading Adam parameters
[2023-07-28 04:37:58] [memory] Reserving 322 MB, device gpu0
[2023-07-28 04:37:58] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:37:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 04:37:59] [data] Restoring the corpus state to epoch 141, batch 5427
[2023-07-28 04:37:59] [data] Shuffling data
[2023-07-28 04:37:59] [data] Done reading 20,192 sentences
[2023-07-28 04:37:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:37:59] Training started
[2023-07-28 04:37:59] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 04:38:00] [memory] Reserving 80 MB, device gpu0
[2023-07-28 04:38:07] Parameter type float16, optimization type float32, casting types true
[2023-07-28 04:42:57] Seen 20,192 samples
[2023-07-28 04:42:57] Starting data epoch 142 in logical epoch 142
[2023-07-28 04:42:57] [data] Shuffling data
[2023-07-28 04:42:57] [data] Done reading 20,192 sentences
[2023-07-28 04:42:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:47:54] Seen 20,192 samples
[2023-07-28 04:47:54] Starting data epoch 143 in logical epoch 143
[2023-07-28 04:47:54] [data] Shuffling data
[2023-07-28 04:47:54] [data] Done reading 20,192 sentences
[2023-07-28 04:47:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:52:22] Seen 20,192 samples
[2023-07-28 04:52:22] Starting data epoch 144 in logical epoch 144
[2023-07-28 04:52:22] [data] Shuffling data
[2023-07-28 04:52:22] [data] Done reading 20,192 sentences
[2023-07-28 04:52:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 04:56:56] Seen 20,192 samples
[2023-07-28 04:56:56] Starting data epoch 145 in logical epoch 145
[2023-07-28 04:56:56] [data] Shuffling data
[2023-07-28 04:56:56] [data] Done reading 20,192 sentences
[2023-07-28 04:56:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:01:58] Seen 20,192 samples
[2023-07-28 05:01:58] Starting data epoch 146 in logical epoch 146
[2023-07-28 05:01:58] [data] Shuffling data
[2023-07-28 05:01:58] [data] Done reading 20,192 sentences
[2023-07-28 05:01:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:06:55] Seen 20,192 samples
[2023-07-28 05:06:55] Starting data epoch 147 in logical epoch 147
[2023-07-28 05:06:55] [data] Shuffling data
[2023-07-28 05:06:55] [data] Done reading 20,192 sentences
[2023-07-28 05:06:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:11:50] Seen 20,192 samples
[2023-07-28 05:11:50] Starting data epoch 148 in logical epoch 148
[2023-07-28 05:11:50] [data] Shuffling data
[2023-07-28 05:11:50] [data] Done reading 20,192 sentences
[2023-07-28 05:11:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:16:46] Seen 20,192 samples
[2023-07-28 05:16:46] Starting data epoch 149 in logical epoch 149
[2023-07-28 05:16:46] [data] Shuffling data
[2023-07-28 05:16:46] [data] Done reading 20,192 sentences
[2023-07-28 05:16:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:21:28] Seen 20,192 samples
[2023-07-28 05:21:28] Starting data epoch 150 in logical epoch 150
[2023-07-28 05:21:28] [data] Shuffling data
[2023-07-28 05:21:28] [data] Done reading 20,192 sentences
[2023-07-28 05:21:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 05:26:17] Seen 20,192 samples
[2023-07-28 05:26:17] Starting data epoch 151 in logical epoch 151
[2023-07-28 05:26:17] Training finished
[2023-07-28 05:28:22] [valid] Ep. 151 : Up. 5814 : translation : 0 : new best
[2023-07-28 05:28:22] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 05:28:23] Saving Adam parameters
[2023-07-28 05:28:24] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 05:28:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:28:30] [marian] Running on node18.datos.cluster.uy as process 6642 with command line:
[2023-07-28 05:28:30] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 05:28:30] [config] after: 0e
[2023-07-28 05:28:30] [config] after-batches: 0
[2023-07-28 05:28:30] [config] after-epochs: 160
[2023-07-28 05:28:30] [config] all-caps-every: 0
[2023-07-28 05:28:30] [config] allow-unk: false
[2023-07-28 05:28:30] [config] authors: false
[2023-07-28 05:28:30] [config] beam-size: 12
[2023-07-28 05:28:30] [config] bert-class-symbol: "[CLS]"
[2023-07-28 05:28:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 05:28:30] [config] bert-masking-fraction: 0.15
[2023-07-28 05:28:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 05:28:30] [config] bert-train-type-embeddings: true
[2023-07-28 05:28:30] [config] bert-type-vocab-size: 2
[2023-07-28 05:28:30] [config] build-info: ""
[2023-07-28 05:28:30] [config] check-gradient-nan: false
[2023-07-28 05:28:30] [config] check-nan: false
[2023-07-28 05:28:30] [config] cite: false
[2023-07-28 05:28:30] [config] clip-norm: 1
[2023-07-28 05:28:30] [config] cost-scaling:
[2023-07-28 05:28:30] [config]   - 256.f
[2023-07-28 05:28:30] [config]   - 1000
[2023-07-28 05:28:30] [config]   - 2.f
[2023-07-28 05:28:30] [config]   - 256.f
[2023-07-28 05:28:30] [config] cost-type: ce-sum
[2023-07-28 05:28:30] [config] cpu-threads: 0
[2023-07-28 05:28:30] [config] data-threads: 8
[2023-07-28 05:28:30] [config] data-weighting: ""
[2023-07-28 05:28:30] [config] data-weighting-type: sentence
[2023-07-28 05:28:30] [config] dec-cell: gru
[2023-07-28 05:28:30] [config] dec-cell-base-depth: 2
[2023-07-28 05:28:30] [config] dec-cell-high-depth: 1
[2023-07-28 05:28:30] [config] dec-depth: 1
[2023-07-28 05:28:30] [config] devices:
[2023-07-28 05:28:30] [config]   - 0
[2023-07-28 05:28:30] [config] dim-emb: 512
[2023-07-28 05:28:30] [config] dim-rnn: 1024
[2023-07-28 05:28:30] [config] dim-vocabs:
[2023-07-28 05:28:30] [config]   - 16384
[2023-07-28 05:28:30] [config]   - 16384
[2023-07-28 05:28:30] [config] disp-first: 0
[2023-07-28 05:28:30] [config] disp-freq: 1000u
[2023-07-28 05:28:30] [config] disp-label-counts: true
[2023-07-28 05:28:30] [config] dropout-rnn: 0
[2023-07-28 05:28:30] [config] dropout-src: 0
[2023-07-28 05:28:30] [config] dropout-trg: 0
[2023-07-28 05:28:30] [config] dump-config: ""
[2023-07-28 05:28:30] [config] dynamic-gradient-scaling:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] early-stopping: 1000
[2023-07-28 05:28:30] [config] early-stopping-on: first
[2023-07-28 05:28:30] [config] embedding-fix-src: false
[2023-07-28 05:28:30] [config] embedding-fix-trg: false
[2023-07-28 05:28:30] [config] embedding-normalization: false
[2023-07-28 05:28:30] [config] embedding-vectors:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] enc-cell: gru
[2023-07-28 05:28:30] [config] enc-cell-depth: 1
[2023-07-28 05:28:30] [config] enc-depth: 1
[2023-07-28 05:28:30] [config] enc-type: bidirectional
[2023-07-28 05:28:30] [config] english-title-case-every: 0
[2023-07-28 05:28:30] [config] exponential-smoothing: 0
[2023-07-28 05:28:30] [config] factor-weight: 1
[2023-07-28 05:28:30] [config] factors-combine: sum
[2023-07-28 05:28:30] [config] factors-dim-emb: 0
[2023-07-28 05:28:30] [config] gradient-checkpointing: false
[2023-07-28 05:28:30] [config] gradient-norm-average-window: 100
[2023-07-28 05:28:30] [config] guided-alignment: none
[2023-07-28 05:28:30] [config] guided-alignment-cost: mse
[2023-07-28 05:28:30] [config] guided-alignment-weight: 0.1
[2023-07-28 05:28:30] [config] ignore-model-config: false
[2023-07-28 05:28:30] [config] input-types:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] interpolate-env-vars: false
[2023-07-28 05:28:30] [config] keep-best: false
[2023-07-28 05:28:30] [config] label-smoothing: 0
[2023-07-28 05:28:30] [config] layer-normalization: false
[2023-07-28 05:28:30] [config] learn-rate: 0.0001
[2023-07-28 05:28:30] [config] lemma-dependency: ""
[2023-07-28 05:28:30] [config] lemma-dim-emb: 0
[2023-07-28 05:28:30] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 05:28:30] [config] log-level: info
[2023-07-28 05:28:30] [config] log-time-zone: ""
[2023-07-28 05:28:30] [config] logical-epoch:
[2023-07-28 05:28:30] [config]   - 1e
[2023-07-28 05:28:30] [config]   - 0
[2023-07-28 05:28:30] [config] lr-decay: 0
[2023-07-28 05:28:30] [config] lr-decay-freq: 50000
[2023-07-28 05:28:30] [config] lr-decay-inv-sqrt:
[2023-07-28 05:28:30] [config]   - 0
[2023-07-28 05:28:30] [config] lr-decay-repeat-warmup: false
[2023-07-28 05:28:30] [config] lr-decay-reset-optimizer: false
[2023-07-28 05:28:30] [config] lr-decay-start:
[2023-07-28 05:28:30] [config]   - 10
[2023-07-28 05:28:30] [config]   - 1
[2023-07-28 05:28:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 05:28:30] [config] lr-report: false
[2023-07-28 05:28:30] [config] lr-warmup: 0
[2023-07-28 05:28:30] [config] lr-warmup-at-reload: false
[2023-07-28 05:28:30] [config] lr-warmup-cycle: false
[2023-07-28 05:28:30] [config] lr-warmup-start-rate: 0
[2023-07-28 05:28:30] [config] max-length: 250
[2023-07-28 05:28:30] [config] max-length-crop: true
[2023-07-28 05:28:30] [config] max-length-factor: 3
[2023-07-28 05:28:30] [config] maxi-batch: 100
[2023-07-28 05:28:30] [config] maxi-batch-sort: trg
[2023-07-28 05:28:30] [config] mini-batch: 64
[2023-07-28 05:28:30] [config] mini-batch-fit: true
[2023-07-28 05:28:30] [config] mini-batch-fit-step: 10
[2023-07-28 05:28:30] [config] mini-batch-round-up: true
[2023-07-28 05:28:30] [config] mini-batch-track-lr: false
[2023-07-28 05:28:30] [config] mini-batch-warmup: 0
[2023-07-28 05:28:30] [config] mini-batch-words: 0
[2023-07-28 05:28:30] [config] mini-batch-words-ref: 0
[2023-07-28 05:28:30] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 05:28:30] [config] multi-loss-type: sum
[2023-07-28 05:28:30] [config] n-best: false
[2023-07-28 05:28:30] [config] no-nccl: false
[2023-07-28 05:28:30] [config] no-reload: false
[2023-07-28 05:28:30] [config] no-restore-corpus: false
[2023-07-28 05:28:30] [config] normalize: 0
[2023-07-28 05:28:30] [config] normalize-gradient: false
[2023-07-28 05:28:30] [config] num-devices: 0
[2023-07-28 05:28:30] [config] optimizer: adam
[2023-07-28 05:28:30] [config] optimizer-delay: 1
[2023-07-28 05:28:30] [config] optimizer-params:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] output-omit-bias: false
[2023-07-28 05:28:30] [config] overwrite: true
[2023-07-28 05:28:30] [config] precision:
[2023-07-28 05:28:30] [config]   - float16
[2023-07-28 05:28:30] [config]   - float32
[2023-07-28 05:28:30] [config] pretrained-model: ""
[2023-07-28 05:28:30] [config] quantize-biases: false
[2023-07-28 05:28:30] [config] quantize-bits: 0
[2023-07-28 05:28:30] [config] quantize-log-based: false
[2023-07-28 05:28:30] [config] quantize-optimization-steps: 0
[2023-07-28 05:28:30] [config] quiet: false
[2023-07-28 05:28:30] [config] quiet-translation: true
[2023-07-28 05:28:30] [config] relative-paths: false
[2023-07-28 05:28:30] [config] right-left: false
[2023-07-28 05:28:30] [config] save-freq: 10000u
[2023-07-28 05:28:30] [config] seed: 1234
[2023-07-28 05:28:30] [config] sentencepiece-alphas:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] sentencepiece-max-lines: 2000000
[2023-07-28 05:28:30] [config] sentencepiece-options: ""
[2023-07-28 05:28:30] [config] sharding: global
[2023-07-28 05:28:30] [config] shuffle: data
[2023-07-28 05:28:30] [config] shuffle-in-ram: false
[2023-07-28 05:28:30] [config] sigterm: save-and-exit
[2023-07-28 05:28:30] [config] skip: false
[2023-07-28 05:28:30] [config] sqlite: ""
[2023-07-28 05:28:30] [config] sqlite-drop: false
[2023-07-28 05:28:30] [config] sync-freq: 200u
[2023-07-28 05:28:30] [config] sync-sgd: false
[2023-07-28 05:28:30] [config] tempdir: /tmp
[2023-07-28 05:28:30] [config] tied-embeddings: false
[2023-07-28 05:28:30] [config] tied-embeddings-all: true
[2023-07-28 05:28:30] [config] tied-embeddings-src: false
[2023-07-28 05:28:30] [config] train-embedder-rank:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] train-sets:
[2023-07-28 05:28:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 05:28:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 05:28:30] [config] transformer-aan-activation: swish
[2023-07-28 05:28:30] [config] transformer-aan-depth: 2
[2023-07-28 05:28:30] [config] transformer-aan-nogate: false
[2023-07-28 05:28:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 05:28:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 05:28:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 05:28:30] [config] transformer-depth-scaling: false
[2023-07-28 05:28:30] [config] transformer-dim-aan: 2048
[2023-07-28 05:28:30] [config] transformer-dim-ffn: 2048
[2023-07-28 05:28:30] [config] transformer-dropout: 0
[2023-07-28 05:28:30] [config] transformer-dropout-attention: 0
[2023-07-28 05:28:30] [config] transformer-dropout-ffn: 0
[2023-07-28 05:28:30] [config] transformer-ffn-activation: swish
[2023-07-28 05:28:30] [config] transformer-ffn-depth: 2
[2023-07-28 05:28:30] [config] transformer-guided-alignment-layer: last
[2023-07-28 05:28:30] [config] transformer-heads: 8
[2023-07-28 05:28:30] [config] transformer-no-projection: false
[2023-07-28 05:28:30] [config] transformer-pool: false
[2023-07-28 05:28:30] [config] transformer-postprocess: dan
[2023-07-28 05:28:30] [config] transformer-postprocess-emb: d
[2023-07-28 05:28:30] [config] transformer-postprocess-top: ""
[2023-07-28 05:28:30] [config] transformer-preprocess: ""
[2023-07-28 05:28:30] [config] transformer-tied-layers:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] transformer-train-position-embeddings: false
[2023-07-28 05:28:30] [config] tsv: false
[2023-07-28 05:28:30] [config] tsv-fields: 0
[2023-07-28 05:28:30] [config] type: s2s
[2023-07-28 05:28:30] [config] ulr: false
[2023-07-28 05:28:30] [config] ulr-dim-emb: 0
[2023-07-28 05:28:30] [config] ulr-dropout: 0
[2023-07-28 05:28:30] [config] ulr-keys-vectors: ""
[2023-07-28 05:28:30] [config] ulr-query-vectors: ""
[2023-07-28 05:28:30] [config] ulr-softmax-temperature: 1
[2023-07-28 05:28:30] [config] ulr-trainable-transformation: false
[2023-07-28 05:28:30] [config] unlikelihood-loss: false
[2023-07-28 05:28:30] [config] valid-freq: 50000000
[2023-07-28 05:28:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 05:28:30] [config] valid-max-length: 1000
[2023-07-28 05:28:30] [config] valid-metrics:
[2023-07-28 05:28:30] [config]   - translation
[2023-07-28 05:28:30] [config] valid-mini-batch: 32
[2023-07-28 05:28:30] [config] valid-reset-stalled: false
[2023-07-28 05:28:30] [config] valid-script-args:
[2023-07-28 05:28:30] [config]   []
[2023-07-28 05:28:30] [config] valid-script-path: ""
[2023-07-28 05:28:30] [config] valid-sets:
[2023-07-28 05:28:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 05:28:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 05:28:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 05:28:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:28:30] [config] vocabs:
[2023-07-28 05:28:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:28:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:28:30] [config] word-penalty: 0
[2023-07-28 05:28:30] [config] word-scores: false
[2023-07-28 05:28:30] [config] workspace: 5500
[2023-07-28 05:28:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 05:28:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:28:30] [training] Using single-device training
[2023-07-28 05:28:30] Synced seed 1234
[2023-07-28 05:28:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 05:28:30] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 05:28:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 05:28:30] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 05:28:30] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 05:28:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 05:28:30] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 05:28:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 05:28:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 05:28:31] [comm] Using global sharding
[2023-07-28 05:28:31] [comm] NCCLCommunicators constructed successfully
[2023-07-28 05:28:31] [training] Using 1 GPUs
[2023-07-28 05:28:31] [logits] Applying loss function for 1 factor(s)
[2023-07-28 05:28:31] [memory] Reserving 80 MB, device gpu0
[2023-07-28 05:28:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 05:28:32] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:16:43] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 06:16:43] [valid] No post-processing script given for validating translator
[2023-07-28 06:16:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:16:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:16:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:16:43] [comm] Using global sharding
[2023-07-28 06:16:43] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:16:43] [training] Using 1 GPUs
[2023-07-28 06:16:43] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 06:16:44] Allocating memory for general optimizer shards
[2023-07-28 06:16:44] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:16:45] Loading Adam parameters
[2023-07-28 06:16:45] [memory] Reserving 322 MB, device gpu0
[2023-07-28 06:16:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:16:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 06:16:45] [data] Restoring the corpus state to epoch 161, batch 6200
[2023-07-28 06:16:45] [data] Shuffling data
[2023-07-28 06:16:45] [data] Done reading 20,192 sentences
[2023-07-28 06:16:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 06:16:45] Training started
[2023-07-28 06:16:45] Training finished
[2023-07-28 06:16:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:16:49] [marian] Running on node18.datos.cluster.uy as process 9582 with command line:
[2023-07-28 06:16:49] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 06:16:49] [config] after: 0e
[2023-07-28 06:16:49] [config] after-batches: 0
[2023-07-28 06:16:49] [config] after-epochs: 170
[2023-07-28 06:16:49] [config] all-caps-every: 0
[2023-07-28 06:16:49] [config] allow-unk: false
[2023-07-28 06:16:49] [config] authors: false
[2023-07-28 06:16:49] [config] beam-size: 12
[2023-07-28 06:16:49] [config] bert-class-symbol: "[CLS]"
[2023-07-28 06:16:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 06:16:49] [config] bert-masking-fraction: 0.15
[2023-07-28 06:16:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 06:16:49] [config] bert-train-type-embeddings: true
[2023-07-28 06:16:49] [config] bert-type-vocab-size: 2
[2023-07-28 06:16:49] [config] build-info: ""
[2023-07-28 06:16:49] [config] check-gradient-nan: false
[2023-07-28 06:16:49] [config] check-nan: false
[2023-07-28 06:16:49] [config] cite: false
[2023-07-28 06:16:49] [config] clip-norm: 1
[2023-07-28 06:16:49] [config] cost-scaling:
[2023-07-28 06:16:49] [config]   - 256.f
[2023-07-28 06:16:49] [config]   - 1000
[2023-07-28 06:16:49] [config]   - 2.f
[2023-07-28 06:16:49] [config]   - 256.f
[2023-07-28 06:16:49] [config] cost-type: ce-sum
[2023-07-28 06:16:49] [config] cpu-threads: 0
[2023-07-28 06:16:49] [config] data-threads: 8
[2023-07-28 06:16:49] [config] data-weighting: ""
[2023-07-28 06:16:49] [config] data-weighting-type: sentence
[2023-07-28 06:16:49] [config] dec-cell: gru
[2023-07-28 06:16:49] [config] dec-cell-base-depth: 2
[2023-07-28 06:16:49] [config] dec-cell-high-depth: 1
[2023-07-28 06:16:49] [config] dec-depth: 1
[2023-07-28 06:16:49] [config] devices:
[2023-07-28 06:16:49] [config]   - 0
[2023-07-28 06:16:49] [config] dim-emb: 512
[2023-07-28 06:16:49] [config] dim-rnn: 1024
[2023-07-28 06:16:49] [config] dim-vocabs:
[2023-07-28 06:16:49] [config]   - 16384
[2023-07-28 06:16:49] [config]   - 16384
[2023-07-28 06:16:49] [config] disp-first: 0
[2023-07-28 06:16:49] [config] disp-freq: 1000u
[2023-07-28 06:16:49] [config] disp-label-counts: true
[2023-07-28 06:16:49] [config] dropout-rnn: 0
[2023-07-28 06:16:49] [config] dropout-src: 0
[2023-07-28 06:16:49] [config] dropout-trg: 0
[2023-07-28 06:16:49] [config] dump-config: ""
[2023-07-28 06:16:49] [config] dynamic-gradient-scaling:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] early-stopping: 1000
[2023-07-28 06:16:49] [config] early-stopping-on: first
[2023-07-28 06:16:49] [config] embedding-fix-src: false
[2023-07-28 06:16:49] [config] embedding-fix-trg: false
[2023-07-28 06:16:49] [config] embedding-normalization: false
[2023-07-28 06:16:49] [config] embedding-vectors:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] enc-cell: gru
[2023-07-28 06:16:49] [config] enc-cell-depth: 1
[2023-07-28 06:16:49] [config] enc-depth: 1
[2023-07-28 06:16:49] [config] enc-type: bidirectional
[2023-07-28 06:16:49] [config] english-title-case-every: 0
[2023-07-28 06:16:49] [config] exponential-smoothing: 0
[2023-07-28 06:16:49] [config] factor-weight: 1
[2023-07-28 06:16:49] [config] factors-combine: sum
[2023-07-28 06:16:49] [config] factors-dim-emb: 0
[2023-07-28 06:16:49] [config] gradient-checkpointing: false
[2023-07-28 06:16:49] [config] gradient-norm-average-window: 100
[2023-07-28 06:16:49] [config] guided-alignment: none
[2023-07-28 06:16:49] [config] guided-alignment-cost: mse
[2023-07-28 06:16:49] [config] guided-alignment-weight: 0.1
[2023-07-28 06:16:49] [config] ignore-model-config: false
[2023-07-28 06:16:49] [config] input-types:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] interpolate-env-vars: false
[2023-07-28 06:16:49] [config] keep-best: false
[2023-07-28 06:16:49] [config] label-smoothing: 0
[2023-07-28 06:16:49] [config] layer-normalization: false
[2023-07-28 06:16:49] [config] learn-rate: 0.0001
[2023-07-28 06:16:49] [config] lemma-dependency: ""
[2023-07-28 06:16:49] [config] lemma-dim-emb: 0
[2023-07-28 06:16:49] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 06:16:49] [config] log-level: info
[2023-07-28 06:16:49] [config] log-time-zone: ""
[2023-07-28 06:16:49] [config] logical-epoch:
[2023-07-28 06:16:49] [config]   - 1e
[2023-07-28 06:16:49] [config]   - 0
[2023-07-28 06:16:49] [config] lr-decay: 0
[2023-07-28 06:16:49] [config] lr-decay-freq: 50000
[2023-07-28 06:16:49] [config] lr-decay-inv-sqrt:
[2023-07-28 06:16:49] [config]   - 0
[2023-07-28 06:16:49] [config] lr-decay-repeat-warmup: false
[2023-07-28 06:16:49] [config] lr-decay-reset-optimizer: false
[2023-07-28 06:16:49] [config] lr-decay-start:
[2023-07-28 06:16:49] [config]   - 10
[2023-07-28 06:16:49] [config]   - 1
[2023-07-28 06:16:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 06:16:49] [config] lr-report: false
[2023-07-28 06:16:49] [config] lr-warmup: 0
[2023-07-28 06:16:49] [config] lr-warmup-at-reload: false
[2023-07-28 06:16:49] [config] lr-warmup-cycle: false
[2023-07-28 06:16:49] [config] lr-warmup-start-rate: 0
[2023-07-28 06:16:49] [config] max-length: 250
[2023-07-28 06:16:49] [config] max-length-crop: true
[2023-07-28 06:16:49] [config] max-length-factor: 3
[2023-07-28 06:16:49] [config] maxi-batch: 100
[2023-07-28 06:16:49] [config] maxi-batch-sort: trg
[2023-07-28 06:16:49] [config] mini-batch: 64
[2023-07-28 06:16:49] [config] mini-batch-fit: true
[2023-07-28 06:16:49] [config] mini-batch-fit-step: 10
[2023-07-28 06:16:49] [config] mini-batch-round-up: true
[2023-07-28 06:16:49] [config] mini-batch-track-lr: false
[2023-07-28 06:16:49] [config] mini-batch-warmup: 0
[2023-07-28 06:16:49] [config] mini-batch-words: 0
[2023-07-28 06:16:49] [config] mini-batch-words-ref: 0
[2023-07-28 06:16:49] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 06:16:49] [config] multi-loss-type: sum
[2023-07-28 06:16:49] [config] n-best: false
[2023-07-28 06:16:49] [config] no-nccl: false
[2023-07-28 06:16:49] [config] no-reload: false
[2023-07-28 06:16:49] [config] no-restore-corpus: false
[2023-07-28 06:16:49] [config] normalize: 0
[2023-07-28 06:16:49] [config] normalize-gradient: false
[2023-07-28 06:16:49] [config] num-devices: 0
[2023-07-28 06:16:49] [config] optimizer: adam
[2023-07-28 06:16:49] [config] optimizer-delay: 1
[2023-07-28 06:16:49] [config] optimizer-params:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] output-omit-bias: false
[2023-07-28 06:16:49] [config] overwrite: true
[2023-07-28 06:16:49] [config] precision:
[2023-07-28 06:16:49] [config]   - float16
[2023-07-28 06:16:49] [config]   - float32
[2023-07-28 06:16:49] [config] pretrained-model: ""
[2023-07-28 06:16:49] [config] quantize-biases: false
[2023-07-28 06:16:49] [config] quantize-bits: 0
[2023-07-28 06:16:49] [config] quantize-log-based: false
[2023-07-28 06:16:49] [config] quantize-optimization-steps: 0
[2023-07-28 06:16:49] [config] quiet: false
[2023-07-28 06:16:49] [config] quiet-translation: true
[2023-07-28 06:16:49] [config] relative-paths: false
[2023-07-28 06:16:49] [config] right-left: false
[2023-07-28 06:16:49] [config] save-freq: 10000u
[2023-07-28 06:16:49] [config] seed: 1234
[2023-07-28 06:16:49] [config] sentencepiece-alphas:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] sentencepiece-max-lines: 2000000
[2023-07-28 06:16:49] [config] sentencepiece-options: ""
[2023-07-28 06:16:49] [config] sharding: global
[2023-07-28 06:16:49] [config] shuffle: data
[2023-07-28 06:16:49] [config] shuffle-in-ram: false
[2023-07-28 06:16:49] [config] sigterm: save-and-exit
[2023-07-28 06:16:49] [config] skip: false
[2023-07-28 06:16:49] [config] sqlite: ""
[2023-07-28 06:16:49] [config] sqlite-drop: false
[2023-07-28 06:16:49] [config] sync-freq: 200u
[2023-07-28 06:16:49] [config] sync-sgd: false
[2023-07-28 06:16:49] [config] tempdir: /tmp
[2023-07-28 06:16:49] [config] tied-embeddings: false
[2023-07-28 06:16:49] [config] tied-embeddings-all: true
[2023-07-28 06:16:49] [config] tied-embeddings-src: false
[2023-07-28 06:16:49] [config] train-embedder-rank:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] train-sets:
[2023-07-28 06:16:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 06:16:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 06:16:49] [config] transformer-aan-activation: swish
[2023-07-28 06:16:49] [config] transformer-aan-depth: 2
[2023-07-28 06:16:49] [config] transformer-aan-nogate: false
[2023-07-28 06:16:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 06:16:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 06:16:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 06:16:49] [config] transformer-depth-scaling: false
[2023-07-28 06:16:49] [config] transformer-dim-aan: 2048
[2023-07-28 06:16:49] [config] transformer-dim-ffn: 2048
[2023-07-28 06:16:49] [config] transformer-dropout: 0
[2023-07-28 06:16:49] [config] transformer-dropout-attention: 0
[2023-07-28 06:16:49] [config] transformer-dropout-ffn: 0
[2023-07-28 06:16:49] [config] transformer-ffn-activation: swish
[2023-07-28 06:16:49] [config] transformer-ffn-depth: 2
[2023-07-28 06:16:49] [config] transformer-guided-alignment-layer: last
[2023-07-28 06:16:49] [config] transformer-heads: 8
[2023-07-28 06:16:49] [config] transformer-no-projection: false
[2023-07-28 06:16:49] [config] transformer-pool: false
[2023-07-28 06:16:49] [config] transformer-postprocess: dan
[2023-07-28 06:16:49] [config] transformer-postprocess-emb: d
[2023-07-28 06:16:49] [config] transformer-postprocess-top: ""
[2023-07-28 06:16:49] [config] transformer-preprocess: ""
[2023-07-28 06:16:49] [config] transformer-tied-layers:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] transformer-train-position-embeddings: false
[2023-07-28 06:16:49] [config] tsv: false
[2023-07-28 06:16:49] [config] tsv-fields: 0
[2023-07-28 06:16:49] [config] type: s2s
[2023-07-28 06:16:49] [config] ulr: false
[2023-07-28 06:16:49] [config] ulr-dim-emb: 0
[2023-07-28 06:16:49] [config] ulr-dropout: 0
[2023-07-28 06:16:49] [config] ulr-keys-vectors: ""
[2023-07-28 06:16:49] [config] ulr-query-vectors: ""
[2023-07-28 06:16:49] [config] ulr-softmax-temperature: 1
[2023-07-28 06:16:49] [config] ulr-trainable-transformation: false
[2023-07-28 06:16:49] [config] unlikelihood-loss: false
[2023-07-28 06:16:49] [config] valid-freq: 50000000
[2023-07-28 06:16:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 06:16:49] [config] valid-max-length: 1000
[2023-07-28 06:16:49] [config] valid-metrics:
[2023-07-28 06:16:49] [config]   - translation
[2023-07-28 06:16:49] [config] valid-mini-batch: 32
[2023-07-28 06:16:49] [config] valid-reset-stalled: false
[2023-07-28 06:16:49] [config] valid-script-args:
[2023-07-28 06:16:49] [config]   []
[2023-07-28 06:16:49] [config] valid-script-path: ""
[2023-07-28 06:16:49] [config] valid-sets:
[2023-07-28 06:16:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 06:16:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 06:16:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 06:16:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:16:49] [config] vocabs:
[2023-07-28 06:16:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:16:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:16:49] [config] word-penalty: 0
[2023-07-28 06:16:49] [config] word-scores: false
[2023-07-28 06:16:49] [config] workspace: 5500
[2023-07-28 06:16:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 06:16:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:16:49] [training] Using single-device training
[2023-07-28 06:16:49] Synced seed 1234
[2023-07-28 06:16:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 06:16:49] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 06:16:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 06:16:49] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 06:16:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 06:16:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 06:16:49] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 06:16:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 06:16:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 06:16:50] [comm] Using global sharding
[2023-07-28 06:16:50] [comm] NCCLCommunicators constructed successfully
[2023-07-28 06:16:50] [training] Using 1 GPUs
[2023-07-28 06:16:50] [logits] Applying loss function for 1 factor(s)
[2023-07-28 06:16:50] [memory] Reserving 80 MB, device gpu0
[2023-07-28 06:16:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 06:16:50] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:07:01] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 07:07:02] [valid] No post-processing script given for validating translator
[2023-07-28 07:07:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:07:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:07:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:07:02] [comm] Using global sharding
[2023-07-28 07:07:02] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:07:02] [training] Using 1 GPUs
[2023-07-28 07:07:02] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 07:07:03] Allocating memory for general optimizer shards
[2023-07-28 07:07:03] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:07:03] Loading Adam parameters
[2023-07-28 07:07:03] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:07:03] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:07:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 07:07:04] [data] Restoring the corpus state to epoch 171, batch 6587
[2023-07-28 07:07:04] [data] Shuffling data
[2023-07-28 07:07:04] [data] Done reading 20,192 sentences
[2023-07-28 07:07:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:07:04] Training started
[2023-07-28 07:07:04] Training finished
[2023-07-28 07:07:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:07:07] [marian] Running on node18.datos.cluster.uy as process 12982 with command line:
[2023-07-28 07:07:07] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 07:07:07] [config] after: 0e
[2023-07-28 07:07:07] [config] after-batches: 0
[2023-07-28 07:07:07] [config] after-epochs: 180
[2023-07-28 07:07:07] [config] all-caps-every: 0
[2023-07-28 07:07:07] [config] allow-unk: false
[2023-07-28 07:07:07] [config] authors: false
[2023-07-28 07:07:07] [config] beam-size: 12
[2023-07-28 07:07:07] [config] bert-class-symbol: "[CLS]"
[2023-07-28 07:07:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 07:07:07] [config] bert-masking-fraction: 0.15
[2023-07-28 07:07:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 07:07:07] [config] bert-train-type-embeddings: true
[2023-07-28 07:07:07] [config] bert-type-vocab-size: 2
[2023-07-28 07:07:07] [config] build-info: ""
[2023-07-28 07:07:07] [config] check-gradient-nan: false
[2023-07-28 07:07:07] [config] check-nan: false
[2023-07-28 07:07:07] [config] cite: false
[2023-07-28 07:07:07] [config] clip-norm: 1
[2023-07-28 07:07:07] [config] cost-scaling:
[2023-07-28 07:07:07] [config]   - 256.f
[2023-07-28 07:07:07] [config]   - 1000
[2023-07-28 07:07:07] [config]   - 2.f
[2023-07-28 07:07:07] [config]   - 256.f
[2023-07-28 07:07:07] [config] cost-type: ce-sum
[2023-07-28 07:07:07] [config] cpu-threads: 0
[2023-07-28 07:07:07] [config] data-threads: 8
[2023-07-28 07:07:07] [config] data-weighting: ""
[2023-07-28 07:07:07] [config] data-weighting-type: sentence
[2023-07-28 07:07:07] [config] dec-cell: gru
[2023-07-28 07:07:07] [config] dec-cell-base-depth: 2
[2023-07-28 07:07:07] [config] dec-cell-high-depth: 1
[2023-07-28 07:07:07] [config] dec-depth: 1
[2023-07-28 07:07:07] [config] devices:
[2023-07-28 07:07:07] [config]   - 0
[2023-07-28 07:07:07] [config] dim-emb: 512
[2023-07-28 07:07:07] [config] dim-rnn: 1024
[2023-07-28 07:07:07] [config] dim-vocabs:
[2023-07-28 07:07:07] [config]   - 16384
[2023-07-28 07:07:07] [config]   - 16384
[2023-07-28 07:07:07] [config] disp-first: 0
[2023-07-28 07:07:07] [config] disp-freq: 1000u
[2023-07-28 07:07:07] [config] disp-label-counts: true
[2023-07-28 07:07:07] [config] dropout-rnn: 0
[2023-07-28 07:07:07] [config] dropout-src: 0
[2023-07-28 07:07:07] [config] dropout-trg: 0
[2023-07-28 07:07:07] [config] dump-config: ""
[2023-07-28 07:07:07] [config] dynamic-gradient-scaling:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] early-stopping: 1000
[2023-07-28 07:07:07] [config] early-stopping-on: first
[2023-07-28 07:07:07] [config] embedding-fix-src: false
[2023-07-28 07:07:07] [config] embedding-fix-trg: false
[2023-07-28 07:07:07] [config] embedding-normalization: false
[2023-07-28 07:07:07] [config] embedding-vectors:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] enc-cell: gru
[2023-07-28 07:07:07] [config] enc-cell-depth: 1
[2023-07-28 07:07:07] [config] enc-depth: 1
[2023-07-28 07:07:07] [config] enc-type: bidirectional
[2023-07-28 07:07:07] [config] english-title-case-every: 0
[2023-07-28 07:07:07] [config] exponential-smoothing: 0
[2023-07-28 07:07:07] [config] factor-weight: 1
[2023-07-28 07:07:07] [config] factors-combine: sum
[2023-07-28 07:07:07] [config] factors-dim-emb: 0
[2023-07-28 07:07:07] [config] gradient-checkpointing: false
[2023-07-28 07:07:07] [config] gradient-norm-average-window: 100
[2023-07-28 07:07:07] [config] guided-alignment: none
[2023-07-28 07:07:07] [config] guided-alignment-cost: mse
[2023-07-28 07:07:07] [config] guided-alignment-weight: 0.1
[2023-07-28 07:07:07] [config] ignore-model-config: false
[2023-07-28 07:07:07] [config] input-types:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] interpolate-env-vars: false
[2023-07-28 07:07:07] [config] keep-best: false
[2023-07-28 07:07:07] [config] label-smoothing: 0
[2023-07-28 07:07:07] [config] layer-normalization: false
[2023-07-28 07:07:07] [config] learn-rate: 0.0001
[2023-07-28 07:07:07] [config] lemma-dependency: ""
[2023-07-28 07:07:07] [config] lemma-dim-emb: 0
[2023-07-28 07:07:07] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 07:07:07] [config] log-level: info
[2023-07-28 07:07:07] [config] log-time-zone: ""
[2023-07-28 07:07:07] [config] logical-epoch:
[2023-07-28 07:07:07] [config]   - 1e
[2023-07-28 07:07:07] [config]   - 0
[2023-07-28 07:07:07] [config] lr-decay: 0
[2023-07-28 07:07:07] [config] lr-decay-freq: 50000
[2023-07-28 07:07:07] [config] lr-decay-inv-sqrt:
[2023-07-28 07:07:07] [config]   - 0
[2023-07-28 07:07:07] [config] lr-decay-repeat-warmup: false
[2023-07-28 07:07:07] [config] lr-decay-reset-optimizer: false
[2023-07-28 07:07:07] [config] lr-decay-start:
[2023-07-28 07:07:07] [config]   - 10
[2023-07-28 07:07:07] [config]   - 1
[2023-07-28 07:07:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 07:07:07] [config] lr-report: false
[2023-07-28 07:07:07] [config] lr-warmup: 0
[2023-07-28 07:07:07] [config] lr-warmup-at-reload: false
[2023-07-28 07:07:07] [config] lr-warmup-cycle: false
[2023-07-28 07:07:07] [config] lr-warmup-start-rate: 0
[2023-07-28 07:07:07] [config] max-length: 250
[2023-07-28 07:07:07] [config] max-length-crop: true
[2023-07-28 07:07:07] [config] max-length-factor: 3
[2023-07-28 07:07:07] [config] maxi-batch: 100
[2023-07-28 07:07:07] [config] maxi-batch-sort: trg
[2023-07-28 07:07:07] [config] mini-batch: 64
[2023-07-28 07:07:07] [config] mini-batch-fit: true
[2023-07-28 07:07:07] [config] mini-batch-fit-step: 10
[2023-07-28 07:07:07] [config] mini-batch-round-up: true
[2023-07-28 07:07:07] [config] mini-batch-track-lr: false
[2023-07-28 07:07:07] [config] mini-batch-warmup: 0
[2023-07-28 07:07:07] [config] mini-batch-words: 0
[2023-07-28 07:07:07] [config] mini-batch-words-ref: 0
[2023-07-28 07:07:07] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 07:07:07] [config] multi-loss-type: sum
[2023-07-28 07:07:07] [config] n-best: false
[2023-07-28 07:07:07] [config] no-nccl: false
[2023-07-28 07:07:07] [config] no-reload: false
[2023-07-28 07:07:07] [config] no-restore-corpus: false
[2023-07-28 07:07:07] [config] normalize: 0
[2023-07-28 07:07:07] [config] normalize-gradient: false
[2023-07-28 07:07:07] [config] num-devices: 0
[2023-07-28 07:07:07] [config] optimizer: adam
[2023-07-28 07:07:07] [config] optimizer-delay: 1
[2023-07-28 07:07:07] [config] optimizer-params:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] output-omit-bias: false
[2023-07-28 07:07:07] [config] overwrite: true
[2023-07-28 07:07:07] [config] precision:
[2023-07-28 07:07:07] [config]   - float16
[2023-07-28 07:07:07] [config]   - float32
[2023-07-28 07:07:07] [config] pretrained-model: ""
[2023-07-28 07:07:07] [config] quantize-biases: false
[2023-07-28 07:07:07] [config] quantize-bits: 0
[2023-07-28 07:07:07] [config] quantize-log-based: false
[2023-07-28 07:07:07] [config] quantize-optimization-steps: 0
[2023-07-28 07:07:07] [config] quiet: false
[2023-07-28 07:07:07] [config] quiet-translation: true
[2023-07-28 07:07:07] [config] relative-paths: false
[2023-07-28 07:07:07] [config] right-left: false
[2023-07-28 07:07:07] [config] save-freq: 10000u
[2023-07-28 07:07:07] [config] seed: 1234
[2023-07-28 07:07:07] [config] sentencepiece-alphas:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] sentencepiece-max-lines: 2000000
[2023-07-28 07:07:07] [config] sentencepiece-options: ""
[2023-07-28 07:07:07] [config] sharding: global
[2023-07-28 07:07:07] [config] shuffle: data
[2023-07-28 07:07:07] [config] shuffle-in-ram: false
[2023-07-28 07:07:07] [config] sigterm: save-and-exit
[2023-07-28 07:07:07] [config] skip: false
[2023-07-28 07:07:07] [config] sqlite: ""
[2023-07-28 07:07:07] [config] sqlite-drop: false
[2023-07-28 07:07:07] [config] sync-freq: 200u
[2023-07-28 07:07:07] [config] sync-sgd: false
[2023-07-28 07:07:07] [config] tempdir: /tmp
[2023-07-28 07:07:07] [config] tied-embeddings: false
[2023-07-28 07:07:07] [config] tied-embeddings-all: true
[2023-07-28 07:07:07] [config] tied-embeddings-src: false
[2023-07-28 07:07:07] [config] train-embedder-rank:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] train-sets:
[2023-07-28 07:07:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 07:07:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 07:07:07] [config] transformer-aan-activation: swish
[2023-07-28 07:07:07] [config] transformer-aan-depth: 2
[2023-07-28 07:07:07] [config] transformer-aan-nogate: false
[2023-07-28 07:07:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 07:07:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 07:07:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 07:07:07] [config] transformer-depth-scaling: false
[2023-07-28 07:07:07] [config] transformer-dim-aan: 2048
[2023-07-28 07:07:07] [config] transformer-dim-ffn: 2048
[2023-07-28 07:07:07] [config] transformer-dropout: 0
[2023-07-28 07:07:07] [config] transformer-dropout-attention: 0
[2023-07-28 07:07:07] [config] transformer-dropout-ffn: 0
[2023-07-28 07:07:07] [config] transformer-ffn-activation: swish
[2023-07-28 07:07:07] [config] transformer-ffn-depth: 2
[2023-07-28 07:07:07] [config] transformer-guided-alignment-layer: last
[2023-07-28 07:07:07] [config] transformer-heads: 8
[2023-07-28 07:07:07] [config] transformer-no-projection: false
[2023-07-28 07:07:07] [config] transformer-pool: false
[2023-07-28 07:07:07] [config] transformer-postprocess: dan
[2023-07-28 07:07:07] [config] transformer-postprocess-emb: d
[2023-07-28 07:07:07] [config] transformer-postprocess-top: ""
[2023-07-28 07:07:07] [config] transformer-preprocess: ""
[2023-07-28 07:07:07] [config] transformer-tied-layers:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] transformer-train-position-embeddings: false
[2023-07-28 07:07:07] [config] tsv: false
[2023-07-28 07:07:07] [config] tsv-fields: 0
[2023-07-28 07:07:07] [config] type: s2s
[2023-07-28 07:07:07] [config] ulr: false
[2023-07-28 07:07:07] [config] ulr-dim-emb: 0
[2023-07-28 07:07:07] [config] ulr-dropout: 0
[2023-07-28 07:07:07] [config] ulr-keys-vectors: ""
[2023-07-28 07:07:07] [config] ulr-query-vectors: ""
[2023-07-28 07:07:07] [config] ulr-softmax-temperature: 1
[2023-07-28 07:07:07] [config] ulr-trainable-transformation: false
[2023-07-28 07:07:07] [config] unlikelihood-loss: false
[2023-07-28 07:07:07] [config] valid-freq: 50000000
[2023-07-28 07:07:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 07:07:07] [config] valid-max-length: 1000
[2023-07-28 07:07:07] [config] valid-metrics:
[2023-07-28 07:07:07] [config]   - translation
[2023-07-28 07:07:07] [config] valid-mini-batch: 32
[2023-07-28 07:07:07] [config] valid-reset-stalled: false
[2023-07-28 07:07:07] [config] valid-script-args:
[2023-07-28 07:07:07] [config]   []
[2023-07-28 07:07:07] [config] valid-script-path: ""
[2023-07-28 07:07:07] [config] valid-sets:
[2023-07-28 07:07:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 07:07:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 07:07:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 07:07:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:07:07] [config] vocabs:
[2023-07-28 07:07:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:07:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:07:07] [config] word-penalty: 0
[2023-07-28 07:07:07] [config] word-scores: false
[2023-07-28 07:07:07] [config] workspace: 5500
[2023-07-28 07:07:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 07:07:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:07:07] [training] Using single-device training
[2023-07-28 07:07:08] Synced seed 1234
[2023-07-28 07:07:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 07:07:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 07:07:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 07:07:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 07:07:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 07:07:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:07:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 07:07:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:07:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:07:09] [comm] Using global sharding
[2023-07-28 07:07:09] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:07:09] [training] Using 1 GPUs
[2023-07-28 07:07:09] [logits] Applying loss function for 1 factor(s)
[2023-07-28 07:07:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:07:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 07:07:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:55:41] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 07:55:41] [valid] No post-processing script given for validating translator
[2023-07-28 07:55:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 07:55:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 07:55:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 07:55:41] [comm] Using global sharding
[2023-07-28 07:55:41] [comm] NCCLCommunicators constructed successfully
[2023-07-28 07:55:41] [training] Using 1 GPUs
[2023-07-28 07:55:41] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 07:55:42] Allocating memory for general optimizer shards
[2023-07-28 07:55:42] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:55:43] Loading Adam parameters
[2023-07-28 07:55:43] [memory] Reserving 322 MB, device gpu0
[2023-07-28 07:55:43] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:55:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 07:55:43] [data] Restoring the corpus state to epoch 171, batch 6587
[2023-07-28 07:55:43] [data] Shuffling data
[2023-07-28 07:55:43] [data] Done reading 20,192 sentences
[2023-07-28 07:55:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 07:55:43] Training started
[2023-07-28 07:55:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 07:55:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 07:55:50] Parameter type float16, optimization type float32, casting types true
[2023-07-28 08:00:35] Seen 20,192 samples
[2023-07-28 08:00:35] Starting data epoch 172 in logical epoch 172
[2023-07-28 08:00:35] [data] Shuffling data
[2023-07-28 08:00:35] [data] Done reading 20,192 sentences
[2023-07-28 08:00:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:05:25] Seen 20,192 samples
[2023-07-28 08:05:25] Starting data epoch 173 in logical epoch 173
[2023-07-28 08:05:25] [data] Shuffling data
[2023-07-28 08:05:25] [data] Done reading 20,192 sentences
[2023-07-28 08:05:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:10:17] Seen 20,192 samples
[2023-07-28 08:10:17] Starting data epoch 174 in logical epoch 174
[2023-07-28 08:10:17] [data] Shuffling data
[2023-07-28 08:10:17] [data] Done reading 20,192 sentences
[2023-07-28 08:10:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:15:02] Seen 20,192 samples
[2023-07-28 08:15:02] Starting data epoch 175 in logical epoch 175
[2023-07-28 08:15:02] [data] Shuffling data
[2023-07-28 08:15:02] [data] Done reading 20,192 sentences
[2023-07-28 08:15:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:19:44] Seen 20,192 samples
[2023-07-28 08:19:44] Starting data epoch 176 in logical epoch 176
[2023-07-28 08:19:44] [data] Shuffling data
[2023-07-28 08:19:44] [data] Done reading 20,192 sentences
[2023-07-28 08:19:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:24:20] Seen 20,192 samples
[2023-07-28 08:24:20] Starting data epoch 177 in logical epoch 177
[2023-07-28 08:24:20] [data] Shuffling data
[2023-07-28 08:24:20] [data] Done reading 20,192 sentences
[2023-07-28 08:24:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:28:48] Seen 20,192 samples
[2023-07-28 08:28:48] Starting data epoch 178 in logical epoch 178
[2023-07-28 08:28:48] [data] Shuffling data
[2023-07-28 08:28:48] [data] Done reading 20,192 sentences
[2023-07-28 08:28:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:33:27] Seen 20,192 samples
[2023-07-28 08:33:27] Starting data epoch 179 in logical epoch 179
[2023-07-28 08:33:27] [data] Shuffling data
[2023-07-28 08:33:27] [data] Done reading 20,192 sentences
[2023-07-28 08:33:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:38:01] Seen 20,192 samples
[2023-07-28 08:38:01] Starting data epoch 180 in logical epoch 180
[2023-07-28 08:38:01] [data] Shuffling data
[2023-07-28 08:38:01] [data] Done reading 20,192 sentences
[2023-07-28 08:38:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 08:42:31] Seen 20,192 samples
[2023-07-28 08:42:31] Starting data epoch 181 in logical epoch 181
[2023-07-28 08:42:31] Training finished
[2023-07-28 08:44:34] [valid] Ep. 181 : Up. 6975 : translation : 0 : new best
[2023-07-28 08:44:34] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 08:44:35] Saving Adam parameters
[2023-07-28 08:44:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 08:44:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:44:42] [marian] Running on node18.datos.cluster.uy as process 19207 with command line:
[2023-07-28 08:44:42] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 08:44:42] [config] after: 0e
[2023-07-28 08:44:42] [config] after-batches: 0
[2023-07-28 08:44:42] [config] after-epochs: 190
[2023-07-28 08:44:42] [config] all-caps-every: 0
[2023-07-28 08:44:42] [config] allow-unk: false
[2023-07-28 08:44:42] [config] authors: false
[2023-07-28 08:44:42] [config] beam-size: 12
[2023-07-28 08:44:42] [config] bert-class-symbol: "[CLS]"
[2023-07-28 08:44:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 08:44:42] [config] bert-masking-fraction: 0.15
[2023-07-28 08:44:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 08:44:42] [config] bert-train-type-embeddings: true
[2023-07-28 08:44:42] [config] bert-type-vocab-size: 2
[2023-07-28 08:44:42] [config] build-info: ""
[2023-07-28 08:44:42] [config] check-gradient-nan: false
[2023-07-28 08:44:42] [config] check-nan: false
[2023-07-28 08:44:42] [config] cite: false
[2023-07-28 08:44:42] [config] clip-norm: 1
[2023-07-28 08:44:42] [config] cost-scaling:
[2023-07-28 08:44:42] [config]   - 256.f
[2023-07-28 08:44:42] [config]   - 1000
[2023-07-28 08:44:42] [config]   - 2.f
[2023-07-28 08:44:42] [config]   - 256.f
[2023-07-28 08:44:42] [config] cost-type: ce-sum
[2023-07-28 08:44:42] [config] cpu-threads: 0
[2023-07-28 08:44:42] [config] data-threads: 8
[2023-07-28 08:44:42] [config] data-weighting: ""
[2023-07-28 08:44:42] [config] data-weighting-type: sentence
[2023-07-28 08:44:42] [config] dec-cell: gru
[2023-07-28 08:44:42] [config] dec-cell-base-depth: 2
[2023-07-28 08:44:42] [config] dec-cell-high-depth: 1
[2023-07-28 08:44:42] [config] dec-depth: 1
[2023-07-28 08:44:42] [config] devices:
[2023-07-28 08:44:42] [config]   - 0
[2023-07-28 08:44:42] [config] dim-emb: 512
[2023-07-28 08:44:42] [config] dim-rnn: 1024
[2023-07-28 08:44:42] [config] dim-vocabs:
[2023-07-28 08:44:42] [config]   - 16384
[2023-07-28 08:44:42] [config]   - 16384
[2023-07-28 08:44:42] [config] disp-first: 0
[2023-07-28 08:44:42] [config] disp-freq: 1000u
[2023-07-28 08:44:42] [config] disp-label-counts: true
[2023-07-28 08:44:42] [config] dropout-rnn: 0
[2023-07-28 08:44:42] [config] dropout-src: 0
[2023-07-28 08:44:42] [config] dropout-trg: 0
[2023-07-28 08:44:42] [config] dump-config: ""
[2023-07-28 08:44:42] [config] dynamic-gradient-scaling:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] early-stopping: 1000
[2023-07-28 08:44:42] [config] early-stopping-on: first
[2023-07-28 08:44:42] [config] embedding-fix-src: false
[2023-07-28 08:44:42] [config] embedding-fix-trg: false
[2023-07-28 08:44:42] [config] embedding-normalization: false
[2023-07-28 08:44:42] [config] embedding-vectors:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] enc-cell: gru
[2023-07-28 08:44:42] [config] enc-cell-depth: 1
[2023-07-28 08:44:42] [config] enc-depth: 1
[2023-07-28 08:44:42] [config] enc-type: bidirectional
[2023-07-28 08:44:42] [config] english-title-case-every: 0
[2023-07-28 08:44:42] [config] exponential-smoothing: 0
[2023-07-28 08:44:42] [config] factor-weight: 1
[2023-07-28 08:44:42] [config] factors-combine: sum
[2023-07-28 08:44:42] [config] factors-dim-emb: 0
[2023-07-28 08:44:42] [config] gradient-checkpointing: false
[2023-07-28 08:44:42] [config] gradient-norm-average-window: 100
[2023-07-28 08:44:42] [config] guided-alignment: none
[2023-07-28 08:44:42] [config] guided-alignment-cost: mse
[2023-07-28 08:44:42] [config] guided-alignment-weight: 0.1
[2023-07-28 08:44:42] [config] ignore-model-config: false
[2023-07-28 08:44:42] [config] input-types:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] interpolate-env-vars: false
[2023-07-28 08:44:42] [config] keep-best: false
[2023-07-28 08:44:42] [config] label-smoothing: 0
[2023-07-28 08:44:42] [config] layer-normalization: false
[2023-07-28 08:44:42] [config] learn-rate: 0.0001
[2023-07-28 08:44:42] [config] lemma-dependency: ""
[2023-07-28 08:44:42] [config] lemma-dim-emb: 0
[2023-07-28 08:44:42] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 08:44:42] [config] log-level: info
[2023-07-28 08:44:42] [config] log-time-zone: ""
[2023-07-28 08:44:42] [config] logical-epoch:
[2023-07-28 08:44:42] [config]   - 1e
[2023-07-28 08:44:42] [config]   - 0
[2023-07-28 08:44:42] [config] lr-decay: 0
[2023-07-28 08:44:42] [config] lr-decay-freq: 50000
[2023-07-28 08:44:42] [config] lr-decay-inv-sqrt:
[2023-07-28 08:44:42] [config]   - 0
[2023-07-28 08:44:42] [config] lr-decay-repeat-warmup: false
[2023-07-28 08:44:42] [config] lr-decay-reset-optimizer: false
[2023-07-28 08:44:42] [config] lr-decay-start:
[2023-07-28 08:44:42] [config]   - 10
[2023-07-28 08:44:42] [config]   - 1
[2023-07-28 08:44:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 08:44:42] [config] lr-report: false
[2023-07-28 08:44:42] [config] lr-warmup: 0
[2023-07-28 08:44:42] [config] lr-warmup-at-reload: false
[2023-07-28 08:44:42] [config] lr-warmup-cycle: false
[2023-07-28 08:44:42] [config] lr-warmup-start-rate: 0
[2023-07-28 08:44:42] [config] max-length: 250
[2023-07-28 08:44:42] [config] max-length-crop: true
[2023-07-28 08:44:42] [config] max-length-factor: 3
[2023-07-28 08:44:42] [config] maxi-batch: 100
[2023-07-28 08:44:42] [config] maxi-batch-sort: trg
[2023-07-28 08:44:42] [config] mini-batch: 64
[2023-07-28 08:44:42] [config] mini-batch-fit: true
[2023-07-28 08:44:42] [config] mini-batch-fit-step: 10
[2023-07-28 08:44:42] [config] mini-batch-round-up: true
[2023-07-28 08:44:42] [config] mini-batch-track-lr: false
[2023-07-28 08:44:42] [config] mini-batch-warmup: 0
[2023-07-28 08:44:42] [config] mini-batch-words: 0
[2023-07-28 08:44:42] [config] mini-batch-words-ref: 0
[2023-07-28 08:44:42] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 08:44:42] [config] multi-loss-type: sum
[2023-07-28 08:44:42] [config] n-best: false
[2023-07-28 08:44:42] [config] no-nccl: false
[2023-07-28 08:44:42] [config] no-reload: false
[2023-07-28 08:44:42] [config] no-restore-corpus: false
[2023-07-28 08:44:42] [config] normalize: 0
[2023-07-28 08:44:42] [config] normalize-gradient: false
[2023-07-28 08:44:42] [config] num-devices: 0
[2023-07-28 08:44:42] [config] optimizer: adam
[2023-07-28 08:44:42] [config] optimizer-delay: 1
[2023-07-28 08:44:42] [config] optimizer-params:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] output-omit-bias: false
[2023-07-28 08:44:42] [config] overwrite: true
[2023-07-28 08:44:42] [config] precision:
[2023-07-28 08:44:42] [config]   - float16
[2023-07-28 08:44:42] [config]   - float32
[2023-07-28 08:44:42] [config] pretrained-model: ""
[2023-07-28 08:44:42] [config] quantize-biases: false
[2023-07-28 08:44:42] [config] quantize-bits: 0
[2023-07-28 08:44:42] [config] quantize-log-based: false
[2023-07-28 08:44:42] [config] quantize-optimization-steps: 0
[2023-07-28 08:44:42] [config] quiet: false
[2023-07-28 08:44:42] [config] quiet-translation: true
[2023-07-28 08:44:42] [config] relative-paths: false
[2023-07-28 08:44:42] [config] right-left: false
[2023-07-28 08:44:42] [config] save-freq: 10000u
[2023-07-28 08:44:42] [config] seed: 1234
[2023-07-28 08:44:42] [config] sentencepiece-alphas:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] sentencepiece-max-lines: 2000000
[2023-07-28 08:44:42] [config] sentencepiece-options: ""
[2023-07-28 08:44:42] [config] sharding: global
[2023-07-28 08:44:42] [config] shuffle: data
[2023-07-28 08:44:42] [config] shuffle-in-ram: false
[2023-07-28 08:44:42] [config] sigterm: save-and-exit
[2023-07-28 08:44:42] [config] skip: false
[2023-07-28 08:44:42] [config] sqlite: ""
[2023-07-28 08:44:42] [config] sqlite-drop: false
[2023-07-28 08:44:42] [config] sync-freq: 200u
[2023-07-28 08:44:42] [config] sync-sgd: false
[2023-07-28 08:44:42] [config] tempdir: /tmp
[2023-07-28 08:44:42] [config] tied-embeddings: false
[2023-07-28 08:44:42] [config] tied-embeddings-all: true
[2023-07-28 08:44:42] [config] tied-embeddings-src: false
[2023-07-28 08:44:42] [config] train-embedder-rank:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] train-sets:
[2023-07-28 08:44:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 08:44:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 08:44:42] [config] transformer-aan-activation: swish
[2023-07-28 08:44:42] [config] transformer-aan-depth: 2
[2023-07-28 08:44:42] [config] transformer-aan-nogate: false
[2023-07-28 08:44:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 08:44:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 08:44:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 08:44:42] [config] transformer-depth-scaling: false
[2023-07-28 08:44:42] [config] transformer-dim-aan: 2048
[2023-07-28 08:44:42] [config] transformer-dim-ffn: 2048
[2023-07-28 08:44:42] [config] transformer-dropout: 0
[2023-07-28 08:44:42] [config] transformer-dropout-attention: 0
[2023-07-28 08:44:42] [config] transformer-dropout-ffn: 0
[2023-07-28 08:44:42] [config] transformer-ffn-activation: swish
[2023-07-28 08:44:42] [config] transformer-ffn-depth: 2
[2023-07-28 08:44:42] [config] transformer-guided-alignment-layer: last
[2023-07-28 08:44:42] [config] transformer-heads: 8
[2023-07-28 08:44:42] [config] transformer-no-projection: false
[2023-07-28 08:44:42] [config] transformer-pool: false
[2023-07-28 08:44:42] [config] transformer-postprocess: dan
[2023-07-28 08:44:42] [config] transformer-postprocess-emb: d
[2023-07-28 08:44:42] [config] transformer-postprocess-top: ""
[2023-07-28 08:44:42] [config] transformer-preprocess: ""
[2023-07-28 08:44:42] [config] transformer-tied-layers:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] transformer-train-position-embeddings: false
[2023-07-28 08:44:42] [config] tsv: false
[2023-07-28 08:44:42] [config] tsv-fields: 0
[2023-07-28 08:44:42] [config] type: s2s
[2023-07-28 08:44:42] [config] ulr: false
[2023-07-28 08:44:42] [config] ulr-dim-emb: 0
[2023-07-28 08:44:42] [config] ulr-dropout: 0
[2023-07-28 08:44:42] [config] ulr-keys-vectors: ""
[2023-07-28 08:44:42] [config] ulr-query-vectors: ""
[2023-07-28 08:44:42] [config] ulr-softmax-temperature: 1
[2023-07-28 08:44:42] [config] ulr-trainable-transformation: false
[2023-07-28 08:44:42] [config] unlikelihood-loss: false
[2023-07-28 08:44:42] [config] valid-freq: 50000000
[2023-07-28 08:44:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 08:44:42] [config] valid-max-length: 1000
[2023-07-28 08:44:42] [config] valid-metrics:
[2023-07-28 08:44:42] [config]   - translation
[2023-07-28 08:44:42] [config] valid-mini-batch: 32
[2023-07-28 08:44:42] [config] valid-reset-stalled: false
[2023-07-28 08:44:42] [config] valid-script-args:
[2023-07-28 08:44:42] [config]   []
[2023-07-28 08:44:42] [config] valid-script-path: ""
[2023-07-28 08:44:42] [config] valid-sets:
[2023-07-28 08:44:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 08:44:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 08:44:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 08:44:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:44:42] [config] vocabs:
[2023-07-28 08:44:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:44:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:44:42] [config] word-penalty: 0
[2023-07-28 08:44:42] [config] word-scores: false
[2023-07-28 08:44:42] [config] workspace: 5500
[2023-07-28 08:44:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 08:44:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:44:42] [training] Using single-device training
[2023-07-28 08:44:43] Synced seed 1234
[2023-07-28 08:44:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 08:44:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 08:44:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 08:44:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 08:44:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 08:44:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 08:44:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 08:44:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 08:44:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 08:44:43] [comm] Using global sharding
[2023-07-28 08:44:43] [comm] NCCLCommunicators constructed successfully
[2023-07-28 08:44:43] [training] Using 1 GPUs
[2023-07-28 08:44:43] [logits] Applying loss function for 1 factor(s)
[2023-07-28 08:44:43] [memory] Reserving 80 MB, device gpu0
[2023-07-28 08:44:44] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 08:44:44] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:31:43] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 09:31:43] [valid] No post-processing script given for validating translator
[2023-07-28 09:31:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:31:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:31:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:31:43] [comm] Using global sharding
[2023-07-28 09:31:44] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:31:44] [training] Using 1 GPUs
[2023-07-28 09:31:44] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 09:31:45] Allocating memory for general optimizer shards
[2023-07-28 09:31:45] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:31:46] Loading Adam parameters
[2023-07-28 09:31:46] [memory] Reserving 322 MB, device gpu0
[2023-07-28 09:31:46] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:31:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 09:31:46] [data] Restoring the corpus state to epoch 191, batch 7363
[2023-07-28 09:31:46] [data] Shuffling data
[2023-07-28 09:31:46] [data] Done reading 20,192 sentences
[2023-07-28 09:31:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 09:31:46] Training started
[2023-07-28 09:31:46] Training finished
[2023-07-28 09:31:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:31:50] [marian] Running on node18.datos.cluster.uy as process 22507 with command line:
[2023-07-28 09:31:50] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 09:31:50] [config] after: 0e
[2023-07-28 09:31:50] [config] after-batches: 0
[2023-07-28 09:31:50] [config] after-epochs: 200
[2023-07-28 09:31:50] [config] all-caps-every: 0
[2023-07-28 09:31:50] [config] allow-unk: false
[2023-07-28 09:31:50] [config] authors: false
[2023-07-28 09:31:50] [config] beam-size: 12
[2023-07-28 09:31:50] [config] bert-class-symbol: "[CLS]"
[2023-07-28 09:31:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 09:31:50] [config] bert-masking-fraction: 0.15
[2023-07-28 09:31:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 09:31:50] [config] bert-train-type-embeddings: true
[2023-07-28 09:31:50] [config] bert-type-vocab-size: 2
[2023-07-28 09:31:50] [config] build-info: ""
[2023-07-28 09:31:50] [config] check-gradient-nan: false
[2023-07-28 09:31:50] [config] check-nan: false
[2023-07-28 09:31:50] [config] cite: false
[2023-07-28 09:31:50] [config] clip-norm: 1
[2023-07-28 09:31:50] [config] cost-scaling:
[2023-07-28 09:31:50] [config]   - 256.f
[2023-07-28 09:31:50] [config]   - 1000
[2023-07-28 09:31:50] [config]   - 2.f
[2023-07-28 09:31:50] [config]   - 256.f
[2023-07-28 09:31:50] [config] cost-type: ce-sum
[2023-07-28 09:31:50] [config] cpu-threads: 0
[2023-07-28 09:31:50] [config] data-threads: 8
[2023-07-28 09:31:50] [config] data-weighting: ""
[2023-07-28 09:31:50] [config] data-weighting-type: sentence
[2023-07-28 09:31:50] [config] dec-cell: gru
[2023-07-28 09:31:50] [config] dec-cell-base-depth: 2
[2023-07-28 09:31:50] [config] dec-cell-high-depth: 1
[2023-07-28 09:31:50] [config] dec-depth: 1
[2023-07-28 09:31:50] [config] devices:
[2023-07-28 09:31:50] [config]   - 0
[2023-07-28 09:31:50] [config] dim-emb: 512
[2023-07-28 09:31:50] [config] dim-rnn: 1024
[2023-07-28 09:31:50] [config] dim-vocabs:
[2023-07-28 09:31:50] [config]   - 16384
[2023-07-28 09:31:50] [config]   - 16384
[2023-07-28 09:31:50] [config] disp-first: 0
[2023-07-28 09:31:50] [config] disp-freq: 1000u
[2023-07-28 09:31:50] [config] disp-label-counts: true
[2023-07-28 09:31:50] [config] dropout-rnn: 0
[2023-07-28 09:31:50] [config] dropout-src: 0
[2023-07-28 09:31:50] [config] dropout-trg: 0
[2023-07-28 09:31:50] [config] dump-config: ""
[2023-07-28 09:31:50] [config] dynamic-gradient-scaling:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] early-stopping: 1000
[2023-07-28 09:31:50] [config] early-stopping-on: first
[2023-07-28 09:31:50] [config] embedding-fix-src: false
[2023-07-28 09:31:50] [config] embedding-fix-trg: false
[2023-07-28 09:31:50] [config] embedding-normalization: false
[2023-07-28 09:31:50] [config] embedding-vectors:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] enc-cell: gru
[2023-07-28 09:31:50] [config] enc-cell-depth: 1
[2023-07-28 09:31:50] [config] enc-depth: 1
[2023-07-28 09:31:50] [config] enc-type: bidirectional
[2023-07-28 09:31:50] [config] english-title-case-every: 0
[2023-07-28 09:31:50] [config] exponential-smoothing: 0
[2023-07-28 09:31:50] [config] factor-weight: 1
[2023-07-28 09:31:50] [config] factors-combine: sum
[2023-07-28 09:31:50] [config] factors-dim-emb: 0
[2023-07-28 09:31:50] [config] gradient-checkpointing: false
[2023-07-28 09:31:50] [config] gradient-norm-average-window: 100
[2023-07-28 09:31:50] [config] guided-alignment: none
[2023-07-28 09:31:50] [config] guided-alignment-cost: mse
[2023-07-28 09:31:50] [config] guided-alignment-weight: 0.1
[2023-07-28 09:31:50] [config] ignore-model-config: false
[2023-07-28 09:31:50] [config] input-types:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] interpolate-env-vars: false
[2023-07-28 09:31:50] [config] keep-best: false
[2023-07-28 09:31:50] [config] label-smoothing: 0
[2023-07-28 09:31:50] [config] layer-normalization: false
[2023-07-28 09:31:50] [config] learn-rate: 0.0001
[2023-07-28 09:31:50] [config] lemma-dependency: ""
[2023-07-28 09:31:50] [config] lemma-dim-emb: 0
[2023-07-28 09:31:50] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 09:31:50] [config] log-level: info
[2023-07-28 09:31:50] [config] log-time-zone: ""
[2023-07-28 09:31:50] [config] logical-epoch:
[2023-07-28 09:31:50] [config]   - 1e
[2023-07-28 09:31:50] [config]   - 0
[2023-07-28 09:31:50] [config] lr-decay: 0
[2023-07-28 09:31:50] [config] lr-decay-freq: 50000
[2023-07-28 09:31:50] [config] lr-decay-inv-sqrt:
[2023-07-28 09:31:50] [config]   - 0
[2023-07-28 09:31:50] [config] lr-decay-repeat-warmup: false
[2023-07-28 09:31:50] [config] lr-decay-reset-optimizer: false
[2023-07-28 09:31:50] [config] lr-decay-start:
[2023-07-28 09:31:50] [config]   - 10
[2023-07-28 09:31:50] [config]   - 1
[2023-07-28 09:31:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 09:31:50] [config] lr-report: false
[2023-07-28 09:31:50] [config] lr-warmup: 0
[2023-07-28 09:31:50] [config] lr-warmup-at-reload: false
[2023-07-28 09:31:50] [config] lr-warmup-cycle: false
[2023-07-28 09:31:50] [config] lr-warmup-start-rate: 0
[2023-07-28 09:31:50] [config] max-length: 250
[2023-07-28 09:31:50] [config] max-length-crop: true
[2023-07-28 09:31:50] [config] max-length-factor: 3
[2023-07-28 09:31:50] [config] maxi-batch: 100
[2023-07-28 09:31:50] [config] maxi-batch-sort: trg
[2023-07-28 09:31:50] [config] mini-batch: 64
[2023-07-28 09:31:50] [config] mini-batch-fit: true
[2023-07-28 09:31:50] [config] mini-batch-fit-step: 10
[2023-07-28 09:31:50] [config] mini-batch-round-up: true
[2023-07-28 09:31:50] [config] mini-batch-track-lr: false
[2023-07-28 09:31:50] [config] mini-batch-warmup: 0
[2023-07-28 09:31:50] [config] mini-batch-words: 0
[2023-07-28 09:31:50] [config] mini-batch-words-ref: 0
[2023-07-28 09:31:50] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 09:31:50] [config] multi-loss-type: sum
[2023-07-28 09:31:50] [config] n-best: false
[2023-07-28 09:31:50] [config] no-nccl: false
[2023-07-28 09:31:50] [config] no-reload: false
[2023-07-28 09:31:50] [config] no-restore-corpus: false
[2023-07-28 09:31:50] [config] normalize: 0
[2023-07-28 09:31:50] [config] normalize-gradient: false
[2023-07-28 09:31:50] [config] num-devices: 0
[2023-07-28 09:31:50] [config] optimizer: adam
[2023-07-28 09:31:50] [config] optimizer-delay: 1
[2023-07-28 09:31:50] [config] optimizer-params:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] output-omit-bias: false
[2023-07-28 09:31:50] [config] overwrite: true
[2023-07-28 09:31:50] [config] precision:
[2023-07-28 09:31:50] [config]   - float16
[2023-07-28 09:31:50] [config]   - float32
[2023-07-28 09:31:50] [config] pretrained-model: ""
[2023-07-28 09:31:50] [config] quantize-biases: false
[2023-07-28 09:31:50] [config] quantize-bits: 0
[2023-07-28 09:31:50] [config] quantize-log-based: false
[2023-07-28 09:31:50] [config] quantize-optimization-steps: 0
[2023-07-28 09:31:50] [config] quiet: false
[2023-07-28 09:31:50] [config] quiet-translation: true
[2023-07-28 09:31:50] [config] relative-paths: false
[2023-07-28 09:31:50] [config] right-left: false
[2023-07-28 09:31:50] [config] save-freq: 10000u
[2023-07-28 09:31:50] [config] seed: 1234
[2023-07-28 09:31:50] [config] sentencepiece-alphas:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] sentencepiece-max-lines: 2000000
[2023-07-28 09:31:50] [config] sentencepiece-options: ""
[2023-07-28 09:31:50] [config] sharding: global
[2023-07-28 09:31:50] [config] shuffle: data
[2023-07-28 09:31:50] [config] shuffle-in-ram: false
[2023-07-28 09:31:50] [config] sigterm: save-and-exit
[2023-07-28 09:31:50] [config] skip: false
[2023-07-28 09:31:50] [config] sqlite: ""
[2023-07-28 09:31:50] [config] sqlite-drop: false
[2023-07-28 09:31:50] [config] sync-freq: 200u
[2023-07-28 09:31:50] [config] sync-sgd: false
[2023-07-28 09:31:50] [config] tempdir: /tmp
[2023-07-28 09:31:50] [config] tied-embeddings: false
[2023-07-28 09:31:50] [config] tied-embeddings-all: true
[2023-07-28 09:31:50] [config] tied-embeddings-src: false
[2023-07-28 09:31:50] [config] train-embedder-rank:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] train-sets:
[2023-07-28 09:31:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 09:31:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 09:31:50] [config] transformer-aan-activation: swish
[2023-07-28 09:31:50] [config] transformer-aan-depth: 2
[2023-07-28 09:31:50] [config] transformer-aan-nogate: false
[2023-07-28 09:31:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 09:31:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 09:31:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 09:31:50] [config] transformer-depth-scaling: false
[2023-07-28 09:31:50] [config] transformer-dim-aan: 2048
[2023-07-28 09:31:50] [config] transformer-dim-ffn: 2048
[2023-07-28 09:31:50] [config] transformer-dropout: 0
[2023-07-28 09:31:50] [config] transformer-dropout-attention: 0
[2023-07-28 09:31:50] [config] transformer-dropout-ffn: 0
[2023-07-28 09:31:50] [config] transformer-ffn-activation: swish
[2023-07-28 09:31:50] [config] transformer-ffn-depth: 2
[2023-07-28 09:31:50] [config] transformer-guided-alignment-layer: last
[2023-07-28 09:31:50] [config] transformer-heads: 8
[2023-07-28 09:31:50] [config] transformer-no-projection: false
[2023-07-28 09:31:50] [config] transformer-pool: false
[2023-07-28 09:31:50] [config] transformer-postprocess: dan
[2023-07-28 09:31:50] [config] transformer-postprocess-emb: d
[2023-07-28 09:31:50] [config] transformer-postprocess-top: ""
[2023-07-28 09:31:50] [config] transformer-preprocess: ""
[2023-07-28 09:31:50] [config] transformer-tied-layers:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] transformer-train-position-embeddings: false
[2023-07-28 09:31:50] [config] tsv: false
[2023-07-28 09:31:50] [config] tsv-fields: 0
[2023-07-28 09:31:50] [config] type: s2s
[2023-07-28 09:31:50] [config] ulr: false
[2023-07-28 09:31:50] [config] ulr-dim-emb: 0
[2023-07-28 09:31:50] [config] ulr-dropout: 0
[2023-07-28 09:31:50] [config] ulr-keys-vectors: ""
[2023-07-28 09:31:50] [config] ulr-query-vectors: ""
[2023-07-28 09:31:50] [config] ulr-softmax-temperature: 1
[2023-07-28 09:31:50] [config] ulr-trainable-transformation: false
[2023-07-28 09:31:50] [config] unlikelihood-loss: false
[2023-07-28 09:31:50] [config] valid-freq: 50000000
[2023-07-28 09:31:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 09:31:50] [config] valid-max-length: 1000
[2023-07-28 09:31:50] [config] valid-metrics:
[2023-07-28 09:31:50] [config]   - translation
[2023-07-28 09:31:50] [config] valid-mini-batch: 32
[2023-07-28 09:31:50] [config] valid-reset-stalled: false
[2023-07-28 09:31:50] [config] valid-script-args:
[2023-07-28 09:31:50] [config]   []
[2023-07-28 09:31:50] [config] valid-script-path: ""
[2023-07-28 09:31:50] [config] valid-sets:
[2023-07-28 09:31:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 09:31:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 09:31:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 09:31:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:31:50] [config] vocabs:
[2023-07-28 09:31:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:31:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:31:50] [config] word-penalty: 0
[2023-07-28 09:31:50] [config] word-scores: false
[2023-07-28 09:31:50] [config] workspace: 5500
[2023-07-28 09:31:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 09:31:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:31:50] [training] Using single-device training
[2023-07-28 09:31:50] Synced seed 1234
[2023-07-28 09:31:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 09:31:50] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 09:31:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 09:31:50] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 09:31:50] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 09:31:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 09:31:50] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 09:31:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 09:31:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 09:31:51] [comm] Using global sharding
[2023-07-28 09:31:51] [comm] NCCLCommunicators constructed successfully
[2023-07-28 09:31:51] [training] Using 1 GPUs
[2023-07-28 09:31:51] [logits] Applying loss function for 1 factor(s)
[2023-07-28 09:31:51] [memory] Reserving 80 MB, device gpu0
[2023-07-28 09:31:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 09:31:52] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:19:20] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 10:19:20] [valid] No post-processing script given for validating translator
[2023-07-28 10:19:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:19:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:19:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:19:21] [comm] Using global sharding
[2023-07-28 10:19:21] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:19:21] [training] Using 1 GPUs
[2023-07-28 10:19:21] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 10:19:22] Allocating memory for general optimizer shards
[2023-07-28 10:19:22] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:19:22] Loading Adam parameters
[2023-07-28 10:19:22] [memory] Reserving 322 MB, device gpu0
[2023-07-28 10:19:22] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:19:22] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 10:19:22] [data] Restoring the corpus state to epoch 201, batch 7750
[2023-07-28 10:19:22] [data] Shuffling data
[2023-07-28 10:19:22] [data] Done reading 20,192 sentences
[2023-07-28 10:19:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 10:19:23] Training started
[2023-07-28 10:19:23] Training finished
[2023-07-28 10:19:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:19:26] [marian] Running on node18.datos.cluster.uy as process 25418 with command line:
[2023-07-28 10:19:26] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 210 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 10:19:26] [config] after: 0e
[2023-07-28 10:19:26] [config] after-batches: 0
[2023-07-28 10:19:26] [config] after-epochs: 210
[2023-07-28 10:19:26] [config] all-caps-every: 0
[2023-07-28 10:19:26] [config] allow-unk: false
[2023-07-28 10:19:26] [config] authors: false
[2023-07-28 10:19:26] [config] beam-size: 12
[2023-07-28 10:19:26] [config] bert-class-symbol: "[CLS]"
[2023-07-28 10:19:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 10:19:26] [config] bert-masking-fraction: 0.15
[2023-07-28 10:19:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 10:19:26] [config] bert-train-type-embeddings: true
[2023-07-28 10:19:26] [config] bert-type-vocab-size: 2
[2023-07-28 10:19:26] [config] build-info: ""
[2023-07-28 10:19:26] [config] check-gradient-nan: false
[2023-07-28 10:19:26] [config] check-nan: false
[2023-07-28 10:19:26] [config] cite: false
[2023-07-28 10:19:26] [config] clip-norm: 1
[2023-07-28 10:19:26] [config] cost-scaling:
[2023-07-28 10:19:26] [config]   - 256.f
[2023-07-28 10:19:26] [config]   - 1000
[2023-07-28 10:19:26] [config]   - 2.f
[2023-07-28 10:19:26] [config]   - 256.f
[2023-07-28 10:19:26] [config] cost-type: ce-sum
[2023-07-28 10:19:26] [config] cpu-threads: 0
[2023-07-28 10:19:26] [config] data-threads: 8
[2023-07-28 10:19:26] [config] data-weighting: ""
[2023-07-28 10:19:26] [config] data-weighting-type: sentence
[2023-07-28 10:19:26] [config] dec-cell: gru
[2023-07-28 10:19:26] [config] dec-cell-base-depth: 2
[2023-07-28 10:19:26] [config] dec-cell-high-depth: 1
[2023-07-28 10:19:26] [config] dec-depth: 1
[2023-07-28 10:19:26] [config] devices:
[2023-07-28 10:19:26] [config]   - 0
[2023-07-28 10:19:26] [config] dim-emb: 512
[2023-07-28 10:19:26] [config] dim-rnn: 1024
[2023-07-28 10:19:26] [config] dim-vocabs:
[2023-07-28 10:19:26] [config]   - 16384
[2023-07-28 10:19:26] [config]   - 16384
[2023-07-28 10:19:26] [config] disp-first: 0
[2023-07-28 10:19:26] [config] disp-freq: 1000u
[2023-07-28 10:19:26] [config] disp-label-counts: true
[2023-07-28 10:19:26] [config] dropout-rnn: 0
[2023-07-28 10:19:26] [config] dropout-src: 0
[2023-07-28 10:19:26] [config] dropout-trg: 0
[2023-07-28 10:19:26] [config] dump-config: ""
[2023-07-28 10:19:26] [config] dynamic-gradient-scaling:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] early-stopping: 1000
[2023-07-28 10:19:26] [config] early-stopping-on: first
[2023-07-28 10:19:26] [config] embedding-fix-src: false
[2023-07-28 10:19:26] [config] embedding-fix-trg: false
[2023-07-28 10:19:26] [config] embedding-normalization: false
[2023-07-28 10:19:26] [config] embedding-vectors:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] enc-cell: gru
[2023-07-28 10:19:26] [config] enc-cell-depth: 1
[2023-07-28 10:19:26] [config] enc-depth: 1
[2023-07-28 10:19:26] [config] enc-type: bidirectional
[2023-07-28 10:19:26] [config] english-title-case-every: 0
[2023-07-28 10:19:26] [config] exponential-smoothing: 0
[2023-07-28 10:19:26] [config] factor-weight: 1
[2023-07-28 10:19:26] [config] factors-combine: sum
[2023-07-28 10:19:26] [config] factors-dim-emb: 0
[2023-07-28 10:19:26] [config] gradient-checkpointing: false
[2023-07-28 10:19:26] [config] gradient-norm-average-window: 100
[2023-07-28 10:19:26] [config] guided-alignment: none
[2023-07-28 10:19:26] [config] guided-alignment-cost: mse
[2023-07-28 10:19:26] [config] guided-alignment-weight: 0.1
[2023-07-28 10:19:26] [config] ignore-model-config: false
[2023-07-28 10:19:26] [config] input-types:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] interpolate-env-vars: false
[2023-07-28 10:19:26] [config] keep-best: false
[2023-07-28 10:19:26] [config] label-smoothing: 0
[2023-07-28 10:19:26] [config] layer-normalization: false
[2023-07-28 10:19:26] [config] learn-rate: 0.0001
[2023-07-28 10:19:26] [config] lemma-dependency: ""
[2023-07-28 10:19:26] [config] lemma-dim-emb: 0
[2023-07-28 10:19:26] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 10:19:26] [config] log-level: info
[2023-07-28 10:19:26] [config] log-time-zone: ""
[2023-07-28 10:19:26] [config] logical-epoch:
[2023-07-28 10:19:26] [config]   - 1e
[2023-07-28 10:19:26] [config]   - 0
[2023-07-28 10:19:26] [config] lr-decay: 0
[2023-07-28 10:19:26] [config] lr-decay-freq: 50000
[2023-07-28 10:19:26] [config] lr-decay-inv-sqrt:
[2023-07-28 10:19:26] [config]   - 0
[2023-07-28 10:19:26] [config] lr-decay-repeat-warmup: false
[2023-07-28 10:19:26] [config] lr-decay-reset-optimizer: false
[2023-07-28 10:19:26] [config] lr-decay-start:
[2023-07-28 10:19:26] [config]   - 10
[2023-07-28 10:19:26] [config]   - 1
[2023-07-28 10:19:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 10:19:26] [config] lr-report: false
[2023-07-28 10:19:26] [config] lr-warmup: 0
[2023-07-28 10:19:26] [config] lr-warmup-at-reload: false
[2023-07-28 10:19:26] [config] lr-warmup-cycle: false
[2023-07-28 10:19:26] [config] lr-warmup-start-rate: 0
[2023-07-28 10:19:26] [config] max-length: 250
[2023-07-28 10:19:26] [config] max-length-crop: true
[2023-07-28 10:19:26] [config] max-length-factor: 3
[2023-07-28 10:19:26] [config] maxi-batch: 100
[2023-07-28 10:19:26] [config] maxi-batch-sort: trg
[2023-07-28 10:19:26] [config] mini-batch: 64
[2023-07-28 10:19:26] [config] mini-batch-fit: true
[2023-07-28 10:19:26] [config] mini-batch-fit-step: 10
[2023-07-28 10:19:26] [config] mini-batch-round-up: true
[2023-07-28 10:19:26] [config] mini-batch-track-lr: false
[2023-07-28 10:19:26] [config] mini-batch-warmup: 0
[2023-07-28 10:19:26] [config] mini-batch-words: 0
[2023-07-28 10:19:26] [config] mini-batch-words-ref: 0
[2023-07-28 10:19:26] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 10:19:26] [config] multi-loss-type: sum
[2023-07-28 10:19:26] [config] n-best: false
[2023-07-28 10:19:26] [config] no-nccl: false
[2023-07-28 10:19:26] [config] no-reload: false
[2023-07-28 10:19:26] [config] no-restore-corpus: false
[2023-07-28 10:19:26] [config] normalize: 0
[2023-07-28 10:19:26] [config] normalize-gradient: false
[2023-07-28 10:19:26] [config] num-devices: 0
[2023-07-28 10:19:26] [config] optimizer: adam
[2023-07-28 10:19:26] [config] optimizer-delay: 1
[2023-07-28 10:19:26] [config] optimizer-params:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] output-omit-bias: false
[2023-07-28 10:19:26] [config] overwrite: true
[2023-07-28 10:19:26] [config] precision:
[2023-07-28 10:19:26] [config]   - float16
[2023-07-28 10:19:26] [config]   - float32
[2023-07-28 10:19:26] [config] pretrained-model: ""
[2023-07-28 10:19:26] [config] quantize-biases: false
[2023-07-28 10:19:26] [config] quantize-bits: 0
[2023-07-28 10:19:26] [config] quantize-log-based: false
[2023-07-28 10:19:26] [config] quantize-optimization-steps: 0
[2023-07-28 10:19:26] [config] quiet: false
[2023-07-28 10:19:26] [config] quiet-translation: true
[2023-07-28 10:19:26] [config] relative-paths: false
[2023-07-28 10:19:26] [config] right-left: false
[2023-07-28 10:19:26] [config] save-freq: 10000u
[2023-07-28 10:19:26] [config] seed: 1234
[2023-07-28 10:19:26] [config] sentencepiece-alphas:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] sentencepiece-max-lines: 2000000
[2023-07-28 10:19:26] [config] sentencepiece-options: ""
[2023-07-28 10:19:26] [config] sharding: global
[2023-07-28 10:19:26] [config] shuffle: data
[2023-07-28 10:19:26] [config] shuffle-in-ram: false
[2023-07-28 10:19:26] [config] sigterm: save-and-exit
[2023-07-28 10:19:26] [config] skip: false
[2023-07-28 10:19:26] [config] sqlite: ""
[2023-07-28 10:19:26] [config] sqlite-drop: false
[2023-07-28 10:19:26] [config] sync-freq: 200u
[2023-07-28 10:19:26] [config] sync-sgd: false
[2023-07-28 10:19:26] [config] tempdir: /tmp
[2023-07-28 10:19:26] [config] tied-embeddings: false
[2023-07-28 10:19:26] [config] tied-embeddings-all: true
[2023-07-28 10:19:26] [config] tied-embeddings-src: false
[2023-07-28 10:19:26] [config] train-embedder-rank:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] train-sets:
[2023-07-28 10:19:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 10:19:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 10:19:26] [config] transformer-aan-activation: swish
[2023-07-28 10:19:26] [config] transformer-aan-depth: 2
[2023-07-28 10:19:26] [config] transformer-aan-nogate: false
[2023-07-28 10:19:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 10:19:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 10:19:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 10:19:26] [config] transformer-depth-scaling: false
[2023-07-28 10:19:26] [config] transformer-dim-aan: 2048
[2023-07-28 10:19:26] [config] transformer-dim-ffn: 2048
[2023-07-28 10:19:26] [config] transformer-dropout: 0
[2023-07-28 10:19:26] [config] transformer-dropout-attention: 0
[2023-07-28 10:19:26] [config] transformer-dropout-ffn: 0
[2023-07-28 10:19:26] [config] transformer-ffn-activation: swish
[2023-07-28 10:19:26] [config] transformer-ffn-depth: 2
[2023-07-28 10:19:26] [config] transformer-guided-alignment-layer: last
[2023-07-28 10:19:26] [config] transformer-heads: 8
[2023-07-28 10:19:26] [config] transformer-no-projection: false
[2023-07-28 10:19:26] [config] transformer-pool: false
[2023-07-28 10:19:26] [config] transformer-postprocess: dan
[2023-07-28 10:19:26] [config] transformer-postprocess-emb: d
[2023-07-28 10:19:26] [config] transformer-postprocess-top: ""
[2023-07-28 10:19:26] [config] transformer-preprocess: ""
[2023-07-28 10:19:26] [config] transformer-tied-layers:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] transformer-train-position-embeddings: false
[2023-07-28 10:19:26] [config] tsv: false
[2023-07-28 10:19:26] [config] tsv-fields: 0
[2023-07-28 10:19:26] [config] type: s2s
[2023-07-28 10:19:26] [config] ulr: false
[2023-07-28 10:19:26] [config] ulr-dim-emb: 0
[2023-07-28 10:19:26] [config] ulr-dropout: 0
[2023-07-28 10:19:26] [config] ulr-keys-vectors: ""
[2023-07-28 10:19:26] [config] ulr-query-vectors: ""
[2023-07-28 10:19:26] [config] ulr-softmax-temperature: 1
[2023-07-28 10:19:26] [config] ulr-trainable-transformation: false
[2023-07-28 10:19:26] [config] unlikelihood-loss: false
[2023-07-28 10:19:26] [config] valid-freq: 50000000
[2023-07-28 10:19:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 10:19:26] [config] valid-max-length: 1000
[2023-07-28 10:19:26] [config] valid-metrics:
[2023-07-28 10:19:26] [config]   - translation
[2023-07-28 10:19:26] [config] valid-mini-batch: 32
[2023-07-28 10:19:26] [config] valid-reset-stalled: false
[2023-07-28 10:19:26] [config] valid-script-args:
[2023-07-28 10:19:26] [config]   []
[2023-07-28 10:19:26] [config] valid-script-path: ""
[2023-07-28 10:19:26] [config] valid-sets:
[2023-07-28 10:19:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 10:19:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 10:19:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 10:19:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:19:26] [config] vocabs:
[2023-07-28 10:19:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:19:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:19:26] [config] word-penalty: 0
[2023-07-28 10:19:26] [config] word-scores: false
[2023-07-28 10:19:26] [config] workspace: 5500
[2023-07-28 10:19:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 10:19:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:19:26] [training] Using single-device training
[2023-07-28 10:19:28] Synced seed 1234
[2023-07-28 10:19:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 10:19:28] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 10:19:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 10:19:28] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 10:19:28] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 10:19:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 10:19:28] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 10:19:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 10:19:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 10:19:29] [comm] Using global sharding
[2023-07-28 10:19:29] [comm] NCCLCommunicators constructed successfully
[2023-07-28 10:19:29] [training] Using 1 GPUs
[2023-07-28 10:19:29] [logits] Applying loss function for 1 factor(s)
[2023-07-28 10:19:29] [memory] Reserving 80 MB, device gpu0
[2023-07-28 10:19:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 10:19:30] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:06:40] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 11:06:40] [valid] No post-processing script given for validating translator
[2023-07-28 11:06:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:06:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:06:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:06:40] [comm] Using global sharding
[2023-07-28 11:06:40] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:06:40] [training] Using 1 GPUs
[2023-07-28 11:06:40] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 11:06:41] Allocating memory for general optimizer shards
[2023-07-28 11:06:41] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:06:41] Loading Adam parameters
[2023-07-28 11:06:42] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:06:42] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:06:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 11:06:42] [data] Restoring the corpus state to epoch 211, batch 8138
[2023-07-28 11:06:42] [data] Shuffling data
[2023-07-28 11:06:42] [data] Done reading 20,192 sentences
[2023-07-28 11:06:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:06:42] Training started
[2023-07-28 11:06:42] Training finished
[2023-07-28 11:06:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:06:46] [marian] Running on node18.datos.cluster.uy as process 28653 with command line:
[2023-07-28 11:06:46] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 220 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 11:06:46] [config] after: 0e
[2023-07-28 11:06:46] [config] after-batches: 0
[2023-07-28 11:06:46] [config] after-epochs: 220
[2023-07-28 11:06:46] [config] all-caps-every: 0
[2023-07-28 11:06:46] [config] allow-unk: false
[2023-07-28 11:06:46] [config] authors: false
[2023-07-28 11:06:46] [config] beam-size: 12
[2023-07-28 11:06:46] [config] bert-class-symbol: "[CLS]"
[2023-07-28 11:06:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 11:06:46] [config] bert-masking-fraction: 0.15
[2023-07-28 11:06:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 11:06:46] [config] bert-train-type-embeddings: true
[2023-07-28 11:06:46] [config] bert-type-vocab-size: 2
[2023-07-28 11:06:46] [config] build-info: ""
[2023-07-28 11:06:46] [config] check-gradient-nan: false
[2023-07-28 11:06:46] [config] check-nan: false
[2023-07-28 11:06:46] [config] cite: false
[2023-07-28 11:06:46] [config] clip-norm: 1
[2023-07-28 11:06:46] [config] cost-scaling:
[2023-07-28 11:06:46] [config]   - 256.f
[2023-07-28 11:06:46] [config]   - 1000
[2023-07-28 11:06:46] [config]   - 2.f
[2023-07-28 11:06:46] [config]   - 256.f
[2023-07-28 11:06:46] [config] cost-type: ce-sum
[2023-07-28 11:06:46] [config] cpu-threads: 0
[2023-07-28 11:06:46] [config] data-threads: 8
[2023-07-28 11:06:46] [config] data-weighting: ""
[2023-07-28 11:06:46] [config] data-weighting-type: sentence
[2023-07-28 11:06:46] [config] dec-cell: gru
[2023-07-28 11:06:46] [config] dec-cell-base-depth: 2
[2023-07-28 11:06:46] [config] dec-cell-high-depth: 1
[2023-07-28 11:06:46] [config] dec-depth: 1
[2023-07-28 11:06:46] [config] devices:
[2023-07-28 11:06:46] [config]   - 0
[2023-07-28 11:06:46] [config] dim-emb: 512
[2023-07-28 11:06:46] [config] dim-rnn: 1024
[2023-07-28 11:06:46] [config] dim-vocabs:
[2023-07-28 11:06:46] [config]   - 16384
[2023-07-28 11:06:46] [config]   - 16384
[2023-07-28 11:06:46] [config] disp-first: 0
[2023-07-28 11:06:46] [config] disp-freq: 1000u
[2023-07-28 11:06:46] [config] disp-label-counts: true
[2023-07-28 11:06:46] [config] dropout-rnn: 0
[2023-07-28 11:06:46] [config] dropout-src: 0
[2023-07-28 11:06:46] [config] dropout-trg: 0
[2023-07-28 11:06:46] [config] dump-config: ""
[2023-07-28 11:06:46] [config] dynamic-gradient-scaling:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] early-stopping: 1000
[2023-07-28 11:06:46] [config] early-stopping-on: first
[2023-07-28 11:06:46] [config] embedding-fix-src: false
[2023-07-28 11:06:46] [config] embedding-fix-trg: false
[2023-07-28 11:06:46] [config] embedding-normalization: false
[2023-07-28 11:06:46] [config] embedding-vectors:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] enc-cell: gru
[2023-07-28 11:06:46] [config] enc-cell-depth: 1
[2023-07-28 11:06:46] [config] enc-depth: 1
[2023-07-28 11:06:46] [config] enc-type: bidirectional
[2023-07-28 11:06:46] [config] english-title-case-every: 0
[2023-07-28 11:06:46] [config] exponential-smoothing: 0
[2023-07-28 11:06:46] [config] factor-weight: 1
[2023-07-28 11:06:46] [config] factors-combine: sum
[2023-07-28 11:06:46] [config] factors-dim-emb: 0
[2023-07-28 11:06:46] [config] gradient-checkpointing: false
[2023-07-28 11:06:46] [config] gradient-norm-average-window: 100
[2023-07-28 11:06:46] [config] guided-alignment: none
[2023-07-28 11:06:46] [config] guided-alignment-cost: mse
[2023-07-28 11:06:46] [config] guided-alignment-weight: 0.1
[2023-07-28 11:06:46] [config] ignore-model-config: false
[2023-07-28 11:06:46] [config] input-types:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] interpolate-env-vars: false
[2023-07-28 11:06:46] [config] keep-best: false
[2023-07-28 11:06:46] [config] label-smoothing: 0
[2023-07-28 11:06:46] [config] layer-normalization: false
[2023-07-28 11:06:46] [config] learn-rate: 0.0001
[2023-07-28 11:06:46] [config] lemma-dependency: ""
[2023-07-28 11:06:46] [config] lemma-dim-emb: 0
[2023-07-28 11:06:46] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 11:06:46] [config] log-level: info
[2023-07-28 11:06:46] [config] log-time-zone: ""
[2023-07-28 11:06:46] [config] logical-epoch:
[2023-07-28 11:06:46] [config]   - 1e
[2023-07-28 11:06:46] [config]   - 0
[2023-07-28 11:06:46] [config] lr-decay: 0
[2023-07-28 11:06:46] [config] lr-decay-freq: 50000
[2023-07-28 11:06:46] [config] lr-decay-inv-sqrt:
[2023-07-28 11:06:46] [config]   - 0
[2023-07-28 11:06:46] [config] lr-decay-repeat-warmup: false
[2023-07-28 11:06:46] [config] lr-decay-reset-optimizer: false
[2023-07-28 11:06:46] [config] lr-decay-start:
[2023-07-28 11:06:46] [config]   - 10
[2023-07-28 11:06:46] [config]   - 1
[2023-07-28 11:06:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 11:06:46] [config] lr-report: false
[2023-07-28 11:06:46] [config] lr-warmup: 0
[2023-07-28 11:06:46] [config] lr-warmup-at-reload: false
[2023-07-28 11:06:46] [config] lr-warmup-cycle: false
[2023-07-28 11:06:46] [config] lr-warmup-start-rate: 0
[2023-07-28 11:06:46] [config] max-length: 250
[2023-07-28 11:06:46] [config] max-length-crop: true
[2023-07-28 11:06:46] [config] max-length-factor: 3
[2023-07-28 11:06:46] [config] maxi-batch: 100
[2023-07-28 11:06:46] [config] maxi-batch-sort: trg
[2023-07-28 11:06:46] [config] mini-batch: 64
[2023-07-28 11:06:46] [config] mini-batch-fit: true
[2023-07-28 11:06:46] [config] mini-batch-fit-step: 10
[2023-07-28 11:06:46] [config] mini-batch-round-up: true
[2023-07-28 11:06:46] [config] mini-batch-track-lr: false
[2023-07-28 11:06:46] [config] mini-batch-warmup: 0
[2023-07-28 11:06:46] [config] mini-batch-words: 0
[2023-07-28 11:06:46] [config] mini-batch-words-ref: 0
[2023-07-28 11:06:46] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 11:06:46] [config] multi-loss-type: sum
[2023-07-28 11:06:46] [config] n-best: false
[2023-07-28 11:06:46] [config] no-nccl: false
[2023-07-28 11:06:46] [config] no-reload: false
[2023-07-28 11:06:46] [config] no-restore-corpus: false
[2023-07-28 11:06:46] [config] normalize: 0
[2023-07-28 11:06:46] [config] normalize-gradient: false
[2023-07-28 11:06:46] [config] num-devices: 0
[2023-07-28 11:06:46] [config] optimizer: adam
[2023-07-28 11:06:46] [config] optimizer-delay: 1
[2023-07-28 11:06:46] [config] optimizer-params:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] output-omit-bias: false
[2023-07-28 11:06:46] [config] overwrite: true
[2023-07-28 11:06:46] [config] precision:
[2023-07-28 11:06:46] [config]   - float16
[2023-07-28 11:06:46] [config]   - float32
[2023-07-28 11:06:46] [config] pretrained-model: ""
[2023-07-28 11:06:46] [config] quantize-biases: false
[2023-07-28 11:06:46] [config] quantize-bits: 0
[2023-07-28 11:06:46] [config] quantize-log-based: false
[2023-07-28 11:06:46] [config] quantize-optimization-steps: 0
[2023-07-28 11:06:46] [config] quiet: false
[2023-07-28 11:06:46] [config] quiet-translation: true
[2023-07-28 11:06:46] [config] relative-paths: false
[2023-07-28 11:06:46] [config] right-left: false
[2023-07-28 11:06:46] [config] save-freq: 10000u
[2023-07-28 11:06:46] [config] seed: 1234
[2023-07-28 11:06:46] [config] sentencepiece-alphas:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] sentencepiece-max-lines: 2000000
[2023-07-28 11:06:46] [config] sentencepiece-options: ""
[2023-07-28 11:06:46] [config] sharding: global
[2023-07-28 11:06:46] [config] shuffle: data
[2023-07-28 11:06:46] [config] shuffle-in-ram: false
[2023-07-28 11:06:46] [config] sigterm: save-and-exit
[2023-07-28 11:06:46] [config] skip: false
[2023-07-28 11:06:46] [config] sqlite: ""
[2023-07-28 11:06:46] [config] sqlite-drop: false
[2023-07-28 11:06:46] [config] sync-freq: 200u
[2023-07-28 11:06:46] [config] sync-sgd: false
[2023-07-28 11:06:46] [config] tempdir: /tmp
[2023-07-28 11:06:46] [config] tied-embeddings: false
[2023-07-28 11:06:46] [config] tied-embeddings-all: true
[2023-07-28 11:06:46] [config] tied-embeddings-src: false
[2023-07-28 11:06:46] [config] train-embedder-rank:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] train-sets:
[2023-07-28 11:06:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 11:06:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 11:06:46] [config] transformer-aan-activation: swish
[2023-07-28 11:06:46] [config] transformer-aan-depth: 2
[2023-07-28 11:06:46] [config] transformer-aan-nogate: false
[2023-07-28 11:06:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 11:06:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 11:06:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 11:06:46] [config] transformer-depth-scaling: false
[2023-07-28 11:06:46] [config] transformer-dim-aan: 2048
[2023-07-28 11:06:46] [config] transformer-dim-ffn: 2048
[2023-07-28 11:06:46] [config] transformer-dropout: 0
[2023-07-28 11:06:46] [config] transformer-dropout-attention: 0
[2023-07-28 11:06:46] [config] transformer-dropout-ffn: 0
[2023-07-28 11:06:46] [config] transformer-ffn-activation: swish
[2023-07-28 11:06:46] [config] transformer-ffn-depth: 2
[2023-07-28 11:06:46] [config] transformer-guided-alignment-layer: last
[2023-07-28 11:06:46] [config] transformer-heads: 8
[2023-07-28 11:06:46] [config] transformer-no-projection: false
[2023-07-28 11:06:46] [config] transformer-pool: false
[2023-07-28 11:06:46] [config] transformer-postprocess: dan
[2023-07-28 11:06:46] [config] transformer-postprocess-emb: d
[2023-07-28 11:06:46] [config] transformer-postprocess-top: ""
[2023-07-28 11:06:46] [config] transformer-preprocess: ""
[2023-07-28 11:06:46] [config] transformer-tied-layers:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] transformer-train-position-embeddings: false
[2023-07-28 11:06:46] [config] tsv: false
[2023-07-28 11:06:46] [config] tsv-fields: 0
[2023-07-28 11:06:46] [config] type: s2s
[2023-07-28 11:06:46] [config] ulr: false
[2023-07-28 11:06:46] [config] ulr-dim-emb: 0
[2023-07-28 11:06:46] [config] ulr-dropout: 0
[2023-07-28 11:06:46] [config] ulr-keys-vectors: ""
[2023-07-28 11:06:46] [config] ulr-query-vectors: ""
[2023-07-28 11:06:46] [config] ulr-softmax-temperature: 1
[2023-07-28 11:06:46] [config] ulr-trainable-transformation: false
[2023-07-28 11:06:46] [config] unlikelihood-loss: false
[2023-07-28 11:06:46] [config] valid-freq: 50000000
[2023-07-28 11:06:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 11:06:46] [config] valid-max-length: 1000
[2023-07-28 11:06:46] [config] valid-metrics:
[2023-07-28 11:06:46] [config]   - translation
[2023-07-28 11:06:46] [config] valid-mini-batch: 32
[2023-07-28 11:06:46] [config] valid-reset-stalled: false
[2023-07-28 11:06:46] [config] valid-script-args:
[2023-07-28 11:06:46] [config]   []
[2023-07-28 11:06:46] [config] valid-script-path: ""
[2023-07-28 11:06:46] [config] valid-sets:
[2023-07-28 11:06:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 11:06:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 11:06:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 11:06:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:06:46] [config] vocabs:
[2023-07-28 11:06:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:06:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:06:46] [config] word-penalty: 0
[2023-07-28 11:06:46] [config] word-scores: false
[2023-07-28 11:06:46] [config] workspace: 5500
[2023-07-28 11:06:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 11:06:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:06:46] [training] Using single-device training
[2023-07-28 11:06:46] Synced seed 1234
[2023-07-28 11:06:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 11:06:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 11:06:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 11:06:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 11:06:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 11:06:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:06:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 11:06:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:06:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:06:47] [comm] Using global sharding
[2023-07-28 11:06:47] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:06:47] [training] Using 1 GPUs
[2023-07-28 11:06:47] [logits] Applying loss function for 1 factor(s)
[2023-07-28 11:06:47] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:06:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 11:06:48] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:51:52] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 11:51:52] [valid] No post-processing script given for validating translator
[2023-07-28 11:51:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 11:51:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 11:51:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 11:51:52] [comm] Using global sharding
[2023-07-28 11:51:52] [comm] NCCLCommunicators constructed successfully
[2023-07-28 11:51:52] [training] Using 1 GPUs
[2023-07-28 11:51:52] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 11:51:53] Allocating memory for general optimizer shards
[2023-07-28 11:51:53] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:51:53] Loading Adam parameters
[2023-07-28 11:51:54] [memory] Reserving 322 MB, device gpu0
[2023-07-28 11:51:54] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:51:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 11:51:54] [data] Restoring the corpus state to epoch 211, batch 8138
[2023-07-28 11:51:54] [data] Shuffling data
[2023-07-28 11:51:54] [data] Done reading 20,192 sentences
[2023-07-28 11:51:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 11:51:54] Training started
[2023-07-28 11:51:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 11:51:55] [memory] Reserving 80 MB, device gpu0
[2023-07-28 11:52:01] Parameter type float16, optimization type float32, casting types true
[2023-07-28 11:56:13] Seen 20,192 samples
[2023-07-28 11:56:13] Starting data epoch 212 in logical epoch 212
[2023-07-28 11:56:13] [data] Shuffling data
[2023-07-28 11:56:13] [data] Done reading 20,192 sentences
[2023-07-28 11:56:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:00:33] Seen 20,192 samples
[2023-07-28 12:00:33] Starting data epoch 213 in logical epoch 213
[2023-07-28 12:00:33] [data] Shuffling data
[2023-07-28 12:00:33] [data] Done reading 20,192 sentences
[2023-07-28 12:00:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:04:55] Seen 20,192 samples
[2023-07-28 12:04:55] Starting data epoch 214 in logical epoch 214
[2023-07-28 12:04:55] [data] Shuffling data
[2023-07-28 12:04:55] [data] Done reading 20,192 sentences
[2023-07-28 12:04:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:09:18] Seen 20,192 samples
[2023-07-28 12:09:18] Starting data epoch 215 in logical epoch 215
[2023-07-28 12:09:18] [data] Shuffling data
[2023-07-28 12:09:18] [data] Done reading 20,192 sentences
[2023-07-28 12:09:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:13:31] Seen 20,192 samples
[2023-07-28 12:13:31] Starting data epoch 216 in logical epoch 216
[2023-07-28 12:13:31] [data] Shuffling data
[2023-07-28 12:13:31] [data] Done reading 20,192 sentences
[2023-07-28 12:13:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:17:58] Seen 20,192 samples
[2023-07-28 12:17:58] Starting data epoch 217 in logical epoch 217
[2023-07-28 12:17:58] [data] Shuffling data
[2023-07-28 12:17:58] [data] Done reading 20,192 sentences
[2023-07-28 12:17:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:22:17] Seen 20,192 samples
[2023-07-28 12:22:17] Starting data epoch 218 in logical epoch 218
[2023-07-28 12:22:17] [data] Shuffling data
[2023-07-28 12:22:17] [data] Done reading 20,192 sentences
[2023-07-28 12:22:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:26:37] Seen 20,192 samples
[2023-07-28 12:26:37] Starting data epoch 219 in logical epoch 219
[2023-07-28 12:26:37] [data] Shuffling data
[2023-07-28 12:26:37] [data] Done reading 20,192 sentences
[2023-07-28 12:26:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:31:00] Seen 20,192 samples
[2023-07-28 12:31:00] Starting data epoch 220 in logical epoch 220
[2023-07-28 12:31:00] [data] Shuffling data
[2023-07-28 12:31:00] [data] Done reading 20,192 sentences
[2023-07-28 12:31:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 12:35:31] Seen 20,192 samples
[2023-07-28 12:35:31] Starting data epoch 221 in logical epoch 221
[2023-07-28 12:35:31] Training finished
[2023-07-28 12:37:30] [valid] Ep. 221 : Up. 8528 : translation : 0 : new best
[2023-07-28 12:37:30] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 12:37:33] Saving Adam parameters
[2023-07-28 12:37:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 12:37:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:37:44] [marian] Running on node18.datos.cluster.uy as process 34517 with command line:
[2023-07-28 12:37:44] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 230 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 12:37:44] [config] after: 0e
[2023-07-28 12:37:44] [config] after-batches: 0
[2023-07-28 12:37:44] [config] after-epochs: 230
[2023-07-28 12:37:44] [config] all-caps-every: 0
[2023-07-28 12:37:44] [config] allow-unk: false
[2023-07-28 12:37:44] [config] authors: false
[2023-07-28 12:37:44] [config] beam-size: 12
[2023-07-28 12:37:44] [config] bert-class-symbol: "[CLS]"
[2023-07-28 12:37:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 12:37:44] [config] bert-masking-fraction: 0.15
[2023-07-28 12:37:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 12:37:44] [config] bert-train-type-embeddings: true
[2023-07-28 12:37:44] [config] bert-type-vocab-size: 2
[2023-07-28 12:37:44] [config] build-info: ""
[2023-07-28 12:37:44] [config] check-gradient-nan: false
[2023-07-28 12:37:44] [config] check-nan: false
[2023-07-28 12:37:44] [config] cite: false
[2023-07-28 12:37:44] [config] clip-norm: 1
[2023-07-28 12:37:44] [config] cost-scaling:
[2023-07-28 12:37:44] [config]   - 256.f
[2023-07-28 12:37:44] [config]   - 1000
[2023-07-28 12:37:44] [config]   - 2.f
[2023-07-28 12:37:44] [config]   - 256.f
[2023-07-28 12:37:44] [config] cost-type: ce-sum
[2023-07-28 12:37:44] [config] cpu-threads: 0
[2023-07-28 12:37:44] [config] data-threads: 8
[2023-07-28 12:37:44] [config] data-weighting: ""
[2023-07-28 12:37:44] [config] data-weighting-type: sentence
[2023-07-28 12:37:44] [config] dec-cell: gru
[2023-07-28 12:37:44] [config] dec-cell-base-depth: 2
[2023-07-28 12:37:44] [config] dec-cell-high-depth: 1
[2023-07-28 12:37:44] [config] dec-depth: 1
[2023-07-28 12:37:44] [config] devices:
[2023-07-28 12:37:44] [config]   - 0
[2023-07-28 12:37:44] [config] dim-emb: 512
[2023-07-28 12:37:44] [config] dim-rnn: 1024
[2023-07-28 12:37:44] [config] dim-vocabs:
[2023-07-28 12:37:44] [config]   - 16384
[2023-07-28 12:37:44] [config]   - 16384
[2023-07-28 12:37:44] [config] disp-first: 0
[2023-07-28 12:37:44] [config] disp-freq: 1000u
[2023-07-28 12:37:44] [config] disp-label-counts: true
[2023-07-28 12:37:44] [config] dropout-rnn: 0
[2023-07-28 12:37:44] [config] dropout-src: 0
[2023-07-28 12:37:44] [config] dropout-trg: 0
[2023-07-28 12:37:44] [config] dump-config: ""
[2023-07-28 12:37:44] [config] dynamic-gradient-scaling:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] early-stopping: 1000
[2023-07-28 12:37:44] [config] early-stopping-on: first
[2023-07-28 12:37:44] [config] embedding-fix-src: false
[2023-07-28 12:37:44] [config] embedding-fix-trg: false
[2023-07-28 12:37:44] [config] embedding-normalization: false
[2023-07-28 12:37:44] [config] embedding-vectors:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] enc-cell: gru
[2023-07-28 12:37:44] [config] enc-cell-depth: 1
[2023-07-28 12:37:44] [config] enc-depth: 1
[2023-07-28 12:37:44] [config] enc-type: bidirectional
[2023-07-28 12:37:44] [config] english-title-case-every: 0
[2023-07-28 12:37:44] [config] exponential-smoothing: 0
[2023-07-28 12:37:44] [config] factor-weight: 1
[2023-07-28 12:37:44] [config] factors-combine: sum
[2023-07-28 12:37:44] [config] factors-dim-emb: 0
[2023-07-28 12:37:44] [config] gradient-checkpointing: false
[2023-07-28 12:37:44] [config] gradient-norm-average-window: 100
[2023-07-28 12:37:44] [config] guided-alignment: none
[2023-07-28 12:37:44] [config] guided-alignment-cost: mse
[2023-07-28 12:37:44] [config] guided-alignment-weight: 0.1
[2023-07-28 12:37:44] [config] ignore-model-config: false
[2023-07-28 12:37:44] [config] input-types:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] interpolate-env-vars: false
[2023-07-28 12:37:44] [config] keep-best: false
[2023-07-28 12:37:44] [config] label-smoothing: 0
[2023-07-28 12:37:44] [config] layer-normalization: false
[2023-07-28 12:37:44] [config] learn-rate: 0.0001
[2023-07-28 12:37:44] [config] lemma-dependency: ""
[2023-07-28 12:37:44] [config] lemma-dim-emb: 0
[2023-07-28 12:37:44] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 12:37:44] [config] log-level: info
[2023-07-28 12:37:44] [config] log-time-zone: ""
[2023-07-28 12:37:44] [config] logical-epoch:
[2023-07-28 12:37:44] [config]   - 1e
[2023-07-28 12:37:44] [config]   - 0
[2023-07-28 12:37:44] [config] lr-decay: 0
[2023-07-28 12:37:44] [config] lr-decay-freq: 50000
[2023-07-28 12:37:44] [config] lr-decay-inv-sqrt:
[2023-07-28 12:37:44] [config]   - 0
[2023-07-28 12:37:44] [config] lr-decay-repeat-warmup: false
[2023-07-28 12:37:44] [config] lr-decay-reset-optimizer: false
[2023-07-28 12:37:44] [config] lr-decay-start:
[2023-07-28 12:37:44] [config]   - 10
[2023-07-28 12:37:44] [config]   - 1
[2023-07-28 12:37:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 12:37:44] [config] lr-report: false
[2023-07-28 12:37:44] [config] lr-warmup: 0
[2023-07-28 12:37:44] [config] lr-warmup-at-reload: false
[2023-07-28 12:37:44] [config] lr-warmup-cycle: false
[2023-07-28 12:37:44] [config] lr-warmup-start-rate: 0
[2023-07-28 12:37:44] [config] max-length: 250
[2023-07-28 12:37:44] [config] max-length-crop: true
[2023-07-28 12:37:44] [config] max-length-factor: 3
[2023-07-28 12:37:44] [config] maxi-batch: 100
[2023-07-28 12:37:44] [config] maxi-batch-sort: trg
[2023-07-28 12:37:44] [config] mini-batch: 64
[2023-07-28 12:37:44] [config] mini-batch-fit: true
[2023-07-28 12:37:44] [config] mini-batch-fit-step: 10
[2023-07-28 12:37:44] [config] mini-batch-round-up: true
[2023-07-28 12:37:44] [config] mini-batch-track-lr: false
[2023-07-28 12:37:44] [config] mini-batch-warmup: 0
[2023-07-28 12:37:44] [config] mini-batch-words: 0
[2023-07-28 12:37:44] [config] mini-batch-words-ref: 0
[2023-07-28 12:37:44] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 12:37:44] [config] multi-loss-type: sum
[2023-07-28 12:37:44] [config] n-best: false
[2023-07-28 12:37:44] [config] no-nccl: false
[2023-07-28 12:37:44] [config] no-reload: false
[2023-07-28 12:37:44] [config] no-restore-corpus: false
[2023-07-28 12:37:44] [config] normalize: 0
[2023-07-28 12:37:44] [config] normalize-gradient: false
[2023-07-28 12:37:44] [config] num-devices: 0
[2023-07-28 12:37:44] [config] optimizer: adam
[2023-07-28 12:37:44] [config] optimizer-delay: 1
[2023-07-28 12:37:44] [config] optimizer-params:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] output-omit-bias: false
[2023-07-28 12:37:44] [config] overwrite: true
[2023-07-28 12:37:44] [config] precision:
[2023-07-28 12:37:44] [config]   - float16
[2023-07-28 12:37:44] [config]   - float32
[2023-07-28 12:37:44] [config] pretrained-model: ""
[2023-07-28 12:37:44] [config] quantize-biases: false
[2023-07-28 12:37:44] [config] quantize-bits: 0
[2023-07-28 12:37:44] [config] quantize-log-based: false
[2023-07-28 12:37:44] [config] quantize-optimization-steps: 0
[2023-07-28 12:37:44] [config] quiet: false
[2023-07-28 12:37:44] [config] quiet-translation: true
[2023-07-28 12:37:44] [config] relative-paths: false
[2023-07-28 12:37:44] [config] right-left: false
[2023-07-28 12:37:44] [config] save-freq: 10000u
[2023-07-28 12:37:44] [config] seed: 1234
[2023-07-28 12:37:44] [config] sentencepiece-alphas:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] sentencepiece-max-lines: 2000000
[2023-07-28 12:37:44] [config] sentencepiece-options: ""
[2023-07-28 12:37:44] [config] sharding: global
[2023-07-28 12:37:44] [config] shuffle: data
[2023-07-28 12:37:44] [config] shuffle-in-ram: false
[2023-07-28 12:37:44] [config] sigterm: save-and-exit
[2023-07-28 12:37:44] [config] skip: false
[2023-07-28 12:37:44] [config] sqlite: ""
[2023-07-28 12:37:44] [config] sqlite-drop: false
[2023-07-28 12:37:44] [config] sync-freq: 200u
[2023-07-28 12:37:44] [config] sync-sgd: false
[2023-07-28 12:37:44] [config] tempdir: /tmp
[2023-07-28 12:37:44] [config] tied-embeddings: false
[2023-07-28 12:37:44] [config] tied-embeddings-all: true
[2023-07-28 12:37:44] [config] tied-embeddings-src: false
[2023-07-28 12:37:44] [config] train-embedder-rank:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] train-sets:
[2023-07-28 12:37:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 12:37:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 12:37:44] [config] transformer-aan-activation: swish
[2023-07-28 12:37:44] [config] transformer-aan-depth: 2
[2023-07-28 12:37:44] [config] transformer-aan-nogate: false
[2023-07-28 12:37:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 12:37:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 12:37:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 12:37:44] [config] transformer-depth-scaling: false
[2023-07-28 12:37:44] [config] transformer-dim-aan: 2048
[2023-07-28 12:37:44] [config] transformer-dim-ffn: 2048
[2023-07-28 12:37:44] [config] transformer-dropout: 0
[2023-07-28 12:37:44] [config] transformer-dropout-attention: 0
[2023-07-28 12:37:44] [config] transformer-dropout-ffn: 0
[2023-07-28 12:37:44] [config] transformer-ffn-activation: swish
[2023-07-28 12:37:44] [config] transformer-ffn-depth: 2
[2023-07-28 12:37:44] [config] transformer-guided-alignment-layer: last
[2023-07-28 12:37:44] [config] transformer-heads: 8
[2023-07-28 12:37:44] [config] transformer-no-projection: false
[2023-07-28 12:37:44] [config] transformer-pool: false
[2023-07-28 12:37:44] [config] transformer-postprocess: dan
[2023-07-28 12:37:44] [config] transformer-postprocess-emb: d
[2023-07-28 12:37:44] [config] transformer-postprocess-top: ""
[2023-07-28 12:37:44] [config] transformer-preprocess: ""
[2023-07-28 12:37:44] [config] transformer-tied-layers:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] transformer-train-position-embeddings: false
[2023-07-28 12:37:44] [config] tsv: false
[2023-07-28 12:37:44] [config] tsv-fields: 0
[2023-07-28 12:37:44] [config] type: s2s
[2023-07-28 12:37:44] [config] ulr: false
[2023-07-28 12:37:44] [config] ulr-dim-emb: 0
[2023-07-28 12:37:44] [config] ulr-dropout: 0
[2023-07-28 12:37:44] [config] ulr-keys-vectors: ""
[2023-07-28 12:37:44] [config] ulr-query-vectors: ""
[2023-07-28 12:37:44] [config] ulr-softmax-temperature: 1
[2023-07-28 12:37:44] [config] ulr-trainable-transformation: false
[2023-07-28 12:37:44] [config] unlikelihood-loss: false
[2023-07-28 12:37:44] [config] valid-freq: 50000000
[2023-07-28 12:37:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 12:37:44] [config] valid-max-length: 1000
[2023-07-28 12:37:44] [config] valid-metrics:
[2023-07-28 12:37:44] [config]   - translation
[2023-07-28 12:37:44] [config] valid-mini-batch: 32
[2023-07-28 12:37:44] [config] valid-reset-stalled: false
[2023-07-28 12:37:44] [config] valid-script-args:
[2023-07-28 12:37:44] [config]   []
[2023-07-28 12:37:44] [config] valid-script-path: ""
[2023-07-28 12:37:44] [config] valid-sets:
[2023-07-28 12:37:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 12:37:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 12:37:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 12:37:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:37:44] [config] vocabs:
[2023-07-28 12:37:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 12:37:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 12:37:44] [config] word-penalty: 0
[2023-07-28 12:37:44] [config] word-scores: false
[2023-07-28 12:37:44] [config] workspace: 5500
[2023-07-28 12:37:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 12:37:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:37:44] [training] Using single-device training
[2023-07-28 12:37:44] Synced seed 1234
[2023-07-28 12:37:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 12:37:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 12:37:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 12:37:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 12:37:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 12:37:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 12:37:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 12:37:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 12:37:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 12:37:46] [comm] Using global sharding
[2023-07-28 12:37:46] [comm] NCCLCommunicators constructed successfully
[2023-07-28 12:37:46] [training] Using 1 GPUs
[2023-07-28 12:37:46] [logits] Applying loss function for 1 factor(s)
[2023-07-28 12:37:46] [memory] Reserving 80 MB, device gpu0
[2023-07-28 12:37:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 12:37:46] [memory] Reserving 80 MB, device gpu0
[2023-07-28 13:24:55] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 13:24:55] [valid] No post-processing script given for validating translator
[2023-07-28 13:24:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 13:24:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 13:24:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 13:24:55] [comm] Using global sharding
[2023-07-28 13:24:55] [comm] NCCLCommunicators constructed successfully
[2023-07-28 13:24:55] [training] Using 1 GPUs
[2023-07-28 13:24:55] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 13:25:02] Allocating memory for general optimizer shards
[2023-07-28 13:25:02] [memory] Reserving 322 MB, device gpu0
[2023-07-28 13:25:02] Loading Adam parameters
[2023-07-28 13:25:03] [memory] Reserving 322 MB, device gpu0
[2023-07-28 13:25:03] [memory] Reserving 80 MB, device gpu0
[2023-07-28 13:25:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 13:25:03] [data] Restoring the corpus state to epoch 231, batch 8917
[2023-07-28 13:25:03] [data] Shuffling data
[2023-07-28 13:25:03] [data] Done reading 20,192 sentences
[2023-07-28 13:25:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 13:25:03] Training started
[2023-07-28 13:25:03] Training finished
[2023-07-28 13:25:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 13:25:07] [marian] Running on node18.datos.cluster.uy as process 37729 with command line:
[2023-07-28 13:25:07] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 240 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 13:25:07] [config] after: 0e
[2023-07-28 13:25:07] [config] after-batches: 0
[2023-07-28 13:25:07] [config] after-epochs: 240
[2023-07-28 13:25:07] [config] all-caps-every: 0
[2023-07-28 13:25:07] [config] allow-unk: false
[2023-07-28 13:25:07] [config] authors: false
[2023-07-28 13:25:07] [config] beam-size: 12
[2023-07-28 13:25:07] [config] bert-class-symbol: "[CLS]"
[2023-07-28 13:25:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 13:25:07] [config] bert-masking-fraction: 0.15
[2023-07-28 13:25:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 13:25:07] [config] bert-train-type-embeddings: true
[2023-07-28 13:25:07] [config] bert-type-vocab-size: 2
[2023-07-28 13:25:07] [config] build-info: ""
[2023-07-28 13:25:07] [config] check-gradient-nan: false
[2023-07-28 13:25:07] [config] check-nan: false
[2023-07-28 13:25:07] [config] cite: false
[2023-07-28 13:25:07] [config] clip-norm: 1
[2023-07-28 13:25:07] [config] cost-scaling:
[2023-07-28 13:25:07] [config]   - 256.f
[2023-07-28 13:25:07] [config]   - 1000
[2023-07-28 13:25:07] [config]   - 2.f
[2023-07-28 13:25:07] [config]   - 256.f
[2023-07-28 13:25:07] [config] cost-type: ce-sum
[2023-07-28 13:25:07] [config] cpu-threads: 0
[2023-07-28 13:25:07] [config] data-threads: 8
[2023-07-28 13:25:07] [config] data-weighting: ""
[2023-07-28 13:25:07] [config] data-weighting-type: sentence
[2023-07-28 13:25:07] [config] dec-cell: gru
[2023-07-28 13:25:07] [config] dec-cell-base-depth: 2
[2023-07-28 13:25:07] [config] dec-cell-high-depth: 1
[2023-07-28 13:25:07] [config] dec-depth: 1
[2023-07-28 13:25:07] [config] devices:
[2023-07-28 13:25:07] [config]   - 0
[2023-07-28 13:25:07] [config] dim-emb: 512
[2023-07-28 13:25:07] [config] dim-rnn: 1024
[2023-07-28 13:25:07] [config] dim-vocabs:
[2023-07-28 13:25:07] [config]   - 16384
[2023-07-28 13:25:07] [config]   - 16384
[2023-07-28 13:25:07] [config] disp-first: 0
[2023-07-28 13:25:07] [config] disp-freq: 1000u
[2023-07-28 13:25:07] [config] disp-label-counts: true
[2023-07-28 13:25:07] [config] dropout-rnn: 0
[2023-07-28 13:25:07] [config] dropout-src: 0
[2023-07-28 13:25:07] [config] dropout-trg: 0
[2023-07-28 13:25:07] [config] dump-config: ""
[2023-07-28 13:25:07] [config] dynamic-gradient-scaling:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] early-stopping: 1000
[2023-07-28 13:25:07] [config] early-stopping-on: first
[2023-07-28 13:25:07] [config] embedding-fix-src: false
[2023-07-28 13:25:07] [config] embedding-fix-trg: false
[2023-07-28 13:25:07] [config] embedding-normalization: false
[2023-07-28 13:25:07] [config] embedding-vectors:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] enc-cell: gru
[2023-07-28 13:25:07] [config] enc-cell-depth: 1
[2023-07-28 13:25:07] [config] enc-depth: 1
[2023-07-28 13:25:07] [config] enc-type: bidirectional
[2023-07-28 13:25:07] [config] english-title-case-every: 0
[2023-07-28 13:25:07] [config] exponential-smoothing: 0
[2023-07-28 13:25:07] [config] factor-weight: 1
[2023-07-28 13:25:07] [config] factors-combine: sum
[2023-07-28 13:25:07] [config] factors-dim-emb: 0
[2023-07-28 13:25:07] [config] gradient-checkpointing: false
[2023-07-28 13:25:07] [config] gradient-norm-average-window: 100
[2023-07-28 13:25:07] [config] guided-alignment: none
[2023-07-28 13:25:07] [config] guided-alignment-cost: mse
[2023-07-28 13:25:07] [config] guided-alignment-weight: 0.1
[2023-07-28 13:25:07] [config] ignore-model-config: false
[2023-07-28 13:25:07] [config] input-types:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] interpolate-env-vars: false
[2023-07-28 13:25:07] [config] keep-best: false
[2023-07-28 13:25:07] [config] label-smoothing: 0
[2023-07-28 13:25:07] [config] layer-normalization: false
[2023-07-28 13:25:07] [config] learn-rate: 0.0001
[2023-07-28 13:25:07] [config] lemma-dependency: ""
[2023-07-28 13:25:07] [config] lemma-dim-emb: 0
[2023-07-28 13:25:07] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 13:25:07] [config] log-level: info
[2023-07-28 13:25:07] [config] log-time-zone: ""
[2023-07-28 13:25:07] [config] logical-epoch:
[2023-07-28 13:25:07] [config]   - 1e
[2023-07-28 13:25:07] [config]   - 0
[2023-07-28 13:25:07] [config] lr-decay: 0
[2023-07-28 13:25:07] [config] lr-decay-freq: 50000
[2023-07-28 13:25:07] [config] lr-decay-inv-sqrt:
[2023-07-28 13:25:07] [config]   - 0
[2023-07-28 13:25:07] [config] lr-decay-repeat-warmup: false
[2023-07-28 13:25:07] [config] lr-decay-reset-optimizer: false
[2023-07-28 13:25:07] [config] lr-decay-start:
[2023-07-28 13:25:07] [config]   - 10
[2023-07-28 13:25:07] [config]   - 1
[2023-07-28 13:25:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 13:25:07] [config] lr-report: false
[2023-07-28 13:25:07] [config] lr-warmup: 0
[2023-07-28 13:25:07] [config] lr-warmup-at-reload: false
[2023-07-28 13:25:07] [config] lr-warmup-cycle: false
[2023-07-28 13:25:07] [config] lr-warmup-start-rate: 0
[2023-07-28 13:25:07] [config] max-length: 250
[2023-07-28 13:25:07] [config] max-length-crop: true
[2023-07-28 13:25:07] [config] max-length-factor: 3
[2023-07-28 13:25:07] [config] maxi-batch: 100
[2023-07-28 13:25:07] [config] maxi-batch-sort: trg
[2023-07-28 13:25:07] [config] mini-batch: 64
[2023-07-28 13:25:07] [config] mini-batch-fit: true
[2023-07-28 13:25:07] [config] mini-batch-fit-step: 10
[2023-07-28 13:25:07] [config] mini-batch-round-up: true
[2023-07-28 13:25:07] [config] mini-batch-track-lr: false
[2023-07-28 13:25:07] [config] mini-batch-warmup: 0
[2023-07-28 13:25:07] [config] mini-batch-words: 0
[2023-07-28 13:25:07] [config] mini-batch-words-ref: 0
[2023-07-28 13:25:07] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 13:25:07] [config] multi-loss-type: sum
[2023-07-28 13:25:07] [config] n-best: false
[2023-07-28 13:25:07] [config] no-nccl: false
[2023-07-28 13:25:07] [config] no-reload: false
[2023-07-28 13:25:07] [config] no-restore-corpus: false
[2023-07-28 13:25:07] [config] normalize: 0
[2023-07-28 13:25:07] [config] normalize-gradient: false
[2023-07-28 13:25:07] [config] num-devices: 0
[2023-07-28 13:25:07] [config] optimizer: adam
[2023-07-28 13:25:07] [config] optimizer-delay: 1
[2023-07-28 13:25:07] [config] optimizer-params:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] output-omit-bias: false
[2023-07-28 13:25:07] [config] overwrite: true
[2023-07-28 13:25:07] [config] precision:
[2023-07-28 13:25:07] [config]   - float16
[2023-07-28 13:25:07] [config]   - float32
[2023-07-28 13:25:07] [config] pretrained-model: ""
[2023-07-28 13:25:07] [config] quantize-biases: false
[2023-07-28 13:25:07] [config] quantize-bits: 0
[2023-07-28 13:25:07] [config] quantize-log-based: false
[2023-07-28 13:25:07] [config] quantize-optimization-steps: 0
[2023-07-28 13:25:07] [config] quiet: false
[2023-07-28 13:25:07] [config] quiet-translation: true
[2023-07-28 13:25:07] [config] relative-paths: false
[2023-07-28 13:25:07] [config] right-left: false
[2023-07-28 13:25:07] [config] save-freq: 10000u
[2023-07-28 13:25:07] [config] seed: 1234
[2023-07-28 13:25:07] [config] sentencepiece-alphas:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] sentencepiece-max-lines: 2000000
[2023-07-28 13:25:07] [config] sentencepiece-options: ""
[2023-07-28 13:25:07] [config] sharding: global
[2023-07-28 13:25:07] [config] shuffle: data
[2023-07-28 13:25:07] [config] shuffle-in-ram: false
[2023-07-28 13:25:07] [config] sigterm: save-and-exit
[2023-07-28 13:25:07] [config] skip: false
[2023-07-28 13:25:07] [config] sqlite: ""
[2023-07-28 13:25:07] [config] sqlite-drop: false
[2023-07-28 13:25:07] [config] sync-freq: 200u
[2023-07-28 13:25:07] [config] sync-sgd: false
[2023-07-28 13:25:07] [config] tempdir: /tmp
[2023-07-28 13:25:07] [config] tied-embeddings: false
[2023-07-28 13:25:07] [config] tied-embeddings-all: true
[2023-07-28 13:25:07] [config] tied-embeddings-src: false
[2023-07-28 13:25:07] [config] train-embedder-rank:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] train-sets:
[2023-07-28 13:25:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 13:25:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 13:25:07] [config] transformer-aan-activation: swish
[2023-07-28 13:25:07] [config] transformer-aan-depth: 2
[2023-07-28 13:25:07] [config] transformer-aan-nogate: false
[2023-07-28 13:25:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 13:25:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 13:25:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 13:25:07] [config] transformer-depth-scaling: false
[2023-07-28 13:25:07] [config] transformer-dim-aan: 2048
[2023-07-28 13:25:07] [config] transformer-dim-ffn: 2048
[2023-07-28 13:25:07] [config] transformer-dropout: 0
[2023-07-28 13:25:07] [config] transformer-dropout-attention: 0
[2023-07-28 13:25:07] [config] transformer-dropout-ffn: 0
[2023-07-28 13:25:07] [config] transformer-ffn-activation: swish
[2023-07-28 13:25:07] [config] transformer-ffn-depth: 2
[2023-07-28 13:25:07] [config] transformer-guided-alignment-layer: last
[2023-07-28 13:25:07] [config] transformer-heads: 8
[2023-07-28 13:25:07] [config] transformer-no-projection: false
[2023-07-28 13:25:07] [config] transformer-pool: false
[2023-07-28 13:25:07] [config] transformer-postprocess: dan
[2023-07-28 13:25:07] [config] transformer-postprocess-emb: d
[2023-07-28 13:25:07] [config] transformer-postprocess-top: ""
[2023-07-28 13:25:07] [config] transformer-preprocess: ""
[2023-07-28 13:25:07] [config] transformer-tied-layers:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] transformer-train-position-embeddings: false
[2023-07-28 13:25:07] [config] tsv: false
[2023-07-28 13:25:07] [config] tsv-fields: 0
[2023-07-28 13:25:07] [config] type: s2s
[2023-07-28 13:25:07] [config] ulr: false
[2023-07-28 13:25:07] [config] ulr-dim-emb: 0
[2023-07-28 13:25:07] [config] ulr-dropout: 0
[2023-07-28 13:25:07] [config] ulr-keys-vectors: ""
[2023-07-28 13:25:07] [config] ulr-query-vectors: ""
[2023-07-28 13:25:07] [config] ulr-softmax-temperature: 1
[2023-07-28 13:25:07] [config] ulr-trainable-transformation: false
[2023-07-28 13:25:07] [config] unlikelihood-loss: false
[2023-07-28 13:25:07] [config] valid-freq: 50000000
[2023-07-28 13:25:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 13:25:07] [config] valid-max-length: 1000
[2023-07-28 13:25:07] [config] valid-metrics:
[2023-07-28 13:25:07] [config]   - translation
[2023-07-28 13:25:07] [config] valid-mini-batch: 32
[2023-07-28 13:25:07] [config] valid-reset-stalled: false
[2023-07-28 13:25:07] [config] valid-script-args:
[2023-07-28 13:25:07] [config]   []
[2023-07-28 13:25:07] [config] valid-script-path: ""
[2023-07-28 13:25:07] [config] valid-sets:
[2023-07-28 13:25:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 13:25:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 13:25:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 13:25:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 13:25:07] [config] vocabs:
[2023-07-28 13:25:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 13:25:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 13:25:07] [config] word-penalty: 0
[2023-07-28 13:25:07] [config] word-scores: false
[2023-07-28 13:25:07] [config] workspace: 5500
[2023-07-28 13:25:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 13:25:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 13:25:07] [training] Using single-device training
[2023-07-28 13:25:07] Synced seed 1234
[2023-07-28 13:25:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 13:25:07] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 13:25:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 13:25:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 13:25:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 13:25:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 13:25:07] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 13:25:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 13:25:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 13:25:08] [comm] Using global sharding
[2023-07-28 13:25:08] [comm] NCCLCommunicators constructed successfully
[2023-07-28 13:25:08] [training] Using 1 GPUs
[2023-07-28 13:25:08] [logits] Applying loss function for 1 factor(s)
[2023-07-28 13:25:08] [memory] Reserving 80 MB, device gpu0
[2023-07-28 13:25:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 13:25:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 14:10:33] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 14:10:33] [valid] No post-processing script given for validating translator
[2023-07-28 14:10:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 14:10:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 14:10:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 14:10:33] [comm] Using global sharding
[2023-07-28 14:10:33] [comm] NCCLCommunicators constructed successfully
[2023-07-28 14:10:33] [training] Using 1 GPUs
[2023-07-28 14:10:33] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 14:10:34] Allocating memory for general optimizer shards
[2023-07-28 14:10:34] [memory] Reserving 322 MB, device gpu0
[2023-07-28 14:10:34] Loading Adam parameters
[2023-07-28 14:10:34] [memory] Reserving 322 MB, device gpu0
[2023-07-28 14:10:35] [memory] Reserving 80 MB, device gpu0
[2023-07-28 14:10:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 14:10:35] [data] Restoring the corpus state to epoch 241, batch 9306
[2023-07-28 14:10:35] [data] Shuffling data
[2023-07-28 14:10:35] [data] Done reading 20,192 sentences
[2023-07-28 14:10:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 14:10:35] Training started
[2023-07-28 14:10:35] Training finished
[2023-07-28 14:10:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 14:10:39] [marian] Running on node18.datos.cluster.uy as process 40505 with command line:
[2023-07-28 14:10:39] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 250 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 14:10:39] [config] after: 0e
[2023-07-28 14:10:39] [config] after-batches: 0
[2023-07-28 14:10:39] [config] after-epochs: 250
[2023-07-28 14:10:39] [config] all-caps-every: 0
[2023-07-28 14:10:39] [config] allow-unk: false
[2023-07-28 14:10:39] [config] authors: false
[2023-07-28 14:10:39] [config] beam-size: 12
[2023-07-28 14:10:39] [config] bert-class-symbol: "[CLS]"
[2023-07-28 14:10:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 14:10:39] [config] bert-masking-fraction: 0.15
[2023-07-28 14:10:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 14:10:39] [config] bert-train-type-embeddings: true
[2023-07-28 14:10:39] [config] bert-type-vocab-size: 2
[2023-07-28 14:10:39] [config] build-info: ""
[2023-07-28 14:10:39] [config] check-gradient-nan: false
[2023-07-28 14:10:39] [config] check-nan: false
[2023-07-28 14:10:39] [config] cite: false
[2023-07-28 14:10:39] [config] clip-norm: 1
[2023-07-28 14:10:39] [config] cost-scaling:
[2023-07-28 14:10:39] [config]   - 256.f
[2023-07-28 14:10:39] [config]   - 1000
[2023-07-28 14:10:39] [config]   - 2.f
[2023-07-28 14:10:39] [config]   - 256.f
[2023-07-28 14:10:39] [config] cost-type: ce-sum
[2023-07-28 14:10:39] [config] cpu-threads: 0
[2023-07-28 14:10:39] [config] data-threads: 8
[2023-07-28 14:10:39] [config] data-weighting: ""
[2023-07-28 14:10:39] [config] data-weighting-type: sentence
[2023-07-28 14:10:39] [config] dec-cell: gru
[2023-07-28 14:10:39] [config] dec-cell-base-depth: 2
[2023-07-28 14:10:39] [config] dec-cell-high-depth: 1
[2023-07-28 14:10:39] [config] dec-depth: 1
[2023-07-28 14:10:39] [config] devices:
[2023-07-28 14:10:39] [config]   - 0
[2023-07-28 14:10:39] [config] dim-emb: 512
[2023-07-28 14:10:39] [config] dim-rnn: 1024
[2023-07-28 14:10:39] [config] dim-vocabs:
[2023-07-28 14:10:39] [config]   - 16384
[2023-07-28 14:10:39] [config]   - 16384
[2023-07-28 14:10:39] [config] disp-first: 0
[2023-07-28 14:10:39] [config] disp-freq: 1000u
[2023-07-28 14:10:39] [config] disp-label-counts: true
[2023-07-28 14:10:39] [config] dropout-rnn: 0
[2023-07-28 14:10:39] [config] dropout-src: 0
[2023-07-28 14:10:39] [config] dropout-trg: 0
[2023-07-28 14:10:39] [config] dump-config: ""
[2023-07-28 14:10:39] [config] dynamic-gradient-scaling:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] early-stopping: 1000
[2023-07-28 14:10:39] [config] early-stopping-on: first
[2023-07-28 14:10:39] [config] embedding-fix-src: false
[2023-07-28 14:10:39] [config] embedding-fix-trg: false
[2023-07-28 14:10:39] [config] embedding-normalization: false
[2023-07-28 14:10:39] [config] embedding-vectors:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] enc-cell: gru
[2023-07-28 14:10:39] [config] enc-cell-depth: 1
[2023-07-28 14:10:39] [config] enc-depth: 1
[2023-07-28 14:10:39] [config] enc-type: bidirectional
[2023-07-28 14:10:39] [config] english-title-case-every: 0
[2023-07-28 14:10:39] [config] exponential-smoothing: 0
[2023-07-28 14:10:39] [config] factor-weight: 1
[2023-07-28 14:10:39] [config] factors-combine: sum
[2023-07-28 14:10:39] [config] factors-dim-emb: 0
[2023-07-28 14:10:39] [config] gradient-checkpointing: false
[2023-07-28 14:10:39] [config] gradient-norm-average-window: 100
[2023-07-28 14:10:39] [config] guided-alignment: none
[2023-07-28 14:10:39] [config] guided-alignment-cost: mse
[2023-07-28 14:10:39] [config] guided-alignment-weight: 0.1
[2023-07-28 14:10:39] [config] ignore-model-config: false
[2023-07-28 14:10:39] [config] input-types:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] interpolate-env-vars: false
[2023-07-28 14:10:39] [config] keep-best: false
[2023-07-28 14:10:39] [config] label-smoothing: 0
[2023-07-28 14:10:39] [config] layer-normalization: false
[2023-07-28 14:10:39] [config] learn-rate: 0.0001
[2023-07-28 14:10:39] [config] lemma-dependency: ""
[2023-07-28 14:10:39] [config] lemma-dim-emb: 0
[2023-07-28 14:10:39] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 14:10:39] [config] log-level: info
[2023-07-28 14:10:39] [config] log-time-zone: ""
[2023-07-28 14:10:39] [config] logical-epoch:
[2023-07-28 14:10:39] [config]   - 1e
[2023-07-28 14:10:39] [config]   - 0
[2023-07-28 14:10:39] [config] lr-decay: 0
[2023-07-28 14:10:39] [config] lr-decay-freq: 50000
[2023-07-28 14:10:39] [config] lr-decay-inv-sqrt:
[2023-07-28 14:10:39] [config]   - 0
[2023-07-28 14:10:39] [config] lr-decay-repeat-warmup: false
[2023-07-28 14:10:39] [config] lr-decay-reset-optimizer: false
[2023-07-28 14:10:39] [config] lr-decay-start:
[2023-07-28 14:10:39] [config]   - 10
[2023-07-28 14:10:39] [config]   - 1
[2023-07-28 14:10:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 14:10:39] [config] lr-report: false
[2023-07-28 14:10:39] [config] lr-warmup: 0
[2023-07-28 14:10:39] [config] lr-warmup-at-reload: false
[2023-07-28 14:10:39] [config] lr-warmup-cycle: false
[2023-07-28 14:10:39] [config] lr-warmup-start-rate: 0
[2023-07-28 14:10:39] [config] max-length: 250
[2023-07-28 14:10:39] [config] max-length-crop: true
[2023-07-28 14:10:39] [config] max-length-factor: 3
[2023-07-28 14:10:39] [config] maxi-batch: 100
[2023-07-28 14:10:39] [config] maxi-batch-sort: trg
[2023-07-28 14:10:39] [config] mini-batch: 64
[2023-07-28 14:10:39] [config] mini-batch-fit: true
[2023-07-28 14:10:39] [config] mini-batch-fit-step: 10
[2023-07-28 14:10:39] [config] mini-batch-round-up: true
[2023-07-28 14:10:39] [config] mini-batch-track-lr: false
[2023-07-28 14:10:39] [config] mini-batch-warmup: 0
[2023-07-28 14:10:39] [config] mini-batch-words: 0
[2023-07-28 14:10:39] [config] mini-batch-words-ref: 0
[2023-07-28 14:10:39] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 14:10:39] [config] multi-loss-type: sum
[2023-07-28 14:10:39] [config] n-best: false
[2023-07-28 14:10:39] [config] no-nccl: false
[2023-07-28 14:10:39] [config] no-reload: false
[2023-07-28 14:10:39] [config] no-restore-corpus: false
[2023-07-28 14:10:39] [config] normalize: 0
[2023-07-28 14:10:39] [config] normalize-gradient: false
[2023-07-28 14:10:39] [config] num-devices: 0
[2023-07-28 14:10:39] [config] optimizer: adam
[2023-07-28 14:10:39] [config] optimizer-delay: 1
[2023-07-28 14:10:39] [config] optimizer-params:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] output-omit-bias: false
[2023-07-28 14:10:39] [config] overwrite: true
[2023-07-28 14:10:39] [config] precision:
[2023-07-28 14:10:39] [config]   - float16
[2023-07-28 14:10:39] [config]   - float32
[2023-07-28 14:10:39] [config] pretrained-model: ""
[2023-07-28 14:10:39] [config] quantize-biases: false
[2023-07-28 14:10:39] [config] quantize-bits: 0
[2023-07-28 14:10:39] [config] quantize-log-based: false
[2023-07-28 14:10:39] [config] quantize-optimization-steps: 0
[2023-07-28 14:10:39] [config] quiet: false
[2023-07-28 14:10:39] [config] quiet-translation: true
[2023-07-28 14:10:39] [config] relative-paths: false
[2023-07-28 14:10:39] [config] right-left: false
[2023-07-28 14:10:39] [config] save-freq: 10000u
[2023-07-28 14:10:39] [config] seed: 1234
[2023-07-28 14:10:39] [config] sentencepiece-alphas:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] sentencepiece-max-lines: 2000000
[2023-07-28 14:10:39] [config] sentencepiece-options: ""
[2023-07-28 14:10:39] [config] sharding: global
[2023-07-28 14:10:39] [config] shuffle: data
[2023-07-28 14:10:39] [config] shuffle-in-ram: false
[2023-07-28 14:10:39] [config] sigterm: save-and-exit
[2023-07-28 14:10:39] [config] skip: false
[2023-07-28 14:10:39] [config] sqlite: ""
[2023-07-28 14:10:39] [config] sqlite-drop: false
[2023-07-28 14:10:39] [config] sync-freq: 200u
[2023-07-28 14:10:39] [config] sync-sgd: false
[2023-07-28 14:10:39] [config] tempdir: /tmp
[2023-07-28 14:10:39] [config] tied-embeddings: false
[2023-07-28 14:10:39] [config] tied-embeddings-all: true
[2023-07-28 14:10:39] [config] tied-embeddings-src: false
[2023-07-28 14:10:39] [config] train-embedder-rank:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] train-sets:
[2023-07-28 14:10:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 14:10:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 14:10:39] [config] transformer-aan-activation: swish
[2023-07-28 14:10:39] [config] transformer-aan-depth: 2
[2023-07-28 14:10:39] [config] transformer-aan-nogate: false
[2023-07-28 14:10:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 14:10:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 14:10:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 14:10:39] [config] transformer-depth-scaling: false
[2023-07-28 14:10:39] [config] transformer-dim-aan: 2048
[2023-07-28 14:10:39] [config] transformer-dim-ffn: 2048
[2023-07-28 14:10:39] [config] transformer-dropout: 0
[2023-07-28 14:10:39] [config] transformer-dropout-attention: 0
[2023-07-28 14:10:39] [config] transformer-dropout-ffn: 0
[2023-07-28 14:10:39] [config] transformer-ffn-activation: swish
[2023-07-28 14:10:39] [config] transformer-ffn-depth: 2
[2023-07-28 14:10:39] [config] transformer-guided-alignment-layer: last
[2023-07-28 14:10:39] [config] transformer-heads: 8
[2023-07-28 14:10:39] [config] transformer-no-projection: false
[2023-07-28 14:10:39] [config] transformer-pool: false
[2023-07-28 14:10:39] [config] transformer-postprocess: dan
[2023-07-28 14:10:39] [config] transformer-postprocess-emb: d
[2023-07-28 14:10:39] [config] transformer-postprocess-top: ""
[2023-07-28 14:10:39] [config] transformer-preprocess: ""
[2023-07-28 14:10:39] [config] transformer-tied-layers:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] transformer-train-position-embeddings: false
[2023-07-28 14:10:39] [config] tsv: false
[2023-07-28 14:10:39] [config] tsv-fields: 0
[2023-07-28 14:10:39] [config] type: s2s
[2023-07-28 14:10:39] [config] ulr: false
[2023-07-28 14:10:39] [config] ulr-dim-emb: 0
[2023-07-28 14:10:39] [config] ulr-dropout: 0
[2023-07-28 14:10:39] [config] ulr-keys-vectors: ""
[2023-07-28 14:10:39] [config] ulr-query-vectors: ""
[2023-07-28 14:10:39] [config] ulr-softmax-temperature: 1
[2023-07-28 14:10:39] [config] ulr-trainable-transformation: false
[2023-07-28 14:10:39] [config] unlikelihood-loss: false
[2023-07-28 14:10:39] [config] valid-freq: 50000000
[2023-07-28 14:10:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 14:10:39] [config] valid-max-length: 1000
[2023-07-28 14:10:39] [config] valid-metrics:
[2023-07-28 14:10:39] [config]   - translation
[2023-07-28 14:10:39] [config] valid-mini-batch: 32
[2023-07-28 14:10:39] [config] valid-reset-stalled: false
[2023-07-28 14:10:39] [config] valid-script-args:
[2023-07-28 14:10:39] [config]   []
[2023-07-28 14:10:39] [config] valid-script-path: ""
[2023-07-28 14:10:39] [config] valid-sets:
[2023-07-28 14:10:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 14:10:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 14:10:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 14:10:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 14:10:39] [config] vocabs:
[2023-07-28 14:10:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 14:10:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 14:10:39] [config] word-penalty: 0
[2023-07-28 14:10:39] [config] word-scores: false
[2023-07-28 14:10:39] [config] workspace: 5500
[2023-07-28 14:10:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 14:10:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 14:10:39] [training] Using single-device training
[2023-07-28 14:10:40] Synced seed 1234
[2023-07-28 14:10:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 14:10:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 14:10:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 14:10:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 14:10:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 14:10:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 14:10:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 14:10:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 14:10:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 14:10:41] [comm] Using global sharding
[2023-07-28 14:10:41] [comm] NCCLCommunicators constructed successfully
[2023-07-28 14:10:41] [training] Using 1 GPUs
[2023-07-28 14:10:41] [logits] Applying loss function for 1 factor(s)
[2023-07-28 14:10:41] [memory] Reserving 80 MB, device gpu0
[2023-07-28 14:10:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 14:10:42] [memory] Reserving 80 MB, device gpu0
[2023-07-28 14:58:12] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 14:58:12] [valid] No post-processing script given for validating translator
[2023-07-28 14:58:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 14:58:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 14:58:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 14:58:12] [comm] Using global sharding
[2023-07-28 14:58:13] [comm] NCCLCommunicators constructed successfully
[2023-07-28 14:58:13] [training] Using 1 GPUs
[2023-07-28 14:58:13] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 14:58:17] Allocating memory for general optimizer shards
[2023-07-28 14:58:17] [memory] Reserving 322 MB, device gpu0
[2023-07-28 14:58:17] Loading Adam parameters
[2023-07-28 14:58:17] [memory] Reserving 322 MB, device gpu0
[2023-07-28 14:58:17] [memory] Reserving 80 MB, device gpu0
[2023-07-28 14:58:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 14:58:17] [data] Restoring the corpus state to epoch 241, batch 9306
[2023-07-28 14:58:17] [data] Shuffling data
[2023-07-28 14:58:17] [data] Done reading 20,192 sentences
[2023-07-28 14:58:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 14:58:17] Training started
[2023-07-28 14:58:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 14:58:18] [memory] Reserving 80 MB, device gpu0
[2023-07-28 14:58:25] Parameter type float16, optimization type float32, casting types true
[2023-07-28 15:02:22] Seen 20,192 samples
[2023-07-28 15:02:22] Starting data epoch 242 in logical epoch 242
[2023-07-28 15:02:22] [data] Shuffling data
[2023-07-28 15:02:22] [data] Done reading 20,192 sentences
[2023-07-28 15:02:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:06:14] Seen 20,192 samples
[2023-07-28 15:06:14] Starting data epoch 243 in logical epoch 243
[2023-07-28 15:06:14] [data] Shuffling data
[2023-07-28 15:06:14] [data] Done reading 20,192 sentences
[2023-07-28 15:06:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:10:01] Seen 20,192 samples
[2023-07-28 15:10:01] Starting data epoch 244 in logical epoch 244
[2023-07-28 15:10:01] [data] Shuffling data
[2023-07-28 15:10:01] [data] Done reading 20,192 sentences
[2023-07-28 15:10:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:13:54] Seen 20,192 samples
[2023-07-28 15:13:54] Starting data epoch 245 in logical epoch 245
[2023-07-28 15:13:54] [data] Shuffling data
[2023-07-28 15:13:54] [data] Done reading 20,192 sentences
[2023-07-28 15:13:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:17:42] Seen 20,192 samples
[2023-07-28 15:17:42] Starting data epoch 246 in logical epoch 246
[2023-07-28 15:17:42] [data] Shuffling data
[2023-07-28 15:17:42] [data] Done reading 20,192 sentences
[2023-07-28 15:17:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:21:23] Seen 20,192 samples
[2023-07-28 15:21:23] Starting data epoch 247 in logical epoch 247
[2023-07-28 15:21:23] [data] Shuffling data
[2023-07-28 15:21:23] [data] Done reading 20,192 sentences
[2023-07-28 15:21:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:25:37] Seen 20,192 samples
[2023-07-28 15:25:37] Starting data epoch 248 in logical epoch 248
[2023-07-28 15:25:37] [data] Shuffling data
[2023-07-28 15:25:37] [data] Done reading 20,192 sentences
[2023-07-28 15:25:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:29:48] Seen 20,192 samples
[2023-07-28 15:29:48] Starting data epoch 249 in logical epoch 249
[2023-07-28 15:29:48] [data] Shuffling data
[2023-07-28 15:29:48] [data] Done reading 20,192 sentences
[2023-07-28 15:29:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:34:09] Seen 20,192 samples
[2023-07-28 15:34:09] Starting data epoch 250 in logical epoch 250
[2023-07-28 15:34:09] [data] Shuffling data
[2023-07-28 15:34:09] [data] Done reading 20,192 sentences
[2023-07-28 15:34:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 15:38:24] Seen 20,192 samples
[2023-07-28 15:38:24] Starting data epoch 251 in logical epoch 251
[2023-07-28 15:38:24] Training finished
[2023-07-28 15:40:09] [valid] Ep. 251 : Up. 9691 : translation : 0 : new best
[2023-07-28 15:40:09] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 15:40:15] Saving Adam parameters
[2023-07-28 15:40:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 15:40:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 15:40:27] [marian] Running on node18.datos.cluster.uy as process 5786 with command line:
[2023-07-28 15:40:27] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 260 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 15:40:28] [config] after: 0e
[2023-07-28 15:40:28] [config] after-batches: 0
[2023-07-28 15:40:28] [config] after-epochs: 260
[2023-07-28 15:40:28] [config] all-caps-every: 0
[2023-07-28 15:40:28] [config] allow-unk: false
[2023-07-28 15:40:28] [config] authors: false
[2023-07-28 15:40:28] [config] beam-size: 12
[2023-07-28 15:40:28] [config] bert-class-symbol: "[CLS]"
[2023-07-28 15:40:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 15:40:28] [config] bert-masking-fraction: 0.15
[2023-07-28 15:40:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 15:40:28] [config] bert-train-type-embeddings: true
[2023-07-28 15:40:28] [config] bert-type-vocab-size: 2
[2023-07-28 15:40:28] [config] build-info: ""
[2023-07-28 15:40:28] [config] check-gradient-nan: false
[2023-07-28 15:40:28] [config] check-nan: false
[2023-07-28 15:40:28] [config] cite: false
[2023-07-28 15:40:28] [config] clip-norm: 1
[2023-07-28 15:40:28] [config] cost-scaling:
[2023-07-28 15:40:28] [config]   - 256.f
[2023-07-28 15:40:28] [config]   - 1000
[2023-07-28 15:40:28] [config]   - 2.f
[2023-07-28 15:40:28] [config]   - 256.f
[2023-07-28 15:40:28] [config] cost-type: ce-sum
[2023-07-28 15:40:28] [config] cpu-threads: 0
[2023-07-28 15:40:28] [config] data-threads: 8
[2023-07-28 15:40:28] [config] data-weighting: ""
[2023-07-28 15:40:28] [config] data-weighting-type: sentence
[2023-07-28 15:40:28] [config] dec-cell: gru
[2023-07-28 15:40:28] [config] dec-cell-base-depth: 2
[2023-07-28 15:40:28] [config] dec-cell-high-depth: 1
[2023-07-28 15:40:28] [config] dec-depth: 1
[2023-07-28 15:40:28] [config] devices:
[2023-07-28 15:40:28] [config]   - 0
[2023-07-28 15:40:28] [config] dim-emb: 512
[2023-07-28 15:40:28] [config] dim-rnn: 1024
[2023-07-28 15:40:28] [config] dim-vocabs:
[2023-07-28 15:40:28] [config]   - 16384
[2023-07-28 15:40:28] [config]   - 16384
[2023-07-28 15:40:28] [config] disp-first: 0
[2023-07-28 15:40:28] [config] disp-freq: 1000u
[2023-07-28 15:40:28] [config] disp-label-counts: true
[2023-07-28 15:40:28] [config] dropout-rnn: 0
[2023-07-28 15:40:28] [config] dropout-src: 0
[2023-07-28 15:40:28] [config] dropout-trg: 0
[2023-07-28 15:40:28] [config] dump-config: ""
[2023-07-28 15:40:28] [config] dynamic-gradient-scaling:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] early-stopping: 1000
[2023-07-28 15:40:28] [config] early-stopping-on: first
[2023-07-28 15:40:28] [config] embedding-fix-src: false
[2023-07-28 15:40:28] [config] embedding-fix-trg: false
[2023-07-28 15:40:28] [config] embedding-normalization: false
[2023-07-28 15:40:28] [config] embedding-vectors:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] enc-cell: gru
[2023-07-28 15:40:28] [config] enc-cell-depth: 1
[2023-07-28 15:40:28] [config] enc-depth: 1
[2023-07-28 15:40:28] [config] enc-type: bidirectional
[2023-07-28 15:40:28] [config] english-title-case-every: 0
[2023-07-28 15:40:28] [config] exponential-smoothing: 0
[2023-07-28 15:40:28] [config] factor-weight: 1
[2023-07-28 15:40:28] [config] factors-combine: sum
[2023-07-28 15:40:28] [config] factors-dim-emb: 0
[2023-07-28 15:40:28] [config] gradient-checkpointing: false
[2023-07-28 15:40:28] [config] gradient-norm-average-window: 100
[2023-07-28 15:40:28] [config] guided-alignment: none
[2023-07-28 15:40:28] [config] guided-alignment-cost: mse
[2023-07-28 15:40:28] [config] guided-alignment-weight: 0.1
[2023-07-28 15:40:28] [config] ignore-model-config: false
[2023-07-28 15:40:28] [config] input-types:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] interpolate-env-vars: false
[2023-07-28 15:40:28] [config] keep-best: false
[2023-07-28 15:40:28] [config] label-smoothing: 0
[2023-07-28 15:40:28] [config] layer-normalization: false
[2023-07-28 15:40:28] [config] learn-rate: 0.0001
[2023-07-28 15:40:28] [config] lemma-dependency: ""
[2023-07-28 15:40:28] [config] lemma-dim-emb: 0
[2023-07-28 15:40:28] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 15:40:28] [config] log-level: info
[2023-07-28 15:40:28] [config] log-time-zone: ""
[2023-07-28 15:40:28] [config] logical-epoch:
[2023-07-28 15:40:28] [config]   - 1e
[2023-07-28 15:40:28] [config]   - 0
[2023-07-28 15:40:28] [config] lr-decay: 0
[2023-07-28 15:40:28] [config] lr-decay-freq: 50000
[2023-07-28 15:40:28] [config] lr-decay-inv-sqrt:
[2023-07-28 15:40:28] [config]   - 0
[2023-07-28 15:40:28] [config] lr-decay-repeat-warmup: false
[2023-07-28 15:40:28] [config] lr-decay-reset-optimizer: false
[2023-07-28 15:40:28] [config] lr-decay-start:
[2023-07-28 15:40:28] [config]   - 10
[2023-07-28 15:40:28] [config]   - 1
[2023-07-28 15:40:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 15:40:28] [config] lr-report: false
[2023-07-28 15:40:28] [config] lr-warmup: 0
[2023-07-28 15:40:28] [config] lr-warmup-at-reload: false
[2023-07-28 15:40:28] [config] lr-warmup-cycle: false
[2023-07-28 15:40:28] [config] lr-warmup-start-rate: 0
[2023-07-28 15:40:28] [config] max-length: 250
[2023-07-28 15:40:28] [config] max-length-crop: true
[2023-07-28 15:40:28] [config] max-length-factor: 3
[2023-07-28 15:40:28] [config] maxi-batch: 100
[2023-07-28 15:40:28] [config] maxi-batch-sort: trg
[2023-07-28 15:40:28] [config] mini-batch: 64
[2023-07-28 15:40:28] [config] mini-batch-fit: true
[2023-07-28 15:40:28] [config] mini-batch-fit-step: 10
[2023-07-28 15:40:28] [config] mini-batch-round-up: true
[2023-07-28 15:40:28] [config] mini-batch-track-lr: false
[2023-07-28 15:40:28] [config] mini-batch-warmup: 0
[2023-07-28 15:40:28] [config] mini-batch-words: 0
[2023-07-28 15:40:28] [config] mini-batch-words-ref: 0
[2023-07-28 15:40:28] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 15:40:28] [config] multi-loss-type: sum
[2023-07-28 15:40:28] [config] n-best: false
[2023-07-28 15:40:28] [config] no-nccl: false
[2023-07-28 15:40:28] [config] no-reload: false
[2023-07-28 15:40:28] [config] no-restore-corpus: false
[2023-07-28 15:40:28] [config] normalize: 0
[2023-07-28 15:40:28] [config] normalize-gradient: false
[2023-07-28 15:40:28] [config] num-devices: 0
[2023-07-28 15:40:28] [config] optimizer: adam
[2023-07-28 15:40:28] [config] optimizer-delay: 1
[2023-07-28 15:40:28] [config] optimizer-params:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] output-omit-bias: false
[2023-07-28 15:40:28] [config] overwrite: true
[2023-07-28 15:40:28] [config] precision:
[2023-07-28 15:40:28] [config]   - float16
[2023-07-28 15:40:28] [config]   - float32
[2023-07-28 15:40:28] [config] pretrained-model: ""
[2023-07-28 15:40:28] [config] quantize-biases: false
[2023-07-28 15:40:28] [config] quantize-bits: 0
[2023-07-28 15:40:28] [config] quantize-log-based: false
[2023-07-28 15:40:28] [config] quantize-optimization-steps: 0
[2023-07-28 15:40:28] [config] quiet: false
[2023-07-28 15:40:28] [config] quiet-translation: true
[2023-07-28 15:40:28] [config] relative-paths: false
[2023-07-28 15:40:28] [config] right-left: false
[2023-07-28 15:40:28] [config] save-freq: 10000u
[2023-07-28 15:40:28] [config] seed: 1234
[2023-07-28 15:40:28] [config] sentencepiece-alphas:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] sentencepiece-max-lines: 2000000
[2023-07-28 15:40:28] [config] sentencepiece-options: ""
[2023-07-28 15:40:28] [config] sharding: global
[2023-07-28 15:40:28] [config] shuffle: data
[2023-07-28 15:40:28] [config] shuffle-in-ram: false
[2023-07-28 15:40:28] [config] sigterm: save-and-exit
[2023-07-28 15:40:28] [config] skip: false
[2023-07-28 15:40:28] [config] sqlite: ""
[2023-07-28 15:40:28] [config] sqlite-drop: false
[2023-07-28 15:40:28] [config] sync-freq: 200u
[2023-07-28 15:40:28] [config] sync-sgd: false
[2023-07-28 15:40:28] [config] tempdir: /tmp
[2023-07-28 15:40:28] [config] tied-embeddings: false
[2023-07-28 15:40:28] [config] tied-embeddings-all: true
[2023-07-28 15:40:28] [config] tied-embeddings-src: false
[2023-07-28 15:40:28] [config] train-embedder-rank:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] train-sets:
[2023-07-28 15:40:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 15:40:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 15:40:28] [config] transformer-aan-activation: swish
[2023-07-28 15:40:28] [config] transformer-aan-depth: 2
[2023-07-28 15:40:28] [config] transformer-aan-nogate: false
[2023-07-28 15:40:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 15:40:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 15:40:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 15:40:28] [config] transformer-depth-scaling: false
[2023-07-28 15:40:28] [config] transformer-dim-aan: 2048
[2023-07-28 15:40:28] [config] transformer-dim-ffn: 2048
[2023-07-28 15:40:28] [config] transformer-dropout: 0
[2023-07-28 15:40:28] [config] transformer-dropout-attention: 0
[2023-07-28 15:40:28] [config] transformer-dropout-ffn: 0
[2023-07-28 15:40:28] [config] transformer-ffn-activation: swish
[2023-07-28 15:40:28] [config] transformer-ffn-depth: 2
[2023-07-28 15:40:28] [config] transformer-guided-alignment-layer: last
[2023-07-28 15:40:28] [config] transformer-heads: 8
[2023-07-28 15:40:28] [config] transformer-no-projection: false
[2023-07-28 15:40:28] [config] transformer-pool: false
[2023-07-28 15:40:28] [config] transformer-postprocess: dan
[2023-07-28 15:40:28] [config] transformer-postprocess-emb: d
[2023-07-28 15:40:28] [config] transformer-postprocess-top: ""
[2023-07-28 15:40:28] [config] transformer-preprocess: ""
[2023-07-28 15:40:28] [config] transformer-tied-layers:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] transformer-train-position-embeddings: false
[2023-07-28 15:40:28] [config] tsv: false
[2023-07-28 15:40:28] [config] tsv-fields: 0
[2023-07-28 15:40:28] [config] type: s2s
[2023-07-28 15:40:28] [config] ulr: false
[2023-07-28 15:40:28] [config] ulr-dim-emb: 0
[2023-07-28 15:40:28] [config] ulr-dropout: 0
[2023-07-28 15:40:28] [config] ulr-keys-vectors: ""
[2023-07-28 15:40:28] [config] ulr-query-vectors: ""
[2023-07-28 15:40:28] [config] ulr-softmax-temperature: 1
[2023-07-28 15:40:28] [config] ulr-trainable-transformation: false
[2023-07-28 15:40:28] [config] unlikelihood-loss: false
[2023-07-28 15:40:28] [config] valid-freq: 50000000
[2023-07-28 15:40:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 15:40:28] [config] valid-max-length: 1000
[2023-07-28 15:40:28] [config] valid-metrics:
[2023-07-28 15:40:28] [config]   - translation
[2023-07-28 15:40:28] [config] valid-mini-batch: 32
[2023-07-28 15:40:28] [config] valid-reset-stalled: false
[2023-07-28 15:40:28] [config] valid-script-args:
[2023-07-28 15:40:28] [config]   []
[2023-07-28 15:40:28] [config] valid-script-path: ""
[2023-07-28 15:40:28] [config] valid-sets:
[2023-07-28 15:40:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 15:40:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 15:40:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 15:40:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 15:40:28] [config] vocabs:
[2023-07-28 15:40:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 15:40:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 15:40:28] [config] word-penalty: 0
[2023-07-28 15:40:28] [config] word-scores: false
[2023-07-28 15:40:28] [config] workspace: 5500
[2023-07-28 15:40:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 15:40:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 15:40:28] [training] Using single-device training
[2023-07-28 15:40:28] Synced seed 1234
[2023-07-28 15:40:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 15:40:28] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 15:40:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 15:40:28] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 15:40:28] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 15:40:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 15:40:28] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 15:40:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 15:40:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 15:40:30] [comm] Using global sharding
[2023-07-28 15:40:30] [comm] NCCLCommunicators constructed successfully
[2023-07-28 15:40:30] [training] Using 1 GPUs
[2023-07-28 15:40:30] [logits] Applying loss function for 1 factor(s)
[2023-07-28 15:40:30] [memory] Reserving 80 MB, device gpu0
[2023-07-28 15:40:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 15:40:30] [memory] Reserving 80 MB, device gpu0
[2023-07-28 16:25:34] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 16:25:34] [valid] No post-processing script given for validating translator
[2023-07-28 16:25:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 16:25:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 16:25:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 16:25:34] [comm] Using global sharding
[2023-07-28 16:25:34] [comm] NCCLCommunicators constructed successfully
[2023-07-28 16:25:34] [training] Using 1 GPUs
[2023-07-28 16:25:34] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 16:25:37] Allocating memory for general optimizer shards
[2023-07-28 16:25:37] [memory] Reserving 322 MB, device gpu0
[2023-07-28 16:25:37] Loading Adam parameters
[2023-07-28 16:25:37] [memory] Reserving 322 MB, device gpu0
[2023-07-28 16:25:38] [memory] Reserving 80 MB, device gpu0
[2023-07-28 16:25:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 16:25:38] [data] Restoring the corpus state to epoch 261, batch 10082
[2023-07-28 16:25:38] [data] Shuffling data
[2023-07-28 16:25:38] [data] Done reading 20,192 sentences
[2023-07-28 16:25:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 16:25:38] Training started
[2023-07-28 16:25:38] Training finished
[2023-07-28 16:25:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 16:25:42] [marian] Running on node18.datos.cluster.uy as process 8920 with command line:
[2023-07-28 16:25:42] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 270 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 16:25:42] [config] after: 0e
[2023-07-28 16:25:42] [config] after-batches: 0
[2023-07-28 16:25:42] [config] after-epochs: 270
[2023-07-28 16:25:42] [config] all-caps-every: 0
[2023-07-28 16:25:42] [config] allow-unk: false
[2023-07-28 16:25:42] [config] authors: false
[2023-07-28 16:25:42] [config] beam-size: 12
[2023-07-28 16:25:42] [config] bert-class-symbol: "[CLS]"
[2023-07-28 16:25:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 16:25:42] [config] bert-masking-fraction: 0.15
[2023-07-28 16:25:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 16:25:42] [config] bert-train-type-embeddings: true
[2023-07-28 16:25:42] [config] bert-type-vocab-size: 2
[2023-07-28 16:25:42] [config] build-info: ""
[2023-07-28 16:25:42] [config] check-gradient-nan: false
[2023-07-28 16:25:42] [config] check-nan: false
[2023-07-28 16:25:42] [config] cite: false
[2023-07-28 16:25:42] [config] clip-norm: 1
[2023-07-28 16:25:42] [config] cost-scaling:
[2023-07-28 16:25:42] [config]   - 256.f
[2023-07-28 16:25:42] [config]   - 1000
[2023-07-28 16:25:42] [config]   - 2.f
[2023-07-28 16:25:42] [config]   - 256.f
[2023-07-28 16:25:42] [config] cost-type: ce-sum
[2023-07-28 16:25:42] [config] cpu-threads: 0
[2023-07-28 16:25:42] [config] data-threads: 8
[2023-07-28 16:25:42] [config] data-weighting: ""
[2023-07-28 16:25:42] [config] data-weighting-type: sentence
[2023-07-28 16:25:42] [config] dec-cell: gru
[2023-07-28 16:25:42] [config] dec-cell-base-depth: 2
[2023-07-28 16:25:42] [config] dec-cell-high-depth: 1
[2023-07-28 16:25:42] [config] dec-depth: 1
[2023-07-28 16:25:42] [config] devices:
[2023-07-28 16:25:42] [config]   - 0
[2023-07-28 16:25:42] [config] dim-emb: 512
[2023-07-28 16:25:42] [config] dim-rnn: 1024
[2023-07-28 16:25:42] [config] dim-vocabs:
[2023-07-28 16:25:42] [config]   - 16384
[2023-07-28 16:25:42] [config]   - 16384
[2023-07-28 16:25:42] [config] disp-first: 0
[2023-07-28 16:25:42] [config] disp-freq: 1000u
[2023-07-28 16:25:42] [config] disp-label-counts: true
[2023-07-28 16:25:42] [config] dropout-rnn: 0
[2023-07-28 16:25:42] [config] dropout-src: 0
[2023-07-28 16:25:42] [config] dropout-trg: 0
[2023-07-28 16:25:42] [config] dump-config: ""
[2023-07-28 16:25:42] [config] dynamic-gradient-scaling:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] early-stopping: 1000
[2023-07-28 16:25:42] [config] early-stopping-on: first
[2023-07-28 16:25:42] [config] embedding-fix-src: false
[2023-07-28 16:25:42] [config] embedding-fix-trg: false
[2023-07-28 16:25:42] [config] embedding-normalization: false
[2023-07-28 16:25:42] [config] embedding-vectors:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] enc-cell: gru
[2023-07-28 16:25:42] [config] enc-cell-depth: 1
[2023-07-28 16:25:42] [config] enc-depth: 1
[2023-07-28 16:25:42] [config] enc-type: bidirectional
[2023-07-28 16:25:42] [config] english-title-case-every: 0
[2023-07-28 16:25:42] [config] exponential-smoothing: 0
[2023-07-28 16:25:42] [config] factor-weight: 1
[2023-07-28 16:25:42] [config] factors-combine: sum
[2023-07-28 16:25:42] [config] factors-dim-emb: 0
[2023-07-28 16:25:42] [config] gradient-checkpointing: false
[2023-07-28 16:25:42] [config] gradient-norm-average-window: 100
[2023-07-28 16:25:42] [config] guided-alignment: none
[2023-07-28 16:25:42] [config] guided-alignment-cost: mse
[2023-07-28 16:25:42] [config] guided-alignment-weight: 0.1
[2023-07-28 16:25:42] [config] ignore-model-config: false
[2023-07-28 16:25:42] [config] input-types:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] interpolate-env-vars: false
[2023-07-28 16:25:42] [config] keep-best: false
[2023-07-28 16:25:42] [config] label-smoothing: 0
[2023-07-28 16:25:42] [config] layer-normalization: false
[2023-07-28 16:25:42] [config] learn-rate: 0.0001
[2023-07-28 16:25:42] [config] lemma-dependency: ""
[2023-07-28 16:25:42] [config] lemma-dim-emb: 0
[2023-07-28 16:25:42] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 16:25:42] [config] log-level: info
[2023-07-28 16:25:42] [config] log-time-zone: ""
[2023-07-28 16:25:42] [config] logical-epoch:
[2023-07-28 16:25:42] [config]   - 1e
[2023-07-28 16:25:42] [config]   - 0
[2023-07-28 16:25:42] [config] lr-decay: 0
[2023-07-28 16:25:42] [config] lr-decay-freq: 50000
[2023-07-28 16:25:42] [config] lr-decay-inv-sqrt:
[2023-07-28 16:25:42] [config]   - 0
[2023-07-28 16:25:42] [config] lr-decay-repeat-warmup: false
[2023-07-28 16:25:42] [config] lr-decay-reset-optimizer: false
[2023-07-28 16:25:42] [config] lr-decay-start:
[2023-07-28 16:25:42] [config]   - 10
[2023-07-28 16:25:42] [config]   - 1
[2023-07-28 16:25:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 16:25:42] [config] lr-report: false
[2023-07-28 16:25:42] [config] lr-warmup: 0
[2023-07-28 16:25:42] [config] lr-warmup-at-reload: false
[2023-07-28 16:25:42] [config] lr-warmup-cycle: false
[2023-07-28 16:25:42] [config] lr-warmup-start-rate: 0
[2023-07-28 16:25:42] [config] max-length: 250
[2023-07-28 16:25:42] [config] max-length-crop: true
[2023-07-28 16:25:42] [config] max-length-factor: 3
[2023-07-28 16:25:42] [config] maxi-batch: 100
[2023-07-28 16:25:42] [config] maxi-batch-sort: trg
[2023-07-28 16:25:42] [config] mini-batch: 64
[2023-07-28 16:25:42] [config] mini-batch-fit: true
[2023-07-28 16:25:42] [config] mini-batch-fit-step: 10
[2023-07-28 16:25:42] [config] mini-batch-round-up: true
[2023-07-28 16:25:42] [config] mini-batch-track-lr: false
[2023-07-28 16:25:42] [config] mini-batch-warmup: 0
[2023-07-28 16:25:42] [config] mini-batch-words: 0
[2023-07-28 16:25:42] [config] mini-batch-words-ref: 0
[2023-07-28 16:25:42] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 16:25:42] [config] multi-loss-type: sum
[2023-07-28 16:25:42] [config] n-best: false
[2023-07-28 16:25:42] [config] no-nccl: false
[2023-07-28 16:25:42] [config] no-reload: false
[2023-07-28 16:25:42] [config] no-restore-corpus: false
[2023-07-28 16:25:42] [config] normalize: 0
[2023-07-28 16:25:42] [config] normalize-gradient: false
[2023-07-28 16:25:42] [config] num-devices: 0
[2023-07-28 16:25:42] [config] optimizer: adam
[2023-07-28 16:25:42] [config] optimizer-delay: 1
[2023-07-28 16:25:42] [config] optimizer-params:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] output-omit-bias: false
[2023-07-28 16:25:42] [config] overwrite: true
[2023-07-28 16:25:42] [config] precision:
[2023-07-28 16:25:42] [config]   - float16
[2023-07-28 16:25:42] [config]   - float32
[2023-07-28 16:25:42] [config] pretrained-model: ""
[2023-07-28 16:25:42] [config] quantize-biases: false
[2023-07-28 16:25:42] [config] quantize-bits: 0
[2023-07-28 16:25:42] [config] quantize-log-based: false
[2023-07-28 16:25:42] [config] quantize-optimization-steps: 0
[2023-07-28 16:25:42] [config] quiet: false
[2023-07-28 16:25:42] [config] quiet-translation: true
[2023-07-28 16:25:42] [config] relative-paths: false
[2023-07-28 16:25:42] [config] right-left: false
[2023-07-28 16:25:42] [config] save-freq: 10000u
[2023-07-28 16:25:42] [config] seed: 1234
[2023-07-28 16:25:42] [config] sentencepiece-alphas:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] sentencepiece-max-lines: 2000000
[2023-07-28 16:25:42] [config] sentencepiece-options: ""
[2023-07-28 16:25:42] [config] sharding: global
[2023-07-28 16:25:42] [config] shuffle: data
[2023-07-28 16:25:42] [config] shuffle-in-ram: false
[2023-07-28 16:25:42] [config] sigterm: save-and-exit
[2023-07-28 16:25:42] [config] skip: false
[2023-07-28 16:25:42] [config] sqlite: ""
[2023-07-28 16:25:42] [config] sqlite-drop: false
[2023-07-28 16:25:42] [config] sync-freq: 200u
[2023-07-28 16:25:42] [config] sync-sgd: false
[2023-07-28 16:25:42] [config] tempdir: /tmp
[2023-07-28 16:25:42] [config] tied-embeddings: false
[2023-07-28 16:25:42] [config] tied-embeddings-all: true
[2023-07-28 16:25:42] [config] tied-embeddings-src: false
[2023-07-28 16:25:42] [config] train-embedder-rank:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] train-sets:
[2023-07-28 16:25:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 16:25:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 16:25:42] [config] transformer-aan-activation: swish
[2023-07-28 16:25:42] [config] transformer-aan-depth: 2
[2023-07-28 16:25:42] [config] transformer-aan-nogate: false
[2023-07-28 16:25:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 16:25:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 16:25:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 16:25:42] [config] transformer-depth-scaling: false
[2023-07-28 16:25:42] [config] transformer-dim-aan: 2048
[2023-07-28 16:25:42] [config] transformer-dim-ffn: 2048
[2023-07-28 16:25:42] [config] transformer-dropout: 0
[2023-07-28 16:25:42] [config] transformer-dropout-attention: 0
[2023-07-28 16:25:42] [config] transformer-dropout-ffn: 0
[2023-07-28 16:25:42] [config] transformer-ffn-activation: swish
[2023-07-28 16:25:42] [config] transformer-ffn-depth: 2
[2023-07-28 16:25:42] [config] transformer-guided-alignment-layer: last
[2023-07-28 16:25:42] [config] transformer-heads: 8
[2023-07-28 16:25:42] [config] transformer-no-projection: false
[2023-07-28 16:25:42] [config] transformer-pool: false
[2023-07-28 16:25:42] [config] transformer-postprocess: dan
[2023-07-28 16:25:42] [config] transformer-postprocess-emb: d
[2023-07-28 16:25:42] [config] transformer-postprocess-top: ""
[2023-07-28 16:25:42] [config] transformer-preprocess: ""
[2023-07-28 16:25:42] [config] transformer-tied-layers:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] transformer-train-position-embeddings: false
[2023-07-28 16:25:42] [config] tsv: false
[2023-07-28 16:25:42] [config] tsv-fields: 0
[2023-07-28 16:25:42] [config] type: s2s
[2023-07-28 16:25:42] [config] ulr: false
[2023-07-28 16:25:42] [config] ulr-dim-emb: 0
[2023-07-28 16:25:42] [config] ulr-dropout: 0
[2023-07-28 16:25:42] [config] ulr-keys-vectors: ""
[2023-07-28 16:25:42] [config] ulr-query-vectors: ""
[2023-07-28 16:25:42] [config] ulr-softmax-temperature: 1
[2023-07-28 16:25:42] [config] ulr-trainable-transformation: false
[2023-07-28 16:25:42] [config] unlikelihood-loss: false
[2023-07-28 16:25:42] [config] valid-freq: 50000000
[2023-07-28 16:25:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 16:25:42] [config] valid-max-length: 1000
[2023-07-28 16:25:42] [config] valid-metrics:
[2023-07-28 16:25:42] [config]   - translation
[2023-07-28 16:25:42] [config] valid-mini-batch: 32
[2023-07-28 16:25:42] [config] valid-reset-stalled: false
[2023-07-28 16:25:42] [config] valid-script-args:
[2023-07-28 16:25:42] [config]   []
[2023-07-28 16:25:42] [config] valid-script-path: ""
[2023-07-28 16:25:42] [config] valid-sets:
[2023-07-28 16:25:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 16:25:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 16:25:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 16:25:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 16:25:42] [config] vocabs:
[2023-07-28 16:25:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 16:25:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 16:25:42] [config] word-penalty: 0
[2023-07-28 16:25:42] [config] word-scores: false
[2023-07-28 16:25:42] [config] workspace: 5500
[2023-07-28 16:25:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 16:25:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 16:25:42] [training] Using single-device training
[2023-07-28 16:25:42] Synced seed 1234
[2023-07-28 16:25:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 16:25:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 16:25:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 16:25:42] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 16:25:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 16:25:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 16:25:42] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 16:25:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 16:25:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 16:25:43] [comm] Using global sharding
[2023-07-28 16:25:43] [comm] NCCLCommunicators constructed successfully
[2023-07-28 16:25:43] [training] Using 1 GPUs
[2023-07-28 16:25:43] [logits] Applying loss function for 1 factor(s)
[2023-07-28 16:25:43] [memory] Reserving 80 MB, device gpu0
[2023-07-28 16:25:44] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 16:25:44] [memory] Reserving 80 MB, device gpu0
[2023-07-28 17:11:28] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 17:11:28] [valid] No post-processing script given for validating translator
[2023-07-28 17:11:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 17:11:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 17:11:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 17:11:29] [comm] Using global sharding
[2023-07-28 17:11:29] [comm] NCCLCommunicators constructed successfully
[2023-07-28 17:11:29] [training] Using 1 GPUs
[2023-07-28 17:11:29] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 17:11:30] Allocating memory for general optimizer shards
[2023-07-28 17:11:30] [memory] Reserving 322 MB, device gpu0
[2023-07-28 17:11:30] Loading Adam parameters
[2023-07-28 17:11:30] [memory] Reserving 322 MB, device gpu0
[2023-07-28 17:11:30] [memory] Reserving 80 MB, device gpu0
[2023-07-28 17:11:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 17:11:30] [data] Restoring the corpus state to epoch 261, batch 10082
[2023-07-28 17:11:30] [data] Shuffling data
[2023-07-28 17:11:30] [data] Done reading 20,192 sentences
[2023-07-28 17:11:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:11:30] Training started
[2023-07-28 17:11:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 17:11:31] [memory] Reserving 80 MB, device gpu0
[2023-07-28 17:11:36] Parameter type float16, optimization type float32, casting types true
[2023-07-28 17:15:42] Seen 20,192 samples
[2023-07-28 17:15:42] Starting data epoch 262 in logical epoch 262
[2023-07-28 17:15:42] [data] Shuffling data
[2023-07-28 17:15:42] [data] Done reading 20,192 sentences
[2023-07-28 17:15:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:20:06] Seen 20,192 samples
[2023-07-28 17:20:06] Starting data epoch 263 in logical epoch 263
[2023-07-28 17:20:06] [data] Shuffling data
[2023-07-28 17:20:06] [data] Done reading 20,192 sentences
[2023-07-28 17:20:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:23:53] Seen 20,192 samples
[2023-07-28 17:23:53] Starting data epoch 264 in logical epoch 264
[2023-07-28 17:23:53] [data] Shuffling data
[2023-07-28 17:23:53] [data] Done reading 20,192 sentences
[2023-07-28 17:23:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:27:20] Seen 20,192 samples
[2023-07-28 17:27:20] Starting data epoch 265 in logical epoch 265
[2023-07-28 17:27:20] [data] Shuffling data
[2023-07-28 17:27:20] [data] Done reading 20,192 sentences
[2023-07-28 17:27:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:31:17] Seen 20,192 samples
[2023-07-28 17:31:17] Starting data epoch 266 in logical epoch 266
[2023-07-28 17:31:17] [data] Shuffling data
[2023-07-28 17:31:17] [data] Done reading 20,192 sentences
[2023-07-28 17:31:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:35:21] Seen 20,192 samples
[2023-07-28 17:35:21] Starting data epoch 267 in logical epoch 267
[2023-07-28 17:35:21] [data] Shuffling data
[2023-07-28 17:35:21] [data] Done reading 20,192 sentences
[2023-07-28 17:35:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:39:27] Seen 20,192 samples
[2023-07-28 17:39:27] Starting data epoch 268 in logical epoch 268
[2023-07-28 17:39:27] [data] Shuffling data
[2023-07-28 17:39:27] [data] Done reading 20,192 sentences
[2023-07-28 17:39:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:43:45] Seen 20,192 samples
[2023-07-28 17:43:45] Starting data epoch 269 in logical epoch 269
[2023-07-28 17:43:45] [data] Shuffling data
[2023-07-28 17:43:45] [data] Done reading 20,192 sentences
[2023-07-28 17:43:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:48:00] Seen 20,192 samples
[2023-07-28 17:48:00] Starting data epoch 270 in logical epoch 270
[2023-07-28 17:48:00] [data] Shuffling data
[2023-07-28 17:48:00] [data] Done reading 20,192 sentences
[2023-07-28 17:48:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 17:52:09] Seen 20,192 samples
[2023-07-28 17:52:09] Starting data epoch 271 in logical epoch 271
[2023-07-28 17:52:09] Training finished
[2023-07-28 17:53:55] [valid] Ep. 271 : Up. 10471 : translation : 0 : new best
[2023-07-28 17:53:55] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 17:53:57] Saving Adam parameters
[2023-07-28 17:53:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 17:54:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 17:54:05] [marian] Running on node18.datos.cluster.uy as process 14677 with command line:
[2023-07-28 17:54:05] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 280 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 17:54:05] [config] after: 0e
[2023-07-28 17:54:05] [config] after-batches: 0
[2023-07-28 17:54:05] [config] after-epochs: 280
[2023-07-28 17:54:05] [config] all-caps-every: 0
[2023-07-28 17:54:05] [config] allow-unk: false
[2023-07-28 17:54:05] [config] authors: false
[2023-07-28 17:54:05] [config] beam-size: 12
[2023-07-28 17:54:05] [config] bert-class-symbol: "[CLS]"
[2023-07-28 17:54:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 17:54:05] [config] bert-masking-fraction: 0.15
[2023-07-28 17:54:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 17:54:05] [config] bert-train-type-embeddings: true
[2023-07-28 17:54:05] [config] bert-type-vocab-size: 2
[2023-07-28 17:54:05] [config] build-info: ""
[2023-07-28 17:54:05] [config] check-gradient-nan: false
[2023-07-28 17:54:05] [config] check-nan: false
[2023-07-28 17:54:05] [config] cite: false
[2023-07-28 17:54:05] [config] clip-norm: 1
[2023-07-28 17:54:05] [config] cost-scaling:
[2023-07-28 17:54:05] [config]   - 256.f
[2023-07-28 17:54:05] [config]   - 1000
[2023-07-28 17:54:05] [config]   - 2.f
[2023-07-28 17:54:05] [config]   - 256.f
[2023-07-28 17:54:05] [config] cost-type: ce-sum
[2023-07-28 17:54:05] [config] cpu-threads: 0
[2023-07-28 17:54:05] [config] data-threads: 8
[2023-07-28 17:54:05] [config] data-weighting: ""
[2023-07-28 17:54:05] [config] data-weighting-type: sentence
[2023-07-28 17:54:05] [config] dec-cell: gru
[2023-07-28 17:54:05] [config] dec-cell-base-depth: 2
[2023-07-28 17:54:05] [config] dec-cell-high-depth: 1
[2023-07-28 17:54:05] [config] dec-depth: 1
[2023-07-28 17:54:05] [config] devices:
[2023-07-28 17:54:05] [config]   - 0
[2023-07-28 17:54:05] [config] dim-emb: 512
[2023-07-28 17:54:05] [config] dim-rnn: 1024
[2023-07-28 17:54:05] [config] dim-vocabs:
[2023-07-28 17:54:05] [config]   - 16384
[2023-07-28 17:54:05] [config]   - 16384
[2023-07-28 17:54:05] [config] disp-first: 0
[2023-07-28 17:54:05] [config] disp-freq: 1000u
[2023-07-28 17:54:05] [config] disp-label-counts: true
[2023-07-28 17:54:05] [config] dropout-rnn: 0
[2023-07-28 17:54:05] [config] dropout-src: 0
[2023-07-28 17:54:05] [config] dropout-trg: 0
[2023-07-28 17:54:05] [config] dump-config: ""
[2023-07-28 17:54:05] [config] dynamic-gradient-scaling:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] early-stopping: 1000
[2023-07-28 17:54:05] [config] early-stopping-on: first
[2023-07-28 17:54:05] [config] embedding-fix-src: false
[2023-07-28 17:54:05] [config] embedding-fix-trg: false
[2023-07-28 17:54:05] [config] embedding-normalization: false
[2023-07-28 17:54:05] [config] embedding-vectors:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] enc-cell: gru
[2023-07-28 17:54:05] [config] enc-cell-depth: 1
[2023-07-28 17:54:05] [config] enc-depth: 1
[2023-07-28 17:54:05] [config] enc-type: bidirectional
[2023-07-28 17:54:05] [config] english-title-case-every: 0
[2023-07-28 17:54:05] [config] exponential-smoothing: 0
[2023-07-28 17:54:05] [config] factor-weight: 1
[2023-07-28 17:54:05] [config] factors-combine: sum
[2023-07-28 17:54:05] [config] factors-dim-emb: 0
[2023-07-28 17:54:05] [config] gradient-checkpointing: false
[2023-07-28 17:54:05] [config] gradient-norm-average-window: 100
[2023-07-28 17:54:05] [config] guided-alignment: none
[2023-07-28 17:54:05] [config] guided-alignment-cost: mse
[2023-07-28 17:54:05] [config] guided-alignment-weight: 0.1
[2023-07-28 17:54:05] [config] ignore-model-config: false
[2023-07-28 17:54:05] [config] input-types:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] interpolate-env-vars: false
[2023-07-28 17:54:05] [config] keep-best: false
[2023-07-28 17:54:05] [config] label-smoothing: 0
[2023-07-28 17:54:05] [config] layer-normalization: false
[2023-07-28 17:54:05] [config] learn-rate: 0.0001
[2023-07-28 17:54:05] [config] lemma-dependency: ""
[2023-07-28 17:54:05] [config] lemma-dim-emb: 0
[2023-07-28 17:54:05] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 17:54:05] [config] log-level: info
[2023-07-28 17:54:05] [config] log-time-zone: ""
[2023-07-28 17:54:05] [config] logical-epoch:
[2023-07-28 17:54:05] [config]   - 1e
[2023-07-28 17:54:05] [config]   - 0
[2023-07-28 17:54:05] [config] lr-decay: 0
[2023-07-28 17:54:05] [config] lr-decay-freq: 50000
[2023-07-28 17:54:05] [config] lr-decay-inv-sqrt:
[2023-07-28 17:54:05] [config]   - 0
[2023-07-28 17:54:05] [config] lr-decay-repeat-warmup: false
[2023-07-28 17:54:05] [config] lr-decay-reset-optimizer: false
[2023-07-28 17:54:05] [config] lr-decay-start:
[2023-07-28 17:54:05] [config]   - 10
[2023-07-28 17:54:05] [config]   - 1
[2023-07-28 17:54:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 17:54:05] [config] lr-report: false
[2023-07-28 17:54:05] [config] lr-warmup: 0
[2023-07-28 17:54:05] [config] lr-warmup-at-reload: false
[2023-07-28 17:54:05] [config] lr-warmup-cycle: false
[2023-07-28 17:54:05] [config] lr-warmup-start-rate: 0
[2023-07-28 17:54:05] [config] max-length: 250
[2023-07-28 17:54:05] [config] max-length-crop: true
[2023-07-28 17:54:05] [config] max-length-factor: 3
[2023-07-28 17:54:05] [config] maxi-batch: 100
[2023-07-28 17:54:05] [config] maxi-batch-sort: trg
[2023-07-28 17:54:05] [config] mini-batch: 64
[2023-07-28 17:54:05] [config] mini-batch-fit: true
[2023-07-28 17:54:05] [config] mini-batch-fit-step: 10
[2023-07-28 17:54:05] [config] mini-batch-round-up: true
[2023-07-28 17:54:05] [config] mini-batch-track-lr: false
[2023-07-28 17:54:05] [config] mini-batch-warmup: 0
[2023-07-28 17:54:05] [config] mini-batch-words: 0
[2023-07-28 17:54:05] [config] mini-batch-words-ref: 0
[2023-07-28 17:54:05] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 17:54:05] [config] multi-loss-type: sum
[2023-07-28 17:54:05] [config] n-best: false
[2023-07-28 17:54:05] [config] no-nccl: false
[2023-07-28 17:54:05] [config] no-reload: false
[2023-07-28 17:54:05] [config] no-restore-corpus: false
[2023-07-28 17:54:05] [config] normalize: 0
[2023-07-28 17:54:05] [config] normalize-gradient: false
[2023-07-28 17:54:05] [config] num-devices: 0
[2023-07-28 17:54:05] [config] optimizer: adam
[2023-07-28 17:54:05] [config] optimizer-delay: 1
[2023-07-28 17:54:05] [config] optimizer-params:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] output-omit-bias: false
[2023-07-28 17:54:05] [config] overwrite: true
[2023-07-28 17:54:05] [config] precision:
[2023-07-28 17:54:05] [config]   - float16
[2023-07-28 17:54:05] [config]   - float32
[2023-07-28 17:54:05] [config] pretrained-model: ""
[2023-07-28 17:54:05] [config] quantize-biases: false
[2023-07-28 17:54:05] [config] quantize-bits: 0
[2023-07-28 17:54:05] [config] quantize-log-based: false
[2023-07-28 17:54:05] [config] quantize-optimization-steps: 0
[2023-07-28 17:54:05] [config] quiet: false
[2023-07-28 17:54:05] [config] quiet-translation: true
[2023-07-28 17:54:05] [config] relative-paths: false
[2023-07-28 17:54:05] [config] right-left: false
[2023-07-28 17:54:05] [config] save-freq: 10000u
[2023-07-28 17:54:05] [config] seed: 1234
[2023-07-28 17:54:05] [config] sentencepiece-alphas:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] sentencepiece-max-lines: 2000000
[2023-07-28 17:54:05] [config] sentencepiece-options: ""
[2023-07-28 17:54:05] [config] sharding: global
[2023-07-28 17:54:05] [config] shuffle: data
[2023-07-28 17:54:05] [config] shuffle-in-ram: false
[2023-07-28 17:54:05] [config] sigterm: save-and-exit
[2023-07-28 17:54:05] [config] skip: false
[2023-07-28 17:54:05] [config] sqlite: ""
[2023-07-28 17:54:05] [config] sqlite-drop: false
[2023-07-28 17:54:05] [config] sync-freq: 200u
[2023-07-28 17:54:05] [config] sync-sgd: false
[2023-07-28 17:54:05] [config] tempdir: /tmp
[2023-07-28 17:54:05] [config] tied-embeddings: false
[2023-07-28 17:54:05] [config] tied-embeddings-all: true
[2023-07-28 17:54:05] [config] tied-embeddings-src: false
[2023-07-28 17:54:05] [config] train-embedder-rank:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] train-sets:
[2023-07-28 17:54:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 17:54:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 17:54:05] [config] transformer-aan-activation: swish
[2023-07-28 17:54:05] [config] transformer-aan-depth: 2
[2023-07-28 17:54:05] [config] transformer-aan-nogate: false
[2023-07-28 17:54:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 17:54:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 17:54:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 17:54:05] [config] transformer-depth-scaling: false
[2023-07-28 17:54:05] [config] transformer-dim-aan: 2048
[2023-07-28 17:54:05] [config] transformer-dim-ffn: 2048
[2023-07-28 17:54:05] [config] transformer-dropout: 0
[2023-07-28 17:54:05] [config] transformer-dropout-attention: 0
[2023-07-28 17:54:05] [config] transformer-dropout-ffn: 0
[2023-07-28 17:54:05] [config] transformer-ffn-activation: swish
[2023-07-28 17:54:05] [config] transformer-ffn-depth: 2
[2023-07-28 17:54:05] [config] transformer-guided-alignment-layer: last
[2023-07-28 17:54:05] [config] transformer-heads: 8
[2023-07-28 17:54:05] [config] transformer-no-projection: false
[2023-07-28 17:54:05] [config] transformer-pool: false
[2023-07-28 17:54:05] [config] transformer-postprocess: dan
[2023-07-28 17:54:05] [config] transformer-postprocess-emb: d
[2023-07-28 17:54:05] [config] transformer-postprocess-top: ""
[2023-07-28 17:54:05] [config] transformer-preprocess: ""
[2023-07-28 17:54:05] [config] transformer-tied-layers:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] transformer-train-position-embeddings: false
[2023-07-28 17:54:05] [config] tsv: false
[2023-07-28 17:54:05] [config] tsv-fields: 0
[2023-07-28 17:54:05] [config] type: s2s
[2023-07-28 17:54:05] [config] ulr: false
[2023-07-28 17:54:05] [config] ulr-dim-emb: 0
[2023-07-28 17:54:05] [config] ulr-dropout: 0
[2023-07-28 17:54:05] [config] ulr-keys-vectors: ""
[2023-07-28 17:54:05] [config] ulr-query-vectors: ""
[2023-07-28 17:54:05] [config] ulr-softmax-temperature: 1
[2023-07-28 17:54:05] [config] ulr-trainable-transformation: false
[2023-07-28 17:54:05] [config] unlikelihood-loss: false
[2023-07-28 17:54:05] [config] valid-freq: 50000000
[2023-07-28 17:54:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 17:54:05] [config] valid-max-length: 1000
[2023-07-28 17:54:05] [config] valid-metrics:
[2023-07-28 17:54:05] [config]   - translation
[2023-07-28 17:54:05] [config] valid-mini-batch: 32
[2023-07-28 17:54:05] [config] valid-reset-stalled: false
[2023-07-28 17:54:05] [config] valid-script-args:
[2023-07-28 17:54:05] [config]   []
[2023-07-28 17:54:05] [config] valid-script-path: ""
[2023-07-28 17:54:05] [config] valid-sets:
[2023-07-28 17:54:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 17:54:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 17:54:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 17:54:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 17:54:05] [config] vocabs:
[2023-07-28 17:54:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 17:54:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 17:54:05] [config] word-penalty: 0
[2023-07-28 17:54:05] [config] word-scores: false
[2023-07-28 17:54:05] [config] workspace: 5500
[2023-07-28 17:54:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 17:54:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 17:54:05] [training] Using single-device training
[2023-07-28 17:54:06] Synced seed 1234
[2023-07-28 17:54:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 17:54:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 17:54:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 17:54:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 17:54:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 17:54:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 17:54:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 17:54:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 17:54:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 17:54:07] [comm] Using global sharding
[2023-07-28 17:54:07] [comm] NCCLCommunicators constructed successfully
[2023-07-28 17:54:07] [training] Using 1 GPUs
[2023-07-28 17:54:07] [logits] Applying loss function for 1 factor(s)
[2023-07-28 17:54:07] [memory] Reserving 80 MB, device gpu0
[2023-07-28 17:54:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 17:54:07] [memory] Reserving 80 MB, device gpu0
[2023-07-28 18:41:28] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 18:41:28] [valid] No post-processing script given for validating translator
[2023-07-28 18:41:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 18:41:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 18:41:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 18:41:28] [comm] Using global sharding
[2023-07-28 18:41:28] [comm] NCCLCommunicators constructed successfully
[2023-07-28 18:41:28] [training] Using 1 GPUs
[2023-07-28 18:41:29] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 18:41:38] Allocating memory for general optimizer shards
[2023-07-28 18:41:38] [memory] Reserving 322 MB, device gpu0
[2023-07-28 18:41:38] Loading Adam parameters
[2023-07-28 18:41:38] [memory] Reserving 322 MB, device gpu0
[2023-07-28 18:41:38] [memory] Reserving 80 MB, device gpu0
[2023-07-28 18:41:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 18:41:39] [data] Restoring the corpus state to epoch 281, batch 10858
[2023-07-28 18:41:39] [data] Shuffling data
[2023-07-28 18:41:39] [data] Done reading 20,192 sentences
[2023-07-28 18:41:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 18:41:39] Training started
[2023-07-28 18:41:39] Training finished
[2023-07-28 18:41:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 18:41:43] [marian] Running on node18.datos.cluster.uy as process 17578 with command line:
[2023-07-28 18:41:43] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 290 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 18:41:43] [config] after: 0e
[2023-07-28 18:41:43] [config] after-batches: 0
[2023-07-28 18:41:43] [config] after-epochs: 290
[2023-07-28 18:41:43] [config] all-caps-every: 0
[2023-07-28 18:41:43] [config] allow-unk: false
[2023-07-28 18:41:43] [config] authors: false
[2023-07-28 18:41:43] [config] beam-size: 12
[2023-07-28 18:41:43] [config] bert-class-symbol: "[CLS]"
[2023-07-28 18:41:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 18:41:43] [config] bert-masking-fraction: 0.15
[2023-07-28 18:41:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 18:41:43] [config] bert-train-type-embeddings: true
[2023-07-28 18:41:43] [config] bert-type-vocab-size: 2
[2023-07-28 18:41:43] [config] build-info: ""
[2023-07-28 18:41:43] [config] check-gradient-nan: false
[2023-07-28 18:41:43] [config] check-nan: false
[2023-07-28 18:41:43] [config] cite: false
[2023-07-28 18:41:43] [config] clip-norm: 1
[2023-07-28 18:41:43] [config] cost-scaling:
[2023-07-28 18:41:43] [config]   - 256.f
[2023-07-28 18:41:43] [config]   - 1000
[2023-07-28 18:41:43] [config]   - 2.f
[2023-07-28 18:41:43] [config]   - 256.f
[2023-07-28 18:41:43] [config] cost-type: ce-sum
[2023-07-28 18:41:43] [config] cpu-threads: 0
[2023-07-28 18:41:43] [config] data-threads: 8
[2023-07-28 18:41:43] [config] data-weighting: ""
[2023-07-28 18:41:43] [config] data-weighting-type: sentence
[2023-07-28 18:41:43] [config] dec-cell: gru
[2023-07-28 18:41:43] [config] dec-cell-base-depth: 2
[2023-07-28 18:41:43] [config] dec-cell-high-depth: 1
[2023-07-28 18:41:43] [config] dec-depth: 1
[2023-07-28 18:41:43] [config] devices:
[2023-07-28 18:41:43] [config]   - 0
[2023-07-28 18:41:43] [config] dim-emb: 512
[2023-07-28 18:41:43] [config] dim-rnn: 1024
[2023-07-28 18:41:43] [config] dim-vocabs:
[2023-07-28 18:41:43] [config]   - 16384
[2023-07-28 18:41:43] [config]   - 16384
[2023-07-28 18:41:43] [config] disp-first: 0
[2023-07-28 18:41:43] [config] disp-freq: 1000u
[2023-07-28 18:41:43] [config] disp-label-counts: true
[2023-07-28 18:41:43] [config] dropout-rnn: 0
[2023-07-28 18:41:43] [config] dropout-src: 0
[2023-07-28 18:41:43] [config] dropout-trg: 0
[2023-07-28 18:41:43] [config] dump-config: ""
[2023-07-28 18:41:43] [config] dynamic-gradient-scaling:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] early-stopping: 1000
[2023-07-28 18:41:43] [config] early-stopping-on: first
[2023-07-28 18:41:43] [config] embedding-fix-src: false
[2023-07-28 18:41:43] [config] embedding-fix-trg: false
[2023-07-28 18:41:43] [config] embedding-normalization: false
[2023-07-28 18:41:43] [config] embedding-vectors:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] enc-cell: gru
[2023-07-28 18:41:43] [config] enc-cell-depth: 1
[2023-07-28 18:41:43] [config] enc-depth: 1
[2023-07-28 18:41:43] [config] enc-type: bidirectional
[2023-07-28 18:41:43] [config] english-title-case-every: 0
[2023-07-28 18:41:43] [config] exponential-smoothing: 0
[2023-07-28 18:41:43] [config] factor-weight: 1
[2023-07-28 18:41:43] [config] factors-combine: sum
[2023-07-28 18:41:43] [config] factors-dim-emb: 0
[2023-07-28 18:41:43] [config] gradient-checkpointing: false
[2023-07-28 18:41:43] [config] gradient-norm-average-window: 100
[2023-07-28 18:41:43] [config] guided-alignment: none
[2023-07-28 18:41:43] [config] guided-alignment-cost: mse
[2023-07-28 18:41:43] [config] guided-alignment-weight: 0.1
[2023-07-28 18:41:43] [config] ignore-model-config: false
[2023-07-28 18:41:43] [config] input-types:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] interpolate-env-vars: false
[2023-07-28 18:41:43] [config] keep-best: false
[2023-07-28 18:41:43] [config] label-smoothing: 0
[2023-07-28 18:41:43] [config] layer-normalization: false
[2023-07-28 18:41:43] [config] learn-rate: 0.0001
[2023-07-28 18:41:43] [config] lemma-dependency: ""
[2023-07-28 18:41:43] [config] lemma-dim-emb: 0
[2023-07-28 18:41:43] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 18:41:43] [config] log-level: info
[2023-07-28 18:41:43] [config] log-time-zone: ""
[2023-07-28 18:41:43] [config] logical-epoch:
[2023-07-28 18:41:43] [config]   - 1e
[2023-07-28 18:41:43] [config]   - 0
[2023-07-28 18:41:43] [config] lr-decay: 0
[2023-07-28 18:41:43] [config] lr-decay-freq: 50000
[2023-07-28 18:41:43] [config] lr-decay-inv-sqrt:
[2023-07-28 18:41:43] [config]   - 0
[2023-07-28 18:41:43] [config] lr-decay-repeat-warmup: false
[2023-07-28 18:41:43] [config] lr-decay-reset-optimizer: false
[2023-07-28 18:41:43] [config] lr-decay-start:
[2023-07-28 18:41:43] [config]   - 10
[2023-07-28 18:41:43] [config]   - 1
[2023-07-28 18:41:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 18:41:43] [config] lr-report: false
[2023-07-28 18:41:43] [config] lr-warmup: 0
[2023-07-28 18:41:43] [config] lr-warmup-at-reload: false
[2023-07-28 18:41:43] [config] lr-warmup-cycle: false
[2023-07-28 18:41:43] [config] lr-warmup-start-rate: 0
[2023-07-28 18:41:43] [config] max-length: 250
[2023-07-28 18:41:43] [config] max-length-crop: true
[2023-07-28 18:41:43] [config] max-length-factor: 3
[2023-07-28 18:41:43] [config] maxi-batch: 100
[2023-07-28 18:41:43] [config] maxi-batch-sort: trg
[2023-07-28 18:41:43] [config] mini-batch: 64
[2023-07-28 18:41:43] [config] mini-batch-fit: true
[2023-07-28 18:41:43] [config] mini-batch-fit-step: 10
[2023-07-28 18:41:43] [config] mini-batch-round-up: true
[2023-07-28 18:41:43] [config] mini-batch-track-lr: false
[2023-07-28 18:41:43] [config] mini-batch-warmup: 0
[2023-07-28 18:41:43] [config] mini-batch-words: 0
[2023-07-28 18:41:43] [config] mini-batch-words-ref: 0
[2023-07-28 18:41:43] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 18:41:43] [config] multi-loss-type: sum
[2023-07-28 18:41:43] [config] n-best: false
[2023-07-28 18:41:43] [config] no-nccl: false
[2023-07-28 18:41:43] [config] no-reload: false
[2023-07-28 18:41:43] [config] no-restore-corpus: false
[2023-07-28 18:41:43] [config] normalize: 0
[2023-07-28 18:41:43] [config] normalize-gradient: false
[2023-07-28 18:41:43] [config] num-devices: 0
[2023-07-28 18:41:43] [config] optimizer: adam
[2023-07-28 18:41:43] [config] optimizer-delay: 1
[2023-07-28 18:41:43] [config] optimizer-params:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] output-omit-bias: false
[2023-07-28 18:41:43] [config] overwrite: true
[2023-07-28 18:41:43] [config] precision:
[2023-07-28 18:41:43] [config]   - float16
[2023-07-28 18:41:43] [config]   - float32
[2023-07-28 18:41:43] [config] pretrained-model: ""
[2023-07-28 18:41:43] [config] quantize-biases: false
[2023-07-28 18:41:43] [config] quantize-bits: 0
[2023-07-28 18:41:43] [config] quantize-log-based: false
[2023-07-28 18:41:43] [config] quantize-optimization-steps: 0
[2023-07-28 18:41:43] [config] quiet: false
[2023-07-28 18:41:43] [config] quiet-translation: true
[2023-07-28 18:41:43] [config] relative-paths: false
[2023-07-28 18:41:43] [config] right-left: false
[2023-07-28 18:41:43] [config] save-freq: 10000u
[2023-07-28 18:41:43] [config] seed: 1234
[2023-07-28 18:41:43] [config] sentencepiece-alphas:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] sentencepiece-max-lines: 2000000
[2023-07-28 18:41:43] [config] sentencepiece-options: ""
[2023-07-28 18:41:43] [config] sharding: global
[2023-07-28 18:41:43] [config] shuffle: data
[2023-07-28 18:41:43] [config] shuffle-in-ram: false
[2023-07-28 18:41:43] [config] sigterm: save-and-exit
[2023-07-28 18:41:43] [config] skip: false
[2023-07-28 18:41:43] [config] sqlite: ""
[2023-07-28 18:41:43] [config] sqlite-drop: false
[2023-07-28 18:41:43] [config] sync-freq: 200u
[2023-07-28 18:41:43] [config] sync-sgd: false
[2023-07-28 18:41:43] [config] tempdir: /tmp
[2023-07-28 18:41:43] [config] tied-embeddings: false
[2023-07-28 18:41:43] [config] tied-embeddings-all: true
[2023-07-28 18:41:43] [config] tied-embeddings-src: false
[2023-07-28 18:41:43] [config] train-embedder-rank:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] train-sets:
[2023-07-28 18:41:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 18:41:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 18:41:43] [config] transformer-aan-activation: swish
[2023-07-28 18:41:43] [config] transformer-aan-depth: 2
[2023-07-28 18:41:43] [config] transformer-aan-nogate: false
[2023-07-28 18:41:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 18:41:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 18:41:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 18:41:43] [config] transformer-depth-scaling: false
[2023-07-28 18:41:43] [config] transformer-dim-aan: 2048
[2023-07-28 18:41:43] [config] transformer-dim-ffn: 2048
[2023-07-28 18:41:43] [config] transformer-dropout: 0
[2023-07-28 18:41:43] [config] transformer-dropout-attention: 0
[2023-07-28 18:41:43] [config] transformer-dropout-ffn: 0
[2023-07-28 18:41:43] [config] transformer-ffn-activation: swish
[2023-07-28 18:41:43] [config] transformer-ffn-depth: 2
[2023-07-28 18:41:43] [config] transformer-guided-alignment-layer: last
[2023-07-28 18:41:43] [config] transformer-heads: 8
[2023-07-28 18:41:43] [config] transformer-no-projection: false
[2023-07-28 18:41:43] [config] transformer-pool: false
[2023-07-28 18:41:43] [config] transformer-postprocess: dan
[2023-07-28 18:41:43] [config] transformer-postprocess-emb: d
[2023-07-28 18:41:43] [config] transformer-postprocess-top: ""
[2023-07-28 18:41:43] [config] transformer-preprocess: ""
[2023-07-28 18:41:43] [config] transformer-tied-layers:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] transformer-train-position-embeddings: false
[2023-07-28 18:41:43] [config] tsv: false
[2023-07-28 18:41:43] [config] tsv-fields: 0
[2023-07-28 18:41:43] [config] type: s2s
[2023-07-28 18:41:43] [config] ulr: false
[2023-07-28 18:41:43] [config] ulr-dim-emb: 0
[2023-07-28 18:41:43] [config] ulr-dropout: 0
[2023-07-28 18:41:43] [config] ulr-keys-vectors: ""
[2023-07-28 18:41:43] [config] ulr-query-vectors: ""
[2023-07-28 18:41:43] [config] ulr-softmax-temperature: 1
[2023-07-28 18:41:43] [config] ulr-trainable-transformation: false
[2023-07-28 18:41:43] [config] unlikelihood-loss: false
[2023-07-28 18:41:43] [config] valid-freq: 50000000
[2023-07-28 18:41:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 18:41:43] [config] valid-max-length: 1000
[2023-07-28 18:41:43] [config] valid-metrics:
[2023-07-28 18:41:43] [config]   - translation
[2023-07-28 18:41:43] [config] valid-mini-batch: 32
[2023-07-28 18:41:43] [config] valid-reset-stalled: false
[2023-07-28 18:41:43] [config] valid-script-args:
[2023-07-28 18:41:43] [config]   []
[2023-07-28 18:41:43] [config] valid-script-path: ""
[2023-07-28 18:41:43] [config] valid-sets:
[2023-07-28 18:41:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 18:41:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 18:41:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 18:41:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 18:41:43] [config] vocabs:
[2023-07-28 18:41:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 18:41:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 18:41:43] [config] word-penalty: 0
[2023-07-28 18:41:43] [config] word-scores: false
[2023-07-28 18:41:43] [config] workspace: 5500
[2023-07-28 18:41:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 18:41:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 18:41:43] [training] Using single-device training
[2023-07-28 18:41:43] Synced seed 1234
[2023-07-28 18:41:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 18:41:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 18:41:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 18:41:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 18:41:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 18:41:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 18:41:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 18:41:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 18:41:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 18:41:44] [comm] Using global sharding
[2023-07-28 18:41:45] [comm] NCCLCommunicators constructed successfully
[2023-07-28 18:41:45] [training] Using 1 GPUs
[2023-07-28 18:41:45] [logits] Applying loss function for 1 factor(s)
[2023-07-28 18:41:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 18:41:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 18:41:45] [memory] Reserving 80 MB, device gpu0
[2023-07-28 19:27:06] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 19:27:06] [valid] No post-processing script given for validating translator
[2023-07-28 19:27:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 19:27:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 19:27:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 19:27:06] [comm] Using global sharding
[2023-07-28 19:27:06] [comm] NCCLCommunicators constructed successfully
[2023-07-28 19:27:06] [training] Using 1 GPUs
[2023-07-28 19:27:06] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 19:27:14] Allocating memory for general optimizer shards
[2023-07-28 19:27:14] [memory] Reserving 322 MB, device gpu0
[2023-07-28 19:27:14] Loading Adam parameters
[2023-07-28 19:27:14] [memory] Reserving 322 MB, device gpu0
[2023-07-28 19:27:14] [memory] Reserving 80 MB, device gpu0
[2023-07-28 19:27:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 19:27:15] [data] Restoring the corpus state to epoch 281, batch 10858
[2023-07-28 19:27:15] [data] Shuffling data
[2023-07-28 19:27:15] [data] Done reading 20,192 sentences
[2023-07-28 19:27:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:27:15] Training started
[2023-07-28 19:27:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 19:27:15] [memory] Reserving 80 MB, device gpu0
[2023-07-28 19:27:18] Parameter type float16, optimization type float32, casting types true
[2023-07-28 19:31:01] Seen 20,192 samples
[2023-07-28 19:31:01] Starting data epoch 282 in logical epoch 282
[2023-07-28 19:31:01] [data] Shuffling data
[2023-07-28 19:31:01] [data] Done reading 20,192 sentences
[2023-07-28 19:31:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:34:55] Seen 20,192 samples
[2023-07-28 19:34:55] Starting data epoch 283 in logical epoch 283
[2023-07-28 19:34:55] [data] Shuffling data
[2023-07-28 19:34:55] [data] Done reading 20,192 sentences
[2023-07-28 19:34:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:38:45] Seen 20,192 samples
[2023-07-28 19:38:45] Starting data epoch 284 in logical epoch 284
[2023-07-28 19:38:45] [data] Shuffling data
[2023-07-28 19:38:45] [data] Done reading 20,192 sentences
[2023-07-28 19:38:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:41:05] Ep. 284 : Up. 11000 : Sen. 12,800 : Cost 1.56755519 * 15,979,197 @ 3,423 after 175,984,437 : Time 839.08s : 19043.66 words/s : gNorm 1.9673
[2023-07-28 19:42:32] Seen 20,192 samples
[2023-07-28 19:42:32] Starting data epoch 285 in logical epoch 285
[2023-07-28 19:42:32] [data] Shuffling data
[2023-07-28 19:42:32] [data] Done reading 20,192 sentences
[2023-07-28 19:42:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:46:23] Seen 20,192 samples
[2023-07-28 19:46:23] Starting data epoch 286 in logical epoch 286
[2023-07-28 19:46:23] [data] Shuffling data
[2023-07-28 19:46:23] [data] Done reading 20,192 sentences
[2023-07-28 19:46:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:50:09] Seen 20,192 samples
[2023-07-28 19:50:09] Starting data epoch 287 in logical epoch 287
[2023-07-28 19:50:09] [data] Shuffling data
[2023-07-28 19:50:09] [data] Done reading 20,192 sentences
[2023-07-28 19:50:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:53:50] Seen 20,192 samples
[2023-07-28 19:53:50] Starting data epoch 288 in logical epoch 288
[2023-07-28 19:53:50] [data] Shuffling data
[2023-07-28 19:53:50] [data] Done reading 20,192 sentences
[2023-07-28 19:53:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 19:57:40] Seen 20,192 samples
[2023-07-28 19:57:40] Starting data epoch 289 in logical epoch 289
[2023-07-28 19:57:40] [data] Shuffling data
[2023-07-28 19:57:40] [data] Done reading 20,192 sentences
[2023-07-28 19:57:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 20:01:19] Seen 20,192 samples
[2023-07-28 20:01:19] Starting data epoch 290 in logical epoch 290
[2023-07-28 20:01:19] [data] Shuffling data
[2023-07-28 20:01:20] [data] Done reading 20,192 sentences
[2023-07-28 20:01:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 20:05:09] Seen 20,192 samples
[2023-07-28 20:05:09] Starting data epoch 291 in logical epoch 291
[2023-07-28 20:05:09] Training finished
[2023-07-28 20:07:11] [valid] Ep. 291 : Up. 11248 : translation : 0 : new best
[2023-07-28 20:07:11] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 20:07:16] Saving Adam parameters
[2023-07-28 20:07:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 20:07:25] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 20:07:25] [marian] Running on node18.datos.cluster.uy as process 23291 with command line:
[2023-07-28 20:07:25] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 300 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 20:07:25] [config] after: 0e
[2023-07-28 20:07:25] [config] after-batches: 0
[2023-07-28 20:07:25] [config] after-epochs: 300
[2023-07-28 20:07:25] [config] all-caps-every: 0
[2023-07-28 20:07:25] [config] allow-unk: false
[2023-07-28 20:07:25] [config] authors: false
[2023-07-28 20:07:25] [config] beam-size: 12
[2023-07-28 20:07:25] [config] bert-class-symbol: "[CLS]"
[2023-07-28 20:07:25] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 20:07:25] [config] bert-masking-fraction: 0.15
[2023-07-28 20:07:25] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 20:07:25] [config] bert-train-type-embeddings: true
[2023-07-28 20:07:25] [config] bert-type-vocab-size: 2
[2023-07-28 20:07:25] [config] build-info: ""
[2023-07-28 20:07:25] [config] check-gradient-nan: false
[2023-07-28 20:07:25] [config] check-nan: false
[2023-07-28 20:07:25] [config] cite: false
[2023-07-28 20:07:25] [config] clip-norm: 1
[2023-07-28 20:07:25] [config] cost-scaling:
[2023-07-28 20:07:25] [config]   - 256.f
[2023-07-28 20:07:25] [config]   - 1000
[2023-07-28 20:07:25] [config]   - 2.f
[2023-07-28 20:07:25] [config]   - 256.f
[2023-07-28 20:07:25] [config] cost-type: ce-sum
[2023-07-28 20:07:25] [config] cpu-threads: 0
[2023-07-28 20:07:25] [config] data-threads: 8
[2023-07-28 20:07:25] [config] data-weighting: ""
[2023-07-28 20:07:25] [config] data-weighting-type: sentence
[2023-07-28 20:07:25] [config] dec-cell: gru
[2023-07-28 20:07:25] [config] dec-cell-base-depth: 2
[2023-07-28 20:07:25] [config] dec-cell-high-depth: 1
[2023-07-28 20:07:25] [config] dec-depth: 1
[2023-07-28 20:07:25] [config] devices:
[2023-07-28 20:07:25] [config]   - 0
[2023-07-28 20:07:25] [config] dim-emb: 512
[2023-07-28 20:07:25] [config] dim-rnn: 1024
[2023-07-28 20:07:25] [config] dim-vocabs:
[2023-07-28 20:07:25] [config]   - 16384
[2023-07-28 20:07:25] [config]   - 16384
[2023-07-28 20:07:25] [config] disp-first: 0
[2023-07-28 20:07:25] [config] disp-freq: 1000u
[2023-07-28 20:07:25] [config] disp-label-counts: true
[2023-07-28 20:07:25] [config] dropout-rnn: 0
[2023-07-28 20:07:25] [config] dropout-src: 0
[2023-07-28 20:07:25] [config] dropout-trg: 0
[2023-07-28 20:07:25] [config] dump-config: ""
[2023-07-28 20:07:25] [config] dynamic-gradient-scaling:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] early-stopping: 1000
[2023-07-28 20:07:25] [config] early-stopping-on: first
[2023-07-28 20:07:25] [config] embedding-fix-src: false
[2023-07-28 20:07:25] [config] embedding-fix-trg: false
[2023-07-28 20:07:25] [config] embedding-normalization: false
[2023-07-28 20:07:25] [config] embedding-vectors:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] enc-cell: gru
[2023-07-28 20:07:25] [config] enc-cell-depth: 1
[2023-07-28 20:07:25] [config] enc-depth: 1
[2023-07-28 20:07:25] [config] enc-type: bidirectional
[2023-07-28 20:07:25] [config] english-title-case-every: 0
[2023-07-28 20:07:25] [config] exponential-smoothing: 0
[2023-07-28 20:07:25] [config] factor-weight: 1
[2023-07-28 20:07:25] [config] factors-combine: sum
[2023-07-28 20:07:25] [config] factors-dim-emb: 0
[2023-07-28 20:07:25] [config] gradient-checkpointing: false
[2023-07-28 20:07:25] [config] gradient-norm-average-window: 100
[2023-07-28 20:07:25] [config] guided-alignment: none
[2023-07-28 20:07:25] [config] guided-alignment-cost: mse
[2023-07-28 20:07:25] [config] guided-alignment-weight: 0.1
[2023-07-28 20:07:25] [config] ignore-model-config: false
[2023-07-28 20:07:25] [config] input-types:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] interpolate-env-vars: false
[2023-07-28 20:07:25] [config] keep-best: false
[2023-07-28 20:07:25] [config] label-smoothing: 0
[2023-07-28 20:07:25] [config] layer-normalization: false
[2023-07-28 20:07:25] [config] learn-rate: 0.0001
[2023-07-28 20:07:25] [config] lemma-dependency: ""
[2023-07-28 20:07:25] [config] lemma-dim-emb: 0
[2023-07-28 20:07:25] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 20:07:25] [config] log-level: info
[2023-07-28 20:07:25] [config] log-time-zone: ""
[2023-07-28 20:07:25] [config] logical-epoch:
[2023-07-28 20:07:25] [config]   - 1e
[2023-07-28 20:07:25] [config]   - 0
[2023-07-28 20:07:25] [config] lr-decay: 0
[2023-07-28 20:07:25] [config] lr-decay-freq: 50000
[2023-07-28 20:07:25] [config] lr-decay-inv-sqrt:
[2023-07-28 20:07:25] [config]   - 0
[2023-07-28 20:07:25] [config] lr-decay-repeat-warmup: false
[2023-07-28 20:07:25] [config] lr-decay-reset-optimizer: false
[2023-07-28 20:07:25] [config] lr-decay-start:
[2023-07-28 20:07:25] [config]   - 10
[2023-07-28 20:07:25] [config]   - 1
[2023-07-28 20:07:25] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 20:07:25] [config] lr-report: false
[2023-07-28 20:07:25] [config] lr-warmup: 0
[2023-07-28 20:07:25] [config] lr-warmup-at-reload: false
[2023-07-28 20:07:25] [config] lr-warmup-cycle: false
[2023-07-28 20:07:25] [config] lr-warmup-start-rate: 0
[2023-07-28 20:07:25] [config] max-length: 250
[2023-07-28 20:07:25] [config] max-length-crop: true
[2023-07-28 20:07:25] [config] max-length-factor: 3
[2023-07-28 20:07:25] [config] maxi-batch: 100
[2023-07-28 20:07:25] [config] maxi-batch-sort: trg
[2023-07-28 20:07:25] [config] mini-batch: 64
[2023-07-28 20:07:25] [config] mini-batch-fit: true
[2023-07-28 20:07:25] [config] mini-batch-fit-step: 10
[2023-07-28 20:07:25] [config] mini-batch-round-up: true
[2023-07-28 20:07:25] [config] mini-batch-track-lr: false
[2023-07-28 20:07:25] [config] mini-batch-warmup: 0
[2023-07-28 20:07:25] [config] mini-batch-words: 0
[2023-07-28 20:07:25] [config] mini-batch-words-ref: 0
[2023-07-28 20:07:25] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 20:07:25] [config] multi-loss-type: sum
[2023-07-28 20:07:25] [config] n-best: false
[2023-07-28 20:07:25] [config] no-nccl: false
[2023-07-28 20:07:25] [config] no-reload: false
[2023-07-28 20:07:25] [config] no-restore-corpus: false
[2023-07-28 20:07:25] [config] normalize: 0
[2023-07-28 20:07:25] [config] normalize-gradient: false
[2023-07-28 20:07:25] [config] num-devices: 0
[2023-07-28 20:07:25] [config] optimizer: adam
[2023-07-28 20:07:25] [config] optimizer-delay: 1
[2023-07-28 20:07:25] [config] optimizer-params:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] output-omit-bias: false
[2023-07-28 20:07:25] [config] overwrite: true
[2023-07-28 20:07:25] [config] precision:
[2023-07-28 20:07:25] [config]   - float16
[2023-07-28 20:07:25] [config]   - float32
[2023-07-28 20:07:25] [config] pretrained-model: ""
[2023-07-28 20:07:25] [config] quantize-biases: false
[2023-07-28 20:07:25] [config] quantize-bits: 0
[2023-07-28 20:07:25] [config] quantize-log-based: false
[2023-07-28 20:07:25] [config] quantize-optimization-steps: 0
[2023-07-28 20:07:25] [config] quiet: false
[2023-07-28 20:07:25] [config] quiet-translation: true
[2023-07-28 20:07:25] [config] relative-paths: false
[2023-07-28 20:07:25] [config] right-left: false
[2023-07-28 20:07:25] [config] save-freq: 10000u
[2023-07-28 20:07:25] [config] seed: 1234
[2023-07-28 20:07:25] [config] sentencepiece-alphas:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] sentencepiece-max-lines: 2000000
[2023-07-28 20:07:25] [config] sentencepiece-options: ""
[2023-07-28 20:07:25] [config] sharding: global
[2023-07-28 20:07:25] [config] shuffle: data
[2023-07-28 20:07:25] [config] shuffle-in-ram: false
[2023-07-28 20:07:25] [config] sigterm: save-and-exit
[2023-07-28 20:07:25] [config] skip: false
[2023-07-28 20:07:25] [config] sqlite: ""
[2023-07-28 20:07:25] [config] sqlite-drop: false
[2023-07-28 20:07:25] [config] sync-freq: 200u
[2023-07-28 20:07:25] [config] sync-sgd: false
[2023-07-28 20:07:25] [config] tempdir: /tmp
[2023-07-28 20:07:25] [config] tied-embeddings: false
[2023-07-28 20:07:25] [config] tied-embeddings-all: true
[2023-07-28 20:07:25] [config] tied-embeddings-src: false
[2023-07-28 20:07:25] [config] train-embedder-rank:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] train-sets:
[2023-07-28 20:07:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 20:07:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 20:07:25] [config] transformer-aan-activation: swish
[2023-07-28 20:07:25] [config] transformer-aan-depth: 2
[2023-07-28 20:07:25] [config] transformer-aan-nogate: false
[2023-07-28 20:07:25] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 20:07:25] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 20:07:25] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 20:07:25] [config] transformer-depth-scaling: false
[2023-07-28 20:07:25] [config] transformer-dim-aan: 2048
[2023-07-28 20:07:25] [config] transformer-dim-ffn: 2048
[2023-07-28 20:07:25] [config] transformer-dropout: 0
[2023-07-28 20:07:25] [config] transformer-dropout-attention: 0
[2023-07-28 20:07:25] [config] transformer-dropout-ffn: 0
[2023-07-28 20:07:25] [config] transformer-ffn-activation: swish
[2023-07-28 20:07:25] [config] transformer-ffn-depth: 2
[2023-07-28 20:07:25] [config] transformer-guided-alignment-layer: last
[2023-07-28 20:07:25] [config] transformer-heads: 8
[2023-07-28 20:07:25] [config] transformer-no-projection: false
[2023-07-28 20:07:25] [config] transformer-pool: false
[2023-07-28 20:07:25] [config] transformer-postprocess: dan
[2023-07-28 20:07:25] [config] transformer-postprocess-emb: d
[2023-07-28 20:07:25] [config] transformer-postprocess-top: ""
[2023-07-28 20:07:25] [config] transformer-preprocess: ""
[2023-07-28 20:07:25] [config] transformer-tied-layers:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] transformer-train-position-embeddings: false
[2023-07-28 20:07:25] [config] tsv: false
[2023-07-28 20:07:25] [config] tsv-fields: 0
[2023-07-28 20:07:25] [config] type: s2s
[2023-07-28 20:07:25] [config] ulr: false
[2023-07-28 20:07:25] [config] ulr-dim-emb: 0
[2023-07-28 20:07:25] [config] ulr-dropout: 0
[2023-07-28 20:07:25] [config] ulr-keys-vectors: ""
[2023-07-28 20:07:25] [config] ulr-query-vectors: ""
[2023-07-28 20:07:25] [config] ulr-softmax-temperature: 1
[2023-07-28 20:07:25] [config] ulr-trainable-transformation: false
[2023-07-28 20:07:25] [config] unlikelihood-loss: false
[2023-07-28 20:07:25] [config] valid-freq: 50000000
[2023-07-28 20:07:25] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 20:07:25] [config] valid-max-length: 1000
[2023-07-28 20:07:25] [config] valid-metrics:
[2023-07-28 20:07:25] [config]   - translation
[2023-07-28 20:07:25] [config] valid-mini-batch: 32
[2023-07-28 20:07:25] [config] valid-reset-stalled: false
[2023-07-28 20:07:25] [config] valid-script-args:
[2023-07-28 20:07:25] [config]   []
[2023-07-28 20:07:25] [config] valid-script-path: ""
[2023-07-28 20:07:25] [config] valid-sets:
[2023-07-28 20:07:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 20:07:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 20:07:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 20:07:25] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 20:07:25] [config] vocabs:
[2023-07-28 20:07:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 20:07:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 20:07:25] [config] word-penalty: 0
[2023-07-28 20:07:25] [config] word-scores: false
[2023-07-28 20:07:25] [config] workspace: 5500
[2023-07-28 20:07:25] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 20:07:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 20:07:25] [training] Using single-device training
[2023-07-28 20:07:25] Synced seed 1234
[2023-07-28 20:07:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 20:07:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 20:07:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 20:07:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 20:07:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 20:07:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 20:07:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 20:07:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 20:07:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 20:07:26] [comm] Using global sharding
[2023-07-28 20:07:26] [comm] NCCLCommunicators constructed successfully
[2023-07-28 20:07:26] [training] Using 1 GPUs
[2023-07-28 20:07:26] [logits] Applying loss function for 1 factor(s)
[2023-07-28 20:07:26] [memory] Reserving 80 MB, device gpu0
[2023-07-28 20:07:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 20:07:27] [memory] Reserving 80 MB, device gpu0
[2023-07-28 20:51:10] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 20:51:10] [valid] No post-processing script given for validating translator
[2023-07-28 20:51:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 20:51:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 20:51:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 20:51:10] [comm] Using global sharding
[2023-07-28 20:51:10] [comm] NCCLCommunicators constructed successfully
[2023-07-28 20:51:10] [training] Using 1 GPUs
[2023-07-28 20:51:11] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 20:51:18] Allocating memory for general optimizer shards
[2023-07-28 20:51:18] [memory] Reserving 322 MB, device gpu0
[2023-07-28 20:51:18] Loading Adam parameters
[2023-07-28 20:51:18] [memory] Reserving 322 MB, device gpu0
[2023-07-28 20:51:18] [memory] Reserving 80 MB, device gpu0
[2023-07-28 20:51:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 20:51:19] [data] Restoring the corpus state to epoch 291, batch 11248
[2023-07-28 20:51:19] [data] Shuffling data
[2023-07-28 20:51:19] [data] Done reading 20,192 sentences
[2023-07-28 20:51:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 20:51:19] Training started
[2023-07-28 20:51:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 20:51:19] [memory] Reserving 80 MB, device gpu0
[2023-07-28 20:51:22] Parameter type float16, optimization type float32, casting types true
[2023-07-28 20:55:16] Seen 20,192 samples
[2023-07-28 20:55:16] Starting data epoch 292 in logical epoch 292
[2023-07-28 20:55:16] [data] Shuffling data
[2023-07-28 20:55:16] [data] Done reading 20,192 sentences
[2023-07-28 20:55:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 20:59:33] Seen 20,192 samples
[2023-07-28 20:59:33] Starting data epoch 293 in logical epoch 293
[2023-07-28 20:59:33] [data] Shuffling data
[2023-07-28 20:59:33] [data] Done reading 20,192 sentences
[2023-07-28 20:59:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:03:55] Seen 20,192 samples
[2023-07-28 21:03:55] Starting data epoch 294 in logical epoch 294
[2023-07-28 21:03:55] [data] Shuffling data
[2023-07-28 21:03:55] [data] Done reading 20,192 sentences
[2023-07-28 21:03:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:08:17] Seen 20,192 samples
[2023-07-28 21:08:17] Starting data epoch 295 in logical epoch 295
[2023-07-28 21:08:17] [data] Shuffling data
[2023-07-28 21:08:17] [data] Done reading 20,192 sentences
[2023-07-28 21:08:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:12:37] Seen 20,192 samples
[2023-07-28 21:12:37] Starting data epoch 296 in logical epoch 296
[2023-07-28 21:12:37] [data] Shuffling data
[2023-07-28 21:12:37] [data] Done reading 20,192 sentences
[2023-07-28 21:12:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:16:53] Seen 20,192 samples
[2023-07-28 21:16:53] Starting data epoch 297 in logical epoch 297
[2023-07-28 21:16:53] [data] Shuffling data
[2023-07-28 21:16:53] [data] Done reading 20,192 sentences
[2023-07-28 21:16:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:21:08] Seen 20,192 samples
[2023-07-28 21:21:08] Starting data epoch 298 in logical epoch 298
[2023-07-28 21:21:08] [data] Shuffling data
[2023-07-28 21:21:08] [data] Done reading 20,192 sentences
[2023-07-28 21:21:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:25:18] Seen 20,192 samples
[2023-07-28 21:25:18] Starting data epoch 299 in logical epoch 299
[2023-07-28 21:25:18] [data] Shuffling data
[2023-07-28 21:25:19] [data] Done reading 20,192 sentences
[2023-07-28 21:25:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:29:39] Seen 20,192 samples
[2023-07-28 21:29:39] Starting data epoch 300 in logical epoch 300
[2023-07-28 21:29:39] [data] Shuffling data
[2023-07-28 21:29:39] [data] Done reading 20,192 sentences
[2023-07-28 21:29:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 21:34:18] Seen 20,192 samples
[2023-07-28 21:34:18] Starting data epoch 301 in logical epoch 301
[2023-07-28 21:34:18] Training finished
[2023-07-28 21:36:25] [valid] Ep. 301 : Up. 11635 : translation : 0 : new best
[2023-07-28 21:36:25] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 21:36:29] Saving Adam parameters
[2023-07-28 21:36:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 21:36:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 21:36:38] [marian] Running on node18.datos.cluster.uy as process 29149 with command line:
[2023-07-28 21:36:38] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 310 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 21:36:38] [config] after: 0e
[2023-07-28 21:36:38] [config] after-batches: 0
[2023-07-28 21:36:38] [config] after-epochs: 310
[2023-07-28 21:36:38] [config] all-caps-every: 0
[2023-07-28 21:36:38] [config] allow-unk: false
[2023-07-28 21:36:38] [config] authors: false
[2023-07-28 21:36:38] [config] beam-size: 12
[2023-07-28 21:36:38] [config] bert-class-symbol: "[CLS]"
[2023-07-28 21:36:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 21:36:38] [config] bert-masking-fraction: 0.15
[2023-07-28 21:36:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 21:36:38] [config] bert-train-type-embeddings: true
[2023-07-28 21:36:38] [config] bert-type-vocab-size: 2
[2023-07-28 21:36:38] [config] build-info: ""
[2023-07-28 21:36:38] [config] check-gradient-nan: false
[2023-07-28 21:36:38] [config] check-nan: false
[2023-07-28 21:36:38] [config] cite: false
[2023-07-28 21:36:38] [config] clip-norm: 1
[2023-07-28 21:36:38] [config] cost-scaling:
[2023-07-28 21:36:38] [config]   - 256.f
[2023-07-28 21:36:38] [config]   - 1000
[2023-07-28 21:36:38] [config]   - 2.f
[2023-07-28 21:36:38] [config]   - 256.f
[2023-07-28 21:36:38] [config] cost-type: ce-sum
[2023-07-28 21:36:38] [config] cpu-threads: 0
[2023-07-28 21:36:38] [config] data-threads: 8
[2023-07-28 21:36:38] [config] data-weighting: ""
[2023-07-28 21:36:38] [config] data-weighting-type: sentence
[2023-07-28 21:36:38] [config] dec-cell: gru
[2023-07-28 21:36:38] [config] dec-cell-base-depth: 2
[2023-07-28 21:36:38] [config] dec-cell-high-depth: 1
[2023-07-28 21:36:38] [config] dec-depth: 1
[2023-07-28 21:36:38] [config] devices:
[2023-07-28 21:36:38] [config]   - 0
[2023-07-28 21:36:38] [config] dim-emb: 512
[2023-07-28 21:36:38] [config] dim-rnn: 1024
[2023-07-28 21:36:38] [config] dim-vocabs:
[2023-07-28 21:36:38] [config]   - 16384
[2023-07-28 21:36:38] [config]   - 16384
[2023-07-28 21:36:38] [config] disp-first: 0
[2023-07-28 21:36:38] [config] disp-freq: 1000u
[2023-07-28 21:36:38] [config] disp-label-counts: true
[2023-07-28 21:36:38] [config] dropout-rnn: 0
[2023-07-28 21:36:38] [config] dropout-src: 0
[2023-07-28 21:36:38] [config] dropout-trg: 0
[2023-07-28 21:36:38] [config] dump-config: ""
[2023-07-28 21:36:38] [config] dynamic-gradient-scaling:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] early-stopping: 1000
[2023-07-28 21:36:38] [config] early-stopping-on: first
[2023-07-28 21:36:38] [config] embedding-fix-src: false
[2023-07-28 21:36:38] [config] embedding-fix-trg: false
[2023-07-28 21:36:38] [config] embedding-normalization: false
[2023-07-28 21:36:38] [config] embedding-vectors:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] enc-cell: gru
[2023-07-28 21:36:38] [config] enc-cell-depth: 1
[2023-07-28 21:36:38] [config] enc-depth: 1
[2023-07-28 21:36:38] [config] enc-type: bidirectional
[2023-07-28 21:36:38] [config] english-title-case-every: 0
[2023-07-28 21:36:38] [config] exponential-smoothing: 0
[2023-07-28 21:36:38] [config] factor-weight: 1
[2023-07-28 21:36:38] [config] factors-combine: sum
[2023-07-28 21:36:38] [config] factors-dim-emb: 0
[2023-07-28 21:36:38] [config] gradient-checkpointing: false
[2023-07-28 21:36:38] [config] gradient-norm-average-window: 100
[2023-07-28 21:36:38] [config] guided-alignment: none
[2023-07-28 21:36:38] [config] guided-alignment-cost: mse
[2023-07-28 21:36:38] [config] guided-alignment-weight: 0.1
[2023-07-28 21:36:38] [config] ignore-model-config: false
[2023-07-28 21:36:38] [config] input-types:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] interpolate-env-vars: false
[2023-07-28 21:36:38] [config] keep-best: false
[2023-07-28 21:36:38] [config] label-smoothing: 0
[2023-07-28 21:36:38] [config] layer-normalization: false
[2023-07-28 21:36:38] [config] learn-rate: 0.0001
[2023-07-28 21:36:38] [config] lemma-dependency: ""
[2023-07-28 21:36:38] [config] lemma-dim-emb: 0
[2023-07-28 21:36:38] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 21:36:38] [config] log-level: info
[2023-07-28 21:36:38] [config] log-time-zone: ""
[2023-07-28 21:36:38] [config] logical-epoch:
[2023-07-28 21:36:38] [config]   - 1e
[2023-07-28 21:36:38] [config]   - 0
[2023-07-28 21:36:38] [config] lr-decay: 0
[2023-07-28 21:36:38] [config] lr-decay-freq: 50000
[2023-07-28 21:36:38] [config] lr-decay-inv-sqrt:
[2023-07-28 21:36:38] [config]   - 0
[2023-07-28 21:36:38] [config] lr-decay-repeat-warmup: false
[2023-07-28 21:36:38] [config] lr-decay-reset-optimizer: false
[2023-07-28 21:36:38] [config] lr-decay-start:
[2023-07-28 21:36:38] [config]   - 10
[2023-07-28 21:36:38] [config]   - 1
[2023-07-28 21:36:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 21:36:38] [config] lr-report: false
[2023-07-28 21:36:38] [config] lr-warmup: 0
[2023-07-28 21:36:38] [config] lr-warmup-at-reload: false
[2023-07-28 21:36:38] [config] lr-warmup-cycle: false
[2023-07-28 21:36:38] [config] lr-warmup-start-rate: 0
[2023-07-28 21:36:38] [config] max-length: 250
[2023-07-28 21:36:38] [config] max-length-crop: true
[2023-07-28 21:36:38] [config] max-length-factor: 3
[2023-07-28 21:36:38] [config] maxi-batch: 100
[2023-07-28 21:36:38] [config] maxi-batch-sort: trg
[2023-07-28 21:36:38] [config] mini-batch: 64
[2023-07-28 21:36:38] [config] mini-batch-fit: true
[2023-07-28 21:36:38] [config] mini-batch-fit-step: 10
[2023-07-28 21:36:38] [config] mini-batch-round-up: true
[2023-07-28 21:36:38] [config] mini-batch-track-lr: false
[2023-07-28 21:36:38] [config] mini-batch-warmup: 0
[2023-07-28 21:36:38] [config] mini-batch-words: 0
[2023-07-28 21:36:38] [config] mini-batch-words-ref: 0
[2023-07-28 21:36:38] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 21:36:38] [config] multi-loss-type: sum
[2023-07-28 21:36:38] [config] n-best: false
[2023-07-28 21:36:38] [config] no-nccl: false
[2023-07-28 21:36:38] [config] no-reload: false
[2023-07-28 21:36:38] [config] no-restore-corpus: false
[2023-07-28 21:36:38] [config] normalize: 0
[2023-07-28 21:36:38] [config] normalize-gradient: false
[2023-07-28 21:36:38] [config] num-devices: 0
[2023-07-28 21:36:38] [config] optimizer: adam
[2023-07-28 21:36:38] [config] optimizer-delay: 1
[2023-07-28 21:36:38] [config] optimizer-params:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] output-omit-bias: false
[2023-07-28 21:36:38] [config] overwrite: true
[2023-07-28 21:36:38] [config] precision:
[2023-07-28 21:36:38] [config]   - float16
[2023-07-28 21:36:38] [config]   - float32
[2023-07-28 21:36:38] [config] pretrained-model: ""
[2023-07-28 21:36:38] [config] quantize-biases: false
[2023-07-28 21:36:38] [config] quantize-bits: 0
[2023-07-28 21:36:38] [config] quantize-log-based: false
[2023-07-28 21:36:38] [config] quantize-optimization-steps: 0
[2023-07-28 21:36:38] [config] quiet: false
[2023-07-28 21:36:38] [config] quiet-translation: true
[2023-07-28 21:36:38] [config] relative-paths: false
[2023-07-28 21:36:38] [config] right-left: false
[2023-07-28 21:36:38] [config] save-freq: 10000u
[2023-07-28 21:36:38] [config] seed: 1234
[2023-07-28 21:36:38] [config] sentencepiece-alphas:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] sentencepiece-max-lines: 2000000
[2023-07-28 21:36:38] [config] sentencepiece-options: ""
[2023-07-28 21:36:38] [config] sharding: global
[2023-07-28 21:36:38] [config] shuffle: data
[2023-07-28 21:36:38] [config] shuffle-in-ram: false
[2023-07-28 21:36:38] [config] sigterm: save-and-exit
[2023-07-28 21:36:38] [config] skip: false
[2023-07-28 21:36:38] [config] sqlite: ""
[2023-07-28 21:36:38] [config] sqlite-drop: false
[2023-07-28 21:36:38] [config] sync-freq: 200u
[2023-07-28 21:36:38] [config] sync-sgd: false
[2023-07-28 21:36:38] [config] tempdir: /tmp
[2023-07-28 21:36:38] [config] tied-embeddings: false
[2023-07-28 21:36:38] [config] tied-embeddings-all: true
[2023-07-28 21:36:38] [config] tied-embeddings-src: false
[2023-07-28 21:36:38] [config] train-embedder-rank:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] train-sets:
[2023-07-28 21:36:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 21:36:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 21:36:38] [config] transformer-aan-activation: swish
[2023-07-28 21:36:38] [config] transformer-aan-depth: 2
[2023-07-28 21:36:38] [config] transformer-aan-nogate: false
[2023-07-28 21:36:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 21:36:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 21:36:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 21:36:38] [config] transformer-depth-scaling: false
[2023-07-28 21:36:38] [config] transformer-dim-aan: 2048
[2023-07-28 21:36:38] [config] transformer-dim-ffn: 2048
[2023-07-28 21:36:38] [config] transformer-dropout: 0
[2023-07-28 21:36:38] [config] transformer-dropout-attention: 0
[2023-07-28 21:36:38] [config] transformer-dropout-ffn: 0
[2023-07-28 21:36:38] [config] transformer-ffn-activation: swish
[2023-07-28 21:36:38] [config] transformer-ffn-depth: 2
[2023-07-28 21:36:38] [config] transformer-guided-alignment-layer: last
[2023-07-28 21:36:38] [config] transformer-heads: 8
[2023-07-28 21:36:38] [config] transformer-no-projection: false
[2023-07-28 21:36:38] [config] transformer-pool: false
[2023-07-28 21:36:38] [config] transformer-postprocess: dan
[2023-07-28 21:36:38] [config] transformer-postprocess-emb: d
[2023-07-28 21:36:38] [config] transformer-postprocess-top: ""
[2023-07-28 21:36:38] [config] transformer-preprocess: ""
[2023-07-28 21:36:38] [config] transformer-tied-layers:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] transformer-train-position-embeddings: false
[2023-07-28 21:36:38] [config] tsv: false
[2023-07-28 21:36:38] [config] tsv-fields: 0
[2023-07-28 21:36:38] [config] type: s2s
[2023-07-28 21:36:38] [config] ulr: false
[2023-07-28 21:36:38] [config] ulr-dim-emb: 0
[2023-07-28 21:36:38] [config] ulr-dropout: 0
[2023-07-28 21:36:38] [config] ulr-keys-vectors: ""
[2023-07-28 21:36:38] [config] ulr-query-vectors: ""
[2023-07-28 21:36:38] [config] ulr-softmax-temperature: 1
[2023-07-28 21:36:38] [config] ulr-trainable-transformation: false
[2023-07-28 21:36:38] [config] unlikelihood-loss: false
[2023-07-28 21:36:38] [config] valid-freq: 50000000
[2023-07-28 21:36:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 21:36:38] [config] valid-max-length: 1000
[2023-07-28 21:36:38] [config] valid-metrics:
[2023-07-28 21:36:38] [config]   - translation
[2023-07-28 21:36:38] [config] valid-mini-batch: 32
[2023-07-28 21:36:38] [config] valid-reset-stalled: false
[2023-07-28 21:36:38] [config] valid-script-args:
[2023-07-28 21:36:38] [config]   []
[2023-07-28 21:36:38] [config] valid-script-path: ""
[2023-07-28 21:36:38] [config] valid-sets:
[2023-07-28 21:36:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 21:36:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 21:36:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 21:36:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 21:36:38] [config] vocabs:
[2023-07-28 21:36:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 21:36:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 21:36:38] [config] word-penalty: 0
[2023-07-28 21:36:38] [config] word-scores: false
[2023-07-28 21:36:38] [config] workspace: 5500
[2023-07-28 21:36:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 21:36:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 21:36:38] [training] Using single-device training
[2023-07-28 21:36:38] Synced seed 1234
[2023-07-28 21:36:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 21:36:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 21:36:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 21:36:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 21:36:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 21:36:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 21:36:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 21:36:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 21:36:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 21:36:39] [comm] Using global sharding
[2023-07-28 21:36:39] [comm] NCCLCommunicators constructed successfully
[2023-07-28 21:36:39] [training] Using 1 GPUs
[2023-07-28 21:36:39] [logits] Applying loss function for 1 factor(s)
[2023-07-28 21:36:39] [memory] Reserving 80 MB, device gpu0
[2023-07-28 21:36:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 21:36:40] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:26:06] [batching] Done. Typical MB size is 35,869 target words
[2023-07-28 22:26:06] [valid] No post-processing script given for validating translator
[2023-07-28 22:26:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 22:26:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 22:26:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 22:26:06] [comm] Using global sharding
[2023-07-28 22:26:06] [comm] NCCLCommunicators constructed successfully
[2023-07-28 22:26:06] [training] Using 1 GPUs
[2023-07-28 22:26:06] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 22:26:07] Allocating memory for general optimizer shards
[2023-07-28 22:26:07] [memory] Reserving 322 MB, device gpu0
[2023-07-28 22:26:07] Loading Adam parameters
[2023-07-28 22:26:07] [memory] Reserving 322 MB, device gpu0
[2023-07-28 22:26:07] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:26:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 22:26:08] [data] Restoring the corpus state to epoch 301, batch 11635
[2023-07-28 22:26:08] [data] Shuffling data
[2023-07-28 22:26:08] [data] Done reading 20,192 sentences
[2023-07-28 22:26:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:26:08] Training started
[2023-07-28 22:26:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-28 22:26:09] [memory] Reserving 80 MB, device gpu0
[2023-07-28 22:26:12] Parameter type float16, optimization type float32, casting types true
[2023-07-28 22:30:45] Seen 20,192 samples
[2023-07-28 22:30:45] Starting data epoch 302 in logical epoch 302
[2023-07-28 22:30:45] [data] Shuffling data
[2023-07-28 22:30:45] [data] Done reading 20,192 sentences
[2023-07-28 22:30:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:35:24] Seen 20,192 samples
[2023-07-28 22:35:24] Starting data epoch 303 in logical epoch 303
[2023-07-28 22:35:24] [data] Shuffling data
[2023-07-28 22:35:24] [data] Done reading 20,192 sentences
[2023-07-28 22:35:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:40:05] Seen 20,192 samples
[2023-07-28 22:40:05] Starting data epoch 304 in logical epoch 304
[2023-07-28 22:40:05] [data] Shuffling data
[2023-07-28 22:40:05] [data] Done reading 20,192 sentences
[2023-07-28 22:40:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:44:37] Seen 20,192 samples
[2023-07-28 22:44:37] Starting data epoch 305 in logical epoch 305
[2023-07-28 22:44:37] [data] Shuffling data
[2023-07-28 22:44:37] [data] Done reading 20,192 sentences
[2023-07-28 22:44:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:49:15] Seen 20,192 samples
[2023-07-28 22:49:15] Starting data epoch 306 in logical epoch 306
[2023-07-28 22:49:15] [data] Shuffling data
[2023-07-28 22:49:15] [data] Done reading 20,192 sentences
[2023-07-28 22:49:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:53:54] Seen 20,192 samples
[2023-07-28 22:53:54] Starting data epoch 307 in logical epoch 307
[2023-07-28 22:53:54] [data] Shuffling data
[2023-07-28 22:53:54] [data] Done reading 20,192 sentences
[2023-07-28 22:53:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 22:58:29] Seen 20,192 samples
[2023-07-28 22:58:29] Starting data epoch 308 in logical epoch 308
[2023-07-28 22:58:29] [data] Shuffling data
[2023-07-28 22:58:29] [data] Done reading 20,192 sentences
[2023-07-28 22:58:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 23:03:07] Seen 20,192 samples
[2023-07-28 23:03:07] Starting data epoch 309 in logical epoch 309
[2023-07-28 23:03:07] [data] Shuffling data
[2023-07-28 23:03:07] [data] Done reading 20,192 sentences
[2023-07-28 23:03:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 23:07:46] Seen 20,192 samples
[2023-07-28 23:07:46] Starting data epoch 310 in logical epoch 310
[2023-07-28 23:07:46] [data] Shuffling data
[2023-07-28 23:07:46] [data] Done reading 20,192 sentences
[2023-07-28 23:07:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-28 23:09:10] Ep. 310 : Up. 12000 : Sen. 6,400 : Cost 1.30657828 * 15,934,907 @ 13,405 after 191,919,347 : Time 2584.70s : 6165.08 words/s : gNorm 1.9640
[2023-07-28 23:12:26] Seen 20,192 samples
[2023-07-28 23:12:26] Starting data epoch 311 in logical epoch 311
[2023-07-28 23:12:26] Training finished
[2023-07-28 23:14:29] [valid] Ep. 311 : Up. 12027 : translation : 0 : new best
[2023-07-28 23:14:29] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 23:14:32] Saving Adam parameters
[2023-07-28 23:14:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-28 23:14:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:14:41] [marian] Running on node18.datos.cluster.uy as process 35462 with command line:
[2023-07-28 23:14:41] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 320 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-28 23:14:41] [config] after: 0e
[2023-07-28 23:14:41] [config] after-batches: 0
[2023-07-28 23:14:41] [config] after-epochs: 320
[2023-07-28 23:14:41] [config] all-caps-every: 0
[2023-07-28 23:14:41] [config] allow-unk: false
[2023-07-28 23:14:41] [config] authors: false
[2023-07-28 23:14:41] [config] beam-size: 12
[2023-07-28 23:14:41] [config] bert-class-symbol: "[CLS]"
[2023-07-28 23:14:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-28 23:14:41] [config] bert-masking-fraction: 0.15
[2023-07-28 23:14:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-28 23:14:41] [config] bert-train-type-embeddings: true
[2023-07-28 23:14:41] [config] bert-type-vocab-size: 2
[2023-07-28 23:14:41] [config] build-info: ""
[2023-07-28 23:14:41] [config] check-gradient-nan: false
[2023-07-28 23:14:41] [config] check-nan: false
[2023-07-28 23:14:41] [config] cite: false
[2023-07-28 23:14:41] [config] clip-norm: 1
[2023-07-28 23:14:41] [config] cost-scaling:
[2023-07-28 23:14:41] [config]   - 256.f
[2023-07-28 23:14:41] [config]   - 1000
[2023-07-28 23:14:41] [config]   - 2.f
[2023-07-28 23:14:41] [config]   - 256.f
[2023-07-28 23:14:41] [config] cost-type: ce-sum
[2023-07-28 23:14:41] [config] cpu-threads: 0
[2023-07-28 23:14:41] [config] data-threads: 8
[2023-07-28 23:14:41] [config] data-weighting: ""
[2023-07-28 23:14:41] [config] data-weighting-type: sentence
[2023-07-28 23:14:41] [config] dec-cell: gru
[2023-07-28 23:14:41] [config] dec-cell-base-depth: 2
[2023-07-28 23:14:41] [config] dec-cell-high-depth: 1
[2023-07-28 23:14:41] [config] dec-depth: 1
[2023-07-28 23:14:41] [config] devices:
[2023-07-28 23:14:41] [config]   - 0
[2023-07-28 23:14:41] [config] dim-emb: 512
[2023-07-28 23:14:41] [config] dim-rnn: 1024
[2023-07-28 23:14:41] [config] dim-vocabs:
[2023-07-28 23:14:41] [config]   - 16384
[2023-07-28 23:14:41] [config]   - 16384
[2023-07-28 23:14:41] [config] disp-first: 0
[2023-07-28 23:14:41] [config] disp-freq: 1000u
[2023-07-28 23:14:41] [config] disp-label-counts: true
[2023-07-28 23:14:41] [config] dropout-rnn: 0
[2023-07-28 23:14:41] [config] dropout-src: 0
[2023-07-28 23:14:41] [config] dropout-trg: 0
[2023-07-28 23:14:41] [config] dump-config: ""
[2023-07-28 23:14:41] [config] dynamic-gradient-scaling:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] early-stopping: 1000
[2023-07-28 23:14:41] [config] early-stopping-on: first
[2023-07-28 23:14:41] [config] embedding-fix-src: false
[2023-07-28 23:14:41] [config] embedding-fix-trg: false
[2023-07-28 23:14:41] [config] embedding-normalization: false
[2023-07-28 23:14:41] [config] embedding-vectors:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] enc-cell: gru
[2023-07-28 23:14:41] [config] enc-cell-depth: 1
[2023-07-28 23:14:41] [config] enc-depth: 1
[2023-07-28 23:14:41] [config] enc-type: bidirectional
[2023-07-28 23:14:41] [config] english-title-case-every: 0
[2023-07-28 23:14:41] [config] exponential-smoothing: 0
[2023-07-28 23:14:41] [config] factor-weight: 1
[2023-07-28 23:14:41] [config] factors-combine: sum
[2023-07-28 23:14:41] [config] factors-dim-emb: 0
[2023-07-28 23:14:41] [config] gradient-checkpointing: false
[2023-07-28 23:14:41] [config] gradient-norm-average-window: 100
[2023-07-28 23:14:41] [config] guided-alignment: none
[2023-07-28 23:14:41] [config] guided-alignment-cost: mse
[2023-07-28 23:14:41] [config] guided-alignment-weight: 0.1
[2023-07-28 23:14:41] [config] ignore-model-config: false
[2023-07-28 23:14:41] [config] input-types:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] interpolate-env-vars: false
[2023-07-28 23:14:41] [config] keep-best: false
[2023-07-28 23:14:41] [config] label-smoothing: 0
[2023-07-28 23:14:41] [config] layer-normalization: false
[2023-07-28 23:14:41] [config] learn-rate: 0.0001
[2023-07-28 23:14:41] [config] lemma-dependency: ""
[2023-07-28 23:14:41] [config] lemma-dim-emb: 0
[2023-07-28 23:14:41] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 23:14:41] [config] log-level: info
[2023-07-28 23:14:41] [config] log-time-zone: ""
[2023-07-28 23:14:41] [config] logical-epoch:
[2023-07-28 23:14:41] [config]   - 1e
[2023-07-28 23:14:41] [config]   - 0
[2023-07-28 23:14:41] [config] lr-decay: 0
[2023-07-28 23:14:41] [config] lr-decay-freq: 50000
[2023-07-28 23:14:41] [config] lr-decay-inv-sqrt:
[2023-07-28 23:14:41] [config]   - 0
[2023-07-28 23:14:41] [config] lr-decay-repeat-warmup: false
[2023-07-28 23:14:41] [config] lr-decay-reset-optimizer: false
[2023-07-28 23:14:41] [config] lr-decay-start:
[2023-07-28 23:14:41] [config]   - 10
[2023-07-28 23:14:41] [config]   - 1
[2023-07-28 23:14:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-28 23:14:41] [config] lr-report: false
[2023-07-28 23:14:41] [config] lr-warmup: 0
[2023-07-28 23:14:41] [config] lr-warmup-at-reload: false
[2023-07-28 23:14:41] [config] lr-warmup-cycle: false
[2023-07-28 23:14:41] [config] lr-warmup-start-rate: 0
[2023-07-28 23:14:41] [config] max-length: 250
[2023-07-28 23:14:41] [config] max-length-crop: true
[2023-07-28 23:14:41] [config] max-length-factor: 3
[2023-07-28 23:14:41] [config] maxi-batch: 100
[2023-07-28 23:14:41] [config] maxi-batch-sort: trg
[2023-07-28 23:14:41] [config] mini-batch: 64
[2023-07-28 23:14:41] [config] mini-batch-fit: true
[2023-07-28 23:14:41] [config] mini-batch-fit-step: 10
[2023-07-28 23:14:41] [config] mini-batch-round-up: true
[2023-07-28 23:14:41] [config] mini-batch-track-lr: false
[2023-07-28 23:14:41] [config] mini-batch-warmup: 0
[2023-07-28 23:14:41] [config] mini-batch-words: 0
[2023-07-28 23:14:41] [config] mini-batch-words-ref: 0
[2023-07-28 23:14:41] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-28 23:14:41] [config] multi-loss-type: sum
[2023-07-28 23:14:41] [config] n-best: false
[2023-07-28 23:14:41] [config] no-nccl: false
[2023-07-28 23:14:41] [config] no-reload: false
[2023-07-28 23:14:41] [config] no-restore-corpus: false
[2023-07-28 23:14:41] [config] normalize: 0
[2023-07-28 23:14:41] [config] normalize-gradient: false
[2023-07-28 23:14:41] [config] num-devices: 0
[2023-07-28 23:14:41] [config] optimizer: adam
[2023-07-28 23:14:41] [config] optimizer-delay: 1
[2023-07-28 23:14:41] [config] optimizer-params:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] output-omit-bias: false
[2023-07-28 23:14:41] [config] overwrite: true
[2023-07-28 23:14:41] [config] precision:
[2023-07-28 23:14:41] [config]   - float16
[2023-07-28 23:14:41] [config]   - float32
[2023-07-28 23:14:41] [config] pretrained-model: ""
[2023-07-28 23:14:41] [config] quantize-biases: false
[2023-07-28 23:14:41] [config] quantize-bits: 0
[2023-07-28 23:14:41] [config] quantize-log-based: false
[2023-07-28 23:14:41] [config] quantize-optimization-steps: 0
[2023-07-28 23:14:41] [config] quiet: false
[2023-07-28 23:14:41] [config] quiet-translation: true
[2023-07-28 23:14:41] [config] relative-paths: false
[2023-07-28 23:14:41] [config] right-left: false
[2023-07-28 23:14:41] [config] save-freq: 10000u
[2023-07-28 23:14:41] [config] seed: 1234
[2023-07-28 23:14:41] [config] sentencepiece-alphas:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] sentencepiece-max-lines: 2000000
[2023-07-28 23:14:41] [config] sentencepiece-options: ""
[2023-07-28 23:14:41] [config] sharding: global
[2023-07-28 23:14:41] [config] shuffle: data
[2023-07-28 23:14:41] [config] shuffle-in-ram: false
[2023-07-28 23:14:41] [config] sigterm: save-and-exit
[2023-07-28 23:14:41] [config] skip: false
[2023-07-28 23:14:41] [config] sqlite: ""
[2023-07-28 23:14:41] [config] sqlite-drop: false
[2023-07-28 23:14:41] [config] sync-freq: 200u
[2023-07-28 23:14:41] [config] sync-sgd: false
[2023-07-28 23:14:41] [config] tempdir: /tmp
[2023-07-28 23:14:41] [config] tied-embeddings: false
[2023-07-28 23:14:41] [config] tied-embeddings-all: true
[2023-07-28 23:14:41] [config] tied-embeddings-src: false
[2023-07-28 23:14:41] [config] train-embedder-rank:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] train-sets:
[2023-07-28 23:14:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-28 23:14:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-28 23:14:41] [config] transformer-aan-activation: swish
[2023-07-28 23:14:41] [config] transformer-aan-depth: 2
[2023-07-28 23:14:41] [config] transformer-aan-nogate: false
[2023-07-28 23:14:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-28 23:14:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-28 23:14:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-28 23:14:41] [config] transformer-depth-scaling: false
[2023-07-28 23:14:41] [config] transformer-dim-aan: 2048
[2023-07-28 23:14:41] [config] transformer-dim-ffn: 2048
[2023-07-28 23:14:41] [config] transformer-dropout: 0
[2023-07-28 23:14:41] [config] transformer-dropout-attention: 0
[2023-07-28 23:14:41] [config] transformer-dropout-ffn: 0
[2023-07-28 23:14:41] [config] transformer-ffn-activation: swish
[2023-07-28 23:14:41] [config] transformer-ffn-depth: 2
[2023-07-28 23:14:41] [config] transformer-guided-alignment-layer: last
[2023-07-28 23:14:41] [config] transformer-heads: 8
[2023-07-28 23:14:41] [config] transformer-no-projection: false
[2023-07-28 23:14:41] [config] transformer-pool: false
[2023-07-28 23:14:41] [config] transformer-postprocess: dan
[2023-07-28 23:14:41] [config] transformer-postprocess-emb: d
[2023-07-28 23:14:41] [config] transformer-postprocess-top: ""
[2023-07-28 23:14:41] [config] transformer-preprocess: ""
[2023-07-28 23:14:41] [config] transformer-tied-layers:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] transformer-train-position-embeddings: false
[2023-07-28 23:14:41] [config] tsv: false
[2023-07-28 23:14:41] [config] tsv-fields: 0
[2023-07-28 23:14:41] [config] type: s2s
[2023-07-28 23:14:41] [config] ulr: false
[2023-07-28 23:14:41] [config] ulr-dim-emb: 0
[2023-07-28 23:14:41] [config] ulr-dropout: 0
[2023-07-28 23:14:41] [config] ulr-keys-vectors: ""
[2023-07-28 23:14:41] [config] ulr-query-vectors: ""
[2023-07-28 23:14:41] [config] ulr-softmax-temperature: 1
[2023-07-28 23:14:41] [config] ulr-trainable-transformation: false
[2023-07-28 23:14:41] [config] unlikelihood-loss: false
[2023-07-28 23:14:41] [config] valid-freq: 50000000
[2023-07-28 23:14:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-28 23:14:41] [config] valid-max-length: 1000
[2023-07-28 23:14:41] [config] valid-metrics:
[2023-07-28 23:14:41] [config]   - translation
[2023-07-28 23:14:41] [config] valid-mini-batch: 32
[2023-07-28 23:14:41] [config] valid-reset-stalled: false
[2023-07-28 23:14:41] [config] valid-script-args:
[2023-07-28 23:14:41] [config]   []
[2023-07-28 23:14:41] [config] valid-script-path: ""
[2023-07-28 23:14:41] [config] valid-sets:
[2023-07-28 23:14:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-28 23:14:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-28 23:14:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-28 23:14:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:14:41] [config] vocabs:
[2023-07-28 23:14:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 23:14:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 23:14:41] [config] word-penalty: 0
[2023-07-28 23:14:41] [config] word-scores: false
[2023-07-28 23:14:41] [config] workspace: 5500
[2023-07-28 23:14:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-28 23:14:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:14:41] [training] Using single-device training
[2023-07-28 23:14:43] Synced seed 1234
[2023-07-28 23:14:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-28 23:14:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-28 23:14:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-28 23:14:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-28 23:14:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-28 23:14:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-28 23:14:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-28 23:14:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-28 23:14:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-28 23:14:43] [comm] Using global sharding
[2023-07-28 23:14:44] [comm] NCCLCommunicators constructed successfully
[2023-07-28 23:14:44] [training] Using 1 GPUs
[2023-07-28 23:14:44] [logits] Applying loss function for 1 factor(s)
[2023-07-28 23:14:44] [memory] Reserving 80 MB, device gpu0
[2023-07-28 23:14:44] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-28 23:14:44] [memory] Reserving 80 MB, device gpu0
[2023-07-29 00:04:41] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 00:04:41] [valid] No post-processing script given for validating translator
[2023-07-29 00:04:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 00:04:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 00:04:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 00:04:41] [comm] Using global sharding
[2023-07-29 00:04:42] [comm] NCCLCommunicators constructed successfully
[2023-07-29 00:04:42] [training] Using 1 GPUs
[2023-07-29 00:04:42] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 00:04:44] Allocating memory for general optimizer shards
[2023-07-29 00:04:44] [memory] Reserving 322 MB, device gpu0
[2023-07-29 00:04:44] Loading Adam parameters
[2023-07-29 00:04:44] [memory] Reserving 322 MB, device gpu0
[2023-07-29 00:04:44] [memory] Reserving 80 MB, device gpu0
[2023-07-29 00:04:44] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 00:04:44] [data] Restoring the corpus state to epoch 311, batch 12027
[2023-07-29 00:04:44] [data] Shuffling data
[2023-07-29 00:04:44] [data] Done reading 20,192 sentences
[2023-07-29 00:04:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:04:44] Training started
[2023-07-29 00:04:44] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 00:04:46] [memory] Reserving 80 MB, device gpu0
[2023-07-29 00:04:55] Parameter type float16, optimization type float32, casting types true
[2023-07-29 00:09:24] Seen 20,192 samples
[2023-07-29 00:09:24] Starting data epoch 312 in logical epoch 312
[2023-07-29 00:09:24] [data] Shuffling data
[2023-07-29 00:09:24] [data] Done reading 20,192 sentences
[2023-07-29 00:09:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:14:06] Seen 20,192 samples
[2023-07-29 00:14:06] Starting data epoch 313 in logical epoch 313
[2023-07-29 00:14:06] [data] Shuffling data
[2023-07-29 00:14:06] [data] Done reading 20,192 sentences
[2023-07-29 00:14:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:18:50] Seen 20,192 samples
[2023-07-29 00:18:50] Starting data epoch 314 in logical epoch 314
[2023-07-29 00:18:50] [data] Shuffling data
[2023-07-29 00:18:50] [data] Done reading 20,192 sentences
[2023-07-29 00:18:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:23:23] Seen 20,192 samples
[2023-07-29 00:23:23] Starting data epoch 315 in logical epoch 315
[2023-07-29 00:23:23] [data] Shuffling data
[2023-07-29 00:23:23] [data] Done reading 20,192 sentences
[2023-07-29 00:23:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:28:01] Seen 20,192 samples
[2023-07-29 00:28:01] Starting data epoch 316 in logical epoch 316
[2023-07-29 00:28:01] [data] Shuffling data
[2023-07-29 00:28:01] [data] Done reading 20,192 sentences
[2023-07-29 00:28:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:32:31] Seen 20,192 samples
[2023-07-29 00:32:31] Starting data epoch 317 in logical epoch 317
[2023-07-29 00:32:31] [data] Shuffling data
[2023-07-29 00:32:31] [data] Done reading 20,192 sentences
[2023-07-29 00:32:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:37:07] Seen 20,192 samples
[2023-07-29 00:37:07] Starting data epoch 318 in logical epoch 318
[2023-07-29 00:37:07] [data] Shuffling data
[2023-07-29 00:37:07] [data] Done reading 20,192 sentences
[2023-07-29 00:37:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:41:43] Seen 20,192 samples
[2023-07-29 00:41:43] Starting data epoch 319 in logical epoch 319
[2023-07-29 00:41:43] [data] Shuffling data
[2023-07-29 00:41:43] [data] Done reading 20,192 sentences
[2023-07-29 00:41:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:46:25] Seen 20,192 samples
[2023-07-29 00:46:25] Starting data epoch 320 in logical epoch 320
[2023-07-29 00:46:25] [data] Shuffling data
[2023-07-29 00:46:25] [data] Done reading 20,192 sentences
[2023-07-29 00:46:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 00:50:54] Seen 20,192 samples
[2023-07-29 00:50:54] Starting data epoch 321 in logical epoch 321
[2023-07-29 00:50:54] Training finished
[2023-07-29 00:52:51] [valid] Ep. 321 : Up. 12417 : translation : 0 : new best
[2023-07-29 00:52:51] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 00:52:53] Saving Adam parameters
[2023-07-29 00:52:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 00:53:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 00:53:01] [marian] Running on node18.datos.cluster.uy as process 1538 with command line:
[2023-07-29 00:53:01] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 330 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 00:53:01] [config] after: 0e
[2023-07-29 00:53:01] [config] after-batches: 0
[2023-07-29 00:53:01] [config] after-epochs: 330
[2023-07-29 00:53:01] [config] all-caps-every: 0
[2023-07-29 00:53:01] [config] allow-unk: false
[2023-07-29 00:53:01] [config] authors: false
[2023-07-29 00:53:01] [config] beam-size: 12
[2023-07-29 00:53:01] [config] bert-class-symbol: "[CLS]"
[2023-07-29 00:53:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 00:53:01] [config] bert-masking-fraction: 0.15
[2023-07-29 00:53:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 00:53:01] [config] bert-train-type-embeddings: true
[2023-07-29 00:53:01] [config] bert-type-vocab-size: 2
[2023-07-29 00:53:01] [config] build-info: ""
[2023-07-29 00:53:01] [config] check-gradient-nan: false
[2023-07-29 00:53:01] [config] check-nan: false
[2023-07-29 00:53:01] [config] cite: false
[2023-07-29 00:53:01] [config] clip-norm: 1
[2023-07-29 00:53:01] [config] cost-scaling:
[2023-07-29 00:53:01] [config]   - 256.f
[2023-07-29 00:53:01] [config]   - 1000
[2023-07-29 00:53:01] [config]   - 2.f
[2023-07-29 00:53:01] [config]   - 256.f
[2023-07-29 00:53:01] [config] cost-type: ce-sum
[2023-07-29 00:53:01] [config] cpu-threads: 0
[2023-07-29 00:53:01] [config] data-threads: 8
[2023-07-29 00:53:01] [config] data-weighting: ""
[2023-07-29 00:53:01] [config] data-weighting-type: sentence
[2023-07-29 00:53:01] [config] dec-cell: gru
[2023-07-29 00:53:01] [config] dec-cell-base-depth: 2
[2023-07-29 00:53:01] [config] dec-cell-high-depth: 1
[2023-07-29 00:53:01] [config] dec-depth: 1
[2023-07-29 00:53:01] [config] devices:
[2023-07-29 00:53:01] [config]   - 0
[2023-07-29 00:53:01] [config] dim-emb: 512
[2023-07-29 00:53:01] [config] dim-rnn: 1024
[2023-07-29 00:53:01] [config] dim-vocabs:
[2023-07-29 00:53:01] [config]   - 16384
[2023-07-29 00:53:01] [config]   - 16384
[2023-07-29 00:53:01] [config] disp-first: 0
[2023-07-29 00:53:01] [config] disp-freq: 1000u
[2023-07-29 00:53:01] [config] disp-label-counts: true
[2023-07-29 00:53:01] [config] dropout-rnn: 0
[2023-07-29 00:53:01] [config] dropout-src: 0
[2023-07-29 00:53:01] [config] dropout-trg: 0
[2023-07-29 00:53:01] [config] dump-config: ""
[2023-07-29 00:53:01] [config] dynamic-gradient-scaling:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] early-stopping: 1000
[2023-07-29 00:53:01] [config] early-stopping-on: first
[2023-07-29 00:53:01] [config] embedding-fix-src: false
[2023-07-29 00:53:01] [config] embedding-fix-trg: false
[2023-07-29 00:53:01] [config] embedding-normalization: false
[2023-07-29 00:53:01] [config] embedding-vectors:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] enc-cell: gru
[2023-07-29 00:53:01] [config] enc-cell-depth: 1
[2023-07-29 00:53:01] [config] enc-depth: 1
[2023-07-29 00:53:01] [config] enc-type: bidirectional
[2023-07-29 00:53:01] [config] english-title-case-every: 0
[2023-07-29 00:53:01] [config] exponential-smoothing: 0
[2023-07-29 00:53:01] [config] factor-weight: 1
[2023-07-29 00:53:01] [config] factors-combine: sum
[2023-07-29 00:53:01] [config] factors-dim-emb: 0
[2023-07-29 00:53:01] [config] gradient-checkpointing: false
[2023-07-29 00:53:01] [config] gradient-norm-average-window: 100
[2023-07-29 00:53:01] [config] guided-alignment: none
[2023-07-29 00:53:01] [config] guided-alignment-cost: mse
[2023-07-29 00:53:01] [config] guided-alignment-weight: 0.1
[2023-07-29 00:53:01] [config] ignore-model-config: false
[2023-07-29 00:53:01] [config] input-types:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] interpolate-env-vars: false
[2023-07-29 00:53:01] [config] keep-best: false
[2023-07-29 00:53:01] [config] label-smoothing: 0
[2023-07-29 00:53:01] [config] layer-normalization: false
[2023-07-29 00:53:01] [config] learn-rate: 0.0001
[2023-07-29 00:53:01] [config] lemma-dependency: ""
[2023-07-29 00:53:01] [config] lemma-dim-emb: 0
[2023-07-29 00:53:01] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 00:53:01] [config] log-level: info
[2023-07-29 00:53:01] [config] log-time-zone: ""
[2023-07-29 00:53:01] [config] logical-epoch:
[2023-07-29 00:53:01] [config]   - 1e
[2023-07-29 00:53:01] [config]   - 0
[2023-07-29 00:53:01] [config] lr-decay: 0
[2023-07-29 00:53:01] [config] lr-decay-freq: 50000
[2023-07-29 00:53:01] [config] lr-decay-inv-sqrt:
[2023-07-29 00:53:01] [config]   - 0
[2023-07-29 00:53:01] [config] lr-decay-repeat-warmup: false
[2023-07-29 00:53:01] [config] lr-decay-reset-optimizer: false
[2023-07-29 00:53:01] [config] lr-decay-start:
[2023-07-29 00:53:01] [config]   - 10
[2023-07-29 00:53:01] [config]   - 1
[2023-07-29 00:53:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 00:53:01] [config] lr-report: false
[2023-07-29 00:53:01] [config] lr-warmup: 0
[2023-07-29 00:53:01] [config] lr-warmup-at-reload: false
[2023-07-29 00:53:01] [config] lr-warmup-cycle: false
[2023-07-29 00:53:01] [config] lr-warmup-start-rate: 0
[2023-07-29 00:53:01] [config] max-length: 250
[2023-07-29 00:53:01] [config] max-length-crop: true
[2023-07-29 00:53:01] [config] max-length-factor: 3
[2023-07-29 00:53:01] [config] maxi-batch: 100
[2023-07-29 00:53:01] [config] maxi-batch-sort: trg
[2023-07-29 00:53:01] [config] mini-batch: 64
[2023-07-29 00:53:01] [config] mini-batch-fit: true
[2023-07-29 00:53:01] [config] mini-batch-fit-step: 10
[2023-07-29 00:53:01] [config] mini-batch-round-up: true
[2023-07-29 00:53:01] [config] mini-batch-track-lr: false
[2023-07-29 00:53:01] [config] mini-batch-warmup: 0
[2023-07-29 00:53:01] [config] mini-batch-words: 0
[2023-07-29 00:53:01] [config] mini-batch-words-ref: 0
[2023-07-29 00:53:01] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 00:53:01] [config] multi-loss-type: sum
[2023-07-29 00:53:01] [config] n-best: false
[2023-07-29 00:53:01] [config] no-nccl: false
[2023-07-29 00:53:01] [config] no-reload: false
[2023-07-29 00:53:01] [config] no-restore-corpus: false
[2023-07-29 00:53:01] [config] normalize: 0
[2023-07-29 00:53:01] [config] normalize-gradient: false
[2023-07-29 00:53:01] [config] num-devices: 0
[2023-07-29 00:53:01] [config] optimizer: adam
[2023-07-29 00:53:01] [config] optimizer-delay: 1
[2023-07-29 00:53:01] [config] optimizer-params:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] output-omit-bias: false
[2023-07-29 00:53:01] [config] overwrite: true
[2023-07-29 00:53:01] [config] precision:
[2023-07-29 00:53:01] [config]   - float16
[2023-07-29 00:53:01] [config]   - float32
[2023-07-29 00:53:01] [config] pretrained-model: ""
[2023-07-29 00:53:01] [config] quantize-biases: false
[2023-07-29 00:53:01] [config] quantize-bits: 0
[2023-07-29 00:53:01] [config] quantize-log-based: false
[2023-07-29 00:53:01] [config] quantize-optimization-steps: 0
[2023-07-29 00:53:01] [config] quiet: false
[2023-07-29 00:53:01] [config] quiet-translation: true
[2023-07-29 00:53:01] [config] relative-paths: false
[2023-07-29 00:53:01] [config] right-left: false
[2023-07-29 00:53:01] [config] save-freq: 10000u
[2023-07-29 00:53:01] [config] seed: 1234
[2023-07-29 00:53:01] [config] sentencepiece-alphas:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] sentencepiece-max-lines: 2000000
[2023-07-29 00:53:01] [config] sentencepiece-options: ""
[2023-07-29 00:53:01] [config] sharding: global
[2023-07-29 00:53:01] [config] shuffle: data
[2023-07-29 00:53:01] [config] shuffle-in-ram: false
[2023-07-29 00:53:01] [config] sigterm: save-and-exit
[2023-07-29 00:53:01] [config] skip: false
[2023-07-29 00:53:01] [config] sqlite: ""
[2023-07-29 00:53:01] [config] sqlite-drop: false
[2023-07-29 00:53:01] [config] sync-freq: 200u
[2023-07-29 00:53:01] [config] sync-sgd: false
[2023-07-29 00:53:01] [config] tempdir: /tmp
[2023-07-29 00:53:01] [config] tied-embeddings: false
[2023-07-29 00:53:01] [config] tied-embeddings-all: true
[2023-07-29 00:53:01] [config] tied-embeddings-src: false
[2023-07-29 00:53:01] [config] train-embedder-rank:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] train-sets:
[2023-07-29 00:53:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 00:53:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 00:53:01] [config] transformer-aan-activation: swish
[2023-07-29 00:53:01] [config] transformer-aan-depth: 2
[2023-07-29 00:53:01] [config] transformer-aan-nogate: false
[2023-07-29 00:53:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 00:53:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 00:53:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 00:53:01] [config] transformer-depth-scaling: false
[2023-07-29 00:53:01] [config] transformer-dim-aan: 2048
[2023-07-29 00:53:01] [config] transformer-dim-ffn: 2048
[2023-07-29 00:53:01] [config] transformer-dropout: 0
[2023-07-29 00:53:01] [config] transformer-dropout-attention: 0
[2023-07-29 00:53:01] [config] transformer-dropout-ffn: 0
[2023-07-29 00:53:01] [config] transformer-ffn-activation: swish
[2023-07-29 00:53:01] [config] transformer-ffn-depth: 2
[2023-07-29 00:53:01] [config] transformer-guided-alignment-layer: last
[2023-07-29 00:53:01] [config] transformer-heads: 8
[2023-07-29 00:53:01] [config] transformer-no-projection: false
[2023-07-29 00:53:01] [config] transformer-pool: false
[2023-07-29 00:53:01] [config] transformer-postprocess: dan
[2023-07-29 00:53:01] [config] transformer-postprocess-emb: d
[2023-07-29 00:53:01] [config] transformer-postprocess-top: ""
[2023-07-29 00:53:01] [config] transformer-preprocess: ""
[2023-07-29 00:53:01] [config] transformer-tied-layers:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] transformer-train-position-embeddings: false
[2023-07-29 00:53:01] [config] tsv: false
[2023-07-29 00:53:01] [config] tsv-fields: 0
[2023-07-29 00:53:01] [config] type: s2s
[2023-07-29 00:53:01] [config] ulr: false
[2023-07-29 00:53:01] [config] ulr-dim-emb: 0
[2023-07-29 00:53:01] [config] ulr-dropout: 0
[2023-07-29 00:53:01] [config] ulr-keys-vectors: ""
[2023-07-29 00:53:01] [config] ulr-query-vectors: ""
[2023-07-29 00:53:01] [config] ulr-softmax-temperature: 1
[2023-07-29 00:53:01] [config] ulr-trainable-transformation: false
[2023-07-29 00:53:01] [config] unlikelihood-loss: false
[2023-07-29 00:53:01] [config] valid-freq: 50000000
[2023-07-29 00:53:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 00:53:01] [config] valid-max-length: 1000
[2023-07-29 00:53:01] [config] valid-metrics:
[2023-07-29 00:53:01] [config]   - translation
[2023-07-29 00:53:01] [config] valid-mini-batch: 32
[2023-07-29 00:53:01] [config] valid-reset-stalled: false
[2023-07-29 00:53:01] [config] valid-script-args:
[2023-07-29 00:53:01] [config]   []
[2023-07-29 00:53:01] [config] valid-script-path: ""
[2023-07-29 00:53:01] [config] valid-sets:
[2023-07-29 00:53:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 00:53:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 00:53:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 00:53:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 00:53:01] [config] vocabs:
[2023-07-29 00:53:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 00:53:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 00:53:01] [config] word-penalty: 0
[2023-07-29 00:53:01] [config] word-scores: false
[2023-07-29 00:53:01] [config] workspace: 5500
[2023-07-29 00:53:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 00:53:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 00:53:01] [training] Using single-device training
[2023-07-29 00:53:01] Synced seed 1234
[2023-07-29 00:53:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 00:53:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 00:53:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 00:53:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 00:53:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 00:53:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 00:53:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 00:53:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 00:53:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 00:53:02] [comm] Using global sharding
[2023-07-29 00:53:02] [comm] NCCLCommunicators constructed successfully
[2023-07-29 00:53:02] [training] Using 1 GPUs
[2023-07-29 00:53:02] [logits] Applying loss function for 1 factor(s)
[2023-07-29 00:53:02] [memory] Reserving 80 MB, device gpu0
[2023-07-29 00:53:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 00:53:03] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:41:44] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 01:41:44] [valid] No post-processing script given for validating translator
[2023-07-29 01:41:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 01:41:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 01:41:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 01:41:44] [comm] Using global sharding
[2023-07-29 01:41:44] [comm] NCCLCommunicators constructed successfully
[2023-07-29 01:41:44] [training] Using 1 GPUs
[2023-07-29 01:41:44] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 01:41:50] Allocating memory for general optimizer shards
[2023-07-29 01:41:50] [memory] Reserving 322 MB, device gpu0
[2023-07-29 01:41:50] Loading Adam parameters
[2023-07-29 01:41:50] [memory] Reserving 322 MB, device gpu0
[2023-07-29 01:41:50] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:41:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 01:41:51] [data] Restoring the corpus state to epoch 321, batch 12417
[2023-07-29 01:41:51] [data] Shuffling data
[2023-07-29 01:41:51] [data] Done reading 20,192 sentences
[2023-07-29 01:41:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 01:41:51] Training started
[2023-07-29 01:41:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 01:41:51] [memory] Reserving 80 MB, device gpu0
[2023-07-29 01:41:54] Parameter type float16, optimization type float32, casting types true
[2023-07-29 01:46:23] Seen 20,192 samples
[2023-07-29 01:46:23] Starting data epoch 322 in logical epoch 322
[2023-07-29 01:46:23] [data] Shuffling data
[2023-07-29 01:46:23] [data] Done reading 20,192 sentences
[2023-07-29 01:46:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 01:50:43] Seen 20,192 samples
[2023-07-29 01:50:43] Starting data epoch 323 in logical epoch 323
[2023-07-29 01:50:43] [data] Shuffling data
[2023-07-29 01:50:43] [data] Done reading 20,192 sentences
[2023-07-29 01:50:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 01:55:14] Seen 20,192 samples
[2023-07-29 01:55:14] Starting data epoch 324 in logical epoch 324
[2023-07-29 01:55:14] [data] Shuffling data
[2023-07-29 01:55:14] [data] Done reading 20,192 sentences
[2023-07-29 01:55:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 01:59:49] Seen 20,192 samples
[2023-07-29 01:59:49] Starting data epoch 325 in logical epoch 325
[2023-07-29 01:59:49] [data] Shuffling data
[2023-07-29 01:59:49] [data] Done reading 20,192 sentences
[2023-07-29 01:59:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 02:04:38] Seen 20,192 samples
[2023-07-29 02:04:38] Starting data epoch 326 in logical epoch 326
[2023-07-29 02:04:38] [data] Shuffling data
[2023-07-29 02:04:38] [data] Done reading 20,192 sentences
[2023-07-29 02:04:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 02:09:17] Seen 20,192 samples
[2023-07-29 02:09:17] Starting data epoch 327 in logical epoch 327
[2023-07-29 02:09:17] [data] Shuffling data
[2023-07-29 02:09:17] [data] Done reading 20,192 sentences
[2023-07-29 02:09:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 02:13:48] Seen 20,192 samples
[2023-07-29 02:13:48] Starting data epoch 328 in logical epoch 328
[2023-07-29 02:13:48] [data] Shuffling data
[2023-07-29 02:13:48] [data] Done reading 20,192 sentences
[2023-07-29 02:13:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 02:18:35] Seen 20,192 samples
[2023-07-29 02:18:35] Starting data epoch 329 in logical epoch 329
[2023-07-29 02:18:35] [data] Shuffling data
[2023-07-29 02:18:35] [data] Done reading 20,192 sentences
[2023-07-29 02:18:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 02:22:58] Seen 20,192 samples
[2023-07-29 02:22:58] Starting data epoch 330 in logical epoch 330
[2023-07-29 02:22:58] [data] Shuffling data
[2023-07-29 02:22:58] [data] Done reading 20,192 sentences
[2023-07-29 02:22:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 02:26:56] Seen 20,192 samples
[2023-07-29 02:26:56] Starting data epoch 331 in logical epoch 331
[2023-07-29 02:26:56] Training finished
[2023-07-29 02:28:55] [valid] Ep. 331 : Up. 12806 : translation : 0 : new best
[2023-07-29 02:28:55] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 02:28:58] Saving Adam parameters
[2023-07-29 02:28:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 02:29:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 02:29:06] [marian] Running on node18.datos.cluster.uy as process 7812 with command line:
[2023-07-29 02:29:06] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 340 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 02:29:06] [config] after: 0e
[2023-07-29 02:29:06] [config] after-batches: 0
[2023-07-29 02:29:06] [config] after-epochs: 340
[2023-07-29 02:29:06] [config] all-caps-every: 0
[2023-07-29 02:29:06] [config] allow-unk: false
[2023-07-29 02:29:06] [config] authors: false
[2023-07-29 02:29:06] [config] beam-size: 12
[2023-07-29 02:29:06] [config] bert-class-symbol: "[CLS]"
[2023-07-29 02:29:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 02:29:06] [config] bert-masking-fraction: 0.15
[2023-07-29 02:29:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 02:29:06] [config] bert-train-type-embeddings: true
[2023-07-29 02:29:06] [config] bert-type-vocab-size: 2
[2023-07-29 02:29:06] [config] build-info: ""
[2023-07-29 02:29:06] [config] check-gradient-nan: false
[2023-07-29 02:29:06] [config] check-nan: false
[2023-07-29 02:29:06] [config] cite: false
[2023-07-29 02:29:06] [config] clip-norm: 1
[2023-07-29 02:29:06] [config] cost-scaling:
[2023-07-29 02:29:06] [config]   - 256.f
[2023-07-29 02:29:06] [config]   - 1000
[2023-07-29 02:29:06] [config]   - 2.f
[2023-07-29 02:29:06] [config]   - 256.f
[2023-07-29 02:29:06] [config] cost-type: ce-sum
[2023-07-29 02:29:06] [config] cpu-threads: 0
[2023-07-29 02:29:06] [config] data-threads: 8
[2023-07-29 02:29:06] [config] data-weighting: ""
[2023-07-29 02:29:06] [config] data-weighting-type: sentence
[2023-07-29 02:29:06] [config] dec-cell: gru
[2023-07-29 02:29:06] [config] dec-cell-base-depth: 2
[2023-07-29 02:29:06] [config] dec-cell-high-depth: 1
[2023-07-29 02:29:06] [config] dec-depth: 1
[2023-07-29 02:29:06] [config] devices:
[2023-07-29 02:29:06] [config]   - 0
[2023-07-29 02:29:06] [config] dim-emb: 512
[2023-07-29 02:29:06] [config] dim-rnn: 1024
[2023-07-29 02:29:06] [config] dim-vocabs:
[2023-07-29 02:29:06] [config]   - 16384
[2023-07-29 02:29:06] [config]   - 16384
[2023-07-29 02:29:06] [config] disp-first: 0
[2023-07-29 02:29:06] [config] disp-freq: 1000u
[2023-07-29 02:29:06] [config] disp-label-counts: true
[2023-07-29 02:29:06] [config] dropout-rnn: 0
[2023-07-29 02:29:06] [config] dropout-src: 0
[2023-07-29 02:29:06] [config] dropout-trg: 0
[2023-07-29 02:29:06] [config] dump-config: ""
[2023-07-29 02:29:06] [config] dynamic-gradient-scaling:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] early-stopping: 1000
[2023-07-29 02:29:06] [config] early-stopping-on: first
[2023-07-29 02:29:06] [config] embedding-fix-src: false
[2023-07-29 02:29:06] [config] embedding-fix-trg: false
[2023-07-29 02:29:06] [config] embedding-normalization: false
[2023-07-29 02:29:06] [config] embedding-vectors:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] enc-cell: gru
[2023-07-29 02:29:06] [config] enc-cell-depth: 1
[2023-07-29 02:29:06] [config] enc-depth: 1
[2023-07-29 02:29:06] [config] enc-type: bidirectional
[2023-07-29 02:29:06] [config] english-title-case-every: 0
[2023-07-29 02:29:06] [config] exponential-smoothing: 0
[2023-07-29 02:29:06] [config] factor-weight: 1
[2023-07-29 02:29:06] [config] factors-combine: sum
[2023-07-29 02:29:06] [config] factors-dim-emb: 0
[2023-07-29 02:29:06] [config] gradient-checkpointing: false
[2023-07-29 02:29:06] [config] gradient-norm-average-window: 100
[2023-07-29 02:29:06] [config] guided-alignment: none
[2023-07-29 02:29:06] [config] guided-alignment-cost: mse
[2023-07-29 02:29:06] [config] guided-alignment-weight: 0.1
[2023-07-29 02:29:06] [config] ignore-model-config: false
[2023-07-29 02:29:06] [config] input-types:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] interpolate-env-vars: false
[2023-07-29 02:29:06] [config] keep-best: false
[2023-07-29 02:29:06] [config] label-smoothing: 0
[2023-07-29 02:29:06] [config] layer-normalization: false
[2023-07-29 02:29:06] [config] learn-rate: 0.0001
[2023-07-29 02:29:06] [config] lemma-dependency: ""
[2023-07-29 02:29:06] [config] lemma-dim-emb: 0
[2023-07-29 02:29:06] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 02:29:06] [config] log-level: info
[2023-07-29 02:29:06] [config] log-time-zone: ""
[2023-07-29 02:29:06] [config] logical-epoch:
[2023-07-29 02:29:06] [config]   - 1e
[2023-07-29 02:29:06] [config]   - 0
[2023-07-29 02:29:06] [config] lr-decay: 0
[2023-07-29 02:29:06] [config] lr-decay-freq: 50000
[2023-07-29 02:29:06] [config] lr-decay-inv-sqrt:
[2023-07-29 02:29:06] [config]   - 0
[2023-07-29 02:29:06] [config] lr-decay-repeat-warmup: false
[2023-07-29 02:29:06] [config] lr-decay-reset-optimizer: false
[2023-07-29 02:29:06] [config] lr-decay-start:
[2023-07-29 02:29:06] [config]   - 10
[2023-07-29 02:29:06] [config]   - 1
[2023-07-29 02:29:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 02:29:06] [config] lr-report: false
[2023-07-29 02:29:06] [config] lr-warmup: 0
[2023-07-29 02:29:06] [config] lr-warmup-at-reload: false
[2023-07-29 02:29:06] [config] lr-warmup-cycle: false
[2023-07-29 02:29:06] [config] lr-warmup-start-rate: 0
[2023-07-29 02:29:06] [config] max-length: 250
[2023-07-29 02:29:06] [config] max-length-crop: true
[2023-07-29 02:29:06] [config] max-length-factor: 3
[2023-07-29 02:29:06] [config] maxi-batch: 100
[2023-07-29 02:29:06] [config] maxi-batch-sort: trg
[2023-07-29 02:29:06] [config] mini-batch: 64
[2023-07-29 02:29:06] [config] mini-batch-fit: true
[2023-07-29 02:29:06] [config] mini-batch-fit-step: 10
[2023-07-29 02:29:06] [config] mini-batch-round-up: true
[2023-07-29 02:29:06] [config] mini-batch-track-lr: false
[2023-07-29 02:29:06] [config] mini-batch-warmup: 0
[2023-07-29 02:29:06] [config] mini-batch-words: 0
[2023-07-29 02:29:06] [config] mini-batch-words-ref: 0
[2023-07-29 02:29:06] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 02:29:06] [config] multi-loss-type: sum
[2023-07-29 02:29:06] [config] n-best: false
[2023-07-29 02:29:06] [config] no-nccl: false
[2023-07-29 02:29:06] [config] no-reload: false
[2023-07-29 02:29:06] [config] no-restore-corpus: false
[2023-07-29 02:29:06] [config] normalize: 0
[2023-07-29 02:29:06] [config] normalize-gradient: false
[2023-07-29 02:29:06] [config] num-devices: 0
[2023-07-29 02:29:06] [config] optimizer: adam
[2023-07-29 02:29:06] [config] optimizer-delay: 1
[2023-07-29 02:29:06] [config] optimizer-params:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] output-omit-bias: false
[2023-07-29 02:29:06] [config] overwrite: true
[2023-07-29 02:29:06] [config] precision:
[2023-07-29 02:29:06] [config]   - float16
[2023-07-29 02:29:06] [config]   - float32
[2023-07-29 02:29:06] [config] pretrained-model: ""
[2023-07-29 02:29:06] [config] quantize-biases: false
[2023-07-29 02:29:06] [config] quantize-bits: 0
[2023-07-29 02:29:06] [config] quantize-log-based: false
[2023-07-29 02:29:06] [config] quantize-optimization-steps: 0
[2023-07-29 02:29:06] [config] quiet: false
[2023-07-29 02:29:06] [config] quiet-translation: true
[2023-07-29 02:29:06] [config] relative-paths: false
[2023-07-29 02:29:06] [config] right-left: false
[2023-07-29 02:29:06] [config] save-freq: 10000u
[2023-07-29 02:29:06] [config] seed: 1234
[2023-07-29 02:29:06] [config] sentencepiece-alphas:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] sentencepiece-max-lines: 2000000
[2023-07-29 02:29:06] [config] sentencepiece-options: ""
[2023-07-29 02:29:06] [config] sharding: global
[2023-07-29 02:29:06] [config] shuffle: data
[2023-07-29 02:29:06] [config] shuffle-in-ram: false
[2023-07-29 02:29:06] [config] sigterm: save-and-exit
[2023-07-29 02:29:06] [config] skip: false
[2023-07-29 02:29:06] [config] sqlite: ""
[2023-07-29 02:29:06] [config] sqlite-drop: false
[2023-07-29 02:29:06] [config] sync-freq: 200u
[2023-07-29 02:29:06] [config] sync-sgd: false
[2023-07-29 02:29:06] [config] tempdir: /tmp
[2023-07-29 02:29:06] [config] tied-embeddings: false
[2023-07-29 02:29:06] [config] tied-embeddings-all: true
[2023-07-29 02:29:06] [config] tied-embeddings-src: false
[2023-07-29 02:29:06] [config] train-embedder-rank:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] train-sets:
[2023-07-29 02:29:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 02:29:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 02:29:06] [config] transformer-aan-activation: swish
[2023-07-29 02:29:06] [config] transformer-aan-depth: 2
[2023-07-29 02:29:06] [config] transformer-aan-nogate: false
[2023-07-29 02:29:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 02:29:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 02:29:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 02:29:06] [config] transformer-depth-scaling: false
[2023-07-29 02:29:06] [config] transformer-dim-aan: 2048
[2023-07-29 02:29:06] [config] transformer-dim-ffn: 2048
[2023-07-29 02:29:06] [config] transformer-dropout: 0
[2023-07-29 02:29:06] [config] transformer-dropout-attention: 0
[2023-07-29 02:29:06] [config] transformer-dropout-ffn: 0
[2023-07-29 02:29:06] [config] transformer-ffn-activation: swish
[2023-07-29 02:29:06] [config] transformer-ffn-depth: 2
[2023-07-29 02:29:06] [config] transformer-guided-alignment-layer: last
[2023-07-29 02:29:06] [config] transformer-heads: 8
[2023-07-29 02:29:06] [config] transformer-no-projection: false
[2023-07-29 02:29:06] [config] transformer-pool: false
[2023-07-29 02:29:06] [config] transformer-postprocess: dan
[2023-07-29 02:29:06] [config] transformer-postprocess-emb: d
[2023-07-29 02:29:06] [config] transformer-postprocess-top: ""
[2023-07-29 02:29:06] [config] transformer-preprocess: ""
[2023-07-29 02:29:06] [config] transformer-tied-layers:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] transformer-train-position-embeddings: false
[2023-07-29 02:29:06] [config] tsv: false
[2023-07-29 02:29:06] [config] tsv-fields: 0
[2023-07-29 02:29:06] [config] type: s2s
[2023-07-29 02:29:06] [config] ulr: false
[2023-07-29 02:29:06] [config] ulr-dim-emb: 0
[2023-07-29 02:29:06] [config] ulr-dropout: 0
[2023-07-29 02:29:06] [config] ulr-keys-vectors: ""
[2023-07-29 02:29:06] [config] ulr-query-vectors: ""
[2023-07-29 02:29:06] [config] ulr-softmax-temperature: 1
[2023-07-29 02:29:06] [config] ulr-trainable-transformation: false
[2023-07-29 02:29:06] [config] unlikelihood-loss: false
[2023-07-29 02:29:06] [config] valid-freq: 50000000
[2023-07-29 02:29:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 02:29:06] [config] valid-max-length: 1000
[2023-07-29 02:29:06] [config] valid-metrics:
[2023-07-29 02:29:06] [config]   - translation
[2023-07-29 02:29:06] [config] valid-mini-batch: 32
[2023-07-29 02:29:06] [config] valid-reset-stalled: false
[2023-07-29 02:29:06] [config] valid-script-args:
[2023-07-29 02:29:06] [config]   []
[2023-07-29 02:29:06] [config] valid-script-path: ""
[2023-07-29 02:29:06] [config] valid-sets:
[2023-07-29 02:29:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 02:29:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 02:29:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 02:29:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 02:29:06] [config] vocabs:
[2023-07-29 02:29:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 02:29:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 02:29:06] [config] word-penalty: 0
[2023-07-29 02:29:06] [config] word-scores: false
[2023-07-29 02:29:06] [config] workspace: 5500
[2023-07-29 02:29:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 02:29:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 02:29:06] [training] Using single-device training
[2023-07-29 02:29:08] Synced seed 1234
[2023-07-29 02:29:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 02:29:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 02:29:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 02:29:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 02:29:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 02:29:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 02:29:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 02:29:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 02:29:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 02:29:09] [comm] Using global sharding
[2023-07-29 02:29:09] [comm] NCCLCommunicators constructed successfully
[2023-07-29 02:29:09] [training] Using 1 GPUs
[2023-07-29 02:29:09] [logits] Applying loss function for 1 factor(s)
[2023-07-29 02:29:09] [memory] Reserving 80 MB, device gpu0
[2023-07-29 02:29:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 02:29:09] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:18:28] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 03:18:28] [valid] No post-processing script given for validating translator
[2023-07-29 03:18:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 03:18:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 03:18:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 03:18:28] [comm] Using global sharding
[2023-07-29 03:18:29] [comm] NCCLCommunicators constructed successfully
[2023-07-29 03:18:29] [training] Using 1 GPUs
[2023-07-29 03:18:29] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 03:18:30] Allocating memory for general optimizer shards
[2023-07-29 03:18:30] [memory] Reserving 322 MB, device gpu0
[2023-07-29 03:18:30] Loading Adam parameters
[2023-07-29 03:18:30] [memory] Reserving 322 MB, device gpu0
[2023-07-29 03:18:30] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:18:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 03:18:30] [data] Restoring the corpus state to epoch 331, batch 12806
[2023-07-29 03:18:30] [data] Shuffling data
[2023-07-29 03:18:30] [data] Done reading 20,192 sentences
[2023-07-29 03:18:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:18:30] Training started
[2023-07-29 03:18:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 03:18:31] [memory] Reserving 80 MB, device gpu0
[2023-07-29 03:18:40] Parameter type float16, optimization type float32, casting types true
[2023-07-29 03:23:02] Seen 20,192 samples
[2023-07-29 03:23:02] Starting data epoch 332 in logical epoch 332
[2023-07-29 03:23:02] [data] Shuffling data
[2023-07-29 03:23:02] [data] Done reading 20,192 sentences
[2023-07-29 03:23:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:27:31] Seen 20,192 samples
[2023-07-29 03:27:31] Starting data epoch 333 in logical epoch 333
[2023-07-29 03:27:31] [data] Shuffling data
[2023-07-29 03:27:31] [data] Done reading 20,192 sentences
[2023-07-29 03:27:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:32:03] Seen 20,192 samples
[2023-07-29 03:32:03] Starting data epoch 334 in logical epoch 334
[2023-07-29 03:32:03] [data] Shuffling data
[2023-07-29 03:32:03] [data] Done reading 20,192 sentences
[2023-07-29 03:32:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:36:45] Seen 20,192 samples
[2023-07-29 03:36:45] Starting data epoch 335 in logical epoch 335
[2023-07-29 03:36:45] [data] Shuffling data
[2023-07-29 03:36:45] [data] Done reading 20,192 sentences
[2023-07-29 03:36:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:41:11] Ep. 335 : Up. 13000 : Sen. 19,715 : Cost 1.10911417 * 15,919,592 @ 13,863 after 207,838,942 : Time 1362.81s : 11681.43 words/s : gNorm 2.1218
[2023-07-29 03:41:24] Seen 20,192 samples
[2023-07-29 03:41:24] Starting data epoch 336 in logical epoch 336
[2023-07-29 03:41:24] [data] Shuffling data
[2023-07-29 03:41:24] [data] Done reading 20,192 sentences
[2023-07-29 03:41:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:46:05] Seen 20,192 samples
[2023-07-29 03:46:05] Starting data epoch 337 in logical epoch 337
[2023-07-29 03:46:05] [data] Shuffling data
[2023-07-29 03:46:05] [data] Done reading 20,192 sentences
[2023-07-29 03:46:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:50:53] Seen 20,192 samples
[2023-07-29 03:50:53] Starting data epoch 338 in logical epoch 338
[2023-07-29 03:50:53] [data] Shuffling data
[2023-07-29 03:50:53] [data] Done reading 20,192 sentences
[2023-07-29 03:50:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 03:55:38] Seen 20,192 samples
[2023-07-29 03:55:38] Starting data epoch 339 in logical epoch 339
[2023-07-29 03:55:38] [data] Shuffling data
[2023-07-29 03:55:38] [data] Done reading 20,192 sentences
[2023-07-29 03:55:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 04:00:12] Seen 20,192 samples
[2023-07-29 04:00:12] Starting data epoch 340 in logical epoch 340
[2023-07-29 04:00:12] [data] Shuffling data
[2023-07-29 04:00:12] [data] Done reading 20,192 sentences
[2023-07-29 04:00:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 04:04:37] Seen 20,192 samples
[2023-07-29 04:04:37] Starting data epoch 341 in logical epoch 341
[2023-07-29 04:04:37] Training finished
[2023-07-29 04:06:41] [valid] Ep. 341 : Up. 13197 : translation : 0 : new best
[2023-07-29 04:06:41] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 04:06:43] Saving Adam parameters
[2023-07-29 04:06:43] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 04:06:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:06:50] [marian] Running on node18.datos.cluster.uy as process 14103 with command line:
[2023-07-29 04:06:50] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 350 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 04:06:50] [config] after: 0e
[2023-07-29 04:06:50] [config] after-batches: 0
[2023-07-29 04:06:50] [config] after-epochs: 350
[2023-07-29 04:06:50] [config] all-caps-every: 0
[2023-07-29 04:06:50] [config] allow-unk: false
[2023-07-29 04:06:50] [config] authors: false
[2023-07-29 04:06:50] [config] beam-size: 12
[2023-07-29 04:06:50] [config] bert-class-symbol: "[CLS]"
[2023-07-29 04:06:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 04:06:50] [config] bert-masking-fraction: 0.15
[2023-07-29 04:06:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 04:06:50] [config] bert-train-type-embeddings: true
[2023-07-29 04:06:50] [config] bert-type-vocab-size: 2
[2023-07-29 04:06:50] [config] build-info: ""
[2023-07-29 04:06:50] [config] check-gradient-nan: false
[2023-07-29 04:06:50] [config] check-nan: false
[2023-07-29 04:06:50] [config] cite: false
[2023-07-29 04:06:50] [config] clip-norm: 1
[2023-07-29 04:06:50] [config] cost-scaling:
[2023-07-29 04:06:50] [config]   - 256.f
[2023-07-29 04:06:50] [config]   - 1000
[2023-07-29 04:06:50] [config]   - 2.f
[2023-07-29 04:06:50] [config]   - 256.f
[2023-07-29 04:06:50] [config] cost-type: ce-sum
[2023-07-29 04:06:50] [config] cpu-threads: 0
[2023-07-29 04:06:50] [config] data-threads: 8
[2023-07-29 04:06:50] [config] data-weighting: ""
[2023-07-29 04:06:50] [config] data-weighting-type: sentence
[2023-07-29 04:06:50] [config] dec-cell: gru
[2023-07-29 04:06:50] [config] dec-cell-base-depth: 2
[2023-07-29 04:06:50] [config] dec-cell-high-depth: 1
[2023-07-29 04:06:50] [config] dec-depth: 1
[2023-07-29 04:06:50] [config] devices:
[2023-07-29 04:06:50] [config]   - 0
[2023-07-29 04:06:50] [config] dim-emb: 512
[2023-07-29 04:06:50] [config] dim-rnn: 1024
[2023-07-29 04:06:50] [config] dim-vocabs:
[2023-07-29 04:06:50] [config]   - 16384
[2023-07-29 04:06:50] [config]   - 16384
[2023-07-29 04:06:50] [config] disp-first: 0
[2023-07-29 04:06:50] [config] disp-freq: 1000u
[2023-07-29 04:06:50] [config] disp-label-counts: true
[2023-07-29 04:06:50] [config] dropout-rnn: 0
[2023-07-29 04:06:50] [config] dropout-src: 0
[2023-07-29 04:06:50] [config] dropout-trg: 0
[2023-07-29 04:06:50] [config] dump-config: ""
[2023-07-29 04:06:50] [config] dynamic-gradient-scaling:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] early-stopping: 1000
[2023-07-29 04:06:50] [config] early-stopping-on: first
[2023-07-29 04:06:50] [config] embedding-fix-src: false
[2023-07-29 04:06:50] [config] embedding-fix-trg: false
[2023-07-29 04:06:50] [config] embedding-normalization: false
[2023-07-29 04:06:50] [config] embedding-vectors:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] enc-cell: gru
[2023-07-29 04:06:50] [config] enc-cell-depth: 1
[2023-07-29 04:06:50] [config] enc-depth: 1
[2023-07-29 04:06:50] [config] enc-type: bidirectional
[2023-07-29 04:06:50] [config] english-title-case-every: 0
[2023-07-29 04:06:50] [config] exponential-smoothing: 0
[2023-07-29 04:06:50] [config] factor-weight: 1
[2023-07-29 04:06:50] [config] factors-combine: sum
[2023-07-29 04:06:50] [config] factors-dim-emb: 0
[2023-07-29 04:06:50] [config] gradient-checkpointing: false
[2023-07-29 04:06:50] [config] gradient-norm-average-window: 100
[2023-07-29 04:06:50] [config] guided-alignment: none
[2023-07-29 04:06:50] [config] guided-alignment-cost: mse
[2023-07-29 04:06:50] [config] guided-alignment-weight: 0.1
[2023-07-29 04:06:50] [config] ignore-model-config: false
[2023-07-29 04:06:50] [config] input-types:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] interpolate-env-vars: false
[2023-07-29 04:06:50] [config] keep-best: false
[2023-07-29 04:06:50] [config] label-smoothing: 0
[2023-07-29 04:06:50] [config] layer-normalization: false
[2023-07-29 04:06:50] [config] learn-rate: 0.0001
[2023-07-29 04:06:50] [config] lemma-dependency: ""
[2023-07-29 04:06:50] [config] lemma-dim-emb: 0
[2023-07-29 04:06:50] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 04:06:50] [config] log-level: info
[2023-07-29 04:06:50] [config] log-time-zone: ""
[2023-07-29 04:06:50] [config] logical-epoch:
[2023-07-29 04:06:50] [config]   - 1e
[2023-07-29 04:06:50] [config]   - 0
[2023-07-29 04:06:50] [config] lr-decay: 0
[2023-07-29 04:06:50] [config] lr-decay-freq: 50000
[2023-07-29 04:06:50] [config] lr-decay-inv-sqrt:
[2023-07-29 04:06:50] [config]   - 0
[2023-07-29 04:06:50] [config] lr-decay-repeat-warmup: false
[2023-07-29 04:06:50] [config] lr-decay-reset-optimizer: false
[2023-07-29 04:06:50] [config] lr-decay-start:
[2023-07-29 04:06:50] [config]   - 10
[2023-07-29 04:06:50] [config]   - 1
[2023-07-29 04:06:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 04:06:50] [config] lr-report: false
[2023-07-29 04:06:50] [config] lr-warmup: 0
[2023-07-29 04:06:50] [config] lr-warmup-at-reload: false
[2023-07-29 04:06:50] [config] lr-warmup-cycle: false
[2023-07-29 04:06:50] [config] lr-warmup-start-rate: 0
[2023-07-29 04:06:50] [config] max-length: 250
[2023-07-29 04:06:50] [config] max-length-crop: true
[2023-07-29 04:06:50] [config] max-length-factor: 3
[2023-07-29 04:06:50] [config] maxi-batch: 100
[2023-07-29 04:06:50] [config] maxi-batch-sort: trg
[2023-07-29 04:06:50] [config] mini-batch: 64
[2023-07-29 04:06:50] [config] mini-batch-fit: true
[2023-07-29 04:06:50] [config] mini-batch-fit-step: 10
[2023-07-29 04:06:50] [config] mini-batch-round-up: true
[2023-07-29 04:06:50] [config] mini-batch-track-lr: false
[2023-07-29 04:06:50] [config] mini-batch-warmup: 0
[2023-07-29 04:06:50] [config] mini-batch-words: 0
[2023-07-29 04:06:50] [config] mini-batch-words-ref: 0
[2023-07-29 04:06:50] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 04:06:50] [config] multi-loss-type: sum
[2023-07-29 04:06:50] [config] n-best: false
[2023-07-29 04:06:50] [config] no-nccl: false
[2023-07-29 04:06:50] [config] no-reload: false
[2023-07-29 04:06:50] [config] no-restore-corpus: false
[2023-07-29 04:06:50] [config] normalize: 0
[2023-07-29 04:06:50] [config] normalize-gradient: false
[2023-07-29 04:06:50] [config] num-devices: 0
[2023-07-29 04:06:50] [config] optimizer: adam
[2023-07-29 04:06:50] [config] optimizer-delay: 1
[2023-07-29 04:06:50] [config] optimizer-params:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] output-omit-bias: false
[2023-07-29 04:06:50] [config] overwrite: true
[2023-07-29 04:06:50] [config] precision:
[2023-07-29 04:06:50] [config]   - float16
[2023-07-29 04:06:50] [config]   - float32
[2023-07-29 04:06:50] [config] pretrained-model: ""
[2023-07-29 04:06:50] [config] quantize-biases: false
[2023-07-29 04:06:50] [config] quantize-bits: 0
[2023-07-29 04:06:50] [config] quantize-log-based: false
[2023-07-29 04:06:50] [config] quantize-optimization-steps: 0
[2023-07-29 04:06:50] [config] quiet: false
[2023-07-29 04:06:50] [config] quiet-translation: true
[2023-07-29 04:06:50] [config] relative-paths: false
[2023-07-29 04:06:50] [config] right-left: false
[2023-07-29 04:06:50] [config] save-freq: 10000u
[2023-07-29 04:06:50] [config] seed: 1234
[2023-07-29 04:06:50] [config] sentencepiece-alphas:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] sentencepiece-max-lines: 2000000
[2023-07-29 04:06:50] [config] sentencepiece-options: ""
[2023-07-29 04:06:50] [config] sharding: global
[2023-07-29 04:06:50] [config] shuffle: data
[2023-07-29 04:06:50] [config] shuffle-in-ram: false
[2023-07-29 04:06:50] [config] sigterm: save-and-exit
[2023-07-29 04:06:50] [config] skip: false
[2023-07-29 04:06:50] [config] sqlite: ""
[2023-07-29 04:06:50] [config] sqlite-drop: false
[2023-07-29 04:06:50] [config] sync-freq: 200u
[2023-07-29 04:06:50] [config] sync-sgd: false
[2023-07-29 04:06:50] [config] tempdir: /tmp
[2023-07-29 04:06:50] [config] tied-embeddings: false
[2023-07-29 04:06:50] [config] tied-embeddings-all: true
[2023-07-29 04:06:50] [config] tied-embeddings-src: false
[2023-07-29 04:06:50] [config] train-embedder-rank:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] train-sets:
[2023-07-29 04:06:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 04:06:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 04:06:50] [config] transformer-aan-activation: swish
[2023-07-29 04:06:50] [config] transformer-aan-depth: 2
[2023-07-29 04:06:50] [config] transformer-aan-nogate: false
[2023-07-29 04:06:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 04:06:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 04:06:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 04:06:50] [config] transformer-depth-scaling: false
[2023-07-29 04:06:50] [config] transformer-dim-aan: 2048
[2023-07-29 04:06:50] [config] transformer-dim-ffn: 2048
[2023-07-29 04:06:50] [config] transformer-dropout: 0
[2023-07-29 04:06:50] [config] transformer-dropout-attention: 0
[2023-07-29 04:06:50] [config] transformer-dropout-ffn: 0
[2023-07-29 04:06:50] [config] transformer-ffn-activation: swish
[2023-07-29 04:06:50] [config] transformer-ffn-depth: 2
[2023-07-29 04:06:50] [config] transformer-guided-alignment-layer: last
[2023-07-29 04:06:50] [config] transformer-heads: 8
[2023-07-29 04:06:50] [config] transformer-no-projection: false
[2023-07-29 04:06:50] [config] transformer-pool: false
[2023-07-29 04:06:50] [config] transformer-postprocess: dan
[2023-07-29 04:06:50] [config] transformer-postprocess-emb: d
[2023-07-29 04:06:50] [config] transformer-postprocess-top: ""
[2023-07-29 04:06:50] [config] transformer-preprocess: ""
[2023-07-29 04:06:50] [config] transformer-tied-layers:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] transformer-train-position-embeddings: false
[2023-07-29 04:06:50] [config] tsv: false
[2023-07-29 04:06:50] [config] tsv-fields: 0
[2023-07-29 04:06:50] [config] type: s2s
[2023-07-29 04:06:50] [config] ulr: false
[2023-07-29 04:06:50] [config] ulr-dim-emb: 0
[2023-07-29 04:06:50] [config] ulr-dropout: 0
[2023-07-29 04:06:50] [config] ulr-keys-vectors: ""
[2023-07-29 04:06:50] [config] ulr-query-vectors: ""
[2023-07-29 04:06:50] [config] ulr-softmax-temperature: 1
[2023-07-29 04:06:50] [config] ulr-trainable-transformation: false
[2023-07-29 04:06:50] [config] unlikelihood-loss: false
[2023-07-29 04:06:50] [config] valid-freq: 50000000
[2023-07-29 04:06:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 04:06:50] [config] valid-max-length: 1000
[2023-07-29 04:06:50] [config] valid-metrics:
[2023-07-29 04:06:50] [config]   - translation
[2023-07-29 04:06:50] [config] valid-mini-batch: 32
[2023-07-29 04:06:50] [config] valid-reset-stalled: false
[2023-07-29 04:06:50] [config] valid-script-args:
[2023-07-29 04:06:50] [config]   []
[2023-07-29 04:06:50] [config] valid-script-path: ""
[2023-07-29 04:06:50] [config] valid-sets:
[2023-07-29 04:06:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 04:06:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 04:06:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 04:06:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:06:50] [config] vocabs:
[2023-07-29 04:06:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 04:06:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 04:06:50] [config] word-penalty: 0
[2023-07-29 04:06:50] [config] word-scores: false
[2023-07-29 04:06:50] [config] workspace: 5500
[2023-07-29 04:06:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 04:06:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:06:50] [training] Using single-device training
[2023-07-29 04:06:51] Synced seed 1234
[2023-07-29 04:06:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 04:06:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 04:06:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 04:06:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 04:06:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 04:06:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:06:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 04:06:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 04:06:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 04:06:52] [comm] Using global sharding
[2023-07-29 04:06:52] [comm] NCCLCommunicators constructed successfully
[2023-07-29 04:06:52] [training] Using 1 GPUs
[2023-07-29 04:06:52] [logits] Applying loss function for 1 factor(s)
[2023-07-29 04:06:52] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:06:52] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 04:06:52] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:54:28] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 04:54:28] [valid] No post-processing script given for validating translator
[2023-07-29 04:54:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 04:54:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 04:54:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 04:54:29] [comm] Using global sharding
[2023-07-29 04:54:29] [comm] NCCLCommunicators constructed successfully
[2023-07-29 04:54:29] [training] Using 1 GPUs
[2023-07-29 04:54:29] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 04:54:30] Allocating memory for general optimizer shards
[2023-07-29 04:54:30] [memory] Reserving 322 MB, device gpu0
[2023-07-29 04:54:30] Loading Adam parameters
[2023-07-29 04:54:30] [memory] Reserving 322 MB, device gpu0
[2023-07-29 04:54:30] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:54:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 04:54:30] [data] Restoring the corpus state to epoch 341, batch 13197
[2023-07-29 04:54:30] [data] Shuffling data
[2023-07-29 04:54:30] [data] Done reading 20,192 sentences
[2023-07-29 04:54:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 04:54:30] Training started
[2023-07-29 04:54:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 04:54:32] [memory] Reserving 80 MB, device gpu0
[2023-07-29 04:54:36] Parameter type float16, optimization type float32, casting types true
[2023-07-29 04:59:02] Seen 20,192 samples
[2023-07-29 04:59:02] Starting data epoch 342 in logical epoch 342
[2023-07-29 04:59:02] [data] Shuffling data
[2023-07-29 04:59:02] [data] Done reading 20,192 sentences
[2023-07-29 04:59:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:03:46] Seen 20,192 samples
[2023-07-29 05:03:46] Starting data epoch 343 in logical epoch 343
[2023-07-29 05:03:46] [data] Shuffling data
[2023-07-29 05:03:46] [data] Done reading 20,192 sentences
[2023-07-29 05:03:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:08:19] Seen 20,192 samples
[2023-07-29 05:08:19] Starting data epoch 344 in logical epoch 344
[2023-07-29 05:08:19] [data] Shuffling data
[2023-07-29 05:08:19] [data] Done reading 20,192 sentences
[2023-07-29 05:08:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:12:54] Seen 20,192 samples
[2023-07-29 05:12:54] Starting data epoch 345 in logical epoch 345
[2023-07-29 05:12:54] [data] Shuffling data
[2023-07-29 05:12:54] [data] Done reading 20,192 sentences
[2023-07-29 05:12:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:17:44] Seen 20,192 samples
[2023-07-29 05:17:44] Starting data epoch 346 in logical epoch 346
[2023-07-29 05:17:44] [data] Shuffling data
[2023-07-29 05:17:44] [data] Done reading 20,192 sentences
[2023-07-29 05:17:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:22:22] Seen 20,192 samples
[2023-07-29 05:22:22] Starting data epoch 347 in logical epoch 347
[2023-07-29 05:22:22] [data] Shuffling data
[2023-07-29 05:22:22] [data] Done reading 20,192 sentences
[2023-07-29 05:22:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:27:02] Seen 20,192 samples
[2023-07-29 05:27:02] Starting data epoch 348 in logical epoch 348
[2023-07-29 05:27:02] [data] Shuffling data
[2023-07-29 05:27:02] [data] Done reading 20,192 sentences
[2023-07-29 05:27:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:31:43] Seen 20,192 samples
[2023-07-29 05:31:43] Starting data epoch 349 in logical epoch 349
[2023-07-29 05:31:43] [data] Shuffling data
[2023-07-29 05:31:43] [data] Done reading 20,192 sentences
[2023-07-29 05:31:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:36:20] Seen 20,192 samples
[2023-07-29 05:36:20] Starting data epoch 350 in logical epoch 350
[2023-07-29 05:36:20] [data] Shuffling data
[2023-07-29 05:36:20] [data] Done reading 20,192 sentences
[2023-07-29 05:36:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 05:41:04] Seen 20,192 samples
[2023-07-29 05:41:04] Starting data epoch 351 in logical epoch 351
[2023-07-29 05:41:04] Training finished
[2023-07-29 05:43:11] [valid] Ep. 351 : Up. 13587 : translation : 0 : new best
[2023-07-29 05:43:11] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 05:43:13] Saving Adam parameters
[2023-07-29 05:43:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 05:43:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 05:43:20] [marian] Running on node18.datos.cluster.uy as process 20196 with command line:
[2023-07-29 05:43:20] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 360 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 05:43:20] [config] after: 0e
[2023-07-29 05:43:20] [config] after-batches: 0
[2023-07-29 05:43:20] [config] after-epochs: 360
[2023-07-29 05:43:20] [config] all-caps-every: 0
[2023-07-29 05:43:20] [config] allow-unk: false
[2023-07-29 05:43:20] [config] authors: false
[2023-07-29 05:43:20] [config] beam-size: 12
[2023-07-29 05:43:20] [config] bert-class-symbol: "[CLS]"
[2023-07-29 05:43:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 05:43:20] [config] bert-masking-fraction: 0.15
[2023-07-29 05:43:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 05:43:20] [config] bert-train-type-embeddings: true
[2023-07-29 05:43:20] [config] bert-type-vocab-size: 2
[2023-07-29 05:43:20] [config] build-info: ""
[2023-07-29 05:43:20] [config] check-gradient-nan: false
[2023-07-29 05:43:20] [config] check-nan: false
[2023-07-29 05:43:20] [config] cite: false
[2023-07-29 05:43:20] [config] clip-norm: 1
[2023-07-29 05:43:20] [config] cost-scaling:
[2023-07-29 05:43:20] [config]   - 256.f
[2023-07-29 05:43:20] [config]   - 1000
[2023-07-29 05:43:20] [config]   - 2.f
[2023-07-29 05:43:20] [config]   - 256.f
[2023-07-29 05:43:20] [config] cost-type: ce-sum
[2023-07-29 05:43:20] [config] cpu-threads: 0
[2023-07-29 05:43:20] [config] data-threads: 8
[2023-07-29 05:43:20] [config] data-weighting: ""
[2023-07-29 05:43:20] [config] data-weighting-type: sentence
[2023-07-29 05:43:20] [config] dec-cell: gru
[2023-07-29 05:43:20] [config] dec-cell-base-depth: 2
[2023-07-29 05:43:20] [config] dec-cell-high-depth: 1
[2023-07-29 05:43:20] [config] dec-depth: 1
[2023-07-29 05:43:20] [config] devices:
[2023-07-29 05:43:20] [config]   - 0
[2023-07-29 05:43:20] [config] dim-emb: 512
[2023-07-29 05:43:20] [config] dim-rnn: 1024
[2023-07-29 05:43:20] [config] dim-vocabs:
[2023-07-29 05:43:20] [config]   - 16384
[2023-07-29 05:43:20] [config]   - 16384
[2023-07-29 05:43:20] [config] disp-first: 0
[2023-07-29 05:43:20] [config] disp-freq: 1000u
[2023-07-29 05:43:20] [config] disp-label-counts: true
[2023-07-29 05:43:20] [config] dropout-rnn: 0
[2023-07-29 05:43:20] [config] dropout-src: 0
[2023-07-29 05:43:20] [config] dropout-trg: 0
[2023-07-29 05:43:20] [config] dump-config: ""
[2023-07-29 05:43:20] [config] dynamic-gradient-scaling:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] early-stopping: 1000
[2023-07-29 05:43:20] [config] early-stopping-on: first
[2023-07-29 05:43:20] [config] embedding-fix-src: false
[2023-07-29 05:43:20] [config] embedding-fix-trg: false
[2023-07-29 05:43:20] [config] embedding-normalization: false
[2023-07-29 05:43:20] [config] embedding-vectors:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] enc-cell: gru
[2023-07-29 05:43:20] [config] enc-cell-depth: 1
[2023-07-29 05:43:20] [config] enc-depth: 1
[2023-07-29 05:43:20] [config] enc-type: bidirectional
[2023-07-29 05:43:20] [config] english-title-case-every: 0
[2023-07-29 05:43:20] [config] exponential-smoothing: 0
[2023-07-29 05:43:20] [config] factor-weight: 1
[2023-07-29 05:43:20] [config] factors-combine: sum
[2023-07-29 05:43:20] [config] factors-dim-emb: 0
[2023-07-29 05:43:20] [config] gradient-checkpointing: false
[2023-07-29 05:43:20] [config] gradient-norm-average-window: 100
[2023-07-29 05:43:20] [config] guided-alignment: none
[2023-07-29 05:43:20] [config] guided-alignment-cost: mse
[2023-07-29 05:43:20] [config] guided-alignment-weight: 0.1
[2023-07-29 05:43:20] [config] ignore-model-config: false
[2023-07-29 05:43:20] [config] input-types:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] interpolate-env-vars: false
[2023-07-29 05:43:20] [config] keep-best: false
[2023-07-29 05:43:20] [config] label-smoothing: 0
[2023-07-29 05:43:20] [config] layer-normalization: false
[2023-07-29 05:43:20] [config] learn-rate: 0.0001
[2023-07-29 05:43:20] [config] lemma-dependency: ""
[2023-07-29 05:43:20] [config] lemma-dim-emb: 0
[2023-07-29 05:43:20] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 05:43:20] [config] log-level: info
[2023-07-29 05:43:20] [config] log-time-zone: ""
[2023-07-29 05:43:20] [config] logical-epoch:
[2023-07-29 05:43:20] [config]   - 1e
[2023-07-29 05:43:20] [config]   - 0
[2023-07-29 05:43:20] [config] lr-decay: 0
[2023-07-29 05:43:20] [config] lr-decay-freq: 50000
[2023-07-29 05:43:20] [config] lr-decay-inv-sqrt:
[2023-07-29 05:43:20] [config]   - 0
[2023-07-29 05:43:20] [config] lr-decay-repeat-warmup: false
[2023-07-29 05:43:20] [config] lr-decay-reset-optimizer: false
[2023-07-29 05:43:20] [config] lr-decay-start:
[2023-07-29 05:43:20] [config]   - 10
[2023-07-29 05:43:20] [config]   - 1
[2023-07-29 05:43:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 05:43:20] [config] lr-report: false
[2023-07-29 05:43:20] [config] lr-warmup: 0
[2023-07-29 05:43:20] [config] lr-warmup-at-reload: false
[2023-07-29 05:43:20] [config] lr-warmup-cycle: false
[2023-07-29 05:43:20] [config] lr-warmup-start-rate: 0
[2023-07-29 05:43:20] [config] max-length: 250
[2023-07-29 05:43:20] [config] max-length-crop: true
[2023-07-29 05:43:20] [config] max-length-factor: 3
[2023-07-29 05:43:20] [config] maxi-batch: 100
[2023-07-29 05:43:20] [config] maxi-batch-sort: trg
[2023-07-29 05:43:20] [config] mini-batch: 64
[2023-07-29 05:43:20] [config] mini-batch-fit: true
[2023-07-29 05:43:20] [config] mini-batch-fit-step: 10
[2023-07-29 05:43:20] [config] mini-batch-round-up: true
[2023-07-29 05:43:20] [config] mini-batch-track-lr: false
[2023-07-29 05:43:20] [config] mini-batch-warmup: 0
[2023-07-29 05:43:20] [config] mini-batch-words: 0
[2023-07-29 05:43:20] [config] mini-batch-words-ref: 0
[2023-07-29 05:43:20] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 05:43:20] [config] multi-loss-type: sum
[2023-07-29 05:43:20] [config] n-best: false
[2023-07-29 05:43:20] [config] no-nccl: false
[2023-07-29 05:43:20] [config] no-reload: false
[2023-07-29 05:43:20] [config] no-restore-corpus: false
[2023-07-29 05:43:20] [config] normalize: 0
[2023-07-29 05:43:20] [config] normalize-gradient: false
[2023-07-29 05:43:20] [config] num-devices: 0
[2023-07-29 05:43:20] [config] optimizer: adam
[2023-07-29 05:43:20] [config] optimizer-delay: 1
[2023-07-29 05:43:20] [config] optimizer-params:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] output-omit-bias: false
[2023-07-29 05:43:20] [config] overwrite: true
[2023-07-29 05:43:20] [config] precision:
[2023-07-29 05:43:20] [config]   - float16
[2023-07-29 05:43:20] [config]   - float32
[2023-07-29 05:43:20] [config] pretrained-model: ""
[2023-07-29 05:43:20] [config] quantize-biases: false
[2023-07-29 05:43:20] [config] quantize-bits: 0
[2023-07-29 05:43:20] [config] quantize-log-based: false
[2023-07-29 05:43:20] [config] quantize-optimization-steps: 0
[2023-07-29 05:43:20] [config] quiet: false
[2023-07-29 05:43:20] [config] quiet-translation: true
[2023-07-29 05:43:20] [config] relative-paths: false
[2023-07-29 05:43:20] [config] right-left: false
[2023-07-29 05:43:20] [config] save-freq: 10000u
[2023-07-29 05:43:20] [config] seed: 1234
[2023-07-29 05:43:20] [config] sentencepiece-alphas:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] sentencepiece-max-lines: 2000000
[2023-07-29 05:43:20] [config] sentencepiece-options: ""
[2023-07-29 05:43:20] [config] sharding: global
[2023-07-29 05:43:20] [config] shuffle: data
[2023-07-29 05:43:20] [config] shuffle-in-ram: false
[2023-07-29 05:43:20] [config] sigterm: save-and-exit
[2023-07-29 05:43:20] [config] skip: false
[2023-07-29 05:43:20] [config] sqlite: ""
[2023-07-29 05:43:20] [config] sqlite-drop: false
[2023-07-29 05:43:20] [config] sync-freq: 200u
[2023-07-29 05:43:20] [config] sync-sgd: false
[2023-07-29 05:43:20] [config] tempdir: /tmp
[2023-07-29 05:43:20] [config] tied-embeddings: false
[2023-07-29 05:43:20] [config] tied-embeddings-all: true
[2023-07-29 05:43:20] [config] tied-embeddings-src: false
[2023-07-29 05:43:20] [config] train-embedder-rank:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] train-sets:
[2023-07-29 05:43:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 05:43:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 05:43:20] [config] transformer-aan-activation: swish
[2023-07-29 05:43:20] [config] transformer-aan-depth: 2
[2023-07-29 05:43:20] [config] transformer-aan-nogate: false
[2023-07-29 05:43:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 05:43:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 05:43:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 05:43:20] [config] transformer-depth-scaling: false
[2023-07-29 05:43:20] [config] transformer-dim-aan: 2048
[2023-07-29 05:43:20] [config] transformer-dim-ffn: 2048
[2023-07-29 05:43:20] [config] transformer-dropout: 0
[2023-07-29 05:43:20] [config] transformer-dropout-attention: 0
[2023-07-29 05:43:20] [config] transformer-dropout-ffn: 0
[2023-07-29 05:43:20] [config] transformer-ffn-activation: swish
[2023-07-29 05:43:20] [config] transformer-ffn-depth: 2
[2023-07-29 05:43:20] [config] transformer-guided-alignment-layer: last
[2023-07-29 05:43:20] [config] transformer-heads: 8
[2023-07-29 05:43:20] [config] transformer-no-projection: false
[2023-07-29 05:43:20] [config] transformer-pool: false
[2023-07-29 05:43:20] [config] transformer-postprocess: dan
[2023-07-29 05:43:20] [config] transformer-postprocess-emb: d
[2023-07-29 05:43:20] [config] transformer-postprocess-top: ""
[2023-07-29 05:43:20] [config] transformer-preprocess: ""
[2023-07-29 05:43:20] [config] transformer-tied-layers:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] transformer-train-position-embeddings: false
[2023-07-29 05:43:20] [config] tsv: false
[2023-07-29 05:43:20] [config] tsv-fields: 0
[2023-07-29 05:43:20] [config] type: s2s
[2023-07-29 05:43:20] [config] ulr: false
[2023-07-29 05:43:20] [config] ulr-dim-emb: 0
[2023-07-29 05:43:20] [config] ulr-dropout: 0
[2023-07-29 05:43:20] [config] ulr-keys-vectors: ""
[2023-07-29 05:43:20] [config] ulr-query-vectors: ""
[2023-07-29 05:43:20] [config] ulr-softmax-temperature: 1
[2023-07-29 05:43:20] [config] ulr-trainable-transformation: false
[2023-07-29 05:43:20] [config] unlikelihood-loss: false
[2023-07-29 05:43:20] [config] valid-freq: 50000000
[2023-07-29 05:43:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 05:43:20] [config] valid-max-length: 1000
[2023-07-29 05:43:20] [config] valid-metrics:
[2023-07-29 05:43:20] [config]   - translation
[2023-07-29 05:43:20] [config] valid-mini-batch: 32
[2023-07-29 05:43:20] [config] valid-reset-stalled: false
[2023-07-29 05:43:20] [config] valid-script-args:
[2023-07-29 05:43:20] [config]   []
[2023-07-29 05:43:20] [config] valid-script-path: ""
[2023-07-29 05:43:20] [config] valid-sets:
[2023-07-29 05:43:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 05:43:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 05:43:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 05:43:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 05:43:20] [config] vocabs:
[2023-07-29 05:43:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 05:43:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 05:43:20] [config] word-penalty: 0
[2023-07-29 05:43:20] [config] word-scores: false
[2023-07-29 05:43:20] [config] workspace: 5500
[2023-07-29 05:43:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 05:43:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 05:43:20] [training] Using single-device training
[2023-07-29 05:43:21] Synced seed 1234
[2023-07-29 05:43:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 05:43:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 05:43:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 05:43:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 05:43:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 05:43:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 05:43:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 05:43:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 05:43:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 05:43:21] [comm] Using global sharding
[2023-07-29 05:43:22] [comm] NCCLCommunicators constructed successfully
[2023-07-29 05:43:22] [training] Using 1 GPUs
[2023-07-29 05:43:22] [logits] Applying loss function for 1 factor(s)
[2023-07-29 05:43:22] [memory] Reserving 80 MB, device gpu0
[2023-07-29 05:43:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 05:43:22] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:31:18] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 06:31:19] [valid] No post-processing script given for validating translator
[2023-07-29 06:31:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 06:31:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 06:31:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 06:31:19] [comm] Using global sharding
[2023-07-29 06:31:19] [comm] NCCLCommunicators constructed successfully
[2023-07-29 06:31:19] [training] Using 1 GPUs
[2023-07-29 06:31:19] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 06:31:20] Allocating memory for general optimizer shards
[2023-07-29 06:31:20] [memory] Reserving 322 MB, device gpu0
[2023-07-29 06:31:20] Loading Adam parameters
[2023-07-29 06:31:20] [memory] Reserving 322 MB, device gpu0
[2023-07-29 06:31:20] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:31:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 06:31:21] [data] Restoring the corpus state to epoch 351, batch 13587
[2023-07-29 06:31:21] [data] Shuffling data
[2023-07-29 06:31:21] [data] Done reading 20,192 sentences
[2023-07-29 06:31:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:31:21] Training started
[2023-07-29 06:31:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 06:31:24] [memory] Reserving 80 MB, device gpu0
[2023-07-29 06:31:42] Parameter type float16, optimization type float32, casting types true
[2023-07-29 06:35:57] Seen 20,192 samples
[2023-07-29 06:35:57] Starting data epoch 352 in logical epoch 352
[2023-07-29 06:35:57] [data] Shuffling data
[2023-07-29 06:35:57] [data] Done reading 20,192 sentences
[2023-07-29 06:35:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:40:33] Seen 20,192 samples
[2023-07-29 06:40:33] Starting data epoch 353 in logical epoch 353
[2023-07-29 06:40:33] [data] Shuffling data
[2023-07-29 06:40:33] [data] Done reading 20,192 sentences
[2023-07-29 06:40:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:45:04] Seen 20,192 samples
[2023-07-29 06:45:04] Starting data epoch 354 in logical epoch 354
[2023-07-29 06:45:04] [data] Shuffling data
[2023-07-29 06:45:05] [data] Done reading 20,192 sentences
[2023-07-29 06:45:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:49:41] Seen 20,192 samples
[2023-07-29 06:49:41] Starting data epoch 355 in logical epoch 355
[2023-07-29 06:49:41] [data] Shuffling data
[2023-07-29 06:49:41] [data] Done reading 20,192 sentences
[2023-07-29 06:49:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:54:20] Seen 20,192 samples
[2023-07-29 06:54:20] Starting data epoch 356 in logical epoch 356
[2023-07-29 06:54:20] [data] Shuffling data
[2023-07-29 06:54:21] [data] Done reading 20,192 sentences
[2023-07-29 06:54:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 06:59:03] Seen 20,192 samples
[2023-07-29 06:59:03] Starting data epoch 357 in logical epoch 357
[2023-07-29 06:59:03] [data] Shuffling data
[2023-07-29 06:59:03] [data] Done reading 20,192 sentences
[2023-07-29 06:59:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 07:03:39] Seen 20,192 samples
[2023-07-29 07:03:39] Starting data epoch 358 in logical epoch 358
[2023-07-29 07:03:39] [data] Shuffling data
[2023-07-29 07:03:40] [data] Done reading 20,192 sentences
[2023-07-29 07:03:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 07:08:15] Seen 20,192 samples
[2023-07-29 07:08:15] Starting data epoch 359 in logical epoch 359
[2023-07-29 07:08:15] [data] Shuffling data
[2023-07-29 07:08:15] [data] Done reading 20,192 sentences
[2023-07-29 07:08:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 07:12:51] Seen 20,192 samples
[2023-07-29 07:12:51] Starting data epoch 360 in logical epoch 360
[2023-07-29 07:12:51] [data] Shuffling data
[2023-07-29 07:12:51] [data] Done reading 20,192 sentences
[2023-07-29 07:12:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 07:17:31] Seen 20,192 samples
[2023-07-29 07:17:31] Starting data epoch 361 in logical epoch 361
[2023-07-29 07:17:31] Training finished
[2023-07-29 07:19:20] [valid] Ep. 361 : Up. 13973 : translation : 0 : new best
[2023-07-29 07:19:20] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 07:19:23] Saving Adam parameters
[2023-07-29 07:19:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 07:19:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:19:34] [marian] Running on node18.datos.cluster.uy as process 26277 with command line:
[2023-07-29 07:19:34] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 370 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 07:19:34] [config] after: 0e
[2023-07-29 07:19:34] [config] after-batches: 0
[2023-07-29 07:19:34] [config] after-epochs: 370
[2023-07-29 07:19:34] [config] all-caps-every: 0
[2023-07-29 07:19:34] [config] allow-unk: false
[2023-07-29 07:19:34] [config] authors: false
[2023-07-29 07:19:34] [config] beam-size: 12
[2023-07-29 07:19:34] [config] bert-class-symbol: "[CLS]"
[2023-07-29 07:19:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 07:19:34] [config] bert-masking-fraction: 0.15
[2023-07-29 07:19:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 07:19:34] [config] bert-train-type-embeddings: true
[2023-07-29 07:19:34] [config] bert-type-vocab-size: 2
[2023-07-29 07:19:34] [config] build-info: ""
[2023-07-29 07:19:34] [config] check-gradient-nan: false
[2023-07-29 07:19:34] [config] check-nan: false
[2023-07-29 07:19:34] [config] cite: false
[2023-07-29 07:19:34] [config] clip-norm: 1
[2023-07-29 07:19:34] [config] cost-scaling:
[2023-07-29 07:19:34] [config]   - 256.f
[2023-07-29 07:19:34] [config]   - 1000
[2023-07-29 07:19:34] [config]   - 2.f
[2023-07-29 07:19:34] [config]   - 256.f
[2023-07-29 07:19:34] [config] cost-type: ce-sum
[2023-07-29 07:19:34] [config] cpu-threads: 0
[2023-07-29 07:19:34] [config] data-threads: 8
[2023-07-29 07:19:34] [config] data-weighting: ""
[2023-07-29 07:19:34] [config] data-weighting-type: sentence
[2023-07-29 07:19:34] [config] dec-cell: gru
[2023-07-29 07:19:34] [config] dec-cell-base-depth: 2
[2023-07-29 07:19:34] [config] dec-cell-high-depth: 1
[2023-07-29 07:19:34] [config] dec-depth: 1
[2023-07-29 07:19:34] [config] devices:
[2023-07-29 07:19:34] [config]   - 0
[2023-07-29 07:19:34] [config] dim-emb: 512
[2023-07-29 07:19:34] [config] dim-rnn: 1024
[2023-07-29 07:19:34] [config] dim-vocabs:
[2023-07-29 07:19:34] [config]   - 16384
[2023-07-29 07:19:34] [config]   - 16384
[2023-07-29 07:19:34] [config] disp-first: 0
[2023-07-29 07:19:34] [config] disp-freq: 1000u
[2023-07-29 07:19:34] [config] disp-label-counts: true
[2023-07-29 07:19:34] [config] dropout-rnn: 0
[2023-07-29 07:19:34] [config] dropout-src: 0
[2023-07-29 07:19:34] [config] dropout-trg: 0
[2023-07-29 07:19:34] [config] dump-config: ""
[2023-07-29 07:19:34] [config] dynamic-gradient-scaling:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] early-stopping: 1000
[2023-07-29 07:19:34] [config] early-stopping-on: first
[2023-07-29 07:19:34] [config] embedding-fix-src: false
[2023-07-29 07:19:34] [config] embedding-fix-trg: false
[2023-07-29 07:19:34] [config] embedding-normalization: false
[2023-07-29 07:19:34] [config] embedding-vectors:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] enc-cell: gru
[2023-07-29 07:19:34] [config] enc-cell-depth: 1
[2023-07-29 07:19:34] [config] enc-depth: 1
[2023-07-29 07:19:34] [config] enc-type: bidirectional
[2023-07-29 07:19:34] [config] english-title-case-every: 0
[2023-07-29 07:19:34] [config] exponential-smoothing: 0
[2023-07-29 07:19:34] [config] factor-weight: 1
[2023-07-29 07:19:34] [config] factors-combine: sum
[2023-07-29 07:19:34] [config] factors-dim-emb: 0
[2023-07-29 07:19:34] [config] gradient-checkpointing: false
[2023-07-29 07:19:34] [config] gradient-norm-average-window: 100
[2023-07-29 07:19:34] [config] guided-alignment: none
[2023-07-29 07:19:34] [config] guided-alignment-cost: mse
[2023-07-29 07:19:34] [config] guided-alignment-weight: 0.1
[2023-07-29 07:19:34] [config] ignore-model-config: false
[2023-07-29 07:19:34] [config] input-types:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] interpolate-env-vars: false
[2023-07-29 07:19:34] [config] keep-best: false
[2023-07-29 07:19:34] [config] label-smoothing: 0
[2023-07-29 07:19:34] [config] layer-normalization: false
[2023-07-29 07:19:34] [config] learn-rate: 0.0001
[2023-07-29 07:19:34] [config] lemma-dependency: ""
[2023-07-29 07:19:34] [config] lemma-dim-emb: 0
[2023-07-29 07:19:34] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 07:19:34] [config] log-level: info
[2023-07-29 07:19:34] [config] log-time-zone: ""
[2023-07-29 07:19:34] [config] logical-epoch:
[2023-07-29 07:19:34] [config]   - 1e
[2023-07-29 07:19:34] [config]   - 0
[2023-07-29 07:19:34] [config] lr-decay: 0
[2023-07-29 07:19:34] [config] lr-decay-freq: 50000
[2023-07-29 07:19:34] [config] lr-decay-inv-sqrt:
[2023-07-29 07:19:34] [config]   - 0
[2023-07-29 07:19:34] [config] lr-decay-repeat-warmup: false
[2023-07-29 07:19:34] [config] lr-decay-reset-optimizer: false
[2023-07-29 07:19:34] [config] lr-decay-start:
[2023-07-29 07:19:34] [config]   - 10
[2023-07-29 07:19:34] [config]   - 1
[2023-07-29 07:19:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 07:19:34] [config] lr-report: false
[2023-07-29 07:19:34] [config] lr-warmup: 0
[2023-07-29 07:19:34] [config] lr-warmup-at-reload: false
[2023-07-29 07:19:34] [config] lr-warmup-cycle: false
[2023-07-29 07:19:34] [config] lr-warmup-start-rate: 0
[2023-07-29 07:19:34] [config] max-length: 250
[2023-07-29 07:19:34] [config] max-length-crop: true
[2023-07-29 07:19:34] [config] max-length-factor: 3
[2023-07-29 07:19:34] [config] maxi-batch: 100
[2023-07-29 07:19:34] [config] maxi-batch-sort: trg
[2023-07-29 07:19:34] [config] mini-batch: 64
[2023-07-29 07:19:34] [config] mini-batch-fit: true
[2023-07-29 07:19:34] [config] mini-batch-fit-step: 10
[2023-07-29 07:19:34] [config] mini-batch-round-up: true
[2023-07-29 07:19:34] [config] mini-batch-track-lr: false
[2023-07-29 07:19:34] [config] mini-batch-warmup: 0
[2023-07-29 07:19:34] [config] mini-batch-words: 0
[2023-07-29 07:19:34] [config] mini-batch-words-ref: 0
[2023-07-29 07:19:34] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 07:19:34] [config] multi-loss-type: sum
[2023-07-29 07:19:34] [config] n-best: false
[2023-07-29 07:19:34] [config] no-nccl: false
[2023-07-29 07:19:34] [config] no-reload: false
[2023-07-29 07:19:34] [config] no-restore-corpus: false
[2023-07-29 07:19:34] [config] normalize: 0
[2023-07-29 07:19:34] [config] normalize-gradient: false
[2023-07-29 07:19:34] [config] num-devices: 0
[2023-07-29 07:19:34] [config] optimizer: adam
[2023-07-29 07:19:34] [config] optimizer-delay: 1
[2023-07-29 07:19:34] [config] optimizer-params:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] output-omit-bias: false
[2023-07-29 07:19:34] [config] overwrite: true
[2023-07-29 07:19:34] [config] precision:
[2023-07-29 07:19:34] [config]   - float16
[2023-07-29 07:19:34] [config]   - float32
[2023-07-29 07:19:34] [config] pretrained-model: ""
[2023-07-29 07:19:34] [config] quantize-biases: false
[2023-07-29 07:19:34] [config] quantize-bits: 0
[2023-07-29 07:19:34] [config] quantize-log-based: false
[2023-07-29 07:19:34] [config] quantize-optimization-steps: 0
[2023-07-29 07:19:34] [config] quiet: false
[2023-07-29 07:19:34] [config] quiet-translation: true
[2023-07-29 07:19:34] [config] relative-paths: false
[2023-07-29 07:19:34] [config] right-left: false
[2023-07-29 07:19:34] [config] save-freq: 10000u
[2023-07-29 07:19:34] [config] seed: 1234
[2023-07-29 07:19:34] [config] sentencepiece-alphas:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] sentencepiece-max-lines: 2000000
[2023-07-29 07:19:34] [config] sentencepiece-options: ""
[2023-07-29 07:19:34] [config] sharding: global
[2023-07-29 07:19:34] [config] shuffle: data
[2023-07-29 07:19:34] [config] shuffle-in-ram: false
[2023-07-29 07:19:34] [config] sigterm: save-and-exit
[2023-07-29 07:19:34] [config] skip: false
[2023-07-29 07:19:34] [config] sqlite: ""
[2023-07-29 07:19:34] [config] sqlite-drop: false
[2023-07-29 07:19:34] [config] sync-freq: 200u
[2023-07-29 07:19:34] [config] sync-sgd: false
[2023-07-29 07:19:34] [config] tempdir: /tmp
[2023-07-29 07:19:34] [config] tied-embeddings: false
[2023-07-29 07:19:34] [config] tied-embeddings-all: true
[2023-07-29 07:19:34] [config] tied-embeddings-src: false
[2023-07-29 07:19:34] [config] train-embedder-rank:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] train-sets:
[2023-07-29 07:19:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 07:19:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 07:19:34] [config] transformer-aan-activation: swish
[2023-07-29 07:19:34] [config] transformer-aan-depth: 2
[2023-07-29 07:19:34] [config] transformer-aan-nogate: false
[2023-07-29 07:19:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 07:19:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 07:19:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 07:19:34] [config] transformer-depth-scaling: false
[2023-07-29 07:19:34] [config] transformer-dim-aan: 2048
[2023-07-29 07:19:34] [config] transformer-dim-ffn: 2048
[2023-07-29 07:19:34] [config] transformer-dropout: 0
[2023-07-29 07:19:34] [config] transformer-dropout-attention: 0
[2023-07-29 07:19:34] [config] transformer-dropout-ffn: 0
[2023-07-29 07:19:34] [config] transformer-ffn-activation: swish
[2023-07-29 07:19:34] [config] transformer-ffn-depth: 2
[2023-07-29 07:19:34] [config] transformer-guided-alignment-layer: last
[2023-07-29 07:19:34] [config] transformer-heads: 8
[2023-07-29 07:19:34] [config] transformer-no-projection: false
[2023-07-29 07:19:34] [config] transformer-pool: false
[2023-07-29 07:19:34] [config] transformer-postprocess: dan
[2023-07-29 07:19:34] [config] transformer-postprocess-emb: d
[2023-07-29 07:19:34] [config] transformer-postprocess-top: ""
[2023-07-29 07:19:34] [config] transformer-preprocess: ""
[2023-07-29 07:19:34] [config] transformer-tied-layers:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] transformer-train-position-embeddings: false
[2023-07-29 07:19:34] [config] tsv: false
[2023-07-29 07:19:34] [config] tsv-fields: 0
[2023-07-29 07:19:34] [config] type: s2s
[2023-07-29 07:19:34] [config] ulr: false
[2023-07-29 07:19:34] [config] ulr-dim-emb: 0
[2023-07-29 07:19:34] [config] ulr-dropout: 0
[2023-07-29 07:19:34] [config] ulr-keys-vectors: ""
[2023-07-29 07:19:34] [config] ulr-query-vectors: ""
[2023-07-29 07:19:34] [config] ulr-softmax-temperature: 1
[2023-07-29 07:19:34] [config] ulr-trainable-transformation: false
[2023-07-29 07:19:34] [config] unlikelihood-loss: false
[2023-07-29 07:19:34] [config] valid-freq: 50000000
[2023-07-29 07:19:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 07:19:34] [config] valid-max-length: 1000
[2023-07-29 07:19:34] [config] valid-metrics:
[2023-07-29 07:19:34] [config]   - translation
[2023-07-29 07:19:34] [config] valid-mini-batch: 32
[2023-07-29 07:19:34] [config] valid-reset-stalled: false
[2023-07-29 07:19:34] [config] valid-script-args:
[2023-07-29 07:19:34] [config]   []
[2023-07-29 07:19:34] [config] valid-script-path: ""
[2023-07-29 07:19:34] [config] valid-sets:
[2023-07-29 07:19:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 07:19:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 07:19:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 07:19:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:19:34] [config] vocabs:
[2023-07-29 07:19:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 07:19:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 07:19:34] [config] word-penalty: 0
[2023-07-29 07:19:34] [config] word-scores: false
[2023-07-29 07:19:34] [config] workspace: 5500
[2023-07-29 07:19:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 07:19:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:19:34] [training] Using single-device training
[2023-07-29 07:19:34] Synced seed 1234
[2023-07-29 07:19:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 07:19:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 07:19:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 07:19:34] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 07:19:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 07:19:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 07:19:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 07:19:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 07:19:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 07:19:35] [comm] Using global sharding
[2023-07-29 07:19:35] [comm] NCCLCommunicators constructed successfully
[2023-07-29 07:19:35] [training] Using 1 GPUs
[2023-07-29 07:19:35] [logits] Applying loss function for 1 factor(s)
[2023-07-29 07:19:35] [memory] Reserving 80 MB, device gpu0
[2023-07-29 07:19:35] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 07:19:36] [memory] Reserving 80 MB, device gpu0
[2023-07-29 08:09:27] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 08:09:27] [valid] No post-processing script given for validating translator
[2023-07-29 08:09:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 08:09:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 08:09:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 08:09:28] [comm] Using global sharding
[2023-07-29 08:09:28] [comm] NCCLCommunicators constructed successfully
[2023-07-29 08:09:28] [training] Using 1 GPUs
[2023-07-29 08:09:28] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 08:09:29] Allocating memory for general optimizer shards
[2023-07-29 08:09:29] [memory] Reserving 322 MB, device gpu0
[2023-07-29 08:09:29] Loading Adam parameters
[2023-07-29 08:09:30] [memory] Reserving 322 MB, device gpu0
[2023-07-29 08:09:30] [memory] Reserving 80 MB, device gpu0
[2023-07-29 08:09:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 08:09:30] [data] Restoring the corpus state to epoch 361, batch 13973
[2023-07-29 08:09:30] [data] Shuffling data
[2023-07-29 08:09:30] [data] Done reading 20,192 sentences
[2023-07-29 08:09:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:09:30] Training started
[2023-07-29 08:09:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 08:09:31] [memory] Reserving 80 MB, device gpu0
[2023-07-29 08:09:34] Parameter type float16, optimization type float32, casting types true
[2023-07-29 08:12:53] Ep. 361 : Up. 14000 : Sen. 14,611 : Cost 0.87979424 * 15,966,481 @ 16,968 after 223,805,421 : Time 205.49s : 77698.83 words/s : gNorm 1.6732
[2023-07-29 08:14:17] Seen 20,192 samples
[2023-07-29 08:14:17] Starting data epoch 362 in logical epoch 362
[2023-07-29 08:14:17] [data] Shuffling data
[2023-07-29 08:14:17] [data] Done reading 20,192 sentences
[2023-07-29 08:14:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:18:59] Seen 20,192 samples
[2023-07-29 08:18:59] Starting data epoch 363 in logical epoch 363
[2023-07-29 08:18:59] [data] Shuffling data
[2023-07-29 08:18:59] [data] Done reading 20,192 sentences
[2023-07-29 08:18:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:23:08] Seen 20,192 samples
[2023-07-29 08:23:08] Starting data epoch 364 in logical epoch 364
[2023-07-29 08:23:08] [data] Shuffling data
[2023-07-29 08:23:08] [data] Done reading 20,192 sentences
[2023-07-29 08:23:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:27:26] Seen 20,192 samples
[2023-07-29 08:27:26] Starting data epoch 365 in logical epoch 365
[2023-07-29 08:27:26] [data] Shuffling data
[2023-07-29 08:27:26] [data] Done reading 20,192 sentences
[2023-07-29 08:27:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:31:35] Seen 20,192 samples
[2023-07-29 08:31:35] Starting data epoch 366 in logical epoch 366
[2023-07-29 08:31:35] [data] Shuffling data
[2023-07-29 08:31:35] [data] Done reading 20,192 sentences
[2023-07-29 08:31:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:35:51] Seen 20,192 samples
[2023-07-29 08:35:51] Starting data epoch 367 in logical epoch 367
[2023-07-29 08:35:51] [data] Shuffling data
[2023-07-29 08:35:51] [data] Done reading 20,192 sentences
[2023-07-29 08:35:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:39:58] Seen 20,192 samples
[2023-07-29 08:39:58] Starting data epoch 368 in logical epoch 368
[2023-07-29 08:39:58] [data] Shuffling data
[2023-07-29 08:39:58] [data] Done reading 20,192 sentences
[2023-07-29 08:39:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:44:08] Seen 20,192 samples
[2023-07-29 08:44:08] Starting data epoch 369 in logical epoch 369
[2023-07-29 08:44:08] [data] Shuffling data
[2023-07-29 08:44:08] [data] Done reading 20,192 sentences
[2023-07-29 08:44:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:48:20] Seen 20,192 samples
[2023-07-29 08:48:20] Starting data epoch 370 in logical epoch 370
[2023-07-29 08:48:20] [data] Shuffling data
[2023-07-29 08:48:20] [data] Done reading 20,192 sentences
[2023-07-29 08:48:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 08:52:45] Seen 20,192 samples
[2023-07-29 08:52:45] Starting data epoch 371 in logical epoch 371
[2023-07-29 08:52:45] Training finished
[2023-07-29 08:54:52] [valid] Ep. 371 : Up. 14360 : translation : 0 : new best
[2023-07-29 08:54:52] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 08:54:54] Saving Adam parameters
[2023-07-29 08:54:55] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 08:55:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 08:55:02] [marian] Running on node18.datos.cluster.uy as process 32657 with command line:
[2023-07-29 08:55:02] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 380 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 08:55:02] [config] after: 0e
[2023-07-29 08:55:02] [config] after-batches: 0
[2023-07-29 08:55:02] [config] after-epochs: 380
[2023-07-29 08:55:02] [config] all-caps-every: 0
[2023-07-29 08:55:02] [config] allow-unk: false
[2023-07-29 08:55:02] [config] authors: false
[2023-07-29 08:55:02] [config] beam-size: 12
[2023-07-29 08:55:02] [config] bert-class-symbol: "[CLS]"
[2023-07-29 08:55:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 08:55:02] [config] bert-masking-fraction: 0.15
[2023-07-29 08:55:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 08:55:02] [config] bert-train-type-embeddings: true
[2023-07-29 08:55:02] [config] bert-type-vocab-size: 2
[2023-07-29 08:55:02] [config] build-info: ""
[2023-07-29 08:55:02] [config] check-gradient-nan: false
[2023-07-29 08:55:02] [config] check-nan: false
[2023-07-29 08:55:02] [config] cite: false
[2023-07-29 08:55:02] [config] clip-norm: 1
[2023-07-29 08:55:02] [config] cost-scaling:
[2023-07-29 08:55:02] [config]   - 256.f
[2023-07-29 08:55:02] [config]   - 1000
[2023-07-29 08:55:02] [config]   - 2.f
[2023-07-29 08:55:02] [config]   - 256.f
[2023-07-29 08:55:02] [config] cost-type: ce-sum
[2023-07-29 08:55:02] [config] cpu-threads: 0
[2023-07-29 08:55:02] [config] data-threads: 8
[2023-07-29 08:55:02] [config] data-weighting: ""
[2023-07-29 08:55:02] [config] data-weighting-type: sentence
[2023-07-29 08:55:02] [config] dec-cell: gru
[2023-07-29 08:55:02] [config] dec-cell-base-depth: 2
[2023-07-29 08:55:02] [config] dec-cell-high-depth: 1
[2023-07-29 08:55:02] [config] dec-depth: 1
[2023-07-29 08:55:02] [config] devices:
[2023-07-29 08:55:02] [config]   - 0
[2023-07-29 08:55:02] [config] dim-emb: 512
[2023-07-29 08:55:02] [config] dim-rnn: 1024
[2023-07-29 08:55:02] [config] dim-vocabs:
[2023-07-29 08:55:02] [config]   - 16384
[2023-07-29 08:55:02] [config]   - 16384
[2023-07-29 08:55:02] [config] disp-first: 0
[2023-07-29 08:55:02] [config] disp-freq: 1000u
[2023-07-29 08:55:02] [config] disp-label-counts: true
[2023-07-29 08:55:02] [config] dropout-rnn: 0
[2023-07-29 08:55:02] [config] dropout-src: 0
[2023-07-29 08:55:02] [config] dropout-trg: 0
[2023-07-29 08:55:02] [config] dump-config: ""
[2023-07-29 08:55:02] [config] dynamic-gradient-scaling:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] early-stopping: 1000
[2023-07-29 08:55:02] [config] early-stopping-on: first
[2023-07-29 08:55:02] [config] embedding-fix-src: false
[2023-07-29 08:55:02] [config] embedding-fix-trg: false
[2023-07-29 08:55:02] [config] embedding-normalization: false
[2023-07-29 08:55:02] [config] embedding-vectors:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] enc-cell: gru
[2023-07-29 08:55:02] [config] enc-cell-depth: 1
[2023-07-29 08:55:02] [config] enc-depth: 1
[2023-07-29 08:55:02] [config] enc-type: bidirectional
[2023-07-29 08:55:02] [config] english-title-case-every: 0
[2023-07-29 08:55:02] [config] exponential-smoothing: 0
[2023-07-29 08:55:02] [config] factor-weight: 1
[2023-07-29 08:55:02] [config] factors-combine: sum
[2023-07-29 08:55:02] [config] factors-dim-emb: 0
[2023-07-29 08:55:02] [config] gradient-checkpointing: false
[2023-07-29 08:55:02] [config] gradient-norm-average-window: 100
[2023-07-29 08:55:02] [config] guided-alignment: none
[2023-07-29 08:55:02] [config] guided-alignment-cost: mse
[2023-07-29 08:55:02] [config] guided-alignment-weight: 0.1
[2023-07-29 08:55:02] [config] ignore-model-config: false
[2023-07-29 08:55:02] [config] input-types:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] interpolate-env-vars: false
[2023-07-29 08:55:02] [config] keep-best: false
[2023-07-29 08:55:02] [config] label-smoothing: 0
[2023-07-29 08:55:02] [config] layer-normalization: false
[2023-07-29 08:55:02] [config] learn-rate: 0.0001
[2023-07-29 08:55:02] [config] lemma-dependency: ""
[2023-07-29 08:55:02] [config] lemma-dim-emb: 0
[2023-07-29 08:55:02] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 08:55:02] [config] log-level: info
[2023-07-29 08:55:02] [config] log-time-zone: ""
[2023-07-29 08:55:02] [config] logical-epoch:
[2023-07-29 08:55:02] [config]   - 1e
[2023-07-29 08:55:02] [config]   - 0
[2023-07-29 08:55:02] [config] lr-decay: 0
[2023-07-29 08:55:02] [config] lr-decay-freq: 50000
[2023-07-29 08:55:02] [config] lr-decay-inv-sqrt:
[2023-07-29 08:55:02] [config]   - 0
[2023-07-29 08:55:02] [config] lr-decay-repeat-warmup: false
[2023-07-29 08:55:02] [config] lr-decay-reset-optimizer: false
[2023-07-29 08:55:02] [config] lr-decay-start:
[2023-07-29 08:55:02] [config]   - 10
[2023-07-29 08:55:02] [config]   - 1
[2023-07-29 08:55:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 08:55:02] [config] lr-report: false
[2023-07-29 08:55:02] [config] lr-warmup: 0
[2023-07-29 08:55:02] [config] lr-warmup-at-reload: false
[2023-07-29 08:55:02] [config] lr-warmup-cycle: false
[2023-07-29 08:55:02] [config] lr-warmup-start-rate: 0
[2023-07-29 08:55:02] [config] max-length: 250
[2023-07-29 08:55:02] [config] max-length-crop: true
[2023-07-29 08:55:02] [config] max-length-factor: 3
[2023-07-29 08:55:02] [config] maxi-batch: 100
[2023-07-29 08:55:02] [config] maxi-batch-sort: trg
[2023-07-29 08:55:02] [config] mini-batch: 64
[2023-07-29 08:55:02] [config] mini-batch-fit: true
[2023-07-29 08:55:02] [config] mini-batch-fit-step: 10
[2023-07-29 08:55:02] [config] mini-batch-round-up: true
[2023-07-29 08:55:02] [config] mini-batch-track-lr: false
[2023-07-29 08:55:02] [config] mini-batch-warmup: 0
[2023-07-29 08:55:02] [config] mini-batch-words: 0
[2023-07-29 08:55:02] [config] mini-batch-words-ref: 0
[2023-07-29 08:55:02] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 08:55:02] [config] multi-loss-type: sum
[2023-07-29 08:55:02] [config] n-best: false
[2023-07-29 08:55:02] [config] no-nccl: false
[2023-07-29 08:55:02] [config] no-reload: false
[2023-07-29 08:55:02] [config] no-restore-corpus: false
[2023-07-29 08:55:02] [config] normalize: 0
[2023-07-29 08:55:02] [config] normalize-gradient: false
[2023-07-29 08:55:02] [config] num-devices: 0
[2023-07-29 08:55:02] [config] optimizer: adam
[2023-07-29 08:55:02] [config] optimizer-delay: 1
[2023-07-29 08:55:02] [config] optimizer-params:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] output-omit-bias: false
[2023-07-29 08:55:02] [config] overwrite: true
[2023-07-29 08:55:02] [config] precision:
[2023-07-29 08:55:02] [config]   - float16
[2023-07-29 08:55:02] [config]   - float32
[2023-07-29 08:55:02] [config] pretrained-model: ""
[2023-07-29 08:55:02] [config] quantize-biases: false
[2023-07-29 08:55:02] [config] quantize-bits: 0
[2023-07-29 08:55:02] [config] quantize-log-based: false
[2023-07-29 08:55:02] [config] quantize-optimization-steps: 0
[2023-07-29 08:55:02] [config] quiet: false
[2023-07-29 08:55:02] [config] quiet-translation: true
[2023-07-29 08:55:02] [config] relative-paths: false
[2023-07-29 08:55:02] [config] right-left: false
[2023-07-29 08:55:02] [config] save-freq: 10000u
[2023-07-29 08:55:02] [config] seed: 1234
[2023-07-29 08:55:02] [config] sentencepiece-alphas:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] sentencepiece-max-lines: 2000000
[2023-07-29 08:55:02] [config] sentencepiece-options: ""
[2023-07-29 08:55:02] [config] sharding: global
[2023-07-29 08:55:02] [config] shuffle: data
[2023-07-29 08:55:02] [config] shuffle-in-ram: false
[2023-07-29 08:55:02] [config] sigterm: save-and-exit
[2023-07-29 08:55:02] [config] skip: false
[2023-07-29 08:55:02] [config] sqlite: ""
[2023-07-29 08:55:02] [config] sqlite-drop: false
[2023-07-29 08:55:02] [config] sync-freq: 200u
[2023-07-29 08:55:02] [config] sync-sgd: false
[2023-07-29 08:55:02] [config] tempdir: /tmp
[2023-07-29 08:55:02] [config] tied-embeddings: false
[2023-07-29 08:55:02] [config] tied-embeddings-all: true
[2023-07-29 08:55:02] [config] tied-embeddings-src: false
[2023-07-29 08:55:02] [config] train-embedder-rank:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] train-sets:
[2023-07-29 08:55:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 08:55:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 08:55:02] [config] transformer-aan-activation: swish
[2023-07-29 08:55:02] [config] transformer-aan-depth: 2
[2023-07-29 08:55:02] [config] transformer-aan-nogate: false
[2023-07-29 08:55:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 08:55:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 08:55:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 08:55:02] [config] transformer-depth-scaling: false
[2023-07-29 08:55:02] [config] transformer-dim-aan: 2048
[2023-07-29 08:55:02] [config] transformer-dim-ffn: 2048
[2023-07-29 08:55:02] [config] transformer-dropout: 0
[2023-07-29 08:55:02] [config] transformer-dropout-attention: 0
[2023-07-29 08:55:02] [config] transformer-dropout-ffn: 0
[2023-07-29 08:55:02] [config] transformer-ffn-activation: swish
[2023-07-29 08:55:02] [config] transformer-ffn-depth: 2
[2023-07-29 08:55:02] [config] transformer-guided-alignment-layer: last
[2023-07-29 08:55:02] [config] transformer-heads: 8
[2023-07-29 08:55:02] [config] transformer-no-projection: false
[2023-07-29 08:55:02] [config] transformer-pool: false
[2023-07-29 08:55:02] [config] transformer-postprocess: dan
[2023-07-29 08:55:02] [config] transformer-postprocess-emb: d
[2023-07-29 08:55:02] [config] transformer-postprocess-top: ""
[2023-07-29 08:55:02] [config] transformer-preprocess: ""
[2023-07-29 08:55:02] [config] transformer-tied-layers:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] transformer-train-position-embeddings: false
[2023-07-29 08:55:02] [config] tsv: false
[2023-07-29 08:55:02] [config] tsv-fields: 0
[2023-07-29 08:55:02] [config] type: s2s
[2023-07-29 08:55:02] [config] ulr: false
[2023-07-29 08:55:02] [config] ulr-dim-emb: 0
[2023-07-29 08:55:02] [config] ulr-dropout: 0
[2023-07-29 08:55:02] [config] ulr-keys-vectors: ""
[2023-07-29 08:55:02] [config] ulr-query-vectors: ""
[2023-07-29 08:55:02] [config] ulr-softmax-temperature: 1
[2023-07-29 08:55:02] [config] ulr-trainable-transformation: false
[2023-07-29 08:55:02] [config] unlikelihood-loss: false
[2023-07-29 08:55:02] [config] valid-freq: 50000000
[2023-07-29 08:55:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 08:55:02] [config] valid-max-length: 1000
[2023-07-29 08:55:02] [config] valid-metrics:
[2023-07-29 08:55:02] [config]   - translation
[2023-07-29 08:55:02] [config] valid-mini-batch: 32
[2023-07-29 08:55:02] [config] valid-reset-stalled: false
[2023-07-29 08:55:02] [config] valid-script-args:
[2023-07-29 08:55:02] [config]   []
[2023-07-29 08:55:02] [config] valid-script-path: ""
[2023-07-29 08:55:02] [config] valid-sets:
[2023-07-29 08:55:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 08:55:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 08:55:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 08:55:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 08:55:02] [config] vocabs:
[2023-07-29 08:55:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 08:55:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 08:55:02] [config] word-penalty: 0
[2023-07-29 08:55:02] [config] word-scores: false
[2023-07-29 08:55:02] [config] workspace: 5500
[2023-07-29 08:55:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 08:55:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 08:55:02] [training] Using single-device training
[2023-07-29 08:55:02] Synced seed 1234
[2023-07-29 08:55:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 08:55:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 08:55:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 08:55:02] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 08:55:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 08:55:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 08:55:02] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 08:55:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 08:55:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 08:55:03] [comm] Using global sharding
[2023-07-29 08:55:03] [comm] NCCLCommunicators constructed successfully
[2023-07-29 08:55:03] [training] Using 1 GPUs
[2023-07-29 08:55:03] [logits] Applying loss function for 1 factor(s)
[2023-07-29 08:55:03] [memory] Reserving 80 MB, device gpu0
[2023-07-29 08:55:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 08:55:04] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:45:17] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 09:45:17] [valid] No post-processing script given for validating translator
[2023-07-29 09:45:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 09:45:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 09:45:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 09:45:17] [comm] Using global sharding
[2023-07-29 09:45:17] [comm] NCCLCommunicators constructed successfully
[2023-07-29 09:45:17] [training] Using 1 GPUs
[2023-07-29 09:45:17] Loading model from /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 09:45:18] Allocating memory for general optimizer shards
[2023-07-29 09:45:18] [memory] Reserving 322 MB, device gpu0
[2023-07-29 09:45:18] Loading Adam parameters
[2023-07-29 09:45:18] [memory] Reserving 322 MB, device gpu0
[2023-07-29 09:45:19] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:45:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 09:45:19] [data] Restoring the corpus state to epoch 371, batch 14360
[2023-07-29 09:45:19] [data] Shuffling data
[2023-07-29 09:45:19] [data] Done reading 20,192 sentences
[2023-07-29 09:45:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 09:45:19] Training started
[2023-07-29 09:45:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 09:45:21] [memory] Reserving 80 MB, device gpu0
[2023-07-29 09:45:28] Parameter type float16, optimization type float32, casting types true
[2023-07-29 09:50:01] Seen 20,192 samples
[2023-07-29 09:50:01] Starting data epoch 372 in logical epoch 372
[2023-07-29 09:50:01] [data] Shuffling data
[2023-07-29 09:50:01] [data] Done reading 20,192 sentences
[2023-07-29 09:50:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 09:54:43] Seen 20,192 samples
[2023-07-29 09:54:43] Starting data epoch 373 in logical epoch 373
[2023-07-29 09:54:43] [data] Shuffling data
[2023-07-29 09:54:43] [data] Done reading 20,192 sentences
[2023-07-29 09:54:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 09:59:22] Seen 20,192 samples
[2023-07-29 09:59:22] Starting data epoch 374 in logical epoch 374
[2023-07-29 09:59:22] [data] Shuffling data
[2023-07-29 09:59:22] [data] Done reading 20,192 sentences
[2023-07-29 09:59:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:03:57] Seen 20,192 samples
[2023-07-29 10:03:57] Starting data epoch 375 in logical epoch 375
[2023-07-29 10:03:57] [data] Shuffling data
[2023-07-29 10:03:57] [data] Done reading 20,192 sentences
[2023-07-29 10:03:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:08:41] Seen 20,192 samples
[2023-07-29 10:08:41] Starting data epoch 376 in logical epoch 376
[2023-07-29 10:08:41] [data] Shuffling data
[2023-07-29 10:08:41] [data] Done reading 20,192 sentences
[2023-07-29 10:08:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:13:19] Seen 20,192 samples
[2023-07-29 10:13:19] Starting data epoch 377 in logical epoch 377
[2023-07-29 10:13:19] [data] Shuffling data
[2023-07-29 10:13:19] [data] Done reading 20,192 sentences
[2023-07-29 10:13:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:18:05] Seen 20,192 samples
[2023-07-29 10:18:05] Starting data epoch 378 in logical epoch 378
[2023-07-29 10:18:05] [data] Shuffling data
[2023-07-29 10:18:05] [data] Done reading 20,192 sentences
[2023-07-29 10:18:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:22:41] Seen 20,192 samples
[2023-07-29 10:22:41] Starting data epoch 379 in logical epoch 379
[2023-07-29 10:22:41] [data] Shuffling data
[2023-07-29 10:22:41] [data] Done reading 20,192 sentences
[2023-07-29 10:22:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:27:17] Seen 20,192 samples
[2023-07-29 10:27:17] Starting data epoch 380 in logical epoch 380
[2023-07-29 10:27:17] [data] Shuffling data
[2023-07-29 10:27:17] [data] Done reading 20,192 sentences
[2023-07-29 10:27:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 10:31:54] Seen 20,192 samples
[2023-07-29 10:31:54] Starting data epoch 381 in logical epoch 381
[2023-07-29 10:31:54] Training finished
[2023-07-29 10:33:57] [valid] Ep. 381 : Up. 14747 : translation : 0 : new best
[2023-07-29 10:33:57] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 10:33:59] Saving Adam parameters
[2023-07-29 10:34:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz.optimizer.npz
[2023-07-29 10:34:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 10:34:07] [marian] Running on node18.datos.cluster.uy as process 38911 with command line:
[2023-07-29 10:34:07] [marian] /marian/build/marian --type s2s --devices 0 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz --after-epochs 390 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt --quiet-translation --overwrite --early-stopping 1000 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-29 10:34:07] [config] after: 0e
[2023-07-29 10:34:07] [config] after-batches: 0
[2023-07-29 10:34:07] [config] after-epochs: 390
[2023-07-29 10:34:07] [config] all-caps-every: 0
[2023-07-29 10:34:07] [config] allow-unk: false
[2023-07-29 10:34:07] [config] authors: false
[2023-07-29 10:34:07] [config] beam-size: 12
[2023-07-29 10:34:07] [config] bert-class-symbol: "[CLS]"
[2023-07-29 10:34:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-29 10:34:07] [config] bert-masking-fraction: 0.15
[2023-07-29 10:34:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-29 10:34:07] [config] bert-train-type-embeddings: true
[2023-07-29 10:34:07] [config] bert-type-vocab-size: 2
[2023-07-29 10:34:07] [config] build-info: ""
[2023-07-29 10:34:07] [config] check-gradient-nan: false
[2023-07-29 10:34:07] [config] check-nan: false
[2023-07-29 10:34:07] [config] cite: false
[2023-07-29 10:34:07] [config] clip-norm: 1
[2023-07-29 10:34:07] [config] cost-scaling:
[2023-07-29 10:34:07] [config]   - 256.f
[2023-07-29 10:34:07] [config]   - 1000
[2023-07-29 10:34:07] [config]   - 2.f
[2023-07-29 10:34:07] [config]   - 256.f
[2023-07-29 10:34:07] [config] cost-type: ce-sum
[2023-07-29 10:34:07] [config] cpu-threads: 0
[2023-07-29 10:34:07] [config] data-threads: 8
[2023-07-29 10:34:07] [config] data-weighting: ""
[2023-07-29 10:34:07] [config] data-weighting-type: sentence
[2023-07-29 10:34:07] [config] dec-cell: gru
[2023-07-29 10:34:07] [config] dec-cell-base-depth: 2
[2023-07-29 10:34:07] [config] dec-cell-high-depth: 1
[2023-07-29 10:34:07] [config] dec-depth: 1
[2023-07-29 10:34:07] [config] devices:
[2023-07-29 10:34:07] [config]   - 0
[2023-07-29 10:34:07] [config] dim-emb: 512
[2023-07-29 10:34:07] [config] dim-rnn: 1024
[2023-07-29 10:34:07] [config] dim-vocabs:
[2023-07-29 10:34:07] [config]   - 16384
[2023-07-29 10:34:07] [config]   - 16384
[2023-07-29 10:34:07] [config] disp-first: 0
[2023-07-29 10:34:07] [config] disp-freq: 1000u
[2023-07-29 10:34:07] [config] disp-label-counts: true
[2023-07-29 10:34:07] [config] dropout-rnn: 0
[2023-07-29 10:34:07] [config] dropout-src: 0
[2023-07-29 10:34:07] [config] dropout-trg: 0
[2023-07-29 10:34:07] [config] dump-config: ""
[2023-07-29 10:34:07] [config] dynamic-gradient-scaling:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] early-stopping: 1000
[2023-07-29 10:34:07] [config] early-stopping-on: first
[2023-07-29 10:34:07] [config] embedding-fix-src: false
[2023-07-29 10:34:07] [config] embedding-fix-trg: false
[2023-07-29 10:34:07] [config] embedding-normalization: false
[2023-07-29 10:34:07] [config] embedding-vectors:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] enc-cell: gru
[2023-07-29 10:34:07] [config] enc-cell-depth: 1
[2023-07-29 10:34:07] [config] enc-depth: 1
[2023-07-29 10:34:07] [config] enc-type: bidirectional
[2023-07-29 10:34:07] [config] english-title-case-every: 0
[2023-07-29 10:34:07] [config] exponential-smoothing: 0
[2023-07-29 10:34:07] [config] factor-weight: 1
[2023-07-29 10:34:07] [config] factors-combine: sum
[2023-07-29 10:34:07] [config] factors-dim-emb: 0
[2023-07-29 10:34:07] [config] gradient-checkpointing: false
[2023-07-29 10:34:07] [config] gradient-norm-average-window: 100
[2023-07-29 10:34:07] [config] guided-alignment: none
[2023-07-29 10:34:07] [config] guided-alignment-cost: mse
[2023-07-29 10:34:07] [config] guided-alignment-weight: 0.1
[2023-07-29 10:34:07] [config] ignore-model-config: false
[2023-07-29 10:34:07] [config] input-types:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] interpolate-env-vars: false
[2023-07-29 10:34:07] [config] keep-best: false
[2023-07-29 10:34:07] [config] label-smoothing: 0
[2023-07-29 10:34:07] [config] layer-normalization: false
[2023-07-29 10:34:07] [config] learn-rate: 0.0001
[2023-07-29 10:34:07] [config] lemma-dependency: ""
[2023-07-29 10:34:07] [config] lemma-dim-emb: 0
[2023-07-29 10:34:07] [config] log: /docker/home/marianmt/logs/marian/log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 10:34:07] [config] log-level: info
[2023-07-29 10:34:07] [config] log-time-zone: ""
[2023-07-29 10:34:07] [config] logical-epoch:
[2023-07-29 10:34:07] [config]   - 1e
[2023-07-29 10:34:07] [config]   - 0
[2023-07-29 10:34:07] [config] lr-decay: 0
[2023-07-29 10:34:07] [config] lr-decay-freq: 50000
[2023-07-29 10:34:07] [config] lr-decay-inv-sqrt:
[2023-07-29 10:34:07] [config]   - 0
[2023-07-29 10:34:07] [config] lr-decay-repeat-warmup: false
[2023-07-29 10:34:07] [config] lr-decay-reset-optimizer: false
[2023-07-29 10:34:07] [config] lr-decay-start:
[2023-07-29 10:34:07] [config]   - 10
[2023-07-29 10:34:07] [config]   - 1
[2023-07-29 10:34:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-29 10:34:07] [config] lr-report: false
[2023-07-29 10:34:07] [config] lr-warmup: 0
[2023-07-29 10:34:07] [config] lr-warmup-at-reload: false
[2023-07-29 10:34:07] [config] lr-warmup-cycle: false
[2023-07-29 10:34:07] [config] lr-warmup-start-rate: 0
[2023-07-29 10:34:07] [config] max-length: 250
[2023-07-29 10:34:07] [config] max-length-crop: true
[2023-07-29 10:34:07] [config] max-length-factor: 3
[2023-07-29 10:34:07] [config] maxi-batch: 100
[2023-07-29 10:34:07] [config] maxi-batch-sort: trg
[2023-07-29 10:34:07] [config] mini-batch: 64
[2023-07-29 10:34:07] [config] mini-batch-fit: true
[2023-07-29 10:34:07] [config] mini-batch-fit-step: 10
[2023-07-29 10:34:07] [config] mini-batch-round-up: true
[2023-07-29 10:34:07] [config] mini-batch-track-lr: false
[2023-07-29 10:34:07] [config] mini-batch-warmup: 0
[2023-07-29 10:34:07] [config] mini-batch-words: 0
[2023-07-29 10:34:07] [config] mini-batch-words-ref: 0
[2023-07-29 10:34:07] [config] model: /docker/home/marianmt/artifacts/models/model_lvl2_grid_gn_es_s2s_from16_to18/lvl2_grid_gn_es_s2s_from16_to18_max-length_250.npz
[2023-07-29 10:34:07] [config] multi-loss-type: sum
[2023-07-29 10:34:07] [config] n-best: false
[2023-07-29 10:34:07] [config] no-nccl: false
[2023-07-29 10:34:07] [config] no-reload: false
[2023-07-29 10:34:07] [config] no-restore-corpus: false
[2023-07-29 10:34:07] [config] normalize: 0
[2023-07-29 10:34:07] [config] normalize-gradient: false
[2023-07-29 10:34:07] [config] num-devices: 0
[2023-07-29 10:34:07] [config] optimizer: adam
[2023-07-29 10:34:07] [config] optimizer-delay: 1
[2023-07-29 10:34:07] [config] optimizer-params:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] output-omit-bias: false
[2023-07-29 10:34:07] [config] overwrite: true
[2023-07-29 10:34:07] [config] precision:
[2023-07-29 10:34:07] [config]   - float16
[2023-07-29 10:34:07] [config]   - float32
[2023-07-29 10:34:07] [config] pretrained-model: ""
[2023-07-29 10:34:07] [config] quantize-biases: false
[2023-07-29 10:34:07] [config] quantize-bits: 0
[2023-07-29 10:34:07] [config] quantize-log-based: false
[2023-07-29 10:34:07] [config] quantize-optimization-steps: 0
[2023-07-29 10:34:07] [config] quiet: false
[2023-07-29 10:34:07] [config] quiet-translation: true
[2023-07-29 10:34:07] [config] relative-paths: false
[2023-07-29 10:34:07] [config] right-left: false
[2023-07-29 10:34:07] [config] save-freq: 10000u
[2023-07-29 10:34:07] [config] seed: 1234
[2023-07-29 10:34:07] [config] sentencepiece-alphas:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] sentencepiece-max-lines: 2000000
[2023-07-29 10:34:07] [config] sentencepiece-options: ""
[2023-07-29 10:34:07] [config] sharding: global
[2023-07-29 10:34:07] [config] shuffle: data
[2023-07-29 10:34:07] [config] shuffle-in-ram: false
[2023-07-29 10:34:07] [config] sigterm: save-and-exit
[2023-07-29 10:34:07] [config] skip: false
[2023-07-29 10:34:07] [config] sqlite: ""
[2023-07-29 10:34:07] [config] sqlite-drop: false
[2023-07-29 10:34:07] [config] sync-freq: 200u
[2023-07-29 10:34:07] [config] sync-sgd: false
[2023-07-29 10:34:07] [config] tempdir: /tmp
[2023-07-29 10:34:07] [config] tied-embeddings: false
[2023-07-29 10:34:07] [config] tied-embeddings-all: true
[2023-07-29 10:34:07] [config] tied-embeddings-src: false
[2023-07-29 10:34:07] [config] train-embedder-rank:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] train-sets:
[2023-07-29 10:34:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-29 10:34:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-29 10:34:07] [config] transformer-aan-activation: swish
[2023-07-29 10:34:07] [config] transformer-aan-depth: 2
[2023-07-29 10:34:07] [config] transformer-aan-nogate: false
[2023-07-29 10:34:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-29 10:34:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-29 10:34:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-29 10:34:07] [config] transformer-depth-scaling: false
[2023-07-29 10:34:07] [config] transformer-dim-aan: 2048
[2023-07-29 10:34:07] [config] transformer-dim-ffn: 2048
[2023-07-29 10:34:07] [config] transformer-dropout: 0
[2023-07-29 10:34:07] [config] transformer-dropout-attention: 0
[2023-07-29 10:34:07] [config] transformer-dropout-ffn: 0
[2023-07-29 10:34:07] [config] transformer-ffn-activation: swish
[2023-07-29 10:34:07] [config] transformer-ffn-depth: 2
[2023-07-29 10:34:07] [config] transformer-guided-alignment-layer: last
[2023-07-29 10:34:07] [config] transformer-heads: 8
[2023-07-29 10:34:07] [config] transformer-no-projection: false
[2023-07-29 10:34:07] [config] transformer-pool: false
[2023-07-29 10:34:07] [config] transformer-postprocess: dan
[2023-07-29 10:34:07] [config] transformer-postprocess-emb: d
[2023-07-29 10:34:07] [config] transformer-postprocess-top: ""
[2023-07-29 10:34:07] [config] transformer-preprocess: ""
[2023-07-29 10:34:07] [config] transformer-tied-layers:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] transformer-train-position-embeddings: false
[2023-07-29 10:34:07] [config] tsv: false
[2023-07-29 10:34:07] [config] tsv-fields: 0
[2023-07-29 10:34:07] [config] type: s2s
[2023-07-29 10:34:07] [config] ulr: false
[2023-07-29 10:34:07] [config] ulr-dim-emb: 0
[2023-07-29 10:34:07] [config] ulr-dropout: 0
[2023-07-29 10:34:07] [config] ulr-keys-vectors: ""
[2023-07-29 10:34:07] [config] ulr-query-vectors: ""
[2023-07-29 10:34:07] [config] ulr-softmax-temperature: 1
[2023-07-29 10:34:07] [config] ulr-trainable-transformation: false
[2023-07-29 10:34:07] [config] unlikelihood-loss: false
[2023-07-29 10:34:07] [config] valid-freq: 50000000
[2023-07-29 10:34:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_lvl2_grid_gn_es_s2s_from16_to18.log
[2023-07-29 10:34:07] [config] valid-max-length: 1000
[2023-07-29 10:34:07] [config] valid-metrics:
[2023-07-29 10:34:07] [config]   - translation
[2023-07-29 10:34:07] [config] valid-mini-batch: 32
[2023-07-29 10:34:07] [config] valid-reset-stalled: false
[2023-07-29 10:34:07] [config] valid-script-args:
[2023-07-29 10:34:07] [config]   []
[2023-07-29 10:34:07] [config] valid-script-path: ""
[2023-07-29 10:34:07] [config] valid-sets:
[2023-07-29 10:34:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-29 10:34:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-29 10:34:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_grid_gn_es_s2s_from16_to18.txt
[2023-07-29 10:34:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 10:34:07] [config] vocabs:
[2023-07-29 10:34:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 10:34:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 10:34:07] [config] word-penalty: 0
[2023-07-29 10:34:07] [config] word-scores: false
[2023-07-29 10:34:07] [config] workspace: 5500
[2023-07-29 10:34:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-29 10:34:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 10:34:07] [training] Using single-device training
[2023-07-29 10:34:07] Synced seed 1234
[2023-07-29 10:34:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-29 10:34:07] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-29 10:34:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-29 10:34:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-29 10:34:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-29 10:34:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 10:34:07] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-29 10:34:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 10:34:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 10:34:08] [comm] Using global sharding
[2023-07-29 10:34:08] [comm] NCCLCommunicators constructed successfully
[2023-07-29 10:34:08] [training] Using 1 GPUs
[2023-07-29 10:34:08] [logits] Applying loss function for 1 factor(s)
[2023-07-29 10:34:08] [memory] Reserving 80 MB, device gpu0
[2023-07-29 10:34:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-29 10:34:09] [memory] Reserving 80 MB, device gpu0
[2023-07-29 11:24:26] [batching] Done. Typical MB size is 35,869 target words
[2023-07-29 11:24:26] [valid] No post-processing script given for validating translator
[2023-07-29 11:24:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-29 11:24:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-29 11:24:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-29 11:24:27] [comm] Using global sharding
[2023-07-29 11:24:27] [comm] NCCLCommunicators constructed successfully
[2023-07-29 11:24:27] [training] Using 1 GPUs
[2023-07-29 11:24:27] Training started
[2023-07-29 11:24:27] [data] Shuffling data
[2023-07-29 11:24:27] [data] Done reading 20,192 sentences
[2023-07-29 11:24:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:24:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-29 11:24:27] [memory] Reserving 80 MB, device gpu0
[2023-07-29 11:24:29] [memory] Reserving 80 MB, device gpu0
[2023-07-29 11:24:39] Parameter type float16, optimization type float32, casting types true
[2023-07-29 11:24:39] Allocating memory for general optimizer shards
[2023-07-29 11:24:39] [memory] Reserving 322 MB, device gpu0
[2023-07-29 11:24:39] Allocating memory for Adam-specific shards
[2023-07-29 11:24:39] [memory] Reserving 322 MB, device gpu0
[2023-07-29 11:28:43] Seen 20,192 samples
[2023-07-29 11:28:43] Starting data epoch 2 in logical epoch 2
[2023-07-29 11:28:43] [data] Shuffling data
[2023-07-29 11:28:43] [data] Done reading 20,192 sentences
[2023-07-29 11:28:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:33:53] Seen 20,192 samples
[2023-07-29 11:33:53] Starting data epoch 3 in logical epoch 3
[2023-07-29 11:33:53] [data] Shuffling data
[2023-07-29 11:33:53] [data] Done reading 20,192 sentences
[2023-07-29 11:33:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:39:01] Seen 20,192 samples
[2023-07-29 11:39:01] Starting data epoch 4 in logical epoch 4
[2023-07-29 11:39:01] [data] Shuffling data
[2023-07-29 11:39:01] [data] Done reading 20,192 sentences
[2023-07-29 11:39:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:43:27] Seen 20,192 samples
[2023-07-29 11:43:27] Starting data epoch 5 in logical epoch 5
[2023-07-29 11:43:27] [data] Shuffling data
[2023-07-29 11:43:27] [data] Done reading 20,192 sentences
[2023-07-29 11:43:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:48:08] Seen 20,192 samples
[2023-07-29 11:48:08] Starting data epoch 6 in logical epoch 6
[2023-07-29 11:48:08] [data] Shuffling data
[2023-07-29 11:48:08] [data] Done reading 20,192 sentences
[2023-07-29 11:48:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:52:30] Seen 20,192 samples
[2023-07-29 11:52:30] Starting data epoch 7 in logical epoch 7
[2023-07-29 11:52:30] [data] Shuffling data
[2023-07-29 11:52:30] [data] Done reading 20,192 sentences
[2023-07-29 11:52:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 11:56:46] Seen 20,192 samples
[2023-07-29 11:56:46] Starting data epoch 8 in logical epoch 8
[2023-07-29 11:56:46] [data] Shuffling data
[2023-07-29 11:56:46] [data] Done reading 20,192 sentences
[2023-07-29 11:56:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:01:14] Seen 20,192 samples
[2023-07-29 12:01:14] Starting data epoch 9 in logical epoch 9
[2023-07-29 12:01:14] [data] Shuffling data
[2023-07-29 12:01:14] [data] Done reading 20,192 sentences
[2023-07-29 12:01:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:05:39] Seen 20,192 samples
[2023-07-29 12:05:39] Starting data epoch 10 in logical epoch 10
[2023-07-29 12:05:39] [data] Shuffling data
[2023-07-29 12:05:39] [data] Done reading 20,192 sentences
[2023-07-29 12:05:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:09:55] Seen 20,192 samples
[2023-07-29 12:09:55] Starting data epoch 11 in logical epoch 11
[2023-07-29 12:09:55] [data] Shuffling data
[2023-07-29 12:09:55] [data] Done reading 20,192 sentences
[2023-07-29 12:09:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:14:16] Seen 20,192 samples
[2023-07-29 12:14:17] Starting data epoch 12 in logical epoch 12
[2023-07-29 12:14:17] [data] Shuffling data
[2023-07-29 12:14:17] [data] Done reading 20,192 sentences
[2023-07-29 12:14:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:18:38] Seen 20,192 samples
[2023-07-29 12:18:38] Starting data epoch 13 in logical epoch 13
[2023-07-29 12:18:38] [data] Shuffling data
[2023-07-29 12:18:38] [data] Done reading 20,192 sentences
[2023-07-29 12:18:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:23:11] Seen 20,192 samples
[2023-07-29 12:23:11] Starting data epoch 14 in logical epoch 14
[2023-07-29 12:23:11] [data] Shuffling data
[2023-07-29 12:23:11] [data] Done reading 20,192 sentences
[2023-07-29 12:23:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:28:15] Seen 20,192 samples
[2023-07-29 12:28:15] Starting data epoch 15 in logical epoch 15
[2023-07-29 12:28:15] [data] Shuffling data
[2023-07-29 12:28:15] [data] Done reading 20,192 sentences
[2023-07-29 12:28:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:33:07] Seen 20,192 samples
[2023-07-29 12:33:07] Starting data epoch 16 in logical epoch 16
[2023-07-29 12:33:07] [data] Shuffling data
[2023-07-29 12:33:07] [data] Done reading 20,192 sentences
[2023-07-29 12:33:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:38:09] Seen 20,192 samples
[2023-07-29 12:38:09] Starting data epoch 17 in logical epoch 17
[2023-07-29 12:38:09] [data] Shuffling data
[2023-07-29 12:38:09] [data] Done reading 20,192 sentences
[2023-07-29 12:38:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:42:56] Seen 20,192 samples
[2023-07-29 12:42:56] Starting data epoch 18 in logical epoch 18
[2023-07-29 12:42:56] [data] Shuffling data
[2023-07-29 12:42:56] [data] Done reading 20,192 sentences
[2023-07-29 12:42:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:48:01] Seen 20,192 samples
[2023-07-29 12:48:01] Starting data epoch 19 in logical epoch 19
[2023-07-29 12:48:01] [data] Shuffling data
[2023-07-29 12:48:01] [data] Done reading 20,192 sentences
[2023-07-29 12:48:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:52:39] Seen 20,192 samples
[2023-07-29 12:52:39] Starting data epoch 20 in logical epoch 20
[2023-07-29 12:52:39] [data] Shuffling data
[2023-07-29 12:52:39] [data] Done reading 20,192 sentences
[2023-07-29 12:52:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 12:57:06] Seen 20,192 samples
[2023-07-29 12:57:06] Starting data epoch 21 in logical epoch 21
[2023-07-29 12:57:06] [data] Shuffling data
[2023-07-29 12:57:06] [data] Done reading 20,192 sentences
[2023-07-29 12:57:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 13:01:46] Seen 20,192 samples
[2023-07-29 13:01:46] Starting data epoch 22 in logical epoch 22
[2023-07-29 13:01:46] [data] Shuffling data
[2023-07-29 13:01:46] [data] Done reading 20,192 sentences
[2023-07-29 13:01:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 13:06:18] Seen 20,192 samples
[2023-07-29 13:06:18] Starting data epoch 23 in logical epoch 23
[2023-07-29 13:06:18] [data] Shuffling data
[2023-07-29 13:06:18] [data] Done reading 20,192 sentences
[2023-07-29 13:06:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-29 13:11:01] Seen 20,192 samples
[2023-07-29 13:11:01] Starting data epoch 24 in logical epoch 24
[2023-07-29 13:11:01] [data] Shuffling data
[2023-07-29 13:11:01] [data] Done reading 20,192 sentences
[2023-07-29 13:11:01] [data] Done shuffling 20,192 sentences to temp files
