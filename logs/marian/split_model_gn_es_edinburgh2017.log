[2023-06-24 13:17:17] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:17] [marian] Running on node07.datos.cluster.uy as process 6917 with command line:
[2023-06-24 13:17:17] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:17] [config] after: 0e
[2023-06-24 13:17:17] [config] after-batches: 0
[2023-06-24 13:17:17] [config] after-epochs: 10
[2023-06-24 13:17:17] [config] all-caps-every: 0
[2023-06-24 13:17:17] [config] allow-unk: false
[2023-06-24 13:17:17] [config] authors: false
[2023-06-24 13:17:17] [config] beam-size: 12
[2023-06-24 13:17:17] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:17] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:17] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:17] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:17] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:17] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:17] [config] build-info: ""
[2023-06-24 13:17:17] [config] check-gradient-nan: false
[2023-06-24 13:17:17] [config] check-nan: false
[2023-06-24 13:17:17] [config] cite: false
[2023-06-24 13:17:17] [config] clip-norm: 5
[2023-06-24 13:17:17] [config] cost-scaling:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] cost-type: ce-mean-words
[2023-06-24 13:17:17] [config] cpu-threads: 0
[2023-06-24 13:17:17] [config] data-threads: 8
[2023-06-24 13:17:17] [config] data-weighting: ""
[2023-06-24 13:17:17] [config] data-weighting-type: sentence
[2023-06-24 13:17:17] [config] dec-cell: gru
[2023-06-24 13:17:17] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:17] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:17] [config] dec-depth: 1
[2023-06-24 13:17:17] [config] devices:
[2023-06-24 13:17:17] [config]   - 0
[2023-06-24 13:17:17] [config] dim-emb: 512
[2023-06-24 13:17:17] [config] dim-rnn: 1024
[2023-06-24 13:17:17] [config] dim-vocabs:
[2023-06-24 13:17:17] [config]   - 0
[2023-06-24 13:17:17] [config]   - 0
[2023-06-24 13:17:17] [config] disp-first: 0
[2023-06-24 13:17:17] [config] disp-freq: 1000u
[2023-06-24 13:17:17] [config] disp-label-counts: true
[2023-06-24 13:17:17] [config] dropout-rnn: 0.1
[2023-06-24 13:17:17] [config] dropout-src: 0
[2023-06-24 13:17:17] [config] dropout-trg: 0
[2023-06-24 13:17:17] [config] dump-config: ""
[2023-06-24 13:17:17] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] early-stopping: 10
[2023-06-24 13:17:17] [config] early-stopping-on: first
[2023-06-24 13:17:17] [config] embedding-fix-src: false
[2023-06-24 13:17:17] [config] embedding-fix-trg: false
[2023-06-24 13:17:17] [config] embedding-normalization: false
[2023-06-24 13:17:17] [config] embedding-vectors:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] enc-cell: gru
[2023-06-24 13:17:17] [config] enc-cell-depth: 4
[2023-06-24 13:17:17] [config] enc-depth: 1
[2023-06-24 13:17:17] [config] enc-type: bidirectional
[2023-06-24 13:17:17] [config] english-title-case-every: 0
[2023-06-24 13:17:17] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:17] [config] factor-weight: 1
[2023-06-24 13:17:17] [config] factors-combine: sum
[2023-06-24 13:17:17] [config] factors-dim-emb: 0
[2023-06-24 13:17:17] [config] gradient-checkpointing: false
[2023-06-24 13:17:17] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:17] [config] guided-alignment: none
[2023-06-24 13:17:17] [config] guided-alignment-cost: mse
[2023-06-24 13:17:17] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:17] [config] ignore-model-config: false
[2023-06-24 13:17:17] [config] input-types:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] interpolate-env-vars: false
[2023-06-24 13:17:17] [config] keep-best: false
[2023-06-24 13:17:17] [config] label-smoothing: 0.1
[2023-06-24 13:17:17] [config] layer-normalization: true
[2023-06-24 13:17:17] [config] learn-rate: 0.0003
[2023-06-24 13:17:17] [config] lemma-dependency: ""
[2023-06-24 13:17:17] [config] lemma-dim-emb: 0
[2023-06-24 13:17:17] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:17] [config] log-level: info
[2023-06-24 13:17:17] [config] log-time-zone: ""
[2023-06-24 13:17:17] [config] logical-epoch:
[2023-06-24 13:17:17] [config]   - 1e
[2023-06-24 13:17:17] [config]   - 0
[2023-06-24 13:17:17] [config] lr-decay: 0
[2023-06-24 13:17:17] [config] lr-decay-freq: 50000
[2023-06-24 13:17:17] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:17] [config]   - 16000
[2023-06-24 13:17:17] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:17] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:17] [config] lr-decay-start:
[2023-06-24 13:17:17] [config]   - 10
[2023-06-24 13:17:17] [config]   - 1
[2023-06-24 13:17:17] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:17] [config] lr-report: false
[2023-06-24 13:17:17] [config] lr-warmup: 0
[2023-06-24 13:17:17] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:17] [config] lr-warmup-cycle: false
[2023-06-24 13:17:17] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:17] [config] max-length: 100
[2023-06-24 13:17:17] [config] max-length-crop: false
[2023-06-24 13:17:17] [config] max-length-factor: 3
[2023-06-24 13:17:17] [config] maxi-batch: 1000
[2023-06-24 13:17:17] [config] maxi-batch-sort: trg
[2023-06-24 13:17:17] [config] mini-batch: 1000
[2023-06-24 13:17:17] [config] mini-batch-fit: true
[2023-06-24 13:17:17] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:17] [config] mini-batch-round-up: true
[2023-06-24 13:17:17] [config] mini-batch-track-lr: false
[2023-06-24 13:17:17] [config] mini-batch-warmup: 0
[2023-06-24 13:17:17] [config] mini-batch-words: 0
[2023-06-24 13:17:17] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:17] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:17] [config] multi-loss-type: sum
[2023-06-24 13:17:17] [config] n-best: false
[2023-06-24 13:17:17] [config] no-nccl: false
[2023-06-24 13:17:17] [config] no-reload: false
[2023-06-24 13:17:17] [config] no-restore-corpus: false
[2023-06-24 13:17:17] [config] normalize: 1
[2023-06-24 13:17:17] [config] normalize-gradient: false
[2023-06-24 13:17:17] [config] num-devices: 0
[2023-06-24 13:17:17] [config] optimizer: adam
[2023-06-24 13:17:17] [config] optimizer-delay: 1
[2023-06-24 13:17:17] [config] optimizer-params:
[2023-06-24 13:17:17] [config]   - 0.9
[2023-06-24 13:17:17] [config]   - 0.98
[2023-06-24 13:17:17] [config]   - 1e-09
[2023-06-24 13:17:17] [config] output-omit-bias: false
[2023-06-24 13:17:17] [config] overwrite: false
[2023-06-24 13:17:17] [config] precision:
[2023-06-24 13:17:17] [config]   - float32
[2023-06-24 13:17:17] [config]   - float32
[2023-06-24 13:17:17] [config] pretrained-model: ""
[2023-06-24 13:17:17] [config] quantize-biases: false
[2023-06-24 13:17:17] [config] quantize-bits: 0
[2023-06-24 13:17:17] [config] quantize-log-based: false
[2023-06-24 13:17:17] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:17] [config] quiet: false
[2023-06-24 13:17:17] [config] quiet-translation: true
[2023-06-24 13:17:17] [config] relative-paths: false
[2023-06-24 13:17:17] [config] right-left: false
[2023-06-24 13:17:17] [config] save-freq: 10000u
[2023-06-24 13:17:17] [config] seed: 1234
[2023-06-24 13:17:17] [config] sentencepiece-alphas:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:17] [config] sentencepiece-options: ""
[2023-06-24 13:17:17] [config] sharding: global
[2023-06-24 13:17:17] [config] shuffle: data
[2023-06-24 13:17:17] [config] shuffle-in-ram: false
[2023-06-24 13:17:17] [config] sigterm: save-and-exit
[2023-06-24 13:17:17] [config] skip: false
[2023-06-24 13:17:17] [config] sqlite: ""
[2023-06-24 13:17:17] [config] sqlite-drop: false
[2023-06-24 13:17:17] [config] sync-freq: 200u
[2023-06-24 13:17:17] [config] sync-sgd: true
[2023-06-24 13:17:17] [config] tempdir: /tmp
[2023-06-24 13:17:17] [config] tied-embeddings: false
[2023-06-24 13:17:17] [config] tied-embeddings-all: true
[2023-06-24 13:17:17] [config] tied-embeddings-src: false
[2023-06-24 13:17:17] [config] train-embedder-rank:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] train-sets:
[2023-06-24 13:17:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:17] [config] transformer-aan-activation: swish
[2023-06-24 13:17:17] [config] transformer-aan-depth: 2
[2023-06-24 13:17:17] [config] transformer-aan-nogate: false
[2023-06-24 13:17:17] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:17] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:17] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:17] [config] transformer-depth-scaling: false
[2023-06-24 13:17:17] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:17] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:17] [config] transformer-dropout: 0
[2023-06-24 13:17:17] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:17] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:17] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:17] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:17] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:17] [config] transformer-heads: 8
[2023-06-24 13:17:17] [config] transformer-no-projection: false
[2023-06-24 13:17:17] [config] transformer-pool: false
[2023-06-24 13:17:17] [config] transformer-postprocess: dan
[2023-06-24 13:17:17] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:17] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:17] [config] transformer-preprocess: ""
[2023-06-24 13:17:17] [config] transformer-tied-layers:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:17] [config] tsv: false
[2023-06-24 13:17:17] [config] tsv-fields: 0
[2023-06-24 13:17:17] [config] type: s2s
[2023-06-24 13:17:17] [config] ulr: false
[2023-06-24 13:17:17] [config] ulr-dim-emb: 0
[2023-06-24 13:17:17] [config] ulr-dropout: 0
[2023-06-24 13:17:17] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:17] [config] ulr-query-vectors: ""
[2023-06-24 13:17:17] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:17] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:17] [config] unlikelihood-loss: false
[2023-06-24 13:17:17] [config] valid-freq: 5000000
[2023-06-24 13:17:17] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:17] [config] valid-max-length: 1000
[2023-06-24 13:17:17] [config] valid-metrics:
[2023-06-24 13:17:17] [config]   - cross-entropy
[2023-06-24 13:17:17] [config]   - translation
[2023-06-24 13:17:17] [config] valid-mini-batch: 32
[2023-06-24 13:17:17] [config] valid-reset-stalled: false
[2023-06-24 13:17:17] [config] valid-script-args:
[2023-06-24 13:17:17] [config]   []
[2023-06-24 13:17:17] [config] valid-script-path: ""
[2023-06-24 13:17:17] [config] valid-sets:
[2023-06-24 13:17:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:17] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:17] [config] vocabs:
[2023-06-24 13:17:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:17] [config] word-penalty: 0
[2023-06-24 13:17:17] [config] word-scores: false
[2023-06-24 13:17:17] [config] workspace: 9500
[2023-06-24 13:17:17] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:17] Using synchronous SGD
[2023-06-24 13:17:19] Synced seed 1234
[2023-06-24 13:17:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:20] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:17:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:20] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:17:20] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:17:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:17:21] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:17:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:17:21] [comm] Using global sharding
[2023-06-24 13:17:21] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:17:21] [training] Using 1 GPUs
[2023-06-24 13:17:21] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:17:21] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x56286ef4ef01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x56286f6e41fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x56286f6e4d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x56286f6e5785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x56286f362f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x56286f3e8d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x56286f3d577c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x56286eea681d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x56286f482306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x56286f45ef2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x56286ef60450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x56286ee82058]    mainTrainer  (int,  char**)                        + 0x158
[0x56286ee39b9c]    main                                               + 0x3c
[0x7f1f0f7f90b3]    __libc_start_main                                  + 0xf3
[0x56286ee80cbe]    _start                                             + 0x2e

[2023-06-24 13:17:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:26] [marian] Running on node07.datos.cluster.uy as process 6952 with command line:
[2023-06-24 13:17:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:26] [config] after: 0e
[2023-06-24 13:17:26] [config] after-batches: 0
[2023-06-24 13:17:26] [config] after-epochs: 20
[2023-06-24 13:17:26] [config] all-caps-every: 0
[2023-06-24 13:17:26] [config] allow-unk: false
[2023-06-24 13:17:26] [config] authors: false
[2023-06-24 13:17:26] [config] beam-size: 12
[2023-06-24 13:17:26] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:26] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:26] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:26] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:26] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:26] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:26] [config] build-info: ""
[2023-06-24 13:17:26] [config] check-gradient-nan: false
[2023-06-24 13:17:26] [config] check-nan: false
[2023-06-24 13:17:26] [config] cite: false
[2023-06-24 13:17:26] [config] clip-norm: 5
[2023-06-24 13:17:26] [config] cost-scaling:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] cost-type: ce-mean-words
[2023-06-24 13:17:26] [config] cpu-threads: 0
[2023-06-24 13:17:26] [config] data-threads: 8
[2023-06-24 13:17:26] [config] data-weighting: ""
[2023-06-24 13:17:26] [config] data-weighting-type: sentence
[2023-06-24 13:17:26] [config] dec-cell: gru
[2023-06-24 13:17:26] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:26] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:26] [config] dec-depth: 1
[2023-06-24 13:17:26] [config] devices:
[2023-06-24 13:17:26] [config]   - 0
[2023-06-24 13:17:26] [config] dim-emb: 512
[2023-06-24 13:17:26] [config] dim-rnn: 1024
[2023-06-24 13:17:26] [config] dim-vocabs:
[2023-06-24 13:17:26] [config]   - 0
[2023-06-24 13:17:26] [config]   - 0
[2023-06-24 13:17:26] [config] disp-first: 0
[2023-06-24 13:17:26] [config] disp-freq: 1000u
[2023-06-24 13:17:26] [config] disp-label-counts: true
[2023-06-24 13:17:26] [config] dropout-rnn: 0.1
[2023-06-24 13:17:26] [config] dropout-src: 0
[2023-06-24 13:17:26] [config] dropout-trg: 0
[2023-06-24 13:17:26] [config] dump-config: ""
[2023-06-24 13:17:26] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] early-stopping: 10
[2023-06-24 13:17:26] [config] early-stopping-on: first
[2023-06-24 13:17:26] [config] embedding-fix-src: false
[2023-06-24 13:17:26] [config] embedding-fix-trg: false
[2023-06-24 13:17:26] [config] embedding-normalization: false
[2023-06-24 13:17:26] [config] embedding-vectors:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] enc-cell: gru
[2023-06-24 13:17:26] [config] enc-cell-depth: 4
[2023-06-24 13:17:26] [config] enc-depth: 1
[2023-06-24 13:17:26] [config] enc-type: bidirectional
[2023-06-24 13:17:26] [config] english-title-case-every: 0
[2023-06-24 13:17:26] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:26] [config] factor-weight: 1
[2023-06-24 13:17:26] [config] factors-combine: sum
[2023-06-24 13:17:26] [config] factors-dim-emb: 0
[2023-06-24 13:17:26] [config] gradient-checkpointing: false
[2023-06-24 13:17:26] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:26] [config] guided-alignment: none
[2023-06-24 13:17:26] [config] guided-alignment-cost: mse
[2023-06-24 13:17:26] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:26] [config] ignore-model-config: false
[2023-06-24 13:17:26] [config] input-types:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] interpolate-env-vars: false
[2023-06-24 13:17:26] [config] keep-best: false
[2023-06-24 13:17:26] [config] label-smoothing: 0.1
[2023-06-24 13:17:26] [config] layer-normalization: true
[2023-06-24 13:17:26] [config] learn-rate: 0.0003
[2023-06-24 13:17:26] [config] lemma-dependency: ""
[2023-06-24 13:17:26] [config] lemma-dim-emb: 0
[2023-06-24 13:17:26] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:26] [config] log-level: info
[2023-06-24 13:17:26] [config] log-time-zone: ""
[2023-06-24 13:17:26] [config] logical-epoch:
[2023-06-24 13:17:26] [config]   - 1e
[2023-06-24 13:17:26] [config]   - 0
[2023-06-24 13:17:26] [config] lr-decay: 0
[2023-06-24 13:17:26] [config] lr-decay-freq: 50000
[2023-06-24 13:17:26] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:26] [config]   - 16000
[2023-06-24 13:17:26] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:26] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:26] [config] lr-decay-start:
[2023-06-24 13:17:26] [config]   - 10
[2023-06-24 13:17:26] [config]   - 1
[2023-06-24 13:17:26] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:26] [config] lr-report: false
[2023-06-24 13:17:26] [config] lr-warmup: 0
[2023-06-24 13:17:26] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:26] [config] lr-warmup-cycle: false
[2023-06-24 13:17:26] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:26] [config] max-length: 100
[2023-06-24 13:17:26] [config] max-length-crop: false
[2023-06-24 13:17:26] [config] max-length-factor: 3
[2023-06-24 13:17:26] [config] maxi-batch: 1000
[2023-06-24 13:17:26] [config] maxi-batch-sort: trg
[2023-06-24 13:17:26] [config] mini-batch: 1000
[2023-06-24 13:17:26] [config] mini-batch-fit: true
[2023-06-24 13:17:26] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:26] [config] mini-batch-round-up: true
[2023-06-24 13:17:26] [config] mini-batch-track-lr: false
[2023-06-24 13:17:26] [config] mini-batch-warmup: 0
[2023-06-24 13:17:26] [config] mini-batch-words: 0
[2023-06-24 13:17:26] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:26] [config] multi-loss-type: sum
[2023-06-24 13:17:26] [config] n-best: false
[2023-06-24 13:17:26] [config] no-nccl: false
[2023-06-24 13:17:26] [config] no-reload: false
[2023-06-24 13:17:26] [config] no-restore-corpus: false
[2023-06-24 13:17:26] [config] normalize: 1
[2023-06-24 13:17:26] [config] normalize-gradient: false
[2023-06-24 13:17:26] [config] num-devices: 0
[2023-06-24 13:17:26] [config] optimizer: adam
[2023-06-24 13:17:26] [config] optimizer-delay: 1
[2023-06-24 13:17:26] [config] optimizer-params:
[2023-06-24 13:17:26] [config]   - 0.9
[2023-06-24 13:17:26] [config]   - 0.98
[2023-06-24 13:17:26] [config]   - 1e-09
[2023-06-24 13:17:26] [config] output-omit-bias: false
[2023-06-24 13:17:26] [config] overwrite: false
[2023-06-24 13:17:26] [config] precision:
[2023-06-24 13:17:26] [config]   - float32
[2023-06-24 13:17:26] [config]   - float32
[2023-06-24 13:17:26] [config] pretrained-model: ""
[2023-06-24 13:17:26] [config] quantize-biases: false
[2023-06-24 13:17:26] [config] quantize-bits: 0
[2023-06-24 13:17:26] [config] quantize-log-based: false
[2023-06-24 13:17:26] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:26] [config] quiet: false
[2023-06-24 13:17:26] [config] quiet-translation: true
[2023-06-24 13:17:26] [config] relative-paths: false
[2023-06-24 13:17:26] [config] right-left: false
[2023-06-24 13:17:26] [config] save-freq: 10000u
[2023-06-24 13:17:26] [config] seed: 1234
[2023-06-24 13:17:26] [config] sentencepiece-alphas:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:26] [config] sentencepiece-options: ""
[2023-06-24 13:17:26] [config] sharding: global
[2023-06-24 13:17:26] [config] shuffle: data
[2023-06-24 13:17:26] [config] shuffle-in-ram: false
[2023-06-24 13:17:26] [config] sigterm: save-and-exit
[2023-06-24 13:17:26] [config] skip: false
[2023-06-24 13:17:26] [config] sqlite: ""
[2023-06-24 13:17:26] [config] sqlite-drop: false
[2023-06-24 13:17:26] [config] sync-freq: 200u
[2023-06-24 13:17:26] [config] sync-sgd: true
[2023-06-24 13:17:26] [config] tempdir: /tmp
[2023-06-24 13:17:26] [config] tied-embeddings: false
[2023-06-24 13:17:26] [config] tied-embeddings-all: true
[2023-06-24 13:17:26] [config] tied-embeddings-src: false
[2023-06-24 13:17:26] [config] train-embedder-rank:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] train-sets:
[2023-06-24 13:17:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:26] [config] transformer-aan-activation: swish
[2023-06-24 13:17:26] [config] transformer-aan-depth: 2
[2023-06-24 13:17:26] [config] transformer-aan-nogate: false
[2023-06-24 13:17:26] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:26] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:26] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:26] [config] transformer-depth-scaling: false
[2023-06-24 13:17:26] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:26] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:26] [config] transformer-dropout: 0
[2023-06-24 13:17:26] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:26] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:26] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:26] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:26] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:26] [config] transformer-heads: 8
[2023-06-24 13:17:26] [config] transformer-no-projection: false
[2023-06-24 13:17:26] [config] transformer-pool: false
[2023-06-24 13:17:26] [config] transformer-postprocess: dan
[2023-06-24 13:17:26] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:26] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:26] [config] transformer-preprocess: ""
[2023-06-24 13:17:26] [config] transformer-tied-layers:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:26] [config] tsv: false
[2023-06-24 13:17:26] [config] tsv-fields: 0
[2023-06-24 13:17:26] [config] type: s2s
[2023-06-24 13:17:26] [config] ulr: false
[2023-06-24 13:17:26] [config] ulr-dim-emb: 0
[2023-06-24 13:17:26] [config] ulr-dropout: 0
[2023-06-24 13:17:26] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:26] [config] ulr-query-vectors: ""
[2023-06-24 13:17:26] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:26] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:26] [config] unlikelihood-loss: false
[2023-06-24 13:17:26] [config] valid-freq: 5000000
[2023-06-24 13:17:26] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:26] [config] valid-max-length: 1000
[2023-06-24 13:17:26] [config] valid-metrics:
[2023-06-24 13:17:26] [config]   - cross-entropy
[2023-06-24 13:17:26] [config]   - translation
[2023-06-24 13:17:26] [config] valid-mini-batch: 32
[2023-06-24 13:17:26] [config] valid-reset-stalled: false
[2023-06-24 13:17:26] [config] valid-script-args:
[2023-06-24 13:17:26] [config]   []
[2023-06-24 13:17:26] [config] valid-script-path: ""
[2023-06-24 13:17:26] [config] valid-sets:
[2023-06-24 13:17:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:26] [config] vocabs:
[2023-06-24 13:17:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:26] [config] word-penalty: 0
[2023-06-24 13:17:26] [config] word-scores: false
[2023-06-24 13:17:26] [config] workspace: 9500
[2023-06-24 13:17:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:26] Using synchronous SGD
[2023-06-24 13:17:26] Synced seed 1234
[2023-06-24 13:17:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:26] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:17:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:26] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:17:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:17:26] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:17:27] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:17:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:17:27] [comm] Using global sharding
[2023-06-24 13:17:27] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:17:27] [training] Using 1 GPUs
[2023-06-24 13:17:27] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:17:27] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x556bd9ee8f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x556bda67e1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x556bda67ed6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x556bda67f785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x556bda2fcf3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x556bda382d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x556bda36f77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x556bd9e4081d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x556bda41c306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x556bda3f8f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x556bd9efa450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x556bd9e1c058]    mainTrainer  (int,  char**)                        + 0x158
[0x556bd9dd3b9c]    main                                               + 0x3c
[0x7f6a265010b3]    __libc_start_main                                  + 0xf3
[0x556bd9e1acbe]    _start                                             + 0x2e

[2023-06-24 13:17:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:31] [marian] Running on node07.datos.cluster.uy as process 6982 with command line:
[2023-06-24 13:17:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:31] [config] after: 0e
[2023-06-24 13:17:31] [config] after-batches: 0
[2023-06-24 13:17:31] [config] after-epochs: 30
[2023-06-24 13:17:31] [config] all-caps-every: 0
[2023-06-24 13:17:31] [config] allow-unk: false
[2023-06-24 13:17:31] [config] authors: false
[2023-06-24 13:17:31] [config] beam-size: 12
[2023-06-24 13:17:31] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:31] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:31] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:31] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:31] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:31] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:31] [config] build-info: ""
[2023-06-24 13:17:31] [config] check-gradient-nan: false
[2023-06-24 13:17:31] [config] check-nan: false
[2023-06-24 13:17:31] [config] cite: false
[2023-06-24 13:17:31] [config] clip-norm: 5
[2023-06-24 13:17:31] [config] cost-scaling:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] cost-type: ce-mean-words
[2023-06-24 13:17:31] [config] cpu-threads: 0
[2023-06-24 13:17:31] [config] data-threads: 8
[2023-06-24 13:17:31] [config] data-weighting: ""
[2023-06-24 13:17:31] [config] data-weighting-type: sentence
[2023-06-24 13:17:31] [config] dec-cell: gru
[2023-06-24 13:17:31] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:31] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:31] [config] dec-depth: 1
[2023-06-24 13:17:31] [config] devices:
[2023-06-24 13:17:31] [config]   - 0
[2023-06-24 13:17:31] [config] dim-emb: 512
[2023-06-24 13:17:31] [config] dim-rnn: 1024
[2023-06-24 13:17:31] [config] dim-vocabs:
[2023-06-24 13:17:31] [config]   - 0
[2023-06-24 13:17:31] [config]   - 0
[2023-06-24 13:17:31] [config] disp-first: 0
[2023-06-24 13:17:31] [config] disp-freq: 1000u
[2023-06-24 13:17:31] [config] disp-label-counts: true
[2023-06-24 13:17:31] [config] dropout-rnn: 0.1
[2023-06-24 13:17:31] [config] dropout-src: 0
[2023-06-24 13:17:31] [config] dropout-trg: 0
[2023-06-24 13:17:31] [config] dump-config: ""
[2023-06-24 13:17:31] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] early-stopping: 10
[2023-06-24 13:17:31] [config] early-stopping-on: first
[2023-06-24 13:17:31] [config] embedding-fix-src: false
[2023-06-24 13:17:31] [config] embedding-fix-trg: false
[2023-06-24 13:17:31] [config] embedding-normalization: false
[2023-06-24 13:17:31] [config] embedding-vectors:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] enc-cell: gru
[2023-06-24 13:17:31] [config] enc-cell-depth: 4
[2023-06-24 13:17:31] [config] enc-depth: 1
[2023-06-24 13:17:31] [config] enc-type: bidirectional
[2023-06-24 13:17:31] [config] english-title-case-every: 0
[2023-06-24 13:17:31] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:31] [config] factor-weight: 1
[2023-06-24 13:17:31] [config] factors-combine: sum
[2023-06-24 13:17:31] [config] factors-dim-emb: 0
[2023-06-24 13:17:31] [config] gradient-checkpointing: false
[2023-06-24 13:17:31] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:31] [config] guided-alignment: none
[2023-06-24 13:17:31] [config] guided-alignment-cost: mse
[2023-06-24 13:17:31] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:31] [config] ignore-model-config: false
[2023-06-24 13:17:31] [config] input-types:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] interpolate-env-vars: false
[2023-06-24 13:17:31] [config] keep-best: false
[2023-06-24 13:17:31] [config] label-smoothing: 0.1
[2023-06-24 13:17:31] [config] layer-normalization: true
[2023-06-24 13:17:31] [config] learn-rate: 0.0003
[2023-06-24 13:17:31] [config] lemma-dependency: ""
[2023-06-24 13:17:31] [config] lemma-dim-emb: 0
[2023-06-24 13:17:31] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:31] [config] log-level: info
[2023-06-24 13:17:31] [config] log-time-zone: ""
[2023-06-24 13:17:31] [config] logical-epoch:
[2023-06-24 13:17:31] [config]   - 1e
[2023-06-24 13:17:31] [config]   - 0
[2023-06-24 13:17:31] [config] lr-decay: 0
[2023-06-24 13:17:31] [config] lr-decay-freq: 50000
[2023-06-24 13:17:31] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:31] [config]   - 16000
[2023-06-24 13:17:31] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:31] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:31] [config] lr-decay-start:
[2023-06-24 13:17:31] [config]   - 10
[2023-06-24 13:17:31] [config]   - 1
[2023-06-24 13:17:31] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:31] [config] lr-report: false
[2023-06-24 13:17:31] [config] lr-warmup: 0
[2023-06-24 13:17:31] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:31] [config] lr-warmup-cycle: false
[2023-06-24 13:17:31] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:31] [config] max-length: 100
[2023-06-24 13:17:31] [config] max-length-crop: false
[2023-06-24 13:17:31] [config] max-length-factor: 3
[2023-06-24 13:17:31] [config] maxi-batch: 1000
[2023-06-24 13:17:31] [config] maxi-batch-sort: trg
[2023-06-24 13:17:31] [config] mini-batch: 1000
[2023-06-24 13:17:31] [config] mini-batch-fit: true
[2023-06-24 13:17:31] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:31] [config] mini-batch-round-up: true
[2023-06-24 13:17:31] [config] mini-batch-track-lr: false
[2023-06-24 13:17:31] [config] mini-batch-warmup: 0
[2023-06-24 13:17:31] [config] mini-batch-words: 0
[2023-06-24 13:17:31] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:31] [config] multi-loss-type: sum
[2023-06-24 13:17:31] [config] n-best: false
[2023-06-24 13:17:31] [config] no-nccl: false
[2023-06-24 13:17:31] [config] no-reload: false
[2023-06-24 13:17:31] [config] no-restore-corpus: false
[2023-06-24 13:17:31] [config] normalize: 1
[2023-06-24 13:17:31] [config] normalize-gradient: false
[2023-06-24 13:17:31] [config] num-devices: 0
[2023-06-24 13:17:31] [config] optimizer: adam
[2023-06-24 13:17:31] [config] optimizer-delay: 1
[2023-06-24 13:17:31] [config] optimizer-params:
[2023-06-24 13:17:31] [config]   - 0.9
[2023-06-24 13:17:31] [config]   - 0.98
[2023-06-24 13:17:31] [config]   - 1e-09
[2023-06-24 13:17:31] [config] output-omit-bias: false
[2023-06-24 13:17:31] [config] overwrite: false
[2023-06-24 13:17:31] [config] precision:
[2023-06-24 13:17:31] [config]   - float32
[2023-06-24 13:17:31] [config]   - float32
[2023-06-24 13:17:31] [config] pretrained-model: ""
[2023-06-24 13:17:31] [config] quantize-biases: false
[2023-06-24 13:17:31] [config] quantize-bits: 0
[2023-06-24 13:17:31] [config] quantize-log-based: false
[2023-06-24 13:17:31] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:31] [config] quiet: false
[2023-06-24 13:17:31] [config] quiet-translation: true
[2023-06-24 13:17:31] [config] relative-paths: false
[2023-06-24 13:17:31] [config] right-left: false
[2023-06-24 13:17:31] [config] save-freq: 10000u
[2023-06-24 13:17:31] [config] seed: 1234
[2023-06-24 13:17:31] [config] sentencepiece-alphas:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:31] [config] sentencepiece-options: ""
[2023-06-24 13:17:31] [config] sharding: global
[2023-06-24 13:17:31] [config] shuffle: data
[2023-06-24 13:17:31] [config] shuffle-in-ram: false
[2023-06-24 13:17:31] [config] sigterm: save-and-exit
[2023-06-24 13:17:31] [config] skip: false
[2023-06-24 13:17:31] [config] sqlite: ""
[2023-06-24 13:17:31] [config] sqlite-drop: false
[2023-06-24 13:17:31] [config] sync-freq: 200u
[2023-06-24 13:17:31] [config] sync-sgd: true
[2023-06-24 13:17:31] [config] tempdir: /tmp
[2023-06-24 13:17:31] [config] tied-embeddings: false
[2023-06-24 13:17:31] [config] tied-embeddings-all: true
[2023-06-24 13:17:31] [config] tied-embeddings-src: false
[2023-06-24 13:17:31] [config] train-embedder-rank:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] train-sets:
[2023-06-24 13:17:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:31] [config] transformer-aan-activation: swish
[2023-06-24 13:17:31] [config] transformer-aan-depth: 2
[2023-06-24 13:17:31] [config] transformer-aan-nogate: false
[2023-06-24 13:17:31] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:31] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:31] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:31] [config] transformer-depth-scaling: false
[2023-06-24 13:17:31] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:31] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:31] [config] transformer-dropout: 0
[2023-06-24 13:17:31] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:31] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:31] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:31] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:31] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:31] [config] transformer-heads: 8
[2023-06-24 13:17:31] [config] transformer-no-projection: false
[2023-06-24 13:17:31] [config] transformer-pool: false
[2023-06-24 13:17:31] [config] transformer-postprocess: dan
[2023-06-24 13:17:31] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:31] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:31] [config] transformer-preprocess: ""
[2023-06-24 13:17:31] [config] transformer-tied-layers:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:31] [config] tsv: false
[2023-06-24 13:17:31] [config] tsv-fields: 0
[2023-06-24 13:17:31] [config] type: s2s
[2023-06-24 13:17:31] [config] ulr: false
[2023-06-24 13:17:31] [config] ulr-dim-emb: 0
[2023-06-24 13:17:31] [config] ulr-dropout: 0
[2023-06-24 13:17:31] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:31] [config] ulr-query-vectors: ""
[2023-06-24 13:17:31] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:31] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:31] [config] unlikelihood-loss: false
[2023-06-24 13:17:31] [config] valid-freq: 5000000
[2023-06-24 13:17:31] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:31] [config] valid-max-length: 1000
[2023-06-24 13:17:31] [config] valid-metrics:
[2023-06-24 13:17:31] [config]   - cross-entropy
[2023-06-24 13:17:31] [config]   - translation
[2023-06-24 13:17:31] [config] valid-mini-batch: 32
[2023-06-24 13:17:31] [config] valid-reset-stalled: false
[2023-06-24 13:17:31] [config] valid-script-args:
[2023-06-24 13:17:31] [config]   []
[2023-06-24 13:17:31] [config] valid-script-path: ""
[2023-06-24 13:17:31] [config] valid-sets:
[2023-06-24 13:17:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:31] [config] vocabs:
[2023-06-24 13:17:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:31] [config] word-penalty: 0
[2023-06-24 13:17:31] [config] word-scores: false
[2023-06-24 13:17:31] [config] workspace: 9500
[2023-06-24 13:17:31] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:31] Using synchronous SGD
[2023-06-24 13:17:32] Synced seed 1234
[2023-06-24 13:17:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:32] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:17:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:32] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:17:32] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:17:32] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:17:32] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:17:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:17:32] [comm] Using global sharding
[2023-06-24 13:17:32] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:17:32] [training] Using 1 GPUs
[2023-06-24 13:17:32] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:17:32] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55ef69657f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55ef69ded1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55ef69dedd6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55ef69dee785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55ef69a6bf3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55ef69af1d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55ef69ade77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55ef695af81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55ef69b8b306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55ef69b67f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55ef69669450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55ef6958b058]    mainTrainer  (int,  char**)                        + 0x158
[0x55ef69542b9c]    main                                               + 0x3c
[0x7fb6a6e140b3]    __libc_start_main                                  + 0xf3
[0x55ef69589cbe]    _start                                             + 0x2e

[2023-06-24 13:17:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:37] [marian] Running on node07.datos.cluster.uy as process 7011 with command line:
[2023-06-24 13:17:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:37] [config] after: 0e
[2023-06-24 13:17:37] [config] after-batches: 0
[2023-06-24 13:17:37] [config] after-epochs: 40
[2023-06-24 13:17:37] [config] all-caps-every: 0
[2023-06-24 13:17:37] [config] allow-unk: false
[2023-06-24 13:17:37] [config] authors: false
[2023-06-24 13:17:37] [config] beam-size: 12
[2023-06-24 13:17:37] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:37] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:37] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:37] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:37] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:37] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:37] [config] build-info: ""
[2023-06-24 13:17:37] [config] check-gradient-nan: false
[2023-06-24 13:17:37] [config] check-nan: false
[2023-06-24 13:17:37] [config] cite: false
[2023-06-24 13:17:37] [config] clip-norm: 5
[2023-06-24 13:17:37] [config] cost-scaling:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] cost-type: ce-mean-words
[2023-06-24 13:17:37] [config] cpu-threads: 0
[2023-06-24 13:17:37] [config] data-threads: 8
[2023-06-24 13:17:37] [config] data-weighting: ""
[2023-06-24 13:17:37] [config] data-weighting-type: sentence
[2023-06-24 13:17:37] [config] dec-cell: gru
[2023-06-24 13:17:37] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:37] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:37] [config] dec-depth: 1
[2023-06-24 13:17:37] [config] devices:
[2023-06-24 13:17:37] [config]   - 0
[2023-06-24 13:17:37] [config] dim-emb: 512
[2023-06-24 13:17:37] [config] dim-rnn: 1024
[2023-06-24 13:17:37] [config] dim-vocabs:
[2023-06-24 13:17:37] [config]   - 0
[2023-06-24 13:17:37] [config]   - 0
[2023-06-24 13:17:37] [config] disp-first: 0
[2023-06-24 13:17:37] [config] disp-freq: 1000u
[2023-06-24 13:17:37] [config] disp-label-counts: true
[2023-06-24 13:17:37] [config] dropout-rnn: 0.1
[2023-06-24 13:17:37] [config] dropout-src: 0
[2023-06-24 13:17:37] [config] dropout-trg: 0
[2023-06-24 13:17:37] [config] dump-config: ""
[2023-06-24 13:17:37] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] early-stopping: 10
[2023-06-24 13:17:37] [config] early-stopping-on: first
[2023-06-24 13:17:37] [config] embedding-fix-src: false
[2023-06-24 13:17:37] [config] embedding-fix-trg: false
[2023-06-24 13:17:37] [config] embedding-normalization: false
[2023-06-24 13:17:37] [config] embedding-vectors:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] enc-cell: gru
[2023-06-24 13:17:37] [config] enc-cell-depth: 4
[2023-06-24 13:17:37] [config] enc-depth: 1
[2023-06-24 13:17:37] [config] enc-type: bidirectional
[2023-06-24 13:17:37] [config] english-title-case-every: 0
[2023-06-24 13:17:37] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:37] [config] factor-weight: 1
[2023-06-24 13:17:37] [config] factors-combine: sum
[2023-06-24 13:17:37] [config] factors-dim-emb: 0
[2023-06-24 13:17:37] [config] gradient-checkpointing: false
[2023-06-24 13:17:37] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:37] [config] guided-alignment: none
[2023-06-24 13:17:37] [config] guided-alignment-cost: mse
[2023-06-24 13:17:37] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:37] [config] ignore-model-config: false
[2023-06-24 13:17:37] [config] input-types:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] interpolate-env-vars: false
[2023-06-24 13:17:37] [config] keep-best: false
[2023-06-24 13:17:37] [config] label-smoothing: 0.1
[2023-06-24 13:17:37] [config] layer-normalization: true
[2023-06-24 13:17:37] [config] learn-rate: 0.0003
[2023-06-24 13:17:37] [config] lemma-dependency: ""
[2023-06-24 13:17:37] [config] lemma-dim-emb: 0
[2023-06-24 13:17:37] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:37] [config] log-level: info
[2023-06-24 13:17:37] [config] log-time-zone: ""
[2023-06-24 13:17:37] [config] logical-epoch:
[2023-06-24 13:17:37] [config]   - 1e
[2023-06-24 13:17:37] [config]   - 0
[2023-06-24 13:17:37] [config] lr-decay: 0
[2023-06-24 13:17:37] [config] lr-decay-freq: 50000
[2023-06-24 13:17:37] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:37] [config]   - 16000
[2023-06-24 13:17:37] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:37] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:37] [config] lr-decay-start:
[2023-06-24 13:17:37] [config]   - 10
[2023-06-24 13:17:37] [config]   - 1
[2023-06-24 13:17:37] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:37] [config] lr-report: false
[2023-06-24 13:17:37] [config] lr-warmup: 0
[2023-06-24 13:17:37] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:37] [config] lr-warmup-cycle: false
[2023-06-24 13:17:37] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:37] [config] max-length: 100
[2023-06-24 13:17:37] [config] max-length-crop: false
[2023-06-24 13:17:37] [config] max-length-factor: 3
[2023-06-24 13:17:37] [config] maxi-batch: 1000
[2023-06-24 13:17:37] [config] maxi-batch-sort: trg
[2023-06-24 13:17:37] [config] mini-batch: 1000
[2023-06-24 13:17:37] [config] mini-batch-fit: true
[2023-06-24 13:17:37] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:37] [config] mini-batch-round-up: true
[2023-06-24 13:17:37] [config] mini-batch-track-lr: false
[2023-06-24 13:17:37] [config] mini-batch-warmup: 0
[2023-06-24 13:17:37] [config] mini-batch-words: 0
[2023-06-24 13:17:37] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:37] [config] multi-loss-type: sum
[2023-06-24 13:17:37] [config] n-best: false
[2023-06-24 13:17:37] [config] no-nccl: false
[2023-06-24 13:17:37] [config] no-reload: false
[2023-06-24 13:17:37] [config] no-restore-corpus: false
[2023-06-24 13:17:37] [config] normalize: 1
[2023-06-24 13:17:37] [config] normalize-gradient: false
[2023-06-24 13:17:37] [config] num-devices: 0
[2023-06-24 13:17:37] [config] optimizer: adam
[2023-06-24 13:17:37] [config] optimizer-delay: 1
[2023-06-24 13:17:37] [config] optimizer-params:
[2023-06-24 13:17:37] [config]   - 0.9
[2023-06-24 13:17:37] [config]   - 0.98
[2023-06-24 13:17:37] [config]   - 1e-09
[2023-06-24 13:17:37] [config] output-omit-bias: false
[2023-06-24 13:17:37] [config] overwrite: false
[2023-06-24 13:17:37] [config] precision:
[2023-06-24 13:17:37] [config]   - float32
[2023-06-24 13:17:37] [config]   - float32
[2023-06-24 13:17:37] [config] pretrained-model: ""
[2023-06-24 13:17:37] [config] quantize-biases: false
[2023-06-24 13:17:37] [config] quantize-bits: 0
[2023-06-24 13:17:37] [config] quantize-log-based: false
[2023-06-24 13:17:37] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:37] [config] quiet: false
[2023-06-24 13:17:37] [config] quiet-translation: true
[2023-06-24 13:17:37] [config] relative-paths: false
[2023-06-24 13:17:37] [config] right-left: false
[2023-06-24 13:17:37] [config] save-freq: 10000u
[2023-06-24 13:17:37] [config] seed: 1234
[2023-06-24 13:17:37] [config] sentencepiece-alphas:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:37] [config] sentencepiece-options: ""
[2023-06-24 13:17:37] [config] sharding: global
[2023-06-24 13:17:37] [config] shuffle: data
[2023-06-24 13:17:37] [config] shuffle-in-ram: false
[2023-06-24 13:17:37] [config] sigterm: save-and-exit
[2023-06-24 13:17:37] [config] skip: false
[2023-06-24 13:17:37] [config] sqlite: ""
[2023-06-24 13:17:37] [config] sqlite-drop: false
[2023-06-24 13:17:37] [config] sync-freq: 200u
[2023-06-24 13:17:37] [config] sync-sgd: true
[2023-06-24 13:17:37] [config] tempdir: /tmp
[2023-06-24 13:17:37] [config] tied-embeddings: false
[2023-06-24 13:17:37] [config] tied-embeddings-all: true
[2023-06-24 13:17:37] [config] tied-embeddings-src: false
[2023-06-24 13:17:37] [config] train-embedder-rank:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] train-sets:
[2023-06-24 13:17:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:37] [config] transformer-aan-activation: swish
[2023-06-24 13:17:37] [config] transformer-aan-depth: 2
[2023-06-24 13:17:37] [config] transformer-aan-nogate: false
[2023-06-24 13:17:37] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:37] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:37] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:37] [config] transformer-depth-scaling: false
[2023-06-24 13:17:37] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:37] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:37] [config] transformer-dropout: 0
[2023-06-24 13:17:37] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:37] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:37] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:37] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:37] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:37] [config] transformer-heads: 8
[2023-06-24 13:17:37] [config] transformer-no-projection: false
[2023-06-24 13:17:37] [config] transformer-pool: false
[2023-06-24 13:17:37] [config] transformer-postprocess: dan
[2023-06-24 13:17:37] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:37] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:37] [config] transformer-preprocess: ""
[2023-06-24 13:17:37] [config] transformer-tied-layers:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:37] [config] tsv: false
[2023-06-24 13:17:37] [config] tsv-fields: 0
[2023-06-24 13:17:37] [config] type: s2s
[2023-06-24 13:17:37] [config] ulr: false
[2023-06-24 13:17:37] [config] ulr-dim-emb: 0
[2023-06-24 13:17:37] [config] ulr-dropout: 0
[2023-06-24 13:17:37] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:37] [config] ulr-query-vectors: ""
[2023-06-24 13:17:37] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:37] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:37] [config] unlikelihood-loss: false
[2023-06-24 13:17:37] [config] valid-freq: 5000000
[2023-06-24 13:17:37] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:37] [config] valid-max-length: 1000
[2023-06-24 13:17:37] [config] valid-metrics:
[2023-06-24 13:17:37] [config]   - cross-entropy
[2023-06-24 13:17:37] [config]   - translation
[2023-06-24 13:17:37] [config] valid-mini-batch: 32
[2023-06-24 13:17:37] [config] valid-reset-stalled: false
[2023-06-24 13:17:37] [config] valid-script-args:
[2023-06-24 13:17:37] [config]   []
[2023-06-24 13:17:37] [config] valid-script-path: ""
[2023-06-24 13:17:37] [config] valid-sets:
[2023-06-24 13:17:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:37] [config] vocabs:
[2023-06-24 13:17:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:37] [config] word-penalty: 0
[2023-06-24 13:17:37] [config] word-scores: false
[2023-06-24 13:17:37] [config] workspace: 9500
[2023-06-24 13:17:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:37] Using synchronous SGD
[2023-06-24 13:17:37] Synced seed 1234
[2023-06-24 13:17:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:37] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:17:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:37] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:17:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:17:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:17:38] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:17:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:17:38] [comm] Using global sharding
[2023-06-24 13:17:38] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:17:38] [training] Using 1 GPUs
[2023-06-24 13:17:38] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:17:38] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55cae8860f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55cae8ff61fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55cae8ff6d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55cae8ff7785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55cae8c74f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55cae8cfad5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55cae8ce777c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55cae87b881d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55cae8d94306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55cae8d70f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55cae8872450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55cae8794058]    mainTrainer  (int,  char**)                        + 0x158
[0x55cae874bb9c]    main                                               + 0x3c
[0x7f08b79b10b3]    __libc_start_main                                  + 0xf3
[0x55cae8792cbe]    _start                                             + 0x2e

[2023-06-24 13:17:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:42] [marian] Running on node07.datos.cluster.uy as process 7041 with command line:
[2023-06-24 13:17:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:42] [config] after: 0e
[2023-06-24 13:17:42] [config] after-batches: 0
[2023-06-24 13:17:42] [config] after-epochs: 50
[2023-06-24 13:17:42] [config] all-caps-every: 0
[2023-06-24 13:17:42] [config] allow-unk: false
[2023-06-24 13:17:42] [config] authors: false
[2023-06-24 13:17:42] [config] beam-size: 12
[2023-06-24 13:17:42] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:42] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:42] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:42] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:42] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:42] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:42] [config] build-info: ""
[2023-06-24 13:17:42] [config] check-gradient-nan: false
[2023-06-24 13:17:42] [config] check-nan: false
[2023-06-24 13:17:42] [config] cite: false
[2023-06-24 13:17:42] [config] clip-norm: 5
[2023-06-24 13:17:42] [config] cost-scaling:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] cost-type: ce-mean-words
[2023-06-24 13:17:42] [config] cpu-threads: 0
[2023-06-24 13:17:42] [config] data-threads: 8
[2023-06-24 13:17:42] [config] data-weighting: ""
[2023-06-24 13:17:42] [config] data-weighting-type: sentence
[2023-06-24 13:17:42] [config] dec-cell: gru
[2023-06-24 13:17:42] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:42] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:42] [config] dec-depth: 1
[2023-06-24 13:17:42] [config] devices:
[2023-06-24 13:17:42] [config]   - 0
[2023-06-24 13:17:42] [config] dim-emb: 512
[2023-06-24 13:17:42] [config] dim-rnn: 1024
[2023-06-24 13:17:42] [config] dim-vocabs:
[2023-06-24 13:17:42] [config]   - 0
[2023-06-24 13:17:42] [config]   - 0
[2023-06-24 13:17:42] [config] disp-first: 0
[2023-06-24 13:17:42] [config] disp-freq: 1000u
[2023-06-24 13:17:42] [config] disp-label-counts: true
[2023-06-24 13:17:42] [config] dropout-rnn: 0.1
[2023-06-24 13:17:42] [config] dropout-src: 0
[2023-06-24 13:17:42] [config] dropout-trg: 0
[2023-06-24 13:17:42] [config] dump-config: ""
[2023-06-24 13:17:42] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] early-stopping: 10
[2023-06-24 13:17:42] [config] early-stopping-on: first
[2023-06-24 13:17:42] [config] embedding-fix-src: false
[2023-06-24 13:17:42] [config] embedding-fix-trg: false
[2023-06-24 13:17:42] [config] embedding-normalization: false
[2023-06-24 13:17:42] [config] embedding-vectors:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] enc-cell: gru
[2023-06-24 13:17:42] [config] enc-cell-depth: 4
[2023-06-24 13:17:42] [config] enc-depth: 1
[2023-06-24 13:17:42] [config] enc-type: bidirectional
[2023-06-24 13:17:42] [config] english-title-case-every: 0
[2023-06-24 13:17:42] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:42] [config] factor-weight: 1
[2023-06-24 13:17:42] [config] factors-combine: sum
[2023-06-24 13:17:42] [config] factors-dim-emb: 0
[2023-06-24 13:17:42] [config] gradient-checkpointing: false
[2023-06-24 13:17:42] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:42] [config] guided-alignment: none
[2023-06-24 13:17:42] [config] guided-alignment-cost: mse
[2023-06-24 13:17:42] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:42] [config] ignore-model-config: false
[2023-06-24 13:17:42] [config] input-types:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] interpolate-env-vars: false
[2023-06-24 13:17:42] [config] keep-best: false
[2023-06-24 13:17:42] [config] label-smoothing: 0.1
[2023-06-24 13:17:42] [config] layer-normalization: true
[2023-06-24 13:17:42] [config] learn-rate: 0.0003
[2023-06-24 13:17:42] [config] lemma-dependency: ""
[2023-06-24 13:17:42] [config] lemma-dim-emb: 0
[2023-06-24 13:17:42] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:42] [config] log-level: info
[2023-06-24 13:17:42] [config] log-time-zone: ""
[2023-06-24 13:17:42] [config] logical-epoch:
[2023-06-24 13:17:42] [config]   - 1e
[2023-06-24 13:17:42] [config]   - 0
[2023-06-24 13:17:42] [config] lr-decay: 0
[2023-06-24 13:17:42] [config] lr-decay-freq: 50000
[2023-06-24 13:17:42] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:42] [config]   - 16000
[2023-06-24 13:17:42] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:42] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:42] [config] lr-decay-start:
[2023-06-24 13:17:42] [config]   - 10
[2023-06-24 13:17:42] [config]   - 1
[2023-06-24 13:17:42] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:42] [config] lr-report: false
[2023-06-24 13:17:42] [config] lr-warmup: 0
[2023-06-24 13:17:42] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:42] [config] lr-warmup-cycle: false
[2023-06-24 13:17:42] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:42] [config] max-length: 100
[2023-06-24 13:17:42] [config] max-length-crop: false
[2023-06-24 13:17:42] [config] max-length-factor: 3
[2023-06-24 13:17:42] [config] maxi-batch: 1000
[2023-06-24 13:17:42] [config] maxi-batch-sort: trg
[2023-06-24 13:17:42] [config] mini-batch: 1000
[2023-06-24 13:17:42] [config] mini-batch-fit: true
[2023-06-24 13:17:42] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:42] [config] mini-batch-round-up: true
[2023-06-24 13:17:42] [config] mini-batch-track-lr: false
[2023-06-24 13:17:42] [config] mini-batch-warmup: 0
[2023-06-24 13:17:42] [config] mini-batch-words: 0
[2023-06-24 13:17:42] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:42] [config] multi-loss-type: sum
[2023-06-24 13:17:42] [config] n-best: false
[2023-06-24 13:17:42] [config] no-nccl: false
[2023-06-24 13:17:42] [config] no-reload: false
[2023-06-24 13:17:42] [config] no-restore-corpus: false
[2023-06-24 13:17:42] [config] normalize: 1
[2023-06-24 13:17:42] [config] normalize-gradient: false
[2023-06-24 13:17:42] [config] num-devices: 0
[2023-06-24 13:17:42] [config] optimizer: adam
[2023-06-24 13:17:42] [config] optimizer-delay: 1
[2023-06-24 13:17:42] [config] optimizer-params:
[2023-06-24 13:17:42] [config]   - 0.9
[2023-06-24 13:17:42] [config]   - 0.98
[2023-06-24 13:17:42] [config]   - 1e-09
[2023-06-24 13:17:42] [config] output-omit-bias: false
[2023-06-24 13:17:42] [config] overwrite: false
[2023-06-24 13:17:42] [config] precision:
[2023-06-24 13:17:42] [config]   - float32
[2023-06-24 13:17:42] [config]   - float32
[2023-06-24 13:17:42] [config] pretrained-model: ""
[2023-06-24 13:17:42] [config] quantize-biases: false
[2023-06-24 13:17:42] [config] quantize-bits: 0
[2023-06-24 13:17:42] [config] quantize-log-based: false
[2023-06-24 13:17:42] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:42] [config] quiet: false
[2023-06-24 13:17:42] [config] quiet-translation: true
[2023-06-24 13:17:42] [config] relative-paths: false
[2023-06-24 13:17:42] [config] right-left: false
[2023-06-24 13:17:42] [config] save-freq: 10000u
[2023-06-24 13:17:42] [config] seed: 1234
[2023-06-24 13:17:42] [config] sentencepiece-alphas:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:42] [config] sentencepiece-options: ""
[2023-06-24 13:17:42] [config] sharding: global
[2023-06-24 13:17:42] [config] shuffle: data
[2023-06-24 13:17:42] [config] shuffle-in-ram: false
[2023-06-24 13:17:42] [config] sigterm: save-and-exit
[2023-06-24 13:17:42] [config] skip: false
[2023-06-24 13:17:42] [config] sqlite: ""
[2023-06-24 13:17:42] [config] sqlite-drop: false
[2023-06-24 13:17:42] [config] sync-freq: 200u
[2023-06-24 13:17:42] [config] sync-sgd: true
[2023-06-24 13:17:42] [config] tempdir: /tmp
[2023-06-24 13:17:42] [config] tied-embeddings: false
[2023-06-24 13:17:42] [config] tied-embeddings-all: true
[2023-06-24 13:17:42] [config] tied-embeddings-src: false
[2023-06-24 13:17:42] [config] train-embedder-rank:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] train-sets:
[2023-06-24 13:17:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:42] [config] transformer-aan-activation: swish
[2023-06-24 13:17:42] [config] transformer-aan-depth: 2
[2023-06-24 13:17:42] [config] transformer-aan-nogate: false
[2023-06-24 13:17:42] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:42] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:42] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:42] [config] transformer-depth-scaling: false
[2023-06-24 13:17:42] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:42] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:42] [config] transformer-dropout: 0
[2023-06-24 13:17:42] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:42] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:42] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:42] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:42] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:42] [config] transformer-heads: 8
[2023-06-24 13:17:42] [config] transformer-no-projection: false
[2023-06-24 13:17:42] [config] transformer-pool: false
[2023-06-24 13:17:42] [config] transformer-postprocess: dan
[2023-06-24 13:17:42] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:42] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:42] [config] transformer-preprocess: ""
[2023-06-24 13:17:42] [config] transformer-tied-layers:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:42] [config] tsv: false
[2023-06-24 13:17:42] [config] tsv-fields: 0
[2023-06-24 13:17:42] [config] type: s2s
[2023-06-24 13:17:42] [config] ulr: false
[2023-06-24 13:17:42] [config] ulr-dim-emb: 0
[2023-06-24 13:17:42] [config] ulr-dropout: 0
[2023-06-24 13:17:42] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:42] [config] ulr-query-vectors: ""
[2023-06-24 13:17:42] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:42] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:42] [config] unlikelihood-loss: false
[2023-06-24 13:17:42] [config] valid-freq: 5000000
[2023-06-24 13:17:42] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:42] [config] valid-max-length: 1000
[2023-06-24 13:17:42] [config] valid-metrics:
[2023-06-24 13:17:42] [config]   - cross-entropy
[2023-06-24 13:17:42] [config]   - translation
[2023-06-24 13:17:42] [config] valid-mini-batch: 32
[2023-06-24 13:17:42] [config] valid-reset-stalled: false
[2023-06-24 13:17:42] [config] valid-script-args:
[2023-06-24 13:17:42] [config]   []
[2023-06-24 13:17:42] [config] valid-script-path: ""
[2023-06-24 13:17:42] [config] valid-sets:
[2023-06-24 13:17:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:42] [config] vocabs:
[2023-06-24 13:17:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:42] [config] word-penalty: 0
[2023-06-24 13:17:42] [config] word-scores: false
[2023-06-24 13:17:42] [config] workspace: 9500
[2023-06-24 13:17:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:42] Using synchronous SGD
[2023-06-24 13:17:43] Synced seed 1234
[2023-06-24 13:17:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:43] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:17:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:43] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:17:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:17:43] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:17:43] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:17:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:17:44] [comm] Using global sharding
[2023-06-24 13:17:44] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:17:44] [training] Using 1 GPUs
[2023-06-24 13:17:44] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:17:44] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x559d5a949f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x559d5b0df1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x559d5b0dfd6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x559d5b0e0785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x559d5ad5df3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x559d5ade3d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x559d5add077c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x559d5a8a181d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x559d5ae7d306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x559d5ae59f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x559d5a95b450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x559d5a87d058]    mainTrainer  (int,  char**)                        + 0x158
[0x559d5a834b9c]    main                                               + 0x3c
[0x7fd9671d30b3]    __libc_start_main                                  + 0xf3
[0x559d5a87bcbe]    _start                                             + 0x2e

[2023-06-24 13:17:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:48] [marian] Running on node07.datos.cluster.uy as process 7070 with command line:
[2023-06-24 13:17:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:48] [config] after: 0e
[2023-06-24 13:17:48] [config] after-batches: 0
[2023-06-24 13:17:48] [config] after-epochs: 60
[2023-06-24 13:17:48] [config] all-caps-every: 0
[2023-06-24 13:17:48] [config] allow-unk: false
[2023-06-24 13:17:48] [config] authors: false
[2023-06-24 13:17:48] [config] beam-size: 12
[2023-06-24 13:17:48] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:48] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:48] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:48] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:48] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:48] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:48] [config] build-info: ""
[2023-06-24 13:17:48] [config] check-gradient-nan: false
[2023-06-24 13:17:48] [config] check-nan: false
[2023-06-24 13:17:48] [config] cite: false
[2023-06-24 13:17:48] [config] clip-norm: 5
[2023-06-24 13:17:48] [config] cost-scaling:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] cost-type: ce-mean-words
[2023-06-24 13:17:48] [config] cpu-threads: 0
[2023-06-24 13:17:48] [config] data-threads: 8
[2023-06-24 13:17:48] [config] data-weighting: ""
[2023-06-24 13:17:48] [config] data-weighting-type: sentence
[2023-06-24 13:17:48] [config] dec-cell: gru
[2023-06-24 13:17:48] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:48] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:48] [config] dec-depth: 1
[2023-06-24 13:17:48] [config] devices:
[2023-06-24 13:17:48] [config]   - 0
[2023-06-24 13:17:48] [config] dim-emb: 512
[2023-06-24 13:17:48] [config] dim-rnn: 1024
[2023-06-24 13:17:48] [config] dim-vocabs:
[2023-06-24 13:17:48] [config]   - 0
[2023-06-24 13:17:48] [config]   - 0
[2023-06-24 13:17:48] [config] disp-first: 0
[2023-06-24 13:17:48] [config] disp-freq: 1000u
[2023-06-24 13:17:48] [config] disp-label-counts: true
[2023-06-24 13:17:48] [config] dropout-rnn: 0.1
[2023-06-24 13:17:48] [config] dropout-src: 0
[2023-06-24 13:17:48] [config] dropout-trg: 0
[2023-06-24 13:17:48] [config] dump-config: ""
[2023-06-24 13:17:48] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] early-stopping: 10
[2023-06-24 13:17:48] [config] early-stopping-on: first
[2023-06-24 13:17:48] [config] embedding-fix-src: false
[2023-06-24 13:17:48] [config] embedding-fix-trg: false
[2023-06-24 13:17:48] [config] embedding-normalization: false
[2023-06-24 13:17:48] [config] embedding-vectors:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] enc-cell: gru
[2023-06-24 13:17:48] [config] enc-cell-depth: 4
[2023-06-24 13:17:48] [config] enc-depth: 1
[2023-06-24 13:17:48] [config] enc-type: bidirectional
[2023-06-24 13:17:48] [config] english-title-case-every: 0
[2023-06-24 13:17:48] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:48] [config] factor-weight: 1
[2023-06-24 13:17:48] [config] factors-combine: sum
[2023-06-24 13:17:48] [config] factors-dim-emb: 0
[2023-06-24 13:17:48] [config] gradient-checkpointing: false
[2023-06-24 13:17:48] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:48] [config] guided-alignment: none
[2023-06-24 13:17:48] [config] guided-alignment-cost: mse
[2023-06-24 13:17:48] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:48] [config] ignore-model-config: false
[2023-06-24 13:17:48] [config] input-types:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] interpolate-env-vars: false
[2023-06-24 13:17:48] [config] keep-best: false
[2023-06-24 13:17:48] [config] label-smoothing: 0.1
[2023-06-24 13:17:48] [config] layer-normalization: true
[2023-06-24 13:17:48] [config] learn-rate: 0.0003
[2023-06-24 13:17:48] [config] lemma-dependency: ""
[2023-06-24 13:17:48] [config] lemma-dim-emb: 0
[2023-06-24 13:17:48] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:48] [config] log-level: info
[2023-06-24 13:17:48] [config] log-time-zone: ""
[2023-06-24 13:17:48] [config] logical-epoch:
[2023-06-24 13:17:48] [config]   - 1e
[2023-06-24 13:17:48] [config]   - 0
[2023-06-24 13:17:48] [config] lr-decay: 0
[2023-06-24 13:17:48] [config] lr-decay-freq: 50000
[2023-06-24 13:17:48] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:48] [config]   - 16000
[2023-06-24 13:17:48] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:48] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:48] [config] lr-decay-start:
[2023-06-24 13:17:48] [config]   - 10
[2023-06-24 13:17:48] [config]   - 1
[2023-06-24 13:17:48] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:48] [config] lr-report: false
[2023-06-24 13:17:48] [config] lr-warmup: 0
[2023-06-24 13:17:48] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:48] [config] lr-warmup-cycle: false
[2023-06-24 13:17:48] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:48] [config] max-length: 100
[2023-06-24 13:17:48] [config] max-length-crop: false
[2023-06-24 13:17:48] [config] max-length-factor: 3
[2023-06-24 13:17:48] [config] maxi-batch: 1000
[2023-06-24 13:17:48] [config] maxi-batch-sort: trg
[2023-06-24 13:17:48] [config] mini-batch: 1000
[2023-06-24 13:17:48] [config] mini-batch-fit: true
[2023-06-24 13:17:48] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:48] [config] mini-batch-round-up: true
[2023-06-24 13:17:48] [config] mini-batch-track-lr: false
[2023-06-24 13:17:48] [config] mini-batch-warmup: 0
[2023-06-24 13:17:48] [config] mini-batch-words: 0
[2023-06-24 13:17:48] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:48] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:48] [config] multi-loss-type: sum
[2023-06-24 13:17:48] [config] n-best: false
[2023-06-24 13:17:48] [config] no-nccl: false
[2023-06-24 13:17:48] [config] no-reload: false
[2023-06-24 13:17:48] [config] no-restore-corpus: false
[2023-06-24 13:17:48] [config] normalize: 1
[2023-06-24 13:17:48] [config] normalize-gradient: false
[2023-06-24 13:17:48] [config] num-devices: 0
[2023-06-24 13:17:48] [config] optimizer: adam
[2023-06-24 13:17:48] [config] optimizer-delay: 1
[2023-06-24 13:17:48] [config] optimizer-params:
[2023-06-24 13:17:48] [config]   - 0.9
[2023-06-24 13:17:48] [config]   - 0.98
[2023-06-24 13:17:48] [config]   - 1e-09
[2023-06-24 13:17:48] [config] output-omit-bias: false
[2023-06-24 13:17:48] [config] overwrite: false
[2023-06-24 13:17:48] [config] precision:
[2023-06-24 13:17:48] [config]   - float32
[2023-06-24 13:17:48] [config]   - float32
[2023-06-24 13:17:48] [config] pretrained-model: ""
[2023-06-24 13:17:48] [config] quantize-biases: false
[2023-06-24 13:17:48] [config] quantize-bits: 0
[2023-06-24 13:17:48] [config] quantize-log-based: false
[2023-06-24 13:17:48] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:48] [config] quiet: false
[2023-06-24 13:17:48] [config] quiet-translation: true
[2023-06-24 13:17:48] [config] relative-paths: false
[2023-06-24 13:17:48] [config] right-left: false
[2023-06-24 13:17:48] [config] save-freq: 10000u
[2023-06-24 13:17:48] [config] seed: 1234
[2023-06-24 13:17:48] [config] sentencepiece-alphas:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:48] [config] sentencepiece-options: ""
[2023-06-24 13:17:48] [config] sharding: global
[2023-06-24 13:17:48] [config] shuffle: data
[2023-06-24 13:17:48] [config] shuffle-in-ram: false
[2023-06-24 13:17:48] [config] sigterm: save-and-exit
[2023-06-24 13:17:48] [config] skip: false
[2023-06-24 13:17:48] [config] sqlite: ""
[2023-06-24 13:17:48] [config] sqlite-drop: false
[2023-06-24 13:17:48] [config] sync-freq: 200u
[2023-06-24 13:17:48] [config] sync-sgd: true
[2023-06-24 13:17:48] [config] tempdir: /tmp
[2023-06-24 13:17:48] [config] tied-embeddings: false
[2023-06-24 13:17:48] [config] tied-embeddings-all: true
[2023-06-24 13:17:48] [config] tied-embeddings-src: false
[2023-06-24 13:17:48] [config] train-embedder-rank:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] train-sets:
[2023-06-24 13:17:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:48] [config] transformer-aan-activation: swish
[2023-06-24 13:17:48] [config] transformer-aan-depth: 2
[2023-06-24 13:17:48] [config] transformer-aan-nogate: false
[2023-06-24 13:17:48] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:48] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:48] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:48] [config] transformer-depth-scaling: false
[2023-06-24 13:17:48] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:48] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:48] [config] transformer-dropout: 0
[2023-06-24 13:17:48] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:48] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:48] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:48] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:48] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:48] [config] transformer-heads: 8
[2023-06-24 13:17:48] [config] transformer-no-projection: false
[2023-06-24 13:17:48] [config] transformer-pool: false
[2023-06-24 13:17:48] [config] transformer-postprocess: dan
[2023-06-24 13:17:48] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:48] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:48] [config] transformer-preprocess: ""
[2023-06-24 13:17:48] [config] transformer-tied-layers:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:48] [config] tsv: false
[2023-06-24 13:17:48] [config] tsv-fields: 0
[2023-06-24 13:17:48] [config] type: s2s
[2023-06-24 13:17:48] [config] ulr: false
[2023-06-24 13:17:48] [config] ulr-dim-emb: 0
[2023-06-24 13:17:48] [config] ulr-dropout: 0
[2023-06-24 13:17:48] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:48] [config] ulr-query-vectors: ""
[2023-06-24 13:17:48] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:48] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:48] [config] unlikelihood-loss: false
[2023-06-24 13:17:48] [config] valid-freq: 5000000
[2023-06-24 13:17:48] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:48] [config] valid-max-length: 1000
[2023-06-24 13:17:48] [config] valid-metrics:
[2023-06-24 13:17:48] [config]   - cross-entropy
[2023-06-24 13:17:48] [config]   - translation
[2023-06-24 13:17:48] [config] valid-mini-batch: 32
[2023-06-24 13:17:48] [config] valid-reset-stalled: false
[2023-06-24 13:17:48] [config] valid-script-args:
[2023-06-24 13:17:48] [config]   []
[2023-06-24 13:17:48] [config] valid-script-path: ""
[2023-06-24 13:17:48] [config] valid-sets:
[2023-06-24 13:17:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:48] [config] vocabs:
[2023-06-24 13:17:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:48] [config] word-penalty: 0
[2023-06-24 13:17:48] [config] word-scores: false
[2023-06-24 13:17:48] [config] workspace: 9500
[2023-06-24 13:17:48] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:48] Using synchronous SGD
[2023-06-24 13:17:48] Synced seed 1234
[2023-06-24 13:17:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:48] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:17:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:48] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:17:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:17:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:17:49] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:17:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:17:49] [comm] Using global sharding
[2023-06-24 13:17:49] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:17:49] [training] Using 1 GPUs
[2023-06-24 13:17:49] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:17:49] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55d5d0508f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55d5d0c9e1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55d5d0c9ed6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55d5d0c9f785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55d5d091cf3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55d5d09a2d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55d5d098f77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55d5d046081d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55d5d0a3c306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55d5d0a18f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55d5d051a450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55d5d043c058]    mainTrainer  (int,  char**)                        + 0x158
[0x55d5d03f3b9c]    main                                               + 0x3c
[0x7fdf30b7f0b3]    __libc_start_main                                  + 0xf3
[0x55d5d043acbe]    _start                                             + 0x2e

[2023-06-24 13:17:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:54] [marian] Running on node07.datos.cluster.uy as process 7101 with command line:
[2023-06-24 13:17:54] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:54] [config] after: 0e
[2023-06-24 13:17:54] [config] after-batches: 0
[2023-06-24 13:17:54] [config] after-epochs: 70
[2023-06-24 13:17:54] [config] all-caps-every: 0
[2023-06-24 13:17:54] [config] allow-unk: false
[2023-06-24 13:17:54] [config] authors: false
[2023-06-24 13:17:54] [config] beam-size: 12
[2023-06-24 13:17:54] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:54] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:54] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:54] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:54] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:54] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:54] [config] build-info: ""
[2023-06-24 13:17:54] [config] check-gradient-nan: false
[2023-06-24 13:17:54] [config] check-nan: false
[2023-06-24 13:17:54] [config] cite: false
[2023-06-24 13:17:54] [config] clip-norm: 5
[2023-06-24 13:17:54] [config] cost-scaling:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] cost-type: ce-mean-words
[2023-06-24 13:17:54] [config] cpu-threads: 0
[2023-06-24 13:17:54] [config] data-threads: 8
[2023-06-24 13:17:54] [config] data-weighting: ""
[2023-06-24 13:17:54] [config] data-weighting-type: sentence
[2023-06-24 13:17:54] [config] dec-cell: gru
[2023-06-24 13:17:54] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:54] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:54] [config] dec-depth: 1
[2023-06-24 13:17:54] [config] devices:
[2023-06-24 13:17:54] [config]   - 0
[2023-06-24 13:17:54] [config] dim-emb: 512
[2023-06-24 13:17:54] [config] dim-rnn: 1024
[2023-06-24 13:17:54] [config] dim-vocabs:
[2023-06-24 13:17:54] [config]   - 0
[2023-06-24 13:17:54] [config]   - 0
[2023-06-24 13:17:54] [config] disp-first: 0
[2023-06-24 13:17:54] [config] disp-freq: 1000u
[2023-06-24 13:17:54] [config] disp-label-counts: true
[2023-06-24 13:17:54] [config] dropout-rnn: 0.1
[2023-06-24 13:17:54] [config] dropout-src: 0
[2023-06-24 13:17:54] [config] dropout-trg: 0
[2023-06-24 13:17:54] [config] dump-config: ""
[2023-06-24 13:17:54] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] early-stopping: 10
[2023-06-24 13:17:54] [config] early-stopping-on: first
[2023-06-24 13:17:54] [config] embedding-fix-src: false
[2023-06-24 13:17:54] [config] embedding-fix-trg: false
[2023-06-24 13:17:54] [config] embedding-normalization: false
[2023-06-24 13:17:54] [config] embedding-vectors:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] enc-cell: gru
[2023-06-24 13:17:54] [config] enc-cell-depth: 4
[2023-06-24 13:17:54] [config] enc-depth: 1
[2023-06-24 13:17:54] [config] enc-type: bidirectional
[2023-06-24 13:17:54] [config] english-title-case-every: 0
[2023-06-24 13:17:54] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:54] [config] factor-weight: 1
[2023-06-24 13:17:54] [config] factors-combine: sum
[2023-06-24 13:17:54] [config] factors-dim-emb: 0
[2023-06-24 13:17:54] [config] gradient-checkpointing: false
[2023-06-24 13:17:54] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:54] [config] guided-alignment: none
[2023-06-24 13:17:54] [config] guided-alignment-cost: mse
[2023-06-24 13:17:54] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:54] [config] ignore-model-config: false
[2023-06-24 13:17:54] [config] input-types:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] interpolate-env-vars: false
[2023-06-24 13:17:54] [config] keep-best: false
[2023-06-24 13:17:54] [config] label-smoothing: 0.1
[2023-06-24 13:17:54] [config] layer-normalization: true
[2023-06-24 13:17:54] [config] learn-rate: 0.0003
[2023-06-24 13:17:54] [config] lemma-dependency: ""
[2023-06-24 13:17:54] [config] lemma-dim-emb: 0
[2023-06-24 13:17:54] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:54] [config] log-level: info
[2023-06-24 13:17:54] [config] log-time-zone: ""
[2023-06-24 13:17:54] [config] logical-epoch:
[2023-06-24 13:17:54] [config]   - 1e
[2023-06-24 13:17:54] [config]   - 0
[2023-06-24 13:17:54] [config] lr-decay: 0
[2023-06-24 13:17:54] [config] lr-decay-freq: 50000
[2023-06-24 13:17:54] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:54] [config]   - 16000
[2023-06-24 13:17:54] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:54] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:54] [config] lr-decay-start:
[2023-06-24 13:17:54] [config]   - 10
[2023-06-24 13:17:54] [config]   - 1
[2023-06-24 13:17:54] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:54] [config] lr-report: false
[2023-06-24 13:17:54] [config] lr-warmup: 0
[2023-06-24 13:17:54] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:54] [config] lr-warmup-cycle: false
[2023-06-24 13:17:54] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:54] [config] max-length: 100
[2023-06-24 13:17:54] [config] max-length-crop: false
[2023-06-24 13:17:54] [config] max-length-factor: 3
[2023-06-24 13:17:54] [config] maxi-batch: 1000
[2023-06-24 13:17:54] [config] maxi-batch-sort: trg
[2023-06-24 13:17:54] [config] mini-batch: 1000
[2023-06-24 13:17:54] [config] mini-batch-fit: true
[2023-06-24 13:17:54] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:54] [config] mini-batch-round-up: true
[2023-06-24 13:17:54] [config] mini-batch-track-lr: false
[2023-06-24 13:17:54] [config] mini-batch-warmup: 0
[2023-06-24 13:17:54] [config] mini-batch-words: 0
[2023-06-24 13:17:54] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:54] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:54] [config] multi-loss-type: sum
[2023-06-24 13:17:54] [config] n-best: false
[2023-06-24 13:17:54] [config] no-nccl: false
[2023-06-24 13:17:54] [config] no-reload: false
[2023-06-24 13:17:54] [config] no-restore-corpus: false
[2023-06-24 13:17:54] [config] normalize: 1
[2023-06-24 13:17:54] [config] normalize-gradient: false
[2023-06-24 13:17:54] [config] num-devices: 0
[2023-06-24 13:17:54] [config] optimizer: adam
[2023-06-24 13:17:54] [config] optimizer-delay: 1
[2023-06-24 13:17:54] [config] optimizer-params:
[2023-06-24 13:17:54] [config]   - 0.9
[2023-06-24 13:17:54] [config]   - 0.98
[2023-06-24 13:17:54] [config]   - 1e-09
[2023-06-24 13:17:54] [config] output-omit-bias: false
[2023-06-24 13:17:54] [config] overwrite: false
[2023-06-24 13:17:54] [config] precision:
[2023-06-24 13:17:54] [config]   - float32
[2023-06-24 13:17:54] [config]   - float32
[2023-06-24 13:17:54] [config] pretrained-model: ""
[2023-06-24 13:17:54] [config] quantize-biases: false
[2023-06-24 13:17:54] [config] quantize-bits: 0
[2023-06-24 13:17:54] [config] quantize-log-based: false
[2023-06-24 13:17:54] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:54] [config] quiet: false
[2023-06-24 13:17:54] [config] quiet-translation: true
[2023-06-24 13:17:54] [config] relative-paths: false
[2023-06-24 13:17:54] [config] right-left: false
[2023-06-24 13:17:54] [config] save-freq: 10000u
[2023-06-24 13:17:54] [config] seed: 1234
[2023-06-24 13:17:54] [config] sentencepiece-alphas:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:54] [config] sentencepiece-options: ""
[2023-06-24 13:17:54] [config] sharding: global
[2023-06-24 13:17:54] [config] shuffle: data
[2023-06-24 13:17:54] [config] shuffle-in-ram: false
[2023-06-24 13:17:54] [config] sigterm: save-and-exit
[2023-06-24 13:17:54] [config] skip: false
[2023-06-24 13:17:54] [config] sqlite: ""
[2023-06-24 13:17:54] [config] sqlite-drop: false
[2023-06-24 13:17:54] [config] sync-freq: 200u
[2023-06-24 13:17:54] [config] sync-sgd: true
[2023-06-24 13:17:54] [config] tempdir: /tmp
[2023-06-24 13:17:54] [config] tied-embeddings: false
[2023-06-24 13:17:54] [config] tied-embeddings-all: true
[2023-06-24 13:17:54] [config] tied-embeddings-src: false
[2023-06-24 13:17:54] [config] train-embedder-rank:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] train-sets:
[2023-06-24 13:17:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:54] [config] transformer-aan-activation: swish
[2023-06-24 13:17:54] [config] transformer-aan-depth: 2
[2023-06-24 13:17:54] [config] transformer-aan-nogate: false
[2023-06-24 13:17:54] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:54] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:54] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:54] [config] transformer-depth-scaling: false
[2023-06-24 13:17:54] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:54] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:54] [config] transformer-dropout: 0
[2023-06-24 13:17:54] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:54] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:54] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:54] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:54] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:54] [config] transformer-heads: 8
[2023-06-24 13:17:54] [config] transformer-no-projection: false
[2023-06-24 13:17:54] [config] transformer-pool: false
[2023-06-24 13:17:54] [config] transformer-postprocess: dan
[2023-06-24 13:17:54] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:54] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:54] [config] transformer-preprocess: ""
[2023-06-24 13:17:54] [config] transformer-tied-layers:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:54] [config] tsv: false
[2023-06-24 13:17:54] [config] tsv-fields: 0
[2023-06-24 13:17:54] [config] type: s2s
[2023-06-24 13:17:54] [config] ulr: false
[2023-06-24 13:17:54] [config] ulr-dim-emb: 0
[2023-06-24 13:17:54] [config] ulr-dropout: 0
[2023-06-24 13:17:54] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:54] [config] ulr-query-vectors: ""
[2023-06-24 13:17:54] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:54] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:54] [config] unlikelihood-loss: false
[2023-06-24 13:17:54] [config] valid-freq: 5000000
[2023-06-24 13:17:54] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:54] [config] valid-max-length: 1000
[2023-06-24 13:17:54] [config] valid-metrics:
[2023-06-24 13:17:54] [config]   - cross-entropy
[2023-06-24 13:17:54] [config]   - translation
[2023-06-24 13:17:54] [config] valid-mini-batch: 32
[2023-06-24 13:17:54] [config] valid-reset-stalled: false
[2023-06-24 13:17:54] [config] valid-script-args:
[2023-06-24 13:17:54] [config]   []
[2023-06-24 13:17:54] [config] valid-script-path: ""
[2023-06-24 13:17:54] [config] valid-sets:
[2023-06-24 13:17:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:54] [config] vocabs:
[2023-06-24 13:17:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:54] [config] word-penalty: 0
[2023-06-24 13:17:54] [config] word-scores: false
[2023-06-24 13:17:54] [config] workspace: 9500
[2023-06-24 13:17:54] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:54] Using synchronous SGD
[2023-06-24 13:17:54] Synced seed 1234
[2023-06-24 13:17:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:54] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:17:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:54] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:17:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:17:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:17:55] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:17:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:17:55] [comm] Using global sharding
[2023-06-24 13:17:55] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:17:55] [training] Using 1 GPUs
[2023-06-24 13:17:55] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:17:55] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x5636d53f5f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5636d5b8b1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5636d5b8bd6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5636d5b8c785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x5636d5809f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5636d588fd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x5636d587c77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x5636d534d81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x5636d5929306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x5636d5905f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x5636d5407450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5636d5329058]    mainTrainer  (int,  char**)                        + 0x158
[0x5636d52e0b9c]    main                                               + 0x3c
[0x7f7d091b70b3]    __libc_start_main                                  + 0xf3
[0x5636d5327cbe]    _start                                             + 0x2e

[2023-06-24 13:17:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:59] [marian] Running on node07.datos.cluster.uy as process 7146 with command line:
[2023-06-24 13:17:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:17:59] [config] after: 0e
[2023-06-24 13:17:59] [config] after-batches: 0
[2023-06-24 13:17:59] [config] after-epochs: 80
[2023-06-24 13:17:59] [config] all-caps-every: 0
[2023-06-24 13:17:59] [config] allow-unk: false
[2023-06-24 13:17:59] [config] authors: false
[2023-06-24 13:17:59] [config] beam-size: 12
[2023-06-24 13:17:59] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:17:59] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:17:59] [config] bert-masking-fraction: 0.15
[2023-06-24 13:17:59] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:17:59] [config] bert-train-type-embeddings: true
[2023-06-24 13:17:59] [config] bert-type-vocab-size: 2
[2023-06-24 13:17:59] [config] build-info: ""
[2023-06-24 13:17:59] [config] check-gradient-nan: false
[2023-06-24 13:17:59] [config] check-nan: false
[2023-06-24 13:17:59] [config] cite: false
[2023-06-24 13:17:59] [config] clip-norm: 5
[2023-06-24 13:17:59] [config] cost-scaling:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] cost-type: ce-mean-words
[2023-06-24 13:17:59] [config] cpu-threads: 0
[2023-06-24 13:17:59] [config] data-threads: 8
[2023-06-24 13:17:59] [config] data-weighting: ""
[2023-06-24 13:17:59] [config] data-weighting-type: sentence
[2023-06-24 13:17:59] [config] dec-cell: gru
[2023-06-24 13:17:59] [config] dec-cell-base-depth: 8
[2023-06-24 13:17:59] [config] dec-cell-high-depth: 1
[2023-06-24 13:17:59] [config] dec-depth: 1
[2023-06-24 13:17:59] [config] devices:
[2023-06-24 13:17:59] [config]   - 0
[2023-06-24 13:17:59] [config] dim-emb: 512
[2023-06-24 13:17:59] [config] dim-rnn: 1024
[2023-06-24 13:17:59] [config] dim-vocabs:
[2023-06-24 13:17:59] [config]   - 0
[2023-06-24 13:17:59] [config]   - 0
[2023-06-24 13:17:59] [config] disp-first: 0
[2023-06-24 13:17:59] [config] disp-freq: 1000u
[2023-06-24 13:17:59] [config] disp-label-counts: true
[2023-06-24 13:17:59] [config] dropout-rnn: 0.1
[2023-06-24 13:17:59] [config] dropout-src: 0
[2023-06-24 13:17:59] [config] dropout-trg: 0
[2023-06-24 13:17:59] [config] dump-config: ""
[2023-06-24 13:17:59] [config] dynamic-gradient-scaling:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] early-stopping: 10
[2023-06-24 13:17:59] [config] early-stopping-on: first
[2023-06-24 13:17:59] [config] embedding-fix-src: false
[2023-06-24 13:17:59] [config] embedding-fix-trg: false
[2023-06-24 13:17:59] [config] embedding-normalization: false
[2023-06-24 13:17:59] [config] embedding-vectors:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] enc-cell: gru
[2023-06-24 13:17:59] [config] enc-cell-depth: 4
[2023-06-24 13:17:59] [config] enc-depth: 1
[2023-06-24 13:17:59] [config] enc-type: bidirectional
[2023-06-24 13:17:59] [config] english-title-case-every: 0
[2023-06-24 13:17:59] [config] exponential-smoothing: 0.0001
[2023-06-24 13:17:59] [config] factor-weight: 1
[2023-06-24 13:17:59] [config] factors-combine: sum
[2023-06-24 13:17:59] [config] factors-dim-emb: 0
[2023-06-24 13:17:59] [config] gradient-checkpointing: false
[2023-06-24 13:17:59] [config] gradient-norm-average-window: 100
[2023-06-24 13:17:59] [config] guided-alignment: none
[2023-06-24 13:17:59] [config] guided-alignment-cost: mse
[2023-06-24 13:17:59] [config] guided-alignment-weight: 0.1
[2023-06-24 13:17:59] [config] ignore-model-config: false
[2023-06-24 13:17:59] [config] input-types:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] interpolate-env-vars: false
[2023-06-24 13:17:59] [config] keep-best: false
[2023-06-24 13:17:59] [config] label-smoothing: 0.1
[2023-06-24 13:17:59] [config] layer-normalization: true
[2023-06-24 13:17:59] [config] learn-rate: 0.0003
[2023-06-24 13:17:59] [config] lemma-dependency: ""
[2023-06-24 13:17:59] [config] lemma-dim-emb: 0
[2023-06-24 13:17:59] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:17:59] [config] log-level: info
[2023-06-24 13:17:59] [config] log-time-zone: ""
[2023-06-24 13:17:59] [config] logical-epoch:
[2023-06-24 13:17:59] [config]   - 1e
[2023-06-24 13:17:59] [config]   - 0
[2023-06-24 13:17:59] [config] lr-decay: 0
[2023-06-24 13:17:59] [config] lr-decay-freq: 50000
[2023-06-24 13:17:59] [config] lr-decay-inv-sqrt:
[2023-06-24 13:17:59] [config]   - 16000
[2023-06-24 13:17:59] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:17:59] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:17:59] [config] lr-decay-start:
[2023-06-24 13:17:59] [config]   - 10
[2023-06-24 13:17:59] [config]   - 1
[2023-06-24 13:17:59] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:17:59] [config] lr-report: false
[2023-06-24 13:17:59] [config] lr-warmup: 0
[2023-06-24 13:17:59] [config] lr-warmup-at-reload: false
[2023-06-24 13:17:59] [config] lr-warmup-cycle: false
[2023-06-24 13:17:59] [config] lr-warmup-start-rate: 0
[2023-06-24 13:17:59] [config] max-length: 100
[2023-06-24 13:17:59] [config] max-length-crop: false
[2023-06-24 13:17:59] [config] max-length-factor: 3
[2023-06-24 13:17:59] [config] maxi-batch: 1000
[2023-06-24 13:17:59] [config] maxi-batch-sort: trg
[2023-06-24 13:17:59] [config] mini-batch: 1000
[2023-06-24 13:17:59] [config] mini-batch-fit: true
[2023-06-24 13:17:59] [config] mini-batch-fit-step: 10
[2023-06-24 13:17:59] [config] mini-batch-round-up: true
[2023-06-24 13:17:59] [config] mini-batch-track-lr: false
[2023-06-24 13:17:59] [config] mini-batch-warmup: 0
[2023-06-24 13:17:59] [config] mini-batch-words: 0
[2023-06-24 13:17:59] [config] mini-batch-words-ref: 0
[2023-06-24 13:17:59] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:17:59] [config] multi-loss-type: sum
[2023-06-24 13:17:59] [config] n-best: false
[2023-06-24 13:17:59] [config] no-nccl: false
[2023-06-24 13:17:59] [config] no-reload: false
[2023-06-24 13:17:59] [config] no-restore-corpus: false
[2023-06-24 13:17:59] [config] normalize: 1
[2023-06-24 13:17:59] [config] normalize-gradient: false
[2023-06-24 13:17:59] [config] num-devices: 0
[2023-06-24 13:17:59] [config] optimizer: adam
[2023-06-24 13:17:59] [config] optimizer-delay: 1
[2023-06-24 13:17:59] [config] optimizer-params:
[2023-06-24 13:17:59] [config]   - 0.9
[2023-06-24 13:17:59] [config]   - 0.98
[2023-06-24 13:17:59] [config]   - 1e-09
[2023-06-24 13:17:59] [config] output-omit-bias: false
[2023-06-24 13:17:59] [config] overwrite: false
[2023-06-24 13:17:59] [config] precision:
[2023-06-24 13:17:59] [config]   - float32
[2023-06-24 13:17:59] [config]   - float32
[2023-06-24 13:17:59] [config] pretrained-model: ""
[2023-06-24 13:17:59] [config] quantize-biases: false
[2023-06-24 13:17:59] [config] quantize-bits: 0
[2023-06-24 13:17:59] [config] quantize-log-based: false
[2023-06-24 13:17:59] [config] quantize-optimization-steps: 0
[2023-06-24 13:17:59] [config] quiet: false
[2023-06-24 13:17:59] [config] quiet-translation: true
[2023-06-24 13:17:59] [config] relative-paths: false
[2023-06-24 13:17:59] [config] right-left: false
[2023-06-24 13:17:59] [config] save-freq: 10000u
[2023-06-24 13:17:59] [config] seed: 1234
[2023-06-24 13:17:59] [config] sentencepiece-alphas:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:17:59] [config] sentencepiece-options: ""
[2023-06-24 13:17:59] [config] sharding: global
[2023-06-24 13:17:59] [config] shuffle: data
[2023-06-24 13:17:59] [config] shuffle-in-ram: false
[2023-06-24 13:17:59] [config] sigterm: save-and-exit
[2023-06-24 13:17:59] [config] skip: false
[2023-06-24 13:17:59] [config] sqlite: ""
[2023-06-24 13:17:59] [config] sqlite-drop: false
[2023-06-24 13:17:59] [config] sync-freq: 200u
[2023-06-24 13:17:59] [config] sync-sgd: true
[2023-06-24 13:17:59] [config] tempdir: /tmp
[2023-06-24 13:17:59] [config] tied-embeddings: false
[2023-06-24 13:17:59] [config] tied-embeddings-all: true
[2023-06-24 13:17:59] [config] tied-embeddings-src: false
[2023-06-24 13:17:59] [config] train-embedder-rank:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] train-sets:
[2023-06-24 13:17:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:17:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:17:59] [config] transformer-aan-activation: swish
[2023-06-24 13:17:59] [config] transformer-aan-depth: 2
[2023-06-24 13:17:59] [config] transformer-aan-nogate: false
[2023-06-24 13:17:59] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:17:59] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:17:59] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:17:59] [config] transformer-depth-scaling: false
[2023-06-24 13:17:59] [config] transformer-dim-aan: 2048
[2023-06-24 13:17:59] [config] transformer-dim-ffn: 2048
[2023-06-24 13:17:59] [config] transformer-dropout: 0
[2023-06-24 13:17:59] [config] transformer-dropout-attention: 0
[2023-06-24 13:17:59] [config] transformer-dropout-ffn: 0
[2023-06-24 13:17:59] [config] transformer-ffn-activation: swish
[2023-06-24 13:17:59] [config] transformer-ffn-depth: 2
[2023-06-24 13:17:59] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:17:59] [config] transformer-heads: 8
[2023-06-24 13:17:59] [config] transformer-no-projection: false
[2023-06-24 13:17:59] [config] transformer-pool: false
[2023-06-24 13:17:59] [config] transformer-postprocess: dan
[2023-06-24 13:17:59] [config] transformer-postprocess-emb: d
[2023-06-24 13:17:59] [config] transformer-postprocess-top: ""
[2023-06-24 13:17:59] [config] transformer-preprocess: ""
[2023-06-24 13:17:59] [config] transformer-tied-layers:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] transformer-train-position-embeddings: false
[2023-06-24 13:17:59] [config] tsv: false
[2023-06-24 13:17:59] [config] tsv-fields: 0
[2023-06-24 13:17:59] [config] type: s2s
[2023-06-24 13:17:59] [config] ulr: false
[2023-06-24 13:17:59] [config] ulr-dim-emb: 0
[2023-06-24 13:17:59] [config] ulr-dropout: 0
[2023-06-24 13:17:59] [config] ulr-keys-vectors: ""
[2023-06-24 13:17:59] [config] ulr-query-vectors: ""
[2023-06-24 13:17:59] [config] ulr-softmax-temperature: 1
[2023-06-24 13:17:59] [config] ulr-trainable-transformation: false
[2023-06-24 13:17:59] [config] unlikelihood-loss: false
[2023-06-24 13:17:59] [config] valid-freq: 5000000
[2023-06-24 13:17:59] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:17:59] [config] valid-max-length: 1000
[2023-06-24 13:17:59] [config] valid-metrics:
[2023-06-24 13:17:59] [config]   - cross-entropy
[2023-06-24 13:17:59] [config]   - translation
[2023-06-24 13:17:59] [config] valid-mini-batch: 32
[2023-06-24 13:17:59] [config] valid-reset-stalled: false
[2023-06-24 13:17:59] [config] valid-script-args:
[2023-06-24 13:17:59] [config]   []
[2023-06-24 13:17:59] [config] valid-script-path: ""
[2023-06-24 13:17:59] [config] valid-sets:
[2023-06-24 13:17:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:17:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:17:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:17:59] [config] vocabs:
[2023-06-24 13:17:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:17:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:17:59] [config] word-penalty: 0
[2023-06-24 13:17:59] [config] word-scores: false
[2023-06-24 13:17:59] [config] workspace: 9500
[2023-06-24 13:17:59] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:17:59] Using synchronous SGD
[2023-06-24 13:18:00] Synced seed 1234
[2023-06-24 13:18:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:18:00] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:18:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:18:00] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:18:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:18:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:18:00] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:18:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:18:00] [comm] Using global sharding
[2023-06-24 13:18:00] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:18:00] [training] Using 1 GPUs
[2023-06-24 13:18:00] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:18:00] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x563964bdbf01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5639653711fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x563965371d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x563965372785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x563964feff3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x563965075d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x56396506277c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x563964b3381d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x56396510f306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x5639650ebf2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x563964bed450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x563964b0f058]    mainTrainer  (int,  char**)                        + 0x158
[0x563964ac6b9c]    main                                               + 0x3c
[0x7fef4afc40b3]    __libc_start_main                                  + 0xf3
[0x563964b0dcbe]    _start                                             + 0x2e

[2023-06-24 13:18:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:18:05] [marian] Running on node07.datos.cluster.uy as process 7176 with command line:
[2023-06-24 13:18:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:18:05] [config] after: 0e
[2023-06-24 13:18:05] [config] after-batches: 0
[2023-06-24 13:18:05] [config] after-epochs: 90
[2023-06-24 13:18:05] [config] all-caps-every: 0
[2023-06-24 13:18:05] [config] allow-unk: false
[2023-06-24 13:18:05] [config] authors: false
[2023-06-24 13:18:05] [config] beam-size: 12
[2023-06-24 13:18:05] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:18:05] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:18:05] [config] bert-masking-fraction: 0.15
[2023-06-24 13:18:05] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:18:05] [config] bert-train-type-embeddings: true
[2023-06-24 13:18:05] [config] bert-type-vocab-size: 2
[2023-06-24 13:18:05] [config] build-info: ""
[2023-06-24 13:18:05] [config] check-gradient-nan: false
[2023-06-24 13:18:05] [config] check-nan: false
[2023-06-24 13:18:05] [config] cite: false
[2023-06-24 13:18:05] [config] clip-norm: 5
[2023-06-24 13:18:05] [config] cost-scaling:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] cost-type: ce-mean-words
[2023-06-24 13:18:05] [config] cpu-threads: 0
[2023-06-24 13:18:05] [config] data-threads: 8
[2023-06-24 13:18:05] [config] data-weighting: ""
[2023-06-24 13:18:05] [config] data-weighting-type: sentence
[2023-06-24 13:18:05] [config] dec-cell: gru
[2023-06-24 13:18:05] [config] dec-cell-base-depth: 8
[2023-06-24 13:18:05] [config] dec-cell-high-depth: 1
[2023-06-24 13:18:05] [config] dec-depth: 1
[2023-06-24 13:18:05] [config] devices:
[2023-06-24 13:18:05] [config]   - 0
[2023-06-24 13:18:05] [config] dim-emb: 512
[2023-06-24 13:18:05] [config] dim-rnn: 1024
[2023-06-24 13:18:05] [config] dim-vocabs:
[2023-06-24 13:18:05] [config]   - 0
[2023-06-24 13:18:05] [config]   - 0
[2023-06-24 13:18:05] [config] disp-first: 0
[2023-06-24 13:18:05] [config] disp-freq: 1000u
[2023-06-24 13:18:05] [config] disp-label-counts: true
[2023-06-24 13:18:05] [config] dropout-rnn: 0.1
[2023-06-24 13:18:05] [config] dropout-src: 0
[2023-06-24 13:18:05] [config] dropout-trg: 0
[2023-06-24 13:18:05] [config] dump-config: ""
[2023-06-24 13:18:05] [config] dynamic-gradient-scaling:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] early-stopping: 10
[2023-06-24 13:18:05] [config] early-stopping-on: first
[2023-06-24 13:18:05] [config] embedding-fix-src: false
[2023-06-24 13:18:05] [config] embedding-fix-trg: false
[2023-06-24 13:18:05] [config] embedding-normalization: false
[2023-06-24 13:18:05] [config] embedding-vectors:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] enc-cell: gru
[2023-06-24 13:18:05] [config] enc-cell-depth: 4
[2023-06-24 13:18:05] [config] enc-depth: 1
[2023-06-24 13:18:05] [config] enc-type: bidirectional
[2023-06-24 13:18:05] [config] english-title-case-every: 0
[2023-06-24 13:18:05] [config] exponential-smoothing: 0.0001
[2023-06-24 13:18:05] [config] factor-weight: 1
[2023-06-24 13:18:05] [config] factors-combine: sum
[2023-06-24 13:18:05] [config] factors-dim-emb: 0
[2023-06-24 13:18:05] [config] gradient-checkpointing: false
[2023-06-24 13:18:05] [config] gradient-norm-average-window: 100
[2023-06-24 13:18:05] [config] guided-alignment: none
[2023-06-24 13:18:05] [config] guided-alignment-cost: mse
[2023-06-24 13:18:05] [config] guided-alignment-weight: 0.1
[2023-06-24 13:18:05] [config] ignore-model-config: false
[2023-06-24 13:18:05] [config] input-types:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] interpolate-env-vars: false
[2023-06-24 13:18:05] [config] keep-best: false
[2023-06-24 13:18:05] [config] label-smoothing: 0.1
[2023-06-24 13:18:05] [config] layer-normalization: true
[2023-06-24 13:18:05] [config] learn-rate: 0.0003
[2023-06-24 13:18:05] [config] lemma-dependency: ""
[2023-06-24 13:18:05] [config] lemma-dim-emb: 0
[2023-06-24 13:18:05] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:18:05] [config] log-level: info
[2023-06-24 13:18:05] [config] log-time-zone: ""
[2023-06-24 13:18:05] [config] logical-epoch:
[2023-06-24 13:18:05] [config]   - 1e
[2023-06-24 13:18:05] [config]   - 0
[2023-06-24 13:18:05] [config] lr-decay: 0
[2023-06-24 13:18:05] [config] lr-decay-freq: 50000
[2023-06-24 13:18:05] [config] lr-decay-inv-sqrt:
[2023-06-24 13:18:05] [config]   - 16000
[2023-06-24 13:18:05] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:18:05] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:18:05] [config] lr-decay-start:
[2023-06-24 13:18:05] [config]   - 10
[2023-06-24 13:18:05] [config]   - 1
[2023-06-24 13:18:05] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:18:05] [config] lr-report: false
[2023-06-24 13:18:05] [config] lr-warmup: 0
[2023-06-24 13:18:05] [config] lr-warmup-at-reload: false
[2023-06-24 13:18:05] [config] lr-warmup-cycle: false
[2023-06-24 13:18:05] [config] lr-warmup-start-rate: 0
[2023-06-24 13:18:05] [config] max-length: 100
[2023-06-24 13:18:05] [config] max-length-crop: false
[2023-06-24 13:18:05] [config] max-length-factor: 3
[2023-06-24 13:18:05] [config] maxi-batch: 1000
[2023-06-24 13:18:05] [config] maxi-batch-sort: trg
[2023-06-24 13:18:05] [config] mini-batch: 1000
[2023-06-24 13:18:05] [config] mini-batch-fit: true
[2023-06-24 13:18:05] [config] mini-batch-fit-step: 10
[2023-06-24 13:18:05] [config] mini-batch-round-up: true
[2023-06-24 13:18:05] [config] mini-batch-track-lr: false
[2023-06-24 13:18:05] [config] mini-batch-warmup: 0
[2023-06-24 13:18:05] [config] mini-batch-words: 0
[2023-06-24 13:18:05] [config] mini-batch-words-ref: 0
[2023-06-24 13:18:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:18:05] [config] multi-loss-type: sum
[2023-06-24 13:18:05] [config] n-best: false
[2023-06-24 13:18:05] [config] no-nccl: false
[2023-06-24 13:18:05] [config] no-reload: false
[2023-06-24 13:18:05] [config] no-restore-corpus: false
[2023-06-24 13:18:05] [config] normalize: 1
[2023-06-24 13:18:05] [config] normalize-gradient: false
[2023-06-24 13:18:05] [config] num-devices: 0
[2023-06-24 13:18:05] [config] optimizer: adam
[2023-06-24 13:18:05] [config] optimizer-delay: 1
[2023-06-24 13:18:05] [config] optimizer-params:
[2023-06-24 13:18:05] [config]   - 0.9
[2023-06-24 13:18:05] [config]   - 0.98
[2023-06-24 13:18:05] [config]   - 1e-09
[2023-06-24 13:18:05] [config] output-omit-bias: false
[2023-06-24 13:18:05] [config] overwrite: false
[2023-06-24 13:18:05] [config] precision:
[2023-06-24 13:18:05] [config]   - float32
[2023-06-24 13:18:05] [config]   - float32
[2023-06-24 13:18:05] [config] pretrained-model: ""
[2023-06-24 13:18:05] [config] quantize-biases: false
[2023-06-24 13:18:05] [config] quantize-bits: 0
[2023-06-24 13:18:05] [config] quantize-log-based: false
[2023-06-24 13:18:05] [config] quantize-optimization-steps: 0
[2023-06-24 13:18:05] [config] quiet: false
[2023-06-24 13:18:05] [config] quiet-translation: true
[2023-06-24 13:18:05] [config] relative-paths: false
[2023-06-24 13:18:05] [config] right-left: false
[2023-06-24 13:18:05] [config] save-freq: 10000u
[2023-06-24 13:18:05] [config] seed: 1234
[2023-06-24 13:18:05] [config] sentencepiece-alphas:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:18:05] [config] sentencepiece-options: ""
[2023-06-24 13:18:05] [config] sharding: global
[2023-06-24 13:18:05] [config] shuffle: data
[2023-06-24 13:18:05] [config] shuffle-in-ram: false
[2023-06-24 13:18:05] [config] sigterm: save-and-exit
[2023-06-24 13:18:05] [config] skip: false
[2023-06-24 13:18:05] [config] sqlite: ""
[2023-06-24 13:18:05] [config] sqlite-drop: false
[2023-06-24 13:18:05] [config] sync-freq: 200u
[2023-06-24 13:18:05] [config] sync-sgd: true
[2023-06-24 13:18:05] [config] tempdir: /tmp
[2023-06-24 13:18:05] [config] tied-embeddings: false
[2023-06-24 13:18:05] [config] tied-embeddings-all: true
[2023-06-24 13:18:05] [config] tied-embeddings-src: false
[2023-06-24 13:18:05] [config] train-embedder-rank:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] train-sets:
[2023-06-24 13:18:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:18:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:18:05] [config] transformer-aan-activation: swish
[2023-06-24 13:18:05] [config] transformer-aan-depth: 2
[2023-06-24 13:18:05] [config] transformer-aan-nogate: false
[2023-06-24 13:18:05] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:18:05] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:18:05] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:18:05] [config] transformer-depth-scaling: false
[2023-06-24 13:18:05] [config] transformer-dim-aan: 2048
[2023-06-24 13:18:05] [config] transformer-dim-ffn: 2048
[2023-06-24 13:18:05] [config] transformer-dropout: 0
[2023-06-24 13:18:05] [config] transformer-dropout-attention: 0
[2023-06-24 13:18:05] [config] transformer-dropout-ffn: 0
[2023-06-24 13:18:05] [config] transformer-ffn-activation: swish
[2023-06-24 13:18:05] [config] transformer-ffn-depth: 2
[2023-06-24 13:18:05] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:18:05] [config] transformer-heads: 8
[2023-06-24 13:18:05] [config] transformer-no-projection: false
[2023-06-24 13:18:05] [config] transformer-pool: false
[2023-06-24 13:18:05] [config] transformer-postprocess: dan
[2023-06-24 13:18:05] [config] transformer-postprocess-emb: d
[2023-06-24 13:18:05] [config] transformer-postprocess-top: ""
[2023-06-24 13:18:05] [config] transformer-preprocess: ""
[2023-06-24 13:18:05] [config] transformer-tied-layers:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] transformer-train-position-embeddings: false
[2023-06-24 13:18:05] [config] tsv: false
[2023-06-24 13:18:05] [config] tsv-fields: 0
[2023-06-24 13:18:05] [config] type: s2s
[2023-06-24 13:18:05] [config] ulr: false
[2023-06-24 13:18:05] [config] ulr-dim-emb: 0
[2023-06-24 13:18:05] [config] ulr-dropout: 0
[2023-06-24 13:18:05] [config] ulr-keys-vectors: ""
[2023-06-24 13:18:05] [config] ulr-query-vectors: ""
[2023-06-24 13:18:05] [config] ulr-softmax-temperature: 1
[2023-06-24 13:18:05] [config] ulr-trainable-transformation: false
[2023-06-24 13:18:05] [config] unlikelihood-loss: false
[2023-06-24 13:18:05] [config] valid-freq: 5000000
[2023-06-24 13:18:05] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:18:05] [config] valid-max-length: 1000
[2023-06-24 13:18:05] [config] valid-metrics:
[2023-06-24 13:18:05] [config]   - cross-entropy
[2023-06-24 13:18:05] [config]   - translation
[2023-06-24 13:18:05] [config] valid-mini-batch: 32
[2023-06-24 13:18:05] [config] valid-reset-stalled: false
[2023-06-24 13:18:05] [config] valid-script-args:
[2023-06-24 13:18:05] [config]   []
[2023-06-24 13:18:05] [config] valid-script-path: ""
[2023-06-24 13:18:05] [config] valid-sets:
[2023-06-24 13:18:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:18:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:18:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:18:05] [config] vocabs:
[2023-06-24 13:18:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:18:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:18:05] [config] word-penalty: 0
[2023-06-24 13:18:05] [config] word-scores: false
[2023-06-24 13:18:05] [config] workspace: 9500
[2023-06-24 13:18:05] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:18:05] Using synchronous SGD
[2023-06-24 13:18:05] Synced seed 1234
[2023-06-24 13:18:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:18:05] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:18:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:18:05] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:18:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:18:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:18:06] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:18:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:18:06] [comm] Using global sharding
[2023-06-24 13:18:06] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:18:06] [training] Using 1 GPUs
[2023-06-24 13:18:06] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:18:06] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x564451042f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5644517d81fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5644517d8d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5644517d9785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x564451456f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5644514dcd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x5644514c977c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x564450f9a81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x564451576306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x564451552f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x564451054450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x564450f76058]    mainTrainer  (int,  char**)                        + 0x158
[0x564450f2db9c]    main                                               + 0x3c
[0x7f2e1265d0b3]    __libc_start_main                                  + 0xf3
[0x564450f74cbe]    _start                                             + 0x2e

[2023-06-24 13:18:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:18:10] [marian] Running on node07.datos.cluster.uy as process 7205 with command line:
[2023-06-24 13:18:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings-all --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:18:10] [config] after: 0e
[2023-06-24 13:18:10] [config] after-batches: 0
[2023-06-24 13:18:10] [config] after-epochs: 100
[2023-06-24 13:18:10] [config] all-caps-every: 0
[2023-06-24 13:18:10] [config] allow-unk: false
[2023-06-24 13:18:10] [config] authors: false
[2023-06-24 13:18:10] [config] beam-size: 12
[2023-06-24 13:18:10] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:18:10] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:18:10] [config] bert-masking-fraction: 0.15
[2023-06-24 13:18:10] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:18:10] [config] bert-train-type-embeddings: true
[2023-06-24 13:18:10] [config] bert-type-vocab-size: 2
[2023-06-24 13:18:10] [config] build-info: ""
[2023-06-24 13:18:10] [config] check-gradient-nan: false
[2023-06-24 13:18:10] [config] check-nan: false
[2023-06-24 13:18:10] [config] cite: false
[2023-06-24 13:18:10] [config] clip-norm: 5
[2023-06-24 13:18:10] [config] cost-scaling:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] cost-type: ce-mean-words
[2023-06-24 13:18:10] [config] cpu-threads: 0
[2023-06-24 13:18:10] [config] data-threads: 8
[2023-06-24 13:18:10] [config] data-weighting: ""
[2023-06-24 13:18:10] [config] data-weighting-type: sentence
[2023-06-24 13:18:10] [config] dec-cell: gru
[2023-06-24 13:18:10] [config] dec-cell-base-depth: 8
[2023-06-24 13:18:10] [config] dec-cell-high-depth: 1
[2023-06-24 13:18:10] [config] dec-depth: 1
[2023-06-24 13:18:10] [config] devices:
[2023-06-24 13:18:10] [config]   - 0
[2023-06-24 13:18:10] [config] dim-emb: 512
[2023-06-24 13:18:10] [config] dim-rnn: 1024
[2023-06-24 13:18:10] [config] dim-vocabs:
[2023-06-24 13:18:10] [config]   - 0
[2023-06-24 13:18:10] [config]   - 0
[2023-06-24 13:18:10] [config] disp-first: 0
[2023-06-24 13:18:10] [config] disp-freq: 1000u
[2023-06-24 13:18:10] [config] disp-label-counts: true
[2023-06-24 13:18:10] [config] dropout-rnn: 0.1
[2023-06-24 13:18:10] [config] dropout-src: 0
[2023-06-24 13:18:10] [config] dropout-trg: 0
[2023-06-24 13:18:10] [config] dump-config: ""
[2023-06-24 13:18:10] [config] dynamic-gradient-scaling:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] early-stopping: 10
[2023-06-24 13:18:10] [config] early-stopping-on: first
[2023-06-24 13:18:10] [config] embedding-fix-src: false
[2023-06-24 13:18:10] [config] embedding-fix-trg: false
[2023-06-24 13:18:10] [config] embedding-normalization: false
[2023-06-24 13:18:10] [config] embedding-vectors:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] enc-cell: gru
[2023-06-24 13:18:10] [config] enc-cell-depth: 4
[2023-06-24 13:18:10] [config] enc-depth: 1
[2023-06-24 13:18:10] [config] enc-type: bidirectional
[2023-06-24 13:18:10] [config] english-title-case-every: 0
[2023-06-24 13:18:10] [config] exponential-smoothing: 0.0001
[2023-06-24 13:18:10] [config] factor-weight: 1
[2023-06-24 13:18:10] [config] factors-combine: sum
[2023-06-24 13:18:10] [config] factors-dim-emb: 0
[2023-06-24 13:18:10] [config] gradient-checkpointing: false
[2023-06-24 13:18:10] [config] gradient-norm-average-window: 100
[2023-06-24 13:18:10] [config] guided-alignment: none
[2023-06-24 13:18:10] [config] guided-alignment-cost: mse
[2023-06-24 13:18:10] [config] guided-alignment-weight: 0.1
[2023-06-24 13:18:10] [config] ignore-model-config: false
[2023-06-24 13:18:10] [config] input-types:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] interpolate-env-vars: false
[2023-06-24 13:18:10] [config] keep-best: false
[2023-06-24 13:18:10] [config] label-smoothing: 0.1
[2023-06-24 13:18:10] [config] layer-normalization: true
[2023-06-24 13:18:10] [config] learn-rate: 0.0003
[2023-06-24 13:18:10] [config] lemma-dependency: ""
[2023-06-24 13:18:10] [config] lemma-dim-emb: 0
[2023-06-24 13:18:10] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:18:10] [config] log-level: info
[2023-06-24 13:18:10] [config] log-time-zone: ""
[2023-06-24 13:18:10] [config] logical-epoch:
[2023-06-24 13:18:10] [config]   - 1e
[2023-06-24 13:18:10] [config]   - 0
[2023-06-24 13:18:10] [config] lr-decay: 0
[2023-06-24 13:18:10] [config] lr-decay-freq: 50000
[2023-06-24 13:18:10] [config] lr-decay-inv-sqrt:
[2023-06-24 13:18:10] [config]   - 16000
[2023-06-24 13:18:10] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:18:10] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:18:10] [config] lr-decay-start:
[2023-06-24 13:18:10] [config]   - 10
[2023-06-24 13:18:10] [config]   - 1
[2023-06-24 13:18:10] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:18:10] [config] lr-report: false
[2023-06-24 13:18:10] [config] lr-warmup: 0
[2023-06-24 13:18:10] [config] lr-warmup-at-reload: false
[2023-06-24 13:18:10] [config] lr-warmup-cycle: false
[2023-06-24 13:18:10] [config] lr-warmup-start-rate: 0
[2023-06-24 13:18:10] [config] max-length: 100
[2023-06-24 13:18:10] [config] max-length-crop: false
[2023-06-24 13:18:10] [config] max-length-factor: 3
[2023-06-24 13:18:10] [config] maxi-batch: 1000
[2023-06-24 13:18:10] [config] maxi-batch-sort: trg
[2023-06-24 13:18:10] [config] mini-batch: 1000
[2023-06-24 13:18:10] [config] mini-batch-fit: true
[2023-06-24 13:18:10] [config] mini-batch-fit-step: 10
[2023-06-24 13:18:10] [config] mini-batch-round-up: true
[2023-06-24 13:18:10] [config] mini-batch-track-lr: false
[2023-06-24 13:18:10] [config] mini-batch-warmup: 0
[2023-06-24 13:18:10] [config] mini-batch-words: 0
[2023-06-24 13:18:10] [config] mini-batch-words-ref: 0
[2023-06-24 13:18:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:18:10] [config] multi-loss-type: sum
[2023-06-24 13:18:10] [config] n-best: false
[2023-06-24 13:18:10] [config] no-nccl: false
[2023-06-24 13:18:10] [config] no-reload: false
[2023-06-24 13:18:10] [config] no-restore-corpus: false
[2023-06-24 13:18:10] [config] normalize: 1
[2023-06-24 13:18:10] [config] normalize-gradient: false
[2023-06-24 13:18:10] [config] num-devices: 0
[2023-06-24 13:18:10] [config] optimizer: adam
[2023-06-24 13:18:10] [config] optimizer-delay: 1
[2023-06-24 13:18:10] [config] optimizer-params:
[2023-06-24 13:18:10] [config]   - 0.9
[2023-06-24 13:18:10] [config]   - 0.98
[2023-06-24 13:18:10] [config]   - 1e-09
[2023-06-24 13:18:10] [config] output-omit-bias: false
[2023-06-24 13:18:10] [config] overwrite: false
[2023-06-24 13:18:10] [config] precision:
[2023-06-24 13:18:10] [config]   - float32
[2023-06-24 13:18:10] [config]   - float32
[2023-06-24 13:18:10] [config] pretrained-model: ""
[2023-06-24 13:18:10] [config] quantize-biases: false
[2023-06-24 13:18:10] [config] quantize-bits: 0
[2023-06-24 13:18:10] [config] quantize-log-based: false
[2023-06-24 13:18:10] [config] quantize-optimization-steps: 0
[2023-06-24 13:18:10] [config] quiet: false
[2023-06-24 13:18:10] [config] quiet-translation: true
[2023-06-24 13:18:10] [config] relative-paths: false
[2023-06-24 13:18:10] [config] right-left: false
[2023-06-24 13:18:10] [config] save-freq: 10000u
[2023-06-24 13:18:10] [config] seed: 1234
[2023-06-24 13:18:10] [config] sentencepiece-alphas:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:18:10] [config] sentencepiece-options: ""
[2023-06-24 13:18:10] [config] sharding: global
[2023-06-24 13:18:10] [config] shuffle: data
[2023-06-24 13:18:10] [config] shuffle-in-ram: false
[2023-06-24 13:18:10] [config] sigterm: save-and-exit
[2023-06-24 13:18:10] [config] skip: false
[2023-06-24 13:18:10] [config] sqlite: ""
[2023-06-24 13:18:10] [config] sqlite-drop: false
[2023-06-24 13:18:10] [config] sync-freq: 200u
[2023-06-24 13:18:10] [config] sync-sgd: true
[2023-06-24 13:18:10] [config] tempdir: /tmp
[2023-06-24 13:18:10] [config] tied-embeddings: false
[2023-06-24 13:18:10] [config] tied-embeddings-all: true
[2023-06-24 13:18:10] [config] tied-embeddings-src: false
[2023-06-24 13:18:10] [config] train-embedder-rank:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] train-sets:
[2023-06-24 13:18:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:18:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:18:10] [config] transformer-aan-activation: swish
[2023-06-24 13:18:10] [config] transformer-aan-depth: 2
[2023-06-24 13:18:10] [config] transformer-aan-nogate: false
[2023-06-24 13:18:10] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:18:10] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:18:10] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:18:10] [config] transformer-depth-scaling: false
[2023-06-24 13:18:10] [config] transformer-dim-aan: 2048
[2023-06-24 13:18:10] [config] transformer-dim-ffn: 2048
[2023-06-24 13:18:10] [config] transformer-dropout: 0
[2023-06-24 13:18:10] [config] transformer-dropout-attention: 0
[2023-06-24 13:18:10] [config] transformer-dropout-ffn: 0
[2023-06-24 13:18:10] [config] transformer-ffn-activation: swish
[2023-06-24 13:18:10] [config] transformer-ffn-depth: 2
[2023-06-24 13:18:10] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:18:10] [config] transformer-heads: 8
[2023-06-24 13:18:10] [config] transformer-no-projection: false
[2023-06-24 13:18:10] [config] transformer-pool: false
[2023-06-24 13:18:10] [config] transformer-postprocess: dan
[2023-06-24 13:18:10] [config] transformer-postprocess-emb: d
[2023-06-24 13:18:10] [config] transformer-postprocess-top: ""
[2023-06-24 13:18:10] [config] transformer-preprocess: ""
[2023-06-24 13:18:10] [config] transformer-tied-layers:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] transformer-train-position-embeddings: false
[2023-06-24 13:18:10] [config] tsv: false
[2023-06-24 13:18:10] [config] tsv-fields: 0
[2023-06-24 13:18:10] [config] type: s2s
[2023-06-24 13:18:10] [config] ulr: false
[2023-06-24 13:18:10] [config] ulr-dim-emb: 0
[2023-06-24 13:18:10] [config] ulr-dropout: 0
[2023-06-24 13:18:10] [config] ulr-keys-vectors: ""
[2023-06-24 13:18:10] [config] ulr-query-vectors: ""
[2023-06-24 13:18:10] [config] ulr-softmax-temperature: 1
[2023-06-24 13:18:10] [config] ulr-trainable-transformation: false
[2023-06-24 13:18:10] [config] unlikelihood-loss: false
[2023-06-24 13:18:10] [config] valid-freq: 5000000
[2023-06-24 13:18:10] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:18:10] [config] valid-max-length: 1000
[2023-06-24 13:18:10] [config] valid-metrics:
[2023-06-24 13:18:10] [config]   - cross-entropy
[2023-06-24 13:18:10] [config]   - translation
[2023-06-24 13:18:10] [config] valid-mini-batch: 32
[2023-06-24 13:18:10] [config] valid-reset-stalled: false
[2023-06-24 13:18:10] [config] valid-script-args:
[2023-06-24 13:18:10] [config]   []
[2023-06-24 13:18:10] [config] valid-script-path: ""
[2023-06-24 13:18:10] [config] valid-sets:
[2023-06-24 13:18:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:18:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:18:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:18:10] [config] vocabs:
[2023-06-24 13:18:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:18:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:18:10] [config] word-penalty: 0
[2023-06-24 13:18:10] [config] word-scores: false
[2023-06-24 13:18:10] [config] workspace: 9500
[2023-06-24 13:18:10] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:18:10] Using synchronous SGD
[2023-06-24 13:18:11] Synced seed 1234
[2023-06-24 13:18:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:18:11] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:18:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:18:11] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:18:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:18:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:18:11] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:18:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:18:12] [comm] Using global sharding
[2023-06-24 13:18:12] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:18:12] [training] Using 1 GPUs
[2023-06-24 13:18:12] Error: Requested shape shape=36507x512 size=18691584 for existing parameter 'Wemb' does not match original shape shape=54042x512 size=27669504
[2023-06-24 13:18:12] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55f7c3fd0f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55f7c47661fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55f7c4766d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55f7c4767785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55f7c43e4f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55f7c446ad5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55f7c445777c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55f7c3f2881d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55f7c4504306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55f7c44e0f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55f7c3fe2450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55f7c3f04058]    mainTrainer  (int,  char**)                        + 0x158
[0x55f7c3ebbb9c]    main                                               + 0x3c
[0x7ffb4556a0b3]    __libc_start_main                                  + 0xf3
[0x55f7c3f02cbe]    _start                                             + 0x2e

[2023-06-24 13:21:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:21:45] [marian] Running on node07.datos.cluster.uy as process 7507 with command line:
[2023-06-24 13:21:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:21:45] [config] after: 0e
[2023-06-24 13:21:45] [config] after-batches: 0
[2023-06-24 13:21:45] [config] after-epochs: 10
[2023-06-24 13:21:45] [config] all-caps-every: 0
[2023-06-24 13:21:45] [config] allow-unk: false
[2023-06-24 13:21:45] [config] authors: false
[2023-06-24 13:21:45] [config] beam-size: 12
[2023-06-24 13:21:45] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:21:45] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:21:45] [config] bert-masking-fraction: 0.15
[2023-06-24 13:21:45] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:21:45] [config] bert-train-type-embeddings: true
[2023-06-24 13:21:45] [config] bert-type-vocab-size: 2
[2023-06-24 13:21:45] [config] build-info: ""
[2023-06-24 13:21:45] [config] check-gradient-nan: false
[2023-06-24 13:21:45] [config] check-nan: false
[2023-06-24 13:21:45] [config] cite: false
[2023-06-24 13:21:45] [config] clip-norm: 5
[2023-06-24 13:21:45] [config] cost-scaling:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] cost-type: ce-mean-words
[2023-06-24 13:21:45] [config] cpu-threads: 0
[2023-06-24 13:21:45] [config] data-threads: 8
[2023-06-24 13:21:45] [config] data-weighting: ""
[2023-06-24 13:21:45] [config] data-weighting-type: sentence
[2023-06-24 13:21:45] [config] dec-cell: gru
[2023-06-24 13:21:45] [config] dec-cell-base-depth: 8
[2023-06-24 13:21:45] [config] dec-cell-high-depth: 1
[2023-06-24 13:21:45] [config] dec-depth: 1
[2023-06-24 13:21:45] [config] devices:
[2023-06-24 13:21:45] [config]   - 0
[2023-06-24 13:21:45] [config] dim-emb: 512
[2023-06-24 13:21:45] [config] dim-rnn: 1024
[2023-06-24 13:21:45] [config] dim-vocabs:
[2023-06-24 13:21:45] [config]   - 0
[2023-06-24 13:21:45] [config]   - 0
[2023-06-24 13:21:45] [config] disp-first: 0
[2023-06-24 13:21:45] [config] disp-freq: 1000u
[2023-06-24 13:21:45] [config] disp-label-counts: true
[2023-06-24 13:21:45] [config] dropout-rnn: 0.1
[2023-06-24 13:21:45] [config] dropout-src: 0
[2023-06-24 13:21:45] [config] dropout-trg: 0
[2023-06-24 13:21:45] [config] dump-config: ""
[2023-06-24 13:21:45] [config] dynamic-gradient-scaling:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] early-stopping: 10
[2023-06-24 13:21:45] [config] early-stopping-on: first
[2023-06-24 13:21:45] [config] embedding-fix-src: false
[2023-06-24 13:21:45] [config] embedding-fix-trg: false
[2023-06-24 13:21:45] [config] embedding-normalization: false
[2023-06-24 13:21:45] [config] embedding-vectors:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] enc-cell: gru
[2023-06-24 13:21:45] [config] enc-cell-depth: 4
[2023-06-24 13:21:45] [config] enc-depth: 1
[2023-06-24 13:21:45] [config] enc-type: bidirectional
[2023-06-24 13:21:45] [config] english-title-case-every: 0
[2023-06-24 13:21:45] [config] exponential-smoothing: 0.0001
[2023-06-24 13:21:45] [config] factor-weight: 1
[2023-06-24 13:21:45] [config] factors-combine: sum
[2023-06-24 13:21:45] [config] factors-dim-emb: 0
[2023-06-24 13:21:45] [config] gradient-checkpointing: false
[2023-06-24 13:21:45] [config] gradient-norm-average-window: 100
[2023-06-24 13:21:45] [config] guided-alignment: none
[2023-06-24 13:21:45] [config] guided-alignment-cost: mse
[2023-06-24 13:21:45] [config] guided-alignment-weight: 0.1
[2023-06-24 13:21:45] [config] ignore-model-config: false
[2023-06-24 13:21:45] [config] input-types:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] interpolate-env-vars: false
[2023-06-24 13:21:45] [config] keep-best: false
[2023-06-24 13:21:45] [config] label-smoothing: 0.1
[2023-06-24 13:21:45] [config] layer-normalization: true
[2023-06-24 13:21:45] [config] learn-rate: 0.0003
[2023-06-24 13:21:45] [config] lemma-dependency: ""
[2023-06-24 13:21:45] [config] lemma-dim-emb: 0
[2023-06-24 13:21:45] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:21:45] [config] log-level: info
[2023-06-24 13:21:45] [config] log-time-zone: ""
[2023-06-24 13:21:45] [config] logical-epoch:
[2023-06-24 13:21:45] [config]   - 1e
[2023-06-24 13:21:45] [config]   - 0
[2023-06-24 13:21:45] [config] lr-decay: 0
[2023-06-24 13:21:45] [config] lr-decay-freq: 50000
[2023-06-24 13:21:45] [config] lr-decay-inv-sqrt:
[2023-06-24 13:21:45] [config]   - 16000
[2023-06-24 13:21:45] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:21:45] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:21:45] [config] lr-decay-start:
[2023-06-24 13:21:45] [config]   - 10
[2023-06-24 13:21:45] [config]   - 1
[2023-06-24 13:21:45] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:21:45] [config] lr-report: false
[2023-06-24 13:21:45] [config] lr-warmup: 0
[2023-06-24 13:21:45] [config] lr-warmup-at-reload: false
[2023-06-24 13:21:45] [config] lr-warmup-cycle: false
[2023-06-24 13:21:45] [config] lr-warmup-start-rate: 0
[2023-06-24 13:21:45] [config] max-length: 100
[2023-06-24 13:21:45] [config] max-length-crop: false
[2023-06-24 13:21:45] [config] max-length-factor: 3
[2023-06-24 13:21:45] [config] maxi-batch: 1000
[2023-06-24 13:21:45] [config] maxi-batch-sort: trg
[2023-06-24 13:21:45] [config] mini-batch: 1000
[2023-06-24 13:21:45] [config] mini-batch-fit: true
[2023-06-24 13:21:45] [config] mini-batch-fit-step: 10
[2023-06-24 13:21:45] [config] mini-batch-round-up: true
[2023-06-24 13:21:45] [config] mini-batch-track-lr: false
[2023-06-24 13:21:45] [config] mini-batch-warmup: 0
[2023-06-24 13:21:45] [config] mini-batch-words: 0
[2023-06-24 13:21:45] [config] mini-batch-words-ref: 0
[2023-06-24 13:21:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:21:45] [config] multi-loss-type: sum
[2023-06-24 13:21:45] [config] n-best: false
[2023-06-24 13:21:45] [config] no-nccl: false
[2023-06-24 13:21:45] [config] no-reload: false
[2023-06-24 13:21:45] [config] no-restore-corpus: false
[2023-06-24 13:21:45] [config] normalize: 1
[2023-06-24 13:21:45] [config] normalize-gradient: false
[2023-06-24 13:21:45] [config] num-devices: 0
[2023-06-24 13:21:45] [config] optimizer: adam
[2023-06-24 13:21:45] [config] optimizer-delay: 1
[2023-06-24 13:21:45] [config] optimizer-params:
[2023-06-24 13:21:45] [config]   - 0.9
[2023-06-24 13:21:45] [config]   - 0.98
[2023-06-24 13:21:45] [config]   - 1e-09
[2023-06-24 13:21:45] [config] output-omit-bias: false
[2023-06-24 13:21:45] [config] overwrite: false
[2023-06-24 13:21:45] [config] precision:
[2023-06-24 13:21:45] [config]   - float32
[2023-06-24 13:21:45] [config]   - float32
[2023-06-24 13:21:45] [config] pretrained-model: ""
[2023-06-24 13:21:45] [config] quantize-biases: false
[2023-06-24 13:21:45] [config] quantize-bits: 0
[2023-06-24 13:21:45] [config] quantize-log-based: false
[2023-06-24 13:21:45] [config] quantize-optimization-steps: 0
[2023-06-24 13:21:45] [config] quiet: false
[2023-06-24 13:21:45] [config] quiet-translation: true
[2023-06-24 13:21:45] [config] relative-paths: false
[2023-06-24 13:21:45] [config] right-left: false
[2023-06-24 13:21:45] [config] save-freq: 10000u
[2023-06-24 13:21:45] [config] seed: 1234
[2023-06-24 13:21:45] [config] sentencepiece-alphas:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:21:45] [config] sentencepiece-options: ""
[2023-06-24 13:21:45] [config] sharding: global
[2023-06-24 13:21:45] [config] shuffle: data
[2023-06-24 13:21:45] [config] shuffle-in-ram: false
[2023-06-24 13:21:45] [config] sigterm: save-and-exit
[2023-06-24 13:21:45] [config] skip: false
[2023-06-24 13:21:45] [config] sqlite: ""
[2023-06-24 13:21:45] [config] sqlite-drop: false
[2023-06-24 13:21:45] [config] sync-freq: 200u
[2023-06-24 13:21:45] [config] sync-sgd: true
[2023-06-24 13:21:45] [config] tempdir: /tmp
[2023-06-24 13:21:45] [config] tied-embeddings: true
[2023-06-24 13:21:45] [config] tied-embeddings-all: false
[2023-06-24 13:21:45] [config] tied-embeddings-src: false
[2023-06-24 13:21:45] [config] train-embedder-rank:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] train-sets:
[2023-06-24 13:21:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:21:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:21:45] [config] transformer-aan-activation: swish
[2023-06-24 13:21:45] [config] transformer-aan-depth: 2
[2023-06-24 13:21:45] [config] transformer-aan-nogate: false
[2023-06-24 13:21:45] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:21:45] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:21:45] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:21:45] [config] transformer-depth-scaling: false
[2023-06-24 13:21:45] [config] transformer-dim-aan: 2048
[2023-06-24 13:21:45] [config] transformer-dim-ffn: 2048
[2023-06-24 13:21:45] [config] transformer-dropout: 0
[2023-06-24 13:21:45] [config] transformer-dropout-attention: 0
[2023-06-24 13:21:45] [config] transformer-dropout-ffn: 0
[2023-06-24 13:21:45] [config] transformer-ffn-activation: swish
[2023-06-24 13:21:45] [config] transformer-ffn-depth: 2
[2023-06-24 13:21:45] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:21:45] [config] transformer-heads: 8
[2023-06-24 13:21:45] [config] transformer-no-projection: false
[2023-06-24 13:21:45] [config] transformer-pool: false
[2023-06-24 13:21:45] [config] transformer-postprocess: dan
[2023-06-24 13:21:45] [config] transformer-postprocess-emb: d
[2023-06-24 13:21:45] [config] transformer-postprocess-top: ""
[2023-06-24 13:21:45] [config] transformer-preprocess: ""
[2023-06-24 13:21:45] [config] transformer-tied-layers:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] transformer-train-position-embeddings: false
[2023-06-24 13:21:45] [config] tsv: false
[2023-06-24 13:21:45] [config] tsv-fields: 0
[2023-06-24 13:21:45] [config] type: s2s
[2023-06-24 13:21:45] [config] ulr: false
[2023-06-24 13:21:45] [config] ulr-dim-emb: 0
[2023-06-24 13:21:45] [config] ulr-dropout: 0
[2023-06-24 13:21:45] [config] ulr-keys-vectors: ""
[2023-06-24 13:21:45] [config] ulr-query-vectors: ""
[2023-06-24 13:21:45] [config] ulr-softmax-temperature: 1
[2023-06-24 13:21:45] [config] ulr-trainable-transformation: false
[2023-06-24 13:21:45] [config] unlikelihood-loss: false
[2023-06-24 13:21:45] [config] valid-freq: 5000000
[2023-06-24 13:21:45] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:21:45] [config] valid-max-length: 1000
[2023-06-24 13:21:45] [config] valid-metrics:
[2023-06-24 13:21:45] [config]   - cross-entropy
[2023-06-24 13:21:45] [config]   - translation
[2023-06-24 13:21:45] [config] valid-mini-batch: 32
[2023-06-24 13:21:45] [config] valid-reset-stalled: false
[2023-06-24 13:21:45] [config] valid-script-args:
[2023-06-24 13:21:45] [config]   []
[2023-06-24 13:21:45] [config] valid-script-path: ""
[2023-06-24 13:21:45] [config] valid-sets:
[2023-06-24 13:21:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:21:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:21:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:21:45] [config] vocabs:
[2023-06-24 13:21:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:21:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:21:45] [config] word-penalty: 0
[2023-06-24 13:21:45] [config] word-scores: false
[2023-06-24 13:21:45] [config] workspace: 9500
[2023-06-24 13:21:45] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:21:45] Using synchronous SGD
[2023-06-24 13:21:45] Synced seed 1234
[2023-06-24 13:21:45] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:21:45] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:21:45] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:21:45] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:21:45] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:21:45] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:21:46] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:21:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:21:46] [comm] Using global sharding
[2023-06-24 13:21:46] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:21:46] [training] Using 1 GPUs
[2023-06-24 13:21:46] [logits] Applying loss function for 1 factor(s)
[2023-06-24 13:21:46] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:21:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 13:21:50] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:23:11] [batching] Done. Typical MB size is 9,420 target words
[2023-06-24 13:23:11] [valid] No post-processing script given for validating translator
[2023-06-24 13:23:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:23:11] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:23:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:23:11] [comm] Using global sharding
[2023-06-24 13:23:11] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:23:11] [training] Using 1 GPUs
[2023-06-24 13:23:11] Training started
[2023-06-24 13:23:11] [data] Shuffling data
[2023-06-24 13:23:11] [data] Done reading 20,192 sentences
[2023-06-24 13:23:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:23:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 13:23:11] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:23:12] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:23:12] Parameter type float32, optimization type float32, casting types false
[2023-06-24 13:23:12] Allocating memory for general optimizer shards
[2023-06-24 13:23:12] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:23:12] Allocating memory for Adam-specific shards
[2023-06-24 13:23:12] [memory] Reserving 900 MB, device gpu0
[2023-06-24 13:23:12] Error: CUDA error 2 'out of memory' - /marian/src/tensors/gpu/device.cu:38: cudaMalloc(&data_, size)
[2023-06-24 13:23:12] Error: Aborted from virtual void marian::gpu::Device::reserve(size_t) in /marian/src/tensors/gpu/device.cu:38

[CALL STACK]
[0x5566c63bdaf8]    marian::gpu::Device::  reserve  (unsigned long)    + 0x1218
[0x5566c5b220b3]    marian::TensorAllocator::  reserveExact  (unsigned long) + 0x1c3
[0x5566c633525f]    marian::Adam::  updateImpl  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long) + 0x69f
[0x5566c6336497]    marian::OptimizerBase::  update  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long,  float) + 0x657
[0x5566c6071e6d]                                                       + 0x9b6e6d
[0x5566c611d4f3]    float marian::NCCLCommunicator::  foreachAcc  <float>(std::function<float (unsigned long,unsigned long,unsigned long)> const&,  std::function<void (float&,float)> const&,  float,  bool) const + 0x8b3
[0x5566c609249d]    marian::GraphGroup::  executeAndCollectNorm  (std::function<float (unsigned long,unsigned long,unsigned long)> const&) + 0x162d
[0x5566c607536d]    marian::SyncGraphGroup::  update  (std::vector<std::shared_ptr<marian::data::Batch>,std::allocator<std::shared_ptr<marian::data::Batch>>>,  unsigned long) + 0xb1d
[0x5566c6075f05]    marian::SyncGraphGroup::  update  (std::shared_ptr<marian::data::Batch>) + 0x395
[0x5566c5b739d1]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1c01
[0x5566c5a94058]    mainTrainer  (int,  char**)                        + 0x158
[0x5566c5a4bb9c]    main                                               + 0x3c
[0x7fd5c5d380b3]    __libc_start_main                                  + 0xf3
[0x5566c5a92cbe]    _start                                             + 0x2e

[2023-06-24 13:23:17] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:23:17] [marian] Running on node07.datos.cluster.uy as process 7640 with command line:
[2023-06-24 13:23:17] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:23:17] [config] after: 0e
[2023-06-24 13:23:17] [config] after-batches: 0
[2023-06-24 13:23:17] [config] after-epochs: 20
[2023-06-24 13:23:17] [config] all-caps-every: 0
[2023-06-24 13:23:17] [config] allow-unk: false
[2023-06-24 13:23:17] [config] authors: false
[2023-06-24 13:23:17] [config] beam-size: 12
[2023-06-24 13:23:17] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:23:17] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:23:17] [config] bert-masking-fraction: 0.15
[2023-06-24 13:23:17] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:23:17] [config] bert-train-type-embeddings: true
[2023-06-24 13:23:17] [config] bert-type-vocab-size: 2
[2023-06-24 13:23:17] [config] build-info: ""
[2023-06-24 13:23:17] [config] check-gradient-nan: false
[2023-06-24 13:23:17] [config] check-nan: false
[2023-06-24 13:23:17] [config] cite: false
[2023-06-24 13:23:17] [config] clip-norm: 5
[2023-06-24 13:23:17] [config] cost-scaling:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] cost-type: ce-mean-words
[2023-06-24 13:23:17] [config] cpu-threads: 0
[2023-06-24 13:23:17] [config] data-threads: 8
[2023-06-24 13:23:17] [config] data-weighting: ""
[2023-06-24 13:23:17] [config] data-weighting-type: sentence
[2023-06-24 13:23:17] [config] dec-cell: gru
[2023-06-24 13:23:17] [config] dec-cell-base-depth: 8
[2023-06-24 13:23:17] [config] dec-cell-high-depth: 1
[2023-06-24 13:23:17] [config] dec-depth: 1
[2023-06-24 13:23:17] [config] devices:
[2023-06-24 13:23:17] [config]   - 0
[2023-06-24 13:23:17] [config] dim-emb: 512
[2023-06-24 13:23:17] [config] dim-rnn: 1024
[2023-06-24 13:23:17] [config] dim-vocabs:
[2023-06-24 13:23:17] [config]   - 0
[2023-06-24 13:23:17] [config]   - 0
[2023-06-24 13:23:17] [config] disp-first: 0
[2023-06-24 13:23:17] [config] disp-freq: 1000u
[2023-06-24 13:23:17] [config] disp-label-counts: true
[2023-06-24 13:23:17] [config] dropout-rnn: 0.1
[2023-06-24 13:23:17] [config] dropout-src: 0
[2023-06-24 13:23:17] [config] dropout-trg: 0
[2023-06-24 13:23:17] [config] dump-config: ""
[2023-06-24 13:23:17] [config] dynamic-gradient-scaling:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] early-stopping: 10
[2023-06-24 13:23:17] [config] early-stopping-on: first
[2023-06-24 13:23:17] [config] embedding-fix-src: false
[2023-06-24 13:23:17] [config] embedding-fix-trg: false
[2023-06-24 13:23:17] [config] embedding-normalization: false
[2023-06-24 13:23:17] [config] embedding-vectors:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] enc-cell: gru
[2023-06-24 13:23:17] [config] enc-cell-depth: 4
[2023-06-24 13:23:17] [config] enc-depth: 1
[2023-06-24 13:23:17] [config] enc-type: bidirectional
[2023-06-24 13:23:17] [config] english-title-case-every: 0
[2023-06-24 13:23:17] [config] exponential-smoothing: 0.0001
[2023-06-24 13:23:17] [config] factor-weight: 1
[2023-06-24 13:23:17] [config] factors-combine: sum
[2023-06-24 13:23:17] [config] factors-dim-emb: 0
[2023-06-24 13:23:17] [config] gradient-checkpointing: false
[2023-06-24 13:23:17] [config] gradient-norm-average-window: 100
[2023-06-24 13:23:17] [config] guided-alignment: none
[2023-06-24 13:23:17] [config] guided-alignment-cost: mse
[2023-06-24 13:23:17] [config] guided-alignment-weight: 0.1
[2023-06-24 13:23:17] [config] ignore-model-config: false
[2023-06-24 13:23:17] [config] input-types:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] interpolate-env-vars: false
[2023-06-24 13:23:17] [config] keep-best: false
[2023-06-24 13:23:17] [config] label-smoothing: 0.1
[2023-06-24 13:23:17] [config] layer-normalization: true
[2023-06-24 13:23:17] [config] learn-rate: 0.0003
[2023-06-24 13:23:17] [config] lemma-dependency: ""
[2023-06-24 13:23:17] [config] lemma-dim-emb: 0
[2023-06-24 13:23:17] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:23:17] [config] log-level: info
[2023-06-24 13:23:17] [config] log-time-zone: ""
[2023-06-24 13:23:17] [config] logical-epoch:
[2023-06-24 13:23:17] [config]   - 1e
[2023-06-24 13:23:17] [config]   - 0
[2023-06-24 13:23:17] [config] lr-decay: 0
[2023-06-24 13:23:17] [config] lr-decay-freq: 50000
[2023-06-24 13:23:17] [config] lr-decay-inv-sqrt:
[2023-06-24 13:23:17] [config]   - 16000
[2023-06-24 13:23:17] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:23:17] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:23:17] [config] lr-decay-start:
[2023-06-24 13:23:17] [config]   - 10
[2023-06-24 13:23:17] [config]   - 1
[2023-06-24 13:23:17] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:23:17] [config] lr-report: false
[2023-06-24 13:23:17] [config] lr-warmup: 0
[2023-06-24 13:23:17] [config] lr-warmup-at-reload: false
[2023-06-24 13:23:17] [config] lr-warmup-cycle: false
[2023-06-24 13:23:17] [config] lr-warmup-start-rate: 0
[2023-06-24 13:23:17] [config] max-length: 100
[2023-06-24 13:23:17] [config] max-length-crop: false
[2023-06-24 13:23:17] [config] max-length-factor: 3
[2023-06-24 13:23:17] [config] maxi-batch: 1000
[2023-06-24 13:23:17] [config] maxi-batch-sort: trg
[2023-06-24 13:23:17] [config] mini-batch: 1000
[2023-06-24 13:23:17] [config] mini-batch-fit: true
[2023-06-24 13:23:17] [config] mini-batch-fit-step: 10
[2023-06-24 13:23:17] [config] mini-batch-round-up: true
[2023-06-24 13:23:17] [config] mini-batch-track-lr: false
[2023-06-24 13:23:17] [config] mini-batch-warmup: 0
[2023-06-24 13:23:17] [config] mini-batch-words: 0
[2023-06-24 13:23:17] [config] mini-batch-words-ref: 0
[2023-06-24 13:23:17] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:23:17] [config] multi-loss-type: sum
[2023-06-24 13:23:17] [config] n-best: false
[2023-06-24 13:23:17] [config] no-nccl: false
[2023-06-24 13:23:17] [config] no-reload: false
[2023-06-24 13:23:17] [config] no-restore-corpus: false
[2023-06-24 13:23:17] [config] normalize: 1
[2023-06-24 13:23:17] [config] normalize-gradient: false
[2023-06-24 13:23:17] [config] num-devices: 0
[2023-06-24 13:23:17] [config] optimizer: adam
[2023-06-24 13:23:17] [config] optimizer-delay: 1
[2023-06-24 13:23:17] [config] optimizer-params:
[2023-06-24 13:23:17] [config]   - 0.9
[2023-06-24 13:23:17] [config]   - 0.98
[2023-06-24 13:23:17] [config]   - 1e-09
[2023-06-24 13:23:17] [config] output-omit-bias: false
[2023-06-24 13:23:17] [config] overwrite: false
[2023-06-24 13:23:17] [config] precision:
[2023-06-24 13:23:17] [config]   - float32
[2023-06-24 13:23:17] [config]   - float32
[2023-06-24 13:23:17] [config] pretrained-model: ""
[2023-06-24 13:23:17] [config] quantize-biases: false
[2023-06-24 13:23:17] [config] quantize-bits: 0
[2023-06-24 13:23:17] [config] quantize-log-based: false
[2023-06-24 13:23:17] [config] quantize-optimization-steps: 0
[2023-06-24 13:23:17] [config] quiet: false
[2023-06-24 13:23:17] [config] quiet-translation: true
[2023-06-24 13:23:17] [config] relative-paths: false
[2023-06-24 13:23:17] [config] right-left: false
[2023-06-24 13:23:17] [config] save-freq: 10000u
[2023-06-24 13:23:17] [config] seed: 1234
[2023-06-24 13:23:17] [config] sentencepiece-alphas:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:23:17] [config] sentencepiece-options: ""
[2023-06-24 13:23:17] [config] sharding: global
[2023-06-24 13:23:17] [config] shuffle: data
[2023-06-24 13:23:17] [config] shuffle-in-ram: false
[2023-06-24 13:23:17] [config] sigterm: save-and-exit
[2023-06-24 13:23:17] [config] skip: false
[2023-06-24 13:23:17] [config] sqlite: ""
[2023-06-24 13:23:17] [config] sqlite-drop: false
[2023-06-24 13:23:17] [config] sync-freq: 200u
[2023-06-24 13:23:17] [config] sync-sgd: true
[2023-06-24 13:23:17] [config] tempdir: /tmp
[2023-06-24 13:23:17] [config] tied-embeddings: true
[2023-06-24 13:23:17] [config] tied-embeddings-all: false
[2023-06-24 13:23:17] [config] tied-embeddings-src: false
[2023-06-24 13:23:17] [config] train-embedder-rank:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] train-sets:
[2023-06-24 13:23:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:23:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:23:17] [config] transformer-aan-activation: swish
[2023-06-24 13:23:17] [config] transformer-aan-depth: 2
[2023-06-24 13:23:17] [config] transformer-aan-nogate: false
[2023-06-24 13:23:17] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:23:17] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:23:17] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:23:17] [config] transformer-depth-scaling: false
[2023-06-24 13:23:17] [config] transformer-dim-aan: 2048
[2023-06-24 13:23:17] [config] transformer-dim-ffn: 2048
[2023-06-24 13:23:17] [config] transformer-dropout: 0
[2023-06-24 13:23:17] [config] transformer-dropout-attention: 0
[2023-06-24 13:23:17] [config] transformer-dropout-ffn: 0
[2023-06-24 13:23:17] [config] transformer-ffn-activation: swish
[2023-06-24 13:23:17] [config] transformer-ffn-depth: 2
[2023-06-24 13:23:17] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:23:17] [config] transformer-heads: 8
[2023-06-24 13:23:17] [config] transformer-no-projection: false
[2023-06-24 13:23:17] [config] transformer-pool: false
[2023-06-24 13:23:17] [config] transformer-postprocess: dan
[2023-06-24 13:23:17] [config] transformer-postprocess-emb: d
[2023-06-24 13:23:17] [config] transformer-postprocess-top: ""
[2023-06-24 13:23:17] [config] transformer-preprocess: ""
[2023-06-24 13:23:17] [config] transformer-tied-layers:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] transformer-train-position-embeddings: false
[2023-06-24 13:23:17] [config] tsv: false
[2023-06-24 13:23:17] [config] tsv-fields: 0
[2023-06-24 13:23:17] [config] type: s2s
[2023-06-24 13:23:17] [config] ulr: false
[2023-06-24 13:23:17] [config] ulr-dim-emb: 0
[2023-06-24 13:23:17] [config] ulr-dropout: 0
[2023-06-24 13:23:17] [config] ulr-keys-vectors: ""
[2023-06-24 13:23:17] [config] ulr-query-vectors: ""
[2023-06-24 13:23:17] [config] ulr-softmax-temperature: 1
[2023-06-24 13:23:17] [config] ulr-trainable-transformation: false
[2023-06-24 13:23:17] [config] unlikelihood-loss: false
[2023-06-24 13:23:17] [config] valid-freq: 5000000
[2023-06-24 13:23:17] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:23:17] [config] valid-max-length: 1000
[2023-06-24 13:23:17] [config] valid-metrics:
[2023-06-24 13:23:17] [config]   - cross-entropy
[2023-06-24 13:23:17] [config]   - translation
[2023-06-24 13:23:17] [config] valid-mini-batch: 32
[2023-06-24 13:23:17] [config] valid-reset-stalled: false
[2023-06-24 13:23:17] [config] valid-script-args:
[2023-06-24 13:23:17] [config]   []
[2023-06-24 13:23:17] [config] valid-script-path: ""
[2023-06-24 13:23:17] [config] valid-sets:
[2023-06-24 13:23:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:23:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:23:17] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:23:17] [config] vocabs:
[2023-06-24 13:23:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:23:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:23:17] [config] word-penalty: 0
[2023-06-24 13:23:17] [config] word-scores: false
[2023-06-24 13:23:17] [config] workspace: 9500
[2023-06-24 13:23:17] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:23:17] Using synchronous SGD
[2023-06-24 13:23:17] Synced seed 1234
[2023-06-24 13:23:17] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:23:17] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:23:17] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:23:17] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:23:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:23:17] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:23:18] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:23:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:23:18] [comm] Using global sharding
[2023-06-24 13:23:18] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:23:18] [training] Using 1 GPUs
[2023-06-24 13:23:18] [logits] Applying loss function for 1 factor(s)
[2023-06-24 13:23:18] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:23:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 13:23:19] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:24:43] [batching] Done. Typical MB size is 9,420 target words
[2023-06-24 13:24:43] [valid] No post-processing script given for validating translator
[2023-06-24 13:24:43] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:24:43] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:24:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:24:43] [comm] Using global sharding
[2023-06-24 13:24:43] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:24:43] [training] Using 1 GPUs
[2023-06-24 13:24:43] Training started
[2023-06-24 13:24:43] [data] Shuffling data
[2023-06-24 13:24:43] [data] Done reading 20,192 sentences
[2023-06-24 13:24:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:24:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 13:24:43] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:24:44] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:24:44] Parameter type float32, optimization type float32, casting types false
[2023-06-24 13:24:44] Allocating memory for general optimizer shards
[2023-06-24 13:24:44] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:24:44] Allocating memory for Adam-specific shards
[2023-06-24 13:24:44] [memory] Reserving 900 MB, device gpu0
[2023-06-24 13:24:44] Error: CUDA error 2 'out of memory' - /marian/src/tensors/gpu/device.cu:38: cudaMalloc(&data_, size)
[2023-06-24 13:24:44] Error: Aborted from virtual void marian::gpu::Device::reserve(size_t) in /marian/src/tensors/gpu/device.cu:38

[CALL STACK]
[0x55bc407baaf8]    marian::gpu::Device::  reserve  (unsigned long)    + 0x1218
[0x55bc3ff1f0b3]    marian::TensorAllocator::  reserveExact  (unsigned long) + 0x1c3
[0x55bc4073225f]    marian::Adam::  updateImpl  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long) + 0x69f
[0x55bc40733497]    marian::OptimizerBase::  update  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long,  float) + 0x657
[0x55bc4046ee6d]                                                       + 0x9b6e6d
[0x55bc4051a4f3]    float marian::NCCLCommunicator::  foreachAcc  <float>(std::function<float (unsigned long,unsigned long,unsigned long)> const&,  std::function<void (float&,float)> const&,  float,  bool) const + 0x8b3
[0x55bc4048f49d]    marian::GraphGroup::  executeAndCollectNorm  (std::function<float (unsigned long,unsigned long,unsigned long)> const&) + 0x162d
[0x55bc4047236d]    marian::SyncGraphGroup::  update  (std::vector<std::shared_ptr<marian::data::Batch>,std::allocator<std::shared_ptr<marian::data::Batch>>>,  unsigned long) + 0xb1d
[0x55bc40472f05]    marian::SyncGraphGroup::  update  (std::shared_ptr<marian::data::Batch>) + 0x395
[0x55bc3ff709d1]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1c01
[0x55bc3fe91058]    mainTrainer  (int,  char**)                        + 0x158
[0x55bc3fe48b9c]    main                                               + 0x3c
[0x7fc2582ef0b3]    __libc_start_main                                  + 0xf3
[0x55bc3fe8fcbe]    _start                                             + 0x2e

[2023-06-24 13:24:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:24:48] [marian] Running on node07.datos.cluster.uy as process 7769 with command line:
[2023-06-24 13:24:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:24:48] [config] after: 0e
[2023-06-24 13:24:48] [config] after-batches: 0
[2023-06-24 13:24:48] [config] after-epochs: 30
[2023-06-24 13:24:48] [config] all-caps-every: 0
[2023-06-24 13:24:48] [config] allow-unk: false
[2023-06-24 13:24:48] [config] authors: false
[2023-06-24 13:24:48] [config] beam-size: 12
[2023-06-24 13:24:48] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:24:48] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:24:48] [config] bert-masking-fraction: 0.15
[2023-06-24 13:24:48] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:24:48] [config] bert-train-type-embeddings: true
[2023-06-24 13:24:48] [config] bert-type-vocab-size: 2
[2023-06-24 13:24:48] [config] build-info: ""
[2023-06-24 13:24:48] [config] check-gradient-nan: false
[2023-06-24 13:24:48] [config] check-nan: false
[2023-06-24 13:24:48] [config] cite: false
[2023-06-24 13:24:48] [config] clip-norm: 5
[2023-06-24 13:24:48] [config] cost-scaling:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] cost-type: ce-mean-words
[2023-06-24 13:24:48] [config] cpu-threads: 0
[2023-06-24 13:24:48] [config] data-threads: 8
[2023-06-24 13:24:48] [config] data-weighting: ""
[2023-06-24 13:24:48] [config] data-weighting-type: sentence
[2023-06-24 13:24:48] [config] dec-cell: gru
[2023-06-24 13:24:48] [config] dec-cell-base-depth: 8
[2023-06-24 13:24:48] [config] dec-cell-high-depth: 1
[2023-06-24 13:24:48] [config] dec-depth: 1
[2023-06-24 13:24:48] [config] devices:
[2023-06-24 13:24:48] [config]   - 0
[2023-06-24 13:24:48] [config] dim-emb: 512
[2023-06-24 13:24:48] [config] dim-rnn: 1024
[2023-06-24 13:24:48] [config] dim-vocabs:
[2023-06-24 13:24:48] [config]   - 0
[2023-06-24 13:24:48] [config]   - 0
[2023-06-24 13:24:48] [config] disp-first: 0
[2023-06-24 13:24:48] [config] disp-freq: 1000u
[2023-06-24 13:24:48] [config] disp-label-counts: true
[2023-06-24 13:24:48] [config] dropout-rnn: 0.1
[2023-06-24 13:24:48] [config] dropout-src: 0
[2023-06-24 13:24:48] [config] dropout-trg: 0
[2023-06-24 13:24:48] [config] dump-config: ""
[2023-06-24 13:24:48] [config] dynamic-gradient-scaling:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] early-stopping: 10
[2023-06-24 13:24:48] [config] early-stopping-on: first
[2023-06-24 13:24:48] [config] embedding-fix-src: false
[2023-06-24 13:24:48] [config] embedding-fix-trg: false
[2023-06-24 13:24:48] [config] embedding-normalization: false
[2023-06-24 13:24:48] [config] embedding-vectors:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] enc-cell: gru
[2023-06-24 13:24:48] [config] enc-cell-depth: 4
[2023-06-24 13:24:48] [config] enc-depth: 1
[2023-06-24 13:24:48] [config] enc-type: bidirectional
[2023-06-24 13:24:48] [config] english-title-case-every: 0
[2023-06-24 13:24:48] [config] exponential-smoothing: 0.0001
[2023-06-24 13:24:48] [config] factor-weight: 1
[2023-06-24 13:24:48] [config] factors-combine: sum
[2023-06-24 13:24:48] [config] factors-dim-emb: 0
[2023-06-24 13:24:48] [config] gradient-checkpointing: false
[2023-06-24 13:24:48] [config] gradient-norm-average-window: 100
[2023-06-24 13:24:48] [config] guided-alignment: none
[2023-06-24 13:24:48] [config] guided-alignment-cost: mse
[2023-06-24 13:24:48] [config] guided-alignment-weight: 0.1
[2023-06-24 13:24:48] [config] ignore-model-config: false
[2023-06-24 13:24:48] [config] input-types:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] interpolate-env-vars: false
[2023-06-24 13:24:48] [config] keep-best: false
[2023-06-24 13:24:48] [config] label-smoothing: 0.1
[2023-06-24 13:24:48] [config] layer-normalization: true
[2023-06-24 13:24:48] [config] learn-rate: 0.0003
[2023-06-24 13:24:48] [config] lemma-dependency: ""
[2023-06-24 13:24:48] [config] lemma-dim-emb: 0
[2023-06-24 13:24:48] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:24:48] [config] log-level: info
[2023-06-24 13:24:48] [config] log-time-zone: ""
[2023-06-24 13:24:48] [config] logical-epoch:
[2023-06-24 13:24:48] [config]   - 1e
[2023-06-24 13:24:48] [config]   - 0
[2023-06-24 13:24:48] [config] lr-decay: 0
[2023-06-24 13:24:48] [config] lr-decay-freq: 50000
[2023-06-24 13:24:48] [config] lr-decay-inv-sqrt:
[2023-06-24 13:24:48] [config]   - 16000
[2023-06-24 13:24:48] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:24:48] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:24:48] [config] lr-decay-start:
[2023-06-24 13:24:48] [config]   - 10
[2023-06-24 13:24:48] [config]   - 1
[2023-06-24 13:24:48] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:24:48] [config] lr-report: false
[2023-06-24 13:24:48] [config] lr-warmup: 0
[2023-06-24 13:24:48] [config] lr-warmup-at-reload: false
[2023-06-24 13:24:48] [config] lr-warmup-cycle: false
[2023-06-24 13:24:48] [config] lr-warmup-start-rate: 0
[2023-06-24 13:24:48] [config] max-length: 100
[2023-06-24 13:24:48] [config] max-length-crop: false
[2023-06-24 13:24:48] [config] max-length-factor: 3
[2023-06-24 13:24:48] [config] maxi-batch: 1000
[2023-06-24 13:24:48] [config] maxi-batch-sort: trg
[2023-06-24 13:24:48] [config] mini-batch: 1000
[2023-06-24 13:24:48] [config] mini-batch-fit: true
[2023-06-24 13:24:48] [config] mini-batch-fit-step: 10
[2023-06-24 13:24:48] [config] mini-batch-round-up: true
[2023-06-24 13:24:48] [config] mini-batch-track-lr: false
[2023-06-24 13:24:48] [config] mini-batch-warmup: 0
[2023-06-24 13:24:48] [config] mini-batch-words: 0
[2023-06-24 13:24:48] [config] mini-batch-words-ref: 0
[2023-06-24 13:24:48] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:24:48] [config] multi-loss-type: sum
[2023-06-24 13:24:48] [config] n-best: false
[2023-06-24 13:24:48] [config] no-nccl: false
[2023-06-24 13:24:48] [config] no-reload: false
[2023-06-24 13:24:48] [config] no-restore-corpus: false
[2023-06-24 13:24:48] [config] normalize: 1
[2023-06-24 13:24:48] [config] normalize-gradient: false
[2023-06-24 13:24:48] [config] num-devices: 0
[2023-06-24 13:24:48] [config] optimizer: adam
[2023-06-24 13:24:48] [config] optimizer-delay: 1
[2023-06-24 13:24:48] [config] optimizer-params:
[2023-06-24 13:24:48] [config]   - 0.9
[2023-06-24 13:24:48] [config]   - 0.98
[2023-06-24 13:24:48] [config]   - 1e-09
[2023-06-24 13:24:48] [config] output-omit-bias: false
[2023-06-24 13:24:48] [config] overwrite: false
[2023-06-24 13:24:48] [config] precision:
[2023-06-24 13:24:48] [config]   - float32
[2023-06-24 13:24:48] [config]   - float32
[2023-06-24 13:24:48] [config] pretrained-model: ""
[2023-06-24 13:24:48] [config] quantize-biases: false
[2023-06-24 13:24:48] [config] quantize-bits: 0
[2023-06-24 13:24:48] [config] quantize-log-based: false
[2023-06-24 13:24:48] [config] quantize-optimization-steps: 0
[2023-06-24 13:24:48] [config] quiet: false
[2023-06-24 13:24:48] [config] quiet-translation: true
[2023-06-24 13:24:48] [config] relative-paths: false
[2023-06-24 13:24:48] [config] right-left: false
[2023-06-24 13:24:48] [config] save-freq: 10000u
[2023-06-24 13:24:48] [config] seed: 1234
[2023-06-24 13:24:48] [config] sentencepiece-alphas:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:24:48] [config] sentencepiece-options: ""
[2023-06-24 13:24:48] [config] sharding: global
[2023-06-24 13:24:48] [config] shuffle: data
[2023-06-24 13:24:48] [config] shuffle-in-ram: false
[2023-06-24 13:24:48] [config] sigterm: save-and-exit
[2023-06-24 13:24:48] [config] skip: false
[2023-06-24 13:24:48] [config] sqlite: ""
[2023-06-24 13:24:48] [config] sqlite-drop: false
[2023-06-24 13:24:48] [config] sync-freq: 200u
[2023-06-24 13:24:48] [config] sync-sgd: true
[2023-06-24 13:24:48] [config] tempdir: /tmp
[2023-06-24 13:24:48] [config] tied-embeddings: true
[2023-06-24 13:24:48] [config] tied-embeddings-all: false
[2023-06-24 13:24:48] [config] tied-embeddings-src: false
[2023-06-24 13:24:48] [config] train-embedder-rank:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] train-sets:
[2023-06-24 13:24:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:24:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:24:48] [config] transformer-aan-activation: swish
[2023-06-24 13:24:48] [config] transformer-aan-depth: 2
[2023-06-24 13:24:48] [config] transformer-aan-nogate: false
[2023-06-24 13:24:48] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:24:48] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:24:48] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:24:48] [config] transformer-depth-scaling: false
[2023-06-24 13:24:48] [config] transformer-dim-aan: 2048
[2023-06-24 13:24:48] [config] transformer-dim-ffn: 2048
[2023-06-24 13:24:48] [config] transformer-dropout: 0
[2023-06-24 13:24:48] [config] transformer-dropout-attention: 0
[2023-06-24 13:24:48] [config] transformer-dropout-ffn: 0
[2023-06-24 13:24:48] [config] transformer-ffn-activation: swish
[2023-06-24 13:24:48] [config] transformer-ffn-depth: 2
[2023-06-24 13:24:48] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:24:48] [config] transformer-heads: 8
[2023-06-24 13:24:48] [config] transformer-no-projection: false
[2023-06-24 13:24:48] [config] transformer-pool: false
[2023-06-24 13:24:48] [config] transformer-postprocess: dan
[2023-06-24 13:24:48] [config] transformer-postprocess-emb: d
[2023-06-24 13:24:48] [config] transformer-postprocess-top: ""
[2023-06-24 13:24:48] [config] transformer-preprocess: ""
[2023-06-24 13:24:48] [config] transformer-tied-layers:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] transformer-train-position-embeddings: false
[2023-06-24 13:24:48] [config] tsv: false
[2023-06-24 13:24:48] [config] tsv-fields: 0
[2023-06-24 13:24:48] [config] type: s2s
[2023-06-24 13:24:48] [config] ulr: false
[2023-06-24 13:24:48] [config] ulr-dim-emb: 0
[2023-06-24 13:24:48] [config] ulr-dropout: 0
[2023-06-24 13:24:48] [config] ulr-keys-vectors: ""
[2023-06-24 13:24:48] [config] ulr-query-vectors: ""
[2023-06-24 13:24:48] [config] ulr-softmax-temperature: 1
[2023-06-24 13:24:48] [config] ulr-trainable-transformation: false
[2023-06-24 13:24:48] [config] unlikelihood-loss: false
[2023-06-24 13:24:48] [config] valid-freq: 5000000
[2023-06-24 13:24:48] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:24:48] [config] valid-max-length: 1000
[2023-06-24 13:24:48] [config] valid-metrics:
[2023-06-24 13:24:48] [config]   - cross-entropy
[2023-06-24 13:24:48] [config]   - translation
[2023-06-24 13:24:48] [config] valid-mini-batch: 32
[2023-06-24 13:24:48] [config] valid-reset-stalled: false
[2023-06-24 13:24:48] [config] valid-script-args:
[2023-06-24 13:24:48] [config]   []
[2023-06-24 13:24:48] [config] valid-script-path: ""
[2023-06-24 13:24:48] [config] valid-sets:
[2023-06-24 13:24:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:24:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:24:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:24:48] [config] vocabs:
[2023-06-24 13:24:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:24:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:24:48] [config] word-penalty: 0
[2023-06-24 13:24:48] [config] word-scores: false
[2023-06-24 13:24:48] [config] workspace: 9500
[2023-06-24 13:24:48] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:24:48] Using synchronous SGD
[2023-06-24 13:24:49] Synced seed 1234
[2023-06-24 13:24:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:24:49] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:24:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:24:49] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:24:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:24:49] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:24:49] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:24:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:24:50] [comm] Using global sharding
[2023-06-24 13:24:50] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:24:50] [training] Using 1 GPUs
[2023-06-24 13:24:50] [logits] Applying loss function for 1 factor(s)
[2023-06-24 13:24:50] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:24:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 13:24:50] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:26:30] [batching] Done. Typical MB size is 9,420 target words
[2023-06-24 13:26:30] [valid] No post-processing script given for validating translator
[2023-06-24 13:26:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:26:30] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:26:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:26:30] [comm] Using global sharding
[2023-06-24 13:26:30] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:26:30] [training] Using 1 GPUs
[2023-06-24 13:26:30] Training started
[2023-06-24 13:26:30] [data] Shuffling data
[2023-06-24 13:26:30] [data] Done reading 20,192 sentences
[2023-06-24 13:26:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:26:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 13:26:30] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:26:31] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:26:31] Parameter type float32, optimization type float32, casting types false
[2023-06-24 13:26:31] Allocating memory for general optimizer shards
[2023-06-24 13:26:31] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:26:31] Allocating memory for Adam-specific shards
[2023-06-24 13:26:31] [memory] Reserving 900 MB, device gpu0
[2023-06-24 13:26:31] Error: CUDA error 2 'out of memory' - /marian/src/tensors/gpu/device.cu:38: cudaMalloc(&data_, size)
[2023-06-24 13:26:31] Error: Aborted from virtual void marian::gpu::Device::reserve(size_t) in /marian/src/tensors/gpu/device.cu:38

[CALL STACK]
[0x55f5c48b3af8]    marian::gpu::Device::  reserve  (unsigned long)    + 0x1218
[0x55f5c40180b3]    marian::TensorAllocator::  reserveExact  (unsigned long) + 0x1c3
[0x55f5c482b25f]    marian::Adam::  updateImpl  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long) + 0x69f
[0x55f5c482c497]    marian::OptimizerBase::  update  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long,  float) + 0x657
[0x55f5c4567e6d]                                                       + 0x9b6e6d
[0x55f5c46134f3]    float marian::NCCLCommunicator::  foreachAcc  <float>(std::function<float (unsigned long,unsigned long,unsigned long)> const&,  std::function<void (float&,float)> const&,  float,  bool) const + 0x8b3
[0x55f5c458849d]    marian::GraphGroup::  executeAndCollectNorm  (std::function<float (unsigned long,unsigned long,unsigned long)> const&) + 0x162d
[0x55f5c456b36d]    marian::SyncGraphGroup::  update  (std::vector<std::shared_ptr<marian::data::Batch>,std::allocator<std::shared_ptr<marian::data::Batch>>>,  unsigned long) + 0xb1d
[0x55f5c456bf05]    marian::SyncGraphGroup::  update  (std::shared_ptr<marian::data::Batch>) + 0x395
[0x55f5c40699d1]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1c01
[0x55f5c3f8a058]    mainTrainer  (int,  char**)                        + 0x158
[0x55f5c3f41b9c]    main                                               + 0x3c
[0x7f9c489170b3]    __libc_start_main                                  + 0xf3
[0x55f5c3f88cbe]    _start                                             + 0x2e

[2023-06-24 13:26:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:26:47] [marian] Running on node18.datos.cluster.uy as process 40315 with command line:
[2023-06-24 13:26:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:26:47] [config] after: 0e
[2023-06-24 13:26:47] [config] after-batches: 0
[2023-06-24 13:26:47] [config] after-epochs: 10
[2023-06-24 13:26:47] [config] all-caps-every: 0
[2023-06-24 13:26:47] [config] allow-unk: false
[2023-06-24 13:26:47] [config] authors: false
[2023-06-24 13:26:47] [config] beam-size: 12
[2023-06-24 13:26:47] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:26:47] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:26:47] [config] bert-masking-fraction: 0.15
[2023-06-24 13:26:47] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:26:47] [config] bert-train-type-embeddings: true
[2023-06-24 13:26:47] [config] bert-type-vocab-size: 2
[2023-06-24 13:26:47] [config] build-info: ""
[2023-06-24 13:26:47] [config] check-gradient-nan: false
[2023-06-24 13:26:47] [config] check-nan: false
[2023-06-24 13:26:47] [config] cite: false
[2023-06-24 13:26:47] [config] clip-norm: 5
[2023-06-24 13:26:47] [config] cost-scaling:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] cost-type: ce-mean-words
[2023-06-24 13:26:47] [config] cpu-threads: 0
[2023-06-24 13:26:47] [config] data-threads: 8
[2023-06-24 13:26:47] [config] data-weighting: ""
[2023-06-24 13:26:47] [config] data-weighting-type: sentence
[2023-06-24 13:26:47] [config] dec-cell: gru
[2023-06-24 13:26:47] [config] dec-cell-base-depth: 8
[2023-06-24 13:26:47] [config] dec-cell-high-depth: 1
[2023-06-24 13:26:47] [config] dec-depth: 1
[2023-06-24 13:26:47] [config] devices:
[2023-06-24 13:26:47] [config]   - 0
[2023-06-24 13:26:47] [config] dim-emb: 512
[2023-06-24 13:26:47] [config] dim-rnn: 1024
[2023-06-24 13:26:47] [config] dim-vocabs:
[2023-06-24 13:26:47] [config]   - 0
[2023-06-24 13:26:47] [config]   - 0
[2023-06-24 13:26:47] [config] disp-first: 0
[2023-06-24 13:26:47] [config] disp-freq: 1000u
[2023-06-24 13:26:47] [config] disp-label-counts: true
[2023-06-24 13:26:47] [config] dropout-rnn: 0.1
[2023-06-24 13:26:47] [config] dropout-src: 0
[2023-06-24 13:26:47] [config] dropout-trg: 0
[2023-06-24 13:26:47] [config] dump-config: ""
[2023-06-24 13:26:47] [config] dynamic-gradient-scaling:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] early-stopping: 10
[2023-06-24 13:26:47] [config] early-stopping-on: first
[2023-06-24 13:26:47] [config] embedding-fix-src: false
[2023-06-24 13:26:47] [config] embedding-fix-trg: false
[2023-06-24 13:26:47] [config] embedding-normalization: false
[2023-06-24 13:26:47] [config] embedding-vectors:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] enc-cell: gru
[2023-06-24 13:26:47] [config] enc-cell-depth: 4
[2023-06-24 13:26:47] [config] enc-depth: 1
[2023-06-24 13:26:47] [config] enc-type: bidirectional
[2023-06-24 13:26:47] [config] english-title-case-every: 0
[2023-06-24 13:26:47] [config] exponential-smoothing: 0.0001
[2023-06-24 13:26:47] [config] factor-weight: 1
[2023-06-24 13:26:47] [config] factors-combine: sum
[2023-06-24 13:26:47] [config] factors-dim-emb: 0
[2023-06-24 13:26:47] [config] gradient-checkpointing: false
[2023-06-24 13:26:47] [config] gradient-norm-average-window: 100
[2023-06-24 13:26:47] [config] guided-alignment: none
[2023-06-24 13:26:47] [config] guided-alignment-cost: mse
[2023-06-24 13:26:47] [config] guided-alignment-weight: 0.1
[2023-06-24 13:26:47] [config] ignore-model-config: false
[2023-06-24 13:26:47] [config] input-types:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] interpolate-env-vars: false
[2023-06-24 13:26:47] [config] keep-best: false
[2023-06-24 13:26:47] [config] label-smoothing: 0.1
[2023-06-24 13:26:47] [config] layer-normalization: true
[2023-06-24 13:26:47] [config] learn-rate: 0.0003
[2023-06-24 13:26:47] [config] lemma-dependency: ""
[2023-06-24 13:26:47] [config] lemma-dim-emb: 0
[2023-06-24 13:26:47] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:26:47] [config] log-level: info
[2023-06-24 13:26:47] [config] log-time-zone: ""
[2023-06-24 13:26:47] [config] logical-epoch:
[2023-06-24 13:26:47] [config]   - 1e
[2023-06-24 13:26:47] [config]   - 0
[2023-06-24 13:26:47] [config] lr-decay: 0
[2023-06-24 13:26:47] [config] lr-decay-freq: 50000
[2023-06-24 13:26:47] [config] lr-decay-inv-sqrt:
[2023-06-24 13:26:47] [config]   - 16000
[2023-06-24 13:26:47] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:26:47] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:26:47] [config] lr-decay-start:
[2023-06-24 13:26:47] [config]   - 10
[2023-06-24 13:26:47] [config]   - 1
[2023-06-24 13:26:47] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:26:47] [config] lr-report: false
[2023-06-24 13:26:47] [config] lr-warmup: 0
[2023-06-24 13:26:47] [config] lr-warmup-at-reload: false
[2023-06-24 13:26:47] [config] lr-warmup-cycle: false
[2023-06-24 13:26:47] [config] lr-warmup-start-rate: 0
[2023-06-24 13:26:47] [config] max-length: 100
[2023-06-24 13:26:47] [config] max-length-crop: false
[2023-06-24 13:26:47] [config] max-length-factor: 3
[2023-06-24 13:26:47] [config] maxi-batch: 1000
[2023-06-24 13:26:47] [config] maxi-batch-sort: trg
[2023-06-24 13:26:47] [config] mini-batch: 1000
[2023-06-24 13:26:47] [config] mini-batch-fit: true
[2023-06-24 13:26:47] [config] mini-batch-fit-step: 10
[2023-06-24 13:26:47] [config] mini-batch-round-up: true
[2023-06-24 13:26:47] [config] mini-batch-track-lr: false
[2023-06-24 13:26:47] [config] mini-batch-warmup: 0
[2023-06-24 13:26:47] [config] mini-batch-words: 0
[2023-06-24 13:26:47] [config] mini-batch-words-ref: 0
[2023-06-24 13:26:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:26:47] [config] multi-loss-type: sum
[2023-06-24 13:26:47] [config] n-best: false
[2023-06-24 13:26:47] [config] no-nccl: false
[2023-06-24 13:26:47] [config] no-reload: false
[2023-06-24 13:26:47] [config] no-restore-corpus: false
[2023-06-24 13:26:47] [config] normalize: 1
[2023-06-24 13:26:47] [config] normalize-gradient: false
[2023-06-24 13:26:47] [config] num-devices: 0
[2023-06-24 13:26:47] [config] optimizer: adam
[2023-06-24 13:26:47] [config] optimizer-delay: 1
[2023-06-24 13:26:47] [config] optimizer-params:
[2023-06-24 13:26:47] [config]   - 0.9
[2023-06-24 13:26:47] [config]   - 0.98
[2023-06-24 13:26:47] [config]   - 1e-09
[2023-06-24 13:26:47] [config] output-omit-bias: false
[2023-06-24 13:26:47] [config] overwrite: false
[2023-06-24 13:26:47] [config] precision:
[2023-06-24 13:26:47] [config]   - float32
[2023-06-24 13:26:47] [config]   - float32
[2023-06-24 13:26:47] [config] pretrained-model: ""
[2023-06-24 13:26:47] [config] quantize-biases: false
[2023-06-24 13:26:47] [config] quantize-bits: 0
[2023-06-24 13:26:47] [config] quantize-log-based: false
[2023-06-24 13:26:47] [config] quantize-optimization-steps: 0
[2023-06-24 13:26:47] [config] quiet: false
[2023-06-24 13:26:47] [config] quiet-translation: true
[2023-06-24 13:26:47] [config] relative-paths: false
[2023-06-24 13:26:47] [config] right-left: false
[2023-06-24 13:26:47] [config] save-freq: 10000u
[2023-06-24 13:26:47] [config] seed: 1234
[2023-06-24 13:26:47] [config] sentencepiece-alphas:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:26:47] [config] sentencepiece-options: ""
[2023-06-24 13:26:47] [config] sharding: global
[2023-06-24 13:26:47] [config] shuffle: data
[2023-06-24 13:26:47] [config] shuffle-in-ram: false
[2023-06-24 13:26:47] [config] sigterm: save-and-exit
[2023-06-24 13:26:47] [config] skip: false
[2023-06-24 13:26:47] [config] sqlite: ""
[2023-06-24 13:26:47] [config] sqlite-drop: false
[2023-06-24 13:26:47] [config] sync-freq: 200u
[2023-06-24 13:26:47] [config] sync-sgd: true
[2023-06-24 13:26:47] [config] tempdir: /tmp
[2023-06-24 13:26:47] [config] tied-embeddings: false
[2023-06-24 13:26:47] [config] tied-embeddings-all: false
[2023-06-24 13:26:47] [config] tied-embeddings-src: false
[2023-06-24 13:26:47] [config] train-embedder-rank:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] train-sets:
[2023-06-24 13:26:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:26:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:26:47] [config] transformer-aan-activation: swish
[2023-06-24 13:26:47] [config] transformer-aan-depth: 2
[2023-06-24 13:26:47] [config] transformer-aan-nogate: false
[2023-06-24 13:26:47] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:26:47] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:26:47] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:26:47] [config] transformer-depth-scaling: false
[2023-06-24 13:26:47] [config] transformer-dim-aan: 2048
[2023-06-24 13:26:47] [config] transformer-dim-ffn: 2048
[2023-06-24 13:26:47] [config] transformer-dropout: 0
[2023-06-24 13:26:47] [config] transformer-dropout-attention: 0
[2023-06-24 13:26:47] [config] transformer-dropout-ffn: 0
[2023-06-24 13:26:47] [config] transformer-ffn-activation: swish
[2023-06-24 13:26:47] [config] transformer-ffn-depth: 2
[2023-06-24 13:26:47] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:26:47] [config] transformer-heads: 8
[2023-06-24 13:26:47] [config] transformer-no-projection: false
[2023-06-24 13:26:47] [config] transformer-pool: false
[2023-06-24 13:26:47] [config] transformer-postprocess: dan
[2023-06-24 13:26:47] [config] transformer-postprocess-emb: d
[2023-06-24 13:26:47] [config] transformer-postprocess-top: ""
[2023-06-24 13:26:47] [config] transformer-preprocess: ""
[2023-06-24 13:26:47] [config] transformer-tied-layers:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] transformer-train-position-embeddings: false
[2023-06-24 13:26:47] [config] tsv: false
[2023-06-24 13:26:47] [config] tsv-fields: 0
[2023-06-24 13:26:47] [config] type: s2s
[2023-06-24 13:26:47] [config] ulr: false
[2023-06-24 13:26:47] [config] ulr-dim-emb: 0
[2023-06-24 13:26:47] [config] ulr-dropout: 0
[2023-06-24 13:26:47] [config] ulr-keys-vectors: ""
[2023-06-24 13:26:47] [config] ulr-query-vectors: ""
[2023-06-24 13:26:47] [config] ulr-softmax-temperature: 1
[2023-06-24 13:26:47] [config] ulr-trainable-transformation: false
[2023-06-24 13:26:47] [config] unlikelihood-loss: false
[2023-06-24 13:26:47] [config] valid-freq: 5000000
[2023-06-24 13:26:47] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:26:47] [config] valid-max-length: 1000
[2023-06-24 13:26:47] [config] valid-metrics:
[2023-06-24 13:26:47] [config]   - cross-entropy
[2023-06-24 13:26:47] [config]   - translation
[2023-06-24 13:26:47] [config] valid-mini-batch: 32
[2023-06-24 13:26:47] [config] valid-reset-stalled: false
[2023-06-24 13:26:47] [config] valid-script-args:
[2023-06-24 13:26:47] [config]   []
[2023-06-24 13:26:47] [config] valid-script-path: ""
[2023-06-24 13:26:47] [config] valid-sets:
[2023-06-24 13:26:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:26:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:26:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:26:47] [config] vocabs:
[2023-06-24 13:26:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:26:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:26:47] [config] word-penalty: 0
[2023-06-24 13:26:47] [config] word-scores: false
[2023-06-24 13:26:47] [config] workspace: 2048
[2023-06-24 13:26:47] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:26:47] Using synchronous SGD
[2023-06-24 13:26:48] Synced seed 1234
[2023-06-24 13:26:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:26:48] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:26:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:26:48] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:26:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:26:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:26:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 13:26:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:26:49] [comm] Using global sharding
[2023-06-24 13:26:49] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:26:49] [training] Using 1 GPUs
[2023-06-24 13:26:49] [logits] Applying loss function for 1 factor(s)
[2023-06-24 13:26:49] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:26:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 13:26:51] [memory] Reserving 521 MB, device gpu0
                                 [2023-06-24 13:27:12] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 13:27:12] [valid] No post-processing script given for validating translator
[2023-06-24 13:27:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:27:12] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 13:27:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:27:12] [comm] Using global sharding
[2023-06-24 13:27:12] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:27:12] [training] Using 1 GPUs
[2023-06-24 13:27:12] Training started
[2023-06-24 13:27:12] [data] Shuffling data
[2023-06-24 13:27:12] [data] Done reading 20,192 sentences
[2023-06-24 13:27:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:27:12] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 13:27:12] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:27:12] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:27:12] Parameter type float32, optimization type float32, casting types false
[2023-06-24 13:27:12] Allocating memory for general optimizer shards
[2023-06-24 13:27:12] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:27:12] Allocating memory for Adam-specific shards
[2023-06-24 13:27:12] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 13:28:24] [batching] Done. Typical MB size is 9,420 target words
[2023-06-24 13:28:24] [valid] No post-processing script given for validating translator
[2023-06-24 13:28:24] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:28:24] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:28:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:28:24] [comm] Using global sharding
[2023-06-24 13:28:24] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:28:24] [training] Using 1 GPUs
[2023-06-24 13:28:24] Training started
[2023-06-24 13:28:24] [data] Shuffling data
[2023-06-24 13:28:24] [data] Done reading 20,192 sentences
[2023-06-24 13:28:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:28:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 13:28:25] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:28:25] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:28:25] Parameter type float32, optimization type float32, casting types false
[2023-06-24 13:28:25] Allocating memory for general optimizer shards
[2023-06-24 13:28:25] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:28:25] Allocating memory for Adam-specific shards
[2023-06-24 13:28:25] [memory] Reserving 900 MB, device gpu0
[2023-06-24 13:28:25] Error: CUDA error 2 'out of memory' - /marian/src/tensors/gpu/device.cu:38: cudaMalloc(&data_, size)
[2023-06-24 13:28:25] Error: Aborted from virtual void marian::gpu::Device::reserve(size_t) in /marian/src/tensors/gpu/device.cu:38

[CALL STACK]
[0x5560f7fcfaf8]    marian::gpu::Device::  reserve  (unsigned long)    + 0x1218
[0x5560f77340b3]    marian::TensorAllocator::  reserveExact  (unsigned long) + 0x1c3
[0x5560f7f4725f]    marian::Adam::  updateImpl  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long) + 0x69f
[0x5560f7f48497]    marian::OptimizerBase::  update  (IntrusivePtr<marian::TensorBase>,  IntrusivePtr<marian::TensorBase>,  unsigned long,  float) + 0x657
[0x5560f7c83e6d]                                                       + 0x9b6e6d
[0x5560f7d2f4f3]    float marian::NCCLCommunicator::  foreachAcc  <float>(std::function<float (unsigned long,unsigned long,unsigned long)> const&,  std::function<void (float&,float)> const&,  float,  bool) const + 0x8b3
[0x5560f7ca449d]    marian::GraphGroup::  executeAndCollectNorm  (std::function<float (unsigned long,unsigned long,unsigned long)> const&) + 0x162d
[0x5560f7c8736d]    marian::SyncGraphGroup::  update  (std::vector<std::shared_ptr<marian::data::Batch>,std::allocator<std::shared_ptr<marian::data::Batch>>>,  unsigned long) + 0xb1d
[0x5560f7c87f05]    marian::SyncGraphGroup::  update  (std::shared_ptr<marian::data::Batch>) + 0x395
[0x5560f77859d1]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1c01
[0x5560f76a6058]    mainTrainer  (int,  char**)                        + 0x158
[0x5560f765db9c]    main                                               + 0x3c
[0x7fa1cefd30b3]    __libc_start_main                                  + 0xf3
[0x5560f76a4cbe]    _start                                             + 0x2e

[2023-06-24 13:28:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:28:30] [marian] Running on node07.datos.cluster.uy as process 8063 with command line:
[2023-06-24 13:28:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --workspace 9500 --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --tied-embeddings --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:28:30] [config] after: 0e
[2023-06-24 13:28:30] [config] after-batches: 0
[2023-06-24 13:28:30] [config] after-epochs: 50
[2023-06-24 13:28:30] [config] all-caps-every: 0
[2023-06-24 13:28:30] [config] allow-unk: false
[2023-06-24 13:28:30] [config] authors: false
[2023-06-24 13:28:30] [config] beam-size: 12
[2023-06-24 13:28:30] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:28:30] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:28:30] [config] bert-masking-fraction: 0.15
[2023-06-24 13:28:30] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:28:30] [config] bert-train-type-embeddings: true
[2023-06-24 13:28:30] [config] bert-type-vocab-size: 2
[2023-06-24 13:28:30] [config] build-info: ""
[2023-06-24 13:28:30] [config] check-gradient-nan: false
[2023-06-24 13:28:30] [config] check-nan: false
[2023-06-24 13:28:30] [config] cite: false
[2023-06-24 13:28:30] [config] clip-norm: 5
[2023-06-24 13:28:30] [config] cost-scaling:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] cost-type: ce-mean-words
[2023-06-24 13:28:30] [config] cpu-threads: 0
[2023-06-24 13:28:30] [config] data-threads: 8
[2023-06-24 13:28:30] [config] data-weighting: ""
[2023-06-24 13:28:30] [config] data-weighting-type: sentence
[2023-06-24 13:28:30] [config] dec-cell: gru
[2023-06-24 13:28:30] [config] dec-cell-base-depth: 8
[2023-06-24 13:28:30] [config] dec-cell-high-depth: 1
[2023-06-24 13:28:30] [config] dec-depth: 1
[2023-06-24 13:28:30] [config] devices:
[2023-06-24 13:28:30] [config]   - 0
[2023-06-24 13:28:30] [config] dim-emb: 512
[2023-06-24 13:28:30] [config] dim-rnn: 1024
[2023-06-24 13:28:30] [config] dim-vocabs:
[2023-06-24 13:28:30] [config]   - 0
[2023-06-24 13:28:30] [config]   - 0
[2023-06-24 13:28:30] [config] disp-first: 0
[2023-06-24 13:28:30] [config] disp-freq: 1000u
[2023-06-24 13:28:30] [config] disp-label-counts: true
[2023-06-24 13:28:30] [config] dropout-rnn: 0.1
[2023-06-24 13:28:30] [config] dropout-src: 0
[2023-06-24 13:28:30] [config] dropout-trg: 0
[2023-06-24 13:28:30] [config] dump-config: ""
[2023-06-24 13:28:30] [config] dynamic-gradient-scaling:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] early-stopping: 10
[2023-06-24 13:28:30] [config] early-stopping-on: first
[2023-06-24 13:28:30] [config] embedding-fix-src: false
[2023-06-24 13:28:30] [config] embedding-fix-trg: false
[2023-06-24 13:28:30] [config] embedding-normalization: false
[2023-06-24 13:28:30] [config] embedding-vectors:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] enc-cell: gru
[2023-06-24 13:28:30] [config] enc-cell-depth: 4
[2023-06-24 13:28:30] [config] enc-depth: 1
[2023-06-24 13:28:30] [config] enc-type: bidirectional
[2023-06-24 13:28:30] [config] english-title-case-every: 0
[2023-06-24 13:28:30] [config] exponential-smoothing: 0.0001
[2023-06-24 13:28:30] [config] factor-weight: 1
[2023-06-24 13:28:30] [config] factors-combine: sum
[2023-06-24 13:28:30] [config] factors-dim-emb: 0
[2023-06-24 13:28:30] [config] gradient-checkpointing: false
[2023-06-24 13:28:30] [config] gradient-norm-average-window: 100
[2023-06-24 13:28:30] [config] guided-alignment: none
[2023-06-24 13:28:30] [config] guided-alignment-cost: mse
[2023-06-24 13:28:30] [config] guided-alignment-weight: 0.1
[2023-06-24 13:28:30] [config] ignore-model-config: false
[2023-06-24 13:28:30] [config] input-types:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] interpolate-env-vars: false
[2023-06-24 13:28:30] [config] keep-best: false
[2023-06-24 13:28:30] [config] label-smoothing: 0.1
[2023-06-24 13:28:30] [config] layer-normalization: true
[2023-06-24 13:28:30] [config] learn-rate: 0.0003
[2023-06-24 13:28:30] [config] lemma-dependency: ""
[2023-06-24 13:28:30] [config] lemma-dim-emb: 0
[2023-06-24 13:28:30] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:28:30] [config] log-level: info
[2023-06-24 13:28:30] [config] log-time-zone: ""
[2023-06-24 13:28:30] [config] logical-epoch:
[2023-06-24 13:28:30] [config]   - 1e
[2023-06-24 13:28:30] [config]   - 0
[2023-06-24 13:28:30] [config] lr-decay: 0
[2023-06-24 13:28:30] [config] lr-decay-freq: 50000
[2023-06-24 13:28:30] [config] lr-decay-inv-sqrt:
[2023-06-24 13:28:30] [config]   - 16000
[2023-06-24 13:28:30] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:28:30] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:28:30] [config] lr-decay-start:
[2023-06-24 13:28:30] [config]   - 10
[2023-06-24 13:28:30] [config]   - 1
[2023-06-24 13:28:30] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:28:30] [config] lr-report: false
[2023-06-24 13:28:30] [config] lr-warmup: 0
[2023-06-24 13:28:30] [config] lr-warmup-at-reload: false
[2023-06-24 13:28:30] [config] lr-warmup-cycle: false
[2023-06-24 13:28:30] [config] lr-warmup-start-rate: 0
[2023-06-24 13:28:30] [config] max-length: 100
[2023-06-24 13:28:30] [config] max-length-crop: false
[2023-06-24 13:28:30] [config] max-length-factor: 3
[2023-06-24 13:28:30] [config] maxi-batch: 1000
[2023-06-24 13:28:30] [config] maxi-batch-sort: trg
[2023-06-24 13:28:30] [config] mini-batch: 1000
[2023-06-24 13:28:30] [config] mini-batch-fit: true
[2023-06-24 13:28:30] [config] mini-batch-fit-step: 10
[2023-06-24 13:28:30] [config] mini-batch-round-up: true
[2023-06-24 13:28:30] [config] mini-batch-track-lr: false
[2023-06-24 13:28:30] [config] mini-batch-warmup: 0
[2023-06-24 13:28:30] [config] mini-batch-words: 0
[2023-06-24 13:28:30] [config] mini-batch-words-ref: 0
[2023-06-24 13:28:30] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:28:30] [config] multi-loss-type: sum
[2023-06-24 13:28:30] [config] n-best: false
[2023-06-24 13:28:30] [config] no-nccl: false
[2023-06-24 13:28:30] [config] no-reload: false
[2023-06-24 13:28:30] [config] no-restore-corpus: false
[2023-06-24 13:28:30] [config] normalize: 1
[2023-06-24 13:28:30] [config] normalize-gradient: false
[2023-06-24 13:28:30] [config] num-devices: 0
[2023-06-24 13:28:30] [config] optimizer: adam
[2023-06-24 13:28:30] [config] optimizer-delay: 1
[2023-06-24 13:28:30] [config] optimizer-params:
[2023-06-24 13:28:30] [config]   - 0.9
[2023-06-24 13:28:30] [config]   - 0.98
[2023-06-24 13:28:30] [config]   - 1e-09
[2023-06-24 13:28:30] [config] output-omit-bias: false
[2023-06-24 13:28:30] [config] overwrite: false
[2023-06-24 13:28:30] [config] precision:
[2023-06-24 13:28:30] [config]   - float32
[2023-06-24 13:28:30] [config]   - float32
[2023-06-24 13:28:30] [config] pretrained-model: ""
[2023-06-24 13:28:30] [config] quantize-biases: false
[2023-06-24 13:28:30] [config] quantize-bits: 0
[2023-06-24 13:28:30] [config] quantize-log-based: false
[2023-06-24 13:28:30] [config] quantize-optimization-steps: 0
[2023-06-24 13:28:30] [config] quiet: false
[2023-06-24 13:28:30] [config] quiet-translation: true
[2023-06-24 13:28:30] [config] relative-paths: false
[2023-06-24 13:28:30] [config] right-left: false
[2023-06-24 13:28:30] [config] save-freq: 10000u
[2023-06-24 13:28:30] [config] seed: 1234
[2023-06-24 13:28:30] [config] sentencepiece-alphas:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:28:30] [config] sentencepiece-options: ""
[2023-06-24 13:28:30] [config] sharding: global
[2023-06-24 13:28:30] [config] shuffle: data
[2023-06-24 13:28:30] [config] shuffle-in-ram: false
[2023-06-24 13:28:30] [config] sigterm: save-and-exit
[2023-06-24 13:28:30] [config] skip: false
[2023-06-24 13:28:30] [config] sqlite: ""
[2023-06-24 13:28:30] [config] sqlite-drop: false
[2023-06-24 13:28:30] [config] sync-freq: 200u
[2023-06-24 13:28:30] [config] sync-sgd: true
[2023-06-24 13:28:30] [config] tempdir: /tmp
[2023-06-24 13:28:30] [config] tied-embeddings: true
[2023-06-24 13:28:30] [config] tied-embeddings-all: false
[2023-06-24 13:28:30] [config] tied-embeddings-src: false
[2023-06-24 13:28:30] [config] train-embedder-rank:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] train-sets:
[2023-06-24 13:28:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:28:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:28:30] [config] transformer-aan-activation: swish
[2023-06-24 13:28:30] [config] transformer-aan-depth: 2
[2023-06-24 13:28:30] [config] transformer-aan-nogate: false
[2023-06-24 13:28:30] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:28:30] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:28:30] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:28:30] [config] transformer-depth-scaling: false
[2023-06-24 13:28:30] [config] transformer-dim-aan: 2048
[2023-06-24 13:28:30] [config] transformer-dim-ffn: 2048
[2023-06-24 13:28:30] [config] transformer-dropout: 0
[2023-06-24 13:28:30] [config] transformer-dropout-attention: 0
[2023-06-24 13:28:30] [config] transformer-dropout-ffn: 0
[2023-06-24 13:28:30] [config] transformer-ffn-activation: swish
[2023-06-24 13:28:30] [config] transformer-ffn-depth: 2
[2023-06-24 13:28:30] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:28:30] [config] transformer-heads: 8
[2023-06-24 13:28:30] [config] transformer-no-projection: false
[2023-06-24 13:28:30] [config] transformer-pool: false
[2023-06-24 13:28:30] [config] transformer-postprocess: dan
[2023-06-24 13:28:30] [config] transformer-postprocess-emb: d
[2023-06-24 13:28:30] [config] transformer-postprocess-top: ""
[2023-06-24 13:28:30] [config] transformer-preprocess: ""
[2023-06-24 13:28:30] [config] transformer-tied-layers:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] transformer-train-position-embeddings: false
[2023-06-24 13:28:30] [config] tsv: false
[2023-06-24 13:28:30] [config] tsv-fields: 0
[2023-06-24 13:28:30] [config] type: s2s
[2023-06-24 13:28:30] [config] ulr: false
[2023-06-24 13:28:30] [config] ulr-dim-emb: 0
[2023-06-24 13:28:30] [config] ulr-dropout: 0
[2023-06-24 13:28:30] [config] ulr-keys-vectors: ""
[2023-06-24 13:28:30] [config] ulr-query-vectors: ""
[2023-06-24 13:28:30] [config] ulr-softmax-temperature: 1
[2023-06-24 13:28:30] [config] ulr-trainable-transformation: false
[2023-06-24 13:28:30] [config] unlikelihood-loss: false
[2023-06-24 13:28:30] [config] valid-freq: 5000000
[2023-06-24 13:28:30] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:28:30] [config] valid-max-length: 1000
[2023-06-24 13:28:30] [config] valid-metrics:
[2023-06-24 13:28:30] [config]   - cross-entropy
[2023-06-24 13:28:30] [config]   - translation
[2023-06-24 13:28:30] [config] valid-mini-batch: 32
[2023-06-24 13:28:30] [config] valid-reset-stalled: false
[2023-06-24 13:28:30] [config] valid-script-args:
[2023-06-24 13:28:30] [config]   []
[2023-06-24 13:28:30] [config] valid-script-path: ""
[2023-06-24 13:28:30] [config] valid-sets:
[2023-06-24 13:28:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:28:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:28:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:28:30] [config] vocabs:
[2023-06-24 13:28:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:28:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:28:30] [config] word-penalty: 0
[2023-06-24 13:28:30] [config] word-scores: false
[2023-06-24 13:28:30] [config] workspace: 9500
[2023-06-24 13:28:30] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:28:30] Using synchronous SGD
[2023-06-24 13:28:30] Synced seed 1234
[2023-06-24 13:28:30] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:28:30] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:28:30] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:28:30] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:28:30] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:28:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:28:31] [memory] Extending reserved space to 9600 MB (device gpu0)
[2023-06-24 13:28:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:28:31] [comm] Using global sharding
[2023-06-24 13:28:31] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:28:31] [training] Using 1 GPUs
[2023-06-24 13:28:31] [logits] Applying loss function for 1 factor(s)
[2023-06-24 13:28:31] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:28:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 13:28:32] [memory] Reserving 450 MB, device gpu0
[2023-06-24 13:29:03] Seen 20,177 samples
[2023-06-24 13:29:03] Starting data epoch 2 in logical epoch 2
[2023-06-24 13:29:03] [data] Shuffling data
[2023-06-24 13:29:03] [data] Done reading 20,192 sentences
[2023-06-24 13:29:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:32:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:32:15] [marian] Running on node07.datos.cluster.uy as process 8378 with command line:
[2023-06-24 13:32:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 13:32:15] [config] after: 0e
[2023-06-24 13:32:15] [config] after-batches: 0
[2023-06-24 13:32:15] [config] after-epochs: 10
[2023-06-24 13:32:15] [config] all-caps-every: 0
[2023-06-24 13:32:15] [config] allow-unk: false
[2023-06-24 13:32:15] [config] authors: false
[2023-06-24 13:32:15] [config] beam-size: 12
[2023-06-24 13:32:15] [config] bert-class-symbol: "[CLS]"
[2023-06-24 13:32:15] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 13:32:15] [config] bert-masking-fraction: 0.15
[2023-06-24 13:32:15] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 13:32:15] [config] bert-train-type-embeddings: true
[2023-06-24 13:32:15] [config] bert-type-vocab-size: 2
[2023-06-24 13:32:15] [config] build-info: ""
[2023-06-24 13:32:15] [config] check-gradient-nan: false
[2023-06-24 13:32:15] [config] check-nan: false
[2023-06-24 13:32:15] [config] cite: false
[2023-06-24 13:32:15] [config] clip-norm: 5
[2023-06-24 13:32:15] [config] cost-scaling:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] cost-type: ce-mean-words
[2023-06-24 13:32:15] [config] cpu-threads: 0
[2023-06-24 13:32:15] [config] data-threads: 8
[2023-06-24 13:32:15] [config] data-weighting: ""
[2023-06-24 13:32:15] [config] data-weighting-type: sentence
[2023-06-24 13:32:15] [config] dec-cell: gru
[2023-06-24 13:32:15] [config] dec-cell-base-depth: 8
[2023-06-24 13:32:15] [config] dec-cell-high-depth: 1
[2023-06-24 13:32:15] [config] dec-depth: 1
[2023-06-24 13:32:15] [config] devices:
[2023-06-24 13:32:15] [config]   - 0
[2023-06-24 13:32:15] [config] dim-emb: 512
[2023-06-24 13:32:15] [config] dim-rnn: 1024
[2023-06-24 13:32:15] [config] dim-vocabs:
[2023-06-24 13:32:15] [config]   - 0
[2023-06-24 13:32:15] [config]   - 0
[2023-06-24 13:32:15] [config] disp-first: 0
[2023-06-24 13:32:15] [config] disp-freq: 1000u
[2023-06-24 13:32:15] [config] disp-label-counts: true
[2023-06-24 13:32:15] [config] dropout-rnn: 0.1
[2023-06-24 13:32:15] [config] dropout-src: 0
[2023-06-24 13:32:15] [config] dropout-trg: 0
[2023-06-24 13:32:15] [config] dump-config: ""
[2023-06-24 13:32:15] [config] dynamic-gradient-scaling:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] early-stopping: 10
[2023-06-24 13:32:15] [config] early-stopping-on: first
[2023-06-24 13:32:15] [config] embedding-fix-src: false
[2023-06-24 13:32:15] [config] embedding-fix-trg: false
[2023-06-24 13:32:15] [config] embedding-normalization: false
[2023-06-24 13:32:15] [config] embedding-vectors:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] enc-cell: gru
[2023-06-24 13:32:15] [config] enc-cell-depth: 4
[2023-06-24 13:32:15] [config] enc-depth: 1
[2023-06-24 13:32:15] [config] enc-type: bidirectional
[2023-06-24 13:32:15] [config] english-title-case-every: 0
[2023-06-24 13:32:15] [config] exponential-smoothing: 0.0001
[2023-06-24 13:32:15] [config] factor-weight: 1
[2023-06-24 13:32:15] [config] factors-combine: sum
[2023-06-24 13:32:15] [config] factors-dim-emb: 0
[2023-06-24 13:32:15] [config] gradient-checkpointing: false
[2023-06-24 13:32:15] [config] gradient-norm-average-window: 100
[2023-06-24 13:32:15] [config] guided-alignment: none
[2023-06-24 13:32:15] [config] guided-alignment-cost: mse
[2023-06-24 13:32:15] [config] guided-alignment-weight: 0.1
[2023-06-24 13:32:15] [config] ignore-model-config: false
[2023-06-24 13:32:15] [config] input-types:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] interpolate-env-vars: false
[2023-06-24 13:32:15] [config] keep-best: false
[2023-06-24 13:32:15] [config] label-smoothing: 0.1
[2023-06-24 13:32:15] [config] layer-normalization: true
[2023-06-24 13:32:15] [config] learn-rate: 0.0003
[2023-06-24 13:32:15] [config] lemma-dependency: ""
[2023-06-24 13:32:15] [config] lemma-dim-emb: 0
[2023-06-24 13:32:15] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 13:32:15] [config] log-level: info
[2023-06-24 13:32:15] [config] log-time-zone: ""
[2023-06-24 13:32:15] [config] logical-epoch:
[2023-06-24 13:32:15] [config]   - 1e
[2023-06-24 13:32:15] [config]   - 0
[2023-06-24 13:32:15] [config] lr-decay: 0
[2023-06-24 13:32:15] [config] lr-decay-freq: 50000
[2023-06-24 13:32:15] [config] lr-decay-inv-sqrt:
[2023-06-24 13:32:15] [config]   - 16000
[2023-06-24 13:32:15] [config] lr-decay-repeat-warmup: false
[2023-06-24 13:32:15] [config] lr-decay-reset-optimizer: false
[2023-06-24 13:32:15] [config] lr-decay-start:
[2023-06-24 13:32:15] [config]   - 10
[2023-06-24 13:32:15] [config]   - 1
[2023-06-24 13:32:15] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 13:32:15] [config] lr-report: false
[2023-06-24 13:32:15] [config] lr-warmup: 0
[2023-06-24 13:32:15] [config] lr-warmup-at-reload: false
[2023-06-24 13:32:15] [config] lr-warmup-cycle: false
[2023-06-24 13:32:15] [config] lr-warmup-start-rate: 0
[2023-06-24 13:32:15] [config] max-length: 100
[2023-06-24 13:32:15] [config] max-length-crop: false
[2023-06-24 13:32:15] [config] max-length-factor: 3
[2023-06-24 13:32:15] [config] maxi-batch: 1000
[2023-06-24 13:32:15] [config] maxi-batch-sort: trg
[2023-06-24 13:32:15] [config] mini-batch: 1000
[2023-06-24 13:32:15] [config] mini-batch-fit: true
[2023-06-24 13:32:15] [config] mini-batch-fit-step: 10
[2023-06-24 13:32:15] [config] mini-batch-round-up: true
[2023-06-24 13:32:15] [config] mini-batch-track-lr: false
[2023-06-24 13:32:15] [config] mini-batch-warmup: 0
[2023-06-24 13:32:15] [config] mini-batch-words: 0
[2023-06-24 13:32:15] [config] mini-batch-words-ref: 0
[2023-06-24 13:32:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:32:15] [config] multi-loss-type: sum
[2023-06-24 13:32:15] [config] n-best: false
[2023-06-24 13:32:15] [config] no-nccl: false
[2023-06-24 13:32:15] [config] no-reload: false
[2023-06-24 13:32:15] [config] no-restore-corpus: false
[2023-06-24 13:32:15] [config] normalize: 1
[2023-06-24 13:32:15] [config] normalize-gradient: false
[2023-06-24 13:32:15] [config] num-devices: 0
[2023-06-24 13:32:15] [config] optimizer: adam
[2023-06-24 13:32:15] [config] optimizer-delay: 1
[2023-06-24 13:32:15] [config] optimizer-params:
[2023-06-24 13:32:15] [config]   - 0.9
[2023-06-24 13:32:15] [config]   - 0.98
[2023-06-24 13:32:15] [config]   - 1e-09
[2023-06-24 13:32:15] [config] output-omit-bias: false
[2023-06-24 13:32:15] [config] overwrite: false
[2023-06-24 13:32:15] [config] precision:
[2023-06-24 13:32:15] [config]   - float32
[2023-06-24 13:32:15] [config]   - float32
[2023-06-24 13:32:15] [config] pretrained-model: ""
[2023-06-24 13:32:15] [config] quantize-biases: false
[2023-06-24 13:32:15] [config] quantize-bits: 0
[2023-06-24 13:32:15] [config] quantize-log-based: false
[2023-06-24 13:32:15] [config] quantize-optimization-steps: 0
[2023-06-24 13:32:15] [config] quiet: false
[2023-06-24 13:32:15] [config] quiet-translation: true
[2023-06-24 13:32:15] [config] relative-paths: false
[2023-06-24 13:32:15] [config] right-left: false
[2023-06-24 13:32:15] [config] save-freq: 10000u
[2023-06-24 13:32:15] [config] seed: 1234
[2023-06-24 13:32:15] [config] sentencepiece-alphas:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] sentencepiece-max-lines: 2000000
[2023-06-24 13:32:15] [config] sentencepiece-options: ""
[2023-06-24 13:32:15] [config] sharding: global
[2023-06-24 13:32:15] [config] shuffle: data
[2023-06-24 13:32:15] [config] shuffle-in-ram: false
[2023-06-24 13:32:15] [config] sigterm: save-and-exit
[2023-06-24 13:32:15] [config] skip: false
[2023-06-24 13:32:15] [config] sqlite: ""
[2023-06-24 13:32:15] [config] sqlite-drop: false
[2023-06-24 13:32:15] [config] sync-freq: 200u
[2023-06-24 13:32:15] [config] sync-sgd: true
[2023-06-24 13:32:15] [config] tempdir: /tmp
[2023-06-24 13:32:15] [config] tied-embeddings: false
[2023-06-24 13:32:15] [config] tied-embeddings-all: false
[2023-06-24 13:32:15] [config] tied-embeddings-src: false
[2023-06-24 13:32:15] [config] train-embedder-rank:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] train-sets:
[2023-06-24 13:32:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 13:32:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 13:32:15] [config] transformer-aan-activation: swish
[2023-06-24 13:32:15] [config] transformer-aan-depth: 2
[2023-06-24 13:32:15] [config] transformer-aan-nogate: false
[2023-06-24 13:32:15] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 13:32:15] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 13:32:15] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 13:32:15] [config] transformer-depth-scaling: false
[2023-06-24 13:32:15] [config] transformer-dim-aan: 2048
[2023-06-24 13:32:15] [config] transformer-dim-ffn: 2048
[2023-06-24 13:32:15] [config] transformer-dropout: 0
[2023-06-24 13:32:15] [config] transformer-dropout-attention: 0
[2023-06-24 13:32:15] [config] transformer-dropout-ffn: 0
[2023-06-24 13:32:15] [config] transformer-ffn-activation: swish
[2023-06-24 13:32:15] [config] transformer-ffn-depth: 2
[2023-06-24 13:32:15] [config] transformer-guided-alignment-layer: last
[2023-06-24 13:32:15] [config] transformer-heads: 8
[2023-06-24 13:32:15] [config] transformer-no-projection: false
[2023-06-24 13:32:15] [config] transformer-pool: false
[2023-06-24 13:32:15] [config] transformer-postprocess: dan
[2023-06-24 13:32:15] [config] transformer-postprocess-emb: d
[2023-06-24 13:32:15] [config] transformer-postprocess-top: ""
[2023-06-24 13:32:15] [config] transformer-preprocess: ""
[2023-06-24 13:32:15] [config] transformer-tied-layers:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] transformer-train-position-embeddings: false
[2023-06-24 13:32:15] [config] tsv: false
[2023-06-24 13:32:15] [config] tsv-fields: 0
[2023-06-24 13:32:15] [config] type: s2s
[2023-06-24 13:32:15] [config] ulr: false
[2023-06-24 13:32:15] [config] ulr-dim-emb: 0
[2023-06-24 13:32:15] [config] ulr-dropout: 0
[2023-06-24 13:32:15] [config] ulr-keys-vectors: ""
[2023-06-24 13:32:15] [config] ulr-query-vectors: ""
[2023-06-24 13:32:15] [config] ulr-softmax-temperature: 1
[2023-06-24 13:32:15] [config] ulr-trainable-transformation: false
[2023-06-24 13:32:15] [config] unlikelihood-loss: false
[2023-06-24 13:32:15] [config] valid-freq: 5000000
[2023-06-24 13:32:15] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 13:32:15] [config] valid-max-length: 1000
[2023-06-24 13:32:15] [config] valid-metrics:
[2023-06-24 13:32:15] [config]   - cross-entropy
[2023-06-24 13:32:15] [config]   - translation
[2023-06-24 13:32:15] [config] valid-mini-batch: 32
[2023-06-24 13:32:15] [config] valid-reset-stalled: false
[2023-06-24 13:32:15] [config] valid-script-args:
[2023-06-24 13:32:15] [config]   []
[2023-06-24 13:32:15] [config] valid-script-path: ""
[2023-06-24 13:32:15] [config] valid-sets:
[2023-06-24 13:32:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 13:32:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 13:32:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 13:32:15] [config] vocabs:
[2023-06-24 13:32:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:32:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:32:15] [config] word-penalty: 0
[2023-06-24 13:32:15] [config] word-scores: false
[2023-06-24 13:32:15] [config] workspace: 2048
[2023-06-24 13:32:15] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 13:32:15] Using synchronous SGD
[2023-06-24 13:32:16] Synced seed 1234
[2023-06-24 13:32:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 13:32:16] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 13:32:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 13:32:16] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 13:32:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 13:32:16] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:32:16] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 13:32:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:32:17] [comm] Using global sharding
[2023-06-24 13:32:17] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:32:17] [training] Using 1 GPUs
[2023-06-24 13:32:17] [logits] Applying loss function for 1 factor(s)
[2023-06-24 13:32:17] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:32:19] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 13:32:19] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:32:40] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 13:32:40] [valid] No post-processing script given for validating translator
[2023-06-24 13:32:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 13:32:40] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 13:32:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 13:32:40] [comm] Using global sharding
[2023-06-24 13:32:40] [comm] NCCLCommunicators constructed successfully
[2023-06-24 13:32:40] [training] Using 1 GPUs
[2023-06-24 13:32:40] Training started
[2023-06-24 13:32:40] [data] Shuffling data
[2023-06-24 13:32:40] [data] Done reading 20,192 sentences
[2023-06-24 13:32:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:32:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 13:32:40] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:32:40] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:32:40] Parameter type float32, optimization type float32, casting types false
[2023-06-24 13:32:40] Allocating memory for general optimizer shards
[2023-06-24 13:32:40] [memory] Reserving 521 MB, device gpu0
[2023-06-24 13:32:40] Allocating memory for Adam-specific shards
[2023-06-24 13:32:40] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 13:34:35] Seen 20,177 samples
[2023-06-24 13:34:35] Starting data epoch 2 in logical epoch 2
[2023-06-24 13:34:35] [data] Shuffling data
[2023-06-24 13:34:35] [data] Done reading 20,192 sentences
[2023-06-24 13:34:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:36:44] Seen 20,177 samples
[2023-06-24 13:36:44] Starting data epoch 3 in logical epoch 3
[2023-06-24 13:36:44] [data] Shuffling data
[2023-06-24 13:36:44] [data] Done reading 20,192 sentences
[2023-06-24 13:36:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:38:57] Seen 20,177 samples
[2023-06-24 13:38:57] Starting data epoch 4 in logical epoch 4
[2023-06-24 13:38:57] [data] Shuffling data
[2023-06-24 13:38:57] [data] Done reading 20,192 sentences
[2023-06-24 13:38:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:39:01] Ep. 4 : Up. 1000 : Sen. 474 : Cost 5.97023964 : Time 381.30s : 3800.58 words/s : gNorm 0.7505
[2023-06-24 13:41:09] Seen 20,177 samples
[2023-06-24 13:41:09] Starting data epoch 5 in logical epoch 5
[2023-06-24 13:41:09] [data] Shuffling data
[2023-06-24 13:41:09] [data] Done reading 20,192 sentences
[2023-06-24 13:41:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:43:21] Seen 20,177 samples
[2023-06-24 13:43:21] Starting data epoch 6 in logical epoch 6
[2023-06-24 13:43:21] [data] Shuffling data
[2023-06-24 13:43:21] [data] Done reading 20,192 sentences
[2023-06-24 13:43:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:45:33] Seen 20,177 samples
[2023-06-24 13:45:33] Starting data epoch 7 in logical epoch 7
[2023-06-24 13:45:33] [data] Shuffling data
[2023-06-24 13:45:33] [data] Done reading 20,192 sentences
[2023-06-24 13:45:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:45:41] Ep. 7 : Up. 2000 : Sen. 1,037 : Cost 5.04480839 : Time 400.43s : 3616.47 words/s : gNorm 0.7625
[2023-06-24 13:47:44] Seen 20,177 samples
[2023-06-24 13:47:44] Starting data epoch 8 in logical epoch 8
[2023-06-24 13:47:44] [data] Shuffling data
[2023-06-24 13:47:45] [data] Done reading 20,192 sentences
[2023-06-24 13:47:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:49:58] Seen 20,177 samples
[2023-06-24 13:49:58] Starting data epoch 9 in logical epoch 9
[2023-06-24 13:49:58] [data] Shuffling data
[2023-06-24 13:49:58] [data] Done reading 20,192 sentences
[2023-06-24 13:49:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:52:09] Seen 20,177 samples
[2023-06-24 13:52:09] Starting data epoch 10 in logical epoch 10
[2023-06-24 13:52:09] [data] Shuffling data
[2023-06-24 13:52:09] [data] Done reading 20,192 sentences
[2023-06-24 13:52:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 13:52:23] Ep. 10 : Up. 3000 : Sen. 1,744 : Cost 4.40544081 : Time 401.32s : 3612.24 words/s : gNorm 0.9061
[2023-06-24 13:54:20] Seen 20,177 samples
[2023-06-24 13:54:20] Starting data epoch 11 in logical epoch 11
[2023-06-24 13:54:20] Training finished
[2023-06-24 13:54:32] [valid] Ep. 11 : Up. 3300 : cross-entropy : 94.2576 : new best
[2023-06-24 13:58:13] [valid] Ep. 11 : Up. 3300 : translation : 0 : new best
[2023-06-24 13:58:13] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 13:58:19] Saving Adam parameters
[2023-06-24 13:58:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 14:06:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 14:06:14] [marian] Running on node07.datos.cluster.uy as process 10630 with command line:
[2023-06-24 14:06:14] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 14:06:14] [config] after: 0e
[2023-06-24 14:06:14] [config] after-batches: 0
[2023-06-24 14:06:14] [config] after-epochs: 20
[2023-06-24 14:06:14] [config] all-caps-every: 0
[2023-06-24 14:06:14] [config] allow-unk: false
[2023-06-24 14:06:14] [config] authors: false
[2023-06-24 14:06:14] [config] beam-size: 12
[2023-06-24 14:06:14] [config] bert-class-symbol: "[CLS]"
[2023-06-24 14:06:14] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 14:06:14] [config] bert-masking-fraction: 0.15
[2023-06-24 14:06:14] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 14:06:14] [config] bert-train-type-embeddings: true
[2023-06-24 14:06:14] [config] bert-type-vocab-size: 2
[2023-06-24 14:06:14] [config] build-info: ""
[2023-06-24 14:06:14] [config] check-gradient-nan: false
[2023-06-24 14:06:14] [config] check-nan: false
[2023-06-24 14:06:14] [config] cite: false
[2023-06-24 14:06:14] [config] clip-norm: 5
[2023-06-24 14:06:14] [config] cost-scaling:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] cost-type: ce-mean-words
[2023-06-24 14:06:14] [config] cpu-threads: 0
[2023-06-24 14:06:14] [config] data-threads: 8
[2023-06-24 14:06:14] [config] data-weighting: ""
[2023-06-24 14:06:14] [config] data-weighting-type: sentence
[2023-06-24 14:06:14] [config] dec-cell: gru
[2023-06-24 14:06:14] [config] dec-cell-base-depth: 8
[2023-06-24 14:06:14] [config] dec-cell-high-depth: 1
[2023-06-24 14:06:14] [config] dec-depth: 1
[2023-06-24 14:06:14] [config] devices:
[2023-06-24 14:06:14] [config]   - 0
[2023-06-24 14:06:14] [config] dim-emb: 512
[2023-06-24 14:06:14] [config] dim-rnn: 1024
[2023-06-24 14:06:14] [config] dim-vocabs:
[2023-06-24 14:06:14] [config]   - 54042
[2023-06-24 14:06:14] [config]   - 36507
[2023-06-24 14:06:14] [config] disp-first: 0
[2023-06-24 14:06:14] [config] disp-freq: 1000u
[2023-06-24 14:06:14] [config] disp-label-counts: true
[2023-06-24 14:06:14] [config] dropout-rnn: 0.1
[2023-06-24 14:06:14] [config] dropout-src: 0
[2023-06-24 14:06:14] [config] dropout-trg: 0
[2023-06-24 14:06:14] [config] dump-config: ""
[2023-06-24 14:06:14] [config] dynamic-gradient-scaling:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] early-stopping: 10
[2023-06-24 14:06:14] [config] early-stopping-on: first
[2023-06-24 14:06:14] [config] embedding-fix-src: false
[2023-06-24 14:06:14] [config] embedding-fix-trg: false
[2023-06-24 14:06:14] [config] embedding-normalization: false
[2023-06-24 14:06:14] [config] embedding-vectors:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] enc-cell: gru
[2023-06-24 14:06:14] [config] enc-cell-depth: 4
[2023-06-24 14:06:14] [config] enc-depth: 1
[2023-06-24 14:06:14] [config] enc-type: bidirectional
[2023-06-24 14:06:14] [config] english-title-case-every: 0
[2023-06-24 14:06:14] [config] exponential-smoothing: 0.0001
[2023-06-24 14:06:14] [config] factor-weight: 1
[2023-06-24 14:06:14] [config] factors-combine: sum
[2023-06-24 14:06:14] [config] factors-dim-emb: 0
[2023-06-24 14:06:14] [config] gradient-checkpointing: false
[2023-06-24 14:06:14] [config] gradient-norm-average-window: 100
[2023-06-24 14:06:14] [config] guided-alignment: none
[2023-06-24 14:06:14] [config] guided-alignment-cost: mse
[2023-06-24 14:06:14] [config] guided-alignment-weight: 0.1
[2023-06-24 14:06:14] [config] ignore-model-config: false
[2023-06-24 14:06:14] [config] input-types:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] interpolate-env-vars: false
[2023-06-24 14:06:14] [config] keep-best: false
[2023-06-24 14:06:14] [config] label-smoothing: 0.1
[2023-06-24 14:06:14] [config] layer-normalization: true
[2023-06-24 14:06:14] [config] learn-rate: 0.0003
[2023-06-24 14:06:14] [config] lemma-dependency: ""
[2023-06-24 14:06:14] [config] lemma-dim-emb: 0
[2023-06-24 14:06:14] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 14:06:14] [config] log-level: info
[2023-06-24 14:06:14] [config] log-time-zone: ""
[2023-06-24 14:06:14] [config] logical-epoch:
[2023-06-24 14:06:14] [config]   - 1e
[2023-06-24 14:06:14] [config]   - 0
[2023-06-24 14:06:14] [config] lr-decay: 0
[2023-06-24 14:06:14] [config] lr-decay-freq: 50000
[2023-06-24 14:06:14] [config] lr-decay-inv-sqrt:
[2023-06-24 14:06:14] [config]   - 16000
[2023-06-24 14:06:14] [config] lr-decay-repeat-warmup: false
[2023-06-24 14:06:14] [config] lr-decay-reset-optimizer: false
[2023-06-24 14:06:14] [config] lr-decay-start:
[2023-06-24 14:06:14] [config]   - 10
[2023-06-24 14:06:14] [config]   - 1
[2023-06-24 14:06:14] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 14:06:14] [config] lr-report: false
[2023-06-24 14:06:14] [config] lr-warmup: 0
[2023-06-24 14:06:14] [config] lr-warmup-at-reload: false
[2023-06-24 14:06:14] [config] lr-warmup-cycle: false
[2023-06-24 14:06:14] [config] lr-warmup-start-rate: 0
[2023-06-24 14:06:14] [config] max-length: 100
[2023-06-24 14:06:14] [config] max-length-crop: false
[2023-06-24 14:06:14] [config] max-length-factor: 3
[2023-06-24 14:06:14] [config] maxi-batch: 1000
[2023-06-24 14:06:14] [config] maxi-batch-sort: trg
[2023-06-24 14:06:14] [config] mini-batch: 1000
[2023-06-24 14:06:14] [config] mini-batch-fit: true
[2023-06-24 14:06:14] [config] mini-batch-fit-step: 10
[2023-06-24 14:06:14] [config] mini-batch-round-up: true
[2023-06-24 14:06:14] [config] mini-batch-track-lr: false
[2023-06-24 14:06:14] [config] mini-batch-warmup: 0
[2023-06-24 14:06:14] [config] mini-batch-words: 0
[2023-06-24 14:06:14] [config] mini-batch-words-ref: 0
[2023-06-24 14:06:14] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 14:06:14] [config] multi-loss-type: sum
[2023-06-24 14:06:14] [config] n-best: false
[2023-06-24 14:06:14] [config] no-nccl: false
[2023-06-24 14:06:14] [config] no-reload: false
[2023-06-24 14:06:14] [config] no-restore-corpus: false
[2023-06-24 14:06:14] [config] normalize: 1
[2023-06-24 14:06:14] [config] normalize-gradient: false
[2023-06-24 14:06:14] [config] num-devices: 0
[2023-06-24 14:06:14] [config] optimizer: adam
[2023-06-24 14:06:14] [config] optimizer-delay: 1
[2023-06-24 14:06:14] [config] optimizer-params:
[2023-06-24 14:06:14] [config]   - 0.9
[2023-06-24 14:06:14] [config]   - 0.98
[2023-06-24 14:06:14] [config]   - 1e-09
[2023-06-24 14:06:14] [config] output-omit-bias: false
[2023-06-24 14:06:14] [config] overwrite: false
[2023-06-24 14:06:14] [config] precision:
[2023-06-24 14:06:14] [config]   - float32
[2023-06-24 14:06:14] [config]   - float32
[2023-06-24 14:06:14] [config] pretrained-model: ""
[2023-06-24 14:06:14] [config] quantize-biases: false
[2023-06-24 14:06:14] [config] quantize-bits: 0
[2023-06-24 14:06:14] [config] quantize-log-based: false
[2023-06-24 14:06:14] [config] quantize-optimization-steps: 0
[2023-06-24 14:06:14] [config] quiet: false
[2023-06-24 14:06:14] [config] quiet-translation: true
[2023-06-24 14:06:14] [config] relative-paths: false
[2023-06-24 14:06:14] [config] right-left: false
[2023-06-24 14:06:14] [config] save-freq: 10000u
[2023-06-24 14:06:14] [config] seed: 1234
[2023-06-24 14:06:14] [config] sentencepiece-alphas:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] sentencepiece-max-lines: 2000000
[2023-06-24 14:06:14] [config] sentencepiece-options: ""
[2023-06-24 14:06:14] [config] sharding: global
[2023-06-24 14:06:14] [config] shuffle: data
[2023-06-24 14:06:14] [config] shuffle-in-ram: false
[2023-06-24 14:06:14] [config] sigterm: save-and-exit
[2023-06-24 14:06:14] [config] skip: false
[2023-06-24 14:06:14] [config] sqlite: ""
[2023-06-24 14:06:14] [config] sqlite-drop: false
[2023-06-24 14:06:14] [config] sync-freq: 200u
[2023-06-24 14:06:14] [config] sync-sgd: true
[2023-06-24 14:06:14] [config] tempdir: /tmp
[2023-06-24 14:06:14] [config] tied-embeddings: false
[2023-06-24 14:06:14] [config] tied-embeddings-all: false
[2023-06-24 14:06:14] [config] tied-embeddings-src: false
[2023-06-24 14:06:14] [config] train-embedder-rank:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] train-sets:
[2023-06-24 14:06:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 14:06:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 14:06:14] [config] transformer-aan-activation: swish
[2023-06-24 14:06:14] [config] transformer-aan-depth: 2
[2023-06-24 14:06:14] [config] transformer-aan-nogate: false
[2023-06-24 14:06:14] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 14:06:14] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 14:06:14] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 14:06:14] [config] transformer-depth-scaling: false
[2023-06-24 14:06:14] [config] transformer-dim-aan: 2048
[2023-06-24 14:06:14] [config] transformer-dim-ffn: 2048
[2023-06-24 14:06:14] [config] transformer-dropout: 0
[2023-06-24 14:06:14] [config] transformer-dropout-attention: 0
[2023-06-24 14:06:14] [config] transformer-dropout-ffn: 0
[2023-06-24 14:06:14] [config] transformer-ffn-activation: swish
[2023-06-24 14:06:14] [config] transformer-ffn-depth: 2
[2023-06-24 14:06:14] [config] transformer-guided-alignment-layer: last
[2023-06-24 14:06:14] [config] transformer-heads: 8
[2023-06-24 14:06:14] [config] transformer-no-projection: false
[2023-06-24 14:06:14] [config] transformer-pool: false
[2023-06-24 14:06:14] [config] transformer-postprocess: dan
[2023-06-24 14:06:14] [config] transformer-postprocess-emb: d
[2023-06-24 14:06:14] [config] transformer-postprocess-top: ""
[2023-06-24 14:06:14] [config] transformer-preprocess: ""
[2023-06-24 14:06:14] [config] transformer-tied-layers:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] transformer-train-position-embeddings: false
[2023-06-24 14:06:14] [config] tsv: false
[2023-06-24 14:06:14] [config] tsv-fields: 0
[2023-06-24 14:06:14] [config] type: s2s
[2023-06-24 14:06:14] [config] ulr: false
[2023-06-24 14:06:14] [config] ulr-dim-emb: 0
[2023-06-24 14:06:14] [config] ulr-dropout: 0
[2023-06-24 14:06:14] [config] ulr-keys-vectors: ""
[2023-06-24 14:06:14] [config] ulr-query-vectors: ""
[2023-06-24 14:06:14] [config] ulr-softmax-temperature: 1
[2023-06-24 14:06:14] [config] ulr-trainable-transformation: false
[2023-06-24 14:06:14] [config] unlikelihood-loss: false
[2023-06-24 14:06:14] [config] valid-freq: 5000000
[2023-06-24 14:06:14] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 14:06:14] [config] valid-max-length: 1000
[2023-06-24 14:06:14] [config] valid-metrics:
[2023-06-24 14:06:14] [config]   - cross-entropy
[2023-06-24 14:06:14] [config]   - translation
[2023-06-24 14:06:14] [config] valid-mini-batch: 32
[2023-06-24 14:06:14] [config] valid-reset-stalled: false
[2023-06-24 14:06:14] [config] valid-script-args:
[2023-06-24 14:06:14] [config]   []
[2023-06-24 14:06:14] [config] valid-script-path: ""
[2023-06-24 14:06:14] [config] valid-sets:
[2023-06-24 14:06:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 14:06:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 14:06:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 14:06:14] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 14:06:14] [config] vocabs:
[2023-06-24 14:06:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 14:06:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 14:06:14] [config] word-penalty: 0
[2023-06-24 14:06:14] [config] word-scores: false
[2023-06-24 14:06:14] [config] workspace: 2048
[2023-06-24 14:06:14] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 14:06:14] Using synchronous SGD
[2023-06-24 14:06:14] Synced seed 1234
[2023-06-24 14:06:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 14:06:14] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 14:06:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 14:06:14] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 14:06:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 14:06:14] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 14:06:15] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 14:06:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 14:06:15] [comm] Using global sharding
[2023-06-24 14:06:15] [comm] NCCLCommunicators constructed successfully
[2023-06-24 14:06:15] [training] Using 1 GPUs
[2023-06-24 14:06:15] [logits] Applying loss function for 1 factor(s)
[2023-06-24 14:06:15] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:06:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 14:06:16] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:06:38] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 14:06:38] [valid] No post-processing script given for validating translator
[2023-06-24 14:06:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 14:06:38] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 14:06:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 14:06:38] [comm] Using global sharding
[2023-06-24 14:06:38] [comm] NCCLCommunicators constructed successfully
[2023-06-24 14:06:38] [training] Using 1 GPUs
[2023-06-24 14:06:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 14:06:42] Allocating memory for general optimizer shards
[2023-06-24 14:06:42] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:06:42] Loading Adam parameters
[2023-06-24 14:06:43] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 14:06:43] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:06:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 14:06:43] [data] Restoring the corpus state to epoch 11, batch 3300
[2023-06-24 14:06:43] [data] Shuffling data
[2023-06-24 14:06:43] [data] Done reading 20,192 sentences
[2023-06-24 14:06:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:06:43] Training started
[2023-06-24 14:06:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 14:06:43] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:06:44] Parameter type float32, optimization type float32, casting types false
[2023-06-24 14:08:52] Seen 20,177 samples
[2023-06-24 14:08:52] Starting data epoch 12 in logical epoch 12
[2023-06-24 14:08:52] [data] Shuffling data
[2023-06-24 14:08:52] [data] Done reading 20,192 sentences
[2023-06-24 14:08:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:11:04] Seen 20,177 samples
[2023-06-24 14:11:04] Starting data epoch 13 in logical epoch 13
[2023-06-24 14:11:04] [data] Shuffling data
[2023-06-24 14:11:04] [data] Done reading 20,192 sentences
[2023-06-24 14:11:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:11:20] Ep. 13 : Up. 4000 : Sen. 2,579 : Cost 3.61578608 : Time 282.02s : 5118.77 words/s : gNorm 1.0585
[2023-06-24 14:13:15] Seen 20,177 samples
[2023-06-24 14:13:15] Starting data epoch 14 in logical epoch 14
[2023-06-24 14:13:15] [data] Shuffling data
[2023-06-24 14:13:15] [data] Done reading 20,192 sentences
[2023-06-24 14:13:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:15:26] Seen 20,177 samples
[2023-06-24 14:15:26] Starting data epoch 15 in logical epoch 15
[2023-06-24 14:15:26] [data] Shuffling data
[2023-06-24 14:15:26] [data] Done reading 20,192 sentences
[2023-06-24 14:15:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:17:37] Seen 20,177 samples
[2023-06-24 14:17:37] Starting data epoch 16 in logical epoch 16
[2023-06-24 14:17:37] [data] Shuffling data
[2023-06-24 14:17:37] [data] Done reading 20,192 sentences
[2023-06-24 14:17:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:17:57] Ep. 16 : Up. 5000 : Sen. 3,472 : Cost 2.90387201 : Time 397.28s : 3650.35 words/s : gNorm 1.0512
[2023-06-24 14:19:49] Seen 20,177 samples
[2023-06-24 14:19:49] Starting data epoch 17 in logical epoch 17
[2023-06-24 14:19:49] [data] Shuffling data
[2023-06-24 14:19:49] [data] Done reading 20,192 sentences
[2023-06-24 14:19:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:22:01] Seen 20,177 samples
[2023-06-24 14:22:01] Starting data epoch 18 in logical epoch 18
[2023-06-24 14:22:01] [data] Shuffling data
[2023-06-24 14:22:01] [data] Done reading 20,192 sentences
[2023-06-24 14:22:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:24:12] Seen 20,177 samples
[2023-06-24 14:24:12] Starting data epoch 19 in logical epoch 19
[2023-06-24 14:24:12] [data] Shuffling data
[2023-06-24 14:24:12] [data] Done reading 20,192 sentences
[2023-06-24 14:24:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:24:35] Ep. 19 : Up. 6000 : Sen. 3,518 : Cost 2.38029766 : Time 398.14s : 3634.17 words/s : gNorm 0.9440
[2023-06-24 14:26:22] Seen 20,177 samples
[2023-06-24 14:26:22] Starting data epoch 20 in logical epoch 20
[2023-06-24 14:26:22] [data] Shuffling data
[2023-06-24 14:26:22] [data] Done reading 20,192 sentences
[2023-06-24 14:26:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:28:34] Seen 20,177 samples
[2023-06-24 14:28:34] Starting data epoch 21 in logical epoch 21
[2023-06-24 14:28:34] Training finished
[2023-06-24 14:28:46] [valid] Ep. 21 : Up. 6600 : cross-entropy : 98.5722 : stalled 1 times (last best: 94.2576)
[2023-06-24 14:32:13] [valid] Ep. 21 : Up. 6600 : translation : 0 : new best
[2023-06-24 14:32:13] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 14:32:19] Saving Adam parameters
[2023-06-24 14:32:21] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 14:40:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 14:40:02] [marian] Running on node07.datos.cluster.uy as process 12898 with command line:
[2023-06-24 14:40:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 14:40:02] [config] after: 0e
[2023-06-24 14:40:02] [config] after-batches: 0
[2023-06-24 14:40:02] [config] after-epochs: 30
[2023-06-24 14:40:02] [config] all-caps-every: 0
[2023-06-24 14:40:02] [config] allow-unk: false
[2023-06-24 14:40:02] [config] authors: false
[2023-06-24 14:40:02] [config] beam-size: 12
[2023-06-24 14:40:02] [config] bert-class-symbol: "[CLS]"
[2023-06-24 14:40:02] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 14:40:02] [config] bert-masking-fraction: 0.15
[2023-06-24 14:40:02] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 14:40:02] [config] bert-train-type-embeddings: true
[2023-06-24 14:40:02] [config] bert-type-vocab-size: 2
[2023-06-24 14:40:02] [config] build-info: ""
[2023-06-24 14:40:02] [config] check-gradient-nan: false
[2023-06-24 14:40:02] [config] check-nan: false
[2023-06-24 14:40:02] [config] cite: false
[2023-06-24 14:40:02] [config] clip-norm: 5
[2023-06-24 14:40:02] [config] cost-scaling:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] cost-type: ce-mean-words
[2023-06-24 14:40:02] [config] cpu-threads: 0
[2023-06-24 14:40:02] [config] data-threads: 8
[2023-06-24 14:40:02] [config] data-weighting: ""
[2023-06-24 14:40:02] [config] data-weighting-type: sentence
[2023-06-24 14:40:02] [config] dec-cell: gru
[2023-06-24 14:40:02] [config] dec-cell-base-depth: 8
[2023-06-24 14:40:02] [config] dec-cell-high-depth: 1
[2023-06-24 14:40:02] [config] dec-depth: 1
[2023-06-24 14:40:02] [config] devices:
[2023-06-24 14:40:02] [config]   - 0
[2023-06-24 14:40:02] [config] dim-emb: 512
[2023-06-24 14:40:02] [config] dim-rnn: 1024
[2023-06-24 14:40:02] [config] dim-vocabs:
[2023-06-24 14:40:02] [config]   - 54042
[2023-06-24 14:40:02] [config]   - 36507
[2023-06-24 14:40:02] [config] disp-first: 0
[2023-06-24 14:40:02] [config] disp-freq: 1000u
[2023-06-24 14:40:02] [config] disp-label-counts: true
[2023-06-24 14:40:02] [config] dropout-rnn: 0.1
[2023-06-24 14:40:02] [config] dropout-src: 0
[2023-06-24 14:40:02] [config] dropout-trg: 0
[2023-06-24 14:40:02] [config] dump-config: ""
[2023-06-24 14:40:02] [config] dynamic-gradient-scaling:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] early-stopping: 10
[2023-06-24 14:40:02] [config] early-stopping-on: first
[2023-06-24 14:40:02] [config] embedding-fix-src: false
[2023-06-24 14:40:02] [config] embedding-fix-trg: false
[2023-06-24 14:40:02] [config] embedding-normalization: false
[2023-06-24 14:40:02] [config] embedding-vectors:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] enc-cell: gru
[2023-06-24 14:40:02] [config] enc-cell-depth: 4
[2023-06-24 14:40:02] [config] enc-depth: 1
[2023-06-24 14:40:02] [config] enc-type: bidirectional
[2023-06-24 14:40:02] [config] english-title-case-every: 0
[2023-06-24 14:40:02] [config] exponential-smoothing: 0.0001
[2023-06-24 14:40:02] [config] factor-weight: 1
[2023-06-24 14:40:02] [config] factors-combine: sum
[2023-06-24 14:40:02] [config] factors-dim-emb: 0
[2023-06-24 14:40:02] [config] gradient-checkpointing: false
[2023-06-24 14:40:02] [config] gradient-norm-average-window: 100
[2023-06-24 14:40:02] [config] guided-alignment: none
[2023-06-24 14:40:02] [config] guided-alignment-cost: mse
[2023-06-24 14:40:02] [config] guided-alignment-weight: 0.1
[2023-06-24 14:40:02] [config] ignore-model-config: false
[2023-06-24 14:40:02] [config] input-types:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] interpolate-env-vars: false
[2023-06-24 14:40:02] [config] keep-best: false
[2023-06-24 14:40:02] [config] label-smoothing: 0.1
[2023-06-24 14:40:02] [config] layer-normalization: true
[2023-06-24 14:40:02] [config] learn-rate: 0.0003
[2023-06-24 14:40:02] [config] lemma-dependency: ""
[2023-06-24 14:40:02] [config] lemma-dim-emb: 0
[2023-06-24 14:40:02] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 14:40:02] [config] log-level: info
[2023-06-24 14:40:02] [config] log-time-zone: ""
[2023-06-24 14:40:02] [config] logical-epoch:
[2023-06-24 14:40:02] [config]   - 1e
[2023-06-24 14:40:02] [config]   - 0
[2023-06-24 14:40:02] [config] lr-decay: 0
[2023-06-24 14:40:02] [config] lr-decay-freq: 50000
[2023-06-24 14:40:02] [config] lr-decay-inv-sqrt:
[2023-06-24 14:40:02] [config]   - 16000
[2023-06-24 14:40:02] [config] lr-decay-repeat-warmup: false
[2023-06-24 14:40:02] [config] lr-decay-reset-optimizer: false
[2023-06-24 14:40:02] [config] lr-decay-start:
[2023-06-24 14:40:02] [config]   - 10
[2023-06-24 14:40:02] [config]   - 1
[2023-06-24 14:40:02] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 14:40:02] [config] lr-report: false
[2023-06-24 14:40:02] [config] lr-warmup: 0
[2023-06-24 14:40:02] [config] lr-warmup-at-reload: false
[2023-06-24 14:40:02] [config] lr-warmup-cycle: false
[2023-06-24 14:40:02] [config] lr-warmup-start-rate: 0
[2023-06-24 14:40:02] [config] max-length: 100
[2023-06-24 14:40:02] [config] max-length-crop: false
[2023-06-24 14:40:02] [config] max-length-factor: 3
[2023-06-24 14:40:02] [config] maxi-batch: 1000
[2023-06-24 14:40:02] [config] maxi-batch-sort: trg
[2023-06-24 14:40:02] [config] mini-batch: 1000
[2023-06-24 14:40:02] [config] mini-batch-fit: true
[2023-06-24 14:40:02] [config] mini-batch-fit-step: 10
[2023-06-24 14:40:02] [config] mini-batch-round-up: true
[2023-06-24 14:40:02] [config] mini-batch-track-lr: false
[2023-06-24 14:40:02] [config] mini-batch-warmup: 0
[2023-06-24 14:40:02] [config] mini-batch-words: 0
[2023-06-24 14:40:02] [config] mini-batch-words-ref: 0
[2023-06-24 14:40:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 14:40:02] [config] multi-loss-type: sum
[2023-06-24 14:40:02] [config] n-best: false
[2023-06-24 14:40:02] [config] no-nccl: false
[2023-06-24 14:40:02] [config] no-reload: false
[2023-06-24 14:40:02] [config] no-restore-corpus: false
[2023-06-24 14:40:02] [config] normalize: 1
[2023-06-24 14:40:02] [config] normalize-gradient: false
[2023-06-24 14:40:02] [config] num-devices: 0
[2023-06-24 14:40:02] [config] optimizer: adam
[2023-06-24 14:40:02] [config] optimizer-delay: 1
[2023-06-24 14:40:02] [config] optimizer-params:
[2023-06-24 14:40:02] [config]   - 0.9
[2023-06-24 14:40:02] [config]   - 0.98
[2023-06-24 14:40:02] [config]   - 1e-09
[2023-06-24 14:40:02] [config] output-omit-bias: false
[2023-06-24 14:40:02] [config] overwrite: false
[2023-06-24 14:40:02] [config] precision:
[2023-06-24 14:40:02] [config]   - float32
[2023-06-24 14:40:02] [config]   - float32
[2023-06-24 14:40:02] [config] pretrained-model: ""
[2023-06-24 14:40:02] [config] quantize-biases: false
[2023-06-24 14:40:02] [config] quantize-bits: 0
[2023-06-24 14:40:02] [config] quantize-log-based: false
[2023-06-24 14:40:02] [config] quantize-optimization-steps: 0
[2023-06-24 14:40:02] [config] quiet: false
[2023-06-24 14:40:02] [config] quiet-translation: true
[2023-06-24 14:40:02] [config] relative-paths: false
[2023-06-24 14:40:02] [config] right-left: false
[2023-06-24 14:40:02] [config] save-freq: 10000u
[2023-06-24 14:40:02] [config] seed: 1234
[2023-06-24 14:40:02] [config] sentencepiece-alphas:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] sentencepiece-max-lines: 2000000
[2023-06-24 14:40:02] [config] sentencepiece-options: ""
[2023-06-24 14:40:02] [config] sharding: global
[2023-06-24 14:40:02] [config] shuffle: data
[2023-06-24 14:40:02] [config] shuffle-in-ram: false
[2023-06-24 14:40:02] [config] sigterm: save-and-exit
[2023-06-24 14:40:02] [config] skip: false
[2023-06-24 14:40:02] [config] sqlite: ""
[2023-06-24 14:40:02] [config] sqlite-drop: false
[2023-06-24 14:40:02] [config] sync-freq: 200u
[2023-06-24 14:40:02] [config] sync-sgd: true
[2023-06-24 14:40:02] [config] tempdir: /tmp
[2023-06-24 14:40:02] [config] tied-embeddings: false
[2023-06-24 14:40:02] [config] tied-embeddings-all: false
[2023-06-24 14:40:02] [config] tied-embeddings-src: false
[2023-06-24 14:40:02] [config] train-embedder-rank:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] train-sets:
[2023-06-24 14:40:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 14:40:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 14:40:02] [config] transformer-aan-activation: swish
[2023-06-24 14:40:02] [config] transformer-aan-depth: 2
[2023-06-24 14:40:02] [config] transformer-aan-nogate: false
[2023-06-24 14:40:02] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 14:40:02] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 14:40:02] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 14:40:02] [config] transformer-depth-scaling: false
[2023-06-24 14:40:02] [config] transformer-dim-aan: 2048
[2023-06-24 14:40:02] [config] transformer-dim-ffn: 2048
[2023-06-24 14:40:02] [config] transformer-dropout: 0
[2023-06-24 14:40:02] [config] transformer-dropout-attention: 0
[2023-06-24 14:40:02] [config] transformer-dropout-ffn: 0
[2023-06-24 14:40:02] [config] transformer-ffn-activation: swish
[2023-06-24 14:40:02] [config] transformer-ffn-depth: 2
[2023-06-24 14:40:02] [config] transformer-guided-alignment-layer: last
[2023-06-24 14:40:02] [config] transformer-heads: 8
[2023-06-24 14:40:02] [config] transformer-no-projection: false
[2023-06-24 14:40:02] [config] transformer-pool: false
[2023-06-24 14:40:02] [config] transformer-postprocess: dan
[2023-06-24 14:40:02] [config] transformer-postprocess-emb: d
[2023-06-24 14:40:02] [config] transformer-postprocess-top: ""
[2023-06-24 14:40:02] [config] transformer-preprocess: ""
[2023-06-24 14:40:02] [config] transformer-tied-layers:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] transformer-train-position-embeddings: false
[2023-06-24 14:40:02] [config] tsv: false
[2023-06-24 14:40:02] [config] tsv-fields: 0
[2023-06-24 14:40:02] [config] type: s2s
[2023-06-24 14:40:02] [config] ulr: false
[2023-06-24 14:40:02] [config] ulr-dim-emb: 0
[2023-06-24 14:40:02] [config] ulr-dropout: 0
[2023-06-24 14:40:02] [config] ulr-keys-vectors: ""
[2023-06-24 14:40:02] [config] ulr-query-vectors: ""
[2023-06-24 14:40:02] [config] ulr-softmax-temperature: 1
[2023-06-24 14:40:02] [config] ulr-trainable-transformation: false
[2023-06-24 14:40:02] [config] unlikelihood-loss: false
[2023-06-24 14:40:02] [config] valid-freq: 5000000
[2023-06-24 14:40:02] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 14:40:02] [config] valid-max-length: 1000
[2023-06-24 14:40:02] [config] valid-metrics:
[2023-06-24 14:40:02] [config]   - cross-entropy
[2023-06-24 14:40:02] [config]   - translation
[2023-06-24 14:40:02] [config] valid-mini-batch: 32
[2023-06-24 14:40:02] [config] valid-reset-stalled: false
[2023-06-24 14:40:02] [config] valid-script-args:
[2023-06-24 14:40:02] [config]   []
[2023-06-24 14:40:02] [config] valid-script-path: ""
[2023-06-24 14:40:02] [config] valid-sets:
[2023-06-24 14:40:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 14:40:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 14:40:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 14:40:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 14:40:02] [config] vocabs:
[2023-06-24 14:40:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 14:40:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 14:40:02] [config] word-penalty: 0
[2023-06-24 14:40:02] [config] word-scores: false
[2023-06-24 14:40:02] [config] workspace: 2048
[2023-06-24 14:40:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 14:40:02] Using synchronous SGD
[2023-06-24 14:40:02] Synced seed 1234
[2023-06-24 14:40:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 14:40:03] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 14:40:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 14:40:03] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 14:40:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 14:40:03] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 14:40:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 14:40:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 14:40:03] [comm] Using global sharding
[2023-06-24 14:40:03] [comm] NCCLCommunicators constructed successfully
[2023-06-24 14:40:03] [training] Using 1 GPUs
[2023-06-24 14:40:03] [logits] Applying loss function for 1 factor(s)
[2023-06-24 14:40:03] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:40:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 14:40:04] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:40:26] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 14:40:26] [valid] No post-processing script given for validating translator
[2023-06-24 14:40:26] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 14:40:26] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 14:40:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 14:40:26] [comm] Using global sharding
[2023-06-24 14:40:26] [comm] NCCLCommunicators constructed successfully
[2023-06-24 14:40:26] [training] Using 1 GPUs
[2023-06-24 14:40:26] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 14:40:30] Allocating memory for general optimizer shards
[2023-06-24 14:40:30] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:40:30] Loading Adam parameters
[2023-06-24 14:40:31] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 14:40:31] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:40:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 14:40:31] [data] Restoring the corpus state to epoch 21, batch 6600
[2023-06-24 14:40:31] [data] Shuffling data
[2023-06-24 14:40:31] [data] Done reading 20,192 sentences
[2023-06-24 14:40:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:40:31] Training started
[2023-06-24 14:40:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 14:40:32] [memory] Reserving 521 MB, device gpu0
[2023-06-24 14:40:32] Parameter type float32, optimization type float32, casting types false
[2023-06-24 14:42:41] Seen 20,177 samples
[2023-06-24 14:42:41] Starting data epoch 22 in logical epoch 22
[2023-06-24 14:42:41] [data] Shuffling data
[2023-06-24 14:42:41] [data] Done reading 20,192 sentences
[2023-06-24 14:42:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:43:06] Ep. 22 : Up. 7000 : Sen. 4,980 : Cost 2.03481770 : Time 160.65s : 8997.67 words/s : gNorm 0.7831
[2023-06-24 14:44:52] Seen 20,177 samples
[2023-06-24 14:44:52] Starting data epoch 23 in logical epoch 23
[2023-06-24 14:44:52] [data] Shuffling data
[2023-06-24 14:44:52] [data] Done reading 20,192 sentences
[2023-06-24 14:44:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:47:04] Seen 20,177 samples
[2023-06-24 14:47:04] Starting data epoch 24 in logical epoch 24
[2023-06-24 14:47:04] [data] Shuffling data
[2023-06-24 14:47:04] [data] Done reading 20,192 sentences
[2023-06-24 14:47:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:49:15] Seen 20,177 samples
[2023-06-24 14:49:15] Starting data epoch 25 in logical epoch 25
[2023-06-24 14:49:15] [data] Shuffling data
[2023-06-24 14:49:15] [data] Done reading 20,192 sentences
[2023-06-24 14:49:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:49:48] Ep. 25 : Up. 8000 : Sen. 4,627 : Cost 1.83162463 : Time 401.75s : 3615.77 words/s : gNorm 0.6783
[2023-06-24 14:51:25] Seen 20,177 samples
[2023-06-24 14:51:25] Starting data epoch 26 in logical epoch 26
[2023-06-24 14:51:25] [data] Shuffling data
[2023-06-24 14:51:25] [data] Done reading 20,192 sentences
[2023-06-24 14:51:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:53:35] Seen 20,177 samples
[2023-06-24 14:53:35] Starting data epoch 27 in logical epoch 27
[2023-06-24 14:53:35] [data] Shuffling data
[2023-06-24 14:53:35] [data] Done reading 20,192 sentences
[2023-06-24 14:53:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:55:47] Seen 20,177 samples
[2023-06-24 14:55:47] Starting data epoch 28 in logical epoch 28
[2023-06-24 14:55:47] [data] Shuffling data
[2023-06-24 14:55:47] [data] Done reading 20,192 sentences
[2023-06-24 14:55:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 14:56:24] Ep. 28 : Up. 9000 : Sen. 5,057 : Cost 1.71654069 : Time 395.90s : 3656.79 words/s : gNorm 0.5845
[2023-06-24 14:57:58] Seen 20,177 samples
[2023-06-24 14:57:58] Starting data epoch 29 in logical epoch 29
[2023-06-24 14:57:58] [data] Shuffling data
[2023-06-24 14:57:58] [data] Done reading 20,192 sentences
[2023-06-24 14:57:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:00:09] Seen 20,177 samples
[2023-06-24 15:00:09] Starting data epoch 30 in logical epoch 30
[2023-06-24 15:00:09] [data] Shuffling data
[2023-06-24 15:00:09] [data] Done reading 20,192 sentences
[2023-06-24 15:00:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:02:20] Seen 20,177 samples
[2023-06-24 15:02:20] Starting data epoch 31 in logical epoch 31
[2023-06-24 15:02:20] Training finished
[2023-06-24 15:02:32] [valid] Ep. 31 : Up. 9900 : cross-entropy : 103.94 : stalled 2 times (last best: 94.2576)
[2023-06-24 15:05:59] [valid] Ep. 31 : Up. 9900 : translation : 0 : new best
[2023-06-24 15:05:59] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 15:06:04] Saving Adam parameters
[2023-06-24 15:06:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 15:13:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 15:13:45] [marian] Running on node07.datos.cluster.uy as process 15289 with command line:
[2023-06-24 15:13:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 15:13:45] [config] after: 0e
[2023-06-24 15:13:45] [config] after-batches: 0
[2023-06-24 15:13:45] [config] after-epochs: 40
[2023-06-24 15:13:45] [config] all-caps-every: 0
[2023-06-24 15:13:45] [config] allow-unk: false
[2023-06-24 15:13:45] [config] authors: false
[2023-06-24 15:13:45] [config] beam-size: 12
[2023-06-24 15:13:45] [config] bert-class-symbol: "[CLS]"
[2023-06-24 15:13:45] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 15:13:45] [config] bert-masking-fraction: 0.15
[2023-06-24 15:13:45] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 15:13:45] [config] bert-train-type-embeddings: true
[2023-06-24 15:13:45] [config] bert-type-vocab-size: 2
[2023-06-24 15:13:45] [config] build-info: ""
[2023-06-24 15:13:45] [config] check-gradient-nan: false
[2023-06-24 15:13:45] [config] check-nan: false
[2023-06-24 15:13:45] [config] cite: false
[2023-06-24 15:13:45] [config] clip-norm: 5
[2023-06-24 15:13:45] [config] cost-scaling:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] cost-type: ce-mean-words
[2023-06-24 15:13:45] [config] cpu-threads: 0
[2023-06-24 15:13:45] [config] data-threads: 8
[2023-06-24 15:13:45] [config] data-weighting: ""
[2023-06-24 15:13:45] [config] data-weighting-type: sentence
[2023-06-24 15:13:45] [config] dec-cell: gru
[2023-06-24 15:13:45] [config] dec-cell-base-depth: 8
[2023-06-24 15:13:45] [config] dec-cell-high-depth: 1
[2023-06-24 15:13:45] [config] dec-depth: 1
[2023-06-24 15:13:45] [config] devices:
[2023-06-24 15:13:45] [config]   - 0
[2023-06-24 15:13:45] [config] dim-emb: 512
[2023-06-24 15:13:45] [config] dim-rnn: 1024
[2023-06-24 15:13:45] [config] dim-vocabs:
[2023-06-24 15:13:45] [config]   - 54042
[2023-06-24 15:13:45] [config]   - 36507
[2023-06-24 15:13:45] [config] disp-first: 0
[2023-06-24 15:13:45] [config] disp-freq: 1000u
[2023-06-24 15:13:45] [config] disp-label-counts: true
[2023-06-24 15:13:45] [config] dropout-rnn: 0.1
[2023-06-24 15:13:45] [config] dropout-src: 0
[2023-06-24 15:13:45] [config] dropout-trg: 0
[2023-06-24 15:13:45] [config] dump-config: ""
[2023-06-24 15:13:45] [config] dynamic-gradient-scaling:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] early-stopping: 10
[2023-06-24 15:13:45] [config] early-stopping-on: first
[2023-06-24 15:13:45] [config] embedding-fix-src: false
[2023-06-24 15:13:45] [config] embedding-fix-trg: false
[2023-06-24 15:13:45] [config] embedding-normalization: false
[2023-06-24 15:13:45] [config] embedding-vectors:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] enc-cell: gru
[2023-06-24 15:13:45] [config] enc-cell-depth: 4
[2023-06-24 15:13:45] [config] enc-depth: 1
[2023-06-24 15:13:45] [config] enc-type: bidirectional
[2023-06-24 15:13:45] [config] english-title-case-every: 0
[2023-06-24 15:13:45] [config] exponential-smoothing: 0.0001
[2023-06-24 15:13:45] [config] factor-weight: 1
[2023-06-24 15:13:45] [config] factors-combine: sum
[2023-06-24 15:13:45] [config] factors-dim-emb: 0
[2023-06-24 15:13:45] [config] gradient-checkpointing: false
[2023-06-24 15:13:45] [config] gradient-norm-average-window: 100
[2023-06-24 15:13:45] [config] guided-alignment: none
[2023-06-24 15:13:45] [config] guided-alignment-cost: mse
[2023-06-24 15:13:45] [config] guided-alignment-weight: 0.1
[2023-06-24 15:13:45] [config] ignore-model-config: false
[2023-06-24 15:13:45] [config] input-types:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] interpolate-env-vars: false
[2023-06-24 15:13:45] [config] keep-best: false
[2023-06-24 15:13:45] [config] label-smoothing: 0.1
[2023-06-24 15:13:45] [config] layer-normalization: true
[2023-06-24 15:13:45] [config] learn-rate: 0.0003
[2023-06-24 15:13:45] [config] lemma-dependency: ""
[2023-06-24 15:13:45] [config] lemma-dim-emb: 0
[2023-06-24 15:13:45] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 15:13:45] [config] log-level: info
[2023-06-24 15:13:45] [config] log-time-zone: ""
[2023-06-24 15:13:45] [config] logical-epoch:
[2023-06-24 15:13:45] [config]   - 1e
[2023-06-24 15:13:45] [config]   - 0
[2023-06-24 15:13:45] [config] lr-decay: 0
[2023-06-24 15:13:45] [config] lr-decay-freq: 50000
[2023-06-24 15:13:45] [config] lr-decay-inv-sqrt:
[2023-06-24 15:13:45] [config]   - 16000
[2023-06-24 15:13:45] [config] lr-decay-repeat-warmup: false
[2023-06-24 15:13:45] [config] lr-decay-reset-optimizer: false
[2023-06-24 15:13:45] [config] lr-decay-start:
[2023-06-24 15:13:45] [config]   - 10
[2023-06-24 15:13:45] [config]   - 1
[2023-06-24 15:13:45] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 15:13:45] [config] lr-report: false
[2023-06-24 15:13:45] [config] lr-warmup: 0
[2023-06-24 15:13:45] [config] lr-warmup-at-reload: false
[2023-06-24 15:13:45] [config] lr-warmup-cycle: false
[2023-06-24 15:13:45] [config] lr-warmup-start-rate: 0
[2023-06-24 15:13:45] [config] max-length: 100
[2023-06-24 15:13:45] [config] max-length-crop: false
[2023-06-24 15:13:45] [config] max-length-factor: 3
[2023-06-24 15:13:45] [config] maxi-batch: 1000
[2023-06-24 15:13:45] [config] maxi-batch-sort: trg
[2023-06-24 15:13:45] [config] mini-batch: 1000
[2023-06-24 15:13:45] [config] mini-batch-fit: true
[2023-06-24 15:13:45] [config] mini-batch-fit-step: 10
[2023-06-24 15:13:45] [config] mini-batch-round-up: true
[2023-06-24 15:13:45] [config] mini-batch-track-lr: false
[2023-06-24 15:13:45] [config] mini-batch-warmup: 0
[2023-06-24 15:13:45] [config] mini-batch-words: 0
[2023-06-24 15:13:45] [config] mini-batch-words-ref: 0
[2023-06-24 15:13:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 15:13:45] [config] multi-loss-type: sum
[2023-06-24 15:13:45] [config] n-best: false
[2023-06-24 15:13:45] [config] no-nccl: false
[2023-06-24 15:13:45] [config] no-reload: false
[2023-06-24 15:13:45] [config] no-restore-corpus: false
[2023-06-24 15:13:45] [config] normalize: 1
[2023-06-24 15:13:45] [config] normalize-gradient: false
[2023-06-24 15:13:45] [config] num-devices: 0
[2023-06-24 15:13:45] [config] optimizer: adam
[2023-06-24 15:13:45] [config] optimizer-delay: 1
[2023-06-24 15:13:45] [config] optimizer-params:
[2023-06-24 15:13:45] [config]   - 0.9
[2023-06-24 15:13:45] [config]   - 0.98
[2023-06-24 15:13:45] [config]   - 1e-09
[2023-06-24 15:13:45] [config] output-omit-bias: false
[2023-06-24 15:13:45] [config] overwrite: false
[2023-06-24 15:13:45] [config] precision:
[2023-06-24 15:13:45] [config]   - float32
[2023-06-24 15:13:45] [config]   - float32
[2023-06-24 15:13:45] [config] pretrained-model: ""
[2023-06-24 15:13:45] [config] quantize-biases: false
[2023-06-24 15:13:45] [config] quantize-bits: 0
[2023-06-24 15:13:45] [config] quantize-log-based: false
[2023-06-24 15:13:45] [config] quantize-optimization-steps: 0
[2023-06-24 15:13:45] [config] quiet: false
[2023-06-24 15:13:45] [config] quiet-translation: true
[2023-06-24 15:13:45] [config] relative-paths: false
[2023-06-24 15:13:45] [config] right-left: false
[2023-06-24 15:13:45] [config] save-freq: 10000u
[2023-06-24 15:13:45] [config] seed: 1234
[2023-06-24 15:13:45] [config] sentencepiece-alphas:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] sentencepiece-max-lines: 2000000
[2023-06-24 15:13:45] [config] sentencepiece-options: ""
[2023-06-24 15:13:45] [config] sharding: global
[2023-06-24 15:13:45] [config] shuffle: data
[2023-06-24 15:13:45] [config] shuffle-in-ram: false
[2023-06-24 15:13:45] [config] sigterm: save-and-exit
[2023-06-24 15:13:45] [config] skip: false
[2023-06-24 15:13:45] [config] sqlite: ""
[2023-06-24 15:13:45] [config] sqlite-drop: false
[2023-06-24 15:13:45] [config] sync-freq: 200u
[2023-06-24 15:13:45] [config] sync-sgd: true
[2023-06-24 15:13:45] [config] tempdir: /tmp
[2023-06-24 15:13:45] [config] tied-embeddings: false
[2023-06-24 15:13:45] [config] tied-embeddings-all: false
[2023-06-24 15:13:45] [config] tied-embeddings-src: false
[2023-06-24 15:13:45] [config] train-embedder-rank:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] train-sets:
[2023-06-24 15:13:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 15:13:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 15:13:45] [config] transformer-aan-activation: swish
[2023-06-24 15:13:45] [config] transformer-aan-depth: 2
[2023-06-24 15:13:45] [config] transformer-aan-nogate: false
[2023-06-24 15:13:45] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 15:13:45] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 15:13:45] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 15:13:45] [config] transformer-depth-scaling: false
[2023-06-24 15:13:45] [config] transformer-dim-aan: 2048
[2023-06-24 15:13:45] [config] transformer-dim-ffn: 2048
[2023-06-24 15:13:45] [config] transformer-dropout: 0
[2023-06-24 15:13:45] [config] transformer-dropout-attention: 0
[2023-06-24 15:13:45] [config] transformer-dropout-ffn: 0
[2023-06-24 15:13:45] [config] transformer-ffn-activation: swish
[2023-06-24 15:13:45] [config] transformer-ffn-depth: 2
[2023-06-24 15:13:45] [config] transformer-guided-alignment-layer: last
[2023-06-24 15:13:45] [config] transformer-heads: 8
[2023-06-24 15:13:45] [config] transformer-no-projection: false
[2023-06-24 15:13:45] [config] transformer-pool: false
[2023-06-24 15:13:45] [config] transformer-postprocess: dan
[2023-06-24 15:13:45] [config] transformer-postprocess-emb: d
[2023-06-24 15:13:45] [config] transformer-postprocess-top: ""
[2023-06-24 15:13:45] [config] transformer-preprocess: ""
[2023-06-24 15:13:45] [config] transformer-tied-layers:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] transformer-train-position-embeddings: false
[2023-06-24 15:13:45] [config] tsv: false
[2023-06-24 15:13:45] [config] tsv-fields: 0
[2023-06-24 15:13:45] [config] type: s2s
[2023-06-24 15:13:45] [config] ulr: false
[2023-06-24 15:13:45] [config] ulr-dim-emb: 0
[2023-06-24 15:13:45] [config] ulr-dropout: 0
[2023-06-24 15:13:45] [config] ulr-keys-vectors: ""
[2023-06-24 15:13:45] [config] ulr-query-vectors: ""
[2023-06-24 15:13:45] [config] ulr-softmax-temperature: 1
[2023-06-24 15:13:45] [config] ulr-trainable-transformation: false
[2023-06-24 15:13:45] [config] unlikelihood-loss: false
[2023-06-24 15:13:45] [config] valid-freq: 5000000
[2023-06-24 15:13:45] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 15:13:45] [config] valid-max-length: 1000
[2023-06-24 15:13:45] [config] valid-metrics:
[2023-06-24 15:13:45] [config]   - cross-entropy
[2023-06-24 15:13:45] [config]   - translation
[2023-06-24 15:13:45] [config] valid-mini-batch: 32
[2023-06-24 15:13:45] [config] valid-reset-stalled: false
[2023-06-24 15:13:45] [config] valid-script-args:
[2023-06-24 15:13:45] [config]   []
[2023-06-24 15:13:45] [config] valid-script-path: ""
[2023-06-24 15:13:45] [config] valid-sets:
[2023-06-24 15:13:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 15:13:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 15:13:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 15:13:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 15:13:45] [config] vocabs:
[2023-06-24 15:13:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 15:13:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 15:13:45] [config] word-penalty: 0
[2023-06-24 15:13:45] [config] word-scores: false
[2023-06-24 15:13:45] [config] workspace: 2048
[2023-06-24 15:13:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 15:13:45] Using synchronous SGD
[2023-06-24 15:13:46] Synced seed 1234
[2023-06-24 15:13:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 15:13:46] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 15:13:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 15:13:46] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 15:13:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 15:13:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 15:13:46] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 15:13:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 15:13:47] [comm] Using global sharding
[2023-06-24 15:13:47] [comm] NCCLCommunicators constructed successfully
[2023-06-24 15:13:47] [training] Using 1 GPUs
[2023-06-24 15:13:47] [logits] Applying loss function for 1 factor(s)
[2023-06-24 15:13:47] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:13:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 15:13:48] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:14:09] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 15:14:09] [valid] No post-processing script given for validating translator
[2023-06-24 15:14:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 15:14:09] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 15:14:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 15:14:10] [comm] Using global sharding
[2023-06-24 15:14:10] [comm] NCCLCommunicators constructed successfully
[2023-06-24 15:14:10] [training] Using 1 GPUs
[2023-06-24 15:14:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 15:14:14] Allocating memory for general optimizer shards
[2023-06-24 15:14:14] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:14:14] Loading Adam parameters
[2023-06-24 15:14:15] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 15:14:15] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:14:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 15:14:15] [data] Restoring the corpus state to epoch 31, batch 9900
[2023-06-24 15:14:15] [data] Shuffling data
[2023-06-24 15:14:15] [data] Done reading 20,192 sentences
[2023-06-24 15:14:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:14:15] Training started
[2023-06-24 15:14:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 15:14:15] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:14:16] Parameter type float32, optimization type float32, casting types false
[2023-06-24 15:14:52] Ep. 31 : Up. 10000 : Sen. 6,670 : Cost 1.65050006 : Time 43.05s : 33544.77 words/s : gNorm 0.4991
[2023-06-24 15:14:52] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.iter10000.npz
[2023-06-24 15:14:57] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 15:15:02] Saving Adam parameters
[2023-06-24 15:15:04] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 15:16:49] Seen 20,177 samples
[2023-06-24 15:16:49] Starting data epoch 32 in logical epoch 32
[2023-06-24 15:16:49] [data] Shuffling data
[2023-06-24 15:16:49] [data] Done reading 20,192 sentences
[2023-06-24 15:16:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:19:00] Seen 20,177 samples
[2023-06-24 15:19:00] Starting data epoch 33 in logical epoch 33
[2023-06-24 15:19:00] [data] Shuffling data
[2023-06-24 15:19:00] [data] Done reading 20,192 sentences
[2023-06-24 15:19:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:21:12] Seen 20,177 samples
[2023-06-24 15:21:12] Starting data epoch 34 in logical epoch 34
[2023-06-24 15:21:12] [data] Shuffling data
[2023-06-24 15:21:12] [data] Done reading 20,192 sentences
[2023-06-24 15:21:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:21:54] Ep. 34 : Up. 11000 : Sen. 6,880 : Cost 1.61239374 : Time 422.00s : 3438.79 words/s : gNorm 0.4688
[2023-06-24 15:23:23] Seen 20,177 samples
[2023-06-24 15:23:23] Starting data epoch 35 in logical epoch 35
[2023-06-24 15:23:23] [data] Shuffling data
[2023-06-24 15:23:23] [data] Done reading 20,192 sentences
[2023-06-24 15:23:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:25:33] Seen 20,177 samples
[2023-06-24 15:25:33] Starting data epoch 36 in logical epoch 36
[2023-06-24 15:25:33] [data] Shuffling data
[2023-06-24 15:25:33] [data] Done reading 20,192 sentences
[2023-06-24 15:25:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:27:44] Seen 20,177 samples
[2023-06-24 15:27:44] Starting data epoch 37 in logical epoch 37
[2023-06-24 15:27:44] [data] Shuffling data
[2023-06-24 15:27:44] [data] Done reading 20,192 sentences
[2023-06-24 15:27:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:28:32] Ep. 37 : Up. 12000 : Sen. 7,492 : Cost 1.58534968 : Time 397.78s : 3639.12 words/s : gNorm 0.4248
[2023-06-24 15:29:55] Seen 20,177 samples
[2023-06-24 15:29:55] Starting data epoch 38 in logical epoch 38
[2023-06-24 15:29:55] [data] Shuffling data
[2023-06-24 15:29:55] [data] Done reading 20,192 sentences
[2023-06-24 15:29:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:32:06] Seen 20,177 samples
[2023-06-24 15:32:06] Starting data epoch 39 in logical epoch 39
[2023-06-24 15:32:06] [data] Shuffling data
[2023-06-24 15:32:06] [data] Done reading 20,192 sentences
[2023-06-24 15:32:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:34:17] Seen 20,177 samples
[2023-06-24 15:34:17] Starting data epoch 40 in logical epoch 40
[2023-06-24 15:34:17] [data] Shuffling data
[2023-06-24 15:34:17] [data] Done reading 20,192 sentences
[2023-06-24 15:34:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:35:07] Ep. 40 : Up. 13000 : Sen. 8,679 : Cost 1.56429279 : Time 394.39s : 3667.33 words/s : gNorm 0.3909
[2023-06-24 15:36:28] Seen 20,177 samples
[2023-06-24 15:36:28] Starting data epoch 41 in logical epoch 41
[2023-06-24 15:36:28] Training finished
[2023-06-24 15:36:40] [valid] Ep. 41 : Up. 13200 : cross-entropy : 105.921 : stalled 3 times (last best: 94.2576)
[2023-06-24 15:40:03] [valid] Ep. 41 : Up. 13200 : translation : 0 : new best
[2023-06-24 15:40:03] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 15:40:08] Saving Adam parameters
[2023-06-24 15:40:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 15:47:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 15:47:51] [marian] Running on node07.datos.cluster.uy as process 17648 with command line:
[2023-06-24 15:47:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 15:47:51] [config] after: 0e
[2023-06-24 15:47:51] [config] after-batches: 0
[2023-06-24 15:47:51] [config] after-epochs: 50
[2023-06-24 15:47:51] [config] all-caps-every: 0
[2023-06-24 15:47:51] [config] allow-unk: false
[2023-06-24 15:47:51] [config] authors: false
[2023-06-24 15:47:51] [config] beam-size: 12
[2023-06-24 15:47:51] [config] bert-class-symbol: "[CLS]"
[2023-06-24 15:47:51] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 15:47:51] [config] bert-masking-fraction: 0.15
[2023-06-24 15:47:51] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 15:47:51] [config] bert-train-type-embeddings: true
[2023-06-24 15:47:51] [config] bert-type-vocab-size: 2
[2023-06-24 15:47:51] [config] build-info: ""
[2023-06-24 15:47:51] [config] check-gradient-nan: false
[2023-06-24 15:47:51] [config] check-nan: false
[2023-06-24 15:47:51] [config] cite: false
[2023-06-24 15:47:51] [config] clip-norm: 5
[2023-06-24 15:47:51] [config] cost-scaling:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] cost-type: ce-mean-words
[2023-06-24 15:47:51] [config] cpu-threads: 0
[2023-06-24 15:47:51] [config] data-threads: 8
[2023-06-24 15:47:51] [config] data-weighting: ""
[2023-06-24 15:47:51] [config] data-weighting-type: sentence
[2023-06-24 15:47:51] [config] dec-cell: gru
[2023-06-24 15:47:51] [config] dec-cell-base-depth: 8
[2023-06-24 15:47:51] [config] dec-cell-high-depth: 1
[2023-06-24 15:47:51] [config] dec-depth: 1
[2023-06-24 15:47:51] [config] devices:
[2023-06-24 15:47:51] [config]   - 0
[2023-06-24 15:47:51] [config] dim-emb: 512
[2023-06-24 15:47:51] [config] dim-rnn: 1024
[2023-06-24 15:47:51] [config] dim-vocabs:
[2023-06-24 15:47:51] [config]   - 54042
[2023-06-24 15:47:51] [config]   - 36507
[2023-06-24 15:47:51] [config] disp-first: 0
[2023-06-24 15:47:51] [config] disp-freq: 1000u
[2023-06-24 15:47:51] [config] disp-label-counts: true
[2023-06-24 15:47:51] [config] dropout-rnn: 0.1
[2023-06-24 15:47:51] [config] dropout-src: 0
[2023-06-24 15:47:51] [config] dropout-trg: 0
[2023-06-24 15:47:51] [config] dump-config: ""
[2023-06-24 15:47:51] [config] dynamic-gradient-scaling:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] early-stopping: 10
[2023-06-24 15:47:51] [config] early-stopping-on: first
[2023-06-24 15:47:51] [config] embedding-fix-src: false
[2023-06-24 15:47:51] [config] embedding-fix-trg: false
[2023-06-24 15:47:51] [config] embedding-normalization: false
[2023-06-24 15:47:51] [config] embedding-vectors:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] enc-cell: gru
[2023-06-24 15:47:51] [config] enc-cell-depth: 4
[2023-06-24 15:47:51] [config] enc-depth: 1
[2023-06-24 15:47:51] [config] enc-type: bidirectional
[2023-06-24 15:47:51] [config] english-title-case-every: 0
[2023-06-24 15:47:51] [config] exponential-smoothing: 0.0001
[2023-06-24 15:47:51] [config] factor-weight: 1
[2023-06-24 15:47:51] [config] factors-combine: sum
[2023-06-24 15:47:51] [config] factors-dim-emb: 0
[2023-06-24 15:47:51] [config] gradient-checkpointing: false
[2023-06-24 15:47:51] [config] gradient-norm-average-window: 100
[2023-06-24 15:47:51] [config] guided-alignment: none
[2023-06-24 15:47:51] [config] guided-alignment-cost: mse
[2023-06-24 15:47:51] [config] guided-alignment-weight: 0.1
[2023-06-24 15:47:51] [config] ignore-model-config: false
[2023-06-24 15:47:51] [config] input-types:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] interpolate-env-vars: false
[2023-06-24 15:47:51] [config] keep-best: false
[2023-06-24 15:47:51] [config] label-smoothing: 0.1
[2023-06-24 15:47:51] [config] layer-normalization: true
[2023-06-24 15:47:51] [config] learn-rate: 0.0003
[2023-06-24 15:47:51] [config] lemma-dependency: ""
[2023-06-24 15:47:51] [config] lemma-dim-emb: 0
[2023-06-24 15:47:51] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 15:47:51] [config] log-level: info
[2023-06-24 15:47:51] [config] log-time-zone: ""
[2023-06-24 15:47:51] [config] logical-epoch:
[2023-06-24 15:47:51] [config]   - 1e
[2023-06-24 15:47:51] [config]   - 0
[2023-06-24 15:47:51] [config] lr-decay: 0
[2023-06-24 15:47:51] [config] lr-decay-freq: 50000
[2023-06-24 15:47:51] [config] lr-decay-inv-sqrt:
[2023-06-24 15:47:51] [config]   - 16000
[2023-06-24 15:47:51] [config] lr-decay-repeat-warmup: false
[2023-06-24 15:47:51] [config] lr-decay-reset-optimizer: false
[2023-06-24 15:47:51] [config] lr-decay-start:
[2023-06-24 15:47:51] [config]   - 10
[2023-06-24 15:47:51] [config]   - 1
[2023-06-24 15:47:51] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 15:47:51] [config] lr-report: false
[2023-06-24 15:47:51] [config] lr-warmup: 0
[2023-06-24 15:47:51] [config] lr-warmup-at-reload: false
[2023-06-24 15:47:51] [config] lr-warmup-cycle: false
[2023-06-24 15:47:51] [config] lr-warmup-start-rate: 0
[2023-06-24 15:47:51] [config] max-length: 100
[2023-06-24 15:47:51] [config] max-length-crop: false
[2023-06-24 15:47:51] [config] max-length-factor: 3
[2023-06-24 15:47:51] [config] maxi-batch: 1000
[2023-06-24 15:47:51] [config] maxi-batch-sort: trg
[2023-06-24 15:47:51] [config] mini-batch: 1000
[2023-06-24 15:47:51] [config] mini-batch-fit: true
[2023-06-24 15:47:51] [config] mini-batch-fit-step: 10
[2023-06-24 15:47:51] [config] mini-batch-round-up: true
[2023-06-24 15:47:51] [config] mini-batch-track-lr: false
[2023-06-24 15:47:51] [config] mini-batch-warmup: 0
[2023-06-24 15:47:51] [config] mini-batch-words: 0
[2023-06-24 15:47:51] [config] mini-batch-words-ref: 0
[2023-06-24 15:47:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 15:47:51] [config] multi-loss-type: sum
[2023-06-24 15:47:51] [config] n-best: false
[2023-06-24 15:47:51] [config] no-nccl: false
[2023-06-24 15:47:51] [config] no-reload: false
[2023-06-24 15:47:51] [config] no-restore-corpus: false
[2023-06-24 15:47:51] [config] normalize: 1
[2023-06-24 15:47:51] [config] normalize-gradient: false
[2023-06-24 15:47:51] [config] num-devices: 0
[2023-06-24 15:47:51] [config] optimizer: adam
[2023-06-24 15:47:51] [config] optimizer-delay: 1
[2023-06-24 15:47:51] [config] optimizer-params:
[2023-06-24 15:47:51] [config]   - 0.9
[2023-06-24 15:47:51] [config]   - 0.98
[2023-06-24 15:47:51] [config]   - 1e-09
[2023-06-24 15:47:51] [config] output-omit-bias: false
[2023-06-24 15:47:51] [config] overwrite: false
[2023-06-24 15:47:51] [config] precision:
[2023-06-24 15:47:51] [config]   - float32
[2023-06-24 15:47:51] [config]   - float32
[2023-06-24 15:47:51] [config] pretrained-model: ""
[2023-06-24 15:47:51] [config] quantize-biases: false
[2023-06-24 15:47:51] [config] quantize-bits: 0
[2023-06-24 15:47:51] [config] quantize-log-based: false
[2023-06-24 15:47:51] [config] quantize-optimization-steps: 0
[2023-06-24 15:47:51] [config] quiet: false
[2023-06-24 15:47:51] [config] quiet-translation: true
[2023-06-24 15:47:51] [config] relative-paths: false
[2023-06-24 15:47:51] [config] right-left: false
[2023-06-24 15:47:51] [config] save-freq: 10000u
[2023-06-24 15:47:51] [config] seed: 1234
[2023-06-24 15:47:51] [config] sentencepiece-alphas:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] sentencepiece-max-lines: 2000000
[2023-06-24 15:47:51] [config] sentencepiece-options: ""
[2023-06-24 15:47:51] [config] sharding: global
[2023-06-24 15:47:51] [config] shuffle: data
[2023-06-24 15:47:51] [config] shuffle-in-ram: false
[2023-06-24 15:47:51] [config] sigterm: save-and-exit
[2023-06-24 15:47:51] [config] skip: false
[2023-06-24 15:47:51] [config] sqlite: ""
[2023-06-24 15:47:51] [config] sqlite-drop: false
[2023-06-24 15:47:51] [config] sync-freq: 200u
[2023-06-24 15:47:51] [config] sync-sgd: true
[2023-06-24 15:47:51] [config] tempdir: /tmp
[2023-06-24 15:47:51] [config] tied-embeddings: false
[2023-06-24 15:47:51] [config] tied-embeddings-all: false
[2023-06-24 15:47:51] [config] tied-embeddings-src: false
[2023-06-24 15:47:51] [config] train-embedder-rank:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] train-sets:
[2023-06-24 15:47:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 15:47:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 15:47:51] [config] transformer-aan-activation: swish
[2023-06-24 15:47:51] [config] transformer-aan-depth: 2
[2023-06-24 15:47:51] [config] transformer-aan-nogate: false
[2023-06-24 15:47:51] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 15:47:51] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 15:47:51] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 15:47:51] [config] transformer-depth-scaling: false
[2023-06-24 15:47:51] [config] transformer-dim-aan: 2048
[2023-06-24 15:47:51] [config] transformer-dim-ffn: 2048
[2023-06-24 15:47:51] [config] transformer-dropout: 0
[2023-06-24 15:47:51] [config] transformer-dropout-attention: 0
[2023-06-24 15:47:51] [config] transformer-dropout-ffn: 0
[2023-06-24 15:47:51] [config] transformer-ffn-activation: swish
[2023-06-24 15:47:51] [config] transformer-ffn-depth: 2
[2023-06-24 15:47:51] [config] transformer-guided-alignment-layer: last
[2023-06-24 15:47:51] [config] transformer-heads: 8
[2023-06-24 15:47:51] [config] transformer-no-projection: false
[2023-06-24 15:47:51] [config] transformer-pool: false
[2023-06-24 15:47:51] [config] transformer-postprocess: dan
[2023-06-24 15:47:51] [config] transformer-postprocess-emb: d
[2023-06-24 15:47:51] [config] transformer-postprocess-top: ""
[2023-06-24 15:47:51] [config] transformer-preprocess: ""
[2023-06-24 15:47:51] [config] transformer-tied-layers:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] transformer-train-position-embeddings: false
[2023-06-24 15:47:51] [config] tsv: false
[2023-06-24 15:47:51] [config] tsv-fields: 0
[2023-06-24 15:47:51] [config] type: s2s
[2023-06-24 15:47:51] [config] ulr: false
[2023-06-24 15:47:51] [config] ulr-dim-emb: 0
[2023-06-24 15:47:51] [config] ulr-dropout: 0
[2023-06-24 15:47:51] [config] ulr-keys-vectors: ""
[2023-06-24 15:47:51] [config] ulr-query-vectors: ""
[2023-06-24 15:47:51] [config] ulr-softmax-temperature: 1
[2023-06-24 15:47:51] [config] ulr-trainable-transformation: false
[2023-06-24 15:47:51] [config] unlikelihood-loss: false
[2023-06-24 15:47:51] [config] valid-freq: 5000000
[2023-06-24 15:47:51] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 15:47:51] [config] valid-max-length: 1000
[2023-06-24 15:47:51] [config] valid-metrics:
[2023-06-24 15:47:51] [config]   - cross-entropy
[2023-06-24 15:47:51] [config]   - translation
[2023-06-24 15:47:51] [config] valid-mini-batch: 32
[2023-06-24 15:47:51] [config] valid-reset-stalled: false
[2023-06-24 15:47:51] [config] valid-script-args:
[2023-06-24 15:47:51] [config]   []
[2023-06-24 15:47:51] [config] valid-script-path: ""
[2023-06-24 15:47:51] [config] valid-sets:
[2023-06-24 15:47:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 15:47:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 15:47:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 15:47:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 15:47:51] [config] vocabs:
[2023-06-24 15:47:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 15:47:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 15:47:51] [config] word-penalty: 0
[2023-06-24 15:47:51] [config] word-scores: false
[2023-06-24 15:47:51] [config] workspace: 2048
[2023-06-24 15:47:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 15:47:51] Using synchronous SGD
[2023-06-24 15:47:51] Synced seed 1234
[2023-06-24 15:47:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 15:47:51] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 15:47:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 15:47:51] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 15:47:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 15:47:51] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 15:47:52] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 15:47:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 15:47:52] [comm] Using global sharding
[2023-06-24 15:47:52] [comm] NCCLCommunicators constructed successfully
[2023-06-24 15:47:52] [training] Using 1 GPUs
[2023-06-24 15:47:52] [logits] Applying loss function for 1 factor(s)
[2023-06-24 15:47:52] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:47:52] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 15:47:53] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:48:14] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 15:48:14] [valid] No post-processing script given for validating translator
[2023-06-24 15:48:14] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 15:48:14] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 15:48:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 15:48:14] [comm] Using global sharding
[2023-06-24 15:48:14] [comm] NCCLCommunicators constructed successfully
[2023-06-24 15:48:14] [training] Using 1 GPUs
[2023-06-24 15:48:14] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 15:48:19] Allocating memory for general optimizer shards
[2023-06-24 15:48:19] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:48:19] Loading Adam parameters
[2023-06-24 15:48:19] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 15:48:19] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:48:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 15:48:20] [data] Restoring the corpus state to epoch 41, batch 13200
[2023-06-24 15:48:20] [data] Shuffling data
[2023-06-24 15:48:20] [data] Done reading 20,192 sentences
[2023-06-24 15:48:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:48:20] Training started
[2023-06-24 15:48:20] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 15:48:20] [memory] Reserving 521 MB, device gpu0
[2023-06-24 15:48:20] Parameter type float32, optimization type float32, casting types false
[2023-06-24 15:50:29] Seen 20,177 samples
[2023-06-24 15:50:29] Starting data epoch 42 in logical epoch 42
[2023-06-24 15:50:29] [data] Shuffling data
[2023-06-24 15:50:29] [data] Done reading 20,192 sentences
[2023-06-24 15:50:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:52:39] Seen 20,177 samples
[2023-06-24 15:52:39] Starting data epoch 43 in logical epoch 43
[2023-06-24 15:52:39] [data] Shuffling data
[2023-06-24 15:52:39] [data] Done reading 20,192 sentences
[2023-06-24 15:52:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:53:33] Ep. 43 : Up. 14000 : Sen. 8,536 : Cost 1.54968429 : Time 319.10s : 4549.65 words/s : gNorm 0.3675
[2023-06-24 15:54:51] Seen 20,177 samples
[2023-06-24 15:54:51] Starting data epoch 44 in logical epoch 44
[2023-06-24 15:54:51] [data] Shuffling data
[2023-06-24 15:54:51] [data] Done reading 20,192 sentences
[2023-06-24 15:54:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:57:01] Seen 20,177 samples
[2023-06-24 15:57:01] Starting data epoch 45 in logical epoch 45
[2023-06-24 15:57:01] [data] Shuffling data
[2023-06-24 15:57:01] [data] Done reading 20,192 sentences
[2023-06-24 15:57:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 15:59:12] Seen 20,177 samples
[2023-06-24 15:59:12] Starting data epoch 46 in logical epoch 46
[2023-06-24 15:59:12] [data] Shuffling data
[2023-06-24 15:59:12] [data] Done reading 20,192 sentences
[2023-06-24 15:59:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:00:11] Ep. 46 : Up. 15000 : Sen. 9,016 : Cost 1.54170251 : Time 398.14s : 3637.72 words/s : gNorm 0.3538
[2023-06-24 16:01:22] Seen 20,177 samples
[2023-06-24 16:01:22] Starting data epoch 47 in logical epoch 47
[2023-06-24 16:01:22] [data] Shuffling data
[2023-06-24 16:01:22] [data] Done reading 20,192 sentences
[2023-06-24 16:01:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:03:33] Seen 20,177 samples
[2023-06-24 16:03:33] Starting data epoch 48 in logical epoch 48
[2023-06-24 16:03:33] [data] Shuffling data
[2023-06-24 16:03:33] [data] Done reading 20,192 sentences
[2023-06-24 16:03:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:05:44] Seen 20,177 samples
[2023-06-24 16:05:44] Starting data epoch 49 in logical epoch 49
[2023-06-24 16:05:44] [data] Shuffling data
[2023-06-24 16:05:44] [data] Done reading 20,192 sentences
[2023-06-24 16:05:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:06:46] Ep. 49 : Up. 16000 : Sen. 10,167 : Cost 1.53247511 : Time 395.06s : 3653.65 words/s : gNorm 0.3418
[2023-06-24 16:07:55] Seen 20,177 samples
[2023-06-24 16:07:55] Starting data epoch 50 in logical epoch 50
[2023-06-24 16:07:55] [data] Shuffling data
[2023-06-24 16:07:55] [data] Done reading 20,192 sentences
[2023-06-24 16:07:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:10:06] Seen 20,177 samples
[2023-06-24 16:10:06] Starting data epoch 51 in logical epoch 51
[2023-06-24 16:10:06] Training finished
[2023-06-24 16:10:18] [valid] Ep. 51 : Up. 16500 : cross-entropy : 106.924 : stalled 4 times (last best: 94.2576)
[2023-06-24 16:13:42] [valid] Ep. 51 : Up. 16500 : translation : 0 : new best
[2023-06-24 16:13:42] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 16:13:51] Saving Adam parameters
[2023-06-24 16:13:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 16:21:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 16:21:40] [marian] Running on node07.datos.cluster.uy as process 19918 with command line:
[2023-06-24 16:21:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 16:21:40] [config] after: 0e
[2023-06-24 16:21:40] [config] after-batches: 0
[2023-06-24 16:21:40] [config] after-epochs: 60
[2023-06-24 16:21:40] [config] all-caps-every: 0
[2023-06-24 16:21:40] [config] allow-unk: false
[2023-06-24 16:21:40] [config] authors: false
[2023-06-24 16:21:40] [config] beam-size: 12
[2023-06-24 16:21:40] [config] bert-class-symbol: "[CLS]"
[2023-06-24 16:21:40] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 16:21:40] [config] bert-masking-fraction: 0.15
[2023-06-24 16:21:40] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 16:21:40] [config] bert-train-type-embeddings: true
[2023-06-24 16:21:40] [config] bert-type-vocab-size: 2
[2023-06-24 16:21:40] [config] build-info: ""
[2023-06-24 16:21:40] [config] check-gradient-nan: false
[2023-06-24 16:21:40] [config] check-nan: false
[2023-06-24 16:21:40] [config] cite: false
[2023-06-24 16:21:40] [config] clip-norm: 5
[2023-06-24 16:21:40] [config] cost-scaling:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] cost-type: ce-mean-words
[2023-06-24 16:21:40] [config] cpu-threads: 0
[2023-06-24 16:21:40] [config] data-threads: 8
[2023-06-24 16:21:40] [config] data-weighting: ""
[2023-06-24 16:21:40] [config] data-weighting-type: sentence
[2023-06-24 16:21:40] [config] dec-cell: gru
[2023-06-24 16:21:40] [config] dec-cell-base-depth: 8
[2023-06-24 16:21:40] [config] dec-cell-high-depth: 1
[2023-06-24 16:21:40] [config] dec-depth: 1
[2023-06-24 16:21:40] [config] devices:
[2023-06-24 16:21:40] [config]   - 0
[2023-06-24 16:21:40] [config] dim-emb: 512
[2023-06-24 16:21:40] [config] dim-rnn: 1024
[2023-06-24 16:21:40] [config] dim-vocabs:
[2023-06-24 16:21:40] [config]   - 54042
[2023-06-24 16:21:40] [config]   - 36507
[2023-06-24 16:21:40] [config] disp-first: 0
[2023-06-24 16:21:40] [config] disp-freq: 1000u
[2023-06-24 16:21:40] [config] disp-label-counts: true
[2023-06-24 16:21:40] [config] dropout-rnn: 0.1
[2023-06-24 16:21:40] [config] dropout-src: 0
[2023-06-24 16:21:40] [config] dropout-trg: 0
[2023-06-24 16:21:40] [config] dump-config: ""
[2023-06-24 16:21:40] [config] dynamic-gradient-scaling:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] early-stopping: 10
[2023-06-24 16:21:40] [config] early-stopping-on: first
[2023-06-24 16:21:40] [config] embedding-fix-src: false
[2023-06-24 16:21:40] [config] embedding-fix-trg: false
[2023-06-24 16:21:40] [config] embedding-normalization: false
[2023-06-24 16:21:40] [config] embedding-vectors:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] enc-cell: gru
[2023-06-24 16:21:40] [config] enc-cell-depth: 4
[2023-06-24 16:21:40] [config] enc-depth: 1
[2023-06-24 16:21:40] [config] enc-type: bidirectional
[2023-06-24 16:21:40] [config] english-title-case-every: 0
[2023-06-24 16:21:40] [config] exponential-smoothing: 0.0001
[2023-06-24 16:21:40] [config] factor-weight: 1
[2023-06-24 16:21:40] [config] factors-combine: sum
[2023-06-24 16:21:40] [config] factors-dim-emb: 0
[2023-06-24 16:21:40] [config] gradient-checkpointing: false
[2023-06-24 16:21:40] [config] gradient-norm-average-window: 100
[2023-06-24 16:21:40] [config] guided-alignment: none
[2023-06-24 16:21:40] [config] guided-alignment-cost: mse
[2023-06-24 16:21:40] [config] guided-alignment-weight: 0.1
[2023-06-24 16:21:40] [config] ignore-model-config: false
[2023-06-24 16:21:40] [config] input-types:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] interpolate-env-vars: false
[2023-06-24 16:21:40] [config] keep-best: false
[2023-06-24 16:21:40] [config] label-smoothing: 0.1
[2023-06-24 16:21:40] [config] layer-normalization: true
[2023-06-24 16:21:40] [config] learn-rate: 0.0003
[2023-06-24 16:21:40] [config] lemma-dependency: ""
[2023-06-24 16:21:40] [config] lemma-dim-emb: 0
[2023-06-24 16:21:40] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 16:21:40] [config] log-level: info
[2023-06-24 16:21:40] [config] log-time-zone: ""
[2023-06-24 16:21:40] [config] logical-epoch:
[2023-06-24 16:21:40] [config]   - 1e
[2023-06-24 16:21:40] [config]   - 0
[2023-06-24 16:21:40] [config] lr-decay: 0
[2023-06-24 16:21:40] [config] lr-decay-freq: 50000
[2023-06-24 16:21:40] [config] lr-decay-inv-sqrt:
[2023-06-24 16:21:40] [config]   - 16000
[2023-06-24 16:21:40] [config] lr-decay-repeat-warmup: false
[2023-06-24 16:21:40] [config] lr-decay-reset-optimizer: false
[2023-06-24 16:21:40] [config] lr-decay-start:
[2023-06-24 16:21:40] [config]   - 10
[2023-06-24 16:21:40] [config]   - 1
[2023-06-24 16:21:40] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 16:21:40] [config] lr-report: false
[2023-06-24 16:21:40] [config] lr-warmup: 0
[2023-06-24 16:21:40] [config] lr-warmup-at-reload: false
[2023-06-24 16:21:40] [config] lr-warmup-cycle: false
[2023-06-24 16:21:40] [config] lr-warmup-start-rate: 0
[2023-06-24 16:21:40] [config] max-length: 100
[2023-06-24 16:21:40] [config] max-length-crop: false
[2023-06-24 16:21:40] [config] max-length-factor: 3
[2023-06-24 16:21:40] [config] maxi-batch: 1000
[2023-06-24 16:21:40] [config] maxi-batch-sort: trg
[2023-06-24 16:21:40] [config] mini-batch: 1000
[2023-06-24 16:21:40] [config] mini-batch-fit: true
[2023-06-24 16:21:40] [config] mini-batch-fit-step: 10
[2023-06-24 16:21:40] [config] mini-batch-round-up: true
[2023-06-24 16:21:40] [config] mini-batch-track-lr: false
[2023-06-24 16:21:40] [config] mini-batch-warmup: 0
[2023-06-24 16:21:40] [config] mini-batch-words: 0
[2023-06-24 16:21:40] [config] mini-batch-words-ref: 0
[2023-06-24 16:21:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 16:21:40] [config] multi-loss-type: sum
[2023-06-24 16:21:40] [config] n-best: false
[2023-06-24 16:21:40] [config] no-nccl: false
[2023-06-24 16:21:40] [config] no-reload: false
[2023-06-24 16:21:40] [config] no-restore-corpus: false
[2023-06-24 16:21:40] [config] normalize: 1
[2023-06-24 16:21:40] [config] normalize-gradient: false
[2023-06-24 16:21:40] [config] num-devices: 0
[2023-06-24 16:21:40] [config] optimizer: adam
[2023-06-24 16:21:40] [config] optimizer-delay: 1
[2023-06-24 16:21:40] [config] optimizer-params:
[2023-06-24 16:21:40] [config]   - 0.9
[2023-06-24 16:21:40] [config]   - 0.98
[2023-06-24 16:21:40] [config]   - 1e-09
[2023-06-24 16:21:40] [config] output-omit-bias: false
[2023-06-24 16:21:40] [config] overwrite: false
[2023-06-24 16:21:40] [config] precision:
[2023-06-24 16:21:40] [config]   - float32
[2023-06-24 16:21:40] [config]   - float32
[2023-06-24 16:21:40] [config] pretrained-model: ""
[2023-06-24 16:21:40] [config] quantize-biases: false
[2023-06-24 16:21:40] [config] quantize-bits: 0
[2023-06-24 16:21:40] [config] quantize-log-based: false
[2023-06-24 16:21:40] [config] quantize-optimization-steps: 0
[2023-06-24 16:21:40] [config] quiet: false
[2023-06-24 16:21:40] [config] quiet-translation: true
[2023-06-24 16:21:40] [config] relative-paths: false
[2023-06-24 16:21:40] [config] right-left: false
[2023-06-24 16:21:40] [config] save-freq: 10000u
[2023-06-24 16:21:40] [config] seed: 1234
[2023-06-24 16:21:40] [config] sentencepiece-alphas:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] sentencepiece-max-lines: 2000000
[2023-06-24 16:21:40] [config] sentencepiece-options: ""
[2023-06-24 16:21:40] [config] sharding: global
[2023-06-24 16:21:40] [config] shuffle: data
[2023-06-24 16:21:40] [config] shuffle-in-ram: false
[2023-06-24 16:21:40] [config] sigterm: save-and-exit
[2023-06-24 16:21:40] [config] skip: false
[2023-06-24 16:21:40] [config] sqlite: ""
[2023-06-24 16:21:40] [config] sqlite-drop: false
[2023-06-24 16:21:40] [config] sync-freq: 200u
[2023-06-24 16:21:40] [config] sync-sgd: true
[2023-06-24 16:21:40] [config] tempdir: /tmp
[2023-06-24 16:21:40] [config] tied-embeddings: false
[2023-06-24 16:21:40] [config] tied-embeddings-all: false
[2023-06-24 16:21:40] [config] tied-embeddings-src: false
[2023-06-24 16:21:40] [config] train-embedder-rank:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] train-sets:
[2023-06-24 16:21:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 16:21:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 16:21:40] [config] transformer-aan-activation: swish
[2023-06-24 16:21:40] [config] transformer-aan-depth: 2
[2023-06-24 16:21:40] [config] transformer-aan-nogate: false
[2023-06-24 16:21:40] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 16:21:40] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 16:21:40] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 16:21:40] [config] transformer-depth-scaling: false
[2023-06-24 16:21:40] [config] transformer-dim-aan: 2048
[2023-06-24 16:21:40] [config] transformer-dim-ffn: 2048
[2023-06-24 16:21:40] [config] transformer-dropout: 0
[2023-06-24 16:21:40] [config] transformer-dropout-attention: 0
[2023-06-24 16:21:40] [config] transformer-dropout-ffn: 0
[2023-06-24 16:21:40] [config] transformer-ffn-activation: swish
[2023-06-24 16:21:40] [config] transformer-ffn-depth: 2
[2023-06-24 16:21:40] [config] transformer-guided-alignment-layer: last
[2023-06-24 16:21:40] [config] transformer-heads: 8
[2023-06-24 16:21:40] [config] transformer-no-projection: false
[2023-06-24 16:21:40] [config] transformer-pool: false
[2023-06-24 16:21:40] [config] transformer-postprocess: dan
[2023-06-24 16:21:40] [config] transformer-postprocess-emb: d
[2023-06-24 16:21:40] [config] transformer-postprocess-top: ""
[2023-06-24 16:21:40] [config] transformer-preprocess: ""
[2023-06-24 16:21:40] [config] transformer-tied-layers:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] transformer-train-position-embeddings: false
[2023-06-24 16:21:40] [config] tsv: false
[2023-06-24 16:21:40] [config] tsv-fields: 0
[2023-06-24 16:21:40] [config] type: s2s
[2023-06-24 16:21:40] [config] ulr: false
[2023-06-24 16:21:40] [config] ulr-dim-emb: 0
[2023-06-24 16:21:40] [config] ulr-dropout: 0
[2023-06-24 16:21:40] [config] ulr-keys-vectors: ""
[2023-06-24 16:21:40] [config] ulr-query-vectors: ""
[2023-06-24 16:21:40] [config] ulr-softmax-temperature: 1
[2023-06-24 16:21:40] [config] ulr-trainable-transformation: false
[2023-06-24 16:21:40] [config] unlikelihood-loss: false
[2023-06-24 16:21:40] [config] valid-freq: 5000000
[2023-06-24 16:21:40] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 16:21:40] [config] valid-max-length: 1000
[2023-06-24 16:21:40] [config] valid-metrics:
[2023-06-24 16:21:40] [config]   - cross-entropy
[2023-06-24 16:21:40] [config]   - translation
[2023-06-24 16:21:40] [config] valid-mini-batch: 32
[2023-06-24 16:21:40] [config] valid-reset-stalled: false
[2023-06-24 16:21:40] [config] valid-script-args:
[2023-06-24 16:21:40] [config]   []
[2023-06-24 16:21:40] [config] valid-script-path: ""
[2023-06-24 16:21:40] [config] valid-sets:
[2023-06-24 16:21:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 16:21:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 16:21:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 16:21:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 16:21:40] [config] vocabs:
[2023-06-24 16:21:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 16:21:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 16:21:40] [config] word-penalty: 0
[2023-06-24 16:21:40] [config] word-scores: false
[2023-06-24 16:21:40] [config] workspace: 2048
[2023-06-24 16:21:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 16:21:40] Using synchronous SGD
[2023-06-24 16:21:42] Synced seed 1234
[2023-06-24 16:21:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 16:21:42] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 16:21:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 16:21:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 16:21:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 16:21:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 16:21:42] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 16:21:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 16:21:42] [comm] Using global sharding
[2023-06-24 16:21:42] [comm] NCCLCommunicators constructed successfully
[2023-06-24 16:21:42] [training] Using 1 GPUs
[2023-06-24 16:21:42] [logits] Applying loss function for 1 factor(s)
[2023-06-24 16:21:42] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:21:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 16:21:43] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:22:05] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 16:22:05] [valid] No post-processing script given for validating translator
[2023-06-24 16:22:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 16:22:05] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 16:22:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 16:22:05] [comm] Using global sharding
[2023-06-24 16:22:05] [comm] NCCLCommunicators constructed successfully
[2023-06-24 16:22:05] [training] Using 1 GPUs
[2023-06-24 16:22:05] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 16:22:09] Allocating memory for general optimizer shards
[2023-06-24 16:22:09] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:22:09] Loading Adam parameters
[2023-06-24 16:22:10] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 16:22:10] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:22:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 16:22:10] [data] Restoring the corpus state to epoch 51, batch 16500
[2023-06-24 16:22:10] [data] Shuffling data
[2023-06-24 16:22:10] [data] Done reading 20,192 sentences
[2023-06-24 16:22:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:22:10] Training started
[2023-06-24 16:22:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 16:22:11] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:22:11] Parameter type float32, optimization type float32, casting types false
[2023-06-24 16:24:21] Seen 20,177 samples
[2023-06-24 16:24:21] Starting data epoch 52 in logical epoch 52
[2023-06-24 16:24:21] [data] Shuffling data
[2023-06-24 16:24:21] [data] Done reading 20,192 sentences
[2023-06-24 16:24:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:25:29] Ep. 52 : Up. 17000 : Sen. 11,025 : Cost 1.52649724 : Time 204.12s : 7095.38 words/s : gNorm 0.3197
[2023-06-24 16:26:33] Seen 20,177 samples
[2023-06-24 16:26:33] Starting data epoch 53 in logical epoch 53
[2023-06-24 16:26:33] [data] Shuffling data
[2023-06-24 16:26:33] [data] Done reading 20,192 sentences
[2023-06-24 16:26:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:28:44] Seen 20,177 samples
[2023-06-24 16:28:44] Starting data epoch 54 in logical epoch 54
[2023-06-24 16:28:44] [data] Shuffling data
[2023-06-24 16:28:44] [data] Done reading 20,192 sentences
[2023-06-24 16:28:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:30:55] Seen 20,177 samples
[2023-06-24 16:30:55] Starting data epoch 55 in logical epoch 55
[2023-06-24 16:30:55] [data] Shuffling data
[2023-06-24 16:30:55] [data] Done reading 20,192 sentences
[2023-06-24 16:30:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:32:08] Ep. 55 : Up. 18000 : Sen. 10,601 : Cost 1.51845729 : Time 399.29s : 3652.02 words/s : gNorm 0.2986
[2023-06-24 16:33:05] Seen 20,177 samples
[2023-06-24 16:33:05] Starting data epoch 56 in logical epoch 56
[2023-06-24 16:33:05] [data] Shuffling data
[2023-06-24 16:33:05] [data] Done reading 20,192 sentences
[2023-06-24 16:33:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:35:16] Seen 20,177 samples
[2023-06-24 16:35:16] Starting data epoch 57 in logical epoch 57
[2023-06-24 16:35:16] [data] Shuffling data
[2023-06-24 16:35:16] [data] Done reading 20,192 sentences
[2023-06-24 16:35:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:37:29] Seen 20,177 samples
[2023-06-24 16:37:29] Starting data epoch 58 in logical epoch 58
[2023-06-24 16:37:29] [data] Shuffling data
[2023-06-24 16:37:29] [data] Done reading 20,192 sentences
[2023-06-24 16:37:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:38:44] Ep. 58 : Up. 19000 : Sen. 11,325 : Cost 1.50906825 : Time 396.12s : 3632.61 words/s : gNorm 0.2926
[2023-06-24 16:39:39] Seen 20,177 samples
[2023-06-24 16:39:39] Starting data epoch 59 in logical epoch 59
[2023-06-24 16:39:39] [data] Shuffling data
[2023-06-24 16:39:39] [data] Done reading 20,192 sentences
[2023-06-24 16:39:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:41:50] Seen 20,177 samples
[2023-06-24 16:41:50] Starting data epoch 60 in logical epoch 60
[2023-06-24 16:41:50] [data] Shuffling data
[2023-06-24 16:41:51] [data] Done reading 20,192 sentences
[2023-06-24 16:41:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:44:02] Seen 20,177 samples
[2023-06-24 16:44:02] Starting data epoch 61 in logical epoch 61
[2023-06-24 16:44:02] Training finished
[2023-06-24 16:44:13] [valid] Ep. 61 : Up. 19800 : cross-entropy : 107.859 : stalled 5 times (last best: 94.2576)
[2023-06-24 16:47:35] [valid] Ep. 61 : Up. 19800 : translation : 0 : new best
[2023-06-24 16:47:35] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 16:47:42] Saving Adam parameters
[2023-06-24 16:47:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 16:55:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 16:55:26] [marian] Running on node07.datos.cluster.uy as process 22112 with command line:
[2023-06-24 16:55:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 16:55:26] [config] after: 0e
[2023-06-24 16:55:26] [config] after-batches: 0
[2023-06-24 16:55:26] [config] after-epochs: 70
[2023-06-24 16:55:26] [config] all-caps-every: 0
[2023-06-24 16:55:26] [config] allow-unk: false
[2023-06-24 16:55:26] [config] authors: false
[2023-06-24 16:55:26] [config] beam-size: 12
[2023-06-24 16:55:26] [config] bert-class-symbol: "[CLS]"
[2023-06-24 16:55:26] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 16:55:26] [config] bert-masking-fraction: 0.15
[2023-06-24 16:55:26] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 16:55:26] [config] bert-train-type-embeddings: true
[2023-06-24 16:55:26] [config] bert-type-vocab-size: 2
[2023-06-24 16:55:26] [config] build-info: ""
[2023-06-24 16:55:26] [config] check-gradient-nan: false
[2023-06-24 16:55:26] [config] check-nan: false
[2023-06-24 16:55:26] [config] cite: false
[2023-06-24 16:55:26] [config] clip-norm: 5
[2023-06-24 16:55:26] [config] cost-scaling:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] cost-type: ce-mean-words
[2023-06-24 16:55:26] [config] cpu-threads: 0
[2023-06-24 16:55:26] [config] data-threads: 8
[2023-06-24 16:55:26] [config] data-weighting: ""
[2023-06-24 16:55:26] [config] data-weighting-type: sentence
[2023-06-24 16:55:26] [config] dec-cell: gru
[2023-06-24 16:55:26] [config] dec-cell-base-depth: 8
[2023-06-24 16:55:26] [config] dec-cell-high-depth: 1
[2023-06-24 16:55:26] [config] dec-depth: 1
[2023-06-24 16:55:26] [config] devices:
[2023-06-24 16:55:26] [config]   - 0
[2023-06-24 16:55:26] [config] dim-emb: 512
[2023-06-24 16:55:26] [config] dim-rnn: 1024
[2023-06-24 16:55:26] [config] dim-vocabs:
[2023-06-24 16:55:26] [config]   - 54042
[2023-06-24 16:55:26] [config]   - 36507
[2023-06-24 16:55:26] [config] disp-first: 0
[2023-06-24 16:55:26] [config] disp-freq: 1000u
[2023-06-24 16:55:26] [config] disp-label-counts: true
[2023-06-24 16:55:26] [config] dropout-rnn: 0.1
[2023-06-24 16:55:26] [config] dropout-src: 0
[2023-06-24 16:55:26] [config] dropout-trg: 0
[2023-06-24 16:55:26] [config] dump-config: ""
[2023-06-24 16:55:26] [config] dynamic-gradient-scaling:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] early-stopping: 10
[2023-06-24 16:55:26] [config] early-stopping-on: first
[2023-06-24 16:55:26] [config] embedding-fix-src: false
[2023-06-24 16:55:26] [config] embedding-fix-trg: false
[2023-06-24 16:55:26] [config] embedding-normalization: false
[2023-06-24 16:55:26] [config] embedding-vectors:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] enc-cell: gru
[2023-06-24 16:55:26] [config] enc-cell-depth: 4
[2023-06-24 16:55:26] [config] enc-depth: 1
[2023-06-24 16:55:26] [config] enc-type: bidirectional
[2023-06-24 16:55:26] [config] english-title-case-every: 0
[2023-06-24 16:55:26] [config] exponential-smoothing: 0.0001
[2023-06-24 16:55:26] [config] factor-weight: 1
[2023-06-24 16:55:26] [config] factors-combine: sum
[2023-06-24 16:55:26] [config] factors-dim-emb: 0
[2023-06-24 16:55:26] [config] gradient-checkpointing: false
[2023-06-24 16:55:26] [config] gradient-norm-average-window: 100
[2023-06-24 16:55:26] [config] guided-alignment: none
[2023-06-24 16:55:26] [config] guided-alignment-cost: mse
[2023-06-24 16:55:26] [config] guided-alignment-weight: 0.1
[2023-06-24 16:55:26] [config] ignore-model-config: false
[2023-06-24 16:55:26] [config] input-types:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] interpolate-env-vars: false
[2023-06-24 16:55:26] [config] keep-best: false
[2023-06-24 16:55:26] [config] label-smoothing: 0.1
[2023-06-24 16:55:26] [config] layer-normalization: true
[2023-06-24 16:55:26] [config] learn-rate: 0.0003
[2023-06-24 16:55:26] [config] lemma-dependency: ""
[2023-06-24 16:55:26] [config] lemma-dim-emb: 0
[2023-06-24 16:55:26] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 16:55:26] [config] log-level: info
[2023-06-24 16:55:26] [config] log-time-zone: ""
[2023-06-24 16:55:26] [config] logical-epoch:
[2023-06-24 16:55:26] [config]   - 1e
[2023-06-24 16:55:26] [config]   - 0
[2023-06-24 16:55:26] [config] lr-decay: 0
[2023-06-24 16:55:26] [config] lr-decay-freq: 50000
[2023-06-24 16:55:26] [config] lr-decay-inv-sqrt:
[2023-06-24 16:55:26] [config]   - 16000
[2023-06-24 16:55:26] [config] lr-decay-repeat-warmup: false
[2023-06-24 16:55:26] [config] lr-decay-reset-optimizer: false
[2023-06-24 16:55:26] [config] lr-decay-start:
[2023-06-24 16:55:26] [config]   - 10
[2023-06-24 16:55:26] [config]   - 1
[2023-06-24 16:55:26] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 16:55:26] [config] lr-report: false
[2023-06-24 16:55:26] [config] lr-warmup: 0
[2023-06-24 16:55:26] [config] lr-warmup-at-reload: false
[2023-06-24 16:55:26] [config] lr-warmup-cycle: false
[2023-06-24 16:55:26] [config] lr-warmup-start-rate: 0
[2023-06-24 16:55:26] [config] max-length: 100
[2023-06-24 16:55:26] [config] max-length-crop: false
[2023-06-24 16:55:26] [config] max-length-factor: 3
[2023-06-24 16:55:26] [config] maxi-batch: 1000
[2023-06-24 16:55:26] [config] maxi-batch-sort: trg
[2023-06-24 16:55:26] [config] mini-batch: 1000
[2023-06-24 16:55:26] [config] mini-batch-fit: true
[2023-06-24 16:55:26] [config] mini-batch-fit-step: 10
[2023-06-24 16:55:26] [config] mini-batch-round-up: true
[2023-06-24 16:55:26] [config] mini-batch-track-lr: false
[2023-06-24 16:55:26] [config] mini-batch-warmup: 0
[2023-06-24 16:55:26] [config] mini-batch-words: 0
[2023-06-24 16:55:26] [config] mini-batch-words-ref: 0
[2023-06-24 16:55:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 16:55:26] [config] multi-loss-type: sum
[2023-06-24 16:55:26] [config] n-best: false
[2023-06-24 16:55:26] [config] no-nccl: false
[2023-06-24 16:55:26] [config] no-reload: false
[2023-06-24 16:55:26] [config] no-restore-corpus: false
[2023-06-24 16:55:26] [config] normalize: 1
[2023-06-24 16:55:26] [config] normalize-gradient: false
[2023-06-24 16:55:26] [config] num-devices: 0
[2023-06-24 16:55:26] [config] optimizer: adam
[2023-06-24 16:55:26] [config] optimizer-delay: 1
[2023-06-24 16:55:26] [config] optimizer-params:
[2023-06-24 16:55:26] [config]   - 0.9
[2023-06-24 16:55:26] [config]   - 0.98
[2023-06-24 16:55:26] [config]   - 1e-09
[2023-06-24 16:55:26] [config] output-omit-bias: false
[2023-06-24 16:55:26] [config] overwrite: false
[2023-06-24 16:55:26] [config] precision:
[2023-06-24 16:55:26] [config]   - float32
[2023-06-24 16:55:26] [config]   - float32
[2023-06-24 16:55:26] [config] pretrained-model: ""
[2023-06-24 16:55:26] [config] quantize-biases: false
[2023-06-24 16:55:26] [config] quantize-bits: 0
[2023-06-24 16:55:26] [config] quantize-log-based: false
[2023-06-24 16:55:26] [config] quantize-optimization-steps: 0
[2023-06-24 16:55:26] [config] quiet: false
[2023-06-24 16:55:26] [config] quiet-translation: true
[2023-06-24 16:55:26] [config] relative-paths: false
[2023-06-24 16:55:26] [config] right-left: false
[2023-06-24 16:55:26] [config] save-freq: 10000u
[2023-06-24 16:55:26] [config] seed: 1234
[2023-06-24 16:55:26] [config] sentencepiece-alphas:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] sentencepiece-max-lines: 2000000
[2023-06-24 16:55:26] [config] sentencepiece-options: ""
[2023-06-24 16:55:26] [config] sharding: global
[2023-06-24 16:55:26] [config] shuffle: data
[2023-06-24 16:55:26] [config] shuffle-in-ram: false
[2023-06-24 16:55:26] [config] sigterm: save-and-exit
[2023-06-24 16:55:26] [config] skip: false
[2023-06-24 16:55:26] [config] sqlite: ""
[2023-06-24 16:55:26] [config] sqlite-drop: false
[2023-06-24 16:55:26] [config] sync-freq: 200u
[2023-06-24 16:55:26] [config] sync-sgd: true
[2023-06-24 16:55:26] [config] tempdir: /tmp
[2023-06-24 16:55:26] [config] tied-embeddings: false
[2023-06-24 16:55:26] [config] tied-embeddings-all: false
[2023-06-24 16:55:26] [config] tied-embeddings-src: false
[2023-06-24 16:55:26] [config] train-embedder-rank:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] train-sets:
[2023-06-24 16:55:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 16:55:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 16:55:26] [config] transformer-aan-activation: swish
[2023-06-24 16:55:26] [config] transformer-aan-depth: 2
[2023-06-24 16:55:26] [config] transformer-aan-nogate: false
[2023-06-24 16:55:26] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 16:55:26] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 16:55:26] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 16:55:26] [config] transformer-depth-scaling: false
[2023-06-24 16:55:26] [config] transformer-dim-aan: 2048
[2023-06-24 16:55:26] [config] transformer-dim-ffn: 2048
[2023-06-24 16:55:26] [config] transformer-dropout: 0
[2023-06-24 16:55:26] [config] transformer-dropout-attention: 0
[2023-06-24 16:55:26] [config] transformer-dropout-ffn: 0
[2023-06-24 16:55:26] [config] transformer-ffn-activation: swish
[2023-06-24 16:55:26] [config] transformer-ffn-depth: 2
[2023-06-24 16:55:26] [config] transformer-guided-alignment-layer: last
[2023-06-24 16:55:26] [config] transformer-heads: 8
[2023-06-24 16:55:26] [config] transformer-no-projection: false
[2023-06-24 16:55:26] [config] transformer-pool: false
[2023-06-24 16:55:26] [config] transformer-postprocess: dan
[2023-06-24 16:55:26] [config] transformer-postprocess-emb: d
[2023-06-24 16:55:26] [config] transformer-postprocess-top: ""
[2023-06-24 16:55:26] [config] transformer-preprocess: ""
[2023-06-24 16:55:26] [config] transformer-tied-layers:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] transformer-train-position-embeddings: false
[2023-06-24 16:55:26] [config] tsv: false
[2023-06-24 16:55:26] [config] tsv-fields: 0
[2023-06-24 16:55:26] [config] type: s2s
[2023-06-24 16:55:26] [config] ulr: false
[2023-06-24 16:55:26] [config] ulr-dim-emb: 0
[2023-06-24 16:55:26] [config] ulr-dropout: 0
[2023-06-24 16:55:26] [config] ulr-keys-vectors: ""
[2023-06-24 16:55:26] [config] ulr-query-vectors: ""
[2023-06-24 16:55:26] [config] ulr-softmax-temperature: 1
[2023-06-24 16:55:26] [config] ulr-trainable-transformation: false
[2023-06-24 16:55:26] [config] unlikelihood-loss: false
[2023-06-24 16:55:26] [config] valid-freq: 5000000
[2023-06-24 16:55:26] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 16:55:26] [config] valid-max-length: 1000
[2023-06-24 16:55:26] [config] valid-metrics:
[2023-06-24 16:55:26] [config]   - cross-entropy
[2023-06-24 16:55:26] [config]   - translation
[2023-06-24 16:55:26] [config] valid-mini-batch: 32
[2023-06-24 16:55:26] [config] valid-reset-stalled: false
[2023-06-24 16:55:26] [config] valid-script-args:
[2023-06-24 16:55:26] [config]   []
[2023-06-24 16:55:26] [config] valid-script-path: ""
[2023-06-24 16:55:26] [config] valid-sets:
[2023-06-24 16:55:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 16:55:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 16:55:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 16:55:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 16:55:26] [config] vocabs:
[2023-06-24 16:55:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 16:55:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 16:55:26] [config] word-penalty: 0
[2023-06-24 16:55:26] [config] word-scores: false
[2023-06-24 16:55:26] [config] workspace: 2048
[2023-06-24 16:55:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 16:55:26] Using synchronous SGD
[2023-06-24 16:55:27] Synced seed 1234
[2023-06-24 16:55:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 16:55:27] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 16:55:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 16:55:27] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 16:55:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 16:55:27] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 16:55:28] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 16:55:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 16:55:28] [comm] Using global sharding
[2023-06-24 16:55:28] [comm] NCCLCommunicators constructed successfully
[2023-06-24 16:55:28] [training] Using 1 GPUs
[2023-06-24 16:55:28] [logits] Applying loss function for 1 factor(s)
[2023-06-24 16:55:28] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:55:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 16:55:29] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:55:50] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 16:55:50] [valid] No post-processing script given for validating translator
[2023-06-24 16:55:50] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 16:55:50] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 16:55:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 16:55:50] [comm] Using global sharding
[2023-06-24 16:55:50] [comm] NCCLCommunicators constructed successfully
[2023-06-24 16:55:50] [training] Using 1 GPUs
[2023-06-24 16:55:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 16:55:55] Allocating memory for general optimizer shards
[2023-06-24 16:55:55] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:55:55] Loading Adam parameters
[2023-06-24 16:55:55] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 16:55:55] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:55:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 16:55:56] [data] Restoring the corpus state to epoch 61, batch 19800
[2023-06-24 16:55:56] [data] Shuffling data
[2023-06-24 16:55:56] [data] Done reading 20,192 sentences
[2023-06-24 16:55:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 16:55:56] Training started
[2023-06-24 16:55:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 16:55:56] [memory] Reserving 521 MB, device gpu0
[2023-06-24 16:55:56] Parameter type float32, optimization type float32, casting types false
[2023-06-24 16:57:12] Ep. 61 : Up. 20000 : Sen. 12,910 : Cost 1.50186837 : Time 82.13s : 17644.43 words/s : gNorm 0.2636
[2023-06-24 16:57:12] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.iter20000.npz
[2023-06-24 16:57:17] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 16:57:23] Saving Adam parameters
[2023-06-24 16:57:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 16:58:31] Seen 20,177 samples
[2023-06-24 16:58:31] Starting data epoch 62 in logical epoch 62
[2023-06-24 16:58:31] [data] Shuffling data
[2023-06-24 16:58:31] [data] Done reading 20,192 sentences
[2023-06-24 16:58:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:00:43] Seen 20,177 samples
[2023-06-24 17:00:43] Starting data epoch 63 in logical epoch 63
[2023-06-24 17:00:43] [data] Shuffling data
[2023-06-24 17:00:43] [data] Done reading 20,192 sentences
[2023-06-24 17:00:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:02:54] Seen 20,177 samples
[2023-06-24 17:02:54] Starting data epoch 64 in logical epoch 64
[2023-06-24 17:02:54] [data] Shuffling data
[2023-06-24 17:02:54] [data] Done reading 20,192 sentences
[2023-06-24 17:02:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:04:14] Ep. 64 : Up. 21000 : Sen. 12,847 : Cost 1.49745631 : Time 422.35s : 3431.41 words/s : gNorm 0.2586
[2023-06-24 17:05:04] Seen 20,177 samples
[2023-06-24 17:05:04] Starting data epoch 65 in logical epoch 65
[2023-06-24 17:05:04] [data] Shuffling data
[2023-06-24 17:05:04] [data] Done reading 20,192 sentences
[2023-06-24 17:05:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:07:15] Seen 20,177 samples
[2023-06-24 17:07:15] Starting data epoch 66 in logical epoch 66
[2023-06-24 17:07:15] [data] Shuffling data
[2023-06-24 17:07:15] [data] Done reading 20,192 sentences
[2023-06-24 17:07:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:09:26] Seen 20,177 samples
[2023-06-24 17:09:26] Starting data epoch 67 in logical epoch 67
[2023-06-24 17:09:26] [data] Shuffling data
[2023-06-24 17:09:26] [data] Done reading 20,192 sentences
[2023-06-24 17:09:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:10:53] Ep. 67 : Up. 22000 : Sen. 13,439 : Cost 1.49134612 : Time 398.96s : 3632.92 words/s : gNorm 0.2513
[2023-06-24 17:11:38] Seen 20,177 samples
[2023-06-24 17:11:38] Starting data epoch 68 in logical epoch 68
[2023-06-24 17:11:38] [data] Shuffling data
[2023-06-24 17:11:38] [data] Done reading 20,192 sentences
[2023-06-24 17:11:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:13:49] Seen 20,177 samples
[2023-06-24 17:13:49] Starting data epoch 69 in logical epoch 69
[2023-06-24 17:13:49] [data] Shuffling data
[2023-06-24 17:13:49] [data] Done reading 20,192 sentences
[2023-06-24 17:13:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:16:00] Seen 20,177 samples
[2023-06-24 17:16:00] Starting data epoch 70 in logical epoch 70
[2023-06-24 17:16:00] [data] Shuffling data
[2023-06-24 17:16:00] [data] Done reading 20,192 sentences
[2023-06-24 17:16:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:17:32] Ep. 70 : Up. 23000 : Sen. 13,875 : Cost 1.48691571 : Time 398.64s : 3638.06 words/s : gNorm 0.2474
[2023-06-24 17:18:11] Seen 20,177 samples
[2023-06-24 17:18:11] Starting data epoch 71 in logical epoch 71
[2023-06-24 17:18:11] Training finished
[2023-06-24 17:18:23] [valid] Ep. 71 : Up. 23100 : cross-entropy : 108.748 : stalled 6 times (last best: 94.2576)
[2023-06-24 17:21:48] [valid] Ep. 71 : Up. 23100 : translation : 0 : new best
[2023-06-24 17:21:48] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 17:21:53] Saving Adam parameters
[2023-06-24 17:21:55] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 17:29:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 17:29:38] [marian] Running on node07.datos.cluster.uy as process 24361 with command line:
[2023-06-24 17:29:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 17:29:38] [config] after: 0e
[2023-06-24 17:29:38] [config] after-batches: 0
[2023-06-24 17:29:38] [config] after-epochs: 80
[2023-06-24 17:29:38] [config] all-caps-every: 0
[2023-06-24 17:29:38] [config] allow-unk: false
[2023-06-24 17:29:38] [config] authors: false
[2023-06-24 17:29:38] [config] beam-size: 12
[2023-06-24 17:29:38] [config] bert-class-symbol: "[CLS]"
[2023-06-24 17:29:38] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 17:29:38] [config] bert-masking-fraction: 0.15
[2023-06-24 17:29:38] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 17:29:38] [config] bert-train-type-embeddings: true
[2023-06-24 17:29:38] [config] bert-type-vocab-size: 2
[2023-06-24 17:29:38] [config] build-info: ""
[2023-06-24 17:29:38] [config] check-gradient-nan: false
[2023-06-24 17:29:38] [config] check-nan: false
[2023-06-24 17:29:38] [config] cite: false
[2023-06-24 17:29:38] [config] clip-norm: 5
[2023-06-24 17:29:38] [config] cost-scaling:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] cost-type: ce-mean-words
[2023-06-24 17:29:38] [config] cpu-threads: 0
[2023-06-24 17:29:38] [config] data-threads: 8
[2023-06-24 17:29:38] [config] data-weighting: ""
[2023-06-24 17:29:38] [config] data-weighting-type: sentence
[2023-06-24 17:29:38] [config] dec-cell: gru
[2023-06-24 17:29:38] [config] dec-cell-base-depth: 8
[2023-06-24 17:29:38] [config] dec-cell-high-depth: 1
[2023-06-24 17:29:38] [config] dec-depth: 1
[2023-06-24 17:29:38] [config] devices:
[2023-06-24 17:29:38] [config]   - 0
[2023-06-24 17:29:38] [config] dim-emb: 512
[2023-06-24 17:29:38] [config] dim-rnn: 1024
[2023-06-24 17:29:38] [config] dim-vocabs:
[2023-06-24 17:29:38] [config]   - 54042
[2023-06-24 17:29:38] [config]   - 36507
[2023-06-24 17:29:38] [config] disp-first: 0
[2023-06-24 17:29:38] [config] disp-freq: 1000u
[2023-06-24 17:29:38] [config] disp-label-counts: true
[2023-06-24 17:29:38] [config] dropout-rnn: 0.1
[2023-06-24 17:29:38] [config] dropout-src: 0
[2023-06-24 17:29:38] [config] dropout-trg: 0
[2023-06-24 17:29:38] [config] dump-config: ""
[2023-06-24 17:29:38] [config] dynamic-gradient-scaling:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] early-stopping: 10
[2023-06-24 17:29:38] [config] early-stopping-on: first
[2023-06-24 17:29:38] [config] embedding-fix-src: false
[2023-06-24 17:29:38] [config] embedding-fix-trg: false
[2023-06-24 17:29:38] [config] embedding-normalization: false
[2023-06-24 17:29:38] [config] embedding-vectors:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] enc-cell: gru
[2023-06-24 17:29:38] [config] enc-cell-depth: 4
[2023-06-24 17:29:38] [config] enc-depth: 1
[2023-06-24 17:29:38] [config] enc-type: bidirectional
[2023-06-24 17:29:38] [config] english-title-case-every: 0
[2023-06-24 17:29:38] [config] exponential-smoothing: 0.0001
[2023-06-24 17:29:38] [config] factor-weight: 1
[2023-06-24 17:29:38] [config] factors-combine: sum
[2023-06-24 17:29:38] [config] factors-dim-emb: 0
[2023-06-24 17:29:38] [config] gradient-checkpointing: false
[2023-06-24 17:29:38] [config] gradient-norm-average-window: 100
[2023-06-24 17:29:38] [config] guided-alignment: none
[2023-06-24 17:29:38] [config] guided-alignment-cost: mse
[2023-06-24 17:29:38] [config] guided-alignment-weight: 0.1
[2023-06-24 17:29:38] [config] ignore-model-config: false
[2023-06-24 17:29:38] [config] input-types:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] interpolate-env-vars: false
[2023-06-24 17:29:38] [config] keep-best: false
[2023-06-24 17:29:38] [config] label-smoothing: 0.1
[2023-06-24 17:29:38] [config] layer-normalization: true
[2023-06-24 17:29:38] [config] learn-rate: 0.0003
[2023-06-24 17:29:38] [config] lemma-dependency: ""
[2023-06-24 17:29:38] [config] lemma-dim-emb: 0
[2023-06-24 17:29:38] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 17:29:38] [config] log-level: info
[2023-06-24 17:29:38] [config] log-time-zone: ""
[2023-06-24 17:29:38] [config] logical-epoch:
[2023-06-24 17:29:38] [config]   - 1e
[2023-06-24 17:29:38] [config]   - 0
[2023-06-24 17:29:38] [config] lr-decay: 0
[2023-06-24 17:29:38] [config] lr-decay-freq: 50000
[2023-06-24 17:29:38] [config] lr-decay-inv-sqrt:
[2023-06-24 17:29:38] [config]   - 16000
[2023-06-24 17:29:38] [config] lr-decay-repeat-warmup: false
[2023-06-24 17:29:38] [config] lr-decay-reset-optimizer: false
[2023-06-24 17:29:38] [config] lr-decay-start:
[2023-06-24 17:29:38] [config]   - 10
[2023-06-24 17:29:38] [config]   - 1
[2023-06-24 17:29:38] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 17:29:38] [config] lr-report: false
[2023-06-24 17:29:38] [config] lr-warmup: 0
[2023-06-24 17:29:38] [config] lr-warmup-at-reload: false
[2023-06-24 17:29:38] [config] lr-warmup-cycle: false
[2023-06-24 17:29:38] [config] lr-warmup-start-rate: 0
[2023-06-24 17:29:38] [config] max-length: 100
[2023-06-24 17:29:38] [config] max-length-crop: false
[2023-06-24 17:29:38] [config] max-length-factor: 3
[2023-06-24 17:29:38] [config] maxi-batch: 1000
[2023-06-24 17:29:38] [config] maxi-batch-sort: trg
[2023-06-24 17:29:38] [config] mini-batch: 1000
[2023-06-24 17:29:38] [config] mini-batch-fit: true
[2023-06-24 17:29:38] [config] mini-batch-fit-step: 10
[2023-06-24 17:29:38] [config] mini-batch-round-up: true
[2023-06-24 17:29:38] [config] mini-batch-track-lr: false
[2023-06-24 17:29:38] [config] mini-batch-warmup: 0
[2023-06-24 17:29:38] [config] mini-batch-words: 0
[2023-06-24 17:29:38] [config] mini-batch-words-ref: 0
[2023-06-24 17:29:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 17:29:38] [config] multi-loss-type: sum
[2023-06-24 17:29:38] [config] n-best: false
[2023-06-24 17:29:38] [config] no-nccl: false
[2023-06-24 17:29:38] [config] no-reload: false
[2023-06-24 17:29:38] [config] no-restore-corpus: false
[2023-06-24 17:29:38] [config] normalize: 1
[2023-06-24 17:29:38] [config] normalize-gradient: false
[2023-06-24 17:29:38] [config] num-devices: 0
[2023-06-24 17:29:38] [config] optimizer: adam
[2023-06-24 17:29:38] [config] optimizer-delay: 1
[2023-06-24 17:29:38] [config] optimizer-params:
[2023-06-24 17:29:38] [config]   - 0.9
[2023-06-24 17:29:38] [config]   - 0.98
[2023-06-24 17:29:38] [config]   - 1e-09
[2023-06-24 17:29:38] [config] output-omit-bias: false
[2023-06-24 17:29:38] [config] overwrite: false
[2023-06-24 17:29:38] [config] precision:
[2023-06-24 17:29:38] [config]   - float32
[2023-06-24 17:29:38] [config]   - float32
[2023-06-24 17:29:38] [config] pretrained-model: ""
[2023-06-24 17:29:38] [config] quantize-biases: false
[2023-06-24 17:29:38] [config] quantize-bits: 0
[2023-06-24 17:29:38] [config] quantize-log-based: false
[2023-06-24 17:29:38] [config] quantize-optimization-steps: 0
[2023-06-24 17:29:38] [config] quiet: false
[2023-06-24 17:29:38] [config] quiet-translation: true
[2023-06-24 17:29:38] [config] relative-paths: false
[2023-06-24 17:29:38] [config] right-left: false
[2023-06-24 17:29:38] [config] save-freq: 10000u
[2023-06-24 17:29:38] [config] seed: 1234
[2023-06-24 17:29:38] [config] sentencepiece-alphas:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] sentencepiece-max-lines: 2000000
[2023-06-24 17:29:38] [config] sentencepiece-options: ""
[2023-06-24 17:29:38] [config] sharding: global
[2023-06-24 17:29:38] [config] shuffle: data
[2023-06-24 17:29:38] [config] shuffle-in-ram: false
[2023-06-24 17:29:38] [config] sigterm: save-and-exit
[2023-06-24 17:29:38] [config] skip: false
[2023-06-24 17:29:38] [config] sqlite: ""
[2023-06-24 17:29:38] [config] sqlite-drop: false
[2023-06-24 17:29:38] [config] sync-freq: 200u
[2023-06-24 17:29:38] [config] sync-sgd: true
[2023-06-24 17:29:38] [config] tempdir: /tmp
[2023-06-24 17:29:38] [config] tied-embeddings: false
[2023-06-24 17:29:38] [config] tied-embeddings-all: false
[2023-06-24 17:29:38] [config] tied-embeddings-src: false
[2023-06-24 17:29:38] [config] train-embedder-rank:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] train-sets:
[2023-06-24 17:29:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 17:29:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 17:29:38] [config] transformer-aan-activation: swish
[2023-06-24 17:29:38] [config] transformer-aan-depth: 2
[2023-06-24 17:29:38] [config] transformer-aan-nogate: false
[2023-06-24 17:29:38] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 17:29:38] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 17:29:38] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 17:29:38] [config] transformer-depth-scaling: false
[2023-06-24 17:29:38] [config] transformer-dim-aan: 2048
[2023-06-24 17:29:38] [config] transformer-dim-ffn: 2048
[2023-06-24 17:29:38] [config] transformer-dropout: 0
[2023-06-24 17:29:38] [config] transformer-dropout-attention: 0
[2023-06-24 17:29:38] [config] transformer-dropout-ffn: 0
[2023-06-24 17:29:38] [config] transformer-ffn-activation: swish
[2023-06-24 17:29:38] [config] transformer-ffn-depth: 2
[2023-06-24 17:29:38] [config] transformer-guided-alignment-layer: last
[2023-06-24 17:29:38] [config] transformer-heads: 8
[2023-06-24 17:29:38] [config] transformer-no-projection: false
[2023-06-24 17:29:38] [config] transformer-pool: false
[2023-06-24 17:29:38] [config] transformer-postprocess: dan
[2023-06-24 17:29:38] [config] transformer-postprocess-emb: d
[2023-06-24 17:29:38] [config] transformer-postprocess-top: ""
[2023-06-24 17:29:38] [config] transformer-preprocess: ""
[2023-06-24 17:29:38] [config] transformer-tied-layers:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] transformer-train-position-embeddings: false
[2023-06-24 17:29:38] [config] tsv: false
[2023-06-24 17:29:38] [config] tsv-fields: 0
[2023-06-24 17:29:38] [config] type: s2s
[2023-06-24 17:29:38] [config] ulr: false
[2023-06-24 17:29:38] [config] ulr-dim-emb: 0
[2023-06-24 17:29:38] [config] ulr-dropout: 0
[2023-06-24 17:29:38] [config] ulr-keys-vectors: ""
[2023-06-24 17:29:38] [config] ulr-query-vectors: ""
[2023-06-24 17:29:38] [config] ulr-softmax-temperature: 1
[2023-06-24 17:29:38] [config] ulr-trainable-transformation: false
[2023-06-24 17:29:38] [config] unlikelihood-loss: false
[2023-06-24 17:29:38] [config] valid-freq: 5000000
[2023-06-24 17:29:38] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 17:29:38] [config] valid-max-length: 1000
[2023-06-24 17:29:38] [config] valid-metrics:
[2023-06-24 17:29:38] [config]   - cross-entropy
[2023-06-24 17:29:38] [config]   - translation
[2023-06-24 17:29:38] [config] valid-mini-batch: 32
[2023-06-24 17:29:38] [config] valid-reset-stalled: false
[2023-06-24 17:29:38] [config] valid-script-args:
[2023-06-24 17:29:38] [config]   []
[2023-06-24 17:29:38] [config] valid-script-path: ""
[2023-06-24 17:29:38] [config] valid-sets:
[2023-06-24 17:29:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 17:29:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 17:29:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 17:29:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 17:29:38] [config] vocabs:
[2023-06-24 17:29:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 17:29:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 17:29:38] [config] word-penalty: 0
[2023-06-24 17:29:38] [config] word-scores: false
[2023-06-24 17:29:38] [config] workspace: 2048
[2023-06-24 17:29:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 17:29:38] Using synchronous SGD
[2023-06-24 17:29:39] Synced seed 1234
[2023-06-24 17:29:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 17:29:39] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 17:29:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 17:29:39] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 17:29:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 17:29:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 17:29:39] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 17:29:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 17:29:39] [comm] Using global sharding
[2023-06-24 17:29:39] [comm] NCCLCommunicators constructed successfully
[2023-06-24 17:29:39] [training] Using 1 GPUs
[2023-06-24 17:29:39] [logits] Applying loss function for 1 factor(s)
[2023-06-24 17:29:39] [memory] Reserving 521 MB, device gpu0
[2023-06-24 17:29:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 17:29:40] [memory] Reserving 521 MB, device gpu0
[2023-06-24 17:30:02] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 17:30:02] [valid] No post-processing script given for validating translator
[2023-06-24 17:30:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 17:30:02] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 17:30:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 17:30:02] [comm] Using global sharding
[2023-06-24 17:30:02] [comm] NCCLCommunicators constructed successfully
[2023-06-24 17:30:02] [training] Using 1 GPUs
[2023-06-24 17:30:02] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 17:30:07] Allocating memory for general optimizer shards
[2023-06-24 17:30:07] [memory] Reserving 521 MB, device gpu0
[2023-06-24 17:30:07] Loading Adam parameters
[2023-06-24 17:30:07] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 17:30:07] [memory] Reserving 521 MB, device gpu0
[2023-06-24 17:30:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 17:30:08] [data] Restoring the corpus state to epoch 71, batch 23100
[2023-06-24 17:30:08] [data] Shuffling data
[2023-06-24 17:30:08] [data] Done reading 20,192 sentences
[2023-06-24 17:30:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:30:08] Training started
[2023-06-24 17:30:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 17:30:08] [memory] Reserving 521 MB, device gpu0
[2023-06-24 17:30:08] Parameter type float32, optimization type float32, casting types false
[2023-06-24 17:32:17] Seen 20,177 samples
[2023-06-24 17:32:17] Starting data epoch 72 in logical epoch 72
[2023-06-24 17:32:17] [data] Shuffling data
[2023-06-24 17:32:17] [data] Done reading 20,192 sentences
[2023-06-24 17:32:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:34:27] Seen 20,177 samples
[2023-06-24 17:34:27] Starting data epoch 73 in logical epoch 73
[2023-06-24 17:34:27] [data] Shuffling data
[2023-06-24 17:34:27] [data] Done reading 20,192 sentences
[2023-06-24 17:34:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:35:59] Ep. 73 : Up. 24000 : Sen. 15,531 : Cost 1.48282933 : Time 357.13s : 4039.37 words/s : gNorm 0.2427
[2023-06-24 17:36:38] Seen 20,177 samples
[2023-06-24 17:36:38] Starting data epoch 74 in logical epoch 74
[2023-06-24 17:36:38] [data] Shuffling data
[2023-06-24 17:36:38] [data] Done reading 20,192 sentences
[2023-06-24 17:36:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:38:49] Seen 20,177 samples
[2023-06-24 17:38:49] Starting data epoch 75 in logical epoch 75
[2023-06-24 17:38:49] [data] Shuffling data
[2023-06-24 17:38:49] [data] Done reading 20,192 sentences
[2023-06-24 17:38:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:40:59] Seen 20,177 samples
[2023-06-24 17:40:59] Starting data epoch 76 in logical epoch 76
[2023-06-24 17:40:59] [data] Shuffling data
[2023-06-24 17:40:59] [data] Done reading 20,192 sentences
[2023-06-24 17:40:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:42:39] Ep. 76 : Up. 25000 : Sen. 15,153 : Cost 1.48060763 : Time 399.58s : 3639.45 words/s : gNorm 0.2238
[2023-06-24 17:43:10] Seen 20,177 samples
[2023-06-24 17:43:10] Starting data epoch 77 in logical epoch 77
[2023-06-24 17:43:10] [data] Shuffling data
[2023-06-24 17:43:10] [data] Done reading 20,192 sentences
[2023-06-24 17:43:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:45:21] Seen 20,177 samples
[2023-06-24 17:45:21] Starting data epoch 78 in logical epoch 78
[2023-06-24 17:45:21] [data] Shuffling data
[2023-06-24 17:45:21] [data] Done reading 20,192 sentences
[2023-06-24 17:45:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:47:32] Seen 20,177 samples
[2023-06-24 17:47:32] Starting data epoch 79 in logical epoch 79
[2023-06-24 17:47:32] [data] Shuffling data
[2023-06-24 17:47:32] [data] Done reading 20,192 sentences
[2023-06-24 17:47:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:49:15] Ep. 79 : Up. 26000 : Sen. 16,211 : Cost 1.47759604 : Time 395.88s : 3646.97 words/s : gNorm 0.2256
[2023-06-24 17:49:43] Seen 20,177 samples
[2023-06-24 17:49:43] Starting data epoch 80 in logical epoch 80
[2023-06-24 17:49:43] [data] Shuffling data
[2023-06-24 17:49:43] [data] Done reading 20,192 sentences
[2023-06-24 17:49:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 17:51:55] Seen 20,177 samples
[2023-06-24 17:51:55] Starting data epoch 81 in logical epoch 81
[2023-06-24 17:51:55] Training finished
[2023-06-24 17:52:07] [valid] Ep. 81 : Up. 26400 : cross-entropy : 109.714 : stalled 7 times (last best: 94.2576)
[2023-06-24 17:55:31] [valid] Ep. 81 : Up. 26400 : translation : 0 : new best
[2023-06-24 17:55:31] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 17:55:37] Saving Adam parameters
[2023-06-24 17:55:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 18:03:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 18:03:20] [marian] Running on node07.datos.cluster.uy as process 26578 with command line:
[2023-06-24 18:03:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 18:03:20] [config] after: 0e
[2023-06-24 18:03:20] [config] after-batches: 0
[2023-06-24 18:03:20] [config] after-epochs: 90
[2023-06-24 18:03:20] [config] all-caps-every: 0
[2023-06-24 18:03:20] [config] allow-unk: false
[2023-06-24 18:03:20] [config] authors: false
[2023-06-24 18:03:20] [config] beam-size: 12
[2023-06-24 18:03:20] [config] bert-class-symbol: "[CLS]"
[2023-06-24 18:03:20] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 18:03:20] [config] bert-masking-fraction: 0.15
[2023-06-24 18:03:20] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 18:03:20] [config] bert-train-type-embeddings: true
[2023-06-24 18:03:20] [config] bert-type-vocab-size: 2
[2023-06-24 18:03:20] [config] build-info: ""
[2023-06-24 18:03:20] [config] check-gradient-nan: false
[2023-06-24 18:03:20] [config] check-nan: false
[2023-06-24 18:03:20] [config] cite: false
[2023-06-24 18:03:20] [config] clip-norm: 5
[2023-06-24 18:03:20] [config] cost-scaling:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] cost-type: ce-mean-words
[2023-06-24 18:03:20] [config] cpu-threads: 0
[2023-06-24 18:03:20] [config] data-threads: 8
[2023-06-24 18:03:20] [config] data-weighting: ""
[2023-06-24 18:03:20] [config] data-weighting-type: sentence
[2023-06-24 18:03:20] [config] dec-cell: gru
[2023-06-24 18:03:20] [config] dec-cell-base-depth: 8
[2023-06-24 18:03:20] [config] dec-cell-high-depth: 1
[2023-06-24 18:03:20] [config] dec-depth: 1
[2023-06-24 18:03:20] [config] devices:
[2023-06-24 18:03:20] [config]   - 0
[2023-06-24 18:03:20] [config] dim-emb: 512
[2023-06-24 18:03:20] [config] dim-rnn: 1024
[2023-06-24 18:03:20] [config] dim-vocabs:
[2023-06-24 18:03:20] [config]   - 54042
[2023-06-24 18:03:20] [config]   - 36507
[2023-06-24 18:03:20] [config] disp-first: 0
[2023-06-24 18:03:20] [config] disp-freq: 1000u
[2023-06-24 18:03:20] [config] disp-label-counts: true
[2023-06-24 18:03:20] [config] dropout-rnn: 0.1
[2023-06-24 18:03:20] [config] dropout-src: 0
[2023-06-24 18:03:20] [config] dropout-trg: 0
[2023-06-24 18:03:20] [config] dump-config: ""
[2023-06-24 18:03:20] [config] dynamic-gradient-scaling:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] early-stopping: 10
[2023-06-24 18:03:20] [config] early-stopping-on: first
[2023-06-24 18:03:20] [config] embedding-fix-src: false
[2023-06-24 18:03:20] [config] embedding-fix-trg: false
[2023-06-24 18:03:20] [config] embedding-normalization: false
[2023-06-24 18:03:20] [config] embedding-vectors:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] enc-cell: gru
[2023-06-24 18:03:20] [config] enc-cell-depth: 4
[2023-06-24 18:03:20] [config] enc-depth: 1
[2023-06-24 18:03:20] [config] enc-type: bidirectional
[2023-06-24 18:03:20] [config] english-title-case-every: 0
[2023-06-24 18:03:20] [config] exponential-smoothing: 0.0001
[2023-06-24 18:03:20] [config] factor-weight: 1
[2023-06-24 18:03:20] [config] factors-combine: sum
[2023-06-24 18:03:20] [config] factors-dim-emb: 0
[2023-06-24 18:03:20] [config] gradient-checkpointing: false
[2023-06-24 18:03:20] [config] gradient-norm-average-window: 100
[2023-06-24 18:03:20] [config] guided-alignment: none
[2023-06-24 18:03:20] [config] guided-alignment-cost: mse
[2023-06-24 18:03:20] [config] guided-alignment-weight: 0.1
[2023-06-24 18:03:20] [config] ignore-model-config: false
[2023-06-24 18:03:20] [config] input-types:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] interpolate-env-vars: false
[2023-06-24 18:03:20] [config] keep-best: false
[2023-06-24 18:03:20] [config] label-smoothing: 0.1
[2023-06-24 18:03:20] [config] layer-normalization: true
[2023-06-24 18:03:20] [config] learn-rate: 0.0003
[2023-06-24 18:03:20] [config] lemma-dependency: ""
[2023-06-24 18:03:20] [config] lemma-dim-emb: 0
[2023-06-24 18:03:20] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 18:03:20] [config] log-level: info
[2023-06-24 18:03:20] [config] log-time-zone: ""
[2023-06-24 18:03:20] [config] logical-epoch:
[2023-06-24 18:03:20] [config]   - 1e
[2023-06-24 18:03:20] [config]   - 0
[2023-06-24 18:03:20] [config] lr-decay: 0
[2023-06-24 18:03:20] [config] lr-decay-freq: 50000
[2023-06-24 18:03:20] [config] lr-decay-inv-sqrt:
[2023-06-24 18:03:20] [config]   - 16000
[2023-06-24 18:03:20] [config] lr-decay-repeat-warmup: false
[2023-06-24 18:03:20] [config] lr-decay-reset-optimizer: false
[2023-06-24 18:03:20] [config] lr-decay-start:
[2023-06-24 18:03:20] [config]   - 10
[2023-06-24 18:03:20] [config]   - 1
[2023-06-24 18:03:20] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 18:03:20] [config] lr-report: false
[2023-06-24 18:03:20] [config] lr-warmup: 0
[2023-06-24 18:03:20] [config] lr-warmup-at-reload: false
[2023-06-24 18:03:20] [config] lr-warmup-cycle: false
[2023-06-24 18:03:20] [config] lr-warmup-start-rate: 0
[2023-06-24 18:03:20] [config] max-length: 100
[2023-06-24 18:03:20] [config] max-length-crop: false
[2023-06-24 18:03:20] [config] max-length-factor: 3
[2023-06-24 18:03:20] [config] maxi-batch: 1000
[2023-06-24 18:03:20] [config] maxi-batch-sort: trg
[2023-06-24 18:03:20] [config] mini-batch: 1000
[2023-06-24 18:03:20] [config] mini-batch-fit: true
[2023-06-24 18:03:20] [config] mini-batch-fit-step: 10
[2023-06-24 18:03:20] [config] mini-batch-round-up: true
[2023-06-24 18:03:20] [config] mini-batch-track-lr: false
[2023-06-24 18:03:20] [config] mini-batch-warmup: 0
[2023-06-24 18:03:20] [config] mini-batch-words: 0
[2023-06-24 18:03:20] [config] mini-batch-words-ref: 0
[2023-06-24 18:03:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 18:03:20] [config] multi-loss-type: sum
[2023-06-24 18:03:20] [config] n-best: false
[2023-06-24 18:03:20] [config] no-nccl: false
[2023-06-24 18:03:20] [config] no-reload: false
[2023-06-24 18:03:20] [config] no-restore-corpus: false
[2023-06-24 18:03:20] [config] normalize: 1
[2023-06-24 18:03:20] [config] normalize-gradient: false
[2023-06-24 18:03:20] [config] num-devices: 0
[2023-06-24 18:03:20] [config] optimizer: adam
[2023-06-24 18:03:20] [config] optimizer-delay: 1
[2023-06-24 18:03:20] [config] optimizer-params:
[2023-06-24 18:03:20] [config]   - 0.9
[2023-06-24 18:03:20] [config]   - 0.98
[2023-06-24 18:03:20] [config]   - 1e-09
[2023-06-24 18:03:20] [config] output-omit-bias: false
[2023-06-24 18:03:20] [config] overwrite: false
[2023-06-24 18:03:20] [config] precision:
[2023-06-24 18:03:20] [config]   - float32
[2023-06-24 18:03:20] [config]   - float32
[2023-06-24 18:03:20] [config] pretrained-model: ""
[2023-06-24 18:03:20] [config] quantize-biases: false
[2023-06-24 18:03:20] [config] quantize-bits: 0
[2023-06-24 18:03:20] [config] quantize-log-based: false
[2023-06-24 18:03:20] [config] quantize-optimization-steps: 0
[2023-06-24 18:03:20] [config] quiet: false
[2023-06-24 18:03:20] [config] quiet-translation: true
[2023-06-24 18:03:20] [config] relative-paths: false
[2023-06-24 18:03:20] [config] right-left: false
[2023-06-24 18:03:20] [config] save-freq: 10000u
[2023-06-24 18:03:20] [config] seed: 1234
[2023-06-24 18:03:20] [config] sentencepiece-alphas:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] sentencepiece-max-lines: 2000000
[2023-06-24 18:03:20] [config] sentencepiece-options: ""
[2023-06-24 18:03:20] [config] sharding: global
[2023-06-24 18:03:20] [config] shuffle: data
[2023-06-24 18:03:20] [config] shuffle-in-ram: false
[2023-06-24 18:03:20] [config] sigterm: save-and-exit
[2023-06-24 18:03:20] [config] skip: false
[2023-06-24 18:03:20] [config] sqlite: ""
[2023-06-24 18:03:20] [config] sqlite-drop: false
[2023-06-24 18:03:20] [config] sync-freq: 200u
[2023-06-24 18:03:20] [config] sync-sgd: true
[2023-06-24 18:03:20] [config] tempdir: /tmp
[2023-06-24 18:03:20] [config] tied-embeddings: false
[2023-06-24 18:03:20] [config] tied-embeddings-all: false
[2023-06-24 18:03:20] [config] tied-embeddings-src: false
[2023-06-24 18:03:20] [config] train-embedder-rank:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] train-sets:
[2023-06-24 18:03:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 18:03:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 18:03:20] [config] transformer-aan-activation: swish
[2023-06-24 18:03:20] [config] transformer-aan-depth: 2
[2023-06-24 18:03:20] [config] transformer-aan-nogate: false
[2023-06-24 18:03:20] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 18:03:20] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 18:03:20] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 18:03:20] [config] transformer-depth-scaling: false
[2023-06-24 18:03:20] [config] transformer-dim-aan: 2048
[2023-06-24 18:03:20] [config] transformer-dim-ffn: 2048
[2023-06-24 18:03:20] [config] transformer-dropout: 0
[2023-06-24 18:03:20] [config] transformer-dropout-attention: 0
[2023-06-24 18:03:20] [config] transformer-dropout-ffn: 0
[2023-06-24 18:03:20] [config] transformer-ffn-activation: swish
[2023-06-24 18:03:20] [config] transformer-ffn-depth: 2
[2023-06-24 18:03:20] [config] transformer-guided-alignment-layer: last
[2023-06-24 18:03:20] [config] transformer-heads: 8
[2023-06-24 18:03:20] [config] transformer-no-projection: false
[2023-06-24 18:03:20] [config] transformer-pool: false
[2023-06-24 18:03:20] [config] transformer-postprocess: dan
[2023-06-24 18:03:20] [config] transformer-postprocess-emb: d
[2023-06-24 18:03:20] [config] transformer-postprocess-top: ""
[2023-06-24 18:03:20] [config] transformer-preprocess: ""
[2023-06-24 18:03:20] [config] transformer-tied-layers:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] transformer-train-position-embeddings: false
[2023-06-24 18:03:20] [config] tsv: false
[2023-06-24 18:03:20] [config] tsv-fields: 0
[2023-06-24 18:03:20] [config] type: s2s
[2023-06-24 18:03:20] [config] ulr: false
[2023-06-24 18:03:20] [config] ulr-dim-emb: 0
[2023-06-24 18:03:20] [config] ulr-dropout: 0
[2023-06-24 18:03:20] [config] ulr-keys-vectors: ""
[2023-06-24 18:03:20] [config] ulr-query-vectors: ""
[2023-06-24 18:03:20] [config] ulr-softmax-temperature: 1
[2023-06-24 18:03:20] [config] ulr-trainable-transformation: false
[2023-06-24 18:03:20] [config] unlikelihood-loss: false
[2023-06-24 18:03:20] [config] valid-freq: 5000000
[2023-06-24 18:03:20] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 18:03:20] [config] valid-max-length: 1000
[2023-06-24 18:03:20] [config] valid-metrics:
[2023-06-24 18:03:20] [config]   - cross-entropy
[2023-06-24 18:03:20] [config]   - translation
[2023-06-24 18:03:20] [config] valid-mini-batch: 32
[2023-06-24 18:03:20] [config] valid-reset-stalled: false
[2023-06-24 18:03:20] [config] valid-script-args:
[2023-06-24 18:03:20] [config]   []
[2023-06-24 18:03:20] [config] valid-script-path: ""
[2023-06-24 18:03:20] [config] valid-sets:
[2023-06-24 18:03:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 18:03:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 18:03:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 18:03:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 18:03:20] [config] vocabs:
[2023-06-24 18:03:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 18:03:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 18:03:20] [config] word-penalty: 0
[2023-06-24 18:03:20] [config] word-scores: false
[2023-06-24 18:03:20] [config] workspace: 2048
[2023-06-24 18:03:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 18:03:20] Using synchronous SGD
[2023-06-24 18:03:21] Synced seed 1234
[2023-06-24 18:03:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 18:03:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 18:03:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 18:03:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 18:03:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 18:03:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 18:03:22] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 18:03:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 18:03:22] [comm] Using global sharding
[2023-06-24 18:03:22] [comm] NCCLCommunicators constructed successfully
[2023-06-24 18:03:22] [training] Using 1 GPUs
[2023-06-24 18:03:22] [logits] Applying loss function for 1 factor(s)
[2023-06-24 18:03:22] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:03:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 18:03:23] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:03:45] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 18:03:45] [valid] No post-processing script given for validating translator
[2023-06-24 18:03:45] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 18:03:45] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 18:03:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 18:03:45] [comm] Using global sharding
[2023-06-24 18:03:45] [comm] NCCLCommunicators constructed successfully
[2023-06-24 18:03:45] [training] Using 1 GPUs
[2023-06-24 18:03:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 18:03:49] Allocating memory for general optimizer shards
[2023-06-24 18:03:49] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:03:49] Loading Adam parameters
[2023-06-24 18:03:50] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 18:03:50] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:03:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 18:03:50] [data] Restoring the corpus state to epoch 81, batch 26400
[2023-06-24 18:03:50] [data] Shuffling data
[2023-06-24 18:03:50] [data] Done reading 20,192 sentences
[2023-06-24 18:03:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:03:50] Training started
[2023-06-24 18:03:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 18:03:51] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:03:51] Parameter type float32, optimization type float32, casting types false
[2023-06-24 18:06:01] Seen 20,177 samples
[2023-06-24 18:06:01] Starting data epoch 82 in logical epoch 82
[2023-06-24 18:06:01] [data] Shuffling data
[2023-06-24 18:06:01] [data] Done reading 20,192 sentences
[2023-06-24 18:06:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:07:50] Ep. 82 : Up. 27000 : Sen. 16,375 : Cost 1.47437453 : Time 244.84s : 5921.77 words/s : gNorm 0.2288
[2023-06-24 18:08:13] Seen 20,177 samples
[2023-06-24 18:08:13] Starting data epoch 83 in logical epoch 83
[2023-06-24 18:08:13] [data] Shuffling data
[2023-06-24 18:08:13] [data] Done reading 20,192 sentences
[2023-06-24 18:08:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:10:25] Seen 20,177 samples
[2023-06-24 18:10:25] Starting data epoch 84 in logical epoch 84
[2023-06-24 18:10:25] [data] Shuffling data
[2023-06-24 18:10:25] [data] Done reading 20,192 sentences
[2023-06-24 18:10:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:12:36] Seen 20,177 samples
[2023-06-24 18:12:36] Starting data epoch 85 in logical epoch 85
[2023-06-24 18:12:36] [data] Shuffling data
[2023-06-24 18:12:36] [data] Done reading 20,192 sentences
[2023-06-24 18:12:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:14:28] Ep. 85 : Up. 28000 : Sen. 17,046 : Cost 1.47238553 : Time 398.25s : 3631.49 words/s : gNorm 0.2140
[2023-06-24 18:14:48] Seen 20,177 samples
[2023-06-24 18:14:48] Starting data epoch 86 in logical epoch 86
[2023-06-24 18:14:48] [data] Shuffling data
[2023-06-24 18:14:48] [data] Done reading 20,192 sentences
[2023-06-24 18:14:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:16:59] Seen 20,177 samples
[2023-06-24 18:16:59] Starting data epoch 87 in logical epoch 87
[2023-06-24 18:16:59] [data] Shuffling data
[2023-06-24 18:16:59] [data] Done reading 20,192 sentences
[2023-06-24 18:16:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:19:10] Seen 20,177 samples
[2023-06-24 18:19:10] Starting data epoch 88 in logical epoch 88
[2023-06-24 18:19:10] [data] Shuffling data
[2023-06-24 18:19:10] [data] Done reading 20,192 sentences
[2023-06-24 18:19:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:21:05] Ep. 88 : Up. 29000 : Sen. 17,914 : Cost 1.47072327 : Time 397.56s : 3647.77 words/s : gNorm 0.2091
[2023-06-24 18:21:22] Seen 20,177 samples
[2023-06-24 18:21:22] Starting data epoch 89 in logical epoch 89
[2023-06-24 18:21:22] [data] Shuffling data
[2023-06-24 18:21:22] [data] Done reading 20,192 sentences
[2023-06-24 18:21:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:23:33] Seen 20,177 samples
[2023-06-24 18:23:33] Starting data epoch 90 in logical epoch 90
[2023-06-24 18:23:33] [data] Shuffling data
[2023-06-24 18:23:33] [data] Done reading 20,192 sentences
[2023-06-24 18:23:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:25:44] Seen 20,177 samples
[2023-06-24 18:25:44] Starting data epoch 91 in logical epoch 91
[2023-06-24 18:25:44] Training finished
[2023-06-24 18:25:55] [valid] Ep. 91 : Up. 29700 : cross-entropy : 110.558 : stalled 8 times (last best: 94.2576)
[2023-06-24 18:28:58] [valid] Ep. 91 : Up. 29700 : translation : 0 : new best
[2023-06-24 18:28:58] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 18:29:04] Saving Adam parameters
[2023-06-24 18:29:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 18:36:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 18:36:38] [marian] Running on node07.datos.cluster.uy as process 28898 with command line:
[2023-06-24 18:36:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type s2s --max-length 100 --mini-batch-fit --mini-batch 1000 --maxi-batch 1000 --beam-size 12 --normalize 1 --cost-type ce-mean-words --enc-type bidirectional --enc-depth 1 --enc-cell-depth 4 --dec-depth 1 --dec-cell-base-depth 8 --dec-cell-high-depth 1 --layer-normalization --dropout-rnn 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-decay-inv-sqrt 16000 --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --sync-sgd --exponential-smoothing --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-24 18:36:38] [config] after: 0e
[2023-06-24 18:36:38] [config] after-batches: 0
[2023-06-24 18:36:38] [config] after-epochs: 100
[2023-06-24 18:36:38] [config] all-caps-every: 0
[2023-06-24 18:36:38] [config] allow-unk: false
[2023-06-24 18:36:38] [config] authors: false
[2023-06-24 18:36:38] [config] beam-size: 12
[2023-06-24 18:36:38] [config] bert-class-symbol: "[CLS]"
[2023-06-24 18:36:38] [config] bert-mask-symbol: "[MASK]"
[2023-06-24 18:36:38] [config] bert-masking-fraction: 0.15
[2023-06-24 18:36:38] [config] bert-sep-symbol: "[SEP]"
[2023-06-24 18:36:38] [config] bert-train-type-embeddings: true
[2023-06-24 18:36:38] [config] bert-type-vocab-size: 2
[2023-06-24 18:36:38] [config] build-info: ""
[2023-06-24 18:36:38] [config] check-gradient-nan: false
[2023-06-24 18:36:38] [config] check-nan: false
[2023-06-24 18:36:38] [config] cite: false
[2023-06-24 18:36:38] [config] clip-norm: 5
[2023-06-24 18:36:38] [config] cost-scaling:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] cost-type: ce-mean-words
[2023-06-24 18:36:38] [config] cpu-threads: 0
[2023-06-24 18:36:38] [config] data-threads: 8
[2023-06-24 18:36:38] [config] data-weighting: ""
[2023-06-24 18:36:38] [config] data-weighting-type: sentence
[2023-06-24 18:36:38] [config] dec-cell: gru
[2023-06-24 18:36:38] [config] dec-cell-base-depth: 8
[2023-06-24 18:36:38] [config] dec-cell-high-depth: 1
[2023-06-24 18:36:38] [config] dec-depth: 1
[2023-06-24 18:36:38] [config] devices:
[2023-06-24 18:36:38] [config]   - 0
[2023-06-24 18:36:38] [config] dim-emb: 512
[2023-06-24 18:36:38] [config] dim-rnn: 1024
[2023-06-24 18:36:38] [config] dim-vocabs:
[2023-06-24 18:36:38] [config]   - 54042
[2023-06-24 18:36:38] [config]   - 36507
[2023-06-24 18:36:38] [config] disp-first: 0
[2023-06-24 18:36:38] [config] disp-freq: 1000u
[2023-06-24 18:36:38] [config] disp-label-counts: true
[2023-06-24 18:36:38] [config] dropout-rnn: 0.1
[2023-06-24 18:36:38] [config] dropout-src: 0
[2023-06-24 18:36:38] [config] dropout-trg: 0
[2023-06-24 18:36:38] [config] dump-config: ""
[2023-06-24 18:36:38] [config] dynamic-gradient-scaling:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] early-stopping: 10
[2023-06-24 18:36:38] [config] early-stopping-on: first
[2023-06-24 18:36:38] [config] embedding-fix-src: false
[2023-06-24 18:36:38] [config] embedding-fix-trg: false
[2023-06-24 18:36:38] [config] embedding-normalization: false
[2023-06-24 18:36:38] [config] embedding-vectors:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] enc-cell: gru
[2023-06-24 18:36:38] [config] enc-cell-depth: 4
[2023-06-24 18:36:38] [config] enc-depth: 1
[2023-06-24 18:36:38] [config] enc-type: bidirectional
[2023-06-24 18:36:38] [config] english-title-case-every: 0
[2023-06-24 18:36:38] [config] exponential-smoothing: 0.0001
[2023-06-24 18:36:38] [config] factor-weight: 1
[2023-06-24 18:36:38] [config] factors-combine: sum
[2023-06-24 18:36:38] [config] factors-dim-emb: 0
[2023-06-24 18:36:38] [config] gradient-checkpointing: false
[2023-06-24 18:36:38] [config] gradient-norm-average-window: 100
[2023-06-24 18:36:38] [config] guided-alignment: none
[2023-06-24 18:36:38] [config] guided-alignment-cost: mse
[2023-06-24 18:36:38] [config] guided-alignment-weight: 0.1
[2023-06-24 18:36:38] [config] ignore-model-config: false
[2023-06-24 18:36:38] [config] input-types:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] interpolate-env-vars: false
[2023-06-24 18:36:38] [config] keep-best: false
[2023-06-24 18:36:38] [config] label-smoothing: 0.1
[2023-06-24 18:36:38] [config] layer-normalization: true
[2023-06-24 18:36:38] [config] learn-rate: 0.0003
[2023-06-24 18:36:38] [config] lemma-dependency: ""
[2023-06-24 18:36:38] [config] lemma-dim-emb: 0
[2023-06-24 18:36:38] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_edinburgh2017.log
[2023-06-24 18:36:38] [config] log-level: info
[2023-06-24 18:36:38] [config] log-time-zone: ""
[2023-06-24 18:36:38] [config] logical-epoch:
[2023-06-24 18:36:38] [config]   - 1e
[2023-06-24 18:36:38] [config]   - 0
[2023-06-24 18:36:38] [config] lr-decay: 0
[2023-06-24 18:36:38] [config] lr-decay-freq: 50000
[2023-06-24 18:36:38] [config] lr-decay-inv-sqrt:
[2023-06-24 18:36:38] [config]   - 16000
[2023-06-24 18:36:38] [config] lr-decay-repeat-warmup: false
[2023-06-24 18:36:38] [config] lr-decay-reset-optimizer: false
[2023-06-24 18:36:38] [config] lr-decay-start:
[2023-06-24 18:36:38] [config]   - 10
[2023-06-24 18:36:38] [config]   - 1
[2023-06-24 18:36:38] [config] lr-decay-strategy: epoch+stalled
[2023-06-24 18:36:38] [config] lr-report: false
[2023-06-24 18:36:38] [config] lr-warmup: 0
[2023-06-24 18:36:38] [config] lr-warmup-at-reload: false
[2023-06-24 18:36:38] [config] lr-warmup-cycle: false
[2023-06-24 18:36:38] [config] lr-warmup-start-rate: 0
[2023-06-24 18:36:38] [config] max-length: 100
[2023-06-24 18:36:38] [config] max-length-crop: false
[2023-06-24 18:36:38] [config] max-length-factor: 3
[2023-06-24 18:36:38] [config] maxi-batch: 1000
[2023-06-24 18:36:38] [config] maxi-batch-sort: trg
[2023-06-24 18:36:38] [config] mini-batch: 1000
[2023-06-24 18:36:38] [config] mini-batch-fit: true
[2023-06-24 18:36:38] [config] mini-batch-fit-step: 10
[2023-06-24 18:36:38] [config] mini-batch-round-up: true
[2023-06-24 18:36:38] [config] mini-batch-track-lr: false
[2023-06-24 18:36:38] [config] mini-batch-warmup: 0
[2023-06-24 18:36:38] [config] mini-batch-words: 0
[2023-06-24 18:36:38] [config] mini-batch-words-ref: 0
[2023-06-24 18:36:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 18:36:38] [config] multi-loss-type: sum
[2023-06-24 18:36:38] [config] n-best: false
[2023-06-24 18:36:38] [config] no-nccl: false
[2023-06-24 18:36:38] [config] no-reload: false
[2023-06-24 18:36:38] [config] no-restore-corpus: false
[2023-06-24 18:36:38] [config] normalize: 1
[2023-06-24 18:36:38] [config] normalize-gradient: false
[2023-06-24 18:36:38] [config] num-devices: 0
[2023-06-24 18:36:38] [config] optimizer: adam
[2023-06-24 18:36:38] [config] optimizer-delay: 1
[2023-06-24 18:36:38] [config] optimizer-params:
[2023-06-24 18:36:38] [config]   - 0.9
[2023-06-24 18:36:38] [config]   - 0.98
[2023-06-24 18:36:38] [config]   - 1e-09
[2023-06-24 18:36:38] [config] output-omit-bias: false
[2023-06-24 18:36:38] [config] overwrite: false
[2023-06-24 18:36:38] [config] precision:
[2023-06-24 18:36:38] [config]   - float32
[2023-06-24 18:36:38] [config]   - float32
[2023-06-24 18:36:38] [config] pretrained-model: ""
[2023-06-24 18:36:38] [config] quantize-biases: false
[2023-06-24 18:36:38] [config] quantize-bits: 0
[2023-06-24 18:36:38] [config] quantize-log-based: false
[2023-06-24 18:36:38] [config] quantize-optimization-steps: 0
[2023-06-24 18:36:38] [config] quiet: false
[2023-06-24 18:36:38] [config] quiet-translation: true
[2023-06-24 18:36:38] [config] relative-paths: false
[2023-06-24 18:36:38] [config] right-left: false
[2023-06-24 18:36:38] [config] save-freq: 10000u
[2023-06-24 18:36:38] [config] seed: 1234
[2023-06-24 18:36:38] [config] sentencepiece-alphas:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] sentencepiece-max-lines: 2000000
[2023-06-24 18:36:38] [config] sentencepiece-options: ""
[2023-06-24 18:36:38] [config] sharding: global
[2023-06-24 18:36:38] [config] shuffle: data
[2023-06-24 18:36:38] [config] shuffle-in-ram: false
[2023-06-24 18:36:38] [config] sigterm: save-and-exit
[2023-06-24 18:36:38] [config] skip: false
[2023-06-24 18:36:38] [config] sqlite: ""
[2023-06-24 18:36:38] [config] sqlite-drop: false
[2023-06-24 18:36:38] [config] sync-freq: 200u
[2023-06-24 18:36:38] [config] sync-sgd: true
[2023-06-24 18:36:38] [config] tempdir: /tmp
[2023-06-24 18:36:38] [config] tied-embeddings: false
[2023-06-24 18:36:38] [config] tied-embeddings-all: false
[2023-06-24 18:36:38] [config] tied-embeddings-src: false
[2023-06-24 18:36:38] [config] train-embedder-rank:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] train-sets:
[2023-06-24 18:36:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-24 18:36:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-24 18:36:38] [config] transformer-aan-activation: swish
[2023-06-24 18:36:38] [config] transformer-aan-depth: 2
[2023-06-24 18:36:38] [config] transformer-aan-nogate: false
[2023-06-24 18:36:38] [config] transformer-decoder-autoreg: self-attention
[2023-06-24 18:36:38] [config] transformer-decoder-dim-ffn: 0
[2023-06-24 18:36:38] [config] transformer-decoder-ffn-depth: 0
[2023-06-24 18:36:38] [config] transformer-depth-scaling: false
[2023-06-24 18:36:38] [config] transformer-dim-aan: 2048
[2023-06-24 18:36:38] [config] transformer-dim-ffn: 2048
[2023-06-24 18:36:38] [config] transformer-dropout: 0
[2023-06-24 18:36:38] [config] transformer-dropout-attention: 0
[2023-06-24 18:36:38] [config] transformer-dropout-ffn: 0
[2023-06-24 18:36:38] [config] transformer-ffn-activation: swish
[2023-06-24 18:36:38] [config] transformer-ffn-depth: 2
[2023-06-24 18:36:38] [config] transformer-guided-alignment-layer: last
[2023-06-24 18:36:38] [config] transformer-heads: 8
[2023-06-24 18:36:38] [config] transformer-no-projection: false
[2023-06-24 18:36:38] [config] transformer-pool: false
[2023-06-24 18:36:38] [config] transformer-postprocess: dan
[2023-06-24 18:36:38] [config] transformer-postprocess-emb: d
[2023-06-24 18:36:38] [config] transformer-postprocess-top: ""
[2023-06-24 18:36:38] [config] transformer-preprocess: ""
[2023-06-24 18:36:38] [config] transformer-tied-layers:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] transformer-train-position-embeddings: false
[2023-06-24 18:36:38] [config] tsv: false
[2023-06-24 18:36:38] [config] tsv-fields: 0
[2023-06-24 18:36:38] [config] type: s2s
[2023-06-24 18:36:38] [config] ulr: false
[2023-06-24 18:36:38] [config] ulr-dim-emb: 0
[2023-06-24 18:36:38] [config] ulr-dropout: 0
[2023-06-24 18:36:38] [config] ulr-keys-vectors: ""
[2023-06-24 18:36:38] [config] ulr-query-vectors: ""
[2023-06-24 18:36:38] [config] ulr-softmax-temperature: 1
[2023-06-24 18:36:38] [config] ulr-trainable-transformation: false
[2023-06-24 18:36:38] [config] unlikelihood-loss: false
[2023-06-24 18:36:38] [config] valid-freq: 5000000
[2023-06-24 18:36:38] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_edinburgh2017.log
[2023-06-24 18:36:38] [config] valid-max-length: 1000
[2023-06-24 18:36:38] [config] valid-metrics:
[2023-06-24 18:36:38] [config]   - cross-entropy
[2023-06-24 18:36:38] [config]   - translation
[2023-06-24 18:36:38] [config] valid-mini-batch: 32
[2023-06-24 18:36:38] [config] valid-reset-stalled: false
[2023-06-24 18:36:38] [config] valid-script-args:
[2023-06-24 18:36:38] [config]   []
[2023-06-24 18:36:38] [config] valid-script-path: ""
[2023-06-24 18:36:38] [config] valid-sets:
[2023-06-24 18:36:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-24 18:36:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-24 18:36:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-24 18:36:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 18:36:38] [config] vocabs:
[2023-06-24 18:36:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 18:36:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 18:36:38] [config] word-penalty: 0
[2023-06-24 18:36:38] [config] word-scores: false
[2023-06-24 18:36:38] [config] workspace: 2048
[2023-06-24 18:36:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-24 18:36:38] Using synchronous SGD
[2023-06-24 18:36:39] Synced seed 1234
[2023-06-24 18:36:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-24 18:36:39] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-24 18:36:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-24 18:36:39] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-24 18:36:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-24 18:36:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 18:36:39] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 18:36:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 18:36:39] [comm] Using global sharding
[2023-06-24 18:36:39] [comm] NCCLCommunicators constructed successfully
[2023-06-24 18:36:39] [training] Using 1 GPUs
[2023-06-24 18:36:39] [logits] Applying loss function for 1 factor(s)
[2023-06-24 18:36:39] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:36:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-24 18:36:40] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:37:02] [batching] Done. Typical MB size is 1,800 target words
[2023-06-24 18:37:02] [valid] No post-processing script given for validating translator
[2023-06-24 18:37:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-24 18:37:02] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-24 18:37:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-24 18:37:02] [comm] Using global sharding
[2023-06-24 18:37:02] [comm] NCCLCommunicators constructed successfully
[2023-06-24 18:37:02] [training] Using 1 GPUs
[2023-06-24 18:37:02] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 18:37:06] Allocating memory for general optimizer shards
[2023-06-24 18:37:06] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:37:06] Loading Adam parameters
[2023-06-24 18:37:07] [memory] Reserving 1043 MB, device gpu0
[2023-06-24 18:37:07] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:37:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 18:37:07] [data] Restoring the corpus state to epoch 91, batch 29700
[2023-06-24 18:37:07] [data] Shuffling data
[2023-06-24 18:37:07] [data] Done reading 20,192 sentences
[2023-06-24 18:37:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:37:07] Training started
[2023-06-24 18:37:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-24 18:37:08] [memory] Reserving 521 MB, device gpu0
[2023-06-24 18:37:08] Parameter type float32, optimization type float32, casting types false
[2023-06-24 18:39:00] Ep. 91 : Up. 30000 : Sen. 18,158 : Cost 1.46814024 : Time 118.32s : 12253.83 words/s : gNorm 0.2116
[2023-06-24 18:39:00] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.iter30000.npz
[2023-06-24 18:39:05] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 18:39:10] Saving Adam parameters
[2023-06-24 18:39:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
[2023-06-24 18:39:38] Seen 20,177 samples
[2023-06-24 18:39:38] Starting data epoch 92 in logical epoch 92
[2023-06-24 18:39:38] [data] Shuffling data
[2023-06-24 18:39:38] [data] Done reading 20,192 sentences
[2023-06-24 18:39:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:41:39] Seen 20,177 samples
[2023-06-24 18:41:39] Starting data epoch 93 in logical epoch 93
[2023-06-24 18:41:39] [data] Shuffling data
[2023-06-24 18:41:39] [data] Done reading 20,192 sentences
[2023-06-24 18:41:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:43:43] Seen 20,177 samples
[2023-06-24 18:43:43] Starting data epoch 94 in logical epoch 94
[2023-06-24 18:43:43] [data] Shuffling data
[2023-06-24 18:43:43] [data] Done reading 20,192 sentences
[2023-06-24 18:43:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:45:40] Ep. 94 : Up. 31000 : Sen. 18,816 : Cost 1.46717405 : Time 400.44s : 3612.22 words/s : gNorm 0.2146
[2023-06-24 18:45:47] Seen 20,177 samples
[2023-06-24 18:45:47] Starting data epoch 95 in logical epoch 95
[2023-06-24 18:45:47] [data] Shuffling data
[2023-06-24 18:45:47] [data] Done reading 20,192 sentences
[2023-06-24 18:45:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:47:52] Seen 20,177 samples
[2023-06-24 18:47:52] Starting data epoch 96 in logical epoch 96
[2023-06-24 18:47:52] [data] Shuffling data
[2023-06-24 18:47:52] [data] Done reading 20,192 sentences
[2023-06-24 18:47:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:49:56] Seen 20,177 samples
[2023-06-24 18:49:56] Starting data epoch 97 in logical epoch 97
[2023-06-24 18:49:56] [data] Shuffling data
[2023-06-24 18:49:56] [data] Done reading 20,192 sentences
[2023-06-24 18:49:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:51:58] Ep. 97 : Up. 32000 : Sen. 19,301 : Cost 1.46589565 : Time 377.48s : 3834.34 words/s : gNorm 0.2049
[2023-06-24 18:52:01] Seen 20,177 samples
[2023-06-24 18:52:01] Starting data epoch 98 in logical epoch 98
[2023-06-24 18:52:01] [data] Shuffling data
[2023-06-24 18:52:01] [data] Done reading 20,192 sentences
[2023-06-24 18:52:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:54:05] Seen 20,177 samples
[2023-06-24 18:54:05] Starting data epoch 99 in logical epoch 99
[2023-06-24 18:54:05] [data] Shuffling data
[2023-06-24 18:54:05] [data] Done reading 20,192 sentences
[2023-06-24 18:54:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:56:10] Seen 20,177 samples
[2023-06-24 18:56:10] Starting data epoch 100 in logical epoch 100
[2023-06-24 18:56:10] [data] Shuffling data
[2023-06-24 18:56:10] [data] Done reading 20,192 sentences
[2023-06-24 18:56:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-24 18:58:14] Ep. 100 : Up. 33000 : Sen. 20,177 : Cost 1.46484768 : Time 376.44s : 3848.75 words/s : gNorm 0.2167
[2023-06-24 18:58:14] Seen 20,177 samples
[2023-06-24 18:58:14] Starting data epoch 101 in logical epoch 101
[2023-06-24 18:58:14] Training finished
[2023-06-24 18:58:26] [valid] Ep. 101 : Up. 33000 : cross-entropy : 111.225 : stalled 9 times (last best: 94.2576)
[2023-06-24 19:01:24] [valid] Ep. 101 : Up. 33000 : translation : 0 : new best
[2023-06-24 19:01:24] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz
[2023-06-24 19:01:29] Saving Adam parameters
[2023-06-24 19:01:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz and /docker/home/marianmt/artifacts/models/model_gn_es_edinburgh2017/gn_es_edinburgh2017.npz.optimizer.npz
