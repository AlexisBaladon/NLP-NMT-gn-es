[2023-06-25 21:52:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 21:52:35] [marian] Running on node07.datos.cluster.uy as process 4646 with command line:
[2023-06-25 21:52:35] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 21:52:35] [config] after: 0e
[2023-06-25 21:52:35] [config] after-batches: 0
[2023-06-25 21:52:35] [config] after-epochs: 100
[2023-06-25 21:52:35] [config] all-caps-every: 0
[2023-06-25 21:52:35] [config] allow-unk: false
[2023-06-25 21:52:35] [config] authors: false
[2023-06-25 21:52:35] [config] beam-size: 6
[2023-06-25 21:52:35] [config] bert-class-symbol: "[CLS]"
[2023-06-25 21:52:35] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 21:52:35] [config] bert-masking-fraction: 0.15
[2023-06-25 21:52:35] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 21:52:35] [config] bert-train-type-embeddings: true
[2023-06-25 21:52:35] [config] bert-type-vocab-size: 2
[2023-06-25 21:52:35] [config] build-info: ""
[2023-06-25 21:52:35] [config] check-gradient-nan: false
[2023-06-25 21:52:35] [config] check-nan: false
[2023-06-25 21:52:35] [config] cite: false
[2023-06-25 21:52:35] [config] clip-norm: 1
[2023-06-25 21:52:35] [config] cost-scaling:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] cost-type: ce-sum
[2023-06-25 21:52:35] [config] cpu-threads: 0
[2023-06-25 21:52:35] [config] data-threads: 8
[2023-06-25 21:52:35] [config] data-weighting: ""
[2023-06-25 21:52:35] [config] data-weighting-type: sentence
[2023-06-25 21:52:35] [config] dec-cell: gru
[2023-06-25 21:52:35] [config] dec-cell-base-depth: 2
[2023-06-25 21:52:35] [config] dec-cell-high-depth: 1
[2023-06-25 21:52:35] [config] dec-depth: 1
[2023-06-25 21:52:35] [config] devices:
[2023-06-25 21:52:35] [config]   - 0
[2023-06-25 21:52:35] [config] dim-emb: 512
[2023-06-25 21:52:35] [config] dim-rnn: 1024
[2023-06-25 21:52:35] [config] dim-vocabs:
[2023-06-25 21:52:35] [config]   - 8192
[2023-06-25 21:52:35] [config]   - 8192
[2023-06-25 21:52:35] [config] disp-first: 0
[2023-06-25 21:52:35] [config] disp-freq: 1000u
[2023-06-25 21:52:35] [config] disp-label-counts: true
[2023-06-25 21:52:35] [config] dropout-rnn: 0.2
[2023-06-25 21:52:35] [config] dropout-src: 0.1
[2023-06-25 21:52:35] [config] dropout-trg: 0.1
[2023-06-25 21:52:35] [config] dump-config: ""
[2023-06-25 21:52:35] [config] dynamic-gradient-scaling:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] early-stopping: 5
[2023-06-25 21:52:35] [config] early-stopping-on: first
[2023-06-25 21:52:35] [config] embedding-fix-src: false
[2023-06-25 21:52:35] [config] embedding-fix-trg: false
[2023-06-25 21:52:35] [config] embedding-normalization: false
[2023-06-25 21:52:35] [config] embedding-vectors:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] enc-cell: gru
[2023-06-25 21:52:35] [config] enc-cell-depth: 1
[2023-06-25 21:52:35] [config] enc-depth: 1
[2023-06-25 21:52:35] [config] enc-type: bidirectional
[2023-06-25 21:52:35] [config] english-title-case-every: 0
[2023-06-25 21:52:35] [config] exponential-smoothing: 0
[2023-06-25 21:52:35] [config] factor-weight: 1
[2023-06-25 21:52:35] [config] factors-combine: sum
[2023-06-25 21:52:35] [config] factors-dim-emb: 0
[2023-06-25 21:52:35] [config] gradient-checkpointing: false
[2023-06-25 21:52:35] [config] gradient-norm-average-window: 100
[2023-06-25 21:52:35] [config] guided-alignment: none
[2023-06-25 21:52:35] [config] guided-alignment-cost: mse
[2023-06-25 21:52:35] [config] guided-alignment-weight: 0.1
[2023-06-25 21:52:35] [config] ignore-model-config: false
[2023-06-25 21:52:35] [config] input-types:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] interpolate-env-vars: false
[2023-06-25 21:52:35] [config] keep-best: false
[2023-06-25 21:52:35] [config] label-smoothing: 0
[2023-06-25 21:52:35] [config] layer-normalization: true
[2023-06-25 21:52:35] [config] learn-rate: 0.0001
[2023-06-25 21:52:35] [config] lemma-dependency: ""
[2023-06-25 21:52:35] [config] lemma-dim-emb: 0
[2023-06-25 21:52:35] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 21:52:35] [config] log-level: info
[2023-06-25 21:52:35] [config] log-time-zone: ""
[2023-06-25 21:52:35] [config] logical-epoch:
[2023-06-25 21:52:35] [config]   - 1e
[2023-06-25 21:52:35] [config]   - 0
[2023-06-25 21:52:35] [config] lr-decay: 0
[2023-06-25 21:52:35] [config] lr-decay-freq: 50000
[2023-06-25 21:52:35] [config] lr-decay-inv-sqrt:
[2023-06-25 21:52:35] [config]   - 0
[2023-06-25 21:52:35] [config] lr-decay-repeat-warmup: false
[2023-06-25 21:52:35] [config] lr-decay-reset-optimizer: false
[2023-06-25 21:52:35] [config] lr-decay-start:
[2023-06-25 21:52:35] [config]   - 10
[2023-06-25 21:52:35] [config]   - 1
[2023-06-25 21:52:35] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 21:52:35] [config] lr-report: false
[2023-06-25 21:52:35] [config] lr-warmup: 0
[2023-06-25 21:52:35] [config] lr-warmup-at-reload: false
[2023-06-25 21:52:35] [config] lr-warmup-cycle: false
[2023-06-25 21:52:35] [config] lr-warmup-start-rate: 0
[2023-06-25 21:52:35] [config] max-length: 50
[2023-06-25 21:52:35] [config] max-length-crop: false
[2023-06-25 21:52:35] [config] max-length-factor: 3
[2023-06-25 21:52:35] [config] maxi-batch: 100
[2023-06-25 21:52:35] [config] maxi-batch-sort: trg
[2023-06-25 21:52:35] [config] mini-batch: 64
[2023-06-25 21:52:35] [config] mini-batch-fit: true
[2023-06-25 21:52:35] [config] mini-batch-fit-step: 10
[2023-06-25 21:52:35] [config] mini-batch-round-up: true
[2023-06-25 21:52:35] [config] mini-batch-track-lr: false
[2023-06-25 21:52:35] [config] mini-batch-warmup: 0
[2023-06-25 21:52:35] [config] mini-batch-words: 0
[2023-06-25 21:52:35] [config] mini-batch-words-ref: 0
[2023-06-25 21:52:35] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 21:52:35] [config] multi-loss-type: sum
[2023-06-25 21:52:35] [config] n-best: false
[2023-06-25 21:52:35] [config] no-nccl: false
[2023-06-25 21:52:35] [config] no-reload: false
[2023-06-25 21:52:35] [config] no-restore-corpus: false
[2023-06-25 21:52:35] [config] normalize: 0.6
[2023-06-25 21:52:35] [config] normalize-gradient: false
[2023-06-25 21:52:35] [config] num-devices: 0
[2023-06-25 21:52:35] [config] optimizer: adam
[2023-06-25 21:52:35] [config] optimizer-delay: 1
[2023-06-25 21:52:35] [config] optimizer-params:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] output-omit-bias: false
[2023-06-25 21:52:35] [config] overwrite: false
[2023-06-25 21:52:35] [config] precision:
[2023-06-25 21:52:35] [config]   - float32
[2023-06-25 21:52:35] [config]   - float32
[2023-06-25 21:52:35] [config] pretrained-model: ""
[2023-06-25 21:52:35] [config] quantize-biases: false
[2023-06-25 21:52:35] [config] quantize-bits: 0
[2023-06-25 21:52:35] [config] quantize-log-based: false
[2023-06-25 21:52:35] [config] quantize-optimization-steps: 0
[2023-06-25 21:52:35] [config] quiet: false
[2023-06-25 21:52:35] [config] quiet-translation: true
[2023-06-25 21:52:35] [config] relative-paths: false
[2023-06-25 21:52:35] [config] right-left: false
[2023-06-25 21:52:35] [config] save-freq: 10000u
[2023-06-25 21:52:35] [config] seed: 1234
[2023-06-25 21:52:35] [config] sentencepiece-alphas:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] sentencepiece-max-lines: 2000000
[2023-06-25 21:52:35] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 21:52:35] [config] sharding: global
[2023-06-25 21:52:35] [config] shuffle: data
[2023-06-25 21:52:35] [config] shuffle-in-ram: false
[2023-06-25 21:52:35] [config] sigterm: save-and-exit
[2023-06-25 21:52:35] [config] skip: false
[2023-06-25 21:52:35] [config] sqlite: ""
[2023-06-25 21:52:35] [config] sqlite-drop: false
[2023-06-25 21:52:35] [config] sync-freq: 200u
[2023-06-25 21:52:35] [config] sync-sgd: false
[2023-06-25 21:52:35] [config] tempdir: /tmp
[2023-06-25 21:52:35] [config] tied-embeddings: false
[2023-06-25 21:52:35] [config] tied-embeddings-all: true
[2023-06-25 21:52:35] [config] tied-embeddings-src: false
[2023-06-25 21:52:35] [config] train-embedder-rank:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] train-sets:
[2023-06-25 21:52:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 21:52:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 21:52:35] [config] transformer-aan-activation: swish
[2023-06-25 21:52:35] [config] transformer-aan-depth: 2
[2023-06-25 21:52:35] [config] transformer-aan-nogate: false
[2023-06-25 21:52:35] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 21:52:35] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 21:52:35] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 21:52:35] [config] transformer-depth-scaling: false
[2023-06-25 21:52:35] [config] transformer-dim-aan: 2048
[2023-06-25 21:52:35] [config] transformer-dim-ffn: 2048
[2023-06-25 21:52:35] [config] transformer-dropout: 0
[2023-06-25 21:52:35] [config] transformer-dropout-attention: 0
[2023-06-25 21:52:35] [config] transformer-dropout-ffn: 0
[2023-06-25 21:52:35] [config] transformer-ffn-activation: swish
[2023-06-25 21:52:35] [config] transformer-ffn-depth: 2
[2023-06-25 21:52:35] [config] transformer-guided-alignment-layer: last
[2023-06-25 21:52:35] [config] transformer-heads: 8
[2023-06-25 21:52:35] [config] transformer-no-projection: false
[2023-06-25 21:52:35] [config] transformer-pool: false
[2023-06-25 21:52:35] [config] transformer-postprocess: dan
[2023-06-25 21:52:35] [config] transformer-postprocess-emb: d
[2023-06-25 21:52:35] [config] transformer-postprocess-top: ""
[2023-06-25 21:52:35] [config] transformer-preprocess: ""
[2023-06-25 21:52:35] [config] transformer-tied-layers:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] transformer-train-position-embeddings: false
[2023-06-25 21:52:35] [config] tsv: false
[2023-06-25 21:52:35] [config] tsv-fields: 0
[2023-06-25 21:52:35] [config] type: amun
[2023-06-25 21:52:35] [config] ulr: false
[2023-06-25 21:52:35] [config] ulr-dim-emb: 0
[2023-06-25 21:52:35] [config] ulr-dropout: 0
[2023-06-25 21:52:35] [config] ulr-keys-vectors: ""
[2023-06-25 21:52:35] [config] ulr-query-vectors: ""
[2023-06-25 21:52:35] [config] ulr-softmax-temperature: 1
[2023-06-25 21:52:35] [config] ulr-trainable-transformation: false
[2023-06-25 21:52:35] [config] unlikelihood-loss: false
[2023-06-25 21:52:35] [config] valid-freq: 5000000
[2023-06-25 21:52:35] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 21:52:35] [config] valid-max-length: 1000
[2023-06-25 21:52:35] [config] valid-metrics:
[2023-06-25 21:52:35] [config]   - cross-entropy
[2023-06-25 21:52:35] [config]   - translation
[2023-06-25 21:52:35] [config] valid-mini-batch: 32
[2023-06-25 21:52:35] [config] valid-reset-stalled: false
[2023-06-25 21:52:35] [config] valid-script-args:
[2023-06-25 21:52:35] [config]   []
[2023-06-25 21:52:35] [config] valid-script-path: ""
[2023-06-25 21:52:35] [config] valid-sets:
[2023-06-25 21:52:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 21:52:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 21:52:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 21:52:35] [config] vocabs:
[2023-06-25 21:52:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 21:52:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 21:52:35] [config] word-penalty: 0
[2023-06-25 21:52:35] [config] word-scores: false
[2023-06-25 21:52:35] [config] workspace: 3000
[2023-06-25 21:52:35] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 21:52:35] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 21:52:35] [training] Using single-device training
[2023-06-25 21:52:35] Synced seed 1234
[2023-06-25 21:52:36] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 21:52:36] [SentencePiece] Creating temporary file /tmp/marian.V4ciAw 
[2023-06-25 21:52:36] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 21:52:36] [SentencePiece] Selected 20193 lines
[2023-06-25 21:52:38] [SentencePiece] Removing /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm.vocab
[2023-06-25 21:52:38] [SentencePiece] Renaming /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm.model to /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 21:52:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 21:52:38] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 21:52:38] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 21:52:38] [SentencePiece] Creating temporary file /tmp/marian.zUZ39v 
[2023-06-25 21:52:38] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 21:52:38] [SentencePiece] Selected 20193 lines
[2023-06-25 21:52:40] [SentencePiece] Removing /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm.vocab
[2023-06-25 21:52:41] [SentencePiece] Renaming /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm.model to /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 21:52:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 21:52:41] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 21:52:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 21:52:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 21:52:42] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 21:52:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 21:52:42] [comm] Using global sharding
[2023-06-25 21:52:42] [comm] NCCLCommunicators constructed successfully
[2023-06-25 21:52:42] [training] Using 1 GPUs
[2023-06-25 21:52:42] [logits] Applying loss function for 1 factor(s)
[2023-06-25 21:52:42] [memory] Reserving 145 MB, device gpu0
[2023-06-25 21:52:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 21:52:45] [memory] Reserving 145 MB, device gpu0
[2023-06-25 21:52:59] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 21:52:59] [valid] No post-processing script given for validating translator
[2023-06-25 21:52:59] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 21:52:59] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 21:52:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 21:52:59] [comm] Using global sharding
[2023-06-25 21:52:59] [comm] NCCLCommunicators constructed successfully
[2023-06-25 21:52:59] [training] Using 1 GPUs
[2023-06-25 21:52:59] Training started
[2023-06-25 21:52:59] [data] Shuffling data
[2023-06-25 21:52:59] [data] Done reading 20,192 sentences
[2023-06-25 21:52:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:52:59] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 21:52:59] [memory] Reserving 145 MB, device gpu0
[2023-06-25 21:52:59] [memory] Reserving 145 MB, device gpu0
[2023-06-25 21:52:59] Parameter type float32, optimization type float32, casting types false
[2023-06-25 21:52:59] Allocating memory for Adam-specific shards
[2023-06-25 21:52:59] [memory] Reserving 290 MB, device gpu0
[2023-06-25 21:53:36] Seen 15,667 samples
[2023-06-25 21:53:36] Starting data epoch 2 in logical epoch 2
[2023-06-25 21:53:36] [data] Shuffling data
[2023-06-25 21:53:36] [data] Done reading 20,192 sentences
[2023-06-25 21:53:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:54:21] Seen 15,667 samples
[2023-06-25 21:54:21] Starting data epoch 3 in logical epoch 3
[2023-06-25 21:54:21] [data] Shuffling data
[2023-06-25 21:54:21] [data] Done reading 20,192 sentences
[2023-06-25 21:54:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:55:05] Seen 15,667 samples
[2023-06-25 21:55:05] Starting data epoch 4 in logical epoch 4
[2023-06-25 21:55:05] [data] Shuffling data
[2023-06-25 21:55:05] [data] Done reading 20,192 sentences
[2023-06-25 21:55:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:55:48] Seen 15,667 samples
[2023-06-25 21:55:48] Starting data epoch 5 in logical epoch 5
[2023-06-25 21:55:48] [data] Shuffling data
[2023-06-25 21:55:48] [data] Done reading 20,192 sentences
[2023-06-25 21:55:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:56:32] Seen 15,667 samples
[2023-06-25 21:56:32] Starting data epoch 6 in logical epoch 6
[2023-06-25 21:56:32] [data] Shuffling data
[2023-06-25 21:56:33] [data] Done reading 20,192 sentences
[2023-06-25 21:56:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:57:17] Seen 15,667 samples
[2023-06-25 21:57:17] Starting data epoch 7 in logical epoch 7
[2023-06-25 21:57:17] [data] Shuffling data
[2023-06-25 21:57:17] [data] Done reading 20,192 sentences
[2023-06-25 21:57:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:58:01] Seen 15,667 samples
[2023-06-25 21:58:01] Starting data epoch 8 in logical epoch 8
[2023-06-25 21:58:01] [data] Shuffling data
[2023-06-25 21:58:01] [data] Done reading 20,192 sentences
[2023-06-25 21:58:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:58:46] Seen 15,667 samples
[2023-06-25 21:58:46] Starting data epoch 9 in logical epoch 9
[2023-06-25 21:58:46] [data] Shuffling data
[2023-06-25 21:58:46] [data] Done reading 20,192 sentences
[2023-06-25 21:58:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 21:59:32] Seen 15,667 samples
[2023-06-25 21:59:32] Starting data epoch 10 in logical epoch 10
[2023-06-25 21:59:32] [data] Shuffling data
[2023-06-25 21:59:32] [data] Done reading 20,192 sentences
[2023-06-25 21:59:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:00:16] Seen 15,667 samples
[2023-06-25 22:00:16] Starting data epoch 11 in logical epoch 11
[2023-06-25 22:00:16] [data] Shuffling data
[2023-06-25 22:00:16] [data] Done reading 20,192 sentences
[2023-06-25 22:00:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:01:01] Seen 15,667 samples
[2023-06-25 22:01:01] Starting data epoch 12 in logical epoch 12
[2023-06-25 22:01:01] [data] Shuffling data
[2023-06-25 22:01:01] [data] Done reading 20,192 sentences
[2023-06-25 22:01:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:01:14] Ep. 12 : Up. 1000 : Sen. 4,691 : Cost 5.44055986 * 4,250,217 @ 3,478 after 4,250,217 : Time 495.24s : 8582.13 words/s : gNorm 1.2673
[2023-06-25 22:01:45] Seen 15,667 samples
[2023-06-25 22:01:45] Starting data epoch 13 in logical epoch 13
[2023-06-25 22:01:45] [data] Shuffling data
[2023-06-25 22:01:45] [data] Done reading 20,192 sentences
[2023-06-25 22:01:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:02:29] Seen 15,667 samples
[2023-06-25 22:02:29] Starting data epoch 14 in logical epoch 14
[2023-06-25 22:02:29] [data] Shuffling data
[2023-06-25 22:02:29] [data] Done reading 20,192 sentences
[2023-06-25 22:02:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:03:13] Seen 15,667 samples
[2023-06-25 22:03:13] Starting data epoch 15 in logical epoch 15
[2023-06-25 22:03:13] [data] Shuffling data
[2023-06-25 22:03:13] [data] Done reading 20,192 sentences
[2023-06-25 22:03:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:03:57] Seen 15,667 samples
[2023-06-25 22:03:57] Starting data epoch 16 in logical epoch 16
[2023-06-25 22:03:57] [data] Shuffling data
[2023-06-25 22:03:57] [data] Done reading 20,192 sentences
[2023-06-25 22:03:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:04:43] Seen 15,667 samples
[2023-06-25 22:04:43] Starting data epoch 17 in logical epoch 17
[2023-06-25 22:04:43] [data] Shuffling data
[2023-06-25 22:04:43] [data] Done reading 20,192 sentences
[2023-06-25 22:04:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:05:27] Seen 15,667 samples
[2023-06-25 22:05:27] Starting data epoch 18 in logical epoch 18
[2023-06-25 22:05:27] [data] Shuffling data
[2023-06-25 22:05:27] [data] Done reading 20,192 sentences
[2023-06-25 22:05:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:09:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:09:01] [marian] Running on node07.datos.cluster.uy as process 6199 with command line:
[2023-06-25 22:09:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 22:09:01] [config] after: 0e
[2023-06-25 22:09:01] [config] after-batches: 0
[2023-06-25 22:09:01] [config] after-epochs: 10
[2023-06-25 22:09:01] [config] all-caps-every: 0
[2023-06-25 22:09:01] [config] allow-unk: false
[2023-06-25 22:09:01] [config] authors: false
[2023-06-25 22:09:01] [config] beam-size: 6
[2023-06-25 22:09:01] [config] bert-class-symbol: "[CLS]"
[2023-06-25 22:09:01] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 22:09:01] [config] bert-masking-fraction: 0.15
[2023-06-25 22:09:01] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 22:09:01] [config] bert-train-type-embeddings: true
[2023-06-25 22:09:01] [config] bert-type-vocab-size: 2
[2023-06-25 22:09:01] [config] build-info: ""
[2023-06-25 22:09:01] [config] check-gradient-nan: false
[2023-06-25 22:09:01] [config] check-nan: false
[2023-06-25 22:09:01] [config] cite: false
[2023-06-25 22:09:01] [config] clip-norm: 1
[2023-06-25 22:09:01] [config] cost-scaling:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] cost-type: ce-sum
[2023-06-25 22:09:01] [config] cpu-threads: 0
[2023-06-25 22:09:01] [config] data-threads: 8
[2023-06-25 22:09:01] [config] data-weighting: ""
[2023-06-25 22:09:01] [config] data-weighting-type: sentence
[2023-06-25 22:09:01] [config] dec-cell: gru
[2023-06-25 22:09:01] [config] dec-cell-base-depth: 2
[2023-06-25 22:09:01] [config] dec-cell-high-depth: 1
[2023-06-25 22:09:01] [config] dec-depth: 1
[2023-06-25 22:09:01] [config] devices:
[2023-06-25 22:09:01] [config]   - 0
[2023-06-25 22:09:01] [config] dim-emb: 512
[2023-06-25 22:09:01] [config] dim-rnn: 1024
[2023-06-25 22:09:01] [config] dim-vocabs:
[2023-06-25 22:09:01] [config]   - 8192
[2023-06-25 22:09:01] [config]   - 8192
[2023-06-25 22:09:01] [config] disp-first: 0
[2023-06-25 22:09:01] [config] disp-freq: 1000u
[2023-06-25 22:09:01] [config] disp-label-counts: true
[2023-06-25 22:09:01] [config] dropout-rnn: 0.2
[2023-06-25 22:09:01] [config] dropout-src: 0.1
[2023-06-25 22:09:01] [config] dropout-trg: 0.1
[2023-06-25 22:09:01] [config] dump-config: ""
[2023-06-25 22:09:01] [config] dynamic-gradient-scaling:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] early-stopping: 10
[2023-06-25 22:09:01] [config] early-stopping-on: first
[2023-06-25 22:09:01] [config] embedding-fix-src: false
[2023-06-25 22:09:01] [config] embedding-fix-trg: false
[2023-06-25 22:09:01] [config] embedding-normalization: false
[2023-06-25 22:09:01] [config] embedding-vectors:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] enc-cell: gru
[2023-06-25 22:09:01] [config] enc-cell-depth: 1
[2023-06-25 22:09:01] [config] enc-depth: 1
[2023-06-25 22:09:01] [config] enc-type: bidirectional
[2023-06-25 22:09:01] [config] english-title-case-every: 0
[2023-06-25 22:09:01] [config] exponential-smoothing: 0
[2023-06-25 22:09:01] [config] factor-weight: 1
[2023-06-25 22:09:01] [config] factors-combine: sum
[2023-06-25 22:09:01] [config] factors-dim-emb: 0
[2023-06-25 22:09:01] [config] gradient-checkpointing: false
[2023-06-25 22:09:01] [config] gradient-norm-average-window: 100
[2023-06-25 22:09:01] [config] guided-alignment: none
[2023-06-25 22:09:01] [config] guided-alignment-cost: mse
[2023-06-25 22:09:01] [config] guided-alignment-weight: 0.1
[2023-06-25 22:09:01] [config] ignore-model-config: false
[2023-06-25 22:09:01] [config] input-types:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] interpolate-env-vars: false
[2023-06-25 22:09:01] [config] keep-best: false
[2023-06-25 22:09:01] [config] label-smoothing: 0
[2023-06-25 22:09:01] [config] layer-normalization: true
[2023-06-25 22:09:01] [config] learn-rate: 0.0001
[2023-06-25 22:09:01] [config] lemma-dependency: ""
[2023-06-25 22:09:01] [config] lemma-dim-emb: 0
[2023-06-25 22:09:01] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 22:09:01] [config] log-level: info
[2023-06-25 22:09:01] [config] log-time-zone: ""
[2023-06-25 22:09:01] [config] logical-epoch:
[2023-06-25 22:09:01] [config]   - 1e
[2023-06-25 22:09:01] [config]   - 0
[2023-06-25 22:09:01] [config] lr-decay: 0
[2023-06-25 22:09:01] [config] lr-decay-freq: 50000
[2023-06-25 22:09:01] [config] lr-decay-inv-sqrt:
[2023-06-25 22:09:01] [config]   - 0
[2023-06-25 22:09:01] [config] lr-decay-repeat-warmup: false
[2023-06-25 22:09:01] [config] lr-decay-reset-optimizer: false
[2023-06-25 22:09:01] [config] lr-decay-start:
[2023-06-25 22:09:01] [config]   - 10
[2023-06-25 22:09:01] [config]   - 1
[2023-06-25 22:09:01] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 22:09:01] [config] lr-report: false
[2023-06-25 22:09:01] [config] lr-warmup: 0
[2023-06-25 22:09:01] [config] lr-warmup-at-reload: false
[2023-06-25 22:09:01] [config] lr-warmup-cycle: false
[2023-06-25 22:09:01] [config] lr-warmup-start-rate: 0
[2023-06-25 22:09:01] [config] max-length: 50
[2023-06-25 22:09:01] [config] max-length-crop: false
[2023-06-25 22:09:01] [config] max-length-factor: 3
[2023-06-25 22:09:01] [config] maxi-batch: 100
[2023-06-25 22:09:01] [config] maxi-batch-sort: trg
[2023-06-25 22:09:01] [config] mini-batch: 64
[2023-06-25 22:09:01] [config] mini-batch-fit: true
[2023-06-25 22:09:01] [config] mini-batch-fit-step: 10
[2023-06-25 22:09:01] [config] mini-batch-round-up: true
[2023-06-25 22:09:01] [config] mini-batch-track-lr: false
[2023-06-25 22:09:01] [config] mini-batch-warmup: 0
[2023-06-25 22:09:01] [config] mini-batch-words: 0
[2023-06-25 22:09:01] [config] mini-batch-words-ref: 0
[2023-06-25 22:09:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:09:01] [config] multi-loss-type: sum
[2023-06-25 22:09:01] [config] n-best: false
[2023-06-25 22:09:01] [config] no-nccl: false
[2023-06-25 22:09:01] [config] no-reload: false
[2023-06-25 22:09:01] [config] no-restore-corpus: false
[2023-06-25 22:09:01] [config] normalize: 0.6
[2023-06-25 22:09:01] [config] normalize-gradient: false
[2023-06-25 22:09:01] [config] num-devices: 0
[2023-06-25 22:09:01] [config] optimizer: adam
[2023-06-25 22:09:01] [config] optimizer-delay: 1
[2023-06-25 22:09:01] [config] optimizer-params:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] output-omit-bias: false
[2023-06-25 22:09:01] [config] overwrite: false
[2023-06-25 22:09:01] [config] precision:
[2023-06-25 22:09:01] [config]   - float32
[2023-06-25 22:09:01] [config]   - float32
[2023-06-25 22:09:01] [config] pretrained-model: ""
[2023-06-25 22:09:01] [config] quantize-biases: false
[2023-06-25 22:09:01] [config] quantize-bits: 0
[2023-06-25 22:09:01] [config] quantize-log-based: false
[2023-06-25 22:09:01] [config] quantize-optimization-steps: 0
[2023-06-25 22:09:01] [config] quiet: false
[2023-06-25 22:09:01] [config] quiet-translation: true
[2023-06-25 22:09:01] [config] relative-paths: false
[2023-06-25 22:09:01] [config] right-left: false
[2023-06-25 22:09:01] [config] save-freq: 10000u
[2023-06-25 22:09:01] [config] seed: 1234
[2023-06-25 22:09:01] [config] sentencepiece-alphas:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] sentencepiece-max-lines: 2000000
[2023-06-25 22:09:01] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 22:09:01] [config] sharding: global
[2023-06-25 22:09:01] [config] shuffle: data
[2023-06-25 22:09:01] [config] shuffle-in-ram: false
[2023-06-25 22:09:01] [config] sigterm: save-and-exit
[2023-06-25 22:09:01] [config] skip: false
[2023-06-25 22:09:01] [config] sqlite: ""
[2023-06-25 22:09:01] [config] sqlite-drop: false
[2023-06-25 22:09:01] [config] sync-freq: 200u
[2023-06-25 22:09:01] [config] sync-sgd: false
[2023-06-25 22:09:01] [config] tempdir: /tmp
[2023-06-25 22:09:01] [config] tied-embeddings: false
[2023-06-25 22:09:01] [config] tied-embeddings-all: true
[2023-06-25 22:09:01] [config] tied-embeddings-src: false
[2023-06-25 22:09:01] [config] train-embedder-rank:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] train-sets:
[2023-06-25 22:09:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 22:09:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 22:09:01] [config] transformer-aan-activation: swish
[2023-06-25 22:09:01] [config] transformer-aan-depth: 2
[2023-06-25 22:09:01] [config] transformer-aan-nogate: false
[2023-06-25 22:09:01] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 22:09:01] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 22:09:01] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 22:09:01] [config] transformer-depth-scaling: false
[2023-06-25 22:09:01] [config] transformer-dim-aan: 2048
[2023-06-25 22:09:01] [config] transformer-dim-ffn: 2048
[2023-06-25 22:09:01] [config] transformer-dropout: 0
[2023-06-25 22:09:01] [config] transformer-dropout-attention: 0
[2023-06-25 22:09:01] [config] transformer-dropout-ffn: 0
[2023-06-25 22:09:01] [config] transformer-ffn-activation: swish
[2023-06-25 22:09:01] [config] transformer-ffn-depth: 2
[2023-06-25 22:09:01] [config] transformer-guided-alignment-layer: last
[2023-06-25 22:09:01] [config] transformer-heads: 8
[2023-06-25 22:09:01] [config] transformer-no-projection: false
[2023-06-25 22:09:01] [config] transformer-pool: false
[2023-06-25 22:09:01] [config] transformer-postprocess: dan
[2023-06-25 22:09:01] [config] transformer-postprocess-emb: d
[2023-06-25 22:09:01] [config] transformer-postprocess-top: ""
[2023-06-25 22:09:01] [config] transformer-preprocess: ""
[2023-06-25 22:09:01] [config] transformer-tied-layers:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] transformer-train-position-embeddings: false
[2023-06-25 22:09:01] [config] tsv: false
[2023-06-25 22:09:01] [config] tsv-fields: 0
[2023-06-25 22:09:01] [config] type: amun
[2023-06-25 22:09:01] [config] ulr: false
[2023-06-25 22:09:01] [config] ulr-dim-emb: 0
[2023-06-25 22:09:01] [config] ulr-dropout: 0
[2023-06-25 22:09:01] [config] ulr-keys-vectors: ""
[2023-06-25 22:09:01] [config] ulr-query-vectors: ""
[2023-06-25 22:09:01] [config] ulr-softmax-temperature: 1
[2023-06-25 22:09:01] [config] ulr-trainable-transformation: false
[2023-06-25 22:09:01] [config] unlikelihood-loss: false
[2023-06-25 22:09:01] [config] valid-freq: 5000000
[2023-06-25 22:09:01] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 22:09:01] [config] valid-max-length: 1000
[2023-06-25 22:09:01] [config] valid-metrics:
[2023-06-25 22:09:01] [config]   - cross-entropy
[2023-06-25 22:09:01] [config]   - translation
[2023-06-25 22:09:01] [config] valid-mini-batch: 32
[2023-06-25 22:09:01] [config] valid-reset-stalled: false
[2023-06-25 22:09:01] [config] valid-script-args:
[2023-06-25 22:09:01] [config]   []
[2023-06-25 22:09:01] [config] valid-script-path: ""
[2023-06-25 22:09:01] [config] valid-sets:
[2023-06-25 22:09:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 22:09:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 22:09:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 22:09:01] [config] vocabs:
[2023-06-25 22:09:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:09:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:09:01] [config] word-penalty: 0
[2023-06-25 22:09:01] [config] word-scores: false
[2023-06-25 22:09:01] [config] workspace: 3000
[2023-06-25 22:09:01] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:09:01] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:09:01] [training] Using single-device training
[2023-06-25 22:09:02] Synced seed 1234
[2023-06-25 22:09:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:09:02] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 22:09:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:09:02] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 22:09:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 22:09:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:09:03] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:09:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:09:03] [comm] Using global sharding
[2023-06-25 22:09:03] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:09:03] [training] Using 1 GPUs
[2023-06-25 22:09:03] [logits] Applying loss function for 1 factor(s)
[2023-06-25 22:09:03] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:09:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 22:09:05] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:09:18] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 22:09:18] [valid] No post-processing script given for validating translator
[2023-06-25 22:09:18] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:09:18] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:09:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:09:19] [comm] Using global sharding
[2023-06-25 22:09:19] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:09:19] [training] Using 1 GPUs
[2023-06-25 22:09:19] Training started
[2023-06-25 22:09:19] [data] Shuffling data
[2023-06-25 22:09:19] [data] Done reading 20,192 sentences
[2023-06-25 22:09:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:09:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 22:09:19] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:09:19] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:09:19] Parameter type float32, optimization type float32, casting types false
[2023-06-25 22:09:19] Allocating memory for Adam-specific shards
[2023-06-25 22:09:19] [memory] Reserving 290 MB, device gpu0
[2023-06-25 22:09:52] Seen 15,667 samples
[2023-06-25 22:09:52] Starting data epoch 2 in logical epoch 2
[2023-06-25 22:09:52] [data] Shuffling data
[2023-06-25 22:09:52] [data] Done reading 20,192 sentences
[2023-06-25 22:09:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:10:25] Seen 15,667 samples
[2023-06-25 22:10:25] Starting data epoch 3 in logical epoch 3
[2023-06-25 22:10:25] [data] Shuffling data
[2023-06-25 22:10:25] [data] Done reading 20,192 sentences
[2023-06-25 22:10:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:11:03] Seen 15,667 samples
[2023-06-25 22:11:03] Starting data epoch 4 in logical epoch 4
[2023-06-25 22:11:03] [data] Shuffling data
[2023-06-25 22:11:03] [data] Done reading 20,192 sentences
[2023-06-25 22:11:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:11:45] Seen 15,667 samples
[2023-06-25 22:11:45] Starting data epoch 5 in logical epoch 5
[2023-06-25 22:11:45] [data] Shuffling data
[2023-06-25 22:11:45] [data] Done reading 20,192 sentences
[2023-06-25 22:11:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:12:26] Seen 15,667 samples
[2023-06-25 22:12:26] Starting data epoch 6 in logical epoch 6
[2023-06-25 22:12:26] [data] Shuffling data
[2023-06-25 22:12:26] [data] Done reading 20,192 sentences
[2023-06-25 22:12:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:13:09] Seen 15,667 samples
[2023-06-25 22:13:09] Starting data epoch 7 in logical epoch 7
[2023-06-25 22:13:09] [data] Shuffling data
[2023-06-25 22:13:09] [data] Done reading 20,192 sentences
[2023-06-25 22:13:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:13:55] Seen 15,667 samples
[2023-06-25 22:13:55] Starting data epoch 8 in logical epoch 8
[2023-06-25 22:13:55] [data] Shuffling data
[2023-06-25 22:13:55] [data] Done reading 20,192 sentences
[2023-06-25 22:13:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:14:39] Seen 15,667 samples
[2023-06-25 22:14:39] Starting data epoch 9 in logical epoch 9
[2023-06-25 22:14:39] [data] Shuffling data
[2023-06-25 22:14:39] [data] Done reading 20,192 sentences
[2023-06-25 22:14:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:15:23] Seen 15,667 samples
[2023-06-25 22:15:23] Starting data epoch 10 in logical epoch 10
[2023-06-25 22:15:23] [data] Shuffling data
[2023-06-25 22:15:23] [data] Done reading 20,192 sentences
[2023-06-25 22:15:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:16:08] Seen 15,667 samples
[2023-06-25 22:16:08] Starting data epoch 11 in logical epoch 11
[2023-06-25 22:16:08] Training finished
[2023-06-25 22:16:17] [valid] Ep. 11 : Up. 885 : cross-entropy : 155.139 : new best
[2023-06-25 22:17:11] [valid] Ep. 11 : Up. 885 : translation : 0 : new best
[2023-06-25 22:17:11] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:17:13] Saving Adam parameters
[2023-06-25 22:17:13] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:20:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:20:54] [marian] Running on node07.datos.cluster.uy as process 7228 with command line:
[2023-06-25 22:20:54] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 22:20:54] [config] after: 0e
[2023-06-25 22:20:54] [config] after-batches: 0
[2023-06-25 22:20:54] [config] after-epochs: 20
[2023-06-25 22:20:54] [config] all-caps-every: 0
[2023-06-25 22:20:54] [config] allow-unk: false
[2023-06-25 22:20:54] [config] authors: false
[2023-06-25 22:20:54] [config] beam-size: 6
[2023-06-25 22:20:54] [config] bert-class-symbol: "[CLS]"
[2023-06-25 22:20:54] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 22:20:54] [config] bert-masking-fraction: 0.15
[2023-06-25 22:20:54] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 22:20:54] [config] bert-train-type-embeddings: true
[2023-06-25 22:20:54] [config] bert-type-vocab-size: 2
[2023-06-25 22:20:54] [config] build-info: ""
[2023-06-25 22:20:54] [config] check-gradient-nan: false
[2023-06-25 22:20:54] [config] check-nan: false
[2023-06-25 22:20:54] [config] cite: false
[2023-06-25 22:20:54] [config] clip-norm: 1
[2023-06-25 22:20:54] [config] cost-scaling:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] cost-type: ce-sum
[2023-06-25 22:20:54] [config] cpu-threads: 0
[2023-06-25 22:20:54] [config] data-threads: 8
[2023-06-25 22:20:54] [config] data-weighting: ""
[2023-06-25 22:20:54] [config] data-weighting-type: sentence
[2023-06-25 22:20:54] [config] dec-cell: gru
[2023-06-25 22:20:54] [config] dec-cell-base-depth: 2
[2023-06-25 22:20:54] [config] dec-cell-high-depth: 1
[2023-06-25 22:20:54] [config] dec-depth: 1
[2023-06-25 22:20:54] [config] devices:
[2023-06-25 22:20:54] [config]   - 0
[2023-06-25 22:20:54] [config] dim-emb: 512
[2023-06-25 22:20:54] [config] dim-rnn: 1024
[2023-06-25 22:20:54] [config] dim-vocabs:
[2023-06-25 22:20:54] [config]   - 8192
[2023-06-25 22:20:54] [config]   - 8192
[2023-06-25 22:20:54] [config] disp-first: 0
[2023-06-25 22:20:54] [config] disp-freq: 1000u
[2023-06-25 22:20:54] [config] disp-label-counts: true
[2023-06-25 22:20:54] [config] dropout-rnn: 0.2
[2023-06-25 22:20:54] [config] dropout-src: 0.1
[2023-06-25 22:20:54] [config] dropout-trg: 0.1
[2023-06-25 22:20:54] [config] dump-config: ""
[2023-06-25 22:20:54] [config] dynamic-gradient-scaling:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] early-stopping: 10
[2023-06-25 22:20:54] [config] early-stopping-on: first
[2023-06-25 22:20:54] [config] embedding-fix-src: false
[2023-06-25 22:20:54] [config] embedding-fix-trg: false
[2023-06-25 22:20:54] [config] embedding-normalization: false
[2023-06-25 22:20:54] [config] embedding-vectors:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] enc-cell: gru
[2023-06-25 22:20:54] [config] enc-cell-depth: 1
[2023-06-25 22:20:54] [config] enc-depth: 1
[2023-06-25 22:20:54] [config] enc-type: bidirectional
[2023-06-25 22:20:54] [config] english-title-case-every: 0
[2023-06-25 22:20:54] [config] exponential-smoothing: 0
[2023-06-25 22:20:54] [config] factor-weight: 1
[2023-06-25 22:20:54] [config] factors-combine: sum
[2023-06-25 22:20:54] [config] factors-dim-emb: 0
[2023-06-25 22:20:54] [config] gradient-checkpointing: false
[2023-06-25 22:20:54] [config] gradient-norm-average-window: 100
[2023-06-25 22:20:54] [config] guided-alignment: none
[2023-06-25 22:20:54] [config] guided-alignment-cost: mse
[2023-06-25 22:20:54] [config] guided-alignment-weight: 0.1
[2023-06-25 22:20:54] [config] ignore-model-config: false
[2023-06-25 22:20:54] [config] input-types:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] interpolate-env-vars: false
[2023-06-25 22:20:54] [config] keep-best: false
[2023-06-25 22:20:54] [config] label-smoothing: 0
[2023-06-25 22:20:54] [config] layer-normalization: true
[2023-06-25 22:20:54] [config] learn-rate: 0.0001
[2023-06-25 22:20:54] [config] lemma-dependency: ""
[2023-06-25 22:20:54] [config] lemma-dim-emb: 0
[2023-06-25 22:20:54] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 22:20:54] [config] log-level: info
[2023-06-25 22:20:54] [config] log-time-zone: ""
[2023-06-25 22:20:54] [config] logical-epoch:
[2023-06-25 22:20:54] [config]   - 1e
[2023-06-25 22:20:54] [config]   - 0
[2023-06-25 22:20:54] [config] lr-decay: 0
[2023-06-25 22:20:54] [config] lr-decay-freq: 50000
[2023-06-25 22:20:54] [config] lr-decay-inv-sqrt:
[2023-06-25 22:20:54] [config]   - 0
[2023-06-25 22:20:54] [config] lr-decay-repeat-warmup: false
[2023-06-25 22:20:54] [config] lr-decay-reset-optimizer: false
[2023-06-25 22:20:54] [config] lr-decay-start:
[2023-06-25 22:20:54] [config]   - 10
[2023-06-25 22:20:54] [config]   - 1
[2023-06-25 22:20:54] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 22:20:54] [config] lr-report: false
[2023-06-25 22:20:54] [config] lr-warmup: 0
[2023-06-25 22:20:54] [config] lr-warmup-at-reload: false
[2023-06-25 22:20:54] [config] lr-warmup-cycle: false
[2023-06-25 22:20:54] [config] lr-warmup-start-rate: 0
[2023-06-25 22:20:54] [config] max-length: 50
[2023-06-25 22:20:54] [config] max-length-crop: false
[2023-06-25 22:20:54] [config] max-length-factor: 3
[2023-06-25 22:20:54] [config] maxi-batch: 100
[2023-06-25 22:20:54] [config] maxi-batch-sort: trg
[2023-06-25 22:20:54] [config] mini-batch: 64
[2023-06-25 22:20:54] [config] mini-batch-fit: true
[2023-06-25 22:20:54] [config] mini-batch-fit-step: 10
[2023-06-25 22:20:54] [config] mini-batch-round-up: true
[2023-06-25 22:20:54] [config] mini-batch-track-lr: false
[2023-06-25 22:20:54] [config] mini-batch-warmup: 0
[2023-06-25 22:20:54] [config] mini-batch-words: 0
[2023-06-25 22:20:54] [config] mini-batch-words-ref: 0
[2023-06-25 22:20:54] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:20:54] [config] multi-loss-type: sum
[2023-06-25 22:20:54] [config] n-best: false
[2023-06-25 22:20:54] [config] no-nccl: false
[2023-06-25 22:20:54] [config] no-reload: false
[2023-06-25 22:20:54] [config] no-restore-corpus: false
[2023-06-25 22:20:54] [config] normalize: 0.6
[2023-06-25 22:20:54] [config] normalize-gradient: false
[2023-06-25 22:20:54] [config] num-devices: 0
[2023-06-25 22:20:54] [config] optimizer: adam
[2023-06-25 22:20:54] [config] optimizer-delay: 1
[2023-06-25 22:20:54] [config] optimizer-params:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] output-omit-bias: false
[2023-06-25 22:20:54] [config] overwrite: false
[2023-06-25 22:20:54] [config] precision:
[2023-06-25 22:20:54] [config]   - float32
[2023-06-25 22:20:54] [config]   - float32
[2023-06-25 22:20:54] [config] pretrained-model: ""
[2023-06-25 22:20:54] [config] quantize-biases: false
[2023-06-25 22:20:54] [config] quantize-bits: 0
[2023-06-25 22:20:54] [config] quantize-log-based: false
[2023-06-25 22:20:54] [config] quantize-optimization-steps: 0
[2023-06-25 22:20:54] [config] quiet: false
[2023-06-25 22:20:54] [config] quiet-translation: true
[2023-06-25 22:20:54] [config] relative-paths: false
[2023-06-25 22:20:54] [config] right-left: false
[2023-06-25 22:20:54] [config] save-freq: 10000u
[2023-06-25 22:20:54] [config] seed: 1234
[2023-06-25 22:20:54] [config] sentencepiece-alphas:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] sentencepiece-max-lines: 2000000
[2023-06-25 22:20:54] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 22:20:54] [config] sharding: global
[2023-06-25 22:20:54] [config] shuffle: data
[2023-06-25 22:20:54] [config] shuffle-in-ram: false
[2023-06-25 22:20:54] [config] sigterm: save-and-exit
[2023-06-25 22:20:54] [config] skip: false
[2023-06-25 22:20:54] [config] sqlite: ""
[2023-06-25 22:20:54] [config] sqlite-drop: false
[2023-06-25 22:20:54] [config] sync-freq: 200u
[2023-06-25 22:20:54] [config] sync-sgd: false
[2023-06-25 22:20:54] [config] tempdir: /tmp
[2023-06-25 22:20:54] [config] tied-embeddings: false
[2023-06-25 22:20:54] [config] tied-embeddings-all: true
[2023-06-25 22:20:54] [config] tied-embeddings-src: false
[2023-06-25 22:20:54] [config] train-embedder-rank:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] train-sets:
[2023-06-25 22:20:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 22:20:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 22:20:54] [config] transformer-aan-activation: swish
[2023-06-25 22:20:54] [config] transformer-aan-depth: 2
[2023-06-25 22:20:54] [config] transformer-aan-nogate: false
[2023-06-25 22:20:54] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 22:20:54] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 22:20:54] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 22:20:54] [config] transformer-depth-scaling: false
[2023-06-25 22:20:54] [config] transformer-dim-aan: 2048
[2023-06-25 22:20:54] [config] transformer-dim-ffn: 2048
[2023-06-25 22:20:54] [config] transformer-dropout: 0
[2023-06-25 22:20:54] [config] transformer-dropout-attention: 0
[2023-06-25 22:20:54] [config] transformer-dropout-ffn: 0
[2023-06-25 22:20:54] [config] transformer-ffn-activation: swish
[2023-06-25 22:20:54] [config] transformer-ffn-depth: 2
[2023-06-25 22:20:54] [config] transformer-guided-alignment-layer: last
[2023-06-25 22:20:54] [config] transformer-heads: 8
[2023-06-25 22:20:54] [config] transformer-no-projection: false
[2023-06-25 22:20:54] [config] transformer-pool: false
[2023-06-25 22:20:54] [config] transformer-postprocess: dan
[2023-06-25 22:20:54] [config] transformer-postprocess-emb: d
[2023-06-25 22:20:54] [config] transformer-postprocess-top: ""
[2023-06-25 22:20:54] [config] transformer-preprocess: ""
[2023-06-25 22:20:54] [config] transformer-tied-layers:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] transformer-train-position-embeddings: false
[2023-06-25 22:20:54] [config] tsv: false
[2023-06-25 22:20:54] [config] tsv-fields: 0
[2023-06-25 22:20:54] [config] type: amun
[2023-06-25 22:20:54] [config] ulr: false
[2023-06-25 22:20:54] [config] ulr-dim-emb: 0
[2023-06-25 22:20:54] [config] ulr-dropout: 0
[2023-06-25 22:20:54] [config] ulr-keys-vectors: ""
[2023-06-25 22:20:54] [config] ulr-query-vectors: ""
[2023-06-25 22:20:54] [config] ulr-softmax-temperature: 1
[2023-06-25 22:20:54] [config] ulr-trainable-transformation: false
[2023-06-25 22:20:54] [config] unlikelihood-loss: false
[2023-06-25 22:20:54] [config] valid-freq: 5000000
[2023-06-25 22:20:54] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 22:20:54] [config] valid-max-length: 1000
[2023-06-25 22:20:54] [config] valid-metrics:
[2023-06-25 22:20:54] [config]   - cross-entropy
[2023-06-25 22:20:54] [config]   - translation
[2023-06-25 22:20:54] [config] valid-mini-batch: 32
[2023-06-25 22:20:54] [config] valid-reset-stalled: false
[2023-06-25 22:20:54] [config] valid-script-args:
[2023-06-25 22:20:54] [config]   []
[2023-06-25 22:20:54] [config] valid-script-path: ""
[2023-06-25 22:20:54] [config] valid-sets:
[2023-06-25 22:20:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 22:20:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 22:20:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 22:20:54] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:20:54] [config] vocabs:
[2023-06-25 22:20:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:20:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:20:54] [config] word-penalty: 0
[2023-06-25 22:20:54] [config] word-scores: false
[2023-06-25 22:20:54] [config] workspace: 3000
[2023-06-25 22:20:54] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:20:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:20:54] [training] Using single-device training
[2023-06-25 22:20:55] Synced seed 1234
[2023-06-25 22:20:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:20:55] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 22:20:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:20:55] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 22:20:55] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 22:20:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:20:55] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:20:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:20:55] [comm] Using global sharding
[2023-06-25 22:20:55] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:20:55] [training] Using 1 GPUs
[2023-06-25 22:20:55] [logits] Applying loss function for 1 factor(s)
[2023-06-25 22:20:55] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:20:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 22:20:56] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:21:12] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 22:21:12] [valid] No post-processing script given for validating translator
[2023-06-25 22:21:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:21:12] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:21:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:21:12] [comm] Using global sharding
[2023-06-25 22:21:12] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:21:12] [training] Using 1 GPUs
[2023-06-25 22:21:12] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:21:13] Loading Adam parameters
[2023-06-25 22:21:13] [memory] Reserving 290 MB, device gpu0
[2023-06-25 22:21:13] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:21:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:21:13] [data] Restoring the corpus state to epoch 11, batch 885
[2023-06-25 22:21:13] [data] Shuffling data
[2023-06-25 22:21:13] [data] Done reading 20,192 sentences
[2023-06-25 22:21:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:21:13] Training started
[2023-06-25 22:21:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 22:21:13] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:21:13] Parameter type float32, optimization type float32, casting types false
[2023-06-25 22:21:55] Seen 15,667 samples
[2023-06-25 22:21:55] Starting data epoch 12 in logical epoch 12
[2023-06-25 22:21:55] [data] Shuffling data
[2023-06-25 22:21:55] [data] Done reading 20,192 sentences
[2023-06-25 22:21:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:22:07] Ep. 12 : Up. 1000 : Sen. 4,691 : Cost 5.43968248 * 4,250,217 @ 3,478 after 4,250,217 : Time 55.49s : 76593.42 words/s : gNorm 1.3039
[2023-06-25 22:22:41] Seen 15,667 samples
[2023-06-25 22:22:41] Starting data epoch 13 in logical epoch 13
[2023-06-25 22:22:41] [data] Shuffling data
[2023-06-25 22:22:41] [data] Done reading 20,192 sentences
[2023-06-25 22:22:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:23:24] Seen 15,667 samples
[2023-06-25 22:23:24] Starting data epoch 14 in logical epoch 14
[2023-06-25 22:23:24] [data] Shuffling data
[2023-06-25 22:23:24] [data] Done reading 20,192 sentences
[2023-06-25 22:23:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:24:09] Seen 15,667 samples
[2023-06-25 22:24:09] Starting data epoch 15 in logical epoch 15
[2023-06-25 22:24:09] [data] Shuffling data
[2023-06-25 22:24:09] [data] Done reading 20,192 sentences
[2023-06-25 22:24:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:24:55] Seen 15,667 samples
[2023-06-25 22:24:55] Starting data epoch 16 in logical epoch 16
[2023-06-25 22:24:55] [data] Shuffling data
[2023-06-25 22:24:55] [data] Done reading 20,192 sentences
[2023-06-25 22:24:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:25:40] Seen 15,667 samples
[2023-06-25 22:25:40] Starting data epoch 17 in logical epoch 17
[2023-06-25 22:25:40] [data] Shuffling data
[2023-06-25 22:25:40] [data] Done reading 20,192 sentences
[2023-06-25 22:25:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:26:22] Seen 15,667 samples
[2023-06-25 22:26:22] Starting data epoch 18 in logical epoch 18
[2023-06-25 22:26:22] [data] Shuffling data
[2023-06-25 22:26:22] [data] Done reading 20,192 sentences
[2023-06-25 22:26:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:27:06] Seen 15,667 samples
[2023-06-25 22:27:06] Starting data epoch 19 in logical epoch 19
[2023-06-25 22:27:06] [data] Shuffling data
[2023-06-25 22:27:06] [data] Done reading 20,192 sentences
[2023-06-25 22:27:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:27:51] Seen 15,667 samples
[2023-06-25 22:27:51] Starting data epoch 20 in logical epoch 20
[2023-06-25 22:27:51] [data] Shuffling data
[2023-06-25 22:27:51] [data] Done reading 20,192 sentences
[2023-06-25 22:27:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:28:35] Seen 15,667 samples
[2023-06-25 22:28:35] Starting data epoch 21 in logical epoch 21
[2023-06-25 22:28:35] Training finished
[2023-06-25 22:28:44] [valid] Ep. 21 : Up. 1767 : cross-entropy : 138.907 : new best
[2023-06-25 22:29:24] [valid] Ep. 21 : Up. 1767 : translation : 0 : new best
[2023-06-25 22:29:24] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:29:26] Saving Adam parameters
[2023-06-25 22:29:26] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:32:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:32:27] [marian] Running on node07.datos.cluster.uy as process 7907 with command line:
[2023-06-25 22:32:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 22:32:27] [config] after: 0e
[2023-06-25 22:32:27] [config] after-batches: 0
[2023-06-25 22:32:27] [config] after-epochs: 30
[2023-06-25 22:32:27] [config] all-caps-every: 0
[2023-06-25 22:32:27] [config] allow-unk: false
[2023-06-25 22:32:27] [config] authors: false
[2023-06-25 22:32:27] [config] beam-size: 6
[2023-06-25 22:32:27] [config] bert-class-symbol: "[CLS]"
[2023-06-25 22:32:27] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 22:32:27] [config] bert-masking-fraction: 0.15
[2023-06-25 22:32:27] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 22:32:27] [config] bert-train-type-embeddings: true
[2023-06-25 22:32:27] [config] bert-type-vocab-size: 2
[2023-06-25 22:32:27] [config] build-info: ""
[2023-06-25 22:32:27] [config] check-gradient-nan: false
[2023-06-25 22:32:27] [config] check-nan: false
[2023-06-25 22:32:27] [config] cite: false
[2023-06-25 22:32:27] [config] clip-norm: 1
[2023-06-25 22:32:27] [config] cost-scaling:
[2023-06-25 22:32:27] [config]   []
[2023-06-25 22:32:27] [config] cost-type: ce-sum
[2023-06-25 22:32:27] [config] cpu-threads: 0
[2023-06-25 22:32:27] [config] data-threads: 8
[2023-06-25 22:32:27] [config] data-weighting: ""
[2023-06-25 22:32:27] [config] data-weighting-type: sentence
[2023-06-25 22:32:27] [config] dec-cell: gru
[2023-06-25 22:32:27] [config] dec-cell-base-depth: 2
[2023-06-25 22:32:27] [config] dec-cell-high-depth: 1
[2023-06-25 22:32:27] [config] dec-depth: 1
[2023-06-25 22:32:27] [config] devices:
[2023-06-25 22:32:27] [config]   - 0
[2023-06-25 22:32:27] [config] dim-emb: 512
[2023-06-25 22:32:27] [config] dim-rnn: 1024
[2023-06-25 22:32:27] [config] dim-vocabs:
[2023-06-25 22:32:27] [config]   - 8192
[2023-06-25 22:32:27] [config]   - 8192
[2023-06-25 22:32:27] [config] disp-first: 0
[2023-06-25 22:32:27] [config] disp-freq: 1000u
[2023-06-25 22:32:27] [config] disp-label-counts: true
[2023-06-25 22:32:27] [config] dropout-rnn: 0.2
[2023-06-25 22:32:27] [config] dropout-src: 0.1
[2023-06-25 22:32:27] [config] dropout-trg: 0.1
[2023-06-25 22:32:27] [config] dump-config: ""
[2023-06-25 22:32:27] [config] dynamic-gradient-scaling:
[2023-06-25 22:32:27] [config]   []
[2023-06-25 22:32:27] [config] early-stopping: 10
[2023-06-25 22:32:27] [config] early-stopping-on: first
[2023-06-25 22:32:27] [config] embedding-fix-src: false
[2023-06-25 22:32:27] [config] embedding-fix-trg: false
[2023-06-25 22:32:27] [config] embedding-normalization: false
[2023-06-25 22:32:27] [config] embedding-vectors:
[2023-06-25 22:32:27] [config]   []
[2023-06-25 22:32:27] [config] enc-cell: gru
[2023-06-25 22:32:27] [config] enc-cell-depth: 1
[2023-06-25 22:32:27] [config] enc-depth: 1
[2023-06-25 22:32:27] [config] enc-type: bidirectional
[2023-06-25 22:32:27] [config] english-title-case-every: 0
[2023-06-25 22:32:27] [config] exponential-smoothing: 0
[2023-06-25 22:32:27] [config] factor-weight: 1
[2023-06-25 22:32:27] [config] factors-combine: sum
[2023-06-25 22:32:27] [config] factors-dim-emb: 0
[2023-06-25 22:32:27] [config] gradient-checkpointing: false
[2023-06-25 22:32:27] [config] gradient-norm-average-window: 100
[2023-06-25 22:32:27] [config] guided-alignment: none
[2023-06-25 22:32:27] [config] guided-alignment-cost: mse
[2023-06-25 22:32:27] [config] guided-alignment-weight: 0.1
[2023-06-25 22:32:27] [config] ignore-model-config: false
[2023-06-25 22:32:27] [config] input-types:
[2023-06-25 22:32:27] [config]   []
[2023-06-25 22:32:27] [config] interpolate-env-vars: false
[2023-06-25 22:32:27] [config] keep-best: false
[2023-06-25 22:32:27] [config] label-smoothing: 0
[2023-06-25 22:32:27] [config] layer-normalization: true
[2023-06-25 22:32:27] [config] learn-rate: 0.0001
[2023-06-25 22:32:27] [config] lemma-dependency: ""
[2023-06-25 22:32:27] [config] lemma-dim-emb: 0
[2023-06-25 22:32:27] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 22:32:27] [config] log-level: info
[2023-06-25 22:32:27] [config] log-time-zone: ""
[2023-06-25 22:32:27] [config] logical-epoch:
[2023-06-25 22:32:27] [config]   - 1e
[2023-06-25 22:32:27] [config]   - 0
[2023-06-25 22:32:27] [config] lr-decay: 0
[2023-06-25 22:32:27] [config] lr-decay-freq: 50000
[2023-06-25 22:32:27] [config] lr-decay-inv-sqrt:
[2023-06-25 22:32:27] [config]   - 0
[2023-06-25 22:32:27] [config] lr-decay-repeat-warmup: false
[2023-06-25 22:32:27] [config] lr-decay-reset-optimizer: false
[2023-06-25 22:32:27] [config] lr-decay-start:
[2023-06-25 22:32:28] [config]   - 10
[2023-06-25 22:32:28] [config]   - 1
[2023-06-25 22:32:28] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 22:32:28] [config] lr-report: false
[2023-06-25 22:32:28] [config] lr-warmup: 0
[2023-06-25 22:32:28] [config] lr-warmup-at-reload: false
[2023-06-25 22:32:28] [config] lr-warmup-cycle: false
[2023-06-25 22:32:28] [config] lr-warmup-start-rate: 0
[2023-06-25 22:32:28] [config] max-length: 50
[2023-06-25 22:32:28] [config] max-length-crop: false
[2023-06-25 22:32:28] [config] max-length-factor: 3
[2023-06-25 22:32:28] [config] maxi-batch: 100
[2023-06-25 22:32:28] [config] maxi-batch-sort: trg
[2023-06-25 22:32:28] [config] mini-batch: 64
[2023-06-25 22:32:28] [config] mini-batch-fit: true
[2023-06-25 22:32:28] [config] mini-batch-fit-step: 10
[2023-06-25 22:32:28] [config] mini-batch-round-up: true
[2023-06-25 22:32:28] [config] mini-batch-track-lr: false
[2023-06-25 22:32:28] [config] mini-batch-warmup: 0
[2023-06-25 22:32:28] [config] mini-batch-words: 0
[2023-06-25 22:32:28] [config] mini-batch-words-ref: 0
[2023-06-25 22:32:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:32:28] [config] multi-loss-type: sum
[2023-06-25 22:32:28] [config] n-best: false
[2023-06-25 22:32:28] [config] no-nccl: false
[2023-06-25 22:32:28] [config] no-reload: false
[2023-06-25 22:32:28] [config] no-restore-corpus: false
[2023-06-25 22:32:28] [config] normalize: 0.6
[2023-06-25 22:32:28] [config] normalize-gradient: false
[2023-06-25 22:32:28] [config] num-devices: 0
[2023-06-25 22:32:28] [config] optimizer: adam
[2023-06-25 22:32:28] [config] optimizer-delay: 1
[2023-06-25 22:32:28] [config] optimizer-params:
[2023-06-25 22:32:28] [config]   []
[2023-06-25 22:32:28] [config] output-omit-bias: false
[2023-06-25 22:32:28] [config] overwrite: false
[2023-06-25 22:32:28] [config] precision:
[2023-06-25 22:32:28] [config]   - float32
[2023-06-25 22:32:28] [config]   - float32
[2023-06-25 22:32:28] [config] pretrained-model: ""
[2023-06-25 22:32:28] [config] quantize-biases: false
[2023-06-25 22:32:28] [config] quantize-bits: 0
[2023-06-25 22:32:28] [config] quantize-log-based: false
[2023-06-25 22:32:28] [config] quantize-optimization-steps: 0
[2023-06-25 22:32:28] [config] quiet: false
[2023-06-25 22:32:28] [config] quiet-translation: true
[2023-06-25 22:32:28] [config] relative-paths: false
[2023-06-25 22:32:28] [config] right-left: false
[2023-06-25 22:32:28] [config] save-freq: 10000u
[2023-06-25 22:32:28] [config] seed: 1234
[2023-06-25 22:32:28] [config] sentencepiece-alphas:
[2023-06-25 22:32:28] [config]   []
[2023-06-25 22:32:28] [config] sentencepiece-max-lines: 2000000
[2023-06-25 22:32:28] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 22:32:28] [config] sharding: global
[2023-06-25 22:32:28] [config] shuffle: data
[2023-06-25 22:32:28] [config] shuffle-in-ram: false
[2023-06-25 22:32:28] [config] sigterm: save-and-exit
[2023-06-25 22:32:28] [config] skip: false
[2023-06-25 22:32:28] [config] sqlite: ""
[2023-06-25 22:32:28] [config] sqlite-drop: false
[2023-06-25 22:32:28] [config] sync-freq: 200u
[2023-06-25 22:32:28] [config] sync-sgd: false
[2023-06-25 22:32:28] [config] tempdir: /tmp
[2023-06-25 22:32:28] [config] tied-embeddings: false
[2023-06-25 22:32:28] [config] tied-embeddings-all: true
[2023-06-25 22:32:28] [config] tied-embeddings-src: false
[2023-06-25 22:32:28] [config] train-embedder-rank:
[2023-06-25 22:32:28] [config]   []
[2023-06-25 22:32:28] [config] train-sets:
[2023-06-25 22:32:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 22:32:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 22:32:28] [config] transformer-aan-activation: swish
[2023-06-25 22:32:28] [config] transformer-aan-depth: 2
[2023-06-25 22:32:28] [config] transformer-aan-nogate: false
[2023-06-25 22:32:28] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 22:32:28] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 22:32:28] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 22:32:28] [config] transformer-depth-scaling: false
[2023-06-25 22:32:28] [config] transformer-dim-aan: 2048
[2023-06-25 22:32:28] [config] transformer-dim-ffn: 2048
[2023-06-25 22:32:28] [config] transformer-dropout: 0
[2023-06-25 22:32:28] [config] transformer-dropout-attention: 0
[2023-06-25 22:32:28] [config] transformer-dropout-ffn: 0
[2023-06-25 22:32:28] [config] transformer-ffn-activation: swish
[2023-06-25 22:32:28] [config] transformer-ffn-depth: 2
[2023-06-25 22:32:28] [config] transformer-guided-alignment-layer: last
[2023-06-25 22:32:28] [config] transformer-heads: 8
[2023-06-25 22:32:28] [config] transformer-no-projection: false
[2023-06-25 22:32:28] [config] transformer-pool: false
[2023-06-25 22:32:28] [config] transformer-postprocess: dan
[2023-06-25 22:32:28] [config] transformer-postprocess-emb: d
[2023-06-25 22:32:28] [config] transformer-postprocess-top: ""
[2023-06-25 22:32:28] [config] transformer-preprocess: ""
[2023-06-25 22:32:28] [config] transformer-tied-layers:
[2023-06-25 22:32:28] [config]   []
[2023-06-25 22:32:28] [config] transformer-train-position-embeddings: false
[2023-06-25 22:32:28] [config] tsv: false
[2023-06-25 22:32:28] [config] tsv-fields: 0
[2023-06-25 22:32:28] [config] type: amun
[2023-06-25 22:32:28] [config] ulr: false
[2023-06-25 22:32:28] [config] ulr-dim-emb: 0
[2023-06-25 22:32:28] [config] ulr-dropout: 0
[2023-06-25 22:32:28] [config] ulr-keys-vectors: ""
[2023-06-25 22:32:28] [config] ulr-query-vectors: ""
[2023-06-25 22:32:28] [config] ulr-softmax-temperature: 1
[2023-06-25 22:32:28] [config] ulr-trainable-transformation: false
[2023-06-25 22:32:28] [config] unlikelihood-loss: false
[2023-06-25 22:32:28] [config] valid-freq: 5000000
[2023-06-25 22:32:28] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 22:32:28] [config] valid-max-length: 1000
[2023-06-25 22:32:28] [config] valid-metrics:
[2023-06-25 22:32:28] [config]   - cross-entropy
[2023-06-25 22:32:28] [config]   - translation
[2023-06-25 22:32:28] [config] valid-mini-batch: 32
[2023-06-25 22:32:28] [config] valid-reset-stalled: false
[2023-06-25 22:32:28] [config] valid-script-args:
[2023-06-25 22:32:28] [config]   []
[2023-06-25 22:32:28] [config] valid-script-path: ""
[2023-06-25 22:32:28] [config] valid-sets:
[2023-06-25 22:32:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 22:32:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 22:32:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 22:32:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:32:28] [config] vocabs:
[2023-06-25 22:32:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:32:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:32:28] [config] word-penalty: 0
[2023-06-25 22:32:28] [config] word-scores: false
[2023-06-25 22:32:28] [config] workspace: 3000
[2023-06-25 22:32:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:32:28] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:32:28] [training] Using single-device training
[2023-06-25 22:32:29] Synced seed 1234
[2023-06-25 22:32:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:32:29] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 22:32:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:32:29] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 22:32:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 22:32:29] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:32:29] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:32:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:32:29] [comm] Using global sharding
[2023-06-25 22:32:29] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:32:29] [training] Using 1 GPUs
[2023-06-25 22:32:29] [logits] Applying loss function for 1 factor(s)
[2023-06-25 22:32:29] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:32:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 22:32:30] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:32:45] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 22:32:45] [valid] No post-processing script given for validating translator
[2023-06-25 22:32:45] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:32:45] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:32:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:32:45] [comm] Using global sharding
[2023-06-25 22:32:45] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:32:45] [training] Using 1 GPUs
[2023-06-25 22:32:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:32:46] Loading Adam parameters
[2023-06-25 22:32:47] [memory] Reserving 290 MB, device gpu0
[2023-06-25 22:32:47] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:32:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:32:47] [data] Restoring the corpus state to epoch 21, batch 1767
[2023-06-25 22:32:47] [data] Shuffling data
[2023-06-25 22:32:47] [data] Done reading 20,192 sentences
[2023-06-25 22:32:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:32:47] Training started
[2023-06-25 22:32:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 22:32:47] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:32:47] Parameter type float32, optimization type float32, casting types false
[2023-06-25 22:33:29] Seen 15,667 samples
[2023-06-25 22:33:29] Starting data epoch 22 in logical epoch 22
[2023-06-25 22:33:29] [data] Shuffling data
[2023-06-25 22:33:29] [data] Done reading 20,192 sentences
[2023-06-25 22:33:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:34:14] Seen 15,667 samples
[2023-06-25 22:34:14] Starting data epoch 23 in logical epoch 23
[2023-06-25 22:34:14] [data] Shuffling data
[2023-06-25 22:34:14] [data] Done reading 20,192 sentences
[2023-06-25 22:34:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:34:44] Ep. 23 : Up. 2000 : Sen. 10,520 : Cost 4.12665272 * 4,272,331 @ 7,344 after 8,522,548 : Time 118.94s : 35919.06 words/s : gNorm 1.2613
[2023-06-25 22:34:59] Seen 15,667 samples
[2023-06-25 22:34:59] Starting data epoch 24 in logical epoch 24
[2023-06-25 22:34:59] [data] Shuffling data
[2023-06-25 22:34:59] [data] Done reading 20,192 sentences
[2023-06-25 22:34:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:35:43] Seen 15,667 samples
[2023-06-25 22:35:43] Starting data epoch 25 in logical epoch 25
[2023-06-25 22:35:43] [data] Shuffling data
[2023-06-25 22:35:43] [data] Done reading 20,192 sentences
[2023-06-25 22:35:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:36:28] Seen 15,667 samples
[2023-06-25 22:36:28] Starting data epoch 26 in logical epoch 26
[2023-06-25 22:36:28] [data] Shuffling data
[2023-06-25 22:36:28] [data] Done reading 20,192 sentences
[2023-06-25 22:36:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:37:12] Seen 15,667 samples
[2023-06-25 22:37:12] Starting data epoch 27 in logical epoch 27
[2023-06-25 22:37:12] [data] Shuffling data
[2023-06-25 22:37:12] [data] Done reading 20,192 sentences
[2023-06-25 22:37:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:37:55] Seen 15,667 samples
[2023-06-25 22:37:55] Starting data epoch 28 in logical epoch 28
[2023-06-25 22:37:55] [data] Shuffling data
[2023-06-25 22:37:55] [data] Done reading 20,192 sentences
[2023-06-25 22:37:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:38:42] Seen 15,667 samples
[2023-06-25 22:38:42] Starting data epoch 29 in logical epoch 29
[2023-06-25 22:38:42] [data] Shuffling data
[2023-06-25 22:38:42] [data] Done reading 20,192 sentences
[2023-06-25 22:38:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:39:28] Seen 15,667 samples
[2023-06-25 22:39:28] Starting data epoch 30 in logical epoch 30
[2023-06-25 22:39:28] [data] Shuffling data
[2023-06-25 22:39:28] [data] Done reading 20,192 sentences
[2023-06-25 22:39:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:40:13] Seen 15,667 samples
[2023-06-25 22:40:13] Starting data epoch 31 in logical epoch 31
[2023-06-25 22:40:13] Training finished
[2023-06-25 22:40:22] [valid] Ep. 31 : Up. 2649 : cross-entropy : 130.3 : new best
[2023-06-25 22:41:04] [valid] Ep. 31 : Up. 2649 : translation : 0 : new best
[2023-06-25 22:41:04] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:41:05] Saving Adam parameters
[2023-06-25 22:41:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:44:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:44:14] [marian] Running on node07.datos.cluster.uy as process 8931 with command line:
[2023-06-25 22:44:14] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 22:44:14] [config] after: 0e
[2023-06-25 22:44:14] [config] after-batches: 0
[2023-06-25 22:44:14] [config] after-epochs: 40
[2023-06-25 22:44:14] [config] all-caps-every: 0
[2023-06-25 22:44:14] [config] allow-unk: false
[2023-06-25 22:44:14] [config] authors: false
[2023-06-25 22:44:14] [config] beam-size: 6
[2023-06-25 22:44:14] [config] bert-class-symbol: "[CLS]"
[2023-06-25 22:44:14] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 22:44:14] [config] bert-masking-fraction: 0.15
[2023-06-25 22:44:14] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 22:44:14] [config] bert-train-type-embeddings: true
[2023-06-25 22:44:14] [config] bert-type-vocab-size: 2
[2023-06-25 22:44:14] [config] build-info: ""
[2023-06-25 22:44:14] [config] check-gradient-nan: false
[2023-06-25 22:44:14] [config] check-nan: false
[2023-06-25 22:44:14] [config] cite: false
[2023-06-25 22:44:14] [config] clip-norm: 1
[2023-06-25 22:44:14] [config] cost-scaling:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] cost-type: ce-sum
[2023-06-25 22:44:14] [config] cpu-threads: 0
[2023-06-25 22:44:14] [config] data-threads: 8
[2023-06-25 22:44:14] [config] data-weighting: ""
[2023-06-25 22:44:14] [config] data-weighting-type: sentence
[2023-06-25 22:44:14] [config] dec-cell: gru
[2023-06-25 22:44:14] [config] dec-cell-base-depth: 2
[2023-06-25 22:44:14] [config] dec-cell-high-depth: 1
[2023-06-25 22:44:14] [config] dec-depth: 1
[2023-06-25 22:44:14] [config] devices:
[2023-06-25 22:44:14] [config]   - 0
[2023-06-25 22:44:14] [config] dim-emb: 512
[2023-06-25 22:44:14] [config] dim-rnn: 1024
[2023-06-25 22:44:14] [config] dim-vocabs:
[2023-06-25 22:44:14] [config]   - 8192
[2023-06-25 22:44:14] [config]   - 8192
[2023-06-25 22:44:14] [config] disp-first: 0
[2023-06-25 22:44:14] [config] disp-freq: 1000u
[2023-06-25 22:44:14] [config] disp-label-counts: true
[2023-06-25 22:44:14] [config] dropout-rnn: 0.2
[2023-06-25 22:44:14] [config] dropout-src: 0.1
[2023-06-25 22:44:14] [config] dropout-trg: 0.1
[2023-06-25 22:44:14] [config] dump-config: ""
[2023-06-25 22:44:14] [config] dynamic-gradient-scaling:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] early-stopping: 10
[2023-06-25 22:44:14] [config] early-stopping-on: first
[2023-06-25 22:44:14] [config] embedding-fix-src: false
[2023-06-25 22:44:14] [config] embedding-fix-trg: false
[2023-06-25 22:44:14] [config] embedding-normalization: false
[2023-06-25 22:44:14] [config] embedding-vectors:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] enc-cell: gru
[2023-06-25 22:44:14] [config] enc-cell-depth: 1
[2023-06-25 22:44:14] [config] enc-depth: 1
[2023-06-25 22:44:14] [config] enc-type: bidirectional
[2023-06-25 22:44:14] [config] english-title-case-every: 0
[2023-06-25 22:44:14] [config] exponential-smoothing: 0
[2023-06-25 22:44:14] [config] factor-weight: 1
[2023-06-25 22:44:14] [config] factors-combine: sum
[2023-06-25 22:44:14] [config] factors-dim-emb: 0
[2023-06-25 22:44:14] [config] gradient-checkpointing: false
[2023-06-25 22:44:14] [config] gradient-norm-average-window: 100
[2023-06-25 22:44:14] [config] guided-alignment: none
[2023-06-25 22:44:14] [config] guided-alignment-cost: mse
[2023-06-25 22:44:14] [config] guided-alignment-weight: 0.1
[2023-06-25 22:44:14] [config] ignore-model-config: false
[2023-06-25 22:44:14] [config] input-types:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] interpolate-env-vars: false
[2023-06-25 22:44:14] [config] keep-best: false
[2023-06-25 22:44:14] [config] label-smoothing: 0
[2023-06-25 22:44:14] [config] layer-normalization: true
[2023-06-25 22:44:14] [config] learn-rate: 0.0001
[2023-06-25 22:44:14] [config] lemma-dependency: ""
[2023-06-25 22:44:14] [config] lemma-dim-emb: 0
[2023-06-25 22:44:14] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 22:44:14] [config] log-level: info
[2023-06-25 22:44:14] [config] log-time-zone: ""
[2023-06-25 22:44:14] [config] logical-epoch:
[2023-06-25 22:44:14] [config]   - 1e
[2023-06-25 22:44:14] [config]   - 0
[2023-06-25 22:44:14] [config] lr-decay: 0
[2023-06-25 22:44:14] [config] lr-decay-freq: 50000
[2023-06-25 22:44:14] [config] lr-decay-inv-sqrt:
[2023-06-25 22:44:14] [config]   - 0
[2023-06-25 22:44:14] [config] lr-decay-repeat-warmup: false
[2023-06-25 22:44:14] [config] lr-decay-reset-optimizer: false
[2023-06-25 22:44:14] [config] lr-decay-start:
[2023-06-25 22:44:14] [config]   - 10
[2023-06-25 22:44:14] [config]   - 1
[2023-06-25 22:44:14] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 22:44:14] [config] lr-report: false
[2023-06-25 22:44:14] [config] lr-warmup: 0
[2023-06-25 22:44:14] [config] lr-warmup-at-reload: false
[2023-06-25 22:44:14] [config] lr-warmup-cycle: false
[2023-06-25 22:44:14] [config] lr-warmup-start-rate: 0
[2023-06-25 22:44:14] [config] max-length: 50
[2023-06-25 22:44:14] [config] max-length-crop: false
[2023-06-25 22:44:14] [config] max-length-factor: 3
[2023-06-25 22:44:14] [config] maxi-batch: 100
[2023-06-25 22:44:14] [config] maxi-batch-sort: trg
[2023-06-25 22:44:14] [config] mini-batch: 64
[2023-06-25 22:44:14] [config] mini-batch-fit: true
[2023-06-25 22:44:14] [config] mini-batch-fit-step: 10
[2023-06-25 22:44:14] [config] mini-batch-round-up: true
[2023-06-25 22:44:14] [config] mini-batch-track-lr: false
[2023-06-25 22:44:14] [config] mini-batch-warmup: 0
[2023-06-25 22:44:14] [config] mini-batch-words: 0
[2023-06-25 22:44:14] [config] mini-batch-words-ref: 0
[2023-06-25 22:44:14] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:44:14] [config] multi-loss-type: sum
[2023-06-25 22:44:14] [config] n-best: false
[2023-06-25 22:44:14] [config] no-nccl: false
[2023-06-25 22:44:14] [config] no-reload: false
[2023-06-25 22:44:14] [config] no-restore-corpus: false
[2023-06-25 22:44:14] [config] normalize: 0.6
[2023-06-25 22:44:14] [config] normalize-gradient: false
[2023-06-25 22:44:14] [config] num-devices: 0
[2023-06-25 22:44:14] [config] optimizer: adam
[2023-06-25 22:44:14] [config] optimizer-delay: 1
[2023-06-25 22:44:14] [config] optimizer-params:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] output-omit-bias: false
[2023-06-25 22:44:14] [config] overwrite: false
[2023-06-25 22:44:14] [config] precision:
[2023-06-25 22:44:14] [config]   - float32
[2023-06-25 22:44:14] [config]   - float32
[2023-06-25 22:44:14] [config] pretrained-model: ""
[2023-06-25 22:44:14] [config] quantize-biases: false
[2023-06-25 22:44:14] [config] quantize-bits: 0
[2023-06-25 22:44:14] [config] quantize-log-based: false
[2023-06-25 22:44:14] [config] quantize-optimization-steps: 0
[2023-06-25 22:44:14] [config] quiet: false
[2023-06-25 22:44:14] [config] quiet-translation: true
[2023-06-25 22:44:14] [config] relative-paths: false
[2023-06-25 22:44:14] [config] right-left: false
[2023-06-25 22:44:14] [config] save-freq: 10000u
[2023-06-25 22:44:14] [config] seed: 1234
[2023-06-25 22:44:14] [config] sentencepiece-alphas:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] sentencepiece-max-lines: 2000000
[2023-06-25 22:44:14] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 22:44:14] [config] sharding: global
[2023-06-25 22:44:14] [config] shuffle: data
[2023-06-25 22:44:14] [config] shuffle-in-ram: false
[2023-06-25 22:44:14] [config] sigterm: save-and-exit
[2023-06-25 22:44:14] [config] skip: false
[2023-06-25 22:44:14] [config] sqlite: ""
[2023-06-25 22:44:14] [config] sqlite-drop: false
[2023-06-25 22:44:14] [config] sync-freq: 200u
[2023-06-25 22:44:14] [config] sync-sgd: false
[2023-06-25 22:44:14] [config] tempdir: /tmp
[2023-06-25 22:44:14] [config] tied-embeddings: false
[2023-06-25 22:44:14] [config] tied-embeddings-all: true
[2023-06-25 22:44:14] [config] tied-embeddings-src: false
[2023-06-25 22:44:14] [config] train-embedder-rank:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] train-sets:
[2023-06-25 22:44:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 22:44:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 22:44:14] [config] transformer-aan-activation: swish
[2023-06-25 22:44:14] [config] transformer-aan-depth: 2
[2023-06-25 22:44:14] [config] transformer-aan-nogate: false
[2023-06-25 22:44:14] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 22:44:14] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 22:44:14] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 22:44:14] [config] transformer-depth-scaling: false
[2023-06-25 22:44:14] [config] transformer-dim-aan: 2048
[2023-06-25 22:44:14] [config] transformer-dim-ffn: 2048
[2023-06-25 22:44:14] [config] transformer-dropout: 0
[2023-06-25 22:44:14] [config] transformer-dropout-attention: 0
[2023-06-25 22:44:14] [config] transformer-dropout-ffn: 0
[2023-06-25 22:44:14] [config] transformer-ffn-activation: swish
[2023-06-25 22:44:14] [config] transformer-ffn-depth: 2
[2023-06-25 22:44:14] [config] transformer-guided-alignment-layer: last
[2023-06-25 22:44:14] [config] transformer-heads: 8
[2023-06-25 22:44:14] [config] transformer-no-projection: false
[2023-06-25 22:44:14] [config] transformer-pool: false
[2023-06-25 22:44:14] [config] transformer-postprocess: dan
[2023-06-25 22:44:14] [config] transformer-postprocess-emb: d
[2023-06-25 22:44:14] [config] transformer-postprocess-top: ""
[2023-06-25 22:44:14] [config] transformer-preprocess: ""
[2023-06-25 22:44:14] [config] transformer-tied-layers:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] transformer-train-position-embeddings: false
[2023-06-25 22:44:14] [config] tsv: false
[2023-06-25 22:44:14] [config] tsv-fields: 0
[2023-06-25 22:44:14] [config] type: amun
[2023-06-25 22:44:14] [config] ulr: false
[2023-06-25 22:44:14] [config] ulr-dim-emb: 0
[2023-06-25 22:44:14] [config] ulr-dropout: 0
[2023-06-25 22:44:14] [config] ulr-keys-vectors: ""
[2023-06-25 22:44:14] [config] ulr-query-vectors: ""
[2023-06-25 22:44:14] [config] ulr-softmax-temperature: 1
[2023-06-25 22:44:14] [config] ulr-trainable-transformation: false
[2023-06-25 22:44:14] [config] unlikelihood-loss: false
[2023-06-25 22:44:14] [config] valid-freq: 5000000
[2023-06-25 22:44:14] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 22:44:14] [config] valid-max-length: 1000
[2023-06-25 22:44:14] [config] valid-metrics:
[2023-06-25 22:44:14] [config]   - cross-entropy
[2023-06-25 22:44:14] [config]   - translation
[2023-06-25 22:44:14] [config] valid-mini-batch: 32
[2023-06-25 22:44:14] [config] valid-reset-stalled: false
[2023-06-25 22:44:14] [config] valid-script-args:
[2023-06-25 22:44:14] [config]   []
[2023-06-25 22:44:14] [config] valid-script-path: ""
[2023-06-25 22:44:14] [config] valid-sets:
[2023-06-25 22:44:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 22:44:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 22:44:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 22:44:14] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:44:14] [config] vocabs:
[2023-06-25 22:44:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:44:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:44:14] [config] word-penalty: 0
[2023-06-25 22:44:14] [config] word-scores: false
[2023-06-25 22:44:14] [config] workspace: 3000
[2023-06-25 22:44:14] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:44:14] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:44:14] [training] Using single-device training
[2023-06-25 22:44:15] Synced seed 1234
[2023-06-25 22:44:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:44:15] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 22:44:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:44:15] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 22:44:15] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 22:44:15] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:44:16] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:44:16] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:44:16] [comm] Using global sharding
[2023-06-25 22:44:16] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:44:16] [training] Using 1 GPUs
[2023-06-25 22:44:16] [logits] Applying loss function for 1 factor(s)
[2023-06-25 22:44:16] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:44:16] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 22:44:16] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:44:32] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 22:44:32] [valid] No post-processing script given for validating translator
[2023-06-25 22:44:32] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:44:32] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:44:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:44:32] [comm] Using global sharding
[2023-06-25 22:44:32] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:44:32] [training] Using 1 GPUs
[2023-06-25 22:44:32] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:44:33] Loading Adam parameters
[2023-06-25 22:44:33] [memory] Reserving 290 MB, device gpu0
[2023-06-25 22:44:33] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:44:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:44:33] [data] Restoring the corpus state to epoch 31, batch 2649
[2023-06-25 22:44:33] [data] Shuffling data
[2023-06-25 22:44:33] [data] Done reading 20,192 sentences
[2023-06-25 22:44:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:44:34] Training started
[2023-06-25 22:44:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 22:44:34] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:44:34] Parameter type float32, optimization type float32, casting types false
[2023-06-25 22:45:18] Seen 15,667 samples
[2023-06-25 22:45:18] Starting data epoch 32 in logical epoch 32
[2023-06-25 22:45:18] [data] Shuffling data
[2023-06-25 22:45:18] [data] Done reading 20,192 sentences
[2023-06-25 22:45:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:46:02] Seen 15,667 samples
[2023-06-25 22:46:02] Starting data epoch 33 in logical epoch 33
[2023-06-25 22:46:02] [data] Shuffling data
[2023-06-25 22:46:02] [data] Done reading 20,192 sentences
[2023-06-25 22:46:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:46:46] Seen 15,667 samples
[2023-06-25 22:46:46] Starting data epoch 34 in logical epoch 34
[2023-06-25 22:46:46] [data] Shuffling data
[2023-06-25 22:46:47] [data] Done reading 20,192 sentences
[2023-06-25 22:46:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:47:31] Ep. 34 : Up. 3000 : Sen. 15,601 : Cost 3.36315966 * 4,258,229 @ 2,909 after 12,780,777 : Time 178.45s : 23862.82 words/s : gNorm 1.2530
[2023-06-25 22:47:31] Seen 15,667 samples
[2023-06-25 22:47:31] Starting data epoch 35 in logical epoch 35
[2023-06-25 22:47:31] [data] Shuffling data
[2023-06-25 22:47:31] [data] Done reading 20,192 sentences
[2023-06-25 22:47:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:48:15] Seen 15,667 samples
[2023-06-25 22:48:15] Starting data epoch 36 in logical epoch 36
[2023-06-25 22:48:15] [data] Shuffling data
[2023-06-25 22:48:15] [data] Done reading 20,192 sentences
[2023-06-25 22:48:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:48:59] Seen 15,667 samples
[2023-06-25 22:48:59] Starting data epoch 37 in logical epoch 37
[2023-06-25 22:48:59] [data] Shuffling data
[2023-06-25 22:48:59] [data] Done reading 20,192 sentences
[2023-06-25 22:48:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:49:43] Seen 15,667 samples
[2023-06-25 22:49:43] Starting data epoch 38 in logical epoch 38
[2023-06-25 22:49:43] [data] Shuffling data
[2023-06-25 22:49:43] [data] Done reading 20,192 sentences
[2023-06-25 22:49:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:50:29] Seen 15,667 samples
[2023-06-25 22:50:29] Starting data epoch 39 in logical epoch 39
[2023-06-25 22:50:29] [data] Shuffling data
[2023-06-25 22:50:29] [data] Done reading 20,192 sentences
[2023-06-25 22:50:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:51:14] Seen 15,667 samples
[2023-06-25 22:51:14] Starting data epoch 40 in logical epoch 40
[2023-06-25 22:51:14] [data] Shuffling data
[2023-06-25 22:51:14] [data] Done reading 20,192 sentences
[2023-06-25 22:51:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:51:57] Seen 15,667 samples
[2023-06-25 22:51:57] Starting data epoch 41 in logical epoch 41
[2023-06-25 22:51:57] Training finished
[2023-06-25 22:52:06] [valid] Ep. 41 : Up. 3530 : cross-entropy : 122.015 : new best
[2023-06-25 22:52:48] [valid] Ep. 41 : Up. 3530 : translation : 0 : new best
[2023-06-25 22:52:48] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:52:49] Saving Adam parameters
[2023-06-25 22:52:50] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:56:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:56:05] [marian] Running on node07.datos.cluster.uy as process 9619 with command line:
[2023-06-25 22:56:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 22:56:05] [config] after: 0e
[2023-06-25 22:56:05] [config] after-batches: 0
[2023-06-25 22:56:05] [config] after-epochs: 50
[2023-06-25 22:56:05] [config] all-caps-every: 0
[2023-06-25 22:56:05] [config] allow-unk: false
[2023-06-25 22:56:05] [config] authors: false
[2023-06-25 22:56:05] [config] beam-size: 6
[2023-06-25 22:56:05] [config] bert-class-symbol: "[CLS]"
[2023-06-25 22:56:05] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 22:56:05] [config] bert-masking-fraction: 0.15
[2023-06-25 22:56:05] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 22:56:05] [config] bert-train-type-embeddings: true
[2023-06-25 22:56:05] [config] bert-type-vocab-size: 2
[2023-06-25 22:56:05] [config] build-info: ""
[2023-06-25 22:56:05] [config] check-gradient-nan: false
[2023-06-25 22:56:05] [config] check-nan: false
[2023-06-25 22:56:05] [config] cite: false
[2023-06-25 22:56:05] [config] clip-norm: 1
[2023-06-25 22:56:05] [config] cost-scaling:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] cost-type: ce-sum
[2023-06-25 22:56:05] [config] cpu-threads: 0
[2023-06-25 22:56:05] [config] data-threads: 8
[2023-06-25 22:56:05] [config] data-weighting: ""
[2023-06-25 22:56:05] [config] data-weighting-type: sentence
[2023-06-25 22:56:05] [config] dec-cell: gru
[2023-06-25 22:56:05] [config] dec-cell-base-depth: 2
[2023-06-25 22:56:05] [config] dec-cell-high-depth: 1
[2023-06-25 22:56:05] [config] dec-depth: 1
[2023-06-25 22:56:05] [config] devices:
[2023-06-25 22:56:05] [config]   - 0
[2023-06-25 22:56:05] [config] dim-emb: 512
[2023-06-25 22:56:05] [config] dim-rnn: 1024
[2023-06-25 22:56:05] [config] dim-vocabs:
[2023-06-25 22:56:05] [config]   - 8192
[2023-06-25 22:56:05] [config]   - 8192
[2023-06-25 22:56:05] [config] disp-first: 0
[2023-06-25 22:56:05] [config] disp-freq: 1000u
[2023-06-25 22:56:05] [config] disp-label-counts: true
[2023-06-25 22:56:05] [config] dropout-rnn: 0.2
[2023-06-25 22:56:05] [config] dropout-src: 0.1
[2023-06-25 22:56:05] [config] dropout-trg: 0.1
[2023-06-25 22:56:05] [config] dump-config: ""
[2023-06-25 22:56:05] [config] dynamic-gradient-scaling:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] early-stopping: 10
[2023-06-25 22:56:05] [config] early-stopping-on: first
[2023-06-25 22:56:05] [config] embedding-fix-src: false
[2023-06-25 22:56:05] [config] embedding-fix-trg: false
[2023-06-25 22:56:05] [config] embedding-normalization: false
[2023-06-25 22:56:05] [config] embedding-vectors:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] enc-cell: gru
[2023-06-25 22:56:05] [config] enc-cell-depth: 1
[2023-06-25 22:56:05] [config] enc-depth: 1
[2023-06-25 22:56:05] [config] enc-type: bidirectional
[2023-06-25 22:56:05] [config] english-title-case-every: 0
[2023-06-25 22:56:05] [config] exponential-smoothing: 0
[2023-06-25 22:56:05] [config] factor-weight: 1
[2023-06-25 22:56:05] [config] factors-combine: sum
[2023-06-25 22:56:05] [config] factors-dim-emb: 0
[2023-06-25 22:56:05] [config] gradient-checkpointing: false
[2023-06-25 22:56:05] [config] gradient-norm-average-window: 100
[2023-06-25 22:56:05] [config] guided-alignment: none
[2023-06-25 22:56:05] [config] guided-alignment-cost: mse
[2023-06-25 22:56:05] [config] guided-alignment-weight: 0.1
[2023-06-25 22:56:05] [config] ignore-model-config: false
[2023-06-25 22:56:05] [config] input-types:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] interpolate-env-vars: false
[2023-06-25 22:56:05] [config] keep-best: false
[2023-06-25 22:56:05] [config] label-smoothing: 0
[2023-06-25 22:56:05] [config] layer-normalization: true
[2023-06-25 22:56:05] [config] learn-rate: 0.0001
[2023-06-25 22:56:05] [config] lemma-dependency: ""
[2023-06-25 22:56:05] [config] lemma-dim-emb: 0
[2023-06-25 22:56:05] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 22:56:05] [config] log-level: info
[2023-06-25 22:56:05] [config] log-time-zone: ""
[2023-06-25 22:56:05] [config] logical-epoch:
[2023-06-25 22:56:05] [config]   - 1e
[2023-06-25 22:56:05] [config]   - 0
[2023-06-25 22:56:05] [config] lr-decay: 0
[2023-06-25 22:56:05] [config] lr-decay-freq: 50000
[2023-06-25 22:56:05] [config] lr-decay-inv-sqrt:
[2023-06-25 22:56:05] [config]   - 0
[2023-06-25 22:56:05] [config] lr-decay-repeat-warmup: false
[2023-06-25 22:56:05] [config] lr-decay-reset-optimizer: false
[2023-06-25 22:56:05] [config] lr-decay-start:
[2023-06-25 22:56:05] [config]   - 10
[2023-06-25 22:56:05] [config]   - 1
[2023-06-25 22:56:05] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 22:56:05] [config] lr-report: false
[2023-06-25 22:56:05] [config] lr-warmup: 0
[2023-06-25 22:56:05] [config] lr-warmup-at-reload: false
[2023-06-25 22:56:05] [config] lr-warmup-cycle: false
[2023-06-25 22:56:05] [config] lr-warmup-start-rate: 0
[2023-06-25 22:56:05] [config] max-length: 50
[2023-06-25 22:56:05] [config] max-length-crop: false
[2023-06-25 22:56:05] [config] max-length-factor: 3
[2023-06-25 22:56:05] [config] maxi-batch: 100
[2023-06-25 22:56:05] [config] maxi-batch-sort: trg
[2023-06-25 22:56:05] [config] mini-batch: 64
[2023-06-25 22:56:05] [config] mini-batch-fit: true
[2023-06-25 22:56:05] [config] mini-batch-fit-step: 10
[2023-06-25 22:56:05] [config] mini-batch-round-up: true
[2023-06-25 22:56:05] [config] mini-batch-track-lr: false
[2023-06-25 22:56:05] [config] mini-batch-warmup: 0
[2023-06-25 22:56:05] [config] mini-batch-words: 0
[2023-06-25 22:56:05] [config] mini-batch-words-ref: 0
[2023-06-25 22:56:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:56:05] [config] multi-loss-type: sum
[2023-06-25 22:56:05] [config] n-best: false
[2023-06-25 22:56:05] [config] no-nccl: false
[2023-06-25 22:56:05] [config] no-reload: false
[2023-06-25 22:56:05] [config] no-restore-corpus: false
[2023-06-25 22:56:05] [config] normalize: 0.6
[2023-06-25 22:56:05] [config] normalize-gradient: false
[2023-06-25 22:56:05] [config] num-devices: 0
[2023-06-25 22:56:05] [config] optimizer: adam
[2023-06-25 22:56:05] [config] optimizer-delay: 1
[2023-06-25 22:56:05] [config] optimizer-params:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] output-omit-bias: false
[2023-06-25 22:56:05] [config] overwrite: false
[2023-06-25 22:56:05] [config] precision:
[2023-06-25 22:56:05] [config]   - float32
[2023-06-25 22:56:05] [config]   - float32
[2023-06-25 22:56:05] [config] pretrained-model: ""
[2023-06-25 22:56:05] [config] quantize-biases: false
[2023-06-25 22:56:05] [config] quantize-bits: 0
[2023-06-25 22:56:05] [config] quantize-log-based: false
[2023-06-25 22:56:05] [config] quantize-optimization-steps: 0
[2023-06-25 22:56:05] [config] quiet: false
[2023-06-25 22:56:05] [config] quiet-translation: true
[2023-06-25 22:56:05] [config] relative-paths: false
[2023-06-25 22:56:05] [config] right-left: false
[2023-06-25 22:56:05] [config] save-freq: 10000u
[2023-06-25 22:56:05] [config] seed: 1234
[2023-06-25 22:56:05] [config] sentencepiece-alphas:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] sentencepiece-max-lines: 2000000
[2023-06-25 22:56:05] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 22:56:05] [config] sharding: global
[2023-06-25 22:56:05] [config] shuffle: data
[2023-06-25 22:56:05] [config] shuffle-in-ram: false
[2023-06-25 22:56:05] [config] sigterm: save-and-exit
[2023-06-25 22:56:05] [config] skip: false
[2023-06-25 22:56:05] [config] sqlite: ""
[2023-06-25 22:56:05] [config] sqlite-drop: false
[2023-06-25 22:56:05] [config] sync-freq: 200u
[2023-06-25 22:56:05] [config] sync-sgd: false
[2023-06-25 22:56:05] [config] tempdir: /tmp
[2023-06-25 22:56:05] [config] tied-embeddings: false
[2023-06-25 22:56:05] [config] tied-embeddings-all: true
[2023-06-25 22:56:05] [config] tied-embeddings-src: false
[2023-06-25 22:56:05] [config] train-embedder-rank:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] train-sets:
[2023-06-25 22:56:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 22:56:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 22:56:05] [config] transformer-aan-activation: swish
[2023-06-25 22:56:05] [config] transformer-aan-depth: 2
[2023-06-25 22:56:05] [config] transformer-aan-nogate: false
[2023-06-25 22:56:05] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 22:56:05] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 22:56:05] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 22:56:05] [config] transformer-depth-scaling: false
[2023-06-25 22:56:05] [config] transformer-dim-aan: 2048
[2023-06-25 22:56:05] [config] transformer-dim-ffn: 2048
[2023-06-25 22:56:05] [config] transformer-dropout: 0
[2023-06-25 22:56:05] [config] transformer-dropout-attention: 0
[2023-06-25 22:56:05] [config] transformer-dropout-ffn: 0
[2023-06-25 22:56:05] [config] transformer-ffn-activation: swish
[2023-06-25 22:56:05] [config] transformer-ffn-depth: 2
[2023-06-25 22:56:05] [config] transformer-guided-alignment-layer: last
[2023-06-25 22:56:05] [config] transformer-heads: 8
[2023-06-25 22:56:05] [config] transformer-no-projection: false
[2023-06-25 22:56:05] [config] transformer-pool: false
[2023-06-25 22:56:05] [config] transformer-postprocess: dan
[2023-06-25 22:56:05] [config] transformer-postprocess-emb: d
[2023-06-25 22:56:05] [config] transformer-postprocess-top: ""
[2023-06-25 22:56:05] [config] transformer-preprocess: ""
[2023-06-25 22:56:05] [config] transformer-tied-layers:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] transformer-train-position-embeddings: false
[2023-06-25 22:56:05] [config] tsv: false
[2023-06-25 22:56:05] [config] tsv-fields: 0
[2023-06-25 22:56:05] [config] type: amun
[2023-06-25 22:56:05] [config] ulr: false
[2023-06-25 22:56:05] [config] ulr-dim-emb: 0
[2023-06-25 22:56:05] [config] ulr-dropout: 0
[2023-06-25 22:56:05] [config] ulr-keys-vectors: ""
[2023-06-25 22:56:05] [config] ulr-query-vectors: ""
[2023-06-25 22:56:05] [config] ulr-softmax-temperature: 1
[2023-06-25 22:56:05] [config] ulr-trainable-transformation: false
[2023-06-25 22:56:05] [config] unlikelihood-loss: false
[2023-06-25 22:56:05] [config] valid-freq: 5000000
[2023-06-25 22:56:05] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 22:56:05] [config] valid-max-length: 1000
[2023-06-25 22:56:05] [config] valid-metrics:
[2023-06-25 22:56:05] [config]   - cross-entropy
[2023-06-25 22:56:05] [config]   - translation
[2023-06-25 22:56:05] [config] valid-mini-batch: 32
[2023-06-25 22:56:05] [config] valid-reset-stalled: false
[2023-06-25 22:56:05] [config] valid-script-args:
[2023-06-25 22:56:05] [config]   []
[2023-06-25 22:56:05] [config] valid-script-path: ""
[2023-06-25 22:56:05] [config] valid-sets:
[2023-06-25 22:56:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 22:56:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 22:56:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 22:56:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:56:05] [config] vocabs:
[2023-06-25 22:56:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:56:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:56:05] [config] word-penalty: 0
[2023-06-25 22:56:05] [config] word-scores: false
[2023-06-25 22:56:05] [config] workspace: 3000
[2023-06-25 22:56:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 22:56:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:56:05] [training] Using single-device training
[2023-06-25 22:56:05] Synced seed 1234
[2023-06-25 22:56:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 22:56:05] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 22:56:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 22:56:05] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 22:56:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 22:56:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:56:06] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:56:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:56:06] [comm] Using global sharding
[2023-06-25 22:56:06] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:56:06] [training] Using 1 GPUs
[2023-06-25 22:56:06] [logits] Applying loss function for 1 factor(s)
[2023-06-25 22:56:06] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:56:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 22:56:06] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:56:22] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 22:56:22] [valid] No post-processing script given for validating translator
[2023-06-25 22:56:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 22:56:22] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 22:56:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 22:56:22] [comm] Using global sharding
[2023-06-25 22:56:22] [comm] NCCLCommunicators constructed successfully
[2023-06-25 22:56:22] [training] Using 1 GPUs
[2023-06-25 22:56:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 22:56:23] Loading Adam parameters
[2023-06-25 22:56:23] [memory] Reserving 290 MB, device gpu0
[2023-06-25 22:56:23] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:56:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 22:56:23] [data] Restoring the corpus state to epoch 41, batch 3530
[2023-06-25 22:56:23] [data] Shuffling data
[2023-06-25 22:56:23] [data] Done reading 20,192 sentences
[2023-06-25 22:56:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:56:23] Training started
[2023-06-25 22:56:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 22:56:23] [memory] Reserving 145 MB, device gpu0
[2023-06-25 22:56:24] Parameter type float32, optimization type float32, casting types false
[2023-06-25 22:57:07] Seen 15,667 samples
[2023-06-25 22:57:07] Starting data epoch 42 in logical epoch 42
[2023-06-25 22:57:07] [data] Shuffling data
[2023-06-25 22:57:07] [data] Done reading 20,192 sentences
[2023-06-25 22:57:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:57:50] Seen 15,667 samples
[2023-06-25 22:57:50] Starting data epoch 43 in logical epoch 43
[2023-06-25 22:57:50] [data] Shuffling data
[2023-06-25 22:57:50] [data] Done reading 20,192 sentences
[2023-06-25 22:57:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:58:34] Seen 15,667 samples
[2023-06-25 22:58:34] Starting data epoch 44 in logical epoch 44
[2023-06-25 22:58:34] [data] Shuffling data
[2023-06-25 22:58:34] [data] Done reading 20,192 sentences
[2023-06-25 22:58:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 22:59:18] Seen 15,667 samples
[2023-06-25 22:59:18] Starting data epoch 45 in logical epoch 45
[2023-06-25 22:59:18] [data] Shuffling data
[2023-06-25 22:59:18] [data] Done reading 20,192 sentences
[2023-06-25 22:59:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:00:02] Seen 15,667 samples
[2023-06-25 23:00:02] Starting data epoch 46 in logical epoch 46
[2023-06-25 23:00:02] [data] Shuffling data
[2023-06-25 23:00:02] [data] Done reading 20,192 sentences
[2023-06-25 23:00:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:00:16] Ep. 46 : Up. 4000 : Sen. 4,998 : Cost 2.79762030 * 4,254,970 @ 3,349 after 17,035,747 : Time 234.52s : 18143.39 words/s : gNorm 1.2027
[2023-06-25 23:00:49] Seen 15,667 samples
[2023-06-25 23:00:49] Starting data epoch 47 in logical epoch 47
[2023-06-25 23:00:49] [data] Shuffling data
[2023-06-25 23:00:49] [data] Done reading 20,192 sentences
[2023-06-25 23:00:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:01:32] Seen 15,667 samples
[2023-06-25 23:01:32] Starting data epoch 48 in logical epoch 48
[2023-06-25 23:01:32] [data] Shuffling data
[2023-06-25 23:01:32] [data] Done reading 20,192 sentences
[2023-06-25 23:01:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:02:19] Seen 15,667 samples
[2023-06-25 23:02:19] Starting data epoch 49 in logical epoch 49
[2023-06-25 23:02:19] [data] Shuffling data
[2023-06-25 23:02:19] [data] Done reading 20,192 sentences
[2023-06-25 23:02:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:03:03] Seen 15,667 samples
[2023-06-25 23:03:03] Starting data epoch 50 in logical epoch 50
[2023-06-25 23:03:03] [data] Shuffling data
[2023-06-25 23:03:03] [data] Done reading 20,192 sentences
[2023-06-25 23:03:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:03:49] Seen 15,667 samples
[2023-06-25 23:03:49] Starting data epoch 51 in logical epoch 51
[2023-06-25 23:03:49] Training finished
[2023-06-25 23:03:58] [valid] Ep. 51 : Up. 4413 : cross-entropy : 118.465 : new best
[2023-06-25 23:04:39] [valid] Ep. 51 : Up. 4413 : translation : 0 : new best
[2023-06-25 23:04:39] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:04:41] Saving Adam parameters
[2023-06-25 23:04:41] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:08:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:08:00] [marian] Running on node07.datos.cluster.uy as process 10327 with command line:
[2023-06-25 23:08:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 23:08:00] [config] after: 0e
[2023-06-25 23:08:00] [config] after-batches: 0
[2023-06-25 23:08:00] [config] after-epochs: 60
[2023-06-25 23:08:00] [config] all-caps-every: 0
[2023-06-25 23:08:00] [config] allow-unk: false
[2023-06-25 23:08:00] [config] authors: false
[2023-06-25 23:08:00] [config] beam-size: 6
[2023-06-25 23:08:00] [config] bert-class-symbol: "[CLS]"
[2023-06-25 23:08:00] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 23:08:00] [config] bert-masking-fraction: 0.15
[2023-06-25 23:08:00] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 23:08:00] [config] bert-train-type-embeddings: true
[2023-06-25 23:08:00] [config] bert-type-vocab-size: 2
[2023-06-25 23:08:00] [config] build-info: ""
[2023-06-25 23:08:00] [config] check-gradient-nan: false
[2023-06-25 23:08:00] [config] check-nan: false
[2023-06-25 23:08:00] [config] cite: false
[2023-06-25 23:08:00] [config] clip-norm: 1
[2023-06-25 23:08:00] [config] cost-scaling:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] cost-type: ce-sum
[2023-06-25 23:08:00] [config] cpu-threads: 0
[2023-06-25 23:08:00] [config] data-threads: 8
[2023-06-25 23:08:00] [config] data-weighting: ""
[2023-06-25 23:08:00] [config] data-weighting-type: sentence
[2023-06-25 23:08:00] [config] dec-cell: gru
[2023-06-25 23:08:00] [config] dec-cell-base-depth: 2
[2023-06-25 23:08:00] [config] dec-cell-high-depth: 1
[2023-06-25 23:08:00] [config] dec-depth: 1
[2023-06-25 23:08:00] [config] devices:
[2023-06-25 23:08:00] [config]   - 0
[2023-06-25 23:08:00] [config] dim-emb: 512
[2023-06-25 23:08:00] [config] dim-rnn: 1024
[2023-06-25 23:08:00] [config] dim-vocabs:
[2023-06-25 23:08:00] [config]   - 8192
[2023-06-25 23:08:00] [config]   - 8192
[2023-06-25 23:08:00] [config] disp-first: 0
[2023-06-25 23:08:00] [config] disp-freq: 1000u
[2023-06-25 23:08:00] [config] disp-label-counts: true
[2023-06-25 23:08:00] [config] dropout-rnn: 0.2
[2023-06-25 23:08:00] [config] dropout-src: 0.1
[2023-06-25 23:08:00] [config] dropout-trg: 0.1
[2023-06-25 23:08:00] [config] dump-config: ""
[2023-06-25 23:08:00] [config] dynamic-gradient-scaling:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] early-stopping: 10
[2023-06-25 23:08:00] [config] early-stopping-on: first
[2023-06-25 23:08:00] [config] embedding-fix-src: false
[2023-06-25 23:08:00] [config] embedding-fix-trg: false
[2023-06-25 23:08:00] [config] embedding-normalization: false
[2023-06-25 23:08:00] [config] embedding-vectors:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] enc-cell: gru
[2023-06-25 23:08:00] [config] enc-cell-depth: 1
[2023-06-25 23:08:00] [config] enc-depth: 1
[2023-06-25 23:08:00] [config] enc-type: bidirectional
[2023-06-25 23:08:00] [config] english-title-case-every: 0
[2023-06-25 23:08:00] [config] exponential-smoothing: 0
[2023-06-25 23:08:00] [config] factor-weight: 1
[2023-06-25 23:08:00] [config] factors-combine: sum
[2023-06-25 23:08:00] [config] factors-dim-emb: 0
[2023-06-25 23:08:00] [config] gradient-checkpointing: false
[2023-06-25 23:08:00] [config] gradient-norm-average-window: 100
[2023-06-25 23:08:00] [config] guided-alignment: none
[2023-06-25 23:08:00] [config] guided-alignment-cost: mse
[2023-06-25 23:08:00] [config] guided-alignment-weight: 0.1
[2023-06-25 23:08:00] [config] ignore-model-config: false
[2023-06-25 23:08:00] [config] input-types:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] interpolate-env-vars: false
[2023-06-25 23:08:00] [config] keep-best: false
[2023-06-25 23:08:00] [config] label-smoothing: 0
[2023-06-25 23:08:00] [config] layer-normalization: true
[2023-06-25 23:08:00] [config] learn-rate: 0.0001
[2023-06-25 23:08:00] [config] lemma-dependency: ""
[2023-06-25 23:08:00] [config] lemma-dim-emb: 0
[2023-06-25 23:08:00] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 23:08:00] [config] log-level: info
[2023-06-25 23:08:00] [config] log-time-zone: ""
[2023-06-25 23:08:00] [config] logical-epoch:
[2023-06-25 23:08:00] [config]   - 1e
[2023-06-25 23:08:00] [config]   - 0
[2023-06-25 23:08:00] [config] lr-decay: 0
[2023-06-25 23:08:00] [config] lr-decay-freq: 50000
[2023-06-25 23:08:00] [config] lr-decay-inv-sqrt:
[2023-06-25 23:08:00] [config]   - 0
[2023-06-25 23:08:00] [config] lr-decay-repeat-warmup: false
[2023-06-25 23:08:00] [config] lr-decay-reset-optimizer: false
[2023-06-25 23:08:00] [config] lr-decay-start:
[2023-06-25 23:08:00] [config]   - 10
[2023-06-25 23:08:00] [config]   - 1
[2023-06-25 23:08:00] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 23:08:00] [config] lr-report: false
[2023-06-25 23:08:00] [config] lr-warmup: 0
[2023-06-25 23:08:00] [config] lr-warmup-at-reload: false
[2023-06-25 23:08:00] [config] lr-warmup-cycle: false
[2023-06-25 23:08:00] [config] lr-warmup-start-rate: 0
[2023-06-25 23:08:00] [config] max-length: 50
[2023-06-25 23:08:00] [config] max-length-crop: false
[2023-06-25 23:08:00] [config] max-length-factor: 3
[2023-06-25 23:08:00] [config] maxi-batch: 100
[2023-06-25 23:08:00] [config] maxi-batch-sort: trg
[2023-06-25 23:08:00] [config] mini-batch: 64
[2023-06-25 23:08:00] [config] mini-batch-fit: true
[2023-06-25 23:08:00] [config] mini-batch-fit-step: 10
[2023-06-25 23:08:00] [config] mini-batch-round-up: true
[2023-06-25 23:08:00] [config] mini-batch-track-lr: false
[2023-06-25 23:08:00] [config] mini-batch-warmup: 0
[2023-06-25 23:08:00] [config] mini-batch-words: 0
[2023-06-25 23:08:00] [config] mini-batch-words-ref: 0
[2023-06-25 23:08:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:08:00] [config] multi-loss-type: sum
[2023-06-25 23:08:00] [config] n-best: false
[2023-06-25 23:08:00] [config] no-nccl: false
[2023-06-25 23:08:00] [config] no-reload: false
[2023-06-25 23:08:00] [config] no-restore-corpus: false
[2023-06-25 23:08:00] [config] normalize: 0.6
[2023-06-25 23:08:00] [config] normalize-gradient: false
[2023-06-25 23:08:00] [config] num-devices: 0
[2023-06-25 23:08:00] [config] optimizer: adam
[2023-06-25 23:08:00] [config] optimizer-delay: 1
[2023-06-25 23:08:00] [config] optimizer-params:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] output-omit-bias: false
[2023-06-25 23:08:00] [config] overwrite: false
[2023-06-25 23:08:00] [config] precision:
[2023-06-25 23:08:00] [config]   - float32
[2023-06-25 23:08:00] [config]   - float32
[2023-06-25 23:08:00] [config] pretrained-model: ""
[2023-06-25 23:08:00] [config] quantize-biases: false
[2023-06-25 23:08:00] [config] quantize-bits: 0
[2023-06-25 23:08:00] [config] quantize-log-based: false
[2023-06-25 23:08:00] [config] quantize-optimization-steps: 0
[2023-06-25 23:08:00] [config] quiet: false
[2023-06-25 23:08:00] [config] quiet-translation: true
[2023-06-25 23:08:00] [config] relative-paths: false
[2023-06-25 23:08:00] [config] right-left: false
[2023-06-25 23:08:00] [config] save-freq: 10000u
[2023-06-25 23:08:00] [config] seed: 1234
[2023-06-25 23:08:00] [config] sentencepiece-alphas:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] sentencepiece-max-lines: 2000000
[2023-06-25 23:08:00] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 23:08:00] [config] sharding: global
[2023-06-25 23:08:00] [config] shuffle: data
[2023-06-25 23:08:00] [config] shuffle-in-ram: false
[2023-06-25 23:08:00] [config] sigterm: save-and-exit
[2023-06-25 23:08:00] [config] skip: false
[2023-06-25 23:08:00] [config] sqlite: ""
[2023-06-25 23:08:00] [config] sqlite-drop: false
[2023-06-25 23:08:00] [config] sync-freq: 200u
[2023-06-25 23:08:00] [config] sync-sgd: false
[2023-06-25 23:08:00] [config] tempdir: /tmp
[2023-06-25 23:08:00] [config] tied-embeddings: false
[2023-06-25 23:08:00] [config] tied-embeddings-all: true
[2023-06-25 23:08:00] [config] tied-embeddings-src: false
[2023-06-25 23:08:00] [config] train-embedder-rank:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] train-sets:
[2023-06-25 23:08:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 23:08:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 23:08:00] [config] transformer-aan-activation: swish
[2023-06-25 23:08:00] [config] transformer-aan-depth: 2
[2023-06-25 23:08:00] [config] transformer-aan-nogate: false
[2023-06-25 23:08:00] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 23:08:00] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 23:08:00] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 23:08:00] [config] transformer-depth-scaling: false
[2023-06-25 23:08:00] [config] transformer-dim-aan: 2048
[2023-06-25 23:08:00] [config] transformer-dim-ffn: 2048
[2023-06-25 23:08:00] [config] transformer-dropout: 0
[2023-06-25 23:08:00] [config] transformer-dropout-attention: 0
[2023-06-25 23:08:00] [config] transformer-dropout-ffn: 0
[2023-06-25 23:08:00] [config] transformer-ffn-activation: swish
[2023-06-25 23:08:00] [config] transformer-ffn-depth: 2
[2023-06-25 23:08:00] [config] transformer-guided-alignment-layer: last
[2023-06-25 23:08:00] [config] transformer-heads: 8
[2023-06-25 23:08:00] [config] transformer-no-projection: false
[2023-06-25 23:08:00] [config] transformer-pool: false
[2023-06-25 23:08:00] [config] transformer-postprocess: dan
[2023-06-25 23:08:00] [config] transformer-postprocess-emb: d
[2023-06-25 23:08:00] [config] transformer-postprocess-top: ""
[2023-06-25 23:08:00] [config] transformer-preprocess: ""
[2023-06-25 23:08:00] [config] transformer-tied-layers:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] transformer-train-position-embeddings: false
[2023-06-25 23:08:00] [config] tsv: false
[2023-06-25 23:08:00] [config] tsv-fields: 0
[2023-06-25 23:08:00] [config] type: amun
[2023-06-25 23:08:00] [config] ulr: false
[2023-06-25 23:08:00] [config] ulr-dim-emb: 0
[2023-06-25 23:08:00] [config] ulr-dropout: 0
[2023-06-25 23:08:00] [config] ulr-keys-vectors: ""
[2023-06-25 23:08:00] [config] ulr-query-vectors: ""
[2023-06-25 23:08:00] [config] ulr-softmax-temperature: 1
[2023-06-25 23:08:00] [config] ulr-trainable-transformation: false
[2023-06-25 23:08:00] [config] unlikelihood-loss: false
[2023-06-25 23:08:00] [config] valid-freq: 5000000
[2023-06-25 23:08:00] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 23:08:00] [config] valid-max-length: 1000
[2023-06-25 23:08:00] [config] valid-metrics:
[2023-06-25 23:08:00] [config]   - cross-entropy
[2023-06-25 23:08:00] [config]   - translation
[2023-06-25 23:08:00] [config] valid-mini-batch: 32
[2023-06-25 23:08:00] [config] valid-reset-stalled: false
[2023-06-25 23:08:00] [config] valid-script-args:
[2023-06-25 23:08:00] [config]   []
[2023-06-25 23:08:00] [config] valid-script-path: ""
[2023-06-25 23:08:00] [config] valid-sets:
[2023-06-25 23:08:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 23:08:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 23:08:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 23:08:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:08:00] [config] vocabs:
[2023-06-25 23:08:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:08:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:08:00] [config] word-penalty: 0
[2023-06-25 23:08:00] [config] word-scores: false
[2023-06-25 23:08:00] [config] workspace: 3000
[2023-06-25 23:08:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:08:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:08:00] [training] Using single-device training
[2023-06-25 23:08:00] Synced seed 1234
[2023-06-25 23:08:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:08:00] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 23:08:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:08:00] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 23:08:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 23:08:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:08:01] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:08:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:08:01] [comm] Using global sharding
[2023-06-25 23:08:01] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:08:01] [training] Using 1 GPUs
[2023-06-25 23:08:01] [logits] Applying loss function for 1 factor(s)
[2023-06-25 23:08:01] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:08:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 23:08:02] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:08:17] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 23:08:17] [valid] No post-processing script given for validating translator
[2023-06-25 23:08:17] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:08:17] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:08:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:08:17] [comm] Using global sharding
[2023-06-25 23:08:17] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:08:17] [training] Using 1 GPUs
[2023-06-25 23:08:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:08:18] Loading Adam parameters
[2023-06-25 23:08:18] [memory] Reserving 290 MB, device gpu0
[2023-06-25 23:08:18] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:08:18] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:08:18] [data] Restoring the corpus state to epoch 51, batch 4413
[2023-06-25 23:08:18] [data] Shuffling data
[2023-06-25 23:08:18] [data] Done reading 20,192 sentences
[2023-06-25 23:08:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:08:19] Training started
[2023-06-25 23:08:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 23:08:19] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:08:19] Parameter type float32, optimization type float32, casting types false
[2023-06-25 23:08:59] Seen 15,667 samples
[2023-06-25 23:08:59] Starting data epoch 52 in logical epoch 52
[2023-06-25 23:08:59] [data] Shuffling data
[2023-06-25 23:08:59] [data] Done reading 20,192 sentences
[2023-06-25 23:08:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:09:43] Seen 15,667 samples
[2023-06-25 23:09:43] Starting data epoch 53 in logical epoch 53
[2023-06-25 23:09:43] [data] Shuffling data
[2023-06-25 23:09:43] [data] Done reading 20,192 sentences
[2023-06-25 23:09:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:10:28] Seen 15,667 samples
[2023-06-25 23:10:28] Starting data epoch 54 in logical epoch 54
[2023-06-25 23:10:28] [data] Shuffling data
[2023-06-25 23:10:28] [data] Done reading 20,192 sentences
[2023-06-25 23:10:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:11:16] Seen 15,667 samples
[2023-06-25 23:11:16] Starting data epoch 55 in logical epoch 55
[2023-06-25 23:11:16] [data] Shuffling data
[2023-06-25 23:11:16] [data] Done reading 20,192 sentences
[2023-06-25 23:11:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:12:01] Seen 15,667 samples
[2023-06-25 23:12:01] Starting data epoch 56 in logical epoch 56
[2023-06-25 23:12:01] [data] Shuffling data
[2023-06-25 23:12:01] [data] Done reading 20,192 sentences
[2023-06-25 23:12:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:12:44] Seen 15,667 samples
[2023-06-25 23:12:44] Starting data epoch 57 in logical epoch 57
[2023-06-25 23:12:44] [data] Shuffling data
[2023-06-25 23:12:44] [data] Done reading 20,192 sentences
[2023-06-25 23:12:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:13:11] Ep. 57 : Up. 5000 : Sen. 10,340 : Cost 2.34380651 * 4,259,908 @ 2,603 after 21,295,655 : Time 294.22s : 14478.65 words/s : gNorm 1.3316
[2023-06-25 23:13:28] Seen 15,667 samples
[2023-06-25 23:13:28] Starting data epoch 58 in logical epoch 58
[2023-06-25 23:13:28] [data] Shuffling data
[2023-06-25 23:13:28] [data] Done reading 20,192 sentences
[2023-06-25 23:13:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:14:13] Seen 15,667 samples
[2023-06-25 23:14:13] Starting data epoch 59 in logical epoch 59
[2023-06-25 23:14:13] [data] Shuffling data
[2023-06-25 23:14:13] [data] Done reading 20,192 sentences
[2023-06-25 23:14:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:14:59] Seen 15,667 samples
[2023-06-25 23:14:59] Starting data epoch 60 in logical epoch 60
[2023-06-25 23:14:59] [data] Shuffling data
[2023-06-25 23:14:59] [data] Done reading 20,192 sentences
[2023-06-25 23:14:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:15:44] Seen 15,667 samples
[2023-06-25 23:15:44] Starting data epoch 61 in logical epoch 61
[2023-06-25 23:15:44] Training finished
[2023-06-25 23:15:54] [valid] Ep. 61 : Up. 5297 : cross-entropy : 118.084 : new best
[2023-06-25 23:16:30] [valid] Ep. 61 : Up. 5297 : translation : 0 : new best
[2023-06-25 23:16:30] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:16:31] Saving Adam parameters
[2023-06-25 23:16:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:19:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:19:38] [marian] Running on node07.datos.cluster.uy as process 11344 with command line:
[2023-06-25 23:19:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 23:19:38] [config] after: 0e
[2023-06-25 23:19:38] [config] after-batches: 0
[2023-06-25 23:19:38] [config] after-epochs: 70
[2023-06-25 23:19:38] [config] all-caps-every: 0
[2023-06-25 23:19:38] [config] allow-unk: false
[2023-06-25 23:19:38] [config] authors: false
[2023-06-25 23:19:38] [config] beam-size: 6
[2023-06-25 23:19:38] [config] bert-class-symbol: "[CLS]"
[2023-06-25 23:19:38] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 23:19:38] [config] bert-masking-fraction: 0.15
[2023-06-25 23:19:38] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 23:19:38] [config] bert-train-type-embeddings: true
[2023-06-25 23:19:38] [config] bert-type-vocab-size: 2
[2023-06-25 23:19:38] [config] build-info: ""
[2023-06-25 23:19:38] [config] check-gradient-nan: false
[2023-06-25 23:19:38] [config] check-nan: false
[2023-06-25 23:19:38] [config] cite: false
[2023-06-25 23:19:38] [config] clip-norm: 1
[2023-06-25 23:19:38] [config] cost-scaling:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] cost-type: ce-sum
[2023-06-25 23:19:38] [config] cpu-threads: 0
[2023-06-25 23:19:38] [config] data-threads: 8
[2023-06-25 23:19:38] [config] data-weighting: ""
[2023-06-25 23:19:38] [config] data-weighting-type: sentence
[2023-06-25 23:19:38] [config] dec-cell: gru
[2023-06-25 23:19:38] [config] dec-cell-base-depth: 2
[2023-06-25 23:19:38] [config] dec-cell-high-depth: 1
[2023-06-25 23:19:38] [config] dec-depth: 1
[2023-06-25 23:19:38] [config] devices:
[2023-06-25 23:19:38] [config]   - 0
[2023-06-25 23:19:38] [config] dim-emb: 512
[2023-06-25 23:19:38] [config] dim-rnn: 1024
[2023-06-25 23:19:38] [config] dim-vocabs:
[2023-06-25 23:19:38] [config]   - 8192
[2023-06-25 23:19:38] [config]   - 8192
[2023-06-25 23:19:38] [config] disp-first: 0
[2023-06-25 23:19:38] [config] disp-freq: 1000u
[2023-06-25 23:19:38] [config] disp-label-counts: true
[2023-06-25 23:19:38] [config] dropout-rnn: 0.2
[2023-06-25 23:19:38] [config] dropout-src: 0.1
[2023-06-25 23:19:38] [config] dropout-trg: 0.1
[2023-06-25 23:19:38] [config] dump-config: ""
[2023-06-25 23:19:38] [config] dynamic-gradient-scaling:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] early-stopping: 10
[2023-06-25 23:19:38] [config] early-stopping-on: first
[2023-06-25 23:19:38] [config] embedding-fix-src: false
[2023-06-25 23:19:38] [config] embedding-fix-trg: false
[2023-06-25 23:19:38] [config] embedding-normalization: false
[2023-06-25 23:19:38] [config] embedding-vectors:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] enc-cell: gru
[2023-06-25 23:19:38] [config] enc-cell-depth: 1
[2023-06-25 23:19:38] [config] enc-depth: 1
[2023-06-25 23:19:38] [config] enc-type: bidirectional
[2023-06-25 23:19:38] [config] english-title-case-every: 0
[2023-06-25 23:19:38] [config] exponential-smoothing: 0
[2023-06-25 23:19:38] [config] factor-weight: 1
[2023-06-25 23:19:38] [config] factors-combine: sum
[2023-06-25 23:19:38] [config] factors-dim-emb: 0
[2023-06-25 23:19:38] [config] gradient-checkpointing: false
[2023-06-25 23:19:38] [config] gradient-norm-average-window: 100
[2023-06-25 23:19:38] [config] guided-alignment: none
[2023-06-25 23:19:38] [config] guided-alignment-cost: mse
[2023-06-25 23:19:38] [config] guided-alignment-weight: 0.1
[2023-06-25 23:19:38] [config] ignore-model-config: false
[2023-06-25 23:19:38] [config] input-types:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] interpolate-env-vars: false
[2023-06-25 23:19:38] [config] keep-best: false
[2023-06-25 23:19:38] [config] label-smoothing: 0
[2023-06-25 23:19:38] [config] layer-normalization: true
[2023-06-25 23:19:38] [config] learn-rate: 0.0001
[2023-06-25 23:19:38] [config] lemma-dependency: ""
[2023-06-25 23:19:38] [config] lemma-dim-emb: 0
[2023-06-25 23:19:38] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 23:19:38] [config] log-level: info
[2023-06-25 23:19:38] [config] log-time-zone: ""
[2023-06-25 23:19:38] [config] logical-epoch:
[2023-06-25 23:19:38] [config]   - 1e
[2023-06-25 23:19:38] [config]   - 0
[2023-06-25 23:19:38] [config] lr-decay: 0
[2023-06-25 23:19:38] [config] lr-decay-freq: 50000
[2023-06-25 23:19:38] [config] lr-decay-inv-sqrt:
[2023-06-25 23:19:38] [config]   - 0
[2023-06-25 23:19:38] [config] lr-decay-repeat-warmup: false
[2023-06-25 23:19:38] [config] lr-decay-reset-optimizer: false
[2023-06-25 23:19:38] [config] lr-decay-start:
[2023-06-25 23:19:38] [config]   - 10
[2023-06-25 23:19:38] [config]   - 1
[2023-06-25 23:19:38] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 23:19:38] [config] lr-report: false
[2023-06-25 23:19:38] [config] lr-warmup: 0
[2023-06-25 23:19:38] [config] lr-warmup-at-reload: false
[2023-06-25 23:19:38] [config] lr-warmup-cycle: false
[2023-06-25 23:19:38] [config] lr-warmup-start-rate: 0
[2023-06-25 23:19:38] [config] max-length: 50
[2023-06-25 23:19:38] [config] max-length-crop: false
[2023-06-25 23:19:38] [config] max-length-factor: 3
[2023-06-25 23:19:38] [config] maxi-batch: 100
[2023-06-25 23:19:38] [config] maxi-batch-sort: trg
[2023-06-25 23:19:38] [config] mini-batch: 64
[2023-06-25 23:19:38] [config] mini-batch-fit: true
[2023-06-25 23:19:38] [config] mini-batch-fit-step: 10
[2023-06-25 23:19:38] [config] mini-batch-round-up: true
[2023-06-25 23:19:38] [config] mini-batch-track-lr: false
[2023-06-25 23:19:38] [config] mini-batch-warmup: 0
[2023-06-25 23:19:38] [config] mini-batch-words: 0
[2023-06-25 23:19:38] [config] mini-batch-words-ref: 0
[2023-06-25 23:19:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:19:38] [config] multi-loss-type: sum
[2023-06-25 23:19:38] [config] n-best: false
[2023-06-25 23:19:38] [config] no-nccl: false
[2023-06-25 23:19:38] [config] no-reload: false
[2023-06-25 23:19:38] [config] no-restore-corpus: false
[2023-06-25 23:19:38] [config] normalize: 0.6
[2023-06-25 23:19:38] [config] normalize-gradient: false
[2023-06-25 23:19:38] [config] num-devices: 0
[2023-06-25 23:19:38] [config] optimizer: adam
[2023-06-25 23:19:38] [config] optimizer-delay: 1
[2023-06-25 23:19:38] [config] optimizer-params:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] output-omit-bias: false
[2023-06-25 23:19:38] [config] overwrite: false
[2023-06-25 23:19:38] [config] precision:
[2023-06-25 23:19:38] [config]   - float32
[2023-06-25 23:19:38] [config]   - float32
[2023-06-25 23:19:38] [config] pretrained-model: ""
[2023-06-25 23:19:38] [config] quantize-biases: false
[2023-06-25 23:19:38] [config] quantize-bits: 0
[2023-06-25 23:19:38] [config] quantize-log-based: false
[2023-06-25 23:19:38] [config] quantize-optimization-steps: 0
[2023-06-25 23:19:38] [config] quiet: false
[2023-06-25 23:19:38] [config] quiet-translation: true
[2023-06-25 23:19:38] [config] relative-paths: false
[2023-06-25 23:19:38] [config] right-left: false
[2023-06-25 23:19:38] [config] save-freq: 10000u
[2023-06-25 23:19:38] [config] seed: 1234
[2023-06-25 23:19:38] [config] sentencepiece-alphas:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] sentencepiece-max-lines: 2000000
[2023-06-25 23:19:38] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 23:19:38] [config] sharding: global
[2023-06-25 23:19:38] [config] shuffle: data
[2023-06-25 23:19:38] [config] shuffle-in-ram: false
[2023-06-25 23:19:38] [config] sigterm: save-and-exit
[2023-06-25 23:19:38] [config] skip: false
[2023-06-25 23:19:38] [config] sqlite: ""
[2023-06-25 23:19:38] [config] sqlite-drop: false
[2023-06-25 23:19:38] [config] sync-freq: 200u
[2023-06-25 23:19:38] [config] sync-sgd: false
[2023-06-25 23:19:38] [config] tempdir: /tmp
[2023-06-25 23:19:38] [config] tied-embeddings: false
[2023-06-25 23:19:38] [config] tied-embeddings-all: true
[2023-06-25 23:19:38] [config] tied-embeddings-src: false
[2023-06-25 23:19:38] [config] train-embedder-rank:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] train-sets:
[2023-06-25 23:19:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 23:19:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 23:19:38] [config] transformer-aan-activation: swish
[2023-06-25 23:19:38] [config] transformer-aan-depth: 2
[2023-06-25 23:19:38] [config] transformer-aan-nogate: false
[2023-06-25 23:19:38] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 23:19:38] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 23:19:38] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 23:19:38] [config] transformer-depth-scaling: false
[2023-06-25 23:19:38] [config] transformer-dim-aan: 2048
[2023-06-25 23:19:38] [config] transformer-dim-ffn: 2048
[2023-06-25 23:19:38] [config] transformer-dropout: 0
[2023-06-25 23:19:38] [config] transformer-dropout-attention: 0
[2023-06-25 23:19:38] [config] transformer-dropout-ffn: 0
[2023-06-25 23:19:38] [config] transformer-ffn-activation: swish
[2023-06-25 23:19:38] [config] transformer-ffn-depth: 2
[2023-06-25 23:19:38] [config] transformer-guided-alignment-layer: last
[2023-06-25 23:19:38] [config] transformer-heads: 8
[2023-06-25 23:19:38] [config] transformer-no-projection: false
[2023-06-25 23:19:38] [config] transformer-pool: false
[2023-06-25 23:19:38] [config] transformer-postprocess: dan
[2023-06-25 23:19:38] [config] transformer-postprocess-emb: d
[2023-06-25 23:19:38] [config] transformer-postprocess-top: ""
[2023-06-25 23:19:38] [config] transformer-preprocess: ""
[2023-06-25 23:19:38] [config] transformer-tied-layers:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] transformer-train-position-embeddings: false
[2023-06-25 23:19:38] [config] tsv: false
[2023-06-25 23:19:38] [config] tsv-fields: 0
[2023-06-25 23:19:38] [config] type: amun
[2023-06-25 23:19:38] [config] ulr: false
[2023-06-25 23:19:38] [config] ulr-dim-emb: 0
[2023-06-25 23:19:38] [config] ulr-dropout: 0
[2023-06-25 23:19:38] [config] ulr-keys-vectors: ""
[2023-06-25 23:19:38] [config] ulr-query-vectors: ""
[2023-06-25 23:19:38] [config] ulr-softmax-temperature: 1
[2023-06-25 23:19:38] [config] ulr-trainable-transformation: false
[2023-06-25 23:19:38] [config] unlikelihood-loss: false
[2023-06-25 23:19:38] [config] valid-freq: 5000000
[2023-06-25 23:19:38] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 23:19:38] [config] valid-max-length: 1000
[2023-06-25 23:19:38] [config] valid-metrics:
[2023-06-25 23:19:38] [config]   - cross-entropy
[2023-06-25 23:19:38] [config]   - translation
[2023-06-25 23:19:38] [config] valid-mini-batch: 32
[2023-06-25 23:19:38] [config] valid-reset-stalled: false
[2023-06-25 23:19:38] [config] valid-script-args:
[2023-06-25 23:19:38] [config]   []
[2023-06-25 23:19:38] [config] valid-script-path: ""
[2023-06-25 23:19:38] [config] valid-sets:
[2023-06-25 23:19:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 23:19:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 23:19:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 23:19:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:19:38] [config] vocabs:
[2023-06-25 23:19:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:19:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:19:38] [config] word-penalty: 0
[2023-06-25 23:19:38] [config] word-scores: false
[2023-06-25 23:19:38] [config] workspace: 3000
[2023-06-25 23:19:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:19:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:19:38] [training] Using single-device training
[2023-06-25 23:19:39] Synced seed 1234
[2023-06-25 23:19:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:19:39] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 23:19:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:19:39] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 23:19:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 23:19:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:19:39] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:19:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:19:39] [comm] Using global sharding
[2023-06-25 23:19:39] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:19:39] [training] Using 1 GPUs
[2023-06-25 23:19:39] [logits] Applying loss function for 1 factor(s)
[2023-06-25 23:19:39] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:19:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 23:19:40] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:19:55] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 23:19:55] [valid] No post-processing script given for validating translator
[2023-06-25 23:19:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:19:55] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:19:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:19:55] [comm] Using global sharding
[2023-06-25 23:19:55] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:19:55] [training] Using 1 GPUs
[2023-06-25 23:19:55] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:19:56] Loading Adam parameters
[2023-06-25 23:19:56] [memory] Reserving 290 MB, device gpu0
[2023-06-25 23:19:56] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:19:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:19:57] [data] Restoring the corpus state to epoch 61, batch 5297
[2023-06-25 23:19:57] [data] Shuffling data
[2023-06-25 23:19:57] [data] Done reading 20,192 sentences
[2023-06-25 23:19:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:19:57] Training started
[2023-06-25 23:19:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 23:19:57] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:19:57] Parameter type float32, optimization type float32, casting types false
[2023-06-25 23:20:38] Seen 15,667 samples
[2023-06-25 23:20:38] Starting data epoch 62 in logical epoch 62
[2023-06-25 23:20:38] [data] Shuffling data
[2023-06-25 23:20:38] [data] Done reading 20,192 sentences
[2023-06-25 23:20:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:21:24] Seen 15,667 samples
[2023-06-25 23:21:24] Starting data epoch 63 in logical epoch 63
[2023-06-25 23:21:24] [data] Shuffling data
[2023-06-25 23:21:24] [data] Done reading 20,192 sentences
[2023-06-25 23:21:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:22:09] Seen 15,667 samples
[2023-06-25 23:22:09] Starting data epoch 64 in logical epoch 64
[2023-06-25 23:22:09] [data] Shuffling data
[2023-06-25 23:22:09] [data] Done reading 20,192 sentences
[2023-06-25 23:22:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:22:53] Seen 15,667 samples
[2023-06-25 23:22:53] Starting data epoch 65 in logical epoch 65
[2023-06-25 23:22:53] [data] Shuffling data
[2023-06-25 23:22:53] [data] Done reading 20,192 sentences
[2023-06-25 23:22:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:23:38] Seen 15,667 samples
[2023-06-25 23:23:38] Starting data epoch 66 in logical epoch 66
[2023-06-25 23:23:38] [data] Shuffling data
[2023-06-25 23:23:38] [data] Done reading 20,192 sentences
[2023-06-25 23:23:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:24:22] Seen 15,667 samples
[2023-06-25 23:24:22] Starting data epoch 67 in logical epoch 67
[2023-06-25 23:24:22] [data] Shuffling data
[2023-06-25 23:24:22] [data] Done reading 20,192 sentences
[2023-06-25 23:24:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:25:07] Seen 15,667 samples
[2023-06-25 23:25:07] Starting data epoch 68 in logical epoch 68
[2023-06-25 23:25:07] [data] Shuffling data
[2023-06-25 23:25:07] [data] Done reading 20,192 sentences
[2023-06-25 23:25:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:25:51] Ep. 68 : Up. 6000 : Sen. 15,419 : Cost 1.99704397 * 4,263,452 @ 6,491 after 25,559,107 : Time 355.50s : 11992.87 words/s : gNorm 1.2455
[2023-06-25 23:25:51] Seen 15,667 samples
[2023-06-25 23:25:51] Starting data epoch 69 in logical epoch 69
[2023-06-25 23:25:51] [data] Shuffling data
[2023-06-25 23:25:51] [data] Done reading 20,192 sentences
[2023-06-25 23:25:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:26:36] Seen 15,667 samples
[2023-06-25 23:26:36] Starting data epoch 70 in logical epoch 70
[2023-06-25 23:26:36] [data] Shuffling data
[2023-06-25 23:26:36] [data] Done reading 20,192 sentences
[2023-06-25 23:26:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:27:21] Seen 15,667 samples
[2023-06-25 23:27:21] Starting data epoch 71 in logical epoch 71
[2023-06-25 23:27:21] Training finished
[2023-06-25 23:27:30] [valid] Ep. 71 : Up. 6178 : cross-entropy : 117.719 : new best
[2023-06-25 23:28:08] [valid] Ep. 71 : Up. 6178 : translation : 0 : new best
[2023-06-25 23:28:08] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:28:10] Saving Adam parameters
[2023-06-25 23:28:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:31:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:31:20] [marian] Running on node07.datos.cluster.uy as process 12022 with command line:
[2023-06-25 23:31:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 23:31:20] [config] after: 0e
[2023-06-25 23:31:20] [config] after-batches: 0
[2023-06-25 23:31:20] [config] after-epochs: 80
[2023-06-25 23:31:20] [config] all-caps-every: 0
[2023-06-25 23:31:20] [config] allow-unk: false
[2023-06-25 23:31:20] [config] authors: false
[2023-06-25 23:31:20] [config] beam-size: 6
[2023-06-25 23:31:20] [config] bert-class-symbol: "[CLS]"
[2023-06-25 23:31:20] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 23:31:20] [config] bert-masking-fraction: 0.15
[2023-06-25 23:31:20] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 23:31:20] [config] bert-train-type-embeddings: true
[2023-06-25 23:31:20] [config] bert-type-vocab-size: 2
[2023-06-25 23:31:20] [config] build-info: ""
[2023-06-25 23:31:20] [config] check-gradient-nan: false
[2023-06-25 23:31:20] [config] check-nan: false
[2023-06-25 23:31:20] [config] cite: false
[2023-06-25 23:31:20] [config] clip-norm: 1
[2023-06-25 23:31:20] [config] cost-scaling:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] cost-type: ce-sum
[2023-06-25 23:31:20] [config] cpu-threads: 0
[2023-06-25 23:31:20] [config] data-threads: 8
[2023-06-25 23:31:20] [config] data-weighting: ""
[2023-06-25 23:31:20] [config] data-weighting-type: sentence
[2023-06-25 23:31:20] [config] dec-cell: gru
[2023-06-25 23:31:20] [config] dec-cell-base-depth: 2
[2023-06-25 23:31:20] [config] dec-cell-high-depth: 1
[2023-06-25 23:31:20] [config] dec-depth: 1
[2023-06-25 23:31:20] [config] devices:
[2023-06-25 23:31:20] [config]   - 0
[2023-06-25 23:31:20] [config] dim-emb: 512
[2023-06-25 23:31:20] [config] dim-rnn: 1024
[2023-06-25 23:31:20] [config] dim-vocabs:
[2023-06-25 23:31:20] [config]   - 8192
[2023-06-25 23:31:20] [config]   - 8192
[2023-06-25 23:31:20] [config] disp-first: 0
[2023-06-25 23:31:20] [config] disp-freq: 1000u
[2023-06-25 23:31:20] [config] disp-label-counts: true
[2023-06-25 23:31:20] [config] dropout-rnn: 0.2
[2023-06-25 23:31:20] [config] dropout-src: 0.1
[2023-06-25 23:31:20] [config] dropout-trg: 0.1
[2023-06-25 23:31:20] [config] dump-config: ""
[2023-06-25 23:31:20] [config] dynamic-gradient-scaling:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] early-stopping: 10
[2023-06-25 23:31:20] [config] early-stopping-on: first
[2023-06-25 23:31:20] [config] embedding-fix-src: false
[2023-06-25 23:31:20] [config] embedding-fix-trg: false
[2023-06-25 23:31:20] [config] embedding-normalization: false
[2023-06-25 23:31:20] [config] embedding-vectors:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] enc-cell: gru
[2023-06-25 23:31:20] [config] enc-cell-depth: 1
[2023-06-25 23:31:20] [config] enc-depth: 1
[2023-06-25 23:31:20] [config] enc-type: bidirectional
[2023-06-25 23:31:20] [config] english-title-case-every: 0
[2023-06-25 23:31:20] [config] exponential-smoothing: 0
[2023-06-25 23:31:20] [config] factor-weight: 1
[2023-06-25 23:31:20] [config] factors-combine: sum
[2023-06-25 23:31:20] [config] factors-dim-emb: 0
[2023-06-25 23:31:20] [config] gradient-checkpointing: false
[2023-06-25 23:31:20] [config] gradient-norm-average-window: 100
[2023-06-25 23:31:20] [config] guided-alignment: none
[2023-06-25 23:31:20] [config] guided-alignment-cost: mse
[2023-06-25 23:31:20] [config] guided-alignment-weight: 0.1
[2023-06-25 23:31:20] [config] ignore-model-config: false
[2023-06-25 23:31:20] [config] input-types:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] interpolate-env-vars: false
[2023-06-25 23:31:20] [config] keep-best: false
[2023-06-25 23:31:20] [config] label-smoothing: 0
[2023-06-25 23:31:20] [config] layer-normalization: true
[2023-06-25 23:31:20] [config] learn-rate: 0.0001
[2023-06-25 23:31:20] [config] lemma-dependency: ""
[2023-06-25 23:31:20] [config] lemma-dim-emb: 0
[2023-06-25 23:31:20] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 23:31:20] [config] log-level: info
[2023-06-25 23:31:20] [config] log-time-zone: ""
[2023-06-25 23:31:20] [config] logical-epoch:
[2023-06-25 23:31:20] [config]   - 1e
[2023-06-25 23:31:20] [config]   - 0
[2023-06-25 23:31:20] [config] lr-decay: 0
[2023-06-25 23:31:20] [config] lr-decay-freq: 50000
[2023-06-25 23:31:20] [config] lr-decay-inv-sqrt:
[2023-06-25 23:31:20] [config]   - 0
[2023-06-25 23:31:20] [config] lr-decay-repeat-warmup: false
[2023-06-25 23:31:20] [config] lr-decay-reset-optimizer: false
[2023-06-25 23:31:20] [config] lr-decay-start:
[2023-06-25 23:31:20] [config]   - 10
[2023-06-25 23:31:20] [config]   - 1
[2023-06-25 23:31:20] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 23:31:20] [config] lr-report: false
[2023-06-25 23:31:20] [config] lr-warmup: 0
[2023-06-25 23:31:20] [config] lr-warmup-at-reload: false
[2023-06-25 23:31:20] [config] lr-warmup-cycle: false
[2023-06-25 23:31:20] [config] lr-warmup-start-rate: 0
[2023-06-25 23:31:20] [config] max-length: 50
[2023-06-25 23:31:20] [config] max-length-crop: false
[2023-06-25 23:31:20] [config] max-length-factor: 3
[2023-06-25 23:31:20] [config] maxi-batch: 100
[2023-06-25 23:31:20] [config] maxi-batch-sort: trg
[2023-06-25 23:31:20] [config] mini-batch: 64
[2023-06-25 23:31:20] [config] mini-batch-fit: true
[2023-06-25 23:31:20] [config] mini-batch-fit-step: 10
[2023-06-25 23:31:20] [config] mini-batch-round-up: true
[2023-06-25 23:31:20] [config] mini-batch-track-lr: false
[2023-06-25 23:31:20] [config] mini-batch-warmup: 0
[2023-06-25 23:31:20] [config] mini-batch-words: 0
[2023-06-25 23:31:20] [config] mini-batch-words-ref: 0
[2023-06-25 23:31:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:31:20] [config] multi-loss-type: sum
[2023-06-25 23:31:20] [config] n-best: false
[2023-06-25 23:31:20] [config] no-nccl: false
[2023-06-25 23:31:20] [config] no-reload: false
[2023-06-25 23:31:20] [config] no-restore-corpus: false
[2023-06-25 23:31:20] [config] normalize: 0.6
[2023-06-25 23:31:20] [config] normalize-gradient: false
[2023-06-25 23:31:20] [config] num-devices: 0
[2023-06-25 23:31:20] [config] optimizer: adam
[2023-06-25 23:31:20] [config] optimizer-delay: 1
[2023-06-25 23:31:20] [config] optimizer-params:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] output-omit-bias: false
[2023-06-25 23:31:20] [config] overwrite: false
[2023-06-25 23:31:20] [config] precision:
[2023-06-25 23:31:20] [config]   - float32
[2023-06-25 23:31:20] [config]   - float32
[2023-06-25 23:31:20] [config] pretrained-model: ""
[2023-06-25 23:31:20] [config] quantize-biases: false
[2023-06-25 23:31:20] [config] quantize-bits: 0
[2023-06-25 23:31:20] [config] quantize-log-based: false
[2023-06-25 23:31:20] [config] quantize-optimization-steps: 0
[2023-06-25 23:31:20] [config] quiet: false
[2023-06-25 23:31:20] [config] quiet-translation: true
[2023-06-25 23:31:20] [config] relative-paths: false
[2023-06-25 23:31:20] [config] right-left: false
[2023-06-25 23:31:20] [config] save-freq: 10000u
[2023-06-25 23:31:20] [config] seed: 1234
[2023-06-25 23:31:20] [config] sentencepiece-alphas:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] sentencepiece-max-lines: 2000000
[2023-06-25 23:31:20] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 23:31:20] [config] sharding: global
[2023-06-25 23:31:20] [config] shuffle: data
[2023-06-25 23:31:20] [config] shuffle-in-ram: false
[2023-06-25 23:31:20] [config] sigterm: save-and-exit
[2023-06-25 23:31:20] [config] skip: false
[2023-06-25 23:31:20] [config] sqlite: ""
[2023-06-25 23:31:20] [config] sqlite-drop: false
[2023-06-25 23:31:20] [config] sync-freq: 200u
[2023-06-25 23:31:20] [config] sync-sgd: false
[2023-06-25 23:31:20] [config] tempdir: /tmp
[2023-06-25 23:31:20] [config] tied-embeddings: false
[2023-06-25 23:31:20] [config] tied-embeddings-all: true
[2023-06-25 23:31:20] [config] tied-embeddings-src: false
[2023-06-25 23:31:20] [config] train-embedder-rank:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] train-sets:
[2023-06-25 23:31:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 23:31:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 23:31:20] [config] transformer-aan-activation: swish
[2023-06-25 23:31:20] [config] transformer-aan-depth: 2
[2023-06-25 23:31:20] [config] transformer-aan-nogate: false
[2023-06-25 23:31:20] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 23:31:20] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 23:31:20] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 23:31:20] [config] transformer-depth-scaling: false
[2023-06-25 23:31:20] [config] transformer-dim-aan: 2048
[2023-06-25 23:31:20] [config] transformer-dim-ffn: 2048
[2023-06-25 23:31:20] [config] transformer-dropout: 0
[2023-06-25 23:31:20] [config] transformer-dropout-attention: 0
[2023-06-25 23:31:20] [config] transformer-dropout-ffn: 0
[2023-06-25 23:31:20] [config] transformer-ffn-activation: swish
[2023-06-25 23:31:20] [config] transformer-ffn-depth: 2
[2023-06-25 23:31:20] [config] transformer-guided-alignment-layer: last
[2023-06-25 23:31:20] [config] transformer-heads: 8
[2023-06-25 23:31:20] [config] transformer-no-projection: false
[2023-06-25 23:31:20] [config] transformer-pool: false
[2023-06-25 23:31:20] [config] transformer-postprocess: dan
[2023-06-25 23:31:20] [config] transformer-postprocess-emb: d
[2023-06-25 23:31:20] [config] transformer-postprocess-top: ""
[2023-06-25 23:31:20] [config] transformer-preprocess: ""
[2023-06-25 23:31:20] [config] transformer-tied-layers:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] transformer-train-position-embeddings: false
[2023-06-25 23:31:20] [config] tsv: false
[2023-06-25 23:31:20] [config] tsv-fields: 0
[2023-06-25 23:31:20] [config] type: amun
[2023-06-25 23:31:20] [config] ulr: false
[2023-06-25 23:31:20] [config] ulr-dim-emb: 0
[2023-06-25 23:31:20] [config] ulr-dropout: 0
[2023-06-25 23:31:20] [config] ulr-keys-vectors: ""
[2023-06-25 23:31:20] [config] ulr-query-vectors: ""
[2023-06-25 23:31:20] [config] ulr-softmax-temperature: 1
[2023-06-25 23:31:20] [config] ulr-trainable-transformation: false
[2023-06-25 23:31:20] [config] unlikelihood-loss: false
[2023-06-25 23:31:20] [config] valid-freq: 5000000
[2023-06-25 23:31:20] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 23:31:20] [config] valid-max-length: 1000
[2023-06-25 23:31:20] [config] valid-metrics:
[2023-06-25 23:31:20] [config]   - cross-entropy
[2023-06-25 23:31:20] [config]   - translation
[2023-06-25 23:31:20] [config] valid-mini-batch: 32
[2023-06-25 23:31:20] [config] valid-reset-stalled: false
[2023-06-25 23:31:20] [config] valid-script-args:
[2023-06-25 23:31:20] [config]   []
[2023-06-25 23:31:20] [config] valid-script-path: ""
[2023-06-25 23:31:20] [config] valid-sets:
[2023-06-25 23:31:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 23:31:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 23:31:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 23:31:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:31:20] [config] vocabs:
[2023-06-25 23:31:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:31:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:31:20] [config] word-penalty: 0
[2023-06-25 23:31:20] [config] word-scores: false
[2023-06-25 23:31:20] [config] workspace: 3000
[2023-06-25 23:31:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:31:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:31:20] [training] Using single-device training
[2023-06-25 23:31:21] Synced seed 1234
[2023-06-25 23:31:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:31:21] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 23:31:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:31:22] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 23:31:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 23:31:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:31:22] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:31:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:31:22] [comm] Using global sharding
[2023-06-25 23:31:22] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:31:22] [training] Using 1 GPUs
[2023-06-25 23:31:22] [logits] Applying loss function for 1 factor(s)
[2023-06-25 23:31:22] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:31:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 23:31:23] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:31:38] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 23:31:38] [valid] No post-processing script given for validating translator
[2023-06-25 23:31:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:31:38] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:31:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:31:38] [comm] Using global sharding
[2023-06-25 23:31:38] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:31:38] [training] Using 1 GPUs
[2023-06-25 23:31:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:31:39] Loading Adam parameters
[2023-06-25 23:31:39] [memory] Reserving 290 MB, device gpu0
[2023-06-25 23:31:39] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:31:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:31:39] [data] Restoring the corpus state to epoch 71, batch 6178
[2023-06-25 23:31:39] [data] Shuffling data
[2023-06-25 23:31:39] [data] Done reading 20,192 sentences
[2023-06-25 23:31:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:31:39] Training started
[2023-06-25 23:31:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 23:31:39] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:31:40] Parameter type float32, optimization type float32, casting types false
[2023-06-25 23:32:21] Seen 15,667 samples
[2023-06-25 23:32:21] Starting data epoch 72 in logical epoch 72
[2023-06-25 23:32:21] [data] Shuffling data
[2023-06-25 23:32:21] [data] Done reading 20,192 sentences
[2023-06-25 23:32:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:33:07] Seen 15,667 samples
[2023-06-25 23:33:07] Starting data epoch 73 in logical epoch 73
[2023-06-25 23:33:07] [data] Shuffling data
[2023-06-25 23:33:07] [data] Done reading 20,192 sentences
[2023-06-25 23:33:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:33:52] Seen 15,667 samples
[2023-06-25 23:33:52] Starting data epoch 74 in logical epoch 74
[2023-06-25 23:33:52] [data] Shuffling data
[2023-06-25 23:33:52] [data] Done reading 20,192 sentences
[2023-06-25 23:33:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:34:37] Seen 15,667 samples
[2023-06-25 23:34:37] Starting data epoch 75 in logical epoch 75
[2023-06-25 23:34:37] [data] Shuffling data
[2023-06-25 23:34:37] [data] Done reading 20,192 sentences
[2023-06-25 23:34:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:35:22] Seen 15,667 samples
[2023-06-25 23:35:22] Starting data epoch 76 in logical epoch 76
[2023-06-25 23:35:22] [data] Shuffling data
[2023-06-25 23:35:22] [data] Done reading 20,192 sentences
[2023-06-25 23:35:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:36:07] Seen 15,667 samples
[2023-06-25 23:36:07] Starting data epoch 77 in logical epoch 77
[2023-06-25 23:36:07] [data] Shuffling data
[2023-06-25 23:36:07] [data] Done reading 20,192 sentences
[2023-06-25 23:36:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:36:50] Seen 15,667 samples
[2023-06-25 23:36:50] Starting data epoch 78 in logical epoch 78
[2023-06-25 23:36:50] [data] Shuffling data
[2023-06-25 23:36:50] [data] Done reading 20,192 sentences
[2023-06-25 23:36:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:37:36] Seen 15,667 samples
[2023-06-25 23:37:36] Starting data epoch 79 in logical epoch 79
[2023-06-25 23:37:36] [data] Shuffling data
[2023-06-25 23:37:36] [data] Done reading 20,192 sentences
[2023-06-25 23:37:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:38:22] Seen 15,667 samples
[2023-06-25 23:38:22] Starting data epoch 80 in logical epoch 80
[2023-06-25 23:38:22] [data] Shuffling data
[2023-06-25 23:38:22] [data] Done reading 20,192 sentences
[2023-06-25 23:38:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:38:38] Ep. 80 : Up. 7000 : Sen. 6,159 : Cost 1.71750093 * 4,278,713 @ 804 after 29,837,820 : Time 419.91s : 10189.52 words/s : gNorm 1.2092
[2023-06-25 23:39:04] Seen 15,667 samples
[2023-06-25 23:39:04] Starting data epoch 81 in logical epoch 81
[2023-06-25 23:39:04] Training finished
[2023-06-25 23:39:14] [valid] Ep. 81 : Up. 7054 : cross-entropy : 116.801 : new best
[2023-06-25 23:39:49] [valid] Ep. 81 : Up. 7054 : translation : 0 : new best
[2023-06-25 23:39:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:39:50] Saving Adam parameters
[2023-06-25 23:39:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:42:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:42:54] [marian] Running on node07.datos.cluster.uy as process 12722 with command line:
[2023-06-25 23:42:54] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 23:42:54] [config] after: 0e
[2023-06-25 23:42:54] [config] after-batches: 0
[2023-06-25 23:42:54] [config] after-epochs: 90
[2023-06-25 23:42:54] [config] all-caps-every: 0
[2023-06-25 23:42:54] [config] allow-unk: false
[2023-06-25 23:42:54] [config] authors: false
[2023-06-25 23:42:54] [config] beam-size: 6
[2023-06-25 23:42:54] [config] bert-class-symbol: "[CLS]"
[2023-06-25 23:42:54] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 23:42:54] [config] bert-masking-fraction: 0.15
[2023-06-25 23:42:54] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 23:42:54] [config] bert-train-type-embeddings: true
[2023-06-25 23:42:54] [config] bert-type-vocab-size: 2
[2023-06-25 23:42:54] [config] build-info: ""
[2023-06-25 23:42:54] [config] check-gradient-nan: false
[2023-06-25 23:42:54] [config] check-nan: false
[2023-06-25 23:42:54] [config] cite: false
[2023-06-25 23:42:54] [config] clip-norm: 1
[2023-06-25 23:42:54] [config] cost-scaling:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] cost-type: ce-sum
[2023-06-25 23:42:54] [config] cpu-threads: 0
[2023-06-25 23:42:54] [config] data-threads: 8
[2023-06-25 23:42:54] [config] data-weighting: ""
[2023-06-25 23:42:54] [config] data-weighting-type: sentence
[2023-06-25 23:42:54] [config] dec-cell: gru
[2023-06-25 23:42:54] [config] dec-cell-base-depth: 2
[2023-06-25 23:42:54] [config] dec-cell-high-depth: 1
[2023-06-25 23:42:54] [config] dec-depth: 1
[2023-06-25 23:42:54] [config] devices:
[2023-06-25 23:42:54] [config]   - 0
[2023-06-25 23:42:54] [config] dim-emb: 512
[2023-06-25 23:42:54] [config] dim-rnn: 1024
[2023-06-25 23:42:54] [config] dim-vocabs:
[2023-06-25 23:42:54] [config]   - 8192
[2023-06-25 23:42:54] [config]   - 8192
[2023-06-25 23:42:54] [config] disp-first: 0
[2023-06-25 23:42:54] [config] disp-freq: 1000u
[2023-06-25 23:42:54] [config] disp-label-counts: true
[2023-06-25 23:42:54] [config] dropout-rnn: 0.2
[2023-06-25 23:42:54] [config] dropout-src: 0.1
[2023-06-25 23:42:54] [config] dropout-trg: 0.1
[2023-06-25 23:42:54] [config] dump-config: ""
[2023-06-25 23:42:54] [config] dynamic-gradient-scaling:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] early-stopping: 10
[2023-06-25 23:42:54] [config] early-stopping-on: first
[2023-06-25 23:42:54] [config] embedding-fix-src: false
[2023-06-25 23:42:54] [config] embedding-fix-trg: false
[2023-06-25 23:42:54] [config] embedding-normalization: false
[2023-06-25 23:42:54] [config] embedding-vectors:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] enc-cell: gru
[2023-06-25 23:42:54] [config] enc-cell-depth: 1
[2023-06-25 23:42:54] [config] enc-depth: 1
[2023-06-25 23:42:54] [config] enc-type: bidirectional
[2023-06-25 23:42:54] [config] english-title-case-every: 0
[2023-06-25 23:42:54] [config] exponential-smoothing: 0
[2023-06-25 23:42:54] [config] factor-weight: 1
[2023-06-25 23:42:54] [config] factors-combine: sum
[2023-06-25 23:42:54] [config] factors-dim-emb: 0
[2023-06-25 23:42:54] [config] gradient-checkpointing: false
[2023-06-25 23:42:54] [config] gradient-norm-average-window: 100
[2023-06-25 23:42:54] [config] guided-alignment: none
[2023-06-25 23:42:54] [config] guided-alignment-cost: mse
[2023-06-25 23:42:54] [config] guided-alignment-weight: 0.1
[2023-06-25 23:42:54] [config] ignore-model-config: false
[2023-06-25 23:42:54] [config] input-types:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] interpolate-env-vars: false
[2023-06-25 23:42:54] [config] keep-best: false
[2023-06-25 23:42:54] [config] label-smoothing: 0
[2023-06-25 23:42:54] [config] layer-normalization: true
[2023-06-25 23:42:54] [config] learn-rate: 0.0001
[2023-06-25 23:42:54] [config] lemma-dependency: ""
[2023-06-25 23:42:54] [config] lemma-dim-emb: 0
[2023-06-25 23:42:54] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 23:42:54] [config] log-level: info
[2023-06-25 23:42:54] [config] log-time-zone: ""
[2023-06-25 23:42:54] [config] logical-epoch:
[2023-06-25 23:42:54] [config]   - 1e
[2023-06-25 23:42:54] [config]   - 0
[2023-06-25 23:42:54] [config] lr-decay: 0
[2023-06-25 23:42:54] [config] lr-decay-freq: 50000
[2023-06-25 23:42:54] [config] lr-decay-inv-sqrt:
[2023-06-25 23:42:54] [config]   - 0
[2023-06-25 23:42:54] [config] lr-decay-repeat-warmup: false
[2023-06-25 23:42:54] [config] lr-decay-reset-optimizer: false
[2023-06-25 23:42:54] [config] lr-decay-start:
[2023-06-25 23:42:54] [config]   - 10
[2023-06-25 23:42:54] [config]   - 1
[2023-06-25 23:42:54] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 23:42:54] [config] lr-report: false
[2023-06-25 23:42:54] [config] lr-warmup: 0
[2023-06-25 23:42:54] [config] lr-warmup-at-reload: false
[2023-06-25 23:42:54] [config] lr-warmup-cycle: false
[2023-06-25 23:42:54] [config] lr-warmup-start-rate: 0
[2023-06-25 23:42:54] [config] max-length: 50
[2023-06-25 23:42:54] [config] max-length-crop: false
[2023-06-25 23:42:54] [config] max-length-factor: 3
[2023-06-25 23:42:54] [config] maxi-batch: 100
[2023-06-25 23:42:54] [config] maxi-batch-sort: trg
[2023-06-25 23:42:54] [config] mini-batch: 64
[2023-06-25 23:42:54] [config] mini-batch-fit: true
[2023-06-25 23:42:54] [config] mini-batch-fit-step: 10
[2023-06-25 23:42:54] [config] mini-batch-round-up: true
[2023-06-25 23:42:54] [config] mini-batch-track-lr: false
[2023-06-25 23:42:54] [config] mini-batch-warmup: 0
[2023-06-25 23:42:54] [config] mini-batch-words: 0
[2023-06-25 23:42:54] [config] mini-batch-words-ref: 0
[2023-06-25 23:42:54] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:42:54] [config] multi-loss-type: sum
[2023-06-25 23:42:54] [config] n-best: false
[2023-06-25 23:42:54] [config] no-nccl: false
[2023-06-25 23:42:54] [config] no-reload: false
[2023-06-25 23:42:54] [config] no-restore-corpus: false
[2023-06-25 23:42:54] [config] normalize: 0.6
[2023-06-25 23:42:54] [config] normalize-gradient: false
[2023-06-25 23:42:54] [config] num-devices: 0
[2023-06-25 23:42:54] [config] optimizer: adam
[2023-06-25 23:42:54] [config] optimizer-delay: 1
[2023-06-25 23:42:54] [config] optimizer-params:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] output-omit-bias: false
[2023-06-25 23:42:54] [config] overwrite: false
[2023-06-25 23:42:54] [config] precision:
[2023-06-25 23:42:54] [config]   - float32
[2023-06-25 23:42:54] [config]   - float32
[2023-06-25 23:42:54] [config] pretrained-model: ""
[2023-06-25 23:42:54] [config] quantize-biases: false
[2023-06-25 23:42:54] [config] quantize-bits: 0
[2023-06-25 23:42:54] [config] quantize-log-based: false
[2023-06-25 23:42:54] [config] quantize-optimization-steps: 0
[2023-06-25 23:42:54] [config] quiet: false
[2023-06-25 23:42:54] [config] quiet-translation: true
[2023-06-25 23:42:54] [config] relative-paths: false
[2023-06-25 23:42:54] [config] right-left: false
[2023-06-25 23:42:54] [config] save-freq: 10000u
[2023-06-25 23:42:54] [config] seed: 1234
[2023-06-25 23:42:54] [config] sentencepiece-alphas:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] sentencepiece-max-lines: 2000000
[2023-06-25 23:42:54] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 23:42:54] [config] sharding: global
[2023-06-25 23:42:54] [config] shuffle: data
[2023-06-25 23:42:54] [config] shuffle-in-ram: false
[2023-06-25 23:42:54] [config] sigterm: save-and-exit
[2023-06-25 23:42:54] [config] skip: false
[2023-06-25 23:42:54] [config] sqlite: ""
[2023-06-25 23:42:54] [config] sqlite-drop: false
[2023-06-25 23:42:54] [config] sync-freq: 200u
[2023-06-25 23:42:54] [config] sync-sgd: false
[2023-06-25 23:42:54] [config] tempdir: /tmp
[2023-06-25 23:42:54] [config] tied-embeddings: false
[2023-06-25 23:42:54] [config] tied-embeddings-all: true
[2023-06-25 23:42:54] [config] tied-embeddings-src: false
[2023-06-25 23:42:54] [config] train-embedder-rank:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] train-sets:
[2023-06-25 23:42:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 23:42:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 23:42:54] [config] transformer-aan-activation: swish
[2023-06-25 23:42:54] [config] transformer-aan-depth: 2
[2023-06-25 23:42:54] [config] transformer-aan-nogate: false
[2023-06-25 23:42:54] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 23:42:54] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 23:42:54] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 23:42:54] [config] transformer-depth-scaling: false
[2023-06-25 23:42:54] [config] transformer-dim-aan: 2048
[2023-06-25 23:42:54] [config] transformer-dim-ffn: 2048
[2023-06-25 23:42:54] [config] transformer-dropout: 0
[2023-06-25 23:42:54] [config] transformer-dropout-attention: 0
[2023-06-25 23:42:54] [config] transformer-dropout-ffn: 0
[2023-06-25 23:42:54] [config] transformer-ffn-activation: swish
[2023-06-25 23:42:54] [config] transformer-ffn-depth: 2
[2023-06-25 23:42:54] [config] transformer-guided-alignment-layer: last
[2023-06-25 23:42:54] [config] transformer-heads: 8
[2023-06-25 23:42:54] [config] transformer-no-projection: false
[2023-06-25 23:42:54] [config] transformer-pool: false
[2023-06-25 23:42:54] [config] transformer-postprocess: dan
[2023-06-25 23:42:54] [config] transformer-postprocess-emb: d
[2023-06-25 23:42:54] [config] transformer-postprocess-top: ""
[2023-06-25 23:42:54] [config] transformer-preprocess: ""
[2023-06-25 23:42:54] [config] transformer-tied-layers:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] transformer-train-position-embeddings: false
[2023-06-25 23:42:54] [config] tsv: false
[2023-06-25 23:42:54] [config] tsv-fields: 0
[2023-06-25 23:42:54] [config] type: amun
[2023-06-25 23:42:54] [config] ulr: false
[2023-06-25 23:42:54] [config] ulr-dim-emb: 0
[2023-06-25 23:42:54] [config] ulr-dropout: 0
[2023-06-25 23:42:54] [config] ulr-keys-vectors: ""
[2023-06-25 23:42:54] [config] ulr-query-vectors: ""
[2023-06-25 23:42:54] [config] ulr-softmax-temperature: 1
[2023-06-25 23:42:54] [config] ulr-trainable-transformation: false
[2023-06-25 23:42:54] [config] unlikelihood-loss: false
[2023-06-25 23:42:54] [config] valid-freq: 5000000
[2023-06-25 23:42:54] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 23:42:54] [config] valid-max-length: 1000
[2023-06-25 23:42:54] [config] valid-metrics:
[2023-06-25 23:42:54] [config]   - cross-entropy
[2023-06-25 23:42:54] [config]   - translation
[2023-06-25 23:42:54] [config] valid-mini-batch: 32
[2023-06-25 23:42:54] [config] valid-reset-stalled: false
[2023-06-25 23:42:54] [config] valid-script-args:
[2023-06-25 23:42:54] [config]   []
[2023-06-25 23:42:54] [config] valid-script-path: ""
[2023-06-25 23:42:54] [config] valid-sets:
[2023-06-25 23:42:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 23:42:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 23:42:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 23:42:54] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:42:54] [config] vocabs:
[2023-06-25 23:42:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:42:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:42:54] [config] word-penalty: 0
[2023-06-25 23:42:54] [config] word-scores: false
[2023-06-25 23:42:54] [config] workspace: 3000
[2023-06-25 23:42:54] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:42:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:42:54] [training] Using single-device training
[2023-06-25 23:42:54] Synced seed 1234
[2023-06-25 23:42:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:42:54] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 23:42:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:42:54] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 23:42:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 23:42:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:42:55] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:42:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:42:55] [comm] Using global sharding
[2023-06-25 23:42:55] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:42:55] [training] Using 1 GPUs
[2023-06-25 23:42:55] [logits] Applying loss function for 1 factor(s)
[2023-06-25 23:42:55] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:42:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 23:42:56] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:43:11] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 23:43:12] [valid] No post-processing script given for validating translator
[2023-06-25 23:43:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:43:12] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:43:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:43:12] [comm] Using global sharding
[2023-06-25 23:43:12] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:43:12] [training] Using 1 GPUs
[2023-06-25 23:43:12] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:43:12] Loading Adam parameters
[2023-06-25 23:43:13] [memory] Reserving 290 MB, device gpu0
[2023-06-25 23:43:13] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:43:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:43:13] [data] Restoring the corpus state to epoch 81, batch 7054
[2023-06-25 23:43:13] [data] Shuffling data
[2023-06-25 23:43:13] [data] Done reading 20,192 sentences
[2023-06-25 23:43:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:43:13] Training started
[2023-06-25 23:43:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 23:43:13] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:43:14] Parameter type float32, optimization type float32, casting types false
[2023-06-25 23:43:56] Seen 15,667 samples
[2023-06-25 23:43:56] Starting data epoch 82 in logical epoch 82
[2023-06-25 23:43:56] [data] Shuffling data
[2023-06-25 23:43:56] [data] Done reading 20,192 sentences
[2023-06-25 23:43:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:44:41] Seen 15,667 samples
[2023-06-25 23:44:41] Starting data epoch 83 in logical epoch 83
[2023-06-25 23:44:41] [data] Shuffling data
[2023-06-25 23:44:41] [data] Done reading 20,192 sentences
[2023-06-25 23:44:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:45:25] Seen 15,667 samples
[2023-06-25 23:45:25] Starting data epoch 84 in logical epoch 84
[2023-06-25 23:45:25] [data] Shuffling data
[2023-06-25 23:45:25] [data] Done reading 20,192 sentences
[2023-06-25 23:45:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:46:11] Seen 15,667 samples
[2023-06-25 23:46:11] Starting data epoch 85 in logical epoch 85
[2023-06-25 23:46:11] [data] Shuffling data
[2023-06-25 23:46:11] [data] Done reading 20,192 sentences
[2023-06-25 23:46:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:46:56] Seen 15,667 samples
[2023-06-25 23:46:56] Starting data epoch 86 in logical epoch 86
[2023-06-25 23:46:56] [data] Shuffling data
[2023-06-25 23:46:56] [data] Done reading 20,192 sentences
[2023-06-25 23:46:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:47:40] Seen 15,667 samples
[2023-06-25 23:47:40] Starting data epoch 87 in logical epoch 87
[2023-06-25 23:47:40] [data] Shuffling data
[2023-06-25 23:47:40] [data] Done reading 20,192 sentences
[2023-06-25 23:47:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:48:26] Seen 15,667 samples
[2023-06-25 23:48:26] Starting data epoch 88 in logical epoch 88
[2023-06-25 23:48:26] [data] Shuffling data
[2023-06-25 23:48:26] [data] Done reading 20,192 sentences
[2023-06-25 23:48:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:49:11] Seen 15,667 samples
[2023-06-25 23:49:11] Starting data epoch 89 in logical epoch 89
[2023-06-25 23:49:11] [data] Shuffling data
[2023-06-25 23:49:11] [data] Done reading 20,192 sentences
[2023-06-25 23:49:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:49:57] Seen 15,667 samples
[2023-06-25 23:49:57] Starting data epoch 90 in logical epoch 90
[2023-06-25 23:49:57] [data] Shuffling data
[2023-06-25 23:49:57] [data] Done reading 20,192 sentences
[2023-06-25 23:49:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:50:40] Seen 15,667 samples
[2023-06-25 23:50:40] Starting data epoch 91 in logical epoch 91
[2023-06-25 23:50:40] Training finished
[2023-06-25 23:50:50] [valid] Ep. 91 : Up. 7934 : cross-entropy : 116.968 : stalled 1 times (last best: 116.801)
[2023-06-25 23:51:27] [valid] Ep. 91 : Up. 7934 : translation : 0 : new best
[2023-06-25 23:51:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:51:29] Saving Adam parameters
[2023-06-25 23:51:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:54:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:54:37] [marian] Running on node07.datos.cluster.uy as process 13748 with command line:
[2023-06-25 23:54:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 8192 8192 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-25 23:54:37] [config] after: 0e
[2023-06-25 23:54:37] [config] after-batches: 0
[2023-06-25 23:54:37] [config] after-epochs: 100
[2023-06-25 23:54:37] [config] all-caps-every: 0
[2023-06-25 23:54:37] [config] allow-unk: false
[2023-06-25 23:54:37] [config] authors: false
[2023-06-25 23:54:37] [config] beam-size: 6
[2023-06-25 23:54:37] [config] bert-class-symbol: "[CLS]"
[2023-06-25 23:54:37] [config] bert-mask-symbol: "[MASK]"
[2023-06-25 23:54:37] [config] bert-masking-fraction: 0.15
[2023-06-25 23:54:37] [config] bert-sep-symbol: "[SEP]"
[2023-06-25 23:54:37] [config] bert-train-type-embeddings: true
[2023-06-25 23:54:37] [config] bert-type-vocab-size: 2
[2023-06-25 23:54:37] [config] build-info: ""
[2023-06-25 23:54:37] [config] check-gradient-nan: false
[2023-06-25 23:54:37] [config] check-nan: false
[2023-06-25 23:54:37] [config] cite: false
[2023-06-25 23:54:37] [config] clip-norm: 1
[2023-06-25 23:54:37] [config] cost-scaling:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] cost-type: ce-sum
[2023-06-25 23:54:37] [config] cpu-threads: 0
[2023-06-25 23:54:37] [config] data-threads: 8
[2023-06-25 23:54:37] [config] data-weighting: ""
[2023-06-25 23:54:37] [config] data-weighting-type: sentence
[2023-06-25 23:54:37] [config] dec-cell: gru
[2023-06-25 23:54:37] [config] dec-cell-base-depth: 2
[2023-06-25 23:54:37] [config] dec-cell-high-depth: 1
[2023-06-25 23:54:37] [config] dec-depth: 1
[2023-06-25 23:54:37] [config] devices:
[2023-06-25 23:54:37] [config]   - 0
[2023-06-25 23:54:37] [config] dim-emb: 512
[2023-06-25 23:54:37] [config] dim-rnn: 1024
[2023-06-25 23:54:37] [config] dim-vocabs:
[2023-06-25 23:54:37] [config]   - 8192
[2023-06-25 23:54:37] [config]   - 8192
[2023-06-25 23:54:37] [config] disp-first: 0
[2023-06-25 23:54:37] [config] disp-freq: 1000u
[2023-06-25 23:54:37] [config] disp-label-counts: true
[2023-06-25 23:54:37] [config] dropout-rnn: 0.2
[2023-06-25 23:54:37] [config] dropout-src: 0.1
[2023-06-25 23:54:37] [config] dropout-trg: 0.1
[2023-06-25 23:54:37] [config] dump-config: ""
[2023-06-25 23:54:37] [config] dynamic-gradient-scaling:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] early-stopping: 10
[2023-06-25 23:54:37] [config] early-stopping-on: first
[2023-06-25 23:54:37] [config] embedding-fix-src: false
[2023-06-25 23:54:37] [config] embedding-fix-trg: false
[2023-06-25 23:54:37] [config] embedding-normalization: false
[2023-06-25 23:54:37] [config] embedding-vectors:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] enc-cell: gru
[2023-06-25 23:54:37] [config] enc-cell-depth: 1
[2023-06-25 23:54:37] [config] enc-depth: 1
[2023-06-25 23:54:37] [config] enc-type: bidirectional
[2023-06-25 23:54:37] [config] english-title-case-every: 0
[2023-06-25 23:54:37] [config] exponential-smoothing: 0
[2023-06-25 23:54:37] [config] factor-weight: 1
[2023-06-25 23:54:37] [config] factors-combine: sum
[2023-06-25 23:54:37] [config] factors-dim-emb: 0
[2023-06-25 23:54:37] [config] gradient-checkpointing: false
[2023-06-25 23:54:37] [config] gradient-norm-average-window: 100
[2023-06-25 23:54:37] [config] guided-alignment: none
[2023-06-25 23:54:37] [config] guided-alignment-cost: mse
[2023-06-25 23:54:37] [config] guided-alignment-weight: 0.1
[2023-06-25 23:54:37] [config] ignore-model-config: false
[2023-06-25 23:54:37] [config] input-types:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] interpolate-env-vars: false
[2023-06-25 23:54:37] [config] keep-best: false
[2023-06-25 23:54:37] [config] label-smoothing: 0
[2023-06-25 23:54:37] [config] layer-normalization: true
[2023-06-25 23:54:37] [config] learn-rate: 0.0001
[2023-06-25 23:54:37] [config] lemma-dependency: ""
[2023-06-25 23:54:37] [config] lemma-dim-emb: 0
[2023-06-25 23:54:37] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp.log
[2023-06-25 23:54:37] [config] log-level: info
[2023-06-25 23:54:37] [config] log-time-zone: ""
[2023-06-25 23:54:37] [config] logical-epoch:
[2023-06-25 23:54:37] [config]   - 1e
[2023-06-25 23:54:37] [config]   - 0
[2023-06-25 23:54:37] [config] lr-decay: 0
[2023-06-25 23:54:37] [config] lr-decay-freq: 50000
[2023-06-25 23:54:37] [config] lr-decay-inv-sqrt:
[2023-06-25 23:54:37] [config]   - 0
[2023-06-25 23:54:37] [config] lr-decay-repeat-warmup: false
[2023-06-25 23:54:37] [config] lr-decay-reset-optimizer: false
[2023-06-25 23:54:37] [config] lr-decay-start:
[2023-06-25 23:54:37] [config]   - 10
[2023-06-25 23:54:37] [config]   - 1
[2023-06-25 23:54:37] [config] lr-decay-strategy: epoch+stalled
[2023-06-25 23:54:37] [config] lr-report: false
[2023-06-25 23:54:37] [config] lr-warmup: 0
[2023-06-25 23:54:37] [config] lr-warmup-at-reload: false
[2023-06-25 23:54:37] [config] lr-warmup-cycle: false
[2023-06-25 23:54:37] [config] lr-warmup-start-rate: 0
[2023-06-25 23:54:37] [config] max-length: 50
[2023-06-25 23:54:37] [config] max-length-crop: false
[2023-06-25 23:54:37] [config] max-length-factor: 3
[2023-06-25 23:54:37] [config] maxi-batch: 100
[2023-06-25 23:54:37] [config] maxi-batch-sort: trg
[2023-06-25 23:54:37] [config] mini-batch: 64
[2023-06-25 23:54:37] [config] mini-batch-fit: true
[2023-06-25 23:54:37] [config] mini-batch-fit-step: 10
[2023-06-25 23:54:37] [config] mini-batch-round-up: true
[2023-06-25 23:54:37] [config] mini-batch-track-lr: false
[2023-06-25 23:54:37] [config] mini-batch-warmup: 0
[2023-06-25 23:54:37] [config] mini-batch-words: 0
[2023-06-25 23:54:37] [config] mini-batch-words-ref: 0
[2023-06-25 23:54:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:54:37] [config] multi-loss-type: sum
[2023-06-25 23:54:37] [config] n-best: false
[2023-06-25 23:54:37] [config] no-nccl: false
[2023-06-25 23:54:37] [config] no-reload: false
[2023-06-25 23:54:37] [config] no-restore-corpus: false
[2023-06-25 23:54:37] [config] normalize: 0.6
[2023-06-25 23:54:37] [config] normalize-gradient: false
[2023-06-25 23:54:37] [config] num-devices: 0
[2023-06-25 23:54:37] [config] optimizer: adam
[2023-06-25 23:54:37] [config] optimizer-delay: 1
[2023-06-25 23:54:37] [config] optimizer-params:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] output-omit-bias: false
[2023-06-25 23:54:37] [config] overwrite: false
[2023-06-25 23:54:37] [config] precision:
[2023-06-25 23:54:37] [config]   - float32
[2023-06-25 23:54:37] [config]   - float32
[2023-06-25 23:54:37] [config] pretrained-model: ""
[2023-06-25 23:54:37] [config] quantize-biases: false
[2023-06-25 23:54:37] [config] quantize-bits: 0
[2023-06-25 23:54:37] [config] quantize-log-based: false
[2023-06-25 23:54:37] [config] quantize-optimization-steps: 0
[2023-06-25 23:54:37] [config] quiet: false
[2023-06-25 23:54:37] [config] quiet-translation: true
[2023-06-25 23:54:37] [config] relative-paths: false
[2023-06-25 23:54:37] [config] right-left: false
[2023-06-25 23:54:37] [config] save-freq: 10000u
[2023-06-25 23:54:37] [config] seed: 1234
[2023-06-25 23:54:37] [config] sentencepiece-alphas:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] sentencepiece-max-lines: 2000000
[2023-06-25 23:54:37] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-25 23:54:37] [config] sharding: global
[2023-06-25 23:54:37] [config] shuffle: data
[2023-06-25 23:54:37] [config] shuffle-in-ram: false
[2023-06-25 23:54:37] [config] sigterm: save-and-exit
[2023-06-25 23:54:37] [config] skip: false
[2023-06-25 23:54:37] [config] sqlite: ""
[2023-06-25 23:54:37] [config] sqlite-drop: false
[2023-06-25 23:54:37] [config] sync-freq: 200u
[2023-06-25 23:54:37] [config] sync-sgd: false
[2023-06-25 23:54:37] [config] tempdir: /tmp
[2023-06-25 23:54:37] [config] tied-embeddings: false
[2023-06-25 23:54:37] [config] tied-embeddings-all: true
[2023-06-25 23:54:37] [config] tied-embeddings-src: false
[2023-06-25 23:54:37] [config] train-embedder-rank:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] train-sets:
[2023-06-25 23:54:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-25 23:54:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-25 23:54:37] [config] transformer-aan-activation: swish
[2023-06-25 23:54:37] [config] transformer-aan-depth: 2
[2023-06-25 23:54:37] [config] transformer-aan-nogate: false
[2023-06-25 23:54:37] [config] transformer-decoder-autoreg: self-attention
[2023-06-25 23:54:37] [config] transformer-decoder-dim-ffn: 0
[2023-06-25 23:54:37] [config] transformer-decoder-ffn-depth: 0
[2023-06-25 23:54:37] [config] transformer-depth-scaling: false
[2023-06-25 23:54:37] [config] transformer-dim-aan: 2048
[2023-06-25 23:54:37] [config] transformer-dim-ffn: 2048
[2023-06-25 23:54:37] [config] transformer-dropout: 0
[2023-06-25 23:54:37] [config] transformer-dropout-attention: 0
[2023-06-25 23:54:37] [config] transformer-dropout-ffn: 0
[2023-06-25 23:54:37] [config] transformer-ffn-activation: swish
[2023-06-25 23:54:37] [config] transformer-ffn-depth: 2
[2023-06-25 23:54:37] [config] transformer-guided-alignment-layer: last
[2023-06-25 23:54:37] [config] transformer-heads: 8
[2023-06-25 23:54:37] [config] transformer-no-projection: false
[2023-06-25 23:54:37] [config] transformer-pool: false
[2023-06-25 23:54:37] [config] transformer-postprocess: dan
[2023-06-25 23:54:37] [config] transformer-postprocess-emb: d
[2023-06-25 23:54:37] [config] transformer-postprocess-top: ""
[2023-06-25 23:54:37] [config] transformer-preprocess: ""
[2023-06-25 23:54:37] [config] transformer-tied-layers:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] transformer-train-position-embeddings: false
[2023-06-25 23:54:37] [config] tsv: false
[2023-06-25 23:54:37] [config] tsv-fields: 0
[2023-06-25 23:54:37] [config] type: amun
[2023-06-25 23:54:37] [config] ulr: false
[2023-06-25 23:54:37] [config] ulr-dim-emb: 0
[2023-06-25 23:54:37] [config] ulr-dropout: 0
[2023-06-25 23:54:37] [config] ulr-keys-vectors: ""
[2023-06-25 23:54:37] [config] ulr-query-vectors: ""
[2023-06-25 23:54:37] [config] ulr-softmax-temperature: 1
[2023-06-25 23:54:37] [config] ulr-trainable-transformation: false
[2023-06-25 23:54:37] [config] unlikelihood-loss: false
[2023-06-25 23:54:37] [config] valid-freq: 5000000
[2023-06-25 23:54:37] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp.log
[2023-06-25 23:54:37] [config] valid-max-length: 1000
[2023-06-25 23:54:37] [config] valid-metrics:
[2023-06-25 23:54:37] [config]   - cross-entropy
[2023-06-25 23:54:37] [config]   - translation
[2023-06-25 23:54:37] [config] valid-mini-batch: 32
[2023-06-25 23:54:37] [config] valid-reset-stalled: false
[2023-06-25 23:54:37] [config] valid-script-args:
[2023-06-25 23:54:37] [config]   []
[2023-06-25 23:54:37] [config] valid-script-path: ""
[2023-06-25 23:54:37] [config] valid-sets:
[2023-06-25 23:54:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-25 23:54:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-25 23:54:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-25 23:54:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:54:37] [config] vocabs:
[2023-06-25 23:54:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:54:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:54:37] [config] word-penalty: 0
[2023-06-25 23:54:37] [config] word-scores: false
[2023-06-25 23:54:37] [config] workspace: 3000
[2023-06-25 23:54:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-25 23:54:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:54:37] [training] Using single-device training
[2023-06-25 23:54:37] Synced seed 1234
[2023-06-25 23:54:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn.spm
[2023-06-25 23:54:37] [data] Setting vocabulary size for input 0 to 8,192
[2023-06-25 23:54:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-06-25 23:54:37] [data] Setting vocabulary size for input 1 to 8,192
[2023-06-25 23:54:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-25 23:54:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:54:38] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:54:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:54:38] [comm] Using global sharding
[2023-06-25 23:54:38] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:54:38] [training] Using 1 GPUs
[2023-06-25 23:54:38] [logits] Applying loss function for 1 factor(s)
[2023-06-25 23:54:38] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:54:38] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-25 23:54:38] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:54:53] [batching] Done. Typical MB size is 7,436 target words
[2023-06-25 23:54:54] [valid] No post-processing script given for validating translator
[2023-06-25 23:54:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-25 23:54:54] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-25 23:54:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-25 23:54:54] [comm] Using global sharding
[2023-06-25 23:54:54] [comm] NCCLCommunicators constructed successfully
[2023-06-25 23:54:54] [training] Using 1 GPUs
[2023-06-25 23:54:54] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-25 23:54:54] Loading Adam parameters
[2023-06-25 23:54:55] [memory] Reserving 290 MB, device gpu0
[2023-06-25 23:54:55] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:54:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
[2023-06-25 23:54:55] [data] Restoring the corpus state to epoch 91, batch 7934
[2023-06-25 23:54:55] [data] Shuffling data
[2023-06-25 23:54:55] [data] Done reading 20,192 sentences
[2023-06-25 23:54:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:54:55] Training started
[2023-06-25 23:54:55] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-25 23:54:55] [memory] Reserving 145 MB, device gpu0
[2023-06-25 23:54:56] Parameter type float32, optimization type float32, casting types false
[2023-06-25 23:55:28] Ep. 91 : Up. 8000 : Sen. 11,847 : Cost 1.47665989 * 4,286,589 @ 4,372 after 34,124,409 : Time 34.61s : 123848.13 words/s : gNorm 1.3021
[2023-06-25 23:55:39] Seen 15,667 samples
[2023-06-25 23:55:39] Starting data epoch 92 in logical epoch 92
[2023-06-25 23:55:39] [data] Shuffling data
[2023-06-25 23:55:39] [data] Done reading 20,192 sentences
[2023-06-25 23:55:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:56:22] Seen 15,667 samples
[2023-06-25 23:56:22] Starting data epoch 93 in logical epoch 93
[2023-06-25 23:56:22] [data] Shuffling data
[2023-06-25 23:56:22] [data] Done reading 20,192 sentences
[2023-06-25 23:56:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:57:08] Seen 15,667 samples
[2023-06-25 23:57:08] Starting data epoch 94 in logical epoch 94
[2023-06-25 23:57:08] [data] Shuffling data
[2023-06-25 23:57:08] [data] Done reading 20,192 sentences
[2023-06-25 23:57:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:57:51] Seen 15,667 samples
[2023-06-25 23:57:51] Starting data epoch 95 in logical epoch 95
[2023-06-25 23:57:51] [data] Shuffling data
[2023-06-25 23:57:51] [data] Done reading 20,192 sentences
[2023-06-25 23:57:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:58:38] Seen 15,667 samples
[2023-06-25 23:58:38] Starting data epoch 96 in logical epoch 96
[2023-06-25 23:58:38] [data] Shuffling data
[2023-06-25 23:58:38] [data] Done reading 20,192 sentences
[2023-06-25 23:58:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-25 23:59:22] Seen 15,667 samples
[2023-06-25 23:59:22] Starting data epoch 97 in logical epoch 97
[2023-06-25 23:59:22] [data] Shuffling data
[2023-06-25 23:59:22] [data] Done reading 20,192 sentences
[2023-06-25 23:59:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 00:00:07] Seen 15,667 samples
[2023-06-26 00:00:07] Starting data epoch 98 in logical epoch 98
[2023-06-26 00:00:07] [data] Shuffling data
[2023-06-26 00:00:07] [data] Done reading 20,192 sentences
[2023-06-26 00:00:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 00:00:51] Seen 15,667 samples
[2023-06-26 00:00:51] Starting data epoch 99 in logical epoch 99
[2023-06-26 00:00:51] [data] Shuffling data
[2023-06-26 00:00:51] [data] Done reading 20,192 sentences
[2023-06-26 00:00:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 00:01:36] Seen 15,667 samples
[2023-06-26 00:01:36] Starting data epoch 100 in logical epoch 100
[2023-06-26 00:01:36] [data] Shuffling data
[2023-06-26 00:01:36] [data] Done reading 20,192 sentences
[2023-06-26 00:01:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 00:02:21] Seen 15,667 samples
[2023-06-26 00:02:21] Starting data epoch 101 in logical epoch 101
[2023-06-26 00:02:21] Training finished
[2023-06-26 00:02:30] [valid] Ep. 101 : Up. 8814 : cross-entropy : 119.471 : stalled 2 times (last best: 116.801)
[2023-06-26 00:03:05] [valid] Ep. 101 : Up. 8814 : translation : 0 : new best
[2023-06-26 00:03:05] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz
[2023-06-26 00:03:07] Saving Adam parameters
[2023-06-26 00:03:07] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp/gn_es_scored_june_sp.npz.optimizer.npz
