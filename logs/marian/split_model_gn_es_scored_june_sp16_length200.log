[2023-07-14 11:06:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:06:13] [marian] Running on node21.datos.cluster.uy as process 16896 with command line:
[2023-07-14 11:06:13] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 11:06:13] [config] after: 0e
[2023-07-14 11:06:13] [config] after-batches: 0
[2023-07-14 11:06:13] [config] after-epochs: 10
[2023-07-14 11:06:13] [config] all-caps-every: 0
[2023-07-14 11:06:13] [config] allow-unk: false
[2023-07-14 11:06:13] [config] authors: false
[2023-07-14 11:06:13] [config] beam-size: 6
[2023-07-14 11:06:13] [config] bert-class-symbol: "[CLS]"
[2023-07-14 11:06:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 11:06:13] [config] bert-masking-fraction: 0.15
[2023-07-14 11:06:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 11:06:13] [config] bert-train-type-embeddings: true
[2023-07-14 11:06:13] [config] bert-type-vocab-size: 2
[2023-07-14 11:06:13] [config] build-info: ""
[2023-07-14 11:06:13] [config] check-gradient-nan: false
[2023-07-14 11:06:13] [config] check-nan: false
[2023-07-14 11:06:13] [config] cite: false
[2023-07-14 11:06:13] [config] clip-norm: 1
[2023-07-14 11:06:13] [config] cost-scaling:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] cost-type: ce-sum
[2023-07-14 11:06:13] [config] cpu-threads: 0
[2023-07-14 11:06:13] [config] data-threads: 8
[2023-07-14 11:06:13] [config] data-weighting: ""
[2023-07-14 11:06:13] [config] data-weighting-type: sentence
[2023-07-14 11:06:13] [config] dec-cell: gru
[2023-07-14 11:06:13] [config] dec-cell-base-depth: 2
[2023-07-14 11:06:13] [config] dec-cell-high-depth: 1
[2023-07-14 11:06:13] [config] dec-depth: 1
[2023-07-14 11:06:13] [config] devices:
[2023-07-14 11:06:13] [config]   - 0
[2023-07-14 11:06:13] [config] dim-emb: 512
[2023-07-14 11:06:13] [config] dim-rnn: 1024
[2023-07-14 11:06:13] [config] dim-vocabs:
[2023-07-14 11:06:13] [config]   - 16384
[2023-07-14 11:06:13] [config]   - 16384
[2023-07-14 11:06:13] [config] disp-first: 0
[2023-07-14 11:06:13] [config] disp-freq: 1000u
[2023-07-14 11:06:13] [config] disp-label-counts: true
[2023-07-14 11:06:13] [config] dropout-rnn: 0.2
[2023-07-14 11:06:13] [config] dropout-src: 0.1
[2023-07-14 11:06:13] [config] dropout-trg: 0.1
[2023-07-14 11:06:13] [config] dump-config: ""
[2023-07-14 11:06:13] [config] dynamic-gradient-scaling:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] early-stopping: 10
[2023-07-14 11:06:13] [config] early-stopping-on: first
[2023-07-14 11:06:13] [config] embedding-fix-src: false
[2023-07-14 11:06:13] [config] embedding-fix-trg: false
[2023-07-14 11:06:13] [config] embedding-normalization: false
[2023-07-14 11:06:13] [config] embedding-vectors:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] enc-cell: gru
[2023-07-14 11:06:13] [config] enc-cell-depth: 1
[2023-07-14 11:06:13] [config] enc-depth: 1
[2023-07-14 11:06:13] [config] enc-type: bidirectional
[2023-07-14 11:06:13] [config] english-title-case-every: 0
[2023-07-14 11:06:13] [config] exponential-smoothing: 0
[2023-07-14 11:06:13] [config] factor-weight: 1
[2023-07-14 11:06:13] [config] factors-combine: sum
[2023-07-14 11:06:13] [config] factors-dim-emb: 0
[2023-07-14 11:06:13] [config] gradient-checkpointing: false
[2023-07-14 11:06:13] [config] gradient-norm-average-window: 100
[2023-07-14 11:06:13] [config] guided-alignment: none
[2023-07-14 11:06:13] [config] guided-alignment-cost: mse
[2023-07-14 11:06:13] [config] guided-alignment-weight: 0.1
[2023-07-14 11:06:13] [config] ignore-model-config: false
[2023-07-14 11:06:13] [config] input-types:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] interpolate-env-vars: false
[2023-07-14 11:06:13] [config] keep-best: false
[2023-07-14 11:06:13] [config] label-smoothing: 0
[2023-07-14 11:06:13] [config] layer-normalization: true
[2023-07-14 11:06:13] [config] learn-rate: 0.0001
[2023-07-14 11:06:13] [config] lemma-dependency: ""
[2023-07-14 11:06:13] [config] lemma-dim-emb: 0
[2023-07-14 11:06:13] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:06:13] [config] log-level: info
[2023-07-14 11:06:13] [config] log-time-zone: ""
[2023-07-14 11:06:13] [config] logical-epoch:
[2023-07-14 11:06:13] [config]   - 1e
[2023-07-14 11:06:13] [config]   - 0
[2023-07-14 11:06:13] [config] lr-decay: 0
[2023-07-14 11:06:13] [config] lr-decay-freq: 50000
[2023-07-14 11:06:13] [config] lr-decay-inv-sqrt:
[2023-07-14 11:06:13] [config]   - 0
[2023-07-14 11:06:13] [config] lr-decay-repeat-warmup: false
[2023-07-14 11:06:13] [config] lr-decay-reset-optimizer: false
[2023-07-14 11:06:13] [config] lr-decay-start:
[2023-07-14 11:06:13] [config]   - 10
[2023-07-14 11:06:13] [config]   - 1
[2023-07-14 11:06:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 11:06:13] [config] lr-report: false
[2023-07-14 11:06:13] [config] lr-warmup: 0
[2023-07-14 11:06:13] [config] lr-warmup-at-reload: false
[2023-07-14 11:06:13] [config] lr-warmup-cycle: false
[2023-07-14 11:06:13] [config] lr-warmup-start-rate: 0
[2023-07-14 11:06:13] [config] max-length: 200
[2023-07-14 11:06:13] [config] max-length-crop: false
[2023-07-14 11:06:13] [config] max-length-factor: 3
[2023-07-14 11:06:13] [config] maxi-batch: 100
[2023-07-14 11:06:13] [config] maxi-batch-sort: trg
[2023-07-14 11:06:13] [config] mini-batch: 64
[2023-07-14 11:06:13] [config] mini-batch-fit: true
[2023-07-14 11:06:13] [config] mini-batch-fit-step: 10
[2023-07-14 11:06:13] [config] mini-batch-round-up: true
[2023-07-14 11:06:13] [config] mini-batch-track-lr: false
[2023-07-14 11:06:13] [config] mini-batch-warmup: 0
[2023-07-14 11:06:13] [config] mini-batch-words: 0
[2023-07-14 11:06:13] [config] mini-batch-words-ref: 0
[2023-07-14 11:06:13] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:06:13] [config] multi-loss-type: sum
[2023-07-14 11:06:13] [config] n-best: false
[2023-07-14 11:06:13] [config] no-nccl: false
[2023-07-14 11:06:13] [config] no-reload: false
[2023-07-14 11:06:13] [config] no-restore-corpus: false
[2023-07-14 11:06:13] [config] normalize: 0.6
[2023-07-14 11:06:13] [config] normalize-gradient: false
[2023-07-14 11:06:13] [config] num-devices: 0
[2023-07-14 11:06:13] [config] optimizer: adam
[2023-07-14 11:06:13] [config] optimizer-delay: 1
[2023-07-14 11:06:13] [config] optimizer-params:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] output-omit-bias: false
[2023-07-14 11:06:13] [config] overwrite: false
[2023-07-14 11:06:13] [config] precision:
[2023-07-14 11:06:13] [config]   - float32
[2023-07-14 11:06:13] [config]   - float32
[2023-07-14 11:06:13] [config] pretrained-model: ""
[2023-07-14 11:06:13] [config] quantize-biases: false
[2023-07-14 11:06:13] [config] quantize-bits: 0
[2023-07-14 11:06:13] [config] quantize-log-based: false
[2023-07-14 11:06:13] [config] quantize-optimization-steps: 0
[2023-07-14 11:06:13] [config] quiet: false
[2023-07-14 11:06:13] [config] quiet-translation: true
[2023-07-14 11:06:13] [config] relative-paths: false
[2023-07-14 11:06:13] [config] right-left: false
[2023-07-14 11:06:13] [config] save-freq: 10000u
[2023-07-14 11:06:13] [config] seed: 1234
[2023-07-14 11:06:13] [config] sentencepiece-alphas:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] sentencepiece-max-lines: 2000000
[2023-07-14 11:06:13] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 11:06:13] [config] sharding: global
[2023-07-14 11:06:13] [config] shuffle: data
[2023-07-14 11:06:13] [config] shuffle-in-ram: false
[2023-07-14 11:06:13] [config] sigterm: save-and-exit
[2023-07-14 11:06:13] [config] skip: false
[2023-07-14 11:06:13] [config] sqlite: ""
[2023-07-14 11:06:13] [config] sqlite-drop: false
[2023-07-14 11:06:13] [config] sync-freq: 200u
[2023-07-14 11:06:13] [config] sync-sgd: false
[2023-07-14 11:06:13] [config] tempdir: /tmp
[2023-07-14 11:06:13] [config] tied-embeddings: false
[2023-07-14 11:06:13] [config] tied-embeddings-all: true
[2023-07-14 11:06:13] [config] tied-embeddings-src: false
[2023-07-14 11:06:13] [config] train-embedder-rank:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] train-sets:
[2023-07-14 11:06:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 11:06:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 11:06:13] [config] transformer-aan-activation: swish
[2023-07-14 11:06:13] [config] transformer-aan-depth: 2
[2023-07-14 11:06:13] [config] transformer-aan-nogate: false
[2023-07-14 11:06:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 11:06:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 11:06:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 11:06:13] [config] transformer-depth-scaling: false
[2023-07-14 11:06:13] [config] transformer-dim-aan: 2048
[2023-07-14 11:06:13] [config] transformer-dim-ffn: 2048
[2023-07-14 11:06:13] [config] transformer-dropout: 0
[2023-07-14 11:06:13] [config] transformer-dropout-attention: 0
[2023-07-14 11:06:13] [config] transformer-dropout-ffn: 0
[2023-07-14 11:06:13] [config] transformer-ffn-activation: swish
[2023-07-14 11:06:13] [config] transformer-ffn-depth: 2
[2023-07-14 11:06:13] [config] transformer-guided-alignment-layer: last
[2023-07-14 11:06:13] [config] transformer-heads: 8
[2023-07-14 11:06:13] [config] transformer-no-projection: false
[2023-07-14 11:06:13] [config] transformer-pool: false
[2023-07-14 11:06:13] [config] transformer-postprocess: dan
[2023-07-14 11:06:13] [config] transformer-postprocess-emb: d
[2023-07-14 11:06:13] [config] transformer-postprocess-top: ""
[2023-07-14 11:06:13] [config] transformer-preprocess: ""
[2023-07-14 11:06:13] [config] transformer-tied-layers:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] transformer-train-position-embeddings: false
[2023-07-14 11:06:13] [config] tsv: false
[2023-07-14 11:06:13] [config] tsv-fields: 0
[2023-07-14 11:06:13] [config] type: amun
[2023-07-14 11:06:13] [config] ulr: false
[2023-07-14 11:06:13] [config] ulr-dim-emb: 0
[2023-07-14 11:06:13] [config] ulr-dropout: 0
[2023-07-14 11:06:13] [config] ulr-keys-vectors: ""
[2023-07-14 11:06:13] [config] ulr-query-vectors: ""
[2023-07-14 11:06:13] [config] ulr-softmax-temperature: 1
[2023-07-14 11:06:13] [config] ulr-trainable-transformation: false
[2023-07-14 11:06:13] [config] unlikelihood-loss: false
[2023-07-14 11:06:13] [config] valid-freq: 5000000
[2023-07-14 11:06:13] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:06:13] [config] valid-max-length: 1000
[2023-07-14 11:06:13] [config] valid-metrics:
[2023-07-14 11:06:13] [config]   - cross-entropy
[2023-07-14 11:06:13] [config]   - translation
[2023-07-14 11:06:13] [config] valid-mini-batch: 32
[2023-07-14 11:06:13] [config] valid-reset-stalled: false
[2023-07-14 11:06:13] [config] valid-script-args:
[2023-07-14 11:06:13] [config]   []
[2023-07-14 11:06:13] [config] valid-script-path: ""
[2023-07-14 11:06:13] [config] valid-sets:
[2023-07-14 11:06:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 11:06:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 11:06:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 11:06:13] [config] vocabs:
[2023-07-14 11:06:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:06:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:06:13] [config] word-penalty: 0
[2023-07-14 11:06:13] [config] word-scores: false
[2023-07-14 11:06:13] [config] workspace: 3000
[2023-07-14 11:06:13] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:06:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:06:13] [training] Using single-device training
[2023-07-14 11:06:17] Synced seed 1234
[2023-07-14 11:06:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:06:17] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 11:06:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:06:17] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 11:06:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 11:06:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:06:18] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:06:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:06:19] [comm] Using global sharding
[2023-07-14 11:06:19] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:06:19] [training] Using 1 GPUs
[2023-07-14 11:06:19] [logits] Applying loss function for 1 factor(s)
[2023-07-14 11:06:19] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:06:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 11:06:23] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:07:36] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 11:07:36] [valid] No post-processing script given for validating translator
[2023-07-14 11:07:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:07:36] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:07:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:07:36] [comm] Using global sharding
[2023-07-14 11:07:36] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:07:36] [training] Using 1 GPUs
[2023-07-14 11:07:36] Training started
[2023-07-14 11:07:36] [data] Shuffling data
[2023-07-14 11:07:36] [data] Done reading 20,192 sentences
[2023-07-14 11:07:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:07:36] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 11:07:36] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:07:36] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:07:37] Parameter type float32, optimization type float32, casting types false
[2023-07-14 11:07:37] Allocating memory for Adam-specific shards
[2023-07-14 11:07:37] [memory] Reserving 322 MB, device gpu0
[2023-07-14 11:08:46] Seen 20,188 samples
[2023-07-14 11:08:46] Starting data epoch 2 in logical epoch 2
[2023-07-14 11:08:46] [data] Shuffling data
[2023-07-14 11:08:46] [data] Done reading 20,192 sentences
[2023-07-14 11:08:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:10:02] Seen 20,188 samples
[2023-07-14 11:10:02] Starting data epoch 3 in logical epoch 3
[2023-07-14 11:10:02] [data] Shuffling data
[2023-07-14 11:10:02] [data] Done reading 20,192 sentences
[2023-07-14 11:10:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:11:25] Seen 20,188 samples
[2023-07-14 11:11:25] Starting data epoch 4 in logical epoch 4
[2023-07-14 11:11:25] [data] Shuffling data
[2023-07-14 11:11:25] [data] Done reading 20,192 sentences
[2023-07-14 11:11:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:12:47] Seen 20,188 samples
[2023-07-14 11:12:47] Starting data epoch 5 in logical epoch 5
[2023-07-14 11:12:47] [data] Shuffling data
[2023-07-14 11:12:47] [data] Done reading 20,192 sentences
[2023-07-14 11:12:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:14:12] Seen 20,188 samples
[2023-07-14 11:14:12] Starting data epoch 6 in logical epoch 6
[2023-07-14 11:14:12] [data] Shuffling data
[2023-07-14 11:14:12] [data] Done reading 20,192 sentences
[2023-07-14 11:14:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:15:37] Seen 20,188 samples
[2023-07-14 11:15:37] Starting data epoch 7 in logical epoch 7
[2023-07-14 11:15:37] [data] Shuffling data
[2023-07-14 11:15:37] [data] Done reading 20,192 sentences
[2023-07-14 11:15:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:15:42] Ep. 7 : Up. 1000 : Sen. 1,030 : Cost 5.70623875 * 3,752,269 @ 4,462 after 3,752,269 : Time 486.04s : 7720.09 words/s : gNorm 0.9680
[2023-07-14 11:17:00] Seen 20,188 samples
[2023-07-14 11:17:00] Starting data epoch 8 in logical epoch 8
[2023-07-14 11:17:00] [data] Shuffling data
[2023-07-14 11:17:00] [data] Done reading 20,192 sentences
[2023-07-14 11:17:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:18:26] Seen 20,188 samples
[2023-07-14 11:18:26] Starting data epoch 9 in logical epoch 9
[2023-07-14 11:18:26] [data] Shuffling data
[2023-07-14 11:18:26] [data] Done reading 20,192 sentences
[2023-07-14 11:18:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:19:50] Seen 20,188 samples
[2023-07-14 11:19:50] Starting data epoch 10 in logical epoch 10
[2023-07-14 11:19:50] [data] Shuffling data
[2023-07-14 11:19:50] [data] Done reading 20,192 sentences
[2023-07-14 11:19:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:21:14] Seen 20,188 samples
[2023-07-14 11:21:14] Starting data epoch 11 in logical epoch 11
[2023-07-14 11:21:14] Training finished
[2023-07-14 11:21:23] [valid] Ep. 11 : Up. 1654 : cross-entropy : 135.938 : new best
[2023-07-14 11:22:49] [valid] Ep. 11 : Up. 1654 : translation : 0 : new best
[2023-07-14 11:22:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:22:51] Saving Adam parameters
[2023-07-14 11:22:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 11:23:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:23:00] [marian] Running on node21.datos.cluster.uy as process 17839 with command line:
[2023-07-14 11:23:00] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 11:23:00] [config] after: 0e
[2023-07-14 11:23:00] [config] after-batches: 0
[2023-07-14 11:23:00] [config] after-epochs: 20
[2023-07-14 11:23:00] [config] all-caps-every: 0
[2023-07-14 11:23:00] [config] allow-unk: false
[2023-07-14 11:23:00] [config] authors: false
[2023-07-14 11:23:00] [config] beam-size: 6
[2023-07-14 11:23:00] [config] bert-class-symbol: "[CLS]"
[2023-07-14 11:23:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 11:23:00] [config] bert-masking-fraction: 0.15
[2023-07-14 11:23:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 11:23:00] [config] bert-train-type-embeddings: true
[2023-07-14 11:23:00] [config] bert-type-vocab-size: 2
[2023-07-14 11:23:00] [config] build-info: ""
[2023-07-14 11:23:00] [config] check-gradient-nan: false
[2023-07-14 11:23:00] [config] check-nan: false
[2023-07-14 11:23:00] [config] cite: false
[2023-07-14 11:23:00] [config] clip-norm: 1
[2023-07-14 11:23:00] [config] cost-scaling:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] cost-type: ce-sum
[2023-07-14 11:23:00] [config] cpu-threads: 0
[2023-07-14 11:23:00] [config] data-threads: 8
[2023-07-14 11:23:00] [config] data-weighting: ""
[2023-07-14 11:23:00] [config] data-weighting-type: sentence
[2023-07-14 11:23:00] [config] dec-cell: gru
[2023-07-14 11:23:00] [config] dec-cell-base-depth: 2
[2023-07-14 11:23:00] [config] dec-cell-high-depth: 1
[2023-07-14 11:23:00] [config] dec-depth: 1
[2023-07-14 11:23:00] [config] devices:
[2023-07-14 11:23:00] [config]   - 0
[2023-07-14 11:23:00] [config] dim-emb: 512
[2023-07-14 11:23:00] [config] dim-rnn: 1024
[2023-07-14 11:23:00] [config] dim-vocabs:
[2023-07-14 11:23:00] [config]   - 16384
[2023-07-14 11:23:00] [config]   - 16384
[2023-07-14 11:23:00] [config] disp-first: 0
[2023-07-14 11:23:00] [config] disp-freq: 1000u
[2023-07-14 11:23:00] [config] disp-label-counts: true
[2023-07-14 11:23:00] [config] dropout-rnn: 0.2
[2023-07-14 11:23:00] [config] dropout-src: 0.1
[2023-07-14 11:23:00] [config] dropout-trg: 0.1
[2023-07-14 11:23:00] [config] dump-config: ""
[2023-07-14 11:23:00] [config] dynamic-gradient-scaling:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] early-stopping: 10
[2023-07-14 11:23:00] [config] early-stopping-on: first
[2023-07-14 11:23:00] [config] embedding-fix-src: false
[2023-07-14 11:23:00] [config] embedding-fix-trg: false
[2023-07-14 11:23:00] [config] embedding-normalization: false
[2023-07-14 11:23:00] [config] embedding-vectors:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] enc-cell: gru
[2023-07-14 11:23:00] [config] enc-cell-depth: 1
[2023-07-14 11:23:00] [config] enc-depth: 1
[2023-07-14 11:23:00] [config] enc-type: bidirectional
[2023-07-14 11:23:00] [config] english-title-case-every: 0
[2023-07-14 11:23:00] [config] exponential-smoothing: 0
[2023-07-14 11:23:00] [config] factor-weight: 1
[2023-07-14 11:23:00] [config] factors-combine: sum
[2023-07-14 11:23:00] [config] factors-dim-emb: 0
[2023-07-14 11:23:00] [config] gradient-checkpointing: false
[2023-07-14 11:23:00] [config] gradient-norm-average-window: 100
[2023-07-14 11:23:00] [config] guided-alignment: none
[2023-07-14 11:23:00] [config] guided-alignment-cost: mse
[2023-07-14 11:23:00] [config] guided-alignment-weight: 0.1
[2023-07-14 11:23:00] [config] ignore-model-config: false
[2023-07-14 11:23:00] [config] input-types:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] interpolate-env-vars: false
[2023-07-14 11:23:00] [config] keep-best: false
[2023-07-14 11:23:00] [config] label-smoothing: 0
[2023-07-14 11:23:00] [config] layer-normalization: true
[2023-07-14 11:23:00] [config] learn-rate: 0.0001
[2023-07-14 11:23:00] [config] lemma-dependency: ""
[2023-07-14 11:23:00] [config] lemma-dim-emb: 0
[2023-07-14 11:23:00] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:23:00] [config] log-level: info
[2023-07-14 11:23:00] [config] log-time-zone: ""
[2023-07-14 11:23:00] [config] logical-epoch:
[2023-07-14 11:23:00] [config]   - 1e
[2023-07-14 11:23:00] [config]   - 0
[2023-07-14 11:23:00] [config] lr-decay: 0
[2023-07-14 11:23:00] [config] lr-decay-freq: 50000
[2023-07-14 11:23:00] [config] lr-decay-inv-sqrt:
[2023-07-14 11:23:00] [config]   - 0
[2023-07-14 11:23:00] [config] lr-decay-repeat-warmup: false
[2023-07-14 11:23:00] [config] lr-decay-reset-optimizer: false
[2023-07-14 11:23:00] [config] lr-decay-start:
[2023-07-14 11:23:00] [config]   - 10
[2023-07-14 11:23:00] [config]   - 1
[2023-07-14 11:23:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 11:23:00] [config] lr-report: false
[2023-07-14 11:23:00] [config] lr-warmup: 0
[2023-07-14 11:23:00] [config] lr-warmup-at-reload: false
[2023-07-14 11:23:00] [config] lr-warmup-cycle: false
[2023-07-14 11:23:00] [config] lr-warmup-start-rate: 0
[2023-07-14 11:23:00] [config] max-length: 200
[2023-07-14 11:23:00] [config] max-length-crop: false
[2023-07-14 11:23:00] [config] max-length-factor: 3
[2023-07-14 11:23:00] [config] maxi-batch: 100
[2023-07-14 11:23:00] [config] maxi-batch-sort: trg
[2023-07-14 11:23:00] [config] mini-batch: 64
[2023-07-14 11:23:00] [config] mini-batch-fit: true
[2023-07-14 11:23:00] [config] mini-batch-fit-step: 10
[2023-07-14 11:23:00] [config] mini-batch-round-up: true
[2023-07-14 11:23:00] [config] mini-batch-track-lr: false
[2023-07-14 11:23:00] [config] mini-batch-warmup: 0
[2023-07-14 11:23:00] [config] mini-batch-words: 0
[2023-07-14 11:23:00] [config] mini-batch-words-ref: 0
[2023-07-14 11:23:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:23:00] [config] multi-loss-type: sum
[2023-07-14 11:23:00] [config] n-best: false
[2023-07-14 11:23:00] [config] no-nccl: false
[2023-07-14 11:23:00] [config] no-reload: false
[2023-07-14 11:23:00] [config] no-restore-corpus: false
[2023-07-14 11:23:00] [config] normalize: 0.6
[2023-07-14 11:23:00] [config] normalize-gradient: false
[2023-07-14 11:23:00] [config] num-devices: 0
[2023-07-14 11:23:00] [config] optimizer: adam
[2023-07-14 11:23:00] [config] optimizer-delay: 1
[2023-07-14 11:23:00] [config] optimizer-params:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] output-omit-bias: false
[2023-07-14 11:23:00] [config] overwrite: false
[2023-07-14 11:23:00] [config] precision:
[2023-07-14 11:23:00] [config]   - float32
[2023-07-14 11:23:00] [config]   - float32
[2023-07-14 11:23:00] [config] pretrained-model: ""
[2023-07-14 11:23:00] [config] quantize-biases: false
[2023-07-14 11:23:00] [config] quantize-bits: 0
[2023-07-14 11:23:00] [config] quantize-log-based: false
[2023-07-14 11:23:00] [config] quantize-optimization-steps: 0
[2023-07-14 11:23:00] [config] quiet: false
[2023-07-14 11:23:00] [config] quiet-translation: true
[2023-07-14 11:23:00] [config] relative-paths: false
[2023-07-14 11:23:00] [config] right-left: false
[2023-07-14 11:23:00] [config] save-freq: 10000u
[2023-07-14 11:23:00] [config] seed: 1234
[2023-07-14 11:23:00] [config] sentencepiece-alphas:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] sentencepiece-max-lines: 2000000
[2023-07-14 11:23:00] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 11:23:00] [config] sharding: global
[2023-07-14 11:23:00] [config] shuffle: data
[2023-07-14 11:23:00] [config] shuffle-in-ram: false
[2023-07-14 11:23:00] [config] sigterm: save-and-exit
[2023-07-14 11:23:00] [config] skip: false
[2023-07-14 11:23:00] [config] sqlite: ""
[2023-07-14 11:23:00] [config] sqlite-drop: false
[2023-07-14 11:23:00] [config] sync-freq: 200u
[2023-07-14 11:23:00] [config] sync-sgd: false
[2023-07-14 11:23:00] [config] tempdir: /tmp
[2023-07-14 11:23:00] [config] tied-embeddings: false
[2023-07-14 11:23:00] [config] tied-embeddings-all: true
[2023-07-14 11:23:00] [config] tied-embeddings-src: false
[2023-07-14 11:23:00] [config] train-embedder-rank:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] train-sets:
[2023-07-14 11:23:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 11:23:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 11:23:00] [config] transformer-aan-activation: swish
[2023-07-14 11:23:00] [config] transformer-aan-depth: 2
[2023-07-14 11:23:00] [config] transformer-aan-nogate: false
[2023-07-14 11:23:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 11:23:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 11:23:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 11:23:00] [config] transformer-depth-scaling: false
[2023-07-14 11:23:00] [config] transformer-dim-aan: 2048
[2023-07-14 11:23:00] [config] transformer-dim-ffn: 2048
[2023-07-14 11:23:00] [config] transformer-dropout: 0
[2023-07-14 11:23:00] [config] transformer-dropout-attention: 0
[2023-07-14 11:23:00] [config] transformer-dropout-ffn: 0
[2023-07-14 11:23:00] [config] transformer-ffn-activation: swish
[2023-07-14 11:23:00] [config] transformer-ffn-depth: 2
[2023-07-14 11:23:00] [config] transformer-guided-alignment-layer: last
[2023-07-14 11:23:00] [config] transformer-heads: 8
[2023-07-14 11:23:00] [config] transformer-no-projection: false
[2023-07-14 11:23:00] [config] transformer-pool: false
[2023-07-14 11:23:00] [config] transformer-postprocess: dan
[2023-07-14 11:23:00] [config] transformer-postprocess-emb: d
[2023-07-14 11:23:00] [config] transformer-postprocess-top: ""
[2023-07-14 11:23:00] [config] transformer-preprocess: ""
[2023-07-14 11:23:00] [config] transformer-tied-layers:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] transformer-train-position-embeddings: false
[2023-07-14 11:23:00] [config] tsv: false
[2023-07-14 11:23:00] [config] tsv-fields: 0
[2023-07-14 11:23:00] [config] type: amun
[2023-07-14 11:23:00] [config] ulr: false
[2023-07-14 11:23:00] [config] ulr-dim-emb: 0
[2023-07-14 11:23:00] [config] ulr-dropout: 0
[2023-07-14 11:23:00] [config] ulr-keys-vectors: ""
[2023-07-14 11:23:00] [config] ulr-query-vectors: ""
[2023-07-14 11:23:00] [config] ulr-softmax-temperature: 1
[2023-07-14 11:23:00] [config] ulr-trainable-transformation: false
[2023-07-14 11:23:00] [config] unlikelihood-loss: false
[2023-07-14 11:23:00] [config] valid-freq: 5000000
[2023-07-14 11:23:00] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:23:00] [config] valid-max-length: 1000
[2023-07-14 11:23:00] [config] valid-metrics:
[2023-07-14 11:23:00] [config]   - cross-entropy
[2023-07-14 11:23:00] [config]   - translation
[2023-07-14 11:23:00] [config] valid-mini-batch: 32
[2023-07-14 11:23:00] [config] valid-reset-stalled: false
[2023-07-14 11:23:00] [config] valid-script-args:
[2023-07-14 11:23:00] [config]   []
[2023-07-14 11:23:00] [config] valid-script-path: ""
[2023-07-14 11:23:00] [config] valid-sets:
[2023-07-14 11:23:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 11:23:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 11:23:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 11:23:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:23:00] [config] vocabs:
[2023-07-14 11:23:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:23:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:23:00] [config] word-penalty: 0
[2023-07-14 11:23:00] [config] word-scores: false
[2023-07-14 11:23:00] [config] workspace: 3000
[2023-07-14 11:23:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:23:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:23:00] [training] Using single-device training
[2023-07-14 11:23:01] Synced seed 1234
[2023-07-14 11:23:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:23:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 11:23:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:23:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 11:23:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 11:23:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:23:02] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:23:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:23:02] [comm] Using global sharding
[2023-07-14 11:23:02] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:23:02] [training] Using 1 GPUs
[2023-07-14 11:23:02] [logits] Applying loss function for 1 factor(s)
[2023-07-14 11:23:02] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:23:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 11:23:02] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:24:26] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 11:24:26] [valid] No post-processing script given for validating translator
[2023-07-14 11:24:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:24:26] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:24:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:24:26] [comm] Using global sharding
[2023-07-14 11:24:26] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:24:26] [training] Using 1 GPUs
[2023-07-14 11:24:26] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:24:27] Loading Adam parameters
[2023-07-14 11:24:27] [memory] Reserving 322 MB, device gpu0
[2023-07-14 11:24:27] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:24:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 11:24:28] [data] Restoring the corpus state to epoch 11, batch 1654
[2023-07-14 11:24:28] [data] Shuffling data
[2023-07-14 11:24:28] [data] Done reading 20,192 sentences
[2023-07-14 11:24:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:24:28] Training started
[2023-07-14 11:24:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 11:24:28] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:24:28] Parameter type float32, optimization type float32, casting types false
[2023-07-14 11:25:52] Seen 20,188 samples
[2023-07-14 11:25:52] Starting data epoch 12 in logical epoch 12
[2023-07-14 11:25:52] [data] Shuffling data
[2023-07-14 11:25:52] [data] Done reading 20,192 sentences
[2023-07-14 11:25:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:27:17] Seen 20,188 samples
[2023-07-14 11:27:17] Starting data epoch 13 in logical epoch 13
[2023-07-14 11:27:17] [data] Shuffling data
[2023-07-14 11:27:17] [data] Done reading 20,192 sentences
[2023-07-14 11:27:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:27:26] Ep. 13 : Up. 2000 : Sen. 2,029 : Cost 4.53471470 * 3,743,668 @ 2,505 after 7,495,937 : Time 180.26s : 20768.22 words/s : gNorm 1.2662
[2023-07-14 11:28:42] Seen 20,188 samples
[2023-07-14 11:28:42] Starting data epoch 14 in logical epoch 14
[2023-07-14 11:28:42] [data] Shuffling data
[2023-07-14 11:28:42] [data] Done reading 20,192 sentences
[2023-07-14 11:28:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:30:08] Seen 20,188 samples
[2023-07-14 11:30:08] Starting data epoch 15 in logical epoch 15
[2023-07-14 11:30:08] [data] Shuffling data
[2023-07-14 11:30:08] [data] Done reading 20,192 sentences
[2023-07-14 11:30:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:31:33] Seen 20,188 samples
[2023-07-14 11:31:33] Starting data epoch 16 in logical epoch 16
[2023-07-14 11:31:33] [data] Shuffling data
[2023-07-14 11:31:33] [data] Done reading 20,192 sentences
[2023-07-14 11:31:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:32:57] Seen 20,188 samples
[2023-07-14 11:32:57] Starting data epoch 17 in logical epoch 17
[2023-07-14 11:32:57] [data] Shuffling data
[2023-07-14 11:32:57] [data] Done reading 20,192 sentences
[2023-07-14 11:32:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:34:21] Seen 20,188 samples
[2023-07-14 11:34:21] Starting data epoch 18 in logical epoch 18
[2023-07-14 11:34:21] [data] Shuffling data
[2023-07-14 11:34:21] [data] Done reading 20,192 sentences
[2023-07-14 11:34:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:35:47] Seen 20,188 samples
[2023-07-14 11:35:47] Starting data epoch 19 in logical epoch 19
[2023-07-14 11:35:47] [data] Shuffling data
[2023-07-14 11:35:47] [data] Done reading 20,192 sentences
[2023-07-14 11:35:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:36:00] Ep. 19 : Up. 3000 : Sen. 3,606 : Cost 3.87598872 * 3,754,652 @ 2,669 after 11,250,589 : Time 513.51s : 7311.68 words/s : gNorm 1.2991
[2023-07-14 11:37:12] Seen 20,188 samples
[2023-07-14 11:37:12] Starting data epoch 20 in logical epoch 20
[2023-07-14 11:37:12] [data] Shuffling data
[2023-07-14 11:37:12] [data] Done reading 20,192 sentences
[2023-07-14 11:37:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:38:36] Seen 20,188 samples
[2023-07-14 11:38:36] Starting data epoch 21 in logical epoch 21
[2023-07-14 11:38:36] Training finished
[2023-07-14 11:38:45] [valid] Ep. 21 : Up. 3302 : cross-entropy : 116.793 : new best
[2023-07-14 11:39:40] [valid] Ep. 21 : Up. 3302 : translation : 0 : new best
[2023-07-14 11:39:40] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:39:42] Saving Adam parameters
[2023-07-14 11:39:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 11:39:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:39:49] [marian] Running on node21.datos.cluster.uy as process 19103 with command line:
[2023-07-14 11:39:49] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 11:39:49] [config] after: 0e
[2023-07-14 11:39:49] [config] after-batches: 0
[2023-07-14 11:39:49] [config] after-epochs: 30
[2023-07-14 11:39:49] [config] all-caps-every: 0
[2023-07-14 11:39:49] [config] allow-unk: false
[2023-07-14 11:39:49] [config] authors: false
[2023-07-14 11:39:49] [config] beam-size: 6
[2023-07-14 11:39:49] [config] bert-class-symbol: "[CLS]"
[2023-07-14 11:39:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 11:39:49] [config] bert-masking-fraction: 0.15
[2023-07-14 11:39:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 11:39:49] [config] bert-train-type-embeddings: true
[2023-07-14 11:39:49] [config] bert-type-vocab-size: 2
[2023-07-14 11:39:49] [config] build-info: ""
[2023-07-14 11:39:49] [config] check-gradient-nan: false
[2023-07-14 11:39:49] [config] check-nan: false
[2023-07-14 11:39:49] [config] cite: false
[2023-07-14 11:39:49] [config] clip-norm: 1
[2023-07-14 11:39:49] [config] cost-scaling:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] cost-type: ce-sum
[2023-07-14 11:39:49] [config] cpu-threads: 0
[2023-07-14 11:39:49] [config] data-threads: 8
[2023-07-14 11:39:49] [config] data-weighting: ""
[2023-07-14 11:39:49] [config] data-weighting-type: sentence
[2023-07-14 11:39:49] [config] dec-cell: gru
[2023-07-14 11:39:49] [config] dec-cell-base-depth: 2
[2023-07-14 11:39:49] [config] dec-cell-high-depth: 1
[2023-07-14 11:39:49] [config] dec-depth: 1
[2023-07-14 11:39:49] [config] devices:
[2023-07-14 11:39:49] [config]   - 0
[2023-07-14 11:39:49] [config] dim-emb: 512
[2023-07-14 11:39:49] [config] dim-rnn: 1024
[2023-07-14 11:39:49] [config] dim-vocabs:
[2023-07-14 11:39:49] [config]   - 16384
[2023-07-14 11:39:49] [config]   - 16384
[2023-07-14 11:39:49] [config] disp-first: 0
[2023-07-14 11:39:49] [config] disp-freq: 1000u
[2023-07-14 11:39:49] [config] disp-label-counts: true
[2023-07-14 11:39:49] [config] dropout-rnn: 0.2
[2023-07-14 11:39:49] [config] dropout-src: 0.1
[2023-07-14 11:39:49] [config] dropout-trg: 0.1
[2023-07-14 11:39:49] [config] dump-config: ""
[2023-07-14 11:39:49] [config] dynamic-gradient-scaling:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] early-stopping: 10
[2023-07-14 11:39:49] [config] early-stopping-on: first
[2023-07-14 11:39:49] [config] embedding-fix-src: false
[2023-07-14 11:39:49] [config] embedding-fix-trg: false
[2023-07-14 11:39:49] [config] embedding-normalization: false
[2023-07-14 11:39:49] [config] embedding-vectors:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] enc-cell: gru
[2023-07-14 11:39:49] [config] enc-cell-depth: 1
[2023-07-14 11:39:49] [config] enc-depth: 1
[2023-07-14 11:39:49] [config] enc-type: bidirectional
[2023-07-14 11:39:49] [config] english-title-case-every: 0
[2023-07-14 11:39:49] [config] exponential-smoothing: 0
[2023-07-14 11:39:49] [config] factor-weight: 1
[2023-07-14 11:39:49] [config] factors-combine: sum
[2023-07-14 11:39:49] [config] factors-dim-emb: 0
[2023-07-14 11:39:49] [config] gradient-checkpointing: false
[2023-07-14 11:39:49] [config] gradient-norm-average-window: 100
[2023-07-14 11:39:49] [config] guided-alignment: none
[2023-07-14 11:39:49] [config] guided-alignment-cost: mse
[2023-07-14 11:39:49] [config] guided-alignment-weight: 0.1
[2023-07-14 11:39:49] [config] ignore-model-config: false
[2023-07-14 11:39:49] [config] input-types:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] interpolate-env-vars: false
[2023-07-14 11:39:49] [config] keep-best: false
[2023-07-14 11:39:49] [config] label-smoothing: 0
[2023-07-14 11:39:49] [config] layer-normalization: true
[2023-07-14 11:39:49] [config] learn-rate: 0.0001
[2023-07-14 11:39:49] [config] lemma-dependency: ""
[2023-07-14 11:39:49] [config] lemma-dim-emb: 0
[2023-07-14 11:39:49] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:39:49] [config] log-level: info
[2023-07-14 11:39:49] [config] log-time-zone: ""
[2023-07-14 11:39:49] [config] logical-epoch:
[2023-07-14 11:39:49] [config]   - 1e
[2023-07-14 11:39:49] [config]   - 0
[2023-07-14 11:39:49] [config] lr-decay: 0
[2023-07-14 11:39:49] [config] lr-decay-freq: 50000
[2023-07-14 11:39:49] [config] lr-decay-inv-sqrt:
[2023-07-14 11:39:49] [config]   - 0
[2023-07-14 11:39:49] [config] lr-decay-repeat-warmup: false
[2023-07-14 11:39:49] [config] lr-decay-reset-optimizer: false
[2023-07-14 11:39:49] [config] lr-decay-start:
[2023-07-14 11:39:49] [config]   - 10
[2023-07-14 11:39:49] [config]   - 1
[2023-07-14 11:39:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 11:39:49] [config] lr-report: false
[2023-07-14 11:39:49] [config] lr-warmup: 0
[2023-07-14 11:39:49] [config] lr-warmup-at-reload: false
[2023-07-14 11:39:49] [config] lr-warmup-cycle: false
[2023-07-14 11:39:49] [config] lr-warmup-start-rate: 0
[2023-07-14 11:39:49] [config] max-length: 200
[2023-07-14 11:39:49] [config] max-length-crop: false
[2023-07-14 11:39:49] [config] max-length-factor: 3
[2023-07-14 11:39:49] [config] maxi-batch: 100
[2023-07-14 11:39:49] [config] maxi-batch-sort: trg
[2023-07-14 11:39:49] [config] mini-batch: 64
[2023-07-14 11:39:49] [config] mini-batch-fit: true
[2023-07-14 11:39:49] [config] mini-batch-fit-step: 10
[2023-07-14 11:39:49] [config] mini-batch-round-up: true
[2023-07-14 11:39:49] [config] mini-batch-track-lr: false
[2023-07-14 11:39:49] [config] mini-batch-warmup: 0
[2023-07-14 11:39:49] [config] mini-batch-words: 0
[2023-07-14 11:39:49] [config] mini-batch-words-ref: 0
[2023-07-14 11:39:49] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:39:49] [config] multi-loss-type: sum
[2023-07-14 11:39:49] [config] n-best: false
[2023-07-14 11:39:49] [config] no-nccl: false
[2023-07-14 11:39:49] [config] no-reload: false
[2023-07-14 11:39:49] [config] no-restore-corpus: false
[2023-07-14 11:39:49] [config] normalize: 0.6
[2023-07-14 11:39:49] [config] normalize-gradient: false
[2023-07-14 11:39:49] [config] num-devices: 0
[2023-07-14 11:39:49] [config] optimizer: adam
[2023-07-14 11:39:49] [config] optimizer-delay: 1
[2023-07-14 11:39:49] [config] optimizer-params:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] output-omit-bias: false
[2023-07-14 11:39:49] [config] overwrite: false
[2023-07-14 11:39:49] [config] precision:
[2023-07-14 11:39:49] [config]   - float32
[2023-07-14 11:39:49] [config]   - float32
[2023-07-14 11:39:49] [config] pretrained-model: ""
[2023-07-14 11:39:49] [config] quantize-biases: false
[2023-07-14 11:39:49] [config] quantize-bits: 0
[2023-07-14 11:39:49] [config] quantize-log-based: false
[2023-07-14 11:39:49] [config] quantize-optimization-steps: 0
[2023-07-14 11:39:49] [config] quiet: false
[2023-07-14 11:39:49] [config] quiet-translation: true
[2023-07-14 11:39:49] [config] relative-paths: false
[2023-07-14 11:39:49] [config] right-left: false
[2023-07-14 11:39:49] [config] save-freq: 10000u
[2023-07-14 11:39:49] [config] seed: 1234
[2023-07-14 11:39:49] [config] sentencepiece-alphas:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] sentencepiece-max-lines: 2000000
[2023-07-14 11:39:49] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 11:39:49] [config] sharding: global
[2023-07-14 11:39:49] [config] shuffle: data
[2023-07-14 11:39:49] [config] shuffle-in-ram: false
[2023-07-14 11:39:49] [config] sigterm: save-and-exit
[2023-07-14 11:39:49] [config] skip: false
[2023-07-14 11:39:49] [config] sqlite: ""
[2023-07-14 11:39:49] [config] sqlite-drop: false
[2023-07-14 11:39:49] [config] sync-freq: 200u
[2023-07-14 11:39:49] [config] sync-sgd: false
[2023-07-14 11:39:49] [config] tempdir: /tmp
[2023-07-14 11:39:49] [config] tied-embeddings: false
[2023-07-14 11:39:49] [config] tied-embeddings-all: true
[2023-07-14 11:39:49] [config] tied-embeddings-src: false
[2023-07-14 11:39:49] [config] train-embedder-rank:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] train-sets:
[2023-07-14 11:39:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 11:39:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 11:39:49] [config] transformer-aan-activation: swish
[2023-07-14 11:39:49] [config] transformer-aan-depth: 2
[2023-07-14 11:39:49] [config] transformer-aan-nogate: false
[2023-07-14 11:39:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 11:39:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 11:39:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 11:39:49] [config] transformer-depth-scaling: false
[2023-07-14 11:39:49] [config] transformer-dim-aan: 2048
[2023-07-14 11:39:49] [config] transformer-dim-ffn: 2048
[2023-07-14 11:39:49] [config] transformer-dropout: 0
[2023-07-14 11:39:49] [config] transformer-dropout-attention: 0
[2023-07-14 11:39:49] [config] transformer-dropout-ffn: 0
[2023-07-14 11:39:49] [config] transformer-ffn-activation: swish
[2023-07-14 11:39:49] [config] transformer-ffn-depth: 2
[2023-07-14 11:39:49] [config] transformer-guided-alignment-layer: last
[2023-07-14 11:39:49] [config] transformer-heads: 8
[2023-07-14 11:39:49] [config] transformer-no-projection: false
[2023-07-14 11:39:49] [config] transformer-pool: false
[2023-07-14 11:39:49] [config] transformer-postprocess: dan
[2023-07-14 11:39:49] [config] transformer-postprocess-emb: d
[2023-07-14 11:39:49] [config] transformer-postprocess-top: ""
[2023-07-14 11:39:49] [config] transformer-preprocess: ""
[2023-07-14 11:39:49] [config] transformer-tied-layers:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] transformer-train-position-embeddings: false
[2023-07-14 11:39:49] [config] tsv: false
[2023-07-14 11:39:49] [config] tsv-fields: 0
[2023-07-14 11:39:49] [config] type: amun
[2023-07-14 11:39:49] [config] ulr: false
[2023-07-14 11:39:49] [config] ulr-dim-emb: 0
[2023-07-14 11:39:49] [config] ulr-dropout: 0
[2023-07-14 11:39:49] [config] ulr-keys-vectors: ""
[2023-07-14 11:39:49] [config] ulr-query-vectors: ""
[2023-07-14 11:39:49] [config] ulr-softmax-temperature: 1
[2023-07-14 11:39:49] [config] ulr-trainable-transformation: false
[2023-07-14 11:39:49] [config] unlikelihood-loss: false
[2023-07-14 11:39:49] [config] valid-freq: 5000000
[2023-07-14 11:39:49] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:39:49] [config] valid-max-length: 1000
[2023-07-14 11:39:49] [config] valid-metrics:
[2023-07-14 11:39:49] [config]   - cross-entropy
[2023-07-14 11:39:49] [config]   - translation
[2023-07-14 11:39:49] [config] valid-mini-batch: 32
[2023-07-14 11:39:49] [config] valid-reset-stalled: false
[2023-07-14 11:39:49] [config] valid-script-args:
[2023-07-14 11:39:49] [config]   []
[2023-07-14 11:39:49] [config] valid-script-path: ""
[2023-07-14 11:39:49] [config] valid-sets:
[2023-07-14 11:39:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 11:39:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 11:39:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 11:39:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:39:49] [config] vocabs:
[2023-07-14 11:39:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:39:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:39:49] [config] word-penalty: 0
[2023-07-14 11:39:49] [config] word-scores: false
[2023-07-14 11:39:49] [config] workspace: 3000
[2023-07-14 11:39:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:39:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:39:49] [training] Using single-device training
[2023-07-14 11:39:49] Synced seed 1234
[2023-07-14 11:39:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:39:49] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 11:39:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:39:49] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 11:39:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 11:39:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:39:51] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:39:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:39:51] [comm] Using global sharding
[2023-07-14 11:39:51] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:39:51] [training] Using 1 GPUs
[2023-07-14 11:39:51] [logits] Applying loss function for 1 factor(s)
[2023-07-14 11:39:51] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:39:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 11:39:51] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:41:15] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 11:41:15] [valid] No post-processing script given for validating translator
[2023-07-14 11:41:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:41:15] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:41:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:41:15] [comm] Using global sharding
[2023-07-14 11:41:15] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:41:15] [training] Using 1 GPUs
[2023-07-14 11:41:15] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:41:16] Loading Adam parameters
[2023-07-14 11:41:16] [memory] Reserving 322 MB, device gpu0
[2023-07-14 11:41:16] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:41:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 11:41:16] [data] Restoring the corpus state to epoch 21, batch 3302
[2023-07-14 11:41:16] [data] Shuffling data
[2023-07-14 11:41:16] [data] Done reading 20,192 sentences
[2023-07-14 11:41:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:41:16] Training started
[2023-07-14 11:41:16] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 11:41:17] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:41:17] Parameter type float32, optimization type float32, casting types false
[2023-07-14 11:42:41] Seen 20,188 samples
[2023-07-14 11:42:41] Starting data epoch 22 in logical epoch 22
[2023-07-14 11:42:41] [data] Shuffling data
[2023-07-14 11:42:41] [data] Done reading 20,192 sentences
[2023-07-14 11:42:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:44:06] Seen 20,188 samples
[2023-07-14 11:44:06] Starting data epoch 23 in logical epoch 23
[2023-07-14 11:44:06] [data] Shuffling data
[2023-07-14 11:44:06] [data] Done reading 20,192 sentences
[2023-07-14 11:44:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:45:31] Seen 20,188 samples
[2023-07-14 11:45:31] Starting data epoch 24 in logical epoch 24
[2023-07-14 11:45:31] [data] Shuffling data
[2023-07-14 11:45:31] [data] Done reading 20,192 sentences
[2023-07-14 11:45:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:46:55] Seen 20,188 samples
[2023-07-14 11:46:55] Starting data epoch 25 in logical epoch 25
[2023-07-14 11:46:55] [data] Shuffling data
[2023-07-14 11:46:55] [data] Done reading 20,192 sentences
[2023-07-14 11:46:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:47:13] Ep. 25 : Up. 4000 : Sen. 5,032 : Cost 3.37509036 * 3,753,683 @ 3,204 after 15,004,272 : Time 358.51s : 10470.11 words/s : gNorm 1.2028
[2023-07-14 11:48:21] Seen 20,188 samples
[2023-07-14 11:48:21] Starting data epoch 26 in logical epoch 26
[2023-07-14 11:48:21] [data] Shuffling data
[2023-07-14 11:48:21] [data] Done reading 20,192 sentences
[2023-07-14 11:48:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:49:47] Seen 20,188 samples
[2023-07-14 11:49:47] Starting data epoch 27 in logical epoch 27
[2023-07-14 11:49:47] [data] Shuffling data
[2023-07-14 11:49:47] [data] Done reading 20,192 sentences
[2023-07-14 11:49:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:51:12] Seen 20,188 samples
[2023-07-14 11:51:12] Starting data epoch 28 in logical epoch 28
[2023-07-14 11:51:12] [data] Shuffling data
[2023-07-14 11:51:12] [data] Done reading 20,192 sentences
[2023-07-14 11:51:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:52:38] Seen 20,188 samples
[2023-07-14 11:52:38] Starting data epoch 29 in logical epoch 29
[2023-07-14 11:52:38] [data] Shuffling data
[2023-07-14 11:52:38] [data] Done reading 20,192 sentences
[2023-07-14 11:52:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:54:02] Seen 20,188 samples
[2023-07-14 11:54:02] Starting data epoch 30 in logical epoch 30
[2023-07-14 11:54:02] [data] Shuffling data
[2023-07-14 11:54:02] [data] Done reading 20,192 sentences
[2023-07-14 11:54:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:55:28] Seen 20,188 samples
[2023-07-14 11:55:28] Starting data epoch 31 in logical epoch 31
[2023-07-14 11:55:28] Training finished
[2023-07-14 11:55:37] [valid] Ep. 31 : Up. 4957 : cross-entropy : 106.774 : new best
[2023-07-14 11:56:28] [valid] Ep. 31 : Up. 4957 : translation : 0 : new best
[2023-07-14 11:56:28] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:56:29] Saving Adam parameters
[2023-07-14 11:56:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 11:56:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:56:36] [marian] Running on node21.datos.cluster.uy as process 20367 with command line:
[2023-07-14 11:56:36] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 11:56:36] [config] after: 0e
[2023-07-14 11:56:36] [config] after-batches: 0
[2023-07-14 11:56:36] [config] after-epochs: 40
[2023-07-14 11:56:36] [config] all-caps-every: 0
[2023-07-14 11:56:36] [config] allow-unk: false
[2023-07-14 11:56:36] [config] authors: false
[2023-07-14 11:56:36] [config] beam-size: 6
[2023-07-14 11:56:36] [config] bert-class-symbol: "[CLS]"
[2023-07-14 11:56:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 11:56:36] [config] bert-masking-fraction: 0.15
[2023-07-14 11:56:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 11:56:36] [config] bert-train-type-embeddings: true
[2023-07-14 11:56:36] [config] bert-type-vocab-size: 2
[2023-07-14 11:56:36] [config] build-info: ""
[2023-07-14 11:56:36] [config] check-gradient-nan: false
[2023-07-14 11:56:36] [config] check-nan: false
[2023-07-14 11:56:36] [config] cite: false
[2023-07-14 11:56:36] [config] clip-norm: 1
[2023-07-14 11:56:36] [config] cost-scaling:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] cost-type: ce-sum
[2023-07-14 11:56:36] [config] cpu-threads: 0
[2023-07-14 11:56:36] [config] data-threads: 8
[2023-07-14 11:56:36] [config] data-weighting: ""
[2023-07-14 11:56:36] [config] data-weighting-type: sentence
[2023-07-14 11:56:36] [config] dec-cell: gru
[2023-07-14 11:56:36] [config] dec-cell-base-depth: 2
[2023-07-14 11:56:36] [config] dec-cell-high-depth: 1
[2023-07-14 11:56:36] [config] dec-depth: 1
[2023-07-14 11:56:36] [config] devices:
[2023-07-14 11:56:36] [config]   - 0
[2023-07-14 11:56:36] [config] dim-emb: 512
[2023-07-14 11:56:36] [config] dim-rnn: 1024
[2023-07-14 11:56:36] [config] dim-vocabs:
[2023-07-14 11:56:36] [config]   - 16384
[2023-07-14 11:56:36] [config]   - 16384
[2023-07-14 11:56:36] [config] disp-first: 0
[2023-07-14 11:56:36] [config] disp-freq: 1000u
[2023-07-14 11:56:36] [config] disp-label-counts: true
[2023-07-14 11:56:36] [config] dropout-rnn: 0.2
[2023-07-14 11:56:36] [config] dropout-src: 0.1
[2023-07-14 11:56:36] [config] dropout-trg: 0.1
[2023-07-14 11:56:36] [config] dump-config: ""
[2023-07-14 11:56:36] [config] dynamic-gradient-scaling:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] early-stopping: 10
[2023-07-14 11:56:36] [config] early-stopping-on: first
[2023-07-14 11:56:36] [config] embedding-fix-src: false
[2023-07-14 11:56:36] [config] embedding-fix-trg: false
[2023-07-14 11:56:36] [config] embedding-normalization: false
[2023-07-14 11:56:36] [config] embedding-vectors:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] enc-cell: gru
[2023-07-14 11:56:36] [config] enc-cell-depth: 1
[2023-07-14 11:56:36] [config] enc-depth: 1
[2023-07-14 11:56:36] [config] enc-type: bidirectional
[2023-07-14 11:56:36] [config] english-title-case-every: 0
[2023-07-14 11:56:36] [config] exponential-smoothing: 0
[2023-07-14 11:56:36] [config] factor-weight: 1
[2023-07-14 11:56:36] [config] factors-combine: sum
[2023-07-14 11:56:36] [config] factors-dim-emb: 0
[2023-07-14 11:56:36] [config] gradient-checkpointing: false
[2023-07-14 11:56:36] [config] gradient-norm-average-window: 100
[2023-07-14 11:56:36] [config] guided-alignment: none
[2023-07-14 11:56:36] [config] guided-alignment-cost: mse
[2023-07-14 11:56:36] [config] guided-alignment-weight: 0.1
[2023-07-14 11:56:36] [config] ignore-model-config: false
[2023-07-14 11:56:36] [config] input-types:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] interpolate-env-vars: false
[2023-07-14 11:56:36] [config] keep-best: false
[2023-07-14 11:56:36] [config] label-smoothing: 0
[2023-07-14 11:56:36] [config] layer-normalization: true
[2023-07-14 11:56:36] [config] learn-rate: 0.0001
[2023-07-14 11:56:36] [config] lemma-dependency: ""
[2023-07-14 11:56:36] [config] lemma-dim-emb: 0
[2023-07-14 11:56:36] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:56:36] [config] log-level: info
[2023-07-14 11:56:36] [config] log-time-zone: ""
[2023-07-14 11:56:36] [config] logical-epoch:
[2023-07-14 11:56:36] [config]   - 1e
[2023-07-14 11:56:36] [config]   - 0
[2023-07-14 11:56:36] [config] lr-decay: 0
[2023-07-14 11:56:36] [config] lr-decay-freq: 50000
[2023-07-14 11:56:36] [config] lr-decay-inv-sqrt:
[2023-07-14 11:56:36] [config]   - 0
[2023-07-14 11:56:36] [config] lr-decay-repeat-warmup: false
[2023-07-14 11:56:36] [config] lr-decay-reset-optimizer: false
[2023-07-14 11:56:36] [config] lr-decay-start:
[2023-07-14 11:56:36] [config]   - 10
[2023-07-14 11:56:36] [config]   - 1
[2023-07-14 11:56:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 11:56:36] [config] lr-report: false
[2023-07-14 11:56:36] [config] lr-warmup: 0
[2023-07-14 11:56:36] [config] lr-warmup-at-reload: false
[2023-07-14 11:56:36] [config] lr-warmup-cycle: false
[2023-07-14 11:56:36] [config] lr-warmup-start-rate: 0
[2023-07-14 11:56:36] [config] max-length: 200
[2023-07-14 11:56:36] [config] max-length-crop: false
[2023-07-14 11:56:36] [config] max-length-factor: 3
[2023-07-14 11:56:36] [config] maxi-batch: 100
[2023-07-14 11:56:36] [config] maxi-batch-sort: trg
[2023-07-14 11:56:36] [config] mini-batch: 64
[2023-07-14 11:56:36] [config] mini-batch-fit: true
[2023-07-14 11:56:36] [config] mini-batch-fit-step: 10
[2023-07-14 11:56:36] [config] mini-batch-round-up: true
[2023-07-14 11:56:36] [config] mini-batch-track-lr: false
[2023-07-14 11:56:36] [config] mini-batch-warmup: 0
[2023-07-14 11:56:36] [config] mini-batch-words: 0
[2023-07-14 11:56:36] [config] mini-batch-words-ref: 0
[2023-07-14 11:56:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:56:36] [config] multi-loss-type: sum
[2023-07-14 11:56:36] [config] n-best: false
[2023-07-14 11:56:36] [config] no-nccl: false
[2023-07-14 11:56:36] [config] no-reload: false
[2023-07-14 11:56:36] [config] no-restore-corpus: false
[2023-07-14 11:56:36] [config] normalize: 0.6
[2023-07-14 11:56:36] [config] normalize-gradient: false
[2023-07-14 11:56:36] [config] num-devices: 0
[2023-07-14 11:56:36] [config] optimizer: adam
[2023-07-14 11:56:36] [config] optimizer-delay: 1
[2023-07-14 11:56:36] [config] optimizer-params:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] output-omit-bias: false
[2023-07-14 11:56:36] [config] overwrite: false
[2023-07-14 11:56:36] [config] precision:
[2023-07-14 11:56:36] [config]   - float32
[2023-07-14 11:56:36] [config]   - float32
[2023-07-14 11:56:36] [config] pretrained-model: ""
[2023-07-14 11:56:36] [config] quantize-biases: false
[2023-07-14 11:56:36] [config] quantize-bits: 0
[2023-07-14 11:56:36] [config] quantize-log-based: false
[2023-07-14 11:56:36] [config] quantize-optimization-steps: 0
[2023-07-14 11:56:36] [config] quiet: false
[2023-07-14 11:56:36] [config] quiet-translation: true
[2023-07-14 11:56:36] [config] relative-paths: false
[2023-07-14 11:56:36] [config] right-left: false
[2023-07-14 11:56:36] [config] save-freq: 10000u
[2023-07-14 11:56:36] [config] seed: 1234
[2023-07-14 11:56:36] [config] sentencepiece-alphas:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] sentencepiece-max-lines: 2000000
[2023-07-14 11:56:36] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 11:56:36] [config] sharding: global
[2023-07-14 11:56:36] [config] shuffle: data
[2023-07-14 11:56:36] [config] shuffle-in-ram: false
[2023-07-14 11:56:36] [config] sigterm: save-and-exit
[2023-07-14 11:56:36] [config] skip: false
[2023-07-14 11:56:36] [config] sqlite: ""
[2023-07-14 11:56:36] [config] sqlite-drop: false
[2023-07-14 11:56:36] [config] sync-freq: 200u
[2023-07-14 11:56:36] [config] sync-sgd: false
[2023-07-14 11:56:36] [config] tempdir: /tmp
[2023-07-14 11:56:36] [config] tied-embeddings: false
[2023-07-14 11:56:36] [config] tied-embeddings-all: true
[2023-07-14 11:56:36] [config] tied-embeddings-src: false
[2023-07-14 11:56:36] [config] train-embedder-rank:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] train-sets:
[2023-07-14 11:56:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 11:56:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 11:56:36] [config] transformer-aan-activation: swish
[2023-07-14 11:56:36] [config] transformer-aan-depth: 2
[2023-07-14 11:56:36] [config] transformer-aan-nogate: false
[2023-07-14 11:56:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 11:56:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 11:56:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 11:56:36] [config] transformer-depth-scaling: false
[2023-07-14 11:56:36] [config] transformer-dim-aan: 2048
[2023-07-14 11:56:36] [config] transformer-dim-ffn: 2048
[2023-07-14 11:56:36] [config] transformer-dropout: 0
[2023-07-14 11:56:36] [config] transformer-dropout-attention: 0
[2023-07-14 11:56:36] [config] transformer-dropout-ffn: 0
[2023-07-14 11:56:36] [config] transformer-ffn-activation: swish
[2023-07-14 11:56:36] [config] transformer-ffn-depth: 2
[2023-07-14 11:56:36] [config] transformer-guided-alignment-layer: last
[2023-07-14 11:56:36] [config] transformer-heads: 8
[2023-07-14 11:56:36] [config] transformer-no-projection: false
[2023-07-14 11:56:36] [config] transformer-pool: false
[2023-07-14 11:56:36] [config] transformer-postprocess: dan
[2023-07-14 11:56:36] [config] transformer-postprocess-emb: d
[2023-07-14 11:56:36] [config] transformer-postprocess-top: ""
[2023-07-14 11:56:36] [config] transformer-preprocess: ""
[2023-07-14 11:56:36] [config] transformer-tied-layers:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] transformer-train-position-embeddings: false
[2023-07-14 11:56:36] [config] tsv: false
[2023-07-14 11:56:36] [config] tsv-fields: 0
[2023-07-14 11:56:36] [config] type: amun
[2023-07-14 11:56:36] [config] ulr: false
[2023-07-14 11:56:36] [config] ulr-dim-emb: 0
[2023-07-14 11:56:36] [config] ulr-dropout: 0
[2023-07-14 11:56:36] [config] ulr-keys-vectors: ""
[2023-07-14 11:56:36] [config] ulr-query-vectors: ""
[2023-07-14 11:56:36] [config] ulr-softmax-temperature: 1
[2023-07-14 11:56:36] [config] ulr-trainable-transformation: false
[2023-07-14 11:56:36] [config] unlikelihood-loss: false
[2023-07-14 11:56:36] [config] valid-freq: 5000000
[2023-07-14 11:56:36] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 11:56:36] [config] valid-max-length: 1000
[2023-07-14 11:56:36] [config] valid-metrics:
[2023-07-14 11:56:36] [config]   - cross-entropy
[2023-07-14 11:56:36] [config]   - translation
[2023-07-14 11:56:36] [config] valid-mini-batch: 32
[2023-07-14 11:56:36] [config] valid-reset-stalled: false
[2023-07-14 11:56:36] [config] valid-script-args:
[2023-07-14 11:56:36] [config]   []
[2023-07-14 11:56:36] [config] valid-script-path: ""
[2023-07-14 11:56:36] [config] valid-sets:
[2023-07-14 11:56:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 11:56:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 11:56:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 11:56:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:56:36] [config] vocabs:
[2023-07-14 11:56:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:56:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:56:36] [config] word-penalty: 0
[2023-07-14 11:56:36] [config] word-scores: false
[2023-07-14 11:56:36] [config] workspace: 3000
[2023-07-14 11:56:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 11:56:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:56:36] [training] Using single-device training
[2023-07-14 11:56:38] Synced seed 1234
[2023-07-14 11:56:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 11:56:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 11:56:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 11:56:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 11:56:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 11:56:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:56:40] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:56:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:56:40] [comm] Using global sharding
[2023-07-14 11:56:40] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:56:40] [training] Using 1 GPUs
[2023-07-14 11:56:40] [logits] Applying loss function for 1 factor(s)
[2023-07-14 11:56:40] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:56:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 11:56:40] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:58:04] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 11:58:04] [valid] No post-processing script given for validating translator
[2023-07-14 11:58:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 11:58:04] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 11:58:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 11:58:04] [comm] Using global sharding
[2023-07-14 11:58:04] [comm] NCCLCommunicators constructed successfully
[2023-07-14 11:58:04] [training] Using 1 GPUs
[2023-07-14 11:58:04] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 11:58:05] Loading Adam parameters
[2023-07-14 11:58:05] [memory] Reserving 322 MB, device gpu0
[2023-07-14 11:58:05] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:58:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 11:58:05] [data] Restoring the corpus state to epoch 31, batch 4957
[2023-07-14 11:58:05] [data] Shuffling data
[2023-07-14 11:58:05] [data] Done reading 20,192 sentences
[2023-07-14 11:58:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 11:58:05] Training started
[2023-07-14 11:58:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 11:58:06] [memory] Reserving 161 MB, device gpu0
[2023-07-14 11:58:06] Parameter type float32, optimization type float32, casting types false
[2023-07-14 11:58:29] Ep. 31 : Up. 5000 : Sen. 5,016 : Cost 2.96801019 * 3,748,075 @ 4,625 after 18,752,347 : Time 25.17s : 148903.06 words/s : gNorm 1.2053
[2023-07-14 11:59:31] Seen 20,188 samples
[2023-07-14 11:59:31] Starting data epoch 32 in logical epoch 32
[2023-07-14 11:59:31] [data] Shuffling data
[2023-07-14 11:59:31] [data] Done reading 20,192 sentences
[2023-07-14 11:59:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:00:56] Seen 20,188 samples
[2023-07-14 12:00:56] Starting data epoch 33 in logical epoch 33
[2023-07-14 12:00:56] [data] Shuffling data
[2023-07-14 12:00:56] [data] Done reading 20,192 sentences
[2023-07-14 12:00:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:02:21] Seen 20,188 samples
[2023-07-14 12:02:21] Starting data epoch 34 in logical epoch 34
[2023-07-14 12:02:21] [data] Shuffling data
[2023-07-14 12:02:21] [data] Done reading 20,192 sentences
[2023-07-14 12:02:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:03:47] Seen 20,188 samples
[2023-07-14 12:03:47] Starting data epoch 35 in logical epoch 35
[2023-07-14 12:03:47] [data] Shuffling data
[2023-07-14 12:03:47] [data] Done reading 20,192 sentences
[2023-07-14 12:03:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:05:12] Seen 20,188 samples
[2023-07-14 12:05:12] Starting data epoch 36 in logical epoch 36
[2023-07-14 12:05:12] [data] Shuffling data
[2023-07-14 12:05:12] [data] Done reading 20,192 sentences
[2023-07-14 12:05:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:06:36] Seen 20,188 samples
[2023-07-14 12:06:36] Starting data epoch 37 in logical epoch 37
[2023-07-14 12:06:36] [data] Shuffling data
[2023-07-14 12:06:37] [data] Done reading 20,192 sentences
[2023-07-14 12:06:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:07:01] Ep. 37 : Up. 6000 : Sen. 5,905 : Cost 2.64188004 * 3,733,935 @ 1,026 after 22,486,282 : Time 512.02s : 7292.51 words/s : gNorm 1.2717
[2023-07-14 12:08:02] Seen 20,188 samples
[2023-07-14 12:08:02] Starting data epoch 38 in logical epoch 38
[2023-07-14 12:08:02] [data] Shuffling data
[2023-07-14 12:08:02] [data] Done reading 20,192 sentences
[2023-07-14 12:08:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:09:28] Seen 20,188 samples
[2023-07-14 12:09:28] Starting data epoch 39 in logical epoch 39
[2023-07-14 12:09:28] [data] Shuffling data
[2023-07-14 12:09:28] [data] Done reading 20,192 sentences
[2023-07-14 12:09:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:10:53] Seen 20,188 samples
[2023-07-14 12:10:53] Starting data epoch 40 in logical epoch 40
[2023-07-14 12:10:53] [data] Shuffling data
[2023-07-14 12:10:53] [data] Done reading 20,192 sentences
[2023-07-14 12:10:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:12:18] Seen 20,188 samples
[2023-07-14 12:12:18] Starting data epoch 41 in logical epoch 41
[2023-07-14 12:12:18] Training finished
[2023-07-14 12:12:27] [valid] Ep. 41 : Up. 6616 : cross-entropy : 102.93 : new best
[2023-07-14 12:13:14] [valid] Ep. 41 : Up. 6616 : translation : 0 : new best
[2023-07-14 12:13:14] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:13:15] Saving Adam parameters
[2023-07-14 12:13:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 12:13:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:13:23] [marian] Running on node21.datos.cluster.uy as process 21328 with command line:
[2023-07-14 12:13:23] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 12:13:23] [config] after: 0e
[2023-07-14 12:13:23] [config] after-batches: 0
[2023-07-14 12:13:23] [config] after-epochs: 50
[2023-07-14 12:13:23] [config] all-caps-every: 0
[2023-07-14 12:13:23] [config] allow-unk: false
[2023-07-14 12:13:23] [config] authors: false
[2023-07-14 12:13:23] [config] beam-size: 6
[2023-07-14 12:13:23] [config] bert-class-symbol: "[CLS]"
[2023-07-14 12:13:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 12:13:23] [config] bert-masking-fraction: 0.15
[2023-07-14 12:13:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 12:13:23] [config] bert-train-type-embeddings: true
[2023-07-14 12:13:23] [config] bert-type-vocab-size: 2
[2023-07-14 12:13:23] [config] build-info: ""
[2023-07-14 12:13:23] [config] check-gradient-nan: false
[2023-07-14 12:13:23] [config] check-nan: false
[2023-07-14 12:13:23] [config] cite: false
[2023-07-14 12:13:23] [config] clip-norm: 1
[2023-07-14 12:13:23] [config] cost-scaling:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] cost-type: ce-sum
[2023-07-14 12:13:23] [config] cpu-threads: 0
[2023-07-14 12:13:23] [config] data-threads: 8
[2023-07-14 12:13:23] [config] data-weighting: ""
[2023-07-14 12:13:23] [config] data-weighting-type: sentence
[2023-07-14 12:13:23] [config] dec-cell: gru
[2023-07-14 12:13:23] [config] dec-cell-base-depth: 2
[2023-07-14 12:13:23] [config] dec-cell-high-depth: 1
[2023-07-14 12:13:23] [config] dec-depth: 1
[2023-07-14 12:13:23] [config] devices:
[2023-07-14 12:13:23] [config]   - 0
[2023-07-14 12:13:23] [config] dim-emb: 512
[2023-07-14 12:13:23] [config] dim-rnn: 1024
[2023-07-14 12:13:23] [config] dim-vocabs:
[2023-07-14 12:13:23] [config]   - 16384
[2023-07-14 12:13:23] [config]   - 16384
[2023-07-14 12:13:23] [config] disp-first: 0
[2023-07-14 12:13:23] [config] disp-freq: 1000u
[2023-07-14 12:13:23] [config] disp-label-counts: true
[2023-07-14 12:13:23] [config] dropout-rnn: 0.2
[2023-07-14 12:13:23] [config] dropout-src: 0.1
[2023-07-14 12:13:23] [config] dropout-trg: 0.1
[2023-07-14 12:13:23] [config] dump-config: ""
[2023-07-14 12:13:23] [config] dynamic-gradient-scaling:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] early-stopping: 10
[2023-07-14 12:13:23] [config] early-stopping-on: first
[2023-07-14 12:13:23] [config] embedding-fix-src: false
[2023-07-14 12:13:23] [config] embedding-fix-trg: false
[2023-07-14 12:13:23] [config] embedding-normalization: false
[2023-07-14 12:13:23] [config] embedding-vectors:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] enc-cell: gru
[2023-07-14 12:13:23] [config] enc-cell-depth: 1
[2023-07-14 12:13:23] [config] enc-depth: 1
[2023-07-14 12:13:23] [config] enc-type: bidirectional
[2023-07-14 12:13:23] [config] english-title-case-every: 0
[2023-07-14 12:13:23] [config] exponential-smoothing: 0
[2023-07-14 12:13:23] [config] factor-weight: 1
[2023-07-14 12:13:23] [config] factors-combine: sum
[2023-07-14 12:13:23] [config] factors-dim-emb: 0
[2023-07-14 12:13:23] [config] gradient-checkpointing: false
[2023-07-14 12:13:23] [config] gradient-norm-average-window: 100
[2023-07-14 12:13:23] [config] guided-alignment: none
[2023-07-14 12:13:23] [config] guided-alignment-cost: mse
[2023-07-14 12:13:23] [config] guided-alignment-weight: 0.1
[2023-07-14 12:13:23] [config] ignore-model-config: false
[2023-07-14 12:13:23] [config] input-types:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] interpolate-env-vars: false
[2023-07-14 12:13:23] [config] keep-best: false
[2023-07-14 12:13:23] [config] label-smoothing: 0
[2023-07-14 12:13:23] [config] layer-normalization: true
[2023-07-14 12:13:23] [config] learn-rate: 0.0001
[2023-07-14 12:13:23] [config] lemma-dependency: ""
[2023-07-14 12:13:23] [config] lemma-dim-emb: 0
[2023-07-14 12:13:23] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 12:13:23] [config] log-level: info
[2023-07-14 12:13:23] [config] log-time-zone: ""
[2023-07-14 12:13:23] [config] logical-epoch:
[2023-07-14 12:13:23] [config]   - 1e
[2023-07-14 12:13:23] [config]   - 0
[2023-07-14 12:13:23] [config] lr-decay: 0
[2023-07-14 12:13:23] [config] lr-decay-freq: 50000
[2023-07-14 12:13:23] [config] lr-decay-inv-sqrt:
[2023-07-14 12:13:23] [config]   - 0
[2023-07-14 12:13:23] [config] lr-decay-repeat-warmup: false
[2023-07-14 12:13:23] [config] lr-decay-reset-optimizer: false
[2023-07-14 12:13:23] [config] lr-decay-start:
[2023-07-14 12:13:23] [config]   - 10
[2023-07-14 12:13:23] [config]   - 1
[2023-07-14 12:13:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 12:13:23] [config] lr-report: false
[2023-07-14 12:13:23] [config] lr-warmup: 0
[2023-07-14 12:13:23] [config] lr-warmup-at-reload: false
[2023-07-14 12:13:23] [config] lr-warmup-cycle: false
[2023-07-14 12:13:23] [config] lr-warmup-start-rate: 0
[2023-07-14 12:13:23] [config] max-length: 200
[2023-07-14 12:13:23] [config] max-length-crop: false
[2023-07-14 12:13:23] [config] max-length-factor: 3
[2023-07-14 12:13:23] [config] maxi-batch: 100
[2023-07-14 12:13:23] [config] maxi-batch-sort: trg
[2023-07-14 12:13:23] [config] mini-batch: 64
[2023-07-14 12:13:23] [config] mini-batch-fit: true
[2023-07-14 12:13:23] [config] mini-batch-fit-step: 10
[2023-07-14 12:13:23] [config] mini-batch-round-up: true
[2023-07-14 12:13:23] [config] mini-batch-track-lr: false
[2023-07-14 12:13:23] [config] mini-batch-warmup: 0
[2023-07-14 12:13:23] [config] mini-batch-words: 0
[2023-07-14 12:13:23] [config] mini-batch-words-ref: 0
[2023-07-14 12:13:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:13:23] [config] multi-loss-type: sum
[2023-07-14 12:13:23] [config] n-best: false
[2023-07-14 12:13:23] [config] no-nccl: false
[2023-07-14 12:13:23] [config] no-reload: false
[2023-07-14 12:13:23] [config] no-restore-corpus: false
[2023-07-14 12:13:23] [config] normalize: 0.6
[2023-07-14 12:13:23] [config] normalize-gradient: false
[2023-07-14 12:13:23] [config] num-devices: 0
[2023-07-14 12:13:23] [config] optimizer: adam
[2023-07-14 12:13:23] [config] optimizer-delay: 1
[2023-07-14 12:13:23] [config] optimizer-params:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] output-omit-bias: false
[2023-07-14 12:13:23] [config] overwrite: false
[2023-07-14 12:13:23] [config] precision:
[2023-07-14 12:13:23] [config]   - float32
[2023-07-14 12:13:23] [config]   - float32
[2023-07-14 12:13:23] [config] pretrained-model: ""
[2023-07-14 12:13:23] [config] quantize-biases: false
[2023-07-14 12:13:23] [config] quantize-bits: 0
[2023-07-14 12:13:23] [config] quantize-log-based: false
[2023-07-14 12:13:23] [config] quantize-optimization-steps: 0
[2023-07-14 12:13:23] [config] quiet: false
[2023-07-14 12:13:23] [config] quiet-translation: true
[2023-07-14 12:13:23] [config] relative-paths: false
[2023-07-14 12:13:23] [config] right-left: false
[2023-07-14 12:13:23] [config] save-freq: 10000u
[2023-07-14 12:13:23] [config] seed: 1234
[2023-07-14 12:13:23] [config] sentencepiece-alphas:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] sentencepiece-max-lines: 2000000
[2023-07-14 12:13:23] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 12:13:23] [config] sharding: global
[2023-07-14 12:13:23] [config] shuffle: data
[2023-07-14 12:13:23] [config] shuffle-in-ram: false
[2023-07-14 12:13:23] [config] sigterm: save-and-exit
[2023-07-14 12:13:23] [config] skip: false
[2023-07-14 12:13:23] [config] sqlite: ""
[2023-07-14 12:13:23] [config] sqlite-drop: false
[2023-07-14 12:13:23] [config] sync-freq: 200u
[2023-07-14 12:13:23] [config] sync-sgd: false
[2023-07-14 12:13:23] [config] tempdir: /tmp
[2023-07-14 12:13:23] [config] tied-embeddings: false
[2023-07-14 12:13:23] [config] tied-embeddings-all: true
[2023-07-14 12:13:23] [config] tied-embeddings-src: false
[2023-07-14 12:13:23] [config] train-embedder-rank:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] train-sets:
[2023-07-14 12:13:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 12:13:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 12:13:23] [config] transformer-aan-activation: swish
[2023-07-14 12:13:23] [config] transformer-aan-depth: 2
[2023-07-14 12:13:23] [config] transformer-aan-nogate: false
[2023-07-14 12:13:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 12:13:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 12:13:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 12:13:23] [config] transformer-depth-scaling: false
[2023-07-14 12:13:23] [config] transformer-dim-aan: 2048
[2023-07-14 12:13:23] [config] transformer-dim-ffn: 2048
[2023-07-14 12:13:23] [config] transformer-dropout: 0
[2023-07-14 12:13:23] [config] transformer-dropout-attention: 0
[2023-07-14 12:13:23] [config] transformer-dropout-ffn: 0
[2023-07-14 12:13:23] [config] transformer-ffn-activation: swish
[2023-07-14 12:13:23] [config] transformer-ffn-depth: 2
[2023-07-14 12:13:23] [config] transformer-guided-alignment-layer: last
[2023-07-14 12:13:23] [config] transformer-heads: 8
[2023-07-14 12:13:23] [config] transformer-no-projection: false
[2023-07-14 12:13:23] [config] transformer-pool: false
[2023-07-14 12:13:23] [config] transformer-postprocess: dan
[2023-07-14 12:13:23] [config] transformer-postprocess-emb: d
[2023-07-14 12:13:23] [config] transformer-postprocess-top: ""
[2023-07-14 12:13:23] [config] transformer-preprocess: ""
[2023-07-14 12:13:23] [config] transformer-tied-layers:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] transformer-train-position-embeddings: false
[2023-07-14 12:13:23] [config] tsv: false
[2023-07-14 12:13:23] [config] tsv-fields: 0
[2023-07-14 12:13:23] [config] type: amun
[2023-07-14 12:13:23] [config] ulr: false
[2023-07-14 12:13:23] [config] ulr-dim-emb: 0
[2023-07-14 12:13:23] [config] ulr-dropout: 0
[2023-07-14 12:13:23] [config] ulr-keys-vectors: ""
[2023-07-14 12:13:23] [config] ulr-query-vectors: ""
[2023-07-14 12:13:23] [config] ulr-softmax-temperature: 1
[2023-07-14 12:13:23] [config] ulr-trainable-transformation: false
[2023-07-14 12:13:23] [config] unlikelihood-loss: false
[2023-07-14 12:13:23] [config] valid-freq: 5000000
[2023-07-14 12:13:23] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 12:13:23] [config] valid-max-length: 1000
[2023-07-14 12:13:23] [config] valid-metrics:
[2023-07-14 12:13:23] [config]   - cross-entropy
[2023-07-14 12:13:23] [config]   - translation
[2023-07-14 12:13:23] [config] valid-mini-batch: 32
[2023-07-14 12:13:23] [config] valid-reset-stalled: false
[2023-07-14 12:13:23] [config] valid-script-args:
[2023-07-14 12:13:23] [config]   []
[2023-07-14 12:13:23] [config] valid-script-path: ""
[2023-07-14 12:13:23] [config] valid-sets:
[2023-07-14 12:13:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 12:13:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 12:13:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 12:13:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:13:23] [config] vocabs:
[2023-07-14 12:13:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 12:13:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 12:13:23] [config] word-penalty: 0
[2023-07-14 12:13:23] [config] word-scores: false
[2023-07-14 12:13:23] [config] workspace: 3000
[2023-07-14 12:13:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:13:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:13:23] [training] Using single-device training
[2023-07-14 12:13:25] Synced seed 1234
[2023-07-14 12:13:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 12:13:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 12:13:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 12:13:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 12:13:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 12:13:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:13:26] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 12:13:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 12:13:26] [comm] Using global sharding
[2023-07-14 12:13:26] [comm] NCCLCommunicators constructed successfully
[2023-07-14 12:13:26] [training] Using 1 GPUs
[2023-07-14 12:13:26] [logits] Applying loss function for 1 factor(s)
[2023-07-14 12:13:26] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:13:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 12:13:27] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:14:50] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 12:14:50] [valid] No post-processing script given for validating translator
[2023-07-14 12:14:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:14:50] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 12:14:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 12:14:50] [comm] Using global sharding
[2023-07-14 12:14:50] [comm] NCCLCommunicators constructed successfully
[2023-07-14 12:14:50] [training] Using 1 GPUs
[2023-07-14 12:14:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:14:51] Loading Adam parameters
[2023-07-14 12:14:51] [memory] Reserving 322 MB, device gpu0
[2023-07-14 12:14:51] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:14:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 12:14:51] [data] Restoring the corpus state to epoch 41, batch 6616
[2023-07-14 12:14:51] [data] Shuffling data
[2023-07-14 12:14:51] [data] Done reading 20,192 sentences
[2023-07-14 12:14:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:14:51] Training started
[2023-07-14 12:14:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 12:14:52] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:14:52] Parameter type float32, optimization type float32, casting types false
[2023-07-14 12:16:16] Seen 20,188 samples
[2023-07-14 12:16:16] Starting data epoch 42 in logical epoch 42
[2023-07-14 12:16:16] [data] Shuffling data
[2023-07-14 12:16:16] [data] Done reading 20,192 sentences
[2023-07-14 12:16:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:17:41] Seen 20,188 samples
[2023-07-14 12:17:41] Starting data epoch 43 in logical epoch 43
[2023-07-14 12:17:41] [data] Shuffling data
[2023-07-14 12:17:41] [data] Done reading 20,192 sentences
[2023-07-14 12:17:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:18:09] Ep. 43 : Up. 7000 : Sen. 6,651 : Cost 2.36905980 * 3,737,825 @ 4,095 after 26,224,107 : Time 198.70s : 18811.68 words/s : gNorm 1.2576
[2023-07-14 12:19:06] Seen 20,188 samples
[2023-07-14 12:19:06] Starting data epoch 44 in logical epoch 44
[2023-07-14 12:19:06] [data] Shuffling data
[2023-07-14 12:19:06] [data] Done reading 20,192 sentences
[2023-07-14 12:19:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:20:31] Seen 20,188 samples
[2023-07-14 12:20:31] Starting data epoch 45 in logical epoch 45
[2023-07-14 12:20:31] [data] Shuffling data
[2023-07-14 12:20:31] [data] Done reading 20,192 sentences
[2023-07-14 12:20:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:21:55] Seen 20,188 samples
[2023-07-14 12:21:55] Starting data epoch 46 in logical epoch 46
[2023-07-14 12:21:55] [data] Shuffling data
[2023-07-14 12:21:55] [data] Done reading 20,192 sentences
[2023-07-14 12:21:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:23:21] Seen 20,188 samples
[2023-07-14 12:23:21] Starting data epoch 47 in logical epoch 47
[2023-07-14 12:23:21] [data] Shuffling data
[2023-07-14 12:23:21] [data] Done reading 20,192 sentences
[2023-07-14 12:23:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:24:46] Seen 20,188 samples
[2023-07-14 12:24:46] Starting data epoch 48 in logical epoch 48
[2023-07-14 12:24:46] [data] Shuffling data
[2023-07-14 12:24:46] [data] Done reading 20,192 sentences
[2023-07-14 12:24:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:26:11] Seen 20,188 samples
[2023-07-14 12:26:11] Starting data epoch 49 in logical epoch 49
[2023-07-14 12:26:11] [data] Shuffling data
[2023-07-14 12:26:11] [data] Done reading 20,192 sentences
[2023-07-14 12:26:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:26:43] Ep. 49 : Up. 8000 : Sen. 7,443 : Cost 2.12537265 * 3,751,316 @ 4,106 after 29,975,423 : Time 514.61s : 7289.64 words/s : gNorm 1.2494
[2023-07-14 12:27:37] Seen 20,188 samples
[2023-07-14 12:27:37] Starting data epoch 50 in logical epoch 50
[2023-07-14 12:27:37] [data] Shuffling data
[2023-07-14 12:27:37] [data] Done reading 20,192 sentences
[2023-07-14 12:27:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:29:02] Seen 20,188 samples
[2023-07-14 12:29:02] Starting data epoch 51 in logical epoch 51
[2023-07-14 12:29:02] Training finished
[2023-07-14 12:29:11] [valid] Ep. 51 : Up. 8268 : cross-entropy : 100.747 : new best
[2023-07-14 12:29:54] [valid] Ep. 51 : Up. 8268 : translation : 0 : new best
[2023-07-14 12:29:54] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:29:55] Saving Adam parameters
[2023-07-14 12:29:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 12:30:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:30:03] [marian] Running on node21.datos.cluster.uy as process 22588 with command line:
[2023-07-14 12:30:03] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 12:30:03] [config] after: 0e
[2023-07-14 12:30:03] [config] after-batches: 0
[2023-07-14 12:30:03] [config] after-epochs: 60
[2023-07-14 12:30:03] [config] all-caps-every: 0
[2023-07-14 12:30:03] [config] allow-unk: false
[2023-07-14 12:30:03] [config] authors: false
[2023-07-14 12:30:03] [config] beam-size: 6
[2023-07-14 12:30:03] [config] bert-class-symbol: "[CLS]"
[2023-07-14 12:30:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 12:30:03] [config] bert-masking-fraction: 0.15
[2023-07-14 12:30:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 12:30:03] [config] bert-train-type-embeddings: true
[2023-07-14 12:30:03] [config] bert-type-vocab-size: 2
[2023-07-14 12:30:03] [config] build-info: ""
[2023-07-14 12:30:03] [config] check-gradient-nan: false
[2023-07-14 12:30:03] [config] check-nan: false
[2023-07-14 12:30:03] [config] cite: false
[2023-07-14 12:30:03] [config] clip-norm: 1
[2023-07-14 12:30:03] [config] cost-scaling:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] cost-type: ce-sum
[2023-07-14 12:30:03] [config] cpu-threads: 0
[2023-07-14 12:30:03] [config] data-threads: 8
[2023-07-14 12:30:03] [config] data-weighting: ""
[2023-07-14 12:30:03] [config] data-weighting-type: sentence
[2023-07-14 12:30:03] [config] dec-cell: gru
[2023-07-14 12:30:03] [config] dec-cell-base-depth: 2
[2023-07-14 12:30:03] [config] dec-cell-high-depth: 1
[2023-07-14 12:30:03] [config] dec-depth: 1
[2023-07-14 12:30:03] [config] devices:
[2023-07-14 12:30:03] [config]   - 0
[2023-07-14 12:30:03] [config] dim-emb: 512
[2023-07-14 12:30:03] [config] dim-rnn: 1024
[2023-07-14 12:30:03] [config] dim-vocabs:
[2023-07-14 12:30:03] [config]   - 16384
[2023-07-14 12:30:03] [config]   - 16384
[2023-07-14 12:30:03] [config] disp-first: 0
[2023-07-14 12:30:03] [config] disp-freq: 1000u
[2023-07-14 12:30:03] [config] disp-label-counts: true
[2023-07-14 12:30:03] [config] dropout-rnn: 0.2
[2023-07-14 12:30:03] [config] dropout-src: 0.1
[2023-07-14 12:30:03] [config] dropout-trg: 0.1
[2023-07-14 12:30:03] [config] dump-config: ""
[2023-07-14 12:30:03] [config] dynamic-gradient-scaling:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] early-stopping: 10
[2023-07-14 12:30:03] [config] early-stopping-on: first
[2023-07-14 12:30:03] [config] embedding-fix-src: false
[2023-07-14 12:30:03] [config] embedding-fix-trg: false
[2023-07-14 12:30:03] [config] embedding-normalization: false
[2023-07-14 12:30:03] [config] embedding-vectors:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] enc-cell: gru
[2023-07-14 12:30:03] [config] enc-cell-depth: 1
[2023-07-14 12:30:03] [config] enc-depth: 1
[2023-07-14 12:30:03] [config] enc-type: bidirectional
[2023-07-14 12:30:03] [config] english-title-case-every: 0
[2023-07-14 12:30:03] [config] exponential-smoothing: 0
[2023-07-14 12:30:03] [config] factor-weight: 1
[2023-07-14 12:30:03] [config] factors-combine: sum
[2023-07-14 12:30:03] [config] factors-dim-emb: 0
[2023-07-14 12:30:03] [config] gradient-checkpointing: false
[2023-07-14 12:30:03] [config] gradient-norm-average-window: 100
[2023-07-14 12:30:03] [config] guided-alignment: none
[2023-07-14 12:30:03] [config] guided-alignment-cost: mse
[2023-07-14 12:30:03] [config] guided-alignment-weight: 0.1
[2023-07-14 12:30:03] [config] ignore-model-config: false
[2023-07-14 12:30:03] [config] input-types:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] interpolate-env-vars: false
[2023-07-14 12:30:03] [config] keep-best: false
[2023-07-14 12:30:03] [config] label-smoothing: 0
[2023-07-14 12:30:03] [config] layer-normalization: true
[2023-07-14 12:30:03] [config] learn-rate: 0.0001
[2023-07-14 12:30:03] [config] lemma-dependency: ""
[2023-07-14 12:30:03] [config] lemma-dim-emb: 0
[2023-07-14 12:30:03] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 12:30:03] [config] log-level: info
[2023-07-14 12:30:03] [config] log-time-zone: ""
[2023-07-14 12:30:03] [config] logical-epoch:
[2023-07-14 12:30:03] [config]   - 1e
[2023-07-14 12:30:03] [config]   - 0
[2023-07-14 12:30:03] [config] lr-decay: 0
[2023-07-14 12:30:03] [config] lr-decay-freq: 50000
[2023-07-14 12:30:03] [config] lr-decay-inv-sqrt:
[2023-07-14 12:30:03] [config]   - 0
[2023-07-14 12:30:03] [config] lr-decay-repeat-warmup: false
[2023-07-14 12:30:03] [config] lr-decay-reset-optimizer: false
[2023-07-14 12:30:03] [config] lr-decay-start:
[2023-07-14 12:30:03] [config]   - 10
[2023-07-14 12:30:03] [config]   - 1
[2023-07-14 12:30:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 12:30:03] [config] lr-report: false
[2023-07-14 12:30:03] [config] lr-warmup: 0
[2023-07-14 12:30:03] [config] lr-warmup-at-reload: false
[2023-07-14 12:30:03] [config] lr-warmup-cycle: false
[2023-07-14 12:30:03] [config] lr-warmup-start-rate: 0
[2023-07-14 12:30:03] [config] max-length: 200
[2023-07-14 12:30:03] [config] max-length-crop: false
[2023-07-14 12:30:03] [config] max-length-factor: 3
[2023-07-14 12:30:03] [config] maxi-batch: 100
[2023-07-14 12:30:03] [config] maxi-batch-sort: trg
[2023-07-14 12:30:03] [config] mini-batch: 64
[2023-07-14 12:30:03] [config] mini-batch-fit: true
[2023-07-14 12:30:03] [config] mini-batch-fit-step: 10
[2023-07-14 12:30:03] [config] mini-batch-round-up: true
[2023-07-14 12:30:03] [config] mini-batch-track-lr: false
[2023-07-14 12:30:03] [config] mini-batch-warmup: 0
[2023-07-14 12:30:03] [config] mini-batch-words: 0
[2023-07-14 12:30:03] [config] mini-batch-words-ref: 0
[2023-07-14 12:30:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:30:03] [config] multi-loss-type: sum
[2023-07-14 12:30:03] [config] n-best: false
[2023-07-14 12:30:03] [config] no-nccl: false
[2023-07-14 12:30:03] [config] no-reload: false
[2023-07-14 12:30:03] [config] no-restore-corpus: false
[2023-07-14 12:30:03] [config] normalize: 0.6
[2023-07-14 12:30:03] [config] normalize-gradient: false
[2023-07-14 12:30:03] [config] num-devices: 0
[2023-07-14 12:30:03] [config] optimizer: adam
[2023-07-14 12:30:03] [config] optimizer-delay: 1
[2023-07-14 12:30:03] [config] optimizer-params:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] output-omit-bias: false
[2023-07-14 12:30:03] [config] overwrite: false
[2023-07-14 12:30:03] [config] precision:
[2023-07-14 12:30:03] [config]   - float32
[2023-07-14 12:30:03] [config]   - float32
[2023-07-14 12:30:03] [config] pretrained-model: ""
[2023-07-14 12:30:03] [config] quantize-biases: false
[2023-07-14 12:30:03] [config] quantize-bits: 0
[2023-07-14 12:30:03] [config] quantize-log-based: false
[2023-07-14 12:30:03] [config] quantize-optimization-steps: 0
[2023-07-14 12:30:03] [config] quiet: false
[2023-07-14 12:30:03] [config] quiet-translation: true
[2023-07-14 12:30:03] [config] relative-paths: false
[2023-07-14 12:30:03] [config] right-left: false
[2023-07-14 12:30:03] [config] save-freq: 10000u
[2023-07-14 12:30:03] [config] seed: 1234
[2023-07-14 12:30:03] [config] sentencepiece-alphas:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] sentencepiece-max-lines: 2000000
[2023-07-14 12:30:03] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 12:30:03] [config] sharding: global
[2023-07-14 12:30:03] [config] shuffle: data
[2023-07-14 12:30:03] [config] shuffle-in-ram: false
[2023-07-14 12:30:03] [config] sigterm: save-and-exit
[2023-07-14 12:30:03] [config] skip: false
[2023-07-14 12:30:03] [config] sqlite: ""
[2023-07-14 12:30:03] [config] sqlite-drop: false
[2023-07-14 12:30:03] [config] sync-freq: 200u
[2023-07-14 12:30:03] [config] sync-sgd: false
[2023-07-14 12:30:03] [config] tempdir: /tmp
[2023-07-14 12:30:03] [config] tied-embeddings: false
[2023-07-14 12:30:03] [config] tied-embeddings-all: true
[2023-07-14 12:30:03] [config] tied-embeddings-src: false
[2023-07-14 12:30:03] [config] train-embedder-rank:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] train-sets:
[2023-07-14 12:30:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 12:30:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 12:30:03] [config] transformer-aan-activation: swish
[2023-07-14 12:30:03] [config] transformer-aan-depth: 2
[2023-07-14 12:30:03] [config] transformer-aan-nogate: false
[2023-07-14 12:30:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 12:30:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 12:30:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 12:30:03] [config] transformer-depth-scaling: false
[2023-07-14 12:30:03] [config] transformer-dim-aan: 2048
[2023-07-14 12:30:03] [config] transformer-dim-ffn: 2048
[2023-07-14 12:30:03] [config] transformer-dropout: 0
[2023-07-14 12:30:03] [config] transformer-dropout-attention: 0
[2023-07-14 12:30:03] [config] transformer-dropout-ffn: 0
[2023-07-14 12:30:03] [config] transformer-ffn-activation: swish
[2023-07-14 12:30:03] [config] transformer-ffn-depth: 2
[2023-07-14 12:30:03] [config] transformer-guided-alignment-layer: last
[2023-07-14 12:30:03] [config] transformer-heads: 8
[2023-07-14 12:30:03] [config] transformer-no-projection: false
[2023-07-14 12:30:03] [config] transformer-pool: false
[2023-07-14 12:30:03] [config] transformer-postprocess: dan
[2023-07-14 12:30:03] [config] transformer-postprocess-emb: d
[2023-07-14 12:30:03] [config] transformer-postprocess-top: ""
[2023-07-14 12:30:03] [config] transformer-preprocess: ""
[2023-07-14 12:30:03] [config] transformer-tied-layers:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] transformer-train-position-embeddings: false
[2023-07-14 12:30:03] [config] tsv: false
[2023-07-14 12:30:03] [config] tsv-fields: 0
[2023-07-14 12:30:03] [config] type: amun
[2023-07-14 12:30:03] [config] ulr: false
[2023-07-14 12:30:03] [config] ulr-dim-emb: 0
[2023-07-14 12:30:03] [config] ulr-dropout: 0
[2023-07-14 12:30:03] [config] ulr-keys-vectors: ""
[2023-07-14 12:30:03] [config] ulr-query-vectors: ""
[2023-07-14 12:30:03] [config] ulr-softmax-temperature: 1
[2023-07-14 12:30:03] [config] ulr-trainable-transformation: false
[2023-07-14 12:30:03] [config] unlikelihood-loss: false
[2023-07-14 12:30:03] [config] valid-freq: 5000000
[2023-07-14 12:30:03] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 12:30:03] [config] valid-max-length: 1000
[2023-07-14 12:30:03] [config] valid-metrics:
[2023-07-14 12:30:03] [config]   - cross-entropy
[2023-07-14 12:30:03] [config]   - translation
[2023-07-14 12:30:03] [config] valid-mini-batch: 32
[2023-07-14 12:30:03] [config] valid-reset-stalled: false
[2023-07-14 12:30:03] [config] valid-script-args:
[2023-07-14 12:30:03] [config]   []
[2023-07-14 12:30:03] [config] valid-script-path: ""
[2023-07-14 12:30:03] [config] valid-sets:
[2023-07-14 12:30:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 12:30:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 12:30:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 12:30:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:30:03] [config] vocabs:
[2023-07-14 12:30:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 12:30:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 12:30:03] [config] word-penalty: 0
[2023-07-14 12:30:03] [config] word-scores: false
[2023-07-14 12:30:03] [config] workspace: 3000
[2023-07-14 12:30:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:30:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:30:03] [training] Using single-device training
[2023-07-14 12:30:07] Synced seed 1234
[2023-07-14 12:30:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 12:30:07] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 12:30:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 12:30:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 12:30:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 12:30:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:30:08] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 12:30:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 12:30:08] [comm] Using global sharding
[2023-07-14 12:30:08] [comm] NCCLCommunicators constructed successfully
[2023-07-14 12:30:08] [training] Using 1 GPUs
[2023-07-14 12:30:08] [logits] Applying loss function for 1 factor(s)
[2023-07-14 12:30:08] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:30:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 12:30:09] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:31:31] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 12:31:32] [valid] No post-processing script given for validating translator
[2023-07-14 12:31:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:31:32] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 12:31:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 12:31:32] [comm] Using global sharding
[2023-07-14 12:31:32] [comm] NCCLCommunicators constructed successfully
[2023-07-14 12:31:32] [training] Using 1 GPUs
[2023-07-14 12:31:32] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:31:33] Loading Adam parameters
[2023-07-14 12:31:33] [memory] Reserving 322 MB, device gpu0
[2023-07-14 12:31:33] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:31:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 12:31:33] [data] Restoring the corpus state to epoch 51, batch 8268
[2023-07-14 12:31:33] [data] Shuffling data
[2023-07-14 12:31:33] [data] Done reading 20,192 sentences
[2023-07-14 12:31:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:31:33] Training started
[2023-07-14 12:31:33] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 12:31:33] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:31:34] Parameter type float32, optimization type float32, casting types false
[2023-07-14 12:32:58] Seen 20,188 samples
[2023-07-14 12:32:58] Starting data epoch 52 in logical epoch 52
[2023-07-14 12:32:58] [data] Shuffling data
[2023-07-14 12:32:58] [data] Done reading 20,192 sentences
[2023-07-14 12:32:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:34:24] Seen 20,188 samples
[2023-07-14 12:34:24] Starting data epoch 53 in logical epoch 53
[2023-07-14 12:34:24] [data] Shuffling data
[2023-07-14 12:34:24] [data] Done reading 20,192 sentences
[2023-07-14 12:34:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:35:48] Seen 20,188 samples
[2023-07-14 12:35:48] Starting data epoch 54 in logical epoch 54
[2023-07-14 12:35:48] [data] Shuffling data
[2023-07-14 12:35:48] [data] Done reading 20,192 sentences
[2023-07-14 12:35:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:37:13] Seen 20,188 samples
[2023-07-14 12:37:13] Starting data epoch 55 in logical epoch 55
[2023-07-14 12:37:13] [data] Shuffling data
[2023-07-14 12:37:13] [data] Done reading 20,192 sentences
[2023-07-14 12:37:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:37:49] Ep. 55 : Up. 9000 : Sen. 8,988 : Cost 1.92610741 * 3,742,296 @ 5,415 after 33,717,719 : Time 376.98s : 9927.13 words/s : gNorm 1.2313
[2023-07-14 12:38:38] Seen 20,188 samples
[2023-07-14 12:38:38] Starting data epoch 56 in logical epoch 56
[2023-07-14 12:38:38] [data] Shuffling data
[2023-07-14 12:38:38] [data] Done reading 20,192 sentences
[2023-07-14 12:38:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:40:03] Seen 20,188 samples
[2023-07-14 12:40:03] Starting data epoch 57 in logical epoch 57
[2023-07-14 12:40:03] [data] Shuffling data
[2023-07-14 12:40:03] [data] Done reading 20,192 sentences
[2023-07-14 12:40:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:41:27] Seen 20,188 samples
[2023-07-14 12:41:27] Starting data epoch 58 in logical epoch 58
[2023-07-14 12:41:27] [data] Shuffling data
[2023-07-14 12:41:27] [data] Done reading 20,192 sentences
[2023-07-14 12:41:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:42:52] Seen 20,188 samples
[2023-07-14 12:42:52] Starting data epoch 59 in logical epoch 59
[2023-07-14 12:42:52] [data] Shuffling data
[2023-07-14 12:42:52] [data] Done reading 20,192 sentences
[2023-07-14 12:42:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:44:17] Seen 20,188 samples
[2023-07-14 12:44:17] Starting data epoch 60 in logical epoch 60
[2023-07-14 12:44:17] [data] Shuffling data
[2023-07-14 12:44:17] [data] Done reading 20,192 sentences
[2023-07-14 12:44:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:45:42] Seen 20,188 samples
[2023-07-14 12:45:42] Starting data epoch 61 in logical epoch 61
[2023-07-14 12:45:42] Training finished
[2023-07-14 12:45:51] [valid] Ep. 61 : Up. 9922 : cross-entropy : 100.389 : new best
[2023-07-14 12:46:32] [valid] Ep. 61 : Up. 9922 : translation : 0 : new best
[2023-07-14 12:46:32] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:46:34] Saving Adam parameters
[2023-07-14 12:46:34] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 12:46:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:46:41] [marian] Running on node21.datos.cluster.uy as process 23517 with command line:
[2023-07-14 12:46:41] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 12:46:41] [config] after: 0e
[2023-07-14 12:46:41] [config] after-batches: 0
[2023-07-14 12:46:41] [config] after-epochs: 70
[2023-07-14 12:46:41] [config] all-caps-every: 0
[2023-07-14 12:46:41] [config] allow-unk: false
[2023-07-14 12:46:41] [config] authors: false
[2023-07-14 12:46:41] [config] beam-size: 6
[2023-07-14 12:46:41] [config] bert-class-symbol: "[CLS]"
[2023-07-14 12:46:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 12:46:41] [config] bert-masking-fraction: 0.15
[2023-07-14 12:46:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 12:46:41] [config] bert-train-type-embeddings: true
[2023-07-14 12:46:41] [config] bert-type-vocab-size: 2
[2023-07-14 12:46:41] [config] build-info: ""
[2023-07-14 12:46:41] [config] check-gradient-nan: false
[2023-07-14 12:46:41] [config] check-nan: false
[2023-07-14 12:46:41] [config] cite: false
[2023-07-14 12:46:41] [config] clip-norm: 1
[2023-07-14 12:46:41] [config] cost-scaling:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] cost-type: ce-sum
[2023-07-14 12:46:41] [config] cpu-threads: 0
[2023-07-14 12:46:41] [config] data-threads: 8
[2023-07-14 12:46:41] [config] data-weighting: ""
[2023-07-14 12:46:41] [config] data-weighting-type: sentence
[2023-07-14 12:46:41] [config] dec-cell: gru
[2023-07-14 12:46:41] [config] dec-cell-base-depth: 2
[2023-07-14 12:46:41] [config] dec-cell-high-depth: 1
[2023-07-14 12:46:41] [config] dec-depth: 1
[2023-07-14 12:46:41] [config] devices:
[2023-07-14 12:46:41] [config]   - 0
[2023-07-14 12:46:41] [config] dim-emb: 512
[2023-07-14 12:46:41] [config] dim-rnn: 1024
[2023-07-14 12:46:41] [config] dim-vocabs:
[2023-07-14 12:46:41] [config]   - 16384
[2023-07-14 12:46:41] [config]   - 16384
[2023-07-14 12:46:41] [config] disp-first: 0
[2023-07-14 12:46:41] [config] disp-freq: 1000u
[2023-07-14 12:46:41] [config] disp-label-counts: true
[2023-07-14 12:46:41] [config] dropout-rnn: 0.2
[2023-07-14 12:46:41] [config] dropout-src: 0.1
[2023-07-14 12:46:41] [config] dropout-trg: 0.1
[2023-07-14 12:46:41] [config] dump-config: ""
[2023-07-14 12:46:41] [config] dynamic-gradient-scaling:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] early-stopping: 10
[2023-07-14 12:46:41] [config] early-stopping-on: first
[2023-07-14 12:46:41] [config] embedding-fix-src: false
[2023-07-14 12:46:41] [config] embedding-fix-trg: false
[2023-07-14 12:46:41] [config] embedding-normalization: false
[2023-07-14 12:46:41] [config] embedding-vectors:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] enc-cell: gru
[2023-07-14 12:46:41] [config] enc-cell-depth: 1
[2023-07-14 12:46:41] [config] enc-depth: 1
[2023-07-14 12:46:41] [config] enc-type: bidirectional
[2023-07-14 12:46:41] [config] english-title-case-every: 0
[2023-07-14 12:46:41] [config] exponential-smoothing: 0
[2023-07-14 12:46:41] [config] factor-weight: 1
[2023-07-14 12:46:41] [config] factors-combine: sum
[2023-07-14 12:46:41] [config] factors-dim-emb: 0
[2023-07-14 12:46:41] [config] gradient-checkpointing: false
[2023-07-14 12:46:41] [config] gradient-norm-average-window: 100
[2023-07-14 12:46:41] [config] guided-alignment: none
[2023-07-14 12:46:41] [config] guided-alignment-cost: mse
[2023-07-14 12:46:41] [config] guided-alignment-weight: 0.1
[2023-07-14 12:46:41] [config] ignore-model-config: false
[2023-07-14 12:46:41] [config] input-types:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] interpolate-env-vars: false
[2023-07-14 12:46:41] [config] keep-best: false
[2023-07-14 12:46:41] [config] label-smoothing: 0
[2023-07-14 12:46:41] [config] layer-normalization: true
[2023-07-14 12:46:41] [config] learn-rate: 0.0001
[2023-07-14 12:46:41] [config] lemma-dependency: ""
[2023-07-14 12:46:41] [config] lemma-dim-emb: 0
[2023-07-14 12:46:41] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 12:46:41] [config] log-level: info
[2023-07-14 12:46:41] [config] log-time-zone: ""
[2023-07-14 12:46:41] [config] logical-epoch:
[2023-07-14 12:46:41] [config]   - 1e
[2023-07-14 12:46:41] [config]   - 0
[2023-07-14 12:46:41] [config] lr-decay: 0
[2023-07-14 12:46:41] [config] lr-decay-freq: 50000
[2023-07-14 12:46:41] [config] lr-decay-inv-sqrt:
[2023-07-14 12:46:41] [config]   - 0
[2023-07-14 12:46:41] [config] lr-decay-repeat-warmup: false
[2023-07-14 12:46:41] [config] lr-decay-reset-optimizer: false
[2023-07-14 12:46:41] [config] lr-decay-start:
[2023-07-14 12:46:41] [config]   - 10
[2023-07-14 12:46:41] [config]   - 1
[2023-07-14 12:46:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 12:46:41] [config] lr-report: false
[2023-07-14 12:46:41] [config] lr-warmup: 0
[2023-07-14 12:46:41] [config] lr-warmup-at-reload: false
[2023-07-14 12:46:41] [config] lr-warmup-cycle: false
[2023-07-14 12:46:41] [config] lr-warmup-start-rate: 0
[2023-07-14 12:46:41] [config] max-length: 200
[2023-07-14 12:46:41] [config] max-length-crop: false
[2023-07-14 12:46:41] [config] max-length-factor: 3
[2023-07-14 12:46:41] [config] maxi-batch: 100
[2023-07-14 12:46:41] [config] maxi-batch-sort: trg
[2023-07-14 12:46:41] [config] mini-batch: 64
[2023-07-14 12:46:41] [config] mini-batch-fit: true
[2023-07-14 12:46:41] [config] mini-batch-fit-step: 10
[2023-07-14 12:46:41] [config] mini-batch-round-up: true
[2023-07-14 12:46:41] [config] mini-batch-track-lr: false
[2023-07-14 12:46:41] [config] mini-batch-warmup: 0
[2023-07-14 12:46:41] [config] mini-batch-words: 0
[2023-07-14 12:46:41] [config] mini-batch-words-ref: 0
[2023-07-14 12:46:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:46:41] [config] multi-loss-type: sum
[2023-07-14 12:46:41] [config] n-best: false
[2023-07-14 12:46:41] [config] no-nccl: false
[2023-07-14 12:46:41] [config] no-reload: false
[2023-07-14 12:46:41] [config] no-restore-corpus: false
[2023-07-14 12:46:41] [config] normalize: 0.6
[2023-07-14 12:46:41] [config] normalize-gradient: false
[2023-07-14 12:46:41] [config] num-devices: 0
[2023-07-14 12:46:41] [config] optimizer: adam
[2023-07-14 12:46:41] [config] optimizer-delay: 1
[2023-07-14 12:46:41] [config] optimizer-params:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] output-omit-bias: false
[2023-07-14 12:46:41] [config] overwrite: false
[2023-07-14 12:46:41] [config] precision:
[2023-07-14 12:46:41] [config]   - float32
[2023-07-14 12:46:41] [config]   - float32
[2023-07-14 12:46:41] [config] pretrained-model: ""
[2023-07-14 12:46:41] [config] quantize-biases: false
[2023-07-14 12:46:41] [config] quantize-bits: 0
[2023-07-14 12:46:41] [config] quantize-log-based: false
[2023-07-14 12:46:41] [config] quantize-optimization-steps: 0
[2023-07-14 12:46:41] [config] quiet: false
[2023-07-14 12:46:41] [config] quiet-translation: true
[2023-07-14 12:46:41] [config] relative-paths: false
[2023-07-14 12:46:41] [config] right-left: false
[2023-07-14 12:46:41] [config] save-freq: 10000u
[2023-07-14 12:46:41] [config] seed: 1234
[2023-07-14 12:46:41] [config] sentencepiece-alphas:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] sentencepiece-max-lines: 2000000
[2023-07-14 12:46:41] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 12:46:41] [config] sharding: global
[2023-07-14 12:46:41] [config] shuffle: data
[2023-07-14 12:46:41] [config] shuffle-in-ram: false
[2023-07-14 12:46:41] [config] sigterm: save-and-exit
[2023-07-14 12:46:41] [config] skip: false
[2023-07-14 12:46:41] [config] sqlite: ""
[2023-07-14 12:46:41] [config] sqlite-drop: false
[2023-07-14 12:46:41] [config] sync-freq: 200u
[2023-07-14 12:46:41] [config] sync-sgd: false
[2023-07-14 12:46:41] [config] tempdir: /tmp
[2023-07-14 12:46:41] [config] tied-embeddings: false
[2023-07-14 12:46:41] [config] tied-embeddings-all: true
[2023-07-14 12:46:41] [config] tied-embeddings-src: false
[2023-07-14 12:46:41] [config] train-embedder-rank:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] train-sets:
[2023-07-14 12:46:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 12:46:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 12:46:41] [config] transformer-aan-activation: swish
[2023-07-14 12:46:41] [config] transformer-aan-depth: 2
[2023-07-14 12:46:41] [config] transformer-aan-nogate: false
[2023-07-14 12:46:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 12:46:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 12:46:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 12:46:41] [config] transformer-depth-scaling: false
[2023-07-14 12:46:41] [config] transformer-dim-aan: 2048
[2023-07-14 12:46:41] [config] transformer-dim-ffn: 2048
[2023-07-14 12:46:41] [config] transformer-dropout: 0
[2023-07-14 12:46:41] [config] transformer-dropout-attention: 0
[2023-07-14 12:46:41] [config] transformer-dropout-ffn: 0
[2023-07-14 12:46:41] [config] transformer-ffn-activation: swish
[2023-07-14 12:46:41] [config] transformer-ffn-depth: 2
[2023-07-14 12:46:41] [config] transformer-guided-alignment-layer: last
[2023-07-14 12:46:41] [config] transformer-heads: 8
[2023-07-14 12:46:41] [config] transformer-no-projection: false
[2023-07-14 12:46:41] [config] transformer-pool: false
[2023-07-14 12:46:41] [config] transformer-postprocess: dan
[2023-07-14 12:46:41] [config] transformer-postprocess-emb: d
[2023-07-14 12:46:41] [config] transformer-postprocess-top: ""
[2023-07-14 12:46:41] [config] transformer-preprocess: ""
[2023-07-14 12:46:41] [config] transformer-tied-layers:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] transformer-train-position-embeddings: false
[2023-07-14 12:46:41] [config] tsv: false
[2023-07-14 12:46:41] [config] tsv-fields: 0
[2023-07-14 12:46:41] [config] type: amun
[2023-07-14 12:46:41] [config] ulr: false
[2023-07-14 12:46:41] [config] ulr-dim-emb: 0
[2023-07-14 12:46:41] [config] ulr-dropout: 0
[2023-07-14 12:46:41] [config] ulr-keys-vectors: ""
[2023-07-14 12:46:41] [config] ulr-query-vectors: ""
[2023-07-14 12:46:41] [config] ulr-softmax-temperature: 1
[2023-07-14 12:46:41] [config] ulr-trainable-transformation: false
[2023-07-14 12:46:41] [config] unlikelihood-loss: false
[2023-07-14 12:46:41] [config] valid-freq: 5000000
[2023-07-14 12:46:41] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 12:46:41] [config] valid-max-length: 1000
[2023-07-14 12:46:41] [config] valid-metrics:
[2023-07-14 12:46:41] [config]   - cross-entropy
[2023-07-14 12:46:41] [config]   - translation
[2023-07-14 12:46:41] [config] valid-mini-batch: 32
[2023-07-14 12:46:41] [config] valid-reset-stalled: false
[2023-07-14 12:46:41] [config] valid-script-args:
[2023-07-14 12:46:41] [config]   []
[2023-07-14 12:46:41] [config] valid-script-path: ""
[2023-07-14 12:46:41] [config] valid-sets:
[2023-07-14 12:46:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 12:46:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 12:46:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 12:46:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:46:41] [config] vocabs:
[2023-07-14 12:46:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 12:46:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 12:46:41] [config] word-penalty: 0
[2023-07-14 12:46:41] [config] word-scores: false
[2023-07-14 12:46:41] [config] workspace: 3000
[2023-07-14 12:46:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 12:46:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:46:41] [training] Using single-device training
[2023-07-14 12:46:44] Synced seed 1234
[2023-07-14 12:46:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 12:46:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 12:46:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 12:46:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 12:46:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 12:46:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:46:45] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 12:46:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 12:46:45] [comm] Using global sharding
[2023-07-14 12:46:45] [comm] NCCLCommunicators constructed successfully
[2023-07-14 12:46:45] [training] Using 1 GPUs
[2023-07-14 12:46:45] [logits] Applying loss function for 1 factor(s)
[2023-07-14 12:46:45] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:46:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 12:46:46] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:48:08] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 12:48:08] [valid] No post-processing script given for validating translator
[2023-07-14 12:48:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 12:48:08] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 12:48:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 12:48:08] [comm] Using global sharding
[2023-07-14 12:48:09] [comm] NCCLCommunicators constructed successfully
[2023-07-14 12:48:09] [training] Using 1 GPUs
[2023-07-14 12:48:09] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:48:10] Loading Adam parameters
[2023-07-14 12:48:10] [memory] Reserving 322 MB, device gpu0
[2023-07-14 12:48:10] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:48:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 12:48:10] [data] Restoring the corpus state to epoch 61, batch 9922
[2023-07-14 12:48:10] [data] Shuffling data
[2023-07-14 12:48:10] [data] Done reading 20,192 sentences
[2023-07-14 12:48:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:48:10] Training started
[2023-07-14 12:48:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 12:48:10] [memory] Reserving 161 MB, device gpu0
[2023-07-14 12:48:10] Parameter type float32, optimization type float32, casting types false
[2023-07-14 12:48:48] Ep. 61 : Up. 10000 : Sen. 9,893 : Cost 1.75513828 * 3,742,910 @ 4,241 after 37,460,629 : Time 39.68s : 94338.90 words/s : gNorm 1.2220
[2023-07-14 12:48:48] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.iter10000.npz
[2023-07-14 12:48:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 12:48:51] Saving Adam parameters
[2023-07-14 12:48:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 12:49:39] Seen 20,188 samples
[2023-07-14 12:49:39] Starting data epoch 62 in logical epoch 62
[2023-07-14 12:49:39] [data] Shuffling data
[2023-07-14 12:49:39] [data] Done reading 20,192 sentences
[2023-07-14 12:49:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:51:04] Seen 20,188 samples
[2023-07-14 12:51:04] Starting data epoch 63 in logical epoch 63
[2023-07-14 12:51:04] [data] Shuffling data
[2023-07-14 12:51:04] [data] Done reading 20,192 sentences
[2023-07-14 12:51:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:52:30] Seen 20,188 samples
[2023-07-14 12:52:30] Starting data epoch 64 in logical epoch 64
[2023-07-14 12:52:30] [data] Shuffling data
[2023-07-14 12:52:30] [data] Done reading 20,192 sentences
[2023-07-14 12:52:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:53:55] Seen 20,188 samples
[2023-07-14 12:53:55] Starting data epoch 65 in logical epoch 65
[2023-07-14 12:53:55] [data] Shuffling data
[2023-07-14 12:53:55] [data] Done reading 20,192 sentences
[2023-07-14 12:53:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:55:20] Seen 20,188 samples
[2023-07-14 12:55:20] Starting data epoch 66 in logical epoch 66
[2023-07-14 12:55:20] [data] Shuffling data
[2023-07-14 12:55:20] [data] Done reading 20,192 sentences
[2023-07-14 12:55:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:56:45] Seen 20,188 samples
[2023-07-14 12:56:45] Starting data epoch 67 in logical epoch 67
[2023-07-14 12:56:45] [data] Shuffling data
[2023-07-14 12:56:45] [data] Done reading 20,192 sentences
[2023-07-14 12:56:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:57:27] Ep. 67 : Up. 11000 : Sen. 10,947 : Cost 1.59599459 * 3,744,028 @ 4,485 after 41,204,657 : Time 518.84s : 7216.19 words/s : gNorm 1.1555
[2023-07-14 12:58:10] Seen 20,188 samples
[2023-07-14 12:58:10] Starting data epoch 68 in logical epoch 68
[2023-07-14 12:58:10] [data] Shuffling data
[2023-07-14 12:58:10] [data] Done reading 20,192 sentences
[2023-07-14 12:58:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 12:59:36] Seen 20,188 samples
[2023-07-14 12:59:36] Starting data epoch 69 in logical epoch 69
[2023-07-14 12:59:36] [data] Shuffling data
[2023-07-14 12:59:36] [data] Done reading 20,192 sentences
[2023-07-14 12:59:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:01:02] Seen 20,188 samples
[2023-07-14 13:01:02] Starting data epoch 70 in logical epoch 70
[2023-07-14 13:01:02] [data] Shuffling data
[2023-07-14 13:01:02] [data] Done reading 20,192 sentences
[2023-07-14 13:01:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:02:27] Seen 20,188 samples
[2023-07-14 13:02:27] Starting data epoch 71 in logical epoch 71
[2023-07-14 13:02:27] Training finished
[2023-07-14 13:02:36] [valid] Ep. 71 : Up. 11576 : cross-entropy : 100.739 : stalled 1 times (last best: 100.389)
[2023-07-14 13:03:18] [valid] Ep. 71 : Up. 11576 : translation : 0 : new best
[2023-07-14 13:03:18] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:03:20] Saving Adam parameters
[2023-07-14 13:03:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:03:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:03:27] [marian] Running on node21.datos.cluster.uy as process 24822 with command line:
[2023-07-14 13:03:27] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 13:03:28] [config] after: 0e
[2023-07-14 13:03:28] [config] after-batches: 0
[2023-07-14 13:03:28] [config] after-epochs: 80
[2023-07-14 13:03:28] [config] all-caps-every: 0
[2023-07-14 13:03:28] [config] allow-unk: false
[2023-07-14 13:03:28] [config] authors: false
[2023-07-14 13:03:28] [config] beam-size: 6
[2023-07-14 13:03:28] [config] bert-class-symbol: "[CLS]"
[2023-07-14 13:03:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 13:03:28] [config] bert-masking-fraction: 0.15
[2023-07-14 13:03:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 13:03:28] [config] bert-train-type-embeddings: true
[2023-07-14 13:03:28] [config] bert-type-vocab-size: 2
[2023-07-14 13:03:28] [config] build-info: ""
[2023-07-14 13:03:28] [config] check-gradient-nan: false
[2023-07-14 13:03:28] [config] check-nan: false
[2023-07-14 13:03:28] [config] cite: false
[2023-07-14 13:03:28] [config] clip-norm: 1
[2023-07-14 13:03:28] [config] cost-scaling:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] cost-type: ce-sum
[2023-07-14 13:03:28] [config] cpu-threads: 0
[2023-07-14 13:03:28] [config] data-threads: 8
[2023-07-14 13:03:28] [config] data-weighting: ""
[2023-07-14 13:03:28] [config] data-weighting-type: sentence
[2023-07-14 13:03:28] [config] dec-cell: gru
[2023-07-14 13:03:28] [config] dec-cell-base-depth: 2
[2023-07-14 13:03:28] [config] dec-cell-high-depth: 1
[2023-07-14 13:03:28] [config] dec-depth: 1
[2023-07-14 13:03:28] [config] devices:
[2023-07-14 13:03:28] [config]   - 0
[2023-07-14 13:03:28] [config] dim-emb: 512
[2023-07-14 13:03:28] [config] dim-rnn: 1024
[2023-07-14 13:03:28] [config] dim-vocabs:
[2023-07-14 13:03:28] [config]   - 16384
[2023-07-14 13:03:28] [config]   - 16384
[2023-07-14 13:03:28] [config] disp-first: 0
[2023-07-14 13:03:28] [config] disp-freq: 1000u
[2023-07-14 13:03:28] [config] disp-label-counts: true
[2023-07-14 13:03:28] [config] dropout-rnn: 0.2
[2023-07-14 13:03:28] [config] dropout-src: 0.1
[2023-07-14 13:03:28] [config] dropout-trg: 0.1
[2023-07-14 13:03:28] [config] dump-config: ""
[2023-07-14 13:03:28] [config] dynamic-gradient-scaling:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] early-stopping: 10
[2023-07-14 13:03:28] [config] early-stopping-on: first
[2023-07-14 13:03:28] [config] embedding-fix-src: false
[2023-07-14 13:03:28] [config] embedding-fix-trg: false
[2023-07-14 13:03:28] [config] embedding-normalization: false
[2023-07-14 13:03:28] [config] embedding-vectors:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] enc-cell: gru
[2023-07-14 13:03:28] [config] enc-cell-depth: 1
[2023-07-14 13:03:28] [config] enc-depth: 1
[2023-07-14 13:03:28] [config] enc-type: bidirectional
[2023-07-14 13:03:28] [config] english-title-case-every: 0
[2023-07-14 13:03:28] [config] exponential-smoothing: 0
[2023-07-14 13:03:28] [config] factor-weight: 1
[2023-07-14 13:03:28] [config] factors-combine: sum
[2023-07-14 13:03:28] [config] factors-dim-emb: 0
[2023-07-14 13:03:28] [config] gradient-checkpointing: false
[2023-07-14 13:03:28] [config] gradient-norm-average-window: 100
[2023-07-14 13:03:28] [config] guided-alignment: none
[2023-07-14 13:03:28] [config] guided-alignment-cost: mse
[2023-07-14 13:03:28] [config] guided-alignment-weight: 0.1
[2023-07-14 13:03:28] [config] ignore-model-config: false
[2023-07-14 13:03:28] [config] input-types:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] interpolate-env-vars: false
[2023-07-14 13:03:28] [config] keep-best: false
[2023-07-14 13:03:28] [config] label-smoothing: 0
[2023-07-14 13:03:28] [config] layer-normalization: true
[2023-07-14 13:03:28] [config] learn-rate: 0.0001
[2023-07-14 13:03:28] [config] lemma-dependency: ""
[2023-07-14 13:03:28] [config] lemma-dim-emb: 0
[2023-07-14 13:03:28] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:03:28] [config] log-level: info
[2023-07-14 13:03:28] [config] log-time-zone: ""
[2023-07-14 13:03:28] [config] logical-epoch:
[2023-07-14 13:03:28] [config]   - 1e
[2023-07-14 13:03:28] [config]   - 0
[2023-07-14 13:03:28] [config] lr-decay: 0
[2023-07-14 13:03:28] [config] lr-decay-freq: 50000
[2023-07-14 13:03:28] [config] lr-decay-inv-sqrt:
[2023-07-14 13:03:28] [config]   - 0
[2023-07-14 13:03:28] [config] lr-decay-repeat-warmup: false
[2023-07-14 13:03:28] [config] lr-decay-reset-optimizer: false
[2023-07-14 13:03:28] [config] lr-decay-start:
[2023-07-14 13:03:28] [config]   - 10
[2023-07-14 13:03:28] [config]   - 1
[2023-07-14 13:03:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 13:03:28] [config] lr-report: false
[2023-07-14 13:03:28] [config] lr-warmup: 0
[2023-07-14 13:03:28] [config] lr-warmup-at-reload: false
[2023-07-14 13:03:28] [config] lr-warmup-cycle: false
[2023-07-14 13:03:28] [config] lr-warmup-start-rate: 0
[2023-07-14 13:03:28] [config] max-length: 200
[2023-07-14 13:03:28] [config] max-length-crop: false
[2023-07-14 13:03:28] [config] max-length-factor: 3
[2023-07-14 13:03:28] [config] maxi-batch: 100
[2023-07-14 13:03:28] [config] maxi-batch-sort: trg
[2023-07-14 13:03:28] [config] mini-batch: 64
[2023-07-14 13:03:28] [config] mini-batch-fit: true
[2023-07-14 13:03:28] [config] mini-batch-fit-step: 10
[2023-07-14 13:03:28] [config] mini-batch-round-up: true
[2023-07-14 13:03:28] [config] mini-batch-track-lr: false
[2023-07-14 13:03:28] [config] mini-batch-warmup: 0
[2023-07-14 13:03:28] [config] mini-batch-words: 0
[2023-07-14 13:03:28] [config] mini-batch-words-ref: 0
[2023-07-14 13:03:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:03:28] [config] multi-loss-type: sum
[2023-07-14 13:03:28] [config] n-best: false
[2023-07-14 13:03:28] [config] no-nccl: false
[2023-07-14 13:03:28] [config] no-reload: false
[2023-07-14 13:03:28] [config] no-restore-corpus: false
[2023-07-14 13:03:28] [config] normalize: 0.6
[2023-07-14 13:03:28] [config] normalize-gradient: false
[2023-07-14 13:03:28] [config] num-devices: 0
[2023-07-14 13:03:28] [config] optimizer: adam
[2023-07-14 13:03:28] [config] optimizer-delay: 1
[2023-07-14 13:03:28] [config] optimizer-params:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] output-omit-bias: false
[2023-07-14 13:03:28] [config] overwrite: false
[2023-07-14 13:03:28] [config] precision:
[2023-07-14 13:03:28] [config]   - float32
[2023-07-14 13:03:28] [config]   - float32
[2023-07-14 13:03:28] [config] pretrained-model: ""
[2023-07-14 13:03:28] [config] quantize-biases: false
[2023-07-14 13:03:28] [config] quantize-bits: 0
[2023-07-14 13:03:28] [config] quantize-log-based: false
[2023-07-14 13:03:28] [config] quantize-optimization-steps: 0
[2023-07-14 13:03:28] [config] quiet: false
[2023-07-14 13:03:28] [config] quiet-translation: true
[2023-07-14 13:03:28] [config] relative-paths: false
[2023-07-14 13:03:28] [config] right-left: false
[2023-07-14 13:03:28] [config] save-freq: 10000u
[2023-07-14 13:03:28] [config] seed: 1234
[2023-07-14 13:03:28] [config] sentencepiece-alphas:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] sentencepiece-max-lines: 2000000
[2023-07-14 13:03:28] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 13:03:28] [config] sharding: global
[2023-07-14 13:03:28] [config] shuffle: data
[2023-07-14 13:03:28] [config] shuffle-in-ram: false
[2023-07-14 13:03:28] [config] sigterm: save-and-exit
[2023-07-14 13:03:28] [config] skip: false
[2023-07-14 13:03:28] [config] sqlite: ""
[2023-07-14 13:03:28] [config] sqlite-drop: false
[2023-07-14 13:03:28] [config] sync-freq: 200u
[2023-07-14 13:03:28] [config] sync-sgd: false
[2023-07-14 13:03:28] [config] tempdir: /tmp
[2023-07-14 13:03:28] [config] tied-embeddings: false
[2023-07-14 13:03:28] [config] tied-embeddings-all: true
[2023-07-14 13:03:28] [config] tied-embeddings-src: false
[2023-07-14 13:03:28] [config] train-embedder-rank:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] train-sets:
[2023-07-14 13:03:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 13:03:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 13:03:28] [config] transformer-aan-activation: swish
[2023-07-14 13:03:28] [config] transformer-aan-depth: 2
[2023-07-14 13:03:28] [config] transformer-aan-nogate: false
[2023-07-14 13:03:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 13:03:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 13:03:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 13:03:28] [config] transformer-depth-scaling: false
[2023-07-14 13:03:28] [config] transformer-dim-aan: 2048
[2023-07-14 13:03:28] [config] transformer-dim-ffn: 2048
[2023-07-14 13:03:28] [config] transformer-dropout: 0
[2023-07-14 13:03:28] [config] transformer-dropout-attention: 0
[2023-07-14 13:03:28] [config] transformer-dropout-ffn: 0
[2023-07-14 13:03:28] [config] transformer-ffn-activation: swish
[2023-07-14 13:03:28] [config] transformer-ffn-depth: 2
[2023-07-14 13:03:28] [config] transformer-guided-alignment-layer: last
[2023-07-14 13:03:28] [config] transformer-heads: 8
[2023-07-14 13:03:28] [config] transformer-no-projection: false
[2023-07-14 13:03:28] [config] transformer-pool: false
[2023-07-14 13:03:28] [config] transformer-postprocess: dan
[2023-07-14 13:03:28] [config] transformer-postprocess-emb: d
[2023-07-14 13:03:28] [config] transformer-postprocess-top: ""
[2023-07-14 13:03:28] [config] transformer-preprocess: ""
[2023-07-14 13:03:28] [config] transformer-tied-layers:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] transformer-train-position-embeddings: false
[2023-07-14 13:03:28] [config] tsv: false
[2023-07-14 13:03:28] [config] tsv-fields: 0
[2023-07-14 13:03:28] [config] type: amun
[2023-07-14 13:03:28] [config] ulr: false
[2023-07-14 13:03:28] [config] ulr-dim-emb: 0
[2023-07-14 13:03:28] [config] ulr-dropout: 0
[2023-07-14 13:03:28] [config] ulr-keys-vectors: ""
[2023-07-14 13:03:28] [config] ulr-query-vectors: ""
[2023-07-14 13:03:28] [config] ulr-softmax-temperature: 1
[2023-07-14 13:03:28] [config] ulr-trainable-transformation: false
[2023-07-14 13:03:28] [config] unlikelihood-loss: false
[2023-07-14 13:03:28] [config] valid-freq: 5000000
[2023-07-14 13:03:28] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:03:28] [config] valid-max-length: 1000
[2023-07-14 13:03:28] [config] valid-metrics:
[2023-07-14 13:03:28] [config]   - cross-entropy
[2023-07-14 13:03:28] [config]   - translation
[2023-07-14 13:03:28] [config] valid-mini-batch: 32
[2023-07-14 13:03:28] [config] valid-reset-stalled: false
[2023-07-14 13:03:28] [config] valid-script-args:
[2023-07-14 13:03:28] [config]   []
[2023-07-14 13:03:28] [config] valid-script-path: ""
[2023-07-14 13:03:28] [config] valid-sets:
[2023-07-14 13:03:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 13:03:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 13:03:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 13:03:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:03:28] [config] vocabs:
[2023-07-14 13:03:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:03:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:03:28] [config] word-penalty: 0
[2023-07-14 13:03:28] [config] word-scores: false
[2023-07-14 13:03:28] [config] workspace: 3000
[2023-07-14 13:03:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:03:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:03:28] [training] Using single-device training
[2023-07-14 13:03:30] Synced seed 1234
[2023-07-14 13:03:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:03:30] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 13:03:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:03:30] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 13:03:30] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 13:03:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:03:31] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:03:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:03:31] [comm] Using global sharding
[2023-07-14 13:03:31] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:03:31] [training] Using 1 GPUs
[2023-07-14 13:03:31] [logits] Applying loss function for 1 factor(s)
[2023-07-14 13:03:31] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:03:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 13:03:31] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:04:55] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 13:04:55] [valid] No post-processing script given for validating translator
[2023-07-14 13:04:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:04:55] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:04:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:04:55] [comm] Using global sharding
[2023-07-14 13:04:55] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:04:55] [training] Using 1 GPUs
[2023-07-14 13:04:55] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:04:56] Loading Adam parameters
[2023-07-14 13:04:56] [memory] Reserving 322 MB, device gpu0
[2023-07-14 13:04:56] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:04:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:04:56] [data] Restoring the corpus state to epoch 71, batch 11576
[2023-07-14 13:04:56] [data] Shuffling data
[2023-07-14 13:04:56] [data] Done reading 20,192 sentences
[2023-07-14 13:04:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:04:56] Training started
[2023-07-14 13:04:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 13:04:56] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:04:57] Parameter type float32, optimization type float32, casting types false
[2023-07-14 13:06:21] Seen 20,188 samples
[2023-07-14 13:06:21] Starting data epoch 72 in logical epoch 72
[2023-07-14 13:06:21] [data] Shuffling data
[2023-07-14 13:06:21] [data] Done reading 20,192 sentences
[2023-07-14 13:06:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:07:47] Seen 20,188 samples
[2023-07-14 13:07:47] Starting data epoch 73 in logical epoch 73
[2023-07-14 13:07:47] [data] Shuffling data
[2023-07-14 13:07:47] [data] Done reading 20,192 sentences
[2023-07-14 13:07:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:08:35] Ep. 73 : Up. 12000 : Sen. 11,267 : Cost 1.46130574 * 3,747,723 @ 2,241 after 44,952,380 : Time 220.08s : 17028.64 words/s : gNorm 1.2462
[2023-07-14 13:09:13] Seen 20,188 samples
[2023-07-14 13:09:13] Starting data epoch 74 in logical epoch 74
[2023-07-14 13:09:13] [data] Shuffling data
[2023-07-14 13:09:13] [data] Done reading 20,192 sentences
[2023-07-14 13:09:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:10:39] Seen 20,188 samples
[2023-07-14 13:10:39] Starting data epoch 75 in logical epoch 75
[2023-07-14 13:10:39] [data] Shuffling data
[2023-07-14 13:10:39] [data] Done reading 20,192 sentences
[2023-07-14 13:10:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:12:06] Seen 20,188 samples
[2023-07-14 13:12:06] Starting data epoch 76 in logical epoch 76
[2023-07-14 13:12:06] [data] Shuffling data
[2023-07-14 13:12:06] [data] Done reading 20,192 sentences
[2023-07-14 13:12:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:13:30] Seen 20,188 samples
[2023-07-14 13:13:30] Starting data epoch 77 in logical epoch 77
[2023-07-14 13:13:30] [data] Shuffling data
[2023-07-14 13:13:30] [data] Done reading 20,192 sentences
[2023-07-14 13:13:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:14:54] Seen 20,188 samples
[2023-07-14 13:14:54] Starting data epoch 78 in logical epoch 78
[2023-07-14 13:14:54] [data] Shuffling data
[2023-07-14 13:14:54] [data] Done reading 20,192 sentences
[2023-07-14 13:14:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:16:19] Seen 20,188 samples
[2023-07-14 13:16:19] Starting data epoch 79 in logical epoch 79
[2023-07-14 13:16:19] [data] Shuffling data
[2023-07-14 13:16:19] [data] Done reading 20,192 sentences
[2023-07-14 13:16:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:17:10] Ep. 79 : Up. 13000 : Sen. 11,937 : Cost 1.34388804 * 3,746,855 @ 4,191 after 48,699,235 : Time 515.74s : 7265.00 words/s : gNorm 1.1794
[2023-07-14 13:17:44] Seen 20,188 samples
[2023-07-14 13:17:44] Starting data epoch 80 in logical epoch 80
[2023-07-14 13:17:44] [data] Shuffling data
[2023-07-14 13:17:44] [data] Done reading 20,192 sentences
[2023-07-14 13:17:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:19:10] Seen 20,188 samples
[2023-07-14 13:19:10] Starting data epoch 81 in logical epoch 81
[2023-07-14 13:19:10] Training finished
[2023-07-14 13:19:19] [valid] Ep. 81 : Up. 13233 : cross-entropy : 101.574 : stalled 2 times (last best: 100.389)
[2023-07-14 13:20:04] [valid] Ep. 81 : Up. 13233 : translation : 0 : new best
[2023-07-14 13:20:04] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:20:06] Saving Adam parameters
[2023-07-14 13:20:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:20:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:20:13] [marian] Running on node21.datos.cluster.uy as process 25876 with command line:
[2023-07-14 13:20:13] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 13:20:13] [config] after: 0e
[2023-07-14 13:20:13] [config] after-batches: 0
[2023-07-14 13:20:13] [config] after-epochs: 90
[2023-07-14 13:20:13] [config] all-caps-every: 0
[2023-07-14 13:20:13] [config] allow-unk: false
[2023-07-14 13:20:13] [config] authors: false
[2023-07-14 13:20:13] [config] beam-size: 6
[2023-07-14 13:20:13] [config] bert-class-symbol: "[CLS]"
[2023-07-14 13:20:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 13:20:13] [config] bert-masking-fraction: 0.15
[2023-07-14 13:20:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 13:20:13] [config] bert-train-type-embeddings: true
[2023-07-14 13:20:13] [config] bert-type-vocab-size: 2
[2023-07-14 13:20:13] [config] build-info: ""
[2023-07-14 13:20:13] [config] check-gradient-nan: false
[2023-07-14 13:20:13] [config] check-nan: false
[2023-07-14 13:20:13] [config] cite: false
[2023-07-14 13:20:13] [config] clip-norm: 1
[2023-07-14 13:20:13] [config] cost-scaling:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] cost-type: ce-sum
[2023-07-14 13:20:13] [config] cpu-threads: 0
[2023-07-14 13:20:13] [config] data-threads: 8
[2023-07-14 13:20:13] [config] data-weighting: ""
[2023-07-14 13:20:13] [config] data-weighting-type: sentence
[2023-07-14 13:20:13] [config] dec-cell: gru
[2023-07-14 13:20:13] [config] dec-cell-base-depth: 2
[2023-07-14 13:20:13] [config] dec-cell-high-depth: 1
[2023-07-14 13:20:13] [config] dec-depth: 1
[2023-07-14 13:20:13] [config] devices:
[2023-07-14 13:20:13] [config]   - 0
[2023-07-14 13:20:13] [config] dim-emb: 512
[2023-07-14 13:20:13] [config] dim-rnn: 1024
[2023-07-14 13:20:13] [config] dim-vocabs:
[2023-07-14 13:20:13] [config]   - 16384
[2023-07-14 13:20:13] [config]   - 16384
[2023-07-14 13:20:13] [config] disp-first: 0
[2023-07-14 13:20:13] [config] disp-freq: 1000u
[2023-07-14 13:20:13] [config] disp-label-counts: true
[2023-07-14 13:20:13] [config] dropout-rnn: 0.2
[2023-07-14 13:20:13] [config] dropout-src: 0.1
[2023-07-14 13:20:13] [config] dropout-trg: 0.1
[2023-07-14 13:20:13] [config] dump-config: ""
[2023-07-14 13:20:13] [config] dynamic-gradient-scaling:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] early-stopping: 10
[2023-07-14 13:20:13] [config] early-stopping-on: first
[2023-07-14 13:20:13] [config] embedding-fix-src: false
[2023-07-14 13:20:13] [config] embedding-fix-trg: false
[2023-07-14 13:20:13] [config] embedding-normalization: false
[2023-07-14 13:20:13] [config] embedding-vectors:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] enc-cell: gru
[2023-07-14 13:20:13] [config] enc-cell-depth: 1
[2023-07-14 13:20:13] [config] enc-depth: 1
[2023-07-14 13:20:13] [config] enc-type: bidirectional
[2023-07-14 13:20:13] [config] english-title-case-every: 0
[2023-07-14 13:20:13] [config] exponential-smoothing: 0
[2023-07-14 13:20:13] [config] factor-weight: 1
[2023-07-14 13:20:13] [config] factors-combine: sum
[2023-07-14 13:20:13] [config] factors-dim-emb: 0
[2023-07-14 13:20:13] [config] gradient-checkpointing: false
[2023-07-14 13:20:13] [config] gradient-norm-average-window: 100
[2023-07-14 13:20:13] [config] guided-alignment: none
[2023-07-14 13:20:13] [config] guided-alignment-cost: mse
[2023-07-14 13:20:13] [config] guided-alignment-weight: 0.1
[2023-07-14 13:20:13] [config] ignore-model-config: false
[2023-07-14 13:20:13] [config] input-types:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] interpolate-env-vars: false
[2023-07-14 13:20:13] [config] keep-best: false
[2023-07-14 13:20:13] [config] label-smoothing: 0
[2023-07-14 13:20:13] [config] layer-normalization: true
[2023-07-14 13:20:13] [config] learn-rate: 0.0001
[2023-07-14 13:20:13] [config] lemma-dependency: ""
[2023-07-14 13:20:13] [config] lemma-dim-emb: 0
[2023-07-14 13:20:13] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:20:13] [config] log-level: info
[2023-07-14 13:20:13] [config] log-time-zone: ""
[2023-07-14 13:20:13] [config] logical-epoch:
[2023-07-14 13:20:13] [config]   - 1e
[2023-07-14 13:20:13] [config]   - 0
[2023-07-14 13:20:13] [config] lr-decay: 0
[2023-07-14 13:20:13] [config] lr-decay-freq: 50000
[2023-07-14 13:20:13] [config] lr-decay-inv-sqrt:
[2023-07-14 13:20:13] [config]   - 0
[2023-07-14 13:20:13] [config] lr-decay-repeat-warmup: false
[2023-07-14 13:20:13] [config] lr-decay-reset-optimizer: false
[2023-07-14 13:20:13] [config] lr-decay-start:
[2023-07-14 13:20:13] [config]   - 10
[2023-07-14 13:20:13] [config]   - 1
[2023-07-14 13:20:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 13:20:13] [config] lr-report: false
[2023-07-14 13:20:13] [config] lr-warmup: 0
[2023-07-14 13:20:13] [config] lr-warmup-at-reload: false
[2023-07-14 13:20:13] [config] lr-warmup-cycle: false
[2023-07-14 13:20:13] [config] lr-warmup-start-rate: 0
[2023-07-14 13:20:13] [config] max-length: 200
[2023-07-14 13:20:13] [config] max-length-crop: false
[2023-07-14 13:20:13] [config] max-length-factor: 3
[2023-07-14 13:20:13] [config] maxi-batch: 100
[2023-07-14 13:20:13] [config] maxi-batch-sort: trg
[2023-07-14 13:20:13] [config] mini-batch: 64
[2023-07-14 13:20:13] [config] mini-batch-fit: true
[2023-07-14 13:20:13] [config] mini-batch-fit-step: 10
[2023-07-14 13:20:13] [config] mini-batch-round-up: true
[2023-07-14 13:20:13] [config] mini-batch-track-lr: false
[2023-07-14 13:20:13] [config] mini-batch-warmup: 0
[2023-07-14 13:20:13] [config] mini-batch-words: 0
[2023-07-14 13:20:13] [config] mini-batch-words-ref: 0
[2023-07-14 13:20:13] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:20:13] [config] multi-loss-type: sum
[2023-07-14 13:20:13] [config] n-best: false
[2023-07-14 13:20:13] [config] no-nccl: false
[2023-07-14 13:20:13] [config] no-reload: false
[2023-07-14 13:20:13] [config] no-restore-corpus: false
[2023-07-14 13:20:13] [config] normalize: 0.6
[2023-07-14 13:20:13] [config] normalize-gradient: false
[2023-07-14 13:20:13] [config] num-devices: 0
[2023-07-14 13:20:13] [config] optimizer: adam
[2023-07-14 13:20:13] [config] optimizer-delay: 1
[2023-07-14 13:20:13] [config] optimizer-params:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] output-omit-bias: false
[2023-07-14 13:20:13] [config] overwrite: false
[2023-07-14 13:20:13] [config] precision:
[2023-07-14 13:20:13] [config]   - float32
[2023-07-14 13:20:13] [config]   - float32
[2023-07-14 13:20:13] [config] pretrained-model: ""
[2023-07-14 13:20:13] [config] quantize-biases: false
[2023-07-14 13:20:13] [config] quantize-bits: 0
[2023-07-14 13:20:13] [config] quantize-log-based: false
[2023-07-14 13:20:13] [config] quantize-optimization-steps: 0
[2023-07-14 13:20:13] [config] quiet: false
[2023-07-14 13:20:13] [config] quiet-translation: true
[2023-07-14 13:20:13] [config] relative-paths: false
[2023-07-14 13:20:13] [config] right-left: false
[2023-07-14 13:20:13] [config] save-freq: 10000u
[2023-07-14 13:20:13] [config] seed: 1234
[2023-07-14 13:20:13] [config] sentencepiece-alphas:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] sentencepiece-max-lines: 2000000
[2023-07-14 13:20:13] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 13:20:13] [config] sharding: global
[2023-07-14 13:20:13] [config] shuffle: data
[2023-07-14 13:20:13] [config] shuffle-in-ram: false
[2023-07-14 13:20:13] [config] sigterm: save-and-exit
[2023-07-14 13:20:13] [config] skip: false
[2023-07-14 13:20:13] [config] sqlite: ""
[2023-07-14 13:20:13] [config] sqlite-drop: false
[2023-07-14 13:20:13] [config] sync-freq: 200u
[2023-07-14 13:20:13] [config] sync-sgd: false
[2023-07-14 13:20:13] [config] tempdir: /tmp
[2023-07-14 13:20:13] [config] tied-embeddings: false
[2023-07-14 13:20:13] [config] tied-embeddings-all: true
[2023-07-14 13:20:13] [config] tied-embeddings-src: false
[2023-07-14 13:20:13] [config] train-embedder-rank:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] train-sets:
[2023-07-14 13:20:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 13:20:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 13:20:13] [config] transformer-aan-activation: swish
[2023-07-14 13:20:13] [config] transformer-aan-depth: 2
[2023-07-14 13:20:13] [config] transformer-aan-nogate: false
[2023-07-14 13:20:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 13:20:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 13:20:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 13:20:13] [config] transformer-depth-scaling: false
[2023-07-14 13:20:13] [config] transformer-dim-aan: 2048
[2023-07-14 13:20:13] [config] transformer-dim-ffn: 2048
[2023-07-14 13:20:13] [config] transformer-dropout: 0
[2023-07-14 13:20:13] [config] transformer-dropout-attention: 0
[2023-07-14 13:20:13] [config] transformer-dropout-ffn: 0
[2023-07-14 13:20:13] [config] transformer-ffn-activation: swish
[2023-07-14 13:20:13] [config] transformer-ffn-depth: 2
[2023-07-14 13:20:13] [config] transformer-guided-alignment-layer: last
[2023-07-14 13:20:13] [config] transformer-heads: 8
[2023-07-14 13:20:13] [config] transformer-no-projection: false
[2023-07-14 13:20:13] [config] transformer-pool: false
[2023-07-14 13:20:13] [config] transformer-postprocess: dan
[2023-07-14 13:20:13] [config] transformer-postprocess-emb: d
[2023-07-14 13:20:13] [config] transformer-postprocess-top: ""
[2023-07-14 13:20:13] [config] transformer-preprocess: ""
[2023-07-14 13:20:13] [config] transformer-tied-layers:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] transformer-train-position-embeddings: false
[2023-07-14 13:20:13] [config] tsv: false
[2023-07-14 13:20:13] [config] tsv-fields: 0
[2023-07-14 13:20:13] [config] type: amun
[2023-07-14 13:20:13] [config] ulr: false
[2023-07-14 13:20:13] [config] ulr-dim-emb: 0
[2023-07-14 13:20:13] [config] ulr-dropout: 0
[2023-07-14 13:20:13] [config] ulr-keys-vectors: ""
[2023-07-14 13:20:13] [config] ulr-query-vectors: ""
[2023-07-14 13:20:13] [config] ulr-softmax-temperature: 1
[2023-07-14 13:20:13] [config] ulr-trainable-transformation: false
[2023-07-14 13:20:13] [config] unlikelihood-loss: false
[2023-07-14 13:20:13] [config] valid-freq: 5000000
[2023-07-14 13:20:13] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:20:13] [config] valid-max-length: 1000
[2023-07-14 13:20:13] [config] valid-metrics:
[2023-07-14 13:20:13] [config]   - cross-entropy
[2023-07-14 13:20:13] [config]   - translation
[2023-07-14 13:20:13] [config] valid-mini-batch: 32
[2023-07-14 13:20:13] [config] valid-reset-stalled: false
[2023-07-14 13:20:13] [config] valid-script-args:
[2023-07-14 13:20:13] [config]   []
[2023-07-14 13:20:13] [config] valid-script-path: ""
[2023-07-14 13:20:13] [config] valid-sets:
[2023-07-14 13:20:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 13:20:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 13:20:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 13:20:13] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:20:13] [config] vocabs:
[2023-07-14 13:20:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:20:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:20:13] [config] word-penalty: 0
[2023-07-14 13:20:13] [config] word-scores: false
[2023-07-14 13:20:13] [config] workspace: 3000
[2023-07-14 13:20:13] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:20:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:20:13] [training] Using single-device training
[2023-07-14 13:20:14] Synced seed 1234
[2023-07-14 13:20:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:20:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 13:20:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:20:14] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 13:20:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 13:20:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:20:15] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:20:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:20:15] [comm] Using global sharding
[2023-07-14 13:20:15] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:20:15] [training] Using 1 GPUs
[2023-07-14 13:20:15] [logits] Applying loss function for 1 factor(s)
[2023-07-14 13:20:15] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:20:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 13:20:15] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:21:40] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 13:21:40] [valid] No post-processing script given for validating translator
[2023-07-14 13:21:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:21:40] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:21:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:21:40] [comm] Using global sharding
[2023-07-14 13:21:40] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:21:40] [training] Using 1 GPUs
[2023-07-14 13:21:40] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:21:41] Loading Adam parameters
[2023-07-14 13:21:41] [memory] Reserving 322 MB, device gpu0
[2023-07-14 13:21:41] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:21:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:21:41] [data] Restoring the corpus state to epoch 81, batch 13233
[2023-07-14 13:21:41] [data] Shuffling data
[2023-07-14 13:21:42] [data] Done reading 20,192 sentences
[2023-07-14 13:21:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:21:42] Training started
[2023-07-14 13:21:42] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 13:21:42] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:21:42] Parameter type float32, optimization type float32, casting types false
[2023-07-14 13:23:06] Seen 20,188 samples
[2023-07-14 13:23:06] Starting data epoch 82 in logical epoch 82
[2023-07-14 13:23:06] [data] Shuffling data
[2023-07-14 13:23:06] [data] Done reading 20,192 sentences
[2023-07-14 13:23:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:24:31] Seen 20,188 samples
[2023-07-14 13:24:31] Starting data epoch 83 in logical epoch 83
[2023-07-14 13:24:31] [data] Shuffling data
[2023-07-14 13:24:31] [data] Done reading 20,192 sentences
[2023-07-14 13:24:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:25:57] Seen 20,188 samples
[2023-07-14 13:25:57] Starting data epoch 84 in logical epoch 84
[2023-07-14 13:25:57] [data] Shuffling data
[2023-07-14 13:25:57] [data] Done reading 20,192 sentences
[2023-07-14 13:25:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:27:22] Seen 20,188 samples
[2023-07-14 13:27:22] Starting data epoch 85 in logical epoch 85
[2023-07-14 13:27:22] [data] Shuffling data
[2023-07-14 13:27:22] [data] Done reading 20,192 sentences
[2023-07-14 13:27:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:28:17] Ep. 85 : Up. 14000 : Sen. 13,318 : Cost 1.23621404 * 3,746,614 @ 4,685 after 52,445,849 : Time 396.81s : 9441.93 words/s : gNorm 1.1911
[2023-07-14 13:28:48] Seen 20,188 samples
[2023-07-14 13:28:48] Starting data epoch 86 in logical epoch 86
[2023-07-14 13:28:48] [data] Shuffling data
[2023-07-14 13:28:48] [data] Done reading 20,192 sentences
[2023-07-14 13:28:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:30:13] Seen 20,188 samples
[2023-07-14 13:30:13] Starting data epoch 87 in logical epoch 87
[2023-07-14 13:30:13] [data] Shuffling data
[2023-07-14 13:30:13] [data] Done reading 20,192 sentences
[2023-07-14 13:30:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:31:39] Seen 20,188 samples
[2023-07-14 13:31:39] Starting data epoch 88 in logical epoch 88
[2023-07-14 13:31:39] [data] Shuffling data
[2023-07-14 13:31:39] [data] Done reading 20,192 sentences
[2023-07-14 13:31:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:33:04] Seen 20,188 samples
[2023-07-14 13:33:04] Starting data epoch 89 in logical epoch 89
[2023-07-14 13:33:04] [data] Shuffling data
[2023-07-14 13:33:04] [data] Done reading 20,192 sentences
[2023-07-14 13:33:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:34:30] Seen 20,188 samples
[2023-07-14 13:34:30] Starting data epoch 90 in logical epoch 90
[2023-07-14 13:34:30] [data] Shuffling data
[2023-07-14 13:34:30] [data] Done reading 20,192 sentences
[2023-07-14 13:34:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:35:55] Seen 20,188 samples
[2023-07-14 13:35:55] Starting data epoch 91 in logical epoch 91
[2023-07-14 13:35:55] Training finished
[2023-07-14 13:36:04] [valid] Ep. 91 : Up. 14886 : cross-entropy : 102.557 : stalled 3 times (last best: 100.389)
[2023-07-14 13:36:47] [valid] Ep. 91 : Up. 14886 : translation : 0 : new best
[2023-07-14 13:36:47] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:36:49] Saving Adam parameters
[2023-07-14 13:36:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:36:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:36:57] [marian] Running on node21.datos.cluster.uy as process 27178 with command line:
[2023-07-14 13:36:57] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 13:36:57] [config] after: 0e
[2023-07-14 13:36:57] [config] after-batches: 0
[2023-07-14 13:36:57] [config] after-epochs: 100
[2023-07-14 13:36:57] [config] all-caps-every: 0
[2023-07-14 13:36:57] [config] allow-unk: false
[2023-07-14 13:36:57] [config] authors: false
[2023-07-14 13:36:57] [config] beam-size: 6
[2023-07-14 13:36:57] [config] bert-class-symbol: "[CLS]"
[2023-07-14 13:36:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 13:36:57] [config] bert-masking-fraction: 0.15
[2023-07-14 13:36:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 13:36:57] [config] bert-train-type-embeddings: true
[2023-07-14 13:36:57] [config] bert-type-vocab-size: 2
[2023-07-14 13:36:57] [config] build-info: ""
[2023-07-14 13:36:57] [config] check-gradient-nan: false
[2023-07-14 13:36:57] [config] check-nan: false
[2023-07-14 13:36:57] [config] cite: false
[2023-07-14 13:36:57] [config] clip-norm: 1
[2023-07-14 13:36:57] [config] cost-scaling:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] cost-type: ce-sum
[2023-07-14 13:36:57] [config] cpu-threads: 0
[2023-07-14 13:36:57] [config] data-threads: 8
[2023-07-14 13:36:57] [config] data-weighting: ""
[2023-07-14 13:36:57] [config] data-weighting-type: sentence
[2023-07-14 13:36:57] [config] dec-cell: gru
[2023-07-14 13:36:57] [config] dec-cell-base-depth: 2
[2023-07-14 13:36:57] [config] dec-cell-high-depth: 1
[2023-07-14 13:36:57] [config] dec-depth: 1
[2023-07-14 13:36:57] [config] devices:
[2023-07-14 13:36:57] [config]   - 0
[2023-07-14 13:36:57] [config] dim-emb: 512
[2023-07-14 13:36:57] [config] dim-rnn: 1024
[2023-07-14 13:36:57] [config] dim-vocabs:
[2023-07-14 13:36:57] [config]   - 16384
[2023-07-14 13:36:57] [config]   - 16384
[2023-07-14 13:36:57] [config] disp-first: 0
[2023-07-14 13:36:57] [config] disp-freq: 1000u
[2023-07-14 13:36:57] [config] disp-label-counts: true
[2023-07-14 13:36:57] [config] dropout-rnn: 0.2
[2023-07-14 13:36:57] [config] dropout-src: 0.1
[2023-07-14 13:36:57] [config] dropout-trg: 0.1
[2023-07-14 13:36:57] [config] dump-config: ""
[2023-07-14 13:36:57] [config] dynamic-gradient-scaling:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] early-stopping: 10
[2023-07-14 13:36:57] [config] early-stopping-on: first
[2023-07-14 13:36:57] [config] embedding-fix-src: false
[2023-07-14 13:36:57] [config] embedding-fix-trg: false
[2023-07-14 13:36:57] [config] embedding-normalization: false
[2023-07-14 13:36:57] [config] embedding-vectors:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] enc-cell: gru
[2023-07-14 13:36:57] [config] enc-cell-depth: 1
[2023-07-14 13:36:57] [config] enc-depth: 1
[2023-07-14 13:36:57] [config] enc-type: bidirectional
[2023-07-14 13:36:57] [config] english-title-case-every: 0
[2023-07-14 13:36:57] [config] exponential-smoothing: 0
[2023-07-14 13:36:57] [config] factor-weight: 1
[2023-07-14 13:36:57] [config] factors-combine: sum
[2023-07-14 13:36:57] [config] factors-dim-emb: 0
[2023-07-14 13:36:57] [config] gradient-checkpointing: false
[2023-07-14 13:36:57] [config] gradient-norm-average-window: 100
[2023-07-14 13:36:57] [config] guided-alignment: none
[2023-07-14 13:36:57] [config] guided-alignment-cost: mse
[2023-07-14 13:36:57] [config] guided-alignment-weight: 0.1
[2023-07-14 13:36:57] [config] ignore-model-config: false
[2023-07-14 13:36:57] [config] input-types:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] interpolate-env-vars: false
[2023-07-14 13:36:57] [config] keep-best: false
[2023-07-14 13:36:57] [config] label-smoothing: 0
[2023-07-14 13:36:57] [config] layer-normalization: true
[2023-07-14 13:36:57] [config] learn-rate: 0.0001
[2023-07-14 13:36:57] [config] lemma-dependency: ""
[2023-07-14 13:36:57] [config] lemma-dim-emb: 0
[2023-07-14 13:36:57] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:36:57] [config] log-level: info
[2023-07-14 13:36:57] [config] log-time-zone: ""
[2023-07-14 13:36:57] [config] logical-epoch:
[2023-07-14 13:36:57] [config]   - 1e
[2023-07-14 13:36:57] [config]   - 0
[2023-07-14 13:36:57] [config] lr-decay: 0
[2023-07-14 13:36:57] [config] lr-decay-freq: 50000
[2023-07-14 13:36:57] [config] lr-decay-inv-sqrt:
[2023-07-14 13:36:57] [config]   - 0
[2023-07-14 13:36:57] [config] lr-decay-repeat-warmup: false
[2023-07-14 13:36:57] [config] lr-decay-reset-optimizer: false
[2023-07-14 13:36:57] [config] lr-decay-start:
[2023-07-14 13:36:57] [config]   - 10
[2023-07-14 13:36:57] [config]   - 1
[2023-07-14 13:36:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 13:36:57] [config] lr-report: false
[2023-07-14 13:36:57] [config] lr-warmup: 0
[2023-07-14 13:36:57] [config] lr-warmup-at-reload: false
[2023-07-14 13:36:57] [config] lr-warmup-cycle: false
[2023-07-14 13:36:57] [config] lr-warmup-start-rate: 0
[2023-07-14 13:36:57] [config] max-length: 200
[2023-07-14 13:36:57] [config] max-length-crop: false
[2023-07-14 13:36:57] [config] max-length-factor: 3
[2023-07-14 13:36:57] [config] maxi-batch: 100
[2023-07-14 13:36:57] [config] maxi-batch-sort: trg
[2023-07-14 13:36:57] [config] mini-batch: 64
[2023-07-14 13:36:57] [config] mini-batch-fit: true
[2023-07-14 13:36:57] [config] mini-batch-fit-step: 10
[2023-07-14 13:36:57] [config] mini-batch-round-up: true
[2023-07-14 13:36:57] [config] mini-batch-track-lr: false
[2023-07-14 13:36:57] [config] mini-batch-warmup: 0
[2023-07-14 13:36:57] [config] mini-batch-words: 0
[2023-07-14 13:36:57] [config] mini-batch-words-ref: 0
[2023-07-14 13:36:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:36:57] [config] multi-loss-type: sum
[2023-07-14 13:36:57] [config] n-best: false
[2023-07-14 13:36:57] [config] no-nccl: false
[2023-07-14 13:36:57] [config] no-reload: false
[2023-07-14 13:36:57] [config] no-restore-corpus: false
[2023-07-14 13:36:57] [config] normalize: 0.6
[2023-07-14 13:36:57] [config] normalize-gradient: false
[2023-07-14 13:36:57] [config] num-devices: 0
[2023-07-14 13:36:57] [config] optimizer: adam
[2023-07-14 13:36:57] [config] optimizer-delay: 1
[2023-07-14 13:36:57] [config] optimizer-params:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] output-omit-bias: false
[2023-07-14 13:36:57] [config] overwrite: false
[2023-07-14 13:36:57] [config] precision:
[2023-07-14 13:36:57] [config]   - float32
[2023-07-14 13:36:57] [config]   - float32
[2023-07-14 13:36:57] [config] pretrained-model: ""
[2023-07-14 13:36:57] [config] quantize-biases: false
[2023-07-14 13:36:57] [config] quantize-bits: 0
[2023-07-14 13:36:57] [config] quantize-log-based: false
[2023-07-14 13:36:57] [config] quantize-optimization-steps: 0
[2023-07-14 13:36:57] [config] quiet: false
[2023-07-14 13:36:57] [config] quiet-translation: true
[2023-07-14 13:36:57] [config] relative-paths: false
[2023-07-14 13:36:57] [config] right-left: false
[2023-07-14 13:36:57] [config] save-freq: 10000u
[2023-07-14 13:36:57] [config] seed: 1234
[2023-07-14 13:36:57] [config] sentencepiece-alphas:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] sentencepiece-max-lines: 2000000
[2023-07-14 13:36:57] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 13:36:57] [config] sharding: global
[2023-07-14 13:36:57] [config] shuffle: data
[2023-07-14 13:36:57] [config] shuffle-in-ram: false
[2023-07-14 13:36:57] [config] sigterm: save-and-exit
[2023-07-14 13:36:57] [config] skip: false
[2023-07-14 13:36:57] [config] sqlite: ""
[2023-07-14 13:36:57] [config] sqlite-drop: false
[2023-07-14 13:36:57] [config] sync-freq: 200u
[2023-07-14 13:36:57] [config] sync-sgd: false
[2023-07-14 13:36:57] [config] tempdir: /tmp
[2023-07-14 13:36:57] [config] tied-embeddings: false
[2023-07-14 13:36:57] [config] tied-embeddings-all: true
[2023-07-14 13:36:57] [config] tied-embeddings-src: false
[2023-07-14 13:36:57] [config] train-embedder-rank:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] train-sets:
[2023-07-14 13:36:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 13:36:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 13:36:57] [config] transformer-aan-activation: swish
[2023-07-14 13:36:57] [config] transformer-aan-depth: 2
[2023-07-14 13:36:57] [config] transformer-aan-nogate: false
[2023-07-14 13:36:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 13:36:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 13:36:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 13:36:57] [config] transformer-depth-scaling: false
[2023-07-14 13:36:57] [config] transformer-dim-aan: 2048
[2023-07-14 13:36:57] [config] transformer-dim-ffn: 2048
[2023-07-14 13:36:57] [config] transformer-dropout: 0
[2023-07-14 13:36:57] [config] transformer-dropout-attention: 0
[2023-07-14 13:36:57] [config] transformer-dropout-ffn: 0
[2023-07-14 13:36:57] [config] transformer-ffn-activation: swish
[2023-07-14 13:36:57] [config] transformer-ffn-depth: 2
[2023-07-14 13:36:57] [config] transformer-guided-alignment-layer: last
[2023-07-14 13:36:57] [config] transformer-heads: 8
[2023-07-14 13:36:57] [config] transformer-no-projection: false
[2023-07-14 13:36:57] [config] transformer-pool: false
[2023-07-14 13:36:57] [config] transformer-postprocess: dan
[2023-07-14 13:36:57] [config] transformer-postprocess-emb: d
[2023-07-14 13:36:57] [config] transformer-postprocess-top: ""
[2023-07-14 13:36:57] [config] transformer-preprocess: ""
[2023-07-14 13:36:57] [config] transformer-tied-layers:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] transformer-train-position-embeddings: false
[2023-07-14 13:36:57] [config] tsv: false
[2023-07-14 13:36:57] [config] tsv-fields: 0
[2023-07-14 13:36:57] [config] type: amun
[2023-07-14 13:36:57] [config] ulr: false
[2023-07-14 13:36:57] [config] ulr-dim-emb: 0
[2023-07-14 13:36:57] [config] ulr-dropout: 0
[2023-07-14 13:36:57] [config] ulr-keys-vectors: ""
[2023-07-14 13:36:57] [config] ulr-query-vectors: ""
[2023-07-14 13:36:57] [config] ulr-softmax-temperature: 1
[2023-07-14 13:36:57] [config] ulr-trainable-transformation: false
[2023-07-14 13:36:57] [config] unlikelihood-loss: false
[2023-07-14 13:36:57] [config] valid-freq: 5000000
[2023-07-14 13:36:57] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:36:57] [config] valid-max-length: 1000
[2023-07-14 13:36:57] [config] valid-metrics:
[2023-07-14 13:36:57] [config]   - cross-entropy
[2023-07-14 13:36:57] [config]   - translation
[2023-07-14 13:36:57] [config] valid-mini-batch: 32
[2023-07-14 13:36:57] [config] valid-reset-stalled: false
[2023-07-14 13:36:57] [config] valid-script-args:
[2023-07-14 13:36:57] [config]   []
[2023-07-14 13:36:57] [config] valid-script-path: ""
[2023-07-14 13:36:57] [config] valid-sets:
[2023-07-14 13:36:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 13:36:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 13:36:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 13:36:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:36:57] [config] vocabs:
[2023-07-14 13:36:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:36:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:36:57] [config] word-penalty: 0
[2023-07-14 13:36:57] [config] word-scores: false
[2023-07-14 13:36:57] [config] workspace: 3000
[2023-07-14 13:36:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:36:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:36:57] [training] Using single-device training
[2023-07-14 13:36:57] Synced seed 1234
[2023-07-14 13:36:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:36:57] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 13:36:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:36:57] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 13:36:57] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 13:36:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:36:58] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:36:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:36:58] [comm] Using global sharding
[2023-07-14 13:36:58] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:36:58] [training] Using 1 GPUs
[2023-07-14 13:36:58] [logits] Applying loss function for 1 factor(s)
[2023-07-14 13:36:58] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:36:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 13:36:59] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:38:23] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 13:38:23] [valid] No post-processing script given for validating translator
[2023-07-14 13:38:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:38:23] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:38:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:38:23] [comm] Using global sharding
[2023-07-14 13:38:23] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:38:23] [training] Using 1 GPUs
[2023-07-14 13:38:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:38:24] Loading Adam parameters
[2023-07-14 13:38:25] [memory] Reserving 322 MB, device gpu0
[2023-07-14 13:38:25] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:38:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:38:25] [data] Restoring the corpus state to epoch 91, batch 14886
[2023-07-14 13:38:25] [data] Shuffling data
[2023-07-14 13:38:25] [data] Done reading 20,192 sentences
[2023-07-14 13:38:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:38:25] Training started
[2023-07-14 13:38:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 13:38:25] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:38:25] Parameter type float32, optimization type float32, casting types false
[2023-07-14 13:39:24] Ep. 91 : Up. 15000 : Sen. 13,934 : Cost 1.14203894 * 3,748,524 @ 4,911 after 56,194,373 : Time 60.94s : 61511.31 words/s : gNorm 1.2004
[2023-07-14 13:39:50] Seen 20,188 samples
[2023-07-14 13:39:50] Starting data epoch 92 in logical epoch 92
[2023-07-14 13:39:50] [data] Shuffling data
[2023-07-14 13:39:50] [data] Done reading 20,192 sentences
[2023-07-14 13:39:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:41:15] Seen 20,188 samples
[2023-07-14 13:41:15] Starting data epoch 93 in logical epoch 93
[2023-07-14 13:41:15] [data] Shuffling data
[2023-07-14 13:41:15] [data] Done reading 20,192 sentences
[2023-07-14 13:41:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:42:40] Seen 20,188 samples
[2023-07-14 13:42:40] Starting data epoch 94 in logical epoch 94
[2023-07-14 13:42:40] [data] Shuffling data
[2023-07-14 13:42:40] [data] Done reading 20,192 sentences
[2023-07-14 13:42:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:44:06] Seen 20,188 samples
[2023-07-14 13:44:06] Starting data epoch 95 in logical epoch 95
[2023-07-14 13:44:06] [data] Shuffling data
[2023-07-14 13:44:06] [data] Done reading 20,192 sentences
[2023-07-14 13:44:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:45:32] Seen 20,188 samples
[2023-07-14 13:45:32] Starting data epoch 96 in logical epoch 96
[2023-07-14 13:45:32] [data] Shuffling data
[2023-07-14 13:45:32] [data] Done reading 20,192 sentences
[2023-07-14 13:45:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:46:58] Seen 20,188 samples
[2023-07-14 13:46:58] Starting data epoch 97 in logical epoch 97
[2023-07-14 13:46:58] [data] Shuffling data
[2023-07-14 13:46:58] [data] Done reading 20,192 sentences
[2023-07-14 13:46:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:48:00] Ep. 97 : Up. 16000 : Sen. 14,808 : Cost 1.05062163 * 3,736,778 @ 2,904 after 59,931,151 : Time 516.11s : 7240.28 words/s : gNorm 1.1722
[2023-07-14 13:48:24] Seen 20,188 samples
[2023-07-14 13:48:24] Starting data epoch 98 in logical epoch 98
[2023-07-14 13:48:24] [data] Shuffling data
[2023-07-14 13:48:24] [data] Done reading 20,192 sentences
[2023-07-14 13:48:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:49:49] Seen 20,188 samples
[2023-07-14 13:49:49] Starting data epoch 99 in logical epoch 99
[2023-07-14 13:49:49] [data] Shuffling data
[2023-07-14 13:49:49] [data] Done reading 20,192 sentences
[2023-07-14 13:49:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:51:14] Seen 20,188 samples
[2023-07-14 13:51:14] Starting data epoch 100 in logical epoch 100
[2023-07-14 13:51:14] [data] Shuffling data
[2023-07-14 13:51:14] [data] Done reading 20,192 sentences
[2023-07-14 13:51:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:52:40] Seen 20,188 samples
[2023-07-14 13:52:40] Starting data epoch 101 in logical epoch 101
[2023-07-14 13:52:40] Training finished
[2023-07-14 13:52:49] [valid] Ep. 101 : Up. 16541 : cross-entropy : 103.811 : stalled 4 times (last best: 100.389)
[2023-07-14 13:53:30] [valid] Ep. 101 : Up. 16541 : translation : 0 : new best
[2023-07-14 13:53:30] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:53:32] Saving Adam parameters
[2023-07-14 13:53:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:53:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:53:40] [marian] Running on node21.datos.cluster.uy as process 28143 with command line:
[2023-07-14 13:53:40] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 110 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 13:53:40] [config] after: 0e
[2023-07-14 13:53:40] [config] after-batches: 0
[2023-07-14 13:53:40] [config] after-epochs: 110
[2023-07-14 13:53:40] [config] all-caps-every: 0
[2023-07-14 13:53:40] [config] allow-unk: false
[2023-07-14 13:53:40] [config] authors: false
[2023-07-14 13:53:40] [config] beam-size: 6
[2023-07-14 13:53:40] [config] bert-class-symbol: "[CLS]"
[2023-07-14 13:53:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 13:53:40] [config] bert-masking-fraction: 0.15
[2023-07-14 13:53:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 13:53:40] [config] bert-train-type-embeddings: true
[2023-07-14 13:53:40] [config] bert-type-vocab-size: 2
[2023-07-14 13:53:40] [config] build-info: ""
[2023-07-14 13:53:40] [config] check-gradient-nan: false
[2023-07-14 13:53:40] [config] check-nan: false
[2023-07-14 13:53:40] [config] cite: false
[2023-07-14 13:53:40] [config] clip-norm: 1
[2023-07-14 13:53:40] [config] cost-scaling:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] cost-type: ce-sum
[2023-07-14 13:53:40] [config] cpu-threads: 0
[2023-07-14 13:53:40] [config] data-threads: 8
[2023-07-14 13:53:40] [config] data-weighting: ""
[2023-07-14 13:53:40] [config] data-weighting-type: sentence
[2023-07-14 13:53:40] [config] dec-cell: gru
[2023-07-14 13:53:40] [config] dec-cell-base-depth: 2
[2023-07-14 13:53:40] [config] dec-cell-high-depth: 1
[2023-07-14 13:53:40] [config] dec-depth: 1
[2023-07-14 13:53:40] [config] devices:
[2023-07-14 13:53:40] [config]   - 0
[2023-07-14 13:53:40] [config] dim-emb: 512
[2023-07-14 13:53:40] [config] dim-rnn: 1024
[2023-07-14 13:53:40] [config] dim-vocabs:
[2023-07-14 13:53:40] [config]   - 16384
[2023-07-14 13:53:40] [config]   - 16384
[2023-07-14 13:53:40] [config] disp-first: 0
[2023-07-14 13:53:40] [config] disp-freq: 1000u
[2023-07-14 13:53:40] [config] disp-label-counts: true
[2023-07-14 13:53:40] [config] dropout-rnn: 0.2
[2023-07-14 13:53:40] [config] dropout-src: 0.1
[2023-07-14 13:53:40] [config] dropout-trg: 0.1
[2023-07-14 13:53:40] [config] dump-config: ""
[2023-07-14 13:53:40] [config] dynamic-gradient-scaling:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] early-stopping: 10
[2023-07-14 13:53:40] [config] early-stopping-on: first
[2023-07-14 13:53:40] [config] embedding-fix-src: false
[2023-07-14 13:53:40] [config] embedding-fix-trg: false
[2023-07-14 13:53:40] [config] embedding-normalization: false
[2023-07-14 13:53:40] [config] embedding-vectors:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] enc-cell: gru
[2023-07-14 13:53:40] [config] enc-cell-depth: 1
[2023-07-14 13:53:40] [config] enc-depth: 1
[2023-07-14 13:53:40] [config] enc-type: bidirectional
[2023-07-14 13:53:40] [config] english-title-case-every: 0
[2023-07-14 13:53:40] [config] exponential-smoothing: 0
[2023-07-14 13:53:40] [config] factor-weight: 1
[2023-07-14 13:53:40] [config] factors-combine: sum
[2023-07-14 13:53:40] [config] factors-dim-emb: 0
[2023-07-14 13:53:40] [config] gradient-checkpointing: false
[2023-07-14 13:53:40] [config] gradient-norm-average-window: 100
[2023-07-14 13:53:40] [config] guided-alignment: none
[2023-07-14 13:53:40] [config] guided-alignment-cost: mse
[2023-07-14 13:53:40] [config] guided-alignment-weight: 0.1
[2023-07-14 13:53:40] [config] ignore-model-config: false
[2023-07-14 13:53:40] [config] input-types:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] interpolate-env-vars: false
[2023-07-14 13:53:40] [config] keep-best: false
[2023-07-14 13:53:40] [config] label-smoothing: 0
[2023-07-14 13:53:40] [config] layer-normalization: true
[2023-07-14 13:53:40] [config] learn-rate: 0.0001
[2023-07-14 13:53:40] [config] lemma-dependency: ""
[2023-07-14 13:53:40] [config] lemma-dim-emb: 0
[2023-07-14 13:53:40] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:53:40] [config] log-level: info
[2023-07-14 13:53:40] [config] log-time-zone: ""
[2023-07-14 13:53:40] [config] logical-epoch:
[2023-07-14 13:53:40] [config]   - 1e
[2023-07-14 13:53:40] [config]   - 0
[2023-07-14 13:53:40] [config] lr-decay: 0
[2023-07-14 13:53:40] [config] lr-decay-freq: 50000
[2023-07-14 13:53:40] [config] lr-decay-inv-sqrt:
[2023-07-14 13:53:40] [config]   - 0
[2023-07-14 13:53:40] [config] lr-decay-repeat-warmup: false
[2023-07-14 13:53:40] [config] lr-decay-reset-optimizer: false
[2023-07-14 13:53:40] [config] lr-decay-start:
[2023-07-14 13:53:40] [config]   - 10
[2023-07-14 13:53:40] [config]   - 1
[2023-07-14 13:53:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 13:53:40] [config] lr-report: false
[2023-07-14 13:53:40] [config] lr-warmup: 0
[2023-07-14 13:53:40] [config] lr-warmup-at-reload: false
[2023-07-14 13:53:40] [config] lr-warmup-cycle: false
[2023-07-14 13:53:40] [config] lr-warmup-start-rate: 0
[2023-07-14 13:53:40] [config] max-length: 200
[2023-07-14 13:53:40] [config] max-length-crop: false
[2023-07-14 13:53:40] [config] max-length-factor: 3
[2023-07-14 13:53:40] [config] maxi-batch: 100
[2023-07-14 13:53:40] [config] maxi-batch-sort: trg
[2023-07-14 13:53:40] [config] mini-batch: 64
[2023-07-14 13:53:40] [config] mini-batch-fit: true
[2023-07-14 13:53:40] [config] mini-batch-fit-step: 10
[2023-07-14 13:53:40] [config] mini-batch-round-up: true
[2023-07-14 13:53:40] [config] mini-batch-track-lr: false
[2023-07-14 13:53:40] [config] mini-batch-warmup: 0
[2023-07-14 13:53:40] [config] mini-batch-words: 0
[2023-07-14 13:53:40] [config] mini-batch-words-ref: 0
[2023-07-14 13:53:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:53:40] [config] multi-loss-type: sum
[2023-07-14 13:53:40] [config] n-best: false
[2023-07-14 13:53:40] [config] no-nccl: false
[2023-07-14 13:53:40] [config] no-reload: false
[2023-07-14 13:53:40] [config] no-restore-corpus: false
[2023-07-14 13:53:40] [config] normalize: 0.6
[2023-07-14 13:53:40] [config] normalize-gradient: false
[2023-07-14 13:53:40] [config] num-devices: 0
[2023-07-14 13:53:40] [config] optimizer: adam
[2023-07-14 13:53:40] [config] optimizer-delay: 1
[2023-07-14 13:53:40] [config] optimizer-params:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] output-omit-bias: false
[2023-07-14 13:53:40] [config] overwrite: false
[2023-07-14 13:53:40] [config] precision:
[2023-07-14 13:53:40] [config]   - float32
[2023-07-14 13:53:40] [config]   - float32
[2023-07-14 13:53:40] [config] pretrained-model: ""
[2023-07-14 13:53:40] [config] quantize-biases: false
[2023-07-14 13:53:40] [config] quantize-bits: 0
[2023-07-14 13:53:40] [config] quantize-log-based: false
[2023-07-14 13:53:40] [config] quantize-optimization-steps: 0
[2023-07-14 13:53:40] [config] quiet: false
[2023-07-14 13:53:40] [config] quiet-translation: true
[2023-07-14 13:53:40] [config] relative-paths: false
[2023-07-14 13:53:40] [config] right-left: false
[2023-07-14 13:53:40] [config] save-freq: 10000u
[2023-07-14 13:53:40] [config] seed: 1234
[2023-07-14 13:53:40] [config] sentencepiece-alphas:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] sentencepiece-max-lines: 2000000
[2023-07-14 13:53:40] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 13:53:40] [config] sharding: global
[2023-07-14 13:53:40] [config] shuffle: data
[2023-07-14 13:53:40] [config] shuffle-in-ram: false
[2023-07-14 13:53:40] [config] sigterm: save-and-exit
[2023-07-14 13:53:40] [config] skip: false
[2023-07-14 13:53:40] [config] sqlite: ""
[2023-07-14 13:53:40] [config] sqlite-drop: false
[2023-07-14 13:53:40] [config] sync-freq: 200u
[2023-07-14 13:53:40] [config] sync-sgd: false
[2023-07-14 13:53:40] [config] tempdir: /tmp
[2023-07-14 13:53:40] [config] tied-embeddings: false
[2023-07-14 13:53:40] [config] tied-embeddings-all: true
[2023-07-14 13:53:40] [config] tied-embeddings-src: false
[2023-07-14 13:53:40] [config] train-embedder-rank:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] train-sets:
[2023-07-14 13:53:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 13:53:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 13:53:40] [config] transformer-aan-activation: swish
[2023-07-14 13:53:40] [config] transformer-aan-depth: 2
[2023-07-14 13:53:40] [config] transformer-aan-nogate: false
[2023-07-14 13:53:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 13:53:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 13:53:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 13:53:40] [config] transformer-depth-scaling: false
[2023-07-14 13:53:40] [config] transformer-dim-aan: 2048
[2023-07-14 13:53:40] [config] transformer-dim-ffn: 2048
[2023-07-14 13:53:40] [config] transformer-dropout: 0
[2023-07-14 13:53:40] [config] transformer-dropout-attention: 0
[2023-07-14 13:53:40] [config] transformer-dropout-ffn: 0
[2023-07-14 13:53:40] [config] transformer-ffn-activation: swish
[2023-07-14 13:53:40] [config] transformer-ffn-depth: 2
[2023-07-14 13:53:40] [config] transformer-guided-alignment-layer: last
[2023-07-14 13:53:40] [config] transformer-heads: 8
[2023-07-14 13:53:40] [config] transformer-no-projection: false
[2023-07-14 13:53:40] [config] transformer-pool: false
[2023-07-14 13:53:40] [config] transformer-postprocess: dan
[2023-07-14 13:53:40] [config] transformer-postprocess-emb: d
[2023-07-14 13:53:40] [config] transformer-postprocess-top: ""
[2023-07-14 13:53:40] [config] transformer-preprocess: ""
[2023-07-14 13:53:40] [config] transformer-tied-layers:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] transformer-train-position-embeddings: false
[2023-07-14 13:53:40] [config] tsv: false
[2023-07-14 13:53:40] [config] tsv-fields: 0
[2023-07-14 13:53:40] [config] type: amun
[2023-07-14 13:53:40] [config] ulr: false
[2023-07-14 13:53:40] [config] ulr-dim-emb: 0
[2023-07-14 13:53:40] [config] ulr-dropout: 0
[2023-07-14 13:53:40] [config] ulr-keys-vectors: ""
[2023-07-14 13:53:40] [config] ulr-query-vectors: ""
[2023-07-14 13:53:40] [config] ulr-softmax-temperature: 1
[2023-07-14 13:53:40] [config] ulr-trainable-transformation: false
[2023-07-14 13:53:40] [config] unlikelihood-loss: false
[2023-07-14 13:53:40] [config] valid-freq: 5000000
[2023-07-14 13:53:40] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 13:53:40] [config] valid-max-length: 1000
[2023-07-14 13:53:40] [config] valid-metrics:
[2023-07-14 13:53:40] [config]   - cross-entropy
[2023-07-14 13:53:40] [config]   - translation
[2023-07-14 13:53:40] [config] valid-mini-batch: 32
[2023-07-14 13:53:40] [config] valid-reset-stalled: false
[2023-07-14 13:53:40] [config] valid-script-args:
[2023-07-14 13:53:40] [config]   []
[2023-07-14 13:53:40] [config] valid-script-path: ""
[2023-07-14 13:53:40] [config] valid-sets:
[2023-07-14 13:53:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 13:53:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 13:53:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 13:53:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:53:40] [config] vocabs:
[2023-07-14 13:53:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:53:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:53:40] [config] word-penalty: 0
[2023-07-14 13:53:40] [config] word-scores: false
[2023-07-14 13:53:40] [config] workspace: 3000
[2023-07-14 13:53:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 13:53:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:53:40] [training] Using single-device training
[2023-07-14 13:53:40] Synced seed 1234
[2023-07-14 13:53:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 13:53:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 13:53:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 13:53:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 13:53:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 13:53:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:53:41] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:53:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:53:42] [comm] Using global sharding
[2023-07-14 13:53:42] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:53:42] [training] Using 1 GPUs
[2023-07-14 13:53:42] [logits] Applying loss function for 1 factor(s)
[2023-07-14 13:53:42] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:53:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 13:53:42] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:55:06] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 13:55:06] [valid] No post-processing script given for validating translator
[2023-07-14 13:55:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 13:55:06] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 13:55:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 13:55:06] [comm] Using global sharding
[2023-07-14 13:55:06] [comm] NCCLCommunicators constructed successfully
[2023-07-14 13:55:06] [training] Using 1 GPUs
[2023-07-14 13:55:06] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 13:55:07] Loading Adam parameters
[2023-07-14 13:55:07] [memory] Reserving 322 MB, device gpu0
[2023-07-14 13:55:07] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:55:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 13:55:07] [data] Restoring the corpus state to epoch 101, batch 16541
[2023-07-14 13:55:07] [data] Shuffling data
[2023-07-14 13:55:07] [data] Done reading 20,192 sentences
[2023-07-14 13:55:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:55:07] Training started
[2023-07-14 13:55:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 13:55:08] [memory] Reserving 161 MB, device gpu0
[2023-07-14 13:55:08] Parameter type float32, optimization type float32, casting types false
[2023-07-14 13:56:32] Seen 20,188 samples
[2023-07-14 13:56:32] Starting data epoch 102 in logical epoch 102
[2023-07-14 13:56:32] [data] Shuffling data
[2023-07-14 13:56:32] [data] Done reading 20,192 sentences
[2023-07-14 13:56:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:57:58] Seen 20,188 samples
[2023-07-14 13:57:58] Starting data epoch 103 in logical epoch 103
[2023-07-14 13:57:58] [data] Shuffling data
[2023-07-14 13:57:58] [data] Done reading 20,192 sentences
[2023-07-14 13:57:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 13:59:06] Ep. 103 : Up. 17000 : Sen. 15,814 : Cost 0.96888953 * 3,747,699 @ 5,456 after 63,678,850 : Time 239.63s : 15639.39 words/s : gNorm 1.1603
[2023-07-14 13:59:23] Seen 20,188 samples
[2023-07-14 13:59:23] Starting data epoch 104 in logical epoch 104
[2023-07-14 13:59:23] [data] Shuffling data
[2023-07-14 13:59:23] [data] Done reading 20,192 sentences
[2023-07-14 13:59:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:00:48] Seen 20,188 samples
[2023-07-14 14:00:48] Starting data epoch 105 in logical epoch 105
[2023-07-14 14:00:48] [data] Shuffling data
[2023-07-14 14:00:48] [data] Done reading 20,192 sentences
[2023-07-14 14:00:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:02:14] Seen 20,188 samples
[2023-07-14 14:02:14] Starting data epoch 106 in logical epoch 106
[2023-07-14 14:02:14] [data] Shuffling data
[2023-07-14 14:02:14] [data] Done reading 20,192 sentences
[2023-07-14 14:02:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:03:38] Seen 20,188 samples
[2023-07-14 14:03:38] Starting data epoch 107 in logical epoch 107
[2023-07-14 14:03:38] [data] Shuffling data
[2023-07-14 14:03:38] [data] Done reading 20,192 sentences
[2023-07-14 14:03:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:05:05] Seen 20,188 samples
[2023-07-14 14:05:05] Starting data epoch 108 in logical epoch 108
[2023-07-14 14:05:05] [data] Shuffling data
[2023-07-14 14:05:05] [data] Done reading 20,192 sentences
[2023-07-14 14:05:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:06:29] Seen 20,188 samples
[2023-07-14 14:06:29] Starting data epoch 109 in logical epoch 109
[2023-07-14 14:06:29] [data] Shuffling data
[2023-07-14 14:06:29] [data] Done reading 20,192 sentences
[2023-07-14 14:06:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:07:39] Ep. 109 : Up. 18000 : Sen. 17,018 : Cost 0.89608103 * 3,737,546 @ 4,936 after 67,416,396 : Time 513.62s : 7276.81 words/s : gNorm 1.1378
[2023-07-14 14:07:56] Seen 20,188 samples
[2023-07-14 14:07:56] Starting data epoch 110 in logical epoch 110
[2023-07-14 14:07:56] [data] Shuffling data
[2023-07-14 14:07:56] [data] Done reading 20,192 sentences
[2023-07-14 14:07:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:09:21] Seen 20,188 samples
[2023-07-14 14:09:21] Starting data epoch 111 in logical epoch 111
[2023-07-14 14:09:21] Training finished
[2023-07-14 14:09:30] [valid] Ep. 111 : Up. 18196 : cross-entropy : 105.096 : stalled 5 times (last best: 100.389)
[2023-07-14 14:10:13] [valid] Ep. 111 : Up. 18196 : translation : 0 : new best
[2023-07-14 14:10:13] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:10:15] Saving Adam parameters
[2023-07-14 14:10:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 14:10:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:10:24] [marian] Running on node21.datos.cluster.uy as process 29448 with command line:
[2023-07-14 14:10:24] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 120 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 14:10:24] [config] after: 0e
[2023-07-14 14:10:24] [config] after-batches: 0
[2023-07-14 14:10:24] [config] after-epochs: 120
[2023-07-14 14:10:24] [config] all-caps-every: 0
[2023-07-14 14:10:24] [config] allow-unk: false
[2023-07-14 14:10:24] [config] authors: false
[2023-07-14 14:10:24] [config] beam-size: 6
[2023-07-14 14:10:24] [config] bert-class-symbol: "[CLS]"
[2023-07-14 14:10:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 14:10:24] [config] bert-masking-fraction: 0.15
[2023-07-14 14:10:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 14:10:24] [config] bert-train-type-embeddings: true
[2023-07-14 14:10:24] [config] bert-type-vocab-size: 2
[2023-07-14 14:10:24] [config] build-info: ""
[2023-07-14 14:10:24] [config] check-gradient-nan: false
[2023-07-14 14:10:24] [config] check-nan: false
[2023-07-14 14:10:24] [config] cite: false
[2023-07-14 14:10:24] [config] clip-norm: 1
[2023-07-14 14:10:24] [config] cost-scaling:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] cost-type: ce-sum
[2023-07-14 14:10:24] [config] cpu-threads: 0
[2023-07-14 14:10:24] [config] data-threads: 8
[2023-07-14 14:10:24] [config] data-weighting: ""
[2023-07-14 14:10:24] [config] data-weighting-type: sentence
[2023-07-14 14:10:24] [config] dec-cell: gru
[2023-07-14 14:10:24] [config] dec-cell-base-depth: 2
[2023-07-14 14:10:24] [config] dec-cell-high-depth: 1
[2023-07-14 14:10:24] [config] dec-depth: 1
[2023-07-14 14:10:24] [config] devices:
[2023-07-14 14:10:24] [config]   - 0
[2023-07-14 14:10:24] [config] dim-emb: 512
[2023-07-14 14:10:24] [config] dim-rnn: 1024
[2023-07-14 14:10:24] [config] dim-vocabs:
[2023-07-14 14:10:24] [config]   - 16384
[2023-07-14 14:10:24] [config]   - 16384
[2023-07-14 14:10:24] [config] disp-first: 0
[2023-07-14 14:10:24] [config] disp-freq: 1000u
[2023-07-14 14:10:24] [config] disp-label-counts: true
[2023-07-14 14:10:24] [config] dropout-rnn: 0.2
[2023-07-14 14:10:24] [config] dropout-src: 0.1
[2023-07-14 14:10:24] [config] dropout-trg: 0.1
[2023-07-14 14:10:24] [config] dump-config: ""
[2023-07-14 14:10:24] [config] dynamic-gradient-scaling:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] early-stopping: 10
[2023-07-14 14:10:24] [config] early-stopping-on: first
[2023-07-14 14:10:24] [config] embedding-fix-src: false
[2023-07-14 14:10:24] [config] embedding-fix-trg: false
[2023-07-14 14:10:24] [config] embedding-normalization: false
[2023-07-14 14:10:24] [config] embedding-vectors:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] enc-cell: gru
[2023-07-14 14:10:24] [config] enc-cell-depth: 1
[2023-07-14 14:10:24] [config] enc-depth: 1
[2023-07-14 14:10:24] [config] enc-type: bidirectional
[2023-07-14 14:10:24] [config] english-title-case-every: 0
[2023-07-14 14:10:24] [config] exponential-smoothing: 0
[2023-07-14 14:10:24] [config] factor-weight: 1
[2023-07-14 14:10:24] [config] factors-combine: sum
[2023-07-14 14:10:24] [config] factors-dim-emb: 0
[2023-07-14 14:10:24] [config] gradient-checkpointing: false
[2023-07-14 14:10:24] [config] gradient-norm-average-window: 100
[2023-07-14 14:10:24] [config] guided-alignment: none
[2023-07-14 14:10:24] [config] guided-alignment-cost: mse
[2023-07-14 14:10:24] [config] guided-alignment-weight: 0.1
[2023-07-14 14:10:24] [config] ignore-model-config: false
[2023-07-14 14:10:24] [config] input-types:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] interpolate-env-vars: false
[2023-07-14 14:10:24] [config] keep-best: false
[2023-07-14 14:10:24] [config] label-smoothing: 0
[2023-07-14 14:10:24] [config] layer-normalization: true
[2023-07-14 14:10:24] [config] learn-rate: 0.0001
[2023-07-14 14:10:24] [config] lemma-dependency: ""
[2023-07-14 14:10:24] [config] lemma-dim-emb: 0
[2023-07-14 14:10:24] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 14:10:24] [config] log-level: info
[2023-07-14 14:10:24] [config] log-time-zone: ""
[2023-07-14 14:10:24] [config] logical-epoch:
[2023-07-14 14:10:24] [config]   - 1e
[2023-07-14 14:10:24] [config]   - 0
[2023-07-14 14:10:24] [config] lr-decay: 0
[2023-07-14 14:10:24] [config] lr-decay-freq: 50000
[2023-07-14 14:10:24] [config] lr-decay-inv-sqrt:
[2023-07-14 14:10:24] [config]   - 0
[2023-07-14 14:10:24] [config] lr-decay-repeat-warmup: false
[2023-07-14 14:10:24] [config] lr-decay-reset-optimizer: false
[2023-07-14 14:10:24] [config] lr-decay-start:
[2023-07-14 14:10:24] [config]   - 10
[2023-07-14 14:10:24] [config]   - 1
[2023-07-14 14:10:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 14:10:24] [config] lr-report: false
[2023-07-14 14:10:24] [config] lr-warmup: 0
[2023-07-14 14:10:24] [config] lr-warmup-at-reload: false
[2023-07-14 14:10:24] [config] lr-warmup-cycle: false
[2023-07-14 14:10:24] [config] lr-warmup-start-rate: 0
[2023-07-14 14:10:24] [config] max-length: 200
[2023-07-14 14:10:24] [config] max-length-crop: false
[2023-07-14 14:10:24] [config] max-length-factor: 3
[2023-07-14 14:10:24] [config] maxi-batch: 100
[2023-07-14 14:10:24] [config] maxi-batch-sort: trg
[2023-07-14 14:10:24] [config] mini-batch: 64
[2023-07-14 14:10:24] [config] mini-batch-fit: true
[2023-07-14 14:10:24] [config] mini-batch-fit-step: 10
[2023-07-14 14:10:24] [config] mini-batch-round-up: true
[2023-07-14 14:10:24] [config] mini-batch-track-lr: false
[2023-07-14 14:10:24] [config] mini-batch-warmup: 0
[2023-07-14 14:10:24] [config] mini-batch-words: 0
[2023-07-14 14:10:24] [config] mini-batch-words-ref: 0
[2023-07-14 14:10:24] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:10:24] [config] multi-loss-type: sum
[2023-07-14 14:10:24] [config] n-best: false
[2023-07-14 14:10:24] [config] no-nccl: false
[2023-07-14 14:10:24] [config] no-reload: false
[2023-07-14 14:10:24] [config] no-restore-corpus: false
[2023-07-14 14:10:24] [config] normalize: 0.6
[2023-07-14 14:10:24] [config] normalize-gradient: false
[2023-07-14 14:10:24] [config] num-devices: 0
[2023-07-14 14:10:24] [config] optimizer: adam
[2023-07-14 14:10:24] [config] optimizer-delay: 1
[2023-07-14 14:10:24] [config] optimizer-params:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] output-omit-bias: false
[2023-07-14 14:10:24] [config] overwrite: false
[2023-07-14 14:10:24] [config] precision:
[2023-07-14 14:10:24] [config]   - float32
[2023-07-14 14:10:24] [config]   - float32
[2023-07-14 14:10:24] [config] pretrained-model: ""
[2023-07-14 14:10:24] [config] quantize-biases: false
[2023-07-14 14:10:24] [config] quantize-bits: 0
[2023-07-14 14:10:24] [config] quantize-log-based: false
[2023-07-14 14:10:24] [config] quantize-optimization-steps: 0
[2023-07-14 14:10:24] [config] quiet: false
[2023-07-14 14:10:24] [config] quiet-translation: true
[2023-07-14 14:10:24] [config] relative-paths: false
[2023-07-14 14:10:24] [config] right-left: false
[2023-07-14 14:10:24] [config] save-freq: 10000u
[2023-07-14 14:10:24] [config] seed: 1234
[2023-07-14 14:10:24] [config] sentencepiece-alphas:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] sentencepiece-max-lines: 2000000
[2023-07-14 14:10:24] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 14:10:24] [config] sharding: global
[2023-07-14 14:10:24] [config] shuffle: data
[2023-07-14 14:10:24] [config] shuffle-in-ram: false
[2023-07-14 14:10:24] [config] sigterm: save-and-exit
[2023-07-14 14:10:24] [config] skip: false
[2023-07-14 14:10:24] [config] sqlite: ""
[2023-07-14 14:10:24] [config] sqlite-drop: false
[2023-07-14 14:10:24] [config] sync-freq: 200u
[2023-07-14 14:10:24] [config] sync-sgd: false
[2023-07-14 14:10:24] [config] tempdir: /tmp
[2023-07-14 14:10:24] [config] tied-embeddings: false
[2023-07-14 14:10:24] [config] tied-embeddings-all: true
[2023-07-14 14:10:24] [config] tied-embeddings-src: false
[2023-07-14 14:10:24] [config] train-embedder-rank:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] train-sets:
[2023-07-14 14:10:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 14:10:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 14:10:24] [config] transformer-aan-activation: swish
[2023-07-14 14:10:24] [config] transformer-aan-depth: 2
[2023-07-14 14:10:24] [config] transformer-aan-nogate: false
[2023-07-14 14:10:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 14:10:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 14:10:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 14:10:24] [config] transformer-depth-scaling: false
[2023-07-14 14:10:24] [config] transformer-dim-aan: 2048
[2023-07-14 14:10:24] [config] transformer-dim-ffn: 2048
[2023-07-14 14:10:24] [config] transformer-dropout: 0
[2023-07-14 14:10:24] [config] transformer-dropout-attention: 0
[2023-07-14 14:10:24] [config] transformer-dropout-ffn: 0
[2023-07-14 14:10:24] [config] transformer-ffn-activation: swish
[2023-07-14 14:10:24] [config] transformer-ffn-depth: 2
[2023-07-14 14:10:24] [config] transformer-guided-alignment-layer: last
[2023-07-14 14:10:24] [config] transformer-heads: 8
[2023-07-14 14:10:24] [config] transformer-no-projection: false
[2023-07-14 14:10:24] [config] transformer-pool: false
[2023-07-14 14:10:24] [config] transformer-postprocess: dan
[2023-07-14 14:10:24] [config] transformer-postprocess-emb: d
[2023-07-14 14:10:24] [config] transformer-postprocess-top: ""
[2023-07-14 14:10:24] [config] transformer-preprocess: ""
[2023-07-14 14:10:24] [config] transformer-tied-layers:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] transformer-train-position-embeddings: false
[2023-07-14 14:10:24] [config] tsv: false
[2023-07-14 14:10:24] [config] tsv-fields: 0
[2023-07-14 14:10:24] [config] type: amun
[2023-07-14 14:10:24] [config] ulr: false
[2023-07-14 14:10:24] [config] ulr-dim-emb: 0
[2023-07-14 14:10:24] [config] ulr-dropout: 0
[2023-07-14 14:10:24] [config] ulr-keys-vectors: ""
[2023-07-14 14:10:24] [config] ulr-query-vectors: ""
[2023-07-14 14:10:24] [config] ulr-softmax-temperature: 1
[2023-07-14 14:10:24] [config] ulr-trainable-transformation: false
[2023-07-14 14:10:24] [config] unlikelihood-loss: false
[2023-07-14 14:10:24] [config] valid-freq: 5000000
[2023-07-14 14:10:24] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 14:10:24] [config] valid-max-length: 1000
[2023-07-14 14:10:24] [config] valid-metrics:
[2023-07-14 14:10:24] [config]   - cross-entropy
[2023-07-14 14:10:24] [config]   - translation
[2023-07-14 14:10:24] [config] valid-mini-batch: 32
[2023-07-14 14:10:24] [config] valid-reset-stalled: false
[2023-07-14 14:10:24] [config] valid-script-args:
[2023-07-14 14:10:24] [config]   []
[2023-07-14 14:10:24] [config] valid-script-path: ""
[2023-07-14 14:10:24] [config] valid-sets:
[2023-07-14 14:10:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 14:10:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 14:10:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 14:10:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:10:24] [config] vocabs:
[2023-07-14 14:10:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 14:10:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 14:10:24] [config] word-penalty: 0
[2023-07-14 14:10:24] [config] word-scores: false
[2023-07-14 14:10:24] [config] workspace: 3000
[2023-07-14 14:10:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:10:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:10:24] [training] Using single-device training
[2023-07-14 14:10:25] Synced seed 1234
[2023-07-14 14:10:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 14:10:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 14:10:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 14:10:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 14:10:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 14:10:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:10:26] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 14:10:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 14:10:26] [comm] Using global sharding
[2023-07-14 14:10:26] [comm] NCCLCommunicators constructed successfully
[2023-07-14 14:10:26] [training] Using 1 GPUs
[2023-07-14 14:10:26] [logits] Applying loss function for 1 factor(s)
[2023-07-14 14:10:26] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:10:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 14:10:26] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:11:50] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 14:11:50] [valid] No post-processing script given for validating translator
[2023-07-14 14:11:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:11:50] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 14:11:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 14:11:50] [comm] Using global sharding
[2023-07-14 14:11:50] [comm] NCCLCommunicators constructed successfully
[2023-07-14 14:11:50] [training] Using 1 GPUs
[2023-07-14 14:11:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:11:51] Loading Adam parameters
[2023-07-14 14:11:51] [memory] Reserving 322 MB, device gpu0
[2023-07-14 14:11:52] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:11:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 14:11:52] [data] Restoring the corpus state to epoch 111, batch 18196
[2023-07-14 14:11:52] [data] Shuffling data
[2023-07-14 14:11:52] [data] Done reading 20,192 sentences
[2023-07-14 14:11:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:11:52] Training started
[2023-07-14 14:11:52] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 14:11:52] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:11:52] Parameter type float32, optimization type float32, casting types false
[2023-07-14 14:13:17] Seen 20,188 samples
[2023-07-14 14:13:17] Starting data epoch 112 in logical epoch 112
[2023-07-14 14:13:17] [data] Shuffling data
[2023-07-14 14:13:17] [data] Done reading 20,192 sentences
[2023-07-14 14:13:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:14:42] Seen 20,188 samples
[2023-07-14 14:14:42] Starting data epoch 113 in logical epoch 113
[2023-07-14 14:14:42] [data] Shuffling data
[2023-07-14 14:14:42] [data] Done reading 20,192 sentences
[2023-07-14 14:14:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:16:08] Seen 20,188 samples
[2023-07-14 14:16:08] Starting data epoch 114 in logical epoch 114
[2023-07-14 14:16:08] [data] Shuffling data
[2023-07-14 14:16:08] [data] Done reading 20,192 sentences
[2023-07-14 14:16:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:17:34] Seen 20,188 samples
[2023-07-14 14:17:34] Starting data epoch 115 in logical epoch 115
[2023-07-14 14:17:34] [data] Shuffling data
[2023-07-14 14:17:34] [data] Done reading 20,192 sentences
[2023-07-14 14:17:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:18:48] Ep. 115 : Up. 19000 : Sen. 17,141 : Cost 0.84831876 * 3,746,544 @ 3,776 after 71,162,940 : Time 417.62s : 8971.18 words/s : gNorm 1.0950
[2023-07-14 14:18:59] Seen 20,188 samples
[2023-07-14 14:18:59] Starting data epoch 116 in logical epoch 116
[2023-07-14 14:18:59] [data] Shuffling data
[2023-07-14 14:18:59] [data] Done reading 20,192 sentences
[2023-07-14 14:18:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:20:25] Seen 20,188 samples
[2023-07-14 14:20:25] Starting data epoch 117 in logical epoch 117
[2023-07-14 14:20:25] [data] Shuffling data
[2023-07-14 14:20:25] [data] Done reading 20,192 sentences
[2023-07-14 14:20:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:21:49] Seen 20,188 samples
[2023-07-14 14:21:49] Starting data epoch 118 in logical epoch 118
[2023-07-14 14:21:49] [data] Shuffling data
[2023-07-14 14:21:49] [data] Done reading 20,192 sentences
[2023-07-14 14:21:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:23:15] Seen 20,188 samples
[2023-07-14 14:23:15] Starting data epoch 119 in logical epoch 119
[2023-07-14 14:23:15] [data] Shuffling data
[2023-07-14 14:23:15] [data] Done reading 20,192 sentences
[2023-07-14 14:23:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:24:41] Seen 20,188 samples
[2023-07-14 14:24:41] Starting data epoch 120 in logical epoch 120
[2023-07-14 14:24:41] [data] Shuffling data
[2023-07-14 14:24:41] [data] Done reading 20,192 sentences
[2023-07-14 14:24:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:26:07] Seen 20,188 samples
[2023-07-14 14:26:07] Starting data epoch 121 in logical epoch 121
[2023-07-14 14:26:07] Training finished
[2023-07-14 14:26:16] [valid] Ep. 121 : Up. 19857 : cross-entropy : 106.157 : stalled 6 times (last best: 100.389)
[2023-07-14 14:26:56] [valid] Ep. 121 : Up. 19857 : translation : 0 : new best
[2023-07-14 14:26:56] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:26:57] Saving Adam parameters
[2023-07-14 14:26:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 14:27:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:27:07] [marian] Running on node21.datos.cluster.uy as process 30772 with command line:
[2023-07-14 14:27:07] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 130 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 14:27:07] [config] after: 0e
[2023-07-14 14:27:07] [config] after-batches: 0
[2023-07-14 14:27:07] [config] after-epochs: 130
[2023-07-14 14:27:07] [config] all-caps-every: 0
[2023-07-14 14:27:07] [config] allow-unk: false
[2023-07-14 14:27:07] [config] authors: false
[2023-07-14 14:27:07] [config] beam-size: 6
[2023-07-14 14:27:07] [config] bert-class-symbol: "[CLS]"
[2023-07-14 14:27:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 14:27:07] [config] bert-masking-fraction: 0.15
[2023-07-14 14:27:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 14:27:07] [config] bert-train-type-embeddings: true
[2023-07-14 14:27:07] [config] bert-type-vocab-size: 2
[2023-07-14 14:27:07] [config] build-info: ""
[2023-07-14 14:27:07] [config] check-gradient-nan: false
[2023-07-14 14:27:07] [config] check-nan: false
[2023-07-14 14:27:07] [config] cite: false
[2023-07-14 14:27:07] [config] clip-norm: 1
[2023-07-14 14:27:07] [config] cost-scaling:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] cost-type: ce-sum
[2023-07-14 14:27:07] [config] cpu-threads: 0
[2023-07-14 14:27:07] [config] data-threads: 8
[2023-07-14 14:27:07] [config] data-weighting: ""
[2023-07-14 14:27:07] [config] data-weighting-type: sentence
[2023-07-14 14:27:07] [config] dec-cell: gru
[2023-07-14 14:27:07] [config] dec-cell-base-depth: 2
[2023-07-14 14:27:07] [config] dec-cell-high-depth: 1
[2023-07-14 14:27:07] [config] dec-depth: 1
[2023-07-14 14:27:07] [config] devices:
[2023-07-14 14:27:07] [config]   - 0
[2023-07-14 14:27:07] [config] dim-emb: 512
[2023-07-14 14:27:07] [config] dim-rnn: 1024
[2023-07-14 14:27:07] [config] dim-vocabs:
[2023-07-14 14:27:07] [config]   - 16384
[2023-07-14 14:27:07] [config]   - 16384
[2023-07-14 14:27:07] [config] disp-first: 0
[2023-07-14 14:27:07] [config] disp-freq: 1000u
[2023-07-14 14:27:07] [config] disp-label-counts: true
[2023-07-14 14:27:07] [config] dropout-rnn: 0.2
[2023-07-14 14:27:07] [config] dropout-src: 0.1
[2023-07-14 14:27:07] [config] dropout-trg: 0.1
[2023-07-14 14:27:07] [config] dump-config: ""
[2023-07-14 14:27:07] [config] dynamic-gradient-scaling:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] early-stopping: 10
[2023-07-14 14:27:07] [config] early-stopping-on: first
[2023-07-14 14:27:07] [config] embedding-fix-src: false
[2023-07-14 14:27:07] [config] embedding-fix-trg: false
[2023-07-14 14:27:07] [config] embedding-normalization: false
[2023-07-14 14:27:07] [config] embedding-vectors:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] enc-cell: gru
[2023-07-14 14:27:07] [config] enc-cell-depth: 1
[2023-07-14 14:27:07] [config] enc-depth: 1
[2023-07-14 14:27:07] [config] enc-type: bidirectional
[2023-07-14 14:27:07] [config] english-title-case-every: 0
[2023-07-14 14:27:07] [config] exponential-smoothing: 0
[2023-07-14 14:27:07] [config] factor-weight: 1
[2023-07-14 14:27:07] [config] factors-combine: sum
[2023-07-14 14:27:07] [config] factors-dim-emb: 0
[2023-07-14 14:27:07] [config] gradient-checkpointing: false
[2023-07-14 14:27:07] [config] gradient-norm-average-window: 100
[2023-07-14 14:27:07] [config] guided-alignment: none
[2023-07-14 14:27:07] [config] guided-alignment-cost: mse
[2023-07-14 14:27:07] [config] guided-alignment-weight: 0.1
[2023-07-14 14:27:07] [config] ignore-model-config: false
[2023-07-14 14:27:07] [config] input-types:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] interpolate-env-vars: false
[2023-07-14 14:27:07] [config] keep-best: false
[2023-07-14 14:27:07] [config] label-smoothing: 0
[2023-07-14 14:27:07] [config] layer-normalization: true
[2023-07-14 14:27:07] [config] learn-rate: 0.0001
[2023-07-14 14:27:07] [config] lemma-dependency: ""
[2023-07-14 14:27:07] [config] lemma-dim-emb: 0
[2023-07-14 14:27:07] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 14:27:07] [config] log-level: info
[2023-07-14 14:27:07] [config] log-time-zone: ""
[2023-07-14 14:27:07] [config] logical-epoch:
[2023-07-14 14:27:07] [config]   - 1e
[2023-07-14 14:27:07] [config]   - 0
[2023-07-14 14:27:07] [config] lr-decay: 0
[2023-07-14 14:27:07] [config] lr-decay-freq: 50000
[2023-07-14 14:27:07] [config] lr-decay-inv-sqrt:
[2023-07-14 14:27:07] [config]   - 0
[2023-07-14 14:27:07] [config] lr-decay-repeat-warmup: false
[2023-07-14 14:27:07] [config] lr-decay-reset-optimizer: false
[2023-07-14 14:27:07] [config] lr-decay-start:
[2023-07-14 14:27:07] [config]   - 10
[2023-07-14 14:27:07] [config]   - 1
[2023-07-14 14:27:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 14:27:07] [config] lr-report: false
[2023-07-14 14:27:07] [config] lr-warmup: 0
[2023-07-14 14:27:07] [config] lr-warmup-at-reload: false
[2023-07-14 14:27:07] [config] lr-warmup-cycle: false
[2023-07-14 14:27:07] [config] lr-warmup-start-rate: 0
[2023-07-14 14:27:07] [config] max-length: 200
[2023-07-14 14:27:07] [config] max-length-crop: false
[2023-07-14 14:27:07] [config] max-length-factor: 3
[2023-07-14 14:27:07] [config] maxi-batch: 100
[2023-07-14 14:27:07] [config] maxi-batch-sort: trg
[2023-07-14 14:27:07] [config] mini-batch: 64
[2023-07-14 14:27:07] [config] mini-batch-fit: true
[2023-07-14 14:27:07] [config] mini-batch-fit-step: 10
[2023-07-14 14:27:07] [config] mini-batch-round-up: true
[2023-07-14 14:27:07] [config] mini-batch-track-lr: false
[2023-07-14 14:27:07] [config] mini-batch-warmup: 0
[2023-07-14 14:27:07] [config] mini-batch-words: 0
[2023-07-14 14:27:07] [config] mini-batch-words-ref: 0
[2023-07-14 14:27:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:27:07] [config] multi-loss-type: sum
[2023-07-14 14:27:07] [config] n-best: false
[2023-07-14 14:27:07] [config] no-nccl: false
[2023-07-14 14:27:07] [config] no-reload: false
[2023-07-14 14:27:07] [config] no-restore-corpus: false
[2023-07-14 14:27:07] [config] normalize: 0.6
[2023-07-14 14:27:07] [config] normalize-gradient: false
[2023-07-14 14:27:07] [config] num-devices: 0
[2023-07-14 14:27:07] [config] optimizer: adam
[2023-07-14 14:27:07] [config] optimizer-delay: 1
[2023-07-14 14:27:07] [config] optimizer-params:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] output-omit-bias: false
[2023-07-14 14:27:07] [config] overwrite: false
[2023-07-14 14:27:07] [config] precision:
[2023-07-14 14:27:07] [config]   - float32
[2023-07-14 14:27:07] [config]   - float32
[2023-07-14 14:27:07] [config] pretrained-model: ""
[2023-07-14 14:27:07] [config] quantize-biases: false
[2023-07-14 14:27:07] [config] quantize-bits: 0
[2023-07-14 14:27:07] [config] quantize-log-based: false
[2023-07-14 14:27:07] [config] quantize-optimization-steps: 0
[2023-07-14 14:27:07] [config] quiet: false
[2023-07-14 14:27:07] [config] quiet-translation: true
[2023-07-14 14:27:07] [config] relative-paths: false
[2023-07-14 14:27:07] [config] right-left: false
[2023-07-14 14:27:07] [config] save-freq: 10000u
[2023-07-14 14:27:07] [config] seed: 1234
[2023-07-14 14:27:07] [config] sentencepiece-alphas:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] sentencepiece-max-lines: 2000000
[2023-07-14 14:27:07] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 14:27:07] [config] sharding: global
[2023-07-14 14:27:07] [config] shuffle: data
[2023-07-14 14:27:07] [config] shuffle-in-ram: false
[2023-07-14 14:27:07] [config] sigterm: save-and-exit
[2023-07-14 14:27:07] [config] skip: false
[2023-07-14 14:27:07] [config] sqlite: ""
[2023-07-14 14:27:07] [config] sqlite-drop: false
[2023-07-14 14:27:07] [config] sync-freq: 200u
[2023-07-14 14:27:07] [config] sync-sgd: false
[2023-07-14 14:27:07] [config] tempdir: /tmp
[2023-07-14 14:27:07] [config] tied-embeddings: false
[2023-07-14 14:27:07] [config] tied-embeddings-all: true
[2023-07-14 14:27:07] [config] tied-embeddings-src: false
[2023-07-14 14:27:07] [config] train-embedder-rank:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] train-sets:
[2023-07-14 14:27:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 14:27:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 14:27:07] [config] transformer-aan-activation: swish
[2023-07-14 14:27:07] [config] transformer-aan-depth: 2
[2023-07-14 14:27:07] [config] transformer-aan-nogate: false
[2023-07-14 14:27:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 14:27:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 14:27:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 14:27:07] [config] transformer-depth-scaling: false
[2023-07-14 14:27:07] [config] transformer-dim-aan: 2048
[2023-07-14 14:27:07] [config] transformer-dim-ffn: 2048
[2023-07-14 14:27:07] [config] transformer-dropout: 0
[2023-07-14 14:27:07] [config] transformer-dropout-attention: 0
[2023-07-14 14:27:07] [config] transformer-dropout-ffn: 0
[2023-07-14 14:27:07] [config] transformer-ffn-activation: swish
[2023-07-14 14:27:07] [config] transformer-ffn-depth: 2
[2023-07-14 14:27:07] [config] transformer-guided-alignment-layer: last
[2023-07-14 14:27:07] [config] transformer-heads: 8
[2023-07-14 14:27:07] [config] transformer-no-projection: false
[2023-07-14 14:27:07] [config] transformer-pool: false
[2023-07-14 14:27:07] [config] transformer-postprocess: dan
[2023-07-14 14:27:07] [config] transformer-postprocess-emb: d
[2023-07-14 14:27:07] [config] transformer-postprocess-top: ""
[2023-07-14 14:27:07] [config] transformer-preprocess: ""
[2023-07-14 14:27:07] [config] transformer-tied-layers:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] transformer-train-position-embeddings: false
[2023-07-14 14:27:07] [config] tsv: false
[2023-07-14 14:27:07] [config] tsv-fields: 0
[2023-07-14 14:27:07] [config] type: amun
[2023-07-14 14:27:07] [config] ulr: false
[2023-07-14 14:27:07] [config] ulr-dim-emb: 0
[2023-07-14 14:27:07] [config] ulr-dropout: 0
[2023-07-14 14:27:07] [config] ulr-keys-vectors: ""
[2023-07-14 14:27:07] [config] ulr-query-vectors: ""
[2023-07-14 14:27:07] [config] ulr-softmax-temperature: 1
[2023-07-14 14:27:07] [config] ulr-trainable-transformation: false
[2023-07-14 14:27:07] [config] unlikelihood-loss: false
[2023-07-14 14:27:07] [config] valid-freq: 5000000
[2023-07-14 14:27:07] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 14:27:07] [config] valid-max-length: 1000
[2023-07-14 14:27:07] [config] valid-metrics:
[2023-07-14 14:27:07] [config]   - cross-entropy
[2023-07-14 14:27:07] [config]   - translation
[2023-07-14 14:27:07] [config] valid-mini-batch: 32
[2023-07-14 14:27:07] [config] valid-reset-stalled: false
[2023-07-14 14:27:07] [config] valid-script-args:
[2023-07-14 14:27:07] [config]   []
[2023-07-14 14:27:07] [config] valid-script-path: ""
[2023-07-14 14:27:07] [config] valid-sets:
[2023-07-14 14:27:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 14:27:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 14:27:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 14:27:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:27:07] [config] vocabs:
[2023-07-14 14:27:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 14:27:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 14:27:07] [config] word-penalty: 0
[2023-07-14 14:27:07] [config] word-scores: false
[2023-07-14 14:27:07] [config] workspace: 3000
[2023-07-14 14:27:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:27:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:27:07] [training] Using single-device training
[2023-07-14 14:27:08] Synced seed 1234
[2023-07-14 14:27:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 14:27:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 14:27:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 14:27:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 14:27:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 14:27:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:27:09] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 14:27:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 14:27:09] [comm] Using global sharding
[2023-07-14 14:27:09] [comm] NCCLCommunicators constructed successfully
[2023-07-14 14:27:09] [training] Using 1 GPUs
[2023-07-14 14:27:09] [logits] Applying loss function for 1 factor(s)
[2023-07-14 14:27:09] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:27:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 14:27:10] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:28:33] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 14:28:33] [valid] No post-processing script given for validating translator
[2023-07-14 14:28:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:28:33] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 14:28:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 14:28:33] [comm] Using global sharding
[2023-07-14 14:28:33] [comm] NCCLCommunicators constructed successfully
[2023-07-14 14:28:33] [training] Using 1 GPUs
[2023-07-14 14:28:33] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:28:34] Loading Adam parameters
[2023-07-14 14:28:34] [memory] Reserving 322 MB, device gpu0
[2023-07-14 14:28:35] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:28:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 14:28:35] [data] Restoring the corpus state to epoch 121, batch 19857
[2023-07-14 14:28:35] [data] Shuffling data
[2023-07-14 14:28:35] [data] Done reading 20,192 sentences
[2023-07-14 14:28:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:28:35] Training started
[2023-07-14 14:28:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 14:28:35] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:28:35] Parameter type float32, optimization type float32, casting types false
[2023-07-14 14:29:48] Ep. 121 : Up. 20000 : Sen. 17,546 : Cost 0.78424072 * 3,724,099 @ 5,256 after 74,887,039 : Time 75.14s : 49563.75 words/s : gNorm 1.1183
[2023-07-14 14:29:48] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.iter20000.npz
[2023-07-14 14:29:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:29:52] Saving Adam parameters
[2023-07-14 14:29:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 14:30:06] Seen 20,188 samples
[2023-07-14 14:30:06] Starting data epoch 122 in logical epoch 122
[2023-07-14 14:30:06] [data] Shuffling data
[2023-07-14 14:30:06] [data] Done reading 20,192 sentences
[2023-07-14 14:30:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:31:31] Seen 20,188 samples
[2023-07-14 14:31:31] Starting data epoch 123 in logical epoch 123
[2023-07-14 14:31:31] [data] Shuffling data
[2023-07-14 14:31:31] [data] Done reading 20,192 sentences
[2023-07-14 14:31:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:32:56] Seen 20,188 samples
[2023-07-14 14:32:56] Starting data epoch 124 in logical epoch 124
[2023-07-14 14:32:56] [data] Shuffling data
[2023-07-14 14:32:56] [data] Done reading 20,192 sentences
[2023-07-14 14:32:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:34:21] Seen 20,188 samples
[2023-07-14 14:34:21] Starting data epoch 125 in logical epoch 125
[2023-07-14 14:34:21] [data] Shuffling data
[2023-07-14 14:34:21] [data] Done reading 20,192 sentences
[2023-07-14 14:34:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:35:47] Seen 20,188 samples
[2023-07-14 14:35:47] Starting data epoch 126 in logical epoch 126
[2023-07-14 14:35:47] [data] Shuffling data
[2023-07-14 14:35:47] [data] Done reading 20,192 sentences
[2023-07-14 14:35:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:37:11] Seen 20,188 samples
[2023-07-14 14:37:11] Starting data epoch 127 in logical epoch 127
[2023-07-14 14:37:11] [data] Shuffling data
[2023-07-14 14:37:11] [data] Done reading 20,192 sentences
[2023-07-14 14:37:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:38:29] Ep. 127 : Up. 21000 : Sen. 18,667 : Cost 0.73653394 * 3,750,348 @ 4,520 after 78,637,387 : Time 520.90s : 7199.73 words/s : gNorm 1.0621
[2023-07-14 14:38:36] Seen 20,188 samples
[2023-07-14 14:38:36] Starting data epoch 128 in logical epoch 128
[2023-07-14 14:38:36] [data] Shuffling data
[2023-07-14 14:38:36] [data] Done reading 20,192 sentences
[2023-07-14 14:38:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:40:01] Seen 20,188 samples
[2023-07-14 14:40:02] Starting data epoch 129 in logical epoch 129
[2023-07-14 14:40:02] [data] Shuffling data
[2023-07-14 14:40:02] [data] Done reading 20,192 sentences
[2023-07-14 14:40:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:41:26] Seen 20,188 samples
[2023-07-14 14:41:26] Starting data epoch 130 in logical epoch 130
[2023-07-14 14:41:26] [data] Shuffling data
[2023-07-14 14:41:26] [data] Done reading 20,192 sentences
[2023-07-14 14:41:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:42:52] Seen 20,188 samples
[2023-07-14 14:42:52] Starting data epoch 131 in logical epoch 131
[2023-07-14 14:42:52] Training finished
[2023-07-14 14:43:01] [valid] Ep. 131 : Up. 21507 : cross-entropy : 107.23 : stalled 7 times (last best: 100.389)
[2023-07-14 14:43:43] [valid] Ep. 131 : Up. 21507 : translation : 0 : new best
[2023-07-14 14:43:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:43:44] Saving Adam parameters
[2023-07-14 14:43:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 14:43:52] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:43:52] [marian] Running on node21.datos.cluster.uy as process 31713 with command line:
[2023-07-14 14:43:52] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 140 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 14:43:52] [config] after: 0e
[2023-07-14 14:43:52] [config] after-batches: 0
[2023-07-14 14:43:52] [config] after-epochs: 140
[2023-07-14 14:43:52] [config] all-caps-every: 0
[2023-07-14 14:43:52] [config] allow-unk: false
[2023-07-14 14:43:52] [config] authors: false
[2023-07-14 14:43:52] [config] beam-size: 6
[2023-07-14 14:43:52] [config] bert-class-symbol: "[CLS]"
[2023-07-14 14:43:52] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 14:43:52] [config] bert-masking-fraction: 0.15
[2023-07-14 14:43:52] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 14:43:52] [config] bert-train-type-embeddings: true
[2023-07-14 14:43:52] [config] bert-type-vocab-size: 2
[2023-07-14 14:43:52] [config] build-info: ""
[2023-07-14 14:43:52] [config] check-gradient-nan: false
[2023-07-14 14:43:52] [config] check-nan: false
[2023-07-14 14:43:52] [config] cite: false
[2023-07-14 14:43:52] [config] clip-norm: 1
[2023-07-14 14:43:52] [config] cost-scaling:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] cost-type: ce-sum
[2023-07-14 14:43:52] [config] cpu-threads: 0
[2023-07-14 14:43:52] [config] data-threads: 8
[2023-07-14 14:43:52] [config] data-weighting: ""
[2023-07-14 14:43:52] [config] data-weighting-type: sentence
[2023-07-14 14:43:52] [config] dec-cell: gru
[2023-07-14 14:43:52] [config] dec-cell-base-depth: 2
[2023-07-14 14:43:52] [config] dec-cell-high-depth: 1
[2023-07-14 14:43:52] [config] dec-depth: 1
[2023-07-14 14:43:52] [config] devices:
[2023-07-14 14:43:52] [config]   - 0
[2023-07-14 14:43:52] [config] dim-emb: 512
[2023-07-14 14:43:52] [config] dim-rnn: 1024
[2023-07-14 14:43:52] [config] dim-vocabs:
[2023-07-14 14:43:52] [config]   - 16384
[2023-07-14 14:43:52] [config]   - 16384
[2023-07-14 14:43:52] [config] disp-first: 0
[2023-07-14 14:43:52] [config] disp-freq: 1000u
[2023-07-14 14:43:52] [config] disp-label-counts: true
[2023-07-14 14:43:52] [config] dropout-rnn: 0.2
[2023-07-14 14:43:52] [config] dropout-src: 0.1
[2023-07-14 14:43:52] [config] dropout-trg: 0.1
[2023-07-14 14:43:52] [config] dump-config: ""
[2023-07-14 14:43:52] [config] dynamic-gradient-scaling:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] early-stopping: 10
[2023-07-14 14:43:52] [config] early-stopping-on: first
[2023-07-14 14:43:52] [config] embedding-fix-src: false
[2023-07-14 14:43:52] [config] embedding-fix-trg: false
[2023-07-14 14:43:52] [config] embedding-normalization: false
[2023-07-14 14:43:52] [config] embedding-vectors:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] enc-cell: gru
[2023-07-14 14:43:52] [config] enc-cell-depth: 1
[2023-07-14 14:43:52] [config] enc-depth: 1
[2023-07-14 14:43:52] [config] enc-type: bidirectional
[2023-07-14 14:43:52] [config] english-title-case-every: 0
[2023-07-14 14:43:52] [config] exponential-smoothing: 0
[2023-07-14 14:43:52] [config] factor-weight: 1
[2023-07-14 14:43:52] [config] factors-combine: sum
[2023-07-14 14:43:52] [config] factors-dim-emb: 0
[2023-07-14 14:43:52] [config] gradient-checkpointing: false
[2023-07-14 14:43:52] [config] gradient-norm-average-window: 100
[2023-07-14 14:43:52] [config] guided-alignment: none
[2023-07-14 14:43:52] [config] guided-alignment-cost: mse
[2023-07-14 14:43:52] [config] guided-alignment-weight: 0.1
[2023-07-14 14:43:52] [config] ignore-model-config: false
[2023-07-14 14:43:52] [config] input-types:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] interpolate-env-vars: false
[2023-07-14 14:43:52] [config] keep-best: false
[2023-07-14 14:43:52] [config] label-smoothing: 0
[2023-07-14 14:43:52] [config] layer-normalization: true
[2023-07-14 14:43:52] [config] learn-rate: 0.0001
[2023-07-14 14:43:52] [config] lemma-dependency: ""
[2023-07-14 14:43:52] [config] lemma-dim-emb: 0
[2023-07-14 14:43:52] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 14:43:52] [config] log-level: info
[2023-07-14 14:43:52] [config] log-time-zone: ""
[2023-07-14 14:43:52] [config] logical-epoch:
[2023-07-14 14:43:52] [config]   - 1e
[2023-07-14 14:43:52] [config]   - 0
[2023-07-14 14:43:52] [config] lr-decay: 0
[2023-07-14 14:43:52] [config] lr-decay-freq: 50000
[2023-07-14 14:43:52] [config] lr-decay-inv-sqrt:
[2023-07-14 14:43:52] [config]   - 0
[2023-07-14 14:43:52] [config] lr-decay-repeat-warmup: false
[2023-07-14 14:43:52] [config] lr-decay-reset-optimizer: false
[2023-07-14 14:43:52] [config] lr-decay-start:
[2023-07-14 14:43:52] [config]   - 10
[2023-07-14 14:43:52] [config]   - 1
[2023-07-14 14:43:52] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 14:43:52] [config] lr-report: false
[2023-07-14 14:43:52] [config] lr-warmup: 0
[2023-07-14 14:43:52] [config] lr-warmup-at-reload: false
[2023-07-14 14:43:52] [config] lr-warmup-cycle: false
[2023-07-14 14:43:52] [config] lr-warmup-start-rate: 0
[2023-07-14 14:43:52] [config] max-length: 200
[2023-07-14 14:43:52] [config] max-length-crop: false
[2023-07-14 14:43:52] [config] max-length-factor: 3
[2023-07-14 14:43:52] [config] maxi-batch: 100
[2023-07-14 14:43:52] [config] maxi-batch-sort: trg
[2023-07-14 14:43:52] [config] mini-batch: 64
[2023-07-14 14:43:52] [config] mini-batch-fit: true
[2023-07-14 14:43:52] [config] mini-batch-fit-step: 10
[2023-07-14 14:43:52] [config] mini-batch-round-up: true
[2023-07-14 14:43:52] [config] mini-batch-track-lr: false
[2023-07-14 14:43:52] [config] mini-batch-warmup: 0
[2023-07-14 14:43:52] [config] mini-batch-words: 0
[2023-07-14 14:43:52] [config] mini-batch-words-ref: 0
[2023-07-14 14:43:52] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:43:52] [config] multi-loss-type: sum
[2023-07-14 14:43:52] [config] n-best: false
[2023-07-14 14:43:52] [config] no-nccl: false
[2023-07-14 14:43:52] [config] no-reload: false
[2023-07-14 14:43:52] [config] no-restore-corpus: false
[2023-07-14 14:43:52] [config] normalize: 0.6
[2023-07-14 14:43:52] [config] normalize-gradient: false
[2023-07-14 14:43:52] [config] num-devices: 0
[2023-07-14 14:43:52] [config] optimizer: adam
[2023-07-14 14:43:52] [config] optimizer-delay: 1
[2023-07-14 14:43:52] [config] optimizer-params:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] output-omit-bias: false
[2023-07-14 14:43:52] [config] overwrite: false
[2023-07-14 14:43:52] [config] precision:
[2023-07-14 14:43:52] [config]   - float32
[2023-07-14 14:43:52] [config]   - float32
[2023-07-14 14:43:52] [config] pretrained-model: ""
[2023-07-14 14:43:52] [config] quantize-biases: false
[2023-07-14 14:43:52] [config] quantize-bits: 0
[2023-07-14 14:43:52] [config] quantize-log-based: false
[2023-07-14 14:43:52] [config] quantize-optimization-steps: 0
[2023-07-14 14:43:52] [config] quiet: false
[2023-07-14 14:43:52] [config] quiet-translation: true
[2023-07-14 14:43:52] [config] relative-paths: false
[2023-07-14 14:43:52] [config] right-left: false
[2023-07-14 14:43:52] [config] save-freq: 10000u
[2023-07-14 14:43:52] [config] seed: 1234
[2023-07-14 14:43:52] [config] sentencepiece-alphas:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] sentencepiece-max-lines: 2000000
[2023-07-14 14:43:52] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 14:43:52] [config] sharding: global
[2023-07-14 14:43:52] [config] shuffle: data
[2023-07-14 14:43:52] [config] shuffle-in-ram: false
[2023-07-14 14:43:52] [config] sigterm: save-and-exit
[2023-07-14 14:43:52] [config] skip: false
[2023-07-14 14:43:52] [config] sqlite: ""
[2023-07-14 14:43:52] [config] sqlite-drop: false
[2023-07-14 14:43:52] [config] sync-freq: 200u
[2023-07-14 14:43:52] [config] sync-sgd: false
[2023-07-14 14:43:52] [config] tempdir: /tmp
[2023-07-14 14:43:52] [config] tied-embeddings: false
[2023-07-14 14:43:52] [config] tied-embeddings-all: true
[2023-07-14 14:43:52] [config] tied-embeddings-src: false
[2023-07-14 14:43:52] [config] train-embedder-rank:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] train-sets:
[2023-07-14 14:43:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 14:43:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 14:43:52] [config] transformer-aan-activation: swish
[2023-07-14 14:43:52] [config] transformer-aan-depth: 2
[2023-07-14 14:43:52] [config] transformer-aan-nogate: false
[2023-07-14 14:43:52] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 14:43:52] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 14:43:52] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 14:43:52] [config] transformer-depth-scaling: false
[2023-07-14 14:43:52] [config] transformer-dim-aan: 2048
[2023-07-14 14:43:52] [config] transformer-dim-ffn: 2048
[2023-07-14 14:43:52] [config] transformer-dropout: 0
[2023-07-14 14:43:52] [config] transformer-dropout-attention: 0
[2023-07-14 14:43:52] [config] transformer-dropout-ffn: 0
[2023-07-14 14:43:52] [config] transformer-ffn-activation: swish
[2023-07-14 14:43:52] [config] transformer-ffn-depth: 2
[2023-07-14 14:43:52] [config] transformer-guided-alignment-layer: last
[2023-07-14 14:43:52] [config] transformer-heads: 8
[2023-07-14 14:43:52] [config] transformer-no-projection: false
[2023-07-14 14:43:52] [config] transformer-pool: false
[2023-07-14 14:43:52] [config] transformer-postprocess: dan
[2023-07-14 14:43:52] [config] transformer-postprocess-emb: d
[2023-07-14 14:43:52] [config] transformer-postprocess-top: ""
[2023-07-14 14:43:52] [config] transformer-preprocess: ""
[2023-07-14 14:43:52] [config] transformer-tied-layers:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] transformer-train-position-embeddings: false
[2023-07-14 14:43:52] [config] tsv: false
[2023-07-14 14:43:52] [config] tsv-fields: 0
[2023-07-14 14:43:52] [config] type: amun
[2023-07-14 14:43:52] [config] ulr: false
[2023-07-14 14:43:52] [config] ulr-dim-emb: 0
[2023-07-14 14:43:52] [config] ulr-dropout: 0
[2023-07-14 14:43:52] [config] ulr-keys-vectors: ""
[2023-07-14 14:43:52] [config] ulr-query-vectors: ""
[2023-07-14 14:43:52] [config] ulr-softmax-temperature: 1
[2023-07-14 14:43:52] [config] ulr-trainable-transformation: false
[2023-07-14 14:43:52] [config] unlikelihood-loss: false
[2023-07-14 14:43:52] [config] valid-freq: 5000000
[2023-07-14 14:43:52] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 14:43:52] [config] valid-max-length: 1000
[2023-07-14 14:43:52] [config] valid-metrics:
[2023-07-14 14:43:52] [config]   - cross-entropy
[2023-07-14 14:43:52] [config]   - translation
[2023-07-14 14:43:52] [config] valid-mini-batch: 32
[2023-07-14 14:43:52] [config] valid-reset-stalled: false
[2023-07-14 14:43:52] [config] valid-script-args:
[2023-07-14 14:43:52] [config]   []
[2023-07-14 14:43:52] [config] valid-script-path: ""
[2023-07-14 14:43:52] [config] valid-sets:
[2023-07-14 14:43:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 14:43:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 14:43:52] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 14:43:52] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:43:52] [config] vocabs:
[2023-07-14 14:43:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 14:43:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 14:43:52] [config] word-penalty: 0
[2023-07-14 14:43:52] [config] word-scores: false
[2023-07-14 14:43:52] [config] workspace: 3000
[2023-07-14 14:43:52] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 14:43:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:43:52] [training] Using single-device training
[2023-07-14 14:43:53] Synced seed 1234
[2023-07-14 14:43:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 14:43:53] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 14:43:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 14:43:53] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 14:43:53] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 14:43:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:43:54] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 14:43:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 14:43:54] [comm] Using global sharding
[2023-07-14 14:43:54] [comm] NCCLCommunicators constructed successfully
[2023-07-14 14:43:54] [training] Using 1 GPUs
[2023-07-14 14:43:54] [logits] Applying loss function for 1 factor(s)
[2023-07-14 14:43:54] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:43:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 14:43:54] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:45:18] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 14:45:18] [valid] No post-processing script given for validating translator
[2023-07-14 14:45:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 14:45:18] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 14:45:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 14:45:18] [comm] Using global sharding
[2023-07-14 14:45:18] [comm] NCCLCommunicators constructed successfully
[2023-07-14 14:45:18] [training] Using 1 GPUs
[2023-07-14 14:45:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 14:45:19] Loading Adam parameters
[2023-07-14 14:45:19] [memory] Reserving 322 MB, device gpu0
[2023-07-14 14:45:19] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:45:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 14:45:19] [data] Restoring the corpus state to epoch 131, batch 21507
[2023-07-14 14:45:19] [data] Shuffling data
[2023-07-14 14:45:19] [data] Done reading 20,192 sentences
[2023-07-14 14:45:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:45:19] Training started
[2023-07-14 14:45:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 14:45:20] [memory] Reserving 161 MB, device gpu0
[2023-07-14 14:45:20] Parameter type float32, optimization type float32, casting types false
[2023-07-14 14:46:44] Seen 20,188 samples
[2023-07-14 14:46:44] Starting data epoch 132 in logical epoch 132
[2023-07-14 14:46:44] [data] Shuffling data
[2023-07-14 14:46:44] [data] Done reading 20,192 sentences
[2023-07-14 14:46:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:48:08] Seen 20,188 samples
[2023-07-14 14:48:08] Starting data epoch 133 in logical epoch 133
[2023-07-14 14:48:08] [data] Shuffling data
[2023-07-14 14:48:08] [data] Done reading 20,192 sentences
[2023-07-14 14:48:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:49:31] Ep. 133 : Up. 22000 : Sen. 19,957 : Cost 0.68324512 * 3,751,525 @ 3,942 after 82,388,912 : Time 253.14s : 14820.17 words/s : gNorm 1.0989
[2023-07-14 14:49:34] Seen 20,188 samples
[2023-07-14 14:49:34] Starting data epoch 134 in logical epoch 134
[2023-07-14 14:49:34] [data] Shuffling data
[2023-07-14 14:49:34] [data] Done reading 20,192 sentences
[2023-07-14 14:49:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:50:59] Seen 20,188 samples
[2023-07-14 14:50:59] Starting data epoch 135 in logical epoch 135
[2023-07-14 14:50:59] [data] Shuffling data
[2023-07-14 14:50:59] [data] Done reading 20,192 sentences
[2023-07-14 14:50:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:52:24] Seen 20,188 samples
[2023-07-14 14:52:24] Starting data epoch 136 in logical epoch 136
[2023-07-14 14:52:24] [data] Shuffling data
[2023-07-14 14:52:24] [data] Done reading 20,192 sentences
[2023-07-14 14:52:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:53:50] Seen 20,188 samples
[2023-07-14 14:53:50] Starting data epoch 137 in logical epoch 137
[2023-07-14 14:53:50] [data] Shuffling data
[2023-07-14 14:53:50] [data] Done reading 20,192 sentences
[2023-07-14 14:53:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:55:15] Seen 20,188 samples
[2023-07-14 14:55:15] Starting data epoch 138 in logical epoch 138
[2023-07-14 14:55:15] [data] Shuffling data
[2023-07-14 14:55:15] [data] Done reading 20,192 sentences
[2023-07-14 14:55:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:56:41] Seen 20,188 samples
[2023-07-14 14:56:41] Starting data epoch 139 in logical epoch 139
[2023-07-14 14:56:41] [data] Shuffling data
[2023-07-14 14:56:41] [data] Done reading 20,192 sentences
[2023-07-14 14:56:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:58:07] Seen 20,188 samples
[2023-07-14 14:58:07] Starting data epoch 140 in logical epoch 140
[2023-07-14 14:58:07] [data] Shuffling data
[2023-07-14 14:58:07] [data] Done reading 20,192 sentences
[2023-07-14 14:58:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 14:58:08] Ep. 140 : Up. 23000 : Sen. 187 : Cost 0.64606351 * 3,735,719 @ 3,258 after 86,124,631 : Time 517.52s : 7218.53 words/s : gNorm 1.1073
[2023-07-14 14:59:33] Seen 20,188 samples
[2023-07-14 14:59:33] Starting data epoch 141 in logical epoch 141
[2023-07-14 14:59:33] Training finished
[2023-07-14 14:59:42] [valid] Ep. 141 : Up. 23164 : cross-entropy : 108.358 : stalled 8 times (last best: 100.389)
[2023-07-14 15:00:24] [valid] Ep. 141 : Up. 23164 : translation : 0 : new best
[2023-07-14 15:00:24] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:00:26] Saving Adam parameters
[2023-07-14 15:00:26] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:00:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:00:34] [marian] Running on node21.datos.cluster.uy as process 32969 with command line:
[2023-07-14 15:00:34] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 150 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 15:00:34] [config] after: 0e
[2023-07-14 15:00:34] [config] after-batches: 0
[2023-07-14 15:00:34] [config] after-epochs: 150
[2023-07-14 15:00:34] [config] all-caps-every: 0
[2023-07-14 15:00:34] [config] allow-unk: false
[2023-07-14 15:00:34] [config] authors: false
[2023-07-14 15:00:34] [config] beam-size: 6
[2023-07-14 15:00:34] [config] bert-class-symbol: "[CLS]"
[2023-07-14 15:00:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 15:00:34] [config] bert-masking-fraction: 0.15
[2023-07-14 15:00:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 15:00:34] [config] bert-train-type-embeddings: true
[2023-07-14 15:00:34] [config] bert-type-vocab-size: 2
[2023-07-14 15:00:34] [config] build-info: ""
[2023-07-14 15:00:34] [config] check-gradient-nan: false
[2023-07-14 15:00:34] [config] check-nan: false
[2023-07-14 15:00:34] [config] cite: false
[2023-07-14 15:00:34] [config] clip-norm: 1
[2023-07-14 15:00:34] [config] cost-scaling:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] cost-type: ce-sum
[2023-07-14 15:00:34] [config] cpu-threads: 0
[2023-07-14 15:00:34] [config] data-threads: 8
[2023-07-14 15:00:34] [config] data-weighting: ""
[2023-07-14 15:00:34] [config] data-weighting-type: sentence
[2023-07-14 15:00:34] [config] dec-cell: gru
[2023-07-14 15:00:34] [config] dec-cell-base-depth: 2
[2023-07-14 15:00:34] [config] dec-cell-high-depth: 1
[2023-07-14 15:00:34] [config] dec-depth: 1
[2023-07-14 15:00:34] [config] devices:
[2023-07-14 15:00:34] [config]   - 0
[2023-07-14 15:00:34] [config] dim-emb: 512
[2023-07-14 15:00:34] [config] dim-rnn: 1024
[2023-07-14 15:00:34] [config] dim-vocabs:
[2023-07-14 15:00:34] [config]   - 16384
[2023-07-14 15:00:34] [config]   - 16384
[2023-07-14 15:00:34] [config] disp-first: 0
[2023-07-14 15:00:34] [config] disp-freq: 1000u
[2023-07-14 15:00:34] [config] disp-label-counts: true
[2023-07-14 15:00:34] [config] dropout-rnn: 0.2
[2023-07-14 15:00:34] [config] dropout-src: 0.1
[2023-07-14 15:00:34] [config] dropout-trg: 0.1
[2023-07-14 15:00:34] [config] dump-config: ""
[2023-07-14 15:00:34] [config] dynamic-gradient-scaling:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] early-stopping: 10
[2023-07-14 15:00:34] [config] early-stopping-on: first
[2023-07-14 15:00:34] [config] embedding-fix-src: false
[2023-07-14 15:00:34] [config] embedding-fix-trg: false
[2023-07-14 15:00:34] [config] embedding-normalization: false
[2023-07-14 15:00:34] [config] embedding-vectors:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] enc-cell: gru
[2023-07-14 15:00:34] [config] enc-cell-depth: 1
[2023-07-14 15:00:34] [config] enc-depth: 1
[2023-07-14 15:00:34] [config] enc-type: bidirectional
[2023-07-14 15:00:34] [config] english-title-case-every: 0
[2023-07-14 15:00:34] [config] exponential-smoothing: 0
[2023-07-14 15:00:34] [config] factor-weight: 1
[2023-07-14 15:00:34] [config] factors-combine: sum
[2023-07-14 15:00:34] [config] factors-dim-emb: 0
[2023-07-14 15:00:34] [config] gradient-checkpointing: false
[2023-07-14 15:00:34] [config] gradient-norm-average-window: 100
[2023-07-14 15:00:34] [config] guided-alignment: none
[2023-07-14 15:00:34] [config] guided-alignment-cost: mse
[2023-07-14 15:00:34] [config] guided-alignment-weight: 0.1
[2023-07-14 15:00:34] [config] ignore-model-config: false
[2023-07-14 15:00:34] [config] input-types:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] interpolate-env-vars: false
[2023-07-14 15:00:34] [config] keep-best: false
[2023-07-14 15:00:34] [config] label-smoothing: 0
[2023-07-14 15:00:34] [config] layer-normalization: true
[2023-07-14 15:00:34] [config] learn-rate: 0.0001
[2023-07-14 15:00:34] [config] lemma-dependency: ""
[2023-07-14 15:00:34] [config] lemma-dim-emb: 0
[2023-07-14 15:00:34] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:00:34] [config] log-level: info
[2023-07-14 15:00:34] [config] log-time-zone: ""
[2023-07-14 15:00:34] [config] logical-epoch:
[2023-07-14 15:00:34] [config]   - 1e
[2023-07-14 15:00:34] [config]   - 0
[2023-07-14 15:00:34] [config] lr-decay: 0
[2023-07-14 15:00:34] [config] lr-decay-freq: 50000
[2023-07-14 15:00:34] [config] lr-decay-inv-sqrt:
[2023-07-14 15:00:34] [config]   - 0
[2023-07-14 15:00:34] [config] lr-decay-repeat-warmup: false
[2023-07-14 15:00:34] [config] lr-decay-reset-optimizer: false
[2023-07-14 15:00:34] [config] lr-decay-start:
[2023-07-14 15:00:34] [config]   - 10
[2023-07-14 15:00:34] [config]   - 1
[2023-07-14 15:00:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 15:00:34] [config] lr-report: false
[2023-07-14 15:00:34] [config] lr-warmup: 0
[2023-07-14 15:00:34] [config] lr-warmup-at-reload: false
[2023-07-14 15:00:34] [config] lr-warmup-cycle: false
[2023-07-14 15:00:34] [config] lr-warmup-start-rate: 0
[2023-07-14 15:00:34] [config] max-length: 200
[2023-07-14 15:00:34] [config] max-length-crop: false
[2023-07-14 15:00:34] [config] max-length-factor: 3
[2023-07-14 15:00:34] [config] maxi-batch: 100
[2023-07-14 15:00:34] [config] maxi-batch-sort: trg
[2023-07-14 15:00:34] [config] mini-batch: 64
[2023-07-14 15:00:34] [config] mini-batch-fit: true
[2023-07-14 15:00:34] [config] mini-batch-fit-step: 10
[2023-07-14 15:00:34] [config] mini-batch-round-up: true
[2023-07-14 15:00:34] [config] mini-batch-track-lr: false
[2023-07-14 15:00:34] [config] mini-batch-warmup: 0
[2023-07-14 15:00:34] [config] mini-batch-words: 0
[2023-07-14 15:00:34] [config] mini-batch-words-ref: 0
[2023-07-14 15:00:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:00:34] [config] multi-loss-type: sum
[2023-07-14 15:00:34] [config] n-best: false
[2023-07-14 15:00:34] [config] no-nccl: false
[2023-07-14 15:00:34] [config] no-reload: false
[2023-07-14 15:00:34] [config] no-restore-corpus: false
[2023-07-14 15:00:34] [config] normalize: 0.6
[2023-07-14 15:00:34] [config] normalize-gradient: false
[2023-07-14 15:00:34] [config] num-devices: 0
[2023-07-14 15:00:34] [config] optimizer: adam
[2023-07-14 15:00:34] [config] optimizer-delay: 1
[2023-07-14 15:00:34] [config] optimizer-params:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] output-omit-bias: false
[2023-07-14 15:00:34] [config] overwrite: false
[2023-07-14 15:00:34] [config] precision:
[2023-07-14 15:00:34] [config]   - float32
[2023-07-14 15:00:34] [config]   - float32
[2023-07-14 15:00:34] [config] pretrained-model: ""
[2023-07-14 15:00:34] [config] quantize-biases: false
[2023-07-14 15:00:34] [config] quantize-bits: 0
[2023-07-14 15:00:34] [config] quantize-log-based: false
[2023-07-14 15:00:34] [config] quantize-optimization-steps: 0
[2023-07-14 15:00:34] [config] quiet: false
[2023-07-14 15:00:34] [config] quiet-translation: true
[2023-07-14 15:00:34] [config] relative-paths: false
[2023-07-14 15:00:34] [config] right-left: false
[2023-07-14 15:00:34] [config] save-freq: 10000u
[2023-07-14 15:00:34] [config] seed: 1234
[2023-07-14 15:00:34] [config] sentencepiece-alphas:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] sentencepiece-max-lines: 2000000
[2023-07-14 15:00:34] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 15:00:34] [config] sharding: global
[2023-07-14 15:00:34] [config] shuffle: data
[2023-07-14 15:00:34] [config] shuffle-in-ram: false
[2023-07-14 15:00:34] [config] sigterm: save-and-exit
[2023-07-14 15:00:34] [config] skip: false
[2023-07-14 15:00:34] [config] sqlite: ""
[2023-07-14 15:00:34] [config] sqlite-drop: false
[2023-07-14 15:00:34] [config] sync-freq: 200u
[2023-07-14 15:00:34] [config] sync-sgd: false
[2023-07-14 15:00:34] [config] tempdir: /tmp
[2023-07-14 15:00:34] [config] tied-embeddings: false
[2023-07-14 15:00:34] [config] tied-embeddings-all: true
[2023-07-14 15:00:34] [config] tied-embeddings-src: false
[2023-07-14 15:00:34] [config] train-embedder-rank:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] train-sets:
[2023-07-14 15:00:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 15:00:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 15:00:34] [config] transformer-aan-activation: swish
[2023-07-14 15:00:34] [config] transformer-aan-depth: 2
[2023-07-14 15:00:34] [config] transformer-aan-nogate: false
[2023-07-14 15:00:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 15:00:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 15:00:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 15:00:34] [config] transformer-depth-scaling: false
[2023-07-14 15:00:34] [config] transformer-dim-aan: 2048
[2023-07-14 15:00:34] [config] transformer-dim-ffn: 2048
[2023-07-14 15:00:34] [config] transformer-dropout: 0
[2023-07-14 15:00:34] [config] transformer-dropout-attention: 0
[2023-07-14 15:00:34] [config] transformer-dropout-ffn: 0
[2023-07-14 15:00:34] [config] transformer-ffn-activation: swish
[2023-07-14 15:00:34] [config] transformer-ffn-depth: 2
[2023-07-14 15:00:34] [config] transformer-guided-alignment-layer: last
[2023-07-14 15:00:34] [config] transformer-heads: 8
[2023-07-14 15:00:34] [config] transformer-no-projection: false
[2023-07-14 15:00:34] [config] transformer-pool: false
[2023-07-14 15:00:34] [config] transformer-postprocess: dan
[2023-07-14 15:00:34] [config] transformer-postprocess-emb: d
[2023-07-14 15:00:34] [config] transformer-postprocess-top: ""
[2023-07-14 15:00:34] [config] transformer-preprocess: ""
[2023-07-14 15:00:34] [config] transformer-tied-layers:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] transformer-train-position-embeddings: false
[2023-07-14 15:00:34] [config] tsv: false
[2023-07-14 15:00:34] [config] tsv-fields: 0
[2023-07-14 15:00:34] [config] type: amun
[2023-07-14 15:00:34] [config] ulr: false
[2023-07-14 15:00:34] [config] ulr-dim-emb: 0
[2023-07-14 15:00:34] [config] ulr-dropout: 0
[2023-07-14 15:00:34] [config] ulr-keys-vectors: ""
[2023-07-14 15:00:34] [config] ulr-query-vectors: ""
[2023-07-14 15:00:34] [config] ulr-softmax-temperature: 1
[2023-07-14 15:00:34] [config] ulr-trainable-transformation: false
[2023-07-14 15:00:34] [config] unlikelihood-loss: false
[2023-07-14 15:00:34] [config] valid-freq: 5000000
[2023-07-14 15:00:34] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:00:34] [config] valid-max-length: 1000
[2023-07-14 15:00:34] [config] valid-metrics:
[2023-07-14 15:00:34] [config]   - cross-entropy
[2023-07-14 15:00:34] [config]   - translation
[2023-07-14 15:00:34] [config] valid-mini-batch: 32
[2023-07-14 15:00:34] [config] valid-reset-stalled: false
[2023-07-14 15:00:34] [config] valid-script-args:
[2023-07-14 15:00:34] [config]   []
[2023-07-14 15:00:34] [config] valid-script-path: ""
[2023-07-14 15:00:34] [config] valid-sets:
[2023-07-14 15:00:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 15:00:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 15:00:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 15:00:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:00:34] [config] vocabs:
[2023-07-14 15:00:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:00:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:00:34] [config] word-penalty: 0
[2023-07-14 15:00:34] [config] word-scores: false
[2023-07-14 15:00:34] [config] workspace: 3000
[2023-07-14 15:00:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:00:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:00:34] [training] Using single-device training
[2023-07-14 15:00:34] Synced seed 1234
[2023-07-14 15:00:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:00:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 15:00:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:00:35] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 15:00:35] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 15:00:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:00:36] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:00:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:00:36] [comm] Using global sharding
[2023-07-14 15:00:36] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:00:36] [training] Using 1 GPUs
[2023-07-14 15:00:36] [logits] Applying loss function for 1 factor(s)
[2023-07-14 15:00:36] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:00:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 15:00:36] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:02:00] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 15:02:00] [valid] No post-processing script given for validating translator
[2023-07-14 15:02:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:02:00] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:02:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:02:00] [comm] Using global sharding
[2023-07-14 15:02:01] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:02:01] [training] Using 1 GPUs
[2023-07-14 15:02:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:02:02] Loading Adam parameters
[2023-07-14 15:02:02] [memory] Reserving 322 MB, device gpu0
[2023-07-14 15:02:02] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:02:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:02:02] [data] Restoring the corpus state to epoch 141, batch 23164
[2023-07-14 15:02:02] [data] Shuffling data
[2023-07-14 15:02:02] [data] Done reading 20,192 sentences
[2023-07-14 15:02:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:02:02] Training started
[2023-07-14 15:02:02] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 15:02:02] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:02:02] Parameter type float32, optimization type float32, casting types false
[2023-07-14 15:03:27] Seen 20,188 samples
[2023-07-14 15:03:27] Starting data epoch 142 in logical epoch 142
[2023-07-14 15:03:27] [data] Shuffling data
[2023-07-14 15:03:27] [data] Done reading 20,192 sentences
[2023-07-14 15:03:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:04:53] Seen 20,188 samples
[2023-07-14 15:04:53] Starting data epoch 143 in logical epoch 143
[2023-07-14 15:04:53] [data] Shuffling data
[2023-07-14 15:04:53] [data] Done reading 20,192 sentences
[2023-07-14 15:04:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:06:18] Seen 20,188 samples
[2023-07-14 15:06:18] Starting data epoch 144 in logical epoch 144
[2023-07-14 15:06:18] [data] Shuffling data
[2023-07-14 15:06:18] [data] Done reading 20,192 sentences
[2023-07-14 15:06:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:07:43] Seen 20,188 samples
[2023-07-14 15:07:43] Starting data epoch 145 in logical epoch 145
[2023-07-14 15:07:43] [data] Shuffling data
[2023-07-14 15:07:43] [data] Done reading 20,192 sentences
[2023-07-14 15:07:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:09:07] Seen 20,188 samples
[2023-07-14 15:09:07] Starting data epoch 146 in logical epoch 146
[2023-07-14 15:09:07] [data] Shuffling data
[2023-07-14 15:09:07] [data] Done reading 20,192 sentences
[2023-07-14 15:09:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:09:10] Ep. 146 : Up. 24000 : Sen. 861 : Cost 0.61138213 * 3,733,036 @ 3,011 after 89,857,667 : Time 429.98s : 8681.95 words/s : gNorm 1.0350
[2023-07-14 15:10:32] Seen 20,188 samples
[2023-07-14 15:10:32] Starting data epoch 147 in logical epoch 147
[2023-07-14 15:10:32] [data] Shuffling data
[2023-07-14 15:10:32] [data] Done reading 20,192 sentences
[2023-07-14 15:10:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:11:57] Seen 20,188 samples
[2023-07-14 15:11:57] Starting data epoch 148 in logical epoch 148
[2023-07-14 15:11:57] [data] Shuffling data
[2023-07-14 15:11:57] [data] Done reading 20,192 sentences
[2023-07-14 15:11:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:13:22] Seen 20,188 samples
[2023-07-14 15:13:22] Starting data epoch 149 in logical epoch 149
[2023-07-14 15:13:22] [data] Shuffling data
[2023-07-14 15:13:22] [data] Done reading 20,192 sentences
[2023-07-14 15:13:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:14:47] Seen 20,188 samples
[2023-07-14 15:14:47] Starting data epoch 150 in logical epoch 150
[2023-07-14 15:14:47] [data] Shuffling data
[2023-07-14 15:14:47] [data] Done reading 20,192 sentences
[2023-07-14 15:14:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:16:12] Seen 20,188 samples
[2023-07-14 15:16:12] Starting data epoch 151 in logical epoch 151
[2023-07-14 15:16:12] Training finished
[2023-07-14 15:16:21] [valid] Ep. 151 : Up. 24820 : cross-entropy : 109.598 : stalled 9 times (last best: 100.389)
[2023-07-14 15:17:00] [valid] Ep. 151 : Up. 24820 : translation : 0 : new best
[2023-07-14 15:17:00] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:17:02] Saving Adam parameters
[2023-07-14 15:17:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:17:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:17:12] [marian] Running on node21.datos.cluster.uy as process 33920 with command line:
[2023-07-14 15:17:12] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 160 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 15:17:12] [config] after: 0e
[2023-07-14 15:17:12] [config] after-batches: 0
[2023-07-14 15:17:12] [config] after-epochs: 160
[2023-07-14 15:17:12] [config] all-caps-every: 0
[2023-07-14 15:17:12] [config] allow-unk: false
[2023-07-14 15:17:12] [config] authors: false
[2023-07-14 15:17:12] [config] beam-size: 6
[2023-07-14 15:17:12] [config] bert-class-symbol: "[CLS]"
[2023-07-14 15:17:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 15:17:12] [config] bert-masking-fraction: 0.15
[2023-07-14 15:17:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 15:17:12] [config] bert-train-type-embeddings: true
[2023-07-14 15:17:12] [config] bert-type-vocab-size: 2
[2023-07-14 15:17:12] [config] build-info: ""
[2023-07-14 15:17:12] [config] check-gradient-nan: false
[2023-07-14 15:17:12] [config] check-nan: false
[2023-07-14 15:17:12] [config] cite: false
[2023-07-14 15:17:12] [config] clip-norm: 1
[2023-07-14 15:17:12] [config] cost-scaling:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] cost-type: ce-sum
[2023-07-14 15:17:12] [config] cpu-threads: 0
[2023-07-14 15:17:12] [config] data-threads: 8
[2023-07-14 15:17:12] [config] data-weighting: ""
[2023-07-14 15:17:12] [config] data-weighting-type: sentence
[2023-07-14 15:17:12] [config] dec-cell: gru
[2023-07-14 15:17:12] [config] dec-cell-base-depth: 2
[2023-07-14 15:17:12] [config] dec-cell-high-depth: 1
[2023-07-14 15:17:12] [config] dec-depth: 1
[2023-07-14 15:17:12] [config] devices:
[2023-07-14 15:17:12] [config]   - 0
[2023-07-14 15:17:12] [config] dim-emb: 512
[2023-07-14 15:17:12] [config] dim-rnn: 1024
[2023-07-14 15:17:12] [config] dim-vocabs:
[2023-07-14 15:17:12] [config]   - 16384
[2023-07-14 15:17:12] [config]   - 16384
[2023-07-14 15:17:12] [config] disp-first: 0
[2023-07-14 15:17:12] [config] disp-freq: 1000u
[2023-07-14 15:17:12] [config] disp-label-counts: true
[2023-07-14 15:17:12] [config] dropout-rnn: 0.2
[2023-07-14 15:17:12] [config] dropout-src: 0.1
[2023-07-14 15:17:12] [config] dropout-trg: 0.1
[2023-07-14 15:17:12] [config] dump-config: ""
[2023-07-14 15:17:12] [config] dynamic-gradient-scaling:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] early-stopping: 10
[2023-07-14 15:17:12] [config] early-stopping-on: first
[2023-07-14 15:17:12] [config] embedding-fix-src: false
[2023-07-14 15:17:12] [config] embedding-fix-trg: false
[2023-07-14 15:17:12] [config] embedding-normalization: false
[2023-07-14 15:17:12] [config] embedding-vectors:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] enc-cell: gru
[2023-07-14 15:17:12] [config] enc-cell-depth: 1
[2023-07-14 15:17:12] [config] enc-depth: 1
[2023-07-14 15:17:12] [config] enc-type: bidirectional
[2023-07-14 15:17:12] [config] english-title-case-every: 0
[2023-07-14 15:17:12] [config] exponential-smoothing: 0
[2023-07-14 15:17:12] [config] factor-weight: 1
[2023-07-14 15:17:12] [config] factors-combine: sum
[2023-07-14 15:17:12] [config] factors-dim-emb: 0
[2023-07-14 15:17:12] [config] gradient-checkpointing: false
[2023-07-14 15:17:12] [config] gradient-norm-average-window: 100
[2023-07-14 15:17:12] [config] guided-alignment: none
[2023-07-14 15:17:12] [config] guided-alignment-cost: mse
[2023-07-14 15:17:12] [config] guided-alignment-weight: 0.1
[2023-07-14 15:17:12] [config] ignore-model-config: false
[2023-07-14 15:17:12] [config] input-types:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] interpolate-env-vars: false
[2023-07-14 15:17:12] [config] keep-best: false
[2023-07-14 15:17:12] [config] label-smoothing: 0
[2023-07-14 15:17:12] [config] layer-normalization: true
[2023-07-14 15:17:12] [config] learn-rate: 0.0001
[2023-07-14 15:17:12] [config] lemma-dependency: ""
[2023-07-14 15:17:12] [config] lemma-dim-emb: 0
[2023-07-14 15:17:12] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:17:12] [config] log-level: info
[2023-07-14 15:17:12] [config] log-time-zone: ""
[2023-07-14 15:17:12] [config] logical-epoch:
[2023-07-14 15:17:12] [config]   - 1e
[2023-07-14 15:17:12] [config]   - 0
[2023-07-14 15:17:12] [config] lr-decay: 0
[2023-07-14 15:17:12] [config] lr-decay-freq: 50000
[2023-07-14 15:17:12] [config] lr-decay-inv-sqrt:
[2023-07-14 15:17:12] [config]   - 0
[2023-07-14 15:17:12] [config] lr-decay-repeat-warmup: false
[2023-07-14 15:17:12] [config] lr-decay-reset-optimizer: false
[2023-07-14 15:17:12] [config] lr-decay-start:
[2023-07-14 15:17:12] [config]   - 10
[2023-07-14 15:17:12] [config]   - 1
[2023-07-14 15:17:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 15:17:12] [config] lr-report: false
[2023-07-14 15:17:12] [config] lr-warmup: 0
[2023-07-14 15:17:12] [config] lr-warmup-at-reload: false
[2023-07-14 15:17:12] [config] lr-warmup-cycle: false
[2023-07-14 15:17:12] [config] lr-warmup-start-rate: 0
[2023-07-14 15:17:12] [config] max-length: 200
[2023-07-14 15:17:12] [config] max-length-crop: false
[2023-07-14 15:17:12] [config] max-length-factor: 3
[2023-07-14 15:17:12] [config] maxi-batch: 100
[2023-07-14 15:17:12] [config] maxi-batch-sort: trg
[2023-07-14 15:17:12] [config] mini-batch: 64
[2023-07-14 15:17:12] [config] mini-batch-fit: true
[2023-07-14 15:17:12] [config] mini-batch-fit-step: 10
[2023-07-14 15:17:12] [config] mini-batch-round-up: true
[2023-07-14 15:17:12] [config] mini-batch-track-lr: false
[2023-07-14 15:17:12] [config] mini-batch-warmup: 0
[2023-07-14 15:17:12] [config] mini-batch-words: 0
[2023-07-14 15:17:12] [config] mini-batch-words-ref: 0
[2023-07-14 15:17:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:17:12] [config] multi-loss-type: sum
[2023-07-14 15:17:12] [config] n-best: false
[2023-07-14 15:17:12] [config] no-nccl: false
[2023-07-14 15:17:12] [config] no-reload: false
[2023-07-14 15:17:12] [config] no-restore-corpus: false
[2023-07-14 15:17:12] [config] normalize: 0.6
[2023-07-14 15:17:12] [config] normalize-gradient: false
[2023-07-14 15:17:12] [config] num-devices: 0
[2023-07-14 15:17:12] [config] optimizer: adam
[2023-07-14 15:17:12] [config] optimizer-delay: 1
[2023-07-14 15:17:12] [config] optimizer-params:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] output-omit-bias: false
[2023-07-14 15:17:12] [config] overwrite: false
[2023-07-14 15:17:12] [config] precision:
[2023-07-14 15:17:12] [config]   - float32
[2023-07-14 15:17:12] [config]   - float32
[2023-07-14 15:17:12] [config] pretrained-model: ""
[2023-07-14 15:17:12] [config] quantize-biases: false
[2023-07-14 15:17:12] [config] quantize-bits: 0
[2023-07-14 15:17:12] [config] quantize-log-based: false
[2023-07-14 15:17:12] [config] quantize-optimization-steps: 0
[2023-07-14 15:17:12] [config] quiet: false
[2023-07-14 15:17:12] [config] quiet-translation: true
[2023-07-14 15:17:12] [config] relative-paths: false
[2023-07-14 15:17:12] [config] right-left: false
[2023-07-14 15:17:12] [config] save-freq: 10000u
[2023-07-14 15:17:12] [config] seed: 1234
[2023-07-14 15:17:12] [config] sentencepiece-alphas:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] sentencepiece-max-lines: 2000000
[2023-07-14 15:17:12] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 15:17:12] [config] sharding: global
[2023-07-14 15:17:12] [config] shuffle: data
[2023-07-14 15:17:12] [config] shuffle-in-ram: false
[2023-07-14 15:17:12] [config] sigterm: save-and-exit
[2023-07-14 15:17:12] [config] skip: false
[2023-07-14 15:17:12] [config] sqlite: ""
[2023-07-14 15:17:12] [config] sqlite-drop: false
[2023-07-14 15:17:12] [config] sync-freq: 200u
[2023-07-14 15:17:12] [config] sync-sgd: false
[2023-07-14 15:17:12] [config] tempdir: /tmp
[2023-07-14 15:17:12] [config] tied-embeddings: false
[2023-07-14 15:17:12] [config] tied-embeddings-all: true
[2023-07-14 15:17:12] [config] tied-embeddings-src: false
[2023-07-14 15:17:12] [config] train-embedder-rank:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] train-sets:
[2023-07-14 15:17:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 15:17:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 15:17:12] [config] transformer-aan-activation: swish
[2023-07-14 15:17:12] [config] transformer-aan-depth: 2
[2023-07-14 15:17:12] [config] transformer-aan-nogate: false
[2023-07-14 15:17:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 15:17:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 15:17:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 15:17:12] [config] transformer-depth-scaling: false
[2023-07-14 15:17:12] [config] transformer-dim-aan: 2048
[2023-07-14 15:17:12] [config] transformer-dim-ffn: 2048
[2023-07-14 15:17:12] [config] transformer-dropout: 0
[2023-07-14 15:17:12] [config] transformer-dropout-attention: 0
[2023-07-14 15:17:12] [config] transformer-dropout-ffn: 0
[2023-07-14 15:17:12] [config] transformer-ffn-activation: swish
[2023-07-14 15:17:12] [config] transformer-ffn-depth: 2
[2023-07-14 15:17:12] [config] transformer-guided-alignment-layer: last
[2023-07-14 15:17:12] [config] transformer-heads: 8
[2023-07-14 15:17:12] [config] transformer-no-projection: false
[2023-07-14 15:17:12] [config] transformer-pool: false
[2023-07-14 15:17:12] [config] transformer-postprocess: dan
[2023-07-14 15:17:12] [config] transformer-postprocess-emb: d
[2023-07-14 15:17:12] [config] transformer-postprocess-top: ""
[2023-07-14 15:17:12] [config] transformer-preprocess: ""
[2023-07-14 15:17:12] [config] transformer-tied-layers:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] transformer-train-position-embeddings: false
[2023-07-14 15:17:12] [config] tsv: false
[2023-07-14 15:17:12] [config] tsv-fields: 0
[2023-07-14 15:17:12] [config] type: amun
[2023-07-14 15:17:12] [config] ulr: false
[2023-07-14 15:17:12] [config] ulr-dim-emb: 0
[2023-07-14 15:17:12] [config] ulr-dropout: 0
[2023-07-14 15:17:12] [config] ulr-keys-vectors: ""
[2023-07-14 15:17:12] [config] ulr-query-vectors: ""
[2023-07-14 15:17:12] [config] ulr-softmax-temperature: 1
[2023-07-14 15:17:12] [config] ulr-trainable-transformation: false
[2023-07-14 15:17:12] [config] unlikelihood-loss: false
[2023-07-14 15:17:12] [config] valid-freq: 5000000
[2023-07-14 15:17:12] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:17:12] [config] valid-max-length: 1000
[2023-07-14 15:17:12] [config] valid-metrics:
[2023-07-14 15:17:12] [config]   - cross-entropy
[2023-07-14 15:17:12] [config]   - translation
[2023-07-14 15:17:12] [config] valid-mini-batch: 32
[2023-07-14 15:17:12] [config] valid-reset-stalled: false
[2023-07-14 15:17:12] [config] valid-script-args:
[2023-07-14 15:17:12] [config]   []
[2023-07-14 15:17:12] [config] valid-script-path: ""
[2023-07-14 15:17:12] [config] valid-sets:
[2023-07-14 15:17:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 15:17:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 15:17:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 15:17:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:17:12] [config] vocabs:
[2023-07-14 15:17:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:17:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:17:12] [config] word-penalty: 0
[2023-07-14 15:17:12] [config] word-scores: false
[2023-07-14 15:17:12] [config] workspace: 3000
[2023-07-14 15:17:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:17:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:17:12] [training] Using single-device training
[2023-07-14 15:17:12] Synced seed 1234
[2023-07-14 15:17:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:17:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 15:17:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:17:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 15:17:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 15:17:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:17:13] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:17:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:17:13] [comm] Using global sharding
[2023-07-14 15:17:13] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:17:13] [training] Using 1 GPUs
[2023-07-14 15:17:13] [logits] Applying loss function for 1 factor(s)
[2023-07-14 15:17:13] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:17:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 15:17:14] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:18:37] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 15:18:37] [valid] No post-processing script given for validating translator
[2023-07-14 15:18:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:18:38] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:18:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:18:38] [comm] Using global sharding
[2023-07-14 15:18:38] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:18:38] [training] Using 1 GPUs
[2023-07-14 15:18:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:18:39] Loading Adam parameters
[2023-07-14 15:18:39] [memory] Reserving 322 MB, device gpu0
[2023-07-14 15:18:39] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:18:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:18:39] [data] Restoring the corpus state to epoch 151, batch 24820
[2023-07-14 15:18:39] [data] Shuffling data
[2023-07-14 15:18:39] [data] Done reading 20,192 sentences
[2023-07-14 15:18:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:18:39] Training started
[2023-07-14 15:18:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-14 15:18:39] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:18:39] Parameter type float32, optimization type float32, casting types false
[2023-07-14 15:20:02] Seen 20,188 samples
[2023-07-14 15:20:02] Starting data epoch 152 in logical epoch 152
[2023-07-14 15:20:02] [data] Shuffling data
[2023-07-14 15:20:02] [data] Done reading 20,192 sentences
[2023-07-14 15:20:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:20:11] Ep. 152 : Up. 25000 : Sen. 1,818 : Cost 0.57697093 * 3,749,377 @ 5,375 after 93,607,044 : Time 93.35s : 40163.52 words/s : gNorm 1.0936
[2023-07-14 15:21:27] Seen 20,188 samples
[2023-07-14 15:21:27] Starting data epoch 153 in logical epoch 153
[2023-07-14 15:21:27] [data] Shuffling data
[2023-07-14 15:21:27] [data] Done reading 20,192 sentences
[2023-07-14 15:21:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:22:52] Seen 20,188 samples
[2023-07-14 15:22:52] Starting data epoch 154 in logical epoch 154
[2023-07-14 15:22:52] [data] Shuffling data
[2023-07-14 15:22:52] [data] Done reading 20,192 sentences
[2023-07-14 15:22:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:24:18] Seen 20,188 samples
[2023-07-14 15:24:18] Starting data epoch 155 in logical epoch 155
[2023-07-14 15:24:18] [data] Shuffling data
[2023-07-14 15:24:18] [data] Done reading 20,192 sentences
[2023-07-14 15:24:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:25:43] Seen 20,188 samples
[2023-07-14 15:25:43] Starting data epoch 156 in logical epoch 156
[2023-07-14 15:25:43] [data] Shuffling data
[2023-07-14 15:25:43] [data] Done reading 20,192 sentences
[2023-07-14 15:25:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:27:08] Seen 20,188 samples
[2023-07-14 15:27:08] Starting data epoch 157 in logical epoch 157
[2023-07-14 15:27:08] [data] Shuffling data
[2023-07-14 15:27:08] [data] Done reading 20,192 sentences
[2023-07-14 15:27:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:28:32] Seen 20,188 samples
[2023-07-14 15:28:32] Starting data epoch 158 in logical epoch 158
[2023-07-14 15:28:32] [data] Shuffling data
[2023-07-14 15:28:32] [data] Done reading 20,192 sentences
[2023-07-14 15:28:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:28:43] Ep. 158 : Up. 26000 : Sen. 2,943 : Cost 0.54735732 * 3,744,391 @ 3,272 after 97,351,435 : Time 512.20s : 7310.37 words/s : gNorm 0.9804
[2023-07-14 15:29:56] Seen 20,188 samples
[2023-07-14 15:29:56] Starting data epoch 159 in logical epoch 159
[2023-07-14 15:29:56] [data] Shuffling data
[2023-07-14 15:29:56] [data] Done reading 20,192 sentences
[2023-07-14 15:29:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:31:21] Seen 20,188 samples
[2023-07-14 15:31:21] Starting data epoch 160 in logical epoch 160
[2023-07-14 15:31:21] [data] Shuffling data
[2023-07-14 15:31:21] [data] Done reading 20,192 sentences
[2023-07-14 15:31:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:32:47] Seen 20,188 samples
[2023-07-14 15:32:47] Starting data epoch 161 in logical epoch 161
[2023-07-14 15:32:47] Training finished
[2023-07-14 15:32:56] [valid] Ep. 161 : Up. 26476 : cross-entropy : 110.585 : stalled 10 times (last best: 100.389)
[2023-07-14 15:33:35] [valid] Ep. 161 : Up. 26476 : translation : 0 : new best
[2023-07-14 15:33:35] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:33:37] Saving Adam parameters
[2023-07-14 15:33:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:33:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:33:46] [marian] Running on node21.datos.cluster.uy as process 35168 with command line:
[2023-07-14 15:33:46] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 170 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 15:33:46] [config] after: 0e
[2023-07-14 15:33:46] [config] after-batches: 0
[2023-07-14 15:33:46] [config] after-epochs: 170
[2023-07-14 15:33:46] [config] all-caps-every: 0
[2023-07-14 15:33:46] [config] allow-unk: false
[2023-07-14 15:33:46] [config] authors: false
[2023-07-14 15:33:46] [config] beam-size: 6
[2023-07-14 15:33:46] [config] bert-class-symbol: "[CLS]"
[2023-07-14 15:33:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 15:33:46] [config] bert-masking-fraction: 0.15
[2023-07-14 15:33:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 15:33:46] [config] bert-train-type-embeddings: true
[2023-07-14 15:33:46] [config] bert-type-vocab-size: 2
[2023-07-14 15:33:46] [config] build-info: ""
[2023-07-14 15:33:46] [config] check-gradient-nan: false
[2023-07-14 15:33:46] [config] check-nan: false
[2023-07-14 15:33:46] [config] cite: false
[2023-07-14 15:33:46] [config] clip-norm: 1
[2023-07-14 15:33:46] [config] cost-scaling:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] cost-type: ce-sum
[2023-07-14 15:33:46] [config] cpu-threads: 0
[2023-07-14 15:33:46] [config] data-threads: 8
[2023-07-14 15:33:46] [config] data-weighting: ""
[2023-07-14 15:33:46] [config] data-weighting-type: sentence
[2023-07-14 15:33:46] [config] dec-cell: gru
[2023-07-14 15:33:46] [config] dec-cell-base-depth: 2
[2023-07-14 15:33:46] [config] dec-cell-high-depth: 1
[2023-07-14 15:33:46] [config] dec-depth: 1
[2023-07-14 15:33:46] [config] devices:
[2023-07-14 15:33:46] [config]   - 0
[2023-07-14 15:33:46] [config] dim-emb: 512
[2023-07-14 15:33:46] [config] dim-rnn: 1024
[2023-07-14 15:33:46] [config] dim-vocabs:
[2023-07-14 15:33:46] [config]   - 16384
[2023-07-14 15:33:46] [config]   - 16384
[2023-07-14 15:33:46] [config] disp-first: 0
[2023-07-14 15:33:46] [config] disp-freq: 1000u
[2023-07-14 15:33:46] [config] disp-label-counts: true
[2023-07-14 15:33:46] [config] dropout-rnn: 0.2
[2023-07-14 15:33:46] [config] dropout-src: 0.1
[2023-07-14 15:33:46] [config] dropout-trg: 0.1
[2023-07-14 15:33:46] [config] dump-config: ""
[2023-07-14 15:33:46] [config] dynamic-gradient-scaling:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] early-stopping: 10
[2023-07-14 15:33:46] [config] early-stopping-on: first
[2023-07-14 15:33:46] [config] embedding-fix-src: false
[2023-07-14 15:33:46] [config] embedding-fix-trg: false
[2023-07-14 15:33:46] [config] embedding-normalization: false
[2023-07-14 15:33:46] [config] embedding-vectors:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] enc-cell: gru
[2023-07-14 15:33:46] [config] enc-cell-depth: 1
[2023-07-14 15:33:46] [config] enc-depth: 1
[2023-07-14 15:33:46] [config] enc-type: bidirectional
[2023-07-14 15:33:46] [config] english-title-case-every: 0
[2023-07-14 15:33:46] [config] exponential-smoothing: 0
[2023-07-14 15:33:46] [config] factor-weight: 1
[2023-07-14 15:33:46] [config] factors-combine: sum
[2023-07-14 15:33:46] [config] factors-dim-emb: 0
[2023-07-14 15:33:46] [config] gradient-checkpointing: false
[2023-07-14 15:33:46] [config] gradient-norm-average-window: 100
[2023-07-14 15:33:46] [config] guided-alignment: none
[2023-07-14 15:33:46] [config] guided-alignment-cost: mse
[2023-07-14 15:33:46] [config] guided-alignment-weight: 0.1
[2023-07-14 15:33:46] [config] ignore-model-config: false
[2023-07-14 15:33:46] [config] input-types:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] interpolate-env-vars: false
[2023-07-14 15:33:46] [config] keep-best: false
[2023-07-14 15:33:46] [config] label-smoothing: 0
[2023-07-14 15:33:46] [config] layer-normalization: true
[2023-07-14 15:33:46] [config] learn-rate: 0.0001
[2023-07-14 15:33:46] [config] lemma-dependency: ""
[2023-07-14 15:33:46] [config] lemma-dim-emb: 0
[2023-07-14 15:33:46] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:33:46] [config] log-level: info
[2023-07-14 15:33:46] [config] log-time-zone: ""
[2023-07-14 15:33:46] [config] logical-epoch:
[2023-07-14 15:33:46] [config]   - 1e
[2023-07-14 15:33:46] [config]   - 0
[2023-07-14 15:33:46] [config] lr-decay: 0
[2023-07-14 15:33:46] [config] lr-decay-freq: 50000
[2023-07-14 15:33:46] [config] lr-decay-inv-sqrt:
[2023-07-14 15:33:46] [config]   - 0
[2023-07-14 15:33:46] [config] lr-decay-repeat-warmup: false
[2023-07-14 15:33:46] [config] lr-decay-reset-optimizer: false
[2023-07-14 15:33:46] [config] lr-decay-start:
[2023-07-14 15:33:46] [config]   - 10
[2023-07-14 15:33:46] [config]   - 1
[2023-07-14 15:33:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 15:33:46] [config] lr-report: false
[2023-07-14 15:33:46] [config] lr-warmup: 0
[2023-07-14 15:33:46] [config] lr-warmup-at-reload: false
[2023-07-14 15:33:46] [config] lr-warmup-cycle: false
[2023-07-14 15:33:46] [config] lr-warmup-start-rate: 0
[2023-07-14 15:33:46] [config] max-length: 200
[2023-07-14 15:33:46] [config] max-length-crop: false
[2023-07-14 15:33:46] [config] max-length-factor: 3
[2023-07-14 15:33:46] [config] maxi-batch: 100
[2023-07-14 15:33:46] [config] maxi-batch-sort: trg
[2023-07-14 15:33:46] [config] mini-batch: 64
[2023-07-14 15:33:46] [config] mini-batch-fit: true
[2023-07-14 15:33:46] [config] mini-batch-fit-step: 10
[2023-07-14 15:33:46] [config] mini-batch-round-up: true
[2023-07-14 15:33:46] [config] mini-batch-track-lr: false
[2023-07-14 15:33:46] [config] mini-batch-warmup: 0
[2023-07-14 15:33:46] [config] mini-batch-words: 0
[2023-07-14 15:33:46] [config] mini-batch-words-ref: 0
[2023-07-14 15:33:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:33:46] [config] multi-loss-type: sum
[2023-07-14 15:33:46] [config] n-best: false
[2023-07-14 15:33:46] [config] no-nccl: false
[2023-07-14 15:33:46] [config] no-reload: false
[2023-07-14 15:33:46] [config] no-restore-corpus: false
[2023-07-14 15:33:46] [config] normalize: 0.6
[2023-07-14 15:33:46] [config] normalize-gradient: false
[2023-07-14 15:33:46] [config] num-devices: 0
[2023-07-14 15:33:46] [config] optimizer: adam
[2023-07-14 15:33:46] [config] optimizer-delay: 1
[2023-07-14 15:33:46] [config] optimizer-params:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] output-omit-bias: false
[2023-07-14 15:33:46] [config] overwrite: false
[2023-07-14 15:33:46] [config] precision:
[2023-07-14 15:33:46] [config]   - float32
[2023-07-14 15:33:46] [config]   - float32
[2023-07-14 15:33:46] [config] pretrained-model: ""
[2023-07-14 15:33:46] [config] quantize-biases: false
[2023-07-14 15:33:46] [config] quantize-bits: 0
[2023-07-14 15:33:46] [config] quantize-log-based: false
[2023-07-14 15:33:46] [config] quantize-optimization-steps: 0
[2023-07-14 15:33:46] [config] quiet: false
[2023-07-14 15:33:46] [config] quiet-translation: true
[2023-07-14 15:33:46] [config] relative-paths: false
[2023-07-14 15:33:46] [config] right-left: false
[2023-07-14 15:33:46] [config] save-freq: 10000u
[2023-07-14 15:33:46] [config] seed: 1234
[2023-07-14 15:33:46] [config] sentencepiece-alphas:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] sentencepiece-max-lines: 2000000
[2023-07-14 15:33:46] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 15:33:46] [config] sharding: global
[2023-07-14 15:33:46] [config] shuffle: data
[2023-07-14 15:33:46] [config] shuffle-in-ram: false
[2023-07-14 15:33:46] [config] sigterm: save-and-exit
[2023-07-14 15:33:46] [config] skip: false
[2023-07-14 15:33:46] [config] sqlite: ""
[2023-07-14 15:33:46] [config] sqlite-drop: false
[2023-07-14 15:33:46] [config] sync-freq: 200u
[2023-07-14 15:33:46] [config] sync-sgd: false
[2023-07-14 15:33:46] [config] tempdir: /tmp
[2023-07-14 15:33:46] [config] tied-embeddings: false
[2023-07-14 15:33:46] [config] tied-embeddings-all: true
[2023-07-14 15:33:46] [config] tied-embeddings-src: false
[2023-07-14 15:33:46] [config] train-embedder-rank:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] train-sets:
[2023-07-14 15:33:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 15:33:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 15:33:46] [config] transformer-aan-activation: swish
[2023-07-14 15:33:46] [config] transformer-aan-depth: 2
[2023-07-14 15:33:46] [config] transformer-aan-nogate: false
[2023-07-14 15:33:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 15:33:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 15:33:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 15:33:46] [config] transformer-depth-scaling: false
[2023-07-14 15:33:46] [config] transformer-dim-aan: 2048
[2023-07-14 15:33:46] [config] transformer-dim-ffn: 2048
[2023-07-14 15:33:46] [config] transformer-dropout: 0
[2023-07-14 15:33:46] [config] transformer-dropout-attention: 0
[2023-07-14 15:33:46] [config] transformer-dropout-ffn: 0
[2023-07-14 15:33:46] [config] transformer-ffn-activation: swish
[2023-07-14 15:33:46] [config] transformer-ffn-depth: 2
[2023-07-14 15:33:46] [config] transformer-guided-alignment-layer: last
[2023-07-14 15:33:46] [config] transformer-heads: 8
[2023-07-14 15:33:46] [config] transformer-no-projection: false
[2023-07-14 15:33:46] [config] transformer-pool: false
[2023-07-14 15:33:46] [config] transformer-postprocess: dan
[2023-07-14 15:33:46] [config] transformer-postprocess-emb: d
[2023-07-14 15:33:46] [config] transformer-postprocess-top: ""
[2023-07-14 15:33:46] [config] transformer-preprocess: ""
[2023-07-14 15:33:46] [config] transformer-tied-layers:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] transformer-train-position-embeddings: false
[2023-07-14 15:33:46] [config] tsv: false
[2023-07-14 15:33:46] [config] tsv-fields: 0
[2023-07-14 15:33:46] [config] type: amun
[2023-07-14 15:33:46] [config] ulr: false
[2023-07-14 15:33:46] [config] ulr-dim-emb: 0
[2023-07-14 15:33:46] [config] ulr-dropout: 0
[2023-07-14 15:33:46] [config] ulr-keys-vectors: ""
[2023-07-14 15:33:46] [config] ulr-query-vectors: ""
[2023-07-14 15:33:46] [config] ulr-softmax-temperature: 1
[2023-07-14 15:33:46] [config] ulr-trainable-transformation: false
[2023-07-14 15:33:46] [config] unlikelihood-loss: false
[2023-07-14 15:33:46] [config] valid-freq: 5000000
[2023-07-14 15:33:46] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:33:46] [config] valid-max-length: 1000
[2023-07-14 15:33:46] [config] valid-metrics:
[2023-07-14 15:33:46] [config]   - cross-entropy
[2023-07-14 15:33:46] [config]   - translation
[2023-07-14 15:33:46] [config] valid-mini-batch: 32
[2023-07-14 15:33:46] [config] valid-reset-stalled: false
[2023-07-14 15:33:46] [config] valid-script-args:
[2023-07-14 15:33:46] [config]   []
[2023-07-14 15:33:46] [config] valid-script-path: ""
[2023-07-14 15:33:46] [config] valid-sets:
[2023-07-14 15:33:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 15:33:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 15:33:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 15:33:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:33:46] [config] vocabs:
[2023-07-14 15:33:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:33:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:33:46] [config] word-penalty: 0
[2023-07-14 15:33:46] [config] word-scores: false
[2023-07-14 15:33:46] [config] workspace: 3000
[2023-07-14 15:33:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:33:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:33:46] [training] Using single-device training
[2023-07-14 15:33:46] Synced seed 1234
[2023-07-14 15:33:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:33:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 15:33:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:33:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 15:33:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 15:33:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:33:47] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:33:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:33:47] [comm] Using global sharding
[2023-07-14 15:33:47] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:33:47] [training] Using 1 GPUs
[2023-07-14 15:33:47] [logits] Applying loss function for 1 factor(s)
[2023-07-14 15:33:47] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:33:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 15:33:48] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:35:11] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 15:35:11] [valid] No post-processing script given for validating translator
[2023-07-14 15:35:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:35:11] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:35:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:35:11] [comm] Using global sharding
[2023-07-14 15:35:11] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:35:11] [training] Using 1 GPUs
[2023-07-14 15:35:11] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:35:13] Loading Adam parameters
[2023-07-14 15:35:13] [memory] Reserving 322 MB, device gpu0
[2023-07-14 15:35:13] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:35:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:35:13] [data] Restoring the corpus state to epoch 161, batch 26476
[2023-07-14 15:35:13] [data] Shuffling data
[2023-07-14 15:35:13] [data] Done reading 20,192 sentences
[2023-07-14 15:35:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:35:13] Training started
[2023-07-14 15:35:13] Training finished
[2023-07-14 15:35:17] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:35:17] [marian] Running on node21.datos.cluster.uy as process 35301 with command line:
[2023-07-14 15:35:17] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 180 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 15:35:17] [config] after: 0e
[2023-07-14 15:35:17] [config] after-batches: 0
[2023-07-14 15:35:17] [config] after-epochs: 180
[2023-07-14 15:35:17] [config] all-caps-every: 0
[2023-07-14 15:35:17] [config] allow-unk: false
[2023-07-14 15:35:17] [config] authors: false
[2023-07-14 15:35:17] [config] beam-size: 6
[2023-07-14 15:35:17] [config] bert-class-symbol: "[CLS]"
[2023-07-14 15:35:17] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 15:35:17] [config] bert-masking-fraction: 0.15
[2023-07-14 15:35:17] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 15:35:17] [config] bert-train-type-embeddings: true
[2023-07-14 15:35:17] [config] bert-type-vocab-size: 2
[2023-07-14 15:35:17] [config] build-info: ""
[2023-07-14 15:35:17] [config] check-gradient-nan: false
[2023-07-14 15:35:17] [config] check-nan: false
[2023-07-14 15:35:17] [config] cite: false
[2023-07-14 15:35:17] [config] clip-norm: 1
[2023-07-14 15:35:17] [config] cost-scaling:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] cost-type: ce-sum
[2023-07-14 15:35:17] [config] cpu-threads: 0
[2023-07-14 15:35:17] [config] data-threads: 8
[2023-07-14 15:35:17] [config] data-weighting: ""
[2023-07-14 15:35:17] [config] data-weighting-type: sentence
[2023-07-14 15:35:17] [config] dec-cell: gru
[2023-07-14 15:35:17] [config] dec-cell-base-depth: 2
[2023-07-14 15:35:17] [config] dec-cell-high-depth: 1
[2023-07-14 15:35:17] [config] dec-depth: 1
[2023-07-14 15:35:17] [config] devices:
[2023-07-14 15:35:17] [config]   - 0
[2023-07-14 15:35:17] [config] dim-emb: 512
[2023-07-14 15:35:17] [config] dim-rnn: 1024
[2023-07-14 15:35:17] [config] dim-vocabs:
[2023-07-14 15:35:17] [config]   - 16384
[2023-07-14 15:35:17] [config]   - 16384
[2023-07-14 15:35:17] [config] disp-first: 0
[2023-07-14 15:35:17] [config] disp-freq: 1000u
[2023-07-14 15:35:17] [config] disp-label-counts: true
[2023-07-14 15:35:17] [config] dropout-rnn: 0.2
[2023-07-14 15:35:17] [config] dropout-src: 0.1
[2023-07-14 15:35:17] [config] dropout-trg: 0.1
[2023-07-14 15:35:17] [config] dump-config: ""
[2023-07-14 15:35:17] [config] dynamic-gradient-scaling:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] early-stopping: 10
[2023-07-14 15:35:17] [config] early-stopping-on: first
[2023-07-14 15:35:17] [config] embedding-fix-src: false
[2023-07-14 15:35:17] [config] embedding-fix-trg: false
[2023-07-14 15:35:17] [config] embedding-normalization: false
[2023-07-14 15:35:17] [config] embedding-vectors:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] enc-cell: gru
[2023-07-14 15:35:17] [config] enc-cell-depth: 1
[2023-07-14 15:35:17] [config] enc-depth: 1
[2023-07-14 15:35:17] [config] enc-type: bidirectional
[2023-07-14 15:35:17] [config] english-title-case-every: 0
[2023-07-14 15:35:17] [config] exponential-smoothing: 0
[2023-07-14 15:35:17] [config] factor-weight: 1
[2023-07-14 15:35:17] [config] factors-combine: sum
[2023-07-14 15:35:17] [config] factors-dim-emb: 0
[2023-07-14 15:35:17] [config] gradient-checkpointing: false
[2023-07-14 15:35:17] [config] gradient-norm-average-window: 100
[2023-07-14 15:35:17] [config] guided-alignment: none
[2023-07-14 15:35:17] [config] guided-alignment-cost: mse
[2023-07-14 15:35:17] [config] guided-alignment-weight: 0.1
[2023-07-14 15:35:17] [config] ignore-model-config: false
[2023-07-14 15:35:17] [config] input-types:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] interpolate-env-vars: false
[2023-07-14 15:35:17] [config] keep-best: false
[2023-07-14 15:35:17] [config] label-smoothing: 0
[2023-07-14 15:35:17] [config] layer-normalization: true
[2023-07-14 15:35:17] [config] learn-rate: 0.0001
[2023-07-14 15:35:17] [config] lemma-dependency: ""
[2023-07-14 15:35:17] [config] lemma-dim-emb: 0
[2023-07-14 15:35:17] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:35:17] [config] log-level: info
[2023-07-14 15:35:17] [config] log-time-zone: ""
[2023-07-14 15:35:17] [config] logical-epoch:
[2023-07-14 15:35:17] [config]   - 1e
[2023-07-14 15:35:17] [config]   - 0
[2023-07-14 15:35:17] [config] lr-decay: 0
[2023-07-14 15:35:17] [config] lr-decay-freq: 50000
[2023-07-14 15:35:17] [config] lr-decay-inv-sqrt:
[2023-07-14 15:35:17] [config]   - 0
[2023-07-14 15:35:17] [config] lr-decay-repeat-warmup: false
[2023-07-14 15:35:17] [config] lr-decay-reset-optimizer: false
[2023-07-14 15:35:17] [config] lr-decay-start:
[2023-07-14 15:35:17] [config]   - 10
[2023-07-14 15:35:17] [config]   - 1
[2023-07-14 15:35:17] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 15:35:17] [config] lr-report: false
[2023-07-14 15:35:17] [config] lr-warmup: 0
[2023-07-14 15:35:17] [config] lr-warmup-at-reload: false
[2023-07-14 15:35:17] [config] lr-warmup-cycle: false
[2023-07-14 15:35:17] [config] lr-warmup-start-rate: 0
[2023-07-14 15:35:17] [config] max-length: 200
[2023-07-14 15:35:17] [config] max-length-crop: false
[2023-07-14 15:35:17] [config] max-length-factor: 3
[2023-07-14 15:35:17] [config] maxi-batch: 100
[2023-07-14 15:35:17] [config] maxi-batch-sort: trg
[2023-07-14 15:35:17] [config] mini-batch: 64
[2023-07-14 15:35:17] [config] mini-batch-fit: true
[2023-07-14 15:35:17] [config] mini-batch-fit-step: 10
[2023-07-14 15:35:17] [config] mini-batch-round-up: true
[2023-07-14 15:35:17] [config] mini-batch-track-lr: false
[2023-07-14 15:35:17] [config] mini-batch-warmup: 0
[2023-07-14 15:35:17] [config] mini-batch-words: 0
[2023-07-14 15:35:17] [config] mini-batch-words-ref: 0
[2023-07-14 15:35:17] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:35:17] [config] multi-loss-type: sum
[2023-07-14 15:35:17] [config] n-best: false
[2023-07-14 15:35:17] [config] no-nccl: false
[2023-07-14 15:35:17] [config] no-reload: false
[2023-07-14 15:35:17] [config] no-restore-corpus: false
[2023-07-14 15:35:17] [config] normalize: 0.6
[2023-07-14 15:35:17] [config] normalize-gradient: false
[2023-07-14 15:35:17] [config] num-devices: 0
[2023-07-14 15:35:17] [config] optimizer: adam
[2023-07-14 15:35:17] [config] optimizer-delay: 1
[2023-07-14 15:35:17] [config] optimizer-params:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] output-omit-bias: false
[2023-07-14 15:35:17] [config] overwrite: false
[2023-07-14 15:35:17] [config] precision:
[2023-07-14 15:35:17] [config]   - float32
[2023-07-14 15:35:17] [config]   - float32
[2023-07-14 15:35:17] [config] pretrained-model: ""
[2023-07-14 15:35:17] [config] quantize-biases: false
[2023-07-14 15:35:17] [config] quantize-bits: 0
[2023-07-14 15:35:17] [config] quantize-log-based: false
[2023-07-14 15:35:17] [config] quantize-optimization-steps: 0
[2023-07-14 15:35:17] [config] quiet: false
[2023-07-14 15:35:17] [config] quiet-translation: true
[2023-07-14 15:35:17] [config] relative-paths: false
[2023-07-14 15:35:17] [config] right-left: false
[2023-07-14 15:35:17] [config] save-freq: 10000u
[2023-07-14 15:35:17] [config] seed: 1234
[2023-07-14 15:35:17] [config] sentencepiece-alphas:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] sentencepiece-max-lines: 2000000
[2023-07-14 15:35:17] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 15:35:17] [config] sharding: global
[2023-07-14 15:35:17] [config] shuffle: data
[2023-07-14 15:35:17] [config] shuffle-in-ram: false
[2023-07-14 15:35:17] [config] sigterm: save-and-exit
[2023-07-14 15:35:17] [config] skip: false
[2023-07-14 15:35:17] [config] sqlite: ""
[2023-07-14 15:35:17] [config] sqlite-drop: false
[2023-07-14 15:35:17] [config] sync-freq: 200u
[2023-07-14 15:35:17] [config] sync-sgd: false
[2023-07-14 15:35:17] [config] tempdir: /tmp
[2023-07-14 15:35:17] [config] tied-embeddings: false
[2023-07-14 15:35:17] [config] tied-embeddings-all: true
[2023-07-14 15:35:17] [config] tied-embeddings-src: false
[2023-07-14 15:35:17] [config] train-embedder-rank:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] train-sets:
[2023-07-14 15:35:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 15:35:17] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 15:35:17] [config] transformer-aan-activation: swish
[2023-07-14 15:35:17] [config] transformer-aan-depth: 2
[2023-07-14 15:35:17] [config] transformer-aan-nogate: false
[2023-07-14 15:35:17] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 15:35:17] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 15:35:17] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 15:35:17] [config] transformer-depth-scaling: false
[2023-07-14 15:35:17] [config] transformer-dim-aan: 2048
[2023-07-14 15:35:17] [config] transformer-dim-ffn: 2048
[2023-07-14 15:35:17] [config] transformer-dropout: 0
[2023-07-14 15:35:17] [config] transformer-dropout-attention: 0
[2023-07-14 15:35:17] [config] transformer-dropout-ffn: 0
[2023-07-14 15:35:17] [config] transformer-ffn-activation: swish
[2023-07-14 15:35:17] [config] transformer-ffn-depth: 2
[2023-07-14 15:35:17] [config] transformer-guided-alignment-layer: last
[2023-07-14 15:35:17] [config] transformer-heads: 8
[2023-07-14 15:35:17] [config] transformer-no-projection: false
[2023-07-14 15:35:17] [config] transformer-pool: false
[2023-07-14 15:35:17] [config] transformer-postprocess: dan
[2023-07-14 15:35:17] [config] transformer-postprocess-emb: d
[2023-07-14 15:35:17] [config] transformer-postprocess-top: ""
[2023-07-14 15:35:17] [config] transformer-preprocess: ""
[2023-07-14 15:35:17] [config] transformer-tied-layers:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] transformer-train-position-embeddings: false
[2023-07-14 15:35:17] [config] tsv: false
[2023-07-14 15:35:17] [config] tsv-fields: 0
[2023-07-14 15:35:17] [config] type: amun
[2023-07-14 15:35:17] [config] ulr: false
[2023-07-14 15:35:17] [config] ulr-dim-emb: 0
[2023-07-14 15:35:17] [config] ulr-dropout: 0
[2023-07-14 15:35:17] [config] ulr-keys-vectors: ""
[2023-07-14 15:35:17] [config] ulr-query-vectors: ""
[2023-07-14 15:35:17] [config] ulr-softmax-temperature: 1
[2023-07-14 15:35:17] [config] ulr-trainable-transformation: false
[2023-07-14 15:35:17] [config] unlikelihood-loss: false
[2023-07-14 15:35:17] [config] valid-freq: 5000000
[2023-07-14 15:35:17] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:35:17] [config] valid-max-length: 1000
[2023-07-14 15:35:17] [config] valid-metrics:
[2023-07-14 15:35:17] [config]   - cross-entropy
[2023-07-14 15:35:17] [config]   - translation
[2023-07-14 15:35:17] [config] valid-mini-batch: 32
[2023-07-14 15:35:17] [config] valid-reset-stalled: false
[2023-07-14 15:35:17] [config] valid-script-args:
[2023-07-14 15:35:17] [config]   []
[2023-07-14 15:35:17] [config] valid-script-path: ""
[2023-07-14 15:35:17] [config] valid-sets:
[2023-07-14 15:35:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 15:35:17] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 15:35:17] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 15:35:17] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:35:17] [config] vocabs:
[2023-07-14 15:35:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:35:17] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:35:17] [config] word-penalty: 0
[2023-07-14 15:35:17] [config] word-scores: false
[2023-07-14 15:35:17] [config] workspace: 3000
[2023-07-14 15:35:17] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:35:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:35:17] [training] Using single-device training
[2023-07-14 15:35:18] Synced seed 1234
[2023-07-14 15:35:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:35:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 15:35:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:35:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 15:35:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 15:35:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:35:19] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:35:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:35:19] [comm] Using global sharding
[2023-07-14 15:35:19] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:35:19] [training] Using 1 GPUs
[2023-07-14 15:35:19] [logits] Applying loss function for 1 factor(s)
[2023-07-14 15:35:19] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:35:19] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 15:35:19] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:36:43] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 15:36:44] [valid] No post-processing script given for validating translator
[2023-07-14 15:36:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:36:44] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:36:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:36:44] [comm] Using global sharding
[2023-07-14 15:36:44] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:36:44] [training] Using 1 GPUs
[2023-07-14 15:36:44] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:36:45] Loading Adam parameters
[2023-07-14 15:36:45] [memory] Reserving 322 MB, device gpu0
[2023-07-14 15:36:45] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:36:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:36:45] [data] Restoring the corpus state to epoch 161, batch 26476
[2023-07-14 15:36:45] [data] Shuffling data
[2023-07-14 15:36:45] [data] Done reading 20,192 sentences
[2023-07-14 15:36:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:36:45] Training started
[2023-07-14 15:36:45] Training finished
[2023-07-14 15:36:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:36:49] [marian] Running on node21.datos.cluster.uy as process 35435 with command line:
[2023-07-14 15:36:49] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 190 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 15:36:49] [config] after: 0e
[2023-07-14 15:36:49] [config] after-batches: 0
[2023-07-14 15:36:49] [config] after-epochs: 190
[2023-07-14 15:36:49] [config] all-caps-every: 0
[2023-07-14 15:36:49] [config] allow-unk: false
[2023-07-14 15:36:49] [config] authors: false
[2023-07-14 15:36:49] [config] beam-size: 6
[2023-07-14 15:36:49] [config] bert-class-symbol: "[CLS]"
[2023-07-14 15:36:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 15:36:49] [config] bert-masking-fraction: 0.15
[2023-07-14 15:36:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 15:36:49] [config] bert-train-type-embeddings: true
[2023-07-14 15:36:49] [config] bert-type-vocab-size: 2
[2023-07-14 15:36:49] [config] build-info: ""
[2023-07-14 15:36:49] [config] check-gradient-nan: false
[2023-07-14 15:36:49] [config] check-nan: false
[2023-07-14 15:36:49] [config] cite: false
[2023-07-14 15:36:49] [config] clip-norm: 1
[2023-07-14 15:36:49] [config] cost-scaling:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] cost-type: ce-sum
[2023-07-14 15:36:49] [config] cpu-threads: 0
[2023-07-14 15:36:49] [config] data-threads: 8
[2023-07-14 15:36:49] [config] data-weighting: ""
[2023-07-14 15:36:49] [config] data-weighting-type: sentence
[2023-07-14 15:36:49] [config] dec-cell: gru
[2023-07-14 15:36:49] [config] dec-cell-base-depth: 2
[2023-07-14 15:36:49] [config] dec-cell-high-depth: 1
[2023-07-14 15:36:49] [config] dec-depth: 1
[2023-07-14 15:36:49] [config] devices:
[2023-07-14 15:36:49] [config]   - 0
[2023-07-14 15:36:49] [config] dim-emb: 512
[2023-07-14 15:36:49] [config] dim-rnn: 1024
[2023-07-14 15:36:49] [config] dim-vocabs:
[2023-07-14 15:36:49] [config]   - 16384
[2023-07-14 15:36:49] [config]   - 16384
[2023-07-14 15:36:49] [config] disp-first: 0
[2023-07-14 15:36:49] [config] disp-freq: 1000u
[2023-07-14 15:36:49] [config] disp-label-counts: true
[2023-07-14 15:36:49] [config] dropout-rnn: 0.2
[2023-07-14 15:36:49] [config] dropout-src: 0.1
[2023-07-14 15:36:49] [config] dropout-trg: 0.1
[2023-07-14 15:36:49] [config] dump-config: ""
[2023-07-14 15:36:49] [config] dynamic-gradient-scaling:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] early-stopping: 10
[2023-07-14 15:36:49] [config] early-stopping-on: first
[2023-07-14 15:36:49] [config] embedding-fix-src: false
[2023-07-14 15:36:49] [config] embedding-fix-trg: false
[2023-07-14 15:36:49] [config] embedding-normalization: false
[2023-07-14 15:36:49] [config] embedding-vectors:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] enc-cell: gru
[2023-07-14 15:36:49] [config] enc-cell-depth: 1
[2023-07-14 15:36:49] [config] enc-depth: 1
[2023-07-14 15:36:49] [config] enc-type: bidirectional
[2023-07-14 15:36:49] [config] english-title-case-every: 0
[2023-07-14 15:36:49] [config] exponential-smoothing: 0
[2023-07-14 15:36:49] [config] factor-weight: 1
[2023-07-14 15:36:49] [config] factors-combine: sum
[2023-07-14 15:36:49] [config] factors-dim-emb: 0
[2023-07-14 15:36:49] [config] gradient-checkpointing: false
[2023-07-14 15:36:49] [config] gradient-norm-average-window: 100
[2023-07-14 15:36:49] [config] guided-alignment: none
[2023-07-14 15:36:49] [config] guided-alignment-cost: mse
[2023-07-14 15:36:49] [config] guided-alignment-weight: 0.1
[2023-07-14 15:36:49] [config] ignore-model-config: false
[2023-07-14 15:36:49] [config] input-types:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] interpolate-env-vars: false
[2023-07-14 15:36:49] [config] keep-best: false
[2023-07-14 15:36:49] [config] label-smoothing: 0
[2023-07-14 15:36:49] [config] layer-normalization: true
[2023-07-14 15:36:49] [config] learn-rate: 0.0001
[2023-07-14 15:36:49] [config] lemma-dependency: ""
[2023-07-14 15:36:49] [config] lemma-dim-emb: 0
[2023-07-14 15:36:49] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:36:49] [config] log-level: info
[2023-07-14 15:36:49] [config] log-time-zone: ""
[2023-07-14 15:36:49] [config] logical-epoch:
[2023-07-14 15:36:49] [config]   - 1e
[2023-07-14 15:36:49] [config]   - 0
[2023-07-14 15:36:49] [config] lr-decay: 0
[2023-07-14 15:36:49] [config] lr-decay-freq: 50000
[2023-07-14 15:36:49] [config] lr-decay-inv-sqrt:
[2023-07-14 15:36:49] [config]   - 0
[2023-07-14 15:36:49] [config] lr-decay-repeat-warmup: false
[2023-07-14 15:36:49] [config] lr-decay-reset-optimizer: false
[2023-07-14 15:36:49] [config] lr-decay-start:
[2023-07-14 15:36:49] [config]   - 10
[2023-07-14 15:36:49] [config]   - 1
[2023-07-14 15:36:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 15:36:49] [config] lr-report: false
[2023-07-14 15:36:49] [config] lr-warmup: 0
[2023-07-14 15:36:49] [config] lr-warmup-at-reload: false
[2023-07-14 15:36:49] [config] lr-warmup-cycle: false
[2023-07-14 15:36:49] [config] lr-warmup-start-rate: 0
[2023-07-14 15:36:49] [config] max-length: 200
[2023-07-14 15:36:49] [config] max-length-crop: false
[2023-07-14 15:36:49] [config] max-length-factor: 3
[2023-07-14 15:36:49] [config] maxi-batch: 100
[2023-07-14 15:36:49] [config] maxi-batch-sort: trg
[2023-07-14 15:36:49] [config] mini-batch: 64
[2023-07-14 15:36:49] [config] mini-batch-fit: true
[2023-07-14 15:36:49] [config] mini-batch-fit-step: 10
[2023-07-14 15:36:49] [config] mini-batch-round-up: true
[2023-07-14 15:36:49] [config] mini-batch-track-lr: false
[2023-07-14 15:36:49] [config] mini-batch-warmup: 0
[2023-07-14 15:36:49] [config] mini-batch-words: 0
[2023-07-14 15:36:49] [config] mini-batch-words-ref: 0
[2023-07-14 15:36:49] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:36:49] [config] multi-loss-type: sum
[2023-07-14 15:36:49] [config] n-best: false
[2023-07-14 15:36:49] [config] no-nccl: false
[2023-07-14 15:36:49] [config] no-reload: false
[2023-07-14 15:36:49] [config] no-restore-corpus: false
[2023-07-14 15:36:49] [config] normalize: 0.6
[2023-07-14 15:36:49] [config] normalize-gradient: false
[2023-07-14 15:36:49] [config] num-devices: 0
[2023-07-14 15:36:49] [config] optimizer: adam
[2023-07-14 15:36:49] [config] optimizer-delay: 1
[2023-07-14 15:36:49] [config] optimizer-params:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] output-omit-bias: false
[2023-07-14 15:36:49] [config] overwrite: false
[2023-07-14 15:36:49] [config] precision:
[2023-07-14 15:36:49] [config]   - float32
[2023-07-14 15:36:49] [config]   - float32
[2023-07-14 15:36:49] [config] pretrained-model: ""
[2023-07-14 15:36:49] [config] quantize-biases: false
[2023-07-14 15:36:49] [config] quantize-bits: 0
[2023-07-14 15:36:49] [config] quantize-log-based: false
[2023-07-14 15:36:49] [config] quantize-optimization-steps: 0
[2023-07-14 15:36:49] [config] quiet: false
[2023-07-14 15:36:49] [config] quiet-translation: true
[2023-07-14 15:36:49] [config] relative-paths: false
[2023-07-14 15:36:49] [config] right-left: false
[2023-07-14 15:36:49] [config] save-freq: 10000u
[2023-07-14 15:36:49] [config] seed: 1234
[2023-07-14 15:36:49] [config] sentencepiece-alphas:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] sentencepiece-max-lines: 2000000
[2023-07-14 15:36:49] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 15:36:49] [config] sharding: global
[2023-07-14 15:36:49] [config] shuffle: data
[2023-07-14 15:36:49] [config] shuffle-in-ram: false
[2023-07-14 15:36:49] [config] sigterm: save-and-exit
[2023-07-14 15:36:49] [config] skip: false
[2023-07-14 15:36:49] [config] sqlite: ""
[2023-07-14 15:36:49] [config] sqlite-drop: false
[2023-07-14 15:36:49] [config] sync-freq: 200u
[2023-07-14 15:36:49] [config] sync-sgd: false
[2023-07-14 15:36:49] [config] tempdir: /tmp
[2023-07-14 15:36:49] [config] tied-embeddings: false
[2023-07-14 15:36:49] [config] tied-embeddings-all: true
[2023-07-14 15:36:49] [config] tied-embeddings-src: false
[2023-07-14 15:36:49] [config] train-embedder-rank:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] train-sets:
[2023-07-14 15:36:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 15:36:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 15:36:49] [config] transformer-aan-activation: swish
[2023-07-14 15:36:49] [config] transformer-aan-depth: 2
[2023-07-14 15:36:49] [config] transformer-aan-nogate: false
[2023-07-14 15:36:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 15:36:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 15:36:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 15:36:49] [config] transformer-depth-scaling: false
[2023-07-14 15:36:49] [config] transformer-dim-aan: 2048
[2023-07-14 15:36:49] [config] transformer-dim-ffn: 2048
[2023-07-14 15:36:49] [config] transformer-dropout: 0
[2023-07-14 15:36:49] [config] transformer-dropout-attention: 0
[2023-07-14 15:36:49] [config] transformer-dropout-ffn: 0
[2023-07-14 15:36:49] [config] transformer-ffn-activation: swish
[2023-07-14 15:36:49] [config] transformer-ffn-depth: 2
[2023-07-14 15:36:49] [config] transformer-guided-alignment-layer: last
[2023-07-14 15:36:49] [config] transformer-heads: 8
[2023-07-14 15:36:49] [config] transformer-no-projection: false
[2023-07-14 15:36:49] [config] transformer-pool: false
[2023-07-14 15:36:49] [config] transformer-postprocess: dan
[2023-07-14 15:36:49] [config] transformer-postprocess-emb: d
[2023-07-14 15:36:49] [config] transformer-postprocess-top: ""
[2023-07-14 15:36:49] [config] transformer-preprocess: ""
[2023-07-14 15:36:49] [config] transformer-tied-layers:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] transformer-train-position-embeddings: false
[2023-07-14 15:36:49] [config] tsv: false
[2023-07-14 15:36:49] [config] tsv-fields: 0
[2023-07-14 15:36:49] [config] type: amun
[2023-07-14 15:36:49] [config] ulr: false
[2023-07-14 15:36:49] [config] ulr-dim-emb: 0
[2023-07-14 15:36:49] [config] ulr-dropout: 0
[2023-07-14 15:36:49] [config] ulr-keys-vectors: ""
[2023-07-14 15:36:49] [config] ulr-query-vectors: ""
[2023-07-14 15:36:49] [config] ulr-softmax-temperature: 1
[2023-07-14 15:36:49] [config] ulr-trainable-transformation: false
[2023-07-14 15:36:49] [config] unlikelihood-loss: false
[2023-07-14 15:36:49] [config] valid-freq: 5000000
[2023-07-14 15:36:49] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:36:49] [config] valid-max-length: 1000
[2023-07-14 15:36:49] [config] valid-metrics:
[2023-07-14 15:36:49] [config]   - cross-entropy
[2023-07-14 15:36:49] [config]   - translation
[2023-07-14 15:36:49] [config] valid-mini-batch: 32
[2023-07-14 15:36:49] [config] valid-reset-stalled: false
[2023-07-14 15:36:49] [config] valid-script-args:
[2023-07-14 15:36:49] [config]   []
[2023-07-14 15:36:49] [config] valid-script-path: ""
[2023-07-14 15:36:49] [config] valid-sets:
[2023-07-14 15:36:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 15:36:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 15:36:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 15:36:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:36:49] [config] vocabs:
[2023-07-14 15:36:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:36:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:36:49] [config] word-penalty: 0
[2023-07-14 15:36:49] [config] word-scores: false
[2023-07-14 15:36:49] [config] workspace: 3000
[2023-07-14 15:36:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:36:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:36:49] [training] Using single-device training
[2023-07-14 15:36:49] Synced seed 1234
[2023-07-14 15:36:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:36:49] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 15:36:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:36:49] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 15:36:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 15:36:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:36:50] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:36:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:36:50] [comm] Using global sharding
[2023-07-14 15:36:50] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:36:50] [training] Using 1 GPUs
[2023-07-14 15:36:50] [logits] Applying loss function for 1 factor(s)
[2023-07-14 15:36:50] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:36:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 15:36:51] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:38:15] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 15:38:15] [valid] No post-processing script given for validating translator
[2023-07-14 15:38:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:38:15] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:38:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:38:15] [comm] Using global sharding
[2023-07-14 15:38:15] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:38:15] [training] Using 1 GPUs
[2023-07-14 15:38:15] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:38:16] Loading Adam parameters
[2023-07-14 15:38:16] [memory] Reserving 322 MB, device gpu0
[2023-07-14 15:38:16] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:38:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:38:16] [data] Restoring the corpus state to epoch 161, batch 26476
[2023-07-14 15:38:16] [data] Shuffling data
[2023-07-14 15:38:16] [data] Done reading 20,192 sentences
[2023-07-14 15:38:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:38:16] Training started
[2023-07-14 15:38:16] Training finished
[2023-07-14 15:38:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:38:21] [marian] Running on node21.datos.cluster.uy as process 35567 with command line:
[2023-07-14 15:38:21] [marian] /marian/build/marian --max-length 200 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz --after-epochs 200 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-07-14 15:38:21] [config] after: 0e
[2023-07-14 15:38:21] [config] after-batches: 0
[2023-07-14 15:38:21] [config] after-epochs: 200
[2023-07-14 15:38:21] [config] all-caps-every: 0
[2023-07-14 15:38:21] [config] allow-unk: false
[2023-07-14 15:38:21] [config] authors: false
[2023-07-14 15:38:21] [config] beam-size: 6
[2023-07-14 15:38:21] [config] bert-class-symbol: "[CLS]"
[2023-07-14 15:38:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-14 15:38:21] [config] bert-masking-fraction: 0.15
[2023-07-14 15:38:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-14 15:38:21] [config] bert-train-type-embeddings: true
[2023-07-14 15:38:21] [config] bert-type-vocab-size: 2
[2023-07-14 15:38:21] [config] build-info: ""
[2023-07-14 15:38:21] [config] check-gradient-nan: false
[2023-07-14 15:38:21] [config] check-nan: false
[2023-07-14 15:38:21] [config] cite: false
[2023-07-14 15:38:21] [config] clip-norm: 1
[2023-07-14 15:38:21] [config] cost-scaling:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] cost-type: ce-sum
[2023-07-14 15:38:21] [config] cpu-threads: 0
[2023-07-14 15:38:21] [config] data-threads: 8
[2023-07-14 15:38:21] [config] data-weighting: ""
[2023-07-14 15:38:21] [config] data-weighting-type: sentence
[2023-07-14 15:38:21] [config] dec-cell: gru
[2023-07-14 15:38:21] [config] dec-cell-base-depth: 2
[2023-07-14 15:38:21] [config] dec-cell-high-depth: 1
[2023-07-14 15:38:21] [config] dec-depth: 1
[2023-07-14 15:38:21] [config] devices:
[2023-07-14 15:38:21] [config]   - 0
[2023-07-14 15:38:21] [config] dim-emb: 512
[2023-07-14 15:38:21] [config] dim-rnn: 1024
[2023-07-14 15:38:21] [config] dim-vocabs:
[2023-07-14 15:38:21] [config]   - 16384
[2023-07-14 15:38:21] [config]   - 16384
[2023-07-14 15:38:21] [config] disp-first: 0
[2023-07-14 15:38:21] [config] disp-freq: 1000u
[2023-07-14 15:38:21] [config] disp-label-counts: true
[2023-07-14 15:38:21] [config] dropout-rnn: 0.2
[2023-07-14 15:38:21] [config] dropout-src: 0.1
[2023-07-14 15:38:21] [config] dropout-trg: 0.1
[2023-07-14 15:38:21] [config] dump-config: ""
[2023-07-14 15:38:21] [config] dynamic-gradient-scaling:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] early-stopping: 10
[2023-07-14 15:38:21] [config] early-stopping-on: first
[2023-07-14 15:38:21] [config] embedding-fix-src: false
[2023-07-14 15:38:21] [config] embedding-fix-trg: false
[2023-07-14 15:38:21] [config] embedding-normalization: false
[2023-07-14 15:38:21] [config] embedding-vectors:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] enc-cell: gru
[2023-07-14 15:38:21] [config] enc-cell-depth: 1
[2023-07-14 15:38:21] [config] enc-depth: 1
[2023-07-14 15:38:21] [config] enc-type: bidirectional
[2023-07-14 15:38:21] [config] english-title-case-every: 0
[2023-07-14 15:38:21] [config] exponential-smoothing: 0
[2023-07-14 15:38:21] [config] factor-weight: 1
[2023-07-14 15:38:21] [config] factors-combine: sum
[2023-07-14 15:38:21] [config] factors-dim-emb: 0
[2023-07-14 15:38:21] [config] gradient-checkpointing: false
[2023-07-14 15:38:21] [config] gradient-norm-average-window: 100
[2023-07-14 15:38:21] [config] guided-alignment: none
[2023-07-14 15:38:21] [config] guided-alignment-cost: mse
[2023-07-14 15:38:21] [config] guided-alignment-weight: 0.1
[2023-07-14 15:38:21] [config] ignore-model-config: false
[2023-07-14 15:38:21] [config] input-types:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] interpolate-env-vars: false
[2023-07-14 15:38:21] [config] keep-best: false
[2023-07-14 15:38:21] [config] label-smoothing: 0
[2023-07-14 15:38:21] [config] layer-normalization: true
[2023-07-14 15:38:21] [config] learn-rate: 0.0001
[2023-07-14 15:38:21] [config] lemma-dependency: ""
[2023-07-14 15:38:21] [config] lemma-dim-emb: 0
[2023-07-14 15:38:21] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:38:21] [config] log-level: info
[2023-07-14 15:38:21] [config] log-time-zone: ""
[2023-07-14 15:38:21] [config] logical-epoch:
[2023-07-14 15:38:21] [config]   - 1e
[2023-07-14 15:38:21] [config]   - 0
[2023-07-14 15:38:21] [config] lr-decay: 0
[2023-07-14 15:38:21] [config] lr-decay-freq: 50000
[2023-07-14 15:38:21] [config] lr-decay-inv-sqrt:
[2023-07-14 15:38:21] [config]   - 0
[2023-07-14 15:38:21] [config] lr-decay-repeat-warmup: false
[2023-07-14 15:38:21] [config] lr-decay-reset-optimizer: false
[2023-07-14 15:38:21] [config] lr-decay-start:
[2023-07-14 15:38:21] [config]   - 10
[2023-07-14 15:38:21] [config]   - 1
[2023-07-14 15:38:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-14 15:38:21] [config] lr-report: false
[2023-07-14 15:38:21] [config] lr-warmup: 0
[2023-07-14 15:38:21] [config] lr-warmup-at-reload: false
[2023-07-14 15:38:21] [config] lr-warmup-cycle: false
[2023-07-14 15:38:21] [config] lr-warmup-start-rate: 0
[2023-07-14 15:38:21] [config] max-length: 200
[2023-07-14 15:38:21] [config] max-length-crop: false
[2023-07-14 15:38:21] [config] max-length-factor: 3
[2023-07-14 15:38:21] [config] maxi-batch: 100
[2023-07-14 15:38:21] [config] maxi-batch-sort: trg
[2023-07-14 15:38:21] [config] mini-batch: 64
[2023-07-14 15:38:21] [config] mini-batch-fit: true
[2023-07-14 15:38:21] [config] mini-batch-fit-step: 10
[2023-07-14 15:38:21] [config] mini-batch-round-up: true
[2023-07-14 15:38:21] [config] mini-batch-track-lr: false
[2023-07-14 15:38:21] [config] mini-batch-warmup: 0
[2023-07-14 15:38:21] [config] mini-batch-words: 0
[2023-07-14 15:38:21] [config] mini-batch-words-ref: 0
[2023-07-14 15:38:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:38:21] [config] multi-loss-type: sum
[2023-07-14 15:38:21] [config] n-best: false
[2023-07-14 15:38:21] [config] no-nccl: false
[2023-07-14 15:38:21] [config] no-reload: false
[2023-07-14 15:38:21] [config] no-restore-corpus: false
[2023-07-14 15:38:21] [config] normalize: 0.6
[2023-07-14 15:38:21] [config] normalize-gradient: false
[2023-07-14 15:38:21] [config] num-devices: 0
[2023-07-14 15:38:21] [config] optimizer: adam
[2023-07-14 15:38:21] [config] optimizer-delay: 1
[2023-07-14 15:38:21] [config] optimizer-params:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] output-omit-bias: false
[2023-07-14 15:38:21] [config] overwrite: false
[2023-07-14 15:38:21] [config] precision:
[2023-07-14 15:38:21] [config]   - float32
[2023-07-14 15:38:21] [config]   - float32
[2023-07-14 15:38:21] [config] pretrained-model: ""
[2023-07-14 15:38:21] [config] quantize-biases: false
[2023-07-14 15:38:21] [config] quantize-bits: 0
[2023-07-14 15:38:21] [config] quantize-log-based: false
[2023-07-14 15:38:21] [config] quantize-optimization-steps: 0
[2023-07-14 15:38:21] [config] quiet: false
[2023-07-14 15:38:21] [config] quiet-translation: true
[2023-07-14 15:38:21] [config] relative-paths: false
[2023-07-14 15:38:21] [config] right-left: false
[2023-07-14 15:38:21] [config] save-freq: 10000u
[2023-07-14 15:38:21] [config] seed: 1234
[2023-07-14 15:38:21] [config] sentencepiece-alphas:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] sentencepiece-max-lines: 2000000
[2023-07-14 15:38:21] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-07-14 15:38:21] [config] sharding: global
[2023-07-14 15:38:21] [config] shuffle: data
[2023-07-14 15:38:21] [config] shuffle-in-ram: false
[2023-07-14 15:38:21] [config] sigterm: save-and-exit
[2023-07-14 15:38:21] [config] skip: false
[2023-07-14 15:38:21] [config] sqlite: ""
[2023-07-14 15:38:21] [config] sqlite-drop: false
[2023-07-14 15:38:21] [config] sync-freq: 200u
[2023-07-14 15:38:21] [config] sync-sgd: false
[2023-07-14 15:38:21] [config] tempdir: /tmp
[2023-07-14 15:38:21] [config] tied-embeddings: false
[2023-07-14 15:38:21] [config] tied-embeddings-all: true
[2023-07-14 15:38:21] [config] tied-embeddings-src: false
[2023-07-14 15:38:21] [config] train-embedder-rank:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] train-sets:
[2023-07-14 15:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-14 15:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-14 15:38:21] [config] transformer-aan-activation: swish
[2023-07-14 15:38:21] [config] transformer-aan-depth: 2
[2023-07-14 15:38:21] [config] transformer-aan-nogate: false
[2023-07-14 15:38:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-14 15:38:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-14 15:38:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-14 15:38:21] [config] transformer-depth-scaling: false
[2023-07-14 15:38:21] [config] transformer-dim-aan: 2048
[2023-07-14 15:38:21] [config] transformer-dim-ffn: 2048
[2023-07-14 15:38:21] [config] transformer-dropout: 0
[2023-07-14 15:38:21] [config] transformer-dropout-attention: 0
[2023-07-14 15:38:21] [config] transformer-dropout-ffn: 0
[2023-07-14 15:38:21] [config] transformer-ffn-activation: swish
[2023-07-14 15:38:21] [config] transformer-ffn-depth: 2
[2023-07-14 15:38:21] [config] transformer-guided-alignment-layer: last
[2023-07-14 15:38:21] [config] transformer-heads: 8
[2023-07-14 15:38:21] [config] transformer-no-projection: false
[2023-07-14 15:38:21] [config] transformer-pool: false
[2023-07-14 15:38:21] [config] transformer-postprocess: dan
[2023-07-14 15:38:21] [config] transformer-postprocess-emb: d
[2023-07-14 15:38:21] [config] transformer-postprocess-top: ""
[2023-07-14 15:38:21] [config] transformer-preprocess: ""
[2023-07-14 15:38:21] [config] transformer-tied-layers:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] transformer-train-position-embeddings: false
[2023-07-14 15:38:21] [config] tsv: false
[2023-07-14 15:38:21] [config] tsv-fields: 0
[2023-07-14 15:38:21] [config] type: amun
[2023-07-14 15:38:21] [config] ulr: false
[2023-07-14 15:38:21] [config] ulr-dim-emb: 0
[2023-07-14 15:38:21] [config] ulr-dropout: 0
[2023-07-14 15:38:21] [config] ulr-keys-vectors: ""
[2023-07-14 15:38:21] [config] ulr-query-vectors: ""
[2023-07-14 15:38:21] [config] ulr-softmax-temperature: 1
[2023-07-14 15:38:21] [config] ulr-trainable-transformation: false
[2023-07-14 15:38:21] [config] unlikelihood-loss: false
[2023-07-14 15:38:21] [config] valid-freq: 5000000
[2023-07-14 15:38:21] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16_length200.log
[2023-07-14 15:38:21] [config] valid-max-length: 1000
[2023-07-14 15:38:21] [config] valid-metrics:
[2023-07-14 15:38:21] [config]   - cross-entropy
[2023-07-14 15:38:21] [config]   - translation
[2023-07-14 15:38:21] [config] valid-mini-batch: 32
[2023-07-14 15:38:21] [config] valid-reset-stalled: false
[2023-07-14 15:38:21] [config] valid-script-args:
[2023-07-14 15:38:21] [config]   []
[2023-07-14 15:38:21] [config] valid-script-path: ""
[2023-07-14 15:38:21] [config] valid-sets:
[2023-07-14 15:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-14 15:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-14 15:38:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-07-14 15:38:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:38:21] [config] vocabs:
[2023-07-14 15:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:38:21] [config] word-penalty: 0
[2023-07-14 15:38:21] [config] word-scores: false
[2023-07-14 15:38:21] [config] workspace: 3000
[2023-07-14 15:38:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-14 15:38:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:38:21] [training] Using single-device training
[2023-07-14 15:38:21] Synced seed 1234
[2023-07-14 15:38:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-07-14 15:38:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-14 15:38:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-07-14 15:38:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-14 15:38:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-14 15:38:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:38:22] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:38:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:38:22] [comm] Using global sharding
[2023-07-14 15:38:22] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:38:22] [training] Using 1 GPUs
[2023-07-14 15:38:22] [logits] Applying loss function for 1 factor(s)
[2023-07-14 15:38:22] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:38:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-14 15:38:23] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:39:48] [batching] Done. Typical MB size is 6,375 target words
[2023-07-14 15:39:48] [valid] No post-processing script given for validating translator
[2023-07-14 15:39:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-14 15:39:48] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-07-14 15:39:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-14 15:39:48] [comm] Using global sharding
[2023-07-14 15:39:48] [comm] NCCLCommunicators constructed successfully
[2023-07-14 15:39:48] [training] Using 1 GPUs
[2023-07-14 15:39:48] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz
[2023-07-14 15:39:49] Loading Adam parameters
[2023-07-14 15:39:49] [memory] Reserving 322 MB, device gpu0
[2023-07-14 15:39:49] [memory] Reserving 161 MB, device gpu0
[2023-07-14 15:39:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16_length200/gn_es_scored_june_sp16_length200.npz.optimizer.npz
[2023-07-14 15:39:49] [data] Restoring the corpus state to epoch 161, batch 26476
[2023-07-14 15:39:49] [data] Shuffling data
[2023-07-14 15:39:49] [data] Done reading 20,192 sentences
[2023-07-14 15:39:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-14 15:39:49] Training started
[2023-07-14 15:39:49] Training finished
