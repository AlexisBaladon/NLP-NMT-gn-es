[2023-06-30 22:09:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:09:40] [marian] Running on node20.datos.cluster.uy as process 40914 with command line:
[2023-06-30 22:09:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:09:40] [config] after: 0e
[2023-06-30 22:09:40] [config] after-batches: 0
[2023-06-30 22:09:40] [config] after-epochs: 1
[2023-06-30 22:09:40] [config] all-caps-every: 0
[2023-06-30 22:09:40] [config] allow-unk: false
[2023-06-30 22:09:40] [config] authors: false
[2023-06-30 22:09:40] [config] beam-size: 12
[2023-06-30 22:09:40] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:09:40] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:09:40] [config] bert-masking-fraction: 0.15
[2023-06-30 22:09:40] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:09:40] [config] bert-train-type-embeddings: true
[2023-06-30 22:09:40] [config] bert-type-vocab-size: 2
[2023-06-30 22:09:40] [config] build-info: ""
[2023-06-30 22:09:40] [config] check-gradient-nan: false
[2023-06-30 22:09:40] [config] check-nan: false
[2023-06-30 22:09:40] [config] cite: false
[2023-06-30 22:09:40] [config] clip-norm: 1
[2023-06-30 22:09:40] [config] cost-scaling:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] cost-type: ce-sum
[2023-06-30 22:09:40] [config] cpu-threads: 0
[2023-06-30 22:09:40] [config] data-threads: 8
[2023-06-30 22:09:40] [config] data-weighting: ""
[2023-06-30 22:09:40] [config] data-weighting-type: sentence
[2023-06-30 22:09:40] [config] dec-cell: gru
[2023-06-30 22:09:40] [config] dec-cell-base-depth: 2
[2023-06-30 22:09:40] [config] dec-cell-high-depth: 1
[2023-06-30 22:09:40] [config] dec-depth: 1
[2023-06-30 22:09:40] [config] devices:
[2023-06-30 22:09:40] [config]   - 0
[2023-06-30 22:09:40] [config] dim-emb: 512
[2023-06-30 22:09:40] [config] dim-rnn: 1024
[2023-06-30 22:09:40] [config] dim-vocabs:
[2023-06-30 22:09:40] [config]   - 0
[2023-06-30 22:09:40] [config]   - 0
[2023-06-30 22:09:40] [config] disp-first: 0
[2023-06-30 22:09:40] [config] disp-freq: 1000u
[2023-06-30 22:09:40] [config] disp-label-counts: true
[2023-06-30 22:09:40] [config] dropout-rnn: 0
[2023-06-30 22:09:40] [config] dropout-src: 0
[2023-06-30 22:09:40] [config] dropout-trg: 0
[2023-06-30 22:09:40] [config] dump-config: ""
[2023-06-30 22:09:40] [config] dynamic-gradient-scaling:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] early-stopping: 10
[2023-06-30 22:09:40] [config] early-stopping-on: first
[2023-06-30 22:09:40] [config] embedding-fix-src: false
[2023-06-30 22:09:40] [config] embedding-fix-trg: false
[2023-06-30 22:09:40] [config] embedding-normalization: false
[2023-06-30 22:09:40] [config] embedding-vectors:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] enc-cell: gru
[2023-06-30 22:09:40] [config] enc-cell-depth: 1
[2023-06-30 22:09:40] [config] enc-depth: 1
[2023-06-30 22:09:40] [config] enc-type: bidirectional
[2023-06-30 22:09:40] [config] english-title-case-every: 0
[2023-06-30 22:09:40] [config] exponential-smoothing: 0
[2023-06-30 22:09:40] [config] factor-weight: 1
[2023-06-30 22:09:40] [config] factors-combine: sum
[2023-06-30 22:09:40] [config] factors-dim-emb: 0
[2023-06-30 22:09:40] [config] gradient-checkpointing: false
[2023-06-30 22:09:40] [config] gradient-norm-average-window: 100
[2023-06-30 22:09:40] [config] guided-alignment: none
[2023-06-30 22:09:40] [config] guided-alignment-cost: mse
[2023-06-30 22:09:40] [config] guided-alignment-weight: 0.1
[2023-06-30 22:09:40] [config] ignore-model-config: false
[2023-06-30 22:09:40] [config] input-types:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] interpolate-env-vars: false
[2023-06-30 22:09:40] [config] keep-best: false
[2023-06-30 22:09:40] [config] label-smoothing: 0
[2023-06-30 22:09:40] [config] layer-normalization: false
[2023-06-30 22:09:40] [config] learn-rate: 0.0001
[2023-06-30 22:09:40] [config] lemma-dependency: ""
[2023-06-30 22:09:40] [config] lemma-dim-emb: 0
[2023-06-30 22:09:40] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:09:40] [config] log-level: info
[2023-06-30 22:09:40] [config] log-time-zone: ""
[2023-06-30 22:09:40] [config] logical-epoch:
[2023-06-30 22:09:40] [config]   - 1e
[2023-06-30 22:09:40] [config]   - 0
[2023-06-30 22:09:40] [config] lr-decay: 0
[2023-06-30 22:09:40] [config] lr-decay-freq: 50000
[2023-06-30 22:09:40] [config] lr-decay-inv-sqrt:
[2023-06-30 22:09:40] [config]   - 0
[2023-06-30 22:09:40] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:09:40] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:09:40] [config] lr-decay-start:
[2023-06-30 22:09:40] [config]   - 10
[2023-06-30 22:09:40] [config]   - 1
[2023-06-30 22:09:40] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:09:40] [config] lr-report: false
[2023-06-30 22:09:40] [config] lr-warmup: 0
[2023-06-30 22:09:40] [config] lr-warmup-at-reload: false
[2023-06-30 22:09:40] [config] lr-warmup-cycle: false
[2023-06-30 22:09:40] [config] lr-warmup-start-rate: 0
[2023-06-30 22:09:40] [config] max-length: 50
[2023-06-30 22:09:40] [config] max-length-crop: false
[2023-06-30 22:09:40] [config] max-length-factor: 3
[2023-06-30 22:09:40] [config] maxi-batch: 100
[2023-06-30 22:09:40] [config] maxi-batch-sort: trg
[2023-06-30 22:09:40] [config] mini-batch: 64
[2023-06-30 22:09:40] [config] mini-batch-fit: false
[2023-06-30 22:09:40] [config] mini-batch-fit-step: 10
[2023-06-30 22:09:40] [config] mini-batch-round-up: true
[2023-06-30 22:09:40] [config] mini-batch-track-lr: false
[2023-06-30 22:09:40] [config] mini-batch-warmup: 0
[2023-06-30 22:09:40] [config] mini-batch-words: 0
[2023-06-30 22:09:40] [config] mini-batch-words-ref: 0
[2023-06-30 22:09:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:09:40] [config] multi-loss-type: sum
[2023-06-30 22:09:40] [config] n-best: false
[2023-06-30 22:09:40] [config] no-nccl: false
[2023-06-30 22:09:40] [config] no-reload: false
[2023-06-30 22:09:40] [config] no-restore-corpus: false
[2023-06-30 22:09:40] [config] normalize: 0
[2023-06-30 22:09:40] [config] normalize-gradient: false
[2023-06-30 22:09:40] [config] num-devices: 0
[2023-06-30 22:09:40] [config] optimizer: adam
[2023-06-30 22:09:40] [config] optimizer-delay: 1
[2023-06-30 22:09:40] [config] optimizer-params:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] output-omit-bias: false
[2023-06-30 22:09:40] [config] overwrite: true
[2023-06-30 22:09:40] [config] precision:
[2023-06-30 22:09:40] [config]   - float32
[2023-06-30 22:09:40] [config]   - float32
[2023-06-30 22:09:40] [config] pretrained-model: ""
[2023-06-30 22:09:40] [config] quantize-biases: false
[2023-06-30 22:09:40] [config] quantize-bits: 0
[2023-06-30 22:09:40] [config] quantize-log-based: false
[2023-06-30 22:09:40] [config] quantize-optimization-steps: 0
[2023-06-30 22:09:40] [config] quiet: false
[2023-06-30 22:09:40] [config] quiet-translation: true
[2023-06-30 22:09:40] [config] relative-paths: false
[2023-06-30 22:09:40] [config] right-left: false
[2023-06-30 22:09:40] [config] save-freq: 10000u
[2023-06-30 22:09:40] [config] seed: 1234
[2023-06-30 22:09:40] [config] sentencepiece-alphas:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:09:40] [config] sentencepiece-options: ""
[2023-06-30 22:09:40] [config] sharding: global
[2023-06-30 22:09:40] [config] shuffle: data
[2023-06-30 22:09:40] [config] shuffle-in-ram: false
[2023-06-30 22:09:40] [config] sigterm: save-and-exit
[2023-06-30 22:09:40] [config] skip: false
[2023-06-30 22:09:40] [config] sqlite: ""
[2023-06-30 22:09:40] [config] sqlite-drop: false
[2023-06-30 22:09:40] [config] sync-freq: 200u
[2023-06-30 22:09:40] [config] sync-sgd: false
[2023-06-30 22:09:40] [config] tempdir: /tmp
[2023-06-30 22:09:40] [config] tied-embeddings: false
[2023-06-30 22:09:40] [config] tied-embeddings-all: false
[2023-06-30 22:09:40] [config] tied-embeddings-src: false
[2023-06-30 22:09:40] [config] train-embedder-rank:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] train-sets:
[2023-06-30 22:09:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:09:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:09:40] [config] transformer-aan-activation: swish
[2023-06-30 22:09:40] [config] transformer-aan-depth: 2
[2023-06-30 22:09:40] [config] transformer-aan-nogate: false
[2023-06-30 22:09:40] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:09:40] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:09:40] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:09:40] [config] transformer-depth-scaling: false
[2023-06-30 22:09:40] [config] transformer-dim-aan: 2048
[2023-06-30 22:09:40] [config] transformer-dim-ffn: 2048
[2023-06-30 22:09:40] [config] transformer-dropout: 0
[2023-06-30 22:09:40] [config] transformer-dropout-attention: 0
[2023-06-30 22:09:40] [config] transformer-dropout-ffn: 0
[2023-06-30 22:09:40] [config] transformer-ffn-activation: swish
[2023-06-30 22:09:40] [config] transformer-ffn-depth: 2
[2023-06-30 22:09:40] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:09:40] [config] transformer-heads: 8
[2023-06-30 22:09:40] [config] transformer-no-projection: false
[2023-06-30 22:09:40] [config] transformer-pool: false
[2023-06-30 22:09:40] [config] transformer-postprocess: dan
[2023-06-30 22:09:40] [config] transformer-postprocess-emb: d
[2023-06-30 22:09:40] [config] transformer-postprocess-top: ""
[2023-06-30 22:09:40] [config] transformer-preprocess: ""
[2023-06-30 22:09:40] [config] transformer-tied-layers:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] transformer-train-position-embeddings: false
[2023-06-30 22:09:40] [config] tsv: false
[2023-06-30 22:09:40] [config] tsv-fields: 0
[2023-06-30 22:09:40] [config] type: transformer
[2023-06-30 22:09:40] [config] ulr: false
[2023-06-30 22:09:40] [config] ulr-dim-emb: 0
[2023-06-30 22:09:40] [config] ulr-dropout: 0
[2023-06-30 22:09:40] [config] ulr-keys-vectors: ""
[2023-06-30 22:09:40] [config] ulr-query-vectors: ""
[2023-06-30 22:09:40] [config] ulr-softmax-temperature: 1
[2023-06-30 22:09:40] [config] ulr-trainable-transformation: false
[2023-06-30 22:09:40] [config] unlikelihood-loss: false
[2023-06-30 22:09:40] [config] valid-freq: 50000000
[2023-06-30 22:09:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:09:40] [config] valid-max-length: 1000
[2023-06-30 22:09:40] [config] valid-metrics:
[2023-06-30 22:09:40] [config]   - cross-entropy
[2023-06-30 22:09:40] [config]   - translation
[2023-06-30 22:09:40] [config] valid-mini-batch: 32
[2023-06-30 22:09:40] [config] valid-reset-stalled: false
[2023-06-30 22:09:40] [config] valid-script-args:
[2023-06-30 22:09:40] [config]   []
[2023-06-30 22:09:40] [config] valid-script-path: ""
[2023-06-30 22:09:40] [config] valid-sets:
[2023-06-30 22:09:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:09:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:09:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:09:40] [config] vocabs:
[2023-06-30 22:09:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:09:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:09:40] [config] word-penalty: 0
[2023-06-30 22:09:40] [config] word-scores: false
[2023-06-30 22:09:40] [config] workspace: 2048
[2023-06-30 22:09:40] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:09:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:09:40] [training] Using single-device training
[2023-06-30 22:09:41] Synced seed 1234
[2023-06-30 22:09:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:09:41] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:09:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:09:41] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:09:41] [valid] No post-processing script given for validating translator
[2023-06-30 22:09:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:09:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:09:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:09:43] [comm] Using global sharding
[2023-06-30 22:09:43] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:09:43] [training] Using 1 GPUs
[2023-06-30 22:09:43] Training started
[2023-06-30 22:09:43] [data] Shuffling data
[2023-06-30 22:09:43] [data] Done reading 20,192 sentences
[2023-06-30 22:09:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:09:44] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:09:44] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:09:44] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:09:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:09:47] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:09:47] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:09:47] Allocating memory for Adam-specific shards
[2023-06-30 22:09:47] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:10:04] Seen 18,843 samples
[2023-06-30 22:10:04] Starting data epoch 2 in logical epoch 2
[2023-06-30 22:10:04] Training finished
[2023-06-30 22:10:06] [valid] Ep. 2 : Up. 297 : cross-entropy : 118.153 : new best
[2023-06-30 22:11:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:11:05] [marian] Running on node23.datos.cluster.uy as process 32485 with command line:
[2023-06-30 22:11:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:11:05] [config] after: 0e
[2023-06-30 22:11:05] [config] after-batches: 0
[2023-06-30 22:11:05] [config] after-epochs: 1
[2023-06-30 22:11:05] [config] all-caps-every: 0
[2023-06-30 22:11:05] [config] allow-unk: false
[2023-06-30 22:11:05] [config] authors: false
[2023-06-30 22:11:05] [config] beam-size: 12
[2023-06-30 22:11:05] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:11:05] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:11:05] [config] bert-masking-fraction: 0.15
[2023-06-30 22:11:05] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:11:05] [config] bert-train-type-embeddings: true
[2023-06-30 22:11:05] [config] bert-type-vocab-size: 2
[2023-06-30 22:11:05] [config] build-info: ""
[2023-06-30 22:11:05] [config] check-gradient-nan: false
[2023-06-30 22:11:05] [config] check-nan: false
[2023-06-30 22:11:05] [config] cite: false
[2023-06-30 22:11:05] [config] clip-norm: 1
[2023-06-30 22:11:05] [config] cost-scaling:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] cost-type: ce-sum
[2023-06-30 22:11:05] [config] cpu-threads: 0
[2023-06-30 22:11:05] [config] data-threads: 8
[2023-06-30 22:11:05] [config] data-weighting: ""
[2023-06-30 22:11:05] [config] data-weighting-type: sentence
[2023-06-30 22:11:05] [config] dec-cell: gru
[2023-06-30 22:11:05] [config] dec-cell-base-depth: 2
[2023-06-30 22:11:05] [config] dec-cell-high-depth: 1
[2023-06-30 22:11:05] [config] dec-depth: 1
[2023-06-30 22:11:05] [config] devices:
[2023-06-30 22:11:05] [config]   - 0
[2023-06-30 22:11:05] [config] dim-emb: 512
[2023-06-30 22:11:05] [config] dim-rnn: 1024
[2023-06-30 22:11:05] [config] dim-vocabs:
[2023-06-30 22:11:05] [config]   - 0
[2023-06-30 22:11:05] [config]   - 0
[2023-06-30 22:11:05] [config] disp-first: 0
[2023-06-30 22:11:05] [config] disp-freq: 1000u
[2023-06-30 22:11:05] [config] disp-label-counts: true
[2023-06-30 22:11:05] [config] dropout-rnn: 0
[2023-06-30 22:11:05] [config] dropout-src: 0
[2023-06-30 22:11:05] [config] dropout-trg: 0
[2023-06-30 22:11:05] [config] dump-config: ""
[2023-06-30 22:11:05] [config] dynamic-gradient-scaling:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] early-stopping: 10
[2023-06-30 22:11:05] [config] early-stopping-on: first
[2023-06-30 22:11:05] [config] embedding-fix-src: false
[2023-06-30 22:11:05] [config] embedding-fix-trg: false
[2023-06-30 22:11:05] [config] embedding-normalization: false
[2023-06-30 22:11:05] [config] embedding-vectors:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] enc-cell: gru
[2023-06-30 22:11:05] [config] enc-cell-depth: 1
[2023-06-30 22:11:05] [config] enc-depth: 1
[2023-06-30 22:11:05] [config] enc-type: bidirectional
[2023-06-30 22:11:05] [config] english-title-case-every: 0
[2023-06-30 22:11:05] [config] exponential-smoothing: 0
[2023-06-30 22:11:05] [config] factor-weight: 1
[2023-06-30 22:11:05] [config] factors-combine: sum
[2023-06-30 22:11:05] [config] factors-dim-emb: 0
[2023-06-30 22:11:05] [config] gradient-checkpointing: false
[2023-06-30 22:11:05] [config] gradient-norm-average-window: 100
[2023-06-30 22:11:05] [config] guided-alignment: none
[2023-06-30 22:11:05] [config] guided-alignment-cost: mse
[2023-06-30 22:11:05] [config] guided-alignment-weight: 0.1
[2023-06-30 22:11:05] [config] ignore-model-config: false
[2023-06-30 22:11:05] [config] input-types:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] interpolate-env-vars: false
[2023-06-30 22:11:05] [config] keep-best: false
[2023-06-30 22:11:05] [config] label-smoothing: 0
[2023-06-30 22:11:05] [config] layer-normalization: false
[2023-06-30 22:11:05] [config] learn-rate: 0.0001
[2023-06-30 22:11:05] [config] lemma-dependency: ""
[2023-06-30 22:11:05] [config] lemma-dim-emb: 0
[2023-06-30 22:11:05] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:11:05] [config] log-level: info
[2023-06-30 22:11:05] [config] log-time-zone: ""
[2023-06-30 22:11:05] [config] logical-epoch:
[2023-06-30 22:11:05] [config]   - 1e
[2023-06-30 22:11:05] [config]   - 0
[2023-06-30 22:11:05] [config] lr-decay: 0
[2023-06-30 22:11:05] [config] lr-decay-freq: 50000
[2023-06-30 22:11:05] [config] lr-decay-inv-sqrt:
[2023-06-30 22:11:05] [config]   - 0
[2023-06-30 22:11:05] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:11:05] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:11:05] [config] lr-decay-start:
[2023-06-30 22:11:05] [config]   - 10
[2023-06-30 22:11:05] [config]   - 1
[2023-06-30 22:11:05] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:11:05] [config] lr-report: false
[2023-06-30 22:11:05] [config] lr-warmup: 0
[2023-06-30 22:11:05] [config] lr-warmup-at-reload: false
[2023-06-30 22:11:05] [config] lr-warmup-cycle: false
[2023-06-30 22:11:05] [config] lr-warmup-start-rate: 0
[2023-06-30 22:11:05] [config] max-length: 50
[2023-06-30 22:11:05] [config] max-length-crop: false
[2023-06-30 22:11:05] [config] max-length-factor: 3
[2023-06-30 22:11:05] [config] maxi-batch: 100
[2023-06-30 22:11:05] [config] maxi-batch-sort: trg
[2023-06-30 22:11:05] [config] mini-batch: 64
[2023-06-30 22:11:05] [config] mini-batch-fit: false
[2023-06-30 22:11:05] [config] mini-batch-fit-step: 10
[2023-06-30 22:11:05] [config] mini-batch-round-up: true
[2023-06-30 22:11:05] [config] mini-batch-track-lr: false
[2023-06-30 22:11:05] [config] mini-batch-warmup: 0
[2023-06-30 22:11:05] [config] mini-batch-words: 0
[2023-06-30 22:11:05] [config] mini-batch-words-ref: 0
[2023-06-30 22:11:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:11:05] [config] multi-loss-type: sum
[2023-06-30 22:11:05] [config] n-best: false
[2023-06-30 22:11:05] [config] no-nccl: false
[2023-06-30 22:11:05] [config] no-reload: false
[2023-06-30 22:11:05] [config] no-restore-corpus: false
[2023-06-30 22:11:05] [config] normalize: 0
[2023-06-30 22:11:05] [config] normalize-gradient: false
[2023-06-30 22:11:05] [config] num-devices: 0
[2023-06-30 22:11:05] [config] optimizer: adam
[2023-06-30 22:11:05] [config] optimizer-delay: 1
[2023-06-30 22:11:05] [config] optimizer-params:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] output-omit-bias: false
[2023-06-30 22:11:05] [config] overwrite: true
[2023-06-30 22:11:05] [config] precision:
[2023-06-30 22:11:05] [config]   - float32
[2023-06-30 22:11:05] [config]   - float32
[2023-06-30 22:11:05] [config] pretrained-model: ""
[2023-06-30 22:11:05] [config] quantize-biases: false
[2023-06-30 22:11:05] [config] quantize-bits: 0
[2023-06-30 22:11:05] [config] quantize-log-based: false
[2023-06-30 22:11:05] [config] quantize-optimization-steps: 0
[2023-06-30 22:11:05] [config] quiet: false
[2023-06-30 22:11:05] [config] quiet-translation: true
[2023-06-30 22:11:05] [config] relative-paths: false
[2023-06-30 22:11:05] [config] right-left: false
[2023-06-30 22:11:05] [config] save-freq: 10000u
[2023-06-30 22:11:05] [config] seed: 1234
[2023-06-30 22:11:05] [config] sentencepiece-alphas:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:11:05] [config] sentencepiece-options: ""
[2023-06-30 22:11:05] [config] sharding: global
[2023-06-30 22:11:05] [config] shuffle: data
[2023-06-30 22:11:05] [config] shuffle-in-ram: false
[2023-06-30 22:11:05] [config] sigterm: save-and-exit
[2023-06-30 22:11:05] [config] skip: false
[2023-06-30 22:11:05] [config] sqlite: ""
[2023-06-30 22:11:05] [config] sqlite-drop: false
[2023-06-30 22:11:05] [config] sync-freq: 200u
[2023-06-30 22:11:05] [config] sync-sgd: false
[2023-06-30 22:11:05] [config] tempdir: /tmp
[2023-06-30 22:11:05] [config] tied-embeddings: false
[2023-06-30 22:11:05] [config] tied-embeddings-all: false
[2023-06-30 22:11:05] [config] tied-embeddings-src: false
[2023-06-30 22:11:05] [config] train-embedder-rank:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] train-sets:
[2023-06-30 22:11:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:11:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:11:05] [config] transformer-aan-activation: swish
[2023-06-30 22:11:05] [config] transformer-aan-depth: 2
[2023-06-30 22:11:05] [config] transformer-aan-nogate: false
[2023-06-30 22:11:05] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:11:05] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:11:05] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:11:05] [config] transformer-depth-scaling: false
[2023-06-30 22:11:05] [config] transformer-dim-aan: 2048
[2023-06-30 22:11:05] [config] transformer-dim-ffn: 2048
[2023-06-30 22:11:05] [config] transformer-dropout: 0
[2023-06-30 22:11:05] [config] transformer-dropout-attention: 0
[2023-06-30 22:11:05] [config] transformer-dropout-ffn: 0
[2023-06-30 22:11:05] [config] transformer-ffn-activation: swish
[2023-06-30 22:11:05] [config] transformer-ffn-depth: 2
[2023-06-30 22:11:05] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:11:05] [config] transformer-heads: 8
[2023-06-30 22:11:05] [config] transformer-no-projection: false
[2023-06-30 22:11:05] [config] transformer-pool: false
[2023-06-30 22:11:05] [config] transformer-postprocess: dan
[2023-06-30 22:11:05] [config] transformer-postprocess-emb: d
[2023-06-30 22:11:05] [config] transformer-postprocess-top: ""
[2023-06-30 22:11:05] [config] transformer-preprocess: ""
[2023-06-30 22:11:05] [config] transformer-tied-layers:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] transformer-train-position-embeddings: false
[2023-06-30 22:11:05] [config] tsv: false
[2023-06-30 22:11:05] [config] tsv-fields: 0
[2023-06-30 22:11:05] [config] type: transformer
[2023-06-30 22:11:05] [config] ulr: false
[2023-06-30 22:11:05] [config] ulr-dim-emb: 0
[2023-06-30 22:11:05] [config] ulr-dropout: 0
[2023-06-30 22:11:05] [config] ulr-keys-vectors: ""
[2023-06-30 22:11:05] [config] ulr-query-vectors: ""
[2023-06-30 22:11:05] [config] ulr-softmax-temperature: 1
[2023-06-30 22:11:05] [config] ulr-trainable-transformation: false
[2023-06-30 22:11:05] [config] unlikelihood-loss: false
[2023-06-30 22:11:05] [config] valid-freq: 50000000
[2023-06-30 22:11:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:11:05] [config] valid-max-length: 1000
[2023-06-30 22:11:05] [config] valid-metrics:
[2023-06-30 22:11:05] [config]   - cross-entropy
[2023-06-30 22:11:05] [config]   - translation
[2023-06-30 22:11:05] [config] valid-mini-batch: 32
[2023-06-30 22:11:05] [config] valid-reset-stalled: false
[2023-06-30 22:11:05] [config] valid-script-args:
[2023-06-30 22:11:05] [config]   []
[2023-06-30 22:11:05] [config] valid-script-path: ""
[2023-06-30 22:11:05] [config] valid-sets:
[2023-06-30 22:11:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:11:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:11:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:11:05] [config] vocabs:
[2023-06-30 22:11:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:11:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:11:05] [config] word-penalty: 0
[2023-06-30 22:11:05] [config] word-scores: false
[2023-06-30 22:11:05] [config] workspace: 2048
[2023-06-30 22:11:05] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:11:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:11:05] [training] Using single-device training
[2023-06-30 22:11:06] Synced seed 1234
[2023-06-30 22:11:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:11:06] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:11:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:11:06] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:11:06] [valid] No post-processing script given for validating translator
[2023-06-30 22:11:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:11:07] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:11:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:11:07] [comm] Using global sharding
[2023-06-30 22:11:07] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:11:07] [training] Using 1 GPUs
[2023-06-30 22:11:07] Training started
[2023-06-30 22:11:07] [data] Shuffling data
[2023-06-30 22:11:07] [data] Done reading 20,192 sentences
[2023-06-30 22:11:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:11:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:11:07] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:11:07] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:11:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:11:09] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:11:09] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:11:09] Allocating memory for Adam-specific shards
[2023-06-30 22:11:09] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:11:25] Seen 18,843 samples
[2023-06-30 22:11:25] Starting data epoch 2 in logical epoch 2
[2023-06-30 22:11:25] Training finished
[2023-06-30 22:11:28] [valid] Ep. 2 : Up. 297 : cross-entropy : 118.153 : new best
[2023-06-30 22:12:14] [valid] Ep. 2 : Up. 297 : translation : 0 : new best
[2023-06-30 22:12:14] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:12:17] Saving Adam parameters
[2023-06-30 22:12:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:12:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:12:28] [marian] Running on node20.datos.cluster.uy as process 449 with command line:
[2023-06-30 22:12:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:12:28] [config] after: 0e
[2023-06-30 22:12:28] [config] after-batches: 0
[2023-06-30 22:12:28] [config] after-epochs: 2
[2023-06-30 22:12:28] [config] all-caps-every: 0
[2023-06-30 22:12:28] [config] allow-unk: false
[2023-06-30 22:12:28] [config] authors: false
[2023-06-30 22:12:28] [config] beam-size: 12
[2023-06-30 22:12:28] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:12:28] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:12:28] [config] bert-masking-fraction: 0.15
[2023-06-30 22:12:28] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:12:28] [config] bert-train-type-embeddings: true
[2023-06-30 22:12:28] [config] bert-type-vocab-size: 2
[2023-06-30 22:12:28] [config] build-info: ""
[2023-06-30 22:12:28] [config] check-gradient-nan: false
[2023-06-30 22:12:28] [config] check-nan: false
[2023-06-30 22:12:28] [config] cite: false
[2023-06-30 22:12:28] [config] clip-norm: 1
[2023-06-30 22:12:28] [config] cost-scaling:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] cost-type: ce-sum
[2023-06-30 22:12:28] [config] cpu-threads: 0
[2023-06-30 22:12:28] [config] data-threads: 8
[2023-06-30 22:12:28] [config] data-weighting: ""
[2023-06-30 22:12:28] [config] data-weighting-type: sentence
[2023-06-30 22:12:28] [config] dec-cell: gru
[2023-06-30 22:12:28] [config] dec-cell-base-depth: 2
[2023-06-30 22:12:28] [config] dec-cell-high-depth: 1
[2023-06-30 22:12:28] [config] dec-depth: 1
[2023-06-30 22:12:28] [config] devices:
[2023-06-30 22:12:28] [config]   - 0
[2023-06-30 22:12:28] [config] dim-emb: 512
[2023-06-30 22:12:28] [config] dim-rnn: 1024
[2023-06-30 22:12:28] [config] dim-vocabs:
[2023-06-30 22:12:28] [config]   - 54042
[2023-06-30 22:12:28] [config]   - 36507
[2023-06-30 22:12:28] [config] disp-first: 0
[2023-06-30 22:12:28] [config] disp-freq: 1000u
[2023-06-30 22:12:28] [config] disp-label-counts: true
[2023-06-30 22:12:28] [config] dropout-rnn: 0
[2023-06-30 22:12:28] [config] dropout-src: 0
[2023-06-30 22:12:28] [config] dropout-trg: 0
[2023-06-30 22:12:28] [config] dump-config: ""
[2023-06-30 22:12:28] [config] dynamic-gradient-scaling:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] early-stopping: 10
[2023-06-30 22:12:28] [config] early-stopping-on: first
[2023-06-30 22:12:28] [config] embedding-fix-src: false
[2023-06-30 22:12:28] [config] embedding-fix-trg: false
[2023-06-30 22:12:28] [config] embedding-normalization: false
[2023-06-30 22:12:28] [config] embedding-vectors:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] enc-cell: gru
[2023-06-30 22:12:28] [config] enc-cell-depth: 1
[2023-06-30 22:12:28] [config] enc-depth: 1
[2023-06-30 22:12:28] [config] enc-type: bidirectional
[2023-06-30 22:12:28] [config] english-title-case-every: 0
[2023-06-30 22:12:28] [config] exponential-smoothing: 0
[2023-06-30 22:12:28] [config] factor-weight: 1
[2023-06-30 22:12:28] [config] factors-combine: sum
[2023-06-30 22:12:28] [config] factors-dim-emb: 0
[2023-06-30 22:12:28] [config] gradient-checkpointing: false
[2023-06-30 22:12:28] [config] gradient-norm-average-window: 100
[2023-06-30 22:12:28] [config] guided-alignment: none
[2023-06-30 22:12:28] [config] guided-alignment-cost: mse
[2023-06-30 22:12:28] [config] guided-alignment-weight: 0.1
[2023-06-30 22:12:28] [config] ignore-model-config: false
[2023-06-30 22:12:28] [config] input-types:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] interpolate-env-vars: false
[2023-06-30 22:12:28] [config] keep-best: false
[2023-06-30 22:12:28] [config] label-smoothing: 0
[2023-06-30 22:12:28] [config] layer-normalization: false
[2023-06-30 22:12:28] [config] learn-rate: 0.0001
[2023-06-30 22:12:28] [config] lemma-dependency: ""
[2023-06-30 22:12:28] [config] lemma-dim-emb: 0
[2023-06-30 22:12:28] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:12:28] [config] log-level: info
[2023-06-30 22:12:28] [config] log-time-zone: ""
[2023-06-30 22:12:28] [config] logical-epoch:
[2023-06-30 22:12:28] [config]   - 1e
[2023-06-30 22:12:28] [config]   - 0
[2023-06-30 22:12:28] [config] lr-decay: 0
[2023-06-30 22:12:28] [config] lr-decay-freq: 50000
[2023-06-30 22:12:28] [config] lr-decay-inv-sqrt:
[2023-06-30 22:12:28] [config]   - 0
[2023-06-30 22:12:28] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:12:28] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:12:28] [config] lr-decay-start:
[2023-06-30 22:12:28] [config]   - 10
[2023-06-30 22:12:28] [config]   - 1
[2023-06-30 22:12:28] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:12:28] [config] lr-report: false
[2023-06-30 22:12:28] [config] lr-warmup: 0
[2023-06-30 22:12:28] [config] lr-warmup-at-reload: false
[2023-06-30 22:12:28] [config] lr-warmup-cycle: false
[2023-06-30 22:12:28] [config] lr-warmup-start-rate: 0
[2023-06-30 22:12:28] [config] max-length: 50
[2023-06-30 22:12:28] [config] max-length-crop: false
[2023-06-30 22:12:28] [config] max-length-factor: 3
[2023-06-30 22:12:28] [config] maxi-batch: 100
[2023-06-30 22:12:28] [config] maxi-batch-sort: trg
[2023-06-30 22:12:28] [config] mini-batch: 64
[2023-06-30 22:12:28] [config] mini-batch-fit: false
[2023-06-30 22:12:28] [config] mini-batch-fit-step: 10
[2023-06-30 22:12:28] [config] mini-batch-round-up: true
[2023-06-30 22:12:28] [config] mini-batch-track-lr: false
[2023-06-30 22:12:28] [config] mini-batch-warmup: 0
[2023-06-30 22:12:28] [config] mini-batch-words: 0
[2023-06-30 22:12:28] [config] mini-batch-words-ref: 0
[2023-06-30 22:12:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:12:28] [config] multi-loss-type: sum
[2023-06-30 22:12:28] [config] n-best: false
[2023-06-30 22:12:28] [config] no-nccl: false
[2023-06-30 22:12:28] [config] no-reload: false
[2023-06-30 22:12:28] [config] no-restore-corpus: false
[2023-06-30 22:12:28] [config] normalize: 0
[2023-06-30 22:12:28] [config] normalize-gradient: false
[2023-06-30 22:12:28] [config] num-devices: 0
[2023-06-30 22:12:28] [config] optimizer: adam
[2023-06-30 22:12:28] [config] optimizer-delay: 1
[2023-06-30 22:12:28] [config] optimizer-params:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] output-omit-bias: false
[2023-06-30 22:12:28] [config] overwrite: true
[2023-06-30 22:12:28] [config] precision:
[2023-06-30 22:12:28] [config]   - float32
[2023-06-30 22:12:28] [config]   - float32
[2023-06-30 22:12:28] [config] pretrained-model: ""
[2023-06-30 22:12:28] [config] quantize-biases: false
[2023-06-30 22:12:28] [config] quantize-bits: 0
[2023-06-30 22:12:28] [config] quantize-log-based: false
[2023-06-30 22:12:28] [config] quantize-optimization-steps: 0
[2023-06-30 22:12:28] [config] quiet: false
[2023-06-30 22:12:28] [config] quiet-translation: true
[2023-06-30 22:12:28] [config] relative-paths: false
[2023-06-30 22:12:28] [config] right-left: false
[2023-06-30 22:12:28] [config] save-freq: 10000u
[2023-06-30 22:12:28] [config] seed: 1234
[2023-06-30 22:12:28] [config] sentencepiece-alphas:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:12:28] [config] sentencepiece-options: ""
[2023-06-30 22:12:28] [config] sharding: global
[2023-06-30 22:12:28] [config] shuffle: data
[2023-06-30 22:12:28] [config] shuffle-in-ram: false
[2023-06-30 22:12:28] [config] sigterm: save-and-exit
[2023-06-30 22:12:28] [config] skip: false
[2023-06-30 22:12:28] [config] sqlite: ""
[2023-06-30 22:12:28] [config] sqlite-drop: false
[2023-06-30 22:12:28] [config] sync-freq: 200u
[2023-06-30 22:12:28] [config] sync-sgd: false
[2023-06-30 22:12:28] [config] tempdir: /tmp
[2023-06-30 22:12:28] [config] tied-embeddings: false
[2023-06-30 22:12:28] [config] tied-embeddings-all: false
[2023-06-30 22:12:28] [config] tied-embeddings-src: false
[2023-06-30 22:12:28] [config] train-embedder-rank:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] train-sets:
[2023-06-30 22:12:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:12:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:12:28] [config] transformer-aan-activation: swish
[2023-06-30 22:12:28] [config] transformer-aan-depth: 2
[2023-06-30 22:12:28] [config] transformer-aan-nogate: false
[2023-06-30 22:12:28] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:12:28] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:12:28] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:12:28] [config] transformer-depth-scaling: false
[2023-06-30 22:12:28] [config] transformer-dim-aan: 2048
[2023-06-30 22:12:28] [config] transformer-dim-ffn: 2048
[2023-06-30 22:12:28] [config] transformer-dropout: 0
[2023-06-30 22:12:28] [config] transformer-dropout-attention: 0
[2023-06-30 22:12:28] [config] transformer-dropout-ffn: 0
[2023-06-30 22:12:28] [config] transformer-ffn-activation: swish
[2023-06-30 22:12:28] [config] transformer-ffn-depth: 2
[2023-06-30 22:12:28] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:12:28] [config] transformer-heads: 8
[2023-06-30 22:12:28] [config] transformer-no-projection: false
[2023-06-30 22:12:28] [config] transformer-pool: false
[2023-06-30 22:12:28] [config] transformer-postprocess: dan
[2023-06-30 22:12:28] [config] transformer-postprocess-emb: d
[2023-06-30 22:12:28] [config] transformer-postprocess-top: ""
[2023-06-30 22:12:28] [config] transformer-preprocess: ""
[2023-06-30 22:12:28] [config] transformer-tied-layers:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] transformer-train-position-embeddings: false
[2023-06-30 22:12:28] [config] tsv: false
[2023-06-30 22:12:28] [config] tsv-fields: 0
[2023-06-30 22:12:28] [config] type: transformer
[2023-06-30 22:12:28] [config] ulr: false
[2023-06-30 22:12:28] [config] ulr-dim-emb: 0
[2023-06-30 22:12:28] [config] ulr-dropout: 0
[2023-06-30 22:12:28] [config] ulr-keys-vectors: ""
[2023-06-30 22:12:28] [config] ulr-query-vectors: ""
[2023-06-30 22:12:28] [config] ulr-softmax-temperature: 1
[2023-06-30 22:12:28] [config] ulr-trainable-transformation: false
[2023-06-30 22:12:28] [config] unlikelihood-loss: false
[2023-06-30 22:12:28] [config] valid-freq: 50000000
[2023-06-30 22:12:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:12:28] [config] valid-max-length: 1000
[2023-06-30 22:12:28] [config] valid-metrics:
[2023-06-30 22:12:28] [config]   - cross-entropy
[2023-06-30 22:12:28] [config]   - translation
[2023-06-30 22:12:28] [config] valid-mini-batch: 32
[2023-06-30 22:12:28] [config] valid-reset-stalled: false
[2023-06-30 22:12:28] [config] valid-script-args:
[2023-06-30 22:12:28] [config]   []
[2023-06-30 22:12:28] [config] valid-script-path: ""
[2023-06-30 22:12:28] [config] valid-sets:
[2023-06-30 22:12:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:12:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:12:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:12:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:12:28] [config] vocabs:
[2023-06-30 22:12:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:12:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:12:28] [config] word-penalty: 0
[2023-06-30 22:12:28] [config] word-scores: false
[2023-06-30 22:12:28] [config] workspace: 2048
[2023-06-30 22:12:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:12:28] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:12:28] [training] Using single-device training
[2023-06-30 22:12:28] Synced seed 1234
[2023-06-30 22:12:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:12:28] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:12:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:12:28] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:12:28] [valid] No post-processing script given for validating translator
[2023-06-30 22:12:28] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:12:29] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:12:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:12:29] [comm] Using global sharding
[2023-06-30 22:12:29] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:12:29] [training] Using 1 GPUs
[2023-06-30 22:12:29] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:12:31] Loading Adam parameters
[2023-06-30 22:12:31] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:12:31] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:12:32] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:12:32] [data] Restoring the corpus state to epoch 2, batch 297
[2023-06-30 22:12:32] [data] Shuffling data
[2023-06-30 22:12:32] [data] Done reading 20,192 sentences
[2023-06-30 22:12:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:12:32] Training started
[2023-06-30 22:12:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:12:32] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:12:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:12:32] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:12:32] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:12:49] Seen 18,843 samples
[2023-06-30 22:12:49] Starting data epoch 3 in logical epoch 3
[2023-06-30 22:12:49] Training finished
[2023-06-30 22:12:51] [valid] Ep. 3 : Up. 594 : cross-entropy : 110.908 : new best
[2023-06-30 22:15:06] [valid] Ep. 3 : Up. 594 : translation : 0 : new best
[2023-06-30 22:15:06] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:15:09] Saving Adam parameters
[2023-06-30 22:15:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:16:14] [valid] Ep. 2 : Up. 297 : translation : 0 : new best
[2023-06-30 22:16:14] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:16:17] Saving Adam parameters
[2023-06-30 22:16:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:19:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:19:31] [marian] Running on node20.datos.cluster.uy as process 1114 with command line:
[2023-06-30 22:19:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:19:31] [config] after: 0e
[2023-06-30 22:19:31] [config] after-batches: 0
[2023-06-30 22:19:31] [config] after-epochs: 10
[2023-06-30 22:19:31] [config] all-caps-every: 0
[2023-06-30 22:19:31] [config] allow-unk: false
[2023-06-30 22:19:31] [config] authors: false
[2023-06-30 22:19:31] [config] beam-size: 12
[2023-06-30 22:19:31] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:19:31] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:19:31] [config] bert-masking-fraction: 0.15
[2023-06-30 22:19:31] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:19:31] [config] bert-train-type-embeddings: true
[2023-06-30 22:19:31] [config] bert-type-vocab-size: 2
[2023-06-30 22:19:31] [config] build-info: ""
[2023-06-30 22:19:31] [config] check-gradient-nan: false
[2023-06-30 22:19:31] [config] check-nan: false
[2023-06-30 22:19:31] [config] cite: false
[2023-06-30 22:19:31] [config] clip-norm: 1
[2023-06-30 22:19:31] [config] cost-scaling:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] cost-type: ce-sum
[2023-06-30 22:19:31] [config] cpu-threads: 0
[2023-06-30 22:19:31] [config] data-threads: 8
[2023-06-30 22:19:31] [config] data-weighting: ""
[2023-06-30 22:19:31] [config] data-weighting-type: sentence
[2023-06-30 22:19:31] [config] dec-cell: gru
[2023-06-30 22:19:31] [config] dec-cell-base-depth: 2
[2023-06-30 22:19:31] [config] dec-cell-high-depth: 1
[2023-06-30 22:19:31] [config] dec-depth: 1
[2023-06-30 22:19:31] [config] devices:
[2023-06-30 22:19:31] [config]   - 0
[2023-06-30 22:19:31] [config] dim-emb: 512
[2023-06-30 22:19:31] [config] dim-rnn: 1024
[2023-06-30 22:19:31] [config] dim-vocabs:
[2023-06-30 22:19:31] [config]   - 54042
[2023-06-30 22:19:31] [config]   - 36507
[2023-06-30 22:19:31] [config] disp-first: 0
[2023-06-30 22:19:31] [config] disp-freq: 1000u
[2023-06-30 22:19:31] [config] disp-label-counts: true
[2023-06-30 22:19:31] [config] dropout-rnn: 0
[2023-06-30 22:19:31] [config] dropout-src: 0
[2023-06-30 22:19:31] [config] dropout-trg: 0
[2023-06-30 22:19:31] [config] dump-config: ""
[2023-06-30 22:19:31] [config] dynamic-gradient-scaling:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] early-stopping: 10
[2023-06-30 22:19:31] [config] early-stopping-on: first
[2023-06-30 22:19:31] [config] embedding-fix-src: false
[2023-06-30 22:19:31] [config] embedding-fix-trg: false
[2023-06-30 22:19:31] [config] embedding-normalization: false
[2023-06-30 22:19:31] [config] embedding-vectors:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] enc-cell: gru
[2023-06-30 22:19:31] [config] enc-cell-depth: 1
[2023-06-30 22:19:31] [config] enc-depth: 1
[2023-06-30 22:19:31] [config] enc-type: bidirectional
[2023-06-30 22:19:31] [config] english-title-case-every: 0
[2023-06-30 22:19:31] [config] exponential-smoothing: 0
[2023-06-30 22:19:31] [config] factor-weight: 1
[2023-06-30 22:19:31] [config] factors-combine: sum
[2023-06-30 22:19:31] [config] factors-dim-emb: 0
[2023-06-30 22:19:31] [config] gradient-checkpointing: false
[2023-06-30 22:19:31] [config] gradient-norm-average-window: 100
[2023-06-30 22:19:31] [config] guided-alignment: none
[2023-06-30 22:19:31] [config] guided-alignment-cost: mse
[2023-06-30 22:19:31] [config] guided-alignment-weight: 0.1
[2023-06-30 22:19:31] [config] ignore-model-config: false
[2023-06-30 22:19:31] [config] input-types:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] interpolate-env-vars: false
[2023-06-30 22:19:31] [config] keep-best: false
[2023-06-30 22:19:31] [config] label-smoothing: 0
[2023-06-30 22:19:31] [config] layer-normalization: false
[2023-06-30 22:19:31] [config] learn-rate: 0.0001
[2023-06-30 22:19:31] [config] lemma-dependency: ""
[2023-06-30 22:19:31] [config] lemma-dim-emb: 0
[2023-06-30 22:19:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:19:31] [config] log-level: info
[2023-06-30 22:19:31] [config] log-time-zone: ""
[2023-06-30 22:19:31] [config] logical-epoch:
[2023-06-30 22:19:31] [config]   - 1e
[2023-06-30 22:19:31] [config]   - 0
[2023-06-30 22:19:31] [config] lr-decay: 0
[2023-06-30 22:19:31] [config] lr-decay-freq: 50000
[2023-06-30 22:19:31] [config] lr-decay-inv-sqrt:
[2023-06-30 22:19:31] [config]   - 0
[2023-06-30 22:19:31] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:19:31] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:19:31] [config] lr-decay-start:
[2023-06-30 22:19:31] [config]   - 10
[2023-06-30 22:19:31] [config]   - 1
[2023-06-30 22:19:31] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:19:31] [config] lr-report: false
[2023-06-30 22:19:31] [config] lr-warmup: 0
[2023-06-30 22:19:31] [config] lr-warmup-at-reload: false
[2023-06-30 22:19:31] [config] lr-warmup-cycle: false
[2023-06-30 22:19:31] [config] lr-warmup-start-rate: 0
[2023-06-30 22:19:31] [config] max-length: 50
[2023-06-30 22:19:31] [config] max-length-crop: false
[2023-06-30 22:19:31] [config] max-length-factor: 3
[2023-06-30 22:19:31] [config] maxi-batch: 100
[2023-06-30 22:19:31] [config] maxi-batch-sort: trg
[2023-06-30 22:19:31] [config] mini-batch: 64
[2023-06-30 22:19:31] [config] mini-batch-fit: false
[2023-06-30 22:19:31] [config] mini-batch-fit-step: 10
[2023-06-30 22:19:31] [config] mini-batch-round-up: true
[2023-06-30 22:19:31] [config] mini-batch-track-lr: false
[2023-06-30 22:19:31] [config] mini-batch-warmup: 0
[2023-06-30 22:19:31] [config] mini-batch-words: 0
[2023-06-30 22:19:31] [config] mini-batch-words-ref: 0
[2023-06-30 22:19:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:19:31] [config] multi-loss-type: sum
[2023-06-30 22:19:31] [config] n-best: false
[2023-06-30 22:19:31] [config] no-nccl: false
[2023-06-30 22:19:31] [config] no-reload: false
[2023-06-30 22:19:31] [config] no-restore-corpus: false
[2023-06-30 22:19:31] [config] normalize: 0
[2023-06-30 22:19:31] [config] normalize-gradient: false
[2023-06-30 22:19:31] [config] num-devices: 0
[2023-06-30 22:19:31] [config] optimizer: adam
[2023-06-30 22:19:31] [config] optimizer-delay: 1
[2023-06-30 22:19:31] [config] optimizer-params:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] output-omit-bias: false
[2023-06-30 22:19:31] [config] overwrite: true
[2023-06-30 22:19:31] [config] precision:
[2023-06-30 22:19:31] [config]   - float32
[2023-06-30 22:19:31] [config]   - float32
[2023-06-30 22:19:31] [config] pretrained-model: ""
[2023-06-30 22:19:31] [config] quantize-biases: false
[2023-06-30 22:19:31] [config] quantize-bits: 0
[2023-06-30 22:19:31] [config] quantize-log-based: false
[2023-06-30 22:19:31] [config] quantize-optimization-steps: 0
[2023-06-30 22:19:31] [config] quiet: false
[2023-06-30 22:19:31] [config] quiet-translation: true
[2023-06-30 22:19:31] [config] relative-paths: false
[2023-06-30 22:19:31] [config] right-left: false
[2023-06-30 22:19:31] [config] save-freq: 10000u
[2023-06-30 22:19:31] [config] seed: 1234
[2023-06-30 22:19:31] [config] sentencepiece-alphas:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:19:31] [config] sentencepiece-options: ""
[2023-06-30 22:19:31] [config] sharding: global
[2023-06-30 22:19:31] [config] shuffle: data
[2023-06-30 22:19:31] [config] shuffle-in-ram: false
[2023-06-30 22:19:31] [config] sigterm: save-and-exit
[2023-06-30 22:19:31] [config] skip: false
[2023-06-30 22:19:31] [config] sqlite: ""
[2023-06-30 22:19:31] [config] sqlite-drop: false
[2023-06-30 22:19:31] [config] sync-freq: 200u
[2023-06-30 22:19:31] [config] sync-sgd: false
[2023-06-30 22:19:31] [config] tempdir: /tmp
[2023-06-30 22:19:31] [config] tied-embeddings: false
[2023-06-30 22:19:31] [config] tied-embeddings-all: false
[2023-06-30 22:19:31] [config] tied-embeddings-src: false
[2023-06-30 22:19:31] [config] train-embedder-rank:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] train-sets:
[2023-06-30 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:19:31] [config] transformer-aan-activation: swish
[2023-06-30 22:19:31] [config] transformer-aan-depth: 2
[2023-06-30 22:19:31] [config] transformer-aan-nogate: false
[2023-06-30 22:19:31] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:19:31] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:19:31] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:19:31] [config] transformer-depth-scaling: false
[2023-06-30 22:19:31] [config] transformer-dim-aan: 2048
[2023-06-30 22:19:31] [config] transformer-dim-ffn: 2048
[2023-06-30 22:19:31] [config] transformer-dropout: 0
[2023-06-30 22:19:31] [config] transformer-dropout-attention: 0
[2023-06-30 22:19:31] [config] transformer-dropout-ffn: 0
[2023-06-30 22:19:31] [config] transformer-ffn-activation: swish
[2023-06-30 22:19:31] [config] transformer-ffn-depth: 2
[2023-06-30 22:19:31] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:19:31] [config] transformer-heads: 8
[2023-06-30 22:19:31] [config] transformer-no-projection: false
[2023-06-30 22:19:31] [config] transformer-pool: false
[2023-06-30 22:19:31] [config] transformer-postprocess: dan
[2023-06-30 22:19:31] [config] transformer-postprocess-emb: d
[2023-06-30 22:19:31] [config] transformer-postprocess-top: ""
[2023-06-30 22:19:31] [config] transformer-preprocess: ""
[2023-06-30 22:19:31] [config] transformer-tied-layers:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] transformer-train-position-embeddings: false
[2023-06-30 22:19:31] [config] tsv: false
[2023-06-30 22:19:31] [config] tsv-fields: 0
[2023-06-30 22:19:31] [config] type: transformer
[2023-06-30 22:19:31] [config] ulr: false
[2023-06-30 22:19:31] [config] ulr-dim-emb: 0
[2023-06-30 22:19:31] [config] ulr-dropout: 0
[2023-06-30 22:19:31] [config] ulr-keys-vectors: ""
[2023-06-30 22:19:31] [config] ulr-query-vectors: ""
[2023-06-30 22:19:31] [config] ulr-softmax-temperature: 1
[2023-06-30 22:19:31] [config] ulr-trainable-transformation: false
[2023-06-30 22:19:31] [config] unlikelihood-loss: false
[2023-06-30 22:19:31] [config] valid-freq: 50000000
[2023-06-30 22:19:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:19:31] [config] valid-max-length: 1000
[2023-06-30 22:19:31] [config] valid-metrics:
[2023-06-30 22:19:31] [config]   - cross-entropy
[2023-06-30 22:19:31] [config]   - translation
[2023-06-30 22:19:31] [config] valid-mini-batch: 32
[2023-06-30 22:19:31] [config] valid-reset-stalled: false
[2023-06-30 22:19:31] [config] valid-script-args:
[2023-06-30 22:19:31] [config]   []
[2023-06-30 22:19:31] [config] valid-script-path: ""
[2023-06-30 22:19:31] [config] valid-sets:
[2023-06-30 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:19:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:19:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:19:31] [config] vocabs:
[2023-06-30 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:19:31] [config] word-penalty: 0
[2023-06-30 22:19:31] [config] word-scores: false
[2023-06-30 22:19:31] [config] workspace: 2048
[2023-06-30 22:19:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:19:32] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:19:32] [training] Using single-device training
[2023-06-30 22:19:32] Synced seed 1234
[2023-06-30 22:19:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:19:32] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:19:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:19:32] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:19:33] [valid] No post-processing script given for validating translator
[2023-06-30 22:19:33] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:19:34] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:19:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:19:34] [comm] Using global sharding
[2023-06-30 22:19:34] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:19:34] [training] Using 1 GPUs
[2023-06-30 22:19:34] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:19:36] Loading Adam parameters
[2023-06-30 22:19:36] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:19:36] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:19:36] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:19:36] [data] Restoring the corpus state to epoch 2, batch 297
[2023-06-30 22:19:36] [data] Shuffling data
[2023-06-30 22:19:36] [data] Done reading 20,192 sentences
[2023-06-30 22:19:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:19:36] Training started
[2023-06-30 22:19:36] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:19:36] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:19:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:19:39] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:19:39] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:19:55] Seen 18,843 samples
[2023-06-30 22:19:55] Starting data epoch 3 in logical epoch 3
[2023-06-30 22:19:55] [data] Shuffling data
[2023-06-30 22:19:55] [data] Done reading 20,192 sentences
[2023-06-30 22:19:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:20:12] Seen 18,843 samples
[2023-06-30 22:20:12] Starting data epoch 4 in logical epoch 4
[2023-06-30 22:20:12] [data] Shuffling data
[2023-06-30 22:20:12] [data] Done reading 20,192 sentences
[2023-06-30 22:20:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:20:18] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 5.39951372 * 1,343,216 @ 768 after 1,343,216 : Time 45.91s : 29256.07 words/s : gNorm 2.2512
[2023-06-30 22:20:29] Seen 18,843 samples
[2023-06-30 22:20:29] Starting data epoch 5 in logical epoch 5
[2023-06-30 22:20:29] [data] Shuffling data
[2023-06-30 22:20:29] [data] Done reading 20,192 sentences
[2023-06-30 22:20:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:20:46] Seen 18,843 samples
[2023-06-30 22:20:46] Starting data epoch 6 in logical epoch 6
[2023-06-30 22:20:46] [data] Shuffling data
[2023-06-30 22:20:46] [data] Done reading 20,192 sentences
[2023-06-30 22:20:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:21:02] Seen 18,843 samples
[2023-06-30 22:21:02] Starting data epoch 7 in logical epoch 7
[2023-06-30 22:21:02] [data] Shuffling data
[2023-06-30 22:21:02] [data] Done reading 20,192 sentences
[2023-06-30 22:21:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:21:14] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 3.33698583 * 1,334,929 @ 2,976 after 2,678,145 : Time 56.05s : 23817.14 words/s : gNorm 2.7515
[2023-06-30 22:21:19] Seen 18,843 samples
[2023-06-30 22:21:19] Starting data epoch 8 in logical epoch 8
[2023-06-30 22:21:19] [data] Shuffling data
[2023-06-30 22:21:19] [data] Done reading 20,192 sentences
[2023-06-30 22:21:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:21:36] Seen 18,843 samples
[2023-06-30 22:21:36] Starting data epoch 9 in logical epoch 9
[2023-06-30 22:21:36] [data] Shuffling data
[2023-06-30 22:21:36] [data] Done reading 20,192 sentences
[2023-06-30 22:21:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:21:54] Seen 18,843 samples
[2023-06-30 22:21:54] Starting data epoch 10 in logical epoch 10
[2023-06-30 22:21:54] [data] Shuffling data
[2023-06-30 22:21:54] [data] Done reading 20,192 sentences
[2023-06-30 22:21:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:22:13] Seen 18,843 samples
[2023-06-30 22:22:13] Starting data epoch 11 in logical epoch 11
[2023-06-30 22:22:13] Training finished
[2023-06-30 22:22:15] [valid] Ep. 11 : Up. 2968 : cross-entropy : 125.788 : stalled 1 times (last best: 118.152)
[2023-06-30 22:24:27] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-06-30 22:24:27] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:24:30] Saving Adam parameters
[2023-06-30 22:24:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:24:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:24:41] [marian] Running on node20.datos.cluster.uy as process 1473 with command line:
[2023-06-30 22:24:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:24:42] [config] after: 0e
[2023-06-30 22:24:42] [config] after-batches: 0
[2023-06-30 22:24:42] [config] after-epochs: 20
[2023-06-30 22:24:42] [config] all-caps-every: 0
[2023-06-30 22:24:42] [config] allow-unk: false
[2023-06-30 22:24:42] [config] authors: false
[2023-06-30 22:24:42] [config] beam-size: 12
[2023-06-30 22:24:42] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:24:42] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:24:42] [config] bert-masking-fraction: 0.15
[2023-06-30 22:24:42] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:24:42] [config] bert-train-type-embeddings: true
[2023-06-30 22:24:42] [config] bert-type-vocab-size: 2
[2023-06-30 22:24:42] [config] build-info: ""
[2023-06-30 22:24:42] [config] check-gradient-nan: false
[2023-06-30 22:24:42] [config] check-nan: false
[2023-06-30 22:24:42] [config] cite: false
[2023-06-30 22:24:42] [config] clip-norm: 1
[2023-06-30 22:24:42] [config] cost-scaling:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] cost-type: ce-sum
[2023-06-30 22:24:42] [config] cpu-threads: 0
[2023-06-30 22:24:42] [config] data-threads: 8
[2023-06-30 22:24:42] [config] data-weighting: ""
[2023-06-30 22:24:42] [config] data-weighting-type: sentence
[2023-06-30 22:24:42] [config] dec-cell: gru
[2023-06-30 22:24:42] [config] dec-cell-base-depth: 2
[2023-06-30 22:24:42] [config] dec-cell-high-depth: 1
[2023-06-30 22:24:42] [config] dec-depth: 1
[2023-06-30 22:24:42] [config] devices:
[2023-06-30 22:24:42] [config]   - 0
[2023-06-30 22:24:42] [config] dim-emb: 512
[2023-06-30 22:24:42] [config] dim-rnn: 1024
[2023-06-30 22:24:42] [config] dim-vocabs:
[2023-06-30 22:24:42] [config]   - 54042
[2023-06-30 22:24:42] [config]   - 36507
[2023-06-30 22:24:42] [config] disp-first: 0
[2023-06-30 22:24:42] [config] disp-freq: 1000u
[2023-06-30 22:24:42] [config] disp-label-counts: true
[2023-06-30 22:24:42] [config] dropout-rnn: 0
[2023-06-30 22:24:42] [config] dropout-src: 0
[2023-06-30 22:24:42] [config] dropout-trg: 0
[2023-06-30 22:24:42] [config] dump-config: ""
[2023-06-30 22:24:42] [config] dynamic-gradient-scaling:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] early-stopping: 10
[2023-06-30 22:24:42] [config] early-stopping-on: first
[2023-06-30 22:24:42] [config] embedding-fix-src: false
[2023-06-30 22:24:42] [config] embedding-fix-trg: false
[2023-06-30 22:24:42] [config] embedding-normalization: false
[2023-06-30 22:24:42] [config] embedding-vectors:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] enc-cell: gru
[2023-06-30 22:24:42] [config] enc-cell-depth: 1
[2023-06-30 22:24:42] [config] enc-depth: 1
[2023-06-30 22:24:42] [config] enc-type: bidirectional
[2023-06-30 22:24:42] [config] english-title-case-every: 0
[2023-06-30 22:24:42] [config] exponential-smoothing: 0
[2023-06-30 22:24:42] [config] factor-weight: 1
[2023-06-30 22:24:42] [config] factors-combine: sum
[2023-06-30 22:24:42] [config] factors-dim-emb: 0
[2023-06-30 22:24:42] [config] gradient-checkpointing: false
[2023-06-30 22:24:42] [config] gradient-norm-average-window: 100
[2023-06-30 22:24:42] [config] guided-alignment: none
[2023-06-30 22:24:42] [config] guided-alignment-cost: mse
[2023-06-30 22:24:42] [config] guided-alignment-weight: 0.1
[2023-06-30 22:24:42] [config] ignore-model-config: false
[2023-06-30 22:24:42] [config] input-types:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] interpolate-env-vars: false
[2023-06-30 22:24:42] [config] keep-best: false
[2023-06-30 22:24:42] [config] label-smoothing: 0
[2023-06-30 22:24:42] [config] layer-normalization: false
[2023-06-30 22:24:42] [config] learn-rate: 0.0001
[2023-06-30 22:24:42] [config] lemma-dependency: ""
[2023-06-30 22:24:42] [config] lemma-dim-emb: 0
[2023-06-30 22:24:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:24:42] [config] log-level: info
[2023-06-30 22:24:42] [config] log-time-zone: ""
[2023-06-30 22:24:42] [config] logical-epoch:
[2023-06-30 22:24:42] [config]   - 1e
[2023-06-30 22:24:42] [config]   - 0
[2023-06-30 22:24:42] [config] lr-decay: 0
[2023-06-30 22:24:42] [config] lr-decay-freq: 50000
[2023-06-30 22:24:42] [config] lr-decay-inv-sqrt:
[2023-06-30 22:24:42] [config]   - 0
[2023-06-30 22:24:42] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:24:42] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:24:42] [config] lr-decay-start:
[2023-06-30 22:24:42] [config]   - 10
[2023-06-30 22:24:42] [config]   - 1
[2023-06-30 22:24:42] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:24:42] [config] lr-report: false
[2023-06-30 22:24:42] [config] lr-warmup: 0
[2023-06-30 22:24:42] [config] lr-warmup-at-reload: false
[2023-06-30 22:24:42] [config] lr-warmup-cycle: false
[2023-06-30 22:24:42] [config] lr-warmup-start-rate: 0
[2023-06-30 22:24:42] [config] max-length: 50
[2023-06-30 22:24:42] [config] max-length-crop: false
[2023-06-30 22:24:42] [config] max-length-factor: 3
[2023-06-30 22:24:42] [config] maxi-batch: 100
[2023-06-30 22:24:42] [config] maxi-batch-sort: trg
[2023-06-30 22:24:42] [config] mini-batch: 64
[2023-06-30 22:24:42] [config] mini-batch-fit: false
[2023-06-30 22:24:42] [config] mini-batch-fit-step: 10
[2023-06-30 22:24:42] [config] mini-batch-round-up: true
[2023-06-30 22:24:42] [config] mini-batch-track-lr: false
[2023-06-30 22:24:42] [config] mini-batch-warmup: 0
[2023-06-30 22:24:42] [config] mini-batch-words: 0
[2023-06-30 22:24:42] [config] mini-batch-words-ref: 0
[2023-06-30 22:24:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:24:42] [config] multi-loss-type: sum
[2023-06-30 22:24:42] [config] n-best: false
[2023-06-30 22:24:42] [config] no-nccl: false
[2023-06-30 22:24:42] [config] no-reload: false
[2023-06-30 22:24:42] [config] no-restore-corpus: false
[2023-06-30 22:24:42] [config] normalize: 0
[2023-06-30 22:24:42] [config] normalize-gradient: false
[2023-06-30 22:24:42] [config] num-devices: 0
[2023-06-30 22:24:42] [config] optimizer: adam
[2023-06-30 22:24:42] [config] optimizer-delay: 1
[2023-06-30 22:24:42] [config] optimizer-params:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] output-omit-bias: false
[2023-06-30 22:24:42] [config] overwrite: true
[2023-06-30 22:24:42] [config] precision:
[2023-06-30 22:24:42] [config]   - float32
[2023-06-30 22:24:42] [config]   - float32
[2023-06-30 22:24:42] [config] pretrained-model: ""
[2023-06-30 22:24:42] [config] quantize-biases: false
[2023-06-30 22:24:42] [config] quantize-bits: 0
[2023-06-30 22:24:42] [config] quantize-log-based: false
[2023-06-30 22:24:42] [config] quantize-optimization-steps: 0
[2023-06-30 22:24:42] [config] quiet: false
[2023-06-30 22:24:42] [config] quiet-translation: true
[2023-06-30 22:24:42] [config] relative-paths: false
[2023-06-30 22:24:42] [config] right-left: false
[2023-06-30 22:24:42] [config] save-freq: 10000u
[2023-06-30 22:24:42] [config] seed: 1234
[2023-06-30 22:24:42] [config] sentencepiece-alphas:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:24:42] [config] sentencepiece-options: ""
[2023-06-30 22:24:42] [config] sharding: global
[2023-06-30 22:24:42] [config] shuffle: data
[2023-06-30 22:24:42] [config] shuffle-in-ram: false
[2023-06-30 22:24:42] [config] sigterm: save-and-exit
[2023-06-30 22:24:42] [config] skip: false
[2023-06-30 22:24:42] [config] sqlite: ""
[2023-06-30 22:24:42] [config] sqlite-drop: false
[2023-06-30 22:24:42] [config] sync-freq: 200u
[2023-06-30 22:24:42] [config] sync-sgd: false
[2023-06-30 22:24:42] [config] tempdir: /tmp
[2023-06-30 22:24:42] [config] tied-embeddings: false
[2023-06-30 22:24:42] [config] tied-embeddings-all: false
[2023-06-30 22:24:42] [config] tied-embeddings-src: false
[2023-06-30 22:24:42] [config] train-embedder-rank:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] train-sets:
[2023-06-30 22:24:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:24:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:24:42] [config] transformer-aan-activation: swish
[2023-06-30 22:24:42] [config] transformer-aan-depth: 2
[2023-06-30 22:24:42] [config] transformer-aan-nogate: false
[2023-06-30 22:24:42] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:24:42] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:24:42] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:24:42] [config] transformer-depth-scaling: false
[2023-06-30 22:24:42] [config] transformer-dim-aan: 2048
[2023-06-30 22:24:42] [config] transformer-dim-ffn: 2048
[2023-06-30 22:24:42] [config] transformer-dropout: 0
[2023-06-30 22:24:42] [config] transformer-dropout-attention: 0
[2023-06-30 22:24:42] [config] transformer-dropout-ffn: 0
[2023-06-30 22:24:42] [config] transformer-ffn-activation: swish
[2023-06-30 22:24:42] [config] transformer-ffn-depth: 2
[2023-06-30 22:24:42] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:24:42] [config] transformer-heads: 8
[2023-06-30 22:24:42] [config] transformer-no-projection: false
[2023-06-30 22:24:42] [config] transformer-pool: false
[2023-06-30 22:24:42] [config] transformer-postprocess: dan
[2023-06-30 22:24:42] [config] transformer-postprocess-emb: d
[2023-06-30 22:24:42] [config] transformer-postprocess-top: ""
[2023-06-30 22:24:42] [config] transformer-preprocess: ""
[2023-06-30 22:24:42] [config] transformer-tied-layers:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] transformer-train-position-embeddings: false
[2023-06-30 22:24:42] [config] tsv: false
[2023-06-30 22:24:42] [config] tsv-fields: 0
[2023-06-30 22:24:42] [config] type: transformer
[2023-06-30 22:24:42] [config] ulr: false
[2023-06-30 22:24:42] [config] ulr-dim-emb: 0
[2023-06-30 22:24:42] [config] ulr-dropout: 0
[2023-06-30 22:24:42] [config] ulr-keys-vectors: ""
[2023-06-30 22:24:42] [config] ulr-query-vectors: ""
[2023-06-30 22:24:42] [config] ulr-softmax-temperature: 1
[2023-06-30 22:24:42] [config] ulr-trainable-transformation: false
[2023-06-30 22:24:42] [config] unlikelihood-loss: false
[2023-06-30 22:24:42] [config] valid-freq: 50000000
[2023-06-30 22:24:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:24:42] [config] valid-max-length: 1000
[2023-06-30 22:24:42] [config] valid-metrics:
[2023-06-30 22:24:42] [config]   - cross-entropy
[2023-06-30 22:24:42] [config]   - translation
[2023-06-30 22:24:42] [config] valid-mini-batch: 32
[2023-06-30 22:24:42] [config] valid-reset-stalled: false
[2023-06-30 22:24:42] [config] valid-script-args:
[2023-06-30 22:24:42] [config]   []
[2023-06-30 22:24:42] [config] valid-script-path: ""
[2023-06-30 22:24:42] [config] valid-sets:
[2023-06-30 22:24:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:24:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:24:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:24:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:24:42] [config] vocabs:
[2023-06-30 22:24:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:24:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:24:42] [config] word-penalty: 0
[2023-06-30 22:24:42] [config] word-scores: false
[2023-06-30 22:24:42] [config] workspace: 2048
[2023-06-30 22:24:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:24:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:24:42] [training] Using single-device training
[2023-06-30 22:24:42] Synced seed 1234
[2023-06-30 22:24:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:24:42] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:24:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:24:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:24:42] [valid] No post-processing script given for validating translator
[2023-06-30 22:24:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:24:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:24:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:24:43] [comm] Using global sharding
[2023-06-30 22:24:43] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:24:43] [training] Using 1 GPUs
[2023-06-30 22:24:43] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:24:45] Loading Adam parameters
[2023-06-30 22:24:45] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:24:45] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:24:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:24:45] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-06-30 22:24:45] [data] Shuffling data
[2023-06-30 22:24:45] [data] Done reading 20,192 sentences
[2023-06-30 22:24:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:24:45] Training started
[2023-06-30 22:24:45] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:24:45] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:24:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:24:45] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:24:45] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:24:47] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 1.78810847 * 1,343,919 @ 1,536 after 4,022,064 : Time 5.34s : 251584.80 words/s : gNorm 2.0332
[2023-06-30 22:25:02] Seen 18,843 samples
[2023-06-30 22:25:02] Starting data epoch 12 in logical epoch 12
[2023-06-30 22:25:02] [data] Shuffling data
[2023-06-30 22:25:02] [data] Done reading 20,192 sentences
[2023-06-30 22:25:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:25:20] Seen 18,843 samples
[2023-06-30 22:25:20] Starting data epoch 13 in logical epoch 13
[2023-06-30 22:25:20] [data] Shuffling data
[2023-06-30 22:25:20] [data] Done reading 20,192 sentences
[2023-06-30 22:25:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:25:39] Seen 18,843 samples
[2023-06-30 22:25:39] Starting data epoch 14 in logical epoch 14
[2023-06-30 22:25:39] [data] Shuffling data
[2023-06-30 22:25:39] [data] Done reading 20,192 sentences
[2023-06-30 22:25:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:25:49] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 0.76778746 * 1,354,393 @ 2,176 after 5,376,457 : Time 61.79s : 21920.59 words/s : gNorm 1.5287
[2023-06-30 22:25:58] Seen 18,843 samples
[2023-06-30 22:25:58] Starting data epoch 15 in logical epoch 15
[2023-06-30 22:25:58] [data] Shuffling data
[2023-06-30 22:25:58] [data] Done reading 20,192 sentences
[2023-06-30 22:25:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:26:18] Seen 18,843 samples
[2023-06-30 22:26:18] Starting data epoch 16 in logical epoch 16
[2023-06-30 22:26:18] [data] Shuffling data
[2023-06-30 22:26:18] [data] Done reading 20,192 sentences
[2023-06-30 22:26:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:26:37] Seen 18,843 samples
[2023-06-30 22:26:37] Starting data epoch 17 in logical epoch 17
[2023-06-30 22:26:37] [data] Shuffling data
[2023-06-30 22:26:37] [data] Done reading 20,192 sentences
[2023-06-30 22:26:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:26:54] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 0.26950222 * 1,331,522 @ 1,216 after 6,707,979 : Time 64.90s : 20517.25 words/s : gNorm 1.2692
[2023-06-30 22:26:57] Seen 18,843 samples
[2023-06-30 22:26:57] Starting data epoch 18 in logical epoch 18
[2023-06-30 22:26:57] [data] Shuffling data
[2023-06-30 22:26:57] [data] Done reading 20,192 sentences
[2023-06-30 22:26:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:27:16] Seen 18,843 samples
[2023-06-30 22:27:16] Starting data epoch 19 in logical epoch 19
[2023-06-30 22:27:16] [data] Shuffling data
[2023-06-30 22:27:16] [data] Done reading 20,192 sentences
[2023-06-30 22:27:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:27:35] Seen 18,843 samples
[2023-06-30 22:27:35] Starting data epoch 20 in logical epoch 20
[2023-06-30 22:27:35] [data] Shuffling data
[2023-06-30 22:27:35] [data] Done reading 20,192 sentences
[2023-06-30 22:27:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:27:54] Seen 18,843 samples
[2023-06-30 22:27:54] Starting data epoch 21 in logical epoch 21
[2023-06-30 22:27:54] Training finished
[2023-06-30 22:27:57] [valid] Ep. 21 : Up. 5933 : cross-entropy : 154.376 : stalled 2 times (last best: 118.152)
[2023-06-30 22:30:03] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-06-30 22:30:03] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:30:07] Saving Adam parameters
[2023-06-30 22:30:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:30:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:30:19] [marian] Running on node20.datos.cluster.uy as process 1838 with command line:
[2023-06-30 22:30:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:30:20] [config] after: 0e
[2023-06-30 22:30:20] [config] after-batches: 0
[2023-06-30 22:30:20] [config] after-epochs: 30
[2023-06-30 22:30:20] [config] all-caps-every: 0
[2023-06-30 22:30:20] [config] allow-unk: false
[2023-06-30 22:30:20] [config] authors: false
[2023-06-30 22:30:20] [config] beam-size: 12
[2023-06-30 22:30:20] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:30:20] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:30:20] [config] bert-masking-fraction: 0.15
[2023-06-30 22:30:20] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:30:20] [config] bert-train-type-embeddings: true
[2023-06-30 22:30:20] [config] bert-type-vocab-size: 2
[2023-06-30 22:30:20] [config] build-info: ""
[2023-06-30 22:30:20] [config] check-gradient-nan: false
[2023-06-30 22:30:20] [config] check-nan: false
[2023-06-30 22:30:20] [config] cite: false
[2023-06-30 22:30:20] [config] clip-norm: 1
[2023-06-30 22:30:20] [config] cost-scaling:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] cost-type: ce-sum
[2023-06-30 22:30:20] [config] cpu-threads: 0
[2023-06-30 22:30:20] [config] data-threads: 8
[2023-06-30 22:30:20] [config] data-weighting: ""
[2023-06-30 22:30:20] [config] data-weighting-type: sentence
[2023-06-30 22:30:20] [config] dec-cell: gru
[2023-06-30 22:30:20] [config] dec-cell-base-depth: 2
[2023-06-30 22:30:20] [config] dec-cell-high-depth: 1
[2023-06-30 22:30:20] [config] dec-depth: 1
[2023-06-30 22:30:20] [config] devices:
[2023-06-30 22:30:20] [config]   - 0
[2023-06-30 22:30:20] [config] dim-emb: 512
[2023-06-30 22:30:20] [config] dim-rnn: 1024
[2023-06-30 22:30:20] [config] dim-vocabs:
[2023-06-30 22:30:20] [config]   - 54042
[2023-06-30 22:30:20] [config]   - 36507
[2023-06-30 22:30:20] [config] disp-first: 0
[2023-06-30 22:30:20] [config] disp-freq: 1000u
[2023-06-30 22:30:20] [config] disp-label-counts: true
[2023-06-30 22:30:20] [config] dropout-rnn: 0
[2023-06-30 22:30:20] [config] dropout-src: 0
[2023-06-30 22:30:20] [config] dropout-trg: 0
[2023-06-30 22:30:20] [config] dump-config: ""
[2023-06-30 22:30:20] [config] dynamic-gradient-scaling:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] early-stopping: 10
[2023-06-30 22:30:20] [config] early-stopping-on: first
[2023-06-30 22:30:20] [config] embedding-fix-src: false
[2023-06-30 22:30:20] [config] embedding-fix-trg: false
[2023-06-30 22:30:20] [config] embedding-normalization: false
[2023-06-30 22:30:20] [config] embedding-vectors:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] enc-cell: gru
[2023-06-30 22:30:20] [config] enc-cell-depth: 1
[2023-06-30 22:30:20] [config] enc-depth: 1
[2023-06-30 22:30:20] [config] enc-type: bidirectional
[2023-06-30 22:30:20] [config] english-title-case-every: 0
[2023-06-30 22:30:20] [config] exponential-smoothing: 0
[2023-06-30 22:30:20] [config] factor-weight: 1
[2023-06-30 22:30:20] [config] factors-combine: sum
[2023-06-30 22:30:20] [config] factors-dim-emb: 0
[2023-06-30 22:30:20] [config] gradient-checkpointing: false
[2023-06-30 22:30:20] [config] gradient-norm-average-window: 100
[2023-06-30 22:30:20] [config] guided-alignment: none
[2023-06-30 22:30:20] [config] guided-alignment-cost: mse
[2023-06-30 22:30:20] [config] guided-alignment-weight: 0.1
[2023-06-30 22:30:20] [config] ignore-model-config: false
[2023-06-30 22:30:20] [config] input-types:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] interpolate-env-vars: false
[2023-06-30 22:30:20] [config] keep-best: false
[2023-06-30 22:30:20] [config] label-smoothing: 0
[2023-06-30 22:30:20] [config] layer-normalization: false
[2023-06-30 22:30:20] [config] learn-rate: 0.0001
[2023-06-30 22:30:20] [config] lemma-dependency: ""
[2023-06-30 22:30:20] [config] lemma-dim-emb: 0
[2023-06-30 22:30:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:30:20] [config] log-level: info
[2023-06-30 22:30:20] [config] log-time-zone: ""
[2023-06-30 22:30:20] [config] logical-epoch:
[2023-06-30 22:30:20] [config]   - 1e
[2023-06-30 22:30:20] [config]   - 0
[2023-06-30 22:30:20] [config] lr-decay: 0
[2023-06-30 22:30:20] [config] lr-decay-freq: 50000
[2023-06-30 22:30:20] [config] lr-decay-inv-sqrt:
[2023-06-30 22:30:20] [config]   - 0
[2023-06-30 22:30:20] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:30:20] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:30:20] [config] lr-decay-start:
[2023-06-30 22:30:20] [config]   - 10
[2023-06-30 22:30:20] [config]   - 1
[2023-06-30 22:30:20] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:30:20] [config] lr-report: false
[2023-06-30 22:30:20] [config] lr-warmup: 0
[2023-06-30 22:30:20] [config] lr-warmup-at-reload: false
[2023-06-30 22:30:20] [config] lr-warmup-cycle: false
[2023-06-30 22:30:20] [config] lr-warmup-start-rate: 0
[2023-06-30 22:30:20] [config] max-length: 50
[2023-06-30 22:30:20] [config] max-length-crop: false
[2023-06-30 22:30:20] [config] max-length-factor: 3
[2023-06-30 22:30:20] [config] maxi-batch: 100
[2023-06-30 22:30:20] [config] maxi-batch-sort: trg
[2023-06-30 22:30:20] [config] mini-batch: 64
[2023-06-30 22:30:20] [config] mini-batch-fit: false
[2023-06-30 22:30:20] [config] mini-batch-fit-step: 10
[2023-06-30 22:30:20] [config] mini-batch-round-up: true
[2023-06-30 22:30:20] [config] mini-batch-track-lr: false
[2023-06-30 22:30:20] [config] mini-batch-warmup: 0
[2023-06-30 22:30:20] [config] mini-batch-words: 0
[2023-06-30 22:30:20] [config] mini-batch-words-ref: 0
[2023-06-30 22:30:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:30:20] [config] multi-loss-type: sum
[2023-06-30 22:30:20] [config] n-best: false
[2023-06-30 22:30:20] [config] no-nccl: false
[2023-06-30 22:30:20] [config] no-reload: false
[2023-06-30 22:30:20] [config] no-restore-corpus: false
[2023-06-30 22:30:20] [config] normalize: 0
[2023-06-30 22:30:20] [config] normalize-gradient: false
[2023-06-30 22:30:20] [config] num-devices: 0
[2023-06-30 22:30:20] [config] optimizer: adam
[2023-06-30 22:30:20] [config] optimizer-delay: 1
[2023-06-30 22:30:20] [config] optimizer-params:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] output-omit-bias: false
[2023-06-30 22:30:20] [config] overwrite: true
[2023-06-30 22:30:20] [config] precision:
[2023-06-30 22:30:20] [config]   - float32
[2023-06-30 22:30:20] [config]   - float32
[2023-06-30 22:30:20] [config] pretrained-model: ""
[2023-06-30 22:30:20] [config] quantize-biases: false
[2023-06-30 22:30:20] [config] quantize-bits: 0
[2023-06-30 22:30:20] [config] quantize-log-based: false
[2023-06-30 22:30:20] [config] quantize-optimization-steps: 0
[2023-06-30 22:30:20] [config] quiet: false
[2023-06-30 22:30:20] [config] quiet-translation: true
[2023-06-30 22:30:20] [config] relative-paths: false
[2023-06-30 22:30:20] [config] right-left: false
[2023-06-30 22:30:20] [config] save-freq: 10000u
[2023-06-30 22:30:20] [config] seed: 1234
[2023-06-30 22:30:20] [config] sentencepiece-alphas:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:30:20] [config] sentencepiece-options: ""
[2023-06-30 22:30:20] [config] sharding: global
[2023-06-30 22:30:20] [config] shuffle: data
[2023-06-30 22:30:20] [config] shuffle-in-ram: false
[2023-06-30 22:30:20] [config] sigterm: save-and-exit
[2023-06-30 22:30:20] [config] skip: false
[2023-06-30 22:30:20] [config] sqlite: ""
[2023-06-30 22:30:20] [config] sqlite-drop: false
[2023-06-30 22:30:20] [config] sync-freq: 200u
[2023-06-30 22:30:20] [config] sync-sgd: false
[2023-06-30 22:30:20] [config] tempdir: /tmp
[2023-06-30 22:30:20] [config] tied-embeddings: false
[2023-06-30 22:30:20] [config] tied-embeddings-all: false
[2023-06-30 22:30:20] [config] tied-embeddings-src: false
[2023-06-30 22:30:20] [config] train-embedder-rank:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] train-sets:
[2023-06-30 22:30:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:30:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:30:20] [config] transformer-aan-activation: swish
[2023-06-30 22:30:20] [config] transformer-aan-depth: 2
[2023-06-30 22:30:20] [config] transformer-aan-nogate: false
[2023-06-30 22:30:20] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:30:20] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:30:20] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:30:20] [config] transformer-depth-scaling: false
[2023-06-30 22:30:20] [config] transformer-dim-aan: 2048
[2023-06-30 22:30:20] [config] transformer-dim-ffn: 2048
[2023-06-30 22:30:20] [config] transformer-dropout: 0
[2023-06-30 22:30:20] [config] transformer-dropout-attention: 0
[2023-06-30 22:30:20] [config] transformer-dropout-ffn: 0
[2023-06-30 22:30:20] [config] transformer-ffn-activation: swish
[2023-06-30 22:30:20] [config] transformer-ffn-depth: 2
[2023-06-30 22:30:20] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:30:20] [config] transformer-heads: 8
[2023-06-30 22:30:20] [config] transformer-no-projection: false
[2023-06-30 22:30:20] [config] transformer-pool: false
[2023-06-30 22:30:20] [config] transformer-postprocess: dan
[2023-06-30 22:30:20] [config] transformer-postprocess-emb: d
[2023-06-30 22:30:20] [config] transformer-postprocess-top: ""
[2023-06-30 22:30:20] [config] transformer-preprocess: ""
[2023-06-30 22:30:20] [config] transformer-tied-layers:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] transformer-train-position-embeddings: false
[2023-06-30 22:30:20] [config] tsv: false
[2023-06-30 22:30:20] [config] tsv-fields: 0
[2023-06-30 22:30:20] [config] type: transformer
[2023-06-30 22:30:20] [config] ulr: false
[2023-06-30 22:30:20] [config] ulr-dim-emb: 0
[2023-06-30 22:30:20] [config] ulr-dropout: 0
[2023-06-30 22:30:20] [config] ulr-keys-vectors: ""
[2023-06-30 22:30:20] [config] ulr-query-vectors: ""
[2023-06-30 22:30:20] [config] ulr-softmax-temperature: 1
[2023-06-30 22:30:20] [config] ulr-trainable-transformation: false
[2023-06-30 22:30:20] [config] unlikelihood-loss: false
[2023-06-30 22:30:20] [config] valid-freq: 50000000
[2023-06-30 22:30:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:30:20] [config] valid-max-length: 1000
[2023-06-30 22:30:20] [config] valid-metrics:
[2023-06-30 22:30:20] [config]   - cross-entropy
[2023-06-30 22:30:20] [config]   - translation
[2023-06-30 22:30:20] [config] valid-mini-batch: 32
[2023-06-30 22:30:20] [config] valid-reset-stalled: false
[2023-06-30 22:30:20] [config] valid-script-args:
[2023-06-30 22:30:20] [config]   []
[2023-06-30 22:30:20] [config] valid-script-path: ""
[2023-06-30 22:30:20] [config] valid-sets:
[2023-06-30 22:30:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:30:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:30:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:30:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:30:20] [config] vocabs:
[2023-06-30 22:30:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:30:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:30:20] [config] word-penalty: 0
[2023-06-30 22:30:20] [config] word-scores: false
[2023-06-30 22:30:20] [config] workspace: 2048
[2023-06-30 22:30:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:30:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:30:20] [training] Using single-device training
[2023-06-30 22:30:20] Synced seed 1234
[2023-06-30 22:30:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:30:20] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:30:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:30:20] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:30:20] [valid] No post-processing script given for validating translator
[2023-06-30 22:30:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:30:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:30:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:30:21] [comm] Using global sharding
[2023-06-30 22:30:21] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:30:21] [training] Using 1 GPUs
[2023-06-30 22:30:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:30:23] Loading Adam parameters
[2023-06-30 22:30:23] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:30:23] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:30:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:30:23] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-06-30 22:30:23] [data] Shuffling data
[2023-06-30 22:30:23] [data] Done reading 20,192 sentences
[2023-06-30 22:30:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:30:23] Training started
[2023-06-30 22:30:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:30:23] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:30:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:30:24] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:30:24] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:30:28] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 0.10421675 * 1,344,567 @ 1,231 after 8,052,546 : Time 7.59s : 177199.83 words/s : gNorm 1.0064
[2023-06-30 22:30:40] Seen 18,843 samples
[2023-06-30 22:30:40] Starting data epoch 22 in logical epoch 22
[2023-06-30 22:30:40] [data] Shuffling data
[2023-06-30 22:30:40] [data] Done reading 20,192 sentences
[2023-06-30 22:30:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:30:58] Seen 18,843 samples
[2023-06-30 22:30:58] Starting data epoch 23 in logical epoch 23
[2023-06-30 22:30:58] [data] Shuffling data
[2023-06-30 22:30:58] [data] Done reading 20,192 sentences
[2023-06-30 22:30:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:31:17] Seen 18,843 samples
[2023-06-30 22:31:17] Starting data epoch 24 in logical epoch 24
[2023-06-30 22:31:17] [data] Shuffling data
[2023-06-30 22:31:17] [data] Done reading 20,192 sentences
[2023-06-30 22:31:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:31:29] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 0.05569518 * 1,339,673 @ 704 after 9,392,219 : Time 61.68s : 21719.18 words/s : gNorm 0.8851
[2023-06-30 22:31:37] Seen 18,843 samples
[2023-06-30 22:31:37] Starting data epoch 25 in logical epoch 25
[2023-06-30 22:31:37] [data] Shuffling data
[2023-06-30 22:31:37] [data] Done reading 20,192 sentences
[2023-06-30 22:31:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:31:56] Seen 18,843 samples
[2023-06-30 22:31:56] Starting data epoch 26 in logical epoch 26
[2023-06-30 22:31:56] [data] Shuffling data
[2023-06-30 22:31:56] [data] Done reading 20,192 sentences
[2023-06-30 22:31:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:32:16] Seen 18,843 samples
[2023-06-30 22:32:16] Starting data epoch 27 in logical epoch 27
[2023-06-30 22:32:16] [data] Shuffling data
[2023-06-30 22:32:16] [data] Done reading 20,192 sentences
[2023-06-30 22:32:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:32:34] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 0.03844960 * 1,339,074 @ 1,034 after 10,731,293 : Time 65.24s : 20526.90 words/s : gNorm 0.7950
[2023-06-30 22:32:35] Seen 18,843 samples
[2023-06-30 22:32:35] Starting data epoch 28 in logical epoch 28
[2023-06-30 22:32:35] [data] Shuffling data
[2023-06-30 22:32:35] [data] Done reading 20,192 sentences
[2023-06-30 22:32:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:32:54] Seen 18,843 samples
[2023-06-30 22:32:54] Starting data epoch 29 in logical epoch 29
[2023-06-30 22:32:54] [data] Shuffling data
[2023-06-30 22:32:54] [data] Done reading 20,192 sentences
[2023-06-30 22:32:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:33:13] Seen 18,843 samples
[2023-06-30 22:33:13] Starting data epoch 30 in logical epoch 30
[2023-06-30 22:33:13] [data] Shuffling data
[2023-06-30 22:33:13] [data] Done reading 20,192 sentences
[2023-06-30 22:33:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:33:33] Seen 18,843 samples
[2023-06-30 22:33:33] Starting data epoch 31 in logical epoch 31
[2023-06-30 22:33:33] Training finished
[2023-06-30 22:33:35] [valid] Ep. 31 : Up. 8898 : cross-entropy : 169.777 : stalled 3 times (last best: 118.152)
[2023-06-30 22:34:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:34:03] [marian] Running on node23.datos.cluster.uy as process 34241 with command line:
[2023-06-30 22:34:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_bp16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_bp16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:34:03] [config] after: 0e
[2023-06-30 22:34:03] [config] after-batches: 0
[2023-06-30 22:34:03] [config] after-epochs: 1
[2023-06-30 22:34:03] [config] all-caps-every: 0
[2023-06-30 22:34:03] [config] allow-unk: false
[2023-06-30 22:34:03] [config] authors: false
[2023-06-30 22:34:03] [config] beam-size: 12
[2023-06-30 22:34:03] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:34:03] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:34:03] [config] bert-masking-fraction: 0.15
[2023-06-30 22:34:03] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:34:03] [config] bert-train-type-embeddings: true
[2023-06-30 22:34:03] [config] bert-type-vocab-size: 2
[2023-06-30 22:34:03] [config] build-info: ""
[2023-06-30 22:34:03] [config] check-gradient-nan: false
[2023-06-30 22:34:03] [config] check-nan: false
[2023-06-30 22:34:03] [config] cite: false
[2023-06-30 22:34:03] [config] clip-norm: 5
[2023-06-30 22:34:03] [config] cost-scaling:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] cost-type: ce-sum
[2023-06-30 22:34:03] [config] cpu-threads: 0
[2023-06-30 22:34:03] [config] data-threads: 8
[2023-06-30 22:34:03] [config] data-weighting: ""
[2023-06-30 22:34:03] [config] data-weighting-type: sentence
[2023-06-30 22:34:03] [config] dec-cell: gru
[2023-06-30 22:34:03] [config] dec-cell-base-depth: 2
[2023-06-30 22:34:03] [config] dec-cell-high-depth: 1
[2023-06-30 22:34:03] [config] dec-depth: 1
[2023-06-30 22:34:03] [config] devices:
[2023-06-30 22:34:03] [config]   - 0
[2023-06-30 22:34:03] [config] dim-emb: 512
[2023-06-30 22:34:03] [config] dim-rnn: 1024
[2023-06-30 22:34:03] [config] dim-vocabs:
[2023-06-30 22:34:03] [config]   - 54042
[2023-06-30 22:34:03] [config]   - 36507
[2023-06-30 22:34:03] [config] disp-first: 0
[2023-06-30 22:34:03] [config] disp-freq: 1000u
[2023-06-30 22:34:03] [config] disp-label-counts: true
[2023-06-30 22:34:03] [config] dropout-rnn: 0
[2023-06-30 22:34:03] [config] dropout-src: 0
[2023-06-30 22:34:03] [config] dropout-trg: 0
[2023-06-30 22:34:03] [config] dump-config: ""
[2023-06-30 22:34:03] [config] dynamic-gradient-scaling:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] early-stopping: 10
[2023-06-30 22:34:03] [config] early-stopping-on: first
[2023-06-30 22:34:03] [config] embedding-fix-src: false
[2023-06-30 22:34:03] [config] embedding-fix-trg: false
[2023-06-30 22:34:03] [config] embedding-normalization: false
[2023-06-30 22:34:03] [config] embedding-vectors:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] enc-cell: gru
[2023-06-30 22:34:03] [config] enc-cell-depth: 1
[2023-06-30 22:34:03] [config] enc-depth: 1
[2023-06-30 22:34:03] [config] enc-type: bidirectional
[2023-06-30 22:34:03] [config] english-title-case-every: 0
[2023-06-30 22:34:03] [config] exponential-smoothing: 0.0001
[2023-06-30 22:34:03] [config] factor-weight: 1
[2023-06-30 22:34:03] [config] factors-combine: sum
[2023-06-30 22:34:03] [config] factors-dim-emb: 0
[2023-06-30 22:34:03] [config] gradient-checkpointing: false
[2023-06-30 22:34:03] [config] gradient-norm-average-window: 100
[2023-06-30 22:34:03] [config] guided-alignment: none
[2023-06-30 22:34:03] [config] guided-alignment-cost: mse
[2023-06-30 22:34:03] [config] guided-alignment-weight: 0.1
[2023-06-30 22:34:03] [config] ignore-model-config: false
[2023-06-30 22:34:03] [config] input-types:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] interpolate-env-vars: false
[2023-06-30 22:34:03] [config] keep-best: false
[2023-06-30 22:34:03] [config] label-smoothing: 0.1
[2023-06-30 22:34:03] [config] layer-normalization: false
[2023-06-30 22:34:03] [config] learn-rate: 0.0003
[2023-06-30 22:34:03] [config] lemma-dependency: ""
[2023-06-30 22:34:03] [config] lemma-dim-emb: 0
[2023-06-30 22:34:03] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:34:03] [config] log-level: info
[2023-06-30 22:34:03] [config] log-time-zone: ""
[2023-06-30 22:34:03] [config] logical-epoch:
[2023-06-30 22:34:03] [config]   - 1e
[2023-06-30 22:34:03] [config]   - 0
[2023-06-30 22:34:03] [config] lr-decay: 0
[2023-06-30 22:34:03] [config] lr-decay-freq: 50000
[2023-06-30 22:34:03] [config] lr-decay-inv-sqrt:
[2023-06-30 22:34:03] [config]   - 16000
[2023-06-30 22:34:03] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:34:03] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:34:03] [config] lr-decay-start:
[2023-06-30 22:34:03] [config]   - 10
[2023-06-30 22:34:03] [config]   - 1
[2023-06-30 22:34:03] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:34:03] [config] lr-report: true
[2023-06-30 22:34:03] [config] lr-warmup: 16000
[2023-06-30 22:34:03] [config] lr-warmup-at-reload: false
[2023-06-30 22:34:03] [config] lr-warmup-cycle: false
[2023-06-30 22:34:03] [config] lr-warmup-start-rate: 0
[2023-06-30 22:34:03] [config] max-length: 100
[2023-06-30 22:34:03] [config] max-length-crop: false
[2023-06-30 22:34:03] [config] max-length-factor: 3
[2023-06-30 22:34:03] [config] maxi-batch: 100
[2023-06-30 22:34:03] [config] maxi-batch-sort: trg
[2023-06-30 22:34:03] [config] mini-batch: 1000
[2023-06-30 22:34:03] [config] mini-batch-fit: true
[2023-06-30 22:34:03] [config] mini-batch-fit-step: 10
[2023-06-30 22:34:03] [config] mini-batch-round-up: true
[2023-06-30 22:34:03] [config] mini-batch-track-lr: false
[2023-06-30 22:34:03] [config] mini-batch-warmup: 0
[2023-06-30 22:34:03] [config] mini-batch-words: 0
[2023-06-30 22:34:03] [config] mini-batch-words-ref: 0
[2023-06-30 22:34:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:34:03] [config] multi-loss-type: sum
[2023-06-30 22:34:03] [config] n-best: false
[2023-06-30 22:34:03] [config] no-nccl: false
[2023-06-30 22:34:03] [config] no-reload: false
[2023-06-30 22:34:03] [config] no-restore-corpus: false
[2023-06-30 22:34:03] [config] normalize: 1
[2023-06-30 22:34:03] [config] normalize-gradient: false
[2023-06-30 22:34:03] [config] num-devices: 0
[2023-06-30 22:34:03] [config] optimizer: adam
[2023-06-30 22:34:03] [config] optimizer-delay: 1
[2023-06-30 22:34:03] [config] optimizer-params:
[2023-06-30 22:34:03] [config]   - 0.9
[2023-06-30 22:34:03] [config]   - 0.98
[2023-06-30 22:34:03] [config]   - 1e-09
[2023-06-30 22:34:03] [config] output-omit-bias: false
[2023-06-30 22:34:03] [config] overwrite: true
[2023-06-30 22:34:03] [config] precision:
[2023-06-30 22:34:03] [config]   - float32
[2023-06-30 22:34:03] [config]   - float32
[2023-06-30 22:34:03] [config] pretrained-model: ""
[2023-06-30 22:34:03] [config] quantize-biases: false
[2023-06-30 22:34:03] [config] quantize-bits: 0
[2023-06-30 22:34:03] [config] quantize-log-based: false
[2023-06-30 22:34:03] [config] quantize-optimization-steps: 0
[2023-06-30 22:34:03] [config] quiet: false
[2023-06-30 22:34:03] [config] quiet-translation: true
[2023-06-30 22:34:03] [config] relative-paths: false
[2023-06-30 22:34:03] [config] right-left: false
[2023-06-30 22:34:03] [config] save-freq: 10000u
[2023-06-30 22:34:03] [config] seed: 1234
[2023-06-30 22:34:03] [config] sentencepiece-alphas:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:34:03] [config] sentencepiece-options: ""
[2023-06-30 22:34:03] [config] sharding: global
[2023-06-30 22:34:03] [config] shuffle: data
[2023-06-30 22:34:03] [config] shuffle-in-ram: false
[2023-06-30 22:34:03] [config] sigterm: save-and-exit
[2023-06-30 22:34:03] [config] skip: false
[2023-06-30 22:34:03] [config] sqlite: ""
[2023-06-30 22:34:03] [config] sqlite-drop: false
[2023-06-30 22:34:03] [config] sync-freq: 200u
[2023-06-30 22:34:03] [config] sync-sgd: true
[2023-06-30 22:34:03] [config] tempdir: /tmp
[2023-06-30 22:34:03] [config] tied-embeddings: false
[2023-06-30 22:34:03] [config] tied-embeddings-all: false
[2023-06-30 22:34:03] [config] tied-embeddings-src: false
[2023-06-30 22:34:03] [config] train-embedder-rank:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] train-sets:
[2023-06-30 22:34:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:34:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:34:03] [config] transformer-aan-activation: swish
[2023-06-30 22:34:03] [config] transformer-aan-depth: 2
[2023-06-30 22:34:03] [config] transformer-aan-nogate: false
[2023-06-30 22:34:03] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:34:03] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:34:03] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:34:03] [config] transformer-depth-scaling: false
[2023-06-30 22:34:03] [config] transformer-dim-aan: 2048
[2023-06-30 22:34:03] [config] transformer-dim-ffn: 2048
[2023-06-30 22:34:03] [config] transformer-dropout: 0.1
[2023-06-30 22:34:03] [config] transformer-dropout-attention: 0
[2023-06-30 22:34:03] [config] transformer-dropout-ffn: 0
[2023-06-30 22:34:03] [config] transformer-ffn-activation: swish
[2023-06-30 22:34:03] [config] transformer-ffn-depth: 2
[2023-06-30 22:34:03] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:34:03] [config] transformer-heads: 8
[2023-06-30 22:34:03] [config] transformer-no-projection: false
[2023-06-30 22:34:03] [config] transformer-pool: false
[2023-06-30 22:34:03] [config] transformer-postprocess: dan
[2023-06-30 22:34:03] [config] transformer-postprocess-emb: d
[2023-06-30 22:34:03] [config] transformer-postprocess-top: ""
[2023-06-30 22:34:03] [config] transformer-preprocess: ""
[2023-06-30 22:34:03] [config] transformer-tied-layers:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] transformer-train-position-embeddings: false
[2023-06-30 22:34:03] [config] tsv: false
[2023-06-30 22:34:03] [config] tsv-fields: 0
[2023-06-30 22:34:03] [config] type: transformer
[2023-06-30 22:34:03] [config] ulr: false
[2023-06-30 22:34:03] [config] ulr-dim-emb: 0
[2023-06-30 22:34:03] [config] ulr-dropout: 0
[2023-06-30 22:34:03] [config] ulr-keys-vectors: ""
[2023-06-30 22:34:03] [config] ulr-query-vectors: ""
[2023-06-30 22:34:03] [config] ulr-softmax-temperature: 1
[2023-06-30 22:34:03] [config] ulr-trainable-transformation: false
[2023-06-30 22:34:03] [config] unlikelihood-loss: false
[2023-06-30 22:34:03] [config] valid-freq: 50000000
[2023-06-30 22:34:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:34:03] [config] valid-max-length: 1000
[2023-06-30 22:34:03] [config] valid-metrics:
[2023-06-30 22:34:03] [config]   - cross-entropy
[2023-06-30 22:34:03] [config]   - translation
[2023-06-30 22:34:03] [config] valid-mini-batch: 64
[2023-06-30 22:34:03] [config] valid-reset-stalled: false
[2023-06-30 22:34:03] [config] valid-script-args:
[2023-06-30 22:34:03] [config]   []
[2023-06-30 22:34:03] [config] valid-script-path: ""
[2023-06-30 22:34:03] [config] valid-sets:
[2023-06-30 22:34:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:34:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:34:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:34:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:34:03] [config] vocabs:
[2023-06-30 22:34:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_bp16.txt.gn.spm
[2023-06-30 22:34:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_bp16.txt.es.spm
[2023-06-30 22:34:03] [config] word-penalty: 0
[2023-06-30 22:34:03] [config] word-scores: false
[2023-06-30 22:34:03] [config] workspace: 2048
[2023-06-30 22:34:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:34:03] Using synchronous SGD
[2023-06-30 22:34:04] Synced seed 1234
[2023-06-30 22:34:04] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_bp16.txt.gn.spm
[2023-06-30 22:34:04] [SentencePiece] Creating temporary file /tmp/marian.weLlXm 
[2023-06-30 22:34:04] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:34:04] [SentencePiece] Selected 20193 lines
[2023-06-30 22:34:05] Error: SentencePiece vocabulary error: Internal: /marian/src/3rd_party/sentencepiece/src/trainer_interface.cc(580) [(trainer_spec_.vocab_size()) == (model_proto->pieces_size())] Vocabulary size too high (54042). Please set it to a value <= 32125.
[2023-06-30 22:34:05] Error: Aborted from virtual void marian::SentencePieceVocab::create(const string&, const std::vector<std::__cxx11::basic_string<char> >&, size_t) in /marian/src/data/sentencepiece_vocab.cpp:195

[CALL STACK]
[0x5642e3e2d264]    marian::SentencePieceVocab::  create  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x5c4
[0x5642e3e10902]    marian::Vocab::  create  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x42
[0x5642e3e111e7]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x617
[0x5642e3e5e82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x5642e3e7179d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x5642e3d3bb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5642e3c5c058]    mainTrainer  (int,  char**)                        + 0x158
[0x5642e3c13b9c]    main                                               + 0x3c
[0x7f84dbd8c0b3]    __libc_start_main                                  + 0xf3
[0x5642e3c5acbe]    _start                                             + 0x2e

[2023-06-30 22:35:47] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-06-30 22:35:47] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:35:50] Saving Adam parameters
[2023-06-30 22:35:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:36:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:36:01] [marian] Running on node20.datos.cluster.uy as process 2208 with command line:
[2023-06-30 22:36:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:36:01] [config] after: 0e
[2023-06-30 22:36:01] [config] after-batches: 0
[2023-06-30 22:36:01] [config] after-epochs: 40
[2023-06-30 22:36:01] [config] all-caps-every: 0
[2023-06-30 22:36:01] [config] allow-unk: false
[2023-06-30 22:36:01] [config] authors: false
[2023-06-30 22:36:01] [config] beam-size: 12
[2023-06-30 22:36:01] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:36:01] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:36:01] [config] bert-masking-fraction: 0.15
[2023-06-30 22:36:01] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:36:01] [config] bert-train-type-embeddings: true
[2023-06-30 22:36:01] [config] bert-type-vocab-size: 2
[2023-06-30 22:36:01] [config] build-info: ""
[2023-06-30 22:36:01] [config] check-gradient-nan: false
[2023-06-30 22:36:01] [config] check-nan: false
[2023-06-30 22:36:01] [config] cite: false
[2023-06-30 22:36:01] [config] clip-norm: 1
[2023-06-30 22:36:01] [config] cost-scaling:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] cost-type: ce-sum
[2023-06-30 22:36:01] [config] cpu-threads: 0
[2023-06-30 22:36:01] [config] data-threads: 8
[2023-06-30 22:36:01] [config] data-weighting: ""
[2023-06-30 22:36:01] [config] data-weighting-type: sentence
[2023-06-30 22:36:01] [config] dec-cell: gru
[2023-06-30 22:36:01] [config] dec-cell-base-depth: 2
[2023-06-30 22:36:01] [config] dec-cell-high-depth: 1
[2023-06-30 22:36:01] [config] dec-depth: 1
[2023-06-30 22:36:01] [config] devices:
[2023-06-30 22:36:01] [config]   - 0
[2023-06-30 22:36:01] [config] dim-emb: 512
[2023-06-30 22:36:01] [config] dim-rnn: 1024
[2023-06-30 22:36:01] [config] dim-vocabs:
[2023-06-30 22:36:01] [config]   - 54042
[2023-06-30 22:36:01] [config]   - 36507
[2023-06-30 22:36:01] [config] disp-first: 0
[2023-06-30 22:36:01] [config] disp-freq: 1000u
[2023-06-30 22:36:01] [config] disp-label-counts: true
[2023-06-30 22:36:01] [config] dropout-rnn: 0
[2023-06-30 22:36:01] [config] dropout-src: 0
[2023-06-30 22:36:01] [config] dropout-trg: 0
[2023-06-30 22:36:01] [config] dump-config: ""
[2023-06-30 22:36:01] [config] dynamic-gradient-scaling:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] early-stopping: 10
[2023-06-30 22:36:01] [config] early-stopping-on: first
[2023-06-30 22:36:01] [config] embedding-fix-src: false
[2023-06-30 22:36:01] [config] embedding-fix-trg: false
[2023-06-30 22:36:01] [config] embedding-normalization: false
[2023-06-30 22:36:01] [config] embedding-vectors:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] enc-cell: gru
[2023-06-30 22:36:01] [config] enc-cell-depth: 1
[2023-06-30 22:36:01] [config] enc-depth: 1
[2023-06-30 22:36:01] [config] enc-type: bidirectional
[2023-06-30 22:36:01] [config] english-title-case-every: 0
[2023-06-30 22:36:01] [config] exponential-smoothing: 0
[2023-06-30 22:36:01] [config] factor-weight: 1
[2023-06-30 22:36:01] [config] factors-combine: sum
[2023-06-30 22:36:01] [config] factors-dim-emb: 0
[2023-06-30 22:36:01] [config] gradient-checkpointing: false
[2023-06-30 22:36:01] [config] gradient-norm-average-window: 100
[2023-06-30 22:36:01] [config] guided-alignment: none
[2023-06-30 22:36:01] [config] guided-alignment-cost: mse
[2023-06-30 22:36:01] [config] guided-alignment-weight: 0.1
[2023-06-30 22:36:01] [config] ignore-model-config: false
[2023-06-30 22:36:01] [config] input-types:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] interpolate-env-vars: false
[2023-06-30 22:36:01] [config] keep-best: false
[2023-06-30 22:36:01] [config] label-smoothing: 0
[2023-06-30 22:36:01] [config] layer-normalization: false
[2023-06-30 22:36:01] [config] learn-rate: 0.0001
[2023-06-30 22:36:01] [config] lemma-dependency: ""
[2023-06-30 22:36:01] [config] lemma-dim-emb: 0
[2023-06-30 22:36:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:36:01] [config] log-level: info
[2023-06-30 22:36:01] [config] log-time-zone: ""
[2023-06-30 22:36:01] [config] logical-epoch:
[2023-06-30 22:36:01] [config]   - 1e
[2023-06-30 22:36:01] [config]   - 0
[2023-06-30 22:36:01] [config] lr-decay: 0
[2023-06-30 22:36:01] [config] lr-decay-freq: 50000
[2023-06-30 22:36:01] [config] lr-decay-inv-sqrt:
[2023-06-30 22:36:01] [config]   - 0
[2023-06-30 22:36:01] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:36:01] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:36:01] [config] lr-decay-start:
[2023-06-30 22:36:01] [config]   - 10
[2023-06-30 22:36:01] [config]   - 1
[2023-06-30 22:36:01] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:36:01] [config] lr-report: false
[2023-06-30 22:36:01] [config] lr-warmup: 0
[2023-06-30 22:36:01] [config] lr-warmup-at-reload: false
[2023-06-30 22:36:01] [config] lr-warmup-cycle: false
[2023-06-30 22:36:01] [config] lr-warmup-start-rate: 0
[2023-06-30 22:36:01] [config] max-length: 50
[2023-06-30 22:36:01] [config] max-length-crop: false
[2023-06-30 22:36:01] [config] max-length-factor: 3
[2023-06-30 22:36:01] [config] maxi-batch: 100
[2023-06-30 22:36:01] [config] maxi-batch-sort: trg
[2023-06-30 22:36:01] [config] mini-batch: 64
[2023-06-30 22:36:01] [config] mini-batch-fit: false
[2023-06-30 22:36:01] [config] mini-batch-fit-step: 10
[2023-06-30 22:36:01] [config] mini-batch-round-up: true
[2023-06-30 22:36:01] [config] mini-batch-track-lr: false
[2023-06-30 22:36:01] [config] mini-batch-warmup: 0
[2023-06-30 22:36:01] [config] mini-batch-words: 0
[2023-06-30 22:36:01] [config] mini-batch-words-ref: 0
[2023-06-30 22:36:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:36:01] [config] multi-loss-type: sum
[2023-06-30 22:36:01] [config] n-best: false
[2023-06-30 22:36:01] [config] no-nccl: false
[2023-06-30 22:36:01] [config] no-reload: false
[2023-06-30 22:36:01] [config] no-restore-corpus: false
[2023-06-30 22:36:01] [config] normalize: 0
[2023-06-30 22:36:01] [config] normalize-gradient: false
[2023-06-30 22:36:01] [config] num-devices: 0
[2023-06-30 22:36:01] [config] optimizer: adam
[2023-06-30 22:36:01] [config] optimizer-delay: 1
[2023-06-30 22:36:01] [config] optimizer-params:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] output-omit-bias: false
[2023-06-30 22:36:01] [config] overwrite: true
[2023-06-30 22:36:01] [config] precision:
[2023-06-30 22:36:01] [config]   - float32
[2023-06-30 22:36:01] [config]   - float32
[2023-06-30 22:36:01] [config] pretrained-model: ""
[2023-06-30 22:36:01] [config] quantize-biases: false
[2023-06-30 22:36:01] [config] quantize-bits: 0
[2023-06-30 22:36:01] [config] quantize-log-based: false
[2023-06-30 22:36:01] [config] quantize-optimization-steps: 0
[2023-06-30 22:36:01] [config] quiet: false
[2023-06-30 22:36:01] [config] quiet-translation: true
[2023-06-30 22:36:01] [config] relative-paths: false
[2023-06-30 22:36:01] [config] right-left: false
[2023-06-30 22:36:01] [config] save-freq: 10000u
[2023-06-30 22:36:01] [config] seed: 1234
[2023-06-30 22:36:01] [config] sentencepiece-alphas:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:36:01] [config] sentencepiece-options: ""
[2023-06-30 22:36:01] [config] sharding: global
[2023-06-30 22:36:01] [config] shuffle: data
[2023-06-30 22:36:01] [config] shuffle-in-ram: false
[2023-06-30 22:36:01] [config] sigterm: save-and-exit
[2023-06-30 22:36:01] [config] skip: false
[2023-06-30 22:36:01] [config] sqlite: ""
[2023-06-30 22:36:01] [config] sqlite-drop: false
[2023-06-30 22:36:01] [config] sync-freq: 200u
[2023-06-30 22:36:01] [config] sync-sgd: false
[2023-06-30 22:36:01] [config] tempdir: /tmp
[2023-06-30 22:36:01] [config] tied-embeddings: false
[2023-06-30 22:36:01] [config] tied-embeddings-all: false
[2023-06-30 22:36:01] [config] tied-embeddings-src: false
[2023-06-30 22:36:01] [config] train-embedder-rank:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] train-sets:
[2023-06-30 22:36:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:36:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:36:01] [config] transformer-aan-activation: swish
[2023-06-30 22:36:01] [config] transformer-aan-depth: 2
[2023-06-30 22:36:01] [config] transformer-aan-nogate: false
[2023-06-30 22:36:01] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:36:01] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:36:01] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:36:01] [config] transformer-depth-scaling: false
[2023-06-30 22:36:01] [config] transformer-dim-aan: 2048
[2023-06-30 22:36:01] [config] transformer-dim-ffn: 2048
[2023-06-30 22:36:01] [config] transformer-dropout: 0
[2023-06-30 22:36:01] [config] transformer-dropout-attention: 0
[2023-06-30 22:36:01] [config] transformer-dropout-ffn: 0
[2023-06-30 22:36:01] [config] transformer-ffn-activation: swish
[2023-06-30 22:36:01] [config] transformer-ffn-depth: 2
[2023-06-30 22:36:01] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:36:01] [config] transformer-heads: 8
[2023-06-30 22:36:01] [config] transformer-no-projection: false
[2023-06-30 22:36:01] [config] transformer-pool: false
[2023-06-30 22:36:01] [config] transformer-postprocess: dan
[2023-06-30 22:36:01] [config] transformer-postprocess-emb: d
[2023-06-30 22:36:01] [config] transformer-postprocess-top: ""
[2023-06-30 22:36:01] [config] transformer-preprocess: ""
[2023-06-30 22:36:01] [config] transformer-tied-layers:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] transformer-train-position-embeddings: false
[2023-06-30 22:36:01] [config] tsv: false
[2023-06-30 22:36:01] [config] tsv-fields: 0
[2023-06-30 22:36:01] [config] type: transformer
[2023-06-30 22:36:01] [config] ulr: false
[2023-06-30 22:36:01] [config] ulr-dim-emb: 0
[2023-06-30 22:36:01] [config] ulr-dropout: 0
[2023-06-30 22:36:01] [config] ulr-keys-vectors: ""
[2023-06-30 22:36:01] [config] ulr-query-vectors: ""
[2023-06-30 22:36:01] [config] ulr-softmax-temperature: 1
[2023-06-30 22:36:01] [config] ulr-trainable-transformation: false
[2023-06-30 22:36:01] [config] unlikelihood-loss: false
[2023-06-30 22:36:01] [config] valid-freq: 50000000
[2023-06-30 22:36:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:36:01] [config] valid-max-length: 1000
[2023-06-30 22:36:01] [config] valid-metrics:
[2023-06-30 22:36:01] [config]   - cross-entropy
[2023-06-30 22:36:01] [config]   - translation
[2023-06-30 22:36:01] [config] valid-mini-batch: 32
[2023-06-30 22:36:01] [config] valid-reset-stalled: false
[2023-06-30 22:36:01] [config] valid-script-args:
[2023-06-30 22:36:01] [config]   []
[2023-06-30 22:36:01] [config] valid-script-path: ""
[2023-06-30 22:36:01] [config] valid-sets:
[2023-06-30 22:36:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:36:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:36:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:36:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:36:01] [config] vocabs:
[2023-06-30 22:36:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:36:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:36:01] [config] word-penalty: 0
[2023-06-30 22:36:01] [config] word-scores: false
[2023-06-30 22:36:01] [config] workspace: 2048
[2023-06-30 22:36:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:36:01] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:36:01] [training] Using single-device training
[2023-06-30 22:36:01] Synced seed 1234
[2023-06-30 22:36:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:36:01] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:36:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:36:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:36:02] [valid] No post-processing script given for validating translator
[2023-06-30 22:36:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:36:02] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:36:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:36:02] [comm] Using global sharding
[2023-06-30 22:36:02] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:36:02] [training] Using 1 GPUs
[2023-06-30 22:36:02] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:36:04] Loading Adam parameters
[2023-06-30 22:36:05] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:36:05] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:36:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:36:05] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-06-30 22:36:05] [data] Shuffling data
[2023-06-30 22:36:05] [data] Done reading 20,192 sentences
[2023-06-30 22:36:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:36:05] Training started
[2023-06-30 22:36:05] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:36:05] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:36:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:36:05] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:36:05] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:36:11] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 0.02890405 * 1,341,072 @ 320 after 12,072,365 : Time 9.25s : 144973.07 words/s : gNorm 0.7774
[2023-06-30 22:36:22] Seen 18,843 samples
[2023-06-30 22:36:22] Starting data epoch 32 in logical epoch 32
[2023-06-30 22:36:22] [data] Shuffling data
[2023-06-30 22:36:22] [data] Done reading 20,192 sentences
[2023-06-30 22:36:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:36:40] Seen 18,843 samples
[2023-06-30 22:36:40] Starting data epoch 33 in logical epoch 33
[2023-06-30 22:36:40] [data] Shuffling data
[2023-06-30 22:36:40] [data] Done reading 20,192 sentences
[2023-06-30 22:36:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:36:59] Seen 18,843 samples
[2023-06-30 22:36:59] Starting data epoch 34 in logical epoch 34
[2023-06-30 22:36:59] [data] Shuffling data
[2023-06-30 22:36:59] [data] Done reading 20,192 sentences
[2023-06-30 22:36:59] [data] Done shuffling 20,192 sentences to temp files
rain/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:37:11] [config] after: 0e
[2023-06-30 22:37:11] [config] after-batches: 0
[2023-06-30 22:37:11] [config] after-epochs: 1
[2023-06-30 22:37:11] [config] all-caps-every: 0
[2023-06-30 22:37:11] [config] allow-unk: false
[2023-06-30 22:37:11] [config] authors: false
[2023-06-30 22:37:11] [config] beam-size: 12
[2023-06-30 22:37:11] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:37:11] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:37:11] [config] bert-masking-fraction: 0.15
[2023-06-30 22:37:11] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:37:11] [config] bert-train-type-embeddings: true
[2023-06-30 22:37:11] [config] bert-type-vocab-size: 2
[2023-06-30 22:37:11] [config] build-info: ""
[2023-06-30 22:37:11] [config] check-gradient-nan: false
[2023-06-30 22:37:11] [config] check-nan: false
[2023-06-30 22:37:11] [config] cite: false
[2023-06-30 22:37:11] [config] clip-norm: 5
[2023-06-30 22:37:11] [config] cost-scaling:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] cost-type: ce-sum
[2023-06-30 22:37:11] [config] cpu-threads: 0
[2023-06-30 22:37:11] [config] data-threads: 8
[2023-06-30 22:37:11] [config] data-weighting: ""
[2023-06-30 22:37:11] [config] data-weighting-type: sentence
[2023-06-30 22:37:11] [config] dec-cell: gru
[2023-06-30 22:37:11] [config] dec-cell-base-depth: 2
[2023-06-30 22:37:11] [config] dec-cell-high-depth: 1
[2023-06-30 22:37:11] [config] dec-depth: 1
[2023-06-30 22:37:11] [config] devices:
[2023-06-30 22:37:11] [config]   - 0
[2023-06-30 22:37:11] [config] dim-emb: 512
[2023-06-30 22:37:11] [config] dim-rnn: 1024
[2023-06-30 22:37:11] [config] dim-vocabs:
[2023-06-30 22:37:11] [config]   - 54042
[2023-06-30 22:37:11] [config]   - 36507
[2023-06-30 22:37:11] [config] disp-first: 0
[2023-06-30 22:37:11] [config] disp-freq: 1000u
[2023-06-30 22:37:11] [config] disp-label-counts: true
[2023-06-30 22:37:11] [config] dropout-rnn: 0
[2023-06-30 22:37:11] [config] dropout-src: 0
[2023-06-30 22:37:11] [config] dropout-trg: 0
[2023-06-30 22:37:11] [config] dump-config: ""
[2023-06-30 22:37:11] [config] dynamic-gradient-scaling:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] early-stopping: 10
[2023-06-30 22:37:11] [config] early-stopping-on: first
[2023-06-30 22:37:11] [config] embedding-fix-src: false
[2023-06-30 22:37:11] [config] embedding-fix-trg: false
[2023-06-30 22:37:11] [config] embedding-normalization: false
[2023-06-30 22:37:11] [config] embedding-vectors:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] enc-cell: gru
[2023-06-30 22:37:11] [config] enc-cell-depth: 1
[2023-06-30 22:37:11] [config] enc-depth: 1
[2023-06-30 22:37:11] [config] enc-type: bidirectional
[2023-06-30 22:37:11] [config] english-title-case-every: 0
[2023-06-30 22:37:11] [config] exponential-smoothing: 0.0001
[2023-06-30 22:37:11] [config] factor-weight: 1
[2023-06-30 22:37:11] [config] factors-combine: sum
[2023-06-30 22:37:11] [config] factors-dim-emb: 0
[2023-06-30 22:37:11] [config] gradient-checkpointing: false
[2023-06-30 22:37:11] [config] gradient-norm-average-window: 100
[2023-06-30 22:37:11] [config] guided-alignment: none
[2023-06-30 22:37:11] [config] guided-alignment-cost: mse
[2023-06-30 22:37:11] [config] guided-alignment-weight: 0.1
[2023-06-30 22:37:11] [config] ignore-model-config: false
[2023-06-30 22:37:11] [config] input-types:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] interpolate-env-vars: false
[2023-06-30 22:37:11] [config] keep-best: false
[2023-06-30 22:37:11] [config] label-smoothing: 0.1
[2023-06-30 22:37:11] [config] layer-normalization: false
[2023-06-30 22:37:11] [config] learn-rate: 0.0003
[2023-06-30 22:37:11] [config] lemma-dependency: ""
[2023-06-30 22:37:11] [config] lemma-dim-emb: 0
[2023-06-30 22:37:11] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:37:11] [config] log-level: info
[2023-06-30 22:37:11] [config] log-time-zone: ""
[2023-06-30 22:37:11] [config] logical-epoch:
[2023-06-30 22:37:11] [config]   - 1e
[2023-06-30 22:37:11] [config]   - 0
[2023-06-30 22:37:11] [config] lr-decay: 0
[2023-06-30 22:37:11] [config] lr-decay-freq: 50000
[2023-06-30 22:37:11] [config] lr-decay-inv-sqrt:
[2023-06-30 22:37:11] [config]   - 16000
[2023-06-30 22:37:11] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:37:11] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:37:11] [config] lr-decay-start:
[2023-06-30 22:37:11] [config]   - 10
[2023-06-30 22:37:11] [config]   - 1
[2023-06-30 22:37:11] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:37:11] [config] lr-report: true
[2023-06-30 22:37:11] [config] lr-warmup: 16000
[2023-06-30 22:37:11] [config] lr-warmup-at-reload: false
[2023-06-30 22:37:11] [config] lr-warmup-cycle: false
[2023-06-30 22:37:11] [config] lr-warmup-start-rate: 0
[2023-06-30 22:37:11] [config] max-length: 100
[2023-06-30 22:37:11] [config] max-length-crop: false
[2023-06-30 22:37:11] [config] max-length-factor: 3
[2023-06-30 22:37:11] [config] maxi-batch: 100
[2023-06-30 22:37:11] [config] maxi-batch-sort: trg
[2023-06-30 22:37:11] [config] mini-batch: 1000
[2023-06-30 22:37:11] [config] mini-batch-fit: true
[2023-06-30 22:37:11] [config] mini-batch-fit-step: 10
[2023-06-30 22:37:11] [config] mini-batch-round-up: true
[2023-06-30 22:37:11] [config] mini-batch-track-lr: false
[2023-06-30 22:37:11] [config] mini-batch-warmup: 0
[2023-06-30 22:37:11] [config] mini-batch-words: 0
[2023-06-30 22:37:11] [config] mini-batch-words-ref: 0
[2023-06-30 22:37:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:37:11] [config] multi-loss-type: sum
[2023-06-30 22:37:11] [config] n-best: false
[2023-06-30 22:37:11] [config] no-nccl: false
[2023-06-30 22:37:11] [config] no-reload: false
[2023-06-30 22:37:11] [config] no-restore-corpus: false
[2023-06-30 22:37:11] [config] normalize: 1
[2023-06-30 22:37:11] [config] normalize-gradient: false
[2023-06-30 22:37:11] [config] num-devices: 0
[2023-06-30 22:37:11] [config] optimizer: adam
[2023-06-30 22:37:11] [config] optimizer-delay: 1
[2023-06-30 22:37:11] [config] optimizer-params:
[2023-06-30 22:37:11] [config]   - 0.9
[2023-06-30 22:37:11] [config]   - 0.98
[2023-06-30 22:37:11] [config]   - 1e-09
[2023-06-30 22:37:11] [config] output-omit-bias: false
[2023-06-30 22:37:11] [config] overwrite: true
[2023-06-30 22:37:11] [config] precision:
[2023-06-30 22:37:11] [config]   - float32
[2023-06-30 22:37:11] [config]   - float32
[2023-06-30 22:37:11] [config] pretrained-model: ""
[2023-06-30 22:37:11] [config] quantize-biases: false
[2023-06-30 22:37:11] [config] quantize-bits: 0
[2023-06-30 22:37:11] [config] quantize-log-based: false
[2023-06-30 22:37:11] [config] quantize-optimization-steps: 0
[2023-06-30 22:37:11] [config] quiet: false
[2023-06-30 22:37:11] [config] quiet-translation: true
[2023-06-30 22:37:11] [config] relative-paths: false
[2023-06-30 22:37:11] [config] right-left: false
[2023-06-30 22:37:11] [config] save-freq: 10000u
[2023-06-30 22:37:11] [config] seed: 1234
[2023-06-30 22:37:11] [config] sentencepiece-alphas:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:37:11] [config] sentencepiece-options: ""
[2023-06-30 22:37:11] [config] sharding: global
[2023-06-30 22:37:11] [config] shuffle: data
[2023-06-30 22:37:11] [config] shuffle-in-ram: false
[2023-06-30 22:37:11] [config] sigterm: save-and-exit
[2023-06-30 22:37:11] [config] skip: false
[2023-06-30 22:37:11] [config] sqlite: ""
[2023-06-30 22:37:11] [config] sqlite-drop: false
[2023-06-30 22:37:11] [config] sync-freq: 200u
[2023-06-30 22:37:11] [config] sync-sgd: true
[2023-06-30 22:37:11] [config] tempdir: /tmp
[2023-06-30 22:37:11] [config] tied-embeddings: false
[2023-06-30 22:37:11] [config] tied-embeddings-all: false
[2023-06-30 22:37:11] [config] tied-embeddings-src: false
[2023-06-30 22:37:11] [config] train-embedder-rank:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] train-sets:
[2023-06-30 22:37:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:37:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:37:11] [config] transformer-aan-activation: swish
[2023-06-30 22:37:11] [config] transformer-aan-depth: 2
[2023-06-30 22:37:11] [config] transformer-aan-nogate: false
[2023-06-30 22:37:11] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:37:11] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:37:11] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:37:11] [config] transformer-depth-scaling: false
[2023-06-30 22:37:11] [config] transformer-dim-aan: 2048
[2023-06-30 22:37:11] [config] transformer-dim-ffn: 2048
[2023-06-30 22:37:11] [config] transformer-dropout: 0.1
[2023-06-30 22:37:11] [config] transformer-dropout-attention: 0
[2023-06-30 22:37:11] [config] transformer-dropout-ffn: 0
[2023-06-30 22:37:11] [config] transformer-ffn-activation: swish
[2023-06-30 22:37:11] [config] transformer-ffn-depth: 2
[2023-06-30 22:37:11] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:37:11] [config] transformer-heads: 8
[2023-06-30 22:37:11] [config] transformer-no-projection: false
[2023-06-30 22:37:11] [config] transformer-pool: false
[2023-06-30 22:37:11] [config] transformer-postprocess: dan
[2023-06-30 22:37:11] [config] transformer-postprocess-emb: d
[2023-06-30 22:37:11] [config] transformer-postprocess-top: ""
[2023-06-30 22:37:11] [config] transformer-preprocess: ""
[2023-06-30 22:37:11] [config] transformer-tied-layers:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] transformer-train-position-embeddings: false
[2023-06-30 22:37:11] [config] tsv: false
[2023-06-30 22:37:11] [config] tsv-fields: 0
[2023-06-30 22:37:11] [config] type: transformer
[2023-06-30 22:37:11] [config] ulr: false
[2023-06-30 22:37:11] [config] ulr-dim-emb: 0
[2023-06-30 22:37:11] [config] ulr-dropout: 0
[2023-06-30 22:37:11] [config] ulr-keys-vectors: ""
[2023-06-30 22:37:11] [config] ulr-query-vectors: ""
[2023-06-30 22:37:11] [config] ulr-softmax-temperature: 1
[2023-06-30 22:37:11] [config] ulr-trainable-transformation: false
[2023-06-30 22:37:11] [config] unlikelihood-loss: false
[2023-06-30 22:37:11] [config] valid-freq: 50000000
[2023-06-30 22:37:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:37:11] [config] valid-max-length: 1000
[2023-06-30 22:37:11] [config] valid-metrics:
[2023-06-30 22:37:11] [config]   - cross-entropy
[2023-06-30 22:37:11] [config]   - translation
[2023-06-30 22:37:11] [config] valid-mini-batch: 64
[2023-06-30 22:37:11] [config] valid-reset-stalled: false
[2023-06-30 22:37:11] [config] valid-script-args:
[2023-06-30 22:37:11] [config]   []
[2023-06-30 22:37:11] [config] valid-script-path: ""
[2023-06-30 22:37:11] [config] valid-sets:
[2023-06-30 22:37:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:37:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:37:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:37:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:37:11] [config] vocabs:
[2023-06-30 22:37:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:37:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:37:11] [config] word-penalty: 0
[2023-06-30 22:37:11] [config] word-scores: false
[2023-06-30 22:37:11] [config] workspace: 2048
[2023-06-30 22:37:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:37:11] Using synchronous SGD
[2023-06-30 22:37:11] Synced seed 1234
[2023-06-30 22:37:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:37:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:37:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:37:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:37:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:37:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:37:13] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 0.02388895 * 1,347,521 @ 882 after 13,419,886 : Time 62.52s : 21552.84 words/s : gNorm 0.6909
[2023-06-30 22:37:13] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:37:17] Saving Adam parameters
actor(s)
[2023-06-30 22:37:13] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:37:16] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:37:16] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:37:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
2023-06-30 22:37:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:37:24] [comm] Using global sharding
[2023-06-30 22:37:24] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:37:24] [training] Using 1 GPUs
[2023-06-30 22:37:24] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:37:26] [warn] Average not found in .npz file
[2023-06-30 22:37:26] Loading Adam parameters
[2023-06-30 22:37:27] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:37:27] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:37:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:37:27] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:37:27] [data] Shuffling data
[2023-06-30 22:37:27] [data] Done reading 20,192 sentences
[2023-06-30 22:37:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:37:27] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:37:27] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263

[CALL STACK]
[0x5588bb78f26c]    marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x88c
[0x5588bb78fb3f]    marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>) + 0x4bf
[0x5588bb7961a9]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x23d9
[0x5588bb6b6058]    mainTrainer  (int,  char**)                        + 0x158
[0x5588bb66db9c]    main                                               + 0x3c
[0x7fa55fff20b3]    __libc_start_main                                  + 0xf3
[0x5588bb6b4cbe]    _start                                             + 0x2e

[2023-06-30 22:37:29] Seen 18,843 samples
[2023-06-30 22:37:29] Starting data epoch 35 in logical epoch 35
[2023-06-30 22:37:29] [data] Shuffling data
[2023-06-30 22:37:29] [data] Done reading 20,192 sentences
[2023-06-30 22:37:29] [data] Done shuffling 20,192 sentences to temp files
rain/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:37:31] [config] after: 0e
[2023-06-30 22:37:31] [config] after-batches: 0
[2023-06-30 22:37:31] [config] after-epochs: 2
[2023-06-30 22:37:31] [config] all-caps-every: 0
[2023-06-30 22:37:31] [config] allow-unk: false
[2023-06-30 22:37:31] [config] authors: false
[2023-06-30 22:37:31] [config] beam-size: 12
[2023-06-30 22:37:31] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:37:31] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:37:31] [config] bert-masking-fraction: 0.15
[2023-06-30 22:37:31] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:37:31] [config] bert-train-type-embeddings: true
[2023-06-30 22:37:31] [config] bert-type-vocab-size: 2
[2023-06-30 22:37:31] [config] build-info: ""
[2023-06-30 22:37:31] [config] check-gradient-nan: false
[2023-06-30 22:37:31] [config] check-nan: false
[2023-06-30 22:37:31] [config] cite: false
[2023-06-30 22:37:31] [config] clip-norm: 5
[2023-06-30 22:37:31] [config] cost-scaling:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] cost-type: ce-sum
[2023-06-30 22:37:31] [config] cpu-threads: 0
[2023-06-30 22:37:31] [config] data-threads: 8
[2023-06-30 22:37:31] [config] data-weighting: ""
[2023-06-30 22:37:31] [config] data-weighting-type: sentence
[2023-06-30 22:37:31] [config] dec-cell: gru
[2023-06-30 22:37:31] [config] dec-cell-base-depth: 2
[2023-06-30 22:37:31] [config] dec-cell-high-depth: 1
[2023-06-30 22:37:31] [config] dec-depth: 1
[2023-06-30 22:37:31] [config] devices:
[2023-06-30 22:37:31] [config]   - 0
[2023-06-30 22:37:31] [config] dim-emb: 512
[2023-06-30 22:37:31] [config] dim-rnn: 1024
[2023-06-30 22:37:31] [config] dim-vocabs:
[2023-06-30 22:37:31] [config]   - 54042
[2023-06-30 22:37:31] [config]   - 36507
[2023-06-30 22:37:31] [config] disp-first: 0
[2023-06-30 22:37:31] [config] disp-freq: 1000u
[2023-06-30 22:37:31] [config] disp-label-counts: true
[2023-06-30 22:37:31] [config] dropout-rnn: 0
[2023-06-30 22:37:31] [config] dropout-src: 0
[2023-06-30 22:37:31] [config] dropout-trg: 0
[2023-06-30 22:37:31] [config] dump-config: ""
[2023-06-30 22:37:31] [config] dynamic-gradient-scaling:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] early-stopping: 10
[2023-06-30 22:37:31] [config] early-stopping-on: first
[2023-06-30 22:37:31] [config] embedding-fix-src: false
[2023-06-30 22:37:31] [config] embedding-fix-trg: false
[2023-06-30 22:37:31] [config] embedding-normalization: false
[2023-06-30 22:37:31] [config] embedding-vectors:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] enc-cell: gru
[2023-06-30 22:37:31] [config] enc-cell-depth: 1
[2023-06-30 22:37:31] [config] enc-depth: 1
[2023-06-30 22:37:31] [config] enc-type: bidirectional
[2023-06-30 22:37:31] [config] english-title-case-every: 0
[2023-06-30 22:37:31] [config] exponential-smoothing: 0.0001
[2023-06-30 22:37:31] [config] factor-weight: 1
[2023-06-30 22:37:31] [config] factors-combine: sum
[2023-06-30 22:37:31] [config] factors-dim-emb: 0
[2023-06-30 22:37:31] [config] gradient-checkpointing: false
[2023-06-30 22:37:31] [config] gradient-norm-average-window: 100
[2023-06-30 22:37:31] [config] guided-alignment: none
[2023-06-30 22:37:31] [config] guided-alignment-cost: mse
[2023-06-30 22:37:31] [config] guided-alignment-weight: 0.1
[2023-06-30 22:37:31] [config] ignore-model-config: false
[2023-06-30 22:37:31] [config] input-types:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] interpolate-env-vars: false
[2023-06-30 22:37:31] [config] keep-best: false
[2023-06-30 22:37:31] [config] label-smoothing: 0.1
[2023-06-30 22:37:31] [config] layer-normalization: false
[2023-06-30 22:37:31] [config] learn-rate: 0.0003
[2023-06-30 22:37:31] [config] lemma-dependency: ""
[2023-06-30 22:37:31] [config] lemma-dim-emb: 0
[2023-06-30 22:37:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:37:31] [config] log-level: info
[2023-06-30 22:37:31] [config] log-time-zone: ""
[2023-06-30 22:37:31] [config] logical-epoch:
[2023-06-30 22:37:31] [config]   - 1e
[2023-06-30 22:37:31] [config]   - 0
[2023-06-30 22:37:31] [config] lr-decay: 0
[2023-06-30 22:37:31] [config] lr-decay-freq: 50000
[2023-06-30 22:37:31] [config] lr-decay-inv-sqrt:
[2023-06-30 22:37:31] [config]   - 16000
[2023-06-30 22:37:31] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:37:31] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:37:31] [config] lr-decay-start:
[2023-06-30 22:37:31] [config]   - 10
[2023-06-30 22:37:31] [config]   - 1
[2023-06-30 22:37:31] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:37:31] [config] lr-report: true
[2023-06-30 22:37:31] [config] lr-warmup: 16000
[2023-06-30 22:37:31] [config] lr-warmup-at-reload: false
[2023-06-30 22:37:31] [config] lr-warmup-cycle: false
[2023-06-30 22:37:31] [config] lr-warmup-start-rate: 0
[2023-06-30 22:37:31] [config] max-length: 100
[2023-06-30 22:37:31] [config] max-length-crop: false
[2023-06-30 22:37:31] [config] max-length-factor: 3
[2023-06-30 22:37:31] [config] maxi-batch: 100
[2023-06-30 22:37:31] [config] maxi-batch-sort: trg
[2023-06-30 22:37:31] [config] mini-batch: 1000
[2023-06-30 22:37:31] [config] mini-batch-fit: true
[2023-06-30 22:37:31] [config] mini-batch-fit-step: 10
[2023-06-30 22:37:31] [config] mini-batch-round-up: true
[2023-06-30 22:37:31] [config] mini-batch-track-lr: false
[2023-06-30 22:37:31] [config] mini-batch-warmup: 0
[2023-06-30 22:37:31] [config] mini-batch-words: 0
[2023-06-30 22:37:31] [config] mini-batch-words-ref: 0
[2023-06-30 22:37:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:37:31] [config] multi-loss-type: sum
[2023-06-30 22:37:31] [config] n-best: false
[2023-06-30 22:37:31] [config] no-nccl: false
[2023-06-30 22:37:31] [config] no-reload: false
[2023-06-30 22:37:31] [config] no-restore-corpus: false
[2023-06-30 22:37:31] [config] normalize: 1
[2023-06-30 22:37:31] [config] normalize-gradient: false
[2023-06-30 22:37:31] [config] num-devices: 0
[2023-06-30 22:37:31] [config] optimizer: adam
[2023-06-30 22:37:31] [config] optimizer-delay: 1
[2023-06-30 22:37:31] [config] optimizer-params:
[2023-06-30 22:37:31] [config]   - 0.9
[2023-06-30 22:37:31] [config]   - 0.98
[2023-06-30 22:37:31] [config]   - 1e-09
[2023-06-30 22:37:31] [config] output-omit-bias: false
[2023-06-30 22:37:31] [config] overwrite: true
[2023-06-30 22:37:31] [config] precision:
[2023-06-30 22:37:31] [config]   - float32
[2023-06-30 22:37:31] [config]   - float32
[2023-06-30 22:37:31] [config] pretrained-model: ""
[2023-06-30 22:37:31] [config] quantize-biases: false
[2023-06-30 22:37:31] [config] quantize-bits: 0
[2023-06-30 22:37:31] [config] quantize-log-based: false
[2023-06-30 22:37:31] [config] quantize-optimization-steps: 0
[2023-06-30 22:37:31] [config] quiet: false
[2023-06-30 22:37:31] [config] quiet-translation: true
[2023-06-30 22:37:31] [config] relative-paths: false
[2023-06-30 22:37:31] [config] right-left: false
[2023-06-30 22:37:31] [config] save-freq: 10000u
[2023-06-30 22:37:31] [config] seed: 1234
[2023-06-30 22:37:31] [config] sentencepiece-alphas:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:37:31] [config] sentencepiece-options: ""
[2023-06-30 22:37:31] [config] sharding: global
[2023-06-30 22:37:31] [config] shuffle: data
[2023-06-30 22:37:31] [config] shuffle-in-ram: false
[2023-06-30 22:37:31] [config] sigterm: save-and-exit
[2023-06-30 22:37:31] [config] skip: false
[2023-06-30 22:37:31] [config] sqlite: ""
[2023-06-30 22:37:31] [config] sqlite-drop: false
[2023-06-30 22:37:31] [config] sync-freq: 200u
[2023-06-30 22:37:31] [config] sync-sgd: true
[2023-06-30 22:37:31] [config] tempdir: /tmp
[2023-06-30 22:37:31] [config] tied-embeddings: false
[2023-06-30 22:37:31] [config] tied-embeddings-all: false
[2023-06-30 22:37:31] [config] tied-embeddings-src: false
[2023-06-30 22:37:31] [config] train-embedder-rank:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] train-sets:
[2023-06-30 22:37:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:37:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:37:31] [config] transformer-aan-activation: swish
[2023-06-30 22:37:31] [config] transformer-aan-depth: 2
[2023-06-30 22:37:31] [config] transformer-aan-nogate: false
[2023-06-30 22:37:31] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:37:31] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:37:31] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:37:31] [config] transformer-depth-scaling: false
[2023-06-30 22:37:31] [config] transformer-dim-aan: 2048
[2023-06-30 22:37:31] [config] transformer-dim-ffn: 2048
[2023-06-30 22:37:31] [config] transformer-dropout: 0.1
[2023-06-30 22:37:31] [config] transformer-dropout-attention: 0
[2023-06-30 22:37:31] [config] transformer-dropout-ffn: 0
[2023-06-30 22:37:31] [config] transformer-ffn-activation: swish
[2023-06-30 22:37:31] [config] transformer-ffn-depth: 2
[2023-06-30 22:37:31] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:37:31] [config] transformer-heads: 8
[2023-06-30 22:37:31] [config] transformer-no-projection: false
[2023-06-30 22:37:31] [config] transformer-pool: false
[2023-06-30 22:37:31] [config] transformer-postprocess: dan
[2023-06-30 22:37:31] [config] transformer-postprocess-emb: d
[2023-06-30 22:37:31] [config] transformer-postprocess-top: ""
[2023-06-30 22:37:31] [config] transformer-preprocess: ""
[2023-06-30 22:37:31] [config] transformer-tied-layers:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] transformer-train-position-embeddings: false
[2023-06-30 22:37:31] [config] tsv: false
[2023-06-30 22:37:31] [config] tsv-fields: 0
[2023-06-30 22:37:31] [config] type: transformer
[2023-06-30 22:37:31] [config] ulr: false
[2023-06-30 22:37:31] [config] ulr-dim-emb: 0
[2023-06-30 22:37:31] [config] ulr-dropout: 0
[2023-06-30 22:37:31] [config] ulr-keys-vectors: ""
[2023-06-30 22:37:31] [config] ulr-query-vectors: ""
[2023-06-30 22:37:31] [config] ulr-softmax-temperature: 1
[2023-06-30 22:37:31] [config] ulr-trainable-transformation: false
[2023-06-30 22:37:31] [config] unlikelihood-loss: false
[2023-06-30 22:37:31] [config] valid-freq: 50000000
[2023-06-30 22:37:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:37:31] [config] valid-max-length: 1000
[2023-06-30 22:37:31] [config] valid-metrics:
[2023-06-30 22:37:31] [config]   - cross-entropy
[2023-06-30 22:37:31] [config]   - translation
[2023-06-30 22:37:31] [config] valid-mini-batch: 64
[2023-06-30 22:37:31] [config] valid-reset-stalled: false
[2023-06-30 22:37:31] [config] valid-script-args:
[2023-06-30 22:37:31] [config]   []
[2023-06-30 22:37:31] [config] valid-script-path: ""
[2023-06-30 22:37:31] [config] valid-sets:
[2023-06-30 22:37:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:37:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:37:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:37:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:37:31] [config] vocabs:
[2023-06-30 22:37:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:37:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:37:31] [config] word-penalty: 0
[2023-06-30 22:37:31] [config] word-scores: false
[2023-06-30 22:37:31] [config] workspace: 2048
[2023-06-30 22:37:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:37:31] Using synchronous SGD
[2023-06-30 22:37:31] Synced seed 1234
[2023-06-30 22:37:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:37:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:37:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:37:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:37:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:37:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:37:32] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:37:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:37:32] [comm] Using global sharding
[2023-06-30 22:37:32] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:37:32] [training] Using 1 GPUs
[2023-06-30 22:37:32] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:37:32] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:37:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:37:32] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:37:40] [batching] Done. Typical MB size is 6,776 target words
[2023-06-30 22:37:40] [valid] No post-processing script given for validating translator
[2023-06-30 22:37:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:37:40] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:37:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:37:40] [comm] Using global sharding
[2023-06-30 22:37:40] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:37:40] [training] Using 1 GPUs
[2023-06-30 22:37:40] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:37:42] [warn] Average not found in .npz file
[2023-06-30 22:37:42] Loading Adam parameters
[2023-06-30 22:37:42] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:37:42] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:37:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:37:42] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:37:42] [data] Shuffling data
[2023-06-30 22:37:42] [data] Done reading 20,192 sentences
[2023-06-30 22:37:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:37:42] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:37:42] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263

[CALL STACK]
[0x56310455426c]    marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x88c
[0x563104554b3f]    marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>) + 0x4bf
[0x56310455b1a9]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x23d9
[0x56310447b058]    mainTrainer  (int,  char**)                        + 0x158
[0x563104432b9c]    main                                               + 0x3c
[0x7fa81a42a0b3]    __libc_start_main                                  + 0xf3
[0x563104479cbe]    _start                                             + 0x2e

[2023-06-30 22:37:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:37:46] [marian] Running on node23.datos.cluster.uy as process 34670 with command line:
[2023-06-30 22:37:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 3 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:37:46] [config] after: 0e
[2023-06-30 22:37:46] [config] after-batches: 0
[2023-06-30 22:37:46] [config] after-epochs: 3
[2023-06-30 22:37:46] [config] all-caps-every: 0
[2023-06-30 22:37:46] [config] allow-unk: false
[2023-06-30 22:37:46] [config] authors: false
[2023-06-30 22:37:46] [config] beam-size: 12
[2023-06-30 22:37:46] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:37:46] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:37:46] [config] bert-masking-fraction: 0.15
[2023-06-30 22:37:46] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:37:46] [config] bert-train-type-embeddings: true
[2023-06-30 22:37:46] [config] bert-type-vocab-size: 2
[2023-06-30 22:37:46] [config] build-info: ""
[2023-06-30 22:37:46] [config] check-gradient-nan: false
[2023-06-30 22:37:46] [config] check-nan: false
[2023-06-30 22:37:46] [config] cite: false
[2023-06-30 22:37:46] [config] clip-norm: 5
[2023-06-30 22:37:46] [config] cost-scaling:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] cost-type: ce-sum
[2023-06-30 22:37:46] [config] cpu-threads: 0
[2023-06-30 22:37:46] [config] data-threads: 8
[2023-06-30 22:37:46] [config] data-weighting: ""
[2023-06-30 22:37:46] [config] data-weighting-type: sentence
[2023-06-30 22:37:46] [config] dec-cell: gru
[2023-06-30 22:37:46] [config] dec-cell-base-depth: 2
[2023-06-30 22:37:46] [config] dec-cell-high-depth: 1
[2023-06-30 22:37:46] [config] dec-depth: 1
[2023-06-30 22:37:46] [config] devices:
[2023-06-30 22:37:46] [config]   - 0
[2023-06-30 22:37:46] [config] dim-emb: 512
[2023-06-30 22:37:46] [config] dim-rnn: 1024
[2023-06-30 22:37:46] [config] dim-vocabs:
[2023-06-30 22:37:46] [config]   - 54042
[2023-06-30 22:37:46] [config]   - 36507
[2023-06-30 22:37:46] [config] disp-first: 0
[2023-06-30 22:37:46] [config] disp-freq: 1000u
[2023-06-30 22:37:46] [config] disp-label-counts: true
[2023-06-30 22:37:46] [config] dropout-rnn: 0
[2023-06-30 22:37:46] [config] dropout-src: 0
[2023-06-30 22:37:46] [config] dropout-trg: 0
[2023-06-30 22:37:46] [config] dump-config: ""
[2023-06-30 22:37:46] [config] dynamic-gradient-scaling:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] early-stopping: 10
[2023-06-30 22:37:46] [config] early-stopping-on: first
[2023-06-30 22:37:46] [config] embedding-fix-src: false
[2023-06-30 22:37:46] [config] embedding-fix-trg: false
[2023-06-30 22:37:46] [config] embedding-normalization: false
[2023-06-30 22:37:46] [config] embedding-vectors:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] enc-cell: gru
[2023-06-30 22:37:46] [config] enc-cell-depth: 1
[2023-06-30 22:37:46] [config] enc-depth: 1
[2023-06-30 22:37:46] [config] enc-type: bidirectional
[2023-06-30 22:37:46] [config] english-title-case-every: 0
[2023-06-30 22:37:46] [config] exponential-smoothing: 0.0001
[2023-06-30 22:37:46] [config] factor-weight: 1
[2023-06-30 22:37:46] [config] factors-combine: sum
[2023-06-30 22:37:46] [config] factors-dim-emb: 0
[2023-06-30 22:37:46] [config] gradient-checkpointing: false
[2023-06-30 22:37:46] [config] gradient-norm-average-window: 100
[2023-06-30 22:37:46] [config] guided-alignment: none
[2023-06-30 22:37:46] [config] guided-alignment-cost: mse
[2023-06-30 22:37:46] [config] guided-alignment-weight: 0.1
[2023-06-30 22:37:46] [config] ignore-model-config: false
[2023-06-30 22:37:46] [config] input-types:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] interpolate-env-vars: false
[2023-06-30 22:37:46] [config] keep-best: false
[2023-06-30 22:37:46] [config] label-smoothing: 0.1
[2023-06-30 22:37:46] [config] layer-normalization: false
[2023-06-30 22:37:46] [config] learn-rate: 0.0003
[2023-06-30 22:37:46] [config] lemma-dependency: ""
[2023-06-30 22:37:46] [config] lemma-dim-emb: 0
[2023-06-30 22:37:46] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:37:46] [config] log-level: info
[2023-06-30 22:37:46] [config] log-time-zone: ""
[2023-06-30 22:37:46] [config] logical-epoch:
[2023-06-30 22:37:46] [config]   - 1e
[2023-06-30 22:37:46] [config]   - 0
[2023-06-30 22:37:46] [config] lr-decay: 0
[2023-06-30 22:37:46] [config] lr-decay-freq: 50000
[2023-06-30 22:37:46] [config] lr-decay-inv-sqrt:
[2023-06-30 22:37:46] [config]   - 16000
[2023-06-30 22:37:46] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:37:46] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:37:46] [config] lr-decay-start:
[2023-06-30 22:37:46] [config]   - 10
[2023-06-30 22:37:46] [config]   - 1
[2023-06-30 22:37:46] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:37:46] [config] lr-report: true
[2023-06-30 22:37:46] [config] lr-warmup: 16000
[2023-06-30 22:37:46] [config] lr-warmup-at-reload: false
[2023-06-30 22:37:46] [config] lr-warmup-cycle: false
[2023-06-30 22:37:46] [config] lr-warmup-start-rate: 0
[2023-06-30 22:37:46] [config] max-length: 100
[2023-06-30 22:37:46] [config] max-length-crop: false
[2023-06-30 22:37:46] [config] max-length-factor: 3
[2023-06-30 22:37:46] [config] maxi-batch: 100
[2023-06-30 22:37:46] [config] maxi-batch-sort: trg
[2023-06-30 22:37:46] [config] mini-batch: 1000
[2023-06-30 22:37:46] [config] mini-batch-fit: true
[2023-06-30 22:37:46] [config] mini-batch-fit-step: 10
[2023-06-30 22:37:46] [config] mini-batch-round-up: true
[2023-06-30 22:37:46] [config] mini-batch-track-lr: false
[2023-06-30 22:37:46] [config] mini-batch-warmup: 0
[2023-06-30 22:37:46] [config] mini-batch-words: 0
[2023-06-30 22:37:46] [config] mini-batch-words-ref: 0
[2023-06-30 22:37:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:37:46] [config] multi-loss-type: sum
[2023-06-30 22:37:46] [config] n-best: false
[2023-06-30 22:37:46] [config] no-nccl: false
[2023-06-30 22:37:46] [config] no-reload: false
[2023-06-30 22:37:46] [config] no-restore-corpus: false
[2023-06-30 22:37:46] [config] normalize: 1
[2023-06-30 22:37:46] [config] normalize-gradient: false
[2023-06-30 22:37:46] [config] num-devices: 0
[2023-06-30 22:37:46] [config] optimizer: adam
[2023-06-30 22:37:46] [config] optimizer-delay: 1
[2023-06-30 22:37:46] [config] optimizer-params:
[2023-06-30 22:37:46] [config]   - 0.9
[2023-06-30 22:37:46] [config]   - 0.98
[2023-06-30 22:37:46] [config]   - 1e-09
[2023-06-30 22:37:46] [config] output-omit-bias: false
[2023-06-30 22:37:46] [config] overwrite: true
[2023-06-30 22:37:46] [config] precision:
[2023-06-30 22:37:46] [config]   - float32
[2023-06-30 22:37:46] [config]   - float32
[2023-06-30 22:37:46] [config] pretrained-model: ""
[2023-06-30 22:37:46] [config] quantize-biases: false
[2023-06-30 22:37:46] [config] quantize-bits: 0
[2023-06-30 22:37:46] [config] quantize-log-based: false
[2023-06-30 22:37:46] [config] quantize-optimization-steps: 0
[2023-06-30 22:37:46] [config] quiet: false
[2023-06-30 22:37:46] [config] quiet-translation: true
[2023-06-30 22:37:46] [config] relative-paths: false
[2023-06-30 22:37:46] [config] right-left: false
[2023-06-30 22:37:46] [config] save-freq: 10000u
[2023-06-30 22:37:46] [config] seed: 1234
[2023-06-30 22:37:46] [config] sentencepiece-alphas:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:37:46] [config] sentencepiece-options: ""
[2023-06-30 22:37:46] [config] sharding: global
[2023-06-30 22:37:46] [config] shuffle: data
[2023-06-30 22:37:46] [config] shuffle-in-ram: false
[2023-06-30 22:37:46] [config] sigterm: save-and-exit
[2023-06-30 22:37:46] [config] skip: false
[2023-06-30 22:37:46] [config] sqlite: ""
[2023-06-30 22:37:46] [config] sqlite-drop: false
[2023-06-30 22:37:46] [config] sync-freq: 200u
[2023-06-30 22:37:46] [config] sync-sgd: true
[2023-06-30 22:37:46] [config] tempdir: /tmp
[2023-06-30 22:37:46] [config] tied-embeddings: false
[2023-06-30 22:37:46] [config] tied-embeddings-all: false
[2023-06-30 22:37:46] [config] tied-embeddings-src: false
[2023-06-30 22:37:46] [config] train-embedder-rank:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] train-sets:
[2023-06-30 22:37:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:37:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:37:46] [config] transformer-aan-activation: swish
[2023-06-30 22:37:46] [config] transformer-aan-depth: 2
[2023-06-30 22:37:46] [config] transformer-aan-nogate: false
[2023-06-30 22:37:46] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:37:46] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:37:46] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:37:46] [config] transformer-depth-scaling: false
[2023-06-30 22:37:46] [config] transformer-dim-aan: 2048
[2023-06-30 22:37:46] [config] transformer-dim-ffn: 2048
[2023-06-30 22:37:46] [config] transformer-dropout: 0.1
[2023-06-30 22:37:46] [config] transformer-dropout-attention: 0
[2023-06-30 22:37:46] [config] transformer-dropout-ffn: 0
[2023-06-30 22:37:46] [config] transformer-ffn-activation: swish
[2023-06-30 22:37:46] [config] transformer-ffn-depth: 2
[2023-06-30 22:37:46] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:37:46] [config] transformer-heads: 8
[2023-06-30 22:37:46] [config] transformer-no-projection: false
[2023-06-30 22:37:46] [config] transformer-pool: false
[2023-06-30 22:37:46] [config] transformer-postprocess: dan
[2023-06-30 22:37:46] [config] transformer-postprocess-emb: d
[2023-06-30 22:37:46] [config] transformer-postprocess-top: ""
[2023-06-30 22:37:46] [config] transformer-preprocess: ""
[2023-06-30 22:37:46] [config] transformer-tied-layers:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] transformer-train-position-embeddings: false
[2023-06-30 22:37:46] [config] tsv: false
[2023-06-30 22:37:46] [config] tsv-fields: 0
[2023-06-30 22:37:46] [config] type: transformer
[2023-06-30 22:37:46] [config] ulr: false
[2023-06-30 22:37:46] [config] ulr-dim-emb: 0
[2023-06-30 22:37:46] [config] ulr-dropout: 0
[2023-06-30 22:37:46] [config] ulr-keys-vectors: ""
[2023-06-30 22:37:46] [config] ulr-query-vectors: ""
[2023-06-30 22:37:46] [config] ulr-softmax-temperature: 1
[2023-06-30 22:37:46] [config] ulr-trainable-transformation: false
[2023-06-30 22:37:46] [config] unlikelihood-loss: false
[2023-06-30 22:37:46] [config] valid-freq: 50000000
[2023-06-30 22:37:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:37:46] [config] valid-max-length: 1000
[2023-06-30 22:37:46] [config] valid-metrics:
[2023-06-30 22:37:46] [config]   - cross-entropy
[2023-06-30 22:37:46] [config]   - translation
[2023-06-30 22:37:46] [config] valid-mini-batch: 64
[2023-06-30 22:37:46] [config] valid-reset-stalled: false
[2023-06-30 22:37:46] [config] valid-script-args:
[2023-06-30 22:37:46] [config]   []
[2023-06-30 22:37:46] [config] valid-script-path: ""
[2023-06-30 22:37:46] [config] valid-sets:
[2023-06-30 22:37:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:37:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:37:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:37:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:37:46] [config] vocabs:
[2023-06-30 22:37:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:37:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:37:46] [config] word-penalty: 0
[2023-06-30 22:37:46] [config] word-scores: false
[2023-06-30 22:37:46] [config] workspace: 2048
[2023-06-30 22:37:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:37:46] Using synchronous SGD
[2023-06-30 22:37:47] Synced seed 1234
[2023-06-30 22:37:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:37:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:37:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:37:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:37:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:37:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:37:47] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:37:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:37:47] [comm] Using global sharding
[2023-06-30 22:37:47] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:37:47] [training] Using 1 GPUs
[2023-06-30 22:37:47] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:37:47] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:37:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:37:48] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:37:55] [batching] Done. Typical MB size is 6,776 target words
[2023-06-30 22:37:55] [valid] No post-processing script given for validating translator
[2023-06-30 22:37:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:37:55] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:37:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:37:55] [comm] Using global sharding
[2023-06-30 22:37:55] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:37:55] [training] Using 1 GPUs
[2023-06-30 22:37:55] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:37:57] [warn] Average not found in .npz file
[2023-06-30 22:37:57] Loading Adam parameters
[2023-06-30 22:37:57] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:37:57] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:37:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:37:57] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:37:57] [data] Shuffling data
[2023-06-30 22:37:57] [data] Done reading 20,192 sentences
[2023-06-30 22:37:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:37:57] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:37:57] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263

[CALL STACK]
[0x55866998726c]    marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x88c
[0x558669987b3f]    marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>) + 0x4bf
[0x55866998e1a9]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x23d9
[0x5586698ae058]    mainTrainer  (int,  char**)                        + 0x158
[0x558669865b9c]    main                                               + 0x3c
[0x7f6f5dc240b3]    __libc_start_main                                  + 0xf3
[0x5586698accbe]    _start                                             + 0x2e

[2023-06-30 22:38:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:01] [marian] Running on node23.datos.cluster.uy as process 34730 with command line:
[2023-06-30 22:38:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 4 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:38:01] [config] after: 0e
[2023-06-30 22:38:01] [config] after-batches: 0
[2023-06-30 22:38:01] [config] after-epochs: 4
[2023-06-30 22:38:01] [config] all-caps-every: 0
[2023-06-30 22:38:01] [config] allow-unk: false
[2023-06-30 22:38:01] [config] authors: false
[2023-06-30 22:38:01] [config] beam-size: 12
[2023-06-30 22:38:01] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:38:01] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:38:01] [config] bert-masking-fraction: 0.15
[2023-06-30 22:38:01] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:38:01] [config] bert-train-type-embeddings: true
[2023-06-30 22:38:01] [config] bert-type-vocab-size: 2
[2023-06-30 22:38:01] [config] build-info: ""
[2023-06-30 22:38:01] [config] check-gradient-nan: false
[2023-06-30 22:38:01] [config] check-nan: false
[2023-06-30 22:38:01] [config] cite: false
[2023-06-30 22:38:01] [config] clip-norm: 5
[2023-06-30 22:38:01] [config] cost-scaling:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] cost-type: ce-sum
[2023-06-30 22:38:01] [config] cpu-threads: 0
[2023-06-30 22:38:01] [config] data-threads: 8
[2023-06-30 22:38:01] [config] data-weighting: ""
[2023-06-30 22:38:01] [config] data-weighting-type: sentence
[2023-06-30 22:38:01] [config] dec-cell: gru
[2023-06-30 22:38:01] [config] dec-cell-base-depth: 2
[2023-06-30 22:38:01] [config] dec-cell-high-depth: 1
[2023-06-30 22:38:01] [config] dec-depth: 1
[2023-06-30 22:38:01] [config] devices:
[2023-06-30 22:38:01] [config]   - 0
[2023-06-30 22:38:01] [config] dim-emb: 512
[2023-06-30 22:38:01] [config] dim-rnn: 1024
[2023-06-30 22:38:01] [config] dim-vocabs:
[2023-06-30 22:38:01] [config]   - 54042
[2023-06-30 22:38:01] [config]   - 36507
[2023-06-30 22:38:01] [config] disp-first: 0
[2023-06-30 22:38:01] [config] disp-freq: 1000u
[2023-06-30 22:38:01] [config] disp-label-counts: true
[2023-06-30 22:38:01] [config] dropout-rnn: 0
[2023-06-30 22:38:01] [config] dropout-src: 0
[2023-06-30 22:38:01] [config] dropout-trg: 0
[2023-06-30 22:38:01] [config] dump-config: ""
[2023-06-30 22:38:01] [config] dynamic-gradient-scaling:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] early-stopping: 10
[2023-06-30 22:38:01] [config] early-stopping-on: first
[2023-06-30 22:38:01] [config] embedding-fix-src: false
[2023-06-30 22:38:01] [config] embedding-fix-trg: false
[2023-06-30 22:38:01] [config] embedding-normalization: false
[2023-06-30 22:38:01] [config] embedding-vectors:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] enc-cell: gru
[2023-06-30 22:38:01] [config] enc-cell-depth: 1
[2023-06-30 22:38:01] [config] enc-depth: 1
[2023-06-30 22:38:01] [config] enc-type: bidirectional
[2023-06-30 22:38:01] [config] english-title-case-every: 0
[2023-06-30 22:38:01] [config] exponential-smoothing: 0.0001
[2023-06-30 22:38:01] [config] factor-weight: 1
[2023-06-30 22:38:01] [config] factors-combine: sum
[2023-06-30 22:38:01] [config] factors-dim-emb: 0
[2023-06-30 22:38:01] [config] gradient-checkpointing: false
[2023-06-30 22:38:01] [config] gradient-norm-average-window: 100
[2023-06-30 22:38:01] [config] guided-alignment: none
[2023-06-30 22:38:01] [config] guided-alignment-cost: mse
[2023-06-30 22:38:01] [config] guided-alignment-weight: 0.1
[2023-06-30 22:38:01] [config] ignore-model-config: false
[2023-06-30 22:38:01] [config] input-types:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] interpolate-env-vars: false
[2023-06-30 22:38:01] [config] keep-best: false
[2023-06-30 22:38:01] [config] label-smoothing: 0.1
[2023-06-30 22:38:01] [config] layer-normalization: false
[2023-06-30 22:38:01] [config] learn-rate: 0.0003
[2023-06-30 22:38:01] [config] lemma-dependency: ""
[2023-06-30 22:38:01] [config] lemma-dim-emb: 0
[2023-06-30 22:38:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:01] [config] log-level: info
[2023-06-30 22:38:01] [config] log-time-zone: ""
[2023-06-30 22:38:01] [config] logical-epoch:
[2023-06-30 22:38:01] [config]   - 1e
[2023-06-30 22:38:01] [config]   - 0
[2023-06-30 22:38:01] [config] lr-decay: 0
[2023-06-30 22:38:01] [config] lr-decay-freq: 50000
[2023-06-30 22:38:01] [config] lr-decay-inv-sqrt:
[2023-06-30 22:38:01] [config]   - 16000
[2023-06-30 22:38:01] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:38:01] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:38:01] [config] lr-decay-start:
[2023-06-30 22:38:01] [config]   - 10
[2023-06-30 22:38:01] [config]   - 1
[2023-06-30 22:38:01] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:38:01] [config] lr-report: true
[2023-06-30 22:38:01] [config] lr-warmup: 16000
[2023-06-30 22:38:01] [config] lr-warmup-at-reload: false
[2023-06-30 22:38:01] [config] lr-warmup-cycle: false
[2023-06-30 22:38:01] [config] lr-warmup-start-rate: 0
[2023-06-30 22:38:01] [config] max-length: 100
[2023-06-30 22:38:01] [config] max-length-crop: false
[2023-06-30 22:38:01] [config] max-length-factor: 3
[2023-06-30 22:38:01] [config] maxi-batch: 100
[2023-06-30 22:38:01] [config] maxi-batch-sort: trg
[2023-06-30 22:38:01] [config] mini-batch: 1000
[2023-06-30 22:38:01] [config] mini-batch-fit: true
[2023-06-30 22:38:01] [config] mini-batch-fit-step: 10
[2023-06-30 22:38:01] [config] mini-batch-round-up: true
[2023-06-30 22:38:01] [config] mini-batch-track-lr: false
[2023-06-30 22:38:01] [config] mini-batch-warmup: 0
[2023-06-30 22:38:01] [config] mini-batch-words: 0
[2023-06-30 22:38:01] [config] mini-batch-words-ref: 0
[2023-06-30 22:38:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:01] [config] multi-loss-type: sum
[2023-06-30 22:38:01] [config] n-best: false
[2023-06-30 22:38:01] [config] no-nccl: false
[2023-06-30 22:38:01] [config] no-reload: false
[2023-06-30 22:38:01] [config] no-restore-corpus: false
[2023-06-30 22:38:01] [config] normalize: 1
[2023-06-30 22:38:01] [config] normalize-gradient: false
[2023-06-30 22:38:01] [config] num-devices: 0
[2023-06-30 22:38:01] [config] optimizer: adam
[2023-06-30 22:38:01] [config] optimizer-delay: 1
[2023-06-30 22:38:01] [config] optimizer-params:
[2023-06-30 22:38:01] [config]   - 0.9
[2023-06-30 22:38:01] [config]   - 0.98
[2023-06-30 22:38:01] [config]   - 1e-09
[2023-06-30 22:38:01] [config] output-omit-bias: false
[2023-06-30 22:38:01] [config] overwrite: true
[2023-06-30 22:38:01] [config] precision:
[2023-06-30 22:38:01] [config]   - float32
[2023-06-30 22:38:01] [config]   - float32
[2023-06-30 22:38:01] [config] pretrained-model: ""
[2023-06-30 22:38:01] [config] quantize-biases: false
[2023-06-30 22:38:01] [config] quantize-bits: 0
[2023-06-30 22:38:01] [config] quantize-log-based: false
[2023-06-30 22:38:01] [config] quantize-optimization-steps: 0
[2023-06-30 22:38:01] [config] quiet: false
[2023-06-30 22:38:01] [config] quiet-translation: true
[2023-06-30 22:38:01] [config] relative-paths: false
[2023-06-30 22:38:01] [config] right-left: false
[2023-06-30 22:38:01] [config] save-freq: 10000u
[2023-06-30 22:38:01] [config] seed: 1234
[2023-06-30 22:38:01] [config] sentencepiece-alphas:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:38:01] [config] sentencepiece-options: ""
[2023-06-30 22:38:01] [config] sharding: global
[2023-06-30 22:38:01] [config] shuffle: data
[2023-06-30 22:38:01] [config] shuffle-in-ram: false
[2023-06-30 22:38:01] [config] sigterm: save-and-exit
[2023-06-30 22:38:01] [config] skip: false
[2023-06-30 22:38:01] [config] sqlite: ""
[2023-06-30 22:38:01] [config] sqlite-drop: false
[2023-06-30 22:38:01] [config] sync-freq: 200u
[2023-06-30 22:38:01] [config] sync-sgd: true
[2023-06-30 22:38:01] [config] tempdir: /tmp
[2023-06-30 22:38:01] [config] tied-embeddings: false
[2023-06-30 22:38:01] [config] tied-embeddings-all: false
[2023-06-30 22:38:01] [config] tied-embeddings-src: false
[2023-06-30 22:38:01] [config] train-embedder-rank:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] train-sets:
[2023-06-30 22:38:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:38:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:38:01] [config] transformer-aan-activation: swish
[2023-06-30 22:38:01] [config] transformer-aan-depth: 2
[2023-06-30 22:38:01] [config] transformer-aan-nogate: false
[2023-06-30 22:38:01] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:38:01] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:38:01] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:38:01] [config] transformer-depth-scaling: false
[2023-06-30 22:38:01] [config] transformer-dim-aan: 2048
[2023-06-30 22:38:01] [config] transformer-dim-ffn: 2048
[2023-06-30 22:38:01] [config] transformer-dropout: 0.1
[2023-06-30 22:38:01] [config] transformer-dropout-attention: 0
[2023-06-30 22:38:01] [config] transformer-dropout-ffn: 0
[2023-06-30 22:38:01] [config] transformer-ffn-activation: swish
[2023-06-30 22:38:01] [config] transformer-ffn-depth: 2
[2023-06-30 22:38:01] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:38:01] [config] transformer-heads: 8
[2023-06-30 22:38:01] [config] transformer-no-projection: false
[2023-06-30 22:38:01] [config] transformer-pool: false
[2023-06-30 22:38:01] [config] transformer-postprocess: dan
[2023-06-30 22:38:01] [config] transformer-postprocess-emb: d
[2023-06-30 22:38:01] [config] transformer-postprocess-top: ""
[2023-06-30 22:38:01] [config] transformer-preprocess: ""
[2023-06-30 22:38:01] [config] transformer-tied-layers:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] transformer-train-position-embeddings: false
[2023-06-30 22:38:01] [config] tsv: false
[2023-06-30 22:38:01] [config] tsv-fields: 0
[2023-06-30 22:38:01] [config] type: transformer
[2023-06-30 22:38:01] [config] ulr: false
[2023-06-30 22:38:01] [config] ulr-dim-emb: 0
[2023-06-30 22:38:01] [config] ulr-dropout: 0
[2023-06-30 22:38:01] [config] ulr-keys-vectors: ""
[2023-06-30 22:38:01] [config] ulr-query-vectors: ""
[2023-06-30 22:38:01] [config] ulr-softmax-temperature: 1
[2023-06-30 22:38:01] [config] ulr-trainable-transformation: false
[2023-06-30 22:38:01] [config] unlikelihood-loss: false
[2023-06-30 22:38:01] [config] valid-freq: 50000000
[2023-06-30 22:38:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:01] [config] valid-max-length: 1000
[2023-06-30 22:38:01] [config] valid-metrics:
[2023-06-30 22:38:01] [config]   - cross-entropy
[2023-06-30 22:38:01] [config]   - translation
[2023-06-30 22:38:01] [config] valid-mini-batch: 64
[2023-06-30 22:38:01] [config] valid-reset-stalled: false
[2023-06-30 22:38:01] [config] valid-script-args:
[2023-06-30 22:38:01] [config]   []
[2023-06-30 22:38:01] [config] valid-script-path: ""
[2023-06-30 22:38:01] [config] valid-sets:
[2023-06-30 22:38:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:38:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:38:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:38:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:01] [config] vocabs:
[2023-06-30 22:38:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:01] [config] word-penalty: 0
[2023-06-30 22:38:01] [config] word-scores: false
[2023-06-30 22:38:01] [config] workspace: 2048
[2023-06-30 22:38:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:01] Using synchronous SGD
[2023-06-30 22:38:01] Synced seed 1234
[2023-06-30 22:38:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:38:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:38:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:38:01] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:38:06] Seen 18,843 samples
[2023-06-30 22:38:06] Starting data epoch 37 in logical epoch 37
[2023-06-30 22:38:06] [data] Shuffling data
[2023-06-30 22:38:06] [data] Done reading 20,192 sentences
[2023-06-30 22:38:06] [data] Done shuffling 20,192 sentences to temp files
2:38:02] [training] Using 1 GPUs
[2023-06-30 22:38:02] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:38:02] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:38:02] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:10] [batching] Done. Typical MB size is 6,776 target words
[2023-06-30 22:38:10] [valid] No post-processing script given for validating translator
[2023-06-30 22:38:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:38:10] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:38:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:38:10] [comm] Using global sharding
[2023-06-30 22:38:10] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:38:10] [training] Using 1 GPUs
[2023-06-30 22:38:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:11] [warn] Average not found in .npz file
[2023-06-30 22:38:11] Loading Adam parameters
[2023-06-30 22:38:12] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:38:12] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:38:12] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:38:12] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:38:12] [data] Shuffling data
[2023-06-30 22:38:12] [data] Done reading 20,192 sentences
[2023-06-30 22:38:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:38:12] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:38:12] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263

[CALL STACK]
[0x561e9395026c]    marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x88c
[0x561e93950b3f]    marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>) + 0x4bf
[0x561e939571a9]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x23d9
[0x561e93877058]    mainTrainer  (int,  char**)                        + 0x158
[0x561e9382eb9c]    main                                               + 0x3c
[0x7f23b44ef0b3]    __libc_start_main                                  + 0xf3
[0x561e93875cbe]    _start                                             + 0x2e

[2023-06-30 22:38:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:16] [marian] Running on node23.datos.cluster.uy as process 34788 with command line:
[2023-06-30 22:38:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 5 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:38:16] [config] after: 0e
[2023-06-30 22:38:16] [config] after-batches: 0
[2023-06-30 22:38:16] [config] after-epochs: 5
[2023-06-30 22:38:16] [config] all-caps-every: 0
[2023-06-30 22:38:16] [config] allow-unk: false
[2023-06-30 22:38:16] [config] authors: false
[2023-06-30 22:38:16] [config] beam-size: 12
[2023-06-30 22:38:16] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:38:16] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:38:16] [config] bert-masking-fraction: 0.15
[2023-06-30 22:38:16] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:38:16] [config] bert-train-type-embeddings: true
[2023-06-30 22:38:16] [config] bert-type-vocab-size: 2
[2023-06-30 22:38:16] [config] build-info: ""
[2023-06-30 22:38:16] [config] check-gradient-nan: false
[2023-06-30 22:38:16] [config] check-nan: false
[2023-06-30 22:38:16] [config] cite: false
[2023-06-30 22:38:16] [config] clip-norm: 5
[2023-06-30 22:38:16] [config] cost-scaling:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] cost-type: ce-sum
[2023-06-30 22:38:16] [config] cpu-threads: 0
[2023-06-30 22:38:16] [config] data-threads: 8
[2023-06-30 22:38:16] [config] data-weighting: ""
[2023-06-30 22:38:16] [config] data-weighting-type: sentence
[2023-06-30 22:38:16] [config] dec-cell: gru
[2023-06-30 22:38:16] [config] dec-cell-base-depth: 2
[2023-06-30 22:38:16] [config] dec-cell-high-depth: 1
[2023-06-30 22:38:16] [config] dec-depth: 1
[2023-06-30 22:38:16] [config] devices:
[2023-06-30 22:38:16] [config]   - 0
[2023-06-30 22:38:16] [config] dim-emb: 512
[2023-06-30 22:38:16] [config] dim-rnn: 1024
[2023-06-30 22:38:16] [config] dim-vocabs:
[2023-06-30 22:38:16] [config]   - 54042
[2023-06-30 22:38:16] [config]   - 36507
[2023-06-30 22:38:16] [config] disp-first: 0
[2023-06-30 22:38:16] [config] disp-freq: 1000u
[2023-06-30 22:38:16] [config] disp-label-counts: true
[2023-06-30 22:38:16] [config] dropout-rnn: 0
[2023-06-30 22:38:16] [config] dropout-src: 0
[2023-06-30 22:38:16] [config] dropout-trg: 0
[2023-06-30 22:38:16] [config] dump-config: ""
[2023-06-30 22:38:16] [config] dynamic-gradient-scaling:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] early-stopping: 10
[2023-06-30 22:38:16] [config] early-stopping-on: first
[2023-06-30 22:38:16] [config] embedding-fix-src: false
[2023-06-30 22:38:16] [config] embedding-fix-trg: false
[2023-06-30 22:38:16] [config] embedding-normalization: false
[2023-06-30 22:38:16] [config] embedding-vectors:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] enc-cell: gru
[2023-06-30 22:38:16] [config] enc-cell-depth: 1
[2023-06-30 22:38:16] [config] enc-depth: 1
[2023-06-30 22:38:16] [config] enc-type: bidirectional
[2023-06-30 22:38:16] [config] english-title-case-every: 0
[2023-06-30 22:38:16] [config] exponential-smoothing: 0.0001
[2023-06-30 22:38:16] [config] factor-weight: 1
[2023-06-30 22:38:16] [config] factors-combine: sum
[2023-06-30 22:38:16] [config] factors-dim-emb: 0
[2023-06-30 22:38:16] [config] gradient-checkpointing: false
[2023-06-30 22:38:16] [config] gradient-norm-average-window: 100
[2023-06-30 22:38:16] [config] guided-alignment: none
[2023-06-30 22:38:16] [config] guided-alignment-cost: mse
[2023-06-30 22:38:16] [config] guided-alignment-weight: 0.1
[2023-06-30 22:38:16] [config] ignore-model-config: false
[2023-06-30 22:38:16] [config] input-types:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] interpolate-env-vars: false
[2023-06-30 22:38:16] [config] keep-best: false
[2023-06-30 22:38:16] [config] label-smoothing: 0.1
[2023-06-30 22:38:16] [config] layer-normalization: false
[2023-06-30 22:38:16] [config] learn-rate: 0.0003
[2023-06-30 22:38:16] [config] lemma-dependency: ""
[2023-06-30 22:38:16] [config] lemma-dim-emb: 0
[2023-06-30 22:38:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:16] [config] log-level: info
[2023-06-30 22:38:16] [config] log-time-zone: ""
[2023-06-30 22:38:16] [config] logical-epoch:
[2023-06-30 22:38:16] [config]   - 1e
[2023-06-30 22:38:16] [config]   - 0
[2023-06-30 22:38:16] [config] lr-decay: 0
[2023-06-30 22:38:16] [config] lr-decay-freq: 50000
[2023-06-30 22:38:16] [config] lr-decay-inv-sqrt:
[2023-06-30 22:38:16] [config]   - 16000
[2023-06-30 22:38:16] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:38:16] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:38:16] [config] lr-decay-start:
[2023-06-30 22:38:16] [config]   - 10
[2023-06-30 22:38:16] [config]   - 1
[2023-06-30 22:38:16] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:38:16] [config] lr-report: true
[2023-06-30 22:38:16] [config] lr-warmup: 16000
[2023-06-30 22:38:16] [config] lr-warmup-at-reload: false
[2023-06-30 22:38:16] [config] lr-warmup-cycle: false
[2023-06-30 22:38:16] [config] lr-warmup-start-rate: 0
[2023-06-30 22:38:16] [config] max-length: 100
[2023-06-30 22:38:16] [config] max-length-crop: false
[2023-06-30 22:38:16] [config] max-length-factor: 3
[2023-06-30 22:38:16] [config] maxi-batch: 100
[2023-06-30 22:38:16] [config] maxi-batch-sort: trg
[2023-06-30 22:38:16] [config] mini-batch: 1000
[2023-06-30 22:38:16] [config] mini-batch-fit: true
[2023-06-30 22:38:16] [config] mini-batch-fit-step: 10
[2023-06-30 22:38:16] [config] mini-batch-round-up: true
[2023-06-30 22:38:16] [config] mini-batch-track-lr: false
[2023-06-30 22:38:16] [config] mini-batch-warmup: 0
[2023-06-30 22:38:16] [config] mini-batch-words: 0
[2023-06-30 22:38:16] [config] mini-batch-words-ref: 0
[2023-06-30 22:38:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:16] [config] multi-loss-type: sum
[2023-06-30 22:38:16] [config] n-best: false
[2023-06-30 22:38:16] [config] no-nccl: false
[2023-06-30 22:38:16] [config] no-reload: false
[2023-06-30 22:38:16] [config] no-restore-corpus: false
[2023-06-30 22:38:16] [config] normalize: 1
[2023-06-30 22:38:16] [config] normalize-gradient: false
[2023-06-30 22:38:16] [config] num-devices: 0
[2023-06-30 22:38:16] [config] optimizer: adam
[2023-06-30 22:38:16] [config] optimizer-delay: 1
[2023-06-30 22:38:16] [config] optimizer-params:
[2023-06-30 22:38:16] [config]   - 0.9
[2023-06-30 22:38:16] [config]   - 0.98
[2023-06-30 22:38:16] [config]   - 1e-09
[2023-06-30 22:38:16] [config] output-omit-bias: false
[2023-06-30 22:38:16] [config] overwrite: true
[2023-06-30 22:38:16] [config] precision:
[2023-06-30 22:38:16] [config]   - float32
[2023-06-30 22:38:16] [config]   - float32
[2023-06-30 22:38:16] [config] pretrained-model: ""
[2023-06-30 22:38:16] [config] quantize-biases: false
[2023-06-30 22:38:16] [config] quantize-bits: 0
[2023-06-30 22:38:16] [config] quantize-log-based: false
[2023-06-30 22:38:16] [config] quantize-optimization-steps: 0
[2023-06-30 22:38:16] [config] quiet: false
[2023-06-30 22:38:16] [config] quiet-translation: true
[2023-06-30 22:38:16] [config] relative-paths: false
[2023-06-30 22:38:16] [config] right-left: false
[2023-06-30 22:38:16] [config] save-freq: 10000u
[2023-06-30 22:38:16] [config] seed: 1234
[2023-06-30 22:38:16] [config] sentencepiece-alphas:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:38:16] [config] sentencepiece-options: ""
[2023-06-30 22:38:16] [config] sharding: global
[2023-06-30 22:38:16] [config] shuffle: data
[2023-06-30 22:38:16] [config] shuffle-in-ram: false
[2023-06-30 22:38:16] [config] sigterm: save-and-exit
[2023-06-30 22:38:16] [config] skip: false
[2023-06-30 22:38:16] [config] sqlite: ""
[2023-06-30 22:38:16] [config] sqlite-drop: false
[2023-06-30 22:38:16] [config] sync-freq: 200u
[2023-06-30 22:38:16] [config] sync-sgd: true
[2023-06-30 22:38:16] [config] tempdir: /tmp
[2023-06-30 22:38:16] [config] tied-embeddings: false
[2023-06-30 22:38:16] [config] tied-embeddings-all: false
[2023-06-30 22:38:16] [config] tied-embeddings-src: false
[2023-06-30 22:38:16] [config] train-embedder-rank:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] train-sets:
[2023-06-30 22:38:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:38:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:38:16] [config] transformer-aan-activation: swish
[2023-06-30 22:38:16] [config] transformer-aan-depth: 2
[2023-06-30 22:38:16] [config] transformer-aan-nogate: false
[2023-06-30 22:38:16] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:38:16] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:38:16] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:38:16] [config] transformer-depth-scaling: false
[2023-06-30 22:38:16] [config] transformer-dim-aan: 2048
[2023-06-30 22:38:16] [config] transformer-dim-ffn: 2048
[2023-06-30 22:38:16] [config] transformer-dropout: 0.1
[2023-06-30 22:38:16] [config] transformer-dropout-attention: 0
[2023-06-30 22:38:16] [config] transformer-dropout-ffn: 0
[2023-06-30 22:38:16] [config] transformer-ffn-activation: swish
[2023-06-30 22:38:16] [config] transformer-ffn-depth: 2
[2023-06-30 22:38:16] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:38:16] [config] transformer-heads: 8
[2023-06-30 22:38:16] [config] transformer-no-projection: false
[2023-06-30 22:38:16] [config] transformer-pool: false
[2023-06-30 22:38:16] [config] transformer-postprocess: dan
[2023-06-30 22:38:16] [config] transformer-postprocess-emb: d
[2023-06-30 22:38:16] [config] transformer-postprocess-top: ""
[2023-06-30 22:38:16] [config] transformer-preprocess: ""
[2023-06-30 22:38:16] [config] transformer-tied-layers:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] transformer-train-position-embeddings: false
[2023-06-30 22:38:16] [config] tsv: false
[2023-06-30 22:38:16] [config] tsv-fields: 0
[2023-06-30 22:38:16] [config] type: transformer
[2023-06-30 22:38:16] [config] ulr: false
[2023-06-30 22:38:16] [config] ulr-dim-emb: 0
[2023-06-30 22:38:16] [config] ulr-dropout: 0
[2023-06-30 22:38:16] [config] ulr-keys-vectors: ""
[2023-06-30 22:38:16] [config] ulr-query-vectors: ""
[2023-06-30 22:38:16] [config] ulr-softmax-temperature: 1
[2023-06-30 22:38:16] [config] ulr-trainable-transformation: false
[2023-06-30 22:38:16] [config] unlikelihood-loss: false
[2023-06-30 22:38:16] [config] valid-freq: 50000000
[2023-06-30 22:38:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:16] [config] valid-max-length: 1000
[2023-06-30 22:38:16] [config] valid-metrics:
[2023-06-30 22:38:16] [config]   - cross-entropy
[2023-06-30 22:38:16] [config]   - translation
[2023-06-30 22:38:16] [config] valid-mini-batch: 64
[2023-06-30 22:38:16] [config] valid-reset-stalled: false
[2023-06-30 22:38:16] [config] valid-script-args:
[2023-06-30 22:38:16] [config]   []
[2023-06-30 22:38:16] [config] valid-script-path: ""
[2023-06-30 22:38:16] [config] valid-sets:
[2023-06-30 22:38:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:38:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:38:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:38:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:16] [config] vocabs:
[2023-06-30 22:38:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:16] [config] word-penalty: 0
[2023-06-30 22:38:16] [config] word-scores: false
[2023-06-30 22:38:16] [config] workspace: 2048
[2023-06-30 22:38:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:16] Using synchronous SGD
[2023-06-30 22:38:16] Synced seed 1234
[2023-06-30 22:38:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:38:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:38:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:38:16] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:38:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:38:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:38:17] [comm] Using global sharding
[2023-06-30 22:38:17] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:38:17] [training] Using 1 GPUs
[2023-06-30 22:38:17] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:38:17] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:17] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:38:17] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:25] [batching] Done. Typical MB size is 6,776 target words
[2023-06-30 22:38:26] Seen 18,843 samples
[2023-06-30 22:38:26] Starting data epoch 38 in logical epoch 38
[2023-06-30 22:38:26] [data] Shuffling data
[2023-06-30 22:38:26] [data] Done reading 20,192 sentences
[2023-06-30 22:38:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:38:28] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 0.02011804 * 1,344,952 @ 1,403 after 14,764,838 : Time 74.32s : 18095.94 words/s : gNorm 0.5919
g] Using 1 GPUs
[2023-06-30 22:38:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:26] [warn] Average not found in .npz file
[2023-06-30 22:38:26] Loading Adam parameters
[2023-06-30 22:38:26] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:38:27] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:38:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:38:27] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:38:27] [data] Shuffling data
[2023-06-30 22:38:27] [data] Done reading 20,192 sentences
[2023-06-30 22:38:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:38:27] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:38:27] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263

[CALL STACK]
[0x55752202b26c]    marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x88c
[0x55752202bb3f]    marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>) + 0x4bf
[0x5575220321a9]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x23d9
[0x557521f52058]    mainTrainer  (int,  char**)                        + 0x158
[0x557521f09b9c]    main                                               + 0x3c
[0x7fc0f5d2d0b3]    __libc_start_main                                  + 0xf3
[0x557521f50cbe]    _start                                             + 0x2e

[2023-06-30 22:38:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:30] [marian] Running on node23.datos.cluster.uy as process 34848 with command line:
[2023-06-30 22:38:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 6 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:38:30] [config] after: 0e
[2023-06-30 22:38:30] [config] after-batches: 0
[2023-06-30 22:38:30] [config] after-epochs: 6
[2023-06-30 22:38:30] [config] all-caps-every: 0
[2023-06-30 22:38:30] [config] allow-unk: false
[2023-06-30 22:38:30] [config] authors: false
[2023-06-30 22:38:30] [config] beam-size: 12
[2023-06-30 22:38:30] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:38:30] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:38:30] [config] bert-masking-fraction: 0.15
[2023-06-30 22:38:30] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:38:30] [config] bert-train-type-embeddings: true
[2023-06-30 22:38:30] [config] bert-type-vocab-size: 2
[2023-06-30 22:38:30] [config] build-info: ""
[2023-06-30 22:38:30] [config] check-gradient-nan: false
[2023-06-30 22:38:30] [config] check-nan: false
[2023-06-30 22:38:30] [config] cite: false
[2023-06-30 22:38:30] [config] clip-norm: 5
[2023-06-30 22:38:30] [config] cost-scaling:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] cost-type: ce-sum
[2023-06-30 22:38:30] [config] cpu-threads: 0
[2023-06-30 22:38:30] [config] data-threads: 8
[2023-06-30 22:38:30] [config] data-weighting: ""
[2023-06-30 22:38:30] [config] data-weighting-type: sentence
[2023-06-30 22:38:30] [config] dec-cell: gru
[2023-06-30 22:38:30] [config] dec-cell-base-depth: 2
[2023-06-30 22:38:30] [config] dec-cell-high-depth: 1
[2023-06-30 22:38:30] [config] dec-depth: 1
[2023-06-30 22:38:30] [config] devices:
[2023-06-30 22:38:30] [config]   - 0
[2023-06-30 22:38:30] [config] dim-emb: 512
[2023-06-30 22:38:30] [config] dim-rnn: 1024
[2023-06-30 22:38:30] [config] dim-vocabs:
[2023-06-30 22:38:30] [config]   - 54042
[2023-06-30 22:38:30] [config]   - 36507
[2023-06-30 22:38:30] [config] disp-first: 0
[2023-06-30 22:38:30] [config] disp-freq: 1000u
[2023-06-30 22:38:30] [config] disp-label-counts: true
[2023-06-30 22:38:30] [config] dropout-rnn: 0
[2023-06-30 22:38:30] [config] dropout-src: 0
[2023-06-30 22:38:30] [config] dropout-trg: 0
[2023-06-30 22:38:30] [config] dump-config: ""
[2023-06-30 22:38:30] [config] dynamic-gradient-scaling:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] early-stopping: 10
[2023-06-30 22:38:30] [config] early-stopping-on: first
[2023-06-30 22:38:30] [config] embedding-fix-src: false
[2023-06-30 22:38:30] [config] embedding-fix-trg: false
[2023-06-30 22:38:30] [config] embedding-normalization: false
[2023-06-30 22:38:30] [config] embedding-vectors:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] enc-cell: gru
[2023-06-30 22:38:30] [config] enc-cell-depth: 1
[2023-06-30 22:38:30] [config] enc-depth: 1
[2023-06-30 22:38:30] [config] enc-type: bidirectional
[2023-06-30 22:38:30] [config] english-title-case-every: 0
[2023-06-30 22:38:30] [config] exponential-smoothing: 0.0001
[2023-06-30 22:38:30] [config] factor-weight: 1
[2023-06-30 22:38:30] [config] factors-combine: sum
[2023-06-30 22:38:30] [config] factors-dim-emb: 0
[2023-06-30 22:38:30] [config] gradient-checkpointing: false
[2023-06-30 22:38:30] [config] gradient-norm-average-window: 100
[2023-06-30 22:38:30] [config] guided-alignment: none
[2023-06-30 22:38:30] [config] guided-alignment-cost: mse
[2023-06-30 22:38:30] [config] guided-alignment-weight: 0.1
[2023-06-30 22:38:30] [config] ignore-model-config: false
[2023-06-30 22:38:30] [config] input-types:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] interpolate-env-vars: false
[2023-06-30 22:38:30] [config] keep-best: false
[2023-06-30 22:38:30] [config] label-smoothing: 0.1
[2023-06-30 22:38:30] [config] layer-normalization: false
[2023-06-30 22:38:30] [config] learn-rate: 0.0003
[2023-06-30 22:38:30] [config] lemma-dependency: ""
[2023-06-30 22:38:30] [config] lemma-dim-emb: 0
[2023-06-30 22:38:30] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:30] [config] log-level: info
[2023-06-30 22:38:30] [config] log-time-zone: ""
[2023-06-30 22:38:30] [config] logical-epoch:
[2023-06-30 22:38:30] [config]   - 1e
[2023-06-30 22:38:30] [config]   - 0
[2023-06-30 22:38:30] [config] lr-decay: 0
[2023-06-30 22:38:30] [config] lr-decay-freq: 50000
[2023-06-30 22:38:30] [config] lr-decay-inv-sqrt:
[2023-06-30 22:38:30] [config]   - 16000
[2023-06-30 22:38:30] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:38:30] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:38:30] [config] lr-decay-start:
[2023-06-30 22:38:30] [config]   - 10
[2023-06-30 22:38:30] [config]   - 1
[2023-06-30 22:38:30] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:38:30] [config] lr-report: true
[2023-06-30 22:38:30] [config] lr-warmup: 16000
[2023-06-30 22:38:30] [config] lr-warmup-at-reload: false
[2023-06-30 22:38:30] [config] lr-warmup-cycle: false
[2023-06-30 22:38:30] [config] lr-warmup-start-rate: 0
[2023-06-30 22:38:30] [config] max-length: 100
[2023-06-30 22:38:30] [config] max-length-crop: false
[2023-06-30 22:38:30] [config] max-length-factor: 3
[2023-06-30 22:38:30] [config] maxi-batch: 100
[2023-06-30 22:38:30] [config] maxi-batch-sort: trg
[2023-06-30 22:38:30] [config] mini-batch: 1000
[2023-06-30 22:38:30] [config] mini-batch-fit: true
[2023-06-30 22:38:30] [config] mini-batch-fit-step: 10
[2023-06-30 22:38:30] [config] mini-batch-round-up: true
[2023-06-30 22:38:30] [config] mini-batch-track-lr: false
[2023-06-30 22:38:30] [config] mini-batch-warmup: 0
[2023-06-30 22:38:30] [config] mini-batch-words: 0
[2023-06-30 22:38:30] [config] mini-batch-words-ref: 0
[2023-06-30 22:38:30] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:30] [config] multi-loss-type: sum
[2023-06-30 22:38:30] [config] n-best: false
[2023-06-30 22:38:30] [config] no-nccl: false
[2023-06-30 22:38:30] [config] no-reload: false
[2023-06-30 22:38:30] [config] no-restore-corpus: false
[2023-06-30 22:38:30] [config] normalize: 1
[2023-06-30 22:38:30] [config] normalize-gradient: false
[2023-06-30 22:38:30] [config] num-devices: 0
[2023-06-30 22:38:30] [config] optimizer: adam
[2023-06-30 22:38:30] [config] optimizer-delay: 1
[2023-06-30 22:38:30] [config] optimizer-params:
[2023-06-30 22:38:30] [config]   - 0.9
[2023-06-30 22:38:30] [config]   - 0.98
[2023-06-30 22:38:30] [config]   - 1e-09
[2023-06-30 22:38:30] [config] output-omit-bias: false
[2023-06-30 22:38:30] [config] overwrite: true
[2023-06-30 22:38:30] [config] precision:
[2023-06-30 22:38:30] [config]   - float32
[2023-06-30 22:38:30] [config]   - float32
[2023-06-30 22:38:30] [config] pretrained-model: ""
[2023-06-30 22:38:30] [config] quantize-biases: false
[2023-06-30 22:38:30] [config] quantize-bits: 0
[2023-06-30 22:38:30] [config] quantize-log-based: false
[2023-06-30 22:38:30] [config] quantize-optimization-steps: 0
[2023-06-30 22:38:30] [config] quiet: false
[2023-06-30 22:38:30] [config] quiet-translation: true
[2023-06-30 22:38:30] [config] relative-paths: false
[2023-06-30 22:38:30] [config] right-left: false
[2023-06-30 22:38:30] [config] save-freq: 10000u
[2023-06-30 22:38:30] [config] seed: 1234
[2023-06-30 22:38:30] [config] sentencepiece-alphas:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:38:30] [config] sentencepiece-options: ""
[2023-06-30 22:38:30] [config] sharding: global
[2023-06-30 22:38:30] [config] shuffle: data
[2023-06-30 22:38:30] [config] shuffle-in-ram: false
[2023-06-30 22:38:30] [config] sigterm: save-and-exit
[2023-06-30 22:38:30] [config] skip: false
[2023-06-30 22:38:30] [config] sqlite: ""
[2023-06-30 22:38:30] [config] sqlite-drop: false
[2023-06-30 22:38:30] [config] sync-freq: 200u
[2023-06-30 22:38:30] [config] sync-sgd: true
[2023-06-30 22:38:30] [config] tempdir: /tmp
[2023-06-30 22:38:30] [config] tied-embeddings: false
[2023-06-30 22:38:30] [config] tied-embeddings-all: false
[2023-06-30 22:38:30] [config] tied-embeddings-src: false
[2023-06-30 22:38:30] [config] train-embedder-rank:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] train-sets:
[2023-06-30 22:38:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:38:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:38:30] [config] transformer-aan-activation: swish
[2023-06-30 22:38:30] [config] transformer-aan-depth: 2
[2023-06-30 22:38:30] [config] transformer-aan-nogate: false
[2023-06-30 22:38:30] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:38:30] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:38:30] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:38:30] [config] transformer-depth-scaling: false
[2023-06-30 22:38:30] [config] transformer-dim-aan: 2048
[2023-06-30 22:38:30] [config] transformer-dim-ffn: 2048
[2023-06-30 22:38:30] [config] transformer-dropout: 0.1
[2023-06-30 22:38:30] [config] transformer-dropout-attention: 0
[2023-06-30 22:38:30] [config] transformer-dropout-ffn: 0
[2023-06-30 22:38:30] [config] transformer-ffn-activation: swish
[2023-06-30 22:38:30] [config] transformer-ffn-depth: 2
[2023-06-30 22:38:30] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:38:30] [config] transformer-heads: 8
[2023-06-30 22:38:30] [config] transformer-no-projection: false
[2023-06-30 22:38:30] [config] transformer-pool: false
[2023-06-30 22:38:30] [config] transformer-postprocess: dan
[2023-06-30 22:38:30] [config] transformer-postprocess-emb: d
[2023-06-30 22:38:30] [config] transformer-postprocess-top: ""
[2023-06-30 22:38:30] [config] transformer-preprocess: ""
[2023-06-30 22:38:30] [config] transformer-tied-layers:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] transformer-train-position-embeddings: false
[2023-06-30 22:38:30] [config] tsv: false
[2023-06-30 22:38:30] [config] tsv-fields: 0
[2023-06-30 22:38:30] [config] type: transformer
[2023-06-30 22:38:30] [config] ulr: false
[2023-06-30 22:38:30] [config] ulr-dim-emb: 0
[2023-06-30 22:38:30] [config] ulr-dropout: 0
[2023-06-30 22:38:30] [config] ulr-keys-vectors: ""
[2023-06-30 22:38:30] [config] ulr-query-vectors: ""
[2023-06-30 22:38:30] [config] ulr-softmax-temperature: 1
[2023-06-30 22:38:30] [config] ulr-trainable-transformation: false
[2023-06-30 22:38:30] [config] unlikelihood-loss: false
[2023-06-30 22:38:30] [config] valid-freq: 50000000
[2023-06-30 22:38:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:30] [config] valid-max-length: 1000
[2023-06-30 22:38:30] [config] valid-metrics:
[2023-06-30 22:38:30] [config]   - cross-entropy
[2023-06-30 22:38:30] [config]   - translation
[2023-06-30 22:38:30] [config] valid-mini-batch: 64
[2023-06-30 22:38:30] [config] valid-reset-stalled: false
[2023-06-30 22:38:30] [config] valid-script-args:
[2023-06-30 22:38:30] [config]   []
[2023-06-30 22:38:30] [config] valid-script-path: ""
[2023-06-30 22:38:30] [config] valid-sets:
[2023-06-30 22:38:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:38:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:38:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:38:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:30] [config] vocabs:
[2023-06-30 22:38:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:30] [config] word-penalty: 0
[2023-06-30 22:38:30] [config] word-scores: false
[2023-06-30 22:38:30] [config] workspace: 2048
[2023-06-30 22:38:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:30] Using synchronous SGD
[2023-06-30 22:38:31] Synced seed 1234
[2023-06-30 22:38:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:38:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:38:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:38:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:38:31] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:38:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:38:32] [comm] Using global sharding
[2023-06-30 22:38:32] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:38:32] [training] Using 1 GPUs
[2023-06-30 22:38:32] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:38:32] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:38:32] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:40] [batching] Done. Typical MB size is 6,776 target words
[2023-06-30 22:38:40] [valid] No post-processing script given for validating translator
[2023-06-30 22:38:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:38:40] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:38:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:38:40] [comm] Using global sharding
[2023-06-30 22:38:40] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:38:40] [training] Using 1 GPUs
[2023-06-30 22:38:40] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:41] [warn] Average not found in .npz file
[2023-06-30 22:38:41] Loading Adam parameters
[2023-06-30 22:38:41] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:38:41] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:38:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:38:41] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:38:41] [data] Shuffling data
[2023-06-30 22:38:41] [data] Done reading 20,192 sentences
[2023-06-30 22:38:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:38:42] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:38:42] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263

[CALL STACK]
[0x55f781bcb26c]    marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x88c
[0x55f781bcbb3f]    marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>) + 0x4bf
[0x55f781bd21a9]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x23d9
[0x55f781af2058]    mainTrainer  (int,  char**)                        + 0x158
[0x55f781aa9b9c]    main                                               + 0x3c
[0x7f91e81eb0b3]    __libc_start_main                                  + 0xf3
[0x55f781af0cbe]    _start                                             + 0x2e

[2023-06-30 22:38:45] Seen 18,843 samples
[2023-06-30 22:38:45] Starting data epoch 39 in logical epoch 39
[2023-06-30 22:38:45] [data] Shuffling data
[2023-06-30 22:38:45] [data] Done reading 20,192 sentences
[2023-06-30 22:38:45] [data] Done shuffling 20,192 sentences to temp files
rain/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 7 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:38:45] [config] after: 0e
[2023-06-30 22:38:45] [config] after-batches: 0
[2023-06-30 22:38:45] [config] after-epochs: 7
[2023-06-30 22:38:45] [config] all-caps-every: 0
[2023-06-30 22:38:45] [config] allow-unk: false
[2023-06-30 22:38:45] [config] authors: false
[2023-06-30 22:38:45] [config] beam-size: 12
[2023-06-30 22:38:45] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:38:45] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:38:45] [config] bert-masking-fraction: 0.15
[2023-06-30 22:38:45] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:38:45] [config] bert-train-type-embeddings: true
[2023-06-30 22:38:45] [config] bert-type-vocab-size: 2
[2023-06-30 22:38:45] [config] build-info: ""
[2023-06-30 22:38:45] [config] check-gradient-nan: false
[2023-06-30 22:38:45] [config] check-nan: false
[2023-06-30 22:38:45] [config] cite: false
[2023-06-30 22:38:45] [config] clip-norm: 5
[2023-06-30 22:38:45] [config] cost-scaling:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] cost-type: ce-sum
[2023-06-30 22:38:45] [config] cpu-threads: 0
[2023-06-30 22:38:45] [config] data-threads: 8
[2023-06-30 22:38:45] [config] data-weighting: ""
[2023-06-30 22:38:45] [config] data-weighting-type: sentence
[2023-06-30 22:38:45] [config] dec-cell: gru
[2023-06-30 22:38:45] [config] dec-cell-base-depth: 2
[2023-06-30 22:38:45] [config] dec-cell-high-depth: 1
[2023-06-30 22:38:45] [config] dec-depth: 1
[2023-06-30 22:38:45] [config] devices:
[2023-06-30 22:38:45] [config]   - 0
[2023-06-30 22:38:45] [config] dim-emb: 512
[2023-06-30 22:38:45] [config] dim-rnn: 1024
[2023-06-30 22:38:45] [config] dim-vocabs:
[2023-06-30 22:38:45] [config]   - 54042
[2023-06-30 22:38:45] [config]   - 36507
[2023-06-30 22:38:45] [config] disp-first: 0
[2023-06-30 22:38:45] [config] disp-freq: 1000u
[2023-06-30 22:38:45] [config] disp-label-counts: true
[2023-06-30 22:38:45] [config] dropout-rnn: 0
[2023-06-30 22:38:45] [config] dropout-src: 0
[2023-06-30 22:38:45] [config] dropout-trg: 0
[2023-06-30 22:38:45] [config] dump-config: ""
[2023-06-30 22:38:45] [config] dynamic-gradient-scaling:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] early-stopping: 10
[2023-06-30 22:38:45] [config] early-stopping-on: first
[2023-06-30 22:38:45] [config] embedding-fix-src: false
[2023-06-30 22:38:45] [config] embedding-fix-trg: false
[2023-06-30 22:38:45] [config] embedding-normalization: false
[2023-06-30 22:38:45] [config] embedding-vectors:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] enc-cell: gru
[2023-06-30 22:38:45] [config] enc-cell-depth: 1
[2023-06-30 22:38:45] [config] enc-depth: 1
[2023-06-30 22:38:45] [config] enc-type: bidirectional
[2023-06-30 22:38:45] [config] english-title-case-every: 0
[2023-06-30 22:38:45] [config] exponential-smoothing: 0.0001
[2023-06-30 22:38:45] [config] factor-weight: 1
[2023-06-30 22:38:45] [config] factors-combine: sum
[2023-06-30 22:38:45] [config] factors-dim-emb: 0
[2023-06-30 22:38:45] [config] gradient-checkpointing: false
[2023-06-30 22:38:45] [config] gradient-norm-average-window: 100
[2023-06-30 22:38:45] [config] guided-alignment: none
[2023-06-30 22:38:45] [config] guided-alignment-cost: mse
[2023-06-30 22:38:45] [config] guided-alignment-weight: 0.1
[2023-06-30 22:38:45] [config] ignore-model-config: false
[2023-06-30 22:38:45] [config] input-types:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] interpolate-env-vars: false
[2023-06-30 22:38:45] [config] keep-best: false
[2023-06-30 22:38:45] [config] label-smoothing: 0.1
[2023-06-30 22:38:45] [config] layer-normalization: false
[2023-06-30 22:38:45] [config] learn-rate: 0.0003
[2023-06-30 22:38:45] [config] lemma-dependency: ""
[2023-06-30 22:38:45] [config] lemma-dim-emb: 0
[2023-06-30 22:38:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:45] [config] log-level: info
[2023-06-30 22:38:45] [config] log-time-zone: ""
[2023-06-30 22:38:45] [config] logical-epoch:
[2023-06-30 22:38:45] [config]   - 1e
[2023-06-30 22:38:45] [config]   - 0
[2023-06-30 22:38:45] [config] lr-decay: 0
[2023-06-30 22:38:45] [config] lr-decay-freq: 50000
[2023-06-30 22:38:45] [config] lr-decay-inv-sqrt:
[2023-06-30 22:38:45] [config]   - 16000
[2023-06-30 22:38:45] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:38:45] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:38:45] [config] lr-decay-start:
[2023-06-30 22:38:45] [config]   - 10
[2023-06-30 22:38:45] [config]   - 1
[2023-06-30 22:38:45] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:38:45] [config] lr-report: true
[2023-06-30 22:38:45] [config] lr-warmup: 16000
[2023-06-30 22:38:45] [config] lr-warmup-at-reload: false
[2023-06-30 22:38:45] [config] lr-warmup-cycle: false
[2023-06-30 22:38:45] [config] lr-warmup-start-rate: 0
[2023-06-30 22:38:45] [config] max-length: 100
[2023-06-30 22:38:45] [config] max-length-crop: false
[2023-06-30 22:38:45] [config] max-length-factor: 3
[2023-06-30 22:38:45] [config] maxi-batch: 100
[2023-06-30 22:38:45] [config] maxi-batch-sort: trg
[2023-06-30 22:38:45] [config] mini-batch: 1000
[2023-06-30 22:38:45] [config] mini-batch-fit: true
[2023-06-30 22:38:45] [config] mini-batch-fit-step: 10
[2023-06-30 22:38:45] [config] mini-batch-round-up: true
[2023-06-30 22:38:45] [config] mini-batch-track-lr: false
[2023-06-30 22:38:45] [config] mini-batch-warmup: 0
[2023-06-30 22:38:45] [config] mini-batch-words: 0
[2023-06-30 22:38:45] [config] mini-batch-words-ref: 0
[2023-06-30 22:38:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:45] [config] multi-loss-type: sum
[2023-06-30 22:38:45] [config] n-best: false
[2023-06-30 22:38:45] [config] no-nccl: false
[2023-06-30 22:38:45] [config] no-reload: false
[2023-06-30 22:38:45] [config] no-restore-corpus: false
[2023-06-30 22:38:45] [config] normalize: 1
[2023-06-30 22:38:45] [config] normalize-gradient: false
[2023-06-30 22:38:45] [config] num-devices: 0
[2023-06-30 22:38:45] [config] optimizer: adam
[2023-06-30 22:38:45] [config] optimizer-delay: 1
[2023-06-30 22:38:45] [config] optimizer-params:
[2023-06-30 22:38:45] [config]   - 0.9
[2023-06-30 22:38:45] [config]   - 0.98
[2023-06-30 22:38:45] [config]   - 1e-09
[2023-06-30 22:38:45] [config] output-omit-bias: false
[2023-06-30 22:38:45] [config] overwrite: true
[2023-06-30 22:38:45] [config] precision:
[2023-06-30 22:38:45] [config]   - float32
[2023-06-30 22:38:45] [config]   - float32
[2023-06-30 22:38:45] [config] pretrained-model: ""
[2023-06-30 22:38:45] [config] quantize-biases: false
[2023-06-30 22:38:45] [config] quantize-bits: 0
[2023-06-30 22:38:45] [config] quantize-log-based: false
[2023-06-30 22:38:45] [config] quantize-optimization-steps: 0
[2023-06-30 22:38:45] [config] quiet: false
[2023-06-30 22:38:45] [config] quiet-translation: true
[2023-06-30 22:38:45] [config] relative-paths: false
[2023-06-30 22:38:45] [config] right-left: false
[2023-06-30 22:38:45] [config] save-freq: 10000u
[2023-06-30 22:38:45] [config] seed: 1234
[2023-06-30 22:38:45] [config] sentencepiece-alphas:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:38:45] [config] sentencepiece-options: ""
[2023-06-30 22:38:45] [config] sharding: global
[2023-06-30 22:38:45] [config] shuffle: data
[2023-06-30 22:38:45] [config] shuffle-in-ram: false
[2023-06-30 22:38:45] [config] sigterm: save-and-exit
[2023-06-30 22:38:45] [config] skip: false
[2023-06-30 22:38:45] [config] sqlite: ""
[2023-06-30 22:38:45] [config] sqlite-drop: false
[2023-06-30 22:38:45] [config] sync-freq: 200u
[2023-06-30 22:38:45] [config] sync-sgd: true
[2023-06-30 22:38:45] [config] tempdir: /tmp
[2023-06-30 22:38:45] [config] tied-embeddings: false
[2023-06-30 22:38:45] [config] tied-embeddings-all: false
[2023-06-30 22:38:45] [config] tied-embeddings-src: false
[2023-06-30 22:38:45] [config] train-embedder-rank:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] train-sets:
[2023-06-30 22:38:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:38:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:38:45] [config] transformer-aan-activation: swish
[2023-06-30 22:38:45] [config] transformer-aan-depth: 2
[2023-06-30 22:38:45] [config] transformer-aan-nogate: false
[2023-06-30 22:38:45] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:38:45] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:38:45] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:38:45] [config] transformer-depth-scaling: false
[2023-06-30 22:38:45] [config] transformer-dim-aan: 2048
[2023-06-30 22:38:45] [config] transformer-dim-ffn: 2048
[2023-06-30 22:38:45] [config] transformer-dropout: 0.1
[2023-06-30 22:38:45] [config] transformer-dropout-attention: 0
[2023-06-30 22:38:45] [config] transformer-dropout-ffn: 0
[2023-06-30 22:38:45] [config] transformer-ffn-activation: swish
[2023-06-30 22:38:45] [config] transformer-ffn-depth: 2
[2023-06-30 22:38:45] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:38:45] [config] transformer-heads: 8
[2023-06-30 22:38:45] [config] transformer-no-projection: false
[2023-06-30 22:38:45] [config] transformer-pool: false
[2023-06-30 22:38:45] [config] transformer-postprocess: dan
[2023-06-30 22:38:45] [config] transformer-postprocess-emb: d
[2023-06-30 22:38:45] [config] transformer-postprocess-top: ""
[2023-06-30 22:38:45] [config] transformer-preprocess: ""
[2023-06-30 22:38:45] [config] transformer-tied-layers:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] transformer-train-position-embeddings: false
[2023-06-30 22:38:45] [config] tsv: false
[2023-06-30 22:38:45] [config] tsv-fields: 0
[2023-06-30 22:38:45] [config] type: transformer
[2023-06-30 22:38:45] [config] ulr: false
[2023-06-30 22:38:45] [config] ulr-dim-emb: 0
[2023-06-30 22:38:45] [config] ulr-dropout: 0
[2023-06-30 22:38:45] [config] ulr-keys-vectors: ""
[2023-06-30 22:38:45] [config] ulr-query-vectors: ""
[2023-06-30 22:38:45] [config] ulr-softmax-temperature: 1
[2023-06-30 22:38:45] [config] ulr-trainable-transformation: false
[2023-06-30 22:38:45] [config] unlikelihood-loss: false
[2023-06-30 22:38:45] [config] valid-freq: 50000000
[2023-06-30 22:38:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:38:45] [config] valid-max-length: 1000
[2023-06-30 22:38:45] [config] valid-metrics:
[2023-06-30 22:38:45] [config]   - cross-entropy
[2023-06-30 22:38:45] [config]   - translation
[2023-06-30 22:38:45] [config] valid-mini-batch: 64
[2023-06-30 22:38:45] [config] valid-reset-stalled: false
[2023-06-30 22:38:45] [config] valid-script-args:
[2023-06-30 22:38:45] [config]   []
[2023-06-30 22:38:45] [config] valid-script-path: ""
[2023-06-30 22:38:45] [config] valid-sets:
[2023-06-30 22:38:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:38:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:38:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:38:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:45] [config] vocabs:
[2023-06-30 22:38:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:45] [config] word-penalty: 0
[2023-06-30 22:38:45] [config] word-scores: false
[2023-06-30 22:38:45] [config] workspace: 2048
[2023-06-30 22:38:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:38:45] Using synchronous SGD
[2023-06-30 22:38:45] Synced seed 1234
[2023-06-30 22:38:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:38:45] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:38:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:38:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:38:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:38:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:38:46] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:38:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:38:46] [comm] Using global sharding
[2023-06-30 22:38:46] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:38:46] [training] Using 1 GPUs
[2023-06-30 22:38:46] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:38:46] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:38:47] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:38:54] [batching] Done. Typical MB size is 6,776 target words
[2023-06-30 22:38:54] [valid] No post-processing script given for validating translator
[2023-06-30 22:38:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:38:55] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:38:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:38:55] [comm] Using global sharding
[2023-06-30 22:38:55] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:38:55] [training] Using 1 GPUs
[2023-06-30 22:38:55] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:38:56] [warn] Average not found in .npz file
[2023-06-30 22:38:56] Loading Adam parameters
[2023-06-30 22:38:56] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:38:56] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:38:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:38:57] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:38:57] [data] Shuffling data
[2023-06-30 22:38:57] [data] Done reading 20,192 sentences
[2023-06-30 22:38:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:38:57] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:38:57] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263

[CALL STACK]
[0x5647ed66b26c]    marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x88c
[0x5647ed66bb3f]    marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>) + 0x4bf
[0x5647ed6721a9]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x23d9
[0x5647ed592058]    mainTrainer  (int,  char**)                        + 0x158
[0x5647ed549b9c]    main                                               + 0x3c
[0x7fd70f33d0b3]    __libc_start_main                                  + 0xf3
[0x5647ed590cbe]    _start                                             + 0x2e

[2023-06-30 22:39:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:39:00] [marian] Running on node23.datos.cluster.uy as process 34975 with command line:
[2023-06-30 22:39:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 8 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite --max-length 100 --mini-batch-fit --mini-batch 1000 --beam-size 12 --normalize 1 --valid-mini-batch 64 --enc-depth 6 --dec-depth 6 --transformer-heads 8 --transformer-postprocess-emb d --transformer-postprocess dan --transformer-dropout 0.1 --label-smoothing 0.1 --learn-rate 0.0003 --lr-warmup 16000 --lr-decay-inv-sqrt 16000 --lr-report --optimizer-params 0.9 0.98 1e-09 --clip-norm 5 --tied-embeddings-all --exponential-smoothing --sync-sgd
[2023-06-30 22:39:00] [config] after: 0e
[2023-06-30 22:39:00] [config] after-batches: 0
[2023-06-30 22:39:00] [config] after-epochs: 8
[2023-06-30 22:39:00] [config] all-caps-every: 0
[2023-06-30 22:39:00] [config] allow-unk: false
[2023-06-30 22:39:00] [config] authors: false
[2023-06-30 22:39:00] [config] beam-size: 12
[2023-06-30 22:39:00] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:39:00] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:39:00] [config] bert-masking-fraction: 0.15
[2023-06-30 22:39:00] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:39:00] [config] bert-train-type-embeddings: true
[2023-06-30 22:39:00] [config] bert-type-vocab-size: 2
[2023-06-30 22:39:00] [config] build-info: ""
[2023-06-30 22:39:00] [config] check-gradient-nan: false
[2023-06-30 22:39:00] [config] check-nan: false
[2023-06-30 22:39:00] [config] cite: false
[2023-06-30 22:39:00] [config] clip-norm: 5
[2023-06-30 22:39:00] [config] cost-scaling:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] cost-type: ce-sum
[2023-06-30 22:39:00] [config] cpu-threads: 0
[2023-06-30 22:39:00] [config] data-threads: 8
[2023-06-30 22:39:00] [config] data-weighting: ""
[2023-06-30 22:39:00] [config] data-weighting-type: sentence
[2023-06-30 22:39:00] [config] dec-cell: gru
[2023-06-30 22:39:00] [config] dec-cell-base-depth: 2
[2023-06-30 22:39:00] [config] dec-cell-high-depth: 1
[2023-06-30 22:39:00] [config] dec-depth: 1
[2023-06-30 22:39:00] [config] devices:
[2023-06-30 22:39:00] [config]   - 0
[2023-06-30 22:39:00] [config] dim-emb: 512
[2023-06-30 22:39:00] [config] dim-rnn: 1024
[2023-06-30 22:39:00] [config] dim-vocabs:
[2023-06-30 22:39:00] [config]   - 54042
[2023-06-30 22:39:00] [config]   - 36507
[2023-06-30 22:39:00] [config] disp-first: 0
[2023-06-30 22:39:00] [config] disp-freq: 1000u
[2023-06-30 22:39:00] [config] disp-label-counts: true
[2023-06-30 22:39:00] [config] dropout-rnn: 0
[2023-06-30 22:39:00] [config] dropout-src: 0
[2023-06-30 22:39:00] [config] dropout-trg: 0
[2023-06-30 22:39:00] [config] dump-config: ""
[2023-06-30 22:39:00] [config] dynamic-gradient-scaling:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] early-stopping: 10
[2023-06-30 22:39:00] [config] early-stopping-on: first
[2023-06-30 22:39:00] [config] embedding-fix-src: false
[2023-06-30 22:39:00] [config] embedding-fix-trg: false
[2023-06-30 22:39:00] [config] embedding-normalization: false
[2023-06-30 22:39:00] [config] embedding-vectors:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] enc-cell: gru
[2023-06-30 22:39:00] [config] enc-cell-depth: 1
[2023-06-30 22:39:00] [config] enc-depth: 1
[2023-06-30 22:39:00] [config] enc-type: bidirectional
[2023-06-30 22:39:00] [config] english-title-case-every: 0
[2023-06-30 22:39:00] [config] exponential-smoothing: 0.0001
[2023-06-30 22:39:00] [config] factor-weight: 1
[2023-06-30 22:39:00] [config] factors-combine: sum
[2023-06-30 22:39:00] [config] factors-dim-emb: 0
[2023-06-30 22:39:00] [config] gradient-checkpointing: false
[2023-06-30 22:39:00] [config] gradient-norm-average-window: 100
[2023-06-30 22:39:00] [config] guided-alignment: none
[2023-06-30 22:39:00] [config] guided-alignment-cost: mse
[2023-06-30 22:39:00] [config] guided-alignment-weight: 0.1
[2023-06-30 22:39:00] [config] ignore-model-config: false
[2023-06-30 22:39:00] [config] input-types:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] interpolate-env-vars: false
[2023-06-30 22:39:00] [config] keep-best: false
[2023-06-30 22:39:00] [config] label-smoothing: 0.1
[2023-06-30 22:39:00] [config] layer-normalization: false
[2023-06-30 22:39:00] [config] learn-rate: 0.0003
[2023-06-30 22:39:00] [config] lemma-dependency: ""
[2023-06-30 22:39:00] [config] lemma-dim-emb: 0
[2023-06-30 22:39:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:39:00] [config] log-level: info
[2023-06-30 22:39:00] [config] log-time-zone: ""
[2023-06-30 22:39:00] [config] logical-epoch:
[2023-06-30 22:39:00] [config]   - 1e
[2023-06-30 22:39:00] [config]   - 0
[2023-06-30 22:39:00] [config] lr-decay: 0
[2023-06-30 22:39:00] [config] lr-decay-freq: 50000
[2023-06-30 22:39:00] [config] lr-decay-inv-sqrt:
[2023-06-30 22:39:00] [config]   - 16000
[2023-06-30 22:39:00] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:39:00] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:39:00] [config] lr-decay-start:
[2023-06-30 22:39:00] [config]   - 10
[2023-06-30 22:39:00] [config]   - 1
[2023-06-30 22:39:00] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:39:00] [config] lr-report: true
[2023-06-30 22:39:00] [config] lr-warmup: 16000
[2023-06-30 22:39:00] [config] lr-warmup-at-reload: false
[2023-06-30 22:39:00] [config] lr-warmup-cycle: false
[2023-06-30 22:39:00] [config] lr-warmup-start-rate: 0
[2023-06-30 22:39:00] [config] max-length: 100
[2023-06-30 22:39:00] [config] max-length-crop: false
[2023-06-30 22:39:00] [config] max-length-factor: 3
[2023-06-30 22:39:00] [config] maxi-batch: 100
[2023-06-30 22:39:00] [config] maxi-batch-sort: trg
[2023-06-30 22:39:00] [config] mini-batch: 1000
[2023-06-30 22:39:00] [config] mini-batch-fit: true
[2023-06-30 22:39:00] [config] mini-batch-fit-step: 10
[2023-06-30 22:39:00] [config] mini-batch-round-up: true
[2023-06-30 22:39:00] [config] mini-batch-track-lr: false
[2023-06-30 22:39:00] [config] mini-batch-warmup: 0
[2023-06-30 22:39:00] [config] mini-batch-words: 0
[2023-06-30 22:39:00] [config] mini-batch-words-ref: 0
[2023-06-30 22:39:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:39:00] [config] multi-loss-type: sum
[2023-06-30 22:39:00] [config] n-best: false
[2023-06-30 22:39:00] [config] no-nccl: false
[2023-06-30 22:39:00] [config] no-reload: false
[2023-06-30 22:39:00] [config] no-restore-corpus: false
[2023-06-30 22:39:00] [config] normalize: 1
[2023-06-30 22:39:00] [config] normalize-gradient: false
[2023-06-30 22:39:00] [config] num-devices: 0
[2023-06-30 22:39:00] [config] optimizer: adam
[2023-06-30 22:39:00] [config] optimizer-delay: 1
[2023-06-30 22:39:00] [config] optimizer-params:
[2023-06-30 22:39:00] [config]   - 0.9
[2023-06-30 22:39:00] [config]   - 0.98
[2023-06-30 22:39:00] [config]   - 1e-09
[2023-06-30 22:39:00] [config] output-omit-bias: false
[2023-06-30 22:39:00] [config] overwrite: true
[2023-06-30 22:39:00] [config] precision:
[2023-06-30 22:39:00] [config]   - float32
[2023-06-30 22:39:00] [config]   - float32
[2023-06-30 22:39:00] [config] pretrained-model: ""
[2023-06-30 22:39:00] [config] quantize-biases: false
[2023-06-30 22:39:00] [config] quantize-bits: 0
[2023-06-30 22:39:00] [config] quantize-log-based: false
[2023-06-30 22:39:00] [config] quantize-optimization-steps: 0
[2023-06-30 22:39:00] [config] quiet: false
[2023-06-30 22:39:00] [config] quiet-translation: true
[2023-06-30 22:39:00] [config] relative-paths: false
[2023-06-30 22:39:00] [config] right-left: false
[2023-06-30 22:39:00] [config] save-freq: 10000u
[2023-06-30 22:39:00] [config] seed: 1234
[2023-06-30 22:39:00] [config] sentencepiece-alphas:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:39:00] [config] sentencepiece-options: ""
[2023-06-30 22:39:00] [config] sharding: global
[2023-06-30 22:39:00] [config] shuffle: data
[2023-06-30 22:39:00] [config] shuffle-in-ram: false
[2023-06-30 22:39:00] [config] sigterm: save-and-exit
[2023-06-30 22:39:00] [config] skip: false
[2023-06-30 22:39:00] [config] sqlite: ""
[2023-06-30 22:39:00] [config] sqlite-drop: false
[2023-06-30 22:39:00] [config] sync-freq: 200u
[2023-06-30 22:39:00] [config] sync-sgd: true
[2023-06-30 22:39:00] [config] tempdir: /tmp
[2023-06-30 22:39:00] [config] tied-embeddings: false
[2023-06-30 22:39:00] [config] tied-embeddings-all: false
[2023-06-30 22:39:00] [config] tied-embeddings-src: false
[2023-06-30 22:39:00] [config] train-embedder-rank:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] train-sets:
[2023-06-30 22:39:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:39:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:39:00] [config] transformer-aan-activation: swish
[2023-06-30 22:39:00] [config] transformer-aan-depth: 2
[2023-06-30 22:39:00] [config] transformer-aan-nogate: false
[2023-06-30 22:39:00] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:39:00] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:39:00] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:39:00] [config] transformer-depth-scaling: false
[2023-06-30 22:39:00] [config] transformer-dim-aan: 2048
[2023-06-30 22:39:00] [config] transformer-dim-ffn: 2048
[2023-06-30 22:39:00] [config] transformer-dropout: 0.1
[2023-06-30 22:39:00] [config] transformer-dropout-attention: 0
[2023-06-30 22:39:00] [config] transformer-dropout-ffn: 0
[2023-06-30 22:39:00] [config] transformer-ffn-activation: swish
[2023-06-30 22:39:00] [config] transformer-ffn-depth: 2
[2023-06-30 22:39:00] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:39:00] [config] transformer-heads: 8
[2023-06-30 22:39:00] [config] transformer-no-projection: false
[2023-06-30 22:39:00] [config] transformer-pool: false
[2023-06-30 22:39:00] [config] transformer-postprocess: dan
[2023-06-30 22:39:00] [config] transformer-postprocess-emb: d
[2023-06-30 22:39:00] [config] transformer-postprocess-top: ""
[2023-06-30 22:39:00] [config] transformer-preprocess: ""
[2023-06-30 22:39:00] [config] transformer-tied-layers:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] transformer-train-position-embeddings: false
[2023-06-30 22:39:00] [config] tsv: false
[2023-06-30 22:39:00] [config] tsv-fields: 0
[2023-06-30 22:39:00] [config] type: transformer
[2023-06-30 22:39:00] [config] ulr: false
[2023-06-30 22:39:00] [config] ulr-dim-emb: 0
[2023-06-30 22:39:00] [config] ulr-dropout: 0
[2023-06-30 22:39:00] [config] ulr-keys-vectors: ""
[2023-06-30 22:39:00] [config] ulr-query-vectors: ""
[2023-06-30 22:39:00] [config] ulr-softmax-temperature: 1
[2023-06-30 22:39:00] [config] ulr-trainable-transformation: false
[2023-06-30 22:39:00] [config] unlikelihood-loss: false
[2023-06-30 22:39:00] [config] valid-freq: 50000000
[2023-06-30 22:39:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:39:00] [config] valid-max-length: 1000
[2023-06-30 22:39:00] [config] valid-metrics:
[2023-06-30 22:39:00] [config]   - cross-entropy
[2023-06-30 22:39:00] [config]   - translation
[2023-06-30 22:39:00] [config] valid-mini-batch: 64
[2023-06-30 22:39:00] [config] valid-reset-stalled: false
[2023-06-30 22:39:00] [config] valid-script-args:
[2023-06-30 22:39:00] [config]   []
[2023-06-30 22:39:00] [config] valid-script-path: ""
[2023-06-30 22:39:00] [config] valid-sets:
[2023-06-30 22:39:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:39:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:39:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:39:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:39:00] [config] vocabs:
[2023-06-30 22:39:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:39:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:39:00] [config] word-penalty: 0
[2023-06-30 22:39:00] [config] word-scores: false
[2023-06-30 22:39:00] [config] workspace: 2048
[2023-06-30 22:39:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:39:00] Using synchronous SGD
[2023-06-30 22:39:00] Synced seed 1234
[2023-06-30 22:39:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-30 22:39:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-30 22:39:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-30 22:39:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-30 22:39:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-30 22:39:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:39:01] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:39:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:39:01] [comm] Using global sharding
[2023-06-30 22:39:01] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:39:01] [training] Using 1 GPUs
[2023-06-30 22:39:01] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:39:01] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:39:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:39:02] [memory] Reserving 124 MB, device gpu0
[2023-06-30 22:39:05] Seen 18,843 samples
[2023-06-30 22:39:05] Starting data epoch 40 in logical epoch 40
[2023-06-30 22:39:05] [data] Shuffling data
[2023-06-30 22:39:05] [data] Done reading 20,192 sentences
[2023-06-30 22:39:05] [data] Done shuffling 20,192 sentences to temp files
device gpu0)
[2023-06-30 22:39:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:39:09] [comm] Using global sharding
[2023-06-30 22:39:10] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:39:10] [training] Using 1 GPUs
[2023-06-30 22:39:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:39:11] [warn] Average not found in .npz file
[2023-06-30 22:39:11] Loading Adam parameters
[2023-06-30 22:39:11] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:39:11] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:39:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:39:11] [data] Restoring the corpus state to epoch 34, batch 10000
[2023-06-30 22:39:11] [data] Shuffling data
[2023-06-30 22:39:11] [data] Done reading 20,192 sentences
[2023-06-30 22:39:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:39:11] Error: Attempted to wait for futureBufferedBatches_ when none pending.
This error often occurs when Marian tries to restore the training data iterator, but the corpus has been changed or replaced.
If you have changed the training corpus, add --no-restore-corpus to the training command and run it again.
[2023-06-30 22:39:11] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /marian/src/data/batch_generator.h:263
[2023-06-30 22:41:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:41:46] [marian] Running on node20.datos.cluster.uy as process 2982 with command line:
[2023-06-30 22:41:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:41:46] [config] after: 0e
[2023-06-30 22:41:46] [config] after-batches: 0
[2023-06-30 22:41:46] [config] after-epochs: 10
[2023-06-30 22:41:46] [config] all-caps-every: 0
[2023-06-30 22:41:46] [config] allow-unk: false
[2023-06-30 22:41:46] [config] authors: false
[2023-06-30 22:41:46] [config] beam-size: 12
[2023-06-30 22:41:46] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:41:46] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:41:46] [config] bert-masking-fraction: 0.15
[2023-06-30 22:41:46] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:41:46] [config] bert-train-type-embeddings: true
[2023-06-30 22:41:46] [config] bert-type-vocab-size: 2
[2023-06-30 22:41:46] [config] build-info: ""
[2023-06-30 22:41:46] [config] check-gradient-nan: false
[2023-06-30 22:41:46] [config] check-nan: false
[2023-06-30 22:41:46] [config] cite: false
[2023-06-30 22:41:46] [config] clip-norm: 1
[2023-06-30 22:41:46] [config] cost-scaling:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] cost-type: ce-sum
[2023-06-30 22:41:46] [config] cpu-threads: 0
[2023-06-30 22:41:46] [config] data-threads: 8
[2023-06-30 22:41:46] [config] data-weighting: ""
[2023-06-30 22:41:46] [config] data-weighting-type: sentence
[2023-06-30 22:41:46] [config] dec-cell: gru
[2023-06-30 22:41:46] [config] dec-cell-base-depth: 2
[2023-06-30 22:41:46] [config] dec-cell-high-depth: 1
[2023-06-30 22:41:46] [config] dec-depth: 1
[2023-06-30 22:41:46] [config] devices:
[2023-06-30 22:41:46] [config]   - 0
[2023-06-30 22:41:46] [config] dim-emb: 512
[2023-06-30 22:41:46] [config] dim-rnn: 1024
[2023-06-30 22:41:46] [config] dim-vocabs:
[2023-06-30 22:41:46] [config]   - 0
[2023-06-30 22:41:46] [config]   - 0
[2023-06-30 22:41:46] [config] disp-first: 0
[2023-06-30 22:41:46] [config] disp-freq: 1000u
[2023-06-30 22:41:46] [config] disp-label-counts: true
[2023-06-30 22:41:46] [config] dropout-rnn: 0
[2023-06-30 22:41:46] [config] dropout-src: 0
[2023-06-30 22:41:46] [config] dropout-trg: 0
[2023-06-30 22:41:46] [config] dump-config: ""
[2023-06-30 22:41:46] [config] dynamic-gradient-scaling:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] early-stopping: 10
[2023-06-30 22:41:46] [config] early-stopping-on: first
[2023-06-30 22:41:46] [config] embedding-fix-src: false
[2023-06-30 22:41:46] [config] embedding-fix-trg: false
[2023-06-30 22:41:46] [config] embedding-normalization: false
[2023-06-30 22:41:46] [config] embedding-vectors:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] enc-cell: gru
[2023-06-30 22:41:46] [config] enc-cell-depth: 1
[2023-06-30 22:41:46] [config] enc-depth: 1
[2023-06-30 22:41:46] [config] enc-type: bidirectional
[2023-06-30 22:41:46] [config] english-title-case-every: 0
[2023-06-30 22:41:46] [config] exponential-smoothing: 0
[2023-06-30 22:41:46] [config] factor-weight: 1
[2023-06-30 22:41:46] [config] factors-combine: sum
[2023-06-30 22:41:46] [config] factors-dim-emb: 0
[2023-06-30 22:41:46] [config] gradient-checkpointing: false
[2023-06-30 22:41:46] [config] gradient-norm-average-window: 100
[2023-06-30 22:41:46] [config] guided-alignment: none
[2023-06-30 22:41:46] [config] guided-alignment-cost: mse
[2023-06-30 22:41:46] [config] guided-alignment-weight: 0.1
[2023-06-30 22:41:46] [config] ignore-model-config: false
[2023-06-30 22:41:46] [config] input-types:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] interpolate-env-vars: false
[2023-06-30 22:41:46] [config] keep-best: false
[2023-06-30 22:41:46] [config] label-smoothing: 0
[2023-06-30 22:41:46] [config] layer-normalization: false
[2023-06-30 22:41:46] [config] learn-rate: 0.0001
[2023-06-30 22:41:46] [config] lemma-dependency: ""
[2023-06-30 22:41:46] [config] lemma-dim-emb: 0
[2023-06-30 22:41:46] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:41:46] [config] log-level: info
[2023-06-30 22:41:46] [config] log-time-zone: ""
[2023-06-30 22:41:46] [config] logical-epoch:
[2023-06-30 22:41:46] [config]   - 1e
[2023-06-30 22:41:46] [config]   - 0
[2023-06-30 22:41:46] [config] lr-decay: 0
[2023-06-30 22:41:46] [config] lr-decay-freq: 50000
[2023-06-30 22:41:46] [config] lr-decay-inv-sqrt:
[2023-06-30 22:41:46] [config]   - 0
[2023-06-30 22:41:46] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:41:46] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:41:46] [config] lr-decay-start:
[2023-06-30 22:41:46] [config]   - 10
[2023-06-30 22:41:46] [config]   - 1
[2023-06-30 22:41:46] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:41:46] [config] lr-report: false
[2023-06-30 22:41:46] [config] lr-warmup: 0
[2023-06-30 22:41:46] [config] lr-warmup-at-reload: false
[2023-06-30 22:41:46] [config] lr-warmup-cycle: false
[2023-06-30 22:41:46] [config] lr-warmup-start-rate: 0
[2023-06-30 22:41:46] [config] max-length: 50
[2023-06-30 22:41:46] [config] max-length-crop: false
[2023-06-30 22:41:46] [config] max-length-factor: 3
[2023-06-30 22:41:46] [config] maxi-batch: 100
[2023-06-30 22:41:46] [config] maxi-batch-sort: trg
[2023-06-30 22:41:46] [config] mini-batch: 64
[2023-06-30 22:41:46] [config] mini-batch-fit: false
[2023-06-30 22:41:46] [config] mini-batch-fit-step: 10
[2023-06-30 22:41:46] [config] mini-batch-round-up: true
[2023-06-30 22:41:46] [config] mini-batch-track-lr: false
[2023-06-30 22:41:46] [config] mini-batch-warmup: 0
[2023-06-30 22:41:46] [config] mini-batch-words: 0
[2023-06-30 22:41:46] [config] mini-batch-words-ref: 0
[2023-06-30 22:41:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:41:46] [config] multi-loss-type: sum
[2023-06-30 22:41:46] [config] n-best: false
[2023-06-30 22:41:46] [config] no-nccl: false
[2023-06-30 22:41:46] [config] no-reload: false
[2023-06-30 22:41:46] [config] no-restore-corpus: false
[2023-06-30 22:41:46] [config] normalize: 0
[2023-06-30 22:41:46] [config] normalize-gradient: false
[2023-06-30 22:41:46] [config] num-devices: 0
[2023-06-30 22:41:46] [config] optimizer: adam
[2023-06-30 22:41:46] [config] optimizer-delay: 1
[2023-06-30 22:41:46] [config] optimizer-params:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] output-omit-bias: false
[2023-06-30 22:41:46] [config] overwrite: true
[2023-06-30 22:41:46] [config] precision:
[2023-06-30 22:41:46] [config]   - float32
[2023-06-30 22:41:46] [config]   - float32
[2023-06-30 22:41:46] [config] pretrained-model: ""
[2023-06-30 22:41:46] [config] quantize-biases: false
[2023-06-30 22:41:46] [config] quantize-bits: 0
[2023-06-30 22:41:46] [config] quantize-log-based: false
[2023-06-30 22:41:46] [config] quantize-optimization-steps: 0
[2023-06-30 22:41:46] [config] quiet: false
[2023-06-30 22:41:46] [config] quiet-translation: true
[2023-06-30 22:41:46] [config] relative-paths: false
[2023-06-30 22:41:46] [config] right-left: false
[2023-06-30 22:41:46] [config] save-freq: 10000u
[2023-06-30 22:41:46] [config] seed: 1234
[2023-06-30 22:41:46] [config] sentencepiece-alphas:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:41:46] [config] sentencepiece-options: ""
[2023-06-30 22:41:46] [config] sharding: global
[2023-06-30 22:41:46] [config] shuffle: data
[2023-06-30 22:41:46] [config] shuffle-in-ram: false
[2023-06-30 22:41:46] [config] sigterm: save-and-exit
[2023-06-30 22:41:46] [config] skip: false
[2023-06-30 22:41:46] [config] sqlite: ""
[2023-06-30 22:41:46] [config] sqlite-drop: false
[2023-06-30 22:41:46] [config] sync-freq: 200u
[2023-06-30 22:41:46] [config] sync-sgd: false
[2023-06-30 22:41:46] [config] tempdir: /tmp
[2023-06-30 22:41:46] [config] tied-embeddings: false
[2023-06-30 22:41:46] [config] tied-embeddings-all: false
[2023-06-30 22:41:46] [config] tied-embeddings-src: false
[2023-06-30 22:41:46] [config] train-embedder-rank:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] train-sets:
[2023-06-30 22:41:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:41:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:41:46] [config] transformer-aan-activation: swish
[2023-06-30 22:41:46] [config] transformer-aan-depth: 2
[2023-06-30 22:41:46] [config] transformer-aan-nogate: false
[2023-06-30 22:41:46] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:41:46] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:41:46] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:41:46] [config] transformer-depth-scaling: false
[2023-06-30 22:41:46] [config] transformer-dim-aan: 2048
[2023-06-30 22:41:46] [config] transformer-dim-ffn: 2048
[2023-06-30 22:41:46] [config] transformer-dropout: 0
[2023-06-30 22:41:46] [config] transformer-dropout-attention: 0
[2023-06-30 22:41:46] [config] transformer-dropout-ffn: 0
[2023-06-30 22:41:46] [config] transformer-ffn-activation: swish
[2023-06-30 22:41:46] [config] transformer-ffn-depth: 2
[2023-06-30 22:41:46] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:41:46] [config] transformer-heads: 8
[2023-06-30 22:41:46] [config] transformer-no-projection: false
[2023-06-30 22:41:46] [config] transformer-pool: false
[2023-06-30 22:41:46] [config] transformer-postprocess: dan
[2023-06-30 22:41:46] [config] transformer-postprocess-emb: d
[2023-06-30 22:41:46] [config] transformer-postprocess-top: ""
[2023-06-30 22:41:46] [config] transformer-preprocess: ""
[2023-06-30 22:41:46] [config] transformer-tied-layers:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] transformer-train-position-embeddings: false
[2023-06-30 22:41:46] [config] tsv: false
[2023-06-30 22:41:46] [config] tsv-fields: 0
[2023-06-30 22:41:46] [config] type: transformer
[2023-06-30 22:41:46] [config] ulr: false
[2023-06-30 22:41:46] [config] ulr-dim-emb: 0
[2023-06-30 22:41:46] [config] ulr-dropout: 0
[2023-06-30 22:41:46] [config] ulr-keys-vectors: ""
[2023-06-30 22:41:46] [config] ulr-query-vectors: ""
[2023-06-30 22:41:46] [config] ulr-softmax-temperature: 1
[2023-06-30 22:41:46] [config] ulr-trainable-transformation: false
[2023-06-30 22:41:46] [config] unlikelihood-loss: false
[2023-06-30 22:41:46] [config] valid-freq: 50000000
[2023-06-30 22:41:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:41:46] [config] valid-max-length: 1000
[2023-06-30 22:41:46] [config] valid-metrics:
[2023-06-30 22:41:46] [config]   - cross-entropy
[2023-06-30 22:41:46] [config]   - translation
[2023-06-30 22:41:46] [config] valid-mini-batch: 32
[2023-06-30 22:41:46] [config] valid-reset-stalled: false
[2023-06-30 22:41:46] [config] valid-script-args:
[2023-06-30 22:41:46] [config]   []
[2023-06-30 22:41:46] [config] valid-script-path: ""
[2023-06-30 22:41:46] [config] valid-sets:
[2023-06-30 22:41:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:41:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:41:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:41:46] [config] vocabs:
[2023-06-30 22:41:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:41:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:41:46] [config] word-penalty: 0
[2023-06-30 22:41:46] [config] word-scores: false
[2023-06-30 22:41:46] [config] workspace: 2048
[2023-06-30 22:41:46] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:41:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:41:46] [training] Using single-device training
[2023-06-30 22:41:47] Synced seed 1234
[2023-06-30 22:41:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:41:47] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:41:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:41:47] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:41:47] [valid] No post-processing script given for validating translator
[2023-06-30 22:41:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:41:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:41:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:41:48] [comm] Using global sharding
[2023-06-30 22:41:48] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:41:48] [training] Using 1 GPUs
[2023-06-30 22:41:48] Training started
[2023-06-30 22:41:48] [data] Shuffling data
[2023-06-30 22:41:48] [data] Done reading 20,192 sentences
[2023-06-30 22:41:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:41:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:41:48] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:41:48] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:41:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:41:50] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:41:50] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:41:50] Allocating memory for Adam-specific shards
[2023-06-30 22:41:50] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:42:06] Seen 18,843 samples
[2023-06-30 22:42:06] Starting data epoch 2 in logical epoch 2
[2023-06-30 22:42:06] [data] Shuffling data
[2023-06-30 22:42:06] [data] Done reading 20,192 sentences
[2023-06-30 22:42:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:42:23] Seen 18,843 samples
[2023-06-30 22:42:23] Starting data epoch 3 in logical epoch 3
[2023-06-30 22:42:23] [data] Shuffling data
[2023-06-30 22:42:23] [data] Done reading 20,192 sentences
[2023-06-30 22:42:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:42:40] Seen 18,843 samples
[2023-06-30 22:42:40] Starting data epoch 4 in logical epoch 4
[2023-06-30 22:42:40] [data] Shuffling data
[2023-06-30 22:42:40] [data] Done reading 20,192 sentences
[2023-06-30 22:42:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:42:46] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 5.39951372 * 1,343,216 @ 768 after 1,343,216 : Time 59.39s : 22615.78 words/s : gNorm 2.2512
[2023-06-30 22:42:57] Seen 18,843 samples
[2023-06-30 22:42:57] Starting data epoch 5 in logical epoch 5
[2023-06-30 22:42:57] [data] Shuffling data
[2023-06-30 22:42:57] [data] Done reading 20,192 sentences
[2023-06-30 22:42:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:43:13] Seen 18,843 samples
[2023-06-30 22:43:13] Starting data epoch 6 in logical epoch 6
[2023-06-30 22:43:13] [data] Shuffling data
[2023-06-30 22:43:13] [data] Done reading 20,192 sentences
[2023-06-30 22:43:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:43:31] Seen 18,843 samples
[2023-06-30 22:43:31] Starting data epoch 7 in logical epoch 7
[2023-06-30 22:43:31] [data] Shuffling data
[2023-06-30 22:43:31] [data] Done reading 20,192 sentences
[2023-06-30 22:43:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:43:44] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 3.33698606 * 1,334,929 @ 2,976 after 2,678,145 : Time 57.92s : 23046.65 words/s : gNorm 2.7515
[2023-06-30 22:43:49] Seen 18,843 samples
[2023-06-30 22:43:49] Starting data epoch 8 in logical epoch 8
[2023-06-30 22:43:49] [data] Shuffling data
[2023-06-30 22:43:49] [data] Done reading 20,192 sentences
[2023-06-30 22:43:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:44:08] Seen 18,843 samples
[2023-06-30 22:44:08] Starting data epoch 9 in logical epoch 9
[2023-06-30 22:44:08] [data] Shuffling data
[2023-06-30 22:44:08] [data] Done reading 20,192 sentences
[2023-06-30 22:44:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:44:27] Seen 18,843 samples
[2023-06-30 22:44:27] Starting data epoch 10 in logical epoch 10
[2023-06-30 22:44:27] [data] Shuffling data
[2023-06-30 22:44:27] [data] Done reading 20,192 sentences
[2023-06-30 22:44:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:44:46] Seen 18,843 samples
[2023-06-30 22:44:46] Starting data epoch 11 in logical epoch 11
[2023-06-30 22:44:46] Training finished
[2023-06-30 22:44:49] [valid] Ep. 11 : Up. 2968 : cross-entropy : 125.788 : new best
[2023-06-30 22:47:02] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-06-30 22:47:02] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:47:05] Saving Adam parameters
[2023-06-30 22:47:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:47:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:47:16] [marian] Running on node20.datos.cluster.uy as process 3318 with command line:
[2023-06-30 22:47:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:47:16] [config] after: 0e
[2023-06-30 22:47:16] [config] after-batches: 0
[2023-06-30 22:47:16] [config] after-epochs: 20
[2023-06-30 22:47:16] [config] all-caps-every: 0
[2023-06-30 22:47:16] [config] allow-unk: false
[2023-06-30 22:47:16] [config] authors: false
[2023-06-30 22:47:16] [config] beam-size: 12
[2023-06-30 22:47:16] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:47:16] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:47:16] [config] bert-masking-fraction: 0.15
[2023-06-30 22:47:16] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:47:16] [config] bert-train-type-embeddings: true
[2023-06-30 22:47:16] [config] bert-type-vocab-size: 2
[2023-06-30 22:47:16] [config] build-info: ""
[2023-06-30 22:47:16] [config] check-gradient-nan: false
[2023-06-30 22:47:16] [config] check-nan: false
[2023-06-30 22:47:16] [config] cite: false
[2023-06-30 22:47:16] [config] clip-norm: 1
[2023-06-30 22:47:16] [config] cost-scaling:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] cost-type: ce-sum
[2023-06-30 22:47:16] [config] cpu-threads: 0
[2023-06-30 22:47:16] [config] data-threads: 8
[2023-06-30 22:47:16] [config] data-weighting: ""
[2023-06-30 22:47:16] [config] data-weighting-type: sentence
[2023-06-30 22:47:16] [config] dec-cell: gru
[2023-06-30 22:47:16] [config] dec-cell-base-depth: 2
[2023-06-30 22:47:16] [config] dec-cell-high-depth: 1
[2023-06-30 22:47:16] [config] dec-depth: 1
[2023-06-30 22:47:16] [config] devices:
[2023-06-30 22:47:16] [config]   - 0
[2023-06-30 22:47:16] [config] dim-emb: 512
[2023-06-30 22:47:16] [config] dim-rnn: 1024
[2023-06-30 22:47:16] [config] dim-vocabs:
[2023-06-30 22:47:16] [config]   - 54042
[2023-06-30 22:47:16] [config]   - 36507
[2023-06-30 22:47:16] [config] disp-first: 0
[2023-06-30 22:47:16] [config] disp-freq: 1000u
[2023-06-30 22:47:16] [config] disp-label-counts: true
[2023-06-30 22:47:16] [config] dropout-rnn: 0
[2023-06-30 22:47:16] [config] dropout-src: 0
[2023-06-30 22:47:16] [config] dropout-trg: 0
[2023-06-30 22:47:16] [config] dump-config: ""
[2023-06-30 22:47:16] [config] dynamic-gradient-scaling:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] early-stopping: 10
[2023-06-30 22:47:16] [config] early-stopping-on: first
[2023-06-30 22:47:16] [config] embedding-fix-src: false
[2023-06-30 22:47:16] [config] embedding-fix-trg: false
[2023-06-30 22:47:16] [config] embedding-normalization: false
[2023-06-30 22:47:16] [config] embedding-vectors:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] enc-cell: gru
[2023-06-30 22:47:16] [config] enc-cell-depth: 1
[2023-06-30 22:47:16] [config] enc-depth: 1
[2023-06-30 22:47:16] [config] enc-type: bidirectional
[2023-06-30 22:47:16] [config] english-title-case-every: 0
[2023-06-30 22:47:16] [config] exponential-smoothing: 0
[2023-06-30 22:47:16] [config] factor-weight: 1
[2023-06-30 22:47:16] [config] factors-combine: sum
[2023-06-30 22:47:16] [config] factors-dim-emb: 0
[2023-06-30 22:47:16] [config] gradient-checkpointing: false
[2023-06-30 22:47:16] [config] gradient-norm-average-window: 100
[2023-06-30 22:47:16] [config] guided-alignment: none
[2023-06-30 22:47:16] [config] guided-alignment-cost: mse
[2023-06-30 22:47:16] [config] guided-alignment-weight: 0.1
[2023-06-30 22:47:16] [config] ignore-model-config: false
[2023-06-30 22:47:16] [config] input-types:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] interpolate-env-vars: false
[2023-06-30 22:47:16] [config] keep-best: false
[2023-06-30 22:47:16] [config] label-smoothing: 0
[2023-06-30 22:47:16] [config] layer-normalization: false
[2023-06-30 22:47:16] [config] learn-rate: 0.0001
[2023-06-30 22:47:16] [config] lemma-dependency: ""
[2023-06-30 22:47:16] [config] lemma-dim-emb: 0
[2023-06-30 22:47:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:47:16] [config] log-level: info
[2023-06-30 22:47:16] [config] log-time-zone: ""
[2023-06-30 22:47:16] [config] logical-epoch:
[2023-06-30 22:47:16] [config]   - 1e
[2023-06-30 22:47:16] [config]   - 0
[2023-06-30 22:47:16] [config] lr-decay: 0
[2023-06-30 22:47:16] [config] lr-decay-freq: 50000
[2023-06-30 22:47:16] [config] lr-decay-inv-sqrt:
[2023-06-30 22:47:16] [config]   - 0
[2023-06-30 22:47:16] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:47:16] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:47:16] [config] lr-decay-start:
[2023-06-30 22:47:16] [config]   - 10
[2023-06-30 22:47:16] [config]   - 1
[2023-06-30 22:47:16] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:47:16] [config] lr-report: false
[2023-06-30 22:47:16] [config] lr-warmup: 0
[2023-06-30 22:47:16] [config] lr-warmup-at-reload: false
[2023-06-30 22:47:16] [config] lr-warmup-cycle: false
[2023-06-30 22:47:16] [config] lr-warmup-start-rate: 0
[2023-06-30 22:47:16] [config] max-length: 50
[2023-06-30 22:47:16] [config] max-length-crop: false
[2023-06-30 22:47:16] [config] max-length-factor: 3
[2023-06-30 22:47:16] [config] maxi-batch: 100
[2023-06-30 22:47:16] [config] maxi-batch-sort: trg
[2023-06-30 22:47:16] [config] mini-batch: 64
[2023-06-30 22:47:16] [config] mini-batch-fit: false
[2023-06-30 22:47:16] [config] mini-batch-fit-step: 10
[2023-06-30 22:47:16] [config] mini-batch-round-up: true
[2023-06-30 22:47:16] [config] mini-batch-track-lr: false
[2023-06-30 22:47:16] [config] mini-batch-warmup: 0
[2023-06-30 22:47:16] [config] mini-batch-words: 0
[2023-06-30 22:47:16] [config] mini-batch-words-ref: 0
[2023-06-30 22:47:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:47:16] [config] multi-loss-type: sum
[2023-06-30 22:47:16] [config] n-best: false
[2023-06-30 22:47:16] [config] no-nccl: false
[2023-06-30 22:47:16] [config] no-reload: false
[2023-06-30 22:47:16] [config] no-restore-corpus: false
[2023-06-30 22:47:16] [config] normalize: 0
[2023-06-30 22:47:16] [config] normalize-gradient: false
[2023-06-30 22:47:16] [config] num-devices: 0
[2023-06-30 22:47:16] [config] optimizer: adam
[2023-06-30 22:47:16] [config] optimizer-delay: 1
[2023-06-30 22:47:16] [config] optimizer-params:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] output-omit-bias: false
[2023-06-30 22:47:16] [config] overwrite: true
[2023-06-30 22:47:16] [config] precision:
[2023-06-30 22:47:16] [config]   - float32
[2023-06-30 22:47:16] [config]   - float32
[2023-06-30 22:47:16] [config] pretrained-model: ""
[2023-06-30 22:47:16] [config] quantize-biases: false
[2023-06-30 22:47:16] [config] quantize-bits: 0
[2023-06-30 22:47:16] [config] quantize-log-based: false
[2023-06-30 22:47:16] [config] quantize-optimization-steps: 0
[2023-06-30 22:47:16] [config] quiet: false
[2023-06-30 22:47:16] [config] quiet-translation: true
[2023-06-30 22:47:16] [config] relative-paths: false
[2023-06-30 22:47:16] [config] right-left: false
[2023-06-30 22:47:16] [config] save-freq: 10000u
[2023-06-30 22:47:16] [config] seed: 1234
[2023-06-30 22:47:16] [config] sentencepiece-alphas:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:47:16] [config] sentencepiece-options: ""
[2023-06-30 22:47:16] [config] sharding: global
[2023-06-30 22:47:16] [config] shuffle: data
[2023-06-30 22:47:16] [config] shuffle-in-ram: false
[2023-06-30 22:47:16] [config] sigterm: save-and-exit
[2023-06-30 22:47:16] [config] skip: false
[2023-06-30 22:47:16] [config] sqlite: ""
[2023-06-30 22:47:16] [config] sqlite-drop: false
[2023-06-30 22:47:16] [config] sync-freq: 200u
[2023-06-30 22:47:16] [config] sync-sgd: false
[2023-06-30 22:47:16] [config] tempdir: /tmp
[2023-06-30 22:47:16] [config] tied-embeddings: false
[2023-06-30 22:47:16] [config] tied-embeddings-all: false
[2023-06-30 22:47:16] [config] tied-embeddings-src: false
[2023-06-30 22:47:16] [config] train-embedder-rank:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] train-sets:
[2023-06-30 22:47:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:47:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:47:16] [config] transformer-aan-activation: swish
[2023-06-30 22:47:16] [config] transformer-aan-depth: 2
[2023-06-30 22:47:16] [config] transformer-aan-nogate: false
[2023-06-30 22:47:16] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:47:16] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:47:16] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:47:16] [config] transformer-depth-scaling: false
[2023-06-30 22:47:16] [config] transformer-dim-aan: 2048
[2023-06-30 22:47:16] [config] transformer-dim-ffn: 2048
[2023-06-30 22:47:16] [config] transformer-dropout: 0
[2023-06-30 22:47:16] [config] transformer-dropout-attention: 0
[2023-06-30 22:47:16] [config] transformer-dropout-ffn: 0
[2023-06-30 22:47:16] [config] transformer-ffn-activation: swish
[2023-06-30 22:47:16] [config] transformer-ffn-depth: 2
[2023-06-30 22:47:16] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:47:16] [config] transformer-heads: 8
[2023-06-30 22:47:16] [config] transformer-no-projection: false
[2023-06-30 22:47:16] [config] transformer-pool: false
[2023-06-30 22:47:16] [config] transformer-postprocess: dan
[2023-06-30 22:47:16] [config] transformer-postprocess-emb: d
[2023-06-30 22:47:16] [config] transformer-postprocess-top: ""
[2023-06-30 22:47:16] [config] transformer-preprocess: ""
[2023-06-30 22:47:16] [config] transformer-tied-layers:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] transformer-train-position-embeddings: false
[2023-06-30 22:47:16] [config] tsv: false
[2023-06-30 22:47:16] [config] tsv-fields: 0
[2023-06-30 22:47:16] [config] type: transformer
[2023-06-30 22:47:16] [config] ulr: false
[2023-06-30 22:47:16] [config] ulr-dim-emb: 0
[2023-06-30 22:47:16] [config] ulr-dropout: 0
[2023-06-30 22:47:16] [config] ulr-keys-vectors: ""
[2023-06-30 22:47:16] [config] ulr-query-vectors: ""
[2023-06-30 22:47:16] [config] ulr-softmax-temperature: 1
[2023-06-30 22:47:16] [config] ulr-trainable-transformation: false
[2023-06-30 22:47:16] [config] unlikelihood-loss: false
[2023-06-30 22:47:16] [config] valid-freq: 50000000
[2023-06-30 22:47:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:47:16] [config] valid-max-length: 1000
[2023-06-30 22:47:16] [config] valid-metrics:
[2023-06-30 22:47:16] [config]   - cross-entropy
[2023-06-30 22:47:16] [config]   - translation
[2023-06-30 22:47:16] [config] valid-mini-batch: 32
[2023-06-30 22:47:16] [config] valid-reset-stalled: false
[2023-06-30 22:47:16] [config] valid-script-args:
[2023-06-30 22:47:16] [config]   []
[2023-06-30 22:47:16] [config] valid-script-path: ""
[2023-06-30 22:47:16] [config] valid-sets:
[2023-06-30 22:47:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:47:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:47:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:47:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:47:16] [config] vocabs:
[2023-06-30 22:47:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:47:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:47:16] [config] word-penalty: 0
[2023-06-30 22:47:16] [config] word-scores: false
[2023-06-30 22:47:16] [config] workspace: 2048
[2023-06-30 22:47:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:47:16] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:47:16] [training] Using single-device training
[2023-06-30 22:47:16] Synced seed 1234
[2023-06-30 22:47:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:47:16] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:47:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:47:16] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:47:16] [valid] No post-processing script given for validating translator
[2023-06-30 22:47:16] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:47:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:47:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:47:17] [comm] Using global sharding
[2023-06-30 22:47:17] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:47:17] [training] Using 1 GPUs
[2023-06-30 22:47:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:47:19] Loading Adam parameters
[2023-06-30 22:47:19] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:47:19] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:47:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:47:20] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-06-30 22:47:20] [data] Shuffling data
[2023-06-30 22:47:20] [data] Done reading 20,192 sentences
[2023-06-30 22:47:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:47:20] Training started
[2023-06-30 22:47:20] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:47:20] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:47:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:47:20] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:47:20] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:47:22] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 1.78810775 * 1,343,919 @ 1,536 after 4,022,064 : Time 5.40s : 248698.25 words/s : gNorm 2.0332
[2023-06-30 22:47:37] Seen 18,843 samples
[2023-06-30 22:47:37] Starting data epoch 12 in logical epoch 12
[2023-06-30 22:47:37] [data] Shuffling data
[2023-06-30 22:47:37] [data] Done reading 20,192 sentences
[2023-06-30 22:47:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:47:55] Seen 18,843 samples
[2023-06-30 22:47:55] Starting data epoch 13 in logical epoch 13
[2023-06-30 22:47:55] [data] Shuffling data
[2023-06-30 22:47:55] [data] Done reading 20,192 sentences
[2023-06-30 22:47:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:48:14] Seen 18,843 samples
[2023-06-30 22:48:14] Starting data epoch 14 in logical epoch 14
[2023-06-30 22:48:14] [data] Shuffling data
[2023-06-30 22:48:14] [data] Done reading 20,192 sentences
[2023-06-30 22:48:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:48:24] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 0.76778781 * 1,354,393 @ 2,176 after 5,376,457 : Time 62.23s : 21763.53 words/s : gNorm 1.5286
[2023-06-30 22:48:33] Seen 18,843 samples
[2023-06-30 22:48:33] Starting data epoch 15 in logical epoch 15
[2023-06-30 22:48:33] [data] Shuffling data
[2023-06-30 22:48:33] [data] Done reading 20,192 sentences
[2023-06-30 22:48:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:48:53] Seen 18,843 samples
[2023-06-30 22:48:53] Starting data epoch 16 in logical epoch 16
[2023-06-30 22:48:53] [data] Shuffling data
[2023-06-30 22:48:53] [data] Done reading 20,192 sentences
[2023-06-30 22:48:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:49:12] Seen 18,843 samples
[2023-06-30 22:49:12] Starting data epoch 17 in logical epoch 17
[2023-06-30 22:49:12] [data] Shuffling data
[2023-06-30 22:49:12] [data] Done reading 20,192 sentences
[2023-06-30 22:49:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:49:28] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 0.26950464 * 1,331,522 @ 1,216 after 6,707,979 : Time 64.49s : 20647.20 words/s : gNorm 1.2750
[2023-06-30 22:49:31] Seen 18,843 samples
[2023-06-30 22:49:31] Starting data epoch 18 in logical epoch 18
[2023-06-30 22:49:31] [data] Shuffling data
[2023-06-30 22:49:31] [data] Done reading 20,192 sentences
[2023-06-30 22:49:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:49:50] Seen 18,843 samples
[2023-06-30 22:49:50] Starting data epoch 19 in logical epoch 19
[2023-06-30 22:49:50] [data] Shuffling data
[2023-06-30 22:49:50] [data] Done reading 20,192 sentences
[2023-06-30 22:49:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:50:11] Seen 18,843 samples
[2023-06-30 22:50:11] Starting data epoch 20 in logical epoch 20
[2023-06-30 22:50:11] [data] Shuffling data
[2023-06-30 22:50:11] [data] Done reading 20,192 sentences
[2023-06-30 22:50:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:50:30] Seen 18,843 samples
[2023-06-30 22:50:30] Starting data epoch 21 in logical epoch 21
[2023-06-30 22:50:30] Training finished
[2023-06-30 22:50:33] [valid] Ep. 21 : Up. 5933 : cross-entropy : 153.892 : stalled 1 times (last best: 125.788)
[2023-06-30 22:52:39] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-06-30 22:52:39] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:52:42] Saving Adam parameters
[2023-06-30 22:52:43] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:52:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:52:53] [marian] Running on node20.datos.cluster.uy as process 3667 with command line:
[2023-06-30 22:52:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:52:53] [config] after: 0e
[2023-06-30 22:52:53] [config] after-batches: 0
[2023-06-30 22:52:53] [config] after-epochs: 30
[2023-06-30 22:52:53] [config] all-caps-every: 0
[2023-06-30 22:52:53] [config] allow-unk: false
[2023-06-30 22:52:53] [config] authors: false
[2023-06-30 22:52:53] [config] beam-size: 12
[2023-06-30 22:52:53] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:52:53] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:52:53] [config] bert-masking-fraction: 0.15
[2023-06-30 22:52:53] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:52:53] [config] bert-train-type-embeddings: true
[2023-06-30 22:52:53] [config] bert-type-vocab-size: 2
[2023-06-30 22:52:53] [config] build-info: ""
[2023-06-30 22:52:53] [config] check-gradient-nan: false
[2023-06-30 22:52:53] [config] check-nan: false
[2023-06-30 22:52:53] [config] cite: false
[2023-06-30 22:52:53] [config] clip-norm: 1
[2023-06-30 22:52:53] [config] cost-scaling:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] cost-type: ce-sum
[2023-06-30 22:52:53] [config] cpu-threads: 0
[2023-06-30 22:52:53] [config] data-threads: 8
[2023-06-30 22:52:53] [config] data-weighting: ""
[2023-06-30 22:52:53] [config] data-weighting-type: sentence
[2023-06-30 22:52:53] [config] dec-cell: gru
[2023-06-30 22:52:53] [config] dec-cell-base-depth: 2
[2023-06-30 22:52:53] [config] dec-cell-high-depth: 1
[2023-06-30 22:52:53] [config] dec-depth: 1
[2023-06-30 22:52:53] [config] devices:
[2023-06-30 22:52:53] [config]   - 0
[2023-06-30 22:52:53] [config] dim-emb: 512
[2023-06-30 22:52:53] [config] dim-rnn: 1024
[2023-06-30 22:52:53] [config] dim-vocabs:
[2023-06-30 22:52:53] [config]   - 54042
[2023-06-30 22:52:53] [config]   - 36507
[2023-06-30 22:52:53] [config] disp-first: 0
[2023-06-30 22:52:53] [config] disp-freq: 1000u
[2023-06-30 22:52:53] [config] disp-label-counts: true
[2023-06-30 22:52:53] [config] dropout-rnn: 0
[2023-06-30 22:52:53] [config] dropout-src: 0
[2023-06-30 22:52:53] [config] dropout-trg: 0
[2023-06-30 22:52:53] [config] dump-config: ""
[2023-06-30 22:52:53] [config] dynamic-gradient-scaling:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] early-stopping: 10
[2023-06-30 22:52:53] [config] early-stopping-on: first
[2023-06-30 22:52:53] [config] embedding-fix-src: false
[2023-06-30 22:52:53] [config] embedding-fix-trg: false
[2023-06-30 22:52:53] [config] embedding-normalization: false
[2023-06-30 22:52:53] [config] embedding-vectors:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] enc-cell: gru
[2023-06-30 22:52:53] [config] enc-cell-depth: 1
[2023-06-30 22:52:53] [config] enc-depth: 1
[2023-06-30 22:52:53] [config] enc-type: bidirectional
[2023-06-30 22:52:53] [config] english-title-case-every: 0
[2023-06-30 22:52:53] [config] exponential-smoothing: 0
[2023-06-30 22:52:53] [config] factor-weight: 1
[2023-06-30 22:52:53] [config] factors-combine: sum
[2023-06-30 22:52:53] [config] factors-dim-emb: 0
[2023-06-30 22:52:53] [config] gradient-checkpointing: false
[2023-06-30 22:52:53] [config] gradient-norm-average-window: 100
[2023-06-30 22:52:53] [config] guided-alignment: none
[2023-06-30 22:52:53] [config] guided-alignment-cost: mse
[2023-06-30 22:52:53] [config] guided-alignment-weight: 0.1
[2023-06-30 22:52:53] [config] ignore-model-config: false
[2023-06-30 22:52:53] [config] input-types:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] interpolate-env-vars: false
[2023-06-30 22:52:53] [config] keep-best: false
[2023-06-30 22:52:53] [config] label-smoothing: 0
[2023-06-30 22:52:53] [config] layer-normalization: false
[2023-06-30 22:52:53] [config] learn-rate: 0.0001
[2023-06-30 22:52:53] [config] lemma-dependency: ""
[2023-06-30 22:52:53] [config] lemma-dim-emb: 0
[2023-06-30 22:52:53] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:52:53] [config] log-level: info
[2023-06-30 22:52:53] [config] log-time-zone: ""
[2023-06-30 22:52:53] [config] logical-epoch:
[2023-06-30 22:52:53] [config]   - 1e
[2023-06-30 22:52:53] [config]   - 0
[2023-06-30 22:52:53] [config] lr-decay: 0
[2023-06-30 22:52:53] [config] lr-decay-freq: 50000
[2023-06-30 22:52:53] [config] lr-decay-inv-sqrt:
[2023-06-30 22:52:53] [config]   - 0
[2023-06-30 22:52:53] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:52:53] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:52:53] [config] lr-decay-start:
[2023-06-30 22:52:53] [config]   - 10
[2023-06-30 22:52:53] [config]   - 1
[2023-06-30 22:52:53] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:52:53] [config] lr-report: false
[2023-06-30 22:52:53] [config] lr-warmup: 0
[2023-06-30 22:52:53] [config] lr-warmup-at-reload: false
[2023-06-30 22:52:53] [config] lr-warmup-cycle: false
[2023-06-30 22:52:53] [config] lr-warmup-start-rate: 0
[2023-06-30 22:52:53] [config] max-length: 50
[2023-06-30 22:52:53] [config] max-length-crop: false
[2023-06-30 22:52:53] [config] max-length-factor: 3
[2023-06-30 22:52:53] [config] maxi-batch: 100
[2023-06-30 22:52:53] [config] maxi-batch-sort: trg
[2023-06-30 22:52:53] [config] mini-batch: 64
[2023-06-30 22:52:53] [config] mini-batch-fit: false
[2023-06-30 22:52:53] [config] mini-batch-fit-step: 10
[2023-06-30 22:52:53] [config] mini-batch-round-up: true
[2023-06-30 22:52:53] [config] mini-batch-track-lr: false
[2023-06-30 22:52:53] [config] mini-batch-warmup: 0
[2023-06-30 22:52:53] [config] mini-batch-words: 0
[2023-06-30 22:52:53] [config] mini-batch-words-ref: 0
[2023-06-30 22:52:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:52:53] [config] multi-loss-type: sum
[2023-06-30 22:52:53] [config] n-best: false
[2023-06-30 22:52:53] [config] no-nccl: false
[2023-06-30 22:52:53] [config] no-reload: false
[2023-06-30 22:52:53] [config] no-restore-corpus: false
[2023-06-30 22:52:53] [config] normalize: 0
[2023-06-30 22:52:53] [config] normalize-gradient: false
[2023-06-30 22:52:53] [config] num-devices: 0
[2023-06-30 22:52:53] [config] optimizer: adam
[2023-06-30 22:52:53] [config] optimizer-delay: 1
[2023-06-30 22:52:53] [config] optimizer-params:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] output-omit-bias: false
[2023-06-30 22:52:53] [config] overwrite: true
[2023-06-30 22:52:53] [config] precision:
[2023-06-30 22:52:53] [config]   - float32
[2023-06-30 22:52:53] [config]   - float32
[2023-06-30 22:52:53] [config] pretrained-model: ""
[2023-06-30 22:52:53] [config] quantize-biases: false
[2023-06-30 22:52:53] [config] quantize-bits: 0
[2023-06-30 22:52:53] [config] quantize-log-based: false
[2023-06-30 22:52:53] [config] quantize-optimization-steps: 0
[2023-06-30 22:52:53] [config] quiet: false
[2023-06-30 22:52:53] [config] quiet-translation: true
[2023-06-30 22:52:53] [config] relative-paths: false
[2023-06-30 22:52:53] [config] right-left: false
[2023-06-30 22:52:53] [config] save-freq: 10000u
[2023-06-30 22:52:53] [config] seed: 1234
[2023-06-30 22:52:53] [config] sentencepiece-alphas:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:52:53] [config] sentencepiece-options: ""
[2023-06-30 22:52:53] [config] sharding: global
[2023-06-30 22:52:53] [config] shuffle: data
[2023-06-30 22:52:53] [config] shuffle-in-ram: false
[2023-06-30 22:52:53] [config] sigterm: save-and-exit
[2023-06-30 22:52:53] [config] skip: false
[2023-06-30 22:52:53] [config] sqlite: ""
[2023-06-30 22:52:53] [config] sqlite-drop: false
[2023-06-30 22:52:53] [config] sync-freq: 200u
[2023-06-30 22:52:53] [config] sync-sgd: false
[2023-06-30 22:52:53] [config] tempdir: /tmp
[2023-06-30 22:52:53] [config] tied-embeddings: false
[2023-06-30 22:52:53] [config] tied-embeddings-all: false
[2023-06-30 22:52:53] [config] tied-embeddings-src: false
[2023-06-30 22:52:53] [config] train-embedder-rank:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] train-sets:
[2023-06-30 22:52:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:52:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:52:53] [config] transformer-aan-activation: swish
[2023-06-30 22:52:53] [config] transformer-aan-depth: 2
[2023-06-30 22:52:53] [config] transformer-aan-nogate: false
[2023-06-30 22:52:53] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:52:53] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:52:53] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:52:53] [config] transformer-depth-scaling: false
[2023-06-30 22:52:53] [config] transformer-dim-aan: 2048
[2023-06-30 22:52:53] [config] transformer-dim-ffn: 2048
[2023-06-30 22:52:53] [config] transformer-dropout: 0
[2023-06-30 22:52:53] [config] transformer-dropout-attention: 0
[2023-06-30 22:52:53] [config] transformer-dropout-ffn: 0
[2023-06-30 22:52:53] [config] transformer-ffn-activation: swish
[2023-06-30 22:52:53] [config] transformer-ffn-depth: 2
[2023-06-30 22:52:53] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:52:53] [config] transformer-heads: 8
[2023-06-30 22:52:53] [config] transformer-no-projection: false
[2023-06-30 22:52:53] [config] transformer-pool: false
[2023-06-30 22:52:53] [config] transformer-postprocess: dan
[2023-06-30 22:52:53] [config] transformer-postprocess-emb: d
[2023-06-30 22:52:53] [config] transformer-postprocess-top: ""
[2023-06-30 22:52:53] [config] transformer-preprocess: ""
[2023-06-30 22:52:53] [config] transformer-tied-layers:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] transformer-train-position-embeddings: false
[2023-06-30 22:52:53] [config] tsv: false
[2023-06-30 22:52:53] [config] tsv-fields: 0
[2023-06-30 22:52:53] [config] type: transformer
[2023-06-30 22:52:53] [config] ulr: false
[2023-06-30 22:52:53] [config] ulr-dim-emb: 0
[2023-06-30 22:52:53] [config] ulr-dropout: 0
[2023-06-30 22:52:53] [config] ulr-keys-vectors: ""
[2023-06-30 22:52:53] [config] ulr-query-vectors: ""
[2023-06-30 22:52:53] [config] ulr-softmax-temperature: 1
[2023-06-30 22:52:53] [config] ulr-trainable-transformation: false
[2023-06-30 22:52:53] [config] unlikelihood-loss: false
[2023-06-30 22:52:53] [config] valid-freq: 50000000
[2023-06-30 22:52:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:52:53] [config] valid-max-length: 1000
[2023-06-30 22:52:53] [config] valid-metrics:
[2023-06-30 22:52:53] [config]   - cross-entropy
[2023-06-30 22:52:53] [config]   - translation
[2023-06-30 22:52:53] [config] valid-mini-batch: 32
[2023-06-30 22:52:53] [config] valid-reset-stalled: false
[2023-06-30 22:52:53] [config] valid-script-args:
[2023-06-30 22:52:53] [config]   []
[2023-06-30 22:52:53] [config] valid-script-path: ""
[2023-06-30 22:52:53] [config] valid-sets:
[2023-06-30 22:52:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:52:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:52:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:52:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:52:53] [config] vocabs:
[2023-06-30 22:52:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:52:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:52:53] [config] word-penalty: 0
[2023-06-30 22:52:53] [config] word-scores: false
[2023-06-30 22:52:53] [config] workspace: 2048
[2023-06-30 22:52:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:52:53] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:52:53] [training] Using single-device training
[2023-06-30 22:52:53] Synced seed 1234
[2023-06-30 22:52:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:52:54] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:52:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:52:54] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:52:54] [valid] No post-processing script given for validating translator
[2023-06-30 22:52:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:52:54] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:52:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:52:54] [comm] Using global sharding
[2023-06-30 22:52:54] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:52:54] [training] Using 1 GPUs
[2023-06-30 22:52:54] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:52:56] Loading Adam parameters
[2023-06-30 22:52:57] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:52:57] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:52:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:52:57] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-06-30 22:52:57] [data] Shuffling data
[2023-06-30 22:52:57] [data] Done reading 20,192 sentences
[2023-06-30 22:52:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:52:57] Training started
[2023-06-30 22:52:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:52:57] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:52:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:52:57] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:52:57] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:53:01] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 0.10445670 * 1,344,567 @ 1,231 after 8,052,546 : Time 7.43s : 180898.02 words/s : gNorm 1.0144
[2023-06-30 22:53:14] Seen 18,843 samples
[2023-06-30 22:53:14] Starting data epoch 22 in logical epoch 22
[2023-06-30 22:53:14] [data] Shuffling data
[2023-06-30 22:53:14] [data] Done reading 20,192 sentences
[2023-06-30 22:53:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:53:32] Seen 18,843 samples
[2023-06-30 22:53:32] Starting data epoch 23 in logical epoch 23
[2023-06-30 22:53:32] [data] Shuffling data
[2023-06-30 22:53:32] [data] Done reading 20,192 sentences
[2023-06-30 22:53:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:53:51] Seen 18,843 samples
[2023-06-30 22:53:51] Starting data epoch 24 in logical epoch 24
[2023-06-30 22:53:51] [data] Shuffling data
[2023-06-30 22:53:51] [data] Done reading 20,192 sentences
[2023-06-30 22:53:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:54:03] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 0.05538064 * 1,339,673 @ 704 after 9,392,219 : Time 62.06s : 21588.30 words/s : gNorm 0.9309
[2023-06-30 22:54:11] Seen 18,843 samples
[2023-06-30 22:54:11] Starting data epoch 25 in logical epoch 25
[2023-06-30 22:54:11] [data] Shuffling data
[2023-06-30 22:54:11] [data] Done reading 20,192 sentences
[2023-06-30 22:54:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:54:30] Seen 18,843 samples
[2023-06-30 22:54:30] Starting data epoch 26 in logical epoch 26
[2023-06-30 22:54:30] [data] Shuffling data
[2023-06-30 22:54:30] [data] Done reading 20,192 sentences
[2023-06-30 22:54:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:54:49] Seen 18,843 samples
[2023-06-30 22:54:49] Starting data epoch 27 in logical epoch 27
[2023-06-30 22:54:49] [data] Shuffling data
[2023-06-30 22:54:49] [data] Done reading 20,192 sentences
[2023-06-30 22:54:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:55:08] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 0.03841622 * 1,339,074 @ 1,034 after 10,731,293 : Time 64.98s : 20607.03 words/s : gNorm 0.8398
[2023-06-30 22:55:09] Seen 18,843 samples
[2023-06-30 22:55:09] Starting data epoch 28 in logical epoch 28
[2023-06-30 22:55:09] [data] Shuffling data
[2023-06-30 22:55:09] [data] Done reading 20,192 sentences
[2023-06-30 22:55:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:55:29] Seen 18,843 samples
[2023-06-30 22:55:29] Starting data epoch 29 in logical epoch 29
[2023-06-30 22:55:29] [data] Shuffling data
[2023-06-30 22:55:29] [data] Done reading 20,192 sentences
[2023-06-30 22:55:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:55:48] Seen 18,843 samples
[2023-06-30 22:55:48] Starting data epoch 30 in logical epoch 30
[2023-06-30 22:55:48] [data] Shuffling data
[2023-06-30 22:55:48] [data] Done reading 20,192 sentences
[2023-06-30 22:55:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:56:07] Seen 18,843 samples
[2023-06-30 22:56:07] Starting data epoch 31 in logical epoch 31
[2023-06-30 22:56:07] Training finished
[2023-06-30 22:56:10] [valid] Ep. 31 : Up. 8898 : cross-entropy : 169.057 : stalled 2 times (last best: 125.788)
[2023-06-30 22:58:12] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-06-30 22:58:12] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:58:15] Saving Adam parameters
[2023-06-30 22:58:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:58:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:58:26] [marian] Running on node20.datos.cluster.uy as process 4005 with command line:
[2023-06-30 22:58:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 22:58:26] [config] after: 0e
[2023-06-30 22:58:26] [config] after-batches: 0
[2023-06-30 22:58:26] [config] after-epochs: 40
[2023-06-30 22:58:26] [config] all-caps-every: 0
[2023-06-30 22:58:26] [config] allow-unk: false
[2023-06-30 22:58:26] [config] authors: false
[2023-06-30 22:58:26] [config] beam-size: 12
[2023-06-30 22:58:26] [config] bert-class-symbol: "[CLS]"
[2023-06-30 22:58:26] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 22:58:26] [config] bert-masking-fraction: 0.15
[2023-06-30 22:58:26] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 22:58:26] [config] bert-train-type-embeddings: true
[2023-06-30 22:58:26] [config] bert-type-vocab-size: 2
[2023-06-30 22:58:26] [config] build-info: ""
[2023-06-30 22:58:26] [config] check-gradient-nan: false
[2023-06-30 22:58:26] [config] check-nan: false
[2023-06-30 22:58:26] [config] cite: false
[2023-06-30 22:58:26] [config] clip-norm: 1
[2023-06-30 22:58:26] [config] cost-scaling:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] cost-type: ce-sum
[2023-06-30 22:58:26] [config] cpu-threads: 0
[2023-06-30 22:58:26] [config] data-threads: 8
[2023-06-30 22:58:26] [config] data-weighting: ""
[2023-06-30 22:58:26] [config] data-weighting-type: sentence
[2023-06-30 22:58:26] [config] dec-cell: gru
[2023-06-30 22:58:26] [config] dec-cell-base-depth: 2
[2023-06-30 22:58:26] [config] dec-cell-high-depth: 1
[2023-06-30 22:58:26] [config] dec-depth: 1
[2023-06-30 22:58:26] [config] devices:
[2023-06-30 22:58:26] [config]   - 0
[2023-06-30 22:58:26] [config] dim-emb: 512
[2023-06-30 22:58:26] [config] dim-rnn: 1024
[2023-06-30 22:58:26] [config] dim-vocabs:
[2023-06-30 22:58:26] [config]   - 54042
[2023-06-30 22:58:26] [config]   - 36507
[2023-06-30 22:58:26] [config] disp-first: 0
[2023-06-30 22:58:26] [config] disp-freq: 1000u
[2023-06-30 22:58:26] [config] disp-label-counts: true
[2023-06-30 22:58:26] [config] dropout-rnn: 0
[2023-06-30 22:58:26] [config] dropout-src: 0
[2023-06-30 22:58:26] [config] dropout-trg: 0
[2023-06-30 22:58:26] [config] dump-config: ""
[2023-06-30 22:58:26] [config] dynamic-gradient-scaling:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] early-stopping: 10
[2023-06-30 22:58:26] [config] early-stopping-on: first
[2023-06-30 22:58:26] [config] embedding-fix-src: false
[2023-06-30 22:58:26] [config] embedding-fix-trg: false
[2023-06-30 22:58:26] [config] embedding-normalization: false
[2023-06-30 22:58:26] [config] embedding-vectors:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] enc-cell: gru
[2023-06-30 22:58:26] [config] enc-cell-depth: 1
[2023-06-30 22:58:26] [config] enc-depth: 1
[2023-06-30 22:58:26] [config] enc-type: bidirectional
[2023-06-30 22:58:26] [config] english-title-case-every: 0
[2023-06-30 22:58:26] [config] exponential-smoothing: 0
[2023-06-30 22:58:26] [config] factor-weight: 1
[2023-06-30 22:58:26] [config] factors-combine: sum
[2023-06-30 22:58:26] [config] factors-dim-emb: 0
[2023-06-30 22:58:26] [config] gradient-checkpointing: false
[2023-06-30 22:58:26] [config] gradient-norm-average-window: 100
[2023-06-30 22:58:26] [config] guided-alignment: none
[2023-06-30 22:58:26] [config] guided-alignment-cost: mse
[2023-06-30 22:58:26] [config] guided-alignment-weight: 0.1
[2023-06-30 22:58:26] [config] ignore-model-config: false
[2023-06-30 22:58:26] [config] input-types:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] interpolate-env-vars: false
[2023-06-30 22:58:26] [config] keep-best: false
[2023-06-30 22:58:26] [config] label-smoothing: 0
[2023-06-30 22:58:26] [config] layer-normalization: false
[2023-06-30 22:58:26] [config] learn-rate: 0.0001
[2023-06-30 22:58:26] [config] lemma-dependency: ""
[2023-06-30 22:58:26] [config] lemma-dim-emb: 0
[2023-06-30 22:58:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 22:58:26] [config] log-level: info
[2023-06-30 22:58:26] [config] log-time-zone: ""
[2023-06-30 22:58:26] [config] logical-epoch:
[2023-06-30 22:58:26] [config]   - 1e
[2023-06-30 22:58:26] [config]   - 0
[2023-06-30 22:58:26] [config] lr-decay: 0
[2023-06-30 22:58:26] [config] lr-decay-freq: 50000
[2023-06-30 22:58:26] [config] lr-decay-inv-sqrt:
[2023-06-30 22:58:26] [config]   - 0
[2023-06-30 22:58:26] [config] lr-decay-repeat-warmup: false
[2023-06-30 22:58:26] [config] lr-decay-reset-optimizer: false
[2023-06-30 22:58:26] [config] lr-decay-start:
[2023-06-30 22:58:26] [config]   - 10
[2023-06-30 22:58:26] [config]   - 1
[2023-06-30 22:58:26] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 22:58:26] [config] lr-report: false
[2023-06-30 22:58:26] [config] lr-warmup: 0
[2023-06-30 22:58:26] [config] lr-warmup-at-reload: false
[2023-06-30 22:58:26] [config] lr-warmup-cycle: false
[2023-06-30 22:58:26] [config] lr-warmup-start-rate: 0
[2023-06-30 22:58:26] [config] max-length: 50
[2023-06-30 22:58:26] [config] max-length-crop: false
[2023-06-30 22:58:26] [config] max-length-factor: 3
[2023-06-30 22:58:26] [config] maxi-batch: 100
[2023-06-30 22:58:26] [config] maxi-batch-sort: trg
[2023-06-30 22:58:26] [config] mini-batch: 64
[2023-06-30 22:58:26] [config] mini-batch-fit: false
[2023-06-30 22:58:26] [config] mini-batch-fit-step: 10
[2023-06-30 22:58:26] [config] mini-batch-round-up: true
[2023-06-30 22:58:26] [config] mini-batch-track-lr: false
[2023-06-30 22:58:26] [config] mini-batch-warmup: 0
[2023-06-30 22:58:26] [config] mini-batch-words: 0
[2023-06-30 22:58:26] [config] mini-batch-words-ref: 0
[2023-06-30 22:58:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:58:26] [config] multi-loss-type: sum
[2023-06-30 22:58:26] [config] n-best: false
[2023-06-30 22:58:26] [config] no-nccl: false
[2023-06-30 22:58:26] [config] no-reload: false
[2023-06-30 22:58:26] [config] no-restore-corpus: false
[2023-06-30 22:58:26] [config] normalize: 0
[2023-06-30 22:58:26] [config] normalize-gradient: false
[2023-06-30 22:58:26] [config] num-devices: 0
[2023-06-30 22:58:26] [config] optimizer: adam
[2023-06-30 22:58:26] [config] optimizer-delay: 1
[2023-06-30 22:58:26] [config] optimizer-params:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] output-omit-bias: false
[2023-06-30 22:58:26] [config] overwrite: true
[2023-06-30 22:58:26] [config] precision:
[2023-06-30 22:58:26] [config]   - float32
[2023-06-30 22:58:26] [config]   - float32
[2023-06-30 22:58:26] [config] pretrained-model: ""
[2023-06-30 22:58:26] [config] quantize-biases: false
[2023-06-30 22:58:26] [config] quantize-bits: 0
[2023-06-30 22:58:26] [config] quantize-log-based: false
[2023-06-30 22:58:26] [config] quantize-optimization-steps: 0
[2023-06-30 22:58:26] [config] quiet: false
[2023-06-30 22:58:26] [config] quiet-translation: true
[2023-06-30 22:58:26] [config] relative-paths: false
[2023-06-30 22:58:26] [config] right-left: false
[2023-06-30 22:58:26] [config] save-freq: 10000u
[2023-06-30 22:58:26] [config] seed: 1234
[2023-06-30 22:58:26] [config] sentencepiece-alphas:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] sentencepiece-max-lines: 2000000
[2023-06-30 22:58:26] [config] sentencepiece-options: ""
[2023-06-30 22:58:26] [config] sharding: global
[2023-06-30 22:58:26] [config] shuffle: data
[2023-06-30 22:58:26] [config] shuffle-in-ram: false
[2023-06-30 22:58:26] [config] sigterm: save-and-exit
[2023-06-30 22:58:26] [config] skip: false
[2023-06-30 22:58:26] [config] sqlite: ""
[2023-06-30 22:58:26] [config] sqlite-drop: false
[2023-06-30 22:58:26] [config] sync-freq: 200u
[2023-06-30 22:58:26] [config] sync-sgd: false
[2023-06-30 22:58:26] [config] tempdir: /tmp
[2023-06-30 22:58:26] [config] tied-embeddings: false
[2023-06-30 22:58:26] [config] tied-embeddings-all: false
[2023-06-30 22:58:26] [config] tied-embeddings-src: false
[2023-06-30 22:58:26] [config] train-embedder-rank:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] train-sets:
[2023-06-30 22:58:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 22:58:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 22:58:26] [config] transformer-aan-activation: swish
[2023-06-30 22:58:26] [config] transformer-aan-depth: 2
[2023-06-30 22:58:26] [config] transformer-aan-nogate: false
[2023-06-30 22:58:26] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 22:58:26] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 22:58:26] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 22:58:26] [config] transformer-depth-scaling: false
[2023-06-30 22:58:26] [config] transformer-dim-aan: 2048
[2023-06-30 22:58:26] [config] transformer-dim-ffn: 2048
[2023-06-30 22:58:26] [config] transformer-dropout: 0
[2023-06-30 22:58:26] [config] transformer-dropout-attention: 0
[2023-06-30 22:58:26] [config] transformer-dropout-ffn: 0
[2023-06-30 22:58:26] [config] transformer-ffn-activation: swish
[2023-06-30 22:58:26] [config] transformer-ffn-depth: 2
[2023-06-30 22:58:26] [config] transformer-guided-alignment-layer: last
[2023-06-30 22:58:26] [config] transformer-heads: 8
[2023-06-30 22:58:26] [config] transformer-no-projection: false
[2023-06-30 22:58:26] [config] transformer-pool: false
[2023-06-30 22:58:26] [config] transformer-postprocess: dan
[2023-06-30 22:58:26] [config] transformer-postprocess-emb: d
[2023-06-30 22:58:26] [config] transformer-postprocess-top: ""
[2023-06-30 22:58:26] [config] transformer-preprocess: ""
[2023-06-30 22:58:26] [config] transformer-tied-layers:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] transformer-train-position-embeddings: false
[2023-06-30 22:58:26] [config] tsv: false
[2023-06-30 22:58:26] [config] tsv-fields: 0
[2023-06-30 22:58:26] [config] type: transformer
[2023-06-30 22:58:26] [config] ulr: false
[2023-06-30 22:58:26] [config] ulr-dim-emb: 0
[2023-06-30 22:58:26] [config] ulr-dropout: 0
[2023-06-30 22:58:26] [config] ulr-keys-vectors: ""
[2023-06-30 22:58:26] [config] ulr-query-vectors: ""
[2023-06-30 22:58:26] [config] ulr-softmax-temperature: 1
[2023-06-30 22:58:26] [config] ulr-trainable-transformation: false
[2023-06-30 22:58:26] [config] unlikelihood-loss: false
[2023-06-30 22:58:26] [config] valid-freq: 50000000
[2023-06-30 22:58:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 22:58:26] [config] valid-max-length: 1000
[2023-06-30 22:58:26] [config] valid-metrics:
[2023-06-30 22:58:26] [config]   - cross-entropy
[2023-06-30 22:58:26] [config]   - translation
[2023-06-30 22:58:26] [config] valid-mini-batch: 32
[2023-06-30 22:58:26] [config] valid-reset-stalled: false
[2023-06-30 22:58:26] [config] valid-script-args:
[2023-06-30 22:58:26] [config]   []
[2023-06-30 22:58:26] [config] valid-script-path: ""
[2023-06-30 22:58:26] [config] valid-sets:
[2023-06-30 22:58:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 22:58:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 22:58:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 22:58:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:58:26] [config] vocabs:
[2023-06-30 22:58:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:58:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:58:26] [config] word-penalty: 0
[2023-06-30 22:58:26] [config] word-scores: false
[2023-06-30 22:58:26] [config] workspace: 2048
[2023-06-30 22:58:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 22:58:26] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:58:26] [training] Using single-device training
[2023-06-30 22:58:27] Synced seed 1234
[2023-06-30 22:58:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 22:58:27] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 22:58:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 22:58:27] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 22:58:27] [valid] No post-processing script given for validating translator
[2023-06-30 22:58:27] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 22:58:27] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 22:58:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 22:58:28] [comm] Using global sharding
[2023-06-30 22:58:28] [comm] NCCLCommunicators constructed successfully
[2023-06-30 22:58:28] [training] Using 1 GPUs
[2023-06-30 22:58:28] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:58:29] Loading Adam parameters
[2023-06-30 22:58:30] [memory] Reserving 552 MB, device gpu0
[2023-06-30 22:58:30] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:58:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:58:30] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-06-30 22:58:30] [data] Shuffling data
[2023-06-30 22:58:30] [data] Done reading 20,192 sentences
[2023-06-30 22:58:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:58:30] Training started
[2023-06-30 22:58:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 22:58:30] [logits] Applying loss function for 1 factor(s)
[2023-06-30 22:58:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 22:58:30] [memory] Reserving 276 MB, device gpu0
[2023-06-30 22:58:30] Parameter type float32, optimization type float32, casting types false
[2023-06-30 22:58:36] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 0.02857976 * 1,341,072 @ 320 after 12,072,365 : Time 9.22s : 145392.55 words/s : gNorm 0.7578
[2023-06-30 22:58:47] Seen 18,843 samples
[2023-06-30 22:58:47] Starting data epoch 32 in logical epoch 32
[2023-06-30 22:58:47] [data] Shuffling data
[2023-06-30 22:58:47] [data] Done reading 20,192 sentences
[2023-06-30 22:58:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:59:06] Seen 18,843 samples
[2023-06-30 22:59:06] Starting data epoch 33 in logical epoch 33
[2023-06-30 22:59:06] [data] Shuffling data
[2023-06-30 22:59:06] [data] Done reading 20,192 sentences
[2023-06-30 22:59:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:59:25] Seen 18,843 samples
[2023-06-30 22:59:25] Starting data epoch 34 in logical epoch 34
[2023-06-30 22:59:25] [data] Shuffling data
[2023-06-30 22:59:25] [data] Done reading 20,192 sentences
[2023-06-30 22:59:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 22:59:39] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 0.02380039 * 1,347,521 @ 882 after 13,419,886 : Time 62.72s : 21483.54 words/s : gNorm 0.7274
[2023-06-30 22:59:39] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 22:59:41] Saving Adam parameters
[2023-06-30 22:59:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 22:59:54] Seen 18,843 samples
[2023-06-30 22:59:54] Starting data epoch 35 in logical epoch 35
[2023-06-30 22:59:54] [data] Shuffling data
[2023-06-30 22:59:54] [data] Done reading 20,192 sentences
[2023-06-30 22:59:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:00:12] Seen 18,843 samples
[2023-06-30 23:00:12] Starting data epoch 36 in logical epoch 36
[2023-06-30 23:00:12] [data] Shuffling data
[2023-06-30 23:00:12] [data] Done reading 20,192 sentences
[2023-06-30 23:00:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:00:31] Seen 18,843 samples
[2023-06-30 23:00:31] Starting data epoch 37 in logical epoch 37
[2023-06-30 23:00:31] [data] Shuffling data
[2023-06-30 23:00:31] [data] Done reading 20,192 sentences
[2023-06-30 23:00:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:00:50] Seen 18,843 samples
[2023-06-30 23:00:50] Starting data epoch 38 in logical epoch 38
[2023-06-30 23:00:50] [data] Shuffling data
[2023-06-30 23:00:50] [data] Done reading 20,192 sentences
[2023-06-30 23:00:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:00:52] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 0.01987397 * 1,344,952 @ 1,403 after 14,764,838 : Time 73.53s : 18291.21 words/s : gNorm 0.7030
[2023-06-30 23:01:09] Seen 18,843 samples
[2023-06-30 23:01:09] Starting data epoch 39 in logical epoch 39
[2023-06-30 23:01:09] [data] Shuffling data
[2023-06-30 23:01:09] [data] Done reading 20,192 sentences
[2023-06-30 23:01:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:01:29] Seen 18,843 samples
[2023-06-30 23:01:29] Starting data epoch 40 in logical epoch 40
[2023-06-30 23:01:29] [data] Shuffling data
[2023-06-30 23:01:29] [data] Done reading 20,192 sentences
[2023-06-30 23:01:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:01:48] Seen 18,843 samples
[2023-06-30 23:01:48] Starting data epoch 41 in logical epoch 41
[2023-06-30 23:01:48] Training finished
[2023-06-30 23:01:51] [valid] Ep. 41 : Up. 11864 : cross-entropy : 177.085 : stalled 3 times (last best: 125.788)
[2023-06-30 23:04:05] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-06-30 23:04:05] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:04:08] Saving Adam parameters
[2023-06-30 23:04:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:04:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:04:20] [marian] Running on node20.datos.cluster.uy as process 4374 with command line:
[2023-06-30 23:04:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:04:20] [config] after: 0e
[2023-06-30 23:04:20] [config] after-batches: 0
[2023-06-30 23:04:20] [config] after-epochs: 50
[2023-06-30 23:04:20] [config] all-caps-every: 0
[2023-06-30 23:04:20] [config] allow-unk: false
[2023-06-30 23:04:20] [config] authors: false
[2023-06-30 23:04:20] [config] beam-size: 12
[2023-06-30 23:04:20] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:04:20] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:04:20] [config] bert-masking-fraction: 0.15
[2023-06-30 23:04:20] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:04:20] [config] bert-train-type-embeddings: true
[2023-06-30 23:04:20] [config] bert-type-vocab-size: 2
[2023-06-30 23:04:20] [config] build-info: ""
[2023-06-30 23:04:20] [config] check-gradient-nan: false
[2023-06-30 23:04:20] [config] check-nan: false
[2023-06-30 23:04:20] [config] cite: false
[2023-06-30 23:04:20] [config] clip-norm: 1
[2023-06-30 23:04:20] [config] cost-scaling:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] cost-type: ce-sum
[2023-06-30 23:04:20] [config] cpu-threads: 0
[2023-06-30 23:04:20] [config] data-threads: 8
[2023-06-30 23:04:20] [config] data-weighting: ""
[2023-06-30 23:04:20] [config] data-weighting-type: sentence
[2023-06-30 23:04:20] [config] dec-cell: gru
[2023-06-30 23:04:20] [config] dec-cell-base-depth: 2
[2023-06-30 23:04:20] [config] dec-cell-high-depth: 1
[2023-06-30 23:04:20] [config] dec-depth: 1
[2023-06-30 23:04:20] [config] devices:
[2023-06-30 23:04:20] [config]   - 0
[2023-06-30 23:04:20] [config] dim-emb: 512
[2023-06-30 23:04:20] [config] dim-rnn: 1024
[2023-06-30 23:04:20] [config] dim-vocabs:
[2023-06-30 23:04:20] [config]   - 54042
[2023-06-30 23:04:20] [config]   - 36507
[2023-06-30 23:04:20] [config] disp-first: 0
[2023-06-30 23:04:20] [config] disp-freq: 1000u
[2023-06-30 23:04:20] [config] disp-label-counts: true
[2023-06-30 23:04:20] [config] dropout-rnn: 0
[2023-06-30 23:04:20] [config] dropout-src: 0
[2023-06-30 23:04:20] [config] dropout-trg: 0
[2023-06-30 23:04:20] [config] dump-config: ""
[2023-06-30 23:04:20] [config] dynamic-gradient-scaling:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] early-stopping: 10
[2023-06-30 23:04:20] [config] early-stopping-on: first
[2023-06-30 23:04:20] [config] embedding-fix-src: false
[2023-06-30 23:04:20] [config] embedding-fix-trg: false
[2023-06-30 23:04:20] [config] embedding-normalization: false
[2023-06-30 23:04:20] [config] embedding-vectors:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] enc-cell: gru
[2023-06-30 23:04:20] [config] enc-cell-depth: 1
[2023-06-30 23:04:20] [config] enc-depth: 1
[2023-06-30 23:04:20] [config] enc-type: bidirectional
[2023-06-30 23:04:20] [config] english-title-case-every: 0
[2023-06-30 23:04:20] [config] exponential-smoothing: 0
[2023-06-30 23:04:20] [config] factor-weight: 1
[2023-06-30 23:04:20] [config] factors-combine: sum
[2023-06-30 23:04:20] [config] factors-dim-emb: 0
[2023-06-30 23:04:20] [config] gradient-checkpointing: false
[2023-06-30 23:04:20] [config] gradient-norm-average-window: 100
[2023-06-30 23:04:20] [config] guided-alignment: none
[2023-06-30 23:04:20] [config] guided-alignment-cost: mse
[2023-06-30 23:04:20] [config] guided-alignment-weight: 0.1
[2023-06-30 23:04:20] [config] ignore-model-config: false
[2023-06-30 23:04:20] [config] input-types:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] interpolate-env-vars: false
[2023-06-30 23:04:20] [config] keep-best: false
[2023-06-30 23:04:20] [config] label-smoothing: 0
[2023-06-30 23:04:20] [config] layer-normalization: false
[2023-06-30 23:04:20] [config] learn-rate: 0.0001
[2023-06-30 23:04:20] [config] lemma-dependency: ""
[2023-06-30 23:04:20] [config] lemma-dim-emb: 0
[2023-06-30 23:04:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:04:20] [config] log-level: info
[2023-06-30 23:04:20] [config] log-time-zone: ""
[2023-06-30 23:04:20] [config] logical-epoch:
[2023-06-30 23:04:20] [config]   - 1e
[2023-06-30 23:04:20] [config]   - 0
[2023-06-30 23:04:20] [config] lr-decay: 0
[2023-06-30 23:04:20] [config] lr-decay-freq: 50000
[2023-06-30 23:04:20] [config] lr-decay-inv-sqrt:
[2023-06-30 23:04:20] [config]   - 0
[2023-06-30 23:04:20] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:04:20] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:04:20] [config] lr-decay-start:
[2023-06-30 23:04:20] [config]   - 10
[2023-06-30 23:04:20] [config]   - 1
[2023-06-30 23:04:20] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:04:20] [config] lr-report: false
[2023-06-30 23:04:20] [config] lr-warmup: 0
[2023-06-30 23:04:20] [config] lr-warmup-at-reload: false
[2023-06-30 23:04:20] [config] lr-warmup-cycle: false
[2023-06-30 23:04:20] [config] lr-warmup-start-rate: 0
[2023-06-30 23:04:20] [config] max-length: 50
[2023-06-30 23:04:20] [config] max-length-crop: false
[2023-06-30 23:04:20] [config] max-length-factor: 3
[2023-06-30 23:04:20] [config] maxi-batch: 100
[2023-06-30 23:04:20] [config] maxi-batch-sort: trg
[2023-06-30 23:04:20] [config] mini-batch: 64
[2023-06-30 23:04:20] [config] mini-batch-fit: false
[2023-06-30 23:04:20] [config] mini-batch-fit-step: 10
[2023-06-30 23:04:20] [config] mini-batch-round-up: true
[2023-06-30 23:04:20] [config] mini-batch-track-lr: false
[2023-06-30 23:04:20] [config] mini-batch-warmup: 0
[2023-06-30 23:04:20] [config] mini-batch-words: 0
[2023-06-30 23:04:20] [config] mini-batch-words-ref: 0
[2023-06-30 23:04:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:04:20] [config] multi-loss-type: sum
[2023-06-30 23:04:20] [config] n-best: false
[2023-06-30 23:04:20] [config] no-nccl: false
[2023-06-30 23:04:20] [config] no-reload: false
[2023-06-30 23:04:20] [config] no-restore-corpus: false
[2023-06-30 23:04:20] [config] normalize: 0
[2023-06-30 23:04:20] [config] normalize-gradient: false
[2023-06-30 23:04:20] [config] num-devices: 0
[2023-06-30 23:04:20] [config] optimizer: adam
[2023-06-30 23:04:20] [config] optimizer-delay: 1
[2023-06-30 23:04:20] [config] optimizer-params:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] output-omit-bias: false
[2023-06-30 23:04:20] [config] overwrite: true
[2023-06-30 23:04:20] [config] precision:
[2023-06-30 23:04:20] [config]   - float32
[2023-06-30 23:04:20] [config]   - float32
[2023-06-30 23:04:20] [config] pretrained-model: ""
[2023-06-30 23:04:20] [config] quantize-biases: false
[2023-06-30 23:04:20] [config] quantize-bits: 0
[2023-06-30 23:04:20] [config] quantize-log-based: false
[2023-06-30 23:04:20] [config] quantize-optimization-steps: 0
[2023-06-30 23:04:20] [config] quiet: false
[2023-06-30 23:04:20] [config] quiet-translation: true
[2023-06-30 23:04:20] [config] relative-paths: false
[2023-06-30 23:04:20] [config] right-left: false
[2023-06-30 23:04:20] [config] save-freq: 10000u
[2023-06-30 23:04:20] [config] seed: 1234
[2023-06-30 23:04:20] [config] sentencepiece-alphas:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:04:20] [config] sentencepiece-options: ""
[2023-06-30 23:04:20] [config] sharding: global
[2023-06-30 23:04:20] [config] shuffle: data
[2023-06-30 23:04:20] [config] shuffle-in-ram: false
[2023-06-30 23:04:20] [config] sigterm: save-and-exit
[2023-06-30 23:04:20] [config] skip: false
[2023-06-30 23:04:20] [config] sqlite: ""
[2023-06-30 23:04:20] [config] sqlite-drop: false
[2023-06-30 23:04:20] [config] sync-freq: 200u
[2023-06-30 23:04:20] [config] sync-sgd: false
[2023-06-30 23:04:20] [config] tempdir: /tmp
[2023-06-30 23:04:20] [config] tied-embeddings: false
[2023-06-30 23:04:20] [config] tied-embeddings-all: false
[2023-06-30 23:04:20] [config] tied-embeddings-src: false
[2023-06-30 23:04:20] [config] train-embedder-rank:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] train-sets:
[2023-06-30 23:04:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:04:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:04:20] [config] transformer-aan-activation: swish
[2023-06-30 23:04:20] [config] transformer-aan-depth: 2
[2023-06-30 23:04:20] [config] transformer-aan-nogate: false
[2023-06-30 23:04:20] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:04:20] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:04:20] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:04:20] [config] transformer-depth-scaling: false
[2023-06-30 23:04:20] [config] transformer-dim-aan: 2048
[2023-06-30 23:04:20] [config] transformer-dim-ffn: 2048
[2023-06-30 23:04:20] [config] transformer-dropout: 0
[2023-06-30 23:04:20] [config] transformer-dropout-attention: 0
[2023-06-30 23:04:20] [config] transformer-dropout-ffn: 0
[2023-06-30 23:04:20] [config] transformer-ffn-activation: swish
[2023-06-30 23:04:20] [config] transformer-ffn-depth: 2
[2023-06-30 23:04:20] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:04:20] [config] transformer-heads: 8
[2023-06-30 23:04:20] [config] transformer-no-projection: false
[2023-06-30 23:04:20] [config] transformer-pool: false
[2023-06-30 23:04:20] [config] transformer-postprocess: dan
[2023-06-30 23:04:20] [config] transformer-postprocess-emb: d
[2023-06-30 23:04:20] [config] transformer-postprocess-top: ""
[2023-06-30 23:04:20] [config] transformer-preprocess: ""
[2023-06-30 23:04:20] [config] transformer-tied-layers:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] transformer-train-position-embeddings: false
[2023-06-30 23:04:20] [config] tsv: false
[2023-06-30 23:04:20] [config] tsv-fields: 0
[2023-06-30 23:04:20] [config] type: transformer
[2023-06-30 23:04:20] [config] ulr: false
[2023-06-30 23:04:20] [config] ulr-dim-emb: 0
[2023-06-30 23:04:20] [config] ulr-dropout: 0
[2023-06-30 23:04:20] [config] ulr-keys-vectors: ""
[2023-06-30 23:04:20] [config] ulr-query-vectors: ""
[2023-06-30 23:04:20] [config] ulr-softmax-temperature: 1
[2023-06-30 23:04:20] [config] ulr-trainable-transformation: false
[2023-06-30 23:04:20] [config] unlikelihood-loss: false
[2023-06-30 23:04:20] [config] valid-freq: 50000000
[2023-06-30 23:04:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:04:20] [config] valid-max-length: 1000
[2023-06-30 23:04:20] [config] valid-metrics:
[2023-06-30 23:04:20] [config]   - cross-entropy
[2023-06-30 23:04:20] [config]   - translation
[2023-06-30 23:04:20] [config] valid-mini-batch: 32
[2023-06-30 23:04:20] [config] valid-reset-stalled: false
[2023-06-30 23:04:20] [config] valid-script-args:
[2023-06-30 23:04:20] [config]   []
[2023-06-30 23:04:20] [config] valid-script-path: ""
[2023-06-30 23:04:20] [config] valid-sets:
[2023-06-30 23:04:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:04:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:04:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:04:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:04:20] [config] vocabs:
[2023-06-30 23:04:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:04:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:04:20] [config] word-penalty: 0
[2023-06-30 23:04:20] [config] word-scores: false
[2023-06-30 23:04:20] [config] workspace: 2048
[2023-06-30 23:04:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:04:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:04:20] [training] Using single-device training
[2023-06-30 23:04:21] Synced seed 1234
[2023-06-30 23:04:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:04:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:04:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:04:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:04:21] [valid] No post-processing script given for validating translator
[2023-06-30 23:04:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:04:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:04:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:04:22] [comm] Using global sharding
[2023-06-30 23:04:22] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:04:22] [training] Using 1 GPUs
[2023-06-30 23:04:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:04:24] Loading Adam parameters
[2023-06-30 23:04:24] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:04:24] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:04:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:04:24] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-06-30 23:04:24] [data] Shuffling data
[2023-06-30 23:04:24] [data] Done reading 20,192 sentences
[2023-06-30 23:04:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:04:24] Training started
[2023-06-30 23:04:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 23:04:24] [logits] Applying loss function for 1 factor(s)
[2023-06-30 23:04:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 23:04:24] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:04:24] Parameter type float32, optimization type float32, casting types false
[2023-06-30 23:04:32] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 0.01713602 * 1,335,380 @ 968 after 16,100,218 : Time 11.32s : 118002.93 words/s : gNorm 0.5887
[2023-06-30 23:04:41] Seen 18,843 samples
[2023-06-30 23:04:41] Starting data epoch 42 in logical epoch 42
[2023-06-30 23:04:41] [data] Shuffling data
[2023-06-30 23:04:41] [data] Done reading 20,192 sentences
[2023-06-30 23:04:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:04:59] Seen 18,843 samples
[2023-06-30 23:04:59] Starting data epoch 43 in logical epoch 43
[2023-06-30 23:04:59] [data] Shuffling data
[2023-06-30 23:04:59] [data] Done reading 20,192 sentences
[2023-06-30 23:04:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:05:18] Seen 18,843 samples
[2023-06-30 23:05:18] Starting data epoch 44 in logical epoch 44
[2023-06-30 23:05:18] [data] Shuffling data
[2023-06-30 23:05:18] [data] Done reading 20,192 sentences
[2023-06-30 23:05:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:05:34] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 0.01605034 * 1,337,866 @ 718 after 17,438,084 : Time 62.11s : 21541.39 words/s : gNorm 0.6480
[2023-06-30 23:05:37] Seen 18,843 samples
[2023-06-30 23:05:37] Starting data epoch 45 in logical epoch 45
[2023-06-30 23:05:37] [data] Shuffling data
[2023-06-30 23:05:37] [data] Done reading 20,192 sentences
[2023-06-30 23:05:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:05:57] Seen 18,843 samples
[2023-06-30 23:05:57] Starting data epoch 46 in logical epoch 46
[2023-06-30 23:05:57] [data] Shuffling data
[2023-06-30 23:05:57] [data] Done reading 20,192 sentences
[2023-06-30 23:05:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:06:17] Seen 18,843 samples
[2023-06-30 23:06:17] Starting data epoch 47 in logical epoch 47
[2023-06-30 23:06:17] [data] Shuffling data
[2023-06-30 23:06:17] [data] Done reading 20,192 sentences
[2023-06-30 23:06:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:06:36] Seen 18,843 samples
[2023-06-30 23:06:36] Starting data epoch 48 in logical epoch 48
[2023-06-30 23:06:36] [data] Shuffling data
[2023-06-30 23:06:36] [data] Done reading 20,192 sentences
[2023-06-30 23:06:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:06:40] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 0.01431409 * 1,348,446 @ 1,408 after 18,786,530 : Time 66.01s : 20429.31 words/s : gNorm 0.5873
[2023-06-30 23:06:56] Seen 18,843 samples
[2023-06-30 23:06:56] Starting data epoch 49 in logical epoch 49
[2023-06-30 23:06:56] [data] Shuffling data
[2023-06-30 23:06:56] [data] Done reading 20,192 sentences
[2023-06-30 23:06:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:07:15] Seen 18,843 samples
[2023-06-30 23:07:15] Starting data epoch 50 in logical epoch 50
[2023-06-30 23:07:15] [data] Shuffling data
[2023-06-30 23:07:15] [data] Done reading 20,192 sentences
[2023-06-30 23:07:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:07:34] Seen 18,843 samples
[2023-06-30 23:07:34] Starting data epoch 51 in logical epoch 51
[2023-06-30 23:07:34] Training finished
[2023-06-30 23:07:36] [valid] Ep. 51 : Up. 14829 : cross-entropy : 181.552 : stalled 4 times (last best: 125.788)
[2023-06-30 23:09:47] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-06-30 23:09:47] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:09:50] Saving Adam parameters
[2023-06-30 23:09:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:10:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:10:01] [marian] Running on node20.datos.cluster.uy as process 5031 with command line:
[2023-06-30 23:10:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:10:01] [config] after: 0e
[2023-06-30 23:10:01] [config] after-batches: 0
[2023-06-30 23:10:01] [config] after-epochs: 60
[2023-06-30 23:10:01] [config] all-caps-every: 0
[2023-06-30 23:10:01] [config] allow-unk: false
[2023-06-30 23:10:01] [config] authors: false
[2023-06-30 23:10:01] [config] beam-size: 12
[2023-06-30 23:10:01] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:10:01] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:10:01] [config] bert-masking-fraction: 0.15
[2023-06-30 23:10:01] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:10:01] [config] bert-train-type-embeddings: true
[2023-06-30 23:10:01] [config] bert-type-vocab-size: 2
[2023-06-30 23:10:01] [config] build-info: ""
[2023-06-30 23:10:01] [config] check-gradient-nan: false
[2023-06-30 23:10:01] [config] check-nan: false
[2023-06-30 23:10:01] [config] cite: false
[2023-06-30 23:10:01] [config] clip-norm: 1
[2023-06-30 23:10:01] [config] cost-scaling:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] cost-type: ce-sum
[2023-06-30 23:10:01] [config] cpu-threads: 0
[2023-06-30 23:10:01] [config] data-threads: 8
[2023-06-30 23:10:01] [config] data-weighting: ""
[2023-06-30 23:10:01] [config] data-weighting-type: sentence
[2023-06-30 23:10:01] [config] dec-cell: gru
[2023-06-30 23:10:01] [config] dec-cell-base-depth: 2
[2023-06-30 23:10:01] [config] dec-cell-high-depth: 1
[2023-06-30 23:10:01] [config] dec-depth: 1
[2023-06-30 23:10:01] [config] devices:
[2023-06-30 23:10:01] [config]   - 0
[2023-06-30 23:10:01] [config] dim-emb: 512
[2023-06-30 23:10:01] [config] dim-rnn: 1024
[2023-06-30 23:10:01] [config] dim-vocabs:
[2023-06-30 23:10:01] [config]   - 54042
[2023-06-30 23:10:01] [config]   - 36507
[2023-06-30 23:10:01] [config] disp-first: 0
[2023-06-30 23:10:01] [config] disp-freq: 1000u
[2023-06-30 23:10:01] [config] disp-label-counts: true
[2023-06-30 23:10:01] [config] dropout-rnn: 0
[2023-06-30 23:10:01] [config] dropout-src: 0
[2023-06-30 23:10:01] [config] dropout-trg: 0
[2023-06-30 23:10:01] [config] dump-config: ""
[2023-06-30 23:10:01] [config] dynamic-gradient-scaling:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] early-stopping: 10
[2023-06-30 23:10:01] [config] early-stopping-on: first
[2023-06-30 23:10:01] [config] embedding-fix-src: false
[2023-06-30 23:10:01] [config] embedding-fix-trg: false
[2023-06-30 23:10:01] [config] embedding-normalization: false
[2023-06-30 23:10:01] [config] embedding-vectors:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] enc-cell: gru
[2023-06-30 23:10:01] [config] enc-cell-depth: 1
[2023-06-30 23:10:01] [config] enc-depth: 1
[2023-06-30 23:10:01] [config] enc-type: bidirectional
[2023-06-30 23:10:01] [config] english-title-case-every: 0
[2023-06-30 23:10:01] [config] exponential-smoothing: 0
[2023-06-30 23:10:01] [config] factor-weight: 1
[2023-06-30 23:10:01] [config] factors-combine: sum
[2023-06-30 23:10:01] [config] factors-dim-emb: 0
[2023-06-30 23:10:01] [config] gradient-checkpointing: false
[2023-06-30 23:10:01] [config] gradient-norm-average-window: 100
[2023-06-30 23:10:01] [config] guided-alignment: none
[2023-06-30 23:10:01] [config] guided-alignment-cost: mse
[2023-06-30 23:10:01] [config] guided-alignment-weight: 0.1
[2023-06-30 23:10:01] [config] ignore-model-config: false
[2023-06-30 23:10:01] [config] input-types:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] interpolate-env-vars: false
[2023-06-30 23:10:01] [config] keep-best: false
[2023-06-30 23:10:01] [config] label-smoothing: 0
[2023-06-30 23:10:01] [config] layer-normalization: false
[2023-06-30 23:10:01] [config] learn-rate: 0.0001
[2023-06-30 23:10:01] [config] lemma-dependency: ""
[2023-06-30 23:10:01] [config] lemma-dim-emb: 0
[2023-06-30 23:10:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:10:01] [config] log-level: info
[2023-06-30 23:10:01] [config] log-time-zone: ""
[2023-06-30 23:10:01] [config] logical-epoch:
[2023-06-30 23:10:01] [config]   - 1e
[2023-06-30 23:10:01] [config]   - 0
[2023-06-30 23:10:01] [config] lr-decay: 0
[2023-06-30 23:10:01] [config] lr-decay-freq: 50000
[2023-06-30 23:10:01] [config] lr-decay-inv-sqrt:
[2023-06-30 23:10:01] [config]   - 0
[2023-06-30 23:10:01] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:10:01] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:10:01] [config] lr-decay-start:
[2023-06-30 23:10:01] [config]   - 10
[2023-06-30 23:10:01] [config]   - 1
[2023-06-30 23:10:01] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:10:01] [config] lr-report: false
[2023-06-30 23:10:01] [config] lr-warmup: 0
[2023-06-30 23:10:01] [config] lr-warmup-at-reload: false
[2023-06-30 23:10:01] [config] lr-warmup-cycle: false
[2023-06-30 23:10:01] [config] lr-warmup-start-rate: 0
[2023-06-30 23:10:01] [config] max-length: 50
[2023-06-30 23:10:01] [config] max-length-crop: false
[2023-06-30 23:10:01] [config] max-length-factor: 3
[2023-06-30 23:10:01] [config] maxi-batch: 100
[2023-06-30 23:10:01] [config] maxi-batch-sort: trg
[2023-06-30 23:10:01] [config] mini-batch: 64
[2023-06-30 23:10:01] [config] mini-batch-fit: false
[2023-06-30 23:10:01] [config] mini-batch-fit-step: 10
[2023-06-30 23:10:01] [config] mini-batch-round-up: true
[2023-06-30 23:10:01] [config] mini-batch-track-lr: false
[2023-06-30 23:10:01] [config] mini-batch-warmup: 0
[2023-06-30 23:10:01] [config] mini-batch-words: 0
[2023-06-30 23:10:01] [config] mini-batch-words-ref: 0
[2023-06-30 23:10:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:10:01] [config] multi-loss-type: sum
[2023-06-30 23:10:01] [config] n-best: false
[2023-06-30 23:10:01] [config] no-nccl: false
[2023-06-30 23:10:01] [config] no-reload: false
[2023-06-30 23:10:01] [config] no-restore-corpus: false
[2023-06-30 23:10:01] [config] normalize: 0
[2023-06-30 23:10:01] [config] normalize-gradient: false
[2023-06-30 23:10:01] [config] num-devices: 0
[2023-06-30 23:10:01] [config] optimizer: adam
[2023-06-30 23:10:01] [config] optimizer-delay: 1
[2023-06-30 23:10:01] [config] optimizer-params:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] output-omit-bias: false
[2023-06-30 23:10:01] [config] overwrite: true
[2023-06-30 23:10:01] [config] precision:
[2023-06-30 23:10:01] [config]   - float32
[2023-06-30 23:10:01] [config]   - float32
[2023-06-30 23:10:01] [config] pretrained-model: ""
[2023-06-30 23:10:01] [config] quantize-biases: false
[2023-06-30 23:10:01] [config] quantize-bits: 0
[2023-06-30 23:10:01] [config] quantize-log-based: false
[2023-06-30 23:10:01] [config] quantize-optimization-steps: 0
[2023-06-30 23:10:01] [config] quiet: false
[2023-06-30 23:10:01] [config] quiet-translation: true
[2023-06-30 23:10:01] [config] relative-paths: false
[2023-06-30 23:10:01] [config] right-left: false
[2023-06-30 23:10:01] [config] save-freq: 10000u
[2023-06-30 23:10:01] [config] seed: 1234
[2023-06-30 23:10:01] [config] sentencepiece-alphas:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:10:01] [config] sentencepiece-options: ""
[2023-06-30 23:10:01] [config] sharding: global
[2023-06-30 23:10:01] [config] shuffle: data
[2023-06-30 23:10:01] [config] shuffle-in-ram: false
[2023-06-30 23:10:01] [config] sigterm: save-and-exit
[2023-06-30 23:10:01] [config] skip: false
[2023-06-30 23:10:01] [config] sqlite: ""
[2023-06-30 23:10:01] [config] sqlite-drop: false
[2023-06-30 23:10:01] [config] sync-freq: 200u
[2023-06-30 23:10:01] [config] sync-sgd: false
[2023-06-30 23:10:01] [config] tempdir: /tmp
[2023-06-30 23:10:01] [config] tied-embeddings: false
[2023-06-30 23:10:01] [config] tied-embeddings-all: false
[2023-06-30 23:10:01] [config] tied-embeddings-src: false
[2023-06-30 23:10:01] [config] train-embedder-rank:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] train-sets:
[2023-06-30 23:10:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:10:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:10:01] [config] transformer-aan-activation: swish
[2023-06-30 23:10:01] [config] transformer-aan-depth: 2
[2023-06-30 23:10:01] [config] transformer-aan-nogate: false
[2023-06-30 23:10:01] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:10:01] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:10:01] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:10:01] [config] transformer-depth-scaling: false
[2023-06-30 23:10:01] [config] transformer-dim-aan: 2048
[2023-06-30 23:10:01] [config] transformer-dim-ffn: 2048
[2023-06-30 23:10:01] [config] transformer-dropout: 0
[2023-06-30 23:10:01] [config] transformer-dropout-attention: 0
[2023-06-30 23:10:01] [config] transformer-dropout-ffn: 0
[2023-06-30 23:10:01] [config] transformer-ffn-activation: swish
[2023-06-30 23:10:01] [config] transformer-ffn-depth: 2
[2023-06-30 23:10:01] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:10:01] [config] transformer-heads: 8
[2023-06-30 23:10:01] [config] transformer-no-projection: false
[2023-06-30 23:10:01] [config] transformer-pool: false
[2023-06-30 23:10:01] [config] transformer-postprocess: dan
[2023-06-30 23:10:01] [config] transformer-postprocess-emb: d
[2023-06-30 23:10:01] [config] transformer-postprocess-top: ""
[2023-06-30 23:10:01] [config] transformer-preprocess: ""
[2023-06-30 23:10:01] [config] transformer-tied-layers:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] transformer-train-position-embeddings: false
[2023-06-30 23:10:01] [config] tsv: false
[2023-06-30 23:10:01] [config] tsv-fields: 0
[2023-06-30 23:10:01] [config] type: transformer
[2023-06-30 23:10:01] [config] ulr: false
[2023-06-30 23:10:01] [config] ulr-dim-emb: 0
[2023-06-30 23:10:01] [config] ulr-dropout: 0
[2023-06-30 23:10:01] [config] ulr-keys-vectors: ""
[2023-06-30 23:10:01] [config] ulr-query-vectors: ""
[2023-06-30 23:10:01] [config] ulr-softmax-temperature: 1
[2023-06-30 23:10:01] [config] ulr-trainable-transformation: false
[2023-06-30 23:10:01] [config] unlikelihood-loss: false
[2023-06-30 23:10:01] [config] valid-freq: 50000000
[2023-06-30 23:10:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:10:01] [config] valid-max-length: 1000
[2023-06-30 23:10:01] [config] valid-metrics:
[2023-06-30 23:10:01] [config]   - cross-entropy
[2023-06-30 23:10:01] [config]   - translation
[2023-06-30 23:10:01] [config] valid-mini-batch: 32
[2023-06-30 23:10:01] [config] valid-reset-stalled: false
[2023-06-30 23:10:01] [config] valid-script-args:
[2023-06-30 23:10:01] [config]   []
[2023-06-30 23:10:01] [config] valid-script-path: ""
[2023-06-30 23:10:01] [config] valid-sets:
[2023-06-30 23:10:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:10:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:10:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:10:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:10:01] [config] vocabs:
[2023-06-30 23:10:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:10:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:10:01] [config] word-penalty: 0
[2023-06-30 23:10:01] [config] word-scores: false
[2023-06-30 23:10:01] [config] workspace: 2048
[2023-06-30 23:10:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:10:01] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:10:01] [training] Using single-device training
[2023-06-30 23:10:02] Synced seed 1234
[2023-06-30 23:10:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:10:02] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:10:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:10:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:10:02] [valid] No post-processing script given for validating translator
[2023-06-30 23:10:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:10:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:10:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:10:03] [comm] Using global sharding
[2023-06-30 23:10:03] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:10:03] [training] Using 1 GPUs
[2023-06-30 23:10:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:10:05] Loading Adam parameters
[2023-06-30 23:10:05] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:10:05] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:10:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:10:05] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-06-30 23:10:05] [data] Shuffling data
[2023-06-30 23:10:05] [data] Done reading 20,192 sentences
[2023-06-30 23:10:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:10:05] Training started
[2023-06-30 23:10:05] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 23:10:05] [logits] Applying loss function for 1 factor(s)
[2023-06-30 23:10:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 23:10:05] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:10:06] Parameter type float32, optimization type float32, casting types false
[2023-06-30 23:10:15] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 0.01286071 * 1,333,303 @ 559 after 20,119,833 : Time 13.05s : 102202.29 words/s : gNorm 0.6260
[2023-06-30 23:10:22] Seen 18,843 samples
[2023-06-30 23:10:22] Starting data epoch 52 in logical epoch 52
[2023-06-30 23:10:22] [data] Shuffling data
[2023-06-30 23:10:22] [data] Done reading 20,192 sentences
[2023-06-30 23:10:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:10:41] Seen 18,843 samples
[2023-06-30 23:10:41] Starting data epoch 53 in logical epoch 53
[2023-06-30 23:10:41] [data] Shuffling data
[2023-06-30 23:10:41] [data] Done reading 20,192 sentences
[2023-06-30 23:10:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:11:00] Seen 18,843 samples
[2023-06-30 23:11:00] Starting data epoch 54 in logical epoch 54
[2023-06-30 23:11:00] [data] Shuffling data
[2023-06-30 23:11:00] [data] Done reading 20,192 sentences
[2023-06-30 23:11:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:11:18] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 0.01228635 * 1,343,441 @ 128 after 21,463,274 : Time 63.30s : 21224.86 words/s : gNorm 0.6306
[2023-06-30 23:11:19] Seen 18,843 samples
[2023-06-30 23:11:19] Starting data epoch 55 in logical epoch 55
[2023-06-30 23:11:19] [data] Shuffling data
[2023-06-30 23:11:19] [data] Done reading 20,192 sentences
[2023-06-30 23:11:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:11:39] Seen 18,843 samples
[2023-06-30 23:11:39] Starting data epoch 56 in logical epoch 56
[2023-06-30 23:11:39] [data] Shuffling data
[2023-06-30 23:11:39] [data] Done reading 20,192 sentences
[2023-06-30 23:11:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:11:58] Seen 18,843 samples
[2023-06-30 23:11:58] Starting data epoch 57 in logical epoch 57
[2023-06-30 23:11:58] [data] Shuffling data
[2023-06-30 23:11:58] [data] Done reading 20,192 sentences
[2023-06-30 23:11:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:12:18] Seen 18,843 samples
[2023-06-30 23:12:18] Starting data epoch 58 in logical epoch 58
[2023-06-30 23:12:18] [data] Shuffling data
[2023-06-30 23:12:18] [data] Done reading 20,192 sentences
[2023-06-30 23:12:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:12:24] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 0.01094047 * 1,347,361 @ 2,048 after 22,810,635 : Time 65.69s : 20509.90 words/s : gNorm 0.5112
[2023-06-30 23:12:37] Seen 18,843 samples
[2023-06-30 23:12:37] Starting data epoch 59 in logical epoch 59
[2023-06-30 23:12:37] [data] Shuffling data
[2023-06-30 23:12:37] [data] Done reading 20,192 sentences
[2023-06-30 23:12:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:12:57] Seen 18,843 samples
[2023-06-30 23:12:57] Starting data epoch 60 in logical epoch 60
[2023-06-30 23:12:57] [data] Shuffling data
[2023-06-30 23:12:57] [data] Done reading 20,192 sentences
[2023-06-30 23:12:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:13:16] Seen 18,843 samples
[2023-06-30 23:13:16] Starting data epoch 61 in logical epoch 61
[2023-06-30 23:13:16] Training finished
[2023-06-30 23:13:18] [valid] Ep. 61 : Up. 17795 : cross-entropy : 182.607 : stalled 5 times (last best: 125.788)
[2023-06-30 23:15:07] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-06-30 23:15:07] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:15:10] Saving Adam parameters
[2023-06-30 23:15:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:15:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:15:20] [marian] Running on node20.datos.cluster.uy as process 5360 with command line:
[2023-06-30 23:15:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:15:20] [config] after: 0e
[2023-06-30 23:15:20] [config] after-batches: 0
[2023-06-30 23:15:20] [config] after-epochs: 70
[2023-06-30 23:15:20] [config] all-caps-every: 0
[2023-06-30 23:15:20] [config] allow-unk: false
[2023-06-30 23:15:20] [config] authors: false
[2023-06-30 23:15:20] [config] beam-size: 12
[2023-06-30 23:15:20] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:15:20] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:15:20] [config] bert-masking-fraction: 0.15
[2023-06-30 23:15:20] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:15:20] [config] bert-train-type-embeddings: true
[2023-06-30 23:15:20] [config] bert-type-vocab-size: 2
[2023-06-30 23:15:20] [config] build-info: ""
[2023-06-30 23:15:20] [config] check-gradient-nan: false
[2023-06-30 23:15:20] [config] check-nan: false
[2023-06-30 23:15:20] [config] cite: false
[2023-06-30 23:15:20] [config] clip-norm: 1
[2023-06-30 23:15:20] [config] cost-scaling:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] cost-type: ce-sum
[2023-06-30 23:15:20] [config] cpu-threads: 0
[2023-06-30 23:15:20] [config] data-threads: 8
[2023-06-30 23:15:20] [config] data-weighting: ""
[2023-06-30 23:15:20] [config] data-weighting-type: sentence
[2023-06-30 23:15:20] [config] dec-cell: gru
[2023-06-30 23:15:20] [config] dec-cell-base-depth: 2
[2023-06-30 23:15:20] [config] dec-cell-high-depth: 1
[2023-06-30 23:15:20] [config] dec-depth: 1
[2023-06-30 23:15:20] [config] devices:
[2023-06-30 23:15:20] [config]   - 0
[2023-06-30 23:15:20] [config] dim-emb: 512
[2023-06-30 23:15:20] [config] dim-rnn: 1024
[2023-06-30 23:15:20] [config] dim-vocabs:
[2023-06-30 23:15:20] [config]   - 54042
[2023-06-30 23:15:20] [config]   - 36507
[2023-06-30 23:15:20] [config] disp-first: 0
[2023-06-30 23:15:20] [config] disp-freq: 1000u
[2023-06-30 23:15:20] [config] disp-label-counts: true
[2023-06-30 23:15:20] [config] dropout-rnn: 0
[2023-06-30 23:15:20] [config] dropout-src: 0
[2023-06-30 23:15:20] [config] dropout-trg: 0
[2023-06-30 23:15:20] [config] dump-config: ""
[2023-06-30 23:15:20] [config] dynamic-gradient-scaling:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] early-stopping: 10
[2023-06-30 23:15:20] [config] early-stopping-on: first
[2023-06-30 23:15:20] [config] embedding-fix-src: false
[2023-06-30 23:15:20] [config] embedding-fix-trg: false
[2023-06-30 23:15:20] [config] embedding-normalization: false
[2023-06-30 23:15:20] [config] embedding-vectors:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] enc-cell: gru
[2023-06-30 23:15:20] [config] enc-cell-depth: 1
[2023-06-30 23:15:20] [config] enc-depth: 1
[2023-06-30 23:15:20] [config] enc-type: bidirectional
[2023-06-30 23:15:20] [config] english-title-case-every: 0
[2023-06-30 23:15:20] [config] exponential-smoothing: 0
[2023-06-30 23:15:20] [config] factor-weight: 1
[2023-06-30 23:15:20] [config] factors-combine: sum
[2023-06-30 23:15:20] [config] factors-dim-emb: 0
[2023-06-30 23:15:20] [config] gradient-checkpointing: false
[2023-06-30 23:15:20] [config] gradient-norm-average-window: 100
[2023-06-30 23:15:20] [config] guided-alignment: none
[2023-06-30 23:15:20] [config] guided-alignment-cost: mse
[2023-06-30 23:15:20] [config] guided-alignment-weight: 0.1
[2023-06-30 23:15:20] [config] ignore-model-config: false
[2023-06-30 23:15:20] [config] input-types:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] interpolate-env-vars: false
[2023-06-30 23:15:20] [config] keep-best: false
[2023-06-30 23:15:20] [config] label-smoothing: 0
[2023-06-30 23:15:20] [config] layer-normalization: false
[2023-06-30 23:15:20] [config] learn-rate: 0.0001
[2023-06-30 23:15:20] [config] lemma-dependency: ""
[2023-06-30 23:15:20] [config] lemma-dim-emb: 0
[2023-06-30 23:15:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:15:20] [config] log-level: info
[2023-06-30 23:15:20] [config] log-time-zone: ""
[2023-06-30 23:15:20] [config] logical-epoch:
[2023-06-30 23:15:20] [config]   - 1e
[2023-06-30 23:15:20] [config]   - 0
[2023-06-30 23:15:20] [config] lr-decay: 0
[2023-06-30 23:15:20] [config] lr-decay-freq: 50000
[2023-06-30 23:15:20] [config] lr-decay-inv-sqrt:
[2023-06-30 23:15:20] [config]   - 0
[2023-06-30 23:15:20] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:15:20] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:15:20] [config] lr-decay-start:
[2023-06-30 23:15:20] [config]   - 10
[2023-06-30 23:15:20] [config]   - 1
[2023-06-30 23:15:20] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:15:20] [config] lr-report: false
[2023-06-30 23:15:20] [config] lr-warmup: 0
[2023-06-30 23:15:20] [config] lr-warmup-at-reload: false
[2023-06-30 23:15:20] [config] lr-warmup-cycle: false
[2023-06-30 23:15:20] [config] lr-warmup-start-rate: 0
[2023-06-30 23:15:20] [config] max-length: 50
[2023-06-30 23:15:20] [config] max-length-crop: false
[2023-06-30 23:15:20] [config] max-length-factor: 3
[2023-06-30 23:15:20] [config] maxi-batch: 100
[2023-06-30 23:15:20] [config] maxi-batch-sort: trg
[2023-06-30 23:15:20] [config] mini-batch: 64
[2023-06-30 23:15:20] [config] mini-batch-fit: false
[2023-06-30 23:15:20] [config] mini-batch-fit-step: 10
[2023-06-30 23:15:20] [config] mini-batch-round-up: true
[2023-06-30 23:15:20] [config] mini-batch-track-lr: false
[2023-06-30 23:15:20] [config] mini-batch-warmup: 0
[2023-06-30 23:15:20] [config] mini-batch-words: 0
[2023-06-30 23:15:20] [config] mini-batch-words-ref: 0
[2023-06-30 23:15:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:15:20] [config] multi-loss-type: sum
[2023-06-30 23:15:20] [config] n-best: false
[2023-06-30 23:15:20] [config] no-nccl: false
[2023-06-30 23:15:20] [config] no-reload: false
[2023-06-30 23:15:20] [config] no-restore-corpus: false
[2023-06-30 23:15:20] [config] normalize: 0
[2023-06-30 23:15:20] [config] normalize-gradient: false
[2023-06-30 23:15:20] [config] num-devices: 0
[2023-06-30 23:15:20] [config] optimizer: adam
[2023-06-30 23:15:20] [config] optimizer-delay: 1
[2023-06-30 23:15:20] [config] optimizer-params:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] output-omit-bias: false
[2023-06-30 23:15:20] [config] overwrite: true
[2023-06-30 23:15:20] [config] precision:
[2023-06-30 23:15:20] [config]   - float32
[2023-06-30 23:15:20] [config]   - float32
[2023-06-30 23:15:20] [config] pretrained-model: ""
[2023-06-30 23:15:20] [config] quantize-biases: false
[2023-06-30 23:15:20] [config] quantize-bits: 0
[2023-06-30 23:15:20] [config] quantize-log-based: false
[2023-06-30 23:15:20] [config] quantize-optimization-steps: 0
[2023-06-30 23:15:20] [config] quiet: false
[2023-06-30 23:15:20] [config] quiet-translation: true
[2023-06-30 23:15:20] [config] relative-paths: false
[2023-06-30 23:15:20] [config] right-left: false
[2023-06-30 23:15:20] [config] save-freq: 10000u
[2023-06-30 23:15:20] [config] seed: 1234
[2023-06-30 23:15:20] [config] sentencepiece-alphas:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:15:20] [config] sentencepiece-options: ""
[2023-06-30 23:15:20] [config] sharding: global
[2023-06-30 23:15:20] [config] shuffle: data
[2023-06-30 23:15:20] [config] shuffle-in-ram: false
[2023-06-30 23:15:20] [config] sigterm: save-and-exit
[2023-06-30 23:15:20] [config] skip: false
[2023-06-30 23:15:20] [config] sqlite: ""
[2023-06-30 23:15:20] [config] sqlite-drop: false
[2023-06-30 23:15:20] [config] sync-freq: 200u
[2023-06-30 23:15:20] [config] sync-sgd: false
[2023-06-30 23:15:20] [config] tempdir: /tmp
[2023-06-30 23:15:20] [config] tied-embeddings: false
[2023-06-30 23:15:20] [config] tied-embeddings-all: false
[2023-06-30 23:15:20] [config] tied-embeddings-src: false
[2023-06-30 23:15:20] [config] train-embedder-rank:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] train-sets:
[2023-06-30 23:15:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:15:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:15:20] [config] transformer-aan-activation: swish
[2023-06-30 23:15:20] [config] transformer-aan-depth: 2
[2023-06-30 23:15:20] [config] transformer-aan-nogate: false
[2023-06-30 23:15:20] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:15:20] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:15:20] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:15:20] [config] transformer-depth-scaling: false
[2023-06-30 23:15:20] [config] transformer-dim-aan: 2048
[2023-06-30 23:15:20] [config] transformer-dim-ffn: 2048
[2023-06-30 23:15:20] [config] transformer-dropout: 0
[2023-06-30 23:15:20] [config] transformer-dropout-attention: 0
[2023-06-30 23:15:20] [config] transformer-dropout-ffn: 0
[2023-06-30 23:15:20] [config] transformer-ffn-activation: swish
[2023-06-30 23:15:20] [config] transformer-ffn-depth: 2
[2023-06-30 23:15:20] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:15:20] [config] transformer-heads: 8
[2023-06-30 23:15:20] [config] transformer-no-projection: false
[2023-06-30 23:15:20] [config] transformer-pool: false
[2023-06-30 23:15:20] [config] transformer-postprocess: dan
[2023-06-30 23:15:20] [config] transformer-postprocess-emb: d
[2023-06-30 23:15:20] [config] transformer-postprocess-top: ""
[2023-06-30 23:15:20] [config] transformer-preprocess: ""
[2023-06-30 23:15:20] [config] transformer-tied-layers:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] transformer-train-position-embeddings: false
[2023-06-30 23:15:20] [config] tsv: false
[2023-06-30 23:15:20] [config] tsv-fields: 0
[2023-06-30 23:15:20] [config] type: transformer
[2023-06-30 23:15:20] [config] ulr: false
[2023-06-30 23:15:20] [config] ulr-dim-emb: 0
[2023-06-30 23:15:20] [config] ulr-dropout: 0
[2023-06-30 23:15:20] [config] ulr-keys-vectors: ""
[2023-06-30 23:15:20] [config] ulr-query-vectors: ""
[2023-06-30 23:15:20] [config] ulr-softmax-temperature: 1
[2023-06-30 23:15:20] [config] ulr-trainable-transformation: false
[2023-06-30 23:15:20] [config] unlikelihood-loss: false
[2023-06-30 23:15:20] [config] valid-freq: 50000000
[2023-06-30 23:15:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:15:20] [config] valid-max-length: 1000
[2023-06-30 23:15:20] [config] valid-metrics:
[2023-06-30 23:15:20] [config]   - cross-entropy
[2023-06-30 23:15:20] [config]   - translation
[2023-06-30 23:15:20] [config] valid-mini-batch: 32
[2023-06-30 23:15:20] [config] valid-reset-stalled: false
[2023-06-30 23:15:20] [config] valid-script-args:
[2023-06-30 23:15:20] [config]   []
[2023-06-30 23:15:20] [config] valid-script-path: ""
[2023-06-30 23:15:20] [config] valid-sets:
[2023-06-30 23:15:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:15:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:15:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:15:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:15:20] [config] vocabs:
[2023-06-30 23:15:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:15:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:15:20] [config] word-penalty: 0
[2023-06-30 23:15:20] [config] word-scores: false
[2023-06-30 23:15:20] [config] workspace: 2048
[2023-06-30 23:15:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:15:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:15:20] [training] Using single-device training
[2023-06-30 23:15:21] Synced seed 1234
[2023-06-30 23:15:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:15:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:15:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:15:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:15:21] [valid] No post-processing script given for validating translator
[2023-06-30 23:15:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:15:22] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:15:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:15:22] [comm] Using global sharding
[2023-06-30 23:15:22] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:15:22] [training] Using 1 GPUs
[2023-06-30 23:15:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:15:24] Loading Adam parameters
[2023-06-30 23:15:24] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:15:24] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:15:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:15:24] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-06-30 23:15:24] [data] Shuffling data
[2023-06-30 23:15:24] [data] Done reading 20,192 sentences
[2023-06-30 23:15:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:15:24] Training started
[2023-06-30 23:15:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 23:15:24] [logits] Applying loss function for 1 factor(s)
[2023-06-30 23:15:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 23:15:24] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:15:24] Parameter type float32, optimization type float32, casting types false
[2023-06-30 23:15:36] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 0.01073055 * 1,335,891 @ 1,435 after 24,146,526 : Time 15.23s : 87737.26 words/s : gNorm 0.5013
[2023-06-30 23:15:41] Seen 18,843 samples
[2023-06-30 23:15:41] Starting data epoch 62 in logical epoch 62
[2023-06-30 23:15:41] [data] Shuffling data
[2023-06-30 23:15:41] [data] Done reading 20,192 sentences
[2023-06-30 23:15:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:16:00] Seen 18,843 samples
[2023-06-30 23:16:00] Starting data epoch 63 in logical epoch 63
[2023-06-30 23:16:00] [data] Shuffling data
[2023-06-30 23:16:00] [data] Done reading 20,192 sentences
[2023-06-30 23:16:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:16:19] Seen 18,843 samples
[2023-06-30 23:16:19] Starting data epoch 64 in logical epoch 64
[2023-06-30 23:16:19] [data] Shuffling data
[2023-06-30 23:16:19] [data] Done reading 20,192 sentences
[2023-06-30 23:16:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:16:38] Seen 18,843 samples
[2023-06-30 23:16:38] Starting data epoch 65 in logical epoch 65
[2023-06-30 23:16:38] [data] Shuffling data
[2023-06-30 23:16:38] [data] Done reading 20,192 sentences
[2023-06-30 23:16:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:16:39] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 0.00948065 * 1,337,858 @ 479 after 25,484,384 : Time 63.37s : 21110.91 words/s : gNorm 0.4867
[2023-06-30 23:16:57] Seen 18,843 samples
[2023-06-30 23:16:57] Starting data epoch 66 in logical epoch 66
[2023-06-30 23:16:57] [data] Shuffling data
[2023-06-30 23:16:57] [data] Done reading 20,192 sentences
[2023-06-30 23:16:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:17:17] Seen 18,843 samples
[2023-06-30 23:17:17] Starting data epoch 67 in logical epoch 67
[2023-06-30 23:17:17] [data] Shuffling data
[2023-06-30 23:17:17] [data] Done reading 20,192 sentences
[2023-06-30 23:17:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:17:36] Seen 18,843 samples
[2023-06-30 23:17:36] Starting data epoch 68 in logical epoch 68
[2023-06-30 23:17:36] [data] Shuffling data
[2023-06-30 23:17:36] [data] Done reading 20,192 sentences
[2023-06-30 23:17:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:17:45] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 0.00941528 * 1,354,931 @ 1,600 after 26,839,315 : Time 66.00s : 20528.38 words/s : gNorm 0.4178
[2023-06-30 23:17:45] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:17:48] Saving Adam parameters
[2023-06-30 23:17:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:18:05] Seen 18,843 samples
[2023-06-30 23:18:05] Starting data epoch 69 in logical epoch 69
[2023-06-30 23:18:05] [data] Shuffling data
[2023-06-30 23:18:05] [data] Done reading 20,192 sentences
[2023-06-30 23:18:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:18:23] Seen 18,843 samples
[2023-06-30 23:18:23] Starting data epoch 70 in logical epoch 70
[2023-06-30 23:18:23] [data] Shuffling data
[2023-06-30 23:18:23] [data] Done reading 20,192 sentences
[2023-06-30 23:18:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:18:42] Seen 18,843 samples
[2023-06-30 23:18:42] Starting data epoch 71 in logical epoch 71
[2023-06-30 23:18:42] Training finished
[2023-06-30 23:18:45] [valid] Ep. 71 : Up. 20760 : cross-entropy : 191.627 : stalled 6 times (last best: 125.788)
[2023-06-30 23:20:49] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-06-30 23:20:49] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:20:52] Saving Adam parameters
[2023-06-30 23:20:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:21:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:21:02] [marian] Running on node20.datos.cluster.uy as process 5703 with command line:
[2023-06-30 23:21:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:21:02] [config] after: 0e
[2023-06-30 23:21:02] [config] after-batches: 0
[2023-06-30 23:21:02] [config] after-epochs: 80
[2023-06-30 23:21:02] [config] all-caps-every: 0
[2023-06-30 23:21:02] [config] allow-unk: false
[2023-06-30 23:21:02] [config] authors: false
[2023-06-30 23:21:02] [config] beam-size: 12
[2023-06-30 23:21:02] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:21:02] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:21:02] [config] bert-masking-fraction: 0.15
[2023-06-30 23:21:02] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:21:02] [config] bert-train-type-embeddings: true
[2023-06-30 23:21:02] [config] bert-type-vocab-size: 2
[2023-06-30 23:21:02] [config] build-info: ""
[2023-06-30 23:21:02] [config] check-gradient-nan: false
[2023-06-30 23:21:02] [config] check-nan: false
[2023-06-30 23:21:02] [config] cite: false
[2023-06-30 23:21:02] [config] clip-norm: 1
[2023-06-30 23:21:02] [config] cost-scaling:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] cost-type: ce-sum
[2023-06-30 23:21:02] [config] cpu-threads: 0
[2023-06-30 23:21:02] [config] data-threads: 8
[2023-06-30 23:21:02] [config] data-weighting: ""
[2023-06-30 23:21:02] [config] data-weighting-type: sentence
[2023-06-30 23:21:02] [config] dec-cell: gru
[2023-06-30 23:21:02] [config] dec-cell-base-depth: 2
[2023-06-30 23:21:02] [config] dec-cell-high-depth: 1
[2023-06-30 23:21:02] [config] dec-depth: 1
[2023-06-30 23:21:02] [config] devices:
[2023-06-30 23:21:02] [config]   - 0
[2023-06-30 23:21:02] [config] dim-emb: 512
[2023-06-30 23:21:02] [config] dim-rnn: 1024
[2023-06-30 23:21:02] [config] dim-vocabs:
[2023-06-30 23:21:02] [config]   - 54042
[2023-06-30 23:21:02] [config]   - 36507
[2023-06-30 23:21:02] [config] disp-first: 0
[2023-06-30 23:21:02] [config] disp-freq: 1000u
[2023-06-30 23:21:02] [config] disp-label-counts: true
[2023-06-30 23:21:02] [config] dropout-rnn: 0
[2023-06-30 23:21:02] [config] dropout-src: 0
[2023-06-30 23:21:02] [config] dropout-trg: 0
[2023-06-30 23:21:02] [config] dump-config: ""
[2023-06-30 23:21:02] [config] dynamic-gradient-scaling:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] early-stopping: 10
[2023-06-30 23:21:02] [config] early-stopping-on: first
[2023-06-30 23:21:02] [config] embedding-fix-src: false
[2023-06-30 23:21:02] [config] embedding-fix-trg: false
[2023-06-30 23:21:02] [config] embedding-normalization: false
[2023-06-30 23:21:02] [config] embedding-vectors:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] enc-cell: gru
[2023-06-30 23:21:02] [config] enc-cell-depth: 1
[2023-06-30 23:21:02] [config] enc-depth: 1
[2023-06-30 23:21:02] [config] enc-type: bidirectional
[2023-06-30 23:21:02] [config] english-title-case-every: 0
[2023-06-30 23:21:02] [config] exponential-smoothing: 0
[2023-06-30 23:21:02] [config] factor-weight: 1
[2023-06-30 23:21:02] [config] factors-combine: sum
[2023-06-30 23:21:02] [config] factors-dim-emb: 0
[2023-06-30 23:21:02] [config] gradient-checkpointing: false
[2023-06-30 23:21:02] [config] gradient-norm-average-window: 100
[2023-06-30 23:21:02] [config] guided-alignment: none
[2023-06-30 23:21:02] [config] guided-alignment-cost: mse
[2023-06-30 23:21:02] [config] guided-alignment-weight: 0.1
[2023-06-30 23:21:02] [config] ignore-model-config: false
[2023-06-30 23:21:02] [config] input-types:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] interpolate-env-vars: false
[2023-06-30 23:21:02] [config] keep-best: false
[2023-06-30 23:21:02] [config] label-smoothing: 0
[2023-06-30 23:21:02] [config] layer-normalization: false
[2023-06-30 23:21:02] [config] learn-rate: 0.0001
[2023-06-30 23:21:02] [config] lemma-dependency: ""
[2023-06-30 23:21:02] [config] lemma-dim-emb: 0
[2023-06-30 23:21:02] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:21:02] [config] log-level: info
[2023-06-30 23:21:02] [config] log-time-zone: ""
[2023-06-30 23:21:02] [config] logical-epoch:
[2023-06-30 23:21:02] [config]   - 1e
[2023-06-30 23:21:02] [config]   - 0
[2023-06-30 23:21:02] [config] lr-decay: 0
[2023-06-30 23:21:02] [config] lr-decay-freq: 50000
[2023-06-30 23:21:02] [config] lr-decay-inv-sqrt:
[2023-06-30 23:21:02] [config]   - 0
[2023-06-30 23:21:02] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:21:02] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:21:02] [config] lr-decay-start:
[2023-06-30 23:21:02] [config]   - 10
[2023-06-30 23:21:02] [config]   - 1
[2023-06-30 23:21:02] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:21:02] [config] lr-report: false
[2023-06-30 23:21:02] [config] lr-warmup: 0
[2023-06-30 23:21:02] [config] lr-warmup-at-reload: false
[2023-06-30 23:21:02] [config] lr-warmup-cycle: false
[2023-06-30 23:21:02] [config] lr-warmup-start-rate: 0
[2023-06-30 23:21:02] [config] max-length: 50
[2023-06-30 23:21:02] [config] max-length-crop: false
[2023-06-30 23:21:02] [config] max-length-factor: 3
[2023-06-30 23:21:02] [config] maxi-batch: 100
[2023-06-30 23:21:02] [config] maxi-batch-sort: trg
[2023-06-30 23:21:02] [config] mini-batch: 64
[2023-06-30 23:21:02] [config] mini-batch-fit: false
[2023-06-30 23:21:02] [config] mini-batch-fit-step: 10
[2023-06-30 23:21:02] [config] mini-batch-round-up: true
[2023-06-30 23:21:02] [config] mini-batch-track-lr: false
[2023-06-30 23:21:02] [config] mini-batch-warmup: 0
[2023-06-30 23:21:02] [config] mini-batch-words: 0
[2023-06-30 23:21:02] [config] mini-batch-words-ref: 0
[2023-06-30 23:21:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:21:02] [config] multi-loss-type: sum
[2023-06-30 23:21:02] [config] n-best: false
[2023-06-30 23:21:02] [config] no-nccl: false
[2023-06-30 23:21:02] [config] no-reload: false
[2023-06-30 23:21:02] [config] no-restore-corpus: false
[2023-06-30 23:21:02] [config] normalize: 0
[2023-06-30 23:21:02] [config] normalize-gradient: false
[2023-06-30 23:21:02] [config] num-devices: 0
[2023-06-30 23:21:02] [config] optimizer: adam
[2023-06-30 23:21:02] [config] optimizer-delay: 1
[2023-06-30 23:21:02] [config] optimizer-params:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] output-omit-bias: false
[2023-06-30 23:21:02] [config] overwrite: true
[2023-06-30 23:21:02] [config] precision:
[2023-06-30 23:21:02] [config]   - float32
[2023-06-30 23:21:02] [config]   - float32
[2023-06-30 23:21:02] [config] pretrained-model: ""
[2023-06-30 23:21:02] [config] quantize-biases: false
[2023-06-30 23:21:02] [config] quantize-bits: 0
[2023-06-30 23:21:02] [config] quantize-log-based: false
[2023-06-30 23:21:02] [config] quantize-optimization-steps: 0
[2023-06-30 23:21:02] [config] quiet: false
[2023-06-30 23:21:02] [config] quiet-translation: true
[2023-06-30 23:21:02] [config] relative-paths: false
[2023-06-30 23:21:02] [config] right-left: false
[2023-06-30 23:21:02] [config] save-freq: 10000u
[2023-06-30 23:21:02] [config] seed: 1234
[2023-06-30 23:21:02] [config] sentencepiece-alphas:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:21:02] [config] sentencepiece-options: ""
[2023-06-30 23:21:02] [config] sharding: global
[2023-06-30 23:21:02] [config] shuffle: data
[2023-06-30 23:21:02] [config] shuffle-in-ram: false
[2023-06-30 23:21:02] [config] sigterm: save-and-exit
[2023-06-30 23:21:02] [config] skip: false
[2023-06-30 23:21:02] [config] sqlite: ""
[2023-06-30 23:21:02] [config] sqlite-drop: false
[2023-06-30 23:21:02] [config] sync-freq: 200u
[2023-06-30 23:21:02] [config] sync-sgd: false
[2023-06-30 23:21:02] [config] tempdir: /tmp
[2023-06-30 23:21:02] [config] tied-embeddings: false
[2023-06-30 23:21:02] [config] tied-embeddings-all: false
[2023-06-30 23:21:02] [config] tied-embeddings-src: false
[2023-06-30 23:21:02] [config] train-embedder-rank:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] train-sets:
[2023-06-30 23:21:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:21:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:21:02] [config] transformer-aan-activation: swish
[2023-06-30 23:21:02] [config] transformer-aan-depth: 2
[2023-06-30 23:21:02] [config] transformer-aan-nogate: false
[2023-06-30 23:21:02] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:21:02] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:21:02] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:21:02] [config] transformer-depth-scaling: false
[2023-06-30 23:21:02] [config] transformer-dim-aan: 2048
[2023-06-30 23:21:02] [config] transformer-dim-ffn: 2048
[2023-06-30 23:21:02] [config] transformer-dropout: 0
[2023-06-30 23:21:02] [config] transformer-dropout-attention: 0
[2023-06-30 23:21:02] [config] transformer-dropout-ffn: 0
[2023-06-30 23:21:02] [config] transformer-ffn-activation: swish
[2023-06-30 23:21:02] [config] transformer-ffn-depth: 2
[2023-06-30 23:21:02] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:21:02] [config] transformer-heads: 8
[2023-06-30 23:21:02] [config] transformer-no-projection: false
[2023-06-30 23:21:02] [config] transformer-pool: false
[2023-06-30 23:21:02] [config] transformer-postprocess: dan
[2023-06-30 23:21:02] [config] transformer-postprocess-emb: d
[2023-06-30 23:21:02] [config] transformer-postprocess-top: ""
[2023-06-30 23:21:02] [config] transformer-preprocess: ""
[2023-06-30 23:21:02] [config] transformer-tied-layers:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] transformer-train-position-embeddings: false
[2023-06-30 23:21:02] [config] tsv: false
[2023-06-30 23:21:02] [config] tsv-fields: 0
[2023-06-30 23:21:02] [config] type: transformer
[2023-06-30 23:21:02] [config] ulr: false
[2023-06-30 23:21:02] [config] ulr-dim-emb: 0
[2023-06-30 23:21:02] [config] ulr-dropout: 0
[2023-06-30 23:21:02] [config] ulr-keys-vectors: ""
[2023-06-30 23:21:02] [config] ulr-query-vectors: ""
[2023-06-30 23:21:02] [config] ulr-softmax-temperature: 1
[2023-06-30 23:21:02] [config] ulr-trainable-transformation: false
[2023-06-30 23:21:02] [config] unlikelihood-loss: false
[2023-06-30 23:21:02] [config] valid-freq: 50000000
[2023-06-30 23:21:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:21:02] [config] valid-max-length: 1000
[2023-06-30 23:21:02] [config] valid-metrics:
[2023-06-30 23:21:02] [config]   - cross-entropy
[2023-06-30 23:21:02] [config]   - translation
[2023-06-30 23:21:02] [config] valid-mini-batch: 32
[2023-06-30 23:21:02] [config] valid-reset-stalled: false
[2023-06-30 23:21:02] [config] valid-script-args:
[2023-06-30 23:21:02] [config]   []
[2023-06-30 23:21:02] [config] valid-script-path: ""
[2023-06-30 23:21:02] [config] valid-sets:
[2023-06-30 23:21:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:21:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:21:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:21:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:21:02] [config] vocabs:
[2023-06-30 23:21:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:21:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:21:02] [config] word-penalty: 0
[2023-06-30 23:21:02] [config] word-scores: false
[2023-06-30 23:21:02] [config] workspace: 2048
[2023-06-30 23:21:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:21:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:21:02] [training] Using single-device training
[2023-06-30 23:21:02] Synced seed 1234
[2023-06-30 23:21:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:21:02] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:21:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:21:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:21:02] [valid] No post-processing script given for validating translator
[2023-06-30 23:21:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:21:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:21:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:21:03] [comm] Using global sharding
[2023-06-30 23:21:03] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:21:03] [training] Using 1 GPUs
[2023-06-30 23:21:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:21:05] Loading Adam parameters
[2023-06-30 23:21:05] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:21:05] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:21:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:21:05] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-06-30 23:21:05] [data] Shuffling data
[2023-06-30 23:21:05] [data] Done reading 20,192 sentences
[2023-06-30 23:21:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:21:06] Training started
[2023-06-30 23:21:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 23:21:06] [logits] Applying loss function for 1 factor(s)
[2023-06-30 23:21:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 23:21:06] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:21:06] Parameter type float32, optimization type float32, casting types false
[2023-06-30 23:21:19] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.00916599 * 1,330,991 @ 1,562 after 28,170,306 : Time 16.99s : 78335.10 words/s : gNorm 0.4958
[2023-06-30 23:21:23] Seen 18,843 samples
[2023-06-30 23:21:23] Starting data epoch 72 in logical epoch 72
[2023-06-30 23:21:23] [data] Shuffling data
[2023-06-30 23:21:23] [data] Done reading 20,192 sentences
[2023-06-30 23:21:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:21:41] Seen 18,843 samples
[2023-06-30 23:21:41] Starting data epoch 73 in logical epoch 73
[2023-06-30 23:21:41] [data] Shuffling data
[2023-06-30 23:21:41] [data] Done reading 20,192 sentences
[2023-06-30 23:21:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:22:00] Seen 18,843 samples
[2023-06-30 23:22:00] Starting data epoch 74 in logical epoch 74
[2023-06-30 23:22:00] [data] Shuffling data
[2023-06-30 23:22:00] [data] Done reading 20,192 sentences
[2023-06-30 23:22:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:22:19] Seen 18,843 samples
[2023-06-30 23:22:19] Starting data epoch 75 in logical epoch 75
[2023-06-30 23:22:19] [data] Shuffling data
[2023-06-30 23:22:19] [data] Done reading 20,192 sentences
[2023-06-30 23:22:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:22:23] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.00853329 * 1,344,658 @ 2,757 after 29,514,964 : Time 63.77s : 21087.27 words/s : gNorm 0.4443
[2023-06-30 23:22:39] Seen 18,843 samples
[2023-06-30 23:22:39] Starting data epoch 76 in logical epoch 76
[2023-06-30 23:22:39] [data] Shuffling data
[2023-06-30 23:22:39] [data] Done reading 20,192 sentences
[2023-06-30 23:22:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:22:59] Seen 18,843 samples
[2023-06-30 23:22:59] Starting data epoch 77 in logical epoch 77
[2023-06-30 23:22:59] [data] Shuffling data
[2023-06-30 23:22:59] [data] Done reading 20,192 sentences
[2023-06-30 23:22:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:23:18] Seen 18,843 samples
[2023-06-30 23:23:18] Starting data epoch 78 in logical epoch 78
[2023-06-30 23:23:18] [data] Shuffling data
[2023-06-30 23:23:18] [data] Done reading 20,192 sentences
[2023-06-30 23:23:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:23:29] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.00856419 * 1,340,855 @ 527 after 30,855,819 : Time 66.03s : 20305.69 words/s : gNorm 0.3936
[2023-06-30 23:23:38] Seen 18,843 samples
[2023-06-30 23:23:38] Starting data epoch 79 in logical epoch 79
[2023-06-30 23:23:38] [data] Shuffling data
[2023-06-30 23:23:38] [data] Done reading 20,192 sentences
[2023-06-30 23:23:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:23:57] Seen 18,843 samples
[2023-06-30 23:23:57] Starting data epoch 80 in logical epoch 80
[2023-06-30 23:23:57] [data] Shuffling data
[2023-06-30 23:23:57] [data] Done reading 20,192 sentences
[2023-06-30 23:23:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:24:17] Seen 18,843 samples
[2023-06-30 23:24:17] Starting data epoch 81 in logical epoch 81
[2023-06-30 23:24:17] Training finished
[2023-06-30 23:24:19] [valid] Ep. 81 : Up. 23727 : cross-entropy : 197.262 : stalled 7 times (last best: 125.788)
[2023-06-30 23:26:19] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-06-30 23:26:19] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:26:21] Saving Adam parameters
[2023-06-30 23:26:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:26:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:26:32] [marian] Running on node20.datos.cluster.uy as process 6033 with command line:
[2023-06-30 23:26:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:26:32] [config] after: 0e
[2023-06-30 23:26:32] [config] after-batches: 0
[2023-06-30 23:26:32] [config] after-epochs: 90
[2023-06-30 23:26:32] [config] all-caps-every: 0
[2023-06-30 23:26:32] [config] allow-unk: false
[2023-06-30 23:26:32] [config] authors: false
[2023-06-30 23:26:32] [config] beam-size: 12
[2023-06-30 23:26:32] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:26:32] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:26:32] [config] bert-masking-fraction: 0.15
[2023-06-30 23:26:32] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:26:32] [config] bert-train-type-embeddings: true
[2023-06-30 23:26:32] [config] bert-type-vocab-size: 2
[2023-06-30 23:26:32] [config] build-info: ""
[2023-06-30 23:26:32] [config] check-gradient-nan: false
[2023-06-30 23:26:32] [config] check-nan: false
[2023-06-30 23:26:32] [config] cite: false
[2023-06-30 23:26:32] [config] clip-norm: 1
[2023-06-30 23:26:32] [config] cost-scaling:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] cost-type: ce-sum
[2023-06-30 23:26:32] [config] cpu-threads: 0
[2023-06-30 23:26:32] [config] data-threads: 8
[2023-06-30 23:26:32] [config] data-weighting: ""
[2023-06-30 23:26:32] [config] data-weighting-type: sentence
[2023-06-30 23:26:32] [config] dec-cell: gru
[2023-06-30 23:26:32] [config] dec-cell-base-depth: 2
[2023-06-30 23:26:32] [config] dec-cell-high-depth: 1
[2023-06-30 23:26:32] [config] dec-depth: 1
[2023-06-30 23:26:32] [config] devices:
[2023-06-30 23:26:32] [config]   - 0
[2023-06-30 23:26:32] [config] dim-emb: 512
[2023-06-30 23:26:32] [config] dim-rnn: 1024
[2023-06-30 23:26:32] [config] dim-vocabs:
[2023-06-30 23:26:32] [config]   - 54042
[2023-06-30 23:26:32] [config]   - 36507
[2023-06-30 23:26:32] [config] disp-first: 0
[2023-06-30 23:26:32] [config] disp-freq: 1000u
[2023-06-30 23:26:32] [config] disp-label-counts: true
[2023-06-30 23:26:32] [config] dropout-rnn: 0
[2023-06-30 23:26:32] [config] dropout-src: 0
[2023-06-30 23:26:32] [config] dropout-trg: 0
[2023-06-30 23:26:32] [config] dump-config: ""
[2023-06-30 23:26:32] [config] dynamic-gradient-scaling:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] early-stopping: 10
[2023-06-30 23:26:32] [config] early-stopping-on: first
[2023-06-30 23:26:32] [config] embedding-fix-src: false
[2023-06-30 23:26:32] [config] embedding-fix-trg: false
[2023-06-30 23:26:32] [config] embedding-normalization: false
[2023-06-30 23:26:32] [config] embedding-vectors:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] enc-cell: gru
[2023-06-30 23:26:32] [config] enc-cell-depth: 1
[2023-06-30 23:26:32] [config] enc-depth: 1
[2023-06-30 23:26:32] [config] enc-type: bidirectional
[2023-06-30 23:26:32] [config] english-title-case-every: 0
[2023-06-30 23:26:32] [config] exponential-smoothing: 0
[2023-06-30 23:26:32] [config] factor-weight: 1
[2023-06-30 23:26:32] [config] factors-combine: sum
[2023-06-30 23:26:32] [config] factors-dim-emb: 0
[2023-06-30 23:26:32] [config] gradient-checkpointing: false
[2023-06-30 23:26:32] [config] gradient-norm-average-window: 100
[2023-06-30 23:26:32] [config] guided-alignment: none
[2023-06-30 23:26:32] [config] guided-alignment-cost: mse
[2023-06-30 23:26:32] [config] guided-alignment-weight: 0.1
[2023-06-30 23:26:32] [config] ignore-model-config: false
[2023-06-30 23:26:32] [config] input-types:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] interpolate-env-vars: false
[2023-06-30 23:26:32] [config] keep-best: false
[2023-06-30 23:26:32] [config] label-smoothing: 0
[2023-06-30 23:26:32] [config] layer-normalization: false
[2023-06-30 23:26:32] [config] learn-rate: 0.0001
[2023-06-30 23:26:32] [config] lemma-dependency: ""
[2023-06-30 23:26:32] [config] lemma-dim-emb: 0
[2023-06-30 23:26:32] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:26:32] [config] log-level: info
[2023-06-30 23:26:32] [config] log-time-zone: ""
[2023-06-30 23:26:32] [config] logical-epoch:
[2023-06-30 23:26:32] [config]   - 1e
[2023-06-30 23:26:32] [config]   - 0
[2023-06-30 23:26:32] [config] lr-decay: 0
[2023-06-30 23:26:32] [config] lr-decay-freq: 50000
[2023-06-30 23:26:32] [config] lr-decay-inv-sqrt:
[2023-06-30 23:26:32] [config]   - 0
[2023-06-30 23:26:32] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:26:32] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:26:32] [config] lr-decay-start:
[2023-06-30 23:26:32] [config]   - 10
[2023-06-30 23:26:32] [config]   - 1
[2023-06-30 23:26:32] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:26:32] [config] lr-report: false
[2023-06-30 23:26:32] [config] lr-warmup: 0
[2023-06-30 23:26:32] [config] lr-warmup-at-reload: false
[2023-06-30 23:26:32] [config] lr-warmup-cycle: false
[2023-06-30 23:26:32] [config] lr-warmup-start-rate: 0
[2023-06-30 23:26:32] [config] max-length: 50
[2023-06-30 23:26:32] [config] max-length-crop: false
[2023-06-30 23:26:32] [config] max-length-factor: 3
[2023-06-30 23:26:32] [config] maxi-batch: 100
[2023-06-30 23:26:32] [config] maxi-batch-sort: trg
[2023-06-30 23:26:32] [config] mini-batch: 64
[2023-06-30 23:26:32] [config] mini-batch-fit: false
[2023-06-30 23:26:32] [config] mini-batch-fit-step: 10
[2023-06-30 23:26:32] [config] mini-batch-round-up: true
[2023-06-30 23:26:32] [config] mini-batch-track-lr: false
[2023-06-30 23:26:32] [config] mini-batch-warmup: 0
[2023-06-30 23:26:32] [config] mini-batch-words: 0
[2023-06-30 23:26:32] [config] mini-batch-words-ref: 0
[2023-06-30 23:26:32] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:26:32] [config] multi-loss-type: sum
[2023-06-30 23:26:32] [config] n-best: false
[2023-06-30 23:26:32] [config] no-nccl: false
[2023-06-30 23:26:32] [config] no-reload: false
[2023-06-30 23:26:32] [config] no-restore-corpus: false
[2023-06-30 23:26:32] [config] normalize: 0
[2023-06-30 23:26:32] [config] normalize-gradient: false
[2023-06-30 23:26:32] [config] num-devices: 0
[2023-06-30 23:26:32] [config] optimizer: adam
[2023-06-30 23:26:32] [config] optimizer-delay: 1
[2023-06-30 23:26:32] [config] optimizer-params:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] output-omit-bias: false
[2023-06-30 23:26:32] [config] overwrite: true
[2023-06-30 23:26:32] [config] precision:
[2023-06-30 23:26:32] [config]   - float32
[2023-06-30 23:26:32] [config]   - float32
[2023-06-30 23:26:32] [config] pretrained-model: ""
[2023-06-30 23:26:32] [config] quantize-biases: false
[2023-06-30 23:26:32] [config] quantize-bits: 0
[2023-06-30 23:26:32] [config] quantize-log-based: false
[2023-06-30 23:26:32] [config] quantize-optimization-steps: 0
[2023-06-30 23:26:32] [config] quiet: false
[2023-06-30 23:26:32] [config] quiet-translation: true
[2023-06-30 23:26:32] [config] relative-paths: false
[2023-06-30 23:26:32] [config] right-left: false
[2023-06-30 23:26:32] [config] save-freq: 10000u
[2023-06-30 23:26:32] [config] seed: 1234
[2023-06-30 23:26:32] [config] sentencepiece-alphas:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:26:32] [config] sentencepiece-options: ""
[2023-06-30 23:26:32] [config] sharding: global
[2023-06-30 23:26:32] [config] shuffle: data
[2023-06-30 23:26:32] [config] shuffle-in-ram: false
[2023-06-30 23:26:32] [config] sigterm: save-and-exit
[2023-06-30 23:26:32] [config] skip: false
[2023-06-30 23:26:32] [config] sqlite: ""
[2023-06-30 23:26:32] [config] sqlite-drop: false
[2023-06-30 23:26:32] [config] sync-freq: 200u
[2023-06-30 23:26:32] [config] sync-sgd: false
[2023-06-30 23:26:32] [config] tempdir: /tmp
[2023-06-30 23:26:32] [config] tied-embeddings: false
[2023-06-30 23:26:32] [config] tied-embeddings-all: false
[2023-06-30 23:26:32] [config] tied-embeddings-src: false
[2023-06-30 23:26:32] [config] train-embedder-rank:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] train-sets:
[2023-06-30 23:26:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:26:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:26:32] [config] transformer-aan-activation: swish
[2023-06-30 23:26:32] [config] transformer-aan-depth: 2
[2023-06-30 23:26:32] [config] transformer-aan-nogate: false
[2023-06-30 23:26:32] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:26:32] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:26:32] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:26:32] [config] transformer-depth-scaling: false
[2023-06-30 23:26:32] [config] transformer-dim-aan: 2048
[2023-06-30 23:26:32] [config] transformer-dim-ffn: 2048
[2023-06-30 23:26:32] [config] transformer-dropout: 0
[2023-06-30 23:26:32] [config] transformer-dropout-attention: 0
[2023-06-30 23:26:32] [config] transformer-dropout-ffn: 0
[2023-06-30 23:26:32] [config] transformer-ffn-activation: swish
[2023-06-30 23:26:32] [config] transformer-ffn-depth: 2
[2023-06-30 23:26:32] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:26:32] [config] transformer-heads: 8
[2023-06-30 23:26:32] [config] transformer-no-projection: false
[2023-06-30 23:26:32] [config] transformer-pool: false
[2023-06-30 23:26:32] [config] transformer-postprocess: dan
[2023-06-30 23:26:32] [config] transformer-postprocess-emb: d
[2023-06-30 23:26:32] [config] transformer-postprocess-top: ""
[2023-06-30 23:26:32] [config] transformer-preprocess: ""
[2023-06-30 23:26:32] [config] transformer-tied-layers:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] transformer-train-position-embeddings: false
[2023-06-30 23:26:32] [config] tsv: false
[2023-06-30 23:26:32] [config] tsv-fields: 0
[2023-06-30 23:26:32] [config] type: transformer
[2023-06-30 23:26:32] [config] ulr: false
[2023-06-30 23:26:32] [config] ulr-dim-emb: 0
[2023-06-30 23:26:32] [config] ulr-dropout: 0
[2023-06-30 23:26:32] [config] ulr-keys-vectors: ""
[2023-06-30 23:26:32] [config] ulr-query-vectors: ""
[2023-06-30 23:26:32] [config] ulr-softmax-temperature: 1
[2023-06-30 23:26:32] [config] ulr-trainable-transformation: false
[2023-06-30 23:26:32] [config] unlikelihood-loss: false
[2023-06-30 23:26:32] [config] valid-freq: 50000000
[2023-06-30 23:26:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:26:32] [config] valid-max-length: 1000
[2023-06-30 23:26:32] [config] valid-metrics:
[2023-06-30 23:26:32] [config]   - cross-entropy
[2023-06-30 23:26:32] [config]   - translation
[2023-06-30 23:26:32] [config] valid-mini-batch: 32
[2023-06-30 23:26:32] [config] valid-reset-stalled: false
[2023-06-30 23:26:32] [config] valid-script-args:
[2023-06-30 23:26:32] [config]   []
[2023-06-30 23:26:32] [config] valid-script-path: ""
[2023-06-30 23:26:32] [config] valid-sets:
[2023-06-30 23:26:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:26:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:26:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:26:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:26:32] [config] vocabs:
[2023-06-30 23:26:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:26:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:26:32] [config] word-penalty: 0
[2023-06-30 23:26:32] [config] word-scores: false
[2023-06-30 23:26:32] [config] workspace: 2048
[2023-06-30 23:26:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:26:32] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:26:32] [training] Using single-device training
[2023-06-30 23:26:32] Synced seed 1234
[2023-06-30 23:26:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:26:32] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:26:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:26:32] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:26:32] [valid] No post-processing script given for validating translator
[2023-06-30 23:26:32] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:26:33] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:26:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:26:33] [comm] Using global sharding
[2023-06-30 23:26:33] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:26:33] [training] Using 1 GPUs
[2023-06-30 23:26:33] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:26:35] Loading Adam parameters
[2023-06-30 23:26:35] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:26:35] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:26:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:26:35] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-06-30 23:26:35] [data] Shuffling data
[2023-06-30 23:26:35] [data] Done reading 20,192 sentences
[2023-06-30 23:26:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:26:36] Training started
[2023-06-30 23:26:36] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 23:26:36] [logits] Applying loss function for 1 factor(s)
[2023-06-30 23:26:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 23:26:36] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:26:36] Parameter type float32, optimization type float32, casting types false
[2023-06-30 23:26:52] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.00783670 * 1,343,267 @ 832 after 32,199,086 : Time 19.36s : 69366.53 words/s : gNorm 0.4266
[2023-06-30 23:26:53] Seen 18,843 samples
[2023-06-30 23:26:53] Starting data epoch 82 in logical epoch 82
[2023-06-30 23:26:53] [data] Shuffling data
[2023-06-30 23:26:53] [data] Done reading 20,192 sentences
[2023-06-30 23:26:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:27:12] Seen 18,843 samples
[2023-06-30 23:27:12] Starting data epoch 83 in logical epoch 83
[2023-06-30 23:27:12] [data] Shuffling data
[2023-06-30 23:27:12] [data] Done reading 20,192 sentences
[2023-06-30 23:27:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:27:32] Seen 18,843 samples
[2023-06-30 23:27:32] Starting data epoch 84 in logical epoch 84
[2023-06-30 23:27:32] [data] Shuffling data
[2023-06-30 23:27:32] [data] Done reading 20,192 sentences
[2023-06-30 23:27:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:27:51] Seen 18,843 samples
[2023-06-30 23:27:51] Starting data epoch 85 in logical epoch 85
[2023-06-30 23:27:51] [data] Shuffling data
[2023-06-30 23:27:51] [data] Done reading 20,192 sentences
[2023-06-30 23:27:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:27:57] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.00746540 * 1,339,320 @ 1,280 after 33,538,406 : Time 65.26s : 20522.61 words/s : gNorm 0.4525
[2023-06-30 23:28:10] Seen 18,843 samples
[2023-06-30 23:28:10] Starting data epoch 86 in logical epoch 86
[2023-06-30 23:28:10] [data] Shuffling data
[2023-06-30 23:28:10] [data] Done reading 20,192 sentences
[2023-06-30 23:28:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:28:30] Seen 18,843 samples
[2023-06-30 23:28:30] Starting data epoch 87 in logical epoch 87
[2023-06-30 23:28:30] [data] Shuffling data
[2023-06-30 23:28:30] [data] Done reading 20,192 sentences
[2023-06-30 23:28:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:28:50] Seen 18,843 samples
[2023-06-30 23:28:50] Starting data epoch 88 in logical epoch 88
[2023-06-30 23:28:50] [data] Shuffling data
[2023-06-30 23:28:50] [data] Done reading 20,192 sentences
[2023-06-30 23:28:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:29:02] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.00728250 * 1,346,822 @ 896 after 34,885,228 : Time 65.61s : 20528.06 words/s : gNorm 0.3426
[2023-06-30 23:29:09] Seen 18,843 samples
[2023-06-30 23:29:09] Starting data epoch 89 in logical epoch 89
[2023-06-30 23:29:09] [data] Shuffling data
[2023-06-30 23:29:09] [data] Done reading 20,192 sentences
[2023-06-30 23:29:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:29:28] Seen 18,843 samples
[2023-06-30 23:29:28] Starting data epoch 90 in logical epoch 90
[2023-06-30 23:29:28] [data] Shuffling data
[2023-06-30 23:29:28] [data] Done reading 20,192 sentences
[2023-06-30 23:29:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:29:48] Seen 18,843 samples
[2023-06-30 23:29:48] Starting data epoch 91 in logical epoch 91
[2023-06-30 23:29:48] Training finished
[2023-06-30 23:29:51] [valid] Ep. 91 : Up. 26693 : cross-entropy : 197.251 : stalled 8 times (last best: 125.788)
[2023-06-30 23:31:41] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-06-30 23:31:41] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:31:43] Saving Adam parameters
[2023-06-30 23:31:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:31:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:31:53] [marian] Running on node20.datos.cluster.uy as process 6356 with command line:
[2023-06-30 23:31:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:31:53] [config] after: 0e
[2023-06-30 23:31:53] [config] after-batches: 0
[2023-06-30 23:31:53] [config] after-epochs: 100
[2023-06-30 23:31:53] [config] all-caps-every: 0
[2023-06-30 23:31:53] [config] allow-unk: false
[2023-06-30 23:31:53] [config] authors: false
[2023-06-30 23:31:53] [config] beam-size: 12
[2023-06-30 23:31:53] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:31:53] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:31:53] [config] bert-masking-fraction: 0.15
[2023-06-30 23:31:53] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:31:53] [config] bert-train-type-embeddings: true
[2023-06-30 23:31:53] [config] bert-type-vocab-size: 2
[2023-06-30 23:31:53] [config] build-info: ""
[2023-06-30 23:31:53] [config] check-gradient-nan: false
[2023-06-30 23:31:53] [config] check-nan: false
[2023-06-30 23:31:53] [config] cite: false
[2023-06-30 23:31:53] [config] clip-norm: 1
[2023-06-30 23:31:53] [config] cost-scaling:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] cost-type: ce-sum
[2023-06-30 23:31:53] [config] cpu-threads: 0
[2023-06-30 23:31:53] [config] data-threads: 8
[2023-06-30 23:31:53] [config] data-weighting: ""
[2023-06-30 23:31:53] [config] data-weighting-type: sentence
[2023-06-30 23:31:53] [config] dec-cell: gru
[2023-06-30 23:31:53] [config] dec-cell-base-depth: 2
[2023-06-30 23:31:53] [config] dec-cell-high-depth: 1
[2023-06-30 23:31:53] [config] dec-depth: 1
[2023-06-30 23:31:53] [config] devices:
[2023-06-30 23:31:53] [config]   - 0
[2023-06-30 23:31:53] [config] dim-emb: 512
[2023-06-30 23:31:53] [config] dim-rnn: 1024
[2023-06-30 23:31:53] [config] dim-vocabs:
[2023-06-30 23:31:53] [config]   - 54042
[2023-06-30 23:31:53] [config]   - 36507
[2023-06-30 23:31:53] [config] disp-first: 0
[2023-06-30 23:31:53] [config] disp-freq: 1000u
[2023-06-30 23:31:53] [config] disp-label-counts: true
[2023-06-30 23:31:53] [config] dropout-rnn: 0
[2023-06-30 23:31:53] [config] dropout-src: 0
[2023-06-30 23:31:53] [config] dropout-trg: 0
[2023-06-30 23:31:53] [config] dump-config: ""
[2023-06-30 23:31:53] [config] dynamic-gradient-scaling:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] early-stopping: 10
[2023-06-30 23:31:53] [config] early-stopping-on: first
[2023-06-30 23:31:53] [config] embedding-fix-src: false
[2023-06-30 23:31:53] [config] embedding-fix-trg: false
[2023-06-30 23:31:53] [config] embedding-normalization: false
[2023-06-30 23:31:53] [config] embedding-vectors:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] enc-cell: gru
[2023-06-30 23:31:53] [config] enc-cell-depth: 1
[2023-06-30 23:31:53] [config] enc-depth: 1
[2023-06-30 23:31:53] [config] enc-type: bidirectional
[2023-06-30 23:31:53] [config] english-title-case-every: 0
[2023-06-30 23:31:53] [config] exponential-smoothing: 0
[2023-06-30 23:31:53] [config] factor-weight: 1
[2023-06-30 23:31:53] [config] factors-combine: sum
[2023-06-30 23:31:53] [config] factors-dim-emb: 0
[2023-06-30 23:31:53] [config] gradient-checkpointing: false
[2023-06-30 23:31:53] [config] gradient-norm-average-window: 100
[2023-06-30 23:31:53] [config] guided-alignment: none
[2023-06-30 23:31:53] [config] guided-alignment-cost: mse
[2023-06-30 23:31:53] [config] guided-alignment-weight: 0.1
[2023-06-30 23:31:53] [config] ignore-model-config: false
[2023-06-30 23:31:53] [config] input-types:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] interpolate-env-vars: false
[2023-06-30 23:31:53] [config] keep-best: false
[2023-06-30 23:31:53] [config] label-smoothing: 0
[2023-06-30 23:31:53] [config] layer-normalization: false
[2023-06-30 23:31:53] [config] learn-rate: 0.0001
[2023-06-30 23:31:53] [config] lemma-dependency: ""
[2023-06-30 23:31:53] [config] lemma-dim-emb: 0
[2023-06-30 23:31:53] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:31:53] [config] log-level: info
[2023-06-30 23:31:53] [config] log-time-zone: ""
[2023-06-30 23:31:53] [config] logical-epoch:
[2023-06-30 23:31:53] [config]   - 1e
[2023-06-30 23:31:53] [config]   - 0
[2023-06-30 23:31:53] [config] lr-decay: 0
[2023-06-30 23:31:53] [config] lr-decay-freq: 50000
[2023-06-30 23:31:53] [config] lr-decay-inv-sqrt:
[2023-06-30 23:31:53] [config]   - 0
[2023-06-30 23:31:53] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:31:53] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:31:53] [config] lr-decay-start:
[2023-06-30 23:31:53] [config]   - 10
[2023-06-30 23:31:53] [config]   - 1
[2023-06-30 23:31:53] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:31:53] [config] lr-report: false
[2023-06-30 23:31:53] [config] lr-warmup: 0
[2023-06-30 23:31:53] [config] lr-warmup-at-reload: false
[2023-06-30 23:31:53] [config] lr-warmup-cycle: false
[2023-06-30 23:31:53] [config] lr-warmup-start-rate: 0
[2023-06-30 23:31:53] [config] max-length: 50
[2023-06-30 23:31:53] [config] max-length-crop: false
[2023-06-30 23:31:53] [config] max-length-factor: 3
[2023-06-30 23:31:53] [config] maxi-batch: 100
[2023-06-30 23:31:53] [config] maxi-batch-sort: trg
[2023-06-30 23:31:53] [config] mini-batch: 64
[2023-06-30 23:31:53] [config] mini-batch-fit: false
[2023-06-30 23:31:53] [config] mini-batch-fit-step: 10
[2023-06-30 23:31:53] [config] mini-batch-round-up: true
[2023-06-30 23:31:53] [config] mini-batch-track-lr: false
[2023-06-30 23:31:53] [config] mini-batch-warmup: 0
[2023-06-30 23:31:53] [config] mini-batch-words: 0
[2023-06-30 23:31:53] [config] mini-batch-words-ref: 0
[2023-06-30 23:31:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:31:53] [config] multi-loss-type: sum
[2023-06-30 23:31:53] [config] n-best: false
[2023-06-30 23:31:53] [config] no-nccl: false
[2023-06-30 23:31:53] [config] no-reload: false
[2023-06-30 23:31:53] [config] no-restore-corpus: false
[2023-06-30 23:31:53] [config] normalize: 0
[2023-06-30 23:31:53] [config] normalize-gradient: false
[2023-06-30 23:31:53] [config] num-devices: 0
[2023-06-30 23:31:53] [config] optimizer: adam
[2023-06-30 23:31:53] [config] optimizer-delay: 1
[2023-06-30 23:31:53] [config] optimizer-params:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] output-omit-bias: false
[2023-06-30 23:31:53] [config] overwrite: true
[2023-06-30 23:31:53] [config] precision:
[2023-06-30 23:31:53] [config]   - float32
[2023-06-30 23:31:53] [config]   - float32
[2023-06-30 23:31:53] [config] pretrained-model: ""
[2023-06-30 23:31:53] [config] quantize-biases: false
[2023-06-30 23:31:53] [config] quantize-bits: 0
[2023-06-30 23:31:53] [config] quantize-log-based: false
[2023-06-30 23:31:53] [config] quantize-optimization-steps: 0
[2023-06-30 23:31:53] [config] quiet: false
[2023-06-30 23:31:53] [config] quiet-translation: true
[2023-06-30 23:31:53] [config] relative-paths: false
[2023-06-30 23:31:53] [config] right-left: false
[2023-06-30 23:31:53] [config] save-freq: 10000u
[2023-06-30 23:31:53] [config] seed: 1234
[2023-06-30 23:31:53] [config] sentencepiece-alphas:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:31:53] [config] sentencepiece-options: ""
[2023-06-30 23:31:53] [config] sharding: global
[2023-06-30 23:31:53] [config] shuffle: data
[2023-06-30 23:31:53] [config] shuffle-in-ram: false
[2023-06-30 23:31:53] [config] sigterm: save-and-exit
[2023-06-30 23:31:53] [config] skip: false
[2023-06-30 23:31:53] [config] sqlite: ""
[2023-06-30 23:31:53] [config] sqlite-drop: false
[2023-06-30 23:31:53] [config] sync-freq: 200u
[2023-06-30 23:31:53] [config] sync-sgd: false
[2023-06-30 23:31:53] [config] tempdir: /tmp
[2023-06-30 23:31:53] [config] tied-embeddings: false
[2023-06-30 23:31:53] [config] tied-embeddings-all: false
[2023-06-30 23:31:53] [config] tied-embeddings-src: false
[2023-06-30 23:31:53] [config] train-embedder-rank:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] train-sets:
[2023-06-30 23:31:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:31:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:31:53] [config] transformer-aan-activation: swish
[2023-06-30 23:31:53] [config] transformer-aan-depth: 2
[2023-06-30 23:31:53] [config] transformer-aan-nogate: false
[2023-06-30 23:31:53] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:31:53] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:31:53] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:31:53] [config] transformer-depth-scaling: false
[2023-06-30 23:31:53] [config] transformer-dim-aan: 2048
[2023-06-30 23:31:53] [config] transformer-dim-ffn: 2048
[2023-06-30 23:31:53] [config] transformer-dropout: 0
[2023-06-30 23:31:53] [config] transformer-dropout-attention: 0
[2023-06-30 23:31:53] [config] transformer-dropout-ffn: 0
[2023-06-30 23:31:53] [config] transformer-ffn-activation: swish
[2023-06-30 23:31:53] [config] transformer-ffn-depth: 2
[2023-06-30 23:31:53] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:31:53] [config] transformer-heads: 8
[2023-06-30 23:31:53] [config] transformer-no-projection: false
[2023-06-30 23:31:53] [config] transformer-pool: false
[2023-06-30 23:31:53] [config] transformer-postprocess: dan
[2023-06-30 23:31:53] [config] transformer-postprocess-emb: d
[2023-06-30 23:31:53] [config] transformer-postprocess-top: ""
[2023-06-30 23:31:53] [config] transformer-preprocess: ""
[2023-06-30 23:31:53] [config] transformer-tied-layers:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] transformer-train-position-embeddings: false
[2023-06-30 23:31:53] [config] tsv: false
[2023-06-30 23:31:53] [config] tsv-fields: 0
[2023-06-30 23:31:53] [config] type: transformer
[2023-06-30 23:31:53] [config] ulr: false
[2023-06-30 23:31:53] [config] ulr-dim-emb: 0
[2023-06-30 23:31:53] [config] ulr-dropout: 0
[2023-06-30 23:31:53] [config] ulr-keys-vectors: ""
[2023-06-30 23:31:53] [config] ulr-query-vectors: ""
[2023-06-30 23:31:53] [config] ulr-softmax-temperature: 1
[2023-06-30 23:31:53] [config] ulr-trainable-transformation: false
[2023-06-30 23:31:53] [config] unlikelihood-loss: false
[2023-06-30 23:31:53] [config] valid-freq: 50000000
[2023-06-30 23:31:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:31:53] [config] valid-max-length: 1000
[2023-06-30 23:31:53] [config] valid-metrics:
[2023-06-30 23:31:53] [config]   - cross-entropy
[2023-06-30 23:31:53] [config]   - translation
[2023-06-30 23:31:53] [config] valid-mini-batch: 32
[2023-06-30 23:31:53] [config] valid-reset-stalled: false
[2023-06-30 23:31:53] [config] valid-script-args:
[2023-06-30 23:31:53] [config]   []
[2023-06-30 23:31:53] [config] valid-script-path: ""
[2023-06-30 23:31:53] [config] valid-sets:
[2023-06-30 23:31:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:31:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:31:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:31:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:31:53] [config] vocabs:
[2023-06-30 23:31:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:31:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:31:53] [config] word-penalty: 0
[2023-06-30 23:31:53] [config] word-scores: false
[2023-06-30 23:31:53] [config] workspace: 2048
[2023-06-30 23:31:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:31:53] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:31:53] [training] Using single-device training
[2023-06-30 23:31:53] Synced seed 1234
[2023-06-30 23:31:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:31:53] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:31:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:31:54] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:31:54] [valid] No post-processing script given for validating translator
[2023-06-30 23:31:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:31:54] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:31:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:31:54] [comm] Using global sharding
[2023-06-30 23:31:54] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:31:54] [training] Using 1 GPUs
[2023-06-30 23:31:54] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:31:56] Loading Adam parameters
[2023-06-30 23:31:57] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:31:57] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:31:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:31:57] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-06-30 23:31:57] [data] Shuffling data
[2023-06-30 23:31:57] [data] Done reading 20,192 sentences
[2023-06-30 23:31:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:31:57] Training started
[2023-06-30 23:31:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 23:31:57] [logits] Applying loss function for 1 factor(s)
[2023-06-30 23:31:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 23:31:57] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:31:57] Parameter type float32, optimization type float32, casting types false
[2023-06-30 23:32:14] Seen 18,843 samples
[2023-06-30 23:32:14] Starting data epoch 92 in logical epoch 92
[2023-06-30 23:32:14] [data] Shuffling data
[2023-06-30 23:32:14] [data] Done reading 20,192 sentences
[2023-06-30 23:32:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:32:15] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.00719758 * 1,333,196 @ 488 after 36,218,424 : Time 21.13s : 63092.48 words/s : gNorm 0.3601
[2023-06-30 23:32:33] Seen 18,843 samples
[2023-06-30 23:32:33] Starting data epoch 93 in logical epoch 93
[2023-06-30 23:32:33] [data] Shuffling data
[2023-06-30 23:32:33] [data] Done reading 20,192 sentences
[2023-06-30 23:32:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:32:52] Seen 18,843 samples
[2023-06-30 23:32:52] Starting data epoch 94 in logical epoch 94
[2023-06-30 23:32:52] [data] Shuffling data
[2023-06-30 23:32:52] [data] Done reading 20,192 sentences
[2023-06-30 23:32:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:33:11] Seen 18,843 samples
[2023-06-30 23:33:11] Starting data epoch 95 in logical epoch 95
[2023-06-30 23:33:11] [data] Shuffling data
[2023-06-30 23:33:11] [data] Done reading 20,192 sentences
[2023-06-30 23:33:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:33:19] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.00661091 * 1,349,095 @ 2,048 after 37,567,519 : Time 64.57s : 20895.02 words/s : gNorm 0.4020
[2023-06-30 23:33:31] Seen 18,843 samples
[2023-06-30 23:33:31] Starting data epoch 96 in logical epoch 96
[2023-06-30 23:33:31] [data] Shuffling data
[2023-06-30 23:33:31] [data] Done reading 20,192 sentences
[2023-06-30 23:33:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:33:50] Seen 18,843 samples
[2023-06-30 23:33:50] Starting data epoch 97 in logical epoch 97
[2023-06-30 23:33:50] [data] Shuffling data
[2023-06-30 23:33:50] [data] Done reading 20,192 sentences
[2023-06-30 23:33:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:34:10] Seen 18,843 samples
[2023-06-30 23:34:10] Starting data epoch 98 in logical epoch 98
[2023-06-30 23:34:10] [data] Shuffling data
[2023-06-30 23:34:10] [data] Done reading 20,192 sentences
[2023-06-30 23:34:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:34:24] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.00660973 * 1,338,821 @ 2,572 after 38,906,340 : Time 65.27s : 20510.93 words/s : gNorm 0.4757
[2023-06-30 23:34:29] Seen 18,843 samples
[2023-06-30 23:34:29] Starting data epoch 99 in logical epoch 99
[2023-06-30 23:34:29] [data] Shuffling data
[2023-06-30 23:34:29] [data] Done reading 20,192 sentences
[2023-06-30 23:34:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:34:48] Seen 18,843 samples
[2023-06-30 23:34:48] Starting data epoch 100 in logical epoch 100
[2023-06-30 23:34:48] [data] Shuffling data
[2023-06-30 23:34:48] [data] Done reading 20,192 sentences
[2023-06-30 23:34:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:35:07] Seen 18,843 samples
[2023-06-30 23:35:07] Starting data epoch 101 in logical epoch 101
[2023-06-30 23:35:07] Training finished
[2023-06-30 23:35:10] [valid] Ep. 101 : Up. 29659 : cross-entropy : 201.886 : stalled 9 times (last best: 125.788)
[2023-06-30 23:37:33] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-06-30 23:37:33] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:37:36] Saving Adam parameters
[2023-06-30 23:37:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:37:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:37:47] [marian] Running on node20.datos.cluster.uy as process 7024 with command line:
[2023-06-30 23:37:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:37:47] [config] after: 0e
[2023-06-30 23:37:47] [config] after-batches: 0
[2023-06-30 23:37:47] [config] after-epochs: 110
[2023-06-30 23:37:47] [config] all-caps-every: 0
[2023-06-30 23:37:47] [config] allow-unk: false
[2023-06-30 23:37:47] [config] authors: false
[2023-06-30 23:37:47] [config] beam-size: 12
[2023-06-30 23:37:47] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:37:47] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:37:47] [config] bert-masking-fraction: 0.15
[2023-06-30 23:37:47] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:37:47] [config] bert-train-type-embeddings: true
[2023-06-30 23:37:47] [config] bert-type-vocab-size: 2
[2023-06-30 23:37:47] [config] build-info: ""
[2023-06-30 23:37:47] [config] check-gradient-nan: false
[2023-06-30 23:37:47] [config] check-nan: false
[2023-06-30 23:37:47] [config] cite: false
[2023-06-30 23:37:47] [config] clip-norm: 1
[2023-06-30 23:37:47] [config] cost-scaling:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] cost-type: ce-sum
[2023-06-30 23:37:47] [config] cpu-threads: 0
[2023-06-30 23:37:47] [config] data-threads: 8
[2023-06-30 23:37:47] [config] data-weighting: ""
[2023-06-30 23:37:47] [config] data-weighting-type: sentence
[2023-06-30 23:37:47] [config] dec-cell: gru
[2023-06-30 23:37:47] [config] dec-cell-base-depth: 2
[2023-06-30 23:37:47] [config] dec-cell-high-depth: 1
[2023-06-30 23:37:47] [config] dec-depth: 1
[2023-06-30 23:37:47] [config] devices:
[2023-06-30 23:37:47] [config]   - 0
[2023-06-30 23:37:47] [config] dim-emb: 512
[2023-06-30 23:37:47] [config] dim-rnn: 1024
[2023-06-30 23:37:47] [config] dim-vocabs:
[2023-06-30 23:37:47] [config]   - 54042
[2023-06-30 23:37:47] [config]   - 36507
[2023-06-30 23:37:47] [config] disp-first: 0
[2023-06-30 23:37:47] [config] disp-freq: 1000u
[2023-06-30 23:37:47] [config] disp-label-counts: true
[2023-06-30 23:37:47] [config] dropout-rnn: 0
[2023-06-30 23:37:47] [config] dropout-src: 0
[2023-06-30 23:37:47] [config] dropout-trg: 0
[2023-06-30 23:37:47] [config] dump-config: ""
[2023-06-30 23:37:47] [config] dynamic-gradient-scaling:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] early-stopping: 10
[2023-06-30 23:37:47] [config] early-stopping-on: first
[2023-06-30 23:37:47] [config] embedding-fix-src: false
[2023-06-30 23:37:47] [config] embedding-fix-trg: false
[2023-06-30 23:37:47] [config] embedding-normalization: false
[2023-06-30 23:37:47] [config] embedding-vectors:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] enc-cell: gru
[2023-06-30 23:37:47] [config] enc-cell-depth: 1
[2023-06-30 23:37:47] [config] enc-depth: 1
[2023-06-30 23:37:47] [config] enc-type: bidirectional
[2023-06-30 23:37:47] [config] english-title-case-every: 0
[2023-06-30 23:37:47] [config] exponential-smoothing: 0
[2023-06-30 23:37:47] [config] factor-weight: 1
[2023-06-30 23:37:47] [config] factors-combine: sum
[2023-06-30 23:37:47] [config] factors-dim-emb: 0
[2023-06-30 23:37:47] [config] gradient-checkpointing: false
[2023-06-30 23:37:47] [config] gradient-norm-average-window: 100
[2023-06-30 23:37:47] [config] guided-alignment: none
[2023-06-30 23:37:47] [config] guided-alignment-cost: mse
[2023-06-30 23:37:47] [config] guided-alignment-weight: 0.1
[2023-06-30 23:37:47] [config] ignore-model-config: false
[2023-06-30 23:37:47] [config] input-types:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] interpolate-env-vars: false
[2023-06-30 23:37:47] [config] keep-best: false
[2023-06-30 23:37:47] [config] label-smoothing: 0
[2023-06-30 23:37:47] [config] layer-normalization: false
[2023-06-30 23:37:47] [config] learn-rate: 0.0001
[2023-06-30 23:37:47] [config] lemma-dependency: ""
[2023-06-30 23:37:47] [config] lemma-dim-emb: 0
[2023-06-30 23:37:47] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:37:47] [config] log-level: info
[2023-06-30 23:37:47] [config] log-time-zone: ""
[2023-06-30 23:37:47] [config] logical-epoch:
[2023-06-30 23:37:47] [config]   - 1e
[2023-06-30 23:37:47] [config]   - 0
[2023-06-30 23:37:47] [config] lr-decay: 0
[2023-06-30 23:37:47] [config] lr-decay-freq: 50000
[2023-06-30 23:37:47] [config] lr-decay-inv-sqrt:
[2023-06-30 23:37:47] [config]   - 0
[2023-06-30 23:37:47] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:37:47] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:37:47] [config] lr-decay-start:
[2023-06-30 23:37:47] [config]   - 10
[2023-06-30 23:37:47] [config]   - 1
[2023-06-30 23:37:47] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:37:47] [config] lr-report: false
[2023-06-30 23:37:47] [config] lr-warmup: 0
[2023-06-30 23:37:47] [config] lr-warmup-at-reload: false
[2023-06-30 23:37:47] [config] lr-warmup-cycle: false
[2023-06-30 23:37:47] [config] lr-warmup-start-rate: 0
[2023-06-30 23:37:47] [config] max-length: 50
[2023-06-30 23:37:47] [config] max-length-crop: false
[2023-06-30 23:37:47] [config] max-length-factor: 3
[2023-06-30 23:37:47] [config] maxi-batch: 100
[2023-06-30 23:37:47] [config] maxi-batch-sort: trg
[2023-06-30 23:37:47] [config] mini-batch: 64
[2023-06-30 23:37:47] [config] mini-batch-fit: false
[2023-06-30 23:37:47] [config] mini-batch-fit-step: 10
[2023-06-30 23:37:47] [config] mini-batch-round-up: true
[2023-06-30 23:37:47] [config] mini-batch-track-lr: false
[2023-06-30 23:37:47] [config] mini-batch-warmup: 0
[2023-06-30 23:37:47] [config] mini-batch-words: 0
[2023-06-30 23:37:47] [config] mini-batch-words-ref: 0
[2023-06-30 23:37:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:37:47] [config] multi-loss-type: sum
[2023-06-30 23:37:47] [config] n-best: false
[2023-06-30 23:37:47] [config] no-nccl: false
[2023-06-30 23:37:47] [config] no-reload: false
[2023-06-30 23:37:47] [config] no-restore-corpus: false
[2023-06-30 23:37:47] [config] normalize: 0
[2023-06-30 23:37:47] [config] normalize-gradient: false
[2023-06-30 23:37:47] [config] num-devices: 0
[2023-06-30 23:37:47] [config] optimizer: adam
[2023-06-30 23:37:47] [config] optimizer-delay: 1
[2023-06-30 23:37:47] [config] optimizer-params:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] output-omit-bias: false
[2023-06-30 23:37:47] [config] overwrite: true
[2023-06-30 23:37:47] [config] precision:
[2023-06-30 23:37:47] [config]   - float32
[2023-06-30 23:37:47] [config]   - float32
[2023-06-30 23:37:47] [config] pretrained-model: ""
[2023-06-30 23:37:47] [config] quantize-biases: false
[2023-06-30 23:37:47] [config] quantize-bits: 0
[2023-06-30 23:37:47] [config] quantize-log-based: false
[2023-06-30 23:37:47] [config] quantize-optimization-steps: 0
[2023-06-30 23:37:47] [config] quiet: false
[2023-06-30 23:37:47] [config] quiet-translation: true
[2023-06-30 23:37:47] [config] relative-paths: false
[2023-06-30 23:37:47] [config] right-left: false
[2023-06-30 23:37:47] [config] save-freq: 10000u
[2023-06-30 23:37:47] [config] seed: 1234
[2023-06-30 23:37:47] [config] sentencepiece-alphas:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:37:47] [config] sentencepiece-options: ""
[2023-06-30 23:37:47] [config] sharding: global
[2023-06-30 23:37:47] [config] shuffle: data
[2023-06-30 23:37:47] [config] shuffle-in-ram: false
[2023-06-30 23:37:47] [config] sigterm: save-and-exit
[2023-06-30 23:37:47] [config] skip: false
[2023-06-30 23:37:47] [config] sqlite: ""
[2023-06-30 23:37:47] [config] sqlite-drop: false
[2023-06-30 23:37:47] [config] sync-freq: 200u
[2023-06-30 23:37:47] [config] sync-sgd: false
[2023-06-30 23:37:47] [config] tempdir: /tmp
[2023-06-30 23:37:47] [config] tied-embeddings: false
[2023-06-30 23:37:47] [config] tied-embeddings-all: false
[2023-06-30 23:37:47] [config] tied-embeddings-src: false
[2023-06-30 23:37:47] [config] train-embedder-rank:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] train-sets:
[2023-06-30 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:37:47] [config] transformer-aan-activation: swish
[2023-06-30 23:37:47] [config] transformer-aan-depth: 2
[2023-06-30 23:37:47] [config] transformer-aan-nogate: false
[2023-06-30 23:37:47] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:37:47] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:37:47] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:37:47] [config] transformer-depth-scaling: false
[2023-06-30 23:37:47] [config] transformer-dim-aan: 2048
[2023-06-30 23:37:47] [config] transformer-dim-ffn: 2048
[2023-06-30 23:37:47] [config] transformer-dropout: 0
[2023-06-30 23:37:47] [config] transformer-dropout-attention: 0
[2023-06-30 23:37:47] [config] transformer-dropout-ffn: 0
[2023-06-30 23:37:47] [config] transformer-ffn-activation: swish
[2023-06-30 23:37:47] [config] transformer-ffn-depth: 2
[2023-06-30 23:37:47] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:37:47] [config] transformer-heads: 8
[2023-06-30 23:37:47] [config] transformer-no-projection: false
[2023-06-30 23:37:47] [config] transformer-pool: false
[2023-06-30 23:37:47] [config] transformer-postprocess: dan
[2023-06-30 23:37:47] [config] transformer-postprocess-emb: d
[2023-06-30 23:37:47] [config] transformer-postprocess-top: ""
[2023-06-30 23:37:47] [config] transformer-preprocess: ""
[2023-06-30 23:37:47] [config] transformer-tied-layers:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] transformer-train-position-embeddings: false
[2023-06-30 23:37:47] [config] tsv: false
[2023-06-30 23:37:47] [config] tsv-fields: 0
[2023-06-30 23:37:47] [config] type: transformer
[2023-06-30 23:37:47] [config] ulr: false
[2023-06-30 23:37:47] [config] ulr-dim-emb: 0
[2023-06-30 23:37:47] [config] ulr-dropout: 0
[2023-06-30 23:37:47] [config] ulr-keys-vectors: ""
[2023-06-30 23:37:47] [config] ulr-query-vectors: ""
[2023-06-30 23:37:47] [config] ulr-softmax-temperature: 1
[2023-06-30 23:37:47] [config] ulr-trainable-transformation: false
[2023-06-30 23:37:47] [config] unlikelihood-loss: false
[2023-06-30 23:37:47] [config] valid-freq: 50000000
[2023-06-30 23:37:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:37:47] [config] valid-max-length: 1000
[2023-06-30 23:37:47] [config] valid-metrics:
[2023-06-30 23:37:47] [config]   - cross-entropy
[2023-06-30 23:37:47] [config]   - translation
[2023-06-30 23:37:47] [config] valid-mini-batch: 32
[2023-06-30 23:37:47] [config] valid-reset-stalled: false
[2023-06-30 23:37:47] [config] valid-script-args:
[2023-06-30 23:37:47] [config]   []
[2023-06-30 23:37:47] [config] valid-script-path: ""
[2023-06-30 23:37:47] [config] valid-sets:
[2023-06-30 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:37:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:37:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:37:47] [config] vocabs:
[2023-06-30 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:37:47] [config] word-penalty: 0
[2023-06-30 23:37:47] [config] word-scores: false
[2023-06-30 23:37:47] [config] workspace: 2048
[2023-06-30 23:37:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:37:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:37:47] [training] Using single-device training
[2023-06-30 23:37:48] Synced seed 1234
[2023-06-30 23:37:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:37:48] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:37:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:37:48] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:37:48] [valid] No post-processing script given for validating translator
[2023-06-30 23:37:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:37:49] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:37:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:37:49] [comm] Using global sharding
[2023-06-30 23:37:49] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:37:49] [training] Using 1 GPUs
[2023-06-30 23:37:49] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:37:51] Loading Adam parameters
[2023-06-30 23:37:51] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:37:51] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:37:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:37:51] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-06-30 23:37:51] [data] Shuffling data
[2023-06-30 23:37:51] [data] Done reading 20,192 sentences
[2023-06-30 23:37:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:37:51] Training started
[2023-06-30 23:37:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-30 23:37:51] [logits] Applying loss function for 1 factor(s)
[2023-06-30 23:37:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-30 23:37:51] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:37:51] Parameter type float32, optimization type float32, casting types false
[2023-06-30 23:38:08] Seen 18,843 samples
[2023-06-30 23:38:08] Starting data epoch 102 in logical epoch 102
[2023-06-30 23:38:08] [data] Shuffling data
[2023-06-30 23:38:08] [data] Done reading 20,192 sentences
[2023-06-30 23:38:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:38:11] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.00669274 * 1,341,254 @ 2,240 after 40,247,594 : Time 23.10s : 58074.17 words/s : gNorm 0.3964
[2023-06-30 23:38:11] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:38:13] Saving Adam parameters
[2023-06-30 23:38:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:38:36] Seen 18,843 samples
[2023-06-30 23:38:36] Starting data epoch 103 in logical epoch 103
[2023-06-30 23:38:36] [data] Shuffling data
[2023-06-30 23:38:36] [data] Done reading 20,192 sentences
[2023-06-30 23:38:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:38:54] Seen 18,843 samples
[2023-06-30 23:38:54] Starting data epoch 104 in logical epoch 104
[2023-06-30 23:38:54] [data] Shuffling data
[2023-06-30 23:38:54] [data] Done reading 20,192 sentences
[2023-06-30 23:38:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:39:13] Seen 18,843 samples
[2023-06-30 23:39:13] Starting data epoch 105 in logical epoch 105
[2023-06-30 23:39:13] [data] Shuffling data
[2023-06-30 23:39:13] [data] Done reading 20,192 sentences
[2023-06-30 23:39:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:39:23] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.00622846 * 1,341,970 @ 1,536 after 41,589,564 : Time 72.05s : 18626.64 words/s : gNorm 0.3479
[2023-06-30 23:39:32] Seen 18,843 samples
[2023-06-30 23:39:32] Starting data epoch 106 in logical epoch 106
[2023-06-30 23:39:32] [data] Shuffling data
[2023-06-30 23:39:32] [data] Done reading 20,192 sentences
[2023-06-30 23:39:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:39:51] Seen 18,843 samples
[2023-06-30 23:39:51] Starting data epoch 107 in logical epoch 107
[2023-06-30 23:39:51] [data] Shuffling data
[2023-06-30 23:39:51] [data] Done reading 20,192 sentences
[2023-06-30 23:39:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:40:11] Seen 18,843 samples
[2023-06-30 23:40:11] Starting data epoch 108 in logical epoch 108
[2023-06-30 23:40:11] [data] Shuffling data
[2023-06-30 23:40:11] [data] Done reading 20,192 sentences
[2023-06-30 23:40:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:40:27] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.00621128 * 1,331,544 @ 948 after 42,921,108 : Time 64.43s : 20667.08 words/s : gNorm 0.3975
[2023-06-30 23:40:30] Seen 18,843 samples
[2023-06-30 23:40:30] Starting data epoch 109 in logical epoch 109
[2023-06-30 23:40:30] [data] Shuffling data
[2023-06-30 23:40:30] [data] Done reading 20,192 sentences
[2023-06-30 23:40:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:40:50] Seen 18,843 samples
[2023-06-30 23:40:50] Starting data epoch 110 in logical epoch 110
[2023-06-30 23:40:50] [data] Shuffling data
[2023-06-30 23:40:50] [data] Done reading 20,192 sentences
[2023-06-30 23:40:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:41:09] Seen 18,843 samples
[2023-06-30 23:41:09] Starting data epoch 111 in logical epoch 111
[2023-06-30 23:41:09] Training finished
[2023-06-30 23:41:12] [valid] Ep. 111 : Up. 32628 : cross-entropy : 205.506 : stalled 10 times (last best: 125.788)
[2023-06-30 23:43:03] [valid] Ep. 111 : Up. 32628 : translation : 0 : new best
[2023-06-30 23:43:03] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:05] Saving Adam parameters
[2023-06-30 23:43:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:15] [marian] Running on node20.datos.cluster.uy as process 7355 with command line:
[2023-06-30 23:43:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:43:15] [config] after: 0e
[2023-06-30 23:43:15] [config] after-batches: 0
[2023-06-30 23:43:15] [config] after-epochs: 120
[2023-06-30 23:43:15] [config] all-caps-every: 0
[2023-06-30 23:43:15] [config] allow-unk: false
[2023-06-30 23:43:15] [config] authors: false
[2023-06-30 23:43:15] [config] beam-size: 12
[2023-06-30 23:43:15] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:43:15] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:43:15] [config] bert-masking-fraction: 0.15
[2023-06-30 23:43:15] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:43:15] [config] bert-train-type-embeddings: true
[2023-06-30 23:43:15] [config] bert-type-vocab-size: 2
[2023-06-30 23:43:15] [config] build-info: ""
[2023-06-30 23:43:15] [config] check-gradient-nan: false
[2023-06-30 23:43:15] [config] check-nan: false
[2023-06-30 23:43:15] [config] cite: false
[2023-06-30 23:43:15] [config] clip-norm: 1
[2023-06-30 23:43:15] [config] cost-scaling:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] cost-type: ce-sum
[2023-06-30 23:43:15] [config] cpu-threads: 0
[2023-06-30 23:43:15] [config] data-threads: 8
[2023-06-30 23:43:15] [config] data-weighting: ""
[2023-06-30 23:43:15] [config] data-weighting-type: sentence
[2023-06-30 23:43:15] [config] dec-cell: gru
[2023-06-30 23:43:15] [config] dec-cell-base-depth: 2
[2023-06-30 23:43:15] [config] dec-cell-high-depth: 1
[2023-06-30 23:43:15] [config] dec-depth: 1
[2023-06-30 23:43:15] [config] devices:
[2023-06-30 23:43:15] [config]   - 0
[2023-06-30 23:43:15] [config] dim-emb: 512
[2023-06-30 23:43:15] [config] dim-rnn: 1024
[2023-06-30 23:43:15] [config] dim-vocabs:
[2023-06-30 23:43:15] [config]   - 54042
[2023-06-30 23:43:15] [config]   - 36507
[2023-06-30 23:43:15] [config] disp-first: 0
[2023-06-30 23:43:15] [config] disp-freq: 1000u
[2023-06-30 23:43:15] [config] disp-label-counts: true
[2023-06-30 23:43:15] [config] dropout-rnn: 0
[2023-06-30 23:43:15] [config] dropout-src: 0
[2023-06-30 23:43:15] [config] dropout-trg: 0
[2023-06-30 23:43:15] [config] dump-config: ""
[2023-06-30 23:43:15] [config] dynamic-gradient-scaling:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] early-stopping: 10
[2023-06-30 23:43:15] [config] early-stopping-on: first
[2023-06-30 23:43:15] [config] embedding-fix-src: false
[2023-06-30 23:43:15] [config] embedding-fix-trg: false
[2023-06-30 23:43:15] [config] embedding-normalization: false
[2023-06-30 23:43:15] [config] embedding-vectors:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] enc-cell: gru
[2023-06-30 23:43:15] [config] enc-cell-depth: 1
[2023-06-30 23:43:15] [config] enc-depth: 1
[2023-06-30 23:43:15] [config] enc-type: bidirectional
[2023-06-30 23:43:15] [config] english-title-case-every: 0
[2023-06-30 23:43:15] [config] exponential-smoothing: 0
[2023-06-30 23:43:15] [config] factor-weight: 1
[2023-06-30 23:43:15] [config] factors-combine: sum
[2023-06-30 23:43:15] [config] factors-dim-emb: 0
[2023-06-30 23:43:15] [config] gradient-checkpointing: false
[2023-06-30 23:43:15] [config] gradient-norm-average-window: 100
[2023-06-30 23:43:15] [config] guided-alignment: none
[2023-06-30 23:43:15] [config] guided-alignment-cost: mse
[2023-06-30 23:43:15] [config] guided-alignment-weight: 0.1
[2023-06-30 23:43:15] [config] ignore-model-config: false
[2023-06-30 23:43:15] [config] input-types:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] interpolate-env-vars: false
[2023-06-30 23:43:15] [config] keep-best: false
[2023-06-30 23:43:15] [config] label-smoothing: 0
[2023-06-30 23:43:15] [config] layer-normalization: false
[2023-06-30 23:43:15] [config] learn-rate: 0.0001
[2023-06-30 23:43:15] [config] lemma-dependency: ""
[2023-06-30 23:43:15] [config] lemma-dim-emb: 0
[2023-06-30 23:43:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:15] [config] log-level: info
[2023-06-30 23:43:15] [config] log-time-zone: ""
[2023-06-30 23:43:15] [config] logical-epoch:
[2023-06-30 23:43:15] [config]   - 1e
[2023-06-30 23:43:15] [config]   - 0
[2023-06-30 23:43:15] [config] lr-decay: 0
[2023-06-30 23:43:15] [config] lr-decay-freq: 50000
[2023-06-30 23:43:15] [config] lr-decay-inv-sqrt:
[2023-06-30 23:43:15] [config]   - 0
[2023-06-30 23:43:15] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:43:15] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:43:15] [config] lr-decay-start:
[2023-06-30 23:43:15] [config]   - 10
[2023-06-30 23:43:15] [config]   - 1
[2023-06-30 23:43:15] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:43:15] [config] lr-report: false
[2023-06-30 23:43:15] [config] lr-warmup: 0
[2023-06-30 23:43:15] [config] lr-warmup-at-reload: false
[2023-06-30 23:43:15] [config] lr-warmup-cycle: false
[2023-06-30 23:43:15] [config] lr-warmup-start-rate: 0
[2023-06-30 23:43:15] [config] max-length: 50
[2023-06-30 23:43:15] [config] max-length-crop: false
[2023-06-30 23:43:15] [config] max-length-factor: 3
[2023-06-30 23:43:15] [config] maxi-batch: 100
[2023-06-30 23:43:15] [config] maxi-batch-sort: trg
[2023-06-30 23:43:15] [config] mini-batch: 64
[2023-06-30 23:43:15] [config] mini-batch-fit: false
[2023-06-30 23:43:15] [config] mini-batch-fit-step: 10
[2023-06-30 23:43:15] [config] mini-batch-round-up: true
[2023-06-30 23:43:15] [config] mini-batch-track-lr: false
[2023-06-30 23:43:15] [config] mini-batch-warmup: 0
[2023-06-30 23:43:15] [config] mini-batch-words: 0
[2023-06-30 23:43:15] [config] mini-batch-words-ref: 0
[2023-06-30 23:43:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:15] [config] multi-loss-type: sum
[2023-06-30 23:43:15] [config] n-best: false
[2023-06-30 23:43:15] [config] no-nccl: false
[2023-06-30 23:43:15] [config] no-reload: false
[2023-06-30 23:43:15] [config] no-restore-corpus: false
[2023-06-30 23:43:15] [config] normalize: 0
[2023-06-30 23:43:15] [config] normalize-gradient: false
[2023-06-30 23:43:15] [config] num-devices: 0
[2023-06-30 23:43:15] [config] optimizer: adam
[2023-06-30 23:43:15] [config] optimizer-delay: 1
[2023-06-30 23:43:15] [config] optimizer-params:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] output-omit-bias: false
[2023-06-30 23:43:15] [config] overwrite: true
[2023-06-30 23:43:15] [config] precision:
[2023-06-30 23:43:15] [config]   - float32
[2023-06-30 23:43:15] [config]   - float32
[2023-06-30 23:43:15] [config] pretrained-model: ""
[2023-06-30 23:43:15] [config] quantize-biases: false
[2023-06-30 23:43:15] [config] quantize-bits: 0
[2023-06-30 23:43:15] [config] quantize-log-based: false
[2023-06-30 23:43:15] [config] quantize-optimization-steps: 0
[2023-06-30 23:43:15] [config] quiet: false
[2023-06-30 23:43:15] [config] quiet-translation: true
[2023-06-30 23:43:15] [config] relative-paths: false
[2023-06-30 23:43:15] [config] right-left: false
[2023-06-30 23:43:15] [config] save-freq: 10000u
[2023-06-30 23:43:15] [config] seed: 1234
[2023-06-30 23:43:15] [config] sentencepiece-alphas:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:43:15] [config] sentencepiece-options: ""
[2023-06-30 23:43:15] [config] sharding: global
[2023-06-30 23:43:15] [config] shuffle: data
[2023-06-30 23:43:15] [config] shuffle-in-ram: false
[2023-06-30 23:43:15] [config] sigterm: save-and-exit
[2023-06-30 23:43:15] [config] skip: false
[2023-06-30 23:43:15] [config] sqlite: ""
[2023-06-30 23:43:15] [config] sqlite-drop: false
[2023-06-30 23:43:15] [config] sync-freq: 200u
[2023-06-30 23:43:15] [config] sync-sgd: false
[2023-06-30 23:43:15] [config] tempdir: /tmp
[2023-06-30 23:43:15] [config] tied-embeddings: false
[2023-06-30 23:43:15] [config] tied-embeddings-all: false
[2023-06-30 23:43:15] [config] tied-embeddings-src: false
[2023-06-30 23:43:15] [config] train-embedder-rank:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] train-sets:
[2023-06-30 23:43:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:43:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:43:15] [config] transformer-aan-activation: swish
[2023-06-30 23:43:15] [config] transformer-aan-depth: 2
[2023-06-30 23:43:15] [config] transformer-aan-nogate: false
[2023-06-30 23:43:15] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:43:15] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:43:15] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:43:15] [config] transformer-depth-scaling: false
[2023-06-30 23:43:15] [config] transformer-dim-aan: 2048
[2023-06-30 23:43:15] [config] transformer-dim-ffn: 2048
[2023-06-30 23:43:15] [config] transformer-dropout: 0
[2023-06-30 23:43:15] [config] transformer-dropout-attention: 0
[2023-06-30 23:43:15] [config] transformer-dropout-ffn: 0
[2023-06-30 23:43:15] [config] transformer-ffn-activation: swish
[2023-06-30 23:43:15] [config] transformer-ffn-depth: 2
[2023-06-30 23:43:15] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:43:15] [config] transformer-heads: 8
[2023-06-30 23:43:15] [config] transformer-no-projection: false
[2023-06-30 23:43:15] [config] transformer-pool: false
[2023-06-30 23:43:15] [config] transformer-postprocess: dan
[2023-06-30 23:43:15] [config] transformer-postprocess-emb: d
[2023-06-30 23:43:15] [config] transformer-postprocess-top: ""
[2023-06-30 23:43:15] [config] transformer-preprocess: ""
[2023-06-30 23:43:15] [config] transformer-tied-layers:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] transformer-train-position-embeddings: false
[2023-06-30 23:43:15] [config] tsv: false
[2023-06-30 23:43:15] [config] tsv-fields: 0
[2023-06-30 23:43:15] [config] type: transformer
[2023-06-30 23:43:15] [config] ulr: false
[2023-06-30 23:43:15] [config] ulr-dim-emb: 0
[2023-06-30 23:43:15] [config] ulr-dropout: 0
[2023-06-30 23:43:15] [config] ulr-keys-vectors: ""
[2023-06-30 23:43:15] [config] ulr-query-vectors: ""
[2023-06-30 23:43:15] [config] ulr-softmax-temperature: 1
[2023-06-30 23:43:15] [config] ulr-trainable-transformation: false
[2023-06-30 23:43:15] [config] unlikelihood-loss: false
[2023-06-30 23:43:15] [config] valid-freq: 50000000
[2023-06-30 23:43:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:15] [config] valid-max-length: 1000
[2023-06-30 23:43:15] [config] valid-metrics:
[2023-06-30 23:43:15] [config]   - cross-entropy
[2023-06-30 23:43:15] [config]   - translation
[2023-06-30 23:43:15] [config] valid-mini-batch: 32
[2023-06-30 23:43:15] [config] valid-reset-stalled: false
[2023-06-30 23:43:15] [config] valid-script-args:
[2023-06-30 23:43:15] [config]   []
[2023-06-30 23:43:15] [config] valid-script-path: ""
[2023-06-30 23:43:15] [config] valid-sets:
[2023-06-30 23:43:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:43:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:43:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:43:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:15] [config] vocabs:
[2023-06-30 23:43:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:15] [config] word-penalty: 0
[2023-06-30 23:43:15] [config] word-scores: false
[2023-06-30 23:43:15] [config] workspace: 2048
[2023-06-30 23:43:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:15] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:15] [training] Using single-device training
[2023-06-30 23:43:16] Synced seed 1234
[2023-06-30 23:43:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:16] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:43:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:16] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:43:16] [valid] No post-processing script given for validating translator
[2023-06-30 23:43:16] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:43:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:43:17] [comm] Using global sharding
[2023-06-30 23:43:17] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:43:17] [training] Using 1 GPUs
[2023-06-30 23:43:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:19] Loading Adam parameters
[2023-06-30 23:43:19] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:43:19] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:43:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:19] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:43:19] [data] Shuffling data
[2023-06-30 23:43:19] [data] Done reading 20,192 sentences
[2023-06-30 23:43:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:43:19] Training started
[2023-06-30 23:43:19] Training finished
[2023-06-30 23:43:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:23] [marian] Running on node20.datos.cluster.uy as process 7405 with command line:
[2023-06-30 23:43:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:43:23] [config] after: 0e
[2023-06-30 23:43:23] [config] after-batches: 0
[2023-06-30 23:43:23] [config] after-epochs: 130
[2023-06-30 23:43:23] [config] all-caps-every: 0
[2023-06-30 23:43:23] [config] allow-unk: false
[2023-06-30 23:43:23] [config] authors: false
[2023-06-30 23:43:23] [config] beam-size: 12
[2023-06-30 23:43:23] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:43:23] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:43:23] [config] bert-masking-fraction: 0.15
[2023-06-30 23:43:23] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:43:23] [config] bert-train-type-embeddings: true
[2023-06-30 23:43:23] [config] bert-type-vocab-size: 2
[2023-06-30 23:43:23] [config] build-info: ""
[2023-06-30 23:43:23] [config] check-gradient-nan: false
[2023-06-30 23:43:23] [config] check-nan: false
[2023-06-30 23:43:23] [config] cite: false
[2023-06-30 23:43:23] [config] clip-norm: 1
[2023-06-30 23:43:23] [config] cost-scaling:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] cost-type: ce-sum
[2023-06-30 23:43:23] [config] cpu-threads: 0
[2023-06-30 23:43:23] [config] data-threads: 8
[2023-06-30 23:43:23] [config] data-weighting: ""
[2023-06-30 23:43:23] [config] data-weighting-type: sentence
[2023-06-30 23:43:23] [config] dec-cell: gru
[2023-06-30 23:43:23] [config] dec-cell-base-depth: 2
[2023-06-30 23:43:23] [config] dec-cell-high-depth: 1
[2023-06-30 23:43:23] [config] dec-depth: 1
[2023-06-30 23:43:23] [config] devices:
[2023-06-30 23:43:23] [config]   - 0
[2023-06-30 23:43:23] [config] dim-emb: 512
[2023-06-30 23:43:23] [config] dim-rnn: 1024
[2023-06-30 23:43:23] [config] dim-vocabs:
[2023-06-30 23:43:23] [config]   - 54042
[2023-06-30 23:43:23] [config]   - 36507
[2023-06-30 23:43:23] [config] disp-first: 0
[2023-06-30 23:43:23] [config] disp-freq: 1000u
[2023-06-30 23:43:23] [config] disp-label-counts: true
[2023-06-30 23:43:23] [config] dropout-rnn: 0
[2023-06-30 23:43:23] [config] dropout-src: 0
[2023-06-30 23:43:23] [config] dropout-trg: 0
[2023-06-30 23:43:23] [config] dump-config: ""
[2023-06-30 23:43:23] [config] dynamic-gradient-scaling:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] early-stopping: 10
[2023-06-30 23:43:23] [config] early-stopping-on: first
[2023-06-30 23:43:23] [config] embedding-fix-src: false
[2023-06-30 23:43:23] [config] embedding-fix-trg: false
[2023-06-30 23:43:23] [config] embedding-normalization: false
[2023-06-30 23:43:23] [config] embedding-vectors:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] enc-cell: gru
[2023-06-30 23:43:23] [config] enc-cell-depth: 1
[2023-06-30 23:43:23] [config] enc-depth: 1
[2023-06-30 23:43:23] [config] enc-type: bidirectional
[2023-06-30 23:43:23] [config] english-title-case-every: 0
[2023-06-30 23:43:23] [config] exponential-smoothing: 0
[2023-06-30 23:43:23] [config] factor-weight: 1
[2023-06-30 23:43:23] [config] factors-combine: sum
[2023-06-30 23:43:23] [config] factors-dim-emb: 0
[2023-06-30 23:43:23] [config] gradient-checkpointing: false
[2023-06-30 23:43:23] [config] gradient-norm-average-window: 100
[2023-06-30 23:43:23] [config] guided-alignment: none
[2023-06-30 23:43:23] [config] guided-alignment-cost: mse
[2023-06-30 23:43:23] [config] guided-alignment-weight: 0.1
[2023-06-30 23:43:23] [config] ignore-model-config: false
[2023-06-30 23:43:23] [config] input-types:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] interpolate-env-vars: false
[2023-06-30 23:43:23] [config] keep-best: false
[2023-06-30 23:43:23] [config] label-smoothing: 0
[2023-06-30 23:43:23] [config] layer-normalization: false
[2023-06-30 23:43:23] [config] learn-rate: 0.0001
[2023-06-30 23:43:23] [config] lemma-dependency: ""
[2023-06-30 23:43:23] [config] lemma-dim-emb: 0
[2023-06-30 23:43:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:23] [config] log-level: info
[2023-06-30 23:43:23] [config] log-time-zone: ""
[2023-06-30 23:43:23] [config] logical-epoch:
[2023-06-30 23:43:23] [config]   - 1e
[2023-06-30 23:43:23] [config]   - 0
[2023-06-30 23:43:23] [config] lr-decay: 0
[2023-06-30 23:43:23] [config] lr-decay-freq: 50000
[2023-06-30 23:43:23] [config] lr-decay-inv-sqrt:
[2023-06-30 23:43:23] [config]   - 0
[2023-06-30 23:43:23] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:43:23] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:43:23] [config] lr-decay-start:
[2023-06-30 23:43:23] [config]   - 10
[2023-06-30 23:43:23] [config]   - 1
[2023-06-30 23:43:23] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:43:23] [config] lr-report: false
[2023-06-30 23:43:23] [config] lr-warmup: 0
[2023-06-30 23:43:23] [config] lr-warmup-at-reload: false
[2023-06-30 23:43:23] [config] lr-warmup-cycle: false
[2023-06-30 23:43:23] [config] lr-warmup-start-rate: 0
[2023-06-30 23:43:23] [config] max-length: 50
[2023-06-30 23:43:23] [config] max-length-crop: false
[2023-06-30 23:43:23] [config] max-length-factor: 3
[2023-06-30 23:43:23] [config] maxi-batch: 100
[2023-06-30 23:43:23] [config] maxi-batch-sort: trg
[2023-06-30 23:43:23] [config] mini-batch: 64
[2023-06-30 23:43:23] [config] mini-batch-fit: false
[2023-06-30 23:43:23] [config] mini-batch-fit-step: 10
[2023-06-30 23:43:23] [config] mini-batch-round-up: true
[2023-06-30 23:43:23] [config] mini-batch-track-lr: false
[2023-06-30 23:43:23] [config] mini-batch-warmup: 0
[2023-06-30 23:43:23] [config] mini-batch-words: 0
[2023-06-30 23:43:23] [config] mini-batch-words-ref: 0
[2023-06-30 23:43:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:23] [config] multi-loss-type: sum
[2023-06-30 23:43:23] [config] n-best: false
[2023-06-30 23:43:23] [config] no-nccl: false
[2023-06-30 23:43:23] [config] no-reload: false
[2023-06-30 23:43:23] [config] no-restore-corpus: false
[2023-06-30 23:43:23] [config] normalize: 0
[2023-06-30 23:43:23] [config] normalize-gradient: false
[2023-06-30 23:43:23] [config] num-devices: 0
[2023-06-30 23:43:23] [config] optimizer: adam
[2023-06-30 23:43:23] [config] optimizer-delay: 1
[2023-06-30 23:43:23] [config] optimizer-params:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] output-omit-bias: false
[2023-06-30 23:43:23] [config] overwrite: true
[2023-06-30 23:43:23] [config] precision:
[2023-06-30 23:43:23] [config]   - float32
[2023-06-30 23:43:23] [config]   - float32
[2023-06-30 23:43:23] [config] pretrained-model: ""
[2023-06-30 23:43:23] [config] quantize-biases: false
[2023-06-30 23:43:23] [config] quantize-bits: 0
[2023-06-30 23:43:23] [config] quantize-log-based: false
[2023-06-30 23:43:23] [config] quantize-optimization-steps: 0
[2023-06-30 23:43:23] [config] quiet: false
[2023-06-30 23:43:23] [config] quiet-translation: true
[2023-06-30 23:43:23] [config] relative-paths: false
[2023-06-30 23:43:23] [config] right-left: false
[2023-06-30 23:43:23] [config] save-freq: 10000u
[2023-06-30 23:43:23] [config] seed: 1234
[2023-06-30 23:43:23] [config] sentencepiece-alphas:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:43:23] [config] sentencepiece-options: ""
[2023-06-30 23:43:23] [config] sharding: global
[2023-06-30 23:43:23] [config] shuffle: data
[2023-06-30 23:43:23] [config] shuffle-in-ram: false
[2023-06-30 23:43:23] [config] sigterm: save-and-exit
[2023-06-30 23:43:23] [config] skip: false
[2023-06-30 23:43:23] [config] sqlite: ""
[2023-06-30 23:43:23] [config] sqlite-drop: false
[2023-06-30 23:43:23] [config] sync-freq: 200u
[2023-06-30 23:43:23] [config] sync-sgd: false
[2023-06-30 23:43:23] [config] tempdir: /tmp
[2023-06-30 23:43:23] [config] tied-embeddings: false
[2023-06-30 23:43:23] [config] tied-embeddings-all: false
[2023-06-30 23:43:23] [config] tied-embeddings-src: false
[2023-06-30 23:43:23] [config] train-embedder-rank:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] train-sets:
[2023-06-30 23:43:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:43:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:43:23] [config] transformer-aan-activation: swish
[2023-06-30 23:43:23] [config] transformer-aan-depth: 2
[2023-06-30 23:43:23] [config] transformer-aan-nogate: false
[2023-06-30 23:43:23] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:43:23] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:43:23] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:43:23] [config] transformer-depth-scaling: false
[2023-06-30 23:43:23] [config] transformer-dim-aan: 2048
[2023-06-30 23:43:23] [config] transformer-dim-ffn: 2048
[2023-06-30 23:43:23] [config] transformer-dropout: 0
[2023-06-30 23:43:23] [config] transformer-dropout-attention: 0
[2023-06-30 23:43:23] [config] transformer-dropout-ffn: 0
[2023-06-30 23:43:23] [config] transformer-ffn-activation: swish
[2023-06-30 23:43:23] [config] transformer-ffn-depth: 2
[2023-06-30 23:43:23] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:43:23] [config] transformer-heads: 8
[2023-06-30 23:43:23] [config] transformer-no-projection: false
[2023-06-30 23:43:23] [config] transformer-pool: false
[2023-06-30 23:43:23] [config] transformer-postprocess: dan
[2023-06-30 23:43:23] [config] transformer-postprocess-emb: d
[2023-06-30 23:43:23] [config] transformer-postprocess-top: ""
[2023-06-30 23:43:23] [config] transformer-preprocess: ""
[2023-06-30 23:43:23] [config] transformer-tied-layers:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] transformer-train-position-embeddings: false
[2023-06-30 23:43:23] [config] tsv: false
[2023-06-30 23:43:23] [config] tsv-fields: 0
[2023-06-30 23:43:23] [config] type: transformer
[2023-06-30 23:43:23] [config] ulr: false
[2023-06-30 23:43:23] [config] ulr-dim-emb: 0
[2023-06-30 23:43:23] [config] ulr-dropout: 0
[2023-06-30 23:43:23] [config] ulr-keys-vectors: ""
[2023-06-30 23:43:23] [config] ulr-query-vectors: ""
[2023-06-30 23:43:23] [config] ulr-softmax-temperature: 1
[2023-06-30 23:43:23] [config] ulr-trainable-transformation: false
[2023-06-30 23:43:23] [config] unlikelihood-loss: false
[2023-06-30 23:43:23] [config] valid-freq: 50000000
[2023-06-30 23:43:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:23] [config] valid-max-length: 1000
[2023-06-30 23:43:23] [config] valid-metrics:
[2023-06-30 23:43:23] [config]   - cross-entropy
[2023-06-30 23:43:23] [config]   - translation
[2023-06-30 23:43:23] [config] valid-mini-batch: 32
[2023-06-30 23:43:23] [config] valid-reset-stalled: false
[2023-06-30 23:43:23] [config] valid-script-args:
[2023-06-30 23:43:23] [config]   []
[2023-06-30 23:43:23] [config] valid-script-path: ""
[2023-06-30 23:43:23] [config] valid-sets:
[2023-06-30 23:43:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:43:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:43:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:43:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:23] [config] vocabs:
[2023-06-30 23:43:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:23] [config] word-penalty: 0
[2023-06-30 23:43:23] [config] word-scores: false
[2023-06-30 23:43:23] [config] workspace: 2048
[2023-06-30 23:43:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:23] [training] Using single-device training
[2023-06-30 23:43:23] Synced seed 1234
[2023-06-30 23:43:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:23] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:43:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:23] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:43:23] [valid] No post-processing script given for validating translator
[2023-06-30 23:43:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:24] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:43:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:43:24] [comm] Using global sharding
[2023-06-30 23:43:24] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:43:24] [training] Using 1 GPUs
[2023-06-30 23:43:24] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:25] Loading Adam parameters
[2023-06-30 23:43:26] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:43:26] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:43:26] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:26] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:43:26] [data] Shuffling data
[2023-06-30 23:43:26] [data] Done reading 20,192 sentences
[2023-06-30 23:43:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:43:26] Training started
[2023-06-30 23:43:26] Training finished
[2023-06-30 23:43:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:30] [marian] Running on node20.datos.cluster.uy as process 7452 with command line:
[2023-06-30 23:43:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:43:30] [config] after: 0e
[2023-06-30 23:43:30] [config] after-batches: 0
[2023-06-30 23:43:30] [config] after-epochs: 140
[2023-06-30 23:43:30] [config] all-caps-every: 0
[2023-06-30 23:43:30] [config] allow-unk: false
[2023-06-30 23:43:30] [config] authors: false
[2023-06-30 23:43:30] [config] beam-size: 12
[2023-06-30 23:43:30] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:43:30] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:43:30] [config] bert-masking-fraction: 0.15
[2023-06-30 23:43:30] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:43:30] [config] bert-train-type-embeddings: true
[2023-06-30 23:43:30] [config] bert-type-vocab-size: 2
[2023-06-30 23:43:30] [config] build-info: ""
[2023-06-30 23:43:30] [config] check-gradient-nan: false
[2023-06-30 23:43:30] [config] check-nan: false
[2023-06-30 23:43:30] [config] cite: false
[2023-06-30 23:43:30] [config] clip-norm: 1
[2023-06-30 23:43:30] [config] cost-scaling:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] cost-type: ce-sum
[2023-06-30 23:43:30] [config] cpu-threads: 0
[2023-06-30 23:43:30] [config] data-threads: 8
[2023-06-30 23:43:30] [config] data-weighting: ""
[2023-06-30 23:43:30] [config] data-weighting-type: sentence
[2023-06-30 23:43:30] [config] dec-cell: gru
[2023-06-30 23:43:30] [config] dec-cell-base-depth: 2
[2023-06-30 23:43:30] [config] dec-cell-high-depth: 1
[2023-06-30 23:43:30] [config] dec-depth: 1
[2023-06-30 23:43:30] [config] devices:
[2023-06-30 23:43:30] [config]   - 0
[2023-06-30 23:43:30] [config] dim-emb: 512
[2023-06-30 23:43:30] [config] dim-rnn: 1024
[2023-06-30 23:43:30] [config] dim-vocabs:
[2023-06-30 23:43:30] [config]   - 54042
[2023-06-30 23:43:30] [config]   - 36507
[2023-06-30 23:43:30] [config] disp-first: 0
[2023-06-30 23:43:30] [config] disp-freq: 1000u
[2023-06-30 23:43:30] [config] disp-label-counts: true
[2023-06-30 23:43:30] [config] dropout-rnn: 0
[2023-06-30 23:43:30] [config] dropout-src: 0
[2023-06-30 23:43:30] [config] dropout-trg: 0
[2023-06-30 23:43:30] [config] dump-config: ""
[2023-06-30 23:43:30] [config] dynamic-gradient-scaling:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] early-stopping: 10
[2023-06-30 23:43:30] [config] early-stopping-on: first
[2023-06-30 23:43:30] [config] embedding-fix-src: false
[2023-06-30 23:43:30] [config] embedding-fix-trg: false
[2023-06-30 23:43:30] [config] embedding-normalization: false
[2023-06-30 23:43:30] [config] embedding-vectors:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] enc-cell: gru
[2023-06-30 23:43:30] [config] enc-cell-depth: 1
[2023-06-30 23:43:30] [config] enc-depth: 1
[2023-06-30 23:43:30] [config] enc-type: bidirectional
[2023-06-30 23:43:30] [config] english-title-case-every: 0
[2023-06-30 23:43:30] [config] exponential-smoothing: 0
[2023-06-30 23:43:30] [config] factor-weight: 1
[2023-06-30 23:43:30] [config] factors-combine: sum
[2023-06-30 23:43:30] [config] factors-dim-emb: 0
[2023-06-30 23:43:30] [config] gradient-checkpointing: false
[2023-06-30 23:43:30] [config] gradient-norm-average-window: 100
[2023-06-30 23:43:30] [config] guided-alignment: none
[2023-06-30 23:43:30] [config] guided-alignment-cost: mse
[2023-06-30 23:43:30] [config] guided-alignment-weight: 0.1
[2023-06-30 23:43:30] [config] ignore-model-config: false
[2023-06-30 23:43:30] [config] input-types:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] interpolate-env-vars: false
[2023-06-30 23:43:30] [config] keep-best: false
[2023-06-30 23:43:30] [config] label-smoothing: 0
[2023-06-30 23:43:30] [config] layer-normalization: false
[2023-06-30 23:43:30] [config] learn-rate: 0.0001
[2023-06-30 23:43:30] [config] lemma-dependency: ""
[2023-06-30 23:43:30] [config] lemma-dim-emb: 0
[2023-06-30 23:43:30] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:30] [config] log-level: info
[2023-06-30 23:43:30] [config] log-time-zone: ""
[2023-06-30 23:43:30] [config] logical-epoch:
[2023-06-30 23:43:30] [config]   - 1e
[2023-06-30 23:43:30] [config]   - 0
[2023-06-30 23:43:30] [config] lr-decay: 0
[2023-06-30 23:43:30] [config] lr-decay-freq: 50000
[2023-06-30 23:43:30] [config] lr-decay-inv-sqrt:
[2023-06-30 23:43:30] [config]   - 0
[2023-06-30 23:43:30] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:43:30] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:43:30] [config] lr-decay-start:
[2023-06-30 23:43:30] [config]   - 10
[2023-06-30 23:43:30] [config]   - 1
[2023-06-30 23:43:30] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:43:30] [config] lr-report: false
[2023-06-30 23:43:30] [config] lr-warmup: 0
[2023-06-30 23:43:30] [config] lr-warmup-at-reload: false
[2023-06-30 23:43:30] [config] lr-warmup-cycle: false
[2023-06-30 23:43:30] [config] lr-warmup-start-rate: 0
[2023-06-30 23:43:30] [config] max-length: 50
[2023-06-30 23:43:30] [config] max-length-crop: false
[2023-06-30 23:43:30] [config] max-length-factor: 3
[2023-06-30 23:43:30] [config] maxi-batch: 100
[2023-06-30 23:43:30] [config] maxi-batch-sort: trg
[2023-06-30 23:43:30] [config] mini-batch: 64
[2023-06-30 23:43:30] [config] mini-batch-fit: false
[2023-06-30 23:43:30] [config] mini-batch-fit-step: 10
[2023-06-30 23:43:30] [config] mini-batch-round-up: true
[2023-06-30 23:43:30] [config] mini-batch-track-lr: false
[2023-06-30 23:43:30] [config] mini-batch-warmup: 0
[2023-06-30 23:43:30] [config] mini-batch-words: 0
[2023-06-30 23:43:30] [config] mini-batch-words-ref: 0
[2023-06-30 23:43:30] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:30] [config] multi-loss-type: sum
[2023-06-30 23:43:30] [config] n-best: false
[2023-06-30 23:43:30] [config] no-nccl: false
[2023-06-30 23:43:30] [config] no-reload: false
[2023-06-30 23:43:30] [config] no-restore-corpus: false
[2023-06-30 23:43:30] [config] normalize: 0
[2023-06-30 23:43:30] [config] normalize-gradient: false
[2023-06-30 23:43:30] [config] num-devices: 0
[2023-06-30 23:43:30] [config] optimizer: adam
[2023-06-30 23:43:30] [config] optimizer-delay: 1
[2023-06-30 23:43:30] [config] optimizer-params:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] output-omit-bias: false
[2023-06-30 23:43:30] [config] overwrite: true
[2023-06-30 23:43:30] [config] precision:
[2023-06-30 23:43:30] [config]   - float32
[2023-06-30 23:43:30] [config]   - float32
[2023-06-30 23:43:30] [config] pretrained-model: ""
[2023-06-30 23:43:30] [config] quantize-biases: false
[2023-06-30 23:43:30] [config] quantize-bits: 0
[2023-06-30 23:43:30] [config] quantize-log-based: false
[2023-06-30 23:43:30] [config] quantize-optimization-steps: 0
[2023-06-30 23:43:30] [config] quiet: false
[2023-06-30 23:43:30] [config] quiet-translation: true
[2023-06-30 23:43:30] [config] relative-paths: false
[2023-06-30 23:43:30] [config] right-left: false
[2023-06-30 23:43:30] [config] save-freq: 10000u
[2023-06-30 23:43:30] [config] seed: 1234
[2023-06-30 23:43:30] [config] sentencepiece-alphas:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:43:30] [config] sentencepiece-options: ""
[2023-06-30 23:43:30] [config] sharding: global
[2023-06-30 23:43:30] [config] shuffle: data
[2023-06-30 23:43:30] [config] shuffle-in-ram: false
[2023-06-30 23:43:30] [config] sigterm: save-and-exit
[2023-06-30 23:43:30] [config] skip: false
[2023-06-30 23:43:30] [config] sqlite: ""
[2023-06-30 23:43:30] [config] sqlite-drop: false
[2023-06-30 23:43:30] [config] sync-freq: 200u
[2023-06-30 23:43:30] [config] sync-sgd: false
[2023-06-30 23:43:30] [config] tempdir: /tmp
[2023-06-30 23:43:30] [config] tied-embeddings: false
[2023-06-30 23:43:30] [config] tied-embeddings-all: false
[2023-06-30 23:43:30] [config] tied-embeddings-src: false
[2023-06-30 23:43:30] [config] train-embedder-rank:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] train-sets:
[2023-06-30 23:43:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:43:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:43:30] [config] transformer-aan-activation: swish
[2023-06-30 23:43:30] [config] transformer-aan-depth: 2
[2023-06-30 23:43:30] [config] transformer-aan-nogate: false
[2023-06-30 23:43:30] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:43:30] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:43:30] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:43:30] [config] transformer-depth-scaling: false
[2023-06-30 23:43:30] [config] transformer-dim-aan: 2048
[2023-06-30 23:43:30] [config] transformer-dim-ffn: 2048
[2023-06-30 23:43:30] [config] transformer-dropout: 0
[2023-06-30 23:43:30] [config] transformer-dropout-attention: 0
[2023-06-30 23:43:30] [config] transformer-dropout-ffn: 0
[2023-06-30 23:43:30] [config] transformer-ffn-activation: swish
[2023-06-30 23:43:30] [config] transformer-ffn-depth: 2
[2023-06-30 23:43:30] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:43:30] [config] transformer-heads: 8
[2023-06-30 23:43:30] [config] transformer-no-projection: false
[2023-06-30 23:43:30] [config] transformer-pool: false
[2023-06-30 23:43:30] [config] transformer-postprocess: dan
[2023-06-30 23:43:30] [config] transformer-postprocess-emb: d
[2023-06-30 23:43:30] [config] transformer-postprocess-top: ""
[2023-06-30 23:43:30] [config] transformer-preprocess: ""
[2023-06-30 23:43:30] [config] transformer-tied-layers:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] transformer-train-position-embeddings: false
[2023-06-30 23:43:30] [config] tsv: false
[2023-06-30 23:43:30] [config] tsv-fields: 0
[2023-06-30 23:43:30] [config] type: transformer
[2023-06-30 23:43:30] [config] ulr: false
[2023-06-30 23:43:30] [config] ulr-dim-emb: 0
[2023-06-30 23:43:30] [config] ulr-dropout: 0
[2023-06-30 23:43:30] [config] ulr-keys-vectors: ""
[2023-06-30 23:43:30] [config] ulr-query-vectors: ""
[2023-06-30 23:43:30] [config] ulr-softmax-temperature: 1
[2023-06-30 23:43:30] [config] ulr-trainable-transformation: false
[2023-06-30 23:43:30] [config] unlikelihood-loss: false
[2023-06-30 23:43:30] [config] valid-freq: 50000000
[2023-06-30 23:43:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:30] [config] valid-max-length: 1000
[2023-06-30 23:43:30] [config] valid-metrics:
[2023-06-30 23:43:30] [config]   - cross-entropy
[2023-06-30 23:43:30] [config]   - translation
[2023-06-30 23:43:30] [config] valid-mini-batch: 32
[2023-06-30 23:43:30] [config] valid-reset-stalled: false
[2023-06-30 23:43:30] [config] valid-script-args:
[2023-06-30 23:43:30] [config]   []
[2023-06-30 23:43:30] [config] valid-script-path: ""
[2023-06-30 23:43:30] [config] valid-sets:
[2023-06-30 23:43:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:43:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:43:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:43:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:30] [config] vocabs:
[2023-06-30 23:43:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:30] [config] word-penalty: 0
[2023-06-30 23:43:30] [config] word-scores: false
[2023-06-30 23:43:30] [config] workspace: 2048
[2023-06-30 23:43:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:30] [training] Using single-device training
[2023-06-30 23:43:30] Synced seed 1234
[2023-06-30 23:43:30] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:30] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:43:30] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:30] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:43:30] [valid] No post-processing script given for validating translator
[2023-06-30 23:43:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:31] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:43:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:43:31] [comm] Using global sharding
[2023-06-30 23:43:31] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:43:31] [training] Using 1 GPUs
[2023-06-30 23:43:31] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:32] Loading Adam parameters
[2023-06-30 23:43:32] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:43:32] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:43:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:33] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:43:33] [data] Shuffling data
[2023-06-30 23:43:33] [data] Done reading 20,192 sentences
[2023-06-30 23:43:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:43:33] Training started
[2023-06-30 23:43:33] Training finished
[2023-06-30 23:43:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:36] [marian] Running on node20.datos.cluster.uy as process 7502 with command line:
[2023-06-30 23:43:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:43:36] [config] after: 0e
[2023-06-30 23:43:36] [config] after-batches: 0
[2023-06-30 23:43:36] [config] after-epochs: 150
[2023-06-30 23:43:36] [config] all-caps-every: 0
[2023-06-30 23:43:36] [config] allow-unk: false
[2023-06-30 23:43:36] [config] authors: false
[2023-06-30 23:43:36] [config] beam-size: 12
[2023-06-30 23:43:36] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:43:36] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:43:36] [config] bert-masking-fraction: 0.15
[2023-06-30 23:43:36] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:43:36] [config] bert-train-type-embeddings: true
[2023-06-30 23:43:36] [config] bert-type-vocab-size: 2
[2023-06-30 23:43:36] [config] build-info: ""
[2023-06-30 23:43:36] [config] check-gradient-nan: false
[2023-06-30 23:43:36] [config] check-nan: false
[2023-06-30 23:43:36] [config] cite: false
[2023-06-30 23:43:36] [config] clip-norm: 1
[2023-06-30 23:43:36] [config] cost-scaling:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] cost-type: ce-sum
[2023-06-30 23:43:36] [config] cpu-threads: 0
[2023-06-30 23:43:36] [config] data-threads: 8
[2023-06-30 23:43:36] [config] data-weighting: ""
[2023-06-30 23:43:36] [config] data-weighting-type: sentence
[2023-06-30 23:43:36] [config] dec-cell: gru
[2023-06-30 23:43:36] [config] dec-cell-base-depth: 2
[2023-06-30 23:43:36] [config] dec-cell-high-depth: 1
[2023-06-30 23:43:36] [config] dec-depth: 1
[2023-06-30 23:43:36] [config] devices:
[2023-06-30 23:43:36] [config]   - 0
[2023-06-30 23:43:36] [config] dim-emb: 512
[2023-06-30 23:43:36] [config] dim-rnn: 1024
[2023-06-30 23:43:36] [config] dim-vocabs:
[2023-06-30 23:43:36] [config]   - 54042
[2023-06-30 23:43:36] [config]   - 36507
[2023-06-30 23:43:36] [config] disp-first: 0
[2023-06-30 23:43:36] [config] disp-freq: 1000u
[2023-06-30 23:43:36] [config] disp-label-counts: true
[2023-06-30 23:43:36] [config] dropout-rnn: 0
[2023-06-30 23:43:36] [config] dropout-src: 0
[2023-06-30 23:43:36] [config] dropout-trg: 0
[2023-06-30 23:43:36] [config] dump-config: ""
[2023-06-30 23:43:36] [config] dynamic-gradient-scaling:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] early-stopping: 10
[2023-06-30 23:43:36] [config] early-stopping-on: first
[2023-06-30 23:43:36] [config] embedding-fix-src: false
[2023-06-30 23:43:36] [config] embedding-fix-trg: false
[2023-06-30 23:43:36] [config] embedding-normalization: false
[2023-06-30 23:43:36] [config] embedding-vectors:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] enc-cell: gru
[2023-06-30 23:43:36] [config] enc-cell-depth: 1
[2023-06-30 23:43:36] [config] enc-depth: 1
[2023-06-30 23:43:36] [config] enc-type: bidirectional
[2023-06-30 23:43:36] [config] english-title-case-every: 0
[2023-06-30 23:43:36] [config] exponential-smoothing: 0
[2023-06-30 23:43:36] [config] factor-weight: 1
[2023-06-30 23:43:36] [config] factors-combine: sum
[2023-06-30 23:43:36] [config] factors-dim-emb: 0
[2023-06-30 23:43:36] [config] gradient-checkpointing: false
[2023-06-30 23:43:36] [config] gradient-norm-average-window: 100
[2023-06-30 23:43:36] [config] guided-alignment: none
[2023-06-30 23:43:36] [config] guided-alignment-cost: mse
[2023-06-30 23:43:36] [config] guided-alignment-weight: 0.1
[2023-06-30 23:43:36] [config] ignore-model-config: false
[2023-06-30 23:43:36] [config] input-types:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] interpolate-env-vars: false
[2023-06-30 23:43:36] [config] keep-best: false
[2023-06-30 23:43:36] [config] label-smoothing: 0
[2023-06-30 23:43:36] [config] layer-normalization: false
[2023-06-30 23:43:36] [config] learn-rate: 0.0001
[2023-06-30 23:43:36] [config] lemma-dependency: ""
[2023-06-30 23:43:36] [config] lemma-dim-emb: 0
[2023-06-30 23:43:36] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:36] [config] log-level: info
[2023-06-30 23:43:36] [config] log-time-zone: ""
[2023-06-30 23:43:36] [config] logical-epoch:
[2023-06-30 23:43:36] [config]   - 1e
[2023-06-30 23:43:36] [config]   - 0
[2023-06-30 23:43:36] [config] lr-decay: 0
[2023-06-30 23:43:36] [config] lr-decay-freq: 50000
[2023-06-30 23:43:36] [config] lr-decay-inv-sqrt:
[2023-06-30 23:43:36] [config]   - 0
[2023-06-30 23:43:36] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:43:36] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:43:36] [config] lr-decay-start:
[2023-06-30 23:43:36] [config]   - 10
[2023-06-30 23:43:36] [config]   - 1
[2023-06-30 23:43:36] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:43:36] [config] lr-report: false
[2023-06-30 23:43:36] [config] lr-warmup: 0
[2023-06-30 23:43:36] [config] lr-warmup-at-reload: false
[2023-06-30 23:43:36] [config] lr-warmup-cycle: false
[2023-06-30 23:43:36] [config] lr-warmup-start-rate: 0
[2023-06-30 23:43:36] [config] max-length: 50
[2023-06-30 23:43:36] [config] max-length-crop: false
[2023-06-30 23:43:36] [config] max-length-factor: 3
[2023-06-30 23:43:36] [config] maxi-batch: 100
[2023-06-30 23:43:36] [config] maxi-batch-sort: trg
[2023-06-30 23:43:36] [config] mini-batch: 64
[2023-06-30 23:43:36] [config] mini-batch-fit: false
[2023-06-30 23:43:36] [config] mini-batch-fit-step: 10
[2023-06-30 23:43:36] [config] mini-batch-round-up: true
[2023-06-30 23:43:36] [config] mini-batch-track-lr: false
[2023-06-30 23:43:36] [config] mini-batch-warmup: 0
[2023-06-30 23:43:36] [config] mini-batch-words: 0
[2023-06-30 23:43:36] [config] mini-batch-words-ref: 0
[2023-06-30 23:43:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:36] [config] multi-loss-type: sum
[2023-06-30 23:43:36] [config] n-best: false
[2023-06-30 23:43:36] [config] no-nccl: false
[2023-06-30 23:43:36] [config] no-reload: false
[2023-06-30 23:43:36] [config] no-restore-corpus: false
[2023-06-30 23:43:36] [config] normalize: 0
[2023-06-30 23:43:36] [config] normalize-gradient: false
[2023-06-30 23:43:36] [config] num-devices: 0
[2023-06-30 23:43:36] [config] optimizer: adam
[2023-06-30 23:43:36] [config] optimizer-delay: 1
[2023-06-30 23:43:36] [config] optimizer-params:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] output-omit-bias: false
[2023-06-30 23:43:36] [config] overwrite: true
[2023-06-30 23:43:36] [config] precision:
[2023-06-30 23:43:36] [config]   - float32
[2023-06-30 23:43:36] [config]   - float32
[2023-06-30 23:43:36] [config] pretrained-model: ""
[2023-06-30 23:43:36] [config] quantize-biases: false
[2023-06-30 23:43:36] [config] quantize-bits: 0
[2023-06-30 23:43:36] [config] quantize-log-based: false
[2023-06-30 23:43:36] [config] quantize-optimization-steps: 0
[2023-06-30 23:43:36] [config] quiet: false
[2023-06-30 23:43:36] [config] quiet-translation: true
[2023-06-30 23:43:36] [config] relative-paths: false
[2023-06-30 23:43:36] [config] right-left: false
[2023-06-30 23:43:36] [config] save-freq: 10000u
[2023-06-30 23:43:36] [config] seed: 1234
[2023-06-30 23:43:36] [config] sentencepiece-alphas:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:43:36] [config] sentencepiece-options: ""
[2023-06-30 23:43:36] [config] sharding: global
[2023-06-30 23:43:36] [config] shuffle: data
[2023-06-30 23:43:36] [config] shuffle-in-ram: false
[2023-06-30 23:43:36] [config] sigterm: save-and-exit
[2023-06-30 23:43:36] [config] skip: false
[2023-06-30 23:43:36] [config] sqlite: ""
[2023-06-30 23:43:36] [config] sqlite-drop: false
[2023-06-30 23:43:36] [config] sync-freq: 200u
[2023-06-30 23:43:36] [config] sync-sgd: false
[2023-06-30 23:43:36] [config] tempdir: /tmp
[2023-06-30 23:43:36] [config] tied-embeddings: false
[2023-06-30 23:43:36] [config] tied-embeddings-all: false
[2023-06-30 23:43:36] [config] tied-embeddings-src: false
[2023-06-30 23:43:36] [config] train-embedder-rank:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] train-sets:
[2023-06-30 23:43:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:43:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:43:36] [config] transformer-aan-activation: swish
[2023-06-30 23:43:36] [config] transformer-aan-depth: 2
[2023-06-30 23:43:36] [config] transformer-aan-nogate: false
[2023-06-30 23:43:36] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:43:36] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:43:36] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:43:36] [config] transformer-depth-scaling: false
[2023-06-30 23:43:36] [config] transformer-dim-aan: 2048
[2023-06-30 23:43:36] [config] transformer-dim-ffn: 2048
[2023-06-30 23:43:36] [config] transformer-dropout: 0
[2023-06-30 23:43:36] [config] transformer-dropout-attention: 0
[2023-06-30 23:43:36] [config] transformer-dropout-ffn: 0
[2023-06-30 23:43:36] [config] transformer-ffn-activation: swish
[2023-06-30 23:43:36] [config] transformer-ffn-depth: 2
[2023-06-30 23:43:36] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:43:36] [config] transformer-heads: 8
[2023-06-30 23:43:36] [config] transformer-no-projection: false
[2023-06-30 23:43:36] [config] transformer-pool: false
[2023-06-30 23:43:36] [config] transformer-postprocess: dan
[2023-06-30 23:43:36] [config] transformer-postprocess-emb: d
[2023-06-30 23:43:36] [config] transformer-postprocess-top: ""
[2023-06-30 23:43:36] [config] transformer-preprocess: ""
[2023-06-30 23:43:36] [config] transformer-tied-layers:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] transformer-train-position-embeddings: false
[2023-06-30 23:43:36] [config] tsv: false
[2023-06-30 23:43:36] [config] tsv-fields: 0
[2023-06-30 23:43:36] [config] type: transformer
[2023-06-30 23:43:36] [config] ulr: false
[2023-06-30 23:43:36] [config] ulr-dim-emb: 0
[2023-06-30 23:43:36] [config] ulr-dropout: 0
[2023-06-30 23:43:36] [config] ulr-keys-vectors: ""
[2023-06-30 23:43:36] [config] ulr-query-vectors: ""
[2023-06-30 23:43:36] [config] ulr-softmax-temperature: 1
[2023-06-30 23:43:36] [config] ulr-trainable-transformation: false
[2023-06-30 23:43:36] [config] unlikelihood-loss: false
[2023-06-30 23:43:36] [config] valid-freq: 50000000
[2023-06-30 23:43:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:36] [config] valid-max-length: 1000
[2023-06-30 23:43:36] [config] valid-metrics:
[2023-06-30 23:43:36] [config]   - cross-entropy
[2023-06-30 23:43:36] [config]   - translation
[2023-06-30 23:43:36] [config] valid-mini-batch: 32
[2023-06-30 23:43:36] [config] valid-reset-stalled: false
[2023-06-30 23:43:36] [config] valid-script-args:
[2023-06-30 23:43:36] [config]   []
[2023-06-30 23:43:36] [config] valid-script-path: ""
[2023-06-30 23:43:36] [config] valid-sets:
[2023-06-30 23:43:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:43:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:43:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:43:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:36] [config] vocabs:
[2023-06-30 23:43:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:36] [config] word-penalty: 0
[2023-06-30 23:43:36] [config] word-scores: false
[2023-06-30 23:43:36] [config] workspace: 2048
[2023-06-30 23:43:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:36] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:36] [training] Using single-device training
[2023-06-30 23:43:36] Synced seed 1234
[2023-06-30 23:43:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:36] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:43:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:36] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:43:36] [valid] No post-processing script given for validating translator
[2023-06-30 23:43:36] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:37] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:43:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:43:37] [comm] Using global sharding
[2023-06-30 23:43:37] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:43:37] [training] Using 1 GPUs
[2023-06-30 23:43:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:38] Loading Adam parameters
[2023-06-30 23:43:39] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:43:39] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:43:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:39] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:43:39] [data] Shuffling data
[2023-06-30 23:43:39] [data] Done reading 20,192 sentences
[2023-06-30 23:43:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:43:39] Training started
[2023-06-30 23:43:39] Training finished
[2023-06-30 23:43:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:42] [marian] Running on node20.datos.cluster.uy as process 7550 with command line:
[2023-06-30 23:43:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:43:42] [config] after: 0e
[2023-06-30 23:43:42] [config] after-batches: 0
[2023-06-30 23:43:42] [config] after-epochs: 160
[2023-06-30 23:43:42] [config] all-caps-every: 0
[2023-06-30 23:43:42] [config] allow-unk: false
[2023-06-30 23:43:42] [config] authors: false
[2023-06-30 23:43:42] [config] beam-size: 12
[2023-06-30 23:43:42] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:43:42] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:43:42] [config] bert-masking-fraction: 0.15
[2023-06-30 23:43:42] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:43:42] [config] bert-train-type-embeddings: true
[2023-06-30 23:43:42] [config] bert-type-vocab-size: 2
[2023-06-30 23:43:42] [config] build-info: ""
[2023-06-30 23:43:42] [config] check-gradient-nan: false
[2023-06-30 23:43:42] [config] check-nan: false
[2023-06-30 23:43:42] [config] cite: false
[2023-06-30 23:43:42] [config] clip-norm: 1
[2023-06-30 23:43:42] [config] cost-scaling:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] cost-type: ce-sum
[2023-06-30 23:43:42] [config] cpu-threads: 0
[2023-06-30 23:43:42] [config] data-threads: 8
[2023-06-30 23:43:42] [config] data-weighting: ""
[2023-06-30 23:43:42] [config] data-weighting-type: sentence
[2023-06-30 23:43:42] [config] dec-cell: gru
[2023-06-30 23:43:42] [config] dec-cell-base-depth: 2
[2023-06-30 23:43:42] [config] dec-cell-high-depth: 1
[2023-06-30 23:43:42] [config] dec-depth: 1
[2023-06-30 23:43:42] [config] devices:
[2023-06-30 23:43:42] [config]   - 0
[2023-06-30 23:43:42] [config] dim-emb: 512
[2023-06-30 23:43:42] [config] dim-rnn: 1024
[2023-06-30 23:43:42] [config] dim-vocabs:
[2023-06-30 23:43:42] [config]   - 54042
[2023-06-30 23:43:42] [config]   - 36507
[2023-06-30 23:43:42] [config] disp-first: 0
[2023-06-30 23:43:42] [config] disp-freq: 1000u
[2023-06-30 23:43:42] [config] disp-label-counts: true
[2023-06-30 23:43:42] [config] dropout-rnn: 0
[2023-06-30 23:43:42] [config] dropout-src: 0
[2023-06-30 23:43:42] [config] dropout-trg: 0
[2023-06-30 23:43:42] [config] dump-config: ""
[2023-06-30 23:43:42] [config] dynamic-gradient-scaling:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] early-stopping: 10
[2023-06-30 23:43:42] [config] early-stopping-on: first
[2023-06-30 23:43:42] [config] embedding-fix-src: false
[2023-06-30 23:43:42] [config] embedding-fix-trg: false
[2023-06-30 23:43:42] [config] embedding-normalization: false
[2023-06-30 23:43:42] [config] embedding-vectors:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] enc-cell: gru
[2023-06-30 23:43:42] [config] enc-cell-depth: 1
[2023-06-30 23:43:42] [config] enc-depth: 1
[2023-06-30 23:43:42] [config] enc-type: bidirectional
[2023-06-30 23:43:42] [config] english-title-case-every: 0
[2023-06-30 23:43:42] [config] exponential-smoothing: 0
[2023-06-30 23:43:42] [config] factor-weight: 1
[2023-06-30 23:43:42] [config] factors-combine: sum
[2023-06-30 23:43:42] [config] factors-dim-emb: 0
[2023-06-30 23:43:42] [config] gradient-checkpointing: false
[2023-06-30 23:43:42] [config] gradient-norm-average-window: 100
[2023-06-30 23:43:42] [config] guided-alignment: none
[2023-06-30 23:43:42] [config] guided-alignment-cost: mse
[2023-06-30 23:43:42] [config] guided-alignment-weight: 0.1
[2023-06-30 23:43:42] [config] ignore-model-config: false
[2023-06-30 23:43:42] [config] input-types:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] interpolate-env-vars: false
[2023-06-30 23:43:42] [config] keep-best: false
[2023-06-30 23:43:42] [config] label-smoothing: 0
[2023-06-30 23:43:42] [config] layer-normalization: false
[2023-06-30 23:43:42] [config] learn-rate: 0.0001
[2023-06-30 23:43:42] [config] lemma-dependency: ""
[2023-06-30 23:43:42] [config] lemma-dim-emb: 0
[2023-06-30 23:43:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:42] [config] log-level: info
[2023-06-30 23:43:42] [config] log-time-zone: ""
[2023-06-30 23:43:42] [config] logical-epoch:
[2023-06-30 23:43:42] [config]   - 1e
[2023-06-30 23:43:42] [config]   - 0
[2023-06-30 23:43:42] [config] lr-decay: 0
[2023-06-30 23:43:42] [config] lr-decay-freq: 50000
[2023-06-30 23:43:42] [config] lr-decay-inv-sqrt:
[2023-06-30 23:43:42] [config]   - 0
[2023-06-30 23:43:42] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:43:42] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:43:42] [config] lr-decay-start:
[2023-06-30 23:43:42] [config]   - 10
[2023-06-30 23:43:42] [config]   - 1
[2023-06-30 23:43:42] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:43:42] [config] lr-report: false
[2023-06-30 23:43:42] [config] lr-warmup: 0
[2023-06-30 23:43:42] [config] lr-warmup-at-reload: false
[2023-06-30 23:43:42] [config] lr-warmup-cycle: false
[2023-06-30 23:43:42] [config] lr-warmup-start-rate: 0
[2023-06-30 23:43:42] [config] max-length: 50
[2023-06-30 23:43:42] [config] max-length-crop: false
[2023-06-30 23:43:42] [config] max-length-factor: 3
[2023-06-30 23:43:42] [config] maxi-batch: 100
[2023-06-30 23:43:42] [config] maxi-batch-sort: trg
[2023-06-30 23:43:42] [config] mini-batch: 64
[2023-06-30 23:43:42] [config] mini-batch-fit: false
[2023-06-30 23:43:42] [config] mini-batch-fit-step: 10
[2023-06-30 23:43:42] [config] mini-batch-round-up: true
[2023-06-30 23:43:42] [config] mini-batch-track-lr: false
[2023-06-30 23:43:42] [config] mini-batch-warmup: 0
[2023-06-30 23:43:42] [config] mini-batch-words: 0
[2023-06-30 23:43:42] [config] mini-batch-words-ref: 0
[2023-06-30 23:43:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:42] [config] multi-loss-type: sum
[2023-06-30 23:43:42] [config] n-best: false
[2023-06-30 23:43:42] [config] no-nccl: false
[2023-06-30 23:43:42] [config] no-reload: false
[2023-06-30 23:43:42] [config] no-restore-corpus: false
[2023-06-30 23:43:42] [config] normalize: 0
[2023-06-30 23:43:42] [config] normalize-gradient: false
[2023-06-30 23:43:42] [config] num-devices: 0
[2023-06-30 23:43:42] [config] optimizer: adam
[2023-06-30 23:43:42] [config] optimizer-delay: 1
[2023-06-30 23:43:42] [config] optimizer-params:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] output-omit-bias: false
[2023-06-30 23:43:42] [config] overwrite: true
[2023-06-30 23:43:42] [config] precision:
[2023-06-30 23:43:42] [config]   - float32
[2023-06-30 23:43:42] [config]   - float32
[2023-06-30 23:43:42] [config] pretrained-model: ""
[2023-06-30 23:43:42] [config] quantize-biases: false
[2023-06-30 23:43:42] [config] quantize-bits: 0
[2023-06-30 23:43:42] [config] quantize-log-based: false
[2023-06-30 23:43:42] [config] quantize-optimization-steps: 0
[2023-06-30 23:43:42] [config] quiet: false
[2023-06-30 23:43:42] [config] quiet-translation: true
[2023-06-30 23:43:42] [config] relative-paths: false
[2023-06-30 23:43:42] [config] right-left: false
[2023-06-30 23:43:42] [config] save-freq: 10000u
[2023-06-30 23:43:42] [config] seed: 1234
[2023-06-30 23:43:42] [config] sentencepiece-alphas:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:43:42] [config] sentencepiece-options: ""
[2023-06-30 23:43:42] [config] sharding: global
[2023-06-30 23:43:42] [config] shuffle: data
[2023-06-30 23:43:42] [config] shuffle-in-ram: false
[2023-06-30 23:43:42] [config] sigterm: save-and-exit
[2023-06-30 23:43:42] [config] skip: false
[2023-06-30 23:43:42] [config] sqlite: ""
[2023-06-30 23:43:42] [config] sqlite-drop: false
[2023-06-30 23:43:42] [config] sync-freq: 200u
[2023-06-30 23:43:42] [config] sync-sgd: false
[2023-06-30 23:43:42] [config] tempdir: /tmp
[2023-06-30 23:43:42] [config] tied-embeddings: false
[2023-06-30 23:43:42] [config] tied-embeddings-all: false
[2023-06-30 23:43:42] [config] tied-embeddings-src: false
[2023-06-30 23:43:42] [config] train-embedder-rank:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] train-sets:
[2023-06-30 23:43:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:43:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:43:42] [config] transformer-aan-activation: swish
[2023-06-30 23:43:42] [config] transformer-aan-depth: 2
[2023-06-30 23:43:42] [config] transformer-aan-nogate: false
[2023-06-30 23:43:42] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:43:42] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:43:42] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:43:42] [config] transformer-depth-scaling: false
[2023-06-30 23:43:42] [config] transformer-dim-aan: 2048
[2023-06-30 23:43:42] [config] transformer-dim-ffn: 2048
[2023-06-30 23:43:42] [config] transformer-dropout: 0
[2023-06-30 23:43:42] [config] transformer-dropout-attention: 0
[2023-06-30 23:43:42] [config] transformer-dropout-ffn: 0
[2023-06-30 23:43:42] [config] transformer-ffn-activation: swish
[2023-06-30 23:43:42] [config] transformer-ffn-depth: 2
[2023-06-30 23:43:42] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:43:42] [config] transformer-heads: 8
[2023-06-30 23:43:42] [config] transformer-no-projection: false
[2023-06-30 23:43:42] [config] transformer-pool: false
[2023-06-30 23:43:42] [config] transformer-postprocess: dan
[2023-06-30 23:43:42] [config] transformer-postprocess-emb: d
[2023-06-30 23:43:42] [config] transformer-postprocess-top: ""
[2023-06-30 23:43:42] [config] transformer-preprocess: ""
[2023-06-30 23:43:42] [config] transformer-tied-layers:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] transformer-train-position-embeddings: false
[2023-06-30 23:43:42] [config] tsv: false
[2023-06-30 23:43:42] [config] tsv-fields: 0
[2023-06-30 23:43:42] [config] type: transformer
[2023-06-30 23:43:42] [config] ulr: false
[2023-06-30 23:43:42] [config] ulr-dim-emb: 0
[2023-06-30 23:43:42] [config] ulr-dropout: 0
[2023-06-30 23:43:42] [config] ulr-keys-vectors: ""
[2023-06-30 23:43:42] [config] ulr-query-vectors: ""
[2023-06-30 23:43:42] [config] ulr-softmax-temperature: 1
[2023-06-30 23:43:42] [config] ulr-trainable-transformation: false
[2023-06-30 23:43:42] [config] unlikelihood-loss: false
[2023-06-30 23:43:42] [config] valid-freq: 50000000
[2023-06-30 23:43:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:42] [config] valid-max-length: 1000
[2023-06-30 23:43:42] [config] valid-metrics:
[2023-06-30 23:43:42] [config]   - cross-entropy
[2023-06-30 23:43:42] [config]   - translation
[2023-06-30 23:43:42] [config] valid-mini-batch: 32
[2023-06-30 23:43:42] [config] valid-reset-stalled: false
[2023-06-30 23:43:42] [config] valid-script-args:
[2023-06-30 23:43:42] [config]   []
[2023-06-30 23:43:42] [config] valid-script-path: ""
[2023-06-30 23:43:42] [config] valid-sets:
[2023-06-30 23:43:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:43:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:43:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:43:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:42] [config] vocabs:
[2023-06-30 23:43:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:42] [config] word-penalty: 0
[2023-06-30 23:43:42] [config] word-scores: false
[2023-06-30 23:43:42] [config] workspace: 2048
[2023-06-30 23:43:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:42] [training] Using single-device training
[2023-06-30 23:43:42] Synced seed 1234
[2023-06-30 23:43:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:43] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:43:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:43] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:43:43] [valid] No post-processing script given for validating translator
[2023-06-30 23:43:43] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:43:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:43:44] [comm] Using global sharding
[2023-06-30 23:43:44] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:43:44] [training] Using 1 GPUs
[2023-06-30 23:43:44] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:45] Loading Adam parameters
[2023-06-30 23:43:45] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:43:45] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:43:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:45] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:43:45] [data] Shuffling data
[2023-06-30 23:43:45] [data] Done reading 20,192 sentences
[2023-06-30 23:43:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:43:45] Training started
[2023-06-30 23:43:45] Training finished
[2023-06-30 23:43:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:49] [marian] Running on node20.datos.cluster.uy as process 7597 with command line:
[2023-06-30 23:43:49] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:43:49] [config] after: 0e
[2023-06-30 23:43:49] [config] after-batches: 0
[2023-06-30 23:43:49] [config] after-epochs: 170
[2023-06-30 23:43:49] [config] all-caps-every: 0
[2023-06-30 23:43:49] [config] allow-unk: false
[2023-06-30 23:43:49] [config] authors: false
[2023-06-30 23:43:49] [config] beam-size: 12
[2023-06-30 23:43:49] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:43:49] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:43:49] [config] bert-masking-fraction: 0.15
[2023-06-30 23:43:49] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:43:49] [config] bert-train-type-embeddings: true
[2023-06-30 23:43:49] [config] bert-type-vocab-size: 2
[2023-06-30 23:43:49] [config] build-info: ""
[2023-06-30 23:43:49] [config] check-gradient-nan: false
[2023-06-30 23:43:49] [config] check-nan: false
[2023-06-30 23:43:49] [config] cite: false
[2023-06-30 23:43:49] [config] clip-norm: 1
[2023-06-30 23:43:49] [config] cost-scaling:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] cost-type: ce-sum
[2023-06-30 23:43:49] [config] cpu-threads: 0
[2023-06-30 23:43:49] [config] data-threads: 8
[2023-06-30 23:43:49] [config] data-weighting: ""
[2023-06-30 23:43:49] [config] data-weighting-type: sentence
[2023-06-30 23:43:49] [config] dec-cell: gru
[2023-06-30 23:43:49] [config] dec-cell-base-depth: 2
[2023-06-30 23:43:49] [config] dec-cell-high-depth: 1
[2023-06-30 23:43:49] [config] dec-depth: 1
[2023-06-30 23:43:49] [config] devices:
[2023-06-30 23:43:49] [config]   - 0
[2023-06-30 23:43:49] [config] dim-emb: 512
[2023-06-30 23:43:49] [config] dim-rnn: 1024
[2023-06-30 23:43:49] [config] dim-vocabs:
[2023-06-30 23:43:49] [config]   - 54042
[2023-06-30 23:43:49] [config]   - 36507
[2023-06-30 23:43:49] [config] disp-first: 0
[2023-06-30 23:43:49] [config] disp-freq: 1000u
[2023-06-30 23:43:49] [config] disp-label-counts: true
[2023-06-30 23:43:49] [config] dropout-rnn: 0
[2023-06-30 23:43:49] [config] dropout-src: 0
[2023-06-30 23:43:49] [config] dropout-trg: 0
[2023-06-30 23:43:49] [config] dump-config: ""
[2023-06-30 23:43:49] [config] dynamic-gradient-scaling:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] early-stopping: 10
[2023-06-30 23:43:49] [config] early-stopping-on: first
[2023-06-30 23:43:49] [config] embedding-fix-src: false
[2023-06-30 23:43:49] [config] embedding-fix-trg: false
[2023-06-30 23:43:49] [config] embedding-normalization: false
[2023-06-30 23:43:49] [config] embedding-vectors:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] enc-cell: gru
[2023-06-30 23:43:49] [config] enc-cell-depth: 1
[2023-06-30 23:43:49] [config] enc-depth: 1
[2023-06-30 23:43:49] [config] enc-type: bidirectional
[2023-06-30 23:43:49] [config] english-title-case-every: 0
[2023-06-30 23:43:49] [config] exponential-smoothing: 0
[2023-06-30 23:43:49] [config] factor-weight: 1
[2023-06-30 23:43:49] [config] factors-combine: sum
[2023-06-30 23:43:49] [config] factors-dim-emb: 0
[2023-06-30 23:43:49] [config] gradient-checkpointing: false
[2023-06-30 23:43:49] [config] gradient-norm-average-window: 100
[2023-06-30 23:43:49] [config] guided-alignment: none
[2023-06-30 23:43:49] [config] guided-alignment-cost: mse
[2023-06-30 23:43:49] [config] guided-alignment-weight: 0.1
[2023-06-30 23:43:49] [config] ignore-model-config: false
[2023-06-30 23:43:49] [config] input-types:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] interpolate-env-vars: false
[2023-06-30 23:43:49] [config] keep-best: false
[2023-06-30 23:43:49] [config] label-smoothing: 0
[2023-06-30 23:43:49] [config] layer-normalization: false
[2023-06-30 23:43:49] [config] learn-rate: 0.0001
[2023-06-30 23:43:49] [config] lemma-dependency: ""
[2023-06-30 23:43:49] [config] lemma-dim-emb: 0
[2023-06-30 23:43:49] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:49] [config] log-level: info
[2023-06-30 23:43:49] [config] log-time-zone: ""
[2023-06-30 23:43:49] [config] logical-epoch:
[2023-06-30 23:43:49] [config]   - 1e
[2023-06-30 23:43:49] [config]   - 0
[2023-06-30 23:43:49] [config] lr-decay: 0
[2023-06-30 23:43:49] [config] lr-decay-freq: 50000
[2023-06-30 23:43:49] [config] lr-decay-inv-sqrt:
[2023-06-30 23:43:49] [config]   - 0
[2023-06-30 23:43:49] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:43:49] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:43:49] [config] lr-decay-start:
[2023-06-30 23:43:49] [config]   - 10
[2023-06-30 23:43:49] [config]   - 1
[2023-06-30 23:43:49] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:43:49] [config] lr-report: false
[2023-06-30 23:43:49] [config] lr-warmup: 0
[2023-06-30 23:43:49] [config] lr-warmup-at-reload: false
[2023-06-30 23:43:49] [config] lr-warmup-cycle: false
[2023-06-30 23:43:49] [config] lr-warmup-start-rate: 0
[2023-06-30 23:43:49] [config] max-length: 50
[2023-06-30 23:43:49] [config] max-length-crop: false
[2023-06-30 23:43:49] [config] max-length-factor: 3
[2023-06-30 23:43:49] [config] maxi-batch: 100
[2023-06-30 23:43:49] [config] maxi-batch-sort: trg
[2023-06-30 23:43:49] [config] mini-batch: 64
[2023-06-30 23:43:49] [config] mini-batch-fit: false
[2023-06-30 23:43:49] [config] mini-batch-fit-step: 10
[2023-06-30 23:43:49] [config] mini-batch-round-up: true
[2023-06-30 23:43:49] [config] mini-batch-track-lr: false
[2023-06-30 23:43:49] [config] mini-batch-warmup: 0
[2023-06-30 23:43:49] [config] mini-batch-words: 0
[2023-06-30 23:43:49] [config] mini-batch-words-ref: 0
[2023-06-30 23:43:49] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:49] [config] multi-loss-type: sum
[2023-06-30 23:43:49] [config] n-best: false
[2023-06-30 23:43:49] [config] no-nccl: false
[2023-06-30 23:43:49] [config] no-reload: false
[2023-06-30 23:43:49] [config] no-restore-corpus: false
[2023-06-30 23:43:49] [config] normalize: 0
[2023-06-30 23:43:49] [config] normalize-gradient: false
[2023-06-30 23:43:49] [config] num-devices: 0
[2023-06-30 23:43:49] [config] optimizer: adam
[2023-06-30 23:43:49] [config] optimizer-delay: 1
[2023-06-30 23:43:49] [config] optimizer-params:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] output-omit-bias: false
[2023-06-30 23:43:49] [config] overwrite: true
[2023-06-30 23:43:49] [config] precision:
[2023-06-30 23:43:49] [config]   - float32
[2023-06-30 23:43:49] [config]   - float32
[2023-06-30 23:43:49] [config] pretrained-model: ""
[2023-06-30 23:43:49] [config] quantize-biases: false
[2023-06-30 23:43:49] [config] quantize-bits: 0
[2023-06-30 23:43:49] [config] quantize-log-based: false
[2023-06-30 23:43:49] [config] quantize-optimization-steps: 0
[2023-06-30 23:43:49] [config] quiet: false
[2023-06-30 23:43:49] [config] quiet-translation: true
[2023-06-30 23:43:49] [config] relative-paths: false
[2023-06-30 23:43:49] [config] right-left: false
[2023-06-30 23:43:49] [config] save-freq: 10000u
[2023-06-30 23:43:49] [config] seed: 1234
[2023-06-30 23:43:49] [config] sentencepiece-alphas:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:43:49] [config] sentencepiece-options: ""
[2023-06-30 23:43:49] [config] sharding: global
[2023-06-30 23:43:49] [config] shuffle: data
[2023-06-30 23:43:49] [config] shuffle-in-ram: false
[2023-06-30 23:43:49] [config] sigterm: save-and-exit
[2023-06-30 23:43:49] [config] skip: false
[2023-06-30 23:43:49] [config] sqlite: ""
[2023-06-30 23:43:49] [config] sqlite-drop: false
[2023-06-30 23:43:49] [config] sync-freq: 200u
[2023-06-30 23:43:49] [config] sync-sgd: false
[2023-06-30 23:43:49] [config] tempdir: /tmp
[2023-06-30 23:43:49] [config] tied-embeddings: false
[2023-06-30 23:43:49] [config] tied-embeddings-all: false
[2023-06-30 23:43:49] [config] tied-embeddings-src: false
[2023-06-30 23:43:49] [config] train-embedder-rank:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] train-sets:
[2023-06-30 23:43:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:43:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:43:49] [config] transformer-aan-activation: swish
[2023-06-30 23:43:49] [config] transformer-aan-depth: 2
[2023-06-30 23:43:49] [config] transformer-aan-nogate: false
[2023-06-30 23:43:49] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:43:49] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:43:49] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:43:49] [config] transformer-depth-scaling: false
[2023-06-30 23:43:49] [config] transformer-dim-aan: 2048
[2023-06-30 23:43:49] [config] transformer-dim-ffn: 2048
[2023-06-30 23:43:49] [config] transformer-dropout: 0
[2023-06-30 23:43:49] [config] transformer-dropout-attention: 0
[2023-06-30 23:43:49] [config] transformer-dropout-ffn: 0
[2023-06-30 23:43:49] [config] transformer-ffn-activation: swish
[2023-06-30 23:43:49] [config] transformer-ffn-depth: 2
[2023-06-30 23:43:49] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:43:49] [config] transformer-heads: 8
[2023-06-30 23:43:49] [config] transformer-no-projection: false
[2023-06-30 23:43:49] [config] transformer-pool: false
[2023-06-30 23:43:49] [config] transformer-postprocess: dan
[2023-06-30 23:43:49] [config] transformer-postprocess-emb: d
[2023-06-30 23:43:49] [config] transformer-postprocess-top: ""
[2023-06-30 23:43:49] [config] transformer-preprocess: ""
[2023-06-30 23:43:49] [config] transformer-tied-layers:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] transformer-train-position-embeddings: false
[2023-06-30 23:43:49] [config] tsv: false
[2023-06-30 23:43:49] [config] tsv-fields: 0
[2023-06-30 23:43:49] [config] type: transformer
[2023-06-30 23:43:49] [config] ulr: false
[2023-06-30 23:43:49] [config] ulr-dim-emb: 0
[2023-06-30 23:43:49] [config] ulr-dropout: 0
[2023-06-30 23:43:49] [config] ulr-keys-vectors: ""
[2023-06-30 23:43:49] [config] ulr-query-vectors: ""
[2023-06-30 23:43:49] [config] ulr-softmax-temperature: 1
[2023-06-30 23:43:49] [config] ulr-trainable-transformation: false
[2023-06-30 23:43:49] [config] unlikelihood-loss: false
[2023-06-30 23:43:49] [config] valid-freq: 50000000
[2023-06-30 23:43:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:49] [config] valid-max-length: 1000
[2023-06-30 23:43:49] [config] valid-metrics:
[2023-06-30 23:43:49] [config]   - cross-entropy
[2023-06-30 23:43:49] [config]   - translation
[2023-06-30 23:43:49] [config] valid-mini-batch: 32
[2023-06-30 23:43:49] [config] valid-reset-stalled: false
[2023-06-30 23:43:49] [config] valid-script-args:
[2023-06-30 23:43:49] [config]   []
[2023-06-30 23:43:49] [config] valid-script-path: ""
[2023-06-30 23:43:49] [config] valid-sets:
[2023-06-30 23:43:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:43:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:43:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:43:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:49] [config] vocabs:
[2023-06-30 23:43:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:49] [config] word-penalty: 0
[2023-06-30 23:43:49] [config] word-scores: false
[2023-06-30 23:43:49] [config] workspace: 2048
[2023-06-30 23:43:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:49] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:49] [training] Using single-device training
[2023-06-30 23:43:51] Synced seed 1234
[2023-06-30 23:43:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:51] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:43:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:51] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:43:51] [valid] No post-processing script given for validating translator
[2023-06-30 23:43:51] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:51] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:43:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:43:52] [comm] Using global sharding
[2023-06-30 23:43:52] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:43:52] [training] Using 1 GPUs
[2023-06-30 23:43:52] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:53] Loading Adam parameters
[2023-06-30 23:43:53] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:43:53] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:43:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:53] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:43:53] [data] Shuffling data
[2023-06-30 23:43:53] [data] Done reading 20,192 sentences
[2023-06-30 23:43:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:43:53] Training started
[2023-06-30 23:43:53] Training finished
[2023-06-30 23:43:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:56] [marian] Running on node20.datos.cluster.uy as process 7645 with command line:
[2023-06-30 23:43:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:43:56] [config] after: 0e
[2023-06-30 23:43:56] [config] after-batches: 0
[2023-06-30 23:43:56] [config] after-epochs: 180
[2023-06-30 23:43:56] [config] all-caps-every: 0
[2023-06-30 23:43:56] [config] allow-unk: false
[2023-06-30 23:43:56] [config] authors: false
[2023-06-30 23:43:56] [config] beam-size: 12
[2023-06-30 23:43:56] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:43:56] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:43:56] [config] bert-masking-fraction: 0.15
[2023-06-30 23:43:56] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:43:56] [config] bert-train-type-embeddings: true
[2023-06-30 23:43:56] [config] bert-type-vocab-size: 2
[2023-06-30 23:43:56] [config] build-info: ""
[2023-06-30 23:43:56] [config] check-gradient-nan: false
[2023-06-30 23:43:56] [config] check-nan: false
[2023-06-30 23:43:56] [config] cite: false
[2023-06-30 23:43:56] [config] clip-norm: 1
[2023-06-30 23:43:56] [config] cost-scaling:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] cost-type: ce-sum
[2023-06-30 23:43:56] [config] cpu-threads: 0
[2023-06-30 23:43:56] [config] data-threads: 8
[2023-06-30 23:43:56] [config] data-weighting: ""
[2023-06-30 23:43:56] [config] data-weighting-type: sentence
[2023-06-30 23:43:56] [config] dec-cell: gru
[2023-06-30 23:43:56] [config] dec-cell-base-depth: 2
[2023-06-30 23:43:56] [config] dec-cell-high-depth: 1
[2023-06-30 23:43:56] [config] dec-depth: 1
[2023-06-30 23:43:56] [config] devices:
[2023-06-30 23:43:56] [config]   - 0
[2023-06-30 23:43:56] [config] dim-emb: 512
[2023-06-30 23:43:56] [config] dim-rnn: 1024
[2023-06-30 23:43:56] [config] dim-vocabs:
[2023-06-30 23:43:56] [config]   - 54042
[2023-06-30 23:43:56] [config]   - 36507
[2023-06-30 23:43:56] [config] disp-first: 0
[2023-06-30 23:43:56] [config] disp-freq: 1000u
[2023-06-30 23:43:56] [config] disp-label-counts: true
[2023-06-30 23:43:56] [config] dropout-rnn: 0
[2023-06-30 23:43:56] [config] dropout-src: 0
[2023-06-30 23:43:56] [config] dropout-trg: 0
[2023-06-30 23:43:56] [config] dump-config: ""
[2023-06-30 23:43:56] [config] dynamic-gradient-scaling:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] early-stopping: 10
[2023-06-30 23:43:56] [config] early-stopping-on: first
[2023-06-30 23:43:56] [config] embedding-fix-src: false
[2023-06-30 23:43:56] [config] embedding-fix-trg: false
[2023-06-30 23:43:56] [config] embedding-normalization: false
[2023-06-30 23:43:56] [config] embedding-vectors:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] enc-cell: gru
[2023-06-30 23:43:56] [config] enc-cell-depth: 1
[2023-06-30 23:43:56] [config] enc-depth: 1
[2023-06-30 23:43:56] [config] enc-type: bidirectional
[2023-06-30 23:43:56] [config] english-title-case-every: 0
[2023-06-30 23:43:56] [config] exponential-smoothing: 0
[2023-06-30 23:43:56] [config] factor-weight: 1
[2023-06-30 23:43:56] [config] factors-combine: sum
[2023-06-30 23:43:56] [config] factors-dim-emb: 0
[2023-06-30 23:43:56] [config] gradient-checkpointing: false
[2023-06-30 23:43:56] [config] gradient-norm-average-window: 100
[2023-06-30 23:43:56] [config] guided-alignment: none
[2023-06-30 23:43:56] [config] guided-alignment-cost: mse
[2023-06-30 23:43:56] [config] guided-alignment-weight: 0.1
[2023-06-30 23:43:56] [config] ignore-model-config: false
[2023-06-30 23:43:56] [config] input-types:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] interpolate-env-vars: false
[2023-06-30 23:43:56] [config] keep-best: false
[2023-06-30 23:43:56] [config] label-smoothing: 0
[2023-06-30 23:43:56] [config] layer-normalization: false
[2023-06-30 23:43:56] [config] learn-rate: 0.0001
[2023-06-30 23:43:56] [config] lemma-dependency: ""
[2023-06-30 23:43:56] [config] lemma-dim-emb: 0
[2023-06-30 23:43:56] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:56] [config] log-level: info
[2023-06-30 23:43:56] [config] log-time-zone: ""
[2023-06-30 23:43:56] [config] logical-epoch:
[2023-06-30 23:43:56] [config]   - 1e
[2023-06-30 23:43:56] [config]   - 0
[2023-06-30 23:43:56] [config] lr-decay: 0
[2023-06-30 23:43:56] [config] lr-decay-freq: 50000
[2023-06-30 23:43:56] [config] lr-decay-inv-sqrt:
[2023-06-30 23:43:56] [config]   - 0
[2023-06-30 23:43:56] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:43:56] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:43:56] [config] lr-decay-start:
[2023-06-30 23:43:56] [config]   - 10
[2023-06-30 23:43:56] [config]   - 1
[2023-06-30 23:43:56] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:43:56] [config] lr-report: false
[2023-06-30 23:43:56] [config] lr-warmup: 0
[2023-06-30 23:43:56] [config] lr-warmup-at-reload: false
[2023-06-30 23:43:56] [config] lr-warmup-cycle: false
[2023-06-30 23:43:56] [config] lr-warmup-start-rate: 0
[2023-06-30 23:43:56] [config] max-length: 50
[2023-06-30 23:43:56] [config] max-length-crop: false
[2023-06-30 23:43:56] [config] max-length-factor: 3
[2023-06-30 23:43:56] [config] maxi-batch: 100
[2023-06-30 23:43:56] [config] maxi-batch-sort: trg
[2023-06-30 23:43:56] [config] mini-batch: 64
[2023-06-30 23:43:56] [config] mini-batch-fit: false
[2023-06-30 23:43:56] [config] mini-batch-fit-step: 10
[2023-06-30 23:43:56] [config] mini-batch-round-up: true
[2023-06-30 23:43:56] [config] mini-batch-track-lr: false
[2023-06-30 23:43:56] [config] mini-batch-warmup: 0
[2023-06-30 23:43:56] [config] mini-batch-words: 0
[2023-06-30 23:43:56] [config] mini-batch-words-ref: 0
[2023-06-30 23:43:56] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:56] [config] multi-loss-type: sum
[2023-06-30 23:43:56] [config] n-best: false
[2023-06-30 23:43:56] [config] no-nccl: false
[2023-06-30 23:43:56] [config] no-reload: false
[2023-06-30 23:43:56] [config] no-restore-corpus: false
[2023-06-30 23:43:56] [config] normalize: 0
[2023-06-30 23:43:56] [config] normalize-gradient: false
[2023-06-30 23:43:56] [config] num-devices: 0
[2023-06-30 23:43:56] [config] optimizer: adam
[2023-06-30 23:43:56] [config] optimizer-delay: 1
[2023-06-30 23:43:56] [config] optimizer-params:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] output-omit-bias: false
[2023-06-30 23:43:56] [config] overwrite: true
[2023-06-30 23:43:56] [config] precision:
[2023-06-30 23:43:56] [config]   - float32
[2023-06-30 23:43:56] [config]   - float32
[2023-06-30 23:43:56] [config] pretrained-model: ""
[2023-06-30 23:43:56] [config] quantize-biases: false
[2023-06-30 23:43:56] [config] quantize-bits: 0
[2023-06-30 23:43:56] [config] quantize-log-based: false
[2023-06-30 23:43:56] [config] quantize-optimization-steps: 0
[2023-06-30 23:43:56] [config] quiet: false
[2023-06-30 23:43:56] [config] quiet-translation: true
[2023-06-30 23:43:56] [config] relative-paths: false
[2023-06-30 23:43:56] [config] right-left: false
[2023-06-30 23:43:56] [config] save-freq: 10000u
[2023-06-30 23:43:56] [config] seed: 1234
[2023-06-30 23:43:56] [config] sentencepiece-alphas:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:43:56] [config] sentencepiece-options: ""
[2023-06-30 23:43:56] [config] sharding: global
[2023-06-30 23:43:56] [config] shuffle: data
[2023-06-30 23:43:56] [config] shuffle-in-ram: false
[2023-06-30 23:43:56] [config] sigterm: save-and-exit
[2023-06-30 23:43:56] [config] skip: false
[2023-06-30 23:43:56] [config] sqlite: ""
[2023-06-30 23:43:56] [config] sqlite-drop: false
[2023-06-30 23:43:56] [config] sync-freq: 200u
[2023-06-30 23:43:56] [config] sync-sgd: false
[2023-06-30 23:43:56] [config] tempdir: /tmp
[2023-06-30 23:43:56] [config] tied-embeddings: false
[2023-06-30 23:43:56] [config] tied-embeddings-all: false
[2023-06-30 23:43:56] [config] tied-embeddings-src: false
[2023-06-30 23:43:56] [config] train-embedder-rank:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] train-sets:
[2023-06-30 23:43:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:43:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:43:56] [config] transformer-aan-activation: swish
[2023-06-30 23:43:56] [config] transformer-aan-depth: 2
[2023-06-30 23:43:56] [config] transformer-aan-nogate: false
[2023-06-30 23:43:56] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:43:56] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:43:56] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:43:56] [config] transformer-depth-scaling: false
[2023-06-30 23:43:56] [config] transformer-dim-aan: 2048
[2023-06-30 23:43:56] [config] transformer-dim-ffn: 2048
[2023-06-30 23:43:56] [config] transformer-dropout: 0
[2023-06-30 23:43:56] [config] transformer-dropout-attention: 0
[2023-06-30 23:43:56] [config] transformer-dropout-ffn: 0
[2023-06-30 23:43:56] [config] transformer-ffn-activation: swish
[2023-06-30 23:43:56] [config] transformer-ffn-depth: 2
[2023-06-30 23:43:56] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:43:56] [config] transformer-heads: 8
[2023-06-30 23:43:56] [config] transformer-no-projection: false
[2023-06-30 23:43:56] [config] transformer-pool: false
[2023-06-30 23:43:56] [config] transformer-postprocess: dan
[2023-06-30 23:43:56] [config] transformer-postprocess-emb: d
[2023-06-30 23:43:56] [config] transformer-postprocess-top: ""
[2023-06-30 23:43:56] [config] transformer-preprocess: ""
[2023-06-30 23:43:56] [config] transformer-tied-layers:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] transformer-train-position-embeddings: false
[2023-06-30 23:43:56] [config] tsv: false
[2023-06-30 23:43:56] [config] tsv-fields: 0
[2023-06-30 23:43:56] [config] type: transformer
[2023-06-30 23:43:56] [config] ulr: false
[2023-06-30 23:43:56] [config] ulr-dim-emb: 0
[2023-06-30 23:43:56] [config] ulr-dropout: 0
[2023-06-30 23:43:56] [config] ulr-keys-vectors: ""
[2023-06-30 23:43:56] [config] ulr-query-vectors: ""
[2023-06-30 23:43:56] [config] ulr-softmax-temperature: 1
[2023-06-30 23:43:56] [config] ulr-trainable-transformation: false
[2023-06-30 23:43:56] [config] unlikelihood-loss: false
[2023-06-30 23:43:56] [config] valid-freq: 50000000
[2023-06-30 23:43:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:43:56] [config] valid-max-length: 1000
[2023-06-30 23:43:56] [config] valid-metrics:
[2023-06-30 23:43:56] [config]   - cross-entropy
[2023-06-30 23:43:56] [config]   - translation
[2023-06-30 23:43:56] [config] valid-mini-batch: 32
[2023-06-30 23:43:56] [config] valid-reset-stalled: false
[2023-06-30 23:43:56] [config] valid-script-args:
[2023-06-30 23:43:56] [config]   []
[2023-06-30 23:43:56] [config] valid-script-path: ""
[2023-06-30 23:43:56] [config] valid-sets:
[2023-06-30 23:43:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:43:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:43:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:43:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:56] [config] vocabs:
[2023-06-30 23:43:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:56] [config] word-penalty: 0
[2023-06-30 23:43:56] [config] word-scores: false
[2023-06-30 23:43:56] [config] workspace: 2048
[2023-06-30 23:43:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:43:56] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:56] [training] Using single-device training
[2023-06-30 23:43:57] Synced seed 1234
[2023-06-30 23:43:57] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:43:57] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:43:57] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:43:57] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:43:57] [valid] No post-processing script given for validating translator
[2023-06-30 23:43:57] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:43:58] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:43:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:43:58] [comm] Using global sharding
[2023-06-30 23:43:58] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:43:58] [training] Using 1 GPUs
[2023-06-30 23:43:58] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:43:59] Loading Adam parameters
[2023-06-30 23:43:59] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:43:59] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:43:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:43:59] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:43:59] [data] Shuffling data
[2023-06-30 23:43:59] [data] Done reading 20,192 sentences
[2023-06-30 23:43:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:43:59] Training started
[2023-06-30 23:43:59] Training finished
[2023-06-30 23:44:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:44:03] [marian] Running on node20.datos.cluster.uy as process 7692 with command line:
[2023-06-30 23:44:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:44:03] [config] after: 0e
[2023-06-30 23:44:03] [config] after-batches: 0
[2023-06-30 23:44:03] [config] after-epochs: 190
[2023-06-30 23:44:03] [config] all-caps-every: 0
[2023-06-30 23:44:03] [config] allow-unk: false
[2023-06-30 23:44:03] [config] authors: false
[2023-06-30 23:44:03] [config] beam-size: 12
[2023-06-30 23:44:03] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:44:03] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:44:03] [config] bert-masking-fraction: 0.15
[2023-06-30 23:44:03] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:44:03] [config] bert-train-type-embeddings: true
[2023-06-30 23:44:03] [config] bert-type-vocab-size: 2
[2023-06-30 23:44:03] [config] build-info: ""
[2023-06-30 23:44:03] [config] check-gradient-nan: false
[2023-06-30 23:44:03] [config] check-nan: false
[2023-06-30 23:44:03] [config] cite: false
[2023-06-30 23:44:03] [config] clip-norm: 1
[2023-06-30 23:44:03] [config] cost-scaling:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] cost-type: ce-sum
[2023-06-30 23:44:03] [config] cpu-threads: 0
[2023-06-30 23:44:03] [config] data-threads: 8
[2023-06-30 23:44:03] [config] data-weighting: ""
[2023-06-30 23:44:03] [config] data-weighting-type: sentence
[2023-06-30 23:44:03] [config] dec-cell: gru
[2023-06-30 23:44:03] [config] dec-cell-base-depth: 2
[2023-06-30 23:44:03] [config] dec-cell-high-depth: 1
[2023-06-30 23:44:03] [config] dec-depth: 1
[2023-06-30 23:44:03] [config] devices:
[2023-06-30 23:44:03] [config]   - 0
[2023-06-30 23:44:03] [config] dim-emb: 512
[2023-06-30 23:44:03] [config] dim-rnn: 1024
[2023-06-30 23:44:03] [config] dim-vocabs:
[2023-06-30 23:44:03] [config]   - 54042
[2023-06-30 23:44:03] [config]   - 36507
[2023-06-30 23:44:03] [config] disp-first: 0
[2023-06-30 23:44:03] [config] disp-freq: 1000u
[2023-06-30 23:44:03] [config] disp-label-counts: true
[2023-06-30 23:44:03] [config] dropout-rnn: 0
[2023-06-30 23:44:03] [config] dropout-src: 0
[2023-06-30 23:44:03] [config] dropout-trg: 0
[2023-06-30 23:44:03] [config] dump-config: ""
[2023-06-30 23:44:03] [config] dynamic-gradient-scaling:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] early-stopping: 10
[2023-06-30 23:44:03] [config] early-stopping-on: first
[2023-06-30 23:44:03] [config] embedding-fix-src: false
[2023-06-30 23:44:03] [config] embedding-fix-trg: false
[2023-06-30 23:44:03] [config] embedding-normalization: false
[2023-06-30 23:44:03] [config] embedding-vectors:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] enc-cell: gru
[2023-06-30 23:44:03] [config] enc-cell-depth: 1
[2023-06-30 23:44:03] [config] enc-depth: 1
[2023-06-30 23:44:03] [config] enc-type: bidirectional
[2023-06-30 23:44:03] [config] english-title-case-every: 0
[2023-06-30 23:44:03] [config] exponential-smoothing: 0
[2023-06-30 23:44:03] [config] factor-weight: 1
[2023-06-30 23:44:03] [config] factors-combine: sum
[2023-06-30 23:44:03] [config] factors-dim-emb: 0
[2023-06-30 23:44:03] [config] gradient-checkpointing: false
[2023-06-30 23:44:03] [config] gradient-norm-average-window: 100
[2023-06-30 23:44:03] [config] guided-alignment: none
[2023-06-30 23:44:03] [config] guided-alignment-cost: mse
[2023-06-30 23:44:03] [config] guided-alignment-weight: 0.1
[2023-06-30 23:44:03] [config] ignore-model-config: false
[2023-06-30 23:44:03] [config] input-types:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] interpolate-env-vars: false
[2023-06-30 23:44:03] [config] keep-best: false
[2023-06-30 23:44:03] [config] label-smoothing: 0
[2023-06-30 23:44:03] [config] layer-normalization: false
[2023-06-30 23:44:03] [config] learn-rate: 0.0001
[2023-06-30 23:44:03] [config] lemma-dependency: ""
[2023-06-30 23:44:03] [config] lemma-dim-emb: 0
[2023-06-30 23:44:03] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:44:03] [config] log-level: info
[2023-06-30 23:44:03] [config] log-time-zone: ""
[2023-06-30 23:44:03] [config] logical-epoch:
[2023-06-30 23:44:03] [config]   - 1e
[2023-06-30 23:44:03] [config]   - 0
[2023-06-30 23:44:03] [config] lr-decay: 0
[2023-06-30 23:44:03] [config] lr-decay-freq: 50000
[2023-06-30 23:44:03] [config] lr-decay-inv-sqrt:
[2023-06-30 23:44:03] [config]   - 0
[2023-06-30 23:44:03] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:44:03] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:44:03] [config] lr-decay-start:
[2023-06-30 23:44:03] [config]   - 10
[2023-06-30 23:44:03] [config]   - 1
[2023-06-30 23:44:03] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:44:03] [config] lr-report: false
[2023-06-30 23:44:03] [config] lr-warmup: 0
[2023-06-30 23:44:03] [config] lr-warmup-at-reload: false
[2023-06-30 23:44:03] [config] lr-warmup-cycle: false
[2023-06-30 23:44:03] [config] lr-warmup-start-rate: 0
[2023-06-30 23:44:03] [config] max-length: 50
[2023-06-30 23:44:03] [config] max-length-crop: false
[2023-06-30 23:44:03] [config] max-length-factor: 3
[2023-06-30 23:44:03] [config] maxi-batch: 100
[2023-06-30 23:44:03] [config] maxi-batch-sort: trg
[2023-06-30 23:44:03] [config] mini-batch: 64
[2023-06-30 23:44:03] [config] mini-batch-fit: false
[2023-06-30 23:44:03] [config] mini-batch-fit-step: 10
[2023-06-30 23:44:03] [config] mini-batch-round-up: true
[2023-06-30 23:44:03] [config] mini-batch-track-lr: false
[2023-06-30 23:44:03] [config] mini-batch-warmup: 0
[2023-06-30 23:44:03] [config] mini-batch-words: 0
[2023-06-30 23:44:03] [config] mini-batch-words-ref: 0
[2023-06-30 23:44:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:44:03] [config] multi-loss-type: sum
[2023-06-30 23:44:03] [config] n-best: false
[2023-06-30 23:44:03] [config] no-nccl: false
[2023-06-30 23:44:03] [config] no-reload: false
[2023-06-30 23:44:03] [config] no-restore-corpus: false
[2023-06-30 23:44:03] [config] normalize: 0
[2023-06-30 23:44:03] [config] normalize-gradient: false
[2023-06-30 23:44:03] [config] num-devices: 0
[2023-06-30 23:44:03] [config] optimizer: adam
[2023-06-30 23:44:03] [config] optimizer-delay: 1
[2023-06-30 23:44:03] [config] optimizer-params:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] output-omit-bias: false
[2023-06-30 23:44:03] [config] overwrite: true
[2023-06-30 23:44:03] [config] precision:
[2023-06-30 23:44:03] [config]   - float32
[2023-06-30 23:44:03] [config]   - float32
[2023-06-30 23:44:03] [config] pretrained-model: ""
[2023-06-30 23:44:03] [config] quantize-biases: false
[2023-06-30 23:44:03] [config] quantize-bits: 0
[2023-06-30 23:44:03] [config] quantize-log-based: false
[2023-06-30 23:44:03] [config] quantize-optimization-steps: 0
[2023-06-30 23:44:03] [config] quiet: false
[2023-06-30 23:44:03] [config] quiet-translation: true
[2023-06-30 23:44:03] [config] relative-paths: false
[2023-06-30 23:44:03] [config] right-left: false
[2023-06-30 23:44:03] [config] save-freq: 10000u
[2023-06-30 23:44:03] [config] seed: 1234
[2023-06-30 23:44:03] [config] sentencepiece-alphas:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:44:03] [config] sentencepiece-options: ""
[2023-06-30 23:44:03] [config] sharding: global
[2023-06-30 23:44:03] [config] shuffle: data
[2023-06-30 23:44:03] [config] shuffle-in-ram: false
[2023-06-30 23:44:03] [config] sigterm: save-and-exit
[2023-06-30 23:44:03] [config] skip: false
[2023-06-30 23:44:03] [config] sqlite: ""
[2023-06-30 23:44:03] [config] sqlite-drop: false
[2023-06-30 23:44:03] [config] sync-freq: 200u
[2023-06-30 23:44:03] [config] sync-sgd: false
[2023-06-30 23:44:03] [config] tempdir: /tmp
[2023-06-30 23:44:03] [config] tied-embeddings: false
[2023-06-30 23:44:03] [config] tied-embeddings-all: false
[2023-06-30 23:44:03] [config] tied-embeddings-src: false
[2023-06-30 23:44:03] [config] train-embedder-rank:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] train-sets:
[2023-06-30 23:44:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:44:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:44:03] [config] transformer-aan-activation: swish
[2023-06-30 23:44:03] [config] transformer-aan-depth: 2
[2023-06-30 23:44:03] [config] transformer-aan-nogate: false
[2023-06-30 23:44:03] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:44:03] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:44:03] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:44:03] [config] transformer-depth-scaling: false
[2023-06-30 23:44:03] [config] transformer-dim-aan: 2048
[2023-06-30 23:44:03] [config] transformer-dim-ffn: 2048
[2023-06-30 23:44:03] [config] transformer-dropout: 0
[2023-06-30 23:44:03] [config] transformer-dropout-attention: 0
[2023-06-30 23:44:03] [config] transformer-dropout-ffn: 0
[2023-06-30 23:44:03] [config] transformer-ffn-activation: swish
[2023-06-30 23:44:03] [config] transformer-ffn-depth: 2
[2023-06-30 23:44:03] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:44:03] [config] transformer-heads: 8
[2023-06-30 23:44:03] [config] transformer-no-projection: false
[2023-06-30 23:44:03] [config] transformer-pool: false
[2023-06-30 23:44:03] [config] transformer-postprocess: dan
[2023-06-30 23:44:03] [config] transformer-postprocess-emb: d
[2023-06-30 23:44:03] [config] transformer-postprocess-top: ""
[2023-06-30 23:44:03] [config] transformer-preprocess: ""
[2023-06-30 23:44:03] [config] transformer-tied-layers:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] transformer-train-position-embeddings: false
[2023-06-30 23:44:03] [config] tsv: false
[2023-06-30 23:44:03] [config] tsv-fields: 0
[2023-06-30 23:44:03] [config] type: transformer
[2023-06-30 23:44:03] [config] ulr: false
[2023-06-30 23:44:03] [config] ulr-dim-emb: 0
[2023-06-30 23:44:03] [config] ulr-dropout: 0
[2023-06-30 23:44:03] [config] ulr-keys-vectors: ""
[2023-06-30 23:44:03] [config] ulr-query-vectors: ""
[2023-06-30 23:44:03] [config] ulr-softmax-temperature: 1
[2023-06-30 23:44:03] [config] ulr-trainable-transformation: false
[2023-06-30 23:44:03] [config] unlikelihood-loss: false
[2023-06-30 23:44:03] [config] valid-freq: 50000000
[2023-06-30 23:44:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:44:03] [config] valid-max-length: 1000
[2023-06-30 23:44:03] [config] valid-metrics:
[2023-06-30 23:44:03] [config]   - cross-entropy
[2023-06-30 23:44:03] [config]   - translation
[2023-06-30 23:44:03] [config] valid-mini-batch: 32
[2023-06-30 23:44:03] [config] valid-reset-stalled: false
[2023-06-30 23:44:03] [config] valid-script-args:
[2023-06-30 23:44:03] [config]   []
[2023-06-30 23:44:03] [config] valid-script-path: ""
[2023-06-30 23:44:03] [config] valid-sets:
[2023-06-30 23:44:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:44:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:44:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:44:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:44:03] [config] vocabs:
[2023-06-30 23:44:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:44:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:44:03] [config] word-penalty: 0
[2023-06-30 23:44:03] [config] word-scores: false
[2023-06-30 23:44:03] [config] workspace: 2048
[2023-06-30 23:44:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:44:03] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:44:03] [training] Using single-device training
[2023-06-30 23:44:03] Synced seed 1234
[2023-06-30 23:44:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:44:03] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:44:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:44:03] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:44:03] [valid] No post-processing script given for validating translator
[2023-06-30 23:44:03] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:44:04] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:44:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:44:04] [comm] Using global sharding
[2023-06-30 23:44:04] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:44:04] [training] Using 1 GPUs
[2023-06-30 23:44:04] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:44:05] Loading Adam parameters
[2023-06-30 23:44:05] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:44:05] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:44:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:44:06] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:44:06] [data] Shuffling data
[2023-06-30 23:44:06] [data] Done reading 20,192 sentences
[2023-06-30 23:44:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:44:06] Training started
[2023-06-30 23:44:06] Training finished
[2023-06-30 23:44:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:44:09] [marian] Running on node20.datos.cluster.uy as process 7739 with command line:
[2023-06-30 23:44:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-06-30 23:44:09] [config] after: 0e
[2023-06-30 23:44:09] [config] after-batches: 0
[2023-06-30 23:44:09] [config] after-epochs: 200
[2023-06-30 23:44:09] [config] all-caps-every: 0
[2023-06-30 23:44:09] [config] allow-unk: false
[2023-06-30 23:44:09] [config] authors: false
[2023-06-30 23:44:09] [config] beam-size: 12
[2023-06-30 23:44:09] [config] bert-class-symbol: "[CLS]"
[2023-06-30 23:44:09] [config] bert-mask-symbol: "[MASK]"
[2023-06-30 23:44:09] [config] bert-masking-fraction: 0.15
[2023-06-30 23:44:09] [config] bert-sep-symbol: "[SEP]"
[2023-06-30 23:44:09] [config] bert-train-type-embeddings: true
[2023-06-30 23:44:09] [config] bert-type-vocab-size: 2
[2023-06-30 23:44:09] [config] build-info: ""
[2023-06-30 23:44:09] [config] check-gradient-nan: false
[2023-06-30 23:44:09] [config] check-nan: false
[2023-06-30 23:44:09] [config] cite: false
[2023-06-30 23:44:09] [config] clip-norm: 1
[2023-06-30 23:44:09] [config] cost-scaling:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] cost-type: ce-sum
[2023-06-30 23:44:09] [config] cpu-threads: 0
[2023-06-30 23:44:09] [config] data-threads: 8
[2023-06-30 23:44:09] [config] data-weighting: ""
[2023-06-30 23:44:09] [config] data-weighting-type: sentence
[2023-06-30 23:44:09] [config] dec-cell: gru
[2023-06-30 23:44:09] [config] dec-cell-base-depth: 2
[2023-06-30 23:44:09] [config] dec-cell-high-depth: 1
[2023-06-30 23:44:09] [config] dec-depth: 1
[2023-06-30 23:44:09] [config] devices:
[2023-06-30 23:44:09] [config]   - 0
[2023-06-30 23:44:09] [config] dim-emb: 512
[2023-06-30 23:44:09] [config] dim-rnn: 1024
[2023-06-30 23:44:09] [config] dim-vocabs:
[2023-06-30 23:44:09] [config]   - 54042
[2023-06-30 23:44:09] [config]   - 36507
[2023-06-30 23:44:09] [config] disp-first: 0
[2023-06-30 23:44:09] [config] disp-freq: 1000u
[2023-06-30 23:44:09] [config] disp-label-counts: true
[2023-06-30 23:44:09] [config] dropout-rnn: 0
[2023-06-30 23:44:09] [config] dropout-src: 0
[2023-06-30 23:44:09] [config] dropout-trg: 0
[2023-06-30 23:44:09] [config] dump-config: ""
[2023-06-30 23:44:09] [config] dynamic-gradient-scaling:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] early-stopping: 10
[2023-06-30 23:44:09] [config] early-stopping-on: first
[2023-06-30 23:44:09] [config] embedding-fix-src: false
[2023-06-30 23:44:09] [config] embedding-fix-trg: false
[2023-06-30 23:44:09] [config] embedding-normalization: false
[2023-06-30 23:44:09] [config] embedding-vectors:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] enc-cell: gru
[2023-06-30 23:44:09] [config] enc-cell-depth: 1
[2023-06-30 23:44:09] [config] enc-depth: 1
[2023-06-30 23:44:09] [config] enc-type: bidirectional
[2023-06-30 23:44:09] [config] english-title-case-every: 0
[2023-06-30 23:44:09] [config] exponential-smoothing: 0
[2023-06-30 23:44:09] [config] factor-weight: 1
[2023-06-30 23:44:09] [config] factors-combine: sum
[2023-06-30 23:44:09] [config] factors-dim-emb: 0
[2023-06-30 23:44:09] [config] gradient-checkpointing: false
[2023-06-30 23:44:09] [config] gradient-norm-average-window: 100
[2023-06-30 23:44:09] [config] guided-alignment: none
[2023-06-30 23:44:09] [config] guided-alignment-cost: mse
[2023-06-30 23:44:09] [config] guided-alignment-weight: 0.1
[2023-06-30 23:44:09] [config] ignore-model-config: false
[2023-06-30 23:44:09] [config] input-types:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] interpolate-env-vars: false
[2023-06-30 23:44:09] [config] keep-best: false
[2023-06-30 23:44:09] [config] label-smoothing: 0
[2023-06-30 23:44:09] [config] layer-normalization: false
[2023-06-30 23:44:09] [config] learn-rate: 0.0001
[2023-06-30 23:44:09] [config] lemma-dependency: ""
[2023-06-30 23:44:09] [config] lemma-dim-emb: 0
[2023-06-30 23:44:09] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_scored_june_transformer.log
[2023-06-30 23:44:09] [config] log-level: info
[2023-06-30 23:44:09] [config] log-time-zone: ""
[2023-06-30 23:44:09] [config] logical-epoch:
[2023-06-30 23:44:09] [config]   - 1e
[2023-06-30 23:44:09] [config]   - 0
[2023-06-30 23:44:09] [config] lr-decay: 0
[2023-06-30 23:44:09] [config] lr-decay-freq: 50000
[2023-06-30 23:44:09] [config] lr-decay-inv-sqrt:
[2023-06-30 23:44:09] [config]   - 0
[2023-06-30 23:44:09] [config] lr-decay-repeat-warmup: false
[2023-06-30 23:44:09] [config] lr-decay-reset-optimizer: false
[2023-06-30 23:44:09] [config] lr-decay-start:
[2023-06-30 23:44:09] [config]   - 10
[2023-06-30 23:44:09] [config]   - 1
[2023-06-30 23:44:09] [config] lr-decay-strategy: epoch+stalled
[2023-06-30 23:44:09] [config] lr-report: false
[2023-06-30 23:44:09] [config] lr-warmup: 0
[2023-06-30 23:44:09] [config] lr-warmup-at-reload: false
[2023-06-30 23:44:09] [config] lr-warmup-cycle: false
[2023-06-30 23:44:09] [config] lr-warmup-start-rate: 0
[2023-06-30 23:44:09] [config] max-length: 50
[2023-06-30 23:44:09] [config] max-length-crop: false
[2023-06-30 23:44:09] [config] max-length-factor: 3
[2023-06-30 23:44:09] [config] maxi-batch: 100
[2023-06-30 23:44:09] [config] maxi-batch-sort: trg
[2023-06-30 23:44:09] [config] mini-batch: 64
[2023-06-30 23:44:09] [config] mini-batch-fit: false
[2023-06-30 23:44:09] [config] mini-batch-fit-step: 10
[2023-06-30 23:44:09] [config] mini-batch-round-up: true
[2023-06-30 23:44:09] [config] mini-batch-track-lr: false
[2023-06-30 23:44:09] [config] mini-batch-warmup: 0
[2023-06-30 23:44:09] [config] mini-batch-words: 0
[2023-06-30 23:44:09] [config] mini-batch-words-ref: 0
[2023-06-30 23:44:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:44:09] [config] multi-loss-type: sum
[2023-06-30 23:44:09] [config] n-best: false
[2023-06-30 23:44:09] [config] no-nccl: false
[2023-06-30 23:44:09] [config] no-reload: false
[2023-06-30 23:44:09] [config] no-restore-corpus: false
[2023-06-30 23:44:09] [config] normalize: 0
[2023-06-30 23:44:09] [config] normalize-gradient: false
[2023-06-30 23:44:09] [config] num-devices: 0
[2023-06-30 23:44:09] [config] optimizer: adam
[2023-06-30 23:44:09] [config] optimizer-delay: 1
[2023-06-30 23:44:09] [config] optimizer-params:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] output-omit-bias: false
[2023-06-30 23:44:09] [config] overwrite: true
[2023-06-30 23:44:09] [config] precision:
[2023-06-30 23:44:09] [config]   - float32
[2023-06-30 23:44:09] [config]   - float32
[2023-06-30 23:44:09] [config] pretrained-model: ""
[2023-06-30 23:44:09] [config] quantize-biases: false
[2023-06-30 23:44:09] [config] quantize-bits: 0
[2023-06-30 23:44:09] [config] quantize-log-based: false
[2023-06-30 23:44:09] [config] quantize-optimization-steps: 0
[2023-06-30 23:44:09] [config] quiet: false
[2023-06-30 23:44:09] [config] quiet-translation: true
[2023-06-30 23:44:09] [config] relative-paths: false
[2023-06-30 23:44:09] [config] right-left: false
[2023-06-30 23:44:09] [config] save-freq: 10000u
[2023-06-30 23:44:09] [config] seed: 1234
[2023-06-30 23:44:09] [config] sentencepiece-alphas:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] sentencepiece-max-lines: 2000000
[2023-06-30 23:44:09] [config] sentencepiece-options: ""
[2023-06-30 23:44:09] [config] sharding: global
[2023-06-30 23:44:09] [config] shuffle: data
[2023-06-30 23:44:09] [config] shuffle-in-ram: false
[2023-06-30 23:44:09] [config] sigterm: save-and-exit
[2023-06-30 23:44:09] [config] skip: false
[2023-06-30 23:44:09] [config] sqlite: ""
[2023-06-30 23:44:09] [config] sqlite-drop: false
[2023-06-30 23:44:09] [config] sync-freq: 200u
[2023-06-30 23:44:09] [config] sync-sgd: false
[2023-06-30 23:44:09] [config] tempdir: /tmp
[2023-06-30 23:44:09] [config] tied-embeddings: false
[2023-06-30 23:44:09] [config] tied-embeddings-all: false
[2023-06-30 23:44:09] [config] tied-embeddings-src: false
[2023-06-30 23:44:09] [config] train-embedder-rank:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] train-sets:
[2023-06-30 23:44:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-30 23:44:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-30 23:44:09] [config] transformer-aan-activation: swish
[2023-06-30 23:44:09] [config] transformer-aan-depth: 2
[2023-06-30 23:44:09] [config] transformer-aan-nogate: false
[2023-06-30 23:44:09] [config] transformer-decoder-autoreg: self-attention
[2023-06-30 23:44:09] [config] transformer-decoder-dim-ffn: 0
[2023-06-30 23:44:09] [config] transformer-decoder-ffn-depth: 0
[2023-06-30 23:44:09] [config] transformer-depth-scaling: false
[2023-06-30 23:44:09] [config] transformer-dim-aan: 2048
[2023-06-30 23:44:09] [config] transformer-dim-ffn: 2048
[2023-06-30 23:44:09] [config] transformer-dropout: 0
[2023-06-30 23:44:09] [config] transformer-dropout-attention: 0
[2023-06-30 23:44:09] [config] transformer-dropout-ffn: 0
[2023-06-30 23:44:09] [config] transformer-ffn-activation: swish
[2023-06-30 23:44:09] [config] transformer-ffn-depth: 2
[2023-06-30 23:44:09] [config] transformer-guided-alignment-layer: last
[2023-06-30 23:44:09] [config] transformer-heads: 8
[2023-06-30 23:44:09] [config] transformer-no-projection: false
[2023-06-30 23:44:09] [config] transformer-pool: false
[2023-06-30 23:44:09] [config] transformer-postprocess: dan
[2023-06-30 23:44:09] [config] transformer-postprocess-emb: d
[2023-06-30 23:44:09] [config] transformer-postprocess-top: ""
[2023-06-30 23:44:09] [config] transformer-preprocess: ""
[2023-06-30 23:44:09] [config] transformer-tied-layers:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] transformer-train-position-embeddings: false
[2023-06-30 23:44:09] [config] tsv: false
[2023-06-30 23:44:09] [config] tsv-fields: 0
[2023-06-30 23:44:09] [config] type: transformer
[2023-06-30 23:44:09] [config] ulr: false
[2023-06-30 23:44:09] [config] ulr-dim-emb: 0
[2023-06-30 23:44:09] [config] ulr-dropout: 0
[2023-06-30 23:44:09] [config] ulr-keys-vectors: ""
[2023-06-30 23:44:09] [config] ulr-query-vectors: ""
[2023-06-30 23:44:09] [config] ulr-softmax-temperature: 1
[2023-06-30 23:44:09] [config] ulr-trainable-transformation: false
[2023-06-30 23:44:09] [config] unlikelihood-loss: false
[2023-06-30 23:44:09] [config] valid-freq: 50000000
[2023-06-30 23:44:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_scored_june_transformer.log
[2023-06-30 23:44:09] [config] valid-max-length: 1000
[2023-06-30 23:44:09] [config] valid-metrics:
[2023-06-30 23:44:09] [config]   - cross-entropy
[2023-06-30 23:44:09] [config]   - translation
[2023-06-30 23:44:09] [config] valid-mini-batch: 32
[2023-06-30 23:44:09] [config] valid-reset-stalled: false
[2023-06-30 23:44:09] [config] valid-script-args:
[2023-06-30 23:44:09] [config]   []
[2023-06-30 23:44:09] [config] valid-script-path: ""
[2023-06-30 23:44:09] [config] valid-sets:
[2023-06-30 23:44:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-30 23:44:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-30 23:44:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-06-30 23:44:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:44:09] [config] vocabs:
[2023-06-30 23:44:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:44:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:44:09] [config] word-penalty: 0
[2023-06-30 23:44:09] [config] word-scores: false
[2023-06-30 23:44:09] [config] workspace: 2048
[2023-06-30 23:44:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-30 23:44:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:44:09] [training] Using single-device training
[2023-06-30 23:44:09] Synced seed 1234
[2023-06-30 23:44:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-30 23:44:09] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-30 23:44:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-30 23:44:09] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-30 23:44:09] [valid] No post-processing script given for validating translator
[2023-06-30 23:44:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-30 23:44:10] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-30 23:44:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-30 23:44:10] [comm] Using global sharding
[2023-06-30 23:44:10] [comm] NCCLCommunicators constructed successfully
[2023-06-30 23:44:10] [training] Using 1 GPUs
[2023-06-30 23:44:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz
[2023-06-30 23:44:11] Loading Adam parameters
[2023-06-30 23:44:12] [memory] Reserving 552 MB, device gpu0
[2023-06-30 23:44:12] [memory] Reserving 276 MB, device gpu0
[2023-06-30 23:44:12] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_transformer/gn_es_scored_june_transformer.npz.optimizer.npz
[2023-06-30 23:44:12] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-30 23:44:12] [data] Shuffling data
[2023-06-30 23:44:12] [data] Done reading 20,192 sentences
[2023-06-30 23:44:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-30 23:44:12] Training started
[2023-06-30 23:44:12] Training finished
