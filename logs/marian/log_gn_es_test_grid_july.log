[2023-07-03 18:49:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 18:49:53] [marian] Running on node19.datos.cluster.uy as process 29045 with command line:
[2023-07-03 18:49:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite
[2023-07-03 18:49:53] [config] after: 0e
[2023-07-03 18:49:53] [config] after-batches: 0
[2023-07-03 18:49:53] [config] after-epochs: 1
[2023-07-03 18:49:53] [config] all-caps-every: 0
[2023-07-03 18:49:53] [config] allow-unk: false
[2023-07-03 18:49:53] [config] authors: false
[2023-07-03 18:49:53] [config] beam-size: 12
[2023-07-03 18:49:53] [config] bert-class-symbol: "[CLS]"
[2023-07-03 18:49:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 18:49:53] [config] bert-masking-fraction: 0.15
[2023-07-03 18:49:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 18:49:53] [config] bert-train-type-embeddings: true
[2023-07-03 18:49:53] [config] bert-type-vocab-size: 2
[2023-07-03 18:49:53] [config] build-info: ""
[2023-07-03 18:49:53] [config] check-gradient-nan: false
[2023-07-03 18:49:53] [config] check-nan: false
[2023-07-03 18:49:53] [config] cite: false
[2023-07-03 18:49:53] [config] clip-norm: 1
[2023-07-03 18:49:53] [config] cost-scaling:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] cost-type: ce-sum
[2023-07-03 18:49:53] [config] cpu-threads: 0
[2023-07-03 18:49:53] [config] data-threads: 8
[2023-07-03 18:49:53] [config] data-weighting: ""
[2023-07-03 18:49:53] [config] data-weighting-type: sentence
[2023-07-03 18:49:53] [config] dec-cell: gru
[2023-07-03 18:49:53] [config] dec-cell-base-depth: 2
[2023-07-03 18:49:53] [config] dec-cell-high-depth: 1
[2023-07-03 18:49:53] [config] dec-depth: 1
[2023-07-03 18:49:53] [config] devices:
[2023-07-03 18:49:53] [config]   - 0
[2023-07-03 18:49:53] [config] dim-emb: 512
[2023-07-03 18:49:53] [config] dim-rnn: 1024
[2023-07-03 18:49:53] [config] dim-vocabs:
[2023-07-03 18:49:53] [config]   - 0
[2023-07-03 18:49:53] [config]   - 0
[2023-07-03 18:49:53] [config] disp-first: 0
[2023-07-03 18:49:53] [config] disp-freq: 1000u
[2023-07-03 18:49:53] [config] disp-label-counts: true
[2023-07-03 18:49:53] [config] dropout-rnn: 0
[2023-07-03 18:49:53] [config] dropout-src: 0
[2023-07-03 18:49:53] [config] dropout-trg: 0
[2023-07-03 18:49:53] [config] dump-config: ""
[2023-07-03 18:49:53] [config] dynamic-gradient-scaling:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] early-stopping: 10
[2023-07-03 18:49:53] [config] early-stopping-on: first
[2023-07-03 18:49:53] [config] embedding-fix-src: false
[2023-07-03 18:49:53] [config] embedding-fix-trg: false
[2023-07-03 18:49:53] [config] embedding-normalization: false
[2023-07-03 18:49:53] [config] embedding-vectors:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] enc-cell: gru
[2023-07-03 18:49:53] [config] enc-cell-depth: 1
[2023-07-03 18:49:53] [config] enc-depth: 1
[2023-07-03 18:49:53] [config] enc-type: bidirectional
[2023-07-03 18:49:53] [config] english-title-case-every: 0
[2023-07-03 18:49:53] [config] exponential-smoothing: 0
[2023-07-03 18:49:53] [config] factor-weight: 1
[2023-07-03 18:49:53] [config] factors-combine: sum
[2023-07-03 18:49:53] [config] factors-dim-emb: 0
[2023-07-03 18:49:53] [config] gradient-checkpointing: false
[2023-07-03 18:49:53] [config] gradient-norm-average-window: 100
[2023-07-03 18:49:53] [config] guided-alignment: none
[2023-07-03 18:49:53] [config] guided-alignment-cost: mse
[2023-07-03 18:49:53] [config] guided-alignment-weight: 0.1
[2023-07-03 18:49:53] [config] ignore-model-config: false
[2023-07-03 18:49:53] [config] input-types:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] interpolate-env-vars: false
[2023-07-03 18:49:53] [config] keep-best: false
[2023-07-03 18:49:53] [config] label-smoothing: 0
[2023-07-03 18:49:53] [config] layer-normalization: false
[2023-07-03 18:49:53] [config] learn-rate: 0.0001
[2023-07-03 18:49:53] [config] lemma-dependency: ""
[2023-07-03 18:49:53] [config] lemma-dim-emb: 0
[2023-07-03 18:49:53] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 18:49:53] [config] log-level: info
[2023-07-03 18:49:53] [config] log-time-zone: ""
[2023-07-03 18:49:53] [config] logical-epoch:
[2023-07-03 18:49:53] [config]   - 1e
[2023-07-03 18:49:53] [config]   - 0
[2023-07-03 18:49:53] [config] lr-decay: 0
[2023-07-03 18:49:53] [config] lr-decay-freq: 50000
[2023-07-03 18:49:53] [config] lr-decay-inv-sqrt:
[2023-07-03 18:49:53] [config]   - 0
[2023-07-03 18:49:53] [config] lr-decay-repeat-warmup: false
[2023-07-03 18:49:53] [config] lr-decay-reset-optimizer: false
[2023-07-03 18:49:53] [config] lr-decay-start:
[2023-07-03 18:49:53] [config]   - 10
[2023-07-03 18:49:53] [config]   - 1
[2023-07-03 18:49:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 18:49:53] [config] lr-report: false
[2023-07-03 18:49:53] [config] lr-warmup: 0
[2023-07-03 18:49:53] [config] lr-warmup-at-reload: false
[2023-07-03 18:49:53] [config] lr-warmup-cycle: false
[2023-07-03 18:49:53] [config] lr-warmup-start-rate: 0
[2023-07-03 18:49:53] [config] max-length: 50
[2023-07-03 18:49:53] [config] max-length-crop: false
[2023-07-03 18:49:53] [config] max-length-factor: 3
[2023-07-03 18:49:53] [config] maxi-batch: 100
[2023-07-03 18:49:53] [config] maxi-batch-sort: trg
[2023-07-03 18:49:53] [config] mini-batch: 64
[2023-07-03 18:49:53] [config] mini-batch-fit: false
[2023-07-03 18:49:53] [config] mini-batch-fit-step: 10
[2023-07-03 18:49:53] [config] mini-batch-round-up: true
[2023-07-03 18:49:53] [config] mini-batch-track-lr: false
[2023-07-03 18:49:53] [config] mini-batch-warmup: 0
[2023-07-03 18:49:53] [config] mini-batch-words: 0
[2023-07-03 18:49:53] [config] mini-batch-words-ref: 0
[2023-07-03 18:49:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz
[2023-07-03 18:49:53] [config] multi-loss-type: sum
[2023-07-03 18:49:53] [config] n-best: false
[2023-07-03 18:49:53] [config] no-nccl: false
[2023-07-03 18:49:53] [config] no-reload: false
[2023-07-03 18:49:53] [config] no-restore-corpus: false
[2023-07-03 18:49:53] [config] normalize: 0
[2023-07-03 18:49:53] [config] normalize-gradient: false
[2023-07-03 18:49:53] [config] num-devices: 0
[2023-07-03 18:49:53] [config] optimizer: adam
[2023-07-03 18:49:53] [config] optimizer-delay: 1
[2023-07-03 18:49:53] [config] optimizer-params:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] output-omit-bias: false
[2023-07-03 18:49:53] [config] overwrite: true
[2023-07-03 18:49:53] [config] precision:
[2023-07-03 18:49:53] [config]   - float32
[2023-07-03 18:49:53] [config]   - float32
[2023-07-03 18:49:53] [config] pretrained-model: ""
[2023-07-03 18:49:53] [config] quantize-biases: false
[2023-07-03 18:49:53] [config] quantize-bits: 0
[2023-07-03 18:49:53] [config] quantize-log-based: false
[2023-07-03 18:49:53] [config] quantize-optimization-steps: 0
[2023-07-03 18:49:53] [config] quiet: false
[2023-07-03 18:49:53] [config] quiet-translation: true
[2023-07-03 18:49:53] [config] relative-paths: false
[2023-07-03 18:49:53] [config] right-left: false
[2023-07-03 18:49:53] [config] save-freq: 10000u
[2023-07-03 18:49:53] [config] seed: 1234
[2023-07-03 18:49:53] [config] sentencepiece-alphas:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] sentencepiece-max-lines: 2000000
[2023-07-03 18:49:53] [config] sentencepiece-options: ""
[2023-07-03 18:49:53] [config] sharding: global
[2023-07-03 18:49:53] [config] shuffle: data
[2023-07-03 18:49:53] [config] shuffle-in-ram: false
[2023-07-03 18:49:53] [config] sigterm: save-and-exit
[2023-07-03 18:49:53] [config] skip: false
[2023-07-03 18:49:53] [config] sqlite: ""
[2023-07-03 18:49:53] [config] sqlite-drop: false
[2023-07-03 18:49:53] [config] sync-freq: 200u
[2023-07-03 18:49:53] [config] sync-sgd: false
[2023-07-03 18:49:53] [config] tempdir: /tmp
[2023-07-03 18:49:53] [config] tied-embeddings: false
[2023-07-03 18:49:53] [config] tied-embeddings-all: false
[2023-07-03 18:49:53] [config] tied-embeddings-src: false
[2023-07-03 18:49:53] [config] train-embedder-rank:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] train-sets:
[2023-07-03 18:49:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 18:49:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 18:49:53] [config] transformer-aan-activation: swish
[2023-07-03 18:49:53] [config] transformer-aan-depth: 2
[2023-07-03 18:49:53] [config] transformer-aan-nogate: false
[2023-07-03 18:49:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 18:49:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 18:49:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 18:49:53] [config] transformer-depth-scaling: false
[2023-07-03 18:49:53] [config] transformer-dim-aan: 2048
[2023-07-03 18:49:53] [config] transformer-dim-ffn: 2048
[2023-07-03 18:49:53] [config] transformer-dropout: 0
[2023-07-03 18:49:53] [config] transformer-dropout-attention: 0
[2023-07-03 18:49:53] [config] transformer-dropout-ffn: 0
[2023-07-03 18:49:53] [config] transformer-ffn-activation: swish
[2023-07-03 18:49:53] [config] transformer-ffn-depth: 2
[2023-07-03 18:49:53] [config] transformer-guided-alignment-layer: last
[2023-07-03 18:49:53] [config] transformer-heads: 8
[2023-07-03 18:49:53] [config] transformer-no-projection: false
[2023-07-03 18:49:53] [config] transformer-pool: false
[2023-07-03 18:49:53] [config] transformer-postprocess: dan
[2023-07-03 18:49:53] [config] transformer-postprocess-emb: d
[2023-07-03 18:49:53] [config] transformer-postprocess-top: ""
[2023-07-03 18:49:53] [config] transformer-preprocess: ""
[2023-07-03 18:49:53] [config] transformer-tied-layers:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] transformer-train-position-embeddings: false
[2023-07-03 18:49:53] [config] tsv: false
[2023-07-03 18:49:53] [config] tsv-fields: 0
[2023-07-03 18:49:53] [config] type: amun
[2023-07-03 18:49:53] [config] ulr: false
[2023-07-03 18:49:53] [config] ulr-dim-emb: 0
[2023-07-03 18:49:53] [config] ulr-dropout: 0
[2023-07-03 18:49:53] [config] ulr-keys-vectors: ""
[2023-07-03 18:49:53] [config] ulr-query-vectors: ""
[2023-07-03 18:49:53] [config] ulr-softmax-temperature: 1
[2023-07-03 18:49:53] [config] ulr-trainable-transformation: false
[2023-07-03 18:49:53] [config] unlikelihood-loss: false
[2023-07-03 18:49:53] [config] valid-freq: 50000000
[2023-07-03 18:49:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 18:49:53] [config] valid-max-length: 1000
[2023-07-03 18:49:53] [config] valid-metrics:
[2023-07-03 18:49:53] [config]   - cross-entropy
[2023-07-03 18:49:53] [config]   - translation
[2023-07-03 18:49:53] [config] valid-mini-batch: 32
[2023-07-03 18:49:53] [config] valid-reset-stalled: false
[2023-07-03 18:49:53] [config] valid-script-args:
[2023-07-03 18:49:53] [config]   []
[2023-07-03 18:49:53] [config] valid-script-path: ""
[2023-07-03 18:49:53] [config] valid-sets:
[2023-07-03 18:49:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 18:49:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 18:49:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 18:49:53] [config] vocabs:
[2023-07-03 18:49:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 18:49:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 18:49:53] [config] word-penalty: 0
[2023-07-03 18:49:53] [config] word-scores: false
[2023-07-03 18:49:53] [config] workspace: 2048
[2023-07-03 18:49:53] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 18:49:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 18:49:53] [training] Using single-device training
[2023-07-03 18:49:54] Synced seed 1234
[2023-07-03 18:49:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 18:49:54] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 18:49:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 18:49:54] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 18:49:54] [valid] No post-processing script given for validating translator
[2023-07-03 18:49:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 18:49:56] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 18:49:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 18:49:56] [comm] Using global sharding
[2023-07-03 18:49:56] [comm] NCCLCommunicators constructed successfully
[2023-07-03 18:49:56] [training] Using 1 GPUs
[2023-07-03 18:49:56] Training started
[2023-07-03 18:49:56] [data] Shuffling data
[2023-07-03 18:49:56] [data] Done reading 20,192 sentences
[2023-07-03 18:49:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 18:49:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 18:49:57] [logits] Applying loss function for 1 factor(s)
[2023-07-03 18:49:57] [memory] Reserving 377 MB, device gpu0
[2023-07-03 18:50:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 18:50:00] [memory] Reserving 377 MB, device gpu0
[2023-07-03 18:50:00] Parameter type float32, optimization type float32, casting types false
[2023-07-03 18:50:00] Allocating memory for Adam-specific shards
[2023-07-03 18:50:00] [memory] Reserving 754 MB, device gpu0
[2023-07-03 18:50:39] Seen 18,843 samples
[2023-07-03 18:50:39] Starting data epoch 2 in logical epoch 2
[2023-07-03 18:50:39] Training finished
[2023-07-03 18:50:45] [valid] Ep. 2 : Up. 297 : cross-entropy : 128.187 : new best
[2023-07-03 18:52:24] [valid] Ep. 2 : Up. 297 : translation : 0 : new best
[2023-07-03 18:52:24] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz
[2023-07-03 18:52:27] Saving Adam parameters
[2023-07-03 18:52:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz.optimizer.npz
[2023-07-03 18:52:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 18:52:43] [marian] Running on node19.datos.cluster.uy as process 29418 with command line:
[2023-07-03 18:52:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite
[2023-07-03 18:52:43] [config] after: 0e
[2023-07-03 18:52:43] [config] after-batches: 0
[2023-07-03 18:52:43] [config] after-epochs: 2
[2023-07-03 18:52:43] [config] all-caps-every: 0
[2023-07-03 18:52:43] [config] allow-unk: false
[2023-07-03 18:52:43] [config] authors: false
[2023-07-03 18:52:43] [config] beam-size: 12
[2023-07-03 18:52:43] [config] bert-class-symbol: "[CLS]"
[2023-07-03 18:52:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 18:52:43] [config] bert-masking-fraction: 0.15
[2023-07-03 18:52:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 18:52:43] [config] bert-train-type-embeddings: true
[2023-07-03 18:52:43] [config] bert-type-vocab-size: 2
[2023-07-03 18:52:43] [config] build-info: ""
[2023-07-03 18:52:43] [config] check-gradient-nan: false
[2023-07-03 18:52:43] [config] check-nan: false
[2023-07-03 18:52:43] [config] cite: false
[2023-07-03 18:52:43] [config] clip-norm: 1
[2023-07-03 18:52:43] [config] cost-scaling:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] cost-type: ce-sum
[2023-07-03 18:52:43] [config] cpu-threads: 0
[2023-07-03 18:52:43] [config] data-threads: 8
[2023-07-03 18:52:43] [config] data-weighting: ""
[2023-07-03 18:52:43] [config] data-weighting-type: sentence
[2023-07-03 18:52:43] [config] dec-cell: gru
[2023-07-03 18:52:43] [config] dec-cell-base-depth: 2
[2023-07-03 18:52:43] [config] dec-cell-high-depth: 1
[2023-07-03 18:52:43] [config] dec-depth: 1
[2023-07-03 18:52:43] [config] devices:
[2023-07-03 18:52:43] [config]   - 0
[2023-07-03 18:52:43] [config] dim-emb: 512
[2023-07-03 18:52:43] [config] dim-rnn: 1024
[2023-07-03 18:52:43] [config] dim-vocabs:
[2023-07-03 18:52:43] [config]   - 54042
[2023-07-03 18:52:43] [config]   - 36507
[2023-07-03 18:52:43] [config] disp-first: 0
[2023-07-03 18:52:43] [config] disp-freq: 1000u
[2023-07-03 18:52:43] [config] disp-label-counts: true
[2023-07-03 18:52:43] [config] dropout-rnn: 0
[2023-07-03 18:52:43] [config] dropout-src: 0
[2023-07-03 18:52:43] [config] dropout-trg: 0
[2023-07-03 18:52:43] [config] dump-config: ""
[2023-07-03 18:52:43] [config] dynamic-gradient-scaling:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] early-stopping: 10
[2023-07-03 18:52:43] [config] early-stopping-on: first
[2023-07-03 18:52:43] [config] embedding-fix-src: false
[2023-07-03 18:52:43] [config] embedding-fix-trg: false
[2023-07-03 18:52:43] [config] embedding-normalization: false
[2023-07-03 18:52:43] [config] embedding-vectors:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] enc-cell: gru
[2023-07-03 18:52:43] [config] enc-cell-depth: 1
[2023-07-03 18:52:43] [config] enc-depth: 1
[2023-07-03 18:52:43] [config] enc-type: bidirectional
[2023-07-03 18:52:43] [config] english-title-case-every: 0
[2023-07-03 18:52:43] [config] exponential-smoothing: 0
[2023-07-03 18:52:43] [config] factor-weight: 1
[2023-07-03 18:52:43] [config] factors-combine: sum
[2023-07-03 18:52:43] [config] factors-dim-emb: 0
[2023-07-03 18:52:43] [config] gradient-checkpointing: false
[2023-07-03 18:52:43] [config] gradient-norm-average-window: 100
[2023-07-03 18:52:43] [config] guided-alignment: none
[2023-07-03 18:52:43] [config] guided-alignment-cost: mse
[2023-07-03 18:52:43] [config] guided-alignment-weight: 0.1
[2023-07-03 18:52:43] [config] ignore-model-config: false
[2023-07-03 18:52:43] [config] input-types:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] interpolate-env-vars: false
[2023-07-03 18:52:43] [config] keep-best: false
[2023-07-03 18:52:43] [config] label-smoothing: 0
[2023-07-03 18:52:43] [config] layer-normalization: false
[2023-07-03 18:52:43] [config] learn-rate: 0.0001
[2023-07-03 18:52:43] [config] lemma-dependency: ""
[2023-07-03 18:52:43] [config] lemma-dim-emb: 0
[2023-07-03 18:52:43] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 18:52:43] [config] log-level: info
[2023-07-03 18:52:43] [config] log-time-zone: ""
[2023-07-03 18:52:43] [config] logical-epoch:
[2023-07-03 18:52:43] [config]   - 1e
[2023-07-03 18:52:43] [config]   - 0
[2023-07-03 18:52:43] [config] lr-decay: 0
[2023-07-03 18:52:43] [config] lr-decay-freq: 50000
[2023-07-03 18:52:43] [config] lr-decay-inv-sqrt:
[2023-07-03 18:52:43] [config]   - 0
[2023-07-03 18:52:43] [config] lr-decay-repeat-warmup: false
[2023-07-03 18:52:43] [config] lr-decay-reset-optimizer: false
[2023-07-03 18:52:43] [config] lr-decay-start:
[2023-07-03 18:52:43] [config]   - 10
[2023-07-03 18:52:43] [config]   - 1
[2023-07-03 18:52:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 18:52:43] [config] lr-report: false
[2023-07-03 18:52:43] [config] lr-warmup: 0
[2023-07-03 18:52:43] [config] lr-warmup-at-reload: false
[2023-07-03 18:52:43] [config] lr-warmup-cycle: false
[2023-07-03 18:52:43] [config] lr-warmup-start-rate: 0
[2023-07-03 18:52:43] [config] max-length: 50
[2023-07-03 18:52:43] [config] max-length-crop: false
[2023-07-03 18:52:43] [config] max-length-factor: 3
[2023-07-03 18:52:43] [config] maxi-batch: 100
[2023-07-03 18:52:43] [config] maxi-batch-sort: trg
[2023-07-03 18:52:43] [config] mini-batch: 64
[2023-07-03 18:52:43] [config] mini-batch-fit: false
[2023-07-03 18:52:43] [config] mini-batch-fit-step: 10
[2023-07-03 18:52:43] [config] mini-batch-round-up: true
[2023-07-03 18:52:43] [config] mini-batch-track-lr: false
[2023-07-03 18:52:43] [config] mini-batch-warmup: 0
[2023-07-03 18:52:43] [config] mini-batch-words: 0
[2023-07-03 18:52:43] [config] mini-batch-words-ref: 0
[2023-07-03 18:52:43] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz
[2023-07-03 18:52:43] [config] multi-loss-type: sum
[2023-07-03 18:52:43] [config] n-best: false
[2023-07-03 18:52:43] [config] no-nccl: false
[2023-07-03 18:52:43] [config] no-reload: false
[2023-07-03 18:52:43] [config] no-restore-corpus: false
[2023-07-03 18:52:43] [config] normalize: 0
[2023-07-03 18:52:43] [config] normalize-gradient: false
[2023-07-03 18:52:43] [config] num-devices: 0
[2023-07-03 18:52:43] [config] optimizer: adam
[2023-07-03 18:52:43] [config] optimizer-delay: 1
[2023-07-03 18:52:43] [config] optimizer-params:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] output-omit-bias: false
[2023-07-03 18:52:43] [config] overwrite: true
[2023-07-03 18:52:43] [config] precision:
[2023-07-03 18:52:43] [config]   - float32
[2023-07-03 18:52:43] [config]   - float32
[2023-07-03 18:52:43] [config] pretrained-model: ""
[2023-07-03 18:52:43] [config] quantize-biases: false
[2023-07-03 18:52:43] [config] quantize-bits: 0
[2023-07-03 18:52:43] [config] quantize-log-based: false
[2023-07-03 18:52:43] [config] quantize-optimization-steps: 0
[2023-07-03 18:52:43] [config] quiet: false
[2023-07-03 18:52:43] [config] quiet-translation: true
[2023-07-03 18:52:43] [config] relative-paths: false
[2023-07-03 18:52:43] [config] right-left: false
[2023-07-03 18:52:43] [config] save-freq: 10000u
[2023-07-03 18:52:43] [config] seed: 1234
[2023-07-03 18:52:43] [config] sentencepiece-alphas:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] sentencepiece-max-lines: 2000000
[2023-07-03 18:52:43] [config] sentencepiece-options: ""
[2023-07-03 18:52:43] [config] sharding: global
[2023-07-03 18:52:43] [config] shuffle: data
[2023-07-03 18:52:43] [config] shuffle-in-ram: false
[2023-07-03 18:52:43] [config] sigterm: save-and-exit
[2023-07-03 18:52:43] [config] skip: false
[2023-07-03 18:52:43] [config] sqlite: ""
[2023-07-03 18:52:43] [config] sqlite-drop: false
[2023-07-03 18:52:43] [config] sync-freq: 200u
[2023-07-03 18:52:43] [config] sync-sgd: false
[2023-07-03 18:52:43] [config] tempdir: /tmp
[2023-07-03 18:52:43] [config] tied-embeddings: false
[2023-07-03 18:52:43] [config] tied-embeddings-all: false
[2023-07-03 18:52:43] [config] tied-embeddings-src: false
[2023-07-03 18:52:43] [config] train-embedder-rank:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] train-sets:
[2023-07-03 18:52:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 18:52:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 18:52:43] [config] transformer-aan-activation: swish
[2023-07-03 18:52:43] [config] transformer-aan-depth: 2
[2023-07-03 18:52:43] [config] transformer-aan-nogate: false
[2023-07-03 18:52:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 18:52:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 18:52:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 18:52:43] [config] transformer-depth-scaling: false
[2023-07-03 18:52:43] [config] transformer-dim-aan: 2048
[2023-07-03 18:52:43] [config] transformer-dim-ffn: 2048
[2023-07-03 18:52:43] [config] transformer-dropout: 0
[2023-07-03 18:52:43] [config] transformer-dropout-attention: 0
[2023-07-03 18:52:43] [config] transformer-dropout-ffn: 0
[2023-07-03 18:52:43] [config] transformer-ffn-activation: swish
[2023-07-03 18:52:43] [config] transformer-ffn-depth: 2
[2023-07-03 18:52:43] [config] transformer-guided-alignment-layer: last
[2023-07-03 18:52:43] [config] transformer-heads: 8
[2023-07-03 18:52:43] [config] transformer-no-projection: false
[2023-07-03 18:52:43] [config] transformer-pool: false
[2023-07-03 18:52:43] [config] transformer-postprocess: dan
[2023-07-03 18:52:43] [config] transformer-postprocess-emb: d
[2023-07-03 18:52:43] [config] transformer-postprocess-top: ""
[2023-07-03 18:52:43] [config] transformer-preprocess: ""
[2023-07-03 18:52:43] [config] transformer-tied-layers:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] transformer-train-position-embeddings: false
[2023-07-03 18:52:43] [config] tsv: false
[2023-07-03 18:52:43] [config] tsv-fields: 0
[2023-07-03 18:52:43] [config] type: amun
[2023-07-03 18:52:43] [config] ulr: false
[2023-07-03 18:52:43] [config] ulr-dim-emb: 0
[2023-07-03 18:52:43] [config] ulr-dropout: 0
[2023-07-03 18:52:43] [config] ulr-keys-vectors: ""
[2023-07-03 18:52:43] [config] ulr-query-vectors: ""
[2023-07-03 18:52:43] [config] ulr-softmax-temperature: 1
[2023-07-03 18:52:43] [config] ulr-trainable-transformation: false
[2023-07-03 18:52:43] [config] unlikelihood-loss: false
[2023-07-03 18:52:43] [config] valid-freq: 50000000
[2023-07-03 18:52:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 18:52:43] [config] valid-max-length: 1000
[2023-07-03 18:52:43] [config] valid-metrics:
[2023-07-03 18:52:43] [config]   - cross-entropy
[2023-07-03 18:52:43] [config]   - translation
[2023-07-03 18:52:43] [config] valid-mini-batch: 32
[2023-07-03 18:52:43] [config] valid-reset-stalled: false
[2023-07-03 18:52:43] [config] valid-script-args:
[2023-07-03 18:52:43] [config]   []
[2023-07-03 18:52:43] [config] valid-script-path: ""
[2023-07-03 18:52:43] [config] valid-sets:
[2023-07-03 18:52:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 18:52:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 18:52:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 18:52:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 18:52:43] [config] vocabs:
[2023-07-03 18:52:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 18:52:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 18:52:43] [config] word-penalty: 0
[2023-07-03 18:52:43] [config] word-scores: false
[2023-07-03 18:52:43] [config] workspace: 2048
[2023-07-03 18:52:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 18:52:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 18:52:43] [training] Using single-device training
[2023-07-03 18:52:43] Synced seed 1234
[2023-07-03 18:52:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 18:52:44] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 18:52:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 18:52:44] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 18:52:44] [valid] No post-processing script given for validating translator
[2023-07-03 18:52:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 18:52:44] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 18:52:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 18:52:45] [comm] Using global sharding
[2023-07-03 18:52:45] [comm] NCCLCommunicators constructed successfully
[2023-07-03 18:52:45] [training] Using 1 GPUs
[2023-07-03 18:52:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz
[2023-07-03 18:52:47] Loading Adam parameters
[2023-07-03 18:52:48] [memory] Reserving 754 MB, device gpu0
[2023-07-03 18:52:48] [memory] Reserving 377 MB, device gpu0
[2023-07-03 18:52:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz.optimizer.npz
[2023-07-03 18:52:48] [data] Restoring the corpus state to epoch 2, batch 297
[2023-07-03 18:52:48] [data] Shuffling data
[2023-07-03 18:52:48] [data] Done reading 20,192 sentences
[2023-07-03 18:52:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 18:52:48] Training started
[2023-07-03 18:52:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 18:52:48] [logits] Applying loss function for 1 factor(s)
[2023-07-03 18:52:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 18:52:48] [memory] Reserving 377 MB, device gpu0
[2023-07-03 18:52:49] Parameter type float32, optimization type float32, casting types false
[2023-07-03 18:53:27] Seen 18,843 samples
[2023-07-03 18:53:27] Starting data epoch 3 in logical epoch 3
[2023-07-03 18:53:27] Training finished
[2023-07-03 18:53:33] [valid] Ep. 3 : Up. 594 : cross-entropy : 122.183 : new best
[2023-07-03 18:55:21] [valid] Ep. 3 : Up. 594 : translation : 0 : new best
[2023-07-03 18:55:21] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz
[2023-07-03 18:55:24] Saving Adam parameters
[2023-07-03 18:55:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july.npz.optimizer.npz
[2023-07-03 21:46:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 21:46:10] [marian] Running on node19.datos.cluster.uy as process 8447 with command line:
[2023-07-03 21:46:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-03 21:46:10] [config] after: 0e
[2023-07-03 21:46:10] [config] after-batches: 0
[2023-07-03 21:46:10] [config] after-epochs: 1
[2023-07-03 21:46:10] [config] all-caps-every: 0
[2023-07-03 21:46:10] [config] allow-unk: false
[2023-07-03 21:46:10] [config] authors: false
[2023-07-03 21:46:10] [config] beam-size: 12
[2023-07-03 21:46:10] [config] bert-class-symbol: "[CLS]"
[2023-07-03 21:46:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 21:46:10] [config] bert-masking-fraction: 0.15
[2023-07-03 21:46:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 21:46:10] [config] bert-train-type-embeddings: true
[2023-07-03 21:46:10] [config] bert-type-vocab-size: 2
[2023-07-03 21:46:10] [config] build-info: ""
[2023-07-03 21:46:10] [config] check-gradient-nan: false
[2023-07-03 21:46:10] [config] check-nan: false
[2023-07-03 21:46:10] [config] cite: false
[2023-07-03 21:46:10] [config] clip-norm: 1
[2023-07-03 21:46:10] [config] cost-scaling:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] cost-type: ce-sum
[2023-07-03 21:46:10] [config] cpu-threads: 0
[2023-07-03 21:46:10] [config] data-threads: 8
[2023-07-03 21:46:10] [config] data-weighting: ""
[2023-07-03 21:46:10] [config] data-weighting-type: sentence
[2023-07-03 21:46:10] [config] dec-cell: gru
[2023-07-03 21:46:10] [config] dec-cell-base-depth: 2
[2023-07-03 21:46:10] [config] dec-cell-high-depth: 1
[2023-07-03 21:46:10] [config] dec-depth: 1
[2023-07-03 21:46:10] [config] devices:
[2023-07-03 21:46:10] [config]   - 0
[2023-07-03 21:46:10] [config] dim-emb: 512
[2023-07-03 21:46:10] [config] dim-rnn: 1024
[2023-07-03 21:46:10] [config] dim-vocabs:
[2023-07-03 21:46:10] [config]   - 0
[2023-07-03 21:46:10] [config]   - 0
[2023-07-03 21:46:10] [config] disp-first: 0
[2023-07-03 21:46:10] [config] disp-freq: 1000u
[2023-07-03 21:46:10] [config] disp-label-counts: true
[2023-07-03 21:46:10] [config] dropout-rnn: 0
[2023-07-03 21:46:10] [config] dropout-src: 0
[2023-07-03 21:46:10] [config] dropout-trg: 0
[2023-07-03 21:46:10] [config] dump-config: ""
[2023-07-03 21:46:10] [config] dynamic-gradient-scaling:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] early-stopping: 10
[2023-07-03 21:46:10] [config] early-stopping-on: first
[2023-07-03 21:46:10] [config] embedding-fix-src: false
[2023-07-03 21:46:10] [config] embedding-fix-trg: false
[2023-07-03 21:46:10] [config] embedding-normalization: false
[2023-07-03 21:46:10] [config] embedding-vectors:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] enc-cell: gru
[2023-07-03 21:46:10] [config] enc-cell-depth: 1
[2023-07-03 21:46:10] [config] enc-depth: 1
[2023-07-03 21:46:10] [config] enc-type: bidirectional
[2023-07-03 21:46:10] [config] english-title-case-every: 0
[2023-07-03 21:46:10] [config] exponential-smoothing: 0
[2023-07-03 21:46:10] [config] factor-weight: 1
[2023-07-03 21:46:10] [config] factors-combine: sum
[2023-07-03 21:46:10] [config] factors-dim-emb: 0
[2023-07-03 21:46:10] [config] gradient-checkpointing: false
[2023-07-03 21:46:10] [config] gradient-norm-average-window: 100
[2023-07-03 21:46:10] [config] guided-alignment: none
[2023-07-03 21:46:10] [config] guided-alignment-cost: mse
[2023-07-03 21:46:10] [config] guided-alignment-weight: 0.1
[2023-07-03 21:46:10] [config] ignore-model-config: false
[2023-07-03 21:46:10] [config] input-types:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] interpolate-env-vars: false
[2023-07-03 21:46:10] [config] keep-best: false
[2023-07-03 21:46:10] [config] label-smoothing: 0
[2023-07-03 21:46:10] [config] layer-normalization: false
[2023-07-03 21:46:10] [config] learn-rate: 0.0001
[2023-07-03 21:46:10] [config] lemma-dependency: ""
[2023-07-03 21:46:10] [config] lemma-dim-emb: 0
[2023-07-03 21:46:10] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 21:46:10] [config] log-level: info
[2023-07-03 21:46:10] [config] log-time-zone: ""
[2023-07-03 21:46:10] [config] logical-epoch:
[2023-07-03 21:46:10] [config]   - 1e
[2023-07-03 21:46:10] [config]   - 0
[2023-07-03 21:46:10] [config] lr-decay: 0
[2023-07-03 21:46:10] [config] lr-decay-freq: 50000
[2023-07-03 21:46:10] [config] lr-decay-inv-sqrt:
[2023-07-03 21:46:10] [config]   - 0
[2023-07-03 21:46:10] [config] lr-decay-repeat-warmup: false
[2023-07-03 21:46:10] [config] lr-decay-reset-optimizer: false
[2023-07-03 21:46:10] [config] lr-decay-start:
[2023-07-03 21:46:10] [config]   - 10
[2023-07-03 21:46:10] [config]   - 1
[2023-07-03 21:46:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 21:46:10] [config] lr-report: false
[2023-07-03 21:46:10] [config] lr-warmup: 0
[2023-07-03 21:46:10] [config] lr-warmup-at-reload: false
[2023-07-03 21:46:10] [config] lr-warmup-cycle: false
[2023-07-03 21:46:10] [config] lr-warmup-start-rate: 0
[2023-07-03 21:46:10] [config] max-length: 50
[2023-07-03 21:46:10] [config] max-length-crop: false
[2023-07-03 21:46:10] [config] max-length-factor: 3
[2023-07-03 21:46:10] [config] maxi-batch: 100
[2023-07-03 21:46:10] [config] maxi-batch-sort: trg
[2023-07-03 21:46:10] [config] mini-batch: 64
[2023-07-03 21:46:10] [config] mini-batch-fit: false
[2023-07-03 21:46:10] [config] mini-batch-fit-step: 10
[2023-07-03 21:46:10] [config] mini-batch-round-up: true
[2023-07-03 21:46:10] [config] mini-batch-track-lr: false
[2023-07-03 21:46:10] [config] mini-batch-warmup: 0
[2023-07-03 21:46:10] [config] mini-batch-words: 0
[2023-07-03 21:46:10] [config] mini-batch-words-ref: 0
[2023-07-03 21:46:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 21:46:10] [config] multi-loss-type: sum
[2023-07-03 21:46:10] [config] n-best: false
[2023-07-03 21:46:10] [config] no-nccl: false
[2023-07-03 21:46:10] [config] no-reload: false
[2023-07-03 21:46:10] [config] no-restore-corpus: false
[2023-07-03 21:46:10] [config] normalize: 0
[2023-07-03 21:46:10] [config] normalize-gradient: false
[2023-07-03 21:46:10] [config] num-devices: 0
[2023-07-03 21:46:10] [config] optimizer: adam
[2023-07-03 21:46:10] [config] optimizer-delay: 1
[2023-07-03 21:46:10] [config] optimizer-params:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] output-omit-bias: false
[2023-07-03 21:46:10] [config] overwrite: true
[2023-07-03 21:46:10] [config] precision:
[2023-07-03 21:46:10] [config]   - float32
[2023-07-03 21:46:10] [config]   - float32
[2023-07-03 21:46:10] [config] pretrained-model: ""
[2023-07-03 21:46:10] [config] quantize-biases: false
[2023-07-03 21:46:10] [config] quantize-bits: 0
[2023-07-03 21:46:10] [config] quantize-log-based: false
[2023-07-03 21:46:10] [config] quantize-optimization-steps: 0
[2023-07-03 21:46:10] [config] quiet: false
[2023-07-03 21:46:10] [config] quiet-translation: true
[2023-07-03 21:46:10] [config] relative-paths: false
[2023-07-03 21:46:10] [config] right-left: false
[2023-07-03 21:46:10] [config] save-freq: 10000u
[2023-07-03 21:46:10] [config] seed: 1234
[2023-07-03 21:46:10] [config] sentencepiece-alphas:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] sentencepiece-max-lines: 2000000
[2023-07-03 21:46:10] [config] sentencepiece-options: ""
[2023-07-03 21:46:10] [config] sharding: global
[2023-07-03 21:46:10] [config] shuffle: data
[2023-07-03 21:46:10] [config] shuffle-in-ram: false
[2023-07-03 21:46:10] [config] sigterm: save-and-exit
[2023-07-03 21:46:10] [config] skip: false
[2023-07-03 21:46:10] [config] sqlite: ""
[2023-07-03 21:46:10] [config] sqlite-drop: false
[2023-07-03 21:46:10] [config] sync-freq: 200u
[2023-07-03 21:46:10] [config] sync-sgd: false
[2023-07-03 21:46:10] [config] tempdir: /tmp
[2023-07-03 21:46:10] [config] tied-embeddings: false
[2023-07-03 21:46:10] [config] tied-embeddings-all: false
[2023-07-03 21:46:10] [config] tied-embeddings-src: false
[2023-07-03 21:46:10] [config] train-embedder-rank:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] train-sets:
[2023-07-03 21:46:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 21:46:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 21:46:10] [config] transformer-aan-activation: swish
[2023-07-03 21:46:10] [config] transformer-aan-depth: 2
[2023-07-03 21:46:10] [config] transformer-aan-nogate: false
[2023-07-03 21:46:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 21:46:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 21:46:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 21:46:10] [config] transformer-depth-scaling: false
[2023-07-03 21:46:10] [config] transformer-dim-aan: 2048
[2023-07-03 21:46:10] [config] transformer-dim-ffn: 2048
[2023-07-03 21:46:10] [config] transformer-dropout: 0
[2023-07-03 21:46:10] [config] transformer-dropout-attention: 0
[2023-07-03 21:46:10] [config] transformer-dropout-ffn: 0
[2023-07-03 21:46:10] [config] transformer-ffn-activation: swish
[2023-07-03 21:46:10] [config] transformer-ffn-depth: 2
[2023-07-03 21:46:10] [config] transformer-guided-alignment-layer: last
[2023-07-03 21:46:10] [config] transformer-heads: 8
[2023-07-03 21:46:10] [config] transformer-no-projection: false
[2023-07-03 21:46:10] [config] transformer-pool: false
[2023-07-03 21:46:10] [config] transformer-postprocess: dan
[2023-07-03 21:46:10] [config] transformer-postprocess-emb: d
[2023-07-03 21:46:10] [config] transformer-postprocess-top: ""
[2023-07-03 21:46:10] [config] transformer-preprocess: ""
[2023-07-03 21:46:10] [config] transformer-tied-layers:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] transformer-train-position-embeddings: false
[2023-07-03 21:46:10] [config] tsv: false
[2023-07-03 21:46:10] [config] tsv-fields: 0
[2023-07-03 21:46:10] [config] type: amun
[2023-07-03 21:46:10] [config] ulr: false
[2023-07-03 21:46:10] [config] ulr-dim-emb: 0
[2023-07-03 21:46:10] [config] ulr-dropout: 0
[2023-07-03 21:46:10] [config] ulr-keys-vectors: ""
[2023-07-03 21:46:10] [config] ulr-query-vectors: ""
[2023-07-03 21:46:10] [config] ulr-softmax-temperature: 1
[2023-07-03 21:46:10] [config] ulr-trainable-transformation: false
[2023-07-03 21:46:10] [config] unlikelihood-loss: false
[2023-07-03 21:46:10] [config] valid-freq: 50000000
[2023-07-03 21:46:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 21:46:10] [config] valid-max-length: 1000
[2023-07-03 21:46:10] [config] valid-metrics:
[2023-07-03 21:46:10] [config]   - cross-entropy
[2023-07-03 21:46:10] [config]   - translation
[2023-07-03 21:46:10] [config] valid-mini-batch: 32
[2023-07-03 21:46:10] [config] valid-reset-stalled: false
[2023-07-03 21:46:10] [config] valid-script-args:
[2023-07-03 21:46:10] [config]   []
[2023-07-03 21:46:10] [config] valid-script-path: ""
[2023-07-03 21:46:10] [config] valid-sets:
[2023-07-03 21:46:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 21:46:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 21:46:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 21:46:10] [config] vocabs:
[2023-07-03 21:46:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 21:46:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 21:46:10] [config] word-penalty: 0
[2023-07-03 21:46:10] [config] word-scores: false
[2023-07-03 21:46:10] [config] workspace: 2048
[2023-07-03 21:46:10] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 21:46:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 21:46:10] [training] Using single-device training
[2023-07-03 21:46:12] Synced seed 1234
[2023-07-03 21:46:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 21:46:12] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 21:46:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 21:46:12] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 21:46:12] [valid] No post-processing script given for validating translator
[2023-07-03 21:46:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 21:46:13] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 21:46:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 21:46:14] [comm] Using global sharding
[2023-07-03 21:46:14] [comm] NCCLCommunicators constructed successfully
[2023-07-03 21:46:14] [training] Using 1 GPUs
[2023-07-03 21:46:14] Training started
[2023-07-03 21:46:14] [data] Shuffling data
[2023-07-03 21:46:14] [data] Done reading 20,192 sentences
[2023-07-03 21:46:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 21:46:14] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 21:46:14] [logits] Applying loss function for 1 factor(s)
[2023-07-03 21:46:14] [memory] Reserving 377 MB, device gpu0
[2023-07-03 21:46:17] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 21:46:17] [memory] Reserving 377 MB, device gpu0
[2023-07-03 21:46:17] Parameter type float32, optimization type float32, casting types false
[2023-07-03 21:46:17] Allocating memory for Adam-specific shards
[2023-07-03 21:46:17] [memory] Reserving 754 MB, device gpu0
[2023-07-03 21:46:56] Seen 18,843 samples
[2023-07-03 21:46:56] Starting data epoch 2 in logical epoch 2
[2023-07-03 21:46:56] Training finished
[2023-07-03 21:47:02] [valid] Ep. 2 : Up. 297 : cross-entropy : 128.186 : new best
[2023-07-03 21:48:46] [valid] Ep. 2 : Up. 297 : translation : 0 : new best
[2023-07-03 21:48:46] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 21:48:51] Saving Adam parameters
[2023-07-03 21:48:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-03 21:49:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 21:49:06] [marian] Running on node19.datos.cluster.uy as process 11594 with command line:
[2023-07-03 21:49:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-03 21:49:06] [config] after: 0e
[2023-07-03 21:49:06] [config] after-batches: 0
[2023-07-03 21:49:06] [config] after-epochs: 2
[2023-07-03 21:49:06] [config] all-caps-every: 0
[2023-07-03 21:49:06] [config] allow-unk: false
[2023-07-03 21:49:06] [config] authors: false
[2023-07-03 21:49:06] [config] beam-size: 12
[2023-07-03 21:49:06] [config] bert-class-symbol: "[CLS]"
[2023-07-03 21:49:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 21:49:06] [config] bert-masking-fraction: 0.15
[2023-07-03 21:49:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 21:49:06] [config] bert-train-type-embeddings: true
[2023-07-03 21:49:06] [config] bert-type-vocab-size: 2
[2023-07-03 21:49:06] [config] build-info: ""
[2023-07-03 21:49:06] [config] check-gradient-nan: false
[2023-07-03 21:49:06] [config] check-nan: false
[2023-07-03 21:49:06] [config] cite: false
[2023-07-03 21:49:06] [config] clip-norm: 1
[2023-07-03 21:49:06] [config] cost-scaling:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] cost-type: ce-sum
[2023-07-03 21:49:06] [config] cpu-threads: 0
[2023-07-03 21:49:06] [config] data-threads: 8
[2023-07-03 21:49:06] [config] data-weighting: ""
[2023-07-03 21:49:06] [config] data-weighting-type: sentence
[2023-07-03 21:49:06] [config] dec-cell: gru
[2023-07-03 21:49:06] [config] dec-cell-base-depth: 2
[2023-07-03 21:49:06] [config] dec-cell-high-depth: 1
[2023-07-03 21:49:06] [config] dec-depth: 1
[2023-07-03 21:49:06] [config] devices:
[2023-07-03 21:49:06] [config]   - 0
[2023-07-03 21:49:06] [config] dim-emb: 512
[2023-07-03 21:49:06] [config] dim-rnn: 1024
[2023-07-03 21:49:06] [config] dim-vocabs:
[2023-07-03 21:49:06] [config]   - 54042
[2023-07-03 21:49:06] [config]   - 36507
[2023-07-03 21:49:06] [config] disp-first: 0
[2023-07-03 21:49:06] [config] disp-freq: 1000u
[2023-07-03 21:49:06] [config] disp-label-counts: true
[2023-07-03 21:49:06] [config] dropout-rnn: 0
[2023-07-03 21:49:06] [config] dropout-src: 0
[2023-07-03 21:49:06] [config] dropout-trg: 0
[2023-07-03 21:49:06] [config] dump-config: ""
[2023-07-03 21:49:06] [config] dynamic-gradient-scaling:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] early-stopping: 10
[2023-07-03 21:49:06] [config] early-stopping-on: first
[2023-07-03 21:49:06] [config] embedding-fix-src: false
[2023-07-03 21:49:06] [config] embedding-fix-trg: false
[2023-07-03 21:49:06] [config] embedding-normalization: false
[2023-07-03 21:49:06] [config] embedding-vectors:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] enc-cell: gru
[2023-07-03 21:49:06] [config] enc-cell-depth: 1
[2023-07-03 21:49:06] [config] enc-depth: 1
[2023-07-03 21:49:06] [config] enc-type: bidirectional
[2023-07-03 21:49:06] [config] english-title-case-every: 0
[2023-07-03 21:49:06] [config] exponential-smoothing: 0
[2023-07-03 21:49:06] [config] factor-weight: 1
[2023-07-03 21:49:06] [config] factors-combine: sum
[2023-07-03 21:49:06] [config] factors-dim-emb: 0
[2023-07-03 21:49:06] [config] gradient-checkpointing: false
[2023-07-03 21:49:06] [config] gradient-norm-average-window: 100
[2023-07-03 21:49:06] [config] guided-alignment: none
[2023-07-03 21:49:06] [config] guided-alignment-cost: mse
[2023-07-03 21:49:06] [config] guided-alignment-weight: 0.1
[2023-07-03 21:49:06] [config] ignore-model-config: false
[2023-07-03 21:49:06] [config] input-types:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] interpolate-env-vars: false
[2023-07-03 21:49:06] [config] keep-best: false
[2023-07-03 21:49:06] [config] label-smoothing: 0
[2023-07-03 21:49:06] [config] layer-normalization: false
[2023-07-03 21:49:06] [config] learn-rate: 0.0001
[2023-07-03 21:49:06] [config] lemma-dependency: ""
[2023-07-03 21:49:06] [config] lemma-dim-emb: 0
[2023-07-03 21:49:06] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 21:49:06] [config] log-level: info
[2023-07-03 21:49:06] [config] log-time-zone: ""
[2023-07-03 21:49:06] [config] logical-epoch:
[2023-07-03 21:49:06] [config]   - 1e
[2023-07-03 21:49:06] [config]   - 0
[2023-07-03 21:49:06] [config] lr-decay: 0
[2023-07-03 21:49:06] [config] lr-decay-freq: 50000
[2023-07-03 21:49:06] [config] lr-decay-inv-sqrt:
[2023-07-03 21:49:06] [config]   - 0
[2023-07-03 21:49:06] [config] lr-decay-repeat-warmup: false
[2023-07-03 21:49:06] [config] lr-decay-reset-optimizer: false
[2023-07-03 21:49:06] [config] lr-decay-start:
[2023-07-03 21:49:06] [config]   - 10
[2023-07-03 21:49:06] [config]   - 1
[2023-07-03 21:49:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 21:49:06] [config] lr-report: false
[2023-07-03 21:49:06] [config] lr-warmup: 0
[2023-07-03 21:49:06] [config] lr-warmup-at-reload: false
[2023-07-03 21:49:06] [config] lr-warmup-cycle: false
[2023-07-03 21:49:06] [config] lr-warmup-start-rate: 0
[2023-07-03 21:49:06] [config] max-length: 50
[2023-07-03 21:49:06] [config] max-length-crop: false
[2023-07-03 21:49:06] [config] max-length-factor: 3
[2023-07-03 21:49:06] [config] maxi-batch: 100
[2023-07-03 21:49:06] [config] maxi-batch-sort: trg
[2023-07-03 21:49:06] [config] mini-batch: 64
[2023-07-03 21:49:06] [config] mini-batch-fit: false
[2023-07-03 21:49:06] [config] mini-batch-fit-step: 10
[2023-07-03 21:49:06] [config] mini-batch-round-up: true
[2023-07-03 21:49:06] [config] mini-batch-track-lr: false
[2023-07-03 21:49:06] [config] mini-batch-warmup: 0
[2023-07-03 21:49:06] [config] mini-batch-words: 0
[2023-07-03 21:49:06] [config] mini-batch-words-ref: 0
[2023-07-03 21:49:06] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 21:49:06] [config] multi-loss-type: sum
[2023-07-03 21:49:06] [config] n-best: false
[2023-07-03 21:49:06] [config] no-nccl: false
[2023-07-03 21:49:06] [config] no-reload: false
[2023-07-03 21:49:06] [config] no-restore-corpus: false
[2023-07-03 21:49:06] [config] normalize: 0
[2023-07-03 21:49:06] [config] normalize-gradient: false
[2023-07-03 21:49:06] [config] num-devices: 0
[2023-07-03 21:49:06] [config] optimizer: adam
[2023-07-03 21:49:06] [config] optimizer-delay: 1
[2023-07-03 21:49:06] [config] optimizer-params:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] output-omit-bias: false
[2023-07-03 21:49:06] [config] overwrite: true
[2023-07-03 21:49:06] [config] precision:
[2023-07-03 21:49:06] [config]   - float32
[2023-07-03 21:49:06] [config]   - float32
[2023-07-03 21:49:06] [config] pretrained-model: ""
[2023-07-03 21:49:06] [config] quantize-biases: false
[2023-07-03 21:49:06] [config] quantize-bits: 0
[2023-07-03 21:49:06] [config] quantize-log-based: false
[2023-07-03 21:49:06] [config] quantize-optimization-steps: 0
[2023-07-03 21:49:06] [config] quiet: false
[2023-07-03 21:49:06] [config] quiet-translation: true
[2023-07-03 21:49:06] [config] relative-paths: false
[2023-07-03 21:49:06] [config] right-left: false
[2023-07-03 21:49:06] [config] save-freq: 10000u
[2023-07-03 21:49:06] [config] seed: 1234
[2023-07-03 21:49:06] [config] sentencepiece-alphas:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] sentencepiece-max-lines: 2000000
[2023-07-03 21:49:06] [config] sentencepiece-options: ""
[2023-07-03 21:49:06] [config] sharding: global
[2023-07-03 21:49:06] [config] shuffle: data
[2023-07-03 21:49:06] [config] shuffle-in-ram: false
[2023-07-03 21:49:06] [config] sigterm: save-and-exit
[2023-07-03 21:49:06] [config] skip: false
[2023-07-03 21:49:06] [config] sqlite: ""
[2023-07-03 21:49:06] [config] sqlite-drop: false
[2023-07-03 21:49:06] [config] sync-freq: 200u
[2023-07-03 21:49:06] [config] sync-sgd: false
[2023-07-03 21:49:06] [config] tempdir: /tmp
[2023-07-03 21:49:06] [config] tied-embeddings: false
[2023-07-03 21:49:06] [config] tied-embeddings-all: false
[2023-07-03 21:49:06] [config] tied-embeddings-src: false
[2023-07-03 21:49:06] [config] train-embedder-rank:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] train-sets:
[2023-07-03 21:49:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 21:49:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 21:49:06] [config] transformer-aan-activation: swish
[2023-07-03 21:49:06] [config] transformer-aan-depth: 2
[2023-07-03 21:49:06] [config] transformer-aan-nogate: false
[2023-07-03 21:49:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 21:49:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 21:49:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 21:49:06] [config] transformer-depth-scaling: false
[2023-07-03 21:49:06] [config] transformer-dim-aan: 2048
[2023-07-03 21:49:06] [config] transformer-dim-ffn: 2048
[2023-07-03 21:49:06] [config] transformer-dropout: 0
[2023-07-03 21:49:06] [config] transformer-dropout-attention: 0
[2023-07-03 21:49:06] [config] transformer-dropout-ffn: 0
[2023-07-03 21:49:06] [config] transformer-ffn-activation: swish
[2023-07-03 21:49:06] [config] transformer-ffn-depth: 2
[2023-07-03 21:49:06] [config] transformer-guided-alignment-layer: last
[2023-07-03 21:49:06] [config] transformer-heads: 8
[2023-07-03 21:49:06] [config] transformer-no-projection: false
[2023-07-03 21:49:06] [config] transformer-pool: false
[2023-07-03 21:49:06] [config] transformer-postprocess: dan
[2023-07-03 21:49:06] [config] transformer-postprocess-emb: d
[2023-07-03 21:49:06] [config] transformer-postprocess-top: ""
[2023-07-03 21:49:06] [config] transformer-preprocess: ""
[2023-07-03 21:49:06] [config] transformer-tied-layers:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] transformer-train-position-embeddings: false
[2023-07-03 21:49:06] [config] tsv: false
[2023-07-03 21:49:06] [config] tsv-fields: 0
[2023-07-03 21:49:06] [config] type: amun
[2023-07-03 21:49:06] [config] ulr: false
[2023-07-03 21:49:06] [config] ulr-dim-emb: 0
[2023-07-03 21:49:06] [config] ulr-dropout: 0
[2023-07-03 21:49:06] [config] ulr-keys-vectors: ""
[2023-07-03 21:49:06] [config] ulr-query-vectors: ""
[2023-07-03 21:49:06] [config] ulr-softmax-temperature: 1
[2023-07-03 21:49:06] [config] ulr-trainable-transformation: false
[2023-07-03 21:49:06] [config] unlikelihood-loss: false
[2023-07-03 21:49:06] [config] valid-freq: 50000000
[2023-07-03 21:49:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 21:49:06] [config] valid-max-length: 1000
[2023-07-03 21:49:06] [config] valid-metrics:
[2023-07-03 21:49:06] [config]   - cross-entropy
[2023-07-03 21:49:06] [config]   - translation
[2023-07-03 21:49:06] [config] valid-mini-batch: 32
[2023-07-03 21:49:06] [config] valid-reset-stalled: false
[2023-07-03 21:49:06] [config] valid-script-args:
[2023-07-03 21:49:06] [config]   []
[2023-07-03 21:49:06] [config] valid-script-path: ""
[2023-07-03 21:49:06] [config] valid-sets:
[2023-07-03 21:49:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 21:49:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 21:49:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 21:49:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 21:49:06] [config] vocabs:
[2023-07-03 21:49:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 21:49:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 21:49:06] [config] word-penalty: 0
[2023-07-03 21:49:06] [config] word-scores: false
[2023-07-03 21:49:06] [config] workspace: 2048
[2023-07-03 21:49:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 21:49:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 21:49:06] [training] Using single-device training
[2023-07-03 21:49:07] Synced seed 1234
[2023-07-03 21:49:07] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 21:49:07] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 21:49:07] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 21:49:07] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 21:49:07] [valid] No post-processing script given for validating translator
[2023-07-03 21:49:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 21:49:08] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 21:49:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 21:49:08] [comm] Using global sharding
[2023-07-03 21:49:08] [comm] NCCLCommunicators constructed successfully
[2023-07-03 21:49:08] [training] Using 1 GPUs
[2023-07-03 21:49:08] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 21:49:11] Loading Adam parameters
[2023-07-03 21:49:11] [memory] Reserving 754 MB, device gpu0
[2023-07-03 21:49:11] [memory] Reserving 377 MB, device gpu0
[2023-07-03 21:49:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-03 21:49:11] [data] Restoring the corpus state to epoch 2, batch 297
[2023-07-03 21:49:11] [data] Shuffling data
[2023-07-03 21:49:11] [data] Done reading 20,192 sentences
[2023-07-03 21:49:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 21:49:11] Training started
[2023-07-03 21:49:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 21:49:11] [logits] Applying loss function for 1 factor(s)
[2023-07-03 21:49:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 21:49:12] [memory] Reserving 377 MB, device gpu0
[2023-07-03 21:49:12] Parameter type float32, optimization type float32, casting types false
[2023-07-03 21:49:51] Seen 18,843 samples
[2023-07-03 21:49:51] Starting data epoch 3 in logical epoch 3
[2023-07-03 21:49:51] Training finished
[2023-07-03 21:49:57] [valid] Ep. 3 : Up. 594 : cross-entropy : 122.186 : new best
[2023-07-03 21:51:50] [valid] Ep. 3 : Up. 594 : translation : 0 : new best
[2023-07-03 21:51:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 21:51:58] Saving Adam parameters
[2023-07-03 21:51:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-03 22:12:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:12:45] [marian] Running on node19.datos.cluster.uy as process 33643 with command line:
[2023-07-03 22:12:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-03 22:12:45] [config] after: 0e
[2023-07-03 22:12:45] [config] after-batches: 0
[2023-07-03 22:12:45] [config] after-epochs: 1
[2023-07-03 22:12:45] [config] all-caps-every: 0
[2023-07-03 22:12:45] [config] allow-unk: false
[2023-07-03 22:12:45] [config] authors: false
[2023-07-03 22:12:45] [config] beam-size: 12
[2023-07-03 22:12:45] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:12:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:12:45] [config] bert-masking-fraction: 0.15
[2023-07-03 22:12:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:12:45] [config] bert-train-type-embeddings: true
[2023-07-03 22:12:45] [config] bert-type-vocab-size: 2
[2023-07-03 22:12:45] [config] build-info: ""
[2023-07-03 22:12:45] [config] check-gradient-nan: false
[2023-07-03 22:12:45] [config] check-nan: false
[2023-07-03 22:12:45] [config] cite: false
[2023-07-03 22:12:45] [config] clip-norm: 1
[2023-07-03 22:12:45] [config] cost-scaling:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] cost-type: ce-sum
[2023-07-03 22:12:45] [config] cpu-threads: 0
[2023-07-03 22:12:45] [config] data-threads: 8
[2023-07-03 22:12:45] [config] data-weighting: ""
[2023-07-03 22:12:45] [config] data-weighting-type: sentence
[2023-07-03 22:12:45] [config] dec-cell: gru
[2023-07-03 22:12:45] [config] dec-cell-base-depth: 2
[2023-07-03 22:12:45] [config] dec-cell-high-depth: 1
[2023-07-03 22:12:45] [config] dec-depth: 1
[2023-07-03 22:12:45] [config] devices:
[2023-07-03 22:12:45] [config]   - 0
[2023-07-03 22:12:45] [config] dim-emb: 512
[2023-07-03 22:12:45] [config] dim-rnn: 1024
[2023-07-03 22:12:45] [config] dim-vocabs:
[2023-07-03 22:12:45] [config]   - 54042
[2023-07-03 22:12:45] [config]   - 36507
[2023-07-03 22:12:45] [config] disp-first: 0
[2023-07-03 22:12:45] [config] disp-freq: 1000u
[2023-07-03 22:12:45] [config] disp-label-counts: true
[2023-07-03 22:12:45] [config] dropout-rnn: 0
[2023-07-03 22:12:45] [config] dropout-src: 0
[2023-07-03 22:12:45] [config] dropout-trg: 0
[2023-07-03 22:12:45] [config] dump-config: ""
[2023-07-03 22:12:45] [config] dynamic-gradient-scaling:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] early-stopping: 10
[2023-07-03 22:12:45] [config] early-stopping-on: first
[2023-07-03 22:12:45] [config] embedding-fix-src: false
[2023-07-03 22:12:45] [config] embedding-fix-trg: false
[2023-07-03 22:12:45] [config] embedding-normalization: false
[2023-07-03 22:12:45] [config] embedding-vectors:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] enc-cell: gru
[2023-07-03 22:12:45] [config] enc-cell-depth: 1
[2023-07-03 22:12:45] [config] enc-depth: 1
[2023-07-03 22:12:45] [config] enc-type: bidirectional
[2023-07-03 22:12:45] [config] english-title-case-every: 0
[2023-07-03 22:12:45] [config] exponential-smoothing: 0
[2023-07-03 22:12:45] [config] factor-weight: 1
[2023-07-03 22:12:45] [config] factors-combine: sum
[2023-07-03 22:12:45] [config] factors-dim-emb: 0
[2023-07-03 22:12:45] [config] gradient-checkpointing: false
[2023-07-03 22:12:45] [config] gradient-norm-average-window: 100
[2023-07-03 22:12:45] [config] guided-alignment: none
[2023-07-03 22:12:45] [config] guided-alignment-cost: mse
[2023-07-03 22:12:45] [config] guided-alignment-weight: 0.1
[2023-07-03 22:12:45] [config] ignore-model-config: false
[2023-07-03 22:12:45] [config] input-types:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] interpolate-env-vars: false
[2023-07-03 22:12:45] [config] keep-best: false
[2023-07-03 22:12:45] [config] label-smoothing: 0
[2023-07-03 22:12:45] [config] layer-normalization: false
[2023-07-03 22:12:45] [config] learn-rate: 0.0001
[2023-07-03 22:12:45] [config] lemma-dependency: ""
[2023-07-03 22:12:45] [config] lemma-dim-emb: 0
[2023-07-03 22:12:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:12:45] [config] log-level: info
[2023-07-03 22:12:45] [config] log-time-zone: ""
[2023-07-03 22:12:45] [config] logical-epoch:
[2023-07-03 22:12:45] [config]   - 1e
[2023-07-03 22:12:45] [config]   - 0
[2023-07-03 22:12:45] [config] lr-decay: 0
[2023-07-03 22:12:45] [config] lr-decay-freq: 50000
[2023-07-03 22:12:45] [config] lr-decay-inv-sqrt:
[2023-07-03 22:12:45] [config]   - 0
[2023-07-03 22:12:45] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:12:45] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:12:45] [config] lr-decay-start:
[2023-07-03 22:12:45] [config]   - 10
[2023-07-03 22:12:45] [config]   - 1
[2023-07-03 22:12:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:12:45] [config] lr-report: false
[2023-07-03 22:12:45] [config] lr-warmup: 0
[2023-07-03 22:12:45] [config] lr-warmup-at-reload: false
[2023-07-03 22:12:45] [config] lr-warmup-cycle: false
[2023-07-03 22:12:45] [config] lr-warmup-start-rate: 0
[2023-07-03 22:12:45] [config] max-length: 50
[2023-07-03 22:12:45] [config] max-length-crop: false
[2023-07-03 22:12:45] [config] max-length-factor: 3
[2023-07-03 22:12:45] [config] maxi-batch: 100
[2023-07-03 22:12:45] [config] maxi-batch-sort: trg
[2023-07-03 22:12:45] [config] mini-batch: 64
[2023-07-03 22:12:45] [config] mini-batch-fit: false
[2023-07-03 22:12:45] [config] mini-batch-fit-step: 10
[2023-07-03 22:12:45] [config] mini-batch-round-up: true
[2023-07-03 22:12:45] [config] mini-batch-track-lr: false
[2023-07-03 22:12:45] [config] mini-batch-warmup: 0
[2023-07-03 22:12:45] [config] mini-batch-words: 0
[2023-07-03 22:12:45] [config] mini-batch-words-ref: 0
[2023-07-03 22:12:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 22:12:45] [config] multi-loss-type: sum
[2023-07-03 22:12:45] [config] n-best: false
[2023-07-03 22:12:45] [config] no-nccl: false
[2023-07-03 22:12:45] [config] no-reload: false
[2023-07-03 22:12:45] [config] no-restore-corpus: false
[2023-07-03 22:12:45] [config] normalize: 0
[2023-07-03 22:12:45] [config] normalize-gradient: false
[2023-07-03 22:12:45] [config] num-devices: 0
[2023-07-03 22:12:45] [config] optimizer: adam
[2023-07-03 22:12:45] [config] optimizer-delay: 1
[2023-07-03 22:12:45] [config] optimizer-params:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] output-omit-bias: false
[2023-07-03 22:12:45] [config] overwrite: true
[2023-07-03 22:12:45] [config] precision:
[2023-07-03 22:12:45] [config]   - float32
[2023-07-03 22:12:45] [config]   - float32
[2023-07-03 22:12:45] [config] pretrained-model: ""
[2023-07-03 22:12:45] [config] quantize-biases: false
[2023-07-03 22:12:45] [config] quantize-bits: 0
[2023-07-03 22:12:45] [config] quantize-log-based: false
[2023-07-03 22:12:45] [config] quantize-optimization-steps: 0
[2023-07-03 22:12:45] [config] quiet: false
[2023-07-03 22:12:45] [config] quiet-translation: true
[2023-07-03 22:12:45] [config] relative-paths: false
[2023-07-03 22:12:45] [config] right-left: false
[2023-07-03 22:12:45] [config] save-freq: 10000u
[2023-07-03 22:12:45] [config] seed: 1234
[2023-07-03 22:12:45] [config] sentencepiece-alphas:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:12:45] [config] sentencepiece-options: ""
[2023-07-03 22:12:45] [config] sharding: global
[2023-07-03 22:12:45] [config] shuffle: data
[2023-07-03 22:12:45] [config] shuffle-in-ram: false
[2023-07-03 22:12:45] [config] sigterm: save-and-exit
[2023-07-03 22:12:45] [config] skip: false
[2023-07-03 22:12:45] [config] sqlite: ""
[2023-07-03 22:12:45] [config] sqlite-drop: false
[2023-07-03 22:12:45] [config] sync-freq: 200u
[2023-07-03 22:12:45] [config] sync-sgd: false
[2023-07-03 22:12:45] [config] tempdir: /tmp
[2023-07-03 22:12:45] [config] tied-embeddings: false
[2023-07-03 22:12:45] [config] tied-embeddings-all: false
[2023-07-03 22:12:45] [config] tied-embeddings-src: false
[2023-07-03 22:12:45] [config] train-embedder-rank:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] train-sets:
[2023-07-03 22:12:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:12:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:12:45] [config] transformer-aan-activation: swish
[2023-07-03 22:12:45] [config] transformer-aan-depth: 2
[2023-07-03 22:12:45] [config] transformer-aan-nogate: false
[2023-07-03 22:12:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:12:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:12:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:12:45] [config] transformer-depth-scaling: false
[2023-07-03 22:12:45] [config] transformer-dim-aan: 2048
[2023-07-03 22:12:45] [config] transformer-dim-ffn: 2048
[2023-07-03 22:12:45] [config] transformer-dropout: 0
[2023-07-03 22:12:45] [config] transformer-dropout-attention: 0
[2023-07-03 22:12:45] [config] transformer-dropout-ffn: 0
[2023-07-03 22:12:45] [config] transformer-ffn-activation: swish
[2023-07-03 22:12:45] [config] transformer-ffn-depth: 2
[2023-07-03 22:12:45] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:12:45] [config] transformer-heads: 8
[2023-07-03 22:12:45] [config] transformer-no-projection: false
[2023-07-03 22:12:45] [config] transformer-pool: false
[2023-07-03 22:12:45] [config] transformer-postprocess: dan
[2023-07-03 22:12:45] [config] transformer-postprocess-emb: d
[2023-07-03 22:12:45] [config] transformer-postprocess-top: ""
[2023-07-03 22:12:45] [config] transformer-preprocess: ""
[2023-07-03 22:12:45] [config] transformer-tied-layers:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] transformer-train-position-embeddings: false
[2023-07-03 22:12:45] [config] tsv: false
[2023-07-03 22:12:45] [config] tsv-fields: 0
[2023-07-03 22:12:45] [config] type: amun
[2023-07-03 22:12:45] [config] ulr: false
[2023-07-03 22:12:45] [config] ulr-dim-emb: 0
[2023-07-03 22:12:45] [config] ulr-dropout: 0
[2023-07-03 22:12:45] [config] ulr-keys-vectors: ""
[2023-07-03 22:12:45] [config] ulr-query-vectors: ""
[2023-07-03 22:12:45] [config] ulr-softmax-temperature: 1
[2023-07-03 22:12:45] [config] ulr-trainable-transformation: false
[2023-07-03 22:12:45] [config] unlikelihood-loss: false
[2023-07-03 22:12:45] [config] valid-freq: 50000000
[2023-07-03 22:12:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:12:45] [config] valid-max-length: 1000
[2023-07-03 22:12:45] [config] valid-metrics:
[2023-07-03 22:12:45] [config]   - cross-entropy
[2023-07-03 22:12:45] [config]   - translation
[2023-07-03 22:12:45] [config] valid-mini-batch: 32
[2023-07-03 22:12:45] [config] valid-reset-stalled: false
[2023-07-03 22:12:45] [config] valid-script-args:
[2023-07-03 22:12:45] [config]   []
[2023-07-03 22:12:45] [config] valid-script-path: ""
[2023-07-03 22:12:45] [config] valid-sets:
[2023-07-03 22:12:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:12:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:12:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:12:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:12:45] [config] vocabs:
[2023-07-03 22:12:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:12:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:12:45] [config] word-penalty: 0
[2023-07-03 22:12:45] [config] word-scores: false
[2023-07-03 22:12:45] [config] workspace: 2048
[2023-07-03 22:12:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:12:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:12:45] [training] Using single-device training
[2023-07-03 22:12:47] Synced seed 1234
[2023-07-03 22:12:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:12:47] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:12:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:12:47] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:12:47] [valid] No post-processing script given for validating translator
[2023-07-03 22:12:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:12:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:12:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:12:49] [comm] Using global sharding
[2023-07-03 22:12:49] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:12:49] [training] Using 1 GPUs
[2023-07-03 22:12:49] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 22:13:08] Loading Adam parameters
[2023-07-03 22:13:08] [memory] Reserving 754 MB, device gpu0
[2023-07-03 22:13:09] [memory] Reserving 377 MB, device gpu0
[2023-07-03 22:13:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-03 22:13:09] [data] Restoring the corpus state to epoch 3, batch 594
[2023-07-03 22:13:09] [data] Shuffling data
[2023-07-03 22:13:09] [data] Done reading 20,192 sentences
[2023-07-03 22:13:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:13:09] Training started
[2023-07-03 22:13:09] Training finished
[2023-07-03 22:13:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:13] [marian] Running on node19.datos.cluster.uy as process 33950 with command line:
[2023-07-03 22:13:13] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-03 22:13:13] [config] after: 0e
[2023-07-03 22:13:13] [config] after-batches: 0
[2023-07-03 22:13:13] [config] after-epochs: 2
[2023-07-03 22:13:13] [config] all-caps-every: 0
[2023-07-03 22:13:13] [config] allow-unk: false
[2023-07-03 22:13:13] [config] authors: false
[2023-07-03 22:13:13] [config] beam-size: 12
[2023-07-03 22:13:13] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:13:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:13:13] [config] bert-masking-fraction: 0.15
[2023-07-03 22:13:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:13:13] [config] bert-train-type-embeddings: true
[2023-07-03 22:13:13] [config] bert-type-vocab-size: 2
[2023-07-03 22:13:13] [config] build-info: ""
[2023-07-03 22:13:13] [config] check-gradient-nan: false
[2023-07-03 22:13:13] [config] check-nan: false
[2023-07-03 22:13:13] [config] cite: false
[2023-07-03 22:13:13] [config] clip-norm: 1
[2023-07-03 22:13:13] [config] cost-scaling:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] cost-type: ce-sum
[2023-07-03 22:13:13] [config] cpu-threads: 0
[2023-07-03 22:13:13] [config] data-threads: 8
[2023-07-03 22:13:13] [config] data-weighting: ""
[2023-07-03 22:13:13] [config] data-weighting-type: sentence
[2023-07-03 22:13:13] [config] dec-cell: gru
[2023-07-03 22:13:13] [config] dec-cell-base-depth: 2
[2023-07-03 22:13:13] [config] dec-cell-high-depth: 1
[2023-07-03 22:13:13] [config] dec-depth: 1
[2023-07-03 22:13:13] [config] devices:
[2023-07-03 22:13:13] [config]   - 0
[2023-07-03 22:13:13] [config] dim-emb: 512
[2023-07-03 22:13:13] [config] dim-rnn: 1024
[2023-07-03 22:13:13] [config] dim-vocabs:
[2023-07-03 22:13:13] [config]   - 54042
[2023-07-03 22:13:13] [config]   - 36507
[2023-07-03 22:13:13] [config] disp-first: 0
[2023-07-03 22:13:13] [config] disp-freq: 1000u
[2023-07-03 22:13:13] [config] disp-label-counts: true
[2023-07-03 22:13:13] [config] dropout-rnn: 0
[2023-07-03 22:13:13] [config] dropout-src: 0
[2023-07-03 22:13:13] [config] dropout-trg: 0
[2023-07-03 22:13:13] [config] dump-config: ""
[2023-07-03 22:13:13] [config] dynamic-gradient-scaling:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] early-stopping: 10
[2023-07-03 22:13:13] [config] early-stopping-on: first
[2023-07-03 22:13:13] [config] embedding-fix-src: false
[2023-07-03 22:13:13] [config] embedding-fix-trg: false
[2023-07-03 22:13:13] [config] embedding-normalization: false
[2023-07-03 22:13:13] [config] embedding-vectors:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] enc-cell: gru
[2023-07-03 22:13:13] [config] enc-cell-depth: 1
[2023-07-03 22:13:13] [config] enc-depth: 1
[2023-07-03 22:13:13] [config] enc-type: bidirectional
[2023-07-03 22:13:13] [config] english-title-case-every: 0
[2023-07-03 22:13:13] [config] exponential-smoothing: 0
[2023-07-03 22:13:13] [config] factor-weight: 1
[2023-07-03 22:13:13] [config] factors-combine: sum
[2023-07-03 22:13:13] [config] factors-dim-emb: 0
[2023-07-03 22:13:13] [config] gradient-checkpointing: false
[2023-07-03 22:13:13] [config] gradient-norm-average-window: 100
[2023-07-03 22:13:13] [config] guided-alignment: none
[2023-07-03 22:13:13] [config] guided-alignment-cost: mse
[2023-07-03 22:13:13] [config] guided-alignment-weight: 0.1
[2023-07-03 22:13:13] [config] ignore-model-config: false
[2023-07-03 22:13:13] [config] input-types:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] interpolate-env-vars: false
[2023-07-03 22:13:13] [config] keep-best: false
[2023-07-03 22:13:13] [config] label-smoothing: 0
[2023-07-03 22:13:13] [config] layer-normalization: false
[2023-07-03 22:13:13] [config] learn-rate: 0.0001
[2023-07-03 22:13:13] [config] lemma-dependency: ""
[2023-07-03 22:13:13] [config] lemma-dim-emb: 0
[2023-07-03 22:13:13] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:13:13] [config] log-level: info
[2023-07-03 22:13:13] [config] log-time-zone: ""
[2023-07-03 22:13:13] [config] logical-epoch:
[2023-07-03 22:13:13] [config]   - 1e
[2023-07-03 22:13:13] [config]   - 0
[2023-07-03 22:13:13] [config] lr-decay: 0
[2023-07-03 22:13:13] [config] lr-decay-freq: 50000
[2023-07-03 22:13:13] [config] lr-decay-inv-sqrt:
[2023-07-03 22:13:13] [config]   - 0
[2023-07-03 22:13:13] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:13:13] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:13:13] [config] lr-decay-start:
[2023-07-03 22:13:13] [config]   - 10
[2023-07-03 22:13:13] [config]   - 1
[2023-07-03 22:13:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:13:13] [config] lr-report: false
[2023-07-03 22:13:13] [config] lr-warmup: 0
[2023-07-03 22:13:13] [config] lr-warmup-at-reload: false
[2023-07-03 22:13:13] [config] lr-warmup-cycle: false
[2023-07-03 22:13:13] [config] lr-warmup-start-rate: 0
[2023-07-03 22:13:13] [config] max-length: 50
[2023-07-03 22:13:13] [config] max-length-crop: false
[2023-07-03 22:13:13] [config] max-length-factor: 3
[2023-07-03 22:13:13] [config] maxi-batch: 100
[2023-07-03 22:13:13] [config] maxi-batch-sort: trg
[2023-07-03 22:13:13] [config] mini-batch: 64
[2023-07-03 22:13:13] [config] mini-batch-fit: false
[2023-07-03 22:13:13] [config] mini-batch-fit-step: 10
[2023-07-03 22:13:13] [config] mini-batch-round-up: true
[2023-07-03 22:13:13] [config] mini-batch-track-lr: false
[2023-07-03 22:13:13] [config] mini-batch-warmup: 0
[2023-07-03 22:13:13] [config] mini-batch-words: 0
[2023-07-03 22:13:13] [config] mini-batch-words-ref: 0
[2023-07-03 22:13:13] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 22:13:13] [config] multi-loss-type: sum
[2023-07-03 22:13:13] [config] n-best: false
[2023-07-03 22:13:13] [config] no-nccl: false
[2023-07-03 22:13:13] [config] no-reload: false
[2023-07-03 22:13:13] [config] no-restore-corpus: false
[2023-07-03 22:13:13] [config] normalize: 0
[2023-07-03 22:13:13] [config] normalize-gradient: false
[2023-07-03 22:13:13] [config] num-devices: 0
[2023-07-03 22:13:13] [config] optimizer: adam
[2023-07-03 22:13:13] [config] optimizer-delay: 1
[2023-07-03 22:13:13] [config] optimizer-params:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] output-omit-bias: false
[2023-07-03 22:13:13] [config] overwrite: true
[2023-07-03 22:13:13] [config] precision:
[2023-07-03 22:13:13] [config]   - float32
[2023-07-03 22:13:13] [config]   - float32
[2023-07-03 22:13:13] [config] pretrained-model: ""
[2023-07-03 22:13:13] [config] quantize-biases: false
[2023-07-03 22:13:13] [config] quantize-bits: 0
[2023-07-03 22:13:13] [config] quantize-log-based: false
[2023-07-03 22:13:13] [config] quantize-optimization-steps: 0
[2023-07-03 22:13:13] [config] quiet: false
[2023-07-03 22:13:13] [config] quiet-translation: true
[2023-07-03 22:13:13] [config] relative-paths: false
[2023-07-03 22:13:13] [config] right-left: false
[2023-07-03 22:13:13] [config] save-freq: 10000u
[2023-07-03 22:13:13] [config] seed: 1234
[2023-07-03 22:13:13] [config] sentencepiece-alphas:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:13:13] [config] sentencepiece-options: ""
[2023-07-03 22:13:13] [config] sharding: global
[2023-07-03 22:13:13] [config] shuffle: data
[2023-07-03 22:13:13] [config] shuffle-in-ram: false
[2023-07-03 22:13:13] [config] sigterm: save-and-exit
[2023-07-03 22:13:13] [config] skip: false
[2023-07-03 22:13:13] [config] sqlite: ""
[2023-07-03 22:13:13] [config] sqlite-drop: false
[2023-07-03 22:13:13] [config] sync-freq: 200u
[2023-07-03 22:13:13] [config] sync-sgd: false
[2023-07-03 22:13:13] [config] tempdir: /tmp
[2023-07-03 22:13:13] [config] tied-embeddings: false
[2023-07-03 22:13:13] [config] tied-embeddings-all: false
[2023-07-03 22:13:13] [config] tied-embeddings-src: false
[2023-07-03 22:13:13] [config] train-embedder-rank:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] train-sets:
[2023-07-03 22:13:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:13:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:13:13] [config] transformer-aan-activation: swish
[2023-07-03 22:13:13] [config] transformer-aan-depth: 2
[2023-07-03 22:13:13] [config] transformer-aan-nogate: false
[2023-07-03 22:13:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:13:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:13:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:13:13] [config] transformer-depth-scaling: false
[2023-07-03 22:13:13] [config] transformer-dim-aan: 2048
[2023-07-03 22:13:13] [config] transformer-dim-ffn: 2048
[2023-07-03 22:13:13] [config] transformer-dropout: 0
[2023-07-03 22:13:13] [config] transformer-dropout-attention: 0
[2023-07-03 22:13:13] [config] transformer-dropout-ffn: 0
[2023-07-03 22:13:13] [config] transformer-ffn-activation: swish
[2023-07-03 22:13:13] [config] transformer-ffn-depth: 2
[2023-07-03 22:13:13] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:13:13] [config] transformer-heads: 8
[2023-07-03 22:13:13] [config] transformer-no-projection: false
[2023-07-03 22:13:13] [config] transformer-pool: false
[2023-07-03 22:13:13] [config] transformer-postprocess: dan
[2023-07-03 22:13:13] [config] transformer-postprocess-emb: d
[2023-07-03 22:13:13] [config] transformer-postprocess-top: ""
[2023-07-03 22:13:13] [config] transformer-preprocess: ""
[2023-07-03 22:13:13] [config] transformer-tied-layers:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] transformer-train-position-embeddings: false
[2023-07-03 22:13:13] [config] tsv: false
[2023-07-03 22:13:13] [config] tsv-fields: 0
[2023-07-03 22:13:13] [config] type: amun
[2023-07-03 22:13:13] [config] ulr: false
[2023-07-03 22:13:13] [config] ulr-dim-emb: 0
[2023-07-03 22:13:13] [config] ulr-dropout: 0
[2023-07-03 22:13:13] [config] ulr-keys-vectors: ""
[2023-07-03 22:13:13] [config] ulr-query-vectors: ""
[2023-07-03 22:13:13] [config] ulr-softmax-temperature: 1
[2023-07-03 22:13:13] [config] ulr-trainable-transformation: false
[2023-07-03 22:13:13] [config] unlikelihood-loss: false
[2023-07-03 22:13:13] [config] valid-freq: 50000000
[2023-07-03 22:13:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:13:13] [config] valid-max-length: 1000
[2023-07-03 22:13:13] [config] valid-metrics:
[2023-07-03 22:13:13] [config]   - cross-entropy
[2023-07-03 22:13:13] [config]   - translation
[2023-07-03 22:13:13] [config] valid-mini-batch: 32
[2023-07-03 22:13:13] [config] valid-reset-stalled: false
[2023-07-03 22:13:13] [config] valid-script-args:
[2023-07-03 22:13:13] [config]   []
[2023-07-03 22:13:13] [config] valid-script-path: ""
[2023-07-03 22:13:13] [config] valid-sets:
[2023-07-03 22:13:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:13:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:13:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:13:13] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:13] [config] vocabs:
[2023-07-03 22:13:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:13] [config] word-penalty: 0
[2023-07-03 22:13:13] [config] word-scores: false
[2023-07-03 22:13:13] [config] workspace: 2048
[2023-07-03 22:13:13] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:13:13] [training] Using single-device training
[2023-07-03 22:13:16] Synced seed 1234
[2023-07-03 22:13:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:16] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:13:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:16] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:13:16] [valid] No post-processing script given for validating translator
[2023-07-03 22:13:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:13:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:13:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:13:17] [comm] Using global sharding
[2023-07-03 22:13:17] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:13:17] [training] Using 1 GPUs
[2023-07-03 22:13:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-03 22:13:18] Loading Adam parameters
[2023-07-03 22:13:19] [memory] Reserving 754 MB, device gpu0
[2023-07-03 22:13:19] [memory] Reserving 377 MB, device gpu0
[2023-07-03 22:13:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-03 22:13:19] [data] Restoring the corpus state to epoch 3, batch 594
[2023-07-03 22:13:19] [data] Shuffling data
[2023-07-03 22:13:19] [data] Done reading 20,192 sentences
[2023-07-03 22:13:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:13:19] Training started
[2023-07-03 22:13:19] Training finished
[2023-07-03 22:13:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:24] [marian] Running on node19.datos.cluster.uy as process 34099 with command line:
[2023-07-03 22:13:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_nematus.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type nematus
[2023-07-03 22:13:24] [config] after: 0e
[2023-07-03 22:13:24] [config] after-batches: 0
[2023-07-03 22:13:24] [config] after-epochs: 1
[2023-07-03 22:13:24] [config] all-caps-every: 0
[2023-07-03 22:13:24] [config] allow-unk: false
[2023-07-03 22:13:24] [config] authors: false
[2023-07-03 22:13:24] [config] beam-size: 12
[2023-07-03 22:13:24] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:13:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:13:24] [config] bert-masking-fraction: 0.15
[2023-07-03 22:13:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:13:24] [config] bert-train-type-embeddings: true
[2023-07-03 22:13:24] [config] bert-type-vocab-size: 2
[2023-07-03 22:13:24] [config] build-info: ""
[2023-07-03 22:13:24] [config] check-gradient-nan: false
[2023-07-03 22:13:24] [config] check-nan: false
[2023-07-03 22:13:24] [config] cite: false
[2023-07-03 22:13:24] [config] clip-norm: 1
[2023-07-03 22:13:24] [config] cost-scaling:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] cost-type: ce-sum
[2023-07-03 22:13:24] [config] cpu-threads: 0
[2023-07-03 22:13:24] [config] data-threads: 8
[2023-07-03 22:13:24] [config] data-weighting: ""
[2023-07-03 22:13:24] [config] data-weighting-type: sentence
[2023-07-03 22:13:24] [config] dec-cell: gru
[2023-07-03 22:13:24] [config] dec-cell-base-depth: 2
[2023-07-03 22:13:24] [config] dec-cell-high-depth: 1
[2023-07-03 22:13:24] [config] dec-depth: 1
[2023-07-03 22:13:24] [config] devices:
[2023-07-03 22:13:24] [config]   - 0
[2023-07-03 22:13:24] [config] dim-emb: 512
[2023-07-03 22:13:24] [config] dim-rnn: 1024
[2023-07-03 22:13:24] [config] dim-vocabs:
[2023-07-03 22:13:24] [config]   - 0
[2023-07-03 22:13:24] [config]   - 0
[2023-07-03 22:13:24] [config] disp-first: 0
[2023-07-03 22:13:24] [config] disp-freq: 1000u
[2023-07-03 22:13:24] [config] disp-label-counts: true
[2023-07-03 22:13:24] [config] dropout-rnn: 0
[2023-07-03 22:13:24] [config] dropout-src: 0
[2023-07-03 22:13:24] [config] dropout-trg: 0
[2023-07-03 22:13:24] [config] dump-config: ""
[2023-07-03 22:13:24] [config] dynamic-gradient-scaling:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] early-stopping: 10
[2023-07-03 22:13:24] [config] early-stopping-on: first
[2023-07-03 22:13:24] [config] embedding-fix-src: false
[2023-07-03 22:13:24] [config] embedding-fix-trg: false
[2023-07-03 22:13:24] [config] embedding-normalization: false
[2023-07-03 22:13:24] [config] embedding-vectors:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] enc-cell: gru
[2023-07-03 22:13:24] [config] enc-cell-depth: 1
[2023-07-03 22:13:24] [config] enc-depth: 1
[2023-07-03 22:13:24] [config] enc-type: bidirectional
[2023-07-03 22:13:24] [config] english-title-case-every: 0
[2023-07-03 22:13:24] [config] exponential-smoothing: 0
[2023-07-03 22:13:24] [config] factor-weight: 1
[2023-07-03 22:13:24] [config] factors-combine: sum
[2023-07-03 22:13:24] [config] factors-dim-emb: 0
[2023-07-03 22:13:24] [config] gradient-checkpointing: false
[2023-07-03 22:13:24] [config] gradient-norm-average-window: 100
[2023-07-03 22:13:24] [config] guided-alignment: none
[2023-07-03 22:13:24] [config] guided-alignment-cost: mse
[2023-07-03 22:13:24] [config] guided-alignment-weight: 0.1
[2023-07-03 22:13:24] [config] ignore-model-config: false
[2023-07-03 22:13:24] [config] input-types:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] interpolate-env-vars: false
[2023-07-03 22:13:24] [config] keep-best: false
[2023-07-03 22:13:24] [config] label-smoothing: 0
[2023-07-03 22:13:24] [config] layer-normalization: false
[2023-07-03 22:13:24] [config] learn-rate: 0.0001
[2023-07-03 22:13:24] [config] lemma-dependency: ""
[2023-07-03 22:13:24] [config] lemma-dim-emb: 0
[2023-07-03 22:13:24] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:13:24] [config] log-level: info
[2023-07-03 22:13:24] [config] log-time-zone: ""
[2023-07-03 22:13:24] [config] logical-epoch:
[2023-07-03 22:13:24] [config]   - 1e
[2023-07-03 22:13:24] [config]   - 0
[2023-07-03 22:13:24] [config] lr-decay: 0
[2023-07-03 22:13:24] [config] lr-decay-freq: 50000
[2023-07-03 22:13:24] [config] lr-decay-inv-sqrt:
[2023-07-03 22:13:24] [config]   - 0
[2023-07-03 22:13:24] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:13:24] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:13:24] [config] lr-decay-start:
[2023-07-03 22:13:24] [config]   - 10
[2023-07-03 22:13:24] [config]   - 1
[2023-07-03 22:13:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:13:24] [config] lr-report: false
[2023-07-03 22:13:24] [config] lr-warmup: 0
[2023-07-03 22:13:24] [config] lr-warmup-at-reload: false
[2023-07-03 22:13:24] [config] lr-warmup-cycle: false
[2023-07-03 22:13:24] [config] lr-warmup-start-rate: 0
[2023-07-03 22:13:24] [config] max-length: 50
[2023-07-03 22:13:24] [config] max-length-crop: false
[2023-07-03 22:13:24] [config] max-length-factor: 3
[2023-07-03 22:13:24] [config] maxi-batch: 100
[2023-07-03 22:13:24] [config] maxi-batch-sort: trg
[2023-07-03 22:13:24] [config] mini-batch: 64
[2023-07-03 22:13:24] [config] mini-batch-fit: false
[2023-07-03 22:13:24] [config] mini-batch-fit-step: 10
[2023-07-03 22:13:24] [config] mini-batch-round-up: true
[2023-07-03 22:13:24] [config] mini-batch-track-lr: false
[2023-07-03 22:13:24] [config] mini-batch-warmup: 0
[2023-07-03 22:13:24] [config] mini-batch-words: 0
[2023-07-03 22:13:24] [config] mini-batch-words-ref: 0
[2023-07-03 22:13:24] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_nematus.npz
[2023-07-03 22:13:24] [config] multi-loss-type: sum
[2023-07-03 22:13:24] [config] n-best: false
[2023-07-03 22:13:24] [config] no-nccl: false
[2023-07-03 22:13:24] [config] no-reload: false
[2023-07-03 22:13:24] [config] no-restore-corpus: false
[2023-07-03 22:13:24] [config] normalize: 0
[2023-07-03 22:13:24] [config] normalize-gradient: false
[2023-07-03 22:13:24] [config] num-devices: 0
[2023-07-03 22:13:24] [config] optimizer: adam
[2023-07-03 22:13:24] [config] optimizer-delay: 1
[2023-07-03 22:13:24] [config] optimizer-params:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] output-omit-bias: false
[2023-07-03 22:13:24] [config] overwrite: true
[2023-07-03 22:13:24] [config] precision:
[2023-07-03 22:13:24] [config]   - float32
[2023-07-03 22:13:24] [config]   - float32
[2023-07-03 22:13:24] [config] pretrained-model: ""
[2023-07-03 22:13:24] [config] quantize-biases: false
[2023-07-03 22:13:24] [config] quantize-bits: 0
[2023-07-03 22:13:24] [config] quantize-log-based: false
[2023-07-03 22:13:24] [config] quantize-optimization-steps: 0
[2023-07-03 22:13:24] [config] quiet: false
[2023-07-03 22:13:24] [config] quiet-translation: true
[2023-07-03 22:13:24] [config] relative-paths: false
[2023-07-03 22:13:24] [config] right-left: false
[2023-07-03 22:13:24] [config] save-freq: 10000u
[2023-07-03 22:13:24] [config] seed: 1234
[2023-07-03 22:13:24] [config] sentencepiece-alphas:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:13:24] [config] sentencepiece-options: ""
[2023-07-03 22:13:24] [config] sharding: global
[2023-07-03 22:13:24] [config] shuffle: data
[2023-07-03 22:13:24] [config] shuffle-in-ram: false
[2023-07-03 22:13:24] [config] sigterm: save-and-exit
[2023-07-03 22:13:24] [config] skip: false
[2023-07-03 22:13:24] [config] sqlite: ""
[2023-07-03 22:13:24] [config] sqlite-drop: false
[2023-07-03 22:13:24] [config] sync-freq: 200u
[2023-07-03 22:13:24] [config] sync-sgd: false
[2023-07-03 22:13:24] [config] tempdir: /tmp
[2023-07-03 22:13:24] [config] tied-embeddings: false
[2023-07-03 22:13:24] [config] tied-embeddings-all: false
[2023-07-03 22:13:24] [config] tied-embeddings-src: false
[2023-07-03 22:13:24] [config] train-embedder-rank:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] train-sets:
[2023-07-03 22:13:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:13:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:13:24] [config] transformer-aan-activation: swish
[2023-07-03 22:13:24] [config] transformer-aan-depth: 2
[2023-07-03 22:13:24] [config] transformer-aan-nogate: false
[2023-07-03 22:13:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:13:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:13:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:13:24] [config] transformer-depth-scaling: false
[2023-07-03 22:13:24] [config] transformer-dim-aan: 2048
[2023-07-03 22:13:24] [config] transformer-dim-ffn: 2048
[2023-07-03 22:13:24] [config] transformer-dropout: 0
[2023-07-03 22:13:24] [config] transformer-dropout-attention: 0
[2023-07-03 22:13:24] [config] transformer-dropout-ffn: 0
[2023-07-03 22:13:24] [config] transformer-ffn-activation: swish
[2023-07-03 22:13:24] [config] transformer-ffn-depth: 2
[2023-07-03 22:13:24] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:13:24] [config] transformer-heads: 8
[2023-07-03 22:13:24] [config] transformer-no-projection: false
[2023-07-03 22:13:24] [config] transformer-pool: false
[2023-07-03 22:13:24] [config] transformer-postprocess: dan
[2023-07-03 22:13:24] [config] transformer-postprocess-emb: d
[2023-07-03 22:13:24] [config] transformer-postprocess-top: ""
[2023-07-03 22:13:24] [config] transformer-preprocess: ""
[2023-07-03 22:13:24] [config] transformer-tied-layers:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] transformer-train-position-embeddings: false
[2023-07-03 22:13:24] [config] tsv: false
[2023-07-03 22:13:24] [config] tsv-fields: 0
[2023-07-03 22:13:24] [config] type: nematus
[2023-07-03 22:13:24] [config] ulr: false
[2023-07-03 22:13:24] [config] ulr-dim-emb: 0
[2023-07-03 22:13:24] [config] ulr-dropout: 0
[2023-07-03 22:13:24] [config] ulr-keys-vectors: ""
[2023-07-03 22:13:24] [config] ulr-query-vectors: ""
[2023-07-03 22:13:24] [config] ulr-softmax-temperature: 1
[2023-07-03 22:13:24] [config] ulr-trainable-transformation: false
[2023-07-03 22:13:24] [config] unlikelihood-loss: false
[2023-07-03 22:13:24] [config] valid-freq: 50000000
[2023-07-03 22:13:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:13:24] [config] valid-max-length: 1000
[2023-07-03 22:13:24] [config] valid-metrics:
[2023-07-03 22:13:24] [config]   - cross-entropy
[2023-07-03 22:13:24] [config]   - translation
[2023-07-03 22:13:24] [config] valid-mini-batch: 32
[2023-07-03 22:13:24] [config] valid-reset-stalled: false
[2023-07-03 22:13:24] [config] valid-script-args:
[2023-07-03 22:13:24] [config]   []
[2023-07-03 22:13:24] [config] valid-script-path: ""
[2023-07-03 22:13:24] [config] valid-sets:
[2023-07-03 22:13:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:13:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:13:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:13:24] [config] vocabs:
[2023-07-03 22:13:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:24] [config] word-penalty: 0
[2023-07-03 22:13:24] [config] word-scores: false
[2023-07-03 22:13:24] [config] workspace: 2048
[2023-07-03 22:13:24] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:13:24] [training] Using single-device training
[2023-07-03 22:13:25] Synced seed 1234
[2023-07-03 22:13:25] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:25] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:13:25] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:25] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:13:25] Error: --type nematus does not support other rnn cells than gru-nematus, use --type s2s
[2023-07-03 22:13:25] Error: Aborted from marian::Nematus::Nematus(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/nematus.h:16

[CALL STACK]
[0x55f5c28811e9]    marian::Nematus::  Nematus  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x599
[0x55f5c27c16e3]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0xa53
[0x55f5c27c51a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55f5c27cc2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55f5c29a175f]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x123f
[0x55f5c29af348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55f5c2454b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55f5c23762c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55f5c232db9c]    main                                               + 0x3c
[0x7f75d70360b3]    __libc_start_main                                  + 0xf3
[0x55f5c2374cbe]    _start                                             + 0x2e

[2023-07-03 22:13:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:28] [marian] Running on node19.datos.cluster.uy as process 34123 with command line:
[2023-07-03 22:13:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_nematus.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type nematus
[2023-07-03 22:13:28] [config] after: 0e
[2023-07-03 22:13:28] [config] after-batches: 0
[2023-07-03 22:13:28] [config] after-epochs: 2
[2023-07-03 22:13:28] [config] all-caps-every: 0
[2023-07-03 22:13:28] [config] allow-unk: false
[2023-07-03 22:13:28] [config] authors: false
[2023-07-03 22:13:28] [config] beam-size: 12
[2023-07-03 22:13:28] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:13:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:13:28] [config] bert-masking-fraction: 0.15
[2023-07-03 22:13:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:13:28] [config] bert-train-type-embeddings: true
[2023-07-03 22:13:28] [config] bert-type-vocab-size: 2
[2023-07-03 22:13:28] [config] build-info: ""
[2023-07-03 22:13:28] [config] check-gradient-nan: false
[2023-07-03 22:13:28] [config] check-nan: false
[2023-07-03 22:13:28] [config] cite: false
[2023-07-03 22:13:28] [config] clip-norm: 1
[2023-07-03 22:13:28] [config] cost-scaling:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] cost-type: ce-sum
[2023-07-03 22:13:28] [config] cpu-threads: 0
[2023-07-03 22:13:28] [config] data-threads: 8
[2023-07-03 22:13:28] [config] data-weighting: ""
[2023-07-03 22:13:28] [config] data-weighting-type: sentence
[2023-07-03 22:13:28] [config] dec-cell: gru
[2023-07-03 22:13:28] [config] dec-cell-base-depth: 2
[2023-07-03 22:13:28] [config] dec-cell-high-depth: 1
[2023-07-03 22:13:28] [config] dec-depth: 1
[2023-07-03 22:13:28] [config] devices:
[2023-07-03 22:13:28] [config]   - 0
[2023-07-03 22:13:28] [config] dim-emb: 512
[2023-07-03 22:13:28] [config] dim-rnn: 1024
[2023-07-03 22:13:28] [config] dim-vocabs:
[2023-07-03 22:13:28] [config]   - 0
[2023-07-03 22:13:28] [config]   - 0
[2023-07-03 22:13:28] [config] disp-first: 0
[2023-07-03 22:13:28] [config] disp-freq: 1000u
[2023-07-03 22:13:28] [config] disp-label-counts: true
[2023-07-03 22:13:28] [config] dropout-rnn: 0
[2023-07-03 22:13:28] [config] dropout-src: 0
[2023-07-03 22:13:28] [config] dropout-trg: 0
[2023-07-03 22:13:28] [config] dump-config: ""
[2023-07-03 22:13:28] [config] dynamic-gradient-scaling:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] early-stopping: 10
[2023-07-03 22:13:28] [config] early-stopping-on: first
[2023-07-03 22:13:28] [config] embedding-fix-src: false
[2023-07-03 22:13:28] [config] embedding-fix-trg: false
[2023-07-03 22:13:28] [config] embedding-normalization: false
[2023-07-03 22:13:28] [config] embedding-vectors:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] enc-cell: gru
[2023-07-03 22:13:28] [config] enc-cell-depth: 1
[2023-07-03 22:13:28] [config] enc-depth: 1
[2023-07-03 22:13:28] [config] enc-type: bidirectional
[2023-07-03 22:13:28] [config] english-title-case-every: 0
[2023-07-03 22:13:28] [config] exponential-smoothing: 0
[2023-07-03 22:13:28] [config] factor-weight: 1
[2023-07-03 22:13:28] [config] factors-combine: sum
[2023-07-03 22:13:28] [config] factors-dim-emb: 0
[2023-07-03 22:13:28] [config] gradient-checkpointing: false
[2023-07-03 22:13:28] [config] gradient-norm-average-window: 100
[2023-07-03 22:13:28] [config] guided-alignment: none
[2023-07-03 22:13:28] [config] guided-alignment-cost: mse
[2023-07-03 22:13:28] [config] guided-alignment-weight: 0.1
[2023-07-03 22:13:28] [config] ignore-model-config: false
[2023-07-03 22:13:28] [config] input-types:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] interpolate-env-vars: false
[2023-07-03 22:13:28] [config] keep-best: false
[2023-07-03 22:13:28] [config] label-smoothing: 0
[2023-07-03 22:13:28] [config] layer-normalization: false
[2023-07-03 22:13:28] [config] learn-rate: 0.0001
[2023-07-03 22:13:28] [config] lemma-dependency: ""
[2023-07-03 22:13:28] [config] lemma-dim-emb: 0
[2023-07-03 22:13:28] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:13:28] [config] log-level: info
[2023-07-03 22:13:28] [config] log-time-zone: ""
[2023-07-03 22:13:28] [config] logical-epoch:
[2023-07-03 22:13:28] [config]   - 1e
[2023-07-03 22:13:28] [config]   - 0
[2023-07-03 22:13:28] [config] lr-decay: 0
[2023-07-03 22:13:28] [config] lr-decay-freq: 50000
[2023-07-03 22:13:28] [config] lr-decay-inv-sqrt:
[2023-07-03 22:13:28] [config]   - 0
[2023-07-03 22:13:28] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:13:28] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:13:28] [config] lr-decay-start:
[2023-07-03 22:13:28] [config]   - 10
[2023-07-03 22:13:28] [config]   - 1
[2023-07-03 22:13:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:13:28] [config] lr-report: false
[2023-07-03 22:13:28] [config] lr-warmup: 0
[2023-07-03 22:13:28] [config] lr-warmup-at-reload: false
[2023-07-03 22:13:28] [config] lr-warmup-cycle: false
[2023-07-03 22:13:28] [config] lr-warmup-start-rate: 0
[2023-07-03 22:13:28] [config] max-length: 50
[2023-07-03 22:13:28] [config] max-length-crop: false
[2023-07-03 22:13:28] [config] max-length-factor: 3
[2023-07-03 22:13:28] [config] maxi-batch: 100
[2023-07-03 22:13:28] [config] maxi-batch-sort: trg
[2023-07-03 22:13:28] [config] mini-batch: 64
[2023-07-03 22:13:28] [config] mini-batch-fit: false
[2023-07-03 22:13:28] [config] mini-batch-fit-step: 10
[2023-07-03 22:13:28] [config] mini-batch-round-up: true
[2023-07-03 22:13:28] [config] mini-batch-track-lr: false
[2023-07-03 22:13:28] [config] mini-batch-warmup: 0
[2023-07-03 22:13:28] [config] mini-batch-words: 0
[2023-07-03 22:13:28] [config] mini-batch-words-ref: 0
[2023-07-03 22:13:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_nematus.npz
[2023-07-03 22:13:28] [config] multi-loss-type: sum
[2023-07-03 22:13:28] [config] n-best: false
[2023-07-03 22:13:28] [config] no-nccl: false
[2023-07-03 22:13:28] [config] no-reload: false
[2023-07-03 22:13:28] [config] no-restore-corpus: false
[2023-07-03 22:13:28] [config] normalize: 0
[2023-07-03 22:13:28] [config] normalize-gradient: false
[2023-07-03 22:13:28] [config] num-devices: 0
[2023-07-03 22:13:28] [config] optimizer: adam
[2023-07-03 22:13:28] [config] optimizer-delay: 1
[2023-07-03 22:13:28] [config] optimizer-params:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] output-omit-bias: false
[2023-07-03 22:13:28] [config] overwrite: true
[2023-07-03 22:13:28] [config] precision:
[2023-07-03 22:13:28] [config]   - float32
[2023-07-03 22:13:28] [config]   - float32
[2023-07-03 22:13:28] [config] pretrained-model: ""
[2023-07-03 22:13:28] [config] quantize-biases: false
[2023-07-03 22:13:28] [config] quantize-bits: 0
[2023-07-03 22:13:28] [config] quantize-log-based: false
[2023-07-03 22:13:28] [config] quantize-optimization-steps: 0
[2023-07-03 22:13:28] [config] quiet: false
[2023-07-03 22:13:28] [config] quiet-translation: true
[2023-07-03 22:13:28] [config] relative-paths: false
[2023-07-03 22:13:28] [config] right-left: false
[2023-07-03 22:13:28] [config] save-freq: 10000u
[2023-07-03 22:13:28] [config] seed: 1234
[2023-07-03 22:13:28] [config] sentencepiece-alphas:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:13:28] [config] sentencepiece-options: ""
[2023-07-03 22:13:28] [config] sharding: global
[2023-07-03 22:13:28] [config] shuffle: data
[2023-07-03 22:13:28] [config] shuffle-in-ram: false
[2023-07-03 22:13:28] [config] sigterm: save-and-exit
[2023-07-03 22:13:28] [config] skip: false
[2023-07-03 22:13:28] [config] sqlite: ""
[2023-07-03 22:13:28] [config] sqlite-drop: false
[2023-07-03 22:13:28] [config] sync-freq: 200u
[2023-07-03 22:13:28] [config] sync-sgd: false
[2023-07-03 22:13:28] [config] tempdir: /tmp
[2023-07-03 22:13:28] [config] tied-embeddings: false
[2023-07-03 22:13:28] [config] tied-embeddings-all: false
[2023-07-03 22:13:28] [config] tied-embeddings-src: false
[2023-07-03 22:13:28] [config] train-embedder-rank:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] train-sets:
[2023-07-03 22:13:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:13:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:13:28] [config] transformer-aan-activation: swish
[2023-07-03 22:13:28] [config] transformer-aan-depth: 2
[2023-07-03 22:13:28] [config] transformer-aan-nogate: false
[2023-07-03 22:13:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:13:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:13:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:13:28] [config] transformer-depth-scaling: false
[2023-07-03 22:13:28] [config] transformer-dim-aan: 2048
[2023-07-03 22:13:28] [config] transformer-dim-ffn: 2048
[2023-07-03 22:13:28] [config] transformer-dropout: 0
[2023-07-03 22:13:28] [config] transformer-dropout-attention: 0
[2023-07-03 22:13:28] [config] transformer-dropout-ffn: 0
[2023-07-03 22:13:28] [config] transformer-ffn-activation: swish
[2023-07-03 22:13:28] [config] transformer-ffn-depth: 2
[2023-07-03 22:13:28] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:13:28] [config] transformer-heads: 8
[2023-07-03 22:13:28] [config] transformer-no-projection: false
[2023-07-03 22:13:28] [config] transformer-pool: false
[2023-07-03 22:13:28] [config] transformer-postprocess: dan
[2023-07-03 22:13:28] [config] transformer-postprocess-emb: d
[2023-07-03 22:13:28] [config] transformer-postprocess-top: ""
[2023-07-03 22:13:28] [config] transformer-preprocess: ""
[2023-07-03 22:13:28] [config] transformer-tied-layers:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] transformer-train-position-embeddings: false
[2023-07-03 22:13:28] [config] tsv: false
[2023-07-03 22:13:28] [config] tsv-fields: 0
[2023-07-03 22:13:28] [config] type: nematus
[2023-07-03 22:13:28] [config] ulr: false
[2023-07-03 22:13:28] [config] ulr-dim-emb: 0
[2023-07-03 22:13:28] [config] ulr-dropout: 0
[2023-07-03 22:13:28] [config] ulr-keys-vectors: ""
[2023-07-03 22:13:28] [config] ulr-query-vectors: ""
[2023-07-03 22:13:28] [config] ulr-softmax-temperature: 1
[2023-07-03 22:13:28] [config] ulr-trainable-transformation: false
[2023-07-03 22:13:28] [config] unlikelihood-loss: false
[2023-07-03 22:13:28] [config] valid-freq: 50000000
[2023-07-03 22:13:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:13:28] [config] valid-max-length: 1000
[2023-07-03 22:13:28] [config] valid-metrics:
[2023-07-03 22:13:28] [config]   - cross-entropy
[2023-07-03 22:13:28] [config]   - translation
[2023-07-03 22:13:28] [config] valid-mini-batch: 32
[2023-07-03 22:13:28] [config] valid-reset-stalled: false
[2023-07-03 22:13:28] [config] valid-script-args:
[2023-07-03 22:13:28] [config]   []
[2023-07-03 22:13:28] [config] valid-script-path: ""
[2023-07-03 22:13:28] [config] valid-sets:
[2023-07-03 22:13:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:13:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:13:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:13:28] [config] vocabs:
[2023-07-03 22:13:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:28] [config] word-penalty: 0
[2023-07-03 22:13:28] [config] word-scores: false
[2023-07-03 22:13:28] [config] workspace: 2048
[2023-07-03 22:13:28] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:13:28] [training] Using single-device training
[2023-07-03 22:13:28] Synced seed 1234
[2023-07-03 22:13:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:28] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:13:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:28] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:13:28] Error: --type nematus does not support other rnn cells than gru-nematus, use --type s2s
[2023-07-03 22:13:28] Error: Aborted from marian::Nematus::Nematus(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/nematus.h:16

[CALL STACK]
[0x5597f14a01e9]    marian::Nematus::  Nematus  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x599
[0x5597f13e06e3]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0xa53
[0x5597f13e41a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5597f13eb2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5597f15c075f]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x123f
[0x5597f15ce348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x5597f1073b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x5597f0f952c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5597f0f4cb9c]    main                                               + 0x3c
[0x7ff2153c30b3]    __libc_start_main                                  + 0xf3
[0x5597f0f93cbe]    _start                                             + 0x2e

[2023-07-03 22:13:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:32] [marian] Running on node19.datos.cluster.uy as process 34150 with command line:
[2023-07-03 22:13:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-03 22:13:32] [config] after: 0e
[2023-07-03 22:13:32] [config] after-batches: 0
[2023-07-03 22:13:32] [config] after-epochs: 1
[2023-07-03 22:13:32] [config] all-caps-every: 0
[2023-07-03 22:13:32] [config] allow-unk: false
[2023-07-03 22:13:32] [config] authors: false
[2023-07-03 22:13:32] [config] beam-size: 12
[2023-07-03 22:13:32] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:13:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:13:32] [config] bert-masking-fraction: 0.15
[2023-07-03 22:13:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:13:32] [config] bert-train-type-embeddings: true
[2023-07-03 22:13:32] [config] bert-type-vocab-size: 2
[2023-07-03 22:13:32] [config] build-info: ""
[2023-07-03 22:13:32] [config] check-gradient-nan: false
[2023-07-03 22:13:32] [config] check-nan: false
[2023-07-03 22:13:32] [config] cite: false
[2023-07-03 22:13:32] [config] clip-norm: 1
[2023-07-03 22:13:32] [config] cost-scaling:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] cost-type: ce-sum
[2023-07-03 22:13:32] [config] cpu-threads: 0
[2023-07-03 22:13:32] [config] data-threads: 8
[2023-07-03 22:13:32] [config] data-weighting: ""
[2023-07-03 22:13:32] [config] data-weighting-type: sentence
[2023-07-03 22:13:32] [config] dec-cell: gru
[2023-07-03 22:13:32] [config] dec-cell-base-depth: 2
[2023-07-03 22:13:32] [config] dec-cell-high-depth: 1
[2023-07-03 22:13:32] [config] dec-depth: 1
[2023-07-03 22:13:32] [config] devices:
[2023-07-03 22:13:32] [config]   - 0
[2023-07-03 22:13:32] [config] dim-emb: 512
[2023-07-03 22:13:32] [config] dim-rnn: 1024
[2023-07-03 22:13:32] [config] dim-vocabs:
[2023-07-03 22:13:32] [config]   - 0
[2023-07-03 22:13:32] [config]   - 0
[2023-07-03 22:13:32] [config] disp-first: 0
[2023-07-03 22:13:32] [config] disp-freq: 1000u
[2023-07-03 22:13:32] [config] disp-label-counts: true
[2023-07-03 22:13:32] [config] dropout-rnn: 0
[2023-07-03 22:13:32] [config] dropout-src: 0
[2023-07-03 22:13:32] [config] dropout-trg: 0
[2023-07-03 22:13:32] [config] dump-config: ""
[2023-07-03 22:13:32] [config] dynamic-gradient-scaling:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] early-stopping: 10
[2023-07-03 22:13:32] [config] early-stopping-on: first
[2023-07-03 22:13:32] [config] embedding-fix-src: false
[2023-07-03 22:13:32] [config] embedding-fix-trg: false
[2023-07-03 22:13:32] [config] embedding-normalization: false
[2023-07-03 22:13:32] [config] embedding-vectors:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] enc-cell: gru
[2023-07-03 22:13:32] [config] enc-cell-depth: 1
[2023-07-03 22:13:32] [config] enc-depth: 1
[2023-07-03 22:13:32] [config] enc-type: bidirectional
[2023-07-03 22:13:32] [config] english-title-case-every: 0
[2023-07-03 22:13:32] [config] exponential-smoothing: 0
[2023-07-03 22:13:32] [config] factor-weight: 1
[2023-07-03 22:13:32] [config] factors-combine: sum
[2023-07-03 22:13:32] [config] factors-dim-emb: 0
[2023-07-03 22:13:32] [config] gradient-checkpointing: false
[2023-07-03 22:13:32] [config] gradient-norm-average-window: 100
[2023-07-03 22:13:32] [config] guided-alignment: none
[2023-07-03 22:13:32] [config] guided-alignment-cost: mse
[2023-07-03 22:13:32] [config] guided-alignment-weight: 0.1
[2023-07-03 22:13:32] [config] ignore-model-config: false
[2023-07-03 22:13:32] [config] input-types:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] interpolate-env-vars: false
[2023-07-03 22:13:32] [config] keep-best: false
[2023-07-03 22:13:32] [config] label-smoothing: 0
[2023-07-03 22:13:32] [config] layer-normalization: false
[2023-07-03 22:13:32] [config] learn-rate: 0.0001
[2023-07-03 22:13:32] [config] lemma-dependency: ""
[2023-07-03 22:13:32] [config] lemma-dim-emb: 0
[2023-07-03 22:13:32] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:13:32] [config] log-level: info
[2023-07-03 22:13:32] [config] log-time-zone: ""
[2023-07-03 22:13:32] [config] logical-epoch:
[2023-07-03 22:13:32] [config]   - 1e
[2023-07-03 22:13:32] [config]   - 0
[2023-07-03 22:13:32] [config] lr-decay: 0
[2023-07-03 22:13:32] [config] lr-decay-freq: 50000
[2023-07-03 22:13:32] [config] lr-decay-inv-sqrt:
[2023-07-03 22:13:32] [config]   - 0
[2023-07-03 22:13:32] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:13:32] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:13:32] [config] lr-decay-start:
[2023-07-03 22:13:32] [config]   - 10
[2023-07-03 22:13:32] [config]   - 1
[2023-07-03 22:13:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:13:32] [config] lr-report: false
[2023-07-03 22:13:32] [config] lr-warmup: 0
[2023-07-03 22:13:32] [config] lr-warmup-at-reload: false
[2023-07-03 22:13:32] [config] lr-warmup-cycle: false
[2023-07-03 22:13:32] [config] lr-warmup-start-rate: 0
[2023-07-03 22:13:32] [config] max-length: 50
[2023-07-03 22:13:32] [config] max-length-crop: false
[2023-07-03 22:13:32] [config] max-length-factor: 3
[2023-07-03 22:13:32] [config] maxi-batch: 100
[2023-07-03 22:13:32] [config] maxi-batch-sort: trg
[2023-07-03 22:13:32] [config] mini-batch: 64
[2023-07-03 22:13:32] [config] mini-batch-fit: false
[2023-07-03 22:13:32] [config] mini-batch-fit-step: 10
[2023-07-03 22:13:32] [config] mini-batch-round-up: true
[2023-07-03 22:13:32] [config] mini-batch-track-lr: false
[2023-07-03 22:13:32] [config] mini-batch-warmup: 0
[2023-07-03 22:13:32] [config] mini-batch-words: 0
[2023-07-03 22:13:32] [config] mini-batch-words-ref: 0
[2023-07-03 22:13:32] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-03 22:13:32] [config] multi-loss-type: sum
[2023-07-03 22:13:32] [config] n-best: false
[2023-07-03 22:13:32] [config] no-nccl: false
[2023-07-03 22:13:32] [config] no-reload: false
[2023-07-03 22:13:32] [config] no-restore-corpus: false
[2023-07-03 22:13:32] [config] normalize: 0
[2023-07-03 22:13:32] [config] normalize-gradient: false
[2023-07-03 22:13:32] [config] num-devices: 0
[2023-07-03 22:13:32] [config] optimizer: adam
[2023-07-03 22:13:32] [config] optimizer-delay: 1
[2023-07-03 22:13:32] [config] optimizer-params:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] output-omit-bias: false
[2023-07-03 22:13:32] [config] overwrite: true
[2023-07-03 22:13:32] [config] precision:
[2023-07-03 22:13:32] [config]   - float32
[2023-07-03 22:13:32] [config]   - float32
[2023-07-03 22:13:32] [config] pretrained-model: ""
[2023-07-03 22:13:32] [config] quantize-biases: false
[2023-07-03 22:13:32] [config] quantize-bits: 0
[2023-07-03 22:13:32] [config] quantize-log-based: false
[2023-07-03 22:13:32] [config] quantize-optimization-steps: 0
[2023-07-03 22:13:32] [config] quiet: false
[2023-07-03 22:13:32] [config] quiet-translation: true
[2023-07-03 22:13:32] [config] relative-paths: false
[2023-07-03 22:13:32] [config] right-left: false
[2023-07-03 22:13:32] [config] save-freq: 10000u
[2023-07-03 22:13:32] [config] seed: 1234
[2023-07-03 22:13:32] [config] sentencepiece-alphas:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:13:32] [config] sentencepiece-options: ""
[2023-07-03 22:13:32] [config] sharding: global
[2023-07-03 22:13:32] [config] shuffle: data
[2023-07-03 22:13:32] [config] shuffle-in-ram: false
[2023-07-03 22:13:32] [config] sigterm: save-and-exit
[2023-07-03 22:13:32] [config] skip: false
[2023-07-03 22:13:32] [config] sqlite: ""
[2023-07-03 22:13:32] [config] sqlite-drop: false
[2023-07-03 22:13:32] [config] sync-freq: 200u
[2023-07-03 22:13:32] [config] sync-sgd: false
[2023-07-03 22:13:32] [config] tempdir: /tmp
[2023-07-03 22:13:32] [config] tied-embeddings: false
[2023-07-03 22:13:32] [config] tied-embeddings-all: false
[2023-07-03 22:13:32] [config] tied-embeddings-src: false
[2023-07-03 22:13:32] [config] train-embedder-rank:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] train-sets:
[2023-07-03 22:13:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:13:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:13:32] [config] transformer-aan-activation: swish
[2023-07-03 22:13:32] [config] transformer-aan-depth: 2
[2023-07-03 22:13:32] [config] transformer-aan-nogate: false
[2023-07-03 22:13:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:13:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:13:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:13:32] [config] transformer-depth-scaling: false
[2023-07-03 22:13:32] [config] transformer-dim-aan: 2048
[2023-07-03 22:13:32] [config] transformer-dim-ffn: 2048
[2023-07-03 22:13:32] [config] transformer-dropout: 0
[2023-07-03 22:13:32] [config] transformer-dropout-attention: 0
[2023-07-03 22:13:32] [config] transformer-dropout-ffn: 0
[2023-07-03 22:13:32] [config] transformer-ffn-activation: swish
[2023-07-03 22:13:32] [config] transformer-ffn-depth: 2
[2023-07-03 22:13:32] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:13:32] [config] transformer-heads: 8
[2023-07-03 22:13:32] [config] transformer-no-projection: false
[2023-07-03 22:13:32] [config] transformer-pool: false
[2023-07-03 22:13:32] [config] transformer-postprocess: dan
[2023-07-03 22:13:32] [config] transformer-postprocess-emb: d
[2023-07-03 22:13:32] [config] transformer-postprocess-top: ""
[2023-07-03 22:13:32] [config] transformer-preprocess: ""
[2023-07-03 22:13:32] [config] transformer-tied-layers:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] transformer-train-position-embeddings: false
[2023-07-03 22:13:32] [config] tsv: false
[2023-07-03 22:13:32] [config] tsv-fields: 0
[2023-07-03 22:13:32] [config] type: s2s
[2023-07-03 22:13:32] [config] ulr: false
[2023-07-03 22:13:32] [config] ulr-dim-emb: 0
[2023-07-03 22:13:32] [config] ulr-dropout: 0
[2023-07-03 22:13:32] [config] ulr-keys-vectors: ""
[2023-07-03 22:13:32] [config] ulr-query-vectors: ""
[2023-07-03 22:13:32] [config] ulr-softmax-temperature: 1
[2023-07-03 22:13:32] [config] ulr-trainable-transformation: false
[2023-07-03 22:13:32] [config] unlikelihood-loss: false
[2023-07-03 22:13:32] [config] valid-freq: 50000000
[2023-07-03 22:13:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:13:32] [config] valid-max-length: 1000
[2023-07-03 22:13:32] [config] valid-metrics:
[2023-07-03 22:13:32] [config]   - cross-entropy
[2023-07-03 22:13:32] [config]   - translation
[2023-07-03 22:13:32] [config] valid-mini-batch: 32
[2023-07-03 22:13:32] [config] valid-reset-stalled: false
[2023-07-03 22:13:32] [config] valid-script-args:
[2023-07-03 22:13:32] [config]   []
[2023-07-03 22:13:32] [config] valid-script-path: ""
[2023-07-03 22:13:32] [config] valid-sets:
[2023-07-03 22:13:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:13:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:13:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:13:32] [config] vocabs:
[2023-07-03 22:13:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:32] [config] word-penalty: 0
[2023-07-03 22:13:32] [config] word-scores: false
[2023-07-03 22:13:32] [config] workspace: 2048
[2023-07-03 22:13:32] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:13:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:13:32] [training] Using single-device training
[2023-07-03 22:13:32] Synced seed 1234
[2023-07-03 22:13:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:13:32] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:13:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:13:32] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:13:32] [valid] No post-processing script given for validating translator
[2023-07-03 22:13:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:13:33] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:13:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:13:33] [comm] Using global sharding
[2023-07-03 22:13:33] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:13:33] [training] Using 1 GPUs
[2023-07-03 22:13:33] Training started
[2023-07-03 22:13:33] [data] Shuffling data
[2023-07-03 22:13:33] [data] Done reading 20,192 sentences
[2023-07-03 22:13:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:13:33] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 22:13:33] [logits] Applying loss function for 1 factor(s)
[2023-07-03 22:13:33] [memory] Reserving 377 MB, device gpu0
[2023-07-03 22:13:37] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 22:13:37] [memory] Reserving 377 MB, device gpu0
[2023-07-03 22:13:38] Parameter type float32, optimization type float32, casting types false
[2023-07-03 22:13:38] Allocating memory for Adam-specific shards
[2023-07-03 22:13:38] [memory] Reserving 754 MB, device gpu0
[2023-07-03 22:14:17] Seen 18,843 samples
[2023-07-03 22:14:17] Starting data epoch 2 in logical epoch 2
[2023-07-03 22:14:17] Training finished
[2023-07-03 22:14:22] [valid] Ep. 2 : Up. 297 : cross-entropy : 128.187 : new best
[2023-07-03 22:16:02] [valid] Ep. 2 : Up. 297 : translation : 0 : new best
[2023-07-03 22:16:02] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-03 22:16:06] Saving Adam parameters
[2023-07-03 22:16:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-03 22:16:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:16:20] [marian] Running on node19.datos.cluster.uy as process 34432 with command line:
[2023-07-03 22:16:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-03 22:16:20] [config] after: 0e
[2023-07-03 22:16:20] [config] after-batches: 0
[2023-07-03 22:16:20] [config] after-epochs: 2
[2023-07-03 22:16:20] [config] all-caps-every: 0
[2023-07-03 22:16:20] [config] allow-unk: false
[2023-07-03 22:16:20] [config] authors: false
[2023-07-03 22:16:20] [config] beam-size: 12
[2023-07-03 22:16:20] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:16:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:16:20] [config] bert-masking-fraction: 0.15
[2023-07-03 22:16:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:16:20] [config] bert-train-type-embeddings: true
[2023-07-03 22:16:20] [config] bert-type-vocab-size: 2
[2023-07-03 22:16:20] [config] build-info: ""
[2023-07-03 22:16:20] [config] check-gradient-nan: false
[2023-07-03 22:16:20] [config] check-nan: false
[2023-07-03 22:16:20] [config] cite: false
[2023-07-03 22:16:20] [config] clip-norm: 1
[2023-07-03 22:16:20] [config] cost-scaling:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] cost-type: ce-sum
[2023-07-03 22:16:20] [config] cpu-threads: 0
[2023-07-03 22:16:20] [config] data-threads: 8
[2023-07-03 22:16:20] [config] data-weighting: ""
[2023-07-03 22:16:20] [config] data-weighting-type: sentence
[2023-07-03 22:16:20] [config] dec-cell: gru
[2023-07-03 22:16:20] [config] dec-cell-base-depth: 2
[2023-07-03 22:16:20] [config] dec-cell-high-depth: 1
[2023-07-03 22:16:20] [config] dec-depth: 1
[2023-07-03 22:16:20] [config] devices:
[2023-07-03 22:16:20] [config]   - 0
[2023-07-03 22:16:20] [config] dim-emb: 512
[2023-07-03 22:16:20] [config] dim-rnn: 1024
[2023-07-03 22:16:20] [config] dim-vocabs:
[2023-07-03 22:16:20] [config]   - 54042
[2023-07-03 22:16:20] [config]   - 36507
[2023-07-03 22:16:20] [config] disp-first: 0
[2023-07-03 22:16:20] [config] disp-freq: 1000u
[2023-07-03 22:16:20] [config] disp-label-counts: true
[2023-07-03 22:16:20] [config] dropout-rnn: 0
[2023-07-03 22:16:20] [config] dropout-src: 0
[2023-07-03 22:16:20] [config] dropout-trg: 0
[2023-07-03 22:16:20] [config] dump-config: ""
[2023-07-03 22:16:20] [config] dynamic-gradient-scaling:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] early-stopping: 10
[2023-07-03 22:16:20] [config] early-stopping-on: first
[2023-07-03 22:16:20] [config] embedding-fix-src: false
[2023-07-03 22:16:20] [config] embedding-fix-trg: false
[2023-07-03 22:16:20] [config] embedding-normalization: false
[2023-07-03 22:16:20] [config] embedding-vectors:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] enc-cell: gru
[2023-07-03 22:16:20] [config] enc-cell-depth: 1
[2023-07-03 22:16:20] [config] enc-depth: 1
[2023-07-03 22:16:20] [config] enc-type: bidirectional
[2023-07-03 22:16:20] [config] english-title-case-every: 0
[2023-07-03 22:16:20] [config] exponential-smoothing: 0
[2023-07-03 22:16:20] [config] factor-weight: 1
[2023-07-03 22:16:20] [config] factors-combine: sum
[2023-07-03 22:16:20] [config] factors-dim-emb: 0
[2023-07-03 22:16:20] [config] gradient-checkpointing: false
[2023-07-03 22:16:20] [config] gradient-norm-average-window: 100
[2023-07-03 22:16:20] [config] guided-alignment: none
[2023-07-03 22:16:20] [config] guided-alignment-cost: mse
[2023-07-03 22:16:20] [config] guided-alignment-weight: 0.1
[2023-07-03 22:16:20] [config] ignore-model-config: false
[2023-07-03 22:16:20] [config] input-types:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] interpolate-env-vars: false
[2023-07-03 22:16:20] [config] keep-best: false
[2023-07-03 22:16:20] [config] label-smoothing: 0
[2023-07-03 22:16:20] [config] layer-normalization: false
[2023-07-03 22:16:20] [config] learn-rate: 0.0001
[2023-07-03 22:16:20] [config] lemma-dependency: ""
[2023-07-03 22:16:20] [config] lemma-dim-emb: 0
[2023-07-03 22:16:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:16:20] [config] log-level: info
[2023-07-03 22:16:20] [config] log-time-zone: ""
[2023-07-03 22:16:20] [config] logical-epoch:
[2023-07-03 22:16:20] [config]   - 1e
[2023-07-03 22:16:20] [config]   - 0
[2023-07-03 22:16:20] [config] lr-decay: 0
[2023-07-03 22:16:20] [config] lr-decay-freq: 50000
[2023-07-03 22:16:20] [config] lr-decay-inv-sqrt:
[2023-07-03 22:16:20] [config]   - 0
[2023-07-03 22:16:20] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:16:20] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:16:20] [config] lr-decay-start:
[2023-07-03 22:16:20] [config]   - 10
[2023-07-03 22:16:20] [config]   - 1
[2023-07-03 22:16:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:16:20] [config] lr-report: false
[2023-07-03 22:16:20] [config] lr-warmup: 0
[2023-07-03 22:16:20] [config] lr-warmup-at-reload: false
[2023-07-03 22:16:20] [config] lr-warmup-cycle: false
[2023-07-03 22:16:20] [config] lr-warmup-start-rate: 0
[2023-07-03 22:16:20] [config] max-length: 50
[2023-07-03 22:16:20] [config] max-length-crop: false
[2023-07-03 22:16:20] [config] max-length-factor: 3
[2023-07-03 22:16:20] [config] maxi-batch: 100
[2023-07-03 22:16:20] [config] maxi-batch-sort: trg
[2023-07-03 22:16:20] [config] mini-batch: 64
[2023-07-03 22:16:20] [config] mini-batch-fit: false
[2023-07-03 22:16:20] [config] mini-batch-fit-step: 10
[2023-07-03 22:16:20] [config] mini-batch-round-up: true
[2023-07-03 22:16:20] [config] mini-batch-track-lr: false
[2023-07-03 22:16:20] [config] mini-batch-warmup: 0
[2023-07-03 22:16:20] [config] mini-batch-words: 0
[2023-07-03 22:16:20] [config] mini-batch-words-ref: 0
[2023-07-03 22:16:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-03 22:16:20] [config] multi-loss-type: sum
[2023-07-03 22:16:20] [config] n-best: false
[2023-07-03 22:16:20] [config] no-nccl: false
[2023-07-03 22:16:20] [config] no-reload: false
[2023-07-03 22:16:20] [config] no-restore-corpus: false
[2023-07-03 22:16:20] [config] normalize: 0
[2023-07-03 22:16:20] [config] normalize-gradient: false
[2023-07-03 22:16:20] [config] num-devices: 0
[2023-07-03 22:16:20] [config] optimizer: adam
[2023-07-03 22:16:20] [config] optimizer-delay: 1
[2023-07-03 22:16:20] [config] optimizer-params:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] output-omit-bias: false
[2023-07-03 22:16:20] [config] overwrite: true
[2023-07-03 22:16:20] [config] precision:
[2023-07-03 22:16:20] [config]   - float32
[2023-07-03 22:16:20] [config]   - float32
[2023-07-03 22:16:20] [config] pretrained-model: ""
[2023-07-03 22:16:20] [config] quantize-biases: false
[2023-07-03 22:16:20] [config] quantize-bits: 0
[2023-07-03 22:16:20] [config] quantize-log-based: false
[2023-07-03 22:16:20] [config] quantize-optimization-steps: 0
[2023-07-03 22:16:20] [config] quiet: false
[2023-07-03 22:16:20] [config] quiet-translation: true
[2023-07-03 22:16:20] [config] relative-paths: false
[2023-07-03 22:16:20] [config] right-left: false
[2023-07-03 22:16:20] [config] save-freq: 10000u
[2023-07-03 22:16:20] [config] seed: 1234
[2023-07-03 22:16:20] [config] sentencepiece-alphas:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:16:20] [config] sentencepiece-options: ""
[2023-07-03 22:16:20] [config] sharding: global
[2023-07-03 22:16:20] [config] shuffle: data
[2023-07-03 22:16:20] [config] shuffle-in-ram: false
[2023-07-03 22:16:20] [config] sigterm: save-and-exit
[2023-07-03 22:16:20] [config] skip: false
[2023-07-03 22:16:20] [config] sqlite: ""
[2023-07-03 22:16:20] [config] sqlite-drop: false
[2023-07-03 22:16:20] [config] sync-freq: 200u
[2023-07-03 22:16:20] [config] sync-sgd: false
[2023-07-03 22:16:20] [config] tempdir: /tmp
[2023-07-03 22:16:20] [config] tied-embeddings: false
[2023-07-03 22:16:20] [config] tied-embeddings-all: false
[2023-07-03 22:16:20] [config] tied-embeddings-src: false
[2023-07-03 22:16:20] [config] train-embedder-rank:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] train-sets:
[2023-07-03 22:16:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:16:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:16:20] [config] transformer-aan-activation: swish
[2023-07-03 22:16:20] [config] transformer-aan-depth: 2
[2023-07-03 22:16:20] [config] transformer-aan-nogate: false
[2023-07-03 22:16:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:16:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:16:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:16:20] [config] transformer-depth-scaling: false
[2023-07-03 22:16:20] [config] transformer-dim-aan: 2048
[2023-07-03 22:16:20] [config] transformer-dim-ffn: 2048
[2023-07-03 22:16:20] [config] transformer-dropout: 0
[2023-07-03 22:16:20] [config] transformer-dropout-attention: 0
[2023-07-03 22:16:20] [config] transformer-dropout-ffn: 0
[2023-07-03 22:16:20] [config] transformer-ffn-activation: swish
[2023-07-03 22:16:20] [config] transformer-ffn-depth: 2
[2023-07-03 22:16:20] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:16:20] [config] transformer-heads: 8
[2023-07-03 22:16:20] [config] transformer-no-projection: false
[2023-07-03 22:16:20] [config] transformer-pool: false
[2023-07-03 22:16:20] [config] transformer-postprocess: dan
[2023-07-03 22:16:20] [config] transformer-postprocess-emb: d
[2023-07-03 22:16:20] [config] transformer-postprocess-top: ""
[2023-07-03 22:16:20] [config] transformer-preprocess: ""
[2023-07-03 22:16:20] [config] transformer-tied-layers:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] transformer-train-position-embeddings: false
[2023-07-03 22:16:20] [config] tsv: false
[2023-07-03 22:16:20] [config] tsv-fields: 0
[2023-07-03 22:16:20] [config] type: s2s
[2023-07-03 22:16:20] [config] ulr: false
[2023-07-03 22:16:20] [config] ulr-dim-emb: 0
[2023-07-03 22:16:20] [config] ulr-dropout: 0
[2023-07-03 22:16:20] [config] ulr-keys-vectors: ""
[2023-07-03 22:16:20] [config] ulr-query-vectors: ""
[2023-07-03 22:16:20] [config] ulr-softmax-temperature: 1
[2023-07-03 22:16:20] [config] ulr-trainable-transformation: false
[2023-07-03 22:16:20] [config] unlikelihood-loss: false
[2023-07-03 22:16:20] [config] valid-freq: 50000000
[2023-07-03 22:16:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:16:20] [config] valid-max-length: 1000
[2023-07-03 22:16:20] [config] valid-metrics:
[2023-07-03 22:16:20] [config]   - cross-entropy
[2023-07-03 22:16:20] [config]   - translation
[2023-07-03 22:16:20] [config] valid-mini-batch: 32
[2023-07-03 22:16:20] [config] valid-reset-stalled: false
[2023-07-03 22:16:20] [config] valid-script-args:
[2023-07-03 22:16:20] [config]   []
[2023-07-03 22:16:20] [config] valid-script-path: ""
[2023-07-03 22:16:20] [config] valid-sets:
[2023-07-03 22:16:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:16:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:16:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:16:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:16:20] [config] vocabs:
[2023-07-03 22:16:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:16:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:16:20] [config] word-penalty: 0
[2023-07-03 22:16:20] [config] word-scores: false
[2023-07-03 22:16:20] [config] workspace: 2048
[2023-07-03 22:16:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:16:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:16:20] [training] Using single-device training
[2023-07-03 22:16:20] Synced seed 1234
[2023-07-03 22:16:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:16:20] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:16:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:16:20] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:16:20] [valid] No post-processing script given for validating translator
[2023-07-03 22:16:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:16:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:16:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:16:21] [comm] Using global sharding
[2023-07-03 22:16:21] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:16:21] [training] Using 1 GPUs
[2023-07-03 22:16:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-03 22:16:23] Loading Adam parameters
[2023-07-03 22:16:24] [memory] Reserving 754 MB, device gpu0
[2023-07-03 22:16:24] [memory] Reserving 377 MB, device gpu0
[2023-07-03 22:16:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-03 22:16:24] [data] Restoring the corpus state to epoch 2, batch 297
[2023-07-03 22:16:24] [data] Shuffling data
[2023-07-03 22:16:24] [data] Done reading 20,192 sentences
[2023-07-03 22:16:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:16:24] Training started
[2023-07-03 22:16:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 22:16:24] [logits] Applying loss function for 1 factor(s)
[2023-07-03 22:16:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 22:16:25] [memory] Reserving 377 MB, device gpu0
[2023-07-03 22:16:25] Parameter type float32, optimization type float32, casting types false
[2023-07-03 22:17:04] Seen 18,843 samples
[2023-07-03 22:17:04] Starting data epoch 3 in logical epoch 3
[2023-07-03 22:17:04] Training finished
[2023-07-03 22:17:09] [valid] Ep. 3 : Up. 594 : cross-entropy : 122.185 : new best
[2023-07-03 22:18:57] [valid] Ep. 3 : Up. 594 : translation : 0 : new best
[2023-07-03 22:18:57] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-03 22:19:02] Saving Adam parameters
[2023-07-03 22:19:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-03 22:19:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:19:21] [marian] Running on node19.datos.cluster.uy as process 34717 with command line:
[2023-07-03 22:19:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_multi-s2s.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type multi-s2s
[2023-07-03 22:19:21] [config] after: 0e
[2023-07-03 22:19:21] [config] after-batches: 0
[2023-07-03 22:19:21] [config] after-epochs: 1
[2023-07-03 22:19:21] [config] all-caps-every: 0
[2023-07-03 22:19:21] [config] allow-unk: false
[2023-07-03 22:19:21] [config] authors: false
[2023-07-03 22:19:21] [config] beam-size: 12
[2023-07-03 22:19:21] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:19:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:19:21] [config] bert-masking-fraction: 0.15
[2023-07-03 22:19:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:19:21] [config] bert-train-type-embeddings: true
[2023-07-03 22:19:21] [config] bert-type-vocab-size: 2
[2023-07-03 22:19:21] [config] build-info: ""
[2023-07-03 22:19:21] [config] check-gradient-nan: false
[2023-07-03 22:19:21] [config] check-nan: false
[2023-07-03 22:19:21] [config] cite: false
[2023-07-03 22:19:21] [config] clip-norm: 1
[2023-07-03 22:19:21] [config] cost-scaling:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] cost-type: ce-sum
[2023-07-03 22:19:21] [config] cpu-threads: 0
[2023-07-03 22:19:21] [config] data-threads: 8
[2023-07-03 22:19:21] [config] data-weighting: ""
[2023-07-03 22:19:21] [config] data-weighting-type: sentence
[2023-07-03 22:19:21] [config] dec-cell: gru
[2023-07-03 22:19:21] [config] dec-cell-base-depth: 2
[2023-07-03 22:19:21] [config] dec-cell-high-depth: 1
[2023-07-03 22:19:21] [config] dec-depth: 1
[2023-07-03 22:19:21] [config] devices:
[2023-07-03 22:19:21] [config]   - 0
[2023-07-03 22:19:21] [config] dim-emb: 512
[2023-07-03 22:19:21] [config] dim-rnn: 1024
[2023-07-03 22:19:21] [config] dim-vocabs:
[2023-07-03 22:19:21] [config]   - 0
[2023-07-03 22:19:21] [config]   - 0
[2023-07-03 22:19:21] [config] disp-first: 0
[2023-07-03 22:19:21] [config] disp-freq: 1000u
[2023-07-03 22:19:21] [config] disp-label-counts: true
[2023-07-03 22:19:21] [config] dropout-rnn: 0
[2023-07-03 22:19:21] [config] dropout-src: 0
[2023-07-03 22:19:21] [config] dropout-trg: 0
[2023-07-03 22:19:21] [config] dump-config: ""
[2023-07-03 22:19:21] [config] dynamic-gradient-scaling:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] early-stopping: 10
[2023-07-03 22:19:21] [config] early-stopping-on: first
[2023-07-03 22:19:21] [config] embedding-fix-src: false
[2023-07-03 22:19:21] [config] embedding-fix-trg: false
[2023-07-03 22:19:21] [config] embedding-normalization: false
[2023-07-03 22:19:21] [config] embedding-vectors:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] enc-cell: gru
[2023-07-03 22:19:21] [config] enc-cell-depth: 1
[2023-07-03 22:19:21] [config] enc-depth: 1
[2023-07-03 22:19:21] [config] enc-type: bidirectional
[2023-07-03 22:19:21] [config] english-title-case-every: 0
[2023-07-03 22:19:21] [config] exponential-smoothing: 0
[2023-07-03 22:19:21] [config] factor-weight: 1
[2023-07-03 22:19:21] [config] factors-combine: sum
[2023-07-03 22:19:21] [config] factors-dim-emb: 0
[2023-07-03 22:19:21] [config] gradient-checkpointing: false
[2023-07-03 22:19:21] [config] gradient-norm-average-window: 100
[2023-07-03 22:19:21] [config] guided-alignment: none
[2023-07-03 22:19:21] [config] guided-alignment-cost: mse
[2023-07-03 22:19:21] [config] guided-alignment-weight: 0.1
[2023-07-03 22:19:21] [config] ignore-model-config: false
[2023-07-03 22:19:21] [config] input-types:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] interpolate-env-vars: false
[2023-07-03 22:19:21] [config] keep-best: false
[2023-07-03 22:19:21] [config] label-smoothing: 0
[2023-07-03 22:19:21] [config] layer-normalization: false
[2023-07-03 22:19:21] [config] learn-rate: 0.0001
[2023-07-03 22:19:21] [config] lemma-dependency: ""
[2023-07-03 22:19:21] [config] lemma-dim-emb: 0
[2023-07-03 22:19:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:19:21] [config] log-level: info
[2023-07-03 22:19:21] [config] log-time-zone: ""
[2023-07-03 22:19:21] [config] logical-epoch:
[2023-07-03 22:19:21] [config]   - 1e
[2023-07-03 22:19:21] [config]   - 0
[2023-07-03 22:19:21] [config] lr-decay: 0
[2023-07-03 22:19:21] [config] lr-decay-freq: 50000
[2023-07-03 22:19:21] [config] lr-decay-inv-sqrt:
[2023-07-03 22:19:21] [config]   - 0
[2023-07-03 22:19:21] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:19:21] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:19:21] [config] lr-decay-start:
[2023-07-03 22:19:21] [config]   - 10
[2023-07-03 22:19:21] [config]   - 1
[2023-07-03 22:19:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:19:21] [config] lr-report: false
[2023-07-03 22:19:21] [config] lr-warmup: 0
[2023-07-03 22:19:21] [config] lr-warmup-at-reload: false
[2023-07-03 22:19:21] [config] lr-warmup-cycle: false
[2023-07-03 22:19:21] [config] lr-warmup-start-rate: 0
[2023-07-03 22:19:21] [config] max-length: 50
[2023-07-03 22:19:21] [config] max-length-crop: false
[2023-07-03 22:19:21] [config] max-length-factor: 3
[2023-07-03 22:19:21] [config] maxi-batch: 100
[2023-07-03 22:19:21] [config] maxi-batch-sort: trg
[2023-07-03 22:19:21] [config] mini-batch: 64
[2023-07-03 22:19:21] [config] mini-batch-fit: false
[2023-07-03 22:19:21] [config] mini-batch-fit-step: 10
[2023-07-03 22:19:21] [config] mini-batch-round-up: true
[2023-07-03 22:19:21] [config] mini-batch-track-lr: false
[2023-07-03 22:19:21] [config] mini-batch-warmup: 0
[2023-07-03 22:19:21] [config] mini-batch-words: 0
[2023-07-03 22:19:21] [config] mini-batch-words-ref: 0
[2023-07-03 22:19:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_multi-s2s.npz
[2023-07-03 22:19:21] [config] multi-loss-type: sum
[2023-07-03 22:19:21] [config] n-best: false
[2023-07-03 22:19:21] [config] no-nccl: false
[2023-07-03 22:19:21] [config] no-reload: false
[2023-07-03 22:19:21] [config] no-restore-corpus: false
[2023-07-03 22:19:21] [config] normalize: 0
[2023-07-03 22:19:21] [config] normalize-gradient: false
[2023-07-03 22:19:21] [config] num-devices: 0
[2023-07-03 22:19:21] [config] optimizer: adam
[2023-07-03 22:19:21] [config] optimizer-delay: 1
[2023-07-03 22:19:21] [config] optimizer-params:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] output-omit-bias: false
[2023-07-03 22:19:21] [config] overwrite: true
[2023-07-03 22:19:21] [config] precision:
[2023-07-03 22:19:21] [config]   - float32
[2023-07-03 22:19:21] [config]   - float32
[2023-07-03 22:19:21] [config] pretrained-model: ""
[2023-07-03 22:19:21] [config] quantize-biases: false
[2023-07-03 22:19:21] [config] quantize-bits: 0
[2023-07-03 22:19:21] [config] quantize-log-based: false
[2023-07-03 22:19:21] [config] quantize-optimization-steps: 0
[2023-07-03 22:19:21] [config] quiet: false
[2023-07-03 22:19:21] [config] quiet-translation: true
[2023-07-03 22:19:21] [config] relative-paths: false
[2023-07-03 22:19:21] [config] right-left: false
[2023-07-03 22:19:21] [config] save-freq: 10000u
[2023-07-03 22:19:21] [config] seed: 1234
[2023-07-03 22:19:21] [config] sentencepiece-alphas:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:19:21] [config] sentencepiece-options: ""
[2023-07-03 22:19:21] [config] sharding: global
[2023-07-03 22:19:21] [config] shuffle: data
[2023-07-03 22:19:21] [config] shuffle-in-ram: false
[2023-07-03 22:19:21] [config] sigterm: save-and-exit
[2023-07-03 22:19:21] [config] skip: false
[2023-07-03 22:19:21] [config] sqlite: ""
[2023-07-03 22:19:21] [config] sqlite-drop: false
[2023-07-03 22:19:21] [config] sync-freq: 200u
[2023-07-03 22:19:21] [config] sync-sgd: false
[2023-07-03 22:19:21] [config] tempdir: /tmp
[2023-07-03 22:19:21] [config] tied-embeddings: false
[2023-07-03 22:19:21] [config] tied-embeddings-all: false
[2023-07-03 22:19:21] [config] tied-embeddings-src: false
[2023-07-03 22:19:21] [config] train-embedder-rank:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] train-sets:
[2023-07-03 22:19:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:19:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:19:21] [config] transformer-aan-activation: swish
[2023-07-03 22:19:21] [config] transformer-aan-depth: 2
[2023-07-03 22:19:21] [config] transformer-aan-nogate: false
[2023-07-03 22:19:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:19:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:19:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:19:21] [config] transformer-depth-scaling: false
[2023-07-03 22:19:21] [config] transformer-dim-aan: 2048
[2023-07-03 22:19:21] [config] transformer-dim-ffn: 2048
[2023-07-03 22:19:21] [config] transformer-dropout: 0
[2023-07-03 22:19:21] [config] transformer-dropout-attention: 0
[2023-07-03 22:19:21] [config] transformer-dropout-ffn: 0
[2023-07-03 22:19:21] [config] transformer-ffn-activation: swish
[2023-07-03 22:19:21] [config] transformer-ffn-depth: 2
[2023-07-03 22:19:21] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:19:21] [config] transformer-heads: 8
[2023-07-03 22:19:21] [config] transformer-no-projection: false
[2023-07-03 22:19:21] [config] transformer-pool: false
[2023-07-03 22:19:21] [config] transformer-postprocess: dan
[2023-07-03 22:19:21] [config] transformer-postprocess-emb: d
[2023-07-03 22:19:21] [config] transformer-postprocess-top: ""
[2023-07-03 22:19:21] [config] transformer-preprocess: ""
[2023-07-03 22:19:21] [config] transformer-tied-layers:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] transformer-train-position-embeddings: false
[2023-07-03 22:19:21] [config] tsv: false
[2023-07-03 22:19:21] [config] tsv-fields: 0
[2023-07-03 22:19:21] [config] type: multi-s2s
[2023-07-03 22:19:21] [config] ulr: false
[2023-07-03 22:19:21] [config] ulr-dim-emb: 0
[2023-07-03 22:19:21] [config] ulr-dropout: 0
[2023-07-03 22:19:21] [config] ulr-keys-vectors: ""
[2023-07-03 22:19:21] [config] ulr-query-vectors: ""
[2023-07-03 22:19:21] [config] ulr-softmax-temperature: 1
[2023-07-03 22:19:21] [config] ulr-trainable-transformation: false
[2023-07-03 22:19:21] [config] unlikelihood-loss: false
[2023-07-03 22:19:21] [config] valid-freq: 50000000
[2023-07-03 22:19:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:19:21] [config] valid-max-length: 1000
[2023-07-03 22:19:21] [config] valid-metrics:
[2023-07-03 22:19:21] [config]   - cross-entropy
[2023-07-03 22:19:21] [config]   - translation
[2023-07-03 22:19:21] [config] valid-mini-batch: 32
[2023-07-03 22:19:21] [config] valid-reset-stalled: false
[2023-07-03 22:19:21] [config] valid-script-args:
[2023-07-03 22:19:21] [config]   []
[2023-07-03 22:19:21] [config] valid-script-path: ""
[2023-07-03 22:19:21] [config] valid-sets:
[2023-07-03 22:19:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:19:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:19:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:19:21] [config] vocabs:
[2023-07-03 22:19:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:19:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:19:21] [config] word-penalty: 0
[2023-07-03 22:19:21] [config] word-scores: false
[2023-07-03 22:19:21] [config] workspace: 2048
[2023-07-03 22:19:21] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:19:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:19:21] [training] Using single-device training
[2023-07-03 22:19:22] Synced seed 1234
[2023-07-03 22:19:22] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:19:22] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:19:22] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:19:22] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:19:22] [valid] No post-processing script given for validating translator
[2023-07-03 22:19:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:19:22] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:19:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:19:22] [comm] Using global sharding
[2023-07-03 22:19:22] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:19:22] [training] Using 1 GPUs
[2023-07-03 22:19:22] Training started
[2023-07-03 22:19:22] [data] Shuffling data
[2023-07-03 22:19:22] [data] Done reading 20,192 sentences
[2023-07-03 22:19:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:19:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 22:19:23] Error: Segmentation fault
[2023-07-03 22:19:23] Error: Aborted from setErrorHandlers()::<lambda(int, siginfo_t*, void*)> in /marian/src/common/logging.cpp:130

[CALL STACK]
[0x561bf8982d80]                                                       + 0x4f9d80
[0x561bf8982fcf]                                                       + 0x4f9fcf
[0x7fe67b6943c0]                                                       + 0x143c0
[0x561bf8d42f24]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x74
[0x561bf8dc8d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x561bf8db577c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x561bf888681d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x561bf8e3f1c7]                                                       + 0x9b61c7
[0x561bf8ee9a53]    bool marian::NCCLCommunicator::  foreachAcc  <bool>(std::function<bool (unsigned long,unsigned long,unsigned long)> const&,  std::function<void (bool&,bool)> const&,  bool,  bool) const + 0x8b3
[0x561bf8eeabd7]    marian::NCCLCommunicator::  foreach  (std::function<bool (unsigned long,unsigned long,unsigned long)> const&,  bool) const + 0x47
[0x561bf8e40db8]    marian::SyncGraphGroup::  initialize  (std::shared_ptr<marian::data::Batch> const&) + 0x568
[0x561bf8e42bbf]    marian::SyncGraphGroup::  update  (std::vector<std::shared_ptr<marian::data::Batch>,std::allocator<std::shared_ptr<marian::data::Batch>>>,  unsigned long) + 0x36f
[0x561bf8e43f05]    marian::SyncGraphGroup::  update  (std::shared_ptr<marian::data::Batch>) + 0x395
[0x561bf89419d1]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1c01
[0x561bf88622c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x561bf8819b9c]    main                                               + 0x3c
[0x7fe67b1660b3]    __libc_start_main                                  + 0xf3
[0x561bf8860cbe]    _start                                             + 0x2e

[2023-07-03 22:19:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:19:26] [marian] Running on node19.datos.cluster.uy as process 34771 with command line:
[2023-07-03 22:19:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_multi-s2s.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type multi-s2s
[2023-07-03 22:19:26] [config] after: 0e
[2023-07-03 22:19:26] [config] after-batches: 0
[2023-07-03 22:19:26] [config] after-epochs: 2
[2023-07-03 22:19:26] [config] all-caps-every: 0
[2023-07-03 22:19:26] [config] allow-unk: false
[2023-07-03 22:19:26] [config] authors: false
[2023-07-03 22:19:26] [config] beam-size: 12
[2023-07-03 22:19:26] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:19:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:19:26] [config] bert-masking-fraction: 0.15
[2023-07-03 22:19:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:19:26] [config] bert-train-type-embeddings: true
[2023-07-03 22:19:26] [config] bert-type-vocab-size: 2
[2023-07-03 22:19:26] [config] build-info: ""
[2023-07-03 22:19:26] [config] check-gradient-nan: false
[2023-07-03 22:19:26] [config] check-nan: false
[2023-07-03 22:19:26] [config] cite: false
[2023-07-03 22:19:26] [config] clip-norm: 1
[2023-07-03 22:19:26] [config] cost-scaling:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] cost-type: ce-sum
[2023-07-03 22:19:26] [config] cpu-threads: 0
[2023-07-03 22:19:26] [config] data-threads: 8
[2023-07-03 22:19:26] [config] data-weighting: ""
[2023-07-03 22:19:26] [config] data-weighting-type: sentence
[2023-07-03 22:19:26] [config] dec-cell: gru
[2023-07-03 22:19:26] [config] dec-cell-base-depth: 2
[2023-07-03 22:19:26] [config] dec-cell-high-depth: 1
[2023-07-03 22:19:26] [config] dec-depth: 1
[2023-07-03 22:19:26] [config] devices:
[2023-07-03 22:19:26] [config]   - 0
[2023-07-03 22:19:26] [config] dim-emb: 512
[2023-07-03 22:19:26] [config] dim-rnn: 1024
[2023-07-03 22:19:26] [config] dim-vocabs:
[2023-07-03 22:19:26] [config]   - 0
[2023-07-03 22:19:26] [config]   - 0
[2023-07-03 22:19:26] [config] disp-first: 0
[2023-07-03 22:19:26] [config] disp-freq: 1000u
[2023-07-03 22:19:26] [config] disp-label-counts: true
[2023-07-03 22:19:26] [config] dropout-rnn: 0
[2023-07-03 22:19:26] [config] dropout-src: 0
[2023-07-03 22:19:26] [config] dropout-trg: 0
[2023-07-03 22:19:26] [config] dump-config: ""
[2023-07-03 22:19:26] [config] dynamic-gradient-scaling:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] early-stopping: 10
[2023-07-03 22:19:26] [config] early-stopping-on: first
[2023-07-03 22:19:26] [config] embedding-fix-src: false
[2023-07-03 22:19:26] [config] embedding-fix-trg: false
[2023-07-03 22:19:26] [config] embedding-normalization: false
[2023-07-03 22:19:26] [config] embedding-vectors:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] enc-cell: gru
[2023-07-03 22:19:26] [config] enc-cell-depth: 1
[2023-07-03 22:19:26] [config] enc-depth: 1
[2023-07-03 22:19:26] [config] enc-type: bidirectional
[2023-07-03 22:19:26] [config] english-title-case-every: 0
[2023-07-03 22:19:26] [config] exponential-smoothing: 0
[2023-07-03 22:19:26] [config] factor-weight: 1
[2023-07-03 22:19:26] [config] factors-combine: sum
[2023-07-03 22:19:26] [config] factors-dim-emb: 0
[2023-07-03 22:19:26] [config] gradient-checkpointing: false
[2023-07-03 22:19:26] [config] gradient-norm-average-window: 100
[2023-07-03 22:19:26] [config] guided-alignment: none
[2023-07-03 22:19:26] [config] guided-alignment-cost: mse
[2023-07-03 22:19:26] [config] guided-alignment-weight: 0.1
[2023-07-03 22:19:26] [config] ignore-model-config: false
[2023-07-03 22:19:26] [config] input-types:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] interpolate-env-vars: false
[2023-07-03 22:19:26] [config] keep-best: false
[2023-07-03 22:19:26] [config] label-smoothing: 0
[2023-07-03 22:19:26] [config] layer-normalization: false
[2023-07-03 22:19:26] [config] learn-rate: 0.0001
[2023-07-03 22:19:26] [config] lemma-dependency: ""
[2023-07-03 22:19:26] [config] lemma-dim-emb: 0
[2023-07-03 22:19:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:19:26] [config] log-level: info
[2023-07-03 22:19:26] [config] log-time-zone: ""
[2023-07-03 22:19:26] [config] logical-epoch:
[2023-07-03 22:19:26] [config]   - 1e
[2023-07-03 22:19:26] [config]   - 0
[2023-07-03 22:19:26] [config] lr-decay: 0
[2023-07-03 22:19:26] [config] lr-decay-freq: 50000
[2023-07-03 22:19:26] [config] lr-decay-inv-sqrt:
[2023-07-03 22:19:26] [config]   - 0
[2023-07-03 22:19:26] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:19:26] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:19:26] [config] lr-decay-start:
[2023-07-03 22:19:26] [config]   - 10
[2023-07-03 22:19:26] [config]   - 1
[2023-07-03 22:19:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:19:26] [config] lr-report: false
[2023-07-03 22:19:26] [config] lr-warmup: 0
[2023-07-03 22:19:26] [config] lr-warmup-at-reload: false
[2023-07-03 22:19:26] [config] lr-warmup-cycle: false
[2023-07-03 22:19:26] [config] lr-warmup-start-rate: 0
[2023-07-03 22:19:26] [config] max-length: 50
[2023-07-03 22:19:26] [config] max-length-crop: false
[2023-07-03 22:19:26] [config] max-length-factor: 3
[2023-07-03 22:19:26] [config] maxi-batch: 100
[2023-07-03 22:19:26] [config] maxi-batch-sort: trg
[2023-07-03 22:19:26] [config] mini-batch: 64
[2023-07-03 22:19:26] [config] mini-batch-fit: false
[2023-07-03 22:19:26] [config] mini-batch-fit-step: 10
[2023-07-03 22:19:26] [config] mini-batch-round-up: true
[2023-07-03 22:19:26] [config] mini-batch-track-lr: false
[2023-07-03 22:19:26] [config] mini-batch-warmup: 0
[2023-07-03 22:19:26] [config] mini-batch-words: 0
[2023-07-03 22:19:26] [config] mini-batch-words-ref: 0
[2023-07-03 22:19:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_multi-s2s.npz
[2023-07-03 22:19:26] [config] multi-loss-type: sum
[2023-07-03 22:19:26] [config] n-best: false
[2023-07-03 22:19:26] [config] no-nccl: false
[2023-07-03 22:19:26] [config] no-reload: false
[2023-07-03 22:19:26] [config] no-restore-corpus: false
[2023-07-03 22:19:26] [config] normalize: 0
[2023-07-03 22:19:26] [config] normalize-gradient: false
[2023-07-03 22:19:26] [config] num-devices: 0
[2023-07-03 22:19:26] [config] optimizer: adam
[2023-07-03 22:19:26] [config] optimizer-delay: 1
[2023-07-03 22:19:26] [config] optimizer-params:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] output-omit-bias: false
[2023-07-03 22:19:26] [config] overwrite: true
[2023-07-03 22:19:26] [config] precision:
[2023-07-03 22:19:26] [config]   - float32
[2023-07-03 22:19:26] [config]   - float32
[2023-07-03 22:19:26] [config] pretrained-model: ""
[2023-07-03 22:19:26] [config] quantize-biases: false
[2023-07-03 22:19:26] [config] quantize-bits: 0
[2023-07-03 22:19:26] [config] quantize-log-based: false
[2023-07-03 22:19:26] [config] quantize-optimization-steps: 0
[2023-07-03 22:19:26] [config] quiet: false
[2023-07-03 22:19:26] [config] quiet-translation: true
[2023-07-03 22:19:26] [config] relative-paths: false
[2023-07-03 22:19:26] [config] right-left: false
[2023-07-03 22:19:26] [config] save-freq: 10000u
[2023-07-03 22:19:26] [config] seed: 1234
[2023-07-03 22:19:26] [config] sentencepiece-alphas:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:19:26] [config] sentencepiece-options: ""
[2023-07-03 22:19:26] [config] sharding: global
[2023-07-03 22:19:26] [config] shuffle: data
[2023-07-03 22:19:26] [config] shuffle-in-ram: false
[2023-07-03 22:19:26] [config] sigterm: save-and-exit
[2023-07-03 22:19:26] [config] skip: false
[2023-07-03 22:19:26] [config] sqlite: ""
[2023-07-03 22:19:26] [config] sqlite-drop: false
[2023-07-03 22:19:26] [config] sync-freq: 200u
[2023-07-03 22:19:26] [config] sync-sgd: false
[2023-07-03 22:19:26] [config] tempdir: /tmp
[2023-07-03 22:19:26] [config] tied-embeddings: false
[2023-07-03 22:19:26] [config] tied-embeddings-all: false
[2023-07-03 22:19:26] [config] tied-embeddings-src: false
[2023-07-03 22:19:26] [config] train-embedder-rank:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] train-sets:
[2023-07-03 22:19:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:19:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:19:26] [config] transformer-aan-activation: swish
[2023-07-03 22:19:26] [config] transformer-aan-depth: 2
[2023-07-03 22:19:26] [config] transformer-aan-nogate: false
[2023-07-03 22:19:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:19:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:19:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:19:26] [config] transformer-depth-scaling: false
[2023-07-03 22:19:26] [config] transformer-dim-aan: 2048
[2023-07-03 22:19:26] [config] transformer-dim-ffn: 2048
[2023-07-03 22:19:26] [config] transformer-dropout: 0
[2023-07-03 22:19:26] [config] transformer-dropout-attention: 0
[2023-07-03 22:19:26] [config] transformer-dropout-ffn: 0
[2023-07-03 22:19:26] [config] transformer-ffn-activation: swish
[2023-07-03 22:19:26] [config] transformer-ffn-depth: 2
[2023-07-03 22:19:26] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:19:26] [config] transformer-heads: 8
[2023-07-03 22:19:26] [config] transformer-no-projection: false
[2023-07-03 22:19:26] [config] transformer-pool: false
[2023-07-03 22:19:26] [config] transformer-postprocess: dan
[2023-07-03 22:19:26] [config] transformer-postprocess-emb: d
[2023-07-03 22:19:26] [config] transformer-postprocess-top: ""
[2023-07-03 22:19:26] [config] transformer-preprocess: ""
[2023-07-03 22:19:26] [config] transformer-tied-layers:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] transformer-train-position-embeddings: false
[2023-07-03 22:19:26] [config] tsv: false
[2023-07-03 22:19:26] [config] tsv-fields: 0
[2023-07-03 22:19:26] [config] type: multi-s2s
[2023-07-03 22:19:26] [config] ulr: false
[2023-07-03 22:19:26] [config] ulr-dim-emb: 0
[2023-07-03 22:19:26] [config] ulr-dropout: 0
[2023-07-03 22:19:26] [config] ulr-keys-vectors: ""
[2023-07-03 22:19:26] [config] ulr-query-vectors: ""
[2023-07-03 22:19:26] [config] ulr-softmax-temperature: 1
[2023-07-03 22:19:26] [config] ulr-trainable-transformation: false
[2023-07-03 22:19:26] [config] unlikelihood-loss: false
[2023-07-03 22:19:26] [config] valid-freq: 50000000
[2023-07-03 22:19:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:19:26] [config] valid-max-length: 1000
[2023-07-03 22:19:26] [config] valid-metrics:
[2023-07-03 22:19:26] [config]   - cross-entropy
[2023-07-03 22:19:26] [config]   - translation
[2023-07-03 22:19:26] [config] valid-mini-batch: 32
[2023-07-03 22:19:26] [config] valid-reset-stalled: false
[2023-07-03 22:19:26] [config] valid-script-args:
[2023-07-03 22:19:26] [config]   []
[2023-07-03 22:19:26] [config] valid-script-path: ""
[2023-07-03 22:19:26] [config] valid-sets:
[2023-07-03 22:19:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:19:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:19:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:19:26] [config] vocabs:
[2023-07-03 22:19:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:19:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:19:26] [config] word-penalty: 0
[2023-07-03 22:19:26] [config] word-scores: false
[2023-07-03 22:19:26] [config] workspace: 2048
[2023-07-03 22:19:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:19:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:19:26] [training] Using single-device training
[2023-07-03 22:19:26] Synced seed 1234
[2023-07-03 22:19:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:19:26] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:19:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:19:26] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:19:27] [valid] No post-processing script given for validating translator
[2023-07-03 22:19:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:19:27] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:19:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:19:27] [comm] Using global sharding
[2023-07-03 22:19:27] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:19:27] [training] Using 1 GPUs
[2023-07-03 22:19:27] Training started
[2023-07-03 22:19:27] [data] Shuffling data
[2023-07-03 22:19:27] [data] Done reading 20,192 sentences
[2023-07-03 22:19:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:19:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 22:19:28] Error: Segmentation fault
[2023-07-03 22:19:28] Error: Aborted from setErrorHandlers()::<lambda(int, siginfo_t*, void*)> in /marian/src/common/logging.cpp:130

[CALL STACK]
[0x562ceccf3d80]                                                       + 0x4f9d80
[0x562ceccf3fcf]                                                       + 0x4f9fcf
[0x7fc41a9593c0]                                                       + 0x143c0
[0x562ced0b3f24]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x74
[0x562ced139d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x562ced12677c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x562cecbf781d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x562ced1b01c7]                                                       + 0x9b61c7
[0x562ced25aa53]    bool marian::NCCLCommunicator::  foreachAcc  <bool>(std::function<bool (unsigned long,unsigned long,unsigned long)> const&,  std::function<void (bool&,bool)> const&,  bool,  bool) const + 0x8b3
[0x562ced25bbd7]    marian::NCCLCommunicator::  foreach  (std::function<bool (unsigned long,unsigned long,unsigned long)> const&,  bool) const + 0x47
[0x562ced1b1db8]    marian::SyncGraphGroup::  initialize  (std::shared_ptr<marian::data::Batch> const&) + 0x568
[0x562ced1b3bbf]    marian::SyncGraphGroup::  update  (std::vector<std::shared_ptr<marian::data::Batch>,std::allocator<std::shared_ptr<marian::data::Batch>>>,  unsigned long) + 0x36f
[0x562ced1b4f05]    marian::SyncGraphGroup::  update  (std::shared_ptr<marian::data::Batch>) + 0x395
[0x562ceccb29d1]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1c01
[0x562cecbd32c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x562cecb8ab9c]    main                                               + 0x3c
[0x7fc41a42b0b3]    __libc_start_main                                  + 0xf3
[0x562cecbd1cbe]    _start                                             + 0x2e

[2023-07-03 22:19:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:19:31] [marian] Running on node19.datos.cluster.uy as process 34821 with command line:
[2023-07-03 22:19:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 1 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-03 22:19:31] [config] after: 0e
[2023-07-03 22:19:31] [config] after-batches: 0
[2023-07-03 22:19:31] [config] after-epochs: 1
[2023-07-03 22:19:31] [config] all-caps-every: 0
[2023-07-03 22:19:31] [config] allow-unk: false
[2023-07-03 22:19:31] [config] authors: false
[2023-07-03 22:19:31] [config] beam-size: 12
[2023-07-03 22:19:31] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:19:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:19:31] [config] bert-masking-fraction: 0.15
[2023-07-03 22:19:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:19:31] [config] bert-train-type-embeddings: true
[2023-07-03 22:19:31] [config] bert-type-vocab-size: 2
[2023-07-03 22:19:31] [config] build-info: ""
[2023-07-03 22:19:31] [config] check-gradient-nan: false
[2023-07-03 22:19:31] [config] check-nan: false
[2023-07-03 22:19:31] [config] cite: false
[2023-07-03 22:19:31] [config] clip-norm: 1
[2023-07-03 22:19:31] [config] cost-scaling:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] cost-type: ce-sum
[2023-07-03 22:19:31] [config] cpu-threads: 0
[2023-07-03 22:19:31] [config] data-threads: 8
[2023-07-03 22:19:31] [config] data-weighting: ""
[2023-07-03 22:19:31] [config] data-weighting-type: sentence
[2023-07-03 22:19:31] [config] dec-cell: gru
[2023-07-03 22:19:31] [config] dec-cell-base-depth: 2
[2023-07-03 22:19:31] [config] dec-cell-high-depth: 1
[2023-07-03 22:19:31] [config] dec-depth: 1
[2023-07-03 22:19:31] [config] devices:
[2023-07-03 22:19:31] [config]   - 0
[2023-07-03 22:19:31] [config] dim-emb: 512
[2023-07-03 22:19:31] [config] dim-rnn: 1024
[2023-07-03 22:19:31] [config] dim-vocabs:
[2023-07-03 22:19:31] [config]   - 0
[2023-07-03 22:19:31] [config]   - 0
[2023-07-03 22:19:31] [config] disp-first: 0
[2023-07-03 22:19:31] [config] disp-freq: 1000u
[2023-07-03 22:19:31] [config] disp-label-counts: true
[2023-07-03 22:19:31] [config] dropout-rnn: 0
[2023-07-03 22:19:31] [config] dropout-src: 0
[2023-07-03 22:19:31] [config] dropout-trg: 0
[2023-07-03 22:19:31] [config] dump-config: ""
[2023-07-03 22:19:31] [config] dynamic-gradient-scaling:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] early-stopping: 10
[2023-07-03 22:19:31] [config] early-stopping-on: first
[2023-07-03 22:19:31] [config] embedding-fix-src: false
[2023-07-03 22:19:31] [config] embedding-fix-trg: false
[2023-07-03 22:19:31] [config] embedding-normalization: false
[2023-07-03 22:19:31] [config] embedding-vectors:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] enc-cell: gru
[2023-07-03 22:19:31] [config] enc-cell-depth: 1
[2023-07-03 22:19:31] [config] enc-depth: 1
[2023-07-03 22:19:31] [config] enc-type: bidirectional
[2023-07-03 22:19:31] [config] english-title-case-every: 0
[2023-07-03 22:19:31] [config] exponential-smoothing: 0
[2023-07-03 22:19:31] [config] factor-weight: 1
[2023-07-03 22:19:31] [config] factors-combine: sum
[2023-07-03 22:19:31] [config] factors-dim-emb: 0
[2023-07-03 22:19:31] [config] gradient-checkpointing: false
[2023-07-03 22:19:31] [config] gradient-norm-average-window: 100
[2023-07-03 22:19:31] [config] guided-alignment: none
[2023-07-03 22:19:31] [config] guided-alignment-cost: mse
[2023-07-03 22:19:31] [config] guided-alignment-weight: 0.1
[2023-07-03 22:19:31] [config] ignore-model-config: false
[2023-07-03 22:19:31] [config] input-types:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] interpolate-env-vars: false
[2023-07-03 22:19:31] [config] keep-best: false
[2023-07-03 22:19:31] [config] label-smoothing: 0
[2023-07-03 22:19:31] [config] layer-normalization: false
[2023-07-03 22:19:31] [config] learn-rate: 0.0001
[2023-07-03 22:19:31] [config] lemma-dependency: ""
[2023-07-03 22:19:31] [config] lemma-dim-emb: 0
[2023-07-03 22:19:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:19:31] [config] log-level: info
[2023-07-03 22:19:31] [config] log-time-zone: ""
[2023-07-03 22:19:31] [config] logical-epoch:
[2023-07-03 22:19:31] [config]   - 1e
[2023-07-03 22:19:31] [config]   - 0
[2023-07-03 22:19:31] [config] lr-decay: 0
[2023-07-03 22:19:31] [config] lr-decay-freq: 50000
[2023-07-03 22:19:31] [config] lr-decay-inv-sqrt:
[2023-07-03 22:19:31] [config]   - 0
[2023-07-03 22:19:31] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:19:31] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:19:31] [config] lr-decay-start:
[2023-07-03 22:19:31] [config]   - 10
[2023-07-03 22:19:31] [config]   - 1
[2023-07-03 22:19:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:19:31] [config] lr-report: false
[2023-07-03 22:19:31] [config] lr-warmup: 0
[2023-07-03 22:19:31] [config] lr-warmup-at-reload: false
[2023-07-03 22:19:31] [config] lr-warmup-cycle: false
[2023-07-03 22:19:31] [config] lr-warmup-start-rate: 0
[2023-07-03 22:19:31] [config] max-length: 50
[2023-07-03 22:19:31] [config] max-length-crop: false
[2023-07-03 22:19:31] [config] max-length-factor: 3
[2023-07-03 22:19:31] [config] maxi-batch: 100
[2023-07-03 22:19:31] [config] maxi-batch-sort: trg
[2023-07-03 22:19:31] [config] mini-batch: 64
[2023-07-03 22:19:31] [config] mini-batch-fit: false
[2023-07-03 22:19:31] [config] mini-batch-fit-step: 10
[2023-07-03 22:19:31] [config] mini-batch-round-up: true
[2023-07-03 22:19:31] [config] mini-batch-track-lr: false
[2023-07-03 22:19:31] [config] mini-batch-warmup: 0
[2023-07-03 22:19:31] [config] mini-batch-words: 0
[2023-07-03 22:19:31] [config] mini-batch-words-ref: 0
[2023-07-03 22:19:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-03 22:19:31] [config] multi-loss-type: sum
[2023-07-03 22:19:31] [config] n-best: false
[2023-07-03 22:19:31] [config] no-nccl: false
[2023-07-03 22:19:31] [config] no-reload: false
[2023-07-03 22:19:31] [config] no-restore-corpus: false
[2023-07-03 22:19:31] [config] normalize: 0
[2023-07-03 22:19:31] [config] normalize-gradient: false
[2023-07-03 22:19:31] [config] num-devices: 0
[2023-07-03 22:19:31] [config] optimizer: adam
[2023-07-03 22:19:31] [config] optimizer-delay: 1
[2023-07-03 22:19:31] [config] optimizer-params:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] output-omit-bias: false
[2023-07-03 22:19:31] [config] overwrite: true
[2023-07-03 22:19:31] [config] precision:
[2023-07-03 22:19:31] [config]   - float32
[2023-07-03 22:19:31] [config]   - float32
[2023-07-03 22:19:31] [config] pretrained-model: ""
[2023-07-03 22:19:31] [config] quantize-biases: false
[2023-07-03 22:19:31] [config] quantize-bits: 0
[2023-07-03 22:19:31] [config] quantize-log-based: false
[2023-07-03 22:19:31] [config] quantize-optimization-steps: 0
[2023-07-03 22:19:31] [config] quiet: false
[2023-07-03 22:19:31] [config] quiet-translation: true
[2023-07-03 22:19:31] [config] relative-paths: false
[2023-07-03 22:19:31] [config] right-left: false
[2023-07-03 22:19:31] [config] save-freq: 10000u
[2023-07-03 22:19:31] [config] seed: 1234
[2023-07-03 22:19:31] [config] sentencepiece-alphas:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:19:31] [config] sentencepiece-options: ""
[2023-07-03 22:19:31] [config] sharding: global
[2023-07-03 22:19:31] [config] shuffle: data
[2023-07-03 22:19:31] [config] shuffle-in-ram: false
[2023-07-03 22:19:31] [config] sigterm: save-and-exit
[2023-07-03 22:19:31] [config] skip: false
[2023-07-03 22:19:31] [config] sqlite: ""
[2023-07-03 22:19:31] [config] sqlite-drop: false
[2023-07-03 22:19:31] [config] sync-freq: 200u
[2023-07-03 22:19:31] [config] sync-sgd: false
[2023-07-03 22:19:31] [config] tempdir: /tmp
[2023-07-03 22:19:31] [config] tied-embeddings: false
[2023-07-03 22:19:31] [config] tied-embeddings-all: false
[2023-07-03 22:19:31] [config] tied-embeddings-src: false
[2023-07-03 22:19:31] [config] train-embedder-rank:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] train-sets:
[2023-07-03 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:19:31] [config] transformer-aan-activation: swish
[2023-07-03 22:19:31] [config] transformer-aan-depth: 2
[2023-07-03 22:19:31] [config] transformer-aan-nogate: false
[2023-07-03 22:19:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:19:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:19:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:19:31] [config] transformer-depth-scaling: false
[2023-07-03 22:19:31] [config] transformer-dim-aan: 2048
[2023-07-03 22:19:31] [config] transformer-dim-ffn: 2048
[2023-07-03 22:19:31] [config] transformer-dropout: 0
[2023-07-03 22:19:31] [config] transformer-dropout-attention: 0
[2023-07-03 22:19:31] [config] transformer-dropout-ffn: 0
[2023-07-03 22:19:31] [config] transformer-ffn-activation: swish
[2023-07-03 22:19:31] [config] transformer-ffn-depth: 2
[2023-07-03 22:19:31] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:19:31] [config] transformer-heads: 8
[2023-07-03 22:19:31] [config] transformer-no-projection: false
[2023-07-03 22:19:31] [config] transformer-pool: false
[2023-07-03 22:19:31] [config] transformer-postprocess: dan
[2023-07-03 22:19:31] [config] transformer-postprocess-emb: d
[2023-07-03 22:19:31] [config] transformer-postprocess-top: ""
[2023-07-03 22:19:31] [config] transformer-preprocess: ""
[2023-07-03 22:19:31] [config] transformer-tied-layers:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] transformer-train-position-embeddings: false
[2023-07-03 22:19:31] [config] tsv: false
[2023-07-03 22:19:31] [config] tsv-fields: 0
[2023-07-03 22:19:31] [config] type: transformer
[2023-07-03 22:19:31] [config] ulr: false
[2023-07-03 22:19:31] [config] ulr-dim-emb: 0
[2023-07-03 22:19:31] [config] ulr-dropout: 0
[2023-07-03 22:19:31] [config] ulr-keys-vectors: ""
[2023-07-03 22:19:31] [config] ulr-query-vectors: ""
[2023-07-03 22:19:31] [config] ulr-softmax-temperature: 1
[2023-07-03 22:19:31] [config] ulr-trainable-transformation: false
[2023-07-03 22:19:31] [config] unlikelihood-loss: false
[2023-07-03 22:19:31] [config] valid-freq: 50000000
[2023-07-03 22:19:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:19:31] [config] valid-max-length: 1000
[2023-07-03 22:19:31] [config] valid-metrics:
[2023-07-03 22:19:31] [config]   - cross-entropy
[2023-07-03 22:19:31] [config]   - translation
[2023-07-03 22:19:31] [config] valid-mini-batch: 32
[2023-07-03 22:19:31] [config] valid-reset-stalled: false
[2023-07-03 22:19:31] [config] valid-script-args:
[2023-07-03 22:19:31] [config]   []
[2023-07-03 22:19:31] [config] valid-script-path: ""
[2023-07-03 22:19:31] [config] valid-sets:
[2023-07-03 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:19:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:19:31] [config] vocabs:
[2023-07-03 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:19:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:19:31] [config] word-penalty: 0
[2023-07-03 22:19:31] [config] word-scores: false
[2023-07-03 22:19:31] [config] workspace: 2048
[2023-07-03 22:19:31] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:19:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:19:31] [training] Using single-device training
[2023-07-03 22:19:31] Synced seed 1234
[2023-07-03 22:19:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:19:31] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:19:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:19:31] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:19:31] [valid] No post-processing script given for validating translator
[2023-07-03 22:19:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:19:32] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:19:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:19:32] [comm] Using global sharding
[2023-07-03 22:19:32] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:19:32] [training] Using 1 GPUs
[2023-07-03 22:19:32] Training started
[2023-07-03 22:19:32] [data] Shuffling data
[2023-07-03 22:19:32] [data] Done reading 20,192 sentences
[2023-07-03 22:19:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:19:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 22:19:32] [logits] Applying loss function for 1 factor(s)
[2023-07-03 22:19:32] [memory] Reserving 276 MB, device gpu0
[2023-07-03 22:19:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 22:19:32] [memory] Reserving 276 MB, device gpu0
[2023-07-03 22:19:33] Parameter type float32, optimization type float32, casting types false
[2023-07-03 22:19:33] Allocating memory for Adam-specific shards
[2023-07-03 22:19:33] [memory] Reserving 552 MB, device gpu0
[2023-07-03 22:19:49] Seen 18,843 samples
[2023-07-03 22:19:49] Starting data epoch 2 in logical epoch 2
[2023-07-03 22:19:49] Training finished
[2023-07-03 22:19:52] [valid] Ep. 2 : Up. 297 : cross-entropy : 118.153 : new best
[2023-07-03 22:22:13] [valid] Ep. 2 : Up. 297 : translation : 0 : new best
[2023-07-03 22:22:13] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-03 22:22:16] Saving Adam parameters
[2023-07-03 22:22:17] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-03 22:22:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:22:27] [marian] Running on node19.datos.cluster.uy as process 35099 with command line:
[2023-07-03 22:22:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 2 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-03 22:22:27] [config] after: 0e
[2023-07-03 22:22:27] [config] after-batches: 0
[2023-07-03 22:22:27] [config] after-epochs: 2
[2023-07-03 22:22:27] [config] all-caps-every: 0
[2023-07-03 22:22:27] [config] allow-unk: false
[2023-07-03 22:22:27] [config] authors: false
[2023-07-03 22:22:27] [config] beam-size: 12
[2023-07-03 22:22:27] [config] bert-class-symbol: "[CLS]"
[2023-07-03 22:22:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-03 22:22:27] [config] bert-masking-fraction: 0.15
[2023-07-03 22:22:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-03 22:22:27] [config] bert-train-type-embeddings: true
[2023-07-03 22:22:27] [config] bert-type-vocab-size: 2
[2023-07-03 22:22:27] [config] build-info: ""
[2023-07-03 22:22:27] [config] check-gradient-nan: false
[2023-07-03 22:22:27] [config] check-nan: false
[2023-07-03 22:22:27] [config] cite: false
[2023-07-03 22:22:27] [config] clip-norm: 1
[2023-07-03 22:22:27] [config] cost-scaling:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] cost-type: ce-sum
[2023-07-03 22:22:27] [config] cpu-threads: 0
[2023-07-03 22:22:27] [config] data-threads: 8
[2023-07-03 22:22:27] [config] data-weighting: ""
[2023-07-03 22:22:27] [config] data-weighting-type: sentence
[2023-07-03 22:22:27] [config] dec-cell: gru
[2023-07-03 22:22:27] [config] dec-cell-base-depth: 2
[2023-07-03 22:22:27] [config] dec-cell-high-depth: 1
[2023-07-03 22:22:27] [config] dec-depth: 1
[2023-07-03 22:22:27] [config] devices:
[2023-07-03 22:22:27] [config]   - 0
[2023-07-03 22:22:27] [config] dim-emb: 512
[2023-07-03 22:22:27] [config] dim-rnn: 1024
[2023-07-03 22:22:27] [config] dim-vocabs:
[2023-07-03 22:22:27] [config]   - 54042
[2023-07-03 22:22:27] [config]   - 36507
[2023-07-03 22:22:27] [config] disp-first: 0
[2023-07-03 22:22:27] [config] disp-freq: 1000u
[2023-07-03 22:22:27] [config] disp-label-counts: true
[2023-07-03 22:22:27] [config] dropout-rnn: 0
[2023-07-03 22:22:27] [config] dropout-src: 0
[2023-07-03 22:22:27] [config] dropout-trg: 0
[2023-07-03 22:22:27] [config] dump-config: ""
[2023-07-03 22:22:27] [config] dynamic-gradient-scaling:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] early-stopping: 10
[2023-07-03 22:22:27] [config] early-stopping-on: first
[2023-07-03 22:22:27] [config] embedding-fix-src: false
[2023-07-03 22:22:27] [config] embedding-fix-trg: false
[2023-07-03 22:22:27] [config] embedding-normalization: false
[2023-07-03 22:22:27] [config] embedding-vectors:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] enc-cell: gru
[2023-07-03 22:22:27] [config] enc-cell-depth: 1
[2023-07-03 22:22:27] [config] enc-depth: 1
[2023-07-03 22:22:27] [config] enc-type: bidirectional
[2023-07-03 22:22:27] [config] english-title-case-every: 0
[2023-07-03 22:22:27] [config] exponential-smoothing: 0
[2023-07-03 22:22:27] [config] factor-weight: 1
[2023-07-03 22:22:27] [config] factors-combine: sum
[2023-07-03 22:22:27] [config] factors-dim-emb: 0
[2023-07-03 22:22:27] [config] gradient-checkpointing: false
[2023-07-03 22:22:27] [config] gradient-norm-average-window: 100
[2023-07-03 22:22:27] [config] guided-alignment: none
[2023-07-03 22:22:27] [config] guided-alignment-cost: mse
[2023-07-03 22:22:27] [config] guided-alignment-weight: 0.1
[2023-07-03 22:22:27] [config] ignore-model-config: false
[2023-07-03 22:22:27] [config] input-types:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] interpolate-env-vars: false
[2023-07-03 22:22:27] [config] keep-best: false
[2023-07-03 22:22:27] [config] label-smoothing: 0
[2023-07-03 22:22:27] [config] layer-normalization: false
[2023-07-03 22:22:27] [config] learn-rate: 0.0001
[2023-07-03 22:22:27] [config] lemma-dependency: ""
[2023-07-03 22:22:27] [config] lemma-dim-emb: 0
[2023-07-03 22:22:27] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-03 22:22:27] [config] log-level: info
[2023-07-03 22:22:27] [config] log-time-zone: ""
[2023-07-03 22:22:27] [config] logical-epoch:
[2023-07-03 22:22:27] [config]   - 1e
[2023-07-03 22:22:27] [config]   - 0
[2023-07-03 22:22:27] [config] lr-decay: 0
[2023-07-03 22:22:27] [config] lr-decay-freq: 50000
[2023-07-03 22:22:27] [config] lr-decay-inv-sqrt:
[2023-07-03 22:22:27] [config]   - 0
[2023-07-03 22:22:27] [config] lr-decay-repeat-warmup: false
[2023-07-03 22:22:27] [config] lr-decay-reset-optimizer: false
[2023-07-03 22:22:27] [config] lr-decay-start:
[2023-07-03 22:22:27] [config]   - 10
[2023-07-03 22:22:27] [config]   - 1
[2023-07-03 22:22:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-03 22:22:27] [config] lr-report: false
[2023-07-03 22:22:27] [config] lr-warmup: 0
[2023-07-03 22:22:27] [config] lr-warmup-at-reload: false
[2023-07-03 22:22:27] [config] lr-warmup-cycle: false
[2023-07-03 22:22:27] [config] lr-warmup-start-rate: 0
[2023-07-03 22:22:27] [config] max-length: 50
[2023-07-03 22:22:27] [config] max-length-crop: false
[2023-07-03 22:22:27] [config] max-length-factor: 3
[2023-07-03 22:22:27] [config] maxi-batch: 100
[2023-07-03 22:22:27] [config] maxi-batch-sort: trg
[2023-07-03 22:22:27] [config] mini-batch: 64
[2023-07-03 22:22:27] [config] mini-batch-fit: false
[2023-07-03 22:22:27] [config] mini-batch-fit-step: 10
[2023-07-03 22:22:27] [config] mini-batch-round-up: true
[2023-07-03 22:22:27] [config] mini-batch-track-lr: false
[2023-07-03 22:22:27] [config] mini-batch-warmup: 0
[2023-07-03 22:22:27] [config] mini-batch-words: 0
[2023-07-03 22:22:27] [config] mini-batch-words-ref: 0
[2023-07-03 22:22:27] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-03 22:22:27] [config] multi-loss-type: sum
[2023-07-03 22:22:27] [config] n-best: false
[2023-07-03 22:22:27] [config] no-nccl: false
[2023-07-03 22:22:27] [config] no-reload: false
[2023-07-03 22:22:27] [config] no-restore-corpus: false
[2023-07-03 22:22:27] [config] normalize: 0
[2023-07-03 22:22:27] [config] normalize-gradient: false
[2023-07-03 22:22:27] [config] num-devices: 0
[2023-07-03 22:22:27] [config] optimizer: adam
[2023-07-03 22:22:27] [config] optimizer-delay: 1
[2023-07-03 22:22:27] [config] optimizer-params:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] output-omit-bias: false
[2023-07-03 22:22:27] [config] overwrite: true
[2023-07-03 22:22:27] [config] precision:
[2023-07-03 22:22:27] [config]   - float32
[2023-07-03 22:22:27] [config]   - float32
[2023-07-03 22:22:27] [config] pretrained-model: ""
[2023-07-03 22:22:27] [config] quantize-biases: false
[2023-07-03 22:22:27] [config] quantize-bits: 0
[2023-07-03 22:22:27] [config] quantize-log-based: false
[2023-07-03 22:22:27] [config] quantize-optimization-steps: 0
[2023-07-03 22:22:27] [config] quiet: false
[2023-07-03 22:22:27] [config] quiet-translation: true
[2023-07-03 22:22:27] [config] relative-paths: false
[2023-07-03 22:22:27] [config] right-left: false
[2023-07-03 22:22:27] [config] save-freq: 10000u
[2023-07-03 22:22:27] [config] seed: 1234
[2023-07-03 22:22:27] [config] sentencepiece-alphas:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] sentencepiece-max-lines: 2000000
[2023-07-03 22:22:27] [config] sentencepiece-options: ""
[2023-07-03 22:22:27] [config] sharding: global
[2023-07-03 22:22:27] [config] shuffle: data
[2023-07-03 22:22:27] [config] shuffle-in-ram: false
[2023-07-03 22:22:27] [config] sigterm: save-and-exit
[2023-07-03 22:22:27] [config] skip: false
[2023-07-03 22:22:27] [config] sqlite: ""
[2023-07-03 22:22:27] [config] sqlite-drop: false
[2023-07-03 22:22:27] [config] sync-freq: 200u
[2023-07-03 22:22:27] [config] sync-sgd: false
[2023-07-03 22:22:27] [config] tempdir: /tmp
[2023-07-03 22:22:27] [config] tied-embeddings: false
[2023-07-03 22:22:27] [config] tied-embeddings-all: false
[2023-07-03 22:22:27] [config] tied-embeddings-src: false
[2023-07-03 22:22:27] [config] train-embedder-rank:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] train-sets:
[2023-07-03 22:22:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-03 22:22:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-03 22:22:27] [config] transformer-aan-activation: swish
[2023-07-03 22:22:27] [config] transformer-aan-depth: 2
[2023-07-03 22:22:27] [config] transformer-aan-nogate: false
[2023-07-03 22:22:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-03 22:22:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-03 22:22:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-03 22:22:27] [config] transformer-depth-scaling: false
[2023-07-03 22:22:27] [config] transformer-dim-aan: 2048
[2023-07-03 22:22:27] [config] transformer-dim-ffn: 2048
[2023-07-03 22:22:27] [config] transformer-dropout: 0
[2023-07-03 22:22:27] [config] transformer-dropout-attention: 0
[2023-07-03 22:22:27] [config] transformer-dropout-ffn: 0
[2023-07-03 22:22:27] [config] transformer-ffn-activation: swish
[2023-07-03 22:22:27] [config] transformer-ffn-depth: 2
[2023-07-03 22:22:27] [config] transformer-guided-alignment-layer: last
[2023-07-03 22:22:27] [config] transformer-heads: 8
[2023-07-03 22:22:27] [config] transformer-no-projection: false
[2023-07-03 22:22:27] [config] transformer-pool: false
[2023-07-03 22:22:27] [config] transformer-postprocess: dan
[2023-07-03 22:22:27] [config] transformer-postprocess-emb: d
[2023-07-03 22:22:27] [config] transformer-postprocess-top: ""
[2023-07-03 22:22:27] [config] transformer-preprocess: ""
[2023-07-03 22:22:27] [config] transformer-tied-layers:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] transformer-train-position-embeddings: false
[2023-07-03 22:22:27] [config] tsv: false
[2023-07-03 22:22:27] [config] tsv-fields: 0
[2023-07-03 22:22:27] [config] type: transformer
[2023-07-03 22:22:27] [config] ulr: false
[2023-07-03 22:22:27] [config] ulr-dim-emb: 0
[2023-07-03 22:22:27] [config] ulr-dropout: 0
[2023-07-03 22:22:27] [config] ulr-keys-vectors: ""
[2023-07-03 22:22:27] [config] ulr-query-vectors: ""
[2023-07-03 22:22:27] [config] ulr-softmax-temperature: 1
[2023-07-03 22:22:27] [config] ulr-trainable-transformation: false
[2023-07-03 22:22:27] [config] unlikelihood-loss: false
[2023-07-03 22:22:27] [config] valid-freq: 50000000
[2023-07-03 22:22:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-03 22:22:27] [config] valid-max-length: 1000
[2023-07-03 22:22:27] [config] valid-metrics:
[2023-07-03 22:22:27] [config]   - cross-entropy
[2023-07-03 22:22:27] [config]   - translation
[2023-07-03 22:22:27] [config] valid-mini-batch: 32
[2023-07-03 22:22:27] [config] valid-reset-stalled: false
[2023-07-03 22:22:27] [config] valid-script-args:
[2023-07-03 22:22:27] [config]   []
[2023-07-03 22:22:27] [config] valid-script-path: ""
[2023-07-03 22:22:27] [config] valid-sets:
[2023-07-03 22:22:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-03 22:22:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-03 22:22:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-03 22:22:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:22:27] [config] vocabs:
[2023-07-03 22:22:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:22:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:22:27] [config] word-penalty: 0
[2023-07-03 22:22:27] [config] word-scores: false
[2023-07-03 22:22:27] [config] workspace: 2048
[2023-07-03 22:22:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-03 22:22:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:22:27] [training] Using single-device training
[2023-07-03 22:22:28] Synced seed 1234
[2023-07-03 22:22:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-03 22:22:28] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-03 22:22:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-03 22:22:28] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-03 22:22:28] [valid] No post-processing script given for validating translator
[2023-07-03 22:22:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-03 22:22:29] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-03 22:22:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-03 22:22:29] [comm] Using global sharding
[2023-07-03 22:22:29] [comm] NCCLCommunicators constructed successfully
[2023-07-03 22:22:29] [training] Using 1 GPUs
[2023-07-03 22:22:29] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-03 22:22:31] Loading Adam parameters
[2023-07-03 22:22:31] [memory] Reserving 552 MB, device gpu0
[2023-07-03 22:22:31] [memory] Reserving 276 MB, device gpu0
[2023-07-03 22:22:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-03 22:22:31] [data] Restoring the corpus state to epoch 2, batch 297
[2023-07-03 22:22:31] [data] Shuffling data
[2023-07-03 22:22:31] [data] Done reading 20,192 sentences
[2023-07-03 22:22:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-03 22:22:32] Training started
[2023-07-03 22:22:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-03 22:22:32] [logits] Applying loss function for 1 factor(s)
[2023-07-03 22:22:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-03 22:22:32] [memory] Reserving 276 MB, device gpu0
[2023-07-03 22:22:32] Parameter type float32, optimization type float32, casting types false
[2023-07-03 22:22:49] Seen 18,843 samples
[2023-07-03 22:22:49] Starting data epoch 3 in logical epoch 3
[2023-07-03 22:22:49] Training finished
[2023-07-03 22:22:51] [valid] Ep. 3 : Up. 594 : cross-entropy : 110.908 : new best
[2023-07-03 22:25:05] [valid] Ep. 3 : Up. 594 : translation : 0 : new best
[2023-07-03 22:25:05] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-03 22:25:08] Saving Adam parameters
[2023-07-03 22:25:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 15:57:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 15:57:42] [marian] Running on node07.datos.cluster.uy as process 29233 with command line:
[2023-07-04 15:57:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 15:57:42] [config] after: 0e
[2023-07-04 15:57:42] [config] after-batches: 0
[2023-07-04 15:57:42] [config] after-epochs: 10
[2023-07-04 15:57:42] [config] all-caps-every: 0
[2023-07-04 15:57:42] [config] allow-unk: false
[2023-07-04 15:57:42] [config] authors: false
[2023-07-04 15:57:42] [config] beam-size: 12
[2023-07-04 15:57:42] [config] bert-class-symbol: "[CLS]"
[2023-07-04 15:57:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 15:57:42] [config] bert-masking-fraction: 0.15
[2023-07-04 15:57:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 15:57:42] [config] bert-train-type-embeddings: true
[2023-07-04 15:57:42] [config] bert-type-vocab-size: 2
[2023-07-04 15:57:42] [config] build-info: ""
[2023-07-04 15:57:42] [config] check-gradient-nan: false
[2023-07-04 15:57:42] [config] check-nan: false
[2023-07-04 15:57:42] [config] cite: false
[2023-07-04 15:57:42] [config] clip-norm: 1
[2023-07-04 15:57:42] [config] cost-scaling:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] cost-type: ce-sum
[2023-07-04 15:57:42] [config] cpu-threads: 0
[2023-07-04 15:57:42] [config] data-threads: 8
[2023-07-04 15:57:42] [config] data-weighting: ""
[2023-07-04 15:57:42] [config] data-weighting-type: sentence
[2023-07-04 15:57:42] [config] dec-cell: gru
[2023-07-04 15:57:42] [config] dec-cell-base-depth: 2
[2023-07-04 15:57:42] [config] dec-cell-high-depth: 1
[2023-07-04 15:57:42] [config] dec-depth: 1
[2023-07-04 15:57:42] [config] devices:
[2023-07-04 15:57:42] [config]   - 0
[2023-07-04 15:57:42] [config] dim-emb: 512
[2023-07-04 15:57:42] [config] dim-rnn: 1024
[2023-07-04 15:57:42] [config] dim-vocabs:
[2023-07-04 15:57:42] [config]   - 0
[2023-07-04 15:57:42] [config]   - 0
[2023-07-04 15:57:42] [config] disp-first: 0
[2023-07-04 15:57:42] [config] disp-freq: 1000u
[2023-07-04 15:57:42] [config] disp-label-counts: true
[2023-07-04 15:57:42] [config] dropout-rnn: 0
[2023-07-04 15:57:42] [config] dropout-src: 0
[2023-07-04 15:57:42] [config] dropout-trg: 0
[2023-07-04 15:57:42] [config] dump-config: ""
[2023-07-04 15:57:42] [config] dynamic-gradient-scaling:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] early-stopping: 10
[2023-07-04 15:57:42] [config] early-stopping-on: first
[2023-07-04 15:57:42] [config] embedding-fix-src: false
[2023-07-04 15:57:42] [config] embedding-fix-trg: false
[2023-07-04 15:57:42] [config] embedding-normalization: false
[2023-07-04 15:57:42] [config] embedding-vectors:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] enc-cell: gru
[2023-07-04 15:57:42] [config] enc-cell-depth: 1
[2023-07-04 15:57:42] [config] enc-depth: 1
[2023-07-04 15:57:42] [config] enc-type: bidirectional
[2023-07-04 15:57:42] [config] english-title-case-every: 0
[2023-07-04 15:57:42] [config] exponential-smoothing: 0
[2023-07-04 15:57:42] [config] factor-weight: 1
[2023-07-04 15:57:42] [config] factors-combine: sum
[2023-07-04 15:57:42] [config] factors-dim-emb: 0
[2023-07-04 15:57:42] [config] gradient-checkpointing: false
[2023-07-04 15:57:42] [config] gradient-norm-average-window: 100
[2023-07-04 15:57:42] [config] guided-alignment: none
[2023-07-04 15:57:42] [config] guided-alignment-cost: mse
[2023-07-04 15:57:42] [config] guided-alignment-weight: 0.1
[2023-07-04 15:57:42] [config] ignore-model-config: false
[2023-07-04 15:57:42] [config] input-types:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] interpolate-env-vars: false
[2023-07-04 15:57:42] [config] keep-best: false
[2023-07-04 15:57:42] [config] label-smoothing: 0
[2023-07-04 15:57:42] [config] layer-normalization: false
[2023-07-04 15:57:42] [config] learn-rate: 0.0001
[2023-07-04 15:57:42] [config] lemma-dependency: ""
[2023-07-04 15:57:42] [config] lemma-dim-emb: 0
[2023-07-04 15:57:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 15:57:42] [config] log-level: info
[2023-07-04 15:57:42] [config] log-time-zone: ""
[2023-07-04 15:57:42] [config] logical-epoch:
[2023-07-04 15:57:42] [config]   - 1e
[2023-07-04 15:57:42] [config]   - 0
[2023-07-04 15:57:42] [config] lr-decay: 0
[2023-07-04 15:57:42] [config] lr-decay-freq: 50000
[2023-07-04 15:57:42] [config] lr-decay-inv-sqrt:
[2023-07-04 15:57:42] [config]   - 0
[2023-07-04 15:57:42] [config] lr-decay-repeat-warmup: false
[2023-07-04 15:57:42] [config] lr-decay-reset-optimizer: false
[2023-07-04 15:57:42] [config] lr-decay-start:
[2023-07-04 15:57:42] [config]   - 10
[2023-07-04 15:57:42] [config]   - 1
[2023-07-04 15:57:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 15:57:42] [config] lr-report: false
[2023-07-04 15:57:42] [config] lr-warmup: 0
[2023-07-04 15:57:42] [config] lr-warmup-at-reload: false
[2023-07-04 15:57:42] [config] lr-warmup-cycle: false
[2023-07-04 15:57:42] [config] lr-warmup-start-rate: 0
[2023-07-04 15:57:42] [config] max-length: 50
[2023-07-04 15:57:42] [config] max-length-crop: false
[2023-07-04 15:57:42] [config] max-length-factor: 3
[2023-07-04 15:57:42] [config] maxi-batch: 100
[2023-07-04 15:57:42] [config] maxi-batch-sort: trg
[2023-07-04 15:57:42] [config] mini-batch: 64
[2023-07-04 15:57:42] [config] mini-batch-fit: false
[2023-07-04 15:57:42] [config] mini-batch-fit-step: 10
[2023-07-04 15:57:42] [config] mini-batch-round-up: true
[2023-07-04 15:57:42] [config] mini-batch-track-lr: false
[2023-07-04 15:57:42] [config] mini-batch-warmup: 0
[2023-07-04 15:57:42] [config] mini-batch-words: 0
[2023-07-04 15:57:42] [config] mini-batch-words-ref: 0
[2023-07-04 15:57:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 15:57:42] [config] multi-loss-type: sum
[2023-07-04 15:57:42] [config] n-best: false
[2023-07-04 15:57:42] [config] no-nccl: false
[2023-07-04 15:57:42] [config] no-reload: false
[2023-07-04 15:57:42] [config] no-restore-corpus: false
[2023-07-04 15:57:42] [config] normalize: 0
[2023-07-04 15:57:42] [config] normalize-gradient: false
[2023-07-04 15:57:42] [config] num-devices: 0
[2023-07-04 15:57:42] [config] optimizer: adam
[2023-07-04 15:57:42] [config] optimizer-delay: 1
[2023-07-04 15:57:42] [config] optimizer-params:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] output-omit-bias: false
[2023-07-04 15:57:42] [config] overwrite: true
[2023-07-04 15:57:42] [config] precision:
[2023-07-04 15:57:42] [config]   - float32
[2023-07-04 15:57:42] [config]   - float32
[2023-07-04 15:57:42] [config] pretrained-model: ""
[2023-07-04 15:57:42] [config] quantize-biases: false
[2023-07-04 15:57:42] [config] quantize-bits: 0
[2023-07-04 15:57:42] [config] quantize-log-based: false
[2023-07-04 15:57:42] [config] quantize-optimization-steps: 0
[2023-07-04 15:57:42] [config] quiet: false
[2023-07-04 15:57:42] [config] quiet-translation: true
[2023-07-04 15:57:42] [config] relative-paths: false
[2023-07-04 15:57:42] [config] right-left: false
[2023-07-04 15:57:42] [config] save-freq: 10000u
[2023-07-04 15:57:42] [config] seed: 1234
[2023-07-04 15:57:42] [config] sentencepiece-alphas:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] sentencepiece-max-lines: 2000000
[2023-07-04 15:57:42] [config] sentencepiece-options: ""
[2023-07-04 15:57:42] [config] sharding: global
[2023-07-04 15:57:42] [config] shuffle: data
[2023-07-04 15:57:42] [config] shuffle-in-ram: false
[2023-07-04 15:57:42] [config] sigterm: save-and-exit
[2023-07-04 15:57:42] [config] skip: false
[2023-07-04 15:57:42] [config] sqlite: ""
[2023-07-04 15:57:42] [config] sqlite-drop: false
[2023-07-04 15:57:42] [config] sync-freq: 200u
[2023-07-04 15:57:42] [config] sync-sgd: false
[2023-07-04 15:57:42] [config] tempdir: /tmp
[2023-07-04 15:57:42] [config] tied-embeddings: false
[2023-07-04 15:57:42] [config] tied-embeddings-all: false
[2023-07-04 15:57:42] [config] tied-embeddings-src: false
[2023-07-04 15:57:42] [config] train-embedder-rank:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] train-sets:
[2023-07-04 15:57:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 15:57:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 15:57:42] [config] transformer-aan-activation: swish
[2023-07-04 15:57:42] [config] transformer-aan-depth: 2
[2023-07-04 15:57:42] [config] transformer-aan-nogate: false
[2023-07-04 15:57:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 15:57:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 15:57:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 15:57:42] [config] transformer-depth-scaling: false
[2023-07-04 15:57:42] [config] transformer-dim-aan: 2048
[2023-07-04 15:57:42] [config] transformer-dim-ffn: 2048
[2023-07-04 15:57:42] [config] transformer-dropout: 0
[2023-07-04 15:57:42] [config] transformer-dropout-attention: 0
[2023-07-04 15:57:42] [config] transformer-dropout-ffn: 0
[2023-07-04 15:57:42] [config] transformer-ffn-activation: swish
[2023-07-04 15:57:42] [config] transformer-ffn-depth: 2
[2023-07-04 15:57:42] [config] transformer-guided-alignment-layer: last
[2023-07-04 15:57:42] [config] transformer-heads: 8
[2023-07-04 15:57:42] [config] transformer-no-projection: false
[2023-07-04 15:57:42] [config] transformer-pool: false
[2023-07-04 15:57:42] [config] transformer-postprocess: dan
[2023-07-04 15:57:42] [config] transformer-postprocess-emb: d
[2023-07-04 15:57:42] [config] transformer-postprocess-top: ""
[2023-07-04 15:57:42] [config] transformer-preprocess: ""
[2023-07-04 15:57:42] [config] transformer-tied-layers:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] transformer-train-position-embeddings: false
[2023-07-04 15:57:42] [config] tsv: false
[2023-07-04 15:57:42] [config] tsv-fields: 0
[2023-07-04 15:57:42] [config] type: amun
[2023-07-04 15:57:42] [config] ulr: false
[2023-07-04 15:57:42] [config] ulr-dim-emb: 0
[2023-07-04 15:57:42] [config] ulr-dropout: 0
[2023-07-04 15:57:42] [config] ulr-keys-vectors: ""
[2023-07-04 15:57:42] [config] ulr-query-vectors: ""
[2023-07-04 15:57:42] [config] ulr-softmax-temperature: 1
[2023-07-04 15:57:42] [config] ulr-trainable-transformation: false
[2023-07-04 15:57:42] [config] unlikelihood-loss: false
[2023-07-04 15:57:42] [config] valid-freq: 50000000
[2023-07-04 15:57:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 15:57:42] [config] valid-max-length: 1000
[2023-07-04 15:57:42] [config] valid-metrics:
[2023-07-04 15:57:42] [config]   - cross-entropy
[2023-07-04 15:57:42] [config]   - translation
[2023-07-04 15:57:42] [config] valid-mini-batch: 32
[2023-07-04 15:57:42] [config] valid-reset-stalled: false
[2023-07-04 15:57:42] [config] valid-script-args:
[2023-07-04 15:57:42] [config]   []
[2023-07-04 15:57:42] [config] valid-script-path: ""
[2023-07-04 15:57:42] [config] valid-sets:
[2023-07-04 15:57:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 15:57:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 15:57:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 15:57:42] [config] vocabs:
[2023-07-04 15:57:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 15:57:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 15:57:42] [config] word-penalty: 0
[2023-07-04 15:57:42] [config] word-scores: false
[2023-07-04 15:57:42] [config] workspace: 2048
[2023-07-04 15:57:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 15:57:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 15:57:42] [training] Using single-device training
[2023-07-04 15:57:42] Synced seed 1234
[2023-07-04 15:57:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 15:57:42] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 15:57:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 15:57:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 15:57:43] [valid] No post-processing script given for validating translator
[2023-07-04 15:57:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 15:57:44] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 15:57:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 15:57:44] [comm] Using global sharding
[2023-07-04 15:57:44] [comm] NCCLCommunicators constructed successfully
[2023-07-04 15:57:44] [training] Using 1 GPUs
[2023-07-04 15:57:44] Training started
[2023-07-04 15:57:44] [data] Shuffling data
[2023-07-04 15:57:44] [data] Done reading 20,192 sentences
[2023-07-04 15:57:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 15:57:44] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 15:57:45] [logits] Applying loss function for 1 factor(s)
[2023-07-04 15:57:45] [memory] Reserving 377 MB, device gpu0
[2023-07-04 15:57:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 15:57:48] [memory] Reserving 377 MB, device gpu0
[2023-07-04 15:57:48] Parameter type float32, optimization type float32, casting types false
[2023-07-04 15:57:48] Allocating memory for Adam-specific shards
[2023-07-04 15:57:48] [memory] Reserving 754 MB, device gpu0
[2023-07-04 15:58:27] Seen 18,843 samples
[2023-07-04 15:58:27] Starting data epoch 2 in logical epoch 2
[2023-07-04 15:58:27] [data] Shuffling data
[2023-07-04 15:58:27] [data] Done reading 20,192 sentences
[2023-07-04 15:58:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 15:59:07] Seen 18,843 samples
[2023-07-04 15:59:07] Starting data epoch 3 in logical epoch 3
[2023-07-04 15:59:07] [data] Shuffling data
[2023-07-04 15:59:07] [data] Done reading 20,192 sentences
[2023-07-04 15:59:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 15:59:46] Seen 18,843 samples
[2023-07-04 15:59:46] Starting data epoch 4 in logical epoch 4
[2023-07-04 15:59:46] [data] Shuffling data
[2023-07-04 15:59:46] [data] Done reading 20,192 sentences
[2023-07-04 15:59:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:00:01] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 6.20277643 * 1,343,216 @ 768 after 1,343,216 : Time 138.50s : 9698.35 words/s : gNorm 1.2052
[2023-07-04 16:00:26] Seen 18,843 samples
[2023-07-04 16:00:26] Starting data epoch 5 in logical epoch 5
[2023-07-04 16:00:26] [data] Shuffling data
[2023-07-04 16:00:26] [data] Done reading 20,192 sentences
[2023-07-04 16:00:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:01:11] Seen 18,843 samples
[2023-07-04 16:01:11] Starting data epoch 6 in logical epoch 6
[2023-07-04 16:01:11] [data] Shuffling data
[2023-07-04 16:01:11] [data] Done reading 20,192 sentences
[2023-07-04 16:01:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:01:58] Seen 18,843 samples
[2023-07-04 16:01:58] Starting data epoch 7 in logical epoch 7
[2023-07-04 16:01:58] [data] Shuffling data
[2023-07-04 16:01:58] [data] Done reading 20,192 sentences
[2023-07-04 16:01:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:02:32] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 5.28665686 * 1,334,929 @ 2,976 after 2,678,145 : Time 151.23s : 8827.07 words/s : gNorm 1.0643
[2023-07-04 16:02:45] Seen 18,843 samples
[2023-07-04 16:02:45] Starting data epoch 8 in logical epoch 8
[2023-07-04 16:02:45] [data] Shuffling data
[2023-07-04 16:02:45] [data] Done reading 20,192 sentences
[2023-07-04 16:02:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:03:35] Seen 18,843 samples
[2023-07-04 16:03:35] Starting data epoch 9 in logical epoch 9
[2023-07-04 16:03:35] [data] Shuffling data
[2023-07-04 16:03:35] [data] Done reading 20,192 sentences
[2023-07-04 16:03:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:04:23] Seen 18,843 samples
[2023-07-04 16:04:23] Starting data epoch 10 in logical epoch 10
[2023-07-04 16:04:23] [data] Shuffling data
[2023-07-04 16:04:23] [data] Done reading 20,192 sentences
[2023-07-04 16:04:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:05:11] Seen 18,843 samples
[2023-07-04 16:05:11] Starting data epoch 11 in logical epoch 11
[2023-07-04 16:05:11] Training finished
[2023-07-04 16:05:18] [valid] Ep. 11 : Up. 2968 : cross-entropy : 108.419 : new best
[2023-07-04 16:07:43] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-04 16:07:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:07:47] Saving Adam parameters
[2023-07-04 16:07:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:08:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:08:01] [marian] Running on node07.datos.cluster.uy as process 29845 with command line:
[2023-07-04 16:08:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 16:08:01] [config] after: 0e
[2023-07-04 16:08:01] [config] after-batches: 0
[2023-07-04 16:08:01] [config] after-epochs: 20
[2023-07-04 16:08:01] [config] all-caps-every: 0
[2023-07-04 16:08:01] [config] allow-unk: false
[2023-07-04 16:08:01] [config] authors: false
[2023-07-04 16:08:01] [config] beam-size: 12
[2023-07-04 16:08:01] [config] bert-class-symbol: "[CLS]"
[2023-07-04 16:08:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 16:08:01] [config] bert-masking-fraction: 0.15
[2023-07-04 16:08:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 16:08:01] [config] bert-train-type-embeddings: true
[2023-07-04 16:08:01] [config] bert-type-vocab-size: 2
[2023-07-04 16:08:01] [config] build-info: ""
[2023-07-04 16:08:01] [config] check-gradient-nan: false
[2023-07-04 16:08:01] [config] check-nan: false
[2023-07-04 16:08:01] [config] cite: false
[2023-07-04 16:08:01] [config] clip-norm: 1
[2023-07-04 16:08:01] [config] cost-scaling:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] cost-type: ce-sum
[2023-07-04 16:08:01] [config] cpu-threads: 0
[2023-07-04 16:08:01] [config] data-threads: 8
[2023-07-04 16:08:01] [config] data-weighting: ""
[2023-07-04 16:08:01] [config] data-weighting-type: sentence
[2023-07-04 16:08:01] [config] dec-cell: gru
[2023-07-04 16:08:01] [config] dec-cell-base-depth: 2
[2023-07-04 16:08:01] [config] dec-cell-high-depth: 1
[2023-07-04 16:08:01] [config] dec-depth: 1
[2023-07-04 16:08:01] [config] devices:
[2023-07-04 16:08:01] [config]   - 0
[2023-07-04 16:08:01] [config] dim-emb: 512
[2023-07-04 16:08:01] [config] dim-rnn: 1024
[2023-07-04 16:08:01] [config] dim-vocabs:
[2023-07-04 16:08:01] [config]   - 54042
[2023-07-04 16:08:01] [config]   - 36507
[2023-07-04 16:08:01] [config] disp-first: 0
[2023-07-04 16:08:01] [config] disp-freq: 1000u
[2023-07-04 16:08:01] [config] disp-label-counts: true
[2023-07-04 16:08:01] [config] dropout-rnn: 0
[2023-07-04 16:08:01] [config] dropout-src: 0
[2023-07-04 16:08:01] [config] dropout-trg: 0
[2023-07-04 16:08:01] [config] dump-config: ""
[2023-07-04 16:08:01] [config] dynamic-gradient-scaling:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] early-stopping: 10
[2023-07-04 16:08:01] [config] early-stopping-on: first
[2023-07-04 16:08:01] [config] embedding-fix-src: false
[2023-07-04 16:08:01] [config] embedding-fix-trg: false
[2023-07-04 16:08:01] [config] embedding-normalization: false
[2023-07-04 16:08:01] [config] embedding-vectors:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] enc-cell: gru
[2023-07-04 16:08:01] [config] enc-cell-depth: 1
[2023-07-04 16:08:01] [config] enc-depth: 1
[2023-07-04 16:08:01] [config] enc-type: bidirectional
[2023-07-04 16:08:01] [config] english-title-case-every: 0
[2023-07-04 16:08:01] [config] exponential-smoothing: 0
[2023-07-04 16:08:01] [config] factor-weight: 1
[2023-07-04 16:08:01] [config] factors-combine: sum
[2023-07-04 16:08:01] [config] factors-dim-emb: 0
[2023-07-04 16:08:01] [config] gradient-checkpointing: false
[2023-07-04 16:08:01] [config] gradient-norm-average-window: 100
[2023-07-04 16:08:01] [config] guided-alignment: none
[2023-07-04 16:08:01] [config] guided-alignment-cost: mse
[2023-07-04 16:08:01] [config] guided-alignment-weight: 0.1
[2023-07-04 16:08:01] [config] ignore-model-config: false
[2023-07-04 16:08:01] [config] input-types:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] interpolate-env-vars: false
[2023-07-04 16:08:01] [config] keep-best: false
[2023-07-04 16:08:01] [config] label-smoothing: 0
[2023-07-04 16:08:01] [config] layer-normalization: false
[2023-07-04 16:08:01] [config] learn-rate: 0.0001
[2023-07-04 16:08:01] [config] lemma-dependency: ""
[2023-07-04 16:08:01] [config] lemma-dim-emb: 0
[2023-07-04 16:08:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 16:08:01] [config] log-level: info
[2023-07-04 16:08:01] [config] log-time-zone: ""
[2023-07-04 16:08:01] [config] logical-epoch:
[2023-07-04 16:08:01] [config]   - 1e
[2023-07-04 16:08:01] [config]   - 0
[2023-07-04 16:08:01] [config] lr-decay: 0
[2023-07-04 16:08:01] [config] lr-decay-freq: 50000
[2023-07-04 16:08:01] [config] lr-decay-inv-sqrt:
[2023-07-04 16:08:01] [config]   - 0
[2023-07-04 16:08:01] [config] lr-decay-repeat-warmup: false
[2023-07-04 16:08:01] [config] lr-decay-reset-optimizer: false
[2023-07-04 16:08:01] [config] lr-decay-start:
[2023-07-04 16:08:01] [config]   - 10
[2023-07-04 16:08:01] [config]   - 1
[2023-07-04 16:08:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 16:08:01] [config] lr-report: false
[2023-07-04 16:08:01] [config] lr-warmup: 0
[2023-07-04 16:08:01] [config] lr-warmup-at-reload: false
[2023-07-04 16:08:01] [config] lr-warmup-cycle: false
[2023-07-04 16:08:01] [config] lr-warmup-start-rate: 0
[2023-07-04 16:08:01] [config] max-length: 50
[2023-07-04 16:08:01] [config] max-length-crop: false
[2023-07-04 16:08:01] [config] max-length-factor: 3
[2023-07-04 16:08:01] [config] maxi-batch: 100
[2023-07-04 16:08:01] [config] maxi-batch-sort: trg
[2023-07-04 16:08:01] [config] mini-batch: 64
[2023-07-04 16:08:01] [config] mini-batch-fit: false
[2023-07-04 16:08:01] [config] mini-batch-fit-step: 10
[2023-07-04 16:08:01] [config] mini-batch-round-up: true
[2023-07-04 16:08:01] [config] mini-batch-track-lr: false
[2023-07-04 16:08:01] [config] mini-batch-warmup: 0
[2023-07-04 16:08:01] [config] mini-batch-words: 0
[2023-07-04 16:08:01] [config] mini-batch-words-ref: 0
[2023-07-04 16:08:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:08:01] [config] multi-loss-type: sum
[2023-07-04 16:08:01] [config] n-best: false
[2023-07-04 16:08:01] [config] no-nccl: false
[2023-07-04 16:08:01] [config] no-reload: false
[2023-07-04 16:08:01] [config] no-restore-corpus: false
[2023-07-04 16:08:01] [config] normalize: 0
[2023-07-04 16:08:01] [config] normalize-gradient: false
[2023-07-04 16:08:01] [config] num-devices: 0
[2023-07-04 16:08:01] [config] optimizer: adam
[2023-07-04 16:08:01] [config] optimizer-delay: 1
[2023-07-04 16:08:01] [config] optimizer-params:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] output-omit-bias: false
[2023-07-04 16:08:01] [config] overwrite: true
[2023-07-04 16:08:01] [config] precision:
[2023-07-04 16:08:01] [config]   - float32
[2023-07-04 16:08:01] [config]   - float32
[2023-07-04 16:08:01] [config] pretrained-model: ""
[2023-07-04 16:08:01] [config] quantize-biases: false
[2023-07-04 16:08:01] [config] quantize-bits: 0
[2023-07-04 16:08:01] [config] quantize-log-based: false
[2023-07-04 16:08:01] [config] quantize-optimization-steps: 0
[2023-07-04 16:08:01] [config] quiet: false
[2023-07-04 16:08:01] [config] quiet-translation: true
[2023-07-04 16:08:01] [config] relative-paths: false
[2023-07-04 16:08:01] [config] right-left: false
[2023-07-04 16:08:01] [config] save-freq: 10000u
[2023-07-04 16:08:01] [config] seed: 1234
[2023-07-04 16:08:01] [config] sentencepiece-alphas:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] sentencepiece-max-lines: 2000000
[2023-07-04 16:08:01] [config] sentencepiece-options: ""
[2023-07-04 16:08:01] [config] sharding: global
[2023-07-04 16:08:01] [config] shuffle: data
[2023-07-04 16:08:01] [config] shuffle-in-ram: false
[2023-07-04 16:08:01] [config] sigterm: save-and-exit
[2023-07-04 16:08:01] [config] skip: false
[2023-07-04 16:08:01] [config] sqlite: ""
[2023-07-04 16:08:01] [config] sqlite-drop: false
[2023-07-04 16:08:01] [config] sync-freq: 200u
[2023-07-04 16:08:01] [config] sync-sgd: false
[2023-07-04 16:08:01] [config] tempdir: /tmp
[2023-07-04 16:08:01] [config] tied-embeddings: false
[2023-07-04 16:08:01] [config] tied-embeddings-all: false
[2023-07-04 16:08:01] [config] tied-embeddings-src: false
[2023-07-04 16:08:01] [config] train-embedder-rank:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] train-sets:
[2023-07-04 16:08:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 16:08:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 16:08:01] [config] transformer-aan-activation: swish
[2023-07-04 16:08:01] [config] transformer-aan-depth: 2
[2023-07-04 16:08:01] [config] transformer-aan-nogate: false
[2023-07-04 16:08:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 16:08:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 16:08:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 16:08:01] [config] transformer-depth-scaling: false
[2023-07-04 16:08:01] [config] transformer-dim-aan: 2048
[2023-07-04 16:08:01] [config] transformer-dim-ffn: 2048
[2023-07-04 16:08:01] [config] transformer-dropout: 0
[2023-07-04 16:08:01] [config] transformer-dropout-attention: 0
[2023-07-04 16:08:01] [config] transformer-dropout-ffn: 0
[2023-07-04 16:08:01] [config] transformer-ffn-activation: swish
[2023-07-04 16:08:01] [config] transformer-ffn-depth: 2
[2023-07-04 16:08:01] [config] transformer-guided-alignment-layer: last
[2023-07-04 16:08:01] [config] transformer-heads: 8
[2023-07-04 16:08:01] [config] transformer-no-projection: false
[2023-07-04 16:08:01] [config] transformer-pool: false
[2023-07-04 16:08:01] [config] transformer-postprocess: dan
[2023-07-04 16:08:01] [config] transformer-postprocess-emb: d
[2023-07-04 16:08:01] [config] transformer-postprocess-top: ""
[2023-07-04 16:08:01] [config] transformer-preprocess: ""
[2023-07-04 16:08:01] [config] transformer-tied-layers:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] transformer-train-position-embeddings: false
[2023-07-04 16:08:01] [config] tsv: false
[2023-07-04 16:08:01] [config] tsv-fields: 0
[2023-07-04 16:08:01] [config] type: amun
[2023-07-04 16:08:01] [config] ulr: false
[2023-07-04 16:08:01] [config] ulr-dim-emb: 0
[2023-07-04 16:08:01] [config] ulr-dropout: 0
[2023-07-04 16:08:01] [config] ulr-keys-vectors: ""
[2023-07-04 16:08:01] [config] ulr-query-vectors: ""
[2023-07-04 16:08:01] [config] ulr-softmax-temperature: 1
[2023-07-04 16:08:01] [config] ulr-trainable-transformation: false
[2023-07-04 16:08:01] [config] unlikelihood-loss: false
[2023-07-04 16:08:01] [config] valid-freq: 50000000
[2023-07-04 16:08:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 16:08:01] [config] valid-max-length: 1000
[2023-07-04 16:08:01] [config] valid-metrics:
[2023-07-04 16:08:01] [config]   - cross-entropy
[2023-07-04 16:08:01] [config]   - translation
[2023-07-04 16:08:01] [config] valid-mini-batch: 32
[2023-07-04 16:08:01] [config] valid-reset-stalled: false
[2023-07-04 16:08:01] [config] valid-script-args:
[2023-07-04 16:08:01] [config]   []
[2023-07-04 16:08:01] [config] valid-script-path: ""
[2023-07-04 16:08:01] [config] valid-sets:
[2023-07-04 16:08:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 16:08:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 16:08:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 16:08:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:08:01] [config] vocabs:
[2023-07-04 16:08:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:08:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:08:01] [config] word-penalty: 0
[2023-07-04 16:08:01] [config] word-scores: false
[2023-07-04 16:08:01] [config] workspace: 2048
[2023-07-04 16:08:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:08:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:08:01] [training] Using single-device training
[2023-07-04 16:08:02] Synced seed 1234
[2023-07-04 16:08:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:08:02] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 16:08:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:08:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 16:08:02] [valid] No post-processing script given for validating translator
[2023-07-04 16:08:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:08:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 16:08:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 16:08:03] [comm] Using global sharding
[2023-07-04 16:08:03] [comm] NCCLCommunicators constructed successfully
[2023-07-04 16:08:03] [training] Using 1 GPUs
[2023-07-04 16:08:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:08:05] Loading Adam parameters
[2023-07-04 16:08:06] [memory] Reserving 754 MB, device gpu0
[2023-07-04 16:08:06] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:08:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:08:06] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-04 16:08:06] [data] Shuffling data
[2023-07-04 16:08:06] [data] Done reading 20,192 sentences
[2023-07-04 16:08:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:08:06] Training started
[2023-07-04 16:08:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 16:08:06] [logits] Applying loss function for 1 factor(s)
[2023-07-04 16:08:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 16:08:06] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:08:06] Parameter type float32, optimization type float32, casting types false
[2023-07-04 16:08:10] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 4.78852415 * 1,343,919 @ 1,536 after 4,022,064 : Time 8.78s : 153008.18 words/s : gNorm 1.0255
[2023-07-04 16:08:49] Seen 18,843 samples
[2023-07-04 16:08:49] Starting data epoch 12 in logical epoch 12
[2023-07-04 16:08:49] [data] Shuffling data
[2023-07-04 16:08:49] [data] Done reading 20,192 sentences
[2023-07-04 16:08:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:09:37] Seen 18,843 samples
[2023-07-04 16:09:37] Starting data epoch 13 in logical epoch 13
[2023-07-04 16:09:37] [data] Shuffling data
[2023-07-04 16:09:37] [data] Done reading 20,192 sentences
[2023-07-04 16:09:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:10:27] Seen 18,843 samples
[2023-07-04 16:10:27] Starting data epoch 14 in logical epoch 14
[2023-07-04 16:10:27] [data] Shuffling data
[2023-07-04 16:10:27] [data] Done reading 20,192 sentences
[2023-07-04 16:10:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:10:52] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 4.41181850 * 1,354,393 @ 2,176 after 5,376,457 : Time 161.77s : 8372.28 words/s : gNorm 1.1067
[2023-07-04 16:11:16] Seen 18,843 samples
[2023-07-04 16:11:16] Starting data epoch 15 in logical epoch 15
[2023-07-04 16:11:16] [data] Shuffling data
[2023-07-04 16:11:16] [data] Done reading 20,192 sentences
[2023-07-04 16:11:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:12:05] Seen 18,843 samples
[2023-07-04 16:12:05] Starting data epoch 16 in logical epoch 16
[2023-07-04 16:12:05] [data] Shuffling data
[2023-07-04 16:12:05] [data] Done reading 20,192 sentences
[2023-07-04 16:12:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:12:55] Seen 18,843 samples
[2023-07-04 16:12:55] Starting data epoch 17 in logical epoch 17
[2023-07-04 16:12:55] [data] Shuffling data
[2023-07-04 16:12:55] [data] Done reading 20,192 sentences
[2023-07-04 16:12:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:13:37] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 4.09364367 * 1,331,522 @ 1,216 after 6,707,979 : Time 164.27s : 8105.93 words/s : gNorm 1.1963
[2023-07-04 16:13:44] Seen 18,843 samples
[2023-07-04 16:13:44] Starting data epoch 18 in logical epoch 18
[2023-07-04 16:13:44] [data] Shuffling data
[2023-07-04 16:13:44] [data] Done reading 20,192 sentences
[2023-07-04 16:13:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:14:34] Seen 18,843 samples
[2023-07-04 16:14:34] Starting data epoch 19 in logical epoch 19
[2023-07-04 16:14:34] [data] Shuffling data
[2023-07-04 16:14:34] [data] Done reading 20,192 sentences
[2023-07-04 16:14:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:15:24] Seen 18,843 samples
[2023-07-04 16:15:24] Starting data epoch 20 in logical epoch 20
[2023-07-04 16:15:24] [data] Shuffling data
[2023-07-04 16:15:24] [data] Done reading 20,192 sentences
[2023-07-04 16:15:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:16:13] Seen 18,843 samples
[2023-07-04 16:16:13] Starting data epoch 21 in logical epoch 21
[2023-07-04 16:16:13] Training finished
[2023-07-04 16:16:20] [valid] Ep. 21 : Up. 5933 : cross-entropy : 110.288 : stalled 1 times (last best: 108.419)
[2023-07-04 16:18:38] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-07-04 16:18:38] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:18:42] Saving Adam parameters
[2023-07-04 16:18:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:19:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:19:00] [marian] Running on node07.datos.cluster.uy as process 30789 with command line:
[2023-07-04 16:19:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 16:19:00] [config] after: 0e
[2023-07-04 16:19:00] [config] after-batches: 0
[2023-07-04 16:19:00] [config] after-epochs: 30
[2023-07-04 16:19:00] [config] all-caps-every: 0
[2023-07-04 16:19:00] [config] allow-unk: false
[2023-07-04 16:19:00] [config] authors: false
[2023-07-04 16:19:00] [config] beam-size: 12
[2023-07-04 16:19:00] [config] bert-class-symbol: "[CLS]"
[2023-07-04 16:19:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 16:19:00] [config] bert-masking-fraction: 0.15
[2023-07-04 16:19:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 16:19:00] [config] bert-train-type-embeddings: true
[2023-07-04 16:19:00] [config] bert-type-vocab-size: 2
[2023-07-04 16:19:00] [config] build-info: ""
[2023-07-04 16:19:00] [config] check-gradient-nan: false
[2023-07-04 16:19:00] [config] check-nan: false
[2023-07-04 16:19:00] [config] cite: false
[2023-07-04 16:19:00] [config] clip-norm: 1
[2023-07-04 16:19:00] [config] cost-scaling:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] cost-type: ce-sum
[2023-07-04 16:19:00] [config] cpu-threads: 0
[2023-07-04 16:19:00] [config] data-threads: 8
[2023-07-04 16:19:00] [config] data-weighting: ""
[2023-07-04 16:19:00] [config] data-weighting-type: sentence
[2023-07-04 16:19:00] [config] dec-cell: gru
[2023-07-04 16:19:00] [config] dec-cell-base-depth: 2
[2023-07-04 16:19:00] [config] dec-cell-high-depth: 1
[2023-07-04 16:19:00] [config] dec-depth: 1
[2023-07-04 16:19:00] [config] devices:
[2023-07-04 16:19:00] [config]   - 0
[2023-07-04 16:19:00] [config] dim-emb: 512
[2023-07-04 16:19:00] [config] dim-rnn: 1024
[2023-07-04 16:19:00] [config] dim-vocabs:
[2023-07-04 16:19:00] [config]   - 54042
[2023-07-04 16:19:00] [config]   - 36507
[2023-07-04 16:19:00] [config] disp-first: 0
[2023-07-04 16:19:00] [config] disp-freq: 1000u
[2023-07-04 16:19:00] [config] disp-label-counts: true
[2023-07-04 16:19:00] [config] dropout-rnn: 0
[2023-07-04 16:19:00] [config] dropout-src: 0
[2023-07-04 16:19:00] [config] dropout-trg: 0
[2023-07-04 16:19:00] [config] dump-config: ""
[2023-07-04 16:19:00] [config] dynamic-gradient-scaling:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] early-stopping: 10
[2023-07-04 16:19:00] [config] early-stopping-on: first
[2023-07-04 16:19:00] [config] embedding-fix-src: false
[2023-07-04 16:19:00] [config] embedding-fix-trg: false
[2023-07-04 16:19:00] [config] embedding-normalization: false
[2023-07-04 16:19:00] [config] embedding-vectors:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] enc-cell: gru
[2023-07-04 16:19:00] [config] enc-cell-depth: 1
[2023-07-04 16:19:00] [config] enc-depth: 1
[2023-07-04 16:19:00] [config] enc-type: bidirectional
[2023-07-04 16:19:00] [config] english-title-case-every: 0
[2023-07-04 16:19:00] [config] exponential-smoothing: 0
[2023-07-04 16:19:00] [config] factor-weight: 1
[2023-07-04 16:19:00] [config] factors-combine: sum
[2023-07-04 16:19:00] [config] factors-dim-emb: 0
[2023-07-04 16:19:00] [config] gradient-checkpointing: false
[2023-07-04 16:19:00] [config] gradient-norm-average-window: 100
[2023-07-04 16:19:00] [config] guided-alignment: none
[2023-07-04 16:19:00] [config] guided-alignment-cost: mse
[2023-07-04 16:19:00] [config] guided-alignment-weight: 0.1
[2023-07-04 16:19:00] [config] ignore-model-config: false
[2023-07-04 16:19:00] [config] input-types:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] interpolate-env-vars: false
[2023-07-04 16:19:00] [config] keep-best: false
[2023-07-04 16:19:00] [config] label-smoothing: 0
[2023-07-04 16:19:00] [config] layer-normalization: false
[2023-07-04 16:19:00] [config] learn-rate: 0.0001
[2023-07-04 16:19:00] [config] lemma-dependency: ""
[2023-07-04 16:19:00] [config] lemma-dim-emb: 0
[2023-07-04 16:19:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 16:19:00] [config] log-level: info
[2023-07-04 16:19:00] [config] log-time-zone: ""
[2023-07-04 16:19:00] [config] logical-epoch:
[2023-07-04 16:19:00] [config]   - 1e
[2023-07-04 16:19:00] [config]   - 0
[2023-07-04 16:19:00] [config] lr-decay: 0
[2023-07-04 16:19:00] [config] lr-decay-freq: 50000
[2023-07-04 16:19:00] [config] lr-decay-inv-sqrt:
[2023-07-04 16:19:00] [config]   - 0
[2023-07-04 16:19:00] [config] lr-decay-repeat-warmup: false
[2023-07-04 16:19:00] [config] lr-decay-reset-optimizer: false
[2023-07-04 16:19:00] [config] lr-decay-start:
[2023-07-04 16:19:00] [config]   - 10
[2023-07-04 16:19:00] [config]   - 1
[2023-07-04 16:19:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 16:19:00] [config] lr-report: false
[2023-07-04 16:19:00] [config] lr-warmup: 0
[2023-07-04 16:19:00] [config] lr-warmup-at-reload: false
[2023-07-04 16:19:00] [config] lr-warmup-cycle: false
[2023-07-04 16:19:00] [config] lr-warmup-start-rate: 0
[2023-07-04 16:19:00] [config] max-length: 50
[2023-07-04 16:19:00] [config] max-length-crop: false
[2023-07-04 16:19:00] [config] max-length-factor: 3
[2023-07-04 16:19:00] [config] maxi-batch: 100
[2023-07-04 16:19:00] [config] maxi-batch-sort: trg
[2023-07-04 16:19:00] [config] mini-batch: 64
[2023-07-04 16:19:00] [config] mini-batch-fit: false
[2023-07-04 16:19:00] [config] mini-batch-fit-step: 10
[2023-07-04 16:19:00] [config] mini-batch-round-up: true
[2023-07-04 16:19:00] [config] mini-batch-track-lr: false
[2023-07-04 16:19:00] [config] mini-batch-warmup: 0
[2023-07-04 16:19:00] [config] mini-batch-words: 0
[2023-07-04 16:19:00] [config] mini-batch-words-ref: 0
[2023-07-04 16:19:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:19:00] [config] multi-loss-type: sum
[2023-07-04 16:19:00] [config] n-best: false
[2023-07-04 16:19:00] [config] no-nccl: false
[2023-07-04 16:19:00] [config] no-reload: false
[2023-07-04 16:19:00] [config] no-restore-corpus: false
[2023-07-04 16:19:00] [config] normalize: 0
[2023-07-04 16:19:00] [config] normalize-gradient: false
[2023-07-04 16:19:00] [config] num-devices: 0
[2023-07-04 16:19:00] [config] optimizer: adam
[2023-07-04 16:19:00] [config] optimizer-delay: 1
[2023-07-04 16:19:00] [config] optimizer-params:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] output-omit-bias: false
[2023-07-04 16:19:00] [config] overwrite: true
[2023-07-04 16:19:00] [config] precision:
[2023-07-04 16:19:00] [config]   - float32
[2023-07-04 16:19:00] [config]   - float32
[2023-07-04 16:19:00] [config] pretrained-model: ""
[2023-07-04 16:19:00] [config] quantize-biases: false
[2023-07-04 16:19:00] [config] quantize-bits: 0
[2023-07-04 16:19:00] [config] quantize-log-based: false
[2023-07-04 16:19:00] [config] quantize-optimization-steps: 0
[2023-07-04 16:19:00] [config] quiet: false
[2023-07-04 16:19:00] [config] quiet-translation: true
[2023-07-04 16:19:00] [config] relative-paths: false
[2023-07-04 16:19:00] [config] right-left: false
[2023-07-04 16:19:00] [config] save-freq: 10000u
[2023-07-04 16:19:00] [config] seed: 1234
[2023-07-04 16:19:00] [config] sentencepiece-alphas:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] sentencepiece-max-lines: 2000000
[2023-07-04 16:19:00] [config] sentencepiece-options: ""
[2023-07-04 16:19:00] [config] sharding: global
[2023-07-04 16:19:00] [config] shuffle: data
[2023-07-04 16:19:00] [config] shuffle-in-ram: false
[2023-07-04 16:19:00] [config] sigterm: save-and-exit
[2023-07-04 16:19:00] [config] skip: false
[2023-07-04 16:19:00] [config] sqlite: ""
[2023-07-04 16:19:00] [config] sqlite-drop: false
[2023-07-04 16:19:00] [config] sync-freq: 200u
[2023-07-04 16:19:00] [config] sync-sgd: false
[2023-07-04 16:19:00] [config] tempdir: /tmp
[2023-07-04 16:19:00] [config] tied-embeddings: false
[2023-07-04 16:19:00] [config] tied-embeddings-all: false
[2023-07-04 16:19:00] [config] tied-embeddings-src: false
[2023-07-04 16:19:00] [config] train-embedder-rank:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] train-sets:
[2023-07-04 16:19:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 16:19:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 16:19:00] [config] transformer-aan-activation: swish
[2023-07-04 16:19:00] [config] transformer-aan-depth: 2
[2023-07-04 16:19:00] [config] transformer-aan-nogate: false
[2023-07-04 16:19:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 16:19:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 16:19:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 16:19:00] [config] transformer-depth-scaling: false
[2023-07-04 16:19:00] [config] transformer-dim-aan: 2048
[2023-07-04 16:19:00] [config] transformer-dim-ffn: 2048
[2023-07-04 16:19:00] [config] transformer-dropout: 0
[2023-07-04 16:19:00] [config] transformer-dropout-attention: 0
[2023-07-04 16:19:00] [config] transformer-dropout-ffn: 0
[2023-07-04 16:19:00] [config] transformer-ffn-activation: swish
[2023-07-04 16:19:00] [config] transformer-ffn-depth: 2
[2023-07-04 16:19:00] [config] transformer-guided-alignment-layer: last
[2023-07-04 16:19:00] [config] transformer-heads: 8
[2023-07-04 16:19:00] [config] transformer-no-projection: false
[2023-07-04 16:19:00] [config] transformer-pool: false
[2023-07-04 16:19:00] [config] transformer-postprocess: dan
[2023-07-04 16:19:00] [config] transformer-postprocess-emb: d
[2023-07-04 16:19:00] [config] transformer-postprocess-top: ""
[2023-07-04 16:19:00] [config] transformer-preprocess: ""
[2023-07-04 16:19:00] [config] transformer-tied-layers:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] transformer-train-position-embeddings: false
[2023-07-04 16:19:00] [config] tsv: false
[2023-07-04 16:19:00] [config] tsv-fields: 0
[2023-07-04 16:19:00] [config] type: amun
[2023-07-04 16:19:00] [config] ulr: false
[2023-07-04 16:19:00] [config] ulr-dim-emb: 0
[2023-07-04 16:19:00] [config] ulr-dropout: 0
[2023-07-04 16:19:00] [config] ulr-keys-vectors: ""
[2023-07-04 16:19:00] [config] ulr-query-vectors: ""
[2023-07-04 16:19:00] [config] ulr-softmax-temperature: 1
[2023-07-04 16:19:00] [config] ulr-trainable-transformation: false
[2023-07-04 16:19:00] [config] unlikelihood-loss: false
[2023-07-04 16:19:00] [config] valid-freq: 50000000
[2023-07-04 16:19:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 16:19:00] [config] valid-max-length: 1000
[2023-07-04 16:19:00] [config] valid-metrics:
[2023-07-04 16:19:00] [config]   - cross-entropy
[2023-07-04 16:19:00] [config]   - translation
[2023-07-04 16:19:00] [config] valid-mini-batch: 32
[2023-07-04 16:19:00] [config] valid-reset-stalled: false
[2023-07-04 16:19:00] [config] valid-script-args:
[2023-07-04 16:19:00] [config]   []
[2023-07-04 16:19:00] [config] valid-script-path: ""
[2023-07-04 16:19:00] [config] valid-sets:
[2023-07-04 16:19:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 16:19:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 16:19:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 16:19:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:19:00] [config] vocabs:
[2023-07-04 16:19:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:19:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:19:00] [config] word-penalty: 0
[2023-07-04 16:19:00] [config] word-scores: false
[2023-07-04 16:19:00] [config] workspace: 2048
[2023-07-04 16:19:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:19:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:19:00] [training] Using single-device training
[2023-07-04 16:19:01] Synced seed 1234
[2023-07-04 16:19:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:19:01] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 16:19:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:19:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 16:19:02] [valid] No post-processing script given for validating translator
[2023-07-04 16:19:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:19:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 16:19:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 16:19:03] [comm] Using global sharding
[2023-07-04 16:19:03] [comm] NCCLCommunicators constructed successfully
[2023-07-04 16:19:03] [training] Using 1 GPUs
[2023-07-04 16:19:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:19:06] Loading Adam parameters
[2023-07-04 16:19:06] [memory] Reserving 754 MB, device gpu0
[2023-07-04 16:19:07] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:19:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:19:07] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-07-04 16:19:07] [data] Shuffling data
[2023-07-04 16:19:07] [data] Done reading 20,192 sentences
[2023-07-04 16:19:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:19:07] Training started
[2023-07-04 16:19:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 16:19:07] [logits] Applying loss function for 1 factor(s)
[2023-07-04 16:19:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 16:19:07] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:19:07] Parameter type float32, optimization type float32, casting types false
[2023-07-04 16:19:16] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 3.82091665 * 1,344,567 @ 1,231 after 8,052,546 : Time 14.61s : 92030.93 words/s : gNorm 1.1865
[2023-07-04 16:19:51] Seen 18,843 samples
[2023-07-04 16:19:51] Starting data epoch 22 in logical epoch 22
[2023-07-04 16:19:51] [data] Shuffling data
[2023-07-04 16:19:51] [data] Done reading 20,192 sentences
[2023-07-04 16:19:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:20:40] Seen 18,843 samples
[2023-07-04 16:20:40] Starting data epoch 23 in logical epoch 23
[2023-07-04 16:20:40] [data] Shuffling data
[2023-07-04 16:20:40] [data] Done reading 20,192 sentences
[2023-07-04 16:20:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:21:29] Seen 18,843 samples
[2023-07-04 16:21:29] Starting data epoch 24 in logical epoch 24
[2023-07-04 16:21:29] [data] Shuffling data
[2023-07-04 16:21:29] [data] Done reading 20,192 sentences
[2023-07-04 16:21:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:21:59] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 3.56256604 * 1,339,673 @ 704 after 9,392,219 : Time 162.09s : 8265.14 words/s : gNorm 1.1918
[2023-07-04 16:22:18] Seen 18,843 samples
[2023-07-04 16:22:18] Starting data epoch 25 in logical epoch 25
[2023-07-04 16:22:18] [data] Shuffling data
[2023-07-04 16:22:18] [data] Done reading 20,192 sentences
[2023-07-04 16:22:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:23:08] Seen 18,843 samples
[2023-07-04 16:23:08] Starting data epoch 26 in logical epoch 26
[2023-07-04 16:23:08] [data] Shuffling data
[2023-07-04 16:23:08] [data] Done reading 20,192 sentences
[2023-07-04 16:23:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:23:58] Seen 18,843 samples
[2023-07-04 16:23:58] Starting data epoch 27 in logical epoch 27
[2023-07-04 16:23:58] [data] Shuffling data
[2023-07-04 16:23:58] [data] Done reading 20,192 sentences
[2023-07-04 16:23:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:24:44] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 3.33440542 * 1,339,074 @ 1,034 after 10,731,293 : Time 165.55s : 8088.41 words/s : gNorm 1.3835
[2023-07-04 16:24:46] Seen 18,843 samples
[2023-07-04 16:24:46] Starting data epoch 28 in logical epoch 28
[2023-07-04 16:24:46] [data] Shuffling data
[2023-07-04 16:24:46] [data] Done reading 20,192 sentences
[2023-07-04 16:24:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:25:35] Seen 18,843 samples
[2023-07-04 16:25:35] Starting data epoch 29 in logical epoch 29
[2023-07-04 16:25:35] [data] Shuffling data
[2023-07-04 16:25:35] [data] Done reading 20,192 sentences
[2023-07-04 16:25:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:26:24] Seen 18,843 samples
[2023-07-04 16:26:24] Starting data epoch 30 in logical epoch 30
[2023-07-04 16:26:24] [data] Shuffling data
[2023-07-04 16:26:24] [data] Done reading 20,192 sentences
[2023-07-04 16:26:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:27:15] Seen 18,843 samples
[2023-07-04 16:27:15] Starting data epoch 31 in logical epoch 31
[2023-07-04 16:27:15] Training finished
[2023-07-04 16:27:21] [valid] Ep. 31 : Up. 8898 : cross-entropy : 120.186 : stalled 2 times (last best: 108.419)
[2023-07-04 16:29:39] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-07-04 16:29:39] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:29:43] Saving Adam parameters
[2023-07-04 16:29:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:29:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:29:57] [marian] Running on node07.datos.cluster.uy as process 31409 with command line:
[2023-07-04 16:29:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 16:29:57] [config] after: 0e
[2023-07-04 16:29:57] [config] after-batches: 0
[2023-07-04 16:29:57] [config] after-epochs: 40
[2023-07-04 16:29:57] [config] all-caps-every: 0
[2023-07-04 16:29:57] [config] allow-unk: false
[2023-07-04 16:29:57] [config] authors: false
[2023-07-04 16:29:57] [config] beam-size: 12
[2023-07-04 16:29:57] [config] bert-class-symbol: "[CLS]"
[2023-07-04 16:29:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 16:29:57] [config] bert-masking-fraction: 0.15
[2023-07-04 16:29:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 16:29:57] [config] bert-train-type-embeddings: true
[2023-07-04 16:29:57] [config] bert-type-vocab-size: 2
[2023-07-04 16:29:57] [config] build-info: ""
[2023-07-04 16:29:57] [config] check-gradient-nan: false
[2023-07-04 16:29:57] [config] check-nan: false
[2023-07-04 16:29:57] [config] cite: false
[2023-07-04 16:29:57] [config] clip-norm: 1
[2023-07-04 16:29:57] [config] cost-scaling:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] cost-type: ce-sum
[2023-07-04 16:29:57] [config] cpu-threads: 0
[2023-07-04 16:29:57] [config] data-threads: 8
[2023-07-04 16:29:57] [config] data-weighting: ""
[2023-07-04 16:29:57] [config] data-weighting-type: sentence
[2023-07-04 16:29:57] [config] dec-cell: gru
[2023-07-04 16:29:57] [config] dec-cell-base-depth: 2
[2023-07-04 16:29:57] [config] dec-cell-high-depth: 1
[2023-07-04 16:29:57] [config] dec-depth: 1
[2023-07-04 16:29:57] [config] devices:
[2023-07-04 16:29:57] [config]   - 0
[2023-07-04 16:29:57] [config] dim-emb: 512
[2023-07-04 16:29:57] [config] dim-rnn: 1024
[2023-07-04 16:29:57] [config] dim-vocabs:
[2023-07-04 16:29:57] [config]   - 54042
[2023-07-04 16:29:57] [config]   - 36507
[2023-07-04 16:29:57] [config] disp-first: 0
[2023-07-04 16:29:57] [config] disp-freq: 1000u
[2023-07-04 16:29:57] [config] disp-label-counts: true
[2023-07-04 16:29:57] [config] dropout-rnn: 0
[2023-07-04 16:29:57] [config] dropout-src: 0
[2023-07-04 16:29:57] [config] dropout-trg: 0
[2023-07-04 16:29:57] [config] dump-config: ""
[2023-07-04 16:29:57] [config] dynamic-gradient-scaling:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] early-stopping: 10
[2023-07-04 16:29:57] [config] early-stopping-on: first
[2023-07-04 16:29:57] [config] embedding-fix-src: false
[2023-07-04 16:29:57] [config] embedding-fix-trg: false
[2023-07-04 16:29:57] [config] embedding-normalization: false
[2023-07-04 16:29:57] [config] embedding-vectors:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] enc-cell: gru
[2023-07-04 16:29:57] [config] enc-cell-depth: 1
[2023-07-04 16:29:57] [config] enc-depth: 1
[2023-07-04 16:29:57] [config] enc-type: bidirectional
[2023-07-04 16:29:57] [config] english-title-case-every: 0
[2023-07-04 16:29:57] [config] exponential-smoothing: 0
[2023-07-04 16:29:57] [config] factor-weight: 1
[2023-07-04 16:29:57] [config] factors-combine: sum
[2023-07-04 16:29:57] [config] factors-dim-emb: 0
[2023-07-04 16:29:57] [config] gradient-checkpointing: false
[2023-07-04 16:29:57] [config] gradient-norm-average-window: 100
[2023-07-04 16:29:57] [config] guided-alignment: none
[2023-07-04 16:29:57] [config] guided-alignment-cost: mse
[2023-07-04 16:29:57] [config] guided-alignment-weight: 0.1
[2023-07-04 16:29:57] [config] ignore-model-config: false
[2023-07-04 16:29:57] [config] input-types:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] interpolate-env-vars: false
[2023-07-04 16:29:57] [config] keep-best: false
[2023-07-04 16:29:57] [config] label-smoothing: 0
[2023-07-04 16:29:57] [config] layer-normalization: false
[2023-07-04 16:29:57] [config] learn-rate: 0.0001
[2023-07-04 16:29:57] [config] lemma-dependency: ""
[2023-07-04 16:29:57] [config] lemma-dim-emb: 0
[2023-07-04 16:29:57] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 16:29:57] [config] log-level: info
[2023-07-04 16:29:57] [config] log-time-zone: ""
[2023-07-04 16:29:57] [config] logical-epoch:
[2023-07-04 16:29:57] [config]   - 1e
[2023-07-04 16:29:57] [config]   - 0
[2023-07-04 16:29:57] [config] lr-decay: 0
[2023-07-04 16:29:57] [config] lr-decay-freq: 50000
[2023-07-04 16:29:57] [config] lr-decay-inv-sqrt:
[2023-07-04 16:29:57] [config]   - 0
[2023-07-04 16:29:57] [config] lr-decay-repeat-warmup: false
[2023-07-04 16:29:57] [config] lr-decay-reset-optimizer: false
[2023-07-04 16:29:57] [config] lr-decay-start:
[2023-07-04 16:29:57] [config]   - 10
[2023-07-04 16:29:57] [config]   - 1
[2023-07-04 16:29:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 16:29:57] [config] lr-report: false
[2023-07-04 16:29:57] [config] lr-warmup: 0
[2023-07-04 16:29:57] [config] lr-warmup-at-reload: false
[2023-07-04 16:29:57] [config] lr-warmup-cycle: false
[2023-07-04 16:29:57] [config] lr-warmup-start-rate: 0
[2023-07-04 16:29:57] [config] max-length: 50
[2023-07-04 16:29:57] [config] max-length-crop: false
[2023-07-04 16:29:57] [config] max-length-factor: 3
[2023-07-04 16:29:57] [config] maxi-batch: 100
[2023-07-04 16:29:57] [config] maxi-batch-sort: trg
[2023-07-04 16:29:57] [config] mini-batch: 64
[2023-07-04 16:29:57] [config] mini-batch-fit: false
[2023-07-04 16:29:57] [config] mini-batch-fit-step: 10
[2023-07-04 16:29:57] [config] mini-batch-round-up: true
[2023-07-04 16:29:57] [config] mini-batch-track-lr: false
[2023-07-04 16:29:57] [config] mini-batch-warmup: 0
[2023-07-04 16:29:57] [config] mini-batch-words: 0
[2023-07-04 16:29:57] [config] mini-batch-words-ref: 0
[2023-07-04 16:29:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:29:57] [config] multi-loss-type: sum
[2023-07-04 16:29:57] [config] n-best: false
[2023-07-04 16:29:57] [config] no-nccl: false
[2023-07-04 16:29:57] [config] no-reload: false
[2023-07-04 16:29:57] [config] no-restore-corpus: false
[2023-07-04 16:29:57] [config] normalize: 0
[2023-07-04 16:29:57] [config] normalize-gradient: false
[2023-07-04 16:29:57] [config] num-devices: 0
[2023-07-04 16:29:57] [config] optimizer: adam
[2023-07-04 16:29:57] [config] optimizer-delay: 1
[2023-07-04 16:29:57] [config] optimizer-params:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] output-omit-bias: false
[2023-07-04 16:29:57] [config] overwrite: true
[2023-07-04 16:29:57] [config] precision:
[2023-07-04 16:29:57] [config]   - float32
[2023-07-04 16:29:57] [config]   - float32
[2023-07-04 16:29:57] [config] pretrained-model: ""
[2023-07-04 16:29:57] [config] quantize-biases: false
[2023-07-04 16:29:57] [config] quantize-bits: 0
[2023-07-04 16:29:57] [config] quantize-log-based: false
[2023-07-04 16:29:57] [config] quantize-optimization-steps: 0
[2023-07-04 16:29:57] [config] quiet: false
[2023-07-04 16:29:57] [config] quiet-translation: true
[2023-07-04 16:29:57] [config] relative-paths: false
[2023-07-04 16:29:57] [config] right-left: false
[2023-07-04 16:29:57] [config] save-freq: 10000u
[2023-07-04 16:29:57] [config] seed: 1234
[2023-07-04 16:29:57] [config] sentencepiece-alphas:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] sentencepiece-max-lines: 2000000
[2023-07-04 16:29:57] [config] sentencepiece-options: ""
[2023-07-04 16:29:57] [config] sharding: global
[2023-07-04 16:29:57] [config] shuffle: data
[2023-07-04 16:29:57] [config] shuffle-in-ram: false
[2023-07-04 16:29:57] [config] sigterm: save-and-exit
[2023-07-04 16:29:57] [config] skip: false
[2023-07-04 16:29:57] [config] sqlite: ""
[2023-07-04 16:29:57] [config] sqlite-drop: false
[2023-07-04 16:29:57] [config] sync-freq: 200u
[2023-07-04 16:29:57] [config] sync-sgd: false
[2023-07-04 16:29:57] [config] tempdir: /tmp
[2023-07-04 16:29:57] [config] tied-embeddings: false
[2023-07-04 16:29:57] [config] tied-embeddings-all: false
[2023-07-04 16:29:57] [config] tied-embeddings-src: false
[2023-07-04 16:29:57] [config] train-embedder-rank:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] train-sets:
[2023-07-04 16:29:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 16:29:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 16:29:57] [config] transformer-aan-activation: swish
[2023-07-04 16:29:57] [config] transformer-aan-depth: 2
[2023-07-04 16:29:57] [config] transformer-aan-nogate: false
[2023-07-04 16:29:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 16:29:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 16:29:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 16:29:57] [config] transformer-depth-scaling: false
[2023-07-04 16:29:57] [config] transformer-dim-aan: 2048
[2023-07-04 16:29:57] [config] transformer-dim-ffn: 2048
[2023-07-04 16:29:57] [config] transformer-dropout: 0
[2023-07-04 16:29:57] [config] transformer-dropout-attention: 0
[2023-07-04 16:29:57] [config] transformer-dropout-ffn: 0
[2023-07-04 16:29:57] [config] transformer-ffn-activation: swish
[2023-07-04 16:29:57] [config] transformer-ffn-depth: 2
[2023-07-04 16:29:57] [config] transformer-guided-alignment-layer: last
[2023-07-04 16:29:57] [config] transformer-heads: 8
[2023-07-04 16:29:57] [config] transformer-no-projection: false
[2023-07-04 16:29:57] [config] transformer-pool: false
[2023-07-04 16:29:57] [config] transformer-postprocess: dan
[2023-07-04 16:29:57] [config] transformer-postprocess-emb: d
[2023-07-04 16:29:57] [config] transformer-postprocess-top: ""
[2023-07-04 16:29:57] [config] transformer-preprocess: ""
[2023-07-04 16:29:57] [config] transformer-tied-layers:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] transformer-train-position-embeddings: false
[2023-07-04 16:29:57] [config] tsv: false
[2023-07-04 16:29:57] [config] tsv-fields: 0
[2023-07-04 16:29:57] [config] type: amun
[2023-07-04 16:29:57] [config] ulr: false
[2023-07-04 16:29:57] [config] ulr-dim-emb: 0
[2023-07-04 16:29:57] [config] ulr-dropout: 0
[2023-07-04 16:29:57] [config] ulr-keys-vectors: ""
[2023-07-04 16:29:57] [config] ulr-query-vectors: ""
[2023-07-04 16:29:57] [config] ulr-softmax-temperature: 1
[2023-07-04 16:29:57] [config] ulr-trainable-transformation: false
[2023-07-04 16:29:57] [config] unlikelihood-loss: false
[2023-07-04 16:29:57] [config] valid-freq: 50000000
[2023-07-04 16:29:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 16:29:57] [config] valid-max-length: 1000
[2023-07-04 16:29:57] [config] valid-metrics:
[2023-07-04 16:29:57] [config]   - cross-entropy
[2023-07-04 16:29:57] [config]   - translation
[2023-07-04 16:29:57] [config] valid-mini-batch: 32
[2023-07-04 16:29:57] [config] valid-reset-stalled: false
[2023-07-04 16:29:57] [config] valid-script-args:
[2023-07-04 16:29:57] [config]   []
[2023-07-04 16:29:57] [config] valid-script-path: ""
[2023-07-04 16:29:57] [config] valid-sets:
[2023-07-04 16:29:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 16:29:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 16:29:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 16:29:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:29:57] [config] vocabs:
[2023-07-04 16:29:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:29:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:29:57] [config] word-penalty: 0
[2023-07-04 16:29:57] [config] word-scores: false
[2023-07-04 16:29:57] [config] workspace: 2048
[2023-07-04 16:29:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:29:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:29:57] [training] Using single-device training
[2023-07-04 16:29:58] Synced seed 1234
[2023-07-04 16:29:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:29:58] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 16:29:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:29:58] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 16:29:58] [valid] No post-processing script given for validating translator
[2023-07-04 16:29:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:29:59] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 16:29:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 16:29:59] [comm] Using global sharding
[2023-07-04 16:29:59] [comm] NCCLCommunicators constructed successfully
[2023-07-04 16:29:59] [training] Using 1 GPUs
[2023-07-04 16:29:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:30:01] Loading Adam parameters
[2023-07-04 16:30:02] [memory] Reserving 754 MB, device gpu0
[2023-07-04 16:30:02] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:30:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:30:02] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-07-04 16:30:02] [data] Shuffling data
[2023-07-04 16:30:02] [data] Done reading 20,192 sentences
[2023-07-04 16:30:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:30:02] Training started
[2023-07-04 16:30:02] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 16:30:02] [logits] Applying loss function for 1 factor(s)
[2023-07-04 16:30:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 16:30:02] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:30:03] Parameter type float32, optimization type float32, casting types false
[2023-07-04 16:30:16] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 3.09261084 * 1,341,072 @ 320 after 12,072,365 : Time 18.26s : 73424.31 words/s : gNorm 1.3229
[2023-07-04 16:30:47] Seen 18,843 samples
[2023-07-04 16:30:47] Starting data epoch 32 in logical epoch 32
[2023-07-04 16:30:47] [data] Shuffling data
[2023-07-04 16:30:47] [data] Done reading 20,192 sentences
[2023-07-04 16:30:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:31:35] Seen 18,843 samples
[2023-07-04 16:31:35] Starting data epoch 33 in logical epoch 33
[2023-07-04 16:31:35] [data] Shuffling data
[2023-07-04 16:31:35] [data] Done reading 20,192 sentences
[2023-07-04 16:31:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:32:25] Seen 18,843 samples
[2023-07-04 16:32:25] Starting data epoch 34 in logical epoch 34
[2023-07-04 16:32:25] [data] Shuffling data
[2023-07-04 16:32:25] [data] Done reading 20,192 sentences
[2023-07-04 16:32:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:33:01] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 2.87342453 * 1,347,521 @ 882 after 13,419,886 : Time 164.86s : 8173.79 words/s : gNorm 1.3324
[2023-07-04 16:33:01] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:33:04] Saving Adam parameters
[2023-07-04 16:33:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:33:25] Seen 18,843 samples
[2023-07-04 16:33:25] Starting data epoch 35 in logical epoch 35
[2023-07-04 16:33:25] [data] Shuffling data
[2023-07-04 16:33:25] [data] Done reading 20,192 sentences
[2023-07-04 16:33:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:34:13] Seen 18,843 samples
[2023-07-04 16:34:13] Starting data epoch 36 in logical epoch 36
[2023-07-04 16:34:13] [data] Shuffling data
[2023-07-04 16:34:13] [data] Done reading 20,192 sentences
[2023-07-04 16:34:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:35:02] Seen 18,843 samples
[2023-07-04 16:35:02] Starting data epoch 37 in logical epoch 37
[2023-07-04 16:35:02] [data] Shuffling data
[2023-07-04 16:35:02] [data] Done reading 20,192 sentences
[2023-07-04 16:35:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:35:52] Seen 18,843 samples
[2023-07-04 16:35:52] Starting data epoch 38 in logical epoch 38
[2023-07-04 16:35:52] [data] Shuffling data
[2023-07-04 16:35:52] [data] Done reading 20,192 sentences
[2023-07-04 16:35:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:35:57] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 2.65864277 * 1,344,952 @ 1,403 after 14,764,838 : Time 175.94s : 7644.50 words/s : gNorm 1.2607
[2023-07-04 16:36:41] Seen 18,843 samples
[2023-07-04 16:36:41] Starting data epoch 39 in logical epoch 39
[2023-07-04 16:36:41] [data] Shuffling data
[2023-07-04 16:36:41] [data] Done reading 20,192 sentences
[2023-07-04 16:36:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:37:30] Seen 18,843 samples
[2023-07-04 16:37:30] Starting data epoch 40 in logical epoch 40
[2023-07-04 16:37:30] [data] Shuffling data
[2023-07-04 16:37:30] [data] Done reading 20,192 sentences
[2023-07-04 16:37:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:38:19] Seen 18,843 samples
[2023-07-04 16:38:19] Starting data epoch 41 in logical epoch 41
[2023-07-04 16:38:19] Training finished
[2023-07-04 16:38:26] [valid] Ep. 41 : Up. 11864 : cross-entropy : 130.046 : stalled 3 times (last best: 108.419)
[2023-07-04 16:40:43] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-07-04 16:40:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:40:47] Saving Adam parameters
[2023-07-04 16:40:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:41:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:41:01] [marian] Running on node07.datos.cluster.uy as process 32037 with command line:
[2023-07-04 16:41:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 16:41:01] [config] after: 0e
[2023-07-04 16:41:01] [config] after-batches: 0
[2023-07-04 16:41:01] [config] after-epochs: 50
[2023-07-04 16:41:01] [config] all-caps-every: 0
[2023-07-04 16:41:01] [config] allow-unk: false
[2023-07-04 16:41:01] [config] authors: false
[2023-07-04 16:41:01] [config] beam-size: 12
[2023-07-04 16:41:01] [config] bert-class-symbol: "[CLS]"
[2023-07-04 16:41:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 16:41:01] [config] bert-masking-fraction: 0.15
[2023-07-04 16:41:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 16:41:01] [config] bert-train-type-embeddings: true
[2023-07-04 16:41:01] [config] bert-type-vocab-size: 2
[2023-07-04 16:41:01] [config] build-info: ""
[2023-07-04 16:41:01] [config] check-gradient-nan: false
[2023-07-04 16:41:01] [config] check-nan: false
[2023-07-04 16:41:01] [config] cite: false
[2023-07-04 16:41:01] [config] clip-norm: 1
[2023-07-04 16:41:01] [config] cost-scaling:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] cost-type: ce-sum
[2023-07-04 16:41:01] [config] cpu-threads: 0
[2023-07-04 16:41:01] [config] data-threads: 8
[2023-07-04 16:41:01] [config] data-weighting: ""
[2023-07-04 16:41:01] [config] data-weighting-type: sentence
[2023-07-04 16:41:01] [config] dec-cell: gru
[2023-07-04 16:41:01] [config] dec-cell-base-depth: 2
[2023-07-04 16:41:01] [config] dec-cell-high-depth: 1
[2023-07-04 16:41:01] [config] dec-depth: 1
[2023-07-04 16:41:01] [config] devices:
[2023-07-04 16:41:01] [config]   - 0
[2023-07-04 16:41:01] [config] dim-emb: 512
[2023-07-04 16:41:01] [config] dim-rnn: 1024
[2023-07-04 16:41:01] [config] dim-vocabs:
[2023-07-04 16:41:01] [config]   - 54042
[2023-07-04 16:41:01] [config]   - 36507
[2023-07-04 16:41:01] [config] disp-first: 0
[2023-07-04 16:41:01] [config] disp-freq: 1000u
[2023-07-04 16:41:01] [config] disp-label-counts: true
[2023-07-04 16:41:01] [config] dropout-rnn: 0
[2023-07-04 16:41:01] [config] dropout-src: 0
[2023-07-04 16:41:01] [config] dropout-trg: 0
[2023-07-04 16:41:01] [config] dump-config: ""
[2023-07-04 16:41:01] [config] dynamic-gradient-scaling:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] early-stopping: 10
[2023-07-04 16:41:01] [config] early-stopping-on: first
[2023-07-04 16:41:01] [config] embedding-fix-src: false
[2023-07-04 16:41:01] [config] embedding-fix-trg: false
[2023-07-04 16:41:01] [config] embedding-normalization: false
[2023-07-04 16:41:01] [config] embedding-vectors:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] enc-cell: gru
[2023-07-04 16:41:01] [config] enc-cell-depth: 1
[2023-07-04 16:41:01] [config] enc-depth: 1
[2023-07-04 16:41:01] [config] enc-type: bidirectional
[2023-07-04 16:41:01] [config] english-title-case-every: 0
[2023-07-04 16:41:01] [config] exponential-smoothing: 0
[2023-07-04 16:41:01] [config] factor-weight: 1
[2023-07-04 16:41:01] [config] factors-combine: sum
[2023-07-04 16:41:01] [config] factors-dim-emb: 0
[2023-07-04 16:41:01] [config] gradient-checkpointing: false
[2023-07-04 16:41:01] [config] gradient-norm-average-window: 100
[2023-07-04 16:41:01] [config] guided-alignment: none
[2023-07-04 16:41:01] [config] guided-alignment-cost: mse
[2023-07-04 16:41:01] [config] guided-alignment-weight: 0.1
[2023-07-04 16:41:01] [config] ignore-model-config: false
[2023-07-04 16:41:01] [config] input-types:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] interpolate-env-vars: false
[2023-07-04 16:41:01] [config] keep-best: false
[2023-07-04 16:41:01] [config] label-smoothing: 0
[2023-07-04 16:41:01] [config] layer-normalization: false
[2023-07-04 16:41:01] [config] learn-rate: 0.0001
[2023-07-04 16:41:01] [config] lemma-dependency: ""
[2023-07-04 16:41:01] [config] lemma-dim-emb: 0
[2023-07-04 16:41:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 16:41:01] [config] log-level: info
[2023-07-04 16:41:01] [config] log-time-zone: ""
[2023-07-04 16:41:01] [config] logical-epoch:
[2023-07-04 16:41:01] [config]   - 1e
[2023-07-04 16:41:01] [config]   - 0
[2023-07-04 16:41:01] [config] lr-decay: 0
[2023-07-04 16:41:01] [config] lr-decay-freq: 50000
[2023-07-04 16:41:01] [config] lr-decay-inv-sqrt:
[2023-07-04 16:41:01] [config]   - 0
[2023-07-04 16:41:01] [config] lr-decay-repeat-warmup: false
[2023-07-04 16:41:01] [config] lr-decay-reset-optimizer: false
[2023-07-04 16:41:01] [config] lr-decay-start:
[2023-07-04 16:41:01] [config]   - 10
[2023-07-04 16:41:01] [config]   - 1
[2023-07-04 16:41:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 16:41:01] [config] lr-report: false
[2023-07-04 16:41:01] [config] lr-warmup: 0
[2023-07-04 16:41:01] [config] lr-warmup-at-reload: false
[2023-07-04 16:41:01] [config] lr-warmup-cycle: false
[2023-07-04 16:41:01] [config] lr-warmup-start-rate: 0
[2023-07-04 16:41:01] [config] max-length: 50
[2023-07-04 16:41:01] [config] max-length-crop: false
[2023-07-04 16:41:01] [config] max-length-factor: 3
[2023-07-04 16:41:01] [config] maxi-batch: 100
[2023-07-04 16:41:01] [config] maxi-batch-sort: trg
[2023-07-04 16:41:01] [config] mini-batch: 64
[2023-07-04 16:41:01] [config] mini-batch-fit: false
[2023-07-04 16:41:01] [config] mini-batch-fit-step: 10
[2023-07-04 16:41:01] [config] mini-batch-round-up: true
[2023-07-04 16:41:01] [config] mini-batch-track-lr: false
[2023-07-04 16:41:01] [config] mini-batch-warmup: 0
[2023-07-04 16:41:01] [config] mini-batch-words: 0
[2023-07-04 16:41:01] [config] mini-batch-words-ref: 0
[2023-07-04 16:41:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:41:01] [config] multi-loss-type: sum
[2023-07-04 16:41:01] [config] n-best: false
[2023-07-04 16:41:01] [config] no-nccl: false
[2023-07-04 16:41:01] [config] no-reload: false
[2023-07-04 16:41:01] [config] no-restore-corpus: false
[2023-07-04 16:41:01] [config] normalize: 0
[2023-07-04 16:41:01] [config] normalize-gradient: false
[2023-07-04 16:41:01] [config] num-devices: 0
[2023-07-04 16:41:01] [config] optimizer: adam
[2023-07-04 16:41:01] [config] optimizer-delay: 1
[2023-07-04 16:41:01] [config] optimizer-params:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] output-omit-bias: false
[2023-07-04 16:41:01] [config] overwrite: true
[2023-07-04 16:41:01] [config] precision:
[2023-07-04 16:41:01] [config]   - float32
[2023-07-04 16:41:01] [config]   - float32
[2023-07-04 16:41:01] [config] pretrained-model: ""
[2023-07-04 16:41:01] [config] quantize-biases: false
[2023-07-04 16:41:01] [config] quantize-bits: 0
[2023-07-04 16:41:01] [config] quantize-log-based: false
[2023-07-04 16:41:01] [config] quantize-optimization-steps: 0
[2023-07-04 16:41:01] [config] quiet: false
[2023-07-04 16:41:01] [config] quiet-translation: true
[2023-07-04 16:41:01] [config] relative-paths: false
[2023-07-04 16:41:01] [config] right-left: false
[2023-07-04 16:41:01] [config] save-freq: 10000u
[2023-07-04 16:41:01] [config] seed: 1234
[2023-07-04 16:41:01] [config] sentencepiece-alphas:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] sentencepiece-max-lines: 2000000
[2023-07-04 16:41:01] [config] sentencepiece-options: ""
[2023-07-04 16:41:01] [config] sharding: global
[2023-07-04 16:41:01] [config] shuffle: data
[2023-07-04 16:41:01] [config] shuffle-in-ram: false
[2023-07-04 16:41:01] [config] sigterm: save-and-exit
[2023-07-04 16:41:01] [config] skip: false
[2023-07-04 16:41:01] [config] sqlite: ""
[2023-07-04 16:41:01] [config] sqlite-drop: false
[2023-07-04 16:41:01] [config] sync-freq: 200u
[2023-07-04 16:41:01] [config] sync-sgd: false
[2023-07-04 16:41:01] [config] tempdir: /tmp
[2023-07-04 16:41:01] [config] tied-embeddings: false
[2023-07-04 16:41:01] [config] tied-embeddings-all: false
[2023-07-04 16:41:01] [config] tied-embeddings-src: false
[2023-07-04 16:41:01] [config] train-embedder-rank:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] train-sets:
[2023-07-04 16:41:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 16:41:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 16:41:01] [config] transformer-aan-activation: swish
[2023-07-04 16:41:01] [config] transformer-aan-depth: 2
[2023-07-04 16:41:01] [config] transformer-aan-nogate: false
[2023-07-04 16:41:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 16:41:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 16:41:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 16:41:01] [config] transformer-depth-scaling: false
[2023-07-04 16:41:01] [config] transformer-dim-aan: 2048
[2023-07-04 16:41:01] [config] transformer-dim-ffn: 2048
[2023-07-04 16:41:01] [config] transformer-dropout: 0
[2023-07-04 16:41:01] [config] transformer-dropout-attention: 0
[2023-07-04 16:41:01] [config] transformer-dropout-ffn: 0
[2023-07-04 16:41:01] [config] transformer-ffn-activation: swish
[2023-07-04 16:41:01] [config] transformer-ffn-depth: 2
[2023-07-04 16:41:01] [config] transformer-guided-alignment-layer: last
[2023-07-04 16:41:01] [config] transformer-heads: 8
[2023-07-04 16:41:01] [config] transformer-no-projection: false
[2023-07-04 16:41:01] [config] transformer-pool: false
[2023-07-04 16:41:01] [config] transformer-postprocess: dan
[2023-07-04 16:41:01] [config] transformer-postprocess-emb: d
[2023-07-04 16:41:01] [config] transformer-postprocess-top: ""
[2023-07-04 16:41:01] [config] transformer-preprocess: ""
[2023-07-04 16:41:01] [config] transformer-tied-layers:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] transformer-train-position-embeddings: false
[2023-07-04 16:41:01] [config] tsv: false
[2023-07-04 16:41:01] [config] tsv-fields: 0
[2023-07-04 16:41:01] [config] type: amun
[2023-07-04 16:41:01] [config] ulr: false
[2023-07-04 16:41:01] [config] ulr-dim-emb: 0
[2023-07-04 16:41:01] [config] ulr-dropout: 0
[2023-07-04 16:41:01] [config] ulr-keys-vectors: ""
[2023-07-04 16:41:01] [config] ulr-query-vectors: ""
[2023-07-04 16:41:01] [config] ulr-softmax-temperature: 1
[2023-07-04 16:41:01] [config] ulr-trainable-transformation: false
[2023-07-04 16:41:01] [config] unlikelihood-loss: false
[2023-07-04 16:41:01] [config] valid-freq: 50000000
[2023-07-04 16:41:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 16:41:01] [config] valid-max-length: 1000
[2023-07-04 16:41:01] [config] valid-metrics:
[2023-07-04 16:41:01] [config]   - cross-entropy
[2023-07-04 16:41:01] [config]   - translation
[2023-07-04 16:41:01] [config] valid-mini-batch: 32
[2023-07-04 16:41:01] [config] valid-reset-stalled: false
[2023-07-04 16:41:01] [config] valid-script-args:
[2023-07-04 16:41:01] [config]   []
[2023-07-04 16:41:01] [config] valid-script-path: ""
[2023-07-04 16:41:01] [config] valid-sets:
[2023-07-04 16:41:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 16:41:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 16:41:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 16:41:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:41:01] [config] vocabs:
[2023-07-04 16:41:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:41:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:41:01] [config] word-penalty: 0
[2023-07-04 16:41:01] [config] word-scores: false
[2023-07-04 16:41:01] [config] workspace: 2048
[2023-07-04 16:41:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:41:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:41:01] [training] Using single-device training
[2023-07-04 16:41:02] Synced seed 1234
[2023-07-04 16:41:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:41:02] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 16:41:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:41:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 16:41:02] [valid] No post-processing script given for validating translator
[2023-07-04 16:41:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:41:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 16:41:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 16:41:03] [comm] Using global sharding
[2023-07-04 16:41:03] [comm] NCCLCommunicators constructed successfully
[2023-07-04 16:41:03] [training] Using 1 GPUs
[2023-07-04 16:41:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:41:06] Loading Adam parameters
[2023-07-04 16:41:06] [memory] Reserving 754 MB, device gpu0
[2023-07-04 16:41:06] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:41:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:41:06] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-07-04 16:41:06] [data] Shuffling data
[2023-07-04 16:41:06] [data] Done reading 20,192 sentences
[2023-07-04 16:41:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:41:06] Training started
[2023-07-04 16:41:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 16:41:06] [logits] Applying loss function for 1 factor(s)
[2023-07-04 16:41:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 16:41:06] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:41:07] Parameter type float32, optimization type float32, casting types false
[2023-07-04 16:41:25] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 2.43036723 * 1,335,380 @ 968 after 16,100,218 : Time 23.22s : 57511.22 words/s : gNorm 1.3473
[2023-07-04 16:41:50] Seen 18,843 samples
[2023-07-04 16:41:50] Starting data epoch 42 in logical epoch 42
[2023-07-04 16:41:50] [data] Shuffling data
[2023-07-04 16:41:50] [data] Done reading 20,192 sentences
[2023-07-04 16:41:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:42:39] Seen 18,843 samples
[2023-07-04 16:42:39] Starting data epoch 43 in logical epoch 43
[2023-07-04 16:42:39] [data] Shuffling data
[2023-07-04 16:42:39] [data] Done reading 20,192 sentences
[2023-07-04 16:42:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:43:28] Seen 18,843 samples
[2023-07-04 16:43:28] Starting data epoch 44 in logical epoch 44
[2023-07-04 16:43:28] [data] Shuffling data
[2023-07-04 16:43:28] [data] Done reading 20,192 sentences
[2023-07-04 16:43:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:44:09] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 2.23963308 * 1,337,866 @ 718 after 17,438,084 : Time 163.81s : 8166.94 words/s : gNorm 1.3299
[2023-07-04 16:44:18] Seen 18,843 samples
[2023-07-04 16:44:18] Starting data epoch 45 in logical epoch 45
[2023-07-04 16:44:18] [data] Shuffling data
[2023-07-04 16:44:18] [data] Done reading 20,192 sentences
[2023-07-04 16:44:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:45:07] Seen 18,843 samples
[2023-07-04 16:45:07] Starting data epoch 46 in logical epoch 46
[2023-07-04 16:45:07] [data] Shuffling data
[2023-07-04 16:45:07] [data] Done reading 20,192 sentences
[2023-07-04 16:45:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:45:54] Seen 18,843 samples
[2023-07-04 16:45:54] Starting data epoch 47 in logical epoch 47
[2023-07-04 16:45:54] [data] Shuffling data
[2023-07-04 16:45:54] [data] Done reading 20,192 sentences
[2023-07-04 16:45:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:46:45] Seen 18,843 samples
[2023-07-04 16:46:45] Starting data epoch 48 in logical epoch 48
[2023-07-04 16:46:45] [data] Shuffling data
[2023-07-04 16:46:45] [data] Done reading 20,192 sentences
[2023-07-04 16:46:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:46:55] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 2.06236410 * 1,348,446 @ 1,408 after 18,786,530 : Time 166.14s : 8116.36 words/s : gNorm 1.4666
[2023-07-04 16:47:35] Seen 18,843 samples
[2023-07-04 16:47:35] Starting data epoch 49 in logical epoch 49
[2023-07-04 16:47:35] [data] Shuffling data
[2023-07-04 16:47:35] [data] Done reading 20,192 sentences
[2023-07-04 16:47:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:48:23] Seen 18,843 samples
[2023-07-04 16:48:23] Starting data epoch 50 in logical epoch 50
[2023-07-04 16:48:23] [data] Shuffling data
[2023-07-04 16:48:23] [data] Done reading 20,192 sentences
[2023-07-04 16:48:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:49:13] Seen 18,843 samples
[2023-07-04 16:49:13] Starting data epoch 51 in logical epoch 51
[2023-07-04 16:49:13] Training finished
[2023-07-04 16:49:19] [valid] Ep. 51 : Up. 14829 : cross-entropy : 142.474 : stalled 4 times (last best: 108.419)
[2023-07-04 16:51:35] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-07-04 16:51:35] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:51:39] Saving Adam parameters
[2023-07-04 16:51:40] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:51:52] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:51:52] [marian] Running on node07.datos.cluster.uy as process 32975 with command line:
[2023-07-04 16:51:52] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 16:51:52] [config] after: 0e
[2023-07-04 16:51:52] [config] after-batches: 0
[2023-07-04 16:51:52] [config] after-epochs: 60
[2023-07-04 16:51:52] [config] all-caps-every: 0
[2023-07-04 16:51:52] [config] allow-unk: false
[2023-07-04 16:51:52] [config] authors: false
[2023-07-04 16:51:52] [config] beam-size: 12
[2023-07-04 16:51:52] [config] bert-class-symbol: "[CLS]"
[2023-07-04 16:51:52] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 16:51:52] [config] bert-masking-fraction: 0.15
[2023-07-04 16:51:52] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 16:51:52] [config] bert-train-type-embeddings: true
[2023-07-04 16:51:52] [config] bert-type-vocab-size: 2
[2023-07-04 16:51:52] [config] build-info: ""
[2023-07-04 16:51:52] [config] check-gradient-nan: false
[2023-07-04 16:51:52] [config] check-nan: false
[2023-07-04 16:51:52] [config] cite: false
[2023-07-04 16:51:52] [config] clip-norm: 1
[2023-07-04 16:51:52] [config] cost-scaling:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] cost-type: ce-sum
[2023-07-04 16:51:52] [config] cpu-threads: 0
[2023-07-04 16:51:52] [config] data-threads: 8
[2023-07-04 16:51:52] [config] data-weighting: ""
[2023-07-04 16:51:52] [config] data-weighting-type: sentence
[2023-07-04 16:51:52] [config] dec-cell: gru
[2023-07-04 16:51:52] [config] dec-cell-base-depth: 2
[2023-07-04 16:51:52] [config] dec-cell-high-depth: 1
[2023-07-04 16:51:52] [config] dec-depth: 1
[2023-07-04 16:51:52] [config] devices:
[2023-07-04 16:51:52] [config]   - 0
[2023-07-04 16:51:52] [config] dim-emb: 512
[2023-07-04 16:51:52] [config] dim-rnn: 1024
[2023-07-04 16:51:52] [config] dim-vocabs:
[2023-07-04 16:51:52] [config]   - 54042
[2023-07-04 16:51:52] [config]   - 36507
[2023-07-04 16:51:52] [config] disp-first: 0
[2023-07-04 16:51:52] [config] disp-freq: 1000u
[2023-07-04 16:51:52] [config] disp-label-counts: true
[2023-07-04 16:51:52] [config] dropout-rnn: 0
[2023-07-04 16:51:52] [config] dropout-src: 0
[2023-07-04 16:51:52] [config] dropout-trg: 0
[2023-07-04 16:51:52] [config] dump-config: ""
[2023-07-04 16:51:52] [config] dynamic-gradient-scaling:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] early-stopping: 10
[2023-07-04 16:51:52] [config] early-stopping-on: first
[2023-07-04 16:51:52] [config] embedding-fix-src: false
[2023-07-04 16:51:52] [config] embedding-fix-trg: false
[2023-07-04 16:51:52] [config] embedding-normalization: false
[2023-07-04 16:51:52] [config] embedding-vectors:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] enc-cell: gru
[2023-07-04 16:51:52] [config] enc-cell-depth: 1
[2023-07-04 16:51:52] [config] enc-depth: 1
[2023-07-04 16:51:52] [config] enc-type: bidirectional
[2023-07-04 16:51:52] [config] english-title-case-every: 0
[2023-07-04 16:51:52] [config] exponential-smoothing: 0
[2023-07-04 16:51:52] [config] factor-weight: 1
[2023-07-04 16:51:52] [config] factors-combine: sum
[2023-07-04 16:51:52] [config] factors-dim-emb: 0
[2023-07-04 16:51:52] [config] gradient-checkpointing: false
[2023-07-04 16:51:52] [config] gradient-norm-average-window: 100
[2023-07-04 16:51:52] [config] guided-alignment: none
[2023-07-04 16:51:52] [config] guided-alignment-cost: mse
[2023-07-04 16:51:52] [config] guided-alignment-weight: 0.1
[2023-07-04 16:51:52] [config] ignore-model-config: false
[2023-07-04 16:51:52] [config] input-types:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] interpolate-env-vars: false
[2023-07-04 16:51:52] [config] keep-best: false
[2023-07-04 16:51:52] [config] label-smoothing: 0
[2023-07-04 16:51:52] [config] layer-normalization: false
[2023-07-04 16:51:52] [config] learn-rate: 0.0001
[2023-07-04 16:51:52] [config] lemma-dependency: ""
[2023-07-04 16:51:52] [config] lemma-dim-emb: 0
[2023-07-04 16:51:52] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 16:51:52] [config] log-level: info
[2023-07-04 16:51:52] [config] log-time-zone: ""
[2023-07-04 16:51:52] [config] logical-epoch:
[2023-07-04 16:51:52] [config]   - 1e
[2023-07-04 16:51:52] [config]   - 0
[2023-07-04 16:51:52] [config] lr-decay: 0
[2023-07-04 16:51:52] [config] lr-decay-freq: 50000
[2023-07-04 16:51:52] [config] lr-decay-inv-sqrt:
[2023-07-04 16:51:52] [config]   - 0
[2023-07-04 16:51:52] [config] lr-decay-repeat-warmup: false
[2023-07-04 16:51:52] [config] lr-decay-reset-optimizer: false
[2023-07-04 16:51:52] [config] lr-decay-start:
[2023-07-04 16:51:52] [config]   - 10
[2023-07-04 16:51:52] [config]   - 1
[2023-07-04 16:51:52] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 16:51:52] [config] lr-report: false
[2023-07-04 16:51:52] [config] lr-warmup: 0
[2023-07-04 16:51:52] [config] lr-warmup-at-reload: false
[2023-07-04 16:51:52] [config] lr-warmup-cycle: false
[2023-07-04 16:51:52] [config] lr-warmup-start-rate: 0
[2023-07-04 16:51:52] [config] max-length: 50
[2023-07-04 16:51:52] [config] max-length-crop: false
[2023-07-04 16:51:52] [config] max-length-factor: 3
[2023-07-04 16:51:52] [config] maxi-batch: 100
[2023-07-04 16:51:52] [config] maxi-batch-sort: trg
[2023-07-04 16:51:52] [config] mini-batch: 64
[2023-07-04 16:51:52] [config] mini-batch-fit: false
[2023-07-04 16:51:52] [config] mini-batch-fit-step: 10
[2023-07-04 16:51:52] [config] mini-batch-round-up: true
[2023-07-04 16:51:52] [config] mini-batch-track-lr: false
[2023-07-04 16:51:52] [config] mini-batch-warmup: 0
[2023-07-04 16:51:52] [config] mini-batch-words: 0
[2023-07-04 16:51:52] [config] mini-batch-words-ref: 0
[2023-07-04 16:51:52] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:51:52] [config] multi-loss-type: sum
[2023-07-04 16:51:52] [config] n-best: false
[2023-07-04 16:51:52] [config] no-nccl: false
[2023-07-04 16:51:52] [config] no-reload: false
[2023-07-04 16:51:52] [config] no-restore-corpus: false
[2023-07-04 16:51:52] [config] normalize: 0
[2023-07-04 16:51:52] [config] normalize-gradient: false
[2023-07-04 16:51:52] [config] num-devices: 0
[2023-07-04 16:51:52] [config] optimizer: adam
[2023-07-04 16:51:52] [config] optimizer-delay: 1
[2023-07-04 16:51:52] [config] optimizer-params:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] output-omit-bias: false
[2023-07-04 16:51:52] [config] overwrite: true
[2023-07-04 16:51:52] [config] precision:
[2023-07-04 16:51:52] [config]   - float32
[2023-07-04 16:51:52] [config]   - float32
[2023-07-04 16:51:52] [config] pretrained-model: ""
[2023-07-04 16:51:52] [config] quantize-biases: false
[2023-07-04 16:51:52] [config] quantize-bits: 0
[2023-07-04 16:51:52] [config] quantize-log-based: false
[2023-07-04 16:51:52] [config] quantize-optimization-steps: 0
[2023-07-04 16:51:52] [config] quiet: false
[2023-07-04 16:51:52] [config] quiet-translation: true
[2023-07-04 16:51:52] [config] relative-paths: false
[2023-07-04 16:51:52] [config] right-left: false
[2023-07-04 16:51:52] [config] save-freq: 10000u
[2023-07-04 16:51:52] [config] seed: 1234
[2023-07-04 16:51:52] [config] sentencepiece-alphas:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] sentencepiece-max-lines: 2000000
[2023-07-04 16:51:52] [config] sentencepiece-options: ""
[2023-07-04 16:51:52] [config] sharding: global
[2023-07-04 16:51:52] [config] shuffle: data
[2023-07-04 16:51:52] [config] shuffle-in-ram: false
[2023-07-04 16:51:52] [config] sigterm: save-and-exit
[2023-07-04 16:51:52] [config] skip: false
[2023-07-04 16:51:52] [config] sqlite: ""
[2023-07-04 16:51:52] [config] sqlite-drop: false
[2023-07-04 16:51:52] [config] sync-freq: 200u
[2023-07-04 16:51:52] [config] sync-sgd: false
[2023-07-04 16:51:52] [config] tempdir: /tmp
[2023-07-04 16:51:52] [config] tied-embeddings: false
[2023-07-04 16:51:52] [config] tied-embeddings-all: false
[2023-07-04 16:51:52] [config] tied-embeddings-src: false
[2023-07-04 16:51:52] [config] train-embedder-rank:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] train-sets:
[2023-07-04 16:51:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 16:51:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 16:51:52] [config] transformer-aan-activation: swish
[2023-07-04 16:51:52] [config] transformer-aan-depth: 2
[2023-07-04 16:51:52] [config] transformer-aan-nogate: false
[2023-07-04 16:51:52] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 16:51:52] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 16:51:52] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 16:51:52] [config] transformer-depth-scaling: false
[2023-07-04 16:51:52] [config] transformer-dim-aan: 2048
[2023-07-04 16:51:52] [config] transformer-dim-ffn: 2048
[2023-07-04 16:51:52] [config] transformer-dropout: 0
[2023-07-04 16:51:52] [config] transformer-dropout-attention: 0
[2023-07-04 16:51:52] [config] transformer-dropout-ffn: 0
[2023-07-04 16:51:52] [config] transformer-ffn-activation: swish
[2023-07-04 16:51:52] [config] transformer-ffn-depth: 2
[2023-07-04 16:51:52] [config] transformer-guided-alignment-layer: last
[2023-07-04 16:51:52] [config] transformer-heads: 8
[2023-07-04 16:51:52] [config] transformer-no-projection: false
[2023-07-04 16:51:52] [config] transformer-pool: false
[2023-07-04 16:51:52] [config] transformer-postprocess: dan
[2023-07-04 16:51:52] [config] transformer-postprocess-emb: d
[2023-07-04 16:51:52] [config] transformer-postprocess-top: ""
[2023-07-04 16:51:52] [config] transformer-preprocess: ""
[2023-07-04 16:51:52] [config] transformer-tied-layers:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] transformer-train-position-embeddings: false
[2023-07-04 16:51:52] [config] tsv: false
[2023-07-04 16:51:52] [config] tsv-fields: 0
[2023-07-04 16:51:52] [config] type: amun
[2023-07-04 16:51:52] [config] ulr: false
[2023-07-04 16:51:52] [config] ulr-dim-emb: 0
[2023-07-04 16:51:52] [config] ulr-dropout: 0
[2023-07-04 16:51:52] [config] ulr-keys-vectors: ""
[2023-07-04 16:51:52] [config] ulr-query-vectors: ""
[2023-07-04 16:51:52] [config] ulr-softmax-temperature: 1
[2023-07-04 16:51:52] [config] ulr-trainable-transformation: false
[2023-07-04 16:51:52] [config] unlikelihood-loss: false
[2023-07-04 16:51:52] [config] valid-freq: 50000000
[2023-07-04 16:51:52] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 16:51:52] [config] valid-max-length: 1000
[2023-07-04 16:51:52] [config] valid-metrics:
[2023-07-04 16:51:52] [config]   - cross-entropy
[2023-07-04 16:51:52] [config]   - translation
[2023-07-04 16:51:52] [config] valid-mini-batch: 32
[2023-07-04 16:51:52] [config] valid-reset-stalled: false
[2023-07-04 16:51:52] [config] valid-script-args:
[2023-07-04 16:51:52] [config]   []
[2023-07-04 16:51:52] [config] valid-script-path: ""
[2023-07-04 16:51:52] [config] valid-sets:
[2023-07-04 16:51:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 16:51:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 16:51:52] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 16:51:52] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:51:52] [config] vocabs:
[2023-07-04 16:51:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:51:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:51:52] [config] word-penalty: 0
[2023-07-04 16:51:52] [config] word-scores: false
[2023-07-04 16:51:52] [config] workspace: 2048
[2023-07-04 16:51:52] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 16:51:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:51:52] [training] Using single-device training
[2023-07-04 16:51:53] Synced seed 1234
[2023-07-04 16:51:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 16:51:53] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 16:51:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 16:51:53] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 16:51:53] [valid] No post-processing script given for validating translator
[2023-07-04 16:51:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 16:51:54] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 16:51:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 16:51:54] [comm] Using global sharding
[2023-07-04 16:51:54] [comm] NCCLCommunicators constructed successfully
[2023-07-04 16:51:54] [training] Using 1 GPUs
[2023-07-04 16:51:54] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 16:51:56] Loading Adam parameters
[2023-07-04 16:51:57] [memory] Reserving 754 MB, device gpu0
[2023-07-04 16:51:57] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:51:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 16:51:57] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-07-04 16:51:57] [data] Shuffling data
[2023-07-04 16:51:57] [data] Done reading 20,192 sentences
[2023-07-04 16:51:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:51:57] Training started
[2023-07-04 16:51:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 16:51:57] [logits] Applying loss function for 1 factor(s)
[2023-07-04 16:51:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 16:51:57] [memory] Reserving 377 MB, device gpu0
[2023-07-04 16:51:58] Parameter type float32, optimization type float32, casting types false
[2023-07-04 16:52:21] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 1.86048055 * 1,333,303 @ 559 after 20,119,833 : Time 28.07s : 47492.04 words/s : gNorm 1.1760
[2023-07-04 16:52:41] Seen 18,843 samples
[2023-07-04 16:52:41] Starting data epoch 52 in logical epoch 52
[2023-07-04 16:52:41] [data] Shuffling data
[2023-07-04 16:52:41] [data] Done reading 20,192 sentences
[2023-07-04 16:52:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:53:31] Seen 18,843 samples
[2023-07-04 16:53:31] Starting data epoch 53 in logical epoch 53
[2023-07-04 16:53:31] [data] Shuffling data
[2023-07-04 16:53:31] [data] Done reading 20,192 sentences
[2023-07-04 16:53:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:54:22] Seen 18,843 samples
[2023-07-04 16:54:22] Starting data epoch 54 in logical epoch 54
[2023-07-04 16:54:22] [data] Shuffling data
[2023-07-04 16:54:22] [data] Done reading 20,192 sentences
[2023-07-04 16:54:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:55:07] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 1.70822072 * 1,343,441 @ 128 after 21,463,274 : Time 166.17s : 8084.70 words/s : gNorm 1.2686
[2023-07-04 16:55:10] Seen 18,843 samples
[2023-07-04 16:55:10] Starting data epoch 55 in logical epoch 55
[2023-07-04 16:55:10] [data] Shuffling data
[2023-07-04 16:55:10] [data] Done reading 20,192 sentences
[2023-07-04 16:55:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:55:59] Seen 18,843 samples
[2023-07-04 16:55:59] Starting data epoch 56 in logical epoch 56
[2023-07-04 16:55:59] [data] Shuffling data
[2023-07-04 16:55:59] [data] Done reading 20,192 sentences
[2023-07-04 16:55:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:56:49] Seen 18,843 samples
[2023-07-04 16:56:49] Starting data epoch 57 in logical epoch 57
[2023-07-04 16:56:49] [data] Shuffling data
[2023-07-04 16:56:49] [data] Done reading 20,192 sentences
[2023-07-04 16:56:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:57:38] Seen 18,843 samples
[2023-07-04 16:57:38] Starting data epoch 58 in logical epoch 58
[2023-07-04 16:57:38] [data] Shuffling data
[2023-07-04 16:57:38] [data] Done reading 20,192 sentences
[2023-07-04 16:57:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:57:54] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 1.53913271 * 1,347,361 @ 2,048 after 22,810,635 : Time 166.59s : 8088.05 words/s : gNorm 1.1457
[2023-07-04 16:58:29] Seen 18,843 samples
[2023-07-04 16:58:29] Starting data epoch 59 in logical epoch 59
[2023-07-04 16:58:29] [data] Shuffling data
[2023-07-04 16:58:29] [data] Done reading 20,192 sentences
[2023-07-04 16:58:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 16:59:18] Seen 18,843 samples
[2023-07-04 16:59:18] Starting data epoch 60 in logical epoch 60
[2023-07-04 16:59:18] [data] Shuffling data
[2023-07-04 16:59:18] [data] Done reading 20,192 sentences
[2023-07-04 16:59:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:00:08] Seen 18,843 samples
[2023-07-04 17:00:08] Starting data epoch 61 in logical epoch 61
[2023-07-04 17:00:08] Training finished
[2023-07-04 17:00:15] [valid] Ep. 61 : Up. 17795 : cross-entropy : 154.266 : stalled 5 times (last best: 108.419)
[2023-07-04 17:02:27] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-07-04 17:02:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:02:31] Saving Adam parameters
[2023-07-04 17:02:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:02:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:02:45] [marian] Running on node07.datos.cluster.uy as process 33635 with command line:
[2023-07-04 17:02:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:02:45] [config] after: 0e
[2023-07-04 17:02:45] [config] after-batches: 0
[2023-07-04 17:02:45] [config] after-epochs: 70
[2023-07-04 17:02:45] [config] all-caps-every: 0
[2023-07-04 17:02:45] [config] allow-unk: false
[2023-07-04 17:02:45] [config] authors: false
[2023-07-04 17:02:45] [config] beam-size: 12
[2023-07-04 17:02:45] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:02:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:02:45] [config] bert-masking-fraction: 0.15
[2023-07-04 17:02:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:02:45] [config] bert-train-type-embeddings: true
[2023-07-04 17:02:45] [config] bert-type-vocab-size: 2
[2023-07-04 17:02:45] [config] build-info: ""
[2023-07-04 17:02:45] [config] check-gradient-nan: false
[2023-07-04 17:02:45] [config] check-nan: false
[2023-07-04 17:02:45] [config] cite: false
[2023-07-04 17:02:45] [config] clip-norm: 1
[2023-07-04 17:02:45] [config] cost-scaling:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] cost-type: ce-sum
[2023-07-04 17:02:45] [config] cpu-threads: 0
[2023-07-04 17:02:45] [config] data-threads: 8
[2023-07-04 17:02:45] [config] data-weighting: ""
[2023-07-04 17:02:45] [config] data-weighting-type: sentence
[2023-07-04 17:02:45] [config] dec-cell: gru
[2023-07-04 17:02:45] [config] dec-cell-base-depth: 2
[2023-07-04 17:02:45] [config] dec-cell-high-depth: 1
[2023-07-04 17:02:45] [config] dec-depth: 1
[2023-07-04 17:02:45] [config] devices:
[2023-07-04 17:02:45] [config]   - 0
[2023-07-04 17:02:45] [config] dim-emb: 512
[2023-07-04 17:02:45] [config] dim-rnn: 1024
[2023-07-04 17:02:45] [config] dim-vocabs:
[2023-07-04 17:02:45] [config]   - 54042
[2023-07-04 17:02:45] [config]   - 36507
[2023-07-04 17:02:45] [config] disp-first: 0
[2023-07-04 17:02:45] [config] disp-freq: 1000u
[2023-07-04 17:02:45] [config] disp-label-counts: true
[2023-07-04 17:02:45] [config] dropout-rnn: 0
[2023-07-04 17:02:45] [config] dropout-src: 0
[2023-07-04 17:02:45] [config] dropout-trg: 0
[2023-07-04 17:02:45] [config] dump-config: ""
[2023-07-04 17:02:45] [config] dynamic-gradient-scaling:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] early-stopping: 10
[2023-07-04 17:02:45] [config] early-stopping-on: first
[2023-07-04 17:02:45] [config] embedding-fix-src: false
[2023-07-04 17:02:45] [config] embedding-fix-trg: false
[2023-07-04 17:02:45] [config] embedding-normalization: false
[2023-07-04 17:02:45] [config] embedding-vectors:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] enc-cell: gru
[2023-07-04 17:02:45] [config] enc-cell-depth: 1
[2023-07-04 17:02:45] [config] enc-depth: 1
[2023-07-04 17:02:45] [config] enc-type: bidirectional
[2023-07-04 17:02:45] [config] english-title-case-every: 0
[2023-07-04 17:02:45] [config] exponential-smoothing: 0
[2023-07-04 17:02:45] [config] factor-weight: 1
[2023-07-04 17:02:45] [config] factors-combine: sum
[2023-07-04 17:02:45] [config] factors-dim-emb: 0
[2023-07-04 17:02:45] [config] gradient-checkpointing: false
[2023-07-04 17:02:45] [config] gradient-norm-average-window: 100
[2023-07-04 17:02:45] [config] guided-alignment: none
[2023-07-04 17:02:45] [config] guided-alignment-cost: mse
[2023-07-04 17:02:45] [config] guided-alignment-weight: 0.1
[2023-07-04 17:02:45] [config] ignore-model-config: false
[2023-07-04 17:02:45] [config] input-types:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] interpolate-env-vars: false
[2023-07-04 17:02:45] [config] keep-best: false
[2023-07-04 17:02:45] [config] label-smoothing: 0
[2023-07-04 17:02:45] [config] layer-normalization: false
[2023-07-04 17:02:45] [config] learn-rate: 0.0001
[2023-07-04 17:02:45] [config] lemma-dependency: ""
[2023-07-04 17:02:45] [config] lemma-dim-emb: 0
[2023-07-04 17:02:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:02:45] [config] log-level: info
[2023-07-04 17:02:45] [config] log-time-zone: ""
[2023-07-04 17:02:45] [config] logical-epoch:
[2023-07-04 17:02:45] [config]   - 1e
[2023-07-04 17:02:45] [config]   - 0
[2023-07-04 17:02:45] [config] lr-decay: 0
[2023-07-04 17:02:45] [config] lr-decay-freq: 50000
[2023-07-04 17:02:45] [config] lr-decay-inv-sqrt:
[2023-07-04 17:02:45] [config]   - 0
[2023-07-04 17:02:45] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:02:45] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:02:45] [config] lr-decay-start:
[2023-07-04 17:02:45] [config]   - 10
[2023-07-04 17:02:45] [config]   - 1
[2023-07-04 17:02:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:02:45] [config] lr-report: false
[2023-07-04 17:02:45] [config] lr-warmup: 0
[2023-07-04 17:02:45] [config] lr-warmup-at-reload: false
[2023-07-04 17:02:45] [config] lr-warmup-cycle: false
[2023-07-04 17:02:45] [config] lr-warmup-start-rate: 0
[2023-07-04 17:02:45] [config] max-length: 50
[2023-07-04 17:02:45] [config] max-length-crop: false
[2023-07-04 17:02:45] [config] max-length-factor: 3
[2023-07-04 17:02:45] [config] maxi-batch: 100
[2023-07-04 17:02:45] [config] maxi-batch-sort: trg
[2023-07-04 17:02:45] [config] mini-batch: 64
[2023-07-04 17:02:45] [config] mini-batch-fit: false
[2023-07-04 17:02:45] [config] mini-batch-fit-step: 10
[2023-07-04 17:02:45] [config] mini-batch-round-up: true
[2023-07-04 17:02:45] [config] mini-batch-track-lr: false
[2023-07-04 17:02:45] [config] mini-batch-warmup: 0
[2023-07-04 17:02:45] [config] mini-batch-words: 0
[2023-07-04 17:02:45] [config] mini-batch-words-ref: 0
[2023-07-04 17:02:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:02:45] [config] multi-loss-type: sum
[2023-07-04 17:02:45] [config] n-best: false
[2023-07-04 17:02:45] [config] no-nccl: false
[2023-07-04 17:02:45] [config] no-reload: false
[2023-07-04 17:02:45] [config] no-restore-corpus: false
[2023-07-04 17:02:45] [config] normalize: 0
[2023-07-04 17:02:45] [config] normalize-gradient: false
[2023-07-04 17:02:45] [config] num-devices: 0
[2023-07-04 17:02:45] [config] optimizer: adam
[2023-07-04 17:02:45] [config] optimizer-delay: 1
[2023-07-04 17:02:45] [config] optimizer-params:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] output-omit-bias: false
[2023-07-04 17:02:45] [config] overwrite: true
[2023-07-04 17:02:45] [config] precision:
[2023-07-04 17:02:45] [config]   - float32
[2023-07-04 17:02:45] [config]   - float32
[2023-07-04 17:02:45] [config] pretrained-model: ""
[2023-07-04 17:02:45] [config] quantize-biases: false
[2023-07-04 17:02:45] [config] quantize-bits: 0
[2023-07-04 17:02:45] [config] quantize-log-based: false
[2023-07-04 17:02:45] [config] quantize-optimization-steps: 0
[2023-07-04 17:02:45] [config] quiet: false
[2023-07-04 17:02:45] [config] quiet-translation: true
[2023-07-04 17:02:45] [config] relative-paths: false
[2023-07-04 17:02:45] [config] right-left: false
[2023-07-04 17:02:45] [config] save-freq: 10000u
[2023-07-04 17:02:45] [config] seed: 1234
[2023-07-04 17:02:45] [config] sentencepiece-alphas:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:02:45] [config] sentencepiece-options: ""
[2023-07-04 17:02:45] [config] sharding: global
[2023-07-04 17:02:45] [config] shuffle: data
[2023-07-04 17:02:45] [config] shuffle-in-ram: false
[2023-07-04 17:02:45] [config] sigterm: save-and-exit
[2023-07-04 17:02:45] [config] skip: false
[2023-07-04 17:02:45] [config] sqlite: ""
[2023-07-04 17:02:45] [config] sqlite-drop: false
[2023-07-04 17:02:45] [config] sync-freq: 200u
[2023-07-04 17:02:45] [config] sync-sgd: false
[2023-07-04 17:02:45] [config] tempdir: /tmp
[2023-07-04 17:02:45] [config] tied-embeddings: false
[2023-07-04 17:02:45] [config] tied-embeddings-all: false
[2023-07-04 17:02:45] [config] tied-embeddings-src: false
[2023-07-04 17:02:45] [config] train-embedder-rank:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] train-sets:
[2023-07-04 17:02:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:02:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:02:45] [config] transformer-aan-activation: swish
[2023-07-04 17:02:45] [config] transformer-aan-depth: 2
[2023-07-04 17:02:45] [config] transformer-aan-nogate: false
[2023-07-04 17:02:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:02:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:02:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:02:45] [config] transformer-depth-scaling: false
[2023-07-04 17:02:45] [config] transformer-dim-aan: 2048
[2023-07-04 17:02:45] [config] transformer-dim-ffn: 2048
[2023-07-04 17:02:45] [config] transformer-dropout: 0
[2023-07-04 17:02:45] [config] transformer-dropout-attention: 0
[2023-07-04 17:02:45] [config] transformer-dropout-ffn: 0
[2023-07-04 17:02:45] [config] transformer-ffn-activation: swish
[2023-07-04 17:02:45] [config] transformer-ffn-depth: 2
[2023-07-04 17:02:45] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:02:45] [config] transformer-heads: 8
[2023-07-04 17:02:45] [config] transformer-no-projection: false
[2023-07-04 17:02:45] [config] transformer-pool: false
[2023-07-04 17:02:45] [config] transformer-postprocess: dan
[2023-07-04 17:02:45] [config] transformer-postprocess-emb: d
[2023-07-04 17:02:45] [config] transformer-postprocess-top: ""
[2023-07-04 17:02:45] [config] transformer-preprocess: ""
[2023-07-04 17:02:45] [config] transformer-tied-layers:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] transformer-train-position-embeddings: false
[2023-07-04 17:02:45] [config] tsv: false
[2023-07-04 17:02:45] [config] tsv-fields: 0
[2023-07-04 17:02:45] [config] type: amun
[2023-07-04 17:02:45] [config] ulr: false
[2023-07-04 17:02:45] [config] ulr-dim-emb: 0
[2023-07-04 17:02:45] [config] ulr-dropout: 0
[2023-07-04 17:02:45] [config] ulr-keys-vectors: ""
[2023-07-04 17:02:45] [config] ulr-query-vectors: ""
[2023-07-04 17:02:45] [config] ulr-softmax-temperature: 1
[2023-07-04 17:02:45] [config] ulr-trainable-transformation: false
[2023-07-04 17:02:45] [config] unlikelihood-loss: false
[2023-07-04 17:02:45] [config] valid-freq: 50000000
[2023-07-04 17:02:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:02:45] [config] valid-max-length: 1000
[2023-07-04 17:02:45] [config] valid-metrics:
[2023-07-04 17:02:45] [config]   - cross-entropy
[2023-07-04 17:02:45] [config]   - translation
[2023-07-04 17:02:45] [config] valid-mini-batch: 32
[2023-07-04 17:02:45] [config] valid-reset-stalled: false
[2023-07-04 17:02:45] [config] valid-script-args:
[2023-07-04 17:02:45] [config]   []
[2023-07-04 17:02:45] [config] valid-script-path: ""
[2023-07-04 17:02:45] [config] valid-sets:
[2023-07-04 17:02:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:02:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:02:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:02:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:02:45] [config] vocabs:
[2023-07-04 17:02:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:02:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:02:45] [config] word-penalty: 0
[2023-07-04 17:02:45] [config] word-scores: false
[2023-07-04 17:02:45] [config] workspace: 2048
[2023-07-04 17:02:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:02:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:02:45] [training] Using single-device training
[2023-07-04 17:02:46] Synced seed 1234
[2023-07-04 17:02:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:02:46] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:02:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:02:46] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:02:46] [valid] No post-processing script given for validating translator
[2023-07-04 17:02:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:02:47] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:02:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:02:47] [comm] Using global sharding
[2023-07-04 17:02:47] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:02:47] [training] Using 1 GPUs
[2023-07-04 17:02:47] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:02:49] Loading Adam parameters
[2023-07-04 17:02:50] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:02:50] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:02:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:02:50] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-07-04 17:02:50] [data] Shuffling data
[2023-07-04 17:02:50] [data] Done reading 20,192 sentences
[2023-07-04 17:02:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:02:50] Training started
[2023-07-04 17:02:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 17:02:50] [logits] Applying loss function for 1 factor(s)
[2023-07-04 17:02:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 17:02:50] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:02:50] Parameter type float32, optimization type float32, casting types false
[2023-07-04 17:03:18] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 1.37921882 * 1,335,891 @ 1,435 after 24,146,526 : Time 32.73s : 40817.60 words/s : gNorm 1.1012
[2023-07-04 17:03:33] Seen 18,843 samples
[2023-07-04 17:03:33] Starting data epoch 62 in logical epoch 62
[2023-07-04 17:03:33] [data] Shuffling data
[2023-07-04 17:03:33] [data] Done reading 20,192 sentences
[2023-07-04 17:03:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:04:24] Seen 18,843 samples
[2023-07-04 17:04:24] Starting data epoch 63 in logical epoch 63
[2023-07-04 17:04:24] [data] Shuffling data
[2023-07-04 17:04:24] [data] Done reading 20,192 sentences
[2023-07-04 17:04:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:05:12] Seen 18,843 samples
[2023-07-04 17:05:12] Starting data epoch 64 in logical epoch 64
[2023-07-04 17:05:12] [data] Shuffling data
[2023-07-04 17:05:12] [data] Done reading 20,192 sentences
[2023-07-04 17:05:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:06:03] Seen 18,843 samples
[2023-07-04 17:06:03] Starting data epoch 65 in logical epoch 65
[2023-07-04 17:06:03] [data] Shuffling data
[2023-07-04 17:06:03] [data] Done reading 20,192 sentences
[2023-07-04 17:06:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:06:05] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 1.24680817 * 1,337,858 @ 479 after 25,484,384 : Time 166.82s : 8019.59 words/s : gNorm 0.9778
[2023-07-04 17:06:54] Seen 18,843 samples
[2023-07-04 17:06:54] Starting data epoch 66 in logical epoch 66
[2023-07-04 17:06:54] [data] Shuffling data
[2023-07-04 17:06:54] [data] Done reading 20,192 sentences
[2023-07-04 17:06:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:07:44] Seen 18,843 samples
[2023-07-04 17:07:44] Starting data epoch 67 in logical epoch 67
[2023-07-04 17:07:44] [data] Shuffling data
[2023-07-04 17:07:44] [data] Done reading 20,192 sentences
[2023-07-04 17:07:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:08:34] Seen 18,843 samples
[2023-07-04 17:08:34] Starting data epoch 68 in logical epoch 68
[2023-07-04 17:08:34] [data] Shuffling data
[2023-07-04 17:08:34] [data] Done reading 20,192 sentences
[2023-07-04 17:08:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:08:55] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 1.11714053 * 1,354,931 @ 1,600 after 26,839,315 : Time 169.65s : 7986.84 words/s : gNorm 1.0473
[2023-07-04 17:08:55] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:08:58] Saving Adam parameters
[2023-07-04 17:09:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:09:33] Seen 18,843 samples
[2023-07-04 17:09:33] Starting data epoch 69 in logical epoch 69
[2023-07-04 17:09:33] [data] Shuffling data
[2023-07-04 17:09:33] [data] Done reading 20,192 sentences
[2023-07-04 17:09:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:10:24] Seen 18,843 samples
[2023-07-04 17:10:24] Starting data epoch 70 in logical epoch 70
[2023-07-04 17:10:24] [data] Shuffling data
[2023-07-04 17:10:24] [data] Done reading 20,192 sentences
[2023-07-04 17:10:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:11:14] Seen 18,843 samples
[2023-07-04 17:11:14] Starting data epoch 71 in logical epoch 71
[2023-07-04 17:11:14] Training finished
[2023-07-04 17:11:21] [valid] Ep. 71 : Up. 20760 : cross-entropy : 166.358 : stalled 6 times (last best: 108.419)
[2023-07-04 17:13:31] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-07-04 17:13:31] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:13:35] Saving Adam parameters
[2023-07-04 17:13:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:13:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:13:49] [marian] Running on node07.datos.cluster.uy as process 34433 with command line:
[2023-07-04 17:13:49] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:13:49] [config] after: 0e
[2023-07-04 17:13:49] [config] after-batches: 0
[2023-07-04 17:13:49] [config] after-epochs: 80
[2023-07-04 17:13:49] [config] all-caps-every: 0
[2023-07-04 17:13:49] [config] allow-unk: false
[2023-07-04 17:13:49] [config] authors: false
[2023-07-04 17:13:49] [config] beam-size: 12
[2023-07-04 17:13:49] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:13:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:13:49] [config] bert-masking-fraction: 0.15
[2023-07-04 17:13:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:13:49] [config] bert-train-type-embeddings: true
[2023-07-04 17:13:49] [config] bert-type-vocab-size: 2
[2023-07-04 17:13:49] [config] build-info: ""
[2023-07-04 17:13:49] [config] check-gradient-nan: false
[2023-07-04 17:13:49] [config] check-nan: false
[2023-07-04 17:13:49] [config] cite: false
[2023-07-04 17:13:49] [config] clip-norm: 1
[2023-07-04 17:13:49] [config] cost-scaling:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] cost-type: ce-sum
[2023-07-04 17:13:49] [config] cpu-threads: 0
[2023-07-04 17:13:49] [config] data-threads: 8
[2023-07-04 17:13:49] [config] data-weighting: ""
[2023-07-04 17:13:49] [config] data-weighting-type: sentence
[2023-07-04 17:13:49] [config] dec-cell: gru
[2023-07-04 17:13:49] [config] dec-cell-base-depth: 2
[2023-07-04 17:13:49] [config] dec-cell-high-depth: 1
[2023-07-04 17:13:49] [config] dec-depth: 1
[2023-07-04 17:13:49] [config] devices:
[2023-07-04 17:13:49] [config]   - 0
[2023-07-04 17:13:49] [config] dim-emb: 512
[2023-07-04 17:13:49] [config] dim-rnn: 1024
[2023-07-04 17:13:49] [config] dim-vocabs:
[2023-07-04 17:13:49] [config]   - 54042
[2023-07-04 17:13:49] [config]   - 36507
[2023-07-04 17:13:49] [config] disp-first: 0
[2023-07-04 17:13:49] [config] disp-freq: 1000u
[2023-07-04 17:13:49] [config] disp-label-counts: true
[2023-07-04 17:13:49] [config] dropout-rnn: 0
[2023-07-04 17:13:49] [config] dropout-src: 0
[2023-07-04 17:13:49] [config] dropout-trg: 0
[2023-07-04 17:13:49] [config] dump-config: ""
[2023-07-04 17:13:49] [config] dynamic-gradient-scaling:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] early-stopping: 10
[2023-07-04 17:13:49] [config] early-stopping-on: first
[2023-07-04 17:13:49] [config] embedding-fix-src: false
[2023-07-04 17:13:49] [config] embedding-fix-trg: false
[2023-07-04 17:13:49] [config] embedding-normalization: false
[2023-07-04 17:13:49] [config] embedding-vectors:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] enc-cell: gru
[2023-07-04 17:13:49] [config] enc-cell-depth: 1
[2023-07-04 17:13:49] [config] enc-depth: 1
[2023-07-04 17:13:49] [config] enc-type: bidirectional
[2023-07-04 17:13:49] [config] english-title-case-every: 0
[2023-07-04 17:13:49] [config] exponential-smoothing: 0
[2023-07-04 17:13:49] [config] factor-weight: 1
[2023-07-04 17:13:49] [config] factors-combine: sum
[2023-07-04 17:13:49] [config] factors-dim-emb: 0
[2023-07-04 17:13:49] [config] gradient-checkpointing: false
[2023-07-04 17:13:49] [config] gradient-norm-average-window: 100
[2023-07-04 17:13:49] [config] guided-alignment: none
[2023-07-04 17:13:49] [config] guided-alignment-cost: mse
[2023-07-04 17:13:49] [config] guided-alignment-weight: 0.1
[2023-07-04 17:13:49] [config] ignore-model-config: false
[2023-07-04 17:13:49] [config] input-types:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] interpolate-env-vars: false
[2023-07-04 17:13:49] [config] keep-best: false
[2023-07-04 17:13:49] [config] label-smoothing: 0
[2023-07-04 17:13:49] [config] layer-normalization: false
[2023-07-04 17:13:49] [config] learn-rate: 0.0001
[2023-07-04 17:13:49] [config] lemma-dependency: ""
[2023-07-04 17:13:49] [config] lemma-dim-emb: 0
[2023-07-04 17:13:49] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:13:49] [config] log-level: info
[2023-07-04 17:13:49] [config] log-time-zone: ""
[2023-07-04 17:13:49] [config] logical-epoch:
[2023-07-04 17:13:49] [config]   - 1e
[2023-07-04 17:13:49] [config]   - 0
[2023-07-04 17:13:49] [config] lr-decay: 0
[2023-07-04 17:13:49] [config] lr-decay-freq: 50000
[2023-07-04 17:13:49] [config] lr-decay-inv-sqrt:
[2023-07-04 17:13:49] [config]   - 0
[2023-07-04 17:13:49] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:13:49] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:13:49] [config] lr-decay-start:
[2023-07-04 17:13:49] [config]   - 10
[2023-07-04 17:13:49] [config]   - 1
[2023-07-04 17:13:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:13:49] [config] lr-report: false
[2023-07-04 17:13:49] [config] lr-warmup: 0
[2023-07-04 17:13:49] [config] lr-warmup-at-reload: false
[2023-07-04 17:13:49] [config] lr-warmup-cycle: false
[2023-07-04 17:13:49] [config] lr-warmup-start-rate: 0
[2023-07-04 17:13:49] [config] max-length: 50
[2023-07-04 17:13:49] [config] max-length-crop: false
[2023-07-04 17:13:49] [config] max-length-factor: 3
[2023-07-04 17:13:49] [config] maxi-batch: 100
[2023-07-04 17:13:49] [config] maxi-batch-sort: trg
[2023-07-04 17:13:49] [config] mini-batch: 64
[2023-07-04 17:13:49] [config] mini-batch-fit: false
[2023-07-04 17:13:49] [config] mini-batch-fit-step: 10
[2023-07-04 17:13:49] [config] mini-batch-round-up: true
[2023-07-04 17:13:49] [config] mini-batch-track-lr: false
[2023-07-04 17:13:49] [config] mini-batch-warmup: 0
[2023-07-04 17:13:49] [config] mini-batch-words: 0
[2023-07-04 17:13:49] [config] mini-batch-words-ref: 0
[2023-07-04 17:13:49] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:13:49] [config] multi-loss-type: sum
[2023-07-04 17:13:49] [config] n-best: false
[2023-07-04 17:13:49] [config] no-nccl: false
[2023-07-04 17:13:49] [config] no-reload: false
[2023-07-04 17:13:49] [config] no-restore-corpus: false
[2023-07-04 17:13:49] [config] normalize: 0
[2023-07-04 17:13:49] [config] normalize-gradient: false
[2023-07-04 17:13:49] [config] num-devices: 0
[2023-07-04 17:13:49] [config] optimizer: adam
[2023-07-04 17:13:49] [config] optimizer-delay: 1
[2023-07-04 17:13:49] [config] optimizer-params:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] output-omit-bias: false
[2023-07-04 17:13:49] [config] overwrite: true
[2023-07-04 17:13:49] [config] precision:
[2023-07-04 17:13:49] [config]   - float32
[2023-07-04 17:13:49] [config]   - float32
[2023-07-04 17:13:49] [config] pretrained-model: ""
[2023-07-04 17:13:49] [config] quantize-biases: false
[2023-07-04 17:13:49] [config] quantize-bits: 0
[2023-07-04 17:13:49] [config] quantize-log-based: false
[2023-07-04 17:13:49] [config] quantize-optimization-steps: 0
[2023-07-04 17:13:49] [config] quiet: false
[2023-07-04 17:13:49] [config] quiet-translation: true
[2023-07-04 17:13:49] [config] relative-paths: false
[2023-07-04 17:13:49] [config] right-left: false
[2023-07-04 17:13:49] [config] save-freq: 10000u
[2023-07-04 17:13:49] [config] seed: 1234
[2023-07-04 17:13:49] [config] sentencepiece-alphas:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:13:49] [config] sentencepiece-options: ""
[2023-07-04 17:13:49] [config] sharding: global
[2023-07-04 17:13:49] [config] shuffle: data
[2023-07-04 17:13:49] [config] shuffle-in-ram: false
[2023-07-04 17:13:49] [config] sigterm: save-and-exit
[2023-07-04 17:13:49] [config] skip: false
[2023-07-04 17:13:49] [config] sqlite: ""
[2023-07-04 17:13:49] [config] sqlite-drop: false
[2023-07-04 17:13:49] [config] sync-freq: 200u
[2023-07-04 17:13:49] [config] sync-sgd: false
[2023-07-04 17:13:49] [config] tempdir: /tmp
[2023-07-04 17:13:49] [config] tied-embeddings: false
[2023-07-04 17:13:49] [config] tied-embeddings-all: false
[2023-07-04 17:13:49] [config] tied-embeddings-src: false
[2023-07-04 17:13:49] [config] train-embedder-rank:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] train-sets:
[2023-07-04 17:13:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:13:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:13:49] [config] transformer-aan-activation: swish
[2023-07-04 17:13:49] [config] transformer-aan-depth: 2
[2023-07-04 17:13:49] [config] transformer-aan-nogate: false
[2023-07-04 17:13:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:13:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:13:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:13:49] [config] transformer-depth-scaling: false
[2023-07-04 17:13:49] [config] transformer-dim-aan: 2048
[2023-07-04 17:13:49] [config] transformer-dim-ffn: 2048
[2023-07-04 17:13:49] [config] transformer-dropout: 0
[2023-07-04 17:13:49] [config] transformer-dropout-attention: 0
[2023-07-04 17:13:49] [config] transformer-dropout-ffn: 0
[2023-07-04 17:13:49] [config] transformer-ffn-activation: swish
[2023-07-04 17:13:49] [config] transformer-ffn-depth: 2
[2023-07-04 17:13:49] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:13:49] [config] transformer-heads: 8
[2023-07-04 17:13:49] [config] transformer-no-projection: false
[2023-07-04 17:13:49] [config] transformer-pool: false
[2023-07-04 17:13:49] [config] transformer-postprocess: dan
[2023-07-04 17:13:49] [config] transformer-postprocess-emb: d
[2023-07-04 17:13:49] [config] transformer-postprocess-top: ""
[2023-07-04 17:13:49] [config] transformer-preprocess: ""
[2023-07-04 17:13:49] [config] transformer-tied-layers:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] transformer-train-position-embeddings: false
[2023-07-04 17:13:49] [config] tsv: false
[2023-07-04 17:13:49] [config] tsv-fields: 0
[2023-07-04 17:13:49] [config] type: amun
[2023-07-04 17:13:49] [config] ulr: false
[2023-07-04 17:13:49] [config] ulr-dim-emb: 0
[2023-07-04 17:13:49] [config] ulr-dropout: 0
[2023-07-04 17:13:49] [config] ulr-keys-vectors: ""
[2023-07-04 17:13:49] [config] ulr-query-vectors: ""
[2023-07-04 17:13:49] [config] ulr-softmax-temperature: 1
[2023-07-04 17:13:49] [config] ulr-trainable-transformation: false
[2023-07-04 17:13:49] [config] unlikelihood-loss: false
[2023-07-04 17:13:49] [config] valid-freq: 50000000
[2023-07-04 17:13:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:13:49] [config] valid-max-length: 1000
[2023-07-04 17:13:49] [config] valid-metrics:
[2023-07-04 17:13:49] [config]   - cross-entropy
[2023-07-04 17:13:49] [config]   - translation
[2023-07-04 17:13:49] [config] valid-mini-batch: 32
[2023-07-04 17:13:49] [config] valid-reset-stalled: false
[2023-07-04 17:13:49] [config] valid-script-args:
[2023-07-04 17:13:49] [config]   []
[2023-07-04 17:13:49] [config] valid-script-path: ""
[2023-07-04 17:13:49] [config] valid-sets:
[2023-07-04 17:13:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:13:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:13:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:13:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:13:49] [config] vocabs:
[2023-07-04 17:13:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:13:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:13:49] [config] word-penalty: 0
[2023-07-04 17:13:49] [config] word-scores: false
[2023-07-04 17:13:49] [config] workspace: 2048
[2023-07-04 17:13:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:13:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:13:49] [training] Using single-device training
[2023-07-04 17:13:49] Synced seed 1234
[2023-07-04 17:13:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:13:49] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:13:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:13:49] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:13:49] [valid] No post-processing script given for validating translator
[2023-07-04 17:13:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:13:50] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:13:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:13:50] [comm] Using global sharding
[2023-07-04 17:13:50] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:13:50] [training] Using 1 GPUs
[2023-07-04 17:13:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:13:53] Loading Adam parameters
[2023-07-04 17:13:53] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:13:53] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:13:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:13:53] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-07-04 17:13:53] [data] Shuffling data
[2023-07-04 17:13:53] [data] Done reading 20,192 sentences
[2023-07-04 17:13:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:13:53] Training started
[2023-07-04 17:13:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 17:13:53] [logits] Applying loss function for 1 factor(s)
[2023-07-04 17:13:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 17:13:54] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:13:54] Parameter type float32, optimization type float32, casting types false
[2023-07-04 17:14:28] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.98644406 * 1,330,991 @ 1,562 after 28,170,306 : Time 39.20s : 33951.43 words/s : gNorm 1.0328
[2023-07-04 17:14:38] Seen 18,843 samples
[2023-07-04 17:14:38] Starting data epoch 72 in logical epoch 72
[2023-07-04 17:14:38] [data] Shuffling data
[2023-07-04 17:14:38] [data] Done reading 20,192 sentences
[2023-07-04 17:14:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:15:29] Seen 18,843 samples
[2023-07-04 17:15:29] Starting data epoch 73 in logical epoch 73
[2023-07-04 17:15:29] [data] Shuffling data
[2023-07-04 17:15:29] [data] Done reading 20,192 sentences
[2023-07-04 17:15:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:16:18] Seen 18,843 samples
[2023-07-04 17:16:18] Starting data epoch 74 in logical epoch 74
[2023-07-04 17:16:18] [data] Shuffling data
[2023-07-04 17:16:18] [data] Done reading 20,192 sentences
[2023-07-04 17:16:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:17:06] Seen 18,843 samples
[2023-07-04 17:17:06] Starting data epoch 75 in logical epoch 75
[2023-07-04 17:17:06] [data] Shuffling data
[2023-07-04 17:17:06] [data] Done reading 20,192 sentences
[2023-07-04 17:17:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:17:15] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.87992358 * 1,344,658 @ 2,757 after 29,514,964 : Time 166.89s : 8057.20 words/s : gNorm 0.8296
[2023-07-04 17:17:56] Seen 18,843 samples
[2023-07-04 17:17:56] Starting data epoch 76 in logical epoch 76
[2023-07-04 17:17:56] [data] Shuffling data
[2023-07-04 17:17:56] [data] Done reading 20,192 sentences
[2023-07-04 17:17:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:18:45] Seen 18,843 samples
[2023-07-04 17:18:45] Starting data epoch 77 in logical epoch 77
[2023-07-04 17:18:45] [data] Shuffling data
[2023-07-04 17:18:45] [data] Done reading 20,192 sentences
[2023-07-04 17:18:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:19:35] Seen 18,843 samples
[2023-07-04 17:19:35] Starting data epoch 78 in logical epoch 78
[2023-07-04 17:19:35] [data] Shuffling data
[2023-07-04 17:19:35] [data] Done reading 20,192 sentences
[2023-07-04 17:19:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:20:03] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.78118962 * 1,340,855 @ 527 after 30,855,819 : Time 167.94s : 7983.92 words/s : gNorm 0.8181
[2023-07-04 17:20:24] Seen 18,843 samples
[2023-07-04 17:20:24] Starting data epoch 79 in logical epoch 79
[2023-07-04 17:20:24] [data] Shuffling data
[2023-07-04 17:20:25] [data] Done reading 20,192 sentences
[2023-07-04 17:20:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:21:15] Seen 18,843 samples
[2023-07-04 17:21:15] Starting data epoch 80 in logical epoch 80
[2023-07-04 17:21:15] [data] Shuffling data
[2023-07-04 17:21:15] [data] Done reading 20,192 sentences
[2023-07-04 17:21:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:22:04] Seen 18,843 samples
[2023-07-04 17:22:04] Starting data epoch 81 in logical epoch 81
[2023-07-04 17:22:04] Training finished
[2023-07-04 17:22:11] [valid] Ep. 81 : Up. 23727 : cross-entropy : 176.274 : stalled 7 times (last best: 108.419)
[2023-07-04 17:24:26] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-07-04 17:24:26] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:24:30] Saving Adam parameters
[2023-07-04 17:24:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:24:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:24:45] [marian] Running on node07.datos.cluster.uy as process 35203 with command line:
[2023-07-04 17:24:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:24:45] [config] after: 0e
[2023-07-04 17:24:45] [config] after-batches: 0
[2023-07-04 17:24:45] [config] after-epochs: 90
[2023-07-04 17:24:45] [config] all-caps-every: 0
[2023-07-04 17:24:45] [config] allow-unk: false
[2023-07-04 17:24:45] [config] authors: false
[2023-07-04 17:24:45] [config] beam-size: 12
[2023-07-04 17:24:45] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:24:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:24:45] [config] bert-masking-fraction: 0.15
[2023-07-04 17:24:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:24:45] [config] bert-train-type-embeddings: true
[2023-07-04 17:24:45] [config] bert-type-vocab-size: 2
[2023-07-04 17:24:45] [config] build-info: ""
[2023-07-04 17:24:45] [config] check-gradient-nan: false
[2023-07-04 17:24:45] [config] check-nan: false
[2023-07-04 17:24:45] [config] cite: false
[2023-07-04 17:24:45] [config] clip-norm: 1
[2023-07-04 17:24:45] [config] cost-scaling:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] cost-type: ce-sum
[2023-07-04 17:24:45] [config] cpu-threads: 0
[2023-07-04 17:24:45] [config] data-threads: 8
[2023-07-04 17:24:45] [config] data-weighting: ""
[2023-07-04 17:24:45] [config] data-weighting-type: sentence
[2023-07-04 17:24:45] [config] dec-cell: gru
[2023-07-04 17:24:45] [config] dec-cell-base-depth: 2
[2023-07-04 17:24:45] [config] dec-cell-high-depth: 1
[2023-07-04 17:24:45] [config] dec-depth: 1
[2023-07-04 17:24:45] [config] devices:
[2023-07-04 17:24:45] [config]   - 0
[2023-07-04 17:24:45] [config] dim-emb: 512
[2023-07-04 17:24:45] [config] dim-rnn: 1024
[2023-07-04 17:24:45] [config] dim-vocabs:
[2023-07-04 17:24:45] [config]   - 54042
[2023-07-04 17:24:45] [config]   - 36507
[2023-07-04 17:24:45] [config] disp-first: 0
[2023-07-04 17:24:45] [config] disp-freq: 1000u
[2023-07-04 17:24:45] [config] disp-label-counts: true
[2023-07-04 17:24:45] [config] dropout-rnn: 0
[2023-07-04 17:24:45] [config] dropout-src: 0
[2023-07-04 17:24:45] [config] dropout-trg: 0
[2023-07-04 17:24:45] [config] dump-config: ""
[2023-07-04 17:24:45] [config] dynamic-gradient-scaling:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] early-stopping: 10
[2023-07-04 17:24:45] [config] early-stopping-on: first
[2023-07-04 17:24:45] [config] embedding-fix-src: false
[2023-07-04 17:24:45] [config] embedding-fix-trg: false
[2023-07-04 17:24:45] [config] embedding-normalization: false
[2023-07-04 17:24:45] [config] embedding-vectors:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] enc-cell: gru
[2023-07-04 17:24:45] [config] enc-cell-depth: 1
[2023-07-04 17:24:45] [config] enc-depth: 1
[2023-07-04 17:24:45] [config] enc-type: bidirectional
[2023-07-04 17:24:45] [config] english-title-case-every: 0
[2023-07-04 17:24:45] [config] exponential-smoothing: 0
[2023-07-04 17:24:45] [config] factor-weight: 1
[2023-07-04 17:24:45] [config] factors-combine: sum
[2023-07-04 17:24:45] [config] factors-dim-emb: 0
[2023-07-04 17:24:45] [config] gradient-checkpointing: false
[2023-07-04 17:24:45] [config] gradient-norm-average-window: 100
[2023-07-04 17:24:45] [config] guided-alignment: none
[2023-07-04 17:24:45] [config] guided-alignment-cost: mse
[2023-07-04 17:24:45] [config] guided-alignment-weight: 0.1
[2023-07-04 17:24:45] [config] ignore-model-config: false
[2023-07-04 17:24:45] [config] input-types:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] interpolate-env-vars: false
[2023-07-04 17:24:45] [config] keep-best: false
[2023-07-04 17:24:45] [config] label-smoothing: 0
[2023-07-04 17:24:45] [config] layer-normalization: false
[2023-07-04 17:24:45] [config] learn-rate: 0.0001
[2023-07-04 17:24:45] [config] lemma-dependency: ""
[2023-07-04 17:24:45] [config] lemma-dim-emb: 0
[2023-07-04 17:24:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:24:45] [config] log-level: info
[2023-07-04 17:24:45] [config] log-time-zone: ""
[2023-07-04 17:24:45] [config] logical-epoch:
[2023-07-04 17:24:45] [config]   - 1e
[2023-07-04 17:24:45] [config]   - 0
[2023-07-04 17:24:45] [config] lr-decay: 0
[2023-07-04 17:24:45] [config] lr-decay-freq: 50000
[2023-07-04 17:24:45] [config] lr-decay-inv-sqrt:
[2023-07-04 17:24:45] [config]   - 0
[2023-07-04 17:24:45] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:24:45] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:24:45] [config] lr-decay-start:
[2023-07-04 17:24:45] [config]   - 10
[2023-07-04 17:24:45] [config]   - 1
[2023-07-04 17:24:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:24:45] [config] lr-report: false
[2023-07-04 17:24:45] [config] lr-warmup: 0
[2023-07-04 17:24:45] [config] lr-warmup-at-reload: false
[2023-07-04 17:24:45] [config] lr-warmup-cycle: false
[2023-07-04 17:24:45] [config] lr-warmup-start-rate: 0
[2023-07-04 17:24:45] [config] max-length: 50
[2023-07-04 17:24:45] [config] max-length-crop: false
[2023-07-04 17:24:45] [config] max-length-factor: 3
[2023-07-04 17:24:45] [config] maxi-batch: 100
[2023-07-04 17:24:45] [config] maxi-batch-sort: trg
[2023-07-04 17:24:45] [config] mini-batch: 64
[2023-07-04 17:24:45] [config] mini-batch-fit: false
[2023-07-04 17:24:45] [config] mini-batch-fit-step: 10
[2023-07-04 17:24:45] [config] mini-batch-round-up: true
[2023-07-04 17:24:45] [config] mini-batch-track-lr: false
[2023-07-04 17:24:45] [config] mini-batch-warmup: 0
[2023-07-04 17:24:45] [config] mini-batch-words: 0
[2023-07-04 17:24:45] [config] mini-batch-words-ref: 0
[2023-07-04 17:24:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:24:45] [config] multi-loss-type: sum
[2023-07-04 17:24:45] [config] n-best: false
[2023-07-04 17:24:45] [config] no-nccl: false
[2023-07-04 17:24:45] [config] no-reload: false
[2023-07-04 17:24:45] [config] no-restore-corpus: false
[2023-07-04 17:24:45] [config] normalize: 0
[2023-07-04 17:24:45] [config] normalize-gradient: false
[2023-07-04 17:24:45] [config] num-devices: 0
[2023-07-04 17:24:45] [config] optimizer: adam
[2023-07-04 17:24:45] [config] optimizer-delay: 1
[2023-07-04 17:24:45] [config] optimizer-params:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] output-omit-bias: false
[2023-07-04 17:24:45] [config] overwrite: true
[2023-07-04 17:24:45] [config] precision:
[2023-07-04 17:24:45] [config]   - float32
[2023-07-04 17:24:45] [config]   - float32
[2023-07-04 17:24:45] [config] pretrained-model: ""
[2023-07-04 17:24:45] [config] quantize-biases: false
[2023-07-04 17:24:45] [config] quantize-bits: 0
[2023-07-04 17:24:45] [config] quantize-log-based: false
[2023-07-04 17:24:45] [config] quantize-optimization-steps: 0
[2023-07-04 17:24:45] [config] quiet: false
[2023-07-04 17:24:45] [config] quiet-translation: true
[2023-07-04 17:24:45] [config] relative-paths: false
[2023-07-04 17:24:45] [config] right-left: false
[2023-07-04 17:24:45] [config] save-freq: 10000u
[2023-07-04 17:24:45] [config] seed: 1234
[2023-07-04 17:24:45] [config] sentencepiece-alphas:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:24:45] [config] sentencepiece-options: ""
[2023-07-04 17:24:45] [config] sharding: global
[2023-07-04 17:24:45] [config] shuffle: data
[2023-07-04 17:24:45] [config] shuffle-in-ram: false
[2023-07-04 17:24:45] [config] sigterm: save-and-exit
[2023-07-04 17:24:45] [config] skip: false
[2023-07-04 17:24:45] [config] sqlite: ""
[2023-07-04 17:24:45] [config] sqlite-drop: false
[2023-07-04 17:24:45] [config] sync-freq: 200u
[2023-07-04 17:24:45] [config] sync-sgd: false
[2023-07-04 17:24:45] [config] tempdir: /tmp
[2023-07-04 17:24:45] [config] tied-embeddings: false
[2023-07-04 17:24:45] [config] tied-embeddings-all: false
[2023-07-04 17:24:45] [config] tied-embeddings-src: false
[2023-07-04 17:24:45] [config] train-embedder-rank:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] train-sets:
[2023-07-04 17:24:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:24:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:24:45] [config] transformer-aan-activation: swish
[2023-07-04 17:24:45] [config] transformer-aan-depth: 2
[2023-07-04 17:24:45] [config] transformer-aan-nogate: false
[2023-07-04 17:24:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:24:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:24:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:24:45] [config] transformer-depth-scaling: false
[2023-07-04 17:24:45] [config] transformer-dim-aan: 2048
[2023-07-04 17:24:45] [config] transformer-dim-ffn: 2048
[2023-07-04 17:24:45] [config] transformer-dropout: 0
[2023-07-04 17:24:45] [config] transformer-dropout-attention: 0
[2023-07-04 17:24:45] [config] transformer-dropout-ffn: 0
[2023-07-04 17:24:45] [config] transformer-ffn-activation: swish
[2023-07-04 17:24:45] [config] transformer-ffn-depth: 2
[2023-07-04 17:24:45] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:24:45] [config] transformer-heads: 8
[2023-07-04 17:24:45] [config] transformer-no-projection: false
[2023-07-04 17:24:45] [config] transformer-pool: false
[2023-07-04 17:24:45] [config] transformer-postprocess: dan
[2023-07-04 17:24:45] [config] transformer-postprocess-emb: d
[2023-07-04 17:24:45] [config] transformer-postprocess-top: ""
[2023-07-04 17:24:45] [config] transformer-preprocess: ""
[2023-07-04 17:24:45] [config] transformer-tied-layers:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] transformer-train-position-embeddings: false
[2023-07-04 17:24:45] [config] tsv: false
[2023-07-04 17:24:45] [config] tsv-fields: 0
[2023-07-04 17:24:45] [config] type: amun
[2023-07-04 17:24:45] [config] ulr: false
[2023-07-04 17:24:45] [config] ulr-dim-emb: 0
[2023-07-04 17:24:45] [config] ulr-dropout: 0
[2023-07-04 17:24:45] [config] ulr-keys-vectors: ""
[2023-07-04 17:24:45] [config] ulr-query-vectors: ""
[2023-07-04 17:24:45] [config] ulr-softmax-temperature: 1
[2023-07-04 17:24:45] [config] ulr-trainable-transformation: false
[2023-07-04 17:24:45] [config] unlikelihood-loss: false
[2023-07-04 17:24:45] [config] valid-freq: 50000000
[2023-07-04 17:24:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:24:45] [config] valid-max-length: 1000
[2023-07-04 17:24:45] [config] valid-metrics:
[2023-07-04 17:24:45] [config]   - cross-entropy
[2023-07-04 17:24:45] [config]   - translation
[2023-07-04 17:24:45] [config] valid-mini-batch: 32
[2023-07-04 17:24:45] [config] valid-reset-stalled: false
[2023-07-04 17:24:45] [config] valid-script-args:
[2023-07-04 17:24:45] [config]   []
[2023-07-04 17:24:45] [config] valid-script-path: ""
[2023-07-04 17:24:45] [config] valid-sets:
[2023-07-04 17:24:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:24:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:24:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:24:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:24:45] [config] vocabs:
[2023-07-04 17:24:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:24:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:24:45] [config] word-penalty: 0
[2023-07-04 17:24:45] [config] word-scores: false
[2023-07-04 17:24:45] [config] workspace: 2048
[2023-07-04 17:24:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:24:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:24:45] [training] Using single-device training
[2023-07-04 17:24:45] Synced seed 1234
[2023-07-04 17:24:45] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:24:46] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:24:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:24:46] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:24:46] [valid] No post-processing script given for validating translator
[2023-07-04 17:24:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:24:46] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:24:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:24:46] [comm] Using global sharding
[2023-07-04 17:24:47] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:24:47] [training] Using 1 GPUs
[2023-07-04 17:24:47] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:24:49] Loading Adam parameters
[2023-07-04 17:24:50] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:24:50] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:24:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:24:50] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-07-04 17:24:50] [data] Shuffling data
[2023-07-04 17:24:50] [data] Done reading 20,192 sentences
[2023-07-04 17:24:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:24:50] Training started
[2023-07-04 17:24:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 17:24:50] [logits] Applying loss function for 1 factor(s)
[2023-07-04 17:24:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 17:24:50] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:24:50] Parameter type float32, optimization type float32, casting types false
[2023-07-04 17:25:30] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.68021178 * 1,343,267 @ 832 after 32,199,086 : Time 44.73s : 30033.84 words/s : gNorm 0.8339
[2023-07-04 17:25:34] Seen 18,843 samples
[2023-07-04 17:25:34] Starting data epoch 82 in logical epoch 82
[2023-07-04 17:25:34] [data] Shuffling data
[2023-07-04 17:25:34] [data] Done reading 20,192 sentences
[2023-07-04 17:25:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:26:24] Seen 18,843 samples
[2023-07-04 17:26:24] Starting data epoch 83 in logical epoch 83
[2023-07-04 17:26:24] [data] Shuffling data
[2023-07-04 17:26:24] [data] Done reading 20,192 sentences
[2023-07-04 17:26:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:27:12] Seen 18,843 samples
[2023-07-04 17:27:12] Starting data epoch 84 in logical epoch 84
[2023-07-04 17:27:12] [data] Shuffling data
[2023-07-04 17:27:12] [data] Done reading 20,192 sentences
[2023-07-04 17:27:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:28:00] Seen 18,843 samples
[2023-07-04 17:28:00] Starting data epoch 85 in logical epoch 85
[2023-07-04 17:28:00] [data] Shuffling data
[2023-07-04 17:28:00] [data] Done reading 20,192 sentences
[2023-07-04 17:28:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:28:14] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.58963567 * 1,339,320 @ 1,280 after 33,538,406 : Time 163.78s : 8177.69 words/s : gNorm 0.7996
[2023-07-04 17:28:50] Seen 18,843 samples
[2023-07-04 17:28:50] Starting data epoch 86 in logical epoch 86
[2023-07-04 17:28:50] [data] Shuffling data
[2023-07-04 17:28:50] [data] Done reading 20,192 sentences
[2023-07-04 17:28:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:29:40] Seen 18,843 samples
[2023-07-04 17:29:40] Starting data epoch 87 in logical epoch 87
[2023-07-04 17:29:40] [data] Shuffling data
[2023-07-04 17:29:40] [data] Done reading 20,192 sentences
[2023-07-04 17:29:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:30:30] Seen 18,843 samples
[2023-07-04 17:30:30] Starting data epoch 88 in logical epoch 88
[2023-07-04 17:30:30] [data] Shuffling data
[2023-07-04 17:30:30] [data] Done reading 20,192 sentences
[2023-07-04 17:30:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:31:04] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.51397216 * 1,346,822 @ 896 after 34,885,228 : Time 170.09s : 7918.21 words/s : gNorm 0.7848
[2023-07-04 17:31:20] Seen 18,843 samples
[2023-07-04 17:31:20] Starting data epoch 89 in logical epoch 89
[2023-07-04 17:31:20] [data] Shuffling data
[2023-07-04 17:31:20] [data] Done reading 20,192 sentences
[2023-07-04 17:31:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:32:10] Seen 18,843 samples
[2023-07-04 17:32:10] Starting data epoch 90 in logical epoch 90
[2023-07-04 17:32:10] [data] Shuffling data
[2023-07-04 17:32:10] [data] Done reading 20,192 sentences
[2023-07-04 17:32:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:32:58] Seen 18,843 samples
[2023-07-04 17:32:58] Starting data epoch 91 in logical epoch 91
[2023-07-04 17:32:58] Training finished
[2023-07-04 17:33:05] [valid] Ep. 91 : Up. 26693 : cross-entropy : 185.373 : stalled 8 times (last best: 108.419)
[2023-07-04 17:35:19] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-07-04 17:35:19] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:35:23] Saving Adam parameters
[2023-07-04 17:35:24] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:35:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:35:38] [marian] Running on node07.datos.cluster.uy as process 35819 with command line:
[2023-07-04 17:35:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:35:38] [config] after: 0e
[2023-07-04 17:35:38] [config] after-batches: 0
[2023-07-04 17:35:38] [config] after-epochs: 100
[2023-07-04 17:35:38] [config] all-caps-every: 0
[2023-07-04 17:35:38] [config] allow-unk: false
[2023-07-04 17:35:38] [config] authors: false
[2023-07-04 17:35:38] [config] beam-size: 12
[2023-07-04 17:35:38] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:35:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:35:38] [config] bert-masking-fraction: 0.15
[2023-07-04 17:35:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:35:38] [config] bert-train-type-embeddings: true
[2023-07-04 17:35:38] [config] bert-type-vocab-size: 2
[2023-07-04 17:35:38] [config] build-info: ""
[2023-07-04 17:35:38] [config] check-gradient-nan: false
[2023-07-04 17:35:38] [config] check-nan: false
[2023-07-04 17:35:38] [config] cite: false
[2023-07-04 17:35:38] [config] clip-norm: 1
[2023-07-04 17:35:38] [config] cost-scaling:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] cost-type: ce-sum
[2023-07-04 17:35:38] [config] cpu-threads: 0
[2023-07-04 17:35:38] [config] data-threads: 8
[2023-07-04 17:35:38] [config] data-weighting: ""
[2023-07-04 17:35:38] [config] data-weighting-type: sentence
[2023-07-04 17:35:38] [config] dec-cell: gru
[2023-07-04 17:35:38] [config] dec-cell-base-depth: 2
[2023-07-04 17:35:38] [config] dec-cell-high-depth: 1
[2023-07-04 17:35:38] [config] dec-depth: 1
[2023-07-04 17:35:38] [config] devices:
[2023-07-04 17:35:38] [config]   - 0
[2023-07-04 17:35:38] [config] dim-emb: 512
[2023-07-04 17:35:38] [config] dim-rnn: 1024
[2023-07-04 17:35:38] [config] dim-vocabs:
[2023-07-04 17:35:38] [config]   - 54042
[2023-07-04 17:35:38] [config]   - 36507
[2023-07-04 17:35:38] [config] disp-first: 0
[2023-07-04 17:35:38] [config] disp-freq: 1000u
[2023-07-04 17:35:38] [config] disp-label-counts: true
[2023-07-04 17:35:38] [config] dropout-rnn: 0
[2023-07-04 17:35:38] [config] dropout-src: 0
[2023-07-04 17:35:38] [config] dropout-trg: 0
[2023-07-04 17:35:38] [config] dump-config: ""
[2023-07-04 17:35:38] [config] dynamic-gradient-scaling:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] early-stopping: 10
[2023-07-04 17:35:38] [config] early-stopping-on: first
[2023-07-04 17:35:38] [config] embedding-fix-src: false
[2023-07-04 17:35:38] [config] embedding-fix-trg: false
[2023-07-04 17:35:38] [config] embedding-normalization: false
[2023-07-04 17:35:38] [config] embedding-vectors:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] enc-cell: gru
[2023-07-04 17:35:38] [config] enc-cell-depth: 1
[2023-07-04 17:35:38] [config] enc-depth: 1
[2023-07-04 17:35:38] [config] enc-type: bidirectional
[2023-07-04 17:35:38] [config] english-title-case-every: 0
[2023-07-04 17:35:38] [config] exponential-smoothing: 0
[2023-07-04 17:35:38] [config] factor-weight: 1
[2023-07-04 17:35:38] [config] factors-combine: sum
[2023-07-04 17:35:38] [config] factors-dim-emb: 0
[2023-07-04 17:35:38] [config] gradient-checkpointing: false
[2023-07-04 17:35:38] [config] gradient-norm-average-window: 100
[2023-07-04 17:35:38] [config] guided-alignment: none
[2023-07-04 17:35:38] [config] guided-alignment-cost: mse
[2023-07-04 17:35:38] [config] guided-alignment-weight: 0.1
[2023-07-04 17:35:38] [config] ignore-model-config: false
[2023-07-04 17:35:38] [config] input-types:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] interpolate-env-vars: false
[2023-07-04 17:35:38] [config] keep-best: false
[2023-07-04 17:35:38] [config] label-smoothing: 0
[2023-07-04 17:35:38] [config] layer-normalization: false
[2023-07-04 17:35:38] [config] learn-rate: 0.0001
[2023-07-04 17:35:38] [config] lemma-dependency: ""
[2023-07-04 17:35:38] [config] lemma-dim-emb: 0
[2023-07-04 17:35:38] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:35:38] [config] log-level: info
[2023-07-04 17:35:38] [config] log-time-zone: ""
[2023-07-04 17:35:38] [config] logical-epoch:
[2023-07-04 17:35:38] [config]   - 1e
[2023-07-04 17:35:38] [config]   - 0
[2023-07-04 17:35:38] [config] lr-decay: 0
[2023-07-04 17:35:38] [config] lr-decay-freq: 50000
[2023-07-04 17:35:38] [config] lr-decay-inv-sqrt:
[2023-07-04 17:35:38] [config]   - 0
[2023-07-04 17:35:38] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:35:38] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:35:38] [config] lr-decay-start:
[2023-07-04 17:35:38] [config]   - 10
[2023-07-04 17:35:38] [config]   - 1
[2023-07-04 17:35:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:35:38] [config] lr-report: false
[2023-07-04 17:35:38] [config] lr-warmup: 0
[2023-07-04 17:35:38] [config] lr-warmup-at-reload: false
[2023-07-04 17:35:38] [config] lr-warmup-cycle: false
[2023-07-04 17:35:38] [config] lr-warmup-start-rate: 0
[2023-07-04 17:35:38] [config] max-length: 50
[2023-07-04 17:35:38] [config] max-length-crop: false
[2023-07-04 17:35:38] [config] max-length-factor: 3
[2023-07-04 17:35:38] [config] maxi-batch: 100
[2023-07-04 17:35:38] [config] maxi-batch-sort: trg
[2023-07-04 17:35:38] [config] mini-batch: 64
[2023-07-04 17:35:38] [config] mini-batch-fit: false
[2023-07-04 17:35:38] [config] mini-batch-fit-step: 10
[2023-07-04 17:35:38] [config] mini-batch-round-up: true
[2023-07-04 17:35:38] [config] mini-batch-track-lr: false
[2023-07-04 17:35:38] [config] mini-batch-warmup: 0
[2023-07-04 17:35:38] [config] mini-batch-words: 0
[2023-07-04 17:35:38] [config] mini-batch-words-ref: 0
[2023-07-04 17:35:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:35:38] [config] multi-loss-type: sum
[2023-07-04 17:35:38] [config] n-best: false
[2023-07-04 17:35:38] [config] no-nccl: false
[2023-07-04 17:35:38] [config] no-reload: false
[2023-07-04 17:35:38] [config] no-restore-corpus: false
[2023-07-04 17:35:38] [config] normalize: 0
[2023-07-04 17:35:38] [config] normalize-gradient: false
[2023-07-04 17:35:38] [config] num-devices: 0
[2023-07-04 17:35:38] [config] optimizer: adam
[2023-07-04 17:35:38] [config] optimizer-delay: 1
[2023-07-04 17:35:38] [config] optimizer-params:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] output-omit-bias: false
[2023-07-04 17:35:38] [config] overwrite: true
[2023-07-04 17:35:38] [config] precision:
[2023-07-04 17:35:38] [config]   - float32
[2023-07-04 17:35:38] [config]   - float32
[2023-07-04 17:35:38] [config] pretrained-model: ""
[2023-07-04 17:35:38] [config] quantize-biases: false
[2023-07-04 17:35:38] [config] quantize-bits: 0
[2023-07-04 17:35:38] [config] quantize-log-based: false
[2023-07-04 17:35:38] [config] quantize-optimization-steps: 0
[2023-07-04 17:35:38] [config] quiet: false
[2023-07-04 17:35:38] [config] quiet-translation: true
[2023-07-04 17:35:38] [config] relative-paths: false
[2023-07-04 17:35:38] [config] right-left: false
[2023-07-04 17:35:38] [config] save-freq: 10000u
[2023-07-04 17:35:38] [config] seed: 1234
[2023-07-04 17:35:38] [config] sentencepiece-alphas:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:35:38] [config] sentencepiece-options: ""
[2023-07-04 17:35:38] [config] sharding: global
[2023-07-04 17:35:38] [config] shuffle: data
[2023-07-04 17:35:38] [config] shuffle-in-ram: false
[2023-07-04 17:35:38] [config] sigterm: save-and-exit
[2023-07-04 17:35:38] [config] skip: false
[2023-07-04 17:35:38] [config] sqlite: ""
[2023-07-04 17:35:38] [config] sqlite-drop: false
[2023-07-04 17:35:38] [config] sync-freq: 200u
[2023-07-04 17:35:38] [config] sync-sgd: false
[2023-07-04 17:35:38] [config] tempdir: /tmp
[2023-07-04 17:35:38] [config] tied-embeddings: false
[2023-07-04 17:35:38] [config] tied-embeddings-all: false
[2023-07-04 17:35:38] [config] tied-embeddings-src: false
[2023-07-04 17:35:38] [config] train-embedder-rank:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] train-sets:
[2023-07-04 17:35:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:35:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:35:38] [config] transformer-aan-activation: swish
[2023-07-04 17:35:38] [config] transformer-aan-depth: 2
[2023-07-04 17:35:38] [config] transformer-aan-nogate: false
[2023-07-04 17:35:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:35:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:35:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:35:38] [config] transformer-depth-scaling: false
[2023-07-04 17:35:38] [config] transformer-dim-aan: 2048
[2023-07-04 17:35:38] [config] transformer-dim-ffn: 2048
[2023-07-04 17:35:38] [config] transformer-dropout: 0
[2023-07-04 17:35:38] [config] transformer-dropout-attention: 0
[2023-07-04 17:35:38] [config] transformer-dropout-ffn: 0
[2023-07-04 17:35:38] [config] transformer-ffn-activation: swish
[2023-07-04 17:35:38] [config] transformer-ffn-depth: 2
[2023-07-04 17:35:38] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:35:38] [config] transformer-heads: 8
[2023-07-04 17:35:38] [config] transformer-no-projection: false
[2023-07-04 17:35:38] [config] transformer-pool: false
[2023-07-04 17:35:38] [config] transformer-postprocess: dan
[2023-07-04 17:35:38] [config] transformer-postprocess-emb: d
[2023-07-04 17:35:38] [config] transformer-postprocess-top: ""
[2023-07-04 17:35:38] [config] transformer-preprocess: ""
[2023-07-04 17:35:38] [config] transformer-tied-layers:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] transformer-train-position-embeddings: false
[2023-07-04 17:35:38] [config] tsv: false
[2023-07-04 17:35:38] [config] tsv-fields: 0
[2023-07-04 17:35:38] [config] type: amun
[2023-07-04 17:35:38] [config] ulr: false
[2023-07-04 17:35:38] [config] ulr-dim-emb: 0
[2023-07-04 17:35:38] [config] ulr-dropout: 0
[2023-07-04 17:35:38] [config] ulr-keys-vectors: ""
[2023-07-04 17:35:38] [config] ulr-query-vectors: ""
[2023-07-04 17:35:38] [config] ulr-softmax-temperature: 1
[2023-07-04 17:35:38] [config] ulr-trainable-transformation: false
[2023-07-04 17:35:38] [config] unlikelihood-loss: false
[2023-07-04 17:35:38] [config] valid-freq: 50000000
[2023-07-04 17:35:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:35:38] [config] valid-max-length: 1000
[2023-07-04 17:35:38] [config] valid-metrics:
[2023-07-04 17:35:38] [config]   - cross-entropy
[2023-07-04 17:35:38] [config]   - translation
[2023-07-04 17:35:38] [config] valid-mini-batch: 32
[2023-07-04 17:35:38] [config] valid-reset-stalled: false
[2023-07-04 17:35:38] [config] valid-script-args:
[2023-07-04 17:35:38] [config]   []
[2023-07-04 17:35:38] [config] valid-script-path: ""
[2023-07-04 17:35:38] [config] valid-sets:
[2023-07-04 17:35:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:35:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:35:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:35:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:35:38] [config] vocabs:
[2023-07-04 17:35:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:35:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:35:38] [config] word-penalty: 0
[2023-07-04 17:35:38] [config] word-scores: false
[2023-07-04 17:35:38] [config] workspace: 2048
[2023-07-04 17:35:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:35:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:35:38] [training] Using single-device training
[2023-07-04 17:35:38] Synced seed 1234
[2023-07-04 17:35:38] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:35:38] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:35:38] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:35:38] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:35:38] [valid] No post-processing script given for validating translator
[2023-07-04 17:35:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:35:39] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:35:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:35:39] [comm] Using global sharding
[2023-07-04 17:35:39] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:35:39] [training] Using 1 GPUs
[2023-07-04 17:35:39] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:35:42] Loading Adam parameters
[2023-07-04 17:35:42] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:35:42] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:35:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:35:42] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-07-04 17:35:42] [data] Shuffling data
[2023-07-04 17:35:42] [data] Done reading 20,192 sentences
[2023-07-04 17:35:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:35:42] Training started
[2023-07-04 17:35:42] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 17:35:42] [logits] Applying loss function for 1 factor(s)
[2023-07-04 17:35:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 17:35:43] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:35:43] Parameter type float32, optimization type float32, casting types false
[2023-07-04 17:36:26] Seen 18,843 samples
[2023-07-04 17:36:26] Starting data epoch 92 in logical epoch 92
[2023-07-04 17:36:26] [data] Shuffling data
[2023-07-04 17:36:26] [data] Done reading 20,192 sentences
[2023-07-04 17:36:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:36:27] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.43830353 * 1,333,196 @ 488 after 36,218,424 : Time 49.31s : 27034.33 words/s : gNorm 0.6060
[2023-07-04 17:37:16] Seen 18,843 samples
[2023-07-04 17:37:16] Starting data epoch 93 in logical epoch 93
[2023-07-04 17:37:16] [data] Shuffling data
[2023-07-04 17:37:16] [data] Done reading 20,192 sentences
[2023-07-04 17:37:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:38:06] Seen 18,843 samples
[2023-07-04 17:38:06] Starting data epoch 94 in logical epoch 94
[2023-07-04 17:38:06] [data] Shuffling data
[2023-07-04 17:38:06] [data] Done reading 20,192 sentences
[2023-07-04 17:38:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:38:55] Seen 18,843 samples
[2023-07-04 17:38:55] Starting data epoch 95 in logical epoch 95
[2023-07-04 17:38:55] [data] Shuffling data
[2023-07-04 17:38:55] [data] Done reading 20,192 sentences
[2023-07-04 17:38:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:39:16] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.37518942 * 1,349,095 @ 2,048 after 37,567,519 : Time 168.59s : 8002.05 words/s : gNorm 0.7414
[2023-07-04 17:39:44] Seen 18,843 samples
[2023-07-04 17:39:44] Starting data epoch 96 in logical epoch 96
[2023-07-04 17:39:44] [data] Shuffling data
[2023-07-04 17:39:44] [data] Done reading 20,192 sentences
[2023-07-04 17:39:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:40:35] Seen 18,843 samples
[2023-07-04 17:40:35] Starting data epoch 97 in logical epoch 97
[2023-07-04 17:40:35] [data] Shuffling data
[2023-07-04 17:40:35] [data] Done reading 20,192 sentences
[2023-07-04 17:40:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:41:24] Seen 18,843 samples
[2023-07-04 17:41:24] Starting data epoch 98 in logical epoch 98
[2023-07-04 17:41:24] [data] Shuffling data
[2023-07-04 17:41:24] [data] Done reading 20,192 sentences
[2023-07-04 17:41:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:42:02] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.31452206 * 1,338,821 @ 2,572 after 38,906,340 : Time 166.34s : 8048.61 words/s : gNorm 0.6437
[2023-07-04 17:42:13] Seen 18,843 samples
[2023-07-04 17:42:13] Starting data epoch 99 in logical epoch 99
[2023-07-04 17:42:13] [data] Shuffling data
[2023-07-04 17:42:13] [data] Done reading 20,192 sentences
[2023-07-04 17:42:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:43:02] Seen 18,843 samples
[2023-07-04 17:43:02] Starting data epoch 100 in logical epoch 100
[2023-07-04 17:43:02] [data] Shuffling data
[2023-07-04 17:43:02] [data] Done reading 20,192 sentences
[2023-07-04 17:43:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:43:52] Seen 18,843 samples
[2023-07-04 17:43:52] Starting data epoch 101 in logical epoch 101
[2023-07-04 17:43:52] Training finished
[2023-07-04 17:43:58] [valid] Ep. 101 : Up. 29659 : cross-entropy : 194.246 : stalled 9 times (last best: 108.419)
[2023-07-04 17:46:05] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-07-04 17:46:05] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:46:08] Saving Adam parameters
[2023-07-04 17:46:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:46:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:46:22] [marian] Running on node07.datos.cluster.uy as process 36760 with command line:
[2023-07-04 17:46:22] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:46:22] [config] after: 0e
[2023-07-04 17:46:22] [config] after-batches: 0
[2023-07-04 17:46:22] [config] after-epochs: 110
[2023-07-04 17:46:22] [config] all-caps-every: 0
[2023-07-04 17:46:22] [config] allow-unk: false
[2023-07-04 17:46:22] [config] authors: false
[2023-07-04 17:46:22] [config] beam-size: 12
[2023-07-04 17:46:22] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:46:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:46:22] [config] bert-masking-fraction: 0.15
[2023-07-04 17:46:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:46:22] [config] bert-train-type-embeddings: true
[2023-07-04 17:46:22] [config] bert-type-vocab-size: 2
[2023-07-04 17:46:22] [config] build-info: ""
[2023-07-04 17:46:22] [config] check-gradient-nan: false
[2023-07-04 17:46:22] [config] check-nan: false
[2023-07-04 17:46:22] [config] cite: false
[2023-07-04 17:46:22] [config] clip-norm: 1
[2023-07-04 17:46:22] [config] cost-scaling:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] cost-type: ce-sum
[2023-07-04 17:46:22] [config] cpu-threads: 0
[2023-07-04 17:46:22] [config] data-threads: 8
[2023-07-04 17:46:22] [config] data-weighting: ""
[2023-07-04 17:46:22] [config] data-weighting-type: sentence
[2023-07-04 17:46:22] [config] dec-cell: gru
[2023-07-04 17:46:22] [config] dec-cell-base-depth: 2
[2023-07-04 17:46:22] [config] dec-cell-high-depth: 1
[2023-07-04 17:46:22] [config] dec-depth: 1
[2023-07-04 17:46:22] [config] devices:
[2023-07-04 17:46:22] [config]   - 0
[2023-07-04 17:46:22] [config] dim-emb: 512
[2023-07-04 17:46:22] [config] dim-rnn: 1024
[2023-07-04 17:46:22] [config] dim-vocabs:
[2023-07-04 17:46:22] [config]   - 54042
[2023-07-04 17:46:22] [config]   - 36507
[2023-07-04 17:46:22] [config] disp-first: 0
[2023-07-04 17:46:22] [config] disp-freq: 1000u
[2023-07-04 17:46:22] [config] disp-label-counts: true
[2023-07-04 17:46:22] [config] dropout-rnn: 0
[2023-07-04 17:46:22] [config] dropout-src: 0
[2023-07-04 17:46:22] [config] dropout-trg: 0
[2023-07-04 17:46:22] [config] dump-config: ""
[2023-07-04 17:46:22] [config] dynamic-gradient-scaling:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] early-stopping: 10
[2023-07-04 17:46:22] [config] early-stopping-on: first
[2023-07-04 17:46:22] [config] embedding-fix-src: false
[2023-07-04 17:46:22] [config] embedding-fix-trg: false
[2023-07-04 17:46:22] [config] embedding-normalization: false
[2023-07-04 17:46:22] [config] embedding-vectors:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] enc-cell: gru
[2023-07-04 17:46:22] [config] enc-cell-depth: 1
[2023-07-04 17:46:22] [config] enc-depth: 1
[2023-07-04 17:46:22] [config] enc-type: bidirectional
[2023-07-04 17:46:22] [config] english-title-case-every: 0
[2023-07-04 17:46:22] [config] exponential-smoothing: 0
[2023-07-04 17:46:22] [config] factor-weight: 1
[2023-07-04 17:46:22] [config] factors-combine: sum
[2023-07-04 17:46:22] [config] factors-dim-emb: 0
[2023-07-04 17:46:22] [config] gradient-checkpointing: false
[2023-07-04 17:46:22] [config] gradient-norm-average-window: 100
[2023-07-04 17:46:22] [config] guided-alignment: none
[2023-07-04 17:46:22] [config] guided-alignment-cost: mse
[2023-07-04 17:46:22] [config] guided-alignment-weight: 0.1
[2023-07-04 17:46:22] [config] ignore-model-config: false
[2023-07-04 17:46:22] [config] input-types:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] interpolate-env-vars: false
[2023-07-04 17:46:22] [config] keep-best: false
[2023-07-04 17:46:22] [config] label-smoothing: 0
[2023-07-04 17:46:22] [config] layer-normalization: false
[2023-07-04 17:46:22] [config] learn-rate: 0.0001
[2023-07-04 17:46:22] [config] lemma-dependency: ""
[2023-07-04 17:46:22] [config] lemma-dim-emb: 0
[2023-07-04 17:46:22] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:46:22] [config] log-level: info
[2023-07-04 17:46:22] [config] log-time-zone: ""
[2023-07-04 17:46:22] [config] logical-epoch:
[2023-07-04 17:46:22] [config]   - 1e
[2023-07-04 17:46:22] [config]   - 0
[2023-07-04 17:46:22] [config] lr-decay: 0
[2023-07-04 17:46:22] [config] lr-decay-freq: 50000
[2023-07-04 17:46:22] [config] lr-decay-inv-sqrt:
[2023-07-04 17:46:22] [config]   - 0
[2023-07-04 17:46:22] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:46:22] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:46:22] [config] lr-decay-start:
[2023-07-04 17:46:22] [config]   - 10
[2023-07-04 17:46:22] [config]   - 1
[2023-07-04 17:46:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:46:22] [config] lr-report: false
[2023-07-04 17:46:22] [config] lr-warmup: 0
[2023-07-04 17:46:22] [config] lr-warmup-at-reload: false
[2023-07-04 17:46:22] [config] lr-warmup-cycle: false
[2023-07-04 17:46:22] [config] lr-warmup-start-rate: 0
[2023-07-04 17:46:22] [config] max-length: 50
[2023-07-04 17:46:22] [config] max-length-crop: false
[2023-07-04 17:46:22] [config] max-length-factor: 3
[2023-07-04 17:46:22] [config] maxi-batch: 100
[2023-07-04 17:46:22] [config] maxi-batch-sort: trg
[2023-07-04 17:46:22] [config] mini-batch: 64
[2023-07-04 17:46:22] [config] mini-batch-fit: false
[2023-07-04 17:46:22] [config] mini-batch-fit-step: 10
[2023-07-04 17:46:22] [config] mini-batch-round-up: true
[2023-07-04 17:46:22] [config] mini-batch-track-lr: false
[2023-07-04 17:46:22] [config] mini-batch-warmup: 0
[2023-07-04 17:46:22] [config] mini-batch-words: 0
[2023-07-04 17:46:22] [config] mini-batch-words-ref: 0
[2023-07-04 17:46:22] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:46:22] [config] multi-loss-type: sum
[2023-07-04 17:46:22] [config] n-best: false
[2023-07-04 17:46:22] [config] no-nccl: false
[2023-07-04 17:46:22] [config] no-reload: false
[2023-07-04 17:46:22] [config] no-restore-corpus: false
[2023-07-04 17:46:22] [config] normalize: 0
[2023-07-04 17:46:22] [config] normalize-gradient: false
[2023-07-04 17:46:22] [config] num-devices: 0
[2023-07-04 17:46:22] [config] optimizer: adam
[2023-07-04 17:46:22] [config] optimizer-delay: 1
[2023-07-04 17:46:22] [config] optimizer-params:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] output-omit-bias: false
[2023-07-04 17:46:22] [config] overwrite: true
[2023-07-04 17:46:22] [config] precision:
[2023-07-04 17:46:22] [config]   - float32
[2023-07-04 17:46:22] [config]   - float32
[2023-07-04 17:46:22] [config] pretrained-model: ""
[2023-07-04 17:46:22] [config] quantize-biases: false
[2023-07-04 17:46:22] [config] quantize-bits: 0
[2023-07-04 17:46:22] [config] quantize-log-based: false
[2023-07-04 17:46:22] [config] quantize-optimization-steps: 0
[2023-07-04 17:46:22] [config] quiet: false
[2023-07-04 17:46:22] [config] quiet-translation: true
[2023-07-04 17:46:22] [config] relative-paths: false
[2023-07-04 17:46:22] [config] right-left: false
[2023-07-04 17:46:22] [config] save-freq: 10000u
[2023-07-04 17:46:22] [config] seed: 1234
[2023-07-04 17:46:22] [config] sentencepiece-alphas:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:46:22] [config] sentencepiece-options: ""
[2023-07-04 17:46:22] [config] sharding: global
[2023-07-04 17:46:22] [config] shuffle: data
[2023-07-04 17:46:22] [config] shuffle-in-ram: false
[2023-07-04 17:46:22] [config] sigterm: save-and-exit
[2023-07-04 17:46:22] [config] skip: false
[2023-07-04 17:46:22] [config] sqlite: ""
[2023-07-04 17:46:22] [config] sqlite-drop: false
[2023-07-04 17:46:22] [config] sync-freq: 200u
[2023-07-04 17:46:22] [config] sync-sgd: false
[2023-07-04 17:46:22] [config] tempdir: /tmp
[2023-07-04 17:46:22] [config] tied-embeddings: false
[2023-07-04 17:46:22] [config] tied-embeddings-all: false
[2023-07-04 17:46:22] [config] tied-embeddings-src: false
[2023-07-04 17:46:22] [config] train-embedder-rank:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] train-sets:
[2023-07-04 17:46:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:46:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:46:22] [config] transformer-aan-activation: swish
[2023-07-04 17:46:22] [config] transformer-aan-depth: 2
[2023-07-04 17:46:22] [config] transformer-aan-nogate: false
[2023-07-04 17:46:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:46:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:46:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:46:22] [config] transformer-depth-scaling: false
[2023-07-04 17:46:22] [config] transformer-dim-aan: 2048
[2023-07-04 17:46:22] [config] transformer-dim-ffn: 2048
[2023-07-04 17:46:22] [config] transformer-dropout: 0
[2023-07-04 17:46:22] [config] transformer-dropout-attention: 0
[2023-07-04 17:46:22] [config] transformer-dropout-ffn: 0
[2023-07-04 17:46:22] [config] transformer-ffn-activation: swish
[2023-07-04 17:46:22] [config] transformer-ffn-depth: 2
[2023-07-04 17:46:22] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:46:22] [config] transformer-heads: 8
[2023-07-04 17:46:22] [config] transformer-no-projection: false
[2023-07-04 17:46:22] [config] transformer-pool: false
[2023-07-04 17:46:22] [config] transformer-postprocess: dan
[2023-07-04 17:46:22] [config] transformer-postprocess-emb: d
[2023-07-04 17:46:22] [config] transformer-postprocess-top: ""
[2023-07-04 17:46:22] [config] transformer-preprocess: ""
[2023-07-04 17:46:22] [config] transformer-tied-layers:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] transformer-train-position-embeddings: false
[2023-07-04 17:46:22] [config] tsv: false
[2023-07-04 17:46:22] [config] tsv-fields: 0
[2023-07-04 17:46:22] [config] type: amun
[2023-07-04 17:46:22] [config] ulr: false
[2023-07-04 17:46:22] [config] ulr-dim-emb: 0
[2023-07-04 17:46:22] [config] ulr-dropout: 0
[2023-07-04 17:46:22] [config] ulr-keys-vectors: ""
[2023-07-04 17:46:22] [config] ulr-query-vectors: ""
[2023-07-04 17:46:22] [config] ulr-softmax-temperature: 1
[2023-07-04 17:46:22] [config] ulr-trainable-transformation: false
[2023-07-04 17:46:22] [config] unlikelihood-loss: false
[2023-07-04 17:46:22] [config] valid-freq: 50000000
[2023-07-04 17:46:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:46:22] [config] valid-max-length: 1000
[2023-07-04 17:46:22] [config] valid-metrics:
[2023-07-04 17:46:22] [config]   - cross-entropy
[2023-07-04 17:46:22] [config]   - translation
[2023-07-04 17:46:22] [config] valid-mini-batch: 32
[2023-07-04 17:46:22] [config] valid-reset-stalled: false
[2023-07-04 17:46:22] [config] valid-script-args:
[2023-07-04 17:46:22] [config]   []
[2023-07-04 17:46:22] [config] valid-script-path: ""
[2023-07-04 17:46:22] [config] valid-sets:
[2023-07-04 17:46:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:46:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:46:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:46:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:46:22] [config] vocabs:
[2023-07-04 17:46:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:46:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:46:22] [config] word-penalty: 0
[2023-07-04 17:46:22] [config] word-scores: false
[2023-07-04 17:46:22] [config] workspace: 2048
[2023-07-04 17:46:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:46:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:46:22] [training] Using single-device training
[2023-07-04 17:46:22] Synced seed 1234
[2023-07-04 17:46:22] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:46:22] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:46:22] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:46:23] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:46:23] [valid] No post-processing script given for validating translator
[2023-07-04 17:46:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:46:23] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:46:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:46:23] [comm] Using global sharding
[2023-07-04 17:46:24] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:46:24] [training] Using 1 GPUs
[2023-07-04 17:46:24] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:46:26] Loading Adam parameters
[2023-07-04 17:46:27] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:46:27] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:46:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:46:27] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-07-04 17:46:27] [data] Shuffling data
[2023-07-04 17:46:27] [data] Done reading 20,192 sentences
[2023-07-04 17:46:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:46:27] Training started
[2023-07-04 17:46:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 17:46:27] [logits] Applying loss function for 1 factor(s)
[2023-07-04 17:46:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 17:46:27] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:46:27] Parameter type float32, optimization type float32, casting types false
[2023-07-04 17:47:11] Seen 18,843 samples
[2023-07-04 17:47:11] Starting data epoch 102 in logical epoch 102
[2023-07-04 17:47:11] [data] Shuffling data
[2023-07-04 17:47:11] [data] Done reading 20,192 sentences
[2023-07-04 17:47:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:47:19] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.26708475 * 1,341,254 @ 2,240 after 40,247,594 : Time 56.18s : 23872.91 words/s : gNorm 0.4754
[2023-07-04 17:47:19] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:47:22] Saving Adam parameters
[2023-07-04 17:47:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:48:10] Seen 18,843 samples
[2023-07-04 17:48:10] Starting data epoch 103 in logical epoch 103
[2023-07-04 17:48:10] [data] Shuffling data
[2023-07-04 17:48:10] [data] Done reading 20,192 sentences
[2023-07-04 17:48:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:49:01] Seen 18,843 samples
[2023-07-04 17:49:01] Starting data epoch 104 in logical epoch 104
[2023-07-04 17:49:01] [data] Shuffling data
[2023-07-04 17:49:01] [data] Done reading 20,192 sentences
[2023-07-04 17:49:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:49:50] Seen 18,843 samples
[2023-07-04 17:49:50] Starting data epoch 105 in logical epoch 105
[2023-07-04 17:49:50] [data] Shuffling data
[2023-07-04 17:49:50] [data] Done reading 20,192 sentences
[2023-07-04 17:49:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:50:15] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.22181159 * 1,341,970 @ 1,536 after 41,589,564 : Time 176.03s : 7623.38 words/s : gNorm 0.5130
[2023-07-04 17:50:38] Seen 18,843 samples
[2023-07-04 17:50:38] Starting data epoch 106 in logical epoch 106
[2023-07-04 17:50:38] [data] Shuffling data
[2023-07-04 17:50:38] [data] Done reading 20,192 sentences
[2023-07-04 17:50:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:51:27] Seen 18,843 samples
[2023-07-04 17:51:27] Starting data epoch 107 in logical epoch 107
[2023-07-04 17:51:27] [data] Shuffling data
[2023-07-04 17:51:27] [data] Done reading 20,192 sentences
[2023-07-04 17:51:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:52:16] Seen 18,843 samples
[2023-07-04 17:52:16] Starting data epoch 108 in logical epoch 108
[2023-07-04 17:52:16] [data] Shuffling data
[2023-07-04 17:52:16] [data] Done reading 20,192 sentences
[2023-07-04 17:52:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:52:58] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.18100438 * 1,331,544 @ 948 after 42,921,108 : Time 163.65s : 8136.34 words/s : gNorm 0.4819
[2023-07-04 17:53:05] Seen 18,843 samples
[2023-07-04 17:53:05] Starting data epoch 109 in logical epoch 109
[2023-07-04 17:53:05] [data] Shuffling data
[2023-07-04 17:53:05] [data] Done reading 20,192 sentences
[2023-07-04 17:53:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:53:56] Seen 18,843 samples
[2023-07-04 17:53:56] Starting data epoch 110 in logical epoch 110
[2023-07-04 17:53:56] [data] Shuffling data
[2023-07-04 17:53:56] [data] Done reading 20,192 sentences
[2023-07-04 17:53:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:54:46] Seen 18,843 samples
[2023-07-04 17:54:46] Starting data epoch 111 in logical epoch 111
[2023-07-04 17:54:46] Training finished
[2023-07-04 17:54:52] [valid] Ep. 111 : Up. 32628 : cross-entropy : 202.458 : stalled 10 times (last best: 108.419)
[2023-07-04 17:57:00] [valid] Ep. 111 : Up. 32628 : translation : 0 : new best
[2023-07-04 17:57:00] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:04] Saving Adam parameters
[2023-07-04 17:57:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:57:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:19] [marian] Running on node07.datos.cluster.uy as process 37378 with command line:
[2023-07-04 17:57:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:57:19] [config] after: 0e
[2023-07-04 17:57:19] [config] after-batches: 0
[2023-07-04 17:57:19] [config] after-epochs: 120
[2023-07-04 17:57:19] [config] all-caps-every: 0
[2023-07-04 17:57:19] [config] allow-unk: false
[2023-07-04 17:57:19] [config] authors: false
[2023-07-04 17:57:19] [config] beam-size: 12
[2023-07-04 17:57:19] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:57:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:57:19] [config] bert-masking-fraction: 0.15
[2023-07-04 17:57:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:57:19] [config] bert-train-type-embeddings: true
[2023-07-04 17:57:19] [config] bert-type-vocab-size: 2
[2023-07-04 17:57:19] [config] build-info: ""
[2023-07-04 17:57:19] [config] check-gradient-nan: false
[2023-07-04 17:57:19] [config] check-nan: false
[2023-07-04 17:57:19] [config] cite: false
[2023-07-04 17:57:19] [config] clip-norm: 1
[2023-07-04 17:57:19] [config] cost-scaling:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] cost-type: ce-sum
[2023-07-04 17:57:19] [config] cpu-threads: 0
[2023-07-04 17:57:19] [config] data-threads: 8
[2023-07-04 17:57:19] [config] data-weighting: ""
[2023-07-04 17:57:19] [config] data-weighting-type: sentence
[2023-07-04 17:57:19] [config] dec-cell: gru
[2023-07-04 17:57:19] [config] dec-cell-base-depth: 2
[2023-07-04 17:57:19] [config] dec-cell-high-depth: 1
[2023-07-04 17:57:19] [config] dec-depth: 1
[2023-07-04 17:57:19] [config] devices:
[2023-07-04 17:57:19] [config]   - 0
[2023-07-04 17:57:19] [config] dim-emb: 512
[2023-07-04 17:57:19] [config] dim-rnn: 1024
[2023-07-04 17:57:19] [config] dim-vocabs:
[2023-07-04 17:57:19] [config]   - 54042
[2023-07-04 17:57:19] [config]   - 36507
[2023-07-04 17:57:19] [config] disp-first: 0
[2023-07-04 17:57:19] [config] disp-freq: 1000u
[2023-07-04 17:57:19] [config] disp-label-counts: true
[2023-07-04 17:57:19] [config] dropout-rnn: 0
[2023-07-04 17:57:19] [config] dropout-src: 0
[2023-07-04 17:57:19] [config] dropout-trg: 0
[2023-07-04 17:57:19] [config] dump-config: ""
[2023-07-04 17:57:19] [config] dynamic-gradient-scaling:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] early-stopping: 10
[2023-07-04 17:57:19] [config] early-stopping-on: first
[2023-07-04 17:57:19] [config] embedding-fix-src: false
[2023-07-04 17:57:19] [config] embedding-fix-trg: false
[2023-07-04 17:57:19] [config] embedding-normalization: false
[2023-07-04 17:57:19] [config] embedding-vectors:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] enc-cell: gru
[2023-07-04 17:57:19] [config] enc-cell-depth: 1
[2023-07-04 17:57:19] [config] enc-depth: 1
[2023-07-04 17:57:19] [config] enc-type: bidirectional
[2023-07-04 17:57:19] [config] english-title-case-every: 0
[2023-07-04 17:57:19] [config] exponential-smoothing: 0
[2023-07-04 17:57:19] [config] factor-weight: 1
[2023-07-04 17:57:19] [config] factors-combine: sum
[2023-07-04 17:57:19] [config] factors-dim-emb: 0
[2023-07-04 17:57:19] [config] gradient-checkpointing: false
[2023-07-04 17:57:19] [config] gradient-norm-average-window: 100
[2023-07-04 17:57:19] [config] guided-alignment: none
[2023-07-04 17:57:19] [config] guided-alignment-cost: mse
[2023-07-04 17:57:19] [config] guided-alignment-weight: 0.1
[2023-07-04 17:57:19] [config] ignore-model-config: false
[2023-07-04 17:57:19] [config] input-types:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] interpolate-env-vars: false
[2023-07-04 17:57:19] [config] keep-best: false
[2023-07-04 17:57:19] [config] label-smoothing: 0
[2023-07-04 17:57:19] [config] layer-normalization: false
[2023-07-04 17:57:19] [config] learn-rate: 0.0001
[2023-07-04 17:57:19] [config] lemma-dependency: ""
[2023-07-04 17:57:19] [config] lemma-dim-emb: 0
[2023-07-04 17:57:19] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:57:19] [config] log-level: info
[2023-07-04 17:57:19] [config] log-time-zone: ""
[2023-07-04 17:57:19] [config] logical-epoch:
[2023-07-04 17:57:19] [config]   - 1e
[2023-07-04 17:57:19] [config]   - 0
[2023-07-04 17:57:19] [config] lr-decay: 0
[2023-07-04 17:57:19] [config] lr-decay-freq: 50000
[2023-07-04 17:57:19] [config] lr-decay-inv-sqrt:
[2023-07-04 17:57:19] [config]   - 0
[2023-07-04 17:57:19] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:57:19] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:57:19] [config] lr-decay-start:
[2023-07-04 17:57:19] [config]   - 10
[2023-07-04 17:57:19] [config]   - 1
[2023-07-04 17:57:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:57:19] [config] lr-report: false
[2023-07-04 17:57:19] [config] lr-warmup: 0
[2023-07-04 17:57:19] [config] lr-warmup-at-reload: false
[2023-07-04 17:57:19] [config] lr-warmup-cycle: false
[2023-07-04 17:57:19] [config] lr-warmup-start-rate: 0
[2023-07-04 17:57:19] [config] max-length: 50
[2023-07-04 17:57:19] [config] max-length-crop: false
[2023-07-04 17:57:19] [config] max-length-factor: 3
[2023-07-04 17:57:19] [config] maxi-batch: 100
[2023-07-04 17:57:19] [config] maxi-batch-sort: trg
[2023-07-04 17:57:19] [config] mini-batch: 64
[2023-07-04 17:57:19] [config] mini-batch-fit: false
[2023-07-04 17:57:19] [config] mini-batch-fit-step: 10
[2023-07-04 17:57:19] [config] mini-batch-round-up: true
[2023-07-04 17:57:19] [config] mini-batch-track-lr: false
[2023-07-04 17:57:19] [config] mini-batch-warmup: 0
[2023-07-04 17:57:19] [config] mini-batch-words: 0
[2023-07-04 17:57:19] [config] mini-batch-words-ref: 0
[2023-07-04 17:57:19] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:19] [config] multi-loss-type: sum
[2023-07-04 17:57:19] [config] n-best: false
[2023-07-04 17:57:19] [config] no-nccl: false
[2023-07-04 17:57:19] [config] no-reload: false
[2023-07-04 17:57:19] [config] no-restore-corpus: false
[2023-07-04 17:57:19] [config] normalize: 0
[2023-07-04 17:57:19] [config] normalize-gradient: false
[2023-07-04 17:57:19] [config] num-devices: 0
[2023-07-04 17:57:19] [config] optimizer: adam
[2023-07-04 17:57:19] [config] optimizer-delay: 1
[2023-07-04 17:57:19] [config] optimizer-params:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] output-omit-bias: false
[2023-07-04 17:57:19] [config] overwrite: true
[2023-07-04 17:57:19] [config] precision:
[2023-07-04 17:57:19] [config]   - float32
[2023-07-04 17:57:19] [config]   - float32
[2023-07-04 17:57:19] [config] pretrained-model: ""
[2023-07-04 17:57:19] [config] quantize-biases: false
[2023-07-04 17:57:19] [config] quantize-bits: 0
[2023-07-04 17:57:19] [config] quantize-log-based: false
[2023-07-04 17:57:19] [config] quantize-optimization-steps: 0
[2023-07-04 17:57:19] [config] quiet: false
[2023-07-04 17:57:19] [config] quiet-translation: true
[2023-07-04 17:57:19] [config] relative-paths: false
[2023-07-04 17:57:19] [config] right-left: false
[2023-07-04 17:57:19] [config] save-freq: 10000u
[2023-07-04 17:57:19] [config] seed: 1234
[2023-07-04 17:57:19] [config] sentencepiece-alphas:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:57:19] [config] sentencepiece-options: ""
[2023-07-04 17:57:19] [config] sharding: global
[2023-07-04 17:57:19] [config] shuffle: data
[2023-07-04 17:57:19] [config] shuffle-in-ram: false
[2023-07-04 17:57:19] [config] sigterm: save-and-exit
[2023-07-04 17:57:19] [config] skip: false
[2023-07-04 17:57:19] [config] sqlite: ""
[2023-07-04 17:57:19] [config] sqlite-drop: false
[2023-07-04 17:57:19] [config] sync-freq: 200u
[2023-07-04 17:57:19] [config] sync-sgd: false
[2023-07-04 17:57:19] [config] tempdir: /tmp
[2023-07-04 17:57:19] [config] tied-embeddings: false
[2023-07-04 17:57:19] [config] tied-embeddings-all: false
[2023-07-04 17:57:19] [config] tied-embeddings-src: false
[2023-07-04 17:57:19] [config] train-embedder-rank:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] train-sets:
[2023-07-04 17:57:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:57:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:57:19] [config] transformer-aan-activation: swish
[2023-07-04 17:57:19] [config] transformer-aan-depth: 2
[2023-07-04 17:57:19] [config] transformer-aan-nogate: false
[2023-07-04 17:57:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:57:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:57:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:57:19] [config] transformer-depth-scaling: false
[2023-07-04 17:57:19] [config] transformer-dim-aan: 2048
[2023-07-04 17:57:19] [config] transformer-dim-ffn: 2048
[2023-07-04 17:57:19] [config] transformer-dropout: 0
[2023-07-04 17:57:19] [config] transformer-dropout-attention: 0
[2023-07-04 17:57:19] [config] transformer-dropout-ffn: 0
[2023-07-04 17:57:19] [config] transformer-ffn-activation: swish
[2023-07-04 17:57:19] [config] transformer-ffn-depth: 2
[2023-07-04 17:57:19] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:57:19] [config] transformer-heads: 8
[2023-07-04 17:57:19] [config] transformer-no-projection: false
[2023-07-04 17:57:19] [config] transformer-pool: false
[2023-07-04 17:57:19] [config] transformer-postprocess: dan
[2023-07-04 17:57:19] [config] transformer-postprocess-emb: d
[2023-07-04 17:57:19] [config] transformer-postprocess-top: ""
[2023-07-04 17:57:19] [config] transformer-preprocess: ""
[2023-07-04 17:57:19] [config] transformer-tied-layers:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] transformer-train-position-embeddings: false
[2023-07-04 17:57:19] [config] tsv: false
[2023-07-04 17:57:19] [config] tsv-fields: 0
[2023-07-04 17:57:19] [config] type: amun
[2023-07-04 17:57:19] [config] ulr: false
[2023-07-04 17:57:19] [config] ulr-dim-emb: 0
[2023-07-04 17:57:19] [config] ulr-dropout: 0
[2023-07-04 17:57:19] [config] ulr-keys-vectors: ""
[2023-07-04 17:57:19] [config] ulr-query-vectors: ""
[2023-07-04 17:57:19] [config] ulr-softmax-temperature: 1
[2023-07-04 17:57:19] [config] ulr-trainable-transformation: false
[2023-07-04 17:57:19] [config] unlikelihood-loss: false
[2023-07-04 17:57:19] [config] valid-freq: 50000000
[2023-07-04 17:57:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:57:19] [config] valid-max-length: 1000
[2023-07-04 17:57:19] [config] valid-metrics:
[2023-07-04 17:57:19] [config]   - cross-entropy
[2023-07-04 17:57:19] [config]   - translation
[2023-07-04 17:57:19] [config] valid-mini-batch: 32
[2023-07-04 17:57:19] [config] valid-reset-stalled: false
[2023-07-04 17:57:19] [config] valid-script-args:
[2023-07-04 17:57:19] [config]   []
[2023-07-04 17:57:19] [config] valid-script-path: ""
[2023-07-04 17:57:19] [config] valid-sets:
[2023-07-04 17:57:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:57:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:57:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:57:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:19] [config] vocabs:
[2023-07-04 17:57:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:19] [config] word-penalty: 0
[2023-07-04 17:57:19] [config] word-scores: false
[2023-07-04 17:57:19] [config] workspace: 2048
[2023-07-04 17:57:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:19] [training] Using single-device training
[2023-07-04 17:57:19] Synced seed 1234
[2023-07-04 17:57:19] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:19] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:57:19] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:19] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:57:19] [valid] No post-processing script given for validating translator
[2023-07-04 17:57:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:20] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:57:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:57:20] [comm] Using global sharding
[2023-07-04 17:57:20] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:57:20] [training] Using 1 GPUs
[2023-07-04 17:57:20] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:23] Loading Adam parameters
[2023-07-04 17:57:23] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:57:23] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:57:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:57:23] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:57:23] [data] Shuffling data
[2023-07-04 17:57:23] [data] Done reading 20,192 sentences
[2023-07-04 17:57:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:57:23] Training started
[2023-07-04 17:57:23] Training finished
[2023-07-04 17:57:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:27] [marian] Running on node07.datos.cluster.uy as process 37428 with command line:
[2023-07-04 17:57:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:57:27] [config] after: 0e
[2023-07-04 17:57:27] [config] after-batches: 0
[2023-07-04 17:57:27] [config] after-epochs: 130
[2023-07-04 17:57:27] [config] all-caps-every: 0
[2023-07-04 17:57:27] [config] allow-unk: false
[2023-07-04 17:57:27] [config] authors: false
[2023-07-04 17:57:27] [config] beam-size: 12
[2023-07-04 17:57:27] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:57:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:57:27] [config] bert-masking-fraction: 0.15
[2023-07-04 17:57:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:57:27] [config] bert-train-type-embeddings: true
[2023-07-04 17:57:27] [config] bert-type-vocab-size: 2
[2023-07-04 17:57:27] [config] build-info: ""
[2023-07-04 17:57:27] [config] check-gradient-nan: false
[2023-07-04 17:57:27] [config] check-nan: false
[2023-07-04 17:57:27] [config] cite: false
[2023-07-04 17:57:27] [config] clip-norm: 1
[2023-07-04 17:57:27] [config] cost-scaling:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] cost-type: ce-sum
[2023-07-04 17:57:27] [config] cpu-threads: 0
[2023-07-04 17:57:27] [config] data-threads: 8
[2023-07-04 17:57:27] [config] data-weighting: ""
[2023-07-04 17:57:27] [config] data-weighting-type: sentence
[2023-07-04 17:57:27] [config] dec-cell: gru
[2023-07-04 17:57:27] [config] dec-cell-base-depth: 2
[2023-07-04 17:57:27] [config] dec-cell-high-depth: 1
[2023-07-04 17:57:27] [config] dec-depth: 1
[2023-07-04 17:57:27] [config] devices:
[2023-07-04 17:57:27] [config]   - 0
[2023-07-04 17:57:27] [config] dim-emb: 512
[2023-07-04 17:57:27] [config] dim-rnn: 1024
[2023-07-04 17:57:27] [config] dim-vocabs:
[2023-07-04 17:57:27] [config]   - 54042
[2023-07-04 17:57:27] [config]   - 36507
[2023-07-04 17:57:27] [config] disp-first: 0
[2023-07-04 17:57:27] [config] disp-freq: 1000u
[2023-07-04 17:57:27] [config] disp-label-counts: true
[2023-07-04 17:57:27] [config] dropout-rnn: 0
[2023-07-04 17:57:27] [config] dropout-src: 0
[2023-07-04 17:57:27] [config] dropout-trg: 0
[2023-07-04 17:57:27] [config] dump-config: ""
[2023-07-04 17:57:27] [config] dynamic-gradient-scaling:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] early-stopping: 10
[2023-07-04 17:57:27] [config] early-stopping-on: first
[2023-07-04 17:57:27] [config] embedding-fix-src: false
[2023-07-04 17:57:27] [config] embedding-fix-trg: false
[2023-07-04 17:57:27] [config] embedding-normalization: false
[2023-07-04 17:57:27] [config] embedding-vectors:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] enc-cell: gru
[2023-07-04 17:57:27] [config] enc-cell-depth: 1
[2023-07-04 17:57:27] [config] enc-depth: 1
[2023-07-04 17:57:27] [config] enc-type: bidirectional
[2023-07-04 17:57:27] [config] english-title-case-every: 0
[2023-07-04 17:57:27] [config] exponential-smoothing: 0
[2023-07-04 17:57:27] [config] factor-weight: 1
[2023-07-04 17:57:27] [config] factors-combine: sum
[2023-07-04 17:57:27] [config] factors-dim-emb: 0
[2023-07-04 17:57:27] [config] gradient-checkpointing: false
[2023-07-04 17:57:27] [config] gradient-norm-average-window: 100
[2023-07-04 17:57:27] [config] guided-alignment: none
[2023-07-04 17:57:27] [config] guided-alignment-cost: mse
[2023-07-04 17:57:27] [config] guided-alignment-weight: 0.1
[2023-07-04 17:57:27] [config] ignore-model-config: false
[2023-07-04 17:57:27] [config] input-types:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] interpolate-env-vars: false
[2023-07-04 17:57:27] [config] keep-best: false
[2023-07-04 17:57:27] [config] label-smoothing: 0
[2023-07-04 17:57:27] [config] layer-normalization: false
[2023-07-04 17:57:27] [config] learn-rate: 0.0001
[2023-07-04 17:57:27] [config] lemma-dependency: ""
[2023-07-04 17:57:27] [config] lemma-dim-emb: 0
[2023-07-04 17:57:27] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:57:27] [config] log-level: info
[2023-07-04 17:57:27] [config] log-time-zone: ""
[2023-07-04 17:57:27] [config] logical-epoch:
[2023-07-04 17:57:27] [config]   - 1e
[2023-07-04 17:57:27] [config]   - 0
[2023-07-04 17:57:27] [config] lr-decay: 0
[2023-07-04 17:57:27] [config] lr-decay-freq: 50000
[2023-07-04 17:57:27] [config] lr-decay-inv-sqrt:
[2023-07-04 17:57:27] [config]   - 0
[2023-07-04 17:57:27] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:57:27] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:57:27] [config] lr-decay-start:
[2023-07-04 17:57:27] [config]   - 10
[2023-07-04 17:57:27] [config]   - 1
[2023-07-04 17:57:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:57:27] [config] lr-report: false
[2023-07-04 17:57:27] [config] lr-warmup: 0
[2023-07-04 17:57:27] [config] lr-warmup-at-reload: false
[2023-07-04 17:57:27] [config] lr-warmup-cycle: false
[2023-07-04 17:57:27] [config] lr-warmup-start-rate: 0
[2023-07-04 17:57:27] [config] max-length: 50
[2023-07-04 17:57:27] [config] max-length-crop: false
[2023-07-04 17:57:27] [config] max-length-factor: 3
[2023-07-04 17:57:27] [config] maxi-batch: 100
[2023-07-04 17:57:27] [config] maxi-batch-sort: trg
[2023-07-04 17:57:27] [config] mini-batch: 64
[2023-07-04 17:57:27] [config] mini-batch-fit: false
[2023-07-04 17:57:27] [config] mini-batch-fit-step: 10
[2023-07-04 17:57:27] [config] mini-batch-round-up: true
[2023-07-04 17:57:27] [config] mini-batch-track-lr: false
[2023-07-04 17:57:27] [config] mini-batch-warmup: 0
[2023-07-04 17:57:27] [config] mini-batch-words: 0
[2023-07-04 17:57:27] [config] mini-batch-words-ref: 0
[2023-07-04 17:57:27] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:27] [config] multi-loss-type: sum
[2023-07-04 17:57:27] [config] n-best: false
[2023-07-04 17:57:27] [config] no-nccl: false
[2023-07-04 17:57:27] [config] no-reload: false
[2023-07-04 17:57:27] [config] no-restore-corpus: false
[2023-07-04 17:57:27] [config] normalize: 0
[2023-07-04 17:57:27] [config] normalize-gradient: false
[2023-07-04 17:57:27] [config] num-devices: 0
[2023-07-04 17:57:27] [config] optimizer: adam
[2023-07-04 17:57:27] [config] optimizer-delay: 1
[2023-07-04 17:57:27] [config] optimizer-params:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] output-omit-bias: false
[2023-07-04 17:57:27] [config] overwrite: true
[2023-07-04 17:57:27] [config] precision:
[2023-07-04 17:57:27] [config]   - float32
[2023-07-04 17:57:27] [config]   - float32
[2023-07-04 17:57:27] [config] pretrained-model: ""
[2023-07-04 17:57:27] [config] quantize-biases: false
[2023-07-04 17:57:27] [config] quantize-bits: 0
[2023-07-04 17:57:27] [config] quantize-log-based: false
[2023-07-04 17:57:27] [config] quantize-optimization-steps: 0
[2023-07-04 17:57:27] [config] quiet: false
[2023-07-04 17:57:27] [config] quiet-translation: true
[2023-07-04 17:57:27] [config] relative-paths: false
[2023-07-04 17:57:27] [config] right-left: false
[2023-07-04 17:57:27] [config] save-freq: 10000u
[2023-07-04 17:57:27] [config] seed: 1234
[2023-07-04 17:57:27] [config] sentencepiece-alphas:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:57:27] [config] sentencepiece-options: ""
[2023-07-04 17:57:27] [config] sharding: global
[2023-07-04 17:57:27] [config] shuffle: data
[2023-07-04 17:57:27] [config] shuffle-in-ram: false
[2023-07-04 17:57:27] [config] sigterm: save-and-exit
[2023-07-04 17:57:27] [config] skip: false
[2023-07-04 17:57:27] [config] sqlite: ""
[2023-07-04 17:57:27] [config] sqlite-drop: false
[2023-07-04 17:57:27] [config] sync-freq: 200u
[2023-07-04 17:57:27] [config] sync-sgd: false
[2023-07-04 17:57:27] [config] tempdir: /tmp
[2023-07-04 17:57:27] [config] tied-embeddings: false
[2023-07-04 17:57:27] [config] tied-embeddings-all: false
[2023-07-04 17:57:27] [config] tied-embeddings-src: false
[2023-07-04 17:57:27] [config] train-embedder-rank:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] train-sets:
[2023-07-04 17:57:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:57:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:57:27] [config] transformer-aan-activation: swish
[2023-07-04 17:57:27] [config] transformer-aan-depth: 2
[2023-07-04 17:57:27] [config] transformer-aan-nogate: false
[2023-07-04 17:57:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:57:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:57:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:57:27] [config] transformer-depth-scaling: false
[2023-07-04 17:57:27] [config] transformer-dim-aan: 2048
[2023-07-04 17:57:27] [config] transformer-dim-ffn: 2048
[2023-07-04 17:57:27] [config] transformer-dropout: 0
[2023-07-04 17:57:27] [config] transformer-dropout-attention: 0
[2023-07-04 17:57:27] [config] transformer-dropout-ffn: 0
[2023-07-04 17:57:27] [config] transformer-ffn-activation: swish
[2023-07-04 17:57:27] [config] transformer-ffn-depth: 2
[2023-07-04 17:57:27] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:57:27] [config] transformer-heads: 8
[2023-07-04 17:57:27] [config] transformer-no-projection: false
[2023-07-04 17:57:27] [config] transformer-pool: false
[2023-07-04 17:57:27] [config] transformer-postprocess: dan
[2023-07-04 17:57:27] [config] transformer-postprocess-emb: d
[2023-07-04 17:57:27] [config] transformer-postprocess-top: ""
[2023-07-04 17:57:27] [config] transformer-preprocess: ""
[2023-07-04 17:57:27] [config] transformer-tied-layers:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] transformer-train-position-embeddings: false
[2023-07-04 17:57:27] [config] tsv: false
[2023-07-04 17:57:27] [config] tsv-fields: 0
[2023-07-04 17:57:27] [config] type: amun
[2023-07-04 17:57:27] [config] ulr: false
[2023-07-04 17:57:27] [config] ulr-dim-emb: 0
[2023-07-04 17:57:27] [config] ulr-dropout: 0
[2023-07-04 17:57:27] [config] ulr-keys-vectors: ""
[2023-07-04 17:57:27] [config] ulr-query-vectors: ""
[2023-07-04 17:57:27] [config] ulr-softmax-temperature: 1
[2023-07-04 17:57:27] [config] ulr-trainable-transformation: false
[2023-07-04 17:57:27] [config] unlikelihood-loss: false
[2023-07-04 17:57:27] [config] valid-freq: 50000000
[2023-07-04 17:57:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:57:27] [config] valid-max-length: 1000
[2023-07-04 17:57:27] [config] valid-metrics:
[2023-07-04 17:57:27] [config]   - cross-entropy
[2023-07-04 17:57:27] [config]   - translation
[2023-07-04 17:57:27] [config] valid-mini-batch: 32
[2023-07-04 17:57:27] [config] valid-reset-stalled: false
[2023-07-04 17:57:27] [config] valid-script-args:
[2023-07-04 17:57:27] [config]   []
[2023-07-04 17:57:27] [config] valid-script-path: ""
[2023-07-04 17:57:27] [config] valid-sets:
[2023-07-04 17:57:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:57:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:57:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:57:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:27] [config] vocabs:
[2023-07-04 17:57:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:27] [config] word-penalty: 0
[2023-07-04 17:57:27] [config] word-scores: false
[2023-07-04 17:57:27] [config] workspace: 2048
[2023-07-04 17:57:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:27] [training] Using single-device training
[2023-07-04 17:57:28] Synced seed 1234
[2023-07-04 17:57:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:28] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:57:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:28] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:57:28] [valid] No post-processing script given for validating translator
[2023-07-04 17:57:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:29] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:57:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:57:29] [comm] Using global sharding
[2023-07-04 17:57:29] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:57:29] [training] Using 1 GPUs
[2023-07-04 17:57:29] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:30] Loading Adam parameters
[2023-07-04 17:57:31] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:57:31] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:57:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:57:31] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:57:31] [data] Shuffling data
[2023-07-04 17:57:31] [data] Done reading 20,192 sentences
[2023-07-04 17:57:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:57:31] Training started
[2023-07-04 17:57:31] Training finished
[2023-07-04 17:57:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:35] [marian] Running on node07.datos.cluster.uy as process 37478 with command line:
[2023-07-04 17:57:35] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:57:35] [config] after: 0e
[2023-07-04 17:57:35] [config] after-batches: 0
[2023-07-04 17:57:35] [config] after-epochs: 140
[2023-07-04 17:57:35] [config] all-caps-every: 0
[2023-07-04 17:57:35] [config] allow-unk: false
[2023-07-04 17:57:35] [config] authors: false
[2023-07-04 17:57:35] [config] beam-size: 12
[2023-07-04 17:57:35] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:57:35] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:57:35] [config] bert-masking-fraction: 0.15
[2023-07-04 17:57:35] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:57:35] [config] bert-train-type-embeddings: true
[2023-07-04 17:57:35] [config] bert-type-vocab-size: 2
[2023-07-04 17:57:35] [config] build-info: ""
[2023-07-04 17:57:35] [config] check-gradient-nan: false
[2023-07-04 17:57:35] [config] check-nan: false
[2023-07-04 17:57:35] [config] cite: false
[2023-07-04 17:57:35] [config] clip-norm: 1
[2023-07-04 17:57:35] [config] cost-scaling:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] cost-type: ce-sum
[2023-07-04 17:57:35] [config] cpu-threads: 0
[2023-07-04 17:57:35] [config] data-threads: 8
[2023-07-04 17:57:35] [config] data-weighting: ""
[2023-07-04 17:57:35] [config] data-weighting-type: sentence
[2023-07-04 17:57:35] [config] dec-cell: gru
[2023-07-04 17:57:35] [config] dec-cell-base-depth: 2
[2023-07-04 17:57:35] [config] dec-cell-high-depth: 1
[2023-07-04 17:57:35] [config] dec-depth: 1
[2023-07-04 17:57:35] [config] devices:
[2023-07-04 17:57:35] [config]   - 0
[2023-07-04 17:57:35] [config] dim-emb: 512
[2023-07-04 17:57:35] [config] dim-rnn: 1024
[2023-07-04 17:57:35] [config] dim-vocabs:
[2023-07-04 17:57:35] [config]   - 54042
[2023-07-04 17:57:35] [config]   - 36507
[2023-07-04 17:57:35] [config] disp-first: 0
[2023-07-04 17:57:35] [config] disp-freq: 1000u
[2023-07-04 17:57:35] [config] disp-label-counts: true
[2023-07-04 17:57:35] [config] dropout-rnn: 0
[2023-07-04 17:57:35] [config] dropout-src: 0
[2023-07-04 17:57:35] [config] dropout-trg: 0
[2023-07-04 17:57:35] [config] dump-config: ""
[2023-07-04 17:57:35] [config] dynamic-gradient-scaling:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] early-stopping: 10
[2023-07-04 17:57:35] [config] early-stopping-on: first
[2023-07-04 17:57:35] [config] embedding-fix-src: false
[2023-07-04 17:57:35] [config] embedding-fix-trg: false
[2023-07-04 17:57:35] [config] embedding-normalization: false
[2023-07-04 17:57:35] [config] embedding-vectors:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] enc-cell: gru
[2023-07-04 17:57:35] [config] enc-cell-depth: 1
[2023-07-04 17:57:35] [config] enc-depth: 1
[2023-07-04 17:57:35] [config] enc-type: bidirectional
[2023-07-04 17:57:35] [config] english-title-case-every: 0
[2023-07-04 17:57:35] [config] exponential-smoothing: 0
[2023-07-04 17:57:35] [config] factor-weight: 1
[2023-07-04 17:57:35] [config] factors-combine: sum
[2023-07-04 17:57:35] [config] factors-dim-emb: 0
[2023-07-04 17:57:35] [config] gradient-checkpointing: false
[2023-07-04 17:57:35] [config] gradient-norm-average-window: 100
[2023-07-04 17:57:35] [config] guided-alignment: none
[2023-07-04 17:57:35] [config] guided-alignment-cost: mse
[2023-07-04 17:57:35] [config] guided-alignment-weight: 0.1
[2023-07-04 17:57:35] [config] ignore-model-config: false
[2023-07-04 17:57:35] [config] input-types:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] interpolate-env-vars: false
[2023-07-04 17:57:35] [config] keep-best: false
[2023-07-04 17:57:35] [config] label-smoothing: 0
[2023-07-04 17:57:35] [config] layer-normalization: false
[2023-07-04 17:57:35] [config] learn-rate: 0.0001
[2023-07-04 17:57:35] [config] lemma-dependency: ""
[2023-07-04 17:57:35] [config] lemma-dim-emb: 0
[2023-07-04 17:57:35] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:57:35] [config] log-level: info
[2023-07-04 17:57:35] [config] log-time-zone: ""
[2023-07-04 17:57:35] [config] logical-epoch:
[2023-07-04 17:57:35] [config]   - 1e
[2023-07-04 17:57:35] [config]   - 0
[2023-07-04 17:57:35] [config] lr-decay: 0
[2023-07-04 17:57:35] [config] lr-decay-freq: 50000
[2023-07-04 17:57:35] [config] lr-decay-inv-sqrt:
[2023-07-04 17:57:35] [config]   - 0
[2023-07-04 17:57:35] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:57:35] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:57:35] [config] lr-decay-start:
[2023-07-04 17:57:35] [config]   - 10
[2023-07-04 17:57:35] [config]   - 1
[2023-07-04 17:57:35] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:57:35] [config] lr-report: false
[2023-07-04 17:57:35] [config] lr-warmup: 0
[2023-07-04 17:57:35] [config] lr-warmup-at-reload: false
[2023-07-04 17:57:35] [config] lr-warmup-cycle: false
[2023-07-04 17:57:35] [config] lr-warmup-start-rate: 0
[2023-07-04 17:57:35] [config] max-length: 50
[2023-07-04 17:57:35] [config] max-length-crop: false
[2023-07-04 17:57:35] [config] max-length-factor: 3
[2023-07-04 17:57:35] [config] maxi-batch: 100
[2023-07-04 17:57:35] [config] maxi-batch-sort: trg
[2023-07-04 17:57:35] [config] mini-batch: 64
[2023-07-04 17:57:35] [config] mini-batch-fit: false
[2023-07-04 17:57:35] [config] mini-batch-fit-step: 10
[2023-07-04 17:57:35] [config] mini-batch-round-up: true
[2023-07-04 17:57:35] [config] mini-batch-track-lr: false
[2023-07-04 17:57:35] [config] mini-batch-warmup: 0
[2023-07-04 17:57:35] [config] mini-batch-words: 0
[2023-07-04 17:57:35] [config] mini-batch-words-ref: 0
[2023-07-04 17:57:35] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:35] [config] multi-loss-type: sum
[2023-07-04 17:57:35] [config] n-best: false
[2023-07-04 17:57:35] [config] no-nccl: false
[2023-07-04 17:57:35] [config] no-reload: false
[2023-07-04 17:57:35] [config] no-restore-corpus: false
[2023-07-04 17:57:35] [config] normalize: 0
[2023-07-04 17:57:35] [config] normalize-gradient: false
[2023-07-04 17:57:35] [config] num-devices: 0
[2023-07-04 17:57:35] [config] optimizer: adam
[2023-07-04 17:57:35] [config] optimizer-delay: 1
[2023-07-04 17:57:35] [config] optimizer-params:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] output-omit-bias: false
[2023-07-04 17:57:35] [config] overwrite: true
[2023-07-04 17:57:35] [config] precision:
[2023-07-04 17:57:35] [config]   - float32
[2023-07-04 17:57:35] [config]   - float32
[2023-07-04 17:57:35] [config] pretrained-model: ""
[2023-07-04 17:57:35] [config] quantize-biases: false
[2023-07-04 17:57:35] [config] quantize-bits: 0
[2023-07-04 17:57:35] [config] quantize-log-based: false
[2023-07-04 17:57:35] [config] quantize-optimization-steps: 0
[2023-07-04 17:57:35] [config] quiet: false
[2023-07-04 17:57:35] [config] quiet-translation: true
[2023-07-04 17:57:35] [config] relative-paths: false
[2023-07-04 17:57:35] [config] right-left: false
[2023-07-04 17:57:35] [config] save-freq: 10000u
[2023-07-04 17:57:35] [config] seed: 1234
[2023-07-04 17:57:35] [config] sentencepiece-alphas:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:57:35] [config] sentencepiece-options: ""
[2023-07-04 17:57:35] [config] sharding: global
[2023-07-04 17:57:35] [config] shuffle: data
[2023-07-04 17:57:35] [config] shuffle-in-ram: false
[2023-07-04 17:57:35] [config] sigterm: save-and-exit
[2023-07-04 17:57:35] [config] skip: false
[2023-07-04 17:57:35] [config] sqlite: ""
[2023-07-04 17:57:35] [config] sqlite-drop: false
[2023-07-04 17:57:35] [config] sync-freq: 200u
[2023-07-04 17:57:35] [config] sync-sgd: false
[2023-07-04 17:57:35] [config] tempdir: /tmp
[2023-07-04 17:57:35] [config] tied-embeddings: false
[2023-07-04 17:57:35] [config] tied-embeddings-all: false
[2023-07-04 17:57:35] [config] tied-embeddings-src: false
[2023-07-04 17:57:35] [config] train-embedder-rank:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] train-sets:
[2023-07-04 17:57:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:57:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:57:35] [config] transformer-aan-activation: swish
[2023-07-04 17:57:35] [config] transformer-aan-depth: 2
[2023-07-04 17:57:35] [config] transformer-aan-nogate: false
[2023-07-04 17:57:35] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:57:35] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:57:35] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:57:35] [config] transformer-depth-scaling: false
[2023-07-04 17:57:35] [config] transformer-dim-aan: 2048
[2023-07-04 17:57:35] [config] transformer-dim-ffn: 2048
[2023-07-04 17:57:35] [config] transformer-dropout: 0
[2023-07-04 17:57:35] [config] transformer-dropout-attention: 0
[2023-07-04 17:57:35] [config] transformer-dropout-ffn: 0
[2023-07-04 17:57:35] [config] transformer-ffn-activation: swish
[2023-07-04 17:57:35] [config] transformer-ffn-depth: 2
[2023-07-04 17:57:35] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:57:35] [config] transformer-heads: 8
[2023-07-04 17:57:35] [config] transformer-no-projection: false
[2023-07-04 17:57:35] [config] transformer-pool: false
[2023-07-04 17:57:35] [config] transformer-postprocess: dan
[2023-07-04 17:57:35] [config] transformer-postprocess-emb: d
[2023-07-04 17:57:35] [config] transformer-postprocess-top: ""
[2023-07-04 17:57:35] [config] transformer-preprocess: ""
[2023-07-04 17:57:35] [config] transformer-tied-layers:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] transformer-train-position-embeddings: false
[2023-07-04 17:57:35] [config] tsv: false
[2023-07-04 17:57:35] [config] tsv-fields: 0
[2023-07-04 17:57:35] [config] type: amun
[2023-07-04 17:57:35] [config] ulr: false
[2023-07-04 17:57:35] [config] ulr-dim-emb: 0
[2023-07-04 17:57:35] [config] ulr-dropout: 0
[2023-07-04 17:57:35] [config] ulr-keys-vectors: ""
[2023-07-04 17:57:35] [config] ulr-query-vectors: ""
[2023-07-04 17:57:35] [config] ulr-softmax-temperature: 1
[2023-07-04 17:57:35] [config] ulr-trainable-transformation: false
[2023-07-04 17:57:35] [config] unlikelihood-loss: false
[2023-07-04 17:57:35] [config] valid-freq: 50000000
[2023-07-04 17:57:35] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:57:35] [config] valid-max-length: 1000
[2023-07-04 17:57:35] [config] valid-metrics:
[2023-07-04 17:57:35] [config]   - cross-entropy
[2023-07-04 17:57:35] [config]   - translation
[2023-07-04 17:57:35] [config] valid-mini-batch: 32
[2023-07-04 17:57:35] [config] valid-reset-stalled: false
[2023-07-04 17:57:35] [config] valid-script-args:
[2023-07-04 17:57:35] [config]   []
[2023-07-04 17:57:35] [config] valid-script-path: ""
[2023-07-04 17:57:35] [config] valid-sets:
[2023-07-04 17:57:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:57:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:57:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:57:35] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:35] [config] vocabs:
[2023-07-04 17:57:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:35] [config] word-penalty: 0
[2023-07-04 17:57:35] [config] word-scores: false
[2023-07-04 17:57:35] [config] workspace: 2048
[2023-07-04 17:57:35] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:35] [training] Using single-device training
[2023-07-04 17:57:35] Synced seed 1234
[2023-07-04 17:57:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:36] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:57:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:36] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:57:36] [valid] No post-processing script given for validating translator
[2023-07-04 17:57:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:36] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:57:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:57:37] [comm] Using global sharding
[2023-07-04 17:57:37] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:57:37] [training] Using 1 GPUs
[2023-07-04 17:57:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:38] Loading Adam parameters
[2023-07-04 17:57:39] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:57:39] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:57:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:57:39] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:57:39] [data] Shuffling data
[2023-07-04 17:57:39] [data] Done reading 20,192 sentences
[2023-07-04 17:57:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:57:39] Training started
[2023-07-04 17:57:39] Training finished
[2023-07-04 17:57:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:43] [marian] Running on node07.datos.cluster.uy as process 37527 with command line:
[2023-07-04 17:57:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:57:43] [config] after: 0e
[2023-07-04 17:57:43] [config] after-batches: 0
[2023-07-04 17:57:43] [config] after-epochs: 150
[2023-07-04 17:57:43] [config] all-caps-every: 0
[2023-07-04 17:57:43] [config] allow-unk: false
[2023-07-04 17:57:43] [config] authors: false
[2023-07-04 17:57:43] [config] beam-size: 12
[2023-07-04 17:57:43] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:57:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:57:43] [config] bert-masking-fraction: 0.15
[2023-07-04 17:57:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:57:43] [config] bert-train-type-embeddings: true
[2023-07-04 17:57:43] [config] bert-type-vocab-size: 2
[2023-07-04 17:57:43] [config] build-info: ""
[2023-07-04 17:57:43] [config] check-gradient-nan: false
[2023-07-04 17:57:43] [config] check-nan: false
[2023-07-04 17:57:43] [config] cite: false
[2023-07-04 17:57:43] [config] clip-norm: 1
[2023-07-04 17:57:43] [config] cost-scaling:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] cost-type: ce-sum
[2023-07-04 17:57:43] [config] cpu-threads: 0
[2023-07-04 17:57:43] [config] data-threads: 8
[2023-07-04 17:57:43] [config] data-weighting: ""
[2023-07-04 17:57:43] [config] data-weighting-type: sentence
[2023-07-04 17:57:43] [config] dec-cell: gru
[2023-07-04 17:57:43] [config] dec-cell-base-depth: 2
[2023-07-04 17:57:43] [config] dec-cell-high-depth: 1
[2023-07-04 17:57:43] [config] dec-depth: 1
[2023-07-04 17:57:43] [config] devices:
[2023-07-04 17:57:43] [config]   - 0
[2023-07-04 17:57:43] [config] dim-emb: 512
[2023-07-04 17:57:43] [config] dim-rnn: 1024
[2023-07-04 17:57:43] [config] dim-vocabs:
[2023-07-04 17:57:43] [config]   - 54042
[2023-07-04 17:57:43] [config]   - 36507
[2023-07-04 17:57:43] [config] disp-first: 0
[2023-07-04 17:57:43] [config] disp-freq: 1000u
[2023-07-04 17:57:43] [config] disp-label-counts: true
[2023-07-04 17:57:43] [config] dropout-rnn: 0
[2023-07-04 17:57:43] [config] dropout-src: 0
[2023-07-04 17:57:43] [config] dropout-trg: 0
[2023-07-04 17:57:43] [config] dump-config: ""
[2023-07-04 17:57:43] [config] dynamic-gradient-scaling:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] early-stopping: 10
[2023-07-04 17:57:43] [config] early-stopping-on: first
[2023-07-04 17:57:43] [config] embedding-fix-src: false
[2023-07-04 17:57:43] [config] embedding-fix-trg: false
[2023-07-04 17:57:43] [config] embedding-normalization: false
[2023-07-04 17:57:43] [config] embedding-vectors:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] enc-cell: gru
[2023-07-04 17:57:43] [config] enc-cell-depth: 1
[2023-07-04 17:57:43] [config] enc-depth: 1
[2023-07-04 17:57:43] [config] enc-type: bidirectional
[2023-07-04 17:57:43] [config] english-title-case-every: 0
[2023-07-04 17:57:43] [config] exponential-smoothing: 0
[2023-07-04 17:57:43] [config] factor-weight: 1
[2023-07-04 17:57:43] [config] factors-combine: sum
[2023-07-04 17:57:43] [config] factors-dim-emb: 0
[2023-07-04 17:57:43] [config] gradient-checkpointing: false
[2023-07-04 17:57:43] [config] gradient-norm-average-window: 100
[2023-07-04 17:57:43] [config] guided-alignment: none
[2023-07-04 17:57:43] [config] guided-alignment-cost: mse
[2023-07-04 17:57:43] [config] guided-alignment-weight: 0.1
[2023-07-04 17:57:43] [config] ignore-model-config: false
[2023-07-04 17:57:43] [config] input-types:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] interpolate-env-vars: false
[2023-07-04 17:57:43] [config] keep-best: false
[2023-07-04 17:57:43] [config] label-smoothing: 0
[2023-07-04 17:57:43] [config] layer-normalization: false
[2023-07-04 17:57:43] [config] learn-rate: 0.0001
[2023-07-04 17:57:43] [config] lemma-dependency: ""
[2023-07-04 17:57:43] [config] lemma-dim-emb: 0
[2023-07-04 17:57:43] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:57:43] [config] log-level: info
[2023-07-04 17:57:43] [config] log-time-zone: ""
[2023-07-04 17:57:43] [config] logical-epoch:
[2023-07-04 17:57:43] [config]   - 1e
[2023-07-04 17:57:43] [config]   - 0
[2023-07-04 17:57:43] [config] lr-decay: 0
[2023-07-04 17:57:43] [config] lr-decay-freq: 50000
[2023-07-04 17:57:43] [config] lr-decay-inv-sqrt:
[2023-07-04 17:57:43] [config]   - 0
[2023-07-04 17:57:43] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:57:43] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:57:43] [config] lr-decay-start:
[2023-07-04 17:57:43] [config]   - 10
[2023-07-04 17:57:43] [config]   - 1
[2023-07-04 17:57:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:57:43] [config] lr-report: false
[2023-07-04 17:57:43] [config] lr-warmup: 0
[2023-07-04 17:57:43] [config] lr-warmup-at-reload: false
[2023-07-04 17:57:43] [config] lr-warmup-cycle: false
[2023-07-04 17:57:43] [config] lr-warmup-start-rate: 0
[2023-07-04 17:57:43] [config] max-length: 50
[2023-07-04 17:57:43] [config] max-length-crop: false
[2023-07-04 17:57:43] [config] max-length-factor: 3
[2023-07-04 17:57:43] [config] maxi-batch: 100
[2023-07-04 17:57:43] [config] maxi-batch-sort: trg
[2023-07-04 17:57:43] [config] mini-batch: 64
[2023-07-04 17:57:43] [config] mini-batch-fit: false
[2023-07-04 17:57:43] [config] mini-batch-fit-step: 10
[2023-07-04 17:57:43] [config] mini-batch-round-up: true
[2023-07-04 17:57:43] [config] mini-batch-track-lr: false
[2023-07-04 17:57:43] [config] mini-batch-warmup: 0
[2023-07-04 17:57:43] [config] mini-batch-words: 0
[2023-07-04 17:57:43] [config] mini-batch-words-ref: 0
[2023-07-04 17:57:43] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:43] [config] multi-loss-type: sum
[2023-07-04 17:57:43] [config] n-best: false
[2023-07-04 17:57:43] [config] no-nccl: false
[2023-07-04 17:57:43] [config] no-reload: false
[2023-07-04 17:57:43] [config] no-restore-corpus: false
[2023-07-04 17:57:43] [config] normalize: 0
[2023-07-04 17:57:43] [config] normalize-gradient: false
[2023-07-04 17:57:43] [config] num-devices: 0
[2023-07-04 17:57:43] [config] optimizer: adam
[2023-07-04 17:57:43] [config] optimizer-delay: 1
[2023-07-04 17:57:43] [config] optimizer-params:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] output-omit-bias: false
[2023-07-04 17:57:43] [config] overwrite: true
[2023-07-04 17:57:43] [config] precision:
[2023-07-04 17:57:43] [config]   - float32
[2023-07-04 17:57:43] [config]   - float32
[2023-07-04 17:57:43] [config] pretrained-model: ""
[2023-07-04 17:57:43] [config] quantize-biases: false
[2023-07-04 17:57:43] [config] quantize-bits: 0
[2023-07-04 17:57:43] [config] quantize-log-based: false
[2023-07-04 17:57:43] [config] quantize-optimization-steps: 0
[2023-07-04 17:57:43] [config] quiet: false
[2023-07-04 17:57:43] [config] quiet-translation: true
[2023-07-04 17:57:43] [config] relative-paths: false
[2023-07-04 17:57:43] [config] right-left: false
[2023-07-04 17:57:43] [config] save-freq: 10000u
[2023-07-04 17:57:43] [config] seed: 1234
[2023-07-04 17:57:43] [config] sentencepiece-alphas:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:57:43] [config] sentencepiece-options: ""
[2023-07-04 17:57:43] [config] sharding: global
[2023-07-04 17:57:43] [config] shuffle: data
[2023-07-04 17:57:43] [config] shuffle-in-ram: false
[2023-07-04 17:57:43] [config] sigterm: save-and-exit
[2023-07-04 17:57:43] [config] skip: false
[2023-07-04 17:57:43] [config] sqlite: ""
[2023-07-04 17:57:43] [config] sqlite-drop: false
[2023-07-04 17:57:43] [config] sync-freq: 200u
[2023-07-04 17:57:43] [config] sync-sgd: false
[2023-07-04 17:57:43] [config] tempdir: /tmp
[2023-07-04 17:57:43] [config] tied-embeddings: false
[2023-07-04 17:57:43] [config] tied-embeddings-all: false
[2023-07-04 17:57:43] [config] tied-embeddings-src: false
[2023-07-04 17:57:43] [config] train-embedder-rank:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] train-sets:
[2023-07-04 17:57:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:57:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:57:43] [config] transformer-aan-activation: swish
[2023-07-04 17:57:43] [config] transformer-aan-depth: 2
[2023-07-04 17:57:43] [config] transformer-aan-nogate: false
[2023-07-04 17:57:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:57:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:57:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:57:43] [config] transformer-depth-scaling: false
[2023-07-04 17:57:43] [config] transformer-dim-aan: 2048
[2023-07-04 17:57:43] [config] transformer-dim-ffn: 2048
[2023-07-04 17:57:43] [config] transformer-dropout: 0
[2023-07-04 17:57:43] [config] transformer-dropout-attention: 0
[2023-07-04 17:57:43] [config] transformer-dropout-ffn: 0
[2023-07-04 17:57:43] [config] transformer-ffn-activation: swish
[2023-07-04 17:57:43] [config] transformer-ffn-depth: 2
[2023-07-04 17:57:43] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:57:43] [config] transformer-heads: 8
[2023-07-04 17:57:43] [config] transformer-no-projection: false
[2023-07-04 17:57:43] [config] transformer-pool: false
[2023-07-04 17:57:43] [config] transformer-postprocess: dan
[2023-07-04 17:57:43] [config] transformer-postprocess-emb: d
[2023-07-04 17:57:43] [config] transformer-postprocess-top: ""
[2023-07-04 17:57:43] [config] transformer-preprocess: ""
[2023-07-04 17:57:43] [config] transformer-tied-layers:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] transformer-train-position-embeddings: false
[2023-07-04 17:57:43] [config] tsv: false
[2023-07-04 17:57:43] [config] tsv-fields: 0
[2023-07-04 17:57:43] [config] type: amun
[2023-07-04 17:57:43] [config] ulr: false
[2023-07-04 17:57:43] [config] ulr-dim-emb: 0
[2023-07-04 17:57:43] [config] ulr-dropout: 0
[2023-07-04 17:57:43] [config] ulr-keys-vectors: ""
[2023-07-04 17:57:43] [config] ulr-query-vectors: ""
[2023-07-04 17:57:43] [config] ulr-softmax-temperature: 1
[2023-07-04 17:57:43] [config] ulr-trainable-transformation: false
[2023-07-04 17:57:43] [config] unlikelihood-loss: false
[2023-07-04 17:57:43] [config] valid-freq: 50000000
[2023-07-04 17:57:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:57:43] [config] valid-max-length: 1000
[2023-07-04 17:57:43] [config] valid-metrics:
[2023-07-04 17:57:43] [config]   - cross-entropy
[2023-07-04 17:57:43] [config]   - translation
[2023-07-04 17:57:43] [config] valid-mini-batch: 32
[2023-07-04 17:57:43] [config] valid-reset-stalled: false
[2023-07-04 17:57:43] [config] valid-script-args:
[2023-07-04 17:57:43] [config]   []
[2023-07-04 17:57:43] [config] valid-script-path: ""
[2023-07-04 17:57:43] [config] valid-sets:
[2023-07-04 17:57:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:57:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:57:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:57:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:43] [config] vocabs:
[2023-07-04 17:57:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:43] [config] word-penalty: 0
[2023-07-04 17:57:43] [config] word-scores: false
[2023-07-04 17:57:43] [config] workspace: 2048
[2023-07-04 17:57:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:43] [training] Using single-device training
[2023-07-04 17:57:43] Synced seed 1234
[2023-07-04 17:57:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:43] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:57:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:43] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:57:43] [valid] No post-processing script given for validating translator
[2023-07-04 17:57:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:44] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:57:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:57:44] [comm] Using global sharding
[2023-07-04 17:57:44] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:57:44] [training] Using 1 GPUs
[2023-07-04 17:57:44] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:46] Loading Adam parameters
[2023-07-04 17:57:47] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:57:47] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:57:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:57:47] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:57:47] [data] Shuffling data
[2023-07-04 17:57:47] [data] Done reading 20,192 sentences
[2023-07-04 17:57:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:57:47] Training started
[2023-07-04 17:57:47] Training finished
[2023-07-04 17:57:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:51] [marian] Running on node07.datos.cluster.uy as process 37576 with command line:
[2023-07-04 17:57:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:57:51] [config] after: 0e
[2023-07-04 17:57:51] [config] after-batches: 0
[2023-07-04 17:57:51] [config] after-epochs: 160
[2023-07-04 17:57:51] [config] all-caps-every: 0
[2023-07-04 17:57:51] [config] allow-unk: false
[2023-07-04 17:57:51] [config] authors: false
[2023-07-04 17:57:51] [config] beam-size: 12
[2023-07-04 17:57:51] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:57:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:57:51] [config] bert-masking-fraction: 0.15
[2023-07-04 17:57:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:57:51] [config] bert-train-type-embeddings: true
[2023-07-04 17:57:51] [config] bert-type-vocab-size: 2
[2023-07-04 17:57:51] [config] build-info: ""
[2023-07-04 17:57:51] [config] check-gradient-nan: false
[2023-07-04 17:57:51] [config] check-nan: false
[2023-07-04 17:57:51] [config] cite: false
[2023-07-04 17:57:51] [config] clip-norm: 1
[2023-07-04 17:57:51] [config] cost-scaling:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] cost-type: ce-sum
[2023-07-04 17:57:51] [config] cpu-threads: 0
[2023-07-04 17:57:51] [config] data-threads: 8
[2023-07-04 17:57:51] [config] data-weighting: ""
[2023-07-04 17:57:51] [config] data-weighting-type: sentence
[2023-07-04 17:57:51] [config] dec-cell: gru
[2023-07-04 17:57:51] [config] dec-cell-base-depth: 2
[2023-07-04 17:57:51] [config] dec-cell-high-depth: 1
[2023-07-04 17:57:51] [config] dec-depth: 1
[2023-07-04 17:57:51] [config] devices:
[2023-07-04 17:57:51] [config]   - 0
[2023-07-04 17:57:51] [config] dim-emb: 512
[2023-07-04 17:57:51] [config] dim-rnn: 1024
[2023-07-04 17:57:51] [config] dim-vocabs:
[2023-07-04 17:57:51] [config]   - 54042
[2023-07-04 17:57:51] [config]   - 36507
[2023-07-04 17:57:51] [config] disp-first: 0
[2023-07-04 17:57:51] [config] disp-freq: 1000u
[2023-07-04 17:57:51] [config] disp-label-counts: true
[2023-07-04 17:57:51] [config] dropout-rnn: 0
[2023-07-04 17:57:51] [config] dropout-src: 0
[2023-07-04 17:57:51] [config] dropout-trg: 0
[2023-07-04 17:57:51] [config] dump-config: ""
[2023-07-04 17:57:51] [config] dynamic-gradient-scaling:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] early-stopping: 10
[2023-07-04 17:57:51] [config] early-stopping-on: first
[2023-07-04 17:57:51] [config] embedding-fix-src: false
[2023-07-04 17:57:51] [config] embedding-fix-trg: false
[2023-07-04 17:57:51] [config] embedding-normalization: false
[2023-07-04 17:57:51] [config] embedding-vectors:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] enc-cell: gru
[2023-07-04 17:57:51] [config] enc-cell-depth: 1
[2023-07-04 17:57:51] [config] enc-depth: 1
[2023-07-04 17:57:51] [config] enc-type: bidirectional
[2023-07-04 17:57:51] [config] english-title-case-every: 0
[2023-07-04 17:57:51] [config] exponential-smoothing: 0
[2023-07-04 17:57:51] [config] factor-weight: 1
[2023-07-04 17:57:51] [config] factors-combine: sum
[2023-07-04 17:57:51] [config] factors-dim-emb: 0
[2023-07-04 17:57:51] [config] gradient-checkpointing: false
[2023-07-04 17:57:51] [config] gradient-norm-average-window: 100
[2023-07-04 17:57:51] [config] guided-alignment: none
[2023-07-04 17:57:51] [config] guided-alignment-cost: mse
[2023-07-04 17:57:51] [config] guided-alignment-weight: 0.1
[2023-07-04 17:57:51] [config] ignore-model-config: false
[2023-07-04 17:57:51] [config] input-types:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] interpolate-env-vars: false
[2023-07-04 17:57:51] [config] keep-best: false
[2023-07-04 17:57:51] [config] label-smoothing: 0
[2023-07-04 17:57:51] [config] layer-normalization: false
[2023-07-04 17:57:51] [config] learn-rate: 0.0001
[2023-07-04 17:57:51] [config] lemma-dependency: ""
[2023-07-04 17:57:51] [config] lemma-dim-emb: 0
[2023-07-04 17:57:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:57:51] [config] log-level: info
[2023-07-04 17:57:51] [config] log-time-zone: ""
[2023-07-04 17:57:51] [config] logical-epoch:
[2023-07-04 17:57:51] [config]   - 1e
[2023-07-04 17:57:51] [config]   - 0
[2023-07-04 17:57:51] [config] lr-decay: 0
[2023-07-04 17:57:51] [config] lr-decay-freq: 50000
[2023-07-04 17:57:51] [config] lr-decay-inv-sqrt:
[2023-07-04 17:57:51] [config]   - 0
[2023-07-04 17:57:51] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:57:51] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:57:51] [config] lr-decay-start:
[2023-07-04 17:57:51] [config]   - 10
[2023-07-04 17:57:51] [config]   - 1
[2023-07-04 17:57:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:57:51] [config] lr-report: false
[2023-07-04 17:57:51] [config] lr-warmup: 0
[2023-07-04 17:57:51] [config] lr-warmup-at-reload: false
[2023-07-04 17:57:51] [config] lr-warmup-cycle: false
[2023-07-04 17:57:51] [config] lr-warmup-start-rate: 0
[2023-07-04 17:57:51] [config] max-length: 50
[2023-07-04 17:57:51] [config] max-length-crop: false
[2023-07-04 17:57:51] [config] max-length-factor: 3
[2023-07-04 17:57:51] [config] maxi-batch: 100
[2023-07-04 17:57:51] [config] maxi-batch-sort: trg
[2023-07-04 17:57:51] [config] mini-batch: 64
[2023-07-04 17:57:51] [config] mini-batch-fit: false
[2023-07-04 17:57:51] [config] mini-batch-fit-step: 10
[2023-07-04 17:57:51] [config] mini-batch-round-up: true
[2023-07-04 17:57:51] [config] mini-batch-track-lr: false
[2023-07-04 17:57:51] [config] mini-batch-warmup: 0
[2023-07-04 17:57:51] [config] mini-batch-words: 0
[2023-07-04 17:57:51] [config] mini-batch-words-ref: 0
[2023-07-04 17:57:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:51] [config] multi-loss-type: sum
[2023-07-04 17:57:51] [config] n-best: false
[2023-07-04 17:57:51] [config] no-nccl: false
[2023-07-04 17:57:51] [config] no-reload: false
[2023-07-04 17:57:51] [config] no-restore-corpus: false
[2023-07-04 17:57:51] [config] normalize: 0
[2023-07-04 17:57:51] [config] normalize-gradient: false
[2023-07-04 17:57:51] [config] num-devices: 0
[2023-07-04 17:57:51] [config] optimizer: adam
[2023-07-04 17:57:51] [config] optimizer-delay: 1
[2023-07-04 17:57:51] [config] optimizer-params:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] output-omit-bias: false
[2023-07-04 17:57:51] [config] overwrite: true
[2023-07-04 17:57:51] [config] precision:
[2023-07-04 17:57:51] [config]   - float32
[2023-07-04 17:57:51] [config]   - float32
[2023-07-04 17:57:51] [config] pretrained-model: ""
[2023-07-04 17:57:51] [config] quantize-biases: false
[2023-07-04 17:57:51] [config] quantize-bits: 0
[2023-07-04 17:57:51] [config] quantize-log-based: false
[2023-07-04 17:57:51] [config] quantize-optimization-steps: 0
[2023-07-04 17:57:51] [config] quiet: false
[2023-07-04 17:57:51] [config] quiet-translation: true
[2023-07-04 17:57:51] [config] relative-paths: false
[2023-07-04 17:57:51] [config] right-left: false
[2023-07-04 17:57:51] [config] save-freq: 10000u
[2023-07-04 17:57:51] [config] seed: 1234
[2023-07-04 17:57:51] [config] sentencepiece-alphas:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:57:51] [config] sentencepiece-options: ""
[2023-07-04 17:57:51] [config] sharding: global
[2023-07-04 17:57:51] [config] shuffle: data
[2023-07-04 17:57:51] [config] shuffle-in-ram: false
[2023-07-04 17:57:51] [config] sigterm: save-and-exit
[2023-07-04 17:57:51] [config] skip: false
[2023-07-04 17:57:51] [config] sqlite: ""
[2023-07-04 17:57:51] [config] sqlite-drop: false
[2023-07-04 17:57:51] [config] sync-freq: 200u
[2023-07-04 17:57:51] [config] sync-sgd: false
[2023-07-04 17:57:51] [config] tempdir: /tmp
[2023-07-04 17:57:51] [config] tied-embeddings: false
[2023-07-04 17:57:51] [config] tied-embeddings-all: false
[2023-07-04 17:57:51] [config] tied-embeddings-src: false
[2023-07-04 17:57:51] [config] train-embedder-rank:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] train-sets:
[2023-07-04 17:57:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:57:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:57:51] [config] transformer-aan-activation: swish
[2023-07-04 17:57:51] [config] transformer-aan-depth: 2
[2023-07-04 17:57:51] [config] transformer-aan-nogate: false
[2023-07-04 17:57:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:57:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:57:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:57:51] [config] transformer-depth-scaling: false
[2023-07-04 17:57:51] [config] transformer-dim-aan: 2048
[2023-07-04 17:57:51] [config] transformer-dim-ffn: 2048
[2023-07-04 17:57:51] [config] transformer-dropout: 0
[2023-07-04 17:57:51] [config] transformer-dropout-attention: 0
[2023-07-04 17:57:51] [config] transformer-dropout-ffn: 0
[2023-07-04 17:57:51] [config] transformer-ffn-activation: swish
[2023-07-04 17:57:51] [config] transformer-ffn-depth: 2
[2023-07-04 17:57:51] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:57:51] [config] transformer-heads: 8
[2023-07-04 17:57:51] [config] transformer-no-projection: false
[2023-07-04 17:57:51] [config] transformer-pool: false
[2023-07-04 17:57:51] [config] transformer-postprocess: dan
[2023-07-04 17:57:51] [config] transformer-postprocess-emb: d
[2023-07-04 17:57:51] [config] transformer-postprocess-top: ""
[2023-07-04 17:57:51] [config] transformer-preprocess: ""
[2023-07-04 17:57:51] [config] transformer-tied-layers:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] transformer-train-position-embeddings: false
[2023-07-04 17:57:51] [config] tsv: false
[2023-07-04 17:57:51] [config] tsv-fields: 0
[2023-07-04 17:57:51] [config] type: amun
[2023-07-04 17:57:51] [config] ulr: false
[2023-07-04 17:57:51] [config] ulr-dim-emb: 0
[2023-07-04 17:57:51] [config] ulr-dropout: 0
[2023-07-04 17:57:51] [config] ulr-keys-vectors: ""
[2023-07-04 17:57:51] [config] ulr-query-vectors: ""
[2023-07-04 17:57:51] [config] ulr-softmax-temperature: 1
[2023-07-04 17:57:51] [config] ulr-trainable-transformation: false
[2023-07-04 17:57:51] [config] unlikelihood-loss: false
[2023-07-04 17:57:51] [config] valid-freq: 50000000
[2023-07-04 17:57:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:57:51] [config] valid-max-length: 1000
[2023-07-04 17:57:51] [config] valid-metrics:
[2023-07-04 17:57:51] [config]   - cross-entropy
[2023-07-04 17:57:51] [config]   - translation
[2023-07-04 17:57:51] [config] valid-mini-batch: 32
[2023-07-04 17:57:51] [config] valid-reset-stalled: false
[2023-07-04 17:57:51] [config] valid-script-args:
[2023-07-04 17:57:51] [config]   []
[2023-07-04 17:57:51] [config] valid-script-path: ""
[2023-07-04 17:57:51] [config] valid-sets:
[2023-07-04 17:57:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:57:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:57:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:57:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:51] [config] vocabs:
[2023-07-04 17:57:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:51] [config] word-penalty: 0
[2023-07-04 17:57:51] [config] word-scores: false
[2023-07-04 17:57:51] [config] workspace: 2048
[2023-07-04 17:57:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:51] [training] Using single-device training
[2023-07-04 17:57:51] Synced seed 1234
[2023-07-04 17:57:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:51] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:57:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:51] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:57:51] [valid] No post-processing script given for validating translator
[2023-07-04 17:57:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:52] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:57:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:57:52] [comm] Using global sharding
[2023-07-04 17:57:52] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:57:52] [training] Using 1 GPUs
[2023-07-04 17:57:52] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:54] Loading Adam parameters
[2023-07-04 17:57:54] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:57:54] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:57:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:57:55] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:57:55] [data] Shuffling data
[2023-07-04 17:57:55] [data] Done reading 20,192 sentences
[2023-07-04 17:57:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:57:55] Training started
[2023-07-04 17:57:55] Training finished
[2023-07-04 17:57:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:59] [marian] Running on node07.datos.cluster.uy as process 37626 with command line:
[2023-07-04 17:57:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:57:59] [config] after: 0e
[2023-07-04 17:57:59] [config] after-batches: 0
[2023-07-04 17:57:59] [config] after-epochs: 170
[2023-07-04 17:57:59] [config] all-caps-every: 0
[2023-07-04 17:57:59] [config] allow-unk: false
[2023-07-04 17:57:59] [config] authors: false
[2023-07-04 17:57:59] [config] beam-size: 12
[2023-07-04 17:57:59] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:57:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:57:59] [config] bert-masking-fraction: 0.15
[2023-07-04 17:57:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:57:59] [config] bert-train-type-embeddings: true
[2023-07-04 17:57:59] [config] bert-type-vocab-size: 2
[2023-07-04 17:57:59] [config] build-info: ""
[2023-07-04 17:57:59] [config] check-gradient-nan: false
[2023-07-04 17:57:59] [config] check-nan: false
[2023-07-04 17:57:59] [config] cite: false
[2023-07-04 17:57:59] [config] clip-norm: 1
[2023-07-04 17:57:59] [config] cost-scaling:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] cost-type: ce-sum
[2023-07-04 17:57:59] [config] cpu-threads: 0
[2023-07-04 17:57:59] [config] data-threads: 8
[2023-07-04 17:57:59] [config] data-weighting: ""
[2023-07-04 17:57:59] [config] data-weighting-type: sentence
[2023-07-04 17:57:59] [config] dec-cell: gru
[2023-07-04 17:57:59] [config] dec-cell-base-depth: 2
[2023-07-04 17:57:59] [config] dec-cell-high-depth: 1
[2023-07-04 17:57:59] [config] dec-depth: 1
[2023-07-04 17:57:59] [config] devices:
[2023-07-04 17:57:59] [config]   - 0
[2023-07-04 17:57:59] [config] dim-emb: 512
[2023-07-04 17:57:59] [config] dim-rnn: 1024
[2023-07-04 17:57:59] [config] dim-vocabs:
[2023-07-04 17:57:59] [config]   - 54042
[2023-07-04 17:57:59] [config]   - 36507
[2023-07-04 17:57:59] [config] disp-first: 0
[2023-07-04 17:57:59] [config] disp-freq: 1000u
[2023-07-04 17:57:59] [config] disp-label-counts: true
[2023-07-04 17:57:59] [config] dropout-rnn: 0
[2023-07-04 17:57:59] [config] dropout-src: 0
[2023-07-04 17:57:59] [config] dropout-trg: 0
[2023-07-04 17:57:59] [config] dump-config: ""
[2023-07-04 17:57:59] [config] dynamic-gradient-scaling:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] early-stopping: 10
[2023-07-04 17:57:59] [config] early-stopping-on: first
[2023-07-04 17:57:59] [config] embedding-fix-src: false
[2023-07-04 17:57:59] [config] embedding-fix-trg: false
[2023-07-04 17:57:59] [config] embedding-normalization: false
[2023-07-04 17:57:59] [config] embedding-vectors:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] enc-cell: gru
[2023-07-04 17:57:59] [config] enc-cell-depth: 1
[2023-07-04 17:57:59] [config] enc-depth: 1
[2023-07-04 17:57:59] [config] enc-type: bidirectional
[2023-07-04 17:57:59] [config] english-title-case-every: 0
[2023-07-04 17:57:59] [config] exponential-smoothing: 0
[2023-07-04 17:57:59] [config] factor-weight: 1
[2023-07-04 17:57:59] [config] factors-combine: sum
[2023-07-04 17:57:59] [config] factors-dim-emb: 0
[2023-07-04 17:57:59] [config] gradient-checkpointing: false
[2023-07-04 17:57:59] [config] gradient-norm-average-window: 100
[2023-07-04 17:57:59] [config] guided-alignment: none
[2023-07-04 17:57:59] [config] guided-alignment-cost: mse
[2023-07-04 17:57:59] [config] guided-alignment-weight: 0.1
[2023-07-04 17:57:59] [config] ignore-model-config: false
[2023-07-04 17:57:59] [config] input-types:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] interpolate-env-vars: false
[2023-07-04 17:57:59] [config] keep-best: false
[2023-07-04 17:57:59] [config] label-smoothing: 0
[2023-07-04 17:57:59] [config] layer-normalization: false
[2023-07-04 17:57:59] [config] learn-rate: 0.0001
[2023-07-04 17:57:59] [config] lemma-dependency: ""
[2023-07-04 17:57:59] [config] lemma-dim-emb: 0
[2023-07-04 17:57:59] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:57:59] [config] log-level: info
[2023-07-04 17:57:59] [config] log-time-zone: ""
[2023-07-04 17:57:59] [config] logical-epoch:
[2023-07-04 17:57:59] [config]   - 1e
[2023-07-04 17:57:59] [config]   - 0
[2023-07-04 17:57:59] [config] lr-decay: 0
[2023-07-04 17:57:59] [config] lr-decay-freq: 50000
[2023-07-04 17:57:59] [config] lr-decay-inv-sqrt:
[2023-07-04 17:57:59] [config]   - 0
[2023-07-04 17:57:59] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:57:59] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:57:59] [config] lr-decay-start:
[2023-07-04 17:57:59] [config]   - 10
[2023-07-04 17:57:59] [config]   - 1
[2023-07-04 17:57:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:57:59] [config] lr-report: false
[2023-07-04 17:57:59] [config] lr-warmup: 0
[2023-07-04 17:57:59] [config] lr-warmup-at-reload: false
[2023-07-04 17:57:59] [config] lr-warmup-cycle: false
[2023-07-04 17:57:59] [config] lr-warmup-start-rate: 0
[2023-07-04 17:57:59] [config] max-length: 50
[2023-07-04 17:57:59] [config] max-length-crop: false
[2023-07-04 17:57:59] [config] max-length-factor: 3
[2023-07-04 17:57:59] [config] maxi-batch: 100
[2023-07-04 17:57:59] [config] maxi-batch-sort: trg
[2023-07-04 17:57:59] [config] mini-batch: 64
[2023-07-04 17:57:59] [config] mini-batch-fit: false
[2023-07-04 17:57:59] [config] mini-batch-fit-step: 10
[2023-07-04 17:57:59] [config] mini-batch-round-up: true
[2023-07-04 17:57:59] [config] mini-batch-track-lr: false
[2023-07-04 17:57:59] [config] mini-batch-warmup: 0
[2023-07-04 17:57:59] [config] mini-batch-words: 0
[2023-07-04 17:57:59] [config] mini-batch-words-ref: 0
[2023-07-04 17:57:59] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:57:59] [config] multi-loss-type: sum
[2023-07-04 17:57:59] [config] n-best: false
[2023-07-04 17:57:59] [config] no-nccl: false
[2023-07-04 17:57:59] [config] no-reload: false
[2023-07-04 17:57:59] [config] no-restore-corpus: false
[2023-07-04 17:57:59] [config] normalize: 0
[2023-07-04 17:57:59] [config] normalize-gradient: false
[2023-07-04 17:57:59] [config] num-devices: 0
[2023-07-04 17:57:59] [config] optimizer: adam
[2023-07-04 17:57:59] [config] optimizer-delay: 1
[2023-07-04 17:57:59] [config] optimizer-params:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] output-omit-bias: false
[2023-07-04 17:57:59] [config] overwrite: true
[2023-07-04 17:57:59] [config] precision:
[2023-07-04 17:57:59] [config]   - float32
[2023-07-04 17:57:59] [config]   - float32
[2023-07-04 17:57:59] [config] pretrained-model: ""
[2023-07-04 17:57:59] [config] quantize-biases: false
[2023-07-04 17:57:59] [config] quantize-bits: 0
[2023-07-04 17:57:59] [config] quantize-log-based: false
[2023-07-04 17:57:59] [config] quantize-optimization-steps: 0
[2023-07-04 17:57:59] [config] quiet: false
[2023-07-04 17:57:59] [config] quiet-translation: true
[2023-07-04 17:57:59] [config] relative-paths: false
[2023-07-04 17:57:59] [config] right-left: false
[2023-07-04 17:57:59] [config] save-freq: 10000u
[2023-07-04 17:57:59] [config] seed: 1234
[2023-07-04 17:57:59] [config] sentencepiece-alphas:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:57:59] [config] sentencepiece-options: ""
[2023-07-04 17:57:59] [config] sharding: global
[2023-07-04 17:57:59] [config] shuffle: data
[2023-07-04 17:57:59] [config] shuffle-in-ram: false
[2023-07-04 17:57:59] [config] sigterm: save-and-exit
[2023-07-04 17:57:59] [config] skip: false
[2023-07-04 17:57:59] [config] sqlite: ""
[2023-07-04 17:57:59] [config] sqlite-drop: false
[2023-07-04 17:57:59] [config] sync-freq: 200u
[2023-07-04 17:57:59] [config] sync-sgd: false
[2023-07-04 17:57:59] [config] tempdir: /tmp
[2023-07-04 17:57:59] [config] tied-embeddings: false
[2023-07-04 17:57:59] [config] tied-embeddings-all: false
[2023-07-04 17:57:59] [config] tied-embeddings-src: false
[2023-07-04 17:57:59] [config] train-embedder-rank:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] train-sets:
[2023-07-04 17:57:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:57:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:57:59] [config] transformer-aan-activation: swish
[2023-07-04 17:57:59] [config] transformer-aan-depth: 2
[2023-07-04 17:57:59] [config] transformer-aan-nogate: false
[2023-07-04 17:57:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:57:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:57:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:57:59] [config] transformer-depth-scaling: false
[2023-07-04 17:57:59] [config] transformer-dim-aan: 2048
[2023-07-04 17:57:59] [config] transformer-dim-ffn: 2048
[2023-07-04 17:57:59] [config] transformer-dropout: 0
[2023-07-04 17:57:59] [config] transformer-dropout-attention: 0
[2023-07-04 17:57:59] [config] transformer-dropout-ffn: 0
[2023-07-04 17:57:59] [config] transformer-ffn-activation: swish
[2023-07-04 17:57:59] [config] transformer-ffn-depth: 2
[2023-07-04 17:57:59] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:57:59] [config] transformer-heads: 8
[2023-07-04 17:57:59] [config] transformer-no-projection: false
[2023-07-04 17:57:59] [config] transformer-pool: false
[2023-07-04 17:57:59] [config] transformer-postprocess: dan
[2023-07-04 17:57:59] [config] transformer-postprocess-emb: d
[2023-07-04 17:57:59] [config] transformer-postprocess-top: ""
[2023-07-04 17:57:59] [config] transformer-preprocess: ""
[2023-07-04 17:57:59] [config] transformer-tied-layers:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] transformer-train-position-embeddings: false
[2023-07-04 17:57:59] [config] tsv: false
[2023-07-04 17:57:59] [config] tsv-fields: 0
[2023-07-04 17:57:59] [config] type: amun
[2023-07-04 17:57:59] [config] ulr: false
[2023-07-04 17:57:59] [config] ulr-dim-emb: 0
[2023-07-04 17:57:59] [config] ulr-dropout: 0
[2023-07-04 17:57:59] [config] ulr-keys-vectors: ""
[2023-07-04 17:57:59] [config] ulr-query-vectors: ""
[2023-07-04 17:57:59] [config] ulr-softmax-temperature: 1
[2023-07-04 17:57:59] [config] ulr-trainable-transformation: false
[2023-07-04 17:57:59] [config] unlikelihood-loss: false
[2023-07-04 17:57:59] [config] valid-freq: 50000000
[2023-07-04 17:57:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:57:59] [config] valid-max-length: 1000
[2023-07-04 17:57:59] [config] valid-metrics:
[2023-07-04 17:57:59] [config]   - cross-entropy
[2023-07-04 17:57:59] [config]   - translation
[2023-07-04 17:57:59] [config] valid-mini-batch: 32
[2023-07-04 17:57:59] [config] valid-reset-stalled: false
[2023-07-04 17:57:59] [config] valid-script-args:
[2023-07-04 17:57:59] [config]   []
[2023-07-04 17:57:59] [config] valid-script-path: ""
[2023-07-04 17:57:59] [config] valid-sets:
[2023-07-04 17:57:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:57:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:57:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:57:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:59] [config] vocabs:
[2023-07-04 17:57:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:59] [config] word-penalty: 0
[2023-07-04 17:57:59] [config] word-scores: false
[2023-07-04 17:57:59] [config] workspace: 2048
[2023-07-04 17:57:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:57:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:57:59] [training] Using single-device training
[2023-07-04 17:57:59] Synced seed 1234
[2023-07-04 17:57:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:57:59] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:57:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:57:59] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:57:59] [valid] No post-processing script given for validating translator
[2023-07-04 17:57:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:00] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:58:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:58:00] [comm] Using global sharding
[2023-07-04 17:58:00] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:58:00] [training] Using 1 GPUs
[2023-07-04 17:58:00] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:58:02] Loading Adam parameters
[2023-07-04 17:58:02] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:58:03] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:58:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:58:03] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:58:03] [data] Shuffling data
[2023-07-04 17:58:03] [data] Done reading 20,192 sentences
[2023-07-04 17:58:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:58:03] Training started
[2023-07-04 17:58:03] Training finished
[2023-07-04 17:58:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:07] [marian] Running on node07.datos.cluster.uy as process 37675 with command line:
[2023-07-04 17:58:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:58:07] [config] after: 0e
[2023-07-04 17:58:07] [config] after-batches: 0
[2023-07-04 17:58:07] [config] after-epochs: 180
[2023-07-04 17:58:07] [config] all-caps-every: 0
[2023-07-04 17:58:07] [config] allow-unk: false
[2023-07-04 17:58:07] [config] authors: false
[2023-07-04 17:58:07] [config] beam-size: 12
[2023-07-04 17:58:07] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:58:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:58:07] [config] bert-masking-fraction: 0.15
[2023-07-04 17:58:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:58:07] [config] bert-train-type-embeddings: true
[2023-07-04 17:58:07] [config] bert-type-vocab-size: 2
[2023-07-04 17:58:07] [config] build-info: ""
[2023-07-04 17:58:07] [config] check-gradient-nan: false
[2023-07-04 17:58:07] [config] check-nan: false
[2023-07-04 17:58:07] [config] cite: false
[2023-07-04 17:58:07] [config] clip-norm: 1
[2023-07-04 17:58:07] [config] cost-scaling:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] cost-type: ce-sum
[2023-07-04 17:58:07] [config] cpu-threads: 0
[2023-07-04 17:58:07] [config] data-threads: 8
[2023-07-04 17:58:07] [config] data-weighting: ""
[2023-07-04 17:58:07] [config] data-weighting-type: sentence
[2023-07-04 17:58:07] [config] dec-cell: gru
[2023-07-04 17:58:07] [config] dec-cell-base-depth: 2
[2023-07-04 17:58:07] [config] dec-cell-high-depth: 1
[2023-07-04 17:58:07] [config] dec-depth: 1
[2023-07-04 17:58:07] [config] devices:
[2023-07-04 17:58:07] [config]   - 0
[2023-07-04 17:58:07] [config] dim-emb: 512
[2023-07-04 17:58:07] [config] dim-rnn: 1024
[2023-07-04 17:58:07] [config] dim-vocabs:
[2023-07-04 17:58:07] [config]   - 54042
[2023-07-04 17:58:07] [config]   - 36507
[2023-07-04 17:58:07] [config] disp-first: 0
[2023-07-04 17:58:07] [config] disp-freq: 1000u
[2023-07-04 17:58:07] [config] disp-label-counts: true
[2023-07-04 17:58:07] [config] dropout-rnn: 0
[2023-07-04 17:58:07] [config] dropout-src: 0
[2023-07-04 17:58:07] [config] dropout-trg: 0
[2023-07-04 17:58:07] [config] dump-config: ""
[2023-07-04 17:58:07] [config] dynamic-gradient-scaling:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] early-stopping: 10
[2023-07-04 17:58:07] [config] early-stopping-on: first
[2023-07-04 17:58:07] [config] embedding-fix-src: false
[2023-07-04 17:58:07] [config] embedding-fix-trg: false
[2023-07-04 17:58:07] [config] embedding-normalization: false
[2023-07-04 17:58:07] [config] embedding-vectors:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] enc-cell: gru
[2023-07-04 17:58:07] [config] enc-cell-depth: 1
[2023-07-04 17:58:07] [config] enc-depth: 1
[2023-07-04 17:58:07] [config] enc-type: bidirectional
[2023-07-04 17:58:07] [config] english-title-case-every: 0
[2023-07-04 17:58:07] [config] exponential-smoothing: 0
[2023-07-04 17:58:07] [config] factor-weight: 1
[2023-07-04 17:58:07] [config] factors-combine: sum
[2023-07-04 17:58:07] [config] factors-dim-emb: 0
[2023-07-04 17:58:07] [config] gradient-checkpointing: false
[2023-07-04 17:58:07] [config] gradient-norm-average-window: 100
[2023-07-04 17:58:07] [config] guided-alignment: none
[2023-07-04 17:58:07] [config] guided-alignment-cost: mse
[2023-07-04 17:58:07] [config] guided-alignment-weight: 0.1
[2023-07-04 17:58:07] [config] ignore-model-config: false
[2023-07-04 17:58:07] [config] input-types:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] interpolate-env-vars: false
[2023-07-04 17:58:07] [config] keep-best: false
[2023-07-04 17:58:07] [config] label-smoothing: 0
[2023-07-04 17:58:07] [config] layer-normalization: false
[2023-07-04 17:58:07] [config] learn-rate: 0.0001
[2023-07-04 17:58:07] [config] lemma-dependency: ""
[2023-07-04 17:58:07] [config] lemma-dim-emb: 0
[2023-07-04 17:58:07] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:58:07] [config] log-level: info
[2023-07-04 17:58:07] [config] log-time-zone: ""
[2023-07-04 17:58:07] [config] logical-epoch:
[2023-07-04 17:58:07] [config]   - 1e
[2023-07-04 17:58:07] [config]   - 0
[2023-07-04 17:58:07] [config] lr-decay: 0
[2023-07-04 17:58:07] [config] lr-decay-freq: 50000
[2023-07-04 17:58:07] [config] lr-decay-inv-sqrt:
[2023-07-04 17:58:07] [config]   - 0
[2023-07-04 17:58:07] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:58:07] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:58:07] [config] lr-decay-start:
[2023-07-04 17:58:07] [config]   - 10
[2023-07-04 17:58:07] [config]   - 1
[2023-07-04 17:58:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:58:07] [config] lr-report: false
[2023-07-04 17:58:07] [config] lr-warmup: 0
[2023-07-04 17:58:07] [config] lr-warmup-at-reload: false
[2023-07-04 17:58:07] [config] lr-warmup-cycle: false
[2023-07-04 17:58:07] [config] lr-warmup-start-rate: 0
[2023-07-04 17:58:07] [config] max-length: 50
[2023-07-04 17:58:07] [config] max-length-crop: false
[2023-07-04 17:58:07] [config] max-length-factor: 3
[2023-07-04 17:58:07] [config] maxi-batch: 100
[2023-07-04 17:58:07] [config] maxi-batch-sort: trg
[2023-07-04 17:58:07] [config] mini-batch: 64
[2023-07-04 17:58:07] [config] mini-batch-fit: false
[2023-07-04 17:58:07] [config] mini-batch-fit-step: 10
[2023-07-04 17:58:07] [config] mini-batch-round-up: true
[2023-07-04 17:58:07] [config] mini-batch-track-lr: false
[2023-07-04 17:58:07] [config] mini-batch-warmup: 0
[2023-07-04 17:58:07] [config] mini-batch-words: 0
[2023-07-04 17:58:07] [config] mini-batch-words-ref: 0
[2023-07-04 17:58:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:58:07] [config] multi-loss-type: sum
[2023-07-04 17:58:07] [config] n-best: false
[2023-07-04 17:58:07] [config] no-nccl: false
[2023-07-04 17:58:07] [config] no-reload: false
[2023-07-04 17:58:07] [config] no-restore-corpus: false
[2023-07-04 17:58:07] [config] normalize: 0
[2023-07-04 17:58:07] [config] normalize-gradient: false
[2023-07-04 17:58:07] [config] num-devices: 0
[2023-07-04 17:58:07] [config] optimizer: adam
[2023-07-04 17:58:07] [config] optimizer-delay: 1
[2023-07-04 17:58:07] [config] optimizer-params:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] output-omit-bias: false
[2023-07-04 17:58:07] [config] overwrite: true
[2023-07-04 17:58:07] [config] precision:
[2023-07-04 17:58:07] [config]   - float32
[2023-07-04 17:58:07] [config]   - float32
[2023-07-04 17:58:07] [config] pretrained-model: ""
[2023-07-04 17:58:07] [config] quantize-biases: false
[2023-07-04 17:58:07] [config] quantize-bits: 0
[2023-07-04 17:58:07] [config] quantize-log-based: false
[2023-07-04 17:58:07] [config] quantize-optimization-steps: 0
[2023-07-04 17:58:07] [config] quiet: false
[2023-07-04 17:58:07] [config] quiet-translation: true
[2023-07-04 17:58:07] [config] relative-paths: false
[2023-07-04 17:58:07] [config] right-left: false
[2023-07-04 17:58:07] [config] save-freq: 10000u
[2023-07-04 17:58:07] [config] seed: 1234
[2023-07-04 17:58:07] [config] sentencepiece-alphas:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:58:07] [config] sentencepiece-options: ""
[2023-07-04 17:58:07] [config] sharding: global
[2023-07-04 17:58:07] [config] shuffle: data
[2023-07-04 17:58:07] [config] shuffle-in-ram: false
[2023-07-04 17:58:07] [config] sigterm: save-and-exit
[2023-07-04 17:58:07] [config] skip: false
[2023-07-04 17:58:07] [config] sqlite: ""
[2023-07-04 17:58:07] [config] sqlite-drop: false
[2023-07-04 17:58:07] [config] sync-freq: 200u
[2023-07-04 17:58:07] [config] sync-sgd: false
[2023-07-04 17:58:07] [config] tempdir: /tmp
[2023-07-04 17:58:07] [config] tied-embeddings: false
[2023-07-04 17:58:07] [config] tied-embeddings-all: false
[2023-07-04 17:58:07] [config] tied-embeddings-src: false
[2023-07-04 17:58:07] [config] train-embedder-rank:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] train-sets:
[2023-07-04 17:58:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:58:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:58:07] [config] transformer-aan-activation: swish
[2023-07-04 17:58:07] [config] transformer-aan-depth: 2
[2023-07-04 17:58:07] [config] transformer-aan-nogate: false
[2023-07-04 17:58:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:58:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:58:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:58:07] [config] transformer-depth-scaling: false
[2023-07-04 17:58:07] [config] transformer-dim-aan: 2048
[2023-07-04 17:58:07] [config] transformer-dim-ffn: 2048
[2023-07-04 17:58:07] [config] transformer-dropout: 0
[2023-07-04 17:58:07] [config] transformer-dropout-attention: 0
[2023-07-04 17:58:07] [config] transformer-dropout-ffn: 0
[2023-07-04 17:58:07] [config] transformer-ffn-activation: swish
[2023-07-04 17:58:07] [config] transformer-ffn-depth: 2
[2023-07-04 17:58:07] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:58:07] [config] transformer-heads: 8
[2023-07-04 17:58:07] [config] transformer-no-projection: false
[2023-07-04 17:58:07] [config] transformer-pool: false
[2023-07-04 17:58:07] [config] transformer-postprocess: dan
[2023-07-04 17:58:07] [config] transformer-postprocess-emb: d
[2023-07-04 17:58:07] [config] transformer-postprocess-top: ""
[2023-07-04 17:58:07] [config] transformer-preprocess: ""
[2023-07-04 17:58:07] [config] transformer-tied-layers:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] transformer-train-position-embeddings: false
[2023-07-04 17:58:07] [config] tsv: false
[2023-07-04 17:58:07] [config] tsv-fields: 0
[2023-07-04 17:58:07] [config] type: amun
[2023-07-04 17:58:07] [config] ulr: false
[2023-07-04 17:58:07] [config] ulr-dim-emb: 0
[2023-07-04 17:58:07] [config] ulr-dropout: 0
[2023-07-04 17:58:07] [config] ulr-keys-vectors: ""
[2023-07-04 17:58:07] [config] ulr-query-vectors: ""
[2023-07-04 17:58:07] [config] ulr-softmax-temperature: 1
[2023-07-04 17:58:07] [config] ulr-trainable-transformation: false
[2023-07-04 17:58:07] [config] unlikelihood-loss: false
[2023-07-04 17:58:07] [config] valid-freq: 50000000
[2023-07-04 17:58:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:58:07] [config] valid-max-length: 1000
[2023-07-04 17:58:07] [config] valid-metrics:
[2023-07-04 17:58:07] [config]   - cross-entropy
[2023-07-04 17:58:07] [config]   - translation
[2023-07-04 17:58:07] [config] valid-mini-batch: 32
[2023-07-04 17:58:07] [config] valid-reset-stalled: false
[2023-07-04 17:58:07] [config] valid-script-args:
[2023-07-04 17:58:07] [config]   []
[2023-07-04 17:58:07] [config] valid-script-path: ""
[2023-07-04 17:58:07] [config] valid-sets:
[2023-07-04 17:58:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:58:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:58:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:58:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:07] [config] vocabs:
[2023-07-04 17:58:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:07] [config] word-penalty: 0
[2023-07-04 17:58:07] [config] word-scores: false
[2023-07-04 17:58:07] [config] workspace: 2048
[2023-07-04 17:58:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:07] [training] Using single-device training
[2023-07-04 17:58:07] Synced seed 1234
[2023-07-04 17:58:07] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:07] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:58:07] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:07] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:58:07] [valid] No post-processing script given for validating translator
[2023-07-04 17:58:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:08] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:58:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:58:08] [comm] Using global sharding
[2023-07-04 17:58:08] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:58:08] [training] Using 1 GPUs
[2023-07-04 17:58:08] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:58:10] Loading Adam parameters
[2023-07-04 17:58:10] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:58:10] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:58:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:58:11] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:58:11] [data] Shuffling data
[2023-07-04 17:58:11] [data] Done reading 20,192 sentences
[2023-07-04 17:58:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:58:11] Training started
[2023-07-04 17:58:11] Training finished
[2023-07-04 17:58:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:15] [marian] Running on node07.datos.cluster.uy as process 37724 with command line:
[2023-07-04 17:58:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:58:15] [config] after: 0e
[2023-07-04 17:58:15] [config] after-batches: 0
[2023-07-04 17:58:15] [config] after-epochs: 190
[2023-07-04 17:58:15] [config] all-caps-every: 0
[2023-07-04 17:58:15] [config] allow-unk: false
[2023-07-04 17:58:15] [config] authors: false
[2023-07-04 17:58:15] [config] beam-size: 12
[2023-07-04 17:58:15] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:58:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:58:15] [config] bert-masking-fraction: 0.15
[2023-07-04 17:58:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:58:15] [config] bert-train-type-embeddings: true
[2023-07-04 17:58:15] [config] bert-type-vocab-size: 2
[2023-07-04 17:58:15] [config] build-info: ""
[2023-07-04 17:58:15] [config] check-gradient-nan: false
[2023-07-04 17:58:15] [config] check-nan: false
[2023-07-04 17:58:15] [config] cite: false
[2023-07-04 17:58:15] [config] clip-norm: 1
[2023-07-04 17:58:15] [config] cost-scaling:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] cost-type: ce-sum
[2023-07-04 17:58:15] [config] cpu-threads: 0
[2023-07-04 17:58:15] [config] data-threads: 8
[2023-07-04 17:58:15] [config] data-weighting: ""
[2023-07-04 17:58:15] [config] data-weighting-type: sentence
[2023-07-04 17:58:15] [config] dec-cell: gru
[2023-07-04 17:58:15] [config] dec-cell-base-depth: 2
[2023-07-04 17:58:15] [config] dec-cell-high-depth: 1
[2023-07-04 17:58:15] [config] dec-depth: 1
[2023-07-04 17:58:15] [config] devices:
[2023-07-04 17:58:15] [config]   - 0
[2023-07-04 17:58:15] [config] dim-emb: 512
[2023-07-04 17:58:15] [config] dim-rnn: 1024
[2023-07-04 17:58:15] [config] dim-vocabs:
[2023-07-04 17:58:15] [config]   - 54042
[2023-07-04 17:58:15] [config]   - 36507
[2023-07-04 17:58:15] [config] disp-first: 0
[2023-07-04 17:58:15] [config] disp-freq: 1000u
[2023-07-04 17:58:15] [config] disp-label-counts: true
[2023-07-04 17:58:15] [config] dropout-rnn: 0
[2023-07-04 17:58:15] [config] dropout-src: 0
[2023-07-04 17:58:15] [config] dropout-trg: 0
[2023-07-04 17:58:15] [config] dump-config: ""
[2023-07-04 17:58:15] [config] dynamic-gradient-scaling:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] early-stopping: 10
[2023-07-04 17:58:15] [config] early-stopping-on: first
[2023-07-04 17:58:15] [config] embedding-fix-src: false
[2023-07-04 17:58:15] [config] embedding-fix-trg: false
[2023-07-04 17:58:15] [config] embedding-normalization: false
[2023-07-04 17:58:15] [config] embedding-vectors:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] enc-cell: gru
[2023-07-04 17:58:15] [config] enc-cell-depth: 1
[2023-07-04 17:58:15] [config] enc-depth: 1
[2023-07-04 17:58:15] [config] enc-type: bidirectional
[2023-07-04 17:58:15] [config] english-title-case-every: 0
[2023-07-04 17:58:15] [config] exponential-smoothing: 0
[2023-07-04 17:58:15] [config] factor-weight: 1
[2023-07-04 17:58:15] [config] factors-combine: sum
[2023-07-04 17:58:15] [config] factors-dim-emb: 0
[2023-07-04 17:58:15] [config] gradient-checkpointing: false
[2023-07-04 17:58:15] [config] gradient-norm-average-window: 100
[2023-07-04 17:58:15] [config] guided-alignment: none
[2023-07-04 17:58:15] [config] guided-alignment-cost: mse
[2023-07-04 17:58:15] [config] guided-alignment-weight: 0.1
[2023-07-04 17:58:15] [config] ignore-model-config: false
[2023-07-04 17:58:15] [config] input-types:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] interpolate-env-vars: false
[2023-07-04 17:58:15] [config] keep-best: false
[2023-07-04 17:58:15] [config] label-smoothing: 0
[2023-07-04 17:58:15] [config] layer-normalization: false
[2023-07-04 17:58:15] [config] learn-rate: 0.0001
[2023-07-04 17:58:15] [config] lemma-dependency: ""
[2023-07-04 17:58:15] [config] lemma-dim-emb: 0
[2023-07-04 17:58:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:58:15] [config] log-level: info
[2023-07-04 17:58:15] [config] log-time-zone: ""
[2023-07-04 17:58:15] [config] logical-epoch:
[2023-07-04 17:58:15] [config]   - 1e
[2023-07-04 17:58:15] [config]   - 0
[2023-07-04 17:58:15] [config] lr-decay: 0
[2023-07-04 17:58:15] [config] lr-decay-freq: 50000
[2023-07-04 17:58:15] [config] lr-decay-inv-sqrt:
[2023-07-04 17:58:15] [config]   - 0
[2023-07-04 17:58:15] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:58:15] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:58:15] [config] lr-decay-start:
[2023-07-04 17:58:15] [config]   - 10
[2023-07-04 17:58:15] [config]   - 1
[2023-07-04 17:58:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:58:15] [config] lr-report: false
[2023-07-04 17:58:15] [config] lr-warmup: 0
[2023-07-04 17:58:15] [config] lr-warmup-at-reload: false
[2023-07-04 17:58:15] [config] lr-warmup-cycle: false
[2023-07-04 17:58:15] [config] lr-warmup-start-rate: 0
[2023-07-04 17:58:15] [config] max-length: 50
[2023-07-04 17:58:15] [config] max-length-crop: false
[2023-07-04 17:58:15] [config] max-length-factor: 3
[2023-07-04 17:58:15] [config] maxi-batch: 100
[2023-07-04 17:58:15] [config] maxi-batch-sort: trg
[2023-07-04 17:58:15] [config] mini-batch: 64
[2023-07-04 17:58:15] [config] mini-batch-fit: false
[2023-07-04 17:58:15] [config] mini-batch-fit-step: 10
[2023-07-04 17:58:15] [config] mini-batch-round-up: true
[2023-07-04 17:58:15] [config] mini-batch-track-lr: false
[2023-07-04 17:58:15] [config] mini-batch-warmup: 0
[2023-07-04 17:58:15] [config] mini-batch-words: 0
[2023-07-04 17:58:15] [config] mini-batch-words-ref: 0
[2023-07-04 17:58:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:58:15] [config] multi-loss-type: sum
[2023-07-04 17:58:15] [config] n-best: false
[2023-07-04 17:58:15] [config] no-nccl: false
[2023-07-04 17:58:15] [config] no-reload: false
[2023-07-04 17:58:15] [config] no-restore-corpus: false
[2023-07-04 17:58:15] [config] normalize: 0
[2023-07-04 17:58:15] [config] normalize-gradient: false
[2023-07-04 17:58:15] [config] num-devices: 0
[2023-07-04 17:58:15] [config] optimizer: adam
[2023-07-04 17:58:15] [config] optimizer-delay: 1
[2023-07-04 17:58:15] [config] optimizer-params:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] output-omit-bias: false
[2023-07-04 17:58:15] [config] overwrite: true
[2023-07-04 17:58:15] [config] precision:
[2023-07-04 17:58:15] [config]   - float32
[2023-07-04 17:58:15] [config]   - float32
[2023-07-04 17:58:15] [config] pretrained-model: ""
[2023-07-04 17:58:15] [config] quantize-biases: false
[2023-07-04 17:58:15] [config] quantize-bits: 0
[2023-07-04 17:58:15] [config] quantize-log-based: false
[2023-07-04 17:58:15] [config] quantize-optimization-steps: 0
[2023-07-04 17:58:15] [config] quiet: false
[2023-07-04 17:58:15] [config] quiet-translation: true
[2023-07-04 17:58:15] [config] relative-paths: false
[2023-07-04 17:58:15] [config] right-left: false
[2023-07-04 17:58:15] [config] save-freq: 10000u
[2023-07-04 17:58:15] [config] seed: 1234
[2023-07-04 17:58:15] [config] sentencepiece-alphas:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:58:15] [config] sentencepiece-options: ""
[2023-07-04 17:58:15] [config] sharding: global
[2023-07-04 17:58:15] [config] shuffle: data
[2023-07-04 17:58:15] [config] shuffle-in-ram: false
[2023-07-04 17:58:15] [config] sigterm: save-and-exit
[2023-07-04 17:58:15] [config] skip: false
[2023-07-04 17:58:15] [config] sqlite: ""
[2023-07-04 17:58:15] [config] sqlite-drop: false
[2023-07-04 17:58:15] [config] sync-freq: 200u
[2023-07-04 17:58:15] [config] sync-sgd: false
[2023-07-04 17:58:15] [config] tempdir: /tmp
[2023-07-04 17:58:15] [config] tied-embeddings: false
[2023-07-04 17:58:15] [config] tied-embeddings-all: false
[2023-07-04 17:58:15] [config] tied-embeddings-src: false
[2023-07-04 17:58:15] [config] train-embedder-rank:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] train-sets:
[2023-07-04 17:58:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:58:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:58:15] [config] transformer-aan-activation: swish
[2023-07-04 17:58:15] [config] transformer-aan-depth: 2
[2023-07-04 17:58:15] [config] transformer-aan-nogate: false
[2023-07-04 17:58:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:58:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:58:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:58:15] [config] transformer-depth-scaling: false
[2023-07-04 17:58:15] [config] transformer-dim-aan: 2048
[2023-07-04 17:58:15] [config] transformer-dim-ffn: 2048
[2023-07-04 17:58:15] [config] transformer-dropout: 0
[2023-07-04 17:58:15] [config] transformer-dropout-attention: 0
[2023-07-04 17:58:15] [config] transformer-dropout-ffn: 0
[2023-07-04 17:58:15] [config] transformer-ffn-activation: swish
[2023-07-04 17:58:15] [config] transformer-ffn-depth: 2
[2023-07-04 17:58:15] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:58:15] [config] transformer-heads: 8
[2023-07-04 17:58:15] [config] transformer-no-projection: false
[2023-07-04 17:58:15] [config] transformer-pool: false
[2023-07-04 17:58:15] [config] transformer-postprocess: dan
[2023-07-04 17:58:15] [config] transformer-postprocess-emb: d
[2023-07-04 17:58:15] [config] transformer-postprocess-top: ""
[2023-07-04 17:58:15] [config] transformer-preprocess: ""
[2023-07-04 17:58:15] [config] transformer-tied-layers:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] transformer-train-position-embeddings: false
[2023-07-04 17:58:15] [config] tsv: false
[2023-07-04 17:58:15] [config] tsv-fields: 0
[2023-07-04 17:58:15] [config] type: amun
[2023-07-04 17:58:15] [config] ulr: false
[2023-07-04 17:58:15] [config] ulr-dim-emb: 0
[2023-07-04 17:58:15] [config] ulr-dropout: 0
[2023-07-04 17:58:15] [config] ulr-keys-vectors: ""
[2023-07-04 17:58:15] [config] ulr-query-vectors: ""
[2023-07-04 17:58:15] [config] ulr-softmax-temperature: 1
[2023-07-04 17:58:15] [config] ulr-trainable-transformation: false
[2023-07-04 17:58:15] [config] unlikelihood-loss: false
[2023-07-04 17:58:15] [config] valid-freq: 50000000
[2023-07-04 17:58:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:58:15] [config] valid-max-length: 1000
[2023-07-04 17:58:15] [config] valid-metrics:
[2023-07-04 17:58:15] [config]   - cross-entropy
[2023-07-04 17:58:15] [config]   - translation
[2023-07-04 17:58:15] [config] valid-mini-batch: 32
[2023-07-04 17:58:15] [config] valid-reset-stalled: false
[2023-07-04 17:58:15] [config] valid-script-args:
[2023-07-04 17:58:15] [config]   []
[2023-07-04 17:58:15] [config] valid-script-path: ""
[2023-07-04 17:58:15] [config] valid-sets:
[2023-07-04 17:58:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:58:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:58:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:58:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:15] [config] vocabs:
[2023-07-04 17:58:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:15] [config] word-penalty: 0
[2023-07-04 17:58:15] [config] word-scores: false
[2023-07-04 17:58:15] [config] workspace: 2048
[2023-07-04 17:58:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:15] [training] Using single-device training
[2023-07-04 17:58:16] Synced seed 1234
[2023-07-04 17:58:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:16] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:58:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:16] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:58:16] [valid] No post-processing script given for validating translator
[2023-07-04 17:58:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:58:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:58:17] [comm] Using global sharding
[2023-07-04 17:58:17] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:58:17] [training] Using 1 GPUs
[2023-07-04 17:58:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:58:19] Loading Adam parameters
[2023-07-04 17:58:19] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:58:19] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:58:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:58:20] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:58:20] [data] Shuffling data
[2023-07-04 17:58:20] [data] Done reading 20,192 sentences
[2023-07-04 17:58:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:58:20] Training started
[2023-07-04 17:58:20] Training finished
[2023-07-04 17:58:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:24] [marian] Running on node07.datos.cluster.uy as process 37773 with command line:
[2023-07-04 17:58:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-04 17:58:24] [config] after: 0e
[2023-07-04 17:58:24] [config] after-batches: 0
[2023-07-04 17:58:24] [config] after-epochs: 200
[2023-07-04 17:58:24] [config] all-caps-every: 0
[2023-07-04 17:58:24] [config] allow-unk: false
[2023-07-04 17:58:24] [config] authors: false
[2023-07-04 17:58:24] [config] beam-size: 12
[2023-07-04 17:58:24] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:58:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:58:24] [config] bert-masking-fraction: 0.15
[2023-07-04 17:58:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:58:24] [config] bert-train-type-embeddings: true
[2023-07-04 17:58:24] [config] bert-type-vocab-size: 2
[2023-07-04 17:58:24] [config] build-info: ""
[2023-07-04 17:58:24] [config] check-gradient-nan: false
[2023-07-04 17:58:24] [config] check-nan: false
[2023-07-04 17:58:24] [config] cite: false
[2023-07-04 17:58:24] [config] clip-norm: 1
[2023-07-04 17:58:24] [config] cost-scaling:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] cost-type: ce-sum
[2023-07-04 17:58:24] [config] cpu-threads: 0
[2023-07-04 17:58:24] [config] data-threads: 8
[2023-07-04 17:58:24] [config] data-weighting: ""
[2023-07-04 17:58:24] [config] data-weighting-type: sentence
[2023-07-04 17:58:24] [config] dec-cell: gru
[2023-07-04 17:58:24] [config] dec-cell-base-depth: 2
[2023-07-04 17:58:24] [config] dec-cell-high-depth: 1
[2023-07-04 17:58:24] [config] dec-depth: 1
[2023-07-04 17:58:24] [config] devices:
[2023-07-04 17:58:24] [config]   - 0
[2023-07-04 17:58:24] [config] dim-emb: 512
[2023-07-04 17:58:24] [config] dim-rnn: 1024
[2023-07-04 17:58:24] [config] dim-vocabs:
[2023-07-04 17:58:24] [config]   - 54042
[2023-07-04 17:58:24] [config]   - 36507
[2023-07-04 17:58:24] [config] disp-first: 0
[2023-07-04 17:58:24] [config] disp-freq: 1000u
[2023-07-04 17:58:24] [config] disp-label-counts: true
[2023-07-04 17:58:24] [config] dropout-rnn: 0
[2023-07-04 17:58:24] [config] dropout-src: 0
[2023-07-04 17:58:24] [config] dropout-trg: 0
[2023-07-04 17:58:24] [config] dump-config: ""
[2023-07-04 17:58:24] [config] dynamic-gradient-scaling:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] early-stopping: 10
[2023-07-04 17:58:24] [config] early-stopping-on: first
[2023-07-04 17:58:24] [config] embedding-fix-src: false
[2023-07-04 17:58:24] [config] embedding-fix-trg: false
[2023-07-04 17:58:24] [config] embedding-normalization: false
[2023-07-04 17:58:24] [config] embedding-vectors:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] enc-cell: gru
[2023-07-04 17:58:24] [config] enc-cell-depth: 1
[2023-07-04 17:58:24] [config] enc-depth: 1
[2023-07-04 17:58:24] [config] enc-type: bidirectional
[2023-07-04 17:58:24] [config] english-title-case-every: 0
[2023-07-04 17:58:24] [config] exponential-smoothing: 0
[2023-07-04 17:58:24] [config] factor-weight: 1
[2023-07-04 17:58:24] [config] factors-combine: sum
[2023-07-04 17:58:24] [config] factors-dim-emb: 0
[2023-07-04 17:58:24] [config] gradient-checkpointing: false
[2023-07-04 17:58:24] [config] gradient-norm-average-window: 100
[2023-07-04 17:58:24] [config] guided-alignment: none
[2023-07-04 17:58:24] [config] guided-alignment-cost: mse
[2023-07-04 17:58:24] [config] guided-alignment-weight: 0.1
[2023-07-04 17:58:24] [config] ignore-model-config: false
[2023-07-04 17:58:24] [config] input-types:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] interpolate-env-vars: false
[2023-07-04 17:58:24] [config] keep-best: false
[2023-07-04 17:58:24] [config] label-smoothing: 0
[2023-07-04 17:58:24] [config] layer-normalization: false
[2023-07-04 17:58:24] [config] learn-rate: 0.0001
[2023-07-04 17:58:24] [config] lemma-dependency: ""
[2023-07-04 17:58:24] [config] lemma-dim-emb: 0
[2023-07-04 17:58:24] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:58:24] [config] log-level: info
[2023-07-04 17:58:24] [config] log-time-zone: ""
[2023-07-04 17:58:24] [config] logical-epoch:
[2023-07-04 17:58:24] [config]   - 1e
[2023-07-04 17:58:24] [config]   - 0
[2023-07-04 17:58:24] [config] lr-decay: 0
[2023-07-04 17:58:24] [config] lr-decay-freq: 50000
[2023-07-04 17:58:24] [config] lr-decay-inv-sqrt:
[2023-07-04 17:58:24] [config]   - 0
[2023-07-04 17:58:24] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:58:24] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:58:24] [config] lr-decay-start:
[2023-07-04 17:58:24] [config]   - 10
[2023-07-04 17:58:24] [config]   - 1
[2023-07-04 17:58:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:58:24] [config] lr-report: false
[2023-07-04 17:58:24] [config] lr-warmup: 0
[2023-07-04 17:58:24] [config] lr-warmup-at-reload: false
[2023-07-04 17:58:24] [config] lr-warmup-cycle: false
[2023-07-04 17:58:24] [config] lr-warmup-start-rate: 0
[2023-07-04 17:58:24] [config] max-length: 50
[2023-07-04 17:58:24] [config] max-length-crop: false
[2023-07-04 17:58:24] [config] max-length-factor: 3
[2023-07-04 17:58:24] [config] maxi-batch: 100
[2023-07-04 17:58:24] [config] maxi-batch-sort: trg
[2023-07-04 17:58:24] [config] mini-batch: 64
[2023-07-04 17:58:24] [config] mini-batch-fit: false
[2023-07-04 17:58:24] [config] mini-batch-fit-step: 10
[2023-07-04 17:58:24] [config] mini-batch-round-up: true
[2023-07-04 17:58:24] [config] mini-batch-track-lr: false
[2023-07-04 17:58:24] [config] mini-batch-warmup: 0
[2023-07-04 17:58:24] [config] mini-batch-words: 0
[2023-07-04 17:58:24] [config] mini-batch-words-ref: 0
[2023-07-04 17:58:24] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:58:24] [config] multi-loss-type: sum
[2023-07-04 17:58:24] [config] n-best: false
[2023-07-04 17:58:24] [config] no-nccl: false
[2023-07-04 17:58:24] [config] no-reload: false
[2023-07-04 17:58:24] [config] no-restore-corpus: false
[2023-07-04 17:58:24] [config] normalize: 0
[2023-07-04 17:58:24] [config] normalize-gradient: false
[2023-07-04 17:58:24] [config] num-devices: 0
[2023-07-04 17:58:24] [config] optimizer: adam
[2023-07-04 17:58:24] [config] optimizer-delay: 1
[2023-07-04 17:58:24] [config] optimizer-params:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] output-omit-bias: false
[2023-07-04 17:58:24] [config] overwrite: true
[2023-07-04 17:58:24] [config] precision:
[2023-07-04 17:58:24] [config]   - float32
[2023-07-04 17:58:24] [config]   - float32
[2023-07-04 17:58:24] [config] pretrained-model: ""
[2023-07-04 17:58:24] [config] quantize-biases: false
[2023-07-04 17:58:24] [config] quantize-bits: 0
[2023-07-04 17:58:24] [config] quantize-log-based: false
[2023-07-04 17:58:24] [config] quantize-optimization-steps: 0
[2023-07-04 17:58:24] [config] quiet: false
[2023-07-04 17:58:24] [config] quiet-translation: true
[2023-07-04 17:58:24] [config] relative-paths: false
[2023-07-04 17:58:24] [config] right-left: false
[2023-07-04 17:58:24] [config] save-freq: 10000u
[2023-07-04 17:58:24] [config] seed: 1234
[2023-07-04 17:58:24] [config] sentencepiece-alphas:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:58:24] [config] sentencepiece-options: ""
[2023-07-04 17:58:24] [config] sharding: global
[2023-07-04 17:58:24] [config] shuffle: data
[2023-07-04 17:58:24] [config] shuffle-in-ram: false
[2023-07-04 17:58:24] [config] sigterm: save-and-exit
[2023-07-04 17:58:24] [config] skip: false
[2023-07-04 17:58:24] [config] sqlite: ""
[2023-07-04 17:58:24] [config] sqlite-drop: false
[2023-07-04 17:58:24] [config] sync-freq: 200u
[2023-07-04 17:58:24] [config] sync-sgd: false
[2023-07-04 17:58:24] [config] tempdir: /tmp
[2023-07-04 17:58:24] [config] tied-embeddings: false
[2023-07-04 17:58:24] [config] tied-embeddings-all: false
[2023-07-04 17:58:24] [config] tied-embeddings-src: false
[2023-07-04 17:58:24] [config] train-embedder-rank:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] train-sets:
[2023-07-04 17:58:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:58:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:58:24] [config] transformer-aan-activation: swish
[2023-07-04 17:58:24] [config] transformer-aan-depth: 2
[2023-07-04 17:58:24] [config] transformer-aan-nogate: false
[2023-07-04 17:58:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:58:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:58:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:58:24] [config] transformer-depth-scaling: false
[2023-07-04 17:58:24] [config] transformer-dim-aan: 2048
[2023-07-04 17:58:24] [config] transformer-dim-ffn: 2048
[2023-07-04 17:58:24] [config] transformer-dropout: 0
[2023-07-04 17:58:24] [config] transformer-dropout-attention: 0
[2023-07-04 17:58:24] [config] transformer-dropout-ffn: 0
[2023-07-04 17:58:24] [config] transformer-ffn-activation: swish
[2023-07-04 17:58:24] [config] transformer-ffn-depth: 2
[2023-07-04 17:58:24] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:58:24] [config] transformer-heads: 8
[2023-07-04 17:58:24] [config] transformer-no-projection: false
[2023-07-04 17:58:24] [config] transformer-pool: false
[2023-07-04 17:58:24] [config] transformer-postprocess: dan
[2023-07-04 17:58:24] [config] transformer-postprocess-emb: d
[2023-07-04 17:58:24] [config] transformer-postprocess-top: ""
[2023-07-04 17:58:24] [config] transformer-preprocess: ""
[2023-07-04 17:58:24] [config] transformer-tied-layers:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] transformer-train-position-embeddings: false
[2023-07-04 17:58:24] [config] tsv: false
[2023-07-04 17:58:24] [config] tsv-fields: 0
[2023-07-04 17:58:24] [config] type: amun
[2023-07-04 17:58:24] [config] ulr: false
[2023-07-04 17:58:24] [config] ulr-dim-emb: 0
[2023-07-04 17:58:24] [config] ulr-dropout: 0
[2023-07-04 17:58:24] [config] ulr-keys-vectors: ""
[2023-07-04 17:58:24] [config] ulr-query-vectors: ""
[2023-07-04 17:58:24] [config] ulr-softmax-temperature: 1
[2023-07-04 17:58:24] [config] ulr-trainable-transformation: false
[2023-07-04 17:58:24] [config] unlikelihood-loss: false
[2023-07-04 17:58:24] [config] valid-freq: 50000000
[2023-07-04 17:58:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:58:24] [config] valid-max-length: 1000
[2023-07-04 17:58:24] [config] valid-metrics:
[2023-07-04 17:58:24] [config]   - cross-entropy
[2023-07-04 17:58:24] [config]   - translation
[2023-07-04 17:58:24] [config] valid-mini-batch: 32
[2023-07-04 17:58:24] [config] valid-reset-stalled: false
[2023-07-04 17:58:24] [config] valid-script-args:
[2023-07-04 17:58:24] [config]   []
[2023-07-04 17:58:24] [config] valid-script-path: ""
[2023-07-04 17:58:24] [config] valid-sets:
[2023-07-04 17:58:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:58:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:58:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:58:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:24] [config] vocabs:
[2023-07-04 17:58:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:24] [config] word-penalty: 0
[2023-07-04 17:58:24] [config] word-scores: false
[2023-07-04 17:58:24] [config] workspace: 2048
[2023-07-04 17:58:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:24] [training] Using single-device training
[2023-07-04 17:58:24] Synced seed 1234
[2023-07-04 17:58:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:24] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:58:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:24] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:58:24] [valid] No post-processing script given for validating translator
[2023-07-04 17:58:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:25] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:58:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:58:25] [comm] Using global sharding
[2023-07-04 17:58:25] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:58:25] [training] Using 1 GPUs
[2023-07-04 17:58:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz
[2023-07-04 17:58:27] Loading Adam parameters
[2023-07-04 17:58:27] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:58:27] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:58:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-04 17:58:27] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 17:58:27] [data] Shuffling data
[2023-07-04 17:58:27] [data] Done reading 20,192 sentences
[2023-07-04 17:58:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:58:27] Training started
[2023-07-04 17:58:27] Training finished
[2023-07-04 17:58:33] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:33] [marian] Running on node07.datos.cluster.uy as process 37824 with command line:
[2023-07-04 17:58:33] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 17:58:33] [config] after: 0e
[2023-07-04 17:58:33] [config] after-batches: 0
[2023-07-04 17:58:33] [config] after-epochs: 10
[2023-07-04 17:58:33] [config] all-caps-every: 0
[2023-07-04 17:58:33] [config] allow-unk: false
[2023-07-04 17:58:33] [config] authors: false
[2023-07-04 17:58:33] [config] beam-size: 12
[2023-07-04 17:58:33] [config] bert-class-symbol: "[CLS]"
[2023-07-04 17:58:33] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 17:58:33] [config] bert-masking-fraction: 0.15
[2023-07-04 17:58:33] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 17:58:33] [config] bert-train-type-embeddings: true
[2023-07-04 17:58:33] [config] bert-type-vocab-size: 2
[2023-07-04 17:58:33] [config] build-info: ""
[2023-07-04 17:58:33] [config] check-gradient-nan: false
[2023-07-04 17:58:33] [config] check-nan: false
[2023-07-04 17:58:33] [config] cite: false
[2023-07-04 17:58:33] [config] clip-norm: 1
[2023-07-04 17:58:33] [config] cost-scaling:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] cost-type: ce-sum
[2023-07-04 17:58:33] [config] cpu-threads: 0
[2023-07-04 17:58:33] [config] data-threads: 8
[2023-07-04 17:58:33] [config] data-weighting: ""
[2023-07-04 17:58:33] [config] data-weighting-type: sentence
[2023-07-04 17:58:33] [config] dec-cell: gru
[2023-07-04 17:58:33] [config] dec-cell-base-depth: 2
[2023-07-04 17:58:33] [config] dec-cell-high-depth: 1
[2023-07-04 17:58:33] [config] dec-depth: 1
[2023-07-04 17:58:33] [config] devices:
[2023-07-04 17:58:33] [config]   - 0
[2023-07-04 17:58:33] [config] dim-emb: 512
[2023-07-04 17:58:33] [config] dim-rnn: 1024
[2023-07-04 17:58:33] [config] dim-vocabs:
[2023-07-04 17:58:33] [config]   - 0
[2023-07-04 17:58:33] [config]   - 0
[2023-07-04 17:58:33] [config] disp-first: 0
[2023-07-04 17:58:33] [config] disp-freq: 1000u
[2023-07-04 17:58:33] [config] disp-label-counts: true
[2023-07-04 17:58:33] [config] dropout-rnn: 0
[2023-07-04 17:58:33] [config] dropout-src: 0
[2023-07-04 17:58:33] [config] dropout-trg: 0
[2023-07-04 17:58:33] [config] dump-config: ""
[2023-07-04 17:58:33] [config] dynamic-gradient-scaling:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] early-stopping: 10
[2023-07-04 17:58:33] [config] early-stopping-on: first
[2023-07-04 17:58:33] [config] embedding-fix-src: false
[2023-07-04 17:58:33] [config] embedding-fix-trg: false
[2023-07-04 17:58:33] [config] embedding-normalization: false
[2023-07-04 17:58:33] [config] embedding-vectors:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] enc-cell: gru
[2023-07-04 17:58:33] [config] enc-cell-depth: 1
[2023-07-04 17:58:33] [config] enc-depth: 1
[2023-07-04 17:58:33] [config] enc-type: bidirectional
[2023-07-04 17:58:33] [config] english-title-case-every: 0
[2023-07-04 17:58:33] [config] exponential-smoothing: 0
[2023-07-04 17:58:33] [config] factor-weight: 1
[2023-07-04 17:58:33] [config] factors-combine: sum
[2023-07-04 17:58:33] [config] factors-dim-emb: 0
[2023-07-04 17:58:33] [config] gradient-checkpointing: false
[2023-07-04 17:58:33] [config] gradient-norm-average-window: 100
[2023-07-04 17:58:33] [config] guided-alignment: none
[2023-07-04 17:58:33] [config] guided-alignment-cost: mse
[2023-07-04 17:58:33] [config] guided-alignment-weight: 0.1
[2023-07-04 17:58:33] [config] ignore-model-config: false
[2023-07-04 17:58:33] [config] input-types:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] interpolate-env-vars: false
[2023-07-04 17:58:33] [config] keep-best: false
[2023-07-04 17:58:33] [config] label-smoothing: 0
[2023-07-04 17:58:33] [config] layer-normalization: false
[2023-07-04 17:58:33] [config] learn-rate: 0.0001
[2023-07-04 17:58:33] [config] lemma-dependency: ""
[2023-07-04 17:58:33] [config] lemma-dim-emb: 0
[2023-07-04 17:58:33] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 17:58:33] [config] log-level: info
[2023-07-04 17:58:33] [config] log-time-zone: ""
[2023-07-04 17:58:33] [config] logical-epoch:
[2023-07-04 17:58:33] [config]   - 1e
[2023-07-04 17:58:33] [config]   - 0
[2023-07-04 17:58:33] [config] lr-decay: 0
[2023-07-04 17:58:33] [config] lr-decay-freq: 50000
[2023-07-04 17:58:33] [config] lr-decay-inv-sqrt:
[2023-07-04 17:58:33] [config]   - 0
[2023-07-04 17:58:33] [config] lr-decay-repeat-warmup: false
[2023-07-04 17:58:33] [config] lr-decay-reset-optimizer: false
[2023-07-04 17:58:33] [config] lr-decay-start:
[2023-07-04 17:58:33] [config]   - 10
[2023-07-04 17:58:33] [config]   - 1
[2023-07-04 17:58:33] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 17:58:33] [config] lr-report: false
[2023-07-04 17:58:33] [config] lr-warmup: 0
[2023-07-04 17:58:33] [config] lr-warmup-at-reload: false
[2023-07-04 17:58:33] [config] lr-warmup-cycle: false
[2023-07-04 17:58:33] [config] lr-warmup-start-rate: 0
[2023-07-04 17:58:33] [config] max-length: 50
[2023-07-04 17:58:33] [config] max-length-crop: false
[2023-07-04 17:58:33] [config] max-length-factor: 3
[2023-07-04 17:58:33] [config] maxi-batch: 100
[2023-07-04 17:58:33] [config] maxi-batch-sort: trg
[2023-07-04 17:58:33] [config] mini-batch: 64
[2023-07-04 17:58:33] [config] mini-batch-fit: false
[2023-07-04 17:58:33] [config] mini-batch-fit-step: 10
[2023-07-04 17:58:33] [config] mini-batch-round-up: true
[2023-07-04 17:58:33] [config] mini-batch-track-lr: false
[2023-07-04 17:58:33] [config] mini-batch-warmup: 0
[2023-07-04 17:58:33] [config] mini-batch-words: 0
[2023-07-04 17:58:33] [config] mini-batch-words-ref: 0
[2023-07-04 17:58:33] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 17:58:33] [config] multi-loss-type: sum
[2023-07-04 17:58:33] [config] n-best: false
[2023-07-04 17:58:33] [config] no-nccl: false
[2023-07-04 17:58:33] [config] no-reload: false
[2023-07-04 17:58:33] [config] no-restore-corpus: false
[2023-07-04 17:58:33] [config] normalize: 0
[2023-07-04 17:58:33] [config] normalize-gradient: false
[2023-07-04 17:58:33] [config] num-devices: 0
[2023-07-04 17:58:33] [config] optimizer: adam
[2023-07-04 17:58:33] [config] optimizer-delay: 1
[2023-07-04 17:58:33] [config] optimizer-params:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] output-omit-bias: false
[2023-07-04 17:58:33] [config] overwrite: true
[2023-07-04 17:58:33] [config] precision:
[2023-07-04 17:58:33] [config]   - float32
[2023-07-04 17:58:33] [config]   - float32
[2023-07-04 17:58:33] [config] pretrained-model: ""
[2023-07-04 17:58:33] [config] quantize-biases: false
[2023-07-04 17:58:33] [config] quantize-bits: 0
[2023-07-04 17:58:33] [config] quantize-log-based: false
[2023-07-04 17:58:33] [config] quantize-optimization-steps: 0
[2023-07-04 17:58:33] [config] quiet: false
[2023-07-04 17:58:33] [config] quiet-translation: true
[2023-07-04 17:58:33] [config] relative-paths: false
[2023-07-04 17:58:33] [config] right-left: false
[2023-07-04 17:58:33] [config] save-freq: 10000u
[2023-07-04 17:58:33] [config] seed: 1234
[2023-07-04 17:58:33] [config] sentencepiece-alphas:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] sentencepiece-max-lines: 2000000
[2023-07-04 17:58:33] [config] sentencepiece-options: ""
[2023-07-04 17:58:33] [config] sharding: global
[2023-07-04 17:58:33] [config] shuffle: data
[2023-07-04 17:58:33] [config] shuffle-in-ram: false
[2023-07-04 17:58:33] [config] sigterm: save-and-exit
[2023-07-04 17:58:33] [config] skip: false
[2023-07-04 17:58:33] [config] sqlite: ""
[2023-07-04 17:58:33] [config] sqlite-drop: false
[2023-07-04 17:58:33] [config] sync-freq: 200u
[2023-07-04 17:58:33] [config] sync-sgd: false
[2023-07-04 17:58:33] [config] tempdir: /tmp
[2023-07-04 17:58:33] [config] tied-embeddings: false
[2023-07-04 17:58:33] [config] tied-embeddings-all: false
[2023-07-04 17:58:33] [config] tied-embeddings-src: false
[2023-07-04 17:58:33] [config] train-embedder-rank:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] train-sets:
[2023-07-04 17:58:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 17:58:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 17:58:33] [config] transformer-aan-activation: swish
[2023-07-04 17:58:33] [config] transformer-aan-depth: 2
[2023-07-04 17:58:33] [config] transformer-aan-nogate: false
[2023-07-04 17:58:33] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 17:58:33] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 17:58:33] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 17:58:33] [config] transformer-depth-scaling: false
[2023-07-04 17:58:33] [config] transformer-dim-aan: 2048
[2023-07-04 17:58:33] [config] transformer-dim-ffn: 2048
[2023-07-04 17:58:33] [config] transformer-dropout: 0
[2023-07-04 17:58:33] [config] transformer-dropout-attention: 0
[2023-07-04 17:58:33] [config] transformer-dropout-ffn: 0
[2023-07-04 17:58:33] [config] transformer-ffn-activation: swish
[2023-07-04 17:58:33] [config] transformer-ffn-depth: 2
[2023-07-04 17:58:33] [config] transformer-guided-alignment-layer: last
[2023-07-04 17:58:33] [config] transformer-heads: 8
[2023-07-04 17:58:33] [config] transformer-no-projection: false
[2023-07-04 17:58:33] [config] transformer-pool: false
[2023-07-04 17:58:33] [config] transformer-postprocess: dan
[2023-07-04 17:58:33] [config] transformer-postprocess-emb: d
[2023-07-04 17:58:33] [config] transformer-postprocess-top: ""
[2023-07-04 17:58:33] [config] transformer-preprocess: ""
[2023-07-04 17:58:33] [config] transformer-tied-layers:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] transformer-train-position-embeddings: false
[2023-07-04 17:58:33] [config] tsv: false
[2023-07-04 17:58:33] [config] tsv-fields: 0
[2023-07-04 17:58:33] [config] type: s2s
[2023-07-04 17:58:33] [config] ulr: false
[2023-07-04 17:58:33] [config] ulr-dim-emb: 0
[2023-07-04 17:58:33] [config] ulr-dropout: 0
[2023-07-04 17:58:33] [config] ulr-keys-vectors: ""
[2023-07-04 17:58:33] [config] ulr-query-vectors: ""
[2023-07-04 17:58:33] [config] ulr-softmax-temperature: 1
[2023-07-04 17:58:33] [config] ulr-trainable-transformation: false
[2023-07-04 17:58:33] [config] unlikelihood-loss: false
[2023-07-04 17:58:33] [config] valid-freq: 50000000
[2023-07-04 17:58:33] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 17:58:33] [config] valid-max-length: 1000
[2023-07-04 17:58:33] [config] valid-metrics:
[2023-07-04 17:58:33] [config]   - cross-entropy
[2023-07-04 17:58:33] [config]   - translation
[2023-07-04 17:58:33] [config] valid-mini-batch: 32
[2023-07-04 17:58:33] [config] valid-reset-stalled: false
[2023-07-04 17:58:33] [config] valid-script-args:
[2023-07-04 17:58:33] [config]   []
[2023-07-04 17:58:33] [config] valid-script-path: ""
[2023-07-04 17:58:33] [config] valid-sets:
[2023-07-04 17:58:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 17:58:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 17:58:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 17:58:33] [config] vocabs:
[2023-07-04 17:58:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:33] [config] word-penalty: 0
[2023-07-04 17:58:33] [config] word-scores: false
[2023-07-04 17:58:33] [config] workspace: 2048
[2023-07-04 17:58:33] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 17:58:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:33] [training] Using single-device training
[2023-07-04 17:58:33] Synced seed 1234
[2023-07-04 17:58:33] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 17:58:33] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 17:58:33] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 17:58:33] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 17:58:33] [valid] No post-processing script given for validating translator
[2023-07-04 17:58:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 17:58:34] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 17:58:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 17:58:34] [comm] Using global sharding
[2023-07-04 17:58:34] [comm] NCCLCommunicators constructed successfully
[2023-07-04 17:58:34] [training] Using 1 GPUs
[2023-07-04 17:58:34] Training started
[2023-07-04 17:58:34] [data] Shuffling data
[2023-07-04 17:58:34] [data] Done reading 20,192 sentences
[2023-07-04 17:58:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:58:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 17:58:34] [logits] Applying loss function for 1 factor(s)
[2023-07-04 17:58:34] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:58:35] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 17:58:35] [memory] Reserving 377 MB, device gpu0
[2023-07-04 17:58:35] Parameter type float32, optimization type float32, casting types false
[2023-07-04 17:58:35] Allocating memory for Adam-specific shards
[2023-07-04 17:58:35] [memory] Reserving 754 MB, device gpu0
[2023-07-04 17:59:14] Seen 18,843 samples
[2023-07-04 17:59:14] Starting data epoch 2 in logical epoch 2
[2023-07-04 17:59:14] [data] Shuffling data
[2023-07-04 17:59:14] [data] Done reading 20,192 sentences
[2023-07-04 17:59:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 17:59:57] Seen 18,843 samples
[2023-07-04 17:59:57] Starting data epoch 3 in logical epoch 3
[2023-07-04 17:59:57] [data] Shuffling data
[2023-07-04 17:59:57] [data] Done reading 20,192 sentences
[2023-07-04 17:59:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:00:46] Seen 18,843 samples
[2023-07-04 18:00:46] Starting data epoch 4 in logical epoch 4
[2023-07-04 18:00:46] [data] Shuffling data
[2023-07-04 18:00:46] [data] Done reading 20,192 sentences
[2023-07-04 18:00:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:01:04] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 6.20277214 * 1,343,216 @ 768 after 1,343,216 : Time 151.11s : 8888.99 words/s : gNorm 1.2048
[2023-07-04 18:01:34] Seen 18,843 samples
[2023-07-04 18:01:34] Starting data epoch 5 in logical epoch 5
[2023-07-04 18:01:34] [data] Shuffling data
[2023-07-04 18:01:34] [data] Done reading 20,192 sentences
[2023-07-04 18:01:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:02:24] Seen 18,843 samples
[2023-07-04 18:02:24] Starting data epoch 6 in logical epoch 6
[2023-07-04 18:02:24] [data] Shuffling data
[2023-07-04 18:02:24] [data] Done reading 20,192 sentences
[2023-07-04 18:02:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:03:13] Seen 18,843 samples
[2023-07-04 18:03:13] Starting data epoch 7 in logical epoch 7
[2023-07-04 18:03:13] [data] Shuffling data
[2023-07-04 18:03:13] [data] Done reading 20,192 sentences
[2023-07-04 18:03:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:03:49] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 5.28651476 * 1,334,929 @ 2,976 after 2,678,145 : Time 164.53s : 8113.82 words/s : gNorm 1.0647
[2023-07-04 18:04:03] Seen 18,843 samples
[2023-07-04 18:04:03] Starting data epoch 8 in logical epoch 8
[2023-07-04 18:04:03] [data] Shuffling data
[2023-07-04 18:04:03] [data] Done reading 20,192 sentences
[2023-07-04 18:04:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:04:51] Seen 18,843 samples
[2023-07-04 18:04:51] Starting data epoch 9 in logical epoch 9
[2023-07-04 18:04:51] [data] Shuffling data
[2023-07-04 18:04:51] [data] Done reading 20,192 sentences
[2023-07-04 18:04:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:05:40] Seen 18,843 samples
[2023-07-04 18:05:40] Starting data epoch 10 in logical epoch 10
[2023-07-04 18:05:40] [data] Shuffling data
[2023-07-04 18:05:40] [data] Done reading 20,192 sentences
[2023-07-04 18:05:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:06:30] Seen 18,843 samples
[2023-07-04 18:06:30] Starting data epoch 11 in logical epoch 11
[2023-07-04 18:06:30] Training finished
[2023-07-04 18:06:37] [valid] Ep. 11 : Up. 2968 : cross-entropy : 108.414 : new best
[2023-07-04 18:09:03] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-04 18:09:03] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:09:06] Saving Adam parameters
[2023-07-04 18:09:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:09:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:09:20] [marian] Running on node07.datos.cluster.uy as process 38448 with command line:
[2023-07-04 18:09:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 18:09:20] [config] after: 0e
[2023-07-04 18:09:20] [config] after-batches: 0
[2023-07-04 18:09:20] [config] after-epochs: 20
[2023-07-04 18:09:20] [config] all-caps-every: 0
[2023-07-04 18:09:20] [config] allow-unk: false
[2023-07-04 18:09:20] [config] authors: false
[2023-07-04 18:09:20] [config] beam-size: 12
[2023-07-04 18:09:20] [config] bert-class-symbol: "[CLS]"
[2023-07-04 18:09:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 18:09:20] [config] bert-masking-fraction: 0.15
[2023-07-04 18:09:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 18:09:20] [config] bert-train-type-embeddings: true
[2023-07-04 18:09:20] [config] bert-type-vocab-size: 2
[2023-07-04 18:09:20] [config] build-info: ""
[2023-07-04 18:09:20] [config] check-gradient-nan: false
[2023-07-04 18:09:20] [config] check-nan: false
[2023-07-04 18:09:20] [config] cite: false
[2023-07-04 18:09:20] [config] clip-norm: 1
[2023-07-04 18:09:20] [config] cost-scaling:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] cost-type: ce-sum
[2023-07-04 18:09:20] [config] cpu-threads: 0
[2023-07-04 18:09:20] [config] data-threads: 8
[2023-07-04 18:09:20] [config] data-weighting: ""
[2023-07-04 18:09:20] [config] data-weighting-type: sentence
[2023-07-04 18:09:20] [config] dec-cell: gru
[2023-07-04 18:09:20] [config] dec-cell-base-depth: 2
[2023-07-04 18:09:20] [config] dec-cell-high-depth: 1
[2023-07-04 18:09:20] [config] dec-depth: 1
[2023-07-04 18:09:20] [config] devices:
[2023-07-04 18:09:20] [config]   - 0
[2023-07-04 18:09:20] [config] dim-emb: 512
[2023-07-04 18:09:20] [config] dim-rnn: 1024
[2023-07-04 18:09:20] [config] dim-vocabs:
[2023-07-04 18:09:20] [config]   - 54042
[2023-07-04 18:09:20] [config]   - 36507
[2023-07-04 18:09:20] [config] disp-first: 0
[2023-07-04 18:09:20] [config] disp-freq: 1000u
[2023-07-04 18:09:20] [config] disp-label-counts: true
[2023-07-04 18:09:20] [config] dropout-rnn: 0
[2023-07-04 18:09:20] [config] dropout-src: 0
[2023-07-04 18:09:20] [config] dropout-trg: 0
[2023-07-04 18:09:20] [config] dump-config: ""
[2023-07-04 18:09:20] [config] dynamic-gradient-scaling:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] early-stopping: 10
[2023-07-04 18:09:20] [config] early-stopping-on: first
[2023-07-04 18:09:20] [config] embedding-fix-src: false
[2023-07-04 18:09:20] [config] embedding-fix-trg: false
[2023-07-04 18:09:20] [config] embedding-normalization: false
[2023-07-04 18:09:20] [config] embedding-vectors:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] enc-cell: gru
[2023-07-04 18:09:20] [config] enc-cell-depth: 1
[2023-07-04 18:09:20] [config] enc-depth: 1
[2023-07-04 18:09:20] [config] enc-type: bidirectional
[2023-07-04 18:09:20] [config] english-title-case-every: 0
[2023-07-04 18:09:20] [config] exponential-smoothing: 0
[2023-07-04 18:09:20] [config] factor-weight: 1
[2023-07-04 18:09:20] [config] factors-combine: sum
[2023-07-04 18:09:20] [config] factors-dim-emb: 0
[2023-07-04 18:09:20] [config] gradient-checkpointing: false
[2023-07-04 18:09:20] [config] gradient-norm-average-window: 100
[2023-07-04 18:09:20] [config] guided-alignment: none
[2023-07-04 18:09:20] [config] guided-alignment-cost: mse
[2023-07-04 18:09:20] [config] guided-alignment-weight: 0.1
[2023-07-04 18:09:20] [config] ignore-model-config: false
[2023-07-04 18:09:20] [config] input-types:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] interpolate-env-vars: false
[2023-07-04 18:09:20] [config] keep-best: false
[2023-07-04 18:09:20] [config] label-smoothing: 0
[2023-07-04 18:09:20] [config] layer-normalization: false
[2023-07-04 18:09:20] [config] learn-rate: 0.0001
[2023-07-04 18:09:20] [config] lemma-dependency: ""
[2023-07-04 18:09:20] [config] lemma-dim-emb: 0
[2023-07-04 18:09:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 18:09:20] [config] log-level: info
[2023-07-04 18:09:20] [config] log-time-zone: ""
[2023-07-04 18:09:20] [config] logical-epoch:
[2023-07-04 18:09:20] [config]   - 1e
[2023-07-04 18:09:20] [config]   - 0
[2023-07-04 18:09:20] [config] lr-decay: 0
[2023-07-04 18:09:20] [config] lr-decay-freq: 50000
[2023-07-04 18:09:20] [config] lr-decay-inv-sqrt:
[2023-07-04 18:09:20] [config]   - 0
[2023-07-04 18:09:20] [config] lr-decay-repeat-warmup: false
[2023-07-04 18:09:20] [config] lr-decay-reset-optimizer: false
[2023-07-04 18:09:20] [config] lr-decay-start:
[2023-07-04 18:09:20] [config]   - 10
[2023-07-04 18:09:20] [config]   - 1
[2023-07-04 18:09:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 18:09:20] [config] lr-report: false
[2023-07-04 18:09:20] [config] lr-warmup: 0
[2023-07-04 18:09:20] [config] lr-warmup-at-reload: false
[2023-07-04 18:09:20] [config] lr-warmup-cycle: false
[2023-07-04 18:09:20] [config] lr-warmup-start-rate: 0
[2023-07-04 18:09:20] [config] max-length: 50
[2023-07-04 18:09:20] [config] max-length-crop: false
[2023-07-04 18:09:20] [config] max-length-factor: 3
[2023-07-04 18:09:20] [config] maxi-batch: 100
[2023-07-04 18:09:20] [config] maxi-batch-sort: trg
[2023-07-04 18:09:20] [config] mini-batch: 64
[2023-07-04 18:09:20] [config] mini-batch-fit: false
[2023-07-04 18:09:20] [config] mini-batch-fit-step: 10
[2023-07-04 18:09:20] [config] mini-batch-round-up: true
[2023-07-04 18:09:20] [config] mini-batch-track-lr: false
[2023-07-04 18:09:20] [config] mini-batch-warmup: 0
[2023-07-04 18:09:20] [config] mini-batch-words: 0
[2023-07-04 18:09:20] [config] mini-batch-words-ref: 0
[2023-07-04 18:09:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:09:20] [config] multi-loss-type: sum
[2023-07-04 18:09:20] [config] n-best: false
[2023-07-04 18:09:20] [config] no-nccl: false
[2023-07-04 18:09:20] [config] no-reload: false
[2023-07-04 18:09:20] [config] no-restore-corpus: false
[2023-07-04 18:09:20] [config] normalize: 0
[2023-07-04 18:09:20] [config] normalize-gradient: false
[2023-07-04 18:09:20] [config] num-devices: 0
[2023-07-04 18:09:20] [config] optimizer: adam
[2023-07-04 18:09:20] [config] optimizer-delay: 1
[2023-07-04 18:09:20] [config] optimizer-params:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] output-omit-bias: false
[2023-07-04 18:09:20] [config] overwrite: true
[2023-07-04 18:09:20] [config] precision:
[2023-07-04 18:09:20] [config]   - float32
[2023-07-04 18:09:20] [config]   - float32
[2023-07-04 18:09:20] [config] pretrained-model: ""
[2023-07-04 18:09:20] [config] quantize-biases: false
[2023-07-04 18:09:20] [config] quantize-bits: 0
[2023-07-04 18:09:20] [config] quantize-log-based: false
[2023-07-04 18:09:20] [config] quantize-optimization-steps: 0
[2023-07-04 18:09:20] [config] quiet: false
[2023-07-04 18:09:20] [config] quiet-translation: true
[2023-07-04 18:09:20] [config] relative-paths: false
[2023-07-04 18:09:20] [config] right-left: false
[2023-07-04 18:09:20] [config] save-freq: 10000u
[2023-07-04 18:09:20] [config] seed: 1234
[2023-07-04 18:09:20] [config] sentencepiece-alphas:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] sentencepiece-max-lines: 2000000
[2023-07-04 18:09:20] [config] sentencepiece-options: ""
[2023-07-04 18:09:20] [config] sharding: global
[2023-07-04 18:09:20] [config] shuffle: data
[2023-07-04 18:09:20] [config] shuffle-in-ram: false
[2023-07-04 18:09:20] [config] sigterm: save-and-exit
[2023-07-04 18:09:20] [config] skip: false
[2023-07-04 18:09:20] [config] sqlite: ""
[2023-07-04 18:09:20] [config] sqlite-drop: false
[2023-07-04 18:09:20] [config] sync-freq: 200u
[2023-07-04 18:09:20] [config] sync-sgd: false
[2023-07-04 18:09:20] [config] tempdir: /tmp
[2023-07-04 18:09:20] [config] tied-embeddings: false
[2023-07-04 18:09:20] [config] tied-embeddings-all: false
[2023-07-04 18:09:20] [config] tied-embeddings-src: false
[2023-07-04 18:09:20] [config] train-embedder-rank:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] train-sets:
[2023-07-04 18:09:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 18:09:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 18:09:20] [config] transformer-aan-activation: swish
[2023-07-04 18:09:20] [config] transformer-aan-depth: 2
[2023-07-04 18:09:20] [config] transformer-aan-nogate: false
[2023-07-04 18:09:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 18:09:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 18:09:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 18:09:20] [config] transformer-depth-scaling: false
[2023-07-04 18:09:20] [config] transformer-dim-aan: 2048
[2023-07-04 18:09:20] [config] transformer-dim-ffn: 2048
[2023-07-04 18:09:20] [config] transformer-dropout: 0
[2023-07-04 18:09:20] [config] transformer-dropout-attention: 0
[2023-07-04 18:09:20] [config] transformer-dropout-ffn: 0
[2023-07-04 18:09:20] [config] transformer-ffn-activation: swish
[2023-07-04 18:09:20] [config] transformer-ffn-depth: 2
[2023-07-04 18:09:20] [config] transformer-guided-alignment-layer: last
[2023-07-04 18:09:20] [config] transformer-heads: 8
[2023-07-04 18:09:20] [config] transformer-no-projection: false
[2023-07-04 18:09:20] [config] transformer-pool: false
[2023-07-04 18:09:20] [config] transformer-postprocess: dan
[2023-07-04 18:09:20] [config] transformer-postprocess-emb: d
[2023-07-04 18:09:20] [config] transformer-postprocess-top: ""
[2023-07-04 18:09:20] [config] transformer-preprocess: ""
[2023-07-04 18:09:20] [config] transformer-tied-layers:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] transformer-train-position-embeddings: false
[2023-07-04 18:09:20] [config] tsv: false
[2023-07-04 18:09:20] [config] tsv-fields: 0
[2023-07-04 18:09:20] [config] type: s2s
[2023-07-04 18:09:20] [config] ulr: false
[2023-07-04 18:09:20] [config] ulr-dim-emb: 0
[2023-07-04 18:09:20] [config] ulr-dropout: 0
[2023-07-04 18:09:20] [config] ulr-keys-vectors: ""
[2023-07-04 18:09:20] [config] ulr-query-vectors: ""
[2023-07-04 18:09:20] [config] ulr-softmax-temperature: 1
[2023-07-04 18:09:20] [config] ulr-trainable-transformation: false
[2023-07-04 18:09:20] [config] unlikelihood-loss: false
[2023-07-04 18:09:20] [config] valid-freq: 50000000
[2023-07-04 18:09:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 18:09:20] [config] valid-max-length: 1000
[2023-07-04 18:09:20] [config] valid-metrics:
[2023-07-04 18:09:20] [config]   - cross-entropy
[2023-07-04 18:09:20] [config]   - translation
[2023-07-04 18:09:20] [config] valid-mini-batch: 32
[2023-07-04 18:09:20] [config] valid-reset-stalled: false
[2023-07-04 18:09:20] [config] valid-script-args:
[2023-07-04 18:09:20] [config]   []
[2023-07-04 18:09:20] [config] valid-script-path: ""
[2023-07-04 18:09:20] [config] valid-sets:
[2023-07-04 18:09:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 18:09:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 18:09:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 18:09:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:09:20] [config] vocabs:
[2023-07-04 18:09:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:09:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:09:20] [config] word-penalty: 0
[2023-07-04 18:09:20] [config] word-scores: false
[2023-07-04 18:09:20] [config] workspace: 2048
[2023-07-04 18:09:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:09:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:09:20] [training] Using single-device training
[2023-07-04 18:09:20] Synced seed 1234
[2023-07-04 18:09:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:09:20] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 18:09:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:09:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 18:09:21] [valid] No post-processing script given for validating translator
[2023-07-04 18:09:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:09:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 18:09:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 18:09:21] [comm] Using global sharding
[2023-07-04 18:09:22] [comm] NCCLCommunicators constructed successfully
[2023-07-04 18:09:22] [training] Using 1 GPUs
[2023-07-04 18:09:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:09:24] Loading Adam parameters
[2023-07-04 18:09:24] [memory] Reserving 754 MB, device gpu0
[2023-07-04 18:09:25] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:09:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:09:25] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-04 18:09:25] [data] Shuffling data
[2023-07-04 18:09:25] [data] Done reading 20,192 sentences
[2023-07-04 18:09:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:09:25] Training started
[2023-07-04 18:09:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 18:09:25] [logits] Applying loss function for 1 factor(s)
[2023-07-04 18:09:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 18:09:25] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:09:25] Parameter type float32, optimization type float32, casting types false
[2023-07-04 18:09:29] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 4.78848934 * 1,343,919 @ 1,536 after 4,022,064 : Time 8.71s : 154337.37 words/s : gNorm 1.0250
[2023-07-04 18:10:09] Seen 18,843 samples
[2023-07-04 18:10:09] Starting data epoch 12 in logical epoch 12
[2023-07-04 18:10:09] [data] Shuffling data
[2023-07-04 18:10:09] [data] Done reading 20,192 sentences
[2023-07-04 18:10:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:10:59] Seen 18,843 samples
[2023-07-04 18:10:59] Starting data epoch 13 in logical epoch 13
[2023-07-04 18:10:59] [data] Shuffling data
[2023-07-04 18:10:59] [data] Done reading 20,192 sentences
[2023-07-04 18:10:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:11:47] Seen 18,843 samples
[2023-07-04 18:11:47] Starting data epoch 14 in logical epoch 14
[2023-07-04 18:11:47] [data] Shuffling data
[2023-07-04 18:11:48] [data] Done reading 20,192 sentences
[2023-07-04 18:11:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:12:12] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 4.41260529 * 1,354,393 @ 2,176 after 5,376,457 : Time 163.03s : 8307.83 words/s : gNorm 1.1056
[2023-07-04 18:12:38] Seen 18,843 samples
[2023-07-04 18:12:38] Starting data epoch 15 in logical epoch 15
[2023-07-04 18:12:38] [data] Shuffling data
[2023-07-04 18:12:38] [data] Done reading 20,192 sentences
[2023-07-04 18:12:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:13:27] Seen 18,843 samples
[2023-07-04 18:13:27] Starting data epoch 16 in logical epoch 16
[2023-07-04 18:13:27] [data] Shuffling data
[2023-07-04 18:13:27] [data] Done reading 20,192 sentences
[2023-07-04 18:13:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:14:16] Seen 18,843 samples
[2023-07-04 18:14:16] Starting data epoch 17 in logical epoch 17
[2023-07-04 18:14:16] [data] Shuffling data
[2023-07-04 18:14:16] [data] Done reading 20,192 sentences
[2023-07-04 18:14:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:15:00] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 4.09583569 * 1,331,522 @ 1,216 after 6,707,979 : Time 167.51s : 7948.94 words/s : gNorm 1.2028
[2023-07-04 18:15:07] Seen 18,843 samples
[2023-07-04 18:15:07] Starting data epoch 18 in logical epoch 18
[2023-07-04 18:15:07] [data] Shuffling data
[2023-07-04 18:15:08] [data] Done reading 20,192 sentences
[2023-07-04 18:15:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:15:57] Seen 18,843 samples
[2023-07-04 18:15:57] Starting data epoch 19 in logical epoch 19
[2023-07-04 18:15:57] [data] Shuffling data
[2023-07-04 18:15:57] [data] Done reading 20,192 sentences
[2023-07-04 18:15:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:16:46] Seen 18,843 samples
[2023-07-04 18:16:46] Starting data epoch 20 in logical epoch 20
[2023-07-04 18:16:46] [data] Shuffling data
[2023-07-04 18:16:46] [data] Done reading 20,192 sentences
[2023-07-04 18:16:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:17:35] Seen 18,843 samples
[2023-07-04 18:17:35] Starting data epoch 21 in logical epoch 21
[2023-07-04 18:17:35] Training finished
[2023-07-04 18:17:42] [valid] Ep. 21 : Up. 5933 : cross-entropy : 110.219 : stalled 1 times (last best: 108.414)
[2023-07-04 18:20:04] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-07-04 18:20:04] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:20:08] Saving Adam parameters
[2023-07-04 18:20:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:20:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:20:29] [marian] Running on node07.datos.cluster.uy as process 39485 with command line:
[2023-07-04 18:20:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 18:20:29] [config] after: 0e
[2023-07-04 18:20:29] [config] after-batches: 0
[2023-07-04 18:20:29] [config] after-epochs: 30
[2023-07-04 18:20:29] [config] all-caps-every: 0
[2023-07-04 18:20:29] [config] allow-unk: false
[2023-07-04 18:20:29] [config] authors: false
[2023-07-04 18:20:29] [config] beam-size: 12
[2023-07-04 18:20:29] [config] bert-class-symbol: "[CLS]"
[2023-07-04 18:20:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 18:20:29] [config] bert-masking-fraction: 0.15
[2023-07-04 18:20:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 18:20:29] [config] bert-train-type-embeddings: true
[2023-07-04 18:20:29] [config] bert-type-vocab-size: 2
[2023-07-04 18:20:29] [config] build-info: ""
[2023-07-04 18:20:29] [config] check-gradient-nan: false
[2023-07-04 18:20:29] [config] check-nan: false
[2023-07-04 18:20:29] [config] cite: false
[2023-07-04 18:20:29] [config] clip-norm: 1
[2023-07-04 18:20:29] [config] cost-scaling:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] cost-type: ce-sum
[2023-07-04 18:20:29] [config] cpu-threads: 0
[2023-07-04 18:20:29] [config] data-threads: 8
[2023-07-04 18:20:29] [config] data-weighting: ""
[2023-07-04 18:20:29] [config] data-weighting-type: sentence
[2023-07-04 18:20:29] [config] dec-cell: gru
[2023-07-04 18:20:29] [config] dec-cell-base-depth: 2
[2023-07-04 18:20:29] [config] dec-cell-high-depth: 1
[2023-07-04 18:20:29] [config] dec-depth: 1
[2023-07-04 18:20:29] [config] devices:
[2023-07-04 18:20:29] [config]   - 0
[2023-07-04 18:20:29] [config] dim-emb: 512
[2023-07-04 18:20:29] [config] dim-rnn: 1024
[2023-07-04 18:20:29] [config] dim-vocabs:
[2023-07-04 18:20:29] [config]   - 54042
[2023-07-04 18:20:29] [config]   - 36507
[2023-07-04 18:20:29] [config] disp-first: 0
[2023-07-04 18:20:29] [config] disp-freq: 1000u
[2023-07-04 18:20:29] [config] disp-label-counts: true
[2023-07-04 18:20:29] [config] dropout-rnn: 0
[2023-07-04 18:20:29] [config] dropout-src: 0
[2023-07-04 18:20:29] [config] dropout-trg: 0
[2023-07-04 18:20:29] [config] dump-config: ""
[2023-07-04 18:20:29] [config] dynamic-gradient-scaling:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] early-stopping: 10
[2023-07-04 18:20:29] [config] early-stopping-on: first
[2023-07-04 18:20:29] [config] embedding-fix-src: false
[2023-07-04 18:20:29] [config] embedding-fix-trg: false
[2023-07-04 18:20:29] [config] embedding-normalization: false
[2023-07-04 18:20:29] [config] embedding-vectors:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] enc-cell: gru
[2023-07-04 18:20:29] [config] enc-cell-depth: 1
[2023-07-04 18:20:29] [config] enc-depth: 1
[2023-07-04 18:20:29] [config] enc-type: bidirectional
[2023-07-04 18:20:29] [config] english-title-case-every: 0
[2023-07-04 18:20:29] [config] exponential-smoothing: 0
[2023-07-04 18:20:29] [config] factor-weight: 1
[2023-07-04 18:20:29] [config] factors-combine: sum
[2023-07-04 18:20:29] [config] factors-dim-emb: 0
[2023-07-04 18:20:29] [config] gradient-checkpointing: false
[2023-07-04 18:20:29] [config] gradient-norm-average-window: 100
[2023-07-04 18:20:29] [config] guided-alignment: none
[2023-07-04 18:20:29] [config] guided-alignment-cost: mse
[2023-07-04 18:20:29] [config] guided-alignment-weight: 0.1
[2023-07-04 18:20:29] [config] ignore-model-config: false
[2023-07-04 18:20:29] [config] input-types:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] interpolate-env-vars: false
[2023-07-04 18:20:29] [config] keep-best: false
[2023-07-04 18:20:29] [config] label-smoothing: 0
[2023-07-04 18:20:29] [config] layer-normalization: false
[2023-07-04 18:20:29] [config] learn-rate: 0.0001
[2023-07-04 18:20:29] [config] lemma-dependency: ""
[2023-07-04 18:20:29] [config] lemma-dim-emb: 0
[2023-07-04 18:20:29] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 18:20:29] [config] log-level: info
[2023-07-04 18:20:29] [config] log-time-zone: ""
[2023-07-04 18:20:29] [config] logical-epoch:
[2023-07-04 18:20:29] [config]   - 1e
[2023-07-04 18:20:29] [config]   - 0
[2023-07-04 18:20:29] [config] lr-decay: 0
[2023-07-04 18:20:29] [config] lr-decay-freq: 50000
[2023-07-04 18:20:29] [config] lr-decay-inv-sqrt:
[2023-07-04 18:20:29] [config]   - 0
[2023-07-04 18:20:29] [config] lr-decay-repeat-warmup: false
[2023-07-04 18:20:29] [config] lr-decay-reset-optimizer: false
[2023-07-04 18:20:29] [config] lr-decay-start:
[2023-07-04 18:20:29] [config]   - 10
[2023-07-04 18:20:29] [config]   - 1
[2023-07-04 18:20:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 18:20:29] [config] lr-report: false
[2023-07-04 18:20:29] [config] lr-warmup: 0
[2023-07-04 18:20:29] [config] lr-warmup-at-reload: false
[2023-07-04 18:20:29] [config] lr-warmup-cycle: false
[2023-07-04 18:20:29] [config] lr-warmup-start-rate: 0
[2023-07-04 18:20:29] [config] max-length: 50
[2023-07-04 18:20:29] [config] max-length-crop: false
[2023-07-04 18:20:29] [config] max-length-factor: 3
[2023-07-04 18:20:29] [config] maxi-batch: 100
[2023-07-04 18:20:29] [config] maxi-batch-sort: trg
[2023-07-04 18:20:29] [config] mini-batch: 64
[2023-07-04 18:20:29] [config] mini-batch-fit: false
[2023-07-04 18:20:29] [config] mini-batch-fit-step: 10
[2023-07-04 18:20:29] [config] mini-batch-round-up: true
[2023-07-04 18:20:29] [config] mini-batch-track-lr: false
[2023-07-04 18:20:29] [config] mini-batch-warmup: 0
[2023-07-04 18:20:29] [config] mini-batch-words: 0
[2023-07-04 18:20:29] [config] mini-batch-words-ref: 0
[2023-07-04 18:20:29] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:20:29] [config] multi-loss-type: sum
[2023-07-04 18:20:29] [config] n-best: false
[2023-07-04 18:20:29] [config] no-nccl: false
[2023-07-04 18:20:29] [config] no-reload: false
[2023-07-04 18:20:29] [config] no-restore-corpus: false
[2023-07-04 18:20:29] [config] normalize: 0
[2023-07-04 18:20:29] [config] normalize-gradient: false
[2023-07-04 18:20:29] [config] num-devices: 0
[2023-07-04 18:20:29] [config] optimizer: adam
[2023-07-04 18:20:29] [config] optimizer-delay: 1
[2023-07-04 18:20:29] [config] optimizer-params:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] output-omit-bias: false
[2023-07-04 18:20:29] [config] overwrite: true
[2023-07-04 18:20:29] [config] precision:
[2023-07-04 18:20:29] [config]   - float32
[2023-07-04 18:20:29] [config]   - float32
[2023-07-04 18:20:29] [config] pretrained-model: ""
[2023-07-04 18:20:29] [config] quantize-biases: false
[2023-07-04 18:20:29] [config] quantize-bits: 0
[2023-07-04 18:20:29] [config] quantize-log-based: false
[2023-07-04 18:20:29] [config] quantize-optimization-steps: 0
[2023-07-04 18:20:29] [config] quiet: false
[2023-07-04 18:20:29] [config] quiet-translation: true
[2023-07-04 18:20:29] [config] relative-paths: false
[2023-07-04 18:20:29] [config] right-left: false
[2023-07-04 18:20:29] [config] save-freq: 10000u
[2023-07-04 18:20:29] [config] seed: 1234
[2023-07-04 18:20:29] [config] sentencepiece-alphas:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] sentencepiece-max-lines: 2000000
[2023-07-04 18:20:29] [config] sentencepiece-options: ""
[2023-07-04 18:20:29] [config] sharding: global
[2023-07-04 18:20:29] [config] shuffle: data
[2023-07-04 18:20:29] [config] shuffle-in-ram: false
[2023-07-04 18:20:29] [config] sigterm: save-and-exit
[2023-07-04 18:20:29] [config] skip: false
[2023-07-04 18:20:29] [config] sqlite: ""
[2023-07-04 18:20:29] [config] sqlite-drop: false
[2023-07-04 18:20:29] [config] sync-freq: 200u
[2023-07-04 18:20:29] [config] sync-sgd: false
[2023-07-04 18:20:29] [config] tempdir: /tmp
[2023-07-04 18:20:29] [config] tied-embeddings: false
[2023-07-04 18:20:29] [config] tied-embeddings-all: false
[2023-07-04 18:20:29] [config] tied-embeddings-src: false
[2023-07-04 18:20:29] [config] train-embedder-rank:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] train-sets:
[2023-07-04 18:20:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 18:20:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 18:20:29] [config] transformer-aan-activation: swish
[2023-07-04 18:20:29] [config] transformer-aan-depth: 2
[2023-07-04 18:20:29] [config] transformer-aan-nogate: false
[2023-07-04 18:20:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 18:20:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 18:20:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 18:20:29] [config] transformer-depth-scaling: false
[2023-07-04 18:20:29] [config] transformer-dim-aan: 2048
[2023-07-04 18:20:29] [config] transformer-dim-ffn: 2048
[2023-07-04 18:20:29] [config] transformer-dropout: 0
[2023-07-04 18:20:29] [config] transformer-dropout-attention: 0
[2023-07-04 18:20:29] [config] transformer-dropout-ffn: 0
[2023-07-04 18:20:29] [config] transformer-ffn-activation: swish
[2023-07-04 18:20:29] [config] transformer-ffn-depth: 2
[2023-07-04 18:20:29] [config] transformer-guided-alignment-layer: last
[2023-07-04 18:20:29] [config] transformer-heads: 8
[2023-07-04 18:20:29] [config] transformer-no-projection: false
[2023-07-04 18:20:29] [config] transformer-pool: false
[2023-07-04 18:20:29] [config] transformer-postprocess: dan
[2023-07-04 18:20:29] [config] transformer-postprocess-emb: d
[2023-07-04 18:20:29] [config] transformer-postprocess-top: ""
[2023-07-04 18:20:29] [config] transformer-preprocess: ""
[2023-07-04 18:20:29] [config] transformer-tied-layers:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] transformer-train-position-embeddings: false
[2023-07-04 18:20:29] [config] tsv: false
[2023-07-04 18:20:29] [config] tsv-fields: 0
[2023-07-04 18:20:29] [config] type: s2s
[2023-07-04 18:20:29] [config] ulr: false
[2023-07-04 18:20:29] [config] ulr-dim-emb: 0
[2023-07-04 18:20:29] [config] ulr-dropout: 0
[2023-07-04 18:20:29] [config] ulr-keys-vectors: ""
[2023-07-04 18:20:29] [config] ulr-query-vectors: ""
[2023-07-04 18:20:29] [config] ulr-softmax-temperature: 1
[2023-07-04 18:20:29] [config] ulr-trainable-transformation: false
[2023-07-04 18:20:29] [config] unlikelihood-loss: false
[2023-07-04 18:20:29] [config] valid-freq: 50000000
[2023-07-04 18:20:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 18:20:29] [config] valid-max-length: 1000
[2023-07-04 18:20:29] [config] valid-metrics:
[2023-07-04 18:20:29] [config]   - cross-entropy
[2023-07-04 18:20:29] [config]   - translation
[2023-07-04 18:20:29] [config] valid-mini-batch: 32
[2023-07-04 18:20:29] [config] valid-reset-stalled: false
[2023-07-04 18:20:29] [config] valid-script-args:
[2023-07-04 18:20:29] [config]   []
[2023-07-04 18:20:29] [config] valid-script-path: ""
[2023-07-04 18:20:29] [config] valid-sets:
[2023-07-04 18:20:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 18:20:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 18:20:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 18:20:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:20:29] [config] vocabs:
[2023-07-04 18:20:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:20:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:20:29] [config] word-penalty: 0
[2023-07-04 18:20:29] [config] word-scores: false
[2023-07-04 18:20:29] [config] workspace: 2048
[2023-07-04 18:20:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:20:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:20:29] [training] Using single-device training
[2023-07-04 18:20:29] Synced seed 1234
[2023-07-04 18:20:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:20:29] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 18:20:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:20:29] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 18:20:29] [valid] No post-processing script given for validating translator
[2023-07-04 18:20:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:20:30] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 18:20:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 18:20:31] [comm] Using global sharding
[2023-07-04 18:20:31] [comm] NCCLCommunicators constructed successfully
[2023-07-04 18:20:31] [training] Using 1 GPUs
[2023-07-04 18:20:31] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:20:33] Loading Adam parameters
[2023-07-04 18:20:33] [memory] Reserving 754 MB, device gpu0
[2023-07-04 18:20:33] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:20:34] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:20:34] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-07-04 18:20:34] [data] Shuffling data
[2023-07-04 18:20:34] [data] Done reading 20,192 sentences
[2023-07-04 18:20:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:20:34] Training started
[2023-07-04 18:20:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 18:20:34] [logits] Applying loss function for 1 factor(s)
[2023-07-04 18:20:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 18:20:34] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:20:34] Parameter type float32, optimization type float32, casting types false
[2023-07-04 18:20:43] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 3.82216907 * 1,344,567 @ 1,231 after 8,052,546 : Time 13.70s : 98135.70 words/s : gNorm 1.1647
[2023-07-04 18:21:17] Seen 18,843 samples
[2023-07-04 18:21:17] Starting data epoch 22 in logical epoch 22
[2023-07-04 18:21:17] [data] Shuffling data
[2023-07-04 18:21:17] [data] Done reading 20,192 sentences
[2023-07-04 18:21:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:22:05] Seen 18,843 samples
[2023-07-04 18:22:05] Starting data epoch 23 in logical epoch 23
[2023-07-04 18:22:05] [data] Shuffling data
[2023-07-04 18:22:05] [data] Done reading 20,192 sentences
[2023-07-04 18:22:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:22:55] Seen 18,843 samples
[2023-07-04 18:22:55] Starting data epoch 24 in logical epoch 24
[2023-07-04 18:22:55] [data] Shuffling data
[2023-07-04 18:22:55] [data] Done reading 20,192 sentences
[2023-07-04 18:22:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:23:24] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 3.55839252 * 1,339,673 @ 704 after 9,392,219 : Time 161.25s : 8308.16 words/s : gNorm 1.2761
[2023-07-04 18:23:44] Seen 18,843 samples
[2023-07-04 18:23:44] Starting data epoch 25 in logical epoch 25
[2023-07-04 18:23:44] [data] Shuffling data
[2023-07-04 18:23:44] [data] Done reading 20,192 sentences
[2023-07-04 18:23:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:24:33] Seen 18,843 samples
[2023-07-04 18:24:33] Starting data epoch 26 in logical epoch 26
[2023-07-04 18:24:33] [data] Shuffling data
[2023-07-04 18:24:33] [data] Done reading 20,192 sentences
[2023-07-04 18:24:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:25:23] Seen 18,843 samples
[2023-07-04 18:25:23] Starting data epoch 27 in logical epoch 27
[2023-07-04 18:25:23] [data] Shuffling data
[2023-07-04 18:25:23] [data] Done reading 20,192 sentences
[2023-07-04 18:25:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:26:10] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 3.32711530 * 1,339,074 @ 1,034 after 10,731,293 : Time 165.86s : 8073.35 words/s : gNorm 1.3938
[2023-07-04 18:26:12] Seen 18,843 samples
[2023-07-04 18:26:12] Starting data epoch 28 in logical epoch 28
[2023-07-04 18:26:12] [data] Shuffling data
[2023-07-04 18:26:12] [data] Done reading 20,192 sentences
[2023-07-04 18:26:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:27:02] Seen 18,843 samples
[2023-07-04 18:27:02] Starting data epoch 29 in logical epoch 29
[2023-07-04 18:27:02] [data] Shuffling data
[2023-07-04 18:27:02] [data] Done reading 20,192 sentences
[2023-07-04 18:27:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:27:51] Seen 18,843 samples
[2023-07-04 18:27:51] Starting data epoch 30 in logical epoch 30
[2023-07-04 18:27:51] [data] Shuffling data
[2023-07-04 18:27:51] [data] Done reading 20,192 sentences
[2023-07-04 18:27:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:28:42] Seen 18,843 samples
[2023-07-04 18:28:42] Starting data epoch 31 in logical epoch 31
[2023-07-04 18:28:42] Training finished
[2023-07-04 18:28:48] [valid] Ep. 31 : Up. 8898 : cross-entropy : 121.467 : stalled 2 times (last best: 108.414)
[2023-07-04 18:30:57] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-07-04 18:30:57] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:31:01] Saving Adam parameters
[2023-07-04 18:31:02] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:31:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:31:16] [marian] Running on node07.datos.cluster.uy as process 40335 with command line:
[2023-07-04 18:31:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 18:31:16] [config] after: 0e
[2023-07-04 18:31:16] [config] after-batches: 0
[2023-07-04 18:31:16] [config] after-epochs: 40
[2023-07-04 18:31:16] [config] all-caps-every: 0
[2023-07-04 18:31:16] [config] allow-unk: false
[2023-07-04 18:31:16] [config] authors: false
[2023-07-04 18:31:16] [config] beam-size: 12
[2023-07-04 18:31:16] [config] bert-class-symbol: "[CLS]"
[2023-07-04 18:31:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 18:31:16] [config] bert-masking-fraction: 0.15
[2023-07-04 18:31:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 18:31:16] [config] bert-train-type-embeddings: true
[2023-07-04 18:31:16] [config] bert-type-vocab-size: 2
[2023-07-04 18:31:16] [config] build-info: ""
[2023-07-04 18:31:16] [config] check-gradient-nan: false
[2023-07-04 18:31:16] [config] check-nan: false
[2023-07-04 18:31:16] [config] cite: false
[2023-07-04 18:31:16] [config] clip-norm: 1
[2023-07-04 18:31:16] [config] cost-scaling:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] cost-type: ce-sum
[2023-07-04 18:31:16] [config] cpu-threads: 0
[2023-07-04 18:31:16] [config] data-threads: 8
[2023-07-04 18:31:16] [config] data-weighting: ""
[2023-07-04 18:31:16] [config] data-weighting-type: sentence
[2023-07-04 18:31:16] [config] dec-cell: gru
[2023-07-04 18:31:16] [config] dec-cell-base-depth: 2
[2023-07-04 18:31:16] [config] dec-cell-high-depth: 1
[2023-07-04 18:31:16] [config] dec-depth: 1
[2023-07-04 18:31:16] [config] devices:
[2023-07-04 18:31:16] [config]   - 0
[2023-07-04 18:31:16] [config] dim-emb: 512
[2023-07-04 18:31:16] [config] dim-rnn: 1024
[2023-07-04 18:31:16] [config] dim-vocabs:
[2023-07-04 18:31:16] [config]   - 54042
[2023-07-04 18:31:16] [config]   - 36507
[2023-07-04 18:31:16] [config] disp-first: 0
[2023-07-04 18:31:16] [config] disp-freq: 1000u
[2023-07-04 18:31:16] [config] disp-label-counts: true
[2023-07-04 18:31:16] [config] dropout-rnn: 0
[2023-07-04 18:31:16] [config] dropout-src: 0
[2023-07-04 18:31:16] [config] dropout-trg: 0
[2023-07-04 18:31:16] [config] dump-config: ""
[2023-07-04 18:31:16] [config] dynamic-gradient-scaling:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] early-stopping: 10
[2023-07-04 18:31:16] [config] early-stopping-on: first
[2023-07-04 18:31:16] [config] embedding-fix-src: false
[2023-07-04 18:31:16] [config] embedding-fix-trg: false
[2023-07-04 18:31:16] [config] embedding-normalization: false
[2023-07-04 18:31:16] [config] embedding-vectors:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] enc-cell: gru
[2023-07-04 18:31:16] [config] enc-cell-depth: 1
[2023-07-04 18:31:16] [config] enc-depth: 1
[2023-07-04 18:31:16] [config] enc-type: bidirectional
[2023-07-04 18:31:16] [config] english-title-case-every: 0
[2023-07-04 18:31:16] [config] exponential-smoothing: 0
[2023-07-04 18:31:16] [config] factor-weight: 1
[2023-07-04 18:31:16] [config] factors-combine: sum
[2023-07-04 18:31:16] [config] factors-dim-emb: 0
[2023-07-04 18:31:16] [config] gradient-checkpointing: false
[2023-07-04 18:31:16] [config] gradient-norm-average-window: 100
[2023-07-04 18:31:16] [config] guided-alignment: none
[2023-07-04 18:31:16] [config] guided-alignment-cost: mse
[2023-07-04 18:31:16] [config] guided-alignment-weight: 0.1
[2023-07-04 18:31:16] [config] ignore-model-config: false
[2023-07-04 18:31:16] [config] input-types:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] interpolate-env-vars: false
[2023-07-04 18:31:16] [config] keep-best: false
[2023-07-04 18:31:16] [config] label-smoothing: 0
[2023-07-04 18:31:16] [config] layer-normalization: false
[2023-07-04 18:31:16] [config] learn-rate: 0.0001
[2023-07-04 18:31:16] [config] lemma-dependency: ""
[2023-07-04 18:31:16] [config] lemma-dim-emb: 0
[2023-07-04 18:31:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 18:31:16] [config] log-level: info
[2023-07-04 18:31:16] [config] log-time-zone: ""
[2023-07-04 18:31:16] [config] logical-epoch:
[2023-07-04 18:31:16] [config]   - 1e
[2023-07-04 18:31:16] [config]   - 0
[2023-07-04 18:31:16] [config] lr-decay: 0
[2023-07-04 18:31:16] [config] lr-decay-freq: 50000
[2023-07-04 18:31:16] [config] lr-decay-inv-sqrt:
[2023-07-04 18:31:16] [config]   - 0
[2023-07-04 18:31:16] [config] lr-decay-repeat-warmup: false
[2023-07-04 18:31:16] [config] lr-decay-reset-optimizer: false
[2023-07-04 18:31:16] [config] lr-decay-start:
[2023-07-04 18:31:16] [config]   - 10
[2023-07-04 18:31:16] [config]   - 1
[2023-07-04 18:31:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 18:31:16] [config] lr-report: false
[2023-07-04 18:31:16] [config] lr-warmup: 0
[2023-07-04 18:31:16] [config] lr-warmup-at-reload: false
[2023-07-04 18:31:16] [config] lr-warmup-cycle: false
[2023-07-04 18:31:16] [config] lr-warmup-start-rate: 0
[2023-07-04 18:31:16] [config] max-length: 50
[2023-07-04 18:31:16] [config] max-length-crop: false
[2023-07-04 18:31:16] [config] max-length-factor: 3
[2023-07-04 18:31:16] [config] maxi-batch: 100
[2023-07-04 18:31:16] [config] maxi-batch-sort: trg
[2023-07-04 18:31:16] [config] mini-batch: 64
[2023-07-04 18:31:16] [config] mini-batch-fit: false
[2023-07-04 18:31:16] [config] mini-batch-fit-step: 10
[2023-07-04 18:31:16] [config] mini-batch-round-up: true
[2023-07-04 18:31:16] [config] mini-batch-track-lr: false
[2023-07-04 18:31:16] [config] mini-batch-warmup: 0
[2023-07-04 18:31:16] [config] mini-batch-words: 0
[2023-07-04 18:31:16] [config] mini-batch-words-ref: 0
[2023-07-04 18:31:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:31:16] [config] multi-loss-type: sum
[2023-07-04 18:31:16] [config] n-best: false
[2023-07-04 18:31:16] [config] no-nccl: false
[2023-07-04 18:31:16] [config] no-reload: false
[2023-07-04 18:31:16] [config] no-restore-corpus: false
[2023-07-04 18:31:16] [config] normalize: 0
[2023-07-04 18:31:16] [config] normalize-gradient: false
[2023-07-04 18:31:16] [config] num-devices: 0
[2023-07-04 18:31:16] [config] optimizer: adam
[2023-07-04 18:31:16] [config] optimizer-delay: 1
[2023-07-04 18:31:16] [config] optimizer-params:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] output-omit-bias: false
[2023-07-04 18:31:16] [config] overwrite: true
[2023-07-04 18:31:16] [config] precision:
[2023-07-04 18:31:16] [config]   - float32
[2023-07-04 18:31:16] [config]   - float32
[2023-07-04 18:31:16] [config] pretrained-model: ""
[2023-07-04 18:31:16] [config] quantize-biases: false
[2023-07-04 18:31:16] [config] quantize-bits: 0
[2023-07-04 18:31:16] [config] quantize-log-based: false
[2023-07-04 18:31:16] [config] quantize-optimization-steps: 0
[2023-07-04 18:31:16] [config] quiet: false
[2023-07-04 18:31:16] [config] quiet-translation: true
[2023-07-04 18:31:16] [config] relative-paths: false
[2023-07-04 18:31:16] [config] right-left: false
[2023-07-04 18:31:16] [config] save-freq: 10000u
[2023-07-04 18:31:16] [config] seed: 1234
[2023-07-04 18:31:16] [config] sentencepiece-alphas:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] sentencepiece-max-lines: 2000000
[2023-07-04 18:31:16] [config] sentencepiece-options: ""
[2023-07-04 18:31:16] [config] sharding: global
[2023-07-04 18:31:16] [config] shuffle: data
[2023-07-04 18:31:16] [config] shuffle-in-ram: false
[2023-07-04 18:31:16] [config] sigterm: save-and-exit
[2023-07-04 18:31:16] [config] skip: false
[2023-07-04 18:31:16] [config] sqlite: ""
[2023-07-04 18:31:16] [config] sqlite-drop: false
[2023-07-04 18:31:16] [config] sync-freq: 200u
[2023-07-04 18:31:16] [config] sync-sgd: false
[2023-07-04 18:31:16] [config] tempdir: /tmp
[2023-07-04 18:31:16] [config] tied-embeddings: false
[2023-07-04 18:31:16] [config] tied-embeddings-all: false
[2023-07-04 18:31:16] [config] tied-embeddings-src: false
[2023-07-04 18:31:16] [config] train-embedder-rank:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] train-sets:
[2023-07-04 18:31:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 18:31:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 18:31:16] [config] transformer-aan-activation: swish
[2023-07-04 18:31:16] [config] transformer-aan-depth: 2
[2023-07-04 18:31:16] [config] transformer-aan-nogate: false
[2023-07-04 18:31:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 18:31:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 18:31:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 18:31:16] [config] transformer-depth-scaling: false
[2023-07-04 18:31:16] [config] transformer-dim-aan: 2048
[2023-07-04 18:31:16] [config] transformer-dim-ffn: 2048
[2023-07-04 18:31:16] [config] transformer-dropout: 0
[2023-07-04 18:31:16] [config] transformer-dropout-attention: 0
[2023-07-04 18:31:16] [config] transformer-dropout-ffn: 0
[2023-07-04 18:31:16] [config] transformer-ffn-activation: swish
[2023-07-04 18:31:16] [config] transformer-ffn-depth: 2
[2023-07-04 18:31:16] [config] transformer-guided-alignment-layer: last
[2023-07-04 18:31:16] [config] transformer-heads: 8
[2023-07-04 18:31:16] [config] transformer-no-projection: false
[2023-07-04 18:31:16] [config] transformer-pool: false
[2023-07-04 18:31:16] [config] transformer-postprocess: dan
[2023-07-04 18:31:16] [config] transformer-postprocess-emb: d
[2023-07-04 18:31:16] [config] transformer-postprocess-top: ""
[2023-07-04 18:31:16] [config] transformer-preprocess: ""
[2023-07-04 18:31:16] [config] transformer-tied-layers:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] transformer-train-position-embeddings: false
[2023-07-04 18:31:16] [config] tsv: false
[2023-07-04 18:31:16] [config] tsv-fields: 0
[2023-07-04 18:31:16] [config] type: s2s
[2023-07-04 18:31:16] [config] ulr: false
[2023-07-04 18:31:16] [config] ulr-dim-emb: 0
[2023-07-04 18:31:16] [config] ulr-dropout: 0
[2023-07-04 18:31:16] [config] ulr-keys-vectors: ""
[2023-07-04 18:31:16] [config] ulr-query-vectors: ""
[2023-07-04 18:31:16] [config] ulr-softmax-temperature: 1
[2023-07-04 18:31:16] [config] ulr-trainable-transformation: false
[2023-07-04 18:31:16] [config] unlikelihood-loss: false
[2023-07-04 18:31:16] [config] valid-freq: 50000000
[2023-07-04 18:31:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 18:31:16] [config] valid-max-length: 1000
[2023-07-04 18:31:16] [config] valid-metrics:
[2023-07-04 18:31:16] [config]   - cross-entropy
[2023-07-04 18:31:16] [config]   - translation
[2023-07-04 18:31:16] [config] valid-mini-batch: 32
[2023-07-04 18:31:16] [config] valid-reset-stalled: false
[2023-07-04 18:31:16] [config] valid-script-args:
[2023-07-04 18:31:16] [config]   []
[2023-07-04 18:31:16] [config] valid-script-path: ""
[2023-07-04 18:31:16] [config] valid-sets:
[2023-07-04 18:31:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 18:31:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 18:31:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 18:31:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:31:16] [config] vocabs:
[2023-07-04 18:31:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:31:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:31:16] [config] word-penalty: 0
[2023-07-04 18:31:16] [config] word-scores: false
[2023-07-04 18:31:16] [config] workspace: 2048
[2023-07-04 18:31:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:31:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:31:16] [training] Using single-device training
[2023-07-04 18:31:17] Synced seed 1234
[2023-07-04 18:31:17] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:31:17] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 18:31:17] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:31:17] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 18:31:17] [valid] No post-processing script given for validating translator
[2023-07-04 18:31:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:31:18] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 18:31:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 18:31:18] [comm] Using global sharding
[2023-07-04 18:31:18] [comm] NCCLCommunicators constructed successfully
[2023-07-04 18:31:18] [training] Using 1 GPUs
[2023-07-04 18:31:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:31:20] Loading Adam parameters
[2023-07-04 18:31:21] [memory] Reserving 754 MB, device gpu0
[2023-07-04 18:31:21] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:31:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:31:21] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-07-04 18:31:21] [data] Shuffling data
[2023-07-04 18:31:21] [data] Done reading 20,192 sentences
[2023-07-04 18:31:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:31:21] Training started
[2023-07-04 18:31:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 18:31:21] [logits] Applying loss function for 1 factor(s)
[2023-07-04 18:31:21] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 18:31:21] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:31:21] Parameter type float32, optimization type float32, casting types false
[2023-07-04 18:31:35] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 3.09292626 * 1,341,072 @ 320 after 12,072,365 : Time 17.72s : 75685.49 words/s : gNorm 1.3429
[2023-07-04 18:32:05] Seen 18,843 samples
[2023-07-04 18:32:05] Starting data epoch 32 in logical epoch 32
[2023-07-04 18:32:05] [data] Shuffling data
[2023-07-04 18:32:05] [data] Done reading 20,192 sentences
[2023-07-04 18:32:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:32:53] Seen 18,843 samples
[2023-07-04 18:32:53] Starting data epoch 33 in logical epoch 33
[2023-07-04 18:32:53] [data] Shuffling data
[2023-07-04 18:32:53] [data] Done reading 20,192 sentences
[2023-07-04 18:32:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:33:44] Seen 18,843 samples
[2023-07-04 18:33:44] Starting data epoch 34 in logical epoch 34
[2023-07-04 18:33:44] [data] Shuffling data
[2023-07-04 18:33:44] [data] Done reading 20,192 sentences
[2023-07-04 18:33:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:34:20] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 2.87899017 * 1,347,521 @ 882 after 13,419,886 : Time 165.24s : 8154.99 words/s : gNorm 1.3450
[2023-07-04 18:34:20] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:34:26] Saving Adam parameters
[2023-07-04 18:34:27] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:34:51] Seen 18,843 samples
[2023-07-04 18:34:51] Starting data epoch 35 in logical epoch 35
[2023-07-04 18:34:51] [data] Shuffling data
[2023-07-04 18:34:51] [data] Done reading 20,192 sentences
[2023-07-04 18:34:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:35:39] Seen 18,843 samples
[2023-07-04 18:35:40] Starting data epoch 36 in logical epoch 36
[2023-07-04 18:35:40] [data] Shuffling data
[2023-07-04 18:35:40] [data] Done reading 20,192 sentences
[2023-07-04 18:35:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:36:29] Seen 18,843 samples
[2023-07-04 18:36:29] Starting data epoch 37 in logical epoch 37
[2023-07-04 18:36:29] [data] Shuffling data
[2023-07-04 18:36:29] [data] Done reading 20,192 sentences
[2023-07-04 18:36:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:37:18] Seen 18,843 samples
[2023-07-04 18:37:18] Starting data epoch 38 in logical epoch 38
[2023-07-04 18:37:18] [data] Shuffling data
[2023-07-04 18:37:19] [data] Done reading 20,192 sentences
[2023-07-04 18:37:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:37:23] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 2.66365433 * 1,344,952 @ 1,403 after 14,764,838 : Time 183.58s : 7326.14 words/s : gNorm 1.2947
[2023-07-04 18:38:08] Seen 18,843 samples
[2023-07-04 18:38:08] Starting data epoch 39 in logical epoch 39
[2023-07-04 18:38:08] [data] Shuffling data
[2023-07-04 18:38:08] [data] Done reading 20,192 sentences
[2023-07-04 18:38:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:38:57] Seen 18,843 samples
[2023-07-04 18:38:57] Starting data epoch 40 in logical epoch 40
[2023-07-04 18:38:57] [data] Shuffling data
[2023-07-04 18:38:57] [data] Done reading 20,192 sentences
[2023-07-04 18:38:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:39:45] Seen 18,843 samples
[2023-07-04 18:39:45] Starting data epoch 41 in logical epoch 41
[2023-07-04 18:39:45] Training finished
[2023-07-04 18:39:52] [valid] Ep. 41 : Up. 11864 : cross-entropy : 129.982 : stalled 3 times (last best: 108.414)
[2023-07-04 18:42:09] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-07-04 18:42:09] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:42:13] Saving Adam parameters
[2023-07-04 18:42:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:42:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:42:29] [marian] Running on node07.datos.cluster.uy as process 8997 with command line:
[2023-07-04 18:42:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 18:42:29] [config] after: 0e
[2023-07-04 18:42:29] [config] after-batches: 0
[2023-07-04 18:42:29] [config] after-epochs: 50
[2023-07-04 18:42:29] [config] all-caps-every: 0
[2023-07-04 18:42:29] [config] allow-unk: false
[2023-07-04 18:42:29] [config] authors: false
[2023-07-04 18:42:29] [config] beam-size: 12
[2023-07-04 18:42:29] [config] bert-class-symbol: "[CLS]"
[2023-07-04 18:42:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 18:42:29] [config] bert-masking-fraction: 0.15
[2023-07-04 18:42:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 18:42:29] [config] bert-train-type-embeddings: true
[2023-07-04 18:42:29] [config] bert-type-vocab-size: 2
[2023-07-04 18:42:29] [config] build-info: ""
[2023-07-04 18:42:29] [config] check-gradient-nan: false
[2023-07-04 18:42:29] [config] check-nan: false
[2023-07-04 18:42:29] [config] cite: false
[2023-07-04 18:42:29] [config] clip-norm: 1
[2023-07-04 18:42:29] [config] cost-scaling:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] cost-type: ce-sum
[2023-07-04 18:42:29] [config] cpu-threads: 0
[2023-07-04 18:42:29] [config] data-threads: 8
[2023-07-04 18:42:29] [config] data-weighting: ""
[2023-07-04 18:42:29] [config] data-weighting-type: sentence
[2023-07-04 18:42:29] [config] dec-cell: gru
[2023-07-04 18:42:29] [config] dec-cell-base-depth: 2
[2023-07-04 18:42:29] [config] dec-cell-high-depth: 1
[2023-07-04 18:42:29] [config] dec-depth: 1
[2023-07-04 18:42:29] [config] devices:
[2023-07-04 18:42:29] [config]   - 0
[2023-07-04 18:42:29] [config] dim-emb: 512
[2023-07-04 18:42:29] [config] dim-rnn: 1024
[2023-07-04 18:42:29] [config] dim-vocabs:
[2023-07-04 18:42:29] [config]   - 54042
[2023-07-04 18:42:29] [config]   - 36507
[2023-07-04 18:42:29] [config] disp-first: 0
[2023-07-04 18:42:29] [config] disp-freq: 1000u
[2023-07-04 18:42:29] [config] disp-label-counts: true
[2023-07-04 18:42:29] [config] dropout-rnn: 0
[2023-07-04 18:42:29] [config] dropout-src: 0
[2023-07-04 18:42:29] [config] dropout-trg: 0
[2023-07-04 18:42:29] [config] dump-config: ""
[2023-07-04 18:42:29] [config] dynamic-gradient-scaling:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] early-stopping: 10
[2023-07-04 18:42:29] [config] early-stopping-on: first
[2023-07-04 18:42:29] [config] embedding-fix-src: false
[2023-07-04 18:42:29] [config] embedding-fix-trg: false
[2023-07-04 18:42:29] [config] embedding-normalization: false
[2023-07-04 18:42:29] [config] embedding-vectors:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] enc-cell: gru
[2023-07-04 18:42:29] [config] enc-cell-depth: 1
[2023-07-04 18:42:29] [config] enc-depth: 1
[2023-07-04 18:42:29] [config] enc-type: bidirectional
[2023-07-04 18:42:29] [config] english-title-case-every: 0
[2023-07-04 18:42:29] [config] exponential-smoothing: 0
[2023-07-04 18:42:29] [config] factor-weight: 1
[2023-07-04 18:42:29] [config] factors-combine: sum
[2023-07-04 18:42:29] [config] factors-dim-emb: 0
[2023-07-04 18:42:29] [config] gradient-checkpointing: false
[2023-07-04 18:42:29] [config] gradient-norm-average-window: 100
[2023-07-04 18:42:29] [config] guided-alignment: none
[2023-07-04 18:42:29] [config] guided-alignment-cost: mse
[2023-07-04 18:42:29] [config] guided-alignment-weight: 0.1
[2023-07-04 18:42:29] [config] ignore-model-config: false
[2023-07-04 18:42:29] [config] input-types:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] interpolate-env-vars: false
[2023-07-04 18:42:29] [config] keep-best: false
[2023-07-04 18:42:29] [config] label-smoothing: 0
[2023-07-04 18:42:29] [config] layer-normalization: false
[2023-07-04 18:42:29] [config] learn-rate: 0.0001
[2023-07-04 18:42:29] [config] lemma-dependency: ""
[2023-07-04 18:42:29] [config] lemma-dim-emb: 0
[2023-07-04 18:42:29] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 18:42:29] [config] log-level: info
[2023-07-04 18:42:29] [config] log-time-zone: ""
[2023-07-04 18:42:29] [config] logical-epoch:
[2023-07-04 18:42:29] [config]   - 1e
[2023-07-04 18:42:29] [config]   - 0
[2023-07-04 18:42:29] [config] lr-decay: 0
[2023-07-04 18:42:29] [config] lr-decay-freq: 50000
[2023-07-04 18:42:29] [config] lr-decay-inv-sqrt:
[2023-07-04 18:42:29] [config]   - 0
[2023-07-04 18:42:29] [config] lr-decay-repeat-warmup: false
[2023-07-04 18:42:29] [config] lr-decay-reset-optimizer: false
[2023-07-04 18:42:29] [config] lr-decay-start:
[2023-07-04 18:42:29] [config]   - 10
[2023-07-04 18:42:29] [config]   - 1
[2023-07-04 18:42:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 18:42:29] [config] lr-report: false
[2023-07-04 18:42:29] [config] lr-warmup: 0
[2023-07-04 18:42:29] [config] lr-warmup-at-reload: false
[2023-07-04 18:42:29] [config] lr-warmup-cycle: false
[2023-07-04 18:42:29] [config] lr-warmup-start-rate: 0
[2023-07-04 18:42:29] [config] max-length: 50
[2023-07-04 18:42:29] [config] max-length-crop: false
[2023-07-04 18:42:29] [config] max-length-factor: 3
[2023-07-04 18:42:29] [config] maxi-batch: 100
[2023-07-04 18:42:29] [config] maxi-batch-sort: trg
[2023-07-04 18:42:29] [config] mini-batch: 64
[2023-07-04 18:42:29] [config] mini-batch-fit: false
[2023-07-04 18:42:29] [config] mini-batch-fit-step: 10
[2023-07-04 18:42:29] [config] mini-batch-round-up: true
[2023-07-04 18:42:29] [config] mini-batch-track-lr: false
[2023-07-04 18:42:29] [config] mini-batch-warmup: 0
[2023-07-04 18:42:29] [config] mini-batch-words: 0
[2023-07-04 18:42:29] [config] mini-batch-words-ref: 0
[2023-07-04 18:42:29] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:42:29] [config] multi-loss-type: sum
[2023-07-04 18:42:29] [config] n-best: false
[2023-07-04 18:42:29] [config] no-nccl: false
[2023-07-04 18:42:29] [config] no-reload: false
[2023-07-04 18:42:29] [config] no-restore-corpus: false
[2023-07-04 18:42:29] [config] normalize: 0
[2023-07-04 18:42:29] [config] normalize-gradient: false
[2023-07-04 18:42:29] [config] num-devices: 0
[2023-07-04 18:42:29] [config] optimizer: adam
[2023-07-04 18:42:29] [config] optimizer-delay: 1
[2023-07-04 18:42:29] [config] optimizer-params:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] output-omit-bias: false
[2023-07-04 18:42:29] [config] overwrite: true
[2023-07-04 18:42:29] [config] precision:
[2023-07-04 18:42:29] [config]   - float32
[2023-07-04 18:42:29] [config]   - float32
[2023-07-04 18:42:29] [config] pretrained-model: ""
[2023-07-04 18:42:29] [config] quantize-biases: false
[2023-07-04 18:42:29] [config] quantize-bits: 0
[2023-07-04 18:42:29] [config] quantize-log-based: false
[2023-07-04 18:42:29] [config] quantize-optimization-steps: 0
[2023-07-04 18:42:29] [config] quiet: false
[2023-07-04 18:42:29] [config] quiet-translation: true
[2023-07-04 18:42:29] [config] relative-paths: false
[2023-07-04 18:42:29] [config] right-left: false
[2023-07-04 18:42:29] [config] save-freq: 10000u
[2023-07-04 18:42:29] [config] seed: 1234
[2023-07-04 18:42:29] [config] sentencepiece-alphas:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] sentencepiece-max-lines: 2000000
[2023-07-04 18:42:29] [config] sentencepiece-options: ""
[2023-07-04 18:42:29] [config] sharding: global
[2023-07-04 18:42:29] [config] shuffle: data
[2023-07-04 18:42:29] [config] shuffle-in-ram: false
[2023-07-04 18:42:29] [config] sigterm: save-and-exit
[2023-07-04 18:42:29] [config] skip: false
[2023-07-04 18:42:29] [config] sqlite: ""
[2023-07-04 18:42:29] [config] sqlite-drop: false
[2023-07-04 18:42:29] [config] sync-freq: 200u
[2023-07-04 18:42:29] [config] sync-sgd: false
[2023-07-04 18:42:29] [config] tempdir: /tmp
[2023-07-04 18:42:29] [config] tied-embeddings: false
[2023-07-04 18:42:29] [config] tied-embeddings-all: false
[2023-07-04 18:42:29] [config] tied-embeddings-src: false
[2023-07-04 18:42:29] [config] train-embedder-rank:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] train-sets:
[2023-07-04 18:42:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 18:42:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 18:42:29] [config] transformer-aan-activation: swish
[2023-07-04 18:42:29] [config] transformer-aan-depth: 2
[2023-07-04 18:42:29] [config] transformer-aan-nogate: false
[2023-07-04 18:42:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 18:42:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 18:42:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 18:42:29] [config] transformer-depth-scaling: false
[2023-07-04 18:42:29] [config] transformer-dim-aan: 2048
[2023-07-04 18:42:29] [config] transformer-dim-ffn: 2048
[2023-07-04 18:42:29] [config] transformer-dropout: 0
[2023-07-04 18:42:29] [config] transformer-dropout-attention: 0
[2023-07-04 18:42:29] [config] transformer-dropout-ffn: 0
[2023-07-04 18:42:29] [config] transformer-ffn-activation: swish
[2023-07-04 18:42:29] [config] transformer-ffn-depth: 2
[2023-07-04 18:42:29] [config] transformer-guided-alignment-layer: last
[2023-07-04 18:42:29] [config] transformer-heads: 8
[2023-07-04 18:42:29] [config] transformer-no-projection: false
[2023-07-04 18:42:29] [config] transformer-pool: false
[2023-07-04 18:42:29] [config] transformer-postprocess: dan
[2023-07-04 18:42:29] [config] transformer-postprocess-emb: d
[2023-07-04 18:42:29] [config] transformer-postprocess-top: ""
[2023-07-04 18:42:29] [config] transformer-preprocess: ""
[2023-07-04 18:42:29] [config] transformer-tied-layers:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] transformer-train-position-embeddings: false
[2023-07-04 18:42:29] [config] tsv: false
[2023-07-04 18:42:29] [config] tsv-fields: 0
[2023-07-04 18:42:29] [config] type: s2s
[2023-07-04 18:42:29] [config] ulr: false
[2023-07-04 18:42:29] [config] ulr-dim-emb: 0
[2023-07-04 18:42:29] [config] ulr-dropout: 0
[2023-07-04 18:42:29] [config] ulr-keys-vectors: ""
[2023-07-04 18:42:29] [config] ulr-query-vectors: ""
[2023-07-04 18:42:29] [config] ulr-softmax-temperature: 1
[2023-07-04 18:42:29] [config] ulr-trainable-transformation: false
[2023-07-04 18:42:29] [config] unlikelihood-loss: false
[2023-07-04 18:42:29] [config] valid-freq: 50000000
[2023-07-04 18:42:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 18:42:29] [config] valid-max-length: 1000
[2023-07-04 18:42:29] [config] valid-metrics:
[2023-07-04 18:42:29] [config]   - cross-entropy
[2023-07-04 18:42:29] [config]   - translation
[2023-07-04 18:42:29] [config] valid-mini-batch: 32
[2023-07-04 18:42:29] [config] valid-reset-stalled: false
[2023-07-04 18:42:29] [config] valid-script-args:
[2023-07-04 18:42:29] [config]   []
[2023-07-04 18:42:29] [config] valid-script-path: ""
[2023-07-04 18:42:29] [config] valid-sets:
[2023-07-04 18:42:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 18:42:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 18:42:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 18:42:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:42:29] [config] vocabs:
[2023-07-04 18:42:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:42:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:42:29] [config] word-penalty: 0
[2023-07-04 18:42:29] [config] word-scores: false
[2023-07-04 18:42:29] [config] workspace: 2048
[2023-07-04 18:42:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:42:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:42:29] [training] Using single-device training
[2023-07-04 18:42:30] Synced seed 1234
[2023-07-04 18:42:30] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:42:30] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 18:42:30] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:42:30] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 18:42:30] [valid] No post-processing script given for validating translator
[2023-07-04 18:42:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:42:31] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 18:42:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 18:42:31] [comm] Using global sharding
[2023-07-04 18:42:31] [comm] NCCLCommunicators constructed successfully
[2023-07-04 18:42:31] [training] Using 1 GPUs
[2023-07-04 18:42:31] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:42:34] Loading Adam parameters
[2023-07-04 18:42:34] [memory] Reserving 754 MB, device gpu0
[2023-07-04 18:42:34] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:42:34] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:42:34] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-07-04 18:42:34] [data] Shuffling data
[2023-07-04 18:42:34] [data] Done reading 20,192 sentences
[2023-07-04 18:42:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:42:34] Training started
[2023-07-04 18:42:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 18:42:34] [logits] Applying loss function for 1 factor(s)
[2023-07-04 18:42:35] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 18:42:35] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:42:35] Parameter type float32, optimization type float32, casting types false
[2023-07-04 18:42:53] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 2.43561816 * 1,335,380 @ 968 after 16,100,218 : Time 22.88s : 58362.66 words/s : gNorm 1.3633
[2023-07-04 18:43:17] Seen 18,843 samples
[2023-07-04 18:43:17] Starting data epoch 42 in logical epoch 42
[2023-07-04 18:43:17] [data] Shuffling data
[2023-07-04 18:43:17] [data] Done reading 20,192 sentences
[2023-07-04 18:43:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:44:06] Seen 18,843 samples
[2023-07-04 18:44:06] Starting data epoch 43 in logical epoch 43
[2023-07-04 18:44:06] [data] Shuffling data
[2023-07-04 18:44:06] [data] Done reading 20,192 sentences
[2023-07-04 18:44:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:44:55] Seen 18,843 samples
[2023-07-04 18:44:55] Starting data epoch 44 in logical epoch 44
[2023-07-04 18:44:55] [data] Shuffling data
[2023-07-04 18:44:55] [data] Done reading 20,192 sentences
[2023-07-04 18:44:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:45:35] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 2.24951291 * 1,337,866 @ 718 after 17,438,084 : Time 161.65s : 8276.50 words/s : gNorm 1.2979
[2023-07-04 18:45:43] Seen 18,843 samples
[2023-07-04 18:45:43] Starting data epoch 45 in logical epoch 45
[2023-07-04 18:45:43] [data] Shuffling data
[2023-07-04 18:45:43] [data] Done reading 20,192 sentences
[2023-07-04 18:45:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:46:33] Seen 18,843 samples
[2023-07-04 18:46:33] Starting data epoch 46 in logical epoch 46
[2023-07-04 18:46:33] [data] Shuffling data
[2023-07-04 18:46:33] [data] Done reading 20,192 sentences
[2023-07-04 18:46:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:47:23] Seen 18,843 samples
[2023-07-04 18:47:23] Starting data epoch 47 in logical epoch 47
[2023-07-04 18:47:23] [data] Shuffling data
[2023-07-04 18:47:23] [data] Done reading 20,192 sentences
[2023-07-04 18:47:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:48:13] Seen 18,843 samples
[2023-07-04 18:48:13] Starting data epoch 48 in logical epoch 48
[2023-07-04 18:48:13] [data] Shuffling data
[2023-07-04 18:48:13] [data] Done reading 20,192 sentences
[2023-07-04 18:48:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:48:24] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 2.06584406 * 1,348,446 @ 1,408 after 18,786,530 : Time 169.08s : 7975.23 words/s : gNorm 1.4586
[2023-07-04 18:49:02] Seen 18,843 samples
[2023-07-04 18:49:02] Starting data epoch 49 in logical epoch 49
[2023-07-04 18:49:02] [data] Shuffling data
[2023-07-04 18:49:02] [data] Done reading 20,192 sentences
[2023-07-04 18:49:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:49:51] Seen 18,843 samples
[2023-07-04 18:49:51] Starting data epoch 50 in logical epoch 50
[2023-07-04 18:49:51] [data] Shuffling data
[2023-07-04 18:49:51] [data] Done reading 20,192 sentences
[2023-07-04 18:49:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:50:41] Seen 18,843 samples
[2023-07-04 18:50:41] Starting data epoch 51 in logical epoch 51
[2023-07-04 18:50:41] Training finished
[2023-07-04 18:50:47] [valid] Ep. 51 : Up. 14829 : cross-entropy : 143.079 : stalled 4 times (last best: 108.414)
[2023-07-04 18:53:01] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-07-04 18:53:01] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:53:04] Saving Adam parameters
[2023-07-04 18:53:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:53:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:53:20] [marian] Running on node07.datos.cluster.uy as process 9947 with command line:
[2023-07-04 18:53:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 18:53:20] [config] after: 0e
[2023-07-04 18:53:20] [config] after-batches: 0
[2023-07-04 18:53:20] [config] after-epochs: 60
[2023-07-04 18:53:20] [config] all-caps-every: 0
[2023-07-04 18:53:20] [config] allow-unk: false
[2023-07-04 18:53:20] [config] authors: false
[2023-07-04 18:53:20] [config] beam-size: 12
[2023-07-04 18:53:20] [config] bert-class-symbol: "[CLS]"
[2023-07-04 18:53:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 18:53:20] [config] bert-masking-fraction: 0.15
[2023-07-04 18:53:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 18:53:20] [config] bert-train-type-embeddings: true
[2023-07-04 18:53:20] [config] bert-type-vocab-size: 2
[2023-07-04 18:53:20] [config] build-info: ""
[2023-07-04 18:53:20] [config] check-gradient-nan: false
[2023-07-04 18:53:20] [config] check-nan: false
[2023-07-04 18:53:20] [config] cite: false
[2023-07-04 18:53:20] [config] clip-norm: 1
[2023-07-04 18:53:20] [config] cost-scaling:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] cost-type: ce-sum
[2023-07-04 18:53:20] [config] cpu-threads: 0
[2023-07-04 18:53:20] [config] data-threads: 8
[2023-07-04 18:53:20] [config] data-weighting: ""
[2023-07-04 18:53:20] [config] data-weighting-type: sentence
[2023-07-04 18:53:20] [config] dec-cell: gru
[2023-07-04 18:53:20] [config] dec-cell-base-depth: 2
[2023-07-04 18:53:20] [config] dec-cell-high-depth: 1
[2023-07-04 18:53:20] [config] dec-depth: 1
[2023-07-04 18:53:20] [config] devices:
[2023-07-04 18:53:20] [config]   - 0
[2023-07-04 18:53:20] [config] dim-emb: 512
[2023-07-04 18:53:20] [config] dim-rnn: 1024
[2023-07-04 18:53:20] [config] dim-vocabs:
[2023-07-04 18:53:20] [config]   - 54042
[2023-07-04 18:53:20] [config]   - 36507
[2023-07-04 18:53:20] [config] disp-first: 0
[2023-07-04 18:53:20] [config] disp-freq: 1000u
[2023-07-04 18:53:20] [config] disp-label-counts: true
[2023-07-04 18:53:20] [config] dropout-rnn: 0
[2023-07-04 18:53:20] [config] dropout-src: 0
[2023-07-04 18:53:20] [config] dropout-trg: 0
[2023-07-04 18:53:20] [config] dump-config: ""
[2023-07-04 18:53:20] [config] dynamic-gradient-scaling:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] early-stopping: 10
[2023-07-04 18:53:20] [config] early-stopping-on: first
[2023-07-04 18:53:20] [config] embedding-fix-src: false
[2023-07-04 18:53:20] [config] embedding-fix-trg: false
[2023-07-04 18:53:20] [config] embedding-normalization: false
[2023-07-04 18:53:20] [config] embedding-vectors:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] enc-cell: gru
[2023-07-04 18:53:20] [config] enc-cell-depth: 1
[2023-07-04 18:53:20] [config] enc-depth: 1
[2023-07-04 18:53:20] [config] enc-type: bidirectional
[2023-07-04 18:53:20] [config] english-title-case-every: 0
[2023-07-04 18:53:20] [config] exponential-smoothing: 0
[2023-07-04 18:53:20] [config] factor-weight: 1
[2023-07-04 18:53:20] [config] factors-combine: sum
[2023-07-04 18:53:20] [config] factors-dim-emb: 0
[2023-07-04 18:53:20] [config] gradient-checkpointing: false
[2023-07-04 18:53:20] [config] gradient-norm-average-window: 100
[2023-07-04 18:53:20] [config] guided-alignment: none
[2023-07-04 18:53:20] [config] guided-alignment-cost: mse
[2023-07-04 18:53:20] [config] guided-alignment-weight: 0.1
[2023-07-04 18:53:20] [config] ignore-model-config: false
[2023-07-04 18:53:20] [config] input-types:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] interpolate-env-vars: false
[2023-07-04 18:53:20] [config] keep-best: false
[2023-07-04 18:53:20] [config] label-smoothing: 0
[2023-07-04 18:53:20] [config] layer-normalization: false
[2023-07-04 18:53:20] [config] learn-rate: 0.0001
[2023-07-04 18:53:20] [config] lemma-dependency: ""
[2023-07-04 18:53:20] [config] lemma-dim-emb: 0
[2023-07-04 18:53:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 18:53:20] [config] log-level: info
[2023-07-04 18:53:20] [config] log-time-zone: ""
[2023-07-04 18:53:20] [config] logical-epoch:
[2023-07-04 18:53:20] [config]   - 1e
[2023-07-04 18:53:20] [config]   - 0
[2023-07-04 18:53:20] [config] lr-decay: 0
[2023-07-04 18:53:20] [config] lr-decay-freq: 50000
[2023-07-04 18:53:20] [config] lr-decay-inv-sqrt:
[2023-07-04 18:53:20] [config]   - 0
[2023-07-04 18:53:20] [config] lr-decay-repeat-warmup: false
[2023-07-04 18:53:20] [config] lr-decay-reset-optimizer: false
[2023-07-04 18:53:20] [config] lr-decay-start:
[2023-07-04 18:53:20] [config]   - 10
[2023-07-04 18:53:20] [config]   - 1
[2023-07-04 18:53:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 18:53:20] [config] lr-report: false
[2023-07-04 18:53:20] [config] lr-warmup: 0
[2023-07-04 18:53:20] [config] lr-warmup-at-reload: false
[2023-07-04 18:53:20] [config] lr-warmup-cycle: false
[2023-07-04 18:53:20] [config] lr-warmup-start-rate: 0
[2023-07-04 18:53:20] [config] max-length: 50
[2023-07-04 18:53:20] [config] max-length-crop: false
[2023-07-04 18:53:20] [config] max-length-factor: 3
[2023-07-04 18:53:20] [config] maxi-batch: 100
[2023-07-04 18:53:20] [config] maxi-batch-sort: trg
[2023-07-04 18:53:20] [config] mini-batch: 64
[2023-07-04 18:53:20] [config] mini-batch-fit: false
[2023-07-04 18:53:20] [config] mini-batch-fit-step: 10
[2023-07-04 18:53:20] [config] mini-batch-round-up: true
[2023-07-04 18:53:20] [config] mini-batch-track-lr: false
[2023-07-04 18:53:20] [config] mini-batch-warmup: 0
[2023-07-04 18:53:20] [config] mini-batch-words: 0
[2023-07-04 18:53:20] [config] mini-batch-words-ref: 0
[2023-07-04 18:53:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:53:20] [config] multi-loss-type: sum
[2023-07-04 18:53:20] [config] n-best: false
[2023-07-04 18:53:20] [config] no-nccl: false
[2023-07-04 18:53:20] [config] no-reload: false
[2023-07-04 18:53:20] [config] no-restore-corpus: false
[2023-07-04 18:53:20] [config] normalize: 0
[2023-07-04 18:53:20] [config] normalize-gradient: false
[2023-07-04 18:53:20] [config] num-devices: 0
[2023-07-04 18:53:20] [config] optimizer: adam
[2023-07-04 18:53:20] [config] optimizer-delay: 1
[2023-07-04 18:53:20] [config] optimizer-params:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] output-omit-bias: false
[2023-07-04 18:53:20] [config] overwrite: true
[2023-07-04 18:53:20] [config] precision:
[2023-07-04 18:53:20] [config]   - float32
[2023-07-04 18:53:20] [config]   - float32
[2023-07-04 18:53:20] [config] pretrained-model: ""
[2023-07-04 18:53:20] [config] quantize-biases: false
[2023-07-04 18:53:20] [config] quantize-bits: 0
[2023-07-04 18:53:20] [config] quantize-log-based: false
[2023-07-04 18:53:20] [config] quantize-optimization-steps: 0
[2023-07-04 18:53:20] [config] quiet: false
[2023-07-04 18:53:20] [config] quiet-translation: true
[2023-07-04 18:53:20] [config] relative-paths: false
[2023-07-04 18:53:20] [config] right-left: false
[2023-07-04 18:53:20] [config] save-freq: 10000u
[2023-07-04 18:53:20] [config] seed: 1234
[2023-07-04 18:53:20] [config] sentencepiece-alphas:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] sentencepiece-max-lines: 2000000
[2023-07-04 18:53:20] [config] sentencepiece-options: ""
[2023-07-04 18:53:20] [config] sharding: global
[2023-07-04 18:53:20] [config] shuffle: data
[2023-07-04 18:53:20] [config] shuffle-in-ram: false
[2023-07-04 18:53:20] [config] sigterm: save-and-exit
[2023-07-04 18:53:20] [config] skip: false
[2023-07-04 18:53:20] [config] sqlite: ""
[2023-07-04 18:53:20] [config] sqlite-drop: false
[2023-07-04 18:53:20] [config] sync-freq: 200u
[2023-07-04 18:53:20] [config] sync-sgd: false
[2023-07-04 18:53:20] [config] tempdir: /tmp
[2023-07-04 18:53:20] [config] tied-embeddings: false
[2023-07-04 18:53:20] [config] tied-embeddings-all: false
[2023-07-04 18:53:20] [config] tied-embeddings-src: false
[2023-07-04 18:53:20] [config] train-embedder-rank:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] train-sets:
[2023-07-04 18:53:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 18:53:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 18:53:20] [config] transformer-aan-activation: swish
[2023-07-04 18:53:20] [config] transformer-aan-depth: 2
[2023-07-04 18:53:20] [config] transformer-aan-nogate: false
[2023-07-04 18:53:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 18:53:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 18:53:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 18:53:20] [config] transformer-depth-scaling: false
[2023-07-04 18:53:20] [config] transformer-dim-aan: 2048
[2023-07-04 18:53:20] [config] transformer-dim-ffn: 2048
[2023-07-04 18:53:20] [config] transformer-dropout: 0
[2023-07-04 18:53:20] [config] transformer-dropout-attention: 0
[2023-07-04 18:53:20] [config] transformer-dropout-ffn: 0
[2023-07-04 18:53:20] [config] transformer-ffn-activation: swish
[2023-07-04 18:53:20] [config] transformer-ffn-depth: 2
[2023-07-04 18:53:20] [config] transformer-guided-alignment-layer: last
[2023-07-04 18:53:20] [config] transformer-heads: 8
[2023-07-04 18:53:20] [config] transformer-no-projection: false
[2023-07-04 18:53:20] [config] transformer-pool: false
[2023-07-04 18:53:20] [config] transformer-postprocess: dan
[2023-07-04 18:53:20] [config] transformer-postprocess-emb: d
[2023-07-04 18:53:20] [config] transformer-postprocess-top: ""
[2023-07-04 18:53:20] [config] transformer-preprocess: ""
[2023-07-04 18:53:20] [config] transformer-tied-layers:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] transformer-train-position-embeddings: false
[2023-07-04 18:53:20] [config] tsv: false
[2023-07-04 18:53:20] [config] tsv-fields: 0
[2023-07-04 18:53:20] [config] type: s2s
[2023-07-04 18:53:20] [config] ulr: false
[2023-07-04 18:53:20] [config] ulr-dim-emb: 0
[2023-07-04 18:53:20] [config] ulr-dropout: 0
[2023-07-04 18:53:20] [config] ulr-keys-vectors: ""
[2023-07-04 18:53:20] [config] ulr-query-vectors: ""
[2023-07-04 18:53:20] [config] ulr-softmax-temperature: 1
[2023-07-04 18:53:20] [config] ulr-trainable-transformation: false
[2023-07-04 18:53:20] [config] unlikelihood-loss: false
[2023-07-04 18:53:20] [config] valid-freq: 50000000
[2023-07-04 18:53:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 18:53:20] [config] valid-max-length: 1000
[2023-07-04 18:53:20] [config] valid-metrics:
[2023-07-04 18:53:20] [config]   - cross-entropy
[2023-07-04 18:53:20] [config]   - translation
[2023-07-04 18:53:20] [config] valid-mini-batch: 32
[2023-07-04 18:53:20] [config] valid-reset-stalled: false
[2023-07-04 18:53:20] [config] valid-script-args:
[2023-07-04 18:53:20] [config]   []
[2023-07-04 18:53:20] [config] valid-script-path: ""
[2023-07-04 18:53:20] [config] valid-sets:
[2023-07-04 18:53:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 18:53:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 18:53:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 18:53:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:53:20] [config] vocabs:
[2023-07-04 18:53:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:53:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:53:20] [config] word-penalty: 0
[2023-07-04 18:53:20] [config] word-scores: false
[2023-07-04 18:53:20] [config] workspace: 2048
[2023-07-04 18:53:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 18:53:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:53:20] [training] Using single-device training
[2023-07-04 18:53:21] Synced seed 1234
[2023-07-04 18:53:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 18:53:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 18:53:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 18:53:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 18:53:21] [valid] No post-processing script given for validating translator
[2023-07-04 18:53:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 18:53:22] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 18:53:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 18:53:22] [comm] Using global sharding
[2023-07-04 18:53:22] [comm] NCCLCommunicators constructed successfully
[2023-07-04 18:53:22] [training] Using 1 GPUs
[2023-07-04 18:53:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 18:53:25] Loading Adam parameters
[2023-07-04 18:53:25] [memory] Reserving 754 MB, device gpu0
[2023-07-04 18:53:25] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:53:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 18:53:25] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-07-04 18:53:25] [data] Shuffling data
[2023-07-04 18:53:25] [data] Done reading 20,192 sentences
[2023-07-04 18:53:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:53:25] Training started
[2023-07-04 18:53:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 18:53:25] [logits] Applying loss function for 1 factor(s)
[2023-07-04 18:53:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 18:53:26] [memory] Reserving 377 MB, device gpu0
[2023-07-04 18:53:26] Parameter type float32, optimization type float32, casting types false
[2023-07-04 18:53:48] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 1.87027502 * 1,333,303 @ 559 after 20,119,833 : Time 27.45s : 48577.35 words/s : gNorm 1.2752
[2023-07-04 18:54:08] Seen 18,843 samples
[2023-07-04 18:54:08] Starting data epoch 52 in logical epoch 52
[2023-07-04 18:54:08] [data] Shuffling data
[2023-07-04 18:54:08] [data] Done reading 20,192 sentences
[2023-07-04 18:54:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:54:57] Seen 18,843 samples
[2023-07-04 18:54:57] Starting data epoch 53 in logical epoch 53
[2023-07-04 18:54:57] [data] Shuffling data
[2023-07-04 18:54:57] [data] Done reading 20,192 sentences
[2023-07-04 18:54:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:55:46] Seen 18,843 samples
[2023-07-04 18:55:46] Starting data epoch 54 in logical epoch 54
[2023-07-04 18:55:46] [data] Shuffling data
[2023-07-04 18:55:46] [data] Done reading 20,192 sentences
[2023-07-04 18:55:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:56:33] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 1.71610940 * 1,343,441 @ 128 after 21,463,274 : Time 164.89s : 8147.45 words/s : gNorm 1.2096
[2023-07-04 18:56:36] Seen 18,843 samples
[2023-07-04 18:56:36] Starting data epoch 55 in logical epoch 55
[2023-07-04 18:56:36] [data] Shuffling data
[2023-07-04 18:56:36] [data] Done reading 20,192 sentences
[2023-07-04 18:56:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:57:25] Seen 18,843 samples
[2023-07-04 18:57:25] Starting data epoch 56 in logical epoch 56
[2023-07-04 18:57:25] [data] Shuffling data
[2023-07-04 18:57:25] [data] Done reading 20,192 sentences
[2023-07-04 18:57:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:58:15] Seen 18,843 samples
[2023-07-04 18:58:15] Starting data epoch 57 in logical epoch 57
[2023-07-04 18:58:15] [data] Shuffling data
[2023-07-04 18:58:15] [data] Done reading 20,192 sentences
[2023-07-04 18:58:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:59:03] Seen 18,843 samples
[2023-07-04 18:59:03] Starting data epoch 58 in logical epoch 58
[2023-07-04 18:59:03] [data] Shuffling data
[2023-07-04 18:59:03] [data] Done reading 20,192 sentences
[2023-07-04 18:59:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 18:59:21] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 1.54708230 * 1,347,361 @ 2,048 after 22,810,635 : Time 167.87s : 8026.09 words/s : gNorm 1.1504
[2023-07-04 18:59:54] Seen 18,843 samples
[2023-07-04 18:59:54] Starting data epoch 59 in logical epoch 59
[2023-07-04 18:59:54] [data] Shuffling data
[2023-07-04 18:59:54] [data] Done reading 20,192 sentences
[2023-07-04 18:59:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:00:43] Seen 18,843 samples
[2023-07-04 19:00:43] Starting data epoch 60 in logical epoch 60
[2023-07-04 19:00:43] [data] Shuffling data
[2023-07-04 19:00:43] [data] Done reading 20,192 sentences
[2023-07-04 19:00:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:01:32] Seen 18,843 samples
[2023-07-04 19:01:32] Starting data epoch 61 in logical epoch 61
[2023-07-04 19:01:32] Training finished
[2023-07-04 19:01:39] [valid] Ep. 61 : Up. 17795 : cross-entropy : 153.3 : stalled 5 times (last best: 108.414)
[2023-07-04 19:03:52] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-07-04 19:03:52] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:03:56] Saving Adam parameters
[2023-07-04 19:03:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:04:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:04:09] [marian] Running on node07.datos.cluster.uy as process 10573 with command line:
[2023-07-04 19:04:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:04:09] [config] after: 0e
[2023-07-04 19:04:09] [config] after-batches: 0
[2023-07-04 19:04:09] [config] after-epochs: 70
[2023-07-04 19:04:09] [config] all-caps-every: 0
[2023-07-04 19:04:09] [config] allow-unk: false
[2023-07-04 19:04:09] [config] authors: false
[2023-07-04 19:04:09] [config] beam-size: 12
[2023-07-04 19:04:09] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:04:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:04:09] [config] bert-masking-fraction: 0.15
[2023-07-04 19:04:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:04:09] [config] bert-train-type-embeddings: true
[2023-07-04 19:04:09] [config] bert-type-vocab-size: 2
[2023-07-04 19:04:09] [config] build-info: ""
[2023-07-04 19:04:09] [config] check-gradient-nan: false
[2023-07-04 19:04:09] [config] check-nan: false
[2023-07-04 19:04:09] [config] cite: false
[2023-07-04 19:04:09] [config] clip-norm: 1
[2023-07-04 19:04:09] [config] cost-scaling:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] cost-type: ce-sum
[2023-07-04 19:04:09] [config] cpu-threads: 0
[2023-07-04 19:04:09] [config] data-threads: 8
[2023-07-04 19:04:09] [config] data-weighting: ""
[2023-07-04 19:04:09] [config] data-weighting-type: sentence
[2023-07-04 19:04:09] [config] dec-cell: gru
[2023-07-04 19:04:09] [config] dec-cell-base-depth: 2
[2023-07-04 19:04:09] [config] dec-cell-high-depth: 1
[2023-07-04 19:04:09] [config] dec-depth: 1
[2023-07-04 19:04:09] [config] devices:
[2023-07-04 19:04:09] [config]   - 0
[2023-07-04 19:04:09] [config] dim-emb: 512
[2023-07-04 19:04:09] [config] dim-rnn: 1024
[2023-07-04 19:04:09] [config] dim-vocabs:
[2023-07-04 19:04:09] [config]   - 54042
[2023-07-04 19:04:09] [config]   - 36507
[2023-07-04 19:04:09] [config] disp-first: 0
[2023-07-04 19:04:09] [config] disp-freq: 1000u
[2023-07-04 19:04:09] [config] disp-label-counts: true
[2023-07-04 19:04:09] [config] dropout-rnn: 0
[2023-07-04 19:04:09] [config] dropout-src: 0
[2023-07-04 19:04:09] [config] dropout-trg: 0
[2023-07-04 19:04:09] [config] dump-config: ""
[2023-07-04 19:04:09] [config] dynamic-gradient-scaling:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] early-stopping: 10
[2023-07-04 19:04:09] [config] early-stopping-on: first
[2023-07-04 19:04:09] [config] embedding-fix-src: false
[2023-07-04 19:04:09] [config] embedding-fix-trg: false
[2023-07-04 19:04:09] [config] embedding-normalization: false
[2023-07-04 19:04:09] [config] embedding-vectors:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] enc-cell: gru
[2023-07-04 19:04:09] [config] enc-cell-depth: 1
[2023-07-04 19:04:09] [config] enc-depth: 1
[2023-07-04 19:04:09] [config] enc-type: bidirectional
[2023-07-04 19:04:09] [config] english-title-case-every: 0
[2023-07-04 19:04:09] [config] exponential-smoothing: 0
[2023-07-04 19:04:09] [config] factor-weight: 1
[2023-07-04 19:04:09] [config] factors-combine: sum
[2023-07-04 19:04:09] [config] factors-dim-emb: 0
[2023-07-04 19:04:09] [config] gradient-checkpointing: false
[2023-07-04 19:04:09] [config] gradient-norm-average-window: 100
[2023-07-04 19:04:09] [config] guided-alignment: none
[2023-07-04 19:04:09] [config] guided-alignment-cost: mse
[2023-07-04 19:04:09] [config] guided-alignment-weight: 0.1
[2023-07-04 19:04:09] [config] ignore-model-config: false
[2023-07-04 19:04:09] [config] input-types:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] interpolate-env-vars: false
[2023-07-04 19:04:09] [config] keep-best: false
[2023-07-04 19:04:09] [config] label-smoothing: 0
[2023-07-04 19:04:09] [config] layer-normalization: false
[2023-07-04 19:04:09] [config] learn-rate: 0.0001
[2023-07-04 19:04:09] [config] lemma-dependency: ""
[2023-07-04 19:04:09] [config] lemma-dim-emb: 0
[2023-07-04 19:04:09] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:04:09] [config] log-level: info
[2023-07-04 19:04:09] [config] log-time-zone: ""
[2023-07-04 19:04:09] [config] logical-epoch:
[2023-07-04 19:04:09] [config]   - 1e
[2023-07-04 19:04:09] [config]   - 0
[2023-07-04 19:04:09] [config] lr-decay: 0
[2023-07-04 19:04:09] [config] lr-decay-freq: 50000
[2023-07-04 19:04:09] [config] lr-decay-inv-sqrt:
[2023-07-04 19:04:09] [config]   - 0
[2023-07-04 19:04:09] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:04:09] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:04:09] [config] lr-decay-start:
[2023-07-04 19:04:09] [config]   - 10
[2023-07-04 19:04:09] [config]   - 1
[2023-07-04 19:04:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:04:09] [config] lr-report: false
[2023-07-04 19:04:09] [config] lr-warmup: 0
[2023-07-04 19:04:09] [config] lr-warmup-at-reload: false
[2023-07-04 19:04:09] [config] lr-warmup-cycle: false
[2023-07-04 19:04:09] [config] lr-warmup-start-rate: 0
[2023-07-04 19:04:09] [config] max-length: 50
[2023-07-04 19:04:09] [config] max-length-crop: false
[2023-07-04 19:04:09] [config] max-length-factor: 3
[2023-07-04 19:04:09] [config] maxi-batch: 100
[2023-07-04 19:04:09] [config] maxi-batch-sort: trg
[2023-07-04 19:04:09] [config] mini-batch: 64
[2023-07-04 19:04:09] [config] mini-batch-fit: false
[2023-07-04 19:04:09] [config] mini-batch-fit-step: 10
[2023-07-04 19:04:09] [config] mini-batch-round-up: true
[2023-07-04 19:04:09] [config] mini-batch-track-lr: false
[2023-07-04 19:04:09] [config] mini-batch-warmup: 0
[2023-07-04 19:04:09] [config] mini-batch-words: 0
[2023-07-04 19:04:09] [config] mini-batch-words-ref: 0
[2023-07-04 19:04:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:04:09] [config] multi-loss-type: sum
[2023-07-04 19:04:09] [config] n-best: false
[2023-07-04 19:04:09] [config] no-nccl: false
[2023-07-04 19:04:09] [config] no-reload: false
[2023-07-04 19:04:09] [config] no-restore-corpus: false
[2023-07-04 19:04:09] [config] normalize: 0
[2023-07-04 19:04:09] [config] normalize-gradient: false
[2023-07-04 19:04:09] [config] num-devices: 0
[2023-07-04 19:04:09] [config] optimizer: adam
[2023-07-04 19:04:09] [config] optimizer-delay: 1
[2023-07-04 19:04:09] [config] optimizer-params:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] output-omit-bias: false
[2023-07-04 19:04:09] [config] overwrite: true
[2023-07-04 19:04:09] [config] precision:
[2023-07-04 19:04:09] [config]   - float32
[2023-07-04 19:04:09] [config]   - float32
[2023-07-04 19:04:09] [config] pretrained-model: ""
[2023-07-04 19:04:09] [config] quantize-biases: false
[2023-07-04 19:04:09] [config] quantize-bits: 0
[2023-07-04 19:04:09] [config] quantize-log-based: false
[2023-07-04 19:04:09] [config] quantize-optimization-steps: 0
[2023-07-04 19:04:09] [config] quiet: false
[2023-07-04 19:04:09] [config] quiet-translation: true
[2023-07-04 19:04:09] [config] relative-paths: false
[2023-07-04 19:04:09] [config] right-left: false
[2023-07-04 19:04:09] [config] save-freq: 10000u
[2023-07-04 19:04:09] [config] seed: 1234
[2023-07-04 19:04:09] [config] sentencepiece-alphas:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:04:09] [config] sentencepiece-options: ""
[2023-07-04 19:04:09] [config] sharding: global
[2023-07-04 19:04:09] [config] shuffle: data
[2023-07-04 19:04:09] [config] shuffle-in-ram: false
[2023-07-04 19:04:09] [config] sigterm: save-and-exit
[2023-07-04 19:04:09] [config] skip: false
[2023-07-04 19:04:09] [config] sqlite: ""
[2023-07-04 19:04:09] [config] sqlite-drop: false
[2023-07-04 19:04:09] [config] sync-freq: 200u
[2023-07-04 19:04:09] [config] sync-sgd: false
[2023-07-04 19:04:09] [config] tempdir: /tmp
[2023-07-04 19:04:09] [config] tied-embeddings: false
[2023-07-04 19:04:09] [config] tied-embeddings-all: false
[2023-07-04 19:04:09] [config] tied-embeddings-src: false
[2023-07-04 19:04:09] [config] train-embedder-rank:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] train-sets:
[2023-07-04 19:04:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:04:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:04:09] [config] transformer-aan-activation: swish
[2023-07-04 19:04:09] [config] transformer-aan-depth: 2
[2023-07-04 19:04:09] [config] transformer-aan-nogate: false
[2023-07-04 19:04:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:04:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:04:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:04:09] [config] transformer-depth-scaling: false
[2023-07-04 19:04:09] [config] transformer-dim-aan: 2048
[2023-07-04 19:04:09] [config] transformer-dim-ffn: 2048
[2023-07-04 19:04:09] [config] transformer-dropout: 0
[2023-07-04 19:04:09] [config] transformer-dropout-attention: 0
[2023-07-04 19:04:09] [config] transformer-dropout-ffn: 0
[2023-07-04 19:04:09] [config] transformer-ffn-activation: swish
[2023-07-04 19:04:09] [config] transformer-ffn-depth: 2
[2023-07-04 19:04:09] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:04:09] [config] transformer-heads: 8
[2023-07-04 19:04:09] [config] transformer-no-projection: false
[2023-07-04 19:04:09] [config] transformer-pool: false
[2023-07-04 19:04:09] [config] transformer-postprocess: dan
[2023-07-04 19:04:09] [config] transformer-postprocess-emb: d
[2023-07-04 19:04:09] [config] transformer-postprocess-top: ""
[2023-07-04 19:04:09] [config] transformer-preprocess: ""
[2023-07-04 19:04:09] [config] transformer-tied-layers:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] transformer-train-position-embeddings: false
[2023-07-04 19:04:09] [config] tsv: false
[2023-07-04 19:04:09] [config] tsv-fields: 0
[2023-07-04 19:04:09] [config] type: s2s
[2023-07-04 19:04:09] [config] ulr: false
[2023-07-04 19:04:09] [config] ulr-dim-emb: 0
[2023-07-04 19:04:09] [config] ulr-dropout: 0
[2023-07-04 19:04:09] [config] ulr-keys-vectors: ""
[2023-07-04 19:04:09] [config] ulr-query-vectors: ""
[2023-07-04 19:04:09] [config] ulr-softmax-temperature: 1
[2023-07-04 19:04:09] [config] ulr-trainable-transformation: false
[2023-07-04 19:04:09] [config] unlikelihood-loss: false
[2023-07-04 19:04:09] [config] valid-freq: 50000000
[2023-07-04 19:04:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:04:09] [config] valid-max-length: 1000
[2023-07-04 19:04:09] [config] valid-metrics:
[2023-07-04 19:04:09] [config]   - cross-entropy
[2023-07-04 19:04:09] [config]   - translation
[2023-07-04 19:04:09] [config] valid-mini-batch: 32
[2023-07-04 19:04:09] [config] valid-reset-stalled: false
[2023-07-04 19:04:09] [config] valid-script-args:
[2023-07-04 19:04:09] [config]   []
[2023-07-04 19:04:09] [config] valid-script-path: ""
[2023-07-04 19:04:09] [config] valid-sets:
[2023-07-04 19:04:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:04:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:04:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:04:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:04:09] [config] vocabs:
[2023-07-04 19:04:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:04:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:04:09] [config] word-penalty: 0
[2023-07-04 19:04:09] [config] word-scores: false
[2023-07-04 19:04:09] [config] workspace: 2048
[2023-07-04 19:04:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:04:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:04:09] [training] Using single-device training
[2023-07-04 19:04:10] Synced seed 1234
[2023-07-04 19:04:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:04:10] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:04:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:04:10] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:04:10] [valid] No post-processing script given for validating translator
[2023-07-04 19:04:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:04:11] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:04:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:04:11] [comm] Using global sharding
[2023-07-04 19:04:11] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:04:11] [training] Using 1 GPUs
[2023-07-04 19:04:11] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:04:13] Loading Adam parameters
[2023-07-04 19:04:14] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:04:14] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:04:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:04:14] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-07-04 19:04:14] [data] Shuffling data
[2023-07-04 19:04:14] [data] Done reading 20,192 sentences
[2023-07-04 19:04:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:04:14] Training started
[2023-07-04 19:04:14] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 19:04:14] [logits] Applying loss function for 1 factor(s)
[2023-07-04 19:04:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 19:04:14] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:04:14] Parameter type float32, optimization type float32, casting types false
[2023-07-04 19:04:43] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 1.38994896 * 1,335,891 @ 1,435 after 24,146,526 : Time 33.09s : 40377.37 words/s : gNorm 1.0377
[2023-07-04 19:04:58] Seen 18,843 samples
[2023-07-04 19:04:58] Starting data epoch 62 in logical epoch 62
[2023-07-04 19:04:58] [data] Shuffling data
[2023-07-04 19:04:58] [data] Done reading 20,192 sentences
[2023-07-04 19:04:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:05:46] Seen 18,843 samples
[2023-07-04 19:05:46] Starting data epoch 63 in logical epoch 63
[2023-07-04 19:05:46] [data] Shuffling data
[2023-07-04 19:05:46] [data] Done reading 20,192 sentences
[2023-07-04 19:05:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:06:37] Seen 18,843 samples
[2023-07-04 19:06:37] Starting data epoch 64 in logical epoch 64
[2023-07-04 19:06:37] [data] Shuffling data
[2023-07-04 19:06:37] [data] Done reading 20,192 sentences
[2023-07-04 19:06:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:07:26] Seen 18,843 samples
[2023-07-04 19:07:26] Starting data epoch 65 in logical epoch 65
[2023-07-04 19:07:26] [data] Shuffling data
[2023-07-04 19:07:26] [data] Done reading 20,192 sentences
[2023-07-04 19:07:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:07:28] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 1.25484943 * 1,337,858 @ 479 after 25,484,384 : Time 165.21s : 8097.82 words/s : gNorm 0.9963
[2023-07-04 19:08:16] Seen 18,843 samples
[2023-07-04 19:08:16] Starting data epoch 66 in logical epoch 66
[2023-07-04 19:08:16] [data] Shuffling data
[2023-07-04 19:08:16] [data] Done reading 20,192 sentences
[2023-07-04 19:08:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:09:05] Seen 18,843 samples
[2023-07-04 19:09:05] Starting data epoch 67 in logical epoch 67
[2023-07-04 19:09:05] [data] Shuffling data
[2023-07-04 19:09:05] [data] Done reading 20,192 sentences
[2023-07-04 19:09:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:09:56] Seen 18,843 samples
[2023-07-04 19:09:56] Starting data epoch 68 in logical epoch 68
[2023-07-04 19:09:56] [data] Shuffling data
[2023-07-04 19:09:56] [data] Done reading 20,192 sentences
[2023-07-04 19:09:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:10:18] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 1.12402701 * 1,354,931 @ 1,600 after 26,839,315 : Time 169.87s : 7976.14 words/s : gNorm 1.0745
[2023-07-04 19:10:18] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:10:21] Saving Adam parameters
[2023-07-04 19:10:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:10:56] Seen 18,843 samples
[2023-07-04 19:10:56] Starting data epoch 69 in logical epoch 69
[2023-07-04 19:10:56] [data] Shuffling data
[2023-07-04 19:10:56] [data] Done reading 20,192 sentences
[2023-07-04 19:10:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:11:45] Seen 18,843 samples
[2023-07-04 19:11:46] Starting data epoch 70 in logical epoch 70
[2023-07-04 19:11:46] [data] Shuffling data
[2023-07-04 19:11:46] [data] Done reading 20,192 sentences
[2023-07-04 19:11:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:12:34] Seen 18,843 samples
[2023-07-04 19:12:34] Starting data epoch 71 in logical epoch 71
[2023-07-04 19:12:34] Training finished
[2023-07-04 19:12:41] [valid] Ep. 71 : Up. 20760 : cross-entropy : 165.897 : stalled 6 times (last best: 108.414)
[2023-07-04 19:14:50] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-07-04 19:14:50] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:14:54] Saving Adam parameters
[2023-07-04 19:14:55] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:15:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:15:08] [marian] Running on node07.datos.cluster.uy as process 11519 with command line:
[2023-07-04 19:15:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:15:09] [config] after: 0e
[2023-07-04 19:15:09] [config] after-batches: 0
[2023-07-04 19:15:09] [config] after-epochs: 80
[2023-07-04 19:15:09] [config] all-caps-every: 0
[2023-07-04 19:15:09] [config] allow-unk: false
[2023-07-04 19:15:09] [config] authors: false
[2023-07-04 19:15:09] [config] beam-size: 12
[2023-07-04 19:15:09] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:15:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:15:09] [config] bert-masking-fraction: 0.15
[2023-07-04 19:15:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:15:09] [config] bert-train-type-embeddings: true
[2023-07-04 19:15:09] [config] bert-type-vocab-size: 2
[2023-07-04 19:15:09] [config] build-info: ""
[2023-07-04 19:15:09] [config] check-gradient-nan: false
[2023-07-04 19:15:09] [config] check-nan: false
[2023-07-04 19:15:09] [config] cite: false
[2023-07-04 19:15:09] [config] clip-norm: 1
[2023-07-04 19:15:09] [config] cost-scaling:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] cost-type: ce-sum
[2023-07-04 19:15:09] [config] cpu-threads: 0
[2023-07-04 19:15:09] [config] data-threads: 8
[2023-07-04 19:15:09] [config] data-weighting: ""
[2023-07-04 19:15:09] [config] data-weighting-type: sentence
[2023-07-04 19:15:09] [config] dec-cell: gru
[2023-07-04 19:15:09] [config] dec-cell-base-depth: 2
[2023-07-04 19:15:09] [config] dec-cell-high-depth: 1
[2023-07-04 19:15:09] [config] dec-depth: 1
[2023-07-04 19:15:09] [config] devices:
[2023-07-04 19:15:09] [config]   - 0
[2023-07-04 19:15:09] [config] dim-emb: 512
[2023-07-04 19:15:09] [config] dim-rnn: 1024
[2023-07-04 19:15:09] [config] dim-vocabs:
[2023-07-04 19:15:09] [config]   - 54042
[2023-07-04 19:15:09] [config]   - 36507
[2023-07-04 19:15:09] [config] disp-first: 0
[2023-07-04 19:15:09] [config] disp-freq: 1000u
[2023-07-04 19:15:09] [config] disp-label-counts: true
[2023-07-04 19:15:09] [config] dropout-rnn: 0
[2023-07-04 19:15:09] [config] dropout-src: 0
[2023-07-04 19:15:09] [config] dropout-trg: 0
[2023-07-04 19:15:09] [config] dump-config: ""
[2023-07-04 19:15:09] [config] dynamic-gradient-scaling:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] early-stopping: 10
[2023-07-04 19:15:09] [config] early-stopping-on: first
[2023-07-04 19:15:09] [config] embedding-fix-src: false
[2023-07-04 19:15:09] [config] embedding-fix-trg: false
[2023-07-04 19:15:09] [config] embedding-normalization: false
[2023-07-04 19:15:09] [config] embedding-vectors:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] enc-cell: gru
[2023-07-04 19:15:09] [config] enc-cell-depth: 1
[2023-07-04 19:15:09] [config] enc-depth: 1
[2023-07-04 19:15:09] [config] enc-type: bidirectional
[2023-07-04 19:15:09] [config] english-title-case-every: 0
[2023-07-04 19:15:09] [config] exponential-smoothing: 0
[2023-07-04 19:15:09] [config] factor-weight: 1
[2023-07-04 19:15:09] [config] factors-combine: sum
[2023-07-04 19:15:09] [config] factors-dim-emb: 0
[2023-07-04 19:15:09] [config] gradient-checkpointing: false
[2023-07-04 19:15:09] [config] gradient-norm-average-window: 100
[2023-07-04 19:15:09] [config] guided-alignment: none
[2023-07-04 19:15:09] [config] guided-alignment-cost: mse
[2023-07-04 19:15:09] [config] guided-alignment-weight: 0.1
[2023-07-04 19:15:09] [config] ignore-model-config: false
[2023-07-04 19:15:09] [config] input-types:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] interpolate-env-vars: false
[2023-07-04 19:15:09] [config] keep-best: false
[2023-07-04 19:15:09] [config] label-smoothing: 0
[2023-07-04 19:15:09] [config] layer-normalization: false
[2023-07-04 19:15:09] [config] learn-rate: 0.0001
[2023-07-04 19:15:09] [config] lemma-dependency: ""
[2023-07-04 19:15:09] [config] lemma-dim-emb: 0
[2023-07-04 19:15:09] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:15:09] [config] log-level: info
[2023-07-04 19:15:09] [config] log-time-zone: ""
[2023-07-04 19:15:09] [config] logical-epoch:
[2023-07-04 19:15:09] [config]   - 1e
[2023-07-04 19:15:09] [config]   - 0
[2023-07-04 19:15:09] [config] lr-decay: 0
[2023-07-04 19:15:09] [config] lr-decay-freq: 50000
[2023-07-04 19:15:09] [config] lr-decay-inv-sqrt:
[2023-07-04 19:15:09] [config]   - 0
[2023-07-04 19:15:09] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:15:09] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:15:09] [config] lr-decay-start:
[2023-07-04 19:15:09] [config]   - 10
[2023-07-04 19:15:09] [config]   - 1
[2023-07-04 19:15:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:15:09] [config] lr-report: false
[2023-07-04 19:15:09] [config] lr-warmup: 0
[2023-07-04 19:15:09] [config] lr-warmup-at-reload: false
[2023-07-04 19:15:09] [config] lr-warmup-cycle: false
[2023-07-04 19:15:09] [config] lr-warmup-start-rate: 0
[2023-07-04 19:15:09] [config] max-length: 50
[2023-07-04 19:15:09] [config] max-length-crop: false
[2023-07-04 19:15:09] [config] max-length-factor: 3
[2023-07-04 19:15:09] [config] maxi-batch: 100
[2023-07-04 19:15:09] [config] maxi-batch-sort: trg
[2023-07-04 19:15:09] [config] mini-batch: 64
[2023-07-04 19:15:09] [config] mini-batch-fit: false
[2023-07-04 19:15:09] [config] mini-batch-fit-step: 10
[2023-07-04 19:15:09] [config] mini-batch-round-up: true
[2023-07-04 19:15:09] [config] mini-batch-track-lr: false
[2023-07-04 19:15:09] [config] mini-batch-warmup: 0
[2023-07-04 19:15:09] [config] mini-batch-words: 0
[2023-07-04 19:15:09] [config] mini-batch-words-ref: 0
[2023-07-04 19:15:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:15:09] [config] multi-loss-type: sum
[2023-07-04 19:15:09] [config] n-best: false
[2023-07-04 19:15:09] [config] no-nccl: false
[2023-07-04 19:15:09] [config] no-reload: false
[2023-07-04 19:15:09] [config] no-restore-corpus: false
[2023-07-04 19:15:09] [config] normalize: 0
[2023-07-04 19:15:09] [config] normalize-gradient: false
[2023-07-04 19:15:09] [config] num-devices: 0
[2023-07-04 19:15:09] [config] optimizer: adam
[2023-07-04 19:15:09] [config] optimizer-delay: 1
[2023-07-04 19:15:09] [config] optimizer-params:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] output-omit-bias: false
[2023-07-04 19:15:09] [config] overwrite: true
[2023-07-04 19:15:09] [config] precision:
[2023-07-04 19:15:09] [config]   - float32
[2023-07-04 19:15:09] [config]   - float32
[2023-07-04 19:15:09] [config] pretrained-model: ""
[2023-07-04 19:15:09] [config] quantize-biases: false
[2023-07-04 19:15:09] [config] quantize-bits: 0
[2023-07-04 19:15:09] [config] quantize-log-based: false
[2023-07-04 19:15:09] [config] quantize-optimization-steps: 0
[2023-07-04 19:15:09] [config] quiet: false
[2023-07-04 19:15:09] [config] quiet-translation: true
[2023-07-04 19:15:09] [config] relative-paths: false
[2023-07-04 19:15:09] [config] right-left: false
[2023-07-04 19:15:09] [config] save-freq: 10000u
[2023-07-04 19:15:09] [config] seed: 1234
[2023-07-04 19:15:09] [config] sentencepiece-alphas:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:15:09] [config] sentencepiece-options: ""
[2023-07-04 19:15:09] [config] sharding: global
[2023-07-04 19:15:09] [config] shuffle: data
[2023-07-04 19:15:09] [config] shuffle-in-ram: false
[2023-07-04 19:15:09] [config] sigterm: save-and-exit
[2023-07-04 19:15:09] [config] skip: false
[2023-07-04 19:15:09] [config] sqlite: ""
[2023-07-04 19:15:09] [config] sqlite-drop: false
[2023-07-04 19:15:09] [config] sync-freq: 200u
[2023-07-04 19:15:09] [config] sync-sgd: false
[2023-07-04 19:15:09] [config] tempdir: /tmp
[2023-07-04 19:15:09] [config] tied-embeddings: false
[2023-07-04 19:15:09] [config] tied-embeddings-all: false
[2023-07-04 19:15:09] [config] tied-embeddings-src: false
[2023-07-04 19:15:09] [config] train-embedder-rank:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] train-sets:
[2023-07-04 19:15:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:15:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:15:09] [config] transformer-aan-activation: swish
[2023-07-04 19:15:09] [config] transformer-aan-depth: 2
[2023-07-04 19:15:09] [config] transformer-aan-nogate: false
[2023-07-04 19:15:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:15:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:15:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:15:09] [config] transformer-depth-scaling: false
[2023-07-04 19:15:09] [config] transformer-dim-aan: 2048
[2023-07-04 19:15:09] [config] transformer-dim-ffn: 2048
[2023-07-04 19:15:09] [config] transformer-dropout: 0
[2023-07-04 19:15:09] [config] transformer-dropout-attention: 0
[2023-07-04 19:15:09] [config] transformer-dropout-ffn: 0
[2023-07-04 19:15:09] [config] transformer-ffn-activation: swish
[2023-07-04 19:15:09] [config] transformer-ffn-depth: 2
[2023-07-04 19:15:09] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:15:09] [config] transformer-heads: 8
[2023-07-04 19:15:09] [config] transformer-no-projection: false
[2023-07-04 19:15:09] [config] transformer-pool: false
[2023-07-04 19:15:09] [config] transformer-postprocess: dan
[2023-07-04 19:15:09] [config] transformer-postprocess-emb: d
[2023-07-04 19:15:09] [config] transformer-postprocess-top: ""
[2023-07-04 19:15:09] [config] transformer-preprocess: ""
[2023-07-04 19:15:09] [config] transformer-tied-layers:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] transformer-train-position-embeddings: false
[2023-07-04 19:15:09] [config] tsv: false
[2023-07-04 19:15:09] [config] tsv-fields: 0
[2023-07-04 19:15:09] [config] type: s2s
[2023-07-04 19:15:09] [config] ulr: false
[2023-07-04 19:15:09] [config] ulr-dim-emb: 0
[2023-07-04 19:15:09] [config] ulr-dropout: 0
[2023-07-04 19:15:09] [config] ulr-keys-vectors: ""
[2023-07-04 19:15:09] [config] ulr-query-vectors: ""
[2023-07-04 19:15:09] [config] ulr-softmax-temperature: 1
[2023-07-04 19:15:09] [config] ulr-trainable-transformation: false
[2023-07-04 19:15:09] [config] unlikelihood-loss: false
[2023-07-04 19:15:09] [config] valid-freq: 50000000
[2023-07-04 19:15:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:15:09] [config] valid-max-length: 1000
[2023-07-04 19:15:09] [config] valid-metrics:
[2023-07-04 19:15:09] [config]   - cross-entropy
[2023-07-04 19:15:09] [config]   - translation
[2023-07-04 19:15:09] [config] valid-mini-batch: 32
[2023-07-04 19:15:09] [config] valid-reset-stalled: false
[2023-07-04 19:15:09] [config] valid-script-args:
[2023-07-04 19:15:09] [config]   []
[2023-07-04 19:15:09] [config] valid-script-path: ""
[2023-07-04 19:15:09] [config] valid-sets:
[2023-07-04 19:15:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:15:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:15:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:15:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:15:09] [config] vocabs:
[2023-07-04 19:15:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:15:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:15:09] [config] word-penalty: 0
[2023-07-04 19:15:09] [config] word-scores: false
[2023-07-04 19:15:09] [config] workspace: 2048
[2023-07-04 19:15:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:15:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:15:09] [training] Using single-device training
[2023-07-04 19:15:09] Synced seed 1234
[2023-07-04 19:15:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:15:09] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:15:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:15:09] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:15:09] [valid] No post-processing script given for validating translator
[2023-07-04 19:15:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:15:10] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:15:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:15:10] [comm] Using global sharding
[2023-07-04 19:15:10] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:15:10] [training] Using 1 GPUs
[2023-07-04 19:15:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:15:12] Loading Adam parameters
[2023-07-04 19:15:13] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:15:13] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:15:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:15:13] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-07-04 19:15:13] [data] Shuffling data
[2023-07-04 19:15:13] [data] Done reading 20,192 sentences
[2023-07-04 19:15:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:15:13] Training started
[2023-07-04 19:15:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 19:15:13] [logits] Applying loss function for 1 factor(s)
[2023-07-04 19:15:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 19:15:13] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:15:13] Parameter type float32, optimization type float32, casting types false
[2023-07-04 19:15:48] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.99167722 * 1,330,991 @ 1,562 after 28,170,306 : Time 38.82s : 34284.44 words/s : gNorm 0.9882
[2023-07-04 19:15:58] Seen 18,843 samples
[2023-07-04 19:15:58] Starting data epoch 72 in logical epoch 72
[2023-07-04 19:15:58] [data] Shuffling data
[2023-07-04 19:15:58] [data] Done reading 20,192 sentences
[2023-07-04 19:15:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:16:46] Seen 18,843 samples
[2023-07-04 19:16:46] Starting data epoch 73 in logical epoch 73
[2023-07-04 19:16:46] [data] Shuffling data
[2023-07-04 19:16:46] [data] Done reading 20,192 sentences
[2023-07-04 19:16:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:17:35] Seen 18,843 samples
[2023-07-04 19:17:35] Starting data epoch 74 in logical epoch 74
[2023-07-04 19:17:35] [data] Shuffling data
[2023-07-04 19:17:35] [data] Done reading 20,192 sentences
[2023-07-04 19:17:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:18:24] Seen 18,843 samples
[2023-07-04 19:18:24] Starting data epoch 75 in logical epoch 75
[2023-07-04 19:18:24] [data] Shuffling data
[2023-07-04 19:18:24] [data] Done reading 20,192 sentences
[2023-07-04 19:18:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:18:33] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.88431448 * 1,344,658 @ 2,757 after 29,514,964 : Time 165.44s : 8127.90 words/s : gNorm 0.9018
[2023-07-04 19:19:14] Seen 18,843 samples
[2023-07-04 19:19:14] Starting data epoch 76 in logical epoch 76
[2023-07-04 19:19:14] [data] Shuffling data
[2023-07-04 19:19:14] [data] Done reading 20,192 sentences
[2023-07-04 19:19:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:20:03] Seen 18,843 samples
[2023-07-04 19:20:03] Starting data epoch 77 in logical epoch 77
[2023-07-04 19:20:03] [data] Shuffling data
[2023-07-04 19:20:03] [data] Done reading 20,192 sentences
[2023-07-04 19:20:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:20:52] Seen 18,843 samples
[2023-07-04 19:20:52] Starting data epoch 78 in logical epoch 78
[2023-07-04 19:20:52] [data] Shuffling data
[2023-07-04 19:20:52] [data] Done reading 20,192 sentences
[2023-07-04 19:20:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:21:19] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.78431833 * 1,340,855 @ 527 after 30,855,819 : Time 165.68s : 8093.04 words/s : gNorm 0.8234
[2023-07-04 19:21:41] Seen 18,843 samples
[2023-07-04 19:21:41] Starting data epoch 79 in logical epoch 79
[2023-07-04 19:21:41] [data] Shuffling data
[2023-07-04 19:21:41] [data] Done reading 20,192 sentences
[2023-07-04 19:21:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:22:31] Seen 18,843 samples
[2023-07-04 19:22:31] Starting data epoch 80 in logical epoch 80
[2023-07-04 19:22:31] [data] Shuffling data
[2023-07-04 19:22:31] [data] Done reading 20,192 sentences
[2023-07-04 19:22:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:23:20] Seen 18,843 samples
[2023-07-04 19:23:21] Starting data epoch 81 in logical epoch 81
[2023-07-04 19:23:21] Training finished
[2023-07-04 19:23:27] [valid] Ep. 81 : Up. 23727 : cross-entropy : 174.653 : stalled 7 times (last best: 108.414)
[2023-07-04 19:25:39] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-07-04 19:25:39] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:25:44] Saving Adam parameters
[2023-07-04 19:25:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:26:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:26:04] [marian] Running on node07.datos.cluster.uy as process 12135 with command line:
[2023-07-04 19:26:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:26:04] [config] after: 0e
[2023-07-04 19:26:04] [config] after-batches: 0
[2023-07-04 19:26:04] [config] after-epochs: 90
[2023-07-04 19:26:04] [config] all-caps-every: 0
[2023-07-04 19:26:04] [config] allow-unk: false
[2023-07-04 19:26:04] [config] authors: false
[2023-07-04 19:26:04] [config] beam-size: 12
[2023-07-04 19:26:04] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:26:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:26:04] [config] bert-masking-fraction: 0.15
[2023-07-04 19:26:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:26:04] [config] bert-train-type-embeddings: true
[2023-07-04 19:26:04] [config] bert-type-vocab-size: 2
[2023-07-04 19:26:04] [config] build-info: ""
[2023-07-04 19:26:04] [config] check-gradient-nan: false
[2023-07-04 19:26:04] [config] check-nan: false
[2023-07-04 19:26:04] [config] cite: false
[2023-07-04 19:26:04] [config] clip-norm: 1
[2023-07-04 19:26:04] [config] cost-scaling:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] cost-type: ce-sum
[2023-07-04 19:26:04] [config] cpu-threads: 0
[2023-07-04 19:26:04] [config] data-threads: 8
[2023-07-04 19:26:04] [config] data-weighting: ""
[2023-07-04 19:26:04] [config] data-weighting-type: sentence
[2023-07-04 19:26:04] [config] dec-cell: gru
[2023-07-04 19:26:04] [config] dec-cell-base-depth: 2
[2023-07-04 19:26:04] [config] dec-cell-high-depth: 1
[2023-07-04 19:26:04] [config] dec-depth: 1
[2023-07-04 19:26:04] [config] devices:
[2023-07-04 19:26:04] [config]   - 0
[2023-07-04 19:26:04] [config] dim-emb: 512
[2023-07-04 19:26:04] [config] dim-rnn: 1024
[2023-07-04 19:26:04] [config] dim-vocabs:
[2023-07-04 19:26:04] [config]   - 54042
[2023-07-04 19:26:04] [config]   - 36507
[2023-07-04 19:26:04] [config] disp-first: 0
[2023-07-04 19:26:04] [config] disp-freq: 1000u
[2023-07-04 19:26:04] [config] disp-label-counts: true
[2023-07-04 19:26:04] [config] dropout-rnn: 0
[2023-07-04 19:26:04] [config] dropout-src: 0
[2023-07-04 19:26:04] [config] dropout-trg: 0
[2023-07-04 19:26:04] [config] dump-config: ""
[2023-07-04 19:26:04] [config] dynamic-gradient-scaling:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] early-stopping: 10
[2023-07-04 19:26:04] [config] early-stopping-on: first
[2023-07-04 19:26:04] [config] embedding-fix-src: false
[2023-07-04 19:26:04] [config] embedding-fix-trg: false
[2023-07-04 19:26:04] [config] embedding-normalization: false
[2023-07-04 19:26:04] [config] embedding-vectors:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] enc-cell: gru
[2023-07-04 19:26:04] [config] enc-cell-depth: 1
[2023-07-04 19:26:04] [config] enc-depth: 1
[2023-07-04 19:26:04] [config] enc-type: bidirectional
[2023-07-04 19:26:04] [config] english-title-case-every: 0
[2023-07-04 19:26:04] [config] exponential-smoothing: 0
[2023-07-04 19:26:04] [config] factor-weight: 1
[2023-07-04 19:26:04] [config] factors-combine: sum
[2023-07-04 19:26:04] [config] factors-dim-emb: 0
[2023-07-04 19:26:04] [config] gradient-checkpointing: false
[2023-07-04 19:26:04] [config] gradient-norm-average-window: 100
[2023-07-04 19:26:04] [config] guided-alignment: none
[2023-07-04 19:26:04] [config] guided-alignment-cost: mse
[2023-07-04 19:26:04] [config] guided-alignment-weight: 0.1
[2023-07-04 19:26:04] [config] ignore-model-config: false
[2023-07-04 19:26:04] [config] input-types:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] interpolate-env-vars: false
[2023-07-04 19:26:04] [config] keep-best: false
[2023-07-04 19:26:04] [config] label-smoothing: 0
[2023-07-04 19:26:04] [config] layer-normalization: false
[2023-07-04 19:26:04] [config] learn-rate: 0.0001
[2023-07-04 19:26:04] [config] lemma-dependency: ""
[2023-07-04 19:26:04] [config] lemma-dim-emb: 0
[2023-07-04 19:26:04] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:26:04] [config] log-level: info
[2023-07-04 19:26:04] [config] log-time-zone: ""
[2023-07-04 19:26:04] [config] logical-epoch:
[2023-07-04 19:26:04] [config]   - 1e
[2023-07-04 19:26:04] [config]   - 0
[2023-07-04 19:26:04] [config] lr-decay: 0
[2023-07-04 19:26:04] [config] lr-decay-freq: 50000
[2023-07-04 19:26:04] [config] lr-decay-inv-sqrt:
[2023-07-04 19:26:04] [config]   - 0
[2023-07-04 19:26:04] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:26:04] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:26:04] [config] lr-decay-start:
[2023-07-04 19:26:04] [config]   - 10
[2023-07-04 19:26:04] [config]   - 1
[2023-07-04 19:26:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:26:04] [config] lr-report: false
[2023-07-04 19:26:04] [config] lr-warmup: 0
[2023-07-04 19:26:04] [config] lr-warmup-at-reload: false
[2023-07-04 19:26:04] [config] lr-warmup-cycle: false
[2023-07-04 19:26:04] [config] lr-warmup-start-rate: 0
[2023-07-04 19:26:04] [config] max-length: 50
[2023-07-04 19:26:04] [config] max-length-crop: false
[2023-07-04 19:26:04] [config] max-length-factor: 3
[2023-07-04 19:26:04] [config] maxi-batch: 100
[2023-07-04 19:26:04] [config] maxi-batch-sort: trg
[2023-07-04 19:26:04] [config] mini-batch: 64
[2023-07-04 19:26:04] [config] mini-batch-fit: false
[2023-07-04 19:26:04] [config] mini-batch-fit-step: 10
[2023-07-04 19:26:04] [config] mini-batch-round-up: true
[2023-07-04 19:26:04] [config] mini-batch-track-lr: false
[2023-07-04 19:26:04] [config] mini-batch-warmup: 0
[2023-07-04 19:26:04] [config] mini-batch-words: 0
[2023-07-04 19:26:04] [config] mini-batch-words-ref: 0
[2023-07-04 19:26:04] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:26:04] [config] multi-loss-type: sum
[2023-07-04 19:26:04] [config] n-best: false
[2023-07-04 19:26:04] [config] no-nccl: false
[2023-07-04 19:26:04] [config] no-reload: false
[2023-07-04 19:26:04] [config] no-restore-corpus: false
[2023-07-04 19:26:04] [config] normalize: 0
[2023-07-04 19:26:04] [config] normalize-gradient: false
[2023-07-04 19:26:04] [config] num-devices: 0
[2023-07-04 19:26:04] [config] optimizer: adam
[2023-07-04 19:26:04] [config] optimizer-delay: 1
[2023-07-04 19:26:04] [config] optimizer-params:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] output-omit-bias: false
[2023-07-04 19:26:04] [config] overwrite: true
[2023-07-04 19:26:04] [config] precision:
[2023-07-04 19:26:04] [config]   - float32
[2023-07-04 19:26:04] [config]   - float32
[2023-07-04 19:26:04] [config] pretrained-model: ""
[2023-07-04 19:26:04] [config] quantize-biases: false
[2023-07-04 19:26:04] [config] quantize-bits: 0
[2023-07-04 19:26:04] [config] quantize-log-based: false
[2023-07-04 19:26:04] [config] quantize-optimization-steps: 0
[2023-07-04 19:26:04] [config] quiet: false
[2023-07-04 19:26:04] [config] quiet-translation: true
[2023-07-04 19:26:04] [config] relative-paths: false
[2023-07-04 19:26:04] [config] right-left: false
[2023-07-04 19:26:04] [config] save-freq: 10000u
[2023-07-04 19:26:04] [config] seed: 1234
[2023-07-04 19:26:04] [config] sentencepiece-alphas:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:26:04] [config] sentencepiece-options: ""
[2023-07-04 19:26:04] [config] sharding: global
[2023-07-04 19:26:04] [config] shuffle: data
[2023-07-04 19:26:04] [config] shuffle-in-ram: false
[2023-07-04 19:26:04] [config] sigterm: save-and-exit
[2023-07-04 19:26:04] [config] skip: false
[2023-07-04 19:26:04] [config] sqlite: ""
[2023-07-04 19:26:04] [config] sqlite-drop: false
[2023-07-04 19:26:04] [config] sync-freq: 200u
[2023-07-04 19:26:04] [config] sync-sgd: false
[2023-07-04 19:26:04] [config] tempdir: /tmp
[2023-07-04 19:26:04] [config] tied-embeddings: false
[2023-07-04 19:26:04] [config] tied-embeddings-all: false
[2023-07-04 19:26:04] [config] tied-embeddings-src: false
[2023-07-04 19:26:04] [config] train-embedder-rank:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] train-sets:
[2023-07-04 19:26:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:26:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:26:04] [config] transformer-aan-activation: swish
[2023-07-04 19:26:04] [config] transformer-aan-depth: 2
[2023-07-04 19:26:04] [config] transformer-aan-nogate: false
[2023-07-04 19:26:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:26:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:26:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:26:04] [config] transformer-depth-scaling: false
[2023-07-04 19:26:04] [config] transformer-dim-aan: 2048
[2023-07-04 19:26:04] [config] transformer-dim-ffn: 2048
[2023-07-04 19:26:04] [config] transformer-dropout: 0
[2023-07-04 19:26:04] [config] transformer-dropout-attention: 0
[2023-07-04 19:26:04] [config] transformer-dropout-ffn: 0
[2023-07-04 19:26:04] [config] transformer-ffn-activation: swish
[2023-07-04 19:26:04] [config] transformer-ffn-depth: 2
[2023-07-04 19:26:04] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:26:04] [config] transformer-heads: 8
[2023-07-04 19:26:04] [config] transformer-no-projection: false
[2023-07-04 19:26:04] [config] transformer-pool: false
[2023-07-04 19:26:04] [config] transformer-postprocess: dan
[2023-07-04 19:26:04] [config] transformer-postprocess-emb: d
[2023-07-04 19:26:04] [config] transformer-postprocess-top: ""
[2023-07-04 19:26:04] [config] transformer-preprocess: ""
[2023-07-04 19:26:04] [config] transformer-tied-layers:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] transformer-train-position-embeddings: false
[2023-07-04 19:26:04] [config] tsv: false
[2023-07-04 19:26:04] [config] tsv-fields: 0
[2023-07-04 19:26:04] [config] type: s2s
[2023-07-04 19:26:04] [config] ulr: false
[2023-07-04 19:26:04] [config] ulr-dim-emb: 0
[2023-07-04 19:26:04] [config] ulr-dropout: 0
[2023-07-04 19:26:04] [config] ulr-keys-vectors: ""
[2023-07-04 19:26:04] [config] ulr-query-vectors: ""
[2023-07-04 19:26:04] [config] ulr-softmax-temperature: 1
[2023-07-04 19:26:04] [config] ulr-trainable-transformation: false
[2023-07-04 19:26:04] [config] unlikelihood-loss: false
[2023-07-04 19:26:04] [config] valid-freq: 50000000
[2023-07-04 19:26:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:26:04] [config] valid-max-length: 1000
[2023-07-04 19:26:04] [config] valid-metrics:
[2023-07-04 19:26:04] [config]   - cross-entropy
[2023-07-04 19:26:04] [config]   - translation
[2023-07-04 19:26:04] [config] valid-mini-batch: 32
[2023-07-04 19:26:04] [config] valid-reset-stalled: false
[2023-07-04 19:26:04] [config] valid-script-args:
[2023-07-04 19:26:04] [config]   []
[2023-07-04 19:26:04] [config] valid-script-path: ""
[2023-07-04 19:26:04] [config] valid-sets:
[2023-07-04 19:26:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:26:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:26:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:26:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:26:04] [config] vocabs:
[2023-07-04 19:26:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:26:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:26:04] [config] word-penalty: 0
[2023-07-04 19:26:04] [config] word-scores: false
[2023-07-04 19:26:04] [config] workspace: 2048
[2023-07-04 19:26:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:26:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:26:04] [training] Using single-device training
[2023-07-04 19:26:05] Synced seed 1234
[2023-07-04 19:26:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:26:05] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:26:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:26:05] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:26:05] [valid] No post-processing script given for validating translator
[2023-07-04 19:26:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:26:06] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:26:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:26:06] [comm] Using global sharding
[2023-07-04 19:26:06] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:26:06] [training] Using 1 GPUs
[2023-07-04 19:26:06] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:26:08] Loading Adam parameters
[2023-07-04 19:26:09] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:26:09] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:26:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:26:09] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-07-04 19:26:09] [data] Shuffling data
[2023-07-04 19:26:09] [data] Done reading 20,192 sentences
[2023-07-04 19:26:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:26:09] Training started
[2023-07-04 19:26:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 19:26:09] [logits] Applying loss function for 1 factor(s)
[2023-07-04 19:26:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 19:26:09] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:26:09] Parameter type float32, optimization type float32, casting types false
[2023-07-04 19:26:49] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.68321121 * 1,343,267 @ 832 after 32,199,086 : Time 44.08s : 30476.54 words/s : gNorm 0.8948
[2023-07-04 19:26:53] Seen 18,843 samples
[2023-07-04 19:26:53] Starting data epoch 82 in logical epoch 82
[2023-07-04 19:26:53] [data] Shuffling data
[2023-07-04 19:26:53] [data] Done reading 20,192 sentences
[2023-07-04 19:26:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:27:41] Seen 18,843 samples
[2023-07-04 19:27:41] Starting data epoch 83 in logical epoch 83
[2023-07-04 19:27:41] [data] Shuffling data
[2023-07-04 19:27:41] [data] Done reading 20,192 sentences
[2023-07-04 19:27:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:28:32] Seen 18,843 samples
[2023-07-04 19:28:32] Starting data epoch 84 in logical epoch 84
[2023-07-04 19:28:32] [data] Shuffling data
[2023-07-04 19:28:32] [data] Done reading 20,192 sentences
[2023-07-04 19:28:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:29:21] Seen 18,843 samples
[2023-07-04 19:29:21] Starting data epoch 85 in logical epoch 85
[2023-07-04 19:29:21] [data] Shuffling data
[2023-07-04 19:29:21] [data] Done reading 20,192 sentences
[2023-07-04 19:29:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:29:35] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.59371531 * 1,339,320 @ 1,280 after 33,538,406 : Time 165.83s : 8076.38 words/s : gNorm 0.7441
[2023-07-04 19:30:10] Seen 18,843 samples
[2023-07-04 19:30:10] Starting data epoch 86 in logical epoch 86
[2023-07-04 19:30:10] [data] Shuffling data
[2023-07-04 19:30:10] [data] Done reading 20,192 sentences
[2023-07-04 19:30:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:30:59] Seen 18,843 samples
[2023-07-04 19:30:59] Starting data epoch 87 in logical epoch 87
[2023-07-04 19:30:59] [data] Shuffling data
[2023-07-04 19:30:59] [data] Done reading 20,192 sentences
[2023-07-04 19:30:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:31:48] Seen 18,843 samples
[2023-07-04 19:31:48] Starting data epoch 88 in logical epoch 88
[2023-07-04 19:31:48] [data] Shuffling data
[2023-07-04 19:31:48] [data] Done reading 20,192 sentences
[2023-07-04 19:31:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:32:21] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.51636434 * 1,346,822 @ 896 after 34,885,228 : Time 166.11s : 8107.84 words/s : gNorm 0.7508
[2023-07-04 19:32:37] Seen 18,843 samples
[2023-07-04 19:32:37] Starting data epoch 89 in logical epoch 89
[2023-07-04 19:32:37] [data] Shuffling data
[2023-07-04 19:32:37] [data] Done reading 20,192 sentences
[2023-07-04 19:32:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:33:26] Seen 18,843 samples
[2023-07-04 19:33:26] Starting data epoch 90 in logical epoch 90
[2023-07-04 19:33:26] [data] Shuffling data
[2023-07-04 19:33:26] [data] Done reading 20,192 sentences
[2023-07-04 19:33:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:34:15] Seen 18,843 samples
[2023-07-04 19:34:15] Starting data epoch 91 in logical epoch 91
[2023-07-04 19:34:15] Training finished
[2023-07-04 19:34:22] [valid] Ep. 91 : Up. 26693 : cross-entropy : 186.311 : stalled 8 times (last best: 108.414)
[2023-07-04 19:36:35] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-07-04 19:36:35] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:36:40] Saving Adam parameters
[2023-07-04 19:36:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:36:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:36:57] [marian] Running on node07.datos.cluster.uy as process 12751 with command line:
[2023-07-04 19:36:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:36:57] [config] after: 0e
[2023-07-04 19:36:57] [config] after-batches: 0
[2023-07-04 19:36:57] [config] after-epochs: 100
[2023-07-04 19:36:57] [config] all-caps-every: 0
[2023-07-04 19:36:57] [config] allow-unk: false
[2023-07-04 19:36:57] [config] authors: false
[2023-07-04 19:36:57] [config] beam-size: 12
[2023-07-04 19:36:57] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:36:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:36:57] [config] bert-masking-fraction: 0.15
[2023-07-04 19:36:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:36:57] [config] bert-train-type-embeddings: true
[2023-07-04 19:36:57] [config] bert-type-vocab-size: 2
[2023-07-04 19:36:57] [config] build-info: ""
[2023-07-04 19:36:57] [config] check-gradient-nan: false
[2023-07-04 19:36:57] [config] check-nan: false
[2023-07-04 19:36:57] [config] cite: false
[2023-07-04 19:36:57] [config] clip-norm: 1
[2023-07-04 19:36:57] [config] cost-scaling:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] cost-type: ce-sum
[2023-07-04 19:36:57] [config] cpu-threads: 0
[2023-07-04 19:36:57] [config] data-threads: 8
[2023-07-04 19:36:57] [config] data-weighting: ""
[2023-07-04 19:36:57] [config] data-weighting-type: sentence
[2023-07-04 19:36:57] [config] dec-cell: gru
[2023-07-04 19:36:57] [config] dec-cell-base-depth: 2
[2023-07-04 19:36:57] [config] dec-cell-high-depth: 1
[2023-07-04 19:36:57] [config] dec-depth: 1
[2023-07-04 19:36:57] [config] devices:
[2023-07-04 19:36:57] [config]   - 0
[2023-07-04 19:36:57] [config] dim-emb: 512
[2023-07-04 19:36:57] [config] dim-rnn: 1024
[2023-07-04 19:36:57] [config] dim-vocabs:
[2023-07-04 19:36:57] [config]   - 54042
[2023-07-04 19:36:57] [config]   - 36507
[2023-07-04 19:36:57] [config] disp-first: 0
[2023-07-04 19:36:57] [config] disp-freq: 1000u
[2023-07-04 19:36:57] [config] disp-label-counts: true
[2023-07-04 19:36:57] [config] dropout-rnn: 0
[2023-07-04 19:36:57] [config] dropout-src: 0
[2023-07-04 19:36:57] [config] dropout-trg: 0
[2023-07-04 19:36:57] [config] dump-config: ""
[2023-07-04 19:36:57] [config] dynamic-gradient-scaling:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] early-stopping: 10
[2023-07-04 19:36:57] [config] early-stopping-on: first
[2023-07-04 19:36:57] [config] embedding-fix-src: false
[2023-07-04 19:36:57] [config] embedding-fix-trg: false
[2023-07-04 19:36:57] [config] embedding-normalization: false
[2023-07-04 19:36:57] [config] embedding-vectors:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] enc-cell: gru
[2023-07-04 19:36:57] [config] enc-cell-depth: 1
[2023-07-04 19:36:57] [config] enc-depth: 1
[2023-07-04 19:36:57] [config] enc-type: bidirectional
[2023-07-04 19:36:57] [config] english-title-case-every: 0
[2023-07-04 19:36:57] [config] exponential-smoothing: 0
[2023-07-04 19:36:57] [config] factor-weight: 1
[2023-07-04 19:36:57] [config] factors-combine: sum
[2023-07-04 19:36:57] [config] factors-dim-emb: 0
[2023-07-04 19:36:57] [config] gradient-checkpointing: false
[2023-07-04 19:36:57] [config] gradient-norm-average-window: 100
[2023-07-04 19:36:57] [config] guided-alignment: none
[2023-07-04 19:36:57] [config] guided-alignment-cost: mse
[2023-07-04 19:36:57] [config] guided-alignment-weight: 0.1
[2023-07-04 19:36:57] [config] ignore-model-config: false
[2023-07-04 19:36:57] [config] input-types:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] interpolate-env-vars: false
[2023-07-04 19:36:57] [config] keep-best: false
[2023-07-04 19:36:57] [config] label-smoothing: 0
[2023-07-04 19:36:57] [config] layer-normalization: false
[2023-07-04 19:36:57] [config] learn-rate: 0.0001
[2023-07-04 19:36:57] [config] lemma-dependency: ""
[2023-07-04 19:36:57] [config] lemma-dim-emb: 0
[2023-07-04 19:36:57] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:36:57] [config] log-level: info
[2023-07-04 19:36:57] [config] log-time-zone: ""
[2023-07-04 19:36:57] [config] logical-epoch:
[2023-07-04 19:36:57] [config]   - 1e
[2023-07-04 19:36:57] [config]   - 0
[2023-07-04 19:36:57] [config] lr-decay: 0
[2023-07-04 19:36:57] [config] lr-decay-freq: 50000
[2023-07-04 19:36:57] [config] lr-decay-inv-sqrt:
[2023-07-04 19:36:57] [config]   - 0
[2023-07-04 19:36:57] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:36:57] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:36:57] [config] lr-decay-start:
[2023-07-04 19:36:57] [config]   - 10
[2023-07-04 19:36:57] [config]   - 1
[2023-07-04 19:36:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:36:57] [config] lr-report: false
[2023-07-04 19:36:57] [config] lr-warmup: 0
[2023-07-04 19:36:57] [config] lr-warmup-at-reload: false
[2023-07-04 19:36:57] [config] lr-warmup-cycle: false
[2023-07-04 19:36:57] [config] lr-warmup-start-rate: 0
[2023-07-04 19:36:57] [config] max-length: 50
[2023-07-04 19:36:57] [config] max-length-crop: false
[2023-07-04 19:36:57] [config] max-length-factor: 3
[2023-07-04 19:36:57] [config] maxi-batch: 100
[2023-07-04 19:36:57] [config] maxi-batch-sort: trg
[2023-07-04 19:36:57] [config] mini-batch: 64
[2023-07-04 19:36:57] [config] mini-batch-fit: false
[2023-07-04 19:36:57] [config] mini-batch-fit-step: 10
[2023-07-04 19:36:57] [config] mini-batch-round-up: true
[2023-07-04 19:36:57] [config] mini-batch-track-lr: false
[2023-07-04 19:36:57] [config] mini-batch-warmup: 0
[2023-07-04 19:36:57] [config] mini-batch-words: 0
[2023-07-04 19:36:57] [config] mini-batch-words-ref: 0
[2023-07-04 19:36:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:36:57] [config] multi-loss-type: sum
[2023-07-04 19:36:57] [config] n-best: false
[2023-07-04 19:36:57] [config] no-nccl: false
[2023-07-04 19:36:57] [config] no-reload: false
[2023-07-04 19:36:57] [config] no-restore-corpus: false
[2023-07-04 19:36:57] [config] normalize: 0
[2023-07-04 19:36:57] [config] normalize-gradient: false
[2023-07-04 19:36:57] [config] num-devices: 0
[2023-07-04 19:36:57] [config] optimizer: adam
[2023-07-04 19:36:57] [config] optimizer-delay: 1
[2023-07-04 19:36:57] [config] optimizer-params:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] output-omit-bias: false
[2023-07-04 19:36:57] [config] overwrite: true
[2023-07-04 19:36:57] [config] precision:
[2023-07-04 19:36:57] [config]   - float32
[2023-07-04 19:36:57] [config]   - float32
[2023-07-04 19:36:57] [config] pretrained-model: ""
[2023-07-04 19:36:57] [config] quantize-biases: false
[2023-07-04 19:36:57] [config] quantize-bits: 0
[2023-07-04 19:36:57] [config] quantize-log-based: false
[2023-07-04 19:36:57] [config] quantize-optimization-steps: 0
[2023-07-04 19:36:57] [config] quiet: false
[2023-07-04 19:36:57] [config] quiet-translation: true
[2023-07-04 19:36:57] [config] relative-paths: false
[2023-07-04 19:36:57] [config] right-left: false
[2023-07-04 19:36:57] [config] save-freq: 10000u
[2023-07-04 19:36:57] [config] seed: 1234
[2023-07-04 19:36:57] [config] sentencepiece-alphas:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:36:57] [config] sentencepiece-options: ""
[2023-07-04 19:36:57] [config] sharding: global
[2023-07-04 19:36:57] [config] shuffle: data
[2023-07-04 19:36:57] [config] shuffle-in-ram: false
[2023-07-04 19:36:57] [config] sigterm: save-and-exit
[2023-07-04 19:36:57] [config] skip: false
[2023-07-04 19:36:57] [config] sqlite: ""
[2023-07-04 19:36:57] [config] sqlite-drop: false
[2023-07-04 19:36:57] [config] sync-freq: 200u
[2023-07-04 19:36:57] [config] sync-sgd: false
[2023-07-04 19:36:57] [config] tempdir: /tmp
[2023-07-04 19:36:57] [config] tied-embeddings: false
[2023-07-04 19:36:57] [config] tied-embeddings-all: false
[2023-07-04 19:36:57] [config] tied-embeddings-src: false
[2023-07-04 19:36:57] [config] train-embedder-rank:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] train-sets:
[2023-07-04 19:36:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:36:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:36:57] [config] transformer-aan-activation: swish
[2023-07-04 19:36:57] [config] transformer-aan-depth: 2
[2023-07-04 19:36:57] [config] transformer-aan-nogate: false
[2023-07-04 19:36:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:36:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:36:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:36:57] [config] transformer-depth-scaling: false
[2023-07-04 19:36:57] [config] transformer-dim-aan: 2048
[2023-07-04 19:36:57] [config] transformer-dim-ffn: 2048
[2023-07-04 19:36:57] [config] transformer-dropout: 0
[2023-07-04 19:36:57] [config] transformer-dropout-attention: 0
[2023-07-04 19:36:57] [config] transformer-dropout-ffn: 0
[2023-07-04 19:36:57] [config] transformer-ffn-activation: swish
[2023-07-04 19:36:57] [config] transformer-ffn-depth: 2
[2023-07-04 19:36:57] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:36:57] [config] transformer-heads: 8
[2023-07-04 19:36:57] [config] transformer-no-projection: false
[2023-07-04 19:36:57] [config] transformer-pool: false
[2023-07-04 19:36:57] [config] transformer-postprocess: dan
[2023-07-04 19:36:57] [config] transformer-postprocess-emb: d
[2023-07-04 19:36:57] [config] transformer-postprocess-top: ""
[2023-07-04 19:36:57] [config] transformer-preprocess: ""
[2023-07-04 19:36:57] [config] transformer-tied-layers:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] transformer-train-position-embeddings: false
[2023-07-04 19:36:57] [config] tsv: false
[2023-07-04 19:36:57] [config] tsv-fields: 0
[2023-07-04 19:36:57] [config] type: s2s
[2023-07-04 19:36:57] [config] ulr: false
[2023-07-04 19:36:57] [config] ulr-dim-emb: 0
[2023-07-04 19:36:57] [config] ulr-dropout: 0
[2023-07-04 19:36:57] [config] ulr-keys-vectors: ""
[2023-07-04 19:36:57] [config] ulr-query-vectors: ""
[2023-07-04 19:36:57] [config] ulr-softmax-temperature: 1
[2023-07-04 19:36:57] [config] ulr-trainable-transformation: false
[2023-07-04 19:36:57] [config] unlikelihood-loss: false
[2023-07-04 19:36:57] [config] valid-freq: 50000000
[2023-07-04 19:36:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:36:57] [config] valid-max-length: 1000
[2023-07-04 19:36:57] [config] valid-metrics:
[2023-07-04 19:36:57] [config]   - cross-entropy
[2023-07-04 19:36:57] [config]   - translation
[2023-07-04 19:36:57] [config] valid-mini-batch: 32
[2023-07-04 19:36:57] [config] valid-reset-stalled: false
[2023-07-04 19:36:57] [config] valid-script-args:
[2023-07-04 19:36:57] [config]   []
[2023-07-04 19:36:57] [config] valid-script-path: ""
[2023-07-04 19:36:57] [config] valid-sets:
[2023-07-04 19:36:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:36:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:36:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:36:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:36:57] [config] vocabs:
[2023-07-04 19:36:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:36:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:36:57] [config] word-penalty: 0
[2023-07-04 19:36:57] [config] word-scores: false
[2023-07-04 19:36:57] [config] workspace: 2048
[2023-07-04 19:36:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:36:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:36:57] [training] Using single-device training
[2023-07-04 19:36:58] Synced seed 1234
[2023-07-04 19:36:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:36:58] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:36:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:36:58] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:36:58] [valid] No post-processing script given for validating translator
[2023-07-04 19:36:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:36:59] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:36:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:36:59] [comm] Using global sharding
[2023-07-04 19:36:59] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:36:59] [training] Using 1 GPUs
[2023-07-04 19:36:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:37:01] Loading Adam parameters
[2023-07-04 19:37:02] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:37:02] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:37:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:37:02] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-07-04 19:37:02] [data] Shuffling data
[2023-07-04 19:37:02] [data] Done reading 20,192 sentences
[2023-07-04 19:37:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:37:02] Training started
[2023-07-04 19:37:02] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 19:37:02] [logits] Applying loss function for 1 factor(s)
[2023-07-04 19:37:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 19:37:02] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:37:02] Parameter type float32, optimization type float32, casting types false
[2023-07-04 19:37:46] Seen 18,843 samples
[2023-07-04 19:37:46] Starting data epoch 92 in logical epoch 92
[2023-07-04 19:37:46] [data] Shuffling data
[2023-07-04 19:37:46] [data] Done reading 20,192 sentences
[2023-07-04 19:37:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:37:47] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.43941560 * 1,333,196 @ 488 after 36,218,424 : Time 48.96s : 27228.11 words/s : gNorm 0.6401
[2023-07-04 19:38:34] Seen 18,843 samples
[2023-07-04 19:38:34] Starting data epoch 93 in logical epoch 93
[2023-07-04 19:38:34] [data] Shuffling data
[2023-07-04 19:38:34] [data] Done reading 20,192 sentences
[2023-07-04 19:38:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:39:25] Seen 18,843 samples
[2023-07-04 19:39:25] Starting data epoch 94 in logical epoch 94
[2023-07-04 19:39:25] [data] Shuffling data
[2023-07-04 19:39:25] [data] Done reading 20,192 sentences
[2023-07-04 19:39:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:40:13] Seen 18,843 samples
[2023-07-04 19:40:13] Starting data epoch 95 in logical epoch 95
[2023-07-04 19:40:13] [data] Shuffling data
[2023-07-04 19:40:14] [data] Done reading 20,192 sentences
[2023-07-04 19:40:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:40:34] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.37858284 * 1,349,095 @ 2,048 after 37,567,519 : Time 167.75s : 8042.37 words/s : gNorm 0.8305
[2023-07-04 19:41:02] Seen 18,843 samples
[2023-07-04 19:41:02] Starting data epoch 96 in logical epoch 96
[2023-07-04 19:41:02] [data] Shuffling data
[2023-07-04 19:41:02] [data] Done reading 20,192 sentences
[2023-07-04 19:41:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:41:53] Seen 18,843 samples
[2023-07-04 19:41:53] Starting data epoch 97 in logical epoch 97
[2023-07-04 19:41:53] [data] Shuffling data
[2023-07-04 19:41:53] [data] Done reading 20,192 sentences
[2023-07-04 19:41:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:42:43] Seen 18,843 samples
[2023-07-04 19:42:43] Starting data epoch 98 in logical epoch 98
[2023-07-04 19:42:43] [data] Shuffling data
[2023-07-04 19:42:43] [data] Done reading 20,192 sentences
[2023-07-04 19:42:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:43:23] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.31792271 * 1,338,821 @ 2,572 after 38,906,340 : Time 168.16s : 7961.39 words/s : gNorm 0.5735
[2023-07-04 19:43:33] Seen 18,843 samples
[2023-07-04 19:43:33] Starting data epoch 99 in logical epoch 99
[2023-07-04 19:43:33] [data] Shuffling data
[2023-07-04 19:43:33] [data] Done reading 20,192 sentences
[2023-07-04 19:43:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:44:24] Seen 18,843 samples
[2023-07-04 19:44:24] Starting data epoch 100 in logical epoch 100
[2023-07-04 19:44:24] [data] Shuffling data
[2023-07-04 19:44:24] [data] Done reading 20,192 sentences
[2023-07-04 19:44:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:45:13] Seen 18,843 samples
[2023-07-04 19:45:13] Starting data epoch 101 in logical epoch 101
[2023-07-04 19:45:13] Training finished
[2023-07-04 19:45:20] [valid] Ep. 101 : Up. 29659 : cross-entropy : 193.367 : stalled 9 times (last best: 108.414)
[2023-07-04 19:47:32] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-07-04 19:47:32] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:47:38] Saving Adam parameters
[2023-07-04 19:47:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:47:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:47:57] [marian] Running on node07.datos.cluster.uy as process 13707 with command line:
[2023-07-04 19:47:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:47:57] [config] after: 0e
[2023-07-04 19:47:57] [config] after-batches: 0
[2023-07-04 19:47:57] [config] after-epochs: 110
[2023-07-04 19:47:57] [config] all-caps-every: 0
[2023-07-04 19:47:57] [config] allow-unk: false
[2023-07-04 19:47:57] [config] authors: false
[2023-07-04 19:47:57] [config] beam-size: 12
[2023-07-04 19:47:57] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:47:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:47:57] [config] bert-masking-fraction: 0.15
[2023-07-04 19:47:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:47:57] [config] bert-train-type-embeddings: true
[2023-07-04 19:47:57] [config] bert-type-vocab-size: 2
[2023-07-04 19:47:57] [config] build-info: ""
[2023-07-04 19:47:57] [config] check-gradient-nan: false
[2023-07-04 19:47:57] [config] check-nan: false
[2023-07-04 19:47:57] [config] cite: false
[2023-07-04 19:47:57] [config] clip-norm: 1
[2023-07-04 19:47:57] [config] cost-scaling:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] cost-type: ce-sum
[2023-07-04 19:47:57] [config] cpu-threads: 0
[2023-07-04 19:47:57] [config] data-threads: 8
[2023-07-04 19:47:57] [config] data-weighting: ""
[2023-07-04 19:47:57] [config] data-weighting-type: sentence
[2023-07-04 19:47:57] [config] dec-cell: gru
[2023-07-04 19:47:57] [config] dec-cell-base-depth: 2
[2023-07-04 19:47:57] [config] dec-cell-high-depth: 1
[2023-07-04 19:47:57] [config] dec-depth: 1
[2023-07-04 19:47:57] [config] devices:
[2023-07-04 19:47:57] [config]   - 0
[2023-07-04 19:47:57] [config] dim-emb: 512
[2023-07-04 19:47:57] [config] dim-rnn: 1024
[2023-07-04 19:47:57] [config] dim-vocabs:
[2023-07-04 19:47:57] [config]   - 54042
[2023-07-04 19:47:57] [config]   - 36507
[2023-07-04 19:47:57] [config] disp-first: 0
[2023-07-04 19:47:57] [config] disp-freq: 1000u
[2023-07-04 19:47:57] [config] disp-label-counts: true
[2023-07-04 19:47:57] [config] dropout-rnn: 0
[2023-07-04 19:47:57] [config] dropout-src: 0
[2023-07-04 19:47:57] [config] dropout-trg: 0
[2023-07-04 19:47:57] [config] dump-config: ""
[2023-07-04 19:47:57] [config] dynamic-gradient-scaling:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] early-stopping: 10
[2023-07-04 19:47:57] [config] early-stopping-on: first
[2023-07-04 19:47:57] [config] embedding-fix-src: false
[2023-07-04 19:47:57] [config] embedding-fix-trg: false
[2023-07-04 19:47:57] [config] embedding-normalization: false
[2023-07-04 19:47:57] [config] embedding-vectors:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] enc-cell: gru
[2023-07-04 19:47:57] [config] enc-cell-depth: 1
[2023-07-04 19:47:57] [config] enc-depth: 1
[2023-07-04 19:47:57] [config] enc-type: bidirectional
[2023-07-04 19:47:57] [config] english-title-case-every: 0
[2023-07-04 19:47:57] [config] exponential-smoothing: 0
[2023-07-04 19:47:57] [config] factor-weight: 1
[2023-07-04 19:47:57] [config] factors-combine: sum
[2023-07-04 19:47:57] [config] factors-dim-emb: 0
[2023-07-04 19:47:57] [config] gradient-checkpointing: false
[2023-07-04 19:47:57] [config] gradient-norm-average-window: 100
[2023-07-04 19:47:57] [config] guided-alignment: none
[2023-07-04 19:47:57] [config] guided-alignment-cost: mse
[2023-07-04 19:47:57] [config] guided-alignment-weight: 0.1
[2023-07-04 19:47:57] [config] ignore-model-config: false
[2023-07-04 19:47:57] [config] input-types:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] interpolate-env-vars: false
[2023-07-04 19:47:57] [config] keep-best: false
[2023-07-04 19:47:57] [config] label-smoothing: 0
[2023-07-04 19:47:57] [config] layer-normalization: false
[2023-07-04 19:47:57] [config] learn-rate: 0.0001
[2023-07-04 19:47:57] [config] lemma-dependency: ""
[2023-07-04 19:47:57] [config] lemma-dim-emb: 0
[2023-07-04 19:47:57] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:47:57] [config] log-level: info
[2023-07-04 19:47:57] [config] log-time-zone: ""
[2023-07-04 19:47:57] [config] logical-epoch:
[2023-07-04 19:47:57] [config]   - 1e
[2023-07-04 19:47:57] [config]   - 0
[2023-07-04 19:47:57] [config] lr-decay: 0
[2023-07-04 19:47:57] [config] lr-decay-freq: 50000
[2023-07-04 19:47:57] [config] lr-decay-inv-sqrt:
[2023-07-04 19:47:57] [config]   - 0
[2023-07-04 19:47:57] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:47:57] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:47:57] [config] lr-decay-start:
[2023-07-04 19:47:57] [config]   - 10
[2023-07-04 19:47:57] [config]   - 1
[2023-07-04 19:47:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:47:57] [config] lr-report: false
[2023-07-04 19:47:57] [config] lr-warmup: 0
[2023-07-04 19:47:57] [config] lr-warmup-at-reload: false
[2023-07-04 19:47:57] [config] lr-warmup-cycle: false
[2023-07-04 19:47:57] [config] lr-warmup-start-rate: 0
[2023-07-04 19:47:57] [config] max-length: 50
[2023-07-04 19:47:57] [config] max-length-crop: false
[2023-07-04 19:47:57] [config] max-length-factor: 3
[2023-07-04 19:47:57] [config] maxi-batch: 100
[2023-07-04 19:47:57] [config] maxi-batch-sort: trg
[2023-07-04 19:47:57] [config] mini-batch: 64
[2023-07-04 19:47:57] [config] mini-batch-fit: false
[2023-07-04 19:47:57] [config] mini-batch-fit-step: 10
[2023-07-04 19:47:57] [config] mini-batch-round-up: true
[2023-07-04 19:47:57] [config] mini-batch-track-lr: false
[2023-07-04 19:47:57] [config] mini-batch-warmup: 0
[2023-07-04 19:47:57] [config] mini-batch-words: 0
[2023-07-04 19:47:57] [config] mini-batch-words-ref: 0
[2023-07-04 19:47:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:47:57] [config] multi-loss-type: sum
[2023-07-04 19:47:57] [config] n-best: false
[2023-07-04 19:47:57] [config] no-nccl: false
[2023-07-04 19:47:57] [config] no-reload: false
[2023-07-04 19:47:57] [config] no-restore-corpus: false
[2023-07-04 19:47:57] [config] normalize: 0
[2023-07-04 19:47:57] [config] normalize-gradient: false
[2023-07-04 19:47:57] [config] num-devices: 0
[2023-07-04 19:47:57] [config] optimizer: adam
[2023-07-04 19:47:57] [config] optimizer-delay: 1
[2023-07-04 19:47:57] [config] optimizer-params:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] output-omit-bias: false
[2023-07-04 19:47:57] [config] overwrite: true
[2023-07-04 19:47:57] [config] precision:
[2023-07-04 19:47:57] [config]   - float32
[2023-07-04 19:47:57] [config]   - float32
[2023-07-04 19:47:57] [config] pretrained-model: ""
[2023-07-04 19:47:57] [config] quantize-biases: false
[2023-07-04 19:47:57] [config] quantize-bits: 0
[2023-07-04 19:47:57] [config] quantize-log-based: false
[2023-07-04 19:47:57] [config] quantize-optimization-steps: 0
[2023-07-04 19:47:57] [config] quiet: false
[2023-07-04 19:47:57] [config] quiet-translation: true
[2023-07-04 19:47:57] [config] relative-paths: false
[2023-07-04 19:47:57] [config] right-left: false
[2023-07-04 19:47:57] [config] save-freq: 10000u
[2023-07-04 19:47:57] [config] seed: 1234
[2023-07-04 19:47:57] [config] sentencepiece-alphas:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:47:57] [config] sentencepiece-options: ""
[2023-07-04 19:47:57] [config] sharding: global
[2023-07-04 19:47:57] [config] shuffle: data
[2023-07-04 19:47:57] [config] shuffle-in-ram: false
[2023-07-04 19:47:57] [config] sigterm: save-and-exit
[2023-07-04 19:47:57] [config] skip: false
[2023-07-04 19:47:57] [config] sqlite: ""
[2023-07-04 19:47:57] [config] sqlite-drop: false
[2023-07-04 19:47:57] [config] sync-freq: 200u
[2023-07-04 19:47:57] [config] sync-sgd: false
[2023-07-04 19:47:57] [config] tempdir: /tmp
[2023-07-04 19:47:57] [config] tied-embeddings: false
[2023-07-04 19:47:57] [config] tied-embeddings-all: false
[2023-07-04 19:47:57] [config] tied-embeddings-src: false
[2023-07-04 19:47:57] [config] train-embedder-rank:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] train-sets:
[2023-07-04 19:47:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:47:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:47:57] [config] transformer-aan-activation: swish
[2023-07-04 19:47:57] [config] transformer-aan-depth: 2
[2023-07-04 19:47:57] [config] transformer-aan-nogate: false
[2023-07-04 19:47:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:47:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:47:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:47:57] [config] transformer-depth-scaling: false
[2023-07-04 19:47:57] [config] transformer-dim-aan: 2048
[2023-07-04 19:47:57] [config] transformer-dim-ffn: 2048
[2023-07-04 19:47:57] [config] transformer-dropout: 0
[2023-07-04 19:47:57] [config] transformer-dropout-attention: 0
[2023-07-04 19:47:57] [config] transformer-dropout-ffn: 0
[2023-07-04 19:47:57] [config] transformer-ffn-activation: swish
[2023-07-04 19:47:57] [config] transformer-ffn-depth: 2
[2023-07-04 19:47:57] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:47:57] [config] transformer-heads: 8
[2023-07-04 19:47:57] [config] transformer-no-projection: false
[2023-07-04 19:47:57] [config] transformer-pool: false
[2023-07-04 19:47:57] [config] transformer-postprocess: dan
[2023-07-04 19:47:57] [config] transformer-postprocess-emb: d
[2023-07-04 19:47:57] [config] transformer-postprocess-top: ""
[2023-07-04 19:47:57] [config] transformer-preprocess: ""
[2023-07-04 19:47:57] [config] transformer-tied-layers:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] transformer-train-position-embeddings: false
[2023-07-04 19:47:57] [config] tsv: false
[2023-07-04 19:47:57] [config] tsv-fields: 0
[2023-07-04 19:47:57] [config] type: s2s
[2023-07-04 19:47:57] [config] ulr: false
[2023-07-04 19:47:57] [config] ulr-dim-emb: 0
[2023-07-04 19:47:57] [config] ulr-dropout: 0
[2023-07-04 19:47:57] [config] ulr-keys-vectors: ""
[2023-07-04 19:47:57] [config] ulr-query-vectors: ""
[2023-07-04 19:47:57] [config] ulr-softmax-temperature: 1
[2023-07-04 19:47:57] [config] ulr-trainable-transformation: false
[2023-07-04 19:47:57] [config] unlikelihood-loss: false
[2023-07-04 19:47:57] [config] valid-freq: 50000000
[2023-07-04 19:47:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:47:57] [config] valid-max-length: 1000
[2023-07-04 19:47:57] [config] valid-metrics:
[2023-07-04 19:47:57] [config]   - cross-entropy
[2023-07-04 19:47:57] [config]   - translation
[2023-07-04 19:47:57] [config] valid-mini-batch: 32
[2023-07-04 19:47:57] [config] valid-reset-stalled: false
[2023-07-04 19:47:57] [config] valid-script-args:
[2023-07-04 19:47:57] [config]   []
[2023-07-04 19:47:57] [config] valid-script-path: ""
[2023-07-04 19:47:57] [config] valid-sets:
[2023-07-04 19:47:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:47:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:47:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:47:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:47:57] [config] vocabs:
[2023-07-04 19:47:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:47:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:47:57] [config] word-penalty: 0
[2023-07-04 19:47:57] [config] word-scores: false
[2023-07-04 19:47:57] [config] workspace: 2048
[2023-07-04 19:47:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:47:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:47:57] [training] Using single-device training
[2023-07-04 19:47:58] Synced seed 1234
[2023-07-04 19:47:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:47:58] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:47:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:47:58] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:47:59] [valid] No post-processing script given for validating translator
[2023-07-04 19:47:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:47:59] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:48:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:48:00] [comm] Using global sharding
[2023-07-04 19:48:00] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:48:00] [training] Using 1 GPUs
[2023-07-04 19:48:00] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:48:02] Loading Adam parameters
[2023-07-04 19:48:02] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:48:03] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:48:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:48:03] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-07-04 19:48:03] [data] Shuffling data
[2023-07-04 19:48:03] [data] Done reading 20,192 sentences
[2023-07-04 19:48:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:48:03] Training started
[2023-07-04 19:48:03] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 19:48:03] [logits] Applying loss function for 1 factor(s)
[2023-07-04 19:48:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 19:48:03] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:48:03] Parameter type float32, optimization type float32, casting types false
[2023-07-04 19:48:46] Seen 18,843 samples
[2023-07-04 19:48:46] Starting data epoch 102 in logical epoch 102
[2023-07-04 19:48:46] [data] Shuffling data
[2023-07-04 19:48:46] [data] Done reading 20,192 sentences
[2023-07-04 19:48:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:48:53] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.26568183 * 1,341,254 @ 2,240 after 40,247,594 : Time 54.61s : 24561.57 words/s : gNorm 0.4943
[2023-07-04 19:48:53] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:48:58] Saving Adam parameters
[2023-07-04 19:48:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:49:49] Seen 18,843 samples
[2023-07-04 19:49:49] Starting data epoch 103 in logical epoch 103
[2023-07-04 19:49:49] [data] Shuffling data
[2023-07-04 19:49:49] [data] Done reading 20,192 sentences
[2023-07-04 19:49:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:50:39] Seen 18,843 samples
[2023-07-04 19:50:39] Starting data epoch 104 in logical epoch 104
[2023-07-04 19:50:39] [data] Shuffling data
[2023-07-04 19:50:39] [data] Done reading 20,192 sentences
[2023-07-04 19:50:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:51:27] Seen 18,843 samples
[2023-07-04 19:51:27] Starting data epoch 105 in logical epoch 105
[2023-07-04 19:51:27] [data] Shuffling data
[2023-07-04 19:51:27] [data] Done reading 20,192 sentences
[2023-07-04 19:51:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:51:54] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.22383571 * 1,341,970 @ 1,536 after 41,589,564 : Time 180.60s : 7430.59 words/s : gNorm 0.5152
[2023-07-04 19:52:18] Seen 18,843 samples
[2023-07-04 19:52:18] Starting data epoch 106 in logical epoch 106
[2023-07-04 19:52:18] [data] Shuffling data
[2023-07-04 19:52:18] [data] Done reading 20,192 sentences
[2023-07-04 19:52:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:53:07] Seen 18,843 samples
[2023-07-04 19:53:07] Starting data epoch 107 in logical epoch 107
[2023-07-04 19:53:07] [data] Shuffling data
[2023-07-04 19:53:07] [data] Done reading 20,192 sentences
[2023-07-04 19:53:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:53:57] Seen 18,843 samples
[2023-07-04 19:53:57] Starting data epoch 108 in logical epoch 108
[2023-07-04 19:53:57] [data] Shuffling data
[2023-07-04 19:53:57] [data] Done reading 20,192 sentences
[2023-07-04 19:53:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:54:39] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.18293199 * 1,331,544 @ 948 after 42,921,108 : Time 165.51s : 8045.30 words/s : gNorm 0.4628
[2023-07-04 19:54:46] Seen 18,843 samples
[2023-07-04 19:54:46] Starting data epoch 109 in logical epoch 109
[2023-07-04 19:54:46] [data] Shuffling data
[2023-07-04 19:54:46] [data] Done reading 20,192 sentences
[2023-07-04 19:54:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:55:35] Seen 18,843 samples
[2023-07-04 19:55:35] Starting data epoch 110 in logical epoch 110
[2023-07-04 19:55:35] [data] Shuffling data
[2023-07-04 19:55:35] [data] Done reading 20,192 sentences
[2023-07-04 19:55:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:56:24] Seen 18,843 samples
[2023-07-04 19:56:24] Starting data epoch 111 in logical epoch 111
[2023-07-04 19:56:24] Training finished
[2023-07-04 19:56:31] [valid] Ep. 111 : Up. 32628 : cross-entropy : 202.246 : stalled 10 times (last best: 108.414)
[2023-07-04 19:58:42] [valid] Ep. 111 : Up. 32628 : translation : 0 : new best
[2023-07-04 19:58:42] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:58:46] Saving Adam parameters
[2023-07-04 19:58:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:59:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:01] [marian] Running on node07.datos.cluster.uy as process 14335 with command line:
[2023-07-04 19:59:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:59:01] [config] after: 0e
[2023-07-04 19:59:01] [config] after-batches: 0
[2023-07-04 19:59:01] [config] after-epochs: 120
[2023-07-04 19:59:01] [config] all-caps-every: 0
[2023-07-04 19:59:01] [config] allow-unk: false
[2023-07-04 19:59:01] [config] authors: false
[2023-07-04 19:59:01] [config] beam-size: 12
[2023-07-04 19:59:01] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:59:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:59:01] [config] bert-masking-fraction: 0.15
[2023-07-04 19:59:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:59:01] [config] bert-train-type-embeddings: true
[2023-07-04 19:59:01] [config] bert-type-vocab-size: 2
[2023-07-04 19:59:01] [config] build-info: ""
[2023-07-04 19:59:01] [config] check-gradient-nan: false
[2023-07-04 19:59:01] [config] check-nan: false
[2023-07-04 19:59:01] [config] cite: false
[2023-07-04 19:59:01] [config] clip-norm: 1
[2023-07-04 19:59:01] [config] cost-scaling:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] cost-type: ce-sum
[2023-07-04 19:59:01] [config] cpu-threads: 0
[2023-07-04 19:59:01] [config] data-threads: 8
[2023-07-04 19:59:01] [config] data-weighting: ""
[2023-07-04 19:59:01] [config] data-weighting-type: sentence
[2023-07-04 19:59:01] [config] dec-cell: gru
[2023-07-04 19:59:01] [config] dec-cell-base-depth: 2
[2023-07-04 19:59:01] [config] dec-cell-high-depth: 1
[2023-07-04 19:59:01] [config] dec-depth: 1
[2023-07-04 19:59:01] [config] devices:
[2023-07-04 19:59:01] [config]   - 0
[2023-07-04 19:59:01] [config] dim-emb: 512
[2023-07-04 19:59:01] [config] dim-rnn: 1024
[2023-07-04 19:59:01] [config] dim-vocabs:
[2023-07-04 19:59:01] [config]   - 54042
[2023-07-04 19:59:01] [config]   - 36507
[2023-07-04 19:59:01] [config] disp-first: 0
[2023-07-04 19:59:01] [config] disp-freq: 1000u
[2023-07-04 19:59:01] [config] disp-label-counts: true
[2023-07-04 19:59:01] [config] dropout-rnn: 0
[2023-07-04 19:59:01] [config] dropout-src: 0
[2023-07-04 19:59:01] [config] dropout-trg: 0
[2023-07-04 19:59:01] [config] dump-config: ""
[2023-07-04 19:59:01] [config] dynamic-gradient-scaling:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] early-stopping: 10
[2023-07-04 19:59:01] [config] early-stopping-on: first
[2023-07-04 19:59:01] [config] embedding-fix-src: false
[2023-07-04 19:59:01] [config] embedding-fix-trg: false
[2023-07-04 19:59:01] [config] embedding-normalization: false
[2023-07-04 19:59:01] [config] embedding-vectors:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] enc-cell: gru
[2023-07-04 19:59:01] [config] enc-cell-depth: 1
[2023-07-04 19:59:01] [config] enc-depth: 1
[2023-07-04 19:59:01] [config] enc-type: bidirectional
[2023-07-04 19:59:01] [config] english-title-case-every: 0
[2023-07-04 19:59:01] [config] exponential-smoothing: 0
[2023-07-04 19:59:01] [config] factor-weight: 1
[2023-07-04 19:59:01] [config] factors-combine: sum
[2023-07-04 19:59:01] [config] factors-dim-emb: 0
[2023-07-04 19:59:01] [config] gradient-checkpointing: false
[2023-07-04 19:59:01] [config] gradient-norm-average-window: 100
[2023-07-04 19:59:01] [config] guided-alignment: none
[2023-07-04 19:59:01] [config] guided-alignment-cost: mse
[2023-07-04 19:59:01] [config] guided-alignment-weight: 0.1
[2023-07-04 19:59:01] [config] ignore-model-config: false
[2023-07-04 19:59:01] [config] input-types:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] interpolate-env-vars: false
[2023-07-04 19:59:01] [config] keep-best: false
[2023-07-04 19:59:01] [config] label-smoothing: 0
[2023-07-04 19:59:01] [config] layer-normalization: false
[2023-07-04 19:59:01] [config] learn-rate: 0.0001
[2023-07-04 19:59:01] [config] lemma-dependency: ""
[2023-07-04 19:59:01] [config] lemma-dim-emb: 0
[2023-07-04 19:59:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:59:01] [config] log-level: info
[2023-07-04 19:59:01] [config] log-time-zone: ""
[2023-07-04 19:59:01] [config] logical-epoch:
[2023-07-04 19:59:01] [config]   - 1e
[2023-07-04 19:59:01] [config]   - 0
[2023-07-04 19:59:01] [config] lr-decay: 0
[2023-07-04 19:59:01] [config] lr-decay-freq: 50000
[2023-07-04 19:59:01] [config] lr-decay-inv-sqrt:
[2023-07-04 19:59:01] [config]   - 0
[2023-07-04 19:59:01] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:59:01] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:59:01] [config] lr-decay-start:
[2023-07-04 19:59:01] [config]   - 10
[2023-07-04 19:59:01] [config]   - 1
[2023-07-04 19:59:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:59:01] [config] lr-report: false
[2023-07-04 19:59:01] [config] lr-warmup: 0
[2023-07-04 19:59:01] [config] lr-warmup-at-reload: false
[2023-07-04 19:59:01] [config] lr-warmup-cycle: false
[2023-07-04 19:59:01] [config] lr-warmup-start-rate: 0
[2023-07-04 19:59:01] [config] max-length: 50
[2023-07-04 19:59:01] [config] max-length-crop: false
[2023-07-04 19:59:01] [config] max-length-factor: 3
[2023-07-04 19:59:01] [config] maxi-batch: 100
[2023-07-04 19:59:01] [config] maxi-batch-sort: trg
[2023-07-04 19:59:01] [config] mini-batch: 64
[2023-07-04 19:59:01] [config] mini-batch-fit: false
[2023-07-04 19:59:01] [config] mini-batch-fit-step: 10
[2023-07-04 19:59:01] [config] mini-batch-round-up: true
[2023-07-04 19:59:01] [config] mini-batch-track-lr: false
[2023-07-04 19:59:01] [config] mini-batch-warmup: 0
[2023-07-04 19:59:01] [config] mini-batch-words: 0
[2023-07-04 19:59:01] [config] mini-batch-words-ref: 0
[2023-07-04 19:59:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:01] [config] multi-loss-type: sum
[2023-07-04 19:59:01] [config] n-best: false
[2023-07-04 19:59:01] [config] no-nccl: false
[2023-07-04 19:59:01] [config] no-reload: false
[2023-07-04 19:59:01] [config] no-restore-corpus: false
[2023-07-04 19:59:01] [config] normalize: 0
[2023-07-04 19:59:01] [config] normalize-gradient: false
[2023-07-04 19:59:01] [config] num-devices: 0
[2023-07-04 19:59:01] [config] optimizer: adam
[2023-07-04 19:59:01] [config] optimizer-delay: 1
[2023-07-04 19:59:01] [config] optimizer-params:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] output-omit-bias: false
[2023-07-04 19:59:01] [config] overwrite: true
[2023-07-04 19:59:01] [config] precision:
[2023-07-04 19:59:01] [config]   - float32
[2023-07-04 19:59:01] [config]   - float32
[2023-07-04 19:59:01] [config] pretrained-model: ""
[2023-07-04 19:59:01] [config] quantize-biases: false
[2023-07-04 19:59:01] [config] quantize-bits: 0
[2023-07-04 19:59:01] [config] quantize-log-based: false
[2023-07-04 19:59:01] [config] quantize-optimization-steps: 0
[2023-07-04 19:59:01] [config] quiet: false
[2023-07-04 19:59:01] [config] quiet-translation: true
[2023-07-04 19:59:01] [config] relative-paths: false
[2023-07-04 19:59:01] [config] right-left: false
[2023-07-04 19:59:01] [config] save-freq: 10000u
[2023-07-04 19:59:01] [config] seed: 1234
[2023-07-04 19:59:01] [config] sentencepiece-alphas:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:59:01] [config] sentencepiece-options: ""
[2023-07-04 19:59:01] [config] sharding: global
[2023-07-04 19:59:01] [config] shuffle: data
[2023-07-04 19:59:01] [config] shuffle-in-ram: false
[2023-07-04 19:59:01] [config] sigterm: save-and-exit
[2023-07-04 19:59:01] [config] skip: false
[2023-07-04 19:59:01] [config] sqlite: ""
[2023-07-04 19:59:01] [config] sqlite-drop: false
[2023-07-04 19:59:01] [config] sync-freq: 200u
[2023-07-04 19:59:01] [config] sync-sgd: false
[2023-07-04 19:59:01] [config] tempdir: /tmp
[2023-07-04 19:59:01] [config] tied-embeddings: false
[2023-07-04 19:59:01] [config] tied-embeddings-all: false
[2023-07-04 19:59:01] [config] tied-embeddings-src: false
[2023-07-04 19:59:01] [config] train-embedder-rank:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] train-sets:
[2023-07-04 19:59:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:59:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:59:01] [config] transformer-aan-activation: swish
[2023-07-04 19:59:01] [config] transformer-aan-depth: 2
[2023-07-04 19:59:01] [config] transformer-aan-nogate: false
[2023-07-04 19:59:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:59:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:59:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:59:01] [config] transformer-depth-scaling: false
[2023-07-04 19:59:01] [config] transformer-dim-aan: 2048
[2023-07-04 19:59:01] [config] transformer-dim-ffn: 2048
[2023-07-04 19:59:01] [config] transformer-dropout: 0
[2023-07-04 19:59:01] [config] transformer-dropout-attention: 0
[2023-07-04 19:59:01] [config] transformer-dropout-ffn: 0
[2023-07-04 19:59:01] [config] transformer-ffn-activation: swish
[2023-07-04 19:59:01] [config] transformer-ffn-depth: 2
[2023-07-04 19:59:01] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:59:01] [config] transformer-heads: 8
[2023-07-04 19:59:01] [config] transformer-no-projection: false
[2023-07-04 19:59:01] [config] transformer-pool: false
[2023-07-04 19:59:01] [config] transformer-postprocess: dan
[2023-07-04 19:59:01] [config] transformer-postprocess-emb: d
[2023-07-04 19:59:01] [config] transformer-postprocess-top: ""
[2023-07-04 19:59:01] [config] transformer-preprocess: ""
[2023-07-04 19:59:01] [config] transformer-tied-layers:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] transformer-train-position-embeddings: false
[2023-07-04 19:59:01] [config] tsv: false
[2023-07-04 19:59:01] [config] tsv-fields: 0
[2023-07-04 19:59:01] [config] type: s2s
[2023-07-04 19:59:01] [config] ulr: false
[2023-07-04 19:59:01] [config] ulr-dim-emb: 0
[2023-07-04 19:59:01] [config] ulr-dropout: 0
[2023-07-04 19:59:01] [config] ulr-keys-vectors: ""
[2023-07-04 19:59:01] [config] ulr-query-vectors: ""
[2023-07-04 19:59:01] [config] ulr-softmax-temperature: 1
[2023-07-04 19:59:01] [config] ulr-trainable-transformation: false
[2023-07-04 19:59:01] [config] unlikelihood-loss: false
[2023-07-04 19:59:01] [config] valid-freq: 50000000
[2023-07-04 19:59:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:59:01] [config] valid-max-length: 1000
[2023-07-04 19:59:01] [config] valid-metrics:
[2023-07-04 19:59:01] [config]   - cross-entropy
[2023-07-04 19:59:01] [config]   - translation
[2023-07-04 19:59:01] [config] valid-mini-batch: 32
[2023-07-04 19:59:01] [config] valid-reset-stalled: false
[2023-07-04 19:59:01] [config] valid-script-args:
[2023-07-04 19:59:01] [config]   []
[2023-07-04 19:59:01] [config] valid-script-path: ""
[2023-07-04 19:59:01] [config] valid-sets:
[2023-07-04 19:59:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:59:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:59:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:59:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:01] [config] vocabs:
[2023-07-04 19:59:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:01] [config] word-penalty: 0
[2023-07-04 19:59:01] [config] word-scores: false
[2023-07-04 19:59:01] [config] workspace: 2048
[2023-07-04 19:59:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:01] [training] Using single-device training
[2023-07-04 19:59:03] Synced seed 1234
[2023-07-04 19:59:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:03] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:59:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:03] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:59:03] [valid] No post-processing script given for validating translator
[2023-07-04 19:59:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:04] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:59:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:59:04] [comm] Using global sharding
[2023-07-04 19:59:04] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:59:04] [training] Using 1 GPUs
[2023-07-04 19:59:04] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:07] Loading Adam parameters
[2023-07-04 19:59:08] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:59:08] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:59:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:59:08] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 19:59:08] [data] Shuffling data
[2023-07-04 19:59:08] [data] Done reading 20,192 sentences
[2023-07-04 19:59:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:59:08] Training started
[2023-07-04 19:59:08] Training finished
[2023-07-04 19:59:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:12] [marian] Running on node07.datos.cluster.uy as process 14386 with command line:
[2023-07-04 19:59:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:59:12] [config] after: 0e
[2023-07-04 19:59:12] [config] after-batches: 0
[2023-07-04 19:59:12] [config] after-epochs: 130
[2023-07-04 19:59:12] [config] all-caps-every: 0
[2023-07-04 19:59:12] [config] allow-unk: false
[2023-07-04 19:59:12] [config] authors: false
[2023-07-04 19:59:12] [config] beam-size: 12
[2023-07-04 19:59:12] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:59:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:59:12] [config] bert-masking-fraction: 0.15
[2023-07-04 19:59:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:59:12] [config] bert-train-type-embeddings: true
[2023-07-04 19:59:12] [config] bert-type-vocab-size: 2
[2023-07-04 19:59:12] [config] build-info: ""
[2023-07-04 19:59:12] [config] check-gradient-nan: false
[2023-07-04 19:59:12] [config] check-nan: false
[2023-07-04 19:59:12] [config] cite: false
[2023-07-04 19:59:12] [config] clip-norm: 1
[2023-07-04 19:59:12] [config] cost-scaling:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] cost-type: ce-sum
[2023-07-04 19:59:12] [config] cpu-threads: 0
[2023-07-04 19:59:12] [config] data-threads: 8
[2023-07-04 19:59:12] [config] data-weighting: ""
[2023-07-04 19:59:12] [config] data-weighting-type: sentence
[2023-07-04 19:59:12] [config] dec-cell: gru
[2023-07-04 19:59:12] [config] dec-cell-base-depth: 2
[2023-07-04 19:59:12] [config] dec-cell-high-depth: 1
[2023-07-04 19:59:12] [config] dec-depth: 1
[2023-07-04 19:59:12] [config] devices:
[2023-07-04 19:59:12] [config]   - 0
[2023-07-04 19:59:12] [config] dim-emb: 512
[2023-07-04 19:59:12] [config] dim-rnn: 1024
[2023-07-04 19:59:12] [config] dim-vocabs:
[2023-07-04 19:59:12] [config]   - 54042
[2023-07-04 19:59:12] [config]   - 36507
[2023-07-04 19:59:12] [config] disp-first: 0
[2023-07-04 19:59:12] [config] disp-freq: 1000u
[2023-07-04 19:59:12] [config] disp-label-counts: true
[2023-07-04 19:59:12] [config] dropout-rnn: 0
[2023-07-04 19:59:12] [config] dropout-src: 0
[2023-07-04 19:59:12] [config] dropout-trg: 0
[2023-07-04 19:59:12] [config] dump-config: ""
[2023-07-04 19:59:12] [config] dynamic-gradient-scaling:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] early-stopping: 10
[2023-07-04 19:59:12] [config] early-stopping-on: first
[2023-07-04 19:59:12] [config] embedding-fix-src: false
[2023-07-04 19:59:12] [config] embedding-fix-trg: false
[2023-07-04 19:59:12] [config] embedding-normalization: false
[2023-07-04 19:59:12] [config] embedding-vectors:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] enc-cell: gru
[2023-07-04 19:59:12] [config] enc-cell-depth: 1
[2023-07-04 19:59:12] [config] enc-depth: 1
[2023-07-04 19:59:12] [config] enc-type: bidirectional
[2023-07-04 19:59:12] [config] english-title-case-every: 0
[2023-07-04 19:59:12] [config] exponential-smoothing: 0
[2023-07-04 19:59:12] [config] factor-weight: 1
[2023-07-04 19:59:12] [config] factors-combine: sum
[2023-07-04 19:59:12] [config] factors-dim-emb: 0
[2023-07-04 19:59:12] [config] gradient-checkpointing: false
[2023-07-04 19:59:12] [config] gradient-norm-average-window: 100
[2023-07-04 19:59:12] [config] guided-alignment: none
[2023-07-04 19:59:12] [config] guided-alignment-cost: mse
[2023-07-04 19:59:12] [config] guided-alignment-weight: 0.1
[2023-07-04 19:59:12] [config] ignore-model-config: false
[2023-07-04 19:59:12] [config] input-types:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] interpolate-env-vars: false
[2023-07-04 19:59:12] [config] keep-best: false
[2023-07-04 19:59:12] [config] label-smoothing: 0
[2023-07-04 19:59:12] [config] layer-normalization: false
[2023-07-04 19:59:12] [config] learn-rate: 0.0001
[2023-07-04 19:59:12] [config] lemma-dependency: ""
[2023-07-04 19:59:12] [config] lemma-dim-emb: 0
[2023-07-04 19:59:12] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:59:12] [config] log-level: info
[2023-07-04 19:59:12] [config] log-time-zone: ""
[2023-07-04 19:59:12] [config] logical-epoch:
[2023-07-04 19:59:12] [config]   - 1e
[2023-07-04 19:59:12] [config]   - 0
[2023-07-04 19:59:12] [config] lr-decay: 0
[2023-07-04 19:59:12] [config] lr-decay-freq: 50000
[2023-07-04 19:59:12] [config] lr-decay-inv-sqrt:
[2023-07-04 19:59:12] [config]   - 0
[2023-07-04 19:59:12] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:59:12] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:59:12] [config] lr-decay-start:
[2023-07-04 19:59:12] [config]   - 10
[2023-07-04 19:59:12] [config]   - 1
[2023-07-04 19:59:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:59:12] [config] lr-report: false
[2023-07-04 19:59:12] [config] lr-warmup: 0
[2023-07-04 19:59:12] [config] lr-warmup-at-reload: false
[2023-07-04 19:59:12] [config] lr-warmup-cycle: false
[2023-07-04 19:59:12] [config] lr-warmup-start-rate: 0
[2023-07-04 19:59:12] [config] max-length: 50
[2023-07-04 19:59:12] [config] max-length-crop: false
[2023-07-04 19:59:12] [config] max-length-factor: 3
[2023-07-04 19:59:12] [config] maxi-batch: 100
[2023-07-04 19:59:12] [config] maxi-batch-sort: trg
[2023-07-04 19:59:12] [config] mini-batch: 64
[2023-07-04 19:59:12] [config] mini-batch-fit: false
[2023-07-04 19:59:12] [config] mini-batch-fit-step: 10
[2023-07-04 19:59:12] [config] mini-batch-round-up: true
[2023-07-04 19:59:12] [config] mini-batch-track-lr: false
[2023-07-04 19:59:12] [config] mini-batch-warmup: 0
[2023-07-04 19:59:12] [config] mini-batch-words: 0
[2023-07-04 19:59:12] [config] mini-batch-words-ref: 0
[2023-07-04 19:59:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:12] [config] multi-loss-type: sum
[2023-07-04 19:59:12] [config] n-best: false
[2023-07-04 19:59:12] [config] no-nccl: false
[2023-07-04 19:59:12] [config] no-reload: false
[2023-07-04 19:59:12] [config] no-restore-corpus: false
[2023-07-04 19:59:12] [config] normalize: 0
[2023-07-04 19:59:12] [config] normalize-gradient: false
[2023-07-04 19:59:12] [config] num-devices: 0
[2023-07-04 19:59:12] [config] optimizer: adam
[2023-07-04 19:59:12] [config] optimizer-delay: 1
[2023-07-04 19:59:12] [config] optimizer-params:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] output-omit-bias: false
[2023-07-04 19:59:12] [config] overwrite: true
[2023-07-04 19:59:12] [config] precision:
[2023-07-04 19:59:12] [config]   - float32
[2023-07-04 19:59:12] [config]   - float32
[2023-07-04 19:59:12] [config] pretrained-model: ""
[2023-07-04 19:59:12] [config] quantize-biases: false
[2023-07-04 19:59:12] [config] quantize-bits: 0
[2023-07-04 19:59:12] [config] quantize-log-based: false
[2023-07-04 19:59:12] [config] quantize-optimization-steps: 0
[2023-07-04 19:59:12] [config] quiet: false
[2023-07-04 19:59:12] [config] quiet-translation: true
[2023-07-04 19:59:12] [config] relative-paths: false
[2023-07-04 19:59:12] [config] right-left: false
[2023-07-04 19:59:12] [config] save-freq: 10000u
[2023-07-04 19:59:12] [config] seed: 1234
[2023-07-04 19:59:12] [config] sentencepiece-alphas:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:59:12] [config] sentencepiece-options: ""
[2023-07-04 19:59:12] [config] sharding: global
[2023-07-04 19:59:12] [config] shuffle: data
[2023-07-04 19:59:12] [config] shuffle-in-ram: false
[2023-07-04 19:59:12] [config] sigterm: save-and-exit
[2023-07-04 19:59:12] [config] skip: false
[2023-07-04 19:59:12] [config] sqlite: ""
[2023-07-04 19:59:12] [config] sqlite-drop: false
[2023-07-04 19:59:12] [config] sync-freq: 200u
[2023-07-04 19:59:12] [config] sync-sgd: false
[2023-07-04 19:59:12] [config] tempdir: /tmp
[2023-07-04 19:59:12] [config] tied-embeddings: false
[2023-07-04 19:59:12] [config] tied-embeddings-all: false
[2023-07-04 19:59:12] [config] tied-embeddings-src: false
[2023-07-04 19:59:12] [config] train-embedder-rank:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] train-sets:
[2023-07-04 19:59:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:59:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:59:12] [config] transformer-aan-activation: swish
[2023-07-04 19:59:12] [config] transformer-aan-depth: 2
[2023-07-04 19:59:12] [config] transformer-aan-nogate: false
[2023-07-04 19:59:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:59:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:59:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:59:12] [config] transformer-depth-scaling: false
[2023-07-04 19:59:12] [config] transformer-dim-aan: 2048
[2023-07-04 19:59:12] [config] transformer-dim-ffn: 2048
[2023-07-04 19:59:12] [config] transformer-dropout: 0
[2023-07-04 19:59:12] [config] transformer-dropout-attention: 0
[2023-07-04 19:59:12] [config] transformer-dropout-ffn: 0
[2023-07-04 19:59:12] [config] transformer-ffn-activation: swish
[2023-07-04 19:59:12] [config] transformer-ffn-depth: 2
[2023-07-04 19:59:12] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:59:12] [config] transformer-heads: 8
[2023-07-04 19:59:12] [config] transformer-no-projection: false
[2023-07-04 19:59:12] [config] transformer-pool: false
[2023-07-04 19:59:12] [config] transformer-postprocess: dan
[2023-07-04 19:59:12] [config] transformer-postprocess-emb: d
[2023-07-04 19:59:12] [config] transformer-postprocess-top: ""
[2023-07-04 19:59:12] [config] transformer-preprocess: ""
[2023-07-04 19:59:12] [config] transformer-tied-layers:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] transformer-train-position-embeddings: false
[2023-07-04 19:59:12] [config] tsv: false
[2023-07-04 19:59:12] [config] tsv-fields: 0
[2023-07-04 19:59:12] [config] type: s2s
[2023-07-04 19:59:12] [config] ulr: false
[2023-07-04 19:59:12] [config] ulr-dim-emb: 0
[2023-07-04 19:59:12] [config] ulr-dropout: 0
[2023-07-04 19:59:12] [config] ulr-keys-vectors: ""
[2023-07-04 19:59:12] [config] ulr-query-vectors: ""
[2023-07-04 19:59:12] [config] ulr-softmax-temperature: 1
[2023-07-04 19:59:12] [config] ulr-trainable-transformation: false
[2023-07-04 19:59:12] [config] unlikelihood-loss: false
[2023-07-04 19:59:12] [config] valid-freq: 50000000
[2023-07-04 19:59:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:59:12] [config] valid-max-length: 1000
[2023-07-04 19:59:12] [config] valid-metrics:
[2023-07-04 19:59:12] [config]   - cross-entropy
[2023-07-04 19:59:12] [config]   - translation
[2023-07-04 19:59:12] [config] valid-mini-batch: 32
[2023-07-04 19:59:12] [config] valid-reset-stalled: false
[2023-07-04 19:59:12] [config] valid-script-args:
[2023-07-04 19:59:12] [config]   []
[2023-07-04 19:59:12] [config] valid-script-path: ""
[2023-07-04 19:59:12] [config] valid-sets:
[2023-07-04 19:59:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:59:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:59:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:59:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:12] [config] vocabs:
[2023-07-04 19:59:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:12] [config] word-penalty: 0
[2023-07-04 19:59:12] [config] word-scores: false
[2023-07-04 19:59:12] [config] workspace: 2048
[2023-07-04 19:59:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:12] [training] Using single-device training
[2023-07-04 19:59:13] Synced seed 1234
[2023-07-04 19:59:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:13] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:59:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:13] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:59:13] [valid] No post-processing script given for validating translator
[2023-07-04 19:59:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:14] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:59:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:59:14] [comm] Using global sharding
[2023-07-04 19:59:14] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:59:14] [training] Using 1 GPUs
[2023-07-04 19:59:14] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:16] Loading Adam parameters
[2023-07-04 19:59:16] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:59:16] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:59:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:59:16] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 19:59:16] [data] Shuffling data
[2023-07-04 19:59:16] [data] Done reading 20,192 sentences
[2023-07-04 19:59:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:59:16] Training started
[2023-07-04 19:59:16] Training finished
[2023-07-04 19:59:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:24] [marian] Running on node07.datos.cluster.uy as process 14438 with command line:
[2023-07-04 19:59:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:59:24] [config] after: 0e
[2023-07-04 19:59:24] [config] after-batches: 0
[2023-07-04 19:59:24] [config] after-epochs: 140
[2023-07-04 19:59:24] [config] all-caps-every: 0
[2023-07-04 19:59:24] [config] allow-unk: false
[2023-07-04 19:59:24] [config] authors: false
[2023-07-04 19:59:24] [config] beam-size: 12
[2023-07-04 19:59:24] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:59:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:59:24] [config] bert-masking-fraction: 0.15
[2023-07-04 19:59:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:59:24] [config] bert-train-type-embeddings: true
[2023-07-04 19:59:24] [config] bert-type-vocab-size: 2
[2023-07-04 19:59:24] [config] build-info: ""
[2023-07-04 19:59:24] [config] check-gradient-nan: false
[2023-07-04 19:59:24] [config] check-nan: false
[2023-07-04 19:59:24] [config] cite: false
[2023-07-04 19:59:24] [config] clip-norm: 1
[2023-07-04 19:59:24] [config] cost-scaling:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] cost-type: ce-sum
[2023-07-04 19:59:24] [config] cpu-threads: 0
[2023-07-04 19:59:24] [config] data-threads: 8
[2023-07-04 19:59:24] [config] data-weighting: ""
[2023-07-04 19:59:24] [config] data-weighting-type: sentence
[2023-07-04 19:59:24] [config] dec-cell: gru
[2023-07-04 19:59:24] [config] dec-cell-base-depth: 2
[2023-07-04 19:59:24] [config] dec-cell-high-depth: 1
[2023-07-04 19:59:24] [config] dec-depth: 1
[2023-07-04 19:59:24] [config] devices:
[2023-07-04 19:59:24] [config]   - 0
[2023-07-04 19:59:24] [config] dim-emb: 512
[2023-07-04 19:59:24] [config] dim-rnn: 1024
[2023-07-04 19:59:24] [config] dim-vocabs:
[2023-07-04 19:59:24] [config]   - 54042
[2023-07-04 19:59:24] [config]   - 36507
[2023-07-04 19:59:24] [config] disp-first: 0
[2023-07-04 19:59:24] [config] disp-freq: 1000u
[2023-07-04 19:59:24] [config] disp-label-counts: true
[2023-07-04 19:59:24] [config] dropout-rnn: 0
[2023-07-04 19:59:24] [config] dropout-src: 0
[2023-07-04 19:59:24] [config] dropout-trg: 0
[2023-07-04 19:59:24] [config] dump-config: ""
[2023-07-04 19:59:24] [config] dynamic-gradient-scaling:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] early-stopping: 10
[2023-07-04 19:59:24] [config] early-stopping-on: first
[2023-07-04 19:59:24] [config] embedding-fix-src: false
[2023-07-04 19:59:24] [config] embedding-fix-trg: false
[2023-07-04 19:59:24] [config] embedding-normalization: false
[2023-07-04 19:59:24] [config] embedding-vectors:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] enc-cell: gru
[2023-07-04 19:59:24] [config] enc-cell-depth: 1
[2023-07-04 19:59:24] [config] enc-depth: 1
[2023-07-04 19:59:24] [config] enc-type: bidirectional
[2023-07-04 19:59:24] [config] english-title-case-every: 0
[2023-07-04 19:59:24] [config] exponential-smoothing: 0
[2023-07-04 19:59:24] [config] factor-weight: 1
[2023-07-04 19:59:24] [config] factors-combine: sum
[2023-07-04 19:59:24] [config] factors-dim-emb: 0
[2023-07-04 19:59:24] [config] gradient-checkpointing: false
[2023-07-04 19:59:24] [config] gradient-norm-average-window: 100
[2023-07-04 19:59:24] [config] guided-alignment: none
[2023-07-04 19:59:24] [config] guided-alignment-cost: mse
[2023-07-04 19:59:24] [config] guided-alignment-weight: 0.1
[2023-07-04 19:59:24] [config] ignore-model-config: false
[2023-07-04 19:59:24] [config] input-types:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] interpolate-env-vars: false
[2023-07-04 19:59:24] [config] keep-best: false
[2023-07-04 19:59:24] [config] label-smoothing: 0
[2023-07-04 19:59:24] [config] layer-normalization: false
[2023-07-04 19:59:24] [config] learn-rate: 0.0001
[2023-07-04 19:59:24] [config] lemma-dependency: ""
[2023-07-04 19:59:24] [config] lemma-dim-emb: 0
[2023-07-04 19:59:24] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:59:24] [config] log-level: info
[2023-07-04 19:59:24] [config] log-time-zone: ""
[2023-07-04 19:59:24] [config] logical-epoch:
[2023-07-04 19:59:24] [config]   - 1e
[2023-07-04 19:59:24] [config]   - 0
[2023-07-04 19:59:24] [config] lr-decay: 0
[2023-07-04 19:59:24] [config] lr-decay-freq: 50000
[2023-07-04 19:59:24] [config] lr-decay-inv-sqrt:
[2023-07-04 19:59:24] [config]   - 0
[2023-07-04 19:59:24] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:59:24] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:59:24] [config] lr-decay-start:
[2023-07-04 19:59:24] [config]   - 10
[2023-07-04 19:59:24] [config]   - 1
[2023-07-04 19:59:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:59:24] [config] lr-report: false
[2023-07-04 19:59:24] [config] lr-warmup: 0
[2023-07-04 19:59:24] [config] lr-warmup-at-reload: false
[2023-07-04 19:59:24] [config] lr-warmup-cycle: false
[2023-07-04 19:59:24] [config] lr-warmup-start-rate: 0
[2023-07-04 19:59:24] [config] max-length: 50
[2023-07-04 19:59:24] [config] max-length-crop: false
[2023-07-04 19:59:24] [config] max-length-factor: 3
[2023-07-04 19:59:24] [config] maxi-batch: 100
[2023-07-04 19:59:24] [config] maxi-batch-sort: trg
[2023-07-04 19:59:24] [config] mini-batch: 64
[2023-07-04 19:59:24] [config] mini-batch-fit: false
[2023-07-04 19:59:24] [config] mini-batch-fit-step: 10
[2023-07-04 19:59:24] [config] mini-batch-round-up: true
[2023-07-04 19:59:24] [config] mini-batch-track-lr: false
[2023-07-04 19:59:24] [config] mini-batch-warmup: 0
[2023-07-04 19:59:24] [config] mini-batch-words: 0
[2023-07-04 19:59:24] [config] mini-batch-words-ref: 0
[2023-07-04 19:59:24] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:24] [config] multi-loss-type: sum
[2023-07-04 19:59:24] [config] n-best: false
[2023-07-04 19:59:24] [config] no-nccl: false
[2023-07-04 19:59:24] [config] no-reload: false
[2023-07-04 19:59:24] [config] no-restore-corpus: false
[2023-07-04 19:59:24] [config] normalize: 0
[2023-07-04 19:59:24] [config] normalize-gradient: false
[2023-07-04 19:59:24] [config] num-devices: 0
[2023-07-04 19:59:24] [config] optimizer: adam
[2023-07-04 19:59:24] [config] optimizer-delay: 1
[2023-07-04 19:59:24] [config] optimizer-params:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] output-omit-bias: false
[2023-07-04 19:59:24] [config] overwrite: true
[2023-07-04 19:59:24] [config] precision:
[2023-07-04 19:59:24] [config]   - float32
[2023-07-04 19:59:24] [config]   - float32
[2023-07-04 19:59:24] [config] pretrained-model: ""
[2023-07-04 19:59:24] [config] quantize-biases: false
[2023-07-04 19:59:24] [config] quantize-bits: 0
[2023-07-04 19:59:24] [config] quantize-log-based: false
[2023-07-04 19:59:24] [config] quantize-optimization-steps: 0
[2023-07-04 19:59:24] [config] quiet: false
[2023-07-04 19:59:24] [config] quiet-translation: true
[2023-07-04 19:59:24] [config] relative-paths: false
[2023-07-04 19:59:24] [config] right-left: false
[2023-07-04 19:59:24] [config] save-freq: 10000u
[2023-07-04 19:59:24] [config] seed: 1234
[2023-07-04 19:59:24] [config] sentencepiece-alphas:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:59:24] [config] sentencepiece-options: ""
[2023-07-04 19:59:24] [config] sharding: global
[2023-07-04 19:59:24] [config] shuffle: data
[2023-07-04 19:59:24] [config] shuffle-in-ram: false
[2023-07-04 19:59:24] [config] sigterm: save-and-exit
[2023-07-04 19:59:24] [config] skip: false
[2023-07-04 19:59:24] [config] sqlite: ""
[2023-07-04 19:59:24] [config] sqlite-drop: false
[2023-07-04 19:59:24] [config] sync-freq: 200u
[2023-07-04 19:59:24] [config] sync-sgd: false
[2023-07-04 19:59:24] [config] tempdir: /tmp
[2023-07-04 19:59:24] [config] tied-embeddings: false
[2023-07-04 19:59:24] [config] tied-embeddings-all: false
[2023-07-04 19:59:24] [config] tied-embeddings-src: false
[2023-07-04 19:59:24] [config] train-embedder-rank:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] train-sets:
[2023-07-04 19:59:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:59:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:59:24] [config] transformer-aan-activation: swish
[2023-07-04 19:59:24] [config] transformer-aan-depth: 2
[2023-07-04 19:59:24] [config] transformer-aan-nogate: false
[2023-07-04 19:59:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:59:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:59:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:59:24] [config] transformer-depth-scaling: false
[2023-07-04 19:59:24] [config] transformer-dim-aan: 2048
[2023-07-04 19:59:24] [config] transformer-dim-ffn: 2048
[2023-07-04 19:59:24] [config] transformer-dropout: 0
[2023-07-04 19:59:24] [config] transformer-dropout-attention: 0
[2023-07-04 19:59:24] [config] transformer-dropout-ffn: 0
[2023-07-04 19:59:24] [config] transformer-ffn-activation: swish
[2023-07-04 19:59:24] [config] transformer-ffn-depth: 2
[2023-07-04 19:59:24] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:59:24] [config] transformer-heads: 8
[2023-07-04 19:59:24] [config] transformer-no-projection: false
[2023-07-04 19:59:24] [config] transformer-pool: false
[2023-07-04 19:59:24] [config] transformer-postprocess: dan
[2023-07-04 19:59:24] [config] transformer-postprocess-emb: d
[2023-07-04 19:59:24] [config] transformer-postprocess-top: ""
[2023-07-04 19:59:24] [config] transformer-preprocess: ""
[2023-07-04 19:59:24] [config] transformer-tied-layers:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] transformer-train-position-embeddings: false
[2023-07-04 19:59:24] [config] tsv: false
[2023-07-04 19:59:24] [config] tsv-fields: 0
[2023-07-04 19:59:24] [config] type: s2s
[2023-07-04 19:59:24] [config] ulr: false
[2023-07-04 19:59:24] [config] ulr-dim-emb: 0
[2023-07-04 19:59:24] [config] ulr-dropout: 0
[2023-07-04 19:59:24] [config] ulr-keys-vectors: ""
[2023-07-04 19:59:24] [config] ulr-query-vectors: ""
[2023-07-04 19:59:24] [config] ulr-softmax-temperature: 1
[2023-07-04 19:59:24] [config] ulr-trainable-transformation: false
[2023-07-04 19:59:24] [config] unlikelihood-loss: false
[2023-07-04 19:59:24] [config] valid-freq: 50000000
[2023-07-04 19:59:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:59:24] [config] valid-max-length: 1000
[2023-07-04 19:59:24] [config] valid-metrics:
[2023-07-04 19:59:24] [config]   - cross-entropy
[2023-07-04 19:59:24] [config]   - translation
[2023-07-04 19:59:24] [config] valid-mini-batch: 32
[2023-07-04 19:59:24] [config] valid-reset-stalled: false
[2023-07-04 19:59:24] [config] valid-script-args:
[2023-07-04 19:59:24] [config]   []
[2023-07-04 19:59:24] [config] valid-script-path: ""
[2023-07-04 19:59:24] [config] valid-sets:
[2023-07-04 19:59:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:59:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:59:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:59:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:24] [config] vocabs:
[2023-07-04 19:59:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:24] [config] word-penalty: 0
[2023-07-04 19:59:24] [config] word-scores: false
[2023-07-04 19:59:24] [config] workspace: 2048
[2023-07-04 19:59:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:24] [training] Using single-device training
[2023-07-04 19:59:27] Synced seed 1234
[2023-07-04 19:59:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:27] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:59:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:27] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:59:27] [valid] No post-processing script given for validating translator
[2023-07-04 19:59:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:28] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:59:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:59:28] [comm] Using global sharding
[2023-07-04 19:59:28] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:59:28] [training] Using 1 GPUs
[2023-07-04 19:59:28] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:29] Loading Adam parameters
[2023-07-04 19:59:30] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:59:30] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:59:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:59:30] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 19:59:30] [data] Shuffling data
[2023-07-04 19:59:30] [data] Done reading 20,192 sentences
[2023-07-04 19:59:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:59:30] Training started
[2023-07-04 19:59:30] Training finished
[2023-07-04 19:59:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:34] [marian] Running on node07.datos.cluster.uy as process 14490 with command line:
[2023-07-04 19:59:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:59:34] [config] after: 0e
[2023-07-04 19:59:34] [config] after-batches: 0
[2023-07-04 19:59:34] [config] after-epochs: 150
[2023-07-04 19:59:34] [config] all-caps-every: 0
[2023-07-04 19:59:34] [config] allow-unk: false
[2023-07-04 19:59:34] [config] authors: false
[2023-07-04 19:59:34] [config] beam-size: 12
[2023-07-04 19:59:34] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:59:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:59:34] [config] bert-masking-fraction: 0.15
[2023-07-04 19:59:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:59:34] [config] bert-train-type-embeddings: true
[2023-07-04 19:59:34] [config] bert-type-vocab-size: 2
[2023-07-04 19:59:34] [config] build-info: ""
[2023-07-04 19:59:34] [config] check-gradient-nan: false
[2023-07-04 19:59:34] [config] check-nan: false
[2023-07-04 19:59:34] [config] cite: false
[2023-07-04 19:59:34] [config] clip-norm: 1
[2023-07-04 19:59:34] [config] cost-scaling:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] cost-type: ce-sum
[2023-07-04 19:59:34] [config] cpu-threads: 0
[2023-07-04 19:59:34] [config] data-threads: 8
[2023-07-04 19:59:34] [config] data-weighting: ""
[2023-07-04 19:59:34] [config] data-weighting-type: sentence
[2023-07-04 19:59:34] [config] dec-cell: gru
[2023-07-04 19:59:34] [config] dec-cell-base-depth: 2
[2023-07-04 19:59:34] [config] dec-cell-high-depth: 1
[2023-07-04 19:59:34] [config] dec-depth: 1
[2023-07-04 19:59:34] [config] devices:
[2023-07-04 19:59:34] [config]   - 0
[2023-07-04 19:59:34] [config] dim-emb: 512
[2023-07-04 19:59:34] [config] dim-rnn: 1024
[2023-07-04 19:59:34] [config] dim-vocabs:
[2023-07-04 19:59:34] [config]   - 54042
[2023-07-04 19:59:34] [config]   - 36507
[2023-07-04 19:59:34] [config] disp-first: 0
[2023-07-04 19:59:34] [config] disp-freq: 1000u
[2023-07-04 19:59:34] [config] disp-label-counts: true
[2023-07-04 19:59:34] [config] dropout-rnn: 0
[2023-07-04 19:59:34] [config] dropout-src: 0
[2023-07-04 19:59:34] [config] dropout-trg: 0
[2023-07-04 19:59:34] [config] dump-config: ""
[2023-07-04 19:59:34] [config] dynamic-gradient-scaling:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] early-stopping: 10
[2023-07-04 19:59:34] [config] early-stopping-on: first
[2023-07-04 19:59:34] [config] embedding-fix-src: false
[2023-07-04 19:59:34] [config] embedding-fix-trg: false
[2023-07-04 19:59:34] [config] embedding-normalization: false
[2023-07-04 19:59:34] [config] embedding-vectors:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] enc-cell: gru
[2023-07-04 19:59:34] [config] enc-cell-depth: 1
[2023-07-04 19:59:34] [config] enc-depth: 1
[2023-07-04 19:59:34] [config] enc-type: bidirectional
[2023-07-04 19:59:34] [config] english-title-case-every: 0
[2023-07-04 19:59:34] [config] exponential-smoothing: 0
[2023-07-04 19:59:34] [config] factor-weight: 1
[2023-07-04 19:59:34] [config] factors-combine: sum
[2023-07-04 19:59:34] [config] factors-dim-emb: 0
[2023-07-04 19:59:34] [config] gradient-checkpointing: false
[2023-07-04 19:59:34] [config] gradient-norm-average-window: 100
[2023-07-04 19:59:34] [config] guided-alignment: none
[2023-07-04 19:59:34] [config] guided-alignment-cost: mse
[2023-07-04 19:59:34] [config] guided-alignment-weight: 0.1
[2023-07-04 19:59:34] [config] ignore-model-config: false
[2023-07-04 19:59:34] [config] input-types:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] interpolate-env-vars: false
[2023-07-04 19:59:34] [config] keep-best: false
[2023-07-04 19:59:34] [config] label-smoothing: 0
[2023-07-04 19:59:34] [config] layer-normalization: false
[2023-07-04 19:59:34] [config] learn-rate: 0.0001
[2023-07-04 19:59:34] [config] lemma-dependency: ""
[2023-07-04 19:59:34] [config] lemma-dim-emb: 0
[2023-07-04 19:59:34] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:59:34] [config] log-level: info
[2023-07-04 19:59:34] [config] log-time-zone: ""
[2023-07-04 19:59:34] [config] logical-epoch:
[2023-07-04 19:59:34] [config]   - 1e
[2023-07-04 19:59:34] [config]   - 0
[2023-07-04 19:59:34] [config] lr-decay: 0
[2023-07-04 19:59:34] [config] lr-decay-freq: 50000
[2023-07-04 19:59:34] [config] lr-decay-inv-sqrt:
[2023-07-04 19:59:34] [config]   - 0
[2023-07-04 19:59:34] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:59:34] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:59:34] [config] lr-decay-start:
[2023-07-04 19:59:34] [config]   - 10
[2023-07-04 19:59:34] [config]   - 1
[2023-07-04 19:59:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:59:34] [config] lr-report: false
[2023-07-04 19:59:34] [config] lr-warmup: 0
[2023-07-04 19:59:34] [config] lr-warmup-at-reload: false
[2023-07-04 19:59:34] [config] lr-warmup-cycle: false
[2023-07-04 19:59:34] [config] lr-warmup-start-rate: 0
[2023-07-04 19:59:34] [config] max-length: 50
[2023-07-04 19:59:34] [config] max-length-crop: false
[2023-07-04 19:59:34] [config] max-length-factor: 3
[2023-07-04 19:59:34] [config] maxi-batch: 100
[2023-07-04 19:59:34] [config] maxi-batch-sort: trg
[2023-07-04 19:59:34] [config] mini-batch: 64
[2023-07-04 19:59:34] [config] mini-batch-fit: false
[2023-07-04 19:59:34] [config] mini-batch-fit-step: 10
[2023-07-04 19:59:34] [config] mini-batch-round-up: true
[2023-07-04 19:59:34] [config] mini-batch-track-lr: false
[2023-07-04 19:59:34] [config] mini-batch-warmup: 0
[2023-07-04 19:59:34] [config] mini-batch-words: 0
[2023-07-04 19:59:34] [config] mini-batch-words-ref: 0
[2023-07-04 19:59:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:34] [config] multi-loss-type: sum
[2023-07-04 19:59:34] [config] n-best: false
[2023-07-04 19:59:34] [config] no-nccl: false
[2023-07-04 19:59:34] [config] no-reload: false
[2023-07-04 19:59:34] [config] no-restore-corpus: false
[2023-07-04 19:59:34] [config] normalize: 0
[2023-07-04 19:59:34] [config] normalize-gradient: false
[2023-07-04 19:59:34] [config] num-devices: 0
[2023-07-04 19:59:34] [config] optimizer: adam
[2023-07-04 19:59:34] [config] optimizer-delay: 1
[2023-07-04 19:59:34] [config] optimizer-params:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] output-omit-bias: false
[2023-07-04 19:59:34] [config] overwrite: true
[2023-07-04 19:59:34] [config] precision:
[2023-07-04 19:59:34] [config]   - float32
[2023-07-04 19:59:34] [config]   - float32
[2023-07-04 19:59:34] [config] pretrained-model: ""
[2023-07-04 19:59:34] [config] quantize-biases: false
[2023-07-04 19:59:34] [config] quantize-bits: 0
[2023-07-04 19:59:34] [config] quantize-log-based: false
[2023-07-04 19:59:34] [config] quantize-optimization-steps: 0
[2023-07-04 19:59:34] [config] quiet: false
[2023-07-04 19:59:34] [config] quiet-translation: true
[2023-07-04 19:59:34] [config] relative-paths: false
[2023-07-04 19:59:34] [config] right-left: false
[2023-07-04 19:59:34] [config] save-freq: 10000u
[2023-07-04 19:59:34] [config] seed: 1234
[2023-07-04 19:59:34] [config] sentencepiece-alphas:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:59:34] [config] sentencepiece-options: ""
[2023-07-04 19:59:34] [config] sharding: global
[2023-07-04 19:59:34] [config] shuffle: data
[2023-07-04 19:59:34] [config] shuffle-in-ram: false
[2023-07-04 19:59:34] [config] sigterm: save-and-exit
[2023-07-04 19:59:34] [config] skip: false
[2023-07-04 19:59:34] [config] sqlite: ""
[2023-07-04 19:59:34] [config] sqlite-drop: false
[2023-07-04 19:59:34] [config] sync-freq: 200u
[2023-07-04 19:59:34] [config] sync-sgd: false
[2023-07-04 19:59:34] [config] tempdir: /tmp
[2023-07-04 19:59:34] [config] tied-embeddings: false
[2023-07-04 19:59:34] [config] tied-embeddings-all: false
[2023-07-04 19:59:34] [config] tied-embeddings-src: false
[2023-07-04 19:59:34] [config] train-embedder-rank:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] train-sets:
[2023-07-04 19:59:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:59:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:59:34] [config] transformer-aan-activation: swish
[2023-07-04 19:59:34] [config] transformer-aan-depth: 2
[2023-07-04 19:59:34] [config] transformer-aan-nogate: false
[2023-07-04 19:59:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:59:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:59:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:59:34] [config] transformer-depth-scaling: false
[2023-07-04 19:59:34] [config] transformer-dim-aan: 2048
[2023-07-04 19:59:34] [config] transformer-dim-ffn: 2048
[2023-07-04 19:59:34] [config] transformer-dropout: 0
[2023-07-04 19:59:34] [config] transformer-dropout-attention: 0
[2023-07-04 19:59:34] [config] transformer-dropout-ffn: 0
[2023-07-04 19:59:34] [config] transformer-ffn-activation: swish
[2023-07-04 19:59:34] [config] transformer-ffn-depth: 2
[2023-07-04 19:59:34] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:59:34] [config] transformer-heads: 8
[2023-07-04 19:59:34] [config] transformer-no-projection: false
[2023-07-04 19:59:34] [config] transformer-pool: false
[2023-07-04 19:59:34] [config] transformer-postprocess: dan
[2023-07-04 19:59:34] [config] transformer-postprocess-emb: d
[2023-07-04 19:59:34] [config] transformer-postprocess-top: ""
[2023-07-04 19:59:34] [config] transformer-preprocess: ""
[2023-07-04 19:59:34] [config] transformer-tied-layers:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] transformer-train-position-embeddings: false
[2023-07-04 19:59:34] [config] tsv: false
[2023-07-04 19:59:34] [config] tsv-fields: 0
[2023-07-04 19:59:34] [config] type: s2s
[2023-07-04 19:59:34] [config] ulr: false
[2023-07-04 19:59:34] [config] ulr-dim-emb: 0
[2023-07-04 19:59:34] [config] ulr-dropout: 0
[2023-07-04 19:59:34] [config] ulr-keys-vectors: ""
[2023-07-04 19:59:34] [config] ulr-query-vectors: ""
[2023-07-04 19:59:34] [config] ulr-softmax-temperature: 1
[2023-07-04 19:59:34] [config] ulr-trainable-transformation: false
[2023-07-04 19:59:34] [config] unlikelihood-loss: false
[2023-07-04 19:59:34] [config] valid-freq: 50000000
[2023-07-04 19:59:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:59:34] [config] valid-max-length: 1000
[2023-07-04 19:59:34] [config] valid-metrics:
[2023-07-04 19:59:34] [config]   - cross-entropy
[2023-07-04 19:59:34] [config]   - translation
[2023-07-04 19:59:34] [config] valid-mini-batch: 32
[2023-07-04 19:59:34] [config] valid-reset-stalled: false
[2023-07-04 19:59:34] [config] valid-script-args:
[2023-07-04 19:59:34] [config]   []
[2023-07-04 19:59:34] [config] valid-script-path: ""
[2023-07-04 19:59:34] [config] valid-sets:
[2023-07-04 19:59:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:59:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:59:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:59:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:34] [config] vocabs:
[2023-07-04 19:59:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:34] [config] word-penalty: 0
[2023-07-04 19:59:34] [config] word-scores: false
[2023-07-04 19:59:34] [config] workspace: 2048
[2023-07-04 19:59:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:34] [training] Using single-device training
[2023-07-04 19:59:35] Synced seed 1234
[2023-07-04 19:59:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:35] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:59:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:35] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:59:35] [valid] No post-processing script given for validating translator
[2023-07-04 19:59:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:36] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:59:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:59:36] [comm] Using global sharding
[2023-07-04 19:59:36] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:59:36] [training] Using 1 GPUs
[2023-07-04 19:59:36] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:37] Loading Adam parameters
[2023-07-04 19:59:38] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:59:38] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:59:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:59:38] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 19:59:38] [data] Shuffling data
[2023-07-04 19:59:38] [data] Done reading 20,192 sentences
[2023-07-04 19:59:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:59:38] Training started
[2023-07-04 19:59:38] Training finished
[2023-07-04 19:59:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:42] [marian] Running on node07.datos.cluster.uy as process 14538 with command line:
[2023-07-04 19:59:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:59:42] [config] after: 0e
[2023-07-04 19:59:42] [config] after-batches: 0
[2023-07-04 19:59:42] [config] after-epochs: 160
[2023-07-04 19:59:42] [config] all-caps-every: 0
[2023-07-04 19:59:42] [config] allow-unk: false
[2023-07-04 19:59:42] [config] authors: false
[2023-07-04 19:59:42] [config] beam-size: 12
[2023-07-04 19:59:42] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:59:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:59:42] [config] bert-masking-fraction: 0.15
[2023-07-04 19:59:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:59:42] [config] bert-train-type-embeddings: true
[2023-07-04 19:59:42] [config] bert-type-vocab-size: 2
[2023-07-04 19:59:42] [config] build-info: ""
[2023-07-04 19:59:42] [config] check-gradient-nan: false
[2023-07-04 19:59:42] [config] check-nan: false
[2023-07-04 19:59:42] [config] cite: false
[2023-07-04 19:59:42] [config] clip-norm: 1
[2023-07-04 19:59:42] [config] cost-scaling:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] cost-type: ce-sum
[2023-07-04 19:59:42] [config] cpu-threads: 0
[2023-07-04 19:59:42] [config] data-threads: 8
[2023-07-04 19:59:42] [config] data-weighting: ""
[2023-07-04 19:59:42] [config] data-weighting-type: sentence
[2023-07-04 19:59:42] [config] dec-cell: gru
[2023-07-04 19:59:42] [config] dec-cell-base-depth: 2
[2023-07-04 19:59:42] [config] dec-cell-high-depth: 1
[2023-07-04 19:59:42] [config] dec-depth: 1
[2023-07-04 19:59:42] [config] devices:
[2023-07-04 19:59:42] [config]   - 0
[2023-07-04 19:59:42] [config] dim-emb: 512
[2023-07-04 19:59:42] [config] dim-rnn: 1024
[2023-07-04 19:59:42] [config] dim-vocabs:
[2023-07-04 19:59:42] [config]   - 54042
[2023-07-04 19:59:42] [config]   - 36507
[2023-07-04 19:59:42] [config] disp-first: 0
[2023-07-04 19:59:42] [config] disp-freq: 1000u
[2023-07-04 19:59:42] [config] disp-label-counts: true
[2023-07-04 19:59:42] [config] dropout-rnn: 0
[2023-07-04 19:59:42] [config] dropout-src: 0
[2023-07-04 19:59:42] [config] dropout-trg: 0
[2023-07-04 19:59:42] [config] dump-config: ""
[2023-07-04 19:59:42] [config] dynamic-gradient-scaling:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] early-stopping: 10
[2023-07-04 19:59:42] [config] early-stopping-on: first
[2023-07-04 19:59:42] [config] embedding-fix-src: false
[2023-07-04 19:59:42] [config] embedding-fix-trg: false
[2023-07-04 19:59:42] [config] embedding-normalization: false
[2023-07-04 19:59:42] [config] embedding-vectors:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] enc-cell: gru
[2023-07-04 19:59:42] [config] enc-cell-depth: 1
[2023-07-04 19:59:42] [config] enc-depth: 1
[2023-07-04 19:59:42] [config] enc-type: bidirectional
[2023-07-04 19:59:42] [config] english-title-case-every: 0
[2023-07-04 19:59:42] [config] exponential-smoothing: 0
[2023-07-04 19:59:42] [config] factor-weight: 1
[2023-07-04 19:59:42] [config] factors-combine: sum
[2023-07-04 19:59:42] [config] factors-dim-emb: 0
[2023-07-04 19:59:42] [config] gradient-checkpointing: false
[2023-07-04 19:59:42] [config] gradient-norm-average-window: 100
[2023-07-04 19:59:42] [config] guided-alignment: none
[2023-07-04 19:59:42] [config] guided-alignment-cost: mse
[2023-07-04 19:59:42] [config] guided-alignment-weight: 0.1
[2023-07-04 19:59:42] [config] ignore-model-config: false
[2023-07-04 19:59:42] [config] input-types:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] interpolate-env-vars: false
[2023-07-04 19:59:42] [config] keep-best: false
[2023-07-04 19:59:42] [config] label-smoothing: 0
[2023-07-04 19:59:42] [config] layer-normalization: false
[2023-07-04 19:59:42] [config] learn-rate: 0.0001
[2023-07-04 19:59:42] [config] lemma-dependency: ""
[2023-07-04 19:59:42] [config] lemma-dim-emb: 0
[2023-07-04 19:59:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:59:42] [config] log-level: info
[2023-07-04 19:59:42] [config] log-time-zone: ""
[2023-07-04 19:59:42] [config] logical-epoch:
[2023-07-04 19:59:42] [config]   - 1e
[2023-07-04 19:59:42] [config]   - 0
[2023-07-04 19:59:42] [config] lr-decay: 0
[2023-07-04 19:59:42] [config] lr-decay-freq: 50000
[2023-07-04 19:59:42] [config] lr-decay-inv-sqrt:
[2023-07-04 19:59:42] [config]   - 0
[2023-07-04 19:59:42] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:59:42] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:59:42] [config] lr-decay-start:
[2023-07-04 19:59:42] [config]   - 10
[2023-07-04 19:59:42] [config]   - 1
[2023-07-04 19:59:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:59:42] [config] lr-report: false
[2023-07-04 19:59:42] [config] lr-warmup: 0
[2023-07-04 19:59:42] [config] lr-warmup-at-reload: false
[2023-07-04 19:59:42] [config] lr-warmup-cycle: false
[2023-07-04 19:59:42] [config] lr-warmup-start-rate: 0
[2023-07-04 19:59:42] [config] max-length: 50
[2023-07-04 19:59:42] [config] max-length-crop: false
[2023-07-04 19:59:42] [config] max-length-factor: 3
[2023-07-04 19:59:42] [config] maxi-batch: 100
[2023-07-04 19:59:42] [config] maxi-batch-sort: trg
[2023-07-04 19:59:42] [config] mini-batch: 64
[2023-07-04 19:59:42] [config] mini-batch-fit: false
[2023-07-04 19:59:42] [config] mini-batch-fit-step: 10
[2023-07-04 19:59:42] [config] mini-batch-round-up: true
[2023-07-04 19:59:42] [config] mini-batch-track-lr: false
[2023-07-04 19:59:42] [config] mini-batch-warmup: 0
[2023-07-04 19:59:42] [config] mini-batch-words: 0
[2023-07-04 19:59:42] [config] mini-batch-words-ref: 0
[2023-07-04 19:59:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:42] [config] multi-loss-type: sum
[2023-07-04 19:59:42] [config] n-best: false
[2023-07-04 19:59:42] [config] no-nccl: false
[2023-07-04 19:59:42] [config] no-reload: false
[2023-07-04 19:59:42] [config] no-restore-corpus: false
[2023-07-04 19:59:42] [config] normalize: 0
[2023-07-04 19:59:42] [config] normalize-gradient: false
[2023-07-04 19:59:42] [config] num-devices: 0
[2023-07-04 19:59:42] [config] optimizer: adam
[2023-07-04 19:59:42] [config] optimizer-delay: 1
[2023-07-04 19:59:42] [config] optimizer-params:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] output-omit-bias: false
[2023-07-04 19:59:42] [config] overwrite: true
[2023-07-04 19:59:42] [config] precision:
[2023-07-04 19:59:42] [config]   - float32
[2023-07-04 19:59:42] [config]   - float32
[2023-07-04 19:59:42] [config] pretrained-model: ""
[2023-07-04 19:59:42] [config] quantize-biases: false
[2023-07-04 19:59:42] [config] quantize-bits: 0
[2023-07-04 19:59:42] [config] quantize-log-based: false
[2023-07-04 19:59:42] [config] quantize-optimization-steps: 0
[2023-07-04 19:59:42] [config] quiet: false
[2023-07-04 19:59:42] [config] quiet-translation: true
[2023-07-04 19:59:42] [config] relative-paths: false
[2023-07-04 19:59:42] [config] right-left: false
[2023-07-04 19:59:42] [config] save-freq: 10000u
[2023-07-04 19:59:42] [config] seed: 1234
[2023-07-04 19:59:42] [config] sentencepiece-alphas:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:59:42] [config] sentencepiece-options: ""
[2023-07-04 19:59:42] [config] sharding: global
[2023-07-04 19:59:42] [config] shuffle: data
[2023-07-04 19:59:42] [config] shuffle-in-ram: false
[2023-07-04 19:59:42] [config] sigterm: save-and-exit
[2023-07-04 19:59:42] [config] skip: false
[2023-07-04 19:59:42] [config] sqlite: ""
[2023-07-04 19:59:42] [config] sqlite-drop: false
[2023-07-04 19:59:42] [config] sync-freq: 200u
[2023-07-04 19:59:42] [config] sync-sgd: false
[2023-07-04 19:59:42] [config] tempdir: /tmp
[2023-07-04 19:59:42] [config] tied-embeddings: false
[2023-07-04 19:59:42] [config] tied-embeddings-all: false
[2023-07-04 19:59:42] [config] tied-embeddings-src: false
[2023-07-04 19:59:42] [config] train-embedder-rank:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] train-sets:
[2023-07-04 19:59:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:59:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:59:42] [config] transformer-aan-activation: swish
[2023-07-04 19:59:42] [config] transformer-aan-depth: 2
[2023-07-04 19:59:42] [config] transformer-aan-nogate: false
[2023-07-04 19:59:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:59:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:59:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:59:42] [config] transformer-depth-scaling: false
[2023-07-04 19:59:42] [config] transformer-dim-aan: 2048
[2023-07-04 19:59:42] [config] transformer-dim-ffn: 2048
[2023-07-04 19:59:42] [config] transformer-dropout: 0
[2023-07-04 19:59:42] [config] transformer-dropout-attention: 0
[2023-07-04 19:59:42] [config] transformer-dropout-ffn: 0
[2023-07-04 19:59:42] [config] transformer-ffn-activation: swish
[2023-07-04 19:59:42] [config] transformer-ffn-depth: 2
[2023-07-04 19:59:42] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:59:42] [config] transformer-heads: 8
[2023-07-04 19:59:42] [config] transformer-no-projection: false
[2023-07-04 19:59:42] [config] transformer-pool: false
[2023-07-04 19:59:42] [config] transformer-postprocess: dan
[2023-07-04 19:59:42] [config] transformer-postprocess-emb: d
[2023-07-04 19:59:42] [config] transformer-postprocess-top: ""
[2023-07-04 19:59:42] [config] transformer-preprocess: ""
[2023-07-04 19:59:42] [config] transformer-tied-layers:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] transformer-train-position-embeddings: false
[2023-07-04 19:59:42] [config] tsv: false
[2023-07-04 19:59:42] [config] tsv-fields: 0
[2023-07-04 19:59:42] [config] type: s2s
[2023-07-04 19:59:42] [config] ulr: false
[2023-07-04 19:59:42] [config] ulr-dim-emb: 0
[2023-07-04 19:59:42] [config] ulr-dropout: 0
[2023-07-04 19:59:42] [config] ulr-keys-vectors: ""
[2023-07-04 19:59:42] [config] ulr-query-vectors: ""
[2023-07-04 19:59:42] [config] ulr-softmax-temperature: 1
[2023-07-04 19:59:42] [config] ulr-trainable-transformation: false
[2023-07-04 19:59:42] [config] unlikelihood-loss: false
[2023-07-04 19:59:42] [config] valid-freq: 50000000
[2023-07-04 19:59:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:59:42] [config] valid-max-length: 1000
[2023-07-04 19:59:42] [config] valid-metrics:
[2023-07-04 19:59:42] [config]   - cross-entropy
[2023-07-04 19:59:42] [config]   - translation
[2023-07-04 19:59:42] [config] valid-mini-batch: 32
[2023-07-04 19:59:42] [config] valid-reset-stalled: false
[2023-07-04 19:59:42] [config] valid-script-args:
[2023-07-04 19:59:42] [config]   []
[2023-07-04 19:59:42] [config] valid-script-path: ""
[2023-07-04 19:59:42] [config] valid-sets:
[2023-07-04 19:59:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:59:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:59:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:59:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:42] [config] vocabs:
[2023-07-04 19:59:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:42] [config] word-penalty: 0
[2023-07-04 19:59:42] [config] word-scores: false
[2023-07-04 19:59:42] [config] workspace: 2048
[2023-07-04 19:59:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:42] [training] Using single-device training
[2023-07-04 19:59:42] Synced seed 1234
[2023-07-04 19:59:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:43] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:59:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:43] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:59:43] [valid] No post-processing script given for validating translator
[2023-07-04 19:59:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:59:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:59:44] [comm] Using global sharding
[2023-07-04 19:59:44] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:59:44] [training] Using 1 GPUs
[2023-07-04 19:59:44] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:45] Loading Adam parameters
[2023-07-04 19:59:46] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:59:46] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:59:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:59:46] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 19:59:46] [data] Shuffling data
[2023-07-04 19:59:46] [data] Done reading 20,192 sentences
[2023-07-04 19:59:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:59:46] Training started
[2023-07-04 19:59:46] Training finished
[2023-07-04 19:59:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:50] [marian] Running on node07.datos.cluster.uy as process 14587 with command line:
[2023-07-04 19:59:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:59:50] [config] after: 0e
[2023-07-04 19:59:50] [config] after-batches: 0
[2023-07-04 19:59:50] [config] after-epochs: 170
[2023-07-04 19:59:50] [config] all-caps-every: 0
[2023-07-04 19:59:50] [config] allow-unk: false
[2023-07-04 19:59:50] [config] authors: false
[2023-07-04 19:59:50] [config] beam-size: 12
[2023-07-04 19:59:50] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:59:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:59:50] [config] bert-masking-fraction: 0.15
[2023-07-04 19:59:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:59:50] [config] bert-train-type-embeddings: true
[2023-07-04 19:59:50] [config] bert-type-vocab-size: 2
[2023-07-04 19:59:50] [config] build-info: ""
[2023-07-04 19:59:50] [config] check-gradient-nan: false
[2023-07-04 19:59:50] [config] check-nan: false
[2023-07-04 19:59:50] [config] cite: false
[2023-07-04 19:59:50] [config] clip-norm: 1
[2023-07-04 19:59:50] [config] cost-scaling:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] cost-type: ce-sum
[2023-07-04 19:59:50] [config] cpu-threads: 0
[2023-07-04 19:59:50] [config] data-threads: 8
[2023-07-04 19:59:50] [config] data-weighting: ""
[2023-07-04 19:59:50] [config] data-weighting-type: sentence
[2023-07-04 19:59:50] [config] dec-cell: gru
[2023-07-04 19:59:50] [config] dec-cell-base-depth: 2
[2023-07-04 19:59:50] [config] dec-cell-high-depth: 1
[2023-07-04 19:59:50] [config] dec-depth: 1
[2023-07-04 19:59:50] [config] devices:
[2023-07-04 19:59:50] [config]   - 0
[2023-07-04 19:59:50] [config] dim-emb: 512
[2023-07-04 19:59:50] [config] dim-rnn: 1024
[2023-07-04 19:59:50] [config] dim-vocabs:
[2023-07-04 19:59:50] [config]   - 54042
[2023-07-04 19:59:50] [config]   - 36507
[2023-07-04 19:59:50] [config] disp-first: 0
[2023-07-04 19:59:50] [config] disp-freq: 1000u
[2023-07-04 19:59:50] [config] disp-label-counts: true
[2023-07-04 19:59:50] [config] dropout-rnn: 0
[2023-07-04 19:59:50] [config] dropout-src: 0
[2023-07-04 19:59:50] [config] dropout-trg: 0
[2023-07-04 19:59:50] [config] dump-config: ""
[2023-07-04 19:59:50] [config] dynamic-gradient-scaling:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] early-stopping: 10
[2023-07-04 19:59:50] [config] early-stopping-on: first
[2023-07-04 19:59:50] [config] embedding-fix-src: false
[2023-07-04 19:59:50] [config] embedding-fix-trg: false
[2023-07-04 19:59:50] [config] embedding-normalization: false
[2023-07-04 19:59:50] [config] embedding-vectors:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] enc-cell: gru
[2023-07-04 19:59:50] [config] enc-cell-depth: 1
[2023-07-04 19:59:50] [config] enc-depth: 1
[2023-07-04 19:59:50] [config] enc-type: bidirectional
[2023-07-04 19:59:50] [config] english-title-case-every: 0
[2023-07-04 19:59:50] [config] exponential-smoothing: 0
[2023-07-04 19:59:50] [config] factor-weight: 1
[2023-07-04 19:59:50] [config] factors-combine: sum
[2023-07-04 19:59:50] [config] factors-dim-emb: 0
[2023-07-04 19:59:50] [config] gradient-checkpointing: false
[2023-07-04 19:59:50] [config] gradient-norm-average-window: 100
[2023-07-04 19:59:50] [config] guided-alignment: none
[2023-07-04 19:59:50] [config] guided-alignment-cost: mse
[2023-07-04 19:59:50] [config] guided-alignment-weight: 0.1
[2023-07-04 19:59:50] [config] ignore-model-config: false
[2023-07-04 19:59:50] [config] input-types:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] interpolate-env-vars: false
[2023-07-04 19:59:50] [config] keep-best: false
[2023-07-04 19:59:50] [config] label-smoothing: 0
[2023-07-04 19:59:50] [config] layer-normalization: false
[2023-07-04 19:59:50] [config] learn-rate: 0.0001
[2023-07-04 19:59:50] [config] lemma-dependency: ""
[2023-07-04 19:59:50] [config] lemma-dim-emb: 0
[2023-07-04 19:59:50] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:59:50] [config] log-level: info
[2023-07-04 19:59:50] [config] log-time-zone: ""
[2023-07-04 19:59:50] [config] logical-epoch:
[2023-07-04 19:59:50] [config]   - 1e
[2023-07-04 19:59:50] [config]   - 0
[2023-07-04 19:59:50] [config] lr-decay: 0
[2023-07-04 19:59:50] [config] lr-decay-freq: 50000
[2023-07-04 19:59:50] [config] lr-decay-inv-sqrt:
[2023-07-04 19:59:50] [config]   - 0
[2023-07-04 19:59:50] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:59:50] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:59:50] [config] lr-decay-start:
[2023-07-04 19:59:50] [config]   - 10
[2023-07-04 19:59:50] [config]   - 1
[2023-07-04 19:59:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:59:50] [config] lr-report: false
[2023-07-04 19:59:50] [config] lr-warmup: 0
[2023-07-04 19:59:50] [config] lr-warmup-at-reload: false
[2023-07-04 19:59:50] [config] lr-warmup-cycle: false
[2023-07-04 19:59:50] [config] lr-warmup-start-rate: 0
[2023-07-04 19:59:50] [config] max-length: 50
[2023-07-04 19:59:50] [config] max-length-crop: false
[2023-07-04 19:59:50] [config] max-length-factor: 3
[2023-07-04 19:59:50] [config] maxi-batch: 100
[2023-07-04 19:59:50] [config] maxi-batch-sort: trg
[2023-07-04 19:59:50] [config] mini-batch: 64
[2023-07-04 19:59:50] [config] mini-batch-fit: false
[2023-07-04 19:59:50] [config] mini-batch-fit-step: 10
[2023-07-04 19:59:50] [config] mini-batch-round-up: true
[2023-07-04 19:59:50] [config] mini-batch-track-lr: false
[2023-07-04 19:59:50] [config] mini-batch-warmup: 0
[2023-07-04 19:59:50] [config] mini-batch-words: 0
[2023-07-04 19:59:50] [config] mini-batch-words-ref: 0
[2023-07-04 19:59:50] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:50] [config] multi-loss-type: sum
[2023-07-04 19:59:50] [config] n-best: false
[2023-07-04 19:59:50] [config] no-nccl: false
[2023-07-04 19:59:50] [config] no-reload: false
[2023-07-04 19:59:50] [config] no-restore-corpus: false
[2023-07-04 19:59:50] [config] normalize: 0
[2023-07-04 19:59:50] [config] normalize-gradient: false
[2023-07-04 19:59:50] [config] num-devices: 0
[2023-07-04 19:59:50] [config] optimizer: adam
[2023-07-04 19:59:50] [config] optimizer-delay: 1
[2023-07-04 19:59:50] [config] optimizer-params:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] output-omit-bias: false
[2023-07-04 19:59:50] [config] overwrite: true
[2023-07-04 19:59:50] [config] precision:
[2023-07-04 19:59:50] [config]   - float32
[2023-07-04 19:59:50] [config]   - float32
[2023-07-04 19:59:50] [config] pretrained-model: ""
[2023-07-04 19:59:50] [config] quantize-biases: false
[2023-07-04 19:59:50] [config] quantize-bits: 0
[2023-07-04 19:59:50] [config] quantize-log-based: false
[2023-07-04 19:59:50] [config] quantize-optimization-steps: 0
[2023-07-04 19:59:50] [config] quiet: false
[2023-07-04 19:59:50] [config] quiet-translation: true
[2023-07-04 19:59:50] [config] relative-paths: false
[2023-07-04 19:59:50] [config] right-left: false
[2023-07-04 19:59:50] [config] save-freq: 10000u
[2023-07-04 19:59:50] [config] seed: 1234
[2023-07-04 19:59:50] [config] sentencepiece-alphas:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:59:50] [config] sentencepiece-options: ""
[2023-07-04 19:59:50] [config] sharding: global
[2023-07-04 19:59:50] [config] shuffle: data
[2023-07-04 19:59:50] [config] shuffle-in-ram: false
[2023-07-04 19:59:50] [config] sigterm: save-and-exit
[2023-07-04 19:59:50] [config] skip: false
[2023-07-04 19:59:50] [config] sqlite: ""
[2023-07-04 19:59:50] [config] sqlite-drop: false
[2023-07-04 19:59:50] [config] sync-freq: 200u
[2023-07-04 19:59:50] [config] sync-sgd: false
[2023-07-04 19:59:50] [config] tempdir: /tmp
[2023-07-04 19:59:50] [config] tied-embeddings: false
[2023-07-04 19:59:50] [config] tied-embeddings-all: false
[2023-07-04 19:59:50] [config] tied-embeddings-src: false
[2023-07-04 19:59:50] [config] train-embedder-rank:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] train-sets:
[2023-07-04 19:59:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:59:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:59:50] [config] transformer-aan-activation: swish
[2023-07-04 19:59:50] [config] transformer-aan-depth: 2
[2023-07-04 19:59:50] [config] transformer-aan-nogate: false
[2023-07-04 19:59:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:59:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:59:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:59:50] [config] transformer-depth-scaling: false
[2023-07-04 19:59:50] [config] transformer-dim-aan: 2048
[2023-07-04 19:59:50] [config] transformer-dim-ffn: 2048
[2023-07-04 19:59:50] [config] transformer-dropout: 0
[2023-07-04 19:59:50] [config] transformer-dropout-attention: 0
[2023-07-04 19:59:50] [config] transformer-dropout-ffn: 0
[2023-07-04 19:59:50] [config] transformer-ffn-activation: swish
[2023-07-04 19:59:50] [config] transformer-ffn-depth: 2
[2023-07-04 19:59:50] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:59:50] [config] transformer-heads: 8
[2023-07-04 19:59:50] [config] transformer-no-projection: false
[2023-07-04 19:59:50] [config] transformer-pool: false
[2023-07-04 19:59:50] [config] transformer-postprocess: dan
[2023-07-04 19:59:50] [config] transformer-postprocess-emb: d
[2023-07-04 19:59:50] [config] transformer-postprocess-top: ""
[2023-07-04 19:59:50] [config] transformer-preprocess: ""
[2023-07-04 19:59:50] [config] transformer-tied-layers:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] transformer-train-position-embeddings: false
[2023-07-04 19:59:50] [config] tsv: false
[2023-07-04 19:59:50] [config] tsv-fields: 0
[2023-07-04 19:59:50] [config] type: s2s
[2023-07-04 19:59:50] [config] ulr: false
[2023-07-04 19:59:50] [config] ulr-dim-emb: 0
[2023-07-04 19:59:50] [config] ulr-dropout: 0
[2023-07-04 19:59:50] [config] ulr-keys-vectors: ""
[2023-07-04 19:59:50] [config] ulr-query-vectors: ""
[2023-07-04 19:59:50] [config] ulr-softmax-temperature: 1
[2023-07-04 19:59:50] [config] ulr-trainable-transformation: false
[2023-07-04 19:59:50] [config] unlikelihood-loss: false
[2023-07-04 19:59:50] [config] valid-freq: 50000000
[2023-07-04 19:59:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:59:50] [config] valid-max-length: 1000
[2023-07-04 19:59:50] [config] valid-metrics:
[2023-07-04 19:59:50] [config]   - cross-entropy
[2023-07-04 19:59:50] [config]   - translation
[2023-07-04 19:59:50] [config] valid-mini-batch: 32
[2023-07-04 19:59:50] [config] valid-reset-stalled: false
[2023-07-04 19:59:50] [config] valid-script-args:
[2023-07-04 19:59:50] [config]   []
[2023-07-04 19:59:50] [config] valid-script-path: ""
[2023-07-04 19:59:50] [config] valid-sets:
[2023-07-04 19:59:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:59:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:59:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:59:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:50] [config] vocabs:
[2023-07-04 19:59:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:50] [config] word-penalty: 0
[2023-07-04 19:59:50] [config] word-scores: false
[2023-07-04 19:59:50] [config] workspace: 2048
[2023-07-04 19:59:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:50] [training] Using single-device training
[2023-07-04 19:59:51] Synced seed 1234
[2023-07-04 19:59:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:51] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:59:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:51] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:59:51] [valid] No post-processing script given for validating translator
[2023-07-04 19:59:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:52] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 19:59:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 19:59:52] [comm] Using global sharding
[2023-07-04 19:59:52] [comm] NCCLCommunicators constructed successfully
[2023-07-04 19:59:52] [training] Using 1 GPUs
[2023-07-04 19:59:52] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:53] Loading Adam parameters
[2023-07-04 19:59:54] [memory] Reserving 754 MB, device gpu0
[2023-07-04 19:59:54] [memory] Reserving 377 MB, device gpu0
[2023-07-04 19:59:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 19:59:54] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 19:59:54] [data] Shuffling data
[2023-07-04 19:59:54] [data] Done reading 20,192 sentences
[2023-07-04 19:59:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 19:59:54] Training started
[2023-07-04 19:59:54] Training finished
[2023-07-04 19:59:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:58] [marian] Running on node07.datos.cluster.uy as process 14636 with command line:
[2023-07-04 19:59:58] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 19:59:58] [config] after: 0e
[2023-07-04 19:59:58] [config] after-batches: 0
[2023-07-04 19:59:58] [config] after-epochs: 180
[2023-07-04 19:59:58] [config] all-caps-every: 0
[2023-07-04 19:59:58] [config] allow-unk: false
[2023-07-04 19:59:58] [config] authors: false
[2023-07-04 19:59:58] [config] beam-size: 12
[2023-07-04 19:59:58] [config] bert-class-symbol: "[CLS]"
[2023-07-04 19:59:58] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 19:59:58] [config] bert-masking-fraction: 0.15
[2023-07-04 19:59:58] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 19:59:58] [config] bert-train-type-embeddings: true
[2023-07-04 19:59:58] [config] bert-type-vocab-size: 2
[2023-07-04 19:59:58] [config] build-info: ""
[2023-07-04 19:59:58] [config] check-gradient-nan: false
[2023-07-04 19:59:58] [config] check-nan: false
[2023-07-04 19:59:58] [config] cite: false
[2023-07-04 19:59:58] [config] clip-norm: 1
[2023-07-04 19:59:58] [config] cost-scaling:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] cost-type: ce-sum
[2023-07-04 19:59:58] [config] cpu-threads: 0
[2023-07-04 19:59:58] [config] data-threads: 8
[2023-07-04 19:59:58] [config] data-weighting: ""
[2023-07-04 19:59:58] [config] data-weighting-type: sentence
[2023-07-04 19:59:58] [config] dec-cell: gru
[2023-07-04 19:59:58] [config] dec-cell-base-depth: 2
[2023-07-04 19:59:58] [config] dec-cell-high-depth: 1
[2023-07-04 19:59:58] [config] dec-depth: 1
[2023-07-04 19:59:58] [config] devices:
[2023-07-04 19:59:58] [config]   - 0
[2023-07-04 19:59:58] [config] dim-emb: 512
[2023-07-04 19:59:58] [config] dim-rnn: 1024
[2023-07-04 19:59:58] [config] dim-vocabs:
[2023-07-04 19:59:58] [config]   - 54042
[2023-07-04 19:59:58] [config]   - 36507
[2023-07-04 19:59:58] [config] disp-first: 0
[2023-07-04 19:59:58] [config] disp-freq: 1000u
[2023-07-04 19:59:58] [config] disp-label-counts: true
[2023-07-04 19:59:58] [config] dropout-rnn: 0
[2023-07-04 19:59:58] [config] dropout-src: 0
[2023-07-04 19:59:58] [config] dropout-trg: 0
[2023-07-04 19:59:58] [config] dump-config: ""
[2023-07-04 19:59:58] [config] dynamic-gradient-scaling:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] early-stopping: 10
[2023-07-04 19:59:58] [config] early-stopping-on: first
[2023-07-04 19:59:58] [config] embedding-fix-src: false
[2023-07-04 19:59:58] [config] embedding-fix-trg: false
[2023-07-04 19:59:58] [config] embedding-normalization: false
[2023-07-04 19:59:58] [config] embedding-vectors:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] enc-cell: gru
[2023-07-04 19:59:58] [config] enc-cell-depth: 1
[2023-07-04 19:59:58] [config] enc-depth: 1
[2023-07-04 19:59:58] [config] enc-type: bidirectional
[2023-07-04 19:59:58] [config] english-title-case-every: 0
[2023-07-04 19:59:58] [config] exponential-smoothing: 0
[2023-07-04 19:59:58] [config] factor-weight: 1
[2023-07-04 19:59:58] [config] factors-combine: sum
[2023-07-04 19:59:58] [config] factors-dim-emb: 0
[2023-07-04 19:59:58] [config] gradient-checkpointing: false
[2023-07-04 19:59:58] [config] gradient-norm-average-window: 100
[2023-07-04 19:59:58] [config] guided-alignment: none
[2023-07-04 19:59:58] [config] guided-alignment-cost: mse
[2023-07-04 19:59:58] [config] guided-alignment-weight: 0.1
[2023-07-04 19:59:58] [config] ignore-model-config: false
[2023-07-04 19:59:58] [config] input-types:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] interpolate-env-vars: false
[2023-07-04 19:59:58] [config] keep-best: false
[2023-07-04 19:59:58] [config] label-smoothing: 0
[2023-07-04 19:59:58] [config] layer-normalization: false
[2023-07-04 19:59:58] [config] learn-rate: 0.0001
[2023-07-04 19:59:58] [config] lemma-dependency: ""
[2023-07-04 19:59:58] [config] lemma-dim-emb: 0
[2023-07-04 19:59:58] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 19:59:58] [config] log-level: info
[2023-07-04 19:59:58] [config] log-time-zone: ""
[2023-07-04 19:59:58] [config] logical-epoch:
[2023-07-04 19:59:58] [config]   - 1e
[2023-07-04 19:59:58] [config]   - 0
[2023-07-04 19:59:58] [config] lr-decay: 0
[2023-07-04 19:59:58] [config] lr-decay-freq: 50000
[2023-07-04 19:59:58] [config] lr-decay-inv-sqrt:
[2023-07-04 19:59:58] [config]   - 0
[2023-07-04 19:59:58] [config] lr-decay-repeat-warmup: false
[2023-07-04 19:59:58] [config] lr-decay-reset-optimizer: false
[2023-07-04 19:59:58] [config] lr-decay-start:
[2023-07-04 19:59:58] [config]   - 10
[2023-07-04 19:59:58] [config]   - 1
[2023-07-04 19:59:58] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 19:59:58] [config] lr-report: false
[2023-07-04 19:59:58] [config] lr-warmup: 0
[2023-07-04 19:59:58] [config] lr-warmup-at-reload: false
[2023-07-04 19:59:58] [config] lr-warmup-cycle: false
[2023-07-04 19:59:58] [config] lr-warmup-start-rate: 0
[2023-07-04 19:59:58] [config] max-length: 50
[2023-07-04 19:59:58] [config] max-length-crop: false
[2023-07-04 19:59:58] [config] max-length-factor: 3
[2023-07-04 19:59:58] [config] maxi-batch: 100
[2023-07-04 19:59:58] [config] maxi-batch-sort: trg
[2023-07-04 19:59:58] [config] mini-batch: 64
[2023-07-04 19:59:58] [config] mini-batch-fit: false
[2023-07-04 19:59:58] [config] mini-batch-fit-step: 10
[2023-07-04 19:59:58] [config] mini-batch-round-up: true
[2023-07-04 19:59:58] [config] mini-batch-track-lr: false
[2023-07-04 19:59:58] [config] mini-batch-warmup: 0
[2023-07-04 19:59:58] [config] mini-batch-words: 0
[2023-07-04 19:59:58] [config] mini-batch-words-ref: 0
[2023-07-04 19:59:58] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 19:59:58] [config] multi-loss-type: sum
[2023-07-04 19:59:58] [config] n-best: false
[2023-07-04 19:59:58] [config] no-nccl: false
[2023-07-04 19:59:58] [config] no-reload: false
[2023-07-04 19:59:58] [config] no-restore-corpus: false
[2023-07-04 19:59:58] [config] normalize: 0
[2023-07-04 19:59:58] [config] normalize-gradient: false
[2023-07-04 19:59:58] [config] num-devices: 0
[2023-07-04 19:59:58] [config] optimizer: adam
[2023-07-04 19:59:58] [config] optimizer-delay: 1
[2023-07-04 19:59:58] [config] optimizer-params:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] output-omit-bias: false
[2023-07-04 19:59:58] [config] overwrite: true
[2023-07-04 19:59:58] [config] precision:
[2023-07-04 19:59:58] [config]   - float32
[2023-07-04 19:59:58] [config]   - float32
[2023-07-04 19:59:58] [config] pretrained-model: ""
[2023-07-04 19:59:58] [config] quantize-biases: false
[2023-07-04 19:59:58] [config] quantize-bits: 0
[2023-07-04 19:59:58] [config] quantize-log-based: false
[2023-07-04 19:59:58] [config] quantize-optimization-steps: 0
[2023-07-04 19:59:58] [config] quiet: false
[2023-07-04 19:59:58] [config] quiet-translation: true
[2023-07-04 19:59:58] [config] relative-paths: false
[2023-07-04 19:59:58] [config] right-left: false
[2023-07-04 19:59:58] [config] save-freq: 10000u
[2023-07-04 19:59:58] [config] seed: 1234
[2023-07-04 19:59:58] [config] sentencepiece-alphas:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] sentencepiece-max-lines: 2000000
[2023-07-04 19:59:58] [config] sentencepiece-options: ""
[2023-07-04 19:59:58] [config] sharding: global
[2023-07-04 19:59:58] [config] shuffle: data
[2023-07-04 19:59:58] [config] shuffle-in-ram: false
[2023-07-04 19:59:58] [config] sigterm: save-and-exit
[2023-07-04 19:59:58] [config] skip: false
[2023-07-04 19:59:58] [config] sqlite: ""
[2023-07-04 19:59:58] [config] sqlite-drop: false
[2023-07-04 19:59:58] [config] sync-freq: 200u
[2023-07-04 19:59:58] [config] sync-sgd: false
[2023-07-04 19:59:58] [config] tempdir: /tmp
[2023-07-04 19:59:58] [config] tied-embeddings: false
[2023-07-04 19:59:58] [config] tied-embeddings-all: false
[2023-07-04 19:59:58] [config] tied-embeddings-src: false
[2023-07-04 19:59:58] [config] train-embedder-rank:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] train-sets:
[2023-07-04 19:59:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 19:59:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 19:59:58] [config] transformer-aan-activation: swish
[2023-07-04 19:59:58] [config] transformer-aan-depth: 2
[2023-07-04 19:59:58] [config] transformer-aan-nogate: false
[2023-07-04 19:59:58] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 19:59:58] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 19:59:58] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 19:59:58] [config] transformer-depth-scaling: false
[2023-07-04 19:59:58] [config] transformer-dim-aan: 2048
[2023-07-04 19:59:58] [config] transformer-dim-ffn: 2048
[2023-07-04 19:59:58] [config] transformer-dropout: 0
[2023-07-04 19:59:58] [config] transformer-dropout-attention: 0
[2023-07-04 19:59:58] [config] transformer-dropout-ffn: 0
[2023-07-04 19:59:58] [config] transformer-ffn-activation: swish
[2023-07-04 19:59:58] [config] transformer-ffn-depth: 2
[2023-07-04 19:59:58] [config] transformer-guided-alignment-layer: last
[2023-07-04 19:59:58] [config] transformer-heads: 8
[2023-07-04 19:59:58] [config] transformer-no-projection: false
[2023-07-04 19:59:58] [config] transformer-pool: false
[2023-07-04 19:59:58] [config] transformer-postprocess: dan
[2023-07-04 19:59:58] [config] transformer-postprocess-emb: d
[2023-07-04 19:59:58] [config] transformer-postprocess-top: ""
[2023-07-04 19:59:58] [config] transformer-preprocess: ""
[2023-07-04 19:59:58] [config] transformer-tied-layers:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] transformer-train-position-embeddings: false
[2023-07-04 19:59:58] [config] tsv: false
[2023-07-04 19:59:58] [config] tsv-fields: 0
[2023-07-04 19:59:58] [config] type: s2s
[2023-07-04 19:59:58] [config] ulr: false
[2023-07-04 19:59:58] [config] ulr-dim-emb: 0
[2023-07-04 19:59:58] [config] ulr-dropout: 0
[2023-07-04 19:59:58] [config] ulr-keys-vectors: ""
[2023-07-04 19:59:58] [config] ulr-query-vectors: ""
[2023-07-04 19:59:58] [config] ulr-softmax-temperature: 1
[2023-07-04 19:59:58] [config] ulr-trainable-transformation: false
[2023-07-04 19:59:58] [config] unlikelihood-loss: false
[2023-07-04 19:59:58] [config] valid-freq: 50000000
[2023-07-04 19:59:58] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 19:59:58] [config] valid-max-length: 1000
[2023-07-04 19:59:58] [config] valid-metrics:
[2023-07-04 19:59:58] [config]   - cross-entropy
[2023-07-04 19:59:58] [config]   - translation
[2023-07-04 19:59:58] [config] valid-mini-batch: 32
[2023-07-04 19:59:58] [config] valid-reset-stalled: false
[2023-07-04 19:59:58] [config] valid-script-args:
[2023-07-04 19:59:58] [config]   []
[2023-07-04 19:59:58] [config] valid-script-path: ""
[2023-07-04 19:59:58] [config] valid-sets:
[2023-07-04 19:59:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 19:59:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 19:59:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 19:59:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:58] [config] vocabs:
[2023-07-04 19:59:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:58] [config] word-penalty: 0
[2023-07-04 19:59:58] [config] word-scores: false
[2023-07-04 19:59:58] [config] workspace: 2048
[2023-07-04 19:59:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 19:59:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 19:59:58] [training] Using single-device training
[2023-07-04 19:59:59] Synced seed 1234
[2023-07-04 19:59:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 19:59:59] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 19:59:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 19:59:59] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 19:59:59] [valid] No post-processing script given for validating translator
[2023-07-04 19:59:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:00:00] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:00:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:00:00] [comm] Using global sharding
[2023-07-04 20:00:00] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:00:00] [training] Using 1 GPUs
[2023-07-04 20:00:00] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 20:00:01] Loading Adam parameters
[2023-07-04 20:00:02] [memory] Reserving 754 MB, device gpu0
[2023-07-04 20:00:02] [memory] Reserving 377 MB, device gpu0
[2023-07-04 20:00:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 20:00:02] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 20:00:02] [data] Shuffling data
[2023-07-04 20:00:02] [data] Done reading 20,192 sentences
[2023-07-04 20:00:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:00:02] Training started
[2023-07-04 20:00:02] Training finished
[2023-07-04 20:00:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:06] [marian] Running on node07.datos.cluster.uy as process 14685 with command line:
[2023-07-04 20:00:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 20:00:06] [config] after: 0e
[2023-07-04 20:00:06] [config] after-batches: 0
[2023-07-04 20:00:06] [config] after-epochs: 190
[2023-07-04 20:00:06] [config] all-caps-every: 0
[2023-07-04 20:00:06] [config] allow-unk: false
[2023-07-04 20:00:06] [config] authors: false
[2023-07-04 20:00:06] [config] beam-size: 12
[2023-07-04 20:00:06] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:00:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:00:06] [config] bert-masking-fraction: 0.15
[2023-07-04 20:00:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:00:06] [config] bert-train-type-embeddings: true
[2023-07-04 20:00:06] [config] bert-type-vocab-size: 2
[2023-07-04 20:00:06] [config] build-info: ""
[2023-07-04 20:00:06] [config] check-gradient-nan: false
[2023-07-04 20:00:06] [config] check-nan: false
[2023-07-04 20:00:06] [config] cite: false
[2023-07-04 20:00:06] [config] clip-norm: 1
[2023-07-04 20:00:06] [config] cost-scaling:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] cost-type: ce-sum
[2023-07-04 20:00:06] [config] cpu-threads: 0
[2023-07-04 20:00:06] [config] data-threads: 8
[2023-07-04 20:00:06] [config] data-weighting: ""
[2023-07-04 20:00:06] [config] data-weighting-type: sentence
[2023-07-04 20:00:06] [config] dec-cell: gru
[2023-07-04 20:00:06] [config] dec-cell-base-depth: 2
[2023-07-04 20:00:06] [config] dec-cell-high-depth: 1
[2023-07-04 20:00:06] [config] dec-depth: 1
[2023-07-04 20:00:06] [config] devices:
[2023-07-04 20:00:06] [config]   - 0
[2023-07-04 20:00:06] [config] dim-emb: 512
[2023-07-04 20:00:06] [config] dim-rnn: 1024
[2023-07-04 20:00:06] [config] dim-vocabs:
[2023-07-04 20:00:06] [config]   - 54042
[2023-07-04 20:00:06] [config]   - 36507
[2023-07-04 20:00:06] [config] disp-first: 0
[2023-07-04 20:00:06] [config] disp-freq: 1000u
[2023-07-04 20:00:06] [config] disp-label-counts: true
[2023-07-04 20:00:06] [config] dropout-rnn: 0
[2023-07-04 20:00:06] [config] dropout-src: 0
[2023-07-04 20:00:06] [config] dropout-trg: 0
[2023-07-04 20:00:06] [config] dump-config: ""
[2023-07-04 20:00:06] [config] dynamic-gradient-scaling:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] early-stopping: 10
[2023-07-04 20:00:06] [config] early-stopping-on: first
[2023-07-04 20:00:06] [config] embedding-fix-src: false
[2023-07-04 20:00:06] [config] embedding-fix-trg: false
[2023-07-04 20:00:06] [config] embedding-normalization: false
[2023-07-04 20:00:06] [config] embedding-vectors:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] enc-cell: gru
[2023-07-04 20:00:06] [config] enc-cell-depth: 1
[2023-07-04 20:00:06] [config] enc-depth: 1
[2023-07-04 20:00:06] [config] enc-type: bidirectional
[2023-07-04 20:00:06] [config] english-title-case-every: 0
[2023-07-04 20:00:06] [config] exponential-smoothing: 0
[2023-07-04 20:00:06] [config] factor-weight: 1
[2023-07-04 20:00:06] [config] factors-combine: sum
[2023-07-04 20:00:06] [config] factors-dim-emb: 0
[2023-07-04 20:00:06] [config] gradient-checkpointing: false
[2023-07-04 20:00:06] [config] gradient-norm-average-window: 100
[2023-07-04 20:00:06] [config] guided-alignment: none
[2023-07-04 20:00:06] [config] guided-alignment-cost: mse
[2023-07-04 20:00:06] [config] guided-alignment-weight: 0.1
[2023-07-04 20:00:06] [config] ignore-model-config: false
[2023-07-04 20:00:06] [config] input-types:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] interpolate-env-vars: false
[2023-07-04 20:00:06] [config] keep-best: false
[2023-07-04 20:00:06] [config] label-smoothing: 0
[2023-07-04 20:00:06] [config] layer-normalization: false
[2023-07-04 20:00:06] [config] learn-rate: 0.0001
[2023-07-04 20:00:06] [config] lemma-dependency: ""
[2023-07-04 20:00:06] [config] lemma-dim-emb: 0
[2023-07-04 20:00:06] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:00:06] [config] log-level: info
[2023-07-04 20:00:06] [config] log-time-zone: ""
[2023-07-04 20:00:06] [config] logical-epoch:
[2023-07-04 20:00:06] [config]   - 1e
[2023-07-04 20:00:06] [config]   - 0
[2023-07-04 20:00:06] [config] lr-decay: 0
[2023-07-04 20:00:06] [config] lr-decay-freq: 50000
[2023-07-04 20:00:06] [config] lr-decay-inv-sqrt:
[2023-07-04 20:00:06] [config]   - 0
[2023-07-04 20:00:06] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:00:06] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:00:06] [config] lr-decay-start:
[2023-07-04 20:00:06] [config]   - 10
[2023-07-04 20:00:06] [config]   - 1
[2023-07-04 20:00:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:00:06] [config] lr-report: false
[2023-07-04 20:00:06] [config] lr-warmup: 0
[2023-07-04 20:00:06] [config] lr-warmup-at-reload: false
[2023-07-04 20:00:06] [config] lr-warmup-cycle: false
[2023-07-04 20:00:06] [config] lr-warmup-start-rate: 0
[2023-07-04 20:00:06] [config] max-length: 50
[2023-07-04 20:00:06] [config] max-length-crop: false
[2023-07-04 20:00:06] [config] max-length-factor: 3
[2023-07-04 20:00:06] [config] maxi-batch: 100
[2023-07-04 20:00:06] [config] maxi-batch-sort: trg
[2023-07-04 20:00:06] [config] mini-batch: 64
[2023-07-04 20:00:06] [config] mini-batch-fit: false
[2023-07-04 20:00:06] [config] mini-batch-fit-step: 10
[2023-07-04 20:00:06] [config] mini-batch-round-up: true
[2023-07-04 20:00:06] [config] mini-batch-track-lr: false
[2023-07-04 20:00:06] [config] mini-batch-warmup: 0
[2023-07-04 20:00:06] [config] mini-batch-words: 0
[2023-07-04 20:00:06] [config] mini-batch-words-ref: 0
[2023-07-04 20:00:06] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 20:00:06] [config] multi-loss-type: sum
[2023-07-04 20:00:06] [config] n-best: false
[2023-07-04 20:00:06] [config] no-nccl: false
[2023-07-04 20:00:06] [config] no-reload: false
[2023-07-04 20:00:06] [config] no-restore-corpus: false
[2023-07-04 20:00:06] [config] normalize: 0
[2023-07-04 20:00:06] [config] normalize-gradient: false
[2023-07-04 20:00:06] [config] num-devices: 0
[2023-07-04 20:00:06] [config] optimizer: adam
[2023-07-04 20:00:06] [config] optimizer-delay: 1
[2023-07-04 20:00:06] [config] optimizer-params:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] output-omit-bias: false
[2023-07-04 20:00:06] [config] overwrite: true
[2023-07-04 20:00:06] [config] precision:
[2023-07-04 20:00:06] [config]   - float32
[2023-07-04 20:00:06] [config]   - float32
[2023-07-04 20:00:06] [config] pretrained-model: ""
[2023-07-04 20:00:06] [config] quantize-biases: false
[2023-07-04 20:00:06] [config] quantize-bits: 0
[2023-07-04 20:00:06] [config] quantize-log-based: false
[2023-07-04 20:00:06] [config] quantize-optimization-steps: 0
[2023-07-04 20:00:06] [config] quiet: false
[2023-07-04 20:00:06] [config] quiet-translation: true
[2023-07-04 20:00:06] [config] relative-paths: false
[2023-07-04 20:00:06] [config] right-left: false
[2023-07-04 20:00:06] [config] save-freq: 10000u
[2023-07-04 20:00:06] [config] seed: 1234
[2023-07-04 20:00:06] [config] sentencepiece-alphas:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:00:06] [config] sentencepiece-options: ""
[2023-07-04 20:00:06] [config] sharding: global
[2023-07-04 20:00:06] [config] shuffle: data
[2023-07-04 20:00:06] [config] shuffle-in-ram: false
[2023-07-04 20:00:06] [config] sigterm: save-and-exit
[2023-07-04 20:00:06] [config] skip: false
[2023-07-04 20:00:06] [config] sqlite: ""
[2023-07-04 20:00:06] [config] sqlite-drop: false
[2023-07-04 20:00:06] [config] sync-freq: 200u
[2023-07-04 20:00:06] [config] sync-sgd: false
[2023-07-04 20:00:06] [config] tempdir: /tmp
[2023-07-04 20:00:06] [config] tied-embeddings: false
[2023-07-04 20:00:06] [config] tied-embeddings-all: false
[2023-07-04 20:00:06] [config] tied-embeddings-src: false
[2023-07-04 20:00:06] [config] train-embedder-rank:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] train-sets:
[2023-07-04 20:00:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:00:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:00:06] [config] transformer-aan-activation: swish
[2023-07-04 20:00:06] [config] transformer-aan-depth: 2
[2023-07-04 20:00:06] [config] transformer-aan-nogate: false
[2023-07-04 20:00:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:00:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:00:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:00:06] [config] transformer-depth-scaling: false
[2023-07-04 20:00:06] [config] transformer-dim-aan: 2048
[2023-07-04 20:00:06] [config] transformer-dim-ffn: 2048
[2023-07-04 20:00:06] [config] transformer-dropout: 0
[2023-07-04 20:00:06] [config] transformer-dropout-attention: 0
[2023-07-04 20:00:06] [config] transformer-dropout-ffn: 0
[2023-07-04 20:00:06] [config] transformer-ffn-activation: swish
[2023-07-04 20:00:06] [config] transformer-ffn-depth: 2
[2023-07-04 20:00:06] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:00:06] [config] transformer-heads: 8
[2023-07-04 20:00:06] [config] transformer-no-projection: false
[2023-07-04 20:00:06] [config] transformer-pool: false
[2023-07-04 20:00:06] [config] transformer-postprocess: dan
[2023-07-04 20:00:06] [config] transformer-postprocess-emb: d
[2023-07-04 20:00:06] [config] transformer-postprocess-top: ""
[2023-07-04 20:00:06] [config] transformer-preprocess: ""
[2023-07-04 20:00:06] [config] transformer-tied-layers:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] transformer-train-position-embeddings: false
[2023-07-04 20:00:06] [config] tsv: false
[2023-07-04 20:00:06] [config] tsv-fields: 0
[2023-07-04 20:00:06] [config] type: s2s
[2023-07-04 20:00:06] [config] ulr: false
[2023-07-04 20:00:06] [config] ulr-dim-emb: 0
[2023-07-04 20:00:06] [config] ulr-dropout: 0
[2023-07-04 20:00:06] [config] ulr-keys-vectors: ""
[2023-07-04 20:00:06] [config] ulr-query-vectors: ""
[2023-07-04 20:00:06] [config] ulr-softmax-temperature: 1
[2023-07-04 20:00:06] [config] ulr-trainable-transformation: false
[2023-07-04 20:00:06] [config] unlikelihood-loss: false
[2023-07-04 20:00:06] [config] valid-freq: 50000000
[2023-07-04 20:00:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:00:06] [config] valid-max-length: 1000
[2023-07-04 20:00:06] [config] valid-metrics:
[2023-07-04 20:00:06] [config]   - cross-entropy
[2023-07-04 20:00:06] [config]   - translation
[2023-07-04 20:00:06] [config] valid-mini-batch: 32
[2023-07-04 20:00:06] [config] valid-reset-stalled: false
[2023-07-04 20:00:06] [config] valid-script-args:
[2023-07-04 20:00:06] [config]   []
[2023-07-04 20:00:06] [config] valid-script-path: ""
[2023-07-04 20:00:06] [config] valid-sets:
[2023-07-04 20:00:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:00:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:00:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:00:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:06] [config] vocabs:
[2023-07-04 20:00:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:00:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:00:06] [config] word-penalty: 0
[2023-07-04 20:00:06] [config] word-scores: false
[2023-07-04 20:00:06] [config] workspace: 2048
[2023-07-04 20:00:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:00:06] [training] Using single-device training
[2023-07-04 20:00:06] Synced seed 1234
[2023-07-04 20:00:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:00:06] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:00:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:00:07] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:00:07] [valid] No post-processing script given for validating translator
[2023-07-04 20:00:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:00:07] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:00:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:00:07] [comm] Using global sharding
[2023-07-04 20:00:08] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:00:08] [training] Using 1 GPUs
[2023-07-04 20:00:08] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 20:00:09] Loading Adam parameters
[2023-07-04 20:00:09] [memory] Reserving 754 MB, device gpu0
[2023-07-04 20:00:09] [memory] Reserving 377 MB, device gpu0
[2023-07-04 20:00:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 20:00:10] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 20:00:10] [data] Shuffling data
[2023-07-04 20:00:10] [data] Done reading 20,192 sentences
[2023-07-04 20:00:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:00:10] Training started
[2023-07-04 20:00:10] Training finished
[2023-07-04 20:00:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:14] [marian] Running on node07.datos.cluster.uy as process 14734 with command line:
[2023-07-04 20:00:14] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-04 20:00:14] [config] after: 0e
[2023-07-04 20:00:14] [config] after-batches: 0
[2023-07-04 20:00:14] [config] after-epochs: 200
[2023-07-04 20:00:14] [config] all-caps-every: 0
[2023-07-04 20:00:14] [config] allow-unk: false
[2023-07-04 20:00:14] [config] authors: false
[2023-07-04 20:00:14] [config] beam-size: 12
[2023-07-04 20:00:14] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:00:14] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:00:14] [config] bert-masking-fraction: 0.15
[2023-07-04 20:00:14] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:00:14] [config] bert-train-type-embeddings: true
[2023-07-04 20:00:14] [config] bert-type-vocab-size: 2
[2023-07-04 20:00:14] [config] build-info: ""
[2023-07-04 20:00:14] [config] check-gradient-nan: false
[2023-07-04 20:00:14] [config] check-nan: false
[2023-07-04 20:00:14] [config] cite: false
[2023-07-04 20:00:14] [config] clip-norm: 1
[2023-07-04 20:00:14] [config] cost-scaling:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] cost-type: ce-sum
[2023-07-04 20:00:14] [config] cpu-threads: 0
[2023-07-04 20:00:14] [config] data-threads: 8
[2023-07-04 20:00:14] [config] data-weighting: ""
[2023-07-04 20:00:14] [config] data-weighting-type: sentence
[2023-07-04 20:00:14] [config] dec-cell: gru
[2023-07-04 20:00:14] [config] dec-cell-base-depth: 2
[2023-07-04 20:00:14] [config] dec-cell-high-depth: 1
[2023-07-04 20:00:14] [config] dec-depth: 1
[2023-07-04 20:00:14] [config] devices:
[2023-07-04 20:00:14] [config]   - 0
[2023-07-04 20:00:14] [config] dim-emb: 512
[2023-07-04 20:00:14] [config] dim-rnn: 1024
[2023-07-04 20:00:14] [config] dim-vocabs:
[2023-07-04 20:00:14] [config]   - 54042
[2023-07-04 20:00:14] [config]   - 36507
[2023-07-04 20:00:14] [config] disp-first: 0
[2023-07-04 20:00:14] [config] disp-freq: 1000u
[2023-07-04 20:00:14] [config] disp-label-counts: true
[2023-07-04 20:00:14] [config] dropout-rnn: 0
[2023-07-04 20:00:14] [config] dropout-src: 0
[2023-07-04 20:00:14] [config] dropout-trg: 0
[2023-07-04 20:00:14] [config] dump-config: ""
[2023-07-04 20:00:14] [config] dynamic-gradient-scaling:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] early-stopping: 10
[2023-07-04 20:00:14] [config] early-stopping-on: first
[2023-07-04 20:00:14] [config] embedding-fix-src: false
[2023-07-04 20:00:14] [config] embedding-fix-trg: false
[2023-07-04 20:00:14] [config] embedding-normalization: false
[2023-07-04 20:00:14] [config] embedding-vectors:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] enc-cell: gru
[2023-07-04 20:00:14] [config] enc-cell-depth: 1
[2023-07-04 20:00:14] [config] enc-depth: 1
[2023-07-04 20:00:14] [config] enc-type: bidirectional
[2023-07-04 20:00:14] [config] english-title-case-every: 0
[2023-07-04 20:00:14] [config] exponential-smoothing: 0
[2023-07-04 20:00:14] [config] factor-weight: 1
[2023-07-04 20:00:14] [config] factors-combine: sum
[2023-07-04 20:00:14] [config] factors-dim-emb: 0
[2023-07-04 20:00:14] [config] gradient-checkpointing: false
[2023-07-04 20:00:14] [config] gradient-norm-average-window: 100
[2023-07-04 20:00:14] [config] guided-alignment: none
[2023-07-04 20:00:14] [config] guided-alignment-cost: mse
[2023-07-04 20:00:14] [config] guided-alignment-weight: 0.1
[2023-07-04 20:00:14] [config] ignore-model-config: false
[2023-07-04 20:00:14] [config] input-types:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] interpolate-env-vars: false
[2023-07-04 20:00:14] [config] keep-best: false
[2023-07-04 20:00:14] [config] label-smoothing: 0
[2023-07-04 20:00:14] [config] layer-normalization: false
[2023-07-04 20:00:14] [config] learn-rate: 0.0001
[2023-07-04 20:00:14] [config] lemma-dependency: ""
[2023-07-04 20:00:14] [config] lemma-dim-emb: 0
[2023-07-04 20:00:14] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:00:14] [config] log-level: info
[2023-07-04 20:00:14] [config] log-time-zone: ""
[2023-07-04 20:00:14] [config] logical-epoch:
[2023-07-04 20:00:14] [config]   - 1e
[2023-07-04 20:00:14] [config]   - 0
[2023-07-04 20:00:14] [config] lr-decay: 0
[2023-07-04 20:00:14] [config] lr-decay-freq: 50000
[2023-07-04 20:00:14] [config] lr-decay-inv-sqrt:
[2023-07-04 20:00:14] [config]   - 0
[2023-07-04 20:00:14] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:00:14] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:00:14] [config] lr-decay-start:
[2023-07-04 20:00:14] [config]   - 10
[2023-07-04 20:00:14] [config]   - 1
[2023-07-04 20:00:14] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:00:14] [config] lr-report: false
[2023-07-04 20:00:14] [config] lr-warmup: 0
[2023-07-04 20:00:14] [config] lr-warmup-at-reload: false
[2023-07-04 20:00:14] [config] lr-warmup-cycle: false
[2023-07-04 20:00:14] [config] lr-warmup-start-rate: 0
[2023-07-04 20:00:14] [config] max-length: 50
[2023-07-04 20:00:14] [config] max-length-crop: false
[2023-07-04 20:00:14] [config] max-length-factor: 3
[2023-07-04 20:00:14] [config] maxi-batch: 100
[2023-07-04 20:00:14] [config] maxi-batch-sort: trg
[2023-07-04 20:00:14] [config] mini-batch: 64
[2023-07-04 20:00:14] [config] mini-batch-fit: false
[2023-07-04 20:00:14] [config] mini-batch-fit-step: 10
[2023-07-04 20:00:14] [config] mini-batch-round-up: true
[2023-07-04 20:00:14] [config] mini-batch-track-lr: false
[2023-07-04 20:00:14] [config] mini-batch-warmup: 0
[2023-07-04 20:00:14] [config] mini-batch-words: 0
[2023-07-04 20:00:14] [config] mini-batch-words-ref: 0
[2023-07-04 20:00:14] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 20:00:14] [config] multi-loss-type: sum
[2023-07-04 20:00:14] [config] n-best: false
[2023-07-04 20:00:14] [config] no-nccl: false
[2023-07-04 20:00:14] [config] no-reload: false
[2023-07-04 20:00:14] [config] no-restore-corpus: false
[2023-07-04 20:00:14] [config] normalize: 0
[2023-07-04 20:00:14] [config] normalize-gradient: false
[2023-07-04 20:00:14] [config] num-devices: 0
[2023-07-04 20:00:14] [config] optimizer: adam
[2023-07-04 20:00:14] [config] optimizer-delay: 1
[2023-07-04 20:00:14] [config] optimizer-params:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] output-omit-bias: false
[2023-07-04 20:00:14] [config] overwrite: true
[2023-07-04 20:00:14] [config] precision:
[2023-07-04 20:00:14] [config]   - float32
[2023-07-04 20:00:14] [config]   - float32
[2023-07-04 20:00:14] [config] pretrained-model: ""
[2023-07-04 20:00:14] [config] quantize-biases: false
[2023-07-04 20:00:14] [config] quantize-bits: 0
[2023-07-04 20:00:14] [config] quantize-log-based: false
[2023-07-04 20:00:14] [config] quantize-optimization-steps: 0
[2023-07-04 20:00:14] [config] quiet: false
[2023-07-04 20:00:14] [config] quiet-translation: true
[2023-07-04 20:00:14] [config] relative-paths: false
[2023-07-04 20:00:14] [config] right-left: false
[2023-07-04 20:00:14] [config] save-freq: 10000u
[2023-07-04 20:00:14] [config] seed: 1234
[2023-07-04 20:00:14] [config] sentencepiece-alphas:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:00:14] [config] sentencepiece-options: ""
[2023-07-04 20:00:14] [config] sharding: global
[2023-07-04 20:00:14] [config] shuffle: data
[2023-07-04 20:00:14] [config] shuffle-in-ram: false
[2023-07-04 20:00:14] [config] sigterm: save-and-exit
[2023-07-04 20:00:14] [config] skip: false
[2023-07-04 20:00:14] [config] sqlite: ""
[2023-07-04 20:00:14] [config] sqlite-drop: false
[2023-07-04 20:00:14] [config] sync-freq: 200u
[2023-07-04 20:00:14] [config] sync-sgd: false
[2023-07-04 20:00:14] [config] tempdir: /tmp
[2023-07-04 20:00:14] [config] tied-embeddings: false
[2023-07-04 20:00:14] [config] tied-embeddings-all: false
[2023-07-04 20:00:14] [config] tied-embeddings-src: false
[2023-07-04 20:00:14] [config] train-embedder-rank:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] train-sets:
[2023-07-04 20:00:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:00:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:00:14] [config] transformer-aan-activation: swish
[2023-07-04 20:00:14] [config] transformer-aan-depth: 2
[2023-07-04 20:00:14] [config] transformer-aan-nogate: false
[2023-07-04 20:00:14] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:00:14] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:00:14] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:00:14] [config] transformer-depth-scaling: false
[2023-07-04 20:00:14] [config] transformer-dim-aan: 2048
[2023-07-04 20:00:14] [config] transformer-dim-ffn: 2048
[2023-07-04 20:00:14] [config] transformer-dropout: 0
[2023-07-04 20:00:14] [config] transformer-dropout-attention: 0
[2023-07-04 20:00:14] [config] transformer-dropout-ffn: 0
[2023-07-04 20:00:14] [config] transformer-ffn-activation: swish
[2023-07-04 20:00:14] [config] transformer-ffn-depth: 2
[2023-07-04 20:00:14] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:00:14] [config] transformer-heads: 8
[2023-07-04 20:00:14] [config] transformer-no-projection: false
[2023-07-04 20:00:14] [config] transformer-pool: false
[2023-07-04 20:00:14] [config] transformer-postprocess: dan
[2023-07-04 20:00:14] [config] transformer-postprocess-emb: d
[2023-07-04 20:00:14] [config] transformer-postprocess-top: ""
[2023-07-04 20:00:14] [config] transformer-preprocess: ""
[2023-07-04 20:00:14] [config] transformer-tied-layers:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] transformer-train-position-embeddings: false
[2023-07-04 20:00:14] [config] tsv: false
[2023-07-04 20:00:14] [config] tsv-fields: 0
[2023-07-04 20:00:14] [config] type: s2s
[2023-07-04 20:00:14] [config] ulr: false
[2023-07-04 20:00:14] [config] ulr-dim-emb: 0
[2023-07-04 20:00:14] [config] ulr-dropout: 0
[2023-07-04 20:00:14] [config] ulr-keys-vectors: ""
[2023-07-04 20:00:14] [config] ulr-query-vectors: ""
[2023-07-04 20:00:14] [config] ulr-softmax-temperature: 1
[2023-07-04 20:00:14] [config] ulr-trainable-transformation: false
[2023-07-04 20:00:14] [config] unlikelihood-loss: false
[2023-07-04 20:00:14] [config] valid-freq: 50000000
[2023-07-04 20:00:14] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:00:14] [config] valid-max-length: 1000
[2023-07-04 20:00:14] [config] valid-metrics:
[2023-07-04 20:00:14] [config]   - cross-entropy
[2023-07-04 20:00:14] [config]   - translation
[2023-07-04 20:00:14] [config] valid-mini-batch: 32
[2023-07-04 20:00:14] [config] valid-reset-stalled: false
[2023-07-04 20:00:14] [config] valid-script-args:
[2023-07-04 20:00:14] [config]   []
[2023-07-04 20:00:14] [config] valid-script-path: ""
[2023-07-04 20:00:14] [config] valid-sets:
[2023-07-04 20:00:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:00:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:00:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:00:14] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:14] [config] vocabs:
[2023-07-04 20:00:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:00:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:00:14] [config] word-penalty: 0
[2023-07-04 20:00:14] [config] word-scores: false
[2023-07-04 20:00:14] [config] workspace: 2048
[2023-07-04 20:00:14] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:00:14] [training] Using single-device training
[2023-07-04 20:00:14] Synced seed 1234
[2023-07-04 20:00:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:00:14] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:00:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:00:14] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:00:14] [valid] No post-processing script given for validating translator
[2023-07-04 20:00:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:00:15] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:00:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:00:15] [comm] Using global sharding
[2023-07-04 20:00:15] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:00:15] [training] Using 1 GPUs
[2023-07-04 20:00:15] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz
[2023-07-04 20:00:17] Loading Adam parameters
[2023-07-04 20:00:17] [memory] Reserving 754 MB, device gpu0
[2023-07-04 20:00:17] [memory] Reserving 377 MB, device gpu0
[2023-07-04 20:00:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-04 20:00:17] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 20:00:17] [data] Shuffling data
[2023-07-04 20:00:17] [data] Done reading 20,192 sentences
[2023-07-04 20:00:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:00:17] Training started
[2023-07-04 20:00:17] Training finished
[2023-07-04 20:00:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:23] [marian] Running on node07.datos.cluster.uy as process 14784 with command line:
[2023-07-04 20:00:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:00:23] [config] after: 0e
[2023-07-04 20:00:23] [config] after-batches: 0
[2023-07-04 20:00:23] [config] after-epochs: 10
[2023-07-04 20:00:23] [config] all-caps-every: 0
[2023-07-04 20:00:23] [config] allow-unk: false
[2023-07-04 20:00:23] [config] authors: false
[2023-07-04 20:00:23] [config] beam-size: 12
[2023-07-04 20:00:23] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:00:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:00:23] [config] bert-masking-fraction: 0.15
[2023-07-04 20:00:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:00:23] [config] bert-train-type-embeddings: true
[2023-07-04 20:00:23] [config] bert-type-vocab-size: 2
[2023-07-04 20:00:23] [config] build-info: ""
[2023-07-04 20:00:23] [config] check-gradient-nan: false
[2023-07-04 20:00:23] [config] check-nan: false
[2023-07-04 20:00:23] [config] cite: false
[2023-07-04 20:00:23] [config] clip-norm: 1
[2023-07-04 20:00:23] [config] cost-scaling:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] cost-type: ce-sum
[2023-07-04 20:00:23] [config] cpu-threads: 0
[2023-07-04 20:00:23] [config] data-threads: 8
[2023-07-04 20:00:23] [config] data-weighting: ""
[2023-07-04 20:00:23] [config] data-weighting-type: sentence
[2023-07-04 20:00:23] [config] dec-cell: gru
[2023-07-04 20:00:23] [config] dec-cell-base-depth: 2
[2023-07-04 20:00:23] [config] dec-cell-high-depth: 1
[2023-07-04 20:00:23] [config] dec-depth: 1
[2023-07-04 20:00:23] [config] devices:
[2023-07-04 20:00:23] [config]   - 0
[2023-07-04 20:00:23] [config] dim-emb: 512
[2023-07-04 20:00:23] [config] dim-rnn: 1024
[2023-07-04 20:00:23] [config] dim-vocabs:
[2023-07-04 20:00:23] [config]   - 0
[2023-07-04 20:00:23] [config]   - 0
[2023-07-04 20:00:23] [config] disp-first: 0
[2023-07-04 20:00:23] [config] disp-freq: 1000u
[2023-07-04 20:00:23] [config] disp-label-counts: true
[2023-07-04 20:00:23] [config] dropout-rnn: 0
[2023-07-04 20:00:23] [config] dropout-src: 0
[2023-07-04 20:00:23] [config] dropout-trg: 0
[2023-07-04 20:00:23] [config] dump-config: ""
[2023-07-04 20:00:23] [config] dynamic-gradient-scaling:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] early-stopping: 10
[2023-07-04 20:00:23] [config] early-stopping-on: first
[2023-07-04 20:00:23] [config] embedding-fix-src: false
[2023-07-04 20:00:23] [config] embedding-fix-trg: false
[2023-07-04 20:00:23] [config] embedding-normalization: false
[2023-07-04 20:00:23] [config] embedding-vectors:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] enc-cell: gru
[2023-07-04 20:00:23] [config] enc-cell-depth: 1
[2023-07-04 20:00:23] [config] enc-depth: 1
[2023-07-04 20:00:23] [config] enc-type: bidirectional
[2023-07-04 20:00:23] [config] english-title-case-every: 0
[2023-07-04 20:00:23] [config] exponential-smoothing: 0
[2023-07-04 20:00:23] [config] factor-weight: 1
[2023-07-04 20:00:23] [config] factors-combine: sum
[2023-07-04 20:00:23] [config] factors-dim-emb: 0
[2023-07-04 20:00:23] [config] gradient-checkpointing: false
[2023-07-04 20:00:23] [config] gradient-norm-average-window: 100
[2023-07-04 20:00:23] [config] guided-alignment: none
[2023-07-04 20:00:23] [config] guided-alignment-cost: mse
[2023-07-04 20:00:23] [config] guided-alignment-weight: 0.1
[2023-07-04 20:00:23] [config] ignore-model-config: false
[2023-07-04 20:00:23] [config] input-types:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] interpolate-env-vars: false
[2023-07-04 20:00:23] [config] keep-best: false
[2023-07-04 20:00:23] [config] label-smoothing: 0
[2023-07-04 20:00:23] [config] layer-normalization: false
[2023-07-04 20:00:23] [config] learn-rate: 0.0001
[2023-07-04 20:00:23] [config] lemma-dependency: ""
[2023-07-04 20:00:23] [config] lemma-dim-emb: 0
[2023-07-04 20:00:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:00:23] [config] log-level: info
[2023-07-04 20:00:23] [config] log-time-zone: ""
[2023-07-04 20:00:23] [config] logical-epoch:
[2023-07-04 20:00:23] [config]   - 1e
[2023-07-04 20:00:23] [config]   - 0
[2023-07-04 20:00:23] [config] lr-decay: 0
[2023-07-04 20:00:23] [config] lr-decay-freq: 50000
[2023-07-04 20:00:23] [config] lr-decay-inv-sqrt:
[2023-07-04 20:00:23] [config]   - 0
[2023-07-04 20:00:23] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:00:23] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:00:23] [config] lr-decay-start:
[2023-07-04 20:00:23] [config]   - 10
[2023-07-04 20:00:23] [config]   - 1
[2023-07-04 20:00:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:00:23] [config] lr-report: false
[2023-07-04 20:00:23] [config] lr-warmup: 0
[2023-07-04 20:00:23] [config] lr-warmup-at-reload: false
[2023-07-04 20:00:23] [config] lr-warmup-cycle: false
[2023-07-04 20:00:23] [config] lr-warmup-start-rate: 0
[2023-07-04 20:00:23] [config] max-length: 50
[2023-07-04 20:00:23] [config] max-length-crop: false
[2023-07-04 20:00:23] [config] max-length-factor: 3
[2023-07-04 20:00:23] [config] maxi-batch: 100
[2023-07-04 20:00:23] [config] maxi-batch-sort: trg
[2023-07-04 20:00:23] [config] mini-batch: 64
[2023-07-04 20:00:23] [config] mini-batch-fit: false
[2023-07-04 20:00:23] [config] mini-batch-fit-step: 10
[2023-07-04 20:00:23] [config] mini-batch-round-up: true
[2023-07-04 20:00:23] [config] mini-batch-track-lr: false
[2023-07-04 20:00:23] [config] mini-batch-warmup: 0
[2023-07-04 20:00:23] [config] mini-batch-words: 0
[2023-07-04 20:00:23] [config] mini-batch-words-ref: 0
[2023-07-04 20:00:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:00:23] [config] multi-loss-type: sum
[2023-07-04 20:00:23] [config] n-best: false
[2023-07-04 20:00:23] [config] no-nccl: false
[2023-07-04 20:00:23] [config] no-reload: false
[2023-07-04 20:00:23] [config] no-restore-corpus: false
[2023-07-04 20:00:23] [config] normalize: 0
[2023-07-04 20:00:23] [config] normalize-gradient: false
[2023-07-04 20:00:23] [config] num-devices: 0
[2023-07-04 20:00:23] [config] optimizer: adam
[2023-07-04 20:00:23] [config] optimizer-delay: 1
[2023-07-04 20:00:23] [config] optimizer-params:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] output-omit-bias: false
[2023-07-04 20:00:23] [config] overwrite: true
[2023-07-04 20:00:23] [config] precision:
[2023-07-04 20:00:23] [config]   - float32
[2023-07-04 20:00:23] [config]   - float32
[2023-07-04 20:00:23] [config] pretrained-model: ""
[2023-07-04 20:00:23] [config] quantize-biases: false
[2023-07-04 20:00:23] [config] quantize-bits: 0
[2023-07-04 20:00:23] [config] quantize-log-based: false
[2023-07-04 20:00:23] [config] quantize-optimization-steps: 0
[2023-07-04 20:00:23] [config] quiet: false
[2023-07-04 20:00:23] [config] quiet-translation: true
[2023-07-04 20:00:23] [config] relative-paths: false
[2023-07-04 20:00:23] [config] right-left: false
[2023-07-04 20:00:23] [config] save-freq: 10000u
[2023-07-04 20:00:23] [config] seed: 1234
[2023-07-04 20:00:23] [config] sentencepiece-alphas:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:00:23] [config] sentencepiece-options: ""
[2023-07-04 20:00:23] [config] sharding: global
[2023-07-04 20:00:23] [config] shuffle: data
[2023-07-04 20:00:23] [config] shuffle-in-ram: false
[2023-07-04 20:00:23] [config] sigterm: save-and-exit
[2023-07-04 20:00:23] [config] skip: false
[2023-07-04 20:00:23] [config] sqlite: ""
[2023-07-04 20:00:23] [config] sqlite-drop: false
[2023-07-04 20:00:23] [config] sync-freq: 200u
[2023-07-04 20:00:23] [config] sync-sgd: false
[2023-07-04 20:00:23] [config] tempdir: /tmp
[2023-07-04 20:00:23] [config] tied-embeddings: false
[2023-07-04 20:00:23] [config] tied-embeddings-all: false
[2023-07-04 20:00:23] [config] tied-embeddings-src: false
[2023-07-04 20:00:23] [config] train-embedder-rank:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] train-sets:
[2023-07-04 20:00:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:00:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:00:23] [config] transformer-aan-activation: swish
[2023-07-04 20:00:23] [config] transformer-aan-depth: 2
[2023-07-04 20:00:23] [config] transformer-aan-nogate: false
[2023-07-04 20:00:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:00:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:00:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:00:23] [config] transformer-depth-scaling: false
[2023-07-04 20:00:23] [config] transformer-dim-aan: 2048
[2023-07-04 20:00:23] [config] transformer-dim-ffn: 2048
[2023-07-04 20:00:23] [config] transformer-dropout: 0
[2023-07-04 20:00:23] [config] transformer-dropout-attention: 0
[2023-07-04 20:00:23] [config] transformer-dropout-ffn: 0
[2023-07-04 20:00:23] [config] transformer-ffn-activation: swish
[2023-07-04 20:00:23] [config] transformer-ffn-depth: 2
[2023-07-04 20:00:23] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:00:23] [config] transformer-heads: 8
[2023-07-04 20:00:23] [config] transformer-no-projection: false
[2023-07-04 20:00:23] [config] transformer-pool: false
[2023-07-04 20:00:23] [config] transformer-postprocess: dan
[2023-07-04 20:00:23] [config] transformer-postprocess-emb: d
[2023-07-04 20:00:23] [config] transformer-postprocess-top: ""
[2023-07-04 20:00:23] [config] transformer-preprocess: ""
[2023-07-04 20:00:23] [config] transformer-tied-layers:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] transformer-train-position-embeddings: false
[2023-07-04 20:00:23] [config] tsv: false
[2023-07-04 20:00:23] [config] tsv-fields: 0
[2023-07-04 20:00:23] [config] type: transformer
[2023-07-04 20:00:23] [config] ulr: false
[2023-07-04 20:00:23] [config] ulr-dim-emb: 0
[2023-07-04 20:00:23] [config] ulr-dropout: 0
[2023-07-04 20:00:23] [config] ulr-keys-vectors: ""
[2023-07-04 20:00:23] [config] ulr-query-vectors: ""
[2023-07-04 20:00:23] [config] ulr-softmax-temperature: 1
[2023-07-04 20:00:23] [config] ulr-trainable-transformation: false
[2023-07-04 20:00:23] [config] unlikelihood-loss: false
[2023-07-04 20:00:23] [config] valid-freq: 50000000
[2023-07-04 20:00:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:00:23] [config] valid-max-length: 1000
[2023-07-04 20:00:23] [config] valid-metrics:
[2023-07-04 20:00:23] [config]   - cross-entropy
[2023-07-04 20:00:23] [config]   - translation
[2023-07-04 20:00:23] [config] valid-mini-batch: 32
[2023-07-04 20:00:23] [config] valid-reset-stalled: false
[2023-07-04 20:00:23] [config] valid-script-args:
[2023-07-04 20:00:23] [config]   []
[2023-07-04 20:00:23] [config] valid-script-path: ""
[2023-07-04 20:00:23] [config] valid-sets:
[2023-07-04 20:00:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:00:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:00:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:00:23] [config] vocabs:
[2023-07-04 20:00:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:00:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:00:23] [config] word-penalty: 0
[2023-07-04 20:00:23] [config] word-scores: false
[2023-07-04 20:00:23] [config] workspace: 2048
[2023-07-04 20:00:23] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:00:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:00:23] [training] Using single-device training
[2023-07-04 20:00:23] Synced seed 1234
[2023-07-04 20:00:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:00:23] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:00:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:00:23] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:00:23] [valid] No post-processing script given for validating translator
[2023-07-04 20:00:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:00:24] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:00:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:00:24] [comm] Using global sharding
[2023-07-04 20:00:24] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:00:24] [training] Using 1 GPUs
[2023-07-04 20:00:24] Training started
[2023-07-04 20:00:24] [data] Shuffling data
[2023-07-04 20:00:24] [data] Done reading 20,192 sentences
[2023-07-04 20:00:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:00:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:00:24] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:00:24] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:00:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:00:24] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:00:25] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:00:25] Allocating memory for Adam-specific shards
[2023-07-04 20:00:25] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:00:41] Seen 18,843 samples
[2023-07-04 20:00:41] Starting data epoch 2 in logical epoch 2
[2023-07-04 20:00:41] [data] Shuffling data
[2023-07-04 20:00:41] [data] Done reading 20,192 sentences
[2023-07-04 20:00:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:00:58] Seen 18,843 samples
[2023-07-04 20:00:58] Starting data epoch 3 in logical epoch 3
[2023-07-04 20:00:58] [data] Shuffling data
[2023-07-04 20:00:58] [data] Done reading 20,192 sentences
[2023-07-04 20:00:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:01:15] Seen 18,843 samples
[2023-07-04 20:01:15] Starting data epoch 4 in logical epoch 4
[2023-07-04 20:01:15] [data] Shuffling data
[2023-07-04 20:01:15] [data] Done reading 20,192 sentences
[2023-07-04 20:01:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:01:22] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 5.39951372 * 1,343,216 @ 768 after 1,343,216 : Time 59.00s : 22765.75 words/s : gNorm 2.2512
[2023-07-04 20:01:34] Seen 18,843 samples
[2023-07-04 20:01:34] Starting data epoch 5 in logical epoch 5
[2023-07-04 20:01:34] [data] Shuffling data
[2023-07-04 20:01:34] [data] Done reading 20,192 sentences
[2023-07-04 20:01:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:01:57] Seen 18,843 samples
[2023-07-04 20:01:57] Starting data epoch 6 in logical epoch 6
[2023-07-04 20:01:57] [data] Shuffling data
[2023-07-04 20:01:57] [data] Done reading 20,192 sentences
[2023-07-04 20:01:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:02:19] Seen 18,843 samples
[2023-07-04 20:02:19] Starting data epoch 7 in logical epoch 7
[2023-07-04 20:02:19] [data] Shuffling data
[2023-07-04 20:02:19] [data] Done reading 20,192 sentences
[2023-07-04 20:02:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:02:34] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 3.33698606 * 1,334,929 @ 2,976 after 2,678,145 : Time 72.14s : 18504.31 words/s : gNorm 2.7515
[2023-07-04 20:02:40] Seen 18,843 samples
[2023-07-04 20:02:40] Starting data epoch 8 in logical epoch 8
[2023-07-04 20:02:40] [data] Shuffling data
[2023-07-04 20:02:40] [data] Done reading 20,192 sentences
[2023-07-04 20:02:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:03:02] Seen 18,843 samples
[2023-07-04 20:03:02] Starting data epoch 9 in logical epoch 9
[2023-07-04 20:03:02] [data] Shuffling data
[2023-07-04 20:03:02] [data] Done reading 20,192 sentences
[2023-07-04 20:03:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:03:24] Seen 18,843 samples
[2023-07-04 20:03:24] Starting data epoch 10 in logical epoch 10
[2023-07-04 20:03:24] [data] Shuffling data
[2023-07-04 20:03:24] [data] Done reading 20,192 sentences
[2023-07-04 20:03:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:03:48] Seen 18,843 samples
[2023-07-04 20:03:48] Starting data epoch 11 in logical epoch 11
[2023-07-04 20:03:48] Training finished
[2023-07-04 20:03:51] [valid] Ep. 11 : Up. 2968 : cross-entropy : 125.788 : new best
[2023-07-04 20:06:35] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-04 20:06:35] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:06:38] Saving Adam parameters
[2023-07-04 20:06:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:06:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:06:50] [marian] Running on node07.datos.cluster.uy as process 15181 with command line:
[2023-07-04 20:06:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:06:51] [config] after: 0e
[2023-07-04 20:06:51] [config] after-batches: 0
[2023-07-04 20:06:51] [config] after-epochs: 20
[2023-07-04 20:06:51] [config] all-caps-every: 0
[2023-07-04 20:06:51] [config] allow-unk: false
[2023-07-04 20:06:51] [config] authors: false
[2023-07-04 20:06:51] [config] beam-size: 12
[2023-07-04 20:06:51] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:06:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:06:51] [config] bert-masking-fraction: 0.15
[2023-07-04 20:06:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:06:51] [config] bert-train-type-embeddings: true
[2023-07-04 20:06:51] [config] bert-type-vocab-size: 2
[2023-07-04 20:06:51] [config] build-info: ""
[2023-07-04 20:06:51] [config] check-gradient-nan: false
[2023-07-04 20:06:51] [config] check-nan: false
[2023-07-04 20:06:51] [config] cite: false
[2023-07-04 20:06:51] [config] clip-norm: 1
[2023-07-04 20:06:51] [config] cost-scaling:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] cost-type: ce-sum
[2023-07-04 20:06:51] [config] cpu-threads: 0
[2023-07-04 20:06:51] [config] data-threads: 8
[2023-07-04 20:06:51] [config] data-weighting: ""
[2023-07-04 20:06:51] [config] data-weighting-type: sentence
[2023-07-04 20:06:51] [config] dec-cell: gru
[2023-07-04 20:06:51] [config] dec-cell-base-depth: 2
[2023-07-04 20:06:51] [config] dec-cell-high-depth: 1
[2023-07-04 20:06:51] [config] dec-depth: 1
[2023-07-04 20:06:51] [config] devices:
[2023-07-04 20:06:51] [config]   - 0
[2023-07-04 20:06:51] [config] dim-emb: 512
[2023-07-04 20:06:51] [config] dim-rnn: 1024
[2023-07-04 20:06:51] [config] dim-vocabs:
[2023-07-04 20:06:51] [config]   - 54042
[2023-07-04 20:06:51] [config]   - 36507
[2023-07-04 20:06:51] [config] disp-first: 0
[2023-07-04 20:06:51] [config] disp-freq: 1000u
[2023-07-04 20:06:51] [config] disp-label-counts: true
[2023-07-04 20:06:51] [config] dropout-rnn: 0
[2023-07-04 20:06:51] [config] dropout-src: 0
[2023-07-04 20:06:51] [config] dropout-trg: 0
[2023-07-04 20:06:51] [config] dump-config: ""
[2023-07-04 20:06:51] [config] dynamic-gradient-scaling:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] early-stopping: 10
[2023-07-04 20:06:51] [config] early-stopping-on: first
[2023-07-04 20:06:51] [config] embedding-fix-src: false
[2023-07-04 20:06:51] [config] embedding-fix-trg: false
[2023-07-04 20:06:51] [config] embedding-normalization: false
[2023-07-04 20:06:51] [config] embedding-vectors:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] enc-cell: gru
[2023-07-04 20:06:51] [config] enc-cell-depth: 1
[2023-07-04 20:06:51] [config] enc-depth: 1
[2023-07-04 20:06:51] [config] enc-type: bidirectional
[2023-07-04 20:06:51] [config] english-title-case-every: 0
[2023-07-04 20:06:51] [config] exponential-smoothing: 0
[2023-07-04 20:06:51] [config] factor-weight: 1
[2023-07-04 20:06:51] [config] factors-combine: sum
[2023-07-04 20:06:51] [config] factors-dim-emb: 0
[2023-07-04 20:06:51] [config] gradient-checkpointing: false
[2023-07-04 20:06:51] [config] gradient-norm-average-window: 100
[2023-07-04 20:06:51] [config] guided-alignment: none
[2023-07-04 20:06:51] [config] guided-alignment-cost: mse
[2023-07-04 20:06:51] [config] guided-alignment-weight: 0.1
[2023-07-04 20:06:51] [config] ignore-model-config: false
[2023-07-04 20:06:51] [config] input-types:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] interpolate-env-vars: false
[2023-07-04 20:06:51] [config] keep-best: false
[2023-07-04 20:06:51] [config] label-smoothing: 0
[2023-07-04 20:06:51] [config] layer-normalization: false
[2023-07-04 20:06:51] [config] learn-rate: 0.0001
[2023-07-04 20:06:51] [config] lemma-dependency: ""
[2023-07-04 20:06:51] [config] lemma-dim-emb: 0
[2023-07-04 20:06:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:06:51] [config] log-level: info
[2023-07-04 20:06:51] [config] log-time-zone: ""
[2023-07-04 20:06:51] [config] logical-epoch:
[2023-07-04 20:06:51] [config]   - 1e
[2023-07-04 20:06:51] [config]   - 0
[2023-07-04 20:06:51] [config] lr-decay: 0
[2023-07-04 20:06:51] [config] lr-decay-freq: 50000
[2023-07-04 20:06:51] [config] lr-decay-inv-sqrt:
[2023-07-04 20:06:51] [config]   - 0
[2023-07-04 20:06:51] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:06:51] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:06:51] [config] lr-decay-start:
[2023-07-04 20:06:51] [config]   - 10
[2023-07-04 20:06:51] [config]   - 1
[2023-07-04 20:06:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:06:51] [config] lr-report: false
[2023-07-04 20:06:51] [config] lr-warmup: 0
[2023-07-04 20:06:51] [config] lr-warmup-at-reload: false
[2023-07-04 20:06:51] [config] lr-warmup-cycle: false
[2023-07-04 20:06:51] [config] lr-warmup-start-rate: 0
[2023-07-04 20:06:51] [config] max-length: 50
[2023-07-04 20:06:51] [config] max-length-crop: false
[2023-07-04 20:06:51] [config] max-length-factor: 3
[2023-07-04 20:06:51] [config] maxi-batch: 100
[2023-07-04 20:06:51] [config] maxi-batch-sort: trg
[2023-07-04 20:06:51] [config] mini-batch: 64
[2023-07-04 20:06:51] [config] mini-batch-fit: false
[2023-07-04 20:06:51] [config] mini-batch-fit-step: 10
[2023-07-04 20:06:51] [config] mini-batch-round-up: true
[2023-07-04 20:06:51] [config] mini-batch-track-lr: false
[2023-07-04 20:06:51] [config] mini-batch-warmup: 0
[2023-07-04 20:06:51] [config] mini-batch-words: 0
[2023-07-04 20:06:51] [config] mini-batch-words-ref: 0
[2023-07-04 20:06:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:06:51] [config] multi-loss-type: sum
[2023-07-04 20:06:51] [config] n-best: false
[2023-07-04 20:06:51] [config] no-nccl: false
[2023-07-04 20:06:51] [config] no-reload: false
[2023-07-04 20:06:51] [config] no-restore-corpus: false
[2023-07-04 20:06:51] [config] normalize: 0
[2023-07-04 20:06:51] [config] normalize-gradient: false
[2023-07-04 20:06:51] [config] num-devices: 0
[2023-07-04 20:06:51] [config] optimizer: adam
[2023-07-04 20:06:51] [config] optimizer-delay: 1
[2023-07-04 20:06:51] [config] optimizer-params:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] output-omit-bias: false
[2023-07-04 20:06:51] [config] overwrite: true
[2023-07-04 20:06:51] [config] precision:
[2023-07-04 20:06:51] [config]   - float32
[2023-07-04 20:06:51] [config]   - float32
[2023-07-04 20:06:51] [config] pretrained-model: ""
[2023-07-04 20:06:51] [config] quantize-biases: false
[2023-07-04 20:06:51] [config] quantize-bits: 0
[2023-07-04 20:06:51] [config] quantize-log-based: false
[2023-07-04 20:06:51] [config] quantize-optimization-steps: 0
[2023-07-04 20:06:51] [config] quiet: false
[2023-07-04 20:06:51] [config] quiet-translation: true
[2023-07-04 20:06:51] [config] relative-paths: false
[2023-07-04 20:06:51] [config] right-left: false
[2023-07-04 20:06:51] [config] save-freq: 10000u
[2023-07-04 20:06:51] [config] seed: 1234
[2023-07-04 20:06:51] [config] sentencepiece-alphas:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:06:51] [config] sentencepiece-options: ""
[2023-07-04 20:06:51] [config] sharding: global
[2023-07-04 20:06:51] [config] shuffle: data
[2023-07-04 20:06:51] [config] shuffle-in-ram: false
[2023-07-04 20:06:51] [config] sigterm: save-and-exit
[2023-07-04 20:06:51] [config] skip: false
[2023-07-04 20:06:51] [config] sqlite: ""
[2023-07-04 20:06:51] [config] sqlite-drop: false
[2023-07-04 20:06:51] [config] sync-freq: 200u
[2023-07-04 20:06:51] [config] sync-sgd: false
[2023-07-04 20:06:51] [config] tempdir: /tmp
[2023-07-04 20:06:51] [config] tied-embeddings: false
[2023-07-04 20:06:51] [config] tied-embeddings-all: false
[2023-07-04 20:06:51] [config] tied-embeddings-src: false
[2023-07-04 20:06:51] [config] train-embedder-rank:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] train-sets:
[2023-07-04 20:06:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:06:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:06:51] [config] transformer-aan-activation: swish
[2023-07-04 20:06:51] [config] transformer-aan-depth: 2
[2023-07-04 20:06:51] [config] transformer-aan-nogate: false
[2023-07-04 20:06:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:06:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:06:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:06:51] [config] transformer-depth-scaling: false
[2023-07-04 20:06:51] [config] transformer-dim-aan: 2048
[2023-07-04 20:06:51] [config] transformer-dim-ffn: 2048
[2023-07-04 20:06:51] [config] transformer-dropout: 0
[2023-07-04 20:06:51] [config] transformer-dropout-attention: 0
[2023-07-04 20:06:51] [config] transformer-dropout-ffn: 0
[2023-07-04 20:06:51] [config] transformer-ffn-activation: swish
[2023-07-04 20:06:51] [config] transformer-ffn-depth: 2
[2023-07-04 20:06:51] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:06:51] [config] transformer-heads: 8
[2023-07-04 20:06:51] [config] transformer-no-projection: false
[2023-07-04 20:06:51] [config] transformer-pool: false
[2023-07-04 20:06:51] [config] transformer-postprocess: dan
[2023-07-04 20:06:51] [config] transformer-postprocess-emb: d
[2023-07-04 20:06:51] [config] transformer-postprocess-top: ""
[2023-07-04 20:06:51] [config] transformer-preprocess: ""
[2023-07-04 20:06:51] [config] transformer-tied-layers:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] transformer-train-position-embeddings: false
[2023-07-04 20:06:51] [config] tsv: false
[2023-07-04 20:06:51] [config] tsv-fields: 0
[2023-07-04 20:06:51] [config] type: transformer
[2023-07-04 20:06:51] [config] ulr: false
[2023-07-04 20:06:51] [config] ulr-dim-emb: 0
[2023-07-04 20:06:51] [config] ulr-dropout: 0
[2023-07-04 20:06:51] [config] ulr-keys-vectors: ""
[2023-07-04 20:06:51] [config] ulr-query-vectors: ""
[2023-07-04 20:06:51] [config] ulr-softmax-temperature: 1
[2023-07-04 20:06:51] [config] ulr-trainable-transformation: false
[2023-07-04 20:06:51] [config] unlikelihood-loss: false
[2023-07-04 20:06:51] [config] valid-freq: 50000000
[2023-07-04 20:06:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:06:51] [config] valid-max-length: 1000
[2023-07-04 20:06:51] [config] valid-metrics:
[2023-07-04 20:06:51] [config]   - cross-entropy
[2023-07-04 20:06:51] [config]   - translation
[2023-07-04 20:06:51] [config] valid-mini-batch: 32
[2023-07-04 20:06:51] [config] valid-reset-stalled: false
[2023-07-04 20:06:51] [config] valid-script-args:
[2023-07-04 20:06:51] [config]   []
[2023-07-04 20:06:51] [config] valid-script-path: ""
[2023-07-04 20:06:51] [config] valid-sets:
[2023-07-04 20:06:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:06:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:06:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:06:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:06:51] [config] vocabs:
[2023-07-04 20:06:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:06:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:06:51] [config] word-penalty: 0
[2023-07-04 20:06:51] [config] word-scores: false
[2023-07-04 20:06:51] [config] workspace: 2048
[2023-07-04 20:06:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:06:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:06:51] [training] Using single-device training
[2023-07-04 20:06:51] Synced seed 1234
[2023-07-04 20:06:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:06:51] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:06:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:06:51] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:06:51] [valid] No post-processing script given for validating translator
[2023-07-04 20:06:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:06:52] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:06:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:06:52] [comm] Using global sharding
[2023-07-04 20:06:52] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:06:52] [training] Using 1 GPUs
[2023-07-04 20:06:52] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:06:54] Loading Adam parameters
[2023-07-04 20:06:54] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:06:54] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:06:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:06:54] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-04 20:06:54] [data] Shuffling data
[2023-07-04 20:06:54] [data] Done reading 20,192 sentences
[2023-07-04 20:06:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:06:54] Training started
[2023-07-04 20:06:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:06:54] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:06:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:06:55] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:06:55] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:06:56] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 1.78810871 * 1,343,919 @ 1,536 after 4,022,064 : Time 5.41s : 248270.06 words/s : gNorm 2.0332
[2023-07-04 20:07:12] Seen 18,843 samples
[2023-07-04 20:07:12] Starting data epoch 12 in logical epoch 12
[2023-07-04 20:07:12] [data] Shuffling data
[2023-07-04 20:07:12] [data] Done reading 20,192 sentences
[2023-07-04 20:07:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:07:33] Seen 18,843 samples
[2023-07-04 20:07:33] Starting data epoch 13 in logical epoch 13
[2023-07-04 20:07:33] [data] Shuffling data
[2023-07-04 20:07:33] [data] Done reading 20,192 sentences
[2023-07-04 20:07:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:07:56] Seen 18,843 samples
[2023-07-04 20:07:56] Starting data epoch 14 in logical epoch 14
[2023-07-04 20:07:56] [data] Shuffling data
[2023-07-04 20:07:56] [data] Done reading 20,192 sentences
[2023-07-04 20:07:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:08:08] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 0.76778829 * 1,354,393 @ 2,176 after 5,376,457 : Time 71.79s : 18866.47 words/s : gNorm 1.5286
[2023-07-04 20:08:20] Seen 18,843 samples
[2023-07-04 20:08:20] Starting data epoch 15 in logical epoch 15
[2023-07-04 20:08:20] [data] Shuffling data
[2023-07-04 20:08:20] [data] Done reading 20,192 sentences
[2023-07-04 20:08:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:08:43] Seen 18,843 samples
[2023-07-04 20:08:43] Starting data epoch 16 in logical epoch 16
[2023-07-04 20:08:43] [data] Shuffling data
[2023-07-04 20:08:43] [data] Done reading 20,192 sentences
[2023-07-04 20:08:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:09:07] Seen 18,843 samples
[2023-07-04 20:09:07] Starting data epoch 17 in logical epoch 17
[2023-07-04 20:09:07] [data] Shuffling data
[2023-07-04 20:09:07] [data] Done reading 20,192 sentences
[2023-07-04 20:09:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:09:28] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 0.26951748 * 1,331,522 @ 1,216 after 6,707,979 : Time 79.39s : 16771.47 words/s : gNorm 1.2782
[2023-07-04 20:09:31] Seen 18,843 samples
[2023-07-04 20:09:31] Starting data epoch 18 in logical epoch 18
[2023-07-04 20:09:31] [data] Shuffling data
[2023-07-04 20:09:31] [data] Done reading 20,192 sentences
[2023-07-04 20:09:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:09:54] Seen 18,843 samples
[2023-07-04 20:09:54] Starting data epoch 19 in logical epoch 19
[2023-07-04 20:09:54] [data] Shuffling data
[2023-07-04 20:09:55] [data] Done reading 20,192 sentences
[2023-07-04 20:09:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:10:18] Seen 18,843 samples
[2023-07-04 20:10:18] Starting data epoch 20 in logical epoch 20
[2023-07-04 20:10:18] [data] Shuffling data
[2023-07-04 20:10:18] [data] Done reading 20,192 sentences
[2023-07-04 20:10:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:10:41] Seen 18,843 samples
[2023-07-04 20:10:41] Starting data epoch 21 in logical epoch 21
[2023-07-04 20:10:41] Training finished
[2023-07-04 20:10:44] [valid] Ep. 21 : Up. 5933 : cross-entropy : 153.921 : stalled 1 times (last best: 125.788)
[2023-07-04 20:13:21] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-07-04 20:13:21] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:13:24] Saving Adam parameters
[2023-07-04 20:13:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:13:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:13:37] [marian] Running on node07.datos.cluster.uy as process 15600 with command line:
[2023-07-04 20:13:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:13:37] [config] after: 0e
[2023-07-04 20:13:37] [config] after-batches: 0
[2023-07-04 20:13:37] [config] after-epochs: 30
[2023-07-04 20:13:37] [config] all-caps-every: 0
[2023-07-04 20:13:37] [config] allow-unk: false
[2023-07-04 20:13:37] [config] authors: false
[2023-07-04 20:13:37] [config] beam-size: 12
[2023-07-04 20:13:37] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:13:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:13:37] [config] bert-masking-fraction: 0.15
[2023-07-04 20:13:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:13:37] [config] bert-train-type-embeddings: true
[2023-07-04 20:13:37] [config] bert-type-vocab-size: 2
[2023-07-04 20:13:37] [config] build-info: ""
[2023-07-04 20:13:37] [config] check-gradient-nan: false
[2023-07-04 20:13:37] [config] check-nan: false
[2023-07-04 20:13:37] [config] cite: false
[2023-07-04 20:13:37] [config] clip-norm: 1
[2023-07-04 20:13:37] [config] cost-scaling:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] cost-type: ce-sum
[2023-07-04 20:13:37] [config] cpu-threads: 0
[2023-07-04 20:13:37] [config] data-threads: 8
[2023-07-04 20:13:37] [config] data-weighting: ""
[2023-07-04 20:13:37] [config] data-weighting-type: sentence
[2023-07-04 20:13:37] [config] dec-cell: gru
[2023-07-04 20:13:37] [config] dec-cell-base-depth: 2
[2023-07-04 20:13:37] [config] dec-cell-high-depth: 1
[2023-07-04 20:13:37] [config] dec-depth: 1
[2023-07-04 20:13:37] [config] devices:
[2023-07-04 20:13:37] [config]   - 0
[2023-07-04 20:13:37] [config] dim-emb: 512
[2023-07-04 20:13:37] [config] dim-rnn: 1024
[2023-07-04 20:13:37] [config] dim-vocabs:
[2023-07-04 20:13:37] [config]   - 54042
[2023-07-04 20:13:37] [config]   - 36507
[2023-07-04 20:13:37] [config] disp-first: 0
[2023-07-04 20:13:37] [config] disp-freq: 1000u
[2023-07-04 20:13:37] [config] disp-label-counts: true
[2023-07-04 20:13:37] [config] dropout-rnn: 0
[2023-07-04 20:13:37] [config] dropout-src: 0
[2023-07-04 20:13:37] [config] dropout-trg: 0
[2023-07-04 20:13:37] [config] dump-config: ""
[2023-07-04 20:13:37] [config] dynamic-gradient-scaling:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] early-stopping: 10
[2023-07-04 20:13:37] [config] early-stopping-on: first
[2023-07-04 20:13:37] [config] embedding-fix-src: false
[2023-07-04 20:13:37] [config] embedding-fix-trg: false
[2023-07-04 20:13:37] [config] embedding-normalization: false
[2023-07-04 20:13:37] [config] embedding-vectors:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] enc-cell: gru
[2023-07-04 20:13:37] [config] enc-cell-depth: 1
[2023-07-04 20:13:37] [config] enc-depth: 1
[2023-07-04 20:13:37] [config] enc-type: bidirectional
[2023-07-04 20:13:37] [config] english-title-case-every: 0
[2023-07-04 20:13:37] [config] exponential-smoothing: 0
[2023-07-04 20:13:37] [config] factor-weight: 1
[2023-07-04 20:13:37] [config] factors-combine: sum
[2023-07-04 20:13:37] [config] factors-dim-emb: 0
[2023-07-04 20:13:37] [config] gradient-checkpointing: false
[2023-07-04 20:13:37] [config] gradient-norm-average-window: 100
[2023-07-04 20:13:37] [config] guided-alignment: none
[2023-07-04 20:13:37] [config] guided-alignment-cost: mse
[2023-07-04 20:13:37] [config] guided-alignment-weight: 0.1
[2023-07-04 20:13:37] [config] ignore-model-config: false
[2023-07-04 20:13:37] [config] input-types:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] interpolate-env-vars: false
[2023-07-04 20:13:37] [config] keep-best: false
[2023-07-04 20:13:37] [config] label-smoothing: 0
[2023-07-04 20:13:37] [config] layer-normalization: false
[2023-07-04 20:13:37] [config] learn-rate: 0.0001
[2023-07-04 20:13:37] [config] lemma-dependency: ""
[2023-07-04 20:13:37] [config] lemma-dim-emb: 0
[2023-07-04 20:13:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:13:37] [config] log-level: info
[2023-07-04 20:13:37] [config] log-time-zone: ""
[2023-07-04 20:13:37] [config] logical-epoch:
[2023-07-04 20:13:37] [config]   - 1e
[2023-07-04 20:13:37] [config]   - 0
[2023-07-04 20:13:37] [config] lr-decay: 0
[2023-07-04 20:13:37] [config] lr-decay-freq: 50000
[2023-07-04 20:13:37] [config] lr-decay-inv-sqrt:
[2023-07-04 20:13:37] [config]   - 0
[2023-07-04 20:13:37] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:13:37] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:13:37] [config] lr-decay-start:
[2023-07-04 20:13:37] [config]   - 10
[2023-07-04 20:13:37] [config]   - 1
[2023-07-04 20:13:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:13:37] [config] lr-report: false
[2023-07-04 20:13:37] [config] lr-warmup: 0
[2023-07-04 20:13:37] [config] lr-warmup-at-reload: false
[2023-07-04 20:13:37] [config] lr-warmup-cycle: false
[2023-07-04 20:13:37] [config] lr-warmup-start-rate: 0
[2023-07-04 20:13:37] [config] max-length: 50
[2023-07-04 20:13:37] [config] max-length-crop: false
[2023-07-04 20:13:37] [config] max-length-factor: 3
[2023-07-04 20:13:37] [config] maxi-batch: 100
[2023-07-04 20:13:37] [config] maxi-batch-sort: trg
[2023-07-04 20:13:37] [config] mini-batch: 64
[2023-07-04 20:13:37] [config] mini-batch-fit: false
[2023-07-04 20:13:37] [config] mini-batch-fit-step: 10
[2023-07-04 20:13:37] [config] mini-batch-round-up: true
[2023-07-04 20:13:37] [config] mini-batch-track-lr: false
[2023-07-04 20:13:37] [config] mini-batch-warmup: 0
[2023-07-04 20:13:37] [config] mini-batch-words: 0
[2023-07-04 20:13:37] [config] mini-batch-words-ref: 0
[2023-07-04 20:13:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:13:37] [config] multi-loss-type: sum
[2023-07-04 20:13:37] [config] n-best: false
[2023-07-04 20:13:37] [config] no-nccl: false
[2023-07-04 20:13:37] [config] no-reload: false
[2023-07-04 20:13:37] [config] no-restore-corpus: false
[2023-07-04 20:13:37] [config] normalize: 0
[2023-07-04 20:13:37] [config] normalize-gradient: false
[2023-07-04 20:13:37] [config] num-devices: 0
[2023-07-04 20:13:37] [config] optimizer: adam
[2023-07-04 20:13:37] [config] optimizer-delay: 1
[2023-07-04 20:13:37] [config] optimizer-params:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] output-omit-bias: false
[2023-07-04 20:13:37] [config] overwrite: true
[2023-07-04 20:13:37] [config] precision:
[2023-07-04 20:13:37] [config]   - float32
[2023-07-04 20:13:37] [config]   - float32
[2023-07-04 20:13:37] [config] pretrained-model: ""
[2023-07-04 20:13:37] [config] quantize-biases: false
[2023-07-04 20:13:37] [config] quantize-bits: 0
[2023-07-04 20:13:37] [config] quantize-log-based: false
[2023-07-04 20:13:37] [config] quantize-optimization-steps: 0
[2023-07-04 20:13:37] [config] quiet: false
[2023-07-04 20:13:37] [config] quiet-translation: true
[2023-07-04 20:13:37] [config] relative-paths: false
[2023-07-04 20:13:37] [config] right-left: false
[2023-07-04 20:13:37] [config] save-freq: 10000u
[2023-07-04 20:13:37] [config] seed: 1234
[2023-07-04 20:13:37] [config] sentencepiece-alphas:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:13:37] [config] sentencepiece-options: ""
[2023-07-04 20:13:37] [config] sharding: global
[2023-07-04 20:13:37] [config] shuffle: data
[2023-07-04 20:13:37] [config] shuffle-in-ram: false
[2023-07-04 20:13:37] [config] sigterm: save-and-exit
[2023-07-04 20:13:37] [config] skip: false
[2023-07-04 20:13:37] [config] sqlite: ""
[2023-07-04 20:13:37] [config] sqlite-drop: false
[2023-07-04 20:13:37] [config] sync-freq: 200u
[2023-07-04 20:13:37] [config] sync-sgd: false
[2023-07-04 20:13:37] [config] tempdir: /tmp
[2023-07-04 20:13:37] [config] tied-embeddings: false
[2023-07-04 20:13:37] [config] tied-embeddings-all: false
[2023-07-04 20:13:37] [config] tied-embeddings-src: false
[2023-07-04 20:13:37] [config] train-embedder-rank:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] train-sets:
[2023-07-04 20:13:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:13:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:13:37] [config] transformer-aan-activation: swish
[2023-07-04 20:13:37] [config] transformer-aan-depth: 2
[2023-07-04 20:13:37] [config] transformer-aan-nogate: false
[2023-07-04 20:13:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:13:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:13:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:13:37] [config] transformer-depth-scaling: false
[2023-07-04 20:13:37] [config] transformer-dim-aan: 2048
[2023-07-04 20:13:37] [config] transformer-dim-ffn: 2048
[2023-07-04 20:13:37] [config] transformer-dropout: 0
[2023-07-04 20:13:37] [config] transformer-dropout-attention: 0
[2023-07-04 20:13:37] [config] transformer-dropout-ffn: 0
[2023-07-04 20:13:37] [config] transformer-ffn-activation: swish
[2023-07-04 20:13:37] [config] transformer-ffn-depth: 2
[2023-07-04 20:13:37] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:13:37] [config] transformer-heads: 8
[2023-07-04 20:13:37] [config] transformer-no-projection: false
[2023-07-04 20:13:37] [config] transformer-pool: false
[2023-07-04 20:13:37] [config] transformer-postprocess: dan
[2023-07-04 20:13:37] [config] transformer-postprocess-emb: d
[2023-07-04 20:13:37] [config] transformer-postprocess-top: ""
[2023-07-04 20:13:37] [config] transformer-preprocess: ""
[2023-07-04 20:13:37] [config] transformer-tied-layers:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] transformer-train-position-embeddings: false
[2023-07-04 20:13:37] [config] tsv: false
[2023-07-04 20:13:37] [config] tsv-fields: 0
[2023-07-04 20:13:37] [config] type: transformer
[2023-07-04 20:13:37] [config] ulr: false
[2023-07-04 20:13:37] [config] ulr-dim-emb: 0
[2023-07-04 20:13:37] [config] ulr-dropout: 0
[2023-07-04 20:13:37] [config] ulr-keys-vectors: ""
[2023-07-04 20:13:37] [config] ulr-query-vectors: ""
[2023-07-04 20:13:37] [config] ulr-softmax-temperature: 1
[2023-07-04 20:13:37] [config] ulr-trainable-transformation: false
[2023-07-04 20:13:37] [config] unlikelihood-loss: false
[2023-07-04 20:13:37] [config] valid-freq: 50000000
[2023-07-04 20:13:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:13:37] [config] valid-max-length: 1000
[2023-07-04 20:13:37] [config] valid-metrics:
[2023-07-04 20:13:37] [config]   - cross-entropy
[2023-07-04 20:13:37] [config]   - translation
[2023-07-04 20:13:37] [config] valid-mini-batch: 32
[2023-07-04 20:13:37] [config] valid-reset-stalled: false
[2023-07-04 20:13:37] [config] valid-script-args:
[2023-07-04 20:13:37] [config]   []
[2023-07-04 20:13:37] [config] valid-script-path: ""
[2023-07-04 20:13:37] [config] valid-sets:
[2023-07-04 20:13:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:13:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:13:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:13:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:13:37] [config] vocabs:
[2023-07-04 20:13:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:13:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:13:37] [config] word-penalty: 0
[2023-07-04 20:13:37] [config] word-scores: false
[2023-07-04 20:13:37] [config] workspace: 2048
[2023-07-04 20:13:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:13:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:13:37] [training] Using single-device training
[2023-07-04 20:13:37] Synced seed 1234
[2023-07-04 20:13:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:13:37] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:13:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:13:37] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:13:37] [valid] No post-processing script given for validating translator
[2023-07-04 20:13:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:13:38] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:13:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:13:38] [comm] Using global sharding
[2023-07-04 20:13:38] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:13:38] [training] Using 1 GPUs
[2023-07-04 20:13:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:13:40] Loading Adam parameters
[2023-07-04 20:13:40] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:13:40] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:13:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:13:41] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-07-04 20:13:41] [data] Shuffling data
[2023-07-04 20:13:41] [data] Done reading 20,192 sentences
[2023-07-04 20:13:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:13:41] Training started
[2023-07-04 20:13:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:13:41] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:13:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:13:41] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:13:41] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:13:45] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 0.10444088 * 1,344,567 @ 1,231 after 8,052,546 : Time 7.59s : 177148.47 words/s : gNorm 1.0012
[2023-07-04 20:13:59] Seen 18,843 samples
[2023-07-04 20:13:59] Starting data epoch 22 in logical epoch 22
[2023-07-04 20:13:59] [data] Shuffling data
[2023-07-04 20:13:59] [data] Done reading 20,192 sentences
[2023-07-04 20:13:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:14:23] Seen 18,843 samples
[2023-07-04 20:14:23] Starting data epoch 23 in logical epoch 23
[2023-07-04 20:14:23] [data] Shuffling data
[2023-07-04 20:14:23] [data] Done reading 20,192 sentences
[2023-07-04 20:14:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:14:44] Seen 18,843 samples
[2023-07-04 20:14:44] Starting data epoch 24 in logical epoch 24
[2023-07-04 20:14:44] [data] Shuffling data
[2023-07-04 20:14:44] [data] Done reading 20,192 sentences
[2023-07-04 20:14:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:14:57] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 0.05595680 * 1,339,673 @ 704 after 9,392,219 : Time 72.42s : 18498.42 words/s : gNorm 0.9353
[2023-07-04 20:15:07] Seen 18,843 samples
[2023-07-04 20:15:07] Starting data epoch 25 in logical epoch 25
[2023-07-04 20:15:07] [data] Shuffling data
[2023-07-04 20:15:08] [data] Done reading 20,192 sentences
[2023-07-04 20:15:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:15:32] Seen 18,843 samples
[2023-07-04 20:15:32] Starting data epoch 26 in logical epoch 26
[2023-07-04 20:15:32] [data] Shuffling data
[2023-07-04 20:15:32] [data] Done reading 20,192 sentences
[2023-07-04 20:15:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:15:54] Seen 18,843 samples
[2023-07-04 20:15:54] Starting data epoch 27 in logical epoch 27
[2023-07-04 20:15:54] [data] Shuffling data
[2023-07-04 20:15:54] [data] Done reading 20,192 sentences
[2023-07-04 20:15:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:16:17] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 0.03862233 * 1,339,074 @ 1,034 after 10,731,293 : Time 79.35s : 16875.43 words/s : gNorm 0.8922
[2023-07-04 20:16:17] Seen 18,843 samples
[2023-07-04 20:16:17] Starting data epoch 28 in logical epoch 28
[2023-07-04 20:16:17] [data] Shuffling data
[2023-07-04 20:16:17] [data] Done reading 20,192 sentences
[2023-07-04 20:16:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:16:41] Seen 18,843 samples
[2023-07-04 20:16:41] Starting data epoch 29 in logical epoch 29
[2023-07-04 20:16:41] [data] Shuffling data
[2023-07-04 20:16:41] [data] Done reading 20,192 sentences
[2023-07-04 20:16:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:17:06] Seen 18,843 samples
[2023-07-04 20:17:06] Starting data epoch 30 in logical epoch 30
[2023-07-04 20:17:06] [data] Shuffling data
[2023-07-04 20:17:06] [data] Done reading 20,192 sentences
[2023-07-04 20:17:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:17:28] Seen 18,843 samples
[2023-07-04 20:17:28] Starting data epoch 31 in logical epoch 31
[2023-07-04 20:17:28] Training finished
[2023-07-04 20:17:31] [valid] Ep. 31 : Up. 8898 : cross-entropy : 169.32 : stalled 2 times (last best: 125.788)
[2023-07-04 20:20:06] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-07-04 20:20:06] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:20:09] Saving Adam parameters
[2023-07-04 20:20:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:20:25] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:20:25] [marian] Running on node07.datos.cluster.uy as process 16305 with command line:
[2023-07-04 20:20:25] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:20:25] [config] after: 0e
[2023-07-04 20:20:25] [config] after-batches: 0
[2023-07-04 20:20:25] [config] after-epochs: 40
[2023-07-04 20:20:25] [config] all-caps-every: 0
[2023-07-04 20:20:25] [config] allow-unk: false
[2023-07-04 20:20:25] [config] authors: false
[2023-07-04 20:20:25] [config] beam-size: 12
[2023-07-04 20:20:25] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:20:25] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:20:25] [config] bert-masking-fraction: 0.15
[2023-07-04 20:20:25] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:20:25] [config] bert-train-type-embeddings: true
[2023-07-04 20:20:25] [config] bert-type-vocab-size: 2
[2023-07-04 20:20:25] [config] build-info: ""
[2023-07-04 20:20:25] [config] check-gradient-nan: false
[2023-07-04 20:20:25] [config] check-nan: false
[2023-07-04 20:20:25] [config] cite: false
[2023-07-04 20:20:25] [config] clip-norm: 1
[2023-07-04 20:20:25] [config] cost-scaling:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] cost-type: ce-sum
[2023-07-04 20:20:25] [config] cpu-threads: 0
[2023-07-04 20:20:25] [config] data-threads: 8
[2023-07-04 20:20:25] [config] data-weighting: ""
[2023-07-04 20:20:25] [config] data-weighting-type: sentence
[2023-07-04 20:20:25] [config] dec-cell: gru
[2023-07-04 20:20:25] [config] dec-cell-base-depth: 2
[2023-07-04 20:20:25] [config] dec-cell-high-depth: 1
[2023-07-04 20:20:25] [config] dec-depth: 1
[2023-07-04 20:20:25] [config] devices:
[2023-07-04 20:20:25] [config]   - 0
[2023-07-04 20:20:25] [config] dim-emb: 512
[2023-07-04 20:20:25] [config] dim-rnn: 1024
[2023-07-04 20:20:25] [config] dim-vocabs:
[2023-07-04 20:20:25] [config]   - 54042
[2023-07-04 20:20:25] [config]   - 36507
[2023-07-04 20:20:25] [config] disp-first: 0
[2023-07-04 20:20:25] [config] disp-freq: 1000u
[2023-07-04 20:20:25] [config] disp-label-counts: true
[2023-07-04 20:20:25] [config] dropout-rnn: 0
[2023-07-04 20:20:25] [config] dropout-src: 0
[2023-07-04 20:20:25] [config] dropout-trg: 0
[2023-07-04 20:20:25] [config] dump-config: ""
[2023-07-04 20:20:25] [config] dynamic-gradient-scaling:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] early-stopping: 10
[2023-07-04 20:20:25] [config] early-stopping-on: first
[2023-07-04 20:20:25] [config] embedding-fix-src: false
[2023-07-04 20:20:25] [config] embedding-fix-trg: false
[2023-07-04 20:20:25] [config] embedding-normalization: false
[2023-07-04 20:20:25] [config] embedding-vectors:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] enc-cell: gru
[2023-07-04 20:20:25] [config] enc-cell-depth: 1
[2023-07-04 20:20:25] [config] enc-depth: 1
[2023-07-04 20:20:25] [config] enc-type: bidirectional
[2023-07-04 20:20:25] [config] english-title-case-every: 0
[2023-07-04 20:20:25] [config] exponential-smoothing: 0
[2023-07-04 20:20:25] [config] factor-weight: 1
[2023-07-04 20:20:25] [config] factors-combine: sum
[2023-07-04 20:20:25] [config] factors-dim-emb: 0
[2023-07-04 20:20:25] [config] gradient-checkpointing: false
[2023-07-04 20:20:25] [config] gradient-norm-average-window: 100
[2023-07-04 20:20:25] [config] guided-alignment: none
[2023-07-04 20:20:25] [config] guided-alignment-cost: mse
[2023-07-04 20:20:25] [config] guided-alignment-weight: 0.1
[2023-07-04 20:20:25] [config] ignore-model-config: false
[2023-07-04 20:20:25] [config] input-types:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] interpolate-env-vars: false
[2023-07-04 20:20:25] [config] keep-best: false
[2023-07-04 20:20:25] [config] label-smoothing: 0
[2023-07-04 20:20:25] [config] layer-normalization: false
[2023-07-04 20:20:25] [config] learn-rate: 0.0001
[2023-07-04 20:20:25] [config] lemma-dependency: ""
[2023-07-04 20:20:25] [config] lemma-dim-emb: 0
[2023-07-04 20:20:25] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:20:25] [config] log-level: info
[2023-07-04 20:20:25] [config] log-time-zone: ""
[2023-07-04 20:20:25] [config] logical-epoch:
[2023-07-04 20:20:25] [config]   - 1e
[2023-07-04 20:20:25] [config]   - 0
[2023-07-04 20:20:25] [config] lr-decay: 0
[2023-07-04 20:20:25] [config] lr-decay-freq: 50000
[2023-07-04 20:20:25] [config] lr-decay-inv-sqrt:
[2023-07-04 20:20:25] [config]   - 0
[2023-07-04 20:20:25] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:20:25] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:20:25] [config] lr-decay-start:
[2023-07-04 20:20:25] [config]   - 10
[2023-07-04 20:20:25] [config]   - 1
[2023-07-04 20:20:25] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:20:25] [config] lr-report: false
[2023-07-04 20:20:25] [config] lr-warmup: 0
[2023-07-04 20:20:25] [config] lr-warmup-at-reload: false
[2023-07-04 20:20:25] [config] lr-warmup-cycle: false
[2023-07-04 20:20:25] [config] lr-warmup-start-rate: 0
[2023-07-04 20:20:25] [config] max-length: 50
[2023-07-04 20:20:25] [config] max-length-crop: false
[2023-07-04 20:20:25] [config] max-length-factor: 3
[2023-07-04 20:20:25] [config] maxi-batch: 100
[2023-07-04 20:20:25] [config] maxi-batch-sort: trg
[2023-07-04 20:20:25] [config] mini-batch: 64
[2023-07-04 20:20:25] [config] mini-batch-fit: false
[2023-07-04 20:20:25] [config] mini-batch-fit-step: 10
[2023-07-04 20:20:25] [config] mini-batch-round-up: true
[2023-07-04 20:20:25] [config] mini-batch-track-lr: false
[2023-07-04 20:20:25] [config] mini-batch-warmup: 0
[2023-07-04 20:20:25] [config] mini-batch-words: 0
[2023-07-04 20:20:25] [config] mini-batch-words-ref: 0
[2023-07-04 20:20:25] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:20:25] [config] multi-loss-type: sum
[2023-07-04 20:20:25] [config] n-best: false
[2023-07-04 20:20:25] [config] no-nccl: false
[2023-07-04 20:20:25] [config] no-reload: false
[2023-07-04 20:20:25] [config] no-restore-corpus: false
[2023-07-04 20:20:25] [config] normalize: 0
[2023-07-04 20:20:25] [config] normalize-gradient: false
[2023-07-04 20:20:25] [config] num-devices: 0
[2023-07-04 20:20:25] [config] optimizer: adam
[2023-07-04 20:20:25] [config] optimizer-delay: 1
[2023-07-04 20:20:25] [config] optimizer-params:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] output-omit-bias: false
[2023-07-04 20:20:25] [config] overwrite: true
[2023-07-04 20:20:25] [config] precision:
[2023-07-04 20:20:25] [config]   - float32
[2023-07-04 20:20:25] [config]   - float32
[2023-07-04 20:20:25] [config] pretrained-model: ""
[2023-07-04 20:20:25] [config] quantize-biases: false
[2023-07-04 20:20:25] [config] quantize-bits: 0
[2023-07-04 20:20:25] [config] quantize-log-based: false
[2023-07-04 20:20:25] [config] quantize-optimization-steps: 0
[2023-07-04 20:20:25] [config] quiet: false
[2023-07-04 20:20:25] [config] quiet-translation: true
[2023-07-04 20:20:25] [config] relative-paths: false
[2023-07-04 20:20:25] [config] right-left: false
[2023-07-04 20:20:25] [config] save-freq: 10000u
[2023-07-04 20:20:25] [config] seed: 1234
[2023-07-04 20:20:25] [config] sentencepiece-alphas:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:20:25] [config] sentencepiece-options: ""
[2023-07-04 20:20:25] [config] sharding: global
[2023-07-04 20:20:25] [config] shuffle: data
[2023-07-04 20:20:25] [config] shuffle-in-ram: false
[2023-07-04 20:20:25] [config] sigterm: save-and-exit
[2023-07-04 20:20:25] [config] skip: false
[2023-07-04 20:20:25] [config] sqlite: ""
[2023-07-04 20:20:25] [config] sqlite-drop: false
[2023-07-04 20:20:25] [config] sync-freq: 200u
[2023-07-04 20:20:25] [config] sync-sgd: false
[2023-07-04 20:20:25] [config] tempdir: /tmp
[2023-07-04 20:20:25] [config] tied-embeddings: false
[2023-07-04 20:20:25] [config] tied-embeddings-all: false
[2023-07-04 20:20:25] [config] tied-embeddings-src: false
[2023-07-04 20:20:25] [config] train-embedder-rank:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] train-sets:
[2023-07-04 20:20:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:20:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:20:25] [config] transformer-aan-activation: swish
[2023-07-04 20:20:25] [config] transformer-aan-depth: 2
[2023-07-04 20:20:25] [config] transformer-aan-nogate: false
[2023-07-04 20:20:25] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:20:25] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:20:25] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:20:25] [config] transformer-depth-scaling: false
[2023-07-04 20:20:25] [config] transformer-dim-aan: 2048
[2023-07-04 20:20:25] [config] transformer-dim-ffn: 2048
[2023-07-04 20:20:25] [config] transformer-dropout: 0
[2023-07-04 20:20:25] [config] transformer-dropout-attention: 0
[2023-07-04 20:20:25] [config] transformer-dropout-ffn: 0
[2023-07-04 20:20:25] [config] transformer-ffn-activation: swish
[2023-07-04 20:20:25] [config] transformer-ffn-depth: 2
[2023-07-04 20:20:25] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:20:25] [config] transformer-heads: 8
[2023-07-04 20:20:25] [config] transformer-no-projection: false
[2023-07-04 20:20:25] [config] transformer-pool: false
[2023-07-04 20:20:25] [config] transformer-postprocess: dan
[2023-07-04 20:20:25] [config] transformer-postprocess-emb: d
[2023-07-04 20:20:25] [config] transformer-postprocess-top: ""
[2023-07-04 20:20:25] [config] transformer-preprocess: ""
[2023-07-04 20:20:25] [config] transformer-tied-layers:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] transformer-train-position-embeddings: false
[2023-07-04 20:20:25] [config] tsv: false
[2023-07-04 20:20:25] [config] tsv-fields: 0
[2023-07-04 20:20:25] [config] type: transformer
[2023-07-04 20:20:25] [config] ulr: false
[2023-07-04 20:20:25] [config] ulr-dim-emb: 0
[2023-07-04 20:20:25] [config] ulr-dropout: 0
[2023-07-04 20:20:25] [config] ulr-keys-vectors: ""
[2023-07-04 20:20:25] [config] ulr-query-vectors: ""
[2023-07-04 20:20:25] [config] ulr-softmax-temperature: 1
[2023-07-04 20:20:25] [config] ulr-trainable-transformation: false
[2023-07-04 20:20:25] [config] unlikelihood-loss: false
[2023-07-04 20:20:25] [config] valid-freq: 50000000
[2023-07-04 20:20:25] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:20:25] [config] valid-max-length: 1000
[2023-07-04 20:20:25] [config] valid-metrics:
[2023-07-04 20:20:25] [config]   - cross-entropy
[2023-07-04 20:20:25] [config]   - translation
[2023-07-04 20:20:25] [config] valid-mini-batch: 32
[2023-07-04 20:20:25] [config] valid-reset-stalled: false
[2023-07-04 20:20:25] [config] valid-script-args:
[2023-07-04 20:20:25] [config]   []
[2023-07-04 20:20:25] [config] valid-script-path: ""
[2023-07-04 20:20:25] [config] valid-sets:
[2023-07-04 20:20:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:20:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:20:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:20:25] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:20:25] [config] vocabs:
[2023-07-04 20:20:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:20:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:20:25] [config] word-penalty: 0
[2023-07-04 20:20:25] [config] word-scores: false
[2023-07-04 20:20:25] [config] workspace: 2048
[2023-07-04 20:20:25] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:20:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:20:25] [training] Using single-device training
[2023-07-04 20:20:26] Synced seed 1234
[2023-07-04 20:20:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:20:26] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:20:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:20:26] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:20:26] [valid] No post-processing script given for validating translator
[2023-07-04 20:20:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:20:27] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:20:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:20:27] [comm] Using global sharding
[2023-07-04 20:20:27] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:20:27] [training] Using 1 GPUs
[2023-07-04 20:20:27] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:20:29] Loading Adam parameters
[2023-07-04 20:20:30] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:20:30] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:20:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:20:30] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-07-04 20:20:30] [data] Shuffling data
[2023-07-04 20:20:30] [data] Done reading 20,192 sentences
[2023-07-04 20:20:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:20:30] Training started
[2023-07-04 20:20:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:20:30] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:20:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:20:30] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:20:30] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:20:36] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 0.02901156 * 1,341,072 @ 320 after 12,072,365 : Time 10.09s : 132901.79 words/s : gNorm 0.6943
[2023-07-04 20:20:48] Seen 18,843 samples
[2023-07-04 20:20:48] Starting data epoch 32 in logical epoch 32
[2023-07-04 20:20:48] [data] Shuffling data
[2023-07-04 20:20:48] [data] Done reading 20,192 sentences
[2023-07-04 20:20:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:21:10] Seen 18,843 samples
[2023-07-04 20:21:10] Starting data epoch 33 in logical epoch 33
[2023-07-04 20:21:10] [data] Shuffling data
[2023-07-04 20:21:10] [data] Done reading 20,192 sentences
[2023-07-04 20:21:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:21:32] Seen 18,843 samples
[2023-07-04 20:21:32] Starting data epoch 34 in logical epoch 34
[2023-07-04 20:21:32] [data] Shuffling data
[2023-07-04 20:21:32] [data] Done reading 20,192 sentences
[2023-07-04 20:21:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:21:48] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 0.02436812 * 1,347,521 @ 882 after 13,419,886 : Time 72.37s : 18618.61 words/s : gNorm 0.6968
[2023-07-04 20:21:48] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:21:51] Saving Adam parameters
[2023-07-04 20:21:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:22:04] Seen 18,843 samples
[2023-07-04 20:22:04] Starting data epoch 35 in logical epoch 35
[2023-07-04 20:22:04] [data] Shuffling data
[2023-07-04 20:22:04] [data] Done reading 20,192 sentences
[2023-07-04 20:22:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:22:25] Seen 18,843 samples
[2023-07-04 20:22:25] Starting data epoch 36 in logical epoch 36
[2023-07-04 20:22:25] [data] Shuffling data
[2023-07-04 20:22:25] [data] Done reading 20,192 sentences
[2023-07-04 20:22:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:22:47] Seen 18,843 samples
[2023-07-04 20:22:47] Starting data epoch 37 in logical epoch 37
[2023-07-04 20:22:47] [data] Shuffling data
[2023-07-04 20:22:47] [data] Done reading 20,192 sentences
[2023-07-04 20:22:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:23:12] Seen 18,843 samples
[2023-07-04 20:23:12] Starting data epoch 38 in logical epoch 38
[2023-07-04 20:23:12] [data] Shuffling data
[2023-07-04 20:23:12] [data] Done reading 20,192 sentences
[2023-07-04 20:23:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:23:14] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 0.02024433 * 1,344,952 @ 1,403 after 14,764,838 : Time 85.98s : 15642.53 words/s : gNorm 0.6636
[2023-07-04 20:23:35] Seen 18,843 samples
[2023-07-04 20:23:35] Starting data epoch 39 in logical epoch 39
[2023-07-04 20:23:35] [data] Shuffling data
[2023-07-04 20:23:35] [data] Done reading 20,192 sentences
[2023-07-04 20:23:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:23:58] Seen 18,843 samples
[2023-07-04 20:23:58] Starting data epoch 40 in logical epoch 40
[2023-07-04 20:23:58] [data] Shuffling data
[2023-07-04 20:23:58] [data] Done reading 20,192 sentences
[2023-07-04 20:23:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:24:21] Seen 18,843 samples
[2023-07-04 20:24:21] Starting data epoch 41 in logical epoch 41
[2023-07-04 20:24:21] Training finished
[2023-07-04 20:24:24] [valid] Ep. 41 : Up. 11864 : cross-entropy : 173.298 : stalled 3 times (last best: 125.788)
[2023-07-04 20:27:03] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-07-04 20:27:03] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:27:05] Saving Adam parameters
[2023-07-04 20:27:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:27:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:27:15] [marian] Running on node07.datos.cluster.uy as process 16706 with command line:
[2023-07-04 20:27:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:27:15] [config] after: 0e
[2023-07-04 20:27:15] [config] after-batches: 0
[2023-07-04 20:27:15] [config] after-epochs: 50
[2023-07-04 20:27:15] [config] all-caps-every: 0
[2023-07-04 20:27:15] [config] allow-unk: false
[2023-07-04 20:27:15] [config] authors: false
[2023-07-04 20:27:15] [config] beam-size: 12
[2023-07-04 20:27:15] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:27:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:27:15] [config] bert-masking-fraction: 0.15
[2023-07-04 20:27:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:27:15] [config] bert-train-type-embeddings: true
[2023-07-04 20:27:15] [config] bert-type-vocab-size: 2
[2023-07-04 20:27:15] [config] build-info: ""
[2023-07-04 20:27:15] [config] check-gradient-nan: false
[2023-07-04 20:27:15] [config] check-nan: false
[2023-07-04 20:27:15] [config] cite: false
[2023-07-04 20:27:15] [config] clip-norm: 1
[2023-07-04 20:27:15] [config] cost-scaling:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] cost-type: ce-sum
[2023-07-04 20:27:15] [config] cpu-threads: 0
[2023-07-04 20:27:15] [config] data-threads: 8
[2023-07-04 20:27:15] [config] data-weighting: ""
[2023-07-04 20:27:15] [config] data-weighting-type: sentence
[2023-07-04 20:27:15] [config] dec-cell: gru
[2023-07-04 20:27:15] [config] dec-cell-base-depth: 2
[2023-07-04 20:27:15] [config] dec-cell-high-depth: 1
[2023-07-04 20:27:15] [config] dec-depth: 1
[2023-07-04 20:27:15] [config] devices:
[2023-07-04 20:27:15] [config]   - 0
[2023-07-04 20:27:15] [config] dim-emb: 512
[2023-07-04 20:27:15] [config] dim-rnn: 1024
[2023-07-04 20:27:15] [config] dim-vocabs:
[2023-07-04 20:27:15] [config]   - 54042
[2023-07-04 20:27:15] [config]   - 36507
[2023-07-04 20:27:15] [config] disp-first: 0
[2023-07-04 20:27:15] [config] disp-freq: 1000u
[2023-07-04 20:27:15] [config] disp-label-counts: true
[2023-07-04 20:27:15] [config] dropout-rnn: 0
[2023-07-04 20:27:15] [config] dropout-src: 0
[2023-07-04 20:27:15] [config] dropout-trg: 0
[2023-07-04 20:27:15] [config] dump-config: ""
[2023-07-04 20:27:15] [config] dynamic-gradient-scaling:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] early-stopping: 10
[2023-07-04 20:27:15] [config] early-stopping-on: first
[2023-07-04 20:27:15] [config] embedding-fix-src: false
[2023-07-04 20:27:15] [config] embedding-fix-trg: false
[2023-07-04 20:27:15] [config] embedding-normalization: false
[2023-07-04 20:27:15] [config] embedding-vectors:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] enc-cell: gru
[2023-07-04 20:27:15] [config] enc-cell-depth: 1
[2023-07-04 20:27:15] [config] enc-depth: 1
[2023-07-04 20:27:15] [config] enc-type: bidirectional
[2023-07-04 20:27:15] [config] english-title-case-every: 0
[2023-07-04 20:27:15] [config] exponential-smoothing: 0
[2023-07-04 20:27:15] [config] factor-weight: 1
[2023-07-04 20:27:15] [config] factors-combine: sum
[2023-07-04 20:27:15] [config] factors-dim-emb: 0
[2023-07-04 20:27:15] [config] gradient-checkpointing: false
[2023-07-04 20:27:15] [config] gradient-norm-average-window: 100
[2023-07-04 20:27:15] [config] guided-alignment: none
[2023-07-04 20:27:15] [config] guided-alignment-cost: mse
[2023-07-04 20:27:15] [config] guided-alignment-weight: 0.1
[2023-07-04 20:27:15] [config] ignore-model-config: false
[2023-07-04 20:27:15] [config] input-types:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] interpolate-env-vars: false
[2023-07-04 20:27:15] [config] keep-best: false
[2023-07-04 20:27:15] [config] label-smoothing: 0
[2023-07-04 20:27:15] [config] layer-normalization: false
[2023-07-04 20:27:15] [config] learn-rate: 0.0001
[2023-07-04 20:27:15] [config] lemma-dependency: ""
[2023-07-04 20:27:15] [config] lemma-dim-emb: 0
[2023-07-04 20:27:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:27:15] [config] log-level: info
[2023-07-04 20:27:15] [config] log-time-zone: ""
[2023-07-04 20:27:15] [config] logical-epoch:
[2023-07-04 20:27:15] [config]   - 1e
[2023-07-04 20:27:15] [config]   - 0
[2023-07-04 20:27:15] [config] lr-decay: 0
[2023-07-04 20:27:15] [config] lr-decay-freq: 50000
[2023-07-04 20:27:15] [config] lr-decay-inv-sqrt:
[2023-07-04 20:27:15] [config]   - 0
[2023-07-04 20:27:15] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:27:15] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:27:15] [config] lr-decay-start:
[2023-07-04 20:27:15] [config]   - 10
[2023-07-04 20:27:15] [config]   - 1
[2023-07-04 20:27:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:27:15] [config] lr-report: false
[2023-07-04 20:27:15] [config] lr-warmup: 0
[2023-07-04 20:27:15] [config] lr-warmup-at-reload: false
[2023-07-04 20:27:15] [config] lr-warmup-cycle: false
[2023-07-04 20:27:15] [config] lr-warmup-start-rate: 0
[2023-07-04 20:27:15] [config] max-length: 50
[2023-07-04 20:27:15] [config] max-length-crop: false
[2023-07-04 20:27:15] [config] max-length-factor: 3
[2023-07-04 20:27:15] [config] maxi-batch: 100
[2023-07-04 20:27:15] [config] maxi-batch-sort: trg
[2023-07-04 20:27:15] [config] mini-batch: 64
[2023-07-04 20:27:15] [config] mini-batch-fit: false
[2023-07-04 20:27:15] [config] mini-batch-fit-step: 10
[2023-07-04 20:27:15] [config] mini-batch-round-up: true
[2023-07-04 20:27:15] [config] mini-batch-track-lr: false
[2023-07-04 20:27:15] [config] mini-batch-warmup: 0
[2023-07-04 20:27:15] [config] mini-batch-words: 0
[2023-07-04 20:27:15] [config] mini-batch-words-ref: 0
[2023-07-04 20:27:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:27:15] [config] multi-loss-type: sum
[2023-07-04 20:27:15] [config] n-best: false
[2023-07-04 20:27:15] [config] no-nccl: false
[2023-07-04 20:27:15] [config] no-reload: false
[2023-07-04 20:27:15] [config] no-restore-corpus: false
[2023-07-04 20:27:15] [config] normalize: 0
[2023-07-04 20:27:15] [config] normalize-gradient: false
[2023-07-04 20:27:15] [config] num-devices: 0
[2023-07-04 20:27:15] [config] optimizer: adam
[2023-07-04 20:27:15] [config] optimizer-delay: 1
[2023-07-04 20:27:15] [config] optimizer-params:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] output-omit-bias: false
[2023-07-04 20:27:15] [config] overwrite: true
[2023-07-04 20:27:15] [config] precision:
[2023-07-04 20:27:15] [config]   - float32
[2023-07-04 20:27:15] [config]   - float32
[2023-07-04 20:27:15] [config] pretrained-model: ""
[2023-07-04 20:27:15] [config] quantize-biases: false
[2023-07-04 20:27:15] [config] quantize-bits: 0
[2023-07-04 20:27:15] [config] quantize-log-based: false
[2023-07-04 20:27:15] [config] quantize-optimization-steps: 0
[2023-07-04 20:27:15] [config] quiet: false
[2023-07-04 20:27:15] [config] quiet-translation: true
[2023-07-04 20:27:15] [config] relative-paths: false
[2023-07-04 20:27:15] [config] right-left: false
[2023-07-04 20:27:15] [config] save-freq: 10000u
[2023-07-04 20:27:15] [config] seed: 1234
[2023-07-04 20:27:15] [config] sentencepiece-alphas:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:27:15] [config] sentencepiece-options: ""
[2023-07-04 20:27:15] [config] sharding: global
[2023-07-04 20:27:15] [config] shuffle: data
[2023-07-04 20:27:15] [config] shuffle-in-ram: false
[2023-07-04 20:27:15] [config] sigterm: save-and-exit
[2023-07-04 20:27:15] [config] skip: false
[2023-07-04 20:27:15] [config] sqlite: ""
[2023-07-04 20:27:15] [config] sqlite-drop: false
[2023-07-04 20:27:15] [config] sync-freq: 200u
[2023-07-04 20:27:15] [config] sync-sgd: false
[2023-07-04 20:27:15] [config] tempdir: /tmp
[2023-07-04 20:27:15] [config] tied-embeddings: false
[2023-07-04 20:27:15] [config] tied-embeddings-all: false
[2023-07-04 20:27:15] [config] tied-embeddings-src: false
[2023-07-04 20:27:15] [config] train-embedder-rank:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] train-sets:
[2023-07-04 20:27:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:27:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:27:15] [config] transformer-aan-activation: swish
[2023-07-04 20:27:15] [config] transformer-aan-depth: 2
[2023-07-04 20:27:15] [config] transformer-aan-nogate: false
[2023-07-04 20:27:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:27:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:27:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:27:15] [config] transformer-depth-scaling: false
[2023-07-04 20:27:15] [config] transformer-dim-aan: 2048
[2023-07-04 20:27:15] [config] transformer-dim-ffn: 2048
[2023-07-04 20:27:15] [config] transformer-dropout: 0
[2023-07-04 20:27:15] [config] transformer-dropout-attention: 0
[2023-07-04 20:27:15] [config] transformer-dropout-ffn: 0
[2023-07-04 20:27:15] [config] transformer-ffn-activation: swish
[2023-07-04 20:27:15] [config] transformer-ffn-depth: 2
[2023-07-04 20:27:15] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:27:15] [config] transformer-heads: 8
[2023-07-04 20:27:15] [config] transformer-no-projection: false
[2023-07-04 20:27:15] [config] transformer-pool: false
[2023-07-04 20:27:15] [config] transformer-postprocess: dan
[2023-07-04 20:27:15] [config] transformer-postprocess-emb: d
[2023-07-04 20:27:15] [config] transformer-postprocess-top: ""
[2023-07-04 20:27:15] [config] transformer-preprocess: ""
[2023-07-04 20:27:15] [config] transformer-tied-layers:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] transformer-train-position-embeddings: false
[2023-07-04 20:27:15] [config] tsv: false
[2023-07-04 20:27:15] [config] tsv-fields: 0
[2023-07-04 20:27:15] [config] type: transformer
[2023-07-04 20:27:15] [config] ulr: false
[2023-07-04 20:27:15] [config] ulr-dim-emb: 0
[2023-07-04 20:27:15] [config] ulr-dropout: 0
[2023-07-04 20:27:15] [config] ulr-keys-vectors: ""
[2023-07-04 20:27:15] [config] ulr-query-vectors: ""
[2023-07-04 20:27:15] [config] ulr-softmax-temperature: 1
[2023-07-04 20:27:15] [config] ulr-trainable-transformation: false
[2023-07-04 20:27:15] [config] unlikelihood-loss: false
[2023-07-04 20:27:15] [config] valid-freq: 50000000
[2023-07-04 20:27:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:27:15] [config] valid-max-length: 1000
[2023-07-04 20:27:15] [config] valid-metrics:
[2023-07-04 20:27:15] [config]   - cross-entropy
[2023-07-04 20:27:15] [config]   - translation
[2023-07-04 20:27:15] [config] valid-mini-batch: 32
[2023-07-04 20:27:15] [config] valid-reset-stalled: false
[2023-07-04 20:27:15] [config] valid-script-args:
[2023-07-04 20:27:15] [config]   []
[2023-07-04 20:27:15] [config] valid-script-path: ""
[2023-07-04 20:27:15] [config] valid-sets:
[2023-07-04 20:27:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:27:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:27:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:27:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:27:15] [config] vocabs:
[2023-07-04 20:27:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:27:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:27:15] [config] word-penalty: 0
[2023-07-04 20:27:15] [config] word-scores: false
[2023-07-04 20:27:15] [config] workspace: 2048
[2023-07-04 20:27:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:27:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:27:15] [training] Using single-device training
[2023-07-04 20:27:16] Synced seed 1234
[2023-07-04 20:27:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:27:16] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:27:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:27:16] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:27:16] [valid] No post-processing script given for validating translator
[2023-07-04 20:27:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:27:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:27:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:27:17] [comm] Using global sharding
[2023-07-04 20:27:17] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:27:17] [training] Using 1 GPUs
[2023-07-04 20:27:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:27:19] Loading Adam parameters
[2023-07-04 20:27:19] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:27:20] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:27:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:27:20] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-07-04 20:27:20] [data] Shuffling data
[2023-07-04 20:27:20] [data] Done reading 20,192 sentences
[2023-07-04 20:27:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:27:20] Training started
[2023-07-04 20:27:20] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:27:20] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:27:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:27:20] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:27:20] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:27:28] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 0.01703558 * 1,335,380 @ 968 after 16,100,218 : Time 11.57s : 115393.41 words/s : gNorm 0.5494
[2023-07-04 20:27:38] Seen 18,843 samples
[2023-07-04 20:27:38] Starting data epoch 42 in logical epoch 42
[2023-07-04 20:27:38] [data] Shuffling data
[2023-07-04 20:27:38] [data] Done reading 20,192 sentences
[2023-07-04 20:27:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:28:00] Seen 18,843 samples
[2023-07-04 20:28:00] Starting data epoch 43 in logical epoch 43
[2023-07-04 20:28:00] [data] Shuffling data
[2023-07-04 20:28:00] [data] Done reading 20,192 sentences
[2023-07-04 20:28:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:28:22] Seen 18,843 samples
[2023-07-04 20:28:22] Starting data epoch 44 in logical epoch 44
[2023-07-04 20:28:22] [data] Shuffling data
[2023-07-04 20:28:22] [data] Done reading 20,192 sentences
[2023-07-04 20:28:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:28:42] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 0.01556935 * 1,337,866 @ 718 after 17,438,084 : Time 73.74s : 18143.23 words/s : gNorm 0.5972
[2023-07-04 20:28:46] Seen 18,843 samples
[2023-07-04 20:28:46] Starting data epoch 45 in logical epoch 45
[2023-07-04 20:28:46] [data] Shuffling data
[2023-07-04 20:28:46] [data] Done reading 20,192 sentences
[2023-07-04 20:28:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:29:09] Seen 18,843 samples
[2023-07-04 20:29:09] Starting data epoch 46 in logical epoch 46
[2023-07-04 20:29:09] [data] Shuffling data
[2023-07-04 20:29:09] [data] Done reading 20,192 sentences
[2023-07-04 20:29:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:29:32] Seen 18,843 samples
[2023-07-04 20:29:32] Starting data epoch 47 in logical epoch 47
[2023-07-04 20:29:32] [data] Shuffling data
[2023-07-04 20:29:32] [data] Done reading 20,192 sentences
[2023-07-04 20:29:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:29:55] Seen 18,843 samples
[2023-07-04 20:29:55] Starting data epoch 48 in logical epoch 48
[2023-07-04 20:29:55] [data] Shuffling data
[2023-07-04 20:29:55] [data] Done reading 20,192 sentences
[2023-07-04 20:29:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:30:00] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 0.01434957 * 1,348,446 @ 1,408 after 18,786,530 : Time 78.51s : 17175.52 words/s : gNorm 0.6074
[2023-07-04 20:30:18] Seen 18,843 samples
[2023-07-04 20:30:18] Starting data epoch 49 in logical epoch 49
[2023-07-04 20:30:18] [data] Shuffling data
[2023-07-04 20:30:18] [data] Done reading 20,192 sentences
[2023-07-04 20:30:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:30:41] Seen 18,843 samples
[2023-07-04 20:30:41] Starting data epoch 50 in logical epoch 50
[2023-07-04 20:30:41] [data] Shuffling data
[2023-07-04 20:30:41] [data] Done reading 20,192 sentences
[2023-07-04 20:30:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:31:04] Seen 18,843 samples
[2023-07-04 20:31:04] Starting data epoch 51 in logical epoch 51
[2023-07-04 20:31:04] Training finished
[2023-07-04 20:31:07] [valid] Ep. 51 : Up. 14829 : cross-entropy : 179.685 : stalled 4 times (last best: 125.788)
[2023-07-04 20:33:55] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-07-04 20:33:55] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:33:58] Saving Adam parameters
[2023-07-04 20:33:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:34:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:34:09] [marian] Running on node07.datos.cluster.uy as process 17118 with command line:
[2023-07-04 20:34:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:34:09] [config] after: 0e
[2023-07-04 20:34:09] [config] after-batches: 0
[2023-07-04 20:34:09] [config] after-epochs: 60
[2023-07-04 20:34:09] [config] all-caps-every: 0
[2023-07-04 20:34:09] [config] allow-unk: false
[2023-07-04 20:34:09] [config] authors: false
[2023-07-04 20:34:09] [config] beam-size: 12
[2023-07-04 20:34:09] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:34:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:34:09] [config] bert-masking-fraction: 0.15
[2023-07-04 20:34:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:34:09] [config] bert-train-type-embeddings: true
[2023-07-04 20:34:09] [config] bert-type-vocab-size: 2
[2023-07-04 20:34:09] [config] build-info: ""
[2023-07-04 20:34:09] [config] check-gradient-nan: false
[2023-07-04 20:34:09] [config] check-nan: false
[2023-07-04 20:34:09] [config] cite: false
[2023-07-04 20:34:09] [config] clip-norm: 1
[2023-07-04 20:34:09] [config] cost-scaling:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] cost-type: ce-sum
[2023-07-04 20:34:09] [config] cpu-threads: 0
[2023-07-04 20:34:09] [config] data-threads: 8
[2023-07-04 20:34:09] [config] data-weighting: ""
[2023-07-04 20:34:09] [config] data-weighting-type: sentence
[2023-07-04 20:34:09] [config] dec-cell: gru
[2023-07-04 20:34:09] [config] dec-cell-base-depth: 2
[2023-07-04 20:34:09] [config] dec-cell-high-depth: 1
[2023-07-04 20:34:09] [config] dec-depth: 1
[2023-07-04 20:34:09] [config] devices:
[2023-07-04 20:34:09] [config]   - 0
[2023-07-04 20:34:09] [config] dim-emb: 512
[2023-07-04 20:34:09] [config] dim-rnn: 1024
[2023-07-04 20:34:09] [config] dim-vocabs:
[2023-07-04 20:34:09] [config]   - 54042
[2023-07-04 20:34:09] [config]   - 36507
[2023-07-04 20:34:09] [config] disp-first: 0
[2023-07-04 20:34:09] [config] disp-freq: 1000u
[2023-07-04 20:34:09] [config] disp-label-counts: true
[2023-07-04 20:34:09] [config] dropout-rnn: 0
[2023-07-04 20:34:09] [config] dropout-src: 0
[2023-07-04 20:34:09] [config] dropout-trg: 0
[2023-07-04 20:34:09] [config] dump-config: ""
[2023-07-04 20:34:09] [config] dynamic-gradient-scaling:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] early-stopping: 10
[2023-07-04 20:34:09] [config] early-stopping-on: first
[2023-07-04 20:34:09] [config] embedding-fix-src: false
[2023-07-04 20:34:09] [config] embedding-fix-trg: false
[2023-07-04 20:34:09] [config] embedding-normalization: false
[2023-07-04 20:34:09] [config] embedding-vectors:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] enc-cell: gru
[2023-07-04 20:34:09] [config] enc-cell-depth: 1
[2023-07-04 20:34:09] [config] enc-depth: 1
[2023-07-04 20:34:09] [config] enc-type: bidirectional
[2023-07-04 20:34:09] [config] english-title-case-every: 0
[2023-07-04 20:34:09] [config] exponential-smoothing: 0
[2023-07-04 20:34:09] [config] factor-weight: 1
[2023-07-04 20:34:09] [config] factors-combine: sum
[2023-07-04 20:34:09] [config] factors-dim-emb: 0
[2023-07-04 20:34:09] [config] gradient-checkpointing: false
[2023-07-04 20:34:09] [config] gradient-norm-average-window: 100
[2023-07-04 20:34:09] [config] guided-alignment: none
[2023-07-04 20:34:09] [config] guided-alignment-cost: mse
[2023-07-04 20:34:09] [config] guided-alignment-weight: 0.1
[2023-07-04 20:34:09] [config] ignore-model-config: false
[2023-07-04 20:34:09] [config] input-types:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] interpolate-env-vars: false
[2023-07-04 20:34:09] [config] keep-best: false
[2023-07-04 20:34:09] [config] label-smoothing: 0
[2023-07-04 20:34:09] [config] layer-normalization: false
[2023-07-04 20:34:09] [config] learn-rate: 0.0001
[2023-07-04 20:34:09] [config] lemma-dependency: ""
[2023-07-04 20:34:09] [config] lemma-dim-emb: 0
[2023-07-04 20:34:09] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:34:09] [config] log-level: info
[2023-07-04 20:34:09] [config] log-time-zone: ""
[2023-07-04 20:34:09] [config] logical-epoch:
[2023-07-04 20:34:09] [config]   - 1e
[2023-07-04 20:34:09] [config]   - 0
[2023-07-04 20:34:09] [config] lr-decay: 0
[2023-07-04 20:34:09] [config] lr-decay-freq: 50000
[2023-07-04 20:34:09] [config] lr-decay-inv-sqrt:
[2023-07-04 20:34:09] [config]   - 0
[2023-07-04 20:34:09] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:34:09] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:34:09] [config] lr-decay-start:
[2023-07-04 20:34:09] [config]   - 10
[2023-07-04 20:34:09] [config]   - 1
[2023-07-04 20:34:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:34:09] [config] lr-report: false
[2023-07-04 20:34:09] [config] lr-warmup: 0
[2023-07-04 20:34:09] [config] lr-warmup-at-reload: false
[2023-07-04 20:34:09] [config] lr-warmup-cycle: false
[2023-07-04 20:34:09] [config] lr-warmup-start-rate: 0
[2023-07-04 20:34:09] [config] max-length: 50
[2023-07-04 20:34:09] [config] max-length-crop: false
[2023-07-04 20:34:09] [config] max-length-factor: 3
[2023-07-04 20:34:09] [config] maxi-batch: 100
[2023-07-04 20:34:09] [config] maxi-batch-sort: trg
[2023-07-04 20:34:09] [config] mini-batch: 64
[2023-07-04 20:34:09] [config] mini-batch-fit: false
[2023-07-04 20:34:09] [config] mini-batch-fit-step: 10
[2023-07-04 20:34:09] [config] mini-batch-round-up: true
[2023-07-04 20:34:09] [config] mini-batch-track-lr: false
[2023-07-04 20:34:09] [config] mini-batch-warmup: 0
[2023-07-04 20:34:09] [config] mini-batch-words: 0
[2023-07-04 20:34:09] [config] mini-batch-words-ref: 0
[2023-07-04 20:34:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:34:09] [config] multi-loss-type: sum
[2023-07-04 20:34:09] [config] n-best: false
[2023-07-04 20:34:09] [config] no-nccl: false
[2023-07-04 20:34:09] [config] no-reload: false
[2023-07-04 20:34:09] [config] no-restore-corpus: false
[2023-07-04 20:34:09] [config] normalize: 0
[2023-07-04 20:34:09] [config] normalize-gradient: false
[2023-07-04 20:34:09] [config] num-devices: 0
[2023-07-04 20:34:09] [config] optimizer: adam
[2023-07-04 20:34:09] [config] optimizer-delay: 1
[2023-07-04 20:34:09] [config] optimizer-params:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] output-omit-bias: false
[2023-07-04 20:34:09] [config] overwrite: true
[2023-07-04 20:34:09] [config] precision:
[2023-07-04 20:34:09] [config]   - float32
[2023-07-04 20:34:09] [config]   - float32
[2023-07-04 20:34:09] [config] pretrained-model: ""
[2023-07-04 20:34:09] [config] quantize-biases: false
[2023-07-04 20:34:09] [config] quantize-bits: 0
[2023-07-04 20:34:09] [config] quantize-log-based: false
[2023-07-04 20:34:09] [config] quantize-optimization-steps: 0
[2023-07-04 20:34:09] [config] quiet: false
[2023-07-04 20:34:09] [config] quiet-translation: true
[2023-07-04 20:34:09] [config] relative-paths: false
[2023-07-04 20:34:09] [config] right-left: false
[2023-07-04 20:34:09] [config] save-freq: 10000u
[2023-07-04 20:34:09] [config] seed: 1234
[2023-07-04 20:34:09] [config] sentencepiece-alphas:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:34:09] [config] sentencepiece-options: ""
[2023-07-04 20:34:09] [config] sharding: global
[2023-07-04 20:34:09] [config] shuffle: data
[2023-07-04 20:34:09] [config] shuffle-in-ram: false
[2023-07-04 20:34:09] [config] sigterm: save-and-exit
[2023-07-04 20:34:09] [config] skip: false
[2023-07-04 20:34:09] [config] sqlite: ""
[2023-07-04 20:34:09] [config] sqlite-drop: false
[2023-07-04 20:34:09] [config] sync-freq: 200u
[2023-07-04 20:34:09] [config] sync-sgd: false
[2023-07-04 20:34:09] [config] tempdir: /tmp
[2023-07-04 20:34:09] [config] tied-embeddings: false
[2023-07-04 20:34:09] [config] tied-embeddings-all: false
[2023-07-04 20:34:09] [config] tied-embeddings-src: false
[2023-07-04 20:34:09] [config] train-embedder-rank:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] train-sets:
[2023-07-04 20:34:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:34:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:34:09] [config] transformer-aan-activation: swish
[2023-07-04 20:34:09] [config] transformer-aan-depth: 2
[2023-07-04 20:34:09] [config] transformer-aan-nogate: false
[2023-07-04 20:34:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:34:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:34:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:34:09] [config] transformer-depth-scaling: false
[2023-07-04 20:34:09] [config] transformer-dim-aan: 2048
[2023-07-04 20:34:09] [config] transformer-dim-ffn: 2048
[2023-07-04 20:34:09] [config] transformer-dropout: 0
[2023-07-04 20:34:09] [config] transformer-dropout-attention: 0
[2023-07-04 20:34:09] [config] transformer-dropout-ffn: 0
[2023-07-04 20:34:09] [config] transformer-ffn-activation: swish
[2023-07-04 20:34:09] [config] transformer-ffn-depth: 2
[2023-07-04 20:34:09] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:34:09] [config] transformer-heads: 8
[2023-07-04 20:34:09] [config] transformer-no-projection: false
[2023-07-04 20:34:09] [config] transformer-pool: false
[2023-07-04 20:34:09] [config] transformer-postprocess: dan
[2023-07-04 20:34:09] [config] transformer-postprocess-emb: d
[2023-07-04 20:34:09] [config] transformer-postprocess-top: ""
[2023-07-04 20:34:09] [config] transformer-preprocess: ""
[2023-07-04 20:34:09] [config] transformer-tied-layers:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] transformer-train-position-embeddings: false
[2023-07-04 20:34:09] [config] tsv: false
[2023-07-04 20:34:09] [config] tsv-fields: 0
[2023-07-04 20:34:09] [config] type: transformer
[2023-07-04 20:34:09] [config] ulr: false
[2023-07-04 20:34:09] [config] ulr-dim-emb: 0
[2023-07-04 20:34:09] [config] ulr-dropout: 0
[2023-07-04 20:34:09] [config] ulr-keys-vectors: ""
[2023-07-04 20:34:09] [config] ulr-query-vectors: ""
[2023-07-04 20:34:09] [config] ulr-softmax-temperature: 1
[2023-07-04 20:34:09] [config] ulr-trainable-transformation: false
[2023-07-04 20:34:09] [config] unlikelihood-loss: false
[2023-07-04 20:34:09] [config] valid-freq: 50000000
[2023-07-04 20:34:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:34:09] [config] valid-max-length: 1000
[2023-07-04 20:34:09] [config] valid-metrics:
[2023-07-04 20:34:09] [config]   - cross-entropy
[2023-07-04 20:34:09] [config]   - translation
[2023-07-04 20:34:09] [config] valid-mini-batch: 32
[2023-07-04 20:34:09] [config] valid-reset-stalled: false
[2023-07-04 20:34:09] [config] valid-script-args:
[2023-07-04 20:34:09] [config]   []
[2023-07-04 20:34:09] [config] valid-script-path: ""
[2023-07-04 20:34:09] [config] valid-sets:
[2023-07-04 20:34:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:34:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:34:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:34:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:34:09] [config] vocabs:
[2023-07-04 20:34:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:34:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:34:09] [config] word-penalty: 0
[2023-07-04 20:34:09] [config] word-scores: false
[2023-07-04 20:34:09] [config] workspace: 2048
[2023-07-04 20:34:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:34:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:34:09] [training] Using single-device training
[2023-07-04 20:34:10] Synced seed 1234
[2023-07-04 20:34:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:34:10] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:34:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:34:10] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:34:10] [valid] No post-processing script given for validating translator
[2023-07-04 20:34:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:34:10] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:34:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:34:11] [comm] Using global sharding
[2023-07-04 20:34:11] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:34:11] [training] Using 1 GPUs
[2023-07-04 20:34:11] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:34:13] Loading Adam parameters
[2023-07-04 20:34:13] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:34:13] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:34:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:34:13] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-07-04 20:34:13] [data] Shuffling data
[2023-07-04 20:34:13] [data] Done reading 20,192 sentences
[2023-07-04 20:34:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:34:13] Training started
[2023-07-04 20:34:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:34:13] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:34:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:34:13] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:34:13] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:34:23] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 0.01314344 * 1,333,303 @ 559 after 20,119,833 : Time 13.53s : 98566.85 words/s : gNorm 0.5650
[2023-07-04 20:34:32] Seen 18,843 samples
[2023-07-04 20:34:32] Starting data epoch 52 in logical epoch 52
[2023-07-04 20:34:32] [data] Shuffling data
[2023-07-04 20:34:32] [data] Done reading 20,192 sentences
[2023-07-04 20:34:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:34:54] Seen 18,843 samples
[2023-07-04 20:34:54] Starting data epoch 53 in logical epoch 53
[2023-07-04 20:34:54] [data] Shuffling data
[2023-07-04 20:34:54] [data] Done reading 20,192 sentences
[2023-07-04 20:34:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:35:17] Seen 18,843 samples
[2023-07-04 20:35:17] Starting data epoch 54 in logical epoch 54
[2023-07-04 20:35:17] [data] Shuffling data
[2023-07-04 20:35:17] [data] Done reading 20,192 sentences
[2023-07-04 20:35:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:35:38] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 0.01192423 * 1,343,441 @ 128 after 21,463,274 : Time 75.06s : 17897.05 words/s : gNorm 0.5711
[2023-07-04 20:35:40] Seen 18,843 samples
[2023-07-04 20:35:40] Starting data epoch 55 in logical epoch 55
[2023-07-04 20:35:40] [data] Shuffling data
[2023-07-04 20:35:40] [data] Done reading 20,192 sentences
[2023-07-04 20:35:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:36:02] Seen 18,843 samples
[2023-07-04 20:36:02] Starting data epoch 56 in logical epoch 56
[2023-07-04 20:36:02] [data] Shuffling data
[2023-07-04 20:36:02] [data] Done reading 20,192 sentences
[2023-07-04 20:36:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:36:26] Seen 18,843 samples
[2023-07-04 20:36:26] Starting data epoch 57 in logical epoch 57
[2023-07-04 20:36:26] [data] Shuffling data
[2023-07-04 20:36:26] [data] Done reading 20,192 sentences
[2023-07-04 20:36:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:36:49] Seen 18,843 samples
[2023-07-04 20:36:49] Starting data epoch 58 in logical epoch 58
[2023-07-04 20:36:49] [data] Shuffling data
[2023-07-04 20:36:49] [data] Done reading 20,192 sentences
[2023-07-04 20:36:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:36:57] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 0.01123328 * 1,347,361 @ 2,048 after 22,810,635 : Time 79.15s : 17023.45 words/s : gNorm 0.5060
[2023-07-04 20:37:14] Seen 18,843 samples
[2023-07-04 20:37:14] Starting data epoch 59 in logical epoch 59
[2023-07-04 20:37:14] [data] Shuffling data
[2023-07-04 20:37:14] [data] Done reading 20,192 sentences
[2023-07-04 20:37:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:37:36] Seen 18,843 samples
[2023-07-04 20:37:36] Starting data epoch 60 in logical epoch 60
[2023-07-04 20:37:36] [data] Shuffling data
[2023-07-04 20:37:36] [data] Done reading 20,192 sentences
[2023-07-04 20:37:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:37:58] Seen 18,843 samples
[2023-07-04 20:37:58] Starting data epoch 61 in logical epoch 61
[2023-07-04 20:37:58] Training finished
[2023-07-04 20:38:01] [valid] Ep. 61 : Up. 17795 : cross-entropy : 187.205 : stalled 5 times (last best: 125.788)
[2023-07-04 20:40:17] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-07-04 20:40:17] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:40:20] Saving Adam parameters
[2023-07-04 20:40:21] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:40:33] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:40:33] [marian] Running on node07.datos.cluster.uy as process 17495 with command line:
[2023-07-04 20:40:33] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:40:33] [config] after: 0e
[2023-07-04 20:40:33] [config] after-batches: 0
[2023-07-04 20:40:33] [config] after-epochs: 70
[2023-07-04 20:40:33] [config] all-caps-every: 0
[2023-07-04 20:40:33] [config] allow-unk: false
[2023-07-04 20:40:33] [config] authors: false
[2023-07-04 20:40:33] [config] beam-size: 12
[2023-07-04 20:40:33] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:40:33] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:40:33] [config] bert-masking-fraction: 0.15
[2023-07-04 20:40:33] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:40:33] [config] bert-train-type-embeddings: true
[2023-07-04 20:40:33] [config] bert-type-vocab-size: 2
[2023-07-04 20:40:33] [config] build-info: ""
[2023-07-04 20:40:33] [config] check-gradient-nan: false
[2023-07-04 20:40:33] [config] check-nan: false
[2023-07-04 20:40:33] [config] cite: false
[2023-07-04 20:40:33] [config] clip-norm: 1
[2023-07-04 20:40:33] [config] cost-scaling:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] cost-type: ce-sum
[2023-07-04 20:40:33] [config] cpu-threads: 0
[2023-07-04 20:40:33] [config] data-threads: 8
[2023-07-04 20:40:33] [config] data-weighting: ""
[2023-07-04 20:40:33] [config] data-weighting-type: sentence
[2023-07-04 20:40:33] [config] dec-cell: gru
[2023-07-04 20:40:33] [config] dec-cell-base-depth: 2
[2023-07-04 20:40:33] [config] dec-cell-high-depth: 1
[2023-07-04 20:40:33] [config] dec-depth: 1
[2023-07-04 20:40:33] [config] devices:
[2023-07-04 20:40:33] [config]   - 0
[2023-07-04 20:40:33] [config] dim-emb: 512
[2023-07-04 20:40:33] [config] dim-rnn: 1024
[2023-07-04 20:40:33] [config] dim-vocabs:
[2023-07-04 20:40:33] [config]   - 54042
[2023-07-04 20:40:33] [config]   - 36507
[2023-07-04 20:40:33] [config] disp-first: 0
[2023-07-04 20:40:33] [config] disp-freq: 1000u
[2023-07-04 20:40:33] [config] disp-label-counts: true
[2023-07-04 20:40:33] [config] dropout-rnn: 0
[2023-07-04 20:40:33] [config] dropout-src: 0
[2023-07-04 20:40:33] [config] dropout-trg: 0
[2023-07-04 20:40:33] [config] dump-config: ""
[2023-07-04 20:40:33] [config] dynamic-gradient-scaling:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] early-stopping: 10
[2023-07-04 20:40:33] [config] early-stopping-on: first
[2023-07-04 20:40:33] [config] embedding-fix-src: false
[2023-07-04 20:40:33] [config] embedding-fix-trg: false
[2023-07-04 20:40:33] [config] embedding-normalization: false
[2023-07-04 20:40:33] [config] embedding-vectors:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] enc-cell: gru
[2023-07-04 20:40:33] [config] enc-cell-depth: 1
[2023-07-04 20:40:33] [config] enc-depth: 1
[2023-07-04 20:40:33] [config] enc-type: bidirectional
[2023-07-04 20:40:33] [config] english-title-case-every: 0
[2023-07-04 20:40:33] [config] exponential-smoothing: 0
[2023-07-04 20:40:33] [config] factor-weight: 1
[2023-07-04 20:40:33] [config] factors-combine: sum
[2023-07-04 20:40:33] [config] factors-dim-emb: 0
[2023-07-04 20:40:33] [config] gradient-checkpointing: false
[2023-07-04 20:40:33] [config] gradient-norm-average-window: 100
[2023-07-04 20:40:33] [config] guided-alignment: none
[2023-07-04 20:40:33] [config] guided-alignment-cost: mse
[2023-07-04 20:40:33] [config] guided-alignment-weight: 0.1
[2023-07-04 20:40:33] [config] ignore-model-config: false
[2023-07-04 20:40:33] [config] input-types:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] interpolate-env-vars: false
[2023-07-04 20:40:33] [config] keep-best: false
[2023-07-04 20:40:33] [config] label-smoothing: 0
[2023-07-04 20:40:33] [config] layer-normalization: false
[2023-07-04 20:40:33] [config] learn-rate: 0.0001
[2023-07-04 20:40:33] [config] lemma-dependency: ""
[2023-07-04 20:40:33] [config] lemma-dim-emb: 0
[2023-07-04 20:40:33] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:40:33] [config] log-level: info
[2023-07-04 20:40:33] [config] log-time-zone: ""
[2023-07-04 20:40:33] [config] logical-epoch:
[2023-07-04 20:40:33] [config]   - 1e
[2023-07-04 20:40:33] [config]   - 0
[2023-07-04 20:40:33] [config] lr-decay: 0
[2023-07-04 20:40:33] [config] lr-decay-freq: 50000
[2023-07-04 20:40:33] [config] lr-decay-inv-sqrt:
[2023-07-04 20:40:33] [config]   - 0
[2023-07-04 20:40:33] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:40:33] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:40:33] [config] lr-decay-start:
[2023-07-04 20:40:33] [config]   - 10
[2023-07-04 20:40:33] [config]   - 1
[2023-07-04 20:40:33] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:40:33] [config] lr-report: false
[2023-07-04 20:40:33] [config] lr-warmup: 0
[2023-07-04 20:40:33] [config] lr-warmup-at-reload: false
[2023-07-04 20:40:33] [config] lr-warmup-cycle: false
[2023-07-04 20:40:33] [config] lr-warmup-start-rate: 0
[2023-07-04 20:40:33] [config] max-length: 50
[2023-07-04 20:40:33] [config] max-length-crop: false
[2023-07-04 20:40:33] [config] max-length-factor: 3
[2023-07-04 20:40:33] [config] maxi-batch: 100
[2023-07-04 20:40:33] [config] maxi-batch-sort: trg
[2023-07-04 20:40:33] [config] mini-batch: 64
[2023-07-04 20:40:33] [config] mini-batch-fit: false
[2023-07-04 20:40:33] [config] mini-batch-fit-step: 10
[2023-07-04 20:40:33] [config] mini-batch-round-up: true
[2023-07-04 20:40:33] [config] mini-batch-track-lr: false
[2023-07-04 20:40:33] [config] mini-batch-warmup: 0
[2023-07-04 20:40:33] [config] mini-batch-words: 0
[2023-07-04 20:40:33] [config] mini-batch-words-ref: 0
[2023-07-04 20:40:33] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:40:33] [config] multi-loss-type: sum
[2023-07-04 20:40:33] [config] n-best: false
[2023-07-04 20:40:33] [config] no-nccl: false
[2023-07-04 20:40:33] [config] no-reload: false
[2023-07-04 20:40:33] [config] no-restore-corpus: false
[2023-07-04 20:40:33] [config] normalize: 0
[2023-07-04 20:40:33] [config] normalize-gradient: false
[2023-07-04 20:40:33] [config] num-devices: 0
[2023-07-04 20:40:33] [config] optimizer: adam
[2023-07-04 20:40:33] [config] optimizer-delay: 1
[2023-07-04 20:40:33] [config] optimizer-params:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] output-omit-bias: false
[2023-07-04 20:40:33] [config] overwrite: true
[2023-07-04 20:40:33] [config] precision:
[2023-07-04 20:40:33] [config]   - float32
[2023-07-04 20:40:33] [config]   - float32
[2023-07-04 20:40:33] [config] pretrained-model: ""
[2023-07-04 20:40:33] [config] quantize-biases: false
[2023-07-04 20:40:33] [config] quantize-bits: 0
[2023-07-04 20:40:33] [config] quantize-log-based: false
[2023-07-04 20:40:33] [config] quantize-optimization-steps: 0
[2023-07-04 20:40:33] [config] quiet: false
[2023-07-04 20:40:33] [config] quiet-translation: true
[2023-07-04 20:40:33] [config] relative-paths: false
[2023-07-04 20:40:33] [config] right-left: false
[2023-07-04 20:40:33] [config] save-freq: 10000u
[2023-07-04 20:40:33] [config] seed: 1234
[2023-07-04 20:40:33] [config] sentencepiece-alphas:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:40:33] [config] sentencepiece-options: ""
[2023-07-04 20:40:33] [config] sharding: global
[2023-07-04 20:40:33] [config] shuffle: data
[2023-07-04 20:40:33] [config] shuffle-in-ram: false
[2023-07-04 20:40:33] [config] sigterm: save-and-exit
[2023-07-04 20:40:33] [config] skip: false
[2023-07-04 20:40:33] [config] sqlite: ""
[2023-07-04 20:40:33] [config] sqlite-drop: false
[2023-07-04 20:40:33] [config] sync-freq: 200u
[2023-07-04 20:40:33] [config] sync-sgd: false
[2023-07-04 20:40:33] [config] tempdir: /tmp
[2023-07-04 20:40:33] [config] tied-embeddings: false
[2023-07-04 20:40:33] [config] tied-embeddings-all: false
[2023-07-04 20:40:33] [config] tied-embeddings-src: false
[2023-07-04 20:40:33] [config] train-embedder-rank:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] train-sets:
[2023-07-04 20:40:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:40:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:40:33] [config] transformer-aan-activation: swish
[2023-07-04 20:40:33] [config] transformer-aan-depth: 2
[2023-07-04 20:40:33] [config] transformer-aan-nogate: false
[2023-07-04 20:40:33] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:40:33] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:40:33] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:40:33] [config] transformer-depth-scaling: false
[2023-07-04 20:40:33] [config] transformer-dim-aan: 2048
[2023-07-04 20:40:33] [config] transformer-dim-ffn: 2048
[2023-07-04 20:40:33] [config] transformer-dropout: 0
[2023-07-04 20:40:33] [config] transformer-dropout-attention: 0
[2023-07-04 20:40:33] [config] transformer-dropout-ffn: 0
[2023-07-04 20:40:33] [config] transformer-ffn-activation: swish
[2023-07-04 20:40:33] [config] transformer-ffn-depth: 2
[2023-07-04 20:40:33] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:40:33] [config] transformer-heads: 8
[2023-07-04 20:40:33] [config] transformer-no-projection: false
[2023-07-04 20:40:33] [config] transformer-pool: false
[2023-07-04 20:40:33] [config] transformer-postprocess: dan
[2023-07-04 20:40:33] [config] transformer-postprocess-emb: d
[2023-07-04 20:40:33] [config] transformer-postprocess-top: ""
[2023-07-04 20:40:33] [config] transformer-preprocess: ""
[2023-07-04 20:40:33] [config] transformer-tied-layers:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] transformer-train-position-embeddings: false
[2023-07-04 20:40:33] [config] tsv: false
[2023-07-04 20:40:33] [config] tsv-fields: 0
[2023-07-04 20:40:33] [config] type: transformer
[2023-07-04 20:40:33] [config] ulr: false
[2023-07-04 20:40:33] [config] ulr-dim-emb: 0
[2023-07-04 20:40:33] [config] ulr-dropout: 0
[2023-07-04 20:40:33] [config] ulr-keys-vectors: ""
[2023-07-04 20:40:33] [config] ulr-query-vectors: ""
[2023-07-04 20:40:33] [config] ulr-softmax-temperature: 1
[2023-07-04 20:40:33] [config] ulr-trainable-transformation: false
[2023-07-04 20:40:33] [config] unlikelihood-loss: false
[2023-07-04 20:40:33] [config] valid-freq: 50000000
[2023-07-04 20:40:33] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:40:33] [config] valid-max-length: 1000
[2023-07-04 20:40:33] [config] valid-metrics:
[2023-07-04 20:40:33] [config]   - cross-entropy
[2023-07-04 20:40:33] [config]   - translation
[2023-07-04 20:40:33] [config] valid-mini-batch: 32
[2023-07-04 20:40:33] [config] valid-reset-stalled: false
[2023-07-04 20:40:33] [config] valid-script-args:
[2023-07-04 20:40:33] [config]   []
[2023-07-04 20:40:33] [config] valid-script-path: ""
[2023-07-04 20:40:33] [config] valid-sets:
[2023-07-04 20:40:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:40:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:40:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:40:33] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:40:33] [config] vocabs:
[2023-07-04 20:40:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:40:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:40:33] [config] word-penalty: 0
[2023-07-04 20:40:33] [config] word-scores: false
[2023-07-04 20:40:33] [config] workspace: 2048
[2023-07-04 20:40:33] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:40:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:40:33] [training] Using single-device training
[2023-07-04 20:40:35] Synced seed 1234
[2023-07-04 20:40:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:40:36] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:40:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:40:36] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:40:36] [valid] No post-processing script given for validating translator
[2023-07-04 20:40:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:40:36] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:40:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:40:36] [comm] Using global sharding
[2023-07-04 20:40:37] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:40:37] [training] Using 1 GPUs
[2023-07-04 20:40:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:40:38] Loading Adam parameters
[2023-07-04 20:40:39] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:40:39] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:40:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:40:39] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-07-04 20:40:39] [data] Shuffling data
[2023-07-04 20:40:39] [data] Done reading 20,192 sentences
[2023-07-04 20:40:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:40:39] Training started
[2023-07-04 20:40:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:40:39] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:40:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:40:39] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:40:39] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:40:51] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 0.01034313 * 1,335,891 @ 1,435 after 24,146,526 : Time 15.54s : 85965.85 words/s : gNorm 0.4441
[2023-07-04 20:40:57] Seen 18,843 samples
[2023-07-04 20:40:57] Starting data epoch 62 in logical epoch 62
[2023-07-04 20:40:57] [data] Shuffling data
[2023-07-04 20:40:57] [data] Done reading 20,192 sentences
[2023-07-04 20:40:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:41:17] Seen 18,843 samples
[2023-07-04 20:41:17] Starting data epoch 63 in logical epoch 63
[2023-07-04 20:41:17] [data] Shuffling data
[2023-07-04 20:41:18] [data] Done reading 20,192 sentences
[2023-07-04 20:41:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:41:43] Seen 18,843 samples
[2023-07-04 20:41:43] Starting data epoch 64 in logical epoch 64
[2023-07-04 20:41:43] [data] Shuffling data
[2023-07-04 20:41:43] [data] Done reading 20,192 sentences
[2023-07-04 20:41:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:42:07] Seen 18,843 samples
[2023-07-04 20:42:07] Starting data epoch 65 in logical epoch 65
[2023-07-04 20:42:07] [data] Shuffling data
[2023-07-04 20:42:07] [data] Done reading 20,192 sentences
[2023-07-04 20:42:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:42:08] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 0.01015779 * 1,337,858 @ 479 after 25,484,384 : Time 77.12s : 17346.87 words/s : gNorm 0.5123
[2023-07-04 20:42:30] Seen 18,843 samples
[2023-07-04 20:42:30] Starting data epoch 66 in logical epoch 66
[2023-07-04 20:42:30] [data] Shuffling data
[2023-07-04 20:42:30] [data] Done reading 20,192 sentences
[2023-07-04 20:42:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:42:52] Seen 18,843 samples
[2023-07-04 20:42:52] Starting data epoch 67 in logical epoch 67
[2023-07-04 20:42:52] [data] Shuffling data
[2023-07-04 20:42:52] [data] Done reading 20,192 sentences
[2023-07-04 20:42:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:43:15] Seen 18,843 samples
[2023-07-04 20:43:15] Starting data epoch 68 in logical epoch 68
[2023-07-04 20:43:15] [data] Shuffling data
[2023-07-04 20:43:15] [data] Done reading 20,192 sentences
[2023-07-04 20:43:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:43:25] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 0.00940054 * 1,354,931 @ 1,600 after 26,839,315 : Time 76.67s : 17671.68 words/s : gNorm 0.4719
[2023-07-04 20:43:25] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:43:28] Saving Adam parameters
[2023-07-04 20:43:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:43:46] Seen 18,843 samples
[2023-07-04 20:43:46] Starting data epoch 69 in logical epoch 69
[2023-07-04 20:43:46] [data] Shuffling data
[2023-07-04 20:43:46] [data] Done reading 20,192 sentences
[2023-07-04 20:43:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:44:07] Seen 18,843 samples
[2023-07-04 20:44:07] Starting data epoch 70 in logical epoch 70
[2023-07-04 20:44:07] [data] Shuffling data
[2023-07-04 20:44:07] [data] Done reading 20,192 sentences
[2023-07-04 20:44:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:44:31] Seen 18,843 samples
[2023-07-04 20:44:31] Starting data epoch 71 in logical epoch 71
[2023-07-04 20:44:31] Training finished
[2023-07-04 20:44:34] [valid] Ep. 71 : Up. 20760 : cross-entropy : 190.304 : stalled 6 times (last best: 125.788)
[2023-07-04 20:47:06] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-07-04 20:47:06] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:47:09] Saving Adam parameters
[2023-07-04 20:47:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:47:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:47:20] [marian] Running on node07.datos.cluster.uy as process 18218 with command line:
[2023-07-04 20:47:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:47:20] [config] after: 0e
[2023-07-04 20:47:20] [config] after-batches: 0
[2023-07-04 20:47:20] [config] after-epochs: 80
[2023-07-04 20:47:20] [config] all-caps-every: 0
[2023-07-04 20:47:20] [config] allow-unk: false
[2023-07-04 20:47:20] [config] authors: false
[2023-07-04 20:47:20] [config] beam-size: 12
[2023-07-04 20:47:20] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:47:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:47:20] [config] bert-masking-fraction: 0.15
[2023-07-04 20:47:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:47:20] [config] bert-train-type-embeddings: true
[2023-07-04 20:47:20] [config] bert-type-vocab-size: 2
[2023-07-04 20:47:20] [config] build-info: ""
[2023-07-04 20:47:20] [config] check-gradient-nan: false
[2023-07-04 20:47:20] [config] check-nan: false
[2023-07-04 20:47:20] [config] cite: false
[2023-07-04 20:47:20] [config] clip-norm: 1
[2023-07-04 20:47:20] [config] cost-scaling:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] cost-type: ce-sum
[2023-07-04 20:47:20] [config] cpu-threads: 0
[2023-07-04 20:47:20] [config] data-threads: 8
[2023-07-04 20:47:20] [config] data-weighting: ""
[2023-07-04 20:47:20] [config] data-weighting-type: sentence
[2023-07-04 20:47:20] [config] dec-cell: gru
[2023-07-04 20:47:20] [config] dec-cell-base-depth: 2
[2023-07-04 20:47:20] [config] dec-cell-high-depth: 1
[2023-07-04 20:47:20] [config] dec-depth: 1
[2023-07-04 20:47:20] [config] devices:
[2023-07-04 20:47:20] [config]   - 0
[2023-07-04 20:47:20] [config] dim-emb: 512
[2023-07-04 20:47:20] [config] dim-rnn: 1024
[2023-07-04 20:47:20] [config] dim-vocabs:
[2023-07-04 20:47:20] [config]   - 54042
[2023-07-04 20:47:20] [config]   - 36507
[2023-07-04 20:47:20] [config] disp-first: 0
[2023-07-04 20:47:20] [config] disp-freq: 1000u
[2023-07-04 20:47:20] [config] disp-label-counts: true
[2023-07-04 20:47:20] [config] dropout-rnn: 0
[2023-07-04 20:47:20] [config] dropout-src: 0
[2023-07-04 20:47:20] [config] dropout-trg: 0
[2023-07-04 20:47:20] [config] dump-config: ""
[2023-07-04 20:47:20] [config] dynamic-gradient-scaling:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] early-stopping: 10
[2023-07-04 20:47:20] [config] early-stopping-on: first
[2023-07-04 20:47:20] [config] embedding-fix-src: false
[2023-07-04 20:47:20] [config] embedding-fix-trg: false
[2023-07-04 20:47:20] [config] embedding-normalization: false
[2023-07-04 20:47:20] [config] embedding-vectors:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] enc-cell: gru
[2023-07-04 20:47:20] [config] enc-cell-depth: 1
[2023-07-04 20:47:20] [config] enc-depth: 1
[2023-07-04 20:47:20] [config] enc-type: bidirectional
[2023-07-04 20:47:20] [config] english-title-case-every: 0
[2023-07-04 20:47:20] [config] exponential-smoothing: 0
[2023-07-04 20:47:20] [config] factor-weight: 1
[2023-07-04 20:47:20] [config] factors-combine: sum
[2023-07-04 20:47:20] [config] factors-dim-emb: 0
[2023-07-04 20:47:20] [config] gradient-checkpointing: false
[2023-07-04 20:47:20] [config] gradient-norm-average-window: 100
[2023-07-04 20:47:20] [config] guided-alignment: none
[2023-07-04 20:47:20] [config] guided-alignment-cost: mse
[2023-07-04 20:47:20] [config] guided-alignment-weight: 0.1
[2023-07-04 20:47:20] [config] ignore-model-config: false
[2023-07-04 20:47:20] [config] input-types:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] interpolate-env-vars: false
[2023-07-04 20:47:20] [config] keep-best: false
[2023-07-04 20:47:20] [config] label-smoothing: 0
[2023-07-04 20:47:20] [config] layer-normalization: false
[2023-07-04 20:47:20] [config] learn-rate: 0.0001
[2023-07-04 20:47:20] [config] lemma-dependency: ""
[2023-07-04 20:47:20] [config] lemma-dim-emb: 0
[2023-07-04 20:47:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:47:20] [config] log-level: info
[2023-07-04 20:47:20] [config] log-time-zone: ""
[2023-07-04 20:47:20] [config] logical-epoch:
[2023-07-04 20:47:20] [config]   - 1e
[2023-07-04 20:47:20] [config]   - 0
[2023-07-04 20:47:20] [config] lr-decay: 0
[2023-07-04 20:47:20] [config] lr-decay-freq: 50000
[2023-07-04 20:47:20] [config] lr-decay-inv-sqrt:
[2023-07-04 20:47:20] [config]   - 0
[2023-07-04 20:47:20] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:47:20] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:47:20] [config] lr-decay-start:
[2023-07-04 20:47:20] [config]   - 10
[2023-07-04 20:47:20] [config]   - 1
[2023-07-04 20:47:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:47:20] [config] lr-report: false
[2023-07-04 20:47:20] [config] lr-warmup: 0
[2023-07-04 20:47:20] [config] lr-warmup-at-reload: false
[2023-07-04 20:47:20] [config] lr-warmup-cycle: false
[2023-07-04 20:47:20] [config] lr-warmup-start-rate: 0
[2023-07-04 20:47:20] [config] max-length: 50
[2023-07-04 20:47:20] [config] max-length-crop: false
[2023-07-04 20:47:20] [config] max-length-factor: 3
[2023-07-04 20:47:20] [config] maxi-batch: 100
[2023-07-04 20:47:20] [config] maxi-batch-sort: trg
[2023-07-04 20:47:20] [config] mini-batch: 64
[2023-07-04 20:47:20] [config] mini-batch-fit: false
[2023-07-04 20:47:20] [config] mini-batch-fit-step: 10
[2023-07-04 20:47:20] [config] mini-batch-round-up: true
[2023-07-04 20:47:20] [config] mini-batch-track-lr: false
[2023-07-04 20:47:20] [config] mini-batch-warmup: 0
[2023-07-04 20:47:20] [config] mini-batch-words: 0
[2023-07-04 20:47:20] [config] mini-batch-words-ref: 0
[2023-07-04 20:47:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:47:20] [config] multi-loss-type: sum
[2023-07-04 20:47:20] [config] n-best: false
[2023-07-04 20:47:20] [config] no-nccl: false
[2023-07-04 20:47:20] [config] no-reload: false
[2023-07-04 20:47:20] [config] no-restore-corpus: false
[2023-07-04 20:47:20] [config] normalize: 0
[2023-07-04 20:47:20] [config] normalize-gradient: false
[2023-07-04 20:47:20] [config] num-devices: 0
[2023-07-04 20:47:20] [config] optimizer: adam
[2023-07-04 20:47:20] [config] optimizer-delay: 1
[2023-07-04 20:47:20] [config] optimizer-params:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] output-omit-bias: false
[2023-07-04 20:47:20] [config] overwrite: true
[2023-07-04 20:47:20] [config] precision:
[2023-07-04 20:47:20] [config]   - float32
[2023-07-04 20:47:20] [config]   - float32
[2023-07-04 20:47:20] [config] pretrained-model: ""
[2023-07-04 20:47:20] [config] quantize-biases: false
[2023-07-04 20:47:20] [config] quantize-bits: 0
[2023-07-04 20:47:20] [config] quantize-log-based: false
[2023-07-04 20:47:20] [config] quantize-optimization-steps: 0
[2023-07-04 20:47:20] [config] quiet: false
[2023-07-04 20:47:20] [config] quiet-translation: true
[2023-07-04 20:47:20] [config] relative-paths: false
[2023-07-04 20:47:20] [config] right-left: false
[2023-07-04 20:47:20] [config] save-freq: 10000u
[2023-07-04 20:47:20] [config] seed: 1234
[2023-07-04 20:47:20] [config] sentencepiece-alphas:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:47:20] [config] sentencepiece-options: ""
[2023-07-04 20:47:20] [config] sharding: global
[2023-07-04 20:47:20] [config] shuffle: data
[2023-07-04 20:47:20] [config] shuffle-in-ram: false
[2023-07-04 20:47:20] [config] sigterm: save-and-exit
[2023-07-04 20:47:20] [config] skip: false
[2023-07-04 20:47:20] [config] sqlite: ""
[2023-07-04 20:47:20] [config] sqlite-drop: false
[2023-07-04 20:47:20] [config] sync-freq: 200u
[2023-07-04 20:47:20] [config] sync-sgd: false
[2023-07-04 20:47:20] [config] tempdir: /tmp
[2023-07-04 20:47:20] [config] tied-embeddings: false
[2023-07-04 20:47:20] [config] tied-embeddings-all: false
[2023-07-04 20:47:20] [config] tied-embeddings-src: false
[2023-07-04 20:47:20] [config] train-embedder-rank:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] train-sets:
[2023-07-04 20:47:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:47:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:47:20] [config] transformer-aan-activation: swish
[2023-07-04 20:47:20] [config] transformer-aan-depth: 2
[2023-07-04 20:47:20] [config] transformer-aan-nogate: false
[2023-07-04 20:47:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:47:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:47:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:47:20] [config] transformer-depth-scaling: false
[2023-07-04 20:47:20] [config] transformer-dim-aan: 2048
[2023-07-04 20:47:20] [config] transformer-dim-ffn: 2048
[2023-07-04 20:47:20] [config] transformer-dropout: 0
[2023-07-04 20:47:20] [config] transformer-dropout-attention: 0
[2023-07-04 20:47:20] [config] transformer-dropout-ffn: 0
[2023-07-04 20:47:20] [config] transformer-ffn-activation: swish
[2023-07-04 20:47:20] [config] transformer-ffn-depth: 2
[2023-07-04 20:47:20] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:47:20] [config] transformer-heads: 8
[2023-07-04 20:47:20] [config] transformer-no-projection: false
[2023-07-04 20:47:20] [config] transformer-pool: false
[2023-07-04 20:47:20] [config] transformer-postprocess: dan
[2023-07-04 20:47:20] [config] transformer-postprocess-emb: d
[2023-07-04 20:47:20] [config] transformer-postprocess-top: ""
[2023-07-04 20:47:20] [config] transformer-preprocess: ""
[2023-07-04 20:47:20] [config] transformer-tied-layers:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] transformer-train-position-embeddings: false
[2023-07-04 20:47:20] [config] tsv: false
[2023-07-04 20:47:20] [config] tsv-fields: 0
[2023-07-04 20:47:20] [config] type: transformer
[2023-07-04 20:47:20] [config] ulr: false
[2023-07-04 20:47:20] [config] ulr-dim-emb: 0
[2023-07-04 20:47:20] [config] ulr-dropout: 0
[2023-07-04 20:47:20] [config] ulr-keys-vectors: ""
[2023-07-04 20:47:20] [config] ulr-query-vectors: ""
[2023-07-04 20:47:20] [config] ulr-softmax-temperature: 1
[2023-07-04 20:47:20] [config] ulr-trainable-transformation: false
[2023-07-04 20:47:20] [config] unlikelihood-loss: false
[2023-07-04 20:47:20] [config] valid-freq: 50000000
[2023-07-04 20:47:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:47:20] [config] valid-max-length: 1000
[2023-07-04 20:47:20] [config] valid-metrics:
[2023-07-04 20:47:20] [config]   - cross-entropy
[2023-07-04 20:47:20] [config]   - translation
[2023-07-04 20:47:20] [config] valid-mini-batch: 32
[2023-07-04 20:47:20] [config] valid-reset-stalled: false
[2023-07-04 20:47:20] [config] valid-script-args:
[2023-07-04 20:47:20] [config]   []
[2023-07-04 20:47:20] [config] valid-script-path: ""
[2023-07-04 20:47:20] [config] valid-sets:
[2023-07-04 20:47:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:47:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:47:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:47:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:47:20] [config] vocabs:
[2023-07-04 20:47:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:47:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:47:20] [config] word-penalty: 0
[2023-07-04 20:47:20] [config] word-scores: false
[2023-07-04 20:47:20] [config] workspace: 2048
[2023-07-04 20:47:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:47:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:47:20] [training] Using single-device training
[2023-07-04 20:47:20] Synced seed 1234
[2023-07-04 20:47:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:47:20] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:47:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:47:20] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:47:20] [valid] No post-processing script given for validating translator
[2023-07-04 20:47:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:47:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:47:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:47:21] [comm] Using global sharding
[2023-07-04 20:47:21] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:47:21] [training] Using 1 GPUs
[2023-07-04 20:47:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:47:23] Loading Adam parameters
[2023-07-04 20:47:23] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:47:24] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:47:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:47:24] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-07-04 20:47:24] [data] Shuffling data
[2023-07-04 20:47:24] [data] Done reading 20,192 sentences
[2023-07-04 20:47:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:47:24] Training started
[2023-07-04 20:47:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:47:24] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:47:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:47:24] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:47:24] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:47:38] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.00901018 * 1,330,991 @ 1,562 after 28,170,306 : Time 17.73s : 75074.07 words/s : gNorm 0.4955
[2023-07-04 20:47:42] Seen 18,843 samples
[2023-07-04 20:47:42] Starting data epoch 72 in logical epoch 72
[2023-07-04 20:47:42] [data] Shuffling data
[2023-07-04 20:47:42] [data] Done reading 20,192 sentences
[2023-07-04 20:47:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:48:03] Seen 18,843 samples
[2023-07-04 20:48:03] Starting data epoch 73 in logical epoch 73
[2023-07-04 20:48:03] [data] Shuffling data
[2023-07-04 20:48:03] [data] Done reading 20,192 sentences
[2023-07-04 20:48:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:48:25] Seen 18,843 samples
[2023-07-04 20:48:25] Starting data epoch 74 in logical epoch 74
[2023-07-04 20:48:25] [data] Shuffling data
[2023-07-04 20:48:25] [data] Done reading 20,192 sentences
[2023-07-04 20:48:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:48:49] Seen 18,843 samples
[2023-07-04 20:48:49] Starting data epoch 75 in logical epoch 75
[2023-07-04 20:48:49] [data] Shuffling data
[2023-07-04 20:48:49] [data] Done reading 20,192 sentences
[2023-07-04 20:48:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:48:53] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.00788780 * 1,344,658 @ 2,757 after 29,514,964 : Time 74.79s : 17979.87 words/s : gNorm 0.3984
[2023-07-04 20:49:12] Seen 18,843 samples
[2023-07-04 20:49:12] Starting data epoch 76 in logical epoch 76
[2023-07-04 20:49:12] [data] Shuffling data
[2023-07-04 20:49:12] [data] Done reading 20,192 sentences
[2023-07-04 20:49:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:49:36] Seen 18,843 samples
[2023-07-04 20:49:36] Starting data epoch 77 in logical epoch 77
[2023-07-04 20:49:36] [data] Shuffling data
[2023-07-04 20:49:36] [data] Done reading 20,192 sentences
[2023-07-04 20:49:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:49:59] Seen 18,843 samples
[2023-07-04 20:49:59] Starting data epoch 78 in logical epoch 78
[2023-07-04 20:49:59] [data] Shuffling data
[2023-07-04 20:49:59] [data] Done reading 20,192 sentences
[2023-07-04 20:49:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:50:12] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.00809916 * 1,340,855 @ 527 after 30,855,819 : Time 79.07s : 16958.89 words/s : gNorm 0.4207
[2023-07-04 20:50:23] Seen 18,843 samples
[2023-07-04 20:50:23] Starting data epoch 79 in logical epoch 79
[2023-07-04 20:50:23] [data] Shuffling data
[2023-07-04 20:50:23] [data] Done reading 20,192 sentences
[2023-07-04 20:50:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:50:46] Seen 18,843 samples
[2023-07-04 20:50:46] Starting data epoch 80 in logical epoch 80
[2023-07-04 20:50:46] [data] Shuffling data
[2023-07-04 20:50:46] [data] Done reading 20,192 sentences
[2023-07-04 20:50:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:51:09] Seen 18,843 samples
[2023-07-04 20:51:09] Starting data epoch 81 in logical epoch 81
[2023-07-04 20:51:09] Training finished
[2023-07-04 20:51:12] [valid] Ep. 81 : Up. 23727 : cross-entropy : 193.013 : stalled 7 times (last best: 125.788)
[2023-07-04 20:53:48] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-07-04 20:53:48] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:53:51] Saving Adam parameters
[2023-07-04 20:53:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:54:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:54:02] [marian] Running on node07.datos.cluster.uy as process 18614 with command line:
[2023-07-04 20:54:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 20:54:02] [config] after: 0e
[2023-07-04 20:54:02] [config] after-batches: 0
[2023-07-04 20:54:02] [config] after-epochs: 90
[2023-07-04 20:54:02] [config] all-caps-every: 0
[2023-07-04 20:54:02] [config] allow-unk: false
[2023-07-04 20:54:02] [config] authors: false
[2023-07-04 20:54:02] [config] beam-size: 12
[2023-07-04 20:54:02] [config] bert-class-symbol: "[CLS]"
[2023-07-04 20:54:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 20:54:02] [config] bert-masking-fraction: 0.15
[2023-07-04 20:54:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 20:54:02] [config] bert-train-type-embeddings: true
[2023-07-04 20:54:02] [config] bert-type-vocab-size: 2
[2023-07-04 20:54:02] [config] build-info: ""
[2023-07-04 20:54:02] [config] check-gradient-nan: false
[2023-07-04 20:54:02] [config] check-nan: false
[2023-07-04 20:54:02] [config] cite: false
[2023-07-04 20:54:02] [config] clip-norm: 1
[2023-07-04 20:54:02] [config] cost-scaling:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] cost-type: ce-sum
[2023-07-04 20:54:02] [config] cpu-threads: 0
[2023-07-04 20:54:02] [config] data-threads: 8
[2023-07-04 20:54:02] [config] data-weighting: ""
[2023-07-04 20:54:02] [config] data-weighting-type: sentence
[2023-07-04 20:54:02] [config] dec-cell: gru
[2023-07-04 20:54:02] [config] dec-cell-base-depth: 2
[2023-07-04 20:54:02] [config] dec-cell-high-depth: 1
[2023-07-04 20:54:02] [config] dec-depth: 1
[2023-07-04 20:54:02] [config] devices:
[2023-07-04 20:54:02] [config]   - 0
[2023-07-04 20:54:02] [config] dim-emb: 512
[2023-07-04 20:54:02] [config] dim-rnn: 1024
[2023-07-04 20:54:02] [config] dim-vocabs:
[2023-07-04 20:54:02] [config]   - 54042
[2023-07-04 20:54:02] [config]   - 36507
[2023-07-04 20:54:02] [config] disp-first: 0
[2023-07-04 20:54:02] [config] disp-freq: 1000u
[2023-07-04 20:54:02] [config] disp-label-counts: true
[2023-07-04 20:54:02] [config] dropout-rnn: 0
[2023-07-04 20:54:02] [config] dropout-src: 0
[2023-07-04 20:54:02] [config] dropout-trg: 0
[2023-07-04 20:54:02] [config] dump-config: ""
[2023-07-04 20:54:02] [config] dynamic-gradient-scaling:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] early-stopping: 10
[2023-07-04 20:54:02] [config] early-stopping-on: first
[2023-07-04 20:54:02] [config] embedding-fix-src: false
[2023-07-04 20:54:02] [config] embedding-fix-trg: false
[2023-07-04 20:54:02] [config] embedding-normalization: false
[2023-07-04 20:54:02] [config] embedding-vectors:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] enc-cell: gru
[2023-07-04 20:54:02] [config] enc-cell-depth: 1
[2023-07-04 20:54:02] [config] enc-depth: 1
[2023-07-04 20:54:02] [config] enc-type: bidirectional
[2023-07-04 20:54:02] [config] english-title-case-every: 0
[2023-07-04 20:54:02] [config] exponential-smoothing: 0
[2023-07-04 20:54:02] [config] factor-weight: 1
[2023-07-04 20:54:02] [config] factors-combine: sum
[2023-07-04 20:54:02] [config] factors-dim-emb: 0
[2023-07-04 20:54:02] [config] gradient-checkpointing: false
[2023-07-04 20:54:02] [config] gradient-norm-average-window: 100
[2023-07-04 20:54:02] [config] guided-alignment: none
[2023-07-04 20:54:02] [config] guided-alignment-cost: mse
[2023-07-04 20:54:02] [config] guided-alignment-weight: 0.1
[2023-07-04 20:54:02] [config] ignore-model-config: false
[2023-07-04 20:54:02] [config] input-types:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] interpolate-env-vars: false
[2023-07-04 20:54:02] [config] keep-best: false
[2023-07-04 20:54:02] [config] label-smoothing: 0
[2023-07-04 20:54:02] [config] layer-normalization: false
[2023-07-04 20:54:02] [config] learn-rate: 0.0001
[2023-07-04 20:54:02] [config] lemma-dependency: ""
[2023-07-04 20:54:02] [config] lemma-dim-emb: 0
[2023-07-04 20:54:02] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 20:54:02] [config] log-level: info
[2023-07-04 20:54:02] [config] log-time-zone: ""
[2023-07-04 20:54:02] [config] logical-epoch:
[2023-07-04 20:54:02] [config]   - 1e
[2023-07-04 20:54:02] [config]   - 0
[2023-07-04 20:54:02] [config] lr-decay: 0
[2023-07-04 20:54:02] [config] lr-decay-freq: 50000
[2023-07-04 20:54:02] [config] lr-decay-inv-sqrt:
[2023-07-04 20:54:02] [config]   - 0
[2023-07-04 20:54:02] [config] lr-decay-repeat-warmup: false
[2023-07-04 20:54:02] [config] lr-decay-reset-optimizer: false
[2023-07-04 20:54:02] [config] lr-decay-start:
[2023-07-04 20:54:02] [config]   - 10
[2023-07-04 20:54:02] [config]   - 1
[2023-07-04 20:54:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 20:54:02] [config] lr-report: false
[2023-07-04 20:54:02] [config] lr-warmup: 0
[2023-07-04 20:54:02] [config] lr-warmup-at-reload: false
[2023-07-04 20:54:02] [config] lr-warmup-cycle: false
[2023-07-04 20:54:02] [config] lr-warmup-start-rate: 0
[2023-07-04 20:54:02] [config] max-length: 50
[2023-07-04 20:54:02] [config] max-length-crop: false
[2023-07-04 20:54:02] [config] max-length-factor: 3
[2023-07-04 20:54:02] [config] maxi-batch: 100
[2023-07-04 20:54:02] [config] maxi-batch-sort: trg
[2023-07-04 20:54:02] [config] mini-batch: 64
[2023-07-04 20:54:02] [config] mini-batch-fit: false
[2023-07-04 20:54:02] [config] mini-batch-fit-step: 10
[2023-07-04 20:54:02] [config] mini-batch-round-up: true
[2023-07-04 20:54:02] [config] mini-batch-track-lr: false
[2023-07-04 20:54:02] [config] mini-batch-warmup: 0
[2023-07-04 20:54:02] [config] mini-batch-words: 0
[2023-07-04 20:54:02] [config] mini-batch-words-ref: 0
[2023-07-04 20:54:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:54:02] [config] multi-loss-type: sum
[2023-07-04 20:54:02] [config] n-best: false
[2023-07-04 20:54:02] [config] no-nccl: false
[2023-07-04 20:54:02] [config] no-reload: false
[2023-07-04 20:54:02] [config] no-restore-corpus: false
[2023-07-04 20:54:02] [config] normalize: 0
[2023-07-04 20:54:02] [config] normalize-gradient: false
[2023-07-04 20:54:02] [config] num-devices: 0
[2023-07-04 20:54:02] [config] optimizer: adam
[2023-07-04 20:54:02] [config] optimizer-delay: 1
[2023-07-04 20:54:02] [config] optimizer-params:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] output-omit-bias: false
[2023-07-04 20:54:02] [config] overwrite: true
[2023-07-04 20:54:02] [config] precision:
[2023-07-04 20:54:02] [config]   - float32
[2023-07-04 20:54:02] [config]   - float32
[2023-07-04 20:54:02] [config] pretrained-model: ""
[2023-07-04 20:54:02] [config] quantize-biases: false
[2023-07-04 20:54:02] [config] quantize-bits: 0
[2023-07-04 20:54:02] [config] quantize-log-based: false
[2023-07-04 20:54:02] [config] quantize-optimization-steps: 0
[2023-07-04 20:54:02] [config] quiet: false
[2023-07-04 20:54:02] [config] quiet-translation: true
[2023-07-04 20:54:02] [config] relative-paths: false
[2023-07-04 20:54:02] [config] right-left: false
[2023-07-04 20:54:02] [config] save-freq: 10000u
[2023-07-04 20:54:02] [config] seed: 1234
[2023-07-04 20:54:02] [config] sentencepiece-alphas:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] sentencepiece-max-lines: 2000000
[2023-07-04 20:54:02] [config] sentencepiece-options: ""
[2023-07-04 20:54:02] [config] sharding: global
[2023-07-04 20:54:02] [config] shuffle: data
[2023-07-04 20:54:02] [config] shuffle-in-ram: false
[2023-07-04 20:54:02] [config] sigterm: save-and-exit
[2023-07-04 20:54:02] [config] skip: false
[2023-07-04 20:54:02] [config] sqlite: ""
[2023-07-04 20:54:02] [config] sqlite-drop: false
[2023-07-04 20:54:02] [config] sync-freq: 200u
[2023-07-04 20:54:02] [config] sync-sgd: false
[2023-07-04 20:54:02] [config] tempdir: /tmp
[2023-07-04 20:54:02] [config] tied-embeddings: false
[2023-07-04 20:54:02] [config] tied-embeddings-all: false
[2023-07-04 20:54:02] [config] tied-embeddings-src: false
[2023-07-04 20:54:02] [config] train-embedder-rank:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] train-sets:
[2023-07-04 20:54:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 20:54:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 20:54:02] [config] transformer-aan-activation: swish
[2023-07-04 20:54:02] [config] transformer-aan-depth: 2
[2023-07-04 20:54:02] [config] transformer-aan-nogate: false
[2023-07-04 20:54:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 20:54:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 20:54:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 20:54:02] [config] transformer-depth-scaling: false
[2023-07-04 20:54:02] [config] transformer-dim-aan: 2048
[2023-07-04 20:54:02] [config] transformer-dim-ffn: 2048
[2023-07-04 20:54:02] [config] transformer-dropout: 0
[2023-07-04 20:54:02] [config] transformer-dropout-attention: 0
[2023-07-04 20:54:02] [config] transformer-dropout-ffn: 0
[2023-07-04 20:54:02] [config] transformer-ffn-activation: swish
[2023-07-04 20:54:02] [config] transformer-ffn-depth: 2
[2023-07-04 20:54:02] [config] transformer-guided-alignment-layer: last
[2023-07-04 20:54:02] [config] transformer-heads: 8
[2023-07-04 20:54:02] [config] transformer-no-projection: false
[2023-07-04 20:54:02] [config] transformer-pool: false
[2023-07-04 20:54:02] [config] transformer-postprocess: dan
[2023-07-04 20:54:02] [config] transformer-postprocess-emb: d
[2023-07-04 20:54:02] [config] transformer-postprocess-top: ""
[2023-07-04 20:54:02] [config] transformer-preprocess: ""
[2023-07-04 20:54:02] [config] transformer-tied-layers:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] transformer-train-position-embeddings: false
[2023-07-04 20:54:02] [config] tsv: false
[2023-07-04 20:54:02] [config] tsv-fields: 0
[2023-07-04 20:54:02] [config] type: transformer
[2023-07-04 20:54:02] [config] ulr: false
[2023-07-04 20:54:02] [config] ulr-dim-emb: 0
[2023-07-04 20:54:02] [config] ulr-dropout: 0
[2023-07-04 20:54:02] [config] ulr-keys-vectors: ""
[2023-07-04 20:54:02] [config] ulr-query-vectors: ""
[2023-07-04 20:54:02] [config] ulr-softmax-temperature: 1
[2023-07-04 20:54:02] [config] ulr-trainable-transformation: false
[2023-07-04 20:54:02] [config] unlikelihood-loss: false
[2023-07-04 20:54:02] [config] valid-freq: 50000000
[2023-07-04 20:54:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 20:54:02] [config] valid-max-length: 1000
[2023-07-04 20:54:02] [config] valid-metrics:
[2023-07-04 20:54:02] [config]   - cross-entropy
[2023-07-04 20:54:02] [config]   - translation
[2023-07-04 20:54:02] [config] valid-mini-batch: 32
[2023-07-04 20:54:02] [config] valid-reset-stalled: false
[2023-07-04 20:54:02] [config] valid-script-args:
[2023-07-04 20:54:02] [config]   []
[2023-07-04 20:54:02] [config] valid-script-path: ""
[2023-07-04 20:54:02] [config] valid-sets:
[2023-07-04 20:54:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 20:54:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 20:54:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 20:54:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:54:02] [config] vocabs:
[2023-07-04 20:54:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:54:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:54:02] [config] word-penalty: 0
[2023-07-04 20:54:02] [config] word-scores: false
[2023-07-04 20:54:02] [config] workspace: 2048
[2023-07-04 20:54:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 20:54:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:54:02] [training] Using single-device training
[2023-07-04 20:54:03] Synced seed 1234
[2023-07-04 20:54:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 20:54:03] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 20:54:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 20:54:03] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 20:54:03] [valid] No post-processing script given for validating translator
[2023-07-04 20:54:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 20:54:04] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 20:54:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 20:54:04] [comm] Using global sharding
[2023-07-04 20:54:04] [comm] NCCLCommunicators constructed successfully
[2023-07-04 20:54:04] [training] Using 1 GPUs
[2023-07-04 20:54:04] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:54:06] Loading Adam parameters
[2023-07-04 20:54:06] [memory] Reserving 552 MB, device gpu0
[2023-07-04 20:54:06] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:54:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 20:54:06] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-07-04 20:54:06] [data] Shuffling data
[2023-07-04 20:54:06] [data] Done reading 20,192 sentences
[2023-07-04 20:54:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:54:07] Training started
[2023-07-04 20:54:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 20:54:07] [logits] Applying loss function for 1 factor(s)
[2023-07-04 20:54:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 20:54:07] [memory] Reserving 276 MB, device gpu0
[2023-07-04 20:54:07] Parameter type float32, optimization type float32, casting types false
[2023-07-04 20:54:23] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.00801995 * 1,343,267 @ 832 after 32,199,086 : Time 20.25s : 66349.41 words/s : gNorm 0.4176
[2023-07-04 20:54:25] Seen 18,843 samples
[2023-07-04 20:54:25] Starting data epoch 82 in logical epoch 82
[2023-07-04 20:54:25] [data] Shuffling data
[2023-07-04 20:54:25] [data] Done reading 20,192 sentences
[2023-07-04 20:54:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:54:48] Seen 18,843 samples
[2023-07-04 20:54:48] Starting data epoch 83 in logical epoch 83
[2023-07-04 20:54:48] [data] Shuffling data
[2023-07-04 20:54:48] [data] Done reading 20,192 sentences
[2023-07-04 20:54:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:55:11] Seen 18,843 samples
[2023-07-04 20:55:11] Starting data epoch 84 in logical epoch 84
[2023-07-04 20:55:11] [data] Shuffling data
[2023-07-04 20:55:11] [data] Done reading 20,192 sentences
[2023-07-04 20:55:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:55:33] Seen 18,843 samples
[2023-07-04 20:55:33] Starting data epoch 85 in logical epoch 85
[2023-07-04 20:55:33] [data] Shuffling data
[2023-07-04 20:55:33] [data] Done reading 20,192 sentences
[2023-07-04 20:55:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:55:39] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.00754529 * 1,339,320 @ 1,280 after 33,538,406 : Time 76.17s : 17582.38 words/s : gNorm 0.3852
[2023-07-04 20:55:55] Seen 18,843 samples
[2023-07-04 20:55:55] Starting data epoch 86 in logical epoch 86
[2023-07-04 20:55:55] [data] Shuffling data
[2023-07-04 20:55:55] [data] Done reading 20,192 sentences
[2023-07-04 20:55:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:56:18] Seen 18,843 samples
[2023-07-04 20:56:18] Starting data epoch 87 in logical epoch 87
[2023-07-04 20:56:18] [data] Shuffling data
[2023-07-04 20:56:18] [data] Done reading 20,192 sentences
[2023-07-04 20:56:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:56:42] Seen 18,843 samples
[2023-07-04 20:56:42] Starting data epoch 88 in logical epoch 88
[2023-07-04 20:56:42] [data] Shuffling data
[2023-07-04 20:56:42] [data] Done reading 20,192 sentences
[2023-07-04 20:56:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:56:58] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.00769044 * 1,346,822 @ 896 after 34,885,228 : Time 78.37s : 17184.97 words/s : gNorm 0.4190
[2023-07-04 20:57:06] Seen 18,843 samples
[2023-07-04 20:57:06] Starting data epoch 89 in logical epoch 89
[2023-07-04 20:57:06] [data] Shuffling data
[2023-07-04 20:57:06] [data] Done reading 20,192 sentences
[2023-07-04 20:57:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:57:29] Seen 18,843 samples
[2023-07-04 20:57:29] Starting data epoch 90 in logical epoch 90
[2023-07-04 20:57:29] [data] Shuffling data
[2023-07-04 20:57:29] [data] Done reading 20,192 sentences
[2023-07-04 20:57:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 20:57:53] Seen 18,843 samples
[2023-07-04 20:57:53] Starting data epoch 91 in logical epoch 91
[2023-07-04 20:57:53] Training finished
[2023-07-04 20:57:56] [valid] Ep. 91 : Up. 26693 : cross-entropy : 198.395 : stalled 8 times (last best: 125.788)
[2023-07-04 20:59:54] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-07-04 20:59:54] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 20:59:57] Saving Adam parameters
[2023-07-04 20:59:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:00:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:00:09] [marian] Running on node07.datos.cluster.uy as process 18977 with command line:
[2023-07-04 21:00:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:00:09] [config] after: 0e
[2023-07-04 21:00:09] [config] after-batches: 0
[2023-07-04 21:00:09] [config] after-epochs: 100
[2023-07-04 21:00:09] [config] all-caps-every: 0
[2023-07-04 21:00:09] [config] allow-unk: false
[2023-07-04 21:00:09] [config] authors: false
[2023-07-04 21:00:09] [config] beam-size: 12
[2023-07-04 21:00:09] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:00:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:00:09] [config] bert-masking-fraction: 0.15
[2023-07-04 21:00:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:00:09] [config] bert-train-type-embeddings: true
[2023-07-04 21:00:09] [config] bert-type-vocab-size: 2
[2023-07-04 21:00:09] [config] build-info: ""
[2023-07-04 21:00:09] [config] check-gradient-nan: false
[2023-07-04 21:00:09] [config] check-nan: false
[2023-07-04 21:00:09] [config] cite: false
[2023-07-04 21:00:09] [config] clip-norm: 1
[2023-07-04 21:00:09] [config] cost-scaling:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] cost-type: ce-sum
[2023-07-04 21:00:09] [config] cpu-threads: 0
[2023-07-04 21:00:09] [config] data-threads: 8
[2023-07-04 21:00:09] [config] data-weighting: ""
[2023-07-04 21:00:09] [config] data-weighting-type: sentence
[2023-07-04 21:00:09] [config] dec-cell: gru
[2023-07-04 21:00:09] [config] dec-cell-base-depth: 2
[2023-07-04 21:00:09] [config] dec-cell-high-depth: 1
[2023-07-04 21:00:09] [config] dec-depth: 1
[2023-07-04 21:00:09] [config] devices:
[2023-07-04 21:00:09] [config]   - 0
[2023-07-04 21:00:09] [config] dim-emb: 512
[2023-07-04 21:00:09] [config] dim-rnn: 1024
[2023-07-04 21:00:09] [config] dim-vocabs:
[2023-07-04 21:00:09] [config]   - 54042
[2023-07-04 21:00:09] [config]   - 36507
[2023-07-04 21:00:09] [config] disp-first: 0
[2023-07-04 21:00:09] [config] disp-freq: 1000u
[2023-07-04 21:00:09] [config] disp-label-counts: true
[2023-07-04 21:00:09] [config] dropout-rnn: 0
[2023-07-04 21:00:09] [config] dropout-src: 0
[2023-07-04 21:00:09] [config] dropout-trg: 0
[2023-07-04 21:00:09] [config] dump-config: ""
[2023-07-04 21:00:09] [config] dynamic-gradient-scaling:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] early-stopping: 10
[2023-07-04 21:00:09] [config] early-stopping-on: first
[2023-07-04 21:00:09] [config] embedding-fix-src: false
[2023-07-04 21:00:09] [config] embedding-fix-trg: false
[2023-07-04 21:00:09] [config] embedding-normalization: false
[2023-07-04 21:00:09] [config] embedding-vectors:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] enc-cell: gru
[2023-07-04 21:00:09] [config] enc-cell-depth: 1
[2023-07-04 21:00:09] [config] enc-depth: 1
[2023-07-04 21:00:09] [config] enc-type: bidirectional
[2023-07-04 21:00:09] [config] english-title-case-every: 0
[2023-07-04 21:00:09] [config] exponential-smoothing: 0
[2023-07-04 21:00:09] [config] factor-weight: 1
[2023-07-04 21:00:09] [config] factors-combine: sum
[2023-07-04 21:00:09] [config] factors-dim-emb: 0
[2023-07-04 21:00:09] [config] gradient-checkpointing: false
[2023-07-04 21:00:09] [config] gradient-norm-average-window: 100
[2023-07-04 21:00:09] [config] guided-alignment: none
[2023-07-04 21:00:09] [config] guided-alignment-cost: mse
[2023-07-04 21:00:09] [config] guided-alignment-weight: 0.1
[2023-07-04 21:00:09] [config] ignore-model-config: false
[2023-07-04 21:00:09] [config] input-types:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] interpolate-env-vars: false
[2023-07-04 21:00:09] [config] keep-best: false
[2023-07-04 21:00:09] [config] label-smoothing: 0
[2023-07-04 21:00:09] [config] layer-normalization: false
[2023-07-04 21:00:09] [config] learn-rate: 0.0001
[2023-07-04 21:00:09] [config] lemma-dependency: ""
[2023-07-04 21:00:09] [config] lemma-dim-emb: 0
[2023-07-04 21:00:09] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:00:09] [config] log-level: info
[2023-07-04 21:00:09] [config] log-time-zone: ""
[2023-07-04 21:00:09] [config] logical-epoch:
[2023-07-04 21:00:09] [config]   - 1e
[2023-07-04 21:00:09] [config]   - 0
[2023-07-04 21:00:09] [config] lr-decay: 0
[2023-07-04 21:00:09] [config] lr-decay-freq: 50000
[2023-07-04 21:00:09] [config] lr-decay-inv-sqrt:
[2023-07-04 21:00:09] [config]   - 0
[2023-07-04 21:00:09] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:00:09] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:00:09] [config] lr-decay-start:
[2023-07-04 21:00:09] [config]   - 10
[2023-07-04 21:00:09] [config]   - 1
[2023-07-04 21:00:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:00:09] [config] lr-report: false
[2023-07-04 21:00:09] [config] lr-warmup: 0
[2023-07-04 21:00:09] [config] lr-warmup-at-reload: false
[2023-07-04 21:00:09] [config] lr-warmup-cycle: false
[2023-07-04 21:00:09] [config] lr-warmup-start-rate: 0
[2023-07-04 21:00:09] [config] max-length: 50
[2023-07-04 21:00:09] [config] max-length-crop: false
[2023-07-04 21:00:09] [config] max-length-factor: 3
[2023-07-04 21:00:09] [config] maxi-batch: 100
[2023-07-04 21:00:09] [config] maxi-batch-sort: trg
[2023-07-04 21:00:09] [config] mini-batch: 64
[2023-07-04 21:00:09] [config] mini-batch-fit: false
[2023-07-04 21:00:09] [config] mini-batch-fit-step: 10
[2023-07-04 21:00:09] [config] mini-batch-round-up: true
[2023-07-04 21:00:09] [config] mini-batch-track-lr: false
[2023-07-04 21:00:09] [config] mini-batch-warmup: 0
[2023-07-04 21:00:09] [config] mini-batch-words: 0
[2023-07-04 21:00:09] [config] mini-batch-words-ref: 0
[2023-07-04 21:00:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:00:09] [config] multi-loss-type: sum
[2023-07-04 21:00:09] [config] n-best: false
[2023-07-04 21:00:09] [config] no-nccl: false
[2023-07-04 21:00:09] [config] no-reload: false
[2023-07-04 21:00:09] [config] no-restore-corpus: false
[2023-07-04 21:00:09] [config] normalize: 0
[2023-07-04 21:00:09] [config] normalize-gradient: false
[2023-07-04 21:00:09] [config] num-devices: 0
[2023-07-04 21:00:09] [config] optimizer: adam
[2023-07-04 21:00:09] [config] optimizer-delay: 1
[2023-07-04 21:00:09] [config] optimizer-params:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] output-omit-bias: false
[2023-07-04 21:00:09] [config] overwrite: true
[2023-07-04 21:00:09] [config] precision:
[2023-07-04 21:00:09] [config]   - float32
[2023-07-04 21:00:09] [config]   - float32
[2023-07-04 21:00:09] [config] pretrained-model: ""
[2023-07-04 21:00:09] [config] quantize-biases: false
[2023-07-04 21:00:09] [config] quantize-bits: 0
[2023-07-04 21:00:09] [config] quantize-log-based: false
[2023-07-04 21:00:09] [config] quantize-optimization-steps: 0
[2023-07-04 21:00:09] [config] quiet: false
[2023-07-04 21:00:09] [config] quiet-translation: true
[2023-07-04 21:00:09] [config] relative-paths: false
[2023-07-04 21:00:09] [config] right-left: false
[2023-07-04 21:00:09] [config] save-freq: 10000u
[2023-07-04 21:00:09] [config] seed: 1234
[2023-07-04 21:00:09] [config] sentencepiece-alphas:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:00:09] [config] sentencepiece-options: ""
[2023-07-04 21:00:09] [config] sharding: global
[2023-07-04 21:00:09] [config] shuffle: data
[2023-07-04 21:00:09] [config] shuffle-in-ram: false
[2023-07-04 21:00:09] [config] sigterm: save-and-exit
[2023-07-04 21:00:09] [config] skip: false
[2023-07-04 21:00:09] [config] sqlite: ""
[2023-07-04 21:00:09] [config] sqlite-drop: false
[2023-07-04 21:00:09] [config] sync-freq: 200u
[2023-07-04 21:00:09] [config] sync-sgd: false
[2023-07-04 21:00:09] [config] tempdir: /tmp
[2023-07-04 21:00:09] [config] tied-embeddings: false
[2023-07-04 21:00:09] [config] tied-embeddings-all: false
[2023-07-04 21:00:09] [config] tied-embeddings-src: false
[2023-07-04 21:00:09] [config] train-embedder-rank:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] train-sets:
[2023-07-04 21:00:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:00:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:00:09] [config] transformer-aan-activation: swish
[2023-07-04 21:00:09] [config] transformer-aan-depth: 2
[2023-07-04 21:00:09] [config] transformer-aan-nogate: false
[2023-07-04 21:00:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:00:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:00:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:00:09] [config] transformer-depth-scaling: false
[2023-07-04 21:00:09] [config] transformer-dim-aan: 2048
[2023-07-04 21:00:09] [config] transformer-dim-ffn: 2048
[2023-07-04 21:00:09] [config] transformer-dropout: 0
[2023-07-04 21:00:09] [config] transformer-dropout-attention: 0
[2023-07-04 21:00:09] [config] transformer-dropout-ffn: 0
[2023-07-04 21:00:09] [config] transformer-ffn-activation: swish
[2023-07-04 21:00:09] [config] transformer-ffn-depth: 2
[2023-07-04 21:00:09] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:00:09] [config] transformer-heads: 8
[2023-07-04 21:00:09] [config] transformer-no-projection: false
[2023-07-04 21:00:09] [config] transformer-pool: false
[2023-07-04 21:00:09] [config] transformer-postprocess: dan
[2023-07-04 21:00:09] [config] transformer-postprocess-emb: d
[2023-07-04 21:00:09] [config] transformer-postprocess-top: ""
[2023-07-04 21:00:09] [config] transformer-preprocess: ""
[2023-07-04 21:00:09] [config] transformer-tied-layers:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] transformer-train-position-embeddings: false
[2023-07-04 21:00:09] [config] tsv: false
[2023-07-04 21:00:09] [config] tsv-fields: 0
[2023-07-04 21:00:09] [config] type: transformer
[2023-07-04 21:00:09] [config] ulr: false
[2023-07-04 21:00:09] [config] ulr-dim-emb: 0
[2023-07-04 21:00:09] [config] ulr-dropout: 0
[2023-07-04 21:00:09] [config] ulr-keys-vectors: ""
[2023-07-04 21:00:09] [config] ulr-query-vectors: ""
[2023-07-04 21:00:09] [config] ulr-softmax-temperature: 1
[2023-07-04 21:00:09] [config] ulr-trainable-transformation: false
[2023-07-04 21:00:09] [config] unlikelihood-loss: false
[2023-07-04 21:00:09] [config] valid-freq: 50000000
[2023-07-04 21:00:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:00:09] [config] valid-max-length: 1000
[2023-07-04 21:00:09] [config] valid-metrics:
[2023-07-04 21:00:09] [config]   - cross-entropy
[2023-07-04 21:00:09] [config]   - translation
[2023-07-04 21:00:09] [config] valid-mini-batch: 32
[2023-07-04 21:00:09] [config] valid-reset-stalled: false
[2023-07-04 21:00:09] [config] valid-script-args:
[2023-07-04 21:00:09] [config]   []
[2023-07-04 21:00:09] [config] valid-script-path: ""
[2023-07-04 21:00:09] [config] valid-sets:
[2023-07-04 21:00:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:00:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:00:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:00:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:00:09] [config] vocabs:
[2023-07-04 21:00:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:00:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:00:09] [config] word-penalty: 0
[2023-07-04 21:00:09] [config] word-scores: false
[2023-07-04 21:00:09] [config] workspace: 2048
[2023-07-04 21:00:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:00:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:00:09] [training] Using single-device training
[2023-07-04 21:00:09] Synced seed 1234
[2023-07-04 21:00:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:00:09] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:00:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:00:09] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:00:09] [valid] No post-processing script given for validating translator
[2023-07-04 21:00:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:00:10] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:00:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:00:10] [comm] Using global sharding
[2023-07-04 21:00:10] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:00:10] [training] Using 1 GPUs
[2023-07-04 21:00:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:00:12] Loading Adam parameters
[2023-07-04 21:00:13] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:00:13] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:00:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:00:13] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-07-04 21:00:13] [data] Shuffling data
[2023-07-04 21:00:13] [data] Done reading 20,192 sentences
[2023-07-04 21:00:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:00:13] Training started
[2023-07-04 21:00:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 21:00:13] [logits] Applying loss function for 1 factor(s)
[2023-07-04 21:00:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 21:00:13] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:00:13] Parameter type float32, optimization type float32, casting types false
[2023-07-04 21:00:31] Seen 18,843 samples
[2023-07-04 21:00:31] Starting data epoch 92 in logical epoch 92
[2023-07-04 21:00:31] [data] Shuffling data
[2023-07-04 21:00:31] [data] Done reading 20,192 sentences
[2023-07-04 21:00:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:00:32] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.00740187 * 1,333,196 @ 488 after 36,218,424 : Time 22.14s : 60216.23 words/s : gNorm 0.3475
[2023-07-04 21:00:52] Seen 18,843 samples
[2023-07-04 21:00:52] Starting data epoch 93 in logical epoch 93
[2023-07-04 21:00:52] [data] Shuffling data
[2023-07-04 21:00:52] [data] Done reading 20,192 sentences
[2023-07-04 21:00:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:01:17] Seen 18,843 samples
[2023-07-04 21:01:17] Starting data epoch 94 in logical epoch 94
[2023-07-04 21:01:17] [data] Shuffling data
[2023-07-04 21:01:17] [data] Done reading 20,192 sentences
[2023-07-04 21:01:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:01:41] Seen 18,843 samples
[2023-07-04 21:01:41] Starting data epoch 95 in logical epoch 95
[2023-07-04 21:01:41] [data] Shuffling data
[2023-07-04 21:01:41] [data] Done reading 20,192 sentences
[2023-07-04 21:01:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:01:50] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.00677677 * 1,349,095 @ 2,048 after 37,567,519 : Time 78.86s : 17106.61 words/s : gNorm 0.3379
[2023-07-04 21:02:04] Seen 18,843 samples
[2023-07-04 21:02:04] Starting data epoch 96 in logical epoch 96
[2023-07-04 21:02:04] [data] Shuffling data
[2023-07-04 21:02:04] [data] Done reading 20,192 sentences
[2023-07-04 21:02:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:02:26] Seen 18,843 samples
[2023-07-04 21:02:26] Starting data epoch 97 in logical epoch 97
[2023-07-04 21:02:26] [data] Shuffling data
[2023-07-04 21:02:26] [data] Done reading 20,192 sentences
[2023-07-04 21:02:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:02:49] Seen 18,843 samples
[2023-07-04 21:02:49] Starting data epoch 98 in logical epoch 98
[2023-07-04 21:02:49] [data] Shuffling data
[2023-07-04 21:02:49] [data] Done reading 20,192 sentences
[2023-07-04 21:02:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:03:07] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.00666786 * 1,338,821 @ 2,572 after 38,906,340 : Time 76.45s : 17512.42 words/s : gNorm 0.3711
[2023-07-04 21:03:12] Seen 18,843 samples
[2023-07-04 21:03:12] Starting data epoch 99 in logical epoch 99
[2023-07-04 21:03:12] [data] Shuffling data
[2023-07-04 21:03:12] [data] Done reading 20,192 sentences
[2023-07-04 21:03:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:03:37] Seen 18,843 samples
[2023-07-04 21:03:37] Starting data epoch 100 in logical epoch 100
[2023-07-04 21:03:37] [data] Shuffling data
[2023-07-04 21:03:37] [data] Done reading 20,192 sentences
[2023-07-04 21:03:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:04:01] Seen 18,843 samples
[2023-07-04 21:04:01] Starting data epoch 101 in logical epoch 101
[2023-07-04 21:04:01] Training finished
[2023-07-04 21:04:04] [valid] Ep. 101 : Up. 29659 : cross-entropy : 203.885 : stalled 9 times (last best: 125.788)
[2023-07-04 21:06:37] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-07-04 21:06:37] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:06:39] Saving Adam parameters
[2023-07-04 21:06:40] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:06:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:06:50] [marian] Running on node07.datos.cluster.uy as process 19391 with command line:
[2023-07-04 21:06:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:06:50] [config] after: 0e
[2023-07-04 21:06:50] [config] after-batches: 0
[2023-07-04 21:06:50] [config] after-epochs: 110
[2023-07-04 21:06:50] [config] all-caps-every: 0
[2023-07-04 21:06:50] [config] allow-unk: false
[2023-07-04 21:06:50] [config] authors: false
[2023-07-04 21:06:50] [config] beam-size: 12
[2023-07-04 21:06:50] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:06:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:06:50] [config] bert-masking-fraction: 0.15
[2023-07-04 21:06:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:06:50] [config] bert-train-type-embeddings: true
[2023-07-04 21:06:50] [config] bert-type-vocab-size: 2
[2023-07-04 21:06:50] [config] build-info: ""
[2023-07-04 21:06:50] [config] check-gradient-nan: false
[2023-07-04 21:06:50] [config] check-nan: false
[2023-07-04 21:06:50] [config] cite: false
[2023-07-04 21:06:50] [config] clip-norm: 1
[2023-07-04 21:06:50] [config] cost-scaling:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] cost-type: ce-sum
[2023-07-04 21:06:50] [config] cpu-threads: 0
[2023-07-04 21:06:50] [config] data-threads: 8
[2023-07-04 21:06:50] [config] data-weighting: ""
[2023-07-04 21:06:50] [config] data-weighting-type: sentence
[2023-07-04 21:06:50] [config] dec-cell: gru
[2023-07-04 21:06:50] [config] dec-cell-base-depth: 2
[2023-07-04 21:06:50] [config] dec-cell-high-depth: 1
[2023-07-04 21:06:50] [config] dec-depth: 1
[2023-07-04 21:06:50] [config] devices:
[2023-07-04 21:06:50] [config]   - 0
[2023-07-04 21:06:50] [config] dim-emb: 512
[2023-07-04 21:06:50] [config] dim-rnn: 1024
[2023-07-04 21:06:50] [config] dim-vocabs:
[2023-07-04 21:06:50] [config]   - 54042
[2023-07-04 21:06:50] [config]   - 36507
[2023-07-04 21:06:50] [config] disp-first: 0
[2023-07-04 21:06:50] [config] disp-freq: 1000u
[2023-07-04 21:06:50] [config] disp-label-counts: true
[2023-07-04 21:06:50] [config] dropout-rnn: 0
[2023-07-04 21:06:50] [config] dropout-src: 0
[2023-07-04 21:06:50] [config] dropout-trg: 0
[2023-07-04 21:06:50] [config] dump-config: ""
[2023-07-04 21:06:50] [config] dynamic-gradient-scaling:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] early-stopping: 10
[2023-07-04 21:06:50] [config] early-stopping-on: first
[2023-07-04 21:06:50] [config] embedding-fix-src: false
[2023-07-04 21:06:50] [config] embedding-fix-trg: false
[2023-07-04 21:06:50] [config] embedding-normalization: false
[2023-07-04 21:06:50] [config] embedding-vectors:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] enc-cell: gru
[2023-07-04 21:06:50] [config] enc-cell-depth: 1
[2023-07-04 21:06:50] [config] enc-depth: 1
[2023-07-04 21:06:50] [config] enc-type: bidirectional
[2023-07-04 21:06:50] [config] english-title-case-every: 0
[2023-07-04 21:06:50] [config] exponential-smoothing: 0
[2023-07-04 21:06:50] [config] factor-weight: 1
[2023-07-04 21:06:50] [config] factors-combine: sum
[2023-07-04 21:06:50] [config] factors-dim-emb: 0
[2023-07-04 21:06:50] [config] gradient-checkpointing: false
[2023-07-04 21:06:50] [config] gradient-norm-average-window: 100
[2023-07-04 21:06:50] [config] guided-alignment: none
[2023-07-04 21:06:50] [config] guided-alignment-cost: mse
[2023-07-04 21:06:50] [config] guided-alignment-weight: 0.1
[2023-07-04 21:06:50] [config] ignore-model-config: false
[2023-07-04 21:06:50] [config] input-types:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] interpolate-env-vars: false
[2023-07-04 21:06:50] [config] keep-best: false
[2023-07-04 21:06:50] [config] label-smoothing: 0
[2023-07-04 21:06:50] [config] layer-normalization: false
[2023-07-04 21:06:50] [config] learn-rate: 0.0001
[2023-07-04 21:06:50] [config] lemma-dependency: ""
[2023-07-04 21:06:50] [config] lemma-dim-emb: 0
[2023-07-04 21:06:50] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:06:50] [config] log-level: info
[2023-07-04 21:06:50] [config] log-time-zone: ""
[2023-07-04 21:06:50] [config] logical-epoch:
[2023-07-04 21:06:50] [config]   - 1e
[2023-07-04 21:06:50] [config]   - 0
[2023-07-04 21:06:50] [config] lr-decay: 0
[2023-07-04 21:06:50] [config] lr-decay-freq: 50000
[2023-07-04 21:06:50] [config] lr-decay-inv-sqrt:
[2023-07-04 21:06:50] [config]   - 0
[2023-07-04 21:06:50] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:06:50] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:06:50] [config] lr-decay-start:
[2023-07-04 21:06:50] [config]   - 10
[2023-07-04 21:06:50] [config]   - 1
[2023-07-04 21:06:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:06:50] [config] lr-report: false
[2023-07-04 21:06:50] [config] lr-warmup: 0
[2023-07-04 21:06:50] [config] lr-warmup-at-reload: false
[2023-07-04 21:06:50] [config] lr-warmup-cycle: false
[2023-07-04 21:06:50] [config] lr-warmup-start-rate: 0
[2023-07-04 21:06:50] [config] max-length: 50
[2023-07-04 21:06:50] [config] max-length-crop: false
[2023-07-04 21:06:50] [config] max-length-factor: 3
[2023-07-04 21:06:50] [config] maxi-batch: 100
[2023-07-04 21:06:50] [config] maxi-batch-sort: trg
[2023-07-04 21:06:50] [config] mini-batch: 64
[2023-07-04 21:06:50] [config] mini-batch-fit: false
[2023-07-04 21:06:50] [config] mini-batch-fit-step: 10
[2023-07-04 21:06:50] [config] mini-batch-round-up: true
[2023-07-04 21:06:50] [config] mini-batch-track-lr: false
[2023-07-04 21:06:50] [config] mini-batch-warmup: 0
[2023-07-04 21:06:50] [config] mini-batch-words: 0
[2023-07-04 21:06:50] [config] mini-batch-words-ref: 0
[2023-07-04 21:06:50] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:06:50] [config] multi-loss-type: sum
[2023-07-04 21:06:50] [config] n-best: false
[2023-07-04 21:06:50] [config] no-nccl: false
[2023-07-04 21:06:50] [config] no-reload: false
[2023-07-04 21:06:50] [config] no-restore-corpus: false
[2023-07-04 21:06:50] [config] normalize: 0
[2023-07-04 21:06:50] [config] normalize-gradient: false
[2023-07-04 21:06:50] [config] num-devices: 0
[2023-07-04 21:06:50] [config] optimizer: adam
[2023-07-04 21:06:50] [config] optimizer-delay: 1
[2023-07-04 21:06:50] [config] optimizer-params:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] output-omit-bias: false
[2023-07-04 21:06:50] [config] overwrite: true
[2023-07-04 21:06:50] [config] precision:
[2023-07-04 21:06:50] [config]   - float32
[2023-07-04 21:06:50] [config]   - float32
[2023-07-04 21:06:50] [config] pretrained-model: ""
[2023-07-04 21:06:50] [config] quantize-biases: false
[2023-07-04 21:06:50] [config] quantize-bits: 0
[2023-07-04 21:06:50] [config] quantize-log-based: false
[2023-07-04 21:06:50] [config] quantize-optimization-steps: 0
[2023-07-04 21:06:50] [config] quiet: false
[2023-07-04 21:06:50] [config] quiet-translation: true
[2023-07-04 21:06:50] [config] relative-paths: false
[2023-07-04 21:06:50] [config] right-left: false
[2023-07-04 21:06:50] [config] save-freq: 10000u
[2023-07-04 21:06:50] [config] seed: 1234
[2023-07-04 21:06:50] [config] sentencepiece-alphas:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:06:50] [config] sentencepiece-options: ""
[2023-07-04 21:06:50] [config] sharding: global
[2023-07-04 21:06:50] [config] shuffle: data
[2023-07-04 21:06:50] [config] shuffle-in-ram: false
[2023-07-04 21:06:50] [config] sigterm: save-and-exit
[2023-07-04 21:06:50] [config] skip: false
[2023-07-04 21:06:50] [config] sqlite: ""
[2023-07-04 21:06:50] [config] sqlite-drop: false
[2023-07-04 21:06:50] [config] sync-freq: 200u
[2023-07-04 21:06:50] [config] sync-sgd: false
[2023-07-04 21:06:50] [config] tempdir: /tmp
[2023-07-04 21:06:50] [config] tied-embeddings: false
[2023-07-04 21:06:50] [config] tied-embeddings-all: false
[2023-07-04 21:06:50] [config] tied-embeddings-src: false
[2023-07-04 21:06:50] [config] train-embedder-rank:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] train-sets:
[2023-07-04 21:06:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:06:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:06:50] [config] transformer-aan-activation: swish
[2023-07-04 21:06:50] [config] transformer-aan-depth: 2
[2023-07-04 21:06:50] [config] transformer-aan-nogate: false
[2023-07-04 21:06:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:06:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:06:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:06:50] [config] transformer-depth-scaling: false
[2023-07-04 21:06:50] [config] transformer-dim-aan: 2048
[2023-07-04 21:06:50] [config] transformer-dim-ffn: 2048
[2023-07-04 21:06:50] [config] transformer-dropout: 0
[2023-07-04 21:06:50] [config] transformer-dropout-attention: 0
[2023-07-04 21:06:50] [config] transformer-dropout-ffn: 0
[2023-07-04 21:06:50] [config] transformer-ffn-activation: swish
[2023-07-04 21:06:50] [config] transformer-ffn-depth: 2
[2023-07-04 21:06:50] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:06:50] [config] transformer-heads: 8
[2023-07-04 21:06:50] [config] transformer-no-projection: false
[2023-07-04 21:06:50] [config] transformer-pool: false
[2023-07-04 21:06:50] [config] transformer-postprocess: dan
[2023-07-04 21:06:50] [config] transformer-postprocess-emb: d
[2023-07-04 21:06:50] [config] transformer-postprocess-top: ""
[2023-07-04 21:06:50] [config] transformer-preprocess: ""
[2023-07-04 21:06:50] [config] transformer-tied-layers:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] transformer-train-position-embeddings: false
[2023-07-04 21:06:50] [config] tsv: false
[2023-07-04 21:06:50] [config] tsv-fields: 0
[2023-07-04 21:06:50] [config] type: transformer
[2023-07-04 21:06:50] [config] ulr: false
[2023-07-04 21:06:50] [config] ulr-dim-emb: 0
[2023-07-04 21:06:50] [config] ulr-dropout: 0
[2023-07-04 21:06:50] [config] ulr-keys-vectors: ""
[2023-07-04 21:06:50] [config] ulr-query-vectors: ""
[2023-07-04 21:06:50] [config] ulr-softmax-temperature: 1
[2023-07-04 21:06:50] [config] ulr-trainable-transformation: false
[2023-07-04 21:06:50] [config] unlikelihood-loss: false
[2023-07-04 21:06:50] [config] valid-freq: 50000000
[2023-07-04 21:06:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:06:50] [config] valid-max-length: 1000
[2023-07-04 21:06:50] [config] valid-metrics:
[2023-07-04 21:06:50] [config]   - cross-entropy
[2023-07-04 21:06:50] [config]   - translation
[2023-07-04 21:06:50] [config] valid-mini-batch: 32
[2023-07-04 21:06:50] [config] valid-reset-stalled: false
[2023-07-04 21:06:50] [config] valid-script-args:
[2023-07-04 21:06:50] [config]   []
[2023-07-04 21:06:50] [config] valid-script-path: ""
[2023-07-04 21:06:50] [config] valid-sets:
[2023-07-04 21:06:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:06:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:06:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:06:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:06:50] [config] vocabs:
[2023-07-04 21:06:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:06:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:06:50] [config] word-penalty: 0
[2023-07-04 21:06:50] [config] word-scores: false
[2023-07-04 21:06:50] [config] workspace: 2048
[2023-07-04 21:06:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:06:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:06:50] [training] Using single-device training
[2023-07-04 21:06:50] Synced seed 1234
[2023-07-04 21:06:50] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:06:50] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:06:50] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:06:50] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:06:50] [valid] No post-processing script given for validating translator
[2023-07-04 21:06:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:06:51] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:06:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:06:51] [comm] Using global sharding
[2023-07-04 21:06:51] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:06:51] [training] Using 1 GPUs
[2023-07-04 21:06:51] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:06:53] Loading Adam parameters
[2023-07-04 21:06:54] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:06:54] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:06:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:06:54] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-07-04 21:06:54] [data] Shuffling data
[2023-07-04 21:06:54] [data] Done reading 20,192 sentences
[2023-07-04 21:06:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:06:54] Training started
[2023-07-04 21:06:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-04 21:06:54] [logits] Applying loss function for 1 factor(s)
[2023-07-04 21:06:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-04 21:06:54] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:06:54] Parameter type float32, optimization type float32, casting types false
[2023-07-04 21:07:13] Seen 18,843 samples
[2023-07-04 21:07:13] Starting data epoch 102 in logical epoch 102
[2023-07-04 21:07:13] [data] Shuffling data
[2023-07-04 21:07:13] [data] Done reading 20,192 sentences
[2023-07-04 21:07:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:07:16] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.00660123 * 1,341,254 @ 2,240 after 40,247,594 : Time 25.48s : 52646.28 words/s : gNorm 0.3137
[2023-07-04 21:07:16] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:07:19] Saving Adam parameters
[2023-07-04 21:07:19] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:07:41] Seen 18,843 samples
[2023-07-04 21:07:41] Starting data epoch 103 in logical epoch 103
[2023-07-04 21:07:41] [data] Shuffling data
[2023-07-04 21:07:41] [data] Done reading 20,192 sentences
[2023-07-04 21:07:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:08:04] Seen 18,843 samples
[2023-07-04 21:08:04] Starting data epoch 104 in logical epoch 104
[2023-07-04 21:08:04] [data] Shuffling data
[2023-07-04 21:08:04] [data] Done reading 20,192 sentences
[2023-07-04 21:08:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:08:26] Seen 18,843 samples
[2023-07-04 21:08:26] Starting data epoch 105 in logical epoch 105
[2023-07-04 21:08:26] [data] Shuffling data
[2023-07-04 21:08:26] [data] Done reading 20,192 sentences
[2023-07-04 21:08:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:08:39] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.00636840 * 1,341,970 @ 1,536 after 41,589,564 : Time 83.22s : 16126.00 words/s : gNorm 0.4298
[2023-07-04 21:08:51] Seen 18,843 samples
[2023-07-04 21:08:51] Starting data epoch 106 in logical epoch 106
[2023-07-04 21:08:51] [data] Shuffling data
[2023-07-04 21:08:51] [data] Done reading 20,192 sentences
[2023-07-04 21:08:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:09:15] Seen 18,843 samples
[2023-07-04 21:09:15] Starting data epoch 107 in logical epoch 107
[2023-07-04 21:09:15] [data] Shuffling data
[2023-07-04 21:09:15] [data] Done reading 20,192 sentences
[2023-07-04 21:09:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:09:39] Seen 18,843 samples
[2023-07-04 21:09:39] Starting data epoch 108 in logical epoch 108
[2023-07-04 21:09:39] [data] Shuffling data
[2023-07-04 21:09:39] [data] Done reading 20,192 sentences
[2023-07-04 21:09:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:09:58] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.00641399 * 1,331,544 @ 948 after 42,921,108 : Time 79.24s : 16803.17 words/s : gNorm 0.3570
[2023-07-04 21:10:01] Seen 18,843 samples
[2023-07-04 21:10:01] Starting data epoch 109 in logical epoch 109
[2023-07-04 21:10:01] [data] Shuffling data
[2023-07-04 21:10:01] [data] Done reading 20,192 sentences
[2023-07-04 21:10:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:10:24] Seen 18,843 samples
[2023-07-04 21:10:24] Starting data epoch 110 in logical epoch 110
[2023-07-04 21:10:24] [data] Shuffling data
[2023-07-04 21:10:24] [data] Done reading 20,192 sentences
[2023-07-04 21:10:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:10:47] Seen 18,843 samples
[2023-07-04 21:10:47] Starting data epoch 111 in logical epoch 111
[2023-07-04 21:10:47] Training finished
[2023-07-04 21:10:50] [valid] Ep. 111 : Up. 32628 : cross-entropy : 205.831 : stalled 10 times (last best: 125.788)
[2023-07-04 21:13:14] [valid] Ep. 111 : Up. 32628 : translation : 0 : new best
[2023-07-04 21:13:14] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:18] Saving Adam parameters
[2023-07-04 21:13:19] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:13:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:29] [marian] Running on node07.datos.cluster.uy as process 19784 with command line:
[2023-07-04 21:13:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:13:29] [config] after: 0e
[2023-07-04 21:13:29] [config] after-batches: 0
[2023-07-04 21:13:29] [config] after-epochs: 120
[2023-07-04 21:13:29] [config] all-caps-every: 0
[2023-07-04 21:13:29] [config] allow-unk: false
[2023-07-04 21:13:29] [config] authors: false
[2023-07-04 21:13:29] [config] beam-size: 12
[2023-07-04 21:13:29] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:13:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:13:29] [config] bert-masking-fraction: 0.15
[2023-07-04 21:13:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:13:29] [config] bert-train-type-embeddings: true
[2023-07-04 21:13:29] [config] bert-type-vocab-size: 2
[2023-07-04 21:13:29] [config] build-info: ""
[2023-07-04 21:13:29] [config] check-gradient-nan: false
[2023-07-04 21:13:29] [config] check-nan: false
[2023-07-04 21:13:29] [config] cite: false
[2023-07-04 21:13:29] [config] clip-norm: 1
[2023-07-04 21:13:29] [config] cost-scaling:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] cost-type: ce-sum
[2023-07-04 21:13:29] [config] cpu-threads: 0
[2023-07-04 21:13:29] [config] data-threads: 8
[2023-07-04 21:13:29] [config] data-weighting: ""
[2023-07-04 21:13:29] [config] data-weighting-type: sentence
[2023-07-04 21:13:29] [config] dec-cell: gru
[2023-07-04 21:13:29] [config] dec-cell-base-depth: 2
[2023-07-04 21:13:29] [config] dec-cell-high-depth: 1
[2023-07-04 21:13:29] [config] dec-depth: 1
[2023-07-04 21:13:29] [config] devices:
[2023-07-04 21:13:29] [config]   - 0
[2023-07-04 21:13:29] [config] dim-emb: 512
[2023-07-04 21:13:29] [config] dim-rnn: 1024
[2023-07-04 21:13:29] [config] dim-vocabs:
[2023-07-04 21:13:29] [config]   - 54042
[2023-07-04 21:13:29] [config]   - 36507
[2023-07-04 21:13:29] [config] disp-first: 0
[2023-07-04 21:13:29] [config] disp-freq: 1000u
[2023-07-04 21:13:29] [config] disp-label-counts: true
[2023-07-04 21:13:29] [config] dropout-rnn: 0
[2023-07-04 21:13:29] [config] dropout-src: 0
[2023-07-04 21:13:29] [config] dropout-trg: 0
[2023-07-04 21:13:29] [config] dump-config: ""
[2023-07-04 21:13:29] [config] dynamic-gradient-scaling:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] early-stopping: 10
[2023-07-04 21:13:29] [config] early-stopping-on: first
[2023-07-04 21:13:29] [config] embedding-fix-src: false
[2023-07-04 21:13:29] [config] embedding-fix-trg: false
[2023-07-04 21:13:29] [config] embedding-normalization: false
[2023-07-04 21:13:29] [config] embedding-vectors:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] enc-cell: gru
[2023-07-04 21:13:29] [config] enc-cell-depth: 1
[2023-07-04 21:13:29] [config] enc-depth: 1
[2023-07-04 21:13:29] [config] enc-type: bidirectional
[2023-07-04 21:13:29] [config] english-title-case-every: 0
[2023-07-04 21:13:29] [config] exponential-smoothing: 0
[2023-07-04 21:13:29] [config] factor-weight: 1
[2023-07-04 21:13:29] [config] factors-combine: sum
[2023-07-04 21:13:29] [config] factors-dim-emb: 0
[2023-07-04 21:13:29] [config] gradient-checkpointing: false
[2023-07-04 21:13:29] [config] gradient-norm-average-window: 100
[2023-07-04 21:13:29] [config] guided-alignment: none
[2023-07-04 21:13:29] [config] guided-alignment-cost: mse
[2023-07-04 21:13:29] [config] guided-alignment-weight: 0.1
[2023-07-04 21:13:29] [config] ignore-model-config: false
[2023-07-04 21:13:29] [config] input-types:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] interpolate-env-vars: false
[2023-07-04 21:13:29] [config] keep-best: false
[2023-07-04 21:13:29] [config] label-smoothing: 0
[2023-07-04 21:13:29] [config] layer-normalization: false
[2023-07-04 21:13:29] [config] learn-rate: 0.0001
[2023-07-04 21:13:29] [config] lemma-dependency: ""
[2023-07-04 21:13:29] [config] lemma-dim-emb: 0
[2023-07-04 21:13:29] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:13:29] [config] log-level: info
[2023-07-04 21:13:29] [config] log-time-zone: ""
[2023-07-04 21:13:29] [config] logical-epoch:
[2023-07-04 21:13:29] [config]   - 1e
[2023-07-04 21:13:29] [config]   - 0
[2023-07-04 21:13:29] [config] lr-decay: 0
[2023-07-04 21:13:29] [config] lr-decay-freq: 50000
[2023-07-04 21:13:29] [config] lr-decay-inv-sqrt:
[2023-07-04 21:13:29] [config]   - 0
[2023-07-04 21:13:29] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:13:29] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:13:29] [config] lr-decay-start:
[2023-07-04 21:13:29] [config]   - 10
[2023-07-04 21:13:29] [config]   - 1
[2023-07-04 21:13:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:13:29] [config] lr-report: false
[2023-07-04 21:13:29] [config] lr-warmup: 0
[2023-07-04 21:13:29] [config] lr-warmup-at-reload: false
[2023-07-04 21:13:29] [config] lr-warmup-cycle: false
[2023-07-04 21:13:29] [config] lr-warmup-start-rate: 0
[2023-07-04 21:13:29] [config] max-length: 50
[2023-07-04 21:13:29] [config] max-length-crop: false
[2023-07-04 21:13:29] [config] max-length-factor: 3
[2023-07-04 21:13:29] [config] maxi-batch: 100
[2023-07-04 21:13:29] [config] maxi-batch-sort: trg
[2023-07-04 21:13:29] [config] mini-batch: 64
[2023-07-04 21:13:29] [config] mini-batch-fit: false
[2023-07-04 21:13:29] [config] mini-batch-fit-step: 10
[2023-07-04 21:13:29] [config] mini-batch-round-up: true
[2023-07-04 21:13:29] [config] mini-batch-track-lr: false
[2023-07-04 21:13:29] [config] mini-batch-warmup: 0
[2023-07-04 21:13:29] [config] mini-batch-words: 0
[2023-07-04 21:13:29] [config] mini-batch-words-ref: 0
[2023-07-04 21:13:29] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:29] [config] multi-loss-type: sum
[2023-07-04 21:13:29] [config] n-best: false
[2023-07-04 21:13:29] [config] no-nccl: false
[2023-07-04 21:13:29] [config] no-reload: false
[2023-07-04 21:13:29] [config] no-restore-corpus: false
[2023-07-04 21:13:29] [config] normalize: 0
[2023-07-04 21:13:29] [config] normalize-gradient: false
[2023-07-04 21:13:29] [config] num-devices: 0
[2023-07-04 21:13:29] [config] optimizer: adam
[2023-07-04 21:13:29] [config] optimizer-delay: 1
[2023-07-04 21:13:29] [config] optimizer-params:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] output-omit-bias: false
[2023-07-04 21:13:29] [config] overwrite: true
[2023-07-04 21:13:29] [config] precision:
[2023-07-04 21:13:29] [config]   - float32
[2023-07-04 21:13:29] [config]   - float32
[2023-07-04 21:13:29] [config] pretrained-model: ""
[2023-07-04 21:13:29] [config] quantize-biases: false
[2023-07-04 21:13:29] [config] quantize-bits: 0
[2023-07-04 21:13:29] [config] quantize-log-based: false
[2023-07-04 21:13:29] [config] quantize-optimization-steps: 0
[2023-07-04 21:13:29] [config] quiet: false
[2023-07-04 21:13:29] [config] quiet-translation: true
[2023-07-04 21:13:29] [config] relative-paths: false
[2023-07-04 21:13:29] [config] right-left: false
[2023-07-04 21:13:29] [config] save-freq: 10000u
[2023-07-04 21:13:29] [config] seed: 1234
[2023-07-04 21:13:29] [config] sentencepiece-alphas:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:13:29] [config] sentencepiece-options: ""
[2023-07-04 21:13:29] [config] sharding: global
[2023-07-04 21:13:29] [config] shuffle: data
[2023-07-04 21:13:29] [config] shuffle-in-ram: false
[2023-07-04 21:13:29] [config] sigterm: save-and-exit
[2023-07-04 21:13:29] [config] skip: false
[2023-07-04 21:13:29] [config] sqlite: ""
[2023-07-04 21:13:29] [config] sqlite-drop: false
[2023-07-04 21:13:29] [config] sync-freq: 200u
[2023-07-04 21:13:29] [config] sync-sgd: false
[2023-07-04 21:13:29] [config] tempdir: /tmp
[2023-07-04 21:13:29] [config] tied-embeddings: false
[2023-07-04 21:13:29] [config] tied-embeddings-all: false
[2023-07-04 21:13:29] [config] tied-embeddings-src: false
[2023-07-04 21:13:29] [config] train-embedder-rank:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] train-sets:
[2023-07-04 21:13:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:13:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:13:29] [config] transformer-aan-activation: swish
[2023-07-04 21:13:29] [config] transformer-aan-depth: 2
[2023-07-04 21:13:29] [config] transformer-aan-nogate: false
[2023-07-04 21:13:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:13:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:13:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:13:29] [config] transformer-depth-scaling: false
[2023-07-04 21:13:29] [config] transformer-dim-aan: 2048
[2023-07-04 21:13:29] [config] transformer-dim-ffn: 2048
[2023-07-04 21:13:29] [config] transformer-dropout: 0
[2023-07-04 21:13:29] [config] transformer-dropout-attention: 0
[2023-07-04 21:13:29] [config] transformer-dropout-ffn: 0
[2023-07-04 21:13:29] [config] transformer-ffn-activation: swish
[2023-07-04 21:13:29] [config] transformer-ffn-depth: 2
[2023-07-04 21:13:29] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:13:29] [config] transformer-heads: 8
[2023-07-04 21:13:29] [config] transformer-no-projection: false
[2023-07-04 21:13:29] [config] transformer-pool: false
[2023-07-04 21:13:29] [config] transformer-postprocess: dan
[2023-07-04 21:13:29] [config] transformer-postprocess-emb: d
[2023-07-04 21:13:29] [config] transformer-postprocess-top: ""
[2023-07-04 21:13:29] [config] transformer-preprocess: ""
[2023-07-04 21:13:29] [config] transformer-tied-layers:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] transformer-train-position-embeddings: false
[2023-07-04 21:13:29] [config] tsv: false
[2023-07-04 21:13:29] [config] tsv-fields: 0
[2023-07-04 21:13:29] [config] type: transformer
[2023-07-04 21:13:29] [config] ulr: false
[2023-07-04 21:13:29] [config] ulr-dim-emb: 0
[2023-07-04 21:13:29] [config] ulr-dropout: 0
[2023-07-04 21:13:29] [config] ulr-keys-vectors: ""
[2023-07-04 21:13:29] [config] ulr-query-vectors: ""
[2023-07-04 21:13:29] [config] ulr-softmax-temperature: 1
[2023-07-04 21:13:29] [config] ulr-trainable-transformation: false
[2023-07-04 21:13:29] [config] unlikelihood-loss: false
[2023-07-04 21:13:29] [config] valid-freq: 50000000
[2023-07-04 21:13:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:13:29] [config] valid-max-length: 1000
[2023-07-04 21:13:29] [config] valid-metrics:
[2023-07-04 21:13:29] [config]   - cross-entropy
[2023-07-04 21:13:29] [config]   - translation
[2023-07-04 21:13:29] [config] valid-mini-batch: 32
[2023-07-04 21:13:29] [config] valid-reset-stalled: false
[2023-07-04 21:13:29] [config] valid-script-args:
[2023-07-04 21:13:29] [config]   []
[2023-07-04 21:13:29] [config] valid-script-path: ""
[2023-07-04 21:13:29] [config] valid-sets:
[2023-07-04 21:13:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:13:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:13:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:13:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:29] [config] vocabs:
[2023-07-04 21:13:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:29] [config] word-penalty: 0
[2023-07-04 21:13:29] [config] word-scores: false
[2023-07-04 21:13:29] [config] workspace: 2048
[2023-07-04 21:13:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:29] [training] Using single-device training
[2023-07-04 21:13:29] Synced seed 1234
[2023-07-04 21:13:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:29] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:13:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:29] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:13:29] [valid] No post-processing script given for validating translator
[2023-07-04 21:13:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:30] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:13:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:13:30] [comm] Using global sharding
[2023-07-04 21:13:30] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:13:30] [training] Using 1 GPUs
[2023-07-04 21:13:30] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:32] Loading Adam parameters
[2023-07-04 21:13:33] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:13:33] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:13:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:13:33] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:13:33] [data] Shuffling data
[2023-07-04 21:13:33] [data] Done reading 20,192 sentences
[2023-07-04 21:13:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:13:33] Training started
[2023-07-04 21:13:33] Training finished
[2023-07-04 21:13:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:37] [marian] Running on node07.datos.cluster.uy as process 19879 with command line:
[2023-07-04 21:13:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:13:37] [config] after: 0e
[2023-07-04 21:13:37] [config] after-batches: 0
[2023-07-04 21:13:37] [config] after-epochs: 130
[2023-07-04 21:13:37] [config] all-caps-every: 0
[2023-07-04 21:13:37] [config] allow-unk: false
[2023-07-04 21:13:37] [config] authors: false
[2023-07-04 21:13:37] [config] beam-size: 12
[2023-07-04 21:13:37] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:13:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:13:37] [config] bert-masking-fraction: 0.15
[2023-07-04 21:13:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:13:37] [config] bert-train-type-embeddings: true
[2023-07-04 21:13:37] [config] bert-type-vocab-size: 2
[2023-07-04 21:13:37] [config] build-info: ""
[2023-07-04 21:13:37] [config] check-gradient-nan: false
[2023-07-04 21:13:37] [config] check-nan: false
[2023-07-04 21:13:37] [config] cite: false
[2023-07-04 21:13:37] [config] clip-norm: 1
[2023-07-04 21:13:37] [config] cost-scaling:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] cost-type: ce-sum
[2023-07-04 21:13:37] [config] cpu-threads: 0
[2023-07-04 21:13:37] [config] data-threads: 8
[2023-07-04 21:13:37] [config] data-weighting: ""
[2023-07-04 21:13:37] [config] data-weighting-type: sentence
[2023-07-04 21:13:37] [config] dec-cell: gru
[2023-07-04 21:13:37] [config] dec-cell-base-depth: 2
[2023-07-04 21:13:37] [config] dec-cell-high-depth: 1
[2023-07-04 21:13:37] [config] dec-depth: 1
[2023-07-04 21:13:37] [config] devices:
[2023-07-04 21:13:37] [config]   - 0
[2023-07-04 21:13:37] [config] dim-emb: 512
[2023-07-04 21:13:37] [config] dim-rnn: 1024
[2023-07-04 21:13:37] [config] dim-vocabs:
[2023-07-04 21:13:37] [config]   - 54042
[2023-07-04 21:13:37] [config]   - 36507
[2023-07-04 21:13:37] [config] disp-first: 0
[2023-07-04 21:13:37] [config] disp-freq: 1000u
[2023-07-04 21:13:37] [config] disp-label-counts: true
[2023-07-04 21:13:37] [config] dropout-rnn: 0
[2023-07-04 21:13:37] [config] dropout-src: 0
[2023-07-04 21:13:37] [config] dropout-trg: 0
[2023-07-04 21:13:37] [config] dump-config: ""
[2023-07-04 21:13:37] [config] dynamic-gradient-scaling:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] early-stopping: 10
[2023-07-04 21:13:37] [config] early-stopping-on: first
[2023-07-04 21:13:37] [config] embedding-fix-src: false
[2023-07-04 21:13:37] [config] embedding-fix-trg: false
[2023-07-04 21:13:37] [config] embedding-normalization: false
[2023-07-04 21:13:37] [config] embedding-vectors:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] enc-cell: gru
[2023-07-04 21:13:37] [config] enc-cell-depth: 1
[2023-07-04 21:13:37] [config] enc-depth: 1
[2023-07-04 21:13:37] [config] enc-type: bidirectional
[2023-07-04 21:13:37] [config] english-title-case-every: 0
[2023-07-04 21:13:37] [config] exponential-smoothing: 0
[2023-07-04 21:13:37] [config] factor-weight: 1
[2023-07-04 21:13:37] [config] factors-combine: sum
[2023-07-04 21:13:37] [config] factors-dim-emb: 0
[2023-07-04 21:13:37] [config] gradient-checkpointing: false
[2023-07-04 21:13:37] [config] gradient-norm-average-window: 100
[2023-07-04 21:13:37] [config] guided-alignment: none
[2023-07-04 21:13:37] [config] guided-alignment-cost: mse
[2023-07-04 21:13:37] [config] guided-alignment-weight: 0.1
[2023-07-04 21:13:37] [config] ignore-model-config: false
[2023-07-04 21:13:37] [config] input-types:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] interpolate-env-vars: false
[2023-07-04 21:13:37] [config] keep-best: false
[2023-07-04 21:13:37] [config] label-smoothing: 0
[2023-07-04 21:13:37] [config] layer-normalization: false
[2023-07-04 21:13:37] [config] learn-rate: 0.0001
[2023-07-04 21:13:37] [config] lemma-dependency: ""
[2023-07-04 21:13:37] [config] lemma-dim-emb: 0
[2023-07-04 21:13:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:13:37] [config] log-level: info
[2023-07-04 21:13:37] [config] log-time-zone: ""
[2023-07-04 21:13:37] [config] logical-epoch:
[2023-07-04 21:13:37] [config]   - 1e
[2023-07-04 21:13:37] [config]   - 0
[2023-07-04 21:13:37] [config] lr-decay: 0
[2023-07-04 21:13:37] [config] lr-decay-freq: 50000
[2023-07-04 21:13:37] [config] lr-decay-inv-sqrt:
[2023-07-04 21:13:37] [config]   - 0
[2023-07-04 21:13:37] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:13:37] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:13:37] [config] lr-decay-start:
[2023-07-04 21:13:37] [config]   - 10
[2023-07-04 21:13:37] [config]   - 1
[2023-07-04 21:13:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:13:37] [config] lr-report: false
[2023-07-04 21:13:37] [config] lr-warmup: 0
[2023-07-04 21:13:37] [config] lr-warmup-at-reload: false
[2023-07-04 21:13:37] [config] lr-warmup-cycle: false
[2023-07-04 21:13:37] [config] lr-warmup-start-rate: 0
[2023-07-04 21:13:37] [config] max-length: 50
[2023-07-04 21:13:37] [config] max-length-crop: false
[2023-07-04 21:13:37] [config] max-length-factor: 3
[2023-07-04 21:13:37] [config] maxi-batch: 100
[2023-07-04 21:13:37] [config] maxi-batch-sort: trg
[2023-07-04 21:13:37] [config] mini-batch: 64
[2023-07-04 21:13:37] [config] mini-batch-fit: false
[2023-07-04 21:13:37] [config] mini-batch-fit-step: 10
[2023-07-04 21:13:37] [config] mini-batch-round-up: true
[2023-07-04 21:13:37] [config] mini-batch-track-lr: false
[2023-07-04 21:13:37] [config] mini-batch-warmup: 0
[2023-07-04 21:13:37] [config] mini-batch-words: 0
[2023-07-04 21:13:37] [config] mini-batch-words-ref: 0
[2023-07-04 21:13:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:37] [config] multi-loss-type: sum
[2023-07-04 21:13:37] [config] n-best: false
[2023-07-04 21:13:37] [config] no-nccl: false
[2023-07-04 21:13:37] [config] no-reload: false
[2023-07-04 21:13:37] [config] no-restore-corpus: false
[2023-07-04 21:13:37] [config] normalize: 0
[2023-07-04 21:13:37] [config] normalize-gradient: false
[2023-07-04 21:13:37] [config] num-devices: 0
[2023-07-04 21:13:37] [config] optimizer: adam
[2023-07-04 21:13:37] [config] optimizer-delay: 1
[2023-07-04 21:13:37] [config] optimizer-params:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] output-omit-bias: false
[2023-07-04 21:13:37] [config] overwrite: true
[2023-07-04 21:13:37] [config] precision:
[2023-07-04 21:13:37] [config]   - float32
[2023-07-04 21:13:37] [config]   - float32
[2023-07-04 21:13:37] [config] pretrained-model: ""
[2023-07-04 21:13:37] [config] quantize-biases: false
[2023-07-04 21:13:37] [config] quantize-bits: 0
[2023-07-04 21:13:37] [config] quantize-log-based: false
[2023-07-04 21:13:37] [config] quantize-optimization-steps: 0
[2023-07-04 21:13:37] [config] quiet: false
[2023-07-04 21:13:37] [config] quiet-translation: true
[2023-07-04 21:13:37] [config] relative-paths: false
[2023-07-04 21:13:37] [config] right-left: false
[2023-07-04 21:13:37] [config] save-freq: 10000u
[2023-07-04 21:13:37] [config] seed: 1234
[2023-07-04 21:13:37] [config] sentencepiece-alphas:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:13:37] [config] sentencepiece-options: ""
[2023-07-04 21:13:37] [config] sharding: global
[2023-07-04 21:13:37] [config] shuffle: data
[2023-07-04 21:13:37] [config] shuffle-in-ram: false
[2023-07-04 21:13:37] [config] sigterm: save-and-exit
[2023-07-04 21:13:37] [config] skip: false
[2023-07-04 21:13:37] [config] sqlite: ""
[2023-07-04 21:13:37] [config] sqlite-drop: false
[2023-07-04 21:13:37] [config] sync-freq: 200u
[2023-07-04 21:13:37] [config] sync-sgd: false
[2023-07-04 21:13:37] [config] tempdir: /tmp
[2023-07-04 21:13:37] [config] tied-embeddings: false
[2023-07-04 21:13:37] [config] tied-embeddings-all: false
[2023-07-04 21:13:37] [config] tied-embeddings-src: false
[2023-07-04 21:13:37] [config] train-embedder-rank:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] train-sets:
[2023-07-04 21:13:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:13:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:13:37] [config] transformer-aan-activation: swish
[2023-07-04 21:13:37] [config] transformer-aan-depth: 2
[2023-07-04 21:13:37] [config] transformer-aan-nogate: false
[2023-07-04 21:13:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:13:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:13:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:13:37] [config] transformer-depth-scaling: false
[2023-07-04 21:13:37] [config] transformer-dim-aan: 2048
[2023-07-04 21:13:37] [config] transformer-dim-ffn: 2048
[2023-07-04 21:13:37] [config] transformer-dropout: 0
[2023-07-04 21:13:37] [config] transformer-dropout-attention: 0
[2023-07-04 21:13:37] [config] transformer-dropout-ffn: 0
[2023-07-04 21:13:37] [config] transformer-ffn-activation: swish
[2023-07-04 21:13:37] [config] transformer-ffn-depth: 2
[2023-07-04 21:13:37] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:13:37] [config] transformer-heads: 8
[2023-07-04 21:13:37] [config] transformer-no-projection: false
[2023-07-04 21:13:37] [config] transformer-pool: false
[2023-07-04 21:13:37] [config] transformer-postprocess: dan
[2023-07-04 21:13:37] [config] transformer-postprocess-emb: d
[2023-07-04 21:13:37] [config] transformer-postprocess-top: ""
[2023-07-04 21:13:37] [config] transformer-preprocess: ""
[2023-07-04 21:13:37] [config] transformer-tied-layers:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] transformer-train-position-embeddings: false
[2023-07-04 21:13:37] [config] tsv: false
[2023-07-04 21:13:37] [config] tsv-fields: 0
[2023-07-04 21:13:37] [config] type: transformer
[2023-07-04 21:13:37] [config] ulr: false
[2023-07-04 21:13:37] [config] ulr-dim-emb: 0
[2023-07-04 21:13:37] [config] ulr-dropout: 0
[2023-07-04 21:13:37] [config] ulr-keys-vectors: ""
[2023-07-04 21:13:37] [config] ulr-query-vectors: ""
[2023-07-04 21:13:37] [config] ulr-softmax-temperature: 1
[2023-07-04 21:13:37] [config] ulr-trainable-transformation: false
[2023-07-04 21:13:37] [config] unlikelihood-loss: false
[2023-07-04 21:13:37] [config] valid-freq: 50000000
[2023-07-04 21:13:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:13:37] [config] valid-max-length: 1000
[2023-07-04 21:13:37] [config] valid-metrics:
[2023-07-04 21:13:37] [config]   - cross-entropy
[2023-07-04 21:13:37] [config]   - translation
[2023-07-04 21:13:37] [config] valid-mini-batch: 32
[2023-07-04 21:13:37] [config] valid-reset-stalled: false
[2023-07-04 21:13:37] [config] valid-script-args:
[2023-07-04 21:13:37] [config]   []
[2023-07-04 21:13:37] [config] valid-script-path: ""
[2023-07-04 21:13:37] [config] valid-sets:
[2023-07-04 21:13:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:13:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:13:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:13:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:37] [config] vocabs:
[2023-07-04 21:13:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:37] [config] word-penalty: 0
[2023-07-04 21:13:37] [config] word-scores: false
[2023-07-04 21:13:37] [config] workspace: 2048
[2023-07-04 21:13:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:37] [training] Using single-device training
[2023-07-04 21:13:37] Synced seed 1234
[2023-07-04 21:13:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:37] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:13:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:37] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:13:37] [valid] No post-processing script given for validating translator
[2023-07-04 21:13:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:38] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:13:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:13:38] [comm] Using global sharding
[2023-07-04 21:13:38] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:13:38] [training] Using 1 GPUs
[2023-07-04 21:13:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:39] Loading Adam parameters
[2023-07-04 21:13:40] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:13:40] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:13:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:13:40] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:13:40] [data] Shuffling data
[2023-07-04 21:13:40] [data] Done reading 20,192 sentences
[2023-07-04 21:13:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:13:40] Training started
[2023-07-04 21:13:40] Training finished
[2023-07-04 21:13:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:44] [marian] Running on node07.datos.cluster.uy as process 20026 with command line:
[2023-07-04 21:13:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:13:44] [config] after: 0e
[2023-07-04 21:13:44] [config] after-batches: 0
[2023-07-04 21:13:44] [config] after-epochs: 140
[2023-07-04 21:13:44] [config] all-caps-every: 0
[2023-07-04 21:13:44] [config] allow-unk: false
[2023-07-04 21:13:44] [config] authors: false
[2023-07-04 21:13:44] [config] beam-size: 12
[2023-07-04 21:13:44] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:13:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:13:44] [config] bert-masking-fraction: 0.15
[2023-07-04 21:13:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:13:44] [config] bert-train-type-embeddings: true
[2023-07-04 21:13:44] [config] bert-type-vocab-size: 2
[2023-07-04 21:13:44] [config] build-info: ""
[2023-07-04 21:13:44] [config] check-gradient-nan: false
[2023-07-04 21:13:44] [config] check-nan: false
[2023-07-04 21:13:44] [config] cite: false
[2023-07-04 21:13:44] [config] clip-norm: 1
[2023-07-04 21:13:44] [config] cost-scaling:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] cost-type: ce-sum
[2023-07-04 21:13:44] [config] cpu-threads: 0
[2023-07-04 21:13:44] [config] data-threads: 8
[2023-07-04 21:13:44] [config] data-weighting: ""
[2023-07-04 21:13:44] [config] data-weighting-type: sentence
[2023-07-04 21:13:44] [config] dec-cell: gru
[2023-07-04 21:13:44] [config] dec-cell-base-depth: 2
[2023-07-04 21:13:44] [config] dec-cell-high-depth: 1
[2023-07-04 21:13:44] [config] dec-depth: 1
[2023-07-04 21:13:44] [config] devices:
[2023-07-04 21:13:44] [config]   - 0
[2023-07-04 21:13:44] [config] dim-emb: 512
[2023-07-04 21:13:44] [config] dim-rnn: 1024
[2023-07-04 21:13:44] [config] dim-vocabs:
[2023-07-04 21:13:44] [config]   - 54042
[2023-07-04 21:13:44] [config]   - 36507
[2023-07-04 21:13:44] [config] disp-first: 0
[2023-07-04 21:13:44] [config] disp-freq: 1000u
[2023-07-04 21:13:44] [config] disp-label-counts: true
[2023-07-04 21:13:44] [config] dropout-rnn: 0
[2023-07-04 21:13:44] [config] dropout-src: 0
[2023-07-04 21:13:44] [config] dropout-trg: 0
[2023-07-04 21:13:44] [config] dump-config: ""
[2023-07-04 21:13:44] [config] dynamic-gradient-scaling:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] early-stopping: 10
[2023-07-04 21:13:44] [config] early-stopping-on: first
[2023-07-04 21:13:44] [config] embedding-fix-src: false
[2023-07-04 21:13:44] [config] embedding-fix-trg: false
[2023-07-04 21:13:44] [config] embedding-normalization: false
[2023-07-04 21:13:44] [config] embedding-vectors:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] enc-cell: gru
[2023-07-04 21:13:44] [config] enc-cell-depth: 1
[2023-07-04 21:13:44] [config] enc-depth: 1
[2023-07-04 21:13:44] [config] enc-type: bidirectional
[2023-07-04 21:13:44] [config] english-title-case-every: 0
[2023-07-04 21:13:44] [config] exponential-smoothing: 0
[2023-07-04 21:13:44] [config] factor-weight: 1
[2023-07-04 21:13:44] [config] factors-combine: sum
[2023-07-04 21:13:44] [config] factors-dim-emb: 0
[2023-07-04 21:13:44] [config] gradient-checkpointing: false
[2023-07-04 21:13:44] [config] gradient-norm-average-window: 100
[2023-07-04 21:13:44] [config] guided-alignment: none
[2023-07-04 21:13:44] [config] guided-alignment-cost: mse
[2023-07-04 21:13:44] [config] guided-alignment-weight: 0.1
[2023-07-04 21:13:44] [config] ignore-model-config: false
[2023-07-04 21:13:44] [config] input-types:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] interpolate-env-vars: false
[2023-07-04 21:13:44] [config] keep-best: false
[2023-07-04 21:13:44] [config] label-smoothing: 0
[2023-07-04 21:13:44] [config] layer-normalization: false
[2023-07-04 21:13:44] [config] learn-rate: 0.0001
[2023-07-04 21:13:44] [config] lemma-dependency: ""
[2023-07-04 21:13:44] [config] lemma-dim-emb: 0
[2023-07-04 21:13:44] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:13:44] [config] log-level: info
[2023-07-04 21:13:44] [config] log-time-zone: ""
[2023-07-04 21:13:44] [config] logical-epoch:
[2023-07-04 21:13:44] [config]   - 1e
[2023-07-04 21:13:44] [config]   - 0
[2023-07-04 21:13:44] [config] lr-decay: 0
[2023-07-04 21:13:44] [config] lr-decay-freq: 50000
[2023-07-04 21:13:44] [config] lr-decay-inv-sqrt:
[2023-07-04 21:13:44] [config]   - 0
[2023-07-04 21:13:44] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:13:44] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:13:44] [config] lr-decay-start:
[2023-07-04 21:13:44] [config]   - 10
[2023-07-04 21:13:44] [config]   - 1
[2023-07-04 21:13:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:13:44] [config] lr-report: false
[2023-07-04 21:13:44] [config] lr-warmup: 0
[2023-07-04 21:13:44] [config] lr-warmup-at-reload: false
[2023-07-04 21:13:44] [config] lr-warmup-cycle: false
[2023-07-04 21:13:44] [config] lr-warmup-start-rate: 0
[2023-07-04 21:13:44] [config] max-length: 50
[2023-07-04 21:13:44] [config] max-length-crop: false
[2023-07-04 21:13:44] [config] max-length-factor: 3
[2023-07-04 21:13:44] [config] maxi-batch: 100
[2023-07-04 21:13:44] [config] maxi-batch-sort: trg
[2023-07-04 21:13:44] [config] mini-batch: 64
[2023-07-04 21:13:44] [config] mini-batch-fit: false
[2023-07-04 21:13:44] [config] mini-batch-fit-step: 10
[2023-07-04 21:13:44] [config] mini-batch-round-up: true
[2023-07-04 21:13:44] [config] mini-batch-track-lr: false
[2023-07-04 21:13:44] [config] mini-batch-warmup: 0
[2023-07-04 21:13:44] [config] mini-batch-words: 0
[2023-07-04 21:13:44] [config] mini-batch-words-ref: 0
[2023-07-04 21:13:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:44] [config] multi-loss-type: sum
[2023-07-04 21:13:44] [config] n-best: false
[2023-07-04 21:13:44] [config] no-nccl: false
[2023-07-04 21:13:44] [config] no-reload: false
[2023-07-04 21:13:44] [config] no-restore-corpus: false
[2023-07-04 21:13:44] [config] normalize: 0
[2023-07-04 21:13:44] [config] normalize-gradient: false
[2023-07-04 21:13:44] [config] num-devices: 0
[2023-07-04 21:13:44] [config] optimizer: adam
[2023-07-04 21:13:44] [config] optimizer-delay: 1
[2023-07-04 21:13:44] [config] optimizer-params:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] output-omit-bias: false
[2023-07-04 21:13:44] [config] overwrite: true
[2023-07-04 21:13:44] [config] precision:
[2023-07-04 21:13:44] [config]   - float32
[2023-07-04 21:13:44] [config]   - float32
[2023-07-04 21:13:44] [config] pretrained-model: ""
[2023-07-04 21:13:44] [config] quantize-biases: false
[2023-07-04 21:13:44] [config] quantize-bits: 0
[2023-07-04 21:13:44] [config] quantize-log-based: false
[2023-07-04 21:13:44] [config] quantize-optimization-steps: 0
[2023-07-04 21:13:44] [config] quiet: false
[2023-07-04 21:13:44] [config] quiet-translation: true
[2023-07-04 21:13:44] [config] relative-paths: false
[2023-07-04 21:13:44] [config] right-left: false
[2023-07-04 21:13:44] [config] save-freq: 10000u
[2023-07-04 21:13:44] [config] seed: 1234
[2023-07-04 21:13:44] [config] sentencepiece-alphas:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:13:44] [config] sentencepiece-options: ""
[2023-07-04 21:13:44] [config] sharding: global
[2023-07-04 21:13:44] [config] shuffle: data
[2023-07-04 21:13:44] [config] shuffle-in-ram: false
[2023-07-04 21:13:44] [config] sigterm: save-and-exit
[2023-07-04 21:13:44] [config] skip: false
[2023-07-04 21:13:44] [config] sqlite: ""
[2023-07-04 21:13:44] [config] sqlite-drop: false
[2023-07-04 21:13:44] [config] sync-freq: 200u
[2023-07-04 21:13:44] [config] sync-sgd: false
[2023-07-04 21:13:44] [config] tempdir: /tmp
[2023-07-04 21:13:44] [config] tied-embeddings: false
[2023-07-04 21:13:44] [config] tied-embeddings-all: false
[2023-07-04 21:13:44] [config] tied-embeddings-src: false
[2023-07-04 21:13:44] [config] train-embedder-rank:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] train-sets:
[2023-07-04 21:13:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:13:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:13:44] [config] transformer-aan-activation: swish
[2023-07-04 21:13:44] [config] transformer-aan-depth: 2
[2023-07-04 21:13:44] [config] transformer-aan-nogate: false
[2023-07-04 21:13:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:13:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:13:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:13:44] [config] transformer-depth-scaling: false
[2023-07-04 21:13:44] [config] transformer-dim-aan: 2048
[2023-07-04 21:13:44] [config] transformer-dim-ffn: 2048
[2023-07-04 21:13:44] [config] transformer-dropout: 0
[2023-07-04 21:13:44] [config] transformer-dropout-attention: 0
[2023-07-04 21:13:44] [config] transformer-dropout-ffn: 0
[2023-07-04 21:13:44] [config] transformer-ffn-activation: swish
[2023-07-04 21:13:44] [config] transformer-ffn-depth: 2
[2023-07-04 21:13:44] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:13:44] [config] transformer-heads: 8
[2023-07-04 21:13:44] [config] transformer-no-projection: false
[2023-07-04 21:13:44] [config] transformer-pool: false
[2023-07-04 21:13:44] [config] transformer-postprocess: dan
[2023-07-04 21:13:44] [config] transformer-postprocess-emb: d
[2023-07-04 21:13:44] [config] transformer-postprocess-top: ""
[2023-07-04 21:13:44] [config] transformer-preprocess: ""
[2023-07-04 21:13:44] [config] transformer-tied-layers:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] transformer-train-position-embeddings: false
[2023-07-04 21:13:44] [config] tsv: false
[2023-07-04 21:13:44] [config] tsv-fields: 0
[2023-07-04 21:13:44] [config] type: transformer
[2023-07-04 21:13:44] [config] ulr: false
[2023-07-04 21:13:44] [config] ulr-dim-emb: 0
[2023-07-04 21:13:44] [config] ulr-dropout: 0
[2023-07-04 21:13:44] [config] ulr-keys-vectors: ""
[2023-07-04 21:13:44] [config] ulr-query-vectors: ""
[2023-07-04 21:13:44] [config] ulr-softmax-temperature: 1
[2023-07-04 21:13:44] [config] ulr-trainable-transformation: false
[2023-07-04 21:13:44] [config] unlikelihood-loss: false
[2023-07-04 21:13:44] [config] valid-freq: 50000000
[2023-07-04 21:13:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:13:44] [config] valid-max-length: 1000
[2023-07-04 21:13:44] [config] valid-metrics:
[2023-07-04 21:13:44] [config]   - cross-entropy
[2023-07-04 21:13:44] [config]   - translation
[2023-07-04 21:13:44] [config] valid-mini-batch: 32
[2023-07-04 21:13:44] [config] valid-reset-stalled: false
[2023-07-04 21:13:44] [config] valid-script-args:
[2023-07-04 21:13:44] [config]   []
[2023-07-04 21:13:44] [config] valid-script-path: ""
[2023-07-04 21:13:44] [config] valid-sets:
[2023-07-04 21:13:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:13:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:13:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:13:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:44] [config] vocabs:
[2023-07-04 21:13:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:44] [config] word-penalty: 0
[2023-07-04 21:13:44] [config] word-scores: false
[2023-07-04 21:13:44] [config] workspace: 2048
[2023-07-04 21:13:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:44] [training] Using single-device training
[2023-07-04 21:13:44] Synced seed 1234
[2023-07-04 21:13:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:44] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:13:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:44] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:13:44] [valid] No post-processing script given for validating translator
[2023-07-04 21:13:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:45] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:13:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:13:45] [comm] Using global sharding
[2023-07-04 21:13:45] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:13:45] [training] Using 1 GPUs
[2023-07-04 21:13:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:46] Loading Adam parameters
[2023-07-04 21:13:46] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:13:47] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:13:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:13:47] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:13:47] [data] Shuffling data
[2023-07-04 21:13:47] [data] Done reading 20,192 sentences
[2023-07-04 21:13:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:13:47] Training started
[2023-07-04 21:13:47] Training finished
[2023-07-04 21:13:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:51] [marian] Running on node07.datos.cluster.uy as process 20103 with command line:
[2023-07-04 21:13:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:13:51] [config] after: 0e
[2023-07-04 21:13:51] [config] after-batches: 0
[2023-07-04 21:13:51] [config] after-epochs: 150
[2023-07-04 21:13:51] [config] all-caps-every: 0
[2023-07-04 21:13:51] [config] allow-unk: false
[2023-07-04 21:13:51] [config] authors: false
[2023-07-04 21:13:51] [config] beam-size: 12
[2023-07-04 21:13:51] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:13:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:13:51] [config] bert-masking-fraction: 0.15
[2023-07-04 21:13:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:13:51] [config] bert-train-type-embeddings: true
[2023-07-04 21:13:51] [config] bert-type-vocab-size: 2
[2023-07-04 21:13:51] [config] build-info: ""
[2023-07-04 21:13:51] [config] check-gradient-nan: false
[2023-07-04 21:13:51] [config] check-nan: false
[2023-07-04 21:13:51] [config] cite: false
[2023-07-04 21:13:51] [config] clip-norm: 1
[2023-07-04 21:13:51] [config] cost-scaling:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] cost-type: ce-sum
[2023-07-04 21:13:51] [config] cpu-threads: 0
[2023-07-04 21:13:51] [config] data-threads: 8
[2023-07-04 21:13:51] [config] data-weighting: ""
[2023-07-04 21:13:51] [config] data-weighting-type: sentence
[2023-07-04 21:13:51] [config] dec-cell: gru
[2023-07-04 21:13:51] [config] dec-cell-base-depth: 2
[2023-07-04 21:13:51] [config] dec-cell-high-depth: 1
[2023-07-04 21:13:51] [config] dec-depth: 1
[2023-07-04 21:13:51] [config] devices:
[2023-07-04 21:13:51] [config]   - 0
[2023-07-04 21:13:51] [config] dim-emb: 512
[2023-07-04 21:13:51] [config] dim-rnn: 1024
[2023-07-04 21:13:51] [config] dim-vocabs:
[2023-07-04 21:13:51] [config]   - 54042
[2023-07-04 21:13:51] [config]   - 36507
[2023-07-04 21:13:51] [config] disp-first: 0
[2023-07-04 21:13:51] [config] disp-freq: 1000u
[2023-07-04 21:13:51] [config] disp-label-counts: true
[2023-07-04 21:13:51] [config] dropout-rnn: 0
[2023-07-04 21:13:51] [config] dropout-src: 0
[2023-07-04 21:13:51] [config] dropout-trg: 0
[2023-07-04 21:13:51] [config] dump-config: ""
[2023-07-04 21:13:51] [config] dynamic-gradient-scaling:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] early-stopping: 10
[2023-07-04 21:13:51] [config] early-stopping-on: first
[2023-07-04 21:13:51] [config] embedding-fix-src: false
[2023-07-04 21:13:51] [config] embedding-fix-trg: false
[2023-07-04 21:13:51] [config] embedding-normalization: false
[2023-07-04 21:13:51] [config] embedding-vectors:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] enc-cell: gru
[2023-07-04 21:13:51] [config] enc-cell-depth: 1
[2023-07-04 21:13:51] [config] enc-depth: 1
[2023-07-04 21:13:51] [config] enc-type: bidirectional
[2023-07-04 21:13:51] [config] english-title-case-every: 0
[2023-07-04 21:13:51] [config] exponential-smoothing: 0
[2023-07-04 21:13:51] [config] factor-weight: 1
[2023-07-04 21:13:51] [config] factors-combine: sum
[2023-07-04 21:13:51] [config] factors-dim-emb: 0
[2023-07-04 21:13:51] [config] gradient-checkpointing: false
[2023-07-04 21:13:51] [config] gradient-norm-average-window: 100
[2023-07-04 21:13:51] [config] guided-alignment: none
[2023-07-04 21:13:51] [config] guided-alignment-cost: mse
[2023-07-04 21:13:51] [config] guided-alignment-weight: 0.1
[2023-07-04 21:13:51] [config] ignore-model-config: false
[2023-07-04 21:13:51] [config] input-types:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] interpolate-env-vars: false
[2023-07-04 21:13:51] [config] keep-best: false
[2023-07-04 21:13:51] [config] label-smoothing: 0
[2023-07-04 21:13:51] [config] layer-normalization: false
[2023-07-04 21:13:51] [config] learn-rate: 0.0001
[2023-07-04 21:13:51] [config] lemma-dependency: ""
[2023-07-04 21:13:51] [config] lemma-dim-emb: 0
[2023-07-04 21:13:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:13:51] [config] log-level: info
[2023-07-04 21:13:51] [config] log-time-zone: ""
[2023-07-04 21:13:51] [config] logical-epoch:
[2023-07-04 21:13:51] [config]   - 1e
[2023-07-04 21:13:51] [config]   - 0
[2023-07-04 21:13:51] [config] lr-decay: 0
[2023-07-04 21:13:51] [config] lr-decay-freq: 50000
[2023-07-04 21:13:51] [config] lr-decay-inv-sqrt:
[2023-07-04 21:13:51] [config]   - 0
[2023-07-04 21:13:51] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:13:51] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:13:51] [config] lr-decay-start:
[2023-07-04 21:13:51] [config]   - 10
[2023-07-04 21:13:51] [config]   - 1
[2023-07-04 21:13:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:13:51] [config] lr-report: false
[2023-07-04 21:13:51] [config] lr-warmup: 0
[2023-07-04 21:13:51] [config] lr-warmup-at-reload: false
[2023-07-04 21:13:51] [config] lr-warmup-cycle: false
[2023-07-04 21:13:51] [config] lr-warmup-start-rate: 0
[2023-07-04 21:13:51] [config] max-length: 50
[2023-07-04 21:13:51] [config] max-length-crop: false
[2023-07-04 21:13:51] [config] max-length-factor: 3
[2023-07-04 21:13:51] [config] maxi-batch: 100
[2023-07-04 21:13:51] [config] maxi-batch-sort: trg
[2023-07-04 21:13:51] [config] mini-batch: 64
[2023-07-04 21:13:51] [config] mini-batch-fit: false
[2023-07-04 21:13:51] [config] mini-batch-fit-step: 10
[2023-07-04 21:13:51] [config] mini-batch-round-up: true
[2023-07-04 21:13:51] [config] mini-batch-track-lr: false
[2023-07-04 21:13:51] [config] mini-batch-warmup: 0
[2023-07-04 21:13:51] [config] mini-batch-words: 0
[2023-07-04 21:13:51] [config] mini-batch-words-ref: 0
[2023-07-04 21:13:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:51] [config] multi-loss-type: sum
[2023-07-04 21:13:51] [config] n-best: false
[2023-07-04 21:13:51] [config] no-nccl: false
[2023-07-04 21:13:51] [config] no-reload: false
[2023-07-04 21:13:51] [config] no-restore-corpus: false
[2023-07-04 21:13:51] [config] normalize: 0
[2023-07-04 21:13:51] [config] normalize-gradient: false
[2023-07-04 21:13:51] [config] num-devices: 0
[2023-07-04 21:13:51] [config] optimizer: adam
[2023-07-04 21:13:51] [config] optimizer-delay: 1
[2023-07-04 21:13:51] [config] optimizer-params:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] output-omit-bias: false
[2023-07-04 21:13:51] [config] overwrite: true
[2023-07-04 21:13:51] [config] precision:
[2023-07-04 21:13:51] [config]   - float32
[2023-07-04 21:13:51] [config]   - float32
[2023-07-04 21:13:51] [config] pretrained-model: ""
[2023-07-04 21:13:51] [config] quantize-biases: false
[2023-07-04 21:13:51] [config] quantize-bits: 0
[2023-07-04 21:13:51] [config] quantize-log-based: false
[2023-07-04 21:13:51] [config] quantize-optimization-steps: 0
[2023-07-04 21:13:51] [config] quiet: false
[2023-07-04 21:13:51] [config] quiet-translation: true
[2023-07-04 21:13:51] [config] relative-paths: false
[2023-07-04 21:13:51] [config] right-left: false
[2023-07-04 21:13:51] [config] save-freq: 10000u
[2023-07-04 21:13:51] [config] seed: 1234
[2023-07-04 21:13:51] [config] sentencepiece-alphas:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:13:51] [config] sentencepiece-options: ""
[2023-07-04 21:13:51] [config] sharding: global
[2023-07-04 21:13:51] [config] shuffle: data
[2023-07-04 21:13:51] [config] shuffle-in-ram: false
[2023-07-04 21:13:51] [config] sigterm: save-and-exit
[2023-07-04 21:13:51] [config] skip: false
[2023-07-04 21:13:51] [config] sqlite: ""
[2023-07-04 21:13:51] [config] sqlite-drop: false
[2023-07-04 21:13:51] [config] sync-freq: 200u
[2023-07-04 21:13:51] [config] sync-sgd: false
[2023-07-04 21:13:51] [config] tempdir: /tmp
[2023-07-04 21:13:51] [config] tied-embeddings: false
[2023-07-04 21:13:51] [config] tied-embeddings-all: false
[2023-07-04 21:13:51] [config] tied-embeddings-src: false
[2023-07-04 21:13:51] [config] train-embedder-rank:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] train-sets:
[2023-07-04 21:13:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:13:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:13:51] [config] transformer-aan-activation: swish
[2023-07-04 21:13:51] [config] transformer-aan-depth: 2
[2023-07-04 21:13:51] [config] transformer-aan-nogate: false
[2023-07-04 21:13:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:13:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:13:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:13:51] [config] transformer-depth-scaling: false
[2023-07-04 21:13:51] [config] transformer-dim-aan: 2048
[2023-07-04 21:13:51] [config] transformer-dim-ffn: 2048
[2023-07-04 21:13:51] [config] transformer-dropout: 0
[2023-07-04 21:13:51] [config] transformer-dropout-attention: 0
[2023-07-04 21:13:51] [config] transformer-dropout-ffn: 0
[2023-07-04 21:13:51] [config] transformer-ffn-activation: swish
[2023-07-04 21:13:51] [config] transformer-ffn-depth: 2
[2023-07-04 21:13:51] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:13:51] [config] transformer-heads: 8
[2023-07-04 21:13:51] [config] transformer-no-projection: false
[2023-07-04 21:13:51] [config] transformer-pool: false
[2023-07-04 21:13:51] [config] transformer-postprocess: dan
[2023-07-04 21:13:51] [config] transformer-postprocess-emb: d
[2023-07-04 21:13:51] [config] transformer-postprocess-top: ""
[2023-07-04 21:13:51] [config] transformer-preprocess: ""
[2023-07-04 21:13:51] [config] transformer-tied-layers:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] transformer-train-position-embeddings: false
[2023-07-04 21:13:51] [config] tsv: false
[2023-07-04 21:13:51] [config] tsv-fields: 0
[2023-07-04 21:13:51] [config] type: transformer
[2023-07-04 21:13:51] [config] ulr: false
[2023-07-04 21:13:51] [config] ulr-dim-emb: 0
[2023-07-04 21:13:51] [config] ulr-dropout: 0
[2023-07-04 21:13:51] [config] ulr-keys-vectors: ""
[2023-07-04 21:13:51] [config] ulr-query-vectors: ""
[2023-07-04 21:13:51] [config] ulr-softmax-temperature: 1
[2023-07-04 21:13:51] [config] ulr-trainable-transformation: false
[2023-07-04 21:13:51] [config] unlikelihood-loss: false
[2023-07-04 21:13:51] [config] valid-freq: 50000000
[2023-07-04 21:13:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:13:51] [config] valid-max-length: 1000
[2023-07-04 21:13:51] [config] valid-metrics:
[2023-07-04 21:13:51] [config]   - cross-entropy
[2023-07-04 21:13:51] [config]   - translation
[2023-07-04 21:13:51] [config] valid-mini-batch: 32
[2023-07-04 21:13:51] [config] valid-reset-stalled: false
[2023-07-04 21:13:51] [config] valid-script-args:
[2023-07-04 21:13:51] [config]   []
[2023-07-04 21:13:51] [config] valid-script-path: ""
[2023-07-04 21:13:51] [config] valid-sets:
[2023-07-04 21:13:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:13:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:13:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:13:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:51] [config] vocabs:
[2023-07-04 21:13:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:51] [config] word-penalty: 0
[2023-07-04 21:13:51] [config] word-scores: false
[2023-07-04 21:13:51] [config] workspace: 2048
[2023-07-04 21:13:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:51] [training] Using single-device training
[2023-07-04 21:13:51] Synced seed 1234
[2023-07-04 21:13:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:51] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:13:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:51] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:13:51] [valid] No post-processing script given for validating translator
[2023-07-04 21:13:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:52] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:13:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:13:52] [comm] Using global sharding
[2023-07-04 21:13:52] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:13:52] [training] Using 1 GPUs
[2023-07-04 21:13:52] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:53] Loading Adam parameters
[2023-07-04 21:13:54] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:13:54] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:13:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:13:54] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:13:54] [data] Shuffling data
[2023-07-04 21:13:54] [data] Done reading 20,192 sentences
[2023-07-04 21:13:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:13:54] Training started
[2023-07-04 21:13:54] Training finished
[2023-07-04 21:13:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:58] [marian] Running on node07.datos.cluster.uy as process 20154 with command line:
[2023-07-04 21:13:58] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:13:58] [config] after: 0e
[2023-07-04 21:13:58] [config] after-batches: 0
[2023-07-04 21:13:58] [config] after-epochs: 160
[2023-07-04 21:13:58] [config] all-caps-every: 0
[2023-07-04 21:13:58] [config] allow-unk: false
[2023-07-04 21:13:58] [config] authors: false
[2023-07-04 21:13:58] [config] beam-size: 12
[2023-07-04 21:13:58] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:13:58] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:13:58] [config] bert-masking-fraction: 0.15
[2023-07-04 21:13:58] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:13:58] [config] bert-train-type-embeddings: true
[2023-07-04 21:13:58] [config] bert-type-vocab-size: 2
[2023-07-04 21:13:58] [config] build-info: ""
[2023-07-04 21:13:58] [config] check-gradient-nan: false
[2023-07-04 21:13:58] [config] check-nan: false
[2023-07-04 21:13:58] [config] cite: false
[2023-07-04 21:13:58] [config] clip-norm: 1
[2023-07-04 21:13:58] [config] cost-scaling:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] cost-type: ce-sum
[2023-07-04 21:13:58] [config] cpu-threads: 0
[2023-07-04 21:13:58] [config] data-threads: 8
[2023-07-04 21:13:58] [config] data-weighting: ""
[2023-07-04 21:13:58] [config] data-weighting-type: sentence
[2023-07-04 21:13:58] [config] dec-cell: gru
[2023-07-04 21:13:58] [config] dec-cell-base-depth: 2
[2023-07-04 21:13:58] [config] dec-cell-high-depth: 1
[2023-07-04 21:13:58] [config] dec-depth: 1
[2023-07-04 21:13:58] [config] devices:
[2023-07-04 21:13:58] [config]   - 0
[2023-07-04 21:13:58] [config] dim-emb: 512
[2023-07-04 21:13:58] [config] dim-rnn: 1024
[2023-07-04 21:13:58] [config] dim-vocabs:
[2023-07-04 21:13:58] [config]   - 54042
[2023-07-04 21:13:58] [config]   - 36507
[2023-07-04 21:13:58] [config] disp-first: 0
[2023-07-04 21:13:58] [config] disp-freq: 1000u
[2023-07-04 21:13:58] [config] disp-label-counts: true
[2023-07-04 21:13:58] [config] dropout-rnn: 0
[2023-07-04 21:13:58] [config] dropout-src: 0
[2023-07-04 21:13:58] [config] dropout-trg: 0
[2023-07-04 21:13:58] [config] dump-config: ""
[2023-07-04 21:13:58] [config] dynamic-gradient-scaling:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] early-stopping: 10
[2023-07-04 21:13:58] [config] early-stopping-on: first
[2023-07-04 21:13:58] [config] embedding-fix-src: false
[2023-07-04 21:13:58] [config] embedding-fix-trg: false
[2023-07-04 21:13:58] [config] embedding-normalization: false
[2023-07-04 21:13:58] [config] embedding-vectors:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] enc-cell: gru
[2023-07-04 21:13:58] [config] enc-cell-depth: 1
[2023-07-04 21:13:58] [config] enc-depth: 1
[2023-07-04 21:13:58] [config] enc-type: bidirectional
[2023-07-04 21:13:58] [config] english-title-case-every: 0
[2023-07-04 21:13:58] [config] exponential-smoothing: 0
[2023-07-04 21:13:58] [config] factor-weight: 1
[2023-07-04 21:13:58] [config] factors-combine: sum
[2023-07-04 21:13:58] [config] factors-dim-emb: 0
[2023-07-04 21:13:58] [config] gradient-checkpointing: false
[2023-07-04 21:13:58] [config] gradient-norm-average-window: 100
[2023-07-04 21:13:58] [config] guided-alignment: none
[2023-07-04 21:13:58] [config] guided-alignment-cost: mse
[2023-07-04 21:13:58] [config] guided-alignment-weight: 0.1
[2023-07-04 21:13:58] [config] ignore-model-config: false
[2023-07-04 21:13:58] [config] input-types:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] interpolate-env-vars: false
[2023-07-04 21:13:58] [config] keep-best: false
[2023-07-04 21:13:58] [config] label-smoothing: 0
[2023-07-04 21:13:58] [config] layer-normalization: false
[2023-07-04 21:13:58] [config] learn-rate: 0.0001
[2023-07-04 21:13:58] [config] lemma-dependency: ""
[2023-07-04 21:13:58] [config] lemma-dim-emb: 0
[2023-07-04 21:13:58] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:13:58] [config] log-level: info
[2023-07-04 21:13:58] [config] log-time-zone: ""
[2023-07-04 21:13:58] [config] logical-epoch:
[2023-07-04 21:13:58] [config]   - 1e
[2023-07-04 21:13:58] [config]   - 0
[2023-07-04 21:13:58] [config] lr-decay: 0
[2023-07-04 21:13:58] [config] lr-decay-freq: 50000
[2023-07-04 21:13:58] [config] lr-decay-inv-sqrt:
[2023-07-04 21:13:58] [config]   - 0
[2023-07-04 21:13:58] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:13:58] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:13:58] [config] lr-decay-start:
[2023-07-04 21:13:58] [config]   - 10
[2023-07-04 21:13:58] [config]   - 1
[2023-07-04 21:13:58] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:13:58] [config] lr-report: false
[2023-07-04 21:13:58] [config] lr-warmup: 0
[2023-07-04 21:13:58] [config] lr-warmup-at-reload: false
[2023-07-04 21:13:58] [config] lr-warmup-cycle: false
[2023-07-04 21:13:58] [config] lr-warmup-start-rate: 0
[2023-07-04 21:13:58] [config] max-length: 50
[2023-07-04 21:13:58] [config] max-length-crop: false
[2023-07-04 21:13:58] [config] max-length-factor: 3
[2023-07-04 21:13:58] [config] maxi-batch: 100
[2023-07-04 21:13:58] [config] maxi-batch-sort: trg
[2023-07-04 21:13:58] [config] mini-batch: 64
[2023-07-04 21:13:58] [config] mini-batch-fit: false
[2023-07-04 21:13:58] [config] mini-batch-fit-step: 10
[2023-07-04 21:13:58] [config] mini-batch-round-up: true
[2023-07-04 21:13:58] [config] mini-batch-track-lr: false
[2023-07-04 21:13:58] [config] mini-batch-warmup: 0
[2023-07-04 21:13:58] [config] mini-batch-words: 0
[2023-07-04 21:13:58] [config] mini-batch-words-ref: 0
[2023-07-04 21:13:58] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:13:58] [config] multi-loss-type: sum
[2023-07-04 21:13:58] [config] n-best: false
[2023-07-04 21:13:58] [config] no-nccl: false
[2023-07-04 21:13:58] [config] no-reload: false
[2023-07-04 21:13:58] [config] no-restore-corpus: false
[2023-07-04 21:13:58] [config] normalize: 0
[2023-07-04 21:13:58] [config] normalize-gradient: false
[2023-07-04 21:13:58] [config] num-devices: 0
[2023-07-04 21:13:58] [config] optimizer: adam
[2023-07-04 21:13:58] [config] optimizer-delay: 1
[2023-07-04 21:13:58] [config] optimizer-params:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] output-omit-bias: false
[2023-07-04 21:13:58] [config] overwrite: true
[2023-07-04 21:13:58] [config] precision:
[2023-07-04 21:13:58] [config]   - float32
[2023-07-04 21:13:58] [config]   - float32
[2023-07-04 21:13:58] [config] pretrained-model: ""
[2023-07-04 21:13:58] [config] quantize-biases: false
[2023-07-04 21:13:58] [config] quantize-bits: 0
[2023-07-04 21:13:58] [config] quantize-log-based: false
[2023-07-04 21:13:58] [config] quantize-optimization-steps: 0
[2023-07-04 21:13:58] [config] quiet: false
[2023-07-04 21:13:58] [config] quiet-translation: true
[2023-07-04 21:13:58] [config] relative-paths: false
[2023-07-04 21:13:58] [config] right-left: false
[2023-07-04 21:13:58] [config] save-freq: 10000u
[2023-07-04 21:13:58] [config] seed: 1234
[2023-07-04 21:13:58] [config] sentencepiece-alphas:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:13:58] [config] sentencepiece-options: ""
[2023-07-04 21:13:58] [config] sharding: global
[2023-07-04 21:13:58] [config] shuffle: data
[2023-07-04 21:13:58] [config] shuffle-in-ram: false
[2023-07-04 21:13:58] [config] sigterm: save-and-exit
[2023-07-04 21:13:58] [config] skip: false
[2023-07-04 21:13:58] [config] sqlite: ""
[2023-07-04 21:13:58] [config] sqlite-drop: false
[2023-07-04 21:13:58] [config] sync-freq: 200u
[2023-07-04 21:13:58] [config] sync-sgd: false
[2023-07-04 21:13:58] [config] tempdir: /tmp
[2023-07-04 21:13:58] [config] tied-embeddings: false
[2023-07-04 21:13:58] [config] tied-embeddings-all: false
[2023-07-04 21:13:58] [config] tied-embeddings-src: false
[2023-07-04 21:13:58] [config] train-embedder-rank:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] train-sets:
[2023-07-04 21:13:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:13:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:13:58] [config] transformer-aan-activation: swish
[2023-07-04 21:13:58] [config] transformer-aan-depth: 2
[2023-07-04 21:13:58] [config] transformer-aan-nogate: false
[2023-07-04 21:13:58] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:13:58] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:13:58] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:13:58] [config] transformer-depth-scaling: false
[2023-07-04 21:13:58] [config] transformer-dim-aan: 2048
[2023-07-04 21:13:58] [config] transformer-dim-ffn: 2048
[2023-07-04 21:13:58] [config] transformer-dropout: 0
[2023-07-04 21:13:58] [config] transformer-dropout-attention: 0
[2023-07-04 21:13:58] [config] transformer-dropout-ffn: 0
[2023-07-04 21:13:58] [config] transformer-ffn-activation: swish
[2023-07-04 21:13:58] [config] transformer-ffn-depth: 2
[2023-07-04 21:13:58] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:13:58] [config] transformer-heads: 8
[2023-07-04 21:13:58] [config] transformer-no-projection: false
[2023-07-04 21:13:58] [config] transformer-pool: false
[2023-07-04 21:13:58] [config] transformer-postprocess: dan
[2023-07-04 21:13:58] [config] transformer-postprocess-emb: d
[2023-07-04 21:13:58] [config] transformer-postprocess-top: ""
[2023-07-04 21:13:58] [config] transformer-preprocess: ""
[2023-07-04 21:13:58] [config] transformer-tied-layers:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] transformer-train-position-embeddings: false
[2023-07-04 21:13:58] [config] tsv: false
[2023-07-04 21:13:58] [config] tsv-fields: 0
[2023-07-04 21:13:58] [config] type: transformer
[2023-07-04 21:13:58] [config] ulr: false
[2023-07-04 21:13:58] [config] ulr-dim-emb: 0
[2023-07-04 21:13:58] [config] ulr-dropout: 0
[2023-07-04 21:13:58] [config] ulr-keys-vectors: ""
[2023-07-04 21:13:58] [config] ulr-query-vectors: ""
[2023-07-04 21:13:58] [config] ulr-softmax-temperature: 1
[2023-07-04 21:13:58] [config] ulr-trainable-transformation: false
[2023-07-04 21:13:58] [config] unlikelihood-loss: false
[2023-07-04 21:13:58] [config] valid-freq: 50000000
[2023-07-04 21:13:58] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:13:58] [config] valid-max-length: 1000
[2023-07-04 21:13:58] [config] valid-metrics:
[2023-07-04 21:13:58] [config]   - cross-entropy
[2023-07-04 21:13:58] [config]   - translation
[2023-07-04 21:13:58] [config] valid-mini-batch: 32
[2023-07-04 21:13:58] [config] valid-reset-stalled: false
[2023-07-04 21:13:58] [config] valid-script-args:
[2023-07-04 21:13:58] [config]   []
[2023-07-04 21:13:58] [config] valid-script-path: ""
[2023-07-04 21:13:58] [config] valid-sets:
[2023-07-04 21:13:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:13:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:13:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:13:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:58] [config] vocabs:
[2023-07-04 21:13:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:58] [config] word-penalty: 0
[2023-07-04 21:13:58] [config] word-scores: false
[2023-07-04 21:13:58] [config] workspace: 2048
[2023-07-04 21:13:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:13:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:58] [training] Using single-device training
[2023-07-04 21:13:58] Synced seed 1234
[2023-07-04 21:13:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:13:58] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:13:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:13:58] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:13:58] [valid] No post-processing script given for validating translator
[2023-07-04 21:13:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:13:59] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:13:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:13:59] [comm] Using global sharding
[2023-07-04 21:13:59] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:13:59] [training] Using 1 GPUs
[2023-07-04 21:13:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:00] Loading Adam parameters
[2023-07-04 21:14:00] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:14:00] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:14:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:14:01] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:14:01] [data] Shuffling data
[2023-07-04 21:14:01] [data] Done reading 20,192 sentences
[2023-07-04 21:14:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:14:01] Training started
[2023-07-04 21:14:01] Training finished
[2023-07-04 21:14:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:04] [marian] Running on node07.datos.cluster.uy as process 20343 with command line:
[2023-07-04 21:14:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:14:04] [config] after: 0e
[2023-07-04 21:14:04] [config] after-batches: 0
[2023-07-04 21:14:04] [config] after-epochs: 170
[2023-07-04 21:14:04] [config] all-caps-every: 0
[2023-07-04 21:14:04] [config] allow-unk: false
[2023-07-04 21:14:04] [config] authors: false
[2023-07-04 21:14:04] [config] beam-size: 12
[2023-07-04 21:14:04] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:14:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:14:04] [config] bert-masking-fraction: 0.15
[2023-07-04 21:14:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:14:04] [config] bert-train-type-embeddings: true
[2023-07-04 21:14:04] [config] bert-type-vocab-size: 2
[2023-07-04 21:14:04] [config] build-info: ""
[2023-07-04 21:14:04] [config] check-gradient-nan: false
[2023-07-04 21:14:04] [config] check-nan: false
[2023-07-04 21:14:04] [config] cite: false
[2023-07-04 21:14:04] [config] clip-norm: 1
[2023-07-04 21:14:04] [config] cost-scaling:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] cost-type: ce-sum
[2023-07-04 21:14:04] [config] cpu-threads: 0
[2023-07-04 21:14:04] [config] data-threads: 8
[2023-07-04 21:14:04] [config] data-weighting: ""
[2023-07-04 21:14:04] [config] data-weighting-type: sentence
[2023-07-04 21:14:04] [config] dec-cell: gru
[2023-07-04 21:14:04] [config] dec-cell-base-depth: 2
[2023-07-04 21:14:04] [config] dec-cell-high-depth: 1
[2023-07-04 21:14:04] [config] dec-depth: 1
[2023-07-04 21:14:04] [config] devices:
[2023-07-04 21:14:04] [config]   - 0
[2023-07-04 21:14:04] [config] dim-emb: 512
[2023-07-04 21:14:04] [config] dim-rnn: 1024
[2023-07-04 21:14:04] [config] dim-vocabs:
[2023-07-04 21:14:04] [config]   - 54042
[2023-07-04 21:14:04] [config]   - 36507
[2023-07-04 21:14:04] [config] disp-first: 0
[2023-07-04 21:14:04] [config] disp-freq: 1000u
[2023-07-04 21:14:04] [config] disp-label-counts: true
[2023-07-04 21:14:04] [config] dropout-rnn: 0
[2023-07-04 21:14:04] [config] dropout-src: 0
[2023-07-04 21:14:04] [config] dropout-trg: 0
[2023-07-04 21:14:04] [config] dump-config: ""
[2023-07-04 21:14:04] [config] dynamic-gradient-scaling:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] early-stopping: 10
[2023-07-04 21:14:04] [config] early-stopping-on: first
[2023-07-04 21:14:04] [config] embedding-fix-src: false
[2023-07-04 21:14:04] [config] embedding-fix-trg: false
[2023-07-04 21:14:04] [config] embedding-normalization: false
[2023-07-04 21:14:04] [config] embedding-vectors:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] enc-cell: gru
[2023-07-04 21:14:04] [config] enc-cell-depth: 1
[2023-07-04 21:14:04] [config] enc-depth: 1
[2023-07-04 21:14:04] [config] enc-type: bidirectional
[2023-07-04 21:14:04] [config] english-title-case-every: 0
[2023-07-04 21:14:04] [config] exponential-smoothing: 0
[2023-07-04 21:14:04] [config] factor-weight: 1
[2023-07-04 21:14:04] [config] factors-combine: sum
[2023-07-04 21:14:04] [config] factors-dim-emb: 0
[2023-07-04 21:14:04] [config] gradient-checkpointing: false
[2023-07-04 21:14:04] [config] gradient-norm-average-window: 100
[2023-07-04 21:14:04] [config] guided-alignment: none
[2023-07-04 21:14:04] [config] guided-alignment-cost: mse
[2023-07-04 21:14:04] [config] guided-alignment-weight: 0.1
[2023-07-04 21:14:04] [config] ignore-model-config: false
[2023-07-04 21:14:04] [config] input-types:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] interpolate-env-vars: false
[2023-07-04 21:14:04] [config] keep-best: false
[2023-07-04 21:14:04] [config] label-smoothing: 0
[2023-07-04 21:14:04] [config] layer-normalization: false
[2023-07-04 21:14:04] [config] learn-rate: 0.0001
[2023-07-04 21:14:04] [config] lemma-dependency: ""
[2023-07-04 21:14:04] [config] lemma-dim-emb: 0
[2023-07-04 21:14:04] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:14:04] [config] log-level: info
[2023-07-04 21:14:04] [config] log-time-zone: ""
[2023-07-04 21:14:04] [config] logical-epoch:
[2023-07-04 21:14:04] [config]   - 1e
[2023-07-04 21:14:04] [config]   - 0
[2023-07-04 21:14:04] [config] lr-decay: 0
[2023-07-04 21:14:04] [config] lr-decay-freq: 50000
[2023-07-04 21:14:04] [config] lr-decay-inv-sqrt:
[2023-07-04 21:14:04] [config]   - 0
[2023-07-04 21:14:04] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:14:04] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:14:04] [config] lr-decay-start:
[2023-07-04 21:14:04] [config]   - 10
[2023-07-04 21:14:04] [config]   - 1
[2023-07-04 21:14:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:14:04] [config] lr-report: false
[2023-07-04 21:14:04] [config] lr-warmup: 0
[2023-07-04 21:14:04] [config] lr-warmup-at-reload: false
[2023-07-04 21:14:04] [config] lr-warmup-cycle: false
[2023-07-04 21:14:04] [config] lr-warmup-start-rate: 0
[2023-07-04 21:14:04] [config] max-length: 50
[2023-07-04 21:14:04] [config] max-length-crop: false
[2023-07-04 21:14:04] [config] max-length-factor: 3
[2023-07-04 21:14:04] [config] maxi-batch: 100
[2023-07-04 21:14:04] [config] maxi-batch-sort: trg
[2023-07-04 21:14:04] [config] mini-batch: 64
[2023-07-04 21:14:04] [config] mini-batch-fit: false
[2023-07-04 21:14:04] [config] mini-batch-fit-step: 10
[2023-07-04 21:14:04] [config] mini-batch-round-up: true
[2023-07-04 21:14:04] [config] mini-batch-track-lr: false
[2023-07-04 21:14:04] [config] mini-batch-warmup: 0
[2023-07-04 21:14:04] [config] mini-batch-words: 0
[2023-07-04 21:14:04] [config] mini-batch-words-ref: 0
[2023-07-04 21:14:04] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:04] [config] multi-loss-type: sum
[2023-07-04 21:14:04] [config] n-best: false
[2023-07-04 21:14:04] [config] no-nccl: false
[2023-07-04 21:14:04] [config] no-reload: false
[2023-07-04 21:14:04] [config] no-restore-corpus: false
[2023-07-04 21:14:04] [config] normalize: 0
[2023-07-04 21:14:04] [config] normalize-gradient: false
[2023-07-04 21:14:04] [config] num-devices: 0
[2023-07-04 21:14:04] [config] optimizer: adam
[2023-07-04 21:14:04] [config] optimizer-delay: 1
[2023-07-04 21:14:04] [config] optimizer-params:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] output-omit-bias: false
[2023-07-04 21:14:04] [config] overwrite: true
[2023-07-04 21:14:04] [config] precision:
[2023-07-04 21:14:04] [config]   - float32
[2023-07-04 21:14:04] [config]   - float32
[2023-07-04 21:14:04] [config] pretrained-model: ""
[2023-07-04 21:14:04] [config] quantize-biases: false
[2023-07-04 21:14:04] [config] quantize-bits: 0
[2023-07-04 21:14:04] [config] quantize-log-based: false
[2023-07-04 21:14:04] [config] quantize-optimization-steps: 0
[2023-07-04 21:14:04] [config] quiet: false
[2023-07-04 21:14:04] [config] quiet-translation: true
[2023-07-04 21:14:04] [config] relative-paths: false
[2023-07-04 21:14:04] [config] right-left: false
[2023-07-04 21:14:04] [config] save-freq: 10000u
[2023-07-04 21:14:04] [config] seed: 1234
[2023-07-04 21:14:04] [config] sentencepiece-alphas:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:14:04] [config] sentencepiece-options: ""
[2023-07-04 21:14:04] [config] sharding: global
[2023-07-04 21:14:04] [config] shuffle: data
[2023-07-04 21:14:04] [config] shuffle-in-ram: false
[2023-07-04 21:14:04] [config] sigterm: save-and-exit
[2023-07-04 21:14:04] [config] skip: false
[2023-07-04 21:14:04] [config] sqlite: ""
[2023-07-04 21:14:04] [config] sqlite-drop: false
[2023-07-04 21:14:04] [config] sync-freq: 200u
[2023-07-04 21:14:04] [config] sync-sgd: false
[2023-07-04 21:14:04] [config] tempdir: /tmp
[2023-07-04 21:14:04] [config] tied-embeddings: false
[2023-07-04 21:14:04] [config] tied-embeddings-all: false
[2023-07-04 21:14:04] [config] tied-embeddings-src: false
[2023-07-04 21:14:04] [config] train-embedder-rank:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] train-sets:
[2023-07-04 21:14:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:14:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:14:04] [config] transformer-aan-activation: swish
[2023-07-04 21:14:04] [config] transformer-aan-depth: 2
[2023-07-04 21:14:04] [config] transformer-aan-nogate: false
[2023-07-04 21:14:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:14:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:14:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:14:04] [config] transformer-depth-scaling: false
[2023-07-04 21:14:04] [config] transformer-dim-aan: 2048
[2023-07-04 21:14:04] [config] transformer-dim-ffn: 2048
[2023-07-04 21:14:04] [config] transformer-dropout: 0
[2023-07-04 21:14:04] [config] transformer-dropout-attention: 0
[2023-07-04 21:14:04] [config] transformer-dropout-ffn: 0
[2023-07-04 21:14:04] [config] transformer-ffn-activation: swish
[2023-07-04 21:14:04] [config] transformer-ffn-depth: 2
[2023-07-04 21:14:04] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:14:04] [config] transformer-heads: 8
[2023-07-04 21:14:04] [config] transformer-no-projection: false
[2023-07-04 21:14:04] [config] transformer-pool: false
[2023-07-04 21:14:04] [config] transformer-postprocess: dan
[2023-07-04 21:14:04] [config] transformer-postprocess-emb: d
[2023-07-04 21:14:04] [config] transformer-postprocess-top: ""
[2023-07-04 21:14:04] [config] transformer-preprocess: ""
[2023-07-04 21:14:04] [config] transformer-tied-layers:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] transformer-train-position-embeddings: false
[2023-07-04 21:14:04] [config] tsv: false
[2023-07-04 21:14:04] [config] tsv-fields: 0
[2023-07-04 21:14:04] [config] type: transformer
[2023-07-04 21:14:04] [config] ulr: false
[2023-07-04 21:14:04] [config] ulr-dim-emb: 0
[2023-07-04 21:14:04] [config] ulr-dropout: 0
[2023-07-04 21:14:04] [config] ulr-keys-vectors: ""
[2023-07-04 21:14:04] [config] ulr-query-vectors: ""
[2023-07-04 21:14:04] [config] ulr-softmax-temperature: 1
[2023-07-04 21:14:04] [config] ulr-trainable-transformation: false
[2023-07-04 21:14:04] [config] unlikelihood-loss: false
[2023-07-04 21:14:04] [config] valid-freq: 50000000
[2023-07-04 21:14:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:14:04] [config] valid-max-length: 1000
[2023-07-04 21:14:04] [config] valid-metrics:
[2023-07-04 21:14:04] [config]   - cross-entropy
[2023-07-04 21:14:04] [config]   - translation
[2023-07-04 21:14:04] [config] valid-mini-batch: 32
[2023-07-04 21:14:04] [config] valid-reset-stalled: false
[2023-07-04 21:14:04] [config] valid-script-args:
[2023-07-04 21:14:04] [config]   []
[2023-07-04 21:14:04] [config] valid-script-path: ""
[2023-07-04 21:14:04] [config] valid-sets:
[2023-07-04 21:14:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:14:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:14:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:14:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:04] [config] vocabs:
[2023-07-04 21:14:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:04] [config] word-penalty: 0
[2023-07-04 21:14:04] [config] word-scores: false
[2023-07-04 21:14:04] [config] workspace: 2048
[2023-07-04 21:14:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:04] [training] Using single-device training
[2023-07-04 21:14:04] Synced seed 1234
[2023-07-04 21:14:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:05] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:14:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:05] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:14:05] [valid] No post-processing script given for validating translator
[2023-07-04 21:14:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:05] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:14:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:14:05] [comm] Using global sharding
[2023-07-04 21:14:05] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:14:05] [training] Using 1 GPUs
[2023-07-04 21:14:05] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:07] Loading Adam parameters
[2023-07-04 21:14:07] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:14:07] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:14:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:14:07] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:14:07] [data] Shuffling data
[2023-07-04 21:14:07] [data] Done reading 20,192 sentences
[2023-07-04 21:14:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:14:07] Training started
[2023-07-04 21:14:07] Training finished
[2023-07-04 21:14:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:11] [marian] Running on node07.datos.cluster.uy as process 20406 with command line:
[2023-07-04 21:14:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:14:11] [config] after: 0e
[2023-07-04 21:14:11] [config] after-batches: 0
[2023-07-04 21:14:11] [config] after-epochs: 180
[2023-07-04 21:14:11] [config] all-caps-every: 0
[2023-07-04 21:14:11] [config] allow-unk: false
[2023-07-04 21:14:11] [config] authors: false
[2023-07-04 21:14:11] [config] beam-size: 12
[2023-07-04 21:14:11] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:14:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:14:11] [config] bert-masking-fraction: 0.15
[2023-07-04 21:14:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:14:11] [config] bert-train-type-embeddings: true
[2023-07-04 21:14:11] [config] bert-type-vocab-size: 2
[2023-07-04 21:14:11] [config] build-info: ""
[2023-07-04 21:14:11] [config] check-gradient-nan: false
[2023-07-04 21:14:11] [config] check-nan: false
[2023-07-04 21:14:11] [config] cite: false
[2023-07-04 21:14:11] [config] clip-norm: 1
[2023-07-04 21:14:11] [config] cost-scaling:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] cost-type: ce-sum
[2023-07-04 21:14:11] [config] cpu-threads: 0
[2023-07-04 21:14:11] [config] data-threads: 8
[2023-07-04 21:14:11] [config] data-weighting: ""
[2023-07-04 21:14:11] [config] data-weighting-type: sentence
[2023-07-04 21:14:11] [config] dec-cell: gru
[2023-07-04 21:14:11] [config] dec-cell-base-depth: 2
[2023-07-04 21:14:11] [config] dec-cell-high-depth: 1
[2023-07-04 21:14:11] [config] dec-depth: 1
[2023-07-04 21:14:11] [config] devices:
[2023-07-04 21:14:11] [config]   - 0
[2023-07-04 21:14:11] [config] dim-emb: 512
[2023-07-04 21:14:11] [config] dim-rnn: 1024
[2023-07-04 21:14:11] [config] dim-vocabs:
[2023-07-04 21:14:11] [config]   - 54042
[2023-07-04 21:14:11] [config]   - 36507
[2023-07-04 21:14:11] [config] disp-first: 0
[2023-07-04 21:14:11] [config] disp-freq: 1000u
[2023-07-04 21:14:11] [config] disp-label-counts: true
[2023-07-04 21:14:11] [config] dropout-rnn: 0
[2023-07-04 21:14:11] [config] dropout-src: 0
[2023-07-04 21:14:11] [config] dropout-trg: 0
[2023-07-04 21:14:11] [config] dump-config: ""
[2023-07-04 21:14:11] [config] dynamic-gradient-scaling:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] early-stopping: 10
[2023-07-04 21:14:11] [config] early-stopping-on: first
[2023-07-04 21:14:11] [config] embedding-fix-src: false
[2023-07-04 21:14:11] [config] embedding-fix-trg: false
[2023-07-04 21:14:11] [config] embedding-normalization: false
[2023-07-04 21:14:11] [config] embedding-vectors:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] enc-cell: gru
[2023-07-04 21:14:11] [config] enc-cell-depth: 1
[2023-07-04 21:14:11] [config] enc-depth: 1
[2023-07-04 21:14:11] [config] enc-type: bidirectional
[2023-07-04 21:14:11] [config] english-title-case-every: 0
[2023-07-04 21:14:11] [config] exponential-smoothing: 0
[2023-07-04 21:14:11] [config] factor-weight: 1
[2023-07-04 21:14:11] [config] factors-combine: sum
[2023-07-04 21:14:11] [config] factors-dim-emb: 0
[2023-07-04 21:14:11] [config] gradient-checkpointing: false
[2023-07-04 21:14:11] [config] gradient-norm-average-window: 100
[2023-07-04 21:14:11] [config] guided-alignment: none
[2023-07-04 21:14:11] [config] guided-alignment-cost: mse
[2023-07-04 21:14:11] [config] guided-alignment-weight: 0.1
[2023-07-04 21:14:11] [config] ignore-model-config: false
[2023-07-04 21:14:11] [config] input-types:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] interpolate-env-vars: false
[2023-07-04 21:14:11] [config] keep-best: false
[2023-07-04 21:14:11] [config] label-smoothing: 0
[2023-07-04 21:14:11] [config] layer-normalization: false
[2023-07-04 21:14:11] [config] learn-rate: 0.0001
[2023-07-04 21:14:11] [config] lemma-dependency: ""
[2023-07-04 21:14:11] [config] lemma-dim-emb: 0
[2023-07-04 21:14:11] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:14:11] [config] log-level: info
[2023-07-04 21:14:11] [config] log-time-zone: ""
[2023-07-04 21:14:11] [config] logical-epoch:
[2023-07-04 21:14:11] [config]   - 1e
[2023-07-04 21:14:11] [config]   - 0
[2023-07-04 21:14:11] [config] lr-decay: 0
[2023-07-04 21:14:11] [config] lr-decay-freq: 50000
[2023-07-04 21:14:11] [config] lr-decay-inv-sqrt:
[2023-07-04 21:14:11] [config]   - 0
[2023-07-04 21:14:11] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:14:11] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:14:11] [config] lr-decay-start:
[2023-07-04 21:14:11] [config]   - 10
[2023-07-04 21:14:11] [config]   - 1
[2023-07-04 21:14:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:14:11] [config] lr-report: false
[2023-07-04 21:14:11] [config] lr-warmup: 0
[2023-07-04 21:14:11] [config] lr-warmup-at-reload: false
[2023-07-04 21:14:11] [config] lr-warmup-cycle: false
[2023-07-04 21:14:11] [config] lr-warmup-start-rate: 0
[2023-07-04 21:14:11] [config] max-length: 50
[2023-07-04 21:14:11] [config] max-length-crop: false
[2023-07-04 21:14:11] [config] max-length-factor: 3
[2023-07-04 21:14:11] [config] maxi-batch: 100
[2023-07-04 21:14:11] [config] maxi-batch-sort: trg
[2023-07-04 21:14:11] [config] mini-batch: 64
[2023-07-04 21:14:11] [config] mini-batch-fit: false
[2023-07-04 21:14:11] [config] mini-batch-fit-step: 10
[2023-07-04 21:14:11] [config] mini-batch-round-up: true
[2023-07-04 21:14:11] [config] mini-batch-track-lr: false
[2023-07-04 21:14:11] [config] mini-batch-warmup: 0
[2023-07-04 21:14:11] [config] mini-batch-words: 0
[2023-07-04 21:14:11] [config] mini-batch-words-ref: 0
[2023-07-04 21:14:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:11] [config] multi-loss-type: sum
[2023-07-04 21:14:11] [config] n-best: false
[2023-07-04 21:14:11] [config] no-nccl: false
[2023-07-04 21:14:11] [config] no-reload: false
[2023-07-04 21:14:11] [config] no-restore-corpus: false
[2023-07-04 21:14:11] [config] normalize: 0
[2023-07-04 21:14:11] [config] normalize-gradient: false
[2023-07-04 21:14:11] [config] num-devices: 0
[2023-07-04 21:14:11] [config] optimizer: adam
[2023-07-04 21:14:11] [config] optimizer-delay: 1
[2023-07-04 21:14:11] [config] optimizer-params:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] output-omit-bias: false
[2023-07-04 21:14:11] [config] overwrite: true
[2023-07-04 21:14:11] [config] precision:
[2023-07-04 21:14:11] [config]   - float32
[2023-07-04 21:14:11] [config]   - float32
[2023-07-04 21:14:11] [config] pretrained-model: ""
[2023-07-04 21:14:11] [config] quantize-biases: false
[2023-07-04 21:14:11] [config] quantize-bits: 0
[2023-07-04 21:14:11] [config] quantize-log-based: false
[2023-07-04 21:14:11] [config] quantize-optimization-steps: 0
[2023-07-04 21:14:11] [config] quiet: false
[2023-07-04 21:14:11] [config] quiet-translation: true
[2023-07-04 21:14:11] [config] relative-paths: false
[2023-07-04 21:14:11] [config] right-left: false
[2023-07-04 21:14:11] [config] save-freq: 10000u
[2023-07-04 21:14:11] [config] seed: 1234
[2023-07-04 21:14:11] [config] sentencepiece-alphas:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:14:11] [config] sentencepiece-options: ""
[2023-07-04 21:14:11] [config] sharding: global
[2023-07-04 21:14:11] [config] shuffle: data
[2023-07-04 21:14:11] [config] shuffle-in-ram: false
[2023-07-04 21:14:11] [config] sigterm: save-and-exit
[2023-07-04 21:14:11] [config] skip: false
[2023-07-04 21:14:11] [config] sqlite: ""
[2023-07-04 21:14:11] [config] sqlite-drop: false
[2023-07-04 21:14:11] [config] sync-freq: 200u
[2023-07-04 21:14:11] [config] sync-sgd: false
[2023-07-04 21:14:11] [config] tempdir: /tmp
[2023-07-04 21:14:11] [config] tied-embeddings: false
[2023-07-04 21:14:11] [config] tied-embeddings-all: false
[2023-07-04 21:14:11] [config] tied-embeddings-src: false
[2023-07-04 21:14:11] [config] train-embedder-rank:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] train-sets:
[2023-07-04 21:14:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:14:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:14:11] [config] transformer-aan-activation: swish
[2023-07-04 21:14:11] [config] transformer-aan-depth: 2
[2023-07-04 21:14:11] [config] transformer-aan-nogate: false
[2023-07-04 21:14:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:14:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:14:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:14:11] [config] transformer-depth-scaling: false
[2023-07-04 21:14:11] [config] transformer-dim-aan: 2048
[2023-07-04 21:14:11] [config] transformer-dim-ffn: 2048
[2023-07-04 21:14:11] [config] transformer-dropout: 0
[2023-07-04 21:14:11] [config] transformer-dropout-attention: 0
[2023-07-04 21:14:11] [config] transformer-dropout-ffn: 0
[2023-07-04 21:14:11] [config] transformer-ffn-activation: swish
[2023-07-04 21:14:11] [config] transformer-ffn-depth: 2
[2023-07-04 21:14:11] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:14:11] [config] transformer-heads: 8
[2023-07-04 21:14:11] [config] transformer-no-projection: false
[2023-07-04 21:14:11] [config] transformer-pool: false
[2023-07-04 21:14:11] [config] transformer-postprocess: dan
[2023-07-04 21:14:11] [config] transformer-postprocess-emb: d
[2023-07-04 21:14:11] [config] transformer-postprocess-top: ""
[2023-07-04 21:14:11] [config] transformer-preprocess: ""
[2023-07-04 21:14:11] [config] transformer-tied-layers:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] transformer-train-position-embeddings: false
[2023-07-04 21:14:11] [config] tsv: false
[2023-07-04 21:14:11] [config] tsv-fields: 0
[2023-07-04 21:14:11] [config] type: transformer
[2023-07-04 21:14:11] [config] ulr: false
[2023-07-04 21:14:11] [config] ulr-dim-emb: 0
[2023-07-04 21:14:11] [config] ulr-dropout: 0
[2023-07-04 21:14:11] [config] ulr-keys-vectors: ""
[2023-07-04 21:14:11] [config] ulr-query-vectors: ""
[2023-07-04 21:14:11] [config] ulr-softmax-temperature: 1
[2023-07-04 21:14:11] [config] ulr-trainable-transformation: false
[2023-07-04 21:14:11] [config] unlikelihood-loss: false
[2023-07-04 21:14:11] [config] valid-freq: 50000000
[2023-07-04 21:14:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:14:11] [config] valid-max-length: 1000
[2023-07-04 21:14:11] [config] valid-metrics:
[2023-07-04 21:14:11] [config]   - cross-entropy
[2023-07-04 21:14:11] [config]   - translation
[2023-07-04 21:14:11] [config] valid-mini-batch: 32
[2023-07-04 21:14:11] [config] valid-reset-stalled: false
[2023-07-04 21:14:11] [config] valid-script-args:
[2023-07-04 21:14:11] [config]   []
[2023-07-04 21:14:11] [config] valid-script-path: ""
[2023-07-04 21:14:11] [config] valid-sets:
[2023-07-04 21:14:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:14:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:14:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:14:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:11] [config] vocabs:
[2023-07-04 21:14:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:11] [config] word-penalty: 0
[2023-07-04 21:14:11] [config] word-scores: false
[2023-07-04 21:14:11] [config] workspace: 2048
[2023-07-04 21:14:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:11] [training] Using single-device training
[2023-07-04 21:14:11] Synced seed 1234
[2023-07-04 21:14:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:11] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:14:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:12] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:14:12] [valid] No post-processing script given for validating translator
[2023-07-04 21:14:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:12] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:14:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:14:12] [comm] Using global sharding
[2023-07-04 21:14:12] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:14:12] [training] Using 1 GPUs
[2023-07-04 21:14:12] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:14] Loading Adam parameters
[2023-07-04 21:14:14] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:14:14] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:14:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:14:14] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:14:14] [data] Shuffling data
[2023-07-04 21:14:14] [data] Done reading 20,192 sentences
[2023-07-04 21:14:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:14:14] Training started
[2023-07-04 21:14:14] Training finished
[2023-07-04 21:14:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:18] [marian] Running on node07.datos.cluster.uy as process 20457 with command line:
[2023-07-04 21:14:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:14:18] [config] after: 0e
[2023-07-04 21:14:18] [config] after-batches: 0
[2023-07-04 21:14:18] [config] after-epochs: 190
[2023-07-04 21:14:18] [config] all-caps-every: 0
[2023-07-04 21:14:18] [config] allow-unk: false
[2023-07-04 21:14:18] [config] authors: false
[2023-07-04 21:14:18] [config] beam-size: 12
[2023-07-04 21:14:18] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:14:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:14:18] [config] bert-masking-fraction: 0.15
[2023-07-04 21:14:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:14:18] [config] bert-train-type-embeddings: true
[2023-07-04 21:14:18] [config] bert-type-vocab-size: 2
[2023-07-04 21:14:18] [config] build-info: ""
[2023-07-04 21:14:18] [config] check-gradient-nan: false
[2023-07-04 21:14:18] [config] check-nan: false
[2023-07-04 21:14:18] [config] cite: false
[2023-07-04 21:14:18] [config] clip-norm: 1
[2023-07-04 21:14:18] [config] cost-scaling:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] cost-type: ce-sum
[2023-07-04 21:14:18] [config] cpu-threads: 0
[2023-07-04 21:14:18] [config] data-threads: 8
[2023-07-04 21:14:18] [config] data-weighting: ""
[2023-07-04 21:14:18] [config] data-weighting-type: sentence
[2023-07-04 21:14:18] [config] dec-cell: gru
[2023-07-04 21:14:18] [config] dec-cell-base-depth: 2
[2023-07-04 21:14:18] [config] dec-cell-high-depth: 1
[2023-07-04 21:14:18] [config] dec-depth: 1
[2023-07-04 21:14:18] [config] devices:
[2023-07-04 21:14:18] [config]   - 0
[2023-07-04 21:14:18] [config] dim-emb: 512
[2023-07-04 21:14:18] [config] dim-rnn: 1024
[2023-07-04 21:14:18] [config] dim-vocabs:
[2023-07-04 21:14:18] [config]   - 54042
[2023-07-04 21:14:18] [config]   - 36507
[2023-07-04 21:14:18] [config] disp-first: 0
[2023-07-04 21:14:18] [config] disp-freq: 1000u
[2023-07-04 21:14:18] [config] disp-label-counts: true
[2023-07-04 21:14:18] [config] dropout-rnn: 0
[2023-07-04 21:14:18] [config] dropout-src: 0
[2023-07-04 21:14:18] [config] dropout-trg: 0
[2023-07-04 21:14:18] [config] dump-config: ""
[2023-07-04 21:14:18] [config] dynamic-gradient-scaling:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] early-stopping: 10
[2023-07-04 21:14:18] [config] early-stopping-on: first
[2023-07-04 21:14:18] [config] embedding-fix-src: false
[2023-07-04 21:14:18] [config] embedding-fix-trg: false
[2023-07-04 21:14:18] [config] embedding-normalization: false
[2023-07-04 21:14:18] [config] embedding-vectors:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] enc-cell: gru
[2023-07-04 21:14:18] [config] enc-cell-depth: 1
[2023-07-04 21:14:18] [config] enc-depth: 1
[2023-07-04 21:14:18] [config] enc-type: bidirectional
[2023-07-04 21:14:18] [config] english-title-case-every: 0
[2023-07-04 21:14:18] [config] exponential-smoothing: 0
[2023-07-04 21:14:18] [config] factor-weight: 1
[2023-07-04 21:14:18] [config] factors-combine: sum
[2023-07-04 21:14:18] [config] factors-dim-emb: 0
[2023-07-04 21:14:18] [config] gradient-checkpointing: false
[2023-07-04 21:14:18] [config] gradient-norm-average-window: 100
[2023-07-04 21:14:18] [config] guided-alignment: none
[2023-07-04 21:14:18] [config] guided-alignment-cost: mse
[2023-07-04 21:14:18] [config] guided-alignment-weight: 0.1
[2023-07-04 21:14:18] [config] ignore-model-config: false
[2023-07-04 21:14:18] [config] input-types:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] interpolate-env-vars: false
[2023-07-04 21:14:18] [config] keep-best: false
[2023-07-04 21:14:18] [config] label-smoothing: 0
[2023-07-04 21:14:18] [config] layer-normalization: false
[2023-07-04 21:14:18] [config] learn-rate: 0.0001
[2023-07-04 21:14:18] [config] lemma-dependency: ""
[2023-07-04 21:14:18] [config] lemma-dim-emb: 0
[2023-07-04 21:14:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:14:18] [config] log-level: info
[2023-07-04 21:14:18] [config] log-time-zone: ""
[2023-07-04 21:14:18] [config] logical-epoch:
[2023-07-04 21:14:18] [config]   - 1e
[2023-07-04 21:14:18] [config]   - 0
[2023-07-04 21:14:18] [config] lr-decay: 0
[2023-07-04 21:14:18] [config] lr-decay-freq: 50000
[2023-07-04 21:14:18] [config] lr-decay-inv-sqrt:
[2023-07-04 21:14:18] [config]   - 0
[2023-07-04 21:14:18] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:14:18] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:14:18] [config] lr-decay-start:
[2023-07-04 21:14:18] [config]   - 10
[2023-07-04 21:14:18] [config]   - 1
[2023-07-04 21:14:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:14:18] [config] lr-report: false
[2023-07-04 21:14:18] [config] lr-warmup: 0
[2023-07-04 21:14:18] [config] lr-warmup-at-reload: false
[2023-07-04 21:14:18] [config] lr-warmup-cycle: false
[2023-07-04 21:14:18] [config] lr-warmup-start-rate: 0
[2023-07-04 21:14:18] [config] max-length: 50
[2023-07-04 21:14:18] [config] max-length-crop: false
[2023-07-04 21:14:18] [config] max-length-factor: 3
[2023-07-04 21:14:18] [config] maxi-batch: 100
[2023-07-04 21:14:18] [config] maxi-batch-sort: trg
[2023-07-04 21:14:18] [config] mini-batch: 64
[2023-07-04 21:14:18] [config] mini-batch-fit: false
[2023-07-04 21:14:18] [config] mini-batch-fit-step: 10
[2023-07-04 21:14:18] [config] mini-batch-round-up: true
[2023-07-04 21:14:18] [config] mini-batch-track-lr: false
[2023-07-04 21:14:18] [config] mini-batch-warmup: 0
[2023-07-04 21:14:18] [config] mini-batch-words: 0
[2023-07-04 21:14:18] [config] mini-batch-words-ref: 0
[2023-07-04 21:14:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:18] [config] multi-loss-type: sum
[2023-07-04 21:14:18] [config] n-best: false
[2023-07-04 21:14:18] [config] no-nccl: false
[2023-07-04 21:14:18] [config] no-reload: false
[2023-07-04 21:14:18] [config] no-restore-corpus: false
[2023-07-04 21:14:18] [config] normalize: 0
[2023-07-04 21:14:18] [config] normalize-gradient: false
[2023-07-04 21:14:18] [config] num-devices: 0
[2023-07-04 21:14:18] [config] optimizer: adam
[2023-07-04 21:14:18] [config] optimizer-delay: 1
[2023-07-04 21:14:18] [config] optimizer-params:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] output-omit-bias: false
[2023-07-04 21:14:18] [config] overwrite: true
[2023-07-04 21:14:18] [config] precision:
[2023-07-04 21:14:18] [config]   - float32
[2023-07-04 21:14:18] [config]   - float32
[2023-07-04 21:14:18] [config] pretrained-model: ""
[2023-07-04 21:14:18] [config] quantize-biases: false
[2023-07-04 21:14:18] [config] quantize-bits: 0
[2023-07-04 21:14:18] [config] quantize-log-based: false
[2023-07-04 21:14:18] [config] quantize-optimization-steps: 0
[2023-07-04 21:14:18] [config] quiet: false
[2023-07-04 21:14:18] [config] quiet-translation: true
[2023-07-04 21:14:18] [config] relative-paths: false
[2023-07-04 21:14:18] [config] right-left: false
[2023-07-04 21:14:18] [config] save-freq: 10000u
[2023-07-04 21:14:18] [config] seed: 1234
[2023-07-04 21:14:18] [config] sentencepiece-alphas:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:14:18] [config] sentencepiece-options: ""
[2023-07-04 21:14:18] [config] sharding: global
[2023-07-04 21:14:18] [config] shuffle: data
[2023-07-04 21:14:18] [config] shuffle-in-ram: false
[2023-07-04 21:14:18] [config] sigterm: save-and-exit
[2023-07-04 21:14:18] [config] skip: false
[2023-07-04 21:14:18] [config] sqlite: ""
[2023-07-04 21:14:18] [config] sqlite-drop: false
[2023-07-04 21:14:18] [config] sync-freq: 200u
[2023-07-04 21:14:18] [config] sync-sgd: false
[2023-07-04 21:14:18] [config] tempdir: /tmp
[2023-07-04 21:14:18] [config] tied-embeddings: false
[2023-07-04 21:14:18] [config] tied-embeddings-all: false
[2023-07-04 21:14:18] [config] tied-embeddings-src: false
[2023-07-04 21:14:18] [config] train-embedder-rank:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] train-sets:
[2023-07-04 21:14:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:14:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:14:18] [config] transformer-aan-activation: swish
[2023-07-04 21:14:18] [config] transformer-aan-depth: 2
[2023-07-04 21:14:18] [config] transformer-aan-nogate: false
[2023-07-04 21:14:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:14:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:14:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:14:18] [config] transformer-depth-scaling: false
[2023-07-04 21:14:18] [config] transformer-dim-aan: 2048
[2023-07-04 21:14:18] [config] transformer-dim-ffn: 2048
[2023-07-04 21:14:18] [config] transformer-dropout: 0
[2023-07-04 21:14:18] [config] transformer-dropout-attention: 0
[2023-07-04 21:14:18] [config] transformer-dropout-ffn: 0
[2023-07-04 21:14:18] [config] transformer-ffn-activation: swish
[2023-07-04 21:14:18] [config] transformer-ffn-depth: 2
[2023-07-04 21:14:18] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:14:18] [config] transformer-heads: 8
[2023-07-04 21:14:18] [config] transformer-no-projection: false
[2023-07-04 21:14:18] [config] transformer-pool: false
[2023-07-04 21:14:18] [config] transformer-postprocess: dan
[2023-07-04 21:14:18] [config] transformer-postprocess-emb: d
[2023-07-04 21:14:18] [config] transformer-postprocess-top: ""
[2023-07-04 21:14:18] [config] transformer-preprocess: ""
[2023-07-04 21:14:18] [config] transformer-tied-layers:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] transformer-train-position-embeddings: false
[2023-07-04 21:14:18] [config] tsv: false
[2023-07-04 21:14:18] [config] tsv-fields: 0
[2023-07-04 21:14:18] [config] type: transformer
[2023-07-04 21:14:18] [config] ulr: false
[2023-07-04 21:14:18] [config] ulr-dim-emb: 0
[2023-07-04 21:14:18] [config] ulr-dropout: 0
[2023-07-04 21:14:18] [config] ulr-keys-vectors: ""
[2023-07-04 21:14:18] [config] ulr-query-vectors: ""
[2023-07-04 21:14:18] [config] ulr-softmax-temperature: 1
[2023-07-04 21:14:18] [config] ulr-trainable-transformation: false
[2023-07-04 21:14:18] [config] unlikelihood-loss: false
[2023-07-04 21:14:18] [config] valid-freq: 50000000
[2023-07-04 21:14:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:14:18] [config] valid-max-length: 1000
[2023-07-04 21:14:18] [config] valid-metrics:
[2023-07-04 21:14:18] [config]   - cross-entropy
[2023-07-04 21:14:18] [config]   - translation
[2023-07-04 21:14:18] [config] valid-mini-batch: 32
[2023-07-04 21:14:18] [config] valid-reset-stalled: false
[2023-07-04 21:14:18] [config] valid-script-args:
[2023-07-04 21:14:18] [config]   []
[2023-07-04 21:14:18] [config] valid-script-path: ""
[2023-07-04 21:14:18] [config] valid-sets:
[2023-07-04 21:14:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:14:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:14:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:14:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:18] [config] vocabs:
[2023-07-04 21:14:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:18] [config] word-penalty: 0
[2023-07-04 21:14:18] [config] word-scores: false
[2023-07-04 21:14:18] [config] workspace: 2048
[2023-07-04 21:14:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:18] [training] Using single-device training
[2023-07-04 21:14:18] Synced seed 1234
[2023-07-04 21:14:18] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:18] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:14:18] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:18] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:14:18] [valid] No post-processing script given for validating translator
[2023-07-04 21:14:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:19] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:14:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:14:19] [comm] Using global sharding
[2023-07-04 21:14:19] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:14:19] [training] Using 1 GPUs
[2023-07-04 21:14:19] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:20] Loading Adam parameters
[2023-07-04 21:14:20] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:14:20] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:14:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:14:21] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:14:21] [data] Shuffling data
[2023-07-04 21:14:21] [data] Done reading 20,192 sentences
[2023-07-04 21:14:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:14:21] Training started
[2023-07-04 21:14:21] Training finished
[2023-07-04 21:14:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:24] [marian] Running on node07.datos.cluster.uy as process 20504 with command line:
[2023-07-04 21:14:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-04 21:14:24] [config] after: 0e
[2023-07-04 21:14:24] [config] after-batches: 0
[2023-07-04 21:14:24] [config] after-epochs: 200
[2023-07-04 21:14:24] [config] all-caps-every: 0
[2023-07-04 21:14:24] [config] allow-unk: false
[2023-07-04 21:14:24] [config] authors: false
[2023-07-04 21:14:24] [config] beam-size: 12
[2023-07-04 21:14:24] [config] bert-class-symbol: "[CLS]"
[2023-07-04 21:14:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-04 21:14:24] [config] bert-masking-fraction: 0.15
[2023-07-04 21:14:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-04 21:14:24] [config] bert-train-type-embeddings: true
[2023-07-04 21:14:24] [config] bert-type-vocab-size: 2
[2023-07-04 21:14:24] [config] build-info: ""
[2023-07-04 21:14:24] [config] check-gradient-nan: false
[2023-07-04 21:14:24] [config] check-nan: false
[2023-07-04 21:14:24] [config] cite: false
[2023-07-04 21:14:24] [config] clip-norm: 1
[2023-07-04 21:14:24] [config] cost-scaling:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] cost-type: ce-sum
[2023-07-04 21:14:24] [config] cpu-threads: 0
[2023-07-04 21:14:24] [config] data-threads: 8
[2023-07-04 21:14:24] [config] data-weighting: ""
[2023-07-04 21:14:24] [config] data-weighting-type: sentence
[2023-07-04 21:14:24] [config] dec-cell: gru
[2023-07-04 21:14:24] [config] dec-cell-base-depth: 2
[2023-07-04 21:14:24] [config] dec-cell-high-depth: 1
[2023-07-04 21:14:24] [config] dec-depth: 1
[2023-07-04 21:14:24] [config] devices:
[2023-07-04 21:14:24] [config]   - 0
[2023-07-04 21:14:24] [config] dim-emb: 512
[2023-07-04 21:14:24] [config] dim-rnn: 1024
[2023-07-04 21:14:24] [config] dim-vocabs:
[2023-07-04 21:14:24] [config]   - 54042
[2023-07-04 21:14:24] [config]   - 36507
[2023-07-04 21:14:24] [config] disp-first: 0
[2023-07-04 21:14:24] [config] disp-freq: 1000u
[2023-07-04 21:14:24] [config] disp-label-counts: true
[2023-07-04 21:14:24] [config] dropout-rnn: 0
[2023-07-04 21:14:24] [config] dropout-src: 0
[2023-07-04 21:14:24] [config] dropout-trg: 0
[2023-07-04 21:14:24] [config] dump-config: ""
[2023-07-04 21:14:24] [config] dynamic-gradient-scaling:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] early-stopping: 10
[2023-07-04 21:14:24] [config] early-stopping-on: first
[2023-07-04 21:14:24] [config] embedding-fix-src: false
[2023-07-04 21:14:24] [config] embedding-fix-trg: false
[2023-07-04 21:14:24] [config] embedding-normalization: false
[2023-07-04 21:14:24] [config] embedding-vectors:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] enc-cell: gru
[2023-07-04 21:14:24] [config] enc-cell-depth: 1
[2023-07-04 21:14:24] [config] enc-depth: 1
[2023-07-04 21:14:24] [config] enc-type: bidirectional
[2023-07-04 21:14:24] [config] english-title-case-every: 0
[2023-07-04 21:14:24] [config] exponential-smoothing: 0
[2023-07-04 21:14:24] [config] factor-weight: 1
[2023-07-04 21:14:24] [config] factors-combine: sum
[2023-07-04 21:14:24] [config] factors-dim-emb: 0
[2023-07-04 21:14:24] [config] gradient-checkpointing: false
[2023-07-04 21:14:24] [config] gradient-norm-average-window: 100
[2023-07-04 21:14:24] [config] guided-alignment: none
[2023-07-04 21:14:24] [config] guided-alignment-cost: mse
[2023-07-04 21:14:24] [config] guided-alignment-weight: 0.1
[2023-07-04 21:14:24] [config] ignore-model-config: false
[2023-07-04 21:14:24] [config] input-types:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] interpolate-env-vars: false
[2023-07-04 21:14:24] [config] keep-best: false
[2023-07-04 21:14:24] [config] label-smoothing: 0
[2023-07-04 21:14:24] [config] layer-normalization: false
[2023-07-04 21:14:24] [config] learn-rate: 0.0001
[2023-07-04 21:14:24] [config] lemma-dependency: ""
[2023-07-04 21:14:24] [config] lemma-dim-emb: 0
[2023-07-04 21:14:24] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_july.log
[2023-07-04 21:14:24] [config] log-level: info
[2023-07-04 21:14:24] [config] log-time-zone: ""
[2023-07-04 21:14:24] [config] logical-epoch:
[2023-07-04 21:14:24] [config]   - 1e
[2023-07-04 21:14:24] [config]   - 0
[2023-07-04 21:14:24] [config] lr-decay: 0
[2023-07-04 21:14:24] [config] lr-decay-freq: 50000
[2023-07-04 21:14:24] [config] lr-decay-inv-sqrt:
[2023-07-04 21:14:24] [config]   - 0
[2023-07-04 21:14:24] [config] lr-decay-repeat-warmup: false
[2023-07-04 21:14:24] [config] lr-decay-reset-optimizer: false
[2023-07-04 21:14:24] [config] lr-decay-start:
[2023-07-04 21:14:24] [config]   - 10
[2023-07-04 21:14:24] [config]   - 1
[2023-07-04 21:14:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-04 21:14:24] [config] lr-report: false
[2023-07-04 21:14:24] [config] lr-warmup: 0
[2023-07-04 21:14:24] [config] lr-warmup-at-reload: false
[2023-07-04 21:14:24] [config] lr-warmup-cycle: false
[2023-07-04 21:14:24] [config] lr-warmup-start-rate: 0
[2023-07-04 21:14:24] [config] max-length: 50
[2023-07-04 21:14:24] [config] max-length-crop: false
[2023-07-04 21:14:24] [config] max-length-factor: 3
[2023-07-04 21:14:24] [config] maxi-batch: 100
[2023-07-04 21:14:24] [config] maxi-batch-sort: trg
[2023-07-04 21:14:24] [config] mini-batch: 64
[2023-07-04 21:14:24] [config] mini-batch-fit: false
[2023-07-04 21:14:24] [config] mini-batch-fit-step: 10
[2023-07-04 21:14:24] [config] mini-batch-round-up: true
[2023-07-04 21:14:24] [config] mini-batch-track-lr: false
[2023-07-04 21:14:24] [config] mini-batch-warmup: 0
[2023-07-04 21:14:24] [config] mini-batch-words: 0
[2023-07-04 21:14:24] [config] mini-batch-words-ref: 0
[2023-07-04 21:14:24] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:24] [config] multi-loss-type: sum
[2023-07-04 21:14:24] [config] n-best: false
[2023-07-04 21:14:24] [config] no-nccl: false
[2023-07-04 21:14:24] [config] no-reload: false
[2023-07-04 21:14:24] [config] no-restore-corpus: false
[2023-07-04 21:14:24] [config] normalize: 0
[2023-07-04 21:14:24] [config] normalize-gradient: false
[2023-07-04 21:14:24] [config] num-devices: 0
[2023-07-04 21:14:24] [config] optimizer: adam
[2023-07-04 21:14:24] [config] optimizer-delay: 1
[2023-07-04 21:14:24] [config] optimizer-params:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] output-omit-bias: false
[2023-07-04 21:14:24] [config] overwrite: true
[2023-07-04 21:14:24] [config] precision:
[2023-07-04 21:14:24] [config]   - float32
[2023-07-04 21:14:24] [config]   - float32
[2023-07-04 21:14:24] [config] pretrained-model: ""
[2023-07-04 21:14:24] [config] quantize-biases: false
[2023-07-04 21:14:24] [config] quantize-bits: 0
[2023-07-04 21:14:24] [config] quantize-log-based: false
[2023-07-04 21:14:24] [config] quantize-optimization-steps: 0
[2023-07-04 21:14:24] [config] quiet: false
[2023-07-04 21:14:24] [config] quiet-translation: true
[2023-07-04 21:14:24] [config] relative-paths: false
[2023-07-04 21:14:24] [config] right-left: false
[2023-07-04 21:14:24] [config] save-freq: 10000u
[2023-07-04 21:14:24] [config] seed: 1234
[2023-07-04 21:14:24] [config] sentencepiece-alphas:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] sentencepiece-max-lines: 2000000
[2023-07-04 21:14:24] [config] sentencepiece-options: ""
[2023-07-04 21:14:24] [config] sharding: global
[2023-07-04 21:14:24] [config] shuffle: data
[2023-07-04 21:14:24] [config] shuffle-in-ram: false
[2023-07-04 21:14:24] [config] sigterm: save-and-exit
[2023-07-04 21:14:24] [config] skip: false
[2023-07-04 21:14:24] [config] sqlite: ""
[2023-07-04 21:14:24] [config] sqlite-drop: false
[2023-07-04 21:14:24] [config] sync-freq: 200u
[2023-07-04 21:14:24] [config] sync-sgd: false
[2023-07-04 21:14:24] [config] tempdir: /tmp
[2023-07-04 21:14:24] [config] tied-embeddings: false
[2023-07-04 21:14:24] [config] tied-embeddings-all: false
[2023-07-04 21:14:24] [config] tied-embeddings-src: false
[2023-07-04 21:14:24] [config] train-embedder-rank:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] train-sets:
[2023-07-04 21:14:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-04 21:14:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-04 21:14:24] [config] transformer-aan-activation: swish
[2023-07-04 21:14:24] [config] transformer-aan-depth: 2
[2023-07-04 21:14:24] [config] transformer-aan-nogate: false
[2023-07-04 21:14:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-04 21:14:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-04 21:14:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-04 21:14:24] [config] transformer-depth-scaling: false
[2023-07-04 21:14:24] [config] transformer-dim-aan: 2048
[2023-07-04 21:14:24] [config] transformer-dim-ffn: 2048
[2023-07-04 21:14:24] [config] transformer-dropout: 0
[2023-07-04 21:14:24] [config] transformer-dropout-attention: 0
[2023-07-04 21:14:24] [config] transformer-dropout-ffn: 0
[2023-07-04 21:14:24] [config] transformer-ffn-activation: swish
[2023-07-04 21:14:24] [config] transformer-ffn-depth: 2
[2023-07-04 21:14:24] [config] transformer-guided-alignment-layer: last
[2023-07-04 21:14:24] [config] transformer-heads: 8
[2023-07-04 21:14:24] [config] transformer-no-projection: false
[2023-07-04 21:14:24] [config] transformer-pool: false
[2023-07-04 21:14:24] [config] transformer-postprocess: dan
[2023-07-04 21:14:24] [config] transformer-postprocess-emb: d
[2023-07-04 21:14:24] [config] transformer-postprocess-top: ""
[2023-07-04 21:14:24] [config] transformer-preprocess: ""
[2023-07-04 21:14:24] [config] transformer-tied-layers:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] transformer-train-position-embeddings: false
[2023-07-04 21:14:24] [config] tsv: false
[2023-07-04 21:14:24] [config] tsv-fields: 0
[2023-07-04 21:14:24] [config] type: transformer
[2023-07-04 21:14:24] [config] ulr: false
[2023-07-04 21:14:24] [config] ulr-dim-emb: 0
[2023-07-04 21:14:24] [config] ulr-dropout: 0
[2023-07-04 21:14:24] [config] ulr-keys-vectors: ""
[2023-07-04 21:14:24] [config] ulr-query-vectors: ""
[2023-07-04 21:14:24] [config] ulr-softmax-temperature: 1
[2023-07-04 21:14:24] [config] ulr-trainable-transformation: false
[2023-07-04 21:14:24] [config] unlikelihood-loss: false
[2023-07-04 21:14:24] [config] valid-freq: 50000000
[2023-07-04 21:14:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_july.log
[2023-07-04 21:14:24] [config] valid-max-length: 1000
[2023-07-04 21:14:24] [config] valid-metrics:
[2023-07-04 21:14:24] [config]   - cross-entropy
[2023-07-04 21:14:24] [config]   - translation
[2023-07-04 21:14:24] [config] valid-mini-batch: 32
[2023-07-04 21:14:24] [config] valid-reset-stalled: false
[2023-07-04 21:14:24] [config] valid-script-args:
[2023-07-04 21:14:24] [config]   []
[2023-07-04 21:14:24] [config] valid-script-path: ""
[2023-07-04 21:14:24] [config] valid-sets:
[2023-07-04 21:14:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-04 21:14:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-04 21:14:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-04 21:14:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:24] [config] vocabs:
[2023-07-04 21:14:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:24] [config] word-penalty: 0
[2023-07-04 21:14:24] [config] word-scores: false
[2023-07-04 21:14:24] [config] workspace: 2048
[2023-07-04 21:14:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-04 21:14:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:24] [training] Using single-device training
[2023-07-04 21:14:24] Synced seed 1234
[2023-07-04 21:14:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-04 21:14:24] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-04 21:14:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-04 21:14:24] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-04 21:14:24] [valid] No post-processing script given for validating translator
[2023-07-04 21:14:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-04 21:14:25] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-04 21:14:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-04 21:14:25] [comm] Using global sharding
[2023-07-04 21:14:25] [comm] NCCLCommunicators constructed successfully
[2023-07-04 21:14:25] [training] Using 1 GPUs
[2023-07-04 21:14:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz
[2023-07-04 21:14:26] Loading Adam parameters
[2023-07-04 21:14:27] [memory] Reserving 552 MB, device gpu0
[2023-07-04 21:14:27] [memory] Reserving 276 MB, device gpu0
[2023-07-04 21:14:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_july/gn_es_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-04 21:14:27] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-04 21:14:27] [data] Shuffling data
[2023-07-04 21:14:27] [data] Done reading 20,192 sentences
[2023-07-04 21:14:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-04 21:14:27] Training started
[2023-07-04 21:14:27] Training finished
