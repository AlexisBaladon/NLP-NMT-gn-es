[2023-07-21 17:43:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 17:43:35] [marian] Running on node22.datos.cluster.uy as process 11567 with command line:
[2023-07-21 17:43:35] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 17:43:35] [config] after: 0e
[2023-07-21 17:43:35] [config] after-batches: 0
[2023-07-21 17:43:35] [config] after-epochs: 10
[2023-07-21 17:43:35] [config] all-caps-every: 0
[2023-07-21 17:43:35] [config] allow-unk: false
[2023-07-21 17:43:35] [config] authors: false
[2023-07-21 17:43:35] [config] beam-size: 12
[2023-07-21 17:43:35] [config] bert-class-symbol: "[CLS]"
[2023-07-21 17:43:35] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 17:43:35] [config] bert-masking-fraction: 0.15
[2023-07-21 17:43:35] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 17:43:35] [config] bert-train-type-embeddings: true
[2023-07-21 17:43:35] [config] bert-type-vocab-size: 2
[2023-07-21 17:43:35] [config] build-info: ""
[2023-07-21 17:43:35] [config] check-gradient-nan: false
[2023-07-21 17:43:35] [config] check-nan: false
[2023-07-21 17:43:35] [config] cite: false
[2023-07-21 17:43:35] [config] clip-norm: 1
[2023-07-21 17:43:35] [config] cost-scaling:
[2023-07-21 17:43:35] [config]   - 256.f
[2023-07-21 17:43:35] [config]   - 1000
[2023-07-21 17:43:35] [config]   - 2.f
[2023-07-21 17:43:35] [config]   - 256.f
[2023-07-21 17:43:35] [config] cost-type: ce-sum
[2023-07-21 17:43:35] [config] cpu-threads: 0
[2023-07-21 17:43:35] [config] data-threads: 8
[2023-07-21 17:43:35] [config] data-weighting: ""
[2023-07-21 17:43:35] [config] data-weighting-type: sentence
[2023-07-21 17:43:35] [config] dec-cell: gru
[2023-07-21 17:43:35] [config] dec-cell-base-depth: 2
[2023-07-21 17:43:35] [config] dec-cell-high-depth: 1
[2023-07-21 17:43:35] [config] dec-depth: 1
[2023-07-21 17:43:35] [config] devices:
[2023-07-21 17:43:35] [config]   - 0
[2023-07-21 17:43:35] [config] dim-emb: 512
[2023-07-21 17:43:35] [config] dim-rnn: 1024
[2023-07-21 17:43:35] [config] dim-vocabs:
[2023-07-21 17:43:35] [config]   - 16384
[2023-07-21 17:43:35] [config]   - 16384
[2023-07-21 17:43:35] [config] disp-first: 0
[2023-07-21 17:43:35] [config] disp-freq: 1000u
[2023-07-21 17:43:35] [config] disp-label-counts: true
[2023-07-21 17:43:35] [config] dropout-rnn: 0
[2023-07-21 17:43:35] [config] dropout-src: 0
[2023-07-21 17:43:35] [config] dropout-trg: 0
[2023-07-21 17:43:35] [config] dump-config: ""
[2023-07-21 17:43:35] [config] dynamic-gradient-scaling:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] early-stopping: 200
[2023-07-21 17:43:35] [config] early-stopping-on: first
[2023-07-21 17:43:35] [config] embedding-fix-src: false
[2023-07-21 17:43:35] [config] embedding-fix-trg: false
[2023-07-21 17:43:35] [config] embedding-normalization: false
[2023-07-21 17:43:35] [config] embedding-vectors:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] enc-cell: gru
[2023-07-21 17:43:35] [config] enc-cell-depth: 1
[2023-07-21 17:43:35] [config] enc-depth: 1
[2023-07-21 17:43:35] [config] enc-type: bidirectional
[2023-07-21 17:43:35] [config] english-title-case-every: 0
[2023-07-21 17:43:35] [config] exponential-smoothing: 0
[2023-07-21 17:43:35] [config] factor-weight: 1
[2023-07-21 17:43:35] [config] factors-combine: sum
[2023-07-21 17:43:35] [config] factors-dim-emb: 0
[2023-07-21 17:43:35] [config] gradient-checkpointing: false
[2023-07-21 17:43:35] [config] gradient-norm-average-window: 100
[2023-07-21 17:43:35] [config] guided-alignment: none
[2023-07-21 17:43:35] [config] guided-alignment-cost: mse
[2023-07-21 17:43:35] [config] guided-alignment-weight: 0.1
[2023-07-21 17:43:35] [config] ignore-model-config: false
[2023-07-21 17:43:35] [config] input-types:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] interpolate-env-vars: false
[2023-07-21 17:43:35] [config] keep-best: false
[2023-07-21 17:43:35] [config] label-smoothing: 0
[2023-07-21 17:43:35] [config] layer-normalization: false
[2023-07-21 17:43:35] [config] learn-rate: 0.0001
[2023-07-21 17:43:35] [config] lemma-dependency: ""
[2023-07-21 17:43:35] [config] lemma-dim-emb: 0
[2023-07-21 17:43:35] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 17:43:35] [config] log-level: info
[2023-07-21 17:43:35] [config] log-time-zone: ""
[2023-07-21 17:43:35] [config] logical-epoch:
[2023-07-21 17:43:35] [config]   - 1e
[2023-07-21 17:43:35] [config]   - 0
[2023-07-21 17:43:35] [config] lr-decay: 0
[2023-07-21 17:43:35] [config] lr-decay-freq: 50000
[2023-07-21 17:43:35] [config] lr-decay-inv-sqrt:
[2023-07-21 17:43:35] [config]   - 0
[2023-07-21 17:43:35] [config] lr-decay-repeat-warmup: false
[2023-07-21 17:43:35] [config] lr-decay-reset-optimizer: false
[2023-07-21 17:43:35] [config] lr-decay-start:
[2023-07-21 17:43:35] [config]   - 10
[2023-07-21 17:43:35] [config]   - 1
[2023-07-21 17:43:35] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 17:43:35] [config] lr-report: false
[2023-07-21 17:43:35] [config] lr-warmup: 0
[2023-07-21 17:43:35] [config] lr-warmup-at-reload: false
[2023-07-21 17:43:35] [config] lr-warmup-cycle: false
[2023-07-21 17:43:35] [config] lr-warmup-start-rate: 0
[2023-07-21 17:43:35] [config] max-length: 150
[2023-07-21 17:43:35] [config] max-length-crop: true
[2023-07-21 17:43:35] [config] max-length-factor: 3
[2023-07-21 17:43:35] [config] maxi-batch: 100
[2023-07-21 17:43:35] [config] maxi-batch-sort: trg
[2023-07-21 17:43:35] [config] mini-batch: 64
[2023-07-21 17:43:35] [config] mini-batch-fit: true
[2023-07-21 17:43:35] [config] mini-batch-fit-step: 10
[2023-07-21 17:43:35] [config] mini-batch-round-up: true
[2023-07-21 17:43:35] [config] mini-batch-track-lr: false
[2023-07-21 17:43:35] [config] mini-batch-warmup: 0
[2023-07-21 17:43:35] [config] mini-batch-words: 0
[2023-07-21 17:43:35] [config] mini-batch-words-ref: 0
[2023-07-21 17:43:35] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 17:43:35] [config] multi-loss-type: sum
[2023-07-21 17:43:35] [config] n-best: false
[2023-07-21 17:43:35] [config] no-nccl: false
[2023-07-21 17:43:35] [config] no-reload: false
[2023-07-21 17:43:35] [config] no-restore-corpus: false
[2023-07-21 17:43:35] [config] normalize: 0
[2023-07-21 17:43:35] [config] normalize-gradient: false
[2023-07-21 17:43:35] [config] num-devices: 0
[2023-07-21 17:43:35] [config] optimizer: adam
[2023-07-21 17:43:35] [config] optimizer-delay: 1
[2023-07-21 17:43:35] [config] optimizer-params:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] output-omit-bias: false
[2023-07-21 17:43:35] [config] overwrite: true
[2023-07-21 17:43:35] [config] precision:
[2023-07-21 17:43:35] [config]   - float16
[2023-07-21 17:43:35] [config]   - float32
[2023-07-21 17:43:35] [config] pretrained-model: ""
[2023-07-21 17:43:35] [config] quantize-biases: false
[2023-07-21 17:43:35] [config] quantize-bits: 0
[2023-07-21 17:43:35] [config] quantize-log-based: false
[2023-07-21 17:43:35] [config] quantize-optimization-steps: 0
[2023-07-21 17:43:35] [config] quiet: false
[2023-07-21 17:43:35] [config] quiet-translation: true
[2023-07-21 17:43:35] [config] relative-paths: false
[2023-07-21 17:43:35] [config] right-left: false
[2023-07-21 17:43:35] [config] save-freq: 10000u
[2023-07-21 17:43:35] [config] seed: 1234
[2023-07-21 17:43:35] [config] sentencepiece-alphas:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] sentencepiece-max-lines: 2000000
[2023-07-21 17:43:35] [config] sentencepiece-options: ""
[2023-07-21 17:43:35] [config] sharding: global
[2023-07-21 17:43:35] [config] shuffle: data
[2023-07-21 17:43:35] [config] shuffle-in-ram: false
[2023-07-21 17:43:35] [config] sigterm: save-and-exit
[2023-07-21 17:43:35] [config] skip: false
[2023-07-21 17:43:35] [config] sqlite: ""
[2023-07-21 17:43:35] [config] sqlite-drop: false
[2023-07-21 17:43:35] [config] sync-freq: 200u
[2023-07-21 17:43:35] [config] sync-sgd: false
[2023-07-21 17:43:35] [config] tempdir: /tmp
[2023-07-21 17:43:35] [config] tied-embeddings: false
[2023-07-21 17:43:35] [config] tied-embeddings-all: true
[2023-07-21 17:43:35] [config] tied-embeddings-src: false
[2023-07-21 17:43:35] [config] train-embedder-rank:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] train-sets:
[2023-07-21 17:43:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 17:43:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 17:43:35] [config] transformer-aan-activation: swish
[2023-07-21 17:43:35] [config] transformer-aan-depth: 2
[2023-07-21 17:43:35] [config] transformer-aan-nogate: false
[2023-07-21 17:43:35] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 17:43:35] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 17:43:35] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 17:43:35] [config] transformer-depth-scaling: false
[2023-07-21 17:43:35] [config] transformer-dim-aan: 2048
[2023-07-21 17:43:35] [config] transformer-dim-ffn: 2048
[2023-07-21 17:43:35] [config] transformer-dropout: 0
[2023-07-21 17:43:35] [config] transformer-dropout-attention: 0
[2023-07-21 17:43:35] [config] transformer-dropout-ffn: 0
[2023-07-21 17:43:35] [config] transformer-ffn-activation: swish
[2023-07-21 17:43:35] [config] transformer-ffn-depth: 2
[2023-07-21 17:43:35] [config] transformer-guided-alignment-layer: last
[2023-07-21 17:43:35] [config] transformer-heads: 8
[2023-07-21 17:43:35] [config] transformer-no-projection: false
[2023-07-21 17:43:35] [config] transformer-pool: false
[2023-07-21 17:43:35] [config] transformer-postprocess: dan
[2023-07-21 17:43:35] [config] transformer-postprocess-emb: d
[2023-07-21 17:43:35] [config] transformer-postprocess-top: ""
[2023-07-21 17:43:35] [config] transformer-preprocess: ""
[2023-07-21 17:43:35] [config] transformer-tied-layers:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] transformer-train-position-embeddings: false
[2023-07-21 17:43:35] [config] tsv: false
[2023-07-21 17:43:35] [config] tsv-fields: 0
[2023-07-21 17:43:35] [config] type: amun
[2023-07-21 17:43:35] [config] ulr: false
[2023-07-21 17:43:35] [config] ulr-dim-emb: 0
[2023-07-21 17:43:35] [config] ulr-dropout: 0
[2023-07-21 17:43:35] [config] ulr-keys-vectors: ""
[2023-07-21 17:43:35] [config] ulr-query-vectors: ""
[2023-07-21 17:43:35] [config] ulr-softmax-temperature: 1
[2023-07-21 17:43:35] [config] ulr-trainable-transformation: false
[2023-07-21 17:43:35] [config] unlikelihood-loss: false
[2023-07-21 17:43:35] [config] valid-freq: 50000000
[2023-07-21 17:43:35] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 17:43:35] [config] valid-max-length: 1000
[2023-07-21 17:43:35] [config] valid-metrics:
[2023-07-21 17:43:35] [config]   - cross-entropy
[2023-07-21 17:43:35] [config]   - translation
[2023-07-21 17:43:35] [config] valid-mini-batch: 32
[2023-07-21 17:43:35] [config] valid-reset-stalled: false
[2023-07-21 17:43:35] [config] valid-script-args:
[2023-07-21 17:43:35] [config]   []
[2023-07-21 17:43:35] [config] valid-script-path: ""
[2023-07-21 17:43:35] [config] valid-sets:
[2023-07-21 17:43:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 17:43:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 17:43:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-21 17:43:35] [config] vocabs:
[2023-07-21 17:43:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 17:43:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 17:43:35] [config] word-penalty: 0
[2023-07-21 17:43:35] [config] word-scores: false
[2023-07-21 17:43:35] [config] workspace: 5500
[2023-07-21 17:43:35] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 17:43:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:43:35] [training] Using single-device training
[2023-07-21 17:43:36] Synced seed 1234
[2023-07-21 17:43:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 17:43:36] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 17:43:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 17:43:36] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 17:43:36] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 17:43:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:43:36] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 17:43:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 17:43:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 17:43:38] [comm] Using global sharding
[2023-07-21 17:43:38] [comm] NCCLCommunicators constructed successfully
[2023-07-21 17:43:38] [training] Using 1 GPUs
[2023-07-21 17:43:38] [logits] Applying loss function for 1 factor(s)
[2023-07-21 17:43:38] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:43:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 17:43:41] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:07:19] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 18:07:19] [valid] No post-processing script given for validating translator
[2023-07-21 18:07:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:07:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:07:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:07:20] [comm] Using global sharding
[2023-07-21 18:07:20] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:07:20] [training] Using 1 GPUs
[2023-07-21 18:07:20] Training started
[2023-07-21 18:07:20] [data] Shuffling data
[2023-07-21 18:07:20] [data] Done reading 20,192 sentences
[2023-07-21 18:07:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:07:20] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 18:07:20] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:07:21] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:07:26] Parameter type float16, optimization type float32, casting types true
[2023-07-21 18:07:26] Allocating memory for general optimizer shards
[2023-07-21 18:07:26] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:07:26] Allocating memory for Adam-specific shards
[2023-07-21 18:07:26] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:11:14] Seen 20,192 samples
[2023-07-21 18:11:14] Starting data epoch 2 in logical epoch 2
[2023-07-21 18:11:14] [data] Shuffling data
[2023-07-21 18:11:14] [data] Done reading 20,192 sentences
[2023-07-21 18:11:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:15:38] Seen 20,192 samples
[2023-07-21 18:15:38] Starting data epoch 3 in logical epoch 3
[2023-07-21 18:15:38] [data] Shuffling data
[2023-07-21 18:15:38] [data] Done reading 20,192 sentences
[2023-07-21 18:15:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:19:46] Seen 20,192 samples
[2023-07-21 18:19:46] Starting data epoch 4 in logical epoch 4
[2023-07-21 18:19:46] [data] Shuffling data
[2023-07-21 18:19:46] [data] Done reading 20,192 sentences
[2023-07-21 18:19:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:23:43] Seen 20,192 samples
[2023-07-21 18:23:43] Starting data epoch 5 in logical epoch 5
[2023-07-21 18:23:43] [data] Shuffling data
[2023-07-21 18:23:43] [data] Done reading 20,192 sentences
[2023-07-21 18:23:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:27:53] Seen 20,192 samples
[2023-07-21 18:27:53] Starting data epoch 6 in logical epoch 6
[2023-07-21 18:27:53] [data] Shuffling data
[2023-07-21 18:27:53] [data] Done reading 20,192 sentences
[2023-07-21 18:27:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:32:20] Seen 20,192 samples
[2023-07-21 18:32:20] Starting data epoch 7 in logical epoch 7
[2023-07-21 18:32:20] [data] Shuffling data
[2023-07-21 18:32:20] [data] Done reading 20,192 sentences
[2023-07-21 18:32:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:36:56] Seen 20,192 samples
[2023-07-21 18:36:56] Starting data epoch 8 in logical epoch 8
[2023-07-21 18:36:56] [data] Shuffling data
[2023-07-21 18:36:56] [data] Done reading 20,192 sentences
[2023-07-21 18:36:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:41:25] Seen 20,192 samples
[2023-07-21 18:41:25] Starting data epoch 9 in logical epoch 9
[2023-07-21 18:41:25] [data] Shuffling data
[2023-07-21 18:41:25] [data] Done reading 20,192 sentences
[2023-07-21 18:41:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:45:46] Seen 20,192 samples
[2023-07-21 18:45:46] Starting data epoch 10 in logical epoch 10
[2023-07-21 18:45:46] [data] Shuffling data
[2023-07-21 18:45:46] [data] Done reading 20,192 sentences
[2023-07-21 18:45:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:49:50] Seen 20,192 samples
[2023-07-21 18:49:50] Starting data epoch 11 in logical epoch 11
[2023-07-21 18:49:50] Training finished
[2023-07-21 18:50:00] [valid] Ep. 11 : Up. 440 : cross-entropy : 174.623 : new best
[2023-07-21 18:55:35] [valid] Ep. 11 : Up. 440 : translation : 0 : new best
[2023-07-21 18:55:35] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 18:55:37] Saving Adam parameters
[2023-07-21 18:55:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 18:55:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:55:45] [marian] Running on node22.datos.cluster.uy as process 16055 with command line:
[2023-07-21 18:55:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 18:55:45] [config] after: 0e
[2023-07-21 18:55:45] [config] after-batches: 0
[2023-07-21 18:55:45] [config] after-epochs: 20
[2023-07-21 18:55:45] [config] all-caps-every: 0
[2023-07-21 18:55:45] [config] allow-unk: false
[2023-07-21 18:55:45] [config] authors: false
[2023-07-21 18:55:45] [config] beam-size: 12
[2023-07-21 18:55:45] [config] bert-class-symbol: "[CLS]"
[2023-07-21 18:55:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 18:55:45] [config] bert-masking-fraction: 0.15
[2023-07-21 18:55:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 18:55:45] [config] bert-train-type-embeddings: true
[2023-07-21 18:55:45] [config] bert-type-vocab-size: 2
[2023-07-21 18:55:45] [config] build-info: ""
[2023-07-21 18:55:45] [config] check-gradient-nan: false
[2023-07-21 18:55:45] [config] check-nan: false
[2023-07-21 18:55:45] [config] cite: false
[2023-07-21 18:55:45] [config] clip-norm: 1
[2023-07-21 18:55:45] [config] cost-scaling:
[2023-07-21 18:55:45] [config]   - 256.f
[2023-07-21 18:55:45] [config]   - 1000
[2023-07-21 18:55:45] [config]   - 2.f
[2023-07-21 18:55:45] [config]   - 256.f
[2023-07-21 18:55:45] [config] cost-type: ce-sum
[2023-07-21 18:55:45] [config] cpu-threads: 0
[2023-07-21 18:55:45] [config] data-threads: 8
[2023-07-21 18:55:45] [config] data-weighting: ""
[2023-07-21 18:55:45] [config] data-weighting-type: sentence
[2023-07-21 18:55:45] [config] dec-cell: gru
[2023-07-21 18:55:45] [config] dec-cell-base-depth: 2
[2023-07-21 18:55:45] [config] dec-cell-high-depth: 1
[2023-07-21 18:55:45] [config] dec-depth: 1
[2023-07-21 18:55:45] [config] devices:
[2023-07-21 18:55:45] [config]   - 0
[2023-07-21 18:55:45] [config] dim-emb: 512
[2023-07-21 18:55:45] [config] dim-rnn: 1024
[2023-07-21 18:55:45] [config] dim-vocabs:
[2023-07-21 18:55:45] [config]   - 16384
[2023-07-21 18:55:45] [config]   - 16384
[2023-07-21 18:55:45] [config] disp-first: 0
[2023-07-21 18:55:45] [config] disp-freq: 1000u
[2023-07-21 18:55:45] [config] disp-label-counts: true
[2023-07-21 18:55:45] [config] dropout-rnn: 0
[2023-07-21 18:55:45] [config] dropout-src: 0
[2023-07-21 18:55:45] [config] dropout-trg: 0
[2023-07-21 18:55:45] [config] dump-config: ""
[2023-07-21 18:55:45] [config] dynamic-gradient-scaling:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] early-stopping: 200
[2023-07-21 18:55:45] [config] early-stopping-on: first
[2023-07-21 18:55:45] [config] embedding-fix-src: false
[2023-07-21 18:55:45] [config] embedding-fix-trg: false
[2023-07-21 18:55:45] [config] embedding-normalization: false
[2023-07-21 18:55:45] [config] embedding-vectors:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] enc-cell: gru
[2023-07-21 18:55:45] [config] enc-cell-depth: 1
[2023-07-21 18:55:45] [config] enc-depth: 1
[2023-07-21 18:55:45] [config] enc-type: bidirectional
[2023-07-21 18:55:45] [config] english-title-case-every: 0
[2023-07-21 18:55:45] [config] exponential-smoothing: 0
[2023-07-21 18:55:45] [config] factor-weight: 1
[2023-07-21 18:55:45] [config] factors-combine: sum
[2023-07-21 18:55:45] [config] factors-dim-emb: 0
[2023-07-21 18:55:45] [config] gradient-checkpointing: false
[2023-07-21 18:55:45] [config] gradient-norm-average-window: 100
[2023-07-21 18:55:45] [config] guided-alignment: none
[2023-07-21 18:55:45] [config] guided-alignment-cost: mse
[2023-07-21 18:55:45] [config] guided-alignment-weight: 0.1
[2023-07-21 18:55:45] [config] ignore-model-config: false
[2023-07-21 18:55:45] [config] input-types:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] interpolate-env-vars: false
[2023-07-21 18:55:45] [config] keep-best: false
[2023-07-21 18:55:45] [config] label-smoothing: 0
[2023-07-21 18:55:45] [config] layer-normalization: false
[2023-07-21 18:55:45] [config] learn-rate: 0.0001
[2023-07-21 18:55:45] [config] lemma-dependency: ""
[2023-07-21 18:55:45] [config] lemma-dim-emb: 0
[2023-07-21 18:55:45] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 18:55:45] [config] log-level: info
[2023-07-21 18:55:45] [config] log-time-zone: ""
[2023-07-21 18:55:45] [config] logical-epoch:
[2023-07-21 18:55:45] [config]   - 1e
[2023-07-21 18:55:45] [config]   - 0
[2023-07-21 18:55:45] [config] lr-decay: 0
[2023-07-21 18:55:45] [config] lr-decay-freq: 50000
[2023-07-21 18:55:45] [config] lr-decay-inv-sqrt:
[2023-07-21 18:55:45] [config]   - 0
[2023-07-21 18:55:45] [config] lr-decay-repeat-warmup: false
[2023-07-21 18:55:45] [config] lr-decay-reset-optimizer: false
[2023-07-21 18:55:45] [config] lr-decay-start:
[2023-07-21 18:55:45] [config]   - 10
[2023-07-21 18:55:45] [config]   - 1
[2023-07-21 18:55:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 18:55:45] [config] lr-report: false
[2023-07-21 18:55:45] [config] lr-warmup: 0
[2023-07-21 18:55:45] [config] lr-warmup-at-reload: false
[2023-07-21 18:55:45] [config] lr-warmup-cycle: false
[2023-07-21 18:55:45] [config] lr-warmup-start-rate: 0
[2023-07-21 18:55:45] [config] max-length: 150
[2023-07-21 18:55:45] [config] max-length-crop: true
[2023-07-21 18:55:45] [config] max-length-factor: 3
[2023-07-21 18:55:45] [config] maxi-batch: 100
[2023-07-21 18:55:45] [config] maxi-batch-sort: trg
[2023-07-21 18:55:45] [config] mini-batch: 64
[2023-07-21 18:55:45] [config] mini-batch-fit: true
[2023-07-21 18:55:45] [config] mini-batch-fit-step: 10
[2023-07-21 18:55:45] [config] mini-batch-round-up: true
[2023-07-21 18:55:45] [config] mini-batch-track-lr: false
[2023-07-21 18:55:45] [config] mini-batch-warmup: 0
[2023-07-21 18:55:45] [config] mini-batch-words: 0
[2023-07-21 18:55:45] [config] mini-batch-words-ref: 0
[2023-07-21 18:55:45] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 18:55:45] [config] multi-loss-type: sum
[2023-07-21 18:55:45] [config] n-best: false
[2023-07-21 18:55:45] [config] no-nccl: false
[2023-07-21 18:55:45] [config] no-reload: false
[2023-07-21 18:55:45] [config] no-restore-corpus: false
[2023-07-21 18:55:45] [config] normalize: 0
[2023-07-21 18:55:45] [config] normalize-gradient: false
[2023-07-21 18:55:45] [config] num-devices: 0
[2023-07-21 18:55:45] [config] optimizer: adam
[2023-07-21 18:55:45] [config] optimizer-delay: 1
[2023-07-21 18:55:45] [config] optimizer-params:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] output-omit-bias: false
[2023-07-21 18:55:45] [config] overwrite: true
[2023-07-21 18:55:45] [config] precision:
[2023-07-21 18:55:45] [config]   - float16
[2023-07-21 18:55:45] [config]   - float32
[2023-07-21 18:55:45] [config] pretrained-model: ""
[2023-07-21 18:55:45] [config] quantize-biases: false
[2023-07-21 18:55:45] [config] quantize-bits: 0
[2023-07-21 18:55:45] [config] quantize-log-based: false
[2023-07-21 18:55:45] [config] quantize-optimization-steps: 0
[2023-07-21 18:55:45] [config] quiet: false
[2023-07-21 18:55:45] [config] quiet-translation: true
[2023-07-21 18:55:45] [config] relative-paths: false
[2023-07-21 18:55:45] [config] right-left: false
[2023-07-21 18:55:45] [config] save-freq: 10000u
[2023-07-21 18:55:45] [config] seed: 1234
[2023-07-21 18:55:45] [config] sentencepiece-alphas:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] sentencepiece-max-lines: 2000000
[2023-07-21 18:55:45] [config] sentencepiece-options: ""
[2023-07-21 18:55:45] [config] sharding: global
[2023-07-21 18:55:45] [config] shuffle: data
[2023-07-21 18:55:45] [config] shuffle-in-ram: false
[2023-07-21 18:55:45] [config] sigterm: save-and-exit
[2023-07-21 18:55:45] [config] skip: false
[2023-07-21 18:55:45] [config] sqlite: ""
[2023-07-21 18:55:45] [config] sqlite-drop: false
[2023-07-21 18:55:45] [config] sync-freq: 200u
[2023-07-21 18:55:45] [config] sync-sgd: false
[2023-07-21 18:55:45] [config] tempdir: /tmp
[2023-07-21 18:55:45] [config] tied-embeddings: false
[2023-07-21 18:55:45] [config] tied-embeddings-all: true
[2023-07-21 18:55:45] [config] tied-embeddings-src: false
[2023-07-21 18:55:45] [config] train-embedder-rank:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] train-sets:
[2023-07-21 18:55:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 18:55:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 18:55:45] [config] transformer-aan-activation: swish
[2023-07-21 18:55:45] [config] transformer-aan-depth: 2
[2023-07-21 18:55:45] [config] transformer-aan-nogate: false
[2023-07-21 18:55:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 18:55:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 18:55:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 18:55:45] [config] transformer-depth-scaling: false
[2023-07-21 18:55:45] [config] transformer-dim-aan: 2048
[2023-07-21 18:55:45] [config] transformer-dim-ffn: 2048
[2023-07-21 18:55:45] [config] transformer-dropout: 0
[2023-07-21 18:55:45] [config] transformer-dropout-attention: 0
[2023-07-21 18:55:45] [config] transformer-dropout-ffn: 0
[2023-07-21 18:55:45] [config] transformer-ffn-activation: swish
[2023-07-21 18:55:45] [config] transformer-ffn-depth: 2
[2023-07-21 18:55:45] [config] transformer-guided-alignment-layer: last
[2023-07-21 18:55:45] [config] transformer-heads: 8
[2023-07-21 18:55:45] [config] transformer-no-projection: false
[2023-07-21 18:55:45] [config] transformer-pool: false
[2023-07-21 18:55:45] [config] transformer-postprocess: dan
[2023-07-21 18:55:45] [config] transformer-postprocess-emb: d
[2023-07-21 18:55:45] [config] transformer-postprocess-top: ""
[2023-07-21 18:55:45] [config] transformer-preprocess: ""
[2023-07-21 18:55:45] [config] transformer-tied-layers:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] transformer-train-position-embeddings: false
[2023-07-21 18:55:45] [config] tsv: false
[2023-07-21 18:55:45] [config] tsv-fields: 0
[2023-07-21 18:55:45] [config] type: amun
[2023-07-21 18:55:45] [config] ulr: false
[2023-07-21 18:55:45] [config] ulr-dim-emb: 0
[2023-07-21 18:55:45] [config] ulr-dropout: 0
[2023-07-21 18:55:45] [config] ulr-keys-vectors: ""
[2023-07-21 18:55:45] [config] ulr-query-vectors: ""
[2023-07-21 18:55:45] [config] ulr-softmax-temperature: 1
[2023-07-21 18:55:45] [config] ulr-trainable-transformation: false
[2023-07-21 18:55:45] [config] unlikelihood-loss: false
[2023-07-21 18:55:45] [config] valid-freq: 50000000
[2023-07-21 18:55:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 18:55:45] [config] valid-max-length: 1000
[2023-07-21 18:55:45] [config] valid-metrics:
[2023-07-21 18:55:45] [config]   - cross-entropy
[2023-07-21 18:55:45] [config]   - translation
[2023-07-21 18:55:45] [config] valid-mini-batch: 32
[2023-07-21 18:55:45] [config] valid-reset-stalled: false
[2023-07-21 18:55:45] [config] valid-script-args:
[2023-07-21 18:55:45] [config]   []
[2023-07-21 18:55:45] [config] valid-script-path: ""
[2023-07-21 18:55:45] [config] valid-sets:
[2023-07-21 18:55:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 18:55:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 18:55:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-21 18:55:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:55:45] [config] vocabs:
[2023-07-21 18:55:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:55:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:55:45] [config] word-penalty: 0
[2023-07-21 18:55:45] [config] word-scores: false
[2023-07-21 18:55:45] [config] workspace: 5500
[2023-07-21 18:55:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:55:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:55:45] [training] Using single-device training
[2023-07-21 18:55:46] Synced seed 1234
[2023-07-21 18:55:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:55:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 18:55:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:55:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 18:55:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 18:55:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:55:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 18:55:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:55:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:55:47] [comm] Using global sharding
[2023-07-21 18:55:47] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:55:47] [training] Using 1 GPUs
[2023-07-21 18:55:47] [logits] Applying loss function for 1 factor(s)
[2023-07-21 18:55:47] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:55:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 18:55:48] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:22:24] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 19:22:24] [valid] No post-processing script given for validating translator
[2023-07-21 19:22:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:22:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 19:22:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 19:22:24] [comm] Using global sharding
[2023-07-21 19:22:24] [comm] NCCLCommunicators constructed successfully
[2023-07-21 19:22:24] [training] Using 1 GPUs
[2023-07-21 19:22:24] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 19:22:30] Allocating memory for general optimizer shards
[2023-07-21 19:22:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:22:30] Loading Adam parameters
[2023-07-21 19:22:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:22:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:22:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 19:22:30] [data] Restoring the corpus state to epoch 11, batch 440
[2023-07-21 19:22:30] [data] Shuffling data
[2023-07-21 19:22:30] [data] Done reading 20,192 sentences
[2023-07-21 19:22:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:22:30] Training started
[2023-07-21 19:22:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 19:22:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:22:31] Parameter type float16, optimization type float32, casting types true
[2023-07-21 19:26:24] Seen 20,192 samples
[2023-07-21 19:26:24] Starting data epoch 12 in logical epoch 12
[2023-07-21 19:26:24] [data] Shuffling data
[2023-07-21 19:26:24] [data] Done reading 20,192 sentences
[2023-07-21 19:26:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:30:26] Seen 20,192 samples
[2023-07-21 19:30:26] Starting data epoch 13 in logical epoch 13
[2023-07-21 19:30:26] [data] Shuffling data
[2023-07-21 19:30:26] [data] Done reading 20,192 sentences
[2023-07-21 19:30:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:34:30] Seen 20,192 samples
[2023-07-21 19:34:30] Starting data epoch 14 in logical epoch 14
[2023-07-21 19:34:30] [data] Shuffling data
[2023-07-21 19:34:30] [data] Done reading 20,192 sentences
[2023-07-21 19:34:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:38:40] Seen 20,192 samples
[2023-07-21 19:38:40] Starting data epoch 15 in logical epoch 15
[2023-07-21 19:38:40] [data] Shuffling data
[2023-07-21 19:38:40] [data] Done reading 20,192 sentences
[2023-07-21 19:38:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:42:50] Seen 20,192 samples
[2023-07-21 19:42:50] Starting data epoch 16 in logical epoch 16
[2023-07-21 19:42:50] [data] Shuffling data
[2023-07-21 19:42:50] [data] Done reading 20,192 sentences
[2023-07-21 19:42:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:46:59] Seen 20,192 samples
[2023-07-21 19:46:59] Starting data epoch 17 in logical epoch 17
[2023-07-21 19:46:59] [data] Shuffling data
[2023-07-21 19:46:59] [data] Done reading 20,192 sentences
[2023-07-21 19:46:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:51:20] Seen 20,192 samples
[2023-07-21 19:51:20] Starting data epoch 18 in logical epoch 18
[2023-07-21 19:51:20] [data] Shuffling data
[2023-07-21 19:51:20] [data] Done reading 20,192 sentences
[2023-07-21 19:51:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:55:35] Seen 20,192 samples
[2023-07-21 19:55:35] Starting data epoch 19 in logical epoch 19
[2023-07-21 19:55:35] [data] Shuffling data
[2023-07-21 19:55:35] [data] Done reading 20,192 sentences
[2023-07-21 19:55:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:59:48] Seen 20,192 samples
[2023-07-21 19:59:48] Starting data epoch 20 in logical epoch 20
[2023-07-21 19:59:48] [data] Shuffling data
[2023-07-21 19:59:48] [data] Done reading 20,192 sentences
[2023-07-21 19:59:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:04:11] Seen 20,192 samples
[2023-07-21 20:04:11] Starting data epoch 21 in logical epoch 21
[2023-07-21 20:04:11] Training finished
[2023-07-21 20:04:19] [valid] Ep. 21 : Up. 878 : cross-entropy : 160.841 : new best
[2023-07-21 20:09:35] [valid] Ep. 21 : Up. 878 : translation : 0 : new best
[2023-07-21 20:09:35] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 20:09:37] Saving Adam parameters
[2023-07-21 20:09:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 20:09:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:09:44] [marian] Running on node22.datos.cluster.uy as process 20977 with command line:
[2023-07-21 20:09:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 20:09:44] [config] after: 0e
[2023-07-21 20:09:44] [config] after-batches: 0
[2023-07-21 20:09:44] [config] after-epochs: 30
[2023-07-21 20:09:44] [config] all-caps-every: 0
[2023-07-21 20:09:44] [config] allow-unk: false
[2023-07-21 20:09:44] [config] authors: false
[2023-07-21 20:09:44] [config] beam-size: 12
[2023-07-21 20:09:44] [config] bert-class-symbol: "[CLS]"
[2023-07-21 20:09:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 20:09:44] [config] bert-masking-fraction: 0.15
[2023-07-21 20:09:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 20:09:44] [config] bert-train-type-embeddings: true
[2023-07-21 20:09:44] [config] bert-type-vocab-size: 2
[2023-07-21 20:09:44] [config] build-info: ""
[2023-07-21 20:09:44] [config] check-gradient-nan: false
[2023-07-21 20:09:44] [config] check-nan: false
[2023-07-21 20:09:44] [config] cite: false
[2023-07-21 20:09:44] [config] clip-norm: 1
[2023-07-21 20:09:44] [config] cost-scaling:
[2023-07-21 20:09:44] [config]   - 256.f
[2023-07-21 20:09:44] [config]   - 1000
[2023-07-21 20:09:44] [config]   - 2.f
[2023-07-21 20:09:44] [config]   - 256.f
[2023-07-21 20:09:44] [config] cost-type: ce-sum
[2023-07-21 20:09:44] [config] cpu-threads: 0
[2023-07-21 20:09:44] [config] data-threads: 8
[2023-07-21 20:09:44] [config] data-weighting: ""
[2023-07-21 20:09:44] [config] data-weighting-type: sentence
[2023-07-21 20:09:44] [config] dec-cell: gru
[2023-07-21 20:09:44] [config] dec-cell-base-depth: 2
[2023-07-21 20:09:44] [config] dec-cell-high-depth: 1
[2023-07-21 20:09:44] [config] dec-depth: 1
[2023-07-21 20:09:44] [config] devices:
[2023-07-21 20:09:44] [config]   - 0
[2023-07-21 20:09:44] [config] dim-emb: 512
[2023-07-21 20:09:44] [config] dim-rnn: 1024
[2023-07-21 20:09:44] [config] dim-vocabs:
[2023-07-21 20:09:44] [config]   - 16384
[2023-07-21 20:09:44] [config]   - 16384
[2023-07-21 20:09:44] [config] disp-first: 0
[2023-07-21 20:09:44] [config] disp-freq: 1000u
[2023-07-21 20:09:44] [config] disp-label-counts: true
[2023-07-21 20:09:44] [config] dropout-rnn: 0
[2023-07-21 20:09:44] [config] dropout-src: 0
[2023-07-21 20:09:44] [config] dropout-trg: 0
[2023-07-21 20:09:44] [config] dump-config: ""
[2023-07-21 20:09:44] [config] dynamic-gradient-scaling:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] early-stopping: 200
[2023-07-21 20:09:44] [config] early-stopping-on: first
[2023-07-21 20:09:44] [config] embedding-fix-src: false
[2023-07-21 20:09:44] [config] embedding-fix-trg: false
[2023-07-21 20:09:44] [config] embedding-normalization: false
[2023-07-21 20:09:44] [config] embedding-vectors:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] enc-cell: gru
[2023-07-21 20:09:44] [config] enc-cell-depth: 1
[2023-07-21 20:09:44] [config] enc-depth: 1
[2023-07-21 20:09:44] [config] enc-type: bidirectional
[2023-07-21 20:09:44] [config] english-title-case-every: 0
[2023-07-21 20:09:44] [config] exponential-smoothing: 0
[2023-07-21 20:09:44] [config] factor-weight: 1
[2023-07-21 20:09:44] [config] factors-combine: sum
[2023-07-21 20:09:44] [config] factors-dim-emb: 0
[2023-07-21 20:09:44] [config] gradient-checkpointing: false
[2023-07-21 20:09:44] [config] gradient-norm-average-window: 100
[2023-07-21 20:09:44] [config] guided-alignment: none
[2023-07-21 20:09:44] [config] guided-alignment-cost: mse
[2023-07-21 20:09:44] [config] guided-alignment-weight: 0.1
[2023-07-21 20:09:44] [config] ignore-model-config: false
[2023-07-21 20:09:44] [config] input-types:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] interpolate-env-vars: false
[2023-07-21 20:09:44] [config] keep-best: false
[2023-07-21 20:09:44] [config] label-smoothing: 0
[2023-07-21 20:09:44] [config] layer-normalization: false
[2023-07-21 20:09:44] [config] learn-rate: 0.0001
[2023-07-21 20:09:44] [config] lemma-dependency: ""
[2023-07-21 20:09:44] [config] lemma-dim-emb: 0
[2023-07-21 20:09:44] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 20:09:44] [config] log-level: info
[2023-07-21 20:09:44] [config] log-time-zone: ""
[2023-07-21 20:09:44] [config] logical-epoch:
[2023-07-21 20:09:44] [config]   - 1e
[2023-07-21 20:09:44] [config]   - 0
[2023-07-21 20:09:44] [config] lr-decay: 0
[2023-07-21 20:09:44] [config] lr-decay-freq: 50000
[2023-07-21 20:09:44] [config] lr-decay-inv-sqrt:
[2023-07-21 20:09:44] [config]   - 0
[2023-07-21 20:09:44] [config] lr-decay-repeat-warmup: false
[2023-07-21 20:09:44] [config] lr-decay-reset-optimizer: false
[2023-07-21 20:09:44] [config] lr-decay-start:
[2023-07-21 20:09:44] [config]   - 10
[2023-07-21 20:09:44] [config]   - 1
[2023-07-21 20:09:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 20:09:44] [config] lr-report: false
[2023-07-21 20:09:44] [config] lr-warmup: 0
[2023-07-21 20:09:44] [config] lr-warmup-at-reload: false
[2023-07-21 20:09:44] [config] lr-warmup-cycle: false
[2023-07-21 20:09:44] [config] lr-warmup-start-rate: 0
[2023-07-21 20:09:44] [config] max-length: 150
[2023-07-21 20:09:44] [config] max-length-crop: true
[2023-07-21 20:09:44] [config] max-length-factor: 3
[2023-07-21 20:09:44] [config] maxi-batch: 100
[2023-07-21 20:09:44] [config] maxi-batch-sort: trg
[2023-07-21 20:09:44] [config] mini-batch: 64
[2023-07-21 20:09:44] [config] mini-batch-fit: true
[2023-07-21 20:09:44] [config] mini-batch-fit-step: 10
[2023-07-21 20:09:44] [config] mini-batch-round-up: true
[2023-07-21 20:09:44] [config] mini-batch-track-lr: false
[2023-07-21 20:09:44] [config] mini-batch-warmup: 0
[2023-07-21 20:09:44] [config] mini-batch-words: 0
[2023-07-21 20:09:44] [config] mini-batch-words-ref: 0
[2023-07-21 20:09:44] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 20:09:44] [config] multi-loss-type: sum
[2023-07-21 20:09:44] [config] n-best: false
[2023-07-21 20:09:44] [config] no-nccl: false
[2023-07-21 20:09:44] [config] no-reload: false
[2023-07-21 20:09:44] [config] no-restore-corpus: false
[2023-07-21 20:09:44] [config] normalize: 0
[2023-07-21 20:09:44] [config] normalize-gradient: false
[2023-07-21 20:09:44] [config] num-devices: 0
[2023-07-21 20:09:44] [config] optimizer: adam
[2023-07-21 20:09:44] [config] optimizer-delay: 1
[2023-07-21 20:09:44] [config] optimizer-params:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] output-omit-bias: false
[2023-07-21 20:09:44] [config] overwrite: true
[2023-07-21 20:09:44] [config] precision:
[2023-07-21 20:09:44] [config]   - float16
[2023-07-21 20:09:44] [config]   - float32
[2023-07-21 20:09:44] [config] pretrained-model: ""
[2023-07-21 20:09:44] [config] quantize-biases: false
[2023-07-21 20:09:44] [config] quantize-bits: 0
[2023-07-21 20:09:44] [config] quantize-log-based: false
[2023-07-21 20:09:44] [config] quantize-optimization-steps: 0
[2023-07-21 20:09:44] [config] quiet: false
[2023-07-21 20:09:44] [config] quiet-translation: true
[2023-07-21 20:09:44] [config] relative-paths: false
[2023-07-21 20:09:44] [config] right-left: false
[2023-07-21 20:09:44] [config] save-freq: 10000u
[2023-07-21 20:09:44] [config] seed: 1234
[2023-07-21 20:09:44] [config] sentencepiece-alphas:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] sentencepiece-max-lines: 2000000
[2023-07-21 20:09:44] [config] sentencepiece-options: ""
[2023-07-21 20:09:44] [config] sharding: global
[2023-07-21 20:09:44] [config] shuffle: data
[2023-07-21 20:09:44] [config] shuffle-in-ram: false
[2023-07-21 20:09:44] [config] sigterm: save-and-exit
[2023-07-21 20:09:44] [config] skip: false
[2023-07-21 20:09:44] [config] sqlite: ""
[2023-07-21 20:09:44] [config] sqlite-drop: false
[2023-07-21 20:09:44] [config] sync-freq: 200u
[2023-07-21 20:09:44] [config] sync-sgd: false
[2023-07-21 20:09:44] [config] tempdir: /tmp
[2023-07-21 20:09:44] [config] tied-embeddings: false
[2023-07-21 20:09:44] [config] tied-embeddings-all: true
[2023-07-21 20:09:44] [config] tied-embeddings-src: false
[2023-07-21 20:09:44] [config] train-embedder-rank:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] train-sets:
[2023-07-21 20:09:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 20:09:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 20:09:44] [config] transformer-aan-activation: swish
[2023-07-21 20:09:44] [config] transformer-aan-depth: 2
[2023-07-21 20:09:44] [config] transformer-aan-nogate: false
[2023-07-21 20:09:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 20:09:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 20:09:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 20:09:44] [config] transformer-depth-scaling: false
[2023-07-21 20:09:44] [config] transformer-dim-aan: 2048
[2023-07-21 20:09:44] [config] transformer-dim-ffn: 2048
[2023-07-21 20:09:44] [config] transformer-dropout: 0
[2023-07-21 20:09:44] [config] transformer-dropout-attention: 0
[2023-07-21 20:09:44] [config] transformer-dropout-ffn: 0
[2023-07-21 20:09:44] [config] transformer-ffn-activation: swish
[2023-07-21 20:09:44] [config] transformer-ffn-depth: 2
[2023-07-21 20:09:44] [config] transformer-guided-alignment-layer: last
[2023-07-21 20:09:44] [config] transformer-heads: 8
[2023-07-21 20:09:44] [config] transformer-no-projection: false
[2023-07-21 20:09:44] [config] transformer-pool: false
[2023-07-21 20:09:44] [config] transformer-postprocess: dan
[2023-07-21 20:09:44] [config] transformer-postprocess-emb: d
[2023-07-21 20:09:44] [config] transformer-postprocess-top: ""
[2023-07-21 20:09:44] [config] transformer-preprocess: ""
[2023-07-21 20:09:44] [config] transformer-tied-layers:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] transformer-train-position-embeddings: false
[2023-07-21 20:09:44] [config] tsv: false
[2023-07-21 20:09:44] [config] tsv-fields: 0
[2023-07-21 20:09:44] [config] type: amun
[2023-07-21 20:09:44] [config] ulr: false
[2023-07-21 20:09:44] [config] ulr-dim-emb: 0
[2023-07-21 20:09:44] [config] ulr-dropout: 0
[2023-07-21 20:09:44] [config] ulr-keys-vectors: ""
[2023-07-21 20:09:44] [config] ulr-query-vectors: ""
[2023-07-21 20:09:44] [config] ulr-softmax-temperature: 1
[2023-07-21 20:09:44] [config] ulr-trainable-transformation: false
[2023-07-21 20:09:44] [config] unlikelihood-loss: false
[2023-07-21 20:09:44] [config] valid-freq: 50000000
[2023-07-21 20:09:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 20:09:44] [config] valid-max-length: 1000
[2023-07-21 20:09:44] [config] valid-metrics:
[2023-07-21 20:09:44] [config]   - cross-entropy
[2023-07-21 20:09:44] [config]   - translation
[2023-07-21 20:09:44] [config] valid-mini-batch: 32
[2023-07-21 20:09:44] [config] valid-reset-stalled: false
[2023-07-21 20:09:44] [config] valid-script-args:
[2023-07-21 20:09:44] [config]   []
[2023-07-21 20:09:44] [config] valid-script-path: ""
[2023-07-21 20:09:44] [config] valid-sets:
[2023-07-21 20:09:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 20:09:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 20:09:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-21 20:09:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:09:44] [config] vocabs:
[2023-07-21 20:09:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:09:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:09:44] [config] word-penalty: 0
[2023-07-21 20:09:44] [config] word-scores: false
[2023-07-21 20:09:44] [config] workspace: 5500
[2023-07-21 20:09:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:09:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:09:44] [training] Using single-device training
[2023-07-21 20:09:44] Synced seed 1234
[2023-07-21 20:09:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:09:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 20:09:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:09:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 20:09:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 20:09:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:09:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 20:09:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 20:09:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 20:09:46] [comm] Using global sharding
[2023-07-21 20:09:46] [comm] NCCLCommunicators constructed successfully
[2023-07-21 20:09:46] [training] Using 1 GPUs
[2023-07-21 20:09:46] [logits] Applying loss function for 1 factor(s)
[2023-07-21 20:09:46] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:09:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 20:09:46] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:36:19] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 20:36:19] [valid] No post-processing script given for validating translator
[2023-07-21 20:36:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:36:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 20:36:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 20:36:19] [comm] Using global sharding
[2023-07-21 20:36:19] [comm] NCCLCommunicators constructed successfully
[2023-07-21 20:36:19] [training] Using 1 GPUs
[2023-07-21 20:36:19] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 20:36:25] Allocating memory for general optimizer shards
[2023-07-21 20:36:25] [memory] Reserving 322 MB, device gpu0
[2023-07-21 20:36:25] Loading Adam parameters
[2023-07-21 20:36:26] [memory] Reserving 322 MB, device gpu0
[2023-07-21 20:36:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:36:26] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 20:36:26] [data] Restoring the corpus state to epoch 21, batch 878
[2023-07-21 20:36:26] [data] Shuffling data
[2023-07-21 20:36:26] [data] Done reading 20,192 sentences
[2023-07-21 20:36:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:36:26] Training started
[2023-07-21 20:36:26] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 20:36:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:36:30] Parameter type float16, optimization type float32, casting types true
[2023-07-21 20:40:33] Seen 20,192 samples
[2023-07-21 20:40:33] Starting data epoch 22 in logical epoch 22
[2023-07-21 20:40:33] [data] Shuffling data
[2023-07-21 20:40:33] [data] Done reading 20,192 sentences
[2023-07-21 20:40:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:45:01] Seen 20,192 samples
[2023-07-21 20:45:01] Starting data epoch 23 in logical epoch 23
[2023-07-21 20:45:01] [data] Shuffling data
[2023-07-21 20:45:01] [data] Done reading 20,192 sentences
[2023-07-21 20:45:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:48:13] Ep. 23 : Up. 1000 : Sen. 16,055 : Cost 6.65640736 * 12,368,887 @ 6,290 after 12,368,887 : Time 714.42s : 17313.15 words/s : gNorm 1.1825
[2023-07-21 20:49:19] Seen 20,192 samples
[2023-07-21 20:49:19] Starting data epoch 24 in logical epoch 24
[2023-07-21 20:49:19] [data] Shuffling data
[2023-07-21 20:49:19] [data] Done reading 20,192 sentences
[2023-07-21 20:49:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:53:44] Seen 20,192 samples
[2023-07-21 20:53:44] Starting data epoch 25 in logical epoch 25
[2023-07-21 20:53:44] [data] Shuffling data
[2023-07-21 20:53:44] [data] Done reading 20,192 sentences
[2023-07-21 20:53:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:58:14] Seen 20,192 samples
[2023-07-21 20:58:14] Starting data epoch 26 in logical epoch 26
[2023-07-21 20:58:14] [data] Shuffling data
[2023-07-21 20:58:14] [data] Done reading 20,192 sentences
[2023-07-21 20:58:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:02:30] Seen 20,192 samples
[2023-07-21 21:02:30] Starting data epoch 27 in logical epoch 27
[2023-07-21 21:02:30] [data] Shuffling data
[2023-07-21 21:02:30] [data] Done reading 20,192 sentences
[2023-07-21 21:02:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:06:46] Seen 20,192 samples
[2023-07-21 21:06:46] Starting data epoch 28 in logical epoch 28
[2023-07-21 21:06:46] [data] Shuffling data
[2023-07-21 21:06:46] [data] Done reading 20,192 sentences
[2023-07-21 21:06:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:11:11] Seen 20,192 samples
[2023-07-21 21:11:11] Starting data epoch 29 in logical epoch 29
[2023-07-21 21:11:11] [data] Shuffling data
[2023-07-21 21:11:11] [data] Done reading 20,192 sentences
[2023-07-21 21:11:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:15:31] Seen 20,192 samples
[2023-07-21 21:15:31] Starting data epoch 30 in logical epoch 30
[2023-07-21 21:15:31] [data] Shuffling data
[2023-07-21 21:15:31] [data] Done reading 20,192 sentences
[2023-07-21 21:15:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:19:55] Seen 20,192 samples
[2023-07-21 21:19:55] Starting data epoch 31 in logical epoch 31
[2023-07-21 21:19:55] Training finished
[2023-07-21 21:20:06] [valid] Ep. 31 : Up. 1316 : cross-entropy : 151.329 : new best
[2023-07-21 21:22:57] [valid] Ep. 31 : Up. 1316 : translation : 0 : new best
[2023-07-21 21:22:57] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 21:23:00] Saving Adam parameters
[2023-07-21 21:23:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 21:23:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 21:23:06] [marian] Running on node22.datos.cluster.uy as process 25514 with command line:
[2023-07-21 21:23:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 21:23:06] [config] after: 0e
[2023-07-21 21:23:06] [config] after-batches: 0
[2023-07-21 21:23:06] [config] after-epochs: 40
[2023-07-21 21:23:06] [config] all-caps-every: 0
[2023-07-21 21:23:06] [config] allow-unk: false
[2023-07-21 21:23:06] [config] authors: false
[2023-07-21 21:23:06] [config] beam-size: 12
[2023-07-21 21:23:06] [config] bert-class-symbol: "[CLS]"
[2023-07-21 21:23:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 21:23:06] [config] bert-masking-fraction: 0.15
[2023-07-21 21:23:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 21:23:06] [config] bert-train-type-embeddings: true
[2023-07-21 21:23:06] [config] bert-type-vocab-size: 2
[2023-07-21 21:23:06] [config] build-info: ""
[2023-07-21 21:23:06] [config] check-gradient-nan: false
[2023-07-21 21:23:06] [config] check-nan: false
[2023-07-21 21:23:06] [config] cite: false
[2023-07-21 21:23:06] [config] clip-norm: 1
[2023-07-21 21:23:06] [config] cost-scaling:
[2023-07-21 21:23:06] [config]   - 256.f
[2023-07-21 21:23:06] [config]   - 1000
[2023-07-21 21:23:06] [config]   - 2.f
[2023-07-21 21:23:06] [config]   - 256.f
[2023-07-21 21:23:06] [config] cost-type: ce-sum
[2023-07-21 21:23:06] [config] cpu-threads: 0
[2023-07-21 21:23:06] [config] data-threads: 8
[2023-07-21 21:23:06] [config] data-weighting: ""
[2023-07-21 21:23:06] [config] data-weighting-type: sentence
[2023-07-21 21:23:06] [config] dec-cell: gru
[2023-07-21 21:23:06] [config] dec-cell-base-depth: 2
[2023-07-21 21:23:06] [config] dec-cell-high-depth: 1
[2023-07-21 21:23:06] [config] dec-depth: 1
[2023-07-21 21:23:06] [config] devices:
[2023-07-21 21:23:06] [config]   - 0
[2023-07-21 21:23:06] [config] dim-emb: 512
[2023-07-21 21:23:06] [config] dim-rnn: 1024
[2023-07-21 21:23:06] [config] dim-vocabs:
[2023-07-21 21:23:06] [config]   - 16384
[2023-07-21 21:23:06] [config]   - 16384
[2023-07-21 21:23:06] [config] disp-first: 0
[2023-07-21 21:23:06] [config] disp-freq: 1000u
[2023-07-21 21:23:06] [config] disp-label-counts: true
[2023-07-21 21:23:06] [config] dropout-rnn: 0
[2023-07-21 21:23:06] [config] dropout-src: 0
[2023-07-21 21:23:06] [config] dropout-trg: 0
[2023-07-21 21:23:06] [config] dump-config: ""
[2023-07-21 21:23:06] [config] dynamic-gradient-scaling:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] early-stopping: 200
[2023-07-21 21:23:06] [config] early-stopping-on: first
[2023-07-21 21:23:06] [config] embedding-fix-src: false
[2023-07-21 21:23:06] [config] embedding-fix-trg: false
[2023-07-21 21:23:06] [config] embedding-normalization: false
[2023-07-21 21:23:06] [config] embedding-vectors:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] enc-cell: gru
[2023-07-21 21:23:06] [config] enc-cell-depth: 1
[2023-07-21 21:23:06] [config] enc-depth: 1
[2023-07-21 21:23:06] [config] enc-type: bidirectional
[2023-07-21 21:23:06] [config] english-title-case-every: 0
[2023-07-21 21:23:06] [config] exponential-smoothing: 0
[2023-07-21 21:23:06] [config] factor-weight: 1
[2023-07-21 21:23:06] [config] factors-combine: sum
[2023-07-21 21:23:06] [config] factors-dim-emb: 0
[2023-07-21 21:23:06] [config] gradient-checkpointing: false
[2023-07-21 21:23:06] [config] gradient-norm-average-window: 100
[2023-07-21 21:23:06] [config] guided-alignment: none
[2023-07-21 21:23:06] [config] guided-alignment-cost: mse
[2023-07-21 21:23:06] [config] guided-alignment-weight: 0.1
[2023-07-21 21:23:06] [config] ignore-model-config: false
[2023-07-21 21:23:06] [config] input-types:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] interpolate-env-vars: false
[2023-07-21 21:23:06] [config] keep-best: false
[2023-07-21 21:23:06] [config] label-smoothing: 0
[2023-07-21 21:23:06] [config] layer-normalization: false
[2023-07-21 21:23:06] [config] learn-rate: 0.0001
[2023-07-21 21:23:06] [config] lemma-dependency: ""
[2023-07-21 21:23:06] [config] lemma-dim-emb: 0
[2023-07-21 21:23:06] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 21:23:06] [config] log-level: info
[2023-07-21 21:23:06] [config] log-time-zone: ""
[2023-07-21 21:23:06] [config] logical-epoch:
[2023-07-21 21:23:06] [config]   - 1e
[2023-07-21 21:23:06] [config]   - 0
[2023-07-21 21:23:06] [config] lr-decay: 0
[2023-07-21 21:23:06] [config] lr-decay-freq: 50000
[2023-07-21 21:23:06] [config] lr-decay-inv-sqrt:
[2023-07-21 21:23:06] [config]   - 0
[2023-07-21 21:23:06] [config] lr-decay-repeat-warmup: false
[2023-07-21 21:23:06] [config] lr-decay-reset-optimizer: false
[2023-07-21 21:23:06] [config] lr-decay-start:
[2023-07-21 21:23:06] [config]   - 10
[2023-07-21 21:23:06] [config]   - 1
[2023-07-21 21:23:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 21:23:06] [config] lr-report: false
[2023-07-21 21:23:06] [config] lr-warmup: 0
[2023-07-21 21:23:06] [config] lr-warmup-at-reload: false
[2023-07-21 21:23:06] [config] lr-warmup-cycle: false
[2023-07-21 21:23:06] [config] lr-warmup-start-rate: 0
[2023-07-21 21:23:06] [config] max-length: 150
[2023-07-21 21:23:06] [config] max-length-crop: true
[2023-07-21 21:23:06] [config] max-length-factor: 3
[2023-07-21 21:23:06] [config] maxi-batch: 100
[2023-07-21 21:23:06] [config] maxi-batch-sort: trg
[2023-07-21 21:23:06] [config] mini-batch: 64
[2023-07-21 21:23:06] [config] mini-batch-fit: true
[2023-07-21 21:23:06] [config] mini-batch-fit-step: 10
[2023-07-21 21:23:06] [config] mini-batch-round-up: true
[2023-07-21 21:23:06] [config] mini-batch-track-lr: false
[2023-07-21 21:23:06] [config] mini-batch-warmup: 0
[2023-07-21 21:23:06] [config] mini-batch-words: 0
[2023-07-21 21:23:06] [config] mini-batch-words-ref: 0
[2023-07-21 21:23:06] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 21:23:06] [config] multi-loss-type: sum
[2023-07-21 21:23:06] [config] n-best: false
[2023-07-21 21:23:06] [config] no-nccl: false
[2023-07-21 21:23:06] [config] no-reload: false
[2023-07-21 21:23:06] [config] no-restore-corpus: false
[2023-07-21 21:23:06] [config] normalize: 0
[2023-07-21 21:23:06] [config] normalize-gradient: false
[2023-07-21 21:23:06] [config] num-devices: 0
[2023-07-21 21:23:06] [config] optimizer: adam
[2023-07-21 21:23:06] [config] optimizer-delay: 1
[2023-07-21 21:23:06] [config] optimizer-params:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] output-omit-bias: false
[2023-07-21 21:23:06] [config] overwrite: true
[2023-07-21 21:23:06] [config] precision:
[2023-07-21 21:23:06] [config]   - float16
[2023-07-21 21:23:06] [config]   - float32
[2023-07-21 21:23:06] [config] pretrained-model: ""
[2023-07-21 21:23:06] [config] quantize-biases: false
[2023-07-21 21:23:06] [config] quantize-bits: 0
[2023-07-21 21:23:06] [config] quantize-log-based: false
[2023-07-21 21:23:06] [config] quantize-optimization-steps: 0
[2023-07-21 21:23:06] [config] quiet: false
[2023-07-21 21:23:06] [config] quiet-translation: true
[2023-07-21 21:23:06] [config] relative-paths: false
[2023-07-21 21:23:06] [config] right-left: false
[2023-07-21 21:23:06] [config] save-freq: 10000u
[2023-07-21 21:23:06] [config] seed: 1234
[2023-07-21 21:23:06] [config] sentencepiece-alphas:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] sentencepiece-max-lines: 2000000
[2023-07-21 21:23:06] [config] sentencepiece-options: ""
[2023-07-21 21:23:06] [config] sharding: global
[2023-07-21 21:23:06] [config] shuffle: data
[2023-07-21 21:23:06] [config] shuffle-in-ram: false
[2023-07-21 21:23:06] [config] sigterm: save-and-exit
[2023-07-21 21:23:06] [config] skip: false
[2023-07-21 21:23:06] [config] sqlite: ""
[2023-07-21 21:23:06] [config] sqlite-drop: false
[2023-07-21 21:23:06] [config] sync-freq: 200u
[2023-07-21 21:23:06] [config] sync-sgd: false
[2023-07-21 21:23:06] [config] tempdir: /tmp
[2023-07-21 21:23:06] [config] tied-embeddings: false
[2023-07-21 21:23:06] [config] tied-embeddings-all: true
[2023-07-21 21:23:06] [config] tied-embeddings-src: false
[2023-07-21 21:23:06] [config] train-embedder-rank:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] train-sets:
[2023-07-21 21:23:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 21:23:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 21:23:06] [config] transformer-aan-activation: swish
[2023-07-21 21:23:06] [config] transformer-aan-depth: 2
[2023-07-21 21:23:06] [config] transformer-aan-nogate: false
[2023-07-21 21:23:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 21:23:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 21:23:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 21:23:06] [config] transformer-depth-scaling: false
[2023-07-21 21:23:06] [config] transformer-dim-aan: 2048
[2023-07-21 21:23:06] [config] transformer-dim-ffn: 2048
[2023-07-21 21:23:06] [config] transformer-dropout: 0
[2023-07-21 21:23:06] [config] transformer-dropout-attention: 0
[2023-07-21 21:23:06] [config] transformer-dropout-ffn: 0
[2023-07-21 21:23:06] [config] transformer-ffn-activation: swish
[2023-07-21 21:23:06] [config] transformer-ffn-depth: 2
[2023-07-21 21:23:06] [config] transformer-guided-alignment-layer: last
[2023-07-21 21:23:06] [config] transformer-heads: 8
[2023-07-21 21:23:06] [config] transformer-no-projection: false
[2023-07-21 21:23:06] [config] transformer-pool: false
[2023-07-21 21:23:06] [config] transformer-postprocess: dan
[2023-07-21 21:23:06] [config] transformer-postprocess-emb: d
[2023-07-21 21:23:06] [config] transformer-postprocess-top: ""
[2023-07-21 21:23:06] [config] transformer-preprocess: ""
[2023-07-21 21:23:06] [config] transformer-tied-layers:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] transformer-train-position-embeddings: false
[2023-07-21 21:23:06] [config] tsv: false
[2023-07-21 21:23:06] [config] tsv-fields: 0
[2023-07-21 21:23:06] [config] type: amun
[2023-07-21 21:23:06] [config] ulr: false
[2023-07-21 21:23:06] [config] ulr-dim-emb: 0
[2023-07-21 21:23:06] [config] ulr-dropout: 0
[2023-07-21 21:23:06] [config] ulr-keys-vectors: ""
[2023-07-21 21:23:06] [config] ulr-query-vectors: ""
[2023-07-21 21:23:06] [config] ulr-softmax-temperature: 1
[2023-07-21 21:23:06] [config] ulr-trainable-transformation: false
[2023-07-21 21:23:06] [config] unlikelihood-loss: false
[2023-07-21 21:23:06] [config] valid-freq: 50000000
[2023-07-21 21:23:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 21:23:06] [config] valid-max-length: 1000
[2023-07-21 21:23:06] [config] valid-metrics:
[2023-07-21 21:23:06] [config]   - cross-entropy
[2023-07-21 21:23:06] [config]   - translation
[2023-07-21 21:23:06] [config] valid-mini-batch: 32
[2023-07-21 21:23:06] [config] valid-reset-stalled: false
[2023-07-21 21:23:06] [config] valid-script-args:
[2023-07-21 21:23:06] [config]   []
[2023-07-21 21:23:06] [config] valid-script-path: ""
[2023-07-21 21:23:06] [config] valid-sets:
[2023-07-21 21:23:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 21:23:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 21:23:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-21 21:23:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 21:23:06] [config] vocabs:
[2023-07-21 21:23:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 21:23:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 21:23:06] [config] word-penalty: 0
[2023-07-21 21:23:06] [config] word-scores: false
[2023-07-21 21:23:06] [config] workspace: 5500
[2023-07-21 21:23:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 21:23:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:23:06] [training] Using single-device training
[2023-07-21 21:23:06] Synced seed 1234
[2023-07-21 21:23:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 21:23:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 21:23:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 21:23:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 21:23:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 21:23:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:23:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 21:23:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 21:23:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 21:23:08] [comm] Using global sharding
[2023-07-21 21:23:08] [comm] NCCLCommunicators constructed successfully
[2023-07-21 21:23:08] [training] Using 1 GPUs
[2023-07-21 21:23:08] [logits] Applying loss function for 1 factor(s)
[2023-07-21 21:23:08] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:23:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 21:23:08] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:50:03] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 21:50:03] [valid] No post-processing script given for validating translator
[2023-07-21 21:50:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:50:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 21:50:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 21:50:03] [comm] Using global sharding
[2023-07-21 21:50:03] [comm] NCCLCommunicators constructed successfully
[2023-07-21 21:50:03] [training] Using 1 GPUs
[2023-07-21 21:50:03] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 21:50:09] Allocating memory for general optimizer shards
[2023-07-21 21:50:09] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:50:09] Loading Adam parameters
[2023-07-21 21:50:09] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:50:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:50:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 21:50:10] [data] Restoring the corpus state to epoch 31, batch 1316
[2023-07-21 21:50:10] [data] Shuffling data
[2023-07-21 21:50:10] [data] Done reading 20,192 sentences
[2023-07-21 21:50:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:50:10] Training started
[2023-07-21 21:50:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 21:50:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:50:18] Parameter type float16, optimization type float32, casting types true
[2023-07-21 21:54:27] Seen 20,192 samples
[2023-07-21 21:54:27] Starting data epoch 32 in logical epoch 32
[2023-07-21 21:54:27] [data] Shuffling data
[2023-07-21 21:54:27] [data] Done reading 20,192 sentences
[2023-07-21 21:54:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:58:51] Seen 20,192 samples
[2023-07-21 21:58:51] Starting data epoch 33 in logical epoch 33
[2023-07-21 21:58:51] [data] Shuffling data
[2023-07-21 21:58:51] [data] Done reading 20,192 sentences
[2023-07-21 21:58:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:03:31] Seen 20,192 samples
[2023-07-21 22:03:31] Starting data epoch 34 in logical epoch 34
[2023-07-21 22:03:31] [data] Shuffling data
[2023-07-21 22:03:31] [data] Done reading 20,192 sentences
[2023-07-21 22:03:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:07:48] Seen 20,192 samples
[2023-07-21 22:07:48] Starting data epoch 35 in logical epoch 35
[2023-07-21 22:07:48] [data] Shuffling data
[2023-07-21 22:07:48] [data] Done reading 20,192 sentences
[2023-07-21 22:07:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:12:13] Seen 20,192 samples
[2023-07-21 22:12:13] Starting data epoch 36 in logical epoch 36
[2023-07-21 22:12:13] [data] Shuffling data
[2023-07-21 22:12:13] [data] Done reading 20,192 sentences
[2023-07-21 22:12:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:16:50] Seen 20,192 samples
[2023-07-21 22:16:50] Starting data epoch 37 in logical epoch 37
[2023-07-21 22:16:50] [data] Shuffling data
[2023-07-21 22:16:50] [data] Done reading 20,192 sentences
[2023-07-21 22:16:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:21:38] Seen 20,192 samples
[2023-07-21 22:21:38] Starting data epoch 38 in logical epoch 38
[2023-07-21 22:21:38] [data] Shuffling data
[2023-07-21 22:21:38] [data] Done reading 20,192 sentences
[2023-07-21 22:21:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:26:10] Seen 20,192 samples
[2023-07-21 22:26:10] Starting data epoch 39 in logical epoch 39
[2023-07-21 22:26:10] [data] Shuffling data
[2023-07-21 22:26:10] [data] Done reading 20,192 sentences
[2023-07-21 22:26:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:30:32] Seen 20,192 samples
[2023-07-21 22:30:32] Starting data epoch 40 in logical epoch 40
[2023-07-21 22:30:32] [data] Shuffling data
[2023-07-21 22:30:32] [data] Done reading 20,192 sentences
[2023-07-21 22:30:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:34:48] Seen 20,192 samples
[2023-07-21 22:34:48] Starting data epoch 41 in logical epoch 41
[2023-07-21 22:34:48] Training finished
[2023-07-21 22:34:59] [valid] Ep. 41 : Up. 1757 : cross-entropy : 144.889 : new best
[2023-07-21 22:38:13] [valid] Ep. 41 : Up. 1757 : translation : 0 : new best
[2023-07-21 22:38:13] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 22:38:14] Saving Adam parameters
[2023-07-21 22:38:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 22:38:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:38:21] [marian] Running on node22.datos.cluster.uy as process 30479 with command line:
[2023-07-21 22:38:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 22:38:21] [config] after: 0e
[2023-07-21 22:38:21] [config] after-batches: 0
[2023-07-21 22:38:21] [config] after-epochs: 50
[2023-07-21 22:38:21] [config] all-caps-every: 0
[2023-07-21 22:38:21] [config] allow-unk: false
[2023-07-21 22:38:21] [config] authors: false
[2023-07-21 22:38:21] [config] beam-size: 12
[2023-07-21 22:38:21] [config] bert-class-symbol: "[CLS]"
[2023-07-21 22:38:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 22:38:21] [config] bert-masking-fraction: 0.15
[2023-07-21 22:38:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 22:38:21] [config] bert-train-type-embeddings: true
[2023-07-21 22:38:21] [config] bert-type-vocab-size: 2
[2023-07-21 22:38:21] [config] build-info: ""
[2023-07-21 22:38:21] [config] check-gradient-nan: false
[2023-07-21 22:38:21] [config] check-nan: false
[2023-07-21 22:38:21] [config] cite: false
[2023-07-21 22:38:21] [config] clip-norm: 1
[2023-07-21 22:38:21] [config] cost-scaling:
[2023-07-21 22:38:21] [config]   - 256.f
[2023-07-21 22:38:21] [config]   - 1000
[2023-07-21 22:38:21] [config]   - 2.f
[2023-07-21 22:38:21] [config]   - 256.f
[2023-07-21 22:38:21] [config] cost-type: ce-sum
[2023-07-21 22:38:21] [config] cpu-threads: 0
[2023-07-21 22:38:21] [config] data-threads: 8
[2023-07-21 22:38:21] [config] data-weighting: ""
[2023-07-21 22:38:21] [config] data-weighting-type: sentence
[2023-07-21 22:38:21] [config] dec-cell: gru
[2023-07-21 22:38:21] [config] dec-cell-base-depth: 2
[2023-07-21 22:38:21] [config] dec-cell-high-depth: 1
[2023-07-21 22:38:21] [config] dec-depth: 1
[2023-07-21 22:38:21] [config] devices:
[2023-07-21 22:38:21] [config]   - 0
[2023-07-21 22:38:21] [config] dim-emb: 512
[2023-07-21 22:38:21] [config] dim-rnn: 1024
[2023-07-21 22:38:21] [config] dim-vocabs:
[2023-07-21 22:38:21] [config]   - 16384
[2023-07-21 22:38:21] [config]   - 16384
[2023-07-21 22:38:21] [config] disp-first: 0
[2023-07-21 22:38:21] [config] disp-freq: 1000u
[2023-07-21 22:38:21] [config] disp-label-counts: true
[2023-07-21 22:38:21] [config] dropout-rnn: 0
[2023-07-21 22:38:21] [config] dropout-src: 0
[2023-07-21 22:38:21] [config] dropout-trg: 0
[2023-07-21 22:38:21] [config] dump-config: ""
[2023-07-21 22:38:21] [config] dynamic-gradient-scaling:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] early-stopping: 200
[2023-07-21 22:38:21] [config] early-stopping-on: first
[2023-07-21 22:38:21] [config] embedding-fix-src: false
[2023-07-21 22:38:21] [config] embedding-fix-trg: false
[2023-07-21 22:38:21] [config] embedding-normalization: false
[2023-07-21 22:38:21] [config] embedding-vectors:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] enc-cell: gru
[2023-07-21 22:38:21] [config] enc-cell-depth: 1
[2023-07-21 22:38:21] [config] enc-depth: 1
[2023-07-21 22:38:21] [config] enc-type: bidirectional
[2023-07-21 22:38:21] [config] english-title-case-every: 0
[2023-07-21 22:38:21] [config] exponential-smoothing: 0
[2023-07-21 22:38:21] [config] factor-weight: 1
[2023-07-21 22:38:21] [config] factors-combine: sum
[2023-07-21 22:38:21] [config] factors-dim-emb: 0
[2023-07-21 22:38:21] [config] gradient-checkpointing: false
[2023-07-21 22:38:21] [config] gradient-norm-average-window: 100
[2023-07-21 22:38:21] [config] guided-alignment: none
[2023-07-21 22:38:21] [config] guided-alignment-cost: mse
[2023-07-21 22:38:21] [config] guided-alignment-weight: 0.1
[2023-07-21 22:38:21] [config] ignore-model-config: false
[2023-07-21 22:38:21] [config] input-types:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] interpolate-env-vars: false
[2023-07-21 22:38:21] [config] keep-best: false
[2023-07-21 22:38:21] [config] label-smoothing: 0
[2023-07-21 22:38:21] [config] layer-normalization: false
[2023-07-21 22:38:21] [config] learn-rate: 0.0001
[2023-07-21 22:38:21] [config] lemma-dependency: ""
[2023-07-21 22:38:21] [config] lemma-dim-emb: 0
[2023-07-21 22:38:21] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 22:38:21] [config] log-level: info
[2023-07-21 22:38:21] [config] log-time-zone: ""
[2023-07-21 22:38:21] [config] logical-epoch:
[2023-07-21 22:38:21] [config]   - 1e
[2023-07-21 22:38:21] [config]   - 0
[2023-07-21 22:38:21] [config] lr-decay: 0
[2023-07-21 22:38:21] [config] lr-decay-freq: 50000
[2023-07-21 22:38:21] [config] lr-decay-inv-sqrt:
[2023-07-21 22:38:21] [config]   - 0
[2023-07-21 22:38:21] [config] lr-decay-repeat-warmup: false
[2023-07-21 22:38:21] [config] lr-decay-reset-optimizer: false
[2023-07-21 22:38:21] [config] lr-decay-start:
[2023-07-21 22:38:21] [config]   - 10
[2023-07-21 22:38:21] [config]   - 1
[2023-07-21 22:38:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 22:38:21] [config] lr-report: false
[2023-07-21 22:38:21] [config] lr-warmup: 0
[2023-07-21 22:38:21] [config] lr-warmup-at-reload: false
[2023-07-21 22:38:21] [config] lr-warmup-cycle: false
[2023-07-21 22:38:21] [config] lr-warmup-start-rate: 0
[2023-07-21 22:38:21] [config] max-length: 150
[2023-07-21 22:38:21] [config] max-length-crop: true
[2023-07-21 22:38:21] [config] max-length-factor: 3
[2023-07-21 22:38:21] [config] maxi-batch: 100
[2023-07-21 22:38:21] [config] maxi-batch-sort: trg
[2023-07-21 22:38:21] [config] mini-batch: 64
[2023-07-21 22:38:21] [config] mini-batch-fit: true
[2023-07-21 22:38:21] [config] mini-batch-fit-step: 10
[2023-07-21 22:38:21] [config] mini-batch-round-up: true
[2023-07-21 22:38:21] [config] mini-batch-track-lr: false
[2023-07-21 22:38:21] [config] mini-batch-warmup: 0
[2023-07-21 22:38:21] [config] mini-batch-words: 0
[2023-07-21 22:38:21] [config] mini-batch-words-ref: 0
[2023-07-21 22:38:21] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 22:38:21] [config] multi-loss-type: sum
[2023-07-21 22:38:21] [config] n-best: false
[2023-07-21 22:38:21] [config] no-nccl: false
[2023-07-21 22:38:21] [config] no-reload: false
[2023-07-21 22:38:21] [config] no-restore-corpus: false
[2023-07-21 22:38:21] [config] normalize: 0
[2023-07-21 22:38:21] [config] normalize-gradient: false
[2023-07-21 22:38:21] [config] num-devices: 0
[2023-07-21 22:38:21] [config] optimizer: adam
[2023-07-21 22:38:21] [config] optimizer-delay: 1
[2023-07-21 22:38:21] [config] optimizer-params:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] output-omit-bias: false
[2023-07-21 22:38:21] [config] overwrite: true
[2023-07-21 22:38:21] [config] precision:
[2023-07-21 22:38:21] [config]   - float16
[2023-07-21 22:38:21] [config]   - float32
[2023-07-21 22:38:21] [config] pretrained-model: ""
[2023-07-21 22:38:21] [config] quantize-biases: false
[2023-07-21 22:38:21] [config] quantize-bits: 0
[2023-07-21 22:38:21] [config] quantize-log-based: false
[2023-07-21 22:38:21] [config] quantize-optimization-steps: 0
[2023-07-21 22:38:21] [config] quiet: false
[2023-07-21 22:38:21] [config] quiet-translation: true
[2023-07-21 22:38:21] [config] relative-paths: false
[2023-07-21 22:38:21] [config] right-left: false
[2023-07-21 22:38:21] [config] save-freq: 10000u
[2023-07-21 22:38:21] [config] seed: 1234
[2023-07-21 22:38:21] [config] sentencepiece-alphas:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] sentencepiece-max-lines: 2000000
[2023-07-21 22:38:21] [config] sentencepiece-options: ""
[2023-07-21 22:38:21] [config] sharding: global
[2023-07-21 22:38:21] [config] shuffle: data
[2023-07-21 22:38:21] [config] shuffle-in-ram: false
[2023-07-21 22:38:21] [config] sigterm: save-and-exit
[2023-07-21 22:38:21] [config] skip: false
[2023-07-21 22:38:21] [config] sqlite: ""
[2023-07-21 22:38:21] [config] sqlite-drop: false
[2023-07-21 22:38:21] [config] sync-freq: 200u
[2023-07-21 22:38:21] [config] sync-sgd: false
[2023-07-21 22:38:21] [config] tempdir: /tmp
[2023-07-21 22:38:21] [config] tied-embeddings: false
[2023-07-21 22:38:21] [config] tied-embeddings-all: true
[2023-07-21 22:38:21] [config] tied-embeddings-src: false
[2023-07-21 22:38:21] [config] train-embedder-rank:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] train-sets:
[2023-07-21 22:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 22:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 22:38:21] [config] transformer-aan-activation: swish
[2023-07-21 22:38:21] [config] transformer-aan-depth: 2
[2023-07-21 22:38:21] [config] transformer-aan-nogate: false
[2023-07-21 22:38:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 22:38:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 22:38:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 22:38:21] [config] transformer-depth-scaling: false
[2023-07-21 22:38:21] [config] transformer-dim-aan: 2048
[2023-07-21 22:38:21] [config] transformer-dim-ffn: 2048
[2023-07-21 22:38:21] [config] transformer-dropout: 0
[2023-07-21 22:38:21] [config] transformer-dropout-attention: 0
[2023-07-21 22:38:21] [config] transformer-dropout-ffn: 0
[2023-07-21 22:38:21] [config] transformer-ffn-activation: swish
[2023-07-21 22:38:21] [config] transformer-ffn-depth: 2
[2023-07-21 22:38:21] [config] transformer-guided-alignment-layer: last
[2023-07-21 22:38:21] [config] transformer-heads: 8
[2023-07-21 22:38:21] [config] transformer-no-projection: false
[2023-07-21 22:38:21] [config] transformer-pool: false
[2023-07-21 22:38:21] [config] transformer-postprocess: dan
[2023-07-21 22:38:21] [config] transformer-postprocess-emb: d
[2023-07-21 22:38:21] [config] transformer-postprocess-top: ""
[2023-07-21 22:38:21] [config] transformer-preprocess: ""
[2023-07-21 22:38:21] [config] transformer-tied-layers:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] transformer-train-position-embeddings: false
[2023-07-21 22:38:21] [config] tsv: false
[2023-07-21 22:38:21] [config] tsv-fields: 0
[2023-07-21 22:38:21] [config] type: amun
[2023-07-21 22:38:21] [config] ulr: false
[2023-07-21 22:38:21] [config] ulr-dim-emb: 0
[2023-07-21 22:38:21] [config] ulr-dropout: 0
[2023-07-21 22:38:21] [config] ulr-keys-vectors: ""
[2023-07-21 22:38:21] [config] ulr-query-vectors: ""
[2023-07-21 22:38:21] [config] ulr-softmax-temperature: 1
[2023-07-21 22:38:21] [config] ulr-trainable-transformation: false
[2023-07-21 22:38:21] [config] unlikelihood-loss: false
[2023-07-21 22:38:21] [config] valid-freq: 50000000
[2023-07-21 22:38:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 22:38:21] [config] valid-max-length: 1000
[2023-07-21 22:38:21] [config] valid-metrics:
[2023-07-21 22:38:21] [config]   - cross-entropy
[2023-07-21 22:38:21] [config]   - translation
[2023-07-21 22:38:21] [config] valid-mini-batch: 32
[2023-07-21 22:38:21] [config] valid-reset-stalled: false
[2023-07-21 22:38:21] [config] valid-script-args:
[2023-07-21 22:38:21] [config]   []
[2023-07-21 22:38:21] [config] valid-script-path: ""
[2023-07-21 22:38:21] [config] valid-sets:
[2023-07-21 22:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 22:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 22:38:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-21 22:38:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:38:21] [config] vocabs:
[2023-07-21 22:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:38:21] [config] word-penalty: 0
[2023-07-21 22:38:21] [config] word-scores: false
[2023-07-21 22:38:21] [config] workspace: 5500
[2023-07-21 22:38:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:38:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:38:21] [training] Using single-device training
[2023-07-21 22:38:22] Synced seed 1234
[2023-07-21 22:38:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:38:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 22:38:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:38:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 22:38:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 22:38:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:38:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 22:38:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 22:38:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 22:38:23] [comm] Using global sharding
[2023-07-21 22:38:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 22:38:23] [training] Using 1 GPUs
[2023-07-21 22:38:23] [logits] Applying loss function for 1 factor(s)
[2023-07-21 22:38:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:38:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 22:38:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:05:03] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 23:05:03] [valid] No post-processing script given for validating translator
[2023-07-21 23:05:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:05:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 23:05:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 23:05:03] [comm] Using global sharding
[2023-07-21 23:05:04] [comm] NCCLCommunicators constructed successfully
[2023-07-21 23:05:04] [training] Using 1 GPUs
[2023-07-21 23:05:04] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 23:05:12] Allocating memory for general optimizer shards
[2023-07-21 23:05:12] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:05:12] Loading Adam parameters
[2023-07-21 23:05:12] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:05:12] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:05:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 23:05:13] [data] Restoring the corpus state to epoch 41, batch 1757
[2023-07-21 23:05:13] [data] Shuffling data
[2023-07-21 23:05:13] [data] Done reading 20,192 sentences
[2023-07-21 23:05:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:05:13] Training started
[2023-07-21 23:05:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 23:05:13] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:05:20] Parameter type float16, optimization type float32, casting types true
[2023-07-21 23:09:23] Seen 20,192 samples
[2023-07-21 23:09:23] Starting data epoch 42 in logical epoch 42
[2023-07-21 23:09:23] [data] Shuffling data
[2023-07-21 23:09:23] [data] Done reading 20,192 sentences
[2023-07-21 23:09:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:13:38] Seen 20,192 samples
[2023-07-21 23:13:38] Starting data epoch 43 in logical epoch 43
[2023-07-21 23:13:38] [data] Shuffling data
[2023-07-21 23:13:38] [data] Done reading 20,192 sentences
[2023-07-21 23:13:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:18:03] Seen 20,192 samples
[2023-07-21 23:18:03] Starting data epoch 44 in logical epoch 44
[2023-07-21 23:18:03] [data] Shuffling data
[2023-07-21 23:18:03] [data] Done reading 20,192 sentences
[2023-07-21 23:18:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:22:39] Seen 20,192 samples
[2023-07-21 23:22:39] Starting data epoch 45 in logical epoch 45
[2023-07-21 23:22:39] [data] Shuffling data
[2023-07-21 23:22:39] [data] Done reading 20,192 sentences
[2023-07-21 23:22:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:26:58] Seen 20,192 samples
[2023-07-21 23:26:58] Starting data epoch 46 in logical epoch 46
[2023-07-21 23:26:58] [data] Shuffling data
[2023-07-21 23:26:58] [data] Done reading 20,192 sentences
[2023-07-21 23:26:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:29:23] Ep. 46 : Up. 2000 : Sen. 10,924 : Cost 5.45963764 * 12,386,298 @ 19,406 after 24,755,185 : Time 1460.07s : 8483.34 words/s : gNorm 1.0551
[2023-07-21 23:31:30] Seen 20,192 samples
[2023-07-21 23:31:30] Starting data epoch 47 in logical epoch 47
[2023-07-21 23:31:30] [data] Shuffling data
[2023-07-21 23:31:30] [data] Done reading 20,192 sentences
[2023-07-21 23:31:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:35:59] Seen 20,192 samples
[2023-07-21 23:35:59] Starting data epoch 48 in logical epoch 48
[2023-07-21 23:35:59] [data] Shuffling data
[2023-07-21 23:35:59] [data] Done reading 20,192 sentences
[2023-07-21 23:35:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:40:21] Seen 20,192 samples
[2023-07-21 23:40:21] Starting data epoch 49 in logical epoch 49
[2023-07-21 23:40:21] [data] Shuffling data
[2023-07-21 23:40:21] [data] Done reading 20,192 sentences
[2023-07-21 23:40:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:45:02] Seen 20,192 samples
[2023-07-21 23:45:02] Starting data epoch 50 in logical epoch 50
[2023-07-21 23:45:02] [data] Shuffling data
[2023-07-21 23:45:02] [data] Done reading 20,192 sentences
[2023-07-21 23:45:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:49:32] Seen 20,192 samples
[2023-07-21 23:49:32] Starting data epoch 51 in logical epoch 51
[2023-07-21 23:49:32] Training finished
[2023-07-21 23:49:42] [valid] Ep. 51 : Up. 2196 : cross-entropy : 139.828 : new best
[2023-07-21 23:53:19] [valid] Ep. 51 : Up. 2196 : translation : 0 : new best
[2023-07-21 23:53:19] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 23:53:22] Saving Adam parameters
[2023-07-21 23:53:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-21 23:53:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 23:53:28] [marian] Running on node22.datos.cluster.uy as process 35112 with command line:
[2023-07-21 23:53:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 23:53:28] [config] after: 0e
[2023-07-21 23:53:28] [config] after-batches: 0
[2023-07-21 23:53:28] [config] after-epochs: 60
[2023-07-21 23:53:28] [config] all-caps-every: 0
[2023-07-21 23:53:28] [config] allow-unk: false
[2023-07-21 23:53:28] [config] authors: false
[2023-07-21 23:53:28] [config] beam-size: 12
[2023-07-21 23:53:28] [config] bert-class-symbol: "[CLS]"
[2023-07-21 23:53:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 23:53:28] [config] bert-masking-fraction: 0.15
[2023-07-21 23:53:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 23:53:28] [config] bert-train-type-embeddings: true
[2023-07-21 23:53:28] [config] bert-type-vocab-size: 2
[2023-07-21 23:53:28] [config] build-info: ""
[2023-07-21 23:53:28] [config] check-gradient-nan: false
[2023-07-21 23:53:28] [config] check-nan: false
[2023-07-21 23:53:28] [config] cite: false
[2023-07-21 23:53:28] [config] clip-norm: 1
[2023-07-21 23:53:28] [config] cost-scaling:
[2023-07-21 23:53:28] [config]   - 256.f
[2023-07-21 23:53:28] [config]   - 1000
[2023-07-21 23:53:28] [config]   - 2.f
[2023-07-21 23:53:28] [config]   - 256.f
[2023-07-21 23:53:28] [config] cost-type: ce-sum
[2023-07-21 23:53:28] [config] cpu-threads: 0
[2023-07-21 23:53:28] [config] data-threads: 8
[2023-07-21 23:53:28] [config] data-weighting: ""
[2023-07-21 23:53:28] [config] data-weighting-type: sentence
[2023-07-21 23:53:28] [config] dec-cell: gru
[2023-07-21 23:53:28] [config] dec-cell-base-depth: 2
[2023-07-21 23:53:28] [config] dec-cell-high-depth: 1
[2023-07-21 23:53:28] [config] dec-depth: 1
[2023-07-21 23:53:28] [config] devices:
[2023-07-21 23:53:28] [config]   - 0
[2023-07-21 23:53:28] [config] dim-emb: 512
[2023-07-21 23:53:28] [config] dim-rnn: 1024
[2023-07-21 23:53:28] [config] dim-vocabs:
[2023-07-21 23:53:28] [config]   - 16384
[2023-07-21 23:53:28] [config]   - 16384
[2023-07-21 23:53:28] [config] disp-first: 0
[2023-07-21 23:53:28] [config] disp-freq: 1000u
[2023-07-21 23:53:28] [config] disp-label-counts: true
[2023-07-21 23:53:28] [config] dropout-rnn: 0
[2023-07-21 23:53:28] [config] dropout-src: 0
[2023-07-21 23:53:28] [config] dropout-trg: 0
[2023-07-21 23:53:28] [config] dump-config: ""
[2023-07-21 23:53:28] [config] dynamic-gradient-scaling:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] early-stopping: 200
[2023-07-21 23:53:28] [config] early-stopping-on: first
[2023-07-21 23:53:28] [config] embedding-fix-src: false
[2023-07-21 23:53:28] [config] embedding-fix-trg: false
[2023-07-21 23:53:28] [config] embedding-normalization: false
[2023-07-21 23:53:28] [config] embedding-vectors:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] enc-cell: gru
[2023-07-21 23:53:28] [config] enc-cell-depth: 1
[2023-07-21 23:53:28] [config] enc-depth: 1
[2023-07-21 23:53:28] [config] enc-type: bidirectional
[2023-07-21 23:53:28] [config] english-title-case-every: 0
[2023-07-21 23:53:28] [config] exponential-smoothing: 0
[2023-07-21 23:53:28] [config] factor-weight: 1
[2023-07-21 23:53:28] [config] factors-combine: sum
[2023-07-21 23:53:28] [config] factors-dim-emb: 0
[2023-07-21 23:53:28] [config] gradient-checkpointing: false
[2023-07-21 23:53:28] [config] gradient-norm-average-window: 100
[2023-07-21 23:53:28] [config] guided-alignment: none
[2023-07-21 23:53:28] [config] guided-alignment-cost: mse
[2023-07-21 23:53:28] [config] guided-alignment-weight: 0.1
[2023-07-21 23:53:28] [config] ignore-model-config: false
[2023-07-21 23:53:28] [config] input-types:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] interpolate-env-vars: false
[2023-07-21 23:53:28] [config] keep-best: false
[2023-07-21 23:53:28] [config] label-smoothing: 0
[2023-07-21 23:53:28] [config] layer-normalization: false
[2023-07-21 23:53:28] [config] learn-rate: 0.0001
[2023-07-21 23:53:28] [config] lemma-dependency: ""
[2023-07-21 23:53:28] [config] lemma-dim-emb: 0
[2023-07-21 23:53:28] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 23:53:28] [config] log-level: info
[2023-07-21 23:53:28] [config] log-time-zone: ""
[2023-07-21 23:53:28] [config] logical-epoch:
[2023-07-21 23:53:28] [config]   - 1e
[2023-07-21 23:53:28] [config]   - 0
[2023-07-21 23:53:28] [config] lr-decay: 0
[2023-07-21 23:53:28] [config] lr-decay-freq: 50000
[2023-07-21 23:53:28] [config] lr-decay-inv-sqrt:
[2023-07-21 23:53:28] [config]   - 0
[2023-07-21 23:53:28] [config] lr-decay-repeat-warmup: false
[2023-07-21 23:53:28] [config] lr-decay-reset-optimizer: false
[2023-07-21 23:53:28] [config] lr-decay-start:
[2023-07-21 23:53:28] [config]   - 10
[2023-07-21 23:53:28] [config]   - 1
[2023-07-21 23:53:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 23:53:28] [config] lr-report: false
[2023-07-21 23:53:28] [config] lr-warmup: 0
[2023-07-21 23:53:28] [config] lr-warmup-at-reload: false
[2023-07-21 23:53:28] [config] lr-warmup-cycle: false
[2023-07-21 23:53:28] [config] lr-warmup-start-rate: 0
[2023-07-21 23:53:28] [config] max-length: 150
[2023-07-21 23:53:28] [config] max-length-crop: true
[2023-07-21 23:53:28] [config] max-length-factor: 3
[2023-07-21 23:53:28] [config] maxi-batch: 100
[2023-07-21 23:53:28] [config] maxi-batch-sort: trg
[2023-07-21 23:53:28] [config] mini-batch: 64
[2023-07-21 23:53:28] [config] mini-batch-fit: true
[2023-07-21 23:53:28] [config] mini-batch-fit-step: 10
[2023-07-21 23:53:28] [config] mini-batch-round-up: true
[2023-07-21 23:53:28] [config] mini-batch-track-lr: false
[2023-07-21 23:53:28] [config] mini-batch-warmup: 0
[2023-07-21 23:53:28] [config] mini-batch-words: 0
[2023-07-21 23:53:28] [config] mini-batch-words-ref: 0
[2023-07-21 23:53:28] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-21 23:53:28] [config] multi-loss-type: sum
[2023-07-21 23:53:28] [config] n-best: false
[2023-07-21 23:53:28] [config] no-nccl: false
[2023-07-21 23:53:28] [config] no-reload: false
[2023-07-21 23:53:28] [config] no-restore-corpus: false
[2023-07-21 23:53:28] [config] normalize: 0
[2023-07-21 23:53:28] [config] normalize-gradient: false
[2023-07-21 23:53:28] [config] num-devices: 0
[2023-07-21 23:53:28] [config] optimizer: adam
[2023-07-21 23:53:28] [config] optimizer-delay: 1
[2023-07-21 23:53:28] [config] optimizer-params:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] output-omit-bias: false
[2023-07-21 23:53:28] [config] overwrite: true
[2023-07-21 23:53:28] [config] precision:
[2023-07-21 23:53:28] [config]   - float16
[2023-07-21 23:53:28] [config]   - float32
[2023-07-21 23:53:28] [config] pretrained-model: ""
[2023-07-21 23:53:28] [config] quantize-biases: false
[2023-07-21 23:53:28] [config] quantize-bits: 0
[2023-07-21 23:53:28] [config] quantize-log-based: false
[2023-07-21 23:53:28] [config] quantize-optimization-steps: 0
[2023-07-21 23:53:28] [config] quiet: false
[2023-07-21 23:53:28] [config] quiet-translation: true
[2023-07-21 23:53:28] [config] relative-paths: false
[2023-07-21 23:53:28] [config] right-left: false
[2023-07-21 23:53:28] [config] save-freq: 10000u
[2023-07-21 23:53:28] [config] seed: 1234
[2023-07-21 23:53:28] [config] sentencepiece-alphas:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] sentencepiece-max-lines: 2000000
[2023-07-21 23:53:28] [config] sentencepiece-options: ""
[2023-07-21 23:53:28] [config] sharding: global
[2023-07-21 23:53:28] [config] shuffle: data
[2023-07-21 23:53:28] [config] shuffle-in-ram: false
[2023-07-21 23:53:28] [config] sigterm: save-and-exit
[2023-07-21 23:53:28] [config] skip: false
[2023-07-21 23:53:28] [config] sqlite: ""
[2023-07-21 23:53:28] [config] sqlite-drop: false
[2023-07-21 23:53:28] [config] sync-freq: 200u
[2023-07-21 23:53:28] [config] sync-sgd: false
[2023-07-21 23:53:28] [config] tempdir: /tmp
[2023-07-21 23:53:28] [config] tied-embeddings: false
[2023-07-21 23:53:28] [config] tied-embeddings-all: true
[2023-07-21 23:53:28] [config] tied-embeddings-src: false
[2023-07-21 23:53:28] [config] train-embedder-rank:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] train-sets:
[2023-07-21 23:53:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 23:53:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 23:53:28] [config] transformer-aan-activation: swish
[2023-07-21 23:53:28] [config] transformer-aan-depth: 2
[2023-07-21 23:53:28] [config] transformer-aan-nogate: false
[2023-07-21 23:53:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 23:53:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 23:53:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 23:53:28] [config] transformer-depth-scaling: false
[2023-07-21 23:53:28] [config] transformer-dim-aan: 2048
[2023-07-21 23:53:28] [config] transformer-dim-ffn: 2048
[2023-07-21 23:53:28] [config] transformer-dropout: 0
[2023-07-21 23:53:28] [config] transformer-dropout-attention: 0
[2023-07-21 23:53:28] [config] transformer-dropout-ffn: 0
[2023-07-21 23:53:28] [config] transformer-ffn-activation: swish
[2023-07-21 23:53:28] [config] transformer-ffn-depth: 2
[2023-07-21 23:53:28] [config] transformer-guided-alignment-layer: last
[2023-07-21 23:53:28] [config] transformer-heads: 8
[2023-07-21 23:53:28] [config] transformer-no-projection: false
[2023-07-21 23:53:28] [config] transformer-pool: false
[2023-07-21 23:53:28] [config] transformer-postprocess: dan
[2023-07-21 23:53:28] [config] transformer-postprocess-emb: d
[2023-07-21 23:53:28] [config] transformer-postprocess-top: ""
[2023-07-21 23:53:28] [config] transformer-preprocess: ""
[2023-07-21 23:53:28] [config] transformer-tied-layers:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] transformer-train-position-embeddings: false
[2023-07-21 23:53:28] [config] tsv: false
[2023-07-21 23:53:28] [config] tsv-fields: 0
[2023-07-21 23:53:28] [config] type: amun
[2023-07-21 23:53:28] [config] ulr: false
[2023-07-21 23:53:28] [config] ulr-dim-emb: 0
[2023-07-21 23:53:28] [config] ulr-dropout: 0
[2023-07-21 23:53:28] [config] ulr-keys-vectors: ""
[2023-07-21 23:53:28] [config] ulr-query-vectors: ""
[2023-07-21 23:53:28] [config] ulr-softmax-temperature: 1
[2023-07-21 23:53:28] [config] ulr-trainable-transformation: false
[2023-07-21 23:53:28] [config] unlikelihood-loss: false
[2023-07-21 23:53:28] [config] valid-freq: 50000000
[2023-07-21 23:53:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-21 23:53:28] [config] valid-max-length: 1000
[2023-07-21 23:53:28] [config] valid-metrics:
[2023-07-21 23:53:28] [config]   - cross-entropy
[2023-07-21 23:53:28] [config]   - translation
[2023-07-21 23:53:28] [config] valid-mini-batch: 32
[2023-07-21 23:53:28] [config] valid-reset-stalled: false
[2023-07-21 23:53:28] [config] valid-script-args:
[2023-07-21 23:53:28] [config]   []
[2023-07-21 23:53:28] [config] valid-script-path: ""
[2023-07-21 23:53:28] [config] valid-sets:
[2023-07-21 23:53:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 23:53:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 23:53:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-21 23:53:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 23:53:28] [config] vocabs:
[2023-07-21 23:53:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 23:53:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 23:53:28] [config] word-penalty: 0
[2023-07-21 23:53:28] [config] word-scores: false
[2023-07-21 23:53:28] [config] workspace: 5500
[2023-07-21 23:53:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 23:53:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:53:28] [training] Using single-device training
[2023-07-21 23:53:29] Synced seed 1234
[2023-07-21 23:53:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 23:53:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 23:53:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 23:53:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 23:53:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 23:53:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:53:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 23:53:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 23:53:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 23:53:30] [comm] Using global sharding
[2023-07-21 23:53:30] [comm] NCCLCommunicators constructed successfully
[2023-07-21 23:53:30] [training] Using 1 GPUs
[2023-07-21 23:53:30] [logits] Applying loss function for 1 factor(s)
[2023-07-21 23:53:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:53:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 23:53:30] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:19:02] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 00:19:02] [valid] No post-processing script given for validating translator
[2023-07-22 00:19:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:19:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 00:19:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 00:19:02] [comm] Using global sharding
[2023-07-22 00:19:02] [comm] NCCLCommunicators constructed successfully
[2023-07-22 00:19:02] [training] Using 1 GPUs
[2023-07-22 00:19:03] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 00:19:09] Allocating memory for general optimizer shards
[2023-07-22 00:19:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 00:19:09] Loading Adam parameters
[2023-07-22 00:19:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 00:19:09] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:19:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 00:19:09] [data] Restoring the corpus state to epoch 51, batch 2196
[2023-07-22 00:19:09] [data] Shuffling data
[2023-07-22 00:19:09] [data] Done reading 20,192 sentences
[2023-07-22 00:19:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:19:09] Training started
[2023-07-22 00:19:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 00:19:09] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:19:10] Parameter type float16, optimization type float32, casting types true
[2023-07-22 00:23:31] Seen 20,192 samples
[2023-07-22 00:23:31] Starting data epoch 52 in logical epoch 52
[2023-07-22 00:23:31] [data] Shuffling data
[2023-07-22 00:23:31] [data] Done reading 20,192 sentences
[2023-07-22 00:23:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:27:28] Seen 20,192 samples
[2023-07-22 00:27:28] Starting data epoch 53 in logical epoch 53
[2023-07-22 00:27:28] [data] Shuffling data
[2023-07-22 00:27:28] [data] Done reading 20,192 sentences
[2023-07-22 00:27:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:31:43] Seen 20,192 samples
[2023-07-22 00:31:43] Starting data epoch 54 in logical epoch 54
[2023-07-22 00:31:43] [data] Shuffling data
[2023-07-22 00:31:43] [data] Done reading 20,192 sentences
[2023-07-22 00:31:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:36:09] Seen 20,192 samples
[2023-07-22 00:36:09] Starting data epoch 55 in logical epoch 55
[2023-07-22 00:36:09] [data] Shuffling data
[2023-07-22 00:36:09] [data] Done reading 20,192 sentences
[2023-07-22 00:36:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:40:37] Seen 20,192 samples
[2023-07-22 00:40:37] Starting data epoch 56 in logical epoch 56
[2023-07-22 00:40:37] [data] Shuffling data
[2023-07-22 00:40:37] [data] Done reading 20,192 sentences
[2023-07-22 00:40:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:44:57] Seen 20,192 samples
[2023-07-22 00:44:57] Starting data epoch 57 in logical epoch 57
[2023-07-22 00:44:57] [data] Shuffling data
[2023-07-22 00:44:57] [data] Done reading 20,192 sentences
[2023-07-22 00:44:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:49:19] Seen 20,192 samples
[2023-07-22 00:49:19] Starting data epoch 58 in logical epoch 58
[2023-07-22 00:49:19] [data] Shuffling data
[2023-07-22 00:49:19] [data] Done reading 20,192 sentences
[2023-07-22 00:49:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:53:46] Seen 20,192 samples
[2023-07-22 00:53:46] Starting data epoch 59 in logical epoch 59
[2023-07-22 00:53:46] [data] Shuffling data
[2023-07-22 00:53:46] [data] Done reading 20,192 sentences
[2023-07-22 00:53:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:58:08] Seen 20,192 samples
[2023-07-22 00:58:08] Starting data epoch 60 in logical epoch 60
[2023-07-22 00:58:08] [data] Shuffling data
[2023-07-22 00:58:08] [data] Done reading 20,192 sentences
[2023-07-22 00:58:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:02:36] Seen 20,192 samples
[2023-07-22 01:02:36] Starting data epoch 61 in logical epoch 61
[2023-07-22 01:02:36] Training finished
[2023-07-22 01:02:47] [valid] Ep. 61 : Up. 2630 : cross-entropy : 136.72 : new best
[2023-07-22 01:06:51] [valid] Ep. 61 : Up. 2630 : translation : 0 : new best
[2023-07-22 01:06:51] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 01:06:53] Saving Adam parameters
[2023-07-22 01:06:54] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 01:07:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 01:07:00] [marian] Running on node22.datos.cluster.uy as process 40041 with command line:
[2023-07-22 01:07:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 01:07:00] [config] after: 0e
[2023-07-22 01:07:00] [config] after-batches: 0
[2023-07-22 01:07:00] [config] after-epochs: 70
[2023-07-22 01:07:00] [config] all-caps-every: 0
[2023-07-22 01:07:00] [config] allow-unk: false
[2023-07-22 01:07:00] [config] authors: false
[2023-07-22 01:07:00] [config] beam-size: 12
[2023-07-22 01:07:00] [config] bert-class-symbol: "[CLS]"
[2023-07-22 01:07:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 01:07:00] [config] bert-masking-fraction: 0.15
[2023-07-22 01:07:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 01:07:00] [config] bert-train-type-embeddings: true
[2023-07-22 01:07:00] [config] bert-type-vocab-size: 2
[2023-07-22 01:07:00] [config] build-info: ""
[2023-07-22 01:07:00] [config] check-gradient-nan: false
[2023-07-22 01:07:00] [config] check-nan: false
[2023-07-22 01:07:00] [config] cite: false
[2023-07-22 01:07:00] [config] clip-norm: 1
[2023-07-22 01:07:00] [config] cost-scaling:
[2023-07-22 01:07:00] [config]   - 256.f
[2023-07-22 01:07:00] [config]   - 1000
[2023-07-22 01:07:00] [config]   - 2.f
[2023-07-22 01:07:00] [config]   - 256.f
[2023-07-22 01:07:00] [config] cost-type: ce-sum
[2023-07-22 01:07:00] [config] cpu-threads: 0
[2023-07-22 01:07:00] [config] data-threads: 8
[2023-07-22 01:07:00] [config] data-weighting: ""
[2023-07-22 01:07:00] [config] data-weighting-type: sentence
[2023-07-22 01:07:00] [config] dec-cell: gru
[2023-07-22 01:07:00] [config] dec-cell-base-depth: 2
[2023-07-22 01:07:00] [config] dec-cell-high-depth: 1
[2023-07-22 01:07:00] [config] dec-depth: 1
[2023-07-22 01:07:00] [config] devices:
[2023-07-22 01:07:00] [config]   - 0
[2023-07-22 01:07:00] [config] dim-emb: 512
[2023-07-22 01:07:00] [config] dim-rnn: 1024
[2023-07-22 01:07:00] [config] dim-vocabs:
[2023-07-22 01:07:00] [config]   - 16384
[2023-07-22 01:07:00] [config]   - 16384
[2023-07-22 01:07:00] [config] disp-first: 0
[2023-07-22 01:07:00] [config] disp-freq: 1000u
[2023-07-22 01:07:00] [config] disp-label-counts: true
[2023-07-22 01:07:00] [config] dropout-rnn: 0
[2023-07-22 01:07:00] [config] dropout-src: 0
[2023-07-22 01:07:00] [config] dropout-trg: 0
[2023-07-22 01:07:00] [config] dump-config: ""
[2023-07-22 01:07:00] [config] dynamic-gradient-scaling:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] early-stopping: 200
[2023-07-22 01:07:00] [config] early-stopping-on: first
[2023-07-22 01:07:00] [config] embedding-fix-src: false
[2023-07-22 01:07:00] [config] embedding-fix-trg: false
[2023-07-22 01:07:00] [config] embedding-normalization: false
[2023-07-22 01:07:00] [config] embedding-vectors:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] enc-cell: gru
[2023-07-22 01:07:00] [config] enc-cell-depth: 1
[2023-07-22 01:07:00] [config] enc-depth: 1
[2023-07-22 01:07:00] [config] enc-type: bidirectional
[2023-07-22 01:07:00] [config] english-title-case-every: 0
[2023-07-22 01:07:00] [config] exponential-smoothing: 0
[2023-07-22 01:07:00] [config] factor-weight: 1
[2023-07-22 01:07:00] [config] factors-combine: sum
[2023-07-22 01:07:00] [config] factors-dim-emb: 0
[2023-07-22 01:07:00] [config] gradient-checkpointing: false
[2023-07-22 01:07:00] [config] gradient-norm-average-window: 100
[2023-07-22 01:07:00] [config] guided-alignment: none
[2023-07-22 01:07:00] [config] guided-alignment-cost: mse
[2023-07-22 01:07:00] [config] guided-alignment-weight: 0.1
[2023-07-22 01:07:00] [config] ignore-model-config: false
[2023-07-22 01:07:00] [config] input-types:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] interpolate-env-vars: false
[2023-07-22 01:07:00] [config] keep-best: false
[2023-07-22 01:07:00] [config] label-smoothing: 0
[2023-07-22 01:07:00] [config] layer-normalization: false
[2023-07-22 01:07:00] [config] learn-rate: 0.0001
[2023-07-22 01:07:00] [config] lemma-dependency: ""
[2023-07-22 01:07:00] [config] lemma-dim-emb: 0
[2023-07-22 01:07:00] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 01:07:00] [config] log-level: info
[2023-07-22 01:07:00] [config] log-time-zone: ""
[2023-07-22 01:07:00] [config] logical-epoch:
[2023-07-22 01:07:00] [config]   - 1e
[2023-07-22 01:07:00] [config]   - 0
[2023-07-22 01:07:00] [config] lr-decay: 0
[2023-07-22 01:07:00] [config] lr-decay-freq: 50000
[2023-07-22 01:07:00] [config] lr-decay-inv-sqrt:
[2023-07-22 01:07:00] [config]   - 0
[2023-07-22 01:07:00] [config] lr-decay-repeat-warmup: false
[2023-07-22 01:07:00] [config] lr-decay-reset-optimizer: false
[2023-07-22 01:07:00] [config] lr-decay-start:
[2023-07-22 01:07:00] [config]   - 10
[2023-07-22 01:07:00] [config]   - 1
[2023-07-22 01:07:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 01:07:00] [config] lr-report: false
[2023-07-22 01:07:00] [config] lr-warmup: 0
[2023-07-22 01:07:00] [config] lr-warmup-at-reload: false
[2023-07-22 01:07:00] [config] lr-warmup-cycle: false
[2023-07-22 01:07:00] [config] lr-warmup-start-rate: 0
[2023-07-22 01:07:00] [config] max-length: 150
[2023-07-22 01:07:00] [config] max-length-crop: true
[2023-07-22 01:07:00] [config] max-length-factor: 3
[2023-07-22 01:07:00] [config] maxi-batch: 100
[2023-07-22 01:07:00] [config] maxi-batch-sort: trg
[2023-07-22 01:07:00] [config] mini-batch: 64
[2023-07-22 01:07:00] [config] mini-batch-fit: true
[2023-07-22 01:07:00] [config] mini-batch-fit-step: 10
[2023-07-22 01:07:00] [config] mini-batch-round-up: true
[2023-07-22 01:07:00] [config] mini-batch-track-lr: false
[2023-07-22 01:07:00] [config] mini-batch-warmup: 0
[2023-07-22 01:07:00] [config] mini-batch-words: 0
[2023-07-22 01:07:00] [config] mini-batch-words-ref: 0
[2023-07-22 01:07:00] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 01:07:00] [config] multi-loss-type: sum
[2023-07-22 01:07:00] [config] n-best: false
[2023-07-22 01:07:00] [config] no-nccl: false
[2023-07-22 01:07:00] [config] no-reload: false
[2023-07-22 01:07:00] [config] no-restore-corpus: false
[2023-07-22 01:07:00] [config] normalize: 0
[2023-07-22 01:07:00] [config] normalize-gradient: false
[2023-07-22 01:07:00] [config] num-devices: 0
[2023-07-22 01:07:00] [config] optimizer: adam
[2023-07-22 01:07:00] [config] optimizer-delay: 1
[2023-07-22 01:07:00] [config] optimizer-params:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] output-omit-bias: false
[2023-07-22 01:07:00] [config] overwrite: true
[2023-07-22 01:07:00] [config] precision:
[2023-07-22 01:07:00] [config]   - float16
[2023-07-22 01:07:00] [config]   - float32
[2023-07-22 01:07:00] [config] pretrained-model: ""
[2023-07-22 01:07:00] [config] quantize-biases: false
[2023-07-22 01:07:00] [config] quantize-bits: 0
[2023-07-22 01:07:00] [config] quantize-log-based: false
[2023-07-22 01:07:00] [config] quantize-optimization-steps: 0
[2023-07-22 01:07:00] [config] quiet: false
[2023-07-22 01:07:00] [config] quiet-translation: true
[2023-07-22 01:07:00] [config] relative-paths: false
[2023-07-22 01:07:00] [config] right-left: false
[2023-07-22 01:07:00] [config] save-freq: 10000u
[2023-07-22 01:07:00] [config] seed: 1234
[2023-07-22 01:07:00] [config] sentencepiece-alphas:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] sentencepiece-max-lines: 2000000
[2023-07-22 01:07:00] [config] sentencepiece-options: ""
[2023-07-22 01:07:00] [config] sharding: global
[2023-07-22 01:07:00] [config] shuffle: data
[2023-07-22 01:07:00] [config] shuffle-in-ram: false
[2023-07-22 01:07:00] [config] sigterm: save-and-exit
[2023-07-22 01:07:00] [config] skip: false
[2023-07-22 01:07:00] [config] sqlite: ""
[2023-07-22 01:07:00] [config] sqlite-drop: false
[2023-07-22 01:07:00] [config] sync-freq: 200u
[2023-07-22 01:07:00] [config] sync-sgd: false
[2023-07-22 01:07:00] [config] tempdir: /tmp
[2023-07-22 01:07:00] [config] tied-embeddings: false
[2023-07-22 01:07:00] [config] tied-embeddings-all: true
[2023-07-22 01:07:00] [config] tied-embeddings-src: false
[2023-07-22 01:07:00] [config] train-embedder-rank:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] train-sets:
[2023-07-22 01:07:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 01:07:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 01:07:00] [config] transformer-aan-activation: swish
[2023-07-22 01:07:00] [config] transformer-aan-depth: 2
[2023-07-22 01:07:00] [config] transformer-aan-nogate: false
[2023-07-22 01:07:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 01:07:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 01:07:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 01:07:00] [config] transformer-depth-scaling: false
[2023-07-22 01:07:00] [config] transformer-dim-aan: 2048
[2023-07-22 01:07:00] [config] transformer-dim-ffn: 2048
[2023-07-22 01:07:00] [config] transformer-dropout: 0
[2023-07-22 01:07:00] [config] transformer-dropout-attention: 0
[2023-07-22 01:07:00] [config] transformer-dropout-ffn: 0
[2023-07-22 01:07:00] [config] transformer-ffn-activation: swish
[2023-07-22 01:07:00] [config] transformer-ffn-depth: 2
[2023-07-22 01:07:00] [config] transformer-guided-alignment-layer: last
[2023-07-22 01:07:00] [config] transformer-heads: 8
[2023-07-22 01:07:00] [config] transformer-no-projection: false
[2023-07-22 01:07:00] [config] transformer-pool: false
[2023-07-22 01:07:00] [config] transformer-postprocess: dan
[2023-07-22 01:07:00] [config] transformer-postprocess-emb: d
[2023-07-22 01:07:00] [config] transformer-postprocess-top: ""
[2023-07-22 01:07:00] [config] transformer-preprocess: ""
[2023-07-22 01:07:00] [config] transformer-tied-layers:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] transformer-train-position-embeddings: false
[2023-07-22 01:07:00] [config] tsv: false
[2023-07-22 01:07:00] [config] tsv-fields: 0
[2023-07-22 01:07:00] [config] type: amun
[2023-07-22 01:07:00] [config] ulr: false
[2023-07-22 01:07:00] [config] ulr-dim-emb: 0
[2023-07-22 01:07:00] [config] ulr-dropout: 0
[2023-07-22 01:07:00] [config] ulr-keys-vectors: ""
[2023-07-22 01:07:00] [config] ulr-query-vectors: ""
[2023-07-22 01:07:00] [config] ulr-softmax-temperature: 1
[2023-07-22 01:07:00] [config] ulr-trainable-transformation: false
[2023-07-22 01:07:00] [config] unlikelihood-loss: false
[2023-07-22 01:07:00] [config] valid-freq: 50000000
[2023-07-22 01:07:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 01:07:00] [config] valid-max-length: 1000
[2023-07-22 01:07:00] [config] valid-metrics:
[2023-07-22 01:07:00] [config]   - cross-entropy
[2023-07-22 01:07:00] [config]   - translation
[2023-07-22 01:07:00] [config] valid-mini-batch: 32
[2023-07-22 01:07:00] [config] valid-reset-stalled: false
[2023-07-22 01:07:00] [config] valid-script-args:
[2023-07-22 01:07:00] [config]   []
[2023-07-22 01:07:00] [config] valid-script-path: ""
[2023-07-22 01:07:00] [config] valid-sets:
[2023-07-22 01:07:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 01:07:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 01:07:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 01:07:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 01:07:00] [config] vocabs:
[2023-07-22 01:07:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 01:07:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 01:07:00] [config] word-penalty: 0
[2023-07-22 01:07:00] [config] word-scores: false
[2023-07-22 01:07:00] [config] workspace: 5500
[2023-07-22 01:07:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 01:07:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:07:00] [training] Using single-device training
[2023-07-22 01:07:01] Synced seed 1234
[2023-07-22 01:07:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 01:07:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 01:07:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 01:07:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 01:07:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 01:07:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:07:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 01:07:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 01:07:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 01:07:02] [comm] Using global sharding
[2023-07-22 01:07:02] [comm] NCCLCommunicators constructed successfully
[2023-07-22 01:07:02] [training] Using 1 GPUs
[2023-07-22 01:07:02] [logits] Applying loss function for 1 factor(s)
[2023-07-22 01:07:02] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:07:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 01:07:02] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:33:53] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 01:33:53] [valid] No post-processing script given for validating translator
[2023-07-22 01:33:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:33:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 01:33:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 01:33:53] [comm] Using global sharding
[2023-07-22 01:33:53] [comm] NCCLCommunicators constructed successfully
[2023-07-22 01:33:53] [training] Using 1 GPUs
[2023-07-22 01:33:53] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 01:34:03] Allocating memory for general optimizer shards
[2023-07-22 01:34:03] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:34:03] Loading Adam parameters
[2023-07-22 01:34:03] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:34:04] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 01:34:04] [data] Restoring the corpus state to epoch 61, batch 2630
[2023-07-22 01:34:04] [data] Shuffling data
[2023-07-22 01:34:04] [data] Done reading 20,192 sentences
[2023-07-22 01:34:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:34:04] Training started
[2023-07-22 01:34:04] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 01:34:04] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:12] Parameter type float16, optimization type float32, casting types true
[2023-07-22 01:38:23] Seen 20,192 samples
[2023-07-22 01:38:23] Starting data epoch 62 in logical epoch 62
[2023-07-22 01:38:23] [data] Shuffling data
[2023-07-22 01:38:23] [data] Done reading 20,192 sentences
[2023-07-22 01:38:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:42:42] Seen 20,192 samples
[2023-07-22 01:42:42] Starting data epoch 63 in logical epoch 63
[2023-07-22 01:42:42] [data] Shuffling data
[2023-07-22 01:42:42] [data] Done reading 20,192 sentences
[2023-07-22 01:42:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:46:58] Seen 20,192 samples
[2023-07-22 01:46:58] Starting data epoch 64 in logical epoch 64
[2023-07-22 01:46:58] [data] Shuffling data
[2023-07-22 01:46:58] [data] Done reading 20,192 sentences
[2023-07-22 01:46:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:51:34] Seen 20,192 samples
[2023-07-22 01:51:34] Starting data epoch 65 in logical epoch 65
[2023-07-22 01:51:34] [data] Shuffling data
[2023-07-22 01:51:34] [data] Done reading 20,192 sentences
[2023-07-22 01:51:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:55:58] Seen 20,192 samples
[2023-07-22 01:55:58] Starting data epoch 66 in logical epoch 66
[2023-07-22 01:55:58] [data] Shuffling data
[2023-07-22 01:55:58] [data] Done reading 20,192 sentences
[2023-07-22 01:55:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:00:21] Seen 20,192 samples
[2023-07-22 02:00:21] Starting data epoch 67 in logical epoch 67
[2023-07-22 02:00:21] [data] Shuffling data
[2023-07-22 02:00:21] [data] Done reading 20,192 sentences
[2023-07-22 02:00:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:04:48] Seen 20,192 samples
[2023-07-22 02:04:48] Starting data epoch 68 in logical epoch 68
[2023-07-22 02:04:48] [data] Shuffling data
[2023-07-22 02:04:48] [data] Done reading 20,192 sentences
[2023-07-22 02:04:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:09:30] Seen 20,192 samples
[2023-07-22 02:09:30] Starting data epoch 69 in logical epoch 69
[2023-07-22 02:09:30] [data] Shuffling data
[2023-07-22 02:09:30] [data] Done reading 20,192 sentences
[2023-07-22 02:09:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:11:26] Ep. 69 : Up. 3000 : Sen. 9,615 : Cost 4.80665255 * 12,475,760 @ 20,625 after 37,230,945 : Time 2253.29s : 5536.69 words/s : gNorm 1.0253
[2023-07-22 02:14:10] Seen 20,192 samples
[2023-07-22 02:14:10] Starting data epoch 70 in logical epoch 70
[2023-07-22 02:14:10] [data] Shuffling data
[2023-07-22 02:14:10] [data] Done reading 20,192 sentences
[2023-07-22 02:14:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:18:53] Seen 20,192 samples
[2023-07-22 02:18:53] Starting data epoch 71 in logical epoch 71
[2023-07-22 02:18:53] Training finished
[2023-07-22 02:19:04] [valid] Ep. 71 : Up. 3067 : cross-entropy : 134.275 : new best
[2023-07-22 02:22:17] [valid] Ep. 71 : Up. 3067 : translation : 0 : new best
[2023-07-22 02:22:17] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 02:22:20] Saving Adam parameters
[2023-07-22 02:22:21] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 02:22:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:22:27] [marian] Running on node22.datos.cluster.uy as process 4208 with command line:
[2023-07-22 02:22:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 02:22:27] [config] after: 0e
[2023-07-22 02:22:27] [config] after-batches: 0
[2023-07-22 02:22:27] [config] after-epochs: 80
[2023-07-22 02:22:27] [config] all-caps-every: 0
[2023-07-22 02:22:27] [config] allow-unk: false
[2023-07-22 02:22:27] [config] authors: false
[2023-07-22 02:22:27] [config] beam-size: 12
[2023-07-22 02:22:27] [config] bert-class-symbol: "[CLS]"
[2023-07-22 02:22:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 02:22:27] [config] bert-masking-fraction: 0.15
[2023-07-22 02:22:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 02:22:27] [config] bert-train-type-embeddings: true
[2023-07-22 02:22:27] [config] bert-type-vocab-size: 2
[2023-07-22 02:22:27] [config] build-info: ""
[2023-07-22 02:22:27] [config] check-gradient-nan: false
[2023-07-22 02:22:27] [config] check-nan: false
[2023-07-22 02:22:27] [config] cite: false
[2023-07-22 02:22:27] [config] clip-norm: 1
[2023-07-22 02:22:27] [config] cost-scaling:
[2023-07-22 02:22:27] [config]   - 256.f
[2023-07-22 02:22:27] [config]   - 1000
[2023-07-22 02:22:27] [config]   - 2.f
[2023-07-22 02:22:27] [config]   - 256.f
[2023-07-22 02:22:27] [config] cost-type: ce-sum
[2023-07-22 02:22:27] [config] cpu-threads: 0
[2023-07-22 02:22:27] [config] data-threads: 8
[2023-07-22 02:22:27] [config] data-weighting: ""
[2023-07-22 02:22:27] [config] data-weighting-type: sentence
[2023-07-22 02:22:27] [config] dec-cell: gru
[2023-07-22 02:22:27] [config] dec-cell-base-depth: 2
[2023-07-22 02:22:27] [config] dec-cell-high-depth: 1
[2023-07-22 02:22:27] [config] dec-depth: 1
[2023-07-22 02:22:27] [config] devices:
[2023-07-22 02:22:27] [config]   - 0
[2023-07-22 02:22:27] [config] dim-emb: 512
[2023-07-22 02:22:27] [config] dim-rnn: 1024
[2023-07-22 02:22:27] [config] dim-vocabs:
[2023-07-22 02:22:27] [config]   - 16384
[2023-07-22 02:22:27] [config]   - 16384
[2023-07-22 02:22:27] [config] disp-first: 0
[2023-07-22 02:22:27] [config] disp-freq: 1000u
[2023-07-22 02:22:27] [config] disp-label-counts: true
[2023-07-22 02:22:27] [config] dropout-rnn: 0
[2023-07-22 02:22:27] [config] dropout-src: 0
[2023-07-22 02:22:27] [config] dropout-trg: 0
[2023-07-22 02:22:27] [config] dump-config: ""
[2023-07-22 02:22:27] [config] dynamic-gradient-scaling:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] early-stopping: 200
[2023-07-22 02:22:27] [config] early-stopping-on: first
[2023-07-22 02:22:27] [config] embedding-fix-src: false
[2023-07-22 02:22:27] [config] embedding-fix-trg: false
[2023-07-22 02:22:27] [config] embedding-normalization: false
[2023-07-22 02:22:27] [config] embedding-vectors:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] enc-cell: gru
[2023-07-22 02:22:27] [config] enc-cell-depth: 1
[2023-07-22 02:22:27] [config] enc-depth: 1
[2023-07-22 02:22:27] [config] enc-type: bidirectional
[2023-07-22 02:22:27] [config] english-title-case-every: 0
[2023-07-22 02:22:27] [config] exponential-smoothing: 0
[2023-07-22 02:22:27] [config] factor-weight: 1
[2023-07-22 02:22:27] [config] factors-combine: sum
[2023-07-22 02:22:27] [config] factors-dim-emb: 0
[2023-07-22 02:22:27] [config] gradient-checkpointing: false
[2023-07-22 02:22:27] [config] gradient-norm-average-window: 100
[2023-07-22 02:22:27] [config] guided-alignment: none
[2023-07-22 02:22:27] [config] guided-alignment-cost: mse
[2023-07-22 02:22:27] [config] guided-alignment-weight: 0.1
[2023-07-22 02:22:27] [config] ignore-model-config: false
[2023-07-22 02:22:27] [config] input-types:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] interpolate-env-vars: false
[2023-07-22 02:22:27] [config] keep-best: false
[2023-07-22 02:22:27] [config] label-smoothing: 0
[2023-07-22 02:22:27] [config] layer-normalization: false
[2023-07-22 02:22:27] [config] learn-rate: 0.0001
[2023-07-22 02:22:27] [config] lemma-dependency: ""
[2023-07-22 02:22:27] [config] lemma-dim-emb: 0
[2023-07-22 02:22:27] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 02:22:27] [config] log-level: info
[2023-07-22 02:22:27] [config] log-time-zone: ""
[2023-07-22 02:22:27] [config] logical-epoch:
[2023-07-22 02:22:27] [config]   - 1e
[2023-07-22 02:22:27] [config]   - 0
[2023-07-22 02:22:27] [config] lr-decay: 0
[2023-07-22 02:22:27] [config] lr-decay-freq: 50000
[2023-07-22 02:22:27] [config] lr-decay-inv-sqrt:
[2023-07-22 02:22:27] [config]   - 0
[2023-07-22 02:22:27] [config] lr-decay-repeat-warmup: false
[2023-07-22 02:22:27] [config] lr-decay-reset-optimizer: false
[2023-07-22 02:22:27] [config] lr-decay-start:
[2023-07-22 02:22:27] [config]   - 10
[2023-07-22 02:22:27] [config]   - 1
[2023-07-22 02:22:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 02:22:27] [config] lr-report: false
[2023-07-22 02:22:27] [config] lr-warmup: 0
[2023-07-22 02:22:27] [config] lr-warmup-at-reload: false
[2023-07-22 02:22:27] [config] lr-warmup-cycle: false
[2023-07-22 02:22:27] [config] lr-warmup-start-rate: 0
[2023-07-22 02:22:27] [config] max-length: 150
[2023-07-22 02:22:27] [config] max-length-crop: true
[2023-07-22 02:22:27] [config] max-length-factor: 3
[2023-07-22 02:22:27] [config] maxi-batch: 100
[2023-07-22 02:22:27] [config] maxi-batch-sort: trg
[2023-07-22 02:22:27] [config] mini-batch: 64
[2023-07-22 02:22:27] [config] mini-batch-fit: true
[2023-07-22 02:22:27] [config] mini-batch-fit-step: 10
[2023-07-22 02:22:27] [config] mini-batch-round-up: true
[2023-07-22 02:22:27] [config] mini-batch-track-lr: false
[2023-07-22 02:22:27] [config] mini-batch-warmup: 0
[2023-07-22 02:22:27] [config] mini-batch-words: 0
[2023-07-22 02:22:27] [config] mini-batch-words-ref: 0
[2023-07-22 02:22:27] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 02:22:27] [config] multi-loss-type: sum
[2023-07-22 02:22:27] [config] n-best: false
[2023-07-22 02:22:27] [config] no-nccl: false
[2023-07-22 02:22:27] [config] no-reload: false
[2023-07-22 02:22:27] [config] no-restore-corpus: false
[2023-07-22 02:22:27] [config] normalize: 0
[2023-07-22 02:22:27] [config] normalize-gradient: false
[2023-07-22 02:22:27] [config] num-devices: 0
[2023-07-22 02:22:27] [config] optimizer: adam
[2023-07-22 02:22:27] [config] optimizer-delay: 1
[2023-07-22 02:22:27] [config] optimizer-params:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] output-omit-bias: false
[2023-07-22 02:22:27] [config] overwrite: true
[2023-07-22 02:22:27] [config] precision:
[2023-07-22 02:22:27] [config]   - float16
[2023-07-22 02:22:27] [config]   - float32
[2023-07-22 02:22:27] [config] pretrained-model: ""
[2023-07-22 02:22:27] [config] quantize-biases: false
[2023-07-22 02:22:27] [config] quantize-bits: 0
[2023-07-22 02:22:27] [config] quantize-log-based: false
[2023-07-22 02:22:27] [config] quantize-optimization-steps: 0
[2023-07-22 02:22:27] [config] quiet: false
[2023-07-22 02:22:27] [config] quiet-translation: true
[2023-07-22 02:22:27] [config] relative-paths: false
[2023-07-22 02:22:27] [config] right-left: false
[2023-07-22 02:22:27] [config] save-freq: 10000u
[2023-07-22 02:22:27] [config] seed: 1234
[2023-07-22 02:22:27] [config] sentencepiece-alphas:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] sentencepiece-max-lines: 2000000
[2023-07-22 02:22:27] [config] sentencepiece-options: ""
[2023-07-22 02:22:27] [config] sharding: global
[2023-07-22 02:22:27] [config] shuffle: data
[2023-07-22 02:22:27] [config] shuffle-in-ram: false
[2023-07-22 02:22:27] [config] sigterm: save-and-exit
[2023-07-22 02:22:27] [config] skip: false
[2023-07-22 02:22:27] [config] sqlite: ""
[2023-07-22 02:22:27] [config] sqlite-drop: false
[2023-07-22 02:22:27] [config] sync-freq: 200u
[2023-07-22 02:22:27] [config] sync-sgd: false
[2023-07-22 02:22:27] [config] tempdir: /tmp
[2023-07-22 02:22:27] [config] tied-embeddings: false
[2023-07-22 02:22:27] [config] tied-embeddings-all: true
[2023-07-22 02:22:27] [config] tied-embeddings-src: false
[2023-07-22 02:22:27] [config] train-embedder-rank:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] train-sets:
[2023-07-22 02:22:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 02:22:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 02:22:27] [config] transformer-aan-activation: swish
[2023-07-22 02:22:27] [config] transformer-aan-depth: 2
[2023-07-22 02:22:27] [config] transformer-aan-nogate: false
[2023-07-22 02:22:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 02:22:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 02:22:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 02:22:27] [config] transformer-depth-scaling: false
[2023-07-22 02:22:27] [config] transformer-dim-aan: 2048
[2023-07-22 02:22:27] [config] transformer-dim-ffn: 2048
[2023-07-22 02:22:27] [config] transformer-dropout: 0
[2023-07-22 02:22:27] [config] transformer-dropout-attention: 0
[2023-07-22 02:22:27] [config] transformer-dropout-ffn: 0
[2023-07-22 02:22:27] [config] transformer-ffn-activation: swish
[2023-07-22 02:22:27] [config] transformer-ffn-depth: 2
[2023-07-22 02:22:27] [config] transformer-guided-alignment-layer: last
[2023-07-22 02:22:27] [config] transformer-heads: 8
[2023-07-22 02:22:27] [config] transformer-no-projection: false
[2023-07-22 02:22:27] [config] transformer-pool: false
[2023-07-22 02:22:27] [config] transformer-postprocess: dan
[2023-07-22 02:22:27] [config] transformer-postprocess-emb: d
[2023-07-22 02:22:27] [config] transformer-postprocess-top: ""
[2023-07-22 02:22:27] [config] transformer-preprocess: ""
[2023-07-22 02:22:27] [config] transformer-tied-layers:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] transformer-train-position-embeddings: false
[2023-07-22 02:22:27] [config] tsv: false
[2023-07-22 02:22:27] [config] tsv-fields: 0
[2023-07-22 02:22:27] [config] type: amun
[2023-07-22 02:22:27] [config] ulr: false
[2023-07-22 02:22:27] [config] ulr-dim-emb: 0
[2023-07-22 02:22:27] [config] ulr-dropout: 0
[2023-07-22 02:22:27] [config] ulr-keys-vectors: ""
[2023-07-22 02:22:27] [config] ulr-query-vectors: ""
[2023-07-22 02:22:27] [config] ulr-softmax-temperature: 1
[2023-07-22 02:22:27] [config] ulr-trainable-transformation: false
[2023-07-22 02:22:27] [config] unlikelihood-loss: false
[2023-07-22 02:22:27] [config] valid-freq: 50000000
[2023-07-22 02:22:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 02:22:27] [config] valid-max-length: 1000
[2023-07-22 02:22:27] [config] valid-metrics:
[2023-07-22 02:22:27] [config]   - cross-entropy
[2023-07-22 02:22:27] [config]   - translation
[2023-07-22 02:22:27] [config] valid-mini-batch: 32
[2023-07-22 02:22:27] [config] valid-reset-stalled: false
[2023-07-22 02:22:27] [config] valid-script-args:
[2023-07-22 02:22:27] [config]   []
[2023-07-22 02:22:27] [config] valid-script-path: ""
[2023-07-22 02:22:27] [config] valid-sets:
[2023-07-22 02:22:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 02:22:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 02:22:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 02:22:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:22:27] [config] vocabs:
[2023-07-22 02:22:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:22:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:22:27] [config] word-penalty: 0
[2023-07-22 02:22:27] [config] word-scores: false
[2023-07-22 02:22:27] [config] workspace: 5500
[2023-07-22 02:22:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:22:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:22:27] [training] Using single-device training
[2023-07-22 02:22:27] Synced seed 1234
[2023-07-22 02:22:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:22:28] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 02:22:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:22:28] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 02:22:28] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 02:22:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:22:28] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 02:22:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 02:22:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 02:22:29] [comm] Using global sharding
[2023-07-22 02:22:29] [comm] NCCLCommunicators constructed successfully
[2023-07-22 02:22:29] [training] Using 1 GPUs
[2023-07-22 02:22:29] [logits] Applying loss function for 1 factor(s)
[2023-07-22 02:22:29] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:22:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 02:22:29] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:49:09] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 02:49:10] [valid] No post-processing script given for validating translator
[2023-07-22 02:49:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:49:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 02:49:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 02:49:10] [comm] Using global sharding
[2023-07-22 02:49:10] [comm] NCCLCommunicators constructed successfully
[2023-07-22 02:49:10] [training] Using 1 GPUs
[2023-07-22 02:49:10] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 02:49:16] Allocating memory for general optimizer shards
[2023-07-22 02:49:16] [memory] Reserving 322 MB, device gpu0
[2023-07-22 02:49:16] Loading Adam parameters
[2023-07-22 02:49:16] [memory] Reserving 322 MB, device gpu0
[2023-07-22 02:49:16] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:49:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 02:49:17] [data] Restoring the corpus state to epoch 71, batch 3067
[2023-07-22 02:49:17] [data] Shuffling data
[2023-07-22 02:49:17] [data] Done reading 20,192 sentences
[2023-07-22 02:49:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:49:17] Training started
[2023-07-22 02:49:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 02:49:17] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:49:25] Parameter type float16, optimization type float32, casting types true
[2023-07-22 02:53:38] Seen 20,192 samples
[2023-07-22 02:53:48] Starting data epoch 72 in logical epoch 72
[2023-07-22 02:53:48] [data] Shuffling data
[2023-07-22 02:53:56] [data] Done reading 20,192 sentences
[2023-07-22 02:53:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:58:00] Seen 20,192 samples
[2023-07-22 02:58:00] Starting data epoch 73 in logical epoch 73
[2023-07-22 02:58:00] [data] Shuffling data
[2023-07-22 02:58:00] [data] Done reading 20,192 sentences
[2023-07-22 02:58:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:02:29] Seen 20,192 samples
[2023-07-22 03:02:29] Starting data epoch 74 in logical epoch 74
[2023-07-22 03:02:29] [data] Shuffling data
[2023-07-22 03:02:29] [data] Done reading 20,192 sentences
[2023-07-22 03:02:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:07:00] Seen 20,192 samples
[2023-07-22 03:07:00] Starting data epoch 75 in logical epoch 75
[2023-07-22 03:07:00] [data] Shuffling data
[2023-07-22 03:07:00] [data] Done reading 20,192 sentences
[2023-07-22 03:07:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:11:19] Seen 20,192 samples
[2023-07-22 03:11:19] Starting data epoch 76 in logical epoch 76
[2023-07-22 03:11:19] [data] Shuffling data
[2023-07-22 03:11:19] [data] Done reading 20,192 sentences
[2023-07-22 03:11:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:15:51] Seen 20,192 samples
[2023-07-22 03:15:51] Starting data epoch 77 in logical epoch 77
[2023-07-22 03:15:51] [data] Shuffling data
[2023-07-22 03:15:51] [data] Done reading 20,192 sentences
[2023-07-22 03:15:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:20:33] Seen 20,192 samples
[2023-07-22 03:20:33] Starting data epoch 78 in logical epoch 78
[2023-07-22 03:20:33] [data] Shuffling data
[2023-07-22 03:20:33] [data] Done reading 20,192 sentences
[2023-07-22 03:20:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:25:08] Seen 20,192 samples
[2023-07-22 03:25:08] Starting data epoch 79 in logical epoch 79
[2023-07-22 03:25:08] [data] Shuffling data
[2023-07-22 03:25:08] [data] Done reading 20,192 sentences
[2023-07-22 03:25:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:29:46] Seen 20,192 samples
[2023-07-22 03:29:46] Starting data epoch 80 in logical epoch 80
[2023-07-22 03:29:46] [data] Shuffling data
[2023-07-22 03:29:46] [data] Done reading 20,192 sentences
[2023-07-22 03:29:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:34:22] Seen 20,192 samples
[2023-07-22 03:34:22] Starting data epoch 81 in logical epoch 81
[2023-07-22 03:34:22] Training finished
[2023-07-22 03:34:32] [valid] Ep. 81 : Up. 3507 : cross-entropy : 132.832 : new best
[2023-07-22 03:37:38] [valid] Ep. 81 : Up. 3507 : translation : 0 : new best
[2023-07-22 03:37:38] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 03:37:40] Saving Adam parameters
[2023-07-22 03:37:41] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 03:37:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 03:37:47] [marian] Running on node22.datos.cluster.uy as process 9226 with command line:
[2023-07-22 03:37:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 03:37:47] [config] after: 0e
[2023-07-22 03:37:47] [config] after-batches: 0
[2023-07-22 03:37:47] [config] after-epochs: 90
[2023-07-22 03:37:47] [config] all-caps-every: 0
[2023-07-22 03:37:47] [config] allow-unk: false
[2023-07-22 03:37:47] [config] authors: false
[2023-07-22 03:37:47] [config] beam-size: 12
[2023-07-22 03:37:47] [config] bert-class-symbol: "[CLS]"
[2023-07-22 03:37:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 03:37:47] [config] bert-masking-fraction: 0.15
[2023-07-22 03:37:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 03:37:47] [config] bert-train-type-embeddings: true
[2023-07-22 03:37:47] [config] bert-type-vocab-size: 2
[2023-07-22 03:37:47] [config] build-info: ""
[2023-07-22 03:37:47] [config] check-gradient-nan: false
[2023-07-22 03:37:47] [config] check-nan: false
[2023-07-22 03:37:47] [config] cite: false
[2023-07-22 03:37:47] [config] clip-norm: 1
[2023-07-22 03:37:47] [config] cost-scaling:
[2023-07-22 03:37:47] [config]   - 256.f
[2023-07-22 03:37:47] [config]   - 1000
[2023-07-22 03:37:47] [config]   - 2.f
[2023-07-22 03:37:47] [config]   - 256.f
[2023-07-22 03:37:47] [config] cost-type: ce-sum
[2023-07-22 03:37:47] [config] cpu-threads: 0
[2023-07-22 03:37:47] [config] data-threads: 8
[2023-07-22 03:37:47] [config] data-weighting: ""
[2023-07-22 03:37:47] [config] data-weighting-type: sentence
[2023-07-22 03:37:47] [config] dec-cell: gru
[2023-07-22 03:37:47] [config] dec-cell-base-depth: 2
[2023-07-22 03:37:47] [config] dec-cell-high-depth: 1
[2023-07-22 03:37:47] [config] dec-depth: 1
[2023-07-22 03:37:47] [config] devices:
[2023-07-22 03:37:47] [config]   - 0
[2023-07-22 03:37:47] [config] dim-emb: 512
[2023-07-22 03:37:47] [config] dim-rnn: 1024
[2023-07-22 03:37:47] [config] dim-vocabs:
[2023-07-22 03:37:47] [config]   - 16384
[2023-07-22 03:37:47] [config]   - 16384
[2023-07-22 03:37:47] [config] disp-first: 0
[2023-07-22 03:37:47] [config] disp-freq: 1000u
[2023-07-22 03:37:47] [config] disp-label-counts: true
[2023-07-22 03:37:47] [config] dropout-rnn: 0
[2023-07-22 03:37:47] [config] dropout-src: 0
[2023-07-22 03:37:47] [config] dropout-trg: 0
[2023-07-22 03:37:47] [config] dump-config: ""
[2023-07-22 03:37:47] [config] dynamic-gradient-scaling:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] early-stopping: 200
[2023-07-22 03:37:47] [config] early-stopping-on: first
[2023-07-22 03:37:47] [config] embedding-fix-src: false
[2023-07-22 03:37:47] [config] embedding-fix-trg: false
[2023-07-22 03:37:47] [config] embedding-normalization: false
[2023-07-22 03:37:47] [config] embedding-vectors:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] enc-cell: gru
[2023-07-22 03:37:47] [config] enc-cell-depth: 1
[2023-07-22 03:37:47] [config] enc-depth: 1
[2023-07-22 03:37:47] [config] enc-type: bidirectional
[2023-07-22 03:37:47] [config] english-title-case-every: 0
[2023-07-22 03:37:47] [config] exponential-smoothing: 0
[2023-07-22 03:37:47] [config] factor-weight: 1
[2023-07-22 03:37:47] [config] factors-combine: sum
[2023-07-22 03:37:47] [config] factors-dim-emb: 0
[2023-07-22 03:37:47] [config] gradient-checkpointing: false
[2023-07-22 03:37:47] [config] gradient-norm-average-window: 100
[2023-07-22 03:37:47] [config] guided-alignment: none
[2023-07-22 03:37:47] [config] guided-alignment-cost: mse
[2023-07-22 03:37:47] [config] guided-alignment-weight: 0.1
[2023-07-22 03:37:47] [config] ignore-model-config: false
[2023-07-22 03:37:47] [config] input-types:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] interpolate-env-vars: false
[2023-07-22 03:37:47] [config] keep-best: false
[2023-07-22 03:37:47] [config] label-smoothing: 0
[2023-07-22 03:37:47] [config] layer-normalization: false
[2023-07-22 03:37:47] [config] learn-rate: 0.0001
[2023-07-22 03:37:47] [config] lemma-dependency: ""
[2023-07-22 03:37:47] [config] lemma-dim-emb: 0
[2023-07-22 03:37:47] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 03:37:47] [config] log-level: info
[2023-07-22 03:37:47] [config] log-time-zone: ""
[2023-07-22 03:37:47] [config] logical-epoch:
[2023-07-22 03:37:47] [config]   - 1e
[2023-07-22 03:37:47] [config]   - 0
[2023-07-22 03:37:47] [config] lr-decay: 0
[2023-07-22 03:37:47] [config] lr-decay-freq: 50000
[2023-07-22 03:37:47] [config] lr-decay-inv-sqrt:
[2023-07-22 03:37:47] [config]   - 0
[2023-07-22 03:37:47] [config] lr-decay-repeat-warmup: false
[2023-07-22 03:37:47] [config] lr-decay-reset-optimizer: false
[2023-07-22 03:37:47] [config] lr-decay-start:
[2023-07-22 03:37:47] [config]   - 10
[2023-07-22 03:37:47] [config]   - 1
[2023-07-22 03:37:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 03:37:47] [config] lr-report: false
[2023-07-22 03:37:47] [config] lr-warmup: 0
[2023-07-22 03:37:47] [config] lr-warmup-at-reload: false
[2023-07-22 03:37:47] [config] lr-warmup-cycle: false
[2023-07-22 03:37:47] [config] lr-warmup-start-rate: 0
[2023-07-22 03:37:47] [config] max-length: 150
[2023-07-22 03:37:47] [config] max-length-crop: true
[2023-07-22 03:37:47] [config] max-length-factor: 3
[2023-07-22 03:37:47] [config] maxi-batch: 100
[2023-07-22 03:37:47] [config] maxi-batch-sort: trg
[2023-07-22 03:37:47] [config] mini-batch: 64
[2023-07-22 03:37:47] [config] mini-batch-fit: true
[2023-07-22 03:37:47] [config] mini-batch-fit-step: 10
[2023-07-22 03:37:47] [config] mini-batch-round-up: true
[2023-07-22 03:37:47] [config] mini-batch-track-lr: false
[2023-07-22 03:37:47] [config] mini-batch-warmup: 0
[2023-07-22 03:37:47] [config] mini-batch-words: 0
[2023-07-22 03:37:47] [config] mini-batch-words-ref: 0
[2023-07-22 03:37:47] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 03:37:47] [config] multi-loss-type: sum
[2023-07-22 03:37:47] [config] n-best: false
[2023-07-22 03:37:47] [config] no-nccl: false
[2023-07-22 03:37:47] [config] no-reload: false
[2023-07-22 03:37:47] [config] no-restore-corpus: false
[2023-07-22 03:37:47] [config] normalize: 0
[2023-07-22 03:37:47] [config] normalize-gradient: false
[2023-07-22 03:37:47] [config] num-devices: 0
[2023-07-22 03:37:47] [config] optimizer: adam
[2023-07-22 03:37:47] [config] optimizer-delay: 1
[2023-07-22 03:37:47] [config] optimizer-params:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] output-omit-bias: false
[2023-07-22 03:37:47] [config] overwrite: true
[2023-07-22 03:37:47] [config] precision:
[2023-07-22 03:37:47] [config]   - float16
[2023-07-22 03:37:47] [config]   - float32
[2023-07-22 03:37:47] [config] pretrained-model: ""
[2023-07-22 03:37:47] [config] quantize-biases: false
[2023-07-22 03:37:47] [config] quantize-bits: 0
[2023-07-22 03:37:47] [config] quantize-log-based: false
[2023-07-22 03:37:47] [config] quantize-optimization-steps: 0
[2023-07-22 03:37:47] [config] quiet: false
[2023-07-22 03:37:47] [config] quiet-translation: true
[2023-07-22 03:37:47] [config] relative-paths: false
[2023-07-22 03:37:47] [config] right-left: false
[2023-07-22 03:37:47] [config] save-freq: 10000u
[2023-07-22 03:37:47] [config] seed: 1234
[2023-07-22 03:37:47] [config] sentencepiece-alphas:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] sentencepiece-max-lines: 2000000
[2023-07-22 03:37:47] [config] sentencepiece-options: ""
[2023-07-22 03:37:47] [config] sharding: global
[2023-07-22 03:37:47] [config] shuffle: data
[2023-07-22 03:37:47] [config] shuffle-in-ram: false
[2023-07-22 03:37:47] [config] sigterm: save-and-exit
[2023-07-22 03:37:47] [config] skip: false
[2023-07-22 03:37:47] [config] sqlite: ""
[2023-07-22 03:37:47] [config] sqlite-drop: false
[2023-07-22 03:37:47] [config] sync-freq: 200u
[2023-07-22 03:37:47] [config] sync-sgd: false
[2023-07-22 03:37:47] [config] tempdir: /tmp
[2023-07-22 03:37:47] [config] tied-embeddings: false
[2023-07-22 03:37:47] [config] tied-embeddings-all: true
[2023-07-22 03:37:47] [config] tied-embeddings-src: false
[2023-07-22 03:37:47] [config] train-embedder-rank:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] train-sets:
[2023-07-22 03:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 03:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 03:37:47] [config] transformer-aan-activation: swish
[2023-07-22 03:37:47] [config] transformer-aan-depth: 2
[2023-07-22 03:37:47] [config] transformer-aan-nogate: false
[2023-07-22 03:37:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 03:37:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 03:37:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 03:37:47] [config] transformer-depth-scaling: false
[2023-07-22 03:37:47] [config] transformer-dim-aan: 2048
[2023-07-22 03:37:47] [config] transformer-dim-ffn: 2048
[2023-07-22 03:37:47] [config] transformer-dropout: 0
[2023-07-22 03:37:47] [config] transformer-dropout-attention: 0
[2023-07-22 03:37:47] [config] transformer-dropout-ffn: 0
[2023-07-22 03:37:47] [config] transformer-ffn-activation: swish
[2023-07-22 03:37:47] [config] transformer-ffn-depth: 2
[2023-07-22 03:37:47] [config] transformer-guided-alignment-layer: last
[2023-07-22 03:37:47] [config] transformer-heads: 8
[2023-07-22 03:37:47] [config] transformer-no-projection: false
[2023-07-22 03:37:47] [config] transformer-pool: false
[2023-07-22 03:37:47] [config] transformer-postprocess: dan
[2023-07-22 03:37:47] [config] transformer-postprocess-emb: d
[2023-07-22 03:37:47] [config] transformer-postprocess-top: ""
[2023-07-22 03:37:47] [config] transformer-preprocess: ""
[2023-07-22 03:37:47] [config] transformer-tied-layers:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] transformer-train-position-embeddings: false
[2023-07-22 03:37:47] [config] tsv: false
[2023-07-22 03:37:47] [config] tsv-fields: 0
[2023-07-22 03:37:47] [config] type: amun
[2023-07-22 03:37:47] [config] ulr: false
[2023-07-22 03:37:47] [config] ulr-dim-emb: 0
[2023-07-22 03:37:47] [config] ulr-dropout: 0
[2023-07-22 03:37:47] [config] ulr-keys-vectors: ""
[2023-07-22 03:37:47] [config] ulr-query-vectors: ""
[2023-07-22 03:37:47] [config] ulr-softmax-temperature: 1
[2023-07-22 03:37:47] [config] ulr-trainable-transformation: false
[2023-07-22 03:37:47] [config] unlikelihood-loss: false
[2023-07-22 03:37:47] [config] valid-freq: 50000000
[2023-07-22 03:37:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 03:37:47] [config] valid-max-length: 1000
[2023-07-22 03:37:47] [config] valid-metrics:
[2023-07-22 03:37:47] [config]   - cross-entropy
[2023-07-22 03:37:47] [config]   - translation
[2023-07-22 03:37:47] [config] valid-mini-batch: 32
[2023-07-22 03:37:47] [config] valid-reset-stalled: false
[2023-07-22 03:37:47] [config] valid-script-args:
[2023-07-22 03:37:47] [config]   []
[2023-07-22 03:37:47] [config] valid-script-path: ""
[2023-07-22 03:37:47] [config] valid-sets:
[2023-07-22 03:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 03:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 03:37:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 03:37:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 03:37:47] [config] vocabs:
[2023-07-22 03:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 03:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 03:37:47] [config] word-penalty: 0
[2023-07-22 03:37:47] [config] word-scores: false
[2023-07-22 03:37:47] [config] workspace: 5500
[2023-07-22 03:37:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 03:37:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:37:47] [training] Using single-device training
[2023-07-22 03:37:48] Synced seed 1234
[2023-07-22 03:37:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 03:37:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 03:37:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 03:37:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 03:37:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 03:37:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:37:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 03:37:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 03:37:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 03:37:49] [comm] Using global sharding
[2023-07-22 03:37:49] [comm] NCCLCommunicators constructed successfully
[2023-07-22 03:37:49] [training] Using 1 GPUs
[2023-07-22 03:37:49] [logits] Applying loss function for 1 factor(s)
[2023-07-22 03:37:49] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:37:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 03:37:49] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:04:28] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 04:04:28] [valid] No post-processing script given for validating translator
[2023-07-22 04:04:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:04:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 04:04:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 04:04:29] [comm] Using global sharding
[2023-07-22 04:04:29] [comm] NCCLCommunicators constructed successfully
[2023-07-22 04:04:29] [training] Using 1 GPUs
[2023-07-22 04:04:29] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 04:04:35] Allocating memory for general optimizer shards
[2023-07-22 04:04:35] [memory] Reserving 322 MB, device gpu0
[2023-07-22 04:04:35] Loading Adam parameters
[2023-07-22 04:04:35] [memory] Reserving 322 MB, device gpu0
[2023-07-22 04:04:35] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:04:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 04:04:35] [data] Restoring the corpus state to epoch 81, batch 3507
[2023-07-22 04:04:35] [data] Shuffling data
[2023-07-22 04:04:35] [data] Done reading 20,192 sentences
[2023-07-22 04:04:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:04:35] Training started
[2023-07-22 04:04:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 04:04:36] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:04:38] Parameter type float16, optimization type float32, casting types true
[2023-07-22 04:09:00] Seen 20,192 samples
[2023-07-22 04:09:00] Starting data epoch 82 in logical epoch 82
[2023-07-22 04:09:00] [data] Shuffling data
[2023-07-22 04:09:00] [data] Done reading 20,192 sentences
[2023-07-22 04:09:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:13:40] Seen 20,192 samples
[2023-07-22 04:13:40] Starting data epoch 83 in logical epoch 83
[2023-07-22 04:13:40] [data] Shuffling data
[2023-07-22 04:13:40] [data] Done reading 20,192 sentences
[2023-07-22 04:13:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:18:10] Seen 20,192 samples
[2023-07-22 04:18:10] Starting data epoch 84 in logical epoch 84
[2023-07-22 04:18:10] [data] Shuffling data
[2023-07-22 04:18:10] [data] Done reading 20,192 sentences
[2023-07-22 04:18:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:22:44] Seen 20,192 samples
[2023-07-22 04:22:44] Starting data epoch 85 in logical epoch 85
[2023-07-22 04:22:44] [data] Shuffling data
[2023-07-22 04:22:44] [data] Done reading 20,192 sentences
[2023-07-22 04:22:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:27:16] Seen 20,192 samples
[2023-07-22 04:27:16] Starting data epoch 86 in logical epoch 86
[2023-07-22 04:27:16] [data] Shuffling data
[2023-07-22 04:27:16] [data] Done reading 20,192 sentences
[2023-07-22 04:27:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:31:41] Seen 20,192 samples
[2023-07-22 04:31:41] Starting data epoch 87 in logical epoch 87
[2023-07-22 04:31:41] [data] Shuffling data
[2023-07-22 04:31:41] [data] Done reading 20,192 sentences
[2023-07-22 04:31:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:36:07] Seen 20,192 samples
[2023-07-22 04:36:07] Starting data epoch 88 in logical epoch 88
[2023-07-22 04:36:07] [data] Shuffling data
[2023-07-22 04:36:07] [data] Done reading 20,192 sentences
[2023-07-22 04:36:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:40:38] Seen 20,192 samples
[2023-07-22 04:40:38] Starting data epoch 89 in logical epoch 89
[2023-07-22 04:40:38] [data] Shuffling data
[2023-07-22 04:40:38] [data] Done reading 20,192 sentences
[2023-07-22 04:40:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:45:11] Seen 20,192 samples
[2023-07-22 04:45:11] Starting data epoch 90 in logical epoch 90
[2023-07-22 04:45:11] [data] Shuffling data
[2023-07-22 04:45:11] [data] Done reading 20,192 sentences
[2023-07-22 04:45:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:49:39] Seen 20,192 samples
[2023-07-22 04:49:39] Starting data epoch 91 in logical epoch 91
[2023-07-22 04:49:39] Training finished
[2023-07-22 04:49:53] [valid] Ep. 91 : Up. 3946 : cross-entropy : 131.961 : new best
[2023-07-22 04:53:00] [valid] Ep. 91 : Up. 3946 : translation : 0 : new best
[2023-07-22 04:53:00] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 04:53:02] Saving Adam parameters
[2023-07-22 04:53:02] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 04:53:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:53:10] [marian] Running on node22.datos.cluster.uy as process 13914 with command line:
[2023-07-22 04:53:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 04:53:10] [config] after: 0e
[2023-07-22 04:53:10] [config] after-batches: 0
[2023-07-22 04:53:10] [config] after-epochs: 100
[2023-07-22 04:53:10] [config] all-caps-every: 0
[2023-07-22 04:53:10] [config] allow-unk: false
[2023-07-22 04:53:10] [config] authors: false
[2023-07-22 04:53:10] [config] beam-size: 12
[2023-07-22 04:53:10] [config] bert-class-symbol: "[CLS]"
[2023-07-22 04:53:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 04:53:10] [config] bert-masking-fraction: 0.15
[2023-07-22 04:53:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 04:53:10] [config] bert-train-type-embeddings: true
[2023-07-22 04:53:10] [config] bert-type-vocab-size: 2
[2023-07-22 04:53:10] [config] build-info: ""
[2023-07-22 04:53:10] [config] check-gradient-nan: false
[2023-07-22 04:53:10] [config] check-nan: false
[2023-07-22 04:53:10] [config] cite: false
[2023-07-22 04:53:10] [config] clip-norm: 1
[2023-07-22 04:53:10] [config] cost-scaling:
[2023-07-22 04:53:10] [config]   - 256.f
[2023-07-22 04:53:10] [config]   - 1000
[2023-07-22 04:53:10] [config]   - 2.f
[2023-07-22 04:53:10] [config]   - 256.f
[2023-07-22 04:53:10] [config] cost-type: ce-sum
[2023-07-22 04:53:10] [config] cpu-threads: 0
[2023-07-22 04:53:10] [config] data-threads: 8
[2023-07-22 04:53:10] [config] data-weighting: ""
[2023-07-22 04:53:10] [config] data-weighting-type: sentence
[2023-07-22 04:53:10] [config] dec-cell: gru
[2023-07-22 04:53:10] [config] dec-cell-base-depth: 2
[2023-07-22 04:53:10] [config] dec-cell-high-depth: 1
[2023-07-22 04:53:10] [config] dec-depth: 1
[2023-07-22 04:53:10] [config] devices:
[2023-07-22 04:53:10] [config]   - 0
[2023-07-22 04:53:10] [config] dim-emb: 512
[2023-07-22 04:53:10] [config] dim-rnn: 1024
[2023-07-22 04:53:10] [config] dim-vocabs:
[2023-07-22 04:53:10] [config]   - 16384
[2023-07-22 04:53:10] [config]   - 16384
[2023-07-22 04:53:10] [config] disp-first: 0
[2023-07-22 04:53:10] [config] disp-freq: 1000u
[2023-07-22 04:53:10] [config] disp-label-counts: true
[2023-07-22 04:53:10] [config] dropout-rnn: 0
[2023-07-22 04:53:10] [config] dropout-src: 0
[2023-07-22 04:53:10] [config] dropout-trg: 0
[2023-07-22 04:53:10] [config] dump-config: ""
[2023-07-22 04:53:10] [config] dynamic-gradient-scaling:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] early-stopping: 200
[2023-07-22 04:53:10] [config] early-stopping-on: first
[2023-07-22 04:53:10] [config] embedding-fix-src: false
[2023-07-22 04:53:10] [config] embedding-fix-trg: false
[2023-07-22 04:53:10] [config] embedding-normalization: false
[2023-07-22 04:53:10] [config] embedding-vectors:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] enc-cell: gru
[2023-07-22 04:53:10] [config] enc-cell-depth: 1
[2023-07-22 04:53:10] [config] enc-depth: 1
[2023-07-22 04:53:10] [config] enc-type: bidirectional
[2023-07-22 04:53:10] [config] english-title-case-every: 0
[2023-07-22 04:53:10] [config] exponential-smoothing: 0
[2023-07-22 04:53:10] [config] factor-weight: 1
[2023-07-22 04:53:10] [config] factors-combine: sum
[2023-07-22 04:53:10] [config] factors-dim-emb: 0
[2023-07-22 04:53:10] [config] gradient-checkpointing: false
[2023-07-22 04:53:10] [config] gradient-norm-average-window: 100
[2023-07-22 04:53:10] [config] guided-alignment: none
[2023-07-22 04:53:10] [config] guided-alignment-cost: mse
[2023-07-22 04:53:10] [config] guided-alignment-weight: 0.1
[2023-07-22 04:53:10] [config] ignore-model-config: false
[2023-07-22 04:53:10] [config] input-types:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] interpolate-env-vars: false
[2023-07-22 04:53:10] [config] keep-best: false
[2023-07-22 04:53:10] [config] label-smoothing: 0
[2023-07-22 04:53:10] [config] layer-normalization: false
[2023-07-22 04:53:10] [config] learn-rate: 0.0001
[2023-07-22 04:53:10] [config] lemma-dependency: ""
[2023-07-22 04:53:10] [config] lemma-dim-emb: 0
[2023-07-22 04:53:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 04:53:10] [config] log-level: info
[2023-07-22 04:53:10] [config] log-time-zone: ""
[2023-07-22 04:53:10] [config] logical-epoch:
[2023-07-22 04:53:10] [config]   - 1e
[2023-07-22 04:53:10] [config]   - 0
[2023-07-22 04:53:10] [config] lr-decay: 0
[2023-07-22 04:53:10] [config] lr-decay-freq: 50000
[2023-07-22 04:53:10] [config] lr-decay-inv-sqrt:
[2023-07-22 04:53:10] [config]   - 0
[2023-07-22 04:53:10] [config] lr-decay-repeat-warmup: false
[2023-07-22 04:53:10] [config] lr-decay-reset-optimizer: false
[2023-07-22 04:53:10] [config] lr-decay-start:
[2023-07-22 04:53:10] [config]   - 10
[2023-07-22 04:53:10] [config]   - 1
[2023-07-22 04:53:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 04:53:10] [config] lr-report: false
[2023-07-22 04:53:10] [config] lr-warmup: 0
[2023-07-22 04:53:10] [config] lr-warmup-at-reload: false
[2023-07-22 04:53:10] [config] lr-warmup-cycle: false
[2023-07-22 04:53:10] [config] lr-warmup-start-rate: 0
[2023-07-22 04:53:10] [config] max-length: 150
[2023-07-22 04:53:10] [config] max-length-crop: true
[2023-07-22 04:53:10] [config] max-length-factor: 3
[2023-07-22 04:53:10] [config] maxi-batch: 100
[2023-07-22 04:53:10] [config] maxi-batch-sort: trg
[2023-07-22 04:53:10] [config] mini-batch: 64
[2023-07-22 04:53:10] [config] mini-batch-fit: true
[2023-07-22 04:53:10] [config] mini-batch-fit-step: 10
[2023-07-22 04:53:10] [config] mini-batch-round-up: true
[2023-07-22 04:53:10] [config] mini-batch-track-lr: false
[2023-07-22 04:53:10] [config] mini-batch-warmup: 0
[2023-07-22 04:53:10] [config] mini-batch-words: 0
[2023-07-22 04:53:10] [config] mini-batch-words-ref: 0
[2023-07-22 04:53:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 04:53:10] [config] multi-loss-type: sum
[2023-07-22 04:53:10] [config] n-best: false
[2023-07-22 04:53:10] [config] no-nccl: false
[2023-07-22 04:53:10] [config] no-reload: false
[2023-07-22 04:53:10] [config] no-restore-corpus: false
[2023-07-22 04:53:10] [config] normalize: 0
[2023-07-22 04:53:10] [config] normalize-gradient: false
[2023-07-22 04:53:10] [config] num-devices: 0
[2023-07-22 04:53:10] [config] optimizer: adam
[2023-07-22 04:53:10] [config] optimizer-delay: 1
[2023-07-22 04:53:10] [config] optimizer-params:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] output-omit-bias: false
[2023-07-22 04:53:10] [config] overwrite: true
[2023-07-22 04:53:10] [config] precision:
[2023-07-22 04:53:10] [config]   - float16
[2023-07-22 04:53:10] [config]   - float32
[2023-07-22 04:53:10] [config] pretrained-model: ""
[2023-07-22 04:53:10] [config] quantize-biases: false
[2023-07-22 04:53:10] [config] quantize-bits: 0
[2023-07-22 04:53:10] [config] quantize-log-based: false
[2023-07-22 04:53:10] [config] quantize-optimization-steps: 0
[2023-07-22 04:53:10] [config] quiet: false
[2023-07-22 04:53:10] [config] quiet-translation: true
[2023-07-22 04:53:10] [config] relative-paths: false
[2023-07-22 04:53:10] [config] right-left: false
[2023-07-22 04:53:10] [config] save-freq: 10000u
[2023-07-22 04:53:10] [config] seed: 1234
[2023-07-22 04:53:10] [config] sentencepiece-alphas:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] sentencepiece-max-lines: 2000000
[2023-07-22 04:53:10] [config] sentencepiece-options: ""
[2023-07-22 04:53:10] [config] sharding: global
[2023-07-22 04:53:10] [config] shuffle: data
[2023-07-22 04:53:10] [config] shuffle-in-ram: false
[2023-07-22 04:53:10] [config] sigterm: save-and-exit
[2023-07-22 04:53:10] [config] skip: false
[2023-07-22 04:53:10] [config] sqlite: ""
[2023-07-22 04:53:10] [config] sqlite-drop: false
[2023-07-22 04:53:10] [config] sync-freq: 200u
[2023-07-22 04:53:10] [config] sync-sgd: false
[2023-07-22 04:53:10] [config] tempdir: /tmp
[2023-07-22 04:53:10] [config] tied-embeddings: false
[2023-07-22 04:53:10] [config] tied-embeddings-all: true
[2023-07-22 04:53:10] [config] tied-embeddings-src: false
[2023-07-22 04:53:10] [config] train-embedder-rank:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] train-sets:
[2023-07-22 04:53:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 04:53:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 04:53:10] [config] transformer-aan-activation: swish
[2023-07-22 04:53:10] [config] transformer-aan-depth: 2
[2023-07-22 04:53:10] [config] transformer-aan-nogate: false
[2023-07-22 04:53:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 04:53:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 04:53:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 04:53:10] [config] transformer-depth-scaling: false
[2023-07-22 04:53:10] [config] transformer-dim-aan: 2048
[2023-07-22 04:53:10] [config] transformer-dim-ffn: 2048
[2023-07-22 04:53:10] [config] transformer-dropout: 0
[2023-07-22 04:53:10] [config] transformer-dropout-attention: 0
[2023-07-22 04:53:10] [config] transformer-dropout-ffn: 0
[2023-07-22 04:53:10] [config] transformer-ffn-activation: swish
[2023-07-22 04:53:10] [config] transformer-ffn-depth: 2
[2023-07-22 04:53:10] [config] transformer-guided-alignment-layer: last
[2023-07-22 04:53:10] [config] transformer-heads: 8
[2023-07-22 04:53:10] [config] transformer-no-projection: false
[2023-07-22 04:53:10] [config] transformer-pool: false
[2023-07-22 04:53:10] [config] transformer-postprocess: dan
[2023-07-22 04:53:10] [config] transformer-postprocess-emb: d
[2023-07-22 04:53:10] [config] transformer-postprocess-top: ""
[2023-07-22 04:53:10] [config] transformer-preprocess: ""
[2023-07-22 04:53:10] [config] transformer-tied-layers:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] transformer-train-position-embeddings: false
[2023-07-22 04:53:10] [config] tsv: false
[2023-07-22 04:53:10] [config] tsv-fields: 0
[2023-07-22 04:53:10] [config] type: amun
[2023-07-22 04:53:10] [config] ulr: false
[2023-07-22 04:53:10] [config] ulr-dim-emb: 0
[2023-07-22 04:53:10] [config] ulr-dropout: 0
[2023-07-22 04:53:10] [config] ulr-keys-vectors: ""
[2023-07-22 04:53:10] [config] ulr-query-vectors: ""
[2023-07-22 04:53:10] [config] ulr-softmax-temperature: 1
[2023-07-22 04:53:10] [config] ulr-trainable-transformation: false
[2023-07-22 04:53:10] [config] unlikelihood-loss: false
[2023-07-22 04:53:10] [config] valid-freq: 50000000
[2023-07-22 04:53:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 04:53:10] [config] valid-max-length: 1000
[2023-07-22 04:53:10] [config] valid-metrics:
[2023-07-22 04:53:10] [config]   - cross-entropy
[2023-07-22 04:53:10] [config]   - translation
[2023-07-22 04:53:10] [config] valid-mini-batch: 32
[2023-07-22 04:53:10] [config] valid-reset-stalled: false
[2023-07-22 04:53:10] [config] valid-script-args:
[2023-07-22 04:53:10] [config]   []
[2023-07-22 04:53:10] [config] valid-script-path: ""
[2023-07-22 04:53:10] [config] valid-sets:
[2023-07-22 04:53:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 04:53:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 04:53:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 04:53:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:53:10] [config] vocabs:
[2023-07-22 04:53:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:53:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:53:10] [config] word-penalty: 0
[2023-07-22 04:53:10] [config] word-scores: false
[2023-07-22 04:53:10] [config] workspace: 5500
[2023-07-22 04:53:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:53:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:53:10] [training] Using single-device training
[2023-07-22 04:53:10] Synced seed 1234
[2023-07-22 04:53:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:53:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 04:53:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:53:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 04:53:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 04:53:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:53:10] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 04:53:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 04:53:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 04:53:12] [comm] Using global sharding
[2023-07-22 04:53:12] [comm] NCCLCommunicators constructed successfully
[2023-07-22 04:53:12] [training] Using 1 GPUs
[2023-07-22 04:53:12] [logits] Applying loss function for 1 factor(s)
[2023-07-22 04:53:12] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:53:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 04:53:12] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:19:54] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 05:19:54] [valid] No post-processing script given for validating translator
[2023-07-22 05:19:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 05:19:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 05:19:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 05:19:54] [comm] Using global sharding
[2023-07-22 05:19:54] [comm] NCCLCommunicators constructed successfully
[2023-07-22 05:19:54] [training] Using 1 GPUs
[2023-07-22 05:19:54] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 05:19:58] Allocating memory for general optimizer shards
[2023-07-22 05:19:58] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:19:58] Loading Adam parameters
[2023-07-22 05:19:58] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:19:58] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:19:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 05:19:59] [data] Restoring the corpus state to epoch 91, batch 3946
[2023-07-22 05:19:59] [data] Shuffling data
[2023-07-22 05:19:59] [data] Done reading 20,192 sentences
[2023-07-22 05:19:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:19:59] Training started
[2023-07-22 05:19:59] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 05:19:59] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:20:03] Parameter type float16, optimization type float32, casting types true
[2023-07-22 05:24:22] Seen 20,192 samples
[2023-07-22 05:24:22] Starting data epoch 92 in logical epoch 92
[2023-07-22 05:24:22] [data] Shuffling data
[2023-07-22 05:24:22] [data] Done reading 20,192 sentences
[2023-07-22 05:24:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:25:37] Ep. 92 : Up. 4000 : Sen. 6,124 : Cost 4.36727428 * 12,415,318 @ 10,823 after 49,646,268 : Time 342.40s : 36259.48 words/s : gNorm 1.2940
[2023-07-22 05:28:55] Seen 20,192 samples
[2023-07-22 05:28:55] Starting data epoch 93 in logical epoch 93
[2023-07-22 05:28:55] [data] Shuffling data
[2023-07-22 05:28:55] [data] Done reading 20,192 sentences
[2023-07-22 05:28:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:33:28] Seen 20,192 samples
[2023-07-22 05:33:28] Starting data epoch 94 in logical epoch 94
[2023-07-22 05:33:28] [data] Shuffling data
[2023-07-22 05:33:28] [data] Done reading 20,192 sentences
[2023-07-22 05:33:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:37:53] Seen 20,192 samples
[2023-07-22 05:37:53] Starting data epoch 95 in logical epoch 95
[2023-07-22 05:37:53] [data] Shuffling data
[2023-07-22 05:37:54] [data] Done reading 20,192 sentences
[2023-07-22 05:37:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:42:28] Seen 20,192 samples
[2023-07-22 05:42:28] Starting data epoch 96 in logical epoch 96
[2023-07-22 05:42:28] [data] Shuffling data
[2023-07-22 05:42:28] [data] Done reading 20,192 sentences
[2023-07-22 05:42:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:47:08] Seen 20,192 samples
[2023-07-22 05:47:08] Starting data epoch 97 in logical epoch 97
[2023-07-22 05:47:08] [data] Shuffling data
[2023-07-22 05:47:08] [data] Done reading 20,192 sentences
[2023-07-22 05:47:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:51:41] Seen 20,192 samples
[2023-07-22 05:51:41] Starting data epoch 98 in logical epoch 98
[2023-07-22 05:51:41] [data] Shuffling data
[2023-07-22 05:51:41] [data] Done reading 20,192 sentences
[2023-07-22 05:51:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:56:07] Seen 20,192 samples
[2023-07-22 05:56:07] Starting data epoch 99 in logical epoch 99
[2023-07-22 05:56:07] [data] Shuffling data
[2023-07-22 05:56:07] [data] Done reading 20,192 sentences
[2023-07-22 05:56:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:00:33] Seen 20,192 samples
[2023-07-22 06:00:33] Starting data epoch 100 in logical epoch 100
[2023-07-22 06:00:33] [data] Shuffling data
[2023-07-22 06:00:33] [data] Done reading 20,192 sentences
[2023-07-22 06:00:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:05:05] Seen 20,192 samples
[2023-07-22 06:05:05] Starting data epoch 101 in logical epoch 101
[2023-07-22 06:05:05] Training finished
[2023-07-22 06:05:16] [valid] Ep. 101 : Up. 4381 : cross-entropy : 131.399 : new best
[2023-07-22 06:08:16] [valid] Ep. 101 : Up. 4381 : translation : 0 : new best
[2023-07-22 06:08:16] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 06:08:18] Saving Adam parameters
[2023-07-22 06:08:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 06:08:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:08:26] [marian] Running on node22.datos.cluster.uy as process 18894 with command line:
[2023-07-22 06:08:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 06:08:26] [config] after: 0e
[2023-07-22 06:08:26] [config] after-batches: 0
[2023-07-22 06:08:26] [config] after-epochs: 110
[2023-07-22 06:08:26] [config] all-caps-every: 0
[2023-07-22 06:08:26] [config] allow-unk: false
[2023-07-22 06:08:26] [config] authors: false
[2023-07-22 06:08:26] [config] beam-size: 12
[2023-07-22 06:08:26] [config] bert-class-symbol: "[CLS]"
[2023-07-22 06:08:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 06:08:26] [config] bert-masking-fraction: 0.15
[2023-07-22 06:08:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 06:08:26] [config] bert-train-type-embeddings: true
[2023-07-22 06:08:26] [config] bert-type-vocab-size: 2
[2023-07-22 06:08:26] [config] build-info: ""
[2023-07-22 06:08:26] [config] check-gradient-nan: false
[2023-07-22 06:08:26] [config] check-nan: false
[2023-07-22 06:08:26] [config] cite: false
[2023-07-22 06:08:26] [config] clip-norm: 1
[2023-07-22 06:08:26] [config] cost-scaling:
[2023-07-22 06:08:26] [config]   - 256.f
[2023-07-22 06:08:26] [config]   - 1000
[2023-07-22 06:08:26] [config]   - 2.f
[2023-07-22 06:08:26] [config]   - 256.f
[2023-07-22 06:08:26] [config] cost-type: ce-sum
[2023-07-22 06:08:26] [config] cpu-threads: 0
[2023-07-22 06:08:26] [config] data-threads: 8
[2023-07-22 06:08:26] [config] data-weighting: ""
[2023-07-22 06:08:26] [config] data-weighting-type: sentence
[2023-07-22 06:08:26] [config] dec-cell: gru
[2023-07-22 06:08:26] [config] dec-cell-base-depth: 2
[2023-07-22 06:08:26] [config] dec-cell-high-depth: 1
[2023-07-22 06:08:26] [config] dec-depth: 1
[2023-07-22 06:08:26] [config] devices:
[2023-07-22 06:08:26] [config]   - 0
[2023-07-22 06:08:26] [config] dim-emb: 512
[2023-07-22 06:08:26] [config] dim-rnn: 1024
[2023-07-22 06:08:26] [config] dim-vocabs:
[2023-07-22 06:08:26] [config]   - 16384
[2023-07-22 06:08:26] [config]   - 16384
[2023-07-22 06:08:26] [config] disp-first: 0
[2023-07-22 06:08:26] [config] disp-freq: 1000u
[2023-07-22 06:08:26] [config] disp-label-counts: true
[2023-07-22 06:08:26] [config] dropout-rnn: 0
[2023-07-22 06:08:26] [config] dropout-src: 0
[2023-07-22 06:08:26] [config] dropout-trg: 0
[2023-07-22 06:08:26] [config] dump-config: ""
[2023-07-22 06:08:26] [config] dynamic-gradient-scaling:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] early-stopping: 200
[2023-07-22 06:08:26] [config] early-stopping-on: first
[2023-07-22 06:08:26] [config] embedding-fix-src: false
[2023-07-22 06:08:26] [config] embedding-fix-trg: false
[2023-07-22 06:08:26] [config] embedding-normalization: false
[2023-07-22 06:08:26] [config] embedding-vectors:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] enc-cell: gru
[2023-07-22 06:08:26] [config] enc-cell-depth: 1
[2023-07-22 06:08:26] [config] enc-depth: 1
[2023-07-22 06:08:26] [config] enc-type: bidirectional
[2023-07-22 06:08:26] [config] english-title-case-every: 0
[2023-07-22 06:08:26] [config] exponential-smoothing: 0
[2023-07-22 06:08:26] [config] factor-weight: 1
[2023-07-22 06:08:26] [config] factors-combine: sum
[2023-07-22 06:08:26] [config] factors-dim-emb: 0
[2023-07-22 06:08:26] [config] gradient-checkpointing: false
[2023-07-22 06:08:26] [config] gradient-norm-average-window: 100
[2023-07-22 06:08:26] [config] guided-alignment: none
[2023-07-22 06:08:26] [config] guided-alignment-cost: mse
[2023-07-22 06:08:26] [config] guided-alignment-weight: 0.1
[2023-07-22 06:08:26] [config] ignore-model-config: false
[2023-07-22 06:08:26] [config] input-types:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] interpolate-env-vars: false
[2023-07-22 06:08:26] [config] keep-best: false
[2023-07-22 06:08:26] [config] label-smoothing: 0
[2023-07-22 06:08:26] [config] layer-normalization: false
[2023-07-22 06:08:26] [config] learn-rate: 0.0001
[2023-07-22 06:08:26] [config] lemma-dependency: ""
[2023-07-22 06:08:26] [config] lemma-dim-emb: 0
[2023-07-22 06:08:26] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 06:08:26] [config] log-level: info
[2023-07-22 06:08:26] [config] log-time-zone: ""
[2023-07-22 06:08:26] [config] logical-epoch:
[2023-07-22 06:08:26] [config]   - 1e
[2023-07-22 06:08:26] [config]   - 0
[2023-07-22 06:08:26] [config] lr-decay: 0
[2023-07-22 06:08:26] [config] lr-decay-freq: 50000
[2023-07-22 06:08:26] [config] lr-decay-inv-sqrt:
[2023-07-22 06:08:26] [config]   - 0
[2023-07-22 06:08:26] [config] lr-decay-repeat-warmup: false
[2023-07-22 06:08:26] [config] lr-decay-reset-optimizer: false
[2023-07-22 06:08:26] [config] lr-decay-start:
[2023-07-22 06:08:26] [config]   - 10
[2023-07-22 06:08:26] [config]   - 1
[2023-07-22 06:08:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 06:08:26] [config] lr-report: false
[2023-07-22 06:08:26] [config] lr-warmup: 0
[2023-07-22 06:08:26] [config] lr-warmup-at-reload: false
[2023-07-22 06:08:26] [config] lr-warmup-cycle: false
[2023-07-22 06:08:26] [config] lr-warmup-start-rate: 0
[2023-07-22 06:08:26] [config] max-length: 150
[2023-07-22 06:08:26] [config] max-length-crop: true
[2023-07-22 06:08:26] [config] max-length-factor: 3
[2023-07-22 06:08:26] [config] maxi-batch: 100
[2023-07-22 06:08:26] [config] maxi-batch-sort: trg
[2023-07-22 06:08:26] [config] mini-batch: 64
[2023-07-22 06:08:26] [config] mini-batch-fit: true
[2023-07-22 06:08:26] [config] mini-batch-fit-step: 10
[2023-07-22 06:08:26] [config] mini-batch-round-up: true
[2023-07-22 06:08:26] [config] mini-batch-track-lr: false
[2023-07-22 06:08:26] [config] mini-batch-warmup: 0
[2023-07-22 06:08:26] [config] mini-batch-words: 0
[2023-07-22 06:08:26] [config] mini-batch-words-ref: 0
[2023-07-22 06:08:26] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 06:08:26] [config] multi-loss-type: sum
[2023-07-22 06:08:26] [config] n-best: false
[2023-07-22 06:08:26] [config] no-nccl: false
[2023-07-22 06:08:26] [config] no-reload: false
[2023-07-22 06:08:26] [config] no-restore-corpus: false
[2023-07-22 06:08:26] [config] normalize: 0
[2023-07-22 06:08:26] [config] normalize-gradient: false
[2023-07-22 06:08:26] [config] num-devices: 0
[2023-07-22 06:08:26] [config] optimizer: adam
[2023-07-22 06:08:26] [config] optimizer-delay: 1
[2023-07-22 06:08:26] [config] optimizer-params:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] output-omit-bias: false
[2023-07-22 06:08:26] [config] overwrite: true
[2023-07-22 06:08:26] [config] precision:
[2023-07-22 06:08:26] [config]   - float16
[2023-07-22 06:08:26] [config]   - float32
[2023-07-22 06:08:26] [config] pretrained-model: ""
[2023-07-22 06:08:26] [config] quantize-biases: false
[2023-07-22 06:08:26] [config] quantize-bits: 0
[2023-07-22 06:08:26] [config] quantize-log-based: false
[2023-07-22 06:08:26] [config] quantize-optimization-steps: 0
[2023-07-22 06:08:26] [config] quiet: false
[2023-07-22 06:08:26] [config] quiet-translation: true
[2023-07-22 06:08:26] [config] relative-paths: false
[2023-07-22 06:08:26] [config] right-left: false
[2023-07-22 06:08:26] [config] save-freq: 10000u
[2023-07-22 06:08:26] [config] seed: 1234
[2023-07-22 06:08:26] [config] sentencepiece-alphas:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] sentencepiece-max-lines: 2000000
[2023-07-22 06:08:26] [config] sentencepiece-options: ""
[2023-07-22 06:08:26] [config] sharding: global
[2023-07-22 06:08:26] [config] shuffle: data
[2023-07-22 06:08:26] [config] shuffle-in-ram: false
[2023-07-22 06:08:26] [config] sigterm: save-and-exit
[2023-07-22 06:08:26] [config] skip: false
[2023-07-22 06:08:26] [config] sqlite: ""
[2023-07-22 06:08:26] [config] sqlite-drop: false
[2023-07-22 06:08:26] [config] sync-freq: 200u
[2023-07-22 06:08:26] [config] sync-sgd: false
[2023-07-22 06:08:26] [config] tempdir: /tmp
[2023-07-22 06:08:26] [config] tied-embeddings: false
[2023-07-22 06:08:26] [config] tied-embeddings-all: true
[2023-07-22 06:08:26] [config] tied-embeddings-src: false
[2023-07-22 06:08:26] [config] train-embedder-rank:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] train-sets:
[2023-07-22 06:08:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 06:08:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 06:08:26] [config] transformer-aan-activation: swish
[2023-07-22 06:08:26] [config] transformer-aan-depth: 2
[2023-07-22 06:08:26] [config] transformer-aan-nogate: false
[2023-07-22 06:08:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 06:08:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 06:08:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 06:08:26] [config] transformer-depth-scaling: false
[2023-07-22 06:08:26] [config] transformer-dim-aan: 2048
[2023-07-22 06:08:26] [config] transformer-dim-ffn: 2048
[2023-07-22 06:08:26] [config] transformer-dropout: 0
[2023-07-22 06:08:26] [config] transformer-dropout-attention: 0
[2023-07-22 06:08:26] [config] transformer-dropout-ffn: 0
[2023-07-22 06:08:26] [config] transformer-ffn-activation: swish
[2023-07-22 06:08:26] [config] transformer-ffn-depth: 2
[2023-07-22 06:08:26] [config] transformer-guided-alignment-layer: last
[2023-07-22 06:08:26] [config] transformer-heads: 8
[2023-07-22 06:08:26] [config] transformer-no-projection: false
[2023-07-22 06:08:26] [config] transformer-pool: false
[2023-07-22 06:08:26] [config] transformer-postprocess: dan
[2023-07-22 06:08:26] [config] transformer-postprocess-emb: d
[2023-07-22 06:08:26] [config] transformer-postprocess-top: ""
[2023-07-22 06:08:26] [config] transformer-preprocess: ""
[2023-07-22 06:08:26] [config] transformer-tied-layers:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] transformer-train-position-embeddings: false
[2023-07-22 06:08:26] [config] tsv: false
[2023-07-22 06:08:26] [config] tsv-fields: 0
[2023-07-22 06:08:26] [config] type: amun
[2023-07-22 06:08:26] [config] ulr: false
[2023-07-22 06:08:26] [config] ulr-dim-emb: 0
[2023-07-22 06:08:26] [config] ulr-dropout: 0
[2023-07-22 06:08:26] [config] ulr-keys-vectors: ""
[2023-07-22 06:08:26] [config] ulr-query-vectors: ""
[2023-07-22 06:08:26] [config] ulr-softmax-temperature: 1
[2023-07-22 06:08:26] [config] ulr-trainable-transformation: false
[2023-07-22 06:08:26] [config] unlikelihood-loss: false
[2023-07-22 06:08:26] [config] valid-freq: 50000000
[2023-07-22 06:08:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 06:08:26] [config] valid-max-length: 1000
[2023-07-22 06:08:26] [config] valid-metrics:
[2023-07-22 06:08:26] [config]   - cross-entropy
[2023-07-22 06:08:26] [config]   - translation
[2023-07-22 06:08:26] [config] valid-mini-batch: 32
[2023-07-22 06:08:26] [config] valid-reset-stalled: false
[2023-07-22 06:08:26] [config] valid-script-args:
[2023-07-22 06:08:26] [config]   []
[2023-07-22 06:08:26] [config] valid-script-path: ""
[2023-07-22 06:08:26] [config] valid-sets:
[2023-07-22 06:08:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 06:08:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 06:08:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 06:08:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:08:26] [config] vocabs:
[2023-07-22 06:08:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:08:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:08:26] [config] word-penalty: 0
[2023-07-22 06:08:26] [config] word-scores: false
[2023-07-22 06:08:26] [config] workspace: 5500
[2023-07-22 06:08:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:08:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:08:26] [training] Using single-device training
[2023-07-22 06:08:28] Synced seed 1234
[2023-07-22 06:08:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:08:28] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 06:08:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:08:28] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 06:08:28] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 06:08:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:08:28] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 06:08:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 06:08:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 06:08:30] [comm] Using global sharding
[2023-07-22 06:08:30] [comm] NCCLCommunicators constructed successfully
[2023-07-22 06:08:30] [training] Using 1 GPUs
[2023-07-22 06:08:30] [logits] Applying loss function for 1 factor(s)
[2023-07-22 06:08:30] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:08:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 06:08:30] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:34:36] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 06:34:36] [valid] No post-processing script given for validating translator
[2023-07-22 06:34:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:34:36] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 06:34:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 06:34:36] [comm] Using global sharding
[2023-07-22 06:34:36] [comm] NCCLCommunicators constructed successfully
[2023-07-22 06:34:36] [training] Using 1 GPUs
[2023-07-22 06:34:36] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 06:34:43] Allocating memory for general optimizer shards
[2023-07-22 06:34:43] [memory] Reserving 322 MB, device gpu0
[2023-07-22 06:34:43] Loading Adam parameters
[2023-07-22 06:34:43] [memory] Reserving 322 MB, device gpu0
[2023-07-22 06:34:44] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:34:44] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 06:34:44] [data] Restoring the corpus state to epoch 101, batch 4381
[2023-07-22 06:34:44] [data] Shuffling data
[2023-07-22 06:34:44] [data] Done reading 20,192 sentences
[2023-07-22 06:34:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:34:44] Training started
[2023-07-22 06:34:44] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 06:34:44] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:34:46] Parameter type float16, optimization type float32, casting types true
[2023-07-22 06:39:16] Seen 20,192 samples
[2023-07-22 06:39:16] Starting data epoch 102 in logical epoch 102
[2023-07-22 06:39:16] [data] Shuffling data
[2023-07-22 06:39:16] [data] Done reading 20,192 sentences
[2023-07-22 06:39:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:43:34] Seen 20,192 samples
[2023-07-22 06:43:34] Starting data epoch 103 in logical epoch 103
[2023-07-22 06:43:34] [data] Shuffling data
[2023-07-22 06:43:34] [data] Done reading 20,192 sentences
[2023-07-22 06:43:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:47:57] Seen 20,192 samples
[2023-07-22 06:47:57] Starting data epoch 104 in logical epoch 104
[2023-07-22 06:47:57] [data] Shuffling data
[2023-07-22 06:47:57] [data] Done reading 20,192 sentences
[2023-07-22 06:47:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:52:30] Seen 20,192 samples
[2023-07-22 06:52:30] Starting data epoch 105 in logical epoch 105
[2023-07-22 06:52:30] [data] Shuffling data
[2023-07-22 06:52:30] [data] Done reading 20,192 sentences
[2023-07-22 06:52:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:56:47] Seen 20,192 samples
[2023-07-22 06:56:47] Starting data epoch 106 in logical epoch 106
[2023-07-22 06:56:47] [data] Shuffling data
[2023-07-22 06:56:47] [data] Done reading 20,192 sentences
[2023-07-22 06:56:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:01:13] Seen 20,192 samples
[2023-07-22 07:01:13] Starting data epoch 107 in logical epoch 107
[2023-07-22 07:01:13] [data] Shuffling data
[2023-07-22 07:01:13] [data] Done reading 20,192 sentences
[2023-07-22 07:01:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:05:39] Seen 20,192 samples
[2023-07-22 07:05:39] Starting data epoch 108 in logical epoch 108
[2023-07-22 07:05:39] [data] Shuffling data
[2023-07-22 07:05:39] [data] Done reading 20,192 sentences
[2023-07-22 07:05:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:10:29] Seen 20,192 samples
[2023-07-22 07:10:29] Starting data epoch 109 in logical epoch 109
[2023-07-22 07:10:29] [data] Shuffling data
[2023-07-22 07:10:29] [data] Done reading 20,192 sentences
[2023-07-22 07:10:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:15:16] Seen 20,192 samples
[2023-07-22 07:15:16] Starting data epoch 110 in logical epoch 110
[2023-07-22 07:15:16] [data] Shuffling data
[2023-07-22 07:15:16] [data] Done reading 20,192 sentences
[2023-07-22 07:15:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:19:57] Seen 20,192 samples
[2023-07-22 07:19:57] Starting data epoch 111 in logical epoch 111
[2023-07-22 07:19:57] Training finished
[2023-07-22 07:20:07] [valid] Ep. 111 : Up. 4819 : cross-entropy : 131.199 : new best
[2023-07-22 07:23:27] [valid] Ep. 111 : Up. 4819 : translation : 0 : new best
[2023-07-22 07:23:27] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 07:23:29] Saving Adam parameters
[2023-07-22 07:23:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 07:23:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 07:23:37] [marian] Running on node22.datos.cluster.uy as process 23562 with command line:
[2023-07-22 07:23:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 07:23:37] [config] after: 0e
[2023-07-22 07:23:37] [config] after-batches: 0
[2023-07-22 07:23:37] [config] after-epochs: 120
[2023-07-22 07:23:37] [config] all-caps-every: 0
[2023-07-22 07:23:37] [config] allow-unk: false
[2023-07-22 07:23:37] [config] authors: false
[2023-07-22 07:23:37] [config] beam-size: 12
[2023-07-22 07:23:37] [config] bert-class-symbol: "[CLS]"
[2023-07-22 07:23:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 07:23:37] [config] bert-masking-fraction: 0.15
[2023-07-22 07:23:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 07:23:37] [config] bert-train-type-embeddings: true
[2023-07-22 07:23:37] [config] bert-type-vocab-size: 2
[2023-07-22 07:23:37] [config] build-info: ""
[2023-07-22 07:23:37] [config] check-gradient-nan: false
[2023-07-22 07:23:37] [config] check-nan: false
[2023-07-22 07:23:37] [config] cite: false
[2023-07-22 07:23:37] [config] clip-norm: 1
[2023-07-22 07:23:37] [config] cost-scaling:
[2023-07-22 07:23:37] [config]   - 256.f
[2023-07-22 07:23:37] [config]   - 1000
[2023-07-22 07:23:37] [config]   - 2.f
[2023-07-22 07:23:37] [config]   - 256.f
[2023-07-22 07:23:37] [config] cost-type: ce-sum
[2023-07-22 07:23:37] [config] cpu-threads: 0
[2023-07-22 07:23:37] [config] data-threads: 8
[2023-07-22 07:23:37] [config] data-weighting: ""
[2023-07-22 07:23:37] [config] data-weighting-type: sentence
[2023-07-22 07:23:37] [config] dec-cell: gru
[2023-07-22 07:23:37] [config] dec-cell-base-depth: 2
[2023-07-22 07:23:37] [config] dec-cell-high-depth: 1
[2023-07-22 07:23:37] [config] dec-depth: 1
[2023-07-22 07:23:37] [config] devices:
[2023-07-22 07:23:37] [config]   - 0
[2023-07-22 07:23:37] [config] dim-emb: 512
[2023-07-22 07:23:37] [config] dim-rnn: 1024
[2023-07-22 07:23:37] [config] dim-vocabs:
[2023-07-22 07:23:37] [config]   - 16384
[2023-07-22 07:23:37] [config]   - 16384
[2023-07-22 07:23:37] [config] disp-first: 0
[2023-07-22 07:23:37] [config] disp-freq: 1000u
[2023-07-22 07:23:37] [config] disp-label-counts: true
[2023-07-22 07:23:37] [config] dropout-rnn: 0
[2023-07-22 07:23:37] [config] dropout-src: 0
[2023-07-22 07:23:37] [config] dropout-trg: 0
[2023-07-22 07:23:37] [config] dump-config: ""
[2023-07-22 07:23:37] [config] dynamic-gradient-scaling:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] early-stopping: 200
[2023-07-22 07:23:37] [config] early-stopping-on: first
[2023-07-22 07:23:37] [config] embedding-fix-src: false
[2023-07-22 07:23:37] [config] embedding-fix-trg: false
[2023-07-22 07:23:37] [config] embedding-normalization: false
[2023-07-22 07:23:37] [config] embedding-vectors:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] enc-cell: gru
[2023-07-22 07:23:37] [config] enc-cell-depth: 1
[2023-07-22 07:23:37] [config] enc-depth: 1
[2023-07-22 07:23:37] [config] enc-type: bidirectional
[2023-07-22 07:23:37] [config] english-title-case-every: 0
[2023-07-22 07:23:37] [config] exponential-smoothing: 0
[2023-07-22 07:23:37] [config] factor-weight: 1
[2023-07-22 07:23:37] [config] factors-combine: sum
[2023-07-22 07:23:37] [config] factors-dim-emb: 0
[2023-07-22 07:23:37] [config] gradient-checkpointing: false
[2023-07-22 07:23:37] [config] gradient-norm-average-window: 100
[2023-07-22 07:23:37] [config] guided-alignment: none
[2023-07-22 07:23:37] [config] guided-alignment-cost: mse
[2023-07-22 07:23:37] [config] guided-alignment-weight: 0.1
[2023-07-22 07:23:37] [config] ignore-model-config: false
[2023-07-22 07:23:37] [config] input-types:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] interpolate-env-vars: false
[2023-07-22 07:23:37] [config] keep-best: false
[2023-07-22 07:23:37] [config] label-smoothing: 0
[2023-07-22 07:23:37] [config] layer-normalization: false
[2023-07-22 07:23:37] [config] learn-rate: 0.0001
[2023-07-22 07:23:37] [config] lemma-dependency: ""
[2023-07-22 07:23:37] [config] lemma-dim-emb: 0
[2023-07-22 07:23:37] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 07:23:37] [config] log-level: info
[2023-07-22 07:23:37] [config] log-time-zone: ""
[2023-07-22 07:23:37] [config] logical-epoch:
[2023-07-22 07:23:37] [config]   - 1e
[2023-07-22 07:23:37] [config]   - 0
[2023-07-22 07:23:37] [config] lr-decay: 0
[2023-07-22 07:23:37] [config] lr-decay-freq: 50000
[2023-07-22 07:23:37] [config] lr-decay-inv-sqrt:
[2023-07-22 07:23:37] [config]   - 0
[2023-07-22 07:23:37] [config] lr-decay-repeat-warmup: false
[2023-07-22 07:23:37] [config] lr-decay-reset-optimizer: false
[2023-07-22 07:23:37] [config] lr-decay-start:
[2023-07-22 07:23:37] [config]   - 10
[2023-07-22 07:23:37] [config]   - 1
[2023-07-22 07:23:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 07:23:37] [config] lr-report: false
[2023-07-22 07:23:37] [config] lr-warmup: 0
[2023-07-22 07:23:37] [config] lr-warmup-at-reload: false
[2023-07-22 07:23:37] [config] lr-warmup-cycle: false
[2023-07-22 07:23:37] [config] lr-warmup-start-rate: 0
[2023-07-22 07:23:37] [config] max-length: 150
[2023-07-22 07:23:37] [config] max-length-crop: true
[2023-07-22 07:23:37] [config] max-length-factor: 3
[2023-07-22 07:23:37] [config] maxi-batch: 100
[2023-07-22 07:23:37] [config] maxi-batch-sort: trg
[2023-07-22 07:23:37] [config] mini-batch: 64
[2023-07-22 07:23:37] [config] mini-batch-fit: true
[2023-07-22 07:23:37] [config] mini-batch-fit-step: 10
[2023-07-22 07:23:37] [config] mini-batch-round-up: true
[2023-07-22 07:23:37] [config] mini-batch-track-lr: false
[2023-07-22 07:23:37] [config] mini-batch-warmup: 0
[2023-07-22 07:23:37] [config] mini-batch-words: 0
[2023-07-22 07:23:37] [config] mini-batch-words-ref: 0
[2023-07-22 07:23:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 07:23:37] [config] multi-loss-type: sum
[2023-07-22 07:23:37] [config] n-best: false
[2023-07-22 07:23:37] [config] no-nccl: false
[2023-07-22 07:23:37] [config] no-reload: false
[2023-07-22 07:23:37] [config] no-restore-corpus: false
[2023-07-22 07:23:37] [config] normalize: 0
[2023-07-22 07:23:37] [config] normalize-gradient: false
[2023-07-22 07:23:37] [config] num-devices: 0
[2023-07-22 07:23:37] [config] optimizer: adam
[2023-07-22 07:23:37] [config] optimizer-delay: 1
[2023-07-22 07:23:37] [config] optimizer-params:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] output-omit-bias: false
[2023-07-22 07:23:37] [config] overwrite: true
[2023-07-22 07:23:37] [config] precision:
[2023-07-22 07:23:37] [config]   - float16
[2023-07-22 07:23:37] [config]   - float32
[2023-07-22 07:23:37] [config] pretrained-model: ""
[2023-07-22 07:23:37] [config] quantize-biases: false
[2023-07-22 07:23:37] [config] quantize-bits: 0
[2023-07-22 07:23:37] [config] quantize-log-based: false
[2023-07-22 07:23:37] [config] quantize-optimization-steps: 0
[2023-07-22 07:23:37] [config] quiet: false
[2023-07-22 07:23:37] [config] quiet-translation: true
[2023-07-22 07:23:37] [config] relative-paths: false
[2023-07-22 07:23:37] [config] right-left: false
[2023-07-22 07:23:37] [config] save-freq: 10000u
[2023-07-22 07:23:37] [config] seed: 1234
[2023-07-22 07:23:37] [config] sentencepiece-alphas:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] sentencepiece-max-lines: 2000000
[2023-07-22 07:23:37] [config] sentencepiece-options: ""
[2023-07-22 07:23:37] [config] sharding: global
[2023-07-22 07:23:37] [config] shuffle: data
[2023-07-22 07:23:37] [config] shuffle-in-ram: false
[2023-07-22 07:23:37] [config] sigterm: save-and-exit
[2023-07-22 07:23:37] [config] skip: false
[2023-07-22 07:23:37] [config] sqlite: ""
[2023-07-22 07:23:37] [config] sqlite-drop: false
[2023-07-22 07:23:37] [config] sync-freq: 200u
[2023-07-22 07:23:37] [config] sync-sgd: false
[2023-07-22 07:23:37] [config] tempdir: /tmp
[2023-07-22 07:23:37] [config] tied-embeddings: false
[2023-07-22 07:23:37] [config] tied-embeddings-all: true
[2023-07-22 07:23:37] [config] tied-embeddings-src: false
[2023-07-22 07:23:37] [config] train-embedder-rank:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] train-sets:
[2023-07-22 07:23:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 07:23:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 07:23:37] [config] transformer-aan-activation: swish
[2023-07-22 07:23:37] [config] transformer-aan-depth: 2
[2023-07-22 07:23:37] [config] transformer-aan-nogate: false
[2023-07-22 07:23:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 07:23:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 07:23:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 07:23:37] [config] transformer-depth-scaling: false
[2023-07-22 07:23:37] [config] transformer-dim-aan: 2048
[2023-07-22 07:23:37] [config] transformer-dim-ffn: 2048
[2023-07-22 07:23:37] [config] transformer-dropout: 0
[2023-07-22 07:23:37] [config] transformer-dropout-attention: 0
[2023-07-22 07:23:37] [config] transformer-dropout-ffn: 0
[2023-07-22 07:23:37] [config] transformer-ffn-activation: swish
[2023-07-22 07:23:37] [config] transformer-ffn-depth: 2
[2023-07-22 07:23:37] [config] transformer-guided-alignment-layer: last
[2023-07-22 07:23:37] [config] transformer-heads: 8
[2023-07-22 07:23:37] [config] transformer-no-projection: false
[2023-07-22 07:23:37] [config] transformer-pool: false
[2023-07-22 07:23:37] [config] transformer-postprocess: dan
[2023-07-22 07:23:37] [config] transformer-postprocess-emb: d
[2023-07-22 07:23:37] [config] transformer-postprocess-top: ""
[2023-07-22 07:23:37] [config] transformer-preprocess: ""
[2023-07-22 07:23:37] [config] transformer-tied-layers:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] transformer-train-position-embeddings: false
[2023-07-22 07:23:37] [config] tsv: false
[2023-07-22 07:23:37] [config] tsv-fields: 0
[2023-07-22 07:23:37] [config] type: amun
[2023-07-22 07:23:37] [config] ulr: false
[2023-07-22 07:23:37] [config] ulr-dim-emb: 0
[2023-07-22 07:23:37] [config] ulr-dropout: 0
[2023-07-22 07:23:37] [config] ulr-keys-vectors: ""
[2023-07-22 07:23:37] [config] ulr-query-vectors: ""
[2023-07-22 07:23:37] [config] ulr-softmax-temperature: 1
[2023-07-22 07:23:37] [config] ulr-trainable-transformation: false
[2023-07-22 07:23:37] [config] unlikelihood-loss: false
[2023-07-22 07:23:37] [config] valid-freq: 50000000
[2023-07-22 07:23:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 07:23:37] [config] valid-max-length: 1000
[2023-07-22 07:23:37] [config] valid-metrics:
[2023-07-22 07:23:37] [config]   - cross-entropy
[2023-07-22 07:23:37] [config]   - translation
[2023-07-22 07:23:37] [config] valid-mini-batch: 32
[2023-07-22 07:23:37] [config] valid-reset-stalled: false
[2023-07-22 07:23:37] [config] valid-script-args:
[2023-07-22 07:23:37] [config]   []
[2023-07-22 07:23:37] [config] valid-script-path: ""
[2023-07-22 07:23:37] [config] valid-sets:
[2023-07-22 07:23:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 07:23:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 07:23:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 07:23:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 07:23:37] [config] vocabs:
[2023-07-22 07:23:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 07:23:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 07:23:37] [config] word-penalty: 0
[2023-07-22 07:23:37] [config] word-scores: false
[2023-07-22 07:23:37] [config] workspace: 5500
[2023-07-22 07:23:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 07:23:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:23:37] [training] Using single-device training
[2023-07-22 07:23:38] Synced seed 1234
[2023-07-22 07:23:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 07:23:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 07:23:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 07:23:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 07:23:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 07:23:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:23:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 07:23:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 07:23:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 07:23:39] [comm] Using global sharding
[2023-07-22 07:23:39] [comm] NCCLCommunicators constructed successfully
[2023-07-22 07:23:39] [training] Using 1 GPUs
[2023-07-22 07:23:39] [logits] Applying loss function for 1 factor(s)
[2023-07-22 07:23:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:23:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 07:23:40] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:50:24] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 07:50:25] [valid] No post-processing script given for validating translator
[2023-07-22 07:50:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:50:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 07:50:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 07:50:25] [comm] Using global sharding
[2023-07-22 07:50:25] [comm] NCCLCommunicators constructed successfully
[2023-07-22 07:50:25] [training] Using 1 GPUs
[2023-07-22 07:50:25] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 07:50:31] Allocating memory for general optimizer shards
[2023-07-22 07:50:31] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:50:31] Loading Adam parameters
[2023-07-22 07:50:31] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:50:31] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:50:32] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 07:50:32] [data] Restoring the corpus state to epoch 111, batch 4819
[2023-07-22 07:50:32] [data] Shuffling data
[2023-07-22 07:50:32] [data] Done reading 20,192 sentences
[2023-07-22 07:50:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:50:32] Training started
[2023-07-22 07:50:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 07:50:32] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:50:32] Parameter type float16, optimization type float32, casting types true
[2023-07-22 07:54:47] Seen 20,192 samples
[2023-07-22 07:54:47] Starting data epoch 112 in logical epoch 112
[2023-07-22 07:54:47] [data] Shuffling data
[2023-07-22 07:54:47] [data] Done reading 20,192 sentences
[2023-07-22 07:54:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:59:12] Seen 20,192 samples
[2023-07-22 07:59:12] Starting data epoch 113 in logical epoch 113
[2023-07-22 07:59:12] [data] Shuffling data
[2023-07-22 07:59:12] [data] Done reading 20,192 sentences
[2023-07-22 07:59:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:03:53] Seen 20,192 samples
[2023-07-22 08:03:53] Starting data epoch 114 in logical epoch 114
[2023-07-22 08:03:53] [data] Shuffling data
[2023-07-22 08:03:53] [data] Done reading 20,192 sentences
[2023-07-22 08:03:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:08:47] Seen 20,192 samples
[2023-07-22 08:08:47] Starting data epoch 115 in logical epoch 115
[2023-07-22 08:08:47] [data] Shuffling data
[2023-07-22 08:08:47] [data] Done reading 20,192 sentences
[2023-07-22 08:08:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:09:25] Ep. 115 : Up. 5000 : Sen. 2,104 : Cost 4.00465393 * 12,418,547 @ 9,527 after 62,064,817 : Time 1140.14s : 10892.12 words/s : gNorm 1.2023
[2023-07-22 08:13:22] Seen 20,192 samples
[2023-07-22 08:13:22] Starting data epoch 116 in logical epoch 116
[2023-07-22 08:13:22] [data] Shuffling data
[2023-07-22 08:13:23] [data] Done reading 20,192 sentences
[2023-07-22 08:13:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:17:50] Seen 20,192 samples
[2023-07-22 08:17:50] Starting data epoch 117 in logical epoch 117
[2023-07-22 08:17:50] [data] Shuffling data
[2023-07-22 08:17:50] [data] Done reading 20,192 sentences
[2023-07-22 08:17:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:22:25] Seen 20,192 samples
[2023-07-22 08:22:25] Starting data epoch 118 in logical epoch 118
[2023-07-22 08:22:25] [data] Shuffling data
[2023-07-22 08:22:25] [data] Done reading 20,192 sentences
[2023-07-22 08:22:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:27:02] Seen 20,192 samples
[2023-07-22 08:27:02] Starting data epoch 119 in logical epoch 119
[2023-07-22 08:27:02] [data] Shuffling data
[2023-07-22 08:27:02] [data] Done reading 20,192 sentences
[2023-07-22 08:27:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:31:30] Seen 20,192 samples
[2023-07-22 08:31:30] Starting data epoch 120 in logical epoch 120
[2023-07-22 08:31:30] [data] Shuffling data
[2023-07-22 08:31:30] [data] Done reading 20,192 sentences
[2023-07-22 08:31:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:36:15] Seen 20,192 samples
[2023-07-22 08:36:15] Starting data epoch 121 in logical epoch 121
[2023-07-22 08:36:15] Training finished
[2023-07-22 08:36:27] [valid] Ep. 121 : Up. 5257 : cross-entropy : 131.636 : stalled 1 times (last best: 131.199)
[2023-07-22 08:39:31] [valid] Ep. 121 : Up. 5257 : translation : 0 : new best
[2023-07-22 08:39:31] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 08:39:33] Saving Adam parameters
[2023-07-22 08:39:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 08:39:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:39:40] [marian] Running on node22.datos.cluster.uy as process 28572 with command line:
[2023-07-22 08:39:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 08:39:40] [config] after: 0e
[2023-07-22 08:39:40] [config] after-batches: 0
[2023-07-22 08:39:40] [config] after-epochs: 130
[2023-07-22 08:39:40] [config] all-caps-every: 0
[2023-07-22 08:39:40] [config] allow-unk: false
[2023-07-22 08:39:40] [config] authors: false
[2023-07-22 08:39:40] [config] beam-size: 12
[2023-07-22 08:39:40] [config] bert-class-symbol: "[CLS]"
[2023-07-22 08:39:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 08:39:40] [config] bert-masking-fraction: 0.15
[2023-07-22 08:39:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 08:39:40] [config] bert-train-type-embeddings: true
[2023-07-22 08:39:40] [config] bert-type-vocab-size: 2
[2023-07-22 08:39:40] [config] build-info: ""
[2023-07-22 08:39:40] [config] check-gradient-nan: false
[2023-07-22 08:39:40] [config] check-nan: false
[2023-07-22 08:39:40] [config] cite: false
[2023-07-22 08:39:40] [config] clip-norm: 1
[2023-07-22 08:39:40] [config] cost-scaling:
[2023-07-22 08:39:40] [config]   - 256.f
[2023-07-22 08:39:40] [config]   - 1000
[2023-07-22 08:39:40] [config]   - 2.f
[2023-07-22 08:39:40] [config]   - 256.f
[2023-07-22 08:39:40] [config] cost-type: ce-sum
[2023-07-22 08:39:40] [config] cpu-threads: 0
[2023-07-22 08:39:40] [config] data-threads: 8
[2023-07-22 08:39:40] [config] data-weighting: ""
[2023-07-22 08:39:40] [config] data-weighting-type: sentence
[2023-07-22 08:39:40] [config] dec-cell: gru
[2023-07-22 08:39:40] [config] dec-cell-base-depth: 2
[2023-07-22 08:39:40] [config] dec-cell-high-depth: 1
[2023-07-22 08:39:40] [config] dec-depth: 1
[2023-07-22 08:39:40] [config] devices:
[2023-07-22 08:39:40] [config]   - 0
[2023-07-22 08:39:40] [config] dim-emb: 512
[2023-07-22 08:39:40] [config] dim-rnn: 1024
[2023-07-22 08:39:40] [config] dim-vocabs:
[2023-07-22 08:39:40] [config]   - 16384
[2023-07-22 08:39:40] [config]   - 16384
[2023-07-22 08:39:40] [config] disp-first: 0
[2023-07-22 08:39:40] [config] disp-freq: 1000u
[2023-07-22 08:39:40] [config] disp-label-counts: true
[2023-07-22 08:39:40] [config] dropout-rnn: 0
[2023-07-22 08:39:40] [config] dropout-src: 0
[2023-07-22 08:39:40] [config] dropout-trg: 0
[2023-07-22 08:39:40] [config] dump-config: ""
[2023-07-22 08:39:40] [config] dynamic-gradient-scaling:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] early-stopping: 200
[2023-07-22 08:39:40] [config] early-stopping-on: first
[2023-07-22 08:39:40] [config] embedding-fix-src: false
[2023-07-22 08:39:40] [config] embedding-fix-trg: false
[2023-07-22 08:39:40] [config] embedding-normalization: false
[2023-07-22 08:39:40] [config] embedding-vectors:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] enc-cell: gru
[2023-07-22 08:39:40] [config] enc-cell-depth: 1
[2023-07-22 08:39:40] [config] enc-depth: 1
[2023-07-22 08:39:40] [config] enc-type: bidirectional
[2023-07-22 08:39:40] [config] english-title-case-every: 0
[2023-07-22 08:39:40] [config] exponential-smoothing: 0
[2023-07-22 08:39:40] [config] factor-weight: 1
[2023-07-22 08:39:40] [config] factors-combine: sum
[2023-07-22 08:39:40] [config] factors-dim-emb: 0
[2023-07-22 08:39:40] [config] gradient-checkpointing: false
[2023-07-22 08:39:40] [config] gradient-norm-average-window: 100
[2023-07-22 08:39:40] [config] guided-alignment: none
[2023-07-22 08:39:40] [config] guided-alignment-cost: mse
[2023-07-22 08:39:40] [config] guided-alignment-weight: 0.1
[2023-07-22 08:39:40] [config] ignore-model-config: false
[2023-07-22 08:39:40] [config] input-types:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] interpolate-env-vars: false
[2023-07-22 08:39:40] [config] keep-best: false
[2023-07-22 08:39:40] [config] label-smoothing: 0
[2023-07-22 08:39:40] [config] layer-normalization: false
[2023-07-22 08:39:40] [config] learn-rate: 0.0001
[2023-07-22 08:39:40] [config] lemma-dependency: ""
[2023-07-22 08:39:40] [config] lemma-dim-emb: 0
[2023-07-22 08:39:40] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 08:39:40] [config] log-level: info
[2023-07-22 08:39:40] [config] log-time-zone: ""
[2023-07-22 08:39:40] [config] logical-epoch:
[2023-07-22 08:39:40] [config]   - 1e
[2023-07-22 08:39:40] [config]   - 0
[2023-07-22 08:39:40] [config] lr-decay: 0
[2023-07-22 08:39:40] [config] lr-decay-freq: 50000
[2023-07-22 08:39:40] [config] lr-decay-inv-sqrt:
[2023-07-22 08:39:40] [config]   - 0
[2023-07-22 08:39:40] [config] lr-decay-repeat-warmup: false
[2023-07-22 08:39:40] [config] lr-decay-reset-optimizer: false
[2023-07-22 08:39:40] [config] lr-decay-start:
[2023-07-22 08:39:40] [config]   - 10
[2023-07-22 08:39:40] [config]   - 1
[2023-07-22 08:39:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 08:39:40] [config] lr-report: false
[2023-07-22 08:39:40] [config] lr-warmup: 0
[2023-07-22 08:39:40] [config] lr-warmup-at-reload: false
[2023-07-22 08:39:40] [config] lr-warmup-cycle: false
[2023-07-22 08:39:40] [config] lr-warmup-start-rate: 0
[2023-07-22 08:39:40] [config] max-length: 150
[2023-07-22 08:39:40] [config] max-length-crop: true
[2023-07-22 08:39:40] [config] max-length-factor: 3
[2023-07-22 08:39:40] [config] maxi-batch: 100
[2023-07-22 08:39:40] [config] maxi-batch-sort: trg
[2023-07-22 08:39:40] [config] mini-batch: 64
[2023-07-22 08:39:40] [config] mini-batch-fit: true
[2023-07-22 08:39:40] [config] mini-batch-fit-step: 10
[2023-07-22 08:39:40] [config] mini-batch-round-up: true
[2023-07-22 08:39:40] [config] mini-batch-track-lr: false
[2023-07-22 08:39:40] [config] mini-batch-warmup: 0
[2023-07-22 08:39:40] [config] mini-batch-words: 0
[2023-07-22 08:39:40] [config] mini-batch-words-ref: 0
[2023-07-22 08:39:40] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 08:39:40] [config] multi-loss-type: sum
[2023-07-22 08:39:40] [config] n-best: false
[2023-07-22 08:39:40] [config] no-nccl: false
[2023-07-22 08:39:40] [config] no-reload: false
[2023-07-22 08:39:40] [config] no-restore-corpus: false
[2023-07-22 08:39:40] [config] normalize: 0
[2023-07-22 08:39:40] [config] normalize-gradient: false
[2023-07-22 08:39:40] [config] num-devices: 0
[2023-07-22 08:39:40] [config] optimizer: adam
[2023-07-22 08:39:40] [config] optimizer-delay: 1
[2023-07-22 08:39:40] [config] optimizer-params:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] output-omit-bias: false
[2023-07-22 08:39:40] [config] overwrite: true
[2023-07-22 08:39:40] [config] precision:
[2023-07-22 08:39:40] [config]   - float16
[2023-07-22 08:39:40] [config]   - float32
[2023-07-22 08:39:40] [config] pretrained-model: ""
[2023-07-22 08:39:40] [config] quantize-biases: false
[2023-07-22 08:39:40] [config] quantize-bits: 0
[2023-07-22 08:39:40] [config] quantize-log-based: false
[2023-07-22 08:39:40] [config] quantize-optimization-steps: 0
[2023-07-22 08:39:40] [config] quiet: false
[2023-07-22 08:39:40] [config] quiet-translation: true
[2023-07-22 08:39:40] [config] relative-paths: false
[2023-07-22 08:39:40] [config] right-left: false
[2023-07-22 08:39:40] [config] save-freq: 10000u
[2023-07-22 08:39:40] [config] seed: 1234
[2023-07-22 08:39:40] [config] sentencepiece-alphas:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] sentencepiece-max-lines: 2000000
[2023-07-22 08:39:40] [config] sentencepiece-options: ""
[2023-07-22 08:39:40] [config] sharding: global
[2023-07-22 08:39:40] [config] shuffle: data
[2023-07-22 08:39:40] [config] shuffle-in-ram: false
[2023-07-22 08:39:40] [config] sigterm: save-and-exit
[2023-07-22 08:39:40] [config] skip: false
[2023-07-22 08:39:40] [config] sqlite: ""
[2023-07-22 08:39:40] [config] sqlite-drop: false
[2023-07-22 08:39:40] [config] sync-freq: 200u
[2023-07-22 08:39:40] [config] sync-sgd: false
[2023-07-22 08:39:40] [config] tempdir: /tmp
[2023-07-22 08:39:40] [config] tied-embeddings: false
[2023-07-22 08:39:40] [config] tied-embeddings-all: true
[2023-07-22 08:39:40] [config] tied-embeddings-src: false
[2023-07-22 08:39:40] [config] train-embedder-rank:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] train-sets:
[2023-07-22 08:39:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 08:39:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 08:39:40] [config] transformer-aan-activation: swish
[2023-07-22 08:39:40] [config] transformer-aan-depth: 2
[2023-07-22 08:39:40] [config] transformer-aan-nogate: false
[2023-07-22 08:39:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 08:39:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 08:39:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 08:39:40] [config] transformer-depth-scaling: false
[2023-07-22 08:39:40] [config] transformer-dim-aan: 2048
[2023-07-22 08:39:40] [config] transformer-dim-ffn: 2048
[2023-07-22 08:39:40] [config] transformer-dropout: 0
[2023-07-22 08:39:40] [config] transformer-dropout-attention: 0
[2023-07-22 08:39:40] [config] transformer-dropout-ffn: 0
[2023-07-22 08:39:40] [config] transformer-ffn-activation: swish
[2023-07-22 08:39:40] [config] transformer-ffn-depth: 2
[2023-07-22 08:39:40] [config] transformer-guided-alignment-layer: last
[2023-07-22 08:39:40] [config] transformer-heads: 8
[2023-07-22 08:39:40] [config] transformer-no-projection: false
[2023-07-22 08:39:40] [config] transformer-pool: false
[2023-07-22 08:39:40] [config] transformer-postprocess: dan
[2023-07-22 08:39:40] [config] transformer-postprocess-emb: d
[2023-07-22 08:39:40] [config] transformer-postprocess-top: ""
[2023-07-22 08:39:40] [config] transformer-preprocess: ""
[2023-07-22 08:39:40] [config] transformer-tied-layers:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] transformer-train-position-embeddings: false
[2023-07-22 08:39:40] [config] tsv: false
[2023-07-22 08:39:40] [config] tsv-fields: 0
[2023-07-22 08:39:40] [config] type: amun
[2023-07-22 08:39:40] [config] ulr: false
[2023-07-22 08:39:40] [config] ulr-dim-emb: 0
[2023-07-22 08:39:40] [config] ulr-dropout: 0
[2023-07-22 08:39:40] [config] ulr-keys-vectors: ""
[2023-07-22 08:39:40] [config] ulr-query-vectors: ""
[2023-07-22 08:39:40] [config] ulr-softmax-temperature: 1
[2023-07-22 08:39:40] [config] ulr-trainable-transformation: false
[2023-07-22 08:39:40] [config] unlikelihood-loss: false
[2023-07-22 08:39:40] [config] valid-freq: 50000000
[2023-07-22 08:39:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 08:39:40] [config] valid-max-length: 1000
[2023-07-22 08:39:40] [config] valid-metrics:
[2023-07-22 08:39:40] [config]   - cross-entropy
[2023-07-22 08:39:40] [config]   - translation
[2023-07-22 08:39:40] [config] valid-mini-batch: 32
[2023-07-22 08:39:40] [config] valid-reset-stalled: false
[2023-07-22 08:39:40] [config] valid-script-args:
[2023-07-22 08:39:40] [config]   []
[2023-07-22 08:39:40] [config] valid-script-path: ""
[2023-07-22 08:39:40] [config] valid-sets:
[2023-07-22 08:39:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 08:39:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 08:39:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 08:39:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:39:40] [config] vocabs:
[2023-07-22 08:39:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:39:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:39:40] [config] word-penalty: 0
[2023-07-22 08:39:40] [config] word-scores: false
[2023-07-22 08:39:40] [config] workspace: 5500
[2023-07-22 08:39:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:39:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:39:40] [training] Using single-device training
[2023-07-22 08:39:41] Synced seed 1234
[2023-07-22 08:39:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:39:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 08:39:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:39:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 08:39:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 08:39:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:39:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 08:39:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 08:39:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 08:39:42] [comm] Using global sharding
[2023-07-22 08:39:42] [comm] NCCLCommunicators constructed successfully
[2023-07-22 08:39:42] [training] Using 1 GPUs
[2023-07-22 08:39:42] [logits] Applying loss function for 1 factor(s)
[2023-07-22 08:39:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 08:39:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 08:39:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:06:23] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 09:06:23] [valid] No post-processing script given for validating translator
[2023-07-22 09:06:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:06:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:06:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 09:06:23] [comm] Using global sharding
[2023-07-22 09:06:23] [comm] NCCLCommunicators constructed successfully
[2023-07-22 09:06:23] [training] Using 1 GPUs
[2023-07-22 09:06:23] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 09:06:34] Allocating memory for general optimizer shards
[2023-07-22 09:06:34] [memory] Reserving 322 MB, device gpu0
[2023-07-22 09:06:34] Loading Adam parameters
[2023-07-22 09:06:34] [memory] Reserving 322 MB, device gpu0
[2023-07-22 09:06:34] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:06:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 09:06:35] [data] Restoring the corpus state to epoch 121, batch 5257
[2023-07-22 09:06:35] [data] Shuffling data
[2023-07-22 09:06:35] [data] Done reading 20,192 sentences
[2023-07-22 09:06:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:06:35] Training started
[2023-07-22 09:06:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 09:06:35] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:06:37] Parameter type float16, optimization type float32, casting types true
[2023-07-22 09:10:58] Seen 20,192 samples
[2023-07-22 09:10:58] Starting data epoch 122 in logical epoch 122
[2023-07-22 09:10:58] [data] Shuffling data
[2023-07-22 09:10:58] [data] Done reading 20,192 sentences
[2023-07-22 09:10:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:15:21] Seen 20,192 samples
[2023-07-22 09:15:21] Starting data epoch 123 in logical epoch 123
[2023-07-22 09:15:21] [data] Shuffling data
[2023-07-22 09:15:21] [data] Done reading 20,192 sentences
[2023-07-22 09:15:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:19:46] Seen 20,192 samples
[2023-07-22 09:19:46] Starting data epoch 124 in logical epoch 124
[2023-07-22 09:19:46] [data] Shuffling data
[2023-07-22 09:19:46] [data] Done reading 20,192 sentences
[2023-07-22 09:19:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:24:10] Seen 20,192 samples
[2023-07-22 09:24:10] Starting data epoch 125 in logical epoch 125
[2023-07-22 09:24:10] [data] Shuffling data
[2023-07-22 09:24:10] [data] Done reading 20,192 sentences
[2023-07-22 09:24:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:28:42] Seen 20,192 samples
[2023-07-22 09:28:42] Starting data epoch 126 in logical epoch 126
[2023-07-22 09:28:42] [data] Shuffling data
[2023-07-22 09:28:42] [data] Done reading 20,192 sentences
[2023-07-22 09:28:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:33:18] Seen 20,192 samples
[2023-07-22 09:33:18] Starting data epoch 127 in logical epoch 127
[2023-07-22 09:33:18] [data] Shuffling data
[2023-07-22 09:33:18] [data] Done reading 20,192 sentences
[2023-07-22 09:33:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:37:47] Seen 20,192 samples
[2023-07-22 09:37:47] Starting data epoch 128 in logical epoch 128
[2023-07-22 09:37:47] [data] Shuffling data
[2023-07-22 09:37:47] [data] Done reading 20,192 sentences
[2023-07-22 09:37:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:42:20] Seen 20,192 samples
[2023-07-22 09:42:20] Starting data epoch 129 in logical epoch 129
[2023-07-22 09:42:20] [data] Shuffling data
[2023-07-22 09:42:20] [data] Done reading 20,192 sentences
[2023-07-22 09:42:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:46:40] Seen 20,192 samples
[2023-07-22 09:46:40] Starting data epoch 130 in logical epoch 130
[2023-07-22 09:46:40] [data] Shuffling data
[2023-07-22 09:46:40] [data] Done reading 20,192 sentences
[2023-07-22 09:46:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:51:08] Seen 20,192 samples
[2023-07-22 09:51:08] Starting data epoch 131 in logical epoch 131
[2023-07-22 09:51:08] Training finished
[2023-07-22 09:51:21] [valid] Ep. 131 : Up. 5694 : cross-entropy : 132.163 : stalled 2 times (last best: 131.199)
[2023-07-22 09:53:53] [valid] Ep. 131 : Up. 5694 : translation : 0 : new best
[2023-07-22 09:53:53] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 09:53:56] Saving Adam parameters
[2023-07-22 09:53:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 09:54:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:54:04] [marian] Running on node22.datos.cluster.uy as process 33164 with command line:
[2023-07-22 09:54:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 09:54:04] [config] after: 0e
[2023-07-22 09:54:04] [config] after-batches: 0
[2023-07-22 09:54:04] [config] after-epochs: 140
[2023-07-22 09:54:04] [config] all-caps-every: 0
[2023-07-22 09:54:04] [config] allow-unk: false
[2023-07-22 09:54:04] [config] authors: false
[2023-07-22 09:54:04] [config] beam-size: 12
[2023-07-22 09:54:04] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:54:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:54:04] [config] bert-masking-fraction: 0.15
[2023-07-22 09:54:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:54:04] [config] bert-train-type-embeddings: true
[2023-07-22 09:54:04] [config] bert-type-vocab-size: 2
[2023-07-22 09:54:04] [config] build-info: ""
[2023-07-22 09:54:04] [config] check-gradient-nan: false
[2023-07-22 09:54:04] [config] check-nan: false
[2023-07-22 09:54:04] [config] cite: false
[2023-07-22 09:54:04] [config] clip-norm: 1
[2023-07-22 09:54:04] [config] cost-scaling:
[2023-07-22 09:54:04] [config]   - 256.f
[2023-07-22 09:54:04] [config]   - 1000
[2023-07-22 09:54:04] [config]   - 2.f
[2023-07-22 09:54:04] [config]   - 256.f
[2023-07-22 09:54:04] [config] cost-type: ce-sum
[2023-07-22 09:54:04] [config] cpu-threads: 0
[2023-07-22 09:54:04] [config] data-threads: 8
[2023-07-22 09:54:04] [config] data-weighting: ""
[2023-07-22 09:54:04] [config] data-weighting-type: sentence
[2023-07-22 09:54:04] [config] dec-cell: gru
[2023-07-22 09:54:04] [config] dec-cell-base-depth: 2
[2023-07-22 09:54:04] [config] dec-cell-high-depth: 1
[2023-07-22 09:54:04] [config] dec-depth: 1
[2023-07-22 09:54:04] [config] devices:
[2023-07-22 09:54:04] [config]   - 0
[2023-07-22 09:54:04] [config] dim-emb: 512
[2023-07-22 09:54:04] [config] dim-rnn: 1024
[2023-07-22 09:54:04] [config] dim-vocabs:
[2023-07-22 09:54:04] [config]   - 16384
[2023-07-22 09:54:04] [config]   - 16384
[2023-07-22 09:54:04] [config] disp-first: 0
[2023-07-22 09:54:04] [config] disp-freq: 1000u
[2023-07-22 09:54:04] [config] disp-label-counts: true
[2023-07-22 09:54:04] [config] dropout-rnn: 0
[2023-07-22 09:54:04] [config] dropout-src: 0
[2023-07-22 09:54:04] [config] dropout-trg: 0
[2023-07-22 09:54:04] [config] dump-config: ""
[2023-07-22 09:54:04] [config] dynamic-gradient-scaling:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] early-stopping: 200
[2023-07-22 09:54:04] [config] early-stopping-on: first
[2023-07-22 09:54:04] [config] embedding-fix-src: false
[2023-07-22 09:54:04] [config] embedding-fix-trg: false
[2023-07-22 09:54:04] [config] embedding-normalization: false
[2023-07-22 09:54:04] [config] embedding-vectors:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] enc-cell: gru
[2023-07-22 09:54:04] [config] enc-cell-depth: 1
[2023-07-22 09:54:04] [config] enc-depth: 1
[2023-07-22 09:54:04] [config] enc-type: bidirectional
[2023-07-22 09:54:04] [config] english-title-case-every: 0
[2023-07-22 09:54:04] [config] exponential-smoothing: 0
[2023-07-22 09:54:04] [config] factor-weight: 1
[2023-07-22 09:54:04] [config] factors-combine: sum
[2023-07-22 09:54:04] [config] factors-dim-emb: 0
[2023-07-22 09:54:04] [config] gradient-checkpointing: false
[2023-07-22 09:54:04] [config] gradient-norm-average-window: 100
[2023-07-22 09:54:04] [config] guided-alignment: none
[2023-07-22 09:54:04] [config] guided-alignment-cost: mse
[2023-07-22 09:54:04] [config] guided-alignment-weight: 0.1
[2023-07-22 09:54:04] [config] ignore-model-config: false
[2023-07-22 09:54:04] [config] input-types:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] interpolate-env-vars: false
[2023-07-22 09:54:04] [config] keep-best: false
[2023-07-22 09:54:04] [config] label-smoothing: 0
[2023-07-22 09:54:04] [config] layer-normalization: false
[2023-07-22 09:54:04] [config] learn-rate: 0.0001
[2023-07-22 09:54:04] [config] lemma-dependency: ""
[2023-07-22 09:54:04] [config] lemma-dim-emb: 0
[2023-07-22 09:54:04] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 09:54:04] [config] log-level: info
[2023-07-22 09:54:04] [config] log-time-zone: ""
[2023-07-22 09:54:04] [config] logical-epoch:
[2023-07-22 09:54:04] [config]   - 1e
[2023-07-22 09:54:04] [config]   - 0
[2023-07-22 09:54:04] [config] lr-decay: 0
[2023-07-22 09:54:04] [config] lr-decay-freq: 50000
[2023-07-22 09:54:04] [config] lr-decay-inv-sqrt:
[2023-07-22 09:54:04] [config]   - 0
[2023-07-22 09:54:04] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:54:04] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:54:04] [config] lr-decay-start:
[2023-07-22 09:54:04] [config]   - 10
[2023-07-22 09:54:04] [config]   - 1
[2023-07-22 09:54:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:54:04] [config] lr-report: false
[2023-07-22 09:54:04] [config] lr-warmup: 0
[2023-07-22 09:54:04] [config] lr-warmup-at-reload: false
[2023-07-22 09:54:04] [config] lr-warmup-cycle: false
[2023-07-22 09:54:04] [config] lr-warmup-start-rate: 0
[2023-07-22 09:54:04] [config] max-length: 150
[2023-07-22 09:54:04] [config] max-length-crop: true
[2023-07-22 09:54:04] [config] max-length-factor: 3
[2023-07-22 09:54:04] [config] maxi-batch: 100
[2023-07-22 09:54:04] [config] maxi-batch-sort: trg
[2023-07-22 09:54:04] [config] mini-batch: 64
[2023-07-22 09:54:04] [config] mini-batch-fit: true
[2023-07-22 09:54:04] [config] mini-batch-fit-step: 10
[2023-07-22 09:54:04] [config] mini-batch-round-up: true
[2023-07-22 09:54:04] [config] mini-batch-track-lr: false
[2023-07-22 09:54:04] [config] mini-batch-warmup: 0
[2023-07-22 09:54:04] [config] mini-batch-words: 0
[2023-07-22 09:54:04] [config] mini-batch-words-ref: 0
[2023-07-22 09:54:04] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 09:54:04] [config] multi-loss-type: sum
[2023-07-22 09:54:04] [config] n-best: false
[2023-07-22 09:54:04] [config] no-nccl: false
[2023-07-22 09:54:04] [config] no-reload: false
[2023-07-22 09:54:04] [config] no-restore-corpus: false
[2023-07-22 09:54:04] [config] normalize: 0
[2023-07-22 09:54:04] [config] normalize-gradient: false
[2023-07-22 09:54:04] [config] num-devices: 0
[2023-07-22 09:54:04] [config] optimizer: adam
[2023-07-22 09:54:04] [config] optimizer-delay: 1
[2023-07-22 09:54:04] [config] optimizer-params:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] output-omit-bias: false
[2023-07-22 09:54:04] [config] overwrite: true
[2023-07-22 09:54:04] [config] precision:
[2023-07-22 09:54:04] [config]   - float16
[2023-07-22 09:54:04] [config]   - float32
[2023-07-22 09:54:04] [config] pretrained-model: ""
[2023-07-22 09:54:04] [config] quantize-biases: false
[2023-07-22 09:54:04] [config] quantize-bits: 0
[2023-07-22 09:54:04] [config] quantize-log-based: false
[2023-07-22 09:54:04] [config] quantize-optimization-steps: 0
[2023-07-22 09:54:04] [config] quiet: false
[2023-07-22 09:54:04] [config] quiet-translation: true
[2023-07-22 09:54:04] [config] relative-paths: false
[2023-07-22 09:54:04] [config] right-left: false
[2023-07-22 09:54:04] [config] save-freq: 10000u
[2023-07-22 09:54:04] [config] seed: 1234
[2023-07-22 09:54:04] [config] sentencepiece-alphas:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:54:04] [config] sentencepiece-options: ""
[2023-07-22 09:54:04] [config] sharding: global
[2023-07-22 09:54:04] [config] shuffle: data
[2023-07-22 09:54:04] [config] shuffle-in-ram: false
[2023-07-22 09:54:04] [config] sigterm: save-and-exit
[2023-07-22 09:54:04] [config] skip: false
[2023-07-22 09:54:04] [config] sqlite: ""
[2023-07-22 09:54:04] [config] sqlite-drop: false
[2023-07-22 09:54:04] [config] sync-freq: 200u
[2023-07-22 09:54:04] [config] sync-sgd: false
[2023-07-22 09:54:04] [config] tempdir: /tmp
[2023-07-22 09:54:04] [config] tied-embeddings: false
[2023-07-22 09:54:04] [config] tied-embeddings-all: true
[2023-07-22 09:54:04] [config] tied-embeddings-src: false
[2023-07-22 09:54:04] [config] train-embedder-rank:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] train-sets:
[2023-07-22 09:54:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:54:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:54:04] [config] transformer-aan-activation: swish
[2023-07-22 09:54:04] [config] transformer-aan-depth: 2
[2023-07-22 09:54:04] [config] transformer-aan-nogate: false
[2023-07-22 09:54:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:54:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:54:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:54:04] [config] transformer-depth-scaling: false
[2023-07-22 09:54:04] [config] transformer-dim-aan: 2048
[2023-07-22 09:54:04] [config] transformer-dim-ffn: 2048
[2023-07-22 09:54:04] [config] transformer-dropout: 0
[2023-07-22 09:54:04] [config] transformer-dropout-attention: 0
[2023-07-22 09:54:04] [config] transformer-dropout-ffn: 0
[2023-07-22 09:54:04] [config] transformer-ffn-activation: swish
[2023-07-22 09:54:04] [config] transformer-ffn-depth: 2
[2023-07-22 09:54:04] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:54:04] [config] transformer-heads: 8
[2023-07-22 09:54:04] [config] transformer-no-projection: false
[2023-07-22 09:54:04] [config] transformer-pool: false
[2023-07-22 09:54:04] [config] transformer-postprocess: dan
[2023-07-22 09:54:04] [config] transformer-postprocess-emb: d
[2023-07-22 09:54:04] [config] transformer-postprocess-top: ""
[2023-07-22 09:54:04] [config] transformer-preprocess: ""
[2023-07-22 09:54:04] [config] transformer-tied-layers:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] transformer-train-position-embeddings: false
[2023-07-22 09:54:04] [config] tsv: false
[2023-07-22 09:54:04] [config] tsv-fields: 0
[2023-07-22 09:54:04] [config] type: amun
[2023-07-22 09:54:04] [config] ulr: false
[2023-07-22 09:54:04] [config] ulr-dim-emb: 0
[2023-07-22 09:54:04] [config] ulr-dropout: 0
[2023-07-22 09:54:04] [config] ulr-keys-vectors: ""
[2023-07-22 09:54:04] [config] ulr-query-vectors: ""
[2023-07-22 09:54:04] [config] ulr-softmax-temperature: 1
[2023-07-22 09:54:04] [config] ulr-trainable-transformation: false
[2023-07-22 09:54:04] [config] unlikelihood-loss: false
[2023-07-22 09:54:04] [config] valid-freq: 50000000
[2023-07-22 09:54:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 09:54:04] [config] valid-max-length: 1000
[2023-07-22 09:54:04] [config] valid-metrics:
[2023-07-22 09:54:04] [config]   - cross-entropy
[2023-07-22 09:54:04] [config]   - translation
[2023-07-22 09:54:04] [config] valid-mini-batch: 32
[2023-07-22 09:54:04] [config] valid-reset-stalled: false
[2023-07-22 09:54:04] [config] valid-script-args:
[2023-07-22 09:54:04] [config]   []
[2023-07-22 09:54:04] [config] valid-script-path: ""
[2023-07-22 09:54:04] [config] valid-sets:
[2023-07-22 09:54:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:54:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:54:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 09:54:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:54:04] [config] vocabs:
[2023-07-22 09:54:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:54:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:54:04] [config] word-penalty: 0
[2023-07-22 09:54:04] [config] word-scores: false
[2023-07-22 09:54:04] [config] workspace: 5500
[2023-07-22 09:54:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:54:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:54:04] [training] Using single-device training
[2023-07-22 09:54:04] Synced seed 1234
[2023-07-22 09:54:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:54:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:54:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:54:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:54:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:54:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:54:04] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:54:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:54:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 09:54:06] [comm] Using global sharding
[2023-07-22 09:54:06] [comm] NCCLCommunicators constructed successfully
[2023-07-22 09:54:06] [training] Using 1 GPUs
[2023-07-22 09:54:06] [logits] Applying loss function for 1 factor(s)
[2023-07-22 09:54:06] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:54:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 09:54:06] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:19:43] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 10:19:43] [valid] No post-processing script given for validating translator
[2023-07-22 10:19:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 10:19:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 10:19:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 10:19:43] [comm] Using global sharding
[2023-07-22 10:19:43] [comm] NCCLCommunicators constructed successfully
[2023-07-22 10:19:43] [training] Using 1 GPUs
[2023-07-22 10:19:43] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 10:19:52] Allocating memory for general optimizer shards
[2023-07-22 10:19:52] [memory] Reserving 322 MB, device gpu0
[2023-07-22 10:19:52] Loading Adam parameters
[2023-07-22 10:19:52] [memory] Reserving 322 MB, device gpu0
[2023-07-22 10:19:52] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:19:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 10:19:53] [data] Restoring the corpus state to epoch 131, batch 5694
[2023-07-22 10:19:53] [data] Shuffling data
[2023-07-22 10:19:53] [data] Done reading 20,192 sentences
[2023-07-22 10:19:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:19:53] Training started
[2023-07-22 10:19:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 10:19:53] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:20:01] Parameter type float16, optimization type float32, casting types true
[2023-07-22 10:24:14] Seen 20,192 samples
[2023-07-22 10:24:14] Starting data epoch 132 in logical epoch 132
[2023-07-22 10:24:14] [data] Shuffling data
[2023-07-22 10:24:14] [data] Done reading 20,192 sentences
[2023-07-22 10:24:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:28:48] Seen 20,192 samples
[2023-07-22 10:28:48] Starting data epoch 133 in logical epoch 133
[2023-07-22 10:28:48] [data] Shuffling data
[2023-07-22 10:28:48] [data] Done reading 20,192 sentences
[2023-07-22 10:28:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:33:28] Seen 20,192 samples
[2023-07-22 10:33:28] Starting data epoch 134 in logical epoch 134
[2023-07-22 10:33:28] [data] Shuffling data
[2023-07-22 10:33:28] [data] Done reading 20,192 sentences
[2023-07-22 10:33:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:38:00] Seen 20,192 samples
[2023-07-22 10:38:00] Starting data epoch 135 in logical epoch 135
[2023-07-22 10:38:00] [data] Shuffling data
[2023-07-22 10:38:00] [data] Done reading 20,192 sentences
[2023-07-22 10:38:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:42:27] Seen 20,192 samples
[2023-07-22 10:42:27] Starting data epoch 136 in logical epoch 136
[2023-07-22 10:42:27] [data] Shuffling data
[2023-07-22 10:42:27] [data] Done reading 20,192 sentences
[2023-07-22 10:42:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:47:02] Seen 20,192 samples
[2023-07-22 10:47:02] Starting data epoch 137 in logical epoch 137
[2023-07-22 10:47:02] [data] Shuffling data
[2023-07-22 10:47:02] [data] Done reading 20,192 sentences
[2023-07-22 10:47:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:51:30] Seen 20,192 samples
[2023-07-22 10:51:30] Starting data epoch 138 in logical epoch 138
[2023-07-22 10:51:30] [data] Shuffling data
[2023-07-22 10:51:30] [data] Done reading 20,192 sentences
[2023-07-22 10:51:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:51:50] Ep. 138 : Up. 6000 : Sen. 1,410 : Cost 3.67079353 * 12,474,418 @ 6,297 after 74,539,235 : Time 1927.22s : 6472.76 words/s : gNorm 1.4528
[2023-07-22 10:55:59] Seen 20,192 samples
[2023-07-22 10:55:59] Starting data epoch 139 in logical epoch 139
[2023-07-22 10:55:59] [data] Shuffling data
[2023-07-22 10:55:59] [data] Done reading 20,192 sentences
[2023-07-22 10:55:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:00:24] Seen 20,192 samples
[2023-07-22 11:00:24] Starting data epoch 140 in logical epoch 140
[2023-07-22 11:00:24] [data] Shuffling data
[2023-07-22 11:00:24] [data] Done reading 20,192 sentences
[2023-07-22 11:00:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:05:01] Seen 20,192 samples
[2023-07-22 11:05:01] Starting data epoch 141 in logical epoch 141
[2023-07-22 11:05:01] Training finished
[2023-07-22 11:05:11] [valid] Ep. 141 : Up. 6127 : cross-entropy : 134.147 : stalled 3 times (last best: 131.199)
[2023-07-22 11:07:33] [valid] Ep. 141 : Up. 6127 : translation : 0 : new best
[2023-07-22 11:07:33] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 11:07:35] Saving Adam parameters
[2023-07-22 11:07:35] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 11:07:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 11:07:43] [marian] Running on node22.datos.cluster.uy as process 38068 with command line:
[2023-07-22 11:07:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 11:07:43] [config] after: 0e
[2023-07-22 11:07:43] [config] after-batches: 0
[2023-07-22 11:07:43] [config] after-epochs: 150
[2023-07-22 11:07:43] [config] all-caps-every: 0
[2023-07-22 11:07:43] [config] allow-unk: false
[2023-07-22 11:07:43] [config] authors: false
[2023-07-22 11:07:43] [config] beam-size: 12
[2023-07-22 11:07:43] [config] bert-class-symbol: "[CLS]"
[2023-07-22 11:07:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 11:07:43] [config] bert-masking-fraction: 0.15
[2023-07-22 11:07:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 11:07:43] [config] bert-train-type-embeddings: true
[2023-07-22 11:07:43] [config] bert-type-vocab-size: 2
[2023-07-22 11:07:43] [config] build-info: ""
[2023-07-22 11:07:43] [config] check-gradient-nan: false
[2023-07-22 11:07:43] [config] check-nan: false
[2023-07-22 11:07:43] [config] cite: false
[2023-07-22 11:07:43] [config] clip-norm: 1
[2023-07-22 11:07:43] [config] cost-scaling:
[2023-07-22 11:07:43] [config]   - 256.f
[2023-07-22 11:07:43] [config]   - 1000
[2023-07-22 11:07:43] [config]   - 2.f
[2023-07-22 11:07:43] [config]   - 256.f
[2023-07-22 11:07:43] [config] cost-type: ce-sum
[2023-07-22 11:07:43] [config] cpu-threads: 0
[2023-07-22 11:07:43] [config] data-threads: 8
[2023-07-22 11:07:43] [config] data-weighting: ""
[2023-07-22 11:07:43] [config] data-weighting-type: sentence
[2023-07-22 11:07:43] [config] dec-cell: gru
[2023-07-22 11:07:43] [config] dec-cell-base-depth: 2
[2023-07-22 11:07:43] [config] dec-cell-high-depth: 1
[2023-07-22 11:07:43] [config] dec-depth: 1
[2023-07-22 11:07:43] [config] devices:
[2023-07-22 11:07:43] [config]   - 0
[2023-07-22 11:07:43] [config] dim-emb: 512
[2023-07-22 11:07:43] [config] dim-rnn: 1024
[2023-07-22 11:07:43] [config] dim-vocabs:
[2023-07-22 11:07:43] [config]   - 16384
[2023-07-22 11:07:43] [config]   - 16384
[2023-07-22 11:07:43] [config] disp-first: 0
[2023-07-22 11:07:43] [config] disp-freq: 1000u
[2023-07-22 11:07:43] [config] disp-label-counts: true
[2023-07-22 11:07:43] [config] dropout-rnn: 0
[2023-07-22 11:07:43] [config] dropout-src: 0
[2023-07-22 11:07:43] [config] dropout-trg: 0
[2023-07-22 11:07:43] [config] dump-config: ""
[2023-07-22 11:07:43] [config] dynamic-gradient-scaling:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] early-stopping: 200
[2023-07-22 11:07:43] [config] early-stopping-on: first
[2023-07-22 11:07:43] [config] embedding-fix-src: false
[2023-07-22 11:07:43] [config] embedding-fix-trg: false
[2023-07-22 11:07:43] [config] embedding-normalization: false
[2023-07-22 11:07:43] [config] embedding-vectors:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] enc-cell: gru
[2023-07-22 11:07:43] [config] enc-cell-depth: 1
[2023-07-22 11:07:43] [config] enc-depth: 1
[2023-07-22 11:07:43] [config] enc-type: bidirectional
[2023-07-22 11:07:43] [config] english-title-case-every: 0
[2023-07-22 11:07:43] [config] exponential-smoothing: 0
[2023-07-22 11:07:43] [config] factor-weight: 1
[2023-07-22 11:07:43] [config] factors-combine: sum
[2023-07-22 11:07:43] [config] factors-dim-emb: 0
[2023-07-22 11:07:43] [config] gradient-checkpointing: false
[2023-07-22 11:07:43] [config] gradient-norm-average-window: 100
[2023-07-22 11:07:43] [config] guided-alignment: none
[2023-07-22 11:07:43] [config] guided-alignment-cost: mse
[2023-07-22 11:07:43] [config] guided-alignment-weight: 0.1
[2023-07-22 11:07:43] [config] ignore-model-config: false
[2023-07-22 11:07:43] [config] input-types:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] interpolate-env-vars: false
[2023-07-22 11:07:43] [config] keep-best: false
[2023-07-22 11:07:43] [config] label-smoothing: 0
[2023-07-22 11:07:43] [config] layer-normalization: false
[2023-07-22 11:07:43] [config] learn-rate: 0.0001
[2023-07-22 11:07:43] [config] lemma-dependency: ""
[2023-07-22 11:07:43] [config] lemma-dim-emb: 0
[2023-07-22 11:07:43] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 11:07:43] [config] log-level: info
[2023-07-22 11:07:43] [config] log-time-zone: ""
[2023-07-22 11:07:43] [config] logical-epoch:
[2023-07-22 11:07:43] [config]   - 1e
[2023-07-22 11:07:43] [config]   - 0
[2023-07-22 11:07:43] [config] lr-decay: 0
[2023-07-22 11:07:43] [config] lr-decay-freq: 50000
[2023-07-22 11:07:43] [config] lr-decay-inv-sqrt:
[2023-07-22 11:07:43] [config]   - 0
[2023-07-22 11:07:43] [config] lr-decay-repeat-warmup: false
[2023-07-22 11:07:43] [config] lr-decay-reset-optimizer: false
[2023-07-22 11:07:43] [config] lr-decay-start:
[2023-07-22 11:07:43] [config]   - 10
[2023-07-22 11:07:43] [config]   - 1
[2023-07-22 11:07:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 11:07:43] [config] lr-report: false
[2023-07-22 11:07:43] [config] lr-warmup: 0
[2023-07-22 11:07:43] [config] lr-warmup-at-reload: false
[2023-07-22 11:07:43] [config] lr-warmup-cycle: false
[2023-07-22 11:07:43] [config] lr-warmup-start-rate: 0
[2023-07-22 11:07:43] [config] max-length: 150
[2023-07-22 11:07:43] [config] max-length-crop: true
[2023-07-22 11:07:43] [config] max-length-factor: 3
[2023-07-22 11:07:43] [config] maxi-batch: 100
[2023-07-22 11:07:43] [config] maxi-batch-sort: trg
[2023-07-22 11:07:43] [config] mini-batch: 64
[2023-07-22 11:07:43] [config] mini-batch-fit: true
[2023-07-22 11:07:43] [config] mini-batch-fit-step: 10
[2023-07-22 11:07:43] [config] mini-batch-round-up: true
[2023-07-22 11:07:43] [config] mini-batch-track-lr: false
[2023-07-22 11:07:43] [config] mini-batch-warmup: 0
[2023-07-22 11:07:43] [config] mini-batch-words: 0
[2023-07-22 11:07:43] [config] mini-batch-words-ref: 0
[2023-07-22 11:07:43] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 11:07:43] [config] multi-loss-type: sum
[2023-07-22 11:07:43] [config] n-best: false
[2023-07-22 11:07:43] [config] no-nccl: false
[2023-07-22 11:07:43] [config] no-reload: false
[2023-07-22 11:07:43] [config] no-restore-corpus: false
[2023-07-22 11:07:43] [config] normalize: 0
[2023-07-22 11:07:43] [config] normalize-gradient: false
[2023-07-22 11:07:43] [config] num-devices: 0
[2023-07-22 11:07:43] [config] optimizer: adam
[2023-07-22 11:07:43] [config] optimizer-delay: 1
[2023-07-22 11:07:43] [config] optimizer-params:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] output-omit-bias: false
[2023-07-22 11:07:43] [config] overwrite: true
[2023-07-22 11:07:43] [config] precision:
[2023-07-22 11:07:43] [config]   - float16
[2023-07-22 11:07:43] [config]   - float32
[2023-07-22 11:07:43] [config] pretrained-model: ""
[2023-07-22 11:07:43] [config] quantize-biases: false
[2023-07-22 11:07:43] [config] quantize-bits: 0
[2023-07-22 11:07:43] [config] quantize-log-based: false
[2023-07-22 11:07:43] [config] quantize-optimization-steps: 0
[2023-07-22 11:07:43] [config] quiet: false
[2023-07-22 11:07:43] [config] quiet-translation: true
[2023-07-22 11:07:43] [config] relative-paths: false
[2023-07-22 11:07:43] [config] right-left: false
[2023-07-22 11:07:43] [config] save-freq: 10000u
[2023-07-22 11:07:43] [config] seed: 1234
[2023-07-22 11:07:43] [config] sentencepiece-alphas:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] sentencepiece-max-lines: 2000000
[2023-07-22 11:07:43] [config] sentencepiece-options: ""
[2023-07-22 11:07:43] [config] sharding: global
[2023-07-22 11:07:43] [config] shuffle: data
[2023-07-22 11:07:43] [config] shuffle-in-ram: false
[2023-07-22 11:07:43] [config] sigterm: save-and-exit
[2023-07-22 11:07:43] [config] skip: false
[2023-07-22 11:07:43] [config] sqlite: ""
[2023-07-22 11:07:43] [config] sqlite-drop: false
[2023-07-22 11:07:43] [config] sync-freq: 200u
[2023-07-22 11:07:43] [config] sync-sgd: false
[2023-07-22 11:07:43] [config] tempdir: /tmp
[2023-07-22 11:07:43] [config] tied-embeddings: false
[2023-07-22 11:07:43] [config] tied-embeddings-all: true
[2023-07-22 11:07:43] [config] tied-embeddings-src: false
[2023-07-22 11:07:43] [config] train-embedder-rank:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] train-sets:
[2023-07-22 11:07:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 11:07:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 11:07:43] [config] transformer-aan-activation: swish
[2023-07-22 11:07:43] [config] transformer-aan-depth: 2
[2023-07-22 11:07:43] [config] transformer-aan-nogate: false
[2023-07-22 11:07:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 11:07:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 11:07:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 11:07:43] [config] transformer-depth-scaling: false
[2023-07-22 11:07:43] [config] transformer-dim-aan: 2048
[2023-07-22 11:07:43] [config] transformer-dim-ffn: 2048
[2023-07-22 11:07:43] [config] transformer-dropout: 0
[2023-07-22 11:07:43] [config] transformer-dropout-attention: 0
[2023-07-22 11:07:43] [config] transformer-dropout-ffn: 0
[2023-07-22 11:07:43] [config] transformer-ffn-activation: swish
[2023-07-22 11:07:43] [config] transformer-ffn-depth: 2
[2023-07-22 11:07:43] [config] transformer-guided-alignment-layer: last
[2023-07-22 11:07:43] [config] transformer-heads: 8
[2023-07-22 11:07:43] [config] transformer-no-projection: false
[2023-07-22 11:07:43] [config] transformer-pool: false
[2023-07-22 11:07:43] [config] transformer-postprocess: dan
[2023-07-22 11:07:43] [config] transformer-postprocess-emb: d
[2023-07-22 11:07:43] [config] transformer-postprocess-top: ""
[2023-07-22 11:07:43] [config] transformer-preprocess: ""
[2023-07-22 11:07:43] [config] transformer-tied-layers:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] transformer-train-position-embeddings: false
[2023-07-22 11:07:43] [config] tsv: false
[2023-07-22 11:07:43] [config] tsv-fields: 0
[2023-07-22 11:07:43] [config] type: amun
[2023-07-22 11:07:43] [config] ulr: false
[2023-07-22 11:07:43] [config] ulr-dim-emb: 0
[2023-07-22 11:07:43] [config] ulr-dropout: 0
[2023-07-22 11:07:43] [config] ulr-keys-vectors: ""
[2023-07-22 11:07:43] [config] ulr-query-vectors: ""
[2023-07-22 11:07:43] [config] ulr-softmax-temperature: 1
[2023-07-22 11:07:43] [config] ulr-trainable-transformation: false
[2023-07-22 11:07:43] [config] unlikelihood-loss: false
[2023-07-22 11:07:43] [config] valid-freq: 50000000
[2023-07-22 11:07:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 11:07:43] [config] valid-max-length: 1000
[2023-07-22 11:07:43] [config] valid-metrics:
[2023-07-22 11:07:43] [config]   - cross-entropy
[2023-07-22 11:07:43] [config]   - translation
[2023-07-22 11:07:43] [config] valid-mini-batch: 32
[2023-07-22 11:07:43] [config] valid-reset-stalled: false
[2023-07-22 11:07:43] [config] valid-script-args:
[2023-07-22 11:07:43] [config]   []
[2023-07-22 11:07:43] [config] valid-script-path: ""
[2023-07-22 11:07:43] [config] valid-sets:
[2023-07-22 11:07:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 11:07:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 11:07:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 11:07:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 11:07:43] [config] vocabs:
[2023-07-22 11:07:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 11:07:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 11:07:43] [config] word-penalty: 0
[2023-07-22 11:07:43] [config] word-scores: false
[2023-07-22 11:07:43] [config] workspace: 5500
[2023-07-22 11:07:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 11:07:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 11:07:43] [training] Using single-device training
[2023-07-22 11:07:43] Synced seed 1234
[2023-07-22 11:07:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 11:07:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 11:07:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 11:07:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 11:07:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 11:07:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 11:07:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 11:07:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 11:07:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 11:07:44] [comm] Using global sharding
[2023-07-22 11:07:45] [comm] NCCLCommunicators constructed successfully
[2023-07-22 11:07:45] [training] Using 1 GPUs
[2023-07-22 11:07:45] [logits] Applying loss function for 1 factor(s)
[2023-07-22 11:07:45] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:07:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 11:07:45] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:34:18] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 11:34:18] [valid] No post-processing script given for validating translator
[2023-07-22 11:34:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 11:34:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 11:34:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 11:34:19] [comm] Using global sharding
[2023-07-22 11:34:19] [comm] NCCLCommunicators constructed successfully
[2023-07-22 11:34:19] [training] Using 1 GPUs
[2023-07-22 11:34:19] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 11:34:24] Allocating memory for general optimizer shards
[2023-07-22 11:34:24] [memory] Reserving 322 MB, device gpu0
[2023-07-22 11:34:24] Loading Adam parameters
[2023-07-22 11:34:24] [memory] Reserving 322 MB, device gpu0
[2023-07-22 11:34:24] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:34:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 11:34:24] [data] Restoring the corpus state to epoch 141, batch 6127
[2023-07-22 11:34:24] [data] Shuffling data
[2023-07-22 11:34:24] [data] Done reading 20,192 sentences
[2023-07-22 11:34:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:34:25] Training started
[2023-07-22 11:34:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 11:34:25] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:34:25] Parameter type float16, optimization type float32, casting types true
[2023-07-22 11:38:41] Seen 20,192 samples
[2023-07-22 11:38:41] Starting data epoch 142 in logical epoch 142
[2023-07-22 11:38:41] [data] Shuffling data
[2023-07-22 11:38:41] [data] Done reading 20,192 sentences
[2023-07-22 11:38:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:43:11] Seen 20,192 samples
[2023-07-22 11:43:11] Starting data epoch 143 in logical epoch 143
[2023-07-22 11:43:11] [data] Shuffling data
[2023-07-22 11:43:11] [data] Done reading 20,192 sentences
[2023-07-22 11:43:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:47:43] Seen 20,192 samples
[2023-07-22 11:47:43] Starting data epoch 144 in logical epoch 144
[2023-07-22 11:47:43] [data] Shuffling data
[2023-07-22 11:47:43] [data] Done reading 20,192 sentences
[2023-07-22 11:47:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:52:19] Seen 20,192 samples
[2023-07-22 11:52:19] Starting data epoch 145 in logical epoch 145
[2023-07-22 11:52:19] [data] Shuffling data
[2023-07-22 11:52:19] [data] Done reading 20,192 sentences
[2023-07-22 11:52:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:56:27] Seen 20,192 samples
[2023-07-22 11:56:27] Starting data epoch 146 in logical epoch 146
[2023-07-22 11:56:27] [data] Shuffling data
[2023-07-22 11:56:27] [data] Done reading 20,192 sentences
[2023-07-22 11:56:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:00:43] Seen 20,192 samples
[2023-07-22 12:00:43] Starting data epoch 147 in logical epoch 147
[2023-07-22 12:00:43] [data] Shuffling data
[2023-07-22 12:00:43] [data] Done reading 20,192 sentences
[2023-07-22 12:00:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:05:03] Seen 20,192 samples
[2023-07-22 12:05:03] Starting data epoch 148 in logical epoch 148
[2023-07-22 12:05:03] [data] Shuffling data
[2023-07-22 12:05:03] [data] Done reading 20,192 sentences
[2023-07-22 12:05:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:09:34] Seen 20,192 samples
[2023-07-22 12:09:34] Starting data epoch 149 in logical epoch 149
[2023-07-22 12:09:34] [data] Shuffling data
[2023-07-22 12:09:34] [data] Done reading 20,192 sentences
[2023-07-22 12:09:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:13:55] Seen 20,192 samples
[2023-07-22 12:13:55] Starting data epoch 150 in logical epoch 150
[2023-07-22 12:13:55] [data] Shuffling data
[2023-07-22 12:13:55] [data] Done reading 20,192 sentences
[2023-07-22 12:13:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:18:05] Seen 20,192 samples
[2023-07-22 12:18:05] Starting data epoch 151 in logical epoch 151
[2023-07-22 12:18:05] Training finished
[2023-07-22 12:18:16] [valid] Ep. 151 : Up. 6565 : cross-entropy : 135.211 : stalled 4 times (last best: 131.199)
[2023-07-22 12:20:39] [valid] Ep. 151 : Up. 6565 : translation : 0 : new best
[2023-07-22 12:20:39] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 12:20:42] Saving Adam parameters
[2023-07-22 12:20:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 12:20:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:20:48] [marian] Running on node22.datos.cluster.uy as process 2108 with command line:
[2023-07-22 12:20:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 12:20:48] [config] after: 0e
[2023-07-22 12:20:48] [config] after-batches: 0
[2023-07-22 12:20:48] [config] after-epochs: 160
[2023-07-22 12:20:48] [config] all-caps-every: 0
[2023-07-22 12:20:48] [config] allow-unk: false
[2023-07-22 12:20:48] [config] authors: false
[2023-07-22 12:20:48] [config] beam-size: 12
[2023-07-22 12:20:48] [config] bert-class-symbol: "[CLS]"
[2023-07-22 12:20:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 12:20:48] [config] bert-masking-fraction: 0.15
[2023-07-22 12:20:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 12:20:48] [config] bert-train-type-embeddings: true
[2023-07-22 12:20:48] [config] bert-type-vocab-size: 2
[2023-07-22 12:20:48] [config] build-info: ""
[2023-07-22 12:20:48] [config] check-gradient-nan: false
[2023-07-22 12:20:48] [config] check-nan: false
[2023-07-22 12:20:48] [config] cite: false
[2023-07-22 12:20:48] [config] clip-norm: 1
[2023-07-22 12:20:48] [config] cost-scaling:
[2023-07-22 12:20:48] [config]   - 256.f
[2023-07-22 12:20:48] [config]   - 1000
[2023-07-22 12:20:48] [config]   - 2.f
[2023-07-22 12:20:48] [config]   - 256.f
[2023-07-22 12:20:48] [config] cost-type: ce-sum
[2023-07-22 12:20:48] [config] cpu-threads: 0
[2023-07-22 12:20:48] [config] data-threads: 8
[2023-07-22 12:20:48] [config] data-weighting: ""
[2023-07-22 12:20:48] [config] data-weighting-type: sentence
[2023-07-22 12:20:48] [config] dec-cell: gru
[2023-07-22 12:20:48] [config] dec-cell-base-depth: 2
[2023-07-22 12:20:48] [config] dec-cell-high-depth: 1
[2023-07-22 12:20:48] [config] dec-depth: 1
[2023-07-22 12:20:48] [config] devices:
[2023-07-22 12:20:48] [config]   - 0
[2023-07-22 12:20:48] [config] dim-emb: 512
[2023-07-22 12:20:48] [config] dim-rnn: 1024
[2023-07-22 12:20:48] [config] dim-vocabs:
[2023-07-22 12:20:48] [config]   - 16384
[2023-07-22 12:20:48] [config]   - 16384
[2023-07-22 12:20:48] [config] disp-first: 0
[2023-07-22 12:20:48] [config] disp-freq: 1000u
[2023-07-22 12:20:48] [config] disp-label-counts: true
[2023-07-22 12:20:48] [config] dropout-rnn: 0
[2023-07-22 12:20:48] [config] dropout-src: 0
[2023-07-22 12:20:48] [config] dropout-trg: 0
[2023-07-22 12:20:48] [config] dump-config: ""
[2023-07-22 12:20:48] [config] dynamic-gradient-scaling:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] early-stopping: 200
[2023-07-22 12:20:48] [config] early-stopping-on: first
[2023-07-22 12:20:48] [config] embedding-fix-src: false
[2023-07-22 12:20:48] [config] embedding-fix-trg: false
[2023-07-22 12:20:48] [config] embedding-normalization: false
[2023-07-22 12:20:48] [config] embedding-vectors:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] enc-cell: gru
[2023-07-22 12:20:48] [config] enc-cell-depth: 1
[2023-07-22 12:20:48] [config] enc-depth: 1
[2023-07-22 12:20:48] [config] enc-type: bidirectional
[2023-07-22 12:20:48] [config] english-title-case-every: 0
[2023-07-22 12:20:48] [config] exponential-smoothing: 0
[2023-07-22 12:20:48] [config] factor-weight: 1
[2023-07-22 12:20:48] [config] factors-combine: sum
[2023-07-22 12:20:48] [config] factors-dim-emb: 0
[2023-07-22 12:20:48] [config] gradient-checkpointing: false
[2023-07-22 12:20:48] [config] gradient-norm-average-window: 100
[2023-07-22 12:20:48] [config] guided-alignment: none
[2023-07-22 12:20:48] [config] guided-alignment-cost: mse
[2023-07-22 12:20:48] [config] guided-alignment-weight: 0.1
[2023-07-22 12:20:48] [config] ignore-model-config: false
[2023-07-22 12:20:48] [config] input-types:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] interpolate-env-vars: false
[2023-07-22 12:20:48] [config] keep-best: false
[2023-07-22 12:20:48] [config] label-smoothing: 0
[2023-07-22 12:20:48] [config] layer-normalization: false
[2023-07-22 12:20:48] [config] learn-rate: 0.0001
[2023-07-22 12:20:48] [config] lemma-dependency: ""
[2023-07-22 12:20:48] [config] lemma-dim-emb: 0
[2023-07-22 12:20:48] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 12:20:48] [config] log-level: info
[2023-07-22 12:20:48] [config] log-time-zone: ""
[2023-07-22 12:20:48] [config] logical-epoch:
[2023-07-22 12:20:48] [config]   - 1e
[2023-07-22 12:20:48] [config]   - 0
[2023-07-22 12:20:48] [config] lr-decay: 0
[2023-07-22 12:20:48] [config] lr-decay-freq: 50000
[2023-07-22 12:20:48] [config] lr-decay-inv-sqrt:
[2023-07-22 12:20:48] [config]   - 0
[2023-07-22 12:20:48] [config] lr-decay-repeat-warmup: false
[2023-07-22 12:20:48] [config] lr-decay-reset-optimizer: false
[2023-07-22 12:20:48] [config] lr-decay-start:
[2023-07-22 12:20:48] [config]   - 10
[2023-07-22 12:20:48] [config]   - 1
[2023-07-22 12:20:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 12:20:48] [config] lr-report: false
[2023-07-22 12:20:48] [config] lr-warmup: 0
[2023-07-22 12:20:48] [config] lr-warmup-at-reload: false
[2023-07-22 12:20:48] [config] lr-warmup-cycle: false
[2023-07-22 12:20:48] [config] lr-warmup-start-rate: 0
[2023-07-22 12:20:48] [config] max-length: 150
[2023-07-22 12:20:48] [config] max-length-crop: true
[2023-07-22 12:20:48] [config] max-length-factor: 3
[2023-07-22 12:20:48] [config] maxi-batch: 100
[2023-07-22 12:20:48] [config] maxi-batch-sort: trg
[2023-07-22 12:20:48] [config] mini-batch: 64
[2023-07-22 12:20:48] [config] mini-batch-fit: true
[2023-07-22 12:20:48] [config] mini-batch-fit-step: 10
[2023-07-22 12:20:48] [config] mini-batch-round-up: true
[2023-07-22 12:20:48] [config] mini-batch-track-lr: false
[2023-07-22 12:20:48] [config] mini-batch-warmup: 0
[2023-07-22 12:20:48] [config] mini-batch-words: 0
[2023-07-22 12:20:48] [config] mini-batch-words-ref: 0
[2023-07-22 12:20:48] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 12:20:48] [config] multi-loss-type: sum
[2023-07-22 12:20:48] [config] n-best: false
[2023-07-22 12:20:48] [config] no-nccl: false
[2023-07-22 12:20:48] [config] no-reload: false
[2023-07-22 12:20:48] [config] no-restore-corpus: false
[2023-07-22 12:20:48] [config] normalize: 0
[2023-07-22 12:20:48] [config] normalize-gradient: false
[2023-07-22 12:20:48] [config] num-devices: 0
[2023-07-22 12:20:48] [config] optimizer: adam
[2023-07-22 12:20:48] [config] optimizer-delay: 1
[2023-07-22 12:20:48] [config] optimizer-params:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] output-omit-bias: false
[2023-07-22 12:20:48] [config] overwrite: true
[2023-07-22 12:20:48] [config] precision:
[2023-07-22 12:20:48] [config]   - float16
[2023-07-22 12:20:48] [config]   - float32
[2023-07-22 12:20:48] [config] pretrained-model: ""
[2023-07-22 12:20:48] [config] quantize-biases: false
[2023-07-22 12:20:48] [config] quantize-bits: 0
[2023-07-22 12:20:48] [config] quantize-log-based: false
[2023-07-22 12:20:48] [config] quantize-optimization-steps: 0
[2023-07-22 12:20:48] [config] quiet: false
[2023-07-22 12:20:48] [config] quiet-translation: true
[2023-07-22 12:20:48] [config] relative-paths: false
[2023-07-22 12:20:48] [config] right-left: false
[2023-07-22 12:20:48] [config] save-freq: 10000u
[2023-07-22 12:20:48] [config] seed: 1234
[2023-07-22 12:20:48] [config] sentencepiece-alphas:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] sentencepiece-max-lines: 2000000
[2023-07-22 12:20:48] [config] sentencepiece-options: ""
[2023-07-22 12:20:48] [config] sharding: global
[2023-07-22 12:20:48] [config] shuffle: data
[2023-07-22 12:20:48] [config] shuffle-in-ram: false
[2023-07-22 12:20:48] [config] sigterm: save-and-exit
[2023-07-22 12:20:48] [config] skip: false
[2023-07-22 12:20:48] [config] sqlite: ""
[2023-07-22 12:20:48] [config] sqlite-drop: false
[2023-07-22 12:20:48] [config] sync-freq: 200u
[2023-07-22 12:20:48] [config] sync-sgd: false
[2023-07-22 12:20:48] [config] tempdir: /tmp
[2023-07-22 12:20:48] [config] tied-embeddings: false
[2023-07-22 12:20:48] [config] tied-embeddings-all: true
[2023-07-22 12:20:48] [config] tied-embeddings-src: false
[2023-07-22 12:20:48] [config] train-embedder-rank:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] train-sets:
[2023-07-22 12:20:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 12:20:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 12:20:48] [config] transformer-aan-activation: swish
[2023-07-22 12:20:48] [config] transformer-aan-depth: 2
[2023-07-22 12:20:48] [config] transformer-aan-nogate: false
[2023-07-22 12:20:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 12:20:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 12:20:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 12:20:48] [config] transformer-depth-scaling: false
[2023-07-22 12:20:48] [config] transformer-dim-aan: 2048
[2023-07-22 12:20:48] [config] transformer-dim-ffn: 2048
[2023-07-22 12:20:48] [config] transformer-dropout: 0
[2023-07-22 12:20:48] [config] transformer-dropout-attention: 0
[2023-07-22 12:20:48] [config] transformer-dropout-ffn: 0
[2023-07-22 12:20:48] [config] transformer-ffn-activation: swish
[2023-07-22 12:20:48] [config] transformer-ffn-depth: 2
[2023-07-22 12:20:48] [config] transformer-guided-alignment-layer: last
[2023-07-22 12:20:48] [config] transformer-heads: 8
[2023-07-22 12:20:48] [config] transformer-no-projection: false
[2023-07-22 12:20:48] [config] transformer-pool: false
[2023-07-22 12:20:48] [config] transformer-postprocess: dan
[2023-07-22 12:20:48] [config] transformer-postprocess-emb: d
[2023-07-22 12:20:48] [config] transformer-postprocess-top: ""
[2023-07-22 12:20:48] [config] transformer-preprocess: ""
[2023-07-22 12:20:48] [config] transformer-tied-layers:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] transformer-train-position-embeddings: false
[2023-07-22 12:20:48] [config] tsv: false
[2023-07-22 12:20:48] [config] tsv-fields: 0
[2023-07-22 12:20:48] [config] type: amun
[2023-07-22 12:20:48] [config] ulr: false
[2023-07-22 12:20:48] [config] ulr-dim-emb: 0
[2023-07-22 12:20:48] [config] ulr-dropout: 0
[2023-07-22 12:20:48] [config] ulr-keys-vectors: ""
[2023-07-22 12:20:48] [config] ulr-query-vectors: ""
[2023-07-22 12:20:48] [config] ulr-softmax-temperature: 1
[2023-07-22 12:20:48] [config] ulr-trainable-transformation: false
[2023-07-22 12:20:48] [config] unlikelihood-loss: false
[2023-07-22 12:20:48] [config] valid-freq: 50000000
[2023-07-22 12:20:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 12:20:48] [config] valid-max-length: 1000
[2023-07-22 12:20:48] [config] valid-metrics:
[2023-07-22 12:20:48] [config]   - cross-entropy
[2023-07-22 12:20:48] [config]   - translation
[2023-07-22 12:20:48] [config] valid-mini-batch: 32
[2023-07-22 12:20:48] [config] valid-reset-stalled: false
[2023-07-22 12:20:48] [config] valid-script-args:
[2023-07-22 12:20:48] [config]   []
[2023-07-22 12:20:48] [config] valid-script-path: ""
[2023-07-22 12:20:48] [config] valid-sets:
[2023-07-22 12:20:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 12:20:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 12:20:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 12:20:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:20:48] [config] vocabs:
[2023-07-22 12:20:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 12:20:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 12:20:48] [config] word-penalty: 0
[2023-07-22 12:20:48] [config] word-scores: false
[2023-07-22 12:20:48] [config] workspace: 5500
[2023-07-22 12:20:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:20:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:20:48] [training] Using single-device training
[2023-07-22 12:20:49] Synced seed 1234
[2023-07-22 12:20:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 12:20:49] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 12:20:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 12:20:49] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 12:20:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 12:20:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:20:49] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 12:20:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 12:20:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 12:20:50] [comm] Using global sharding
[2023-07-22 12:20:50] [comm] NCCLCommunicators constructed successfully
[2023-07-22 12:20:50] [training] Using 1 GPUs
[2023-07-22 12:20:50] [logits] Applying loss function for 1 factor(s)
[2023-07-22 12:20:50] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:20:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 12:20:51] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:47:32] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 12:47:32] [valid] No post-processing script given for validating translator
[2023-07-22 12:47:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:47:32] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 12:47:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 12:47:32] [comm] Using global sharding
[2023-07-22 12:47:32] [comm] NCCLCommunicators constructed successfully
[2023-07-22 12:47:32] [training] Using 1 GPUs
[2023-07-22 12:47:32] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 12:47:40] Allocating memory for general optimizer shards
[2023-07-22 12:47:40] [memory] Reserving 322 MB, device gpu0
[2023-07-22 12:47:40] Loading Adam parameters
[2023-07-22 12:47:40] [memory] Reserving 322 MB, device gpu0
[2023-07-22 12:47:40] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:47:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 12:47:41] [data] Restoring the corpus state to epoch 151, batch 6565
[2023-07-22 12:47:41] [data] Shuffling data
[2023-07-22 12:47:41] [data] Done reading 20,192 sentences
[2023-07-22 12:47:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:47:41] Training started
[2023-07-22 12:47:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 12:47:41] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:47:44] Parameter type float16, optimization type float32, casting types true
[2023-07-22 12:52:01] Seen 20,192 samples
[2023-07-22 12:52:01] Starting data epoch 152 in logical epoch 152
[2023-07-22 12:52:01] [data] Shuffling data
[2023-07-22 12:52:01] [data] Done reading 20,192 sentences
[2023-07-22 12:52:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:56:32] Seen 20,192 samples
[2023-07-22 12:56:32] Starting data epoch 153 in logical epoch 153
[2023-07-22 12:56:32] [data] Shuffling data
[2023-07-22 12:56:32] [data] Done reading 20,192 sentences
[2023-07-22 12:56:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:00:59] Seen 20,192 samples
[2023-07-22 13:00:59] Starting data epoch 154 in logical epoch 154
[2023-07-22 13:00:59] [data] Shuffling data
[2023-07-22 13:00:59] [data] Done reading 20,192 sentences
[2023-07-22 13:00:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:05:31] Seen 20,192 samples
[2023-07-22 13:05:31] Starting data epoch 155 in logical epoch 155
[2023-07-22 13:05:31] [data] Shuffling data
[2023-07-22 13:05:31] [data] Done reading 20,192 sentences
[2023-07-22 13:05:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:09:51] Seen 20,192 samples
[2023-07-22 13:09:51] Starting data epoch 156 in logical epoch 156
[2023-07-22 13:09:51] [data] Shuffling data
[2023-07-22 13:09:51] [data] Done reading 20,192 sentences
[2023-07-22 13:09:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:14:17] Seen 20,192 samples
[2023-07-22 13:14:17] Starting data epoch 157 in logical epoch 157
[2023-07-22 13:14:17] [data] Shuffling data
[2023-07-22 13:14:17] [data] Done reading 20,192 sentences
[2023-07-22 13:14:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:18:38] Seen 20,192 samples
[2023-07-22 13:18:38] Starting data epoch 158 in logical epoch 158
[2023-07-22 13:18:38] [data] Shuffling data
[2023-07-22 13:18:38] [data] Done reading 20,192 sentences
[2023-07-22 13:18:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:23:03] Seen 20,192 samples
[2023-07-22 13:23:03] Starting data epoch 159 in logical epoch 159
[2023-07-22 13:23:03] [data] Shuffling data
[2023-07-22 13:23:03] [data] Done reading 20,192 sentences
[2023-07-22 13:23:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:27:19] Seen 20,192 samples
[2023-07-22 13:27:20] Starting data epoch 160 in logical epoch 160
[2023-07-22 13:27:20] [data] Shuffling data
[2023-07-22 13:27:20] [data] Done reading 20,192 sentences
[2023-07-22 13:27:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:31:48] Ep. 160 : Up. 7000 : Sen. 20,192 : Cost 3.34637141 * 12,475,965 @ 3,664 after 87,015,200 : Time 2656.24s : 4696.86 words/s : gNorm 1.8344
[2023-07-22 13:31:48] Seen 20,192 samples
[2023-07-22 13:31:48] Starting data epoch 161 in logical epoch 161
[2023-07-22 13:31:48] Training finished
[2023-07-22 13:31:58] [valid] Ep. 161 : Up. 7000 : cross-entropy : 135.319 : stalled 5 times (last best: 131.199)
[2023-07-22 13:34:31] [valid] Ep. 161 : Up. 7000 : translation : 0 : new best
[2023-07-22 13:34:31] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 13:34:34] Saving Adam parameters
[2023-07-22 13:34:34] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 13:34:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 13:34:41] [marian] Running on node22.datos.cluster.uy as process 7061 with command line:
[2023-07-22 13:34:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 13:34:41] [config] after: 0e
[2023-07-22 13:34:41] [config] after-batches: 0
[2023-07-22 13:34:41] [config] after-epochs: 170
[2023-07-22 13:34:41] [config] all-caps-every: 0
[2023-07-22 13:34:41] [config] allow-unk: false
[2023-07-22 13:34:41] [config] authors: false
[2023-07-22 13:34:41] [config] beam-size: 12
[2023-07-22 13:34:41] [config] bert-class-symbol: "[CLS]"
[2023-07-22 13:34:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 13:34:41] [config] bert-masking-fraction: 0.15
[2023-07-22 13:34:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 13:34:41] [config] bert-train-type-embeddings: true
[2023-07-22 13:34:41] [config] bert-type-vocab-size: 2
[2023-07-22 13:34:41] [config] build-info: ""
[2023-07-22 13:34:41] [config] check-gradient-nan: false
[2023-07-22 13:34:41] [config] check-nan: false
[2023-07-22 13:34:41] [config] cite: false
[2023-07-22 13:34:41] [config] clip-norm: 1
[2023-07-22 13:34:41] [config] cost-scaling:
[2023-07-22 13:34:41] [config]   - 256.f
[2023-07-22 13:34:41] [config]   - 1000
[2023-07-22 13:34:41] [config]   - 2.f
[2023-07-22 13:34:41] [config]   - 256.f
[2023-07-22 13:34:41] [config] cost-type: ce-sum
[2023-07-22 13:34:41] [config] cpu-threads: 0
[2023-07-22 13:34:41] [config] data-threads: 8
[2023-07-22 13:34:41] [config] data-weighting: ""
[2023-07-22 13:34:41] [config] data-weighting-type: sentence
[2023-07-22 13:34:41] [config] dec-cell: gru
[2023-07-22 13:34:41] [config] dec-cell-base-depth: 2
[2023-07-22 13:34:41] [config] dec-cell-high-depth: 1
[2023-07-22 13:34:41] [config] dec-depth: 1
[2023-07-22 13:34:41] [config] devices:
[2023-07-22 13:34:41] [config]   - 0
[2023-07-22 13:34:41] [config] dim-emb: 512
[2023-07-22 13:34:41] [config] dim-rnn: 1024
[2023-07-22 13:34:41] [config] dim-vocabs:
[2023-07-22 13:34:41] [config]   - 16384
[2023-07-22 13:34:41] [config]   - 16384
[2023-07-22 13:34:41] [config] disp-first: 0
[2023-07-22 13:34:41] [config] disp-freq: 1000u
[2023-07-22 13:34:41] [config] disp-label-counts: true
[2023-07-22 13:34:41] [config] dropout-rnn: 0
[2023-07-22 13:34:41] [config] dropout-src: 0
[2023-07-22 13:34:41] [config] dropout-trg: 0
[2023-07-22 13:34:41] [config] dump-config: ""
[2023-07-22 13:34:41] [config] dynamic-gradient-scaling:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] early-stopping: 200
[2023-07-22 13:34:41] [config] early-stopping-on: first
[2023-07-22 13:34:41] [config] embedding-fix-src: false
[2023-07-22 13:34:41] [config] embedding-fix-trg: false
[2023-07-22 13:34:41] [config] embedding-normalization: false
[2023-07-22 13:34:41] [config] embedding-vectors:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] enc-cell: gru
[2023-07-22 13:34:41] [config] enc-cell-depth: 1
[2023-07-22 13:34:41] [config] enc-depth: 1
[2023-07-22 13:34:41] [config] enc-type: bidirectional
[2023-07-22 13:34:41] [config] english-title-case-every: 0
[2023-07-22 13:34:41] [config] exponential-smoothing: 0
[2023-07-22 13:34:41] [config] factor-weight: 1
[2023-07-22 13:34:41] [config] factors-combine: sum
[2023-07-22 13:34:41] [config] factors-dim-emb: 0
[2023-07-22 13:34:41] [config] gradient-checkpointing: false
[2023-07-22 13:34:41] [config] gradient-norm-average-window: 100
[2023-07-22 13:34:41] [config] guided-alignment: none
[2023-07-22 13:34:41] [config] guided-alignment-cost: mse
[2023-07-22 13:34:41] [config] guided-alignment-weight: 0.1
[2023-07-22 13:34:41] [config] ignore-model-config: false
[2023-07-22 13:34:41] [config] input-types:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] interpolate-env-vars: false
[2023-07-22 13:34:41] [config] keep-best: false
[2023-07-22 13:34:41] [config] label-smoothing: 0
[2023-07-22 13:34:41] [config] layer-normalization: false
[2023-07-22 13:34:41] [config] learn-rate: 0.0001
[2023-07-22 13:34:41] [config] lemma-dependency: ""
[2023-07-22 13:34:41] [config] lemma-dim-emb: 0
[2023-07-22 13:34:41] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 13:34:41] [config] log-level: info
[2023-07-22 13:34:41] [config] log-time-zone: ""
[2023-07-22 13:34:41] [config] logical-epoch:
[2023-07-22 13:34:41] [config]   - 1e
[2023-07-22 13:34:41] [config]   - 0
[2023-07-22 13:34:41] [config] lr-decay: 0
[2023-07-22 13:34:41] [config] lr-decay-freq: 50000
[2023-07-22 13:34:41] [config] lr-decay-inv-sqrt:
[2023-07-22 13:34:41] [config]   - 0
[2023-07-22 13:34:41] [config] lr-decay-repeat-warmup: false
[2023-07-22 13:34:41] [config] lr-decay-reset-optimizer: false
[2023-07-22 13:34:41] [config] lr-decay-start:
[2023-07-22 13:34:41] [config]   - 10
[2023-07-22 13:34:41] [config]   - 1
[2023-07-22 13:34:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 13:34:41] [config] lr-report: false
[2023-07-22 13:34:41] [config] lr-warmup: 0
[2023-07-22 13:34:41] [config] lr-warmup-at-reload: false
[2023-07-22 13:34:41] [config] lr-warmup-cycle: false
[2023-07-22 13:34:41] [config] lr-warmup-start-rate: 0
[2023-07-22 13:34:41] [config] max-length: 150
[2023-07-22 13:34:41] [config] max-length-crop: true
[2023-07-22 13:34:41] [config] max-length-factor: 3
[2023-07-22 13:34:41] [config] maxi-batch: 100
[2023-07-22 13:34:41] [config] maxi-batch-sort: trg
[2023-07-22 13:34:41] [config] mini-batch: 64
[2023-07-22 13:34:41] [config] mini-batch-fit: true
[2023-07-22 13:34:41] [config] mini-batch-fit-step: 10
[2023-07-22 13:34:41] [config] mini-batch-round-up: true
[2023-07-22 13:34:41] [config] mini-batch-track-lr: false
[2023-07-22 13:34:41] [config] mini-batch-warmup: 0
[2023-07-22 13:34:41] [config] mini-batch-words: 0
[2023-07-22 13:34:41] [config] mini-batch-words-ref: 0
[2023-07-22 13:34:41] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 13:34:41] [config] multi-loss-type: sum
[2023-07-22 13:34:41] [config] n-best: false
[2023-07-22 13:34:41] [config] no-nccl: false
[2023-07-22 13:34:41] [config] no-reload: false
[2023-07-22 13:34:41] [config] no-restore-corpus: false
[2023-07-22 13:34:41] [config] normalize: 0
[2023-07-22 13:34:41] [config] normalize-gradient: false
[2023-07-22 13:34:41] [config] num-devices: 0
[2023-07-22 13:34:41] [config] optimizer: adam
[2023-07-22 13:34:41] [config] optimizer-delay: 1
[2023-07-22 13:34:41] [config] optimizer-params:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] output-omit-bias: false
[2023-07-22 13:34:41] [config] overwrite: true
[2023-07-22 13:34:41] [config] precision:
[2023-07-22 13:34:41] [config]   - float16
[2023-07-22 13:34:41] [config]   - float32
[2023-07-22 13:34:41] [config] pretrained-model: ""
[2023-07-22 13:34:41] [config] quantize-biases: false
[2023-07-22 13:34:41] [config] quantize-bits: 0
[2023-07-22 13:34:41] [config] quantize-log-based: false
[2023-07-22 13:34:41] [config] quantize-optimization-steps: 0
[2023-07-22 13:34:41] [config] quiet: false
[2023-07-22 13:34:41] [config] quiet-translation: true
[2023-07-22 13:34:41] [config] relative-paths: false
[2023-07-22 13:34:41] [config] right-left: false
[2023-07-22 13:34:41] [config] save-freq: 10000u
[2023-07-22 13:34:41] [config] seed: 1234
[2023-07-22 13:34:41] [config] sentencepiece-alphas:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] sentencepiece-max-lines: 2000000
[2023-07-22 13:34:41] [config] sentencepiece-options: ""
[2023-07-22 13:34:41] [config] sharding: global
[2023-07-22 13:34:41] [config] shuffle: data
[2023-07-22 13:34:41] [config] shuffle-in-ram: false
[2023-07-22 13:34:41] [config] sigterm: save-and-exit
[2023-07-22 13:34:41] [config] skip: false
[2023-07-22 13:34:41] [config] sqlite: ""
[2023-07-22 13:34:41] [config] sqlite-drop: false
[2023-07-22 13:34:41] [config] sync-freq: 200u
[2023-07-22 13:34:41] [config] sync-sgd: false
[2023-07-22 13:34:41] [config] tempdir: /tmp
[2023-07-22 13:34:41] [config] tied-embeddings: false
[2023-07-22 13:34:41] [config] tied-embeddings-all: true
[2023-07-22 13:34:41] [config] tied-embeddings-src: false
[2023-07-22 13:34:41] [config] train-embedder-rank:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] train-sets:
[2023-07-22 13:34:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 13:34:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 13:34:41] [config] transformer-aan-activation: swish
[2023-07-22 13:34:41] [config] transformer-aan-depth: 2
[2023-07-22 13:34:41] [config] transformer-aan-nogate: false
[2023-07-22 13:34:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 13:34:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 13:34:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 13:34:41] [config] transformer-depth-scaling: false
[2023-07-22 13:34:41] [config] transformer-dim-aan: 2048
[2023-07-22 13:34:41] [config] transformer-dim-ffn: 2048
[2023-07-22 13:34:41] [config] transformer-dropout: 0
[2023-07-22 13:34:41] [config] transformer-dropout-attention: 0
[2023-07-22 13:34:41] [config] transformer-dropout-ffn: 0
[2023-07-22 13:34:41] [config] transformer-ffn-activation: swish
[2023-07-22 13:34:41] [config] transformer-ffn-depth: 2
[2023-07-22 13:34:41] [config] transformer-guided-alignment-layer: last
[2023-07-22 13:34:41] [config] transformer-heads: 8
[2023-07-22 13:34:41] [config] transformer-no-projection: false
[2023-07-22 13:34:41] [config] transformer-pool: false
[2023-07-22 13:34:41] [config] transformer-postprocess: dan
[2023-07-22 13:34:41] [config] transformer-postprocess-emb: d
[2023-07-22 13:34:41] [config] transformer-postprocess-top: ""
[2023-07-22 13:34:41] [config] transformer-preprocess: ""
[2023-07-22 13:34:41] [config] transformer-tied-layers:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] transformer-train-position-embeddings: false
[2023-07-22 13:34:41] [config] tsv: false
[2023-07-22 13:34:41] [config] tsv-fields: 0
[2023-07-22 13:34:41] [config] type: amun
[2023-07-22 13:34:41] [config] ulr: false
[2023-07-22 13:34:41] [config] ulr-dim-emb: 0
[2023-07-22 13:34:41] [config] ulr-dropout: 0
[2023-07-22 13:34:41] [config] ulr-keys-vectors: ""
[2023-07-22 13:34:41] [config] ulr-query-vectors: ""
[2023-07-22 13:34:41] [config] ulr-softmax-temperature: 1
[2023-07-22 13:34:41] [config] ulr-trainable-transformation: false
[2023-07-22 13:34:41] [config] unlikelihood-loss: false
[2023-07-22 13:34:41] [config] valid-freq: 50000000
[2023-07-22 13:34:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 13:34:41] [config] valid-max-length: 1000
[2023-07-22 13:34:41] [config] valid-metrics:
[2023-07-22 13:34:41] [config]   - cross-entropy
[2023-07-22 13:34:41] [config]   - translation
[2023-07-22 13:34:41] [config] valid-mini-batch: 32
[2023-07-22 13:34:41] [config] valid-reset-stalled: false
[2023-07-22 13:34:41] [config] valid-script-args:
[2023-07-22 13:34:41] [config]   []
[2023-07-22 13:34:41] [config] valid-script-path: ""
[2023-07-22 13:34:41] [config] valid-sets:
[2023-07-22 13:34:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 13:34:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 13:34:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 13:34:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 13:34:41] [config] vocabs:
[2023-07-22 13:34:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 13:34:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 13:34:41] [config] word-penalty: 0
[2023-07-22 13:34:41] [config] word-scores: false
[2023-07-22 13:34:41] [config] workspace: 5500
[2023-07-22 13:34:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 13:34:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 13:34:41] [training] Using single-device training
[2023-07-22 13:34:42] Synced seed 1234
[2023-07-22 13:34:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 13:34:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 13:34:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 13:34:42] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 13:34:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 13:34:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 13:34:42] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 13:34:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 13:34:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 13:34:43] [comm] Using global sharding
[2023-07-22 13:34:43] [comm] NCCLCommunicators constructed successfully
[2023-07-22 13:34:43] [training] Using 1 GPUs
[2023-07-22 13:34:43] [logits] Applying loss function for 1 factor(s)
[2023-07-22 13:34:43] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:34:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 13:34:43] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:01:11] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 14:01:11] [valid] No post-processing script given for validating translator
[2023-07-22 14:01:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 14:01:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 14:01:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 14:01:11] [comm] Using global sharding
[2023-07-22 14:01:11] [comm] NCCLCommunicators constructed successfully
[2023-07-22 14:01:11] [training] Using 1 GPUs
[2023-07-22 14:01:11] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 14:01:18] Allocating memory for general optimizer shards
[2023-07-22 14:01:18] [memory] Reserving 322 MB, device gpu0
[2023-07-22 14:01:18] Loading Adam parameters
[2023-07-22 14:01:18] [memory] Reserving 322 MB, device gpu0
[2023-07-22 14:01:18] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:01:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 14:01:19] [data] Restoring the corpus state to epoch 161, batch 7000
[2023-07-22 14:01:19] [data] Shuffling data
[2023-07-22 14:01:19] [data] Done reading 20,192 sentences
[2023-07-22 14:01:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:01:19] Training started
[2023-07-22 14:01:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 14:01:19] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:01:20] Parameter type float16, optimization type float32, casting types true
[2023-07-22 14:05:41] Seen 20,192 samples
[2023-07-22 14:05:41] Starting data epoch 162 in logical epoch 162
[2023-07-22 14:05:41] [data] Shuffling data
[2023-07-22 14:05:41] [data] Done reading 20,192 sentences
[2023-07-22 14:05:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:10:07] Seen 20,192 samples
[2023-07-22 14:10:07] Starting data epoch 163 in logical epoch 163
[2023-07-22 14:10:07] [data] Shuffling data
[2023-07-22 14:10:07] [data] Done reading 20,192 sentences
[2023-07-22 14:10:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:14:21] Seen 20,192 samples
[2023-07-22 14:14:21] Starting data epoch 164 in logical epoch 164
[2023-07-22 14:14:21] [data] Shuffling data
[2023-07-22 14:14:21] [data] Done reading 20,192 sentences
[2023-07-22 14:14:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:18:47] Seen 20,192 samples
[2023-07-22 14:18:47] Starting data epoch 165 in logical epoch 165
[2023-07-22 14:18:47] [data] Shuffling data
[2023-07-22 14:18:47] [data] Done reading 20,192 sentences
[2023-07-22 14:18:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:23:09] Seen 20,192 samples
[2023-07-22 14:23:09] Starting data epoch 166 in logical epoch 166
[2023-07-22 14:23:09] [data] Shuffling data
[2023-07-22 14:23:09] [data] Done reading 20,192 sentences
[2023-07-22 14:23:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:27:33] Seen 20,192 samples
[2023-07-22 14:27:33] Starting data epoch 167 in logical epoch 167
[2023-07-22 14:27:33] [data] Shuffling data
[2023-07-22 14:27:33] [data] Done reading 20,192 sentences
[2023-07-22 14:27:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:32:04] Seen 20,192 samples
[2023-07-22 14:32:04] Starting data epoch 168 in logical epoch 168
[2023-07-22 14:32:04] [data] Shuffling data
[2023-07-22 14:32:04] [data] Done reading 20,192 sentences
[2023-07-22 14:32:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:36:25] Seen 20,192 samples
[2023-07-22 14:36:25] Starting data epoch 169 in logical epoch 169
[2023-07-22 14:36:25] [data] Shuffling data
[2023-07-22 14:36:25] [data] Done reading 20,192 sentences
[2023-07-22 14:36:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:40:43] Seen 20,192 samples
[2023-07-22 14:40:43] Starting data epoch 170 in logical epoch 170
[2023-07-22 14:40:43] [data] Shuffling data
[2023-07-22 14:40:43] [data] Done reading 20,192 sentences
[2023-07-22 14:40:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:45:07] Seen 20,192 samples
[2023-07-22 14:45:07] Starting data epoch 171 in logical epoch 171
[2023-07-22 14:45:07] Training finished
[2023-07-22 14:45:18] [valid] Ep. 171 : Up. 7436 : cross-entropy : 136.92 : stalled 6 times (last best: 131.199)
[2023-07-22 14:47:49] [valid] Ep. 171 : Up. 7436 : translation : 0 : new best
[2023-07-22 14:47:49] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 14:47:51] Saving Adam parameters
[2023-07-22 14:47:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 14:47:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 14:47:59] [marian] Running on node22.datos.cluster.uy as process 11654 with command line:
[2023-07-22 14:47:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 14:47:59] [config] after: 0e
[2023-07-22 14:47:59] [config] after-batches: 0
[2023-07-22 14:47:59] [config] after-epochs: 180
[2023-07-22 14:47:59] [config] all-caps-every: 0
[2023-07-22 14:47:59] [config] allow-unk: false
[2023-07-22 14:47:59] [config] authors: false
[2023-07-22 14:47:59] [config] beam-size: 12
[2023-07-22 14:47:59] [config] bert-class-symbol: "[CLS]"
[2023-07-22 14:47:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 14:47:59] [config] bert-masking-fraction: 0.15
[2023-07-22 14:47:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 14:47:59] [config] bert-train-type-embeddings: true
[2023-07-22 14:47:59] [config] bert-type-vocab-size: 2
[2023-07-22 14:47:59] [config] build-info: ""
[2023-07-22 14:47:59] [config] check-gradient-nan: false
[2023-07-22 14:47:59] [config] check-nan: false
[2023-07-22 14:47:59] [config] cite: false
[2023-07-22 14:47:59] [config] clip-norm: 1
[2023-07-22 14:47:59] [config] cost-scaling:
[2023-07-22 14:47:59] [config]   - 256.f
[2023-07-22 14:47:59] [config]   - 1000
[2023-07-22 14:47:59] [config]   - 2.f
[2023-07-22 14:47:59] [config]   - 256.f
[2023-07-22 14:47:59] [config] cost-type: ce-sum
[2023-07-22 14:47:59] [config] cpu-threads: 0
[2023-07-22 14:47:59] [config] data-threads: 8
[2023-07-22 14:47:59] [config] data-weighting: ""
[2023-07-22 14:47:59] [config] data-weighting-type: sentence
[2023-07-22 14:47:59] [config] dec-cell: gru
[2023-07-22 14:47:59] [config] dec-cell-base-depth: 2
[2023-07-22 14:47:59] [config] dec-cell-high-depth: 1
[2023-07-22 14:47:59] [config] dec-depth: 1
[2023-07-22 14:47:59] [config] devices:
[2023-07-22 14:47:59] [config]   - 0
[2023-07-22 14:47:59] [config] dim-emb: 512
[2023-07-22 14:47:59] [config] dim-rnn: 1024
[2023-07-22 14:47:59] [config] dim-vocabs:
[2023-07-22 14:47:59] [config]   - 16384
[2023-07-22 14:47:59] [config]   - 16384
[2023-07-22 14:47:59] [config] disp-first: 0
[2023-07-22 14:47:59] [config] disp-freq: 1000u
[2023-07-22 14:47:59] [config] disp-label-counts: true
[2023-07-22 14:47:59] [config] dropout-rnn: 0
[2023-07-22 14:47:59] [config] dropout-src: 0
[2023-07-22 14:47:59] [config] dropout-trg: 0
[2023-07-22 14:47:59] [config] dump-config: ""
[2023-07-22 14:47:59] [config] dynamic-gradient-scaling:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] early-stopping: 200
[2023-07-22 14:47:59] [config] early-stopping-on: first
[2023-07-22 14:47:59] [config] embedding-fix-src: false
[2023-07-22 14:47:59] [config] embedding-fix-trg: false
[2023-07-22 14:47:59] [config] embedding-normalization: false
[2023-07-22 14:47:59] [config] embedding-vectors:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] enc-cell: gru
[2023-07-22 14:47:59] [config] enc-cell-depth: 1
[2023-07-22 14:47:59] [config] enc-depth: 1
[2023-07-22 14:47:59] [config] enc-type: bidirectional
[2023-07-22 14:47:59] [config] english-title-case-every: 0
[2023-07-22 14:47:59] [config] exponential-smoothing: 0
[2023-07-22 14:47:59] [config] factor-weight: 1
[2023-07-22 14:47:59] [config] factors-combine: sum
[2023-07-22 14:47:59] [config] factors-dim-emb: 0
[2023-07-22 14:47:59] [config] gradient-checkpointing: false
[2023-07-22 14:47:59] [config] gradient-norm-average-window: 100
[2023-07-22 14:47:59] [config] guided-alignment: none
[2023-07-22 14:47:59] [config] guided-alignment-cost: mse
[2023-07-22 14:47:59] [config] guided-alignment-weight: 0.1
[2023-07-22 14:47:59] [config] ignore-model-config: false
[2023-07-22 14:47:59] [config] input-types:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] interpolate-env-vars: false
[2023-07-22 14:47:59] [config] keep-best: false
[2023-07-22 14:47:59] [config] label-smoothing: 0
[2023-07-22 14:47:59] [config] layer-normalization: false
[2023-07-22 14:47:59] [config] learn-rate: 0.0001
[2023-07-22 14:47:59] [config] lemma-dependency: ""
[2023-07-22 14:47:59] [config] lemma-dim-emb: 0
[2023-07-22 14:47:59] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 14:47:59] [config] log-level: info
[2023-07-22 14:47:59] [config] log-time-zone: ""
[2023-07-22 14:47:59] [config] logical-epoch:
[2023-07-22 14:47:59] [config]   - 1e
[2023-07-22 14:47:59] [config]   - 0
[2023-07-22 14:47:59] [config] lr-decay: 0
[2023-07-22 14:47:59] [config] lr-decay-freq: 50000
[2023-07-22 14:47:59] [config] lr-decay-inv-sqrt:
[2023-07-22 14:47:59] [config]   - 0
[2023-07-22 14:47:59] [config] lr-decay-repeat-warmup: false
[2023-07-22 14:47:59] [config] lr-decay-reset-optimizer: false
[2023-07-22 14:47:59] [config] lr-decay-start:
[2023-07-22 14:47:59] [config]   - 10
[2023-07-22 14:47:59] [config]   - 1
[2023-07-22 14:47:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 14:47:59] [config] lr-report: false
[2023-07-22 14:47:59] [config] lr-warmup: 0
[2023-07-22 14:47:59] [config] lr-warmup-at-reload: false
[2023-07-22 14:47:59] [config] lr-warmup-cycle: false
[2023-07-22 14:47:59] [config] lr-warmup-start-rate: 0
[2023-07-22 14:47:59] [config] max-length: 150
[2023-07-22 14:47:59] [config] max-length-crop: true
[2023-07-22 14:47:59] [config] max-length-factor: 3
[2023-07-22 14:47:59] [config] maxi-batch: 100
[2023-07-22 14:47:59] [config] maxi-batch-sort: trg
[2023-07-22 14:47:59] [config] mini-batch: 64
[2023-07-22 14:47:59] [config] mini-batch-fit: true
[2023-07-22 14:47:59] [config] mini-batch-fit-step: 10
[2023-07-22 14:47:59] [config] mini-batch-round-up: true
[2023-07-22 14:47:59] [config] mini-batch-track-lr: false
[2023-07-22 14:47:59] [config] mini-batch-warmup: 0
[2023-07-22 14:47:59] [config] mini-batch-words: 0
[2023-07-22 14:47:59] [config] mini-batch-words-ref: 0
[2023-07-22 14:47:59] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 14:47:59] [config] multi-loss-type: sum
[2023-07-22 14:47:59] [config] n-best: false
[2023-07-22 14:47:59] [config] no-nccl: false
[2023-07-22 14:47:59] [config] no-reload: false
[2023-07-22 14:47:59] [config] no-restore-corpus: false
[2023-07-22 14:47:59] [config] normalize: 0
[2023-07-22 14:47:59] [config] normalize-gradient: false
[2023-07-22 14:47:59] [config] num-devices: 0
[2023-07-22 14:47:59] [config] optimizer: adam
[2023-07-22 14:47:59] [config] optimizer-delay: 1
[2023-07-22 14:47:59] [config] optimizer-params:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] output-omit-bias: false
[2023-07-22 14:47:59] [config] overwrite: true
[2023-07-22 14:47:59] [config] precision:
[2023-07-22 14:47:59] [config]   - float16
[2023-07-22 14:47:59] [config]   - float32
[2023-07-22 14:47:59] [config] pretrained-model: ""
[2023-07-22 14:47:59] [config] quantize-biases: false
[2023-07-22 14:47:59] [config] quantize-bits: 0
[2023-07-22 14:47:59] [config] quantize-log-based: false
[2023-07-22 14:47:59] [config] quantize-optimization-steps: 0
[2023-07-22 14:47:59] [config] quiet: false
[2023-07-22 14:47:59] [config] quiet-translation: true
[2023-07-22 14:47:59] [config] relative-paths: false
[2023-07-22 14:47:59] [config] right-left: false
[2023-07-22 14:47:59] [config] save-freq: 10000u
[2023-07-22 14:47:59] [config] seed: 1234
[2023-07-22 14:47:59] [config] sentencepiece-alphas:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] sentencepiece-max-lines: 2000000
[2023-07-22 14:47:59] [config] sentencepiece-options: ""
[2023-07-22 14:47:59] [config] sharding: global
[2023-07-22 14:47:59] [config] shuffle: data
[2023-07-22 14:47:59] [config] shuffle-in-ram: false
[2023-07-22 14:47:59] [config] sigterm: save-and-exit
[2023-07-22 14:47:59] [config] skip: false
[2023-07-22 14:47:59] [config] sqlite: ""
[2023-07-22 14:47:59] [config] sqlite-drop: false
[2023-07-22 14:47:59] [config] sync-freq: 200u
[2023-07-22 14:47:59] [config] sync-sgd: false
[2023-07-22 14:47:59] [config] tempdir: /tmp
[2023-07-22 14:47:59] [config] tied-embeddings: false
[2023-07-22 14:47:59] [config] tied-embeddings-all: true
[2023-07-22 14:47:59] [config] tied-embeddings-src: false
[2023-07-22 14:47:59] [config] train-embedder-rank:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] train-sets:
[2023-07-22 14:47:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 14:47:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 14:47:59] [config] transformer-aan-activation: swish
[2023-07-22 14:47:59] [config] transformer-aan-depth: 2
[2023-07-22 14:47:59] [config] transformer-aan-nogate: false
[2023-07-22 14:47:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 14:47:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 14:47:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 14:47:59] [config] transformer-depth-scaling: false
[2023-07-22 14:47:59] [config] transformer-dim-aan: 2048
[2023-07-22 14:47:59] [config] transformer-dim-ffn: 2048
[2023-07-22 14:47:59] [config] transformer-dropout: 0
[2023-07-22 14:47:59] [config] transformer-dropout-attention: 0
[2023-07-22 14:47:59] [config] transformer-dropout-ffn: 0
[2023-07-22 14:47:59] [config] transformer-ffn-activation: swish
[2023-07-22 14:47:59] [config] transformer-ffn-depth: 2
[2023-07-22 14:47:59] [config] transformer-guided-alignment-layer: last
[2023-07-22 14:47:59] [config] transformer-heads: 8
[2023-07-22 14:47:59] [config] transformer-no-projection: false
[2023-07-22 14:47:59] [config] transformer-pool: false
[2023-07-22 14:47:59] [config] transformer-postprocess: dan
[2023-07-22 14:47:59] [config] transformer-postprocess-emb: d
[2023-07-22 14:47:59] [config] transformer-postprocess-top: ""
[2023-07-22 14:47:59] [config] transformer-preprocess: ""
[2023-07-22 14:47:59] [config] transformer-tied-layers:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] transformer-train-position-embeddings: false
[2023-07-22 14:47:59] [config] tsv: false
[2023-07-22 14:47:59] [config] tsv-fields: 0
[2023-07-22 14:47:59] [config] type: amun
[2023-07-22 14:47:59] [config] ulr: false
[2023-07-22 14:47:59] [config] ulr-dim-emb: 0
[2023-07-22 14:47:59] [config] ulr-dropout: 0
[2023-07-22 14:47:59] [config] ulr-keys-vectors: ""
[2023-07-22 14:47:59] [config] ulr-query-vectors: ""
[2023-07-22 14:47:59] [config] ulr-softmax-temperature: 1
[2023-07-22 14:47:59] [config] ulr-trainable-transformation: false
[2023-07-22 14:47:59] [config] unlikelihood-loss: false
[2023-07-22 14:47:59] [config] valid-freq: 50000000
[2023-07-22 14:47:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 14:47:59] [config] valid-max-length: 1000
[2023-07-22 14:47:59] [config] valid-metrics:
[2023-07-22 14:47:59] [config]   - cross-entropy
[2023-07-22 14:47:59] [config]   - translation
[2023-07-22 14:47:59] [config] valid-mini-batch: 32
[2023-07-22 14:47:59] [config] valid-reset-stalled: false
[2023-07-22 14:47:59] [config] valid-script-args:
[2023-07-22 14:47:59] [config]   []
[2023-07-22 14:47:59] [config] valid-script-path: ""
[2023-07-22 14:47:59] [config] valid-sets:
[2023-07-22 14:47:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 14:47:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 14:47:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 14:47:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 14:47:59] [config] vocabs:
[2023-07-22 14:47:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 14:47:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 14:47:59] [config] word-penalty: 0
[2023-07-22 14:47:59] [config] word-scores: false
[2023-07-22 14:47:59] [config] workspace: 5500
[2023-07-22 14:47:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 14:47:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 14:47:59] [training] Using single-device training
[2023-07-22 14:48:00] Synced seed 1234
[2023-07-22 14:48:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 14:48:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 14:48:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 14:48:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 14:48:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 14:48:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 14:48:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 14:48:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 14:48:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 14:48:01] [comm] Using global sharding
[2023-07-22 14:48:01] [comm] NCCLCommunicators constructed successfully
[2023-07-22 14:48:01] [training] Using 1 GPUs
[2023-07-22 14:48:01] [logits] Applying loss function for 1 factor(s)
[2023-07-22 14:48:01] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:48:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 14:48:01] [memory] Reserving 80 MB, device gpu0
[2023-07-22 15:15:30] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 15:15:30] [valid] No post-processing script given for validating translator
[2023-07-22 15:15:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 15:15:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 15:15:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 15:15:30] [comm] Using global sharding
[2023-07-22 15:15:30] [comm] NCCLCommunicators constructed successfully
[2023-07-22 15:15:30] [training] Using 1 GPUs
[2023-07-22 15:15:30] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 15:15:39] Allocating memory for general optimizer shards
[2023-07-22 15:15:39] [memory] Reserving 322 MB, device gpu0
[2023-07-22 15:15:39] Loading Adam parameters
[2023-07-22 15:15:39] [memory] Reserving 322 MB, device gpu0
[2023-07-22 15:15:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 15:15:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 15:15:39] [data] Restoring the corpus state to epoch 171, batch 7436
[2023-07-22 15:15:39] [data] Shuffling data
[2023-07-22 15:15:39] [data] Done reading 20,192 sentences
[2023-07-22 15:15:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:15:39] Training started
[2023-07-22 15:15:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 15:15:40] [memory] Reserving 80 MB, device gpu0
[2023-07-22 15:15:42] Parameter type float16, optimization type float32, casting types true
[2023-07-22 15:19:54] Seen 20,192 samples
[2023-07-22 15:19:54] Starting data epoch 172 in logical epoch 172
[2023-07-22 15:19:54] [data] Shuffling data
[2023-07-22 15:19:54] [data] Done reading 20,192 sentences
[2023-07-22 15:19:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:24:21] Seen 20,192 samples
[2023-07-22 15:24:21] Starting data epoch 173 in logical epoch 173
[2023-07-22 15:24:21] [data] Shuffling data
[2023-07-22 15:24:21] [data] Done reading 20,192 sentences
[2023-07-22 15:24:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:28:17] Seen 20,192 samples
[2023-07-22 15:28:17] Starting data epoch 174 in logical epoch 174
[2023-07-22 15:28:17] [data] Shuffling data
[2023-07-22 15:28:17] [data] Done reading 20,192 sentences
[2023-07-22 15:28:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:32:25] Seen 20,192 samples
[2023-07-22 15:32:25] Starting data epoch 175 in logical epoch 175
[2023-07-22 15:32:25] [data] Shuffling data
[2023-07-22 15:32:25] [data] Done reading 20,192 sentences
[2023-07-22 15:32:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:36:57] Seen 20,192 samples
[2023-07-22 15:36:57] Starting data epoch 176 in logical epoch 176
[2023-07-22 15:36:57] [data] Shuffling data
[2023-07-22 15:36:57] [data] Done reading 20,192 sentences
[2023-07-22 15:36:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:41:24] Seen 20,192 samples
[2023-07-22 15:41:24] Starting data epoch 177 in logical epoch 177
[2023-07-22 15:41:24] [data] Shuffling data
[2023-07-22 15:41:24] [data] Done reading 20,192 sentences
[2023-07-22 15:41:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:45:40] Seen 20,192 samples
[2023-07-22 15:45:40] Starting data epoch 178 in logical epoch 178
[2023-07-22 15:45:40] [data] Shuffling data
[2023-07-22 15:45:40] [data] Done reading 20,192 sentences
[2023-07-22 15:45:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:50:09] Seen 20,192 samples
[2023-07-22 15:50:09] Starting data epoch 179 in logical epoch 179
[2023-07-22 15:50:09] [data] Shuffling data
[2023-07-22 15:50:09] [data] Done reading 20,192 sentences
[2023-07-22 15:50:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:54:34] Seen 20,192 samples
[2023-07-22 15:54:34] Starting data epoch 180 in logical epoch 180
[2023-07-22 15:54:34] [data] Shuffling data
[2023-07-22 15:54:34] [data] Done reading 20,192 sentences
[2023-07-22 15:54:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:58:57] Seen 20,192 samples
[2023-07-22 15:58:57] Starting data epoch 181 in logical epoch 181
[2023-07-22 15:58:57] Training finished
[2023-07-22 15:59:07] [valid] Ep. 181 : Up. 7874 : cross-entropy : 138.784 : stalled 7 times (last best: 131.199)
[2023-07-22 16:01:41] [valid] Ep. 181 : Up. 7874 : translation : 0 : new best
[2023-07-22 16:01:41] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 16:01:43] Saving Adam parameters
[2023-07-22 16:01:43] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 16:01:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:01:50] [marian] Running on node22.datos.cluster.uy as process 16564 with command line:
[2023-07-22 16:01:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 16:01:50] [config] after: 0e
[2023-07-22 16:01:50] [config] after-batches: 0
[2023-07-22 16:01:50] [config] after-epochs: 190
[2023-07-22 16:01:50] [config] all-caps-every: 0
[2023-07-22 16:01:50] [config] allow-unk: false
[2023-07-22 16:01:50] [config] authors: false
[2023-07-22 16:01:50] [config] beam-size: 12
[2023-07-22 16:01:50] [config] bert-class-symbol: "[CLS]"
[2023-07-22 16:01:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 16:01:50] [config] bert-masking-fraction: 0.15
[2023-07-22 16:01:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 16:01:50] [config] bert-train-type-embeddings: true
[2023-07-22 16:01:50] [config] bert-type-vocab-size: 2
[2023-07-22 16:01:50] [config] build-info: ""
[2023-07-22 16:01:50] [config] check-gradient-nan: false
[2023-07-22 16:01:50] [config] check-nan: false
[2023-07-22 16:01:50] [config] cite: false
[2023-07-22 16:01:50] [config] clip-norm: 1
[2023-07-22 16:01:50] [config] cost-scaling:
[2023-07-22 16:01:50] [config]   - 256.f
[2023-07-22 16:01:50] [config]   - 1000
[2023-07-22 16:01:50] [config]   - 2.f
[2023-07-22 16:01:50] [config]   - 256.f
[2023-07-22 16:01:50] [config] cost-type: ce-sum
[2023-07-22 16:01:50] [config] cpu-threads: 0
[2023-07-22 16:01:50] [config] data-threads: 8
[2023-07-22 16:01:50] [config] data-weighting: ""
[2023-07-22 16:01:50] [config] data-weighting-type: sentence
[2023-07-22 16:01:50] [config] dec-cell: gru
[2023-07-22 16:01:50] [config] dec-cell-base-depth: 2
[2023-07-22 16:01:50] [config] dec-cell-high-depth: 1
[2023-07-22 16:01:50] [config] dec-depth: 1
[2023-07-22 16:01:50] [config] devices:
[2023-07-22 16:01:50] [config]   - 0
[2023-07-22 16:01:50] [config] dim-emb: 512
[2023-07-22 16:01:50] [config] dim-rnn: 1024
[2023-07-22 16:01:50] [config] dim-vocabs:
[2023-07-22 16:01:50] [config]   - 16384
[2023-07-22 16:01:50] [config]   - 16384
[2023-07-22 16:01:50] [config] disp-first: 0
[2023-07-22 16:01:50] [config] disp-freq: 1000u
[2023-07-22 16:01:50] [config] disp-label-counts: true
[2023-07-22 16:01:50] [config] dropout-rnn: 0
[2023-07-22 16:01:50] [config] dropout-src: 0
[2023-07-22 16:01:50] [config] dropout-trg: 0
[2023-07-22 16:01:50] [config] dump-config: ""
[2023-07-22 16:01:50] [config] dynamic-gradient-scaling:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] early-stopping: 200
[2023-07-22 16:01:50] [config] early-stopping-on: first
[2023-07-22 16:01:50] [config] embedding-fix-src: false
[2023-07-22 16:01:50] [config] embedding-fix-trg: false
[2023-07-22 16:01:50] [config] embedding-normalization: false
[2023-07-22 16:01:50] [config] embedding-vectors:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] enc-cell: gru
[2023-07-22 16:01:50] [config] enc-cell-depth: 1
[2023-07-22 16:01:50] [config] enc-depth: 1
[2023-07-22 16:01:50] [config] enc-type: bidirectional
[2023-07-22 16:01:50] [config] english-title-case-every: 0
[2023-07-22 16:01:50] [config] exponential-smoothing: 0
[2023-07-22 16:01:50] [config] factor-weight: 1
[2023-07-22 16:01:50] [config] factors-combine: sum
[2023-07-22 16:01:50] [config] factors-dim-emb: 0
[2023-07-22 16:01:50] [config] gradient-checkpointing: false
[2023-07-22 16:01:50] [config] gradient-norm-average-window: 100
[2023-07-22 16:01:50] [config] guided-alignment: none
[2023-07-22 16:01:50] [config] guided-alignment-cost: mse
[2023-07-22 16:01:50] [config] guided-alignment-weight: 0.1
[2023-07-22 16:01:50] [config] ignore-model-config: false
[2023-07-22 16:01:50] [config] input-types:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] interpolate-env-vars: false
[2023-07-22 16:01:50] [config] keep-best: false
[2023-07-22 16:01:50] [config] label-smoothing: 0
[2023-07-22 16:01:50] [config] layer-normalization: false
[2023-07-22 16:01:50] [config] learn-rate: 0.0001
[2023-07-22 16:01:50] [config] lemma-dependency: ""
[2023-07-22 16:01:50] [config] lemma-dim-emb: 0
[2023-07-22 16:01:50] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 16:01:50] [config] log-level: info
[2023-07-22 16:01:50] [config] log-time-zone: ""
[2023-07-22 16:01:50] [config] logical-epoch:
[2023-07-22 16:01:50] [config]   - 1e
[2023-07-22 16:01:50] [config]   - 0
[2023-07-22 16:01:50] [config] lr-decay: 0
[2023-07-22 16:01:50] [config] lr-decay-freq: 50000
[2023-07-22 16:01:50] [config] lr-decay-inv-sqrt:
[2023-07-22 16:01:50] [config]   - 0
[2023-07-22 16:01:50] [config] lr-decay-repeat-warmup: false
[2023-07-22 16:01:50] [config] lr-decay-reset-optimizer: false
[2023-07-22 16:01:50] [config] lr-decay-start:
[2023-07-22 16:01:50] [config]   - 10
[2023-07-22 16:01:50] [config]   - 1
[2023-07-22 16:01:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 16:01:50] [config] lr-report: false
[2023-07-22 16:01:50] [config] lr-warmup: 0
[2023-07-22 16:01:50] [config] lr-warmup-at-reload: false
[2023-07-22 16:01:50] [config] lr-warmup-cycle: false
[2023-07-22 16:01:50] [config] lr-warmup-start-rate: 0
[2023-07-22 16:01:50] [config] max-length: 150
[2023-07-22 16:01:50] [config] max-length-crop: true
[2023-07-22 16:01:50] [config] max-length-factor: 3
[2023-07-22 16:01:50] [config] maxi-batch: 100
[2023-07-22 16:01:50] [config] maxi-batch-sort: trg
[2023-07-22 16:01:50] [config] mini-batch: 64
[2023-07-22 16:01:50] [config] mini-batch-fit: true
[2023-07-22 16:01:50] [config] mini-batch-fit-step: 10
[2023-07-22 16:01:50] [config] mini-batch-round-up: true
[2023-07-22 16:01:50] [config] mini-batch-track-lr: false
[2023-07-22 16:01:50] [config] mini-batch-warmup: 0
[2023-07-22 16:01:50] [config] mini-batch-words: 0
[2023-07-22 16:01:50] [config] mini-batch-words-ref: 0
[2023-07-22 16:01:50] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 16:01:50] [config] multi-loss-type: sum
[2023-07-22 16:01:50] [config] n-best: false
[2023-07-22 16:01:50] [config] no-nccl: false
[2023-07-22 16:01:50] [config] no-reload: false
[2023-07-22 16:01:50] [config] no-restore-corpus: false
[2023-07-22 16:01:50] [config] normalize: 0
[2023-07-22 16:01:50] [config] normalize-gradient: false
[2023-07-22 16:01:50] [config] num-devices: 0
[2023-07-22 16:01:50] [config] optimizer: adam
[2023-07-22 16:01:50] [config] optimizer-delay: 1
[2023-07-22 16:01:50] [config] optimizer-params:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] output-omit-bias: false
[2023-07-22 16:01:50] [config] overwrite: true
[2023-07-22 16:01:50] [config] precision:
[2023-07-22 16:01:50] [config]   - float16
[2023-07-22 16:01:50] [config]   - float32
[2023-07-22 16:01:50] [config] pretrained-model: ""
[2023-07-22 16:01:50] [config] quantize-biases: false
[2023-07-22 16:01:50] [config] quantize-bits: 0
[2023-07-22 16:01:50] [config] quantize-log-based: false
[2023-07-22 16:01:50] [config] quantize-optimization-steps: 0
[2023-07-22 16:01:50] [config] quiet: false
[2023-07-22 16:01:50] [config] quiet-translation: true
[2023-07-22 16:01:50] [config] relative-paths: false
[2023-07-22 16:01:50] [config] right-left: false
[2023-07-22 16:01:50] [config] save-freq: 10000u
[2023-07-22 16:01:50] [config] seed: 1234
[2023-07-22 16:01:50] [config] sentencepiece-alphas:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] sentencepiece-max-lines: 2000000
[2023-07-22 16:01:50] [config] sentencepiece-options: ""
[2023-07-22 16:01:50] [config] sharding: global
[2023-07-22 16:01:50] [config] shuffle: data
[2023-07-22 16:01:50] [config] shuffle-in-ram: false
[2023-07-22 16:01:50] [config] sigterm: save-and-exit
[2023-07-22 16:01:50] [config] skip: false
[2023-07-22 16:01:50] [config] sqlite: ""
[2023-07-22 16:01:50] [config] sqlite-drop: false
[2023-07-22 16:01:50] [config] sync-freq: 200u
[2023-07-22 16:01:50] [config] sync-sgd: false
[2023-07-22 16:01:50] [config] tempdir: /tmp
[2023-07-22 16:01:50] [config] tied-embeddings: false
[2023-07-22 16:01:50] [config] tied-embeddings-all: true
[2023-07-22 16:01:50] [config] tied-embeddings-src: false
[2023-07-22 16:01:50] [config] train-embedder-rank:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] train-sets:
[2023-07-22 16:01:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 16:01:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 16:01:50] [config] transformer-aan-activation: swish
[2023-07-22 16:01:50] [config] transformer-aan-depth: 2
[2023-07-22 16:01:50] [config] transformer-aan-nogate: false
[2023-07-22 16:01:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 16:01:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 16:01:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 16:01:50] [config] transformer-depth-scaling: false
[2023-07-22 16:01:50] [config] transformer-dim-aan: 2048
[2023-07-22 16:01:50] [config] transformer-dim-ffn: 2048
[2023-07-22 16:01:50] [config] transformer-dropout: 0
[2023-07-22 16:01:50] [config] transformer-dropout-attention: 0
[2023-07-22 16:01:50] [config] transformer-dropout-ffn: 0
[2023-07-22 16:01:50] [config] transformer-ffn-activation: swish
[2023-07-22 16:01:50] [config] transformer-ffn-depth: 2
[2023-07-22 16:01:50] [config] transformer-guided-alignment-layer: last
[2023-07-22 16:01:50] [config] transformer-heads: 8
[2023-07-22 16:01:50] [config] transformer-no-projection: false
[2023-07-22 16:01:50] [config] transformer-pool: false
[2023-07-22 16:01:50] [config] transformer-postprocess: dan
[2023-07-22 16:01:50] [config] transformer-postprocess-emb: d
[2023-07-22 16:01:50] [config] transformer-postprocess-top: ""
[2023-07-22 16:01:50] [config] transformer-preprocess: ""
[2023-07-22 16:01:50] [config] transformer-tied-layers:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] transformer-train-position-embeddings: false
[2023-07-22 16:01:50] [config] tsv: false
[2023-07-22 16:01:50] [config] tsv-fields: 0
[2023-07-22 16:01:50] [config] type: amun
[2023-07-22 16:01:50] [config] ulr: false
[2023-07-22 16:01:50] [config] ulr-dim-emb: 0
[2023-07-22 16:01:50] [config] ulr-dropout: 0
[2023-07-22 16:01:50] [config] ulr-keys-vectors: ""
[2023-07-22 16:01:50] [config] ulr-query-vectors: ""
[2023-07-22 16:01:50] [config] ulr-softmax-temperature: 1
[2023-07-22 16:01:50] [config] ulr-trainable-transformation: false
[2023-07-22 16:01:50] [config] unlikelihood-loss: false
[2023-07-22 16:01:50] [config] valid-freq: 50000000
[2023-07-22 16:01:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 16:01:50] [config] valid-max-length: 1000
[2023-07-22 16:01:50] [config] valid-metrics:
[2023-07-22 16:01:50] [config]   - cross-entropy
[2023-07-22 16:01:50] [config]   - translation
[2023-07-22 16:01:50] [config] valid-mini-batch: 32
[2023-07-22 16:01:50] [config] valid-reset-stalled: false
[2023-07-22 16:01:50] [config] valid-script-args:
[2023-07-22 16:01:50] [config]   []
[2023-07-22 16:01:50] [config] valid-script-path: ""
[2023-07-22 16:01:50] [config] valid-sets:
[2023-07-22 16:01:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 16:01:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 16:01:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 16:01:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:01:50] [config] vocabs:
[2023-07-22 16:01:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 16:01:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 16:01:50] [config] word-penalty: 0
[2023-07-22 16:01:50] [config] word-scores: false
[2023-07-22 16:01:50] [config] workspace: 5500
[2023-07-22 16:01:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:01:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:01:50] [training] Using single-device training
[2023-07-22 16:01:50] Synced seed 1234
[2023-07-22 16:01:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 16:01:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 16:01:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 16:01:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 16:01:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 16:01:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:01:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 16:01:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 16:01:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 16:01:52] [comm] Using global sharding
[2023-07-22 16:01:52] [comm] NCCLCommunicators constructed successfully
[2023-07-22 16:01:52] [training] Using 1 GPUs
[2023-07-22 16:01:52] [logits] Applying loss function for 1 factor(s)
[2023-07-22 16:01:52] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:01:52] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 16:01:52] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:28:35] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 16:28:35] [valid] No post-processing script given for validating translator
[2023-07-22 16:28:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:28:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 16:28:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 16:28:35] [comm] Using global sharding
[2023-07-22 16:28:35] [comm] NCCLCommunicators constructed successfully
[2023-07-22 16:28:35] [training] Using 1 GPUs
[2023-07-22 16:28:35] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 16:28:38] Allocating memory for general optimizer shards
[2023-07-22 16:28:38] [memory] Reserving 322 MB, device gpu0
[2023-07-22 16:28:38] Loading Adam parameters
[2023-07-22 16:28:38] [memory] Reserving 322 MB, device gpu0
[2023-07-22 16:28:38] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:28:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 16:28:39] [data] Restoring the corpus state to epoch 181, batch 7874
[2023-07-22 16:28:39] [data] Shuffling data
[2023-07-22 16:28:39] [data] Done reading 20,192 sentences
[2023-07-22 16:28:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:28:39] Training started
[2023-07-22 16:28:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 16:28:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:28:44] Parameter type float16, optimization type float32, casting types true
[2023-07-22 16:33:00] Seen 20,192 samples
[2023-07-22 16:33:00] Starting data epoch 182 in logical epoch 182
[2023-07-22 16:33:00] [data] Shuffling data
[2023-07-22 16:33:00] [data] Done reading 20,192 sentences
[2023-07-22 16:33:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:37:05] Seen 20,192 samples
[2023-07-22 16:37:05] Starting data epoch 183 in logical epoch 183
[2023-07-22 16:37:05] [data] Shuffling data
[2023-07-22 16:37:05] [data] Done reading 20,192 sentences
[2023-07-22 16:37:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:40:53] Ep. 183 : Up. 8000 : Sen. 18,282 : Cost 3.04312897 * 12,455,374 @ 6,648 after 99,470,574 : Time 737.44s : 16890.03 words/s : gNorm 2.4008
[2023-07-22 16:41:23] Seen 20,192 samples
[2023-07-22 16:41:23] Starting data epoch 184 in logical epoch 184
[2023-07-22 16:41:23] [data] Shuffling data
[2023-07-22 16:41:23] [data] Done reading 20,192 sentences
[2023-07-22 16:41:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:45:46] Seen 20,192 samples
[2023-07-22 16:45:46] Starting data epoch 185 in logical epoch 185
[2023-07-22 16:45:46] [data] Shuffling data
[2023-07-22 16:45:46] [data] Done reading 20,192 sentences
[2023-07-22 16:45:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:50:07] Seen 20,192 samples
[2023-07-22 16:50:07] Starting data epoch 186 in logical epoch 186
[2023-07-22 16:50:07] [data] Shuffling data
[2023-07-22 16:50:07] [data] Done reading 20,192 sentences
[2023-07-22 16:50:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:54:12] Seen 20,192 samples
[2023-07-22 16:54:12] Starting data epoch 187 in logical epoch 187
[2023-07-22 16:54:12] [data] Shuffling data
[2023-07-22 16:54:12] [data] Done reading 20,192 sentences
[2023-07-22 16:54:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:58:35] Seen 20,192 samples
[2023-07-22 16:58:35] Starting data epoch 188 in logical epoch 188
[2023-07-22 16:58:35] [data] Shuffling data
[2023-07-22 16:58:35] [data] Done reading 20,192 sentences
[2023-07-22 16:58:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:03:07] Seen 20,192 samples
[2023-07-22 17:03:07] Starting data epoch 189 in logical epoch 189
[2023-07-22 17:03:07] [data] Shuffling data
[2023-07-22 17:03:08] [data] Done reading 20,192 sentences
[2023-07-22 17:03:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:07:27] Seen 20,192 samples
[2023-07-22 17:07:27] Starting data epoch 190 in logical epoch 190
[2023-07-22 17:07:27] [data] Shuffling data
[2023-07-22 17:07:27] [data] Done reading 20,192 sentences
[2023-07-22 17:07:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:11:54] Seen 20,192 samples
[2023-07-22 17:11:54] Starting data epoch 191 in logical epoch 191
[2023-07-22 17:11:54] Training finished
[2023-07-22 17:12:05] [valid] Ep. 191 : Up. 8312 : cross-entropy : 140.906 : stalled 8 times (last best: 131.199)
[2023-07-22 17:14:47] [valid] Ep. 191 : Up. 8312 : translation : 0 : new best
[2023-07-22 17:14:47] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 17:14:49] Saving Adam parameters
[2023-07-22 17:14:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 17:14:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 17:14:57] [marian] Running on node22.datos.cluster.uy as process 21098 with command line:
[2023-07-22 17:14:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-22 17:14:57] [config] after: 0e
[2023-07-22 17:14:57] [config] after-batches: 0
[2023-07-22 17:14:57] [config] after-epochs: 200
[2023-07-22 17:14:57] [config] all-caps-every: 0
[2023-07-22 17:14:57] [config] allow-unk: false
[2023-07-22 17:14:57] [config] authors: false
[2023-07-22 17:14:57] [config] beam-size: 12
[2023-07-22 17:14:57] [config] bert-class-symbol: "[CLS]"
[2023-07-22 17:14:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 17:14:57] [config] bert-masking-fraction: 0.15
[2023-07-22 17:14:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 17:14:57] [config] bert-train-type-embeddings: true
[2023-07-22 17:14:57] [config] bert-type-vocab-size: 2
[2023-07-22 17:14:57] [config] build-info: ""
[2023-07-22 17:14:57] [config] check-gradient-nan: false
[2023-07-22 17:14:57] [config] check-nan: false
[2023-07-22 17:14:57] [config] cite: false
[2023-07-22 17:14:57] [config] clip-norm: 1
[2023-07-22 17:14:57] [config] cost-scaling:
[2023-07-22 17:14:57] [config]   - 256.f
[2023-07-22 17:14:57] [config]   - 1000
[2023-07-22 17:14:57] [config]   - 2.f
[2023-07-22 17:14:57] [config]   - 256.f
[2023-07-22 17:14:57] [config] cost-type: ce-sum
[2023-07-22 17:14:57] [config] cpu-threads: 0
[2023-07-22 17:14:57] [config] data-threads: 8
[2023-07-22 17:14:57] [config] data-weighting: ""
[2023-07-22 17:14:57] [config] data-weighting-type: sentence
[2023-07-22 17:14:57] [config] dec-cell: gru
[2023-07-22 17:14:57] [config] dec-cell-base-depth: 2
[2023-07-22 17:14:57] [config] dec-cell-high-depth: 1
[2023-07-22 17:14:57] [config] dec-depth: 1
[2023-07-22 17:14:57] [config] devices:
[2023-07-22 17:14:57] [config]   - 0
[2023-07-22 17:14:57] [config] dim-emb: 512
[2023-07-22 17:14:57] [config] dim-rnn: 1024
[2023-07-22 17:14:57] [config] dim-vocabs:
[2023-07-22 17:14:57] [config]   - 16384
[2023-07-22 17:14:57] [config]   - 16384
[2023-07-22 17:14:57] [config] disp-first: 0
[2023-07-22 17:14:57] [config] disp-freq: 1000u
[2023-07-22 17:14:57] [config] disp-label-counts: true
[2023-07-22 17:14:57] [config] dropout-rnn: 0
[2023-07-22 17:14:57] [config] dropout-src: 0
[2023-07-22 17:14:57] [config] dropout-trg: 0
[2023-07-22 17:14:57] [config] dump-config: ""
[2023-07-22 17:14:57] [config] dynamic-gradient-scaling:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] early-stopping: 200
[2023-07-22 17:14:57] [config] early-stopping-on: first
[2023-07-22 17:14:57] [config] embedding-fix-src: false
[2023-07-22 17:14:57] [config] embedding-fix-trg: false
[2023-07-22 17:14:57] [config] embedding-normalization: false
[2023-07-22 17:14:57] [config] embedding-vectors:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] enc-cell: gru
[2023-07-22 17:14:57] [config] enc-cell-depth: 1
[2023-07-22 17:14:57] [config] enc-depth: 1
[2023-07-22 17:14:57] [config] enc-type: bidirectional
[2023-07-22 17:14:57] [config] english-title-case-every: 0
[2023-07-22 17:14:57] [config] exponential-smoothing: 0
[2023-07-22 17:14:57] [config] factor-weight: 1
[2023-07-22 17:14:57] [config] factors-combine: sum
[2023-07-22 17:14:57] [config] factors-dim-emb: 0
[2023-07-22 17:14:57] [config] gradient-checkpointing: false
[2023-07-22 17:14:57] [config] gradient-norm-average-window: 100
[2023-07-22 17:14:57] [config] guided-alignment: none
[2023-07-22 17:14:57] [config] guided-alignment-cost: mse
[2023-07-22 17:14:57] [config] guided-alignment-weight: 0.1
[2023-07-22 17:14:57] [config] ignore-model-config: false
[2023-07-22 17:14:57] [config] input-types:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] interpolate-env-vars: false
[2023-07-22 17:14:57] [config] keep-best: false
[2023-07-22 17:14:57] [config] label-smoothing: 0
[2023-07-22 17:14:57] [config] layer-normalization: false
[2023-07-22 17:14:57] [config] learn-rate: 0.0001
[2023-07-22 17:14:57] [config] lemma-dependency: ""
[2023-07-22 17:14:57] [config] lemma-dim-emb: 0
[2023-07-22 17:14:57] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 17:14:57] [config] log-level: info
[2023-07-22 17:14:57] [config] log-time-zone: ""
[2023-07-22 17:14:57] [config] logical-epoch:
[2023-07-22 17:14:57] [config]   - 1e
[2023-07-22 17:14:57] [config]   - 0
[2023-07-22 17:14:57] [config] lr-decay: 0
[2023-07-22 17:14:57] [config] lr-decay-freq: 50000
[2023-07-22 17:14:57] [config] lr-decay-inv-sqrt:
[2023-07-22 17:14:57] [config]   - 0
[2023-07-22 17:14:57] [config] lr-decay-repeat-warmup: false
[2023-07-22 17:14:57] [config] lr-decay-reset-optimizer: false
[2023-07-22 17:14:57] [config] lr-decay-start:
[2023-07-22 17:14:57] [config]   - 10
[2023-07-22 17:14:57] [config]   - 1
[2023-07-22 17:14:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 17:14:57] [config] lr-report: false
[2023-07-22 17:14:57] [config] lr-warmup: 0
[2023-07-22 17:14:57] [config] lr-warmup-at-reload: false
[2023-07-22 17:14:57] [config] lr-warmup-cycle: false
[2023-07-22 17:14:57] [config] lr-warmup-start-rate: 0
[2023-07-22 17:14:57] [config] max-length: 150
[2023-07-22 17:14:57] [config] max-length-crop: true
[2023-07-22 17:14:57] [config] max-length-factor: 3
[2023-07-22 17:14:57] [config] maxi-batch: 100
[2023-07-22 17:14:57] [config] maxi-batch-sort: trg
[2023-07-22 17:14:57] [config] mini-batch: 64
[2023-07-22 17:14:57] [config] mini-batch-fit: true
[2023-07-22 17:14:57] [config] mini-batch-fit-step: 10
[2023-07-22 17:14:57] [config] mini-batch-round-up: true
[2023-07-22 17:14:57] [config] mini-batch-track-lr: false
[2023-07-22 17:14:57] [config] mini-batch-warmup: 0
[2023-07-22 17:14:57] [config] mini-batch-words: 0
[2023-07-22 17:14:57] [config] mini-batch-words-ref: 0
[2023-07-22 17:14:57] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 17:14:57] [config] multi-loss-type: sum
[2023-07-22 17:14:57] [config] n-best: false
[2023-07-22 17:14:57] [config] no-nccl: false
[2023-07-22 17:14:57] [config] no-reload: false
[2023-07-22 17:14:57] [config] no-restore-corpus: false
[2023-07-22 17:14:57] [config] normalize: 0
[2023-07-22 17:14:57] [config] normalize-gradient: false
[2023-07-22 17:14:57] [config] num-devices: 0
[2023-07-22 17:14:57] [config] optimizer: adam
[2023-07-22 17:14:57] [config] optimizer-delay: 1
[2023-07-22 17:14:57] [config] optimizer-params:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] output-omit-bias: false
[2023-07-22 17:14:57] [config] overwrite: true
[2023-07-22 17:14:57] [config] precision:
[2023-07-22 17:14:57] [config]   - float16
[2023-07-22 17:14:57] [config]   - float32
[2023-07-22 17:14:57] [config] pretrained-model: ""
[2023-07-22 17:14:57] [config] quantize-biases: false
[2023-07-22 17:14:57] [config] quantize-bits: 0
[2023-07-22 17:14:57] [config] quantize-log-based: false
[2023-07-22 17:14:57] [config] quantize-optimization-steps: 0
[2023-07-22 17:14:57] [config] quiet: false
[2023-07-22 17:14:57] [config] quiet-translation: true
[2023-07-22 17:14:57] [config] relative-paths: false
[2023-07-22 17:14:57] [config] right-left: false
[2023-07-22 17:14:57] [config] save-freq: 10000u
[2023-07-22 17:14:57] [config] seed: 1234
[2023-07-22 17:14:57] [config] sentencepiece-alphas:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] sentencepiece-max-lines: 2000000
[2023-07-22 17:14:57] [config] sentencepiece-options: ""
[2023-07-22 17:14:57] [config] sharding: global
[2023-07-22 17:14:57] [config] shuffle: data
[2023-07-22 17:14:57] [config] shuffle-in-ram: false
[2023-07-22 17:14:57] [config] sigterm: save-and-exit
[2023-07-22 17:14:57] [config] skip: false
[2023-07-22 17:14:57] [config] sqlite: ""
[2023-07-22 17:14:57] [config] sqlite-drop: false
[2023-07-22 17:14:57] [config] sync-freq: 200u
[2023-07-22 17:14:57] [config] sync-sgd: false
[2023-07-22 17:14:57] [config] tempdir: /tmp
[2023-07-22 17:14:57] [config] tied-embeddings: false
[2023-07-22 17:14:57] [config] tied-embeddings-all: true
[2023-07-22 17:14:57] [config] tied-embeddings-src: false
[2023-07-22 17:14:57] [config] train-embedder-rank:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] train-sets:
[2023-07-22 17:14:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 17:14:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 17:14:57] [config] transformer-aan-activation: swish
[2023-07-22 17:14:57] [config] transformer-aan-depth: 2
[2023-07-22 17:14:57] [config] transformer-aan-nogate: false
[2023-07-22 17:14:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 17:14:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 17:14:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 17:14:57] [config] transformer-depth-scaling: false
[2023-07-22 17:14:57] [config] transformer-dim-aan: 2048
[2023-07-22 17:14:57] [config] transformer-dim-ffn: 2048
[2023-07-22 17:14:57] [config] transformer-dropout: 0
[2023-07-22 17:14:57] [config] transformer-dropout-attention: 0
[2023-07-22 17:14:57] [config] transformer-dropout-ffn: 0
[2023-07-22 17:14:57] [config] transformer-ffn-activation: swish
[2023-07-22 17:14:57] [config] transformer-ffn-depth: 2
[2023-07-22 17:14:57] [config] transformer-guided-alignment-layer: last
[2023-07-22 17:14:57] [config] transformer-heads: 8
[2023-07-22 17:14:57] [config] transformer-no-projection: false
[2023-07-22 17:14:57] [config] transformer-pool: false
[2023-07-22 17:14:57] [config] transformer-postprocess: dan
[2023-07-22 17:14:57] [config] transformer-postprocess-emb: d
[2023-07-22 17:14:57] [config] transformer-postprocess-top: ""
[2023-07-22 17:14:57] [config] transformer-preprocess: ""
[2023-07-22 17:14:57] [config] transformer-tied-layers:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] transformer-train-position-embeddings: false
[2023-07-22 17:14:57] [config] tsv: false
[2023-07-22 17:14:57] [config] tsv-fields: 0
[2023-07-22 17:14:57] [config] type: amun
[2023-07-22 17:14:57] [config] ulr: false
[2023-07-22 17:14:57] [config] ulr-dim-emb: 0
[2023-07-22 17:14:57] [config] ulr-dropout: 0
[2023-07-22 17:14:57] [config] ulr-keys-vectors: ""
[2023-07-22 17:14:57] [config] ulr-query-vectors: ""
[2023-07-22 17:14:57] [config] ulr-softmax-temperature: 1
[2023-07-22 17:14:57] [config] ulr-trainable-transformation: false
[2023-07-22 17:14:57] [config] unlikelihood-loss: false
[2023-07-22 17:14:57] [config] valid-freq: 50000000
[2023-07-22 17:14:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 17:14:57] [config] valid-max-length: 1000
[2023-07-22 17:14:57] [config] valid-metrics:
[2023-07-22 17:14:57] [config]   - cross-entropy
[2023-07-22 17:14:57] [config]   - translation
[2023-07-22 17:14:57] [config] valid-mini-batch: 32
[2023-07-22 17:14:57] [config] valid-reset-stalled: false
[2023-07-22 17:14:57] [config] valid-script-args:
[2023-07-22 17:14:57] [config]   []
[2023-07-22 17:14:57] [config] valid-script-path: ""
[2023-07-22 17:14:57] [config] valid-sets:
[2023-07-22 17:14:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 17:14:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 17:14:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 17:14:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 17:14:57] [config] vocabs:
[2023-07-22 17:14:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 17:14:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 17:14:57] [config] word-penalty: 0
[2023-07-22 17:14:57] [config] word-scores: false
[2023-07-22 17:14:57] [config] workspace: 5500
[2023-07-22 17:14:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 17:14:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 17:14:57] [training] Using single-device training
[2023-07-22 17:14:57] Synced seed 1234
[2023-07-22 17:14:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 17:14:57] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 17:14:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 17:14:57] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 17:14:57] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 17:14:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 17:14:57] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 17:14:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 17:14:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 17:14:59] [comm] Using global sharding
[2023-07-22 17:14:59] [comm] NCCLCommunicators constructed successfully
[2023-07-22 17:14:59] [training] Using 1 GPUs
[2023-07-22 17:14:59] [logits] Applying loss function for 1 factor(s)
[2023-07-22 17:14:59] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:14:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 17:14:59] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:42:09] [batching] Done. Typical MB size is 35,978 target words
[2023-07-22 17:42:09] [valid] No post-processing script given for validating translator
[2023-07-22 17:42:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 17:42:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 17:42:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 17:42:09] [comm] Using global sharding
[2023-07-22 17:42:09] [comm] NCCLCommunicators constructed successfully
[2023-07-22 17:42:09] [training] Using 1 GPUs
[2023-07-22 17:42:09] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 17:42:18] Allocating memory for general optimizer shards
[2023-07-22 17:42:18] [memory] Reserving 322 MB, device gpu0
[2023-07-22 17:42:18] Loading Adam parameters
[2023-07-22 17:42:18] [memory] Reserving 322 MB, device gpu0
[2023-07-22 17:42:18] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:42:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 17:42:19] [data] Restoring the corpus state to epoch 191, batch 8312
[2023-07-22 17:42:19] [data] Shuffling data
[2023-07-22 17:42:19] [data] Done reading 20,192 sentences
[2023-07-22 17:42:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:42:19] Training started
[2023-07-22 17:42:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 17:42:19] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:42:22] Parameter type float16, optimization type float32, casting types true
[2023-07-22 17:46:28] Seen 20,192 samples
[2023-07-22 17:46:28] Starting data epoch 192 in logical epoch 192
[2023-07-22 17:46:28] [data] Shuffling data
[2023-07-22 17:46:28] [data] Done reading 20,192 sentences
[2023-07-22 17:46:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:50:33] Seen 20,192 samples
[2023-07-22 17:50:33] Starting data epoch 193 in logical epoch 193
[2023-07-22 17:50:33] [data] Shuffling data
[2023-07-22 17:50:33] [data] Done reading 20,192 sentences
[2023-07-22 17:50:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:54:40] Seen 20,192 samples
[2023-07-22 17:54:40] Starting data epoch 194 in logical epoch 194
[2023-07-22 17:54:40] [data] Shuffling data
[2023-07-22 17:54:40] [data] Done reading 20,192 sentences
[2023-07-22 17:54:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:58:50] Seen 20,192 samples
[2023-07-22 17:58:50] Starting data epoch 195 in logical epoch 195
[2023-07-22 17:58:50] [data] Shuffling data
[2023-07-22 17:58:50] [data] Done reading 20,192 sentences
[2023-07-22 17:58:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:03:03] Seen 20,192 samples
[2023-07-22 18:03:03] Starting data epoch 196 in logical epoch 196
[2023-07-22 18:03:03] [data] Shuffling data
[2023-07-22 18:03:03] [data] Done reading 20,192 sentences
[2023-07-22 18:03:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:07:32] Seen 20,192 samples
[2023-07-22 18:07:32] Starting data epoch 197 in logical epoch 197
[2023-07-22 18:07:32] [data] Shuffling data
[2023-07-22 18:07:32] [data] Done reading 20,192 sentences
[2023-07-22 18:07:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:11:51] Seen 20,192 samples
[2023-07-22 18:11:51] Starting data epoch 198 in logical epoch 198
[2023-07-22 18:11:51] [data] Shuffling data
[2023-07-22 18:11:51] [data] Done reading 20,192 sentences
[2023-07-22 18:11:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:16:04] Seen 20,192 samples
[2023-07-22 18:16:04] Starting data epoch 199 in logical epoch 199
[2023-07-22 18:16:04] [data] Shuffling data
[2023-07-22 18:16:04] [data] Done reading 20,192 sentences
[2023-07-22 18:16:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:20:36] Seen 20,192 samples
[2023-07-22 18:20:36] Starting data epoch 200 in logical epoch 200
[2023-07-22 18:20:36] [data] Shuffling data
[2023-07-22 18:20:36] [data] Done reading 20,192 sentences
[2023-07-22 18:20:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:24:55] Seen 20,192 samples
[2023-07-22 18:24:55] Starting data epoch 201 in logical epoch 201
[2023-07-22 18:24:55] Training finished
[2023-07-22 18:25:08] [valid] Ep. 201 : Up. 8752 : cross-entropy : 143.031 : stalled 9 times (last best: 131.199)
[2023-07-22 18:27:35] [valid] Ep. 201 : Up. 8752 : translation : 0 : new best
[2023-07-22 18:27:35] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz
[2023-07-22 18:27:37] Saving Adam parameters
[2023-07-22 18:27:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_150.npz.optimizer.npz
[2023-07-22 18:27:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 18:27:45] [marian] Running on node22.datos.cluster.uy as process 26137 with command line:
[2023-07-22 18:27:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-22 18:27:45] [config] after: 0e
[2023-07-22 18:27:45] [config] after-batches: 0
[2023-07-22 18:27:45] [config] after-epochs: 10
[2023-07-22 18:27:45] [config] all-caps-every: 0
[2023-07-22 18:27:45] [config] allow-unk: false
[2023-07-22 18:27:45] [config] authors: false
[2023-07-22 18:27:45] [config] beam-size: 12
[2023-07-22 18:27:45] [config] bert-class-symbol: "[CLS]"
[2023-07-22 18:27:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 18:27:45] [config] bert-masking-fraction: 0.15
[2023-07-22 18:27:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 18:27:45] [config] bert-train-type-embeddings: true
[2023-07-22 18:27:45] [config] bert-type-vocab-size: 2
[2023-07-22 18:27:45] [config] build-info: ""
[2023-07-22 18:27:45] [config] check-gradient-nan: false
[2023-07-22 18:27:45] [config] check-nan: false
[2023-07-22 18:27:45] [config] cite: false
[2023-07-22 18:27:45] [config] clip-norm: 1
[2023-07-22 18:27:45] [config] cost-scaling:
[2023-07-22 18:27:45] [config]   - 256.f
[2023-07-22 18:27:45] [config]   - 1000
[2023-07-22 18:27:45] [config]   - 2.f
[2023-07-22 18:27:45] [config]   - 256.f
[2023-07-22 18:27:45] [config] cost-type: ce-sum
[2023-07-22 18:27:45] [config] cpu-threads: 0
[2023-07-22 18:27:45] [config] data-threads: 8
[2023-07-22 18:27:45] [config] data-weighting: ""
[2023-07-22 18:27:45] [config] data-weighting-type: sentence
[2023-07-22 18:27:45] [config] dec-cell: gru
[2023-07-22 18:27:45] [config] dec-cell-base-depth: 2
[2023-07-22 18:27:45] [config] dec-cell-high-depth: 1
[2023-07-22 18:27:45] [config] dec-depth: 1
[2023-07-22 18:27:45] [config] devices:
[2023-07-22 18:27:45] [config]   - 0
[2023-07-22 18:27:45] [config] dim-emb: 512
[2023-07-22 18:27:45] [config] dim-rnn: 1024
[2023-07-22 18:27:45] [config] dim-vocabs:
[2023-07-22 18:27:45] [config]   - 16384
[2023-07-22 18:27:45] [config]   - 16384
[2023-07-22 18:27:45] [config] disp-first: 0
[2023-07-22 18:27:45] [config] disp-freq: 1000u
[2023-07-22 18:27:45] [config] disp-label-counts: true
[2023-07-22 18:27:45] [config] dropout-rnn: 0
[2023-07-22 18:27:45] [config] dropout-src: 0
[2023-07-22 18:27:45] [config] dropout-trg: 0
[2023-07-22 18:27:45] [config] dump-config: ""
[2023-07-22 18:27:45] [config] dynamic-gradient-scaling:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] early-stopping: 200
[2023-07-22 18:27:45] [config] early-stopping-on: first
[2023-07-22 18:27:45] [config] embedding-fix-src: false
[2023-07-22 18:27:45] [config] embedding-fix-trg: false
[2023-07-22 18:27:45] [config] embedding-normalization: false
[2023-07-22 18:27:45] [config] embedding-vectors:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] enc-cell: gru
[2023-07-22 18:27:45] [config] enc-cell-depth: 1
[2023-07-22 18:27:45] [config] enc-depth: 1
[2023-07-22 18:27:45] [config] enc-type: bidirectional
[2023-07-22 18:27:45] [config] english-title-case-every: 0
[2023-07-22 18:27:45] [config] exponential-smoothing: 0
[2023-07-22 18:27:45] [config] factor-weight: 1
[2023-07-22 18:27:45] [config] factors-combine: sum
[2023-07-22 18:27:45] [config] factors-dim-emb: 0
[2023-07-22 18:27:45] [config] gradient-checkpointing: false
[2023-07-22 18:27:45] [config] gradient-norm-average-window: 100
[2023-07-22 18:27:45] [config] guided-alignment: none
[2023-07-22 18:27:45] [config] guided-alignment-cost: mse
[2023-07-22 18:27:45] [config] guided-alignment-weight: 0.1
[2023-07-22 18:27:45] [config] ignore-model-config: false
[2023-07-22 18:27:45] [config] input-types:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] interpolate-env-vars: false
[2023-07-22 18:27:45] [config] keep-best: false
[2023-07-22 18:27:45] [config] label-smoothing: 0
[2023-07-22 18:27:45] [config] layer-normalization: false
[2023-07-22 18:27:45] [config] learn-rate: 0.0001
[2023-07-22 18:27:45] [config] lemma-dependency: ""
[2023-07-22 18:27:45] [config] lemma-dim-emb: 0
[2023-07-22 18:27:45] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 18:27:45] [config] log-level: info
[2023-07-22 18:27:45] [config] log-time-zone: ""
[2023-07-22 18:27:45] [config] logical-epoch:
[2023-07-22 18:27:45] [config]   - 1e
[2023-07-22 18:27:45] [config]   - 0
[2023-07-22 18:27:45] [config] lr-decay: 0
[2023-07-22 18:27:45] [config] lr-decay-freq: 50000
[2023-07-22 18:27:45] [config] lr-decay-inv-sqrt:
[2023-07-22 18:27:45] [config]   - 0
[2023-07-22 18:27:45] [config] lr-decay-repeat-warmup: false
[2023-07-22 18:27:45] [config] lr-decay-reset-optimizer: false
[2023-07-22 18:27:45] [config] lr-decay-start:
[2023-07-22 18:27:45] [config]   - 10
[2023-07-22 18:27:45] [config]   - 1
[2023-07-22 18:27:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 18:27:45] [config] lr-report: false
[2023-07-22 18:27:45] [config] lr-warmup: 0
[2023-07-22 18:27:45] [config] lr-warmup-at-reload: false
[2023-07-22 18:27:45] [config] lr-warmup-cycle: false
[2023-07-22 18:27:45] [config] lr-warmup-start-rate: 0
[2023-07-22 18:27:45] [config] max-length: 200
[2023-07-22 18:27:45] [config] max-length-crop: true
[2023-07-22 18:27:45] [config] max-length-factor: 3
[2023-07-22 18:27:45] [config] maxi-batch: 100
[2023-07-22 18:27:45] [config] maxi-batch-sort: trg
[2023-07-22 18:27:45] [config] mini-batch: 64
[2023-07-22 18:27:45] [config] mini-batch-fit: true
[2023-07-22 18:27:45] [config] mini-batch-fit-step: 10
[2023-07-22 18:27:45] [config] mini-batch-round-up: true
[2023-07-22 18:27:45] [config] mini-batch-track-lr: false
[2023-07-22 18:27:45] [config] mini-batch-warmup: 0
[2023-07-22 18:27:45] [config] mini-batch-words: 0
[2023-07-22 18:27:45] [config] mini-batch-words-ref: 0
[2023-07-22 18:27:45] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 18:27:45] [config] multi-loss-type: sum
[2023-07-22 18:27:45] [config] n-best: false
[2023-07-22 18:27:45] [config] no-nccl: false
[2023-07-22 18:27:45] [config] no-reload: false
[2023-07-22 18:27:45] [config] no-restore-corpus: false
[2023-07-22 18:27:45] [config] normalize: 0
[2023-07-22 18:27:45] [config] normalize-gradient: false
[2023-07-22 18:27:45] [config] num-devices: 0
[2023-07-22 18:27:45] [config] optimizer: adam
[2023-07-22 18:27:45] [config] optimizer-delay: 1
[2023-07-22 18:27:45] [config] optimizer-params:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] output-omit-bias: false
[2023-07-22 18:27:45] [config] overwrite: true
[2023-07-22 18:27:45] [config] precision:
[2023-07-22 18:27:45] [config]   - float16
[2023-07-22 18:27:45] [config]   - float32
[2023-07-22 18:27:45] [config] pretrained-model: ""
[2023-07-22 18:27:45] [config] quantize-biases: false
[2023-07-22 18:27:45] [config] quantize-bits: 0
[2023-07-22 18:27:45] [config] quantize-log-based: false
[2023-07-22 18:27:45] [config] quantize-optimization-steps: 0
[2023-07-22 18:27:45] [config] quiet: false
[2023-07-22 18:27:45] [config] quiet-translation: true
[2023-07-22 18:27:45] [config] relative-paths: false
[2023-07-22 18:27:45] [config] right-left: false
[2023-07-22 18:27:45] [config] save-freq: 10000u
[2023-07-22 18:27:45] [config] seed: 1234
[2023-07-22 18:27:45] [config] sentencepiece-alphas:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] sentencepiece-max-lines: 2000000
[2023-07-22 18:27:45] [config] sentencepiece-options: ""
[2023-07-22 18:27:45] [config] sharding: global
[2023-07-22 18:27:45] [config] shuffle: data
[2023-07-22 18:27:45] [config] shuffle-in-ram: false
[2023-07-22 18:27:45] [config] sigterm: save-and-exit
[2023-07-22 18:27:45] [config] skip: false
[2023-07-22 18:27:45] [config] sqlite: ""
[2023-07-22 18:27:45] [config] sqlite-drop: false
[2023-07-22 18:27:45] [config] sync-freq: 200u
[2023-07-22 18:27:45] [config] sync-sgd: false
[2023-07-22 18:27:45] [config] tempdir: /tmp
[2023-07-22 18:27:45] [config] tied-embeddings: false
[2023-07-22 18:27:45] [config] tied-embeddings-all: true
[2023-07-22 18:27:45] [config] tied-embeddings-src: false
[2023-07-22 18:27:45] [config] train-embedder-rank:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] train-sets:
[2023-07-22 18:27:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 18:27:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 18:27:45] [config] transformer-aan-activation: swish
[2023-07-22 18:27:45] [config] transformer-aan-depth: 2
[2023-07-22 18:27:45] [config] transformer-aan-nogate: false
[2023-07-22 18:27:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 18:27:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 18:27:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 18:27:45] [config] transformer-depth-scaling: false
[2023-07-22 18:27:45] [config] transformer-dim-aan: 2048
[2023-07-22 18:27:45] [config] transformer-dim-ffn: 2048
[2023-07-22 18:27:45] [config] transformer-dropout: 0
[2023-07-22 18:27:45] [config] transformer-dropout-attention: 0
[2023-07-22 18:27:45] [config] transformer-dropout-ffn: 0
[2023-07-22 18:27:45] [config] transformer-ffn-activation: swish
[2023-07-22 18:27:45] [config] transformer-ffn-depth: 2
[2023-07-22 18:27:45] [config] transformer-guided-alignment-layer: last
[2023-07-22 18:27:45] [config] transformer-heads: 8
[2023-07-22 18:27:45] [config] transformer-no-projection: false
[2023-07-22 18:27:45] [config] transformer-pool: false
[2023-07-22 18:27:45] [config] transformer-postprocess: dan
[2023-07-22 18:27:45] [config] transformer-postprocess-emb: d
[2023-07-22 18:27:45] [config] transformer-postprocess-top: ""
[2023-07-22 18:27:45] [config] transformer-preprocess: ""
[2023-07-22 18:27:45] [config] transformer-tied-layers:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] transformer-train-position-embeddings: false
[2023-07-22 18:27:45] [config] tsv: false
[2023-07-22 18:27:45] [config] tsv-fields: 0
[2023-07-22 18:27:45] [config] type: amun
[2023-07-22 18:27:45] [config] ulr: false
[2023-07-22 18:27:45] [config] ulr-dim-emb: 0
[2023-07-22 18:27:45] [config] ulr-dropout: 0
[2023-07-22 18:27:45] [config] ulr-keys-vectors: ""
[2023-07-22 18:27:45] [config] ulr-query-vectors: ""
[2023-07-22 18:27:45] [config] ulr-softmax-temperature: 1
[2023-07-22 18:27:45] [config] ulr-trainable-transformation: false
[2023-07-22 18:27:45] [config] unlikelihood-loss: false
[2023-07-22 18:27:45] [config] valid-freq: 50000000
[2023-07-22 18:27:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 18:27:45] [config] valid-max-length: 1000
[2023-07-22 18:27:45] [config] valid-metrics:
[2023-07-22 18:27:45] [config]   - cross-entropy
[2023-07-22 18:27:45] [config]   - translation
[2023-07-22 18:27:45] [config] valid-mini-batch: 32
[2023-07-22 18:27:45] [config] valid-reset-stalled: false
[2023-07-22 18:27:45] [config] valid-script-args:
[2023-07-22 18:27:45] [config]   []
[2023-07-22 18:27:45] [config] valid-script-path: ""
[2023-07-22 18:27:45] [config] valid-sets:
[2023-07-22 18:27:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 18:27:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 18:27:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 18:27:45] [config] vocabs:
[2023-07-22 18:27:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 18:27:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 18:27:45] [config] word-penalty: 0
[2023-07-22 18:27:45] [config] word-scores: false
[2023-07-22 18:27:45] [config] workspace: 5500
[2023-07-22 18:27:45] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 18:27:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 18:27:45] [training] Using single-device training
[2023-07-22 18:27:45] Synced seed 1234
[2023-07-22 18:27:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 18:27:45] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 18:27:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 18:27:45] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 18:27:45] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 18:27:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 18:27:45] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 18:27:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 18:27:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 18:27:47] [comm] Using global sharding
[2023-07-22 18:27:47] [comm] NCCLCommunicators constructed successfully
[2023-07-22 18:27:47] [training] Using 1 GPUs
[2023-07-22 18:27:47] [logits] Applying loss function for 1 factor(s)
[2023-07-22 18:27:47] [memory] Reserving 80 MB, device gpu0
[2023-07-22 18:27:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 18:27:47] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:04:55] [batching] Done. Typical MB size is 35,936 target words
[2023-07-22 19:04:55] [valid] No post-processing script given for validating translator
[2023-07-22 19:04:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 19:04:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 19:04:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 19:04:55] [comm] Using global sharding
[2023-07-22 19:04:55] [comm] NCCLCommunicators constructed successfully
[2023-07-22 19:04:55] [training] Using 1 GPUs
[2023-07-22 19:04:55] Training started
[2023-07-22 19:04:55] [data] Shuffling data
[2023-07-22 19:04:55] [data] Done reading 20,192 sentences
[2023-07-22 19:04:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:04:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 19:04:56] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:04:56] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:05:00] Parameter type float16, optimization type float32, casting types true
[2023-07-22 19:05:00] Allocating memory for general optimizer shards
[2023-07-22 19:05:00] [memory] Reserving 322 MB, device gpu0
[2023-07-22 19:05:00] Allocating memory for Adam-specific shards
[2023-07-22 19:05:00] [memory] Reserving 322 MB, device gpu0
[2023-07-22 19:08:47] Seen 20,192 samples
[2023-07-22 19:08:47] Starting data epoch 2 in logical epoch 2
[2023-07-22 19:08:47] [data] Shuffling data
[2023-07-22 19:08:47] [data] Done reading 20,192 sentences
[2023-07-22 19:08:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:13:24] Seen 20,192 samples
[2023-07-22 19:13:24] Starting data epoch 3 in logical epoch 3
[2023-07-22 19:13:24] [data] Shuffling data
[2023-07-22 19:13:24] [data] Done reading 20,192 sentences
[2023-07-22 19:13:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:17:57] Seen 20,192 samples
[2023-07-22 19:17:57] Starting data epoch 4 in logical epoch 4
[2023-07-22 19:17:57] [data] Shuffling data
[2023-07-22 19:17:57] [data] Done reading 20,192 sentences
[2023-07-22 19:17:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:22:40] Seen 20,192 samples
[2023-07-22 19:22:40] Starting data epoch 5 in logical epoch 5
[2023-07-22 19:22:40] [data] Shuffling data
[2023-07-22 19:22:40] [data] Done reading 20,192 sentences
[2023-07-22 19:22:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:27:30] Seen 20,192 samples
[2023-07-22 19:27:30] Starting data epoch 6 in logical epoch 6
[2023-07-22 19:27:30] [data] Shuffling data
[2023-07-22 19:27:30] [data] Done reading 20,192 sentences
[2023-07-22 19:27:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:32:13] Seen 20,192 samples
[2023-07-22 19:32:13] Starting data epoch 7 in logical epoch 7
[2023-07-22 19:32:13] [data] Shuffling data
[2023-07-22 19:32:13] [data] Done reading 20,192 sentences
[2023-07-22 19:32:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:37:09] Seen 20,192 samples
[2023-07-22 19:37:09] Starting data epoch 8 in logical epoch 8
[2023-07-22 19:37:09] [data] Shuffling data
[2023-07-22 19:37:09] [data] Done reading 20,192 sentences
[2023-07-22 19:37:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:42:01] Seen 20,192 samples
[2023-07-22 19:42:01] Starting data epoch 9 in logical epoch 9
[2023-07-22 19:42:01] [data] Shuffling data
[2023-07-22 19:42:01] [data] Done reading 20,192 sentences
[2023-07-22 19:42:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:46:33] Seen 20,192 samples
[2023-07-22 19:46:33] Starting data epoch 10 in logical epoch 10
[2023-07-22 19:46:33] [data] Shuffling data
[2023-07-22 19:46:33] [data] Done reading 20,192 sentences
[2023-07-22 19:46:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:51:14] Seen 20,192 samples
[2023-07-22 19:51:14] Starting data epoch 11 in logical epoch 11
[2023-07-22 19:51:14] Training finished
[2023-07-22 19:51:25] [valid] Ep. 11 : Up. 449 : cross-entropy : 173.309 : new best
[2023-07-22 19:52:46] [valid] Ep. 11 : Up. 449 : translation : 0 : new best
[2023-07-22 19:52:46] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 19:52:48] Saving Adam parameters
[2023-07-22 19:52:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-22 19:52:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 19:52:57] [marian] Running on node22.datos.cluster.uy as process 31294 with command line:
[2023-07-22 19:52:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-22 19:52:57] [config] after: 0e
[2023-07-22 19:52:57] [config] after-batches: 0
[2023-07-22 19:52:57] [config] after-epochs: 20
[2023-07-22 19:52:57] [config] all-caps-every: 0
[2023-07-22 19:52:57] [config] allow-unk: false
[2023-07-22 19:52:57] [config] authors: false
[2023-07-22 19:52:57] [config] beam-size: 12
[2023-07-22 19:52:57] [config] bert-class-symbol: "[CLS]"
[2023-07-22 19:52:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 19:52:57] [config] bert-masking-fraction: 0.15
[2023-07-22 19:52:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 19:52:57] [config] bert-train-type-embeddings: true
[2023-07-22 19:52:57] [config] bert-type-vocab-size: 2
[2023-07-22 19:52:57] [config] build-info: ""
[2023-07-22 19:52:57] [config] check-gradient-nan: false
[2023-07-22 19:52:57] [config] check-nan: false
[2023-07-22 19:52:57] [config] cite: false
[2023-07-22 19:52:57] [config] clip-norm: 1
[2023-07-22 19:52:57] [config] cost-scaling:
[2023-07-22 19:52:57] [config]   - 256.f
[2023-07-22 19:52:57] [config]   - 1000
[2023-07-22 19:52:57] [config]   - 2.f
[2023-07-22 19:52:57] [config]   - 256.f
[2023-07-22 19:52:57] [config] cost-type: ce-sum
[2023-07-22 19:52:57] [config] cpu-threads: 0
[2023-07-22 19:52:57] [config] data-threads: 8
[2023-07-22 19:52:57] [config] data-weighting: ""
[2023-07-22 19:52:57] [config] data-weighting-type: sentence
[2023-07-22 19:52:57] [config] dec-cell: gru
[2023-07-22 19:52:57] [config] dec-cell-base-depth: 2
[2023-07-22 19:52:57] [config] dec-cell-high-depth: 1
[2023-07-22 19:52:57] [config] dec-depth: 1
[2023-07-22 19:52:57] [config] devices:
[2023-07-22 19:52:57] [config]   - 0
[2023-07-22 19:52:57] [config] dim-emb: 512
[2023-07-22 19:52:57] [config] dim-rnn: 1024
[2023-07-22 19:52:57] [config] dim-vocabs:
[2023-07-22 19:52:57] [config]   - 16384
[2023-07-22 19:52:57] [config]   - 16384
[2023-07-22 19:52:57] [config] disp-first: 0
[2023-07-22 19:52:57] [config] disp-freq: 1000u
[2023-07-22 19:52:57] [config] disp-label-counts: true
[2023-07-22 19:52:57] [config] dropout-rnn: 0
[2023-07-22 19:52:57] [config] dropout-src: 0
[2023-07-22 19:52:57] [config] dropout-trg: 0
[2023-07-22 19:52:57] [config] dump-config: ""
[2023-07-22 19:52:57] [config] dynamic-gradient-scaling:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] early-stopping: 200
[2023-07-22 19:52:57] [config] early-stopping-on: first
[2023-07-22 19:52:57] [config] embedding-fix-src: false
[2023-07-22 19:52:57] [config] embedding-fix-trg: false
[2023-07-22 19:52:57] [config] embedding-normalization: false
[2023-07-22 19:52:57] [config] embedding-vectors:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] enc-cell: gru
[2023-07-22 19:52:57] [config] enc-cell-depth: 1
[2023-07-22 19:52:57] [config] enc-depth: 1
[2023-07-22 19:52:57] [config] enc-type: bidirectional
[2023-07-22 19:52:57] [config] english-title-case-every: 0
[2023-07-22 19:52:57] [config] exponential-smoothing: 0
[2023-07-22 19:52:57] [config] factor-weight: 1
[2023-07-22 19:52:57] [config] factors-combine: sum
[2023-07-22 19:52:57] [config] factors-dim-emb: 0
[2023-07-22 19:52:57] [config] gradient-checkpointing: false
[2023-07-22 19:52:57] [config] gradient-norm-average-window: 100
[2023-07-22 19:52:57] [config] guided-alignment: none
[2023-07-22 19:52:57] [config] guided-alignment-cost: mse
[2023-07-22 19:52:57] [config] guided-alignment-weight: 0.1
[2023-07-22 19:52:57] [config] ignore-model-config: false
[2023-07-22 19:52:57] [config] input-types:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] interpolate-env-vars: false
[2023-07-22 19:52:57] [config] keep-best: false
[2023-07-22 19:52:57] [config] label-smoothing: 0
[2023-07-22 19:52:57] [config] layer-normalization: false
[2023-07-22 19:52:57] [config] learn-rate: 0.0001
[2023-07-22 19:52:57] [config] lemma-dependency: ""
[2023-07-22 19:52:57] [config] lemma-dim-emb: 0
[2023-07-22 19:52:57] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 19:52:57] [config] log-level: info
[2023-07-22 19:52:57] [config] log-time-zone: ""
[2023-07-22 19:52:57] [config] logical-epoch:
[2023-07-22 19:52:57] [config]   - 1e
[2023-07-22 19:52:57] [config]   - 0
[2023-07-22 19:52:57] [config] lr-decay: 0
[2023-07-22 19:52:57] [config] lr-decay-freq: 50000
[2023-07-22 19:52:57] [config] lr-decay-inv-sqrt:
[2023-07-22 19:52:57] [config]   - 0
[2023-07-22 19:52:57] [config] lr-decay-repeat-warmup: false
[2023-07-22 19:52:57] [config] lr-decay-reset-optimizer: false
[2023-07-22 19:52:57] [config] lr-decay-start:
[2023-07-22 19:52:57] [config]   - 10
[2023-07-22 19:52:57] [config]   - 1
[2023-07-22 19:52:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 19:52:57] [config] lr-report: false
[2023-07-22 19:52:57] [config] lr-warmup: 0
[2023-07-22 19:52:57] [config] lr-warmup-at-reload: false
[2023-07-22 19:52:57] [config] lr-warmup-cycle: false
[2023-07-22 19:52:57] [config] lr-warmup-start-rate: 0
[2023-07-22 19:52:57] [config] max-length: 200
[2023-07-22 19:52:57] [config] max-length-crop: true
[2023-07-22 19:52:57] [config] max-length-factor: 3
[2023-07-22 19:52:57] [config] maxi-batch: 100
[2023-07-22 19:52:57] [config] maxi-batch-sort: trg
[2023-07-22 19:52:57] [config] mini-batch: 64
[2023-07-22 19:52:57] [config] mini-batch-fit: true
[2023-07-22 19:52:57] [config] mini-batch-fit-step: 10
[2023-07-22 19:52:57] [config] mini-batch-round-up: true
[2023-07-22 19:52:57] [config] mini-batch-track-lr: false
[2023-07-22 19:52:57] [config] mini-batch-warmup: 0
[2023-07-22 19:52:57] [config] mini-batch-words: 0
[2023-07-22 19:52:57] [config] mini-batch-words-ref: 0
[2023-07-22 19:52:57] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 19:52:57] [config] multi-loss-type: sum
[2023-07-22 19:52:57] [config] n-best: false
[2023-07-22 19:52:57] [config] no-nccl: false
[2023-07-22 19:52:57] [config] no-reload: false
[2023-07-22 19:52:57] [config] no-restore-corpus: false
[2023-07-22 19:52:57] [config] normalize: 0
[2023-07-22 19:52:57] [config] normalize-gradient: false
[2023-07-22 19:52:57] [config] num-devices: 0
[2023-07-22 19:52:57] [config] optimizer: adam
[2023-07-22 19:52:57] [config] optimizer-delay: 1
[2023-07-22 19:52:57] [config] optimizer-params:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] output-omit-bias: false
[2023-07-22 19:52:57] [config] overwrite: true
[2023-07-22 19:52:57] [config] precision:
[2023-07-22 19:52:57] [config]   - float16
[2023-07-22 19:52:57] [config]   - float32
[2023-07-22 19:52:57] [config] pretrained-model: ""
[2023-07-22 19:52:57] [config] quantize-biases: false
[2023-07-22 19:52:57] [config] quantize-bits: 0
[2023-07-22 19:52:57] [config] quantize-log-based: false
[2023-07-22 19:52:57] [config] quantize-optimization-steps: 0
[2023-07-22 19:52:57] [config] quiet: false
[2023-07-22 19:52:57] [config] quiet-translation: true
[2023-07-22 19:52:57] [config] relative-paths: false
[2023-07-22 19:52:57] [config] right-left: false
[2023-07-22 19:52:57] [config] save-freq: 10000u
[2023-07-22 19:52:57] [config] seed: 1234
[2023-07-22 19:52:57] [config] sentencepiece-alphas:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] sentencepiece-max-lines: 2000000
[2023-07-22 19:52:57] [config] sentencepiece-options: ""
[2023-07-22 19:52:57] [config] sharding: global
[2023-07-22 19:52:57] [config] shuffle: data
[2023-07-22 19:52:57] [config] shuffle-in-ram: false
[2023-07-22 19:52:57] [config] sigterm: save-and-exit
[2023-07-22 19:52:57] [config] skip: false
[2023-07-22 19:52:57] [config] sqlite: ""
[2023-07-22 19:52:57] [config] sqlite-drop: false
[2023-07-22 19:52:57] [config] sync-freq: 200u
[2023-07-22 19:52:57] [config] sync-sgd: false
[2023-07-22 19:52:57] [config] tempdir: /tmp
[2023-07-22 19:52:57] [config] tied-embeddings: false
[2023-07-22 19:52:57] [config] tied-embeddings-all: true
[2023-07-22 19:52:57] [config] tied-embeddings-src: false
[2023-07-22 19:52:57] [config] train-embedder-rank:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] train-sets:
[2023-07-22 19:52:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 19:52:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 19:52:57] [config] transformer-aan-activation: swish
[2023-07-22 19:52:57] [config] transformer-aan-depth: 2
[2023-07-22 19:52:57] [config] transformer-aan-nogate: false
[2023-07-22 19:52:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 19:52:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 19:52:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 19:52:57] [config] transformer-depth-scaling: false
[2023-07-22 19:52:57] [config] transformer-dim-aan: 2048
[2023-07-22 19:52:57] [config] transformer-dim-ffn: 2048
[2023-07-22 19:52:57] [config] transformer-dropout: 0
[2023-07-22 19:52:57] [config] transformer-dropout-attention: 0
[2023-07-22 19:52:57] [config] transformer-dropout-ffn: 0
[2023-07-22 19:52:57] [config] transformer-ffn-activation: swish
[2023-07-22 19:52:57] [config] transformer-ffn-depth: 2
[2023-07-22 19:52:57] [config] transformer-guided-alignment-layer: last
[2023-07-22 19:52:57] [config] transformer-heads: 8
[2023-07-22 19:52:57] [config] transformer-no-projection: false
[2023-07-22 19:52:57] [config] transformer-pool: false
[2023-07-22 19:52:57] [config] transformer-postprocess: dan
[2023-07-22 19:52:57] [config] transformer-postprocess-emb: d
[2023-07-22 19:52:57] [config] transformer-postprocess-top: ""
[2023-07-22 19:52:57] [config] transformer-preprocess: ""
[2023-07-22 19:52:57] [config] transformer-tied-layers:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] transformer-train-position-embeddings: false
[2023-07-22 19:52:57] [config] tsv: false
[2023-07-22 19:52:57] [config] tsv-fields: 0
[2023-07-22 19:52:57] [config] type: amun
[2023-07-22 19:52:57] [config] ulr: false
[2023-07-22 19:52:57] [config] ulr-dim-emb: 0
[2023-07-22 19:52:57] [config] ulr-dropout: 0
[2023-07-22 19:52:57] [config] ulr-keys-vectors: ""
[2023-07-22 19:52:57] [config] ulr-query-vectors: ""
[2023-07-22 19:52:57] [config] ulr-softmax-temperature: 1
[2023-07-22 19:52:57] [config] ulr-trainable-transformation: false
[2023-07-22 19:52:57] [config] unlikelihood-loss: false
[2023-07-22 19:52:57] [config] valid-freq: 50000000
[2023-07-22 19:52:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 19:52:57] [config] valid-max-length: 1000
[2023-07-22 19:52:57] [config] valid-metrics:
[2023-07-22 19:52:57] [config]   - cross-entropy
[2023-07-22 19:52:57] [config]   - translation
[2023-07-22 19:52:57] [config] valid-mini-batch: 32
[2023-07-22 19:52:57] [config] valid-reset-stalled: false
[2023-07-22 19:52:57] [config] valid-script-args:
[2023-07-22 19:52:57] [config]   []
[2023-07-22 19:52:57] [config] valid-script-path: ""
[2023-07-22 19:52:57] [config] valid-sets:
[2023-07-22 19:52:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 19:52:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 19:52:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 19:52:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 19:52:57] [config] vocabs:
[2023-07-22 19:52:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 19:52:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 19:52:57] [config] word-penalty: 0
[2023-07-22 19:52:57] [config] word-scores: false
[2023-07-22 19:52:57] [config] workspace: 5500
[2023-07-22 19:52:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 19:52:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 19:52:57] [training] Using single-device training
[2023-07-22 19:52:58] Synced seed 1234
[2023-07-22 19:52:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 19:52:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 19:52:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 19:52:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 19:52:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 19:52:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 19:52:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 19:52:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 19:52:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 19:52:59] [comm] Using global sharding
[2023-07-22 19:52:59] [comm] NCCLCommunicators constructed successfully
[2023-07-22 19:52:59] [training] Using 1 GPUs
[2023-07-22 19:52:59] [logits] Applying loss function for 1 factor(s)
[2023-07-22 19:52:59] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:53:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 19:53:00] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:29:30] [batching] Done. Typical MB size is 35,936 target words
[2023-07-22 20:29:30] [valid] No post-processing script given for validating translator
[2023-07-22 20:29:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 20:29:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 20:29:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 20:29:30] [comm] Using global sharding
[2023-07-22 20:29:30] [comm] NCCLCommunicators constructed successfully
[2023-07-22 20:29:30] [training] Using 1 GPUs
[2023-07-22 20:29:30] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 20:29:36] Allocating memory for general optimizer shards
[2023-07-22 20:29:36] [memory] Reserving 322 MB, device gpu0
[2023-07-22 20:29:36] Loading Adam parameters
[2023-07-22 20:29:36] [memory] Reserving 322 MB, device gpu0
[2023-07-22 20:29:36] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:29:37] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-22 20:29:37] [data] Restoring the corpus state to epoch 11, batch 449
[2023-07-22 20:29:37] [data] Shuffling data
[2023-07-22 20:29:37] [data] Done reading 20,192 sentences
[2023-07-22 20:29:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:29:37] Training started
[2023-07-22 20:29:37] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 20:29:38] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:29:50] Parameter type float16, optimization type float32, casting types true
[2023-07-22 20:34:00] Seen 20,192 samples
[2023-07-22 20:34:00] Starting data epoch 12 in logical epoch 12
[2023-07-22 20:34:00] [data] Shuffling data
[2023-07-22 20:34:00] [data] Done reading 20,192 sentences
[2023-07-22 20:34:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:38:32] Seen 20,192 samples
[2023-07-22 20:38:32] Starting data epoch 13 in logical epoch 13
[2023-07-22 20:38:32] [data] Shuffling data
[2023-07-22 20:38:32] [data] Done reading 20,192 sentences
[2023-07-22 20:38:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:43:08] Seen 20,192 samples
[2023-07-22 20:43:08] Starting data epoch 14 in logical epoch 14
[2023-07-22 20:43:08] [data] Shuffling data
[2023-07-22 20:43:08] [data] Done reading 20,192 sentences
[2023-07-22 20:43:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:47:45] Seen 20,192 samples
[2023-07-22 20:47:45] Starting data epoch 15 in logical epoch 15
[2023-07-22 20:47:45] [data] Shuffling data
[2023-07-22 20:47:45] [data] Done reading 20,192 sentences
[2023-07-22 20:47:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:52:22] Seen 20,192 samples
[2023-07-22 20:52:22] Starting data epoch 16 in logical epoch 16
[2023-07-22 20:52:22] [data] Shuffling data
[2023-07-22 20:52:22] [data] Done reading 20,192 sentences
[2023-07-22 20:52:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:56:55] Seen 20,192 samples
[2023-07-22 20:56:55] Starting data epoch 17 in logical epoch 17
[2023-07-22 20:56:55] [data] Shuffling data
[2023-07-22 20:56:55] [data] Done reading 20,192 sentences
[2023-07-22 20:56:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:01:27] Seen 20,192 samples
[2023-07-22 21:01:28] Starting data epoch 18 in logical epoch 18
[2023-07-22 21:01:28] [data] Shuffling data
[2023-07-22 21:01:28] [data] Done reading 20,192 sentences
[2023-07-22 21:01:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:06:06] Seen 20,192 samples
[2023-07-22 21:06:06] Starting data epoch 19 in logical epoch 19
[2023-07-22 21:06:06] [data] Shuffling data
[2023-07-22 21:06:06] [data] Done reading 20,192 sentences
[2023-07-22 21:06:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:10:48] Seen 20,192 samples
[2023-07-22 21:10:48] Starting data epoch 20 in logical epoch 20
[2023-07-22 21:10:48] [data] Shuffling data
[2023-07-22 21:10:48] [data] Done reading 20,192 sentences
[2023-07-22 21:10:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:15:22] Seen 20,192 samples
[2023-07-22 21:15:22] Starting data epoch 21 in logical epoch 21
[2023-07-22 21:15:22] Training finished
[2023-07-22 21:15:33] [valid] Ep. 21 : Up. 892 : cross-entropy : 159.087 : new best
[2023-07-22 21:18:21] [valid] Ep. 21 : Up. 892 : translation : 0 : new best
[2023-07-22 21:18:21] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 21:18:23] Saving Adam parameters
[2023-07-22 21:18:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-22 21:18:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 21:18:30] [marian] Running on node22.datos.cluster.uy as process 36783 with command line:
[2023-07-22 21:18:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-22 21:18:30] [config] after: 0e
[2023-07-22 21:18:30] [config] after-batches: 0
[2023-07-22 21:18:30] [config] after-epochs: 30
[2023-07-22 21:18:30] [config] all-caps-every: 0
[2023-07-22 21:18:30] [config] allow-unk: false
[2023-07-22 21:18:30] [config] authors: false
[2023-07-22 21:18:30] [config] beam-size: 12
[2023-07-22 21:18:30] [config] bert-class-symbol: "[CLS]"
[2023-07-22 21:18:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 21:18:30] [config] bert-masking-fraction: 0.15
[2023-07-22 21:18:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 21:18:30] [config] bert-train-type-embeddings: true
[2023-07-22 21:18:30] [config] bert-type-vocab-size: 2
[2023-07-22 21:18:30] [config] build-info: ""
[2023-07-22 21:18:30] [config] check-gradient-nan: false
[2023-07-22 21:18:30] [config] check-nan: false
[2023-07-22 21:18:30] [config] cite: false
[2023-07-22 21:18:30] [config] clip-norm: 1
[2023-07-22 21:18:30] [config] cost-scaling:
[2023-07-22 21:18:30] [config]   - 256.f
[2023-07-22 21:18:30] [config]   - 1000
[2023-07-22 21:18:30] [config]   - 2.f
[2023-07-22 21:18:30] [config]   - 256.f
[2023-07-22 21:18:30] [config] cost-type: ce-sum
[2023-07-22 21:18:30] [config] cpu-threads: 0
[2023-07-22 21:18:30] [config] data-threads: 8
[2023-07-22 21:18:30] [config] data-weighting: ""
[2023-07-22 21:18:30] [config] data-weighting-type: sentence
[2023-07-22 21:18:30] [config] dec-cell: gru
[2023-07-22 21:18:30] [config] dec-cell-base-depth: 2
[2023-07-22 21:18:30] [config] dec-cell-high-depth: 1
[2023-07-22 21:18:30] [config] dec-depth: 1
[2023-07-22 21:18:30] [config] devices:
[2023-07-22 21:18:30] [config]   - 0
[2023-07-22 21:18:30] [config] dim-emb: 512
[2023-07-22 21:18:30] [config] dim-rnn: 1024
[2023-07-22 21:18:30] [config] dim-vocabs:
[2023-07-22 21:18:30] [config]   - 16384
[2023-07-22 21:18:30] [config]   - 16384
[2023-07-22 21:18:30] [config] disp-first: 0
[2023-07-22 21:18:30] [config] disp-freq: 1000u
[2023-07-22 21:18:30] [config] disp-label-counts: true
[2023-07-22 21:18:30] [config] dropout-rnn: 0
[2023-07-22 21:18:30] [config] dropout-src: 0
[2023-07-22 21:18:30] [config] dropout-trg: 0
[2023-07-22 21:18:30] [config] dump-config: ""
[2023-07-22 21:18:30] [config] dynamic-gradient-scaling:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] early-stopping: 200
[2023-07-22 21:18:30] [config] early-stopping-on: first
[2023-07-22 21:18:30] [config] embedding-fix-src: false
[2023-07-22 21:18:30] [config] embedding-fix-trg: false
[2023-07-22 21:18:30] [config] embedding-normalization: false
[2023-07-22 21:18:30] [config] embedding-vectors:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] enc-cell: gru
[2023-07-22 21:18:30] [config] enc-cell-depth: 1
[2023-07-22 21:18:30] [config] enc-depth: 1
[2023-07-22 21:18:30] [config] enc-type: bidirectional
[2023-07-22 21:18:30] [config] english-title-case-every: 0
[2023-07-22 21:18:30] [config] exponential-smoothing: 0
[2023-07-22 21:18:30] [config] factor-weight: 1
[2023-07-22 21:18:30] [config] factors-combine: sum
[2023-07-22 21:18:30] [config] factors-dim-emb: 0
[2023-07-22 21:18:30] [config] gradient-checkpointing: false
[2023-07-22 21:18:30] [config] gradient-norm-average-window: 100
[2023-07-22 21:18:30] [config] guided-alignment: none
[2023-07-22 21:18:30] [config] guided-alignment-cost: mse
[2023-07-22 21:18:30] [config] guided-alignment-weight: 0.1
[2023-07-22 21:18:30] [config] ignore-model-config: false
[2023-07-22 21:18:30] [config] input-types:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] interpolate-env-vars: false
[2023-07-22 21:18:30] [config] keep-best: false
[2023-07-22 21:18:30] [config] label-smoothing: 0
[2023-07-22 21:18:30] [config] layer-normalization: false
[2023-07-22 21:18:30] [config] learn-rate: 0.0001
[2023-07-22 21:18:30] [config] lemma-dependency: ""
[2023-07-22 21:18:30] [config] lemma-dim-emb: 0
[2023-07-22 21:18:30] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 21:18:30] [config] log-level: info
[2023-07-22 21:18:30] [config] log-time-zone: ""
[2023-07-22 21:18:30] [config] logical-epoch:
[2023-07-22 21:18:30] [config]   - 1e
[2023-07-22 21:18:30] [config]   - 0
[2023-07-22 21:18:30] [config] lr-decay: 0
[2023-07-22 21:18:30] [config] lr-decay-freq: 50000
[2023-07-22 21:18:30] [config] lr-decay-inv-sqrt:
[2023-07-22 21:18:30] [config]   - 0
[2023-07-22 21:18:30] [config] lr-decay-repeat-warmup: false
[2023-07-22 21:18:30] [config] lr-decay-reset-optimizer: false
[2023-07-22 21:18:30] [config] lr-decay-start:
[2023-07-22 21:18:30] [config]   - 10
[2023-07-22 21:18:30] [config]   - 1
[2023-07-22 21:18:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 21:18:30] [config] lr-report: false
[2023-07-22 21:18:30] [config] lr-warmup: 0
[2023-07-22 21:18:30] [config] lr-warmup-at-reload: false
[2023-07-22 21:18:30] [config] lr-warmup-cycle: false
[2023-07-22 21:18:30] [config] lr-warmup-start-rate: 0
[2023-07-22 21:18:30] [config] max-length: 200
[2023-07-22 21:18:30] [config] max-length-crop: true
[2023-07-22 21:18:30] [config] max-length-factor: 3
[2023-07-22 21:18:30] [config] maxi-batch: 100
[2023-07-22 21:18:30] [config] maxi-batch-sort: trg
[2023-07-22 21:18:30] [config] mini-batch: 64
[2023-07-22 21:18:30] [config] mini-batch-fit: true
[2023-07-22 21:18:30] [config] mini-batch-fit-step: 10
[2023-07-22 21:18:30] [config] mini-batch-round-up: true
[2023-07-22 21:18:30] [config] mini-batch-track-lr: false
[2023-07-22 21:18:30] [config] mini-batch-warmup: 0
[2023-07-22 21:18:30] [config] mini-batch-words: 0
[2023-07-22 21:18:30] [config] mini-batch-words-ref: 0
[2023-07-22 21:18:30] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 21:18:30] [config] multi-loss-type: sum
[2023-07-22 21:18:30] [config] n-best: false
[2023-07-22 21:18:30] [config] no-nccl: false
[2023-07-22 21:18:30] [config] no-reload: false
[2023-07-22 21:18:30] [config] no-restore-corpus: false
[2023-07-22 21:18:30] [config] normalize: 0
[2023-07-22 21:18:30] [config] normalize-gradient: false
[2023-07-22 21:18:30] [config] num-devices: 0
[2023-07-22 21:18:30] [config] optimizer: adam
[2023-07-22 21:18:30] [config] optimizer-delay: 1
[2023-07-22 21:18:30] [config] optimizer-params:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] output-omit-bias: false
[2023-07-22 21:18:30] [config] overwrite: true
[2023-07-22 21:18:30] [config] precision:
[2023-07-22 21:18:30] [config]   - float16
[2023-07-22 21:18:30] [config]   - float32
[2023-07-22 21:18:30] [config] pretrained-model: ""
[2023-07-22 21:18:30] [config] quantize-biases: false
[2023-07-22 21:18:30] [config] quantize-bits: 0
[2023-07-22 21:18:30] [config] quantize-log-based: false
[2023-07-22 21:18:30] [config] quantize-optimization-steps: 0
[2023-07-22 21:18:30] [config] quiet: false
[2023-07-22 21:18:30] [config] quiet-translation: true
[2023-07-22 21:18:30] [config] relative-paths: false
[2023-07-22 21:18:30] [config] right-left: false
[2023-07-22 21:18:30] [config] save-freq: 10000u
[2023-07-22 21:18:30] [config] seed: 1234
[2023-07-22 21:18:30] [config] sentencepiece-alphas:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] sentencepiece-max-lines: 2000000
[2023-07-22 21:18:30] [config] sentencepiece-options: ""
[2023-07-22 21:18:30] [config] sharding: global
[2023-07-22 21:18:30] [config] shuffle: data
[2023-07-22 21:18:30] [config] shuffle-in-ram: false
[2023-07-22 21:18:30] [config] sigterm: save-and-exit
[2023-07-22 21:18:30] [config] skip: false
[2023-07-22 21:18:30] [config] sqlite: ""
[2023-07-22 21:18:30] [config] sqlite-drop: false
[2023-07-22 21:18:30] [config] sync-freq: 200u
[2023-07-22 21:18:30] [config] sync-sgd: false
[2023-07-22 21:18:30] [config] tempdir: /tmp
[2023-07-22 21:18:30] [config] tied-embeddings: false
[2023-07-22 21:18:30] [config] tied-embeddings-all: true
[2023-07-22 21:18:30] [config] tied-embeddings-src: false
[2023-07-22 21:18:30] [config] train-embedder-rank:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] train-sets:
[2023-07-22 21:18:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 21:18:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 21:18:30] [config] transformer-aan-activation: swish
[2023-07-22 21:18:30] [config] transformer-aan-depth: 2
[2023-07-22 21:18:30] [config] transformer-aan-nogate: false
[2023-07-22 21:18:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 21:18:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 21:18:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 21:18:30] [config] transformer-depth-scaling: false
[2023-07-22 21:18:30] [config] transformer-dim-aan: 2048
[2023-07-22 21:18:30] [config] transformer-dim-ffn: 2048
[2023-07-22 21:18:30] [config] transformer-dropout: 0
[2023-07-22 21:18:30] [config] transformer-dropout-attention: 0
[2023-07-22 21:18:30] [config] transformer-dropout-ffn: 0
[2023-07-22 21:18:30] [config] transformer-ffn-activation: swish
[2023-07-22 21:18:30] [config] transformer-ffn-depth: 2
[2023-07-22 21:18:30] [config] transformer-guided-alignment-layer: last
[2023-07-22 21:18:30] [config] transformer-heads: 8
[2023-07-22 21:18:30] [config] transformer-no-projection: false
[2023-07-22 21:18:30] [config] transformer-pool: false
[2023-07-22 21:18:30] [config] transformer-postprocess: dan
[2023-07-22 21:18:30] [config] transformer-postprocess-emb: d
[2023-07-22 21:18:30] [config] transformer-postprocess-top: ""
[2023-07-22 21:18:30] [config] transformer-preprocess: ""
[2023-07-22 21:18:30] [config] transformer-tied-layers:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] transformer-train-position-embeddings: false
[2023-07-22 21:18:30] [config] tsv: false
[2023-07-22 21:18:30] [config] tsv-fields: 0
[2023-07-22 21:18:30] [config] type: amun
[2023-07-22 21:18:30] [config] ulr: false
[2023-07-22 21:18:30] [config] ulr-dim-emb: 0
[2023-07-22 21:18:30] [config] ulr-dropout: 0
[2023-07-22 21:18:30] [config] ulr-keys-vectors: ""
[2023-07-22 21:18:30] [config] ulr-query-vectors: ""
[2023-07-22 21:18:30] [config] ulr-softmax-temperature: 1
[2023-07-22 21:18:30] [config] ulr-trainable-transformation: false
[2023-07-22 21:18:30] [config] unlikelihood-loss: false
[2023-07-22 21:18:30] [config] valid-freq: 50000000
[2023-07-22 21:18:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 21:18:30] [config] valid-max-length: 1000
[2023-07-22 21:18:30] [config] valid-metrics:
[2023-07-22 21:18:30] [config]   - cross-entropy
[2023-07-22 21:18:30] [config]   - translation
[2023-07-22 21:18:30] [config] valid-mini-batch: 32
[2023-07-22 21:18:30] [config] valid-reset-stalled: false
[2023-07-22 21:18:30] [config] valid-script-args:
[2023-07-22 21:18:30] [config]   []
[2023-07-22 21:18:30] [config] valid-script-path: ""
[2023-07-22 21:18:30] [config] valid-sets:
[2023-07-22 21:18:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 21:18:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 21:18:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 21:18:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 21:18:30] [config] vocabs:
[2023-07-22 21:18:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 21:18:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 21:18:30] [config] word-penalty: 0
[2023-07-22 21:18:30] [config] word-scores: false
[2023-07-22 21:18:30] [config] workspace: 5500
[2023-07-22 21:18:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 21:18:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 21:18:30] [training] Using single-device training
[2023-07-22 21:18:31] Synced seed 1234
[2023-07-22 21:18:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 21:18:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 21:18:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 21:18:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 21:18:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 21:18:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 21:18:31] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 21:18:32] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 21:18:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 21:18:32] [comm] Using global sharding
[2023-07-22 21:18:32] [comm] NCCLCommunicators constructed successfully
[2023-07-22 21:18:32] [training] Using 1 GPUs
[2023-07-22 21:18:32] [logits] Applying loss function for 1 factor(s)
[2023-07-22 21:18:32] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:18:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 21:18:32] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:55:09] [batching] Done. Typical MB size is 35,936 target words
[2023-07-22 21:55:09] [valid] No post-processing script given for validating translator
[2023-07-22 21:55:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 21:55:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 21:55:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 21:55:09] [comm] Using global sharding
[2023-07-22 21:55:10] [comm] NCCLCommunicators constructed successfully
[2023-07-22 21:55:10] [training] Using 1 GPUs
[2023-07-22 21:55:10] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 21:55:17] Allocating memory for general optimizer shards
[2023-07-22 21:55:17] [memory] Reserving 322 MB, device gpu0
[2023-07-22 21:55:17] Loading Adam parameters
[2023-07-22 21:55:17] [memory] Reserving 322 MB, device gpu0
[2023-07-22 21:55:18] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:55:18] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-22 21:55:18] [data] Restoring the corpus state to epoch 21, batch 892
[2023-07-22 21:55:18] [data] Shuffling data
[2023-07-22 21:55:18] [data] Done reading 20,192 sentences
[2023-07-22 21:55:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:55:18] Training started
[2023-07-22 21:55:18] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 21:55:18] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:55:24] Parameter type float16, optimization type float32, casting types true
[2023-07-22 21:59:48] Seen 20,192 samples
[2023-07-22 21:59:48] Starting data epoch 22 in logical epoch 22
[2023-07-22 21:59:48] [data] Shuffling data
[2023-07-22 21:59:48] [data] Done reading 20,192 sentences
[2023-07-22 21:59:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:04:26] Seen 20,192 samples
[2023-07-22 22:04:26] Starting data epoch 23 in logical epoch 23
[2023-07-22 22:04:26] [data] Shuffling data
[2023-07-22 22:04:26] [data] Done reading 20,192 sentences
[2023-07-22 22:04:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:06:38] Ep. 23 : Up. 1000 : Sen. 9,582 : Cost 6.64116907 * 12,217,489 @ 15,016 after 12,217,489 : Time 688.86s : 17735.89 words/s : gNorm 1.2402
[2023-07-22 22:09:11] Seen 20,192 samples
[2023-07-22 22:09:11] Starting data epoch 24 in logical epoch 24
[2023-07-22 22:09:11] [data] Shuffling data
[2023-07-22 22:09:11] [data] Done reading 20,192 sentences
[2023-07-22 22:09:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:14:00] Seen 20,192 samples
[2023-07-22 22:14:00] Starting data epoch 25 in logical epoch 25
[2023-07-22 22:14:00] [data] Shuffling data
[2023-07-22 22:14:00] [data] Done reading 20,192 sentences
[2023-07-22 22:14:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:18:41] Seen 20,192 samples
[2023-07-22 22:18:41] Starting data epoch 26 in logical epoch 26
[2023-07-22 22:18:41] [data] Shuffling data
[2023-07-22 22:18:41] [data] Done reading 20,192 sentences
[2023-07-22 22:18:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:23:26] Seen 20,192 samples
[2023-07-22 22:23:26] Starting data epoch 27 in logical epoch 27
[2023-07-22 22:23:26] [data] Shuffling data
[2023-07-22 22:23:26] [data] Done reading 20,192 sentences
[2023-07-22 22:23:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:27:59] Seen 20,192 samples
[2023-07-22 22:27:59] Starting data epoch 28 in logical epoch 28
[2023-07-22 22:27:59] [data] Shuffling data
[2023-07-22 22:27:59] [data] Done reading 20,192 sentences
[2023-07-22 22:27:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:32:44] Seen 20,192 samples
[2023-07-22 22:32:44] Starting data epoch 29 in logical epoch 29
[2023-07-22 22:32:44] [data] Shuffling data
[2023-07-22 22:32:44] [data] Done reading 20,192 sentences
[2023-07-22 22:32:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:37:32] Seen 20,192 samples
[2023-07-22 22:37:32] Starting data epoch 30 in logical epoch 30
[2023-07-22 22:37:32] [data] Shuffling data
[2023-07-22 22:37:32] [data] Done reading 20,192 sentences
[2023-07-22 22:37:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:42:15] Seen 20,192 samples
[2023-07-22 22:42:15] Starting data epoch 31 in logical epoch 31
[2023-07-22 22:42:15] Training finished
[2023-07-22 22:42:25] [valid] Ep. 31 : Up. 1333 : cross-entropy : 149.399 : new best
[2023-07-22 22:45:38] [valid] Ep. 31 : Up. 1333 : translation : 0 : new best
[2023-07-22 22:45:38] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 22:45:40] Saving Adam parameters
[2023-07-22 22:45:41] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-22 22:45:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 22:45:49] [marian] Running on node22.datos.cluster.uy as process 1851 with command line:
[2023-07-22 22:45:49] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-22 22:45:49] [config] after: 0e
[2023-07-22 22:45:49] [config] after-batches: 0
[2023-07-22 22:45:49] [config] after-epochs: 40
[2023-07-22 22:45:49] [config] all-caps-every: 0
[2023-07-22 22:45:49] [config] allow-unk: false
[2023-07-22 22:45:49] [config] authors: false
[2023-07-22 22:45:49] [config] beam-size: 12
[2023-07-22 22:45:49] [config] bert-class-symbol: "[CLS]"
[2023-07-22 22:45:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 22:45:49] [config] bert-masking-fraction: 0.15
[2023-07-22 22:45:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 22:45:49] [config] bert-train-type-embeddings: true
[2023-07-22 22:45:49] [config] bert-type-vocab-size: 2
[2023-07-22 22:45:49] [config] build-info: ""
[2023-07-22 22:45:49] [config] check-gradient-nan: false
[2023-07-22 22:45:49] [config] check-nan: false
[2023-07-22 22:45:49] [config] cite: false
[2023-07-22 22:45:49] [config] clip-norm: 1
[2023-07-22 22:45:49] [config] cost-scaling:
[2023-07-22 22:45:49] [config]   - 256.f
[2023-07-22 22:45:49] [config]   - 1000
[2023-07-22 22:45:49] [config]   - 2.f
[2023-07-22 22:45:49] [config]   - 256.f
[2023-07-22 22:45:49] [config] cost-type: ce-sum
[2023-07-22 22:45:49] [config] cpu-threads: 0
[2023-07-22 22:45:49] [config] data-threads: 8
[2023-07-22 22:45:49] [config] data-weighting: ""
[2023-07-22 22:45:49] [config] data-weighting-type: sentence
[2023-07-22 22:45:49] [config] dec-cell: gru
[2023-07-22 22:45:49] [config] dec-cell-base-depth: 2
[2023-07-22 22:45:49] [config] dec-cell-high-depth: 1
[2023-07-22 22:45:49] [config] dec-depth: 1
[2023-07-22 22:45:49] [config] devices:
[2023-07-22 22:45:49] [config]   - 0
[2023-07-22 22:45:49] [config] dim-emb: 512
[2023-07-22 22:45:49] [config] dim-rnn: 1024
[2023-07-22 22:45:49] [config] dim-vocabs:
[2023-07-22 22:45:49] [config]   - 16384
[2023-07-22 22:45:49] [config]   - 16384
[2023-07-22 22:45:49] [config] disp-first: 0
[2023-07-22 22:45:49] [config] disp-freq: 1000u
[2023-07-22 22:45:49] [config] disp-label-counts: true
[2023-07-22 22:45:49] [config] dropout-rnn: 0
[2023-07-22 22:45:49] [config] dropout-src: 0
[2023-07-22 22:45:49] [config] dropout-trg: 0
[2023-07-22 22:45:49] [config] dump-config: ""
[2023-07-22 22:45:49] [config] dynamic-gradient-scaling:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] early-stopping: 200
[2023-07-22 22:45:49] [config] early-stopping-on: first
[2023-07-22 22:45:49] [config] embedding-fix-src: false
[2023-07-22 22:45:49] [config] embedding-fix-trg: false
[2023-07-22 22:45:49] [config] embedding-normalization: false
[2023-07-22 22:45:49] [config] embedding-vectors:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] enc-cell: gru
[2023-07-22 22:45:49] [config] enc-cell-depth: 1
[2023-07-22 22:45:49] [config] enc-depth: 1
[2023-07-22 22:45:49] [config] enc-type: bidirectional
[2023-07-22 22:45:49] [config] english-title-case-every: 0
[2023-07-22 22:45:49] [config] exponential-smoothing: 0
[2023-07-22 22:45:49] [config] factor-weight: 1
[2023-07-22 22:45:49] [config] factors-combine: sum
[2023-07-22 22:45:49] [config] factors-dim-emb: 0
[2023-07-22 22:45:49] [config] gradient-checkpointing: false
[2023-07-22 22:45:49] [config] gradient-norm-average-window: 100
[2023-07-22 22:45:49] [config] guided-alignment: none
[2023-07-22 22:45:49] [config] guided-alignment-cost: mse
[2023-07-22 22:45:49] [config] guided-alignment-weight: 0.1
[2023-07-22 22:45:49] [config] ignore-model-config: false
[2023-07-22 22:45:49] [config] input-types:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] interpolate-env-vars: false
[2023-07-22 22:45:49] [config] keep-best: false
[2023-07-22 22:45:49] [config] label-smoothing: 0
[2023-07-22 22:45:49] [config] layer-normalization: false
[2023-07-22 22:45:49] [config] learn-rate: 0.0001
[2023-07-22 22:45:49] [config] lemma-dependency: ""
[2023-07-22 22:45:49] [config] lemma-dim-emb: 0
[2023-07-22 22:45:49] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 22:45:49] [config] log-level: info
[2023-07-22 22:45:49] [config] log-time-zone: ""
[2023-07-22 22:45:49] [config] logical-epoch:
[2023-07-22 22:45:49] [config]   - 1e
[2023-07-22 22:45:49] [config]   - 0
[2023-07-22 22:45:49] [config] lr-decay: 0
[2023-07-22 22:45:49] [config] lr-decay-freq: 50000
[2023-07-22 22:45:49] [config] lr-decay-inv-sqrt:
[2023-07-22 22:45:49] [config]   - 0
[2023-07-22 22:45:49] [config] lr-decay-repeat-warmup: false
[2023-07-22 22:45:49] [config] lr-decay-reset-optimizer: false
[2023-07-22 22:45:49] [config] lr-decay-start:
[2023-07-22 22:45:49] [config]   - 10
[2023-07-22 22:45:49] [config]   - 1
[2023-07-22 22:45:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 22:45:49] [config] lr-report: false
[2023-07-22 22:45:49] [config] lr-warmup: 0
[2023-07-22 22:45:49] [config] lr-warmup-at-reload: false
[2023-07-22 22:45:49] [config] lr-warmup-cycle: false
[2023-07-22 22:45:49] [config] lr-warmup-start-rate: 0
[2023-07-22 22:45:49] [config] max-length: 200
[2023-07-22 22:45:49] [config] max-length-crop: true
[2023-07-22 22:45:49] [config] max-length-factor: 3
[2023-07-22 22:45:49] [config] maxi-batch: 100
[2023-07-22 22:45:49] [config] maxi-batch-sort: trg
[2023-07-22 22:45:49] [config] mini-batch: 64
[2023-07-22 22:45:49] [config] mini-batch-fit: true
[2023-07-22 22:45:49] [config] mini-batch-fit-step: 10
[2023-07-22 22:45:49] [config] mini-batch-round-up: true
[2023-07-22 22:45:49] [config] mini-batch-track-lr: false
[2023-07-22 22:45:49] [config] mini-batch-warmup: 0
[2023-07-22 22:45:49] [config] mini-batch-words: 0
[2023-07-22 22:45:49] [config] mini-batch-words-ref: 0
[2023-07-22 22:45:49] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 22:45:49] [config] multi-loss-type: sum
[2023-07-22 22:45:49] [config] n-best: false
[2023-07-22 22:45:49] [config] no-nccl: false
[2023-07-22 22:45:49] [config] no-reload: false
[2023-07-22 22:45:49] [config] no-restore-corpus: false
[2023-07-22 22:45:49] [config] normalize: 0
[2023-07-22 22:45:49] [config] normalize-gradient: false
[2023-07-22 22:45:49] [config] num-devices: 0
[2023-07-22 22:45:49] [config] optimizer: adam
[2023-07-22 22:45:49] [config] optimizer-delay: 1
[2023-07-22 22:45:49] [config] optimizer-params:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] output-omit-bias: false
[2023-07-22 22:45:49] [config] overwrite: true
[2023-07-22 22:45:49] [config] precision:
[2023-07-22 22:45:49] [config]   - float16
[2023-07-22 22:45:49] [config]   - float32
[2023-07-22 22:45:49] [config] pretrained-model: ""
[2023-07-22 22:45:49] [config] quantize-biases: false
[2023-07-22 22:45:49] [config] quantize-bits: 0
[2023-07-22 22:45:49] [config] quantize-log-based: false
[2023-07-22 22:45:49] [config] quantize-optimization-steps: 0
[2023-07-22 22:45:49] [config] quiet: false
[2023-07-22 22:45:49] [config] quiet-translation: true
[2023-07-22 22:45:49] [config] relative-paths: false
[2023-07-22 22:45:49] [config] right-left: false
[2023-07-22 22:45:49] [config] save-freq: 10000u
[2023-07-22 22:45:49] [config] seed: 1234
[2023-07-22 22:45:49] [config] sentencepiece-alphas:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] sentencepiece-max-lines: 2000000
[2023-07-22 22:45:49] [config] sentencepiece-options: ""
[2023-07-22 22:45:49] [config] sharding: global
[2023-07-22 22:45:49] [config] shuffle: data
[2023-07-22 22:45:49] [config] shuffle-in-ram: false
[2023-07-22 22:45:49] [config] sigterm: save-and-exit
[2023-07-22 22:45:49] [config] skip: false
[2023-07-22 22:45:49] [config] sqlite: ""
[2023-07-22 22:45:49] [config] sqlite-drop: false
[2023-07-22 22:45:49] [config] sync-freq: 200u
[2023-07-22 22:45:49] [config] sync-sgd: false
[2023-07-22 22:45:49] [config] tempdir: /tmp
[2023-07-22 22:45:49] [config] tied-embeddings: false
[2023-07-22 22:45:49] [config] tied-embeddings-all: true
[2023-07-22 22:45:49] [config] tied-embeddings-src: false
[2023-07-22 22:45:49] [config] train-embedder-rank:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] train-sets:
[2023-07-22 22:45:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 22:45:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 22:45:49] [config] transformer-aan-activation: swish
[2023-07-22 22:45:49] [config] transformer-aan-depth: 2
[2023-07-22 22:45:49] [config] transformer-aan-nogate: false
[2023-07-22 22:45:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 22:45:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 22:45:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 22:45:49] [config] transformer-depth-scaling: false
[2023-07-22 22:45:49] [config] transformer-dim-aan: 2048
[2023-07-22 22:45:49] [config] transformer-dim-ffn: 2048
[2023-07-22 22:45:49] [config] transformer-dropout: 0
[2023-07-22 22:45:49] [config] transformer-dropout-attention: 0
[2023-07-22 22:45:49] [config] transformer-dropout-ffn: 0
[2023-07-22 22:45:49] [config] transformer-ffn-activation: swish
[2023-07-22 22:45:49] [config] transformer-ffn-depth: 2
[2023-07-22 22:45:49] [config] transformer-guided-alignment-layer: last
[2023-07-22 22:45:49] [config] transformer-heads: 8
[2023-07-22 22:45:49] [config] transformer-no-projection: false
[2023-07-22 22:45:49] [config] transformer-pool: false
[2023-07-22 22:45:49] [config] transformer-postprocess: dan
[2023-07-22 22:45:49] [config] transformer-postprocess-emb: d
[2023-07-22 22:45:49] [config] transformer-postprocess-top: ""
[2023-07-22 22:45:49] [config] transformer-preprocess: ""
[2023-07-22 22:45:49] [config] transformer-tied-layers:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] transformer-train-position-embeddings: false
[2023-07-22 22:45:49] [config] tsv: false
[2023-07-22 22:45:49] [config] tsv-fields: 0
[2023-07-22 22:45:49] [config] type: amun
[2023-07-22 22:45:49] [config] ulr: false
[2023-07-22 22:45:49] [config] ulr-dim-emb: 0
[2023-07-22 22:45:49] [config] ulr-dropout: 0
[2023-07-22 22:45:49] [config] ulr-keys-vectors: ""
[2023-07-22 22:45:49] [config] ulr-query-vectors: ""
[2023-07-22 22:45:49] [config] ulr-softmax-temperature: 1
[2023-07-22 22:45:49] [config] ulr-trainable-transformation: false
[2023-07-22 22:45:49] [config] unlikelihood-loss: false
[2023-07-22 22:45:49] [config] valid-freq: 50000000
[2023-07-22 22:45:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-22 22:45:49] [config] valid-max-length: 1000
[2023-07-22 22:45:49] [config] valid-metrics:
[2023-07-22 22:45:49] [config]   - cross-entropy
[2023-07-22 22:45:49] [config]   - translation
[2023-07-22 22:45:49] [config] valid-mini-batch: 32
[2023-07-22 22:45:49] [config] valid-reset-stalled: false
[2023-07-22 22:45:49] [config] valid-script-args:
[2023-07-22 22:45:49] [config]   []
[2023-07-22 22:45:49] [config] valid-script-path: ""
[2023-07-22 22:45:49] [config] valid-sets:
[2023-07-22 22:45:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 22:45:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 22:45:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-22 22:45:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 22:45:49] [config] vocabs:
[2023-07-22 22:45:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 22:45:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 22:45:49] [config] word-penalty: 0
[2023-07-22 22:45:49] [config] word-scores: false
[2023-07-22 22:45:49] [config] workspace: 5500
[2023-07-22 22:45:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 22:45:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 22:45:49] [training] Using single-device training
[2023-07-22 22:45:50] Synced seed 1234
[2023-07-22 22:45:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 22:45:50] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 22:45:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 22:45:50] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 22:45:50] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 22:45:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 22:45:50] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 22:45:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 22:45:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 22:45:51] [comm] Using global sharding
[2023-07-22 22:45:51] [comm] NCCLCommunicators constructed successfully
[2023-07-22 22:45:51] [training] Using 1 GPUs
[2023-07-22 22:45:51] [logits] Applying loss function for 1 factor(s)
[2023-07-22 22:45:51] [memory] Reserving 80 MB, device gpu0
[2023-07-22 22:45:52] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 22:45:52] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:22:28] [batching] Done. Typical MB size is 35,936 target words
[2023-07-22 23:22:28] [valid] No post-processing script given for validating translator
[2023-07-22 23:22:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 23:22:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 23:22:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 23:22:28] [comm] Using global sharding
[2023-07-22 23:22:28] [comm] NCCLCommunicators constructed successfully
[2023-07-22 23:22:28] [training] Using 1 GPUs
[2023-07-22 23:22:28] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-22 23:22:35] Allocating memory for general optimizer shards
[2023-07-22 23:22:35] [memory] Reserving 322 MB, device gpu0
[2023-07-22 23:22:35] Loading Adam parameters
[2023-07-22 23:22:35] [memory] Reserving 322 MB, device gpu0
[2023-07-22 23:22:35] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:22:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-22 23:22:35] [data] Restoring the corpus state to epoch 31, batch 1333
[2023-07-22 23:22:35] [data] Shuffling data
[2023-07-22 23:22:35] [data] Done reading 20,192 sentences
[2023-07-22 23:22:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:22:35] Training started
[2023-07-22 23:22:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 23:22:36] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:22:36] Parameter type float16, optimization type float32, casting types true
[2023-07-22 23:27:02] Seen 20,192 samples
[2023-07-22 23:27:02] Starting data epoch 32 in logical epoch 32
[2023-07-22 23:27:02] [data] Shuffling data
[2023-07-22 23:27:02] [data] Done reading 20,192 sentences
[2023-07-22 23:27:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:31:43] Seen 20,192 samples
[2023-07-22 23:31:43] Starting data epoch 33 in logical epoch 33
[2023-07-22 23:31:43] [data] Shuffling data
[2023-07-22 23:31:43] [data] Done reading 20,192 sentences
[2023-07-22 23:31:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:36:25] Seen 20,192 samples
[2023-07-22 23:36:25] Starting data epoch 34 in logical epoch 34
[2023-07-22 23:36:25] [data] Shuffling data
[2023-07-22 23:36:25] [data] Done reading 20,192 sentences
[2023-07-22 23:36:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:40:57] Seen 20,192 samples
[2023-07-22 23:40:57] Starting data epoch 35 in logical epoch 35
[2023-07-22 23:40:57] [data] Shuffling data
[2023-07-22 23:40:57] [data] Done reading 20,192 sentences
[2023-07-22 23:40:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:45:33] Seen 20,192 samples
[2023-07-22 23:45:33] Starting data epoch 36 in logical epoch 36
[2023-07-22 23:45:33] [data] Shuffling data
[2023-07-22 23:45:33] [data] Done reading 20,192 sentences
[2023-07-22 23:45:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:50:24] Seen 20,192 samples
[2023-07-22 23:50:24] Starting data epoch 37 in logical epoch 37
[2023-07-22 23:50:24] [data] Shuffling data
[2023-07-22 23:50:24] [data] Done reading 20,192 sentences
[2023-07-22 23:50:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:55:12] Seen 20,192 samples
[2023-07-22 23:55:12] Starting data epoch 38 in logical epoch 38
[2023-07-22 23:55:12] [data] Shuffling data
[2023-07-22 23:55:12] [data] Done reading 20,192 sentences
[2023-07-22 23:55:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:59:55] Seen 20,192 samples
[2023-07-22 23:59:55] Starting data epoch 39 in logical epoch 39
[2023-07-22 23:59:55] [data] Shuffling data
[2023-07-22 23:59:55] [data] Done reading 20,192 sentences
[2023-07-22 23:59:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:04:37] Seen 20,192 samples
[2023-07-23 00:04:37] Starting data epoch 40 in logical epoch 40
[2023-07-23 00:04:37] [data] Shuffling data
[2023-07-23 00:04:37] [data] Done reading 20,192 sentences
[2023-07-23 00:04:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:09:19] Seen 20,192 samples
[2023-07-23 00:09:19] Starting data epoch 41 in logical epoch 41
[2023-07-23 00:09:19] Training finished
[2023-07-23 00:09:31] [valid] Ep. 41 : Up. 1777 : cross-entropy : 143.724 : new best
[2023-07-23 00:13:35] [valid] Ep. 41 : Up. 1777 : translation : 0 : new best
[2023-07-23 00:13:35] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 00:13:37] Saving Adam parameters
[2023-07-23 00:13:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 00:13:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:13:48] [marian] Running on node22.datos.cluster.uy as process 7553 with command line:
[2023-07-23 00:13:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 00:13:48] [config] after: 0e
[2023-07-23 00:13:48] [config] after-batches: 0
[2023-07-23 00:13:48] [config] after-epochs: 50
[2023-07-23 00:13:48] [config] all-caps-every: 0
[2023-07-23 00:13:48] [config] allow-unk: false
[2023-07-23 00:13:48] [config] authors: false
[2023-07-23 00:13:48] [config] beam-size: 12
[2023-07-23 00:13:48] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:13:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:13:48] [config] bert-masking-fraction: 0.15
[2023-07-23 00:13:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:13:48] [config] bert-train-type-embeddings: true
[2023-07-23 00:13:48] [config] bert-type-vocab-size: 2
[2023-07-23 00:13:48] [config] build-info: ""
[2023-07-23 00:13:48] [config] check-gradient-nan: false
[2023-07-23 00:13:48] [config] check-nan: false
[2023-07-23 00:13:48] [config] cite: false
[2023-07-23 00:13:48] [config] clip-norm: 1
[2023-07-23 00:13:48] [config] cost-scaling:
[2023-07-23 00:13:48] [config]   - 256.f
[2023-07-23 00:13:48] [config]   - 1000
[2023-07-23 00:13:48] [config]   - 2.f
[2023-07-23 00:13:48] [config]   - 256.f
[2023-07-23 00:13:48] [config] cost-type: ce-sum
[2023-07-23 00:13:48] [config] cpu-threads: 0
[2023-07-23 00:13:48] [config] data-threads: 8
[2023-07-23 00:13:48] [config] data-weighting: ""
[2023-07-23 00:13:48] [config] data-weighting-type: sentence
[2023-07-23 00:13:48] [config] dec-cell: gru
[2023-07-23 00:13:48] [config] dec-cell-base-depth: 2
[2023-07-23 00:13:48] [config] dec-cell-high-depth: 1
[2023-07-23 00:13:48] [config] dec-depth: 1
[2023-07-23 00:13:48] [config] devices:
[2023-07-23 00:13:48] [config]   - 0
[2023-07-23 00:13:48] [config] dim-emb: 512
[2023-07-23 00:13:48] [config] dim-rnn: 1024
[2023-07-23 00:13:48] [config] dim-vocabs:
[2023-07-23 00:13:48] [config]   - 16384
[2023-07-23 00:13:48] [config]   - 16384
[2023-07-23 00:13:48] [config] disp-first: 0
[2023-07-23 00:13:48] [config] disp-freq: 1000u
[2023-07-23 00:13:48] [config] disp-label-counts: true
[2023-07-23 00:13:48] [config] dropout-rnn: 0
[2023-07-23 00:13:48] [config] dropout-src: 0
[2023-07-23 00:13:48] [config] dropout-trg: 0
[2023-07-23 00:13:48] [config] dump-config: ""
[2023-07-23 00:13:48] [config] dynamic-gradient-scaling:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] early-stopping: 200
[2023-07-23 00:13:48] [config] early-stopping-on: first
[2023-07-23 00:13:48] [config] embedding-fix-src: false
[2023-07-23 00:13:48] [config] embedding-fix-trg: false
[2023-07-23 00:13:48] [config] embedding-normalization: false
[2023-07-23 00:13:48] [config] embedding-vectors:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] enc-cell: gru
[2023-07-23 00:13:48] [config] enc-cell-depth: 1
[2023-07-23 00:13:48] [config] enc-depth: 1
[2023-07-23 00:13:48] [config] enc-type: bidirectional
[2023-07-23 00:13:48] [config] english-title-case-every: 0
[2023-07-23 00:13:48] [config] exponential-smoothing: 0
[2023-07-23 00:13:48] [config] factor-weight: 1
[2023-07-23 00:13:48] [config] factors-combine: sum
[2023-07-23 00:13:48] [config] factors-dim-emb: 0
[2023-07-23 00:13:48] [config] gradient-checkpointing: false
[2023-07-23 00:13:48] [config] gradient-norm-average-window: 100
[2023-07-23 00:13:48] [config] guided-alignment: none
[2023-07-23 00:13:48] [config] guided-alignment-cost: mse
[2023-07-23 00:13:48] [config] guided-alignment-weight: 0.1
[2023-07-23 00:13:48] [config] ignore-model-config: false
[2023-07-23 00:13:48] [config] input-types:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] interpolate-env-vars: false
[2023-07-23 00:13:48] [config] keep-best: false
[2023-07-23 00:13:48] [config] label-smoothing: 0
[2023-07-23 00:13:48] [config] layer-normalization: false
[2023-07-23 00:13:48] [config] learn-rate: 0.0001
[2023-07-23 00:13:48] [config] lemma-dependency: ""
[2023-07-23 00:13:48] [config] lemma-dim-emb: 0
[2023-07-23 00:13:48] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 00:13:48] [config] log-level: info
[2023-07-23 00:13:48] [config] log-time-zone: ""
[2023-07-23 00:13:48] [config] logical-epoch:
[2023-07-23 00:13:48] [config]   - 1e
[2023-07-23 00:13:48] [config]   - 0
[2023-07-23 00:13:48] [config] lr-decay: 0
[2023-07-23 00:13:48] [config] lr-decay-freq: 50000
[2023-07-23 00:13:48] [config] lr-decay-inv-sqrt:
[2023-07-23 00:13:48] [config]   - 0
[2023-07-23 00:13:48] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:13:48] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:13:48] [config] lr-decay-start:
[2023-07-23 00:13:48] [config]   - 10
[2023-07-23 00:13:48] [config]   - 1
[2023-07-23 00:13:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:13:48] [config] lr-report: false
[2023-07-23 00:13:48] [config] lr-warmup: 0
[2023-07-23 00:13:48] [config] lr-warmup-at-reload: false
[2023-07-23 00:13:48] [config] lr-warmup-cycle: false
[2023-07-23 00:13:48] [config] lr-warmup-start-rate: 0
[2023-07-23 00:13:48] [config] max-length: 200
[2023-07-23 00:13:48] [config] max-length-crop: true
[2023-07-23 00:13:48] [config] max-length-factor: 3
[2023-07-23 00:13:48] [config] maxi-batch: 100
[2023-07-23 00:13:48] [config] maxi-batch-sort: trg
[2023-07-23 00:13:48] [config] mini-batch: 64
[2023-07-23 00:13:48] [config] mini-batch-fit: true
[2023-07-23 00:13:48] [config] mini-batch-fit-step: 10
[2023-07-23 00:13:48] [config] mini-batch-round-up: true
[2023-07-23 00:13:48] [config] mini-batch-track-lr: false
[2023-07-23 00:13:48] [config] mini-batch-warmup: 0
[2023-07-23 00:13:48] [config] mini-batch-words: 0
[2023-07-23 00:13:48] [config] mini-batch-words-ref: 0
[2023-07-23 00:13:48] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 00:13:48] [config] multi-loss-type: sum
[2023-07-23 00:13:48] [config] n-best: false
[2023-07-23 00:13:48] [config] no-nccl: false
[2023-07-23 00:13:48] [config] no-reload: false
[2023-07-23 00:13:48] [config] no-restore-corpus: false
[2023-07-23 00:13:48] [config] normalize: 0
[2023-07-23 00:13:48] [config] normalize-gradient: false
[2023-07-23 00:13:48] [config] num-devices: 0
[2023-07-23 00:13:48] [config] optimizer: adam
[2023-07-23 00:13:48] [config] optimizer-delay: 1
[2023-07-23 00:13:48] [config] optimizer-params:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] output-omit-bias: false
[2023-07-23 00:13:48] [config] overwrite: true
[2023-07-23 00:13:48] [config] precision:
[2023-07-23 00:13:48] [config]   - float16
[2023-07-23 00:13:48] [config]   - float32
[2023-07-23 00:13:48] [config] pretrained-model: ""
[2023-07-23 00:13:48] [config] quantize-biases: false
[2023-07-23 00:13:48] [config] quantize-bits: 0
[2023-07-23 00:13:48] [config] quantize-log-based: false
[2023-07-23 00:13:48] [config] quantize-optimization-steps: 0
[2023-07-23 00:13:48] [config] quiet: false
[2023-07-23 00:13:48] [config] quiet-translation: true
[2023-07-23 00:13:48] [config] relative-paths: false
[2023-07-23 00:13:48] [config] right-left: false
[2023-07-23 00:13:48] [config] save-freq: 10000u
[2023-07-23 00:13:48] [config] seed: 1234
[2023-07-23 00:13:48] [config] sentencepiece-alphas:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:13:48] [config] sentencepiece-options: ""
[2023-07-23 00:13:48] [config] sharding: global
[2023-07-23 00:13:48] [config] shuffle: data
[2023-07-23 00:13:48] [config] shuffle-in-ram: false
[2023-07-23 00:13:48] [config] sigterm: save-and-exit
[2023-07-23 00:13:48] [config] skip: false
[2023-07-23 00:13:48] [config] sqlite: ""
[2023-07-23 00:13:48] [config] sqlite-drop: false
[2023-07-23 00:13:48] [config] sync-freq: 200u
[2023-07-23 00:13:48] [config] sync-sgd: false
[2023-07-23 00:13:48] [config] tempdir: /tmp
[2023-07-23 00:13:48] [config] tied-embeddings: false
[2023-07-23 00:13:48] [config] tied-embeddings-all: true
[2023-07-23 00:13:48] [config] tied-embeddings-src: false
[2023-07-23 00:13:48] [config] train-embedder-rank:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] train-sets:
[2023-07-23 00:13:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:13:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:13:48] [config] transformer-aan-activation: swish
[2023-07-23 00:13:48] [config] transformer-aan-depth: 2
[2023-07-23 00:13:48] [config] transformer-aan-nogate: false
[2023-07-23 00:13:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:13:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:13:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:13:48] [config] transformer-depth-scaling: false
[2023-07-23 00:13:48] [config] transformer-dim-aan: 2048
[2023-07-23 00:13:48] [config] transformer-dim-ffn: 2048
[2023-07-23 00:13:48] [config] transformer-dropout: 0
[2023-07-23 00:13:48] [config] transformer-dropout-attention: 0
[2023-07-23 00:13:48] [config] transformer-dropout-ffn: 0
[2023-07-23 00:13:48] [config] transformer-ffn-activation: swish
[2023-07-23 00:13:48] [config] transformer-ffn-depth: 2
[2023-07-23 00:13:48] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:13:48] [config] transformer-heads: 8
[2023-07-23 00:13:48] [config] transformer-no-projection: false
[2023-07-23 00:13:48] [config] transformer-pool: false
[2023-07-23 00:13:48] [config] transformer-postprocess: dan
[2023-07-23 00:13:48] [config] transformer-postprocess-emb: d
[2023-07-23 00:13:48] [config] transformer-postprocess-top: ""
[2023-07-23 00:13:48] [config] transformer-preprocess: ""
[2023-07-23 00:13:48] [config] transformer-tied-layers:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] transformer-train-position-embeddings: false
[2023-07-23 00:13:48] [config] tsv: false
[2023-07-23 00:13:48] [config] tsv-fields: 0
[2023-07-23 00:13:48] [config] type: amun
[2023-07-23 00:13:48] [config] ulr: false
[2023-07-23 00:13:48] [config] ulr-dim-emb: 0
[2023-07-23 00:13:48] [config] ulr-dropout: 0
[2023-07-23 00:13:48] [config] ulr-keys-vectors: ""
[2023-07-23 00:13:48] [config] ulr-query-vectors: ""
[2023-07-23 00:13:48] [config] ulr-softmax-temperature: 1
[2023-07-23 00:13:48] [config] ulr-trainable-transformation: false
[2023-07-23 00:13:48] [config] unlikelihood-loss: false
[2023-07-23 00:13:48] [config] valid-freq: 50000000
[2023-07-23 00:13:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 00:13:48] [config] valid-max-length: 1000
[2023-07-23 00:13:48] [config] valid-metrics:
[2023-07-23 00:13:48] [config]   - cross-entropy
[2023-07-23 00:13:48] [config]   - translation
[2023-07-23 00:13:48] [config] valid-mini-batch: 32
[2023-07-23 00:13:48] [config] valid-reset-stalled: false
[2023-07-23 00:13:48] [config] valid-script-args:
[2023-07-23 00:13:48] [config]   []
[2023-07-23 00:13:48] [config] valid-script-path: ""
[2023-07-23 00:13:48] [config] valid-sets:
[2023-07-23 00:13:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:13:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:13:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 00:13:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:13:48] [config] vocabs:
[2023-07-23 00:13:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:13:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:13:48] [config] word-penalty: 0
[2023-07-23 00:13:48] [config] word-scores: false
[2023-07-23 00:13:48] [config] workspace: 5500
[2023-07-23 00:13:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:13:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:13:48] [training] Using single-device training
[2023-07-23 00:13:48] Synced seed 1234
[2023-07-23 00:13:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:13:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:13:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:13:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:13:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:13:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:13:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:13:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:13:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 00:13:50] [comm] Using global sharding
[2023-07-23 00:13:50] [comm] NCCLCommunicators constructed successfully
[2023-07-23 00:13:50] [training] Using 1 GPUs
[2023-07-23 00:13:50] [logits] Applying loss function for 1 factor(s)
[2023-07-23 00:13:50] [memory] Reserving 80 MB, device gpu0
[2023-07-23 00:13:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 00:13:50] [memory] Reserving 80 MB, device gpu0
[2023-07-23 00:50:31] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 00:50:31] [valid] No post-processing script given for validating translator
[2023-07-23 00:50:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:50:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:50:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 00:50:31] [comm] Using global sharding
[2023-07-23 00:50:31] [comm] NCCLCommunicators constructed successfully
[2023-07-23 00:50:31] [training] Using 1 GPUs
[2023-07-23 00:50:32] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 00:50:41] Allocating memory for general optimizer shards
[2023-07-23 00:50:41] [memory] Reserving 322 MB, device gpu0
[2023-07-23 00:50:41] Loading Adam parameters
[2023-07-23 00:50:41] [memory] Reserving 322 MB, device gpu0
[2023-07-23 00:50:41] [memory] Reserving 80 MB, device gpu0
[2023-07-23 00:50:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 00:50:41] [data] Restoring the corpus state to epoch 41, batch 1777
[2023-07-23 00:50:41] [data] Shuffling data
[2023-07-23 00:50:41] [data] Done reading 20,192 sentences
[2023-07-23 00:50:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:50:41] Training started
[2023-07-23 00:50:42] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 00:50:42] [memory] Reserving 80 MB, device gpu0
[2023-07-23 00:50:44] Parameter type float16, optimization type float32, casting types true
[2023-07-23 00:55:01] Seen 20,192 samples
[2023-07-23 00:55:01] Starting data epoch 42 in logical epoch 42
[2023-07-23 00:55:01] [data] Shuffling data
[2023-07-23 00:55:01] [data] Done reading 20,192 sentences
[2023-07-23 00:55:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:59:38] Seen 20,192 samples
[2023-07-23 00:59:38] Starting data epoch 43 in logical epoch 43
[2023-07-23 00:59:38] [data] Shuffling data
[2023-07-23 00:59:38] [data] Done reading 20,192 sentences
[2023-07-23 00:59:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:04:17] Seen 20,192 samples
[2023-07-23 01:04:17] Starting data epoch 44 in logical epoch 44
[2023-07-23 01:04:17] [data] Shuffling data
[2023-07-23 01:04:17] [data] Done reading 20,192 sentences
[2023-07-23 01:04:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:09:00] Seen 20,192 samples
[2023-07-23 01:09:00] Starting data epoch 45 in logical epoch 45
[2023-07-23 01:09:00] [data] Shuffling data
[2023-07-23 01:09:00] [data] Done reading 20,192 sentences
[2023-07-23 01:09:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:13:25] Seen 20,192 samples
[2023-07-23 01:13:25] Starting data epoch 46 in logical epoch 46
[2023-07-23 01:13:25] [data] Shuffling data
[2023-07-23 01:13:25] [data] Done reading 20,192 sentences
[2023-07-23 01:13:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:13:27] Ep. 46 : Up. 2000 : Sen. 721 : Cost 5.41153097 * 12,273,094 @ 6,848 after 24,490,583 : Time 1375.93s : 8919.82 words/s : gNorm 1.2188
[2023-07-23 01:18:04] Seen 20,192 samples
[2023-07-23 01:18:04] Starting data epoch 47 in logical epoch 47
[2023-07-23 01:18:04] [data] Shuffling data
[2023-07-23 01:18:04] [data] Done reading 20,192 sentences
[2023-07-23 01:18:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:22:46] Seen 20,192 samples
[2023-07-23 01:22:46] Starting data epoch 48 in logical epoch 48
[2023-07-23 01:22:46] [data] Shuffling data
[2023-07-23 01:22:46] [data] Done reading 20,192 sentences
[2023-07-23 01:22:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:27:25] Seen 20,192 samples
[2023-07-23 01:27:25] Starting data epoch 49 in logical epoch 49
[2023-07-23 01:27:25] [data] Shuffling data
[2023-07-23 01:27:25] [data] Done reading 20,192 sentences
[2023-07-23 01:27:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:32:08] Seen 20,192 samples
[2023-07-23 01:32:08] Starting data epoch 50 in logical epoch 50
[2023-07-23 01:32:08] [data] Shuffling data
[2023-07-23 01:32:08] [data] Done reading 20,192 sentences
[2023-07-23 01:32:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 01:36:47] Seen 20,192 samples
[2023-07-23 01:36:47] Starting data epoch 51 in logical epoch 51
[2023-07-23 01:36:47] Training finished
[2023-07-23 01:36:58] [valid] Ep. 51 : Up. 2220 : cross-entropy : 139.793 : new best
[2023-07-23 01:40:13] [valid] Ep. 51 : Up. 2220 : translation : 0 : new best
[2023-07-23 01:40:13] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 01:40:18] Saving Adam parameters
[2023-07-23 01:40:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 01:40:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 01:40:30] [marian] Running on node22.datos.cluster.uy as process 13153 with command line:
[2023-07-23 01:40:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 01:40:30] [config] after: 0e
[2023-07-23 01:40:30] [config] after-batches: 0
[2023-07-23 01:40:30] [config] after-epochs: 60
[2023-07-23 01:40:30] [config] all-caps-every: 0
[2023-07-23 01:40:30] [config] allow-unk: false
[2023-07-23 01:40:30] [config] authors: false
[2023-07-23 01:40:30] [config] beam-size: 12
[2023-07-23 01:40:30] [config] bert-class-symbol: "[CLS]"
[2023-07-23 01:40:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 01:40:30] [config] bert-masking-fraction: 0.15
[2023-07-23 01:40:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 01:40:30] [config] bert-train-type-embeddings: true
[2023-07-23 01:40:30] [config] bert-type-vocab-size: 2
[2023-07-23 01:40:30] [config] build-info: ""
[2023-07-23 01:40:30] [config] check-gradient-nan: false
[2023-07-23 01:40:30] [config] check-nan: false
[2023-07-23 01:40:30] [config] cite: false
[2023-07-23 01:40:30] [config] clip-norm: 1
[2023-07-23 01:40:30] [config] cost-scaling:
[2023-07-23 01:40:30] [config]   - 256.f
[2023-07-23 01:40:30] [config]   - 1000
[2023-07-23 01:40:30] [config]   - 2.f
[2023-07-23 01:40:30] [config]   - 256.f
[2023-07-23 01:40:30] [config] cost-type: ce-sum
[2023-07-23 01:40:30] [config] cpu-threads: 0
[2023-07-23 01:40:30] [config] data-threads: 8
[2023-07-23 01:40:30] [config] data-weighting: ""
[2023-07-23 01:40:30] [config] data-weighting-type: sentence
[2023-07-23 01:40:30] [config] dec-cell: gru
[2023-07-23 01:40:30] [config] dec-cell-base-depth: 2
[2023-07-23 01:40:30] [config] dec-cell-high-depth: 1
[2023-07-23 01:40:30] [config] dec-depth: 1
[2023-07-23 01:40:30] [config] devices:
[2023-07-23 01:40:30] [config]   - 0
[2023-07-23 01:40:30] [config] dim-emb: 512
[2023-07-23 01:40:30] [config] dim-rnn: 1024
[2023-07-23 01:40:30] [config] dim-vocabs:
[2023-07-23 01:40:30] [config]   - 16384
[2023-07-23 01:40:30] [config]   - 16384
[2023-07-23 01:40:30] [config] disp-first: 0
[2023-07-23 01:40:30] [config] disp-freq: 1000u
[2023-07-23 01:40:30] [config] disp-label-counts: true
[2023-07-23 01:40:30] [config] dropout-rnn: 0
[2023-07-23 01:40:30] [config] dropout-src: 0
[2023-07-23 01:40:30] [config] dropout-trg: 0
[2023-07-23 01:40:30] [config] dump-config: ""
[2023-07-23 01:40:30] [config] dynamic-gradient-scaling:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] early-stopping: 200
[2023-07-23 01:40:30] [config] early-stopping-on: first
[2023-07-23 01:40:30] [config] embedding-fix-src: false
[2023-07-23 01:40:30] [config] embedding-fix-trg: false
[2023-07-23 01:40:30] [config] embedding-normalization: false
[2023-07-23 01:40:30] [config] embedding-vectors:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] enc-cell: gru
[2023-07-23 01:40:30] [config] enc-cell-depth: 1
[2023-07-23 01:40:30] [config] enc-depth: 1
[2023-07-23 01:40:30] [config] enc-type: bidirectional
[2023-07-23 01:40:30] [config] english-title-case-every: 0
[2023-07-23 01:40:30] [config] exponential-smoothing: 0
[2023-07-23 01:40:30] [config] factor-weight: 1
[2023-07-23 01:40:30] [config] factors-combine: sum
[2023-07-23 01:40:30] [config] factors-dim-emb: 0
[2023-07-23 01:40:30] [config] gradient-checkpointing: false
[2023-07-23 01:40:30] [config] gradient-norm-average-window: 100
[2023-07-23 01:40:30] [config] guided-alignment: none
[2023-07-23 01:40:30] [config] guided-alignment-cost: mse
[2023-07-23 01:40:30] [config] guided-alignment-weight: 0.1
[2023-07-23 01:40:30] [config] ignore-model-config: false
[2023-07-23 01:40:30] [config] input-types:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] interpolate-env-vars: false
[2023-07-23 01:40:30] [config] keep-best: false
[2023-07-23 01:40:30] [config] label-smoothing: 0
[2023-07-23 01:40:30] [config] layer-normalization: false
[2023-07-23 01:40:30] [config] learn-rate: 0.0001
[2023-07-23 01:40:30] [config] lemma-dependency: ""
[2023-07-23 01:40:30] [config] lemma-dim-emb: 0
[2023-07-23 01:40:30] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 01:40:30] [config] log-level: info
[2023-07-23 01:40:30] [config] log-time-zone: ""
[2023-07-23 01:40:30] [config] logical-epoch:
[2023-07-23 01:40:30] [config]   - 1e
[2023-07-23 01:40:30] [config]   - 0
[2023-07-23 01:40:30] [config] lr-decay: 0
[2023-07-23 01:40:30] [config] lr-decay-freq: 50000
[2023-07-23 01:40:30] [config] lr-decay-inv-sqrt:
[2023-07-23 01:40:30] [config]   - 0
[2023-07-23 01:40:30] [config] lr-decay-repeat-warmup: false
[2023-07-23 01:40:30] [config] lr-decay-reset-optimizer: false
[2023-07-23 01:40:30] [config] lr-decay-start:
[2023-07-23 01:40:30] [config]   - 10
[2023-07-23 01:40:30] [config]   - 1
[2023-07-23 01:40:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 01:40:30] [config] lr-report: false
[2023-07-23 01:40:30] [config] lr-warmup: 0
[2023-07-23 01:40:30] [config] lr-warmup-at-reload: false
[2023-07-23 01:40:30] [config] lr-warmup-cycle: false
[2023-07-23 01:40:30] [config] lr-warmup-start-rate: 0
[2023-07-23 01:40:30] [config] max-length: 200
[2023-07-23 01:40:30] [config] max-length-crop: true
[2023-07-23 01:40:30] [config] max-length-factor: 3
[2023-07-23 01:40:30] [config] maxi-batch: 100
[2023-07-23 01:40:30] [config] maxi-batch-sort: trg
[2023-07-23 01:40:30] [config] mini-batch: 64
[2023-07-23 01:40:30] [config] mini-batch-fit: true
[2023-07-23 01:40:30] [config] mini-batch-fit-step: 10
[2023-07-23 01:40:30] [config] mini-batch-round-up: true
[2023-07-23 01:40:30] [config] mini-batch-track-lr: false
[2023-07-23 01:40:30] [config] mini-batch-warmup: 0
[2023-07-23 01:40:30] [config] mini-batch-words: 0
[2023-07-23 01:40:30] [config] mini-batch-words-ref: 0
[2023-07-23 01:40:30] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 01:40:30] [config] multi-loss-type: sum
[2023-07-23 01:40:30] [config] n-best: false
[2023-07-23 01:40:30] [config] no-nccl: false
[2023-07-23 01:40:30] [config] no-reload: false
[2023-07-23 01:40:30] [config] no-restore-corpus: false
[2023-07-23 01:40:30] [config] normalize: 0
[2023-07-23 01:40:30] [config] normalize-gradient: false
[2023-07-23 01:40:30] [config] num-devices: 0
[2023-07-23 01:40:30] [config] optimizer: adam
[2023-07-23 01:40:30] [config] optimizer-delay: 1
[2023-07-23 01:40:30] [config] optimizer-params:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] output-omit-bias: false
[2023-07-23 01:40:30] [config] overwrite: true
[2023-07-23 01:40:30] [config] precision:
[2023-07-23 01:40:30] [config]   - float16
[2023-07-23 01:40:30] [config]   - float32
[2023-07-23 01:40:30] [config] pretrained-model: ""
[2023-07-23 01:40:30] [config] quantize-biases: false
[2023-07-23 01:40:30] [config] quantize-bits: 0
[2023-07-23 01:40:30] [config] quantize-log-based: false
[2023-07-23 01:40:30] [config] quantize-optimization-steps: 0
[2023-07-23 01:40:30] [config] quiet: false
[2023-07-23 01:40:30] [config] quiet-translation: true
[2023-07-23 01:40:30] [config] relative-paths: false
[2023-07-23 01:40:30] [config] right-left: false
[2023-07-23 01:40:30] [config] save-freq: 10000u
[2023-07-23 01:40:30] [config] seed: 1234
[2023-07-23 01:40:30] [config] sentencepiece-alphas:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] sentencepiece-max-lines: 2000000
[2023-07-23 01:40:30] [config] sentencepiece-options: ""
[2023-07-23 01:40:30] [config] sharding: global
[2023-07-23 01:40:30] [config] shuffle: data
[2023-07-23 01:40:30] [config] shuffle-in-ram: false
[2023-07-23 01:40:30] [config] sigterm: save-and-exit
[2023-07-23 01:40:30] [config] skip: false
[2023-07-23 01:40:30] [config] sqlite: ""
[2023-07-23 01:40:30] [config] sqlite-drop: false
[2023-07-23 01:40:30] [config] sync-freq: 200u
[2023-07-23 01:40:30] [config] sync-sgd: false
[2023-07-23 01:40:30] [config] tempdir: /tmp
[2023-07-23 01:40:30] [config] tied-embeddings: false
[2023-07-23 01:40:30] [config] tied-embeddings-all: true
[2023-07-23 01:40:30] [config] tied-embeddings-src: false
[2023-07-23 01:40:30] [config] train-embedder-rank:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] train-sets:
[2023-07-23 01:40:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 01:40:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 01:40:30] [config] transformer-aan-activation: swish
[2023-07-23 01:40:30] [config] transformer-aan-depth: 2
[2023-07-23 01:40:30] [config] transformer-aan-nogate: false
[2023-07-23 01:40:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 01:40:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 01:40:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 01:40:30] [config] transformer-depth-scaling: false
[2023-07-23 01:40:30] [config] transformer-dim-aan: 2048
[2023-07-23 01:40:30] [config] transformer-dim-ffn: 2048
[2023-07-23 01:40:30] [config] transformer-dropout: 0
[2023-07-23 01:40:30] [config] transformer-dropout-attention: 0
[2023-07-23 01:40:30] [config] transformer-dropout-ffn: 0
[2023-07-23 01:40:30] [config] transformer-ffn-activation: swish
[2023-07-23 01:40:30] [config] transformer-ffn-depth: 2
[2023-07-23 01:40:30] [config] transformer-guided-alignment-layer: last
[2023-07-23 01:40:30] [config] transformer-heads: 8
[2023-07-23 01:40:30] [config] transformer-no-projection: false
[2023-07-23 01:40:30] [config] transformer-pool: false
[2023-07-23 01:40:30] [config] transformer-postprocess: dan
[2023-07-23 01:40:30] [config] transformer-postprocess-emb: d
[2023-07-23 01:40:30] [config] transformer-postprocess-top: ""
[2023-07-23 01:40:30] [config] transformer-preprocess: ""
[2023-07-23 01:40:30] [config] transformer-tied-layers:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] transformer-train-position-embeddings: false
[2023-07-23 01:40:30] [config] tsv: false
[2023-07-23 01:40:30] [config] tsv-fields: 0
[2023-07-23 01:40:30] [config] type: amun
[2023-07-23 01:40:30] [config] ulr: false
[2023-07-23 01:40:30] [config] ulr-dim-emb: 0
[2023-07-23 01:40:30] [config] ulr-dropout: 0
[2023-07-23 01:40:30] [config] ulr-keys-vectors: ""
[2023-07-23 01:40:30] [config] ulr-query-vectors: ""
[2023-07-23 01:40:30] [config] ulr-softmax-temperature: 1
[2023-07-23 01:40:30] [config] ulr-trainable-transformation: false
[2023-07-23 01:40:30] [config] unlikelihood-loss: false
[2023-07-23 01:40:30] [config] valid-freq: 50000000
[2023-07-23 01:40:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 01:40:30] [config] valid-max-length: 1000
[2023-07-23 01:40:30] [config] valid-metrics:
[2023-07-23 01:40:30] [config]   - cross-entropy
[2023-07-23 01:40:30] [config]   - translation
[2023-07-23 01:40:30] [config] valid-mini-batch: 32
[2023-07-23 01:40:30] [config] valid-reset-stalled: false
[2023-07-23 01:40:30] [config] valid-script-args:
[2023-07-23 01:40:30] [config]   []
[2023-07-23 01:40:30] [config] valid-script-path: ""
[2023-07-23 01:40:30] [config] valid-sets:
[2023-07-23 01:40:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 01:40:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 01:40:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 01:40:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 01:40:30] [config] vocabs:
[2023-07-23 01:40:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 01:40:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 01:40:30] [config] word-penalty: 0
[2023-07-23 01:40:30] [config] word-scores: false
[2023-07-23 01:40:30] [config] workspace: 5500
[2023-07-23 01:40:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 01:40:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 01:40:30] [training] Using single-device training
[2023-07-23 01:40:31] Synced seed 1234
[2023-07-23 01:40:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 01:40:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 01:40:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 01:40:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 01:40:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 01:40:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 01:40:31] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 01:40:32] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 01:40:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 01:40:32] [comm] Using global sharding
[2023-07-23 01:40:32] [comm] NCCLCommunicators constructed successfully
[2023-07-23 01:40:32] [training] Using 1 GPUs
[2023-07-23 01:40:32] [logits] Applying loss function for 1 factor(s)
[2023-07-23 01:40:32] [memory] Reserving 80 MB, device gpu0
[2023-07-23 01:40:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 01:40:32] [memory] Reserving 80 MB, device gpu0
[2023-07-23 02:17:05] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 02:17:06] [valid] No post-processing script given for validating translator
[2023-07-23 02:17:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 02:17:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 02:17:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 02:17:08] [comm] Using global sharding
[2023-07-23 02:17:08] [comm] NCCLCommunicators constructed successfully
[2023-07-23 02:17:08] [training] Using 1 GPUs
[2023-07-23 02:17:08] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 02:17:16] Allocating memory for general optimizer shards
[2023-07-23 02:17:16] [memory] Reserving 322 MB, device gpu0
[2023-07-23 02:17:16] Loading Adam parameters
[2023-07-23 02:17:16] [memory] Reserving 322 MB, device gpu0
[2023-07-23 02:17:17] [memory] Reserving 80 MB, device gpu0
[2023-07-23 02:17:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 02:17:17] [data] Restoring the corpus state to epoch 51, batch 2220
[2023-07-23 02:17:17] [data] Shuffling data
[2023-07-23 02:17:17] [data] Done reading 20,192 sentences
[2023-07-23 02:17:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:17:17] Training started
[2023-07-23 02:17:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 02:17:17] [memory] Reserving 80 MB, device gpu0
[2023-07-23 02:17:22] Parameter type float16, optimization type float32, casting types true
[2023-07-23 02:21:58] Seen 20,192 samples
[2023-07-23 02:21:58] Starting data epoch 52 in logical epoch 52
[2023-07-23 02:21:58] [data] Shuffling data
[2023-07-23 02:21:58] [data] Done reading 20,192 sentences
[2023-07-23 02:21:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:26:34] Seen 20,192 samples
[2023-07-23 02:26:34] Starting data epoch 53 in logical epoch 53
[2023-07-23 02:26:34] [data] Shuffling data
[2023-07-23 02:26:34] [data] Done reading 20,192 sentences
[2023-07-23 02:26:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:31:13] Seen 20,192 samples
[2023-07-23 02:31:13] Starting data epoch 54 in logical epoch 54
[2023-07-23 02:31:13] [data] Shuffling data
[2023-07-23 02:31:13] [data] Done reading 20,192 sentences
[2023-07-23 02:31:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:35:59] Seen 20,192 samples
[2023-07-23 02:35:59] Starting data epoch 55 in logical epoch 55
[2023-07-23 02:35:59] [data] Shuffling data
[2023-07-23 02:35:59] [data] Done reading 20,192 sentences
[2023-07-23 02:35:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:40:48] Seen 20,192 samples
[2023-07-23 02:40:48] Starting data epoch 56 in logical epoch 56
[2023-07-23 02:40:48] [data] Shuffling data
[2023-07-23 02:40:48] [data] Done reading 20,192 sentences
[2023-07-23 02:40:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:45:21] Seen 20,192 samples
[2023-07-23 02:45:21] Starting data epoch 57 in logical epoch 57
[2023-07-23 02:45:21] [data] Shuffling data
[2023-07-23 02:45:21] [data] Done reading 20,192 sentences
[2023-07-23 02:45:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:50:00] Seen 20,192 samples
[2023-07-23 02:50:00] Starting data epoch 58 in logical epoch 58
[2023-07-23 02:50:00] [data] Shuffling data
[2023-07-23 02:50:00] [data] Done reading 20,192 sentences
[2023-07-23 02:50:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:54:54] Seen 20,192 samples
[2023-07-23 02:54:54] Starting data epoch 59 in logical epoch 59
[2023-07-23 02:54:54] [data] Shuffling data
[2023-07-23 02:54:54] [data] Done reading 20,192 sentences
[2023-07-23 02:54:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 02:59:49] Seen 20,192 samples
[2023-07-23 02:59:49] Starting data epoch 60 in logical epoch 60
[2023-07-23 02:59:49] [data] Shuffling data
[2023-07-23 02:59:49] [data] Done reading 20,192 sentences
[2023-07-23 02:59:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 03:04:47] Seen 20,192 samples
[2023-07-23 03:04:47] Starting data epoch 61 in logical epoch 61
[2023-07-23 03:04:47] Training finished
[2023-07-23 03:04:58] [valid] Ep. 61 : Up. 2661 : cross-entropy : 136.13 : new best
[2023-07-23 03:09:35] [valid] Ep. 61 : Up. 2661 : translation : 0 : new best
[2023-07-23 03:09:35] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 03:09:37] Saving Adam parameters
[2023-07-23 03:09:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 03:09:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 03:09:45] [marian] Running on node22.datos.cluster.uy as process 18860 with command line:
[2023-07-23 03:09:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 03:09:45] [config] after: 0e
[2023-07-23 03:09:45] [config] after-batches: 0
[2023-07-23 03:09:45] [config] after-epochs: 70
[2023-07-23 03:09:45] [config] all-caps-every: 0
[2023-07-23 03:09:45] [config] allow-unk: false
[2023-07-23 03:09:45] [config] authors: false
[2023-07-23 03:09:45] [config] beam-size: 12
[2023-07-23 03:09:45] [config] bert-class-symbol: "[CLS]"
[2023-07-23 03:09:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 03:09:45] [config] bert-masking-fraction: 0.15
[2023-07-23 03:09:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 03:09:45] [config] bert-train-type-embeddings: true
[2023-07-23 03:09:45] [config] bert-type-vocab-size: 2
[2023-07-23 03:09:45] [config] build-info: ""
[2023-07-23 03:09:45] [config] check-gradient-nan: false
[2023-07-23 03:09:45] [config] check-nan: false
[2023-07-23 03:09:45] [config] cite: false
[2023-07-23 03:09:45] [config] clip-norm: 1
[2023-07-23 03:09:45] [config] cost-scaling:
[2023-07-23 03:09:45] [config]   - 256.f
[2023-07-23 03:09:45] [config]   - 1000
[2023-07-23 03:09:45] [config]   - 2.f
[2023-07-23 03:09:45] [config]   - 256.f
[2023-07-23 03:09:45] [config] cost-type: ce-sum
[2023-07-23 03:09:45] [config] cpu-threads: 0
[2023-07-23 03:09:45] [config] data-threads: 8
[2023-07-23 03:09:45] [config] data-weighting: ""
[2023-07-23 03:09:45] [config] data-weighting-type: sentence
[2023-07-23 03:09:45] [config] dec-cell: gru
[2023-07-23 03:09:45] [config] dec-cell-base-depth: 2
[2023-07-23 03:09:45] [config] dec-cell-high-depth: 1
[2023-07-23 03:09:45] [config] dec-depth: 1
[2023-07-23 03:09:45] [config] devices:
[2023-07-23 03:09:45] [config]   - 0
[2023-07-23 03:09:45] [config] dim-emb: 512
[2023-07-23 03:09:45] [config] dim-rnn: 1024
[2023-07-23 03:09:45] [config] dim-vocabs:
[2023-07-23 03:09:45] [config]   - 16384
[2023-07-23 03:09:45] [config]   - 16384
[2023-07-23 03:09:45] [config] disp-first: 0
[2023-07-23 03:09:45] [config] disp-freq: 1000u
[2023-07-23 03:09:45] [config] disp-label-counts: true
[2023-07-23 03:09:45] [config] dropout-rnn: 0
[2023-07-23 03:09:45] [config] dropout-src: 0
[2023-07-23 03:09:45] [config] dropout-trg: 0
[2023-07-23 03:09:45] [config] dump-config: ""
[2023-07-23 03:09:45] [config] dynamic-gradient-scaling:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] early-stopping: 200
[2023-07-23 03:09:45] [config] early-stopping-on: first
[2023-07-23 03:09:45] [config] embedding-fix-src: false
[2023-07-23 03:09:45] [config] embedding-fix-trg: false
[2023-07-23 03:09:45] [config] embedding-normalization: false
[2023-07-23 03:09:45] [config] embedding-vectors:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] enc-cell: gru
[2023-07-23 03:09:45] [config] enc-cell-depth: 1
[2023-07-23 03:09:45] [config] enc-depth: 1
[2023-07-23 03:09:45] [config] enc-type: bidirectional
[2023-07-23 03:09:45] [config] english-title-case-every: 0
[2023-07-23 03:09:45] [config] exponential-smoothing: 0
[2023-07-23 03:09:45] [config] factor-weight: 1
[2023-07-23 03:09:45] [config] factors-combine: sum
[2023-07-23 03:09:45] [config] factors-dim-emb: 0
[2023-07-23 03:09:45] [config] gradient-checkpointing: false
[2023-07-23 03:09:45] [config] gradient-norm-average-window: 100
[2023-07-23 03:09:45] [config] guided-alignment: none
[2023-07-23 03:09:45] [config] guided-alignment-cost: mse
[2023-07-23 03:09:45] [config] guided-alignment-weight: 0.1
[2023-07-23 03:09:45] [config] ignore-model-config: false
[2023-07-23 03:09:45] [config] input-types:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] interpolate-env-vars: false
[2023-07-23 03:09:45] [config] keep-best: false
[2023-07-23 03:09:45] [config] label-smoothing: 0
[2023-07-23 03:09:45] [config] layer-normalization: false
[2023-07-23 03:09:45] [config] learn-rate: 0.0001
[2023-07-23 03:09:45] [config] lemma-dependency: ""
[2023-07-23 03:09:45] [config] lemma-dim-emb: 0
[2023-07-23 03:09:45] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 03:09:45] [config] log-level: info
[2023-07-23 03:09:45] [config] log-time-zone: ""
[2023-07-23 03:09:45] [config] logical-epoch:
[2023-07-23 03:09:45] [config]   - 1e
[2023-07-23 03:09:45] [config]   - 0
[2023-07-23 03:09:45] [config] lr-decay: 0
[2023-07-23 03:09:45] [config] lr-decay-freq: 50000
[2023-07-23 03:09:45] [config] lr-decay-inv-sqrt:
[2023-07-23 03:09:45] [config]   - 0
[2023-07-23 03:09:45] [config] lr-decay-repeat-warmup: false
[2023-07-23 03:09:45] [config] lr-decay-reset-optimizer: false
[2023-07-23 03:09:45] [config] lr-decay-start:
[2023-07-23 03:09:45] [config]   - 10
[2023-07-23 03:09:45] [config]   - 1
[2023-07-23 03:09:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 03:09:45] [config] lr-report: false
[2023-07-23 03:09:45] [config] lr-warmup: 0
[2023-07-23 03:09:45] [config] lr-warmup-at-reload: false
[2023-07-23 03:09:45] [config] lr-warmup-cycle: false
[2023-07-23 03:09:45] [config] lr-warmup-start-rate: 0
[2023-07-23 03:09:45] [config] max-length: 200
[2023-07-23 03:09:45] [config] max-length-crop: true
[2023-07-23 03:09:45] [config] max-length-factor: 3
[2023-07-23 03:09:45] [config] maxi-batch: 100
[2023-07-23 03:09:45] [config] maxi-batch-sort: trg
[2023-07-23 03:09:45] [config] mini-batch: 64
[2023-07-23 03:09:45] [config] mini-batch-fit: true
[2023-07-23 03:09:45] [config] mini-batch-fit-step: 10
[2023-07-23 03:09:45] [config] mini-batch-round-up: true
[2023-07-23 03:09:45] [config] mini-batch-track-lr: false
[2023-07-23 03:09:45] [config] mini-batch-warmup: 0
[2023-07-23 03:09:45] [config] mini-batch-words: 0
[2023-07-23 03:09:45] [config] mini-batch-words-ref: 0
[2023-07-23 03:09:45] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 03:09:45] [config] multi-loss-type: sum
[2023-07-23 03:09:45] [config] n-best: false
[2023-07-23 03:09:45] [config] no-nccl: false
[2023-07-23 03:09:45] [config] no-reload: false
[2023-07-23 03:09:45] [config] no-restore-corpus: false
[2023-07-23 03:09:45] [config] normalize: 0
[2023-07-23 03:09:45] [config] normalize-gradient: false
[2023-07-23 03:09:45] [config] num-devices: 0
[2023-07-23 03:09:45] [config] optimizer: adam
[2023-07-23 03:09:45] [config] optimizer-delay: 1
[2023-07-23 03:09:45] [config] optimizer-params:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] output-omit-bias: false
[2023-07-23 03:09:45] [config] overwrite: true
[2023-07-23 03:09:45] [config] precision:
[2023-07-23 03:09:45] [config]   - float16
[2023-07-23 03:09:45] [config]   - float32
[2023-07-23 03:09:45] [config] pretrained-model: ""
[2023-07-23 03:09:45] [config] quantize-biases: false
[2023-07-23 03:09:45] [config] quantize-bits: 0
[2023-07-23 03:09:45] [config] quantize-log-based: false
[2023-07-23 03:09:45] [config] quantize-optimization-steps: 0
[2023-07-23 03:09:45] [config] quiet: false
[2023-07-23 03:09:45] [config] quiet-translation: true
[2023-07-23 03:09:45] [config] relative-paths: false
[2023-07-23 03:09:45] [config] right-left: false
[2023-07-23 03:09:45] [config] save-freq: 10000u
[2023-07-23 03:09:45] [config] seed: 1234
[2023-07-23 03:09:45] [config] sentencepiece-alphas:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] sentencepiece-max-lines: 2000000
[2023-07-23 03:09:45] [config] sentencepiece-options: ""
[2023-07-23 03:09:45] [config] sharding: global
[2023-07-23 03:09:45] [config] shuffle: data
[2023-07-23 03:09:45] [config] shuffle-in-ram: false
[2023-07-23 03:09:45] [config] sigterm: save-and-exit
[2023-07-23 03:09:45] [config] skip: false
[2023-07-23 03:09:45] [config] sqlite: ""
[2023-07-23 03:09:45] [config] sqlite-drop: false
[2023-07-23 03:09:45] [config] sync-freq: 200u
[2023-07-23 03:09:45] [config] sync-sgd: false
[2023-07-23 03:09:45] [config] tempdir: /tmp
[2023-07-23 03:09:45] [config] tied-embeddings: false
[2023-07-23 03:09:45] [config] tied-embeddings-all: true
[2023-07-23 03:09:45] [config] tied-embeddings-src: false
[2023-07-23 03:09:45] [config] train-embedder-rank:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] train-sets:
[2023-07-23 03:09:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 03:09:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 03:09:45] [config] transformer-aan-activation: swish
[2023-07-23 03:09:45] [config] transformer-aan-depth: 2
[2023-07-23 03:09:45] [config] transformer-aan-nogate: false
[2023-07-23 03:09:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 03:09:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 03:09:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 03:09:45] [config] transformer-depth-scaling: false
[2023-07-23 03:09:45] [config] transformer-dim-aan: 2048
[2023-07-23 03:09:45] [config] transformer-dim-ffn: 2048
[2023-07-23 03:09:45] [config] transformer-dropout: 0
[2023-07-23 03:09:45] [config] transformer-dropout-attention: 0
[2023-07-23 03:09:45] [config] transformer-dropout-ffn: 0
[2023-07-23 03:09:45] [config] transformer-ffn-activation: swish
[2023-07-23 03:09:45] [config] transformer-ffn-depth: 2
[2023-07-23 03:09:45] [config] transformer-guided-alignment-layer: last
[2023-07-23 03:09:45] [config] transformer-heads: 8
[2023-07-23 03:09:45] [config] transformer-no-projection: false
[2023-07-23 03:09:45] [config] transformer-pool: false
[2023-07-23 03:09:45] [config] transformer-postprocess: dan
[2023-07-23 03:09:45] [config] transformer-postprocess-emb: d
[2023-07-23 03:09:45] [config] transformer-postprocess-top: ""
[2023-07-23 03:09:45] [config] transformer-preprocess: ""
[2023-07-23 03:09:45] [config] transformer-tied-layers:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] transformer-train-position-embeddings: false
[2023-07-23 03:09:45] [config] tsv: false
[2023-07-23 03:09:45] [config] tsv-fields: 0
[2023-07-23 03:09:45] [config] type: amun
[2023-07-23 03:09:45] [config] ulr: false
[2023-07-23 03:09:45] [config] ulr-dim-emb: 0
[2023-07-23 03:09:45] [config] ulr-dropout: 0
[2023-07-23 03:09:45] [config] ulr-keys-vectors: ""
[2023-07-23 03:09:45] [config] ulr-query-vectors: ""
[2023-07-23 03:09:45] [config] ulr-softmax-temperature: 1
[2023-07-23 03:09:45] [config] ulr-trainable-transformation: false
[2023-07-23 03:09:45] [config] unlikelihood-loss: false
[2023-07-23 03:09:45] [config] valid-freq: 50000000
[2023-07-23 03:09:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 03:09:45] [config] valid-max-length: 1000
[2023-07-23 03:09:45] [config] valid-metrics:
[2023-07-23 03:09:45] [config]   - cross-entropy
[2023-07-23 03:09:45] [config]   - translation
[2023-07-23 03:09:45] [config] valid-mini-batch: 32
[2023-07-23 03:09:45] [config] valid-reset-stalled: false
[2023-07-23 03:09:45] [config] valid-script-args:
[2023-07-23 03:09:45] [config]   []
[2023-07-23 03:09:45] [config] valid-script-path: ""
[2023-07-23 03:09:45] [config] valid-sets:
[2023-07-23 03:09:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 03:09:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 03:09:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 03:09:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 03:09:45] [config] vocabs:
[2023-07-23 03:09:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 03:09:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 03:09:45] [config] word-penalty: 0
[2023-07-23 03:09:45] [config] word-scores: false
[2023-07-23 03:09:45] [config] workspace: 5500
[2023-07-23 03:09:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 03:09:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 03:09:45] [training] Using single-device training
[2023-07-23 03:09:45] Synced seed 1234
[2023-07-23 03:09:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 03:09:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 03:09:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 03:09:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 03:09:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 03:09:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 03:09:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 03:09:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 03:09:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 03:09:47] [comm] Using global sharding
[2023-07-23 03:09:47] [comm] NCCLCommunicators constructed successfully
[2023-07-23 03:09:47] [training] Using 1 GPUs
[2023-07-23 03:09:47] [logits] Applying loss function for 1 factor(s)
[2023-07-23 03:09:47] [memory] Reserving 80 MB, device gpu0
[2023-07-23 03:09:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 03:09:47] [memory] Reserving 80 MB, device gpu0
[2023-07-23 03:46:48] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 03:46:48] [valid] No post-processing script given for validating translator
[2023-07-23 03:46:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 03:46:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 03:46:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 03:46:48] [comm] Using global sharding
[2023-07-23 03:46:49] [comm] NCCLCommunicators constructed successfully
[2023-07-23 03:46:49] [training] Using 1 GPUs
[2023-07-23 03:46:49] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 03:46:57] Allocating memory for general optimizer shards
[2023-07-23 03:46:57] [memory] Reserving 322 MB, device gpu0
[2023-07-23 03:46:57] Loading Adam parameters
[2023-07-23 03:46:57] [memory] Reserving 322 MB, device gpu0
[2023-07-23 03:46:57] [memory] Reserving 80 MB, device gpu0
[2023-07-23 03:46:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 03:46:57] [data] Restoring the corpus state to epoch 61, batch 2661
[2023-07-23 03:46:57] [data] Shuffling data
[2023-07-23 03:46:57] [data] Done reading 20,192 sentences
[2023-07-23 03:46:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 03:46:57] Training started
[2023-07-23 03:46:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 03:46:58] [memory] Reserving 80 MB, device gpu0
[2023-07-23 03:47:00] Parameter type float16, optimization type float32, casting types true
[2023-07-23 03:51:49] Seen 20,192 samples
[2023-07-23 03:51:49] Starting data epoch 62 in logical epoch 62
[2023-07-23 03:51:49] [data] Shuffling data
[2023-07-23 03:51:49] [data] Done reading 20,192 sentences
[2023-07-23 03:51:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 03:56:42] Seen 20,192 samples
[2023-07-23 03:56:42] Starting data epoch 63 in logical epoch 63
[2023-07-23 03:56:42] [data] Shuffling data
[2023-07-23 03:56:42] [data] Done reading 20,192 sentences
[2023-07-23 03:56:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:01:36] Seen 20,192 samples
[2023-07-23 04:01:36] Starting data epoch 64 in logical epoch 64
[2023-07-23 04:01:36] [data] Shuffling data
[2023-07-23 04:01:36] [data] Done reading 20,192 sentences
[2023-07-23 04:01:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:06:20] Seen 20,192 samples
[2023-07-23 04:06:20] Starting data epoch 65 in logical epoch 65
[2023-07-23 04:06:20] [data] Shuffling data
[2023-07-23 04:06:20] [data] Done reading 20,192 sentences
[2023-07-23 04:06:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:11:05] Seen 20,192 samples
[2023-07-23 04:11:05] Starting data epoch 66 in logical epoch 66
[2023-07-23 04:11:05] [data] Shuffling data
[2023-07-23 04:11:05] [data] Done reading 20,192 sentences
[2023-07-23 04:11:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:16:08] Seen 20,192 samples
[2023-07-23 04:16:08] Starting data epoch 67 in logical epoch 67
[2023-07-23 04:16:08] [data] Shuffling data
[2023-07-23 04:16:08] [data] Done reading 20,192 sentences
[2023-07-23 04:16:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:21:06] Seen 20,192 samples
[2023-07-23 04:21:06] Starting data epoch 68 in logical epoch 68
[2023-07-23 04:21:06] [data] Shuffling data
[2023-07-23 04:21:06] [data] Done reading 20,192 sentences
[2023-07-23 04:21:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:24:22] Ep. 68 : Up. 3000 : Sen. 14,339 : Cost 4.78223276 * 12,330,153 @ 17,327 after 36,820,736 : Time 2254.10s : 5470.10 words/s : gNorm 1.1587
[2023-07-23 04:25:54] Seen 20,192 samples
[2023-07-23 04:25:54] Starting data epoch 69 in logical epoch 69
[2023-07-23 04:25:54] [data] Shuffling data
[2023-07-23 04:25:54] [data] Done reading 20,192 sentences
[2023-07-23 04:25:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:30:43] Seen 20,192 samples
[2023-07-23 04:30:43] Starting data epoch 70 in logical epoch 70
[2023-07-23 04:30:43] [data] Shuffling data
[2023-07-23 04:30:43] [data] Done reading 20,192 sentences
[2023-07-23 04:30:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 04:35:42] Seen 20,192 samples
[2023-07-23 04:35:42] Starting data epoch 71 in logical epoch 71
[2023-07-23 04:35:42] Training finished
[2023-07-23 04:35:55] [valid] Ep. 71 : Up. 3102 : cross-entropy : 134.858 : new best
[2023-07-23 04:39:08] [valid] Ep. 71 : Up. 3102 : translation : 0 : new best
[2023-07-23 04:39:08] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 04:39:11] Saving Adam parameters
[2023-07-23 04:39:11] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 04:39:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 04:39:22] [marian] Running on node22.datos.cluster.uy as process 24607 with command line:
[2023-07-23 04:39:22] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 04:39:22] [config] after: 0e
[2023-07-23 04:39:22] [config] after-batches: 0
[2023-07-23 04:39:22] [config] after-epochs: 80
[2023-07-23 04:39:22] [config] all-caps-every: 0
[2023-07-23 04:39:22] [config] allow-unk: false
[2023-07-23 04:39:22] [config] authors: false
[2023-07-23 04:39:22] [config] beam-size: 12
[2023-07-23 04:39:22] [config] bert-class-symbol: "[CLS]"
[2023-07-23 04:39:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 04:39:22] [config] bert-masking-fraction: 0.15
[2023-07-23 04:39:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 04:39:22] [config] bert-train-type-embeddings: true
[2023-07-23 04:39:22] [config] bert-type-vocab-size: 2
[2023-07-23 04:39:22] [config] build-info: ""
[2023-07-23 04:39:22] [config] check-gradient-nan: false
[2023-07-23 04:39:22] [config] check-nan: false
[2023-07-23 04:39:22] [config] cite: false
[2023-07-23 04:39:22] [config] clip-norm: 1
[2023-07-23 04:39:22] [config] cost-scaling:
[2023-07-23 04:39:22] [config]   - 256.f
[2023-07-23 04:39:22] [config]   - 1000
[2023-07-23 04:39:22] [config]   - 2.f
[2023-07-23 04:39:22] [config]   - 256.f
[2023-07-23 04:39:22] [config] cost-type: ce-sum
[2023-07-23 04:39:22] [config] cpu-threads: 0
[2023-07-23 04:39:22] [config] data-threads: 8
[2023-07-23 04:39:22] [config] data-weighting: ""
[2023-07-23 04:39:22] [config] data-weighting-type: sentence
[2023-07-23 04:39:22] [config] dec-cell: gru
[2023-07-23 04:39:22] [config] dec-cell-base-depth: 2
[2023-07-23 04:39:22] [config] dec-cell-high-depth: 1
[2023-07-23 04:39:22] [config] dec-depth: 1
[2023-07-23 04:39:22] [config] devices:
[2023-07-23 04:39:22] [config]   - 0
[2023-07-23 04:39:22] [config] dim-emb: 512
[2023-07-23 04:39:22] [config] dim-rnn: 1024
[2023-07-23 04:39:22] [config] dim-vocabs:
[2023-07-23 04:39:22] [config]   - 16384
[2023-07-23 04:39:22] [config]   - 16384
[2023-07-23 04:39:22] [config] disp-first: 0
[2023-07-23 04:39:22] [config] disp-freq: 1000u
[2023-07-23 04:39:22] [config] disp-label-counts: true
[2023-07-23 04:39:22] [config] dropout-rnn: 0
[2023-07-23 04:39:22] [config] dropout-src: 0
[2023-07-23 04:39:22] [config] dropout-trg: 0
[2023-07-23 04:39:22] [config] dump-config: ""
[2023-07-23 04:39:22] [config] dynamic-gradient-scaling:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] early-stopping: 200
[2023-07-23 04:39:22] [config] early-stopping-on: first
[2023-07-23 04:39:22] [config] embedding-fix-src: false
[2023-07-23 04:39:22] [config] embedding-fix-trg: false
[2023-07-23 04:39:22] [config] embedding-normalization: false
[2023-07-23 04:39:22] [config] embedding-vectors:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] enc-cell: gru
[2023-07-23 04:39:22] [config] enc-cell-depth: 1
[2023-07-23 04:39:22] [config] enc-depth: 1
[2023-07-23 04:39:22] [config] enc-type: bidirectional
[2023-07-23 04:39:22] [config] english-title-case-every: 0
[2023-07-23 04:39:22] [config] exponential-smoothing: 0
[2023-07-23 04:39:22] [config] factor-weight: 1
[2023-07-23 04:39:22] [config] factors-combine: sum
[2023-07-23 04:39:22] [config] factors-dim-emb: 0
[2023-07-23 04:39:22] [config] gradient-checkpointing: false
[2023-07-23 04:39:22] [config] gradient-norm-average-window: 100
[2023-07-23 04:39:22] [config] guided-alignment: none
[2023-07-23 04:39:22] [config] guided-alignment-cost: mse
[2023-07-23 04:39:22] [config] guided-alignment-weight: 0.1
[2023-07-23 04:39:22] [config] ignore-model-config: false
[2023-07-23 04:39:22] [config] input-types:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] interpolate-env-vars: false
[2023-07-23 04:39:22] [config] keep-best: false
[2023-07-23 04:39:22] [config] label-smoothing: 0
[2023-07-23 04:39:22] [config] layer-normalization: false
[2023-07-23 04:39:22] [config] learn-rate: 0.0001
[2023-07-23 04:39:22] [config] lemma-dependency: ""
[2023-07-23 04:39:22] [config] lemma-dim-emb: 0
[2023-07-23 04:39:22] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 04:39:22] [config] log-level: info
[2023-07-23 04:39:22] [config] log-time-zone: ""
[2023-07-23 04:39:22] [config] logical-epoch:
[2023-07-23 04:39:22] [config]   - 1e
[2023-07-23 04:39:22] [config]   - 0
[2023-07-23 04:39:22] [config] lr-decay: 0
[2023-07-23 04:39:22] [config] lr-decay-freq: 50000
[2023-07-23 04:39:22] [config] lr-decay-inv-sqrt:
[2023-07-23 04:39:22] [config]   - 0
[2023-07-23 04:39:22] [config] lr-decay-repeat-warmup: false
[2023-07-23 04:39:22] [config] lr-decay-reset-optimizer: false
[2023-07-23 04:39:22] [config] lr-decay-start:
[2023-07-23 04:39:22] [config]   - 10
[2023-07-23 04:39:22] [config]   - 1
[2023-07-23 04:39:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 04:39:22] [config] lr-report: false
[2023-07-23 04:39:22] [config] lr-warmup: 0
[2023-07-23 04:39:22] [config] lr-warmup-at-reload: false
[2023-07-23 04:39:22] [config] lr-warmup-cycle: false
[2023-07-23 04:39:22] [config] lr-warmup-start-rate: 0
[2023-07-23 04:39:22] [config] max-length: 200
[2023-07-23 04:39:22] [config] max-length-crop: true
[2023-07-23 04:39:22] [config] max-length-factor: 3
[2023-07-23 04:39:22] [config] maxi-batch: 100
[2023-07-23 04:39:22] [config] maxi-batch-sort: trg
[2023-07-23 04:39:22] [config] mini-batch: 64
[2023-07-23 04:39:22] [config] mini-batch-fit: true
[2023-07-23 04:39:22] [config] mini-batch-fit-step: 10
[2023-07-23 04:39:22] [config] mini-batch-round-up: true
[2023-07-23 04:39:22] [config] mini-batch-track-lr: false
[2023-07-23 04:39:22] [config] mini-batch-warmup: 0
[2023-07-23 04:39:22] [config] mini-batch-words: 0
[2023-07-23 04:39:22] [config] mini-batch-words-ref: 0
[2023-07-23 04:39:22] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 04:39:22] [config] multi-loss-type: sum
[2023-07-23 04:39:22] [config] n-best: false
[2023-07-23 04:39:22] [config] no-nccl: false
[2023-07-23 04:39:22] [config] no-reload: false
[2023-07-23 04:39:22] [config] no-restore-corpus: false
[2023-07-23 04:39:22] [config] normalize: 0
[2023-07-23 04:39:22] [config] normalize-gradient: false
[2023-07-23 04:39:22] [config] num-devices: 0
[2023-07-23 04:39:22] [config] optimizer: adam
[2023-07-23 04:39:22] [config] optimizer-delay: 1
[2023-07-23 04:39:22] [config] optimizer-params:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] output-omit-bias: false
[2023-07-23 04:39:22] [config] overwrite: true
[2023-07-23 04:39:22] [config] precision:
[2023-07-23 04:39:22] [config]   - float16
[2023-07-23 04:39:22] [config]   - float32
[2023-07-23 04:39:22] [config] pretrained-model: ""
[2023-07-23 04:39:22] [config] quantize-biases: false
[2023-07-23 04:39:22] [config] quantize-bits: 0
[2023-07-23 04:39:22] [config] quantize-log-based: false
[2023-07-23 04:39:22] [config] quantize-optimization-steps: 0
[2023-07-23 04:39:22] [config] quiet: false
[2023-07-23 04:39:22] [config] quiet-translation: true
[2023-07-23 04:39:22] [config] relative-paths: false
[2023-07-23 04:39:22] [config] right-left: false
[2023-07-23 04:39:22] [config] save-freq: 10000u
[2023-07-23 04:39:22] [config] seed: 1234
[2023-07-23 04:39:22] [config] sentencepiece-alphas:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] sentencepiece-max-lines: 2000000
[2023-07-23 04:39:22] [config] sentencepiece-options: ""
[2023-07-23 04:39:22] [config] sharding: global
[2023-07-23 04:39:22] [config] shuffle: data
[2023-07-23 04:39:22] [config] shuffle-in-ram: false
[2023-07-23 04:39:22] [config] sigterm: save-and-exit
[2023-07-23 04:39:22] [config] skip: false
[2023-07-23 04:39:22] [config] sqlite: ""
[2023-07-23 04:39:22] [config] sqlite-drop: false
[2023-07-23 04:39:22] [config] sync-freq: 200u
[2023-07-23 04:39:22] [config] sync-sgd: false
[2023-07-23 04:39:22] [config] tempdir: /tmp
[2023-07-23 04:39:22] [config] tied-embeddings: false
[2023-07-23 04:39:22] [config] tied-embeddings-all: true
[2023-07-23 04:39:22] [config] tied-embeddings-src: false
[2023-07-23 04:39:22] [config] train-embedder-rank:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] train-sets:
[2023-07-23 04:39:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 04:39:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 04:39:22] [config] transformer-aan-activation: swish
[2023-07-23 04:39:22] [config] transformer-aan-depth: 2
[2023-07-23 04:39:22] [config] transformer-aan-nogate: false
[2023-07-23 04:39:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 04:39:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 04:39:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 04:39:22] [config] transformer-depth-scaling: false
[2023-07-23 04:39:22] [config] transformer-dim-aan: 2048
[2023-07-23 04:39:22] [config] transformer-dim-ffn: 2048
[2023-07-23 04:39:22] [config] transformer-dropout: 0
[2023-07-23 04:39:22] [config] transformer-dropout-attention: 0
[2023-07-23 04:39:22] [config] transformer-dropout-ffn: 0
[2023-07-23 04:39:22] [config] transformer-ffn-activation: swish
[2023-07-23 04:39:22] [config] transformer-ffn-depth: 2
[2023-07-23 04:39:22] [config] transformer-guided-alignment-layer: last
[2023-07-23 04:39:22] [config] transformer-heads: 8
[2023-07-23 04:39:22] [config] transformer-no-projection: false
[2023-07-23 04:39:22] [config] transformer-pool: false
[2023-07-23 04:39:22] [config] transformer-postprocess: dan
[2023-07-23 04:39:22] [config] transformer-postprocess-emb: d
[2023-07-23 04:39:22] [config] transformer-postprocess-top: ""
[2023-07-23 04:39:22] [config] transformer-preprocess: ""
[2023-07-23 04:39:22] [config] transformer-tied-layers:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] transformer-train-position-embeddings: false
[2023-07-23 04:39:22] [config] tsv: false
[2023-07-23 04:39:22] [config] tsv-fields: 0
[2023-07-23 04:39:22] [config] type: amun
[2023-07-23 04:39:22] [config] ulr: false
[2023-07-23 04:39:22] [config] ulr-dim-emb: 0
[2023-07-23 04:39:22] [config] ulr-dropout: 0
[2023-07-23 04:39:22] [config] ulr-keys-vectors: ""
[2023-07-23 04:39:22] [config] ulr-query-vectors: ""
[2023-07-23 04:39:22] [config] ulr-softmax-temperature: 1
[2023-07-23 04:39:22] [config] ulr-trainable-transformation: false
[2023-07-23 04:39:22] [config] unlikelihood-loss: false
[2023-07-23 04:39:22] [config] valid-freq: 50000000
[2023-07-23 04:39:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 04:39:22] [config] valid-max-length: 1000
[2023-07-23 04:39:22] [config] valid-metrics:
[2023-07-23 04:39:22] [config]   - cross-entropy
[2023-07-23 04:39:22] [config]   - translation
[2023-07-23 04:39:22] [config] valid-mini-batch: 32
[2023-07-23 04:39:22] [config] valid-reset-stalled: false
[2023-07-23 04:39:22] [config] valid-script-args:
[2023-07-23 04:39:22] [config]   []
[2023-07-23 04:39:22] [config] valid-script-path: ""
[2023-07-23 04:39:22] [config] valid-sets:
[2023-07-23 04:39:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 04:39:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 04:39:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 04:39:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 04:39:22] [config] vocabs:
[2023-07-23 04:39:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 04:39:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 04:39:22] [config] word-penalty: 0
[2023-07-23 04:39:22] [config] word-scores: false
[2023-07-23 04:39:22] [config] workspace: 5500
[2023-07-23 04:39:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 04:39:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 04:39:22] [training] Using single-device training
[2023-07-23 04:39:22] Synced seed 1234
[2023-07-23 04:39:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 04:39:23] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 04:39:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 04:39:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 04:39:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 04:39:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 04:39:23] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 04:39:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 04:39:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 04:39:24] [comm] Using global sharding
[2023-07-23 04:39:24] [comm] NCCLCommunicators constructed successfully
[2023-07-23 04:39:24] [training] Using 1 GPUs
[2023-07-23 04:39:24] [logits] Applying loss function for 1 factor(s)
[2023-07-23 04:39:24] [memory] Reserving 80 MB, device gpu0
[2023-07-23 04:39:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 04:39:24] [memory] Reserving 80 MB, device gpu0
[2023-07-23 05:16:20] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 05:16:20] [valid] No post-processing script given for validating translator
[2023-07-23 05:16:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 05:16:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 05:16:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 05:16:20] [comm] Using global sharding
[2023-07-23 05:16:20] [comm] NCCLCommunicators constructed successfully
[2023-07-23 05:16:20] [training] Using 1 GPUs
[2023-07-23 05:16:21] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 05:16:29] Allocating memory for general optimizer shards
[2023-07-23 05:16:29] [memory] Reserving 322 MB, device gpu0
[2023-07-23 05:16:29] Loading Adam parameters
[2023-07-23 05:16:29] [memory] Reserving 322 MB, device gpu0
[2023-07-23 05:16:29] [memory] Reserving 80 MB, device gpu0
[2023-07-23 05:16:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 05:16:29] [data] Restoring the corpus state to epoch 71, batch 3102
[2023-07-23 05:16:29] [data] Shuffling data
[2023-07-23 05:16:29] [data] Done reading 20,192 sentences
[2023-07-23 05:16:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:16:30] Training started
[2023-07-23 05:16:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 05:16:30] [memory] Reserving 80 MB, device gpu0
[2023-07-23 05:16:31] Parameter type float16, optimization type float32, casting types true
[2023-07-23 05:20:58] Seen 20,192 samples
[2023-07-23 05:20:58] Starting data epoch 72 in logical epoch 72
[2023-07-23 05:20:58] [data] Shuffling data
[2023-07-23 05:20:58] [data] Done reading 20,192 sentences
[2023-07-23 05:20:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:25:43] Seen 20,192 samples
[2023-07-23 05:25:43] Starting data epoch 73 in logical epoch 73
[2023-07-23 05:25:43] [data] Shuffling data
[2023-07-23 05:25:43] [data] Done reading 20,192 sentences
[2023-07-23 05:25:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:30:42] Seen 20,192 samples
[2023-07-23 05:30:42] Starting data epoch 74 in logical epoch 74
[2023-07-23 05:30:42] [data] Shuffling data
[2023-07-23 05:30:42] [data] Done reading 20,192 sentences
[2023-07-23 05:30:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:35:34] Seen 20,192 samples
[2023-07-23 05:35:34] Starting data epoch 75 in logical epoch 75
[2023-07-23 05:35:34] [data] Shuffling data
[2023-07-23 05:35:34] [data] Done reading 20,192 sentences
[2023-07-23 05:35:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:40:32] Seen 20,192 samples
[2023-07-23 05:40:32] Starting data epoch 76 in logical epoch 76
[2023-07-23 05:40:32] [data] Shuffling data
[2023-07-23 05:40:32] [data] Done reading 20,192 sentences
[2023-07-23 05:40:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:45:33] Seen 20,192 samples
[2023-07-23 05:45:33] Starting data epoch 77 in logical epoch 77
[2023-07-23 05:45:33] [data] Shuffling data
[2023-07-23 05:45:33] [data] Done reading 20,192 sentences
[2023-07-23 05:45:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:50:25] Seen 20,192 samples
[2023-07-23 05:50:25] Starting data epoch 78 in logical epoch 78
[2023-07-23 05:50:25] [data] Shuffling data
[2023-07-23 05:50:25] [data] Done reading 20,192 sentences
[2023-07-23 05:50:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 05:55:29] Seen 20,192 samples
[2023-07-23 05:55:29] Starting data epoch 79 in logical epoch 79
[2023-07-23 05:55:29] [data] Shuffling data
[2023-07-23 05:55:29] [data] Done reading 20,192 sentences
[2023-07-23 05:55:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 06:00:17] Seen 20,192 samples
[2023-07-23 06:00:17] Starting data epoch 80 in logical epoch 80
[2023-07-23 06:00:17] [data] Shuffling data
[2023-07-23 06:00:17] [data] Done reading 20,192 sentences
[2023-07-23 06:00:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 06:05:09] Seen 20,192 samples
[2023-07-23 06:05:09] Starting data epoch 81 in logical epoch 81
[2023-07-23 06:05:09] Training finished
[2023-07-23 06:05:23] [valid] Ep. 81 : Up. 3546 : cross-entropy : 132.782 : new best
[2023-07-23 06:08:10] [valid] Ep. 81 : Up. 3546 : translation : 0 : new best
[2023-07-23 06:08:10] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 06:08:14] Saving Adam parameters
[2023-07-23 06:08:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 06:08:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 06:08:23] [marian] Running on node22.datos.cluster.uy as process 30289 with command line:
[2023-07-23 06:08:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 06:08:23] [config] after: 0e
[2023-07-23 06:08:23] [config] after-batches: 0
[2023-07-23 06:08:23] [config] after-epochs: 90
[2023-07-23 06:08:23] [config] all-caps-every: 0
[2023-07-23 06:08:23] [config] allow-unk: false
[2023-07-23 06:08:23] [config] authors: false
[2023-07-23 06:08:23] [config] beam-size: 12
[2023-07-23 06:08:23] [config] bert-class-symbol: "[CLS]"
[2023-07-23 06:08:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 06:08:23] [config] bert-masking-fraction: 0.15
[2023-07-23 06:08:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 06:08:23] [config] bert-train-type-embeddings: true
[2023-07-23 06:08:23] [config] bert-type-vocab-size: 2
[2023-07-23 06:08:23] [config] build-info: ""
[2023-07-23 06:08:23] [config] check-gradient-nan: false
[2023-07-23 06:08:23] [config] check-nan: false
[2023-07-23 06:08:23] [config] cite: false
[2023-07-23 06:08:23] [config] clip-norm: 1
[2023-07-23 06:08:23] [config] cost-scaling:
[2023-07-23 06:08:23] [config]   - 256.f
[2023-07-23 06:08:23] [config]   - 1000
[2023-07-23 06:08:23] [config]   - 2.f
[2023-07-23 06:08:23] [config]   - 256.f
[2023-07-23 06:08:23] [config] cost-type: ce-sum
[2023-07-23 06:08:23] [config] cpu-threads: 0
[2023-07-23 06:08:23] [config] data-threads: 8
[2023-07-23 06:08:23] [config] data-weighting: ""
[2023-07-23 06:08:23] [config] data-weighting-type: sentence
[2023-07-23 06:08:23] [config] dec-cell: gru
[2023-07-23 06:08:23] [config] dec-cell-base-depth: 2
[2023-07-23 06:08:23] [config] dec-cell-high-depth: 1
[2023-07-23 06:08:23] [config] dec-depth: 1
[2023-07-23 06:08:23] [config] devices:
[2023-07-23 06:08:23] [config]   - 0
[2023-07-23 06:08:23] [config] dim-emb: 512
[2023-07-23 06:08:23] [config] dim-rnn: 1024
[2023-07-23 06:08:23] [config] dim-vocabs:
[2023-07-23 06:08:23] [config]   - 16384
[2023-07-23 06:08:23] [config]   - 16384
[2023-07-23 06:08:23] [config] disp-first: 0
[2023-07-23 06:08:23] [config] disp-freq: 1000u
[2023-07-23 06:08:23] [config] disp-label-counts: true
[2023-07-23 06:08:23] [config] dropout-rnn: 0
[2023-07-23 06:08:23] [config] dropout-src: 0
[2023-07-23 06:08:23] [config] dropout-trg: 0
[2023-07-23 06:08:23] [config] dump-config: ""
[2023-07-23 06:08:23] [config] dynamic-gradient-scaling:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] early-stopping: 200
[2023-07-23 06:08:23] [config] early-stopping-on: first
[2023-07-23 06:08:23] [config] embedding-fix-src: false
[2023-07-23 06:08:23] [config] embedding-fix-trg: false
[2023-07-23 06:08:23] [config] embedding-normalization: false
[2023-07-23 06:08:23] [config] embedding-vectors:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] enc-cell: gru
[2023-07-23 06:08:23] [config] enc-cell-depth: 1
[2023-07-23 06:08:23] [config] enc-depth: 1
[2023-07-23 06:08:23] [config] enc-type: bidirectional
[2023-07-23 06:08:23] [config] english-title-case-every: 0
[2023-07-23 06:08:23] [config] exponential-smoothing: 0
[2023-07-23 06:08:23] [config] factor-weight: 1
[2023-07-23 06:08:23] [config] factors-combine: sum
[2023-07-23 06:08:23] [config] factors-dim-emb: 0
[2023-07-23 06:08:23] [config] gradient-checkpointing: false
[2023-07-23 06:08:23] [config] gradient-norm-average-window: 100
[2023-07-23 06:08:23] [config] guided-alignment: none
[2023-07-23 06:08:23] [config] guided-alignment-cost: mse
[2023-07-23 06:08:23] [config] guided-alignment-weight: 0.1
[2023-07-23 06:08:23] [config] ignore-model-config: false
[2023-07-23 06:08:23] [config] input-types:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] interpolate-env-vars: false
[2023-07-23 06:08:23] [config] keep-best: false
[2023-07-23 06:08:23] [config] label-smoothing: 0
[2023-07-23 06:08:23] [config] layer-normalization: false
[2023-07-23 06:08:23] [config] learn-rate: 0.0001
[2023-07-23 06:08:23] [config] lemma-dependency: ""
[2023-07-23 06:08:23] [config] lemma-dim-emb: 0
[2023-07-23 06:08:23] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 06:08:23] [config] log-level: info
[2023-07-23 06:08:23] [config] log-time-zone: ""
[2023-07-23 06:08:23] [config] logical-epoch:
[2023-07-23 06:08:23] [config]   - 1e
[2023-07-23 06:08:23] [config]   - 0
[2023-07-23 06:08:23] [config] lr-decay: 0
[2023-07-23 06:08:23] [config] lr-decay-freq: 50000
[2023-07-23 06:08:23] [config] lr-decay-inv-sqrt:
[2023-07-23 06:08:23] [config]   - 0
[2023-07-23 06:08:23] [config] lr-decay-repeat-warmup: false
[2023-07-23 06:08:23] [config] lr-decay-reset-optimizer: false
[2023-07-23 06:08:23] [config] lr-decay-start:
[2023-07-23 06:08:23] [config]   - 10
[2023-07-23 06:08:23] [config]   - 1
[2023-07-23 06:08:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 06:08:23] [config] lr-report: false
[2023-07-23 06:08:23] [config] lr-warmup: 0
[2023-07-23 06:08:23] [config] lr-warmup-at-reload: false
[2023-07-23 06:08:23] [config] lr-warmup-cycle: false
[2023-07-23 06:08:23] [config] lr-warmup-start-rate: 0
[2023-07-23 06:08:23] [config] max-length: 200
[2023-07-23 06:08:23] [config] max-length-crop: true
[2023-07-23 06:08:23] [config] max-length-factor: 3
[2023-07-23 06:08:23] [config] maxi-batch: 100
[2023-07-23 06:08:23] [config] maxi-batch-sort: trg
[2023-07-23 06:08:23] [config] mini-batch: 64
[2023-07-23 06:08:23] [config] mini-batch-fit: true
[2023-07-23 06:08:23] [config] mini-batch-fit-step: 10
[2023-07-23 06:08:23] [config] mini-batch-round-up: true
[2023-07-23 06:08:23] [config] mini-batch-track-lr: false
[2023-07-23 06:08:23] [config] mini-batch-warmup: 0
[2023-07-23 06:08:23] [config] mini-batch-words: 0
[2023-07-23 06:08:23] [config] mini-batch-words-ref: 0
[2023-07-23 06:08:23] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 06:08:23] [config] multi-loss-type: sum
[2023-07-23 06:08:23] [config] n-best: false
[2023-07-23 06:08:23] [config] no-nccl: false
[2023-07-23 06:08:23] [config] no-reload: false
[2023-07-23 06:08:23] [config] no-restore-corpus: false
[2023-07-23 06:08:23] [config] normalize: 0
[2023-07-23 06:08:23] [config] normalize-gradient: false
[2023-07-23 06:08:23] [config] num-devices: 0
[2023-07-23 06:08:23] [config] optimizer: adam
[2023-07-23 06:08:23] [config] optimizer-delay: 1
[2023-07-23 06:08:23] [config] optimizer-params:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] output-omit-bias: false
[2023-07-23 06:08:23] [config] overwrite: true
[2023-07-23 06:08:23] [config] precision:
[2023-07-23 06:08:23] [config]   - float16
[2023-07-23 06:08:23] [config]   - float32
[2023-07-23 06:08:23] [config] pretrained-model: ""
[2023-07-23 06:08:23] [config] quantize-biases: false
[2023-07-23 06:08:23] [config] quantize-bits: 0
[2023-07-23 06:08:23] [config] quantize-log-based: false
[2023-07-23 06:08:23] [config] quantize-optimization-steps: 0
[2023-07-23 06:08:23] [config] quiet: false
[2023-07-23 06:08:23] [config] quiet-translation: true
[2023-07-23 06:08:23] [config] relative-paths: false
[2023-07-23 06:08:23] [config] right-left: false
[2023-07-23 06:08:23] [config] save-freq: 10000u
[2023-07-23 06:08:23] [config] seed: 1234
[2023-07-23 06:08:23] [config] sentencepiece-alphas:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] sentencepiece-max-lines: 2000000
[2023-07-23 06:08:23] [config] sentencepiece-options: ""
[2023-07-23 06:08:23] [config] sharding: global
[2023-07-23 06:08:23] [config] shuffle: data
[2023-07-23 06:08:23] [config] shuffle-in-ram: false
[2023-07-23 06:08:23] [config] sigterm: save-and-exit
[2023-07-23 06:08:23] [config] skip: false
[2023-07-23 06:08:23] [config] sqlite: ""
[2023-07-23 06:08:23] [config] sqlite-drop: false
[2023-07-23 06:08:23] [config] sync-freq: 200u
[2023-07-23 06:08:23] [config] sync-sgd: false
[2023-07-23 06:08:23] [config] tempdir: /tmp
[2023-07-23 06:08:23] [config] tied-embeddings: false
[2023-07-23 06:08:23] [config] tied-embeddings-all: true
[2023-07-23 06:08:23] [config] tied-embeddings-src: false
[2023-07-23 06:08:23] [config] train-embedder-rank:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] train-sets:
[2023-07-23 06:08:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 06:08:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 06:08:23] [config] transformer-aan-activation: swish
[2023-07-23 06:08:23] [config] transformer-aan-depth: 2
[2023-07-23 06:08:23] [config] transformer-aan-nogate: false
[2023-07-23 06:08:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 06:08:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 06:08:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 06:08:23] [config] transformer-depth-scaling: false
[2023-07-23 06:08:23] [config] transformer-dim-aan: 2048
[2023-07-23 06:08:23] [config] transformer-dim-ffn: 2048
[2023-07-23 06:08:23] [config] transformer-dropout: 0
[2023-07-23 06:08:23] [config] transformer-dropout-attention: 0
[2023-07-23 06:08:23] [config] transformer-dropout-ffn: 0
[2023-07-23 06:08:23] [config] transformer-ffn-activation: swish
[2023-07-23 06:08:23] [config] transformer-ffn-depth: 2
[2023-07-23 06:08:23] [config] transformer-guided-alignment-layer: last
[2023-07-23 06:08:23] [config] transformer-heads: 8
[2023-07-23 06:08:23] [config] transformer-no-projection: false
[2023-07-23 06:08:23] [config] transformer-pool: false
[2023-07-23 06:08:23] [config] transformer-postprocess: dan
[2023-07-23 06:08:23] [config] transformer-postprocess-emb: d
[2023-07-23 06:08:23] [config] transformer-postprocess-top: ""
[2023-07-23 06:08:23] [config] transformer-preprocess: ""
[2023-07-23 06:08:23] [config] transformer-tied-layers:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] transformer-train-position-embeddings: false
[2023-07-23 06:08:23] [config] tsv: false
[2023-07-23 06:08:23] [config] tsv-fields: 0
[2023-07-23 06:08:23] [config] type: amun
[2023-07-23 06:08:23] [config] ulr: false
[2023-07-23 06:08:23] [config] ulr-dim-emb: 0
[2023-07-23 06:08:23] [config] ulr-dropout: 0
[2023-07-23 06:08:23] [config] ulr-keys-vectors: ""
[2023-07-23 06:08:23] [config] ulr-query-vectors: ""
[2023-07-23 06:08:23] [config] ulr-softmax-temperature: 1
[2023-07-23 06:08:23] [config] ulr-trainable-transformation: false
[2023-07-23 06:08:23] [config] unlikelihood-loss: false
[2023-07-23 06:08:23] [config] valid-freq: 50000000
[2023-07-23 06:08:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 06:08:23] [config] valid-max-length: 1000
[2023-07-23 06:08:23] [config] valid-metrics:
[2023-07-23 06:08:23] [config]   - cross-entropy
[2023-07-23 06:08:23] [config]   - translation
[2023-07-23 06:08:23] [config] valid-mini-batch: 32
[2023-07-23 06:08:23] [config] valid-reset-stalled: false
[2023-07-23 06:08:23] [config] valid-script-args:
[2023-07-23 06:08:23] [config]   []
[2023-07-23 06:08:23] [config] valid-script-path: ""
[2023-07-23 06:08:23] [config] valid-sets:
[2023-07-23 06:08:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 06:08:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 06:08:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 06:08:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 06:08:23] [config] vocabs:
[2023-07-23 06:08:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 06:08:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 06:08:23] [config] word-penalty: 0
[2023-07-23 06:08:23] [config] word-scores: false
[2023-07-23 06:08:23] [config] workspace: 5500
[2023-07-23 06:08:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 06:08:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 06:08:23] [training] Using single-device training
[2023-07-23 06:08:24] Synced seed 1234
[2023-07-23 06:08:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 06:08:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 06:08:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 06:08:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 06:08:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 06:08:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 06:08:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 06:08:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 06:08:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 06:08:26] [comm] Using global sharding
[2023-07-23 06:08:26] [comm] NCCLCommunicators constructed successfully
[2023-07-23 06:08:26] [training] Using 1 GPUs
[2023-07-23 06:08:26] [logits] Applying loss function for 1 factor(s)
[2023-07-23 06:08:26] [memory] Reserving 80 MB, device gpu0
[2023-07-23 06:08:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 06:08:26] [memory] Reserving 80 MB, device gpu0
[2023-07-23 06:45:02] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 06:45:02] [valid] No post-processing script given for validating translator
[2023-07-23 06:45:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 06:45:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 06:45:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 06:45:02] [comm] Using global sharding
[2023-07-23 06:45:02] [comm] NCCLCommunicators constructed successfully
[2023-07-23 06:45:02] [training] Using 1 GPUs
[2023-07-23 06:45:02] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 06:45:10] Allocating memory for general optimizer shards
[2023-07-23 06:45:10] [memory] Reserving 322 MB, device gpu0
[2023-07-23 06:45:10] Loading Adam parameters
[2023-07-23 06:45:10] [memory] Reserving 322 MB, device gpu0
[2023-07-23 06:45:10] [memory] Reserving 80 MB, device gpu0
[2023-07-23 06:45:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 06:45:10] [data] Restoring the corpus state to epoch 81, batch 3546
[2023-07-23 06:45:10] [data] Shuffling data
[2023-07-23 06:45:11] [data] Done reading 20,192 sentences
[2023-07-23 06:45:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 06:45:11] Training started
[2023-07-23 06:45:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 06:45:11] [memory] Reserving 80 MB, device gpu0
[2023-07-23 06:45:13] Parameter type float16, optimization type float32, casting types true
[2023-07-23 06:50:01] Seen 20,192 samples
[2023-07-23 06:50:01] Starting data epoch 82 in logical epoch 82
[2023-07-23 06:50:01] [data] Shuffling data
[2023-07-23 06:50:01] [data] Done reading 20,192 sentences
[2023-07-23 06:50:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 06:55:01] Seen 20,192 samples
[2023-07-23 06:55:01] Starting data epoch 83 in logical epoch 83
[2023-07-23 06:55:01] [data] Shuffling data
[2023-07-23 06:55:01] [data] Done reading 20,192 sentences
[2023-07-23 06:55:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 06:59:55] Seen 20,192 samples
[2023-07-23 06:59:55] Starting data epoch 84 in logical epoch 84
[2023-07-23 06:59:55] [data] Shuffling data
[2023-07-23 06:59:55] [data] Done reading 20,192 sentences
[2023-07-23 06:59:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 07:04:50] Seen 20,192 samples
[2023-07-23 07:04:50] Starting data epoch 85 in logical epoch 85
[2023-07-23 07:04:50] [data] Shuffling data
[2023-07-23 07:04:50] [data] Done reading 20,192 sentences
[2023-07-23 07:04:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 07:09:46] Seen 20,192 samples
[2023-07-23 07:09:46] Starting data epoch 86 in logical epoch 86
[2023-07-23 07:09:46] [data] Shuffling data
[2023-07-23 07:09:46] [data] Done reading 20,192 sentences
[2023-07-23 07:09:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 07:14:37] Seen 20,192 samples
[2023-07-23 07:14:37] Starting data epoch 87 in logical epoch 87
[2023-07-23 07:14:37] [data] Shuffling data
[2023-07-23 07:14:37] [data] Done reading 20,192 sentences
[2023-07-23 07:14:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 07:19:27] Seen 20,192 samples
[2023-07-23 07:19:27] Starting data epoch 88 in logical epoch 88
[2023-07-23 07:19:27] [data] Shuffling data
[2023-07-23 07:19:27] [data] Done reading 20,192 sentences
[2023-07-23 07:19:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 07:24:27] Seen 20,192 samples
[2023-07-23 07:24:27] Starting data epoch 89 in logical epoch 89
[2023-07-23 07:24:27] [data] Shuffling data
[2023-07-23 07:24:27] [data] Done reading 20,192 sentences
[2023-07-23 07:24:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 07:29:20] Seen 20,192 samples
[2023-07-23 07:29:20] Starting data epoch 90 in logical epoch 90
[2023-07-23 07:29:20] [data] Shuffling data
[2023-07-23 07:29:20] [data] Done reading 20,192 sentences
[2023-07-23 07:29:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 07:34:07] Seen 20,192 samples
[2023-07-23 07:34:07] Starting data epoch 91 in logical epoch 91
[2023-07-23 07:34:07] Training finished
[2023-07-23 07:34:18] [valid] Ep. 91 : Up. 3989 : cross-entropy : 131.545 : new best
[2023-07-23 07:37:37] [valid] Ep. 91 : Up. 3989 : translation : 0 : new best
[2023-07-23 07:37:37] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 07:37:39] Saving Adam parameters
[2023-07-23 07:37:40] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 07:37:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 07:37:47] [marian] Running on node22.datos.cluster.uy as process 35976 with command line:
[2023-07-23 07:37:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 07:37:47] [config] after: 0e
[2023-07-23 07:37:47] [config] after-batches: 0
[2023-07-23 07:37:47] [config] after-epochs: 100
[2023-07-23 07:37:47] [config] all-caps-every: 0
[2023-07-23 07:37:47] [config] allow-unk: false
[2023-07-23 07:37:47] [config] authors: false
[2023-07-23 07:37:47] [config] beam-size: 12
[2023-07-23 07:37:47] [config] bert-class-symbol: "[CLS]"
[2023-07-23 07:37:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 07:37:47] [config] bert-masking-fraction: 0.15
[2023-07-23 07:37:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 07:37:47] [config] bert-train-type-embeddings: true
[2023-07-23 07:37:47] [config] bert-type-vocab-size: 2
[2023-07-23 07:37:47] [config] build-info: ""
[2023-07-23 07:37:47] [config] check-gradient-nan: false
[2023-07-23 07:37:47] [config] check-nan: false
[2023-07-23 07:37:47] [config] cite: false
[2023-07-23 07:37:47] [config] clip-norm: 1
[2023-07-23 07:37:47] [config] cost-scaling:
[2023-07-23 07:37:47] [config]   - 256.f
[2023-07-23 07:37:47] [config]   - 1000
[2023-07-23 07:37:47] [config]   - 2.f
[2023-07-23 07:37:47] [config]   - 256.f
[2023-07-23 07:37:47] [config] cost-type: ce-sum
[2023-07-23 07:37:47] [config] cpu-threads: 0
[2023-07-23 07:37:47] [config] data-threads: 8
[2023-07-23 07:37:47] [config] data-weighting: ""
[2023-07-23 07:37:47] [config] data-weighting-type: sentence
[2023-07-23 07:37:47] [config] dec-cell: gru
[2023-07-23 07:37:47] [config] dec-cell-base-depth: 2
[2023-07-23 07:37:47] [config] dec-cell-high-depth: 1
[2023-07-23 07:37:47] [config] dec-depth: 1
[2023-07-23 07:37:47] [config] devices:
[2023-07-23 07:37:47] [config]   - 0
[2023-07-23 07:37:47] [config] dim-emb: 512
[2023-07-23 07:37:47] [config] dim-rnn: 1024
[2023-07-23 07:37:47] [config] dim-vocabs:
[2023-07-23 07:37:47] [config]   - 16384
[2023-07-23 07:37:47] [config]   - 16384
[2023-07-23 07:37:47] [config] disp-first: 0
[2023-07-23 07:37:47] [config] disp-freq: 1000u
[2023-07-23 07:37:47] [config] disp-label-counts: true
[2023-07-23 07:37:47] [config] dropout-rnn: 0
[2023-07-23 07:37:47] [config] dropout-src: 0
[2023-07-23 07:37:47] [config] dropout-trg: 0
[2023-07-23 07:37:47] [config] dump-config: ""
[2023-07-23 07:37:47] [config] dynamic-gradient-scaling:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] early-stopping: 200
[2023-07-23 07:37:47] [config] early-stopping-on: first
[2023-07-23 07:37:47] [config] embedding-fix-src: false
[2023-07-23 07:37:47] [config] embedding-fix-trg: false
[2023-07-23 07:37:47] [config] embedding-normalization: false
[2023-07-23 07:37:47] [config] embedding-vectors:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] enc-cell: gru
[2023-07-23 07:37:47] [config] enc-cell-depth: 1
[2023-07-23 07:37:47] [config] enc-depth: 1
[2023-07-23 07:37:47] [config] enc-type: bidirectional
[2023-07-23 07:37:47] [config] english-title-case-every: 0
[2023-07-23 07:37:47] [config] exponential-smoothing: 0
[2023-07-23 07:37:47] [config] factor-weight: 1
[2023-07-23 07:37:47] [config] factors-combine: sum
[2023-07-23 07:37:47] [config] factors-dim-emb: 0
[2023-07-23 07:37:47] [config] gradient-checkpointing: false
[2023-07-23 07:37:47] [config] gradient-norm-average-window: 100
[2023-07-23 07:37:47] [config] guided-alignment: none
[2023-07-23 07:37:47] [config] guided-alignment-cost: mse
[2023-07-23 07:37:47] [config] guided-alignment-weight: 0.1
[2023-07-23 07:37:47] [config] ignore-model-config: false
[2023-07-23 07:37:47] [config] input-types:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] interpolate-env-vars: false
[2023-07-23 07:37:47] [config] keep-best: false
[2023-07-23 07:37:47] [config] label-smoothing: 0
[2023-07-23 07:37:47] [config] layer-normalization: false
[2023-07-23 07:37:47] [config] learn-rate: 0.0001
[2023-07-23 07:37:47] [config] lemma-dependency: ""
[2023-07-23 07:37:47] [config] lemma-dim-emb: 0
[2023-07-23 07:37:47] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 07:37:47] [config] log-level: info
[2023-07-23 07:37:47] [config] log-time-zone: ""
[2023-07-23 07:37:47] [config] logical-epoch:
[2023-07-23 07:37:47] [config]   - 1e
[2023-07-23 07:37:47] [config]   - 0
[2023-07-23 07:37:47] [config] lr-decay: 0
[2023-07-23 07:37:47] [config] lr-decay-freq: 50000
[2023-07-23 07:37:47] [config] lr-decay-inv-sqrt:
[2023-07-23 07:37:47] [config]   - 0
[2023-07-23 07:37:47] [config] lr-decay-repeat-warmup: false
[2023-07-23 07:37:47] [config] lr-decay-reset-optimizer: false
[2023-07-23 07:37:47] [config] lr-decay-start:
[2023-07-23 07:37:47] [config]   - 10
[2023-07-23 07:37:47] [config]   - 1
[2023-07-23 07:37:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 07:37:47] [config] lr-report: false
[2023-07-23 07:37:47] [config] lr-warmup: 0
[2023-07-23 07:37:47] [config] lr-warmup-at-reload: false
[2023-07-23 07:37:47] [config] lr-warmup-cycle: false
[2023-07-23 07:37:47] [config] lr-warmup-start-rate: 0
[2023-07-23 07:37:47] [config] max-length: 200
[2023-07-23 07:37:47] [config] max-length-crop: true
[2023-07-23 07:37:47] [config] max-length-factor: 3
[2023-07-23 07:37:47] [config] maxi-batch: 100
[2023-07-23 07:37:47] [config] maxi-batch-sort: trg
[2023-07-23 07:37:47] [config] mini-batch: 64
[2023-07-23 07:37:47] [config] mini-batch-fit: true
[2023-07-23 07:37:47] [config] mini-batch-fit-step: 10
[2023-07-23 07:37:47] [config] mini-batch-round-up: true
[2023-07-23 07:37:47] [config] mini-batch-track-lr: false
[2023-07-23 07:37:47] [config] mini-batch-warmup: 0
[2023-07-23 07:37:47] [config] mini-batch-words: 0
[2023-07-23 07:37:47] [config] mini-batch-words-ref: 0
[2023-07-23 07:37:47] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 07:37:47] [config] multi-loss-type: sum
[2023-07-23 07:37:47] [config] n-best: false
[2023-07-23 07:37:47] [config] no-nccl: false
[2023-07-23 07:37:47] [config] no-reload: false
[2023-07-23 07:37:47] [config] no-restore-corpus: false
[2023-07-23 07:37:47] [config] normalize: 0
[2023-07-23 07:37:47] [config] normalize-gradient: false
[2023-07-23 07:37:47] [config] num-devices: 0
[2023-07-23 07:37:47] [config] optimizer: adam
[2023-07-23 07:37:47] [config] optimizer-delay: 1
[2023-07-23 07:37:47] [config] optimizer-params:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] output-omit-bias: false
[2023-07-23 07:37:47] [config] overwrite: true
[2023-07-23 07:37:47] [config] precision:
[2023-07-23 07:37:47] [config]   - float16
[2023-07-23 07:37:47] [config]   - float32
[2023-07-23 07:37:47] [config] pretrained-model: ""
[2023-07-23 07:37:47] [config] quantize-biases: false
[2023-07-23 07:37:47] [config] quantize-bits: 0
[2023-07-23 07:37:47] [config] quantize-log-based: false
[2023-07-23 07:37:47] [config] quantize-optimization-steps: 0
[2023-07-23 07:37:47] [config] quiet: false
[2023-07-23 07:37:47] [config] quiet-translation: true
[2023-07-23 07:37:47] [config] relative-paths: false
[2023-07-23 07:37:47] [config] right-left: false
[2023-07-23 07:37:47] [config] save-freq: 10000u
[2023-07-23 07:37:47] [config] seed: 1234
[2023-07-23 07:37:47] [config] sentencepiece-alphas:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] sentencepiece-max-lines: 2000000
[2023-07-23 07:37:47] [config] sentencepiece-options: ""
[2023-07-23 07:37:47] [config] sharding: global
[2023-07-23 07:37:47] [config] shuffle: data
[2023-07-23 07:37:47] [config] shuffle-in-ram: false
[2023-07-23 07:37:47] [config] sigterm: save-and-exit
[2023-07-23 07:37:47] [config] skip: false
[2023-07-23 07:37:47] [config] sqlite: ""
[2023-07-23 07:37:47] [config] sqlite-drop: false
[2023-07-23 07:37:47] [config] sync-freq: 200u
[2023-07-23 07:37:47] [config] sync-sgd: false
[2023-07-23 07:37:47] [config] tempdir: /tmp
[2023-07-23 07:37:47] [config] tied-embeddings: false
[2023-07-23 07:37:47] [config] tied-embeddings-all: true
[2023-07-23 07:37:47] [config] tied-embeddings-src: false
[2023-07-23 07:37:47] [config] train-embedder-rank:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] train-sets:
[2023-07-23 07:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 07:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 07:37:47] [config] transformer-aan-activation: swish
[2023-07-23 07:37:47] [config] transformer-aan-depth: 2
[2023-07-23 07:37:47] [config] transformer-aan-nogate: false
[2023-07-23 07:37:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 07:37:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 07:37:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 07:37:47] [config] transformer-depth-scaling: false
[2023-07-23 07:37:47] [config] transformer-dim-aan: 2048
[2023-07-23 07:37:47] [config] transformer-dim-ffn: 2048
[2023-07-23 07:37:47] [config] transformer-dropout: 0
[2023-07-23 07:37:47] [config] transformer-dropout-attention: 0
[2023-07-23 07:37:47] [config] transformer-dropout-ffn: 0
[2023-07-23 07:37:47] [config] transformer-ffn-activation: swish
[2023-07-23 07:37:47] [config] transformer-ffn-depth: 2
[2023-07-23 07:37:47] [config] transformer-guided-alignment-layer: last
[2023-07-23 07:37:47] [config] transformer-heads: 8
[2023-07-23 07:37:47] [config] transformer-no-projection: false
[2023-07-23 07:37:47] [config] transformer-pool: false
[2023-07-23 07:37:47] [config] transformer-postprocess: dan
[2023-07-23 07:37:47] [config] transformer-postprocess-emb: d
[2023-07-23 07:37:47] [config] transformer-postprocess-top: ""
[2023-07-23 07:37:47] [config] transformer-preprocess: ""
[2023-07-23 07:37:47] [config] transformer-tied-layers:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] transformer-train-position-embeddings: false
[2023-07-23 07:37:47] [config] tsv: false
[2023-07-23 07:37:47] [config] tsv-fields: 0
[2023-07-23 07:37:47] [config] type: amun
[2023-07-23 07:37:47] [config] ulr: false
[2023-07-23 07:37:47] [config] ulr-dim-emb: 0
[2023-07-23 07:37:47] [config] ulr-dropout: 0
[2023-07-23 07:37:47] [config] ulr-keys-vectors: ""
[2023-07-23 07:37:47] [config] ulr-query-vectors: ""
[2023-07-23 07:37:47] [config] ulr-softmax-temperature: 1
[2023-07-23 07:37:47] [config] ulr-trainable-transformation: false
[2023-07-23 07:37:47] [config] unlikelihood-loss: false
[2023-07-23 07:37:47] [config] valid-freq: 50000000
[2023-07-23 07:37:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 07:37:47] [config] valid-max-length: 1000
[2023-07-23 07:37:47] [config] valid-metrics:
[2023-07-23 07:37:47] [config]   - cross-entropy
[2023-07-23 07:37:47] [config]   - translation
[2023-07-23 07:37:47] [config] valid-mini-batch: 32
[2023-07-23 07:37:47] [config] valid-reset-stalled: false
[2023-07-23 07:37:47] [config] valid-script-args:
[2023-07-23 07:37:47] [config]   []
[2023-07-23 07:37:47] [config] valid-script-path: ""
[2023-07-23 07:37:47] [config] valid-sets:
[2023-07-23 07:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 07:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 07:37:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 07:37:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 07:37:47] [config] vocabs:
[2023-07-23 07:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 07:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 07:37:47] [config] word-penalty: 0
[2023-07-23 07:37:47] [config] word-scores: false
[2023-07-23 07:37:47] [config] workspace: 5500
[2023-07-23 07:37:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 07:37:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 07:37:47] [training] Using single-device training
[2023-07-23 07:37:48] Synced seed 1234
[2023-07-23 07:37:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 07:37:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 07:37:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 07:37:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 07:37:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 07:37:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 07:37:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 07:37:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 07:37:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 07:37:49] [comm] Using global sharding
[2023-07-23 07:37:49] [comm] NCCLCommunicators constructed successfully
[2023-07-23 07:37:49] [training] Using 1 GPUs
[2023-07-23 07:37:49] [logits] Applying loss function for 1 factor(s)
[2023-07-23 07:37:49] [memory] Reserving 80 MB, device gpu0
[2023-07-23 07:37:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 07:37:49] [memory] Reserving 80 MB, device gpu0
[2023-07-23 08:14:23] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 08:14:23] [valid] No post-processing script given for validating translator
[2023-07-23 08:14:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 08:14:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 08:14:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 08:14:23] [comm] Using global sharding
[2023-07-23 08:14:23] [comm] NCCLCommunicators constructed successfully
[2023-07-23 08:14:23] [training] Using 1 GPUs
[2023-07-23 08:14:23] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 08:14:28] Allocating memory for general optimizer shards
[2023-07-23 08:14:28] [memory] Reserving 322 MB, device gpu0
[2023-07-23 08:14:28] Loading Adam parameters
[2023-07-23 08:14:28] [memory] Reserving 322 MB, device gpu0
[2023-07-23 08:14:28] [memory] Reserving 80 MB, device gpu0
[2023-07-23 08:14:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 08:14:28] [data] Restoring the corpus state to epoch 91, batch 3989
[2023-07-23 08:14:28] [data] Shuffling data
[2023-07-23 08:14:28] [data] Done reading 20,192 sentences
[2023-07-23 08:14:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:14:28] Training started
[2023-07-23 08:14:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 08:14:29] [memory] Reserving 80 MB, device gpu0
[2023-07-23 08:14:36] Parameter type float16, optimization type float32, casting types true
[2023-07-23 08:15:39] Ep. 91 : Up. 4000 : Sen. 4,930 : Cost 4.34338379 * 12,284,139 @ 17,422 after 49,104,879 : Time 76.38s : 160833.49 words/s : gNorm 1.1476
[2023-07-23 08:19:17] Seen 20,192 samples
[2023-07-23 08:19:17] Starting data epoch 92 in logical epoch 92
[2023-07-23 08:19:17] [data] Shuffling data
[2023-07-23 08:19:17] [data] Done reading 20,192 sentences
[2023-07-23 08:19:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:24:07] Seen 20,192 samples
[2023-07-23 08:24:07] Starting data epoch 93 in logical epoch 93
[2023-07-23 08:24:07] [data] Shuffling data
[2023-07-23 08:24:07] [data] Done reading 20,192 sentences
[2023-07-23 08:24:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:28:56] Seen 20,192 samples
[2023-07-23 08:28:56] Starting data epoch 94 in logical epoch 94
[2023-07-23 08:28:56] [data] Shuffling data
[2023-07-23 08:28:56] [data] Done reading 20,192 sentences
[2023-07-23 08:28:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:33:47] Seen 20,192 samples
[2023-07-23 08:33:47] Starting data epoch 95 in logical epoch 95
[2023-07-23 08:33:47] [data] Shuffling data
[2023-07-23 08:33:47] [data] Done reading 20,192 sentences
[2023-07-23 08:33:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:38:37] Seen 20,192 samples
[2023-07-23 08:38:37] Starting data epoch 96 in logical epoch 96
[2023-07-23 08:38:37] [data] Shuffling data
[2023-07-23 08:38:37] [data] Done reading 20,192 sentences
[2023-07-23 08:38:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:43:26] Seen 20,192 samples
[2023-07-23 08:43:26] Starting data epoch 97 in logical epoch 97
[2023-07-23 08:43:26] [data] Shuffling data
[2023-07-23 08:43:26] [data] Done reading 20,192 sentences
[2023-07-23 08:43:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:48:16] Seen 20,192 samples
[2023-07-23 08:48:16] Starting data epoch 98 in logical epoch 98
[2023-07-23 08:48:16] [data] Shuffling data
[2023-07-23 08:48:16] [data] Done reading 20,192 sentences
[2023-07-23 08:48:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:53:07] Seen 20,192 samples
[2023-07-23 08:53:07] Starting data epoch 99 in logical epoch 99
[2023-07-23 08:53:07] [data] Shuffling data
[2023-07-23 08:53:07] [data] Done reading 20,192 sentences
[2023-07-23 08:53:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 08:57:44] Seen 20,192 samples
[2023-07-23 08:57:44] Starting data epoch 100 in logical epoch 100
[2023-07-23 08:57:44] [data] Shuffling data
[2023-07-23 08:57:44] [data] Done reading 20,192 sentences
[2023-07-23 08:57:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 09:02:36] Seen 20,192 samples
[2023-07-23 09:02:36] Starting data epoch 101 in logical epoch 101
[2023-07-23 09:02:36] Training finished
[2023-07-23 09:02:47] [valid] Ep. 101 : Up. 4431 : cross-entropy : 131.038 : new best
[2023-07-23 09:05:33] [valid] Ep. 101 : Up. 4431 : translation : 0 : new best
[2023-07-23 09:05:33] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 09:05:36] Saving Adam parameters
[2023-07-23 09:05:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 09:05:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 09:05:46] [marian] Running on node22.datos.cluster.uy as process 1011 with command line:
[2023-07-23 09:05:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 09:05:46] [config] after: 0e
[2023-07-23 09:05:46] [config] after-batches: 0
[2023-07-23 09:05:46] [config] after-epochs: 110
[2023-07-23 09:05:46] [config] all-caps-every: 0
[2023-07-23 09:05:46] [config] allow-unk: false
[2023-07-23 09:05:46] [config] authors: false
[2023-07-23 09:05:46] [config] beam-size: 12
[2023-07-23 09:05:46] [config] bert-class-symbol: "[CLS]"
[2023-07-23 09:05:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 09:05:46] [config] bert-masking-fraction: 0.15
[2023-07-23 09:05:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 09:05:46] [config] bert-train-type-embeddings: true
[2023-07-23 09:05:46] [config] bert-type-vocab-size: 2
[2023-07-23 09:05:46] [config] build-info: ""
[2023-07-23 09:05:46] [config] check-gradient-nan: false
[2023-07-23 09:05:46] [config] check-nan: false
[2023-07-23 09:05:46] [config] cite: false
[2023-07-23 09:05:46] [config] clip-norm: 1
[2023-07-23 09:05:46] [config] cost-scaling:
[2023-07-23 09:05:46] [config]   - 256.f
[2023-07-23 09:05:46] [config]   - 1000
[2023-07-23 09:05:46] [config]   - 2.f
[2023-07-23 09:05:46] [config]   - 256.f
[2023-07-23 09:05:46] [config] cost-type: ce-sum
[2023-07-23 09:05:46] [config] cpu-threads: 0
[2023-07-23 09:05:46] [config] data-threads: 8
[2023-07-23 09:05:46] [config] data-weighting: ""
[2023-07-23 09:05:46] [config] data-weighting-type: sentence
[2023-07-23 09:05:46] [config] dec-cell: gru
[2023-07-23 09:05:46] [config] dec-cell-base-depth: 2
[2023-07-23 09:05:46] [config] dec-cell-high-depth: 1
[2023-07-23 09:05:46] [config] dec-depth: 1
[2023-07-23 09:05:46] [config] devices:
[2023-07-23 09:05:46] [config]   - 0
[2023-07-23 09:05:46] [config] dim-emb: 512
[2023-07-23 09:05:46] [config] dim-rnn: 1024
[2023-07-23 09:05:46] [config] dim-vocabs:
[2023-07-23 09:05:46] [config]   - 16384
[2023-07-23 09:05:46] [config]   - 16384
[2023-07-23 09:05:46] [config] disp-first: 0
[2023-07-23 09:05:46] [config] disp-freq: 1000u
[2023-07-23 09:05:46] [config] disp-label-counts: true
[2023-07-23 09:05:46] [config] dropout-rnn: 0
[2023-07-23 09:05:46] [config] dropout-src: 0
[2023-07-23 09:05:46] [config] dropout-trg: 0
[2023-07-23 09:05:46] [config] dump-config: ""
[2023-07-23 09:05:46] [config] dynamic-gradient-scaling:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] early-stopping: 200
[2023-07-23 09:05:46] [config] early-stopping-on: first
[2023-07-23 09:05:46] [config] embedding-fix-src: false
[2023-07-23 09:05:46] [config] embedding-fix-trg: false
[2023-07-23 09:05:46] [config] embedding-normalization: false
[2023-07-23 09:05:46] [config] embedding-vectors:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] enc-cell: gru
[2023-07-23 09:05:46] [config] enc-cell-depth: 1
[2023-07-23 09:05:46] [config] enc-depth: 1
[2023-07-23 09:05:46] [config] enc-type: bidirectional
[2023-07-23 09:05:46] [config] english-title-case-every: 0
[2023-07-23 09:05:46] [config] exponential-smoothing: 0
[2023-07-23 09:05:46] [config] factor-weight: 1
[2023-07-23 09:05:46] [config] factors-combine: sum
[2023-07-23 09:05:46] [config] factors-dim-emb: 0
[2023-07-23 09:05:46] [config] gradient-checkpointing: false
[2023-07-23 09:05:46] [config] gradient-norm-average-window: 100
[2023-07-23 09:05:46] [config] guided-alignment: none
[2023-07-23 09:05:46] [config] guided-alignment-cost: mse
[2023-07-23 09:05:46] [config] guided-alignment-weight: 0.1
[2023-07-23 09:05:46] [config] ignore-model-config: false
[2023-07-23 09:05:46] [config] input-types:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] interpolate-env-vars: false
[2023-07-23 09:05:46] [config] keep-best: false
[2023-07-23 09:05:46] [config] label-smoothing: 0
[2023-07-23 09:05:46] [config] layer-normalization: false
[2023-07-23 09:05:46] [config] learn-rate: 0.0001
[2023-07-23 09:05:46] [config] lemma-dependency: ""
[2023-07-23 09:05:46] [config] lemma-dim-emb: 0
[2023-07-23 09:05:46] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 09:05:46] [config] log-level: info
[2023-07-23 09:05:46] [config] log-time-zone: ""
[2023-07-23 09:05:46] [config] logical-epoch:
[2023-07-23 09:05:46] [config]   - 1e
[2023-07-23 09:05:46] [config]   - 0
[2023-07-23 09:05:46] [config] lr-decay: 0
[2023-07-23 09:05:46] [config] lr-decay-freq: 50000
[2023-07-23 09:05:46] [config] lr-decay-inv-sqrt:
[2023-07-23 09:05:46] [config]   - 0
[2023-07-23 09:05:46] [config] lr-decay-repeat-warmup: false
[2023-07-23 09:05:46] [config] lr-decay-reset-optimizer: false
[2023-07-23 09:05:46] [config] lr-decay-start:
[2023-07-23 09:05:46] [config]   - 10
[2023-07-23 09:05:46] [config]   - 1
[2023-07-23 09:05:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 09:05:46] [config] lr-report: false
[2023-07-23 09:05:46] [config] lr-warmup: 0
[2023-07-23 09:05:46] [config] lr-warmup-at-reload: false
[2023-07-23 09:05:46] [config] lr-warmup-cycle: false
[2023-07-23 09:05:46] [config] lr-warmup-start-rate: 0
[2023-07-23 09:05:46] [config] max-length: 200
[2023-07-23 09:05:46] [config] max-length-crop: true
[2023-07-23 09:05:46] [config] max-length-factor: 3
[2023-07-23 09:05:46] [config] maxi-batch: 100
[2023-07-23 09:05:46] [config] maxi-batch-sort: trg
[2023-07-23 09:05:46] [config] mini-batch: 64
[2023-07-23 09:05:46] [config] mini-batch-fit: true
[2023-07-23 09:05:46] [config] mini-batch-fit-step: 10
[2023-07-23 09:05:46] [config] mini-batch-round-up: true
[2023-07-23 09:05:46] [config] mini-batch-track-lr: false
[2023-07-23 09:05:46] [config] mini-batch-warmup: 0
[2023-07-23 09:05:46] [config] mini-batch-words: 0
[2023-07-23 09:05:46] [config] mini-batch-words-ref: 0
[2023-07-23 09:05:46] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 09:05:46] [config] multi-loss-type: sum
[2023-07-23 09:05:46] [config] n-best: false
[2023-07-23 09:05:46] [config] no-nccl: false
[2023-07-23 09:05:46] [config] no-reload: false
[2023-07-23 09:05:46] [config] no-restore-corpus: false
[2023-07-23 09:05:46] [config] normalize: 0
[2023-07-23 09:05:46] [config] normalize-gradient: false
[2023-07-23 09:05:46] [config] num-devices: 0
[2023-07-23 09:05:46] [config] optimizer: adam
[2023-07-23 09:05:46] [config] optimizer-delay: 1
[2023-07-23 09:05:46] [config] optimizer-params:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] output-omit-bias: false
[2023-07-23 09:05:46] [config] overwrite: true
[2023-07-23 09:05:46] [config] precision:
[2023-07-23 09:05:46] [config]   - float16
[2023-07-23 09:05:46] [config]   - float32
[2023-07-23 09:05:46] [config] pretrained-model: ""
[2023-07-23 09:05:46] [config] quantize-biases: false
[2023-07-23 09:05:46] [config] quantize-bits: 0
[2023-07-23 09:05:46] [config] quantize-log-based: false
[2023-07-23 09:05:46] [config] quantize-optimization-steps: 0
[2023-07-23 09:05:46] [config] quiet: false
[2023-07-23 09:05:46] [config] quiet-translation: true
[2023-07-23 09:05:46] [config] relative-paths: false
[2023-07-23 09:05:46] [config] right-left: false
[2023-07-23 09:05:46] [config] save-freq: 10000u
[2023-07-23 09:05:46] [config] seed: 1234
[2023-07-23 09:05:46] [config] sentencepiece-alphas:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] sentencepiece-max-lines: 2000000
[2023-07-23 09:05:46] [config] sentencepiece-options: ""
[2023-07-23 09:05:46] [config] sharding: global
[2023-07-23 09:05:46] [config] shuffle: data
[2023-07-23 09:05:46] [config] shuffle-in-ram: false
[2023-07-23 09:05:46] [config] sigterm: save-and-exit
[2023-07-23 09:05:46] [config] skip: false
[2023-07-23 09:05:46] [config] sqlite: ""
[2023-07-23 09:05:46] [config] sqlite-drop: false
[2023-07-23 09:05:46] [config] sync-freq: 200u
[2023-07-23 09:05:46] [config] sync-sgd: false
[2023-07-23 09:05:46] [config] tempdir: /tmp
[2023-07-23 09:05:46] [config] tied-embeddings: false
[2023-07-23 09:05:46] [config] tied-embeddings-all: true
[2023-07-23 09:05:46] [config] tied-embeddings-src: false
[2023-07-23 09:05:46] [config] train-embedder-rank:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] train-sets:
[2023-07-23 09:05:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 09:05:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 09:05:46] [config] transformer-aan-activation: swish
[2023-07-23 09:05:46] [config] transformer-aan-depth: 2
[2023-07-23 09:05:46] [config] transformer-aan-nogate: false
[2023-07-23 09:05:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 09:05:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 09:05:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 09:05:46] [config] transformer-depth-scaling: false
[2023-07-23 09:05:46] [config] transformer-dim-aan: 2048
[2023-07-23 09:05:46] [config] transformer-dim-ffn: 2048
[2023-07-23 09:05:46] [config] transformer-dropout: 0
[2023-07-23 09:05:46] [config] transformer-dropout-attention: 0
[2023-07-23 09:05:46] [config] transformer-dropout-ffn: 0
[2023-07-23 09:05:46] [config] transformer-ffn-activation: swish
[2023-07-23 09:05:46] [config] transformer-ffn-depth: 2
[2023-07-23 09:05:46] [config] transformer-guided-alignment-layer: last
[2023-07-23 09:05:46] [config] transformer-heads: 8
[2023-07-23 09:05:46] [config] transformer-no-projection: false
[2023-07-23 09:05:46] [config] transformer-pool: false
[2023-07-23 09:05:46] [config] transformer-postprocess: dan
[2023-07-23 09:05:46] [config] transformer-postprocess-emb: d
[2023-07-23 09:05:46] [config] transformer-postprocess-top: ""
[2023-07-23 09:05:46] [config] transformer-preprocess: ""
[2023-07-23 09:05:46] [config] transformer-tied-layers:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] transformer-train-position-embeddings: false
[2023-07-23 09:05:46] [config] tsv: false
[2023-07-23 09:05:46] [config] tsv-fields: 0
[2023-07-23 09:05:46] [config] type: amun
[2023-07-23 09:05:46] [config] ulr: false
[2023-07-23 09:05:46] [config] ulr-dim-emb: 0
[2023-07-23 09:05:46] [config] ulr-dropout: 0
[2023-07-23 09:05:46] [config] ulr-keys-vectors: ""
[2023-07-23 09:05:46] [config] ulr-query-vectors: ""
[2023-07-23 09:05:46] [config] ulr-softmax-temperature: 1
[2023-07-23 09:05:46] [config] ulr-trainable-transformation: false
[2023-07-23 09:05:46] [config] unlikelihood-loss: false
[2023-07-23 09:05:46] [config] valid-freq: 50000000
[2023-07-23 09:05:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 09:05:46] [config] valid-max-length: 1000
[2023-07-23 09:05:46] [config] valid-metrics:
[2023-07-23 09:05:46] [config]   - cross-entropy
[2023-07-23 09:05:46] [config]   - translation
[2023-07-23 09:05:46] [config] valid-mini-batch: 32
[2023-07-23 09:05:46] [config] valid-reset-stalled: false
[2023-07-23 09:05:46] [config] valid-script-args:
[2023-07-23 09:05:46] [config]   []
[2023-07-23 09:05:46] [config] valid-script-path: ""
[2023-07-23 09:05:46] [config] valid-sets:
[2023-07-23 09:05:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 09:05:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 09:05:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 09:05:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 09:05:46] [config] vocabs:
[2023-07-23 09:05:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 09:05:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 09:05:46] [config] word-penalty: 0
[2023-07-23 09:05:46] [config] word-scores: false
[2023-07-23 09:05:46] [config] workspace: 5500
[2023-07-23 09:05:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 09:05:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 09:05:46] [training] Using single-device training
[2023-07-23 09:05:46] Synced seed 1234
[2023-07-23 09:05:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 09:05:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 09:05:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 09:05:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 09:05:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 09:05:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 09:05:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 09:05:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 09:05:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 09:05:47] [comm] Using global sharding
[2023-07-23 09:05:47] [comm] NCCLCommunicators constructed successfully
[2023-07-23 09:05:47] [training] Using 1 GPUs
[2023-07-23 09:05:47] [logits] Applying loss function for 1 factor(s)
[2023-07-23 09:05:47] [memory] Reserving 80 MB, device gpu0
[2023-07-23 09:05:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 09:05:48] [memory] Reserving 80 MB, device gpu0
[2023-07-23 09:42:06] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 09:42:06] [valid] No post-processing script given for validating translator
[2023-07-23 09:42:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 09:42:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 09:42:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 09:42:06] [comm] Using global sharding
[2023-07-23 09:42:06] [comm] NCCLCommunicators constructed successfully
[2023-07-23 09:42:06] [training] Using 1 GPUs
[2023-07-23 09:42:06] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 09:42:09] Allocating memory for general optimizer shards
[2023-07-23 09:42:09] [memory] Reserving 322 MB, device gpu0
[2023-07-23 09:42:09] Loading Adam parameters
[2023-07-23 09:42:10] [memory] Reserving 322 MB, device gpu0
[2023-07-23 09:42:10] [memory] Reserving 80 MB, device gpu0
[2023-07-23 09:42:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 09:42:10] [data] Restoring the corpus state to epoch 101, batch 4431
[2023-07-23 09:42:10] [data] Shuffling data
[2023-07-23 09:42:10] [data] Done reading 20,192 sentences
[2023-07-23 09:42:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 09:42:10] Training started
[2023-07-23 09:42:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 09:42:11] [memory] Reserving 80 MB, device gpu0
[2023-07-23 09:42:25] Parameter type float16, optimization type float32, casting types true
[2023-07-23 09:46:52] Seen 20,192 samples
[2023-07-23 09:46:52] Starting data epoch 102 in logical epoch 102
[2023-07-23 09:46:52] [data] Shuffling data
[2023-07-23 09:46:52] [data] Done reading 20,192 sentences
[2023-07-23 09:46:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 09:51:39] Seen 20,192 samples
[2023-07-23 09:51:39] Starting data epoch 103 in logical epoch 103
[2023-07-23 09:51:39] [data] Shuffling data
[2023-07-23 09:51:39] [data] Done reading 20,192 sentences
[2023-07-23 09:51:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 09:56:31] Seen 20,192 samples
[2023-07-23 09:56:31] Starting data epoch 104 in logical epoch 104
[2023-07-23 09:56:31] [data] Shuffling data
[2023-07-23 09:56:31] [data] Done reading 20,192 sentences
[2023-07-23 09:56:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 10:01:25] Seen 20,192 samples
[2023-07-23 10:01:25] Starting data epoch 105 in logical epoch 105
[2023-07-23 10:01:25] [data] Shuffling data
[2023-07-23 10:01:25] [data] Done reading 20,192 sentences
[2023-07-23 10:01:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 10:06:14] Seen 20,192 samples
[2023-07-23 10:06:14] Starting data epoch 106 in logical epoch 106
[2023-07-23 10:06:14] [data] Shuffling data
[2023-07-23 10:06:14] [data] Done reading 20,192 sentences
[2023-07-23 10:06:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 10:11:07] Seen 20,192 samples
[2023-07-23 10:11:07] Starting data epoch 107 in logical epoch 107
[2023-07-23 10:11:07] [data] Shuffling data
[2023-07-23 10:11:07] [data] Done reading 20,192 sentences
[2023-07-23 10:11:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 10:15:53] Seen 20,192 samples
[2023-07-23 10:15:53] Starting data epoch 108 in logical epoch 108
[2023-07-23 10:15:53] [data] Shuffling data
[2023-07-23 10:15:53] [data] Done reading 20,192 sentences
[2023-07-23 10:15:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 10:20:45] Seen 20,192 samples
[2023-07-23 10:20:45] Starting data epoch 109 in logical epoch 109
[2023-07-23 10:20:45] [data] Shuffling data
[2023-07-23 10:20:45] [data] Done reading 20,192 sentences
[2023-07-23 10:20:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 10:25:28] Seen 20,192 samples
[2023-07-23 10:25:28] Starting data epoch 110 in logical epoch 110
[2023-07-23 10:25:28] [data] Shuffling data
[2023-07-23 10:25:28] [data] Done reading 20,192 sentences
[2023-07-23 10:25:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 10:30:14] Seen 20,192 samples
[2023-07-23 10:30:14] Starting data epoch 111 in logical epoch 111
[2023-07-23 10:30:14] Training finished
[2023-07-23 10:30:25] [valid] Ep. 111 : Up. 4872 : cross-entropy : 131.098 : stalled 1 times (last best: 131.038)
[2023-07-23 10:33:04] [valid] Ep. 111 : Up. 4872 : translation : 0 : new best
[2023-07-23 10:33:04] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 10:33:07] Saving Adam parameters
[2023-07-23 10:33:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 10:33:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 10:33:19] [marian] Running on node22.datos.cluster.uy as process 6732 with command line:
[2023-07-23 10:33:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 10:33:19] [config] after: 0e
[2023-07-23 10:33:19] [config] after-batches: 0
[2023-07-23 10:33:19] [config] after-epochs: 120
[2023-07-23 10:33:19] [config] all-caps-every: 0
[2023-07-23 10:33:19] [config] allow-unk: false
[2023-07-23 10:33:19] [config] authors: false
[2023-07-23 10:33:19] [config] beam-size: 12
[2023-07-23 10:33:19] [config] bert-class-symbol: "[CLS]"
[2023-07-23 10:33:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 10:33:19] [config] bert-masking-fraction: 0.15
[2023-07-23 10:33:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 10:33:19] [config] bert-train-type-embeddings: true
[2023-07-23 10:33:19] [config] bert-type-vocab-size: 2
[2023-07-23 10:33:19] [config] build-info: ""
[2023-07-23 10:33:19] [config] check-gradient-nan: false
[2023-07-23 10:33:19] [config] check-nan: false
[2023-07-23 10:33:19] [config] cite: false
[2023-07-23 10:33:19] [config] clip-norm: 1
[2023-07-23 10:33:19] [config] cost-scaling:
[2023-07-23 10:33:19] [config]   - 256.f
[2023-07-23 10:33:19] [config]   - 1000
[2023-07-23 10:33:19] [config]   - 2.f
[2023-07-23 10:33:19] [config]   - 256.f
[2023-07-23 10:33:19] [config] cost-type: ce-sum
[2023-07-23 10:33:19] [config] cpu-threads: 0
[2023-07-23 10:33:19] [config] data-threads: 8
[2023-07-23 10:33:19] [config] data-weighting: ""
[2023-07-23 10:33:19] [config] data-weighting-type: sentence
[2023-07-23 10:33:19] [config] dec-cell: gru
[2023-07-23 10:33:19] [config] dec-cell-base-depth: 2
[2023-07-23 10:33:19] [config] dec-cell-high-depth: 1
[2023-07-23 10:33:19] [config] dec-depth: 1
[2023-07-23 10:33:19] [config] devices:
[2023-07-23 10:33:19] [config]   - 0
[2023-07-23 10:33:19] [config] dim-emb: 512
[2023-07-23 10:33:19] [config] dim-rnn: 1024
[2023-07-23 10:33:19] [config] dim-vocabs:
[2023-07-23 10:33:19] [config]   - 16384
[2023-07-23 10:33:19] [config]   - 16384
[2023-07-23 10:33:19] [config] disp-first: 0
[2023-07-23 10:33:19] [config] disp-freq: 1000u
[2023-07-23 10:33:19] [config] disp-label-counts: true
[2023-07-23 10:33:19] [config] dropout-rnn: 0
[2023-07-23 10:33:19] [config] dropout-src: 0
[2023-07-23 10:33:19] [config] dropout-trg: 0
[2023-07-23 10:33:19] [config] dump-config: ""
[2023-07-23 10:33:19] [config] dynamic-gradient-scaling:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] early-stopping: 200
[2023-07-23 10:33:19] [config] early-stopping-on: first
[2023-07-23 10:33:19] [config] embedding-fix-src: false
[2023-07-23 10:33:19] [config] embedding-fix-trg: false
[2023-07-23 10:33:19] [config] embedding-normalization: false
[2023-07-23 10:33:19] [config] embedding-vectors:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] enc-cell: gru
[2023-07-23 10:33:19] [config] enc-cell-depth: 1
[2023-07-23 10:33:19] [config] enc-depth: 1
[2023-07-23 10:33:19] [config] enc-type: bidirectional
[2023-07-23 10:33:19] [config] english-title-case-every: 0
[2023-07-23 10:33:19] [config] exponential-smoothing: 0
[2023-07-23 10:33:19] [config] factor-weight: 1
[2023-07-23 10:33:19] [config] factors-combine: sum
[2023-07-23 10:33:19] [config] factors-dim-emb: 0
[2023-07-23 10:33:19] [config] gradient-checkpointing: false
[2023-07-23 10:33:19] [config] gradient-norm-average-window: 100
[2023-07-23 10:33:19] [config] guided-alignment: none
[2023-07-23 10:33:19] [config] guided-alignment-cost: mse
[2023-07-23 10:33:19] [config] guided-alignment-weight: 0.1
[2023-07-23 10:33:19] [config] ignore-model-config: false
[2023-07-23 10:33:19] [config] input-types:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] interpolate-env-vars: false
[2023-07-23 10:33:19] [config] keep-best: false
[2023-07-23 10:33:19] [config] label-smoothing: 0
[2023-07-23 10:33:19] [config] layer-normalization: false
[2023-07-23 10:33:19] [config] learn-rate: 0.0001
[2023-07-23 10:33:19] [config] lemma-dependency: ""
[2023-07-23 10:33:19] [config] lemma-dim-emb: 0
[2023-07-23 10:33:19] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 10:33:19] [config] log-level: info
[2023-07-23 10:33:19] [config] log-time-zone: ""
[2023-07-23 10:33:19] [config] logical-epoch:
[2023-07-23 10:33:19] [config]   - 1e
[2023-07-23 10:33:19] [config]   - 0
[2023-07-23 10:33:19] [config] lr-decay: 0
[2023-07-23 10:33:19] [config] lr-decay-freq: 50000
[2023-07-23 10:33:19] [config] lr-decay-inv-sqrt:
[2023-07-23 10:33:19] [config]   - 0
[2023-07-23 10:33:19] [config] lr-decay-repeat-warmup: false
[2023-07-23 10:33:19] [config] lr-decay-reset-optimizer: false
[2023-07-23 10:33:19] [config] lr-decay-start:
[2023-07-23 10:33:19] [config]   - 10
[2023-07-23 10:33:19] [config]   - 1
[2023-07-23 10:33:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 10:33:19] [config] lr-report: false
[2023-07-23 10:33:19] [config] lr-warmup: 0
[2023-07-23 10:33:19] [config] lr-warmup-at-reload: false
[2023-07-23 10:33:19] [config] lr-warmup-cycle: false
[2023-07-23 10:33:19] [config] lr-warmup-start-rate: 0
[2023-07-23 10:33:19] [config] max-length: 200
[2023-07-23 10:33:19] [config] max-length-crop: true
[2023-07-23 10:33:19] [config] max-length-factor: 3
[2023-07-23 10:33:19] [config] maxi-batch: 100
[2023-07-23 10:33:19] [config] maxi-batch-sort: trg
[2023-07-23 10:33:19] [config] mini-batch: 64
[2023-07-23 10:33:19] [config] mini-batch-fit: true
[2023-07-23 10:33:19] [config] mini-batch-fit-step: 10
[2023-07-23 10:33:19] [config] mini-batch-round-up: true
[2023-07-23 10:33:19] [config] mini-batch-track-lr: false
[2023-07-23 10:33:19] [config] mini-batch-warmup: 0
[2023-07-23 10:33:19] [config] mini-batch-words: 0
[2023-07-23 10:33:19] [config] mini-batch-words-ref: 0
[2023-07-23 10:33:19] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 10:33:19] [config] multi-loss-type: sum
[2023-07-23 10:33:19] [config] n-best: false
[2023-07-23 10:33:19] [config] no-nccl: false
[2023-07-23 10:33:19] [config] no-reload: false
[2023-07-23 10:33:19] [config] no-restore-corpus: false
[2023-07-23 10:33:19] [config] normalize: 0
[2023-07-23 10:33:19] [config] normalize-gradient: false
[2023-07-23 10:33:19] [config] num-devices: 0
[2023-07-23 10:33:19] [config] optimizer: adam
[2023-07-23 10:33:19] [config] optimizer-delay: 1
[2023-07-23 10:33:19] [config] optimizer-params:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] output-omit-bias: false
[2023-07-23 10:33:19] [config] overwrite: true
[2023-07-23 10:33:19] [config] precision:
[2023-07-23 10:33:19] [config]   - float16
[2023-07-23 10:33:19] [config]   - float32
[2023-07-23 10:33:19] [config] pretrained-model: ""
[2023-07-23 10:33:19] [config] quantize-biases: false
[2023-07-23 10:33:19] [config] quantize-bits: 0
[2023-07-23 10:33:19] [config] quantize-log-based: false
[2023-07-23 10:33:19] [config] quantize-optimization-steps: 0
[2023-07-23 10:33:19] [config] quiet: false
[2023-07-23 10:33:19] [config] quiet-translation: true
[2023-07-23 10:33:19] [config] relative-paths: false
[2023-07-23 10:33:19] [config] right-left: false
[2023-07-23 10:33:19] [config] save-freq: 10000u
[2023-07-23 10:33:19] [config] seed: 1234
[2023-07-23 10:33:19] [config] sentencepiece-alphas:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] sentencepiece-max-lines: 2000000
[2023-07-23 10:33:19] [config] sentencepiece-options: ""
[2023-07-23 10:33:19] [config] sharding: global
[2023-07-23 10:33:19] [config] shuffle: data
[2023-07-23 10:33:19] [config] shuffle-in-ram: false
[2023-07-23 10:33:19] [config] sigterm: save-and-exit
[2023-07-23 10:33:19] [config] skip: false
[2023-07-23 10:33:19] [config] sqlite: ""
[2023-07-23 10:33:19] [config] sqlite-drop: false
[2023-07-23 10:33:19] [config] sync-freq: 200u
[2023-07-23 10:33:19] [config] sync-sgd: false
[2023-07-23 10:33:19] [config] tempdir: /tmp
[2023-07-23 10:33:19] [config] tied-embeddings: false
[2023-07-23 10:33:19] [config] tied-embeddings-all: true
[2023-07-23 10:33:19] [config] tied-embeddings-src: false
[2023-07-23 10:33:19] [config] train-embedder-rank:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] train-sets:
[2023-07-23 10:33:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 10:33:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 10:33:19] [config] transformer-aan-activation: swish
[2023-07-23 10:33:19] [config] transformer-aan-depth: 2
[2023-07-23 10:33:19] [config] transformer-aan-nogate: false
[2023-07-23 10:33:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 10:33:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 10:33:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 10:33:19] [config] transformer-depth-scaling: false
[2023-07-23 10:33:19] [config] transformer-dim-aan: 2048
[2023-07-23 10:33:19] [config] transformer-dim-ffn: 2048
[2023-07-23 10:33:19] [config] transformer-dropout: 0
[2023-07-23 10:33:19] [config] transformer-dropout-attention: 0
[2023-07-23 10:33:19] [config] transformer-dropout-ffn: 0
[2023-07-23 10:33:19] [config] transformer-ffn-activation: swish
[2023-07-23 10:33:19] [config] transformer-ffn-depth: 2
[2023-07-23 10:33:19] [config] transformer-guided-alignment-layer: last
[2023-07-23 10:33:19] [config] transformer-heads: 8
[2023-07-23 10:33:19] [config] transformer-no-projection: false
[2023-07-23 10:33:19] [config] transformer-pool: false
[2023-07-23 10:33:19] [config] transformer-postprocess: dan
[2023-07-23 10:33:19] [config] transformer-postprocess-emb: d
[2023-07-23 10:33:19] [config] transformer-postprocess-top: ""
[2023-07-23 10:33:19] [config] transformer-preprocess: ""
[2023-07-23 10:33:19] [config] transformer-tied-layers:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] transformer-train-position-embeddings: false
[2023-07-23 10:33:19] [config] tsv: false
[2023-07-23 10:33:19] [config] tsv-fields: 0
[2023-07-23 10:33:19] [config] type: amun
[2023-07-23 10:33:19] [config] ulr: false
[2023-07-23 10:33:19] [config] ulr-dim-emb: 0
[2023-07-23 10:33:19] [config] ulr-dropout: 0
[2023-07-23 10:33:19] [config] ulr-keys-vectors: ""
[2023-07-23 10:33:19] [config] ulr-query-vectors: ""
[2023-07-23 10:33:19] [config] ulr-softmax-temperature: 1
[2023-07-23 10:33:19] [config] ulr-trainable-transformation: false
[2023-07-23 10:33:19] [config] unlikelihood-loss: false
[2023-07-23 10:33:19] [config] valid-freq: 50000000
[2023-07-23 10:33:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 10:33:19] [config] valid-max-length: 1000
[2023-07-23 10:33:19] [config] valid-metrics:
[2023-07-23 10:33:19] [config]   - cross-entropy
[2023-07-23 10:33:19] [config]   - translation
[2023-07-23 10:33:19] [config] valid-mini-batch: 32
[2023-07-23 10:33:19] [config] valid-reset-stalled: false
[2023-07-23 10:33:19] [config] valid-script-args:
[2023-07-23 10:33:19] [config]   []
[2023-07-23 10:33:19] [config] valid-script-path: ""
[2023-07-23 10:33:19] [config] valid-sets:
[2023-07-23 10:33:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 10:33:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 10:33:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 10:33:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 10:33:19] [config] vocabs:
[2023-07-23 10:33:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 10:33:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 10:33:19] [config] word-penalty: 0
[2023-07-23 10:33:19] [config] word-scores: false
[2023-07-23 10:33:19] [config] workspace: 5500
[2023-07-23 10:33:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 10:33:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 10:33:19] [training] Using single-device training
[2023-07-23 10:33:20] Synced seed 1234
[2023-07-23 10:33:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 10:33:20] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 10:33:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 10:33:20] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 10:33:20] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 10:33:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 10:33:20] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 10:33:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 10:33:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 10:33:21] [comm] Using global sharding
[2023-07-23 10:33:21] [comm] NCCLCommunicators constructed successfully
[2023-07-23 10:33:21] [training] Using 1 GPUs
[2023-07-23 10:33:21] [logits] Applying loss function for 1 factor(s)
[2023-07-23 10:33:21] [memory] Reserving 80 MB, device gpu0
[2023-07-23 10:33:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 10:33:22] [memory] Reserving 80 MB, device gpu0
[2023-07-23 11:09:34] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 11:09:34] [valid] No post-processing script given for validating translator
[2023-07-23 11:09:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 11:09:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 11:09:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 11:09:35] [comm] Using global sharding
[2023-07-23 11:09:35] [comm] NCCLCommunicators constructed successfully
[2023-07-23 11:09:35] [training] Using 1 GPUs
[2023-07-23 11:09:35] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 11:09:45] Allocating memory for general optimizer shards
[2023-07-23 11:09:45] [memory] Reserving 322 MB, device gpu0
[2023-07-23 11:09:45] Loading Adam parameters
[2023-07-23 11:09:45] [memory] Reserving 322 MB, device gpu0
[2023-07-23 11:09:45] [memory] Reserving 80 MB, device gpu0
[2023-07-23 11:09:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 11:09:45] [data] Restoring the corpus state to epoch 111, batch 4872
[2023-07-23 11:09:45] [data] Shuffling data
[2023-07-23 11:09:45] [data] Done reading 20,192 sentences
[2023-07-23 11:09:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:09:45] Training started
[2023-07-23 11:09:45] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 11:09:46] [memory] Reserving 80 MB, device gpu0
[2023-07-23 11:09:50] Parameter type float16, optimization type float32, casting types true
[2023-07-23 11:14:22] Seen 20,192 samples
[2023-07-23 11:14:22] Starting data epoch 112 in logical epoch 112
[2023-07-23 11:14:22] [data] Shuffling data
[2023-07-23 11:14:23] [data] Done reading 20,192 sentences
[2023-07-23 11:14:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:19:05] Seen 20,192 samples
[2023-07-23 11:19:05] Starting data epoch 113 in logical epoch 113
[2023-07-23 11:19:05] [data] Shuffling data
[2023-07-23 11:19:05] [data] Done reading 20,192 sentences
[2023-07-23 11:19:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:23:31] Ep. 113 : Up. 5000 : Sen. 17,998 : Cost 3.98182893 * 12,334,258 @ 17,063 after 61,439,138 : Time 836.64s : 14742.54 words/s : gNorm 1.3610
[2023-07-23 11:23:58] Seen 20,192 samples
[2023-07-23 11:23:58] Starting data epoch 114 in logical epoch 114
[2023-07-23 11:23:58] [data] Shuffling data
[2023-07-23 11:23:58] [data] Done reading 20,192 sentences
[2023-07-23 11:23:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:28:37] Seen 20,192 samples
[2023-07-23 11:28:37] Starting data epoch 115 in logical epoch 115
[2023-07-23 11:28:37] [data] Shuffling data
[2023-07-23 11:28:37] [data] Done reading 20,192 sentences
[2023-07-23 11:28:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:33:26] Seen 20,192 samples
[2023-07-23 11:33:26] Starting data epoch 116 in logical epoch 116
[2023-07-23 11:33:26] [data] Shuffling data
[2023-07-23 11:33:26] [data] Done reading 20,192 sentences
[2023-07-23 11:33:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:38:12] Seen 20,192 samples
[2023-07-23 11:38:12] Starting data epoch 117 in logical epoch 117
[2023-07-23 11:38:12] [data] Shuffling data
[2023-07-23 11:38:12] [data] Done reading 20,192 sentences
[2023-07-23 11:38:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:43:00] Seen 20,192 samples
[2023-07-23 11:43:00] Starting data epoch 118 in logical epoch 118
[2023-07-23 11:43:00] [data] Shuffling data
[2023-07-23 11:43:00] [data] Done reading 20,192 sentences
[2023-07-23 11:43:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:47:51] Seen 20,192 samples
[2023-07-23 11:47:51] Starting data epoch 119 in logical epoch 119
[2023-07-23 11:47:51] [data] Shuffling data
[2023-07-23 11:47:51] [data] Done reading 20,192 sentences
[2023-07-23 11:47:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:52:34] Seen 20,192 samples
[2023-07-23 11:52:34] Starting data epoch 120 in logical epoch 120
[2023-07-23 11:52:34] [data] Shuffling data
[2023-07-23 11:52:35] [data] Done reading 20,192 sentences
[2023-07-23 11:52:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 11:57:13] Seen 20,192 samples
[2023-07-23 11:57:13] Starting data epoch 121 in logical epoch 121
[2023-07-23 11:57:13] Training finished
[2023-07-23 11:57:24] [valid] Ep. 121 : Up. 5319 : cross-entropy : 132.138 : stalled 2 times (last best: 131.038)
[2023-07-23 11:59:54] [valid] Ep. 121 : Up. 5319 : translation : 0 : new best
[2023-07-23 11:59:54] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 11:59:57] Saving Adam parameters
[2023-07-23 11:59:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 12:00:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 12:00:07] [marian] Running on node22.datos.cluster.uy as process 12345 with command line:
[2023-07-23 12:00:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 12:00:07] [config] after: 0e
[2023-07-23 12:00:07] [config] after-batches: 0
[2023-07-23 12:00:07] [config] after-epochs: 130
[2023-07-23 12:00:07] [config] all-caps-every: 0
[2023-07-23 12:00:07] [config] allow-unk: false
[2023-07-23 12:00:07] [config] authors: false
[2023-07-23 12:00:07] [config] beam-size: 12
[2023-07-23 12:00:07] [config] bert-class-symbol: "[CLS]"
[2023-07-23 12:00:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 12:00:07] [config] bert-masking-fraction: 0.15
[2023-07-23 12:00:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 12:00:07] [config] bert-train-type-embeddings: true
[2023-07-23 12:00:07] [config] bert-type-vocab-size: 2
[2023-07-23 12:00:07] [config] build-info: ""
[2023-07-23 12:00:07] [config] check-gradient-nan: false
[2023-07-23 12:00:07] [config] check-nan: false
[2023-07-23 12:00:07] [config] cite: false
[2023-07-23 12:00:07] [config] clip-norm: 1
[2023-07-23 12:00:07] [config] cost-scaling:
[2023-07-23 12:00:07] [config]   - 256.f
[2023-07-23 12:00:07] [config]   - 1000
[2023-07-23 12:00:07] [config]   - 2.f
[2023-07-23 12:00:07] [config]   - 256.f
[2023-07-23 12:00:07] [config] cost-type: ce-sum
[2023-07-23 12:00:07] [config] cpu-threads: 0
[2023-07-23 12:00:07] [config] data-threads: 8
[2023-07-23 12:00:07] [config] data-weighting: ""
[2023-07-23 12:00:07] [config] data-weighting-type: sentence
[2023-07-23 12:00:07] [config] dec-cell: gru
[2023-07-23 12:00:07] [config] dec-cell-base-depth: 2
[2023-07-23 12:00:07] [config] dec-cell-high-depth: 1
[2023-07-23 12:00:07] [config] dec-depth: 1
[2023-07-23 12:00:07] [config] devices:
[2023-07-23 12:00:07] [config]   - 0
[2023-07-23 12:00:07] [config] dim-emb: 512
[2023-07-23 12:00:07] [config] dim-rnn: 1024
[2023-07-23 12:00:07] [config] dim-vocabs:
[2023-07-23 12:00:07] [config]   - 16384
[2023-07-23 12:00:07] [config]   - 16384
[2023-07-23 12:00:07] [config] disp-first: 0
[2023-07-23 12:00:07] [config] disp-freq: 1000u
[2023-07-23 12:00:07] [config] disp-label-counts: true
[2023-07-23 12:00:07] [config] dropout-rnn: 0
[2023-07-23 12:00:07] [config] dropout-src: 0
[2023-07-23 12:00:07] [config] dropout-trg: 0
[2023-07-23 12:00:07] [config] dump-config: ""
[2023-07-23 12:00:07] [config] dynamic-gradient-scaling:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] early-stopping: 200
[2023-07-23 12:00:07] [config] early-stopping-on: first
[2023-07-23 12:00:07] [config] embedding-fix-src: false
[2023-07-23 12:00:07] [config] embedding-fix-trg: false
[2023-07-23 12:00:07] [config] embedding-normalization: false
[2023-07-23 12:00:07] [config] embedding-vectors:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] enc-cell: gru
[2023-07-23 12:00:07] [config] enc-cell-depth: 1
[2023-07-23 12:00:07] [config] enc-depth: 1
[2023-07-23 12:00:07] [config] enc-type: bidirectional
[2023-07-23 12:00:07] [config] english-title-case-every: 0
[2023-07-23 12:00:07] [config] exponential-smoothing: 0
[2023-07-23 12:00:07] [config] factor-weight: 1
[2023-07-23 12:00:07] [config] factors-combine: sum
[2023-07-23 12:00:07] [config] factors-dim-emb: 0
[2023-07-23 12:00:07] [config] gradient-checkpointing: false
[2023-07-23 12:00:07] [config] gradient-norm-average-window: 100
[2023-07-23 12:00:07] [config] guided-alignment: none
[2023-07-23 12:00:07] [config] guided-alignment-cost: mse
[2023-07-23 12:00:07] [config] guided-alignment-weight: 0.1
[2023-07-23 12:00:07] [config] ignore-model-config: false
[2023-07-23 12:00:07] [config] input-types:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] interpolate-env-vars: false
[2023-07-23 12:00:07] [config] keep-best: false
[2023-07-23 12:00:07] [config] label-smoothing: 0
[2023-07-23 12:00:07] [config] layer-normalization: false
[2023-07-23 12:00:07] [config] learn-rate: 0.0001
[2023-07-23 12:00:07] [config] lemma-dependency: ""
[2023-07-23 12:00:07] [config] lemma-dim-emb: 0
[2023-07-23 12:00:07] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 12:00:07] [config] log-level: info
[2023-07-23 12:00:07] [config] log-time-zone: ""
[2023-07-23 12:00:07] [config] logical-epoch:
[2023-07-23 12:00:07] [config]   - 1e
[2023-07-23 12:00:07] [config]   - 0
[2023-07-23 12:00:07] [config] lr-decay: 0
[2023-07-23 12:00:07] [config] lr-decay-freq: 50000
[2023-07-23 12:00:07] [config] lr-decay-inv-sqrt:
[2023-07-23 12:00:07] [config]   - 0
[2023-07-23 12:00:07] [config] lr-decay-repeat-warmup: false
[2023-07-23 12:00:07] [config] lr-decay-reset-optimizer: false
[2023-07-23 12:00:07] [config] lr-decay-start:
[2023-07-23 12:00:07] [config]   - 10
[2023-07-23 12:00:07] [config]   - 1
[2023-07-23 12:00:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 12:00:07] [config] lr-report: false
[2023-07-23 12:00:07] [config] lr-warmup: 0
[2023-07-23 12:00:07] [config] lr-warmup-at-reload: false
[2023-07-23 12:00:07] [config] lr-warmup-cycle: false
[2023-07-23 12:00:07] [config] lr-warmup-start-rate: 0
[2023-07-23 12:00:07] [config] max-length: 200
[2023-07-23 12:00:07] [config] max-length-crop: true
[2023-07-23 12:00:07] [config] max-length-factor: 3
[2023-07-23 12:00:07] [config] maxi-batch: 100
[2023-07-23 12:00:07] [config] maxi-batch-sort: trg
[2023-07-23 12:00:07] [config] mini-batch: 64
[2023-07-23 12:00:07] [config] mini-batch-fit: true
[2023-07-23 12:00:07] [config] mini-batch-fit-step: 10
[2023-07-23 12:00:07] [config] mini-batch-round-up: true
[2023-07-23 12:00:07] [config] mini-batch-track-lr: false
[2023-07-23 12:00:07] [config] mini-batch-warmup: 0
[2023-07-23 12:00:07] [config] mini-batch-words: 0
[2023-07-23 12:00:07] [config] mini-batch-words-ref: 0
[2023-07-23 12:00:07] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 12:00:07] [config] multi-loss-type: sum
[2023-07-23 12:00:07] [config] n-best: false
[2023-07-23 12:00:07] [config] no-nccl: false
[2023-07-23 12:00:07] [config] no-reload: false
[2023-07-23 12:00:07] [config] no-restore-corpus: false
[2023-07-23 12:00:07] [config] normalize: 0
[2023-07-23 12:00:07] [config] normalize-gradient: false
[2023-07-23 12:00:07] [config] num-devices: 0
[2023-07-23 12:00:07] [config] optimizer: adam
[2023-07-23 12:00:07] [config] optimizer-delay: 1
[2023-07-23 12:00:07] [config] optimizer-params:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] output-omit-bias: false
[2023-07-23 12:00:07] [config] overwrite: true
[2023-07-23 12:00:07] [config] precision:
[2023-07-23 12:00:07] [config]   - float16
[2023-07-23 12:00:07] [config]   - float32
[2023-07-23 12:00:07] [config] pretrained-model: ""
[2023-07-23 12:00:07] [config] quantize-biases: false
[2023-07-23 12:00:07] [config] quantize-bits: 0
[2023-07-23 12:00:07] [config] quantize-log-based: false
[2023-07-23 12:00:07] [config] quantize-optimization-steps: 0
[2023-07-23 12:00:07] [config] quiet: false
[2023-07-23 12:00:07] [config] quiet-translation: true
[2023-07-23 12:00:07] [config] relative-paths: false
[2023-07-23 12:00:07] [config] right-left: false
[2023-07-23 12:00:07] [config] save-freq: 10000u
[2023-07-23 12:00:07] [config] seed: 1234
[2023-07-23 12:00:07] [config] sentencepiece-alphas:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] sentencepiece-max-lines: 2000000
[2023-07-23 12:00:07] [config] sentencepiece-options: ""
[2023-07-23 12:00:07] [config] sharding: global
[2023-07-23 12:00:07] [config] shuffle: data
[2023-07-23 12:00:07] [config] shuffle-in-ram: false
[2023-07-23 12:00:07] [config] sigterm: save-and-exit
[2023-07-23 12:00:07] [config] skip: false
[2023-07-23 12:00:07] [config] sqlite: ""
[2023-07-23 12:00:07] [config] sqlite-drop: false
[2023-07-23 12:00:07] [config] sync-freq: 200u
[2023-07-23 12:00:07] [config] sync-sgd: false
[2023-07-23 12:00:07] [config] tempdir: /tmp
[2023-07-23 12:00:07] [config] tied-embeddings: false
[2023-07-23 12:00:07] [config] tied-embeddings-all: true
[2023-07-23 12:00:07] [config] tied-embeddings-src: false
[2023-07-23 12:00:07] [config] train-embedder-rank:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] train-sets:
[2023-07-23 12:00:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 12:00:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 12:00:07] [config] transformer-aan-activation: swish
[2023-07-23 12:00:07] [config] transformer-aan-depth: 2
[2023-07-23 12:00:07] [config] transformer-aan-nogate: false
[2023-07-23 12:00:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 12:00:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 12:00:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 12:00:07] [config] transformer-depth-scaling: false
[2023-07-23 12:00:07] [config] transformer-dim-aan: 2048
[2023-07-23 12:00:07] [config] transformer-dim-ffn: 2048
[2023-07-23 12:00:07] [config] transformer-dropout: 0
[2023-07-23 12:00:07] [config] transformer-dropout-attention: 0
[2023-07-23 12:00:07] [config] transformer-dropout-ffn: 0
[2023-07-23 12:00:07] [config] transformer-ffn-activation: swish
[2023-07-23 12:00:07] [config] transformer-ffn-depth: 2
[2023-07-23 12:00:07] [config] transformer-guided-alignment-layer: last
[2023-07-23 12:00:07] [config] transformer-heads: 8
[2023-07-23 12:00:07] [config] transformer-no-projection: false
[2023-07-23 12:00:07] [config] transformer-pool: false
[2023-07-23 12:00:07] [config] transformer-postprocess: dan
[2023-07-23 12:00:07] [config] transformer-postprocess-emb: d
[2023-07-23 12:00:07] [config] transformer-postprocess-top: ""
[2023-07-23 12:00:07] [config] transformer-preprocess: ""
[2023-07-23 12:00:07] [config] transformer-tied-layers:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] transformer-train-position-embeddings: false
[2023-07-23 12:00:07] [config] tsv: false
[2023-07-23 12:00:07] [config] tsv-fields: 0
[2023-07-23 12:00:07] [config] type: amun
[2023-07-23 12:00:07] [config] ulr: false
[2023-07-23 12:00:07] [config] ulr-dim-emb: 0
[2023-07-23 12:00:07] [config] ulr-dropout: 0
[2023-07-23 12:00:07] [config] ulr-keys-vectors: ""
[2023-07-23 12:00:07] [config] ulr-query-vectors: ""
[2023-07-23 12:00:07] [config] ulr-softmax-temperature: 1
[2023-07-23 12:00:07] [config] ulr-trainable-transformation: false
[2023-07-23 12:00:07] [config] unlikelihood-loss: false
[2023-07-23 12:00:07] [config] valid-freq: 50000000
[2023-07-23 12:00:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 12:00:07] [config] valid-max-length: 1000
[2023-07-23 12:00:07] [config] valid-metrics:
[2023-07-23 12:00:07] [config]   - cross-entropy
[2023-07-23 12:00:07] [config]   - translation
[2023-07-23 12:00:07] [config] valid-mini-batch: 32
[2023-07-23 12:00:07] [config] valid-reset-stalled: false
[2023-07-23 12:00:07] [config] valid-script-args:
[2023-07-23 12:00:07] [config]   []
[2023-07-23 12:00:07] [config] valid-script-path: ""
[2023-07-23 12:00:07] [config] valid-sets:
[2023-07-23 12:00:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 12:00:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 12:00:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 12:00:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 12:00:07] [config] vocabs:
[2023-07-23 12:00:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 12:00:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 12:00:07] [config] word-penalty: 0
[2023-07-23 12:00:07] [config] word-scores: false
[2023-07-23 12:00:07] [config] workspace: 5500
[2023-07-23 12:00:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 12:00:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 12:00:07] [training] Using single-device training
[2023-07-23 12:00:08] Synced seed 1234
[2023-07-23 12:00:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 12:00:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 12:00:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 12:00:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 12:00:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 12:00:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 12:00:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 12:00:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 12:00:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 12:00:09] [comm] Using global sharding
[2023-07-23 12:00:09] [comm] NCCLCommunicators constructed successfully
[2023-07-23 12:00:09] [training] Using 1 GPUs
[2023-07-23 12:00:09] [logits] Applying loss function for 1 factor(s)
[2023-07-23 12:00:09] [memory] Reserving 80 MB, device gpu0
[2023-07-23 12:00:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 12:00:10] [memory] Reserving 80 MB, device gpu0
[2023-07-23 12:36:13] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 12:36:13] [valid] No post-processing script given for validating translator
[2023-07-23 12:36:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 12:36:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 12:36:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 12:36:13] [comm] Using global sharding
[2023-07-23 12:36:13] [comm] NCCLCommunicators constructed successfully
[2023-07-23 12:36:13] [training] Using 1 GPUs
[2023-07-23 12:36:13] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 12:36:21] Allocating memory for general optimizer shards
[2023-07-23 12:36:21] [memory] Reserving 322 MB, device gpu0
[2023-07-23 12:36:21] Loading Adam parameters
[2023-07-23 12:36:21] [memory] Reserving 322 MB, device gpu0
[2023-07-23 12:36:21] [memory] Reserving 80 MB, device gpu0
[2023-07-23 12:36:22] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 12:36:22] [data] Restoring the corpus state to epoch 121, batch 5319
[2023-07-23 12:36:22] [data] Shuffling data
[2023-07-23 12:36:22] [data] Done reading 20,192 sentences
[2023-07-23 12:36:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 12:36:22] Training started
[2023-07-23 12:36:22] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 12:36:22] [memory] Reserving 80 MB, device gpu0
[2023-07-23 12:36:30] Parameter type float16, optimization type float32, casting types true
[2023-07-23 12:41:04] Seen 20,192 samples
[2023-07-23 12:41:04] Starting data epoch 122 in logical epoch 122
[2023-07-23 12:41:04] [data] Shuffling data
[2023-07-23 12:41:04] [data] Done reading 20,192 sentences
[2023-07-23 12:41:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 12:45:49] Seen 20,192 samples
[2023-07-23 12:45:49] Starting data epoch 123 in logical epoch 123
[2023-07-23 12:45:49] [data] Shuffling data
[2023-07-23 12:45:49] [data] Done reading 20,192 sentences
[2023-07-23 12:45:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 12:50:43] Seen 20,192 samples
[2023-07-23 12:50:43] Starting data epoch 124 in logical epoch 124
[2023-07-23 12:50:43] [data] Shuffling data
[2023-07-23 12:50:43] [data] Done reading 20,192 sentences
[2023-07-23 12:50:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 12:55:27] Seen 20,192 samples
[2023-07-23 12:55:27] Starting data epoch 125 in logical epoch 125
[2023-07-23 12:55:27] [data] Shuffling data
[2023-07-23 12:55:27] [data] Done reading 20,192 sentences
[2023-07-23 12:55:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 13:00:14] Seen 20,192 samples
[2023-07-23 13:00:14] Starting data epoch 126 in logical epoch 126
[2023-07-23 13:00:14] [data] Shuffling data
[2023-07-23 13:00:14] [data] Done reading 20,192 sentences
[2023-07-23 13:00:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 13:05:00] Seen 20,192 samples
[2023-07-23 13:05:00] Starting data epoch 127 in logical epoch 127
[2023-07-23 13:05:00] [data] Shuffling data
[2023-07-23 13:05:00] [data] Done reading 20,192 sentences
[2023-07-23 13:05:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 13:09:32] Seen 20,192 samples
[2023-07-23 13:09:32] Starting data epoch 128 in logical epoch 128
[2023-07-23 13:09:32] [data] Shuffling data
[2023-07-23 13:09:32] [data] Done reading 20,192 sentences
[2023-07-23 13:09:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 13:14:14] Seen 20,192 samples
[2023-07-23 13:14:14] Starting data epoch 129 in logical epoch 129
[2023-07-23 13:14:14] [data] Shuffling data
[2023-07-23 13:14:14] [data] Done reading 20,192 sentences
[2023-07-23 13:14:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 13:18:48] Seen 20,192 samples
[2023-07-23 13:18:48] Starting data epoch 130 in logical epoch 130
[2023-07-23 13:18:48] [data] Shuffling data
[2023-07-23 13:18:48] [data] Done reading 20,192 sentences
[2023-07-23 13:18:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 13:23:38] Seen 20,192 samples
[2023-07-23 13:23:38] Starting data epoch 131 in logical epoch 131
[2023-07-23 13:23:38] Training finished
[2023-07-23 13:23:49] [valid] Ep. 131 : Up. 5760 : cross-entropy : 132.307 : stalled 3 times (last best: 131.038)
[2023-07-23 13:26:19] [valid] Ep. 131 : Up. 5760 : translation : 0 : new best
[2023-07-23 13:26:19] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 13:26:21] Saving Adam parameters
[2023-07-23 13:26:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 13:26:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 13:26:29] [marian] Running on node22.datos.cluster.uy as process 17896 with command line:
[2023-07-23 13:26:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 13:26:29] [config] after: 0e
[2023-07-23 13:26:29] [config] after-batches: 0
[2023-07-23 13:26:29] [config] after-epochs: 140
[2023-07-23 13:26:29] [config] all-caps-every: 0
[2023-07-23 13:26:29] [config] allow-unk: false
[2023-07-23 13:26:29] [config] authors: false
[2023-07-23 13:26:29] [config] beam-size: 12
[2023-07-23 13:26:29] [config] bert-class-symbol: "[CLS]"
[2023-07-23 13:26:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 13:26:29] [config] bert-masking-fraction: 0.15
[2023-07-23 13:26:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 13:26:29] [config] bert-train-type-embeddings: true
[2023-07-23 13:26:29] [config] bert-type-vocab-size: 2
[2023-07-23 13:26:29] [config] build-info: ""
[2023-07-23 13:26:29] [config] check-gradient-nan: false
[2023-07-23 13:26:29] [config] check-nan: false
[2023-07-23 13:26:29] [config] cite: false
[2023-07-23 13:26:29] [config] clip-norm: 1
[2023-07-23 13:26:29] [config] cost-scaling:
[2023-07-23 13:26:29] [config]   - 256.f
[2023-07-23 13:26:29] [config]   - 1000
[2023-07-23 13:26:29] [config]   - 2.f
[2023-07-23 13:26:29] [config]   - 256.f
[2023-07-23 13:26:29] [config] cost-type: ce-sum
[2023-07-23 13:26:29] [config] cpu-threads: 0
[2023-07-23 13:26:29] [config] data-threads: 8
[2023-07-23 13:26:29] [config] data-weighting: ""
[2023-07-23 13:26:29] [config] data-weighting-type: sentence
[2023-07-23 13:26:29] [config] dec-cell: gru
[2023-07-23 13:26:29] [config] dec-cell-base-depth: 2
[2023-07-23 13:26:29] [config] dec-cell-high-depth: 1
[2023-07-23 13:26:29] [config] dec-depth: 1
[2023-07-23 13:26:29] [config] devices:
[2023-07-23 13:26:29] [config]   - 0
[2023-07-23 13:26:29] [config] dim-emb: 512
[2023-07-23 13:26:29] [config] dim-rnn: 1024
[2023-07-23 13:26:29] [config] dim-vocabs:
[2023-07-23 13:26:29] [config]   - 16384
[2023-07-23 13:26:29] [config]   - 16384
[2023-07-23 13:26:29] [config] disp-first: 0
[2023-07-23 13:26:29] [config] disp-freq: 1000u
[2023-07-23 13:26:29] [config] disp-label-counts: true
[2023-07-23 13:26:29] [config] dropout-rnn: 0
[2023-07-23 13:26:29] [config] dropout-src: 0
[2023-07-23 13:26:29] [config] dropout-trg: 0
[2023-07-23 13:26:29] [config] dump-config: ""
[2023-07-23 13:26:29] [config] dynamic-gradient-scaling:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] early-stopping: 200
[2023-07-23 13:26:29] [config] early-stopping-on: first
[2023-07-23 13:26:29] [config] embedding-fix-src: false
[2023-07-23 13:26:29] [config] embedding-fix-trg: false
[2023-07-23 13:26:29] [config] embedding-normalization: false
[2023-07-23 13:26:29] [config] embedding-vectors:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] enc-cell: gru
[2023-07-23 13:26:29] [config] enc-cell-depth: 1
[2023-07-23 13:26:29] [config] enc-depth: 1
[2023-07-23 13:26:29] [config] enc-type: bidirectional
[2023-07-23 13:26:29] [config] english-title-case-every: 0
[2023-07-23 13:26:29] [config] exponential-smoothing: 0
[2023-07-23 13:26:29] [config] factor-weight: 1
[2023-07-23 13:26:29] [config] factors-combine: sum
[2023-07-23 13:26:29] [config] factors-dim-emb: 0
[2023-07-23 13:26:29] [config] gradient-checkpointing: false
[2023-07-23 13:26:29] [config] gradient-norm-average-window: 100
[2023-07-23 13:26:29] [config] guided-alignment: none
[2023-07-23 13:26:29] [config] guided-alignment-cost: mse
[2023-07-23 13:26:29] [config] guided-alignment-weight: 0.1
[2023-07-23 13:26:29] [config] ignore-model-config: false
[2023-07-23 13:26:29] [config] input-types:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] interpolate-env-vars: false
[2023-07-23 13:26:29] [config] keep-best: false
[2023-07-23 13:26:29] [config] label-smoothing: 0
[2023-07-23 13:26:29] [config] layer-normalization: false
[2023-07-23 13:26:29] [config] learn-rate: 0.0001
[2023-07-23 13:26:29] [config] lemma-dependency: ""
[2023-07-23 13:26:29] [config] lemma-dim-emb: 0
[2023-07-23 13:26:29] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 13:26:29] [config] log-level: info
[2023-07-23 13:26:29] [config] log-time-zone: ""
[2023-07-23 13:26:29] [config] logical-epoch:
[2023-07-23 13:26:29] [config]   - 1e
[2023-07-23 13:26:29] [config]   - 0
[2023-07-23 13:26:29] [config] lr-decay: 0
[2023-07-23 13:26:29] [config] lr-decay-freq: 50000
[2023-07-23 13:26:29] [config] lr-decay-inv-sqrt:
[2023-07-23 13:26:29] [config]   - 0
[2023-07-23 13:26:29] [config] lr-decay-repeat-warmup: false
[2023-07-23 13:26:29] [config] lr-decay-reset-optimizer: false
[2023-07-23 13:26:29] [config] lr-decay-start:
[2023-07-23 13:26:29] [config]   - 10
[2023-07-23 13:26:29] [config]   - 1
[2023-07-23 13:26:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 13:26:29] [config] lr-report: false
[2023-07-23 13:26:29] [config] lr-warmup: 0
[2023-07-23 13:26:29] [config] lr-warmup-at-reload: false
[2023-07-23 13:26:29] [config] lr-warmup-cycle: false
[2023-07-23 13:26:29] [config] lr-warmup-start-rate: 0
[2023-07-23 13:26:29] [config] max-length: 200
[2023-07-23 13:26:29] [config] max-length-crop: true
[2023-07-23 13:26:29] [config] max-length-factor: 3
[2023-07-23 13:26:29] [config] maxi-batch: 100
[2023-07-23 13:26:29] [config] maxi-batch-sort: trg
[2023-07-23 13:26:29] [config] mini-batch: 64
[2023-07-23 13:26:29] [config] mini-batch-fit: true
[2023-07-23 13:26:29] [config] mini-batch-fit-step: 10
[2023-07-23 13:26:29] [config] mini-batch-round-up: true
[2023-07-23 13:26:29] [config] mini-batch-track-lr: false
[2023-07-23 13:26:29] [config] mini-batch-warmup: 0
[2023-07-23 13:26:29] [config] mini-batch-words: 0
[2023-07-23 13:26:29] [config] mini-batch-words-ref: 0
[2023-07-23 13:26:29] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 13:26:29] [config] multi-loss-type: sum
[2023-07-23 13:26:29] [config] n-best: false
[2023-07-23 13:26:29] [config] no-nccl: false
[2023-07-23 13:26:29] [config] no-reload: false
[2023-07-23 13:26:29] [config] no-restore-corpus: false
[2023-07-23 13:26:29] [config] normalize: 0
[2023-07-23 13:26:29] [config] normalize-gradient: false
[2023-07-23 13:26:29] [config] num-devices: 0
[2023-07-23 13:26:29] [config] optimizer: adam
[2023-07-23 13:26:29] [config] optimizer-delay: 1
[2023-07-23 13:26:29] [config] optimizer-params:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] output-omit-bias: false
[2023-07-23 13:26:29] [config] overwrite: true
[2023-07-23 13:26:29] [config] precision:
[2023-07-23 13:26:29] [config]   - float16
[2023-07-23 13:26:29] [config]   - float32
[2023-07-23 13:26:29] [config] pretrained-model: ""
[2023-07-23 13:26:29] [config] quantize-biases: false
[2023-07-23 13:26:29] [config] quantize-bits: 0
[2023-07-23 13:26:29] [config] quantize-log-based: false
[2023-07-23 13:26:29] [config] quantize-optimization-steps: 0
[2023-07-23 13:26:29] [config] quiet: false
[2023-07-23 13:26:29] [config] quiet-translation: true
[2023-07-23 13:26:29] [config] relative-paths: false
[2023-07-23 13:26:29] [config] right-left: false
[2023-07-23 13:26:29] [config] save-freq: 10000u
[2023-07-23 13:26:29] [config] seed: 1234
[2023-07-23 13:26:29] [config] sentencepiece-alphas:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] sentencepiece-max-lines: 2000000
[2023-07-23 13:26:29] [config] sentencepiece-options: ""
[2023-07-23 13:26:29] [config] sharding: global
[2023-07-23 13:26:29] [config] shuffle: data
[2023-07-23 13:26:29] [config] shuffle-in-ram: false
[2023-07-23 13:26:29] [config] sigterm: save-and-exit
[2023-07-23 13:26:29] [config] skip: false
[2023-07-23 13:26:29] [config] sqlite: ""
[2023-07-23 13:26:29] [config] sqlite-drop: false
[2023-07-23 13:26:29] [config] sync-freq: 200u
[2023-07-23 13:26:29] [config] sync-sgd: false
[2023-07-23 13:26:29] [config] tempdir: /tmp
[2023-07-23 13:26:29] [config] tied-embeddings: false
[2023-07-23 13:26:29] [config] tied-embeddings-all: true
[2023-07-23 13:26:29] [config] tied-embeddings-src: false
[2023-07-23 13:26:29] [config] train-embedder-rank:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] train-sets:
[2023-07-23 13:26:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 13:26:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 13:26:29] [config] transformer-aan-activation: swish
[2023-07-23 13:26:29] [config] transformer-aan-depth: 2
[2023-07-23 13:26:29] [config] transformer-aan-nogate: false
[2023-07-23 13:26:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 13:26:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 13:26:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 13:26:29] [config] transformer-depth-scaling: false
[2023-07-23 13:26:29] [config] transformer-dim-aan: 2048
[2023-07-23 13:26:29] [config] transformer-dim-ffn: 2048
[2023-07-23 13:26:29] [config] transformer-dropout: 0
[2023-07-23 13:26:29] [config] transformer-dropout-attention: 0
[2023-07-23 13:26:29] [config] transformer-dropout-ffn: 0
[2023-07-23 13:26:29] [config] transformer-ffn-activation: swish
[2023-07-23 13:26:29] [config] transformer-ffn-depth: 2
[2023-07-23 13:26:29] [config] transformer-guided-alignment-layer: last
[2023-07-23 13:26:29] [config] transformer-heads: 8
[2023-07-23 13:26:29] [config] transformer-no-projection: false
[2023-07-23 13:26:29] [config] transformer-pool: false
[2023-07-23 13:26:29] [config] transformer-postprocess: dan
[2023-07-23 13:26:29] [config] transformer-postprocess-emb: d
[2023-07-23 13:26:29] [config] transformer-postprocess-top: ""
[2023-07-23 13:26:29] [config] transformer-preprocess: ""
[2023-07-23 13:26:29] [config] transformer-tied-layers:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] transformer-train-position-embeddings: false
[2023-07-23 13:26:29] [config] tsv: false
[2023-07-23 13:26:29] [config] tsv-fields: 0
[2023-07-23 13:26:29] [config] type: amun
[2023-07-23 13:26:29] [config] ulr: false
[2023-07-23 13:26:29] [config] ulr-dim-emb: 0
[2023-07-23 13:26:29] [config] ulr-dropout: 0
[2023-07-23 13:26:29] [config] ulr-keys-vectors: ""
[2023-07-23 13:26:29] [config] ulr-query-vectors: ""
[2023-07-23 13:26:29] [config] ulr-softmax-temperature: 1
[2023-07-23 13:26:29] [config] ulr-trainable-transformation: false
[2023-07-23 13:26:29] [config] unlikelihood-loss: false
[2023-07-23 13:26:29] [config] valid-freq: 50000000
[2023-07-23 13:26:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 13:26:29] [config] valid-max-length: 1000
[2023-07-23 13:26:29] [config] valid-metrics:
[2023-07-23 13:26:29] [config]   - cross-entropy
[2023-07-23 13:26:29] [config]   - translation
[2023-07-23 13:26:29] [config] valid-mini-batch: 32
[2023-07-23 13:26:29] [config] valid-reset-stalled: false
[2023-07-23 13:26:29] [config] valid-script-args:
[2023-07-23 13:26:29] [config]   []
[2023-07-23 13:26:29] [config] valid-script-path: ""
[2023-07-23 13:26:29] [config] valid-sets:
[2023-07-23 13:26:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 13:26:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 13:26:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 13:26:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 13:26:29] [config] vocabs:
[2023-07-23 13:26:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 13:26:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 13:26:29] [config] word-penalty: 0
[2023-07-23 13:26:29] [config] word-scores: false
[2023-07-23 13:26:29] [config] workspace: 5500
[2023-07-23 13:26:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 13:26:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 13:26:29] [training] Using single-device training
[2023-07-23 13:26:29] Synced seed 1234
[2023-07-23 13:26:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 13:26:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 13:26:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 13:26:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 13:26:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 13:26:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 13:26:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 13:26:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 13:26:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 13:26:30] [comm] Using global sharding
[2023-07-23 13:26:31] [comm] NCCLCommunicators constructed successfully
[2023-07-23 13:26:31] [training] Using 1 GPUs
[2023-07-23 13:26:31] [logits] Applying loss function for 1 factor(s)
[2023-07-23 13:26:31] [memory] Reserving 80 MB, device gpu0
[2023-07-23 13:26:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 13:26:31] [memory] Reserving 80 MB, device gpu0
[2023-07-23 14:01:00] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 14:01:00] [valid] No post-processing script given for validating translator
[2023-07-23 14:01:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 14:01:00] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 14:01:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 14:01:00] [comm] Using global sharding
[2023-07-23 14:01:00] [comm] NCCLCommunicators constructed successfully
[2023-07-23 14:01:00] [training] Using 1 GPUs
[2023-07-23 14:01:00] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 14:01:08] Allocating memory for general optimizer shards
[2023-07-23 14:01:08] [memory] Reserving 322 MB, device gpu0
[2023-07-23 14:01:08] Loading Adam parameters
[2023-07-23 14:01:08] [memory] Reserving 322 MB, device gpu0
[2023-07-23 14:01:08] [memory] Reserving 80 MB, device gpu0
[2023-07-23 14:01:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 14:01:09] [data] Restoring the corpus state to epoch 131, batch 5760
[2023-07-23 14:01:09] [data] Shuffling data
[2023-07-23 14:01:09] [data] Done reading 20,192 sentences
[2023-07-23 14:01:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:01:09] Training started
[2023-07-23 14:01:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 14:01:09] [memory] Reserving 80 MB, device gpu0
[2023-07-23 14:01:14] Parameter type float16, optimization type float32, casting types true
[2023-07-23 14:05:35] Seen 20,192 samples
[2023-07-23 14:05:35] Starting data epoch 132 in logical epoch 132
[2023-07-23 14:05:35] [data] Shuffling data
[2023-07-23 14:05:35] [data] Done reading 20,192 sentences
[2023-07-23 14:05:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:10:21] Seen 20,192 samples
[2023-07-23 14:10:21] Starting data epoch 133 in logical epoch 133
[2023-07-23 14:10:21] [data] Shuffling data
[2023-07-23 14:10:21] [data] Done reading 20,192 sentences
[2023-07-23 14:10:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:15:00] Seen 20,192 samples
[2023-07-23 14:15:00] Starting data epoch 134 in logical epoch 134
[2023-07-23 14:15:00] [data] Shuffling data
[2023-07-23 14:15:00] [data] Done reading 20,192 sentences
[2023-07-23 14:15:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:19:32] Seen 20,192 samples
[2023-07-23 14:19:32] Starting data epoch 135 in logical epoch 135
[2023-07-23 14:19:32] [data] Shuffling data
[2023-07-23 14:19:32] [data] Done reading 20,192 sentences
[2023-07-23 14:19:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:24:23] Seen 20,192 samples
[2023-07-23 14:24:23] Starting data epoch 136 in logical epoch 136
[2023-07-23 14:24:23] [data] Shuffling data
[2023-07-23 14:24:23] [data] Done reading 20,192 sentences
[2023-07-23 14:24:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:26:29] Ep. 136 : Up. 6000 : Sen. 9,104 : Cost 3.64344954 * 12,253,280 @ 8,442 after 73,692,418 : Time 1528.85s : 8014.68 words/s : gNorm 1.5990
[2023-07-23 14:29:16] Seen 20,192 samples
[2023-07-23 14:29:16] Starting data epoch 137 in logical epoch 137
[2023-07-23 14:29:16] [data] Shuffling data
[2023-07-23 14:29:16] [data] Done reading 20,192 sentences
[2023-07-23 14:29:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:33:58] Seen 20,192 samples
[2023-07-23 14:33:58] Starting data epoch 138 in logical epoch 138
[2023-07-23 14:33:58] [data] Shuffling data
[2023-07-23 14:33:58] [data] Done reading 20,192 sentences
[2023-07-23 14:33:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:38:48] Seen 20,192 samples
[2023-07-23 14:38:48] Starting data epoch 139 in logical epoch 139
[2023-07-23 14:38:48] [data] Shuffling data
[2023-07-23 14:38:48] [data] Done reading 20,192 sentences
[2023-07-23 14:38:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:43:28] Seen 20,192 samples
[2023-07-23 14:43:28] Starting data epoch 140 in logical epoch 140
[2023-07-23 14:43:28] [data] Shuffling data
[2023-07-23 14:43:28] [data] Done reading 20,192 sentences
[2023-07-23 14:43:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 14:48:14] Seen 20,192 samples
[2023-07-23 14:48:14] Starting data epoch 141 in logical epoch 141
[2023-07-23 14:48:14] Training finished
[2023-07-23 14:48:25] [valid] Ep. 141 : Up. 6204 : cross-entropy : 133.235 : stalled 4 times (last best: 131.038)
[2023-07-23 14:50:49] [valid] Ep. 141 : Up. 6204 : translation : 0 : new best
[2023-07-23 14:50:49] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 14:50:52] Saving Adam parameters
[2023-07-23 14:50:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 14:50:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 14:50:59] [marian] Running on node22.datos.cluster.uy as process 23046 with command line:
[2023-07-23 14:50:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 14:50:59] [config] after: 0e
[2023-07-23 14:50:59] [config] after-batches: 0
[2023-07-23 14:50:59] [config] after-epochs: 150
[2023-07-23 14:50:59] [config] all-caps-every: 0
[2023-07-23 14:50:59] [config] allow-unk: false
[2023-07-23 14:50:59] [config] authors: false
[2023-07-23 14:50:59] [config] beam-size: 12
[2023-07-23 14:50:59] [config] bert-class-symbol: "[CLS]"
[2023-07-23 14:50:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 14:50:59] [config] bert-masking-fraction: 0.15
[2023-07-23 14:50:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 14:50:59] [config] bert-train-type-embeddings: true
[2023-07-23 14:50:59] [config] bert-type-vocab-size: 2
[2023-07-23 14:50:59] [config] build-info: ""
[2023-07-23 14:50:59] [config] check-gradient-nan: false
[2023-07-23 14:50:59] [config] check-nan: false
[2023-07-23 14:50:59] [config] cite: false
[2023-07-23 14:50:59] [config] clip-norm: 1
[2023-07-23 14:50:59] [config] cost-scaling:
[2023-07-23 14:50:59] [config]   - 256.f
[2023-07-23 14:50:59] [config]   - 1000
[2023-07-23 14:50:59] [config]   - 2.f
[2023-07-23 14:50:59] [config]   - 256.f
[2023-07-23 14:50:59] [config] cost-type: ce-sum
[2023-07-23 14:50:59] [config] cpu-threads: 0
[2023-07-23 14:50:59] [config] data-threads: 8
[2023-07-23 14:50:59] [config] data-weighting: ""
[2023-07-23 14:50:59] [config] data-weighting-type: sentence
[2023-07-23 14:50:59] [config] dec-cell: gru
[2023-07-23 14:50:59] [config] dec-cell-base-depth: 2
[2023-07-23 14:50:59] [config] dec-cell-high-depth: 1
[2023-07-23 14:50:59] [config] dec-depth: 1
[2023-07-23 14:50:59] [config] devices:
[2023-07-23 14:50:59] [config]   - 0
[2023-07-23 14:50:59] [config] dim-emb: 512
[2023-07-23 14:50:59] [config] dim-rnn: 1024
[2023-07-23 14:50:59] [config] dim-vocabs:
[2023-07-23 14:50:59] [config]   - 16384
[2023-07-23 14:50:59] [config]   - 16384
[2023-07-23 14:50:59] [config] disp-first: 0
[2023-07-23 14:50:59] [config] disp-freq: 1000u
[2023-07-23 14:50:59] [config] disp-label-counts: true
[2023-07-23 14:50:59] [config] dropout-rnn: 0
[2023-07-23 14:50:59] [config] dropout-src: 0
[2023-07-23 14:50:59] [config] dropout-trg: 0
[2023-07-23 14:50:59] [config] dump-config: ""
[2023-07-23 14:50:59] [config] dynamic-gradient-scaling:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] early-stopping: 200
[2023-07-23 14:50:59] [config] early-stopping-on: first
[2023-07-23 14:50:59] [config] embedding-fix-src: false
[2023-07-23 14:50:59] [config] embedding-fix-trg: false
[2023-07-23 14:50:59] [config] embedding-normalization: false
[2023-07-23 14:50:59] [config] embedding-vectors:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] enc-cell: gru
[2023-07-23 14:50:59] [config] enc-cell-depth: 1
[2023-07-23 14:50:59] [config] enc-depth: 1
[2023-07-23 14:50:59] [config] enc-type: bidirectional
[2023-07-23 14:50:59] [config] english-title-case-every: 0
[2023-07-23 14:50:59] [config] exponential-smoothing: 0
[2023-07-23 14:50:59] [config] factor-weight: 1
[2023-07-23 14:50:59] [config] factors-combine: sum
[2023-07-23 14:50:59] [config] factors-dim-emb: 0
[2023-07-23 14:50:59] [config] gradient-checkpointing: false
[2023-07-23 14:50:59] [config] gradient-norm-average-window: 100
[2023-07-23 14:50:59] [config] guided-alignment: none
[2023-07-23 14:50:59] [config] guided-alignment-cost: mse
[2023-07-23 14:50:59] [config] guided-alignment-weight: 0.1
[2023-07-23 14:50:59] [config] ignore-model-config: false
[2023-07-23 14:50:59] [config] input-types:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] interpolate-env-vars: false
[2023-07-23 14:50:59] [config] keep-best: false
[2023-07-23 14:50:59] [config] label-smoothing: 0
[2023-07-23 14:50:59] [config] layer-normalization: false
[2023-07-23 14:50:59] [config] learn-rate: 0.0001
[2023-07-23 14:50:59] [config] lemma-dependency: ""
[2023-07-23 14:50:59] [config] lemma-dim-emb: 0
[2023-07-23 14:50:59] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 14:50:59] [config] log-level: info
[2023-07-23 14:50:59] [config] log-time-zone: ""
[2023-07-23 14:50:59] [config] logical-epoch:
[2023-07-23 14:50:59] [config]   - 1e
[2023-07-23 14:50:59] [config]   - 0
[2023-07-23 14:50:59] [config] lr-decay: 0
[2023-07-23 14:50:59] [config] lr-decay-freq: 50000
[2023-07-23 14:50:59] [config] lr-decay-inv-sqrt:
[2023-07-23 14:50:59] [config]   - 0
[2023-07-23 14:50:59] [config] lr-decay-repeat-warmup: false
[2023-07-23 14:50:59] [config] lr-decay-reset-optimizer: false
[2023-07-23 14:50:59] [config] lr-decay-start:
[2023-07-23 14:50:59] [config]   - 10
[2023-07-23 14:50:59] [config]   - 1
[2023-07-23 14:50:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 14:50:59] [config] lr-report: false
[2023-07-23 14:50:59] [config] lr-warmup: 0
[2023-07-23 14:50:59] [config] lr-warmup-at-reload: false
[2023-07-23 14:50:59] [config] lr-warmup-cycle: false
[2023-07-23 14:50:59] [config] lr-warmup-start-rate: 0
[2023-07-23 14:50:59] [config] max-length: 200
[2023-07-23 14:50:59] [config] max-length-crop: true
[2023-07-23 14:50:59] [config] max-length-factor: 3
[2023-07-23 14:50:59] [config] maxi-batch: 100
[2023-07-23 14:50:59] [config] maxi-batch-sort: trg
[2023-07-23 14:50:59] [config] mini-batch: 64
[2023-07-23 14:50:59] [config] mini-batch-fit: true
[2023-07-23 14:50:59] [config] mini-batch-fit-step: 10
[2023-07-23 14:50:59] [config] mini-batch-round-up: true
[2023-07-23 14:50:59] [config] mini-batch-track-lr: false
[2023-07-23 14:50:59] [config] mini-batch-warmup: 0
[2023-07-23 14:50:59] [config] mini-batch-words: 0
[2023-07-23 14:50:59] [config] mini-batch-words-ref: 0
[2023-07-23 14:50:59] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 14:50:59] [config] multi-loss-type: sum
[2023-07-23 14:50:59] [config] n-best: false
[2023-07-23 14:50:59] [config] no-nccl: false
[2023-07-23 14:50:59] [config] no-reload: false
[2023-07-23 14:50:59] [config] no-restore-corpus: false
[2023-07-23 14:50:59] [config] normalize: 0
[2023-07-23 14:50:59] [config] normalize-gradient: false
[2023-07-23 14:50:59] [config] num-devices: 0
[2023-07-23 14:50:59] [config] optimizer: adam
[2023-07-23 14:50:59] [config] optimizer-delay: 1
[2023-07-23 14:50:59] [config] optimizer-params:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] output-omit-bias: false
[2023-07-23 14:50:59] [config] overwrite: true
[2023-07-23 14:50:59] [config] precision:
[2023-07-23 14:50:59] [config]   - float16
[2023-07-23 14:50:59] [config]   - float32
[2023-07-23 14:50:59] [config] pretrained-model: ""
[2023-07-23 14:50:59] [config] quantize-biases: false
[2023-07-23 14:50:59] [config] quantize-bits: 0
[2023-07-23 14:50:59] [config] quantize-log-based: false
[2023-07-23 14:50:59] [config] quantize-optimization-steps: 0
[2023-07-23 14:50:59] [config] quiet: false
[2023-07-23 14:50:59] [config] quiet-translation: true
[2023-07-23 14:50:59] [config] relative-paths: false
[2023-07-23 14:50:59] [config] right-left: false
[2023-07-23 14:50:59] [config] save-freq: 10000u
[2023-07-23 14:50:59] [config] seed: 1234
[2023-07-23 14:50:59] [config] sentencepiece-alphas:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] sentencepiece-max-lines: 2000000
[2023-07-23 14:50:59] [config] sentencepiece-options: ""
[2023-07-23 14:50:59] [config] sharding: global
[2023-07-23 14:50:59] [config] shuffle: data
[2023-07-23 14:50:59] [config] shuffle-in-ram: false
[2023-07-23 14:50:59] [config] sigterm: save-and-exit
[2023-07-23 14:50:59] [config] skip: false
[2023-07-23 14:50:59] [config] sqlite: ""
[2023-07-23 14:50:59] [config] sqlite-drop: false
[2023-07-23 14:50:59] [config] sync-freq: 200u
[2023-07-23 14:50:59] [config] sync-sgd: false
[2023-07-23 14:50:59] [config] tempdir: /tmp
[2023-07-23 14:50:59] [config] tied-embeddings: false
[2023-07-23 14:50:59] [config] tied-embeddings-all: true
[2023-07-23 14:50:59] [config] tied-embeddings-src: false
[2023-07-23 14:50:59] [config] train-embedder-rank:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] train-sets:
[2023-07-23 14:50:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 14:50:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 14:50:59] [config] transformer-aan-activation: swish
[2023-07-23 14:50:59] [config] transformer-aan-depth: 2
[2023-07-23 14:50:59] [config] transformer-aan-nogate: false
[2023-07-23 14:50:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 14:50:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 14:50:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 14:50:59] [config] transformer-depth-scaling: false
[2023-07-23 14:50:59] [config] transformer-dim-aan: 2048
[2023-07-23 14:50:59] [config] transformer-dim-ffn: 2048
[2023-07-23 14:50:59] [config] transformer-dropout: 0
[2023-07-23 14:50:59] [config] transformer-dropout-attention: 0
[2023-07-23 14:50:59] [config] transformer-dropout-ffn: 0
[2023-07-23 14:50:59] [config] transformer-ffn-activation: swish
[2023-07-23 14:50:59] [config] transformer-ffn-depth: 2
[2023-07-23 14:50:59] [config] transformer-guided-alignment-layer: last
[2023-07-23 14:50:59] [config] transformer-heads: 8
[2023-07-23 14:50:59] [config] transformer-no-projection: false
[2023-07-23 14:50:59] [config] transformer-pool: false
[2023-07-23 14:50:59] [config] transformer-postprocess: dan
[2023-07-23 14:50:59] [config] transformer-postprocess-emb: d
[2023-07-23 14:50:59] [config] transformer-postprocess-top: ""
[2023-07-23 14:50:59] [config] transformer-preprocess: ""
[2023-07-23 14:50:59] [config] transformer-tied-layers:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] transformer-train-position-embeddings: false
[2023-07-23 14:50:59] [config] tsv: false
[2023-07-23 14:50:59] [config] tsv-fields: 0
[2023-07-23 14:50:59] [config] type: amun
[2023-07-23 14:50:59] [config] ulr: false
[2023-07-23 14:50:59] [config] ulr-dim-emb: 0
[2023-07-23 14:50:59] [config] ulr-dropout: 0
[2023-07-23 14:50:59] [config] ulr-keys-vectors: ""
[2023-07-23 14:50:59] [config] ulr-query-vectors: ""
[2023-07-23 14:50:59] [config] ulr-softmax-temperature: 1
[2023-07-23 14:50:59] [config] ulr-trainable-transformation: false
[2023-07-23 14:50:59] [config] unlikelihood-loss: false
[2023-07-23 14:50:59] [config] valid-freq: 50000000
[2023-07-23 14:50:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 14:50:59] [config] valid-max-length: 1000
[2023-07-23 14:50:59] [config] valid-metrics:
[2023-07-23 14:50:59] [config]   - cross-entropy
[2023-07-23 14:50:59] [config]   - translation
[2023-07-23 14:50:59] [config] valid-mini-batch: 32
[2023-07-23 14:50:59] [config] valid-reset-stalled: false
[2023-07-23 14:50:59] [config] valid-script-args:
[2023-07-23 14:50:59] [config]   []
[2023-07-23 14:50:59] [config] valid-script-path: ""
[2023-07-23 14:50:59] [config] valid-sets:
[2023-07-23 14:50:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 14:50:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 14:50:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 14:50:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 14:50:59] [config] vocabs:
[2023-07-23 14:50:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 14:50:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 14:50:59] [config] word-penalty: 0
[2023-07-23 14:50:59] [config] word-scores: false
[2023-07-23 14:50:59] [config] workspace: 5500
[2023-07-23 14:50:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 14:50:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 14:50:59] [training] Using single-device training
[2023-07-23 14:51:00] Synced seed 1234
[2023-07-23 14:51:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 14:51:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 14:51:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 14:51:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 14:51:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 14:51:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 14:51:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 14:51:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 14:51:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 14:51:01] [comm] Using global sharding
[2023-07-23 14:51:02] [comm] NCCLCommunicators constructed successfully
[2023-07-23 14:51:02] [training] Using 1 GPUs
[2023-07-23 14:51:02] [logits] Applying loss function for 1 factor(s)
[2023-07-23 14:51:02] [memory] Reserving 80 MB, device gpu0
[2023-07-23 14:51:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 14:51:02] [memory] Reserving 80 MB, device gpu0
[2023-07-23 15:27:17] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 15:27:17] [valid] No post-processing script given for validating translator
[2023-07-23 15:27:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 15:27:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 15:27:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 15:27:17] [comm] Using global sharding
[2023-07-23 15:27:17] [comm] NCCLCommunicators constructed successfully
[2023-07-23 15:27:17] [training] Using 1 GPUs
[2023-07-23 15:27:17] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 15:27:22] Allocating memory for general optimizer shards
[2023-07-23 15:27:22] [memory] Reserving 322 MB, device gpu0
[2023-07-23 15:27:22] Loading Adam parameters
[2023-07-23 15:27:23] [memory] Reserving 322 MB, device gpu0
[2023-07-23 15:27:23] [memory] Reserving 80 MB, device gpu0
[2023-07-23 15:27:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 15:27:23] [data] Restoring the corpus state to epoch 141, batch 6204
[2023-07-23 15:27:23] [data] Shuffling data
[2023-07-23 15:27:23] [data] Done reading 20,192 sentences
[2023-07-23 15:27:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 15:27:23] Training started
[2023-07-23 15:27:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 15:27:23] [memory] Reserving 80 MB, device gpu0
[2023-07-23 15:27:28] Parameter type float16, optimization type float32, casting types true
[2023-07-23 15:31:46] Seen 20,192 samples
[2023-07-23 15:31:46] Starting data epoch 142 in logical epoch 142
[2023-07-23 15:31:46] [data] Shuffling data
[2023-07-23 15:31:46] [data] Done reading 20,192 sentences
[2023-07-23 15:31:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 15:36:09] Seen 20,192 samples
[2023-07-23 15:36:09] Starting data epoch 143 in logical epoch 143
[2023-07-23 15:36:09] [data] Shuffling data
[2023-07-23 15:36:09] [data] Done reading 20,192 sentences
[2023-07-23 15:36:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 15:40:56] Seen 20,192 samples
[2023-07-23 15:40:56] Starting data epoch 144 in logical epoch 144
[2023-07-23 15:40:56] [data] Shuffling data
[2023-07-23 15:40:56] [data] Done reading 20,192 sentences
[2023-07-23 15:40:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 15:45:38] Seen 20,192 samples
[2023-07-23 15:45:38] Starting data epoch 145 in logical epoch 145
[2023-07-23 15:45:38] [data] Shuffling data
[2023-07-23 15:45:39] [data] Done reading 20,192 sentences
[2023-07-23 15:45:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 15:50:27] Seen 20,192 samples
[2023-07-23 15:50:27] Starting data epoch 146 in logical epoch 146
[2023-07-23 15:50:27] [data] Shuffling data
[2023-07-23 15:50:27] [data] Done reading 20,192 sentences
[2023-07-23 15:50:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 15:55:12] Seen 20,192 samples
[2023-07-23 15:55:12] Starting data epoch 147 in logical epoch 147
[2023-07-23 15:55:12] [data] Shuffling data
[2023-07-23 15:55:12] [data] Done reading 20,192 sentences
[2023-07-23 15:55:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 15:59:55] Seen 20,192 samples
[2023-07-23 15:59:55] Starting data epoch 148 in logical epoch 148
[2023-07-23 15:59:55] [data] Shuffling data
[2023-07-23 15:59:55] [data] Done reading 20,192 sentences
[2023-07-23 15:59:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 16:04:38] Seen 20,192 samples
[2023-07-23 16:04:38] Starting data epoch 149 in logical epoch 149
[2023-07-23 16:04:38] [data] Shuffling data
[2023-07-23 16:04:38] [data] Done reading 20,192 sentences
[2023-07-23 16:04:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 16:09:29] Seen 20,192 samples
[2023-07-23 16:09:29] Starting data epoch 150 in logical epoch 150
[2023-07-23 16:09:29] [data] Shuffling data
[2023-07-23 16:09:29] [data] Done reading 20,192 sentences
[2023-07-23 16:09:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 16:14:13] Seen 20,192 samples
[2023-07-23 16:14:13] Starting data epoch 151 in logical epoch 151
[2023-07-23 16:14:13] Training finished
[2023-07-23 16:14:24] [valid] Ep. 151 : Up. 6646 : cross-entropy : 134.614 : stalled 5 times (last best: 131.038)
[2023-07-23 16:16:54] [valid] Ep. 151 : Up. 6646 : translation : 0 : new best
[2023-07-23 16:16:54] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 16:16:57] Saving Adam parameters
[2023-07-23 16:16:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 16:17:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 16:17:04] [marian] Running on node22.datos.cluster.uy as process 28579 with command line:
[2023-07-23 16:17:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 16:17:04] [config] after: 0e
[2023-07-23 16:17:04] [config] after-batches: 0
[2023-07-23 16:17:04] [config] after-epochs: 160
[2023-07-23 16:17:04] [config] all-caps-every: 0
[2023-07-23 16:17:04] [config] allow-unk: false
[2023-07-23 16:17:04] [config] authors: false
[2023-07-23 16:17:04] [config] beam-size: 12
[2023-07-23 16:17:04] [config] bert-class-symbol: "[CLS]"
[2023-07-23 16:17:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 16:17:04] [config] bert-masking-fraction: 0.15
[2023-07-23 16:17:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 16:17:04] [config] bert-train-type-embeddings: true
[2023-07-23 16:17:04] [config] bert-type-vocab-size: 2
[2023-07-23 16:17:04] [config] build-info: ""
[2023-07-23 16:17:04] [config] check-gradient-nan: false
[2023-07-23 16:17:04] [config] check-nan: false
[2023-07-23 16:17:04] [config] cite: false
[2023-07-23 16:17:04] [config] clip-norm: 1
[2023-07-23 16:17:04] [config] cost-scaling:
[2023-07-23 16:17:04] [config]   - 256.f
[2023-07-23 16:17:04] [config]   - 1000
[2023-07-23 16:17:04] [config]   - 2.f
[2023-07-23 16:17:04] [config]   - 256.f
[2023-07-23 16:17:04] [config] cost-type: ce-sum
[2023-07-23 16:17:04] [config] cpu-threads: 0
[2023-07-23 16:17:04] [config] data-threads: 8
[2023-07-23 16:17:04] [config] data-weighting: ""
[2023-07-23 16:17:04] [config] data-weighting-type: sentence
[2023-07-23 16:17:04] [config] dec-cell: gru
[2023-07-23 16:17:04] [config] dec-cell-base-depth: 2
[2023-07-23 16:17:04] [config] dec-cell-high-depth: 1
[2023-07-23 16:17:04] [config] dec-depth: 1
[2023-07-23 16:17:04] [config] devices:
[2023-07-23 16:17:04] [config]   - 0
[2023-07-23 16:17:04] [config] dim-emb: 512
[2023-07-23 16:17:04] [config] dim-rnn: 1024
[2023-07-23 16:17:04] [config] dim-vocabs:
[2023-07-23 16:17:04] [config]   - 16384
[2023-07-23 16:17:04] [config]   - 16384
[2023-07-23 16:17:04] [config] disp-first: 0
[2023-07-23 16:17:04] [config] disp-freq: 1000u
[2023-07-23 16:17:04] [config] disp-label-counts: true
[2023-07-23 16:17:04] [config] dropout-rnn: 0
[2023-07-23 16:17:04] [config] dropout-src: 0
[2023-07-23 16:17:04] [config] dropout-trg: 0
[2023-07-23 16:17:04] [config] dump-config: ""
[2023-07-23 16:17:04] [config] dynamic-gradient-scaling:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] early-stopping: 200
[2023-07-23 16:17:04] [config] early-stopping-on: first
[2023-07-23 16:17:04] [config] embedding-fix-src: false
[2023-07-23 16:17:04] [config] embedding-fix-trg: false
[2023-07-23 16:17:04] [config] embedding-normalization: false
[2023-07-23 16:17:04] [config] embedding-vectors:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] enc-cell: gru
[2023-07-23 16:17:04] [config] enc-cell-depth: 1
[2023-07-23 16:17:04] [config] enc-depth: 1
[2023-07-23 16:17:04] [config] enc-type: bidirectional
[2023-07-23 16:17:04] [config] english-title-case-every: 0
[2023-07-23 16:17:04] [config] exponential-smoothing: 0
[2023-07-23 16:17:04] [config] factor-weight: 1
[2023-07-23 16:17:04] [config] factors-combine: sum
[2023-07-23 16:17:04] [config] factors-dim-emb: 0
[2023-07-23 16:17:04] [config] gradient-checkpointing: false
[2023-07-23 16:17:04] [config] gradient-norm-average-window: 100
[2023-07-23 16:17:04] [config] guided-alignment: none
[2023-07-23 16:17:04] [config] guided-alignment-cost: mse
[2023-07-23 16:17:04] [config] guided-alignment-weight: 0.1
[2023-07-23 16:17:04] [config] ignore-model-config: false
[2023-07-23 16:17:04] [config] input-types:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] interpolate-env-vars: false
[2023-07-23 16:17:04] [config] keep-best: false
[2023-07-23 16:17:04] [config] label-smoothing: 0
[2023-07-23 16:17:04] [config] layer-normalization: false
[2023-07-23 16:17:04] [config] learn-rate: 0.0001
[2023-07-23 16:17:04] [config] lemma-dependency: ""
[2023-07-23 16:17:04] [config] lemma-dim-emb: 0
[2023-07-23 16:17:04] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 16:17:04] [config] log-level: info
[2023-07-23 16:17:04] [config] log-time-zone: ""
[2023-07-23 16:17:04] [config] logical-epoch:
[2023-07-23 16:17:04] [config]   - 1e
[2023-07-23 16:17:04] [config]   - 0
[2023-07-23 16:17:04] [config] lr-decay: 0
[2023-07-23 16:17:04] [config] lr-decay-freq: 50000
[2023-07-23 16:17:04] [config] lr-decay-inv-sqrt:
[2023-07-23 16:17:04] [config]   - 0
[2023-07-23 16:17:04] [config] lr-decay-repeat-warmup: false
[2023-07-23 16:17:04] [config] lr-decay-reset-optimizer: false
[2023-07-23 16:17:04] [config] lr-decay-start:
[2023-07-23 16:17:04] [config]   - 10
[2023-07-23 16:17:04] [config]   - 1
[2023-07-23 16:17:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 16:17:04] [config] lr-report: false
[2023-07-23 16:17:04] [config] lr-warmup: 0
[2023-07-23 16:17:04] [config] lr-warmup-at-reload: false
[2023-07-23 16:17:04] [config] lr-warmup-cycle: false
[2023-07-23 16:17:04] [config] lr-warmup-start-rate: 0
[2023-07-23 16:17:04] [config] max-length: 200
[2023-07-23 16:17:04] [config] max-length-crop: true
[2023-07-23 16:17:04] [config] max-length-factor: 3
[2023-07-23 16:17:04] [config] maxi-batch: 100
[2023-07-23 16:17:04] [config] maxi-batch-sort: trg
[2023-07-23 16:17:04] [config] mini-batch: 64
[2023-07-23 16:17:04] [config] mini-batch-fit: true
[2023-07-23 16:17:04] [config] mini-batch-fit-step: 10
[2023-07-23 16:17:04] [config] mini-batch-round-up: true
[2023-07-23 16:17:04] [config] mini-batch-track-lr: false
[2023-07-23 16:17:04] [config] mini-batch-warmup: 0
[2023-07-23 16:17:04] [config] mini-batch-words: 0
[2023-07-23 16:17:04] [config] mini-batch-words-ref: 0
[2023-07-23 16:17:04] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 16:17:04] [config] multi-loss-type: sum
[2023-07-23 16:17:04] [config] n-best: false
[2023-07-23 16:17:04] [config] no-nccl: false
[2023-07-23 16:17:04] [config] no-reload: false
[2023-07-23 16:17:04] [config] no-restore-corpus: false
[2023-07-23 16:17:04] [config] normalize: 0
[2023-07-23 16:17:04] [config] normalize-gradient: false
[2023-07-23 16:17:04] [config] num-devices: 0
[2023-07-23 16:17:04] [config] optimizer: adam
[2023-07-23 16:17:04] [config] optimizer-delay: 1
[2023-07-23 16:17:04] [config] optimizer-params:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] output-omit-bias: false
[2023-07-23 16:17:04] [config] overwrite: true
[2023-07-23 16:17:04] [config] precision:
[2023-07-23 16:17:04] [config]   - float16
[2023-07-23 16:17:04] [config]   - float32
[2023-07-23 16:17:04] [config] pretrained-model: ""
[2023-07-23 16:17:04] [config] quantize-biases: false
[2023-07-23 16:17:04] [config] quantize-bits: 0
[2023-07-23 16:17:04] [config] quantize-log-based: false
[2023-07-23 16:17:04] [config] quantize-optimization-steps: 0
[2023-07-23 16:17:04] [config] quiet: false
[2023-07-23 16:17:04] [config] quiet-translation: true
[2023-07-23 16:17:04] [config] relative-paths: false
[2023-07-23 16:17:04] [config] right-left: false
[2023-07-23 16:17:04] [config] save-freq: 10000u
[2023-07-23 16:17:04] [config] seed: 1234
[2023-07-23 16:17:04] [config] sentencepiece-alphas:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] sentencepiece-max-lines: 2000000
[2023-07-23 16:17:04] [config] sentencepiece-options: ""
[2023-07-23 16:17:04] [config] sharding: global
[2023-07-23 16:17:04] [config] shuffle: data
[2023-07-23 16:17:04] [config] shuffle-in-ram: false
[2023-07-23 16:17:04] [config] sigterm: save-and-exit
[2023-07-23 16:17:04] [config] skip: false
[2023-07-23 16:17:04] [config] sqlite: ""
[2023-07-23 16:17:04] [config] sqlite-drop: false
[2023-07-23 16:17:04] [config] sync-freq: 200u
[2023-07-23 16:17:04] [config] sync-sgd: false
[2023-07-23 16:17:04] [config] tempdir: /tmp
[2023-07-23 16:17:04] [config] tied-embeddings: false
[2023-07-23 16:17:04] [config] tied-embeddings-all: true
[2023-07-23 16:17:04] [config] tied-embeddings-src: false
[2023-07-23 16:17:04] [config] train-embedder-rank:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] train-sets:
[2023-07-23 16:17:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 16:17:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 16:17:04] [config] transformer-aan-activation: swish
[2023-07-23 16:17:04] [config] transformer-aan-depth: 2
[2023-07-23 16:17:04] [config] transformer-aan-nogate: false
[2023-07-23 16:17:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 16:17:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 16:17:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 16:17:04] [config] transformer-depth-scaling: false
[2023-07-23 16:17:04] [config] transformer-dim-aan: 2048
[2023-07-23 16:17:04] [config] transformer-dim-ffn: 2048
[2023-07-23 16:17:04] [config] transformer-dropout: 0
[2023-07-23 16:17:04] [config] transformer-dropout-attention: 0
[2023-07-23 16:17:04] [config] transformer-dropout-ffn: 0
[2023-07-23 16:17:04] [config] transformer-ffn-activation: swish
[2023-07-23 16:17:04] [config] transformer-ffn-depth: 2
[2023-07-23 16:17:04] [config] transformer-guided-alignment-layer: last
[2023-07-23 16:17:04] [config] transformer-heads: 8
[2023-07-23 16:17:04] [config] transformer-no-projection: false
[2023-07-23 16:17:04] [config] transformer-pool: false
[2023-07-23 16:17:04] [config] transformer-postprocess: dan
[2023-07-23 16:17:04] [config] transformer-postprocess-emb: d
[2023-07-23 16:17:04] [config] transformer-postprocess-top: ""
[2023-07-23 16:17:04] [config] transformer-preprocess: ""
[2023-07-23 16:17:04] [config] transformer-tied-layers:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] transformer-train-position-embeddings: false
[2023-07-23 16:17:04] [config] tsv: false
[2023-07-23 16:17:04] [config] tsv-fields: 0
[2023-07-23 16:17:04] [config] type: amun
[2023-07-23 16:17:04] [config] ulr: false
[2023-07-23 16:17:04] [config] ulr-dim-emb: 0
[2023-07-23 16:17:04] [config] ulr-dropout: 0
[2023-07-23 16:17:04] [config] ulr-keys-vectors: ""
[2023-07-23 16:17:04] [config] ulr-query-vectors: ""
[2023-07-23 16:17:04] [config] ulr-softmax-temperature: 1
[2023-07-23 16:17:04] [config] ulr-trainable-transformation: false
[2023-07-23 16:17:04] [config] unlikelihood-loss: false
[2023-07-23 16:17:04] [config] valid-freq: 50000000
[2023-07-23 16:17:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 16:17:04] [config] valid-max-length: 1000
[2023-07-23 16:17:04] [config] valid-metrics:
[2023-07-23 16:17:04] [config]   - cross-entropy
[2023-07-23 16:17:04] [config]   - translation
[2023-07-23 16:17:04] [config] valid-mini-batch: 32
[2023-07-23 16:17:04] [config] valid-reset-stalled: false
[2023-07-23 16:17:04] [config] valid-script-args:
[2023-07-23 16:17:04] [config]   []
[2023-07-23 16:17:04] [config] valid-script-path: ""
[2023-07-23 16:17:04] [config] valid-sets:
[2023-07-23 16:17:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 16:17:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 16:17:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 16:17:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 16:17:04] [config] vocabs:
[2023-07-23 16:17:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 16:17:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 16:17:04] [config] word-penalty: 0
[2023-07-23 16:17:04] [config] word-scores: false
[2023-07-23 16:17:04] [config] workspace: 5500
[2023-07-23 16:17:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 16:17:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 16:17:04] [training] Using single-device training
[2023-07-23 16:17:04] Synced seed 1234
[2023-07-23 16:17:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 16:17:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 16:17:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 16:17:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 16:17:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 16:17:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 16:17:04] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 16:17:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 16:17:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 16:17:06] [comm] Using global sharding
[2023-07-23 16:17:06] [comm] NCCLCommunicators constructed successfully
[2023-07-23 16:17:06] [training] Using 1 GPUs
[2023-07-23 16:17:06] [logits] Applying loss function for 1 factor(s)
[2023-07-23 16:17:06] [memory] Reserving 80 MB, device gpu0
[2023-07-23 16:17:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 16:17:06] [memory] Reserving 80 MB, device gpu0
[2023-07-23 16:53:01] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 16:53:02] [valid] No post-processing script given for validating translator
[2023-07-23 16:53:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 16:53:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 16:53:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 16:53:02] [comm] Using global sharding
[2023-07-23 16:53:02] [comm] NCCLCommunicators constructed successfully
[2023-07-23 16:53:02] [training] Using 1 GPUs
[2023-07-23 16:53:02] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 16:53:08] Allocating memory for general optimizer shards
[2023-07-23 16:53:08] [memory] Reserving 322 MB, device gpu0
[2023-07-23 16:53:08] Loading Adam parameters
[2023-07-23 16:53:08] [memory] Reserving 322 MB, device gpu0
[2023-07-23 16:53:08] [memory] Reserving 80 MB, device gpu0
[2023-07-23 16:53:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 16:53:08] [data] Restoring the corpus state to epoch 151, batch 6646
[2023-07-23 16:53:08] [data] Shuffling data
[2023-07-23 16:53:08] [data] Done reading 20,192 sentences
[2023-07-23 16:53:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 16:53:08] Training started
[2023-07-23 16:53:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 16:53:09] [memory] Reserving 80 MB, device gpu0
[2023-07-23 16:53:11] Parameter type float16, optimization type float32, casting types true
[2023-07-23 16:57:38] Seen 20,192 samples
[2023-07-23 16:57:38] Starting data epoch 152 in logical epoch 152
[2023-07-23 16:57:38] [data] Shuffling data
[2023-07-23 16:57:38] [data] Done reading 20,192 sentences
[2023-07-23 16:57:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:02:24] Seen 20,192 samples
[2023-07-23 17:02:24] Starting data epoch 153 in logical epoch 153
[2023-07-23 17:02:24] [data] Shuffling data
[2023-07-23 17:02:24] [data] Done reading 20,192 sentences
[2023-07-23 17:02:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:07:05] Seen 20,192 samples
[2023-07-23 17:07:05] Starting data epoch 154 in logical epoch 154
[2023-07-23 17:07:05] [data] Shuffling data
[2023-07-23 17:07:05] [data] Done reading 20,192 sentences
[2023-07-23 17:07:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:11:47] Seen 20,192 samples
[2023-07-23 17:11:47] Starting data epoch 155 in logical epoch 155
[2023-07-23 17:11:47] [data] Shuffling data
[2023-07-23 17:11:47] [data] Done reading 20,192 sentences
[2023-07-23 17:11:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:16:21] Seen 20,192 samples
[2023-07-23 17:16:21] Starting data epoch 156 in logical epoch 156
[2023-07-23 17:16:21] [data] Shuffling data
[2023-07-23 17:16:21] [data] Done reading 20,192 sentences
[2023-07-23 17:16:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:21:07] Seen 20,192 samples
[2023-07-23 17:21:07] Starting data epoch 157 in logical epoch 157
[2023-07-23 17:21:07] [data] Shuffling data
[2023-07-23 17:21:07] [data] Done reading 20,192 sentences
[2023-07-23 17:21:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:25:43] Seen 20,192 samples
[2023-07-23 17:25:43] Starting data epoch 158 in logical epoch 158
[2023-07-23 17:25:43] [data] Shuffling data
[2023-07-23 17:25:43] [data] Done reading 20,192 sentences
[2023-07-23 17:25:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:30:21] Ep. 158 : Up. 7000 : Sen. 20,192 : Cost 3.31915498 * 12,272,696 @ 4,544 after 85,965,114 : Time 2239.28s : 5480.63 words/s : gNorm 1.9843
[2023-07-23 17:30:21] Seen 20,192 samples
[2023-07-23 17:30:21] Starting data epoch 159 in logical epoch 159
[2023-07-23 17:30:21] [data] Shuffling data
[2023-07-23 17:30:21] [data] Done reading 20,192 sentences
[2023-07-23 17:30:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:34:55] Seen 20,192 samples
[2023-07-23 17:34:55] Starting data epoch 160 in logical epoch 160
[2023-07-23 17:34:55] [data] Shuffling data
[2023-07-23 17:34:55] [data] Done reading 20,192 sentences
[2023-07-23 17:34:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 17:39:35] Seen 20,192 samples
[2023-07-23 17:39:35] Starting data epoch 161 in logical epoch 161
[2023-07-23 17:39:35] Training finished
[2023-07-23 17:39:46] [valid] Ep. 161 : Up. 7089 : cross-entropy : 136.383 : stalled 6 times (last best: 131.038)
[2023-07-23 17:42:16] [valid] Ep. 161 : Up. 7089 : translation : 0 : new best
[2023-07-23 17:42:16] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 17:42:19] Saving Adam parameters
[2023-07-23 17:42:19] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 17:42:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 17:42:28] [marian] Running on node22.datos.cluster.uy as process 34051 with command line:
[2023-07-23 17:42:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 17:42:28] [config] after: 0e
[2023-07-23 17:42:28] [config] after-batches: 0
[2023-07-23 17:42:28] [config] after-epochs: 170
[2023-07-23 17:42:28] [config] all-caps-every: 0
[2023-07-23 17:42:28] [config] allow-unk: false
[2023-07-23 17:42:28] [config] authors: false
[2023-07-23 17:42:28] [config] beam-size: 12
[2023-07-23 17:42:28] [config] bert-class-symbol: "[CLS]"
[2023-07-23 17:42:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 17:42:28] [config] bert-masking-fraction: 0.15
[2023-07-23 17:42:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 17:42:28] [config] bert-train-type-embeddings: true
[2023-07-23 17:42:28] [config] bert-type-vocab-size: 2
[2023-07-23 17:42:28] [config] build-info: ""
[2023-07-23 17:42:28] [config] check-gradient-nan: false
[2023-07-23 17:42:28] [config] check-nan: false
[2023-07-23 17:42:28] [config] cite: false
[2023-07-23 17:42:28] [config] clip-norm: 1
[2023-07-23 17:42:28] [config] cost-scaling:
[2023-07-23 17:42:28] [config]   - 256.f
[2023-07-23 17:42:28] [config]   - 1000
[2023-07-23 17:42:28] [config]   - 2.f
[2023-07-23 17:42:28] [config]   - 256.f
[2023-07-23 17:42:28] [config] cost-type: ce-sum
[2023-07-23 17:42:28] [config] cpu-threads: 0
[2023-07-23 17:42:28] [config] data-threads: 8
[2023-07-23 17:42:28] [config] data-weighting: ""
[2023-07-23 17:42:28] [config] data-weighting-type: sentence
[2023-07-23 17:42:28] [config] dec-cell: gru
[2023-07-23 17:42:28] [config] dec-cell-base-depth: 2
[2023-07-23 17:42:28] [config] dec-cell-high-depth: 1
[2023-07-23 17:42:28] [config] dec-depth: 1
[2023-07-23 17:42:28] [config] devices:
[2023-07-23 17:42:28] [config]   - 0
[2023-07-23 17:42:28] [config] dim-emb: 512
[2023-07-23 17:42:28] [config] dim-rnn: 1024
[2023-07-23 17:42:28] [config] dim-vocabs:
[2023-07-23 17:42:28] [config]   - 16384
[2023-07-23 17:42:28] [config]   - 16384
[2023-07-23 17:42:28] [config] disp-first: 0
[2023-07-23 17:42:28] [config] disp-freq: 1000u
[2023-07-23 17:42:28] [config] disp-label-counts: true
[2023-07-23 17:42:28] [config] dropout-rnn: 0
[2023-07-23 17:42:28] [config] dropout-src: 0
[2023-07-23 17:42:28] [config] dropout-trg: 0
[2023-07-23 17:42:28] [config] dump-config: ""
[2023-07-23 17:42:28] [config] dynamic-gradient-scaling:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] early-stopping: 200
[2023-07-23 17:42:28] [config] early-stopping-on: first
[2023-07-23 17:42:28] [config] embedding-fix-src: false
[2023-07-23 17:42:28] [config] embedding-fix-trg: false
[2023-07-23 17:42:28] [config] embedding-normalization: false
[2023-07-23 17:42:28] [config] embedding-vectors:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] enc-cell: gru
[2023-07-23 17:42:28] [config] enc-cell-depth: 1
[2023-07-23 17:42:28] [config] enc-depth: 1
[2023-07-23 17:42:28] [config] enc-type: bidirectional
[2023-07-23 17:42:28] [config] english-title-case-every: 0
[2023-07-23 17:42:28] [config] exponential-smoothing: 0
[2023-07-23 17:42:28] [config] factor-weight: 1
[2023-07-23 17:42:28] [config] factors-combine: sum
[2023-07-23 17:42:28] [config] factors-dim-emb: 0
[2023-07-23 17:42:28] [config] gradient-checkpointing: false
[2023-07-23 17:42:28] [config] gradient-norm-average-window: 100
[2023-07-23 17:42:28] [config] guided-alignment: none
[2023-07-23 17:42:28] [config] guided-alignment-cost: mse
[2023-07-23 17:42:28] [config] guided-alignment-weight: 0.1
[2023-07-23 17:42:28] [config] ignore-model-config: false
[2023-07-23 17:42:28] [config] input-types:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] interpolate-env-vars: false
[2023-07-23 17:42:28] [config] keep-best: false
[2023-07-23 17:42:28] [config] label-smoothing: 0
[2023-07-23 17:42:28] [config] layer-normalization: false
[2023-07-23 17:42:28] [config] learn-rate: 0.0001
[2023-07-23 17:42:28] [config] lemma-dependency: ""
[2023-07-23 17:42:28] [config] lemma-dim-emb: 0
[2023-07-23 17:42:28] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 17:42:28] [config] log-level: info
[2023-07-23 17:42:28] [config] log-time-zone: ""
[2023-07-23 17:42:28] [config] logical-epoch:
[2023-07-23 17:42:28] [config]   - 1e
[2023-07-23 17:42:28] [config]   - 0
[2023-07-23 17:42:28] [config] lr-decay: 0
[2023-07-23 17:42:28] [config] lr-decay-freq: 50000
[2023-07-23 17:42:28] [config] lr-decay-inv-sqrt:
[2023-07-23 17:42:28] [config]   - 0
[2023-07-23 17:42:28] [config] lr-decay-repeat-warmup: false
[2023-07-23 17:42:28] [config] lr-decay-reset-optimizer: false
[2023-07-23 17:42:28] [config] lr-decay-start:
[2023-07-23 17:42:28] [config]   - 10
[2023-07-23 17:42:28] [config]   - 1
[2023-07-23 17:42:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 17:42:28] [config] lr-report: false
[2023-07-23 17:42:28] [config] lr-warmup: 0
[2023-07-23 17:42:28] [config] lr-warmup-at-reload: false
[2023-07-23 17:42:28] [config] lr-warmup-cycle: false
[2023-07-23 17:42:28] [config] lr-warmup-start-rate: 0
[2023-07-23 17:42:28] [config] max-length: 200
[2023-07-23 17:42:28] [config] max-length-crop: true
[2023-07-23 17:42:28] [config] max-length-factor: 3
[2023-07-23 17:42:28] [config] maxi-batch: 100
[2023-07-23 17:42:28] [config] maxi-batch-sort: trg
[2023-07-23 17:42:28] [config] mini-batch: 64
[2023-07-23 17:42:28] [config] mini-batch-fit: true
[2023-07-23 17:42:28] [config] mini-batch-fit-step: 10
[2023-07-23 17:42:28] [config] mini-batch-round-up: true
[2023-07-23 17:42:28] [config] mini-batch-track-lr: false
[2023-07-23 17:42:28] [config] mini-batch-warmup: 0
[2023-07-23 17:42:28] [config] mini-batch-words: 0
[2023-07-23 17:42:28] [config] mini-batch-words-ref: 0
[2023-07-23 17:42:28] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 17:42:28] [config] multi-loss-type: sum
[2023-07-23 17:42:28] [config] n-best: false
[2023-07-23 17:42:28] [config] no-nccl: false
[2023-07-23 17:42:28] [config] no-reload: false
[2023-07-23 17:42:28] [config] no-restore-corpus: false
[2023-07-23 17:42:28] [config] normalize: 0
[2023-07-23 17:42:28] [config] normalize-gradient: false
[2023-07-23 17:42:28] [config] num-devices: 0
[2023-07-23 17:42:28] [config] optimizer: adam
[2023-07-23 17:42:28] [config] optimizer-delay: 1
[2023-07-23 17:42:28] [config] optimizer-params:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] output-omit-bias: false
[2023-07-23 17:42:28] [config] overwrite: true
[2023-07-23 17:42:28] [config] precision:
[2023-07-23 17:42:28] [config]   - float16
[2023-07-23 17:42:28] [config]   - float32
[2023-07-23 17:42:28] [config] pretrained-model: ""
[2023-07-23 17:42:28] [config] quantize-biases: false
[2023-07-23 17:42:28] [config] quantize-bits: 0
[2023-07-23 17:42:28] [config] quantize-log-based: false
[2023-07-23 17:42:28] [config] quantize-optimization-steps: 0
[2023-07-23 17:42:28] [config] quiet: false
[2023-07-23 17:42:28] [config] quiet-translation: true
[2023-07-23 17:42:28] [config] relative-paths: false
[2023-07-23 17:42:28] [config] right-left: false
[2023-07-23 17:42:28] [config] save-freq: 10000u
[2023-07-23 17:42:28] [config] seed: 1234
[2023-07-23 17:42:28] [config] sentencepiece-alphas:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] sentencepiece-max-lines: 2000000
[2023-07-23 17:42:28] [config] sentencepiece-options: ""
[2023-07-23 17:42:28] [config] sharding: global
[2023-07-23 17:42:28] [config] shuffle: data
[2023-07-23 17:42:28] [config] shuffle-in-ram: false
[2023-07-23 17:42:28] [config] sigterm: save-and-exit
[2023-07-23 17:42:28] [config] skip: false
[2023-07-23 17:42:28] [config] sqlite: ""
[2023-07-23 17:42:28] [config] sqlite-drop: false
[2023-07-23 17:42:28] [config] sync-freq: 200u
[2023-07-23 17:42:28] [config] sync-sgd: false
[2023-07-23 17:42:28] [config] tempdir: /tmp
[2023-07-23 17:42:28] [config] tied-embeddings: false
[2023-07-23 17:42:28] [config] tied-embeddings-all: true
[2023-07-23 17:42:28] [config] tied-embeddings-src: false
[2023-07-23 17:42:28] [config] train-embedder-rank:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] train-sets:
[2023-07-23 17:42:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 17:42:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 17:42:28] [config] transformer-aan-activation: swish
[2023-07-23 17:42:28] [config] transformer-aan-depth: 2
[2023-07-23 17:42:28] [config] transformer-aan-nogate: false
[2023-07-23 17:42:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 17:42:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 17:42:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 17:42:28] [config] transformer-depth-scaling: false
[2023-07-23 17:42:28] [config] transformer-dim-aan: 2048
[2023-07-23 17:42:28] [config] transformer-dim-ffn: 2048
[2023-07-23 17:42:28] [config] transformer-dropout: 0
[2023-07-23 17:42:28] [config] transformer-dropout-attention: 0
[2023-07-23 17:42:28] [config] transformer-dropout-ffn: 0
[2023-07-23 17:42:28] [config] transformer-ffn-activation: swish
[2023-07-23 17:42:28] [config] transformer-ffn-depth: 2
[2023-07-23 17:42:28] [config] transformer-guided-alignment-layer: last
[2023-07-23 17:42:28] [config] transformer-heads: 8
[2023-07-23 17:42:28] [config] transformer-no-projection: false
[2023-07-23 17:42:28] [config] transformer-pool: false
[2023-07-23 17:42:28] [config] transformer-postprocess: dan
[2023-07-23 17:42:28] [config] transformer-postprocess-emb: d
[2023-07-23 17:42:28] [config] transformer-postprocess-top: ""
[2023-07-23 17:42:28] [config] transformer-preprocess: ""
[2023-07-23 17:42:28] [config] transformer-tied-layers:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] transformer-train-position-embeddings: false
[2023-07-23 17:42:28] [config] tsv: false
[2023-07-23 17:42:28] [config] tsv-fields: 0
[2023-07-23 17:42:28] [config] type: amun
[2023-07-23 17:42:28] [config] ulr: false
[2023-07-23 17:42:28] [config] ulr-dim-emb: 0
[2023-07-23 17:42:28] [config] ulr-dropout: 0
[2023-07-23 17:42:28] [config] ulr-keys-vectors: ""
[2023-07-23 17:42:28] [config] ulr-query-vectors: ""
[2023-07-23 17:42:28] [config] ulr-softmax-temperature: 1
[2023-07-23 17:42:28] [config] ulr-trainable-transformation: false
[2023-07-23 17:42:28] [config] unlikelihood-loss: false
[2023-07-23 17:42:28] [config] valid-freq: 50000000
[2023-07-23 17:42:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 17:42:28] [config] valid-max-length: 1000
[2023-07-23 17:42:28] [config] valid-metrics:
[2023-07-23 17:42:28] [config]   - cross-entropy
[2023-07-23 17:42:28] [config]   - translation
[2023-07-23 17:42:28] [config] valid-mini-batch: 32
[2023-07-23 17:42:28] [config] valid-reset-stalled: false
[2023-07-23 17:42:28] [config] valid-script-args:
[2023-07-23 17:42:28] [config]   []
[2023-07-23 17:42:28] [config] valid-script-path: ""
[2023-07-23 17:42:28] [config] valid-sets:
[2023-07-23 17:42:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 17:42:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 17:42:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 17:42:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 17:42:28] [config] vocabs:
[2023-07-23 17:42:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 17:42:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 17:42:28] [config] word-penalty: 0
[2023-07-23 17:42:28] [config] word-scores: false
[2023-07-23 17:42:28] [config] workspace: 5500
[2023-07-23 17:42:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 17:42:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 17:42:28] [training] Using single-device training
[2023-07-23 17:42:29] Synced seed 1234
[2023-07-23 17:42:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 17:42:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 17:42:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 17:42:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 17:42:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 17:42:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 17:42:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 17:42:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 17:42:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 17:42:31] [comm] Using global sharding
[2023-07-23 17:42:31] [comm] NCCLCommunicators constructed successfully
[2023-07-23 17:42:31] [training] Using 1 GPUs
[2023-07-23 17:42:31] [logits] Applying loss function for 1 factor(s)
[2023-07-23 17:42:31] [memory] Reserving 80 MB, device gpu0
[2023-07-23 17:42:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 17:42:31] [memory] Reserving 80 MB, device gpu0
[2023-07-23 18:18:53] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 18:18:53] [valid] No post-processing script given for validating translator
[2023-07-23 18:18:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 18:18:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 18:18:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 18:18:53] [comm] Using global sharding
[2023-07-23 18:18:53] [comm] NCCLCommunicators constructed successfully
[2023-07-23 18:18:53] [training] Using 1 GPUs
[2023-07-23 18:18:53] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 18:19:02] Allocating memory for general optimizer shards
[2023-07-23 18:19:02] [memory] Reserving 322 MB, device gpu0
[2023-07-23 18:19:02] Loading Adam parameters
[2023-07-23 18:19:02] [memory] Reserving 322 MB, device gpu0
[2023-07-23 18:19:02] [memory] Reserving 80 MB, device gpu0
[2023-07-23 18:19:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 18:19:02] [data] Restoring the corpus state to epoch 161, batch 7089
[2023-07-23 18:19:02] [data] Shuffling data
[2023-07-23 18:19:02] [data] Done reading 20,192 sentences
[2023-07-23 18:19:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:19:02] Training started
[2023-07-23 18:19:02] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 18:19:03] [memory] Reserving 80 MB, device gpu0
[2023-07-23 18:19:09] Parameter type float16, optimization type float32, casting types true
[2023-07-23 18:23:23] Seen 20,192 samples
[2023-07-23 18:23:23] Starting data epoch 162 in logical epoch 162
[2023-07-23 18:23:23] [data] Shuffling data
[2023-07-23 18:23:23] [data] Done reading 20,192 sentences
[2023-07-23 18:23:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:27:53] Seen 20,192 samples
[2023-07-23 18:27:53] Starting data epoch 163 in logical epoch 163
[2023-07-23 18:27:53] [data] Shuffling data
[2023-07-23 18:27:53] [data] Done reading 20,192 sentences
[2023-07-23 18:27:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:32:19] Seen 20,192 samples
[2023-07-23 18:32:19] Starting data epoch 164 in logical epoch 164
[2023-07-23 18:32:19] [data] Shuffling data
[2023-07-23 18:32:19] [data] Done reading 20,192 sentences
[2023-07-23 18:32:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:36:52] Seen 20,192 samples
[2023-07-23 18:36:52] Starting data epoch 165 in logical epoch 165
[2023-07-23 18:36:52] [data] Shuffling data
[2023-07-23 18:36:52] [data] Done reading 20,192 sentences
[2023-07-23 18:36:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:41:28] Seen 20,192 samples
[2023-07-23 18:41:28] Starting data epoch 166 in logical epoch 166
[2023-07-23 18:41:28] [data] Shuffling data
[2023-07-23 18:41:28] [data] Done reading 20,192 sentences
[2023-07-23 18:41:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:46:03] Seen 20,192 samples
[2023-07-23 18:46:03] Starting data epoch 167 in logical epoch 167
[2023-07-23 18:46:03] [data] Shuffling data
[2023-07-23 18:46:03] [data] Done reading 20,192 sentences
[2023-07-23 18:46:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:50:30] Seen 20,192 samples
[2023-07-23 18:50:30] Starting data epoch 168 in logical epoch 168
[2023-07-23 18:50:30] [data] Shuffling data
[2023-07-23 18:50:30] [data] Done reading 20,192 sentences
[2023-07-23 18:50:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:55:13] Seen 20,192 samples
[2023-07-23 18:55:13] Starting data epoch 169 in logical epoch 169
[2023-07-23 18:55:13] [data] Shuffling data
[2023-07-23 18:55:13] [data] Done reading 20,192 sentences
[2023-07-23 18:55:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 18:59:53] Seen 20,192 samples
[2023-07-23 18:59:53] Starting data epoch 170 in logical epoch 170
[2023-07-23 18:59:53] [data] Shuffling data
[2023-07-23 18:59:53] [data] Done reading 20,192 sentences
[2023-07-23 18:59:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 19:04:33] Seen 20,192 samples
[2023-07-23 19:04:33] Starting data epoch 171 in logical epoch 171
[2023-07-23 19:04:33] Training finished
[2023-07-23 19:04:43] [valid] Ep. 171 : Up. 7532 : cross-entropy : 138 : stalled 7 times (last best: 131.038)
[2023-07-23 19:07:01] [valid] Ep. 171 : Up. 7532 : translation : 0 : new best
[2023-07-23 19:07:01] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 19:07:03] Saving Adam parameters
[2023-07-23 19:07:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 19:07:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 19:07:10] [marian] Running on node22.datos.cluster.uy as process 39517 with command line:
[2023-07-23 19:07:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 19:07:10] [config] after: 0e
[2023-07-23 19:07:10] [config] after-batches: 0
[2023-07-23 19:07:10] [config] after-epochs: 180
[2023-07-23 19:07:10] [config] all-caps-every: 0
[2023-07-23 19:07:10] [config] allow-unk: false
[2023-07-23 19:07:10] [config] authors: false
[2023-07-23 19:07:10] [config] beam-size: 12
[2023-07-23 19:07:10] [config] bert-class-symbol: "[CLS]"
[2023-07-23 19:07:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 19:07:10] [config] bert-masking-fraction: 0.15
[2023-07-23 19:07:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 19:07:10] [config] bert-train-type-embeddings: true
[2023-07-23 19:07:10] [config] bert-type-vocab-size: 2
[2023-07-23 19:07:10] [config] build-info: ""
[2023-07-23 19:07:10] [config] check-gradient-nan: false
[2023-07-23 19:07:10] [config] check-nan: false
[2023-07-23 19:07:10] [config] cite: false
[2023-07-23 19:07:10] [config] clip-norm: 1
[2023-07-23 19:07:10] [config] cost-scaling:
[2023-07-23 19:07:10] [config]   - 256.f
[2023-07-23 19:07:10] [config]   - 1000
[2023-07-23 19:07:10] [config]   - 2.f
[2023-07-23 19:07:10] [config]   - 256.f
[2023-07-23 19:07:10] [config] cost-type: ce-sum
[2023-07-23 19:07:10] [config] cpu-threads: 0
[2023-07-23 19:07:10] [config] data-threads: 8
[2023-07-23 19:07:10] [config] data-weighting: ""
[2023-07-23 19:07:10] [config] data-weighting-type: sentence
[2023-07-23 19:07:10] [config] dec-cell: gru
[2023-07-23 19:07:10] [config] dec-cell-base-depth: 2
[2023-07-23 19:07:10] [config] dec-cell-high-depth: 1
[2023-07-23 19:07:10] [config] dec-depth: 1
[2023-07-23 19:07:10] [config] devices:
[2023-07-23 19:07:10] [config]   - 0
[2023-07-23 19:07:10] [config] dim-emb: 512
[2023-07-23 19:07:10] [config] dim-rnn: 1024
[2023-07-23 19:07:10] [config] dim-vocabs:
[2023-07-23 19:07:10] [config]   - 16384
[2023-07-23 19:07:10] [config]   - 16384
[2023-07-23 19:07:10] [config] disp-first: 0
[2023-07-23 19:07:10] [config] disp-freq: 1000u
[2023-07-23 19:07:10] [config] disp-label-counts: true
[2023-07-23 19:07:10] [config] dropout-rnn: 0
[2023-07-23 19:07:10] [config] dropout-src: 0
[2023-07-23 19:07:10] [config] dropout-trg: 0
[2023-07-23 19:07:10] [config] dump-config: ""
[2023-07-23 19:07:10] [config] dynamic-gradient-scaling:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] early-stopping: 200
[2023-07-23 19:07:10] [config] early-stopping-on: first
[2023-07-23 19:07:10] [config] embedding-fix-src: false
[2023-07-23 19:07:10] [config] embedding-fix-trg: false
[2023-07-23 19:07:10] [config] embedding-normalization: false
[2023-07-23 19:07:10] [config] embedding-vectors:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] enc-cell: gru
[2023-07-23 19:07:10] [config] enc-cell-depth: 1
[2023-07-23 19:07:10] [config] enc-depth: 1
[2023-07-23 19:07:10] [config] enc-type: bidirectional
[2023-07-23 19:07:10] [config] english-title-case-every: 0
[2023-07-23 19:07:10] [config] exponential-smoothing: 0
[2023-07-23 19:07:10] [config] factor-weight: 1
[2023-07-23 19:07:10] [config] factors-combine: sum
[2023-07-23 19:07:10] [config] factors-dim-emb: 0
[2023-07-23 19:07:10] [config] gradient-checkpointing: false
[2023-07-23 19:07:10] [config] gradient-norm-average-window: 100
[2023-07-23 19:07:10] [config] guided-alignment: none
[2023-07-23 19:07:10] [config] guided-alignment-cost: mse
[2023-07-23 19:07:10] [config] guided-alignment-weight: 0.1
[2023-07-23 19:07:10] [config] ignore-model-config: false
[2023-07-23 19:07:10] [config] input-types:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] interpolate-env-vars: false
[2023-07-23 19:07:10] [config] keep-best: false
[2023-07-23 19:07:10] [config] label-smoothing: 0
[2023-07-23 19:07:10] [config] layer-normalization: false
[2023-07-23 19:07:10] [config] learn-rate: 0.0001
[2023-07-23 19:07:10] [config] lemma-dependency: ""
[2023-07-23 19:07:10] [config] lemma-dim-emb: 0
[2023-07-23 19:07:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 19:07:10] [config] log-level: info
[2023-07-23 19:07:10] [config] log-time-zone: ""
[2023-07-23 19:07:10] [config] logical-epoch:
[2023-07-23 19:07:10] [config]   - 1e
[2023-07-23 19:07:10] [config]   - 0
[2023-07-23 19:07:10] [config] lr-decay: 0
[2023-07-23 19:07:10] [config] lr-decay-freq: 50000
[2023-07-23 19:07:10] [config] lr-decay-inv-sqrt:
[2023-07-23 19:07:10] [config]   - 0
[2023-07-23 19:07:10] [config] lr-decay-repeat-warmup: false
[2023-07-23 19:07:10] [config] lr-decay-reset-optimizer: false
[2023-07-23 19:07:10] [config] lr-decay-start:
[2023-07-23 19:07:10] [config]   - 10
[2023-07-23 19:07:10] [config]   - 1
[2023-07-23 19:07:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 19:07:10] [config] lr-report: false
[2023-07-23 19:07:10] [config] lr-warmup: 0
[2023-07-23 19:07:10] [config] lr-warmup-at-reload: false
[2023-07-23 19:07:10] [config] lr-warmup-cycle: false
[2023-07-23 19:07:10] [config] lr-warmup-start-rate: 0
[2023-07-23 19:07:10] [config] max-length: 200
[2023-07-23 19:07:10] [config] max-length-crop: true
[2023-07-23 19:07:10] [config] max-length-factor: 3
[2023-07-23 19:07:10] [config] maxi-batch: 100
[2023-07-23 19:07:10] [config] maxi-batch-sort: trg
[2023-07-23 19:07:10] [config] mini-batch: 64
[2023-07-23 19:07:10] [config] mini-batch-fit: true
[2023-07-23 19:07:10] [config] mini-batch-fit-step: 10
[2023-07-23 19:07:10] [config] mini-batch-round-up: true
[2023-07-23 19:07:10] [config] mini-batch-track-lr: false
[2023-07-23 19:07:10] [config] mini-batch-warmup: 0
[2023-07-23 19:07:10] [config] mini-batch-words: 0
[2023-07-23 19:07:10] [config] mini-batch-words-ref: 0
[2023-07-23 19:07:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 19:07:10] [config] multi-loss-type: sum
[2023-07-23 19:07:10] [config] n-best: false
[2023-07-23 19:07:10] [config] no-nccl: false
[2023-07-23 19:07:10] [config] no-reload: false
[2023-07-23 19:07:10] [config] no-restore-corpus: false
[2023-07-23 19:07:10] [config] normalize: 0
[2023-07-23 19:07:10] [config] normalize-gradient: false
[2023-07-23 19:07:10] [config] num-devices: 0
[2023-07-23 19:07:10] [config] optimizer: adam
[2023-07-23 19:07:10] [config] optimizer-delay: 1
[2023-07-23 19:07:10] [config] optimizer-params:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] output-omit-bias: false
[2023-07-23 19:07:10] [config] overwrite: true
[2023-07-23 19:07:10] [config] precision:
[2023-07-23 19:07:10] [config]   - float16
[2023-07-23 19:07:10] [config]   - float32
[2023-07-23 19:07:10] [config] pretrained-model: ""
[2023-07-23 19:07:10] [config] quantize-biases: false
[2023-07-23 19:07:10] [config] quantize-bits: 0
[2023-07-23 19:07:10] [config] quantize-log-based: false
[2023-07-23 19:07:10] [config] quantize-optimization-steps: 0
[2023-07-23 19:07:10] [config] quiet: false
[2023-07-23 19:07:10] [config] quiet-translation: true
[2023-07-23 19:07:10] [config] relative-paths: false
[2023-07-23 19:07:10] [config] right-left: false
[2023-07-23 19:07:10] [config] save-freq: 10000u
[2023-07-23 19:07:10] [config] seed: 1234
[2023-07-23 19:07:10] [config] sentencepiece-alphas:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] sentencepiece-max-lines: 2000000
[2023-07-23 19:07:10] [config] sentencepiece-options: ""
[2023-07-23 19:07:10] [config] sharding: global
[2023-07-23 19:07:10] [config] shuffle: data
[2023-07-23 19:07:10] [config] shuffle-in-ram: false
[2023-07-23 19:07:10] [config] sigterm: save-and-exit
[2023-07-23 19:07:10] [config] skip: false
[2023-07-23 19:07:10] [config] sqlite: ""
[2023-07-23 19:07:10] [config] sqlite-drop: false
[2023-07-23 19:07:10] [config] sync-freq: 200u
[2023-07-23 19:07:10] [config] sync-sgd: false
[2023-07-23 19:07:10] [config] tempdir: /tmp
[2023-07-23 19:07:10] [config] tied-embeddings: false
[2023-07-23 19:07:10] [config] tied-embeddings-all: true
[2023-07-23 19:07:10] [config] tied-embeddings-src: false
[2023-07-23 19:07:10] [config] train-embedder-rank:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] train-sets:
[2023-07-23 19:07:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 19:07:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 19:07:10] [config] transformer-aan-activation: swish
[2023-07-23 19:07:10] [config] transformer-aan-depth: 2
[2023-07-23 19:07:10] [config] transformer-aan-nogate: false
[2023-07-23 19:07:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 19:07:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 19:07:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 19:07:10] [config] transformer-depth-scaling: false
[2023-07-23 19:07:10] [config] transformer-dim-aan: 2048
[2023-07-23 19:07:10] [config] transformer-dim-ffn: 2048
[2023-07-23 19:07:10] [config] transformer-dropout: 0
[2023-07-23 19:07:10] [config] transformer-dropout-attention: 0
[2023-07-23 19:07:10] [config] transformer-dropout-ffn: 0
[2023-07-23 19:07:10] [config] transformer-ffn-activation: swish
[2023-07-23 19:07:10] [config] transformer-ffn-depth: 2
[2023-07-23 19:07:10] [config] transformer-guided-alignment-layer: last
[2023-07-23 19:07:10] [config] transformer-heads: 8
[2023-07-23 19:07:10] [config] transformer-no-projection: false
[2023-07-23 19:07:10] [config] transformer-pool: false
[2023-07-23 19:07:10] [config] transformer-postprocess: dan
[2023-07-23 19:07:10] [config] transformer-postprocess-emb: d
[2023-07-23 19:07:10] [config] transformer-postprocess-top: ""
[2023-07-23 19:07:10] [config] transformer-preprocess: ""
[2023-07-23 19:07:10] [config] transformer-tied-layers:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] transformer-train-position-embeddings: false
[2023-07-23 19:07:10] [config] tsv: false
[2023-07-23 19:07:10] [config] tsv-fields: 0
[2023-07-23 19:07:10] [config] type: amun
[2023-07-23 19:07:10] [config] ulr: false
[2023-07-23 19:07:10] [config] ulr-dim-emb: 0
[2023-07-23 19:07:10] [config] ulr-dropout: 0
[2023-07-23 19:07:10] [config] ulr-keys-vectors: ""
[2023-07-23 19:07:10] [config] ulr-query-vectors: ""
[2023-07-23 19:07:10] [config] ulr-softmax-temperature: 1
[2023-07-23 19:07:10] [config] ulr-trainable-transformation: false
[2023-07-23 19:07:10] [config] unlikelihood-loss: false
[2023-07-23 19:07:10] [config] valid-freq: 50000000
[2023-07-23 19:07:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 19:07:10] [config] valid-max-length: 1000
[2023-07-23 19:07:10] [config] valid-metrics:
[2023-07-23 19:07:10] [config]   - cross-entropy
[2023-07-23 19:07:10] [config]   - translation
[2023-07-23 19:07:10] [config] valid-mini-batch: 32
[2023-07-23 19:07:10] [config] valid-reset-stalled: false
[2023-07-23 19:07:10] [config] valid-script-args:
[2023-07-23 19:07:10] [config]   []
[2023-07-23 19:07:10] [config] valid-script-path: ""
[2023-07-23 19:07:10] [config] valid-sets:
[2023-07-23 19:07:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 19:07:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 19:07:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 19:07:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 19:07:10] [config] vocabs:
[2023-07-23 19:07:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 19:07:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 19:07:10] [config] word-penalty: 0
[2023-07-23 19:07:10] [config] word-scores: false
[2023-07-23 19:07:10] [config] workspace: 5500
[2023-07-23 19:07:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 19:07:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 19:07:10] [training] Using single-device training
[2023-07-23 19:07:10] Synced seed 1234
[2023-07-23 19:07:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 19:07:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 19:07:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 19:07:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 19:07:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 19:07:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 19:07:10] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 19:07:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 19:07:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 19:07:12] [comm] Using global sharding
[2023-07-23 19:07:12] [comm] NCCLCommunicators constructed successfully
[2023-07-23 19:07:12] [training] Using 1 GPUs
[2023-07-23 19:07:12] [logits] Applying loss function for 1 factor(s)
[2023-07-23 19:07:12] [memory] Reserving 80 MB, device gpu0
[2023-07-23 19:07:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 19:07:12] [memory] Reserving 80 MB, device gpu0
[2023-07-23 19:43:18] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 19:43:18] [valid] No post-processing script given for validating translator
[2023-07-23 19:43:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 19:43:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 19:43:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 19:43:18] [comm] Using global sharding
[2023-07-23 19:43:18] [comm] NCCLCommunicators constructed successfully
[2023-07-23 19:43:18] [training] Using 1 GPUs
[2023-07-23 19:43:18] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 19:43:24] Allocating memory for general optimizer shards
[2023-07-23 19:43:24] [memory] Reserving 322 MB, device gpu0
[2023-07-23 19:43:24] Loading Adam parameters
[2023-07-23 19:43:24] [memory] Reserving 322 MB, device gpu0
[2023-07-23 19:43:24] [memory] Reserving 80 MB, device gpu0
[2023-07-23 19:43:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 19:43:24] [data] Restoring the corpus state to epoch 171, batch 7532
[2023-07-23 19:43:24] [data] Shuffling data
[2023-07-23 19:43:24] [data] Done reading 20,192 sentences
[2023-07-23 19:43:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 19:43:24] Training started
[2023-07-23 19:43:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 19:43:25] [memory] Reserving 80 MB, device gpu0
[2023-07-23 19:43:28] Parameter type float16, optimization type float32, casting types true
[2023-07-23 19:47:50] Seen 20,192 samples
[2023-07-23 19:47:50] Starting data epoch 172 in logical epoch 172
[2023-07-23 19:47:50] [data] Shuffling data
[2023-07-23 19:47:50] [data] Done reading 20,192 sentences
[2023-07-23 19:47:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 19:52:12] Seen 20,192 samples
[2023-07-23 19:52:12] Starting data epoch 173 in logical epoch 173
[2023-07-23 19:52:12] [data] Shuffling data
[2023-07-23 19:52:12] [data] Done reading 20,192 sentences
[2023-07-23 19:52:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 19:56:52] Seen 20,192 samples
[2023-07-23 19:56:52] Starting data epoch 174 in logical epoch 174
[2023-07-23 19:56:52] [data] Shuffling data
[2023-07-23 19:56:52] [data] Done reading 20,192 sentences
[2023-07-23 19:56:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 20:01:37] Seen 20,192 samples
[2023-07-23 20:01:37] Starting data epoch 175 in logical epoch 175
[2023-07-23 20:01:37] [data] Shuffling data
[2023-07-23 20:01:37] [data] Done reading 20,192 sentences
[2023-07-23 20:01:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 20:06:15] Seen 20,192 samples
[2023-07-23 20:06:15] Starting data epoch 176 in logical epoch 176
[2023-07-23 20:06:15] [data] Shuffling data
[2023-07-23 20:06:15] [data] Done reading 20,192 sentences
[2023-07-23 20:06:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 20:11:11] Seen 20,192 samples
[2023-07-23 20:11:11] Starting data epoch 177 in logical epoch 177
[2023-07-23 20:11:11] [data] Shuffling data
[2023-07-23 20:11:11] [data] Done reading 20,192 sentences
[2023-07-23 20:11:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 20:15:40] Seen 20,192 samples
[2023-07-23 20:15:40] Starting data epoch 178 in logical epoch 178
[2023-07-23 20:15:40] [data] Shuffling data
[2023-07-23 20:15:40] [data] Done reading 20,192 sentences
[2023-07-23 20:15:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 20:20:30] Seen 20,192 samples
[2023-07-23 20:20:30] Starting data epoch 179 in logical epoch 179
[2023-07-23 20:20:30] [data] Shuffling data
[2023-07-23 20:20:30] [data] Done reading 20,192 sentences
[2023-07-23 20:20:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 20:25:02] Seen 20,192 samples
[2023-07-23 20:25:02] Starting data epoch 180 in logical epoch 180
[2023-07-23 20:25:02] [data] Shuffling data
[2023-07-23 20:25:02] [data] Done reading 20,192 sentences
[2023-07-23 20:25:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 20:29:21] Seen 20,192 samples
[2023-07-23 20:29:22] Starting data epoch 181 in logical epoch 181
[2023-07-23 20:29:22] Training finished
[2023-07-23 20:29:32] [valid] Ep. 181 : Up. 7977 : cross-entropy : 140.526 : stalled 8 times (last best: 131.038)
[2023-07-23 20:31:52] [valid] Ep. 181 : Up. 7977 : translation : 0 : new best
[2023-07-23 20:31:52] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 20:31:56] Saving Adam parameters
[2023-07-23 20:31:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 20:32:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 20:32:05] [marian] Running on node22.datos.cluster.uy as process 4501 with command line:
[2023-07-23 20:32:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 20:32:05] [config] after: 0e
[2023-07-23 20:32:05] [config] after-batches: 0
[2023-07-23 20:32:05] [config] after-epochs: 190
[2023-07-23 20:32:05] [config] all-caps-every: 0
[2023-07-23 20:32:05] [config] allow-unk: false
[2023-07-23 20:32:05] [config] authors: false
[2023-07-23 20:32:05] [config] beam-size: 12
[2023-07-23 20:32:05] [config] bert-class-symbol: "[CLS]"
[2023-07-23 20:32:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 20:32:05] [config] bert-masking-fraction: 0.15
[2023-07-23 20:32:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 20:32:05] [config] bert-train-type-embeddings: true
[2023-07-23 20:32:05] [config] bert-type-vocab-size: 2
[2023-07-23 20:32:05] [config] build-info: ""
[2023-07-23 20:32:05] [config] check-gradient-nan: false
[2023-07-23 20:32:05] [config] check-nan: false
[2023-07-23 20:32:05] [config] cite: false
[2023-07-23 20:32:05] [config] clip-norm: 1
[2023-07-23 20:32:05] [config] cost-scaling:
[2023-07-23 20:32:05] [config]   - 256.f
[2023-07-23 20:32:05] [config]   - 1000
[2023-07-23 20:32:05] [config]   - 2.f
[2023-07-23 20:32:05] [config]   - 256.f
[2023-07-23 20:32:05] [config] cost-type: ce-sum
[2023-07-23 20:32:05] [config] cpu-threads: 0
[2023-07-23 20:32:05] [config] data-threads: 8
[2023-07-23 20:32:05] [config] data-weighting: ""
[2023-07-23 20:32:05] [config] data-weighting-type: sentence
[2023-07-23 20:32:05] [config] dec-cell: gru
[2023-07-23 20:32:05] [config] dec-cell-base-depth: 2
[2023-07-23 20:32:05] [config] dec-cell-high-depth: 1
[2023-07-23 20:32:05] [config] dec-depth: 1
[2023-07-23 20:32:05] [config] devices:
[2023-07-23 20:32:05] [config]   - 0
[2023-07-23 20:32:05] [config] dim-emb: 512
[2023-07-23 20:32:05] [config] dim-rnn: 1024
[2023-07-23 20:32:05] [config] dim-vocabs:
[2023-07-23 20:32:05] [config]   - 16384
[2023-07-23 20:32:05] [config]   - 16384
[2023-07-23 20:32:05] [config] disp-first: 0
[2023-07-23 20:32:05] [config] disp-freq: 1000u
[2023-07-23 20:32:05] [config] disp-label-counts: true
[2023-07-23 20:32:05] [config] dropout-rnn: 0
[2023-07-23 20:32:05] [config] dropout-src: 0
[2023-07-23 20:32:05] [config] dropout-trg: 0
[2023-07-23 20:32:05] [config] dump-config: ""
[2023-07-23 20:32:05] [config] dynamic-gradient-scaling:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] early-stopping: 200
[2023-07-23 20:32:05] [config] early-stopping-on: first
[2023-07-23 20:32:05] [config] embedding-fix-src: false
[2023-07-23 20:32:05] [config] embedding-fix-trg: false
[2023-07-23 20:32:05] [config] embedding-normalization: false
[2023-07-23 20:32:05] [config] embedding-vectors:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] enc-cell: gru
[2023-07-23 20:32:05] [config] enc-cell-depth: 1
[2023-07-23 20:32:05] [config] enc-depth: 1
[2023-07-23 20:32:05] [config] enc-type: bidirectional
[2023-07-23 20:32:05] [config] english-title-case-every: 0
[2023-07-23 20:32:05] [config] exponential-smoothing: 0
[2023-07-23 20:32:05] [config] factor-weight: 1
[2023-07-23 20:32:05] [config] factors-combine: sum
[2023-07-23 20:32:05] [config] factors-dim-emb: 0
[2023-07-23 20:32:05] [config] gradient-checkpointing: false
[2023-07-23 20:32:05] [config] gradient-norm-average-window: 100
[2023-07-23 20:32:05] [config] guided-alignment: none
[2023-07-23 20:32:05] [config] guided-alignment-cost: mse
[2023-07-23 20:32:05] [config] guided-alignment-weight: 0.1
[2023-07-23 20:32:05] [config] ignore-model-config: false
[2023-07-23 20:32:05] [config] input-types:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] interpolate-env-vars: false
[2023-07-23 20:32:05] [config] keep-best: false
[2023-07-23 20:32:05] [config] label-smoothing: 0
[2023-07-23 20:32:05] [config] layer-normalization: false
[2023-07-23 20:32:05] [config] learn-rate: 0.0001
[2023-07-23 20:32:05] [config] lemma-dependency: ""
[2023-07-23 20:32:05] [config] lemma-dim-emb: 0
[2023-07-23 20:32:05] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 20:32:05] [config] log-level: info
[2023-07-23 20:32:05] [config] log-time-zone: ""
[2023-07-23 20:32:05] [config] logical-epoch:
[2023-07-23 20:32:05] [config]   - 1e
[2023-07-23 20:32:05] [config]   - 0
[2023-07-23 20:32:05] [config] lr-decay: 0
[2023-07-23 20:32:05] [config] lr-decay-freq: 50000
[2023-07-23 20:32:05] [config] lr-decay-inv-sqrt:
[2023-07-23 20:32:05] [config]   - 0
[2023-07-23 20:32:05] [config] lr-decay-repeat-warmup: false
[2023-07-23 20:32:05] [config] lr-decay-reset-optimizer: false
[2023-07-23 20:32:05] [config] lr-decay-start:
[2023-07-23 20:32:05] [config]   - 10
[2023-07-23 20:32:05] [config]   - 1
[2023-07-23 20:32:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 20:32:05] [config] lr-report: false
[2023-07-23 20:32:05] [config] lr-warmup: 0
[2023-07-23 20:32:05] [config] lr-warmup-at-reload: false
[2023-07-23 20:32:05] [config] lr-warmup-cycle: false
[2023-07-23 20:32:05] [config] lr-warmup-start-rate: 0
[2023-07-23 20:32:05] [config] max-length: 200
[2023-07-23 20:32:05] [config] max-length-crop: true
[2023-07-23 20:32:05] [config] max-length-factor: 3
[2023-07-23 20:32:05] [config] maxi-batch: 100
[2023-07-23 20:32:05] [config] maxi-batch-sort: trg
[2023-07-23 20:32:05] [config] mini-batch: 64
[2023-07-23 20:32:05] [config] mini-batch-fit: true
[2023-07-23 20:32:05] [config] mini-batch-fit-step: 10
[2023-07-23 20:32:05] [config] mini-batch-round-up: true
[2023-07-23 20:32:05] [config] mini-batch-track-lr: false
[2023-07-23 20:32:05] [config] mini-batch-warmup: 0
[2023-07-23 20:32:05] [config] mini-batch-words: 0
[2023-07-23 20:32:05] [config] mini-batch-words-ref: 0
[2023-07-23 20:32:05] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 20:32:05] [config] multi-loss-type: sum
[2023-07-23 20:32:05] [config] n-best: false
[2023-07-23 20:32:05] [config] no-nccl: false
[2023-07-23 20:32:05] [config] no-reload: false
[2023-07-23 20:32:05] [config] no-restore-corpus: false
[2023-07-23 20:32:05] [config] normalize: 0
[2023-07-23 20:32:05] [config] normalize-gradient: false
[2023-07-23 20:32:05] [config] num-devices: 0
[2023-07-23 20:32:05] [config] optimizer: adam
[2023-07-23 20:32:05] [config] optimizer-delay: 1
[2023-07-23 20:32:05] [config] optimizer-params:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] output-omit-bias: false
[2023-07-23 20:32:05] [config] overwrite: true
[2023-07-23 20:32:05] [config] precision:
[2023-07-23 20:32:05] [config]   - float16
[2023-07-23 20:32:05] [config]   - float32
[2023-07-23 20:32:05] [config] pretrained-model: ""
[2023-07-23 20:32:05] [config] quantize-biases: false
[2023-07-23 20:32:05] [config] quantize-bits: 0
[2023-07-23 20:32:05] [config] quantize-log-based: false
[2023-07-23 20:32:05] [config] quantize-optimization-steps: 0
[2023-07-23 20:32:05] [config] quiet: false
[2023-07-23 20:32:05] [config] quiet-translation: true
[2023-07-23 20:32:05] [config] relative-paths: false
[2023-07-23 20:32:05] [config] right-left: false
[2023-07-23 20:32:05] [config] save-freq: 10000u
[2023-07-23 20:32:05] [config] seed: 1234
[2023-07-23 20:32:05] [config] sentencepiece-alphas:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] sentencepiece-max-lines: 2000000
[2023-07-23 20:32:05] [config] sentencepiece-options: ""
[2023-07-23 20:32:05] [config] sharding: global
[2023-07-23 20:32:05] [config] shuffle: data
[2023-07-23 20:32:05] [config] shuffle-in-ram: false
[2023-07-23 20:32:05] [config] sigterm: save-and-exit
[2023-07-23 20:32:05] [config] skip: false
[2023-07-23 20:32:05] [config] sqlite: ""
[2023-07-23 20:32:05] [config] sqlite-drop: false
[2023-07-23 20:32:05] [config] sync-freq: 200u
[2023-07-23 20:32:05] [config] sync-sgd: false
[2023-07-23 20:32:05] [config] tempdir: /tmp
[2023-07-23 20:32:05] [config] tied-embeddings: false
[2023-07-23 20:32:05] [config] tied-embeddings-all: true
[2023-07-23 20:32:05] [config] tied-embeddings-src: false
[2023-07-23 20:32:05] [config] train-embedder-rank:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] train-sets:
[2023-07-23 20:32:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 20:32:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 20:32:05] [config] transformer-aan-activation: swish
[2023-07-23 20:32:05] [config] transformer-aan-depth: 2
[2023-07-23 20:32:05] [config] transformer-aan-nogate: false
[2023-07-23 20:32:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 20:32:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 20:32:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 20:32:05] [config] transformer-depth-scaling: false
[2023-07-23 20:32:05] [config] transformer-dim-aan: 2048
[2023-07-23 20:32:05] [config] transformer-dim-ffn: 2048
[2023-07-23 20:32:05] [config] transformer-dropout: 0
[2023-07-23 20:32:05] [config] transformer-dropout-attention: 0
[2023-07-23 20:32:05] [config] transformer-dropout-ffn: 0
[2023-07-23 20:32:05] [config] transformer-ffn-activation: swish
[2023-07-23 20:32:05] [config] transformer-ffn-depth: 2
[2023-07-23 20:32:05] [config] transformer-guided-alignment-layer: last
[2023-07-23 20:32:05] [config] transformer-heads: 8
[2023-07-23 20:32:05] [config] transformer-no-projection: false
[2023-07-23 20:32:05] [config] transformer-pool: false
[2023-07-23 20:32:05] [config] transformer-postprocess: dan
[2023-07-23 20:32:05] [config] transformer-postprocess-emb: d
[2023-07-23 20:32:05] [config] transformer-postprocess-top: ""
[2023-07-23 20:32:05] [config] transformer-preprocess: ""
[2023-07-23 20:32:05] [config] transformer-tied-layers:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] transformer-train-position-embeddings: false
[2023-07-23 20:32:05] [config] tsv: false
[2023-07-23 20:32:05] [config] tsv-fields: 0
[2023-07-23 20:32:05] [config] type: amun
[2023-07-23 20:32:05] [config] ulr: false
[2023-07-23 20:32:05] [config] ulr-dim-emb: 0
[2023-07-23 20:32:05] [config] ulr-dropout: 0
[2023-07-23 20:32:05] [config] ulr-keys-vectors: ""
[2023-07-23 20:32:05] [config] ulr-query-vectors: ""
[2023-07-23 20:32:05] [config] ulr-softmax-temperature: 1
[2023-07-23 20:32:05] [config] ulr-trainable-transformation: false
[2023-07-23 20:32:05] [config] unlikelihood-loss: false
[2023-07-23 20:32:05] [config] valid-freq: 50000000
[2023-07-23 20:32:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 20:32:05] [config] valid-max-length: 1000
[2023-07-23 20:32:05] [config] valid-metrics:
[2023-07-23 20:32:05] [config]   - cross-entropy
[2023-07-23 20:32:05] [config]   - translation
[2023-07-23 20:32:05] [config] valid-mini-batch: 32
[2023-07-23 20:32:05] [config] valid-reset-stalled: false
[2023-07-23 20:32:05] [config] valid-script-args:
[2023-07-23 20:32:05] [config]   []
[2023-07-23 20:32:05] [config] valid-script-path: ""
[2023-07-23 20:32:05] [config] valid-sets:
[2023-07-23 20:32:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 20:32:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 20:32:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 20:32:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 20:32:05] [config] vocabs:
[2023-07-23 20:32:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 20:32:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 20:32:05] [config] word-penalty: 0
[2023-07-23 20:32:05] [config] word-scores: false
[2023-07-23 20:32:05] [config] workspace: 5500
[2023-07-23 20:32:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 20:32:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 20:32:05] [training] Using single-device training
[2023-07-23 20:32:06] Synced seed 1234
[2023-07-23 20:32:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 20:32:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 20:32:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 20:32:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 20:32:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 20:32:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 20:32:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 20:32:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 20:32:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 20:32:07] [comm] Using global sharding
[2023-07-23 20:32:07] [comm] NCCLCommunicators constructed successfully
[2023-07-23 20:32:07] [training] Using 1 GPUs
[2023-07-23 20:32:07] [logits] Applying loss function for 1 factor(s)
[2023-07-23 20:32:07] [memory] Reserving 80 MB, device gpu0
[2023-07-23 20:32:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 20:32:07] [memory] Reserving 80 MB, device gpu0
[2023-07-23 21:08:19] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 21:08:20] [valid] No post-processing script given for validating translator
[2023-07-23 21:08:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 21:08:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 21:08:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 21:08:20] [comm] Using global sharding
[2023-07-23 21:08:20] [comm] NCCLCommunicators constructed successfully
[2023-07-23 21:08:20] [training] Using 1 GPUs
[2023-07-23 21:08:20] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 21:08:29] Allocating memory for general optimizer shards
[2023-07-23 21:08:29] [memory] Reserving 322 MB, device gpu0
[2023-07-23 21:08:29] Loading Adam parameters
[2023-07-23 21:08:29] [memory] Reserving 322 MB, device gpu0
[2023-07-23 21:08:29] [memory] Reserving 80 MB, device gpu0
[2023-07-23 21:08:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 21:08:30] [data] Restoring the corpus state to epoch 181, batch 7977
[2023-07-23 21:08:30] [data] Shuffling data
[2023-07-23 21:08:30] [data] Done reading 20,192 sentences
[2023-07-23 21:08:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:08:30] Training started
[2023-07-23 21:08:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 21:08:30] [memory] Reserving 80 MB, device gpu0
[2023-07-23 21:08:36] Parameter type float16, optimization type float32, casting types true
[2023-07-23 21:10:48] Ep. 181 : Up. 8000 : Sen. 11,086 : Cost 2.99906611 * 12,268,259 @ 5,339 after 98,233,369 : Time 148.31s : 82722.89 words/s : gNorm 2.3119
[2023-07-23 21:12:51] Seen 20,192 samples
[2023-07-23 21:12:51] Starting data epoch 182 in logical epoch 182
[2023-07-23 21:12:51] [data] Shuffling data
[2023-07-23 21:12:51] [data] Done reading 20,192 sentences
[2023-07-23 21:12:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:17:17] Seen 20,192 samples
[2023-07-23 21:17:17] Starting data epoch 183 in logical epoch 183
[2023-07-23 21:17:17] [data] Shuffling data
[2023-07-23 21:17:17] [data] Done reading 20,192 sentences
[2023-07-23 21:17:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:21:51] Seen 20,192 samples
[2023-07-23 21:21:51] Starting data epoch 184 in logical epoch 184
[2023-07-23 21:21:51] [data] Shuffling data
[2023-07-23 21:21:51] [data] Done reading 20,192 sentences
[2023-07-23 21:21:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:26:17] Seen 20,192 samples
[2023-07-23 21:26:17] Starting data epoch 185 in logical epoch 185
[2023-07-23 21:26:17] [data] Shuffling data
[2023-07-23 21:26:17] [data] Done reading 20,192 sentences
[2023-07-23 21:26:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:30:43] Seen 20,192 samples
[2023-07-23 21:30:43] Starting data epoch 186 in logical epoch 186
[2023-07-23 21:30:43] [data] Shuffling data
[2023-07-23 21:30:43] [data] Done reading 20,192 sentences
[2023-07-23 21:30:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:35:03] Seen 20,192 samples
[2023-07-23 21:35:03] Starting data epoch 187 in logical epoch 187
[2023-07-23 21:35:03] [data] Shuffling data
[2023-07-23 21:35:03] [data] Done reading 20,192 sentences
[2023-07-23 21:35:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:39:35] Seen 20,192 samples
[2023-07-23 21:39:35] Starting data epoch 188 in logical epoch 188
[2023-07-23 21:39:35] [data] Shuffling data
[2023-07-23 21:39:35] [data] Done reading 20,192 sentences
[2023-07-23 21:39:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:44:18] Seen 20,192 samples
[2023-07-23 21:44:18] Starting data epoch 189 in logical epoch 189
[2023-07-23 21:44:18] [data] Shuffling data
[2023-07-23 21:44:18] [data] Done reading 20,192 sentences
[2023-07-23 21:44:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:48:48] Seen 20,192 samples
[2023-07-23 21:48:48] Starting data epoch 190 in logical epoch 190
[2023-07-23 21:48:48] [data] Shuffling data
[2023-07-23 21:48:48] [data] Done reading 20,192 sentences
[2023-07-23 21:48:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 21:53:19] Seen 20,192 samples
[2023-07-23 21:53:19] Starting data epoch 191 in logical epoch 191
[2023-07-23 21:53:19] Training finished
[2023-07-23 21:53:30] [valid] Ep. 191 : Up. 8420 : cross-entropy : 142.089 : stalled 9 times (last best: 131.038)
[2023-07-23 21:55:53] [valid] Ep. 191 : Up. 8420 : translation : 0 : new best
[2023-07-23 21:55:53] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 21:55:56] Saving Adam parameters
[2023-07-23 21:55:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 21:56:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 21:56:04] [marian] Running on node22.datos.cluster.uy as process 9737 with command line:
[2023-07-23 21:56:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-23 21:56:04] [config] after: 0e
[2023-07-23 21:56:04] [config] after-batches: 0
[2023-07-23 21:56:04] [config] after-epochs: 200
[2023-07-23 21:56:04] [config] all-caps-every: 0
[2023-07-23 21:56:04] [config] allow-unk: false
[2023-07-23 21:56:04] [config] authors: false
[2023-07-23 21:56:04] [config] beam-size: 12
[2023-07-23 21:56:04] [config] bert-class-symbol: "[CLS]"
[2023-07-23 21:56:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 21:56:04] [config] bert-masking-fraction: 0.15
[2023-07-23 21:56:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 21:56:04] [config] bert-train-type-embeddings: true
[2023-07-23 21:56:04] [config] bert-type-vocab-size: 2
[2023-07-23 21:56:04] [config] build-info: ""
[2023-07-23 21:56:04] [config] check-gradient-nan: false
[2023-07-23 21:56:04] [config] check-nan: false
[2023-07-23 21:56:04] [config] cite: false
[2023-07-23 21:56:04] [config] clip-norm: 1
[2023-07-23 21:56:04] [config] cost-scaling:
[2023-07-23 21:56:04] [config]   - 256.f
[2023-07-23 21:56:04] [config]   - 1000
[2023-07-23 21:56:04] [config]   - 2.f
[2023-07-23 21:56:04] [config]   - 256.f
[2023-07-23 21:56:04] [config] cost-type: ce-sum
[2023-07-23 21:56:04] [config] cpu-threads: 0
[2023-07-23 21:56:04] [config] data-threads: 8
[2023-07-23 21:56:04] [config] data-weighting: ""
[2023-07-23 21:56:04] [config] data-weighting-type: sentence
[2023-07-23 21:56:04] [config] dec-cell: gru
[2023-07-23 21:56:04] [config] dec-cell-base-depth: 2
[2023-07-23 21:56:04] [config] dec-cell-high-depth: 1
[2023-07-23 21:56:04] [config] dec-depth: 1
[2023-07-23 21:56:04] [config] devices:
[2023-07-23 21:56:04] [config]   - 0
[2023-07-23 21:56:04] [config] dim-emb: 512
[2023-07-23 21:56:04] [config] dim-rnn: 1024
[2023-07-23 21:56:04] [config] dim-vocabs:
[2023-07-23 21:56:04] [config]   - 16384
[2023-07-23 21:56:04] [config]   - 16384
[2023-07-23 21:56:04] [config] disp-first: 0
[2023-07-23 21:56:04] [config] disp-freq: 1000u
[2023-07-23 21:56:04] [config] disp-label-counts: true
[2023-07-23 21:56:04] [config] dropout-rnn: 0
[2023-07-23 21:56:04] [config] dropout-src: 0
[2023-07-23 21:56:04] [config] dropout-trg: 0
[2023-07-23 21:56:04] [config] dump-config: ""
[2023-07-23 21:56:04] [config] dynamic-gradient-scaling:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] early-stopping: 200
[2023-07-23 21:56:04] [config] early-stopping-on: first
[2023-07-23 21:56:04] [config] embedding-fix-src: false
[2023-07-23 21:56:04] [config] embedding-fix-trg: false
[2023-07-23 21:56:04] [config] embedding-normalization: false
[2023-07-23 21:56:04] [config] embedding-vectors:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] enc-cell: gru
[2023-07-23 21:56:04] [config] enc-cell-depth: 1
[2023-07-23 21:56:04] [config] enc-depth: 1
[2023-07-23 21:56:04] [config] enc-type: bidirectional
[2023-07-23 21:56:04] [config] english-title-case-every: 0
[2023-07-23 21:56:04] [config] exponential-smoothing: 0
[2023-07-23 21:56:04] [config] factor-weight: 1
[2023-07-23 21:56:04] [config] factors-combine: sum
[2023-07-23 21:56:04] [config] factors-dim-emb: 0
[2023-07-23 21:56:04] [config] gradient-checkpointing: false
[2023-07-23 21:56:04] [config] gradient-norm-average-window: 100
[2023-07-23 21:56:04] [config] guided-alignment: none
[2023-07-23 21:56:04] [config] guided-alignment-cost: mse
[2023-07-23 21:56:04] [config] guided-alignment-weight: 0.1
[2023-07-23 21:56:04] [config] ignore-model-config: false
[2023-07-23 21:56:04] [config] input-types:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] interpolate-env-vars: false
[2023-07-23 21:56:04] [config] keep-best: false
[2023-07-23 21:56:04] [config] label-smoothing: 0
[2023-07-23 21:56:04] [config] layer-normalization: false
[2023-07-23 21:56:04] [config] learn-rate: 0.0001
[2023-07-23 21:56:04] [config] lemma-dependency: ""
[2023-07-23 21:56:04] [config] lemma-dim-emb: 0
[2023-07-23 21:56:04] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 21:56:04] [config] log-level: info
[2023-07-23 21:56:04] [config] log-time-zone: ""
[2023-07-23 21:56:04] [config] logical-epoch:
[2023-07-23 21:56:04] [config]   - 1e
[2023-07-23 21:56:04] [config]   - 0
[2023-07-23 21:56:04] [config] lr-decay: 0
[2023-07-23 21:56:04] [config] lr-decay-freq: 50000
[2023-07-23 21:56:04] [config] lr-decay-inv-sqrt:
[2023-07-23 21:56:04] [config]   - 0
[2023-07-23 21:56:04] [config] lr-decay-repeat-warmup: false
[2023-07-23 21:56:04] [config] lr-decay-reset-optimizer: false
[2023-07-23 21:56:04] [config] lr-decay-start:
[2023-07-23 21:56:04] [config]   - 10
[2023-07-23 21:56:04] [config]   - 1
[2023-07-23 21:56:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 21:56:04] [config] lr-report: false
[2023-07-23 21:56:04] [config] lr-warmup: 0
[2023-07-23 21:56:04] [config] lr-warmup-at-reload: false
[2023-07-23 21:56:04] [config] lr-warmup-cycle: false
[2023-07-23 21:56:04] [config] lr-warmup-start-rate: 0
[2023-07-23 21:56:04] [config] max-length: 200
[2023-07-23 21:56:04] [config] max-length-crop: true
[2023-07-23 21:56:04] [config] max-length-factor: 3
[2023-07-23 21:56:04] [config] maxi-batch: 100
[2023-07-23 21:56:04] [config] maxi-batch-sort: trg
[2023-07-23 21:56:04] [config] mini-batch: 64
[2023-07-23 21:56:04] [config] mini-batch-fit: true
[2023-07-23 21:56:04] [config] mini-batch-fit-step: 10
[2023-07-23 21:56:04] [config] mini-batch-round-up: true
[2023-07-23 21:56:04] [config] mini-batch-track-lr: false
[2023-07-23 21:56:04] [config] mini-batch-warmup: 0
[2023-07-23 21:56:04] [config] mini-batch-words: 0
[2023-07-23 21:56:04] [config] mini-batch-words-ref: 0
[2023-07-23 21:56:04] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 21:56:04] [config] multi-loss-type: sum
[2023-07-23 21:56:04] [config] n-best: false
[2023-07-23 21:56:04] [config] no-nccl: false
[2023-07-23 21:56:04] [config] no-reload: false
[2023-07-23 21:56:04] [config] no-restore-corpus: false
[2023-07-23 21:56:04] [config] normalize: 0
[2023-07-23 21:56:04] [config] normalize-gradient: false
[2023-07-23 21:56:04] [config] num-devices: 0
[2023-07-23 21:56:04] [config] optimizer: adam
[2023-07-23 21:56:04] [config] optimizer-delay: 1
[2023-07-23 21:56:04] [config] optimizer-params:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] output-omit-bias: false
[2023-07-23 21:56:04] [config] overwrite: true
[2023-07-23 21:56:04] [config] precision:
[2023-07-23 21:56:04] [config]   - float16
[2023-07-23 21:56:04] [config]   - float32
[2023-07-23 21:56:04] [config] pretrained-model: ""
[2023-07-23 21:56:04] [config] quantize-biases: false
[2023-07-23 21:56:04] [config] quantize-bits: 0
[2023-07-23 21:56:04] [config] quantize-log-based: false
[2023-07-23 21:56:04] [config] quantize-optimization-steps: 0
[2023-07-23 21:56:04] [config] quiet: false
[2023-07-23 21:56:04] [config] quiet-translation: true
[2023-07-23 21:56:04] [config] relative-paths: false
[2023-07-23 21:56:04] [config] right-left: false
[2023-07-23 21:56:04] [config] save-freq: 10000u
[2023-07-23 21:56:04] [config] seed: 1234
[2023-07-23 21:56:04] [config] sentencepiece-alphas:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] sentencepiece-max-lines: 2000000
[2023-07-23 21:56:04] [config] sentencepiece-options: ""
[2023-07-23 21:56:04] [config] sharding: global
[2023-07-23 21:56:04] [config] shuffle: data
[2023-07-23 21:56:04] [config] shuffle-in-ram: false
[2023-07-23 21:56:04] [config] sigterm: save-and-exit
[2023-07-23 21:56:04] [config] skip: false
[2023-07-23 21:56:04] [config] sqlite: ""
[2023-07-23 21:56:04] [config] sqlite-drop: false
[2023-07-23 21:56:04] [config] sync-freq: 200u
[2023-07-23 21:56:04] [config] sync-sgd: false
[2023-07-23 21:56:04] [config] tempdir: /tmp
[2023-07-23 21:56:04] [config] tied-embeddings: false
[2023-07-23 21:56:04] [config] tied-embeddings-all: true
[2023-07-23 21:56:04] [config] tied-embeddings-src: false
[2023-07-23 21:56:04] [config] train-embedder-rank:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] train-sets:
[2023-07-23 21:56:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 21:56:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 21:56:04] [config] transformer-aan-activation: swish
[2023-07-23 21:56:04] [config] transformer-aan-depth: 2
[2023-07-23 21:56:04] [config] transformer-aan-nogate: false
[2023-07-23 21:56:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 21:56:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 21:56:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 21:56:04] [config] transformer-depth-scaling: false
[2023-07-23 21:56:04] [config] transformer-dim-aan: 2048
[2023-07-23 21:56:04] [config] transformer-dim-ffn: 2048
[2023-07-23 21:56:04] [config] transformer-dropout: 0
[2023-07-23 21:56:04] [config] transformer-dropout-attention: 0
[2023-07-23 21:56:04] [config] transformer-dropout-ffn: 0
[2023-07-23 21:56:04] [config] transformer-ffn-activation: swish
[2023-07-23 21:56:04] [config] transformer-ffn-depth: 2
[2023-07-23 21:56:04] [config] transformer-guided-alignment-layer: last
[2023-07-23 21:56:04] [config] transformer-heads: 8
[2023-07-23 21:56:04] [config] transformer-no-projection: false
[2023-07-23 21:56:04] [config] transformer-pool: false
[2023-07-23 21:56:04] [config] transformer-postprocess: dan
[2023-07-23 21:56:04] [config] transformer-postprocess-emb: d
[2023-07-23 21:56:04] [config] transformer-postprocess-top: ""
[2023-07-23 21:56:04] [config] transformer-preprocess: ""
[2023-07-23 21:56:04] [config] transformer-tied-layers:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] transformer-train-position-embeddings: false
[2023-07-23 21:56:04] [config] tsv: false
[2023-07-23 21:56:04] [config] tsv-fields: 0
[2023-07-23 21:56:04] [config] type: amun
[2023-07-23 21:56:04] [config] ulr: false
[2023-07-23 21:56:04] [config] ulr-dim-emb: 0
[2023-07-23 21:56:04] [config] ulr-dropout: 0
[2023-07-23 21:56:04] [config] ulr-keys-vectors: ""
[2023-07-23 21:56:04] [config] ulr-query-vectors: ""
[2023-07-23 21:56:04] [config] ulr-softmax-temperature: 1
[2023-07-23 21:56:04] [config] ulr-trainable-transformation: false
[2023-07-23 21:56:04] [config] unlikelihood-loss: false
[2023-07-23 21:56:04] [config] valid-freq: 50000000
[2023-07-23 21:56:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 21:56:04] [config] valid-max-length: 1000
[2023-07-23 21:56:04] [config] valid-metrics:
[2023-07-23 21:56:04] [config]   - cross-entropy
[2023-07-23 21:56:04] [config]   - translation
[2023-07-23 21:56:04] [config] valid-mini-batch: 32
[2023-07-23 21:56:04] [config] valid-reset-stalled: false
[2023-07-23 21:56:04] [config] valid-script-args:
[2023-07-23 21:56:04] [config]   []
[2023-07-23 21:56:04] [config] valid-script-path: ""
[2023-07-23 21:56:04] [config] valid-sets:
[2023-07-23 21:56:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 21:56:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 21:56:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 21:56:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 21:56:04] [config] vocabs:
[2023-07-23 21:56:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 21:56:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 21:56:04] [config] word-penalty: 0
[2023-07-23 21:56:04] [config] word-scores: false
[2023-07-23 21:56:04] [config] workspace: 5500
[2023-07-23 21:56:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 21:56:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 21:56:04] [training] Using single-device training
[2023-07-23 21:56:05] Synced seed 1234
[2023-07-23 21:56:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 21:56:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 21:56:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 21:56:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 21:56:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 21:56:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 21:56:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 21:56:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 21:56:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 21:56:06] [comm] Using global sharding
[2023-07-23 21:56:06] [comm] NCCLCommunicators constructed successfully
[2023-07-23 21:56:06] [training] Using 1 GPUs
[2023-07-23 21:56:06] [logits] Applying loss function for 1 factor(s)
[2023-07-23 21:56:06] [memory] Reserving 80 MB, device gpu0
[2023-07-23 21:56:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 21:56:06] [memory] Reserving 80 MB, device gpu0
[2023-07-23 22:32:13] [batching] Done. Typical MB size is 35,936 target words
[2023-07-23 22:32:13] [valid] No post-processing script given for validating translator
[2023-07-23 22:32:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 22:32:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 22:32:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 22:32:13] [comm] Using global sharding
[2023-07-23 22:32:13] [comm] NCCLCommunicators constructed successfully
[2023-07-23 22:32:13] [training] Using 1 GPUs
[2023-07-23 22:32:13] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 22:32:21] Allocating memory for general optimizer shards
[2023-07-23 22:32:21] [memory] Reserving 322 MB, device gpu0
[2023-07-23 22:32:21] Loading Adam parameters
[2023-07-23 22:32:21] [memory] Reserving 322 MB, device gpu0
[2023-07-23 22:32:21] [memory] Reserving 80 MB, device gpu0
[2023-07-23 22:32:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 22:32:21] [data] Restoring the corpus state to epoch 191, batch 8420
[2023-07-23 22:32:21] [data] Shuffling data
[2023-07-23 22:32:21] [data] Done reading 20,192 sentences
[2023-07-23 22:32:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 22:32:22] Training started
[2023-07-23 22:32:22] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-23 22:32:22] [memory] Reserving 80 MB, device gpu0
[2023-07-23 22:32:26] Parameter type float16, optimization type float32, casting types true
[2023-07-23 22:36:43] Seen 20,192 samples
[2023-07-23 22:36:43] Starting data epoch 192 in logical epoch 192
[2023-07-23 22:36:43] [data] Shuffling data
[2023-07-23 22:36:43] [data] Done reading 20,192 sentences
[2023-07-23 22:36:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 22:41:27] Seen 20,192 samples
[2023-07-23 22:41:27] Starting data epoch 193 in logical epoch 193
[2023-07-23 22:41:27] [data] Shuffling data
[2023-07-23 22:41:27] [data] Done reading 20,192 sentences
[2023-07-23 22:41:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 22:46:08] Seen 20,192 samples
[2023-07-23 22:46:08] Starting data epoch 194 in logical epoch 194
[2023-07-23 22:46:08] [data] Shuffling data
[2023-07-23 22:46:08] [data] Done reading 20,192 sentences
[2023-07-23 22:46:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 22:50:44] Seen 20,192 samples
[2023-07-23 22:50:44] Starting data epoch 195 in logical epoch 195
[2023-07-23 22:50:44] [data] Shuffling data
[2023-07-23 22:50:44] [data] Done reading 20,192 sentences
[2023-07-23 22:50:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 22:55:17] Seen 20,192 samples
[2023-07-23 22:55:17] Starting data epoch 196 in logical epoch 196
[2023-07-23 22:55:17] [data] Shuffling data
[2023-07-23 22:55:17] [data] Done reading 20,192 sentences
[2023-07-23 22:55:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 22:59:51] Seen 20,192 samples
[2023-07-23 22:59:51] Starting data epoch 197 in logical epoch 197
[2023-07-23 22:59:51] [data] Shuffling data
[2023-07-23 22:59:51] [data] Done reading 20,192 sentences
[2023-07-23 22:59:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 23:04:28] Seen 20,192 samples
[2023-07-23 23:04:28] Starting data epoch 198 in logical epoch 198
[2023-07-23 23:04:28] [data] Shuffling data
[2023-07-23 23:04:28] [data] Done reading 20,192 sentences
[2023-07-23 23:04:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 23:09:06] Seen 20,192 samples
[2023-07-23 23:09:06] Starting data epoch 199 in logical epoch 199
[2023-07-23 23:09:06] [data] Shuffling data
[2023-07-23 23:09:06] [data] Done reading 20,192 sentences
[2023-07-23 23:09:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 23:13:45] Seen 20,192 samples
[2023-07-23 23:13:45] Starting data epoch 200 in logical epoch 200
[2023-07-23 23:13:45] [data] Shuffling data
[2023-07-23 23:13:45] [data] Done reading 20,192 sentences
[2023-07-23 23:13:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 23:18:24] Seen 20,192 samples
[2023-07-23 23:18:24] Starting data epoch 201 in logical epoch 201
[2023-07-23 23:18:24] Training finished
[2023-07-23 23:18:35] [valid] Ep. 201 : Up. 8864 : cross-entropy : 144.198 : stalled 10 times (last best: 131.038)
[2023-07-23 23:20:49] [valid] Ep. 201 : Up. 8864 : translation : 0 : new best
[2023-07-23 23:20:49] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz
[2023-07-23 23:20:52] Saving Adam parameters
[2023-07-23 23:20:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_200.npz.optimizer.npz
[2023-07-23 23:21:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 23:21:01] [marian] Running on node22.datos.cluster.uy as process 15126 with command line:
[2023-07-23 23:21:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-23 23:21:01] [config] after: 0e
[2023-07-23 23:21:01] [config] after-batches: 0
[2023-07-23 23:21:01] [config] after-epochs: 10
[2023-07-23 23:21:01] [config] all-caps-every: 0
[2023-07-23 23:21:01] [config] allow-unk: false
[2023-07-23 23:21:01] [config] authors: false
[2023-07-23 23:21:01] [config] beam-size: 12
[2023-07-23 23:21:01] [config] bert-class-symbol: "[CLS]"
[2023-07-23 23:21:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 23:21:01] [config] bert-masking-fraction: 0.15
[2023-07-23 23:21:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 23:21:01] [config] bert-train-type-embeddings: true
[2023-07-23 23:21:01] [config] bert-type-vocab-size: 2
[2023-07-23 23:21:01] [config] build-info: ""
[2023-07-23 23:21:01] [config] check-gradient-nan: false
[2023-07-23 23:21:01] [config] check-nan: false
[2023-07-23 23:21:01] [config] cite: false
[2023-07-23 23:21:01] [config] clip-norm: 1
[2023-07-23 23:21:01] [config] cost-scaling:
[2023-07-23 23:21:01] [config]   - 256.f
[2023-07-23 23:21:01] [config]   - 1000
[2023-07-23 23:21:01] [config]   - 2.f
[2023-07-23 23:21:01] [config]   - 256.f
[2023-07-23 23:21:01] [config] cost-type: ce-sum
[2023-07-23 23:21:01] [config] cpu-threads: 0
[2023-07-23 23:21:01] [config] data-threads: 8
[2023-07-23 23:21:01] [config] data-weighting: ""
[2023-07-23 23:21:01] [config] data-weighting-type: sentence
[2023-07-23 23:21:01] [config] dec-cell: gru
[2023-07-23 23:21:01] [config] dec-cell-base-depth: 2
[2023-07-23 23:21:01] [config] dec-cell-high-depth: 1
[2023-07-23 23:21:01] [config] dec-depth: 1
[2023-07-23 23:21:01] [config] devices:
[2023-07-23 23:21:01] [config]   - 0
[2023-07-23 23:21:01] [config] dim-emb: 512
[2023-07-23 23:21:01] [config] dim-rnn: 1024
[2023-07-23 23:21:01] [config] dim-vocabs:
[2023-07-23 23:21:01] [config]   - 16384
[2023-07-23 23:21:01] [config]   - 16384
[2023-07-23 23:21:01] [config] disp-first: 0
[2023-07-23 23:21:01] [config] disp-freq: 1000u
[2023-07-23 23:21:01] [config] disp-label-counts: true
[2023-07-23 23:21:01] [config] dropout-rnn: 0
[2023-07-23 23:21:01] [config] dropout-src: 0
[2023-07-23 23:21:01] [config] dropout-trg: 0
[2023-07-23 23:21:01] [config] dump-config: ""
[2023-07-23 23:21:01] [config] dynamic-gradient-scaling:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] early-stopping: 200
[2023-07-23 23:21:01] [config] early-stopping-on: first
[2023-07-23 23:21:01] [config] embedding-fix-src: false
[2023-07-23 23:21:01] [config] embedding-fix-trg: false
[2023-07-23 23:21:01] [config] embedding-normalization: false
[2023-07-23 23:21:01] [config] embedding-vectors:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] enc-cell: gru
[2023-07-23 23:21:01] [config] enc-cell-depth: 1
[2023-07-23 23:21:01] [config] enc-depth: 1
[2023-07-23 23:21:01] [config] enc-type: bidirectional
[2023-07-23 23:21:01] [config] english-title-case-every: 0
[2023-07-23 23:21:01] [config] exponential-smoothing: 0
[2023-07-23 23:21:01] [config] factor-weight: 1
[2023-07-23 23:21:01] [config] factors-combine: sum
[2023-07-23 23:21:01] [config] factors-dim-emb: 0
[2023-07-23 23:21:01] [config] gradient-checkpointing: false
[2023-07-23 23:21:01] [config] gradient-norm-average-window: 100
[2023-07-23 23:21:01] [config] guided-alignment: none
[2023-07-23 23:21:01] [config] guided-alignment-cost: mse
[2023-07-23 23:21:01] [config] guided-alignment-weight: 0.1
[2023-07-23 23:21:01] [config] ignore-model-config: false
[2023-07-23 23:21:01] [config] input-types:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] interpolate-env-vars: false
[2023-07-23 23:21:01] [config] keep-best: false
[2023-07-23 23:21:01] [config] label-smoothing: 0
[2023-07-23 23:21:01] [config] layer-normalization: false
[2023-07-23 23:21:01] [config] learn-rate: 0.0001
[2023-07-23 23:21:01] [config] lemma-dependency: ""
[2023-07-23 23:21:01] [config] lemma-dim-emb: 0
[2023-07-23 23:21:01] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 23:21:01] [config] log-level: info
[2023-07-23 23:21:01] [config] log-time-zone: ""
[2023-07-23 23:21:01] [config] logical-epoch:
[2023-07-23 23:21:01] [config]   - 1e
[2023-07-23 23:21:01] [config]   - 0
[2023-07-23 23:21:01] [config] lr-decay: 0
[2023-07-23 23:21:01] [config] lr-decay-freq: 50000
[2023-07-23 23:21:01] [config] lr-decay-inv-sqrt:
[2023-07-23 23:21:01] [config]   - 0
[2023-07-23 23:21:01] [config] lr-decay-repeat-warmup: false
[2023-07-23 23:21:01] [config] lr-decay-reset-optimizer: false
[2023-07-23 23:21:01] [config] lr-decay-start:
[2023-07-23 23:21:01] [config]   - 10
[2023-07-23 23:21:01] [config]   - 1
[2023-07-23 23:21:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 23:21:01] [config] lr-report: false
[2023-07-23 23:21:01] [config] lr-warmup: 0
[2023-07-23 23:21:01] [config] lr-warmup-at-reload: false
[2023-07-23 23:21:01] [config] lr-warmup-cycle: false
[2023-07-23 23:21:01] [config] lr-warmup-start-rate: 0
[2023-07-23 23:21:01] [config] max-length: 250
[2023-07-23 23:21:01] [config] max-length-crop: true
[2023-07-23 23:21:01] [config] max-length-factor: 3
[2023-07-23 23:21:01] [config] maxi-batch: 100
[2023-07-23 23:21:01] [config] maxi-batch-sort: trg
[2023-07-23 23:21:01] [config] mini-batch: 64
[2023-07-23 23:21:01] [config] mini-batch-fit: true
[2023-07-23 23:21:01] [config] mini-batch-fit-step: 10
[2023-07-23 23:21:01] [config] mini-batch-round-up: true
[2023-07-23 23:21:01] [config] mini-batch-track-lr: false
[2023-07-23 23:21:01] [config] mini-batch-warmup: 0
[2023-07-23 23:21:01] [config] mini-batch-words: 0
[2023-07-23 23:21:01] [config] mini-batch-words-ref: 0
[2023-07-23 23:21:01] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-23 23:21:01] [config] multi-loss-type: sum
[2023-07-23 23:21:01] [config] n-best: false
[2023-07-23 23:21:01] [config] no-nccl: false
[2023-07-23 23:21:01] [config] no-reload: false
[2023-07-23 23:21:01] [config] no-restore-corpus: false
[2023-07-23 23:21:01] [config] normalize: 0
[2023-07-23 23:21:01] [config] normalize-gradient: false
[2023-07-23 23:21:01] [config] num-devices: 0
[2023-07-23 23:21:01] [config] optimizer: adam
[2023-07-23 23:21:01] [config] optimizer-delay: 1
[2023-07-23 23:21:01] [config] optimizer-params:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] output-omit-bias: false
[2023-07-23 23:21:01] [config] overwrite: true
[2023-07-23 23:21:01] [config] precision:
[2023-07-23 23:21:01] [config]   - float16
[2023-07-23 23:21:01] [config]   - float32
[2023-07-23 23:21:01] [config] pretrained-model: ""
[2023-07-23 23:21:01] [config] quantize-biases: false
[2023-07-23 23:21:01] [config] quantize-bits: 0
[2023-07-23 23:21:01] [config] quantize-log-based: false
[2023-07-23 23:21:01] [config] quantize-optimization-steps: 0
[2023-07-23 23:21:01] [config] quiet: false
[2023-07-23 23:21:01] [config] quiet-translation: true
[2023-07-23 23:21:01] [config] relative-paths: false
[2023-07-23 23:21:01] [config] right-left: false
[2023-07-23 23:21:01] [config] save-freq: 10000u
[2023-07-23 23:21:01] [config] seed: 1234
[2023-07-23 23:21:01] [config] sentencepiece-alphas:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] sentencepiece-max-lines: 2000000
[2023-07-23 23:21:01] [config] sentencepiece-options: ""
[2023-07-23 23:21:01] [config] sharding: global
[2023-07-23 23:21:01] [config] shuffle: data
[2023-07-23 23:21:01] [config] shuffle-in-ram: false
[2023-07-23 23:21:01] [config] sigterm: save-and-exit
[2023-07-23 23:21:01] [config] skip: false
[2023-07-23 23:21:01] [config] sqlite: ""
[2023-07-23 23:21:01] [config] sqlite-drop: false
[2023-07-23 23:21:01] [config] sync-freq: 200u
[2023-07-23 23:21:01] [config] sync-sgd: false
[2023-07-23 23:21:01] [config] tempdir: /tmp
[2023-07-23 23:21:01] [config] tied-embeddings: false
[2023-07-23 23:21:01] [config] tied-embeddings-all: true
[2023-07-23 23:21:01] [config] tied-embeddings-src: false
[2023-07-23 23:21:01] [config] train-embedder-rank:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] train-sets:
[2023-07-23 23:21:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 23:21:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 23:21:01] [config] transformer-aan-activation: swish
[2023-07-23 23:21:01] [config] transformer-aan-depth: 2
[2023-07-23 23:21:01] [config] transformer-aan-nogate: false
[2023-07-23 23:21:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 23:21:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 23:21:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 23:21:01] [config] transformer-depth-scaling: false
[2023-07-23 23:21:01] [config] transformer-dim-aan: 2048
[2023-07-23 23:21:01] [config] transformer-dim-ffn: 2048
[2023-07-23 23:21:01] [config] transformer-dropout: 0
[2023-07-23 23:21:01] [config] transformer-dropout-attention: 0
[2023-07-23 23:21:01] [config] transformer-dropout-ffn: 0
[2023-07-23 23:21:01] [config] transformer-ffn-activation: swish
[2023-07-23 23:21:01] [config] transformer-ffn-depth: 2
[2023-07-23 23:21:01] [config] transformer-guided-alignment-layer: last
[2023-07-23 23:21:01] [config] transformer-heads: 8
[2023-07-23 23:21:01] [config] transformer-no-projection: false
[2023-07-23 23:21:01] [config] transformer-pool: false
[2023-07-23 23:21:01] [config] transformer-postprocess: dan
[2023-07-23 23:21:01] [config] transformer-postprocess-emb: d
[2023-07-23 23:21:01] [config] transformer-postprocess-top: ""
[2023-07-23 23:21:01] [config] transformer-preprocess: ""
[2023-07-23 23:21:01] [config] transformer-tied-layers:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] transformer-train-position-embeddings: false
[2023-07-23 23:21:01] [config] tsv: false
[2023-07-23 23:21:01] [config] tsv-fields: 0
[2023-07-23 23:21:01] [config] type: amun
[2023-07-23 23:21:01] [config] ulr: false
[2023-07-23 23:21:01] [config] ulr-dim-emb: 0
[2023-07-23 23:21:01] [config] ulr-dropout: 0
[2023-07-23 23:21:01] [config] ulr-keys-vectors: ""
[2023-07-23 23:21:01] [config] ulr-query-vectors: ""
[2023-07-23 23:21:01] [config] ulr-softmax-temperature: 1
[2023-07-23 23:21:01] [config] ulr-trainable-transformation: false
[2023-07-23 23:21:01] [config] unlikelihood-loss: false
[2023-07-23 23:21:01] [config] valid-freq: 50000000
[2023-07-23 23:21:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-23 23:21:01] [config] valid-max-length: 1000
[2023-07-23 23:21:01] [config] valid-metrics:
[2023-07-23 23:21:01] [config]   - cross-entropy
[2023-07-23 23:21:01] [config]   - translation
[2023-07-23 23:21:01] [config] valid-mini-batch: 32
[2023-07-23 23:21:01] [config] valid-reset-stalled: false
[2023-07-23 23:21:01] [config] valid-script-args:
[2023-07-23 23:21:01] [config]   []
[2023-07-23 23:21:01] [config] valid-script-path: ""
[2023-07-23 23:21:01] [config] valid-sets:
[2023-07-23 23:21:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 23:21:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 23:21:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-23 23:21:01] [config] vocabs:
[2023-07-23 23:21:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 23:21:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 23:21:01] [config] word-penalty: 0
[2023-07-23 23:21:01] [config] word-scores: false
[2023-07-23 23:21:01] [config] workspace: 5500
[2023-07-23 23:21:01] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 23:21:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 23:21:01] [training] Using single-device training
[2023-07-23 23:21:01] Synced seed 1234
[2023-07-23 23:21:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 23:21:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 23:21:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 23:21:02] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 23:21:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 23:21:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 23:21:02] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 23:21:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 23:21:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-23 23:21:03] [comm] Using global sharding
[2023-07-23 23:21:03] [comm] NCCLCommunicators constructed successfully
[2023-07-23 23:21:03] [training] Using 1 GPUs
[2023-07-23 23:21:03] [logits] Applying loss function for 1 factor(s)
[2023-07-23 23:21:03] [memory] Reserving 80 MB, device gpu0
[2023-07-23 23:21:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-23 23:21:03] [memory] Reserving 80 MB, device gpu0
[2023-07-24 00:07:32] [batching] Done. Typical MB size is 35,869 target words
[2023-07-24 00:07:32] [valid] No post-processing script given for validating translator
[2023-07-24 00:07:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 00:07:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 00:07:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 00:07:33] [comm] Using global sharding
[2023-07-24 00:07:33] [comm] NCCLCommunicators constructed successfully
[2023-07-24 00:07:33] [training] Using 1 GPUs
[2023-07-24 00:07:33] Training started
[2023-07-24 00:07:33] [data] Shuffling data
[2023-07-24 00:07:33] [data] Done reading 20,192 sentences
[2023-07-24 00:07:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:07:33] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-24 00:07:33] [memory] Reserving 80 MB, device gpu0
[2023-07-24 00:07:34] [memory] Reserving 80 MB, device gpu0
[2023-07-24 00:07:40] Parameter type float16, optimization type float32, casting types true
[2023-07-24 00:07:40] Allocating memory for general optimizer shards
[2023-07-24 00:07:40] [memory] Reserving 322 MB, device gpu0
[2023-07-24 00:07:40] Allocating memory for Adam-specific shards
[2023-07-24 00:07:40] [memory] Reserving 322 MB, device gpu0
[2023-07-24 00:11:17] Seen 20,192 samples
[2023-07-24 00:11:17] Starting data epoch 2 in logical epoch 2
[2023-07-24 00:11:17] [data] Shuffling data
[2023-07-24 00:11:17] [data] Done reading 20,192 sentences
[2023-07-24 00:11:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:15:52] Seen 20,192 samples
[2023-07-24 00:15:52] Starting data epoch 3 in logical epoch 3
[2023-07-24 00:15:52] [data] Shuffling data
[2023-07-24 00:15:52] [data] Done reading 20,192 sentences
[2023-07-24 00:15:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:20:31] Seen 20,192 samples
[2023-07-24 00:20:31] Starting data epoch 4 in logical epoch 4
[2023-07-24 00:20:31] [data] Shuffling data
[2023-07-24 00:20:31] [data] Done reading 20,192 sentences
[2023-07-24 00:20:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:25:10] Seen 20,192 samples
[2023-07-24 00:25:10] Starting data epoch 5 in logical epoch 5
[2023-07-24 00:25:10] [data] Shuffling data
[2023-07-24 00:25:10] [data] Done reading 20,192 sentences
[2023-07-24 00:25:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:29:55] Seen 20,192 samples
[2023-07-24 00:29:55] Starting data epoch 6 in logical epoch 6
[2023-07-24 00:29:55] [data] Shuffling data
[2023-07-24 00:29:55] [data] Done reading 20,192 sentences
[2023-07-24 00:29:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:34:36] Seen 20,192 samples
[2023-07-24 00:34:36] Starting data epoch 7 in logical epoch 7
[2023-07-24 00:34:36] [data] Shuffling data
[2023-07-24 00:34:36] [data] Done reading 20,192 sentences
[2023-07-24 00:34:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:39:18] Seen 20,192 samples
[2023-07-24 00:39:18] Starting data epoch 8 in logical epoch 8
[2023-07-24 00:39:18] [data] Shuffling data
[2023-07-24 00:39:18] [data] Done reading 20,192 sentences
[2023-07-24 00:39:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:44:03] Seen 20,192 samples
[2023-07-24 00:44:03] Starting data epoch 9 in logical epoch 9
[2023-07-24 00:44:03] [data] Shuffling data
[2023-07-24 00:44:03] [data] Done reading 20,192 sentences
[2023-07-24 00:44:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:48:46] Seen 20,192 samples
[2023-07-24 00:48:46] Starting data epoch 10 in logical epoch 10
[2023-07-24 00:48:46] [data] Shuffling data
[2023-07-24 00:48:46] [data] Done reading 20,192 sentences
[2023-07-24 00:48:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 00:53:15] Seen 20,192 samples
[2023-07-24 00:53:15] Starting data epoch 11 in logical epoch 11
[2023-07-24 00:53:15] Training finished
[2023-07-24 00:53:27] [valid] Ep. 11 : Up. 451 : cross-entropy : 173.003 : new best
[2023-07-24 00:56:12] [valid] Ep. 11 : Up. 451 : translation : 0 : new best
[2023-07-24 00:56:12] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 00:56:15] Saving Adam parameters
[2023-07-24 00:56:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 00:56:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 00:56:22] [marian] Running on node22.datos.cluster.uy as process 21443 with command line:
[2023-07-24 00:56:22] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-24 00:56:22] [config] after: 0e
[2023-07-24 00:56:22] [config] after-batches: 0
[2023-07-24 00:56:22] [config] after-epochs: 20
[2023-07-24 00:56:22] [config] all-caps-every: 0
[2023-07-24 00:56:22] [config] allow-unk: false
[2023-07-24 00:56:22] [config] authors: false
[2023-07-24 00:56:22] [config] beam-size: 12
[2023-07-24 00:56:22] [config] bert-class-symbol: "[CLS]"
[2023-07-24 00:56:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-24 00:56:22] [config] bert-masking-fraction: 0.15
[2023-07-24 00:56:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-24 00:56:22] [config] bert-train-type-embeddings: true
[2023-07-24 00:56:22] [config] bert-type-vocab-size: 2
[2023-07-24 00:56:22] [config] build-info: ""
[2023-07-24 00:56:22] [config] check-gradient-nan: false
[2023-07-24 00:56:22] [config] check-nan: false
[2023-07-24 00:56:22] [config] cite: false
[2023-07-24 00:56:22] [config] clip-norm: 1
[2023-07-24 00:56:22] [config] cost-scaling:
[2023-07-24 00:56:22] [config]   - 256.f
[2023-07-24 00:56:22] [config]   - 1000
[2023-07-24 00:56:22] [config]   - 2.f
[2023-07-24 00:56:22] [config]   - 256.f
[2023-07-24 00:56:22] [config] cost-type: ce-sum
[2023-07-24 00:56:22] [config] cpu-threads: 0
[2023-07-24 00:56:22] [config] data-threads: 8
[2023-07-24 00:56:22] [config] data-weighting: ""
[2023-07-24 00:56:22] [config] data-weighting-type: sentence
[2023-07-24 00:56:22] [config] dec-cell: gru
[2023-07-24 00:56:22] [config] dec-cell-base-depth: 2
[2023-07-24 00:56:22] [config] dec-cell-high-depth: 1
[2023-07-24 00:56:22] [config] dec-depth: 1
[2023-07-24 00:56:22] [config] devices:
[2023-07-24 00:56:22] [config]   - 0
[2023-07-24 00:56:22] [config] dim-emb: 512
[2023-07-24 00:56:22] [config] dim-rnn: 1024
[2023-07-24 00:56:22] [config] dim-vocabs:
[2023-07-24 00:56:22] [config]   - 16384
[2023-07-24 00:56:22] [config]   - 16384
[2023-07-24 00:56:22] [config] disp-first: 0
[2023-07-24 00:56:22] [config] disp-freq: 1000u
[2023-07-24 00:56:22] [config] disp-label-counts: true
[2023-07-24 00:56:22] [config] dropout-rnn: 0
[2023-07-24 00:56:22] [config] dropout-src: 0
[2023-07-24 00:56:22] [config] dropout-trg: 0
[2023-07-24 00:56:22] [config] dump-config: ""
[2023-07-24 00:56:22] [config] dynamic-gradient-scaling:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] early-stopping: 200
[2023-07-24 00:56:22] [config] early-stopping-on: first
[2023-07-24 00:56:22] [config] embedding-fix-src: false
[2023-07-24 00:56:22] [config] embedding-fix-trg: false
[2023-07-24 00:56:22] [config] embedding-normalization: false
[2023-07-24 00:56:22] [config] embedding-vectors:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] enc-cell: gru
[2023-07-24 00:56:22] [config] enc-cell-depth: 1
[2023-07-24 00:56:22] [config] enc-depth: 1
[2023-07-24 00:56:22] [config] enc-type: bidirectional
[2023-07-24 00:56:22] [config] english-title-case-every: 0
[2023-07-24 00:56:22] [config] exponential-smoothing: 0
[2023-07-24 00:56:22] [config] factor-weight: 1
[2023-07-24 00:56:22] [config] factors-combine: sum
[2023-07-24 00:56:22] [config] factors-dim-emb: 0
[2023-07-24 00:56:22] [config] gradient-checkpointing: false
[2023-07-24 00:56:22] [config] gradient-norm-average-window: 100
[2023-07-24 00:56:22] [config] guided-alignment: none
[2023-07-24 00:56:22] [config] guided-alignment-cost: mse
[2023-07-24 00:56:22] [config] guided-alignment-weight: 0.1
[2023-07-24 00:56:22] [config] ignore-model-config: false
[2023-07-24 00:56:22] [config] input-types:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] interpolate-env-vars: false
[2023-07-24 00:56:22] [config] keep-best: false
[2023-07-24 00:56:22] [config] label-smoothing: 0
[2023-07-24 00:56:22] [config] layer-normalization: false
[2023-07-24 00:56:22] [config] learn-rate: 0.0001
[2023-07-24 00:56:22] [config] lemma-dependency: ""
[2023-07-24 00:56:22] [config] lemma-dim-emb: 0
[2023-07-24 00:56:22] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 00:56:22] [config] log-level: info
[2023-07-24 00:56:22] [config] log-time-zone: ""
[2023-07-24 00:56:22] [config] logical-epoch:
[2023-07-24 00:56:22] [config]   - 1e
[2023-07-24 00:56:22] [config]   - 0
[2023-07-24 00:56:22] [config] lr-decay: 0
[2023-07-24 00:56:22] [config] lr-decay-freq: 50000
[2023-07-24 00:56:22] [config] lr-decay-inv-sqrt:
[2023-07-24 00:56:22] [config]   - 0
[2023-07-24 00:56:22] [config] lr-decay-repeat-warmup: false
[2023-07-24 00:56:22] [config] lr-decay-reset-optimizer: false
[2023-07-24 00:56:22] [config] lr-decay-start:
[2023-07-24 00:56:22] [config]   - 10
[2023-07-24 00:56:22] [config]   - 1
[2023-07-24 00:56:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-24 00:56:22] [config] lr-report: false
[2023-07-24 00:56:22] [config] lr-warmup: 0
[2023-07-24 00:56:22] [config] lr-warmup-at-reload: false
[2023-07-24 00:56:22] [config] lr-warmup-cycle: false
[2023-07-24 00:56:22] [config] lr-warmup-start-rate: 0
[2023-07-24 00:56:22] [config] max-length: 250
[2023-07-24 00:56:22] [config] max-length-crop: true
[2023-07-24 00:56:22] [config] max-length-factor: 3
[2023-07-24 00:56:22] [config] maxi-batch: 100
[2023-07-24 00:56:22] [config] maxi-batch-sort: trg
[2023-07-24 00:56:22] [config] mini-batch: 64
[2023-07-24 00:56:22] [config] mini-batch-fit: true
[2023-07-24 00:56:22] [config] mini-batch-fit-step: 10
[2023-07-24 00:56:22] [config] mini-batch-round-up: true
[2023-07-24 00:56:22] [config] mini-batch-track-lr: false
[2023-07-24 00:56:22] [config] mini-batch-warmup: 0
[2023-07-24 00:56:22] [config] mini-batch-words: 0
[2023-07-24 00:56:22] [config] mini-batch-words-ref: 0
[2023-07-24 00:56:22] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 00:56:22] [config] multi-loss-type: sum
[2023-07-24 00:56:22] [config] n-best: false
[2023-07-24 00:56:22] [config] no-nccl: false
[2023-07-24 00:56:22] [config] no-reload: false
[2023-07-24 00:56:22] [config] no-restore-corpus: false
[2023-07-24 00:56:22] [config] normalize: 0
[2023-07-24 00:56:22] [config] normalize-gradient: false
[2023-07-24 00:56:22] [config] num-devices: 0
[2023-07-24 00:56:22] [config] optimizer: adam
[2023-07-24 00:56:22] [config] optimizer-delay: 1
[2023-07-24 00:56:22] [config] optimizer-params:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] output-omit-bias: false
[2023-07-24 00:56:22] [config] overwrite: true
[2023-07-24 00:56:22] [config] precision:
[2023-07-24 00:56:22] [config]   - float16
[2023-07-24 00:56:22] [config]   - float32
[2023-07-24 00:56:22] [config] pretrained-model: ""
[2023-07-24 00:56:22] [config] quantize-biases: false
[2023-07-24 00:56:22] [config] quantize-bits: 0
[2023-07-24 00:56:22] [config] quantize-log-based: false
[2023-07-24 00:56:22] [config] quantize-optimization-steps: 0
[2023-07-24 00:56:22] [config] quiet: false
[2023-07-24 00:56:22] [config] quiet-translation: true
[2023-07-24 00:56:22] [config] relative-paths: false
[2023-07-24 00:56:22] [config] right-left: false
[2023-07-24 00:56:22] [config] save-freq: 10000u
[2023-07-24 00:56:22] [config] seed: 1234
[2023-07-24 00:56:22] [config] sentencepiece-alphas:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] sentencepiece-max-lines: 2000000
[2023-07-24 00:56:22] [config] sentencepiece-options: ""
[2023-07-24 00:56:22] [config] sharding: global
[2023-07-24 00:56:22] [config] shuffle: data
[2023-07-24 00:56:22] [config] shuffle-in-ram: false
[2023-07-24 00:56:22] [config] sigterm: save-and-exit
[2023-07-24 00:56:22] [config] skip: false
[2023-07-24 00:56:22] [config] sqlite: ""
[2023-07-24 00:56:22] [config] sqlite-drop: false
[2023-07-24 00:56:22] [config] sync-freq: 200u
[2023-07-24 00:56:22] [config] sync-sgd: false
[2023-07-24 00:56:22] [config] tempdir: /tmp
[2023-07-24 00:56:22] [config] tied-embeddings: false
[2023-07-24 00:56:22] [config] tied-embeddings-all: true
[2023-07-24 00:56:22] [config] tied-embeddings-src: false
[2023-07-24 00:56:22] [config] train-embedder-rank:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] train-sets:
[2023-07-24 00:56:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-24 00:56:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-24 00:56:22] [config] transformer-aan-activation: swish
[2023-07-24 00:56:22] [config] transformer-aan-depth: 2
[2023-07-24 00:56:22] [config] transformer-aan-nogate: false
[2023-07-24 00:56:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-24 00:56:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-24 00:56:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-24 00:56:22] [config] transformer-depth-scaling: false
[2023-07-24 00:56:22] [config] transformer-dim-aan: 2048
[2023-07-24 00:56:22] [config] transformer-dim-ffn: 2048
[2023-07-24 00:56:22] [config] transformer-dropout: 0
[2023-07-24 00:56:22] [config] transformer-dropout-attention: 0
[2023-07-24 00:56:22] [config] transformer-dropout-ffn: 0
[2023-07-24 00:56:22] [config] transformer-ffn-activation: swish
[2023-07-24 00:56:22] [config] transformer-ffn-depth: 2
[2023-07-24 00:56:22] [config] transformer-guided-alignment-layer: last
[2023-07-24 00:56:22] [config] transformer-heads: 8
[2023-07-24 00:56:22] [config] transformer-no-projection: false
[2023-07-24 00:56:22] [config] transformer-pool: false
[2023-07-24 00:56:22] [config] transformer-postprocess: dan
[2023-07-24 00:56:22] [config] transformer-postprocess-emb: d
[2023-07-24 00:56:22] [config] transformer-postprocess-top: ""
[2023-07-24 00:56:22] [config] transformer-preprocess: ""
[2023-07-24 00:56:22] [config] transformer-tied-layers:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] transformer-train-position-embeddings: false
[2023-07-24 00:56:22] [config] tsv: false
[2023-07-24 00:56:22] [config] tsv-fields: 0
[2023-07-24 00:56:22] [config] type: amun
[2023-07-24 00:56:22] [config] ulr: false
[2023-07-24 00:56:22] [config] ulr-dim-emb: 0
[2023-07-24 00:56:22] [config] ulr-dropout: 0
[2023-07-24 00:56:22] [config] ulr-keys-vectors: ""
[2023-07-24 00:56:22] [config] ulr-query-vectors: ""
[2023-07-24 00:56:22] [config] ulr-softmax-temperature: 1
[2023-07-24 00:56:22] [config] ulr-trainable-transformation: false
[2023-07-24 00:56:22] [config] unlikelihood-loss: false
[2023-07-24 00:56:22] [config] valid-freq: 50000000
[2023-07-24 00:56:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 00:56:22] [config] valid-max-length: 1000
[2023-07-24 00:56:22] [config] valid-metrics:
[2023-07-24 00:56:22] [config]   - cross-entropy
[2023-07-24 00:56:22] [config]   - translation
[2023-07-24 00:56:22] [config] valid-mini-batch: 32
[2023-07-24 00:56:22] [config] valid-reset-stalled: false
[2023-07-24 00:56:22] [config] valid-script-args:
[2023-07-24 00:56:22] [config]   []
[2023-07-24 00:56:22] [config] valid-script-path: ""
[2023-07-24 00:56:22] [config] valid-sets:
[2023-07-24 00:56:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-24 00:56:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-24 00:56:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-24 00:56:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 00:56:22] [config] vocabs:
[2023-07-24 00:56:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 00:56:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 00:56:22] [config] word-penalty: 0
[2023-07-24 00:56:22] [config] word-scores: false
[2023-07-24 00:56:22] [config] workspace: 5500
[2023-07-24 00:56:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 00:56:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 00:56:22] [training] Using single-device training
[2023-07-24 00:56:23] Synced seed 1234
[2023-07-24 00:56:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 00:56:23] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-24 00:56:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 00:56:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-24 00:56:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-24 00:56:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 00:56:23] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-24 00:56:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 00:56:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 00:56:25] [comm] Using global sharding
[2023-07-24 00:56:25] [comm] NCCLCommunicators constructed successfully
[2023-07-24 00:56:25] [training] Using 1 GPUs
[2023-07-24 00:56:25] [logits] Applying loss function for 1 factor(s)
[2023-07-24 00:56:25] [memory] Reserving 80 MB, device gpu0
[2023-07-24 00:56:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-24 00:56:25] [memory] Reserving 80 MB, device gpu0
[2023-07-24 01:42:34] [batching] Done. Typical MB size is 35,869 target words
[2023-07-24 01:42:34] [valid] No post-processing script given for validating translator
[2023-07-24 01:42:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 01:42:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 01:42:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 01:42:34] [comm] Using global sharding
[2023-07-24 01:42:34] [comm] NCCLCommunicators constructed successfully
[2023-07-24 01:42:34] [training] Using 1 GPUs
[2023-07-24 01:42:34] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 01:42:39] Allocating memory for general optimizer shards
[2023-07-24 01:42:39] [memory] Reserving 322 MB, device gpu0
[2023-07-24 01:42:39] Loading Adam parameters
[2023-07-24 01:42:40] [memory] Reserving 322 MB, device gpu0
[2023-07-24 01:42:40] [memory] Reserving 80 MB, device gpu0
[2023-07-24 01:42:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 01:42:40] [data] Restoring the corpus state to epoch 11, batch 451
[2023-07-24 01:42:40] [data] Shuffling data
[2023-07-24 01:42:40] [data] Done reading 20,192 sentences
[2023-07-24 01:42:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 01:42:40] Training started
[2023-07-24 01:42:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-24 01:42:40] [memory] Reserving 80 MB, device gpu0
[2023-07-24 01:42:42] Parameter type float16, optimization type float32, casting types true
[2023-07-24 01:46:51] Seen 20,192 samples
[2023-07-24 01:46:51] Starting data epoch 12 in logical epoch 12
[2023-07-24 01:46:51] [data] Shuffling data
[2023-07-24 01:46:51] [data] Done reading 20,192 sentences
[2023-07-24 01:46:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 01:51:24] Seen 20,192 samples
[2023-07-24 01:51:24] Starting data epoch 13 in logical epoch 13
[2023-07-24 01:51:24] [data] Shuffling data
[2023-07-24 01:51:24] [data] Done reading 20,192 sentences
[2023-07-24 01:51:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 01:56:04] Seen 20,192 samples
[2023-07-24 01:56:04] Starting data epoch 14 in logical epoch 14
[2023-07-24 01:56:04] [data] Shuffling data
[2023-07-24 01:56:04] [data] Done reading 20,192 sentences
[2023-07-24 01:56:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 02:00:30] Seen 20,192 samples
[2023-07-24 02:00:30] Starting data epoch 15 in logical epoch 15
[2023-07-24 02:00:30] [data] Shuffling data
[2023-07-24 02:00:30] [data] Done reading 20,192 sentences
[2023-07-24 02:00:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 02:04:47] Seen 20,192 samples
[2023-07-24 02:04:47] Starting data epoch 16 in logical epoch 16
[2023-07-24 02:04:47] [data] Shuffling data
[2023-07-24 02:04:47] [data] Done reading 20,192 sentences
[2023-07-24 02:04:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 02:09:05] Seen 20,192 samples
[2023-07-24 02:09:05] Starting data epoch 17 in logical epoch 17
[2023-07-24 02:09:05] [data] Shuffling data
[2023-07-24 02:09:05] [data] Done reading 20,192 sentences
[2023-07-24 02:09:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 02:13:34] Seen 20,192 samples
[2023-07-24 02:13:34] Starting data epoch 18 in logical epoch 18
[2023-07-24 02:13:34] [data] Shuffling data
[2023-07-24 02:13:34] [data] Done reading 20,192 sentences
[2023-07-24 02:13:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 02:18:11] Seen 20,192 samples
[2023-07-24 02:18:11] Starting data epoch 19 in logical epoch 19
[2023-07-24 02:18:11] [data] Shuffling data
[2023-07-24 02:18:11] [data] Done reading 20,192 sentences
[2023-07-24 02:18:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 02:22:29] Seen 20,192 samples
[2023-07-24 02:22:29] Starting data epoch 20 in logical epoch 20
[2023-07-24 02:22:29] [data] Shuffling data
[2023-07-24 02:22:29] [data] Done reading 20,192 sentences
[2023-07-24 02:22:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 02:27:01] Seen 20,192 samples
[2023-07-24 02:27:01] Starting data epoch 21 in logical epoch 21
[2023-07-24 02:27:01] Training finished
[2023-07-24 02:27:13] [valid] Ep. 21 : Up. 896 : cross-entropy : 159.812 : new best
[2023-07-24 02:29:36] [valid] Ep. 21 : Up. 896 : translation : 0 : new best
[2023-07-24 02:29:36] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 02:29:38] Saving Adam parameters
[2023-07-24 02:29:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 02:29:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 02:29:46] [marian] Running on node22.datos.cluster.uy as process 27402 with command line:
[2023-07-24 02:29:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-24 02:29:46] [config] after: 0e
[2023-07-24 02:29:46] [config] after-batches: 0
[2023-07-24 02:29:46] [config] after-epochs: 30
[2023-07-24 02:29:46] [config] all-caps-every: 0
[2023-07-24 02:29:46] [config] allow-unk: false
[2023-07-24 02:29:46] [config] authors: false
[2023-07-24 02:29:46] [config] beam-size: 12
[2023-07-24 02:29:46] [config] bert-class-symbol: "[CLS]"
[2023-07-24 02:29:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-24 02:29:46] [config] bert-masking-fraction: 0.15
[2023-07-24 02:29:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-24 02:29:46] [config] bert-train-type-embeddings: true
[2023-07-24 02:29:46] [config] bert-type-vocab-size: 2
[2023-07-24 02:29:46] [config] build-info: ""
[2023-07-24 02:29:46] [config] check-gradient-nan: false
[2023-07-24 02:29:46] [config] check-nan: false
[2023-07-24 02:29:46] [config] cite: false
[2023-07-24 02:29:46] [config] clip-norm: 1
[2023-07-24 02:29:46] [config] cost-scaling:
[2023-07-24 02:29:46] [config]   - 256.f
[2023-07-24 02:29:46] [config]   - 1000
[2023-07-24 02:29:46] [config]   - 2.f
[2023-07-24 02:29:46] [config]   - 256.f
[2023-07-24 02:29:46] [config] cost-type: ce-sum
[2023-07-24 02:29:46] [config] cpu-threads: 0
[2023-07-24 02:29:46] [config] data-threads: 8
[2023-07-24 02:29:46] [config] data-weighting: ""
[2023-07-24 02:29:46] [config] data-weighting-type: sentence
[2023-07-24 02:29:46] [config] dec-cell: gru
[2023-07-24 02:29:46] [config] dec-cell-base-depth: 2
[2023-07-24 02:29:46] [config] dec-cell-high-depth: 1
[2023-07-24 02:29:46] [config] dec-depth: 1
[2023-07-24 02:29:46] [config] devices:
[2023-07-24 02:29:46] [config]   - 0
[2023-07-24 02:29:46] [config] dim-emb: 512
[2023-07-24 02:29:46] [config] dim-rnn: 1024
[2023-07-24 02:29:46] [config] dim-vocabs:
[2023-07-24 02:29:46] [config]   - 16384
[2023-07-24 02:29:46] [config]   - 16384
[2023-07-24 02:29:46] [config] disp-first: 0
[2023-07-24 02:29:46] [config] disp-freq: 1000u
[2023-07-24 02:29:46] [config] disp-label-counts: true
[2023-07-24 02:29:46] [config] dropout-rnn: 0
[2023-07-24 02:29:46] [config] dropout-src: 0
[2023-07-24 02:29:46] [config] dropout-trg: 0
[2023-07-24 02:29:46] [config] dump-config: ""
[2023-07-24 02:29:46] [config] dynamic-gradient-scaling:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] early-stopping: 200
[2023-07-24 02:29:46] [config] early-stopping-on: first
[2023-07-24 02:29:46] [config] embedding-fix-src: false
[2023-07-24 02:29:46] [config] embedding-fix-trg: false
[2023-07-24 02:29:46] [config] embedding-normalization: false
[2023-07-24 02:29:46] [config] embedding-vectors:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] enc-cell: gru
[2023-07-24 02:29:46] [config] enc-cell-depth: 1
[2023-07-24 02:29:46] [config] enc-depth: 1
[2023-07-24 02:29:46] [config] enc-type: bidirectional
[2023-07-24 02:29:46] [config] english-title-case-every: 0
[2023-07-24 02:29:46] [config] exponential-smoothing: 0
[2023-07-24 02:29:46] [config] factor-weight: 1
[2023-07-24 02:29:46] [config] factors-combine: sum
[2023-07-24 02:29:46] [config] factors-dim-emb: 0
[2023-07-24 02:29:46] [config] gradient-checkpointing: false
[2023-07-24 02:29:46] [config] gradient-norm-average-window: 100
[2023-07-24 02:29:46] [config] guided-alignment: none
[2023-07-24 02:29:46] [config] guided-alignment-cost: mse
[2023-07-24 02:29:46] [config] guided-alignment-weight: 0.1
[2023-07-24 02:29:46] [config] ignore-model-config: false
[2023-07-24 02:29:46] [config] input-types:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] interpolate-env-vars: false
[2023-07-24 02:29:46] [config] keep-best: false
[2023-07-24 02:29:46] [config] label-smoothing: 0
[2023-07-24 02:29:46] [config] layer-normalization: false
[2023-07-24 02:29:46] [config] learn-rate: 0.0001
[2023-07-24 02:29:46] [config] lemma-dependency: ""
[2023-07-24 02:29:46] [config] lemma-dim-emb: 0
[2023-07-24 02:29:46] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 02:29:46] [config] log-level: info
[2023-07-24 02:29:46] [config] log-time-zone: ""
[2023-07-24 02:29:46] [config] logical-epoch:
[2023-07-24 02:29:46] [config]   - 1e
[2023-07-24 02:29:46] [config]   - 0
[2023-07-24 02:29:46] [config] lr-decay: 0
[2023-07-24 02:29:46] [config] lr-decay-freq: 50000
[2023-07-24 02:29:46] [config] lr-decay-inv-sqrt:
[2023-07-24 02:29:46] [config]   - 0
[2023-07-24 02:29:46] [config] lr-decay-repeat-warmup: false
[2023-07-24 02:29:46] [config] lr-decay-reset-optimizer: false
[2023-07-24 02:29:46] [config] lr-decay-start:
[2023-07-24 02:29:46] [config]   - 10
[2023-07-24 02:29:46] [config]   - 1
[2023-07-24 02:29:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-24 02:29:46] [config] lr-report: false
[2023-07-24 02:29:46] [config] lr-warmup: 0
[2023-07-24 02:29:46] [config] lr-warmup-at-reload: false
[2023-07-24 02:29:46] [config] lr-warmup-cycle: false
[2023-07-24 02:29:46] [config] lr-warmup-start-rate: 0
[2023-07-24 02:29:46] [config] max-length: 250
[2023-07-24 02:29:46] [config] max-length-crop: true
[2023-07-24 02:29:46] [config] max-length-factor: 3
[2023-07-24 02:29:46] [config] maxi-batch: 100
[2023-07-24 02:29:46] [config] maxi-batch-sort: trg
[2023-07-24 02:29:46] [config] mini-batch: 64
[2023-07-24 02:29:46] [config] mini-batch-fit: true
[2023-07-24 02:29:46] [config] mini-batch-fit-step: 10
[2023-07-24 02:29:46] [config] mini-batch-round-up: true
[2023-07-24 02:29:46] [config] mini-batch-track-lr: false
[2023-07-24 02:29:46] [config] mini-batch-warmup: 0
[2023-07-24 02:29:46] [config] mini-batch-words: 0
[2023-07-24 02:29:46] [config] mini-batch-words-ref: 0
[2023-07-24 02:29:46] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 02:29:46] [config] multi-loss-type: sum
[2023-07-24 02:29:46] [config] n-best: false
[2023-07-24 02:29:46] [config] no-nccl: false
[2023-07-24 02:29:46] [config] no-reload: false
[2023-07-24 02:29:46] [config] no-restore-corpus: false
[2023-07-24 02:29:46] [config] normalize: 0
[2023-07-24 02:29:46] [config] normalize-gradient: false
[2023-07-24 02:29:46] [config] num-devices: 0
[2023-07-24 02:29:46] [config] optimizer: adam
[2023-07-24 02:29:46] [config] optimizer-delay: 1
[2023-07-24 02:29:46] [config] optimizer-params:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] output-omit-bias: false
[2023-07-24 02:29:46] [config] overwrite: true
[2023-07-24 02:29:46] [config] precision:
[2023-07-24 02:29:46] [config]   - float16
[2023-07-24 02:29:46] [config]   - float32
[2023-07-24 02:29:46] [config] pretrained-model: ""
[2023-07-24 02:29:46] [config] quantize-biases: false
[2023-07-24 02:29:46] [config] quantize-bits: 0
[2023-07-24 02:29:46] [config] quantize-log-based: false
[2023-07-24 02:29:46] [config] quantize-optimization-steps: 0
[2023-07-24 02:29:46] [config] quiet: false
[2023-07-24 02:29:46] [config] quiet-translation: true
[2023-07-24 02:29:46] [config] relative-paths: false
[2023-07-24 02:29:46] [config] right-left: false
[2023-07-24 02:29:46] [config] save-freq: 10000u
[2023-07-24 02:29:46] [config] seed: 1234
[2023-07-24 02:29:46] [config] sentencepiece-alphas:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] sentencepiece-max-lines: 2000000
[2023-07-24 02:29:46] [config] sentencepiece-options: ""
[2023-07-24 02:29:46] [config] sharding: global
[2023-07-24 02:29:46] [config] shuffle: data
[2023-07-24 02:29:46] [config] shuffle-in-ram: false
[2023-07-24 02:29:46] [config] sigterm: save-and-exit
[2023-07-24 02:29:46] [config] skip: false
[2023-07-24 02:29:46] [config] sqlite: ""
[2023-07-24 02:29:46] [config] sqlite-drop: false
[2023-07-24 02:29:46] [config] sync-freq: 200u
[2023-07-24 02:29:46] [config] sync-sgd: false
[2023-07-24 02:29:46] [config] tempdir: /tmp
[2023-07-24 02:29:46] [config] tied-embeddings: false
[2023-07-24 02:29:46] [config] tied-embeddings-all: true
[2023-07-24 02:29:46] [config] tied-embeddings-src: false
[2023-07-24 02:29:46] [config] train-embedder-rank:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] train-sets:
[2023-07-24 02:29:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-24 02:29:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-24 02:29:46] [config] transformer-aan-activation: swish
[2023-07-24 02:29:46] [config] transformer-aan-depth: 2
[2023-07-24 02:29:46] [config] transformer-aan-nogate: false
[2023-07-24 02:29:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-24 02:29:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-24 02:29:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-24 02:29:46] [config] transformer-depth-scaling: false
[2023-07-24 02:29:46] [config] transformer-dim-aan: 2048
[2023-07-24 02:29:46] [config] transformer-dim-ffn: 2048
[2023-07-24 02:29:46] [config] transformer-dropout: 0
[2023-07-24 02:29:46] [config] transformer-dropout-attention: 0
[2023-07-24 02:29:46] [config] transformer-dropout-ffn: 0
[2023-07-24 02:29:46] [config] transformer-ffn-activation: swish
[2023-07-24 02:29:46] [config] transformer-ffn-depth: 2
[2023-07-24 02:29:46] [config] transformer-guided-alignment-layer: last
[2023-07-24 02:29:46] [config] transformer-heads: 8
[2023-07-24 02:29:46] [config] transformer-no-projection: false
[2023-07-24 02:29:46] [config] transformer-pool: false
[2023-07-24 02:29:46] [config] transformer-postprocess: dan
[2023-07-24 02:29:46] [config] transformer-postprocess-emb: d
[2023-07-24 02:29:46] [config] transformer-postprocess-top: ""
[2023-07-24 02:29:46] [config] transformer-preprocess: ""
[2023-07-24 02:29:46] [config] transformer-tied-layers:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] transformer-train-position-embeddings: false
[2023-07-24 02:29:46] [config] tsv: false
[2023-07-24 02:29:46] [config] tsv-fields: 0
[2023-07-24 02:29:46] [config] type: amun
[2023-07-24 02:29:46] [config] ulr: false
[2023-07-24 02:29:46] [config] ulr-dim-emb: 0
[2023-07-24 02:29:46] [config] ulr-dropout: 0
[2023-07-24 02:29:46] [config] ulr-keys-vectors: ""
[2023-07-24 02:29:46] [config] ulr-query-vectors: ""
[2023-07-24 02:29:46] [config] ulr-softmax-temperature: 1
[2023-07-24 02:29:46] [config] ulr-trainable-transformation: false
[2023-07-24 02:29:46] [config] unlikelihood-loss: false
[2023-07-24 02:29:46] [config] valid-freq: 50000000
[2023-07-24 02:29:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 02:29:46] [config] valid-max-length: 1000
[2023-07-24 02:29:46] [config] valid-metrics:
[2023-07-24 02:29:46] [config]   - cross-entropy
[2023-07-24 02:29:46] [config]   - translation
[2023-07-24 02:29:46] [config] valid-mini-batch: 32
[2023-07-24 02:29:46] [config] valid-reset-stalled: false
[2023-07-24 02:29:46] [config] valid-script-args:
[2023-07-24 02:29:46] [config]   []
[2023-07-24 02:29:46] [config] valid-script-path: ""
[2023-07-24 02:29:46] [config] valid-sets:
[2023-07-24 02:29:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-24 02:29:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-24 02:29:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-24 02:29:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 02:29:46] [config] vocabs:
[2023-07-24 02:29:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 02:29:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 02:29:46] [config] word-penalty: 0
[2023-07-24 02:29:46] [config] word-scores: false
[2023-07-24 02:29:46] [config] workspace: 5500
[2023-07-24 02:29:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 02:29:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 02:29:46] [training] Using single-device training
[2023-07-24 02:29:47] Synced seed 1234
[2023-07-24 02:29:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 02:29:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-24 02:29:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 02:29:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-24 02:29:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-24 02:29:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 02:29:47] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-24 02:29:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 02:29:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 02:29:48] [comm] Using global sharding
[2023-07-24 02:29:49] [comm] NCCLCommunicators constructed successfully
[2023-07-24 02:29:49] [training] Using 1 GPUs
[2023-07-24 02:29:49] [logits] Applying loss function for 1 factor(s)
[2023-07-24 02:29:49] [memory] Reserving 80 MB, device gpu0
[2023-07-24 02:29:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-24 02:29:49] [memory] Reserving 80 MB, device gpu0
[2023-07-24 03:16:26] [batching] Done. Typical MB size is 35,869 target words
[2023-07-24 03:16:26] [valid] No post-processing script given for validating translator
[2023-07-24 03:16:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 03:16:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 03:16:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 03:16:26] [comm] Using global sharding
[2023-07-24 03:16:26] [comm] NCCLCommunicators constructed successfully
[2023-07-24 03:16:26] [training] Using 1 GPUs
[2023-07-24 03:16:26] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 03:16:28] Allocating memory for general optimizer shards
[2023-07-24 03:16:28] [memory] Reserving 322 MB, device gpu0
[2023-07-24 03:16:28] Loading Adam parameters
[2023-07-24 03:16:28] [memory] Reserving 322 MB, device gpu0
[2023-07-24 03:16:28] [memory] Reserving 80 MB, device gpu0
[2023-07-24 03:16:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 03:16:28] [data] Restoring the corpus state to epoch 21, batch 896
[2023-07-24 03:16:28] [data] Shuffling data
[2023-07-24 03:16:28] [data] Done reading 20,192 sentences
[2023-07-24 03:16:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:16:28] Training started
[2023-07-24 03:16:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-24 03:16:29] [memory] Reserving 80 MB, device gpu0
[2023-07-24 03:16:34] Parameter type float16, optimization type float32, casting types true
[2023-07-24 03:21:00] Seen 20,192 samples
[2023-07-24 03:21:00] Starting data epoch 22 in logical epoch 22
[2023-07-24 03:21:00] [data] Shuffling data
[2023-07-24 03:21:00] [data] Done reading 20,192 sentences
[2023-07-24 03:21:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:25:43] Seen 20,192 samples
[2023-07-24 03:25:43] Starting data epoch 23 in logical epoch 23
[2023-07-24 03:25:43] [data] Shuffling data
[2023-07-24 03:25:43] [data] Done reading 20,192 sentences
[2023-07-24 03:25:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:27:10] Ep. 23 : Up. 1000 : Sen. 7,263 : Cost 6.63864040 * 12,149,750 @ 4,359 after 12,149,750 : Time 644.74s : 18844.29 words/s : gNorm 1.1086
[2023-07-24 03:30:26] Seen 20,192 samples
[2023-07-24 03:30:26] Starting data epoch 24 in logical epoch 24
[2023-07-24 03:30:26] [data] Shuffling data
[2023-07-24 03:30:26] [data] Done reading 20,192 sentences
[2023-07-24 03:30:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:35:04] Seen 20,192 samples
[2023-07-24 03:35:04] Starting data epoch 25 in logical epoch 25
[2023-07-24 03:35:04] [data] Shuffling data
[2023-07-24 03:35:04] [data] Done reading 20,192 sentences
[2023-07-24 03:35:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:39:43] Seen 20,192 samples
[2023-07-24 03:39:43] Starting data epoch 26 in logical epoch 26
[2023-07-24 03:39:43] [data] Shuffling data
[2023-07-24 03:39:43] [data] Done reading 20,192 sentences
[2023-07-24 03:39:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:44:21] Seen 20,192 samples
[2023-07-24 03:44:21] Starting data epoch 27 in logical epoch 27
[2023-07-24 03:44:21] [data] Shuffling data
[2023-07-24 03:44:21] [data] Done reading 20,192 sentences
[2023-07-24 03:44:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:49:11] Seen 20,192 samples
[2023-07-24 03:49:11] Starting data epoch 28 in logical epoch 28
[2023-07-24 03:49:11] [data] Shuffling data
[2023-07-24 03:49:11] [data] Done reading 20,192 sentences
[2023-07-24 03:49:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:53:57] Seen 20,192 samples
[2023-07-24 03:53:57] Starting data epoch 29 in logical epoch 29
[2023-07-24 03:53:57] [data] Shuffling data
[2023-07-24 03:53:57] [data] Done reading 20,192 sentences
[2023-07-24 03:53:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 03:58:33] Seen 20,192 samples
[2023-07-24 03:58:33] Starting data epoch 30 in logical epoch 30
[2023-07-24 03:58:33] [data] Shuffling data
[2023-07-24 03:58:33] [data] Done reading 20,192 sentences
[2023-07-24 03:58:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 04:03:24] Seen 20,192 samples
[2023-07-24 04:03:24] Starting data epoch 31 in logical epoch 31
[2023-07-24 04:03:24] Training finished
[2023-07-24 04:03:35] [valid] Ep. 31 : Up. 1343 : cross-entropy : 149.177 : new best
[2023-07-24 04:07:28] [valid] Ep. 31 : Up. 1343 : translation : 0 : new best
[2023-07-24 04:07:28] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 04:07:30] Saving Adam parameters
[2023-07-24 04:07:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 04:07:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 04:07:37] [marian] Running on node22.datos.cluster.uy as process 33563 with command line:
[2023-07-24 04:07:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-24 04:07:37] [config] after: 0e
[2023-07-24 04:07:37] [config] after-batches: 0
[2023-07-24 04:07:37] [config] after-epochs: 40
[2023-07-24 04:07:37] [config] all-caps-every: 0
[2023-07-24 04:07:37] [config] allow-unk: false
[2023-07-24 04:07:37] [config] authors: false
[2023-07-24 04:07:37] [config] beam-size: 12
[2023-07-24 04:07:37] [config] bert-class-symbol: "[CLS]"
[2023-07-24 04:07:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-24 04:07:37] [config] bert-masking-fraction: 0.15
[2023-07-24 04:07:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-24 04:07:37] [config] bert-train-type-embeddings: true
[2023-07-24 04:07:37] [config] bert-type-vocab-size: 2
[2023-07-24 04:07:37] [config] build-info: ""
[2023-07-24 04:07:37] [config] check-gradient-nan: false
[2023-07-24 04:07:37] [config] check-nan: false
[2023-07-24 04:07:37] [config] cite: false
[2023-07-24 04:07:37] [config] clip-norm: 1
[2023-07-24 04:07:37] [config] cost-scaling:
[2023-07-24 04:07:37] [config]   - 256.f
[2023-07-24 04:07:37] [config]   - 1000
[2023-07-24 04:07:37] [config]   - 2.f
[2023-07-24 04:07:37] [config]   - 256.f
[2023-07-24 04:07:37] [config] cost-type: ce-sum
[2023-07-24 04:07:37] [config] cpu-threads: 0
[2023-07-24 04:07:37] [config] data-threads: 8
[2023-07-24 04:07:37] [config] data-weighting: ""
[2023-07-24 04:07:37] [config] data-weighting-type: sentence
[2023-07-24 04:07:37] [config] dec-cell: gru
[2023-07-24 04:07:37] [config] dec-cell-base-depth: 2
[2023-07-24 04:07:37] [config] dec-cell-high-depth: 1
[2023-07-24 04:07:37] [config] dec-depth: 1
[2023-07-24 04:07:37] [config] devices:
[2023-07-24 04:07:37] [config]   - 0
[2023-07-24 04:07:37] [config] dim-emb: 512
[2023-07-24 04:07:37] [config] dim-rnn: 1024
[2023-07-24 04:07:37] [config] dim-vocabs:
[2023-07-24 04:07:37] [config]   - 16384
[2023-07-24 04:07:37] [config]   - 16384
[2023-07-24 04:07:37] [config] disp-first: 0
[2023-07-24 04:07:37] [config] disp-freq: 1000u
[2023-07-24 04:07:37] [config] disp-label-counts: true
[2023-07-24 04:07:37] [config] dropout-rnn: 0
[2023-07-24 04:07:37] [config] dropout-src: 0
[2023-07-24 04:07:37] [config] dropout-trg: 0
[2023-07-24 04:07:37] [config] dump-config: ""
[2023-07-24 04:07:37] [config] dynamic-gradient-scaling:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] early-stopping: 200
[2023-07-24 04:07:37] [config] early-stopping-on: first
[2023-07-24 04:07:37] [config] embedding-fix-src: false
[2023-07-24 04:07:37] [config] embedding-fix-trg: false
[2023-07-24 04:07:37] [config] embedding-normalization: false
[2023-07-24 04:07:37] [config] embedding-vectors:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] enc-cell: gru
[2023-07-24 04:07:37] [config] enc-cell-depth: 1
[2023-07-24 04:07:37] [config] enc-depth: 1
[2023-07-24 04:07:37] [config] enc-type: bidirectional
[2023-07-24 04:07:37] [config] english-title-case-every: 0
[2023-07-24 04:07:37] [config] exponential-smoothing: 0
[2023-07-24 04:07:37] [config] factor-weight: 1
[2023-07-24 04:07:37] [config] factors-combine: sum
[2023-07-24 04:07:37] [config] factors-dim-emb: 0
[2023-07-24 04:07:37] [config] gradient-checkpointing: false
[2023-07-24 04:07:37] [config] gradient-norm-average-window: 100
[2023-07-24 04:07:37] [config] guided-alignment: none
[2023-07-24 04:07:37] [config] guided-alignment-cost: mse
[2023-07-24 04:07:37] [config] guided-alignment-weight: 0.1
[2023-07-24 04:07:37] [config] ignore-model-config: false
[2023-07-24 04:07:37] [config] input-types:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] interpolate-env-vars: false
[2023-07-24 04:07:37] [config] keep-best: false
[2023-07-24 04:07:37] [config] label-smoothing: 0
[2023-07-24 04:07:37] [config] layer-normalization: false
[2023-07-24 04:07:37] [config] learn-rate: 0.0001
[2023-07-24 04:07:37] [config] lemma-dependency: ""
[2023-07-24 04:07:37] [config] lemma-dim-emb: 0
[2023-07-24 04:07:37] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 04:07:37] [config] log-level: info
[2023-07-24 04:07:37] [config] log-time-zone: ""
[2023-07-24 04:07:37] [config] logical-epoch:
[2023-07-24 04:07:37] [config]   - 1e
[2023-07-24 04:07:37] [config]   - 0
[2023-07-24 04:07:37] [config] lr-decay: 0
[2023-07-24 04:07:37] [config] lr-decay-freq: 50000
[2023-07-24 04:07:37] [config] lr-decay-inv-sqrt:
[2023-07-24 04:07:37] [config]   - 0
[2023-07-24 04:07:37] [config] lr-decay-repeat-warmup: false
[2023-07-24 04:07:37] [config] lr-decay-reset-optimizer: false
[2023-07-24 04:07:37] [config] lr-decay-start:
[2023-07-24 04:07:37] [config]   - 10
[2023-07-24 04:07:37] [config]   - 1
[2023-07-24 04:07:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-24 04:07:37] [config] lr-report: false
[2023-07-24 04:07:37] [config] lr-warmup: 0
[2023-07-24 04:07:37] [config] lr-warmup-at-reload: false
[2023-07-24 04:07:37] [config] lr-warmup-cycle: false
[2023-07-24 04:07:37] [config] lr-warmup-start-rate: 0
[2023-07-24 04:07:37] [config] max-length: 250
[2023-07-24 04:07:37] [config] max-length-crop: true
[2023-07-24 04:07:37] [config] max-length-factor: 3
[2023-07-24 04:07:37] [config] maxi-batch: 100
[2023-07-24 04:07:37] [config] maxi-batch-sort: trg
[2023-07-24 04:07:37] [config] mini-batch: 64
[2023-07-24 04:07:37] [config] mini-batch-fit: true
[2023-07-24 04:07:37] [config] mini-batch-fit-step: 10
[2023-07-24 04:07:37] [config] mini-batch-round-up: true
[2023-07-24 04:07:37] [config] mini-batch-track-lr: false
[2023-07-24 04:07:37] [config] mini-batch-warmup: 0
[2023-07-24 04:07:37] [config] mini-batch-words: 0
[2023-07-24 04:07:37] [config] mini-batch-words-ref: 0
[2023-07-24 04:07:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 04:07:37] [config] multi-loss-type: sum
[2023-07-24 04:07:37] [config] n-best: false
[2023-07-24 04:07:37] [config] no-nccl: false
[2023-07-24 04:07:37] [config] no-reload: false
[2023-07-24 04:07:37] [config] no-restore-corpus: false
[2023-07-24 04:07:37] [config] normalize: 0
[2023-07-24 04:07:37] [config] normalize-gradient: false
[2023-07-24 04:07:37] [config] num-devices: 0
[2023-07-24 04:07:37] [config] optimizer: adam
[2023-07-24 04:07:37] [config] optimizer-delay: 1
[2023-07-24 04:07:37] [config] optimizer-params:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] output-omit-bias: false
[2023-07-24 04:07:37] [config] overwrite: true
[2023-07-24 04:07:37] [config] precision:
[2023-07-24 04:07:37] [config]   - float16
[2023-07-24 04:07:37] [config]   - float32
[2023-07-24 04:07:37] [config] pretrained-model: ""
[2023-07-24 04:07:37] [config] quantize-biases: false
[2023-07-24 04:07:37] [config] quantize-bits: 0
[2023-07-24 04:07:37] [config] quantize-log-based: false
[2023-07-24 04:07:37] [config] quantize-optimization-steps: 0
[2023-07-24 04:07:37] [config] quiet: false
[2023-07-24 04:07:37] [config] quiet-translation: true
[2023-07-24 04:07:37] [config] relative-paths: false
[2023-07-24 04:07:37] [config] right-left: false
[2023-07-24 04:07:37] [config] save-freq: 10000u
[2023-07-24 04:07:37] [config] seed: 1234
[2023-07-24 04:07:37] [config] sentencepiece-alphas:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] sentencepiece-max-lines: 2000000
[2023-07-24 04:07:37] [config] sentencepiece-options: ""
[2023-07-24 04:07:37] [config] sharding: global
[2023-07-24 04:07:37] [config] shuffle: data
[2023-07-24 04:07:37] [config] shuffle-in-ram: false
[2023-07-24 04:07:37] [config] sigterm: save-and-exit
[2023-07-24 04:07:37] [config] skip: false
[2023-07-24 04:07:37] [config] sqlite: ""
[2023-07-24 04:07:37] [config] sqlite-drop: false
[2023-07-24 04:07:37] [config] sync-freq: 200u
[2023-07-24 04:07:37] [config] sync-sgd: false
[2023-07-24 04:07:37] [config] tempdir: /tmp
[2023-07-24 04:07:37] [config] tied-embeddings: false
[2023-07-24 04:07:37] [config] tied-embeddings-all: true
[2023-07-24 04:07:37] [config] tied-embeddings-src: false
[2023-07-24 04:07:37] [config] train-embedder-rank:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] train-sets:
[2023-07-24 04:07:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-24 04:07:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-24 04:07:37] [config] transformer-aan-activation: swish
[2023-07-24 04:07:37] [config] transformer-aan-depth: 2
[2023-07-24 04:07:37] [config] transformer-aan-nogate: false
[2023-07-24 04:07:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-24 04:07:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-24 04:07:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-24 04:07:37] [config] transformer-depth-scaling: false
[2023-07-24 04:07:37] [config] transformer-dim-aan: 2048
[2023-07-24 04:07:37] [config] transformer-dim-ffn: 2048
[2023-07-24 04:07:37] [config] transformer-dropout: 0
[2023-07-24 04:07:37] [config] transformer-dropout-attention: 0
[2023-07-24 04:07:37] [config] transformer-dropout-ffn: 0
[2023-07-24 04:07:37] [config] transformer-ffn-activation: swish
[2023-07-24 04:07:37] [config] transformer-ffn-depth: 2
[2023-07-24 04:07:37] [config] transformer-guided-alignment-layer: last
[2023-07-24 04:07:37] [config] transformer-heads: 8
[2023-07-24 04:07:37] [config] transformer-no-projection: false
[2023-07-24 04:07:37] [config] transformer-pool: false
[2023-07-24 04:07:37] [config] transformer-postprocess: dan
[2023-07-24 04:07:37] [config] transformer-postprocess-emb: d
[2023-07-24 04:07:37] [config] transformer-postprocess-top: ""
[2023-07-24 04:07:37] [config] transformer-preprocess: ""
[2023-07-24 04:07:37] [config] transformer-tied-layers:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] transformer-train-position-embeddings: false
[2023-07-24 04:07:37] [config] tsv: false
[2023-07-24 04:07:37] [config] tsv-fields: 0
[2023-07-24 04:07:37] [config] type: amun
[2023-07-24 04:07:37] [config] ulr: false
[2023-07-24 04:07:37] [config] ulr-dim-emb: 0
[2023-07-24 04:07:37] [config] ulr-dropout: 0
[2023-07-24 04:07:37] [config] ulr-keys-vectors: ""
[2023-07-24 04:07:37] [config] ulr-query-vectors: ""
[2023-07-24 04:07:37] [config] ulr-softmax-temperature: 1
[2023-07-24 04:07:37] [config] ulr-trainable-transformation: false
[2023-07-24 04:07:37] [config] unlikelihood-loss: false
[2023-07-24 04:07:37] [config] valid-freq: 50000000
[2023-07-24 04:07:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 04:07:37] [config] valid-max-length: 1000
[2023-07-24 04:07:37] [config] valid-metrics:
[2023-07-24 04:07:37] [config]   - cross-entropy
[2023-07-24 04:07:37] [config]   - translation
[2023-07-24 04:07:37] [config] valid-mini-batch: 32
[2023-07-24 04:07:37] [config] valid-reset-stalled: false
[2023-07-24 04:07:37] [config] valid-script-args:
[2023-07-24 04:07:37] [config]   []
[2023-07-24 04:07:37] [config] valid-script-path: ""
[2023-07-24 04:07:37] [config] valid-sets:
[2023-07-24 04:07:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-24 04:07:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-24 04:07:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-24 04:07:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 04:07:37] [config] vocabs:
[2023-07-24 04:07:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 04:07:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 04:07:37] [config] word-penalty: 0
[2023-07-24 04:07:37] [config] word-scores: false
[2023-07-24 04:07:37] [config] workspace: 5500
[2023-07-24 04:07:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 04:07:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 04:07:37] [training] Using single-device training
[2023-07-24 04:07:38] Synced seed 1234
[2023-07-24 04:07:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 04:07:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-24 04:07:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 04:07:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-24 04:07:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-24 04:07:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 04:07:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-24 04:07:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 04:07:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 04:07:40] [comm] Using global sharding
[2023-07-24 04:07:40] [comm] NCCLCommunicators constructed successfully
[2023-07-24 04:07:40] [training] Using 1 GPUs
[2023-07-24 04:07:40] [logits] Applying loss function for 1 factor(s)
[2023-07-24 04:07:40] [memory] Reserving 80 MB, device gpu0
[2023-07-24 04:07:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-24 04:07:40] [memory] Reserving 80 MB, device gpu0
[2023-07-24 04:54:07] [batching] Done. Typical MB size is 35,869 target words
[2023-07-24 04:54:07] [valid] No post-processing script given for validating translator
[2023-07-24 04:54:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 04:54:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 04:54:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 04:54:07] [comm] Using global sharding
[2023-07-24 04:54:07] [comm] NCCLCommunicators constructed successfully
[2023-07-24 04:54:07] [training] Using 1 GPUs
[2023-07-24 04:54:07] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 04:54:08] Allocating memory for general optimizer shards
[2023-07-24 04:54:08] [memory] Reserving 322 MB, device gpu0
[2023-07-24 04:54:08] Loading Adam parameters
[2023-07-24 04:54:09] [memory] Reserving 322 MB, device gpu0
[2023-07-24 04:54:09] [memory] Reserving 80 MB, device gpu0
[2023-07-24 04:54:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 04:54:09] [data] Restoring the corpus state to epoch 31, batch 1343
[2023-07-24 04:54:09] [data] Shuffling data
[2023-07-24 04:54:09] [data] Done reading 20,192 sentences
[2023-07-24 04:54:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 04:54:09] Training started
[2023-07-24 04:54:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-24 04:54:10] [memory] Reserving 80 MB, device gpu0
[2023-07-24 04:54:14] Parameter type float16, optimization type float32, casting types true
[2023-07-24 04:58:33] Seen 20,192 samples
[2023-07-24 04:58:33] Starting data epoch 32 in logical epoch 32
[2023-07-24 04:58:33] [data] Shuffling data
[2023-07-24 04:58:33] [data] Done reading 20,192 sentences
[2023-07-24 04:58:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:03:05] Seen 20,192 samples
[2023-07-24 05:03:05] Starting data epoch 33 in logical epoch 33
[2023-07-24 05:03:05] [data] Shuffling data
[2023-07-24 05:03:05] [data] Done reading 20,192 sentences
[2023-07-24 05:03:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:07:50] Seen 20,192 samples
[2023-07-24 05:07:50] Starting data epoch 34 in logical epoch 34
[2023-07-24 05:07:50] [data] Shuffling data
[2023-07-24 05:07:50] [data] Done reading 20,192 sentences
[2023-07-24 05:07:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:12:25] Seen 20,192 samples
[2023-07-24 05:12:25] Starting data epoch 35 in logical epoch 35
[2023-07-24 05:12:25] [data] Shuffling data
[2023-07-24 05:12:25] [data] Done reading 20,192 sentences
[2023-07-24 05:12:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:16:56] Seen 20,192 samples
[2023-07-24 05:16:56] Starting data epoch 36 in logical epoch 36
[2023-07-24 05:16:56] [data] Shuffling data
[2023-07-24 05:16:56] [data] Done reading 20,192 sentences
[2023-07-24 05:16:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:21:52] Seen 20,192 samples
[2023-07-24 05:21:52] Starting data epoch 37 in logical epoch 37
[2023-07-24 05:21:52] [data] Shuffling data
[2023-07-24 05:21:52] [data] Done reading 20,192 sentences
[2023-07-24 05:21:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:26:36] Seen 20,192 samples
[2023-07-24 05:26:36] Starting data epoch 38 in logical epoch 38
[2023-07-24 05:26:36] [data] Shuffling data
[2023-07-24 05:26:36] [data] Done reading 20,192 sentences
[2023-07-24 05:26:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:31:16] Seen 20,192 samples
[2023-07-24 05:31:16] Starting data epoch 39 in logical epoch 39
[2023-07-24 05:31:16] [data] Shuffling data
[2023-07-24 05:31:16] [data] Done reading 20,192 sentences
[2023-07-24 05:31:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:35:54] Seen 20,192 samples
[2023-07-24 05:35:54] Starting data epoch 40 in logical epoch 40
[2023-07-24 05:35:54] [data] Shuffling data
[2023-07-24 05:35:54] [data] Done reading 20,192 sentences
[2023-07-24 05:35:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 05:40:26] Seen 20,192 samples
[2023-07-24 05:40:26] Starting data epoch 41 in logical epoch 41
[2023-07-24 05:40:26] Training finished
[2023-07-24 05:40:37] [valid] Ep. 41 : Up. 1788 : cross-entropy : 144.042 : new best
[2023-07-24 05:43:24] [valid] Ep. 41 : Up. 1788 : translation : 0 : new best
[2023-07-24 05:43:24] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 05:43:26] Saving Adam parameters
[2023-07-24 05:43:26] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 05:43:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 05:43:32] [marian] Running on node22.datos.cluster.uy as process 39600 with command line:
[2023-07-24 05:43:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-24 05:43:32] [config] after: 0e
[2023-07-24 05:43:32] [config] after-batches: 0
[2023-07-24 05:43:32] [config] after-epochs: 50
[2023-07-24 05:43:32] [config] all-caps-every: 0
[2023-07-24 05:43:32] [config] allow-unk: false
[2023-07-24 05:43:32] [config] authors: false
[2023-07-24 05:43:32] [config] beam-size: 12
[2023-07-24 05:43:32] [config] bert-class-symbol: "[CLS]"
[2023-07-24 05:43:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-24 05:43:32] [config] bert-masking-fraction: 0.15
[2023-07-24 05:43:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-24 05:43:32] [config] bert-train-type-embeddings: true
[2023-07-24 05:43:32] [config] bert-type-vocab-size: 2
[2023-07-24 05:43:32] [config] build-info: ""
[2023-07-24 05:43:32] [config] check-gradient-nan: false
[2023-07-24 05:43:32] [config] check-nan: false
[2023-07-24 05:43:32] [config] cite: false
[2023-07-24 05:43:32] [config] clip-norm: 1
[2023-07-24 05:43:32] [config] cost-scaling:
[2023-07-24 05:43:32] [config]   - 256.f
[2023-07-24 05:43:32] [config]   - 1000
[2023-07-24 05:43:32] [config]   - 2.f
[2023-07-24 05:43:32] [config]   - 256.f
[2023-07-24 05:43:32] [config] cost-type: ce-sum
[2023-07-24 05:43:32] [config] cpu-threads: 0
[2023-07-24 05:43:32] [config] data-threads: 8
[2023-07-24 05:43:32] [config] data-weighting: ""
[2023-07-24 05:43:32] [config] data-weighting-type: sentence
[2023-07-24 05:43:32] [config] dec-cell: gru
[2023-07-24 05:43:32] [config] dec-cell-base-depth: 2
[2023-07-24 05:43:32] [config] dec-cell-high-depth: 1
[2023-07-24 05:43:32] [config] dec-depth: 1
[2023-07-24 05:43:32] [config] devices:
[2023-07-24 05:43:32] [config]   - 0
[2023-07-24 05:43:32] [config] dim-emb: 512
[2023-07-24 05:43:32] [config] dim-rnn: 1024
[2023-07-24 05:43:32] [config] dim-vocabs:
[2023-07-24 05:43:32] [config]   - 16384
[2023-07-24 05:43:32] [config]   - 16384
[2023-07-24 05:43:32] [config] disp-first: 0
[2023-07-24 05:43:32] [config] disp-freq: 1000u
[2023-07-24 05:43:32] [config] disp-label-counts: true
[2023-07-24 05:43:32] [config] dropout-rnn: 0
[2023-07-24 05:43:32] [config] dropout-src: 0
[2023-07-24 05:43:32] [config] dropout-trg: 0
[2023-07-24 05:43:32] [config] dump-config: ""
[2023-07-24 05:43:32] [config] dynamic-gradient-scaling:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] early-stopping: 200
[2023-07-24 05:43:32] [config] early-stopping-on: first
[2023-07-24 05:43:32] [config] embedding-fix-src: false
[2023-07-24 05:43:32] [config] embedding-fix-trg: false
[2023-07-24 05:43:32] [config] embedding-normalization: false
[2023-07-24 05:43:32] [config] embedding-vectors:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] enc-cell: gru
[2023-07-24 05:43:32] [config] enc-cell-depth: 1
[2023-07-24 05:43:32] [config] enc-depth: 1
[2023-07-24 05:43:32] [config] enc-type: bidirectional
[2023-07-24 05:43:32] [config] english-title-case-every: 0
[2023-07-24 05:43:32] [config] exponential-smoothing: 0
[2023-07-24 05:43:32] [config] factor-weight: 1
[2023-07-24 05:43:32] [config] factors-combine: sum
[2023-07-24 05:43:32] [config] factors-dim-emb: 0
[2023-07-24 05:43:32] [config] gradient-checkpointing: false
[2023-07-24 05:43:32] [config] gradient-norm-average-window: 100
[2023-07-24 05:43:32] [config] guided-alignment: none
[2023-07-24 05:43:32] [config] guided-alignment-cost: mse
[2023-07-24 05:43:32] [config] guided-alignment-weight: 0.1
[2023-07-24 05:43:32] [config] ignore-model-config: false
[2023-07-24 05:43:32] [config] input-types:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] interpolate-env-vars: false
[2023-07-24 05:43:32] [config] keep-best: false
[2023-07-24 05:43:32] [config] label-smoothing: 0
[2023-07-24 05:43:32] [config] layer-normalization: false
[2023-07-24 05:43:32] [config] learn-rate: 0.0001
[2023-07-24 05:43:32] [config] lemma-dependency: ""
[2023-07-24 05:43:32] [config] lemma-dim-emb: 0
[2023-07-24 05:43:32] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 05:43:32] [config] log-level: info
[2023-07-24 05:43:32] [config] log-time-zone: ""
[2023-07-24 05:43:32] [config] logical-epoch:
[2023-07-24 05:43:32] [config]   - 1e
[2023-07-24 05:43:32] [config]   - 0
[2023-07-24 05:43:32] [config] lr-decay: 0
[2023-07-24 05:43:32] [config] lr-decay-freq: 50000
[2023-07-24 05:43:32] [config] lr-decay-inv-sqrt:
[2023-07-24 05:43:32] [config]   - 0
[2023-07-24 05:43:32] [config] lr-decay-repeat-warmup: false
[2023-07-24 05:43:32] [config] lr-decay-reset-optimizer: false
[2023-07-24 05:43:32] [config] lr-decay-start:
[2023-07-24 05:43:32] [config]   - 10
[2023-07-24 05:43:32] [config]   - 1
[2023-07-24 05:43:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-24 05:43:32] [config] lr-report: false
[2023-07-24 05:43:32] [config] lr-warmup: 0
[2023-07-24 05:43:32] [config] lr-warmup-at-reload: false
[2023-07-24 05:43:32] [config] lr-warmup-cycle: false
[2023-07-24 05:43:32] [config] lr-warmup-start-rate: 0
[2023-07-24 05:43:32] [config] max-length: 250
[2023-07-24 05:43:32] [config] max-length-crop: true
[2023-07-24 05:43:32] [config] max-length-factor: 3
[2023-07-24 05:43:32] [config] maxi-batch: 100
[2023-07-24 05:43:32] [config] maxi-batch-sort: trg
[2023-07-24 05:43:32] [config] mini-batch: 64
[2023-07-24 05:43:32] [config] mini-batch-fit: true
[2023-07-24 05:43:32] [config] mini-batch-fit-step: 10
[2023-07-24 05:43:32] [config] mini-batch-round-up: true
[2023-07-24 05:43:32] [config] mini-batch-track-lr: false
[2023-07-24 05:43:32] [config] mini-batch-warmup: 0
[2023-07-24 05:43:32] [config] mini-batch-words: 0
[2023-07-24 05:43:32] [config] mini-batch-words-ref: 0
[2023-07-24 05:43:32] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 05:43:32] [config] multi-loss-type: sum
[2023-07-24 05:43:32] [config] n-best: false
[2023-07-24 05:43:32] [config] no-nccl: false
[2023-07-24 05:43:32] [config] no-reload: false
[2023-07-24 05:43:32] [config] no-restore-corpus: false
[2023-07-24 05:43:32] [config] normalize: 0
[2023-07-24 05:43:32] [config] normalize-gradient: false
[2023-07-24 05:43:32] [config] num-devices: 0
[2023-07-24 05:43:32] [config] optimizer: adam
[2023-07-24 05:43:32] [config] optimizer-delay: 1
[2023-07-24 05:43:32] [config] optimizer-params:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] output-omit-bias: false
[2023-07-24 05:43:32] [config] overwrite: true
[2023-07-24 05:43:32] [config] precision:
[2023-07-24 05:43:32] [config]   - float16
[2023-07-24 05:43:32] [config]   - float32
[2023-07-24 05:43:32] [config] pretrained-model: ""
[2023-07-24 05:43:32] [config] quantize-biases: false
[2023-07-24 05:43:32] [config] quantize-bits: 0
[2023-07-24 05:43:32] [config] quantize-log-based: false
[2023-07-24 05:43:32] [config] quantize-optimization-steps: 0
[2023-07-24 05:43:32] [config] quiet: false
[2023-07-24 05:43:32] [config] quiet-translation: true
[2023-07-24 05:43:32] [config] relative-paths: false
[2023-07-24 05:43:32] [config] right-left: false
[2023-07-24 05:43:32] [config] save-freq: 10000u
[2023-07-24 05:43:32] [config] seed: 1234
[2023-07-24 05:43:32] [config] sentencepiece-alphas:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] sentencepiece-max-lines: 2000000
[2023-07-24 05:43:32] [config] sentencepiece-options: ""
[2023-07-24 05:43:32] [config] sharding: global
[2023-07-24 05:43:32] [config] shuffle: data
[2023-07-24 05:43:32] [config] shuffle-in-ram: false
[2023-07-24 05:43:32] [config] sigterm: save-and-exit
[2023-07-24 05:43:32] [config] skip: false
[2023-07-24 05:43:32] [config] sqlite: ""
[2023-07-24 05:43:32] [config] sqlite-drop: false
[2023-07-24 05:43:32] [config] sync-freq: 200u
[2023-07-24 05:43:32] [config] sync-sgd: false
[2023-07-24 05:43:32] [config] tempdir: /tmp
[2023-07-24 05:43:32] [config] tied-embeddings: false
[2023-07-24 05:43:32] [config] tied-embeddings-all: true
[2023-07-24 05:43:32] [config] tied-embeddings-src: false
[2023-07-24 05:43:32] [config] train-embedder-rank:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] train-sets:
[2023-07-24 05:43:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-24 05:43:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-24 05:43:32] [config] transformer-aan-activation: swish
[2023-07-24 05:43:32] [config] transformer-aan-depth: 2
[2023-07-24 05:43:32] [config] transformer-aan-nogate: false
[2023-07-24 05:43:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-24 05:43:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-24 05:43:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-24 05:43:32] [config] transformer-depth-scaling: false
[2023-07-24 05:43:32] [config] transformer-dim-aan: 2048
[2023-07-24 05:43:32] [config] transformer-dim-ffn: 2048
[2023-07-24 05:43:32] [config] transformer-dropout: 0
[2023-07-24 05:43:32] [config] transformer-dropout-attention: 0
[2023-07-24 05:43:32] [config] transformer-dropout-ffn: 0
[2023-07-24 05:43:32] [config] transformer-ffn-activation: swish
[2023-07-24 05:43:32] [config] transformer-ffn-depth: 2
[2023-07-24 05:43:32] [config] transformer-guided-alignment-layer: last
[2023-07-24 05:43:32] [config] transformer-heads: 8
[2023-07-24 05:43:32] [config] transformer-no-projection: false
[2023-07-24 05:43:32] [config] transformer-pool: false
[2023-07-24 05:43:32] [config] transformer-postprocess: dan
[2023-07-24 05:43:32] [config] transformer-postprocess-emb: d
[2023-07-24 05:43:32] [config] transformer-postprocess-top: ""
[2023-07-24 05:43:32] [config] transformer-preprocess: ""
[2023-07-24 05:43:32] [config] transformer-tied-layers:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] transformer-train-position-embeddings: false
[2023-07-24 05:43:32] [config] tsv: false
[2023-07-24 05:43:32] [config] tsv-fields: 0
[2023-07-24 05:43:32] [config] type: amun
[2023-07-24 05:43:32] [config] ulr: false
[2023-07-24 05:43:32] [config] ulr-dim-emb: 0
[2023-07-24 05:43:32] [config] ulr-dropout: 0
[2023-07-24 05:43:32] [config] ulr-keys-vectors: ""
[2023-07-24 05:43:32] [config] ulr-query-vectors: ""
[2023-07-24 05:43:32] [config] ulr-softmax-temperature: 1
[2023-07-24 05:43:32] [config] ulr-trainable-transformation: false
[2023-07-24 05:43:32] [config] unlikelihood-loss: false
[2023-07-24 05:43:32] [config] valid-freq: 50000000
[2023-07-24 05:43:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 05:43:32] [config] valid-max-length: 1000
[2023-07-24 05:43:32] [config] valid-metrics:
[2023-07-24 05:43:32] [config]   - cross-entropy
[2023-07-24 05:43:32] [config]   - translation
[2023-07-24 05:43:32] [config] valid-mini-batch: 32
[2023-07-24 05:43:32] [config] valid-reset-stalled: false
[2023-07-24 05:43:32] [config] valid-script-args:
[2023-07-24 05:43:32] [config]   []
[2023-07-24 05:43:32] [config] valid-script-path: ""
[2023-07-24 05:43:32] [config] valid-sets:
[2023-07-24 05:43:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-24 05:43:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-24 05:43:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-24 05:43:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 05:43:32] [config] vocabs:
[2023-07-24 05:43:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 05:43:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 05:43:32] [config] word-penalty: 0
[2023-07-24 05:43:32] [config] word-scores: false
[2023-07-24 05:43:32] [config] workspace: 5500
[2023-07-24 05:43:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 05:43:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 05:43:32] [training] Using single-device training
[2023-07-24 05:43:33] Synced seed 1234
[2023-07-24 05:43:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 05:43:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-24 05:43:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 05:43:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-24 05:43:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-24 05:43:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 05:43:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-24 05:43:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 05:43:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 05:43:34] [comm] Using global sharding
[2023-07-24 05:43:34] [comm] NCCLCommunicators constructed successfully
[2023-07-24 05:43:34] [training] Using 1 GPUs
[2023-07-24 05:43:34] [logits] Applying loss function for 1 factor(s)
[2023-07-24 05:43:34] [memory] Reserving 80 MB, device gpu0
[2023-07-24 05:43:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-24 05:43:34] [memory] Reserving 80 MB, device gpu0
[2023-07-24 06:30:25] [batching] Done. Typical MB size is 35,869 target words
[2023-07-24 06:30:25] [valid] No post-processing script given for validating translator
[2023-07-24 06:30:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 06:30:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 06:30:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 06:30:25] [comm] Using global sharding
[2023-07-24 06:30:26] [comm] NCCLCommunicators constructed successfully
[2023-07-24 06:30:26] [training] Using 1 GPUs
[2023-07-24 06:30:26] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 06:30:27] Allocating memory for general optimizer shards
[2023-07-24 06:30:27] [memory] Reserving 322 MB, device gpu0
[2023-07-24 06:30:27] Loading Adam parameters
[2023-07-24 06:30:27] [memory] Reserving 322 MB, device gpu0
[2023-07-24 06:30:27] [memory] Reserving 80 MB, device gpu0
[2023-07-24 06:30:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 06:30:28] [data] Restoring the corpus state to epoch 41, batch 1788
[2023-07-24 06:30:28] [data] Shuffling data
[2023-07-24 06:30:28] [data] Done reading 20,192 sentences
[2023-07-24 06:30:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 06:30:28] Training started
[2023-07-24 06:30:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-24 06:30:28] [memory] Reserving 80 MB, device gpu0
[2023-07-24 06:30:32] Parameter type float16, optimization type float32, casting types true
[2023-07-24 06:34:58] Seen 20,192 samples
[2023-07-24 06:34:58] Starting data epoch 42 in logical epoch 42
[2023-07-24 06:34:58] [data] Shuffling data
[2023-07-24 06:34:58] [data] Done reading 20,192 sentences
[2023-07-24 06:34:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 06:39:45] Seen 20,192 samples
[2023-07-24 06:39:45] Starting data epoch 43 in logical epoch 43
[2023-07-24 06:39:45] [data] Shuffling data
[2023-07-24 06:39:45] [data] Done reading 20,192 sentences
[2023-07-24 06:39:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 06:44:31] Seen 20,192 samples
[2023-07-24 06:44:31] Starting data epoch 44 in logical epoch 44
[2023-07-24 06:44:31] [data] Shuffling data
[2023-07-24 06:44:31] [data] Done reading 20,192 sentences
[2023-07-24 06:44:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 06:49:13] Seen 20,192 samples
[2023-07-24 06:49:13] Starting data epoch 45 in logical epoch 45
[2023-07-24 06:49:13] [data] Shuffling data
[2023-07-24 06:49:13] [data] Done reading 20,192 sentences
[2023-07-24 06:49:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 06:52:23] Ep. 45 : Up. 2000 : Sen. 15,463 : Cost 5.40836239 * 12,181,321 @ 4,964 after 24,331,071 : Time 1317.59s : 9245.18 words/s : gNorm 1.1171
[2023-07-24 06:53:47] Seen 20,192 samples
[2023-07-24 06:53:47] Starting data epoch 46 in logical epoch 46
[2023-07-24 06:53:47] [data] Shuffling data
[2023-07-24 06:53:47] [data] Done reading 20,192 sentences
[2023-07-24 06:53:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 06:58:23] Seen 20,192 samples
[2023-07-24 06:58:23] Starting data epoch 47 in logical epoch 47
[2023-07-24 06:58:23] [data] Shuffling data
[2023-07-24 06:58:23] [data] Done reading 20,192 sentences
[2023-07-24 06:58:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 07:03:06] Seen 20,192 samples
[2023-07-24 07:03:06] Starting data epoch 48 in logical epoch 48
[2023-07-24 07:03:06] [data] Shuffling data
[2023-07-24 07:03:06] [data] Done reading 20,192 sentences
[2023-07-24 07:03:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 07:07:36] Seen 20,192 samples
[2023-07-24 07:07:36] Starting data epoch 49 in logical epoch 49
[2023-07-24 07:07:36] [data] Shuffling data
[2023-07-24 07:07:36] [data] Done reading 20,192 sentences
[2023-07-24 07:07:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 07:12:20] Seen 20,192 samples
[2023-07-24 07:12:20] Starting data epoch 50 in logical epoch 50
[2023-07-24 07:12:20] [data] Shuffling data
[2023-07-24 07:12:20] [data] Done reading 20,192 sentences
[2023-07-24 07:12:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 07:17:13] Seen 20,192 samples
[2023-07-24 07:17:13] Starting data epoch 51 in logical epoch 51
[2023-07-24 07:17:13] Training finished
[2023-07-24 07:17:22] [valid] Ep. 51 : Up. 2235 : cross-entropy : 138.707 : new best
[2023-07-24 07:20:43] [valid] Ep. 51 : Up. 2235 : translation : 0 : new best
[2023-07-24 07:20:43] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 07:20:46] Saving Adam parameters
[2023-07-24 07:20:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 07:20:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 07:20:53] [marian] Running on node22.datos.cluster.uy as process 5248 with command line:
[2023-07-24 07:20:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-24 07:20:53] [config] after: 0e
[2023-07-24 07:20:53] [config] after-batches: 0
[2023-07-24 07:20:53] [config] after-epochs: 60
[2023-07-24 07:20:53] [config] all-caps-every: 0
[2023-07-24 07:20:53] [config] allow-unk: false
[2023-07-24 07:20:53] [config] authors: false
[2023-07-24 07:20:53] [config] beam-size: 12
[2023-07-24 07:20:53] [config] bert-class-symbol: "[CLS]"
[2023-07-24 07:20:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-24 07:20:53] [config] bert-masking-fraction: 0.15
[2023-07-24 07:20:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-24 07:20:53] [config] bert-train-type-embeddings: true
[2023-07-24 07:20:53] [config] bert-type-vocab-size: 2
[2023-07-24 07:20:53] [config] build-info: ""
[2023-07-24 07:20:53] [config] check-gradient-nan: false
[2023-07-24 07:20:53] [config] check-nan: false
[2023-07-24 07:20:53] [config] cite: false
[2023-07-24 07:20:53] [config] clip-norm: 1
[2023-07-24 07:20:53] [config] cost-scaling:
[2023-07-24 07:20:53] [config]   - 256.f
[2023-07-24 07:20:53] [config]   - 1000
[2023-07-24 07:20:53] [config]   - 2.f
[2023-07-24 07:20:53] [config]   - 256.f
[2023-07-24 07:20:53] [config] cost-type: ce-sum
[2023-07-24 07:20:53] [config] cpu-threads: 0
[2023-07-24 07:20:53] [config] data-threads: 8
[2023-07-24 07:20:53] [config] data-weighting: ""
[2023-07-24 07:20:53] [config] data-weighting-type: sentence
[2023-07-24 07:20:53] [config] dec-cell: gru
[2023-07-24 07:20:53] [config] dec-cell-base-depth: 2
[2023-07-24 07:20:53] [config] dec-cell-high-depth: 1
[2023-07-24 07:20:53] [config] dec-depth: 1
[2023-07-24 07:20:53] [config] devices:
[2023-07-24 07:20:53] [config]   - 0
[2023-07-24 07:20:53] [config] dim-emb: 512
[2023-07-24 07:20:53] [config] dim-rnn: 1024
[2023-07-24 07:20:53] [config] dim-vocabs:
[2023-07-24 07:20:53] [config]   - 16384
[2023-07-24 07:20:53] [config]   - 16384
[2023-07-24 07:20:53] [config] disp-first: 0
[2023-07-24 07:20:53] [config] disp-freq: 1000u
[2023-07-24 07:20:53] [config] disp-label-counts: true
[2023-07-24 07:20:53] [config] dropout-rnn: 0
[2023-07-24 07:20:53] [config] dropout-src: 0
[2023-07-24 07:20:53] [config] dropout-trg: 0
[2023-07-24 07:20:53] [config] dump-config: ""
[2023-07-24 07:20:53] [config] dynamic-gradient-scaling:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] early-stopping: 200
[2023-07-24 07:20:53] [config] early-stopping-on: first
[2023-07-24 07:20:53] [config] embedding-fix-src: false
[2023-07-24 07:20:53] [config] embedding-fix-trg: false
[2023-07-24 07:20:53] [config] embedding-normalization: false
[2023-07-24 07:20:53] [config] embedding-vectors:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] enc-cell: gru
[2023-07-24 07:20:53] [config] enc-cell-depth: 1
[2023-07-24 07:20:53] [config] enc-depth: 1
[2023-07-24 07:20:53] [config] enc-type: bidirectional
[2023-07-24 07:20:53] [config] english-title-case-every: 0
[2023-07-24 07:20:53] [config] exponential-smoothing: 0
[2023-07-24 07:20:53] [config] factor-weight: 1
[2023-07-24 07:20:53] [config] factors-combine: sum
[2023-07-24 07:20:53] [config] factors-dim-emb: 0
[2023-07-24 07:20:53] [config] gradient-checkpointing: false
[2023-07-24 07:20:53] [config] gradient-norm-average-window: 100
[2023-07-24 07:20:53] [config] guided-alignment: none
[2023-07-24 07:20:53] [config] guided-alignment-cost: mse
[2023-07-24 07:20:53] [config] guided-alignment-weight: 0.1
[2023-07-24 07:20:53] [config] ignore-model-config: false
[2023-07-24 07:20:53] [config] input-types:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] interpolate-env-vars: false
[2023-07-24 07:20:53] [config] keep-best: false
[2023-07-24 07:20:53] [config] label-smoothing: 0
[2023-07-24 07:20:53] [config] layer-normalization: false
[2023-07-24 07:20:53] [config] learn-rate: 0.0001
[2023-07-24 07:20:53] [config] lemma-dependency: ""
[2023-07-24 07:20:53] [config] lemma-dim-emb: 0
[2023-07-24 07:20:53] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 07:20:53] [config] log-level: info
[2023-07-24 07:20:53] [config] log-time-zone: ""
[2023-07-24 07:20:53] [config] logical-epoch:
[2023-07-24 07:20:53] [config]   - 1e
[2023-07-24 07:20:53] [config]   - 0
[2023-07-24 07:20:53] [config] lr-decay: 0
[2023-07-24 07:20:53] [config] lr-decay-freq: 50000
[2023-07-24 07:20:53] [config] lr-decay-inv-sqrt:
[2023-07-24 07:20:53] [config]   - 0
[2023-07-24 07:20:53] [config] lr-decay-repeat-warmup: false
[2023-07-24 07:20:53] [config] lr-decay-reset-optimizer: false
[2023-07-24 07:20:53] [config] lr-decay-start:
[2023-07-24 07:20:53] [config]   - 10
[2023-07-24 07:20:53] [config]   - 1
[2023-07-24 07:20:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-24 07:20:53] [config] lr-report: false
[2023-07-24 07:20:53] [config] lr-warmup: 0
[2023-07-24 07:20:53] [config] lr-warmup-at-reload: false
[2023-07-24 07:20:53] [config] lr-warmup-cycle: false
[2023-07-24 07:20:53] [config] lr-warmup-start-rate: 0
[2023-07-24 07:20:53] [config] max-length: 250
[2023-07-24 07:20:53] [config] max-length-crop: true
[2023-07-24 07:20:53] [config] max-length-factor: 3
[2023-07-24 07:20:53] [config] maxi-batch: 100
[2023-07-24 07:20:53] [config] maxi-batch-sort: trg
[2023-07-24 07:20:53] [config] mini-batch: 64
[2023-07-24 07:20:53] [config] mini-batch-fit: true
[2023-07-24 07:20:53] [config] mini-batch-fit-step: 10
[2023-07-24 07:20:53] [config] mini-batch-round-up: true
[2023-07-24 07:20:53] [config] mini-batch-track-lr: false
[2023-07-24 07:20:53] [config] mini-batch-warmup: 0
[2023-07-24 07:20:53] [config] mini-batch-words: 0
[2023-07-24 07:20:53] [config] mini-batch-words-ref: 0
[2023-07-24 07:20:53] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 07:20:53] [config] multi-loss-type: sum
[2023-07-24 07:20:53] [config] n-best: false
[2023-07-24 07:20:53] [config] no-nccl: false
[2023-07-24 07:20:53] [config] no-reload: false
[2023-07-24 07:20:53] [config] no-restore-corpus: false
[2023-07-24 07:20:53] [config] normalize: 0
[2023-07-24 07:20:53] [config] normalize-gradient: false
[2023-07-24 07:20:53] [config] num-devices: 0
[2023-07-24 07:20:53] [config] optimizer: adam
[2023-07-24 07:20:53] [config] optimizer-delay: 1
[2023-07-24 07:20:53] [config] optimizer-params:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] output-omit-bias: false
[2023-07-24 07:20:53] [config] overwrite: true
[2023-07-24 07:20:53] [config] precision:
[2023-07-24 07:20:53] [config]   - float16
[2023-07-24 07:20:53] [config]   - float32
[2023-07-24 07:20:53] [config] pretrained-model: ""
[2023-07-24 07:20:53] [config] quantize-biases: false
[2023-07-24 07:20:53] [config] quantize-bits: 0
[2023-07-24 07:20:53] [config] quantize-log-based: false
[2023-07-24 07:20:53] [config] quantize-optimization-steps: 0
[2023-07-24 07:20:53] [config] quiet: false
[2023-07-24 07:20:53] [config] quiet-translation: true
[2023-07-24 07:20:53] [config] relative-paths: false
[2023-07-24 07:20:53] [config] right-left: false
[2023-07-24 07:20:53] [config] save-freq: 10000u
[2023-07-24 07:20:53] [config] seed: 1234
[2023-07-24 07:20:53] [config] sentencepiece-alphas:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] sentencepiece-max-lines: 2000000
[2023-07-24 07:20:53] [config] sentencepiece-options: ""
[2023-07-24 07:20:53] [config] sharding: global
[2023-07-24 07:20:53] [config] shuffle: data
[2023-07-24 07:20:53] [config] shuffle-in-ram: false
[2023-07-24 07:20:53] [config] sigterm: save-and-exit
[2023-07-24 07:20:53] [config] skip: false
[2023-07-24 07:20:53] [config] sqlite: ""
[2023-07-24 07:20:53] [config] sqlite-drop: false
[2023-07-24 07:20:53] [config] sync-freq: 200u
[2023-07-24 07:20:53] [config] sync-sgd: false
[2023-07-24 07:20:53] [config] tempdir: /tmp
[2023-07-24 07:20:53] [config] tied-embeddings: false
[2023-07-24 07:20:53] [config] tied-embeddings-all: true
[2023-07-24 07:20:53] [config] tied-embeddings-src: false
[2023-07-24 07:20:53] [config] train-embedder-rank:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] train-sets:
[2023-07-24 07:20:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-24 07:20:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-24 07:20:53] [config] transformer-aan-activation: swish
[2023-07-24 07:20:53] [config] transformer-aan-depth: 2
[2023-07-24 07:20:53] [config] transformer-aan-nogate: false
[2023-07-24 07:20:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-24 07:20:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-24 07:20:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-24 07:20:53] [config] transformer-depth-scaling: false
[2023-07-24 07:20:53] [config] transformer-dim-aan: 2048
[2023-07-24 07:20:53] [config] transformer-dim-ffn: 2048
[2023-07-24 07:20:53] [config] transformer-dropout: 0
[2023-07-24 07:20:53] [config] transformer-dropout-attention: 0
[2023-07-24 07:20:53] [config] transformer-dropout-ffn: 0
[2023-07-24 07:20:53] [config] transformer-ffn-activation: swish
[2023-07-24 07:20:53] [config] transformer-ffn-depth: 2
[2023-07-24 07:20:53] [config] transformer-guided-alignment-layer: last
[2023-07-24 07:20:53] [config] transformer-heads: 8
[2023-07-24 07:20:53] [config] transformer-no-projection: false
[2023-07-24 07:20:53] [config] transformer-pool: false
[2023-07-24 07:20:53] [config] transformer-postprocess: dan
[2023-07-24 07:20:53] [config] transformer-postprocess-emb: d
[2023-07-24 07:20:53] [config] transformer-postprocess-top: ""
[2023-07-24 07:20:53] [config] transformer-preprocess: ""
[2023-07-24 07:20:53] [config] transformer-tied-layers:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] transformer-train-position-embeddings: false
[2023-07-24 07:20:53] [config] tsv: false
[2023-07-24 07:20:53] [config] tsv-fields: 0
[2023-07-24 07:20:53] [config] type: amun
[2023-07-24 07:20:53] [config] ulr: false
[2023-07-24 07:20:53] [config] ulr-dim-emb: 0
[2023-07-24 07:20:53] [config] ulr-dropout: 0
[2023-07-24 07:20:53] [config] ulr-keys-vectors: ""
[2023-07-24 07:20:53] [config] ulr-query-vectors: ""
[2023-07-24 07:20:53] [config] ulr-softmax-temperature: 1
[2023-07-24 07:20:53] [config] ulr-trainable-transformation: false
[2023-07-24 07:20:53] [config] unlikelihood-loss: false
[2023-07-24 07:20:53] [config] valid-freq: 50000000
[2023-07-24 07:20:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 07:20:53] [config] valid-max-length: 1000
[2023-07-24 07:20:53] [config] valid-metrics:
[2023-07-24 07:20:53] [config]   - cross-entropy
[2023-07-24 07:20:53] [config]   - translation
[2023-07-24 07:20:53] [config] valid-mini-batch: 32
[2023-07-24 07:20:53] [config] valid-reset-stalled: false
[2023-07-24 07:20:53] [config] valid-script-args:
[2023-07-24 07:20:53] [config]   []
[2023-07-24 07:20:53] [config] valid-script-path: ""
[2023-07-24 07:20:53] [config] valid-sets:
[2023-07-24 07:20:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-24 07:20:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-24 07:20:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-24 07:20:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 07:20:53] [config] vocabs:
[2023-07-24 07:20:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 07:20:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 07:20:53] [config] word-penalty: 0
[2023-07-24 07:20:53] [config] word-scores: false
[2023-07-24 07:20:53] [config] workspace: 5500
[2023-07-24 07:20:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 07:20:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 07:20:53] [training] Using single-device training
[2023-07-24 07:20:53] Synced seed 1234
[2023-07-24 07:20:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 07:20:53] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-24 07:20:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 07:20:53] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-24 07:20:53] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-24 07:20:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 07:20:53] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-24 07:20:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 07:20:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 07:20:55] [comm] Using global sharding
[2023-07-24 07:20:55] [comm] NCCLCommunicators constructed successfully
[2023-07-24 07:20:55] [training] Using 1 GPUs
[2023-07-24 07:20:55] [logits] Applying loss function for 1 factor(s)
[2023-07-24 07:20:55] [memory] Reserving 80 MB, device gpu0
[2023-07-24 07:20:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-24 07:20:55] [memory] Reserving 80 MB, device gpu0
[2023-07-24 08:07:01] [batching] Done. Typical MB size is 35,869 target words
[2023-07-24 08:07:01] [valid] No post-processing script given for validating translator
[2023-07-24 08:07:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 08:07:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 08:07:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 08:07:01] [comm] Using global sharding
[2023-07-24 08:07:01] [comm] NCCLCommunicators constructed successfully
[2023-07-24 08:07:01] [training] Using 1 GPUs
[2023-07-24 08:07:01] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 08:07:03] Allocating memory for general optimizer shards
[2023-07-24 08:07:03] [memory] Reserving 322 MB, device gpu0
[2023-07-24 08:07:03] Loading Adam parameters
[2023-07-24 08:07:03] [memory] Reserving 322 MB, device gpu0
[2023-07-24 08:07:03] [memory] Reserving 80 MB, device gpu0
[2023-07-24 08:07:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 08:07:03] [data] Restoring the corpus state to epoch 51, batch 2235
[2023-07-24 08:07:03] [data] Shuffling data
[2023-07-24 08:07:03] [data] Done reading 20,192 sentences
[2023-07-24 08:07:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:07:03] Training started
[2023-07-24 08:07:03] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-24 08:07:04] [memory] Reserving 80 MB, device gpu0
[2023-07-24 08:07:06] Parameter type float16, optimization type float32, casting types true
[2023-07-24 08:11:49] Seen 20,192 samples
[2023-07-24 08:11:49] Starting data epoch 52 in logical epoch 52
[2023-07-24 08:11:49] [data] Shuffling data
[2023-07-24 08:11:49] [data] Done reading 20,192 sentences
[2023-07-24 08:11:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:16:48] Seen 20,192 samples
[2023-07-24 08:16:48] Starting data epoch 53 in logical epoch 53
[2023-07-24 08:16:48] [data] Shuffling data
[2023-07-24 08:16:48] [data] Done reading 20,192 sentences
[2023-07-24 08:16:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:21:25] Seen 20,192 samples
[2023-07-24 08:21:25] Starting data epoch 54 in logical epoch 54
[2023-07-24 08:21:25] [data] Shuffling data
[2023-07-24 08:21:25] [data] Done reading 20,192 sentences
[2023-07-24 08:21:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:26:15] Seen 20,192 samples
[2023-07-24 08:26:15] Starting data epoch 55 in logical epoch 55
[2023-07-24 08:26:15] [data] Shuffling data
[2023-07-24 08:26:15] [data] Done reading 20,192 sentences
[2023-07-24 08:26:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:30:56] Seen 20,192 samples
[2023-07-24 08:30:56] Starting data epoch 56 in logical epoch 56
[2023-07-24 08:30:56] [data] Shuffling data
[2023-07-24 08:30:56] [data] Done reading 20,192 sentences
[2023-07-24 08:30:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:35:51] Seen 20,192 samples
[2023-07-24 08:35:51] Starting data epoch 57 in logical epoch 57
[2023-07-24 08:35:51] [data] Shuffling data
[2023-07-24 08:35:51] [data] Done reading 20,192 sentences
[2023-07-24 08:35:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:40:18] Seen 20,192 samples
[2023-07-24 08:40:18] Starting data epoch 58 in logical epoch 58
[2023-07-24 08:40:18] [data] Shuffling data
[2023-07-24 08:40:18] [data] Done reading 20,192 sentences
[2023-07-24 08:40:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:45:08] Seen 20,192 samples
[2023-07-24 08:45:08] Starting data epoch 59 in logical epoch 59
[2023-07-24 08:45:08] [data] Shuffling data
[2023-07-24 08:45:08] [data] Done reading 20,192 sentences
[2023-07-24 08:45:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:50:00] Seen 20,192 samples
[2023-07-24 08:50:00] Starting data epoch 60 in logical epoch 60
[2023-07-24 08:50:00] [data] Shuffling data
[2023-07-24 08:50:00] [data] Done reading 20,192 sentences
[2023-07-24 08:50:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 08:54:35] Seen 20,192 samples
[2023-07-24 08:54:35] Starting data epoch 61 in logical epoch 61
[2023-07-24 08:54:35] Training finished
[2023-07-24 08:54:47] [valid] Ep. 61 : Up. 2679 : cross-entropy : 135.864 : new best
[2023-07-24 08:58:07] [valid] Ep. 61 : Up. 2679 : translation : 0 : new best
[2023-07-24 08:58:07] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 08:58:08] Saving Adam parameters
[2023-07-24 08:58:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 08:58:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 08:58:15] [marian] Running on node22.datos.cluster.uy as process 11735 with command line:
[2023-07-24 08:58:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-24 08:58:16] [config] after: 0e
[2023-07-24 08:58:16] [config] after-batches: 0
[2023-07-24 08:58:16] [config] after-epochs: 70
[2023-07-24 08:58:16] [config] all-caps-every: 0
[2023-07-24 08:58:16] [config] allow-unk: false
[2023-07-24 08:58:16] [config] authors: false
[2023-07-24 08:58:16] [config] beam-size: 12
[2023-07-24 08:58:16] [config] bert-class-symbol: "[CLS]"
[2023-07-24 08:58:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-24 08:58:16] [config] bert-masking-fraction: 0.15
[2023-07-24 08:58:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-24 08:58:16] [config] bert-train-type-embeddings: true
[2023-07-24 08:58:16] [config] bert-type-vocab-size: 2
[2023-07-24 08:58:16] [config] build-info: ""
[2023-07-24 08:58:16] [config] check-gradient-nan: false
[2023-07-24 08:58:16] [config] check-nan: false
[2023-07-24 08:58:16] [config] cite: false
[2023-07-24 08:58:16] [config] clip-norm: 1
[2023-07-24 08:58:16] [config] cost-scaling:
[2023-07-24 08:58:16] [config]   - 256.f
[2023-07-24 08:58:16] [config]   - 1000
[2023-07-24 08:58:16] [config]   - 2.f
[2023-07-24 08:58:16] [config]   - 256.f
[2023-07-24 08:58:16] [config] cost-type: ce-sum
[2023-07-24 08:58:16] [config] cpu-threads: 0
[2023-07-24 08:58:16] [config] data-threads: 8
[2023-07-24 08:58:16] [config] data-weighting: ""
[2023-07-24 08:58:16] [config] data-weighting-type: sentence
[2023-07-24 08:58:16] [config] dec-cell: gru
[2023-07-24 08:58:16] [config] dec-cell-base-depth: 2
[2023-07-24 08:58:16] [config] dec-cell-high-depth: 1
[2023-07-24 08:58:16] [config] dec-depth: 1
[2023-07-24 08:58:16] [config] devices:
[2023-07-24 08:58:16] [config]   - 0
[2023-07-24 08:58:16] [config] dim-emb: 512
[2023-07-24 08:58:16] [config] dim-rnn: 1024
[2023-07-24 08:58:16] [config] dim-vocabs:
[2023-07-24 08:58:16] [config]   - 16384
[2023-07-24 08:58:16] [config]   - 16384
[2023-07-24 08:58:16] [config] disp-first: 0
[2023-07-24 08:58:16] [config] disp-freq: 1000u
[2023-07-24 08:58:16] [config] disp-label-counts: true
[2023-07-24 08:58:16] [config] dropout-rnn: 0
[2023-07-24 08:58:16] [config] dropout-src: 0
[2023-07-24 08:58:16] [config] dropout-trg: 0
[2023-07-24 08:58:16] [config] dump-config: ""
[2023-07-24 08:58:16] [config] dynamic-gradient-scaling:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] early-stopping: 200
[2023-07-24 08:58:16] [config] early-stopping-on: first
[2023-07-24 08:58:16] [config] embedding-fix-src: false
[2023-07-24 08:58:16] [config] embedding-fix-trg: false
[2023-07-24 08:58:16] [config] embedding-normalization: false
[2023-07-24 08:58:16] [config] embedding-vectors:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] enc-cell: gru
[2023-07-24 08:58:16] [config] enc-cell-depth: 1
[2023-07-24 08:58:16] [config] enc-depth: 1
[2023-07-24 08:58:16] [config] enc-type: bidirectional
[2023-07-24 08:58:16] [config] english-title-case-every: 0
[2023-07-24 08:58:16] [config] exponential-smoothing: 0
[2023-07-24 08:58:16] [config] factor-weight: 1
[2023-07-24 08:58:16] [config] factors-combine: sum
[2023-07-24 08:58:16] [config] factors-dim-emb: 0
[2023-07-24 08:58:16] [config] gradient-checkpointing: false
[2023-07-24 08:58:16] [config] gradient-norm-average-window: 100
[2023-07-24 08:58:16] [config] guided-alignment: none
[2023-07-24 08:58:16] [config] guided-alignment-cost: mse
[2023-07-24 08:58:16] [config] guided-alignment-weight: 0.1
[2023-07-24 08:58:16] [config] ignore-model-config: false
[2023-07-24 08:58:16] [config] input-types:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] interpolate-env-vars: false
[2023-07-24 08:58:16] [config] keep-best: false
[2023-07-24 08:58:16] [config] label-smoothing: 0
[2023-07-24 08:58:16] [config] layer-normalization: false
[2023-07-24 08:58:16] [config] learn-rate: 0.0001
[2023-07-24 08:58:16] [config] lemma-dependency: ""
[2023-07-24 08:58:16] [config] lemma-dim-emb: 0
[2023-07-24 08:58:16] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 08:58:16] [config] log-level: info
[2023-07-24 08:58:16] [config] log-time-zone: ""
[2023-07-24 08:58:16] [config] logical-epoch:
[2023-07-24 08:58:16] [config]   - 1e
[2023-07-24 08:58:16] [config]   - 0
[2023-07-24 08:58:16] [config] lr-decay: 0
[2023-07-24 08:58:16] [config] lr-decay-freq: 50000
[2023-07-24 08:58:16] [config] lr-decay-inv-sqrt:
[2023-07-24 08:58:16] [config]   - 0
[2023-07-24 08:58:16] [config] lr-decay-repeat-warmup: false
[2023-07-24 08:58:16] [config] lr-decay-reset-optimizer: false
[2023-07-24 08:58:16] [config] lr-decay-start:
[2023-07-24 08:58:16] [config]   - 10
[2023-07-24 08:58:16] [config]   - 1
[2023-07-24 08:58:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-24 08:58:16] [config] lr-report: false
[2023-07-24 08:58:16] [config] lr-warmup: 0
[2023-07-24 08:58:16] [config] lr-warmup-at-reload: false
[2023-07-24 08:58:16] [config] lr-warmup-cycle: false
[2023-07-24 08:58:16] [config] lr-warmup-start-rate: 0
[2023-07-24 08:58:16] [config] max-length: 250
[2023-07-24 08:58:16] [config] max-length-crop: true
[2023-07-24 08:58:16] [config] max-length-factor: 3
[2023-07-24 08:58:16] [config] maxi-batch: 100
[2023-07-24 08:58:16] [config] maxi-batch-sort: trg
[2023-07-24 08:58:16] [config] mini-batch: 64
[2023-07-24 08:58:16] [config] mini-batch-fit: true
[2023-07-24 08:58:16] [config] mini-batch-fit-step: 10
[2023-07-24 08:58:16] [config] mini-batch-round-up: true
[2023-07-24 08:58:16] [config] mini-batch-track-lr: false
[2023-07-24 08:58:16] [config] mini-batch-warmup: 0
[2023-07-24 08:58:16] [config] mini-batch-words: 0
[2023-07-24 08:58:16] [config] mini-batch-words-ref: 0
[2023-07-24 08:58:16] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 08:58:16] [config] multi-loss-type: sum
[2023-07-24 08:58:16] [config] n-best: false
[2023-07-24 08:58:16] [config] no-nccl: false
[2023-07-24 08:58:16] [config] no-reload: false
[2023-07-24 08:58:16] [config] no-restore-corpus: false
[2023-07-24 08:58:16] [config] normalize: 0
[2023-07-24 08:58:16] [config] normalize-gradient: false
[2023-07-24 08:58:16] [config] num-devices: 0
[2023-07-24 08:58:16] [config] optimizer: adam
[2023-07-24 08:58:16] [config] optimizer-delay: 1
[2023-07-24 08:58:16] [config] optimizer-params:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] output-omit-bias: false
[2023-07-24 08:58:16] [config] overwrite: true
[2023-07-24 08:58:16] [config] precision:
[2023-07-24 08:58:16] [config]   - float16
[2023-07-24 08:58:16] [config]   - float32
[2023-07-24 08:58:16] [config] pretrained-model: ""
[2023-07-24 08:58:16] [config] quantize-biases: false
[2023-07-24 08:58:16] [config] quantize-bits: 0
[2023-07-24 08:58:16] [config] quantize-log-based: false
[2023-07-24 08:58:16] [config] quantize-optimization-steps: 0
[2023-07-24 08:58:16] [config] quiet: false
[2023-07-24 08:58:16] [config] quiet-translation: true
[2023-07-24 08:58:16] [config] relative-paths: false
[2023-07-24 08:58:16] [config] right-left: false
[2023-07-24 08:58:16] [config] save-freq: 10000u
[2023-07-24 08:58:16] [config] seed: 1234
[2023-07-24 08:58:16] [config] sentencepiece-alphas:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] sentencepiece-max-lines: 2000000
[2023-07-24 08:58:16] [config] sentencepiece-options: ""
[2023-07-24 08:58:16] [config] sharding: global
[2023-07-24 08:58:16] [config] shuffle: data
[2023-07-24 08:58:16] [config] shuffle-in-ram: false
[2023-07-24 08:58:16] [config] sigterm: save-and-exit
[2023-07-24 08:58:16] [config] skip: false
[2023-07-24 08:58:16] [config] sqlite: ""
[2023-07-24 08:58:16] [config] sqlite-drop: false
[2023-07-24 08:58:16] [config] sync-freq: 200u
[2023-07-24 08:58:16] [config] sync-sgd: false
[2023-07-24 08:58:16] [config] tempdir: /tmp
[2023-07-24 08:58:16] [config] tied-embeddings: false
[2023-07-24 08:58:16] [config] tied-embeddings-all: true
[2023-07-24 08:58:16] [config] tied-embeddings-src: false
[2023-07-24 08:58:16] [config] train-embedder-rank:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] train-sets:
[2023-07-24 08:58:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-24 08:58:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-24 08:58:16] [config] transformer-aan-activation: swish
[2023-07-24 08:58:16] [config] transformer-aan-depth: 2
[2023-07-24 08:58:16] [config] transformer-aan-nogate: false
[2023-07-24 08:58:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-24 08:58:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-24 08:58:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-24 08:58:16] [config] transformer-depth-scaling: false
[2023-07-24 08:58:16] [config] transformer-dim-aan: 2048
[2023-07-24 08:58:16] [config] transformer-dim-ffn: 2048
[2023-07-24 08:58:16] [config] transformer-dropout: 0
[2023-07-24 08:58:16] [config] transformer-dropout-attention: 0
[2023-07-24 08:58:16] [config] transformer-dropout-ffn: 0
[2023-07-24 08:58:16] [config] transformer-ffn-activation: swish
[2023-07-24 08:58:16] [config] transformer-ffn-depth: 2
[2023-07-24 08:58:16] [config] transformer-guided-alignment-layer: last
[2023-07-24 08:58:16] [config] transformer-heads: 8
[2023-07-24 08:58:16] [config] transformer-no-projection: false
[2023-07-24 08:58:16] [config] transformer-pool: false
[2023-07-24 08:58:16] [config] transformer-postprocess: dan
[2023-07-24 08:58:16] [config] transformer-postprocess-emb: d
[2023-07-24 08:58:16] [config] transformer-postprocess-top: ""
[2023-07-24 08:58:16] [config] transformer-preprocess: ""
[2023-07-24 08:58:16] [config] transformer-tied-layers:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] transformer-train-position-embeddings: false
[2023-07-24 08:58:16] [config] tsv: false
[2023-07-24 08:58:16] [config] tsv-fields: 0
[2023-07-24 08:58:16] [config] type: amun
[2023-07-24 08:58:16] [config] ulr: false
[2023-07-24 08:58:16] [config] ulr-dim-emb: 0
[2023-07-24 08:58:16] [config] ulr-dropout: 0
[2023-07-24 08:58:16] [config] ulr-keys-vectors: ""
[2023-07-24 08:58:16] [config] ulr-query-vectors: ""
[2023-07-24 08:58:16] [config] ulr-softmax-temperature: 1
[2023-07-24 08:58:16] [config] ulr-trainable-transformation: false
[2023-07-24 08:58:16] [config] unlikelihood-loss: false
[2023-07-24 08:58:16] [config] valid-freq: 50000000
[2023-07-24 08:58:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 08:58:16] [config] valid-max-length: 1000
[2023-07-24 08:58:16] [config] valid-metrics:
[2023-07-24 08:58:16] [config]   - cross-entropy
[2023-07-24 08:58:16] [config]   - translation
[2023-07-24 08:58:16] [config] valid-mini-batch: 32
[2023-07-24 08:58:16] [config] valid-reset-stalled: false
[2023-07-24 08:58:16] [config] valid-script-args:
[2023-07-24 08:58:16] [config]   []
[2023-07-24 08:58:16] [config] valid-script-path: ""
[2023-07-24 08:58:16] [config] valid-sets:
[2023-07-24 08:58:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-24 08:58:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-24 08:58:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-24 08:58:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 08:58:16] [config] vocabs:
[2023-07-24 08:58:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 08:58:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 08:58:16] [config] word-penalty: 0
[2023-07-24 08:58:16] [config] word-scores: false
[2023-07-24 08:58:16] [config] workspace: 5500
[2023-07-24 08:58:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 08:58:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 08:58:16] [training] Using single-device training
[2023-07-24 08:58:16] Synced seed 1234
[2023-07-24 08:58:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 08:58:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-24 08:58:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 08:58:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-24 08:58:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-24 08:58:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 08:58:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-24 08:58:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 08:58:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 08:58:17] [comm] Using global sharding
[2023-07-24 08:58:17] [comm] NCCLCommunicators constructed successfully
[2023-07-24 08:58:17] [training] Using 1 GPUs
[2023-07-24 08:58:17] [logits] Applying loss function for 1 factor(s)
[2023-07-24 08:58:17] [memory] Reserving 80 MB, device gpu0
[2023-07-24 08:58:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-24 08:58:18] [memory] Reserving 80 MB, device gpu0
[2023-07-24 09:44:50] [batching] Done. Typical MB size is 35,869 target words
[2023-07-24 09:44:50] [valid] No post-processing script given for validating translator
[2023-07-24 09:44:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 09:44:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 09:44:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 09:44:50] [comm] Using global sharding
[2023-07-24 09:44:50] [comm] NCCLCommunicators constructed successfully
[2023-07-24 09:44:50] [training] Using 1 GPUs
[2023-07-24 09:44:50] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 09:44:52] Allocating memory for general optimizer shards
[2023-07-24 09:44:52] [memory] Reserving 322 MB, device gpu0
[2023-07-24 09:44:52] Loading Adam parameters
[2023-07-24 09:44:52] [memory] Reserving 322 MB, device gpu0
[2023-07-24 09:44:52] [memory] Reserving 80 MB, device gpu0
[2023-07-24 09:44:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 09:44:53] [data] Restoring the corpus state to epoch 61, batch 2679
[2023-07-24 09:44:53] [data] Shuffling data
[2023-07-24 09:44:53] [data] Done reading 20,192 sentences
[2023-07-24 09:44:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 09:44:53] Training started
[2023-07-24 09:44:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-24 09:44:53] [memory] Reserving 80 MB, device gpu0
[2023-07-24 09:44:55] Parameter type float16, optimization type float32, casting types true
[2023-07-24 09:49:29] Seen 20,192 samples
[2023-07-24 09:49:29] Starting data epoch 62 in logical epoch 62
[2023-07-24 09:49:29] [data] Shuffling data
[2023-07-24 09:49:29] [data] Done reading 20,192 sentences
[2023-07-24 09:49:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 09:54:23] Seen 20,192 samples
[2023-07-24 09:54:23] Starting data epoch 63 in logical epoch 63
[2023-07-24 09:54:23] [data] Shuffling data
[2023-07-24 09:54:23] [data] Done reading 20,192 sentences
[2023-07-24 09:54:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 09:59:12] Seen 20,192 samples
[2023-07-24 09:59:12] Starting data epoch 64 in logical epoch 64
[2023-07-24 09:59:12] [data] Shuffling data
[2023-07-24 09:59:12] [data] Done reading 20,192 sentences
[2023-07-24 09:59:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 10:04:03] Seen 20,192 samples
[2023-07-24 10:04:03] Starting data epoch 65 in logical epoch 65
[2023-07-24 10:04:03] [data] Shuffling data
[2023-07-24 10:04:03] [data] Done reading 20,192 sentences
[2023-07-24 10:04:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 10:08:51] Seen 20,192 samples
[2023-07-24 10:08:51] Starting data epoch 66 in logical epoch 66
[2023-07-24 10:08:51] [data] Shuffling data
[2023-07-24 10:08:51] [data] Done reading 20,192 sentences
[2023-07-24 10:08:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 10:13:32] Seen 20,192 samples
[2023-07-24 10:13:32] Starting data epoch 67 in logical epoch 67
[2023-07-24 10:13:32] [data] Shuffling data
[2023-07-24 10:13:32] [data] Done reading 20,192 sentences
[2023-07-24 10:13:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 10:18:26] Seen 20,192 samples
[2023-07-24 10:18:26] Starting data epoch 68 in logical epoch 68
[2023-07-24 10:18:26] [data] Shuffling data
[2023-07-24 10:18:26] [data] Done reading 20,192 sentences
[2023-07-24 10:18:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 10:19:45] Ep. 68 : Up. 3000 : Sen. 4,869 : Cost 4.77535725 * 12,272,400 @ 15,673 after 36,603,471 : Time 2094.82s : 5858.45 words/s : gNorm 1.0943
[2023-07-24 10:23:19] Seen 20,192 samples
[2023-07-24 10:23:19] Starting data epoch 69 in logical epoch 69
[2023-07-24 10:23:19] [data] Shuffling data
[2023-07-24 10:23:19] [data] Done reading 20,192 sentences
[2023-07-24 10:23:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 10:28:07] Seen 20,192 samples
[2023-07-24 10:28:07] Starting data epoch 70 in logical epoch 70
[2023-07-24 10:28:07] [data] Shuffling data
[2023-07-24 10:28:07] [data] Done reading 20,192 sentences
[2023-07-24 10:28:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-24 10:32:55] Seen 20,192 samples
[2023-07-24 10:32:55] Starting data epoch 71 in logical epoch 71
[2023-07-24 10:32:55] Training finished
[2023-07-24 10:33:05] [valid] Ep. 71 : Up. 3122 : cross-entropy : 133.469 : new best
[2023-07-24 10:36:01] [valid] Ep. 71 : Up. 3122 : translation : 0 : new best
[2023-07-24 10:36:01] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 10:36:03] Saving Adam parameters
[2023-07-24 10:36:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz.optimizer.npz
[2023-07-24 10:36:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 10:36:10] [marian] Running on node22.datos.cluster.uy as process 17891 with command line:
[2023-07-24 10:36:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node22.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-24 10:36:10] [config] after: 0e
[2023-07-24 10:36:10] [config] after-batches: 0
[2023-07-24 10:36:10] [config] after-epochs: 80
[2023-07-24 10:36:10] [config] all-caps-every: 0
[2023-07-24 10:36:10] [config] allow-unk: false
[2023-07-24 10:36:10] [config] authors: false
[2023-07-24 10:36:10] [config] beam-size: 12
[2023-07-24 10:36:10] [config] bert-class-symbol: "[CLS]"
[2023-07-24 10:36:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-24 10:36:10] [config] bert-masking-fraction: 0.15
[2023-07-24 10:36:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-24 10:36:10] [config] bert-train-type-embeddings: true
[2023-07-24 10:36:10] [config] bert-type-vocab-size: 2
[2023-07-24 10:36:10] [config] build-info: ""
[2023-07-24 10:36:10] [config] check-gradient-nan: false
[2023-07-24 10:36:10] [config] check-nan: false
[2023-07-24 10:36:10] [config] cite: false
[2023-07-24 10:36:10] [config] clip-norm: 1
[2023-07-24 10:36:10] [config] cost-scaling:
[2023-07-24 10:36:10] [config]   - 256.f
[2023-07-24 10:36:10] [config]   - 1000
[2023-07-24 10:36:10] [config]   - 2.f
[2023-07-24 10:36:10] [config]   - 256.f
[2023-07-24 10:36:10] [config] cost-type: ce-sum
[2023-07-24 10:36:10] [config] cpu-threads: 0
[2023-07-24 10:36:10] [config] data-threads: 8
[2023-07-24 10:36:10] [config] data-weighting: ""
[2023-07-24 10:36:10] [config] data-weighting-type: sentence
[2023-07-24 10:36:10] [config] dec-cell: gru
[2023-07-24 10:36:10] [config] dec-cell-base-depth: 2
[2023-07-24 10:36:10] [config] dec-cell-high-depth: 1
[2023-07-24 10:36:10] [config] dec-depth: 1
[2023-07-24 10:36:10] [config] devices:
[2023-07-24 10:36:10] [config]   - 0
[2023-07-24 10:36:10] [config] dim-emb: 512
[2023-07-24 10:36:10] [config] dim-rnn: 1024
[2023-07-24 10:36:10] [config] dim-vocabs:
[2023-07-24 10:36:10] [config]   - 16384
[2023-07-24 10:36:10] [config]   - 16384
[2023-07-24 10:36:10] [config] disp-first: 0
[2023-07-24 10:36:10] [config] disp-freq: 1000u
[2023-07-24 10:36:10] [config] disp-label-counts: true
[2023-07-24 10:36:10] [config] dropout-rnn: 0
[2023-07-24 10:36:10] [config] dropout-src: 0
[2023-07-24 10:36:10] [config] dropout-trg: 0
[2023-07-24 10:36:10] [config] dump-config: ""
[2023-07-24 10:36:10] [config] dynamic-gradient-scaling:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] early-stopping: 200
[2023-07-24 10:36:10] [config] early-stopping-on: first
[2023-07-24 10:36:10] [config] embedding-fix-src: false
[2023-07-24 10:36:10] [config] embedding-fix-trg: false
[2023-07-24 10:36:10] [config] embedding-normalization: false
[2023-07-24 10:36:10] [config] embedding-vectors:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] enc-cell: gru
[2023-07-24 10:36:10] [config] enc-cell-depth: 1
[2023-07-24 10:36:10] [config] enc-depth: 1
[2023-07-24 10:36:10] [config] enc-type: bidirectional
[2023-07-24 10:36:10] [config] english-title-case-every: 0
[2023-07-24 10:36:10] [config] exponential-smoothing: 0
[2023-07-24 10:36:10] [config] factor-weight: 1
[2023-07-24 10:36:10] [config] factors-combine: sum
[2023-07-24 10:36:10] [config] factors-dim-emb: 0
[2023-07-24 10:36:10] [config] gradient-checkpointing: false
[2023-07-24 10:36:10] [config] gradient-norm-average-window: 100
[2023-07-24 10:36:10] [config] guided-alignment: none
[2023-07-24 10:36:10] [config] guided-alignment-cost: mse
[2023-07-24 10:36:10] [config] guided-alignment-weight: 0.1
[2023-07-24 10:36:10] [config] ignore-model-config: false
[2023-07-24 10:36:10] [config] input-types:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] interpolate-env-vars: false
[2023-07-24 10:36:10] [config] keep-best: false
[2023-07-24 10:36:10] [config] label-smoothing: 0
[2023-07-24 10:36:10] [config] layer-normalization: false
[2023-07-24 10:36:10] [config] learn-rate: 0.0001
[2023-07-24 10:36:10] [config] lemma-dependency: ""
[2023-07-24 10:36:10] [config] lemma-dim-emb: 0
[2023-07-24 10:36:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 10:36:10] [config] log-level: info
[2023-07-24 10:36:10] [config] log-time-zone: ""
[2023-07-24 10:36:10] [config] logical-epoch:
[2023-07-24 10:36:10] [config]   - 1e
[2023-07-24 10:36:10] [config]   - 0
[2023-07-24 10:36:10] [config] lr-decay: 0
[2023-07-24 10:36:10] [config] lr-decay-freq: 50000
[2023-07-24 10:36:10] [config] lr-decay-inv-sqrt:
[2023-07-24 10:36:10] [config]   - 0
[2023-07-24 10:36:10] [config] lr-decay-repeat-warmup: false
[2023-07-24 10:36:10] [config] lr-decay-reset-optimizer: false
[2023-07-24 10:36:10] [config] lr-decay-start:
[2023-07-24 10:36:10] [config]   - 10
[2023-07-24 10:36:10] [config]   - 1
[2023-07-24 10:36:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-24 10:36:10] [config] lr-report: false
[2023-07-24 10:36:10] [config] lr-warmup: 0
[2023-07-24 10:36:10] [config] lr-warmup-at-reload: false
[2023-07-24 10:36:10] [config] lr-warmup-cycle: false
[2023-07-24 10:36:10] [config] lr-warmup-start-rate: 0
[2023-07-24 10:36:10] [config] max-length: 250
[2023-07-24 10:36:10] [config] max-length-crop: true
[2023-07-24 10:36:10] [config] max-length-factor: 3
[2023-07-24 10:36:10] [config] maxi-batch: 100
[2023-07-24 10:36:10] [config] maxi-batch-sort: trg
[2023-07-24 10:36:10] [config] mini-batch: 64
[2023-07-24 10:36:10] [config] mini-batch-fit: true
[2023-07-24 10:36:10] [config] mini-batch-fit-step: 10
[2023-07-24 10:36:10] [config] mini-batch-round-up: true
[2023-07-24 10:36:10] [config] mini-batch-track-lr: false
[2023-07-24 10:36:10] [config] mini-batch-warmup: 0
[2023-07-24 10:36:10] [config] mini-batch-words: 0
[2023-07-24 10:36:10] [config] mini-batch-words-ref: 0
[2023-07-24 10:36:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from0_to6/es_gn_test_grid_lvl2_july_grid_from0_to6_max-length_250.npz
[2023-07-24 10:36:10] [config] multi-loss-type: sum
[2023-07-24 10:36:10] [config] n-best: false
[2023-07-24 10:36:10] [config] no-nccl: false
[2023-07-24 10:36:10] [config] no-reload: false
[2023-07-24 10:36:10] [config] no-restore-corpus: false
[2023-07-24 10:36:10] [config] normalize: 0
[2023-07-24 10:36:10] [config] normalize-gradient: false
[2023-07-24 10:36:10] [config] num-devices: 0
[2023-07-24 10:36:10] [config] optimizer: adam
[2023-07-24 10:36:10] [config] optimizer-delay: 1
[2023-07-24 10:36:10] [config] optimizer-params:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] output-omit-bias: false
[2023-07-24 10:36:10] [config] overwrite: true
[2023-07-24 10:36:10] [config] precision:
[2023-07-24 10:36:10] [config]   - float16
[2023-07-24 10:36:10] [config]   - float32
[2023-07-24 10:36:10] [config] pretrained-model: ""
[2023-07-24 10:36:10] [config] quantize-biases: false
[2023-07-24 10:36:10] [config] quantize-bits: 0
[2023-07-24 10:36:10] [config] quantize-log-based: false
[2023-07-24 10:36:10] [config] quantize-optimization-steps: 0
[2023-07-24 10:36:10] [config] quiet: false
[2023-07-24 10:36:10] [config] quiet-translation: true
[2023-07-24 10:36:10] [config] relative-paths: false
[2023-07-24 10:36:10] [config] right-left: false
[2023-07-24 10:36:10] [config] save-freq: 10000u
[2023-07-24 10:36:10] [config] seed: 1234
[2023-07-24 10:36:10] [config] sentencepiece-alphas:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] sentencepiece-max-lines: 2000000
[2023-07-24 10:36:10] [config] sentencepiece-options: ""
[2023-07-24 10:36:10] [config] sharding: global
[2023-07-24 10:36:10] [config] shuffle: data
[2023-07-24 10:36:10] [config] shuffle-in-ram: false
[2023-07-24 10:36:10] [config] sigterm: save-and-exit
[2023-07-24 10:36:10] [config] skip: false
[2023-07-24 10:36:10] [config] sqlite: ""
[2023-07-24 10:36:10] [config] sqlite-drop: false
[2023-07-24 10:36:10] [config] sync-freq: 200u
[2023-07-24 10:36:10] [config] sync-sgd: false
[2023-07-24 10:36:10] [config] tempdir: /tmp
[2023-07-24 10:36:10] [config] tied-embeddings: false
[2023-07-24 10:36:10] [config] tied-embeddings-all: true
[2023-07-24 10:36:10] [config] tied-embeddings-src: false
[2023-07-24 10:36:10] [config] train-embedder-rank:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] train-sets:
[2023-07-24 10:36:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-24 10:36:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-24 10:36:10] [config] transformer-aan-activation: swish
[2023-07-24 10:36:10] [config] transformer-aan-depth: 2
[2023-07-24 10:36:10] [config] transformer-aan-nogate: false
[2023-07-24 10:36:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-24 10:36:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-24 10:36:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-24 10:36:10] [config] transformer-depth-scaling: false
[2023-07-24 10:36:10] [config] transformer-dim-aan: 2048
[2023-07-24 10:36:10] [config] transformer-dim-ffn: 2048
[2023-07-24 10:36:10] [config] transformer-dropout: 0
[2023-07-24 10:36:10] [config] transformer-dropout-attention: 0
[2023-07-24 10:36:10] [config] transformer-dropout-ffn: 0
[2023-07-24 10:36:10] [config] transformer-ffn-activation: swish
[2023-07-24 10:36:10] [config] transformer-ffn-depth: 2
[2023-07-24 10:36:10] [config] transformer-guided-alignment-layer: last
[2023-07-24 10:36:10] [config] transformer-heads: 8
[2023-07-24 10:36:10] [config] transformer-no-projection: false
[2023-07-24 10:36:10] [config] transformer-pool: false
[2023-07-24 10:36:10] [config] transformer-postprocess: dan
[2023-07-24 10:36:10] [config] transformer-postprocess-emb: d
[2023-07-24 10:36:10] [config] transformer-postprocess-top: ""
[2023-07-24 10:36:10] [config] transformer-preprocess: ""
[2023-07-24 10:36:10] [config] transformer-tied-layers:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] transformer-train-position-embeddings: false
[2023-07-24 10:36:10] [config] tsv: false
[2023-07-24 10:36:10] [config] tsv-fields: 0
[2023-07-24 10:36:10] [config] type: amun
[2023-07-24 10:36:10] [config] ulr: false
[2023-07-24 10:36:10] [config] ulr-dim-emb: 0
[2023-07-24 10:36:10] [config] ulr-dropout: 0
[2023-07-24 10:36:10] [config] ulr-keys-vectors: ""
[2023-07-24 10:36:10] [config] ulr-query-vectors: ""
[2023-07-24 10:36:10] [config] ulr-softmax-temperature: 1
[2023-07-24 10:36:10] [config] ulr-trainable-transformation: false
[2023-07-24 10:36:10] [config] unlikelihood-loss: false
[2023-07-24 10:36:10] [config] valid-freq: 50000000
[2023-07-24 10:36:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from0_to6.log
[2023-07-24 10:36:10] [config] valid-max-length: 1000
[2023-07-24 10:36:10] [config] valid-metrics:
[2023-07-24 10:36:10] [config]   - cross-entropy
[2023-07-24 10:36:10] [config]   - translation
[2023-07-24 10:36:10] [config] valid-mini-batch: 32
[2023-07-24 10:36:10] [config] valid-reset-stalled: false
[2023-07-24 10:36:10] [config] valid-script-args:
[2023-07-24 10:36:10] [config]   []
[2023-07-24 10:36:10] [config] valid-script-path: ""
[2023-07-24 10:36:10] [config] valid-sets:
[2023-07-24 10:36:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-24 10:36:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-24 10:36:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node22.txt
[2023-07-24 10:36:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 10:36:10] [config] vocabs:
[2023-07-24 10:36:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 10:36:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 10:36:10] [config] word-penalty: 0
[2023-07-24 10:36:10] [config] word-scores: false
[2023-07-24 10:36:10] [config] workspace: 5500
[2023-07-24 10:36:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-24 10:36:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 10:36:10] [training] Using single-device training
[2023-07-24 10:36:11] Synced seed 1234
[2023-07-24 10:36:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-24 10:36:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-24 10:36:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-24 10:36:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-24 10:36:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-24 10:36:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-24 10:36:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-24 10:36:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-24 10:36:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-24 10:36:12] [comm] Using global sharding
[2023-07-24 10:36:12] [comm] NCCLCommunicators constructed successfully
[2023-07-24 10:36:12] [training] Using 1 GPUs
[2023-07-24 10:36:12] [logits] Applying loss function for 1 factor(s)
[2023-07-24 10:36:12] [memory] Reserving 80 MB, device gpu0
[2023-07-24 10:36:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-24 10:36:12] [memory] Reserving 80 MB, device gpu0
