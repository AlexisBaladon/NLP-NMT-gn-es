[2023-07-17 13:47:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:13] [marian] Running on node22.datos.cluster.uy as process 6933 with command line:
[2023-07-17 13:47:13] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:13] [config] after: 0e
[2023-07-17 13:47:13] [config] after-batches: 0
[2023-07-17 13:47:13] [config] after-epochs: 10
[2023-07-17 13:47:13] [config] all-caps-every: 0
[2023-07-17 13:47:13] [config] allow-unk: false
[2023-07-17 13:47:13] [config] authors: false
[2023-07-17 13:47:13] [config] beam-size: 12
[2023-07-17 13:47:13] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:13] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:13] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:13] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:13] [config] build-info: ""
[2023-07-17 13:47:13] [config] check-gradient-nan: false
[2023-07-17 13:47:13] [config] check-nan: false
[2023-07-17 13:47:13] [config] cite: false
[2023-07-17 13:47:13] [config] clip-norm: 1
[2023-07-17 13:47:13] [config] cost-scaling:
[2023-07-17 13:47:13] [config]   - 256.f
[2023-07-17 13:47:13] [config]   - 1000
[2023-07-17 13:47:13] [config]   - 2.f
[2023-07-17 13:47:13] [config]   - 256.f
[2023-07-17 13:47:13] [config] cost-type: ce-sum
[2023-07-17 13:47:13] [config] cpu-threads: 0
[2023-07-17 13:47:13] [config] data-threads: 8
[2023-07-17 13:47:13] [config] data-weighting: ""
[2023-07-17 13:47:13] [config] data-weighting-type: sentence
[2023-07-17 13:47:13] [config] dec-cell: gru
[2023-07-17 13:47:13] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:13] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:13] [config] dec-depth: 2
[2023-07-17 13:47:13] [config] devices:
[2023-07-17 13:47:13] [config]   - 0
[2023-07-17 13:47:13] [config] dim-emb: 512
[2023-07-17 13:47:13] [config] dim-rnn: 1024
[2023-07-17 13:47:13] [config] dim-vocabs:
[2023-07-17 13:47:13] [config]   - 16384
[2023-07-17 13:47:13] [config]   - 16384
[2023-07-17 13:47:13] [config] disp-first: 0
[2023-07-17 13:47:13] [config] disp-freq: 1000u
[2023-07-17 13:47:13] [config] disp-label-counts: true
[2023-07-17 13:47:13] [config] dropout-rnn: 0
[2023-07-17 13:47:13] [config] dropout-src: 0
[2023-07-17 13:47:13] [config] dropout-trg: 0
[2023-07-17 13:47:13] [config] dump-config: ""
[2023-07-17 13:47:13] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] early-stopping: 5
[2023-07-17 13:47:13] [config] early-stopping-on: first
[2023-07-17 13:47:13] [config] embedding-fix-src: false
[2023-07-17 13:47:13] [config] embedding-fix-trg: false
[2023-07-17 13:47:13] [config] embedding-normalization: false
[2023-07-17 13:47:13] [config] embedding-vectors:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] enc-cell: gru
[2023-07-17 13:47:13] [config] enc-cell-depth: 1
[2023-07-17 13:47:13] [config] enc-depth: 1
[2023-07-17 13:47:13] [config] enc-type: bidirectional
[2023-07-17 13:47:13] [config] english-title-case-every: 0
[2023-07-17 13:47:13] [config] exponential-smoothing: 0
[2023-07-17 13:47:13] [config] factor-weight: 1
[2023-07-17 13:47:13] [config] factors-combine: sum
[2023-07-17 13:47:13] [config] factors-dim-emb: 0
[2023-07-17 13:47:13] [config] gradient-checkpointing: false
[2023-07-17 13:47:13] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:13] [config] guided-alignment: none
[2023-07-17 13:47:13] [config] guided-alignment-cost: mse
[2023-07-17 13:47:13] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:13] [config] ignore-model-config: false
[2023-07-17 13:47:13] [config] input-types:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] interpolate-env-vars: false
[2023-07-17 13:47:13] [config] keep-best: false
[2023-07-17 13:47:13] [config] label-smoothing: 0
[2023-07-17 13:47:13] [config] layer-normalization: false
[2023-07-17 13:47:13] [config] learn-rate: 0.0001
[2023-07-17 13:47:13] [config] lemma-dependency: ""
[2023-07-17 13:47:13] [config] lemma-dim-emb: 0
[2023-07-17 13:47:13] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:13] [config] log-level: info
[2023-07-17 13:47:13] [config] log-time-zone: ""
[2023-07-17 13:47:13] [config] logical-epoch:
[2023-07-17 13:47:13] [config]   - 1e
[2023-07-17 13:47:13] [config]   - 0
[2023-07-17 13:47:13] [config] lr-decay: 0
[2023-07-17 13:47:13] [config] lr-decay-freq: 50000
[2023-07-17 13:47:13] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:13] [config]   - 0
[2023-07-17 13:47:13] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:13] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:13] [config] lr-decay-start:
[2023-07-17 13:47:13] [config]   - 10
[2023-07-17 13:47:13] [config]   - 1
[2023-07-17 13:47:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:13] [config] lr-report: false
[2023-07-17 13:47:13] [config] lr-warmup: 0
[2023-07-17 13:47:13] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:13] [config] lr-warmup-cycle: false
[2023-07-17 13:47:13] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:13] [config] max-length: 50
[2023-07-17 13:47:13] [config] max-length-crop: true
[2023-07-17 13:47:13] [config] max-length-factor: 3
[2023-07-17 13:47:13] [config] maxi-batch: 100
[2023-07-17 13:47:13] [config] maxi-batch-sort: trg
[2023-07-17 13:47:13] [config] mini-batch: 64
[2023-07-17 13:47:13] [config] mini-batch-fit: true
[2023-07-17 13:47:13] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:13] [config] mini-batch-round-up: true
[2023-07-17 13:47:13] [config] mini-batch-track-lr: false
[2023-07-17 13:47:13] [config] mini-batch-warmup: 0
[2023-07-17 13:47:13] [config] mini-batch-words: 0
[2023-07-17 13:47:13] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:13] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:13] [config] multi-loss-type: sum
[2023-07-17 13:47:13] [config] n-best: false
[2023-07-17 13:47:13] [config] no-nccl: false
[2023-07-17 13:47:13] [config] no-reload: false
[2023-07-17 13:47:13] [config] no-restore-corpus: false
[2023-07-17 13:47:13] [config] normalize: 0
[2023-07-17 13:47:13] [config] normalize-gradient: false
[2023-07-17 13:47:13] [config] num-devices: 0
[2023-07-17 13:47:13] [config] optimizer: adam
[2023-07-17 13:47:13] [config] optimizer-delay: 1
[2023-07-17 13:47:13] [config] optimizer-params:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] output-omit-bias: false
[2023-07-17 13:47:13] [config] overwrite: true
[2023-07-17 13:47:13] [config] precision:
[2023-07-17 13:47:13] [config]   - float16
[2023-07-17 13:47:13] [config]   - float32
[2023-07-17 13:47:13] [config] pretrained-model: ""
[2023-07-17 13:47:13] [config] quantize-biases: false
[2023-07-17 13:47:13] [config] quantize-bits: 0
[2023-07-17 13:47:13] [config] quantize-log-based: false
[2023-07-17 13:47:13] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:13] [config] quiet: false
[2023-07-17 13:47:13] [config] quiet-translation: true
[2023-07-17 13:47:13] [config] relative-paths: false
[2023-07-17 13:47:13] [config] right-left: false
[2023-07-17 13:47:13] [config] save-freq: 10000u
[2023-07-17 13:47:13] [config] seed: 1234
[2023-07-17 13:47:13] [config] sentencepiece-alphas:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:13] [config] sentencepiece-options: ""
[2023-07-17 13:47:13] [config] sharding: global
[2023-07-17 13:47:13] [config] shuffle: data
[2023-07-17 13:47:13] [config] shuffle-in-ram: false
[2023-07-17 13:47:13] [config] sigterm: save-and-exit
[2023-07-17 13:47:13] [config] skip: false
[2023-07-17 13:47:13] [config] sqlite: ""
[2023-07-17 13:47:13] [config] sqlite-drop: false
[2023-07-17 13:47:13] [config] sync-freq: 200u
[2023-07-17 13:47:13] [config] sync-sgd: false
[2023-07-17 13:47:13] [config] tempdir: /tmp
[2023-07-17 13:47:13] [config] tied-embeddings: false
[2023-07-17 13:47:13] [config] tied-embeddings-all: true
[2023-07-17 13:47:13] [config] tied-embeddings-src: false
[2023-07-17 13:47:13] [config] train-embedder-rank:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] train-sets:
[2023-07-17 13:47:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:13] [config] transformer-aan-activation: swish
[2023-07-17 13:47:13] [config] transformer-aan-depth: 2
[2023-07-17 13:47:13] [config] transformer-aan-nogate: false
[2023-07-17 13:47:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:13] [config] transformer-depth-scaling: false
[2023-07-17 13:47:13] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:13] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:13] [config] transformer-dropout: 0
[2023-07-17 13:47:13] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:13] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:13] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:13] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:13] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:13] [config] transformer-heads: 8
[2023-07-17 13:47:13] [config] transformer-no-projection: false
[2023-07-17 13:47:13] [config] transformer-pool: false
[2023-07-17 13:47:13] [config] transformer-postprocess: dan
[2023-07-17 13:47:13] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:13] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:13] [config] transformer-preprocess: ""
[2023-07-17 13:47:13] [config] transformer-tied-layers:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:13] [config] tsv: false
[2023-07-17 13:47:13] [config] tsv-fields: 0
[2023-07-17 13:47:13] [config] type: amun
[2023-07-17 13:47:13] [config] ulr: false
[2023-07-17 13:47:13] [config] ulr-dim-emb: 0
[2023-07-17 13:47:13] [config] ulr-dropout: 0
[2023-07-17 13:47:13] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:13] [config] ulr-query-vectors: ""
[2023-07-17 13:47:13] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:13] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:13] [config] unlikelihood-loss: false
[2023-07-17 13:47:13] [config] valid-freq: 50000000
[2023-07-17 13:47:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:13] [config] valid-max-length: 1000
[2023-07-17 13:47:13] [config] valid-metrics:
[2023-07-17 13:47:13] [config]   - cross-entropy
[2023-07-17 13:47:13] [config]   - translation
[2023-07-17 13:47:13] [config] valid-mini-batch: 32
[2023-07-17 13:47:13] [config] valid-reset-stalled: false
[2023-07-17 13:47:13] [config] valid-script-args:
[2023-07-17 13:47:13] [config]   []
[2023-07-17 13:47:13] [config] valid-script-path: ""
[2023-07-17 13:47:13] [config] valid-sets:
[2023-07-17 13:47:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:13] [config] vocabs:
[2023-07-17 13:47:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:13] [config] word-penalty: 0
[2023-07-17 13:47:13] [config] word-scores: false
[2023-07-17 13:47:13] [config] workspace: 5500
[2023-07-17 13:47:13] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:13] [training] Using single-device training
[2023-07-17 13:47:14] Synced seed 1234
[2023-07-17 13:47:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:14] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:14] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:17] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:17] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x55c0cf45fb5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x55c0cf3a1da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55c0cf3a61a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55c0cf3ad2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55c0cf559a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55c0cf55aa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55c0cf533bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55c0cf035108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55c0cef572c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55c0cef0eb9c]    main                                               + 0x3c
[0x7fcc1b6ba0b3]    __libc_start_main                                  + 0xf3
[0x55c0cef55cbe]    _start                                             + 0x2e

[2023-07-17 13:47:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:18] [marian] Running on node22.datos.cluster.uy as process 7063 with command line:
[2023-07-17 13:47:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:18] [config] after: 0e
[2023-07-17 13:47:18] [config] after-batches: 0
[2023-07-17 13:47:18] [config] after-epochs: 20
[2023-07-17 13:47:18] [config] all-caps-every: 0
[2023-07-17 13:47:18] [config] allow-unk: false
[2023-07-17 13:47:18] [config] authors: false
[2023-07-17 13:47:18] [config] beam-size: 12
[2023-07-17 13:47:18] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:18] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:18] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:18] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:18] [config] build-info: ""
[2023-07-17 13:47:18] [config] check-gradient-nan: false
[2023-07-17 13:47:18] [config] check-nan: false
[2023-07-17 13:47:18] [config] cite: false
[2023-07-17 13:47:18] [config] clip-norm: 1
[2023-07-17 13:47:18] [config] cost-scaling:
[2023-07-17 13:47:18] [config]   - 256.f
[2023-07-17 13:47:18] [config]   - 1000
[2023-07-17 13:47:18] [config]   - 2.f
[2023-07-17 13:47:18] [config]   - 256.f
[2023-07-17 13:47:18] [config] cost-type: ce-sum
[2023-07-17 13:47:18] [config] cpu-threads: 0
[2023-07-17 13:47:18] [config] data-threads: 8
[2023-07-17 13:47:18] [config] data-weighting: ""
[2023-07-17 13:47:18] [config] data-weighting-type: sentence
[2023-07-17 13:47:18] [config] dec-cell: gru
[2023-07-17 13:47:18] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:18] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:18] [config] dec-depth: 2
[2023-07-17 13:47:18] [config] devices:
[2023-07-17 13:47:18] [config]   - 0
[2023-07-17 13:47:18] [config] dim-emb: 512
[2023-07-17 13:47:18] [config] dim-rnn: 1024
[2023-07-17 13:47:18] [config] dim-vocabs:
[2023-07-17 13:47:18] [config]   - 16384
[2023-07-17 13:47:18] [config]   - 16384
[2023-07-17 13:47:18] [config] disp-first: 0
[2023-07-17 13:47:18] [config] disp-freq: 1000u
[2023-07-17 13:47:18] [config] disp-label-counts: true
[2023-07-17 13:47:18] [config] dropout-rnn: 0
[2023-07-17 13:47:18] [config] dropout-src: 0
[2023-07-17 13:47:18] [config] dropout-trg: 0
[2023-07-17 13:47:18] [config] dump-config: ""
[2023-07-17 13:47:18] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] early-stopping: 5
[2023-07-17 13:47:18] [config] early-stopping-on: first
[2023-07-17 13:47:18] [config] embedding-fix-src: false
[2023-07-17 13:47:18] [config] embedding-fix-trg: false
[2023-07-17 13:47:18] [config] embedding-normalization: false
[2023-07-17 13:47:18] [config] embedding-vectors:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] enc-cell: gru
[2023-07-17 13:47:18] [config] enc-cell-depth: 1
[2023-07-17 13:47:18] [config] enc-depth: 1
[2023-07-17 13:47:18] [config] enc-type: bidirectional
[2023-07-17 13:47:18] [config] english-title-case-every: 0
[2023-07-17 13:47:18] [config] exponential-smoothing: 0
[2023-07-17 13:47:18] [config] factor-weight: 1
[2023-07-17 13:47:18] [config] factors-combine: sum
[2023-07-17 13:47:18] [config] factors-dim-emb: 0
[2023-07-17 13:47:18] [config] gradient-checkpointing: false
[2023-07-17 13:47:18] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:18] [config] guided-alignment: none
[2023-07-17 13:47:18] [config] guided-alignment-cost: mse
[2023-07-17 13:47:18] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:18] [config] ignore-model-config: false
[2023-07-17 13:47:18] [config] input-types:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] interpolate-env-vars: false
[2023-07-17 13:47:18] [config] keep-best: false
[2023-07-17 13:47:18] [config] label-smoothing: 0
[2023-07-17 13:47:18] [config] layer-normalization: false
[2023-07-17 13:47:18] [config] learn-rate: 0.0001
[2023-07-17 13:47:18] [config] lemma-dependency: ""
[2023-07-17 13:47:18] [config] lemma-dim-emb: 0
[2023-07-17 13:47:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:18] [config] log-level: info
[2023-07-17 13:47:18] [config] log-time-zone: ""
[2023-07-17 13:47:18] [config] logical-epoch:
[2023-07-17 13:47:18] [config]   - 1e
[2023-07-17 13:47:18] [config]   - 0
[2023-07-17 13:47:18] [config] lr-decay: 0
[2023-07-17 13:47:18] [config] lr-decay-freq: 50000
[2023-07-17 13:47:18] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:18] [config]   - 0
[2023-07-17 13:47:18] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:18] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:18] [config] lr-decay-start:
[2023-07-17 13:47:18] [config]   - 10
[2023-07-17 13:47:18] [config]   - 1
[2023-07-17 13:47:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:18] [config] lr-report: false
[2023-07-17 13:47:18] [config] lr-warmup: 0
[2023-07-17 13:47:18] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:18] [config] lr-warmup-cycle: false
[2023-07-17 13:47:18] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:18] [config] max-length: 50
[2023-07-17 13:47:18] [config] max-length-crop: true
[2023-07-17 13:47:18] [config] max-length-factor: 3
[2023-07-17 13:47:18] [config] maxi-batch: 100
[2023-07-17 13:47:18] [config] maxi-batch-sort: trg
[2023-07-17 13:47:18] [config] mini-batch: 64
[2023-07-17 13:47:18] [config] mini-batch-fit: true
[2023-07-17 13:47:18] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:18] [config] mini-batch-round-up: true
[2023-07-17 13:47:18] [config] mini-batch-track-lr: false
[2023-07-17 13:47:18] [config] mini-batch-warmup: 0
[2023-07-17 13:47:18] [config] mini-batch-words: 0
[2023-07-17 13:47:18] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:18] [config] multi-loss-type: sum
[2023-07-17 13:47:18] [config] n-best: false
[2023-07-17 13:47:18] [config] no-nccl: false
[2023-07-17 13:47:18] [config] no-reload: false
[2023-07-17 13:47:18] [config] no-restore-corpus: false
[2023-07-17 13:47:18] [config] normalize: 0
[2023-07-17 13:47:18] [config] normalize-gradient: false
[2023-07-17 13:47:18] [config] num-devices: 0
[2023-07-17 13:47:18] [config] optimizer: adam
[2023-07-17 13:47:18] [config] optimizer-delay: 1
[2023-07-17 13:47:18] [config] optimizer-params:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] output-omit-bias: false
[2023-07-17 13:47:18] [config] overwrite: true
[2023-07-17 13:47:18] [config] precision:
[2023-07-17 13:47:18] [config]   - float16
[2023-07-17 13:47:18] [config]   - float32
[2023-07-17 13:47:18] [config] pretrained-model: ""
[2023-07-17 13:47:18] [config] quantize-biases: false
[2023-07-17 13:47:18] [config] quantize-bits: 0
[2023-07-17 13:47:18] [config] quantize-log-based: false
[2023-07-17 13:47:18] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:18] [config] quiet: false
[2023-07-17 13:47:18] [config] quiet-translation: true
[2023-07-17 13:47:18] [config] relative-paths: false
[2023-07-17 13:47:18] [config] right-left: false
[2023-07-17 13:47:18] [config] save-freq: 10000u
[2023-07-17 13:47:18] [config] seed: 1234
[2023-07-17 13:47:18] [config] sentencepiece-alphas:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:18] [config] sentencepiece-options: ""
[2023-07-17 13:47:18] [config] sharding: global
[2023-07-17 13:47:18] [config] shuffle: data
[2023-07-17 13:47:18] [config] shuffle-in-ram: false
[2023-07-17 13:47:18] [config] sigterm: save-and-exit
[2023-07-17 13:47:18] [config] skip: false
[2023-07-17 13:47:18] [config] sqlite: ""
[2023-07-17 13:47:18] [config] sqlite-drop: false
[2023-07-17 13:47:18] [config] sync-freq: 200u
[2023-07-17 13:47:18] [config] sync-sgd: false
[2023-07-17 13:47:18] [config] tempdir: /tmp
[2023-07-17 13:47:18] [config] tied-embeddings: false
[2023-07-17 13:47:18] [config] tied-embeddings-all: true
[2023-07-17 13:47:18] [config] tied-embeddings-src: false
[2023-07-17 13:47:18] [config] train-embedder-rank:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] train-sets:
[2023-07-17 13:47:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:18] [config] transformer-aan-activation: swish
[2023-07-17 13:47:18] [config] transformer-aan-depth: 2
[2023-07-17 13:47:18] [config] transformer-aan-nogate: false
[2023-07-17 13:47:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:18] [config] transformer-depth-scaling: false
[2023-07-17 13:47:18] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:18] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:18] [config] transformer-dropout: 0
[2023-07-17 13:47:18] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:18] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:18] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:18] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:18] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:18] [config] transformer-heads: 8
[2023-07-17 13:47:18] [config] transformer-no-projection: false
[2023-07-17 13:47:18] [config] transformer-pool: false
[2023-07-17 13:47:18] [config] transformer-postprocess: dan
[2023-07-17 13:47:18] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:18] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:18] [config] transformer-preprocess: ""
[2023-07-17 13:47:18] [config] transformer-tied-layers:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:18] [config] tsv: false
[2023-07-17 13:47:18] [config] tsv-fields: 0
[2023-07-17 13:47:18] [config] type: amun
[2023-07-17 13:47:18] [config] ulr: false
[2023-07-17 13:47:18] [config] ulr-dim-emb: 0
[2023-07-17 13:47:18] [config] ulr-dropout: 0
[2023-07-17 13:47:18] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:18] [config] ulr-query-vectors: ""
[2023-07-17 13:47:18] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:18] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:18] [config] unlikelihood-loss: false
[2023-07-17 13:47:18] [config] valid-freq: 50000000
[2023-07-17 13:47:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:18] [config] valid-max-length: 1000
[2023-07-17 13:47:18] [config] valid-metrics:
[2023-07-17 13:47:18] [config]   - cross-entropy
[2023-07-17 13:47:18] [config]   - translation
[2023-07-17 13:47:18] [config] valid-mini-batch: 32
[2023-07-17 13:47:18] [config] valid-reset-stalled: false
[2023-07-17 13:47:18] [config] valid-script-args:
[2023-07-17 13:47:18] [config]   []
[2023-07-17 13:47:18] [config] valid-script-path: ""
[2023-07-17 13:47:18] [config] valid-sets:
[2023-07-17 13:47:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:18] [config] vocabs:
[2023-07-17 13:47:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:18] [config] word-penalty: 0
[2023-07-17 13:47:18] [config] word-scores: false
[2023-07-17 13:47:18] [config] workspace: 5500
[2023-07-17 13:47:18] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:18] [training] Using single-device training
[2023-07-17 13:47:18] Synced seed 1234
[2023-07-17 13:47:18] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:18] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:20] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:20] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x564328a31b5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x564328973da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5643289781a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x56432897f2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x564328b2ba0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x564328b2ca53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x564328b05bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x564328607108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5643285292c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5643284e0b9c]    main                                               + 0x3c
[0x7f75d99db0b3]    __libc_start_main                                  + 0xf3
[0x564328527cbe]    _start                                             + 0x2e

[2023-07-17 13:47:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:21] [marian] Running on node22.datos.cluster.uy as process 7088 with command line:
[2023-07-17 13:47:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:21] [config] after: 0e
[2023-07-17 13:47:21] [config] after-batches: 0
[2023-07-17 13:47:21] [config] after-epochs: 30
[2023-07-17 13:47:21] [config] all-caps-every: 0
[2023-07-17 13:47:21] [config] allow-unk: false
[2023-07-17 13:47:21] [config] authors: false
[2023-07-17 13:47:21] [config] beam-size: 12
[2023-07-17 13:47:21] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:21] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:21] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:21] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:21] [config] build-info: ""
[2023-07-17 13:47:21] [config] check-gradient-nan: false
[2023-07-17 13:47:21] [config] check-nan: false
[2023-07-17 13:47:21] [config] cite: false
[2023-07-17 13:47:21] [config] clip-norm: 1
[2023-07-17 13:47:21] [config] cost-scaling:
[2023-07-17 13:47:21] [config]   - 256.f
[2023-07-17 13:47:21] [config]   - 1000
[2023-07-17 13:47:21] [config]   - 2.f
[2023-07-17 13:47:21] [config]   - 256.f
[2023-07-17 13:47:21] [config] cost-type: ce-sum
[2023-07-17 13:47:21] [config] cpu-threads: 0
[2023-07-17 13:47:21] [config] data-threads: 8
[2023-07-17 13:47:21] [config] data-weighting: ""
[2023-07-17 13:47:21] [config] data-weighting-type: sentence
[2023-07-17 13:47:21] [config] dec-cell: gru
[2023-07-17 13:47:21] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:21] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:21] [config] dec-depth: 2
[2023-07-17 13:47:21] [config] devices:
[2023-07-17 13:47:21] [config]   - 0
[2023-07-17 13:47:21] [config] dim-emb: 512
[2023-07-17 13:47:21] [config] dim-rnn: 1024
[2023-07-17 13:47:21] [config] dim-vocabs:
[2023-07-17 13:47:21] [config]   - 16384
[2023-07-17 13:47:21] [config]   - 16384
[2023-07-17 13:47:21] [config] disp-first: 0
[2023-07-17 13:47:21] [config] disp-freq: 1000u
[2023-07-17 13:47:21] [config] disp-label-counts: true
[2023-07-17 13:47:21] [config] dropout-rnn: 0
[2023-07-17 13:47:21] [config] dropout-src: 0
[2023-07-17 13:47:21] [config] dropout-trg: 0
[2023-07-17 13:47:21] [config] dump-config: ""
[2023-07-17 13:47:21] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] early-stopping: 5
[2023-07-17 13:47:21] [config] early-stopping-on: first
[2023-07-17 13:47:21] [config] embedding-fix-src: false
[2023-07-17 13:47:21] [config] embedding-fix-trg: false
[2023-07-17 13:47:21] [config] embedding-normalization: false
[2023-07-17 13:47:21] [config] embedding-vectors:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] enc-cell: gru
[2023-07-17 13:47:21] [config] enc-cell-depth: 1
[2023-07-17 13:47:21] [config] enc-depth: 1
[2023-07-17 13:47:21] [config] enc-type: bidirectional
[2023-07-17 13:47:21] [config] english-title-case-every: 0
[2023-07-17 13:47:21] [config] exponential-smoothing: 0
[2023-07-17 13:47:21] [config] factor-weight: 1
[2023-07-17 13:47:21] [config] factors-combine: sum
[2023-07-17 13:47:21] [config] factors-dim-emb: 0
[2023-07-17 13:47:21] [config] gradient-checkpointing: false
[2023-07-17 13:47:21] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:21] [config] guided-alignment: none
[2023-07-17 13:47:21] [config] guided-alignment-cost: mse
[2023-07-17 13:47:21] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:21] [config] ignore-model-config: false
[2023-07-17 13:47:21] [config] input-types:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] interpolate-env-vars: false
[2023-07-17 13:47:21] [config] keep-best: false
[2023-07-17 13:47:21] [config] label-smoothing: 0
[2023-07-17 13:47:21] [config] layer-normalization: false
[2023-07-17 13:47:21] [config] learn-rate: 0.0001
[2023-07-17 13:47:21] [config] lemma-dependency: ""
[2023-07-17 13:47:21] [config] lemma-dim-emb: 0
[2023-07-17 13:47:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:21] [config] log-level: info
[2023-07-17 13:47:21] [config] log-time-zone: ""
[2023-07-17 13:47:21] [config] logical-epoch:
[2023-07-17 13:47:21] [config]   - 1e
[2023-07-17 13:47:21] [config]   - 0
[2023-07-17 13:47:21] [config] lr-decay: 0
[2023-07-17 13:47:21] [config] lr-decay-freq: 50000
[2023-07-17 13:47:21] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:21] [config]   - 0
[2023-07-17 13:47:21] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:21] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:21] [config] lr-decay-start:
[2023-07-17 13:47:21] [config]   - 10
[2023-07-17 13:47:21] [config]   - 1
[2023-07-17 13:47:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:21] [config] lr-report: false
[2023-07-17 13:47:21] [config] lr-warmup: 0
[2023-07-17 13:47:21] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:21] [config] lr-warmup-cycle: false
[2023-07-17 13:47:21] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:21] [config] max-length: 50
[2023-07-17 13:47:21] [config] max-length-crop: true
[2023-07-17 13:47:21] [config] max-length-factor: 3
[2023-07-17 13:47:21] [config] maxi-batch: 100
[2023-07-17 13:47:21] [config] maxi-batch-sort: trg
[2023-07-17 13:47:21] [config] mini-batch: 64
[2023-07-17 13:47:21] [config] mini-batch-fit: true
[2023-07-17 13:47:21] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:21] [config] mini-batch-round-up: true
[2023-07-17 13:47:21] [config] mini-batch-track-lr: false
[2023-07-17 13:47:21] [config] mini-batch-warmup: 0
[2023-07-17 13:47:21] [config] mini-batch-words: 0
[2023-07-17 13:47:21] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:21] [config] multi-loss-type: sum
[2023-07-17 13:47:21] [config] n-best: false
[2023-07-17 13:47:21] [config] no-nccl: false
[2023-07-17 13:47:21] [config] no-reload: false
[2023-07-17 13:47:21] [config] no-restore-corpus: false
[2023-07-17 13:47:21] [config] normalize: 0
[2023-07-17 13:47:21] [config] normalize-gradient: false
[2023-07-17 13:47:21] [config] num-devices: 0
[2023-07-17 13:47:21] [config] optimizer: adam
[2023-07-17 13:47:21] [config] optimizer-delay: 1
[2023-07-17 13:47:21] [config] optimizer-params:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] output-omit-bias: false
[2023-07-17 13:47:21] [config] overwrite: true
[2023-07-17 13:47:21] [config] precision:
[2023-07-17 13:47:21] [config]   - float16
[2023-07-17 13:47:21] [config]   - float32
[2023-07-17 13:47:21] [config] pretrained-model: ""
[2023-07-17 13:47:21] [config] quantize-biases: false
[2023-07-17 13:47:21] [config] quantize-bits: 0
[2023-07-17 13:47:21] [config] quantize-log-based: false
[2023-07-17 13:47:21] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:21] [config] quiet: false
[2023-07-17 13:47:21] [config] quiet-translation: true
[2023-07-17 13:47:21] [config] relative-paths: false
[2023-07-17 13:47:21] [config] right-left: false
[2023-07-17 13:47:21] [config] save-freq: 10000u
[2023-07-17 13:47:21] [config] seed: 1234
[2023-07-17 13:47:21] [config] sentencepiece-alphas:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:21] [config] sentencepiece-options: ""
[2023-07-17 13:47:21] [config] sharding: global
[2023-07-17 13:47:21] [config] shuffle: data
[2023-07-17 13:47:21] [config] shuffle-in-ram: false
[2023-07-17 13:47:21] [config] sigterm: save-and-exit
[2023-07-17 13:47:21] [config] skip: false
[2023-07-17 13:47:21] [config] sqlite: ""
[2023-07-17 13:47:21] [config] sqlite-drop: false
[2023-07-17 13:47:21] [config] sync-freq: 200u
[2023-07-17 13:47:21] [config] sync-sgd: false
[2023-07-17 13:47:21] [config] tempdir: /tmp
[2023-07-17 13:47:21] [config] tied-embeddings: false
[2023-07-17 13:47:21] [config] tied-embeddings-all: true
[2023-07-17 13:47:21] [config] tied-embeddings-src: false
[2023-07-17 13:47:21] [config] train-embedder-rank:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] train-sets:
[2023-07-17 13:47:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:21] [config] transformer-aan-activation: swish
[2023-07-17 13:47:21] [config] transformer-aan-depth: 2
[2023-07-17 13:47:21] [config] transformer-aan-nogate: false
[2023-07-17 13:47:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:21] [config] transformer-depth-scaling: false
[2023-07-17 13:47:21] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:21] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:21] [config] transformer-dropout: 0
[2023-07-17 13:47:21] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:21] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:21] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:21] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:21] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:21] [config] transformer-heads: 8
[2023-07-17 13:47:21] [config] transformer-no-projection: false
[2023-07-17 13:47:21] [config] transformer-pool: false
[2023-07-17 13:47:21] [config] transformer-postprocess: dan
[2023-07-17 13:47:21] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:21] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:21] [config] transformer-preprocess: ""
[2023-07-17 13:47:21] [config] transformer-tied-layers:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:21] [config] tsv: false
[2023-07-17 13:47:21] [config] tsv-fields: 0
[2023-07-17 13:47:21] [config] type: amun
[2023-07-17 13:47:21] [config] ulr: false
[2023-07-17 13:47:21] [config] ulr-dim-emb: 0
[2023-07-17 13:47:21] [config] ulr-dropout: 0
[2023-07-17 13:47:21] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:21] [config] ulr-query-vectors: ""
[2023-07-17 13:47:21] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:21] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:21] [config] unlikelihood-loss: false
[2023-07-17 13:47:21] [config] valid-freq: 50000000
[2023-07-17 13:47:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:21] [config] valid-max-length: 1000
[2023-07-17 13:47:21] [config] valid-metrics:
[2023-07-17 13:47:21] [config]   - cross-entropy
[2023-07-17 13:47:21] [config]   - translation
[2023-07-17 13:47:21] [config] valid-mini-batch: 32
[2023-07-17 13:47:21] [config] valid-reset-stalled: false
[2023-07-17 13:47:21] [config] valid-script-args:
[2023-07-17 13:47:21] [config]   []
[2023-07-17 13:47:21] [config] valid-script-path: ""
[2023-07-17 13:47:21] [config] valid-sets:
[2023-07-17 13:47:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:21] [config] vocabs:
[2023-07-17 13:47:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:21] [config] word-penalty: 0
[2023-07-17 13:47:21] [config] word-scores: false
[2023-07-17 13:47:21] [config] workspace: 5500
[2023-07-17 13:47:21] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:21] [training] Using single-device training
[2023-07-17 13:47:21] Synced seed 1234
[2023-07-17 13:47:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:21] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:22] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:22] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x561ac20dfb5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x561ac2021da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x561ac20261a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x561ac202d2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x561ac21d9a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x561ac21daa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x561ac21b3bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x561ac1cb5108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x561ac1bd72c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x561ac1b8eb9c]    main                                               + 0x3c
[0x7f84cd79b0b3]    __libc_start_main                                  + 0xf3
[0x561ac1bd5cbe]    _start                                             + 0x2e

[2023-07-17 13:47:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:23] [marian] Running on node22.datos.cluster.uy as process 7113 with command line:
[2023-07-17 13:47:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:23] [config] after: 0e
[2023-07-17 13:47:23] [config] after-batches: 0
[2023-07-17 13:47:23] [config] after-epochs: 40
[2023-07-17 13:47:23] [config] all-caps-every: 0
[2023-07-17 13:47:23] [config] allow-unk: false
[2023-07-17 13:47:23] [config] authors: false
[2023-07-17 13:47:23] [config] beam-size: 12
[2023-07-17 13:47:23] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:23] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:23] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:23] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:23] [config] build-info: ""
[2023-07-17 13:47:23] [config] check-gradient-nan: false
[2023-07-17 13:47:23] [config] check-nan: false
[2023-07-17 13:47:23] [config] cite: false
[2023-07-17 13:47:23] [config] clip-norm: 1
[2023-07-17 13:47:23] [config] cost-scaling:
[2023-07-17 13:47:23] [config]   - 256.f
[2023-07-17 13:47:23] [config]   - 1000
[2023-07-17 13:47:23] [config]   - 2.f
[2023-07-17 13:47:23] [config]   - 256.f
[2023-07-17 13:47:23] [config] cost-type: ce-sum
[2023-07-17 13:47:23] [config] cpu-threads: 0
[2023-07-17 13:47:23] [config] data-threads: 8
[2023-07-17 13:47:23] [config] data-weighting: ""
[2023-07-17 13:47:23] [config] data-weighting-type: sentence
[2023-07-17 13:47:23] [config] dec-cell: gru
[2023-07-17 13:47:23] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:23] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:23] [config] dec-depth: 2
[2023-07-17 13:47:23] [config] devices:
[2023-07-17 13:47:23] [config]   - 0
[2023-07-17 13:47:23] [config] dim-emb: 512
[2023-07-17 13:47:23] [config] dim-rnn: 1024
[2023-07-17 13:47:23] [config] dim-vocabs:
[2023-07-17 13:47:23] [config]   - 16384
[2023-07-17 13:47:23] [config]   - 16384
[2023-07-17 13:47:23] [config] disp-first: 0
[2023-07-17 13:47:23] [config] disp-freq: 1000u
[2023-07-17 13:47:23] [config] disp-label-counts: true
[2023-07-17 13:47:23] [config] dropout-rnn: 0
[2023-07-17 13:47:23] [config] dropout-src: 0
[2023-07-17 13:47:23] [config] dropout-trg: 0
[2023-07-17 13:47:23] [config] dump-config: ""
[2023-07-17 13:47:23] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] early-stopping: 5
[2023-07-17 13:47:23] [config] early-stopping-on: first
[2023-07-17 13:47:23] [config] embedding-fix-src: false
[2023-07-17 13:47:23] [config] embedding-fix-trg: false
[2023-07-17 13:47:23] [config] embedding-normalization: false
[2023-07-17 13:47:23] [config] embedding-vectors:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] enc-cell: gru
[2023-07-17 13:47:23] [config] enc-cell-depth: 1
[2023-07-17 13:47:23] [config] enc-depth: 1
[2023-07-17 13:47:23] [config] enc-type: bidirectional
[2023-07-17 13:47:23] [config] english-title-case-every: 0
[2023-07-17 13:47:23] [config] exponential-smoothing: 0
[2023-07-17 13:47:23] [config] factor-weight: 1
[2023-07-17 13:47:23] [config] factors-combine: sum
[2023-07-17 13:47:23] [config] factors-dim-emb: 0
[2023-07-17 13:47:23] [config] gradient-checkpointing: false
[2023-07-17 13:47:23] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:23] [config] guided-alignment: none
[2023-07-17 13:47:23] [config] guided-alignment-cost: mse
[2023-07-17 13:47:23] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:23] [config] ignore-model-config: false
[2023-07-17 13:47:23] [config] input-types:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] interpolate-env-vars: false
[2023-07-17 13:47:23] [config] keep-best: false
[2023-07-17 13:47:23] [config] label-smoothing: 0
[2023-07-17 13:47:23] [config] layer-normalization: false
[2023-07-17 13:47:23] [config] learn-rate: 0.0001
[2023-07-17 13:47:23] [config] lemma-dependency: ""
[2023-07-17 13:47:23] [config] lemma-dim-emb: 0
[2023-07-17 13:47:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:23] [config] log-level: info
[2023-07-17 13:47:23] [config] log-time-zone: ""
[2023-07-17 13:47:23] [config] logical-epoch:
[2023-07-17 13:47:23] [config]   - 1e
[2023-07-17 13:47:23] [config]   - 0
[2023-07-17 13:47:23] [config] lr-decay: 0
[2023-07-17 13:47:23] [config] lr-decay-freq: 50000
[2023-07-17 13:47:23] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:23] [config]   - 0
[2023-07-17 13:47:23] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:23] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:23] [config] lr-decay-start:
[2023-07-17 13:47:23] [config]   - 10
[2023-07-17 13:47:23] [config]   - 1
[2023-07-17 13:47:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:23] [config] lr-report: false
[2023-07-17 13:47:23] [config] lr-warmup: 0
[2023-07-17 13:47:23] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:23] [config] lr-warmup-cycle: false
[2023-07-17 13:47:23] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:23] [config] max-length: 50
[2023-07-17 13:47:23] [config] max-length-crop: true
[2023-07-17 13:47:23] [config] max-length-factor: 3
[2023-07-17 13:47:23] [config] maxi-batch: 100
[2023-07-17 13:47:23] [config] maxi-batch-sort: trg
[2023-07-17 13:47:23] [config] mini-batch: 64
[2023-07-17 13:47:23] [config] mini-batch-fit: true
[2023-07-17 13:47:23] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:23] [config] mini-batch-round-up: true
[2023-07-17 13:47:23] [config] mini-batch-track-lr: false
[2023-07-17 13:47:23] [config] mini-batch-warmup: 0
[2023-07-17 13:47:23] [config] mini-batch-words: 0
[2023-07-17 13:47:23] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:23] [config] multi-loss-type: sum
[2023-07-17 13:47:23] [config] n-best: false
[2023-07-17 13:47:23] [config] no-nccl: false
[2023-07-17 13:47:23] [config] no-reload: false
[2023-07-17 13:47:23] [config] no-restore-corpus: false
[2023-07-17 13:47:23] [config] normalize: 0
[2023-07-17 13:47:23] [config] normalize-gradient: false
[2023-07-17 13:47:23] [config] num-devices: 0
[2023-07-17 13:47:23] [config] optimizer: adam
[2023-07-17 13:47:23] [config] optimizer-delay: 1
[2023-07-17 13:47:23] [config] optimizer-params:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] output-omit-bias: false
[2023-07-17 13:47:23] [config] overwrite: true
[2023-07-17 13:47:23] [config] precision:
[2023-07-17 13:47:23] [config]   - float16
[2023-07-17 13:47:23] [config]   - float32
[2023-07-17 13:47:23] [config] pretrained-model: ""
[2023-07-17 13:47:23] [config] quantize-biases: false
[2023-07-17 13:47:23] [config] quantize-bits: 0
[2023-07-17 13:47:23] [config] quantize-log-based: false
[2023-07-17 13:47:23] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:23] [config] quiet: false
[2023-07-17 13:47:23] [config] quiet-translation: true
[2023-07-17 13:47:23] [config] relative-paths: false
[2023-07-17 13:47:23] [config] right-left: false
[2023-07-17 13:47:23] [config] save-freq: 10000u
[2023-07-17 13:47:23] [config] seed: 1234
[2023-07-17 13:47:23] [config] sentencepiece-alphas:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:23] [config] sentencepiece-options: ""
[2023-07-17 13:47:23] [config] sharding: global
[2023-07-17 13:47:23] [config] shuffle: data
[2023-07-17 13:47:23] [config] shuffle-in-ram: false
[2023-07-17 13:47:23] [config] sigterm: save-and-exit
[2023-07-17 13:47:23] [config] skip: false
[2023-07-17 13:47:23] [config] sqlite: ""
[2023-07-17 13:47:23] [config] sqlite-drop: false
[2023-07-17 13:47:23] [config] sync-freq: 200u
[2023-07-17 13:47:23] [config] sync-sgd: false
[2023-07-17 13:47:23] [config] tempdir: /tmp
[2023-07-17 13:47:23] [config] tied-embeddings: false
[2023-07-17 13:47:23] [config] tied-embeddings-all: true
[2023-07-17 13:47:23] [config] tied-embeddings-src: false
[2023-07-17 13:47:23] [config] train-embedder-rank:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] train-sets:
[2023-07-17 13:47:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:23] [config] transformer-aan-activation: swish
[2023-07-17 13:47:23] [config] transformer-aan-depth: 2
[2023-07-17 13:47:23] [config] transformer-aan-nogate: false
[2023-07-17 13:47:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:23] [config] transformer-depth-scaling: false
[2023-07-17 13:47:23] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:23] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:23] [config] transformer-dropout: 0
[2023-07-17 13:47:23] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:23] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:23] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:23] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:23] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:23] [config] transformer-heads: 8
[2023-07-17 13:47:23] [config] transformer-no-projection: false
[2023-07-17 13:47:23] [config] transformer-pool: false
[2023-07-17 13:47:23] [config] transformer-postprocess: dan
[2023-07-17 13:47:23] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:23] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:23] [config] transformer-preprocess: ""
[2023-07-17 13:47:23] [config] transformer-tied-layers:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:23] [config] tsv: false
[2023-07-17 13:47:23] [config] tsv-fields: 0
[2023-07-17 13:47:23] [config] type: amun
[2023-07-17 13:47:23] [config] ulr: false
[2023-07-17 13:47:23] [config] ulr-dim-emb: 0
[2023-07-17 13:47:23] [config] ulr-dropout: 0
[2023-07-17 13:47:23] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:23] [config] ulr-query-vectors: ""
[2023-07-17 13:47:23] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:23] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:23] [config] unlikelihood-loss: false
[2023-07-17 13:47:23] [config] valid-freq: 50000000
[2023-07-17 13:47:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:23] [config] valid-max-length: 1000
[2023-07-17 13:47:23] [config] valid-metrics:
[2023-07-17 13:47:23] [config]   - cross-entropy
[2023-07-17 13:47:23] [config]   - translation
[2023-07-17 13:47:23] [config] valid-mini-batch: 32
[2023-07-17 13:47:23] [config] valid-reset-stalled: false
[2023-07-17 13:47:23] [config] valid-script-args:
[2023-07-17 13:47:23] [config]   []
[2023-07-17 13:47:23] [config] valid-script-path: ""
[2023-07-17 13:47:23] [config] valid-sets:
[2023-07-17 13:47:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:23] [config] vocabs:
[2023-07-17 13:47:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:23] [config] word-penalty: 0
[2023-07-17 13:47:23] [config] word-scores: false
[2023-07-17 13:47:23] [config] workspace: 5500
[2023-07-17 13:47:23] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:23] [training] Using single-device training
[2023-07-17 13:47:24] Synced seed 1234
[2023-07-17 13:47:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:24] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:25] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:25] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x55d33ce28b5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x55d33cd6ada8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55d33cd6f1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55d33cd762ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55d33cf22a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55d33cf23a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55d33cefcbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55d33c9fe108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55d33c9202c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55d33c8d7b9c]    main                                               + 0x3c
[0x7f73bb79c0b3]    __libc_start_main                                  + 0xf3
[0x55d33c91ecbe]    _start                                             + 0x2e

[2023-07-17 13:47:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:26] [marian] Running on node22.datos.cluster.uy as process 7138 with command line:
[2023-07-17 13:47:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:26] [config] after: 0e
[2023-07-17 13:47:26] [config] after-batches: 0
[2023-07-17 13:47:26] [config] after-epochs: 50
[2023-07-17 13:47:26] [config] all-caps-every: 0
[2023-07-17 13:47:26] [config] allow-unk: false
[2023-07-17 13:47:26] [config] authors: false
[2023-07-17 13:47:26] [config] beam-size: 12
[2023-07-17 13:47:26] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:26] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:26] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:26] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:26] [config] build-info: ""
[2023-07-17 13:47:26] [config] check-gradient-nan: false
[2023-07-17 13:47:26] [config] check-nan: false
[2023-07-17 13:47:26] [config] cite: false
[2023-07-17 13:47:26] [config] clip-norm: 1
[2023-07-17 13:47:26] [config] cost-scaling:
[2023-07-17 13:47:26] [config]   - 256.f
[2023-07-17 13:47:26] [config]   - 1000
[2023-07-17 13:47:26] [config]   - 2.f
[2023-07-17 13:47:26] [config]   - 256.f
[2023-07-17 13:47:26] [config] cost-type: ce-sum
[2023-07-17 13:47:26] [config] cpu-threads: 0
[2023-07-17 13:47:26] [config] data-threads: 8
[2023-07-17 13:47:26] [config] data-weighting: ""
[2023-07-17 13:47:26] [config] data-weighting-type: sentence
[2023-07-17 13:47:26] [config] dec-cell: gru
[2023-07-17 13:47:26] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:26] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:26] [config] dec-depth: 2
[2023-07-17 13:47:26] [config] devices:
[2023-07-17 13:47:26] [config]   - 0
[2023-07-17 13:47:26] [config] dim-emb: 512
[2023-07-17 13:47:26] [config] dim-rnn: 1024
[2023-07-17 13:47:26] [config] dim-vocabs:
[2023-07-17 13:47:26] [config]   - 16384
[2023-07-17 13:47:26] [config]   - 16384
[2023-07-17 13:47:26] [config] disp-first: 0
[2023-07-17 13:47:26] [config] disp-freq: 1000u
[2023-07-17 13:47:26] [config] disp-label-counts: true
[2023-07-17 13:47:26] [config] dropout-rnn: 0
[2023-07-17 13:47:26] [config] dropout-src: 0
[2023-07-17 13:47:26] [config] dropout-trg: 0
[2023-07-17 13:47:26] [config] dump-config: ""
[2023-07-17 13:47:26] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] early-stopping: 5
[2023-07-17 13:47:26] [config] early-stopping-on: first
[2023-07-17 13:47:26] [config] embedding-fix-src: false
[2023-07-17 13:47:26] [config] embedding-fix-trg: false
[2023-07-17 13:47:26] [config] embedding-normalization: false
[2023-07-17 13:47:26] [config] embedding-vectors:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] enc-cell: gru
[2023-07-17 13:47:26] [config] enc-cell-depth: 1
[2023-07-17 13:47:26] [config] enc-depth: 1
[2023-07-17 13:47:26] [config] enc-type: bidirectional
[2023-07-17 13:47:26] [config] english-title-case-every: 0
[2023-07-17 13:47:26] [config] exponential-smoothing: 0
[2023-07-17 13:47:26] [config] factor-weight: 1
[2023-07-17 13:47:26] [config] factors-combine: sum
[2023-07-17 13:47:26] [config] factors-dim-emb: 0
[2023-07-17 13:47:26] [config] gradient-checkpointing: false
[2023-07-17 13:47:26] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:26] [config] guided-alignment: none
[2023-07-17 13:47:26] [config] guided-alignment-cost: mse
[2023-07-17 13:47:26] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:26] [config] ignore-model-config: false
[2023-07-17 13:47:26] [config] input-types:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] interpolate-env-vars: false
[2023-07-17 13:47:26] [config] keep-best: false
[2023-07-17 13:47:26] [config] label-smoothing: 0
[2023-07-17 13:47:26] [config] layer-normalization: false
[2023-07-17 13:47:26] [config] learn-rate: 0.0001
[2023-07-17 13:47:26] [config] lemma-dependency: ""
[2023-07-17 13:47:26] [config] lemma-dim-emb: 0
[2023-07-17 13:47:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:26] [config] log-level: info
[2023-07-17 13:47:26] [config] log-time-zone: ""
[2023-07-17 13:47:26] [config] logical-epoch:
[2023-07-17 13:47:26] [config]   - 1e
[2023-07-17 13:47:26] [config]   - 0
[2023-07-17 13:47:26] [config] lr-decay: 0
[2023-07-17 13:47:26] [config] lr-decay-freq: 50000
[2023-07-17 13:47:26] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:26] [config]   - 0
[2023-07-17 13:47:26] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:26] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:26] [config] lr-decay-start:
[2023-07-17 13:47:26] [config]   - 10
[2023-07-17 13:47:26] [config]   - 1
[2023-07-17 13:47:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:26] [config] lr-report: false
[2023-07-17 13:47:26] [config] lr-warmup: 0
[2023-07-17 13:47:26] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:26] [config] lr-warmup-cycle: false
[2023-07-17 13:47:26] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:26] [config] max-length: 50
[2023-07-17 13:47:26] [config] max-length-crop: true
[2023-07-17 13:47:26] [config] max-length-factor: 3
[2023-07-17 13:47:26] [config] maxi-batch: 100
[2023-07-17 13:47:26] [config] maxi-batch-sort: trg
[2023-07-17 13:47:26] [config] mini-batch: 64
[2023-07-17 13:47:26] [config] mini-batch-fit: true
[2023-07-17 13:47:26] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:26] [config] mini-batch-round-up: true
[2023-07-17 13:47:26] [config] mini-batch-track-lr: false
[2023-07-17 13:47:26] [config] mini-batch-warmup: 0
[2023-07-17 13:47:26] [config] mini-batch-words: 0
[2023-07-17 13:47:26] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:26] [config] multi-loss-type: sum
[2023-07-17 13:47:26] [config] n-best: false
[2023-07-17 13:47:26] [config] no-nccl: false
[2023-07-17 13:47:26] [config] no-reload: false
[2023-07-17 13:47:26] [config] no-restore-corpus: false
[2023-07-17 13:47:26] [config] normalize: 0
[2023-07-17 13:47:26] [config] normalize-gradient: false
[2023-07-17 13:47:26] [config] num-devices: 0
[2023-07-17 13:47:26] [config] optimizer: adam
[2023-07-17 13:47:26] [config] optimizer-delay: 1
[2023-07-17 13:47:26] [config] optimizer-params:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] output-omit-bias: false
[2023-07-17 13:47:26] [config] overwrite: true
[2023-07-17 13:47:26] [config] precision:
[2023-07-17 13:47:26] [config]   - float16
[2023-07-17 13:47:26] [config]   - float32
[2023-07-17 13:47:26] [config] pretrained-model: ""
[2023-07-17 13:47:26] [config] quantize-biases: false
[2023-07-17 13:47:26] [config] quantize-bits: 0
[2023-07-17 13:47:26] [config] quantize-log-based: false
[2023-07-17 13:47:26] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:26] [config] quiet: false
[2023-07-17 13:47:26] [config] quiet-translation: true
[2023-07-17 13:47:26] [config] relative-paths: false
[2023-07-17 13:47:26] [config] right-left: false
[2023-07-17 13:47:26] [config] save-freq: 10000u
[2023-07-17 13:47:26] [config] seed: 1234
[2023-07-17 13:47:26] [config] sentencepiece-alphas:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:26] [config] sentencepiece-options: ""
[2023-07-17 13:47:26] [config] sharding: global
[2023-07-17 13:47:26] [config] shuffle: data
[2023-07-17 13:47:26] [config] shuffle-in-ram: false
[2023-07-17 13:47:26] [config] sigterm: save-and-exit
[2023-07-17 13:47:26] [config] skip: false
[2023-07-17 13:47:26] [config] sqlite: ""
[2023-07-17 13:47:26] [config] sqlite-drop: false
[2023-07-17 13:47:26] [config] sync-freq: 200u
[2023-07-17 13:47:26] [config] sync-sgd: false
[2023-07-17 13:47:26] [config] tempdir: /tmp
[2023-07-17 13:47:26] [config] tied-embeddings: false
[2023-07-17 13:47:26] [config] tied-embeddings-all: true
[2023-07-17 13:47:26] [config] tied-embeddings-src: false
[2023-07-17 13:47:26] [config] train-embedder-rank:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] train-sets:
[2023-07-17 13:47:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:26] [config] transformer-aan-activation: swish
[2023-07-17 13:47:26] [config] transformer-aan-depth: 2
[2023-07-17 13:47:26] [config] transformer-aan-nogate: false
[2023-07-17 13:47:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:26] [config] transformer-depth-scaling: false
[2023-07-17 13:47:26] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:26] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:26] [config] transformer-dropout: 0
[2023-07-17 13:47:26] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:26] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:26] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:26] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:26] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:26] [config] transformer-heads: 8
[2023-07-17 13:47:26] [config] transformer-no-projection: false
[2023-07-17 13:47:26] [config] transformer-pool: false
[2023-07-17 13:47:26] [config] transformer-postprocess: dan
[2023-07-17 13:47:26] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:26] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:26] [config] transformer-preprocess: ""
[2023-07-17 13:47:26] [config] transformer-tied-layers:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:26] [config] tsv: false
[2023-07-17 13:47:26] [config] tsv-fields: 0
[2023-07-17 13:47:26] [config] type: amun
[2023-07-17 13:47:26] [config] ulr: false
[2023-07-17 13:47:26] [config] ulr-dim-emb: 0
[2023-07-17 13:47:26] [config] ulr-dropout: 0
[2023-07-17 13:47:26] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:26] [config] ulr-query-vectors: ""
[2023-07-17 13:47:26] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:26] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:26] [config] unlikelihood-loss: false
[2023-07-17 13:47:26] [config] valid-freq: 50000000
[2023-07-17 13:47:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:26] [config] valid-max-length: 1000
[2023-07-17 13:47:26] [config] valid-metrics:
[2023-07-17 13:47:26] [config]   - cross-entropy
[2023-07-17 13:47:26] [config]   - translation
[2023-07-17 13:47:26] [config] valid-mini-batch: 32
[2023-07-17 13:47:26] [config] valid-reset-stalled: false
[2023-07-17 13:47:26] [config] valid-script-args:
[2023-07-17 13:47:26] [config]   []
[2023-07-17 13:47:26] [config] valid-script-path: ""
[2023-07-17 13:47:26] [config] valid-sets:
[2023-07-17 13:47:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:26] [config] vocabs:
[2023-07-17 13:47:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:26] [config] word-penalty: 0
[2023-07-17 13:47:26] [config] word-scores: false
[2023-07-17 13:47:26] [config] workspace: 5500
[2023-07-17 13:47:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:26] [training] Using single-device training
[2023-07-17 13:47:26] Synced seed 1234
[2023-07-17 13:47:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:26] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:26] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:28] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:28] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x55e8be813b5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x55e8be755da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55e8be75a1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55e8be7612ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55e8be90da0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55e8be90ea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55e8be8e7bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55e8be3e9108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55e8be30b2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55e8be2c2b9c]    main                                               + 0x3c
[0x7f70ed67f0b3]    __libc_start_main                                  + 0xf3
[0x55e8be309cbe]    _start                                             + 0x2e

[2023-07-17 13:47:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:29] [marian] Running on node22.datos.cluster.uy as process 7163 with command line:
[2023-07-17 13:47:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:29] [config] after: 0e
[2023-07-17 13:47:29] [config] after-batches: 0
[2023-07-17 13:47:29] [config] after-epochs: 60
[2023-07-17 13:47:29] [config] all-caps-every: 0
[2023-07-17 13:47:29] [config] allow-unk: false
[2023-07-17 13:47:29] [config] authors: false
[2023-07-17 13:47:29] [config] beam-size: 12
[2023-07-17 13:47:29] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:29] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:29] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:29] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:29] [config] build-info: ""
[2023-07-17 13:47:29] [config] check-gradient-nan: false
[2023-07-17 13:47:29] [config] check-nan: false
[2023-07-17 13:47:29] [config] cite: false
[2023-07-17 13:47:29] [config] clip-norm: 1
[2023-07-17 13:47:29] [config] cost-scaling:
[2023-07-17 13:47:29] [config]   - 256.f
[2023-07-17 13:47:29] [config]   - 1000
[2023-07-17 13:47:29] [config]   - 2.f
[2023-07-17 13:47:29] [config]   - 256.f
[2023-07-17 13:47:29] [config] cost-type: ce-sum
[2023-07-17 13:47:29] [config] cpu-threads: 0
[2023-07-17 13:47:29] [config] data-threads: 8
[2023-07-17 13:47:29] [config] data-weighting: ""
[2023-07-17 13:47:29] [config] data-weighting-type: sentence
[2023-07-17 13:47:29] [config] dec-cell: gru
[2023-07-17 13:47:29] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:29] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:29] [config] dec-depth: 2
[2023-07-17 13:47:29] [config] devices:
[2023-07-17 13:47:29] [config]   - 0
[2023-07-17 13:47:29] [config] dim-emb: 512
[2023-07-17 13:47:29] [config] dim-rnn: 1024
[2023-07-17 13:47:29] [config] dim-vocabs:
[2023-07-17 13:47:29] [config]   - 16384
[2023-07-17 13:47:29] [config]   - 16384
[2023-07-17 13:47:29] [config] disp-first: 0
[2023-07-17 13:47:29] [config] disp-freq: 1000u
[2023-07-17 13:47:29] [config] disp-label-counts: true
[2023-07-17 13:47:29] [config] dropout-rnn: 0
[2023-07-17 13:47:29] [config] dropout-src: 0
[2023-07-17 13:47:29] [config] dropout-trg: 0
[2023-07-17 13:47:29] [config] dump-config: ""
[2023-07-17 13:47:29] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] early-stopping: 5
[2023-07-17 13:47:29] [config] early-stopping-on: first
[2023-07-17 13:47:29] [config] embedding-fix-src: false
[2023-07-17 13:47:29] [config] embedding-fix-trg: false
[2023-07-17 13:47:29] [config] embedding-normalization: false
[2023-07-17 13:47:29] [config] embedding-vectors:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] enc-cell: gru
[2023-07-17 13:47:29] [config] enc-cell-depth: 1
[2023-07-17 13:47:29] [config] enc-depth: 1
[2023-07-17 13:47:29] [config] enc-type: bidirectional
[2023-07-17 13:47:29] [config] english-title-case-every: 0
[2023-07-17 13:47:29] [config] exponential-smoothing: 0
[2023-07-17 13:47:29] [config] factor-weight: 1
[2023-07-17 13:47:29] [config] factors-combine: sum
[2023-07-17 13:47:29] [config] factors-dim-emb: 0
[2023-07-17 13:47:29] [config] gradient-checkpointing: false
[2023-07-17 13:47:29] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:29] [config] guided-alignment: none
[2023-07-17 13:47:29] [config] guided-alignment-cost: mse
[2023-07-17 13:47:29] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:29] [config] ignore-model-config: false
[2023-07-17 13:47:29] [config] input-types:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] interpolate-env-vars: false
[2023-07-17 13:47:29] [config] keep-best: false
[2023-07-17 13:47:29] [config] label-smoothing: 0
[2023-07-17 13:47:29] [config] layer-normalization: false
[2023-07-17 13:47:29] [config] learn-rate: 0.0001
[2023-07-17 13:47:29] [config] lemma-dependency: ""
[2023-07-17 13:47:29] [config] lemma-dim-emb: 0
[2023-07-17 13:47:29] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:29] [config] log-level: info
[2023-07-17 13:47:29] [config] log-time-zone: ""
[2023-07-17 13:47:29] [config] logical-epoch:
[2023-07-17 13:47:29] [config]   - 1e
[2023-07-17 13:47:29] [config]   - 0
[2023-07-17 13:47:29] [config] lr-decay: 0
[2023-07-17 13:47:29] [config] lr-decay-freq: 50000
[2023-07-17 13:47:29] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:29] [config]   - 0
[2023-07-17 13:47:29] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:29] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:29] [config] lr-decay-start:
[2023-07-17 13:47:29] [config]   - 10
[2023-07-17 13:47:29] [config]   - 1
[2023-07-17 13:47:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:29] [config] lr-report: false
[2023-07-17 13:47:29] [config] lr-warmup: 0
[2023-07-17 13:47:29] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:29] [config] lr-warmup-cycle: false
[2023-07-17 13:47:29] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:29] [config] max-length: 50
[2023-07-17 13:47:29] [config] max-length-crop: true
[2023-07-17 13:47:29] [config] max-length-factor: 3
[2023-07-17 13:47:29] [config] maxi-batch: 100
[2023-07-17 13:47:29] [config] maxi-batch-sort: trg
[2023-07-17 13:47:29] [config] mini-batch: 64
[2023-07-17 13:47:29] [config] mini-batch-fit: true
[2023-07-17 13:47:29] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:29] [config] mini-batch-round-up: true
[2023-07-17 13:47:29] [config] mini-batch-track-lr: false
[2023-07-17 13:47:29] [config] mini-batch-warmup: 0
[2023-07-17 13:47:29] [config] mini-batch-words: 0
[2023-07-17 13:47:29] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:29] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:29] [config] multi-loss-type: sum
[2023-07-17 13:47:29] [config] n-best: false
[2023-07-17 13:47:29] [config] no-nccl: false
[2023-07-17 13:47:29] [config] no-reload: false
[2023-07-17 13:47:29] [config] no-restore-corpus: false
[2023-07-17 13:47:29] [config] normalize: 0
[2023-07-17 13:47:29] [config] normalize-gradient: false
[2023-07-17 13:47:29] [config] num-devices: 0
[2023-07-17 13:47:29] [config] optimizer: adam
[2023-07-17 13:47:29] [config] optimizer-delay: 1
[2023-07-17 13:47:29] [config] optimizer-params:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] output-omit-bias: false
[2023-07-17 13:47:29] [config] overwrite: true
[2023-07-17 13:47:29] [config] precision:
[2023-07-17 13:47:29] [config]   - float16
[2023-07-17 13:47:29] [config]   - float32
[2023-07-17 13:47:29] [config] pretrained-model: ""
[2023-07-17 13:47:29] [config] quantize-biases: false
[2023-07-17 13:47:29] [config] quantize-bits: 0
[2023-07-17 13:47:29] [config] quantize-log-based: false
[2023-07-17 13:47:29] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:29] [config] quiet: false
[2023-07-17 13:47:29] [config] quiet-translation: true
[2023-07-17 13:47:29] [config] relative-paths: false
[2023-07-17 13:47:29] [config] right-left: false
[2023-07-17 13:47:29] [config] save-freq: 10000u
[2023-07-17 13:47:29] [config] seed: 1234
[2023-07-17 13:47:29] [config] sentencepiece-alphas:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:29] [config] sentencepiece-options: ""
[2023-07-17 13:47:29] [config] sharding: global
[2023-07-17 13:47:29] [config] shuffle: data
[2023-07-17 13:47:29] [config] shuffle-in-ram: false
[2023-07-17 13:47:29] [config] sigterm: save-and-exit
[2023-07-17 13:47:29] [config] skip: false
[2023-07-17 13:47:29] [config] sqlite: ""
[2023-07-17 13:47:29] [config] sqlite-drop: false
[2023-07-17 13:47:29] [config] sync-freq: 200u
[2023-07-17 13:47:29] [config] sync-sgd: false
[2023-07-17 13:47:29] [config] tempdir: /tmp
[2023-07-17 13:47:29] [config] tied-embeddings: false
[2023-07-17 13:47:29] [config] tied-embeddings-all: true
[2023-07-17 13:47:29] [config] tied-embeddings-src: false
[2023-07-17 13:47:29] [config] train-embedder-rank:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] train-sets:
[2023-07-17 13:47:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:29] [config] transformer-aan-activation: swish
[2023-07-17 13:47:29] [config] transformer-aan-depth: 2
[2023-07-17 13:47:29] [config] transformer-aan-nogate: false
[2023-07-17 13:47:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:29] [config] transformer-depth-scaling: false
[2023-07-17 13:47:29] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:29] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:29] [config] transformer-dropout: 0
[2023-07-17 13:47:29] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:29] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:29] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:29] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:29] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:29] [config] transformer-heads: 8
[2023-07-17 13:47:29] [config] transformer-no-projection: false
[2023-07-17 13:47:29] [config] transformer-pool: false
[2023-07-17 13:47:29] [config] transformer-postprocess: dan
[2023-07-17 13:47:29] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:29] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:29] [config] transformer-preprocess: ""
[2023-07-17 13:47:29] [config] transformer-tied-layers:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:29] [config] tsv: false
[2023-07-17 13:47:29] [config] tsv-fields: 0
[2023-07-17 13:47:29] [config] type: amun
[2023-07-17 13:47:29] [config] ulr: false
[2023-07-17 13:47:29] [config] ulr-dim-emb: 0
[2023-07-17 13:47:29] [config] ulr-dropout: 0
[2023-07-17 13:47:29] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:29] [config] ulr-query-vectors: ""
[2023-07-17 13:47:29] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:29] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:29] [config] unlikelihood-loss: false
[2023-07-17 13:47:29] [config] valid-freq: 50000000
[2023-07-17 13:47:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:29] [config] valid-max-length: 1000
[2023-07-17 13:47:29] [config] valid-metrics:
[2023-07-17 13:47:29] [config]   - cross-entropy
[2023-07-17 13:47:29] [config]   - translation
[2023-07-17 13:47:29] [config] valid-mini-batch: 32
[2023-07-17 13:47:29] [config] valid-reset-stalled: false
[2023-07-17 13:47:29] [config] valid-script-args:
[2023-07-17 13:47:29] [config]   []
[2023-07-17 13:47:29] [config] valid-script-path: ""
[2023-07-17 13:47:29] [config] valid-sets:
[2023-07-17 13:47:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:29] [config] vocabs:
[2023-07-17 13:47:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:29] [config] word-penalty: 0
[2023-07-17 13:47:29] [config] word-scores: false
[2023-07-17 13:47:29] [config] workspace: 5500
[2023-07-17 13:47:29] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:29] [training] Using single-device training
[2023-07-17 13:47:29] Synced seed 1234
[2023-07-17 13:47:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:29] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:30] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:30] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x55dc932edb5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x55dc9322fda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55dc932341a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55dc9323b2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55dc933e7a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55dc933e8a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55dc933c1bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55dc92ec3108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55dc92de52c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55dc92d9cb9c]    main                                               + 0x3c
[0x7fec6945a0b3]    __libc_start_main                                  + 0xf3
[0x55dc92de3cbe]    _start                                             + 0x2e

[2023-07-17 13:47:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:31] [marian] Running on node22.datos.cluster.uy as process 7189 with command line:
[2023-07-17 13:47:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:31] [config] after: 0e
[2023-07-17 13:47:31] [config] after-batches: 0
[2023-07-17 13:47:31] [config] after-epochs: 70
[2023-07-17 13:47:31] [config] all-caps-every: 0
[2023-07-17 13:47:31] [config] allow-unk: false
[2023-07-17 13:47:31] [config] authors: false
[2023-07-17 13:47:31] [config] beam-size: 12
[2023-07-17 13:47:31] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:31] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:31] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:31] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:31] [config] build-info: ""
[2023-07-17 13:47:31] [config] check-gradient-nan: false
[2023-07-17 13:47:31] [config] check-nan: false
[2023-07-17 13:47:31] [config] cite: false
[2023-07-17 13:47:31] [config] clip-norm: 1
[2023-07-17 13:47:31] [config] cost-scaling:
[2023-07-17 13:47:31] [config]   - 256.f
[2023-07-17 13:47:31] [config]   - 1000
[2023-07-17 13:47:31] [config]   - 2.f
[2023-07-17 13:47:31] [config]   - 256.f
[2023-07-17 13:47:31] [config] cost-type: ce-sum
[2023-07-17 13:47:31] [config] cpu-threads: 0
[2023-07-17 13:47:31] [config] data-threads: 8
[2023-07-17 13:47:31] [config] data-weighting: ""
[2023-07-17 13:47:31] [config] data-weighting-type: sentence
[2023-07-17 13:47:31] [config] dec-cell: gru
[2023-07-17 13:47:31] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:31] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:31] [config] dec-depth: 2
[2023-07-17 13:47:31] [config] devices:
[2023-07-17 13:47:31] [config]   - 0
[2023-07-17 13:47:31] [config] dim-emb: 512
[2023-07-17 13:47:31] [config] dim-rnn: 1024
[2023-07-17 13:47:31] [config] dim-vocabs:
[2023-07-17 13:47:31] [config]   - 16384
[2023-07-17 13:47:31] [config]   - 16384
[2023-07-17 13:47:31] [config] disp-first: 0
[2023-07-17 13:47:31] [config] disp-freq: 1000u
[2023-07-17 13:47:31] [config] disp-label-counts: true
[2023-07-17 13:47:31] [config] dropout-rnn: 0
[2023-07-17 13:47:31] [config] dropout-src: 0
[2023-07-17 13:47:31] [config] dropout-trg: 0
[2023-07-17 13:47:31] [config] dump-config: ""
[2023-07-17 13:47:31] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] early-stopping: 5
[2023-07-17 13:47:31] [config] early-stopping-on: first
[2023-07-17 13:47:31] [config] embedding-fix-src: false
[2023-07-17 13:47:31] [config] embedding-fix-trg: false
[2023-07-17 13:47:31] [config] embedding-normalization: false
[2023-07-17 13:47:31] [config] embedding-vectors:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] enc-cell: gru
[2023-07-17 13:47:31] [config] enc-cell-depth: 1
[2023-07-17 13:47:31] [config] enc-depth: 1
[2023-07-17 13:47:31] [config] enc-type: bidirectional
[2023-07-17 13:47:31] [config] english-title-case-every: 0
[2023-07-17 13:47:31] [config] exponential-smoothing: 0
[2023-07-17 13:47:31] [config] factor-weight: 1
[2023-07-17 13:47:31] [config] factors-combine: sum
[2023-07-17 13:47:31] [config] factors-dim-emb: 0
[2023-07-17 13:47:31] [config] gradient-checkpointing: false
[2023-07-17 13:47:31] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:31] [config] guided-alignment: none
[2023-07-17 13:47:31] [config] guided-alignment-cost: mse
[2023-07-17 13:47:31] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:31] [config] ignore-model-config: false
[2023-07-17 13:47:31] [config] input-types:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] interpolate-env-vars: false
[2023-07-17 13:47:31] [config] keep-best: false
[2023-07-17 13:47:31] [config] label-smoothing: 0
[2023-07-17 13:47:31] [config] layer-normalization: false
[2023-07-17 13:47:31] [config] learn-rate: 0.0001
[2023-07-17 13:47:31] [config] lemma-dependency: ""
[2023-07-17 13:47:31] [config] lemma-dim-emb: 0
[2023-07-17 13:47:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:31] [config] log-level: info
[2023-07-17 13:47:31] [config] log-time-zone: ""
[2023-07-17 13:47:31] [config] logical-epoch:
[2023-07-17 13:47:31] [config]   - 1e
[2023-07-17 13:47:31] [config]   - 0
[2023-07-17 13:47:31] [config] lr-decay: 0
[2023-07-17 13:47:31] [config] lr-decay-freq: 50000
[2023-07-17 13:47:31] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:31] [config]   - 0
[2023-07-17 13:47:31] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:31] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:31] [config] lr-decay-start:
[2023-07-17 13:47:31] [config]   - 10
[2023-07-17 13:47:31] [config]   - 1
[2023-07-17 13:47:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:31] [config] lr-report: false
[2023-07-17 13:47:31] [config] lr-warmup: 0
[2023-07-17 13:47:31] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:31] [config] lr-warmup-cycle: false
[2023-07-17 13:47:31] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:31] [config] max-length: 50
[2023-07-17 13:47:31] [config] max-length-crop: true
[2023-07-17 13:47:31] [config] max-length-factor: 3
[2023-07-17 13:47:31] [config] maxi-batch: 100
[2023-07-17 13:47:31] [config] maxi-batch-sort: trg
[2023-07-17 13:47:31] [config] mini-batch: 64
[2023-07-17 13:47:31] [config] mini-batch-fit: true
[2023-07-17 13:47:31] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:31] [config] mini-batch-round-up: true
[2023-07-17 13:47:31] [config] mini-batch-track-lr: false
[2023-07-17 13:47:31] [config] mini-batch-warmup: 0
[2023-07-17 13:47:31] [config] mini-batch-words: 0
[2023-07-17 13:47:31] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:31] [config] multi-loss-type: sum
[2023-07-17 13:47:31] [config] n-best: false
[2023-07-17 13:47:31] [config] no-nccl: false
[2023-07-17 13:47:31] [config] no-reload: false
[2023-07-17 13:47:31] [config] no-restore-corpus: false
[2023-07-17 13:47:31] [config] normalize: 0
[2023-07-17 13:47:31] [config] normalize-gradient: false
[2023-07-17 13:47:31] [config] num-devices: 0
[2023-07-17 13:47:31] [config] optimizer: adam
[2023-07-17 13:47:31] [config] optimizer-delay: 1
[2023-07-17 13:47:31] [config] optimizer-params:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] output-omit-bias: false
[2023-07-17 13:47:31] [config] overwrite: true
[2023-07-17 13:47:31] [config] precision:
[2023-07-17 13:47:31] [config]   - float16
[2023-07-17 13:47:31] [config]   - float32
[2023-07-17 13:47:31] [config] pretrained-model: ""
[2023-07-17 13:47:31] [config] quantize-biases: false
[2023-07-17 13:47:31] [config] quantize-bits: 0
[2023-07-17 13:47:31] [config] quantize-log-based: false
[2023-07-17 13:47:31] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:31] [config] quiet: false
[2023-07-17 13:47:31] [config] quiet-translation: true
[2023-07-17 13:47:31] [config] relative-paths: false
[2023-07-17 13:47:31] [config] right-left: false
[2023-07-17 13:47:31] [config] save-freq: 10000u
[2023-07-17 13:47:31] [config] seed: 1234
[2023-07-17 13:47:31] [config] sentencepiece-alphas:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:31] [config] sentencepiece-options: ""
[2023-07-17 13:47:31] [config] sharding: global
[2023-07-17 13:47:31] [config] shuffle: data
[2023-07-17 13:47:31] [config] shuffle-in-ram: false
[2023-07-17 13:47:31] [config] sigterm: save-and-exit
[2023-07-17 13:47:31] [config] skip: false
[2023-07-17 13:47:31] [config] sqlite: ""
[2023-07-17 13:47:31] [config] sqlite-drop: false
[2023-07-17 13:47:31] [config] sync-freq: 200u
[2023-07-17 13:47:31] [config] sync-sgd: false
[2023-07-17 13:47:31] [config] tempdir: /tmp
[2023-07-17 13:47:31] [config] tied-embeddings: false
[2023-07-17 13:47:31] [config] tied-embeddings-all: true
[2023-07-17 13:47:31] [config] tied-embeddings-src: false
[2023-07-17 13:47:31] [config] train-embedder-rank:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] train-sets:
[2023-07-17 13:47:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:31] [config] transformer-aan-activation: swish
[2023-07-17 13:47:31] [config] transformer-aan-depth: 2
[2023-07-17 13:47:31] [config] transformer-aan-nogate: false
[2023-07-17 13:47:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:31] [config] transformer-depth-scaling: false
[2023-07-17 13:47:31] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:31] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:31] [config] transformer-dropout: 0
[2023-07-17 13:47:31] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:31] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:31] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:31] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:31] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:31] [config] transformer-heads: 8
[2023-07-17 13:47:31] [config] transformer-no-projection: false
[2023-07-17 13:47:31] [config] transformer-pool: false
[2023-07-17 13:47:31] [config] transformer-postprocess: dan
[2023-07-17 13:47:31] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:31] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:31] [config] transformer-preprocess: ""
[2023-07-17 13:47:31] [config] transformer-tied-layers:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:31] [config] tsv: false
[2023-07-17 13:47:31] [config] tsv-fields: 0
[2023-07-17 13:47:31] [config] type: amun
[2023-07-17 13:47:31] [config] ulr: false
[2023-07-17 13:47:31] [config] ulr-dim-emb: 0
[2023-07-17 13:47:31] [config] ulr-dropout: 0
[2023-07-17 13:47:31] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:31] [config] ulr-query-vectors: ""
[2023-07-17 13:47:31] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:31] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:31] [config] unlikelihood-loss: false
[2023-07-17 13:47:31] [config] valid-freq: 50000000
[2023-07-17 13:47:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:31] [config] valid-max-length: 1000
[2023-07-17 13:47:31] [config] valid-metrics:
[2023-07-17 13:47:31] [config]   - cross-entropy
[2023-07-17 13:47:31] [config]   - translation
[2023-07-17 13:47:31] [config] valid-mini-batch: 32
[2023-07-17 13:47:31] [config] valid-reset-stalled: false
[2023-07-17 13:47:31] [config] valid-script-args:
[2023-07-17 13:47:31] [config]   []
[2023-07-17 13:47:31] [config] valid-script-path: ""
[2023-07-17 13:47:31] [config] valid-sets:
[2023-07-17 13:47:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:31] [config] vocabs:
[2023-07-17 13:47:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:31] [config] word-penalty: 0
[2023-07-17 13:47:31] [config] word-scores: false
[2023-07-17 13:47:31] [config] workspace: 5500
[2023-07-17 13:47:31] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:31] [training] Using single-device training
[2023-07-17 13:47:32] Synced seed 1234
[2023-07-17 13:47:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:32] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:32] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:32] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:32] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:33] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:33] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x5628aae78b5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x5628aadbada8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5628aadbf1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5628aadc62ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5628aaf72a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5628aaf73a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5628aaf4cbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5628aaa4e108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5628aa9702c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5628aa927b9c]    main                                               + 0x3c
[0x7fc1defdc0b3]    __libc_start_main                                  + 0xf3
[0x5628aa96ecbe]    _start                                             + 0x2e

[2023-07-17 13:47:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:34] [marian] Running on node22.datos.cluster.uy as process 7214 with command line:
[2023-07-17 13:47:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:34] [config] after: 0e
[2023-07-17 13:47:34] [config] after-batches: 0
[2023-07-17 13:47:34] [config] after-epochs: 80
[2023-07-17 13:47:34] [config] all-caps-every: 0
[2023-07-17 13:47:34] [config] allow-unk: false
[2023-07-17 13:47:34] [config] authors: false
[2023-07-17 13:47:34] [config] beam-size: 12
[2023-07-17 13:47:34] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:34] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:34] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:34] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:34] [config] build-info: ""
[2023-07-17 13:47:34] [config] check-gradient-nan: false
[2023-07-17 13:47:34] [config] check-nan: false
[2023-07-17 13:47:34] [config] cite: false
[2023-07-17 13:47:34] [config] clip-norm: 1
[2023-07-17 13:47:34] [config] cost-scaling:
[2023-07-17 13:47:34] [config]   - 256.f
[2023-07-17 13:47:34] [config]   - 1000
[2023-07-17 13:47:34] [config]   - 2.f
[2023-07-17 13:47:34] [config]   - 256.f
[2023-07-17 13:47:34] [config] cost-type: ce-sum
[2023-07-17 13:47:34] [config] cpu-threads: 0
[2023-07-17 13:47:34] [config] data-threads: 8
[2023-07-17 13:47:34] [config] data-weighting: ""
[2023-07-17 13:47:34] [config] data-weighting-type: sentence
[2023-07-17 13:47:34] [config] dec-cell: gru
[2023-07-17 13:47:34] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:34] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:34] [config] dec-depth: 2
[2023-07-17 13:47:34] [config] devices:
[2023-07-17 13:47:34] [config]   - 0
[2023-07-17 13:47:34] [config] dim-emb: 512
[2023-07-17 13:47:34] [config] dim-rnn: 1024
[2023-07-17 13:47:34] [config] dim-vocabs:
[2023-07-17 13:47:34] [config]   - 16384
[2023-07-17 13:47:34] [config]   - 16384
[2023-07-17 13:47:34] [config] disp-first: 0
[2023-07-17 13:47:34] [config] disp-freq: 1000u
[2023-07-17 13:47:34] [config] disp-label-counts: true
[2023-07-17 13:47:34] [config] dropout-rnn: 0
[2023-07-17 13:47:34] [config] dropout-src: 0
[2023-07-17 13:47:34] [config] dropout-trg: 0
[2023-07-17 13:47:34] [config] dump-config: ""
[2023-07-17 13:47:34] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] early-stopping: 5
[2023-07-17 13:47:34] [config] early-stopping-on: first
[2023-07-17 13:47:34] [config] embedding-fix-src: false
[2023-07-17 13:47:34] [config] embedding-fix-trg: false
[2023-07-17 13:47:34] [config] embedding-normalization: false
[2023-07-17 13:47:34] [config] embedding-vectors:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] enc-cell: gru
[2023-07-17 13:47:34] [config] enc-cell-depth: 1
[2023-07-17 13:47:34] [config] enc-depth: 1
[2023-07-17 13:47:34] [config] enc-type: bidirectional
[2023-07-17 13:47:34] [config] english-title-case-every: 0
[2023-07-17 13:47:34] [config] exponential-smoothing: 0
[2023-07-17 13:47:34] [config] factor-weight: 1
[2023-07-17 13:47:34] [config] factors-combine: sum
[2023-07-17 13:47:34] [config] factors-dim-emb: 0
[2023-07-17 13:47:34] [config] gradient-checkpointing: false
[2023-07-17 13:47:34] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:34] [config] guided-alignment: none
[2023-07-17 13:47:34] [config] guided-alignment-cost: mse
[2023-07-17 13:47:34] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:34] [config] ignore-model-config: false
[2023-07-17 13:47:34] [config] input-types:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] interpolate-env-vars: false
[2023-07-17 13:47:34] [config] keep-best: false
[2023-07-17 13:47:34] [config] label-smoothing: 0
[2023-07-17 13:47:34] [config] layer-normalization: false
[2023-07-17 13:47:34] [config] learn-rate: 0.0001
[2023-07-17 13:47:34] [config] lemma-dependency: ""
[2023-07-17 13:47:34] [config] lemma-dim-emb: 0
[2023-07-17 13:47:34] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:34] [config] log-level: info
[2023-07-17 13:47:34] [config] log-time-zone: ""
[2023-07-17 13:47:34] [config] logical-epoch:
[2023-07-17 13:47:34] [config]   - 1e
[2023-07-17 13:47:34] [config]   - 0
[2023-07-17 13:47:34] [config] lr-decay: 0
[2023-07-17 13:47:34] [config] lr-decay-freq: 50000
[2023-07-17 13:47:34] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:34] [config]   - 0
[2023-07-17 13:47:34] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:34] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:34] [config] lr-decay-start:
[2023-07-17 13:47:34] [config]   - 10
[2023-07-17 13:47:34] [config]   - 1
[2023-07-17 13:47:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:34] [config] lr-report: false
[2023-07-17 13:47:34] [config] lr-warmup: 0
[2023-07-17 13:47:34] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:34] [config] lr-warmup-cycle: false
[2023-07-17 13:47:34] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:34] [config] max-length: 50
[2023-07-17 13:47:34] [config] max-length-crop: true
[2023-07-17 13:47:34] [config] max-length-factor: 3
[2023-07-17 13:47:34] [config] maxi-batch: 100
[2023-07-17 13:47:34] [config] maxi-batch-sort: trg
[2023-07-17 13:47:34] [config] mini-batch: 64
[2023-07-17 13:47:34] [config] mini-batch-fit: true
[2023-07-17 13:47:34] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:34] [config] mini-batch-round-up: true
[2023-07-17 13:47:34] [config] mini-batch-track-lr: false
[2023-07-17 13:47:34] [config] mini-batch-warmup: 0
[2023-07-17 13:47:34] [config] mini-batch-words: 0
[2023-07-17 13:47:34] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:34] [config] multi-loss-type: sum
[2023-07-17 13:47:34] [config] n-best: false
[2023-07-17 13:47:34] [config] no-nccl: false
[2023-07-17 13:47:34] [config] no-reload: false
[2023-07-17 13:47:34] [config] no-restore-corpus: false
[2023-07-17 13:47:34] [config] normalize: 0
[2023-07-17 13:47:34] [config] normalize-gradient: false
[2023-07-17 13:47:34] [config] num-devices: 0
[2023-07-17 13:47:34] [config] optimizer: adam
[2023-07-17 13:47:34] [config] optimizer-delay: 1
[2023-07-17 13:47:34] [config] optimizer-params:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] output-omit-bias: false
[2023-07-17 13:47:34] [config] overwrite: true
[2023-07-17 13:47:34] [config] precision:
[2023-07-17 13:47:34] [config]   - float16
[2023-07-17 13:47:34] [config]   - float32
[2023-07-17 13:47:34] [config] pretrained-model: ""
[2023-07-17 13:47:34] [config] quantize-biases: false
[2023-07-17 13:47:34] [config] quantize-bits: 0
[2023-07-17 13:47:34] [config] quantize-log-based: false
[2023-07-17 13:47:34] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:34] [config] quiet: false
[2023-07-17 13:47:34] [config] quiet-translation: true
[2023-07-17 13:47:34] [config] relative-paths: false
[2023-07-17 13:47:34] [config] right-left: false
[2023-07-17 13:47:34] [config] save-freq: 10000u
[2023-07-17 13:47:34] [config] seed: 1234
[2023-07-17 13:47:34] [config] sentencepiece-alphas:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:34] [config] sentencepiece-options: ""
[2023-07-17 13:47:34] [config] sharding: global
[2023-07-17 13:47:34] [config] shuffle: data
[2023-07-17 13:47:34] [config] shuffle-in-ram: false
[2023-07-17 13:47:34] [config] sigterm: save-and-exit
[2023-07-17 13:47:34] [config] skip: false
[2023-07-17 13:47:34] [config] sqlite: ""
[2023-07-17 13:47:34] [config] sqlite-drop: false
[2023-07-17 13:47:34] [config] sync-freq: 200u
[2023-07-17 13:47:34] [config] sync-sgd: false
[2023-07-17 13:47:34] [config] tempdir: /tmp
[2023-07-17 13:47:34] [config] tied-embeddings: false
[2023-07-17 13:47:34] [config] tied-embeddings-all: true
[2023-07-17 13:47:34] [config] tied-embeddings-src: false
[2023-07-17 13:47:34] [config] train-embedder-rank:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] train-sets:
[2023-07-17 13:47:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:34] [config] transformer-aan-activation: swish
[2023-07-17 13:47:34] [config] transformer-aan-depth: 2
[2023-07-17 13:47:34] [config] transformer-aan-nogate: false
[2023-07-17 13:47:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:34] [config] transformer-depth-scaling: false
[2023-07-17 13:47:34] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:34] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:34] [config] transformer-dropout: 0
[2023-07-17 13:47:34] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:34] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:34] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:34] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:34] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:34] [config] transformer-heads: 8
[2023-07-17 13:47:34] [config] transformer-no-projection: false
[2023-07-17 13:47:34] [config] transformer-pool: false
[2023-07-17 13:47:34] [config] transformer-postprocess: dan
[2023-07-17 13:47:34] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:34] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:34] [config] transformer-preprocess: ""
[2023-07-17 13:47:34] [config] transformer-tied-layers:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:34] [config] tsv: false
[2023-07-17 13:47:34] [config] tsv-fields: 0
[2023-07-17 13:47:34] [config] type: amun
[2023-07-17 13:47:34] [config] ulr: false
[2023-07-17 13:47:34] [config] ulr-dim-emb: 0
[2023-07-17 13:47:34] [config] ulr-dropout: 0
[2023-07-17 13:47:34] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:34] [config] ulr-query-vectors: ""
[2023-07-17 13:47:34] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:34] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:34] [config] unlikelihood-loss: false
[2023-07-17 13:47:34] [config] valid-freq: 50000000
[2023-07-17 13:47:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:34] [config] valid-max-length: 1000
[2023-07-17 13:47:34] [config] valid-metrics:
[2023-07-17 13:47:34] [config]   - cross-entropy
[2023-07-17 13:47:34] [config]   - translation
[2023-07-17 13:47:34] [config] valid-mini-batch: 32
[2023-07-17 13:47:34] [config] valid-reset-stalled: false
[2023-07-17 13:47:34] [config] valid-script-args:
[2023-07-17 13:47:34] [config]   []
[2023-07-17 13:47:34] [config] valid-script-path: ""
[2023-07-17 13:47:34] [config] valid-sets:
[2023-07-17 13:47:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:34] [config] vocabs:
[2023-07-17 13:47:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:34] [config] word-penalty: 0
[2023-07-17 13:47:34] [config] word-scores: false
[2023-07-17 13:47:34] [config] workspace: 5500
[2023-07-17 13:47:34] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:34] [training] Using single-device training
[2023-07-17 13:47:34] Synced seed 1234
[2023-07-17 13:47:34] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:34] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:36] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:36] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:36] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x559e498fab5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x559e4983cda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x559e498411a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x559e498482ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x559e499f4a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x559e499f5a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x559e499cebee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x559e494d0108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x559e493f22c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x559e493a9b9c]    main                                               + 0x3c
[0x7f1c9acbb0b3]    __libc_start_main                                  + 0xf3
[0x559e493f0cbe]    _start                                             + 0x2e

[2023-07-17 13:47:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:37] [marian] Running on node22.datos.cluster.uy as process 7239 with command line:
[2023-07-17 13:47:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:37] [config] after: 0e
[2023-07-17 13:47:37] [config] after-batches: 0
[2023-07-17 13:47:37] [config] after-epochs: 90
[2023-07-17 13:47:37] [config] all-caps-every: 0
[2023-07-17 13:47:37] [config] allow-unk: false
[2023-07-17 13:47:37] [config] authors: false
[2023-07-17 13:47:37] [config] beam-size: 12
[2023-07-17 13:47:37] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:37] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:37] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:37] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:37] [config] build-info: ""
[2023-07-17 13:47:37] [config] check-gradient-nan: false
[2023-07-17 13:47:37] [config] check-nan: false
[2023-07-17 13:47:37] [config] cite: false
[2023-07-17 13:47:37] [config] clip-norm: 1
[2023-07-17 13:47:37] [config] cost-scaling:
[2023-07-17 13:47:37] [config]   - 256.f
[2023-07-17 13:47:37] [config]   - 1000
[2023-07-17 13:47:37] [config]   - 2.f
[2023-07-17 13:47:37] [config]   - 256.f
[2023-07-17 13:47:37] [config] cost-type: ce-sum
[2023-07-17 13:47:37] [config] cpu-threads: 0
[2023-07-17 13:47:37] [config] data-threads: 8
[2023-07-17 13:47:37] [config] data-weighting: ""
[2023-07-17 13:47:37] [config] data-weighting-type: sentence
[2023-07-17 13:47:37] [config] dec-cell: gru
[2023-07-17 13:47:37] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:37] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:37] [config] dec-depth: 2
[2023-07-17 13:47:37] [config] devices:
[2023-07-17 13:47:37] [config]   - 0
[2023-07-17 13:47:37] [config] dim-emb: 512
[2023-07-17 13:47:37] [config] dim-rnn: 1024
[2023-07-17 13:47:37] [config] dim-vocabs:
[2023-07-17 13:47:37] [config]   - 16384
[2023-07-17 13:47:37] [config]   - 16384
[2023-07-17 13:47:37] [config] disp-first: 0
[2023-07-17 13:47:37] [config] disp-freq: 1000u
[2023-07-17 13:47:37] [config] disp-label-counts: true
[2023-07-17 13:47:37] [config] dropout-rnn: 0
[2023-07-17 13:47:37] [config] dropout-src: 0
[2023-07-17 13:47:37] [config] dropout-trg: 0
[2023-07-17 13:47:37] [config] dump-config: ""
[2023-07-17 13:47:37] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] early-stopping: 5
[2023-07-17 13:47:37] [config] early-stopping-on: first
[2023-07-17 13:47:37] [config] embedding-fix-src: false
[2023-07-17 13:47:37] [config] embedding-fix-trg: false
[2023-07-17 13:47:37] [config] embedding-normalization: false
[2023-07-17 13:47:37] [config] embedding-vectors:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] enc-cell: gru
[2023-07-17 13:47:37] [config] enc-cell-depth: 1
[2023-07-17 13:47:37] [config] enc-depth: 1
[2023-07-17 13:47:37] [config] enc-type: bidirectional
[2023-07-17 13:47:37] [config] english-title-case-every: 0
[2023-07-17 13:47:37] [config] exponential-smoothing: 0
[2023-07-17 13:47:37] [config] factor-weight: 1
[2023-07-17 13:47:37] [config] factors-combine: sum
[2023-07-17 13:47:37] [config] factors-dim-emb: 0
[2023-07-17 13:47:37] [config] gradient-checkpointing: false
[2023-07-17 13:47:37] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:37] [config] guided-alignment: none
[2023-07-17 13:47:37] [config] guided-alignment-cost: mse
[2023-07-17 13:47:37] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:37] [config] ignore-model-config: false
[2023-07-17 13:47:37] [config] input-types:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] interpolate-env-vars: false
[2023-07-17 13:47:37] [config] keep-best: false
[2023-07-17 13:47:37] [config] label-smoothing: 0
[2023-07-17 13:47:37] [config] layer-normalization: false
[2023-07-17 13:47:37] [config] learn-rate: 0.0001
[2023-07-17 13:47:37] [config] lemma-dependency: ""
[2023-07-17 13:47:37] [config] lemma-dim-emb: 0
[2023-07-17 13:47:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:37] [config] log-level: info
[2023-07-17 13:47:37] [config] log-time-zone: ""
[2023-07-17 13:47:37] [config] logical-epoch:
[2023-07-17 13:47:37] [config]   - 1e
[2023-07-17 13:47:37] [config]   - 0
[2023-07-17 13:47:37] [config] lr-decay: 0
[2023-07-17 13:47:37] [config] lr-decay-freq: 50000
[2023-07-17 13:47:37] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:37] [config]   - 0
[2023-07-17 13:47:37] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:37] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:37] [config] lr-decay-start:
[2023-07-17 13:47:37] [config]   - 10
[2023-07-17 13:47:37] [config]   - 1
[2023-07-17 13:47:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:37] [config] lr-report: false
[2023-07-17 13:47:37] [config] lr-warmup: 0
[2023-07-17 13:47:37] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:37] [config] lr-warmup-cycle: false
[2023-07-17 13:47:37] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:37] [config] max-length: 50
[2023-07-17 13:47:37] [config] max-length-crop: true
[2023-07-17 13:47:37] [config] max-length-factor: 3
[2023-07-17 13:47:37] [config] maxi-batch: 100
[2023-07-17 13:47:37] [config] maxi-batch-sort: trg
[2023-07-17 13:47:37] [config] mini-batch: 64
[2023-07-17 13:47:37] [config] mini-batch-fit: true
[2023-07-17 13:47:37] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:37] [config] mini-batch-round-up: true
[2023-07-17 13:47:37] [config] mini-batch-track-lr: false
[2023-07-17 13:47:37] [config] mini-batch-warmup: 0
[2023-07-17 13:47:37] [config] mini-batch-words: 0
[2023-07-17 13:47:37] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:37] [config] multi-loss-type: sum
[2023-07-17 13:47:37] [config] n-best: false
[2023-07-17 13:47:37] [config] no-nccl: false
[2023-07-17 13:47:37] [config] no-reload: false
[2023-07-17 13:47:37] [config] no-restore-corpus: false
[2023-07-17 13:47:37] [config] normalize: 0
[2023-07-17 13:47:37] [config] normalize-gradient: false
[2023-07-17 13:47:37] [config] num-devices: 0
[2023-07-17 13:47:37] [config] optimizer: adam
[2023-07-17 13:47:37] [config] optimizer-delay: 1
[2023-07-17 13:47:37] [config] optimizer-params:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] output-omit-bias: false
[2023-07-17 13:47:37] [config] overwrite: true
[2023-07-17 13:47:37] [config] precision:
[2023-07-17 13:47:37] [config]   - float16
[2023-07-17 13:47:37] [config]   - float32
[2023-07-17 13:47:37] [config] pretrained-model: ""
[2023-07-17 13:47:37] [config] quantize-biases: false
[2023-07-17 13:47:37] [config] quantize-bits: 0
[2023-07-17 13:47:37] [config] quantize-log-based: false
[2023-07-17 13:47:37] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:37] [config] quiet: false
[2023-07-17 13:47:37] [config] quiet-translation: true
[2023-07-17 13:47:37] [config] relative-paths: false
[2023-07-17 13:47:37] [config] right-left: false
[2023-07-17 13:47:37] [config] save-freq: 10000u
[2023-07-17 13:47:37] [config] seed: 1234
[2023-07-17 13:47:37] [config] sentencepiece-alphas:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:37] [config] sentencepiece-options: ""
[2023-07-17 13:47:37] [config] sharding: global
[2023-07-17 13:47:37] [config] shuffle: data
[2023-07-17 13:47:37] [config] shuffle-in-ram: false
[2023-07-17 13:47:37] [config] sigterm: save-and-exit
[2023-07-17 13:47:37] [config] skip: false
[2023-07-17 13:47:37] [config] sqlite: ""
[2023-07-17 13:47:37] [config] sqlite-drop: false
[2023-07-17 13:47:37] [config] sync-freq: 200u
[2023-07-17 13:47:37] [config] sync-sgd: false
[2023-07-17 13:47:37] [config] tempdir: /tmp
[2023-07-17 13:47:37] [config] tied-embeddings: false
[2023-07-17 13:47:37] [config] tied-embeddings-all: true
[2023-07-17 13:47:37] [config] tied-embeddings-src: false
[2023-07-17 13:47:37] [config] train-embedder-rank:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] train-sets:
[2023-07-17 13:47:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:37] [config] transformer-aan-activation: swish
[2023-07-17 13:47:37] [config] transformer-aan-depth: 2
[2023-07-17 13:47:37] [config] transformer-aan-nogate: false
[2023-07-17 13:47:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:37] [config] transformer-depth-scaling: false
[2023-07-17 13:47:37] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:37] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:37] [config] transformer-dropout: 0
[2023-07-17 13:47:37] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:37] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:37] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:37] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:37] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:37] [config] transformer-heads: 8
[2023-07-17 13:47:37] [config] transformer-no-projection: false
[2023-07-17 13:47:37] [config] transformer-pool: false
[2023-07-17 13:47:37] [config] transformer-postprocess: dan
[2023-07-17 13:47:37] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:37] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:37] [config] transformer-preprocess: ""
[2023-07-17 13:47:37] [config] transformer-tied-layers:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:37] [config] tsv: false
[2023-07-17 13:47:37] [config] tsv-fields: 0
[2023-07-17 13:47:37] [config] type: amun
[2023-07-17 13:47:37] [config] ulr: false
[2023-07-17 13:47:37] [config] ulr-dim-emb: 0
[2023-07-17 13:47:37] [config] ulr-dropout: 0
[2023-07-17 13:47:37] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:37] [config] ulr-query-vectors: ""
[2023-07-17 13:47:37] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:37] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:37] [config] unlikelihood-loss: false
[2023-07-17 13:47:37] [config] valid-freq: 50000000
[2023-07-17 13:47:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:37] [config] valid-max-length: 1000
[2023-07-17 13:47:37] [config] valid-metrics:
[2023-07-17 13:47:37] [config]   - cross-entropy
[2023-07-17 13:47:37] [config]   - translation
[2023-07-17 13:47:37] [config] valid-mini-batch: 32
[2023-07-17 13:47:37] [config] valid-reset-stalled: false
[2023-07-17 13:47:37] [config] valid-script-args:
[2023-07-17 13:47:37] [config]   []
[2023-07-17 13:47:37] [config] valid-script-path: ""
[2023-07-17 13:47:37] [config] valid-sets:
[2023-07-17 13:47:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:37] [config] vocabs:
[2023-07-17 13:47:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:37] [config] word-penalty: 0
[2023-07-17 13:47:37] [config] word-scores: false
[2023-07-17 13:47:37] [config] workspace: 5500
[2023-07-17 13:47:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:37] [training] Using single-device training
[2023-07-17 13:47:37] Synced seed 1234
[2023-07-17 13:47:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:37] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:37] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:38] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:38] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x563b1da13b5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x563b1d955da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x563b1d95a1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x563b1d9612ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x563b1db0da0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x563b1db0ea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x563b1dae7bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x563b1d5e9108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x563b1d50b2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563b1d4c2b9c]    main                                               + 0x3c
[0x7f5b926070b3]    __libc_start_main                                  + 0xf3
[0x563b1d509cbe]    _start                                             + 0x2e

[2023-07-17 13:47:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:39] [marian] Running on node22.datos.cluster.uy as process 7264 with command line:
[2023-07-17 13:47:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:39] [config] after: 0e
[2023-07-17 13:47:39] [config] after-batches: 0
[2023-07-17 13:47:39] [config] after-epochs: 100
[2023-07-17 13:47:39] [config] all-caps-every: 0
[2023-07-17 13:47:39] [config] allow-unk: false
[2023-07-17 13:47:39] [config] authors: false
[2023-07-17 13:47:39] [config] beam-size: 12
[2023-07-17 13:47:39] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:39] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:39] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:39] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:39] [config] build-info: ""
[2023-07-17 13:47:39] [config] check-gradient-nan: false
[2023-07-17 13:47:39] [config] check-nan: false
[2023-07-17 13:47:39] [config] cite: false
[2023-07-17 13:47:39] [config] clip-norm: 1
[2023-07-17 13:47:39] [config] cost-scaling:
[2023-07-17 13:47:39] [config]   - 256.f
[2023-07-17 13:47:39] [config]   - 1000
[2023-07-17 13:47:39] [config]   - 2.f
[2023-07-17 13:47:39] [config]   - 256.f
[2023-07-17 13:47:39] [config] cost-type: ce-sum
[2023-07-17 13:47:39] [config] cpu-threads: 0
[2023-07-17 13:47:39] [config] data-threads: 8
[2023-07-17 13:47:39] [config] data-weighting: ""
[2023-07-17 13:47:39] [config] data-weighting-type: sentence
[2023-07-17 13:47:39] [config] dec-cell: gru
[2023-07-17 13:47:39] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:39] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:39] [config] dec-depth: 2
[2023-07-17 13:47:39] [config] devices:
[2023-07-17 13:47:39] [config]   - 0
[2023-07-17 13:47:39] [config] dim-emb: 512
[2023-07-17 13:47:39] [config] dim-rnn: 1024
[2023-07-17 13:47:39] [config] dim-vocabs:
[2023-07-17 13:47:39] [config]   - 16384
[2023-07-17 13:47:39] [config]   - 16384
[2023-07-17 13:47:39] [config] disp-first: 0
[2023-07-17 13:47:39] [config] disp-freq: 1000u
[2023-07-17 13:47:39] [config] disp-label-counts: true
[2023-07-17 13:47:39] [config] dropout-rnn: 0
[2023-07-17 13:47:39] [config] dropout-src: 0
[2023-07-17 13:47:39] [config] dropout-trg: 0
[2023-07-17 13:47:39] [config] dump-config: ""
[2023-07-17 13:47:39] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] early-stopping: 5
[2023-07-17 13:47:39] [config] early-stopping-on: first
[2023-07-17 13:47:39] [config] embedding-fix-src: false
[2023-07-17 13:47:39] [config] embedding-fix-trg: false
[2023-07-17 13:47:39] [config] embedding-normalization: false
[2023-07-17 13:47:39] [config] embedding-vectors:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] enc-cell: gru
[2023-07-17 13:47:39] [config] enc-cell-depth: 1
[2023-07-17 13:47:39] [config] enc-depth: 1
[2023-07-17 13:47:39] [config] enc-type: bidirectional
[2023-07-17 13:47:39] [config] english-title-case-every: 0
[2023-07-17 13:47:39] [config] exponential-smoothing: 0
[2023-07-17 13:47:39] [config] factor-weight: 1
[2023-07-17 13:47:39] [config] factors-combine: sum
[2023-07-17 13:47:39] [config] factors-dim-emb: 0
[2023-07-17 13:47:39] [config] gradient-checkpointing: false
[2023-07-17 13:47:39] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:39] [config] guided-alignment: none
[2023-07-17 13:47:39] [config] guided-alignment-cost: mse
[2023-07-17 13:47:39] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:39] [config] ignore-model-config: false
[2023-07-17 13:47:39] [config] input-types:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] interpolate-env-vars: false
[2023-07-17 13:47:39] [config] keep-best: false
[2023-07-17 13:47:39] [config] label-smoothing: 0
[2023-07-17 13:47:39] [config] layer-normalization: false
[2023-07-17 13:47:39] [config] learn-rate: 0.0001
[2023-07-17 13:47:39] [config] lemma-dependency: ""
[2023-07-17 13:47:39] [config] lemma-dim-emb: 0
[2023-07-17 13:47:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:39] [config] log-level: info
[2023-07-17 13:47:39] [config] log-time-zone: ""
[2023-07-17 13:47:39] [config] logical-epoch:
[2023-07-17 13:47:39] [config]   - 1e
[2023-07-17 13:47:39] [config]   - 0
[2023-07-17 13:47:39] [config] lr-decay: 0
[2023-07-17 13:47:39] [config] lr-decay-freq: 50000
[2023-07-17 13:47:39] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:39] [config]   - 0
[2023-07-17 13:47:39] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:39] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:39] [config] lr-decay-start:
[2023-07-17 13:47:39] [config]   - 10
[2023-07-17 13:47:39] [config]   - 1
[2023-07-17 13:47:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:39] [config] lr-report: false
[2023-07-17 13:47:39] [config] lr-warmup: 0
[2023-07-17 13:47:39] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:39] [config] lr-warmup-cycle: false
[2023-07-17 13:47:39] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:39] [config] max-length: 50
[2023-07-17 13:47:39] [config] max-length-crop: true
[2023-07-17 13:47:39] [config] max-length-factor: 3
[2023-07-17 13:47:39] [config] maxi-batch: 100
[2023-07-17 13:47:39] [config] maxi-batch-sort: trg
[2023-07-17 13:47:39] [config] mini-batch: 64
[2023-07-17 13:47:39] [config] mini-batch-fit: true
[2023-07-17 13:47:39] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:39] [config] mini-batch-round-up: true
[2023-07-17 13:47:39] [config] mini-batch-track-lr: false
[2023-07-17 13:47:39] [config] mini-batch-warmup: 0
[2023-07-17 13:47:39] [config] mini-batch-words: 0
[2023-07-17 13:47:39] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:39] [config] multi-loss-type: sum
[2023-07-17 13:47:39] [config] n-best: false
[2023-07-17 13:47:39] [config] no-nccl: false
[2023-07-17 13:47:39] [config] no-reload: false
[2023-07-17 13:47:39] [config] no-restore-corpus: false
[2023-07-17 13:47:39] [config] normalize: 0
[2023-07-17 13:47:39] [config] normalize-gradient: false
[2023-07-17 13:47:39] [config] num-devices: 0
[2023-07-17 13:47:39] [config] optimizer: adam
[2023-07-17 13:47:39] [config] optimizer-delay: 1
[2023-07-17 13:47:39] [config] optimizer-params:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] output-omit-bias: false
[2023-07-17 13:47:39] [config] overwrite: true
[2023-07-17 13:47:39] [config] precision:
[2023-07-17 13:47:39] [config]   - float16
[2023-07-17 13:47:39] [config]   - float32
[2023-07-17 13:47:39] [config] pretrained-model: ""
[2023-07-17 13:47:39] [config] quantize-biases: false
[2023-07-17 13:47:39] [config] quantize-bits: 0
[2023-07-17 13:47:39] [config] quantize-log-based: false
[2023-07-17 13:47:39] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:39] [config] quiet: false
[2023-07-17 13:47:39] [config] quiet-translation: true
[2023-07-17 13:47:39] [config] relative-paths: false
[2023-07-17 13:47:39] [config] right-left: false
[2023-07-17 13:47:39] [config] save-freq: 10000u
[2023-07-17 13:47:39] [config] seed: 1234
[2023-07-17 13:47:39] [config] sentencepiece-alphas:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:39] [config] sentencepiece-options: ""
[2023-07-17 13:47:39] [config] sharding: global
[2023-07-17 13:47:39] [config] shuffle: data
[2023-07-17 13:47:39] [config] shuffle-in-ram: false
[2023-07-17 13:47:39] [config] sigterm: save-and-exit
[2023-07-17 13:47:39] [config] skip: false
[2023-07-17 13:47:39] [config] sqlite: ""
[2023-07-17 13:47:39] [config] sqlite-drop: false
[2023-07-17 13:47:39] [config] sync-freq: 200u
[2023-07-17 13:47:39] [config] sync-sgd: false
[2023-07-17 13:47:39] [config] tempdir: /tmp
[2023-07-17 13:47:39] [config] tied-embeddings: false
[2023-07-17 13:47:39] [config] tied-embeddings-all: true
[2023-07-17 13:47:39] [config] tied-embeddings-src: false
[2023-07-17 13:47:39] [config] train-embedder-rank:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] train-sets:
[2023-07-17 13:47:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:39] [config] transformer-aan-activation: swish
[2023-07-17 13:47:39] [config] transformer-aan-depth: 2
[2023-07-17 13:47:39] [config] transformer-aan-nogate: false
[2023-07-17 13:47:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:39] [config] transformer-depth-scaling: false
[2023-07-17 13:47:39] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:39] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:39] [config] transformer-dropout: 0
[2023-07-17 13:47:39] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:39] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:39] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:39] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:39] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:39] [config] transformer-heads: 8
[2023-07-17 13:47:39] [config] transformer-no-projection: false
[2023-07-17 13:47:39] [config] transformer-pool: false
[2023-07-17 13:47:39] [config] transformer-postprocess: dan
[2023-07-17 13:47:39] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:39] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:39] [config] transformer-preprocess: ""
[2023-07-17 13:47:39] [config] transformer-tied-layers:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:39] [config] tsv: false
[2023-07-17 13:47:39] [config] tsv-fields: 0
[2023-07-17 13:47:39] [config] type: amun
[2023-07-17 13:47:39] [config] ulr: false
[2023-07-17 13:47:39] [config] ulr-dim-emb: 0
[2023-07-17 13:47:39] [config] ulr-dropout: 0
[2023-07-17 13:47:39] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:39] [config] ulr-query-vectors: ""
[2023-07-17 13:47:39] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:39] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:39] [config] unlikelihood-loss: false
[2023-07-17 13:47:39] [config] valid-freq: 50000000
[2023-07-17 13:47:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:39] [config] valid-max-length: 1000
[2023-07-17 13:47:39] [config] valid-metrics:
[2023-07-17 13:47:39] [config]   - cross-entropy
[2023-07-17 13:47:39] [config]   - translation
[2023-07-17 13:47:39] [config] valid-mini-batch: 32
[2023-07-17 13:47:39] [config] valid-reset-stalled: false
[2023-07-17 13:47:39] [config] valid-script-args:
[2023-07-17 13:47:39] [config]   []
[2023-07-17 13:47:39] [config] valid-script-path: ""
[2023-07-17 13:47:39] [config] valid-sets:
[2023-07-17 13:47:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:39] [config] vocabs:
[2023-07-17 13:47:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:39] [config] word-penalty: 0
[2023-07-17 13:47:39] [config] word-scores: false
[2023-07-17 13:47:39] [config] workspace: 5500
[2023-07-17 13:47:39] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:39] [training] Using single-device training
[2023-07-17 13:47:39] Synced seed 1234
[2023-07-17 13:47:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:39] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:41] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:41] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x561326df5b5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x561326d37da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x561326d3c1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x561326d432ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x561326eefa0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x561326ef0a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x561326ec9bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5613269cb108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5613268ed2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5613268a4b9c]    main                                               + 0x3c
[0x7fac699e60b3]    __libc_start_main                                  + 0xf3
[0x5613268ebcbe]    _start                                             + 0x2e

[2023-07-17 13:47:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:42] [marian] Running on node22.datos.cluster.uy as process 7289 with command line:
[2023-07-17 13:47:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:42] [config] after: 0e
[2023-07-17 13:47:42] [config] after-batches: 0
[2023-07-17 13:47:42] [config] after-epochs: 110
[2023-07-17 13:47:42] [config] all-caps-every: 0
[2023-07-17 13:47:42] [config] allow-unk: false
[2023-07-17 13:47:42] [config] authors: false
[2023-07-17 13:47:42] [config] beam-size: 12
[2023-07-17 13:47:42] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:42] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:42] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:42] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:42] [config] build-info: ""
[2023-07-17 13:47:42] [config] check-gradient-nan: false
[2023-07-17 13:47:42] [config] check-nan: false
[2023-07-17 13:47:42] [config] cite: false
[2023-07-17 13:47:42] [config] clip-norm: 1
[2023-07-17 13:47:42] [config] cost-scaling:
[2023-07-17 13:47:42] [config]   - 256.f
[2023-07-17 13:47:42] [config]   - 1000
[2023-07-17 13:47:42] [config]   - 2.f
[2023-07-17 13:47:42] [config]   - 256.f
[2023-07-17 13:47:42] [config] cost-type: ce-sum
[2023-07-17 13:47:42] [config] cpu-threads: 0
[2023-07-17 13:47:42] [config] data-threads: 8
[2023-07-17 13:47:42] [config] data-weighting: ""
[2023-07-17 13:47:42] [config] data-weighting-type: sentence
[2023-07-17 13:47:42] [config] dec-cell: gru
[2023-07-17 13:47:42] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:42] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:42] [config] dec-depth: 2
[2023-07-17 13:47:42] [config] devices:
[2023-07-17 13:47:42] [config]   - 0
[2023-07-17 13:47:42] [config] dim-emb: 512
[2023-07-17 13:47:42] [config] dim-rnn: 1024
[2023-07-17 13:47:42] [config] dim-vocabs:
[2023-07-17 13:47:42] [config]   - 16384
[2023-07-17 13:47:42] [config]   - 16384
[2023-07-17 13:47:42] [config] disp-first: 0
[2023-07-17 13:47:42] [config] disp-freq: 1000u
[2023-07-17 13:47:42] [config] disp-label-counts: true
[2023-07-17 13:47:42] [config] dropout-rnn: 0
[2023-07-17 13:47:42] [config] dropout-src: 0
[2023-07-17 13:47:42] [config] dropout-trg: 0
[2023-07-17 13:47:42] [config] dump-config: ""
[2023-07-17 13:47:42] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] early-stopping: 5
[2023-07-17 13:47:42] [config] early-stopping-on: first
[2023-07-17 13:47:42] [config] embedding-fix-src: false
[2023-07-17 13:47:42] [config] embedding-fix-trg: false
[2023-07-17 13:47:42] [config] embedding-normalization: false
[2023-07-17 13:47:42] [config] embedding-vectors:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] enc-cell: gru
[2023-07-17 13:47:42] [config] enc-cell-depth: 1
[2023-07-17 13:47:42] [config] enc-depth: 1
[2023-07-17 13:47:42] [config] enc-type: bidirectional
[2023-07-17 13:47:42] [config] english-title-case-every: 0
[2023-07-17 13:47:42] [config] exponential-smoothing: 0
[2023-07-17 13:47:42] [config] factor-weight: 1
[2023-07-17 13:47:42] [config] factors-combine: sum
[2023-07-17 13:47:42] [config] factors-dim-emb: 0
[2023-07-17 13:47:42] [config] gradient-checkpointing: false
[2023-07-17 13:47:42] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:42] [config] guided-alignment: none
[2023-07-17 13:47:42] [config] guided-alignment-cost: mse
[2023-07-17 13:47:42] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:42] [config] ignore-model-config: false
[2023-07-17 13:47:42] [config] input-types:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] interpolate-env-vars: false
[2023-07-17 13:47:42] [config] keep-best: false
[2023-07-17 13:47:42] [config] label-smoothing: 0
[2023-07-17 13:47:42] [config] layer-normalization: false
[2023-07-17 13:47:42] [config] learn-rate: 0.0001
[2023-07-17 13:47:42] [config] lemma-dependency: ""
[2023-07-17 13:47:42] [config] lemma-dim-emb: 0
[2023-07-17 13:47:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:42] [config] log-level: info
[2023-07-17 13:47:42] [config] log-time-zone: ""
[2023-07-17 13:47:42] [config] logical-epoch:
[2023-07-17 13:47:42] [config]   - 1e
[2023-07-17 13:47:42] [config]   - 0
[2023-07-17 13:47:42] [config] lr-decay: 0
[2023-07-17 13:47:42] [config] lr-decay-freq: 50000
[2023-07-17 13:47:42] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:42] [config]   - 0
[2023-07-17 13:47:42] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:42] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:42] [config] lr-decay-start:
[2023-07-17 13:47:42] [config]   - 10
[2023-07-17 13:47:42] [config]   - 1
[2023-07-17 13:47:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:42] [config] lr-report: false
[2023-07-17 13:47:42] [config] lr-warmup: 0
[2023-07-17 13:47:42] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:42] [config] lr-warmup-cycle: false
[2023-07-17 13:47:42] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:42] [config] max-length: 50
[2023-07-17 13:47:42] [config] max-length-crop: true
[2023-07-17 13:47:42] [config] max-length-factor: 3
[2023-07-17 13:47:42] [config] maxi-batch: 100
[2023-07-17 13:47:42] [config] maxi-batch-sort: trg
[2023-07-17 13:47:42] [config] mini-batch: 64
[2023-07-17 13:47:42] [config] mini-batch-fit: true
[2023-07-17 13:47:42] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:42] [config] mini-batch-round-up: true
[2023-07-17 13:47:42] [config] mini-batch-track-lr: false
[2023-07-17 13:47:42] [config] mini-batch-warmup: 0
[2023-07-17 13:47:42] [config] mini-batch-words: 0
[2023-07-17 13:47:42] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:42] [config] multi-loss-type: sum
[2023-07-17 13:47:42] [config] n-best: false
[2023-07-17 13:47:42] [config] no-nccl: false
[2023-07-17 13:47:42] [config] no-reload: false
[2023-07-17 13:47:42] [config] no-restore-corpus: false
[2023-07-17 13:47:42] [config] normalize: 0
[2023-07-17 13:47:42] [config] normalize-gradient: false
[2023-07-17 13:47:42] [config] num-devices: 0
[2023-07-17 13:47:42] [config] optimizer: adam
[2023-07-17 13:47:42] [config] optimizer-delay: 1
[2023-07-17 13:47:42] [config] optimizer-params:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] output-omit-bias: false
[2023-07-17 13:47:42] [config] overwrite: true
[2023-07-17 13:47:42] [config] precision:
[2023-07-17 13:47:42] [config]   - float16
[2023-07-17 13:47:42] [config]   - float32
[2023-07-17 13:47:42] [config] pretrained-model: ""
[2023-07-17 13:47:42] [config] quantize-biases: false
[2023-07-17 13:47:42] [config] quantize-bits: 0
[2023-07-17 13:47:42] [config] quantize-log-based: false
[2023-07-17 13:47:42] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:42] [config] quiet: false
[2023-07-17 13:47:42] [config] quiet-translation: true
[2023-07-17 13:47:42] [config] relative-paths: false
[2023-07-17 13:47:42] [config] right-left: false
[2023-07-17 13:47:42] [config] save-freq: 10000u
[2023-07-17 13:47:42] [config] seed: 1234
[2023-07-17 13:47:42] [config] sentencepiece-alphas:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:42] [config] sentencepiece-options: ""
[2023-07-17 13:47:42] [config] sharding: global
[2023-07-17 13:47:42] [config] shuffle: data
[2023-07-17 13:47:42] [config] shuffle-in-ram: false
[2023-07-17 13:47:42] [config] sigterm: save-and-exit
[2023-07-17 13:47:42] [config] skip: false
[2023-07-17 13:47:42] [config] sqlite: ""
[2023-07-17 13:47:42] [config] sqlite-drop: false
[2023-07-17 13:47:42] [config] sync-freq: 200u
[2023-07-17 13:47:42] [config] sync-sgd: false
[2023-07-17 13:47:42] [config] tempdir: /tmp
[2023-07-17 13:47:42] [config] tied-embeddings: false
[2023-07-17 13:47:42] [config] tied-embeddings-all: true
[2023-07-17 13:47:42] [config] tied-embeddings-src: false
[2023-07-17 13:47:42] [config] train-embedder-rank:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] train-sets:
[2023-07-17 13:47:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:42] [config] transformer-aan-activation: swish
[2023-07-17 13:47:42] [config] transformer-aan-depth: 2
[2023-07-17 13:47:42] [config] transformer-aan-nogate: false
[2023-07-17 13:47:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:42] [config] transformer-depth-scaling: false
[2023-07-17 13:47:42] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:42] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:42] [config] transformer-dropout: 0
[2023-07-17 13:47:42] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:42] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:42] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:42] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:42] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:42] [config] transformer-heads: 8
[2023-07-17 13:47:42] [config] transformer-no-projection: false
[2023-07-17 13:47:42] [config] transformer-pool: false
[2023-07-17 13:47:42] [config] transformer-postprocess: dan
[2023-07-17 13:47:42] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:42] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:42] [config] transformer-preprocess: ""
[2023-07-17 13:47:42] [config] transformer-tied-layers:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:42] [config] tsv: false
[2023-07-17 13:47:42] [config] tsv-fields: 0
[2023-07-17 13:47:42] [config] type: amun
[2023-07-17 13:47:42] [config] ulr: false
[2023-07-17 13:47:42] [config] ulr-dim-emb: 0
[2023-07-17 13:47:42] [config] ulr-dropout: 0
[2023-07-17 13:47:42] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:42] [config] ulr-query-vectors: ""
[2023-07-17 13:47:42] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:42] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:42] [config] unlikelihood-loss: false
[2023-07-17 13:47:42] [config] valid-freq: 50000000
[2023-07-17 13:47:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:42] [config] valid-max-length: 1000
[2023-07-17 13:47:42] [config] valid-metrics:
[2023-07-17 13:47:42] [config]   - cross-entropy
[2023-07-17 13:47:42] [config]   - translation
[2023-07-17 13:47:42] [config] valid-mini-batch: 32
[2023-07-17 13:47:42] [config] valid-reset-stalled: false
[2023-07-17 13:47:42] [config] valid-script-args:
[2023-07-17 13:47:42] [config]   []
[2023-07-17 13:47:42] [config] valid-script-path: ""
[2023-07-17 13:47:42] [config] valid-sets:
[2023-07-17 13:47:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:42] [config] vocabs:
[2023-07-17 13:47:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:42] [config] word-penalty: 0
[2023-07-17 13:47:42] [config] word-scores: false
[2023-07-17 13:47:42] [config] workspace: 5500
[2023-07-17 13:47:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:42] [training] Using single-device training
[2023-07-17 13:47:42] Synced seed 1234
[2023-07-17 13:47:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:42] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:42] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:47:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:47:43] Error: --type amun does not support multiple decoder layers, use --type s2s
[2023-07-17 13:47:43] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:21

[CALL STACK]
[0x56063b519b5d]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0xc7d
[0x56063b45bda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x56063b4601a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x56063b4672ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x56063b613a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x56063b614a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x56063b5edbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x56063b0ef108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x56063b0112c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56063afc8b9c]    main                                               + 0x3c
[0x7f85d18730b3]    __libc_start_main                                  + 0xf3
[0x56063b00fcbe]    _start                                             + 0x2e

[2023-07-17 13:47:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:44] [marian] Running on node22.datos.cluster.uy as process 7315 with command line:
[2023-07-17 13:47:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 1 --dec-depth 2
[2023-07-17 13:47:44] [config] after: 0e
[2023-07-17 13:47:44] [config] after-batches: 0
[2023-07-17 13:47:44] [config] after-epochs: 120
[2023-07-17 13:47:44] [config] all-caps-every: 0
[2023-07-17 13:47:44] [config] allow-unk: false
[2023-07-17 13:47:44] [config] authors: false
[2023-07-17 13:47:44] [config] beam-size: 12
[2023-07-17 13:47:44] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:47:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:47:44] [config] bert-masking-fraction: 0.15
[2023-07-17 13:47:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:47:44] [config] bert-train-type-embeddings: true
[2023-07-17 13:47:44] [config] bert-type-vocab-size: 2
[2023-07-17 13:47:44] [config] build-info: ""
[2023-07-17 13:47:44] [config] check-gradient-nan: false
[2023-07-17 13:47:44] [config] check-nan: false
[2023-07-17 13:47:44] [config] cite: false
[2023-07-17 13:47:44] [config] clip-norm: 1
[2023-07-17 13:47:44] [config] cost-scaling:
[2023-07-17 13:47:44] [config]   - 256.f
[2023-07-17 13:47:44] [config]   - 1000
[2023-07-17 13:47:44] [config]   - 2.f
[2023-07-17 13:47:44] [config]   - 256.f
[2023-07-17 13:47:44] [config] cost-type: ce-sum
[2023-07-17 13:47:44] [config] cpu-threads: 0
[2023-07-17 13:47:44] [config] data-threads: 8
[2023-07-17 13:47:44] [config] data-weighting: ""
[2023-07-17 13:47:44] [config] data-weighting-type: sentence
[2023-07-17 13:47:44] [config] dec-cell: gru
[2023-07-17 13:47:44] [config] dec-cell-base-depth: 2
[2023-07-17 13:47:44] [config] dec-cell-high-depth: 1
[2023-07-17 13:47:44] [config] dec-depth: 2
[2023-07-17 13:47:44] [config] devices:
[2023-07-17 13:47:44] [config]   - 0
[2023-07-17 13:47:44] [config] dim-emb: 512
[2023-07-17 13:47:44] [config] dim-rnn: 1024
[2023-07-17 13:47:44] [config] dim-vocabs:
[2023-07-17 13:47:44] [config]   - 16384
[2023-07-17 13:47:44] [config]   - 16384
[2023-07-17 13:47:44] [config] disp-first: 0
[2023-07-17 13:47:44] [config] disp-freq: 1000u
[2023-07-17 13:47:44] [config] disp-label-counts: true
[2023-07-17 13:47:44] [config] dropout-rnn: 0
[2023-07-17 13:47:44] [config] dropout-src: 0
[2023-07-17 13:47:44] [config] dropout-trg: 0
[2023-07-17 13:47:44] [config] dump-config: ""
[2023-07-17 13:47:44] [config] dynamic-gradient-scaling:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] early-stopping: 5
[2023-07-17 13:47:44] [config] early-stopping-on: first
[2023-07-17 13:47:44] [config] embedding-fix-src: false
[2023-07-17 13:47:44] [config] embedding-fix-trg: false
[2023-07-17 13:47:44] [config] embedding-normalization: false
[2023-07-17 13:47:44] [config] embedding-vectors:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] enc-cell: gru
[2023-07-17 13:47:44] [config] enc-cell-depth: 1
[2023-07-17 13:47:44] [config] enc-depth: 1
[2023-07-17 13:47:44] [config] enc-type: bidirectional
[2023-07-17 13:47:44] [config] english-title-case-every: 0
[2023-07-17 13:47:44] [config] exponential-smoothing: 0
[2023-07-17 13:47:44] [config] factor-weight: 1
[2023-07-17 13:47:44] [config] factors-combine: sum
[2023-07-17 13:47:44] [config] factors-dim-emb: 0
[2023-07-17 13:47:44] [config] gradient-checkpointing: false
[2023-07-17 13:47:44] [config] gradient-norm-average-window: 100
[2023-07-17 13:47:44] [config] guided-alignment: none
[2023-07-17 13:47:44] [config] guided-alignment-cost: mse
[2023-07-17 13:47:44] [config] guided-alignment-weight: 0.1
[2023-07-17 13:47:44] [config] ignore-model-config: false
[2023-07-17 13:47:44] [config] input-types:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] interpolate-env-vars: false
[2023-07-17 13:47:44] [config] keep-best: false
[2023-07-17 13:47:44] [config] label-smoothing: 0
[2023-07-17 13:47:44] [config] layer-normalization: false
[2023-07-17 13:47:44] [config] learn-rate: 0.0001
[2023-07-17 13:47:44] [config] lemma-dependency: ""
[2023-07-17 13:47:44] [config] lemma-dim-emb: 0
[2023-07-17 13:47:44] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:44] [config] log-level: info
[2023-07-17 13:47:44] [config] log-time-zone: ""
[2023-07-17 13:47:44] [config] logical-epoch:
[2023-07-17 13:47:44] [config]   - 1e
[2023-07-17 13:47:44] [config]   - 0
[2023-07-17 13:47:44] [config] lr-decay: 0
[2023-07-17 13:47:44] [config] lr-decay-freq: 50000
[2023-07-17 13:47:44] [config] lr-decay-inv-sqrt:
[2023-07-17 13:47:44] [config]   - 0
[2023-07-17 13:47:44] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:47:44] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:47:44] [config] lr-decay-start:
[2023-07-17 13:47:44] [config]   - 10
[2023-07-17 13:47:44] [config]   - 1
[2023-07-17 13:47:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:47:44] [config] lr-report: false
[2023-07-17 13:47:44] [config] lr-warmup: 0
[2023-07-17 13:47:44] [config] lr-warmup-at-reload: false
[2023-07-17 13:47:44] [config] lr-warmup-cycle: false
[2023-07-17 13:47:44] [config] lr-warmup-start-rate: 0
[2023-07-17 13:47:44] [config] max-length: 50
[2023-07-17 13:47:44] [config] max-length-crop: true
[2023-07-17 13:47:44] [config] max-length-factor: 3
[2023-07-17 13:47:44] [config] maxi-batch: 100
[2023-07-17 13:47:44] [config] maxi-batch-sort: trg
[2023-07-17 13:47:44] [config] mini-batch: 64
[2023-07-17 13:47:44] [config] mini-batch-fit: true
[2023-07-17 13:47:44] [config] mini-batch-fit-step: 10
[2023-07-17 13:47:44] [config] mini-batch-round-up: true
[2023-07-17 13:47:44] [config] mini-batch-track-lr: false
[2023-07-17 13:47:44] [config] mini-batch-warmup: 0
[2023-07-17 13:47:44] [config] mini-batch-words: 0
[2023-07-17 13:47:44] [config] mini-batch-words-ref: 0
[2023-07-17 13:47:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_enc-depth_1_dec-depth_2.npz
[2023-07-17 13:47:44] [config] multi-loss-type: sum
[2023-07-17 13:47:44] [config] n-best: false
[2023-07-17 13:47:44] [config] no-nccl: false
[2023-07-17 13:47:44] [config] no-reload: false
[2023-07-17 13:47:44] [config] no-restore-corpus: false
[2023-07-17 13:47:44] [config] normalize: 0
[2023-07-17 13:47:44] [config] normalize-gradient: false
[2023-07-17 13:47:44] [config] num-devices: 0
[2023-07-17 13:47:44] [config] optimizer: adam
[2023-07-17 13:47:44] [config] optimizer-delay: 1
[2023-07-17 13:47:44] [config] optimizer-params:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] output-omit-bias: false
[2023-07-17 13:47:44] [config] overwrite: true
[2023-07-17 13:47:44] [config] precision:
[2023-07-17 13:47:44] [config]   - float16
[2023-07-17 13:47:44] [config]   - float32
[2023-07-17 13:47:44] [config] pretrained-model: ""
[2023-07-17 13:47:44] [config] quantize-biases: false
[2023-07-17 13:47:44] [config] quantize-bits: 0
[2023-07-17 13:47:44] [config] quantize-log-based: false
[2023-07-17 13:47:44] [config] quantize-optimization-steps: 0
[2023-07-17 13:47:44] [config] quiet: false
[2023-07-17 13:47:44] [config] quiet-translation: true
[2023-07-17 13:47:44] [config] relative-paths: false
[2023-07-17 13:47:44] [config] right-left: false
[2023-07-17 13:47:44] [config] save-freq: 10000u
[2023-07-17 13:47:44] [config] seed: 1234
[2023-07-17 13:47:44] [config] sentencepiece-alphas:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:47:44] [config] sentencepiece-options: ""
[2023-07-17 13:47:44] [config] sharding: global
[2023-07-17 13:47:44] [config] shuffle: data
[2023-07-17 13:47:44] [config] shuffle-in-ram: false
[2023-07-17 13:47:44] [config] sigterm: save-and-exit
[2023-07-17 13:47:44] [config] skip: false
[2023-07-17 13:47:44] [config] sqlite: ""
[2023-07-17 13:47:44] [config] sqlite-drop: false
[2023-07-17 13:47:44] [config] sync-freq: 200u
[2023-07-17 13:47:44] [config] sync-sgd: false
[2023-07-17 13:47:44] [config] tempdir: /tmp
[2023-07-17 13:47:44] [config] tied-embeddings: false
[2023-07-17 13:47:44] [config] tied-embeddings-all: true
[2023-07-17 13:47:44] [config] tied-embeddings-src: false
[2023-07-17 13:47:44] [config] train-embedder-rank:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] train-sets:
[2023-07-17 13:47:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:47:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:47:44] [config] transformer-aan-activation: swish
[2023-07-17 13:47:44] [config] transformer-aan-depth: 2
[2023-07-17 13:47:44] [config] transformer-aan-nogate: false
[2023-07-17 13:47:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:47:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:47:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:47:44] [config] transformer-depth-scaling: false
[2023-07-17 13:47:44] [config] transformer-dim-aan: 2048
[2023-07-17 13:47:44] [config] transformer-dim-ffn: 2048
[2023-07-17 13:47:44] [config] transformer-dropout: 0
[2023-07-17 13:47:44] [config] transformer-dropout-attention: 0
[2023-07-17 13:47:44] [config] transformer-dropout-ffn: 0
[2023-07-17 13:47:44] [config] transformer-ffn-activation: swish
[2023-07-17 13:47:44] [config] transformer-ffn-depth: 2
[2023-07-17 13:47:44] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:47:44] [config] transformer-heads: 8
[2023-07-17 13:47:44] [config] transformer-no-projection: false
[2023-07-17 13:47:44] [config] transformer-pool: false
[2023-07-17 13:47:44] [config] transformer-postprocess: dan
[2023-07-17 13:47:44] [config] transformer-postprocess-emb: d
[2023-07-17 13:47:44] [config] transformer-postprocess-top: ""
[2023-07-17 13:47:44] [config] transformer-preprocess: ""
[2023-07-17 13:47:44] [config] transformer-tied-layers:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] transformer-train-position-embeddings: false
[2023-07-17 13:47:44] [config] tsv: false
[2023-07-17 13:47:44] [config] tsv-fields: 0
[2023-07-17 13:47:44] [config] type: amun
[2023-07-17 13:47:44] [config] ulr: false
[2023-07-17 13:47:44] [config] ulr-dim-emb: 0
[2023-07-17 13:47:44] [config] ulr-dropout: 0
[2023-07-17 13:47:44] [config] ulr-keys-vectors: ""
[2023-07-17 13:47:44] [config] ulr-query-vectors: ""
[2023-07-17 13:47:44] [config] ulr-softmax-temperature: 1
[2023-07-17 13:47:44] [config] ulr-trainable-transformation: false
[2023-07-17 13:47:44] [config] unlikelihood-loss: false
[2023-07-17 13:47:44] [config] valid-freq: 50000000
[2023-07-17 13:47:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:47:44] [config] valid-max-length: 1000
[2023-07-17 13:47:44] [config] valid-metrics:
[2023-07-17 13:47:44] [config]   - cross-entropy
[2023-07-17 13:47:44] [config]   - translation
[2023-07-17 13:47:44] [config] valid-mini-batch: 32
[2023-07-17 13:47:44] [config] valid-reset-stalled: false
[2023-07-17 13:47:44] [config] valid-script-args:
[2023-07-17 13:47:44] [config]   []
[2023-07-17 13:47:44] [config] valid-script-path: ""
[2023-07-17 13:47:44] [config] valid-sets:
[2023-07-17 13:47:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:47:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:47:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:47:44] [config] vocabs:
[2023-07-17 13:47:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:44] [config] word-penalty: 0
[2023-07-17 13:47:44] [config] word-scores: false
[2023-07-17 13:47:44] [config] workspace: 5500
[2023-07-17 13:47:44] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:47:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:44] [training] Using single-device training
[2023-07-17 13:47:45] Synced seed 1234
[2023-07-17 13:47:45] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:47:45] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:47:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:47:45] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:47:45] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:47:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:47:45] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:50:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:50:56] [marian] Running on node22.datos.cluster.uy as process 7583 with command line:
[2023-07-17 13:50:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:50:56] [config] after: 0e
[2023-07-17 13:50:56] [config] after-batches: 0
[2023-07-17 13:50:56] [config] after-epochs: 10
[2023-07-17 13:50:56] [config] all-caps-every: 0
[2023-07-17 13:50:56] [config] allow-unk: false
[2023-07-17 13:50:56] [config] authors: false
[2023-07-17 13:50:56] [config] beam-size: 12
[2023-07-17 13:50:56] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:50:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:50:56] [config] bert-masking-fraction: 0.15
[2023-07-17 13:50:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:50:56] [config] bert-train-type-embeddings: true
[2023-07-17 13:50:56] [config] bert-type-vocab-size: 2
[2023-07-17 13:50:56] [config] build-info: ""
[2023-07-17 13:50:56] [config] check-gradient-nan: false
[2023-07-17 13:50:56] [config] check-nan: false
[2023-07-17 13:50:56] [config] cite: false
[2023-07-17 13:50:56] [config] clip-norm: 1
[2023-07-17 13:50:56] [config] cost-scaling:
[2023-07-17 13:50:56] [config]   - 256.f
[2023-07-17 13:50:56] [config]   - 1000
[2023-07-17 13:50:56] [config]   - 2.f
[2023-07-17 13:50:56] [config]   - 256.f
[2023-07-17 13:50:56] [config] cost-type: ce-sum
[2023-07-17 13:50:56] [config] cpu-threads: 0
[2023-07-17 13:50:56] [config] data-threads: 8
[2023-07-17 13:50:56] [config] data-weighting: ""
[2023-07-17 13:50:56] [config] data-weighting-type: sentence
[2023-07-17 13:50:56] [config] dec-cell: gru
[2023-07-17 13:50:56] [config] dec-cell-base-depth: 2
[2023-07-17 13:50:56] [config] dec-cell-high-depth: 1
[2023-07-17 13:50:56] [config] dec-depth: 1
[2023-07-17 13:50:56] [config] devices:
[2023-07-17 13:50:56] [config]   - 0
[2023-07-17 13:50:56] [config] dim-emb: 512
[2023-07-17 13:50:56] [config] dim-rnn: 1024
[2023-07-17 13:50:56] [config] dim-vocabs:
[2023-07-17 13:50:56] [config]   - 16384
[2023-07-17 13:50:56] [config]   - 16384
[2023-07-17 13:50:56] [config] disp-first: 0
[2023-07-17 13:50:56] [config] disp-freq: 1000u
[2023-07-17 13:50:56] [config] disp-label-counts: true
[2023-07-17 13:50:56] [config] dropout-rnn: 0
[2023-07-17 13:50:56] [config] dropout-src: 0
[2023-07-17 13:50:56] [config] dropout-trg: 0
[2023-07-17 13:50:56] [config] dump-config: ""
[2023-07-17 13:50:56] [config] dynamic-gradient-scaling:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] early-stopping: 5
[2023-07-17 13:50:56] [config] early-stopping-on: first
[2023-07-17 13:50:56] [config] embedding-fix-src: false
[2023-07-17 13:50:56] [config] embedding-fix-trg: false
[2023-07-17 13:50:56] [config] embedding-normalization: false
[2023-07-17 13:50:56] [config] embedding-vectors:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] enc-cell: gru
[2023-07-17 13:50:56] [config] enc-cell-depth: 1
[2023-07-17 13:50:56] [config] enc-depth: 1
[2023-07-17 13:50:56] [config] enc-type: bidirectional
[2023-07-17 13:50:56] [config] english-title-case-every: 0
[2023-07-17 13:50:56] [config] exponential-smoothing: 0
[2023-07-17 13:50:56] [config] factor-weight: 1
[2023-07-17 13:50:56] [config] factors-combine: sum
[2023-07-17 13:50:56] [config] factors-dim-emb: 0
[2023-07-17 13:50:56] [config] gradient-checkpointing: false
[2023-07-17 13:50:56] [config] gradient-norm-average-window: 100
[2023-07-17 13:50:56] [config] guided-alignment: none
[2023-07-17 13:50:56] [config] guided-alignment-cost: mse
[2023-07-17 13:50:56] [config] guided-alignment-weight: 0.1
[2023-07-17 13:50:56] [config] ignore-model-config: false
[2023-07-17 13:50:56] [config] input-types:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] interpolate-env-vars: false
[2023-07-17 13:50:56] [config] keep-best: false
[2023-07-17 13:50:56] [config] label-smoothing: 0
[2023-07-17 13:50:56] [config] layer-normalization: false
[2023-07-17 13:50:56] [config] learn-rate: 0.0001
[2023-07-17 13:50:56] [config] lemma-dependency: ""
[2023-07-17 13:50:56] [config] lemma-dim-emb: 0
[2023-07-17 13:50:56] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:50:56] [config] log-level: info
[2023-07-17 13:50:56] [config] log-time-zone: ""
[2023-07-17 13:50:56] [config] logical-epoch:
[2023-07-17 13:50:56] [config]   - 1e
[2023-07-17 13:50:56] [config]   - 0
[2023-07-17 13:50:56] [config] lr-decay: 0
[2023-07-17 13:50:56] [config] lr-decay-freq: 50000
[2023-07-17 13:50:56] [config] lr-decay-inv-sqrt:
[2023-07-17 13:50:56] [config]   - 0
[2023-07-17 13:50:56] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:50:56] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:50:56] [config] lr-decay-start:
[2023-07-17 13:50:56] [config]   - 10
[2023-07-17 13:50:56] [config]   - 1
[2023-07-17 13:50:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:50:56] [config] lr-report: false
[2023-07-17 13:50:56] [config] lr-warmup: 0
[2023-07-17 13:50:56] [config] lr-warmup-at-reload: false
[2023-07-17 13:50:56] [config] lr-warmup-cycle: false
[2023-07-17 13:50:56] [config] lr-warmup-start-rate: 0
[2023-07-17 13:50:56] [config] max-length: 150
[2023-07-17 13:50:56] [config] max-length-crop: true
[2023-07-17 13:50:56] [config] max-length-factor: 3
[2023-07-17 13:50:56] [config] maxi-batch: 100
[2023-07-17 13:50:56] [config] maxi-batch-sort: trg
[2023-07-17 13:50:56] [config] mini-batch: 64
[2023-07-17 13:50:56] [config] mini-batch-fit: true
[2023-07-17 13:50:56] [config] mini-batch-fit-step: 10
[2023-07-17 13:50:56] [config] mini-batch-round-up: true
[2023-07-17 13:50:56] [config] mini-batch-track-lr: false
[2023-07-17 13:50:56] [config] mini-batch-warmup: 0
[2023-07-17 13:50:56] [config] mini-batch-words: 0
[2023-07-17 13:50:56] [config] mini-batch-words-ref: 0
[2023-07-17 13:50:56] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:50:56] [config] multi-loss-type: sum
[2023-07-17 13:50:56] [config] n-best: false
[2023-07-17 13:50:56] [config] no-nccl: false
[2023-07-17 13:50:56] [config] no-reload: false
[2023-07-17 13:50:56] [config] no-restore-corpus: false
[2023-07-17 13:50:56] [config] normalize: 0
[2023-07-17 13:50:56] [config] normalize-gradient: false
[2023-07-17 13:50:56] [config] num-devices: 0
[2023-07-17 13:50:56] [config] optimizer: adam
[2023-07-17 13:50:56] [config] optimizer-delay: 1
[2023-07-17 13:50:56] [config] optimizer-params:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] output-omit-bias: false
[2023-07-17 13:50:56] [config] overwrite: true
[2023-07-17 13:50:56] [config] precision:
[2023-07-17 13:50:56] [config]   - float16
[2023-07-17 13:50:56] [config]   - float32
[2023-07-17 13:50:56] [config] pretrained-model: ""
[2023-07-17 13:50:56] [config] quantize-biases: false
[2023-07-17 13:50:56] [config] quantize-bits: 0
[2023-07-17 13:50:56] [config] quantize-log-based: false
[2023-07-17 13:50:56] [config] quantize-optimization-steps: 0
[2023-07-17 13:50:56] [config] quiet: false
[2023-07-17 13:50:56] [config] quiet-translation: true
[2023-07-17 13:50:56] [config] relative-paths: false
[2023-07-17 13:50:56] [config] right-left: false
[2023-07-17 13:50:56] [config] save-freq: 10000u
[2023-07-17 13:50:56] [config] seed: 1234
[2023-07-17 13:50:56] [config] sentencepiece-alphas:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:50:56] [config] sentencepiece-options: ""
[2023-07-17 13:50:56] [config] sharding: global
[2023-07-17 13:50:56] [config] shuffle: data
[2023-07-17 13:50:56] [config] shuffle-in-ram: false
[2023-07-17 13:50:56] [config] sigterm: save-and-exit
[2023-07-17 13:50:56] [config] skip: false
[2023-07-17 13:50:56] [config] sqlite: ""
[2023-07-17 13:50:56] [config] sqlite-drop: false
[2023-07-17 13:50:56] [config] sync-freq: 200u
[2023-07-17 13:50:56] [config] sync-sgd: false
[2023-07-17 13:50:56] [config] tempdir: /tmp
[2023-07-17 13:50:56] [config] tied-embeddings: false
[2023-07-17 13:50:56] [config] tied-embeddings-all: true
[2023-07-17 13:50:56] [config] tied-embeddings-src: false
[2023-07-17 13:50:56] [config] train-embedder-rank:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] train-sets:
[2023-07-17 13:50:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:50:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:50:56] [config] transformer-aan-activation: swish
[2023-07-17 13:50:56] [config] transformer-aan-depth: 2
[2023-07-17 13:50:56] [config] transformer-aan-nogate: false
[2023-07-17 13:50:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:50:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:50:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:50:56] [config] transformer-depth-scaling: false
[2023-07-17 13:50:56] [config] transformer-dim-aan: 2048
[2023-07-17 13:50:56] [config] transformer-dim-ffn: 2048
[2023-07-17 13:50:56] [config] transformer-dropout: 0
[2023-07-17 13:50:56] [config] transformer-dropout-attention: 0
[2023-07-17 13:50:56] [config] transformer-dropout-ffn: 0
[2023-07-17 13:50:56] [config] transformer-ffn-activation: swish
[2023-07-17 13:50:56] [config] transformer-ffn-depth: 2
[2023-07-17 13:50:56] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:50:56] [config] transformer-heads: 8
[2023-07-17 13:50:56] [config] transformer-no-projection: false
[2023-07-17 13:50:56] [config] transformer-pool: false
[2023-07-17 13:50:56] [config] transformer-postprocess: dan
[2023-07-17 13:50:56] [config] transformer-postprocess-emb: d
[2023-07-17 13:50:56] [config] transformer-postprocess-top: ""
[2023-07-17 13:50:56] [config] transformer-preprocess: ""
[2023-07-17 13:50:56] [config] transformer-tied-layers:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] transformer-train-position-embeddings: false
[2023-07-17 13:50:56] [config] tsv: false
[2023-07-17 13:50:56] [config] tsv-fields: 0
[2023-07-17 13:50:56] [config] type: amun
[2023-07-17 13:50:56] [config] ulr: false
[2023-07-17 13:50:56] [config] ulr-dim-emb: 0
[2023-07-17 13:50:56] [config] ulr-dropout: 0
[2023-07-17 13:50:56] [config] ulr-keys-vectors: ""
[2023-07-17 13:50:56] [config] ulr-query-vectors: ""
[2023-07-17 13:50:56] [config] ulr-softmax-temperature: 1
[2023-07-17 13:50:56] [config] ulr-trainable-transformation: false
[2023-07-17 13:50:56] [config] unlikelihood-loss: false
[2023-07-17 13:50:56] [config] valid-freq: 50000000
[2023-07-17 13:50:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:50:56] [config] valid-max-length: 1000
[2023-07-17 13:50:56] [config] valid-metrics:
[2023-07-17 13:50:56] [config]   - cross-entropy
[2023-07-17 13:50:56] [config]   - translation
[2023-07-17 13:50:56] [config] valid-mini-batch: 32
[2023-07-17 13:50:56] [config] valid-reset-stalled: false
[2023-07-17 13:50:56] [config] valid-script-args:
[2023-07-17 13:50:56] [config]   []
[2023-07-17 13:50:56] [config] valid-script-path: ""
[2023-07-17 13:50:56] [config] valid-sets:
[2023-07-17 13:50:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:50:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:50:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:50:56] [config] vocabs:
[2023-07-17 13:50:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:50:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:50:56] [config] word-penalty: 0
[2023-07-17 13:50:56] [config] word-scores: false
[2023-07-17 13:50:56] [config] workspace: 5500
[2023-07-17 13:50:56] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:50:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:50:56] [training] Using single-device training
[2023-07-17 13:50:57] Synced seed 1234
[2023-07-17 13:50:57] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:50:57] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:50:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:50:57] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:50:57] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:50:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:50:57] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:50:58] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:50:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:50:58] [comm] Using global sharding
[2023-07-17 13:50:58] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:50:58] [training] Using 1 GPUs
[2023-07-17 13:50:58] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:50:58] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55aa549eef01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55aa551841fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55aa55184d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55aa55185785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55aa54e02f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55aa54e88d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55aa54e7577c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55aa5494681d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55aa54f22306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55aa54efef2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55aa54a00450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55aa549222c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55aa548d9b9c]    main                                               + 0x3c
[0x7f12226680b3]    __libc_start_main                                  + 0xf3
[0x55aa54920cbe]    _start                                             + 0x2e

[2023-07-17 13:50:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:50:59] [marian] Running on node22.datos.cluster.uy as process 7620 with command line:
[2023-07-17 13:50:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:50:59] [config] after: 0e
[2023-07-17 13:50:59] [config] after-batches: 0
[2023-07-17 13:50:59] [config] after-epochs: 20
[2023-07-17 13:50:59] [config] all-caps-every: 0
[2023-07-17 13:50:59] [config] allow-unk: false
[2023-07-17 13:50:59] [config] authors: false
[2023-07-17 13:50:59] [config] beam-size: 12
[2023-07-17 13:50:59] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:50:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:50:59] [config] bert-masking-fraction: 0.15
[2023-07-17 13:50:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:50:59] [config] bert-train-type-embeddings: true
[2023-07-17 13:50:59] [config] bert-type-vocab-size: 2
[2023-07-17 13:50:59] [config] build-info: ""
[2023-07-17 13:50:59] [config] check-gradient-nan: false
[2023-07-17 13:50:59] [config] check-nan: false
[2023-07-17 13:50:59] [config] cite: false
[2023-07-17 13:50:59] [config] clip-norm: 1
[2023-07-17 13:50:59] [config] cost-scaling:
[2023-07-17 13:50:59] [config]   - 256.f
[2023-07-17 13:50:59] [config]   - 1000
[2023-07-17 13:50:59] [config]   - 2.f
[2023-07-17 13:50:59] [config]   - 256.f
[2023-07-17 13:50:59] [config] cost-type: ce-sum
[2023-07-17 13:50:59] [config] cpu-threads: 0
[2023-07-17 13:50:59] [config] data-threads: 8
[2023-07-17 13:50:59] [config] data-weighting: ""
[2023-07-17 13:50:59] [config] data-weighting-type: sentence
[2023-07-17 13:50:59] [config] dec-cell: gru
[2023-07-17 13:50:59] [config] dec-cell-base-depth: 2
[2023-07-17 13:50:59] [config] dec-cell-high-depth: 1
[2023-07-17 13:50:59] [config] dec-depth: 1
[2023-07-17 13:50:59] [config] devices:
[2023-07-17 13:50:59] [config]   - 0
[2023-07-17 13:50:59] [config] dim-emb: 512
[2023-07-17 13:50:59] [config] dim-rnn: 1024
[2023-07-17 13:50:59] [config] dim-vocabs:
[2023-07-17 13:50:59] [config]   - 16384
[2023-07-17 13:50:59] [config]   - 16384
[2023-07-17 13:50:59] [config] disp-first: 0
[2023-07-17 13:50:59] [config] disp-freq: 1000u
[2023-07-17 13:50:59] [config] disp-label-counts: true
[2023-07-17 13:50:59] [config] dropout-rnn: 0
[2023-07-17 13:50:59] [config] dropout-src: 0
[2023-07-17 13:50:59] [config] dropout-trg: 0
[2023-07-17 13:50:59] [config] dump-config: ""
[2023-07-17 13:50:59] [config] dynamic-gradient-scaling:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] early-stopping: 5
[2023-07-17 13:50:59] [config] early-stopping-on: first
[2023-07-17 13:50:59] [config] embedding-fix-src: false
[2023-07-17 13:50:59] [config] embedding-fix-trg: false
[2023-07-17 13:50:59] [config] embedding-normalization: false
[2023-07-17 13:50:59] [config] embedding-vectors:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] enc-cell: gru
[2023-07-17 13:50:59] [config] enc-cell-depth: 1
[2023-07-17 13:50:59] [config] enc-depth: 1
[2023-07-17 13:50:59] [config] enc-type: bidirectional
[2023-07-17 13:50:59] [config] english-title-case-every: 0
[2023-07-17 13:50:59] [config] exponential-smoothing: 0
[2023-07-17 13:50:59] [config] factor-weight: 1
[2023-07-17 13:50:59] [config] factors-combine: sum
[2023-07-17 13:50:59] [config] factors-dim-emb: 0
[2023-07-17 13:50:59] [config] gradient-checkpointing: false
[2023-07-17 13:50:59] [config] gradient-norm-average-window: 100
[2023-07-17 13:50:59] [config] guided-alignment: none
[2023-07-17 13:50:59] [config] guided-alignment-cost: mse
[2023-07-17 13:50:59] [config] guided-alignment-weight: 0.1
[2023-07-17 13:50:59] [config] ignore-model-config: false
[2023-07-17 13:50:59] [config] input-types:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] interpolate-env-vars: false
[2023-07-17 13:50:59] [config] keep-best: false
[2023-07-17 13:50:59] [config] label-smoothing: 0
[2023-07-17 13:50:59] [config] layer-normalization: false
[2023-07-17 13:50:59] [config] learn-rate: 0.0001
[2023-07-17 13:50:59] [config] lemma-dependency: ""
[2023-07-17 13:50:59] [config] lemma-dim-emb: 0
[2023-07-17 13:50:59] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:50:59] [config] log-level: info
[2023-07-17 13:50:59] [config] log-time-zone: ""
[2023-07-17 13:50:59] [config] logical-epoch:
[2023-07-17 13:50:59] [config]   - 1e
[2023-07-17 13:50:59] [config]   - 0
[2023-07-17 13:50:59] [config] lr-decay: 0
[2023-07-17 13:50:59] [config] lr-decay-freq: 50000
[2023-07-17 13:50:59] [config] lr-decay-inv-sqrt:
[2023-07-17 13:50:59] [config]   - 0
[2023-07-17 13:50:59] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:50:59] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:50:59] [config] lr-decay-start:
[2023-07-17 13:50:59] [config]   - 10
[2023-07-17 13:50:59] [config]   - 1
[2023-07-17 13:50:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:50:59] [config] lr-report: false
[2023-07-17 13:50:59] [config] lr-warmup: 0
[2023-07-17 13:50:59] [config] lr-warmup-at-reload: false
[2023-07-17 13:50:59] [config] lr-warmup-cycle: false
[2023-07-17 13:50:59] [config] lr-warmup-start-rate: 0
[2023-07-17 13:50:59] [config] max-length: 150
[2023-07-17 13:50:59] [config] max-length-crop: true
[2023-07-17 13:50:59] [config] max-length-factor: 3
[2023-07-17 13:50:59] [config] maxi-batch: 100
[2023-07-17 13:50:59] [config] maxi-batch-sort: trg
[2023-07-17 13:50:59] [config] mini-batch: 64
[2023-07-17 13:50:59] [config] mini-batch-fit: true
[2023-07-17 13:50:59] [config] mini-batch-fit-step: 10
[2023-07-17 13:50:59] [config] mini-batch-round-up: true
[2023-07-17 13:50:59] [config] mini-batch-track-lr: false
[2023-07-17 13:50:59] [config] mini-batch-warmup: 0
[2023-07-17 13:50:59] [config] mini-batch-words: 0
[2023-07-17 13:50:59] [config] mini-batch-words-ref: 0
[2023-07-17 13:50:59] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:50:59] [config] multi-loss-type: sum
[2023-07-17 13:50:59] [config] n-best: false
[2023-07-17 13:50:59] [config] no-nccl: false
[2023-07-17 13:50:59] [config] no-reload: false
[2023-07-17 13:50:59] [config] no-restore-corpus: false
[2023-07-17 13:50:59] [config] normalize: 0
[2023-07-17 13:50:59] [config] normalize-gradient: false
[2023-07-17 13:50:59] [config] num-devices: 0
[2023-07-17 13:50:59] [config] optimizer: adam
[2023-07-17 13:50:59] [config] optimizer-delay: 1
[2023-07-17 13:50:59] [config] optimizer-params:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] output-omit-bias: false
[2023-07-17 13:50:59] [config] overwrite: true
[2023-07-17 13:50:59] [config] precision:
[2023-07-17 13:50:59] [config]   - float16
[2023-07-17 13:50:59] [config]   - float32
[2023-07-17 13:50:59] [config] pretrained-model: ""
[2023-07-17 13:50:59] [config] quantize-biases: false
[2023-07-17 13:50:59] [config] quantize-bits: 0
[2023-07-17 13:50:59] [config] quantize-log-based: false
[2023-07-17 13:50:59] [config] quantize-optimization-steps: 0
[2023-07-17 13:50:59] [config] quiet: false
[2023-07-17 13:50:59] [config] quiet-translation: true
[2023-07-17 13:50:59] [config] relative-paths: false
[2023-07-17 13:50:59] [config] right-left: false
[2023-07-17 13:50:59] [config] save-freq: 10000u
[2023-07-17 13:50:59] [config] seed: 1234
[2023-07-17 13:50:59] [config] sentencepiece-alphas:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:50:59] [config] sentencepiece-options: ""
[2023-07-17 13:50:59] [config] sharding: global
[2023-07-17 13:50:59] [config] shuffle: data
[2023-07-17 13:50:59] [config] shuffle-in-ram: false
[2023-07-17 13:50:59] [config] sigterm: save-and-exit
[2023-07-17 13:50:59] [config] skip: false
[2023-07-17 13:50:59] [config] sqlite: ""
[2023-07-17 13:50:59] [config] sqlite-drop: false
[2023-07-17 13:50:59] [config] sync-freq: 200u
[2023-07-17 13:50:59] [config] sync-sgd: false
[2023-07-17 13:50:59] [config] tempdir: /tmp
[2023-07-17 13:50:59] [config] tied-embeddings: false
[2023-07-17 13:50:59] [config] tied-embeddings-all: true
[2023-07-17 13:50:59] [config] tied-embeddings-src: false
[2023-07-17 13:50:59] [config] train-embedder-rank:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] train-sets:
[2023-07-17 13:50:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:50:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:50:59] [config] transformer-aan-activation: swish
[2023-07-17 13:50:59] [config] transformer-aan-depth: 2
[2023-07-17 13:50:59] [config] transformer-aan-nogate: false
[2023-07-17 13:50:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:50:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:50:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:50:59] [config] transformer-depth-scaling: false
[2023-07-17 13:50:59] [config] transformer-dim-aan: 2048
[2023-07-17 13:50:59] [config] transformer-dim-ffn: 2048
[2023-07-17 13:50:59] [config] transformer-dropout: 0
[2023-07-17 13:50:59] [config] transformer-dropout-attention: 0
[2023-07-17 13:50:59] [config] transformer-dropout-ffn: 0
[2023-07-17 13:50:59] [config] transformer-ffn-activation: swish
[2023-07-17 13:50:59] [config] transformer-ffn-depth: 2
[2023-07-17 13:50:59] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:50:59] [config] transformer-heads: 8
[2023-07-17 13:50:59] [config] transformer-no-projection: false
[2023-07-17 13:50:59] [config] transformer-pool: false
[2023-07-17 13:50:59] [config] transformer-postprocess: dan
[2023-07-17 13:50:59] [config] transformer-postprocess-emb: d
[2023-07-17 13:50:59] [config] transformer-postprocess-top: ""
[2023-07-17 13:50:59] [config] transformer-preprocess: ""
[2023-07-17 13:50:59] [config] transformer-tied-layers:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] transformer-train-position-embeddings: false
[2023-07-17 13:50:59] [config] tsv: false
[2023-07-17 13:50:59] [config] tsv-fields: 0
[2023-07-17 13:50:59] [config] type: amun
[2023-07-17 13:50:59] [config] ulr: false
[2023-07-17 13:50:59] [config] ulr-dim-emb: 0
[2023-07-17 13:50:59] [config] ulr-dropout: 0
[2023-07-17 13:50:59] [config] ulr-keys-vectors: ""
[2023-07-17 13:50:59] [config] ulr-query-vectors: ""
[2023-07-17 13:50:59] [config] ulr-softmax-temperature: 1
[2023-07-17 13:50:59] [config] ulr-trainable-transformation: false
[2023-07-17 13:50:59] [config] unlikelihood-loss: false
[2023-07-17 13:50:59] [config] valid-freq: 50000000
[2023-07-17 13:50:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:50:59] [config] valid-max-length: 1000
[2023-07-17 13:50:59] [config] valid-metrics:
[2023-07-17 13:50:59] [config]   - cross-entropy
[2023-07-17 13:50:59] [config]   - translation
[2023-07-17 13:50:59] [config] valid-mini-batch: 32
[2023-07-17 13:50:59] [config] valid-reset-stalled: false
[2023-07-17 13:50:59] [config] valid-script-args:
[2023-07-17 13:50:59] [config]   []
[2023-07-17 13:50:59] [config] valid-script-path: ""
[2023-07-17 13:50:59] [config] valid-sets:
[2023-07-17 13:50:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:50:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:50:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:50:59] [config] vocabs:
[2023-07-17 13:50:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:50:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:50:59] [config] word-penalty: 0
[2023-07-17 13:50:59] [config] word-scores: false
[2023-07-17 13:50:59] [config] workspace: 5500
[2023-07-17 13:50:59] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:50:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:50:59] [training] Using single-device training
[2023-07-17 13:51:00] Synced seed 1234
[2023-07-17 13:51:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:00] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:01] [comm] Using global sharding
[2023-07-17 13:51:01] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:01] [training] Using 1 GPUs
[2023-07-17 13:51:01] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:01] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x5639ad85bf01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5639adff11fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5639adff1d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5639adff2785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x5639adc6ff3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5639adcf5d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x5639adce277c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x5639ad7b381d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x5639add8f306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x5639add6bf2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x5639ad86d450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5639ad78f2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5639ad746b9c]    main                                               + 0x3c
[0x7fa67ea0f0b3]    __libc_start_main                                  + 0xf3
[0x5639ad78dcbe]    _start                                             + 0x2e

[2023-07-17 13:51:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:02] [marian] Running on node22.datos.cluster.uy as process 7650 with command line:
[2023-07-17 13:51:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:02] [config] after: 0e
[2023-07-17 13:51:02] [config] after-batches: 0
[2023-07-17 13:51:02] [config] after-epochs: 30
[2023-07-17 13:51:02] [config] all-caps-every: 0
[2023-07-17 13:51:02] [config] allow-unk: false
[2023-07-17 13:51:02] [config] authors: false
[2023-07-17 13:51:02] [config] beam-size: 12
[2023-07-17 13:51:02] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:02] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:02] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:02] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:02] [config] build-info: ""
[2023-07-17 13:51:02] [config] check-gradient-nan: false
[2023-07-17 13:51:02] [config] check-nan: false
[2023-07-17 13:51:02] [config] cite: false
[2023-07-17 13:51:02] [config] clip-norm: 1
[2023-07-17 13:51:02] [config] cost-scaling:
[2023-07-17 13:51:02] [config]   - 256.f
[2023-07-17 13:51:02] [config]   - 1000
[2023-07-17 13:51:02] [config]   - 2.f
[2023-07-17 13:51:02] [config]   - 256.f
[2023-07-17 13:51:02] [config] cost-type: ce-sum
[2023-07-17 13:51:02] [config] cpu-threads: 0
[2023-07-17 13:51:02] [config] data-threads: 8
[2023-07-17 13:51:02] [config] data-weighting: ""
[2023-07-17 13:51:02] [config] data-weighting-type: sentence
[2023-07-17 13:51:02] [config] dec-cell: gru
[2023-07-17 13:51:02] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:02] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:02] [config] dec-depth: 1
[2023-07-17 13:51:02] [config] devices:
[2023-07-17 13:51:02] [config]   - 0
[2023-07-17 13:51:02] [config] dim-emb: 512
[2023-07-17 13:51:02] [config] dim-rnn: 1024
[2023-07-17 13:51:02] [config] dim-vocabs:
[2023-07-17 13:51:02] [config]   - 16384
[2023-07-17 13:51:02] [config]   - 16384
[2023-07-17 13:51:02] [config] disp-first: 0
[2023-07-17 13:51:02] [config] disp-freq: 1000u
[2023-07-17 13:51:02] [config] disp-label-counts: true
[2023-07-17 13:51:02] [config] dropout-rnn: 0
[2023-07-17 13:51:02] [config] dropout-src: 0
[2023-07-17 13:51:02] [config] dropout-trg: 0
[2023-07-17 13:51:02] [config] dump-config: ""
[2023-07-17 13:51:02] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] early-stopping: 5
[2023-07-17 13:51:02] [config] early-stopping-on: first
[2023-07-17 13:51:02] [config] embedding-fix-src: false
[2023-07-17 13:51:02] [config] embedding-fix-trg: false
[2023-07-17 13:51:02] [config] embedding-normalization: false
[2023-07-17 13:51:02] [config] embedding-vectors:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] enc-cell: gru
[2023-07-17 13:51:02] [config] enc-cell-depth: 1
[2023-07-17 13:51:02] [config] enc-depth: 1
[2023-07-17 13:51:02] [config] enc-type: bidirectional
[2023-07-17 13:51:02] [config] english-title-case-every: 0
[2023-07-17 13:51:02] [config] exponential-smoothing: 0
[2023-07-17 13:51:02] [config] factor-weight: 1
[2023-07-17 13:51:02] [config] factors-combine: sum
[2023-07-17 13:51:02] [config] factors-dim-emb: 0
[2023-07-17 13:51:02] [config] gradient-checkpointing: false
[2023-07-17 13:51:02] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:02] [config] guided-alignment: none
[2023-07-17 13:51:02] [config] guided-alignment-cost: mse
[2023-07-17 13:51:02] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:02] [config] ignore-model-config: false
[2023-07-17 13:51:02] [config] input-types:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] interpolate-env-vars: false
[2023-07-17 13:51:02] [config] keep-best: false
[2023-07-17 13:51:02] [config] label-smoothing: 0
[2023-07-17 13:51:02] [config] layer-normalization: false
[2023-07-17 13:51:02] [config] learn-rate: 0.0001
[2023-07-17 13:51:02] [config] lemma-dependency: ""
[2023-07-17 13:51:02] [config] lemma-dim-emb: 0
[2023-07-17 13:51:02] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:02] [config] log-level: info
[2023-07-17 13:51:02] [config] log-time-zone: ""
[2023-07-17 13:51:02] [config] logical-epoch:
[2023-07-17 13:51:02] [config]   - 1e
[2023-07-17 13:51:02] [config]   - 0
[2023-07-17 13:51:02] [config] lr-decay: 0
[2023-07-17 13:51:02] [config] lr-decay-freq: 50000
[2023-07-17 13:51:02] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:02] [config]   - 0
[2023-07-17 13:51:02] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:02] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:02] [config] lr-decay-start:
[2023-07-17 13:51:02] [config]   - 10
[2023-07-17 13:51:02] [config]   - 1
[2023-07-17 13:51:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:02] [config] lr-report: false
[2023-07-17 13:51:02] [config] lr-warmup: 0
[2023-07-17 13:51:02] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:02] [config] lr-warmup-cycle: false
[2023-07-17 13:51:02] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:02] [config] max-length: 150
[2023-07-17 13:51:02] [config] max-length-crop: true
[2023-07-17 13:51:02] [config] max-length-factor: 3
[2023-07-17 13:51:02] [config] maxi-batch: 100
[2023-07-17 13:51:02] [config] maxi-batch-sort: trg
[2023-07-17 13:51:02] [config] mini-batch: 64
[2023-07-17 13:51:02] [config] mini-batch-fit: true
[2023-07-17 13:51:02] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:02] [config] mini-batch-round-up: true
[2023-07-17 13:51:02] [config] mini-batch-track-lr: false
[2023-07-17 13:51:02] [config] mini-batch-warmup: 0
[2023-07-17 13:51:02] [config] mini-batch-words: 0
[2023-07-17 13:51:02] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:02] [config] multi-loss-type: sum
[2023-07-17 13:51:02] [config] n-best: false
[2023-07-17 13:51:02] [config] no-nccl: false
[2023-07-17 13:51:02] [config] no-reload: false
[2023-07-17 13:51:02] [config] no-restore-corpus: false
[2023-07-17 13:51:02] [config] normalize: 0
[2023-07-17 13:51:02] [config] normalize-gradient: false
[2023-07-17 13:51:02] [config] num-devices: 0
[2023-07-17 13:51:02] [config] optimizer: adam
[2023-07-17 13:51:02] [config] optimizer-delay: 1
[2023-07-17 13:51:02] [config] optimizer-params:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] output-omit-bias: false
[2023-07-17 13:51:02] [config] overwrite: true
[2023-07-17 13:51:02] [config] precision:
[2023-07-17 13:51:02] [config]   - float16
[2023-07-17 13:51:02] [config]   - float32
[2023-07-17 13:51:02] [config] pretrained-model: ""
[2023-07-17 13:51:02] [config] quantize-biases: false
[2023-07-17 13:51:02] [config] quantize-bits: 0
[2023-07-17 13:51:02] [config] quantize-log-based: false
[2023-07-17 13:51:02] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:02] [config] quiet: false
[2023-07-17 13:51:02] [config] quiet-translation: true
[2023-07-17 13:51:02] [config] relative-paths: false
[2023-07-17 13:51:02] [config] right-left: false
[2023-07-17 13:51:02] [config] save-freq: 10000u
[2023-07-17 13:51:02] [config] seed: 1234
[2023-07-17 13:51:02] [config] sentencepiece-alphas:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:02] [config] sentencepiece-options: ""
[2023-07-17 13:51:02] [config] sharding: global
[2023-07-17 13:51:02] [config] shuffle: data
[2023-07-17 13:51:02] [config] shuffle-in-ram: false
[2023-07-17 13:51:02] [config] sigterm: save-and-exit
[2023-07-17 13:51:02] [config] skip: false
[2023-07-17 13:51:02] [config] sqlite: ""
[2023-07-17 13:51:02] [config] sqlite-drop: false
[2023-07-17 13:51:02] [config] sync-freq: 200u
[2023-07-17 13:51:02] [config] sync-sgd: false
[2023-07-17 13:51:02] [config] tempdir: /tmp
[2023-07-17 13:51:02] [config] tied-embeddings: false
[2023-07-17 13:51:02] [config] tied-embeddings-all: true
[2023-07-17 13:51:02] [config] tied-embeddings-src: false
[2023-07-17 13:51:02] [config] train-embedder-rank:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] train-sets:
[2023-07-17 13:51:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:02] [config] transformer-aan-activation: swish
[2023-07-17 13:51:02] [config] transformer-aan-depth: 2
[2023-07-17 13:51:02] [config] transformer-aan-nogate: false
[2023-07-17 13:51:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:02] [config] transformer-depth-scaling: false
[2023-07-17 13:51:02] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:02] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:02] [config] transformer-dropout: 0
[2023-07-17 13:51:02] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:02] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:02] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:02] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:02] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:02] [config] transformer-heads: 8
[2023-07-17 13:51:02] [config] transformer-no-projection: false
[2023-07-17 13:51:02] [config] transformer-pool: false
[2023-07-17 13:51:02] [config] transformer-postprocess: dan
[2023-07-17 13:51:02] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:02] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:02] [config] transformer-preprocess: ""
[2023-07-17 13:51:02] [config] transformer-tied-layers:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:02] [config] tsv: false
[2023-07-17 13:51:02] [config] tsv-fields: 0
[2023-07-17 13:51:02] [config] type: amun
[2023-07-17 13:51:02] [config] ulr: false
[2023-07-17 13:51:02] [config] ulr-dim-emb: 0
[2023-07-17 13:51:02] [config] ulr-dropout: 0
[2023-07-17 13:51:02] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:02] [config] ulr-query-vectors: ""
[2023-07-17 13:51:02] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:02] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:02] [config] unlikelihood-loss: false
[2023-07-17 13:51:02] [config] valid-freq: 50000000
[2023-07-17 13:51:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:02] [config] valid-max-length: 1000
[2023-07-17 13:51:02] [config] valid-metrics:
[2023-07-17 13:51:02] [config]   - cross-entropy
[2023-07-17 13:51:02] [config]   - translation
[2023-07-17 13:51:02] [config] valid-mini-batch: 32
[2023-07-17 13:51:02] [config] valid-reset-stalled: false
[2023-07-17 13:51:02] [config] valid-script-args:
[2023-07-17 13:51:02] [config]   []
[2023-07-17 13:51:02] [config] valid-script-path: ""
[2023-07-17 13:51:02] [config] valid-sets:
[2023-07-17 13:51:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:02] [config] vocabs:
[2023-07-17 13:51:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:02] [config] word-penalty: 0
[2023-07-17 13:51:02] [config] word-scores: false
[2023-07-17 13:51:02] [config] workspace: 5500
[2023-07-17 13:51:02] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:02] [training] Using single-device training
[2023-07-17 13:51:02] Synced seed 1234
[2023-07-17 13:51:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:02] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:02] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:04] [comm] Using global sharding
[2023-07-17 13:51:04] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:04] [training] Using 1 GPUs
[2023-07-17 13:51:04] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:04] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55a5b965ff01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55a5b9df51fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55a5b9df5d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55a5b9df6785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55a5b9a73f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55a5b9af9d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55a5b9ae677c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55a5b95b781d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55a5b9b93306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55a5b9b6ff2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55a5b9671450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55a5b95932c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a5b954ab9c]    main                                               + 0x3c
[0x7f7ac4d850b3]    __libc_start_main                                  + 0xf3
[0x55a5b9591cbe]    _start                                             + 0x2e

[2023-07-17 13:51:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:05] [marian] Running on node22.datos.cluster.uy as process 7681 with command line:
[2023-07-17 13:51:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:05] [config] after: 0e
[2023-07-17 13:51:05] [config] after-batches: 0
[2023-07-17 13:51:05] [config] after-epochs: 40
[2023-07-17 13:51:05] [config] all-caps-every: 0
[2023-07-17 13:51:05] [config] allow-unk: false
[2023-07-17 13:51:05] [config] authors: false
[2023-07-17 13:51:05] [config] beam-size: 12
[2023-07-17 13:51:05] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:05] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:05] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:05] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:05] [config] build-info: ""
[2023-07-17 13:51:05] [config] check-gradient-nan: false
[2023-07-17 13:51:05] [config] check-nan: false
[2023-07-17 13:51:05] [config] cite: false
[2023-07-17 13:51:05] [config] clip-norm: 1
[2023-07-17 13:51:05] [config] cost-scaling:
[2023-07-17 13:51:05] [config]   - 256.f
[2023-07-17 13:51:05] [config]   - 1000
[2023-07-17 13:51:05] [config]   - 2.f
[2023-07-17 13:51:05] [config]   - 256.f
[2023-07-17 13:51:05] [config] cost-type: ce-sum
[2023-07-17 13:51:05] [config] cpu-threads: 0
[2023-07-17 13:51:05] [config] data-threads: 8
[2023-07-17 13:51:05] [config] data-weighting: ""
[2023-07-17 13:51:05] [config] data-weighting-type: sentence
[2023-07-17 13:51:05] [config] dec-cell: gru
[2023-07-17 13:51:05] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:05] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:05] [config] dec-depth: 1
[2023-07-17 13:51:05] [config] devices:
[2023-07-17 13:51:05] [config]   - 0
[2023-07-17 13:51:05] [config] dim-emb: 512
[2023-07-17 13:51:05] [config] dim-rnn: 1024
[2023-07-17 13:51:05] [config] dim-vocabs:
[2023-07-17 13:51:05] [config]   - 16384
[2023-07-17 13:51:05] [config]   - 16384
[2023-07-17 13:51:05] [config] disp-first: 0
[2023-07-17 13:51:05] [config] disp-freq: 1000u
[2023-07-17 13:51:05] [config] disp-label-counts: true
[2023-07-17 13:51:05] [config] dropout-rnn: 0
[2023-07-17 13:51:05] [config] dropout-src: 0
[2023-07-17 13:51:05] [config] dropout-trg: 0
[2023-07-17 13:51:05] [config] dump-config: ""
[2023-07-17 13:51:05] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] early-stopping: 5
[2023-07-17 13:51:05] [config] early-stopping-on: first
[2023-07-17 13:51:05] [config] embedding-fix-src: false
[2023-07-17 13:51:05] [config] embedding-fix-trg: false
[2023-07-17 13:51:05] [config] embedding-normalization: false
[2023-07-17 13:51:05] [config] embedding-vectors:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] enc-cell: gru
[2023-07-17 13:51:05] [config] enc-cell-depth: 1
[2023-07-17 13:51:05] [config] enc-depth: 1
[2023-07-17 13:51:05] [config] enc-type: bidirectional
[2023-07-17 13:51:05] [config] english-title-case-every: 0
[2023-07-17 13:51:05] [config] exponential-smoothing: 0
[2023-07-17 13:51:05] [config] factor-weight: 1
[2023-07-17 13:51:05] [config] factors-combine: sum
[2023-07-17 13:51:05] [config] factors-dim-emb: 0
[2023-07-17 13:51:05] [config] gradient-checkpointing: false
[2023-07-17 13:51:05] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:05] [config] guided-alignment: none
[2023-07-17 13:51:05] [config] guided-alignment-cost: mse
[2023-07-17 13:51:05] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:05] [config] ignore-model-config: false
[2023-07-17 13:51:05] [config] input-types:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] interpolate-env-vars: false
[2023-07-17 13:51:05] [config] keep-best: false
[2023-07-17 13:51:05] [config] label-smoothing: 0
[2023-07-17 13:51:05] [config] layer-normalization: false
[2023-07-17 13:51:05] [config] learn-rate: 0.0001
[2023-07-17 13:51:05] [config] lemma-dependency: ""
[2023-07-17 13:51:05] [config] lemma-dim-emb: 0
[2023-07-17 13:51:05] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:05] [config] log-level: info
[2023-07-17 13:51:05] [config] log-time-zone: ""
[2023-07-17 13:51:05] [config] logical-epoch:
[2023-07-17 13:51:05] [config]   - 1e
[2023-07-17 13:51:05] [config]   - 0
[2023-07-17 13:51:05] [config] lr-decay: 0
[2023-07-17 13:51:05] [config] lr-decay-freq: 50000
[2023-07-17 13:51:05] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:05] [config]   - 0
[2023-07-17 13:51:05] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:05] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:05] [config] lr-decay-start:
[2023-07-17 13:51:05] [config]   - 10
[2023-07-17 13:51:05] [config]   - 1
[2023-07-17 13:51:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:05] [config] lr-report: false
[2023-07-17 13:51:05] [config] lr-warmup: 0
[2023-07-17 13:51:05] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:05] [config] lr-warmup-cycle: false
[2023-07-17 13:51:05] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:05] [config] max-length: 150
[2023-07-17 13:51:05] [config] max-length-crop: true
[2023-07-17 13:51:05] [config] max-length-factor: 3
[2023-07-17 13:51:05] [config] maxi-batch: 100
[2023-07-17 13:51:05] [config] maxi-batch-sort: trg
[2023-07-17 13:51:05] [config] mini-batch: 64
[2023-07-17 13:51:05] [config] mini-batch-fit: true
[2023-07-17 13:51:05] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:05] [config] mini-batch-round-up: true
[2023-07-17 13:51:05] [config] mini-batch-track-lr: false
[2023-07-17 13:51:05] [config] mini-batch-warmup: 0
[2023-07-17 13:51:05] [config] mini-batch-words: 0
[2023-07-17 13:51:05] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:05] [config] multi-loss-type: sum
[2023-07-17 13:51:05] [config] n-best: false
[2023-07-17 13:51:05] [config] no-nccl: false
[2023-07-17 13:51:05] [config] no-reload: false
[2023-07-17 13:51:05] [config] no-restore-corpus: false
[2023-07-17 13:51:05] [config] normalize: 0
[2023-07-17 13:51:05] [config] normalize-gradient: false
[2023-07-17 13:51:05] [config] num-devices: 0
[2023-07-17 13:51:05] [config] optimizer: adam
[2023-07-17 13:51:05] [config] optimizer-delay: 1
[2023-07-17 13:51:05] [config] optimizer-params:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] output-omit-bias: false
[2023-07-17 13:51:05] [config] overwrite: true
[2023-07-17 13:51:05] [config] precision:
[2023-07-17 13:51:05] [config]   - float16
[2023-07-17 13:51:05] [config]   - float32
[2023-07-17 13:51:05] [config] pretrained-model: ""
[2023-07-17 13:51:05] [config] quantize-biases: false
[2023-07-17 13:51:05] [config] quantize-bits: 0
[2023-07-17 13:51:05] [config] quantize-log-based: false
[2023-07-17 13:51:05] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:05] [config] quiet: false
[2023-07-17 13:51:05] [config] quiet-translation: true
[2023-07-17 13:51:05] [config] relative-paths: false
[2023-07-17 13:51:05] [config] right-left: false
[2023-07-17 13:51:05] [config] save-freq: 10000u
[2023-07-17 13:51:05] [config] seed: 1234
[2023-07-17 13:51:05] [config] sentencepiece-alphas:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:05] [config] sentencepiece-options: ""
[2023-07-17 13:51:05] [config] sharding: global
[2023-07-17 13:51:05] [config] shuffle: data
[2023-07-17 13:51:05] [config] shuffle-in-ram: false
[2023-07-17 13:51:05] [config] sigterm: save-and-exit
[2023-07-17 13:51:05] [config] skip: false
[2023-07-17 13:51:05] [config] sqlite: ""
[2023-07-17 13:51:05] [config] sqlite-drop: false
[2023-07-17 13:51:05] [config] sync-freq: 200u
[2023-07-17 13:51:05] [config] sync-sgd: false
[2023-07-17 13:51:05] [config] tempdir: /tmp
[2023-07-17 13:51:05] [config] tied-embeddings: false
[2023-07-17 13:51:05] [config] tied-embeddings-all: true
[2023-07-17 13:51:05] [config] tied-embeddings-src: false
[2023-07-17 13:51:05] [config] train-embedder-rank:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] train-sets:
[2023-07-17 13:51:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:05] [config] transformer-aan-activation: swish
[2023-07-17 13:51:05] [config] transformer-aan-depth: 2
[2023-07-17 13:51:05] [config] transformer-aan-nogate: false
[2023-07-17 13:51:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:05] [config] transformer-depth-scaling: false
[2023-07-17 13:51:05] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:05] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:05] [config] transformer-dropout: 0
[2023-07-17 13:51:05] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:05] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:05] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:05] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:05] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:05] [config] transformer-heads: 8
[2023-07-17 13:51:05] [config] transformer-no-projection: false
[2023-07-17 13:51:05] [config] transformer-pool: false
[2023-07-17 13:51:05] [config] transformer-postprocess: dan
[2023-07-17 13:51:05] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:05] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:05] [config] transformer-preprocess: ""
[2023-07-17 13:51:05] [config] transformer-tied-layers:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:05] [config] tsv: false
[2023-07-17 13:51:05] [config] tsv-fields: 0
[2023-07-17 13:51:05] [config] type: amun
[2023-07-17 13:51:05] [config] ulr: false
[2023-07-17 13:51:05] [config] ulr-dim-emb: 0
[2023-07-17 13:51:05] [config] ulr-dropout: 0
[2023-07-17 13:51:05] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:05] [config] ulr-query-vectors: ""
[2023-07-17 13:51:05] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:05] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:05] [config] unlikelihood-loss: false
[2023-07-17 13:51:05] [config] valid-freq: 50000000
[2023-07-17 13:51:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:05] [config] valid-max-length: 1000
[2023-07-17 13:51:05] [config] valid-metrics:
[2023-07-17 13:51:05] [config]   - cross-entropy
[2023-07-17 13:51:05] [config]   - translation
[2023-07-17 13:51:05] [config] valid-mini-batch: 32
[2023-07-17 13:51:05] [config] valid-reset-stalled: false
[2023-07-17 13:51:05] [config] valid-script-args:
[2023-07-17 13:51:05] [config]   []
[2023-07-17 13:51:05] [config] valid-script-path: ""
[2023-07-17 13:51:05] [config] valid-sets:
[2023-07-17 13:51:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:05] [config] vocabs:
[2023-07-17 13:51:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:05] [config] word-penalty: 0
[2023-07-17 13:51:05] [config] word-scores: false
[2023-07-17 13:51:05] [config] workspace: 5500
[2023-07-17 13:51:05] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:05] [training] Using single-device training
[2023-07-17 13:51:05] Synced seed 1234
[2023-07-17 13:51:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:05] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:06] [comm] Using global sharding
[2023-07-17 13:51:07] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:07] [training] Using 1 GPUs
[2023-07-17 13:51:07] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:07] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x555a53268f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x555a539fe1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x555a539fed6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x555a539ff785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x555a5367cf3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x555a53702d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x555a536ef77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x555a531c081d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x555a5379c306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x555a53778f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x555a5327a450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x555a5319c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x555a53153b9c]    main                                               + 0x3c
[0x7ff1e45410b3]    __libc_start_main                                  + 0xf3
[0x555a5319acbe]    _start                                             + 0x2e

[2023-07-17 13:51:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:08] [marian] Running on node22.datos.cluster.uy as process 7711 with command line:
[2023-07-17 13:51:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:08] [config] after: 0e
[2023-07-17 13:51:08] [config] after-batches: 0
[2023-07-17 13:51:08] [config] after-epochs: 50
[2023-07-17 13:51:08] [config] all-caps-every: 0
[2023-07-17 13:51:08] [config] allow-unk: false
[2023-07-17 13:51:08] [config] authors: false
[2023-07-17 13:51:08] [config] beam-size: 12
[2023-07-17 13:51:08] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:08] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:08] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:08] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:08] [config] build-info: ""
[2023-07-17 13:51:08] [config] check-gradient-nan: false
[2023-07-17 13:51:08] [config] check-nan: false
[2023-07-17 13:51:08] [config] cite: false
[2023-07-17 13:51:08] [config] clip-norm: 1
[2023-07-17 13:51:08] [config] cost-scaling:
[2023-07-17 13:51:08] [config]   - 256.f
[2023-07-17 13:51:08] [config]   - 1000
[2023-07-17 13:51:08] [config]   - 2.f
[2023-07-17 13:51:08] [config]   - 256.f
[2023-07-17 13:51:08] [config] cost-type: ce-sum
[2023-07-17 13:51:08] [config] cpu-threads: 0
[2023-07-17 13:51:08] [config] data-threads: 8
[2023-07-17 13:51:08] [config] data-weighting: ""
[2023-07-17 13:51:08] [config] data-weighting-type: sentence
[2023-07-17 13:51:08] [config] dec-cell: gru
[2023-07-17 13:51:08] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:08] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:08] [config] dec-depth: 1
[2023-07-17 13:51:08] [config] devices:
[2023-07-17 13:51:08] [config]   - 0
[2023-07-17 13:51:08] [config] dim-emb: 512
[2023-07-17 13:51:08] [config] dim-rnn: 1024
[2023-07-17 13:51:08] [config] dim-vocabs:
[2023-07-17 13:51:08] [config]   - 16384
[2023-07-17 13:51:08] [config]   - 16384
[2023-07-17 13:51:08] [config] disp-first: 0
[2023-07-17 13:51:08] [config] disp-freq: 1000u
[2023-07-17 13:51:08] [config] disp-label-counts: true
[2023-07-17 13:51:08] [config] dropout-rnn: 0
[2023-07-17 13:51:08] [config] dropout-src: 0
[2023-07-17 13:51:08] [config] dropout-trg: 0
[2023-07-17 13:51:08] [config] dump-config: ""
[2023-07-17 13:51:08] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] early-stopping: 5
[2023-07-17 13:51:08] [config] early-stopping-on: first
[2023-07-17 13:51:08] [config] embedding-fix-src: false
[2023-07-17 13:51:08] [config] embedding-fix-trg: false
[2023-07-17 13:51:08] [config] embedding-normalization: false
[2023-07-17 13:51:08] [config] embedding-vectors:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] enc-cell: gru
[2023-07-17 13:51:08] [config] enc-cell-depth: 1
[2023-07-17 13:51:08] [config] enc-depth: 1
[2023-07-17 13:51:08] [config] enc-type: bidirectional
[2023-07-17 13:51:08] [config] english-title-case-every: 0
[2023-07-17 13:51:08] [config] exponential-smoothing: 0
[2023-07-17 13:51:08] [config] factor-weight: 1
[2023-07-17 13:51:08] [config] factors-combine: sum
[2023-07-17 13:51:08] [config] factors-dim-emb: 0
[2023-07-17 13:51:08] [config] gradient-checkpointing: false
[2023-07-17 13:51:08] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:08] [config] guided-alignment: none
[2023-07-17 13:51:08] [config] guided-alignment-cost: mse
[2023-07-17 13:51:08] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:08] [config] ignore-model-config: false
[2023-07-17 13:51:08] [config] input-types:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] interpolate-env-vars: false
[2023-07-17 13:51:08] [config] keep-best: false
[2023-07-17 13:51:08] [config] label-smoothing: 0
[2023-07-17 13:51:08] [config] layer-normalization: false
[2023-07-17 13:51:08] [config] learn-rate: 0.0001
[2023-07-17 13:51:08] [config] lemma-dependency: ""
[2023-07-17 13:51:08] [config] lemma-dim-emb: 0
[2023-07-17 13:51:08] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:08] [config] log-level: info
[2023-07-17 13:51:08] [config] log-time-zone: ""
[2023-07-17 13:51:08] [config] logical-epoch:
[2023-07-17 13:51:08] [config]   - 1e
[2023-07-17 13:51:08] [config]   - 0
[2023-07-17 13:51:08] [config] lr-decay: 0
[2023-07-17 13:51:08] [config] lr-decay-freq: 50000
[2023-07-17 13:51:08] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:08] [config]   - 0
[2023-07-17 13:51:08] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:08] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:08] [config] lr-decay-start:
[2023-07-17 13:51:08] [config]   - 10
[2023-07-17 13:51:08] [config]   - 1
[2023-07-17 13:51:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:08] [config] lr-report: false
[2023-07-17 13:51:08] [config] lr-warmup: 0
[2023-07-17 13:51:08] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:08] [config] lr-warmup-cycle: false
[2023-07-17 13:51:08] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:08] [config] max-length: 150
[2023-07-17 13:51:08] [config] max-length-crop: true
[2023-07-17 13:51:08] [config] max-length-factor: 3
[2023-07-17 13:51:08] [config] maxi-batch: 100
[2023-07-17 13:51:08] [config] maxi-batch-sort: trg
[2023-07-17 13:51:08] [config] mini-batch: 64
[2023-07-17 13:51:08] [config] mini-batch-fit: true
[2023-07-17 13:51:08] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:08] [config] mini-batch-round-up: true
[2023-07-17 13:51:08] [config] mini-batch-track-lr: false
[2023-07-17 13:51:08] [config] mini-batch-warmup: 0
[2023-07-17 13:51:08] [config] mini-batch-words: 0
[2023-07-17 13:51:08] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:08] [config] multi-loss-type: sum
[2023-07-17 13:51:08] [config] n-best: false
[2023-07-17 13:51:08] [config] no-nccl: false
[2023-07-17 13:51:08] [config] no-reload: false
[2023-07-17 13:51:08] [config] no-restore-corpus: false
[2023-07-17 13:51:08] [config] normalize: 0
[2023-07-17 13:51:08] [config] normalize-gradient: false
[2023-07-17 13:51:08] [config] num-devices: 0
[2023-07-17 13:51:08] [config] optimizer: adam
[2023-07-17 13:51:08] [config] optimizer-delay: 1
[2023-07-17 13:51:08] [config] optimizer-params:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] output-omit-bias: false
[2023-07-17 13:51:08] [config] overwrite: true
[2023-07-17 13:51:08] [config] precision:
[2023-07-17 13:51:08] [config]   - float16
[2023-07-17 13:51:08] [config]   - float32
[2023-07-17 13:51:08] [config] pretrained-model: ""
[2023-07-17 13:51:08] [config] quantize-biases: false
[2023-07-17 13:51:08] [config] quantize-bits: 0
[2023-07-17 13:51:08] [config] quantize-log-based: false
[2023-07-17 13:51:08] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:08] [config] quiet: false
[2023-07-17 13:51:08] [config] quiet-translation: true
[2023-07-17 13:51:08] [config] relative-paths: false
[2023-07-17 13:51:08] [config] right-left: false
[2023-07-17 13:51:08] [config] save-freq: 10000u
[2023-07-17 13:51:08] [config] seed: 1234
[2023-07-17 13:51:08] [config] sentencepiece-alphas:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:08] [config] sentencepiece-options: ""
[2023-07-17 13:51:08] [config] sharding: global
[2023-07-17 13:51:08] [config] shuffle: data
[2023-07-17 13:51:08] [config] shuffle-in-ram: false
[2023-07-17 13:51:08] [config] sigterm: save-and-exit
[2023-07-17 13:51:08] [config] skip: false
[2023-07-17 13:51:08] [config] sqlite: ""
[2023-07-17 13:51:08] [config] sqlite-drop: false
[2023-07-17 13:51:08] [config] sync-freq: 200u
[2023-07-17 13:51:08] [config] sync-sgd: false
[2023-07-17 13:51:08] [config] tempdir: /tmp
[2023-07-17 13:51:08] [config] tied-embeddings: false
[2023-07-17 13:51:08] [config] tied-embeddings-all: true
[2023-07-17 13:51:08] [config] tied-embeddings-src: false
[2023-07-17 13:51:08] [config] train-embedder-rank:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] train-sets:
[2023-07-17 13:51:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:08] [config] transformer-aan-activation: swish
[2023-07-17 13:51:08] [config] transformer-aan-depth: 2
[2023-07-17 13:51:08] [config] transformer-aan-nogate: false
[2023-07-17 13:51:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:08] [config] transformer-depth-scaling: false
[2023-07-17 13:51:08] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:08] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:08] [config] transformer-dropout: 0
[2023-07-17 13:51:08] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:08] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:08] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:08] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:08] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:08] [config] transformer-heads: 8
[2023-07-17 13:51:08] [config] transformer-no-projection: false
[2023-07-17 13:51:08] [config] transformer-pool: false
[2023-07-17 13:51:08] [config] transformer-postprocess: dan
[2023-07-17 13:51:08] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:08] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:08] [config] transformer-preprocess: ""
[2023-07-17 13:51:08] [config] transformer-tied-layers:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:08] [config] tsv: false
[2023-07-17 13:51:08] [config] tsv-fields: 0
[2023-07-17 13:51:08] [config] type: amun
[2023-07-17 13:51:08] [config] ulr: false
[2023-07-17 13:51:08] [config] ulr-dim-emb: 0
[2023-07-17 13:51:08] [config] ulr-dropout: 0
[2023-07-17 13:51:08] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:08] [config] ulr-query-vectors: ""
[2023-07-17 13:51:08] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:08] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:08] [config] unlikelihood-loss: false
[2023-07-17 13:51:08] [config] valid-freq: 50000000
[2023-07-17 13:51:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:08] [config] valid-max-length: 1000
[2023-07-17 13:51:08] [config] valid-metrics:
[2023-07-17 13:51:08] [config]   - cross-entropy
[2023-07-17 13:51:08] [config]   - translation
[2023-07-17 13:51:08] [config] valid-mini-batch: 32
[2023-07-17 13:51:08] [config] valid-reset-stalled: false
[2023-07-17 13:51:08] [config] valid-script-args:
[2023-07-17 13:51:08] [config]   []
[2023-07-17 13:51:08] [config] valid-script-path: ""
[2023-07-17 13:51:08] [config] valid-sets:
[2023-07-17 13:51:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:08] [config] vocabs:
[2023-07-17 13:51:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:08] [config] word-penalty: 0
[2023-07-17 13:51:08] [config] word-scores: false
[2023-07-17 13:51:08] [config] workspace: 5500
[2023-07-17 13:51:08] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:08] [training] Using single-device training
[2023-07-17 13:51:08] Synced seed 1234
[2023-07-17 13:51:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:08] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:09] [comm] Using global sharding
[2023-07-17 13:51:09] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:09] [training] Using 1 GPUs
[2023-07-17 13:51:09] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:09] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x561ad290cf01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x561ad30a21fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x561ad30a2d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x561ad30a3785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x561ad2d20f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x561ad2da6d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x561ad2d9377c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x561ad286481d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x561ad2e40306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x561ad2e1cf2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x561ad291e450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x561ad28402c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x561ad27f7b9c]    main                                               + 0x3c
[0x7f97a03020b3]    __libc_start_main                                  + 0xf3
[0x561ad283ecbe]    _start                                             + 0x2e

[2023-07-17 13:51:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:10] [marian] Running on node22.datos.cluster.uy as process 7741 with command line:
[2023-07-17 13:51:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:10] [config] after: 0e
[2023-07-17 13:51:10] [config] after-batches: 0
[2023-07-17 13:51:10] [config] after-epochs: 60
[2023-07-17 13:51:10] [config] all-caps-every: 0
[2023-07-17 13:51:10] [config] allow-unk: false
[2023-07-17 13:51:10] [config] authors: false
[2023-07-17 13:51:10] [config] beam-size: 12
[2023-07-17 13:51:10] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:10] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:10] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:10] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:10] [config] build-info: ""
[2023-07-17 13:51:10] [config] check-gradient-nan: false
[2023-07-17 13:51:10] [config] check-nan: false
[2023-07-17 13:51:10] [config] cite: false
[2023-07-17 13:51:10] [config] clip-norm: 1
[2023-07-17 13:51:10] [config] cost-scaling:
[2023-07-17 13:51:10] [config]   - 256.f
[2023-07-17 13:51:10] [config]   - 1000
[2023-07-17 13:51:10] [config]   - 2.f
[2023-07-17 13:51:10] [config]   - 256.f
[2023-07-17 13:51:10] [config] cost-type: ce-sum
[2023-07-17 13:51:10] [config] cpu-threads: 0
[2023-07-17 13:51:10] [config] data-threads: 8
[2023-07-17 13:51:10] [config] data-weighting: ""
[2023-07-17 13:51:10] [config] data-weighting-type: sentence
[2023-07-17 13:51:10] [config] dec-cell: gru
[2023-07-17 13:51:10] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:10] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:10] [config] dec-depth: 1
[2023-07-17 13:51:10] [config] devices:
[2023-07-17 13:51:10] [config]   - 0
[2023-07-17 13:51:10] [config] dim-emb: 512
[2023-07-17 13:51:10] [config] dim-rnn: 1024
[2023-07-17 13:51:10] [config] dim-vocabs:
[2023-07-17 13:51:10] [config]   - 16384
[2023-07-17 13:51:10] [config]   - 16384
[2023-07-17 13:51:10] [config] disp-first: 0
[2023-07-17 13:51:10] [config] disp-freq: 1000u
[2023-07-17 13:51:10] [config] disp-label-counts: true
[2023-07-17 13:51:10] [config] dropout-rnn: 0
[2023-07-17 13:51:10] [config] dropout-src: 0
[2023-07-17 13:51:10] [config] dropout-trg: 0
[2023-07-17 13:51:10] [config] dump-config: ""
[2023-07-17 13:51:10] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] early-stopping: 5
[2023-07-17 13:51:10] [config] early-stopping-on: first
[2023-07-17 13:51:10] [config] embedding-fix-src: false
[2023-07-17 13:51:10] [config] embedding-fix-trg: false
[2023-07-17 13:51:10] [config] embedding-normalization: false
[2023-07-17 13:51:10] [config] embedding-vectors:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] enc-cell: gru
[2023-07-17 13:51:10] [config] enc-cell-depth: 1
[2023-07-17 13:51:10] [config] enc-depth: 1
[2023-07-17 13:51:10] [config] enc-type: bidirectional
[2023-07-17 13:51:10] [config] english-title-case-every: 0
[2023-07-17 13:51:10] [config] exponential-smoothing: 0
[2023-07-17 13:51:10] [config] factor-weight: 1
[2023-07-17 13:51:10] [config] factors-combine: sum
[2023-07-17 13:51:10] [config] factors-dim-emb: 0
[2023-07-17 13:51:10] [config] gradient-checkpointing: false
[2023-07-17 13:51:10] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:10] [config] guided-alignment: none
[2023-07-17 13:51:10] [config] guided-alignment-cost: mse
[2023-07-17 13:51:10] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:10] [config] ignore-model-config: false
[2023-07-17 13:51:10] [config] input-types:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] interpolate-env-vars: false
[2023-07-17 13:51:10] [config] keep-best: false
[2023-07-17 13:51:10] [config] label-smoothing: 0
[2023-07-17 13:51:10] [config] layer-normalization: false
[2023-07-17 13:51:10] [config] learn-rate: 0.0001
[2023-07-17 13:51:10] [config] lemma-dependency: ""
[2023-07-17 13:51:10] [config] lemma-dim-emb: 0
[2023-07-17 13:51:10] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:10] [config] log-level: info
[2023-07-17 13:51:10] [config] log-time-zone: ""
[2023-07-17 13:51:10] [config] logical-epoch:
[2023-07-17 13:51:10] [config]   - 1e
[2023-07-17 13:51:10] [config]   - 0
[2023-07-17 13:51:10] [config] lr-decay: 0
[2023-07-17 13:51:10] [config] lr-decay-freq: 50000
[2023-07-17 13:51:10] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:10] [config]   - 0
[2023-07-17 13:51:10] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:10] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:10] [config] lr-decay-start:
[2023-07-17 13:51:10] [config]   - 10
[2023-07-17 13:51:10] [config]   - 1
[2023-07-17 13:51:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:10] [config] lr-report: false
[2023-07-17 13:51:10] [config] lr-warmup: 0
[2023-07-17 13:51:10] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:10] [config] lr-warmup-cycle: false
[2023-07-17 13:51:10] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:10] [config] max-length: 150
[2023-07-17 13:51:10] [config] max-length-crop: true
[2023-07-17 13:51:10] [config] max-length-factor: 3
[2023-07-17 13:51:10] [config] maxi-batch: 100
[2023-07-17 13:51:10] [config] maxi-batch-sort: trg
[2023-07-17 13:51:10] [config] mini-batch: 64
[2023-07-17 13:51:10] [config] mini-batch-fit: true
[2023-07-17 13:51:10] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:10] [config] mini-batch-round-up: true
[2023-07-17 13:51:10] [config] mini-batch-track-lr: false
[2023-07-17 13:51:10] [config] mini-batch-warmup: 0
[2023-07-17 13:51:10] [config] mini-batch-words: 0
[2023-07-17 13:51:10] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:10] [config] multi-loss-type: sum
[2023-07-17 13:51:10] [config] n-best: false
[2023-07-17 13:51:10] [config] no-nccl: false
[2023-07-17 13:51:10] [config] no-reload: false
[2023-07-17 13:51:10] [config] no-restore-corpus: false
[2023-07-17 13:51:10] [config] normalize: 0
[2023-07-17 13:51:10] [config] normalize-gradient: false
[2023-07-17 13:51:10] [config] num-devices: 0
[2023-07-17 13:51:10] [config] optimizer: adam
[2023-07-17 13:51:10] [config] optimizer-delay: 1
[2023-07-17 13:51:10] [config] optimizer-params:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] output-omit-bias: false
[2023-07-17 13:51:10] [config] overwrite: true
[2023-07-17 13:51:10] [config] precision:
[2023-07-17 13:51:10] [config]   - float16
[2023-07-17 13:51:10] [config]   - float32
[2023-07-17 13:51:10] [config] pretrained-model: ""
[2023-07-17 13:51:10] [config] quantize-biases: false
[2023-07-17 13:51:10] [config] quantize-bits: 0
[2023-07-17 13:51:10] [config] quantize-log-based: false
[2023-07-17 13:51:10] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:10] [config] quiet: false
[2023-07-17 13:51:10] [config] quiet-translation: true
[2023-07-17 13:51:10] [config] relative-paths: false
[2023-07-17 13:51:10] [config] right-left: false
[2023-07-17 13:51:10] [config] save-freq: 10000u
[2023-07-17 13:51:10] [config] seed: 1234
[2023-07-17 13:51:10] [config] sentencepiece-alphas:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:10] [config] sentencepiece-options: ""
[2023-07-17 13:51:10] [config] sharding: global
[2023-07-17 13:51:10] [config] shuffle: data
[2023-07-17 13:51:10] [config] shuffle-in-ram: false
[2023-07-17 13:51:10] [config] sigterm: save-and-exit
[2023-07-17 13:51:10] [config] skip: false
[2023-07-17 13:51:10] [config] sqlite: ""
[2023-07-17 13:51:10] [config] sqlite-drop: false
[2023-07-17 13:51:10] [config] sync-freq: 200u
[2023-07-17 13:51:10] [config] sync-sgd: false
[2023-07-17 13:51:10] [config] tempdir: /tmp
[2023-07-17 13:51:10] [config] tied-embeddings: false
[2023-07-17 13:51:10] [config] tied-embeddings-all: true
[2023-07-17 13:51:10] [config] tied-embeddings-src: false
[2023-07-17 13:51:10] [config] train-embedder-rank:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] train-sets:
[2023-07-17 13:51:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:10] [config] transformer-aan-activation: swish
[2023-07-17 13:51:10] [config] transformer-aan-depth: 2
[2023-07-17 13:51:10] [config] transformer-aan-nogate: false
[2023-07-17 13:51:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:10] [config] transformer-depth-scaling: false
[2023-07-17 13:51:10] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:10] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:10] [config] transformer-dropout: 0
[2023-07-17 13:51:10] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:10] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:10] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:10] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:10] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:10] [config] transformer-heads: 8
[2023-07-17 13:51:10] [config] transformer-no-projection: false
[2023-07-17 13:51:10] [config] transformer-pool: false
[2023-07-17 13:51:10] [config] transformer-postprocess: dan
[2023-07-17 13:51:10] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:10] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:10] [config] transformer-preprocess: ""
[2023-07-17 13:51:10] [config] transformer-tied-layers:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:10] [config] tsv: false
[2023-07-17 13:51:10] [config] tsv-fields: 0
[2023-07-17 13:51:10] [config] type: amun
[2023-07-17 13:51:10] [config] ulr: false
[2023-07-17 13:51:10] [config] ulr-dim-emb: 0
[2023-07-17 13:51:10] [config] ulr-dropout: 0
[2023-07-17 13:51:10] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:10] [config] ulr-query-vectors: ""
[2023-07-17 13:51:10] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:10] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:10] [config] unlikelihood-loss: false
[2023-07-17 13:51:10] [config] valid-freq: 50000000
[2023-07-17 13:51:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:10] [config] valid-max-length: 1000
[2023-07-17 13:51:10] [config] valid-metrics:
[2023-07-17 13:51:10] [config]   - cross-entropy
[2023-07-17 13:51:10] [config]   - translation
[2023-07-17 13:51:10] [config] valid-mini-batch: 32
[2023-07-17 13:51:10] [config] valid-reset-stalled: false
[2023-07-17 13:51:10] [config] valid-script-args:
[2023-07-17 13:51:10] [config]   []
[2023-07-17 13:51:10] [config] valid-script-path: ""
[2023-07-17 13:51:10] [config] valid-sets:
[2023-07-17 13:51:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:10] [config] vocabs:
[2023-07-17 13:51:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:10] [config] word-penalty: 0
[2023-07-17 13:51:10] [config] word-scores: false
[2023-07-17 13:51:10] [config] workspace: 5500
[2023-07-17 13:51:10] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:10] [training] Using single-device training
[2023-07-17 13:51:11] Synced seed 1234
[2023-07-17 13:51:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:11] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:12] [comm] Using global sharding
[2023-07-17 13:51:12] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:12] [training] Using 1 GPUs
[2023-07-17 13:51:12] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:12] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x5644c386bf01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5644c40011fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5644c4001d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5644c4002785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x5644c3c7ff3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5644c3d05d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x5644c3cf277c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x5644c37c381d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x5644c3d9f306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x5644c3d7bf2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x5644c387d450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5644c379f2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5644c3756b9c]    main                                               + 0x3c
[0x7f8d8f6eb0b3]    __libc_start_main                                  + 0xf3
[0x5644c379dcbe]    _start                                             + 0x2e

[2023-07-17 13:51:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:13] [marian] Running on node22.datos.cluster.uy as process 7772 with command line:
[2023-07-17 13:51:13] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:13] [config] after: 0e
[2023-07-17 13:51:13] [config] after-batches: 0
[2023-07-17 13:51:13] [config] after-epochs: 70
[2023-07-17 13:51:13] [config] all-caps-every: 0
[2023-07-17 13:51:13] [config] allow-unk: false
[2023-07-17 13:51:13] [config] authors: false
[2023-07-17 13:51:13] [config] beam-size: 12
[2023-07-17 13:51:13] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:13] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:13] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:13] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:13] [config] build-info: ""
[2023-07-17 13:51:13] [config] check-gradient-nan: false
[2023-07-17 13:51:13] [config] check-nan: false
[2023-07-17 13:51:13] [config] cite: false
[2023-07-17 13:51:13] [config] clip-norm: 1
[2023-07-17 13:51:13] [config] cost-scaling:
[2023-07-17 13:51:13] [config]   - 256.f
[2023-07-17 13:51:13] [config]   - 1000
[2023-07-17 13:51:13] [config]   - 2.f
[2023-07-17 13:51:13] [config]   - 256.f
[2023-07-17 13:51:13] [config] cost-type: ce-sum
[2023-07-17 13:51:13] [config] cpu-threads: 0
[2023-07-17 13:51:13] [config] data-threads: 8
[2023-07-17 13:51:13] [config] data-weighting: ""
[2023-07-17 13:51:13] [config] data-weighting-type: sentence
[2023-07-17 13:51:13] [config] dec-cell: gru
[2023-07-17 13:51:13] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:13] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:13] [config] dec-depth: 1
[2023-07-17 13:51:13] [config] devices:
[2023-07-17 13:51:13] [config]   - 0
[2023-07-17 13:51:13] [config] dim-emb: 512
[2023-07-17 13:51:13] [config] dim-rnn: 1024
[2023-07-17 13:51:13] [config] dim-vocabs:
[2023-07-17 13:51:13] [config]   - 16384
[2023-07-17 13:51:13] [config]   - 16384
[2023-07-17 13:51:13] [config] disp-first: 0
[2023-07-17 13:51:13] [config] disp-freq: 1000u
[2023-07-17 13:51:13] [config] disp-label-counts: true
[2023-07-17 13:51:13] [config] dropout-rnn: 0
[2023-07-17 13:51:13] [config] dropout-src: 0
[2023-07-17 13:51:13] [config] dropout-trg: 0
[2023-07-17 13:51:13] [config] dump-config: ""
[2023-07-17 13:51:13] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] early-stopping: 5
[2023-07-17 13:51:13] [config] early-stopping-on: first
[2023-07-17 13:51:13] [config] embedding-fix-src: false
[2023-07-17 13:51:13] [config] embedding-fix-trg: false
[2023-07-17 13:51:13] [config] embedding-normalization: false
[2023-07-17 13:51:13] [config] embedding-vectors:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] enc-cell: gru
[2023-07-17 13:51:13] [config] enc-cell-depth: 1
[2023-07-17 13:51:13] [config] enc-depth: 1
[2023-07-17 13:51:13] [config] enc-type: bidirectional
[2023-07-17 13:51:13] [config] english-title-case-every: 0
[2023-07-17 13:51:13] [config] exponential-smoothing: 0
[2023-07-17 13:51:13] [config] factor-weight: 1
[2023-07-17 13:51:13] [config] factors-combine: sum
[2023-07-17 13:51:13] [config] factors-dim-emb: 0
[2023-07-17 13:51:13] [config] gradient-checkpointing: false
[2023-07-17 13:51:13] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:13] [config] guided-alignment: none
[2023-07-17 13:51:13] [config] guided-alignment-cost: mse
[2023-07-17 13:51:13] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:13] [config] ignore-model-config: false
[2023-07-17 13:51:13] [config] input-types:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] interpolate-env-vars: false
[2023-07-17 13:51:13] [config] keep-best: false
[2023-07-17 13:51:13] [config] label-smoothing: 0
[2023-07-17 13:51:13] [config] layer-normalization: false
[2023-07-17 13:51:13] [config] learn-rate: 0.0001
[2023-07-17 13:51:13] [config] lemma-dependency: ""
[2023-07-17 13:51:13] [config] lemma-dim-emb: 0
[2023-07-17 13:51:13] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:13] [config] log-level: info
[2023-07-17 13:51:13] [config] log-time-zone: ""
[2023-07-17 13:51:13] [config] logical-epoch:
[2023-07-17 13:51:13] [config]   - 1e
[2023-07-17 13:51:13] [config]   - 0
[2023-07-17 13:51:13] [config] lr-decay: 0
[2023-07-17 13:51:13] [config] lr-decay-freq: 50000
[2023-07-17 13:51:13] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:13] [config]   - 0
[2023-07-17 13:51:13] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:13] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:13] [config] lr-decay-start:
[2023-07-17 13:51:13] [config]   - 10
[2023-07-17 13:51:13] [config]   - 1
[2023-07-17 13:51:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:13] [config] lr-report: false
[2023-07-17 13:51:13] [config] lr-warmup: 0
[2023-07-17 13:51:13] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:13] [config] lr-warmup-cycle: false
[2023-07-17 13:51:13] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:13] [config] max-length: 150
[2023-07-17 13:51:13] [config] max-length-crop: true
[2023-07-17 13:51:13] [config] max-length-factor: 3
[2023-07-17 13:51:13] [config] maxi-batch: 100
[2023-07-17 13:51:13] [config] maxi-batch-sort: trg
[2023-07-17 13:51:13] [config] mini-batch: 64
[2023-07-17 13:51:13] [config] mini-batch-fit: true
[2023-07-17 13:51:13] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:13] [config] mini-batch-round-up: true
[2023-07-17 13:51:13] [config] mini-batch-track-lr: false
[2023-07-17 13:51:13] [config] mini-batch-warmup: 0
[2023-07-17 13:51:13] [config] mini-batch-words: 0
[2023-07-17 13:51:13] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:13] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:13] [config] multi-loss-type: sum
[2023-07-17 13:51:13] [config] n-best: false
[2023-07-17 13:51:13] [config] no-nccl: false
[2023-07-17 13:51:13] [config] no-reload: false
[2023-07-17 13:51:13] [config] no-restore-corpus: false
[2023-07-17 13:51:13] [config] normalize: 0
[2023-07-17 13:51:13] [config] normalize-gradient: false
[2023-07-17 13:51:13] [config] num-devices: 0
[2023-07-17 13:51:13] [config] optimizer: adam
[2023-07-17 13:51:13] [config] optimizer-delay: 1
[2023-07-17 13:51:13] [config] optimizer-params:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] output-omit-bias: false
[2023-07-17 13:51:13] [config] overwrite: true
[2023-07-17 13:51:13] [config] precision:
[2023-07-17 13:51:13] [config]   - float16
[2023-07-17 13:51:13] [config]   - float32
[2023-07-17 13:51:13] [config] pretrained-model: ""
[2023-07-17 13:51:13] [config] quantize-biases: false
[2023-07-17 13:51:13] [config] quantize-bits: 0
[2023-07-17 13:51:13] [config] quantize-log-based: false
[2023-07-17 13:51:13] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:13] [config] quiet: false
[2023-07-17 13:51:13] [config] quiet-translation: true
[2023-07-17 13:51:13] [config] relative-paths: false
[2023-07-17 13:51:13] [config] right-left: false
[2023-07-17 13:51:13] [config] save-freq: 10000u
[2023-07-17 13:51:13] [config] seed: 1234
[2023-07-17 13:51:13] [config] sentencepiece-alphas:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:13] [config] sentencepiece-options: ""
[2023-07-17 13:51:13] [config] sharding: global
[2023-07-17 13:51:13] [config] shuffle: data
[2023-07-17 13:51:13] [config] shuffle-in-ram: false
[2023-07-17 13:51:13] [config] sigterm: save-and-exit
[2023-07-17 13:51:13] [config] skip: false
[2023-07-17 13:51:13] [config] sqlite: ""
[2023-07-17 13:51:13] [config] sqlite-drop: false
[2023-07-17 13:51:13] [config] sync-freq: 200u
[2023-07-17 13:51:13] [config] sync-sgd: false
[2023-07-17 13:51:13] [config] tempdir: /tmp
[2023-07-17 13:51:13] [config] tied-embeddings: false
[2023-07-17 13:51:13] [config] tied-embeddings-all: true
[2023-07-17 13:51:13] [config] tied-embeddings-src: false
[2023-07-17 13:51:13] [config] train-embedder-rank:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] train-sets:
[2023-07-17 13:51:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:13] [config] transformer-aan-activation: swish
[2023-07-17 13:51:13] [config] transformer-aan-depth: 2
[2023-07-17 13:51:13] [config] transformer-aan-nogate: false
[2023-07-17 13:51:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:13] [config] transformer-depth-scaling: false
[2023-07-17 13:51:13] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:13] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:13] [config] transformer-dropout: 0
[2023-07-17 13:51:13] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:13] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:13] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:13] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:13] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:13] [config] transformer-heads: 8
[2023-07-17 13:51:13] [config] transformer-no-projection: false
[2023-07-17 13:51:13] [config] transformer-pool: false
[2023-07-17 13:51:13] [config] transformer-postprocess: dan
[2023-07-17 13:51:13] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:13] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:13] [config] transformer-preprocess: ""
[2023-07-17 13:51:13] [config] transformer-tied-layers:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:13] [config] tsv: false
[2023-07-17 13:51:13] [config] tsv-fields: 0
[2023-07-17 13:51:13] [config] type: amun
[2023-07-17 13:51:13] [config] ulr: false
[2023-07-17 13:51:13] [config] ulr-dim-emb: 0
[2023-07-17 13:51:13] [config] ulr-dropout: 0
[2023-07-17 13:51:13] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:13] [config] ulr-query-vectors: ""
[2023-07-17 13:51:13] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:13] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:13] [config] unlikelihood-loss: false
[2023-07-17 13:51:13] [config] valid-freq: 50000000
[2023-07-17 13:51:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:13] [config] valid-max-length: 1000
[2023-07-17 13:51:13] [config] valid-metrics:
[2023-07-17 13:51:13] [config]   - cross-entropy
[2023-07-17 13:51:13] [config]   - translation
[2023-07-17 13:51:13] [config] valid-mini-batch: 32
[2023-07-17 13:51:13] [config] valid-reset-stalled: false
[2023-07-17 13:51:13] [config] valid-script-args:
[2023-07-17 13:51:13] [config]   []
[2023-07-17 13:51:13] [config] valid-script-path: ""
[2023-07-17 13:51:13] [config] valid-sets:
[2023-07-17 13:51:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:13] [config] vocabs:
[2023-07-17 13:51:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:13] [config] word-penalty: 0
[2023-07-17 13:51:13] [config] word-scores: false
[2023-07-17 13:51:13] [config] workspace: 5500
[2023-07-17 13:51:13] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:13] [training] Using single-device training
[2023-07-17 13:51:13] Synced seed 1234
[2023-07-17 13:51:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:13] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:13] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:13] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:13] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:13] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:14] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:15] [comm] Using global sharding
[2023-07-17 13:51:15] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:15] [training] Using 1 GPUs
[2023-07-17 13:51:15] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:15] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55f1ec36bf01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55f1ecb011fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55f1ecb01d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55f1ecb02785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55f1ec77ff3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55f1ec805d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55f1ec7f277c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55f1ec2c381d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55f1ec89f306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55f1ec87bf2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55f1ec37d450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55f1ec29f2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55f1ec256b9c]    main                                               + 0x3c
[0x7f760dfc30b3]    __libc_start_main                                  + 0xf3
[0x55f1ec29dcbe]    _start                                             + 0x2e

[2023-07-17 13:51:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:16] [marian] Running on node22.datos.cluster.uy as process 7803 with command line:
[2023-07-17 13:51:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:16] [config] after: 0e
[2023-07-17 13:51:16] [config] after-batches: 0
[2023-07-17 13:51:16] [config] after-epochs: 80
[2023-07-17 13:51:16] [config] all-caps-every: 0
[2023-07-17 13:51:16] [config] allow-unk: false
[2023-07-17 13:51:16] [config] authors: false
[2023-07-17 13:51:16] [config] beam-size: 12
[2023-07-17 13:51:16] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:16] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:16] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:16] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:16] [config] build-info: ""
[2023-07-17 13:51:16] [config] check-gradient-nan: false
[2023-07-17 13:51:16] [config] check-nan: false
[2023-07-17 13:51:16] [config] cite: false
[2023-07-17 13:51:16] [config] clip-norm: 1
[2023-07-17 13:51:16] [config] cost-scaling:
[2023-07-17 13:51:16] [config]   - 256.f
[2023-07-17 13:51:16] [config]   - 1000
[2023-07-17 13:51:16] [config]   - 2.f
[2023-07-17 13:51:16] [config]   - 256.f
[2023-07-17 13:51:16] [config] cost-type: ce-sum
[2023-07-17 13:51:16] [config] cpu-threads: 0
[2023-07-17 13:51:16] [config] data-threads: 8
[2023-07-17 13:51:16] [config] data-weighting: ""
[2023-07-17 13:51:16] [config] data-weighting-type: sentence
[2023-07-17 13:51:16] [config] dec-cell: gru
[2023-07-17 13:51:16] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:16] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:16] [config] dec-depth: 1
[2023-07-17 13:51:16] [config] devices:
[2023-07-17 13:51:16] [config]   - 0
[2023-07-17 13:51:16] [config] dim-emb: 512
[2023-07-17 13:51:16] [config] dim-rnn: 1024
[2023-07-17 13:51:16] [config] dim-vocabs:
[2023-07-17 13:51:16] [config]   - 16384
[2023-07-17 13:51:16] [config]   - 16384
[2023-07-17 13:51:16] [config] disp-first: 0
[2023-07-17 13:51:16] [config] disp-freq: 1000u
[2023-07-17 13:51:16] [config] disp-label-counts: true
[2023-07-17 13:51:16] [config] dropout-rnn: 0
[2023-07-17 13:51:16] [config] dropout-src: 0
[2023-07-17 13:51:16] [config] dropout-trg: 0
[2023-07-17 13:51:16] [config] dump-config: ""
[2023-07-17 13:51:16] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] early-stopping: 5
[2023-07-17 13:51:16] [config] early-stopping-on: first
[2023-07-17 13:51:16] [config] embedding-fix-src: false
[2023-07-17 13:51:16] [config] embedding-fix-trg: false
[2023-07-17 13:51:16] [config] embedding-normalization: false
[2023-07-17 13:51:16] [config] embedding-vectors:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] enc-cell: gru
[2023-07-17 13:51:16] [config] enc-cell-depth: 1
[2023-07-17 13:51:16] [config] enc-depth: 1
[2023-07-17 13:51:16] [config] enc-type: bidirectional
[2023-07-17 13:51:16] [config] english-title-case-every: 0
[2023-07-17 13:51:16] [config] exponential-smoothing: 0
[2023-07-17 13:51:16] [config] factor-weight: 1
[2023-07-17 13:51:16] [config] factors-combine: sum
[2023-07-17 13:51:16] [config] factors-dim-emb: 0
[2023-07-17 13:51:16] [config] gradient-checkpointing: false
[2023-07-17 13:51:16] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:16] [config] guided-alignment: none
[2023-07-17 13:51:16] [config] guided-alignment-cost: mse
[2023-07-17 13:51:16] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:16] [config] ignore-model-config: false
[2023-07-17 13:51:16] [config] input-types:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] interpolate-env-vars: false
[2023-07-17 13:51:16] [config] keep-best: false
[2023-07-17 13:51:16] [config] label-smoothing: 0
[2023-07-17 13:51:16] [config] layer-normalization: false
[2023-07-17 13:51:16] [config] learn-rate: 0.0001
[2023-07-17 13:51:16] [config] lemma-dependency: ""
[2023-07-17 13:51:16] [config] lemma-dim-emb: 0
[2023-07-17 13:51:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:16] [config] log-level: info
[2023-07-17 13:51:16] [config] log-time-zone: ""
[2023-07-17 13:51:16] [config] logical-epoch:
[2023-07-17 13:51:16] [config]   - 1e
[2023-07-17 13:51:16] [config]   - 0
[2023-07-17 13:51:16] [config] lr-decay: 0
[2023-07-17 13:51:16] [config] lr-decay-freq: 50000
[2023-07-17 13:51:16] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:16] [config]   - 0
[2023-07-17 13:51:16] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:16] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:16] [config] lr-decay-start:
[2023-07-17 13:51:16] [config]   - 10
[2023-07-17 13:51:16] [config]   - 1
[2023-07-17 13:51:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:16] [config] lr-report: false
[2023-07-17 13:51:16] [config] lr-warmup: 0
[2023-07-17 13:51:16] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:16] [config] lr-warmup-cycle: false
[2023-07-17 13:51:16] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:16] [config] max-length: 150
[2023-07-17 13:51:16] [config] max-length-crop: true
[2023-07-17 13:51:16] [config] max-length-factor: 3
[2023-07-17 13:51:16] [config] maxi-batch: 100
[2023-07-17 13:51:16] [config] maxi-batch-sort: trg
[2023-07-17 13:51:16] [config] mini-batch: 64
[2023-07-17 13:51:16] [config] mini-batch-fit: true
[2023-07-17 13:51:16] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:16] [config] mini-batch-round-up: true
[2023-07-17 13:51:16] [config] mini-batch-track-lr: false
[2023-07-17 13:51:16] [config] mini-batch-warmup: 0
[2023-07-17 13:51:16] [config] mini-batch-words: 0
[2023-07-17 13:51:16] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:16] [config] multi-loss-type: sum
[2023-07-17 13:51:16] [config] n-best: false
[2023-07-17 13:51:16] [config] no-nccl: false
[2023-07-17 13:51:16] [config] no-reload: false
[2023-07-17 13:51:16] [config] no-restore-corpus: false
[2023-07-17 13:51:16] [config] normalize: 0
[2023-07-17 13:51:16] [config] normalize-gradient: false
[2023-07-17 13:51:16] [config] num-devices: 0
[2023-07-17 13:51:16] [config] optimizer: adam
[2023-07-17 13:51:16] [config] optimizer-delay: 1
[2023-07-17 13:51:16] [config] optimizer-params:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] output-omit-bias: false
[2023-07-17 13:51:16] [config] overwrite: true
[2023-07-17 13:51:16] [config] precision:
[2023-07-17 13:51:16] [config]   - float16
[2023-07-17 13:51:16] [config]   - float32
[2023-07-17 13:51:16] [config] pretrained-model: ""
[2023-07-17 13:51:16] [config] quantize-biases: false
[2023-07-17 13:51:16] [config] quantize-bits: 0
[2023-07-17 13:51:16] [config] quantize-log-based: false
[2023-07-17 13:51:16] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:16] [config] quiet: false
[2023-07-17 13:51:16] [config] quiet-translation: true
[2023-07-17 13:51:16] [config] relative-paths: false
[2023-07-17 13:51:16] [config] right-left: false
[2023-07-17 13:51:16] [config] save-freq: 10000u
[2023-07-17 13:51:16] [config] seed: 1234
[2023-07-17 13:51:16] [config] sentencepiece-alphas:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:16] [config] sentencepiece-options: ""
[2023-07-17 13:51:16] [config] sharding: global
[2023-07-17 13:51:16] [config] shuffle: data
[2023-07-17 13:51:16] [config] shuffle-in-ram: false
[2023-07-17 13:51:16] [config] sigterm: save-and-exit
[2023-07-17 13:51:16] [config] skip: false
[2023-07-17 13:51:16] [config] sqlite: ""
[2023-07-17 13:51:16] [config] sqlite-drop: false
[2023-07-17 13:51:16] [config] sync-freq: 200u
[2023-07-17 13:51:16] [config] sync-sgd: false
[2023-07-17 13:51:16] [config] tempdir: /tmp
[2023-07-17 13:51:16] [config] tied-embeddings: false
[2023-07-17 13:51:16] [config] tied-embeddings-all: true
[2023-07-17 13:51:16] [config] tied-embeddings-src: false
[2023-07-17 13:51:16] [config] train-embedder-rank:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] train-sets:
[2023-07-17 13:51:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:16] [config] transformer-aan-activation: swish
[2023-07-17 13:51:16] [config] transformer-aan-depth: 2
[2023-07-17 13:51:16] [config] transformer-aan-nogate: false
[2023-07-17 13:51:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:16] [config] transformer-depth-scaling: false
[2023-07-17 13:51:16] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:16] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:16] [config] transformer-dropout: 0
[2023-07-17 13:51:16] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:16] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:16] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:16] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:16] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:16] [config] transformer-heads: 8
[2023-07-17 13:51:16] [config] transformer-no-projection: false
[2023-07-17 13:51:16] [config] transformer-pool: false
[2023-07-17 13:51:16] [config] transformer-postprocess: dan
[2023-07-17 13:51:16] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:16] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:16] [config] transformer-preprocess: ""
[2023-07-17 13:51:16] [config] transformer-tied-layers:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:16] [config] tsv: false
[2023-07-17 13:51:16] [config] tsv-fields: 0
[2023-07-17 13:51:16] [config] type: amun
[2023-07-17 13:51:16] [config] ulr: false
[2023-07-17 13:51:16] [config] ulr-dim-emb: 0
[2023-07-17 13:51:16] [config] ulr-dropout: 0
[2023-07-17 13:51:16] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:16] [config] ulr-query-vectors: ""
[2023-07-17 13:51:16] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:16] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:16] [config] unlikelihood-loss: false
[2023-07-17 13:51:16] [config] valid-freq: 50000000
[2023-07-17 13:51:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:16] [config] valid-max-length: 1000
[2023-07-17 13:51:16] [config] valid-metrics:
[2023-07-17 13:51:16] [config]   - cross-entropy
[2023-07-17 13:51:16] [config]   - translation
[2023-07-17 13:51:16] [config] valid-mini-batch: 32
[2023-07-17 13:51:16] [config] valid-reset-stalled: false
[2023-07-17 13:51:16] [config] valid-script-args:
[2023-07-17 13:51:16] [config]   []
[2023-07-17 13:51:16] [config] valid-script-path: ""
[2023-07-17 13:51:16] [config] valid-sets:
[2023-07-17 13:51:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:16] [config] vocabs:
[2023-07-17 13:51:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:16] [config] word-penalty: 0
[2023-07-17 13:51:16] [config] word-scores: false
[2023-07-17 13:51:16] [config] workspace: 5500
[2023-07-17 13:51:16] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:16] [training] Using single-device training
[2023-07-17 13:51:16] Synced seed 1234
[2023-07-17 13:51:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:16] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:17] [comm] Using global sharding
[2023-07-17 13:51:17] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:17] [training] Using 1 GPUs
[2023-07-17 13:51:17] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:17] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x563689cfff01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x56368a4951fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x56368a495d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x56368a496785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x56368a113f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x56368a199d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x56368a18677c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x563689c5781d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x56368a233306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x56368a20ff2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x563689d11450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x563689c332c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563689beab9c]    main                                               + 0x3c
[0x7f383ebc00b3]    __libc_start_main                                  + 0xf3
[0x563689c31cbe]    _start                                             + 0x2e

[2023-07-17 13:51:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:18] [marian] Running on node22.datos.cluster.uy as process 7833 with command line:
[2023-07-17 13:51:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:18] [config] after: 0e
[2023-07-17 13:51:18] [config] after-batches: 0
[2023-07-17 13:51:18] [config] after-epochs: 90
[2023-07-17 13:51:18] [config] all-caps-every: 0
[2023-07-17 13:51:18] [config] allow-unk: false
[2023-07-17 13:51:18] [config] authors: false
[2023-07-17 13:51:18] [config] beam-size: 12
[2023-07-17 13:51:18] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:18] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:18] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:18] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:18] [config] build-info: ""
[2023-07-17 13:51:18] [config] check-gradient-nan: false
[2023-07-17 13:51:18] [config] check-nan: false
[2023-07-17 13:51:18] [config] cite: false
[2023-07-17 13:51:18] [config] clip-norm: 1
[2023-07-17 13:51:18] [config] cost-scaling:
[2023-07-17 13:51:18] [config]   - 256.f
[2023-07-17 13:51:18] [config]   - 1000
[2023-07-17 13:51:18] [config]   - 2.f
[2023-07-17 13:51:18] [config]   - 256.f
[2023-07-17 13:51:18] [config] cost-type: ce-sum
[2023-07-17 13:51:18] [config] cpu-threads: 0
[2023-07-17 13:51:18] [config] data-threads: 8
[2023-07-17 13:51:18] [config] data-weighting: ""
[2023-07-17 13:51:18] [config] data-weighting-type: sentence
[2023-07-17 13:51:18] [config] dec-cell: gru
[2023-07-17 13:51:18] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:18] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:18] [config] dec-depth: 1
[2023-07-17 13:51:18] [config] devices:
[2023-07-17 13:51:18] [config]   - 0
[2023-07-17 13:51:18] [config] dim-emb: 512
[2023-07-17 13:51:18] [config] dim-rnn: 1024
[2023-07-17 13:51:18] [config] dim-vocabs:
[2023-07-17 13:51:18] [config]   - 16384
[2023-07-17 13:51:18] [config]   - 16384
[2023-07-17 13:51:18] [config] disp-first: 0
[2023-07-17 13:51:18] [config] disp-freq: 1000u
[2023-07-17 13:51:18] [config] disp-label-counts: true
[2023-07-17 13:51:18] [config] dropout-rnn: 0
[2023-07-17 13:51:18] [config] dropout-src: 0
[2023-07-17 13:51:18] [config] dropout-trg: 0
[2023-07-17 13:51:18] [config] dump-config: ""
[2023-07-17 13:51:18] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] early-stopping: 5
[2023-07-17 13:51:18] [config] early-stopping-on: first
[2023-07-17 13:51:18] [config] embedding-fix-src: false
[2023-07-17 13:51:18] [config] embedding-fix-trg: false
[2023-07-17 13:51:18] [config] embedding-normalization: false
[2023-07-17 13:51:18] [config] embedding-vectors:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] enc-cell: gru
[2023-07-17 13:51:18] [config] enc-cell-depth: 1
[2023-07-17 13:51:18] [config] enc-depth: 1
[2023-07-17 13:51:18] [config] enc-type: bidirectional
[2023-07-17 13:51:18] [config] english-title-case-every: 0
[2023-07-17 13:51:18] [config] exponential-smoothing: 0
[2023-07-17 13:51:18] [config] factor-weight: 1
[2023-07-17 13:51:18] [config] factors-combine: sum
[2023-07-17 13:51:18] [config] factors-dim-emb: 0
[2023-07-17 13:51:18] [config] gradient-checkpointing: false
[2023-07-17 13:51:18] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:18] [config] guided-alignment: none
[2023-07-17 13:51:18] [config] guided-alignment-cost: mse
[2023-07-17 13:51:18] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:18] [config] ignore-model-config: false
[2023-07-17 13:51:18] [config] input-types:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] interpolate-env-vars: false
[2023-07-17 13:51:18] [config] keep-best: false
[2023-07-17 13:51:18] [config] label-smoothing: 0
[2023-07-17 13:51:18] [config] layer-normalization: false
[2023-07-17 13:51:18] [config] learn-rate: 0.0001
[2023-07-17 13:51:18] [config] lemma-dependency: ""
[2023-07-17 13:51:18] [config] lemma-dim-emb: 0
[2023-07-17 13:51:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:18] [config] log-level: info
[2023-07-17 13:51:18] [config] log-time-zone: ""
[2023-07-17 13:51:18] [config] logical-epoch:
[2023-07-17 13:51:18] [config]   - 1e
[2023-07-17 13:51:18] [config]   - 0
[2023-07-17 13:51:18] [config] lr-decay: 0
[2023-07-17 13:51:18] [config] lr-decay-freq: 50000
[2023-07-17 13:51:18] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:18] [config]   - 0
[2023-07-17 13:51:18] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:18] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:18] [config] lr-decay-start:
[2023-07-17 13:51:18] [config]   - 10
[2023-07-17 13:51:18] [config]   - 1
[2023-07-17 13:51:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:18] [config] lr-report: false
[2023-07-17 13:51:18] [config] lr-warmup: 0
[2023-07-17 13:51:18] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:18] [config] lr-warmup-cycle: false
[2023-07-17 13:51:18] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:18] [config] max-length: 150
[2023-07-17 13:51:18] [config] max-length-crop: true
[2023-07-17 13:51:18] [config] max-length-factor: 3
[2023-07-17 13:51:18] [config] maxi-batch: 100
[2023-07-17 13:51:18] [config] maxi-batch-sort: trg
[2023-07-17 13:51:18] [config] mini-batch: 64
[2023-07-17 13:51:18] [config] mini-batch-fit: true
[2023-07-17 13:51:18] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:18] [config] mini-batch-round-up: true
[2023-07-17 13:51:18] [config] mini-batch-track-lr: false
[2023-07-17 13:51:18] [config] mini-batch-warmup: 0
[2023-07-17 13:51:18] [config] mini-batch-words: 0
[2023-07-17 13:51:18] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:18] [config] multi-loss-type: sum
[2023-07-17 13:51:18] [config] n-best: false
[2023-07-17 13:51:18] [config] no-nccl: false
[2023-07-17 13:51:18] [config] no-reload: false
[2023-07-17 13:51:18] [config] no-restore-corpus: false
[2023-07-17 13:51:18] [config] normalize: 0
[2023-07-17 13:51:18] [config] normalize-gradient: false
[2023-07-17 13:51:18] [config] num-devices: 0
[2023-07-17 13:51:18] [config] optimizer: adam
[2023-07-17 13:51:18] [config] optimizer-delay: 1
[2023-07-17 13:51:18] [config] optimizer-params:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] output-omit-bias: false
[2023-07-17 13:51:18] [config] overwrite: true
[2023-07-17 13:51:18] [config] precision:
[2023-07-17 13:51:18] [config]   - float16
[2023-07-17 13:51:18] [config]   - float32
[2023-07-17 13:51:18] [config] pretrained-model: ""
[2023-07-17 13:51:18] [config] quantize-biases: false
[2023-07-17 13:51:18] [config] quantize-bits: 0
[2023-07-17 13:51:18] [config] quantize-log-based: false
[2023-07-17 13:51:18] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:18] [config] quiet: false
[2023-07-17 13:51:18] [config] quiet-translation: true
[2023-07-17 13:51:18] [config] relative-paths: false
[2023-07-17 13:51:18] [config] right-left: false
[2023-07-17 13:51:18] [config] save-freq: 10000u
[2023-07-17 13:51:18] [config] seed: 1234
[2023-07-17 13:51:18] [config] sentencepiece-alphas:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:18] [config] sentencepiece-options: ""
[2023-07-17 13:51:18] [config] sharding: global
[2023-07-17 13:51:18] [config] shuffle: data
[2023-07-17 13:51:18] [config] shuffle-in-ram: false
[2023-07-17 13:51:18] [config] sigterm: save-and-exit
[2023-07-17 13:51:18] [config] skip: false
[2023-07-17 13:51:18] [config] sqlite: ""
[2023-07-17 13:51:18] [config] sqlite-drop: false
[2023-07-17 13:51:18] [config] sync-freq: 200u
[2023-07-17 13:51:18] [config] sync-sgd: false
[2023-07-17 13:51:18] [config] tempdir: /tmp
[2023-07-17 13:51:18] [config] tied-embeddings: false
[2023-07-17 13:51:18] [config] tied-embeddings-all: true
[2023-07-17 13:51:18] [config] tied-embeddings-src: false
[2023-07-17 13:51:18] [config] train-embedder-rank:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] train-sets:
[2023-07-17 13:51:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:18] [config] transformer-aan-activation: swish
[2023-07-17 13:51:18] [config] transformer-aan-depth: 2
[2023-07-17 13:51:18] [config] transformer-aan-nogate: false
[2023-07-17 13:51:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:18] [config] transformer-depth-scaling: false
[2023-07-17 13:51:18] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:18] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:18] [config] transformer-dropout: 0
[2023-07-17 13:51:18] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:18] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:18] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:18] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:18] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:18] [config] transformer-heads: 8
[2023-07-17 13:51:18] [config] transformer-no-projection: false
[2023-07-17 13:51:18] [config] transformer-pool: false
[2023-07-17 13:51:18] [config] transformer-postprocess: dan
[2023-07-17 13:51:18] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:18] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:18] [config] transformer-preprocess: ""
[2023-07-17 13:51:18] [config] transformer-tied-layers:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:18] [config] tsv: false
[2023-07-17 13:51:18] [config] tsv-fields: 0
[2023-07-17 13:51:18] [config] type: amun
[2023-07-17 13:51:18] [config] ulr: false
[2023-07-17 13:51:18] [config] ulr-dim-emb: 0
[2023-07-17 13:51:18] [config] ulr-dropout: 0
[2023-07-17 13:51:18] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:18] [config] ulr-query-vectors: ""
[2023-07-17 13:51:18] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:18] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:18] [config] unlikelihood-loss: false
[2023-07-17 13:51:18] [config] valid-freq: 50000000
[2023-07-17 13:51:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:18] [config] valid-max-length: 1000
[2023-07-17 13:51:18] [config] valid-metrics:
[2023-07-17 13:51:18] [config]   - cross-entropy
[2023-07-17 13:51:18] [config]   - translation
[2023-07-17 13:51:18] [config] valid-mini-batch: 32
[2023-07-17 13:51:18] [config] valid-reset-stalled: false
[2023-07-17 13:51:18] [config] valid-script-args:
[2023-07-17 13:51:18] [config]   []
[2023-07-17 13:51:18] [config] valid-script-path: ""
[2023-07-17 13:51:18] [config] valid-sets:
[2023-07-17 13:51:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:18] [config] vocabs:
[2023-07-17 13:51:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:18] [config] word-penalty: 0
[2023-07-17 13:51:18] [config] word-scores: false
[2023-07-17 13:51:18] [config] workspace: 5500
[2023-07-17 13:51:18] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:18] [training] Using single-device training
[2023-07-17 13:51:19] Synced seed 1234
[2023-07-17 13:51:19] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:19] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:20] [comm] Using global sharding
[2023-07-17 13:51:20] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:20] [training] Using 1 GPUs
[2023-07-17 13:51:20] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:20] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55bfd2020f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55bfd27b61fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55bfd27b6d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55bfd27b7785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55bfd2434f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55bfd24bad5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55bfd24a777c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55bfd1f7881d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55bfd2554306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55bfd2530f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55bfd2032450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55bfd1f542c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55bfd1f0bb9c]    main                                               + 0x3c
[0x7fec54e7b0b3]    __libc_start_main                                  + 0xf3
[0x55bfd1f52cbe]    _start                                             + 0x2e

[2023-07-17 13:51:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:21] [marian] Running on node22.datos.cluster.uy as process 7863 with command line:
[2023-07-17 13:51:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:21] [config] after: 0e
[2023-07-17 13:51:21] [config] after-batches: 0
[2023-07-17 13:51:21] [config] after-epochs: 100
[2023-07-17 13:51:21] [config] all-caps-every: 0
[2023-07-17 13:51:21] [config] allow-unk: false
[2023-07-17 13:51:21] [config] authors: false
[2023-07-17 13:51:21] [config] beam-size: 12
[2023-07-17 13:51:21] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:21] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:21] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:21] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:21] [config] build-info: ""
[2023-07-17 13:51:21] [config] check-gradient-nan: false
[2023-07-17 13:51:21] [config] check-nan: false
[2023-07-17 13:51:21] [config] cite: false
[2023-07-17 13:51:21] [config] clip-norm: 1
[2023-07-17 13:51:21] [config] cost-scaling:
[2023-07-17 13:51:21] [config]   - 256.f
[2023-07-17 13:51:21] [config]   - 1000
[2023-07-17 13:51:21] [config]   - 2.f
[2023-07-17 13:51:21] [config]   - 256.f
[2023-07-17 13:51:21] [config] cost-type: ce-sum
[2023-07-17 13:51:21] [config] cpu-threads: 0
[2023-07-17 13:51:21] [config] data-threads: 8
[2023-07-17 13:51:21] [config] data-weighting: ""
[2023-07-17 13:51:21] [config] data-weighting-type: sentence
[2023-07-17 13:51:21] [config] dec-cell: gru
[2023-07-17 13:51:21] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:21] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:21] [config] dec-depth: 1
[2023-07-17 13:51:21] [config] devices:
[2023-07-17 13:51:21] [config]   - 0
[2023-07-17 13:51:21] [config] dim-emb: 512
[2023-07-17 13:51:21] [config] dim-rnn: 1024
[2023-07-17 13:51:21] [config] dim-vocabs:
[2023-07-17 13:51:21] [config]   - 16384
[2023-07-17 13:51:21] [config]   - 16384
[2023-07-17 13:51:21] [config] disp-first: 0
[2023-07-17 13:51:21] [config] disp-freq: 1000u
[2023-07-17 13:51:21] [config] disp-label-counts: true
[2023-07-17 13:51:21] [config] dropout-rnn: 0
[2023-07-17 13:51:21] [config] dropout-src: 0
[2023-07-17 13:51:21] [config] dropout-trg: 0
[2023-07-17 13:51:21] [config] dump-config: ""
[2023-07-17 13:51:21] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] early-stopping: 5
[2023-07-17 13:51:21] [config] early-stopping-on: first
[2023-07-17 13:51:21] [config] embedding-fix-src: false
[2023-07-17 13:51:21] [config] embedding-fix-trg: false
[2023-07-17 13:51:21] [config] embedding-normalization: false
[2023-07-17 13:51:21] [config] embedding-vectors:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] enc-cell: gru
[2023-07-17 13:51:21] [config] enc-cell-depth: 1
[2023-07-17 13:51:21] [config] enc-depth: 1
[2023-07-17 13:51:21] [config] enc-type: bidirectional
[2023-07-17 13:51:21] [config] english-title-case-every: 0
[2023-07-17 13:51:21] [config] exponential-smoothing: 0
[2023-07-17 13:51:21] [config] factor-weight: 1
[2023-07-17 13:51:21] [config] factors-combine: sum
[2023-07-17 13:51:21] [config] factors-dim-emb: 0
[2023-07-17 13:51:21] [config] gradient-checkpointing: false
[2023-07-17 13:51:21] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:21] [config] guided-alignment: none
[2023-07-17 13:51:21] [config] guided-alignment-cost: mse
[2023-07-17 13:51:21] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:21] [config] ignore-model-config: false
[2023-07-17 13:51:21] [config] input-types:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] interpolate-env-vars: false
[2023-07-17 13:51:21] [config] keep-best: false
[2023-07-17 13:51:21] [config] label-smoothing: 0
[2023-07-17 13:51:21] [config] layer-normalization: false
[2023-07-17 13:51:21] [config] learn-rate: 0.0001
[2023-07-17 13:51:21] [config] lemma-dependency: ""
[2023-07-17 13:51:21] [config] lemma-dim-emb: 0
[2023-07-17 13:51:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:21] [config] log-level: info
[2023-07-17 13:51:21] [config] log-time-zone: ""
[2023-07-17 13:51:21] [config] logical-epoch:
[2023-07-17 13:51:21] [config]   - 1e
[2023-07-17 13:51:21] [config]   - 0
[2023-07-17 13:51:21] [config] lr-decay: 0
[2023-07-17 13:51:21] [config] lr-decay-freq: 50000
[2023-07-17 13:51:21] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:21] [config]   - 0
[2023-07-17 13:51:21] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:21] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:21] [config] lr-decay-start:
[2023-07-17 13:51:21] [config]   - 10
[2023-07-17 13:51:21] [config]   - 1
[2023-07-17 13:51:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:21] [config] lr-report: false
[2023-07-17 13:51:21] [config] lr-warmup: 0
[2023-07-17 13:51:21] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:21] [config] lr-warmup-cycle: false
[2023-07-17 13:51:21] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:21] [config] max-length: 150
[2023-07-17 13:51:21] [config] max-length-crop: true
[2023-07-17 13:51:21] [config] max-length-factor: 3
[2023-07-17 13:51:21] [config] maxi-batch: 100
[2023-07-17 13:51:21] [config] maxi-batch-sort: trg
[2023-07-17 13:51:21] [config] mini-batch: 64
[2023-07-17 13:51:21] [config] mini-batch-fit: true
[2023-07-17 13:51:21] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:21] [config] mini-batch-round-up: true
[2023-07-17 13:51:21] [config] mini-batch-track-lr: false
[2023-07-17 13:51:21] [config] mini-batch-warmup: 0
[2023-07-17 13:51:21] [config] mini-batch-words: 0
[2023-07-17 13:51:21] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:21] [config] multi-loss-type: sum
[2023-07-17 13:51:21] [config] n-best: false
[2023-07-17 13:51:21] [config] no-nccl: false
[2023-07-17 13:51:21] [config] no-reload: false
[2023-07-17 13:51:21] [config] no-restore-corpus: false
[2023-07-17 13:51:21] [config] normalize: 0
[2023-07-17 13:51:21] [config] normalize-gradient: false
[2023-07-17 13:51:21] [config] num-devices: 0
[2023-07-17 13:51:21] [config] optimizer: adam
[2023-07-17 13:51:21] [config] optimizer-delay: 1
[2023-07-17 13:51:21] [config] optimizer-params:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] output-omit-bias: false
[2023-07-17 13:51:21] [config] overwrite: true
[2023-07-17 13:51:21] [config] precision:
[2023-07-17 13:51:21] [config]   - float16
[2023-07-17 13:51:21] [config]   - float32
[2023-07-17 13:51:21] [config] pretrained-model: ""
[2023-07-17 13:51:21] [config] quantize-biases: false
[2023-07-17 13:51:21] [config] quantize-bits: 0
[2023-07-17 13:51:21] [config] quantize-log-based: false
[2023-07-17 13:51:21] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:21] [config] quiet: false
[2023-07-17 13:51:21] [config] quiet-translation: true
[2023-07-17 13:51:21] [config] relative-paths: false
[2023-07-17 13:51:21] [config] right-left: false
[2023-07-17 13:51:21] [config] save-freq: 10000u
[2023-07-17 13:51:21] [config] seed: 1234
[2023-07-17 13:51:21] [config] sentencepiece-alphas:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:21] [config] sentencepiece-options: ""
[2023-07-17 13:51:21] [config] sharding: global
[2023-07-17 13:51:21] [config] shuffle: data
[2023-07-17 13:51:21] [config] shuffle-in-ram: false
[2023-07-17 13:51:21] [config] sigterm: save-and-exit
[2023-07-17 13:51:21] [config] skip: false
[2023-07-17 13:51:21] [config] sqlite: ""
[2023-07-17 13:51:21] [config] sqlite-drop: false
[2023-07-17 13:51:21] [config] sync-freq: 200u
[2023-07-17 13:51:21] [config] sync-sgd: false
[2023-07-17 13:51:21] [config] tempdir: /tmp
[2023-07-17 13:51:21] [config] tied-embeddings: false
[2023-07-17 13:51:21] [config] tied-embeddings-all: true
[2023-07-17 13:51:21] [config] tied-embeddings-src: false
[2023-07-17 13:51:21] [config] train-embedder-rank:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] train-sets:
[2023-07-17 13:51:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:21] [config] transformer-aan-activation: swish
[2023-07-17 13:51:21] [config] transformer-aan-depth: 2
[2023-07-17 13:51:21] [config] transformer-aan-nogate: false
[2023-07-17 13:51:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:21] [config] transformer-depth-scaling: false
[2023-07-17 13:51:21] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:21] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:21] [config] transformer-dropout: 0
[2023-07-17 13:51:21] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:21] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:21] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:21] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:21] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:21] [config] transformer-heads: 8
[2023-07-17 13:51:21] [config] transformer-no-projection: false
[2023-07-17 13:51:21] [config] transformer-pool: false
[2023-07-17 13:51:21] [config] transformer-postprocess: dan
[2023-07-17 13:51:21] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:21] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:21] [config] transformer-preprocess: ""
[2023-07-17 13:51:21] [config] transformer-tied-layers:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:21] [config] tsv: false
[2023-07-17 13:51:21] [config] tsv-fields: 0
[2023-07-17 13:51:21] [config] type: amun
[2023-07-17 13:51:21] [config] ulr: false
[2023-07-17 13:51:21] [config] ulr-dim-emb: 0
[2023-07-17 13:51:21] [config] ulr-dropout: 0
[2023-07-17 13:51:21] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:21] [config] ulr-query-vectors: ""
[2023-07-17 13:51:21] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:21] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:21] [config] unlikelihood-loss: false
[2023-07-17 13:51:21] [config] valid-freq: 50000000
[2023-07-17 13:51:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:21] [config] valid-max-length: 1000
[2023-07-17 13:51:21] [config] valid-metrics:
[2023-07-17 13:51:21] [config]   - cross-entropy
[2023-07-17 13:51:21] [config]   - translation
[2023-07-17 13:51:21] [config] valid-mini-batch: 32
[2023-07-17 13:51:21] [config] valid-reset-stalled: false
[2023-07-17 13:51:21] [config] valid-script-args:
[2023-07-17 13:51:21] [config]   []
[2023-07-17 13:51:21] [config] valid-script-path: ""
[2023-07-17 13:51:21] [config] valid-sets:
[2023-07-17 13:51:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:21] [config] vocabs:
[2023-07-17 13:51:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:21] [config] word-penalty: 0
[2023-07-17 13:51:21] [config] word-scores: false
[2023-07-17 13:51:21] [config] workspace: 5500
[2023-07-17 13:51:21] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:21] [training] Using single-device training
[2023-07-17 13:51:21] Synced seed 1234
[2023-07-17 13:51:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:21] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:22] [comm] Using global sharding
[2023-07-17 13:51:22] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:22] [training] Using 1 GPUs
[2023-07-17 13:51:22] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:22] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x5651f27d3f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5651f2f691fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5651f2f69d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5651f2f6a785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x5651f2be7f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5651f2c6dd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x5651f2c5a77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x5651f272b81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x5651f2d07306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x5651f2ce3f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x5651f27e5450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5651f27072c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5651f26beb9c]    main                                               + 0x3c
[0x7fab67d5e0b3]    __libc_start_main                                  + 0xf3
[0x5651f2705cbe]    _start                                             + 0x2e

[2023-07-17 13:51:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:23] [marian] Running on node22.datos.cluster.uy as process 7895 with command line:
[2023-07-17 13:51:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:23] [config] after: 0e
[2023-07-17 13:51:23] [config] after-batches: 0
[2023-07-17 13:51:23] [config] after-epochs: 110
[2023-07-17 13:51:23] [config] all-caps-every: 0
[2023-07-17 13:51:23] [config] allow-unk: false
[2023-07-17 13:51:23] [config] authors: false
[2023-07-17 13:51:23] [config] beam-size: 12
[2023-07-17 13:51:23] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:23] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:23] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:23] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:23] [config] build-info: ""
[2023-07-17 13:51:23] [config] check-gradient-nan: false
[2023-07-17 13:51:23] [config] check-nan: false
[2023-07-17 13:51:23] [config] cite: false
[2023-07-17 13:51:23] [config] clip-norm: 1
[2023-07-17 13:51:23] [config] cost-scaling:
[2023-07-17 13:51:23] [config]   - 256.f
[2023-07-17 13:51:23] [config]   - 1000
[2023-07-17 13:51:23] [config]   - 2.f
[2023-07-17 13:51:23] [config]   - 256.f
[2023-07-17 13:51:23] [config] cost-type: ce-sum
[2023-07-17 13:51:23] [config] cpu-threads: 0
[2023-07-17 13:51:23] [config] data-threads: 8
[2023-07-17 13:51:23] [config] data-weighting: ""
[2023-07-17 13:51:23] [config] data-weighting-type: sentence
[2023-07-17 13:51:23] [config] dec-cell: gru
[2023-07-17 13:51:23] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:23] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:23] [config] dec-depth: 1
[2023-07-17 13:51:23] [config] devices:
[2023-07-17 13:51:23] [config]   - 0
[2023-07-17 13:51:23] [config] dim-emb: 512
[2023-07-17 13:51:23] [config] dim-rnn: 1024
[2023-07-17 13:51:23] [config] dim-vocabs:
[2023-07-17 13:51:23] [config]   - 16384
[2023-07-17 13:51:23] [config]   - 16384
[2023-07-17 13:51:23] [config] disp-first: 0
[2023-07-17 13:51:23] [config] disp-freq: 1000u
[2023-07-17 13:51:23] [config] disp-label-counts: true
[2023-07-17 13:51:23] [config] dropout-rnn: 0
[2023-07-17 13:51:23] [config] dropout-src: 0
[2023-07-17 13:51:23] [config] dropout-trg: 0
[2023-07-17 13:51:23] [config] dump-config: ""
[2023-07-17 13:51:23] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] early-stopping: 5
[2023-07-17 13:51:23] [config] early-stopping-on: first
[2023-07-17 13:51:23] [config] embedding-fix-src: false
[2023-07-17 13:51:23] [config] embedding-fix-trg: false
[2023-07-17 13:51:23] [config] embedding-normalization: false
[2023-07-17 13:51:23] [config] embedding-vectors:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] enc-cell: gru
[2023-07-17 13:51:23] [config] enc-cell-depth: 1
[2023-07-17 13:51:23] [config] enc-depth: 1
[2023-07-17 13:51:23] [config] enc-type: bidirectional
[2023-07-17 13:51:23] [config] english-title-case-every: 0
[2023-07-17 13:51:23] [config] exponential-smoothing: 0
[2023-07-17 13:51:23] [config] factor-weight: 1
[2023-07-17 13:51:23] [config] factors-combine: sum
[2023-07-17 13:51:23] [config] factors-dim-emb: 0
[2023-07-17 13:51:23] [config] gradient-checkpointing: false
[2023-07-17 13:51:23] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:23] [config] guided-alignment: none
[2023-07-17 13:51:23] [config] guided-alignment-cost: mse
[2023-07-17 13:51:23] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:23] [config] ignore-model-config: false
[2023-07-17 13:51:23] [config] input-types:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] interpolate-env-vars: false
[2023-07-17 13:51:23] [config] keep-best: false
[2023-07-17 13:51:23] [config] label-smoothing: 0
[2023-07-17 13:51:23] [config] layer-normalization: false
[2023-07-17 13:51:23] [config] learn-rate: 0.0001
[2023-07-17 13:51:23] [config] lemma-dependency: ""
[2023-07-17 13:51:23] [config] lemma-dim-emb: 0
[2023-07-17 13:51:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:23] [config] log-level: info
[2023-07-17 13:51:23] [config] log-time-zone: ""
[2023-07-17 13:51:23] [config] logical-epoch:
[2023-07-17 13:51:23] [config]   - 1e
[2023-07-17 13:51:23] [config]   - 0
[2023-07-17 13:51:23] [config] lr-decay: 0
[2023-07-17 13:51:23] [config] lr-decay-freq: 50000
[2023-07-17 13:51:23] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:23] [config]   - 0
[2023-07-17 13:51:23] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:23] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:23] [config] lr-decay-start:
[2023-07-17 13:51:23] [config]   - 10
[2023-07-17 13:51:23] [config]   - 1
[2023-07-17 13:51:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:23] [config] lr-report: false
[2023-07-17 13:51:23] [config] lr-warmup: 0
[2023-07-17 13:51:23] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:23] [config] lr-warmup-cycle: false
[2023-07-17 13:51:23] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:23] [config] max-length: 150
[2023-07-17 13:51:23] [config] max-length-crop: true
[2023-07-17 13:51:23] [config] max-length-factor: 3
[2023-07-17 13:51:23] [config] maxi-batch: 100
[2023-07-17 13:51:23] [config] maxi-batch-sort: trg
[2023-07-17 13:51:23] [config] mini-batch: 64
[2023-07-17 13:51:23] [config] mini-batch-fit: true
[2023-07-17 13:51:23] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:23] [config] mini-batch-round-up: true
[2023-07-17 13:51:23] [config] mini-batch-track-lr: false
[2023-07-17 13:51:23] [config] mini-batch-warmup: 0
[2023-07-17 13:51:23] [config] mini-batch-words: 0
[2023-07-17 13:51:23] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:23] [config] multi-loss-type: sum
[2023-07-17 13:51:23] [config] n-best: false
[2023-07-17 13:51:23] [config] no-nccl: false
[2023-07-17 13:51:23] [config] no-reload: false
[2023-07-17 13:51:23] [config] no-restore-corpus: false
[2023-07-17 13:51:23] [config] normalize: 0
[2023-07-17 13:51:23] [config] normalize-gradient: false
[2023-07-17 13:51:23] [config] num-devices: 0
[2023-07-17 13:51:23] [config] optimizer: adam
[2023-07-17 13:51:23] [config] optimizer-delay: 1
[2023-07-17 13:51:23] [config] optimizer-params:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] output-omit-bias: false
[2023-07-17 13:51:23] [config] overwrite: true
[2023-07-17 13:51:23] [config] precision:
[2023-07-17 13:51:23] [config]   - float16
[2023-07-17 13:51:23] [config]   - float32
[2023-07-17 13:51:23] [config] pretrained-model: ""
[2023-07-17 13:51:23] [config] quantize-biases: false
[2023-07-17 13:51:23] [config] quantize-bits: 0
[2023-07-17 13:51:23] [config] quantize-log-based: false
[2023-07-17 13:51:23] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:23] [config] quiet: false
[2023-07-17 13:51:23] [config] quiet-translation: true
[2023-07-17 13:51:23] [config] relative-paths: false
[2023-07-17 13:51:23] [config] right-left: false
[2023-07-17 13:51:23] [config] save-freq: 10000u
[2023-07-17 13:51:23] [config] seed: 1234
[2023-07-17 13:51:23] [config] sentencepiece-alphas:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:23] [config] sentencepiece-options: ""
[2023-07-17 13:51:23] [config] sharding: global
[2023-07-17 13:51:23] [config] shuffle: data
[2023-07-17 13:51:23] [config] shuffle-in-ram: false
[2023-07-17 13:51:23] [config] sigterm: save-and-exit
[2023-07-17 13:51:23] [config] skip: false
[2023-07-17 13:51:23] [config] sqlite: ""
[2023-07-17 13:51:23] [config] sqlite-drop: false
[2023-07-17 13:51:23] [config] sync-freq: 200u
[2023-07-17 13:51:23] [config] sync-sgd: false
[2023-07-17 13:51:23] [config] tempdir: /tmp
[2023-07-17 13:51:23] [config] tied-embeddings: false
[2023-07-17 13:51:23] [config] tied-embeddings-all: true
[2023-07-17 13:51:23] [config] tied-embeddings-src: false
[2023-07-17 13:51:23] [config] train-embedder-rank:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] train-sets:
[2023-07-17 13:51:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:23] [config] transformer-aan-activation: swish
[2023-07-17 13:51:23] [config] transformer-aan-depth: 2
[2023-07-17 13:51:23] [config] transformer-aan-nogate: false
[2023-07-17 13:51:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:23] [config] transformer-depth-scaling: false
[2023-07-17 13:51:23] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:23] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:23] [config] transformer-dropout: 0
[2023-07-17 13:51:23] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:23] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:23] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:23] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:23] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:23] [config] transformer-heads: 8
[2023-07-17 13:51:23] [config] transformer-no-projection: false
[2023-07-17 13:51:23] [config] transformer-pool: false
[2023-07-17 13:51:23] [config] transformer-postprocess: dan
[2023-07-17 13:51:23] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:23] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:23] [config] transformer-preprocess: ""
[2023-07-17 13:51:23] [config] transformer-tied-layers:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:23] [config] tsv: false
[2023-07-17 13:51:23] [config] tsv-fields: 0
[2023-07-17 13:51:23] [config] type: amun
[2023-07-17 13:51:23] [config] ulr: false
[2023-07-17 13:51:23] [config] ulr-dim-emb: 0
[2023-07-17 13:51:23] [config] ulr-dropout: 0
[2023-07-17 13:51:23] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:23] [config] ulr-query-vectors: ""
[2023-07-17 13:51:23] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:23] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:23] [config] unlikelihood-loss: false
[2023-07-17 13:51:23] [config] valid-freq: 50000000
[2023-07-17 13:51:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:23] [config] valid-max-length: 1000
[2023-07-17 13:51:23] [config] valid-metrics:
[2023-07-17 13:51:23] [config]   - cross-entropy
[2023-07-17 13:51:23] [config]   - translation
[2023-07-17 13:51:23] [config] valid-mini-batch: 32
[2023-07-17 13:51:23] [config] valid-reset-stalled: false
[2023-07-17 13:51:23] [config] valid-script-args:
[2023-07-17 13:51:23] [config]   []
[2023-07-17 13:51:23] [config] valid-script-path: ""
[2023-07-17 13:51:23] [config] valid-sets:
[2023-07-17 13:51:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:23] [config] vocabs:
[2023-07-17 13:51:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:23] [config] word-penalty: 0
[2023-07-17 13:51:23] [config] word-scores: false
[2023-07-17 13:51:23] [config] workspace: 5500
[2023-07-17 13:51:23] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:23] [training] Using single-device training
[2023-07-17 13:51:24] Synced seed 1234
[2023-07-17 13:51:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:24] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:25] [comm] Using global sharding
[2023-07-17 13:51:25] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:25] [training] Using 1 GPUs
[2023-07-17 13:51:25] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:25] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x56185c94ff01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x56185d0e51fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x56185d0e5d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x56185d0e6785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x56185cd63f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x56185cde9d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x56185cdd677c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x56185c8a781d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x56185ce83306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x56185ce5ff2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x56185c961450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x56185c8832c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56185c83ab9c]    main                                               + 0x3c
[0x7f46d6c1e0b3]    __libc_start_main                                  + 0xf3
[0x56185c881cbe]    _start                                             + 0x2e

[2023-07-17 13:51:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:26] [marian] Running on node22.datos.cluster.uy as process 7925 with command line:
[2023-07-17 13:51:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:26] [config] after: 0e
[2023-07-17 13:51:26] [config] after-batches: 0
[2023-07-17 13:51:26] [config] after-epochs: 120
[2023-07-17 13:51:26] [config] all-caps-every: 0
[2023-07-17 13:51:26] [config] allow-unk: false
[2023-07-17 13:51:26] [config] authors: false
[2023-07-17 13:51:26] [config] beam-size: 12
[2023-07-17 13:51:26] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:26] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:26] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:26] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:26] [config] build-info: ""
[2023-07-17 13:51:26] [config] check-gradient-nan: false
[2023-07-17 13:51:26] [config] check-nan: false
[2023-07-17 13:51:26] [config] cite: false
[2023-07-17 13:51:26] [config] clip-norm: 1
[2023-07-17 13:51:26] [config] cost-scaling:
[2023-07-17 13:51:26] [config]   - 256.f
[2023-07-17 13:51:26] [config]   - 1000
[2023-07-17 13:51:26] [config]   - 2.f
[2023-07-17 13:51:26] [config]   - 256.f
[2023-07-17 13:51:26] [config] cost-type: ce-sum
[2023-07-17 13:51:26] [config] cpu-threads: 0
[2023-07-17 13:51:26] [config] data-threads: 8
[2023-07-17 13:51:26] [config] data-weighting: ""
[2023-07-17 13:51:26] [config] data-weighting-type: sentence
[2023-07-17 13:51:26] [config] dec-cell: gru
[2023-07-17 13:51:26] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:26] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:26] [config] dec-depth: 1
[2023-07-17 13:51:26] [config] devices:
[2023-07-17 13:51:26] [config]   - 0
[2023-07-17 13:51:26] [config] dim-emb: 512
[2023-07-17 13:51:26] [config] dim-rnn: 1024
[2023-07-17 13:51:26] [config] dim-vocabs:
[2023-07-17 13:51:26] [config]   - 16384
[2023-07-17 13:51:26] [config]   - 16384
[2023-07-17 13:51:26] [config] disp-first: 0
[2023-07-17 13:51:26] [config] disp-freq: 1000u
[2023-07-17 13:51:26] [config] disp-label-counts: true
[2023-07-17 13:51:26] [config] dropout-rnn: 0
[2023-07-17 13:51:26] [config] dropout-src: 0
[2023-07-17 13:51:26] [config] dropout-trg: 0
[2023-07-17 13:51:26] [config] dump-config: ""
[2023-07-17 13:51:26] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] early-stopping: 5
[2023-07-17 13:51:26] [config] early-stopping-on: first
[2023-07-17 13:51:26] [config] embedding-fix-src: false
[2023-07-17 13:51:26] [config] embedding-fix-trg: false
[2023-07-17 13:51:26] [config] embedding-normalization: false
[2023-07-17 13:51:26] [config] embedding-vectors:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] enc-cell: gru
[2023-07-17 13:51:26] [config] enc-cell-depth: 1
[2023-07-17 13:51:26] [config] enc-depth: 1
[2023-07-17 13:51:26] [config] enc-type: bidirectional
[2023-07-17 13:51:26] [config] english-title-case-every: 0
[2023-07-17 13:51:26] [config] exponential-smoothing: 0
[2023-07-17 13:51:26] [config] factor-weight: 1
[2023-07-17 13:51:26] [config] factors-combine: sum
[2023-07-17 13:51:26] [config] factors-dim-emb: 0
[2023-07-17 13:51:26] [config] gradient-checkpointing: false
[2023-07-17 13:51:26] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:26] [config] guided-alignment: none
[2023-07-17 13:51:26] [config] guided-alignment-cost: mse
[2023-07-17 13:51:26] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:26] [config] ignore-model-config: false
[2023-07-17 13:51:26] [config] input-types:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] interpolate-env-vars: false
[2023-07-17 13:51:26] [config] keep-best: false
[2023-07-17 13:51:26] [config] label-smoothing: 0
[2023-07-17 13:51:26] [config] layer-normalization: false
[2023-07-17 13:51:26] [config] learn-rate: 0.0001
[2023-07-17 13:51:26] [config] lemma-dependency: ""
[2023-07-17 13:51:26] [config] lemma-dim-emb: 0
[2023-07-17 13:51:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:26] [config] log-level: info
[2023-07-17 13:51:26] [config] log-time-zone: ""
[2023-07-17 13:51:26] [config] logical-epoch:
[2023-07-17 13:51:26] [config]   - 1e
[2023-07-17 13:51:26] [config]   - 0
[2023-07-17 13:51:26] [config] lr-decay: 0
[2023-07-17 13:51:26] [config] lr-decay-freq: 50000
[2023-07-17 13:51:26] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:26] [config]   - 0
[2023-07-17 13:51:26] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:26] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:26] [config] lr-decay-start:
[2023-07-17 13:51:26] [config]   - 10
[2023-07-17 13:51:26] [config]   - 1
[2023-07-17 13:51:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:26] [config] lr-report: false
[2023-07-17 13:51:26] [config] lr-warmup: 0
[2023-07-17 13:51:26] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:26] [config] lr-warmup-cycle: false
[2023-07-17 13:51:26] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:26] [config] max-length: 150
[2023-07-17 13:51:26] [config] max-length-crop: true
[2023-07-17 13:51:26] [config] max-length-factor: 3
[2023-07-17 13:51:26] [config] maxi-batch: 100
[2023-07-17 13:51:26] [config] maxi-batch-sort: trg
[2023-07-17 13:51:26] [config] mini-batch: 64
[2023-07-17 13:51:26] [config] mini-batch-fit: true
[2023-07-17 13:51:26] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:26] [config] mini-batch-round-up: true
[2023-07-17 13:51:26] [config] mini-batch-track-lr: false
[2023-07-17 13:51:26] [config] mini-batch-warmup: 0
[2023-07-17 13:51:26] [config] mini-batch-words: 0
[2023-07-17 13:51:26] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:26] [config] multi-loss-type: sum
[2023-07-17 13:51:26] [config] n-best: false
[2023-07-17 13:51:26] [config] no-nccl: false
[2023-07-17 13:51:26] [config] no-reload: false
[2023-07-17 13:51:26] [config] no-restore-corpus: false
[2023-07-17 13:51:26] [config] normalize: 0
[2023-07-17 13:51:26] [config] normalize-gradient: false
[2023-07-17 13:51:26] [config] num-devices: 0
[2023-07-17 13:51:26] [config] optimizer: adam
[2023-07-17 13:51:26] [config] optimizer-delay: 1
[2023-07-17 13:51:26] [config] optimizer-params:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] output-omit-bias: false
[2023-07-17 13:51:26] [config] overwrite: true
[2023-07-17 13:51:26] [config] precision:
[2023-07-17 13:51:26] [config]   - float16
[2023-07-17 13:51:26] [config]   - float32
[2023-07-17 13:51:26] [config] pretrained-model: ""
[2023-07-17 13:51:26] [config] quantize-biases: false
[2023-07-17 13:51:26] [config] quantize-bits: 0
[2023-07-17 13:51:26] [config] quantize-log-based: false
[2023-07-17 13:51:26] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:26] [config] quiet: false
[2023-07-17 13:51:26] [config] quiet-translation: true
[2023-07-17 13:51:26] [config] relative-paths: false
[2023-07-17 13:51:26] [config] right-left: false
[2023-07-17 13:51:26] [config] save-freq: 10000u
[2023-07-17 13:51:26] [config] seed: 1234
[2023-07-17 13:51:26] [config] sentencepiece-alphas:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:26] [config] sentencepiece-options: ""
[2023-07-17 13:51:26] [config] sharding: global
[2023-07-17 13:51:26] [config] shuffle: data
[2023-07-17 13:51:26] [config] shuffle-in-ram: false
[2023-07-17 13:51:26] [config] sigterm: save-and-exit
[2023-07-17 13:51:26] [config] skip: false
[2023-07-17 13:51:26] [config] sqlite: ""
[2023-07-17 13:51:26] [config] sqlite-drop: false
[2023-07-17 13:51:26] [config] sync-freq: 200u
[2023-07-17 13:51:26] [config] sync-sgd: false
[2023-07-17 13:51:26] [config] tempdir: /tmp
[2023-07-17 13:51:26] [config] tied-embeddings: false
[2023-07-17 13:51:26] [config] tied-embeddings-all: true
[2023-07-17 13:51:26] [config] tied-embeddings-src: false
[2023-07-17 13:51:26] [config] train-embedder-rank:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] train-sets:
[2023-07-17 13:51:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:26] [config] transformer-aan-activation: swish
[2023-07-17 13:51:26] [config] transformer-aan-depth: 2
[2023-07-17 13:51:26] [config] transformer-aan-nogate: false
[2023-07-17 13:51:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:26] [config] transformer-depth-scaling: false
[2023-07-17 13:51:26] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:26] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:26] [config] transformer-dropout: 0
[2023-07-17 13:51:26] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:26] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:26] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:26] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:26] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:26] [config] transformer-heads: 8
[2023-07-17 13:51:26] [config] transformer-no-projection: false
[2023-07-17 13:51:26] [config] transformer-pool: false
[2023-07-17 13:51:26] [config] transformer-postprocess: dan
[2023-07-17 13:51:26] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:26] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:26] [config] transformer-preprocess: ""
[2023-07-17 13:51:26] [config] transformer-tied-layers:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:26] [config] tsv: false
[2023-07-17 13:51:26] [config] tsv-fields: 0
[2023-07-17 13:51:26] [config] type: amun
[2023-07-17 13:51:26] [config] ulr: false
[2023-07-17 13:51:26] [config] ulr-dim-emb: 0
[2023-07-17 13:51:26] [config] ulr-dropout: 0
[2023-07-17 13:51:26] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:26] [config] ulr-query-vectors: ""
[2023-07-17 13:51:26] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:26] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:26] [config] unlikelihood-loss: false
[2023-07-17 13:51:26] [config] valid-freq: 50000000
[2023-07-17 13:51:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:26] [config] valid-max-length: 1000
[2023-07-17 13:51:26] [config] valid-metrics:
[2023-07-17 13:51:26] [config]   - cross-entropy
[2023-07-17 13:51:26] [config]   - translation
[2023-07-17 13:51:26] [config] valid-mini-batch: 32
[2023-07-17 13:51:26] [config] valid-reset-stalled: false
[2023-07-17 13:51:26] [config] valid-script-args:
[2023-07-17 13:51:26] [config]   []
[2023-07-17 13:51:26] [config] valid-script-path: ""
[2023-07-17 13:51:26] [config] valid-sets:
[2023-07-17 13:51:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:26] [config] vocabs:
[2023-07-17 13:51:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:26] [config] word-penalty: 0
[2023-07-17 13:51:26] [config] word-scores: false
[2023-07-17 13:51:26] [config] workspace: 5500
[2023-07-17 13:51:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:26] [training] Using single-device training
[2023-07-17 13:51:26] Synced seed 1234
[2023-07-17 13:51:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:26] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:26] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:28] [comm] Using global sharding
[2023-07-17 13:51:28] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:28] [training] Using 1 GPUs
[2023-07-17 13:51:28] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:28] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x559b5754af01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x559b57ce01fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x559b57ce0d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x559b57ce1785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x559b5795ef3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x559b579e4d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x559b579d177c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x559b574a281d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x559b57a7e306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x559b57a5af2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x559b5755c450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x559b5747e2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x559b57435b9c]    main                                               + 0x3c
[0x7f262ca790b3]    __libc_start_main                                  + 0xf3
[0x559b5747ccbe]    _start                                             + 0x2e

[2023-07-17 13:51:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:29] [marian] Running on node22.datos.cluster.uy as process 7956 with command line:
[2023-07-17 13:51:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:29] [config] after: 0e
[2023-07-17 13:51:29] [config] after-batches: 0
[2023-07-17 13:51:29] [config] after-epochs: 130
[2023-07-17 13:51:29] [config] all-caps-every: 0
[2023-07-17 13:51:29] [config] allow-unk: false
[2023-07-17 13:51:29] [config] authors: false
[2023-07-17 13:51:29] [config] beam-size: 12
[2023-07-17 13:51:29] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:29] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:29] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:29] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:29] [config] build-info: ""
[2023-07-17 13:51:29] [config] check-gradient-nan: false
[2023-07-17 13:51:29] [config] check-nan: false
[2023-07-17 13:51:29] [config] cite: false
[2023-07-17 13:51:29] [config] clip-norm: 1
[2023-07-17 13:51:29] [config] cost-scaling:
[2023-07-17 13:51:29] [config]   - 256.f
[2023-07-17 13:51:29] [config]   - 1000
[2023-07-17 13:51:29] [config]   - 2.f
[2023-07-17 13:51:29] [config]   - 256.f
[2023-07-17 13:51:29] [config] cost-type: ce-sum
[2023-07-17 13:51:29] [config] cpu-threads: 0
[2023-07-17 13:51:29] [config] data-threads: 8
[2023-07-17 13:51:29] [config] data-weighting: ""
[2023-07-17 13:51:29] [config] data-weighting-type: sentence
[2023-07-17 13:51:29] [config] dec-cell: gru
[2023-07-17 13:51:29] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:29] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:29] [config] dec-depth: 1
[2023-07-17 13:51:29] [config] devices:
[2023-07-17 13:51:29] [config]   - 0
[2023-07-17 13:51:29] [config] dim-emb: 512
[2023-07-17 13:51:29] [config] dim-rnn: 1024
[2023-07-17 13:51:29] [config] dim-vocabs:
[2023-07-17 13:51:29] [config]   - 16384
[2023-07-17 13:51:29] [config]   - 16384
[2023-07-17 13:51:29] [config] disp-first: 0
[2023-07-17 13:51:29] [config] disp-freq: 1000u
[2023-07-17 13:51:29] [config] disp-label-counts: true
[2023-07-17 13:51:29] [config] dropout-rnn: 0
[2023-07-17 13:51:29] [config] dropout-src: 0
[2023-07-17 13:51:29] [config] dropout-trg: 0
[2023-07-17 13:51:29] [config] dump-config: ""
[2023-07-17 13:51:29] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] early-stopping: 5
[2023-07-17 13:51:29] [config] early-stopping-on: first
[2023-07-17 13:51:29] [config] embedding-fix-src: false
[2023-07-17 13:51:29] [config] embedding-fix-trg: false
[2023-07-17 13:51:29] [config] embedding-normalization: false
[2023-07-17 13:51:29] [config] embedding-vectors:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] enc-cell: gru
[2023-07-17 13:51:29] [config] enc-cell-depth: 1
[2023-07-17 13:51:29] [config] enc-depth: 1
[2023-07-17 13:51:29] [config] enc-type: bidirectional
[2023-07-17 13:51:29] [config] english-title-case-every: 0
[2023-07-17 13:51:29] [config] exponential-smoothing: 0
[2023-07-17 13:51:29] [config] factor-weight: 1
[2023-07-17 13:51:29] [config] factors-combine: sum
[2023-07-17 13:51:29] [config] factors-dim-emb: 0
[2023-07-17 13:51:29] [config] gradient-checkpointing: false
[2023-07-17 13:51:29] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:29] [config] guided-alignment: none
[2023-07-17 13:51:29] [config] guided-alignment-cost: mse
[2023-07-17 13:51:29] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:29] [config] ignore-model-config: false
[2023-07-17 13:51:29] [config] input-types:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] interpolate-env-vars: false
[2023-07-17 13:51:29] [config] keep-best: false
[2023-07-17 13:51:29] [config] label-smoothing: 0
[2023-07-17 13:51:29] [config] layer-normalization: false
[2023-07-17 13:51:29] [config] learn-rate: 0.0001
[2023-07-17 13:51:29] [config] lemma-dependency: ""
[2023-07-17 13:51:29] [config] lemma-dim-emb: 0
[2023-07-17 13:51:29] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:29] [config] log-level: info
[2023-07-17 13:51:29] [config] log-time-zone: ""
[2023-07-17 13:51:29] [config] logical-epoch:
[2023-07-17 13:51:29] [config]   - 1e
[2023-07-17 13:51:29] [config]   - 0
[2023-07-17 13:51:29] [config] lr-decay: 0
[2023-07-17 13:51:29] [config] lr-decay-freq: 50000
[2023-07-17 13:51:29] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:29] [config]   - 0
[2023-07-17 13:51:29] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:29] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:29] [config] lr-decay-start:
[2023-07-17 13:51:29] [config]   - 10
[2023-07-17 13:51:29] [config]   - 1
[2023-07-17 13:51:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:29] [config] lr-report: false
[2023-07-17 13:51:29] [config] lr-warmup: 0
[2023-07-17 13:51:29] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:29] [config] lr-warmup-cycle: false
[2023-07-17 13:51:29] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:29] [config] max-length: 150
[2023-07-17 13:51:29] [config] max-length-crop: true
[2023-07-17 13:51:29] [config] max-length-factor: 3
[2023-07-17 13:51:29] [config] maxi-batch: 100
[2023-07-17 13:51:29] [config] maxi-batch-sort: trg
[2023-07-17 13:51:29] [config] mini-batch: 64
[2023-07-17 13:51:29] [config] mini-batch-fit: true
[2023-07-17 13:51:29] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:29] [config] mini-batch-round-up: true
[2023-07-17 13:51:29] [config] mini-batch-track-lr: false
[2023-07-17 13:51:29] [config] mini-batch-warmup: 0
[2023-07-17 13:51:29] [config] mini-batch-words: 0
[2023-07-17 13:51:29] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:29] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:29] [config] multi-loss-type: sum
[2023-07-17 13:51:29] [config] n-best: false
[2023-07-17 13:51:29] [config] no-nccl: false
[2023-07-17 13:51:29] [config] no-reload: false
[2023-07-17 13:51:29] [config] no-restore-corpus: false
[2023-07-17 13:51:29] [config] normalize: 0
[2023-07-17 13:51:29] [config] normalize-gradient: false
[2023-07-17 13:51:29] [config] num-devices: 0
[2023-07-17 13:51:29] [config] optimizer: adam
[2023-07-17 13:51:29] [config] optimizer-delay: 1
[2023-07-17 13:51:29] [config] optimizer-params:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] output-omit-bias: false
[2023-07-17 13:51:29] [config] overwrite: true
[2023-07-17 13:51:29] [config] precision:
[2023-07-17 13:51:29] [config]   - float16
[2023-07-17 13:51:29] [config]   - float32
[2023-07-17 13:51:29] [config] pretrained-model: ""
[2023-07-17 13:51:29] [config] quantize-biases: false
[2023-07-17 13:51:29] [config] quantize-bits: 0
[2023-07-17 13:51:29] [config] quantize-log-based: false
[2023-07-17 13:51:29] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:29] [config] quiet: false
[2023-07-17 13:51:29] [config] quiet-translation: true
[2023-07-17 13:51:29] [config] relative-paths: false
[2023-07-17 13:51:29] [config] right-left: false
[2023-07-17 13:51:29] [config] save-freq: 10000u
[2023-07-17 13:51:29] [config] seed: 1234
[2023-07-17 13:51:29] [config] sentencepiece-alphas:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:29] [config] sentencepiece-options: ""
[2023-07-17 13:51:29] [config] sharding: global
[2023-07-17 13:51:29] [config] shuffle: data
[2023-07-17 13:51:29] [config] shuffle-in-ram: false
[2023-07-17 13:51:29] [config] sigterm: save-and-exit
[2023-07-17 13:51:29] [config] skip: false
[2023-07-17 13:51:29] [config] sqlite: ""
[2023-07-17 13:51:29] [config] sqlite-drop: false
[2023-07-17 13:51:29] [config] sync-freq: 200u
[2023-07-17 13:51:29] [config] sync-sgd: false
[2023-07-17 13:51:29] [config] tempdir: /tmp
[2023-07-17 13:51:29] [config] tied-embeddings: false
[2023-07-17 13:51:29] [config] tied-embeddings-all: true
[2023-07-17 13:51:29] [config] tied-embeddings-src: false
[2023-07-17 13:51:29] [config] train-embedder-rank:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] train-sets:
[2023-07-17 13:51:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:29] [config] transformer-aan-activation: swish
[2023-07-17 13:51:29] [config] transformer-aan-depth: 2
[2023-07-17 13:51:29] [config] transformer-aan-nogate: false
[2023-07-17 13:51:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:29] [config] transformer-depth-scaling: false
[2023-07-17 13:51:29] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:29] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:29] [config] transformer-dropout: 0
[2023-07-17 13:51:29] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:29] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:29] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:29] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:29] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:29] [config] transformer-heads: 8
[2023-07-17 13:51:29] [config] transformer-no-projection: false
[2023-07-17 13:51:29] [config] transformer-pool: false
[2023-07-17 13:51:29] [config] transformer-postprocess: dan
[2023-07-17 13:51:29] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:29] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:29] [config] transformer-preprocess: ""
[2023-07-17 13:51:29] [config] transformer-tied-layers:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:29] [config] tsv: false
[2023-07-17 13:51:29] [config] tsv-fields: 0
[2023-07-17 13:51:29] [config] type: amun
[2023-07-17 13:51:29] [config] ulr: false
[2023-07-17 13:51:29] [config] ulr-dim-emb: 0
[2023-07-17 13:51:29] [config] ulr-dropout: 0
[2023-07-17 13:51:29] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:29] [config] ulr-query-vectors: ""
[2023-07-17 13:51:29] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:29] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:29] [config] unlikelihood-loss: false
[2023-07-17 13:51:29] [config] valid-freq: 50000000
[2023-07-17 13:51:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:29] [config] valid-max-length: 1000
[2023-07-17 13:51:29] [config] valid-metrics:
[2023-07-17 13:51:29] [config]   - cross-entropy
[2023-07-17 13:51:29] [config]   - translation
[2023-07-17 13:51:29] [config] valid-mini-batch: 32
[2023-07-17 13:51:29] [config] valid-reset-stalled: false
[2023-07-17 13:51:29] [config] valid-script-args:
[2023-07-17 13:51:29] [config]   []
[2023-07-17 13:51:29] [config] valid-script-path: ""
[2023-07-17 13:51:29] [config] valid-sets:
[2023-07-17 13:51:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:29] [config] vocabs:
[2023-07-17 13:51:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:29] [config] word-penalty: 0
[2023-07-17 13:51:29] [config] word-scores: false
[2023-07-17 13:51:29] [config] workspace: 5500
[2023-07-17 13:51:29] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:29] [training] Using single-device training
[2023-07-17 13:51:29] Synced seed 1234
[2023-07-17 13:51:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:29] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:30] [comm] Using global sharding
[2023-07-17 13:51:30] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:30] [training] Using 1 GPUs
[2023-07-17 13:51:30] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:30] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x5586ea142f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5586ea8d81fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5586ea8d8d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5586ea8d9785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x5586ea556f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5586ea5dcd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x5586ea5c977c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x5586ea09a81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x5586ea676306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x5586ea652f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x5586ea154450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5586ea0762c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5586ea02db9c]    main                                               + 0x3c
[0x7f89f04b20b3]    __libc_start_main                                  + 0xf3
[0x5586ea074cbe]    _start                                             + 0x2e

[2023-07-17 13:51:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:31] [marian] Running on node22.datos.cluster.uy as process 7986 with command line:
[2023-07-17 13:51:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:31] [config] after: 0e
[2023-07-17 13:51:31] [config] after-batches: 0
[2023-07-17 13:51:31] [config] after-epochs: 140
[2023-07-17 13:51:31] [config] all-caps-every: 0
[2023-07-17 13:51:31] [config] allow-unk: false
[2023-07-17 13:51:31] [config] authors: false
[2023-07-17 13:51:31] [config] beam-size: 12
[2023-07-17 13:51:31] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:31] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:31] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:31] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:31] [config] build-info: ""
[2023-07-17 13:51:31] [config] check-gradient-nan: false
[2023-07-17 13:51:31] [config] check-nan: false
[2023-07-17 13:51:31] [config] cite: false
[2023-07-17 13:51:31] [config] clip-norm: 1
[2023-07-17 13:51:31] [config] cost-scaling:
[2023-07-17 13:51:31] [config]   - 256.f
[2023-07-17 13:51:31] [config]   - 1000
[2023-07-17 13:51:31] [config]   - 2.f
[2023-07-17 13:51:31] [config]   - 256.f
[2023-07-17 13:51:31] [config] cost-type: ce-sum
[2023-07-17 13:51:31] [config] cpu-threads: 0
[2023-07-17 13:51:31] [config] data-threads: 8
[2023-07-17 13:51:31] [config] data-weighting: ""
[2023-07-17 13:51:31] [config] data-weighting-type: sentence
[2023-07-17 13:51:31] [config] dec-cell: gru
[2023-07-17 13:51:31] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:31] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:31] [config] dec-depth: 1
[2023-07-17 13:51:31] [config] devices:
[2023-07-17 13:51:31] [config]   - 0
[2023-07-17 13:51:31] [config] dim-emb: 512
[2023-07-17 13:51:31] [config] dim-rnn: 1024
[2023-07-17 13:51:31] [config] dim-vocabs:
[2023-07-17 13:51:31] [config]   - 16384
[2023-07-17 13:51:31] [config]   - 16384
[2023-07-17 13:51:31] [config] disp-first: 0
[2023-07-17 13:51:31] [config] disp-freq: 1000u
[2023-07-17 13:51:31] [config] disp-label-counts: true
[2023-07-17 13:51:31] [config] dropout-rnn: 0
[2023-07-17 13:51:31] [config] dropout-src: 0
[2023-07-17 13:51:31] [config] dropout-trg: 0
[2023-07-17 13:51:31] [config] dump-config: ""
[2023-07-17 13:51:31] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] early-stopping: 5
[2023-07-17 13:51:31] [config] early-stopping-on: first
[2023-07-17 13:51:31] [config] embedding-fix-src: false
[2023-07-17 13:51:31] [config] embedding-fix-trg: false
[2023-07-17 13:51:31] [config] embedding-normalization: false
[2023-07-17 13:51:31] [config] embedding-vectors:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] enc-cell: gru
[2023-07-17 13:51:31] [config] enc-cell-depth: 1
[2023-07-17 13:51:31] [config] enc-depth: 1
[2023-07-17 13:51:31] [config] enc-type: bidirectional
[2023-07-17 13:51:31] [config] english-title-case-every: 0
[2023-07-17 13:51:31] [config] exponential-smoothing: 0
[2023-07-17 13:51:31] [config] factor-weight: 1
[2023-07-17 13:51:31] [config] factors-combine: sum
[2023-07-17 13:51:31] [config] factors-dim-emb: 0
[2023-07-17 13:51:31] [config] gradient-checkpointing: false
[2023-07-17 13:51:31] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:31] [config] guided-alignment: none
[2023-07-17 13:51:31] [config] guided-alignment-cost: mse
[2023-07-17 13:51:31] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:31] [config] ignore-model-config: false
[2023-07-17 13:51:31] [config] input-types:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] interpolate-env-vars: false
[2023-07-17 13:51:31] [config] keep-best: false
[2023-07-17 13:51:31] [config] label-smoothing: 0
[2023-07-17 13:51:31] [config] layer-normalization: false
[2023-07-17 13:51:31] [config] learn-rate: 0.0001
[2023-07-17 13:51:31] [config] lemma-dependency: ""
[2023-07-17 13:51:31] [config] lemma-dim-emb: 0
[2023-07-17 13:51:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:31] [config] log-level: info
[2023-07-17 13:51:31] [config] log-time-zone: ""
[2023-07-17 13:51:31] [config] logical-epoch:
[2023-07-17 13:51:31] [config]   - 1e
[2023-07-17 13:51:31] [config]   - 0
[2023-07-17 13:51:31] [config] lr-decay: 0
[2023-07-17 13:51:31] [config] lr-decay-freq: 50000
[2023-07-17 13:51:31] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:31] [config]   - 0
[2023-07-17 13:51:31] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:31] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:31] [config] lr-decay-start:
[2023-07-17 13:51:31] [config]   - 10
[2023-07-17 13:51:31] [config]   - 1
[2023-07-17 13:51:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:31] [config] lr-report: false
[2023-07-17 13:51:31] [config] lr-warmup: 0
[2023-07-17 13:51:31] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:31] [config] lr-warmup-cycle: false
[2023-07-17 13:51:31] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:31] [config] max-length: 150
[2023-07-17 13:51:31] [config] max-length-crop: true
[2023-07-17 13:51:31] [config] max-length-factor: 3
[2023-07-17 13:51:31] [config] maxi-batch: 100
[2023-07-17 13:51:31] [config] maxi-batch-sort: trg
[2023-07-17 13:51:31] [config] mini-batch: 64
[2023-07-17 13:51:31] [config] mini-batch-fit: true
[2023-07-17 13:51:31] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:31] [config] mini-batch-round-up: true
[2023-07-17 13:51:31] [config] mini-batch-track-lr: false
[2023-07-17 13:51:31] [config] mini-batch-warmup: 0
[2023-07-17 13:51:31] [config] mini-batch-words: 0
[2023-07-17 13:51:31] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:31] [config] multi-loss-type: sum
[2023-07-17 13:51:31] [config] n-best: false
[2023-07-17 13:51:31] [config] no-nccl: false
[2023-07-17 13:51:31] [config] no-reload: false
[2023-07-17 13:51:31] [config] no-restore-corpus: false
[2023-07-17 13:51:31] [config] normalize: 0
[2023-07-17 13:51:31] [config] normalize-gradient: false
[2023-07-17 13:51:31] [config] num-devices: 0
[2023-07-17 13:51:31] [config] optimizer: adam
[2023-07-17 13:51:31] [config] optimizer-delay: 1
[2023-07-17 13:51:31] [config] optimizer-params:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] output-omit-bias: false
[2023-07-17 13:51:31] [config] overwrite: true
[2023-07-17 13:51:31] [config] precision:
[2023-07-17 13:51:31] [config]   - float16
[2023-07-17 13:51:31] [config]   - float32
[2023-07-17 13:51:31] [config] pretrained-model: ""
[2023-07-17 13:51:31] [config] quantize-biases: false
[2023-07-17 13:51:31] [config] quantize-bits: 0
[2023-07-17 13:51:31] [config] quantize-log-based: false
[2023-07-17 13:51:31] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:31] [config] quiet: false
[2023-07-17 13:51:31] [config] quiet-translation: true
[2023-07-17 13:51:31] [config] relative-paths: false
[2023-07-17 13:51:31] [config] right-left: false
[2023-07-17 13:51:31] [config] save-freq: 10000u
[2023-07-17 13:51:31] [config] seed: 1234
[2023-07-17 13:51:31] [config] sentencepiece-alphas:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:31] [config] sentencepiece-options: ""
[2023-07-17 13:51:31] [config] sharding: global
[2023-07-17 13:51:31] [config] shuffle: data
[2023-07-17 13:51:31] [config] shuffle-in-ram: false
[2023-07-17 13:51:31] [config] sigterm: save-and-exit
[2023-07-17 13:51:31] [config] skip: false
[2023-07-17 13:51:31] [config] sqlite: ""
[2023-07-17 13:51:31] [config] sqlite-drop: false
[2023-07-17 13:51:31] [config] sync-freq: 200u
[2023-07-17 13:51:31] [config] sync-sgd: false
[2023-07-17 13:51:31] [config] tempdir: /tmp
[2023-07-17 13:51:31] [config] tied-embeddings: false
[2023-07-17 13:51:31] [config] tied-embeddings-all: true
[2023-07-17 13:51:31] [config] tied-embeddings-src: false
[2023-07-17 13:51:31] [config] train-embedder-rank:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] train-sets:
[2023-07-17 13:51:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:31] [config] transformer-aan-activation: swish
[2023-07-17 13:51:31] [config] transformer-aan-depth: 2
[2023-07-17 13:51:31] [config] transformer-aan-nogate: false
[2023-07-17 13:51:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:31] [config] transformer-depth-scaling: false
[2023-07-17 13:51:31] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:31] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:31] [config] transformer-dropout: 0
[2023-07-17 13:51:31] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:31] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:31] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:31] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:31] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:31] [config] transformer-heads: 8
[2023-07-17 13:51:31] [config] transformer-no-projection: false
[2023-07-17 13:51:31] [config] transformer-pool: false
[2023-07-17 13:51:31] [config] transformer-postprocess: dan
[2023-07-17 13:51:31] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:31] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:31] [config] transformer-preprocess: ""
[2023-07-17 13:51:31] [config] transformer-tied-layers:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:31] [config] tsv: false
[2023-07-17 13:51:31] [config] tsv-fields: 0
[2023-07-17 13:51:31] [config] type: amun
[2023-07-17 13:51:31] [config] ulr: false
[2023-07-17 13:51:31] [config] ulr-dim-emb: 0
[2023-07-17 13:51:31] [config] ulr-dropout: 0
[2023-07-17 13:51:31] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:31] [config] ulr-query-vectors: ""
[2023-07-17 13:51:31] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:31] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:31] [config] unlikelihood-loss: false
[2023-07-17 13:51:31] [config] valid-freq: 50000000
[2023-07-17 13:51:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:31] [config] valid-max-length: 1000
[2023-07-17 13:51:31] [config] valid-metrics:
[2023-07-17 13:51:31] [config]   - cross-entropy
[2023-07-17 13:51:31] [config]   - translation
[2023-07-17 13:51:31] [config] valid-mini-batch: 32
[2023-07-17 13:51:31] [config] valid-reset-stalled: false
[2023-07-17 13:51:31] [config] valid-script-args:
[2023-07-17 13:51:31] [config]   []
[2023-07-17 13:51:31] [config] valid-script-path: ""
[2023-07-17 13:51:31] [config] valid-sets:
[2023-07-17 13:51:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:31] [config] vocabs:
[2023-07-17 13:51:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:31] [config] word-penalty: 0
[2023-07-17 13:51:31] [config] word-scores: false
[2023-07-17 13:51:31] [config] workspace: 5500
[2023-07-17 13:51:31] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:31] [training] Using single-device training
[2023-07-17 13:51:32] Synced seed 1234
[2023-07-17 13:51:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:32] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:32] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:32] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:32] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:33] [comm] Using global sharding
[2023-07-17 13:51:33] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:33] [training] Using 1 GPUs
[2023-07-17 13:51:33] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:33] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x564241b4ef01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5642422e41fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5642422e4d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5642422e5785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x564241f62f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x564241fe8d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x564241fd577c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x564241aa681d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x564242082306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x56424205ef2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x564241b60450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x564241a822c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x564241a39b9c]    main                                               + 0x3c
[0x7f694257c0b3]    __libc_start_main                                  + 0xf3
[0x564241a80cbe]    _start                                             + 0x2e

[2023-07-17 13:51:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:34] [marian] Running on node22.datos.cluster.uy as process 8016 with command line:
[2023-07-17 13:51:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:34] [config] after: 0e
[2023-07-17 13:51:34] [config] after-batches: 0
[2023-07-17 13:51:34] [config] after-epochs: 150
[2023-07-17 13:51:34] [config] all-caps-every: 0
[2023-07-17 13:51:34] [config] allow-unk: false
[2023-07-17 13:51:34] [config] authors: false
[2023-07-17 13:51:34] [config] beam-size: 12
[2023-07-17 13:51:34] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:34] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:34] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:34] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:34] [config] build-info: ""
[2023-07-17 13:51:34] [config] check-gradient-nan: false
[2023-07-17 13:51:34] [config] check-nan: false
[2023-07-17 13:51:34] [config] cite: false
[2023-07-17 13:51:34] [config] clip-norm: 1
[2023-07-17 13:51:34] [config] cost-scaling:
[2023-07-17 13:51:34] [config]   - 256.f
[2023-07-17 13:51:34] [config]   - 1000
[2023-07-17 13:51:34] [config]   - 2.f
[2023-07-17 13:51:34] [config]   - 256.f
[2023-07-17 13:51:34] [config] cost-type: ce-sum
[2023-07-17 13:51:34] [config] cpu-threads: 0
[2023-07-17 13:51:34] [config] data-threads: 8
[2023-07-17 13:51:34] [config] data-weighting: ""
[2023-07-17 13:51:34] [config] data-weighting-type: sentence
[2023-07-17 13:51:34] [config] dec-cell: gru
[2023-07-17 13:51:34] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:34] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:34] [config] dec-depth: 1
[2023-07-17 13:51:34] [config] devices:
[2023-07-17 13:51:34] [config]   - 0
[2023-07-17 13:51:34] [config] dim-emb: 512
[2023-07-17 13:51:34] [config] dim-rnn: 1024
[2023-07-17 13:51:34] [config] dim-vocabs:
[2023-07-17 13:51:34] [config]   - 16384
[2023-07-17 13:51:34] [config]   - 16384
[2023-07-17 13:51:34] [config] disp-first: 0
[2023-07-17 13:51:34] [config] disp-freq: 1000u
[2023-07-17 13:51:34] [config] disp-label-counts: true
[2023-07-17 13:51:34] [config] dropout-rnn: 0
[2023-07-17 13:51:34] [config] dropout-src: 0
[2023-07-17 13:51:34] [config] dropout-trg: 0
[2023-07-17 13:51:34] [config] dump-config: ""
[2023-07-17 13:51:34] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] early-stopping: 5
[2023-07-17 13:51:34] [config] early-stopping-on: first
[2023-07-17 13:51:34] [config] embedding-fix-src: false
[2023-07-17 13:51:34] [config] embedding-fix-trg: false
[2023-07-17 13:51:34] [config] embedding-normalization: false
[2023-07-17 13:51:34] [config] embedding-vectors:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] enc-cell: gru
[2023-07-17 13:51:34] [config] enc-cell-depth: 1
[2023-07-17 13:51:34] [config] enc-depth: 1
[2023-07-17 13:51:34] [config] enc-type: bidirectional
[2023-07-17 13:51:34] [config] english-title-case-every: 0
[2023-07-17 13:51:34] [config] exponential-smoothing: 0
[2023-07-17 13:51:34] [config] factor-weight: 1
[2023-07-17 13:51:34] [config] factors-combine: sum
[2023-07-17 13:51:34] [config] factors-dim-emb: 0
[2023-07-17 13:51:34] [config] gradient-checkpointing: false
[2023-07-17 13:51:34] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:34] [config] guided-alignment: none
[2023-07-17 13:51:34] [config] guided-alignment-cost: mse
[2023-07-17 13:51:34] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:34] [config] ignore-model-config: false
[2023-07-17 13:51:34] [config] input-types:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] interpolate-env-vars: false
[2023-07-17 13:51:34] [config] keep-best: false
[2023-07-17 13:51:34] [config] label-smoothing: 0
[2023-07-17 13:51:34] [config] layer-normalization: false
[2023-07-17 13:51:34] [config] learn-rate: 0.0001
[2023-07-17 13:51:34] [config] lemma-dependency: ""
[2023-07-17 13:51:34] [config] lemma-dim-emb: 0
[2023-07-17 13:51:34] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:34] [config] log-level: info
[2023-07-17 13:51:34] [config] log-time-zone: ""
[2023-07-17 13:51:34] [config] logical-epoch:
[2023-07-17 13:51:34] [config]   - 1e
[2023-07-17 13:51:34] [config]   - 0
[2023-07-17 13:51:34] [config] lr-decay: 0
[2023-07-17 13:51:34] [config] lr-decay-freq: 50000
[2023-07-17 13:51:34] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:34] [config]   - 0
[2023-07-17 13:51:34] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:34] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:34] [config] lr-decay-start:
[2023-07-17 13:51:34] [config]   - 10
[2023-07-17 13:51:34] [config]   - 1
[2023-07-17 13:51:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:34] [config] lr-report: false
[2023-07-17 13:51:34] [config] lr-warmup: 0
[2023-07-17 13:51:34] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:34] [config] lr-warmup-cycle: false
[2023-07-17 13:51:34] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:34] [config] max-length: 150
[2023-07-17 13:51:34] [config] max-length-crop: true
[2023-07-17 13:51:34] [config] max-length-factor: 3
[2023-07-17 13:51:34] [config] maxi-batch: 100
[2023-07-17 13:51:34] [config] maxi-batch-sort: trg
[2023-07-17 13:51:34] [config] mini-batch: 64
[2023-07-17 13:51:34] [config] mini-batch-fit: true
[2023-07-17 13:51:34] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:34] [config] mini-batch-round-up: true
[2023-07-17 13:51:34] [config] mini-batch-track-lr: false
[2023-07-17 13:51:34] [config] mini-batch-warmup: 0
[2023-07-17 13:51:34] [config] mini-batch-words: 0
[2023-07-17 13:51:34] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:34] [config] multi-loss-type: sum
[2023-07-17 13:51:34] [config] n-best: false
[2023-07-17 13:51:34] [config] no-nccl: false
[2023-07-17 13:51:34] [config] no-reload: false
[2023-07-17 13:51:34] [config] no-restore-corpus: false
[2023-07-17 13:51:34] [config] normalize: 0
[2023-07-17 13:51:34] [config] normalize-gradient: false
[2023-07-17 13:51:34] [config] num-devices: 0
[2023-07-17 13:51:34] [config] optimizer: adam
[2023-07-17 13:51:34] [config] optimizer-delay: 1
[2023-07-17 13:51:34] [config] optimizer-params:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] output-omit-bias: false
[2023-07-17 13:51:34] [config] overwrite: true
[2023-07-17 13:51:34] [config] precision:
[2023-07-17 13:51:34] [config]   - float16
[2023-07-17 13:51:34] [config]   - float32
[2023-07-17 13:51:34] [config] pretrained-model: ""
[2023-07-17 13:51:34] [config] quantize-biases: false
[2023-07-17 13:51:34] [config] quantize-bits: 0
[2023-07-17 13:51:34] [config] quantize-log-based: false
[2023-07-17 13:51:34] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:34] [config] quiet: false
[2023-07-17 13:51:34] [config] quiet-translation: true
[2023-07-17 13:51:34] [config] relative-paths: false
[2023-07-17 13:51:34] [config] right-left: false
[2023-07-17 13:51:34] [config] save-freq: 10000u
[2023-07-17 13:51:34] [config] seed: 1234
[2023-07-17 13:51:34] [config] sentencepiece-alphas:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:34] [config] sentencepiece-options: ""
[2023-07-17 13:51:34] [config] sharding: global
[2023-07-17 13:51:34] [config] shuffle: data
[2023-07-17 13:51:34] [config] shuffle-in-ram: false
[2023-07-17 13:51:34] [config] sigterm: save-and-exit
[2023-07-17 13:51:34] [config] skip: false
[2023-07-17 13:51:34] [config] sqlite: ""
[2023-07-17 13:51:34] [config] sqlite-drop: false
[2023-07-17 13:51:34] [config] sync-freq: 200u
[2023-07-17 13:51:34] [config] sync-sgd: false
[2023-07-17 13:51:34] [config] tempdir: /tmp
[2023-07-17 13:51:34] [config] tied-embeddings: false
[2023-07-17 13:51:34] [config] tied-embeddings-all: true
[2023-07-17 13:51:34] [config] tied-embeddings-src: false
[2023-07-17 13:51:34] [config] train-embedder-rank:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] train-sets:
[2023-07-17 13:51:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:34] [config] transformer-aan-activation: swish
[2023-07-17 13:51:34] [config] transformer-aan-depth: 2
[2023-07-17 13:51:34] [config] transformer-aan-nogate: false
[2023-07-17 13:51:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:34] [config] transformer-depth-scaling: false
[2023-07-17 13:51:34] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:34] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:34] [config] transformer-dropout: 0
[2023-07-17 13:51:34] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:34] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:34] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:34] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:34] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:34] [config] transformer-heads: 8
[2023-07-17 13:51:34] [config] transformer-no-projection: false
[2023-07-17 13:51:34] [config] transformer-pool: false
[2023-07-17 13:51:34] [config] transformer-postprocess: dan
[2023-07-17 13:51:34] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:34] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:34] [config] transformer-preprocess: ""
[2023-07-17 13:51:34] [config] transformer-tied-layers:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:34] [config] tsv: false
[2023-07-17 13:51:34] [config] tsv-fields: 0
[2023-07-17 13:51:34] [config] type: amun
[2023-07-17 13:51:34] [config] ulr: false
[2023-07-17 13:51:34] [config] ulr-dim-emb: 0
[2023-07-17 13:51:34] [config] ulr-dropout: 0
[2023-07-17 13:51:34] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:34] [config] ulr-query-vectors: ""
[2023-07-17 13:51:34] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:34] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:34] [config] unlikelihood-loss: false
[2023-07-17 13:51:34] [config] valid-freq: 50000000
[2023-07-17 13:51:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:34] [config] valid-max-length: 1000
[2023-07-17 13:51:34] [config] valid-metrics:
[2023-07-17 13:51:34] [config]   - cross-entropy
[2023-07-17 13:51:34] [config]   - translation
[2023-07-17 13:51:34] [config] valid-mini-batch: 32
[2023-07-17 13:51:34] [config] valid-reset-stalled: false
[2023-07-17 13:51:34] [config] valid-script-args:
[2023-07-17 13:51:34] [config]   []
[2023-07-17 13:51:34] [config] valid-script-path: ""
[2023-07-17 13:51:34] [config] valid-sets:
[2023-07-17 13:51:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:34] [config] vocabs:
[2023-07-17 13:51:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:34] [config] word-penalty: 0
[2023-07-17 13:51:34] [config] word-scores: false
[2023-07-17 13:51:34] [config] workspace: 5500
[2023-07-17 13:51:34] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:34] [training] Using single-device training
[2023-07-17 13:51:34] Synced seed 1234
[2023-07-17 13:51:34] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:34] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:35] [comm] Using global sharding
[2023-07-17 13:51:36] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:36] [training] Using 1 GPUs
[2023-07-17 13:51:36] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:36] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x557b34f3df01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x557b356d31fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x557b356d3d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x557b356d4785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x557b35351f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x557b353d7d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x557b353c477c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x557b34e9581d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x557b35471306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x557b3544df2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x557b34f4f450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x557b34e712c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x557b34e28b9c]    main                                               + 0x3c
[0x7f0c5197f0b3]    __libc_start_main                                  + 0xf3
[0x557b34e6fcbe]    _start                                             + 0x2e

[2023-07-17 13:51:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:36] [marian] Running on node22.datos.cluster.uy as process 8046 with command line:
[2023-07-17 13:51:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:36] [config] after: 0e
[2023-07-17 13:51:36] [config] after-batches: 0
[2023-07-17 13:51:36] [config] after-epochs: 160
[2023-07-17 13:51:36] [config] all-caps-every: 0
[2023-07-17 13:51:36] [config] allow-unk: false
[2023-07-17 13:51:36] [config] authors: false
[2023-07-17 13:51:36] [config] beam-size: 12
[2023-07-17 13:51:36] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:36] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:36] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:36] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:36] [config] build-info: ""
[2023-07-17 13:51:36] [config] check-gradient-nan: false
[2023-07-17 13:51:36] [config] check-nan: false
[2023-07-17 13:51:36] [config] cite: false
[2023-07-17 13:51:36] [config] clip-norm: 1
[2023-07-17 13:51:36] [config] cost-scaling:
[2023-07-17 13:51:36] [config]   - 256.f
[2023-07-17 13:51:36] [config]   - 1000
[2023-07-17 13:51:36] [config]   - 2.f
[2023-07-17 13:51:36] [config]   - 256.f
[2023-07-17 13:51:36] [config] cost-type: ce-sum
[2023-07-17 13:51:36] [config] cpu-threads: 0
[2023-07-17 13:51:36] [config] data-threads: 8
[2023-07-17 13:51:36] [config] data-weighting: ""
[2023-07-17 13:51:36] [config] data-weighting-type: sentence
[2023-07-17 13:51:36] [config] dec-cell: gru
[2023-07-17 13:51:36] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:36] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:36] [config] dec-depth: 1
[2023-07-17 13:51:36] [config] devices:
[2023-07-17 13:51:36] [config]   - 0
[2023-07-17 13:51:36] [config] dim-emb: 512
[2023-07-17 13:51:36] [config] dim-rnn: 1024
[2023-07-17 13:51:36] [config] dim-vocabs:
[2023-07-17 13:51:36] [config]   - 16384
[2023-07-17 13:51:36] [config]   - 16384
[2023-07-17 13:51:36] [config] disp-first: 0
[2023-07-17 13:51:36] [config] disp-freq: 1000u
[2023-07-17 13:51:36] [config] disp-label-counts: true
[2023-07-17 13:51:36] [config] dropout-rnn: 0
[2023-07-17 13:51:36] [config] dropout-src: 0
[2023-07-17 13:51:36] [config] dropout-trg: 0
[2023-07-17 13:51:36] [config] dump-config: ""
[2023-07-17 13:51:36] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] early-stopping: 5
[2023-07-17 13:51:36] [config] early-stopping-on: first
[2023-07-17 13:51:36] [config] embedding-fix-src: false
[2023-07-17 13:51:36] [config] embedding-fix-trg: false
[2023-07-17 13:51:36] [config] embedding-normalization: false
[2023-07-17 13:51:36] [config] embedding-vectors:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] enc-cell: gru
[2023-07-17 13:51:36] [config] enc-cell-depth: 1
[2023-07-17 13:51:36] [config] enc-depth: 1
[2023-07-17 13:51:36] [config] enc-type: bidirectional
[2023-07-17 13:51:36] [config] english-title-case-every: 0
[2023-07-17 13:51:36] [config] exponential-smoothing: 0
[2023-07-17 13:51:36] [config] factor-weight: 1
[2023-07-17 13:51:36] [config] factors-combine: sum
[2023-07-17 13:51:36] [config] factors-dim-emb: 0
[2023-07-17 13:51:36] [config] gradient-checkpointing: false
[2023-07-17 13:51:36] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:36] [config] guided-alignment: none
[2023-07-17 13:51:36] [config] guided-alignment-cost: mse
[2023-07-17 13:51:36] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:36] [config] ignore-model-config: false
[2023-07-17 13:51:36] [config] input-types:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] interpolate-env-vars: false
[2023-07-17 13:51:36] [config] keep-best: false
[2023-07-17 13:51:36] [config] label-smoothing: 0
[2023-07-17 13:51:36] [config] layer-normalization: false
[2023-07-17 13:51:36] [config] learn-rate: 0.0001
[2023-07-17 13:51:36] [config] lemma-dependency: ""
[2023-07-17 13:51:36] [config] lemma-dim-emb: 0
[2023-07-17 13:51:36] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:36] [config] log-level: info
[2023-07-17 13:51:36] [config] log-time-zone: ""
[2023-07-17 13:51:36] [config] logical-epoch:
[2023-07-17 13:51:36] [config]   - 1e
[2023-07-17 13:51:36] [config]   - 0
[2023-07-17 13:51:36] [config] lr-decay: 0
[2023-07-17 13:51:36] [config] lr-decay-freq: 50000
[2023-07-17 13:51:36] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:36] [config]   - 0
[2023-07-17 13:51:36] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:36] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:36] [config] lr-decay-start:
[2023-07-17 13:51:36] [config]   - 10
[2023-07-17 13:51:36] [config]   - 1
[2023-07-17 13:51:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:36] [config] lr-report: false
[2023-07-17 13:51:36] [config] lr-warmup: 0
[2023-07-17 13:51:36] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:36] [config] lr-warmup-cycle: false
[2023-07-17 13:51:36] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:36] [config] max-length: 150
[2023-07-17 13:51:36] [config] max-length-crop: true
[2023-07-17 13:51:36] [config] max-length-factor: 3
[2023-07-17 13:51:36] [config] maxi-batch: 100
[2023-07-17 13:51:36] [config] maxi-batch-sort: trg
[2023-07-17 13:51:36] [config] mini-batch: 64
[2023-07-17 13:51:36] [config] mini-batch-fit: true
[2023-07-17 13:51:36] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:36] [config] mini-batch-round-up: true
[2023-07-17 13:51:36] [config] mini-batch-track-lr: false
[2023-07-17 13:51:36] [config] mini-batch-warmup: 0
[2023-07-17 13:51:36] [config] mini-batch-words: 0
[2023-07-17 13:51:36] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:36] [config] multi-loss-type: sum
[2023-07-17 13:51:36] [config] n-best: false
[2023-07-17 13:51:36] [config] no-nccl: false
[2023-07-17 13:51:36] [config] no-reload: false
[2023-07-17 13:51:36] [config] no-restore-corpus: false
[2023-07-17 13:51:36] [config] normalize: 0
[2023-07-17 13:51:36] [config] normalize-gradient: false
[2023-07-17 13:51:36] [config] num-devices: 0
[2023-07-17 13:51:36] [config] optimizer: adam
[2023-07-17 13:51:36] [config] optimizer-delay: 1
[2023-07-17 13:51:36] [config] optimizer-params:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] output-omit-bias: false
[2023-07-17 13:51:36] [config] overwrite: true
[2023-07-17 13:51:36] [config] precision:
[2023-07-17 13:51:36] [config]   - float16
[2023-07-17 13:51:36] [config]   - float32
[2023-07-17 13:51:36] [config] pretrained-model: ""
[2023-07-17 13:51:36] [config] quantize-biases: false
[2023-07-17 13:51:36] [config] quantize-bits: 0
[2023-07-17 13:51:36] [config] quantize-log-based: false
[2023-07-17 13:51:36] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:36] [config] quiet: false
[2023-07-17 13:51:36] [config] quiet-translation: true
[2023-07-17 13:51:36] [config] relative-paths: false
[2023-07-17 13:51:36] [config] right-left: false
[2023-07-17 13:51:36] [config] save-freq: 10000u
[2023-07-17 13:51:36] [config] seed: 1234
[2023-07-17 13:51:36] [config] sentencepiece-alphas:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:36] [config] sentencepiece-options: ""
[2023-07-17 13:51:36] [config] sharding: global
[2023-07-17 13:51:36] [config] shuffle: data
[2023-07-17 13:51:36] [config] shuffle-in-ram: false
[2023-07-17 13:51:36] [config] sigterm: save-and-exit
[2023-07-17 13:51:36] [config] skip: false
[2023-07-17 13:51:36] [config] sqlite: ""
[2023-07-17 13:51:36] [config] sqlite-drop: false
[2023-07-17 13:51:36] [config] sync-freq: 200u
[2023-07-17 13:51:36] [config] sync-sgd: false
[2023-07-17 13:51:36] [config] tempdir: /tmp
[2023-07-17 13:51:36] [config] tied-embeddings: false
[2023-07-17 13:51:36] [config] tied-embeddings-all: true
[2023-07-17 13:51:36] [config] tied-embeddings-src: false
[2023-07-17 13:51:36] [config] train-embedder-rank:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] train-sets:
[2023-07-17 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:36] [config] transformer-aan-activation: swish
[2023-07-17 13:51:36] [config] transformer-aan-depth: 2
[2023-07-17 13:51:36] [config] transformer-aan-nogate: false
[2023-07-17 13:51:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:36] [config] transformer-depth-scaling: false
[2023-07-17 13:51:36] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:36] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:36] [config] transformer-dropout: 0
[2023-07-17 13:51:36] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:36] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:36] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:36] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:36] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:36] [config] transformer-heads: 8
[2023-07-17 13:51:36] [config] transformer-no-projection: false
[2023-07-17 13:51:36] [config] transformer-pool: false
[2023-07-17 13:51:36] [config] transformer-postprocess: dan
[2023-07-17 13:51:36] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:36] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:36] [config] transformer-preprocess: ""
[2023-07-17 13:51:36] [config] transformer-tied-layers:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:36] [config] tsv: false
[2023-07-17 13:51:36] [config] tsv-fields: 0
[2023-07-17 13:51:36] [config] type: amun
[2023-07-17 13:51:36] [config] ulr: false
[2023-07-17 13:51:36] [config] ulr-dim-emb: 0
[2023-07-17 13:51:36] [config] ulr-dropout: 0
[2023-07-17 13:51:36] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:36] [config] ulr-query-vectors: ""
[2023-07-17 13:51:36] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:36] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:36] [config] unlikelihood-loss: false
[2023-07-17 13:51:36] [config] valid-freq: 50000000
[2023-07-17 13:51:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:36] [config] valid-max-length: 1000
[2023-07-17 13:51:36] [config] valid-metrics:
[2023-07-17 13:51:36] [config]   - cross-entropy
[2023-07-17 13:51:36] [config]   - translation
[2023-07-17 13:51:36] [config] valid-mini-batch: 32
[2023-07-17 13:51:36] [config] valid-reset-stalled: false
[2023-07-17 13:51:36] [config] valid-script-args:
[2023-07-17 13:51:36] [config]   []
[2023-07-17 13:51:36] [config] valid-script-path: ""
[2023-07-17 13:51:36] [config] valid-sets:
[2023-07-17 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:36] [config] vocabs:
[2023-07-17 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:36] [config] word-penalty: 0
[2023-07-17 13:51:36] [config] word-scores: false
[2023-07-17 13:51:36] [config] workspace: 5500
[2023-07-17 13:51:36] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:36] [training] Using single-device training
[2023-07-17 13:51:37] Synced seed 1234
[2023-07-17 13:51:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:37] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:37] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:38] [comm] Using global sharding
[2023-07-17 13:51:38] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:38] [training] Using 1 GPUs
[2023-07-17 13:51:38] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:38] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x559770765f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x559770efb1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x559770efbd6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x559770efc785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x559770b79f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x559770bffd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x559770bec77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x5597706bd81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x559770c99306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x559770c75f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x559770777450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5597706992c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x559770650b9c]    main                                               + 0x3c
[0x7f83b8d4d0b3]    __libc_start_main                                  + 0xf3
[0x559770697cbe]    _start                                             + 0x2e

[2023-07-17 13:51:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:39] [marian] Running on node22.datos.cluster.uy as process 8076 with command line:
[2023-07-17 13:51:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:39] [config] after: 0e
[2023-07-17 13:51:39] [config] after-batches: 0
[2023-07-17 13:51:39] [config] after-epochs: 170
[2023-07-17 13:51:39] [config] all-caps-every: 0
[2023-07-17 13:51:39] [config] allow-unk: false
[2023-07-17 13:51:39] [config] authors: false
[2023-07-17 13:51:39] [config] beam-size: 12
[2023-07-17 13:51:39] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:39] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:39] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:39] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:39] [config] build-info: ""
[2023-07-17 13:51:39] [config] check-gradient-nan: false
[2023-07-17 13:51:39] [config] check-nan: false
[2023-07-17 13:51:39] [config] cite: false
[2023-07-17 13:51:39] [config] clip-norm: 1
[2023-07-17 13:51:39] [config] cost-scaling:
[2023-07-17 13:51:39] [config]   - 256.f
[2023-07-17 13:51:39] [config]   - 1000
[2023-07-17 13:51:39] [config]   - 2.f
[2023-07-17 13:51:39] [config]   - 256.f
[2023-07-17 13:51:39] [config] cost-type: ce-sum
[2023-07-17 13:51:39] [config] cpu-threads: 0
[2023-07-17 13:51:39] [config] data-threads: 8
[2023-07-17 13:51:39] [config] data-weighting: ""
[2023-07-17 13:51:39] [config] data-weighting-type: sentence
[2023-07-17 13:51:39] [config] dec-cell: gru
[2023-07-17 13:51:39] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:39] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:39] [config] dec-depth: 1
[2023-07-17 13:51:39] [config] devices:
[2023-07-17 13:51:39] [config]   - 0
[2023-07-17 13:51:39] [config] dim-emb: 512
[2023-07-17 13:51:39] [config] dim-rnn: 1024
[2023-07-17 13:51:39] [config] dim-vocabs:
[2023-07-17 13:51:39] [config]   - 16384
[2023-07-17 13:51:39] [config]   - 16384
[2023-07-17 13:51:39] [config] disp-first: 0
[2023-07-17 13:51:39] [config] disp-freq: 1000u
[2023-07-17 13:51:39] [config] disp-label-counts: true
[2023-07-17 13:51:39] [config] dropout-rnn: 0
[2023-07-17 13:51:39] [config] dropout-src: 0
[2023-07-17 13:51:39] [config] dropout-trg: 0
[2023-07-17 13:51:39] [config] dump-config: ""
[2023-07-17 13:51:39] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] early-stopping: 5
[2023-07-17 13:51:39] [config] early-stopping-on: first
[2023-07-17 13:51:39] [config] embedding-fix-src: false
[2023-07-17 13:51:39] [config] embedding-fix-trg: false
[2023-07-17 13:51:39] [config] embedding-normalization: false
[2023-07-17 13:51:39] [config] embedding-vectors:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] enc-cell: gru
[2023-07-17 13:51:39] [config] enc-cell-depth: 1
[2023-07-17 13:51:39] [config] enc-depth: 1
[2023-07-17 13:51:39] [config] enc-type: bidirectional
[2023-07-17 13:51:39] [config] english-title-case-every: 0
[2023-07-17 13:51:39] [config] exponential-smoothing: 0
[2023-07-17 13:51:39] [config] factor-weight: 1
[2023-07-17 13:51:39] [config] factors-combine: sum
[2023-07-17 13:51:39] [config] factors-dim-emb: 0
[2023-07-17 13:51:39] [config] gradient-checkpointing: false
[2023-07-17 13:51:39] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:39] [config] guided-alignment: none
[2023-07-17 13:51:39] [config] guided-alignment-cost: mse
[2023-07-17 13:51:39] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:39] [config] ignore-model-config: false
[2023-07-17 13:51:39] [config] input-types:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] interpolate-env-vars: false
[2023-07-17 13:51:39] [config] keep-best: false
[2023-07-17 13:51:39] [config] label-smoothing: 0
[2023-07-17 13:51:39] [config] layer-normalization: false
[2023-07-17 13:51:39] [config] learn-rate: 0.0001
[2023-07-17 13:51:39] [config] lemma-dependency: ""
[2023-07-17 13:51:39] [config] lemma-dim-emb: 0
[2023-07-17 13:51:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:39] [config] log-level: info
[2023-07-17 13:51:39] [config] log-time-zone: ""
[2023-07-17 13:51:39] [config] logical-epoch:
[2023-07-17 13:51:39] [config]   - 1e
[2023-07-17 13:51:39] [config]   - 0
[2023-07-17 13:51:39] [config] lr-decay: 0
[2023-07-17 13:51:39] [config] lr-decay-freq: 50000
[2023-07-17 13:51:39] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:39] [config]   - 0
[2023-07-17 13:51:39] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:39] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:39] [config] lr-decay-start:
[2023-07-17 13:51:39] [config]   - 10
[2023-07-17 13:51:39] [config]   - 1
[2023-07-17 13:51:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:39] [config] lr-report: false
[2023-07-17 13:51:39] [config] lr-warmup: 0
[2023-07-17 13:51:39] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:39] [config] lr-warmup-cycle: false
[2023-07-17 13:51:39] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:39] [config] max-length: 150
[2023-07-17 13:51:39] [config] max-length-crop: true
[2023-07-17 13:51:39] [config] max-length-factor: 3
[2023-07-17 13:51:39] [config] maxi-batch: 100
[2023-07-17 13:51:39] [config] maxi-batch-sort: trg
[2023-07-17 13:51:39] [config] mini-batch: 64
[2023-07-17 13:51:39] [config] mini-batch-fit: true
[2023-07-17 13:51:39] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:39] [config] mini-batch-round-up: true
[2023-07-17 13:51:39] [config] mini-batch-track-lr: false
[2023-07-17 13:51:39] [config] mini-batch-warmup: 0
[2023-07-17 13:51:39] [config] mini-batch-words: 0
[2023-07-17 13:51:39] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:39] [config] multi-loss-type: sum
[2023-07-17 13:51:39] [config] n-best: false
[2023-07-17 13:51:39] [config] no-nccl: false
[2023-07-17 13:51:39] [config] no-reload: false
[2023-07-17 13:51:39] [config] no-restore-corpus: false
[2023-07-17 13:51:39] [config] normalize: 0
[2023-07-17 13:51:39] [config] normalize-gradient: false
[2023-07-17 13:51:39] [config] num-devices: 0
[2023-07-17 13:51:39] [config] optimizer: adam
[2023-07-17 13:51:39] [config] optimizer-delay: 1
[2023-07-17 13:51:39] [config] optimizer-params:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] output-omit-bias: false
[2023-07-17 13:51:39] [config] overwrite: true
[2023-07-17 13:51:39] [config] precision:
[2023-07-17 13:51:39] [config]   - float16
[2023-07-17 13:51:39] [config]   - float32
[2023-07-17 13:51:39] [config] pretrained-model: ""
[2023-07-17 13:51:39] [config] quantize-biases: false
[2023-07-17 13:51:39] [config] quantize-bits: 0
[2023-07-17 13:51:39] [config] quantize-log-based: false
[2023-07-17 13:51:39] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:39] [config] quiet: false
[2023-07-17 13:51:39] [config] quiet-translation: true
[2023-07-17 13:51:39] [config] relative-paths: false
[2023-07-17 13:51:39] [config] right-left: false
[2023-07-17 13:51:39] [config] save-freq: 10000u
[2023-07-17 13:51:39] [config] seed: 1234
[2023-07-17 13:51:39] [config] sentencepiece-alphas:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:39] [config] sentencepiece-options: ""
[2023-07-17 13:51:39] [config] sharding: global
[2023-07-17 13:51:39] [config] shuffle: data
[2023-07-17 13:51:39] [config] shuffle-in-ram: false
[2023-07-17 13:51:39] [config] sigterm: save-and-exit
[2023-07-17 13:51:39] [config] skip: false
[2023-07-17 13:51:39] [config] sqlite: ""
[2023-07-17 13:51:39] [config] sqlite-drop: false
[2023-07-17 13:51:39] [config] sync-freq: 200u
[2023-07-17 13:51:39] [config] sync-sgd: false
[2023-07-17 13:51:39] [config] tempdir: /tmp
[2023-07-17 13:51:39] [config] tied-embeddings: false
[2023-07-17 13:51:39] [config] tied-embeddings-all: true
[2023-07-17 13:51:39] [config] tied-embeddings-src: false
[2023-07-17 13:51:39] [config] train-embedder-rank:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] train-sets:
[2023-07-17 13:51:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:39] [config] transformer-aan-activation: swish
[2023-07-17 13:51:39] [config] transformer-aan-depth: 2
[2023-07-17 13:51:39] [config] transformer-aan-nogate: false
[2023-07-17 13:51:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:39] [config] transformer-depth-scaling: false
[2023-07-17 13:51:39] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:39] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:39] [config] transformer-dropout: 0
[2023-07-17 13:51:39] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:39] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:39] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:39] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:39] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:39] [config] transformer-heads: 8
[2023-07-17 13:51:39] [config] transformer-no-projection: false
[2023-07-17 13:51:39] [config] transformer-pool: false
[2023-07-17 13:51:39] [config] transformer-postprocess: dan
[2023-07-17 13:51:39] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:39] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:39] [config] transformer-preprocess: ""
[2023-07-17 13:51:39] [config] transformer-tied-layers:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:39] [config] tsv: false
[2023-07-17 13:51:39] [config] tsv-fields: 0
[2023-07-17 13:51:39] [config] type: amun
[2023-07-17 13:51:39] [config] ulr: false
[2023-07-17 13:51:39] [config] ulr-dim-emb: 0
[2023-07-17 13:51:39] [config] ulr-dropout: 0
[2023-07-17 13:51:39] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:39] [config] ulr-query-vectors: ""
[2023-07-17 13:51:39] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:39] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:39] [config] unlikelihood-loss: false
[2023-07-17 13:51:39] [config] valid-freq: 50000000
[2023-07-17 13:51:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:39] [config] valid-max-length: 1000
[2023-07-17 13:51:39] [config] valid-metrics:
[2023-07-17 13:51:39] [config]   - cross-entropy
[2023-07-17 13:51:39] [config]   - translation
[2023-07-17 13:51:39] [config] valid-mini-batch: 32
[2023-07-17 13:51:39] [config] valid-reset-stalled: false
[2023-07-17 13:51:39] [config] valid-script-args:
[2023-07-17 13:51:39] [config]   []
[2023-07-17 13:51:39] [config] valid-script-path: ""
[2023-07-17 13:51:39] [config] valid-sets:
[2023-07-17 13:51:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:39] [config] vocabs:
[2023-07-17 13:51:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:39] [config] word-penalty: 0
[2023-07-17 13:51:39] [config] word-scores: false
[2023-07-17 13:51:39] [config] workspace: 5500
[2023-07-17 13:51:39] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:39] [training] Using single-device training
[2023-07-17 13:51:39] Synced seed 1234
[2023-07-17 13:51:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:39] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:39] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:41] [comm] Using global sharding
[2023-07-17 13:51:41] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:41] [training] Using 1 GPUs
[2023-07-17 13:51:41] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:41] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55b9a598af01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55b9a61201fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55b9a6120d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55b9a6121785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55b9a5d9ef3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55b9a5e24d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55b9a5e1177c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55b9a58e281d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55b9a5ebe306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55b9a5e9af2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55b9a599c450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55b9a58be2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b9a5875b9c]    main                                               + 0x3c
[0x7f328c3800b3]    __libc_start_main                                  + 0xf3
[0x55b9a58bccbe]    _start                                             + 0x2e

[2023-07-17 13:51:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:42] [marian] Running on node22.datos.cluster.uy as process 8107 with command line:
[2023-07-17 13:51:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:42] [config] after: 0e
[2023-07-17 13:51:42] [config] after-batches: 0
[2023-07-17 13:51:42] [config] after-epochs: 180
[2023-07-17 13:51:42] [config] all-caps-every: 0
[2023-07-17 13:51:42] [config] allow-unk: false
[2023-07-17 13:51:42] [config] authors: false
[2023-07-17 13:51:42] [config] beam-size: 12
[2023-07-17 13:51:42] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:42] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:42] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:42] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:42] [config] build-info: ""
[2023-07-17 13:51:42] [config] check-gradient-nan: false
[2023-07-17 13:51:42] [config] check-nan: false
[2023-07-17 13:51:42] [config] cite: false
[2023-07-17 13:51:42] [config] clip-norm: 1
[2023-07-17 13:51:42] [config] cost-scaling:
[2023-07-17 13:51:42] [config]   - 256.f
[2023-07-17 13:51:42] [config]   - 1000
[2023-07-17 13:51:42] [config]   - 2.f
[2023-07-17 13:51:42] [config]   - 256.f
[2023-07-17 13:51:42] [config] cost-type: ce-sum
[2023-07-17 13:51:42] [config] cpu-threads: 0
[2023-07-17 13:51:42] [config] data-threads: 8
[2023-07-17 13:51:42] [config] data-weighting: ""
[2023-07-17 13:51:42] [config] data-weighting-type: sentence
[2023-07-17 13:51:42] [config] dec-cell: gru
[2023-07-17 13:51:42] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:42] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:42] [config] dec-depth: 1
[2023-07-17 13:51:42] [config] devices:
[2023-07-17 13:51:42] [config]   - 0
[2023-07-17 13:51:42] [config] dim-emb: 512
[2023-07-17 13:51:42] [config] dim-rnn: 1024
[2023-07-17 13:51:42] [config] dim-vocabs:
[2023-07-17 13:51:42] [config]   - 16384
[2023-07-17 13:51:42] [config]   - 16384
[2023-07-17 13:51:42] [config] disp-first: 0
[2023-07-17 13:51:42] [config] disp-freq: 1000u
[2023-07-17 13:51:42] [config] disp-label-counts: true
[2023-07-17 13:51:42] [config] dropout-rnn: 0
[2023-07-17 13:51:42] [config] dropout-src: 0
[2023-07-17 13:51:42] [config] dropout-trg: 0
[2023-07-17 13:51:42] [config] dump-config: ""
[2023-07-17 13:51:42] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] early-stopping: 5
[2023-07-17 13:51:42] [config] early-stopping-on: first
[2023-07-17 13:51:42] [config] embedding-fix-src: false
[2023-07-17 13:51:42] [config] embedding-fix-trg: false
[2023-07-17 13:51:42] [config] embedding-normalization: false
[2023-07-17 13:51:42] [config] embedding-vectors:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] enc-cell: gru
[2023-07-17 13:51:42] [config] enc-cell-depth: 1
[2023-07-17 13:51:42] [config] enc-depth: 1
[2023-07-17 13:51:42] [config] enc-type: bidirectional
[2023-07-17 13:51:42] [config] english-title-case-every: 0
[2023-07-17 13:51:42] [config] exponential-smoothing: 0
[2023-07-17 13:51:42] [config] factor-weight: 1
[2023-07-17 13:51:42] [config] factors-combine: sum
[2023-07-17 13:51:42] [config] factors-dim-emb: 0
[2023-07-17 13:51:42] [config] gradient-checkpointing: false
[2023-07-17 13:51:42] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:42] [config] guided-alignment: none
[2023-07-17 13:51:42] [config] guided-alignment-cost: mse
[2023-07-17 13:51:42] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:42] [config] ignore-model-config: false
[2023-07-17 13:51:42] [config] input-types:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] interpolate-env-vars: false
[2023-07-17 13:51:42] [config] keep-best: false
[2023-07-17 13:51:42] [config] label-smoothing: 0
[2023-07-17 13:51:42] [config] layer-normalization: false
[2023-07-17 13:51:42] [config] learn-rate: 0.0001
[2023-07-17 13:51:42] [config] lemma-dependency: ""
[2023-07-17 13:51:42] [config] lemma-dim-emb: 0
[2023-07-17 13:51:42] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:42] [config] log-level: info
[2023-07-17 13:51:42] [config] log-time-zone: ""
[2023-07-17 13:51:42] [config] logical-epoch:
[2023-07-17 13:51:42] [config]   - 1e
[2023-07-17 13:51:42] [config]   - 0
[2023-07-17 13:51:42] [config] lr-decay: 0
[2023-07-17 13:51:42] [config] lr-decay-freq: 50000
[2023-07-17 13:51:42] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:42] [config]   - 0
[2023-07-17 13:51:42] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:42] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:42] [config] lr-decay-start:
[2023-07-17 13:51:42] [config]   - 10
[2023-07-17 13:51:42] [config]   - 1
[2023-07-17 13:51:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:42] [config] lr-report: false
[2023-07-17 13:51:42] [config] lr-warmup: 0
[2023-07-17 13:51:42] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:42] [config] lr-warmup-cycle: false
[2023-07-17 13:51:42] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:42] [config] max-length: 150
[2023-07-17 13:51:42] [config] max-length-crop: true
[2023-07-17 13:51:42] [config] max-length-factor: 3
[2023-07-17 13:51:42] [config] maxi-batch: 100
[2023-07-17 13:51:42] [config] maxi-batch-sort: trg
[2023-07-17 13:51:42] [config] mini-batch: 64
[2023-07-17 13:51:42] [config] mini-batch-fit: true
[2023-07-17 13:51:42] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:42] [config] mini-batch-round-up: true
[2023-07-17 13:51:42] [config] mini-batch-track-lr: false
[2023-07-17 13:51:42] [config] mini-batch-warmup: 0
[2023-07-17 13:51:42] [config] mini-batch-words: 0
[2023-07-17 13:51:42] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:42] [config] multi-loss-type: sum
[2023-07-17 13:51:42] [config] n-best: false
[2023-07-17 13:51:42] [config] no-nccl: false
[2023-07-17 13:51:42] [config] no-reload: false
[2023-07-17 13:51:42] [config] no-restore-corpus: false
[2023-07-17 13:51:42] [config] normalize: 0
[2023-07-17 13:51:42] [config] normalize-gradient: false
[2023-07-17 13:51:42] [config] num-devices: 0
[2023-07-17 13:51:42] [config] optimizer: adam
[2023-07-17 13:51:42] [config] optimizer-delay: 1
[2023-07-17 13:51:42] [config] optimizer-params:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] output-omit-bias: false
[2023-07-17 13:51:42] [config] overwrite: true
[2023-07-17 13:51:42] [config] precision:
[2023-07-17 13:51:42] [config]   - float16
[2023-07-17 13:51:42] [config]   - float32
[2023-07-17 13:51:42] [config] pretrained-model: ""
[2023-07-17 13:51:42] [config] quantize-biases: false
[2023-07-17 13:51:42] [config] quantize-bits: 0
[2023-07-17 13:51:42] [config] quantize-log-based: false
[2023-07-17 13:51:42] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:42] [config] quiet: false
[2023-07-17 13:51:42] [config] quiet-translation: true
[2023-07-17 13:51:42] [config] relative-paths: false
[2023-07-17 13:51:42] [config] right-left: false
[2023-07-17 13:51:42] [config] save-freq: 10000u
[2023-07-17 13:51:42] [config] seed: 1234
[2023-07-17 13:51:42] [config] sentencepiece-alphas:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:42] [config] sentencepiece-options: ""
[2023-07-17 13:51:42] [config] sharding: global
[2023-07-17 13:51:42] [config] shuffle: data
[2023-07-17 13:51:42] [config] shuffle-in-ram: false
[2023-07-17 13:51:42] [config] sigterm: save-and-exit
[2023-07-17 13:51:42] [config] skip: false
[2023-07-17 13:51:42] [config] sqlite: ""
[2023-07-17 13:51:42] [config] sqlite-drop: false
[2023-07-17 13:51:42] [config] sync-freq: 200u
[2023-07-17 13:51:42] [config] sync-sgd: false
[2023-07-17 13:51:42] [config] tempdir: /tmp
[2023-07-17 13:51:42] [config] tied-embeddings: false
[2023-07-17 13:51:42] [config] tied-embeddings-all: true
[2023-07-17 13:51:42] [config] tied-embeddings-src: false
[2023-07-17 13:51:42] [config] train-embedder-rank:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] train-sets:
[2023-07-17 13:51:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:42] [config] transformer-aan-activation: swish
[2023-07-17 13:51:42] [config] transformer-aan-depth: 2
[2023-07-17 13:51:42] [config] transformer-aan-nogate: false
[2023-07-17 13:51:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:42] [config] transformer-depth-scaling: false
[2023-07-17 13:51:42] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:42] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:42] [config] transformer-dropout: 0
[2023-07-17 13:51:42] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:42] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:42] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:42] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:42] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:42] [config] transformer-heads: 8
[2023-07-17 13:51:42] [config] transformer-no-projection: false
[2023-07-17 13:51:42] [config] transformer-pool: false
[2023-07-17 13:51:42] [config] transformer-postprocess: dan
[2023-07-17 13:51:42] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:42] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:42] [config] transformer-preprocess: ""
[2023-07-17 13:51:42] [config] transformer-tied-layers:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:42] [config] tsv: false
[2023-07-17 13:51:42] [config] tsv-fields: 0
[2023-07-17 13:51:42] [config] type: amun
[2023-07-17 13:51:42] [config] ulr: false
[2023-07-17 13:51:42] [config] ulr-dim-emb: 0
[2023-07-17 13:51:42] [config] ulr-dropout: 0
[2023-07-17 13:51:42] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:42] [config] ulr-query-vectors: ""
[2023-07-17 13:51:42] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:42] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:42] [config] unlikelihood-loss: false
[2023-07-17 13:51:42] [config] valid-freq: 50000000
[2023-07-17 13:51:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:42] [config] valid-max-length: 1000
[2023-07-17 13:51:42] [config] valid-metrics:
[2023-07-17 13:51:42] [config]   - cross-entropy
[2023-07-17 13:51:42] [config]   - translation
[2023-07-17 13:51:42] [config] valid-mini-batch: 32
[2023-07-17 13:51:42] [config] valid-reset-stalled: false
[2023-07-17 13:51:42] [config] valid-script-args:
[2023-07-17 13:51:42] [config]   []
[2023-07-17 13:51:42] [config] valid-script-path: ""
[2023-07-17 13:51:42] [config] valid-sets:
[2023-07-17 13:51:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:42] [config] vocabs:
[2023-07-17 13:51:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:42] [config] word-penalty: 0
[2023-07-17 13:51:42] [config] word-scores: false
[2023-07-17 13:51:42] [config] workspace: 5500
[2023-07-17 13:51:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:42] [training] Using single-device training
[2023-07-17 13:51:42] Synced seed 1234
[2023-07-17 13:51:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:42] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:42] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:44] [comm] Using global sharding
[2023-07-17 13:51:44] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:44] [training] Using 1 GPUs
[2023-07-17 13:51:44] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:44] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x559cddaabf01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x559cde2411fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x559cde241d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x559cde242785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x559cddebff3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x559cddf45d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x559cddf3277c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x559cdda0381d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x559cddfdf306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x559cddfbbf2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x559cddabd450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x559cdd9df2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x559cdd996b9c]    main                                               + 0x3c
[0x7fcb751d10b3]    __libc_start_main                                  + 0xf3
[0x559cdd9ddcbe]    _start                                             + 0x2e

[2023-07-17 13:51:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:45] [marian] Running on node22.datos.cluster.uy as process 8137 with command line:
[2023-07-17 13:51:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:45] [config] after: 0e
[2023-07-17 13:51:45] [config] after-batches: 0
[2023-07-17 13:51:45] [config] after-epochs: 190
[2023-07-17 13:51:45] [config] all-caps-every: 0
[2023-07-17 13:51:45] [config] allow-unk: false
[2023-07-17 13:51:45] [config] authors: false
[2023-07-17 13:51:45] [config] beam-size: 12
[2023-07-17 13:51:45] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:45] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:45] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:45] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:45] [config] build-info: ""
[2023-07-17 13:51:45] [config] check-gradient-nan: false
[2023-07-17 13:51:45] [config] check-nan: false
[2023-07-17 13:51:45] [config] cite: false
[2023-07-17 13:51:45] [config] clip-norm: 1
[2023-07-17 13:51:45] [config] cost-scaling:
[2023-07-17 13:51:45] [config]   - 256.f
[2023-07-17 13:51:45] [config]   - 1000
[2023-07-17 13:51:45] [config]   - 2.f
[2023-07-17 13:51:45] [config]   - 256.f
[2023-07-17 13:51:45] [config] cost-type: ce-sum
[2023-07-17 13:51:45] [config] cpu-threads: 0
[2023-07-17 13:51:45] [config] data-threads: 8
[2023-07-17 13:51:45] [config] data-weighting: ""
[2023-07-17 13:51:45] [config] data-weighting-type: sentence
[2023-07-17 13:51:45] [config] dec-cell: gru
[2023-07-17 13:51:45] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:45] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:45] [config] dec-depth: 1
[2023-07-17 13:51:45] [config] devices:
[2023-07-17 13:51:45] [config]   - 0
[2023-07-17 13:51:45] [config] dim-emb: 512
[2023-07-17 13:51:45] [config] dim-rnn: 1024
[2023-07-17 13:51:45] [config] dim-vocabs:
[2023-07-17 13:51:45] [config]   - 16384
[2023-07-17 13:51:45] [config]   - 16384
[2023-07-17 13:51:45] [config] disp-first: 0
[2023-07-17 13:51:45] [config] disp-freq: 1000u
[2023-07-17 13:51:45] [config] disp-label-counts: true
[2023-07-17 13:51:45] [config] dropout-rnn: 0
[2023-07-17 13:51:45] [config] dropout-src: 0
[2023-07-17 13:51:45] [config] dropout-trg: 0
[2023-07-17 13:51:45] [config] dump-config: ""
[2023-07-17 13:51:45] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] early-stopping: 5
[2023-07-17 13:51:45] [config] early-stopping-on: first
[2023-07-17 13:51:45] [config] embedding-fix-src: false
[2023-07-17 13:51:45] [config] embedding-fix-trg: false
[2023-07-17 13:51:45] [config] embedding-normalization: false
[2023-07-17 13:51:45] [config] embedding-vectors:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] enc-cell: gru
[2023-07-17 13:51:45] [config] enc-cell-depth: 1
[2023-07-17 13:51:45] [config] enc-depth: 1
[2023-07-17 13:51:45] [config] enc-type: bidirectional
[2023-07-17 13:51:45] [config] english-title-case-every: 0
[2023-07-17 13:51:45] [config] exponential-smoothing: 0
[2023-07-17 13:51:45] [config] factor-weight: 1
[2023-07-17 13:51:45] [config] factors-combine: sum
[2023-07-17 13:51:45] [config] factors-dim-emb: 0
[2023-07-17 13:51:45] [config] gradient-checkpointing: false
[2023-07-17 13:51:45] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:45] [config] guided-alignment: none
[2023-07-17 13:51:45] [config] guided-alignment-cost: mse
[2023-07-17 13:51:45] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:45] [config] ignore-model-config: false
[2023-07-17 13:51:45] [config] input-types:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] interpolate-env-vars: false
[2023-07-17 13:51:45] [config] keep-best: false
[2023-07-17 13:51:45] [config] label-smoothing: 0
[2023-07-17 13:51:45] [config] layer-normalization: false
[2023-07-17 13:51:45] [config] learn-rate: 0.0001
[2023-07-17 13:51:45] [config] lemma-dependency: ""
[2023-07-17 13:51:45] [config] lemma-dim-emb: 0
[2023-07-17 13:51:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:45] [config] log-level: info
[2023-07-17 13:51:45] [config] log-time-zone: ""
[2023-07-17 13:51:45] [config] logical-epoch:
[2023-07-17 13:51:45] [config]   - 1e
[2023-07-17 13:51:45] [config]   - 0
[2023-07-17 13:51:45] [config] lr-decay: 0
[2023-07-17 13:51:45] [config] lr-decay-freq: 50000
[2023-07-17 13:51:45] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:45] [config]   - 0
[2023-07-17 13:51:45] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:45] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:45] [config] lr-decay-start:
[2023-07-17 13:51:45] [config]   - 10
[2023-07-17 13:51:45] [config]   - 1
[2023-07-17 13:51:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:45] [config] lr-report: false
[2023-07-17 13:51:45] [config] lr-warmup: 0
[2023-07-17 13:51:45] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:45] [config] lr-warmup-cycle: false
[2023-07-17 13:51:45] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:45] [config] max-length: 150
[2023-07-17 13:51:45] [config] max-length-crop: true
[2023-07-17 13:51:45] [config] max-length-factor: 3
[2023-07-17 13:51:45] [config] maxi-batch: 100
[2023-07-17 13:51:45] [config] maxi-batch-sort: trg
[2023-07-17 13:51:45] [config] mini-batch: 64
[2023-07-17 13:51:45] [config] mini-batch-fit: true
[2023-07-17 13:51:45] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:45] [config] mini-batch-round-up: true
[2023-07-17 13:51:45] [config] mini-batch-track-lr: false
[2023-07-17 13:51:45] [config] mini-batch-warmup: 0
[2023-07-17 13:51:45] [config] mini-batch-words: 0
[2023-07-17 13:51:45] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:45] [config] multi-loss-type: sum
[2023-07-17 13:51:45] [config] n-best: false
[2023-07-17 13:51:45] [config] no-nccl: false
[2023-07-17 13:51:45] [config] no-reload: false
[2023-07-17 13:51:45] [config] no-restore-corpus: false
[2023-07-17 13:51:45] [config] normalize: 0
[2023-07-17 13:51:45] [config] normalize-gradient: false
[2023-07-17 13:51:45] [config] num-devices: 0
[2023-07-17 13:51:45] [config] optimizer: adam
[2023-07-17 13:51:45] [config] optimizer-delay: 1
[2023-07-17 13:51:45] [config] optimizer-params:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] output-omit-bias: false
[2023-07-17 13:51:45] [config] overwrite: true
[2023-07-17 13:51:45] [config] precision:
[2023-07-17 13:51:45] [config]   - float16
[2023-07-17 13:51:45] [config]   - float32
[2023-07-17 13:51:45] [config] pretrained-model: ""
[2023-07-17 13:51:45] [config] quantize-biases: false
[2023-07-17 13:51:45] [config] quantize-bits: 0
[2023-07-17 13:51:45] [config] quantize-log-based: false
[2023-07-17 13:51:45] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:45] [config] quiet: false
[2023-07-17 13:51:45] [config] quiet-translation: true
[2023-07-17 13:51:45] [config] relative-paths: false
[2023-07-17 13:51:45] [config] right-left: false
[2023-07-17 13:51:45] [config] save-freq: 10000u
[2023-07-17 13:51:45] [config] seed: 1234
[2023-07-17 13:51:45] [config] sentencepiece-alphas:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:45] [config] sentencepiece-options: ""
[2023-07-17 13:51:45] [config] sharding: global
[2023-07-17 13:51:45] [config] shuffle: data
[2023-07-17 13:51:45] [config] shuffle-in-ram: false
[2023-07-17 13:51:45] [config] sigterm: save-and-exit
[2023-07-17 13:51:45] [config] skip: false
[2023-07-17 13:51:45] [config] sqlite: ""
[2023-07-17 13:51:45] [config] sqlite-drop: false
[2023-07-17 13:51:45] [config] sync-freq: 200u
[2023-07-17 13:51:45] [config] sync-sgd: false
[2023-07-17 13:51:45] [config] tempdir: /tmp
[2023-07-17 13:51:45] [config] tied-embeddings: false
[2023-07-17 13:51:45] [config] tied-embeddings-all: true
[2023-07-17 13:51:45] [config] tied-embeddings-src: false
[2023-07-17 13:51:45] [config] train-embedder-rank:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] train-sets:
[2023-07-17 13:51:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:45] [config] transformer-aan-activation: swish
[2023-07-17 13:51:45] [config] transformer-aan-depth: 2
[2023-07-17 13:51:45] [config] transformer-aan-nogate: false
[2023-07-17 13:51:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:45] [config] transformer-depth-scaling: false
[2023-07-17 13:51:45] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:45] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:45] [config] transformer-dropout: 0
[2023-07-17 13:51:45] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:45] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:45] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:45] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:45] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:45] [config] transformer-heads: 8
[2023-07-17 13:51:45] [config] transformer-no-projection: false
[2023-07-17 13:51:45] [config] transformer-pool: false
[2023-07-17 13:51:45] [config] transformer-postprocess: dan
[2023-07-17 13:51:45] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:45] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:45] [config] transformer-preprocess: ""
[2023-07-17 13:51:45] [config] transformer-tied-layers:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:45] [config] tsv: false
[2023-07-17 13:51:45] [config] tsv-fields: 0
[2023-07-17 13:51:45] [config] type: amun
[2023-07-17 13:51:45] [config] ulr: false
[2023-07-17 13:51:45] [config] ulr-dim-emb: 0
[2023-07-17 13:51:45] [config] ulr-dropout: 0
[2023-07-17 13:51:45] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:45] [config] ulr-query-vectors: ""
[2023-07-17 13:51:45] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:45] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:45] [config] unlikelihood-loss: false
[2023-07-17 13:51:45] [config] valid-freq: 50000000
[2023-07-17 13:51:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:45] [config] valid-max-length: 1000
[2023-07-17 13:51:45] [config] valid-metrics:
[2023-07-17 13:51:45] [config]   - cross-entropy
[2023-07-17 13:51:45] [config]   - translation
[2023-07-17 13:51:45] [config] valid-mini-batch: 32
[2023-07-17 13:51:45] [config] valid-reset-stalled: false
[2023-07-17 13:51:45] [config] valid-script-args:
[2023-07-17 13:51:45] [config]   []
[2023-07-17 13:51:45] [config] valid-script-path: ""
[2023-07-17 13:51:45] [config] valid-sets:
[2023-07-17 13:51:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:45] [config] vocabs:
[2023-07-17 13:51:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:45] [config] word-penalty: 0
[2023-07-17 13:51:45] [config] word-scores: false
[2023-07-17 13:51:45] [config] workspace: 5500
[2023-07-17 13:51:45] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:45] [training] Using single-device training
[2023-07-17 13:51:45] Synced seed 1234
[2023-07-17 13:51:45] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:45] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:45] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:45] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:45] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:46] [comm] Using global sharding
[2023-07-17 13:51:46] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:46] [training] Using 1 GPUs
[2023-07-17 13:51:46] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:46] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x556b14116f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x556b148ac1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x556b148acd6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x556b148ad785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x556b1452af3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x556b145b0d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x556b1459d77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x556b1406e81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x556b1464a306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x556b14626f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x556b14128450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x556b1404a2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x556b14001b9c]    main                                               + 0x3c
[0x7f48eaab30b3]    __libc_start_main                                  + 0xf3
[0x556b14048cbe]    _start                                             + 0x2e

[2023-07-17 13:51:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:47] [marian] Running on node22.datos.cluster.uy as process 8169 with command line:
[2023-07-17 13:51:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 13:51:47] [config] after: 0e
[2023-07-17 13:51:47] [config] after-batches: 0
[2023-07-17 13:51:47] [config] after-epochs: 200
[2023-07-17 13:51:47] [config] all-caps-every: 0
[2023-07-17 13:51:47] [config] allow-unk: false
[2023-07-17 13:51:47] [config] authors: false
[2023-07-17 13:51:47] [config] beam-size: 12
[2023-07-17 13:51:47] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:47] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:47] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:47] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:47] [config] build-info: ""
[2023-07-17 13:51:47] [config] check-gradient-nan: false
[2023-07-17 13:51:47] [config] check-nan: false
[2023-07-17 13:51:47] [config] cite: false
[2023-07-17 13:51:47] [config] clip-norm: 1
[2023-07-17 13:51:47] [config] cost-scaling:
[2023-07-17 13:51:47] [config]   - 256.f
[2023-07-17 13:51:47] [config]   - 1000
[2023-07-17 13:51:47] [config]   - 2.f
[2023-07-17 13:51:47] [config]   - 256.f
[2023-07-17 13:51:47] [config] cost-type: ce-sum
[2023-07-17 13:51:47] [config] cpu-threads: 0
[2023-07-17 13:51:47] [config] data-threads: 8
[2023-07-17 13:51:47] [config] data-weighting: ""
[2023-07-17 13:51:47] [config] data-weighting-type: sentence
[2023-07-17 13:51:47] [config] dec-cell: gru
[2023-07-17 13:51:47] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:47] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:47] [config] dec-depth: 1
[2023-07-17 13:51:47] [config] devices:
[2023-07-17 13:51:47] [config]   - 0
[2023-07-17 13:51:47] [config] dim-emb: 512
[2023-07-17 13:51:47] [config] dim-rnn: 1024
[2023-07-17 13:51:47] [config] dim-vocabs:
[2023-07-17 13:51:47] [config]   - 16384
[2023-07-17 13:51:47] [config]   - 16384
[2023-07-17 13:51:47] [config] disp-first: 0
[2023-07-17 13:51:47] [config] disp-freq: 1000u
[2023-07-17 13:51:47] [config] disp-label-counts: true
[2023-07-17 13:51:47] [config] dropout-rnn: 0
[2023-07-17 13:51:47] [config] dropout-src: 0
[2023-07-17 13:51:47] [config] dropout-trg: 0
[2023-07-17 13:51:47] [config] dump-config: ""
[2023-07-17 13:51:47] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] early-stopping: 5
[2023-07-17 13:51:47] [config] early-stopping-on: first
[2023-07-17 13:51:47] [config] embedding-fix-src: false
[2023-07-17 13:51:47] [config] embedding-fix-trg: false
[2023-07-17 13:51:47] [config] embedding-normalization: false
[2023-07-17 13:51:47] [config] embedding-vectors:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] enc-cell: gru
[2023-07-17 13:51:47] [config] enc-cell-depth: 1
[2023-07-17 13:51:47] [config] enc-depth: 1
[2023-07-17 13:51:47] [config] enc-type: bidirectional
[2023-07-17 13:51:47] [config] english-title-case-every: 0
[2023-07-17 13:51:47] [config] exponential-smoothing: 0
[2023-07-17 13:51:47] [config] factor-weight: 1
[2023-07-17 13:51:47] [config] factors-combine: sum
[2023-07-17 13:51:47] [config] factors-dim-emb: 0
[2023-07-17 13:51:47] [config] gradient-checkpointing: false
[2023-07-17 13:51:47] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:47] [config] guided-alignment: none
[2023-07-17 13:51:47] [config] guided-alignment-cost: mse
[2023-07-17 13:51:47] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:47] [config] ignore-model-config: false
[2023-07-17 13:51:47] [config] input-types:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] interpolate-env-vars: false
[2023-07-17 13:51:47] [config] keep-best: false
[2023-07-17 13:51:47] [config] label-smoothing: 0
[2023-07-17 13:51:47] [config] layer-normalization: false
[2023-07-17 13:51:47] [config] learn-rate: 0.0001
[2023-07-17 13:51:47] [config] lemma-dependency: ""
[2023-07-17 13:51:47] [config] lemma-dim-emb: 0
[2023-07-17 13:51:47] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:47] [config] log-level: info
[2023-07-17 13:51:47] [config] log-time-zone: ""
[2023-07-17 13:51:47] [config] logical-epoch:
[2023-07-17 13:51:47] [config]   - 1e
[2023-07-17 13:51:47] [config]   - 0
[2023-07-17 13:51:47] [config] lr-decay: 0
[2023-07-17 13:51:47] [config] lr-decay-freq: 50000
[2023-07-17 13:51:47] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:47] [config]   - 0
[2023-07-17 13:51:47] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:47] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:47] [config] lr-decay-start:
[2023-07-17 13:51:47] [config]   - 10
[2023-07-17 13:51:47] [config]   - 1
[2023-07-17 13:51:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:47] [config] lr-report: false
[2023-07-17 13:51:47] [config] lr-warmup: 0
[2023-07-17 13:51:47] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:47] [config] lr-warmup-cycle: false
[2023-07-17 13:51:47] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:47] [config] max-length: 150
[2023-07-17 13:51:47] [config] max-length-crop: true
[2023-07-17 13:51:47] [config] max-length-factor: 3
[2023-07-17 13:51:47] [config] maxi-batch: 100
[2023-07-17 13:51:47] [config] maxi-batch-sort: trg
[2023-07-17 13:51:47] [config] mini-batch: 64
[2023-07-17 13:51:47] [config] mini-batch-fit: true
[2023-07-17 13:51:47] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:47] [config] mini-batch-round-up: true
[2023-07-17 13:51:47] [config] mini-batch-track-lr: false
[2023-07-17 13:51:47] [config] mini-batch-warmup: 0
[2023-07-17 13:51:47] [config] mini-batch-words: 0
[2023-07-17 13:51:47] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 13:51:47] [config] multi-loss-type: sum
[2023-07-17 13:51:47] [config] n-best: false
[2023-07-17 13:51:47] [config] no-nccl: false
[2023-07-17 13:51:47] [config] no-reload: false
[2023-07-17 13:51:47] [config] no-restore-corpus: false
[2023-07-17 13:51:47] [config] normalize: 0
[2023-07-17 13:51:47] [config] normalize-gradient: false
[2023-07-17 13:51:47] [config] num-devices: 0
[2023-07-17 13:51:47] [config] optimizer: adam
[2023-07-17 13:51:47] [config] optimizer-delay: 1
[2023-07-17 13:51:47] [config] optimizer-params:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] output-omit-bias: false
[2023-07-17 13:51:47] [config] overwrite: true
[2023-07-17 13:51:47] [config] precision:
[2023-07-17 13:51:47] [config]   - float16
[2023-07-17 13:51:47] [config]   - float32
[2023-07-17 13:51:47] [config] pretrained-model: ""
[2023-07-17 13:51:47] [config] quantize-biases: false
[2023-07-17 13:51:47] [config] quantize-bits: 0
[2023-07-17 13:51:47] [config] quantize-log-based: false
[2023-07-17 13:51:47] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:47] [config] quiet: false
[2023-07-17 13:51:47] [config] quiet-translation: true
[2023-07-17 13:51:47] [config] relative-paths: false
[2023-07-17 13:51:47] [config] right-left: false
[2023-07-17 13:51:47] [config] save-freq: 10000u
[2023-07-17 13:51:47] [config] seed: 1234
[2023-07-17 13:51:47] [config] sentencepiece-alphas:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:47] [config] sentencepiece-options: ""
[2023-07-17 13:51:47] [config] sharding: global
[2023-07-17 13:51:47] [config] shuffle: data
[2023-07-17 13:51:47] [config] shuffle-in-ram: false
[2023-07-17 13:51:47] [config] sigterm: save-and-exit
[2023-07-17 13:51:47] [config] skip: false
[2023-07-17 13:51:47] [config] sqlite: ""
[2023-07-17 13:51:47] [config] sqlite-drop: false
[2023-07-17 13:51:47] [config] sync-freq: 200u
[2023-07-17 13:51:47] [config] sync-sgd: false
[2023-07-17 13:51:47] [config] tempdir: /tmp
[2023-07-17 13:51:47] [config] tied-embeddings: false
[2023-07-17 13:51:47] [config] tied-embeddings-all: true
[2023-07-17 13:51:47] [config] tied-embeddings-src: false
[2023-07-17 13:51:47] [config] train-embedder-rank:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] train-sets:
[2023-07-17 13:51:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:47] [config] transformer-aan-activation: swish
[2023-07-17 13:51:47] [config] transformer-aan-depth: 2
[2023-07-17 13:51:47] [config] transformer-aan-nogate: false
[2023-07-17 13:51:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:47] [config] transformer-depth-scaling: false
[2023-07-17 13:51:47] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:47] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:47] [config] transformer-dropout: 0
[2023-07-17 13:51:47] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:47] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:47] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:47] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:47] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:47] [config] transformer-heads: 8
[2023-07-17 13:51:47] [config] transformer-no-projection: false
[2023-07-17 13:51:47] [config] transformer-pool: false
[2023-07-17 13:51:47] [config] transformer-postprocess: dan
[2023-07-17 13:51:47] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:47] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:47] [config] transformer-preprocess: ""
[2023-07-17 13:51:47] [config] transformer-tied-layers:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:47] [config] tsv: false
[2023-07-17 13:51:47] [config] tsv-fields: 0
[2023-07-17 13:51:47] [config] type: amun
[2023-07-17 13:51:47] [config] ulr: false
[2023-07-17 13:51:47] [config] ulr-dim-emb: 0
[2023-07-17 13:51:47] [config] ulr-dropout: 0
[2023-07-17 13:51:47] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:47] [config] ulr-query-vectors: ""
[2023-07-17 13:51:47] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:47] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:47] [config] unlikelihood-loss: false
[2023-07-17 13:51:47] [config] valid-freq: 50000000
[2023-07-17 13:51:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:47] [config] valid-max-length: 1000
[2023-07-17 13:51:47] [config] valid-metrics:
[2023-07-17 13:51:47] [config]   - cross-entropy
[2023-07-17 13:51:47] [config]   - translation
[2023-07-17 13:51:47] [config] valid-mini-batch: 32
[2023-07-17 13:51:47] [config] valid-reset-stalled: false
[2023-07-17 13:51:47] [config] valid-script-args:
[2023-07-17 13:51:47] [config]   []
[2023-07-17 13:51:47] [config] valid-script-path: ""
[2023-07-17 13:51:47] [config] valid-sets:
[2023-07-17 13:51:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:47] [config] vocabs:
[2023-07-17 13:51:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:47] [config] word-penalty: 0
[2023-07-17 13:51:47] [config] word-scores: false
[2023-07-17 13:51:47] [config] workspace: 5500
[2023-07-17 13:51:47] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:47] [training] Using single-device training
[2023-07-17 13:51:48] Synced seed 1234
[2023-07-17 13:51:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:48] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:49] [comm] Using global sharding
[2023-07-17 13:51:49] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:49] [training] Using 1 GPUs
[2023-07-17 13:51:49] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:49] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x5589257eef01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x558925f841fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x558925f84d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x558925f85785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x558925c02f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x558925c88d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x558925c7577c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55892574681d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x558925d22306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x558925cfef2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x558925800450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5589257222c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5589256d9b9c]    main                                               + 0x3c
[0x7f68aa3b10b3]    __libc_start_main                                  + 0xf3
[0x558925720cbe]    _start                                             + 0x2e

[2023-07-17 13:51:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:50] [marian] Running on node22.datos.cluster.uy as process 8199 with command line:
[2023-07-17 13:51:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:51:50] [config] after: 0e
[2023-07-17 13:51:50] [config] after-batches: 0
[2023-07-17 13:51:50] [config] after-epochs: 10
[2023-07-17 13:51:50] [config] all-caps-every: 0
[2023-07-17 13:51:50] [config] allow-unk: false
[2023-07-17 13:51:50] [config] authors: false
[2023-07-17 13:51:50] [config] beam-size: 12
[2023-07-17 13:51:50] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:50] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:50] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:50] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:50] [config] build-info: ""
[2023-07-17 13:51:50] [config] check-gradient-nan: false
[2023-07-17 13:51:50] [config] check-nan: false
[2023-07-17 13:51:50] [config] cite: false
[2023-07-17 13:51:50] [config] clip-norm: 1
[2023-07-17 13:51:50] [config] cost-scaling:
[2023-07-17 13:51:50] [config]   - 256.f
[2023-07-17 13:51:50] [config]   - 1000
[2023-07-17 13:51:50] [config]   - 2.f
[2023-07-17 13:51:50] [config]   - 256.f
[2023-07-17 13:51:50] [config] cost-type: ce-sum
[2023-07-17 13:51:50] [config] cpu-threads: 0
[2023-07-17 13:51:50] [config] data-threads: 8
[2023-07-17 13:51:50] [config] data-weighting: ""
[2023-07-17 13:51:50] [config] data-weighting-type: sentence
[2023-07-17 13:51:50] [config] dec-cell: gru
[2023-07-17 13:51:50] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:50] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:50] [config] dec-depth: 1
[2023-07-17 13:51:50] [config] devices:
[2023-07-17 13:51:50] [config]   - 0
[2023-07-17 13:51:50] [config] dim-emb: 512
[2023-07-17 13:51:50] [config] dim-rnn: 1024
[2023-07-17 13:51:50] [config] dim-vocabs:
[2023-07-17 13:51:50] [config]   - 16384
[2023-07-17 13:51:50] [config]   - 16384
[2023-07-17 13:51:50] [config] disp-first: 0
[2023-07-17 13:51:50] [config] disp-freq: 1000u
[2023-07-17 13:51:50] [config] disp-label-counts: true
[2023-07-17 13:51:50] [config] dropout-rnn: 0
[2023-07-17 13:51:50] [config] dropout-src: 0
[2023-07-17 13:51:50] [config] dropout-trg: 0
[2023-07-17 13:51:50] [config] dump-config: ""
[2023-07-17 13:51:50] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] early-stopping: 5
[2023-07-17 13:51:50] [config] early-stopping-on: first
[2023-07-17 13:51:50] [config] embedding-fix-src: false
[2023-07-17 13:51:50] [config] embedding-fix-trg: false
[2023-07-17 13:51:50] [config] embedding-normalization: false
[2023-07-17 13:51:50] [config] embedding-vectors:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] enc-cell: gru
[2023-07-17 13:51:50] [config] enc-cell-depth: 1
[2023-07-17 13:51:50] [config] enc-depth: 1
[2023-07-17 13:51:50] [config] enc-type: bidirectional
[2023-07-17 13:51:50] [config] english-title-case-every: 0
[2023-07-17 13:51:50] [config] exponential-smoothing: 0
[2023-07-17 13:51:50] [config] factor-weight: 1
[2023-07-17 13:51:50] [config] factors-combine: sum
[2023-07-17 13:51:50] [config] factors-dim-emb: 0
[2023-07-17 13:51:50] [config] gradient-checkpointing: false
[2023-07-17 13:51:50] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:50] [config] guided-alignment: none
[2023-07-17 13:51:50] [config] guided-alignment-cost: mse
[2023-07-17 13:51:50] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:50] [config] ignore-model-config: false
[2023-07-17 13:51:50] [config] input-types:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] interpolate-env-vars: false
[2023-07-17 13:51:50] [config] keep-best: false
[2023-07-17 13:51:50] [config] label-smoothing: 0
[2023-07-17 13:51:50] [config] layer-normalization: false
[2023-07-17 13:51:50] [config] learn-rate: 0.0001
[2023-07-17 13:51:50] [config] lemma-dependency: ""
[2023-07-17 13:51:50] [config] lemma-dim-emb: 0
[2023-07-17 13:51:50] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:50] [config] log-level: info
[2023-07-17 13:51:50] [config] log-time-zone: ""
[2023-07-17 13:51:50] [config] logical-epoch:
[2023-07-17 13:51:50] [config]   - 1e
[2023-07-17 13:51:50] [config]   - 0
[2023-07-17 13:51:50] [config] lr-decay: 0
[2023-07-17 13:51:50] [config] lr-decay-freq: 50000
[2023-07-17 13:51:50] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:50] [config]   - 0
[2023-07-17 13:51:50] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:50] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:50] [config] lr-decay-start:
[2023-07-17 13:51:50] [config]   - 10
[2023-07-17 13:51:50] [config]   - 1
[2023-07-17 13:51:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:50] [config] lr-report: false
[2023-07-17 13:51:50] [config] lr-warmup: 0
[2023-07-17 13:51:50] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:50] [config] lr-warmup-cycle: false
[2023-07-17 13:51:50] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:50] [config] max-length: 200
[2023-07-17 13:51:50] [config] max-length-crop: true
[2023-07-17 13:51:50] [config] max-length-factor: 3
[2023-07-17 13:51:50] [config] maxi-batch: 100
[2023-07-17 13:51:50] [config] maxi-batch-sort: trg
[2023-07-17 13:51:50] [config] mini-batch: 64
[2023-07-17 13:51:50] [config] mini-batch-fit: true
[2023-07-17 13:51:50] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:50] [config] mini-batch-round-up: true
[2023-07-17 13:51:50] [config] mini-batch-track-lr: false
[2023-07-17 13:51:50] [config] mini-batch-warmup: 0
[2023-07-17 13:51:50] [config] mini-batch-words: 0
[2023-07-17 13:51:50] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:50] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:51:50] [config] multi-loss-type: sum
[2023-07-17 13:51:50] [config] n-best: false
[2023-07-17 13:51:50] [config] no-nccl: false
[2023-07-17 13:51:50] [config] no-reload: false
[2023-07-17 13:51:50] [config] no-restore-corpus: false
[2023-07-17 13:51:50] [config] normalize: 0
[2023-07-17 13:51:50] [config] normalize-gradient: false
[2023-07-17 13:51:50] [config] num-devices: 0
[2023-07-17 13:51:50] [config] optimizer: adam
[2023-07-17 13:51:50] [config] optimizer-delay: 1
[2023-07-17 13:51:50] [config] optimizer-params:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] output-omit-bias: false
[2023-07-17 13:51:50] [config] overwrite: true
[2023-07-17 13:51:50] [config] precision:
[2023-07-17 13:51:50] [config]   - float16
[2023-07-17 13:51:50] [config]   - float32
[2023-07-17 13:51:50] [config] pretrained-model: ""
[2023-07-17 13:51:50] [config] quantize-biases: false
[2023-07-17 13:51:50] [config] quantize-bits: 0
[2023-07-17 13:51:50] [config] quantize-log-based: false
[2023-07-17 13:51:50] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:50] [config] quiet: false
[2023-07-17 13:51:50] [config] quiet-translation: true
[2023-07-17 13:51:50] [config] relative-paths: false
[2023-07-17 13:51:50] [config] right-left: false
[2023-07-17 13:51:50] [config] save-freq: 10000u
[2023-07-17 13:51:50] [config] seed: 1234
[2023-07-17 13:51:50] [config] sentencepiece-alphas:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:50] [config] sentencepiece-options: ""
[2023-07-17 13:51:50] [config] sharding: global
[2023-07-17 13:51:50] [config] shuffle: data
[2023-07-17 13:51:50] [config] shuffle-in-ram: false
[2023-07-17 13:51:50] [config] sigterm: save-and-exit
[2023-07-17 13:51:50] [config] skip: false
[2023-07-17 13:51:50] [config] sqlite: ""
[2023-07-17 13:51:50] [config] sqlite-drop: false
[2023-07-17 13:51:50] [config] sync-freq: 200u
[2023-07-17 13:51:50] [config] sync-sgd: false
[2023-07-17 13:51:50] [config] tempdir: /tmp
[2023-07-17 13:51:50] [config] tied-embeddings: false
[2023-07-17 13:51:50] [config] tied-embeddings-all: true
[2023-07-17 13:51:50] [config] tied-embeddings-src: false
[2023-07-17 13:51:50] [config] train-embedder-rank:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] train-sets:
[2023-07-17 13:51:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:50] [config] transformer-aan-activation: swish
[2023-07-17 13:51:50] [config] transformer-aan-depth: 2
[2023-07-17 13:51:50] [config] transformer-aan-nogate: false
[2023-07-17 13:51:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:50] [config] transformer-depth-scaling: false
[2023-07-17 13:51:50] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:50] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:50] [config] transformer-dropout: 0
[2023-07-17 13:51:50] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:50] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:50] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:50] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:50] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:50] [config] transformer-heads: 8
[2023-07-17 13:51:50] [config] transformer-no-projection: false
[2023-07-17 13:51:50] [config] transformer-pool: false
[2023-07-17 13:51:50] [config] transformer-postprocess: dan
[2023-07-17 13:51:50] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:50] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:50] [config] transformer-preprocess: ""
[2023-07-17 13:51:50] [config] transformer-tied-layers:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:50] [config] tsv: false
[2023-07-17 13:51:50] [config] tsv-fields: 0
[2023-07-17 13:51:50] [config] type: amun
[2023-07-17 13:51:50] [config] ulr: false
[2023-07-17 13:51:50] [config] ulr-dim-emb: 0
[2023-07-17 13:51:50] [config] ulr-dropout: 0
[2023-07-17 13:51:50] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:50] [config] ulr-query-vectors: ""
[2023-07-17 13:51:50] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:50] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:50] [config] unlikelihood-loss: false
[2023-07-17 13:51:50] [config] valid-freq: 50000000
[2023-07-17 13:51:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:50] [config] valid-max-length: 1000
[2023-07-17 13:51:50] [config] valid-metrics:
[2023-07-17 13:51:50] [config]   - cross-entropy
[2023-07-17 13:51:50] [config]   - translation
[2023-07-17 13:51:50] [config] valid-mini-batch: 32
[2023-07-17 13:51:50] [config] valid-reset-stalled: false
[2023-07-17 13:51:50] [config] valid-script-args:
[2023-07-17 13:51:50] [config]   []
[2023-07-17 13:51:50] [config] valid-script-path: ""
[2023-07-17 13:51:50] [config] valid-sets:
[2023-07-17 13:51:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:50] [config] vocabs:
[2023-07-17 13:51:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:50] [config] word-penalty: 0
[2023-07-17 13:51:50] [config] word-scores: false
[2023-07-17 13:51:50] [config] workspace: 5500
[2023-07-17 13:51:50] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:50] [training] Using single-device training
[2023-07-17 13:51:50] Synced seed 1234
[2023-07-17 13:51:50] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:50] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:50] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:50] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:50] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:52] [comm] Using global sharding
[2023-07-17 13:51:52] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:52] [training] Using 1 GPUs
[2023-07-17 13:51:52] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:52] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55ba1c192f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55ba1c9281fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55ba1c928d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55ba1c929785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55ba1c5a6f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55ba1c62cd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55ba1c61977c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55ba1c0ea81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55ba1c6c6306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55ba1c6a2f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55ba1c1a4450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55ba1c0c62c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55ba1c07db9c]    main                                               + 0x3c
[0x7f3af06b60b3]    __libc_start_main                                  + 0xf3
[0x55ba1c0c4cbe]    _start                                             + 0x2e

[2023-07-17 13:51:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:53] [marian] Running on node22.datos.cluster.uy as process 8229 with command line:
[2023-07-17 13:51:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:51:53] [config] after: 0e
[2023-07-17 13:51:53] [config] after-batches: 0
[2023-07-17 13:51:53] [config] after-epochs: 20
[2023-07-17 13:51:53] [config] all-caps-every: 0
[2023-07-17 13:51:53] [config] allow-unk: false
[2023-07-17 13:51:53] [config] authors: false
[2023-07-17 13:51:53] [config] beam-size: 12
[2023-07-17 13:51:53] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:53] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:53] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:53] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:53] [config] build-info: ""
[2023-07-17 13:51:53] [config] check-gradient-nan: false
[2023-07-17 13:51:53] [config] check-nan: false
[2023-07-17 13:51:53] [config] cite: false
[2023-07-17 13:51:53] [config] clip-norm: 1
[2023-07-17 13:51:53] [config] cost-scaling:
[2023-07-17 13:51:53] [config]   - 256.f
[2023-07-17 13:51:53] [config]   - 1000
[2023-07-17 13:51:53] [config]   - 2.f
[2023-07-17 13:51:53] [config]   - 256.f
[2023-07-17 13:51:53] [config] cost-type: ce-sum
[2023-07-17 13:51:53] [config] cpu-threads: 0
[2023-07-17 13:51:53] [config] data-threads: 8
[2023-07-17 13:51:53] [config] data-weighting: ""
[2023-07-17 13:51:53] [config] data-weighting-type: sentence
[2023-07-17 13:51:53] [config] dec-cell: gru
[2023-07-17 13:51:53] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:53] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:53] [config] dec-depth: 1
[2023-07-17 13:51:53] [config] devices:
[2023-07-17 13:51:53] [config]   - 0
[2023-07-17 13:51:53] [config] dim-emb: 512
[2023-07-17 13:51:53] [config] dim-rnn: 1024
[2023-07-17 13:51:53] [config] dim-vocabs:
[2023-07-17 13:51:53] [config]   - 16384
[2023-07-17 13:51:53] [config]   - 16384
[2023-07-17 13:51:53] [config] disp-first: 0
[2023-07-17 13:51:53] [config] disp-freq: 1000u
[2023-07-17 13:51:53] [config] disp-label-counts: true
[2023-07-17 13:51:53] [config] dropout-rnn: 0
[2023-07-17 13:51:53] [config] dropout-src: 0
[2023-07-17 13:51:53] [config] dropout-trg: 0
[2023-07-17 13:51:53] [config] dump-config: ""
[2023-07-17 13:51:53] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] early-stopping: 5
[2023-07-17 13:51:53] [config] early-stopping-on: first
[2023-07-17 13:51:53] [config] embedding-fix-src: false
[2023-07-17 13:51:53] [config] embedding-fix-trg: false
[2023-07-17 13:51:53] [config] embedding-normalization: false
[2023-07-17 13:51:53] [config] embedding-vectors:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] enc-cell: gru
[2023-07-17 13:51:53] [config] enc-cell-depth: 1
[2023-07-17 13:51:53] [config] enc-depth: 1
[2023-07-17 13:51:53] [config] enc-type: bidirectional
[2023-07-17 13:51:53] [config] english-title-case-every: 0
[2023-07-17 13:51:53] [config] exponential-smoothing: 0
[2023-07-17 13:51:53] [config] factor-weight: 1
[2023-07-17 13:51:53] [config] factors-combine: sum
[2023-07-17 13:51:53] [config] factors-dim-emb: 0
[2023-07-17 13:51:53] [config] gradient-checkpointing: false
[2023-07-17 13:51:53] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:53] [config] guided-alignment: none
[2023-07-17 13:51:53] [config] guided-alignment-cost: mse
[2023-07-17 13:51:53] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:53] [config] ignore-model-config: false
[2023-07-17 13:51:53] [config] input-types:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] interpolate-env-vars: false
[2023-07-17 13:51:53] [config] keep-best: false
[2023-07-17 13:51:53] [config] label-smoothing: 0
[2023-07-17 13:51:53] [config] layer-normalization: false
[2023-07-17 13:51:53] [config] learn-rate: 0.0001
[2023-07-17 13:51:53] [config] lemma-dependency: ""
[2023-07-17 13:51:53] [config] lemma-dim-emb: 0
[2023-07-17 13:51:53] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:53] [config] log-level: info
[2023-07-17 13:51:53] [config] log-time-zone: ""
[2023-07-17 13:51:53] [config] logical-epoch:
[2023-07-17 13:51:53] [config]   - 1e
[2023-07-17 13:51:53] [config]   - 0
[2023-07-17 13:51:53] [config] lr-decay: 0
[2023-07-17 13:51:53] [config] lr-decay-freq: 50000
[2023-07-17 13:51:53] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:53] [config]   - 0
[2023-07-17 13:51:53] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:53] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:53] [config] lr-decay-start:
[2023-07-17 13:51:53] [config]   - 10
[2023-07-17 13:51:53] [config]   - 1
[2023-07-17 13:51:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:53] [config] lr-report: false
[2023-07-17 13:51:53] [config] lr-warmup: 0
[2023-07-17 13:51:53] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:53] [config] lr-warmup-cycle: false
[2023-07-17 13:51:53] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:53] [config] max-length: 200
[2023-07-17 13:51:53] [config] max-length-crop: true
[2023-07-17 13:51:53] [config] max-length-factor: 3
[2023-07-17 13:51:53] [config] maxi-batch: 100
[2023-07-17 13:51:53] [config] maxi-batch-sort: trg
[2023-07-17 13:51:53] [config] mini-batch: 64
[2023-07-17 13:51:53] [config] mini-batch-fit: true
[2023-07-17 13:51:53] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:53] [config] mini-batch-round-up: true
[2023-07-17 13:51:53] [config] mini-batch-track-lr: false
[2023-07-17 13:51:53] [config] mini-batch-warmup: 0
[2023-07-17 13:51:53] [config] mini-batch-words: 0
[2023-07-17 13:51:53] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:51:53] [config] multi-loss-type: sum
[2023-07-17 13:51:53] [config] n-best: false
[2023-07-17 13:51:53] [config] no-nccl: false
[2023-07-17 13:51:53] [config] no-reload: false
[2023-07-17 13:51:53] [config] no-restore-corpus: false
[2023-07-17 13:51:53] [config] normalize: 0
[2023-07-17 13:51:53] [config] normalize-gradient: false
[2023-07-17 13:51:53] [config] num-devices: 0
[2023-07-17 13:51:53] [config] optimizer: adam
[2023-07-17 13:51:53] [config] optimizer-delay: 1
[2023-07-17 13:51:53] [config] optimizer-params:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] output-omit-bias: false
[2023-07-17 13:51:53] [config] overwrite: true
[2023-07-17 13:51:53] [config] precision:
[2023-07-17 13:51:53] [config]   - float16
[2023-07-17 13:51:53] [config]   - float32
[2023-07-17 13:51:53] [config] pretrained-model: ""
[2023-07-17 13:51:53] [config] quantize-biases: false
[2023-07-17 13:51:53] [config] quantize-bits: 0
[2023-07-17 13:51:53] [config] quantize-log-based: false
[2023-07-17 13:51:53] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:53] [config] quiet: false
[2023-07-17 13:51:53] [config] quiet-translation: true
[2023-07-17 13:51:53] [config] relative-paths: false
[2023-07-17 13:51:53] [config] right-left: false
[2023-07-17 13:51:53] [config] save-freq: 10000u
[2023-07-17 13:51:53] [config] seed: 1234
[2023-07-17 13:51:53] [config] sentencepiece-alphas:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:53] [config] sentencepiece-options: ""
[2023-07-17 13:51:53] [config] sharding: global
[2023-07-17 13:51:53] [config] shuffle: data
[2023-07-17 13:51:53] [config] shuffle-in-ram: false
[2023-07-17 13:51:53] [config] sigterm: save-and-exit
[2023-07-17 13:51:53] [config] skip: false
[2023-07-17 13:51:53] [config] sqlite: ""
[2023-07-17 13:51:53] [config] sqlite-drop: false
[2023-07-17 13:51:53] [config] sync-freq: 200u
[2023-07-17 13:51:53] [config] sync-sgd: false
[2023-07-17 13:51:53] [config] tempdir: /tmp
[2023-07-17 13:51:53] [config] tied-embeddings: false
[2023-07-17 13:51:53] [config] tied-embeddings-all: true
[2023-07-17 13:51:53] [config] tied-embeddings-src: false
[2023-07-17 13:51:53] [config] train-embedder-rank:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] train-sets:
[2023-07-17 13:51:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:53] [config] transformer-aan-activation: swish
[2023-07-17 13:51:53] [config] transformer-aan-depth: 2
[2023-07-17 13:51:53] [config] transformer-aan-nogate: false
[2023-07-17 13:51:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:53] [config] transformer-depth-scaling: false
[2023-07-17 13:51:53] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:53] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:53] [config] transformer-dropout: 0
[2023-07-17 13:51:53] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:53] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:53] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:53] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:53] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:53] [config] transformer-heads: 8
[2023-07-17 13:51:53] [config] transformer-no-projection: false
[2023-07-17 13:51:53] [config] transformer-pool: false
[2023-07-17 13:51:53] [config] transformer-postprocess: dan
[2023-07-17 13:51:53] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:53] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:53] [config] transformer-preprocess: ""
[2023-07-17 13:51:53] [config] transformer-tied-layers:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:53] [config] tsv: false
[2023-07-17 13:51:53] [config] tsv-fields: 0
[2023-07-17 13:51:53] [config] type: amun
[2023-07-17 13:51:53] [config] ulr: false
[2023-07-17 13:51:53] [config] ulr-dim-emb: 0
[2023-07-17 13:51:53] [config] ulr-dropout: 0
[2023-07-17 13:51:53] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:53] [config] ulr-query-vectors: ""
[2023-07-17 13:51:53] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:53] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:53] [config] unlikelihood-loss: false
[2023-07-17 13:51:53] [config] valid-freq: 50000000
[2023-07-17 13:51:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:53] [config] valid-max-length: 1000
[2023-07-17 13:51:53] [config] valid-metrics:
[2023-07-17 13:51:53] [config]   - cross-entropy
[2023-07-17 13:51:53] [config]   - translation
[2023-07-17 13:51:53] [config] valid-mini-batch: 32
[2023-07-17 13:51:53] [config] valid-reset-stalled: false
[2023-07-17 13:51:53] [config] valid-script-args:
[2023-07-17 13:51:53] [config]   []
[2023-07-17 13:51:53] [config] valid-script-path: ""
[2023-07-17 13:51:53] [config] valid-sets:
[2023-07-17 13:51:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:53] [config] vocabs:
[2023-07-17 13:51:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:53] [config] word-penalty: 0
[2023-07-17 13:51:53] [config] word-scores: false
[2023-07-17 13:51:53] [config] workspace: 5500
[2023-07-17 13:51:53] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:53] [training] Using single-device training
[2023-07-17 13:51:53] Synced seed 1234
[2023-07-17 13:51:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:53] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:53] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:53] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:53] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:54] [comm] Using global sharding
[2023-07-17 13:51:54] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:54] [training] Using 1 GPUs
[2023-07-17 13:51:54] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:54] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x559867d1df01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5598684b31fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5598684b3d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5598684b4785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x559868131f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5598681b7d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x5598681a477c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x559867c7581d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x559868251306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55986822df2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x559867d2f450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x559867c512c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x559867c08b9c]    main                                               + 0x3c
[0x7f8c8d8ee0b3]    __libc_start_main                                  + 0xf3
[0x559867c4fcbe]    _start                                             + 0x2e

[2023-07-17 13:51:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:55] [marian] Running on node22.datos.cluster.uy as process 8259 with command line:
[2023-07-17 13:51:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:51:55] [config] after: 0e
[2023-07-17 13:51:55] [config] after-batches: 0
[2023-07-17 13:51:55] [config] after-epochs: 30
[2023-07-17 13:51:55] [config] all-caps-every: 0
[2023-07-17 13:51:55] [config] allow-unk: false
[2023-07-17 13:51:55] [config] authors: false
[2023-07-17 13:51:55] [config] beam-size: 12
[2023-07-17 13:51:55] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:55] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:55] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:55] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:55] [config] build-info: ""
[2023-07-17 13:51:55] [config] check-gradient-nan: false
[2023-07-17 13:51:55] [config] check-nan: false
[2023-07-17 13:51:55] [config] cite: false
[2023-07-17 13:51:55] [config] clip-norm: 1
[2023-07-17 13:51:55] [config] cost-scaling:
[2023-07-17 13:51:55] [config]   - 256.f
[2023-07-17 13:51:55] [config]   - 1000
[2023-07-17 13:51:55] [config]   - 2.f
[2023-07-17 13:51:55] [config]   - 256.f
[2023-07-17 13:51:55] [config] cost-type: ce-sum
[2023-07-17 13:51:55] [config] cpu-threads: 0
[2023-07-17 13:51:55] [config] data-threads: 8
[2023-07-17 13:51:55] [config] data-weighting: ""
[2023-07-17 13:51:55] [config] data-weighting-type: sentence
[2023-07-17 13:51:55] [config] dec-cell: gru
[2023-07-17 13:51:55] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:55] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:55] [config] dec-depth: 1
[2023-07-17 13:51:55] [config] devices:
[2023-07-17 13:51:55] [config]   - 0
[2023-07-17 13:51:55] [config] dim-emb: 512
[2023-07-17 13:51:55] [config] dim-rnn: 1024
[2023-07-17 13:51:55] [config] dim-vocabs:
[2023-07-17 13:51:55] [config]   - 16384
[2023-07-17 13:51:55] [config]   - 16384
[2023-07-17 13:51:55] [config] disp-first: 0
[2023-07-17 13:51:55] [config] disp-freq: 1000u
[2023-07-17 13:51:55] [config] disp-label-counts: true
[2023-07-17 13:51:55] [config] dropout-rnn: 0
[2023-07-17 13:51:55] [config] dropout-src: 0
[2023-07-17 13:51:55] [config] dropout-trg: 0
[2023-07-17 13:51:55] [config] dump-config: ""
[2023-07-17 13:51:55] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] early-stopping: 5
[2023-07-17 13:51:55] [config] early-stopping-on: first
[2023-07-17 13:51:55] [config] embedding-fix-src: false
[2023-07-17 13:51:55] [config] embedding-fix-trg: false
[2023-07-17 13:51:55] [config] embedding-normalization: false
[2023-07-17 13:51:55] [config] embedding-vectors:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] enc-cell: gru
[2023-07-17 13:51:55] [config] enc-cell-depth: 1
[2023-07-17 13:51:55] [config] enc-depth: 1
[2023-07-17 13:51:55] [config] enc-type: bidirectional
[2023-07-17 13:51:55] [config] english-title-case-every: 0
[2023-07-17 13:51:55] [config] exponential-smoothing: 0
[2023-07-17 13:51:55] [config] factor-weight: 1
[2023-07-17 13:51:55] [config] factors-combine: sum
[2023-07-17 13:51:55] [config] factors-dim-emb: 0
[2023-07-17 13:51:55] [config] gradient-checkpointing: false
[2023-07-17 13:51:55] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:55] [config] guided-alignment: none
[2023-07-17 13:51:55] [config] guided-alignment-cost: mse
[2023-07-17 13:51:55] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:55] [config] ignore-model-config: false
[2023-07-17 13:51:55] [config] input-types:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] interpolate-env-vars: false
[2023-07-17 13:51:55] [config] keep-best: false
[2023-07-17 13:51:55] [config] label-smoothing: 0
[2023-07-17 13:51:55] [config] layer-normalization: false
[2023-07-17 13:51:55] [config] learn-rate: 0.0001
[2023-07-17 13:51:55] [config] lemma-dependency: ""
[2023-07-17 13:51:55] [config] lemma-dim-emb: 0
[2023-07-17 13:51:55] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:55] [config] log-level: info
[2023-07-17 13:51:55] [config] log-time-zone: ""
[2023-07-17 13:51:55] [config] logical-epoch:
[2023-07-17 13:51:55] [config]   - 1e
[2023-07-17 13:51:55] [config]   - 0
[2023-07-17 13:51:55] [config] lr-decay: 0
[2023-07-17 13:51:55] [config] lr-decay-freq: 50000
[2023-07-17 13:51:55] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:55] [config]   - 0
[2023-07-17 13:51:55] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:55] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:55] [config] lr-decay-start:
[2023-07-17 13:51:55] [config]   - 10
[2023-07-17 13:51:55] [config]   - 1
[2023-07-17 13:51:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:55] [config] lr-report: false
[2023-07-17 13:51:55] [config] lr-warmup: 0
[2023-07-17 13:51:55] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:55] [config] lr-warmup-cycle: false
[2023-07-17 13:51:55] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:55] [config] max-length: 200
[2023-07-17 13:51:55] [config] max-length-crop: true
[2023-07-17 13:51:55] [config] max-length-factor: 3
[2023-07-17 13:51:55] [config] maxi-batch: 100
[2023-07-17 13:51:55] [config] maxi-batch-sort: trg
[2023-07-17 13:51:55] [config] mini-batch: 64
[2023-07-17 13:51:55] [config] mini-batch-fit: true
[2023-07-17 13:51:55] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:55] [config] mini-batch-round-up: true
[2023-07-17 13:51:55] [config] mini-batch-track-lr: false
[2023-07-17 13:51:55] [config] mini-batch-warmup: 0
[2023-07-17 13:51:55] [config] mini-batch-words: 0
[2023-07-17 13:51:55] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:55] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:51:55] [config] multi-loss-type: sum
[2023-07-17 13:51:55] [config] n-best: false
[2023-07-17 13:51:55] [config] no-nccl: false
[2023-07-17 13:51:55] [config] no-reload: false
[2023-07-17 13:51:55] [config] no-restore-corpus: false
[2023-07-17 13:51:55] [config] normalize: 0
[2023-07-17 13:51:55] [config] normalize-gradient: false
[2023-07-17 13:51:55] [config] num-devices: 0
[2023-07-17 13:51:55] [config] optimizer: adam
[2023-07-17 13:51:55] [config] optimizer-delay: 1
[2023-07-17 13:51:55] [config] optimizer-params:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] output-omit-bias: false
[2023-07-17 13:51:55] [config] overwrite: true
[2023-07-17 13:51:55] [config] precision:
[2023-07-17 13:51:55] [config]   - float16
[2023-07-17 13:51:55] [config]   - float32
[2023-07-17 13:51:55] [config] pretrained-model: ""
[2023-07-17 13:51:55] [config] quantize-biases: false
[2023-07-17 13:51:55] [config] quantize-bits: 0
[2023-07-17 13:51:55] [config] quantize-log-based: false
[2023-07-17 13:51:55] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:55] [config] quiet: false
[2023-07-17 13:51:55] [config] quiet-translation: true
[2023-07-17 13:51:55] [config] relative-paths: false
[2023-07-17 13:51:55] [config] right-left: false
[2023-07-17 13:51:55] [config] save-freq: 10000u
[2023-07-17 13:51:55] [config] seed: 1234
[2023-07-17 13:51:55] [config] sentencepiece-alphas:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:55] [config] sentencepiece-options: ""
[2023-07-17 13:51:55] [config] sharding: global
[2023-07-17 13:51:55] [config] shuffle: data
[2023-07-17 13:51:55] [config] shuffle-in-ram: false
[2023-07-17 13:51:55] [config] sigterm: save-and-exit
[2023-07-17 13:51:55] [config] skip: false
[2023-07-17 13:51:55] [config] sqlite: ""
[2023-07-17 13:51:55] [config] sqlite-drop: false
[2023-07-17 13:51:55] [config] sync-freq: 200u
[2023-07-17 13:51:55] [config] sync-sgd: false
[2023-07-17 13:51:55] [config] tempdir: /tmp
[2023-07-17 13:51:55] [config] tied-embeddings: false
[2023-07-17 13:51:55] [config] tied-embeddings-all: true
[2023-07-17 13:51:55] [config] tied-embeddings-src: false
[2023-07-17 13:51:55] [config] train-embedder-rank:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] train-sets:
[2023-07-17 13:51:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:55] [config] transformer-aan-activation: swish
[2023-07-17 13:51:55] [config] transformer-aan-depth: 2
[2023-07-17 13:51:55] [config] transformer-aan-nogate: false
[2023-07-17 13:51:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:55] [config] transformer-depth-scaling: false
[2023-07-17 13:51:55] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:55] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:55] [config] transformer-dropout: 0
[2023-07-17 13:51:55] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:55] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:55] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:55] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:55] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:55] [config] transformer-heads: 8
[2023-07-17 13:51:55] [config] transformer-no-projection: false
[2023-07-17 13:51:55] [config] transformer-pool: false
[2023-07-17 13:51:55] [config] transformer-postprocess: dan
[2023-07-17 13:51:55] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:55] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:55] [config] transformer-preprocess: ""
[2023-07-17 13:51:55] [config] transformer-tied-layers:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:55] [config] tsv: false
[2023-07-17 13:51:55] [config] tsv-fields: 0
[2023-07-17 13:51:55] [config] type: amun
[2023-07-17 13:51:55] [config] ulr: false
[2023-07-17 13:51:55] [config] ulr-dim-emb: 0
[2023-07-17 13:51:55] [config] ulr-dropout: 0
[2023-07-17 13:51:55] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:55] [config] ulr-query-vectors: ""
[2023-07-17 13:51:55] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:55] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:55] [config] unlikelihood-loss: false
[2023-07-17 13:51:55] [config] valid-freq: 50000000
[2023-07-17 13:51:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:55] [config] valid-max-length: 1000
[2023-07-17 13:51:55] [config] valid-metrics:
[2023-07-17 13:51:55] [config]   - cross-entropy
[2023-07-17 13:51:55] [config]   - translation
[2023-07-17 13:51:55] [config] valid-mini-batch: 32
[2023-07-17 13:51:55] [config] valid-reset-stalled: false
[2023-07-17 13:51:55] [config] valid-script-args:
[2023-07-17 13:51:55] [config]   []
[2023-07-17 13:51:55] [config] valid-script-path: ""
[2023-07-17 13:51:55] [config] valid-sets:
[2023-07-17 13:51:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:55] [config] vocabs:
[2023-07-17 13:51:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:55] [config] word-penalty: 0
[2023-07-17 13:51:55] [config] word-scores: false
[2023-07-17 13:51:55] [config] workspace: 5500
[2023-07-17 13:51:55] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:55] [training] Using single-device training
[2023-07-17 13:51:56] Synced seed 1234
[2023-07-17 13:51:56] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:56] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:57] [comm] Using global sharding
[2023-07-17 13:51:57] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:57] [training] Using 1 GPUs
[2023-07-17 13:51:57] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:57] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55b0c3b30f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55b0c42c61fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55b0c42c6d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55b0c42c7785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55b0c3f44f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55b0c3fcad5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55b0c3fb777c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55b0c3a8881d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55b0c4064306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55b0c4040f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55b0c3b42450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55b0c3a642c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b0c3a1bb9c]    main                                               + 0x3c
[0x7f2660ee50b3]    __libc_start_main                                  + 0xf3
[0x55b0c3a62cbe]    _start                                             + 0x2e

[2023-07-17 13:51:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:58] [marian] Running on node22.datos.cluster.uy as process 8289 with command line:
[2023-07-17 13:51:58] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:51:58] [config] after: 0e
[2023-07-17 13:51:58] [config] after-batches: 0
[2023-07-17 13:51:58] [config] after-epochs: 40
[2023-07-17 13:51:58] [config] all-caps-every: 0
[2023-07-17 13:51:58] [config] allow-unk: false
[2023-07-17 13:51:58] [config] authors: false
[2023-07-17 13:51:58] [config] beam-size: 12
[2023-07-17 13:51:58] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:51:58] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:51:58] [config] bert-masking-fraction: 0.15
[2023-07-17 13:51:58] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:51:58] [config] bert-train-type-embeddings: true
[2023-07-17 13:51:58] [config] bert-type-vocab-size: 2
[2023-07-17 13:51:58] [config] build-info: ""
[2023-07-17 13:51:58] [config] check-gradient-nan: false
[2023-07-17 13:51:58] [config] check-nan: false
[2023-07-17 13:51:58] [config] cite: false
[2023-07-17 13:51:58] [config] clip-norm: 1
[2023-07-17 13:51:58] [config] cost-scaling:
[2023-07-17 13:51:58] [config]   - 256.f
[2023-07-17 13:51:58] [config]   - 1000
[2023-07-17 13:51:58] [config]   - 2.f
[2023-07-17 13:51:58] [config]   - 256.f
[2023-07-17 13:51:58] [config] cost-type: ce-sum
[2023-07-17 13:51:58] [config] cpu-threads: 0
[2023-07-17 13:51:58] [config] data-threads: 8
[2023-07-17 13:51:58] [config] data-weighting: ""
[2023-07-17 13:51:58] [config] data-weighting-type: sentence
[2023-07-17 13:51:58] [config] dec-cell: gru
[2023-07-17 13:51:58] [config] dec-cell-base-depth: 2
[2023-07-17 13:51:58] [config] dec-cell-high-depth: 1
[2023-07-17 13:51:58] [config] dec-depth: 1
[2023-07-17 13:51:58] [config] devices:
[2023-07-17 13:51:58] [config]   - 0
[2023-07-17 13:51:58] [config] dim-emb: 512
[2023-07-17 13:51:58] [config] dim-rnn: 1024
[2023-07-17 13:51:58] [config] dim-vocabs:
[2023-07-17 13:51:58] [config]   - 16384
[2023-07-17 13:51:58] [config]   - 16384
[2023-07-17 13:51:58] [config] disp-first: 0
[2023-07-17 13:51:58] [config] disp-freq: 1000u
[2023-07-17 13:51:58] [config] disp-label-counts: true
[2023-07-17 13:51:58] [config] dropout-rnn: 0
[2023-07-17 13:51:58] [config] dropout-src: 0
[2023-07-17 13:51:58] [config] dropout-trg: 0
[2023-07-17 13:51:58] [config] dump-config: ""
[2023-07-17 13:51:58] [config] dynamic-gradient-scaling:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] early-stopping: 5
[2023-07-17 13:51:58] [config] early-stopping-on: first
[2023-07-17 13:51:58] [config] embedding-fix-src: false
[2023-07-17 13:51:58] [config] embedding-fix-trg: false
[2023-07-17 13:51:58] [config] embedding-normalization: false
[2023-07-17 13:51:58] [config] embedding-vectors:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] enc-cell: gru
[2023-07-17 13:51:58] [config] enc-cell-depth: 1
[2023-07-17 13:51:58] [config] enc-depth: 1
[2023-07-17 13:51:58] [config] enc-type: bidirectional
[2023-07-17 13:51:58] [config] english-title-case-every: 0
[2023-07-17 13:51:58] [config] exponential-smoothing: 0
[2023-07-17 13:51:58] [config] factor-weight: 1
[2023-07-17 13:51:58] [config] factors-combine: sum
[2023-07-17 13:51:58] [config] factors-dim-emb: 0
[2023-07-17 13:51:58] [config] gradient-checkpointing: false
[2023-07-17 13:51:58] [config] gradient-norm-average-window: 100
[2023-07-17 13:51:58] [config] guided-alignment: none
[2023-07-17 13:51:58] [config] guided-alignment-cost: mse
[2023-07-17 13:51:58] [config] guided-alignment-weight: 0.1
[2023-07-17 13:51:58] [config] ignore-model-config: false
[2023-07-17 13:51:58] [config] input-types:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] interpolate-env-vars: false
[2023-07-17 13:51:58] [config] keep-best: false
[2023-07-17 13:51:58] [config] label-smoothing: 0
[2023-07-17 13:51:58] [config] layer-normalization: false
[2023-07-17 13:51:58] [config] learn-rate: 0.0001
[2023-07-17 13:51:58] [config] lemma-dependency: ""
[2023-07-17 13:51:58] [config] lemma-dim-emb: 0
[2023-07-17 13:51:58] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:58] [config] log-level: info
[2023-07-17 13:51:58] [config] log-time-zone: ""
[2023-07-17 13:51:58] [config] logical-epoch:
[2023-07-17 13:51:58] [config]   - 1e
[2023-07-17 13:51:58] [config]   - 0
[2023-07-17 13:51:58] [config] lr-decay: 0
[2023-07-17 13:51:58] [config] lr-decay-freq: 50000
[2023-07-17 13:51:58] [config] lr-decay-inv-sqrt:
[2023-07-17 13:51:58] [config]   - 0
[2023-07-17 13:51:58] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:51:58] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:51:58] [config] lr-decay-start:
[2023-07-17 13:51:58] [config]   - 10
[2023-07-17 13:51:58] [config]   - 1
[2023-07-17 13:51:58] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:51:58] [config] lr-report: false
[2023-07-17 13:51:58] [config] lr-warmup: 0
[2023-07-17 13:51:58] [config] lr-warmup-at-reload: false
[2023-07-17 13:51:58] [config] lr-warmup-cycle: false
[2023-07-17 13:51:58] [config] lr-warmup-start-rate: 0
[2023-07-17 13:51:58] [config] max-length: 200
[2023-07-17 13:51:58] [config] max-length-crop: true
[2023-07-17 13:51:58] [config] max-length-factor: 3
[2023-07-17 13:51:58] [config] maxi-batch: 100
[2023-07-17 13:51:58] [config] maxi-batch-sort: trg
[2023-07-17 13:51:58] [config] mini-batch: 64
[2023-07-17 13:51:58] [config] mini-batch-fit: true
[2023-07-17 13:51:58] [config] mini-batch-fit-step: 10
[2023-07-17 13:51:58] [config] mini-batch-round-up: true
[2023-07-17 13:51:58] [config] mini-batch-track-lr: false
[2023-07-17 13:51:58] [config] mini-batch-warmup: 0
[2023-07-17 13:51:58] [config] mini-batch-words: 0
[2023-07-17 13:51:58] [config] mini-batch-words-ref: 0
[2023-07-17 13:51:58] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:51:58] [config] multi-loss-type: sum
[2023-07-17 13:51:58] [config] n-best: false
[2023-07-17 13:51:58] [config] no-nccl: false
[2023-07-17 13:51:58] [config] no-reload: false
[2023-07-17 13:51:58] [config] no-restore-corpus: false
[2023-07-17 13:51:58] [config] normalize: 0
[2023-07-17 13:51:58] [config] normalize-gradient: false
[2023-07-17 13:51:58] [config] num-devices: 0
[2023-07-17 13:51:58] [config] optimizer: adam
[2023-07-17 13:51:58] [config] optimizer-delay: 1
[2023-07-17 13:51:58] [config] optimizer-params:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] output-omit-bias: false
[2023-07-17 13:51:58] [config] overwrite: true
[2023-07-17 13:51:58] [config] precision:
[2023-07-17 13:51:58] [config]   - float16
[2023-07-17 13:51:58] [config]   - float32
[2023-07-17 13:51:58] [config] pretrained-model: ""
[2023-07-17 13:51:58] [config] quantize-biases: false
[2023-07-17 13:51:58] [config] quantize-bits: 0
[2023-07-17 13:51:58] [config] quantize-log-based: false
[2023-07-17 13:51:58] [config] quantize-optimization-steps: 0
[2023-07-17 13:51:58] [config] quiet: false
[2023-07-17 13:51:58] [config] quiet-translation: true
[2023-07-17 13:51:58] [config] relative-paths: false
[2023-07-17 13:51:58] [config] right-left: false
[2023-07-17 13:51:58] [config] save-freq: 10000u
[2023-07-17 13:51:58] [config] seed: 1234
[2023-07-17 13:51:58] [config] sentencepiece-alphas:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:51:58] [config] sentencepiece-options: ""
[2023-07-17 13:51:58] [config] sharding: global
[2023-07-17 13:51:58] [config] shuffle: data
[2023-07-17 13:51:58] [config] shuffle-in-ram: false
[2023-07-17 13:51:58] [config] sigterm: save-and-exit
[2023-07-17 13:51:58] [config] skip: false
[2023-07-17 13:51:58] [config] sqlite: ""
[2023-07-17 13:51:58] [config] sqlite-drop: false
[2023-07-17 13:51:58] [config] sync-freq: 200u
[2023-07-17 13:51:58] [config] sync-sgd: false
[2023-07-17 13:51:58] [config] tempdir: /tmp
[2023-07-17 13:51:58] [config] tied-embeddings: false
[2023-07-17 13:51:58] [config] tied-embeddings-all: true
[2023-07-17 13:51:58] [config] tied-embeddings-src: false
[2023-07-17 13:51:58] [config] train-embedder-rank:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] train-sets:
[2023-07-17 13:51:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:51:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:51:58] [config] transformer-aan-activation: swish
[2023-07-17 13:51:58] [config] transformer-aan-depth: 2
[2023-07-17 13:51:58] [config] transformer-aan-nogate: false
[2023-07-17 13:51:58] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:51:58] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:51:58] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:51:58] [config] transformer-depth-scaling: false
[2023-07-17 13:51:58] [config] transformer-dim-aan: 2048
[2023-07-17 13:51:58] [config] transformer-dim-ffn: 2048
[2023-07-17 13:51:58] [config] transformer-dropout: 0
[2023-07-17 13:51:58] [config] transformer-dropout-attention: 0
[2023-07-17 13:51:58] [config] transformer-dropout-ffn: 0
[2023-07-17 13:51:58] [config] transformer-ffn-activation: swish
[2023-07-17 13:51:58] [config] transformer-ffn-depth: 2
[2023-07-17 13:51:58] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:51:58] [config] transformer-heads: 8
[2023-07-17 13:51:58] [config] transformer-no-projection: false
[2023-07-17 13:51:58] [config] transformer-pool: false
[2023-07-17 13:51:58] [config] transformer-postprocess: dan
[2023-07-17 13:51:58] [config] transformer-postprocess-emb: d
[2023-07-17 13:51:58] [config] transformer-postprocess-top: ""
[2023-07-17 13:51:58] [config] transformer-preprocess: ""
[2023-07-17 13:51:58] [config] transformer-tied-layers:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] transformer-train-position-embeddings: false
[2023-07-17 13:51:58] [config] tsv: false
[2023-07-17 13:51:58] [config] tsv-fields: 0
[2023-07-17 13:51:58] [config] type: amun
[2023-07-17 13:51:58] [config] ulr: false
[2023-07-17 13:51:58] [config] ulr-dim-emb: 0
[2023-07-17 13:51:58] [config] ulr-dropout: 0
[2023-07-17 13:51:58] [config] ulr-keys-vectors: ""
[2023-07-17 13:51:58] [config] ulr-query-vectors: ""
[2023-07-17 13:51:58] [config] ulr-softmax-temperature: 1
[2023-07-17 13:51:58] [config] ulr-trainable-transformation: false
[2023-07-17 13:51:58] [config] unlikelihood-loss: false
[2023-07-17 13:51:58] [config] valid-freq: 50000000
[2023-07-17 13:51:58] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:51:58] [config] valid-max-length: 1000
[2023-07-17 13:51:58] [config] valid-metrics:
[2023-07-17 13:51:58] [config]   - cross-entropy
[2023-07-17 13:51:58] [config]   - translation
[2023-07-17 13:51:58] [config] valid-mini-batch: 32
[2023-07-17 13:51:58] [config] valid-reset-stalled: false
[2023-07-17 13:51:58] [config] valid-script-args:
[2023-07-17 13:51:58] [config]   []
[2023-07-17 13:51:58] [config] valid-script-path: ""
[2023-07-17 13:51:58] [config] valid-sets:
[2023-07-17 13:51:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:51:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:51:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:51:58] [config] vocabs:
[2023-07-17 13:51:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:58] [config] word-penalty: 0
[2023-07-17 13:51:58] [config] word-scores: false
[2023-07-17 13:51:58] [config] workspace: 5500
[2023-07-17 13:51:58] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:51:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:58] [training] Using single-device training
[2023-07-17 13:51:58] Synced seed 1234
[2023-07-17 13:51:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:51:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:51:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:51:58] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:51:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:51:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:51:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:51:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:51:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:51:59] [comm] Using global sharding
[2023-07-17 13:51:59] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:51:59] [training] Using 1 GPUs
[2023-07-17 13:51:59] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:51:59] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55a1bf0b5f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55a1bf84b1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55a1bf84bd6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55a1bf84c785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55a1bf4c9f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55a1bf54fd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55a1bf53c77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55a1bf00d81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55a1bf5e9306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55a1bf5c5f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55a1bf0c7450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55a1befe92c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a1befa0b9c]    main                                               + 0x3c
[0x7f2e222150b3]    __libc_start_main                                  + 0xf3
[0x55a1befe7cbe]    _start                                             + 0x2e

[2023-07-17 13:52:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:00] [marian] Running on node22.datos.cluster.uy as process 8319 with command line:
[2023-07-17 13:52:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:52:00] [config] after: 0e
[2023-07-17 13:52:00] [config] after-batches: 0
[2023-07-17 13:52:00] [config] after-epochs: 50
[2023-07-17 13:52:00] [config] all-caps-every: 0
[2023-07-17 13:52:00] [config] allow-unk: false
[2023-07-17 13:52:00] [config] authors: false
[2023-07-17 13:52:00] [config] beam-size: 12
[2023-07-17 13:52:00] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:52:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:52:00] [config] bert-masking-fraction: 0.15
[2023-07-17 13:52:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:52:00] [config] bert-train-type-embeddings: true
[2023-07-17 13:52:00] [config] bert-type-vocab-size: 2
[2023-07-17 13:52:00] [config] build-info: ""
[2023-07-17 13:52:00] [config] check-gradient-nan: false
[2023-07-17 13:52:00] [config] check-nan: false
[2023-07-17 13:52:00] [config] cite: false
[2023-07-17 13:52:00] [config] clip-norm: 1
[2023-07-17 13:52:00] [config] cost-scaling:
[2023-07-17 13:52:00] [config]   - 256.f
[2023-07-17 13:52:00] [config]   - 1000
[2023-07-17 13:52:00] [config]   - 2.f
[2023-07-17 13:52:00] [config]   - 256.f
[2023-07-17 13:52:00] [config] cost-type: ce-sum
[2023-07-17 13:52:00] [config] cpu-threads: 0
[2023-07-17 13:52:00] [config] data-threads: 8
[2023-07-17 13:52:00] [config] data-weighting: ""
[2023-07-17 13:52:00] [config] data-weighting-type: sentence
[2023-07-17 13:52:00] [config] dec-cell: gru
[2023-07-17 13:52:00] [config] dec-cell-base-depth: 2
[2023-07-17 13:52:00] [config] dec-cell-high-depth: 1
[2023-07-17 13:52:00] [config] dec-depth: 1
[2023-07-17 13:52:00] [config] devices:
[2023-07-17 13:52:00] [config]   - 0
[2023-07-17 13:52:00] [config] dim-emb: 512
[2023-07-17 13:52:00] [config] dim-rnn: 1024
[2023-07-17 13:52:00] [config] dim-vocabs:
[2023-07-17 13:52:00] [config]   - 16384
[2023-07-17 13:52:00] [config]   - 16384
[2023-07-17 13:52:00] [config] disp-first: 0
[2023-07-17 13:52:00] [config] disp-freq: 1000u
[2023-07-17 13:52:00] [config] disp-label-counts: true
[2023-07-17 13:52:00] [config] dropout-rnn: 0
[2023-07-17 13:52:00] [config] dropout-src: 0
[2023-07-17 13:52:00] [config] dropout-trg: 0
[2023-07-17 13:52:00] [config] dump-config: ""
[2023-07-17 13:52:00] [config] dynamic-gradient-scaling:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] early-stopping: 5
[2023-07-17 13:52:00] [config] early-stopping-on: first
[2023-07-17 13:52:00] [config] embedding-fix-src: false
[2023-07-17 13:52:00] [config] embedding-fix-trg: false
[2023-07-17 13:52:00] [config] embedding-normalization: false
[2023-07-17 13:52:00] [config] embedding-vectors:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] enc-cell: gru
[2023-07-17 13:52:00] [config] enc-cell-depth: 1
[2023-07-17 13:52:00] [config] enc-depth: 1
[2023-07-17 13:52:00] [config] enc-type: bidirectional
[2023-07-17 13:52:00] [config] english-title-case-every: 0
[2023-07-17 13:52:00] [config] exponential-smoothing: 0
[2023-07-17 13:52:00] [config] factor-weight: 1
[2023-07-17 13:52:00] [config] factors-combine: sum
[2023-07-17 13:52:00] [config] factors-dim-emb: 0
[2023-07-17 13:52:00] [config] gradient-checkpointing: false
[2023-07-17 13:52:00] [config] gradient-norm-average-window: 100
[2023-07-17 13:52:00] [config] guided-alignment: none
[2023-07-17 13:52:00] [config] guided-alignment-cost: mse
[2023-07-17 13:52:00] [config] guided-alignment-weight: 0.1
[2023-07-17 13:52:00] [config] ignore-model-config: false
[2023-07-17 13:52:00] [config] input-types:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] interpolate-env-vars: false
[2023-07-17 13:52:00] [config] keep-best: false
[2023-07-17 13:52:00] [config] label-smoothing: 0
[2023-07-17 13:52:00] [config] layer-normalization: false
[2023-07-17 13:52:00] [config] learn-rate: 0.0001
[2023-07-17 13:52:00] [config] lemma-dependency: ""
[2023-07-17 13:52:00] [config] lemma-dim-emb: 0
[2023-07-17 13:52:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:00] [config] log-level: info
[2023-07-17 13:52:00] [config] log-time-zone: ""
[2023-07-17 13:52:00] [config] logical-epoch:
[2023-07-17 13:52:00] [config]   - 1e
[2023-07-17 13:52:00] [config]   - 0
[2023-07-17 13:52:00] [config] lr-decay: 0
[2023-07-17 13:52:00] [config] lr-decay-freq: 50000
[2023-07-17 13:52:00] [config] lr-decay-inv-sqrt:
[2023-07-17 13:52:00] [config]   - 0
[2023-07-17 13:52:00] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:52:00] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:52:00] [config] lr-decay-start:
[2023-07-17 13:52:00] [config]   - 10
[2023-07-17 13:52:00] [config]   - 1
[2023-07-17 13:52:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:52:00] [config] lr-report: false
[2023-07-17 13:52:00] [config] lr-warmup: 0
[2023-07-17 13:52:00] [config] lr-warmup-at-reload: false
[2023-07-17 13:52:00] [config] lr-warmup-cycle: false
[2023-07-17 13:52:00] [config] lr-warmup-start-rate: 0
[2023-07-17 13:52:00] [config] max-length: 200
[2023-07-17 13:52:00] [config] max-length-crop: true
[2023-07-17 13:52:00] [config] max-length-factor: 3
[2023-07-17 13:52:00] [config] maxi-batch: 100
[2023-07-17 13:52:00] [config] maxi-batch-sort: trg
[2023-07-17 13:52:00] [config] mini-batch: 64
[2023-07-17 13:52:00] [config] mini-batch-fit: true
[2023-07-17 13:52:00] [config] mini-batch-fit-step: 10
[2023-07-17 13:52:00] [config] mini-batch-round-up: true
[2023-07-17 13:52:00] [config] mini-batch-track-lr: false
[2023-07-17 13:52:00] [config] mini-batch-warmup: 0
[2023-07-17 13:52:00] [config] mini-batch-words: 0
[2023-07-17 13:52:00] [config] mini-batch-words-ref: 0
[2023-07-17 13:52:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:52:00] [config] multi-loss-type: sum
[2023-07-17 13:52:00] [config] n-best: false
[2023-07-17 13:52:00] [config] no-nccl: false
[2023-07-17 13:52:00] [config] no-reload: false
[2023-07-17 13:52:00] [config] no-restore-corpus: false
[2023-07-17 13:52:00] [config] normalize: 0
[2023-07-17 13:52:00] [config] normalize-gradient: false
[2023-07-17 13:52:00] [config] num-devices: 0
[2023-07-17 13:52:00] [config] optimizer: adam
[2023-07-17 13:52:00] [config] optimizer-delay: 1
[2023-07-17 13:52:00] [config] optimizer-params:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] output-omit-bias: false
[2023-07-17 13:52:00] [config] overwrite: true
[2023-07-17 13:52:00] [config] precision:
[2023-07-17 13:52:00] [config]   - float16
[2023-07-17 13:52:00] [config]   - float32
[2023-07-17 13:52:00] [config] pretrained-model: ""
[2023-07-17 13:52:00] [config] quantize-biases: false
[2023-07-17 13:52:00] [config] quantize-bits: 0
[2023-07-17 13:52:00] [config] quantize-log-based: false
[2023-07-17 13:52:00] [config] quantize-optimization-steps: 0
[2023-07-17 13:52:00] [config] quiet: false
[2023-07-17 13:52:00] [config] quiet-translation: true
[2023-07-17 13:52:00] [config] relative-paths: false
[2023-07-17 13:52:00] [config] right-left: false
[2023-07-17 13:52:00] [config] save-freq: 10000u
[2023-07-17 13:52:00] [config] seed: 1234
[2023-07-17 13:52:00] [config] sentencepiece-alphas:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:52:00] [config] sentencepiece-options: ""
[2023-07-17 13:52:00] [config] sharding: global
[2023-07-17 13:52:00] [config] shuffle: data
[2023-07-17 13:52:00] [config] shuffle-in-ram: false
[2023-07-17 13:52:00] [config] sigterm: save-and-exit
[2023-07-17 13:52:00] [config] skip: false
[2023-07-17 13:52:00] [config] sqlite: ""
[2023-07-17 13:52:00] [config] sqlite-drop: false
[2023-07-17 13:52:00] [config] sync-freq: 200u
[2023-07-17 13:52:00] [config] sync-sgd: false
[2023-07-17 13:52:00] [config] tempdir: /tmp
[2023-07-17 13:52:00] [config] tied-embeddings: false
[2023-07-17 13:52:00] [config] tied-embeddings-all: true
[2023-07-17 13:52:00] [config] tied-embeddings-src: false
[2023-07-17 13:52:00] [config] train-embedder-rank:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] train-sets:
[2023-07-17 13:52:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:52:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:52:00] [config] transformer-aan-activation: swish
[2023-07-17 13:52:00] [config] transformer-aan-depth: 2
[2023-07-17 13:52:00] [config] transformer-aan-nogate: false
[2023-07-17 13:52:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:52:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:52:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:52:00] [config] transformer-depth-scaling: false
[2023-07-17 13:52:00] [config] transformer-dim-aan: 2048
[2023-07-17 13:52:00] [config] transformer-dim-ffn: 2048
[2023-07-17 13:52:00] [config] transformer-dropout: 0
[2023-07-17 13:52:00] [config] transformer-dropout-attention: 0
[2023-07-17 13:52:00] [config] transformer-dropout-ffn: 0
[2023-07-17 13:52:00] [config] transformer-ffn-activation: swish
[2023-07-17 13:52:00] [config] transformer-ffn-depth: 2
[2023-07-17 13:52:00] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:52:00] [config] transformer-heads: 8
[2023-07-17 13:52:00] [config] transformer-no-projection: false
[2023-07-17 13:52:00] [config] transformer-pool: false
[2023-07-17 13:52:00] [config] transformer-postprocess: dan
[2023-07-17 13:52:00] [config] transformer-postprocess-emb: d
[2023-07-17 13:52:00] [config] transformer-postprocess-top: ""
[2023-07-17 13:52:00] [config] transformer-preprocess: ""
[2023-07-17 13:52:00] [config] transformer-tied-layers:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] transformer-train-position-embeddings: false
[2023-07-17 13:52:00] [config] tsv: false
[2023-07-17 13:52:00] [config] tsv-fields: 0
[2023-07-17 13:52:00] [config] type: amun
[2023-07-17 13:52:00] [config] ulr: false
[2023-07-17 13:52:00] [config] ulr-dim-emb: 0
[2023-07-17 13:52:00] [config] ulr-dropout: 0
[2023-07-17 13:52:00] [config] ulr-keys-vectors: ""
[2023-07-17 13:52:00] [config] ulr-query-vectors: ""
[2023-07-17 13:52:00] [config] ulr-softmax-temperature: 1
[2023-07-17 13:52:00] [config] ulr-trainable-transformation: false
[2023-07-17 13:52:00] [config] unlikelihood-loss: false
[2023-07-17 13:52:00] [config] valid-freq: 50000000
[2023-07-17 13:52:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:00] [config] valid-max-length: 1000
[2023-07-17 13:52:00] [config] valid-metrics:
[2023-07-17 13:52:00] [config]   - cross-entropy
[2023-07-17 13:52:00] [config]   - translation
[2023-07-17 13:52:00] [config] valid-mini-batch: 32
[2023-07-17 13:52:00] [config] valid-reset-stalled: false
[2023-07-17 13:52:00] [config] valid-script-args:
[2023-07-17 13:52:00] [config]   []
[2023-07-17 13:52:00] [config] valid-script-path: ""
[2023-07-17 13:52:00] [config] valid-sets:
[2023-07-17 13:52:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:52:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:52:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:52:00] [config] vocabs:
[2023-07-17 13:52:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:00] [config] word-penalty: 0
[2023-07-17 13:52:00] [config] word-scores: false
[2023-07-17 13:52:00] [config] workspace: 5500
[2023-07-17 13:52:00] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:00] [training] Using single-device training
[2023-07-17 13:52:01] Synced seed 1234
[2023-07-17 13:52:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:52:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:01] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:52:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:52:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:52:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:52:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:52:02] [comm] Using global sharding
[2023-07-17 13:52:02] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:52:02] [training] Using 1 GPUs
[2023-07-17 13:52:02] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:52:02] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55ee79f2ef01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55ee7a6c41fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55ee7a6c4d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55ee7a6c5785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55ee7a342f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55ee7a3c8d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55ee7a3b577c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55ee79e8681d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55ee7a462306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55ee7a43ef2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55ee79f40450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55ee79e622c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55ee79e19b9c]    main                                               + 0x3c
[0x7f75dd5350b3]    __libc_start_main                                  + 0xf3
[0x55ee79e60cbe]    _start                                             + 0x2e

[2023-07-17 13:52:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:03] [marian] Running on node22.datos.cluster.uy as process 8349 with command line:
[2023-07-17 13:52:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:52:03] [config] after: 0e
[2023-07-17 13:52:03] [config] after-batches: 0
[2023-07-17 13:52:03] [config] after-epochs: 60
[2023-07-17 13:52:03] [config] all-caps-every: 0
[2023-07-17 13:52:03] [config] allow-unk: false
[2023-07-17 13:52:03] [config] authors: false
[2023-07-17 13:52:03] [config] beam-size: 12
[2023-07-17 13:52:03] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:52:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:52:03] [config] bert-masking-fraction: 0.15
[2023-07-17 13:52:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:52:03] [config] bert-train-type-embeddings: true
[2023-07-17 13:52:03] [config] bert-type-vocab-size: 2
[2023-07-17 13:52:03] [config] build-info: ""
[2023-07-17 13:52:03] [config] check-gradient-nan: false
[2023-07-17 13:52:03] [config] check-nan: false
[2023-07-17 13:52:03] [config] cite: false
[2023-07-17 13:52:03] [config] clip-norm: 1
[2023-07-17 13:52:03] [config] cost-scaling:
[2023-07-17 13:52:03] [config]   - 256.f
[2023-07-17 13:52:03] [config]   - 1000
[2023-07-17 13:52:03] [config]   - 2.f
[2023-07-17 13:52:03] [config]   - 256.f
[2023-07-17 13:52:03] [config] cost-type: ce-sum
[2023-07-17 13:52:03] [config] cpu-threads: 0
[2023-07-17 13:52:03] [config] data-threads: 8
[2023-07-17 13:52:03] [config] data-weighting: ""
[2023-07-17 13:52:03] [config] data-weighting-type: sentence
[2023-07-17 13:52:03] [config] dec-cell: gru
[2023-07-17 13:52:03] [config] dec-cell-base-depth: 2
[2023-07-17 13:52:03] [config] dec-cell-high-depth: 1
[2023-07-17 13:52:03] [config] dec-depth: 1
[2023-07-17 13:52:03] [config] devices:
[2023-07-17 13:52:03] [config]   - 0
[2023-07-17 13:52:03] [config] dim-emb: 512
[2023-07-17 13:52:03] [config] dim-rnn: 1024
[2023-07-17 13:52:03] [config] dim-vocabs:
[2023-07-17 13:52:03] [config]   - 16384
[2023-07-17 13:52:03] [config]   - 16384
[2023-07-17 13:52:03] [config] disp-first: 0
[2023-07-17 13:52:03] [config] disp-freq: 1000u
[2023-07-17 13:52:03] [config] disp-label-counts: true
[2023-07-17 13:52:03] [config] dropout-rnn: 0
[2023-07-17 13:52:03] [config] dropout-src: 0
[2023-07-17 13:52:03] [config] dropout-trg: 0
[2023-07-17 13:52:03] [config] dump-config: ""
[2023-07-17 13:52:03] [config] dynamic-gradient-scaling:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] early-stopping: 5
[2023-07-17 13:52:03] [config] early-stopping-on: first
[2023-07-17 13:52:03] [config] embedding-fix-src: false
[2023-07-17 13:52:03] [config] embedding-fix-trg: false
[2023-07-17 13:52:03] [config] embedding-normalization: false
[2023-07-17 13:52:03] [config] embedding-vectors:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] enc-cell: gru
[2023-07-17 13:52:03] [config] enc-cell-depth: 1
[2023-07-17 13:52:03] [config] enc-depth: 1
[2023-07-17 13:52:03] [config] enc-type: bidirectional
[2023-07-17 13:52:03] [config] english-title-case-every: 0
[2023-07-17 13:52:03] [config] exponential-smoothing: 0
[2023-07-17 13:52:03] [config] factor-weight: 1
[2023-07-17 13:52:03] [config] factors-combine: sum
[2023-07-17 13:52:03] [config] factors-dim-emb: 0
[2023-07-17 13:52:03] [config] gradient-checkpointing: false
[2023-07-17 13:52:03] [config] gradient-norm-average-window: 100
[2023-07-17 13:52:03] [config] guided-alignment: none
[2023-07-17 13:52:03] [config] guided-alignment-cost: mse
[2023-07-17 13:52:03] [config] guided-alignment-weight: 0.1
[2023-07-17 13:52:03] [config] ignore-model-config: false
[2023-07-17 13:52:03] [config] input-types:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] interpolate-env-vars: false
[2023-07-17 13:52:03] [config] keep-best: false
[2023-07-17 13:52:03] [config] label-smoothing: 0
[2023-07-17 13:52:03] [config] layer-normalization: false
[2023-07-17 13:52:03] [config] learn-rate: 0.0001
[2023-07-17 13:52:03] [config] lemma-dependency: ""
[2023-07-17 13:52:03] [config] lemma-dim-emb: 0
[2023-07-17 13:52:03] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:03] [config] log-level: info
[2023-07-17 13:52:03] [config] log-time-zone: ""
[2023-07-17 13:52:03] [config] logical-epoch:
[2023-07-17 13:52:03] [config]   - 1e
[2023-07-17 13:52:03] [config]   - 0
[2023-07-17 13:52:03] [config] lr-decay: 0
[2023-07-17 13:52:03] [config] lr-decay-freq: 50000
[2023-07-17 13:52:03] [config] lr-decay-inv-sqrt:
[2023-07-17 13:52:03] [config]   - 0
[2023-07-17 13:52:03] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:52:03] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:52:03] [config] lr-decay-start:
[2023-07-17 13:52:03] [config]   - 10
[2023-07-17 13:52:03] [config]   - 1
[2023-07-17 13:52:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:52:03] [config] lr-report: false
[2023-07-17 13:52:03] [config] lr-warmup: 0
[2023-07-17 13:52:03] [config] lr-warmup-at-reload: false
[2023-07-17 13:52:03] [config] lr-warmup-cycle: false
[2023-07-17 13:52:03] [config] lr-warmup-start-rate: 0
[2023-07-17 13:52:03] [config] max-length: 200
[2023-07-17 13:52:03] [config] max-length-crop: true
[2023-07-17 13:52:03] [config] max-length-factor: 3
[2023-07-17 13:52:03] [config] maxi-batch: 100
[2023-07-17 13:52:03] [config] maxi-batch-sort: trg
[2023-07-17 13:52:03] [config] mini-batch: 64
[2023-07-17 13:52:03] [config] mini-batch-fit: true
[2023-07-17 13:52:03] [config] mini-batch-fit-step: 10
[2023-07-17 13:52:03] [config] mini-batch-round-up: true
[2023-07-17 13:52:03] [config] mini-batch-track-lr: false
[2023-07-17 13:52:03] [config] mini-batch-warmup: 0
[2023-07-17 13:52:03] [config] mini-batch-words: 0
[2023-07-17 13:52:03] [config] mini-batch-words-ref: 0
[2023-07-17 13:52:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:52:03] [config] multi-loss-type: sum
[2023-07-17 13:52:03] [config] n-best: false
[2023-07-17 13:52:03] [config] no-nccl: false
[2023-07-17 13:52:03] [config] no-reload: false
[2023-07-17 13:52:03] [config] no-restore-corpus: false
[2023-07-17 13:52:03] [config] normalize: 0
[2023-07-17 13:52:03] [config] normalize-gradient: false
[2023-07-17 13:52:03] [config] num-devices: 0
[2023-07-17 13:52:03] [config] optimizer: adam
[2023-07-17 13:52:03] [config] optimizer-delay: 1
[2023-07-17 13:52:03] [config] optimizer-params:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] output-omit-bias: false
[2023-07-17 13:52:03] [config] overwrite: true
[2023-07-17 13:52:03] [config] precision:
[2023-07-17 13:52:03] [config]   - float16
[2023-07-17 13:52:03] [config]   - float32
[2023-07-17 13:52:03] [config] pretrained-model: ""
[2023-07-17 13:52:03] [config] quantize-biases: false
[2023-07-17 13:52:03] [config] quantize-bits: 0
[2023-07-17 13:52:03] [config] quantize-log-based: false
[2023-07-17 13:52:03] [config] quantize-optimization-steps: 0
[2023-07-17 13:52:03] [config] quiet: false
[2023-07-17 13:52:03] [config] quiet-translation: true
[2023-07-17 13:52:03] [config] relative-paths: false
[2023-07-17 13:52:03] [config] right-left: false
[2023-07-17 13:52:03] [config] save-freq: 10000u
[2023-07-17 13:52:03] [config] seed: 1234
[2023-07-17 13:52:03] [config] sentencepiece-alphas:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:52:03] [config] sentencepiece-options: ""
[2023-07-17 13:52:03] [config] sharding: global
[2023-07-17 13:52:03] [config] shuffle: data
[2023-07-17 13:52:03] [config] shuffle-in-ram: false
[2023-07-17 13:52:03] [config] sigterm: save-and-exit
[2023-07-17 13:52:03] [config] skip: false
[2023-07-17 13:52:03] [config] sqlite: ""
[2023-07-17 13:52:03] [config] sqlite-drop: false
[2023-07-17 13:52:03] [config] sync-freq: 200u
[2023-07-17 13:52:03] [config] sync-sgd: false
[2023-07-17 13:52:03] [config] tempdir: /tmp
[2023-07-17 13:52:03] [config] tied-embeddings: false
[2023-07-17 13:52:03] [config] tied-embeddings-all: true
[2023-07-17 13:52:03] [config] tied-embeddings-src: false
[2023-07-17 13:52:03] [config] train-embedder-rank:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] train-sets:
[2023-07-17 13:52:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:52:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:52:03] [config] transformer-aan-activation: swish
[2023-07-17 13:52:03] [config] transformer-aan-depth: 2
[2023-07-17 13:52:03] [config] transformer-aan-nogate: false
[2023-07-17 13:52:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:52:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:52:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:52:03] [config] transformer-depth-scaling: false
[2023-07-17 13:52:03] [config] transformer-dim-aan: 2048
[2023-07-17 13:52:03] [config] transformer-dim-ffn: 2048
[2023-07-17 13:52:03] [config] transformer-dropout: 0
[2023-07-17 13:52:03] [config] transformer-dropout-attention: 0
[2023-07-17 13:52:03] [config] transformer-dropout-ffn: 0
[2023-07-17 13:52:03] [config] transformer-ffn-activation: swish
[2023-07-17 13:52:03] [config] transformer-ffn-depth: 2
[2023-07-17 13:52:03] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:52:03] [config] transformer-heads: 8
[2023-07-17 13:52:03] [config] transformer-no-projection: false
[2023-07-17 13:52:03] [config] transformer-pool: false
[2023-07-17 13:52:03] [config] transformer-postprocess: dan
[2023-07-17 13:52:03] [config] transformer-postprocess-emb: d
[2023-07-17 13:52:03] [config] transformer-postprocess-top: ""
[2023-07-17 13:52:03] [config] transformer-preprocess: ""
[2023-07-17 13:52:03] [config] transformer-tied-layers:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] transformer-train-position-embeddings: false
[2023-07-17 13:52:03] [config] tsv: false
[2023-07-17 13:52:03] [config] tsv-fields: 0
[2023-07-17 13:52:03] [config] type: amun
[2023-07-17 13:52:03] [config] ulr: false
[2023-07-17 13:52:03] [config] ulr-dim-emb: 0
[2023-07-17 13:52:03] [config] ulr-dropout: 0
[2023-07-17 13:52:03] [config] ulr-keys-vectors: ""
[2023-07-17 13:52:03] [config] ulr-query-vectors: ""
[2023-07-17 13:52:03] [config] ulr-softmax-temperature: 1
[2023-07-17 13:52:03] [config] ulr-trainable-transformation: false
[2023-07-17 13:52:03] [config] unlikelihood-loss: false
[2023-07-17 13:52:03] [config] valid-freq: 50000000
[2023-07-17 13:52:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:03] [config] valid-max-length: 1000
[2023-07-17 13:52:03] [config] valid-metrics:
[2023-07-17 13:52:03] [config]   - cross-entropy
[2023-07-17 13:52:03] [config]   - translation
[2023-07-17 13:52:03] [config] valid-mini-batch: 32
[2023-07-17 13:52:03] [config] valid-reset-stalled: false
[2023-07-17 13:52:03] [config] valid-script-args:
[2023-07-17 13:52:03] [config]   []
[2023-07-17 13:52:03] [config] valid-script-path: ""
[2023-07-17 13:52:03] [config] valid-sets:
[2023-07-17 13:52:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:52:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:52:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:52:03] [config] vocabs:
[2023-07-17 13:52:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:03] [config] word-penalty: 0
[2023-07-17 13:52:03] [config] word-scores: false
[2023-07-17 13:52:03] [config] workspace: 5500
[2023-07-17 13:52:03] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:03] [training] Using single-device training
[2023-07-17 13:52:03] Synced seed 1234
[2023-07-17 13:52:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:52:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:03] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:52:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:52:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:52:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:52:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:52:05] [comm] Using global sharding
[2023-07-17 13:52:05] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:52:05] [training] Using 1 GPUs
[2023-07-17 13:52:05] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:52:05] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x564d31d6cf01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x564d325021fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x564d32502d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x564d32503785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x564d32180f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x564d32206d5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x564d321f377c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x564d31cc481d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x564d322a0306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x564d3227cf2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x564d31d7e450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x564d31ca02c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x564d31c57b9c]    main                                               + 0x3c
[0x7f33ceeb80b3]    __libc_start_main                                  + 0xf3
[0x564d31c9ecbe]    _start                                             + 0x2e

[2023-07-17 13:52:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:06] [marian] Running on node22.datos.cluster.uy as process 8379 with command line:
[2023-07-17 13:52:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:52:06] [config] after: 0e
[2023-07-17 13:52:06] [config] after-batches: 0
[2023-07-17 13:52:06] [config] after-epochs: 70
[2023-07-17 13:52:06] [config] all-caps-every: 0
[2023-07-17 13:52:06] [config] allow-unk: false
[2023-07-17 13:52:06] [config] authors: false
[2023-07-17 13:52:06] [config] beam-size: 12
[2023-07-17 13:52:06] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:52:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:52:06] [config] bert-masking-fraction: 0.15
[2023-07-17 13:52:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:52:06] [config] bert-train-type-embeddings: true
[2023-07-17 13:52:06] [config] bert-type-vocab-size: 2
[2023-07-17 13:52:06] [config] build-info: ""
[2023-07-17 13:52:06] [config] check-gradient-nan: false
[2023-07-17 13:52:06] [config] check-nan: false
[2023-07-17 13:52:06] [config] cite: false
[2023-07-17 13:52:06] [config] clip-norm: 1
[2023-07-17 13:52:06] [config] cost-scaling:
[2023-07-17 13:52:06] [config]   - 256.f
[2023-07-17 13:52:06] [config]   - 1000
[2023-07-17 13:52:06] [config]   - 2.f
[2023-07-17 13:52:06] [config]   - 256.f
[2023-07-17 13:52:06] [config] cost-type: ce-sum
[2023-07-17 13:52:06] [config] cpu-threads: 0
[2023-07-17 13:52:06] [config] data-threads: 8
[2023-07-17 13:52:06] [config] data-weighting: ""
[2023-07-17 13:52:06] [config] data-weighting-type: sentence
[2023-07-17 13:52:06] [config] dec-cell: gru
[2023-07-17 13:52:06] [config] dec-cell-base-depth: 2
[2023-07-17 13:52:06] [config] dec-cell-high-depth: 1
[2023-07-17 13:52:06] [config] dec-depth: 1
[2023-07-17 13:52:06] [config] devices:
[2023-07-17 13:52:06] [config]   - 0
[2023-07-17 13:52:06] [config] dim-emb: 512
[2023-07-17 13:52:06] [config] dim-rnn: 1024
[2023-07-17 13:52:06] [config] dim-vocabs:
[2023-07-17 13:52:06] [config]   - 16384
[2023-07-17 13:52:06] [config]   - 16384
[2023-07-17 13:52:06] [config] disp-first: 0
[2023-07-17 13:52:06] [config] disp-freq: 1000u
[2023-07-17 13:52:06] [config] disp-label-counts: true
[2023-07-17 13:52:06] [config] dropout-rnn: 0
[2023-07-17 13:52:06] [config] dropout-src: 0
[2023-07-17 13:52:06] [config] dropout-trg: 0
[2023-07-17 13:52:06] [config] dump-config: ""
[2023-07-17 13:52:06] [config] dynamic-gradient-scaling:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] early-stopping: 5
[2023-07-17 13:52:06] [config] early-stopping-on: first
[2023-07-17 13:52:06] [config] embedding-fix-src: false
[2023-07-17 13:52:06] [config] embedding-fix-trg: false
[2023-07-17 13:52:06] [config] embedding-normalization: false
[2023-07-17 13:52:06] [config] embedding-vectors:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] enc-cell: gru
[2023-07-17 13:52:06] [config] enc-cell-depth: 1
[2023-07-17 13:52:06] [config] enc-depth: 1
[2023-07-17 13:52:06] [config] enc-type: bidirectional
[2023-07-17 13:52:06] [config] english-title-case-every: 0
[2023-07-17 13:52:06] [config] exponential-smoothing: 0
[2023-07-17 13:52:06] [config] factor-weight: 1
[2023-07-17 13:52:06] [config] factors-combine: sum
[2023-07-17 13:52:06] [config] factors-dim-emb: 0
[2023-07-17 13:52:06] [config] gradient-checkpointing: false
[2023-07-17 13:52:06] [config] gradient-norm-average-window: 100
[2023-07-17 13:52:06] [config] guided-alignment: none
[2023-07-17 13:52:06] [config] guided-alignment-cost: mse
[2023-07-17 13:52:06] [config] guided-alignment-weight: 0.1
[2023-07-17 13:52:06] [config] ignore-model-config: false
[2023-07-17 13:52:06] [config] input-types:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] interpolate-env-vars: false
[2023-07-17 13:52:06] [config] keep-best: false
[2023-07-17 13:52:06] [config] label-smoothing: 0
[2023-07-17 13:52:06] [config] layer-normalization: false
[2023-07-17 13:52:06] [config] learn-rate: 0.0001
[2023-07-17 13:52:06] [config] lemma-dependency: ""
[2023-07-17 13:52:06] [config] lemma-dim-emb: 0
[2023-07-17 13:52:06] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:06] [config] log-level: info
[2023-07-17 13:52:06] [config] log-time-zone: ""
[2023-07-17 13:52:06] [config] logical-epoch:
[2023-07-17 13:52:06] [config]   - 1e
[2023-07-17 13:52:06] [config]   - 0
[2023-07-17 13:52:06] [config] lr-decay: 0
[2023-07-17 13:52:06] [config] lr-decay-freq: 50000
[2023-07-17 13:52:06] [config] lr-decay-inv-sqrt:
[2023-07-17 13:52:06] [config]   - 0
[2023-07-17 13:52:06] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:52:06] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:52:06] [config] lr-decay-start:
[2023-07-17 13:52:06] [config]   - 10
[2023-07-17 13:52:06] [config]   - 1
[2023-07-17 13:52:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:52:06] [config] lr-report: false
[2023-07-17 13:52:06] [config] lr-warmup: 0
[2023-07-17 13:52:06] [config] lr-warmup-at-reload: false
[2023-07-17 13:52:06] [config] lr-warmup-cycle: false
[2023-07-17 13:52:06] [config] lr-warmup-start-rate: 0
[2023-07-17 13:52:06] [config] max-length: 200
[2023-07-17 13:52:06] [config] max-length-crop: true
[2023-07-17 13:52:06] [config] max-length-factor: 3
[2023-07-17 13:52:06] [config] maxi-batch: 100
[2023-07-17 13:52:06] [config] maxi-batch-sort: trg
[2023-07-17 13:52:06] [config] mini-batch: 64
[2023-07-17 13:52:06] [config] mini-batch-fit: true
[2023-07-17 13:52:06] [config] mini-batch-fit-step: 10
[2023-07-17 13:52:06] [config] mini-batch-round-up: true
[2023-07-17 13:52:06] [config] mini-batch-track-lr: false
[2023-07-17 13:52:06] [config] mini-batch-warmup: 0
[2023-07-17 13:52:06] [config] mini-batch-words: 0
[2023-07-17 13:52:06] [config] mini-batch-words-ref: 0
[2023-07-17 13:52:06] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:52:06] [config] multi-loss-type: sum
[2023-07-17 13:52:06] [config] n-best: false
[2023-07-17 13:52:06] [config] no-nccl: false
[2023-07-17 13:52:06] [config] no-reload: false
[2023-07-17 13:52:06] [config] no-restore-corpus: false
[2023-07-17 13:52:06] [config] normalize: 0
[2023-07-17 13:52:06] [config] normalize-gradient: false
[2023-07-17 13:52:06] [config] num-devices: 0
[2023-07-17 13:52:06] [config] optimizer: adam
[2023-07-17 13:52:06] [config] optimizer-delay: 1
[2023-07-17 13:52:06] [config] optimizer-params:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] output-omit-bias: false
[2023-07-17 13:52:06] [config] overwrite: true
[2023-07-17 13:52:06] [config] precision:
[2023-07-17 13:52:06] [config]   - float16
[2023-07-17 13:52:06] [config]   - float32
[2023-07-17 13:52:06] [config] pretrained-model: ""
[2023-07-17 13:52:06] [config] quantize-biases: false
[2023-07-17 13:52:06] [config] quantize-bits: 0
[2023-07-17 13:52:06] [config] quantize-log-based: false
[2023-07-17 13:52:06] [config] quantize-optimization-steps: 0
[2023-07-17 13:52:06] [config] quiet: false
[2023-07-17 13:52:06] [config] quiet-translation: true
[2023-07-17 13:52:06] [config] relative-paths: false
[2023-07-17 13:52:06] [config] right-left: false
[2023-07-17 13:52:06] [config] save-freq: 10000u
[2023-07-17 13:52:06] [config] seed: 1234
[2023-07-17 13:52:06] [config] sentencepiece-alphas:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:52:06] [config] sentencepiece-options: ""
[2023-07-17 13:52:06] [config] sharding: global
[2023-07-17 13:52:06] [config] shuffle: data
[2023-07-17 13:52:06] [config] shuffle-in-ram: false
[2023-07-17 13:52:06] [config] sigterm: save-and-exit
[2023-07-17 13:52:06] [config] skip: false
[2023-07-17 13:52:06] [config] sqlite: ""
[2023-07-17 13:52:06] [config] sqlite-drop: false
[2023-07-17 13:52:06] [config] sync-freq: 200u
[2023-07-17 13:52:06] [config] sync-sgd: false
[2023-07-17 13:52:06] [config] tempdir: /tmp
[2023-07-17 13:52:06] [config] tied-embeddings: false
[2023-07-17 13:52:06] [config] tied-embeddings-all: true
[2023-07-17 13:52:06] [config] tied-embeddings-src: false
[2023-07-17 13:52:06] [config] train-embedder-rank:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] train-sets:
[2023-07-17 13:52:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:52:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:52:06] [config] transformer-aan-activation: swish
[2023-07-17 13:52:06] [config] transformer-aan-depth: 2
[2023-07-17 13:52:06] [config] transformer-aan-nogate: false
[2023-07-17 13:52:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:52:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:52:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:52:06] [config] transformer-depth-scaling: false
[2023-07-17 13:52:06] [config] transformer-dim-aan: 2048
[2023-07-17 13:52:06] [config] transformer-dim-ffn: 2048
[2023-07-17 13:52:06] [config] transformer-dropout: 0
[2023-07-17 13:52:06] [config] transformer-dropout-attention: 0
[2023-07-17 13:52:06] [config] transformer-dropout-ffn: 0
[2023-07-17 13:52:06] [config] transformer-ffn-activation: swish
[2023-07-17 13:52:06] [config] transformer-ffn-depth: 2
[2023-07-17 13:52:06] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:52:06] [config] transformer-heads: 8
[2023-07-17 13:52:06] [config] transformer-no-projection: false
[2023-07-17 13:52:06] [config] transformer-pool: false
[2023-07-17 13:52:06] [config] transformer-postprocess: dan
[2023-07-17 13:52:06] [config] transformer-postprocess-emb: d
[2023-07-17 13:52:06] [config] transformer-postprocess-top: ""
[2023-07-17 13:52:06] [config] transformer-preprocess: ""
[2023-07-17 13:52:06] [config] transformer-tied-layers:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] transformer-train-position-embeddings: false
[2023-07-17 13:52:06] [config] tsv: false
[2023-07-17 13:52:06] [config] tsv-fields: 0
[2023-07-17 13:52:06] [config] type: amun
[2023-07-17 13:52:06] [config] ulr: false
[2023-07-17 13:52:06] [config] ulr-dim-emb: 0
[2023-07-17 13:52:06] [config] ulr-dropout: 0
[2023-07-17 13:52:06] [config] ulr-keys-vectors: ""
[2023-07-17 13:52:06] [config] ulr-query-vectors: ""
[2023-07-17 13:52:06] [config] ulr-softmax-temperature: 1
[2023-07-17 13:52:06] [config] ulr-trainable-transformation: false
[2023-07-17 13:52:06] [config] unlikelihood-loss: false
[2023-07-17 13:52:06] [config] valid-freq: 50000000
[2023-07-17 13:52:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:06] [config] valid-max-length: 1000
[2023-07-17 13:52:06] [config] valid-metrics:
[2023-07-17 13:52:06] [config]   - cross-entropy
[2023-07-17 13:52:06] [config]   - translation
[2023-07-17 13:52:06] [config] valid-mini-batch: 32
[2023-07-17 13:52:06] [config] valid-reset-stalled: false
[2023-07-17 13:52:06] [config] valid-script-args:
[2023-07-17 13:52:06] [config]   []
[2023-07-17 13:52:06] [config] valid-script-path: ""
[2023-07-17 13:52:06] [config] valid-sets:
[2023-07-17 13:52:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:52:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:52:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:52:06] [config] vocabs:
[2023-07-17 13:52:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:06] [config] word-penalty: 0
[2023-07-17 13:52:06] [config] word-scores: false
[2023-07-17 13:52:06] [config] workspace: 5500
[2023-07-17 13:52:06] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:06] [training] Using single-device training
[2023-07-17 13:52:06] Synced seed 1234
[2023-07-17 13:52:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:52:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:06] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:52:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:52:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:52:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:52:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:52:07] [comm] Using global sharding
[2023-07-17 13:52:08] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:52:08] [training] Using 1 GPUs
[2023-07-17 13:52:08] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:52:08] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x563846d10f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x5638474a61fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x5638474a6d6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x5638474a7785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x563847124f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x5638471aad5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x56384719777c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x563846c6881d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x563847244306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x563847220f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x563846d22450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x563846c442c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563846bfbb9c]    main                                               + 0x3c
[0x7f1d1a41f0b3]    __libc_start_main                                  + 0xf3
[0x563846c42cbe]    _start                                             + 0x2e

[2023-07-17 13:52:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:09] [marian] Running on node22.datos.cluster.uy as process 8410 with command line:
[2023-07-17 13:52:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:52:09] [config] after: 0e
[2023-07-17 13:52:09] [config] after-batches: 0
[2023-07-17 13:52:09] [config] after-epochs: 80
[2023-07-17 13:52:09] [config] all-caps-every: 0
[2023-07-17 13:52:09] [config] allow-unk: false
[2023-07-17 13:52:09] [config] authors: false
[2023-07-17 13:52:09] [config] beam-size: 12
[2023-07-17 13:52:09] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:52:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:52:09] [config] bert-masking-fraction: 0.15
[2023-07-17 13:52:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:52:09] [config] bert-train-type-embeddings: true
[2023-07-17 13:52:09] [config] bert-type-vocab-size: 2
[2023-07-17 13:52:09] [config] build-info: ""
[2023-07-17 13:52:09] [config] check-gradient-nan: false
[2023-07-17 13:52:09] [config] check-nan: false
[2023-07-17 13:52:09] [config] cite: false
[2023-07-17 13:52:09] [config] clip-norm: 1
[2023-07-17 13:52:09] [config] cost-scaling:
[2023-07-17 13:52:09] [config]   - 256.f
[2023-07-17 13:52:09] [config]   - 1000
[2023-07-17 13:52:09] [config]   - 2.f
[2023-07-17 13:52:09] [config]   - 256.f
[2023-07-17 13:52:09] [config] cost-type: ce-sum
[2023-07-17 13:52:09] [config] cpu-threads: 0
[2023-07-17 13:52:09] [config] data-threads: 8
[2023-07-17 13:52:09] [config] data-weighting: ""
[2023-07-17 13:52:09] [config] data-weighting-type: sentence
[2023-07-17 13:52:09] [config] dec-cell: gru
[2023-07-17 13:52:09] [config] dec-cell-base-depth: 2
[2023-07-17 13:52:09] [config] dec-cell-high-depth: 1
[2023-07-17 13:52:09] [config] dec-depth: 1
[2023-07-17 13:52:09] [config] devices:
[2023-07-17 13:52:09] [config]   - 0
[2023-07-17 13:52:09] [config] dim-emb: 512
[2023-07-17 13:52:09] [config] dim-rnn: 1024
[2023-07-17 13:52:09] [config] dim-vocabs:
[2023-07-17 13:52:09] [config]   - 16384
[2023-07-17 13:52:09] [config]   - 16384
[2023-07-17 13:52:09] [config] disp-first: 0
[2023-07-17 13:52:09] [config] disp-freq: 1000u
[2023-07-17 13:52:09] [config] disp-label-counts: true
[2023-07-17 13:52:09] [config] dropout-rnn: 0
[2023-07-17 13:52:09] [config] dropout-src: 0
[2023-07-17 13:52:09] [config] dropout-trg: 0
[2023-07-17 13:52:09] [config] dump-config: ""
[2023-07-17 13:52:09] [config] dynamic-gradient-scaling:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] early-stopping: 5
[2023-07-17 13:52:09] [config] early-stopping-on: first
[2023-07-17 13:52:09] [config] embedding-fix-src: false
[2023-07-17 13:52:09] [config] embedding-fix-trg: false
[2023-07-17 13:52:09] [config] embedding-normalization: false
[2023-07-17 13:52:09] [config] embedding-vectors:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] enc-cell: gru
[2023-07-17 13:52:09] [config] enc-cell-depth: 1
[2023-07-17 13:52:09] [config] enc-depth: 1
[2023-07-17 13:52:09] [config] enc-type: bidirectional
[2023-07-17 13:52:09] [config] english-title-case-every: 0
[2023-07-17 13:52:09] [config] exponential-smoothing: 0
[2023-07-17 13:52:09] [config] factor-weight: 1
[2023-07-17 13:52:09] [config] factors-combine: sum
[2023-07-17 13:52:09] [config] factors-dim-emb: 0
[2023-07-17 13:52:09] [config] gradient-checkpointing: false
[2023-07-17 13:52:09] [config] gradient-norm-average-window: 100
[2023-07-17 13:52:09] [config] guided-alignment: none
[2023-07-17 13:52:09] [config] guided-alignment-cost: mse
[2023-07-17 13:52:09] [config] guided-alignment-weight: 0.1
[2023-07-17 13:52:09] [config] ignore-model-config: false
[2023-07-17 13:52:09] [config] input-types:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] interpolate-env-vars: false
[2023-07-17 13:52:09] [config] keep-best: false
[2023-07-17 13:52:09] [config] label-smoothing: 0
[2023-07-17 13:52:09] [config] layer-normalization: false
[2023-07-17 13:52:09] [config] learn-rate: 0.0001
[2023-07-17 13:52:09] [config] lemma-dependency: ""
[2023-07-17 13:52:09] [config] lemma-dim-emb: 0
[2023-07-17 13:52:09] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:09] [config] log-level: info
[2023-07-17 13:52:09] [config] log-time-zone: ""
[2023-07-17 13:52:09] [config] logical-epoch:
[2023-07-17 13:52:09] [config]   - 1e
[2023-07-17 13:52:09] [config]   - 0
[2023-07-17 13:52:09] [config] lr-decay: 0
[2023-07-17 13:52:09] [config] lr-decay-freq: 50000
[2023-07-17 13:52:09] [config] lr-decay-inv-sqrt:
[2023-07-17 13:52:09] [config]   - 0
[2023-07-17 13:52:09] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:52:09] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:52:09] [config] lr-decay-start:
[2023-07-17 13:52:09] [config]   - 10
[2023-07-17 13:52:09] [config]   - 1
[2023-07-17 13:52:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:52:09] [config] lr-report: false
[2023-07-17 13:52:09] [config] lr-warmup: 0
[2023-07-17 13:52:09] [config] lr-warmup-at-reload: false
[2023-07-17 13:52:09] [config] lr-warmup-cycle: false
[2023-07-17 13:52:09] [config] lr-warmup-start-rate: 0
[2023-07-17 13:52:09] [config] max-length: 200
[2023-07-17 13:52:09] [config] max-length-crop: true
[2023-07-17 13:52:09] [config] max-length-factor: 3
[2023-07-17 13:52:09] [config] maxi-batch: 100
[2023-07-17 13:52:09] [config] maxi-batch-sort: trg
[2023-07-17 13:52:09] [config] mini-batch: 64
[2023-07-17 13:52:09] [config] mini-batch-fit: true
[2023-07-17 13:52:09] [config] mini-batch-fit-step: 10
[2023-07-17 13:52:09] [config] mini-batch-round-up: true
[2023-07-17 13:52:09] [config] mini-batch-track-lr: false
[2023-07-17 13:52:09] [config] mini-batch-warmup: 0
[2023-07-17 13:52:09] [config] mini-batch-words: 0
[2023-07-17 13:52:09] [config] mini-batch-words-ref: 0
[2023-07-17 13:52:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:52:09] [config] multi-loss-type: sum
[2023-07-17 13:52:09] [config] n-best: false
[2023-07-17 13:52:09] [config] no-nccl: false
[2023-07-17 13:52:09] [config] no-reload: false
[2023-07-17 13:52:09] [config] no-restore-corpus: false
[2023-07-17 13:52:09] [config] normalize: 0
[2023-07-17 13:52:09] [config] normalize-gradient: false
[2023-07-17 13:52:09] [config] num-devices: 0
[2023-07-17 13:52:09] [config] optimizer: adam
[2023-07-17 13:52:09] [config] optimizer-delay: 1
[2023-07-17 13:52:09] [config] optimizer-params:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] output-omit-bias: false
[2023-07-17 13:52:09] [config] overwrite: true
[2023-07-17 13:52:09] [config] precision:
[2023-07-17 13:52:09] [config]   - float16
[2023-07-17 13:52:09] [config]   - float32
[2023-07-17 13:52:09] [config] pretrained-model: ""
[2023-07-17 13:52:09] [config] quantize-biases: false
[2023-07-17 13:52:09] [config] quantize-bits: 0
[2023-07-17 13:52:09] [config] quantize-log-based: false
[2023-07-17 13:52:09] [config] quantize-optimization-steps: 0
[2023-07-17 13:52:09] [config] quiet: false
[2023-07-17 13:52:09] [config] quiet-translation: true
[2023-07-17 13:52:09] [config] relative-paths: false
[2023-07-17 13:52:09] [config] right-left: false
[2023-07-17 13:52:09] [config] save-freq: 10000u
[2023-07-17 13:52:09] [config] seed: 1234
[2023-07-17 13:52:09] [config] sentencepiece-alphas:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:52:09] [config] sentencepiece-options: ""
[2023-07-17 13:52:09] [config] sharding: global
[2023-07-17 13:52:09] [config] shuffle: data
[2023-07-17 13:52:09] [config] shuffle-in-ram: false
[2023-07-17 13:52:09] [config] sigterm: save-and-exit
[2023-07-17 13:52:09] [config] skip: false
[2023-07-17 13:52:09] [config] sqlite: ""
[2023-07-17 13:52:09] [config] sqlite-drop: false
[2023-07-17 13:52:09] [config] sync-freq: 200u
[2023-07-17 13:52:09] [config] sync-sgd: false
[2023-07-17 13:52:09] [config] tempdir: /tmp
[2023-07-17 13:52:09] [config] tied-embeddings: false
[2023-07-17 13:52:09] [config] tied-embeddings-all: true
[2023-07-17 13:52:09] [config] tied-embeddings-src: false
[2023-07-17 13:52:09] [config] train-embedder-rank:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] train-sets:
[2023-07-17 13:52:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:52:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:52:09] [config] transformer-aan-activation: swish
[2023-07-17 13:52:09] [config] transformer-aan-depth: 2
[2023-07-17 13:52:09] [config] transformer-aan-nogate: false
[2023-07-17 13:52:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:52:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:52:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:52:09] [config] transformer-depth-scaling: false
[2023-07-17 13:52:09] [config] transformer-dim-aan: 2048
[2023-07-17 13:52:09] [config] transformer-dim-ffn: 2048
[2023-07-17 13:52:09] [config] transformer-dropout: 0
[2023-07-17 13:52:09] [config] transformer-dropout-attention: 0
[2023-07-17 13:52:09] [config] transformer-dropout-ffn: 0
[2023-07-17 13:52:09] [config] transformer-ffn-activation: swish
[2023-07-17 13:52:09] [config] transformer-ffn-depth: 2
[2023-07-17 13:52:09] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:52:09] [config] transformer-heads: 8
[2023-07-17 13:52:09] [config] transformer-no-projection: false
[2023-07-17 13:52:09] [config] transformer-pool: false
[2023-07-17 13:52:09] [config] transformer-postprocess: dan
[2023-07-17 13:52:09] [config] transformer-postprocess-emb: d
[2023-07-17 13:52:09] [config] transformer-postprocess-top: ""
[2023-07-17 13:52:09] [config] transformer-preprocess: ""
[2023-07-17 13:52:09] [config] transformer-tied-layers:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] transformer-train-position-embeddings: false
[2023-07-17 13:52:09] [config] tsv: false
[2023-07-17 13:52:09] [config] tsv-fields: 0
[2023-07-17 13:52:09] [config] type: amun
[2023-07-17 13:52:09] [config] ulr: false
[2023-07-17 13:52:09] [config] ulr-dim-emb: 0
[2023-07-17 13:52:09] [config] ulr-dropout: 0
[2023-07-17 13:52:09] [config] ulr-keys-vectors: ""
[2023-07-17 13:52:09] [config] ulr-query-vectors: ""
[2023-07-17 13:52:09] [config] ulr-softmax-temperature: 1
[2023-07-17 13:52:09] [config] ulr-trainable-transformation: false
[2023-07-17 13:52:09] [config] unlikelihood-loss: false
[2023-07-17 13:52:09] [config] valid-freq: 50000000
[2023-07-17 13:52:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:09] [config] valid-max-length: 1000
[2023-07-17 13:52:09] [config] valid-metrics:
[2023-07-17 13:52:09] [config]   - cross-entropy
[2023-07-17 13:52:09] [config]   - translation
[2023-07-17 13:52:09] [config] valid-mini-batch: 32
[2023-07-17 13:52:09] [config] valid-reset-stalled: false
[2023-07-17 13:52:09] [config] valid-script-args:
[2023-07-17 13:52:09] [config]   []
[2023-07-17 13:52:09] [config] valid-script-path: ""
[2023-07-17 13:52:09] [config] valid-sets:
[2023-07-17 13:52:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:52:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:52:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:52:09] [config] vocabs:
[2023-07-17 13:52:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:09] [config] word-penalty: 0
[2023-07-17 13:52:09] [config] word-scores: false
[2023-07-17 13:52:09] [config] workspace: 5500
[2023-07-17 13:52:09] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:09] [training] Using single-device training
[2023-07-17 13:52:10] Synced seed 1234
[2023-07-17 13:52:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:52:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:10] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:52:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:52:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:10] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:52:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:52:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:52:11] [comm] Using global sharding
[2023-07-17 13:52:11] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:52:11] [training] Using 1 GPUs
[2023-07-17 13:52:11] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:52:11] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x5561489a5f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55614913b1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55614913bd6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55614913c785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x556148db9f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x556148e3fd5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x556148e2c77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x5561488fd81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x556148ed9306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x556148eb5f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x5561489b7450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x5561488d92c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x556148890b9c]    main                                               + 0x3c
[0x7f1e588bf0b3]    __libc_start_main                                  + 0xf3
[0x5561488d7cbe]    _start                                             + 0x2e

[2023-07-17 13:52:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:12] [marian] Running on node22.datos.cluster.uy as process 8441 with command line:
[2023-07-17 13:52:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:52:12] [config] after: 0e
[2023-07-17 13:52:12] [config] after-batches: 0
[2023-07-17 13:52:12] [config] after-epochs: 90
[2023-07-17 13:52:12] [config] all-caps-every: 0
[2023-07-17 13:52:12] [config] allow-unk: false
[2023-07-17 13:52:12] [config] authors: false
[2023-07-17 13:52:12] [config] beam-size: 12
[2023-07-17 13:52:12] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:52:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:52:12] [config] bert-masking-fraction: 0.15
[2023-07-17 13:52:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:52:12] [config] bert-train-type-embeddings: true
[2023-07-17 13:52:12] [config] bert-type-vocab-size: 2
[2023-07-17 13:52:12] [config] build-info: ""
[2023-07-17 13:52:12] [config] check-gradient-nan: false
[2023-07-17 13:52:12] [config] check-nan: false
[2023-07-17 13:52:12] [config] cite: false
[2023-07-17 13:52:12] [config] clip-norm: 1
[2023-07-17 13:52:12] [config] cost-scaling:
[2023-07-17 13:52:12] [config]   - 256.f
[2023-07-17 13:52:12] [config]   - 1000
[2023-07-17 13:52:12] [config]   - 2.f
[2023-07-17 13:52:12] [config]   - 256.f
[2023-07-17 13:52:12] [config] cost-type: ce-sum
[2023-07-17 13:52:12] [config] cpu-threads: 0
[2023-07-17 13:52:12] [config] data-threads: 8
[2023-07-17 13:52:12] [config] data-weighting: ""
[2023-07-17 13:52:12] [config] data-weighting-type: sentence
[2023-07-17 13:52:12] [config] dec-cell: gru
[2023-07-17 13:52:12] [config] dec-cell-base-depth: 2
[2023-07-17 13:52:12] [config] dec-cell-high-depth: 1
[2023-07-17 13:52:12] [config] dec-depth: 1
[2023-07-17 13:52:12] [config] devices:
[2023-07-17 13:52:12] [config]   - 0
[2023-07-17 13:52:12] [config] dim-emb: 512
[2023-07-17 13:52:12] [config] dim-rnn: 1024
[2023-07-17 13:52:12] [config] dim-vocabs:
[2023-07-17 13:52:12] [config]   - 16384
[2023-07-17 13:52:12] [config]   - 16384
[2023-07-17 13:52:12] [config] disp-first: 0
[2023-07-17 13:52:12] [config] disp-freq: 1000u
[2023-07-17 13:52:12] [config] disp-label-counts: true
[2023-07-17 13:52:12] [config] dropout-rnn: 0
[2023-07-17 13:52:12] [config] dropout-src: 0
[2023-07-17 13:52:12] [config] dropout-trg: 0
[2023-07-17 13:52:12] [config] dump-config: ""
[2023-07-17 13:52:12] [config] dynamic-gradient-scaling:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] early-stopping: 5
[2023-07-17 13:52:12] [config] early-stopping-on: first
[2023-07-17 13:52:12] [config] embedding-fix-src: false
[2023-07-17 13:52:12] [config] embedding-fix-trg: false
[2023-07-17 13:52:12] [config] embedding-normalization: false
[2023-07-17 13:52:12] [config] embedding-vectors:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] enc-cell: gru
[2023-07-17 13:52:12] [config] enc-cell-depth: 1
[2023-07-17 13:52:12] [config] enc-depth: 1
[2023-07-17 13:52:12] [config] enc-type: bidirectional
[2023-07-17 13:52:12] [config] english-title-case-every: 0
[2023-07-17 13:52:12] [config] exponential-smoothing: 0
[2023-07-17 13:52:12] [config] factor-weight: 1
[2023-07-17 13:52:12] [config] factors-combine: sum
[2023-07-17 13:52:12] [config] factors-dim-emb: 0
[2023-07-17 13:52:12] [config] gradient-checkpointing: false
[2023-07-17 13:52:12] [config] gradient-norm-average-window: 100
[2023-07-17 13:52:12] [config] guided-alignment: none
[2023-07-17 13:52:12] [config] guided-alignment-cost: mse
[2023-07-17 13:52:12] [config] guided-alignment-weight: 0.1
[2023-07-17 13:52:12] [config] ignore-model-config: false
[2023-07-17 13:52:12] [config] input-types:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] interpolate-env-vars: false
[2023-07-17 13:52:12] [config] keep-best: false
[2023-07-17 13:52:12] [config] label-smoothing: 0
[2023-07-17 13:52:12] [config] layer-normalization: false
[2023-07-17 13:52:12] [config] learn-rate: 0.0001
[2023-07-17 13:52:12] [config] lemma-dependency: ""
[2023-07-17 13:52:12] [config] lemma-dim-emb: 0
[2023-07-17 13:52:12] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:12] [config] log-level: info
[2023-07-17 13:52:12] [config] log-time-zone: ""
[2023-07-17 13:52:12] [config] logical-epoch:
[2023-07-17 13:52:12] [config]   - 1e
[2023-07-17 13:52:12] [config]   - 0
[2023-07-17 13:52:12] [config] lr-decay: 0
[2023-07-17 13:52:12] [config] lr-decay-freq: 50000
[2023-07-17 13:52:12] [config] lr-decay-inv-sqrt:
[2023-07-17 13:52:12] [config]   - 0
[2023-07-17 13:52:12] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:52:12] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:52:12] [config] lr-decay-start:
[2023-07-17 13:52:12] [config]   - 10
[2023-07-17 13:52:12] [config]   - 1
[2023-07-17 13:52:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:52:12] [config] lr-report: false
[2023-07-17 13:52:12] [config] lr-warmup: 0
[2023-07-17 13:52:12] [config] lr-warmup-at-reload: false
[2023-07-17 13:52:12] [config] lr-warmup-cycle: false
[2023-07-17 13:52:12] [config] lr-warmup-start-rate: 0
[2023-07-17 13:52:12] [config] max-length: 200
[2023-07-17 13:52:12] [config] max-length-crop: true
[2023-07-17 13:52:12] [config] max-length-factor: 3
[2023-07-17 13:52:12] [config] maxi-batch: 100
[2023-07-17 13:52:12] [config] maxi-batch-sort: trg
[2023-07-17 13:52:12] [config] mini-batch: 64
[2023-07-17 13:52:12] [config] mini-batch-fit: true
[2023-07-17 13:52:12] [config] mini-batch-fit-step: 10
[2023-07-17 13:52:12] [config] mini-batch-round-up: true
[2023-07-17 13:52:12] [config] mini-batch-track-lr: false
[2023-07-17 13:52:12] [config] mini-batch-warmup: 0
[2023-07-17 13:52:12] [config] mini-batch-words: 0
[2023-07-17 13:52:12] [config] mini-batch-words-ref: 0
[2023-07-17 13:52:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:52:12] [config] multi-loss-type: sum
[2023-07-17 13:52:12] [config] n-best: false
[2023-07-17 13:52:12] [config] no-nccl: false
[2023-07-17 13:52:12] [config] no-reload: false
[2023-07-17 13:52:12] [config] no-restore-corpus: false
[2023-07-17 13:52:12] [config] normalize: 0
[2023-07-17 13:52:12] [config] normalize-gradient: false
[2023-07-17 13:52:12] [config] num-devices: 0
[2023-07-17 13:52:12] [config] optimizer: adam
[2023-07-17 13:52:12] [config] optimizer-delay: 1
[2023-07-17 13:52:12] [config] optimizer-params:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] output-omit-bias: false
[2023-07-17 13:52:12] [config] overwrite: true
[2023-07-17 13:52:12] [config] precision:
[2023-07-17 13:52:12] [config]   - float16
[2023-07-17 13:52:12] [config]   - float32
[2023-07-17 13:52:12] [config] pretrained-model: ""
[2023-07-17 13:52:12] [config] quantize-biases: false
[2023-07-17 13:52:12] [config] quantize-bits: 0
[2023-07-17 13:52:12] [config] quantize-log-based: false
[2023-07-17 13:52:12] [config] quantize-optimization-steps: 0
[2023-07-17 13:52:12] [config] quiet: false
[2023-07-17 13:52:12] [config] quiet-translation: true
[2023-07-17 13:52:12] [config] relative-paths: false
[2023-07-17 13:52:12] [config] right-left: false
[2023-07-17 13:52:12] [config] save-freq: 10000u
[2023-07-17 13:52:12] [config] seed: 1234
[2023-07-17 13:52:12] [config] sentencepiece-alphas:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:52:12] [config] sentencepiece-options: ""
[2023-07-17 13:52:12] [config] sharding: global
[2023-07-17 13:52:12] [config] shuffle: data
[2023-07-17 13:52:12] [config] shuffle-in-ram: false
[2023-07-17 13:52:12] [config] sigterm: save-and-exit
[2023-07-17 13:52:12] [config] skip: false
[2023-07-17 13:52:12] [config] sqlite: ""
[2023-07-17 13:52:12] [config] sqlite-drop: false
[2023-07-17 13:52:12] [config] sync-freq: 200u
[2023-07-17 13:52:12] [config] sync-sgd: false
[2023-07-17 13:52:12] [config] tempdir: /tmp
[2023-07-17 13:52:12] [config] tied-embeddings: false
[2023-07-17 13:52:12] [config] tied-embeddings-all: true
[2023-07-17 13:52:12] [config] tied-embeddings-src: false
[2023-07-17 13:52:12] [config] train-embedder-rank:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] train-sets:
[2023-07-17 13:52:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:52:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:52:12] [config] transformer-aan-activation: swish
[2023-07-17 13:52:12] [config] transformer-aan-depth: 2
[2023-07-17 13:52:12] [config] transformer-aan-nogate: false
[2023-07-17 13:52:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:52:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:52:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:52:12] [config] transformer-depth-scaling: false
[2023-07-17 13:52:12] [config] transformer-dim-aan: 2048
[2023-07-17 13:52:12] [config] transformer-dim-ffn: 2048
[2023-07-17 13:52:12] [config] transformer-dropout: 0
[2023-07-17 13:52:12] [config] transformer-dropout-attention: 0
[2023-07-17 13:52:12] [config] transformer-dropout-ffn: 0
[2023-07-17 13:52:12] [config] transformer-ffn-activation: swish
[2023-07-17 13:52:12] [config] transformer-ffn-depth: 2
[2023-07-17 13:52:12] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:52:12] [config] transformer-heads: 8
[2023-07-17 13:52:12] [config] transformer-no-projection: false
[2023-07-17 13:52:12] [config] transformer-pool: false
[2023-07-17 13:52:12] [config] transformer-postprocess: dan
[2023-07-17 13:52:12] [config] transformer-postprocess-emb: d
[2023-07-17 13:52:12] [config] transformer-postprocess-top: ""
[2023-07-17 13:52:12] [config] transformer-preprocess: ""
[2023-07-17 13:52:12] [config] transformer-tied-layers:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] transformer-train-position-embeddings: false
[2023-07-17 13:52:12] [config] tsv: false
[2023-07-17 13:52:12] [config] tsv-fields: 0
[2023-07-17 13:52:12] [config] type: amun
[2023-07-17 13:52:12] [config] ulr: false
[2023-07-17 13:52:12] [config] ulr-dim-emb: 0
[2023-07-17 13:52:12] [config] ulr-dropout: 0
[2023-07-17 13:52:12] [config] ulr-keys-vectors: ""
[2023-07-17 13:52:12] [config] ulr-query-vectors: ""
[2023-07-17 13:52:12] [config] ulr-softmax-temperature: 1
[2023-07-17 13:52:12] [config] ulr-trainable-transformation: false
[2023-07-17 13:52:12] [config] unlikelihood-loss: false
[2023-07-17 13:52:12] [config] valid-freq: 50000000
[2023-07-17 13:52:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:12] [config] valid-max-length: 1000
[2023-07-17 13:52:12] [config] valid-metrics:
[2023-07-17 13:52:12] [config]   - cross-entropy
[2023-07-17 13:52:12] [config]   - translation
[2023-07-17 13:52:12] [config] valid-mini-batch: 32
[2023-07-17 13:52:12] [config] valid-reset-stalled: false
[2023-07-17 13:52:12] [config] valid-script-args:
[2023-07-17 13:52:12] [config]   []
[2023-07-17 13:52:12] [config] valid-script-path: ""
[2023-07-17 13:52:12] [config] valid-sets:
[2023-07-17 13:52:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:52:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:52:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:52:12] [config] vocabs:
[2023-07-17 13:52:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:12] [config] word-penalty: 0
[2023-07-17 13:52:12] [config] word-scores: false
[2023-07-17 13:52:12] [config] workspace: 5500
[2023-07-17 13:52:12] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:12] [training] Using single-device training
[2023-07-17 13:52:12] Synced seed 1234
[2023-07-17 13:52:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:52:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:13] [data] Setting vocabulary size for input 1 to 8,192
[2023-07-17 13:52:13] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:52:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:13] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:52:14] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:52:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:52:14] [comm] Using global sharding
[2023-07-17 13:52:14] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:52:14] [training] Using 1 GPUs
[2023-07-17 13:52:14] Error: Requested shape shape=8192x512 size=4194304 for existing parameter 'Wemb' does not match original shape shape=16384x512 size=8388608
[2023-07-17 13:52:14] Error: Aborted from marian::Expr marian::ExpressionGraph::param(const string&, const marian::Shape&, marian::Ptr<marian::inits::NodeInitializer>&, marian::Type, bool, bool) in /marian/src/graph/expression_graph.h:410

[CALL STACK]
[0x55b54ad04f01]    marian::ExpressionGraph::  param  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Shape const&,  std::shared_ptr<marian::inits::NodeInitializer> const&,  marian::Type,  bool,  bool) + 0x9f1
[0x55b54b49a1fa]    marian::Embedding::  Embedding  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x9ba
[0x55b54b49ad6d]    marian::EncoderDecoderLayerBase::  createEmbeddingLayer  () const + 0x5fd
[0x55b54b49b785]    marian::EncoderDecoderLayerBase::  getEmbeddingLayer  (bool) const + 0x155
[0x55b54b118f3c]    marian::DecoderBase::  embeddingsFromBatch  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::DecoderState>,  std::shared_ptr<marian::data::CorpusBatch>) + 0x8c
[0x55b54b19ed5a]    marian::EncoderDecoder::  stepAll  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::CorpusBatch>,  bool) + 0x1aa
[0x55b54b18b77c]    marian::models::EncoderDecoderCECost::  apply  (std::shared_ptr<marian::models::IModel>,  std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0x11c
[0x55b54ac5c81d]    marian::models::Trainer::  build  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::data::Batch>,  bool) + 0xbd
[0x55b54b238306]    marian::GraphGroup::  collectStats  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::models::ICriterionFunction>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  double) + 0xbb6
[0x55b54b214f2a]    marian::SyncGraphGroup::  collectStats  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&) + 0x11a
[0x55b54ad16450]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x680
[0x55b54ac382c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b54abefb9c]    main                                               + 0x3c
[0x7f251e8640b3]    __libc_start_main                                  + 0xf3
[0x55b54ac36cbe]    _start                                             + 0x2e

[2023-07-17 13:52:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:15] [marian] Running on node22.datos.cluster.uy as process 8471 with command line:
[2023-07-17 13:52:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:52:15] [config] after: 0e
[2023-07-17 13:52:15] [config] after-batches: 0
[2023-07-17 13:52:15] [config] after-epochs: 100
[2023-07-17 13:52:15] [config] all-caps-every: 0
[2023-07-17 13:52:15] [config] allow-unk: false
[2023-07-17 13:52:15] [config] authors: false
[2023-07-17 13:52:15] [config] beam-size: 12
[2023-07-17 13:52:15] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:52:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:52:15] [config] bert-masking-fraction: 0.15
[2023-07-17 13:52:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:52:15] [config] bert-train-type-embeddings: true
[2023-07-17 13:52:15] [config] bert-type-vocab-size: 2
[2023-07-17 13:52:15] [config] build-info: ""
[2023-07-17 13:52:15] [config] check-gradient-nan: false
[2023-07-17 13:52:15] [config] check-nan: false
[2023-07-17 13:52:15] [config] cite: false
[2023-07-17 13:52:15] [config] clip-norm: 1
[2023-07-17 13:52:15] [config] cost-scaling:
[2023-07-17 13:52:15] [config]   - 256.f
[2023-07-17 13:52:15] [config]   - 1000
[2023-07-17 13:52:15] [config]   - 2.f
[2023-07-17 13:52:15] [config]   - 256.f
[2023-07-17 13:52:15] [config] cost-type: ce-sum
[2023-07-17 13:52:15] [config] cpu-threads: 0
[2023-07-17 13:52:15] [config] data-threads: 8
[2023-07-17 13:52:15] [config] data-weighting: ""
[2023-07-17 13:52:15] [config] data-weighting-type: sentence
[2023-07-17 13:52:15] [config] dec-cell: gru
[2023-07-17 13:52:15] [config] dec-cell-base-depth: 2
[2023-07-17 13:52:15] [config] dec-cell-high-depth: 1
[2023-07-17 13:52:15] [config] dec-depth: 1
[2023-07-17 13:52:15] [config] devices:
[2023-07-17 13:52:15] [config]   - 0
[2023-07-17 13:52:15] [config] dim-emb: 512
[2023-07-17 13:52:15] [config] dim-rnn: 1024
[2023-07-17 13:52:15] [config] dim-vocabs:
[2023-07-17 13:52:15] [config]   - 16384
[2023-07-17 13:52:15] [config]   - 16384
[2023-07-17 13:52:15] [config] disp-first: 0
[2023-07-17 13:52:15] [config] disp-freq: 1000u
[2023-07-17 13:52:15] [config] disp-label-counts: true
[2023-07-17 13:52:15] [config] dropout-rnn: 0
[2023-07-17 13:52:15] [config] dropout-src: 0
[2023-07-17 13:52:15] [config] dropout-trg: 0
[2023-07-17 13:52:15] [config] dump-config: ""
[2023-07-17 13:52:15] [config] dynamic-gradient-scaling:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] early-stopping: 5
[2023-07-17 13:52:15] [config] early-stopping-on: first
[2023-07-17 13:52:15] [config] embedding-fix-src: false
[2023-07-17 13:52:15] [config] embedding-fix-trg: false
[2023-07-17 13:52:15] [config] embedding-normalization: false
[2023-07-17 13:52:15] [config] embedding-vectors:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] enc-cell: gru
[2023-07-17 13:52:15] [config] enc-cell-depth: 1
[2023-07-17 13:52:15] [config] enc-depth: 1
[2023-07-17 13:52:15] [config] enc-type: bidirectional
[2023-07-17 13:52:15] [config] english-title-case-every: 0
[2023-07-17 13:52:15] [config] exponential-smoothing: 0
[2023-07-17 13:52:15] [config] factor-weight: 1
[2023-07-17 13:52:15] [config] factors-combine: sum
[2023-07-17 13:52:15] [config] factors-dim-emb: 0
[2023-07-17 13:52:15] [config] gradient-checkpointing: false
[2023-07-17 13:52:15] [config] gradient-norm-average-window: 100
[2023-07-17 13:52:15] [config] guided-alignment: none
[2023-07-17 13:52:15] [config] guided-alignment-cost: mse
[2023-07-17 13:52:15] [config] guided-alignment-weight: 0.1
[2023-07-17 13:52:15] [config] ignore-model-config: false
[2023-07-17 13:52:15] [config] input-types:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] interpolate-env-vars: false
[2023-07-17 13:52:15] [config] keep-best: false
[2023-07-17 13:52:15] [config] label-smoothing: 0
[2023-07-17 13:52:15] [config] layer-normalization: false
[2023-07-17 13:52:15] [config] learn-rate: 0.0001
[2023-07-17 13:52:15] [config] lemma-dependency: ""
[2023-07-17 13:52:15] [config] lemma-dim-emb: 0
[2023-07-17 13:52:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:15] [config] log-level: info
[2023-07-17 13:52:15] [config] log-time-zone: ""
[2023-07-17 13:52:15] [config] logical-epoch:
[2023-07-17 13:52:15] [config]   - 1e
[2023-07-17 13:52:15] [config]   - 0
[2023-07-17 13:52:15] [config] lr-decay: 0
[2023-07-17 13:52:15] [config] lr-decay-freq: 50000
[2023-07-17 13:52:15] [config] lr-decay-inv-sqrt:
[2023-07-17 13:52:15] [config]   - 0
[2023-07-17 13:52:15] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:52:15] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:52:15] [config] lr-decay-start:
[2023-07-17 13:52:15] [config]   - 10
[2023-07-17 13:52:15] [config]   - 1
[2023-07-17 13:52:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:52:15] [config] lr-report: false
[2023-07-17 13:52:15] [config] lr-warmup: 0
[2023-07-17 13:52:15] [config] lr-warmup-at-reload: false
[2023-07-17 13:52:15] [config] lr-warmup-cycle: false
[2023-07-17 13:52:15] [config] lr-warmup-start-rate: 0
[2023-07-17 13:52:15] [config] max-length: 200
[2023-07-17 13:52:15] [config] max-length-crop: true
[2023-07-17 13:52:15] [config] max-length-factor: 3
[2023-07-17 13:52:15] [config] maxi-batch: 100
[2023-07-17 13:52:15] [config] maxi-batch-sort: trg
[2023-07-17 13:52:15] [config] mini-batch: 64
[2023-07-17 13:52:15] [config] mini-batch-fit: true
[2023-07-17 13:52:15] [config] mini-batch-fit-step: 10
[2023-07-17 13:52:15] [config] mini-batch-round-up: true
[2023-07-17 13:52:15] [config] mini-batch-track-lr: false
[2023-07-17 13:52:15] [config] mini-batch-warmup: 0
[2023-07-17 13:52:15] [config] mini-batch-words: 0
[2023-07-17 13:52:15] [config] mini-batch-words-ref: 0
[2023-07-17 13:52:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:52:15] [config] multi-loss-type: sum
[2023-07-17 13:52:15] [config] n-best: false
[2023-07-17 13:52:15] [config] no-nccl: false
[2023-07-17 13:52:15] [config] no-reload: false
[2023-07-17 13:52:15] [config] no-restore-corpus: false
[2023-07-17 13:52:15] [config] normalize: 0
[2023-07-17 13:52:15] [config] normalize-gradient: false
[2023-07-17 13:52:15] [config] num-devices: 0
[2023-07-17 13:52:15] [config] optimizer: adam
[2023-07-17 13:52:15] [config] optimizer-delay: 1
[2023-07-17 13:52:15] [config] optimizer-params:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] output-omit-bias: false
[2023-07-17 13:52:15] [config] overwrite: true
[2023-07-17 13:52:15] [config] precision:
[2023-07-17 13:52:15] [config]   - float16
[2023-07-17 13:52:15] [config]   - float32
[2023-07-17 13:52:15] [config] pretrained-model: ""
[2023-07-17 13:52:15] [config] quantize-biases: false
[2023-07-17 13:52:15] [config] quantize-bits: 0
[2023-07-17 13:52:15] [config] quantize-log-based: false
[2023-07-17 13:52:15] [config] quantize-optimization-steps: 0
[2023-07-17 13:52:15] [config] quiet: false
[2023-07-17 13:52:15] [config] quiet-translation: true
[2023-07-17 13:52:15] [config] relative-paths: false
[2023-07-17 13:52:15] [config] right-left: false
[2023-07-17 13:52:15] [config] save-freq: 10000u
[2023-07-17 13:52:15] [config] seed: 1234
[2023-07-17 13:52:15] [config] sentencepiece-alphas:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:52:15] [config] sentencepiece-options: ""
[2023-07-17 13:52:15] [config] sharding: global
[2023-07-17 13:52:15] [config] shuffle: data
[2023-07-17 13:52:15] [config] shuffle-in-ram: false
[2023-07-17 13:52:15] [config] sigterm: save-and-exit
[2023-07-17 13:52:15] [config] skip: false
[2023-07-17 13:52:15] [config] sqlite: ""
[2023-07-17 13:52:15] [config] sqlite-drop: false
[2023-07-17 13:52:15] [config] sync-freq: 200u
[2023-07-17 13:52:15] [config] sync-sgd: false
[2023-07-17 13:52:15] [config] tempdir: /tmp
[2023-07-17 13:52:15] [config] tied-embeddings: false
[2023-07-17 13:52:15] [config] tied-embeddings-all: true
[2023-07-17 13:52:15] [config] tied-embeddings-src: false
[2023-07-17 13:52:15] [config] train-embedder-rank:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] train-sets:
[2023-07-17 13:52:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:52:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:52:15] [config] transformer-aan-activation: swish
[2023-07-17 13:52:15] [config] transformer-aan-depth: 2
[2023-07-17 13:52:15] [config] transformer-aan-nogate: false
[2023-07-17 13:52:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:52:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:52:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:52:15] [config] transformer-depth-scaling: false
[2023-07-17 13:52:15] [config] transformer-dim-aan: 2048
[2023-07-17 13:52:15] [config] transformer-dim-ffn: 2048
[2023-07-17 13:52:15] [config] transformer-dropout: 0
[2023-07-17 13:52:15] [config] transformer-dropout-attention: 0
[2023-07-17 13:52:15] [config] transformer-dropout-ffn: 0
[2023-07-17 13:52:15] [config] transformer-ffn-activation: swish
[2023-07-17 13:52:15] [config] transformer-ffn-depth: 2
[2023-07-17 13:52:15] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:52:15] [config] transformer-heads: 8
[2023-07-17 13:52:15] [config] transformer-no-projection: false
[2023-07-17 13:52:15] [config] transformer-pool: false
[2023-07-17 13:52:15] [config] transformer-postprocess: dan
[2023-07-17 13:52:15] [config] transformer-postprocess-emb: d
[2023-07-17 13:52:15] [config] transformer-postprocess-top: ""
[2023-07-17 13:52:15] [config] transformer-preprocess: ""
[2023-07-17 13:52:15] [config] transformer-tied-layers:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] transformer-train-position-embeddings: false
[2023-07-17 13:52:15] [config] tsv: false
[2023-07-17 13:52:15] [config] tsv-fields: 0
[2023-07-17 13:52:15] [config] type: amun
[2023-07-17 13:52:15] [config] ulr: false
[2023-07-17 13:52:15] [config] ulr-dim-emb: 0
[2023-07-17 13:52:15] [config] ulr-dropout: 0
[2023-07-17 13:52:15] [config] ulr-keys-vectors: ""
[2023-07-17 13:52:15] [config] ulr-query-vectors: ""
[2023-07-17 13:52:15] [config] ulr-softmax-temperature: 1
[2023-07-17 13:52:15] [config] ulr-trainable-transformation: false
[2023-07-17 13:52:15] [config] unlikelihood-loss: false
[2023-07-17 13:52:15] [config] valid-freq: 50000000
[2023-07-17 13:52:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:52:15] [config] valid-max-length: 1000
[2023-07-17 13:52:15] [config] valid-metrics:
[2023-07-17 13:52:15] [config]   - cross-entropy
[2023-07-17 13:52:15] [config]   - translation
[2023-07-17 13:52:15] [config] valid-mini-batch: 32
[2023-07-17 13:52:15] [config] valid-reset-stalled: false
[2023-07-17 13:52:15] [config] valid-script-args:
[2023-07-17 13:52:15] [config]   []
[2023-07-17 13:52:15] [config] valid-script-path: ""
[2023-07-17 13:52:15] [config] valid-sets:
[2023-07-17 13:52:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:52:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:52:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:52:15] [config] vocabs:
[2023-07-17 13:52:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:52:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:52:15] [config] word-penalty: 0
[2023-07-17 13:52:15] [config] word-scores: false
[2023-07-17 13:52:15] [config] workspace: 5500
[2023-07-17 13:52:15] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:52:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:52:15] [training] Using single-device training
[2023-07-17 13:53:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:53:51] [marian] Running on node22.datos.cluster.uy as process 8649 with command line:
[2023-07-17 13:53:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 13:53:51] [config] after: 0e
[2023-07-17 13:53:51] [config] after-batches: 0
[2023-07-17 13:53:51] [config] after-epochs: 10
[2023-07-17 13:53:51] [config] all-caps-every: 0
[2023-07-17 13:53:51] [config] allow-unk: false
[2023-07-17 13:53:51] [config] authors: false
[2023-07-17 13:53:51] [config] beam-size: 12
[2023-07-17 13:53:51] [config] bert-class-symbol: "[CLS]"
[2023-07-17 13:53:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 13:53:51] [config] bert-masking-fraction: 0.15
[2023-07-17 13:53:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 13:53:51] [config] bert-train-type-embeddings: true
[2023-07-17 13:53:51] [config] bert-type-vocab-size: 2
[2023-07-17 13:53:51] [config] build-info: ""
[2023-07-17 13:53:51] [config] check-gradient-nan: false
[2023-07-17 13:53:51] [config] check-nan: false
[2023-07-17 13:53:51] [config] cite: false
[2023-07-17 13:53:51] [config] clip-norm: 1
[2023-07-17 13:53:51] [config] cost-scaling:
[2023-07-17 13:53:51] [config]   - 256.f
[2023-07-17 13:53:51] [config]   - 1000
[2023-07-17 13:53:51] [config]   - 2.f
[2023-07-17 13:53:51] [config]   - 256.f
[2023-07-17 13:53:51] [config] cost-type: ce-sum
[2023-07-17 13:53:51] [config] cpu-threads: 0
[2023-07-17 13:53:51] [config] data-threads: 8
[2023-07-17 13:53:51] [config] data-weighting: ""
[2023-07-17 13:53:51] [config] data-weighting-type: sentence
[2023-07-17 13:53:51] [config] dec-cell: gru
[2023-07-17 13:53:51] [config] dec-cell-base-depth: 2
[2023-07-17 13:53:51] [config] dec-cell-high-depth: 1
[2023-07-17 13:53:51] [config] dec-depth: 1
[2023-07-17 13:53:51] [config] devices:
[2023-07-17 13:53:51] [config]   - 0
[2023-07-17 13:53:51] [config] dim-emb: 512
[2023-07-17 13:53:51] [config] dim-rnn: 1024
[2023-07-17 13:53:51] [config] dim-vocabs:
[2023-07-17 13:53:51] [config]   - 16384
[2023-07-17 13:53:51] [config]   - 16384
[2023-07-17 13:53:51] [config] disp-first: 0
[2023-07-17 13:53:51] [config] disp-freq: 1000u
[2023-07-17 13:53:51] [config] disp-label-counts: true
[2023-07-17 13:53:51] [config] dropout-rnn: 0
[2023-07-17 13:53:51] [config] dropout-src: 0
[2023-07-17 13:53:51] [config] dropout-trg: 0
[2023-07-17 13:53:51] [config] dump-config: ""
[2023-07-17 13:53:51] [config] dynamic-gradient-scaling:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] early-stopping: 5
[2023-07-17 13:53:51] [config] early-stopping-on: first
[2023-07-17 13:53:51] [config] embedding-fix-src: false
[2023-07-17 13:53:51] [config] embedding-fix-trg: false
[2023-07-17 13:53:51] [config] embedding-normalization: false
[2023-07-17 13:53:51] [config] embedding-vectors:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] enc-cell: gru
[2023-07-17 13:53:51] [config] enc-cell-depth: 1
[2023-07-17 13:53:51] [config] enc-depth: 1
[2023-07-17 13:53:51] [config] enc-type: bidirectional
[2023-07-17 13:53:51] [config] english-title-case-every: 0
[2023-07-17 13:53:51] [config] exponential-smoothing: 0
[2023-07-17 13:53:51] [config] factor-weight: 1
[2023-07-17 13:53:51] [config] factors-combine: sum
[2023-07-17 13:53:51] [config] factors-dim-emb: 0
[2023-07-17 13:53:51] [config] gradient-checkpointing: false
[2023-07-17 13:53:51] [config] gradient-norm-average-window: 100
[2023-07-17 13:53:51] [config] guided-alignment: none
[2023-07-17 13:53:51] [config] guided-alignment-cost: mse
[2023-07-17 13:53:51] [config] guided-alignment-weight: 0.1
[2023-07-17 13:53:51] [config] ignore-model-config: false
[2023-07-17 13:53:51] [config] input-types:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] interpolate-env-vars: false
[2023-07-17 13:53:51] [config] keep-best: false
[2023-07-17 13:53:51] [config] label-smoothing: 0
[2023-07-17 13:53:51] [config] layer-normalization: false
[2023-07-17 13:53:51] [config] learn-rate: 0.0001
[2023-07-17 13:53:51] [config] lemma-dependency: ""
[2023-07-17 13:53:51] [config] lemma-dim-emb: 0
[2023-07-17 13:53:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:53:51] [config] log-level: info
[2023-07-17 13:53:51] [config] log-time-zone: ""
[2023-07-17 13:53:51] [config] logical-epoch:
[2023-07-17 13:53:51] [config]   - 1e
[2023-07-17 13:53:51] [config]   - 0
[2023-07-17 13:53:51] [config] lr-decay: 0
[2023-07-17 13:53:51] [config] lr-decay-freq: 50000
[2023-07-17 13:53:51] [config] lr-decay-inv-sqrt:
[2023-07-17 13:53:51] [config]   - 0
[2023-07-17 13:53:51] [config] lr-decay-repeat-warmup: false
[2023-07-17 13:53:51] [config] lr-decay-reset-optimizer: false
[2023-07-17 13:53:51] [config] lr-decay-start:
[2023-07-17 13:53:51] [config]   - 10
[2023-07-17 13:53:51] [config]   - 1
[2023-07-17 13:53:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 13:53:51] [config] lr-report: false
[2023-07-17 13:53:51] [config] lr-warmup: 0
[2023-07-17 13:53:51] [config] lr-warmup-at-reload: false
[2023-07-17 13:53:51] [config] lr-warmup-cycle: false
[2023-07-17 13:53:51] [config] lr-warmup-start-rate: 0
[2023-07-17 13:53:51] [config] max-length: 200
[2023-07-17 13:53:51] [config] max-length-crop: true
[2023-07-17 13:53:51] [config] max-length-factor: 3
[2023-07-17 13:53:51] [config] maxi-batch: 100
[2023-07-17 13:53:51] [config] maxi-batch-sort: trg
[2023-07-17 13:53:51] [config] mini-batch: 64
[2023-07-17 13:53:51] [config] mini-batch-fit: true
[2023-07-17 13:53:51] [config] mini-batch-fit-step: 10
[2023-07-17 13:53:51] [config] mini-batch-round-up: true
[2023-07-17 13:53:51] [config] mini-batch-track-lr: false
[2023-07-17 13:53:51] [config] mini-batch-warmup: 0
[2023-07-17 13:53:51] [config] mini-batch-words: 0
[2023-07-17 13:53:51] [config] mini-batch-words-ref: 0
[2023-07-17 13:53:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 13:53:51] [config] multi-loss-type: sum
[2023-07-17 13:53:51] [config] n-best: false
[2023-07-17 13:53:51] [config] no-nccl: false
[2023-07-17 13:53:51] [config] no-reload: false
[2023-07-17 13:53:51] [config] no-restore-corpus: false
[2023-07-17 13:53:51] [config] normalize: 0
[2023-07-17 13:53:51] [config] normalize-gradient: false
[2023-07-17 13:53:51] [config] num-devices: 0
[2023-07-17 13:53:51] [config] optimizer: adam
[2023-07-17 13:53:51] [config] optimizer-delay: 1
[2023-07-17 13:53:51] [config] optimizer-params:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] output-omit-bias: false
[2023-07-17 13:53:51] [config] overwrite: true
[2023-07-17 13:53:51] [config] precision:
[2023-07-17 13:53:51] [config]   - float16
[2023-07-17 13:53:51] [config]   - float32
[2023-07-17 13:53:51] [config] pretrained-model: ""
[2023-07-17 13:53:51] [config] quantize-biases: false
[2023-07-17 13:53:51] [config] quantize-bits: 0
[2023-07-17 13:53:51] [config] quantize-log-based: false
[2023-07-17 13:53:51] [config] quantize-optimization-steps: 0
[2023-07-17 13:53:51] [config] quiet: false
[2023-07-17 13:53:51] [config] quiet-translation: true
[2023-07-17 13:53:51] [config] relative-paths: false
[2023-07-17 13:53:51] [config] right-left: false
[2023-07-17 13:53:51] [config] save-freq: 10000u
[2023-07-17 13:53:51] [config] seed: 1234
[2023-07-17 13:53:51] [config] sentencepiece-alphas:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] sentencepiece-max-lines: 2000000
[2023-07-17 13:53:51] [config] sentencepiece-options: ""
[2023-07-17 13:53:51] [config] sharding: global
[2023-07-17 13:53:51] [config] shuffle: data
[2023-07-17 13:53:51] [config] shuffle-in-ram: false
[2023-07-17 13:53:51] [config] sigterm: save-and-exit
[2023-07-17 13:53:51] [config] skip: false
[2023-07-17 13:53:51] [config] sqlite: ""
[2023-07-17 13:53:51] [config] sqlite-drop: false
[2023-07-17 13:53:51] [config] sync-freq: 200u
[2023-07-17 13:53:51] [config] sync-sgd: false
[2023-07-17 13:53:51] [config] tempdir: /tmp
[2023-07-17 13:53:51] [config] tied-embeddings: false
[2023-07-17 13:53:51] [config] tied-embeddings-all: true
[2023-07-17 13:53:51] [config] tied-embeddings-src: false
[2023-07-17 13:53:51] [config] train-embedder-rank:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] train-sets:
[2023-07-17 13:53:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 13:53:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:53:51] [config] transformer-aan-activation: swish
[2023-07-17 13:53:51] [config] transformer-aan-depth: 2
[2023-07-17 13:53:51] [config] transformer-aan-nogate: false
[2023-07-17 13:53:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 13:53:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 13:53:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 13:53:51] [config] transformer-depth-scaling: false
[2023-07-17 13:53:51] [config] transformer-dim-aan: 2048
[2023-07-17 13:53:51] [config] transformer-dim-ffn: 2048
[2023-07-17 13:53:51] [config] transformer-dropout: 0
[2023-07-17 13:53:51] [config] transformer-dropout-attention: 0
[2023-07-17 13:53:51] [config] transformer-dropout-ffn: 0
[2023-07-17 13:53:51] [config] transformer-ffn-activation: swish
[2023-07-17 13:53:51] [config] transformer-ffn-depth: 2
[2023-07-17 13:53:51] [config] transformer-guided-alignment-layer: last
[2023-07-17 13:53:51] [config] transformer-heads: 8
[2023-07-17 13:53:51] [config] transformer-no-projection: false
[2023-07-17 13:53:51] [config] transformer-pool: false
[2023-07-17 13:53:51] [config] transformer-postprocess: dan
[2023-07-17 13:53:51] [config] transformer-postprocess-emb: d
[2023-07-17 13:53:51] [config] transformer-postprocess-top: ""
[2023-07-17 13:53:51] [config] transformer-preprocess: ""
[2023-07-17 13:53:51] [config] transformer-tied-layers:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] transformer-train-position-embeddings: false
[2023-07-17 13:53:51] [config] tsv: false
[2023-07-17 13:53:51] [config] tsv-fields: 0
[2023-07-17 13:53:51] [config] type: amun
[2023-07-17 13:53:51] [config] ulr: false
[2023-07-17 13:53:51] [config] ulr-dim-emb: 0
[2023-07-17 13:53:51] [config] ulr-dropout: 0
[2023-07-17 13:53:51] [config] ulr-keys-vectors: ""
[2023-07-17 13:53:51] [config] ulr-query-vectors: ""
[2023-07-17 13:53:51] [config] ulr-softmax-temperature: 1
[2023-07-17 13:53:51] [config] ulr-trainable-transformation: false
[2023-07-17 13:53:51] [config] unlikelihood-loss: false
[2023-07-17 13:53:51] [config] valid-freq: 50000000
[2023-07-17 13:53:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 13:53:51] [config] valid-max-length: 1000
[2023-07-17 13:53:51] [config] valid-metrics:
[2023-07-17 13:53:51] [config]   - cross-entropy
[2023-07-17 13:53:51] [config]   - translation
[2023-07-17 13:53:51] [config] valid-mini-batch: 32
[2023-07-17 13:53:51] [config] valid-reset-stalled: false
[2023-07-17 13:53:51] [config] valid-script-args:
[2023-07-17 13:53:51] [config]   []
[2023-07-17 13:53:51] [config] valid-script-path: ""
[2023-07-17 13:53:51] [config] valid-sets:
[2023-07-17 13:53:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 13:53:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 13:53:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 13:53:51] [config] vocabs:
[2023-07-17 13:53:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:53:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:53:51] [config] word-penalty: 0
[2023-07-17 13:53:51] [config] word-scores: false
[2023-07-17 13:53:51] [config] workspace: 5500
[2023-07-17 13:53:51] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 13:53:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:53:51] [training] Using single-device training
[2023-07-17 13:53:52] Synced seed 1234
[2023-07-17 13:53:52] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 13:53:52] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 13:53:52] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:53:52] [SentencePiece] Creating temporary file /tmp/marian.VPLamd 
[2023-07-17 13:53:52] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 13:53:52] [SentencePiece] Selected 20193 lines
[2023-07-17 13:53:54] [SentencePiece] Removing /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm.vocab
[2023-07-17 13:53:54] [SentencePiece] Renaming /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm.model to /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:53:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 13:53:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 13:53:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 13:53:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 13:53:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 13:53:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 13:53:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 13:53:56] [comm] Using global sharding
[2023-07-17 13:53:56] [comm] NCCLCommunicators constructed successfully
[2023-07-17 13:53:56] [training] Using 1 GPUs
[2023-07-17 13:53:56] [logits] Applying loss function for 1 factor(s)
[2023-07-17 13:53:56] [memory] Reserving 80 MB, device gpu0
[2023-07-17 13:54:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 13:54:01] [memory] Reserving 80 MB, device gpu0
[2023-07-17 14:27:36] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 14:27:36] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 14:27:36] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x559e59bf6231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x559e59c4bca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x559e59c62d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x559e5a076e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x559e5a085348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x559e59b2ab9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x559e59a4c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x559e59a03b9c]    main                                               + 0x3c
[0x7feb127110b3]    __libc_start_main                                  + 0xf3
[0x559e59a4acbe]    _start                                             + 0x2e

[2023-07-17 14:27:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 14:27:37] [marian] Running on node22.datos.cluster.uy as process 11244 with command line:
[2023-07-17 14:27:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 14:27:37] [config] after: 0e
[2023-07-17 14:27:37] [config] after-batches: 0
[2023-07-17 14:27:37] [config] after-epochs: 20
[2023-07-17 14:27:37] [config] all-caps-every: 0
[2023-07-17 14:27:37] [config] allow-unk: false
[2023-07-17 14:27:37] [config] authors: false
[2023-07-17 14:27:37] [config] beam-size: 12
[2023-07-17 14:27:37] [config] bert-class-symbol: "[CLS]"
[2023-07-17 14:27:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 14:27:37] [config] bert-masking-fraction: 0.15
[2023-07-17 14:27:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 14:27:37] [config] bert-train-type-embeddings: true
[2023-07-17 14:27:37] [config] bert-type-vocab-size: 2
[2023-07-17 14:27:37] [config] build-info: ""
[2023-07-17 14:27:37] [config] check-gradient-nan: false
[2023-07-17 14:27:37] [config] check-nan: false
[2023-07-17 14:27:37] [config] cite: false
[2023-07-17 14:27:37] [config] clip-norm: 1
[2023-07-17 14:27:37] [config] cost-scaling:
[2023-07-17 14:27:37] [config]   - 256.f
[2023-07-17 14:27:37] [config]   - 1000
[2023-07-17 14:27:37] [config]   - 2.f
[2023-07-17 14:27:37] [config]   - 256.f
[2023-07-17 14:27:37] [config] cost-type: ce-sum
[2023-07-17 14:27:37] [config] cpu-threads: 0
[2023-07-17 14:27:37] [config] data-threads: 8
[2023-07-17 14:27:37] [config] data-weighting: ""
[2023-07-17 14:27:37] [config] data-weighting-type: sentence
[2023-07-17 14:27:37] [config] dec-cell: gru
[2023-07-17 14:27:37] [config] dec-cell-base-depth: 2
[2023-07-17 14:27:37] [config] dec-cell-high-depth: 1
[2023-07-17 14:27:37] [config] dec-depth: 1
[2023-07-17 14:27:37] [config] devices:
[2023-07-17 14:27:37] [config]   - 0
[2023-07-17 14:27:37] [config] dim-emb: 512
[2023-07-17 14:27:37] [config] dim-rnn: 1024
[2023-07-17 14:27:37] [config] dim-vocabs:
[2023-07-17 14:27:37] [config]   - 16384
[2023-07-17 14:27:37] [config]   - 16384
[2023-07-17 14:27:37] [config] disp-first: 0
[2023-07-17 14:27:37] [config] disp-freq: 1000u
[2023-07-17 14:27:37] [config] disp-label-counts: true
[2023-07-17 14:27:37] [config] dropout-rnn: 0
[2023-07-17 14:27:37] [config] dropout-src: 0
[2023-07-17 14:27:37] [config] dropout-trg: 0
[2023-07-17 14:27:37] [config] dump-config: ""
[2023-07-17 14:27:37] [config] dynamic-gradient-scaling:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] early-stopping: 5
[2023-07-17 14:27:37] [config] early-stopping-on: first
[2023-07-17 14:27:37] [config] embedding-fix-src: false
[2023-07-17 14:27:37] [config] embedding-fix-trg: false
[2023-07-17 14:27:37] [config] embedding-normalization: false
[2023-07-17 14:27:37] [config] embedding-vectors:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] enc-cell: gru
[2023-07-17 14:27:37] [config] enc-cell-depth: 1
[2023-07-17 14:27:37] [config] enc-depth: 1
[2023-07-17 14:27:37] [config] enc-type: bidirectional
[2023-07-17 14:27:37] [config] english-title-case-every: 0
[2023-07-17 14:27:37] [config] exponential-smoothing: 0
[2023-07-17 14:27:37] [config] factor-weight: 1
[2023-07-17 14:27:37] [config] factors-combine: sum
[2023-07-17 14:27:37] [config] factors-dim-emb: 0
[2023-07-17 14:27:37] [config] gradient-checkpointing: false
[2023-07-17 14:27:37] [config] gradient-norm-average-window: 100
[2023-07-17 14:27:37] [config] guided-alignment: none
[2023-07-17 14:27:37] [config] guided-alignment-cost: mse
[2023-07-17 14:27:37] [config] guided-alignment-weight: 0.1
[2023-07-17 14:27:37] [config] ignore-model-config: false
[2023-07-17 14:27:37] [config] input-types:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] interpolate-env-vars: false
[2023-07-17 14:27:37] [config] keep-best: false
[2023-07-17 14:27:37] [config] label-smoothing: 0
[2023-07-17 14:27:37] [config] layer-normalization: false
[2023-07-17 14:27:37] [config] learn-rate: 0.0001
[2023-07-17 14:27:37] [config] lemma-dependency: ""
[2023-07-17 14:27:37] [config] lemma-dim-emb: 0
[2023-07-17 14:27:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 14:27:37] [config] log-level: info
[2023-07-17 14:27:37] [config] log-time-zone: ""
[2023-07-17 14:27:37] [config] logical-epoch:
[2023-07-17 14:27:37] [config]   - 1e
[2023-07-17 14:27:37] [config]   - 0
[2023-07-17 14:27:37] [config] lr-decay: 0
[2023-07-17 14:27:37] [config] lr-decay-freq: 50000
[2023-07-17 14:27:37] [config] lr-decay-inv-sqrt:
[2023-07-17 14:27:37] [config]   - 0
[2023-07-17 14:27:37] [config] lr-decay-repeat-warmup: false
[2023-07-17 14:27:37] [config] lr-decay-reset-optimizer: false
[2023-07-17 14:27:37] [config] lr-decay-start:
[2023-07-17 14:27:37] [config]   - 10
[2023-07-17 14:27:37] [config]   - 1
[2023-07-17 14:27:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 14:27:37] [config] lr-report: false
[2023-07-17 14:27:37] [config] lr-warmup: 0
[2023-07-17 14:27:37] [config] lr-warmup-at-reload: false
[2023-07-17 14:27:37] [config] lr-warmup-cycle: false
[2023-07-17 14:27:37] [config] lr-warmup-start-rate: 0
[2023-07-17 14:27:37] [config] max-length: 200
[2023-07-17 14:27:37] [config] max-length-crop: true
[2023-07-17 14:27:37] [config] max-length-factor: 3
[2023-07-17 14:27:37] [config] maxi-batch: 100
[2023-07-17 14:27:37] [config] maxi-batch-sort: trg
[2023-07-17 14:27:37] [config] mini-batch: 64
[2023-07-17 14:27:37] [config] mini-batch-fit: true
[2023-07-17 14:27:37] [config] mini-batch-fit-step: 10
[2023-07-17 14:27:37] [config] mini-batch-round-up: true
[2023-07-17 14:27:37] [config] mini-batch-track-lr: false
[2023-07-17 14:27:37] [config] mini-batch-warmup: 0
[2023-07-17 14:27:37] [config] mini-batch-words: 0
[2023-07-17 14:27:37] [config] mini-batch-words-ref: 0
[2023-07-17 14:27:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 14:27:37] [config] multi-loss-type: sum
[2023-07-17 14:27:37] [config] n-best: false
[2023-07-17 14:27:37] [config] no-nccl: false
[2023-07-17 14:27:37] [config] no-reload: false
[2023-07-17 14:27:37] [config] no-restore-corpus: false
[2023-07-17 14:27:37] [config] normalize: 0
[2023-07-17 14:27:37] [config] normalize-gradient: false
[2023-07-17 14:27:37] [config] num-devices: 0
[2023-07-17 14:27:37] [config] optimizer: adam
[2023-07-17 14:27:37] [config] optimizer-delay: 1
[2023-07-17 14:27:37] [config] optimizer-params:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] output-omit-bias: false
[2023-07-17 14:27:37] [config] overwrite: true
[2023-07-17 14:27:37] [config] precision:
[2023-07-17 14:27:37] [config]   - float16
[2023-07-17 14:27:37] [config]   - float32
[2023-07-17 14:27:37] [config] pretrained-model: ""
[2023-07-17 14:27:37] [config] quantize-biases: false
[2023-07-17 14:27:37] [config] quantize-bits: 0
[2023-07-17 14:27:37] [config] quantize-log-based: false
[2023-07-17 14:27:37] [config] quantize-optimization-steps: 0
[2023-07-17 14:27:37] [config] quiet: false
[2023-07-17 14:27:37] [config] quiet-translation: true
[2023-07-17 14:27:37] [config] relative-paths: false
[2023-07-17 14:27:37] [config] right-left: false
[2023-07-17 14:27:37] [config] save-freq: 10000u
[2023-07-17 14:27:37] [config] seed: 1234
[2023-07-17 14:27:37] [config] sentencepiece-alphas:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] sentencepiece-max-lines: 2000000
[2023-07-17 14:27:37] [config] sentencepiece-options: ""
[2023-07-17 14:27:37] [config] sharding: global
[2023-07-17 14:27:37] [config] shuffle: data
[2023-07-17 14:27:37] [config] shuffle-in-ram: false
[2023-07-17 14:27:37] [config] sigterm: save-and-exit
[2023-07-17 14:27:37] [config] skip: false
[2023-07-17 14:27:37] [config] sqlite: ""
[2023-07-17 14:27:37] [config] sqlite-drop: false
[2023-07-17 14:27:37] [config] sync-freq: 200u
[2023-07-17 14:27:37] [config] sync-sgd: false
[2023-07-17 14:27:37] [config] tempdir: /tmp
[2023-07-17 14:27:37] [config] tied-embeddings: false
[2023-07-17 14:27:37] [config] tied-embeddings-all: true
[2023-07-17 14:27:37] [config] tied-embeddings-src: false
[2023-07-17 14:27:37] [config] train-embedder-rank:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] train-sets:
[2023-07-17 14:27:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 14:27:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 14:27:37] [config] transformer-aan-activation: swish
[2023-07-17 14:27:37] [config] transformer-aan-depth: 2
[2023-07-17 14:27:37] [config] transformer-aan-nogate: false
[2023-07-17 14:27:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 14:27:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 14:27:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 14:27:37] [config] transformer-depth-scaling: false
[2023-07-17 14:27:37] [config] transformer-dim-aan: 2048
[2023-07-17 14:27:37] [config] transformer-dim-ffn: 2048
[2023-07-17 14:27:37] [config] transformer-dropout: 0
[2023-07-17 14:27:37] [config] transformer-dropout-attention: 0
[2023-07-17 14:27:37] [config] transformer-dropout-ffn: 0
[2023-07-17 14:27:37] [config] transformer-ffn-activation: swish
[2023-07-17 14:27:37] [config] transformer-ffn-depth: 2
[2023-07-17 14:27:37] [config] transformer-guided-alignment-layer: last
[2023-07-17 14:27:37] [config] transformer-heads: 8
[2023-07-17 14:27:37] [config] transformer-no-projection: false
[2023-07-17 14:27:37] [config] transformer-pool: false
[2023-07-17 14:27:37] [config] transformer-postprocess: dan
[2023-07-17 14:27:37] [config] transformer-postprocess-emb: d
[2023-07-17 14:27:37] [config] transformer-postprocess-top: ""
[2023-07-17 14:27:37] [config] transformer-preprocess: ""
[2023-07-17 14:27:37] [config] transformer-tied-layers:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] transformer-train-position-embeddings: false
[2023-07-17 14:27:37] [config] tsv: false
[2023-07-17 14:27:37] [config] tsv-fields: 0
[2023-07-17 14:27:37] [config] type: amun
[2023-07-17 14:27:37] [config] ulr: false
[2023-07-17 14:27:37] [config] ulr-dim-emb: 0
[2023-07-17 14:27:37] [config] ulr-dropout: 0
[2023-07-17 14:27:37] [config] ulr-keys-vectors: ""
[2023-07-17 14:27:37] [config] ulr-query-vectors: ""
[2023-07-17 14:27:37] [config] ulr-softmax-temperature: 1
[2023-07-17 14:27:37] [config] ulr-trainable-transformation: false
[2023-07-17 14:27:37] [config] unlikelihood-loss: false
[2023-07-17 14:27:37] [config] valid-freq: 50000000
[2023-07-17 14:27:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 14:27:37] [config] valid-max-length: 1000
[2023-07-17 14:27:37] [config] valid-metrics:
[2023-07-17 14:27:37] [config]   - cross-entropy
[2023-07-17 14:27:37] [config]   - translation
[2023-07-17 14:27:37] [config] valid-mini-batch: 32
[2023-07-17 14:27:37] [config] valid-reset-stalled: false
[2023-07-17 14:27:37] [config] valid-script-args:
[2023-07-17 14:27:37] [config]   []
[2023-07-17 14:27:37] [config] valid-script-path: ""
[2023-07-17 14:27:37] [config] valid-sets:
[2023-07-17 14:27:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 14:27:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 14:27:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 14:27:37] [config] vocabs:
[2023-07-17 14:27:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 14:27:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 14:27:37] [config] word-penalty: 0
[2023-07-17 14:27:37] [config] word-scores: false
[2023-07-17 14:27:37] [config] workspace: 5500
[2023-07-17 14:27:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 14:27:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 14:27:37] [training] Using single-device training
[2023-07-17 14:27:37] Synced seed 1234
[2023-07-17 14:27:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 14:27:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 14:27:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 14:27:37] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 14:27:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 14:27:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 14:27:37] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 14:27:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 14:27:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 14:27:38] [comm] Using global sharding
[2023-07-17 14:27:39] [comm] NCCLCommunicators constructed successfully
[2023-07-17 14:27:39] [training] Using 1 GPUs
[2023-07-17 14:27:39] [logits] Applying loss function for 1 factor(s)
[2023-07-17 14:27:39] [memory] Reserving 80 MB, device gpu0
[2023-07-17 14:27:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 14:27:39] [memory] Reserving 80 MB, device gpu0
[2023-07-17 15:03:58] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 15:03:59] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 15:03:59] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x5635b027b231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x5635b02d0ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x5635b02e7d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x5635b06fbe1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x5635b070a348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x5635b01afb9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x5635b00d12c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5635b0088b9c]    main                                               + 0x3c
[0x7f5b44eab0b3]    __libc_start_main                                  + 0xf3
[0x5635b00cfcbe]    _start                                             + 0x2e

[2023-07-17 15:04:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 15:04:00] [marian] Running on node22.datos.cluster.uy as process 13501 with command line:
[2023-07-17 15:04:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 15:04:00] [config] after: 0e
[2023-07-17 15:04:00] [config] after-batches: 0
[2023-07-17 15:04:00] [config] after-epochs: 30
[2023-07-17 15:04:00] [config] all-caps-every: 0
[2023-07-17 15:04:00] [config] allow-unk: false
[2023-07-17 15:04:00] [config] authors: false
[2023-07-17 15:04:00] [config] beam-size: 12
[2023-07-17 15:04:00] [config] bert-class-symbol: "[CLS]"
[2023-07-17 15:04:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 15:04:00] [config] bert-masking-fraction: 0.15
[2023-07-17 15:04:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 15:04:00] [config] bert-train-type-embeddings: true
[2023-07-17 15:04:00] [config] bert-type-vocab-size: 2
[2023-07-17 15:04:00] [config] build-info: ""
[2023-07-17 15:04:00] [config] check-gradient-nan: false
[2023-07-17 15:04:00] [config] check-nan: false
[2023-07-17 15:04:00] [config] cite: false
[2023-07-17 15:04:00] [config] clip-norm: 1
[2023-07-17 15:04:00] [config] cost-scaling:
[2023-07-17 15:04:00] [config]   - 256.f
[2023-07-17 15:04:00] [config]   - 1000
[2023-07-17 15:04:00] [config]   - 2.f
[2023-07-17 15:04:00] [config]   - 256.f
[2023-07-17 15:04:00] [config] cost-type: ce-sum
[2023-07-17 15:04:00] [config] cpu-threads: 0
[2023-07-17 15:04:00] [config] data-threads: 8
[2023-07-17 15:04:00] [config] data-weighting: ""
[2023-07-17 15:04:00] [config] data-weighting-type: sentence
[2023-07-17 15:04:00] [config] dec-cell: gru
[2023-07-17 15:04:00] [config] dec-cell-base-depth: 2
[2023-07-17 15:04:00] [config] dec-cell-high-depth: 1
[2023-07-17 15:04:00] [config] dec-depth: 1
[2023-07-17 15:04:00] [config] devices:
[2023-07-17 15:04:00] [config]   - 0
[2023-07-17 15:04:00] [config] dim-emb: 512
[2023-07-17 15:04:00] [config] dim-rnn: 1024
[2023-07-17 15:04:00] [config] dim-vocabs:
[2023-07-17 15:04:00] [config]   - 16384
[2023-07-17 15:04:00] [config]   - 16384
[2023-07-17 15:04:00] [config] disp-first: 0
[2023-07-17 15:04:00] [config] disp-freq: 1000u
[2023-07-17 15:04:00] [config] disp-label-counts: true
[2023-07-17 15:04:00] [config] dropout-rnn: 0
[2023-07-17 15:04:00] [config] dropout-src: 0
[2023-07-17 15:04:00] [config] dropout-trg: 0
[2023-07-17 15:04:00] [config] dump-config: ""
[2023-07-17 15:04:00] [config] dynamic-gradient-scaling:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] early-stopping: 5
[2023-07-17 15:04:00] [config] early-stopping-on: first
[2023-07-17 15:04:00] [config] embedding-fix-src: false
[2023-07-17 15:04:00] [config] embedding-fix-trg: false
[2023-07-17 15:04:00] [config] embedding-normalization: false
[2023-07-17 15:04:00] [config] embedding-vectors:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] enc-cell: gru
[2023-07-17 15:04:00] [config] enc-cell-depth: 1
[2023-07-17 15:04:00] [config] enc-depth: 1
[2023-07-17 15:04:00] [config] enc-type: bidirectional
[2023-07-17 15:04:00] [config] english-title-case-every: 0
[2023-07-17 15:04:00] [config] exponential-smoothing: 0
[2023-07-17 15:04:00] [config] factor-weight: 1
[2023-07-17 15:04:00] [config] factors-combine: sum
[2023-07-17 15:04:00] [config] factors-dim-emb: 0
[2023-07-17 15:04:00] [config] gradient-checkpointing: false
[2023-07-17 15:04:00] [config] gradient-norm-average-window: 100
[2023-07-17 15:04:00] [config] guided-alignment: none
[2023-07-17 15:04:00] [config] guided-alignment-cost: mse
[2023-07-17 15:04:00] [config] guided-alignment-weight: 0.1
[2023-07-17 15:04:00] [config] ignore-model-config: false
[2023-07-17 15:04:00] [config] input-types:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] interpolate-env-vars: false
[2023-07-17 15:04:00] [config] keep-best: false
[2023-07-17 15:04:00] [config] label-smoothing: 0
[2023-07-17 15:04:00] [config] layer-normalization: false
[2023-07-17 15:04:00] [config] learn-rate: 0.0001
[2023-07-17 15:04:00] [config] lemma-dependency: ""
[2023-07-17 15:04:00] [config] lemma-dim-emb: 0
[2023-07-17 15:04:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 15:04:00] [config] log-level: info
[2023-07-17 15:04:00] [config] log-time-zone: ""
[2023-07-17 15:04:00] [config] logical-epoch:
[2023-07-17 15:04:00] [config]   - 1e
[2023-07-17 15:04:00] [config]   - 0
[2023-07-17 15:04:00] [config] lr-decay: 0
[2023-07-17 15:04:00] [config] lr-decay-freq: 50000
[2023-07-17 15:04:00] [config] lr-decay-inv-sqrt:
[2023-07-17 15:04:00] [config]   - 0
[2023-07-17 15:04:00] [config] lr-decay-repeat-warmup: false
[2023-07-17 15:04:00] [config] lr-decay-reset-optimizer: false
[2023-07-17 15:04:00] [config] lr-decay-start:
[2023-07-17 15:04:00] [config]   - 10
[2023-07-17 15:04:00] [config]   - 1
[2023-07-17 15:04:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 15:04:00] [config] lr-report: false
[2023-07-17 15:04:00] [config] lr-warmup: 0
[2023-07-17 15:04:00] [config] lr-warmup-at-reload: false
[2023-07-17 15:04:00] [config] lr-warmup-cycle: false
[2023-07-17 15:04:00] [config] lr-warmup-start-rate: 0
[2023-07-17 15:04:00] [config] max-length: 200
[2023-07-17 15:04:00] [config] max-length-crop: true
[2023-07-17 15:04:00] [config] max-length-factor: 3
[2023-07-17 15:04:00] [config] maxi-batch: 100
[2023-07-17 15:04:00] [config] maxi-batch-sort: trg
[2023-07-17 15:04:00] [config] mini-batch: 64
[2023-07-17 15:04:00] [config] mini-batch-fit: true
[2023-07-17 15:04:00] [config] mini-batch-fit-step: 10
[2023-07-17 15:04:00] [config] mini-batch-round-up: true
[2023-07-17 15:04:00] [config] mini-batch-track-lr: false
[2023-07-17 15:04:00] [config] mini-batch-warmup: 0
[2023-07-17 15:04:00] [config] mini-batch-words: 0
[2023-07-17 15:04:00] [config] mini-batch-words-ref: 0
[2023-07-17 15:04:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 15:04:00] [config] multi-loss-type: sum
[2023-07-17 15:04:00] [config] n-best: false
[2023-07-17 15:04:00] [config] no-nccl: false
[2023-07-17 15:04:00] [config] no-reload: false
[2023-07-17 15:04:00] [config] no-restore-corpus: false
[2023-07-17 15:04:00] [config] normalize: 0
[2023-07-17 15:04:00] [config] normalize-gradient: false
[2023-07-17 15:04:00] [config] num-devices: 0
[2023-07-17 15:04:00] [config] optimizer: adam
[2023-07-17 15:04:00] [config] optimizer-delay: 1
[2023-07-17 15:04:00] [config] optimizer-params:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] output-omit-bias: false
[2023-07-17 15:04:00] [config] overwrite: true
[2023-07-17 15:04:00] [config] precision:
[2023-07-17 15:04:00] [config]   - float16
[2023-07-17 15:04:00] [config]   - float32
[2023-07-17 15:04:00] [config] pretrained-model: ""
[2023-07-17 15:04:00] [config] quantize-biases: false
[2023-07-17 15:04:00] [config] quantize-bits: 0
[2023-07-17 15:04:00] [config] quantize-log-based: false
[2023-07-17 15:04:00] [config] quantize-optimization-steps: 0
[2023-07-17 15:04:00] [config] quiet: false
[2023-07-17 15:04:00] [config] quiet-translation: true
[2023-07-17 15:04:00] [config] relative-paths: false
[2023-07-17 15:04:00] [config] right-left: false
[2023-07-17 15:04:00] [config] save-freq: 10000u
[2023-07-17 15:04:00] [config] seed: 1234
[2023-07-17 15:04:00] [config] sentencepiece-alphas:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] sentencepiece-max-lines: 2000000
[2023-07-17 15:04:00] [config] sentencepiece-options: ""
[2023-07-17 15:04:00] [config] sharding: global
[2023-07-17 15:04:00] [config] shuffle: data
[2023-07-17 15:04:00] [config] shuffle-in-ram: false
[2023-07-17 15:04:00] [config] sigterm: save-and-exit
[2023-07-17 15:04:00] [config] skip: false
[2023-07-17 15:04:00] [config] sqlite: ""
[2023-07-17 15:04:00] [config] sqlite-drop: false
[2023-07-17 15:04:00] [config] sync-freq: 200u
[2023-07-17 15:04:00] [config] sync-sgd: false
[2023-07-17 15:04:00] [config] tempdir: /tmp
[2023-07-17 15:04:00] [config] tied-embeddings: false
[2023-07-17 15:04:00] [config] tied-embeddings-all: true
[2023-07-17 15:04:00] [config] tied-embeddings-src: false
[2023-07-17 15:04:00] [config] train-embedder-rank:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] train-sets:
[2023-07-17 15:04:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 15:04:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 15:04:00] [config] transformer-aan-activation: swish
[2023-07-17 15:04:00] [config] transformer-aan-depth: 2
[2023-07-17 15:04:00] [config] transformer-aan-nogate: false
[2023-07-17 15:04:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 15:04:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 15:04:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 15:04:00] [config] transformer-depth-scaling: false
[2023-07-17 15:04:00] [config] transformer-dim-aan: 2048
[2023-07-17 15:04:00] [config] transformer-dim-ffn: 2048
[2023-07-17 15:04:00] [config] transformer-dropout: 0
[2023-07-17 15:04:00] [config] transformer-dropout-attention: 0
[2023-07-17 15:04:00] [config] transformer-dropout-ffn: 0
[2023-07-17 15:04:00] [config] transformer-ffn-activation: swish
[2023-07-17 15:04:00] [config] transformer-ffn-depth: 2
[2023-07-17 15:04:00] [config] transformer-guided-alignment-layer: last
[2023-07-17 15:04:00] [config] transformer-heads: 8
[2023-07-17 15:04:00] [config] transformer-no-projection: false
[2023-07-17 15:04:00] [config] transformer-pool: false
[2023-07-17 15:04:00] [config] transformer-postprocess: dan
[2023-07-17 15:04:00] [config] transformer-postprocess-emb: d
[2023-07-17 15:04:00] [config] transformer-postprocess-top: ""
[2023-07-17 15:04:00] [config] transformer-preprocess: ""
[2023-07-17 15:04:00] [config] transformer-tied-layers:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] transformer-train-position-embeddings: false
[2023-07-17 15:04:00] [config] tsv: false
[2023-07-17 15:04:00] [config] tsv-fields: 0
[2023-07-17 15:04:00] [config] type: amun
[2023-07-17 15:04:00] [config] ulr: false
[2023-07-17 15:04:00] [config] ulr-dim-emb: 0
[2023-07-17 15:04:00] [config] ulr-dropout: 0
[2023-07-17 15:04:00] [config] ulr-keys-vectors: ""
[2023-07-17 15:04:00] [config] ulr-query-vectors: ""
[2023-07-17 15:04:00] [config] ulr-softmax-temperature: 1
[2023-07-17 15:04:00] [config] ulr-trainable-transformation: false
[2023-07-17 15:04:00] [config] unlikelihood-loss: false
[2023-07-17 15:04:00] [config] valid-freq: 50000000
[2023-07-17 15:04:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 15:04:00] [config] valid-max-length: 1000
[2023-07-17 15:04:00] [config] valid-metrics:
[2023-07-17 15:04:00] [config]   - cross-entropy
[2023-07-17 15:04:00] [config]   - translation
[2023-07-17 15:04:00] [config] valid-mini-batch: 32
[2023-07-17 15:04:00] [config] valid-reset-stalled: false
[2023-07-17 15:04:00] [config] valid-script-args:
[2023-07-17 15:04:00] [config]   []
[2023-07-17 15:04:00] [config] valid-script-path: ""
[2023-07-17 15:04:00] [config] valid-sets:
[2023-07-17 15:04:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 15:04:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 15:04:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 15:04:00] [config] vocabs:
[2023-07-17 15:04:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 15:04:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 15:04:00] [config] word-penalty: 0
[2023-07-17 15:04:00] [config] word-scores: false
[2023-07-17 15:04:00] [config] workspace: 5500
[2023-07-17 15:04:00] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 15:04:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 15:04:00] [training] Using single-device training
[2023-07-17 15:04:00] Synced seed 1234
[2023-07-17 15:04:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 15:04:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 15:04:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 15:04:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 15:04:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 15:04:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 15:04:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 15:04:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 15:04:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 15:04:01] [comm] Using global sharding
[2023-07-17 15:04:01] [comm] NCCLCommunicators constructed successfully
[2023-07-17 15:04:01] [training] Using 1 GPUs
[2023-07-17 15:04:01] [logits] Applying loss function for 1 factor(s)
[2023-07-17 15:04:01] [memory] Reserving 80 MB, device gpu0
[2023-07-17 15:04:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 15:04:02] [memory] Reserving 80 MB, device gpu0
[2023-07-17 15:40:40] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 15:40:40] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 15:40:40] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x55fe3d043231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x55fe3d098ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x55fe3d0afd5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x55fe3d4c3e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x55fe3d4d2348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55fe3cf77b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55fe3ce992c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55fe3ce50b9c]    main                                               + 0x3c
[0x7f36cd4240b3]    __libc_start_main                                  + 0xf3
[0x55fe3ce97cbe]    _start                                             + 0x2e

[2023-07-17 15:40:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 15:40:41] [marian] Running on node22.datos.cluster.uy as process 15762 with command line:
[2023-07-17 15:40:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 15:40:41] [config] after: 0e
[2023-07-17 15:40:41] [config] after-batches: 0
[2023-07-17 15:40:41] [config] after-epochs: 40
[2023-07-17 15:40:41] [config] all-caps-every: 0
[2023-07-17 15:40:41] [config] allow-unk: false
[2023-07-17 15:40:41] [config] authors: false
[2023-07-17 15:40:41] [config] beam-size: 12
[2023-07-17 15:40:41] [config] bert-class-symbol: "[CLS]"
[2023-07-17 15:40:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 15:40:41] [config] bert-masking-fraction: 0.15
[2023-07-17 15:40:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 15:40:41] [config] bert-train-type-embeddings: true
[2023-07-17 15:40:41] [config] bert-type-vocab-size: 2
[2023-07-17 15:40:41] [config] build-info: ""
[2023-07-17 15:40:41] [config] check-gradient-nan: false
[2023-07-17 15:40:41] [config] check-nan: false
[2023-07-17 15:40:41] [config] cite: false
[2023-07-17 15:40:41] [config] clip-norm: 1
[2023-07-17 15:40:41] [config] cost-scaling:
[2023-07-17 15:40:41] [config]   - 256.f
[2023-07-17 15:40:41] [config]   - 1000
[2023-07-17 15:40:41] [config]   - 2.f
[2023-07-17 15:40:41] [config]   - 256.f
[2023-07-17 15:40:41] [config] cost-type: ce-sum
[2023-07-17 15:40:41] [config] cpu-threads: 0
[2023-07-17 15:40:41] [config] data-threads: 8
[2023-07-17 15:40:41] [config] data-weighting: ""
[2023-07-17 15:40:41] [config] data-weighting-type: sentence
[2023-07-17 15:40:41] [config] dec-cell: gru
[2023-07-17 15:40:41] [config] dec-cell-base-depth: 2
[2023-07-17 15:40:41] [config] dec-cell-high-depth: 1
[2023-07-17 15:40:41] [config] dec-depth: 1
[2023-07-17 15:40:41] [config] devices:
[2023-07-17 15:40:41] [config]   - 0
[2023-07-17 15:40:41] [config] dim-emb: 512
[2023-07-17 15:40:41] [config] dim-rnn: 1024
[2023-07-17 15:40:41] [config] dim-vocabs:
[2023-07-17 15:40:41] [config]   - 16384
[2023-07-17 15:40:41] [config]   - 16384
[2023-07-17 15:40:41] [config] disp-first: 0
[2023-07-17 15:40:41] [config] disp-freq: 1000u
[2023-07-17 15:40:41] [config] disp-label-counts: true
[2023-07-17 15:40:41] [config] dropout-rnn: 0
[2023-07-17 15:40:41] [config] dropout-src: 0
[2023-07-17 15:40:41] [config] dropout-trg: 0
[2023-07-17 15:40:41] [config] dump-config: ""
[2023-07-17 15:40:41] [config] dynamic-gradient-scaling:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] early-stopping: 5
[2023-07-17 15:40:41] [config] early-stopping-on: first
[2023-07-17 15:40:41] [config] embedding-fix-src: false
[2023-07-17 15:40:41] [config] embedding-fix-trg: false
[2023-07-17 15:40:41] [config] embedding-normalization: false
[2023-07-17 15:40:41] [config] embedding-vectors:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] enc-cell: gru
[2023-07-17 15:40:41] [config] enc-cell-depth: 1
[2023-07-17 15:40:41] [config] enc-depth: 1
[2023-07-17 15:40:41] [config] enc-type: bidirectional
[2023-07-17 15:40:41] [config] english-title-case-every: 0
[2023-07-17 15:40:41] [config] exponential-smoothing: 0
[2023-07-17 15:40:41] [config] factor-weight: 1
[2023-07-17 15:40:41] [config] factors-combine: sum
[2023-07-17 15:40:41] [config] factors-dim-emb: 0
[2023-07-17 15:40:41] [config] gradient-checkpointing: false
[2023-07-17 15:40:41] [config] gradient-norm-average-window: 100
[2023-07-17 15:40:41] [config] guided-alignment: none
[2023-07-17 15:40:41] [config] guided-alignment-cost: mse
[2023-07-17 15:40:41] [config] guided-alignment-weight: 0.1
[2023-07-17 15:40:41] [config] ignore-model-config: false
[2023-07-17 15:40:41] [config] input-types:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] interpolate-env-vars: false
[2023-07-17 15:40:41] [config] keep-best: false
[2023-07-17 15:40:41] [config] label-smoothing: 0
[2023-07-17 15:40:41] [config] layer-normalization: false
[2023-07-17 15:40:41] [config] learn-rate: 0.0001
[2023-07-17 15:40:41] [config] lemma-dependency: ""
[2023-07-17 15:40:41] [config] lemma-dim-emb: 0
[2023-07-17 15:40:41] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 15:40:41] [config] log-level: info
[2023-07-17 15:40:41] [config] log-time-zone: ""
[2023-07-17 15:40:41] [config] logical-epoch:
[2023-07-17 15:40:41] [config]   - 1e
[2023-07-17 15:40:41] [config]   - 0
[2023-07-17 15:40:41] [config] lr-decay: 0
[2023-07-17 15:40:41] [config] lr-decay-freq: 50000
[2023-07-17 15:40:41] [config] lr-decay-inv-sqrt:
[2023-07-17 15:40:41] [config]   - 0
[2023-07-17 15:40:41] [config] lr-decay-repeat-warmup: false
[2023-07-17 15:40:41] [config] lr-decay-reset-optimizer: false
[2023-07-17 15:40:41] [config] lr-decay-start:
[2023-07-17 15:40:41] [config]   - 10
[2023-07-17 15:40:41] [config]   - 1
[2023-07-17 15:40:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 15:40:41] [config] lr-report: false
[2023-07-17 15:40:41] [config] lr-warmup: 0
[2023-07-17 15:40:41] [config] lr-warmup-at-reload: false
[2023-07-17 15:40:41] [config] lr-warmup-cycle: false
[2023-07-17 15:40:41] [config] lr-warmup-start-rate: 0
[2023-07-17 15:40:41] [config] max-length: 200
[2023-07-17 15:40:41] [config] max-length-crop: true
[2023-07-17 15:40:41] [config] max-length-factor: 3
[2023-07-17 15:40:41] [config] maxi-batch: 100
[2023-07-17 15:40:41] [config] maxi-batch-sort: trg
[2023-07-17 15:40:41] [config] mini-batch: 64
[2023-07-17 15:40:41] [config] mini-batch-fit: true
[2023-07-17 15:40:41] [config] mini-batch-fit-step: 10
[2023-07-17 15:40:41] [config] mini-batch-round-up: true
[2023-07-17 15:40:41] [config] mini-batch-track-lr: false
[2023-07-17 15:40:41] [config] mini-batch-warmup: 0
[2023-07-17 15:40:41] [config] mini-batch-words: 0
[2023-07-17 15:40:41] [config] mini-batch-words-ref: 0
[2023-07-17 15:40:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 15:40:41] [config] multi-loss-type: sum
[2023-07-17 15:40:41] [config] n-best: false
[2023-07-17 15:40:41] [config] no-nccl: false
[2023-07-17 15:40:41] [config] no-reload: false
[2023-07-17 15:40:41] [config] no-restore-corpus: false
[2023-07-17 15:40:41] [config] normalize: 0
[2023-07-17 15:40:41] [config] normalize-gradient: false
[2023-07-17 15:40:41] [config] num-devices: 0
[2023-07-17 15:40:41] [config] optimizer: adam
[2023-07-17 15:40:41] [config] optimizer-delay: 1
[2023-07-17 15:40:41] [config] optimizer-params:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] output-omit-bias: false
[2023-07-17 15:40:41] [config] overwrite: true
[2023-07-17 15:40:41] [config] precision:
[2023-07-17 15:40:41] [config]   - float16
[2023-07-17 15:40:41] [config]   - float32
[2023-07-17 15:40:41] [config] pretrained-model: ""
[2023-07-17 15:40:41] [config] quantize-biases: false
[2023-07-17 15:40:41] [config] quantize-bits: 0
[2023-07-17 15:40:41] [config] quantize-log-based: false
[2023-07-17 15:40:41] [config] quantize-optimization-steps: 0
[2023-07-17 15:40:41] [config] quiet: false
[2023-07-17 15:40:41] [config] quiet-translation: true
[2023-07-17 15:40:41] [config] relative-paths: false
[2023-07-17 15:40:41] [config] right-left: false
[2023-07-17 15:40:41] [config] save-freq: 10000u
[2023-07-17 15:40:41] [config] seed: 1234
[2023-07-17 15:40:41] [config] sentencepiece-alphas:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] sentencepiece-max-lines: 2000000
[2023-07-17 15:40:41] [config] sentencepiece-options: ""
[2023-07-17 15:40:41] [config] sharding: global
[2023-07-17 15:40:41] [config] shuffle: data
[2023-07-17 15:40:41] [config] shuffle-in-ram: false
[2023-07-17 15:40:41] [config] sigterm: save-and-exit
[2023-07-17 15:40:41] [config] skip: false
[2023-07-17 15:40:41] [config] sqlite: ""
[2023-07-17 15:40:41] [config] sqlite-drop: false
[2023-07-17 15:40:41] [config] sync-freq: 200u
[2023-07-17 15:40:41] [config] sync-sgd: false
[2023-07-17 15:40:41] [config] tempdir: /tmp
[2023-07-17 15:40:41] [config] tied-embeddings: false
[2023-07-17 15:40:41] [config] tied-embeddings-all: true
[2023-07-17 15:40:41] [config] tied-embeddings-src: false
[2023-07-17 15:40:41] [config] train-embedder-rank:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] train-sets:
[2023-07-17 15:40:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 15:40:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 15:40:41] [config] transformer-aan-activation: swish
[2023-07-17 15:40:41] [config] transformer-aan-depth: 2
[2023-07-17 15:40:41] [config] transformer-aan-nogate: false
[2023-07-17 15:40:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 15:40:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 15:40:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 15:40:41] [config] transformer-depth-scaling: false
[2023-07-17 15:40:41] [config] transformer-dim-aan: 2048
[2023-07-17 15:40:41] [config] transformer-dim-ffn: 2048
[2023-07-17 15:40:41] [config] transformer-dropout: 0
[2023-07-17 15:40:41] [config] transformer-dropout-attention: 0
[2023-07-17 15:40:41] [config] transformer-dropout-ffn: 0
[2023-07-17 15:40:41] [config] transformer-ffn-activation: swish
[2023-07-17 15:40:41] [config] transformer-ffn-depth: 2
[2023-07-17 15:40:41] [config] transformer-guided-alignment-layer: last
[2023-07-17 15:40:41] [config] transformer-heads: 8
[2023-07-17 15:40:41] [config] transformer-no-projection: false
[2023-07-17 15:40:41] [config] transformer-pool: false
[2023-07-17 15:40:41] [config] transformer-postprocess: dan
[2023-07-17 15:40:41] [config] transformer-postprocess-emb: d
[2023-07-17 15:40:41] [config] transformer-postprocess-top: ""
[2023-07-17 15:40:41] [config] transformer-preprocess: ""
[2023-07-17 15:40:41] [config] transformer-tied-layers:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] transformer-train-position-embeddings: false
[2023-07-17 15:40:41] [config] tsv: false
[2023-07-17 15:40:41] [config] tsv-fields: 0
[2023-07-17 15:40:41] [config] type: amun
[2023-07-17 15:40:41] [config] ulr: false
[2023-07-17 15:40:41] [config] ulr-dim-emb: 0
[2023-07-17 15:40:41] [config] ulr-dropout: 0
[2023-07-17 15:40:41] [config] ulr-keys-vectors: ""
[2023-07-17 15:40:41] [config] ulr-query-vectors: ""
[2023-07-17 15:40:41] [config] ulr-softmax-temperature: 1
[2023-07-17 15:40:41] [config] ulr-trainable-transformation: false
[2023-07-17 15:40:41] [config] unlikelihood-loss: false
[2023-07-17 15:40:41] [config] valid-freq: 50000000
[2023-07-17 15:40:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 15:40:41] [config] valid-max-length: 1000
[2023-07-17 15:40:41] [config] valid-metrics:
[2023-07-17 15:40:41] [config]   - cross-entropy
[2023-07-17 15:40:41] [config]   - translation
[2023-07-17 15:40:41] [config] valid-mini-batch: 32
[2023-07-17 15:40:41] [config] valid-reset-stalled: false
[2023-07-17 15:40:41] [config] valid-script-args:
[2023-07-17 15:40:41] [config]   []
[2023-07-17 15:40:41] [config] valid-script-path: ""
[2023-07-17 15:40:41] [config] valid-sets:
[2023-07-17 15:40:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 15:40:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 15:40:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 15:40:41] [config] vocabs:
[2023-07-17 15:40:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 15:40:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 15:40:41] [config] word-penalty: 0
[2023-07-17 15:40:41] [config] word-scores: false
[2023-07-17 15:40:41] [config] workspace: 5500
[2023-07-17 15:40:41] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 15:40:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 15:40:41] [training] Using single-device training
[2023-07-17 15:40:41] Synced seed 1234
[2023-07-17 15:40:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 15:40:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 15:40:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 15:40:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 15:40:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 15:40:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 15:40:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 15:40:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 15:40:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 15:40:42] [comm] Using global sharding
[2023-07-17 15:40:42] [comm] NCCLCommunicators constructed successfully
[2023-07-17 15:40:42] [training] Using 1 GPUs
[2023-07-17 15:40:42] [logits] Applying loss function for 1 factor(s)
[2023-07-17 15:40:42] [memory] Reserving 80 MB, device gpu0
[2023-07-17 15:40:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 15:40:43] [memory] Reserving 80 MB, device gpu0
[2023-07-17 16:17:24] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 16:17:24] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 16:17:24] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x55d80b036231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x55d80b08bca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x55d80b0a2d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x55d80b4b6e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x55d80b4c5348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55d80af6ab9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55d80ae8c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55d80ae43b9c]    main                                               + 0x3c
[0x7fe06d1330b3]    __libc_start_main                                  + 0xf3
[0x55d80ae8acbe]    _start                                             + 0x2e

[2023-07-17 16:17:25] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 16:17:25] [marian] Running on node22.datos.cluster.uy as process 18039 with command line:
[2023-07-17 16:17:25] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 16:17:25] [config] after: 0e
[2023-07-17 16:17:25] [config] after-batches: 0
[2023-07-17 16:17:25] [config] after-epochs: 50
[2023-07-17 16:17:25] [config] all-caps-every: 0
[2023-07-17 16:17:25] [config] allow-unk: false
[2023-07-17 16:17:25] [config] authors: false
[2023-07-17 16:17:25] [config] beam-size: 12
[2023-07-17 16:17:25] [config] bert-class-symbol: "[CLS]"
[2023-07-17 16:17:25] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 16:17:25] [config] bert-masking-fraction: 0.15
[2023-07-17 16:17:25] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 16:17:25] [config] bert-train-type-embeddings: true
[2023-07-17 16:17:25] [config] bert-type-vocab-size: 2
[2023-07-17 16:17:25] [config] build-info: ""
[2023-07-17 16:17:25] [config] check-gradient-nan: false
[2023-07-17 16:17:25] [config] check-nan: false
[2023-07-17 16:17:25] [config] cite: false
[2023-07-17 16:17:25] [config] clip-norm: 1
[2023-07-17 16:17:25] [config] cost-scaling:
[2023-07-17 16:17:25] [config]   - 256.f
[2023-07-17 16:17:25] [config]   - 1000
[2023-07-17 16:17:25] [config]   - 2.f
[2023-07-17 16:17:25] [config]   - 256.f
[2023-07-17 16:17:25] [config] cost-type: ce-sum
[2023-07-17 16:17:25] [config] cpu-threads: 0
[2023-07-17 16:17:25] [config] data-threads: 8
[2023-07-17 16:17:25] [config] data-weighting: ""
[2023-07-17 16:17:25] [config] data-weighting-type: sentence
[2023-07-17 16:17:25] [config] dec-cell: gru
[2023-07-17 16:17:25] [config] dec-cell-base-depth: 2
[2023-07-17 16:17:25] [config] dec-cell-high-depth: 1
[2023-07-17 16:17:25] [config] dec-depth: 1
[2023-07-17 16:17:25] [config] devices:
[2023-07-17 16:17:25] [config]   - 0
[2023-07-17 16:17:25] [config] dim-emb: 512
[2023-07-17 16:17:25] [config] dim-rnn: 1024
[2023-07-17 16:17:25] [config] dim-vocabs:
[2023-07-17 16:17:25] [config]   - 16384
[2023-07-17 16:17:25] [config]   - 16384
[2023-07-17 16:17:25] [config] disp-first: 0
[2023-07-17 16:17:25] [config] disp-freq: 1000u
[2023-07-17 16:17:25] [config] disp-label-counts: true
[2023-07-17 16:17:25] [config] dropout-rnn: 0
[2023-07-17 16:17:25] [config] dropout-src: 0
[2023-07-17 16:17:25] [config] dropout-trg: 0
[2023-07-17 16:17:25] [config] dump-config: ""
[2023-07-17 16:17:25] [config] dynamic-gradient-scaling:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] early-stopping: 5
[2023-07-17 16:17:25] [config] early-stopping-on: first
[2023-07-17 16:17:25] [config] embedding-fix-src: false
[2023-07-17 16:17:25] [config] embedding-fix-trg: false
[2023-07-17 16:17:25] [config] embedding-normalization: false
[2023-07-17 16:17:25] [config] embedding-vectors:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] enc-cell: gru
[2023-07-17 16:17:25] [config] enc-cell-depth: 1
[2023-07-17 16:17:25] [config] enc-depth: 1
[2023-07-17 16:17:25] [config] enc-type: bidirectional
[2023-07-17 16:17:25] [config] english-title-case-every: 0
[2023-07-17 16:17:25] [config] exponential-smoothing: 0
[2023-07-17 16:17:25] [config] factor-weight: 1
[2023-07-17 16:17:25] [config] factors-combine: sum
[2023-07-17 16:17:25] [config] factors-dim-emb: 0
[2023-07-17 16:17:25] [config] gradient-checkpointing: false
[2023-07-17 16:17:25] [config] gradient-norm-average-window: 100
[2023-07-17 16:17:25] [config] guided-alignment: none
[2023-07-17 16:17:25] [config] guided-alignment-cost: mse
[2023-07-17 16:17:25] [config] guided-alignment-weight: 0.1
[2023-07-17 16:17:25] [config] ignore-model-config: false
[2023-07-17 16:17:25] [config] input-types:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] interpolate-env-vars: false
[2023-07-17 16:17:25] [config] keep-best: false
[2023-07-17 16:17:25] [config] label-smoothing: 0
[2023-07-17 16:17:25] [config] layer-normalization: false
[2023-07-17 16:17:25] [config] learn-rate: 0.0001
[2023-07-17 16:17:25] [config] lemma-dependency: ""
[2023-07-17 16:17:25] [config] lemma-dim-emb: 0
[2023-07-17 16:17:25] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 16:17:25] [config] log-level: info
[2023-07-17 16:17:25] [config] log-time-zone: ""
[2023-07-17 16:17:25] [config] logical-epoch:
[2023-07-17 16:17:25] [config]   - 1e
[2023-07-17 16:17:25] [config]   - 0
[2023-07-17 16:17:25] [config] lr-decay: 0
[2023-07-17 16:17:25] [config] lr-decay-freq: 50000
[2023-07-17 16:17:25] [config] lr-decay-inv-sqrt:
[2023-07-17 16:17:25] [config]   - 0
[2023-07-17 16:17:25] [config] lr-decay-repeat-warmup: false
[2023-07-17 16:17:25] [config] lr-decay-reset-optimizer: false
[2023-07-17 16:17:25] [config] lr-decay-start:
[2023-07-17 16:17:25] [config]   - 10
[2023-07-17 16:17:25] [config]   - 1
[2023-07-17 16:17:25] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 16:17:25] [config] lr-report: false
[2023-07-17 16:17:25] [config] lr-warmup: 0
[2023-07-17 16:17:25] [config] lr-warmup-at-reload: false
[2023-07-17 16:17:25] [config] lr-warmup-cycle: false
[2023-07-17 16:17:25] [config] lr-warmup-start-rate: 0
[2023-07-17 16:17:25] [config] max-length: 200
[2023-07-17 16:17:25] [config] max-length-crop: true
[2023-07-17 16:17:25] [config] max-length-factor: 3
[2023-07-17 16:17:25] [config] maxi-batch: 100
[2023-07-17 16:17:25] [config] maxi-batch-sort: trg
[2023-07-17 16:17:25] [config] mini-batch: 64
[2023-07-17 16:17:25] [config] mini-batch-fit: true
[2023-07-17 16:17:25] [config] mini-batch-fit-step: 10
[2023-07-17 16:17:25] [config] mini-batch-round-up: true
[2023-07-17 16:17:25] [config] mini-batch-track-lr: false
[2023-07-17 16:17:25] [config] mini-batch-warmup: 0
[2023-07-17 16:17:25] [config] mini-batch-words: 0
[2023-07-17 16:17:25] [config] mini-batch-words-ref: 0
[2023-07-17 16:17:25] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 16:17:25] [config] multi-loss-type: sum
[2023-07-17 16:17:25] [config] n-best: false
[2023-07-17 16:17:25] [config] no-nccl: false
[2023-07-17 16:17:25] [config] no-reload: false
[2023-07-17 16:17:25] [config] no-restore-corpus: false
[2023-07-17 16:17:25] [config] normalize: 0
[2023-07-17 16:17:25] [config] normalize-gradient: false
[2023-07-17 16:17:25] [config] num-devices: 0
[2023-07-17 16:17:25] [config] optimizer: adam
[2023-07-17 16:17:25] [config] optimizer-delay: 1
[2023-07-17 16:17:25] [config] optimizer-params:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] output-omit-bias: false
[2023-07-17 16:17:25] [config] overwrite: true
[2023-07-17 16:17:25] [config] precision:
[2023-07-17 16:17:25] [config]   - float16
[2023-07-17 16:17:25] [config]   - float32
[2023-07-17 16:17:25] [config] pretrained-model: ""
[2023-07-17 16:17:25] [config] quantize-biases: false
[2023-07-17 16:17:25] [config] quantize-bits: 0
[2023-07-17 16:17:25] [config] quantize-log-based: false
[2023-07-17 16:17:25] [config] quantize-optimization-steps: 0
[2023-07-17 16:17:25] [config] quiet: false
[2023-07-17 16:17:25] [config] quiet-translation: true
[2023-07-17 16:17:25] [config] relative-paths: false
[2023-07-17 16:17:25] [config] right-left: false
[2023-07-17 16:17:25] [config] save-freq: 10000u
[2023-07-17 16:17:25] [config] seed: 1234
[2023-07-17 16:17:25] [config] sentencepiece-alphas:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] sentencepiece-max-lines: 2000000
[2023-07-17 16:17:25] [config] sentencepiece-options: ""
[2023-07-17 16:17:25] [config] sharding: global
[2023-07-17 16:17:25] [config] shuffle: data
[2023-07-17 16:17:25] [config] shuffle-in-ram: false
[2023-07-17 16:17:25] [config] sigterm: save-and-exit
[2023-07-17 16:17:25] [config] skip: false
[2023-07-17 16:17:25] [config] sqlite: ""
[2023-07-17 16:17:25] [config] sqlite-drop: false
[2023-07-17 16:17:25] [config] sync-freq: 200u
[2023-07-17 16:17:25] [config] sync-sgd: false
[2023-07-17 16:17:25] [config] tempdir: /tmp
[2023-07-17 16:17:25] [config] tied-embeddings: false
[2023-07-17 16:17:25] [config] tied-embeddings-all: true
[2023-07-17 16:17:25] [config] tied-embeddings-src: false
[2023-07-17 16:17:25] [config] train-embedder-rank:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] train-sets:
[2023-07-17 16:17:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 16:17:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 16:17:25] [config] transformer-aan-activation: swish
[2023-07-17 16:17:25] [config] transformer-aan-depth: 2
[2023-07-17 16:17:25] [config] transformer-aan-nogate: false
[2023-07-17 16:17:25] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 16:17:25] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 16:17:25] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 16:17:25] [config] transformer-depth-scaling: false
[2023-07-17 16:17:25] [config] transformer-dim-aan: 2048
[2023-07-17 16:17:25] [config] transformer-dim-ffn: 2048
[2023-07-17 16:17:25] [config] transformer-dropout: 0
[2023-07-17 16:17:25] [config] transformer-dropout-attention: 0
[2023-07-17 16:17:25] [config] transformer-dropout-ffn: 0
[2023-07-17 16:17:25] [config] transformer-ffn-activation: swish
[2023-07-17 16:17:25] [config] transformer-ffn-depth: 2
[2023-07-17 16:17:25] [config] transformer-guided-alignment-layer: last
[2023-07-17 16:17:25] [config] transformer-heads: 8
[2023-07-17 16:17:25] [config] transformer-no-projection: false
[2023-07-17 16:17:25] [config] transformer-pool: false
[2023-07-17 16:17:25] [config] transformer-postprocess: dan
[2023-07-17 16:17:25] [config] transformer-postprocess-emb: d
[2023-07-17 16:17:25] [config] transformer-postprocess-top: ""
[2023-07-17 16:17:25] [config] transformer-preprocess: ""
[2023-07-17 16:17:25] [config] transformer-tied-layers:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] transformer-train-position-embeddings: false
[2023-07-17 16:17:25] [config] tsv: false
[2023-07-17 16:17:25] [config] tsv-fields: 0
[2023-07-17 16:17:25] [config] type: amun
[2023-07-17 16:17:25] [config] ulr: false
[2023-07-17 16:17:25] [config] ulr-dim-emb: 0
[2023-07-17 16:17:25] [config] ulr-dropout: 0
[2023-07-17 16:17:25] [config] ulr-keys-vectors: ""
[2023-07-17 16:17:25] [config] ulr-query-vectors: ""
[2023-07-17 16:17:25] [config] ulr-softmax-temperature: 1
[2023-07-17 16:17:25] [config] ulr-trainable-transformation: false
[2023-07-17 16:17:25] [config] unlikelihood-loss: false
[2023-07-17 16:17:25] [config] valid-freq: 50000000
[2023-07-17 16:17:25] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 16:17:25] [config] valid-max-length: 1000
[2023-07-17 16:17:25] [config] valid-metrics:
[2023-07-17 16:17:25] [config]   - cross-entropy
[2023-07-17 16:17:25] [config]   - translation
[2023-07-17 16:17:25] [config] valid-mini-batch: 32
[2023-07-17 16:17:25] [config] valid-reset-stalled: false
[2023-07-17 16:17:25] [config] valid-script-args:
[2023-07-17 16:17:25] [config]   []
[2023-07-17 16:17:25] [config] valid-script-path: ""
[2023-07-17 16:17:25] [config] valid-sets:
[2023-07-17 16:17:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 16:17:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 16:17:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 16:17:25] [config] vocabs:
[2023-07-17 16:17:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 16:17:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 16:17:25] [config] word-penalty: 0
[2023-07-17 16:17:25] [config] word-scores: false
[2023-07-17 16:17:25] [config] workspace: 5500
[2023-07-17 16:17:25] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 16:17:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 16:17:25] [training] Using single-device training
[2023-07-17 16:17:25] Synced seed 1234
[2023-07-17 16:17:25] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 16:17:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 16:17:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 16:17:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 16:17:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 16:17:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 16:17:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 16:17:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 16:17:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 16:17:27] [comm] Using global sharding
[2023-07-17 16:17:27] [comm] NCCLCommunicators constructed successfully
[2023-07-17 16:17:27] [training] Using 1 GPUs
[2023-07-17 16:17:27] [logits] Applying loss function for 1 factor(s)
[2023-07-17 16:17:27] [memory] Reserving 80 MB, device gpu0
[2023-07-17 16:17:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 16:17:27] [memory] Reserving 80 MB, device gpu0
[2023-07-17 16:53:43] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 16:53:43] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 16:53:43] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x55fa4bf4c231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x55fa4bfa1ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x55fa4bfb8d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x55fa4c3cce1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x55fa4c3db348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55fa4be80b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55fa4bda22c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55fa4bd59b9c]    main                                               + 0x3c
[0x7f6a7e72b0b3]    __libc_start_main                                  + 0xf3
[0x55fa4bda0cbe]    _start                                             + 0x2e

[2023-07-17 16:53:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 16:53:44] [marian] Running on node22.datos.cluster.uy as process 20277 with command line:
[2023-07-17 16:53:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 16:53:44] [config] after: 0e
[2023-07-17 16:53:44] [config] after-batches: 0
[2023-07-17 16:53:44] [config] after-epochs: 60
[2023-07-17 16:53:44] [config] all-caps-every: 0
[2023-07-17 16:53:44] [config] allow-unk: false
[2023-07-17 16:53:44] [config] authors: false
[2023-07-17 16:53:44] [config] beam-size: 12
[2023-07-17 16:53:44] [config] bert-class-symbol: "[CLS]"
[2023-07-17 16:53:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 16:53:44] [config] bert-masking-fraction: 0.15
[2023-07-17 16:53:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 16:53:44] [config] bert-train-type-embeddings: true
[2023-07-17 16:53:44] [config] bert-type-vocab-size: 2
[2023-07-17 16:53:44] [config] build-info: ""
[2023-07-17 16:53:44] [config] check-gradient-nan: false
[2023-07-17 16:53:44] [config] check-nan: false
[2023-07-17 16:53:44] [config] cite: false
[2023-07-17 16:53:44] [config] clip-norm: 1
[2023-07-17 16:53:44] [config] cost-scaling:
[2023-07-17 16:53:44] [config]   - 256.f
[2023-07-17 16:53:44] [config]   - 1000
[2023-07-17 16:53:44] [config]   - 2.f
[2023-07-17 16:53:44] [config]   - 256.f
[2023-07-17 16:53:44] [config] cost-type: ce-sum
[2023-07-17 16:53:44] [config] cpu-threads: 0
[2023-07-17 16:53:44] [config] data-threads: 8
[2023-07-17 16:53:44] [config] data-weighting: ""
[2023-07-17 16:53:44] [config] data-weighting-type: sentence
[2023-07-17 16:53:44] [config] dec-cell: gru
[2023-07-17 16:53:44] [config] dec-cell-base-depth: 2
[2023-07-17 16:53:44] [config] dec-cell-high-depth: 1
[2023-07-17 16:53:44] [config] dec-depth: 1
[2023-07-17 16:53:44] [config] devices:
[2023-07-17 16:53:44] [config]   - 0
[2023-07-17 16:53:44] [config] dim-emb: 512
[2023-07-17 16:53:44] [config] dim-rnn: 1024
[2023-07-17 16:53:44] [config] dim-vocabs:
[2023-07-17 16:53:44] [config]   - 16384
[2023-07-17 16:53:44] [config]   - 16384
[2023-07-17 16:53:44] [config] disp-first: 0
[2023-07-17 16:53:44] [config] disp-freq: 1000u
[2023-07-17 16:53:44] [config] disp-label-counts: true
[2023-07-17 16:53:44] [config] dropout-rnn: 0
[2023-07-17 16:53:44] [config] dropout-src: 0
[2023-07-17 16:53:44] [config] dropout-trg: 0
[2023-07-17 16:53:44] [config] dump-config: ""
[2023-07-17 16:53:44] [config] dynamic-gradient-scaling:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] early-stopping: 5
[2023-07-17 16:53:44] [config] early-stopping-on: first
[2023-07-17 16:53:44] [config] embedding-fix-src: false
[2023-07-17 16:53:44] [config] embedding-fix-trg: false
[2023-07-17 16:53:44] [config] embedding-normalization: false
[2023-07-17 16:53:44] [config] embedding-vectors:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] enc-cell: gru
[2023-07-17 16:53:44] [config] enc-cell-depth: 1
[2023-07-17 16:53:44] [config] enc-depth: 1
[2023-07-17 16:53:44] [config] enc-type: bidirectional
[2023-07-17 16:53:44] [config] english-title-case-every: 0
[2023-07-17 16:53:44] [config] exponential-smoothing: 0
[2023-07-17 16:53:44] [config] factor-weight: 1
[2023-07-17 16:53:44] [config] factors-combine: sum
[2023-07-17 16:53:44] [config] factors-dim-emb: 0
[2023-07-17 16:53:44] [config] gradient-checkpointing: false
[2023-07-17 16:53:44] [config] gradient-norm-average-window: 100
[2023-07-17 16:53:44] [config] guided-alignment: none
[2023-07-17 16:53:44] [config] guided-alignment-cost: mse
[2023-07-17 16:53:44] [config] guided-alignment-weight: 0.1
[2023-07-17 16:53:44] [config] ignore-model-config: false
[2023-07-17 16:53:44] [config] input-types:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] interpolate-env-vars: false
[2023-07-17 16:53:44] [config] keep-best: false
[2023-07-17 16:53:44] [config] label-smoothing: 0
[2023-07-17 16:53:44] [config] layer-normalization: false
[2023-07-17 16:53:44] [config] learn-rate: 0.0001
[2023-07-17 16:53:44] [config] lemma-dependency: ""
[2023-07-17 16:53:44] [config] lemma-dim-emb: 0
[2023-07-17 16:53:44] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 16:53:44] [config] log-level: info
[2023-07-17 16:53:44] [config] log-time-zone: ""
[2023-07-17 16:53:44] [config] logical-epoch:
[2023-07-17 16:53:44] [config]   - 1e
[2023-07-17 16:53:44] [config]   - 0
[2023-07-17 16:53:44] [config] lr-decay: 0
[2023-07-17 16:53:44] [config] lr-decay-freq: 50000
[2023-07-17 16:53:44] [config] lr-decay-inv-sqrt:
[2023-07-17 16:53:44] [config]   - 0
[2023-07-17 16:53:44] [config] lr-decay-repeat-warmup: false
[2023-07-17 16:53:44] [config] lr-decay-reset-optimizer: false
[2023-07-17 16:53:44] [config] lr-decay-start:
[2023-07-17 16:53:44] [config]   - 10
[2023-07-17 16:53:44] [config]   - 1
[2023-07-17 16:53:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 16:53:44] [config] lr-report: false
[2023-07-17 16:53:44] [config] lr-warmup: 0
[2023-07-17 16:53:44] [config] lr-warmup-at-reload: false
[2023-07-17 16:53:44] [config] lr-warmup-cycle: false
[2023-07-17 16:53:44] [config] lr-warmup-start-rate: 0
[2023-07-17 16:53:44] [config] max-length: 200
[2023-07-17 16:53:44] [config] max-length-crop: true
[2023-07-17 16:53:44] [config] max-length-factor: 3
[2023-07-17 16:53:44] [config] maxi-batch: 100
[2023-07-17 16:53:44] [config] maxi-batch-sort: trg
[2023-07-17 16:53:44] [config] mini-batch: 64
[2023-07-17 16:53:44] [config] mini-batch-fit: true
[2023-07-17 16:53:44] [config] mini-batch-fit-step: 10
[2023-07-17 16:53:44] [config] mini-batch-round-up: true
[2023-07-17 16:53:44] [config] mini-batch-track-lr: false
[2023-07-17 16:53:44] [config] mini-batch-warmup: 0
[2023-07-17 16:53:44] [config] mini-batch-words: 0
[2023-07-17 16:53:44] [config] mini-batch-words-ref: 0
[2023-07-17 16:53:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 16:53:44] [config] multi-loss-type: sum
[2023-07-17 16:53:44] [config] n-best: false
[2023-07-17 16:53:44] [config] no-nccl: false
[2023-07-17 16:53:44] [config] no-reload: false
[2023-07-17 16:53:44] [config] no-restore-corpus: false
[2023-07-17 16:53:44] [config] normalize: 0
[2023-07-17 16:53:44] [config] normalize-gradient: false
[2023-07-17 16:53:44] [config] num-devices: 0
[2023-07-17 16:53:44] [config] optimizer: adam
[2023-07-17 16:53:44] [config] optimizer-delay: 1
[2023-07-17 16:53:44] [config] optimizer-params:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] output-omit-bias: false
[2023-07-17 16:53:44] [config] overwrite: true
[2023-07-17 16:53:44] [config] precision:
[2023-07-17 16:53:44] [config]   - float16
[2023-07-17 16:53:44] [config]   - float32
[2023-07-17 16:53:44] [config] pretrained-model: ""
[2023-07-17 16:53:44] [config] quantize-biases: false
[2023-07-17 16:53:44] [config] quantize-bits: 0
[2023-07-17 16:53:44] [config] quantize-log-based: false
[2023-07-17 16:53:44] [config] quantize-optimization-steps: 0
[2023-07-17 16:53:44] [config] quiet: false
[2023-07-17 16:53:44] [config] quiet-translation: true
[2023-07-17 16:53:44] [config] relative-paths: false
[2023-07-17 16:53:44] [config] right-left: false
[2023-07-17 16:53:44] [config] save-freq: 10000u
[2023-07-17 16:53:44] [config] seed: 1234
[2023-07-17 16:53:44] [config] sentencepiece-alphas:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] sentencepiece-max-lines: 2000000
[2023-07-17 16:53:44] [config] sentencepiece-options: ""
[2023-07-17 16:53:44] [config] sharding: global
[2023-07-17 16:53:44] [config] shuffle: data
[2023-07-17 16:53:44] [config] shuffle-in-ram: false
[2023-07-17 16:53:44] [config] sigterm: save-and-exit
[2023-07-17 16:53:44] [config] skip: false
[2023-07-17 16:53:44] [config] sqlite: ""
[2023-07-17 16:53:44] [config] sqlite-drop: false
[2023-07-17 16:53:44] [config] sync-freq: 200u
[2023-07-17 16:53:44] [config] sync-sgd: false
[2023-07-17 16:53:44] [config] tempdir: /tmp
[2023-07-17 16:53:44] [config] tied-embeddings: false
[2023-07-17 16:53:44] [config] tied-embeddings-all: true
[2023-07-17 16:53:44] [config] tied-embeddings-src: false
[2023-07-17 16:53:44] [config] train-embedder-rank:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] train-sets:
[2023-07-17 16:53:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 16:53:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 16:53:44] [config] transformer-aan-activation: swish
[2023-07-17 16:53:44] [config] transformer-aan-depth: 2
[2023-07-17 16:53:44] [config] transformer-aan-nogate: false
[2023-07-17 16:53:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 16:53:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 16:53:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 16:53:44] [config] transformer-depth-scaling: false
[2023-07-17 16:53:44] [config] transformer-dim-aan: 2048
[2023-07-17 16:53:44] [config] transformer-dim-ffn: 2048
[2023-07-17 16:53:44] [config] transformer-dropout: 0
[2023-07-17 16:53:44] [config] transformer-dropout-attention: 0
[2023-07-17 16:53:44] [config] transformer-dropout-ffn: 0
[2023-07-17 16:53:44] [config] transformer-ffn-activation: swish
[2023-07-17 16:53:44] [config] transformer-ffn-depth: 2
[2023-07-17 16:53:44] [config] transformer-guided-alignment-layer: last
[2023-07-17 16:53:44] [config] transformer-heads: 8
[2023-07-17 16:53:44] [config] transformer-no-projection: false
[2023-07-17 16:53:44] [config] transformer-pool: false
[2023-07-17 16:53:44] [config] transformer-postprocess: dan
[2023-07-17 16:53:44] [config] transformer-postprocess-emb: d
[2023-07-17 16:53:44] [config] transformer-postprocess-top: ""
[2023-07-17 16:53:44] [config] transformer-preprocess: ""
[2023-07-17 16:53:44] [config] transformer-tied-layers:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] transformer-train-position-embeddings: false
[2023-07-17 16:53:44] [config] tsv: false
[2023-07-17 16:53:44] [config] tsv-fields: 0
[2023-07-17 16:53:44] [config] type: amun
[2023-07-17 16:53:44] [config] ulr: false
[2023-07-17 16:53:44] [config] ulr-dim-emb: 0
[2023-07-17 16:53:44] [config] ulr-dropout: 0
[2023-07-17 16:53:44] [config] ulr-keys-vectors: ""
[2023-07-17 16:53:44] [config] ulr-query-vectors: ""
[2023-07-17 16:53:44] [config] ulr-softmax-temperature: 1
[2023-07-17 16:53:44] [config] ulr-trainable-transformation: false
[2023-07-17 16:53:44] [config] unlikelihood-loss: false
[2023-07-17 16:53:44] [config] valid-freq: 50000000
[2023-07-17 16:53:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 16:53:44] [config] valid-max-length: 1000
[2023-07-17 16:53:44] [config] valid-metrics:
[2023-07-17 16:53:44] [config]   - cross-entropy
[2023-07-17 16:53:44] [config]   - translation
[2023-07-17 16:53:44] [config] valid-mini-batch: 32
[2023-07-17 16:53:44] [config] valid-reset-stalled: false
[2023-07-17 16:53:44] [config] valid-script-args:
[2023-07-17 16:53:44] [config]   []
[2023-07-17 16:53:44] [config] valid-script-path: ""
[2023-07-17 16:53:44] [config] valid-sets:
[2023-07-17 16:53:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 16:53:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 16:53:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 16:53:44] [config] vocabs:
[2023-07-17 16:53:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 16:53:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 16:53:44] [config] word-penalty: 0
[2023-07-17 16:53:44] [config] word-scores: false
[2023-07-17 16:53:44] [config] workspace: 5500
[2023-07-17 16:53:44] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 16:53:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 16:53:44] [training] Using single-device training
[2023-07-17 16:53:44] Synced seed 1234
[2023-07-17 16:53:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 16:53:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 16:53:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 16:53:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 16:53:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 16:53:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 16:53:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 16:53:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 16:53:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 16:53:46] [comm] Using global sharding
[2023-07-17 16:53:46] [comm] NCCLCommunicators constructed successfully
[2023-07-17 16:53:46] [training] Using 1 GPUs
[2023-07-17 16:53:46] [logits] Applying loss function for 1 factor(s)
[2023-07-17 16:53:46] [memory] Reserving 80 MB, device gpu0
[2023-07-17 16:53:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 16:53:46] [memory] Reserving 80 MB, device gpu0
[2023-07-17 17:29:49] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 17:29:50] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 17:29:50] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x55b030210231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x55b030265ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x55b03027cd5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x55b030690e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x55b03069f348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55b030144b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55b0300662c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b03001db9c]    main                                               + 0x3c
[0x7fbb309da0b3]    __libc_start_main                                  + 0xf3
[0x55b030064cbe]    _start                                             + 0x2e

[2023-07-17 17:29:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 17:29:51] [marian] Running on node22.datos.cluster.uy as process 22839 with command line:
[2023-07-17 17:29:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 17:29:51] [config] after: 0e
[2023-07-17 17:29:51] [config] after-batches: 0
[2023-07-17 17:29:51] [config] after-epochs: 70
[2023-07-17 17:29:51] [config] all-caps-every: 0
[2023-07-17 17:29:51] [config] allow-unk: false
[2023-07-17 17:29:51] [config] authors: false
[2023-07-17 17:29:51] [config] beam-size: 12
[2023-07-17 17:29:51] [config] bert-class-symbol: "[CLS]"
[2023-07-17 17:29:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 17:29:51] [config] bert-masking-fraction: 0.15
[2023-07-17 17:29:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 17:29:51] [config] bert-train-type-embeddings: true
[2023-07-17 17:29:51] [config] bert-type-vocab-size: 2
[2023-07-17 17:29:51] [config] build-info: ""
[2023-07-17 17:29:51] [config] check-gradient-nan: false
[2023-07-17 17:29:51] [config] check-nan: false
[2023-07-17 17:29:51] [config] cite: false
[2023-07-17 17:29:51] [config] clip-norm: 1
[2023-07-17 17:29:51] [config] cost-scaling:
[2023-07-17 17:29:51] [config]   - 256.f
[2023-07-17 17:29:51] [config]   - 1000
[2023-07-17 17:29:51] [config]   - 2.f
[2023-07-17 17:29:51] [config]   - 256.f
[2023-07-17 17:29:51] [config] cost-type: ce-sum
[2023-07-17 17:29:51] [config] cpu-threads: 0
[2023-07-17 17:29:51] [config] data-threads: 8
[2023-07-17 17:29:51] [config] data-weighting: ""
[2023-07-17 17:29:51] [config] data-weighting-type: sentence
[2023-07-17 17:29:51] [config] dec-cell: gru
[2023-07-17 17:29:51] [config] dec-cell-base-depth: 2
[2023-07-17 17:29:51] [config] dec-cell-high-depth: 1
[2023-07-17 17:29:51] [config] dec-depth: 1
[2023-07-17 17:29:51] [config] devices:
[2023-07-17 17:29:51] [config]   - 0
[2023-07-17 17:29:51] [config] dim-emb: 512
[2023-07-17 17:29:51] [config] dim-rnn: 1024
[2023-07-17 17:29:51] [config] dim-vocabs:
[2023-07-17 17:29:51] [config]   - 16384
[2023-07-17 17:29:51] [config]   - 16384
[2023-07-17 17:29:51] [config] disp-first: 0
[2023-07-17 17:29:51] [config] disp-freq: 1000u
[2023-07-17 17:29:51] [config] disp-label-counts: true
[2023-07-17 17:29:51] [config] dropout-rnn: 0
[2023-07-17 17:29:51] [config] dropout-src: 0
[2023-07-17 17:29:51] [config] dropout-trg: 0
[2023-07-17 17:29:51] [config] dump-config: ""
[2023-07-17 17:29:51] [config] dynamic-gradient-scaling:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] early-stopping: 5
[2023-07-17 17:29:51] [config] early-stopping-on: first
[2023-07-17 17:29:51] [config] embedding-fix-src: false
[2023-07-17 17:29:51] [config] embedding-fix-trg: false
[2023-07-17 17:29:51] [config] embedding-normalization: false
[2023-07-17 17:29:51] [config] embedding-vectors:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] enc-cell: gru
[2023-07-17 17:29:51] [config] enc-cell-depth: 1
[2023-07-17 17:29:51] [config] enc-depth: 1
[2023-07-17 17:29:51] [config] enc-type: bidirectional
[2023-07-17 17:29:51] [config] english-title-case-every: 0
[2023-07-17 17:29:51] [config] exponential-smoothing: 0
[2023-07-17 17:29:51] [config] factor-weight: 1
[2023-07-17 17:29:51] [config] factors-combine: sum
[2023-07-17 17:29:51] [config] factors-dim-emb: 0
[2023-07-17 17:29:51] [config] gradient-checkpointing: false
[2023-07-17 17:29:51] [config] gradient-norm-average-window: 100
[2023-07-17 17:29:51] [config] guided-alignment: none
[2023-07-17 17:29:51] [config] guided-alignment-cost: mse
[2023-07-17 17:29:51] [config] guided-alignment-weight: 0.1
[2023-07-17 17:29:51] [config] ignore-model-config: false
[2023-07-17 17:29:51] [config] input-types:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] interpolate-env-vars: false
[2023-07-17 17:29:51] [config] keep-best: false
[2023-07-17 17:29:51] [config] label-smoothing: 0
[2023-07-17 17:29:51] [config] layer-normalization: false
[2023-07-17 17:29:51] [config] learn-rate: 0.0001
[2023-07-17 17:29:51] [config] lemma-dependency: ""
[2023-07-17 17:29:51] [config] lemma-dim-emb: 0
[2023-07-17 17:29:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 17:29:51] [config] log-level: info
[2023-07-17 17:29:51] [config] log-time-zone: ""
[2023-07-17 17:29:51] [config] logical-epoch:
[2023-07-17 17:29:51] [config]   - 1e
[2023-07-17 17:29:51] [config]   - 0
[2023-07-17 17:29:51] [config] lr-decay: 0
[2023-07-17 17:29:51] [config] lr-decay-freq: 50000
[2023-07-17 17:29:51] [config] lr-decay-inv-sqrt:
[2023-07-17 17:29:51] [config]   - 0
[2023-07-17 17:29:51] [config] lr-decay-repeat-warmup: false
[2023-07-17 17:29:51] [config] lr-decay-reset-optimizer: false
[2023-07-17 17:29:51] [config] lr-decay-start:
[2023-07-17 17:29:51] [config]   - 10
[2023-07-17 17:29:51] [config]   - 1
[2023-07-17 17:29:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 17:29:51] [config] lr-report: false
[2023-07-17 17:29:51] [config] lr-warmup: 0
[2023-07-17 17:29:51] [config] lr-warmup-at-reload: false
[2023-07-17 17:29:51] [config] lr-warmup-cycle: false
[2023-07-17 17:29:51] [config] lr-warmup-start-rate: 0
[2023-07-17 17:29:51] [config] max-length: 200
[2023-07-17 17:29:51] [config] max-length-crop: true
[2023-07-17 17:29:51] [config] max-length-factor: 3
[2023-07-17 17:29:51] [config] maxi-batch: 100
[2023-07-17 17:29:51] [config] maxi-batch-sort: trg
[2023-07-17 17:29:51] [config] mini-batch: 64
[2023-07-17 17:29:51] [config] mini-batch-fit: true
[2023-07-17 17:29:51] [config] mini-batch-fit-step: 10
[2023-07-17 17:29:51] [config] mini-batch-round-up: true
[2023-07-17 17:29:51] [config] mini-batch-track-lr: false
[2023-07-17 17:29:51] [config] mini-batch-warmup: 0
[2023-07-17 17:29:51] [config] mini-batch-words: 0
[2023-07-17 17:29:51] [config] mini-batch-words-ref: 0
[2023-07-17 17:29:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 17:29:51] [config] multi-loss-type: sum
[2023-07-17 17:29:51] [config] n-best: false
[2023-07-17 17:29:51] [config] no-nccl: false
[2023-07-17 17:29:51] [config] no-reload: false
[2023-07-17 17:29:51] [config] no-restore-corpus: false
[2023-07-17 17:29:51] [config] normalize: 0
[2023-07-17 17:29:51] [config] normalize-gradient: false
[2023-07-17 17:29:51] [config] num-devices: 0
[2023-07-17 17:29:51] [config] optimizer: adam
[2023-07-17 17:29:51] [config] optimizer-delay: 1
[2023-07-17 17:29:51] [config] optimizer-params:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] output-omit-bias: false
[2023-07-17 17:29:51] [config] overwrite: true
[2023-07-17 17:29:51] [config] precision:
[2023-07-17 17:29:51] [config]   - float16
[2023-07-17 17:29:51] [config]   - float32
[2023-07-17 17:29:51] [config] pretrained-model: ""
[2023-07-17 17:29:51] [config] quantize-biases: false
[2023-07-17 17:29:51] [config] quantize-bits: 0
[2023-07-17 17:29:51] [config] quantize-log-based: false
[2023-07-17 17:29:51] [config] quantize-optimization-steps: 0
[2023-07-17 17:29:51] [config] quiet: false
[2023-07-17 17:29:51] [config] quiet-translation: true
[2023-07-17 17:29:51] [config] relative-paths: false
[2023-07-17 17:29:51] [config] right-left: false
[2023-07-17 17:29:51] [config] save-freq: 10000u
[2023-07-17 17:29:51] [config] seed: 1234
[2023-07-17 17:29:51] [config] sentencepiece-alphas:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] sentencepiece-max-lines: 2000000
[2023-07-17 17:29:51] [config] sentencepiece-options: ""
[2023-07-17 17:29:51] [config] sharding: global
[2023-07-17 17:29:51] [config] shuffle: data
[2023-07-17 17:29:51] [config] shuffle-in-ram: false
[2023-07-17 17:29:51] [config] sigterm: save-and-exit
[2023-07-17 17:29:51] [config] skip: false
[2023-07-17 17:29:51] [config] sqlite: ""
[2023-07-17 17:29:51] [config] sqlite-drop: false
[2023-07-17 17:29:51] [config] sync-freq: 200u
[2023-07-17 17:29:51] [config] sync-sgd: false
[2023-07-17 17:29:51] [config] tempdir: /tmp
[2023-07-17 17:29:51] [config] tied-embeddings: false
[2023-07-17 17:29:51] [config] tied-embeddings-all: true
[2023-07-17 17:29:51] [config] tied-embeddings-src: false
[2023-07-17 17:29:51] [config] train-embedder-rank:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] train-sets:
[2023-07-17 17:29:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 17:29:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 17:29:51] [config] transformer-aan-activation: swish
[2023-07-17 17:29:51] [config] transformer-aan-depth: 2
[2023-07-17 17:29:51] [config] transformer-aan-nogate: false
[2023-07-17 17:29:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 17:29:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 17:29:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 17:29:51] [config] transformer-depth-scaling: false
[2023-07-17 17:29:51] [config] transformer-dim-aan: 2048
[2023-07-17 17:29:51] [config] transformer-dim-ffn: 2048
[2023-07-17 17:29:51] [config] transformer-dropout: 0
[2023-07-17 17:29:51] [config] transformer-dropout-attention: 0
[2023-07-17 17:29:51] [config] transformer-dropout-ffn: 0
[2023-07-17 17:29:51] [config] transformer-ffn-activation: swish
[2023-07-17 17:29:51] [config] transformer-ffn-depth: 2
[2023-07-17 17:29:51] [config] transformer-guided-alignment-layer: last
[2023-07-17 17:29:51] [config] transformer-heads: 8
[2023-07-17 17:29:51] [config] transformer-no-projection: false
[2023-07-17 17:29:51] [config] transformer-pool: false
[2023-07-17 17:29:51] [config] transformer-postprocess: dan
[2023-07-17 17:29:51] [config] transformer-postprocess-emb: d
[2023-07-17 17:29:51] [config] transformer-postprocess-top: ""
[2023-07-17 17:29:51] [config] transformer-preprocess: ""
[2023-07-17 17:29:51] [config] transformer-tied-layers:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] transformer-train-position-embeddings: false
[2023-07-17 17:29:51] [config] tsv: false
[2023-07-17 17:29:51] [config] tsv-fields: 0
[2023-07-17 17:29:51] [config] type: amun
[2023-07-17 17:29:51] [config] ulr: false
[2023-07-17 17:29:51] [config] ulr-dim-emb: 0
[2023-07-17 17:29:51] [config] ulr-dropout: 0
[2023-07-17 17:29:51] [config] ulr-keys-vectors: ""
[2023-07-17 17:29:51] [config] ulr-query-vectors: ""
[2023-07-17 17:29:51] [config] ulr-softmax-temperature: 1
[2023-07-17 17:29:51] [config] ulr-trainable-transformation: false
[2023-07-17 17:29:51] [config] unlikelihood-loss: false
[2023-07-17 17:29:51] [config] valid-freq: 50000000
[2023-07-17 17:29:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 17:29:51] [config] valid-max-length: 1000
[2023-07-17 17:29:51] [config] valid-metrics:
[2023-07-17 17:29:51] [config]   - cross-entropy
[2023-07-17 17:29:51] [config]   - translation
[2023-07-17 17:29:51] [config] valid-mini-batch: 32
[2023-07-17 17:29:51] [config] valid-reset-stalled: false
[2023-07-17 17:29:51] [config] valid-script-args:
[2023-07-17 17:29:51] [config]   []
[2023-07-17 17:29:51] [config] valid-script-path: ""
[2023-07-17 17:29:51] [config] valid-sets:
[2023-07-17 17:29:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 17:29:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 17:29:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 17:29:51] [config] vocabs:
[2023-07-17 17:29:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 17:29:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 17:29:51] [config] word-penalty: 0
[2023-07-17 17:29:51] [config] word-scores: false
[2023-07-17 17:29:51] [config] workspace: 5500
[2023-07-17 17:29:51] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 17:29:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 17:29:51] [training] Using single-device training
[2023-07-17 17:29:51] Synced seed 1234
[2023-07-17 17:29:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 17:29:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 17:29:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 17:29:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 17:29:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 17:29:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 17:29:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 17:29:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 17:29:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 17:29:52] [comm] Using global sharding
[2023-07-17 17:29:53] [comm] NCCLCommunicators constructed successfully
[2023-07-17 17:29:53] [training] Using 1 GPUs
[2023-07-17 17:29:53] [logits] Applying loss function for 1 factor(s)
[2023-07-17 17:29:53] [memory] Reserving 80 MB, device gpu0
[2023-07-17 17:29:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 17:29:53] [memory] Reserving 80 MB, device gpu0
[2023-07-17 18:05:59] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 18:05:59] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 18:05:59] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x55f6d9a26231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x55f6d9a7bca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x55f6d9a92d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x55f6d9ea6e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x55f6d9eb5348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55f6d995ab9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55f6d987c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55f6d9833b9c]    main                                               + 0x3c
[0x7fccafec00b3]    __libc_start_main                                  + 0xf3
[0x55f6d987acbe]    _start                                             + 0x2e

[2023-07-17 18:06:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 18:06:00] [marian] Running on node22.datos.cluster.uy as process 25121 with command line:
[2023-07-17 18:06:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 18:06:00] [config] after: 0e
[2023-07-17 18:06:00] [config] after-batches: 0
[2023-07-17 18:06:00] [config] after-epochs: 80
[2023-07-17 18:06:00] [config] all-caps-every: 0
[2023-07-17 18:06:00] [config] allow-unk: false
[2023-07-17 18:06:00] [config] authors: false
[2023-07-17 18:06:00] [config] beam-size: 12
[2023-07-17 18:06:00] [config] bert-class-symbol: "[CLS]"
[2023-07-17 18:06:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 18:06:00] [config] bert-masking-fraction: 0.15
[2023-07-17 18:06:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 18:06:00] [config] bert-train-type-embeddings: true
[2023-07-17 18:06:00] [config] bert-type-vocab-size: 2
[2023-07-17 18:06:00] [config] build-info: ""
[2023-07-17 18:06:00] [config] check-gradient-nan: false
[2023-07-17 18:06:00] [config] check-nan: false
[2023-07-17 18:06:00] [config] cite: false
[2023-07-17 18:06:00] [config] clip-norm: 1
[2023-07-17 18:06:00] [config] cost-scaling:
[2023-07-17 18:06:00] [config]   - 256.f
[2023-07-17 18:06:00] [config]   - 1000
[2023-07-17 18:06:00] [config]   - 2.f
[2023-07-17 18:06:00] [config]   - 256.f
[2023-07-17 18:06:00] [config] cost-type: ce-sum
[2023-07-17 18:06:00] [config] cpu-threads: 0
[2023-07-17 18:06:00] [config] data-threads: 8
[2023-07-17 18:06:00] [config] data-weighting: ""
[2023-07-17 18:06:00] [config] data-weighting-type: sentence
[2023-07-17 18:06:00] [config] dec-cell: gru
[2023-07-17 18:06:00] [config] dec-cell-base-depth: 2
[2023-07-17 18:06:00] [config] dec-cell-high-depth: 1
[2023-07-17 18:06:00] [config] dec-depth: 1
[2023-07-17 18:06:00] [config] devices:
[2023-07-17 18:06:00] [config]   - 0
[2023-07-17 18:06:00] [config] dim-emb: 512
[2023-07-17 18:06:00] [config] dim-rnn: 1024
[2023-07-17 18:06:00] [config] dim-vocabs:
[2023-07-17 18:06:00] [config]   - 16384
[2023-07-17 18:06:00] [config]   - 16384
[2023-07-17 18:06:00] [config] disp-first: 0
[2023-07-17 18:06:00] [config] disp-freq: 1000u
[2023-07-17 18:06:00] [config] disp-label-counts: true
[2023-07-17 18:06:00] [config] dropout-rnn: 0
[2023-07-17 18:06:00] [config] dropout-src: 0
[2023-07-17 18:06:00] [config] dropout-trg: 0
[2023-07-17 18:06:00] [config] dump-config: ""
[2023-07-17 18:06:00] [config] dynamic-gradient-scaling:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] early-stopping: 5
[2023-07-17 18:06:00] [config] early-stopping-on: first
[2023-07-17 18:06:00] [config] embedding-fix-src: false
[2023-07-17 18:06:00] [config] embedding-fix-trg: false
[2023-07-17 18:06:00] [config] embedding-normalization: false
[2023-07-17 18:06:00] [config] embedding-vectors:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] enc-cell: gru
[2023-07-17 18:06:00] [config] enc-cell-depth: 1
[2023-07-17 18:06:00] [config] enc-depth: 1
[2023-07-17 18:06:00] [config] enc-type: bidirectional
[2023-07-17 18:06:00] [config] english-title-case-every: 0
[2023-07-17 18:06:00] [config] exponential-smoothing: 0
[2023-07-17 18:06:00] [config] factor-weight: 1
[2023-07-17 18:06:00] [config] factors-combine: sum
[2023-07-17 18:06:00] [config] factors-dim-emb: 0
[2023-07-17 18:06:00] [config] gradient-checkpointing: false
[2023-07-17 18:06:00] [config] gradient-norm-average-window: 100
[2023-07-17 18:06:00] [config] guided-alignment: none
[2023-07-17 18:06:00] [config] guided-alignment-cost: mse
[2023-07-17 18:06:00] [config] guided-alignment-weight: 0.1
[2023-07-17 18:06:00] [config] ignore-model-config: false
[2023-07-17 18:06:00] [config] input-types:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] interpolate-env-vars: false
[2023-07-17 18:06:00] [config] keep-best: false
[2023-07-17 18:06:00] [config] label-smoothing: 0
[2023-07-17 18:06:00] [config] layer-normalization: false
[2023-07-17 18:06:00] [config] learn-rate: 0.0001
[2023-07-17 18:06:00] [config] lemma-dependency: ""
[2023-07-17 18:06:00] [config] lemma-dim-emb: 0
[2023-07-17 18:06:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 18:06:00] [config] log-level: info
[2023-07-17 18:06:00] [config] log-time-zone: ""
[2023-07-17 18:06:00] [config] logical-epoch:
[2023-07-17 18:06:00] [config]   - 1e
[2023-07-17 18:06:00] [config]   - 0
[2023-07-17 18:06:00] [config] lr-decay: 0
[2023-07-17 18:06:00] [config] lr-decay-freq: 50000
[2023-07-17 18:06:00] [config] lr-decay-inv-sqrt:
[2023-07-17 18:06:00] [config]   - 0
[2023-07-17 18:06:00] [config] lr-decay-repeat-warmup: false
[2023-07-17 18:06:00] [config] lr-decay-reset-optimizer: false
[2023-07-17 18:06:00] [config] lr-decay-start:
[2023-07-17 18:06:00] [config]   - 10
[2023-07-17 18:06:00] [config]   - 1
[2023-07-17 18:06:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 18:06:00] [config] lr-report: false
[2023-07-17 18:06:00] [config] lr-warmup: 0
[2023-07-17 18:06:00] [config] lr-warmup-at-reload: false
[2023-07-17 18:06:00] [config] lr-warmup-cycle: false
[2023-07-17 18:06:00] [config] lr-warmup-start-rate: 0
[2023-07-17 18:06:00] [config] max-length: 200
[2023-07-17 18:06:00] [config] max-length-crop: true
[2023-07-17 18:06:00] [config] max-length-factor: 3
[2023-07-17 18:06:00] [config] maxi-batch: 100
[2023-07-17 18:06:00] [config] maxi-batch-sort: trg
[2023-07-17 18:06:00] [config] mini-batch: 64
[2023-07-17 18:06:00] [config] mini-batch-fit: true
[2023-07-17 18:06:00] [config] mini-batch-fit-step: 10
[2023-07-17 18:06:00] [config] mini-batch-round-up: true
[2023-07-17 18:06:00] [config] mini-batch-track-lr: false
[2023-07-17 18:06:00] [config] mini-batch-warmup: 0
[2023-07-17 18:06:00] [config] mini-batch-words: 0
[2023-07-17 18:06:00] [config] mini-batch-words-ref: 0
[2023-07-17 18:06:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 18:06:00] [config] multi-loss-type: sum
[2023-07-17 18:06:00] [config] n-best: false
[2023-07-17 18:06:00] [config] no-nccl: false
[2023-07-17 18:06:00] [config] no-reload: false
[2023-07-17 18:06:00] [config] no-restore-corpus: false
[2023-07-17 18:06:00] [config] normalize: 0
[2023-07-17 18:06:00] [config] normalize-gradient: false
[2023-07-17 18:06:00] [config] num-devices: 0
[2023-07-17 18:06:00] [config] optimizer: adam
[2023-07-17 18:06:00] [config] optimizer-delay: 1
[2023-07-17 18:06:00] [config] optimizer-params:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] output-omit-bias: false
[2023-07-17 18:06:00] [config] overwrite: true
[2023-07-17 18:06:00] [config] precision:
[2023-07-17 18:06:00] [config]   - float16
[2023-07-17 18:06:00] [config]   - float32
[2023-07-17 18:06:00] [config] pretrained-model: ""
[2023-07-17 18:06:00] [config] quantize-biases: false
[2023-07-17 18:06:00] [config] quantize-bits: 0
[2023-07-17 18:06:00] [config] quantize-log-based: false
[2023-07-17 18:06:00] [config] quantize-optimization-steps: 0
[2023-07-17 18:06:00] [config] quiet: false
[2023-07-17 18:06:00] [config] quiet-translation: true
[2023-07-17 18:06:00] [config] relative-paths: false
[2023-07-17 18:06:00] [config] right-left: false
[2023-07-17 18:06:00] [config] save-freq: 10000u
[2023-07-17 18:06:00] [config] seed: 1234
[2023-07-17 18:06:00] [config] sentencepiece-alphas:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] sentencepiece-max-lines: 2000000
[2023-07-17 18:06:00] [config] sentencepiece-options: ""
[2023-07-17 18:06:00] [config] sharding: global
[2023-07-17 18:06:00] [config] shuffle: data
[2023-07-17 18:06:00] [config] shuffle-in-ram: false
[2023-07-17 18:06:00] [config] sigterm: save-and-exit
[2023-07-17 18:06:00] [config] skip: false
[2023-07-17 18:06:00] [config] sqlite: ""
[2023-07-17 18:06:00] [config] sqlite-drop: false
[2023-07-17 18:06:00] [config] sync-freq: 200u
[2023-07-17 18:06:00] [config] sync-sgd: false
[2023-07-17 18:06:00] [config] tempdir: /tmp
[2023-07-17 18:06:00] [config] tied-embeddings: false
[2023-07-17 18:06:00] [config] tied-embeddings-all: true
[2023-07-17 18:06:00] [config] tied-embeddings-src: false
[2023-07-17 18:06:00] [config] train-embedder-rank:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] train-sets:
[2023-07-17 18:06:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 18:06:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 18:06:00] [config] transformer-aan-activation: swish
[2023-07-17 18:06:00] [config] transformer-aan-depth: 2
[2023-07-17 18:06:00] [config] transformer-aan-nogate: false
[2023-07-17 18:06:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 18:06:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 18:06:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 18:06:00] [config] transformer-depth-scaling: false
[2023-07-17 18:06:00] [config] transformer-dim-aan: 2048
[2023-07-17 18:06:00] [config] transformer-dim-ffn: 2048
[2023-07-17 18:06:00] [config] transformer-dropout: 0
[2023-07-17 18:06:00] [config] transformer-dropout-attention: 0
[2023-07-17 18:06:00] [config] transformer-dropout-ffn: 0
[2023-07-17 18:06:00] [config] transformer-ffn-activation: swish
[2023-07-17 18:06:00] [config] transformer-ffn-depth: 2
[2023-07-17 18:06:00] [config] transformer-guided-alignment-layer: last
[2023-07-17 18:06:00] [config] transformer-heads: 8
[2023-07-17 18:06:00] [config] transformer-no-projection: false
[2023-07-17 18:06:00] [config] transformer-pool: false
[2023-07-17 18:06:00] [config] transformer-postprocess: dan
[2023-07-17 18:06:00] [config] transformer-postprocess-emb: d
[2023-07-17 18:06:00] [config] transformer-postprocess-top: ""
[2023-07-17 18:06:00] [config] transformer-preprocess: ""
[2023-07-17 18:06:00] [config] transformer-tied-layers:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] transformer-train-position-embeddings: false
[2023-07-17 18:06:00] [config] tsv: false
[2023-07-17 18:06:00] [config] tsv-fields: 0
[2023-07-17 18:06:00] [config] type: amun
[2023-07-17 18:06:00] [config] ulr: false
[2023-07-17 18:06:00] [config] ulr-dim-emb: 0
[2023-07-17 18:06:00] [config] ulr-dropout: 0
[2023-07-17 18:06:00] [config] ulr-keys-vectors: ""
[2023-07-17 18:06:00] [config] ulr-query-vectors: ""
[2023-07-17 18:06:00] [config] ulr-softmax-temperature: 1
[2023-07-17 18:06:00] [config] ulr-trainable-transformation: false
[2023-07-17 18:06:00] [config] unlikelihood-loss: false
[2023-07-17 18:06:00] [config] valid-freq: 50000000
[2023-07-17 18:06:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 18:06:00] [config] valid-max-length: 1000
[2023-07-17 18:06:00] [config] valid-metrics:
[2023-07-17 18:06:00] [config]   - cross-entropy
[2023-07-17 18:06:00] [config]   - translation
[2023-07-17 18:06:00] [config] valid-mini-batch: 32
[2023-07-17 18:06:00] [config] valid-reset-stalled: false
[2023-07-17 18:06:00] [config] valid-script-args:
[2023-07-17 18:06:00] [config]   []
[2023-07-17 18:06:00] [config] valid-script-path: ""
[2023-07-17 18:06:00] [config] valid-sets:
[2023-07-17 18:06:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 18:06:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 18:06:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 18:06:00] [config] vocabs:
[2023-07-17 18:06:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 18:06:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 18:06:00] [config] word-penalty: 0
[2023-07-17 18:06:00] [config] word-scores: false
[2023-07-17 18:06:00] [config] workspace: 5500
[2023-07-17 18:06:00] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 18:06:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 18:06:00] [training] Using single-device training
[2023-07-17 18:06:01] Synced seed 1234
[2023-07-17 18:06:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 18:06:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 18:06:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 18:06:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 18:06:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 18:06:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 18:06:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 18:06:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 18:06:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 18:06:03] [comm] Using global sharding
[2023-07-17 18:06:03] [comm] NCCLCommunicators constructed successfully
[2023-07-17 18:06:03] [training] Using 1 GPUs
[2023-07-17 18:06:03] [logits] Applying loss function for 1 factor(s)
[2023-07-17 18:06:03] [memory] Reserving 80 MB, device gpu0
[2023-07-17 18:06:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 18:06:03] [memory] Reserving 80 MB, device gpu0
[2023-07-17 18:42:15] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 18:42:15] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 18:42:15] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x5581c3be7231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x5581c3c3cca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x5581c3c53d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x5581c4067e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x5581c4076348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x5581c3b1bb9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x5581c3a3d2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5581c39f4b9c]    main                                               + 0x3c
[0x7fd7f19340b3]    __libc_start_main                                  + 0xf3
[0x5581c3a3bcbe]    _start                                             + 0x2e

[2023-07-17 18:42:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 18:42:16] [marian] Running on node22.datos.cluster.uy as process 27355 with command line:
[2023-07-17 18:42:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 18:42:16] [config] after: 0e
[2023-07-17 18:42:16] [config] after-batches: 0
[2023-07-17 18:42:16] [config] after-epochs: 90
[2023-07-17 18:42:16] [config] all-caps-every: 0
[2023-07-17 18:42:16] [config] allow-unk: false
[2023-07-17 18:42:16] [config] authors: false
[2023-07-17 18:42:16] [config] beam-size: 12
[2023-07-17 18:42:16] [config] bert-class-symbol: "[CLS]"
[2023-07-17 18:42:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 18:42:16] [config] bert-masking-fraction: 0.15
[2023-07-17 18:42:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 18:42:16] [config] bert-train-type-embeddings: true
[2023-07-17 18:42:16] [config] bert-type-vocab-size: 2
[2023-07-17 18:42:16] [config] build-info: ""
[2023-07-17 18:42:16] [config] check-gradient-nan: false
[2023-07-17 18:42:16] [config] check-nan: false
[2023-07-17 18:42:16] [config] cite: false
[2023-07-17 18:42:16] [config] clip-norm: 1
[2023-07-17 18:42:16] [config] cost-scaling:
[2023-07-17 18:42:16] [config]   - 256.f
[2023-07-17 18:42:16] [config]   - 1000
[2023-07-17 18:42:16] [config]   - 2.f
[2023-07-17 18:42:16] [config]   - 256.f
[2023-07-17 18:42:16] [config] cost-type: ce-sum
[2023-07-17 18:42:16] [config] cpu-threads: 0
[2023-07-17 18:42:16] [config] data-threads: 8
[2023-07-17 18:42:16] [config] data-weighting: ""
[2023-07-17 18:42:16] [config] data-weighting-type: sentence
[2023-07-17 18:42:16] [config] dec-cell: gru
[2023-07-17 18:42:16] [config] dec-cell-base-depth: 2
[2023-07-17 18:42:16] [config] dec-cell-high-depth: 1
[2023-07-17 18:42:16] [config] dec-depth: 1
[2023-07-17 18:42:16] [config] devices:
[2023-07-17 18:42:16] [config]   - 0
[2023-07-17 18:42:16] [config] dim-emb: 512
[2023-07-17 18:42:16] [config] dim-rnn: 1024
[2023-07-17 18:42:16] [config] dim-vocabs:
[2023-07-17 18:42:16] [config]   - 16384
[2023-07-17 18:42:16] [config]   - 16384
[2023-07-17 18:42:16] [config] disp-first: 0
[2023-07-17 18:42:16] [config] disp-freq: 1000u
[2023-07-17 18:42:16] [config] disp-label-counts: true
[2023-07-17 18:42:16] [config] dropout-rnn: 0
[2023-07-17 18:42:16] [config] dropout-src: 0
[2023-07-17 18:42:16] [config] dropout-trg: 0
[2023-07-17 18:42:16] [config] dump-config: ""
[2023-07-17 18:42:16] [config] dynamic-gradient-scaling:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] early-stopping: 5
[2023-07-17 18:42:16] [config] early-stopping-on: first
[2023-07-17 18:42:16] [config] embedding-fix-src: false
[2023-07-17 18:42:16] [config] embedding-fix-trg: false
[2023-07-17 18:42:16] [config] embedding-normalization: false
[2023-07-17 18:42:16] [config] embedding-vectors:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] enc-cell: gru
[2023-07-17 18:42:16] [config] enc-cell-depth: 1
[2023-07-17 18:42:16] [config] enc-depth: 1
[2023-07-17 18:42:16] [config] enc-type: bidirectional
[2023-07-17 18:42:16] [config] english-title-case-every: 0
[2023-07-17 18:42:16] [config] exponential-smoothing: 0
[2023-07-17 18:42:16] [config] factor-weight: 1
[2023-07-17 18:42:16] [config] factors-combine: sum
[2023-07-17 18:42:16] [config] factors-dim-emb: 0
[2023-07-17 18:42:16] [config] gradient-checkpointing: false
[2023-07-17 18:42:16] [config] gradient-norm-average-window: 100
[2023-07-17 18:42:16] [config] guided-alignment: none
[2023-07-17 18:42:16] [config] guided-alignment-cost: mse
[2023-07-17 18:42:16] [config] guided-alignment-weight: 0.1
[2023-07-17 18:42:16] [config] ignore-model-config: false
[2023-07-17 18:42:16] [config] input-types:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] interpolate-env-vars: false
[2023-07-17 18:42:16] [config] keep-best: false
[2023-07-17 18:42:16] [config] label-smoothing: 0
[2023-07-17 18:42:16] [config] layer-normalization: false
[2023-07-17 18:42:16] [config] learn-rate: 0.0001
[2023-07-17 18:42:16] [config] lemma-dependency: ""
[2023-07-17 18:42:16] [config] lemma-dim-emb: 0
[2023-07-17 18:42:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 18:42:16] [config] log-level: info
[2023-07-17 18:42:16] [config] log-time-zone: ""
[2023-07-17 18:42:16] [config] logical-epoch:
[2023-07-17 18:42:16] [config]   - 1e
[2023-07-17 18:42:16] [config]   - 0
[2023-07-17 18:42:16] [config] lr-decay: 0
[2023-07-17 18:42:16] [config] lr-decay-freq: 50000
[2023-07-17 18:42:16] [config] lr-decay-inv-sqrt:
[2023-07-17 18:42:16] [config]   - 0
[2023-07-17 18:42:16] [config] lr-decay-repeat-warmup: false
[2023-07-17 18:42:16] [config] lr-decay-reset-optimizer: false
[2023-07-17 18:42:16] [config] lr-decay-start:
[2023-07-17 18:42:16] [config]   - 10
[2023-07-17 18:42:16] [config]   - 1
[2023-07-17 18:42:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 18:42:16] [config] lr-report: false
[2023-07-17 18:42:16] [config] lr-warmup: 0
[2023-07-17 18:42:16] [config] lr-warmup-at-reload: false
[2023-07-17 18:42:16] [config] lr-warmup-cycle: false
[2023-07-17 18:42:16] [config] lr-warmup-start-rate: 0
[2023-07-17 18:42:16] [config] max-length: 200
[2023-07-17 18:42:16] [config] max-length-crop: true
[2023-07-17 18:42:16] [config] max-length-factor: 3
[2023-07-17 18:42:16] [config] maxi-batch: 100
[2023-07-17 18:42:16] [config] maxi-batch-sort: trg
[2023-07-17 18:42:16] [config] mini-batch: 64
[2023-07-17 18:42:16] [config] mini-batch-fit: true
[2023-07-17 18:42:16] [config] mini-batch-fit-step: 10
[2023-07-17 18:42:16] [config] mini-batch-round-up: true
[2023-07-17 18:42:16] [config] mini-batch-track-lr: false
[2023-07-17 18:42:16] [config] mini-batch-warmup: 0
[2023-07-17 18:42:16] [config] mini-batch-words: 0
[2023-07-17 18:42:16] [config] mini-batch-words-ref: 0
[2023-07-17 18:42:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 18:42:16] [config] multi-loss-type: sum
[2023-07-17 18:42:16] [config] n-best: false
[2023-07-17 18:42:16] [config] no-nccl: false
[2023-07-17 18:42:16] [config] no-reload: false
[2023-07-17 18:42:16] [config] no-restore-corpus: false
[2023-07-17 18:42:16] [config] normalize: 0
[2023-07-17 18:42:16] [config] normalize-gradient: false
[2023-07-17 18:42:16] [config] num-devices: 0
[2023-07-17 18:42:16] [config] optimizer: adam
[2023-07-17 18:42:16] [config] optimizer-delay: 1
[2023-07-17 18:42:16] [config] optimizer-params:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] output-omit-bias: false
[2023-07-17 18:42:16] [config] overwrite: true
[2023-07-17 18:42:16] [config] precision:
[2023-07-17 18:42:16] [config]   - float16
[2023-07-17 18:42:16] [config]   - float32
[2023-07-17 18:42:16] [config] pretrained-model: ""
[2023-07-17 18:42:16] [config] quantize-biases: false
[2023-07-17 18:42:16] [config] quantize-bits: 0
[2023-07-17 18:42:16] [config] quantize-log-based: false
[2023-07-17 18:42:16] [config] quantize-optimization-steps: 0
[2023-07-17 18:42:16] [config] quiet: false
[2023-07-17 18:42:16] [config] quiet-translation: true
[2023-07-17 18:42:16] [config] relative-paths: false
[2023-07-17 18:42:16] [config] right-left: false
[2023-07-17 18:42:16] [config] save-freq: 10000u
[2023-07-17 18:42:16] [config] seed: 1234
[2023-07-17 18:42:16] [config] sentencepiece-alphas:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] sentencepiece-max-lines: 2000000
[2023-07-17 18:42:16] [config] sentencepiece-options: ""
[2023-07-17 18:42:16] [config] sharding: global
[2023-07-17 18:42:16] [config] shuffle: data
[2023-07-17 18:42:16] [config] shuffle-in-ram: false
[2023-07-17 18:42:16] [config] sigterm: save-and-exit
[2023-07-17 18:42:16] [config] skip: false
[2023-07-17 18:42:16] [config] sqlite: ""
[2023-07-17 18:42:16] [config] sqlite-drop: false
[2023-07-17 18:42:16] [config] sync-freq: 200u
[2023-07-17 18:42:16] [config] sync-sgd: false
[2023-07-17 18:42:16] [config] tempdir: /tmp
[2023-07-17 18:42:16] [config] tied-embeddings: false
[2023-07-17 18:42:16] [config] tied-embeddings-all: true
[2023-07-17 18:42:16] [config] tied-embeddings-src: false
[2023-07-17 18:42:16] [config] train-embedder-rank:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] train-sets:
[2023-07-17 18:42:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 18:42:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 18:42:16] [config] transformer-aan-activation: swish
[2023-07-17 18:42:16] [config] transformer-aan-depth: 2
[2023-07-17 18:42:16] [config] transformer-aan-nogate: false
[2023-07-17 18:42:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 18:42:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 18:42:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 18:42:16] [config] transformer-depth-scaling: false
[2023-07-17 18:42:16] [config] transformer-dim-aan: 2048
[2023-07-17 18:42:16] [config] transformer-dim-ffn: 2048
[2023-07-17 18:42:16] [config] transformer-dropout: 0
[2023-07-17 18:42:16] [config] transformer-dropout-attention: 0
[2023-07-17 18:42:16] [config] transformer-dropout-ffn: 0
[2023-07-17 18:42:16] [config] transformer-ffn-activation: swish
[2023-07-17 18:42:16] [config] transformer-ffn-depth: 2
[2023-07-17 18:42:16] [config] transformer-guided-alignment-layer: last
[2023-07-17 18:42:16] [config] transformer-heads: 8
[2023-07-17 18:42:16] [config] transformer-no-projection: false
[2023-07-17 18:42:16] [config] transformer-pool: false
[2023-07-17 18:42:16] [config] transformer-postprocess: dan
[2023-07-17 18:42:16] [config] transformer-postprocess-emb: d
[2023-07-17 18:42:16] [config] transformer-postprocess-top: ""
[2023-07-17 18:42:16] [config] transformer-preprocess: ""
[2023-07-17 18:42:16] [config] transformer-tied-layers:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] transformer-train-position-embeddings: false
[2023-07-17 18:42:16] [config] tsv: false
[2023-07-17 18:42:16] [config] tsv-fields: 0
[2023-07-17 18:42:16] [config] type: amun
[2023-07-17 18:42:16] [config] ulr: false
[2023-07-17 18:42:16] [config] ulr-dim-emb: 0
[2023-07-17 18:42:16] [config] ulr-dropout: 0
[2023-07-17 18:42:16] [config] ulr-keys-vectors: ""
[2023-07-17 18:42:16] [config] ulr-query-vectors: ""
[2023-07-17 18:42:16] [config] ulr-softmax-temperature: 1
[2023-07-17 18:42:16] [config] ulr-trainable-transformation: false
[2023-07-17 18:42:16] [config] unlikelihood-loss: false
[2023-07-17 18:42:16] [config] valid-freq: 50000000
[2023-07-17 18:42:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 18:42:16] [config] valid-max-length: 1000
[2023-07-17 18:42:16] [config] valid-metrics:
[2023-07-17 18:42:16] [config]   - cross-entropy
[2023-07-17 18:42:16] [config]   - translation
[2023-07-17 18:42:16] [config] valid-mini-batch: 32
[2023-07-17 18:42:16] [config] valid-reset-stalled: false
[2023-07-17 18:42:16] [config] valid-script-args:
[2023-07-17 18:42:16] [config]   []
[2023-07-17 18:42:16] [config] valid-script-path: ""
[2023-07-17 18:42:16] [config] valid-sets:
[2023-07-17 18:42:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 18:42:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 18:42:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 18:42:16] [config] vocabs:
[2023-07-17 18:42:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 18:42:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 18:42:16] [config] word-penalty: 0
[2023-07-17 18:42:16] [config] word-scores: false
[2023-07-17 18:42:16] [config] workspace: 5500
[2023-07-17 18:42:16] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 18:42:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 18:42:16] [training] Using single-device training
[2023-07-17 18:42:16] Synced seed 1234
[2023-07-17 18:42:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 18:42:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 18:42:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 18:42:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 18:42:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 18:42:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 18:42:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 18:42:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 18:42:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 18:42:18] [comm] Using global sharding
[2023-07-17 18:42:18] [comm] NCCLCommunicators constructed successfully
[2023-07-17 18:42:18] [training] Using 1 GPUs
[2023-07-17 18:42:18] [logits] Applying loss function for 1 factor(s)
[2023-07-17 18:42:18] [memory] Reserving 80 MB, device gpu0
[2023-07-17 18:42:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 18:42:18] [memory] Reserving 80 MB, device gpu0
[2023-07-17 19:18:46] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 19:18:46] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 19:18:46] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x55a791c7b231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x55a791cd0ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x55a791ce7d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x55a7920fbe1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x55a79210a348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55a791bafb9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55a791ad12c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a791a88b9c]    main                                               + 0x3c
[0x7fdbf398f0b3]    __libc_start_main                                  + 0xf3
[0x55a791acfcbe]    _start                                             + 0x2e

[2023-07-17 19:18:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 19:18:47] [marian] Running on node22.datos.cluster.uy as process 29621 with command line:
[2023-07-17 19:18:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 19:18:47] [config] after: 0e
[2023-07-17 19:18:47] [config] after-batches: 0
[2023-07-17 19:18:47] [config] after-epochs: 100
[2023-07-17 19:18:47] [config] all-caps-every: 0
[2023-07-17 19:18:47] [config] allow-unk: false
[2023-07-17 19:18:47] [config] authors: false
[2023-07-17 19:18:47] [config] beam-size: 12
[2023-07-17 19:18:47] [config] bert-class-symbol: "[CLS]"
[2023-07-17 19:18:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 19:18:47] [config] bert-masking-fraction: 0.15
[2023-07-17 19:18:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 19:18:47] [config] bert-train-type-embeddings: true
[2023-07-17 19:18:47] [config] bert-type-vocab-size: 2
[2023-07-17 19:18:47] [config] build-info: ""
[2023-07-17 19:18:47] [config] check-gradient-nan: false
[2023-07-17 19:18:47] [config] check-nan: false
[2023-07-17 19:18:47] [config] cite: false
[2023-07-17 19:18:47] [config] clip-norm: 1
[2023-07-17 19:18:47] [config] cost-scaling:
[2023-07-17 19:18:47] [config]   - 256.f
[2023-07-17 19:18:47] [config]   - 1000
[2023-07-17 19:18:47] [config]   - 2.f
[2023-07-17 19:18:47] [config]   - 256.f
[2023-07-17 19:18:47] [config] cost-type: ce-sum
[2023-07-17 19:18:47] [config] cpu-threads: 0
[2023-07-17 19:18:47] [config] data-threads: 8
[2023-07-17 19:18:47] [config] data-weighting: ""
[2023-07-17 19:18:47] [config] data-weighting-type: sentence
[2023-07-17 19:18:47] [config] dec-cell: gru
[2023-07-17 19:18:47] [config] dec-cell-base-depth: 2
[2023-07-17 19:18:47] [config] dec-cell-high-depth: 1
[2023-07-17 19:18:47] [config] dec-depth: 1
[2023-07-17 19:18:47] [config] devices:
[2023-07-17 19:18:47] [config]   - 0
[2023-07-17 19:18:47] [config] dim-emb: 512
[2023-07-17 19:18:47] [config] dim-rnn: 1024
[2023-07-17 19:18:47] [config] dim-vocabs:
[2023-07-17 19:18:47] [config]   - 16384
[2023-07-17 19:18:47] [config]   - 16384
[2023-07-17 19:18:47] [config] disp-first: 0
[2023-07-17 19:18:47] [config] disp-freq: 1000u
[2023-07-17 19:18:47] [config] disp-label-counts: true
[2023-07-17 19:18:47] [config] dropout-rnn: 0
[2023-07-17 19:18:47] [config] dropout-src: 0
[2023-07-17 19:18:47] [config] dropout-trg: 0
[2023-07-17 19:18:47] [config] dump-config: ""
[2023-07-17 19:18:47] [config] dynamic-gradient-scaling:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] early-stopping: 5
[2023-07-17 19:18:47] [config] early-stopping-on: first
[2023-07-17 19:18:47] [config] embedding-fix-src: false
[2023-07-17 19:18:47] [config] embedding-fix-trg: false
[2023-07-17 19:18:47] [config] embedding-normalization: false
[2023-07-17 19:18:47] [config] embedding-vectors:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] enc-cell: gru
[2023-07-17 19:18:47] [config] enc-cell-depth: 1
[2023-07-17 19:18:47] [config] enc-depth: 1
[2023-07-17 19:18:47] [config] enc-type: bidirectional
[2023-07-17 19:18:47] [config] english-title-case-every: 0
[2023-07-17 19:18:47] [config] exponential-smoothing: 0
[2023-07-17 19:18:47] [config] factor-weight: 1
[2023-07-17 19:18:47] [config] factors-combine: sum
[2023-07-17 19:18:47] [config] factors-dim-emb: 0
[2023-07-17 19:18:47] [config] gradient-checkpointing: false
[2023-07-17 19:18:47] [config] gradient-norm-average-window: 100
[2023-07-17 19:18:47] [config] guided-alignment: none
[2023-07-17 19:18:47] [config] guided-alignment-cost: mse
[2023-07-17 19:18:47] [config] guided-alignment-weight: 0.1
[2023-07-17 19:18:47] [config] ignore-model-config: false
[2023-07-17 19:18:47] [config] input-types:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] interpolate-env-vars: false
[2023-07-17 19:18:47] [config] keep-best: false
[2023-07-17 19:18:47] [config] label-smoothing: 0
[2023-07-17 19:18:47] [config] layer-normalization: false
[2023-07-17 19:18:47] [config] learn-rate: 0.0001
[2023-07-17 19:18:47] [config] lemma-dependency: ""
[2023-07-17 19:18:47] [config] lemma-dim-emb: 0
[2023-07-17 19:18:47] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 19:18:47] [config] log-level: info
[2023-07-17 19:18:47] [config] log-time-zone: ""
[2023-07-17 19:18:47] [config] logical-epoch:
[2023-07-17 19:18:47] [config]   - 1e
[2023-07-17 19:18:47] [config]   - 0
[2023-07-17 19:18:47] [config] lr-decay: 0
[2023-07-17 19:18:47] [config] lr-decay-freq: 50000
[2023-07-17 19:18:47] [config] lr-decay-inv-sqrt:
[2023-07-17 19:18:47] [config]   - 0
[2023-07-17 19:18:47] [config] lr-decay-repeat-warmup: false
[2023-07-17 19:18:47] [config] lr-decay-reset-optimizer: false
[2023-07-17 19:18:47] [config] lr-decay-start:
[2023-07-17 19:18:47] [config]   - 10
[2023-07-17 19:18:47] [config]   - 1
[2023-07-17 19:18:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 19:18:47] [config] lr-report: false
[2023-07-17 19:18:47] [config] lr-warmup: 0
[2023-07-17 19:18:47] [config] lr-warmup-at-reload: false
[2023-07-17 19:18:47] [config] lr-warmup-cycle: false
[2023-07-17 19:18:47] [config] lr-warmup-start-rate: 0
[2023-07-17 19:18:47] [config] max-length: 200
[2023-07-17 19:18:47] [config] max-length-crop: true
[2023-07-17 19:18:47] [config] max-length-factor: 3
[2023-07-17 19:18:47] [config] maxi-batch: 100
[2023-07-17 19:18:47] [config] maxi-batch-sort: trg
[2023-07-17 19:18:47] [config] mini-batch: 64
[2023-07-17 19:18:47] [config] mini-batch-fit: true
[2023-07-17 19:18:47] [config] mini-batch-fit-step: 10
[2023-07-17 19:18:47] [config] mini-batch-round-up: true
[2023-07-17 19:18:47] [config] mini-batch-track-lr: false
[2023-07-17 19:18:47] [config] mini-batch-warmup: 0
[2023-07-17 19:18:47] [config] mini-batch-words: 0
[2023-07-17 19:18:47] [config] mini-batch-words-ref: 0
[2023-07-17 19:18:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 19:18:47] [config] multi-loss-type: sum
[2023-07-17 19:18:47] [config] n-best: false
[2023-07-17 19:18:47] [config] no-nccl: false
[2023-07-17 19:18:47] [config] no-reload: false
[2023-07-17 19:18:47] [config] no-restore-corpus: false
[2023-07-17 19:18:47] [config] normalize: 0
[2023-07-17 19:18:47] [config] normalize-gradient: false
[2023-07-17 19:18:47] [config] num-devices: 0
[2023-07-17 19:18:47] [config] optimizer: adam
[2023-07-17 19:18:47] [config] optimizer-delay: 1
[2023-07-17 19:18:47] [config] optimizer-params:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] output-omit-bias: false
[2023-07-17 19:18:47] [config] overwrite: true
[2023-07-17 19:18:47] [config] precision:
[2023-07-17 19:18:47] [config]   - float16
[2023-07-17 19:18:47] [config]   - float32
[2023-07-17 19:18:47] [config] pretrained-model: ""
[2023-07-17 19:18:47] [config] quantize-biases: false
[2023-07-17 19:18:47] [config] quantize-bits: 0
[2023-07-17 19:18:47] [config] quantize-log-based: false
[2023-07-17 19:18:47] [config] quantize-optimization-steps: 0
[2023-07-17 19:18:47] [config] quiet: false
[2023-07-17 19:18:47] [config] quiet-translation: true
[2023-07-17 19:18:47] [config] relative-paths: false
[2023-07-17 19:18:47] [config] right-left: false
[2023-07-17 19:18:47] [config] save-freq: 10000u
[2023-07-17 19:18:47] [config] seed: 1234
[2023-07-17 19:18:47] [config] sentencepiece-alphas:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] sentencepiece-max-lines: 2000000
[2023-07-17 19:18:47] [config] sentencepiece-options: ""
[2023-07-17 19:18:47] [config] sharding: global
[2023-07-17 19:18:47] [config] shuffle: data
[2023-07-17 19:18:47] [config] shuffle-in-ram: false
[2023-07-17 19:18:47] [config] sigterm: save-and-exit
[2023-07-17 19:18:47] [config] skip: false
[2023-07-17 19:18:47] [config] sqlite: ""
[2023-07-17 19:18:47] [config] sqlite-drop: false
[2023-07-17 19:18:47] [config] sync-freq: 200u
[2023-07-17 19:18:47] [config] sync-sgd: false
[2023-07-17 19:18:47] [config] tempdir: /tmp
[2023-07-17 19:18:47] [config] tied-embeddings: false
[2023-07-17 19:18:47] [config] tied-embeddings-all: true
[2023-07-17 19:18:47] [config] tied-embeddings-src: false
[2023-07-17 19:18:47] [config] train-embedder-rank:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] train-sets:
[2023-07-17 19:18:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 19:18:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 19:18:47] [config] transformer-aan-activation: swish
[2023-07-17 19:18:47] [config] transformer-aan-depth: 2
[2023-07-17 19:18:47] [config] transformer-aan-nogate: false
[2023-07-17 19:18:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 19:18:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 19:18:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 19:18:47] [config] transformer-depth-scaling: false
[2023-07-17 19:18:47] [config] transformer-dim-aan: 2048
[2023-07-17 19:18:47] [config] transformer-dim-ffn: 2048
[2023-07-17 19:18:47] [config] transformer-dropout: 0
[2023-07-17 19:18:47] [config] transformer-dropout-attention: 0
[2023-07-17 19:18:47] [config] transformer-dropout-ffn: 0
[2023-07-17 19:18:47] [config] transformer-ffn-activation: swish
[2023-07-17 19:18:47] [config] transformer-ffn-depth: 2
[2023-07-17 19:18:47] [config] transformer-guided-alignment-layer: last
[2023-07-17 19:18:47] [config] transformer-heads: 8
[2023-07-17 19:18:47] [config] transformer-no-projection: false
[2023-07-17 19:18:47] [config] transformer-pool: false
[2023-07-17 19:18:47] [config] transformer-postprocess: dan
[2023-07-17 19:18:47] [config] transformer-postprocess-emb: d
[2023-07-17 19:18:47] [config] transformer-postprocess-top: ""
[2023-07-17 19:18:47] [config] transformer-preprocess: ""
[2023-07-17 19:18:47] [config] transformer-tied-layers:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] transformer-train-position-embeddings: false
[2023-07-17 19:18:47] [config] tsv: false
[2023-07-17 19:18:47] [config] tsv-fields: 0
[2023-07-17 19:18:47] [config] type: amun
[2023-07-17 19:18:47] [config] ulr: false
[2023-07-17 19:18:47] [config] ulr-dim-emb: 0
[2023-07-17 19:18:47] [config] ulr-dropout: 0
[2023-07-17 19:18:47] [config] ulr-keys-vectors: ""
[2023-07-17 19:18:47] [config] ulr-query-vectors: ""
[2023-07-17 19:18:47] [config] ulr-softmax-temperature: 1
[2023-07-17 19:18:47] [config] ulr-trainable-transformation: false
[2023-07-17 19:18:47] [config] unlikelihood-loss: false
[2023-07-17 19:18:47] [config] valid-freq: 50000000
[2023-07-17 19:18:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 19:18:47] [config] valid-max-length: 1000
[2023-07-17 19:18:47] [config] valid-metrics:
[2023-07-17 19:18:47] [config]   - cross-entropy
[2023-07-17 19:18:47] [config]   - translation
[2023-07-17 19:18:47] [config] valid-mini-batch: 32
[2023-07-17 19:18:47] [config] valid-reset-stalled: false
[2023-07-17 19:18:47] [config] valid-script-args:
[2023-07-17 19:18:47] [config]   []
[2023-07-17 19:18:47] [config] valid-script-path: ""
[2023-07-17 19:18:47] [config] valid-sets:
[2023-07-17 19:18:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 19:18:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 19:18:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 19:18:47] [config] vocabs:
[2023-07-17 19:18:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 19:18:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 19:18:47] [config] word-penalty: 0
[2023-07-17 19:18:47] [config] word-scores: false
[2023-07-17 19:18:47] [config] workspace: 5500
[2023-07-17 19:18:47] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 19:18:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 19:18:47] [training] Using single-device training
[2023-07-17 19:18:47] Synced seed 1234
[2023-07-17 19:18:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 19:18:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 19:18:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 19:18:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 19:18:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 19:18:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 19:18:47] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 19:18:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 19:18:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 19:18:48] [comm] Using global sharding
[2023-07-17 19:18:48] [comm] NCCLCommunicators constructed successfully
[2023-07-17 19:18:48] [training] Using 1 GPUs
[2023-07-17 19:18:48] [logits] Applying loss function for 1 factor(s)
[2023-07-17 19:18:48] [memory] Reserving 80 MB, device gpu0
[2023-07-17 19:18:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 19:18:48] [memory] Reserving 80 MB, device gpu0
[2023-07-17 19:55:08] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 19:55:08] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 19:55:08] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x561958676231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x5619586cbca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x5619586e2d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x561958af6e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x561958b05348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x5619585aab9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x5619584cc2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x561958483b9c]    main                                               + 0x3c
[0x7f24a79650b3]    __libc_start_main                                  + 0xf3
[0x5619584cacbe]    _start                                             + 0x2e

[2023-07-17 19:55:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 19:55:09] [marian] Running on node22.datos.cluster.uy as process 31860 with command line:
[2023-07-17 19:55:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 19:55:09] [config] after: 0e
[2023-07-17 19:55:09] [config] after-batches: 0
[2023-07-17 19:55:09] [config] after-epochs: 110
[2023-07-17 19:55:09] [config] all-caps-every: 0
[2023-07-17 19:55:09] [config] allow-unk: false
[2023-07-17 19:55:09] [config] authors: false
[2023-07-17 19:55:09] [config] beam-size: 12
[2023-07-17 19:55:09] [config] bert-class-symbol: "[CLS]"
[2023-07-17 19:55:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 19:55:09] [config] bert-masking-fraction: 0.15
[2023-07-17 19:55:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 19:55:09] [config] bert-train-type-embeddings: true
[2023-07-17 19:55:09] [config] bert-type-vocab-size: 2
[2023-07-17 19:55:09] [config] build-info: ""
[2023-07-17 19:55:09] [config] check-gradient-nan: false
[2023-07-17 19:55:09] [config] check-nan: false
[2023-07-17 19:55:09] [config] cite: false
[2023-07-17 19:55:09] [config] clip-norm: 1
[2023-07-17 19:55:09] [config] cost-scaling:
[2023-07-17 19:55:09] [config]   - 256.f
[2023-07-17 19:55:09] [config]   - 1000
[2023-07-17 19:55:09] [config]   - 2.f
[2023-07-17 19:55:09] [config]   - 256.f
[2023-07-17 19:55:09] [config] cost-type: ce-sum
[2023-07-17 19:55:09] [config] cpu-threads: 0
[2023-07-17 19:55:09] [config] data-threads: 8
[2023-07-17 19:55:09] [config] data-weighting: ""
[2023-07-17 19:55:09] [config] data-weighting-type: sentence
[2023-07-17 19:55:09] [config] dec-cell: gru
[2023-07-17 19:55:09] [config] dec-cell-base-depth: 2
[2023-07-17 19:55:09] [config] dec-cell-high-depth: 1
[2023-07-17 19:55:09] [config] dec-depth: 1
[2023-07-17 19:55:09] [config] devices:
[2023-07-17 19:55:09] [config]   - 0
[2023-07-17 19:55:09] [config] dim-emb: 512
[2023-07-17 19:55:09] [config] dim-rnn: 1024
[2023-07-17 19:55:09] [config] dim-vocabs:
[2023-07-17 19:55:09] [config]   - 16384
[2023-07-17 19:55:09] [config]   - 16384
[2023-07-17 19:55:09] [config] disp-first: 0
[2023-07-17 19:55:09] [config] disp-freq: 1000u
[2023-07-17 19:55:09] [config] disp-label-counts: true
[2023-07-17 19:55:09] [config] dropout-rnn: 0
[2023-07-17 19:55:09] [config] dropout-src: 0
[2023-07-17 19:55:09] [config] dropout-trg: 0
[2023-07-17 19:55:09] [config] dump-config: ""
[2023-07-17 19:55:09] [config] dynamic-gradient-scaling:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] early-stopping: 5
[2023-07-17 19:55:09] [config] early-stopping-on: first
[2023-07-17 19:55:09] [config] embedding-fix-src: false
[2023-07-17 19:55:09] [config] embedding-fix-trg: false
[2023-07-17 19:55:09] [config] embedding-normalization: false
[2023-07-17 19:55:09] [config] embedding-vectors:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] enc-cell: gru
[2023-07-17 19:55:09] [config] enc-cell-depth: 1
[2023-07-17 19:55:09] [config] enc-depth: 1
[2023-07-17 19:55:09] [config] enc-type: bidirectional
[2023-07-17 19:55:09] [config] english-title-case-every: 0
[2023-07-17 19:55:09] [config] exponential-smoothing: 0
[2023-07-17 19:55:09] [config] factor-weight: 1
[2023-07-17 19:55:09] [config] factors-combine: sum
[2023-07-17 19:55:09] [config] factors-dim-emb: 0
[2023-07-17 19:55:09] [config] gradient-checkpointing: false
[2023-07-17 19:55:09] [config] gradient-norm-average-window: 100
[2023-07-17 19:55:09] [config] guided-alignment: none
[2023-07-17 19:55:09] [config] guided-alignment-cost: mse
[2023-07-17 19:55:09] [config] guided-alignment-weight: 0.1
[2023-07-17 19:55:09] [config] ignore-model-config: false
[2023-07-17 19:55:09] [config] input-types:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] interpolate-env-vars: false
[2023-07-17 19:55:09] [config] keep-best: false
[2023-07-17 19:55:09] [config] label-smoothing: 0
[2023-07-17 19:55:09] [config] layer-normalization: false
[2023-07-17 19:55:09] [config] learn-rate: 0.0001
[2023-07-17 19:55:09] [config] lemma-dependency: ""
[2023-07-17 19:55:09] [config] lemma-dim-emb: 0
[2023-07-17 19:55:09] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 19:55:09] [config] log-level: info
[2023-07-17 19:55:09] [config] log-time-zone: ""
[2023-07-17 19:55:09] [config] logical-epoch:
[2023-07-17 19:55:09] [config]   - 1e
[2023-07-17 19:55:09] [config]   - 0
[2023-07-17 19:55:09] [config] lr-decay: 0
[2023-07-17 19:55:09] [config] lr-decay-freq: 50000
[2023-07-17 19:55:09] [config] lr-decay-inv-sqrt:
[2023-07-17 19:55:09] [config]   - 0
[2023-07-17 19:55:09] [config] lr-decay-repeat-warmup: false
[2023-07-17 19:55:09] [config] lr-decay-reset-optimizer: false
[2023-07-17 19:55:09] [config] lr-decay-start:
[2023-07-17 19:55:09] [config]   - 10
[2023-07-17 19:55:09] [config]   - 1
[2023-07-17 19:55:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 19:55:09] [config] lr-report: false
[2023-07-17 19:55:09] [config] lr-warmup: 0
[2023-07-17 19:55:09] [config] lr-warmup-at-reload: false
[2023-07-17 19:55:09] [config] lr-warmup-cycle: false
[2023-07-17 19:55:09] [config] lr-warmup-start-rate: 0
[2023-07-17 19:55:09] [config] max-length: 200
[2023-07-17 19:55:09] [config] max-length-crop: true
[2023-07-17 19:55:09] [config] max-length-factor: 3
[2023-07-17 19:55:09] [config] maxi-batch: 100
[2023-07-17 19:55:09] [config] maxi-batch-sort: trg
[2023-07-17 19:55:09] [config] mini-batch: 64
[2023-07-17 19:55:09] [config] mini-batch-fit: true
[2023-07-17 19:55:09] [config] mini-batch-fit-step: 10
[2023-07-17 19:55:09] [config] mini-batch-round-up: true
[2023-07-17 19:55:09] [config] mini-batch-track-lr: false
[2023-07-17 19:55:09] [config] mini-batch-warmup: 0
[2023-07-17 19:55:09] [config] mini-batch-words: 0
[2023-07-17 19:55:09] [config] mini-batch-words-ref: 0
[2023-07-17 19:55:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 19:55:09] [config] multi-loss-type: sum
[2023-07-17 19:55:09] [config] n-best: false
[2023-07-17 19:55:09] [config] no-nccl: false
[2023-07-17 19:55:09] [config] no-reload: false
[2023-07-17 19:55:09] [config] no-restore-corpus: false
[2023-07-17 19:55:09] [config] normalize: 0
[2023-07-17 19:55:09] [config] normalize-gradient: false
[2023-07-17 19:55:09] [config] num-devices: 0
[2023-07-17 19:55:09] [config] optimizer: adam
[2023-07-17 19:55:09] [config] optimizer-delay: 1
[2023-07-17 19:55:09] [config] optimizer-params:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] output-omit-bias: false
[2023-07-17 19:55:09] [config] overwrite: true
[2023-07-17 19:55:09] [config] precision:
[2023-07-17 19:55:09] [config]   - float16
[2023-07-17 19:55:09] [config]   - float32
[2023-07-17 19:55:09] [config] pretrained-model: ""
[2023-07-17 19:55:09] [config] quantize-biases: false
[2023-07-17 19:55:09] [config] quantize-bits: 0
[2023-07-17 19:55:09] [config] quantize-log-based: false
[2023-07-17 19:55:09] [config] quantize-optimization-steps: 0
[2023-07-17 19:55:09] [config] quiet: false
[2023-07-17 19:55:09] [config] quiet-translation: true
[2023-07-17 19:55:09] [config] relative-paths: false
[2023-07-17 19:55:09] [config] right-left: false
[2023-07-17 19:55:09] [config] save-freq: 10000u
[2023-07-17 19:55:09] [config] seed: 1234
[2023-07-17 19:55:09] [config] sentencepiece-alphas:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] sentencepiece-max-lines: 2000000
[2023-07-17 19:55:09] [config] sentencepiece-options: ""
[2023-07-17 19:55:09] [config] sharding: global
[2023-07-17 19:55:09] [config] shuffle: data
[2023-07-17 19:55:09] [config] shuffle-in-ram: false
[2023-07-17 19:55:09] [config] sigterm: save-and-exit
[2023-07-17 19:55:09] [config] skip: false
[2023-07-17 19:55:09] [config] sqlite: ""
[2023-07-17 19:55:09] [config] sqlite-drop: false
[2023-07-17 19:55:09] [config] sync-freq: 200u
[2023-07-17 19:55:09] [config] sync-sgd: false
[2023-07-17 19:55:09] [config] tempdir: /tmp
[2023-07-17 19:55:09] [config] tied-embeddings: false
[2023-07-17 19:55:09] [config] tied-embeddings-all: true
[2023-07-17 19:55:09] [config] tied-embeddings-src: false
[2023-07-17 19:55:09] [config] train-embedder-rank:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] train-sets:
[2023-07-17 19:55:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 19:55:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 19:55:09] [config] transformer-aan-activation: swish
[2023-07-17 19:55:09] [config] transformer-aan-depth: 2
[2023-07-17 19:55:09] [config] transformer-aan-nogate: false
[2023-07-17 19:55:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 19:55:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 19:55:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 19:55:09] [config] transformer-depth-scaling: false
[2023-07-17 19:55:09] [config] transformer-dim-aan: 2048
[2023-07-17 19:55:09] [config] transformer-dim-ffn: 2048
[2023-07-17 19:55:09] [config] transformer-dropout: 0
[2023-07-17 19:55:09] [config] transformer-dropout-attention: 0
[2023-07-17 19:55:09] [config] transformer-dropout-ffn: 0
[2023-07-17 19:55:09] [config] transformer-ffn-activation: swish
[2023-07-17 19:55:09] [config] transformer-ffn-depth: 2
[2023-07-17 19:55:09] [config] transformer-guided-alignment-layer: last
[2023-07-17 19:55:09] [config] transformer-heads: 8
[2023-07-17 19:55:09] [config] transformer-no-projection: false
[2023-07-17 19:55:09] [config] transformer-pool: false
[2023-07-17 19:55:09] [config] transformer-postprocess: dan
[2023-07-17 19:55:09] [config] transformer-postprocess-emb: d
[2023-07-17 19:55:09] [config] transformer-postprocess-top: ""
[2023-07-17 19:55:09] [config] transformer-preprocess: ""
[2023-07-17 19:55:09] [config] transformer-tied-layers:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] transformer-train-position-embeddings: false
[2023-07-17 19:55:09] [config] tsv: false
[2023-07-17 19:55:09] [config] tsv-fields: 0
[2023-07-17 19:55:09] [config] type: amun
[2023-07-17 19:55:09] [config] ulr: false
[2023-07-17 19:55:09] [config] ulr-dim-emb: 0
[2023-07-17 19:55:09] [config] ulr-dropout: 0
[2023-07-17 19:55:09] [config] ulr-keys-vectors: ""
[2023-07-17 19:55:09] [config] ulr-query-vectors: ""
[2023-07-17 19:55:09] [config] ulr-softmax-temperature: 1
[2023-07-17 19:55:09] [config] ulr-trainable-transformation: false
[2023-07-17 19:55:09] [config] unlikelihood-loss: false
[2023-07-17 19:55:09] [config] valid-freq: 50000000
[2023-07-17 19:55:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 19:55:09] [config] valid-max-length: 1000
[2023-07-17 19:55:09] [config] valid-metrics:
[2023-07-17 19:55:09] [config]   - cross-entropy
[2023-07-17 19:55:09] [config]   - translation
[2023-07-17 19:55:09] [config] valid-mini-batch: 32
[2023-07-17 19:55:09] [config] valid-reset-stalled: false
[2023-07-17 19:55:09] [config] valid-script-args:
[2023-07-17 19:55:09] [config]   []
[2023-07-17 19:55:09] [config] valid-script-path: ""
[2023-07-17 19:55:09] [config] valid-sets:
[2023-07-17 19:55:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 19:55:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 19:55:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 19:55:09] [config] vocabs:
[2023-07-17 19:55:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 19:55:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 19:55:09] [config] word-penalty: 0
[2023-07-17 19:55:09] [config] word-scores: false
[2023-07-17 19:55:09] [config] workspace: 5500
[2023-07-17 19:55:09] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 19:55:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 19:55:09] [training] Using single-device training
[2023-07-17 19:55:09] Synced seed 1234
[2023-07-17 19:55:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 19:55:09] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 19:55:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 19:55:09] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 19:55:09] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 19:55:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 19:55:09] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 19:55:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 19:55:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 19:55:11] [comm] Using global sharding
[2023-07-17 19:55:11] [comm] NCCLCommunicators constructed successfully
[2023-07-17 19:55:11] [training] Using 1 GPUs
[2023-07-17 19:55:11] [logits] Applying loss function for 1 factor(s)
[2023-07-17 19:55:11] [memory] Reserving 80 MB, device gpu0
[2023-07-17 19:55:11] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 19:55:11] [memory] Reserving 80 MB, device gpu0
[2023-07-17 20:31:28] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 20:31:29] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 20:31:29] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x556a26aff231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x556a26b54ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x556a26b6bd5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x556a26f7fe1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x556a26f8e348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x556a26a33b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x556a269552c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x556a2690cb9c]    main                                               + 0x3c
[0x7f26d24cd0b3]    __libc_start_main                                  + 0xf3
[0x556a26953cbe]    _start                                             + 0x2e

[2023-07-17 20:31:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 20:31:29] [marian] Running on node22.datos.cluster.uy as process 34438 with command line:
[2023-07-17 20:31:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 20:31:29] [config] after: 0e
[2023-07-17 20:31:29] [config] after-batches: 0
[2023-07-17 20:31:29] [config] after-epochs: 120
[2023-07-17 20:31:29] [config] all-caps-every: 0
[2023-07-17 20:31:29] [config] allow-unk: false
[2023-07-17 20:31:29] [config] authors: false
[2023-07-17 20:31:29] [config] beam-size: 12
[2023-07-17 20:31:29] [config] bert-class-symbol: "[CLS]"
[2023-07-17 20:31:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 20:31:29] [config] bert-masking-fraction: 0.15
[2023-07-17 20:31:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 20:31:29] [config] bert-train-type-embeddings: true
[2023-07-17 20:31:29] [config] bert-type-vocab-size: 2
[2023-07-17 20:31:29] [config] build-info: ""
[2023-07-17 20:31:29] [config] check-gradient-nan: false
[2023-07-17 20:31:29] [config] check-nan: false
[2023-07-17 20:31:29] [config] cite: false
[2023-07-17 20:31:29] [config] clip-norm: 1
[2023-07-17 20:31:29] [config] cost-scaling:
[2023-07-17 20:31:29] [config]   - 256.f
[2023-07-17 20:31:29] [config]   - 1000
[2023-07-17 20:31:29] [config]   - 2.f
[2023-07-17 20:31:29] [config]   - 256.f
[2023-07-17 20:31:29] [config] cost-type: ce-sum
[2023-07-17 20:31:29] [config] cpu-threads: 0
[2023-07-17 20:31:29] [config] data-threads: 8
[2023-07-17 20:31:29] [config] data-weighting: ""
[2023-07-17 20:31:29] [config] data-weighting-type: sentence
[2023-07-17 20:31:29] [config] dec-cell: gru
[2023-07-17 20:31:29] [config] dec-cell-base-depth: 2
[2023-07-17 20:31:29] [config] dec-cell-high-depth: 1
[2023-07-17 20:31:29] [config] dec-depth: 1
[2023-07-17 20:31:29] [config] devices:
[2023-07-17 20:31:29] [config]   - 0
[2023-07-17 20:31:29] [config] dim-emb: 512
[2023-07-17 20:31:29] [config] dim-rnn: 1024
[2023-07-17 20:31:29] [config] dim-vocabs:
[2023-07-17 20:31:29] [config]   - 16384
[2023-07-17 20:31:29] [config]   - 16384
[2023-07-17 20:31:29] [config] disp-first: 0
[2023-07-17 20:31:29] [config] disp-freq: 1000u
[2023-07-17 20:31:29] [config] disp-label-counts: true
[2023-07-17 20:31:29] [config] dropout-rnn: 0
[2023-07-17 20:31:29] [config] dropout-src: 0
[2023-07-17 20:31:29] [config] dropout-trg: 0
[2023-07-17 20:31:29] [config] dump-config: ""
[2023-07-17 20:31:29] [config] dynamic-gradient-scaling:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] early-stopping: 5
[2023-07-17 20:31:29] [config] early-stopping-on: first
[2023-07-17 20:31:29] [config] embedding-fix-src: false
[2023-07-17 20:31:29] [config] embedding-fix-trg: false
[2023-07-17 20:31:29] [config] embedding-normalization: false
[2023-07-17 20:31:29] [config] embedding-vectors:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] enc-cell: gru
[2023-07-17 20:31:29] [config] enc-cell-depth: 1
[2023-07-17 20:31:29] [config] enc-depth: 1
[2023-07-17 20:31:29] [config] enc-type: bidirectional
[2023-07-17 20:31:29] [config] english-title-case-every: 0
[2023-07-17 20:31:29] [config] exponential-smoothing: 0
[2023-07-17 20:31:29] [config] factor-weight: 1
[2023-07-17 20:31:29] [config] factors-combine: sum
[2023-07-17 20:31:29] [config] factors-dim-emb: 0
[2023-07-17 20:31:29] [config] gradient-checkpointing: false
[2023-07-17 20:31:29] [config] gradient-norm-average-window: 100
[2023-07-17 20:31:29] [config] guided-alignment: none
[2023-07-17 20:31:29] [config] guided-alignment-cost: mse
[2023-07-17 20:31:29] [config] guided-alignment-weight: 0.1
[2023-07-17 20:31:29] [config] ignore-model-config: false
[2023-07-17 20:31:29] [config] input-types:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] interpolate-env-vars: false
[2023-07-17 20:31:29] [config] keep-best: false
[2023-07-17 20:31:29] [config] label-smoothing: 0
[2023-07-17 20:31:29] [config] layer-normalization: false
[2023-07-17 20:31:29] [config] learn-rate: 0.0001
[2023-07-17 20:31:29] [config] lemma-dependency: ""
[2023-07-17 20:31:29] [config] lemma-dim-emb: 0
[2023-07-17 20:31:29] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 20:31:29] [config] log-level: info
[2023-07-17 20:31:29] [config] log-time-zone: ""
[2023-07-17 20:31:29] [config] logical-epoch:
[2023-07-17 20:31:29] [config]   - 1e
[2023-07-17 20:31:29] [config]   - 0
[2023-07-17 20:31:29] [config] lr-decay: 0
[2023-07-17 20:31:29] [config] lr-decay-freq: 50000
[2023-07-17 20:31:29] [config] lr-decay-inv-sqrt:
[2023-07-17 20:31:29] [config]   - 0
[2023-07-17 20:31:29] [config] lr-decay-repeat-warmup: false
[2023-07-17 20:31:29] [config] lr-decay-reset-optimizer: false
[2023-07-17 20:31:29] [config] lr-decay-start:
[2023-07-17 20:31:29] [config]   - 10
[2023-07-17 20:31:29] [config]   - 1
[2023-07-17 20:31:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 20:31:29] [config] lr-report: false
[2023-07-17 20:31:29] [config] lr-warmup: 0
[2023-07-17 20:31:29] [config] lr-warmup-at-reload: false
[2023-07-17 20:31:29] [config] lr-warmup-cycle: false
[2023-07-17 20:31:29] [config] lr-warmup-start-rate: 0
[2023-07-17 20:31:29] [config] max-length: 200
[2023-07-17 20:31:29] [config] max-length-crop: true
[2023-07-17 20:31:29] [config] max-length-factor: 3
[2023-07-17 20:31:29] [config] maxi-batch: 100
[2023-07-17 20:31:29] [config] maxi-batch-sort: trg
[2023-07-17 20:31:29] [config] mini-batch: 64
[2023-07-17 20:31:29] [config] mini-batch-fit: true
[2023-07-17 20:31:29] [config] mini-batch-fit-step: 10
[2023-07-17 20:31:29] [config] mini-batch-round-up: true
[2023-07-17 20:31:29] [config] mini-batch-track-lr: false
[2023-07-17 20:31:29] [config] mini-batch-warmup: 0
[2023-07-17 20:31:29] [config] mini-batch-words: 0
[2023-07-17 20:31:29] [config] mini-batch-words-ref: 0
[2023-07-17 20:31:29] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 20:31:29] [config] multi-loss-type: sum
[2023-07-17 20:31:29] [config] n-best: false
[2023-07-17 20:31:29] [config] no-nccl: false
[2023-07-17 20:31:29] [config] no-reload: false
[2023-07-17 20:31:29] [config] no-restore-corpus: false
[2023-07-17 20:31:29] [config] normalize: 0
[2023-07-17 20:31:29] [config] normalize-gradient: false
[2023-07-17 20:31:29] [config] num-devices: 0
[2023-07-17 20:31:29] [config] optimizer: adam
[2023-07-17 20:31:29] [config] optimizer-delay: 1
[2023-07-17 20:31:29] [config] optimizer-params:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] output-omit-bias: false
[2023-07-17 20:31:29] [config] overwrite: true
[2023-07-17 20:31:29] [config] precision:
[2023-07-17 20:31:29] [config]   - float16
[2023-07-17 20:31:29] [config]   - float32
[2023-07-17 20:31:29] [config] pretrained-model: ""
[2023-07-17 20:31:29] [config] quantize-biases: false
[2023-07-17 20:31:29] [config] quantize-bits: 0
[2023-07-17 20:31:29] [config] quantize-log-based: false
[2023-07-17 20:31:29] [config] quantize-optimization-steps: 0
[2023-07-17 20:31:29] [config] quiet: false
[2023-07-17 20:31:29] [config] quiet-translation: true
[2023-07-17 20:31:29] [config] relative-paths: false
[2023-07-17 20:31:29] [config] right-left: false
[2023-07-17 20:31:29] [config] save-freq: 10000u
[2023-07-17 20:31:29] [config] seed: 1234
[2023-07-17 20:31:29] [config] sentencepiece-alphas:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] sentencepiece-max-lines: 2000000
[2023-07-17 20:31:29] [config] sentencepiece-options: ""
[2023-07-17 20:31:29] [config] sharding: global
[2023-07-17 20:31:29] [config] shuffle: data
[2023-07-17 20:31:29] [config] shuffle-in-ram: false
[2023-07-17 20:31:29] [config] sigterm: save-and-exit
[2023-07-17 20:31:29] [config] skip: false
[2023-07-17 20:31:29] [config] sqlite: ""
[2023-07-17 20:31:29] [config] sqlite-drop: false
[2023-07-17 20:31:29] [config] sync-freq: 200u
[2023-07-17 20:31:29] [config] sync-sgd: false
[2023-07-17 20:31:29] [config] tempdir: /tmp
[2023-07-17 20:31:29] [config] tied-embeddings: false
[2023-07-17 20:31:29] [config] tied-embeddings-all: true
[2023-07-17 20:31:29] [config] tied-embeddings-src: false
[2023-07-17 20:31:29] [config] train-embedder-rank:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] train-sets:
[2023-07-17 20:31:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 20:31:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 20:31:29] [config] transformer-aan-activation: swish
[2023-07-17 20:31:29] [config] transformer-aan-depth: 2
[2023-07-17 20:31:29] [config] transformer-aan-nogate: false
[2023-07-17 20:31:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 20:31:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 20:31:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 20:31:29] [config] transformer-depth-scaling: false
[2023-07-17 20:31:29] [config] transformer-dim-aan: 2048
[2023-07-17 20:31:29] [config] transformer-dim-ffn: 2048
[2023-07-17 20:31:29] [config] transformer-dropout: 0
[2023-07-17 20:31:29] [config] transformer-dropout-attention: 0
[2023-07-17 20:31:29] [config] transformer-dropout-ffn: 0
[2023-07-17 20:31:29] [config] transformer-ffn-activation: swish
[2023-07-17 20:31:29] [config] transformer-ffn-depth: 2
[2023-07-17 20:31:29] [config] transformer-guided-alignment-layer: last
[2023-07-17 20:31:29] [config] transformer-heads: 8
[2023-07-17 20:31:29] [config] transformer-no-projection: false
[2023-07-17 20:31:29] [config] transformer-pool: false
[2023-07-17 20:31:29] [config] transformer-postprocess: dan
[2023-07-17 20:31:29] [config] transformer-postprocess-emb: d
[2023-07-17 20:31:29] [config] transformer-postprocess-top: ""
[2023-07-17 20:31:29] [config] transformer-preprocess: ""
[2023-07-17 20:31:29] [config] transformer-tied-layers:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] transformer-train-position-embeddings: false
[2023-07-17 20:31:29] [config] tsv: false
[2023-07-17 20:31:29] [config] tsv-fields: 0
[2023-07-17 20:31:29] [config] type: amun
[2023-07-17 20:31:29] [config] ulr: false
[2023-07-17 20:31:29] [config] ulr-dim-emb: 0
[2023-07-17 20:31:29] [config] ulr-dropout: 0
[2023-07-17 20:31:29] [config] ulr-keys-vectors: ""
[2023-07-17 20:31:29] [config] ulr-query-vectors: ""
[2023-07-17 20:31:29] [config] ulr-softmax-temperature: 1
[2023-07-17 20:31:29] [config] ulr-trainable-transformation: false
[2023-07-17 20:31:29] [config] unlikelihood-loss: false
[2023-07-17 20:31:29] [config] valid-freq: 50000000
[2023-07-17 20:31:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 20:31:29] [config] valid-max-length: 1000
[2023-07-17 20:31:29] [config] valid-metrics:
[2023-07-17 20:31:29] [config]   - cross-entropy
[2023-07-17 20:31:29] [config]   - translation
[2023-07-17 20:31:29] [config] valid-mini-batch: 32
[2023-07-17 20:31:29] [config] valid-reset-stalled: false
[2023-07-17 20:31:29] [config] valid-script-args:
[2023-07-17 20:31:29] [config]   []
[2023-07-17 20:31:29] [config] valid-script-path: ""
[2023-07-17 20:31:29] [config] valid-sets:
[2023-07-17 20:31:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 20:31:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 20:31:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 20:31:29] [config] vocabs:
[2023-07-17 20:31:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 20:31:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 20:31:29] [config] word-penalty: 0
[2023-07-17 20:31:29] [config] word-scores: false
[2023-07-17 20:31:29] [config] workspace: 5500
[2023-07-17 20:31:29] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 20:31:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 20:31:29] [training] Using single-device training
[2023-07-17 20:31:30] Synced seed 1234
[2023-07-17 20:31:30] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 20:31:30] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 20:31:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 20:31:30] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 20:31:30] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 20:31:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 20:31:30] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 20:31:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 20:31:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 20:31:31] [comm] Using global sharding
[2023-07-17 20:31:31] [comm] NCCLCommunicators constructed successfully
[2023-07-17 20:31:31] [training] Using 1 GPUs
[2023-07-17 20:31:31] [logits] Applying loss function for 1 factor(s)
[2023-07-17 20:31:31] [memory] Reserving 80 MB, device gpu0
[2023-07-17 20:31:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 20:31:31] [memory] Reserving 80 MB, device gpu0
[2023-07-17 21:07:56] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 21:07:56] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 21:07:56] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x557d1f332231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x557d1f387ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x557d1f39ed5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x557d1f7b2e1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x557d1f7c1348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x557d1f266b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x557d1f1882c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x557d1f13fb9c]    main                                               + 0x3c
[0x7f9f806430b3]    __libc_start_main                                  + 0xf3
[0x557d1f186cbe]    _start                                             + 0x2e

[2023-07-17 21:07:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 21:07:57] [marian] Running on node22.datos.cluster.uy as process 36701 with command line:
[2023-07-17 21:07:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 21:07:57] [config] after: 0e
[2023-07-17 21:07:57] [config] after-batches: 0
[2023-07-17 21:07:57] [config] after-epochs: 130
[2023-07-17 21:07:57] [config] all-caps-every: 0
[2023-07-17 21:07:57] [config] allow-unk: false
[2023-07-17 21:07:57] [config] authors: false
[2023-07-17 21:07:57] [config] beam-size: 12
[2023-07-17 21:07:57] [config] bert-class-symbol: "[CLS]"
[2023-07-17 21:07:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 21:07:57] [config] bert-masking-fraction: 0.15
[2023-07-17 21:07:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 21:07:57] [config] bert-train-type-embeddings: true
[2023-07-17 21:07:57] [config] bert-type-vocab-size: 2
[2023-07-17 21:07:57] [config] build-info: ""
[2023-07-17 21:07:57] [config] check-gradient-nan: false
[2023-07-17 21:07:57] [config] check-nan: false
[2023-07-17 21:07:57] [config] cite: false
[2023-07-17 21:07:57] [config] clip-norm: 1
[2023-07-17 21:07:57] [config] cost-scaling:
[2023-07-17 21:07:57] [config]   - 256.f
[2023-07-17 21:07:57] [config]   - 1000
[2023-07-17 21:07:57] [config]   - 2.f
[2023-07-17 21:07:57] [config]   - 256.f
[2023-07-17 21:07:57] [config] cost-type: ce-sum
[2023-07-17 21:07:57] [config] cpu-threads: 0
[2023-07-17 21:07:57] [config] data-threads: 8
[2023-07-17 21:07:57] [config] data-weighting: ""
[2023-07-17 21:07:57] [config] data-weighting-type: sentence
[2023-07-17 21:07:57] [config] dec-cell: gru
[2023-07-17 21:07:57] [config] dec-cell-base-depth: 2
[2023-07-17 21:07:57] [config] dec-cell-high-depth: 1
[2023-07-17 21:07:57] [config] dec-depth: 1
[2023-07-17 21:07:57] [config] devices:
[2023-07-17 21:07:57] [config]   - 0
[2023-07-17 21:07:57] [config] dim-emb: 512
[2023-07-17 21:07:57] [config] dim-rnn: 1024
[2023-07-17 21:07:57] [config] dim-vocabs:
[2023-07-17 21:07:57] [config]   - 16384
[2023-07-17 21:07:57] [config]   - 16384
[2023-07-17 21:07:57] [config] disp-first: 0
[2023-07-17 21:07:57] [config] disp-freq: 1000u
[2023-07-17 21:07:57] [config] disp-label-counts: true
[2023-07-17 21:07:57] [config] dropout-rnn: 0
[2023-07-17 21:07:57] [config] dropout-src: 0
[2023-07-17 21:07:57] [config] dropout-trg: 0
[2023-07-17 21:07:57] [config] dump-config: ""
[2023-07-17 21:07:57] [config] dynamic-gradient-scaling:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] early-stopping: 5
[2023-07-17 21:07:57] [config] early-stopping-on: first
[2023-07-17 21:07:57] [config] embedding-fix-src: false
[2023-07-17 21:07:57] [config] embedding-fix-trg: false
[2023-07-17 21:07:57] [config] embedding-normalization: false
[2023-07-17 21:07:57] [config] embedding-vectors:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] enc-cell: gru
[2023-07-17 21:07:57] [config] enc-cell-depth: 1
[2023-07-17 21:07:57] [config] enc-depth: 1
[2023-07-17 21:07:57] [config] enc-type: bidirectional
[2023-07-17 21:07:57] [config] english-title-case-every: 0
[2023-07-17 21:07:57] [config] exponential-smoothing: 0
[2023-07-17 21:07:57] [config] factor-weight: 1
[2023-07-17 21:07:57] [config] factors-combine: sum
[2023-07-17 21:07:57] [config] factors-dim-emb: 0
[2023-07-17 21:07:57] [config] gradient-checkpointing: false
[2023-07-17 21:07:57] [config] gradient-norm-average-window: 100
[2023-07-17 21:07:57] [config] guided-alignment: none
[2023-07-17 21:07:57] [config] guided-alignment-cost: mse
[2023-07-17 21:07:57] [config] guided-alignment-weight: 0.1
[2023-07-17 21:07:57] [config] ignore-model-config: false
[2023-07-17 21:07:57] [config] input-types:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] interpolate-env-vars: false
[2023-07-17 21:07:57] [config] keep-best: false
[2023-07-17 21:07:57] [config] label-smoothing: 0
[2023-07-17 21:07:57] [config] layer-normalization: false
[2023-07-17 21:07:57] [config] learn-rate: 0.0001
[2023-07-17 21:07:57] [config] lemma-dependency: ""
[2023-07-17 21:07:57] [config] lemma-dim-emb: 0
[2023-07-17 21:07:57] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 21:07:57] [config] log-level: info
[2023-07-17 21:07:57] [config] log-time-zone: ""
[2023-07-17 21:07:57] [config] logical-epoch:
[2023-07-17 21:07:57] [config]   - 1e
[2023-07-17 21:07:57] [config]   - 0
[2023-07-17 21:07:57] [config] lr-decay: 0
[2023-07-17 21:07:57] [config] lr-decay-freq: 50000
[2023-07-17 21:07:57] [config] lr-decay-inv-sqrt:
[2023-07-17 21:07:57] [config]   - 0
[2023-07-17 21:07:57] [config] lr-decay-repeat-warmup: false
[2023-07-17 21:07:57] [config] lr-decay-reset-optimizer: false
[2023-07-17 21:07:57] [config] lr-decay-start:
[2023-07-17 21:07:57] [config]   - 10
[2023-07-17 21:07:57] [config]   - 1
[2023-07-17 21:07:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 21:07:57] [config] lr-report: false
[2023-07-17 21:07:57] [config] lr-warmup: 0
[2023-07-17 21:07:57] [config] lr-warmup-at-reload: false
[2023-07-17 21:07:57] [config] lr-warmup-cycle: false
[2023-07-17 21:07:57] [config] lr-warmup-start-rate: 0
[2023-07-17 21:07:57] [config] max-length: 200
[2023-07-17 21:07:57] [config] max-length-crop: true
[2023-07-17 21:07:57] [config] max-length-factor: 3
[2023-07-17 21:07:57] [config] maxi-batch: 100
[2023-07-17 21:07:57] [config] maxi-batch-sort: trg
[2023-07-17 21:07:57] [config] mini-batch: 64
[2023-07-17 21:07:57] [config] mini-batch-fit: true
[2023-07-17 21:07:57] [config] mini-batch-fit-step: 10
[2023-07-17 21:07:57] [config] mini-batch-round-up: true
[2023-07-17 21:07:57] [config] mini-batch-track-lr: false
[2023-07-17 21:07:57] [config] mini-batch-warmup: 0
[2023-07-17 21:07:57] [config] mini-batch-words: 0
[2023-07-17 21:07:57] [config] mini-batch-words-ref: 0
[2023-07-17 21:07:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 21:07:57] [config] multi-loss-type: sum
[2023-07-17 21:07:57] [config] n-best: false
[2023-07-17 21:07:57] [config] no-nccl: false
[2023-07-17 21:07:57] [config] no-reload: false
[2023-07-17 21:07:57] [config] no-restore-corpus: false
[2023-07-17 21:07:57] [config] normalize: 0
[2023-07-17 21:07:57] [config] normalize-gradient: false
[2023-07-17 21:07:57] [config] num-devices: 0
[2023-07-17 21:07:57] [config] optimizer: adam
[2023-07-17 21:07:57] [config] optimizer-delay: 1
[2023-07-17 21:07:57] [config] optimizer-params:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] output-omit-bias: false
[2023-07-17 21:07:57] [config] overwrite: true
[2023-07-17 21:07:57] [config] precision:
[2023-07-17 21:07:57] [config]   - float16
[2023-07-17 21:07:57] [config]   - float32
[2023-07-17 21:07:57] [config] pretrained-model: ""
[2023-07-17 21:07:57] [config] quantize-biases: false
[2023-07-17 21:07:57] [config] quantize-bits: 0
[2023-07-17 21:07:57] [config] quantize-log-based: false
[2023-07-17 21:07:57] [config] quantize-optimization-steps: 0
[2023-07-17 21:07:57] [config] quiet: false
[2023-07-17 21:07:57] [config] quiet-translation: true
[2023-07-17 21:07:57] [config] relative-paths: false
[2023-07-17 21:07:57] [config] right-left: false
[2023-07-17 21:07:57] [config] save-freq: 10000u
[2023-07-17 21:07:57] [config] seed: 1234
[2023-07-17 21:07:57] [config] sentencepiece-alphas:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] sentencepiece-max-lines: 2000000
[2023-07-17 21:07:57] [config] sentencepiece-options: ""
[2023-07-17 21:07:57] [config] sharding: global
[2023-07-17 21:07:57] [config] shuffle: data
[2023-07-17 21:07:57] [config] shuffle-in-ram: false
[2023-07-17 21:07:57] [config] sigterm: save-and-exit
[2023-07-17 21:07:57] [config] skip: false
[2023-07-17 21:07:57] [config] sqlite: ""
[2023-07-17 21:07:57] [config] sqlite-drop: false
[2023-07-17 21:07:57] [config] sync-freq: 200u
[2023-07-17 21:07:57] [config] sync-sgd: false
[2023-07-17 21:07:57] [config] tempdir: /tmp
[2023-07-17 21:07:57] [config] tied-embeddings: false
[2023-07-17 21:07:57] [config] tied-embeddings-all: true
[2023-07-17 21:07:57] [config] tied-embeddings-src: false
[2023-07-17 21:07:57] [config] train-embedder-rank:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] train-sets:
[2023-07-17 21:07:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 21:07:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 21:07:57] [config] transformer-aan-activation: swish
[2023-07-17 21:07:57] [config] transformer-aan-depth: 2
[2023-07-17 21:07:57] [config] transformer-aan-nogate: false
[2023-07-17 21:07:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 21:07:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 21:07:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 21:07:57] [config] transformer-depth-scaling: false
[2023-07-17 21:07:57] [config] transformer-dim-aan: 2048
[2023-07-17 21:07:57] [config] transformer-dim-ffn: 2048
[2023-07-17 21:07:57] [config] transformer-dropout: 0
[2023-07-17 21:07:57] [config] transformer-dropout-attention: 0
[2023-07-17 21:07:57] [config] transformer-dropout-ffn: 0
[2023-07-17 21:07:57] [config] transformer-ffn-activation: swish
[2023-07-17 21:07:57] [config] transformer-ffn-depth: 2
[2023-07-17 21:07:57] [config] transformer-guided-alignment-layer: last
[2023-07-17 21:07:57] [config] transformer-heads: 8
[2023-07-17 21:07:57] [config] transformer-no-projection: false
[2023-07-17 21:07:57] [config] transformer-pool: false
[2023-07-17 21:07:57] [config] transformer-postprocess: dan
[2023-07-17 21:07:57] [config] transformer-postprocess-emb: d
[2023-07-17 21:07:57] [config] transformer-postprocess-top: ""
[2023-07-17 21:07:57] [config] transformer-preprocess: ""
[2023-07-17 21:07:57] [config] transformer-tied-layers:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] transformer-train-position-embeddings: false
[2023-07-17 21:07:57] [config] tsv: false
[2023-07-17 21:07:57] [config] tsv-fields: 0
[2023-07-17 21:07:57] [config] type: amun
[2023-07-17 21:07:57] [config] ulr: false
[2023-07-17 21:07:57] [config] ulr-dim-emb: 0
[2023-07-17 21:07:57] [config] ulr-dropout: 0
[2023-07-17 21:07:57] [config] ulr-keys-vectors: ""
[2023-07-17 21:07:57] [config] ulr-query-vectors: ""
[2023-07-17 21:07:57] [config] ulr-softmax-temperature: 1
[2023-07-17 21:07:57] [config] ulr-trainable-transformation: false
[2023-07-17 21:07:57] [config] unlikelihood-loss: false
[2023-07-17 21:07:57] [config] valid-freq: 50000000
[2023-07-17 21:07:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 21:07:57] [config] valid-max-length: 1000
[2023-07-17 21:07:57] [config] valid-metrics:
[2023-07-17 21:07:57] [config]   - cross-entropy
[2023-07-17 21:07:57] [config]   - translation
[2023-07-17 21:07:57] [config] valid-mini-batch: 32
[2023-07-17 21:07:57] [config] valid-reset-stalled: false
[2023-07-17 21:07:57] [config] valid-script-args:
[2023-07-17 21:07:57] [config]   []
[2023-07-17 21:07:57] [config] valid-script-path: ""
[2023-07-17 21:07:57] [config] valid-sets:
[2023-07-17 21:07:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 21:07:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 21:07:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 21:07:57] [config] vocabs:
[2023-07-17 21:07:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 21:07:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 21:07:57] [config] word-penalty: 0
[2023-07-17 21:07:57] [config] word-scores: false
[2023-07-17 21:07:57] [config] workspace: 5500
[2023-07-17 21:07:57] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 21:07:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 21:07:57] [training] Using single-device training
[2023-07-17 21:07:57] Synced seed 1234
[2023-07-17 21:07:57] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 21:07:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 21:07:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 21:07:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 21:07:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 21:07:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 21:07:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 21:07:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 21:07:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 21:07:59] [comm] Using global sharding
[2023-07-17 21:07:59] [comm] NCCLCommunicators constructed successfully
[2023-07-17 21:07:59] [training] Using 1 GPUs
[2023-07-17 21:07:59] [logits] Applying loss function for 1 factor(s)
[2023-07-17 21:07:59] [memory] Reserving 80 MB, device gpu0
[2023-07-17 21:07:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 21:07:59] [memory] Reserving 80 MB, device gpu0
[2023-07-17 21:44:01] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 21:44:01] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 21:44:01] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x557c4467c231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x557c446d1ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x557c446e8d5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x557c44afce1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x557c44b0b348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x557c445b0b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x557c444d22c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x557c44489b9c]    main                                               + 0x3c
[0x7f11aace60b3]    __libc_start_main                                  + 0xf3
[0x557c444d0cbe]    _start                                             + 0x2e

[2023-07-17 21:44:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 21:44:02] [marian] Running on node22.datos.cluster.uy as process 38929 with command line:
[2023-07-17 21:44:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 21:44:02] [config] after: 0e
[2023-07-17 21:44:02] [config] after-batches: 0
[2023-07-17 21:44:02] [config] after-epochs: 140
[2023-07-17 21:44:02] [config] all-caps-every: 0
[2023-07-17 21:44:02] [config] allow-unk: false
[2023-07-17 21:44:02] [config] authors: false
[2023-07-17 21:44:02] [config] beam-size: 12
[2023-07-17 21:44:02] [config] bert-class-symbol: "[CLS]"
[2023-07-17 21:44:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 21:44:02] [config] bert-masking-fraction: 0.15
[2023-07-17 21:44:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 21:44:02] [config] bert-train-type-embeddings: true
[2023-07-17 21:44:02] [config] bert-type-vocab-size: 2
[2023-07-17 21:44:02] [config] build-info: ""
[2023-07-17 21:44:02] [config] check-gradient-nan: false
[2023-07-17 21:44:02] [config] check-nan: false
[2023-07-17 21:44:02] [config] cite: false
[2023-07-17 21:44:02] [config] clip-norm: 1
[2023-07-17 21:44:02] [config] cost-scaling:
[2023-07-17 21:44:02] [config]   - 256.f
[2023-07-17 21:44:02] [config]   - 1000
[2023-07-17 21:44:02] [config]   - 2.f
[2023-07-17 21:44:02] [config]   - 256.f
[2023-07-17 21:44:02] [config] cost-type: ce-sum
[2023-07-17 21:44:02] [config] cpu-threads: 0
[2023-07-17 21:44:02] [config] data-threads: 8
[2023-07-17 21:44:02] [config] data-weighting: ""
[2023-07-17 21:44:02] [config] data-weighting-type: sentence
[2023-07-17 21:44:02] [config] dec-cell: gru
[2023-07-17 21:44:02] [config] dec-cell-base-depth: 2
[2023-07-17 21:44:02] [config] dec-cell-high-depth: 1
[2023-07-17 21:44:02] [config] dec-depth: 1
[2023-07-17 21:44:02] [config] devices:
[2023-07-17 21:44:02] [config]   - 0
[2023-07-17 21:44:02] [config] dim-emb: 512
[2023-07-17 21:44:02] [config] dim-rnn: 1024
[2023-07-17 21:44:02] [config] dim-vocabs:
[2023-07-17 21:44:02] [config]   - 16384
[2023-07-17 21:44:02] [config]   - 16384
[2023-07-17 21:44:02] [config] disp-first: 0
[2023-07-17 21:44:02] [config] disp-freq: 1000u
[2023-07-17 21:44:02] [config] disp-label-counts: true
[2023-07-17 21:44:02] [config] dropout-rnn: 0
[2023-07-17 21:44:02] [config] dropout-src: 0
[2023-07-17 21:44:02] [config] dropout-trg: 0
[2023-07-17 21:44:02] [config] dump-config: ""
[2023-07-17 21:44:02] [config] dynamic-gradient-scaling:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] early-stopping: 5
[2023-07-17 21:44:02] [config] early-stopping-on: first
[2023-07-17 21:44:02] [config] embedding-fix-src: false
[2023-07-17 21:44:02] [config] embedding-fix-trg: false
[2023-07-17 21:44:02] [config] embedding-normalization: false
[2023-07-17 21:44:02] [config] embedding-vectors:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] enc-cell: gru
[2023-07-17 21:44:02] [config] enc-cell-depth: 1
[2023-07-17 21:44:02] [config] enc-depth: 1
[2023-07-17 21:44:02] [config] enc-type: bidirectional
[2023-07-17 21:44:02] [config] english-title-case-every: 0
[2023-07-17 21:44:02] [config] exponential-smoothing: 0
[2023-07-17 21:44:02] [config] factor-weight: 1
[2023-07-17 21:44:02] [config] factors-combine: sum
[2023-07-17 21:44:02] [config] factors-dim-emb: 0
[2023-07-17 21:44:02] [config] gradient-checkpointing: false
[2023-07-17 21:44:02] [config] gradient-norm-average-window: 100
[2023-07-17 21:44:02] [config] guided-alignment: none
[2023-07-17 21:44:02] [config] guided-alignment-cost: mse
[2023-07-17 21:44:02] [config] guided-alignment-weight: 0.1
[2023-07-17 21:44:02] [config] ignore-model-config: false
[2023-07-17 21:44:02] [config] input-types:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] interpolate-env-vars: false
[2023-07-17 21:44:02] [config] keep-best: false
[2023-07-17 21:44:02] [config] label-smoothing: 0
[2023-07-17 21:44:02] [config] layer-normalization: false
[2023-07-17 21:44:02] [config] learn-rate: 0.0001
[2023-07-17 21:44:02] [config] lemma-dependency: ""
[2023-07-17 21:44:02] [config] lemma-dim-emb: 0
[2023-07-17 21:44:02] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 21:44:02] [config] log-level: info
[2023-07-17 21:44:02] [config] log-time-zone: ""
[2023-07-17 21:44:02] [config] logical-epoch:
[2023-07-17 21:44:02] [config]   - 1e
[2023-07-17 21:44:02] [config]   - 0
[2023-07-17 21:44:02] [config] lr-decay: 0
[2023-07-17 21:44:02] [config] lr-decay-freq: 50000
[2023-07-17 21:44:02] [config] lr-decay-inv-sqrt:
[2023-07-17 21:44:02] [config]   - 0
[2023-07-17 21:44:02] [config] lr-decay-repeat-warmup: false
[2023-07-17 21:44:02] [config] lr-decay-reset-optimizer: false
[2023-07-17 21:44:02] [config] lr-decay-start:
[2023-07-17 21:44:02] [config]   - 10
[2023-07-17 21:44:02] [config]   - 1
[2023-07-17 21:44:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 21:44:02] [config] lr-report: false
[2023-07-17 21:44:02] [config] lr-warmup: 0
[2023-07-17 21:44:02] [config] lr-warmup-at-reload: false
[2023-07-17 21:44:02] [config] lr-warmup-cycle: false
[2023-07-17 21:44:02] [config] lr-warmup-start-rate: 0
[2023-07-17 21:44:02] [config] max-length: 200
[2023-07-17 21:44:02] [config] max-length-crop: true
[2023-07-17 21:44:02] [config] max-length-factor: 3
[2023-07-17 21:44:02] [config] maxi-batch: 100
[2023-07-17 21:44:02] [config] maxi-batch-sort: trg
[2023-07-17 21:44:02] [config] mini-batch: 64
[2023-07-17 21:44:02] [config] mini-batch-fit: true
[2023-07-17 21:44:02] [config] mini-batch-fit-step: 10
[2023-07-17 21:44:02] [config] mini-batch-round-up: true
[2023-07-17 21:44:02] [config] mini-batch-track-lr: false
[2023-07-17 21:44:02] [config] mini-batch-warmup: 0
[2023-07-17 21:44:02] [config] mini-batch-words: 0
[2023-07-17 21:44:02] [config] mini-batch-words-ref: 0
[2023-07-17 21:44:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 21:44:02] [config] multi-loss-type: sum
[2023-07-17 21:44:02] [config] n-best: false
[2023-07-17 21:44:02] [config] no-nccl: false
[2023-07-17 21:44:02] [config] no-reload: false
[2023-07-17 21:44:02] [config] no-restore-corpus: false
[2023-07-17 21:44:02] [config] normalize: 0
[2023-07-17 21:44:02] [config] normalize-gradient: false
[2023-07-17 21:44:02] [config] num-devices: 0
[2023-07-17 21:44:02] [config] optimizer: adam
[2023-07-17 21:44:02] [config] optimizer-delay: 1
[2023-07-17 21:44:02] [config] optimizer-params:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] output-omit-bias: false
[2023-07-17 21:44:02] [config] overwrite: true
[2023-07-17 21:44:02] [config] precision:
[2023-07-17 21:44:02] [config]   - float16
[2023-07-17 21:44:02] [config]   - float32
[2023-07-17 21:44:02] [config] pretrained-model: ""
[2023-07-17 21:44:02] [config] quantize-biases: false
[2023-07-17 21:44:02] [config] quantize-bits: 0
[2023-07-17 21:44:02] [config] quantize-log-based: false
[2023-07-17 21:44:02] [config] quantize-optimization-steps: 0
[2023-07-17 21:44:02] [config] quiet: false
[2023-07-17 21:44:02] [config] quiet-translation: true
[2023-07-17 21:44:02] [config] relative-paths: false
[2023-07-17 21:44:02] [config] right-left: false
[2023-07-17 21:44:02] [config] save-freq: 10000u
[2023-07-17 21:44:02] [config] seed: 1234
[2023-07-17 21:44:02] [config] sentencepiece-alphas:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] sentencepiece-max-lines: 2000000
[2023-07-17 21:44:02] [config] sentencepiece-options: ""
[2023-07-17 21:44:02] [config] sharding: global
[2023-07-17 21:44:02] [config] shuffle: data
[2023-07-17 21:44:02] [config] shuffle-in-ram: false
[2023-07-17 21:44:02] [config] sigterm: save-and-exit
[2023-07-17 21:44:02] [config] skip: false
[2023-07-17 21:44:02] [config] sqlite: ""
[2023-07-17 21:44:02] [config] sqlite-drop: false
[2023-07-17 21:44:02] [config] sync-freq: 200u
[2023-07-17 21:44:02] [config] sync-sgd: false
[2023-07-17 21:44:02] [config] tempdir: /tmp
[2023-07-17 21:44:02] [config] tied-embeddings: false
[2023-07-17 21:44:02] [config] tied-embeddings-all: true
[2023-07-17 21:44:02] [config] tied-embeddings-src: false
[2023-07-17 21:44:02] [config] train-embedder-rank:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] train-sets:
[2023-07-17 21:44:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 21:44:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 21:44:02] [config] transformer-aan-activation: swish
[2023-07-17 21:44:02] [config] transformer-aan-depth: 2
[2023-07-17 21:44:02] [config] transformer-aan-nogate: false
[2023-07-17 21:44:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 21:44:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 21:44:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 21:44:02] [config] transformer-depth-scaling: false
[2023-07-17 21:44:02] [config] transformer-dim-aan: 2048
[2023-07-17 21:44:02] [config] transformer-dim-ffn: 2048
[2023-07-17 21:44:02] [config] transformer-dropout: 0
[2023-07-17 21:44:02] [config] transformer-dropout-attention: 0
[2023-07-17 21:44:02] [config] transformer-dropout-ffn: 0
[2023-07-17 21:44:02] [config] transformer-ffn-activation: swish
[2023-07-17 21:44:02] [config] transformer-ffn-depth: 2
[2023-07-17 21:44:02] [config] transformer-guided-alignment-layer: last
[2023-07-17 21:44:02] [config] transformer-heads: 8
[2023-07-17 21:44:02] [config] transformer-no-projection: false
[2023-07-17 21:44:02] [config] transformer-pool: false
[2023-07-17 21:44:02] [config] transformer-postprocess: dan
[2023-07-17 21:44:02] [config] transformer-postprocess-emb: d
[2023-07-17 21:44:02] [config] transformer-postprocess-top: ""
[2023-07-17 21:44:02] [config] transformer-preprocess: ""
[2023-07-17 21:44:02] [config] transformer-tied-layers:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] transformer-train-position-embeddings: false
[2023-07-17 21:44:02] [config] tsv: false
[2023-07-17 21:44:02] [config] tsv-fields: 0
[2023-07-17 21:44:02] [config] type: amun
[2023-07-17 21:44:02] [config] ulr: false
[2023-07-17 21:44:02] [config] ulr-dim-emb: 0
[2023-07-17 21:44:02] [config] ulr-dropout: 0
[2023-07-17 21:44:02] [config] ulr-keys-vectors: ""
[2023-07-17 21:44:02] [config] ulr-query-vectors: ""
[2023-07-17 21:44:02] [config] ulr-softmax-temperature: 1
[2023-07-17 21:44:02] [config] ulr-trainable-transformation: false
[2023-07-17 21:44:02] [config] unlikelihood-loss: false
[2023-07-17 21:44:02] [config] valid-freq: 50000000
[2023-07-17 21:44:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 21:44:02] [config] valid-max-length: 1000
[2023-07-17 21:44:02] [config] valid-metrics:
[2023-07-17 21:44:02] [config]   - cross-entropy
[2023-07-17 21:44:02] [config]   - translation
[2023-07-17 21:44:02] [config] valid-mini-batch: 32
[2023-07-17 21:44:02] [config] valid-reset-stalled: false
[2023-07-17 21:44:02] [config] valid-script-args:
[2023-07-17 21:44:02] [config]   []
[2023-07-17 21:44:02] [config] valid-script-path: ""
[2023-07-17 21:44:02] [config] valid-sets:
[2023-07-17 21:44:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 21:44:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 21:44:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 21:44:02] [config] vocabs:
[2023-07-17 21:44:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 21:44:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 21:44:02] [config] word-penalty: 0
[2023-07-17 21:44:02] [config] word-scores: false
[2023-07-17 21:44:02] [config] workspace: 5500
[2023-07-17 21:44:02] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 21:44:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 21:44:02] [training] Using single-device training
[2023-07-17 21:44:02] Synced seed 1234
[2023-07-17 21:44:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 21:44:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 21:44:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 21:44:02] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 21:44:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 21:44:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 21:44:02] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 21:44:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 21:44:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 21:44:03] [comm] Using global sharding
[2023-07-17 21:44:03] [comm] NCCLCommunicators constructed successfully
[2023-07-17 21:44:03] [training] Using 1 GPUs
[2023-07-17 21:44:03] [logits] Applying loss function for 1 factor(s)
[2023-07-17 21:44:03] [memory] Reserving 80 MB, device gpu0
[2023-07-17 21:44:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 21:44:04] [memory] Reserving 80 MB, device gpu0
[2023-07-17 21:53:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 21:53:43] [marian] Running on node22.datos.cluster.uy as process 39560 with command line:
[2023-07-17 21:53:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 21:53:43] [config] after: 0e
[2023-07-17 21:53:43] [config] after-batches: 0
[2023-07-17 21:53:43] [config] after-epochs: 10
[2023-07-17 21:53:43] [config] all-caps-every: 0
[2023-07-17 21:53:43] [config] allow-unk: false
[2023-07-17 21:53:43] [config] authors: false
[2023-07-17 21:53:43] [config] beam-size: 12
[2023-07-17 21:53:43] [config] bert-class-symbol: "[CLS]"
[2023-07-17 21:53:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 21:53:43] [config] bert-masking-fraction: 0.15
[2023-07-17 21:53:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 21:53:43] [config] bert-train-type-embeddings: true
[2023-07-17 21:53:43] [config] bert-type-vocab-size: 2
[2023-07-17 21:53:43] [config] build-info: ""
[2023-07-17 21:53:43] [config] check-gradient-nan: false
[2023-07-17 21:53:43] [config] check-nan: false
[2023-07-17 21:53:43] [config] cite: false
[2023-07-17 21:53:43] [config] clip-norm: 1
[2023-07-17 21:53:43] [config] cost-scaling:
[2023-07-17 21:53:43] [config]   - 256.f
[2023-07-17 21:53:43] [config]   - 1000
[2023-07-17 21:53:43] [config]   - 2.f
[2023-07-17 21:53:43] [config]   - 256.f
[2023-07-17 21:53:43] [config] cost-type: ce-sum
[2023-07-17 21:53:43] [config] cpu-threads: 0
[2023-07-17 21:53:43] [config] data-threads: 8
[2023-07-17 21:53:43] [config] data-weighting: ""
[2023-07-17 21:53:43] [config] data-weighting-type: sentence
[2023-07-17 21:53:43] [config] dec-cell: gru
[2023-07-17 21:53:43] [config] dec-cell-base-depth: 2
[2023-07-17 21:53:43] [config] dec-cell-high-depth: 1
[2023-07-17 21:53:43] [config] dec-depth: 1
[2023-07-17 21:53:43] [config] devices:
[2023-07-17 21:53:43] [config]   - 0
[2023-07-17 21:53:43] [config] dim-emb: 512
[2023-07-17 21:53:43] [config] dim-rnn: 1024
[2023-07-17 21:53:43] [config] dim-vocabs:
[2023-07-17 21:53:43] [config]   - 16384
[2023-07-17 21:53:43] [config]   - 16384
[2023-07-17 21:53:43] [config] disp-first: 0
[2023-07-17 21:53:43] [config] disp-freq: 1000u
[2023-07-17 21:53:43] [config] disp-label-counts: true
[2023-07-17 21:53:43] [config] dropout-rnn: 0
[2023-07-17 21:53:43] [config] dropout-src: 0
[2023-07-17 21:53:43] [config] dropout-trg: 0
[2023-07-17 21:53:43] [config] dump-config: ""
[2023-07-17 21:53:43] [config] dynamic-gradient-scaling:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] early-stopping: 5
[2023-07-17 21:53:43] [config] early-stopping-on: first
[2023-07-17 21:53:43] [config] embedding-fix-src: false
[2023-07-17 21:53:43] [config] embedding-fix-trg: false
[2023-07-17 21:53:43] [config] embedding-normalization: false
[2023-07-17 21:53:43] [config] embedding-vectors:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] enc-cell: gru
[2023-07-17 21:53:43] [config] enc-cell-depth: 1
[2023-07-17 21:53:43] [config] enc-depth: 1
[2023-07-17 21:53:43] [config] enc-type: bidirectional
[2023-07-17 21:53:43] [config] english-title-case-every: 0
[2023-07-17 21:53:43] [config] exponential-smoothing: 0
[2023-07-17 21:53:43] [config] factor-weight: 1
[2023-07-17 21:53:43] [config] factors-combine: sum
[2023-07-17 21:53:43] [config] factors-dim-emb: 0
[2023-07-17 21:53:43] [config] gradient-checkpointing: false
[2023-07-17 21:53:43] [config] gradient-norm-average-window: 100
[2023-07-17 21:53:43] [config] guided-alignment: none
[2023-07-17 21:53:43] [config] guided-alignment-cost: mse
[2023-07-17 21:53:43] [config] guided-alignment-weight: 0.1
[2023-07-17 21:53:43] [config] ignore-model-config: false
[2023-07-17 21:53:43] [config] input-types:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] interpolate-env-vars: false
[2023-07-17 21:53:43] [config] keep-best: false
[2023-07-17 21:53:43] [config] label-smoothing: 0
[2023-07-17 21:53:43] [config] layer-normalization: false
[2023-07-17 21:53:43] [config] learn-rate: 0.0001
[2023-07-17 21:53:43] [config] lemma-dependency: ""
[2023-07-17 21:53:43] [config] lemma-dim-emb: 0
[2023-07-17 21:53:43] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 21:53:43] [config] log-level: info
[2023-07-17 21:53:43] [config] log-time-zone: ""
[2023-07-17 21:53:43] [config] logical-epoch:
[2023-07-17 21:53:43] [config]   - 1e
[2023-07-17 21:53:43] [config]   - 0
[2023-07-17 21:53:43] [config] lr-decay: 0
[2023-07-17 21:53:43] [config] lr-decay-freq: 50000
[2023-07-17 21:53:43] [config] lr-decay-inv-sqrt:
[2023-07-17 21:53:43] [config]   - 0
[2023-07-17 21:53:43] [config] lr-decay-repeat-warmup: false
[2023-07-17 21:53:43] [config] lr-decay-reset-optimizer: false
[2023-07-17 21:53:43] [config] lr-decay-start:
[2023-07-17 21:53:43] [config]   - 10
[2023-07-17 21:53:43] [config]   - 1
[2023-07-17 21:53:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 21:53:43] [config] lr-report: false
[2023-07-17 21:53:43] [config] lr-warmup: 0
[2023-07-17 21:53:43] [config] lr-warmup-at-reload: false
[2023-07-17 21:53:43] [config] lr-warmup-cycle: false
[2023-07-17 21:53:43] [config] lr-warmup-start-rate: 0
[2023-07-17 21:53:43] [config] max-length: 150
[2023-07-17 21:53:43] [config] max-length-crop: true
[2023-07-17 21:53:43] [config] max-length-factor: 3
[2023-07-17 21:53:43] [config] maxi-batch: 100
[2023-07-17 21:53:43] [config] maxi-batch-sort: trg
[2023-07-17 21:53:43] [config] mini-batch: 64
[2023-07-17 21:53:43] [config] mini-batch-fit: true
[2023-07-17 21:53:43] [config] mini-batch-fit-step: 10
[2023-07-17 21:53:43] [config] mini-batch-round-up: true
[2023-07-17 21:53:43] [config] mini-batch-track-lr: false
[2023-07-17 21:53:43] [config] mini-batch-warmup: 0
[2023-07-17 21:53:43] [config] mini-batch-words: 0
[2023-07-17 21:53:43] [config] mini-batch-words-ref: 0
[2023-07-17 21:53:43] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 21:53:43] [config] multi-loss-type: sum
[2023-07-17 21:53:43] [config] n-best: false
[2023-07-17 21:53:43] [config] no-nccl: false
[2023-07-17 21:53:43] [config] no-reload: false
[2023-07-17 21:53:43] [config] no-restore-corpus: false
[2023-07-17 21:53:43] [config] normalize: 0
[2023-07-17 21:53:43] [config] normalize-gradient: false
[2023-07-17 21:53:43] [config] num-devices: 0
[2023-07-17 21:53:43] [config] optimizer: adam
[2023-07-17 21:53:43] [config] optimizer-delay: 1
[2023-07-17 21:53:43] [config] optimizer-params:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] output-omit-bias: false
[2023-07-17 21:53:43] [config] overwrite: true
[2023-07-17 21:53:43] [config] precision:
[2023-07-17 21:53:43] [config]   - float16
[2023-07-17 21:53:43] [config]   - float32
[2023-07-17 21:53:43] [config] pretrained-model: ""
[2023-07-17 21:53:43] [config] quantize-biases: false
[2023-07-17 21:53:43] [config] quantize-bits: 0
[2023-07-17 21:53:43] [config] quantize-log-based: false
[2023-07-17 21:53:43] [config] quantize-optimization-steps: 0
[2023-07-17 21:53:43] [config] quiet: false
[2023-07-17 21:53:43] [config] quiet-translation: true
[2023-07-17 21:53:43] [config] relative-paths: false
[2023-07-17 21:53:43] [config] right-left: false
[2023-07-17 21:53:43] [config] save-freq: 10000u
[2023-07-17 21:53:43] [config] seed: 1234
[2023-07-17 21:53:43] [config] sentencepiece-alphas:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] sentencepiece-max-lines: 2000000
[2023-07-17 21:53:43] [config] sentencepiece-options: ""
[2023-07-17 21:53:43] [config] sharding: global
[2023-07-17 21:53:43] [config] shuffle: data
[2023-07-17 21:53:43] [config] shuffle-in-ram: false
[2023-07-17 21:53:43] [config] sigterm: save-and-exit
[2023-07-17 21:53:43] [config] skip: false
[2023-07-17 21:53:43] [config] sqlite: ""
[2023-07-17 21:53:43] [config] sqlite-drop: false
[2023-07-17 21:53:43] [config] sync-freq: 200u
[2023-07-17 21:53:43] [config] sync-sgd: false
[2023-07-17 21:53:43] [config] tempdir: /tmp
[2023-07-17 21:53:43] [config] tied-embeddings: false
[2023-07-17 21:53:43] [config] tied-embeddings-all: true
[2023-07-17 21:53:43] [config] tied-embeddings-src: false
[2023-07-17 21:53:43] [config] train-embedder-rank:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] train-sets:
[2023-07-17 21:53:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 21:53:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 21:53:43] [config] transformer-aan-activation: swish
[2023-07-17 21:53:43] [config] transformer-aan-depth: 2
[2023-07-17 21:53:43] [config] transformer-aan-nogate: false
[2023-07-17 21:53:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 21:53:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 21:53:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 21:53:43] [config] transformer-depth-scaling: false
[2023-07-17 21:53:43] [config] transformer-dim-aan: 2048
[2023-07-17 21:53:43] [config] transformer-dim-ffn: 2048
[2023-07-17 21:53:43] [config] transformer-dropout: 0
[2023-07-17 21:53:43] [config] transformer-dropout-attention: 0
[2023-07-17 21:53:43] [config] transformer-dropout-ffn: 0
[2023-07-17 21:53:43] [config] transformer-ffn-activation: swish
[2023-07-17 21:53:43] [config] transformer-ffn-depth: 2
[2023-07-17 21:53:43] [config] transformer-guided-alignment-layer: last
[2023-07-17 21:53:43] [config] transformer-heads: 8
[2023-07-17 21:53:43] [config] transformer-no-projection: false
[2023-07-17 21:53:43] [config] transformer-pool: false
[2023-07-17 21:53:43] [config] transformer-postprocess: dan
[2023-07-17 21:53:43] [config] transformer-postprocess-emb: d
[2023-07-17 21:53:43] [config] transformer-postprocess-top: ""
[2023-07-17 21:53:43] [config] transformer-preprocess: ""
[2023-07-17 21:53:43] [config] transformer-tied-layers:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] transformer-train-position-embeddings: false
[2023-07-17 21:53:43] [config] tsv: false
[2023-07-17 21:53:43] [config] tsv-fields: 0
[2023-07-17 21:53:43] [config] type: amun
[2023-07-17 21:53:43] [config] ulr: false
[2023-07-17 21:53:43] [config] ulr-dim-emb: 0
[2023-07-17 21:53:43] [config] ulr-dropout: 0
[2023-07-17 21:53:43] [config] ulr-keys-vectors: ""
[2023-07-17 21:53:43] [config] ulr-query-vectors: ""
[2023-07-17 21:53:43] [config] ulr-softmax-temperature: 1
[2023-07-17 21:53:43] [config] ulr-trainable-transformation: false
[2023-07-17 21:53:43] [config] unlikelihood-loss: false
[2023-07-17 21:53:43] [config] valid-freq: 50000000
[2023-07-17 21:53:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 21:53:43] [config] valid-max-length: 1000
[2023-07-17 21:53:43] [config] valid-metrics:
[2023-07-17 21:53:43] [config]   - cross-entropy
[2023-07-17 21:53:43] [config]   - translation
[2023-07-17 21:53:43] [config] valid-mini-batch: 32
[2023-07-17 21:53:43] [config] valid-reset-stalled: false
[2023-07-17 21:53:43] [config] valid-script-args:
[2023-07-17 21:53:43] [config]   []
[2023-07-17 21:53:43] [config] valid-script-path: ""
[2023-07-17 21:53:43] [config] valid-sets:
[2023-07-17 21:53:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn
[2023-07-17 21:53:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es_gridlvl2.spm
[2023-07-17 21:53:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 21:53:43] [config] vocabs:
[2023-07-17 21:53:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 21:53:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 21:53:43] [config] word-penalty: 0
[2023-07-17 21:53:43] [config] word-scores: false
[2023-07-17 21:53:43] [config] workspace: 5500
[2023-07-17 21:53:43] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 21:53:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 21:53:43] [training] Using single-device training
[2023-07-17 21:53:43] Synced seed 1234
[2023-07-17 21:53:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-17 21:53:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 21:53:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es.spm
[2023-07-17 21:53:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 21:53:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 21:53:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 21:53:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 21:53:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 21:53:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 21:53:46] [comm] Using global sharding
[2023-07-17 21:53:46] [comm] NCCLCommunicators constructed successfully
[2023-07-17 21:53:46] [training] Using 1 GPUs
[2023-07-17 21:53:46] [logits] Applying loss function for 1 factor(s)
[2023-07-17 21:53:46] [memory] Reserving 80 MB, device gpu0
[2023-07-17 21:53:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 21:53:48] [memory] Reserving 80 MB, device gpu0
[2023-07-17 22:19:52] [batching] Done. Typical MB size is 35,978 target words
[2023-07-17 22:19:52] Error: File '/docker/home/marianmt/artifacts/data/validation/valid_gn_gridlvl2.txt.gn' does not exist
[2023-07-17 22:19:52] Error: Aborted from marian::io::InputFileStream::InputFileStream(const string&) in /marian/src/common/file_stream.cpp:38

[CALL STACK]
[0x55ed1620e231]    marian::io::InputFileStream::  InputFileStream  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&) + 0x901
[0x55ed16263ca1]    marian::data::CorpusBase::  CorpusBase  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>> const&,  std::shared_ptr<marian::Options>,  unsigned long) + 0xc51
[0x55ed1627ad5a]    marian::data::Corpus::  Corpus  (std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>>,  std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>,  unsigned long) + 0x6a
[0x55ed1668ee1c]    marian::CrossEntropyValidator::  CrossEntropyValidator  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8fc
[0x55ed1669d348]    marian::  Validators  (std::vector<std::shared_ptr<marian::Vocab>,std::allocator<std::shared_ptr<marian::Vocab>>>,  std::shared_ptr<marian::Options>) + 0x8a8
[0x55ed16142b9b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0xdcb
[0x55ed160642c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55ed1601bb9c]    main                                               + 0x3c
[0x7f90a0d7b0b3]    __libc_start_main                                  + 0xf3
[0x55ed16062cbe]    _start                                             + 0x2e

[2023-07-17 23:00:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:43] [marian] Running on node22.datos.cluster.uy as process 3671 with command line:
[2023-07-17 23:00:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:00:43] [config] after: 0e
[2023-07-17 23:00:43] [config] after-batches: 0
[2023-07-17 23:00:43] [config] after-epochs: 10
[2023-07-17 23:00:43] [config] all-caps-every: 0
[2023-07-17 23:00:43] [config] allow-unk: false
[2023-07-17 23:00:43] [config] authors: false
[2023-07-17 23:00:43] [config] beam-size: 12
[2023-07-17 23:00:43] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:00:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:00:43] [config] bert-masking-fraction: 0.15
[2023-07-17 23:00:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:00:43] [config] bert-train-type-embeddings: true
[2023-07-17 23:00:43] [config] bert-type-vocab-size: 2
[2023-07-17 23:00:43] [config] build-info: ""
[2023-07-17 23:00:43] [config] check-gradient-nan: false
[2023-07-17 23:00:43] [config] check-nan: false
[2023-07-17 23:00:43] [config] cite: false
[2023-07-17 23:00:43] [config] clip-norm: 1
[2023-07-17 23:00:43] [config] cost-scaling:
[2023-07-17 23:00:43] [config]   - 256.f
[2023-07-17 23:00:43] [config]   - 1000
[2023-07-17 23:00:43] [config]   - 2.f
[2023-07-17 23:00:43] [config]   - 256.f
[2023-07-17 23:00:43] [config] cost-type: ce-sum
[2023-07-17 23:00:43] [config] cpu-threads: 0
[2023-07-17 23:00:43] [config] data-threads: 8
[2023-07-17 23:00:43] [config] data-weighting: ""
[2023-07-17 23:00:43] [config] data-weighting-type: sentence
[2023-07-17 23:00:43] [config] dec-cell: gru
[2023-07-17 23:00:43] [config] dec-cell-base-depth: 2
[2023-07-17 23:00:43] [config] dec-cell-high-depth: 1
[2023-07-17 23:00:43] [config] dec-depth: 1
[2023-07-17 23:00:43] [config] devices:
[2023-07-17 23:00:43] [config]   - 0
[2023-07-17 23:00:43] [config] dim-emb: 512
[2023-07-17 23:00:43] [config] dim-rnn: 1024
[2023-07-17 23:00:43] [config] dim-vocabs:
[2023-07-17 23:00:43] [config]   - 16384
[2023-07-17 23:00:43] [config]   - 16384
[2023-07-17 23:00:43] [config] disp-first: 0
[2023-07-17 23:00:43] [config] disp-freq: 1000u
[2023-07-17 23:00:43] [config] disp-label-counts: true
[2023-07-17 23:00:43] [config] dropout-rnn: 0
[2023-07-17 23:00:43] [config] dropout-src: 0
[2023-07-17 23:00:43] [config] dropout-trg: 0
[2023-07-17 23:00:43] [config] dump-config: ""
[2023-07-17 23:00:43] [config] dynamic-gradient-scaling:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] early-stopping: 5
[2023-07-17 23:00:43] [config] early-stopping-on: first
[2023-07-17 23:00:43] [config] embedding-fix-src: false
[2023-07-17 23:00:43] [config] embedding-fix-trg: false
[2023-07-17 23:00:43] [config] embedding-normalization: false
[2023-07-17 23:00:43] [config] embedding-vectors:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] enc-cell: gru
[2023-07-17 23:00:43] [config] enc-cell-depth: 1
[2023-07-17 23:00:43] [config] enc-depth: 1
[2023-07-17 23:00:43] [config] enc-type: bidirectional
[2023-07-17 23:00:43] [config] english-title-case-every: 0
[2023-07-17 23:00:43] [config] exponential-smoothing: 0
[2023-07-17 23:00:43] [config] factor-weight: 1
[2023-07-17 23:00:43] [config] factors-combine: sum
[2023-07-17 23:00:43] [config] factors-dim-emb: 0
[2023-07-17 23:00:43] [config] gradient-checkpointing: false
[2023-07-17 23:00:43] [config] gradient-norm-average-window: 100
[2023-07-17 23:00:43] [config] guided-alignment: none
[2023-07-17 23:00:43] [config] guided-alignment-cost: mse
[2023-07-17 23:00:43] [config] guided-alignment-weight: 0.1
[2023-07-17 23:00:43] [config] ignore-model-config: false
[2023-07-17 23:00:43] [config] input-types:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] interpolate-env-vars: false
[2023-07-17 23:00:43] [config] keep-best: false
[2023-07-17 23:00:43] [config] label-smoothing: 0
[2023-07-17 23:00:43] [config] layer-normalization: false
[2023-07-17 23:00:43] [config] learn-rate: 0.0001
[2023-07-17 23:00:43] [config] lemma-dependency: ""
[2023-07-17 23:00:43] [config] lemma-dim-emb: 0
[2023-07-17 23:00:43] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:43] [config] log-level: info
[2023-07-17 23:00:43] [config] log-time-zone: ""
[2023-07-17 23:00:43] [config] logical-epoch:
[2023-07-17 23:00:43] [config]   - 1e
[2023-07-17 23:00:43] [config]   - 0
[2023-07-17 23:00:43] [config] lr-decay: 0
[2023-07-17 23:00:43] [config] lr-decay-freq: 50000
[2023-07-17 23:00:43] [config] lr-decay-inv-sqrt:
[2023-07-17 23:00:43] [config]   - 0
[2023-07-17 23:00:43] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:00:43] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:00:43] [config] lr-decay-start:
[2023-07-17 23:00:43] [config]   - 10
[2023-07-17 23:00:43] [config]   - 1
[2023-07-17 23:00:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:00:43] [config] lr-report: false
[2023-07-17 23:00:43] [config] lr-warmup: 0
[2023-07-17 23:00:43] [config] lr-warmup-at-reload: false
[2023-07-17 23:00:43] [config] lr-warmup-cycle: false
[2023-07-17 23:00:43] [config] lr-warmup-start-rate: 0
[2023-07-17 23:00:43] [config] max-length: 150
[2023-07-17 23:00:43] [config] max-length-crop: true
[2023-07-17 23:00:43] [config] max-length-factor: 3
[2023-07-17 23:00:43] [config] maxi-batch: 100
[2023-07-17 23:00:43] [config] maxi-batch-sort: trg
[2023-07-17 23:00:43] [config] mini-batch: 64
[2023-07-17 23:00:43] [config] mini-batch-fit: true
[2023-07-17 23:00:43] [config] mini-batch-fit-step: 10
[2023-07-17 23:00:43] [config] mini-batch-round-up: true
[2023-07-17 23:00:43] [config] mini-batch-track-lr: false
[2023-07-17 23:00:43] [config] mini-batch-warmup: 0
[2023-07-17 23:00:43] [config] mini-batch-words: 0
[2023-07-17 23:00:43] [config] mini-batch-words-ref: 0
[2023-07-17 23:00:43] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:00:43] [config] multi-loss-type: sum
[2023-07-17 23:00:43] [config] n-best: false
[2023-07-17 23:00:43] [config] no-nccl: false
[2023-07-17 23:00:43] [config] no-reload: false
[2023-07-17 23:00:43] [config] no-restore-corpus: false
[2023-07-17 23:00:43] [config] normalize: 0
[2023-07-17 23:00:43] [config] normalize-gradient: false
[2023-07-17 23:00:43] [config] num-devices: 0
[2023-07-17 23:00:43] [config] optimizer: adam
[2023-07-17 23:00:43] [config] optimizer-delay: 1
[2023-07-17 23:00:43] [config] optimizer-params:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] output-omit-bias: false
[2023-07-17 23:00:43] [config] overwrite: true
[2023-07-17 23:00:43] [config] precision:
[2023-07-17 23:00:43] [config]   - float16
[2023-07-17 23:00:43] [config]   - float32
[2023-07-17 23:00:43] [config] pretrained-model: ""
[2023-07-17 23:00:43] [config] quantize-biases: false
[2023-07-17 23:00:43] [config] quantize-bits: 0
[2023-07-17 23:00:43] [config] quantize-log-based: false
[2023-07-17 23:00:43] [config] quantize-optimization-steps: 0
[2023-07-17 23:00:43] [config] quiet: false
[2023-07-17 23:00:43] [config] quiet-translation: true
[2023-07-17 23:00:43] [config] relative-paths: false
[2023-07-17 23:00:43] [config] right-left: false
[2023-07-17 23:00:43] [config] save-freq: 10000u
[2023-07-17 23:00:43] [config] seed: 1234
[2023-07-17 23:00:43] [config] sentencepiece-alphas:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:00:43] [config] sentencepiece-options: ""
[2023-07-17 23:00:43] [config] sharding: global
[2023-07-17 23:00:43] [config] shuffle: data
[2023-07-17 23:00:43] [config] shuffle-in-ram: false
[2023-07-17 23:00:43] [config] sigterm: save-and-exit
[2023-07-17 23:00:43] [config] skip: false
[2023-07-17 23:00:43] [config] sqlite: ""
[2023-07-17 23:00:43] [config] sqlite-drop: false
[2023-07-17 23:00:43] [config] sync-freq: 200u
[2023-07-17 23:00:43] [config] sync-sgd: false
[2023-07-17 23:00:43] [config] tempdir: /tmp
[2023-07-17 23:00:43] [config] tied-embeddings: false
[2023-07-17 23:00:43] [config] tied-embeddings-all: true
[2023-07-17 23:00:43] [config] tied-embeddings-src: false
[2023-07-17 23:00:43] [config] train-embedder-rank:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] train-sets:
[2023-07-17 23:00:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:00:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:00:43] [config] transformer-aan-activation: swish
[2023-07-17 23:00:43] [config] transformer-aan-depth: 2
[2023-07-17 23:00:43] [config] transformer-aan-nogate: false
[2023-07-17 23:00:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:00:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:00:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:00:43] [config] transformer-depth-scaling: false
[2023-07-17 23:00:43] [config] transformer-dim-aan: 2048
[2023-07-17 23:00:43] [config] transformer-dim-ffn: 2048
[2023-07-17 23:00:43] [config] transformer-dropout: 0
[2023-07-17 23:00:43] [config] transformer-dropout-attention: 0
[2023-07-17 23:00:43] [config] transformer-dropout-ffn: 0
[2023-07-17 23:00:43] [config] transformer-ffn-activation: swish
[2023-07-17 23:00:43] [config] transformer-ffn-depth: 2
[2023-07-17 23:00:43] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:00:43] [config] transformer-heads: 8
[2023-07-17 23:00:43] [config] transformer-no-projection: false
[2023-07-17 23:00:43] [config] transformer-pool: false
[2023-07-17 23:00:43] [config] transformer-postprocess: dan
[2023-07-17 23:00:43] [config] transformer-postprocess-emb: d
[2023-07-17 23:00:43] [config] transformer-postprocess-top: ""
[2023-07-17 23:00:43] [config] transformer-preprocess: ""
[2023-07-17 23:00:43] [config] transformer-tied-layers:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] transformer-train-position-embeddings: false
[2023-07-17 23:00:43] [config] tsv: false
[2023-07-17 23:00:43] [config] tsv-fields: 0
[2023-07-17 23:00:43] [config] type: amun
[2023-07-17 23:00:43] [config] ulr: false
[2023-07-17 23:00:43] [config] ulr-dim-emb: 0
[2023-07-17 23:00:43] [config] ulr-dropout: 0
[2023-07-17 23:00:43] [config] ulr-keys-vectors: ""
[2023-07-17 23:00:43] [config] ulr-query-vectors: ""
[2023-07-17 23:00:43] [config] ulr-softmax-temperature: 1
[2023-07-17 23:00:43] [config] ulr-trainable-transformation: false
[2023-07-17 23:00:43] [config] unlikelihood-loss: false
[2023-07-17 23:00:43] [config] valid-freq: 50000000
[2023-07-17 23:00:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:43] [config] valid-max-length: 1000
[2023-07-17 23:00:43] [config] valid-metrics:
[2023-07-17 23:00:43] [config]   - cross-entropy
[2023-07-17 23:00:43] [config]   - translation
[2023-07-17 23:00:43] [config] valid-mini-batch: 32
[2023-07-17 23:00:43] [config] valid-reset-stalled: false
[2023-07-17 23:00:43] [config] valid-script-args:
[2023-07-17 23:00:43] [config]   []
[2023-07-17 23:00:43] [config] valid-script-path: ""
[2023-07-17 23:00:43] [config] valid-sets:
[2023-07-17 23:00:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:00:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:00:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:00:43] [config] vocabs:
[2023-07-17 23:00:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:00:43] [config] word-penalty: 0
[2023-07-17 23:00:43] [config] word-scores: false
[2023-07-17 23:00:43] [config] workspace: 5500
[2023-07-17 23:00:43] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:00:43] [training] Using single-device training
[2023-07-17 23:00:44] Synced seed 1234
[2023-07-17 23:00:44] [data] Creating vocabulary /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn from /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:00:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:44] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:00:44] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x557e124f5177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x557e124f5699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x557e124f892f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x557e124e77da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x557e124e80f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x557e1253582e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x557e1254879d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x557e12412b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x557e123332c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x557e122eab9c]    main                                               + 0x3c
[0x7f2ff959c0b3]    __libc_start_main                                  + 0xf3
[0x557e12331cbe]    _start                                             + 0x2e

[2023-07-17 23:00:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:47] [marian] Running on node22.datos.cluster.uy as process 3679 with command line:
[2023-07-17 23:00:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:00:47] [config] after: 0e
[2023-07-17 23:00:47] [config] after-batches: 0
[2023-07-17 23:00:47] [config] after-epochs: 20
[2023-07-17 23:00:47] [config] all-caps-every: 0
[2023-07-17 23:00:47] [config] allow-unk: false
[2023-07-17 23:00:47] [config] authors: false
[2023-07-17 23:00:47] [config] beam-size: 12
[2023-07-17 23:00:47] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:00:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:00:47] [config] bert-masking-fraction: 0.15
[2023-07-17 23:00:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:00:47] [config] bert-train-type-embeddings: true
[2023-07-17 23:00:47] [config] bert-type-vocab-size: 2
[2023-07-17 23:00:47] [config] build-info: ""
[2023-07-17 23:00:47] [config] check-gradient-nan: false
[2023-07-17 23:00:47] [config] check-nan: false
[2023-07-17 23:00:47] [config] cite: false
[2023-07-17 23:00:47] [config] clip-norm: 1
[2023-07-17 23:00:47] [config] cost-scaling:
[2023-07-17 23:00:47] [config]   - 256.f
[2023-07-17 23:00:47] [config]   - 1000
[2023-07-17 23:00:47] [config]   - 2.f
[2023-07-17 23:00:47] [config]   - 256.f
[2023-07-17 23:00:47] [config] cost-type: ce-sum
[2023-07-17 23:00:47] [config] cpu-threads: 0
[2023-07-17 23:00:47] [config] data-threads: 8
[2023-07-17 23:00:47] [config] data-weighting: ""
[2023-07-17 23:00:47] [config] data-weighting-type: sentence
[2023-07-17 23:00:47] [config] dec-cell: gru
[2023-07-17 23:00:47] [config] dec-cell-base-depth: 2
[2023-07-17 23:00:47] [config] dec-cell-high-depth: 1
[2023-07-17 23:00:47] [config] dec-depth: 1
[2023-07-17 23:00:47] [config] devices:
[2023-07-17 23:00:47] [config]   - 0
[2023-07-17 23:00:47] [config] dim-emb: 512
[2023-07-17 23:00:47] [config] dim-rnn: 1024
[2023-07-17 23:00:47] [config] dim-vocabs:
[2023-07-17 23:00:47] [config]   - 16384
[2023-07-17 23:00:47] [config]   - 16384
[2023-07-17 23:00:47] [config] disp-first: 0
[2023-07-17 23:00:47] [config] disp-freq: 1000u
[2023-07-17 23:00:47] [config] disp-label-counts: true
[2023-07-17 23:00:47] [config] dropout-rnn: 0
[2023-07-17 23:00:47] [config] dropout-src: 0
[2023-07-17 23:00:47] [config] dropout-trg: 0
[2023-07-17 23:00:47] [config] dump-config: ""
[2023-07-17 23:00:47] [config] dynamic-gradient-scaling:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] early-stopping: 5
[2023-07-17 23:00:47] [config] early-stopping-on: first
[2023-07-17 23:00:47] [config] embedding-fix-src: false
[2023-07-17 23:00:47] [config] embedding-fix-trg: false
[2023-07-17 23:00:47] [config] embedding-normalization: false
[2023-07-17 23:00:47] [config] embedding-vectors:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] enc-cell: gru
[2023-07-17 23:00:47] [config] enc-cell-depth: 1
[2023-07-17 23:00:47] [config] enc-depth: 1
[2023-07-17 23:00:47] [config] enc-type: bidirectional
[2023-07-17 23:00:47] [config] english-title-case-every: 0
[2023-07-17 23:00:47] [config] exponential-smoothing: 0
[2023-07-17 23:00:47] [config] factor-weight: 1
[2023-07-17 23:00:47] [config] factors-combine: sum
[2023-07-17 23:00:47] [config] factors-dim-emb: 0
[2023-07-17 23:00:47] [config] gradient-checkpointing: false
[2023-07-17 23:00:47] [config] gradient-norm-average-window: 100
[2023-07-17 23:00:47] [config] guided-alignment: none
[2023-07-17 23:00:47] [config] guided-alignment-cost: mse
[2023-07-17 23:00:47] [config] guided-alignment-weight: 0.1
[2023-07-17 23:00:47] [config] ignore-model-config: false
[2023-07-17 23:00:47] [config] input-types:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] interpolate-env-vars: false
[2023-07-17 23:00:47] [config] keep-best: false
[2023-07-17 23:00:47] [config] label-smoothing: 0
[2023-07-17 23:00:47] [config] layer-normalization: false
[2023-07-17 23:00:47] [config] learn-rate: 0.0001
[2023-07-17 23:00:47] [config] lemma-dependency: ""
[2023-07-17 23:00:47] [config] lemma-dim-emb: 0
[2023-07-17 23:00:47] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:47] [config] log-level: info
[2023-07-17 23:00:47] [config] log-time-zone: ""
[2023-07-17 23:00:47] [config] logical-epoch:
[2023-07-17 23:00:47] [config]   - 1e
[2023-07-17 23:00:47] [config]   - 0
[2023-07-17 23:00:47] [config] lr-decay: 0
[2023-07-17 23:00:47] [config] lr-decay-freq: 50000
[2023-07-17 23:00:47] [config] lr-decay-inv-sqrt:
[2023-07-17 23:00:47] [config]   - 0
[2023-07-17 23:00:47] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:00:47] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:00:47] [config] lr-decay-start:
[2023-07-17 23:00:47] [config]   - 10
[2023-07-17 23:00:47] [config]   - 1
[2023-07-17 23:00:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:00:47] [config] lr-report: false
[2023-07-17 23:00:47] [config] lr-warmup: 0
[2023-07-17 23:00:47] [config] lr-warmup-at-reload: false
[2023-07-17 23:00:47] [config] lr-warmup-cycle: false
[2023-07-17 23:00:47] [config] lr-warmup-start-rate: 0
[2023-07-17 23:00:47] [config] max-length: 150
[2023-07-17 23:00:47] [config] max-length-crop: true
[2023-07-17 23:00:47] [config] max-length-factor: 3
[2023-07-17 23:00:47] [config] maxi-batch: 100
[2023-07-17 23:00:47] [config] maxi-batch-sort: trg
[2023-07-17 23:00:47] [config] mini-batch: 64
[2023-07-17 23:00:47] [config] mini-batch-fit: true
[2023-07-17 23:00:47] [config] mini-batch-fit-step: 10
[2023-07-17 23:00:47] [config] mini-batch-round-up: true
[2023-07-17 23:00:47] [config] mini-batch-track-lr: false
[2023-07-17 23:00:47] [config] mini-batch-warmup: 0
[2023-07-17 23:00:47] [config] mini-batch-words: 0
[2023-07-17 23:00:47] [config] mini-batch-words-ref: 0
[2023-07-17 23:00:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:00:47] [config] multi-loss-type: sum
[2023-07-17 23:00:47] [config] n-best: false
[2023-07-17 23:00:47] [config] no-nccl: false
[2023-07-17 23:00:47] [config] no-reload: false
[2023-07-17 23:00:47] [config] no-restore-corpus: false
[2023-07-17 23:00:47] [config] normalize: 0
[2023-07-17 23:00:47] [config] normalize-gradient: false
[2023-07-17 23:00:47] [config] num-devices: 0
[2023-07-17 23:00:47] [config] optimizer: adam
[2023-07-17 23:00:47] [config] optimizer-delay: 1
[2023-07-17 23:00:47] [config] optimizer-params:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] output-omit-bias: false
[2023-07-17 23:00:47] [config] overwrite: true
[2023-07-17 23:00:47] [config] precision:
[2023-07-17 23:00:47] [config]   - float16
[2023-07-17 23:00:47] [config]   - float32
[2023-07-17 23:00:47] [config] pretrained-model: ""
[2023-07-17 23:00:47] [config] quantize-biases: false
[2023-07-17 23:00:47] [config] quantize-bits: 0
[2023-07-17 23:00:47] [config] quantize-log-based: false
[2023-07-17 23:00:47] [config] quantize-optimization-steps: 0
[2023-07-17 23:00:47] [config] quiet: false
[2023-07-17 23:00:47] [config] quiet-translation: true
[2023-07-17 23:00:47] [config] relative-paths: false
[2023-07-17 23:00:47] [config] right-left: false
[2023-07-17 23:00:47] [config] save-freq: 10000u
[2023-07-17 23:00:47] [config] seed: 1234
[2023-07-17 23:00:47] [config] sentencepiece-alphas:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:00:47] [config] sentencepiece-options: ""
[2023-07-17 23:00:47] [config] sharding: global
[2023-07-17 23:00:47] [config] shuffle: data
[2023-07-17 23:00:47] [config] shuffle-in-ram: false
[2023-07-17 23:00:47] [config] sigterm: save-and-exit
[2023-07-17 23:00:47] [config] skip: false
[2023-07-17 23:00:47] [config] sqlite: ""
[2023-07-17 23:00:47] [config] sqlite-drop: false
[2023-07-17 23:00:47] [config] sync-freq: 200u
[2023-07-17 23:00:47] [config] sync-sgd: false
[2023-07-17 23:00:47] [config] tempdir: /tmp
[2023-07-17 23:00:47] [config] tied-embeddings: false
[2023-07-17 23:00:47] [config] tied-embeddings-all: true
[2023-07-17 23:00:47] [config] tied-embeddings-src: false
[2023-07-17 23:00:47] [config] train-embedder-rank:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] train-sets:
[2023-07-17 23:00:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:00:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:00:47] [config] transformer-aan-activation: swish
[2023-07-17 23:00:47] [config] transformer-aan-depth: 2
[2023-07-17 23:00:47] [config] transformer-aan-nogate: false
[2023-07-17 23:00:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:00:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:00:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:00:47] [config] transformer-depth-scaling: false
[2023-07-17 23:00:47] [config] transformer-dim-aan: 2048
[2023-07-17 23:00:47] [config] transformer-dim-ffn: 2048
[2023-07-17 23:00:47] [config] transformer-dropout: 0
[2023-07-17 23:00:47] [config] transformer-dropout-attention: 0
[2023-07-17 23:00:47] [config] transformer-dropout-ffn: 0
[2023-07-17 23:00:47] [config] transformer-ffn-activation: swish
[2023-07-17 23:00:47] [config] transformer-ffn-depth: 2
[2023-07-17 23:00:47] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:00:47] [config] transformer-heads: 8
[2023-07-17 23:00:47] [config] transformer-no-projection: false
[2023-07-17 23:00:47] [config] transformer-pool: false
[2023-07-17 23:00:47] [config] transformer-postprocess: dan
[2023-07-17 23:00:47] [config] transformer-postprocess-emb: d
[2023-07-17 23:00:47] [config] transformer-postprocess-top: ""
[2023-07-17 23:00:47] [config] transformer-preprocess: ""
[2023-07-17 23:00:47] [config] transformer-tied-layers:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] transformer-train-position-embeddings: false
[2023-07-17 23:00:47] [config] tsv: false
[2023-07-17 23:00:47] [config] tsv-fields: 0
[2023-07-17 23:00:47] [config] type: amun
[2023-07-17 23:00:47] [config] ulr: false
[2023-07-17 23:00:47] [config] ulr-dim-emb: 0
[2023-07-17 23:00:47] [config] ulr-dropout: 0
[2023-07-17 23:00:47] [config] ulr-keys-vectors: ""
[2023-07-17 23:00:47] [config] ulr-query-vectors: ""
[2023-07-17 23:00:47] [config] ulr-softmax-temperature: 1
[2023-07-17 23:00:47] [config] ulr-trainable-transformation: false
[2023-07-17 23:00:47] [config] unlikelihood-loss: false
[2023-07-17 23:00:47] [config] valid-freq: 50000000
[2023-07-17 23:00:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:47] [config] valid-max-length: 1000
[2023-07-17 23:00:47] [config] valid-metrics:
[2023-07-17 23:00:47] [config]   - cross-entropy
[2023-07-17 23:00:47] [config]   - translation
[2023-07-17 23:00:47] [config] valid-mini-batch: 32
[2023-07-17 23:00:47] [config] valid-reset-stalled: false
[2023-07-17 23:00:47] [config] valid-script-args:
[2023-07-17 23:00:47] [config]   []
[2023-07-17 23:00:47] [config] valid-script-path: ""
[2023-07-17 23:00:47] [config] valid-sets:
[2023-07-17 23:00:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:00:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:00:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:00:47] [config] vocabs:
[2023-07-17 23:00:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:00:47] [config] word-penalty: 0
[2023-07-17 23:00:47] [config] word-scores: false
[2023-07-17 23:00:47] [config] workspace: 5500
[2023-07-17 23:00:47] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:00:47] [training] Using single-device training
[2023-07-17 23:00:47] Synced seed 1234
[2023-07-17 23:00:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:47] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:00:47] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x562a9d376177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x562a9d376699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x562a9d37992f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x562a9d3687da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x562a9d3690f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x562a9d3b682e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x562a9d3c979d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x562a9d293b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x562a9d1b42c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x562a9d16bb9c]    main                                               + 0x3c
[0x7fcb7eb5d0b3]    __libc_start_main                                  + 0xf3
[0x562a9d1b2cbe]    _start                                             + 0x2e

[2023-07-17 23:00:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:50] [marian] Running on node22.datos.cluster.uy as process 3684 with command line:
[2023-07-17 23:00:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:00:50] [config] after: 0e
[2023-07-17 23:00:50] [config] after-batches: 0
[2023-07-17 23:00:50] [config] after-epochs: 30
[2023-07-17 23:00:50] [config] all-caps-every: 0
[2023-07-17 23:00:50] [config] allow-unk: false
[2023-07-17 23:00:50] [config] authors: false
[2023-07-17 23:00:50] [config] beam-size: 12
[2023-07-17 23:00:50] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:00:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:00:50] [config] bert-masking-fraction: 0.15
[2023-07-17 23:00:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:00:50] [config] bert-train-type-embeddings: true
[2023-07-17 23:00:50] [config] bert-type-vocab-size: 2
[2023-07-17 23:00:50] [config] build-info: ""
[2023-07-17 23:00:50] [config] check-gradient-nan: false
[2023-07-17 23:00:50] [config] check-nan: false
[2023-07-17 23:00:50] [config] cite: false
[2023-07-17 23:00:50] [config] clip-norm: 1
[2023-07-17 23:00:50] [config] cost-scaling:
[2023-07-17 23:00:50] [config]   - 256.f
[2023-07-17 23:00:50] [config]   - 1000
[2023-07-17 23:00:50] [config]   - 2.f
[2023-07-17 23:00:50] [config]   - 256.f
[2023-07-17 23:00:50] [config] cost-type: ce-sum
[2023-07-17 23:00:50] [config] cpu-threads: 0
[2023-07-17 23:00:50] [config] data-threads: 8
[2023-07-17 23:00:50] [config] data-weighting: ""
[2023-07-17 23:00:50] [config] data-weighting-type: sentence
[2023-07-17 23:00:50] [config] dec-cell: gru
[2023-07-17 23:00:50] [config] dec-cell-base-depth: 2
[2023-07-17 23:00:50] [config] dec-cell-high-depth: 1
[2023-07-17 23:00:50] [config] dec-depth: 1
[2023-07-17 23:00:50] [config] devices:
[2023-07-17 23:00:50] [config]   - 0
[2023-07-17 23:00:50] [config] dim-emb: 512
[2023-07-17 23:00:50] [config] dim-rnn: 1024
[2023-07-17 23:00:50] [config] dim-vocabs:
[2023-07-17 23:00:50] [config]   - 16384
[2023-07-17 23:00:50] [config]   - 16384
[2023-07-17 23:00:50] [config] disp-first: 0
[2023-07-17 23:00:50] [config] disp-freq: 1000u
[2023-07-17 23:00:50] [config] disp-label-counts: true
[2023-07-17 23:00:50] [config] dropout-rnn: 0
[2023-07-17 23:00:50] [config] dropout-src: 0
[2023-07-17 23:00:50] [config] dropout-trg: 0
[2023-07-17 23:00:50] [config] dump-config: ""
[2023-07-17 23:00:50] [config] dynamic-gradient-scaling:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] early-stopping: 5
[2023-07-17 23:00:50] [config] early-stopping-on: first
[2023-07-17 23:00:50] [config] embedding-fix-src: false
[2023-07-17 23:00:50] [config] embedding-fix-trg: false
[2023-07-17 23:00:50] [config] embedding-normalization: false
[2023-07-17 23:00:50] [config] embedding-vectors:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] enc-cell: gru
[2023-07-17 23:00:50] [config] enc-cell-depth: 1
[2023-07-17 23:00:50] [config] enc-depth: 1
[2023-07-17 23:00:50] [config] enc-type: bidirectional
[2023-07-17 23:00:50] [config] english-title-case-every: 0
[2023-07-17 23:00:50] [config] exponential-smoothing: 0
[2023-07-17 23:00:50] [config] factor-weight: 1
[2023-07-17 23:00:50] [config] factors-combine: sum
[2023-07-17 23:00:50] [config] factors-dim-emb: 0
[2023-07-17 23:00:50] [config] gradient-checkpointing: false
[2023-07-17 23:00:50] [config] gradient-norm-average-window: 100
[2023-07-17 23:00:50] [config] guided-alignment: none
[2023-07-17 23:00:50] [config] guided-alignment-cost: mse
[2023-07-17 23:00:50] [config] guided-alignment-weight: 0.1
[2023-07-17 23:00:50] [config] ignore-model-config: false
[2023-07-17 23:00:50] [config] input-types:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] interpolate-env-vars: false
[2023-07-17 23:00:50] [config] keep-best: false
[2023-07-17 23:00:50] [config] label-smoothing: 0
[2023-07-17 23:00:50] [config] layer-normalization: false
[2023-07-17 23:00:50] [config] learn-rate: 0.0001
[2023-07-17 23:00:50] [config] lemma-dependency: ""
[2023-07-17 23:00:50] [config] lemma-dim-emb: 0
[2023-07-17 23:00:50] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:50] [config] log-level: info
[2023-07-17 23:00:50] [config] log-time-zone: ""
[2023-07-17 23:00:50] [config] logical-epoch:
[2023-07-17 23:00:50] [config]   - 1e
[2023-07-17 23:00:50] [config]   - 0
[2023-07-17 23:00:50] [config] lr-decay: 0
[2023-07-17 23:00:50] [config] lr-decay-freq: 50000
[2023-07-17 23:00:50] [config] lr-decay-inv-sqrt:
[2023-07-17 23:00:50] [config]   - 0
[2023-07-17 23:00:50] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:00:50] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:00:50] [config] lr-decay-start:
[2023-07-17 23:00:50] [config]   - 10
[2023-07-17 23:00:50] [config]   - 1
[2023-07-17 23:00:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:00:50] [config] lr-report: false
[2023-07-17 23:00:50] [config] lr-warmup: 0
[2023-07-17 23:00:50] [config] lr-warmup-at-reload: false
[2023-07-17 23:00:50] [config] lr-warmup-cycle: false
[2023-07-17 23:00:50] [config] lr-warmup-start-rate: 0
[2023-07-17 23:00:50] [config] max-length: 150
[2023-07-17 23:00:50] [config] max-length-crop: true
[2023-07-17 23:00:50] [config] max-length-factor: 3
[2023-07-17 23:00:50] [config] maxi-batch: 100
[2023-07-17 23:00:50] [config] maxi-batch-sort: trg
[2023-07-17 23:00:50] [config] mini-batch: 64
[2023-07-17 23:00:50] [config] mini-batch-fit: true
[2023-07-17 23:00:50] [config] mini-batch-fit-step: 10
[2023-07-17 23:00:50] [config] mini-batch-round-up: true
[2023-07-17 23:00:50] [config] mini-batch-track-lr: false
[2023-07-17 23:00:50] [config] mini-batch-warmup: 0
[2023-07-17 23:00:50] [config] mini-batch-words: 0
[2023-07-17 23:00:50] [config] mini-batch-words-ref: 0
[2023-07-17 23:00:50] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:00:50] [config] multi-loss-type: sum
[2023-07-17 23:00:50] [config] n-best: false
[2023-07-17 23:00:50] [config] no-nccl: false
[2023-07-17 23:00:50] [config] no-reload: false
[2023-07-17 23:00:50] [config] no-restore-corpus: false
[2023-07-17 23:00:50] [config] normalize: 0
[2023-07-17 23:00:50] [config] normalize-gradient: false
[2023-07-17 23:00:50] [config] num-devices: 0
[2023-07-17 23:00:50] [config] optimizer: adam
[2023-07-17 23:00:50] [config] optimizer-delay: 1
[2023-07-17 23:00:50] [config] optimizer-params:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] output-omit-bias: false
[2023-07-17 23:00:50] [config] overwrite: true
[2023-07-17 23:00:50] [config] precision:
[2023-07-17 23:00:50] [config]   - float16
[2023-07-17 23:00:50] [config]   - float32
[2023-07-17 23:00:50] [config] pretrained-model: ""
[2023-07-17 23:00:50] [config] quantize-biases: false
[2023-07-17 23:00:50] [config] quantize-bits: 0
[2023-07-17 23:00:50] [config] quantize-log-based: false
[2023-07-17 23:00:50] [config] quantize-optimization-steps: 0
[2023-07-17 23:00:50] [config] quiet: false
[2023-07-17 23:00:50] [config] quiet-translation: true
[2023-07-17 23:00:50] [config] relative-paths: false
[2023-07-17 23:00:50] [config] right-left: false
[2023-07-17 23:00:50] [config] save-freq: 10000u
[2023-07-17 23:00:50] [config] seed: 1234
[2023-07-17 23:00:50] [config] sentencepiece-alphas:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:00:50] [config] sentencepiece-options: ""
[2023-07-17 23:00:50] [config] sharding: global
[2023-07-17 23:00:50] [config] shuffle: data
[2023-07-17 23:00:50] [config] shuffle-in-ram: false
[2023-07-17 23:00:50] [config] sigterm: save-and-exit
[2023-07-17 23:00:50] [config] skip: false
[2023-07-17 23:00:50] [config] sqlite: ""
[2023-07-17 23:00:50] [config] sqlite-drop: false
[2023-07-17 23:00:50] [config] sync-freq: 200u
[2023-07-17 23:00:50] [config] sync-sgd: false
[2023-07-17 23:00:50] [config] tempdir: /tmp
[2023-07-17 23:00:50] [config] tied-embeddings: false
[2023-07-17 23:00:50] [config] tied-embeddings-all: true
[2023-07-17 23:00:50] [config] tied-embeddings-src: false
[2023-07-17 23:00:50] [config] train-embedder-rank:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] train-sets:
[2023-07-17 23:00:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:00:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:00:50] [config] transformer-aan-activation: swish
[2023-07-17 23:00:50] [config] transformer-aan-depth: 2
[2023-07-17 23:00:50] [config] transformer-aan-nogate: false
[2023-07-17 23:00:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:00:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:00:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:00:50] [config] transformer-depth-scaling: false
[2023-07-17 23:00:50] [config] transformer-dim-aan: 2048
[2023-07-17 23:00:50] [config] transformer-dim-ffn: 2048
[2023-07-17 23:00:50] [config] transformer-dropout: 0
[2023-07-17 23:00:50] [config] transformer-dropout-attention: 0
[2023-07-17 23:00:50] [config] transformer-dropout-ffn: 0
[2023-07-17 23:00:50] [config] transformer-ffn-activation: swish
[2023-07-17 23:00:50] [config] transformer-ffn-depth: 2
[2023-07-17 23:00:50] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:00:50] [config] transformer-heads: 8
[2023-07-17 23:00:50] [config] transformer-no-projection: false
[2023-07-17 23:00:50] [config] transformer-pool: false
[2023-07-17 23:00:50] [config] transformer-postprocess: dan
[2023-07-17 23:00:50] [config] transformer-postprocess-emb: d
[2023-07-17 23:00:50] [config] transformer-postprocess-top: ""
[2023-07-17 23:00:50] [config] transformer-preprocess: ""
[2023-07-17 23:00:50] [config] transformer-tied-layers:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] transformer-train-position-embeddings: false
[2023-07-17 23:00:50] [config] tsv: false
[2023-07-17 23:00:50] [config] tsv-fields: 0
[2023-07-17 23:00:50] [config] type: amun
[2023-07-17 23:00:50] [config] ulr: false
[2023-07-17 23:00:50] [config] ulr-dim-emb: 0
[2023-07-17 23:00:50] [config] ulr-dropout: 0
[2023-07-17 23:00:50] [config] ulr-keys-vectors: ""
[2023-07-17 23:00:50] [config] ulr-query-vectors: ""
[2023-07-17 23:00:50] [config] ulr-softmax-temperature: 1
[2023-07-17 23:00:50] [config] ulr-trainable-transformation: false
[2023-07-17 23:00:50] [config] unlikelihood-loss: false
[2023-07-17 23:00:50] [config] valid-freq: 50000000
[2023-07-17 23:00:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:50] [config] valid-max-length: 1000
[2023-07-17 23:00:50] [config] valid-metrics:
[2023-07-17 23:00:50] [config]   - cross-entropy
[2023-07-17 23:00:50] [config]   - translation
[2023-07-17 23:00:50] [config] valid-mini-batch: 32
[2023-07-17 23:00:50] [config] valid-reset-stalled: false
[2023-07-17 23:00:50] [config] valid-script-args:
[2023-07-17 23:00:50] [config]   []
[2023-07-17 23:00:50] [config] valid-script-path: ""
[2023-07-17 23:00:50] [config] valid-sets:
[2023-07-17 23:00:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:00:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:00:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:00:50] [config] vocabs:
[2023-07-17 23:00:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:00:50] [config] word-penalty: 0
[2023-07-17 23:00:50] [config] word-scores: false
[2023-07-17 23:00:50] [config] workspace: 5500
[2023-07-17 23:00:50] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:00:50] [training] Using single-device training
[2023-07-17 23:00:50] Synced seed 1234
[2023-07-17 23:00:50] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:50] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:00:50] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x558d77723177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x558d77723699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x558d7772692f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x558d777157da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x558d777160f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x558d7776382e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x558d7777679d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x558d77640b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x558d775612c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x558d77518b9c]    main                                               + 0x3c
[0x7fe765b120b3]    __libc_start_main                                  + 0xf3
[0x558d7755fcbe]    _start                                             + 0x2e

[2023-07-17 23:00:52] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:52] [marian] Running on node22.datos.cluster.uy as process 3689 with command line:
[2023-07-17 23:00:52] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:00:52] [config] after: 0e
[2023-07-17 23:00:52] [config] after-batches: 0
[2023-07-17 23:00:52] [config] after-epochs: 40
[2023-07-17 23:00:52] [config] all-caps-every: 0
[2023-07-17 23:00:52] [config] allow-unk: false
[2023-07-17 23:00:52] [config] authors: false
[2023-07-17 23:00:52] [config] beam-size: 12
[2023-07-17 23:00:52] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:00:52] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:00:52] [config] bert-masking-fraction: 0.15
[2023-07-17 23:00:52] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:00:52] [config] bert-train-type-embeddings: true
[2023-07-17 23:00:52] [config] bert-type-vocab-size: 2
[2023-07-17 23:00:52] [config] build-info: ""
[2023-07-17 23:00:52] [config] check-gradient-nan: false
[2023-07-17 23:00:52] [config] check-nan: false
[2023-07-17 23:00:52] [config] cite: false
[2023-07-17 23:00:52] [config] clip-norm: 1
[2023-07-17 23:00:52] [config] cost-scaling:
[2023-07-17 23:00:52] [config]   - 256.f
[2023-07-17 23:00:52] [config]   - 1000
[2023-07-17 23:00:52] [config]   - 2.f
[2023-07-17 23:00:52] [config]   - 256.f
[2023-07-17 23:00:52] [config] cost-type: ce-sum
[2023-07-17 23:00:52] [config] cpu-threads: 0
[2023-07-17 23:00:52] [config] data-threads: 8
[2023-07-17 23:00:52] [config] data-weighting: ""
[2023-07-17 23:00:52] [config] data-weighting-type: sentence
[2023-07-17 23:00:52] [config] dec-cell: gru
[2023-07-17 23:00:52] [config] dec-cell-base-depth: 2
[2023-07-17 23:00:52] [config] dec-cell-high-depth: 1
[2023-07-17 23:00:52] [config] dec-depth: 1
[2023-07-17 23:00:52] [config] devices:
[2023-07-17 23:00:52] [config]   - 0
[2023-07-17 23:00:52] [config] dim-emb: 512
[2023-07-17 23:00:52] [config] dim-rnn: 1024
[2023-07-17 23:00:52] [config] dim-vocabs:
[2023-07-17 23:00:52] [config]   - 16384
[2023-07-17 23:00:52] [config]   - 16384
[2023-07-17 23:00:52] [config] disp-first: 0
[2023-07-17 23:00:52] [config] disp-freq: 1000u
[2023-07-17 23:00:52] [config] disp-label-counts: true
[2023-07-17 23:00:52] [config] dropout-rnn: 0
[2023-07-17 23:00:52] [config] dropout-src: 0
[2023-07-17 23:00:52] [config] dropout-trg: 0
[2023-07-17 23:00:52] [config] dump-config: ""
[2023-07-17 23:00:52] [config] dynamic-gradient-scaling:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] early-stopping: 5
[2023-07-17 23:00:52] [config] early-stopping-on: first
[2023-07-17 23:00:52] [config] embedding-fix-src: false
[2023-07-17 23:00:52] [config] embedding-fix-trg: false
[2023-07-17 23:00:52] [config] embedding-normalization: false
[2023-07-17 23:00:52] [config] embedding-vectors:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] enc-cell: gru
[2023-07-17 23:00:52] [config] enc-cell-depth: 1
[2023-07-17 23:00:52] [config] enc-depth: 1
[2023-07-17 23:00:52] [config] enc-type: bidirectional
[2023-07-17 23:00:52] [config] english-title-case-every: 0
[2023-07-17 23:00:52] [config] exponential-smoothing: 0
[2023-07-17 23:00:52] [config] factor-weight: 1
[2023-07-17 23:00:52] [config] factors-combine: sum
[2023-07-17 23:00:52] [config] factors-dim-emb: 0
[2023-07-17 23:00:52] [config] gradient-checkpointing: false
[2023-07-17 23:00:52] [config] gradient-norm-average-window: 100
[2023-07-17 23:00:52] [config] guided-alignment: none
[2023-07-17 23:00:52] [config] guided-alignment-cost: mse
[2023-07-17 23:00:52] [config] guided-alignment-weight: 0.1
[2023-07-17 23:00:52] [config] ignore-model-config: false
[2023-07-17 23:00:52] [config] input-types:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] interpolate-env-vars: false
[2023-07-17 23:00:52] [config] keep-best: false
[2023-07-17 23:00:52] [config] label-smoothing: 0
[2023-07-17 23:00:52] [config] layer-normalization: false
[2023-07-17 23:00:52] [config] learn-rate: 0.0001
[2023-07-17 23:00:52] [config] lemma-dependency: ""
[2023-07-17 23:00:52] [config] lemma-dim-emb: 0
[2023-07-17 23:00:52] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:52] [config] log-level: info
[2023-07-17 23:00:52] [config] log-time-zone: ""
[2023-07-17 23:00:52] [config] logical-epoch:
[2023-07-17 23:00:52] [config]   - 1e
[2023-07-17 23:00:52] [config]   - 0
[2023-07-17 23:00:52] [config] lr-decay: 0
[2023-07-17 23:00:52] [config] lr-decay-freq: 50000
[2023-07-17 23:00:52] [config] lr-decay-inv-sqrt:
[2023-07-17 23:00:52] [config]   - 0
[2023-07-17 23:00:52] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:00:52] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:00:52] [config] lr-decay-start:
[2023-07-17 23:00:52] [config]   - 10
[2023-07-17 23:00:52] [config]   - 1
[2023-07-17 23:00:52] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:00:52] [config] lr-report: false
[2023-07-17 23:00:52] [config] lr-warmup: 0
[2023-07-17 23:00:52] [config] lr-warmup-at-reload: false
[2023-07-17 23:00:52] [config] lr-warmup-cycle: false
[2023-07-17 23:00:52] [config] lr-warmup-start-rate: 0
[2023-07-17 23:00:52] [config] max-length: 150
[2023-07-17 23:00:52] [config] max-length-crop: true
[2023-07-17 23:00:52] [config] max-length-factor: 3
[2023-07-17 23:00:52] [config] maxi-batch: 100
[2023-07-17 23:00:52] [config] maxi-batch-sort: trg
[2023-07-17 23:00:52] [config] mini-batch: 64
[2023-07-17 23:00:52] [config] mini-batch-fit: true
[2023-07-17 23:00:52] [config] mini-batch-fit-step: 10
[2023-07-17 23:00:52] [config] mini-batch-round-up: true
[2023-07-17 23:00:52] [config] mini-batch-track-lr: false
[2023-07-17 23:00:52] [config] mini-batch-warmup: 0
[2023-07-17 23:00:52] [config] mini-batch-words: 0
[2023-07-17 23:00:52] [config] mini-batch-words-ref: 0
[2023-07-17 23:00:52] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:00:52] [config] multi-loss-type: sum
[2023-07-17 23:00:52] [config] n-best: false
[2023-07-17 23:00:52] [config] no-nccl: false
[2023-07-17 23:00:52] [config] no-reload: false
[2023-07-17 23:00:52] [config] no-restore-corpus: false
[2023-07-17 23:00:52] [config] normalize: 0
[2023-07-17 23:00:52] [config] normalize-gradient: false
[2023-07-17 23:00:52] [config] num-devices: 0
[2023-07-17 23:00:52] [config] optimizer: adam
[2023-07-17 23:00:52] [config] optimizer-delay: 1
[2023-07-17 23:00:52] [config] optimizer-params:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] output-omit-bias: false
[2023-07-17 23:00:52] [config] overwrite: true
[2023-07-17 23:00:52] [config] precision:
[2023-07-17 23:00:52] [config]   - float16
[2023-07-17 23:00:52] [config]   - float32
[2023-07-17 23:00:52] [config] pretrained-model: ""
[2023-07-17 23:00:52] [config] quantize-biases: false
[2023-07-17 23:00:52] [config] quantize-bits: 0
[2023-07-17 23:00:52] [config] quantize-log-based: false
[2023-07-17 23:00:52] [config] quantize-optimization-steps: 0
[2023-07-17 23:00:52] [config] quiet: false
[2023-07-17 23:00:52] [config] quiet-translation: true
[2023-07-17 23:00:52] [config] relative-paths: false
[2023-07-17 23:00:52] [config] right-left: false
[2023-07-17 23:00:52] [config] save-freq: 10000u
[2023-07-17 23:00:52] [config] seed: 1234
[2023-07-17 23:00:52] [config] sentencepiece-alphas:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:00:52] [config] sentencepiece-options: ""
[2023-07-17 23:00:52] [config] sharding: global
[2023-07-17 23:00:52] [config] shuffle: data
[2023-07-17 23:00:52] [config] shuffle-in-ram: false
[2023-07-17 23:00:52] [config] sigterm: save-and-exit
[2023-07-17 23:00:52] [config] skip: false
[2023-07-17 23:00:52] [config] sqlite: ""
[2023-07-17 23:00:52] [config] sqlite-drop: false
[2023-07-17 23:00:52] [config] sync-freq: 200u
[2023-07-17 23:00:52] [config] sync-sgd: false
[2023-07-17 23:00:52] [config] tempdir: /tmp
[2023-07-17 23:00:52] [config] tied-embeddings: false
[2023-07-17 23:00:52] [config] tied-embeddings-all: true
[2023-07-17 23:00:52] [config] tied-embeddings-src: false
[2023-07-17 23:00:52] [config] train-embedder-rank:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] train-sets:
[2023-07-17 23:00:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:00:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:00:52] [config] transformer-aan-activation: swish
[2023-07-17 23:00:52] [config] transformer-aan-depth: 2
[2023-07-17 23:00:52] [config] transformer-aan-nogate: false
[2023-07-17 23:00:52] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:00:52] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:00:52] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:00:52] [config] transformer-depth-scaling: false
[2023-07-17 23:00:52] [config] transformer-dim-aan: 2048
[2023-07-17 23:00:52] [config] transformer-dim-ffn: 2048
[2023-07-17 23:00:52] [config] transformer-dropout: 0
[2023-07-17 23:00:52] [config] transformer-dropout-attention: 0
[2023-07-17 23:00:52] [config] transformer-dropout-ffn: 0
[2023-07-17 23:00:52] [config] transformer-ffn-activation: swish
[2023-07-17 23:00:52] [config] transformer-ffn-depth: 2
[2023-07-17 23:00:52] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:00:52] [config] transformer-heads: 8
[2023-07-17 23:00:52] [config] transformer-no-projection: false
[2023-07-17 23:00:52] [config] transformer-pool: false
[2023-07-17 23:00:52] [config] transformer-postprocess: dan
[2023-07-17 23:00:52] [config] transformer-postprocess-emb: d
[2023-07-17 23:00:52] [config] transformer-postprocess-top: ""
[2023-07-17 23:00:52] [config] transformer-preprocess: ""
[2023-07-17 23:00:52] [config] transformer-tied-layers:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] transformer-train-position-embeddings: false
[2023-07-17 23:00:52] [config] tsv: false
[2023-07-17 23:00:52] [config] tsv-fields: 0
[2023-07-17 23:00:52] [config] type: amun
[2023-07-17 23:00:52] [config] ulr: false
[2023-07-17 23:00:52] [config] ulr-dim-emb: 0
[2023-07-17 23:00:52] [config] ulr-dropout: 0
[2023-07-17 23:00:52] [config] ulr-keys-vectors: ""
[2023-07-17 23:00:52] [config] ulr-query-vectors: ""
[2023-07-17 23:00:52] [config] ulr-softmax-temperature: 1
[2023-07-17 23:00:52] [config] ulr-trainable-transformation: false
[2023-07-17 23:00:52] [config] unlikelihood-loss: false
[2023-07-17 23:00:52] [config] valid-freq: 50000000
[2023-07-17 23:00:52] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:52] [config] valid-max-length: 1000
[2023-07-17 23:00:52] [config] valid-metrics:
[2023-07-17 23:00:52] [config]   - cross-entropy
[2023-07-17 23:00:52] [config]   - translation
[2023-07-17 23:00:52] [config] valid-mini-batch: 32
[2023-07-17 23:00:52] [config] valid-reset-stalled: false
[2023-07-17 23:00:52] [config] valid-script-args:
[2023-07-17 23:00:52] [config]   []
[2023-07-17 23:00:52] [config] valid-script-path: ""
[2023-07-17 23:00:52] [config] valid-sets:
[2023-07-17 23:00:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:00:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:00:52] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:00:52] [config] vocabs:
[2023-07-17 23:00:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:00:52] [config] word-penalty: 0
[2023-07-17 23:00:52] [config] word-scores: false
[2023-07-17 23:00:52] [config] workspace: 5500
[2023-07-17 23:00:52] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:00:52] [training] Using single-device training
[2023-07-17 23:00:52] Synced seed 1234
[2023-07-17 23:00:52] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:53] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:00:53] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x5621d9eb6177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x5621d9eb6699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x5621d9eb992f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5621d9ea87da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5621d9ea90f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x5621d9ef682e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x5621d9f0979d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x5621d9dd3b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5621d9cf42c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5621d9cabb9c]    main                                               + 0x3c
[0x7ff663a080b3]    __libc_start_main                                  + 0xf3
[0x5621d9cf2cbe]    _start                                             + 0x2e

[2023-07-17 23:00:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:55] [marian] Running on node22.datos.cluster.uy as process 3694 with command line:
[2023-07-17 23:00:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:00:55] [config] after: 0e
[2023-07-17 23:00:55] [config] after-batches: 0
[2023-07-17 23:00:55] [config] after-epochs: 50
[2023-07-17 23:00:55] [config] all-caps-every: 0
[2023-07-17 23:00:55] [config] allow-unk: false
[2023-07-17 23:00:55] [config] authors: false
[2023-07-17 23:00:55] [config] beam-size: 12
[2023-07-17 23:00:55] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:00:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:00:55] [config] bert-masking-fraction: 0.15
[2023-07-17 23:00:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:00:55] [config] bert-train-type-embeddings: true
[2023-07-17 23:00:55] [config] bert-type-vocab-size: 2
[2023-07-17 23:00:55] [config] build-info: ""
[2023-07-17 23:00:55] [config] check-gradient-nan: false
[2023-07-17 23:00:55] [config] check-nan: false
[2023-07-17 23:00:55] [config] cite: false
[2023-07-17 23:00:55] [config] clip-norm: 1
[2023-07-17 23:00:55] [config] cost-scaling:
[2023-07-17 23:00:55] [config]   - 256.f
[2023-07-17 23:00:55] [config]   - 1000
[2023-07-17 23:00:55] [config]   - 2.f
[2023-07-17 23:00:55] [config]   - 256.f
[2023-07-17 23:00:55] [config] cost-type: ce-sum
[2023-07-17 23:00:55] [config] cpu-threads: 0
[2023-07-17 23:00:55] [config] data-threads: 8
[2023-07-17 23:00:55] [config] data-weighting: ""
[2023-07-17 23:00:55] [config] data-weighting-type: sentence
[2023-07-17 23:00:55] [config] dec-cell: gru
[2023-07-17 23:00:55] [config] dec-cell-base-depth: 2
[2023-07-17 23:00:55] [config] dec-cell-high-depth: 1
[2023-07-17 23:00:55] [config] dec-depth: 1
[2023-07-17 23:00:55] [config] devices:
[2023-07-17 23:00:55] [config]   - 0
[2023-07-17 23:00:55] [config] dim-emb: 512
[2023-07-17 23:00:55] [config] dim-rnn: 1024
[2023-07-17 23:00:55] [config] dim-vocabs:
[2023-07-17 23:00:55] [config]   - 16384
[2023-07-17 23:00:55] [config]   - 16384
[2023-07-17 23:00:55] [config] disp-first: 0
[2023-07-17 23:00:55] [config] disp-freq: 1000u
[2023-07-17 23:00:55] [config] disp-label-counts: true
[2023-07-17 23:00:55] [config] dropout-rnn: 0
[2023-07-17 23:00:55] [config] dropout-src: 0
[2023-07-17 23:00:55] [config] dropout-trg: 0
[2023-07-17 23:00:55] [config] dump-config: ""
[2023-07-17 23:00:55] [config] dynamic-gradient-scaling:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] early-stopping: 5
[2023-07-17 23:00:55] [config] early-stopping-on: first
[2023-07-17 23:00:55] [config] embedding-fix-src: false
[2023-07-17 23:00:55] [config] embedding-fix-trg: false
[2023-07-17 23:00:55] [config] embedding-normalization: false
[2023-07-17 23:00:55] [config] embedding-vectors:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] enc-cell: gru
[2023-07-17 23:00:55] [config] enc-cell-depth: 1
[2023-07-17 23:00:55] [config] enc-depth: 1
[2023-07-17 23:00:55] [config] enc-type: bidirectional
[2023-07-17 23:00:55] [config] english-title-case-every: 0
[2023-07-17 23:00:55] [config] exponential-smoothing: 0
[2023-07-17 23:00:55] [config] factor-weight: 1
[2023-07-17 23:00:55] [config] factors-combine: sum
[2023-07-17 23:00:55] [config] factors-dim-emb: 0
[2023-07-17 23:00:55] [config] gradient-checkpointing: false
[2023-07-17 23:00:55] [config] gradient-norm-average-window: 100
[2023-07-17 23:00:55] [config] guided-alignment: none
[2023-07-17 23:00:55] [config] guided-alignment-cost: mse
[2023-07-17 23:00:55] [config] guided-alignment-weight: 0.1
[2023-07-17 23:00:55] [config] ignore-model-config: false
[2023-07-17 23:00:55] [config] input-types:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] interpolate-env-vars: false
[2023-07-17 23:00:55] [config] keep-best: false
[2023-07-17 23:00:55] [config] label-smoothing: 0
[2023-07-17 23:00:55] [config] layer-normalization: false
[2023-07-17 23:00:55] [config] learn-rate: 0.0001
[2023-07-17 23:00:55] [config] lemma-dependency: ""
[2023-07-17 23:00:55] [config] lemma-dim-emb: 0
[2023-07-17 23:00:55] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:55] [config] log-level: info
[2023-07-17 23:00:55] [config] log-time-zone: ""
[2023-07-17 23:00:55] [config] logical-epoch:
[2023-07-17 23:00:55] [config]   - 1e
[2023-07-17 23:00:55] [config]   - 0
[2023-07-17 23:00:55] [config] lr-decay: 0
[2023-07-17 23:00:55] [config] lr-decay-freq: 50000
[2023-07-17 23:00:55] [config] lr-decay-inv-sqrt:
[2023-07-17 23:00:55] [config]   - 0
[2023-07-17 23:00:55] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:00:55] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:00:55] [config] lr-decay-start:
[2023-07-17 23:00:55] [config]   - 10
[2023-07-17 23:00:55] [config]   - 1
[2023-07-17 23:00:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:00:55] [config] lr-report: false
[2023-07-17 23:00:55] [config] lr-warmup: 0
[2023-07-17 23:00:55] [config] lr-warmup-at-reload: false
[2023-07-17 23:00:55] [config] lr-warmup-cycle: false
[2023-07-17 23:00:55] [config] lr-warmup-start-rate: 0
[2023-07-17 23:00:55] [config] max-length: 150
[2023-07-17 23:00:55] [config] max-length-crop: true
[2023-07-17 23:00:55] [config] max-length-factor: 3
[2023-07-17 23:00:55] [config] maxi-batch: 100
[2023-07-17 23:00:55] [config] maxi-batch-sort: trg
[2023-07-17 23:00:55] [config] mini-batch: 64
[2023-07-17 23:00:55] [config] mini-batch-fit: true
[2023-07-17 23:00:55] [config] mini-batch-fit-step: 10
[2023-07-17 23:00:55] [config] mini-batch-round-up: true
[2023-07-17 23:00:55] [config] mini-batch-track-lr: false
[2023-07-17 23:00:55] [config] mini-batch-warmup: 0
[2023-07-17 23:00:55] [config] mini-batch-words: 0
[2023-07-17 23:00:55] [config] mini-batch-words-ref: 0
[2023-07-17 23:00:55] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:00:55] [config] multi-loss-type: sum
[2023-07-17 23:00:55] [config] n-best: false
[2023-07-17 23:00:55] [config] no-nccl: false
[2023-07-17 23:00:55] [config] no-reload: false
[2023-07-17 23:00:55] [config] no-restore-corpus: false
[2023-07-17 23:00:55] [config] normalize: 0
[2023-07-17 23:00:55] [config] normalize-gradient: false
[2023-07-17 23:00:55] [config] num-devices: 0
[2023-07-17 23:00:55] [config] optimizer: adam
[2023-07-17 23:00:55] [config] optimizer-delay: 1
[2023-07-17 23:00:55] [config] optimizer-params:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] output-omit-bias: false
[2023-07-17 23:00:55] [config] overwrite: true
[2023-07-17 23:00:55] [config] precision:
[2023-07-17 23:00:55] [config]   - float16
[2023-07-17 23:00:55] [config]   - float32
[2023-07-17 23:00:55] [config] pretrained-model: ""
[2023-07-17 23:00:55] [config] quantize-biases: false
[2023-07-17 23:00:55] [config] quantize-bits: 0
[2023-07-17 23:00:55] [config] quantize-log-based: false
[2023-07-17 23:00:55] [config] quantize-optimization-steps: 0
[2023-07-17 23:00:55] [config] quiet: false
[2023-07-17 23:00:55] [config] quiet-translation: true
[2023-07-17 23:00:55] [config] relative-paths: false
[2023-07-17 23:00:55] [config] right-left: false
[2023-07-17 23:00:55] [config] save-freq: 10000u
[2023-07-17 23:00:55] [config] seed: 1234
[2023-07-17 23:00:55] [config] sentencepiece-alphas:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:00:55] [config] sentencepiece-options: ""
[2023-07-17 23:00:55] [config] sharding: global
[2023-07-17 23:00:55] [config] shuffle: data
[2023-07-17 23:00:55] [config] shuffle-in-ram: false
[2023-07-17 23:00:55] [config] sigterm: save-and-exit
[2023-07-17 23:00:55] [config] skip: false
[2023-07-17 23:00:55] [config] sqlite: ""
[2023-07-17 23:00:55] [config] sqlite-drop: false
[2023-07-17 23:00:55] [config] sync-freq: 200u
[2023-07-17 23:00:55] [config] sync-sgd: false
[2023-07-17 23:00:55] [config] tempdir: /tmp
[2023-07-17 23:00:55] [config] tied-embeddings: false
[2023-07-17 23:00:55] [config] tied-embeddings-all: true
[2023-07-17 23:00:55] [config] tied-embeddings-src: false
[2023-07-17 23:00:55] [config] train-embedder-rank:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] train-sets:
[2023-07-17 23:00:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:00:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:00:55] [config] transformer-aan-activation: swish
[2023-07-17 23:00:55] [config] transformer-aan-depth: 2
[2023-07-17 23:00:55] [config] transformer-aan-nogate: false
[2023-07-17 23:00:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:00:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:00:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:00:55] [config] transformer-depth-scaling: false
[2023-07-17 23:00:55] [config] transformer-dim-aan: 2048
[2023-07-17 23:00:55] [config] transformer-dim-ffn: 2048
[2023-07-17 23:00:55] [config] transformer-dropout: 0
[2023-07-17 23:00:55] [config] transformer-dropout-attention: 0
[2023-07-17 23:00:55] [config] transformer-dropout-ffn: 0
[2023-07-17 23:00:55] [config] transformer-ffn-activation: swish
[2023-07-17 23:00:55] [config] transformer-ffn-depth: 2
[2023-07-17 23:00:55] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:00:55] [config] transformer-heads: 8
[2023-07-17 23:00:55] [config] transformer-no-projection: false
[2023-07-17 23:00:55] [config] transformer-pool: false
[2023-07-17 23:00:55] [config] transformer-postprocess: dan
[2023-07-17 23:00:55] [config] transformer-postprocess-emb: d
[2023-07-17 23:00:55] [config] transformer-postprocess-top: ""
[2023-07-17 23:00:55] [config] transformer-preprocess: ""
[2023-07-17 23:00:55] [config] transformer-tied-layers:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] transformer-train-position-embeddings: false
[2023-07-17 23:00:55] [config] tsv: false
[2023-07-17 23:00:55] [config] tsv-fields: 0
[2023-07-17 23:00:55] [config] type: amun
[2023-07-17 23:00:55] [config] ulr: false
[2023-07-17 23:00:55] [config] ulr-dim-emb: 0
[2023-07-17 23:00:55] [config] ulr-dropout: 0
[2023-07-17 23:00:55] [config] ulr-keys-vectors: ""
[2023-07-17 23:00:55] [config] ulr-query-vectors: ""
[2023-07-17 23:00:55] [config] ulr-softmax-temperature: 1
[2023-07-17 23:00:55] [config] ulr-trainable-transformation: false
[2023-07-17 23:00:55] [config] unlikelihood-loss: false
[2023-07-17 23:00:55] [config] valid-freq: 50000000
[2023-07-17 23:00:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:55] [config] valid-max-length: 1000
[2023-07-17 23:00:55] [config] valid-metrics:
[2023-07-17 23:00:55] [config]   - cross-entropy
[2023-07-17 23:00:55] [config]   - translation
[2023-07-17 23:00:55] [config] valid-mini-batch: 32
[2023-07-17 23:00:55] [config] valid-reset-stalled: false
[2023-07-17 23:00:55] [config] valid-script-args:
[2023-07-17 23:00:55] [config]   []
[2023-07-17 23:00:55] [config] valid-script-path: ""
[2023-07-17 23:00:55] [config] valid-sets:
[2023-07-17 23:00:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:00:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:00:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:00:55] [config] vocabs:
[2023-07-17 23:00:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:00:55] [config] word-penalty: 0
[2023-07-17 23:00:55] [config] word-scores: false
[2023-07-17 23:00:55] [config] workspace: 5500
[2023-07-17 23:00:55] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:00:55] [training] Using single-device training
[2023-07-17 23:00:55] Synced seed 1234
[2023-07-17 23:00:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:55] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:00:55] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x564945847177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x564945847699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x56494584a92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5649458397da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x56494583a0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x56494588782e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x56494589a79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x564945764b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5649456852c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56494563cb9c]    main                                               + 0x3c
[0x7ff4afbbf0b3]    __libc_start_main                                  + 0xf3
[0x564945683cbe]    _start                                             + 0x2e

[2023-07-17 23:00:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:57] [marian] Running on node22.datos.cluster.uy as process 3700 with command line:
[2023-07-17 23:00:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:00:57] [config] after: 0e
[2023-07-17 23:00:57] [config] after-batches: 0
[2023-07-17 23:00:57] [config] after-epochs: 60
[2023-07-17 23:00:57] [config] all-caps-every: 0
[2023-07-17 23:00:57] [config] allow-unk: false
[2023-07-17 23:00:57] [config] authors: false
[2023-07-17 23:00:57] [config] beam-size: 12
[2023-07-17 23:00:57] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:00:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:00:57] [config] bert-masking-fraction: 0.15
[2023-07-17 23:00:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:00:57] [config] bert-train-type-embeddings: true
[2023-07-17 23:00:57] [config] bert-type-vocab-size: 2
[2023-07-17 23:00:57] [config] build-info: ""
[2023-07-17 23:00:57] [config] check-gradient-nan: false
[2023-07-17 23:00:57] [config] check-nan: false
[2023-07-17 23:00:57] [config] cite: false
[2023-07-17 23:00:57] [config] clip-norm: 1
[2023-07-17 23:00:57] [config] cost-scaling:
[2023-07-17 23:00:57] [config]   - 256.f
[2023-07-17 23:00:57] [config]   - 1000
[2023-07-17 23:00:57] [config]   - 2.f
[2023-07-17 23:00:57] [config]   - 256.f
[2023-07-17 23:00:57] [config] cost-type: ce-sum
[2023-07-17 23:00:57] [config] cpu-threads: 0
[2023-07-17 23:00:57] [config] data-threads: 8
[2023-07-17 23:00:57] [config] data-weighting: ""
[2023-07-17 23:00:57] [config] data-weighting-type: sentence
[2023-07-17 23:00:57] [config] dec-cell: gru
[2023-07-17 23:00:57] [config] dec-cell-base-depth: 2
[2023-07-17 23:00:57] [config] dec-cell-high-depth: 1
[2023-07-17 23:00:57] [config] dec-depth: 1
[2023-07-17 23:00:57] [config] devices:
[2023-07-17 23:00:57] [config]   - 0
[2023-07-17 23:00:57] [config] dim-emb: 512
[2023-07-17 23:00:57] [config] dim-rnn: 1024
[2023-07-17 23:00:57] [config] dim-vocabs:
[2023-07-17 23:00:57] [config]   - 16384
[2023-07-17 23:00:57] [config]   - 16384
[2023-07-17 23:00:57] [config] disp-first: 0
[2023-07-17 23:00:57] [config] disp-freq: 1000u
[2023-07-17 23:00:57] [config] disp-label-counts: true
[2023-07-17 23:00:57] [config] dropout-rnn: 0
[2023-07-17 23:00:57] [config] dropout-src: 0
[2023-07-17 23:00:57] [config] dropout-trg: 0
[2023-07-17 23:00:57] [config] dump-config: ""
[2023-07-17 23:00:57] [config] dynamic-gradient-scaling:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] early-stopping: 5
[2023-07-17 23:00:57] [config] early-stopping-on: first
[2023-07-17 23:00:57] [config] embedding-fix-src: false
[2023-07-17 23:00:57] [config] embedding-fix-trg: false
[2023-07-17 23:00:57] [config] embedding-normalization: false
[2023-07-17 23:00:57] [config] embedding-vectors:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] enc-cell: gru
[2023-07-17 23:00:57] [config] enc-cell-depth: 1
[2023-07-17 23:00:57] [config] enc-depth: 1
[2023-07-17 23:00:57] [config] enc-type: bidirectional
[2023-07-17 23:00:57] [config] english-title-case-every: 0
[2023-07-17 23:00:57] [config] exponential-smoothing: 0
[2023-07-17 23:00:57] [config] factor-weight: 1
[2023-07-17 23:00:57] [config] factors-combine: sum
[2023-07-17 23:00:57] [config] factors-dim-emb: 0
[2023-07-17 23:00:57] [config] gradient-checkpointing: false
[2023-07-17 23:00:57] [config] gradient-norm-average-window: 100
[2023-07-17 23:00:57] [config] guided-alignment: none
[2023-07-17 23:00:57] [config] guided-alignment-cost: mse
[2023-07-17 23:00:57] [config] guided-alignment-weight: 0.1
[2023-07-17 23:00:57] [config] ignore-model-config: false
[2023-07-17 23:00:57] [config] input-types:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] interpolate-env-vars: false
[2023-07-17 23:00:57] [config] keep-best: false
[2023-07-17 23:00:57] [config] label-smoothing: 0
[2023-07-17 23:00:57] [config] layer-normalization: false
[2023-07-17 23:00:57] [config] learn-rate: 0.0001
[2023-07-17 23:00:57] [config] lemma-dependency: ""
[2023-07-17 23:00:57] [config] lemma-dim-emb: 0
[2023-07-17 23:00:57] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:57] [config] log-level: info
[2023-07-17 23:00:57] [config] log-time-zone: ""
[2023-07-17 23:00:57] [config] logical-epoch:
[2023-07-17 23:00:57] [config]   - 1e
[2023-07-17 23:00:57] [config]   - 0
[2023-07-17 23:00:57] [config] lr-decay: 0
[2023-07-17 23:00:57] [config] lr-decay-freq: 50000
[2023-07-17 23:00:57] [config] lr-decay-inv-sqrt:
[2023-07-17 23:00:57] [config]   - 0
[2023-07-17 23:00:57] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:00:57] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:00:57] [config] lr-decay-start:
[2023-07-17 23:00:57] [config]   - 10
[2023-07-17 23:00:57] [config]   - 1
[2023-07-17 23:00:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:00:57] [config] lr-report: false
[2023-07-17 23:00:57] [config] lr-warmup: 0
[2023-07-17 23:00:57] [config] lr-warmup-at-reload: false
[2023-07-17 23:00:57] [config] lr-warmup-cycle: false
[2023-07-17 23:00:57] [config] lr-warmup-start-rate: 0
[2023-07-17 23:00:57] [config] max-length: 150
[2023-07-17 23:00:57] [config] max-length-crop: true
[2023-07-17 23:00:57] [config] max-length-factor: 3
[2023-07-17 23:00:57] [config] maxi-batch: 100
[2023-07-17 23:00:57] [config] maxi-batch-sort: trg
[2023-07-17 23:00:57] [config] mini-batch: 64
[2023-07-17 23:00:57] [config] mini-batch-fit: true
[2023-07-17 23:00:57] [config] mini-batch-fit-step: 10
[2023-07-17 23:00:57] [config] mini-batch-round-up: true
[2023-07-17 23:00:57] [config] mini-batch-track-lr: false
[2023-07-17 23:00:57] [config] mini-batch-warmup: 0
[2023-07-17 23:00:57] [config] mini-batch-words: 0
[2023-07-17 23:00:57] [config] mini-batch-words-ref: 0
[2023-07-17 23:00:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:00:57] [config] multi-loss-type: sum
[2023-07-17 23:00:57] [config] n-best: false
[2023-07-17 23:00:57] [config] no-nccl: false
[2023-07-17 23:00:57] [config] no-reload: false
[2023-07-17 23:00:57] [config] no-restore-corpus: false
[2023-07-17 23:00:57] [config] normalize: 0
[2023-07-17 23:00:57] [config] normalize-gradient: false
[2023-07-17 23:00:57] [config] num-devices: 0
[2023-07-17 23:00:57] [config] optimizer: adam
[2023-07-17 23:00:57] [config] optimizer-delay: 1
[2023-07-17 23:00:57] [config] optimizer-params:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] output-omit-bias: false
[2023-07-17 23:00:57] [config] overwrite: true
[2023-07-17 23:00:57] [config] precision:
[2023-07-17 23:00:57] [config]   - float16
[2023-07-17 23:00:57] [config]   - float32
[2023-07-17 23:00:57] [config] pretrained-model: ""
[2023-07-17 23:00:57] [config] quantize-biases: false
[2023-07-17 23:00:57] [config] quantize-bits: 0
[2023-07-17 23:00:57] [config] quantize-log-based: false
[2023-07-17 23:00:57] [config] quantize-optimization-steps: 0
[2023-07-17 23:00:57] [config] quiet: false
[2023-07-17 23:00:57] [config] quiet-translation: true
[2023-07-17 23:00:57] [config] relative-paths: false
[2023-07-17 23:00:57] [config] right-left: false
[2023-07-17 23:00:57] [config] save-freq: 10000u
[2023-07-17 23:00:57] [config] seed: 1234
[2023-07-17 23:00:57] [config] sentencepiece-alphas:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:00:57] [config] sentencepiece-options: ""
[2023-07-17 23:00:57] [config] sharding: global
[2023-07-17 23:00:57] [config] shuffle: data
[2023-07-17 23:00:57] [config] shuffle-in-ram: false
[2023-07-17 23:00:57] [config] sigterm: save-and-exit
[2023-07-17 23:00:57] [config] skip: false
[2023-07-17 23:00:57] [config] sqlite: ""
[2023-07-17 23:00:57] [config] sqlite-drop: false
[2023-07-17 23:00:57] [config] sync-freq: 200u
[2023-07-17 23:00:57] [config] sync-sgd: false
[2023-07-17 23:00:57] [config] tempdir: /tmp
[2023-07-17 23:00:57] [config] tied-embeddings: false
[2023-07-17 23:00:57] [config] tied-embeddings-all: true
[2023-07-17 23:00:57] [config] tied-embeddings-src: false
[2023-07-17 23:00:57] [config] train-embedder-rank:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] train-sets:
[2023-07-17 23:00:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:00:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:00:57] [config] transformer-aan-activation: swish
[2023-07-17 23:00:57] [config] transformer-aan-depth: 2
[2023-07-17 23:00:57] [config] transformer-aan-nogate: false
[2023-07-17 23:00:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:00:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:00:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:00:57] [config] transformer-depth-scaling: false
[2023-07-17 23:00:57] [config] transformer-dim-aan: 2048
[2023-07-17 23:00:57] [config] transformer-dim-ffn: 2048
[2023-07-17 23:00:57] [config] transformer-dropout: 0
[2023-07-17 23:00:57] [config] transformer-dropout-attention: 0
[2023-07-17 23:00:57] [config] transformer-dropout-ffn: 0
[2023-07-17 23:00:57] [config] transformer-ffn-activation: swish
[2023-07-17 23:00:57] [config] transformer-ffn-depth: 2
[2023-07-17 23:00:57] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:00:57] [config] transformer-heads: 8
[2023-07-17 23:00:57] [config] transformer-no-projection: false
[2023-07-17 23:00:57] [config] transformer-pool: false
[2023-07-17 23:00:57] [config] transformer-postprocess: dan
[2023-07-17 23:00:57] [config] transformer-postprocess-emb: d
[2023-07-17 23:00:57] [config] transformer-postprocess-top: ""
[2023-07-17 23:00:57] [config] transformer-preprocess: ""
[2023-07-17 23:00:57] [config] transformer-tied-layers:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] transformer-train-position-embeddings: false
[2023-07-17 23:00:57] [config] tsv: false
[2023-07-17 23:00:57] [config] tsv-fields: 0
[2023-07-17 23:00:57] [config] type: amun
[2023-07-17 23:00:57] [config] ulr: false
[2023-07-17 23:00:57] [config] ulr-dim-emb: 0
[2023-07-17 23:00:57] [config] ulr-dropout: 0
[2023-07-17 23:00:57] [config] ulr-keys-vectors: ""
[2023-07-17 23:00:57] [config] ulr-query-vectors: ""
[2023-07-17 23:00:57] [config] ulr-softmax-temperature: 1
[2023-07-17 23:00:57] [config] ulr-trainable-transformation: false
[2023-07-17 23:00:57] [config] unlikelihood-loss: false
[2023-07-17 23:00:57] [config] valid-freq: 50000000
[2023-07-17 23:00:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:00:57] [config] valid-max-length: 1000
[2023-07-17 23:00:57] [config] valid-metrics:
[2023-07-17 23:00:57] [config]   - cross-entropy
[2023-07-17 23:00:57] [config]   - translation
[2023-07-17 23:00:57] [config] valid-mini-batch: 32
[2023-07-17 23:00:57] [config] valid-reset-stalled: false
[2023-07-17 23:00:57] [config] valid-script-args:
[2023-07-17 23:00:57] [config]   []
[2023-07-17 23:00:57] [config] valid-script-path: ""
[2023-07-17 23:00:57] [config] valid-sets:
[2023-07-17 23:00:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:00:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:00:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:00:57] [config] vocabs:
[2023-07-17 23:00:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:00:57] [config] word-penalty: 0
[2023-07-17 23:00:57] [config] word-scores: false
[2023-07-17 23:00:57] [config] workspace: 5500
[2023-07-17 23:00:57] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:00:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:00:57] [training] Using single-device training
[2023-07-17 23:00:58] Synced seed 1234
[2023-07-17 23:00:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:00:58] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:00:58] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x558506c7e177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x558506c7e699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x558506c8192f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x558506c707da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x558506c710f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x558506cbe82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x558506cd179d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x558506b9bb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x558506abc2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x558506a73b9c]    main                                               + 0x3c
[0x7f3303b490b3]    __libc_start_main                                  + 0xf3
[0x558506abacbe]    _start                                             + 0x2e

[2023-07-17 23:01:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:00] [marian] Running on node22.datos.cluster.uy as process 3705 with command line:
[2023-07-17 23:01:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:00] [config] after: 0e
[2023-07-17 23:01:00] [config] after-batches: 0
[2023-07-17 23:01:00] [config] after-epochs: 70
[2023-07-17 23:01:00] [config] all-caps-every: 0
[2023-07-17 23:01:00] [config] allow-unk: false
[2023-07-17 23:01:00] [config] authors: false
[2023-07-17 23:01:00] [config] beam-size: 12
[2023-07-17 23:01:00] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:00] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:00] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:00] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:00] [config] build-info: ""
[2023-07-17 23:01:00] [config] check-gradient-nan: false
[2023-07-17 23:01:00] [config] check-nan: false
[2023-07-17 23:01:00] [config] cite: false
[2023-07-17 23:01:00] [config] clip-norm: 1
[2023-07-17 23:01:00] [config] cost-scaling:
[2023-07-17 23:01:00] [config]   - 256.f
[2023-07-17 23:01:00] [config]   - 1000
[2023-07-17 23:01:00] [config]   - 2.f
[2023-07-17 23:01:00] [config]   - 256.f
[2023-07-17 23:01:00] [config] cost-type: ce-sum
[2023-07-17 23:01:00] [config] cpu-threads: 0
[2023-07-17 23:01:00] [config] data-threads: 8
[2023-07-17 23:01:00] [config] data-weighting: ""
[2023-07-17 23:01:00] [config] data-weighting-type: sentence
[2023-07-17 23:01:00] [config] dec-cell: gru
[2023-07-17 23:01:00] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:00] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:00] [config] dec-depth: 1
[2023-07-17 23:01:00] [config] devices:
[2023-07-17 23:01:00] [config]   - 0
[2023-07-17 23:01:00] [config] dim-emb: 512
[2023-07-17 23:01:00] [config] dim-rnn: 1024
[2023-07-17 23:01:00] [config] dim-vocabs:
[2023-07-17 23:01:00] [config]   - 16384
[2023-07-17 23:01:00] [config]   - 16384
[2023-07-17 23:01:00] [config] disp-first: 0
[2023-07-17 23:01:00] [config] disp-freq: 1000u
[2023-07-17 23:01:00] [config] disp-label-counts: true
[2023-07-17 23:01:00] [config] dropout-rnn: 0
[2023-07-17 23:01:00] [config] dropout-src: 0
[2023-07-17 23:01:00] [config] dropout-trg: 0
[2023-07-17 23:01:00] [config] dump-config: ""
[2023-07-17 23:01:00] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] early-stopping: 5
[2023-07-17 23:01:00] [config] early-stopping-on: first
[2023-07-17 23:01:00] [config] embedding-fix-src: false
[2023-07-17 23:01:00] [config] embedding-fix-trg: false
[2023-07-17 23:01:00] [config] embedding-normalization: false
[2023-07-17 23:01:00] [config] embedding-vectors:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] enc-cell: gru
[2023-07-17 23:01:00] [config] enc-cell-depth: 1
[2023-07-17 23:01:00] [config] enc-depth: 1
[2023-07-17 23:01:00] [config] enc-type: bidirectional
[2023-07-17 23:01:00] [config] english-title-case-every: 0
[2023-07-17 23:01:00] [config] exponential-smoothing: 0
[2023-07-17 23:01:00] [config] factor-weight: 1
[2023-07-17 23:01:00] [config] factors-combine: sum
[2023-07-17 23:01:00] [config] factors-dim-emb: 0
[2023-07-17 23:01:00] [config] gradient-checkpointing: false
[2023-07-17 23:01:00] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:00] [config] guided-alignment: none
[2023-07-17 23:01:00] [config] guided-alignment-cost: mse
[2023-07-17 23:01:00] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:00] [config] ignore-model-config: false
[2023-07-17 23:01:00] [config] input-types:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] interpolate-env-vars: false
[2023-07-17 23:01:00] [config] keep-best: false
[2023-07-17 23:01:00] [config] label-smoothing: 0
[2023-07-17 23:01:00] [config] layer-normalization: false
[2023-07-17 23:01:00] [config] learn-rate: 0.0001
[2023-07-17 23:01:00] [config] lemma-dependency: ""
[2023-07-17 23:01:00] [config] lemma-dim-emb: 0
[2023-07-17 23:01:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:00] [config] log-level: info
[2023-07-17 23:01:00] [config] log-time-zone: ""
[2023-07-17 23:01:00] [config] logical-epoch:
[2023-07-17 23:01:00] [config]   - 1e
[2023-07-17 23:01:00] [config]   - 0
[2023-07-17 23:01:00] [config] lr-decay: 0
[2023-07-17 23:01:00] [config] lr-decay-freq: 50000
[2023-07-17 23:01:00] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:00] [config]   - 0
[2023-07-17 23:01:00] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:00] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:00] [config] lr-decay-start:
[2023-07-17 23:01:00] [config]   - 10
[2023-07-17 23:01:00] [config]   - 1
[2023-07-17 23:01:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:00] [config] lr-report: false
[2023-07-17 23:01:00] [config] lr-warmup: 0
[2023-07-17 23:01:00] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:00] [config] lr-warmup-cycle: false
[2023-07-17 23:01:00] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:00] [config] max-length: 150
[2023-07-17 23:01:00] [config] max-length-crop: true
[2023-07-17 23:01:00] [config] max-length-factor: 3
[2023-07-17 23:01:00] [config] maxi-batch: 100
[2023-07-17 23:01:00] [config] maxi-batch-sort: trg
[2023-07-17 23:01:00] [config] mini-batch: 64
[2023-07-17 23:01:00] [config] mini-batch-fit: true
[2023-07-17 23:01:00] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:00] [config] mini-batch-round-up: true
[2023-07-17 23:01:00] [config] mini-batch-track-lr: false
[2023-07-17 23:01:00] [config] mini-batch-warmup: 0
[2023-07-17 23:01:00] [config] mini-batch-words: 0
[2023-07-17 23:01:00] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:00] [config] multi-loss-type: sum
[2023-07-17 23:01:00] [config] n-best: false
[2023-07-17 23:01:00] [config] no-nccl: false
[2023-07-17 23:01:00] [config] no-reload: false
[2023-07-17 23:01:00] [config] no-restore-corpus: false
[2023-07-17 23:01:00] [config] normalize: 0
[2023-07-17 23:01:00] [config] normalize-gradient: false
[2023-07-17 23:01:00] [config] num-devices: 0
[2023-07-17 23:01:00] [config] optimizer: adam
[2023-07-17 23:01:00] [config] optimizer-delay: 1
[2023-07-17 23:01:00] [config] optimizer-params:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] output-omit-bias: false
[2023-07-17 23:01:00] [config] overwrite: true
[2023-07-17 23:01:00] [config] precision:
[2023-07-17 23:01:00] [config]   - float16
[2023-07-17 23:01:00] [config]   - float32
[2023-07-17 23:01:00] [config] pretrained-model: ""
[2023-07-17 23:01:00] [config] quantize-biases: false
[2023-07-17 23:01:00] [config] quantize-bits: 0
[2023-07-17 23:01:00] [config] quantize-log-based: false
[2023-07-17 23:01:00] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:00] [config] quiet: false
[2023-07-17 23:01:00] [config] quiet-translation: true
[2023-07-17 23:01:00] [config] relative-paths: false
[2023-07-17 23:01:00] [config] right-left: false
[2023-07-17 23:01:00] [config] save-freq: 10000u
[2023-07-17 23:01:00] [config] seed: 1234
[2023-07-17 23:01:00] [config] sentencepiece-alphas:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:00] [config] sentencepiece-options: ""
[2023-07-17 23:01:00] [config] sharding: global
[2023-07-17 23:01:00] [config] shuffle: data
[2023-07-17 23:01:00] [config] shuffle-in-ram: false
[2023-07-17 23:01:00] [config] sigterm: save-and-exit
[2023-07-17 23:01:00] [config] skip: false
[2023-07-17 23:01:00] [config] sqlite: ""
[2023-07-17 23:01:00] [config] sqlite-drop: false
[2023-07-17 23:01:00] [config] sync-freq: 200u
[2023-07-17 23:01:00] [config] sync-sgd: false
[2023-07-17 23:01:00] [config] tempdir: /tmp
[2023-07-17 23:01:00] [config] tied-embeddings: false
[2023-07-17 23:01:00] [config] tied-embeddings-all: true
[2023-07-17 23:01:00] [config] tied-embeddings-src: false
[2023-07-17 23:01:00] [config] train-embedder-rank:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] train-sets:
[2023-07-17 23:01:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:00] [config] transformer-aan-activation: swish
[2023-07-17 23:01:00] [config] transformer-aan-depth: 2
[2023-07-17 23:01:00] [config] transformer-aan-nogate: false
[2023-07-17 23:01:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:00] [config] transformer-depth-scaling: false
[2023-07-17 23:01:00] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:00] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:00] [config] transformer-dropout: 0
[2023-07-17 23:01:00] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:00] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:00] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:00] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:00] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:00] [config] transformer-heads: 8
[2023-07-17 23:01:00] [config] transformer-no-projection: false
[2023-07-17 23:01:00] [config] transformer-pool: false
[2023-07-17 23:01:00] [config] transformer-postprocess: dan
[2023-07-17 23:01:00] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:00] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:00] [config] transformer-preprocess: ""
[2023-07-17 23:01:00] [config] transformer-tied-layers:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:00] [config] tsv: false
[2023-07-17 23:01:00] [config] tsv-fields: 0
[2023-07-17 23:01:00] [config] type: amun
[2023-07-17 23:01:00] [config] ulr: false
[2023-07-17 23:01:00] [config] ulr-dim-emb: 0
[2023-07-17 23:01:00] [config] ulr-dropout: 0
[2023-07-17 23:01:00] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:00] [config] ulr-query-vectors: ""
[2023-07-17 23:01:00] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:00] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:00] [config] unlikelihood-loss: false
[2023-07-17 23:01:00] [config] valid-freq: 50000000
[2023-07-17 23:01:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:00] [config] valid-max-length: 1000
[2023-07-17 23:01:00] [config] valid-metrics:
[2023-07-17 23:01:00] [config]   - cross-entropy
[2023-07-17 23:01:00] [config]   - translation
[2023-07-17 23:01:00] [config] valid-mini-batch: 32
[2023-07-17 23:01:00] [config] valid-reset-stalled: false
[2023-07-17 23:01:00] [config] valid-script-args:
[2023-07-17 23:01:00] [config]   []
[2023-07-17 23:01:00] [config] valid-script-path: ""
[2023-07-17 23:01:00] [config] valid-sets:
[2023-07-17 23:01:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:00] [config] vocabs:
[2023-07-17 23:01:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:00] [config] word-penalty: 0
[2023-07-17 23:01:00] [config] word-scores: false
[2023-07-17 23:01:00] [config] workspace: 5500
[2023-07-17 23:01:00] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:00] [training] Using single-device training
[2023-07-17 23:01:00] Synced seed 1234
[2023-07-17 23:01:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:00] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:00] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x56023094b177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x56023094b699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x56023094e92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x56023093d7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x56023093e0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x56023098b82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x56023099e79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x560230868b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5602307892c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x560230740b9c]    main                                               + 0x3c
[0x7f9602e550b3]    __libc_start_main                                  + 0xf3
[0x560230787cbe]    _start                                             + 0x2e

[2023-07-17 23:01:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:02] [marian] Running on node22.datos.cluster.uy as process 3725 with command line:
[2023-07-17 23:01:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:02] [config] after: 0e
[2023-07-17 23:01:02] [config] after-batches: 0
[2023-07-17 23:01:02] [config] after-epochs: 80
[2023-07-17 23:01:02] [config] all-caps-every: 0
[2023-07-17 23:01:02] [config] allow-unk: false
[2023-07-17 23:01:02] [config] authors: false
[2023-07-17 23:01:02] [config] beam-size: 12
[2023-07-17 23:01:02] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:02] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:02] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:02] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:02] [config] build-info: ""
[2023-07-17 23:01:02] [config] check-gradient-nan: false
[2023-07-17 23:01:02] [config] check-nan: false
[2023-07-17 23:01:02] [config] cite: false
[2023-07-17 23:01:02] [config] clip-norm: 1
[2023-07-17 23:01:02] [config] cost-scaling:
[2023-07-17 23:01:02] [config]   - 256.f
[2023-07-17 23:01:02] [config]   - 1000
[2023-07-17 23:01:02] [config]   - 2.f
[2023-07-17 23:01:02] [config]   - 256.f
[2023-07-17 23:01:02] [config] cost-type: ce-sum
[2023-07-17 23:01:02] [config] cpu-threads: 0
[2023-07-17 23:01:02] [config] data-threads: 8
[2023-07-17 23:01:02] [config] data-weighting: ""
[2023-07-17 23:01:02] [config] data-weighting-type: sentence
[2023-07-17 23:01:02] [config] dec-cell: gru
[2023-07-17 23:01:02] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:02] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:02] [config] dec-depth: 1
[2023-07-17 23:01:02] [config] devices:
[2023-07-17 23:01:02] [config]   - 0
[2023-07-17 23:01:02] [config] dim-emb: 512
[2023-07-17 23:01:02] [config] dim-rnn: 1024
[2023-07-17 23:01:02] [config] dim-vocabs:
[2023-07-17 23:01:02] [config]   - 16384
[2023-07-17 23:01:02] [config]   - 16384
[2023-07-17 23:01:02] [config] disp-first: 0
[2023-07-17 23:01:02] [config] disp-freq: 1000u
[2023-07-17 23:01:02] [config] disp-label-counts: true
[2023-07-17 23:01:02] [config] dropout-rnn: 0
[2023-07-17 23:01:02] [config] dropout-src: 0
[2023-07-17 23:01:02] [config] dropout-trg: 0
[2023-07-17 23:01:02] [config] dump-config: ""
[2023-07-17 23:01:02] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] early-stopping: 5
[2023-07-17 23:01:02] [config] early-stopping-on: first
[2023-07-17 23:01:02] [config] embedding-fix-src: false
[2023-07-17 23:01:02] [config] embedding-fix-trg: false
[2023-07-17 23:01:02] [config] embedding-normalization: false
[2023-07-17 23:01:02] [config] embedding-vectors:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] enc-cell: gru
[2023-07-17 23:01:02] [config] enc-cell-depth: 1
[2023-07-17 23:01:02] [config] enc-depth: 1
[2023-07-17 23:01:02] [config] enc-type: bidirectional
[2023-07-17 23:01:02] [config] english-title-case-every: 0
[2023-07-17 23:01:02] [config] exponential-smoothing: 0
[2023-07-17 23:01:02] [config] factor-weight: 1
[2023-07-17 23:01:02] [config] factors-combine: sum
[2023-07-17 23:01:02] [config] factors-dim-emb: 0
[2023-07-17 23:01:02] [config] gradient-checkpointing: false
[2023-07-17 23:01:02] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:02] [config] guided-alignment: none
[2023-07-17 23:01:02] [config] guided-alignment-cost: mse
[2023-07-17 23:01:02] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:02] [config] ignore-model-config: false
[2023-07-17 23:01:02] [config] input-types:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] interpolate-env-vars: false
[2023-07-17 23:01:02] [config] keep-best: false
[2023-07-17 23:01:02] [config] label-smoothing: 0
[2023-07-17 23:01:02] [config] layer-normalization: false
[2023-07-17 23:01:02] [config] learn-rate: 0.0001
[2023-07-17 23:01:02] [config] lemma-dependency: ""
[2023-07-17 23:01:02] [config] lemma-dim-emb: 0
[2023-07-17 23:01:02] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:02] [config] log-level: info
[2023-07-17 23:01:02] [config] log-time-zone: ""
[2023-07-17 23:01:02] [config] logical-epoch:
[2023-07-17 23:01:02] [config]   - 1e
[2023-07-17 23:01:02] [config]   - 0
[2023-07-17 23:01:02] [config] lr-decay: 0
[2023-07-17 23:01:02] [config] lr-decay-freq: 50000
[2023-07-17 23:01:02] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:02] [config]   - 0
[2023-07-17 23:01:02] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:02] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:02] [config] lr-decay-start:
[2023-07-17 23:01:02] [config]   - 10
[2023-07-17 23:01:02] [config]   - 1
[2023-07-17 23:01:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:02] [config] lr-report: false
[2023-07-17 23:01:02] [config] lr-warmup: 0
[2023-07-17 23:01:02] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:02] [config] lr-warmup-cycle: false
[2023-07-17 23:01:02] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:02] [config] max-length: 150
[2023-07-17 23:01:02] [config] max-length-crop: true
[2023-07-17 23:01:02] [config] max-length-factor: 3
[2023-07-17 23:01:02] [config] maxi-batch: 100
[2023-07-17 23:01:02] [config] maxi-batch-sort: trg
[2023-07-17 23:01:02] [config] mini-batch: 64
[2023-07-17 23:01:02] [config] mini-batch-fit: true
[2023-07-17 23:01:02] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:02] [config] mini-batch-round-up: true
[2023-07-17 23:01:02] [config] mini-batch-track-lr: false
[2023-07-17 23:01:02] [config] mini-batch-warmup: 0
[2023-07-17 23:01:02] [config] mini-batch-words: 0
[2023-07-17 23:01:02] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:02] [config] multi-loss-type: sum
[2023-07-17 23:01:02] [config] n-best: false
[2023-07-17 23:01:02] [config] no-nccl: false
[2023-07-17 23:01:02] [config] no-reload: false
[2023-07-17 23:01:02] [config] no-restore-corpus: false
[2023-07-17 23:01:02] [config] normalize: 0
[2023-07-17 23:01:02] [config] normalize-gradient: false
[2023-07-17 23:01:02] [config] num-devices: 0
[2023-07-17 23:01:02] [config] optimizer: adam
[2023-07-17 23:01:02] [config] optimizer-delay: 1
[2023-07-17 23:01:02] [config] optimizer-params:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] output-omit-bias: false
[2023-07-17 23:01:02] [config] overwrite: true
[2023-07-17 23:01:02] [config] precision:
[2023-07-17 23:01:02] [config]   - float16
[2023-07-17 23:01:02] [config]   - float32
[2023-07-17 23:01:02] [config] pretrained-model: ""
[2023-07-17 23:01:02] [config] quantize-biases: false
[2023-07-17 23:01:02] [config] quantize-bits: 0
[2023-07-17 23:01:02] [config] quantize-log-based: false
[2023-07-17 23:01:02] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:02] [config] quiet: false
[2023-07-17 23:01:02] [config] quiet-translation: true
[2023-07-17 23:01:02] [config] relative-paths: false
[2023-07-17 23:01:02] [config] right-left: false
[2023-07-17 23:01:02] [config] save-freq: 10000u
[2023-07-17 23:01:02] [config] seed: 1234
[2023-07-17 23:01:02] [config] sentencepiece-alphas:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:02] [config] sentencepiece-options: ""
[2023-07-17 23:01:02] [config] sharding: global
[2023-07-17 23:01:02] [config] shuffle: data
[2023-07-17 23:01:02] [config] shuffle-in-ram: false
[2023-07-17 23:01:02] [config] sigterm: save-and-exit
[2023-07-17 23:01:02] [config] skip: false
[2023-07-17 23:01:02] [config] sqlite: ""
[2023-07-17 23:01:02] [config] sqlite-drop: false
[2023-07-17 23:01:02] [config] sync-freq: 200u
[2023-07-17 23:01:02] [config] sync-sgd: false
[2023-07-17 23:01:02] [config] tempdir: /tmp
[2023-07-17 23:01:02] [config] tied-embeddings: false
[2023-07-17 23:01:02] [config] tied-embeddings-all: true
[2023-07-17 23:01:02] [config] tied-embeddings-src: false
[2023-07-17 23:01:02] [config] train-embedder-rank:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] train-sets:
[2023-07-17 23:01:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:02] [config] transformer-aan-activation: swish
[2023-07-17 23:01:02] [config] transformer-aan-depth: 2
[2023-07-17 23:01:02] [config] transformer-aan-nogate: false
[2023-07-17 23:01:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:02] [config] transformer-depth-scaling: false
[2023-07-17 23:01:02] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:02] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:02] [config] transformer-dropout: 0
[2023-07-17 23:01:02] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:02] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:02] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:02] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:02] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:02] [config] transformer-heads: 8
[2023-07-17 23:01:02] [config] transformer-no-projection: false
[2023-07-17 23:01:02] [config] transformer-pool: false
[2023-07-17 23:01:02] [config] transformer-postprocess: dan
[2023-07-17 23:01:02] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:02] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:02] [config] transformer-preprocess: ""
[2023-07-17 23:01:02] [config] transformer-tied-layers:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:02] [config] tsv: false
[2023-07-17 23:01:02] [config] tsv-fields: 0
[2023-07-17 23:01:02] [config] type: amun
[2023-07-17 23:01:02] [config] ulr: false
[2023-07-17 23:01:02] [config] ulr-dim-emb: 0
[2023-07-17 23:01:02] [config] ulr-dropout: 0
[2023-07-17 23:01:02] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:02] [config] ulr-query-vectors: ""
[2023-07-17 23:01:02] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:02] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:02] [config] unlikelihood-loss: false
[2023-07-17 23:01:02] [config] valid-freq: 50000000
[2023-07-17 23:01:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:02] [config] valid-max-length: 1000
[2023-07-17 23:01:02] [config] valid-metrics:
[2023-07-17 23:01:02] [config]   - cross-entropy
[2023-07-17 23:01:02] [config]   - translation
[2023-07-17 23:01:02] [config] valid-mini-batch: 32
[2023-07-17 23:01:02] [config] valid-reset-stalled: false
[2023-07-17 23:01:02] [config] valid-script-args:
[2023-07-17 23:01:02] [config]   []
[2023-07-17 23:01:02] [config] valid-script-path: ""
[2023-07-17 23:01:02] [config] valid-sets:
[2023-07-17 23:01:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:02] [config] vocabs:
[2023-07-17 23:01:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:02] [config] word-penalty: 0
[2023-07-17 23:01:02] [config] word-scores: false
[2023-07-17 23:01:02] [config] workspace: 5500
[2023-07-17 23:01:02] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:02] [training] Using single-device training
[2023-07-17 23:01:03] Synced seed 1234
[2023-07-17 23:01:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:03] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:03] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x557c6b1b9177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x557c6b1b9699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x557c6b1bc92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x557c6b1ab7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x557c6b1ac0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x557c6b1f982e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x557c6b20c79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x557c6b0d6b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x557c6aff72c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x557c6afaeb9c]    main                                               + 0x3c
[0x7ffae13a50b3]    __libc_start_main                                  + 0xf3
[0x557c6aff5cbe]    _start                                             + 0x2e

[2023-07-17 23:01:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:05] [marian] Running on node22.datos.cluster.uy as process 3730 with command line:
[2023-07-17 23:01:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:05] [config] after: 0e
[2023-07-17 23:01:05] [config] after-batches: 0
[2023-07-17 23:01:05] [config] after-epochs: 90
[2023-07-17 23:01:05] [config] all-caps-every: 0
[2023-07-17 23:01:05] [config] allow-unk: false
[2023-07-17 23:01:05] [config] authors: false
[2023-07-17 23:01:05] [config] beam-size: 12
[2023-07-17 23:01:05] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:05] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:05] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:05] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:05] [config] build-info: ""
[2023-07-17 23:01:05] [config] check-gradient-nan: false
[2023-07-17 23:01:05] [config] check-nan: false
[2023-07-17 23:01:05] [config] cite: false
[2023-07-17 23:01:05] [config] clip-norm: 1
[2023-07-17 23:01:05] [config] cost-scaling:
[2023-07-17 23:01:05] [config]   - 256.f
[2023-07-17 23:01:05] [config]   - 1000
[2023-07-17 23:01:05] [config]   - 2.f
[2023-07-17 23:01:05] [config]   - 256.f
[2023-07-17 23:01:05] [config] cost-type: ce-sum
[2023-07-17 23:01:05] [config] cpu-threads: 0
[2023-07-17 23:01:05] [config] data-threads: 8
[2023-07-17 23:01:05] [config] data-weighting: ""
[2023-07-17 23:01:05] [config] data-weighting-type: sentence
[2023-07-17 23:01:05] [config] dec-cell: gru
[2023-07-17 23:01:05] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:05] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:05] [config] dec-depth: 1
[2023-07-17 23:01:05] [config] devices:
[2023-07-17 23:01:05] [config]   - 0
[2023-07-17 23:01:05] [config] dim-emb: 512
[2023-07-17 23:01:05] [config] dim-rnn: 1024
[2023-07-17 23:01:05] [config] dim-vocabs:
[2023-07-17 23:01:05] [config]   - 16384
[2023-07-17 23:01:05] [config]   - 16384
[2023-07-17 23:01:05] [config] disp-first: 0
[2023-07-17 23:01:05] [config] disp-freq: 1000u
[2023-07-17 23:01:05] [config] disp-label-counts: true
[2023-07-17 23:01:05] [config] dropout-rnn: 0
[2023-07-17 23:01:05] [config] dropout-src: 0
[2023-07-17 23:01:05] [config] dropout-trg: 0
[2023-07-17 23:01:05] [config] dump-config: ""
[2023-07-17 23:01:05] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] early-stopping: 5
[2023-07-17 23:01:05] [config] early-stopping-on: first
[2023-07-17 23:01:05] [config] embedding-fix-src: false
[2023-07-17 23:01:05] [config] embedding-fix-trg: false
[2023-07-17 23:01:05] [config] embedding-normalization: false
[2023-07-17 23:01:05] [config] embedding-vectors:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] enc-cell: gru
[2023-07-17 23:01:05] [config] enc-cell-depth: 1
[2023-07-17 23:01:05] [config] enc-depth: 1
[2023-07-17 23:01:05] [config] enc-type: bidirectional
[2023-07-17 23:01:05] [config] english-title-case-every: 0
[2023-07-17 23:01:05] [config] exponential-smoothing: 0
[2023-07-17 23:01:05] [config] factor-weight: 1
[2023-07-17 23:01:05] [config] factors-combine: sum
[2023-07-17 23:01:05] [config] factors-dim-emb: 0
[2023-07-17 23:01:05] [config] gradient-checkpointing: false
[2023-07-17 23:01:05] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:05] [config] guided-alignment: none
[2023-07-17 23:01:05] [config] guided-alignment-cost: mse
[2023-07-17 23:01:05] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:05] [config] ignore-model-config: false
[2023-07-17 23:01:05] [config] input-types:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] interpolate-env-vars: false
[2023-07-17 23:01:05] [config] keep-best: false
[2023-07-17 23:01:05] [config] label-smoothing: 0
[2023-07-17 23:01:05] [config] layer-normalization: false
[2023-07-17 23:01:05] [config] learn-rate: 0.0001
[2023-07-17 23:01:05] [config] lemma-dependency: ""
[2023-07-17 23:01:05] [config] lemma-dim-emb: 0
[2023-07-17 23:01:05] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:05] [config] log-level: info
[2023-07-17 23:01:05] [config] log-time-zone: ""
[2023-07-17 23:01:05] [config] logical-epoch:
[2023-07-17 23:01:05] [config]   - 1e
[2023-07-17 23:01:05] [config]   - 0
[2023-07-17 23:01:05] [config] lr-decay: 0
[2023-07-17 23:01:05] [config] lr-decay-freq: 50000
[2023-07-17 23:01:05] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:05] [config]   - 0
[2023-07-17 23:01:05] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:05] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:05] [config] lr-decay-start:
[2023-07-17 23:01:05] [config]   - 10
[2023-07-17 23:01:05] [config]   - 1
[2023-07-17 23:01:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:05] [config] lr-report: false
[2023-07-17 23:01:05] [config] lr-warmup: 0
[2023-07-17 23:01:05] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:05] [config] lr-warmup-cycle: false
[2023-07-17 23:01:05] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:05] [config] max-length: 150
[2023-07-17 23:01:05] [config] max-length-crop: true
[2023-07-17 23:01:05] [config] max-length-factor: 3
[2023-07-17 23:01:05] [config] maxi-batch: 100
[2023-07-17 23:01:05] [config] maxi-batch-sort: trg
[2023-07-17 23:01:05] [config] mini-batch: 64
[2023-07-17 23:01:05] [config] mini-batch-fit: true
[2023-07-17 23:01:05] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:05] [config] mini-batch-round-up: true
[2023-07-17 23:01:05] [config] mini-batch-track-lr: false
[2023-07-17 23:01:05] [config] mini-batch-warmup: 0
[2023-07-17 23:01:05] [config] mini-batch-words: 0
[2023-07-17 23:01:05] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:05] [config] multi-loss-type: sum
[2023-07-17 23:01:05] [config] n-best: false
[2023-07-17 23:01:05] [config] no-nccl: false
[2023-07-17 23:01:05] [config] no-reload: false
[2023-07-17 23:01:05] [config] no-restore-corpus: false
[2023-07-17 23:01:05] [config] normalize: 0
[2023-07-17 23:01:05] [config] normalize-gradient: false
[2023-07-17 23:01:05] [config] num-devices: 0
[2023-07-17 23:01:05] [config] optimizer: adam
[2023-07-17 23:01:05] [config] optimizer-delay: 1
[2023-07-17 23:01:05] [config] optimizer-params:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] output-omit-bias: false
[2023-07-17 23:01:05] [config] overwrite: true
[2023-07-17 23:01:05] [config] precision:
[2023-07-17 23:01:05] [config]   - float16
[2023-07-17 23:01:05] [config]   - float32
[2023-07-17 23:01:05] [config] pretrained-model: ""
[2023-07-17 23:01:05] [config] quantize-biases: false
[2023-07-17 23:01:05] [config] quantize-bits: 0
[2023-07-17 23:01:05] [config] quantize-log-based: false
[2023-07-17 23:01:05] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:05] [config] quiet: false
[2023-07-17 23:01:05] [config] quiet-translation: true
[2023-07-17 23:01:05] [config] relative-paths: false
[2023-07-17 23:01:05] [config] right-left: false
[2023-07-17 23:01:05] [config] save-freq: 10000u
[2023-07-17 23:01:05] [config] seed: 1234
[2023-07-17 23:01:05] [config] sentencepiece-alphas:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:05] [config] sentencepiece-options: ""
[2023-07-17 23:01:05] [config] sharding: global
[2023-07-17 23:01:05] [config] shuffle: data
[2023-07-17 23:01:05] [config] shuffle-in-ram: false
[2023-07-17 23:01:05] [config] sigterm: save-and-exit
[2023-07-17 23:01:05] [config] skip: false
[2023-07-17 23:01:05] [config] sqlite: ""
[2023-07-17 23:01:05] [config] sqlite-drop: false
[2023-07-17 23:01:05] [config] sync-freq: 200u
[2023-07-17 23:01:05] [config] sync-sgd: false
[2023-07-17 23:01:05] [config] tempdir: /tmp
[2023-07-17 23:01:05] [config] tied-embeddings: false
[2023-07-17 23:01:05] [config] tied-embeddings-all: true
[2023-07-17 23:01:05] [config] tied-embeddings-src: false
[2023-07-17 23:01:05] [config] train-embedder-rank:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] train-sets:
[2023-07-17 23:01:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:05] [config] transformer-aan-activation: swish
[2023-07-17 23:01:05] [config] transformer-aan-depth: 2
[2023-07-17 23:01:05] [config] transformer-aan-nogate: false
[2023-07-17 23:01:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:05] [config] transformer-depth-scaling: false
[2023-07-17 23:01:05] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:05] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:05] [config] transformer-dropout: 0
[2023-07-17 23:01:05] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:05] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:05] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:05] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:05] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:05] [config] transformer-heads: 8
[2023-07-17 23:01:05] [config] transformer-no-projection: false
[2023-07-17 23:01:05] [config] transformer-pool: false
[2023-07-17 23:01:05] [config] transformer-postprocess: dan
[2023-07-17 23:01:05] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:05] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:05] [config] transformer-preprocess: ""
[2023-07-17 23:01:05] [config] transformer-tied-layers:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:05] [config] tsv: false
[2023-07-17 23:01:05] [config] tsv-fields: 0
[2023-07-17 23:01:05] [config] type: amun
[2023-07-17 23:01:05] [config] ulr: false
[2023-07-17 23:01:05] [config] ulr-dim-emb: 0
[2023-07-17 23:01:05] [config] ulr-dropout: 0
[2023-07-17 23:01:05] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:05] [config] ulr-query-vectors: ""
[2023-07-17 23:01:05] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:05] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:05] [config] unlikelihood-loss: false
[2023-07-17 23:01:05] [config] valid-freq: 50000000
[2023-07-17 23:01:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:05] [config] valid-max-length: 1000
[2023-07-17 23:01:05] [config] valid-metrics:
[2023-07-17 23:01:05] [config]   - cross-entropy
[2023-07-17 23:01:05] [config]   - translation
[2023-07-17 23:01:05] [config] valid-mini-batch: 32
[2023-07-17 23:01:05] [config] valid-reset-stalled: false
[2023-07-17 23:01:05] [config] valid-script-args:
[2023-07-17 23:01:05] [config]   []
[2023-07-17 23:01:05] [config] valid-script-path: ""
[2023-07-17 23:01:05] [config] valid-sets:
[2023-07-17 23:01:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:05] [config] vocabs:
[2023-07-17 23:01:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:05] [config] word-penalty: 0
[2023-07-17 23:01:05] [config] word-scores: false
[2023-07-17 23:01:05] [config] workspace: 5500
[2023-07-17 23:01:05] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:05] [training] Using single-device training
[2023-07-17 23:01:05] Synced seed 1234
[2023-07-17 23:01:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:05] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:05] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55bd7d938177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55bd7d938699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55bd7d93b92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55bd7d92a7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55bd7d92b0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55bd7d97882e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55bd7d98b79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55bd7d855b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55bd7d7762c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55bd7d72db9c]    main                                               + 0x3c
[0x7ff5ac5bd0b3]    __libc_start_main                                  + 0xf3
[0x55bd7d774cbe]    _start                                             + 0x2e

[2023-07-17 23:01:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:08] [marian] Running on node22.datos.cluster.uy as process 3735 with command line:
[2023-07-17 23:01:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:08] [config] after: 0e
[2023-07-17 23:01:08] [config] after-batches: 0
[2023-07-17 23:01:08] [config] after-epochs: 100
[2023-07-17 23:01:08] [config] all-caps-every: 0
[2023-07-17 23:01:08] [config] allow-unk: false
[2023-07-17 23:01:08] [config] authors: false
[2023-07-17 23:01:08] [config] beam-size: 12
[2023-07-17 23:01:08] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:08] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:08] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:08] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:08] [config] build-info: ""
[2023-07-17 23:01:08] [config] check-gradient-nan: false
[2023-07-17 23:01:08] [config] check-nan: false
[2023-07-17 23:01:08] [config] cite: false
[2023-07-17 23:01:08] [config] clip-norm: 1
[2023-07-17 23:01:08] [config] cost-scaling:
[2023-07-17 23:01:08] [config]   - 256.f
[2023-07-17 23:01:08] [config]   - 1000
[2023-07-17 23:01:08] [config]   - 2.f
[2023-07-17 23:01:08] [config]   - 256.f
[2023-07-17 23:01:08] [config] cost-type: ce-sum
[2023-07-17 23:01:08] [config] cpu-threads: 0
[2023-07-17 23:01:08] [config] data-threads: 8
[2023-07-17 23:01:08] [config] data-weighting: ""
[2023-07-17 23:01:08] [config] data-weighting-type: sentence
[2023-07-17 23:01:08] [config] dec-cell: gru
[2023-07-17 23:01:08] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:08] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:08] [config] dec-depth: 1
[2023-07-17 23:01:08] [config] devices:
[2023-07-17 23:01:08] [config]   - 0
[2023-07-17 23:01:08] [config] dim-emb: 512
[2023-07-17 23:01:08] [config] dim-rnn: 1024
[2023-07-17 23:01:08] [config] dim-vocabs:
[2023-07-17 23:01:08] [config]   - 16384
[2023-07-17 23:01:08] [config]   - 16384
[2023-07-17 23:01:08] [config] disp-first: 0
[2023-07-17 23:01:08] [config] disp-freq: 1000u
[2023-07-17 23:01:08] [config] disp-label-counts: true
[2023-07-17 23:01:08] [config] dropout-rnn: 0
[2023-07-17 23:01:08] [config] dropout-src: 0
[2023-07-17 23:01:08] [config] dropout-trg: 0
[2023-07-17 23:01:08] [config] dump-config: ""
[2023-07-17 23:01:08] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] early-stopping: 5
[2023-07-17 23:01:08] [config] early-stopping-on: first
[2023-07-17 23:01:08] [config] embedding-fix-src: false
[2023-07-17 23:01:08] [config] embedding-fix-trg: false
[2023-07-17 23:01:08] [config] embedding-normalization: false
[2023-07-17 23:01:08] [config] embedding-vectors:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] enc-cell: gru
[2023-07-17 23:01:08] [config] enc-cell-depth: 1
[2023-07-17 23:01:08] [config] enc-depth: 1
[2023-07-17 23:01:08] [config] enc-type: bidirectional
[2023-07-17 23:01:08] [config] english-title-case-every: 0
[2023-07-17 23:01:08] [config] exponential-smoothing: 0
[2023-07-17 23:01:08] [config] factor-weight: 1
[2023-07-17 23:01:08] [config] factors-combine: sum
[2023-07-17 23:01:08] [config] factors-dim-emb: 0
[2023-07-17 23:01:08] [config] gradient-checkpointing: false
[2023-07-17 23:01:08] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:08] [config] guided-alignment: none
[2023-07-17 23:01:08] [config] guided-alignment-cost: mse
[2023-07-17 23:01:08] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:08] [config] ignore-model-config: false
[2023-07-17 23:01:08] [config] input-types:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] interpolate-env-vars: false
[2023-07-17 23:01:08] [config] keep-best: false
[2023-07-17 23:01:08] [config] label-smoothing: 0
[2023-07-17 23:01:08] [config] layer-normalization: false
[2023-07-17 23:01:08] [config] learn-rate: 0.0001
[2023-07-17 23:01:08] [config] lemma-dependency: ""
[2023-07-17 23:01:08] [config] lemma-dim-emb: 0
[2023-07-17 23:01:08] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:08] [config] log-level: info
[2023-07-17 23:01:08] [config] log-time-zone: ""
[2023-07-17 23:01:08] [config] logical-epoch:
[2023-07-17 23:01:08] [config]   - 1e
[2023-07-17 23:01:08] [config]   - 0
[2023-07-17 23:01:08] [config] lr-decay: 0
[2023-07-17 23:01:08] [config] lr-decay-freq: 50000
[2023-07-17 23:01:08] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:08] [config]   - 0
[2023-07-17 23:01:08] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:08] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:08] [config] lr-decay-start:
[2023-07-17 23:01:08] [config]   - 10
[2023-07-17 23:01:08] [config]   - 1
[2023-07-17 23:01:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:08] [config] lr-report: false
[2023-07-17 23:01:08] [config] lr-warmup: 0
[2023-07-17 23:01:08] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:08] [config] lr-warmup-cycle: false
[2023-07-17 23:01:08] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:08] [config] max-length: 150
[2023-07-17 23:01:08] [config] max-length-crop: true
[2023-07-17 23:01:08] [config] max-length-factor: 3
[2023-07-17 23:01:08] [config] maxi-batch: 100
[2023-07-17 23:01:08] [config] maxi-batch-sort: trg
[2023-07-17 23:01:08] [config] mini-batch: 64
[2023-07-17 23:01:08] [config] mini-batch-fit: true
[2023-07-17 23:01:08] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:08] [config] mini-batch-round-up: true
[2023-07-17 23:01:08] [config] mini-batch-track-lr: false
[2023-07-17 23:01:08] [config] mini-batch-warmup: 0
[2023-07-17 23:01:08] [config] mini-batch-words: 0
[2023-07-17 23:01:08] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:08] [config] multi-loss-type: sum
[2023-07-17 23:01:08] [config] n-best: false
[2023-07-17 23:01:08] [config] no-nccl: false
[2023-07-17 23:01:08] [config] no-reload: false
[2023-07-17 23:01:08] [config] no-restore-corpus: false
[2023-07-17 23:01:08] [config] normalize: 0
[2023-07-17 23:01:08] [config] normalize-gradient: false
[2023-07-17 23:01:08] [config] num-devices: 0
[2023-07-17 23:01:08] [config] optimizer: adam
[2023-07-17 23:01:08] [config] optimizer-delay: 1
[2023-07-17 23:01:08] [config] optimizer-params:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] output-omit-bias: false
[2023-07-17 23:01:08] [config] overwrite: true
[2023-07-17 23:01:08] [config] precision:
[2023-07-17 23:01:08] [config]   - float16
[2023-07-17 23:01:08] [config]   - float32
[2023-07-17 23:01:08] [config] pretrained-model: ""
[2023-07-17 23:01:08] [config] quantize-biases: false
[2023-07-17 23:01:08] [config] quantize-bits: 0
[2023-07-17 23:01:08] [config] quantize-log-based: false
[2023-07-17 23:01:08] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:08] [config] quiet: false
[2023-07-17 23:01:08] [config] quiet-translation: true
[2023-07-17 23:01:08] [config] relative-paths: false
[2023-07-17 23:01:08] [config] right-left: false
[2023-07-17 23:01:08] [config] save-freq: 10000u
[2023-07-17 23:01:08] [config] seed: 1234
[2023-07-17 23:01:08] [config] sentencepiece-alphas:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:08] [config] sentencepiece-options: ""
[2023-07-17 23:01:08] [config] sharding: global
[2023-07-17 23:01:08] [config] shuffle: data
[2023-07-17 23:01:08] [config] shuffle-in-ram: false
[2023-07-17 23:01:08] [config] sigterm: save-and-exit
[2023-07-17 23:01:08] [config] skip: false
[2023-07-17 23:01:08] [config] sqlite: ""
[2023-07-17 23:01:08] [config] sqlite-drop: false
[2023-07-17 23:01:08] [config] sync-freq: 200u
[2023-07-17 23:01:08] [config] sync-sgd: false
[2023-07-17 23:01:08] [config] tempdir: /tmp
[2023-07-17 23:01:08] [config] tied-embeddings: false
[2023-07-17 23:01:08] [config] tied-embeddings-all: true
[2023-07-17 23:01:08] [config] tied-embeddings-src: false
[2023-07-17 23:01:08] [config] train-embedder-rank:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] train-sets:
[2023-07-17 23:01:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:08] [config] transformer-aan-activation: swish
[2023-07-17 23:01:08] [config] transformer-aan-depth: 2
[2023-07-17 23:01:08] [config] transformer-aan-nogate: false
[2023-07-17 23:01:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:08] [config] transformer-depth-scaling: false
[2023-07-17 23:01:08] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:08] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:08] [config] transformer-dropout: 0
[2023-07-17 23:01:08] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:08] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:08] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:08] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:08] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:08] [config] transformer-heads: 8
[2023-07-17 23:01:08] [config] transformer-no-projection: false
[2023-07-17 23:01:08] [config] transformer-pool: false
[2023-07-17 23:01:08] [config] transformer-postprocess: dan
[2023-07-17 23:01:08] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:08] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:08] [config] transformer-preprocess: ""
[2023-07-17 23:01:08] [config] transformer-tied-layers:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:08] [config] tsv: false
[2023-07-17 23:01:08] [config] tsv-fields: 0
[2023-07-17 23:01:08] [config] type: amun
[2023-07-17 23:01:08] [config] ulr: false
[2023-07-17 23:01:08] [config] ulr-dim-emb: 0
[2023-07-17 23:01:08] [config] ulr-dropout: 0
[2023-07-17 23:01:08] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:08] [config] ulr-query-vectors: ""
[2023-07-17 23:01:08] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:08] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:08] [config] unlikelihood-loss: false
[2023-07-17 23:01:08] [config] valid-freq: 50000000
[2023-07-17 23:01:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:08] [config] valid-max-length: 1000
[2023-07-17 23:01:08] [config] valid-metrics:
[2023-07-17 23:01:08] [config]   - cross-entropy
[2023-07-17 23:01:08] [config]   - translation
[2023-07-17 23:01:08] [config] valid-mini-batch: 32
[2023-07-17 23:01:08] [config] valid-reset-stalled: false
[2023-07-17 23:01:08] [config] valid-script-args:
[2023-07-17 23:01:08] [config]   []
[2023-07-17 23:01:08] [config] valid-script-path: ""
[2023-07-17 23:01:08] [config] valid-sets:
[2023-07-17 23:01:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:08] [config] vocabs:
[2023-07-17 23:01:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:08] [config] word-penalty: 0
[2023-07-17 23:01:08] [config] word-scores: false
[2023-07-17 23:01:08] [config] workspace: 5500
[2023-07-17 23:01:08] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:08] [training] Using single-device training
[2023-07-17 23:01:08] Synced seed 1234
[2023-07-17 23:01:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:08] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:08] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55a4b5497177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55a4b5497699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55a4b549a92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55a4b54897da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55a4b548a0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55a4b54d782e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55a4b54ea79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55a4b53b4b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55a4b52d52c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a4b528cb9c]    main                                               + 0x3c
[0x7f814726b0b3]    __libc_start_main                                  + 0xf3
[0x55a4b52d3cbe]    _start                                             + 0x2e

[2023-07-17 23:01:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:10] [marian] Running on node22.datos.cluster.uy as process 3740 with command line:
[2023-07-17 23:01:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:10] [config] after: 0e
[2023-07-17 23:01:10] [config] after-batches: 0
[2023-07-17 23:01:10] [config] after-epochs: 110
[2023-07-17 23:01:10] [config] all-caps-every: 0
[2023-07-17 23:01:10] [config] allow-unk: false
[2023-07-17 23:01:10] [config] authors: false
[2023-07-17 23:01:10] [config] beam-size: 12
[2023-07-17 23:01:10] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:10] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:10] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:10] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:10] [config] build-info: ""
[2023-07-17 23:01:10] [config] check-gradient-nan: false
[2023-07-17 23:01:10] [config] check-nan: false
[2023-07-17 23:01:10] [config] cite: false
[2023-07-17 23:01:10] [config] clip-norm: 1
[2023-07-17 23:01:10] [config] cost-scaling:
[2023-07-17 23:01:10] [config]   - 256.f
[2023-07-17 23:01:10] [config]   - 1000
[2023-07-17 23:01:10] [config]   - 2.f
[2023-07-17 23:01:10] [config]   - 256.f
[2023-07-17 23:01:10] [config] cost-type: ce-sum
[2023-07-17 23:01:10] [config] cpu-threads: 0
[2023-07-17 23:01:10] [config] data-threads: 8
[2023-07-17 23:01:10] [config] data-weighting: ""
[2023-07-17 23:01:10] [config] data-weighting-type: sentence
[2023-07-17 23:01:10] [config] dec-cell: gru
[2023-07-17 23:01:10] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:10] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:10] [config] dec-depth: 1
[2023-07-17 23:01:10] [config] devices:
[2023-07-17 23:01:10] [config]   - 0
[2023-07-17 23:01:10] [config] dim-emb: 512
[2023-07-17 23:01:10] [config] dim-rnn: 1024
[2023-07-17 23:01:10] [config] dim-vocabs:
[2023-07-17 23:01:10] [config]   - 16384
[2023-07-17 23:01:10] [config]   - 16384
[2023-07-17 23:01:10] [config] disp-first: 0
[2023-07-17 23:01:10] [config] disp-freq: 1000u
[2023-07-17 23:01:10] [config] disp-label-counts: true
[2023-07-17 23:01:10] [config] dropout-rnn: 0
[2023-07-17 23:01:10] [config] dropout-src: 0
[2023-07-17 23:01:10] [config] dropout-trg: 0
[2023-07-17 23:01:10] [config] dump-config: ""
[2023-07-17 23:01:10] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] early-stopping: 5
[2023-07-17 23:01:10] [config] early-stopping-on: first
[2023-07-17 23:01:10] [config] embedding-fix-src: false
[2023-07-17 23:01:10] [config] embedding-fix-trg: false
[2023-07-17 23:01:10] [config] embedding-normalization: false
[2023-07-17 23:01:10] [config] embedding-vectors:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] enc-cell: gru
[2023-07-17 23:01:10] [config] enc-cell-depth: 1
[2023-07-17 23:01:10] [config] enc-depth: 1
[2023-07-17 23:01:10] [config] enc-type: bidirectional
[2023-07-17 23:01:10] [config] english-title-case-every: 0
[2023-07-17 23:01:10] [config] exponential-smoothing: 0
[2023-07-17 23:01:10] [config] factor-weight: 1
[2023-07-17 23:01:10] [config] factors-combine: sum
[2023-07-17 23:01:10] [config] factors-dim-emb: 0
[2023-07-17 23:01:10] [config] gradient-checkpointing: false
[2023-07-17 23:01:10] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:10] [config] guided-alignment: none
[2023-07-17 23:01:10] [config] guided-alignment-cost: mse
[2023-07-17 23:01:10] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:10] [config] ignore-model-config: false
[2023-07-17 23:01:10] [config] input-types:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] interpolate-env-vars: false
[2023-07-17 23:01:10] [config] keep-best: false
[2023-07-17 23:01:10] [config] label-smoothing: 0
[2023-07-17 23:01:10] [config] layer-normalization: false
[2023-07-17 23:01:10] [config] learn-rate: 0.0001
[2023-07-17 23:01:10] [config] lemma-dependency: ""
[2023-07-17 23:01:10] [config] lemma-dim-emb: 0
[2023-07-17 23:01:10] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:10] [config] log-level: info
[2023-07-17 23:01:10] [config] log-time-zone: ""
[2023-07-17 23:01:10] [config] logical-epoch:
[2023-07-17 23:01:10] [config]   - 1e
[2023-07-17 23:01:10] [config]   - 0
[2023-07-17 23:01:10] [config] lr-decay: 0
[2023-07-17 23:01:10] [config] lr-decay-freq: 50000
[2023-07-17 23:01:10] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:10] [config]   - 0
[2023-07-17 23:01:10] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:10] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:10] [config] lr-decay-start:
[2023-07-17 23:01:10] [config]   - 10
[2023-07-17 23:01:10] [config]   - 1
[2023-07-17 23:01:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:10] [config] lr-report: false
[2023-07-17 23:01:10] [config] lr-warmup: 0
[2023-07-17 23:01:10] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:10] [config] lr-warmup-cycle: false
[2023-07-17 23:01:10] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:10] [config] max-length: 150
[2023-07-17 23:01:10] [config] max-length-crop: true
[2023-07-17 23:01:10] [config] max-length-factor: 3
[2023-07-17 23:01:10] [config] maxi-batch: 100
[2023-07-17 23:01:10] [config] maxi-batch-sort: trg
[2023-07-17 23:01:10] [config] mini-batch: 64
[2023-07-17 23:01:10] [config] mini-batch-fit: true
[2023-07-17 23:01:10] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:10] [config] mini-batch-round-up: true
[2023-07-17 23:01:10] [config] mini-batch-track-lr: false
[2023-07-17 23:01:10] [config] mini-batch-warmup: 0
[2023-07-17 23:01:10] [config] mini-batch-words: 0
[2023-07-17 23:01:10] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:10] [config] multi-loss-type: sum
[2023-07-17 23:01:10] [config] n-best: false
[2023-07-17 23:01:10] [config] no-nccl: false
[2023-07-17 23:01:10] [config] no-reload: false
[2023-07-17 23:01:10] [config] no-restore-corpus: false
[2023-07-17 23:01:10] [config] normalize: 0
[2023-07-17 23:01:10] [config] normalize-gradient: false
[2023-07-17 23:01:10] [config] num-devices: 0
[2023-07-17 23:01:10] [config] optimizer: adam
[2023-07-17 23:01:10] [config] optimizer-delay: 1
[2023-07-17 23:01:10] [config] optimizer-params:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] output-omit-bias: false
[2023-07-17 23:01:10] [config] overwrite: true
[2023-07-17 23:01:10] [config] precision:
[2023-07-17 23:01:10] [config]   - float16
[2023-07-17 23:01:10] [config]   - float32
[2023-07-17 23:01:10] [config] pretrained-model: ""
[2023-07-17 23:01:10] [config] quantize-biases: false
[2023-07-17 23:01:10] [config] quantize-bits: 0
[2023-07-17 23:01:10] [config] quantize-log-based: false
[2023-07-17 23:01:10] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:10] [config] quiet: false
[2023-07-17 23:01:10] [config] quiet-translation: true
[2023-07-17 23:01:10] [config] relative-paths: false
[2023-07-17 23:01:10] [config] right-left: false
[2023-07-17 23:01:10] [config] save-freq: 10000u
[2023-07-17 23:01:10] [config] seed: 1234
[2023-07-17 23:01:10] [config] sentencepiece-alphas:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:10] [config] sentencepiece-options: ""
[2023-07-17 23:01:10] [config] sharding: global
[2023-07-17 23:01:10] [config] shuffle: data
[2023-07-17 23:01:10] [config] shuffle-in-ram: false
[2023-07-17 23:01:10] [config] sigterm: save-and-exit
[2023-07-17 23:01:10] [config] skip: false
[2023-07-17 23:01:10] [config] sqlite: ""
[2023-07-17 23:01:10] [config] sqlite-drop: false
[2023-07-17 23:01:10] [config] sync-freq: 200u
[2023-07-17 23:01:10] [config] sync-sgd: false
[2023-07-17 23:01:10] [config] tempdir: /tmp
[2023-07-17 23:01:10] [config] tied-embeddings: false
[2023-07-17 23:01:10] [config] tied-embeddings-all: true
[2023-07-17 23:01:10] [config] tied-embeddings-src: false
[2023-07-17 23:01:10] [config] train-embedder-rank:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] train-sets:
[2023-07-17 23:01:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:10] [config] transformer-aan-activation: swish
[2023-07-17 23:01:10] [config] transformer-aan-depth: 2
[2023-07-17 23:01:10] [config] transformer-aan-nogate: false
[2023-07-17 23:01:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:10] [config] transformer-depth-scaling: false
[2023-07-17 23:01:10] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:10] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:10] [config] transformer-dropout: 0
[2023-07-17 23:01:10] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:10] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:10] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:10] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:10] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:10] [config] transformer-heads: 8
[2023-07-17 23:01:10] [config] transformer-no-projection: false
[2023-07-17 23:01:10] [config] transformer-pool: false
[2023-07-17 23:01:10] [config] transformer-postprocess: dan
[2023-07-17 23:01:10] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:10] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:10] [config] transformer-preprocess: ""
[2023-07-17 23:01:10] [config] transformer-tied-layers:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:10] [config] tsv: false
[2023-07-17 23:01:10] [config] tsv-fields: 0
[2023-07-17 23:01:10] [config] type: amun
[2023-07-17 23:01:10] [config] ulr: false
[2023-07-17 23:01:10] [config] ulr-dim-emb: 0
[2023-07-17 23:01:10] [config] ulr-dropout: 0
[2023-07-17 23:01:10] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:10] [config] ulr-query-vectors: ""
[2023-07-17 23:01:10] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:10] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:10] [config] unlikelihood-loss: false
[2023-07-17 23:01:10] [config] valid-freq: 50000000
[2023-07-17 23:01:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:10] [config] valid-max-length: 1000
[2023-07-17 23:01:10] [config] valid-metrics:
[2023-07-17 23:01:10] [config]   - cross-entropy
[2023-07-17 23:01:10] [config]   - translation
[2023-07-17 23:01:10] [config] valid-mini-batch: 32
[2023-07-17 23:01:10] [config] valid-reset-stalled: false
[2023-07-17 23:01:10] [config] valid-script-args:
[2023-07-17 23:01:10] [config]   []
[2023-07-17 23:01:10] [config] valid-script-path: ""
[2023-07-17 23:01:10] [config] valid-sets:
[2023-07-17 23:01:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:10] [config] vocabs:
[2023-07-17 23:01:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:10] [config] word-penalty: 0
[2023-07-17 23:01:10] [config] word-scores: false
[2023-07-17 23:01:10] [config] workspace: 5500
[2023-07-17 23:01:10] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:10] [training] Using single-device training
[2023-07-17 23:01:10] Synced seed 1234
[2023-07-17 23:01:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:10] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:10] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x5600cb498177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x5600cb498699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x5600cb49b92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5600cb48a7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5600cb48b0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x5600cb4d882e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x5600cb4eb79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x5600cb3b5b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5600cb2d62c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5600cb28db9c]    main                                               + 0x3c
[0x7f09ccae10b3]    __libc_start_main                                  + 0xf3
[0x5600cb2d4cbe]    _start                                             + 0x2e

[2023-07-17 23:01:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:13] [marian] Running on node22.datos.cluster.uy as process 3745 with command line:
[2023-07-17 23:01:13] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:13] [config] after: 0e
[2023-07-17 23:01:13] [config] after-batches: 0
[2023-07-17 23:01:13] [config] after-epochs: 120
[2023-07-17 23:01:13] [config] all-caps-every: 0
[2023-07-17 23:01:13] [config] allow-unk: false
[2023-07-17 23:01:13] [config] authors: false
[2023-07-17 23:01:13] [config] beam-size: 12
[2023-07-17 23:01:13] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:13] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:13] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:13] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:13] [config] build-info: ""
[2023-07-17 23:01:13] [config] check-gradient-nan: false
[2023-07-17 23:01:13] [config] check-nan: false
[2023-07-17 23:01:13] [config] cite: false
[2023-07-17 23:01:13] [config] clip-norm: 1
[2023-07-17 23:01:13] [config] cost-scaling:
[2023-07-17 23:01:13] [config]   - 256.f
[2023-07-17 23:01:13] [config]   - 1000
[2023-07-17 23:01:13] [config]   - 2.f
[2023-07-17 23:01:13] [config]   - 256.f
[2023-07-17 23:01:13] [config] cost-type: ce-sum
[2023-07-17 23:01:13] [config] cpu-threads: 0
[2023-07-17 23:01:13] [config] data-threads: 8
[2023-07-17 23:01:13] [config] data-weighting: ""
[2023-07-17 23:01:13] [config] data-weighting-type: sentence
[2023-07-17 23:01:13] [config] dec-cell: gru
[2023-07-17 23:01:13] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:13] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:13] [config] dec-depth: 1
[2023-07-17 23:01:13] [config] devices:
[2023-07-17 23:01:13] [config]   - 0
[2023-07-17 23:01:13] [config] dim-emb: 512
[2023-07-17 23:01:13] [config] dim-rnn: 1024
[2023-07-17 23:01:13] [config] dim-vocabs:
[2023-07-17 23:01:13] [config]   - 16384
[2023-07-17 23:01:13] [config]   - 16384
[2023-07-17 23:01:13] [config] disp-first: 0
[2023-07-17 23:01:13] [config] disp-freq: 1000u
[2023-07-17 23:01:13] [config] disp-label-counts: true
[2023-07-17 23:01:13] [config] dropout-rnn: 0
[2023-07-17 23:01:13] [config] dropout-src: 0
[2023-07-17 23:01:13] [config] dropout-trg: 0
[2023-07-17 23:01:13] [config] dump-config: ""
[2023-07-17 23:01:13] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] early-stopping: 5
[2023-07-17 23:01:13] [config] early-stopping-on: first
[2023-07-17 23:01:13] [config] embedding-fix-src: false
[2023-07-17 23:01:13] [config] embedding-fix-trg: false
[2023-07-17 23:01:13] [config] embedding-normalization: false
[2023-07-17 23:01:13] [config] embedding-vectors:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] enc-cell: gru
[2023-07-17 23:01:13] [config] enc-cell-depth: 1
[2023-07-17 23:01:13] [config] enc-depth: 1
[2023-07-17 23:01:13] [config] enc-type: bidirectional
[2023-07-17 23:01:13] [config] english-title-case-every: 0
[2023-07-17 23:01:13] [config] exponential-smoothing: 0
[2023-07-17 23:01:13] [config] factor-weight: 1
[2023-07-17 23:01:13] [config] factors-combine: sum
[2023-07-17 23:01:13] [config] factors-dim-emb: 0
[2023-07-17 23:01:13] [config] gradient-checkpointing: false
[2023-07-17 23:01:13] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:13] [config] guided-alignment: none
[2023-07-17 23:01:13] [config] guided-alignment-cost: mse
[2023-07-17 23:01:13] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:13] [config] ignore-model-config: false
[2023-07-17 23:01:13] [config] input-types:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] interpolate-env-vars: false
[2023-07-17 23:01:13] [config] keep-best: false
[2023-07-17 23:01:13] [config] label-smoothing: 0
[2023-07-17 23:01:13] [config] layer-normalization: false
[2023-07-17 23:01:13] [config] learn-rate: 0.0001
[2023-07-17 23:01:13] [config] lemma-dependency: ""
[2023-07-17 23:01:13] [config] lemma-dim-emb: 0
[2023-07-17 23:01:13] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:13] [config] log-level: info
[2023-07-17 23:01:13] [config] log-time-zone: ""
[2023-07-17 23:01:13] [config] logical-epoch:
[2023-07-17 23:01:13] [config]   - 1e
[2023-07-17 23:01:13] [config]   - 0
[2023-07-17 23:01:13] [config] lr-decay: 0
[2023-07-17 23:01:13] [config] lr-decay-freq: 50000
[2023-07-17 23:01:13] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:13] [config]   - 0
[2023-07-17 23:01:13] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:13] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:13] [config] lr-decay-start:
[2023-07-17 23:01:13] [config]   - 10
[2023-07-17 23:01:13] [config]   - 1
[2023-07-17 23:01:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:13] [config] lr-report: false
[2023-07-17 23:01:13] [config] lr-warmup: 0
[2023-07-17 23:01:13] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:13] [config] lr-warmup-cycle: false
[2023-07-17 23:01:13] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:13] [config] max-length: 150
[2023-07-17 23:01:13] [config] max-length-crop: true
[2023-07-17 23:01:13] [config] max-length-factor: 3
[2023-07-17 23:01:13] [config] maxi-batch: 100
[2023-07-17 23:01:13] [config] maxi-batch-sort: trg
[2023-07-17 23:01:13] [config] mini-batch: 64
[2023-07-17 23:01:13] [config] mini-batch-fit: true
[2023-07-17 23:01:13] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:13] [config] mini-batch-round-up: true
[2023-07-17 23:01:13] [config] mini-batch-track-lr: false
[2023-07-17 23:01:13] [config] mini-batch-warmup: 0
[2023-07-17 23:01:13] [config] mini-batch-words: 0
[2023-07-17 23:01:13] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:13] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:13] [config] multi-loss-type: sum
[2023-07-17 23:01:13] [config] n-best: false
[2023-07-17 23:01:13] [config] no-nccl: false
[2023-07-17 23:01:13] [config] no-reload: false
[2023-07-17 23:01:13] [config] no-restore-corpus: false
[2023-07-17 23:01:13] [config] normalize: 0
[2023-07-17 23:01:13] [config] normalize-gradient: false
[2023-07-17 23:01:13] [config] num-devices: 0
[2023-07-17 23:01:13] [config] optimizer: adam
[2023-07-17 23:01:13] [config] optimizer-delay: 1
[2023-07-17 23:01:13] [config] optimizer-params:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] output-omit-bias: false
[2023-07-17 23:01:13] [config] overwrite: true
[2023-07-17 23:01:13] [config] precision:
[2023-07-17 23:01:13] [config]   - float16
[2023-07-17 23:01:13] [config]   - float32
[2023-07-17 23:01:13] [config] pretrained-model: ""
[2023-07-17 23:01:13] [config] quantize-biases: false
[2023-07-17 23:01:13] [config] quantize-bits: 0
[2023-07-17 23:01:13] [config] quantize-log-based: false
[2023-07-17 23:01:13] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:13] [config] quiet: false
[2023-07-17 23:01:13] [config] quiet-translation: true
[2023-07-17 23:01:13] [config] relative-paths: false
[2023-07-17 23:01:13] [config] right-left: false
[2023-07-17 23:01:13] [config] save-freq: 10000u
[2023-07-17 23:01:13] [config] seed: 1234
[2023-07-17 23:01:13] [config] sentencepiece-alphas:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:13] [config] sentencepiece-options: ""
[2023-07-17 23:01:13] [config] sharding: global
[2023-07-17 23:01:13] [config] shuffle: data
[2023-07-17 23:01:13] [config] shuffle-in-ram: false
[2023-07-17 23:01:13] [config] sigterm: save-and-exit
[2023-07-17 23:01:13] [config] skip: false
[2023-07-17 23:01:13] [config] sqlite: ""
[2023-07-17 23:01:13] [config] sqlite-drop: false
[2023-07-17 23:01:13] [config] sync-freq: 200u
[2023-07-17 23:01:13] [config] sync-sgd: false
[2023-07-17 23:01:13] [config] tempdir: /tmp
[2023-07-17 23:01:13] [config] tied-embeddings: false
[2023-07-17 23:01:13] [config] tied-embeddings-all: true
[2023-07-17 23:01:13] [config] tied-embeddings-src: false
[2023-07-17 23:01:13] [config] train-embedder-rank:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] train-sets:
[2023-07-17 23:01:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:13] [config] transformer-aan-activation: swish
[2023-07-17 23:01:13] [config] transformer-aan-depth: 2
[2023-07-17 23:01:13] [config] transformer-aan-nogate: false
[2023-07-17 23:01:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:13] [config] transformer-depth-scaling: false
[2023-07-17 23:01:13] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:13] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:13] [config] transformer-dropout: 0
[2023-07-17 23:01:13] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:13] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:13] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:13] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:13] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:13] [config] transformer-heads: 8
[2023-07-17 23:01:13] [config] transformer-no-projection: false
[2023-07-17 23:01:13] [config] transformer-pool: false
[2023-07-17 23:01:13] [config] transformer-postprocess: dan
[2023-07-17 23:01:13] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:13] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:13] [config] transformer-preprocess: ""
[2023-07-17 23:01:13] [config] transformer-tied-layers:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:13] [config] tsv: false
[2023-07-17 23:01:13] [config] tsv-fields: 0
[2023-07-17 23:01:13] [config] type: amun
[2023-07-17 23:01:13] [config] ulr: false
[2023-07-17 23:01:13] [config] ulr-dim-emb: 0
[2023-07-17 23:01:13] [config] ulr-dropout: 0
[2023-07-17 23:01:13] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:13] [config] ulr-query-vectors: ""
[2023-07-17 23:01:13] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:13] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:13] [config] unlikelihood-loss: false
[2023-07-17 23:01:13] [config] valid-freq: 50000000
[2023-07-17 23:01:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:13] [config] valid-max-length: 1000
[2023-07-17 23:01:13] [config] valid-metrics:
[2023-07-17 23:01:13] [config]   - cross-entropy
[2023-07-17 23:01:13] [config]   - translation
[2023-07-17 23:01:13] [config] valid-mini-batch: 32
[2023-07-17 23:01:13] [config] valid-reset-stalled: false
[2023-07-17 23:01:13] [config] valid-script-args:
[2023-07-17 23:01:13] [config]   []
[2023-07-17 23:01:13] [config] valid-script-path: ""
[2023-07-17 23:01:13] [config] valid-sets:
[2023-07-17 23:01:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:13] [config] vocabs:
[2023-07-17 23:01:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:13] [config] word-penalty: 0
[2023-07-17 23:01:13] [config] word-scores: false
[2023-07-17 23:01:13] [config] workspace: 5500
[2023-07-17 23:01:13] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:13] [training] Using single-device training
[2023-07-17 23:01:13] Synced seed 1234
[2023-07-17 23:01:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:13] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:13] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55a929c60177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55a929c60699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55a929c6392f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55a929c527da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55a929c530f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55a929ca082e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55a929cb379d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55a929b7db7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55a929a9e2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a929a55b9c]    main                                               + 0x3c
[0x7fda43e4e0b3]    __libc_start_main                                  + 0xf3
[0x55a929a9ccbe]    _start                                             + 0x2e

[2023-07-17 23:01:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:15] [marian] Running on node22.datos.cluster.uy as process 3750 with command line:
[2023-07-17 23:01:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:15] [config] after: 0e
[2023-07-17 23:01:15] [config] after-batches: 0
[2023-07-17 23:01:15] [config] after-epochs: 130
[2023-07-17 23:01:15] [config] all-caps-every: 0
[2023-07-17 23:01:15] [config] allow-unk: false
[2023-07-17 23:01:15] [config] authors: false
[2023-07-17 23:01:15] [config] beam-size: 12
[2023-07-17 23:01:15] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:15] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:15] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:15] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:15] [config] build-info: ""
[2023-07-17 23:01:15] [config] check-gradient-nan: false
[2023-07-17 23:01:15] [config] check-nan: false
[2023-07-17 23:01:15] [config] cite: false
[2023-07-17 23:01:15] [config] clip-norm: 1
[2023-07-17 23:01:15] [config] cost-scaling:
[2023-07-17 23:01:15] [config]   - 256.f
[2023-07-17 23:01:15] [config]   - 1000
[2023-07-17 23:01:15] [config]   - 2.f
[2023-07-17 23:01:15] [config]   - 256.f
[2023-07-17 23:01:15] [config] cost-type: ce-sum
[2023-07-17 23:01:15] [config] cpu-threads: 0
[2023-07-17 23:01:15] [config] data-threads: 8
[2023-07-17 23:01:15] [config] data-weighting: ""
[2023-07-17 23:01:15] [config] data-weighting-type: sentence
[2023-07-17 23:01:15] [config] dec-cell: gru
[2023-07-17 23:01:15] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:15] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:15] [config] dec-depth: 1
[2023-07-17 23:01:15] [config] devices:
[2023-07-17 23:01:15] [config]   - 0
[2023-07-17 23:01:15] [config] dim-emb: 512
[2023-07-17 23:01:15] [config] dim-rnn: 1024
[2023-07-17 23:01:15] [config] dim-vocabs:
[2023-07-17 23:01:15] [config]   - 16384
[2023-07-17 23:01:15] [config]   - 16384
[2023-07-17 23:01:15] [config] disp-first: 0
[2023-07-17 23:01:15] [config] disp-freq: 1000u
[2023-07-17 23:01:15] [config] disp-label-counts: true
[2023-07-17 23:01:15] [config] dropout-rnn: 0
[2023-07-17 23:01:15] [config] dropout-src: 0
[2023-07-17 23:01:15] [config] dropout-trg: 0
[2023-07-17 23:01:15] [config] dump-config: ""
[2023-07-17 23:01:15] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] early-stopping: 5
[2023-07-17 23:01:15] [config] early-stopping-on: first
[2023-07-17 23:01:15] [config] embedding-fix-src: false
[2023-07-17 23:01:15] [config] embedding-fix-trg: false
[2023-07-17 23:01:15] [config] embedding-normalization: false
[2023-07-17 23:01:15] [config] embedding-vectors:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] enc-cell: gru
[2023-07-17 23:01:15] [config] enc-cell-depth: 1
[2023-07-17 23:01:15] [config] enc-depth: 1
[2023-07-17 23:01:15] [config] enc-type: bidirectional
[2023-07-17 23:01:15] [config] english-title-case-every: 0
[2023-07-17 23:01:15] [config] exponential-smoothing: 0
[2023-07-17 23:01:15] [config] factor-weight: 1
[2023-07-17 23:01:15] [config] factors-combine: sum
[2023-07-17 23:01:15] [config] factors-dim-emb: 0
[2023-07-17 23:01:15] [config] gradient-checkpointing: false
[2023-07-17 23:01:15] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:15] [config] guided-alignment: none
[2023-07-17 23:01:15] [config] guided-alignment-cost: mse
[2023-07-17 23:01:15] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:15] [config] ignore-model-config: false
[2023-07-17 23:01:15] [config] input-types:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] interpolate-env-vars: false
[2023-07-17 23:01:15] [config] keep-best: false
[2023-07-17 23:01:15] [config] label-smoothing: 0
[2023-07-17 23:01:15] [config] layer-normalization: false
[2023-07-17 23:01:15] [config] learn-rate: 0.0001
[2023-07-17 23:01:15] [config] lemma-dependency: ""
[2023-07-17 23:01:15] [config] lemma-dim-emb: 0
[2023-07-17 23:01:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:15] [config] log-level: info
[2023-07-17 23:01:15] [config] log-time-zone: ""
[2023-07-17 23:01:15] [config] logical-epoch:
[2023-07-17 23:01:15] [config]   - 1e
[2023-07-17 23:01:15] [config]   - 0
[2023-07-17 23:01:15] [config] lr-decay: 0
[2023-07-17 23:01:15] [config] lr-decay-freq: 50000
[2023-07-17 23:01:15] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:15] [config]   - 0
[2023-07-17 23:01:15] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:15] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:15] [config] lr-decay-start:
[2023-07-17 23:01:15] [config]   - 10
[2023-07-17 23:01:15] [config]   - 1
[2023-07-17 23:01:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:15] [config] lr-report: false
[2023-07-17 23:01:15] [config] lr-warmup: 0
[2023-07-17 23:01:15] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:15] [config] lr-warmup-cycle: false
[2023-07-17 23:01:15] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:15] [config] max-length: 150
[2023-07-17 23:01:15] [config] max-length-crop: true
[2023-07-17 23:01:15] [config] max-length-factor: 3
[2023-07-17 23:01:15] [config] maxi-batch: 100
[2023-07-17 23:01:15] [config] maxi-batch-sort: trg
[2023-07-17 23:01:15] [config] mini-batch: 64
[2023-07-17 23:01:15] [config] mini-batch-fit: true
[2023-07-17 23:01:15] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:15] [config] mini-batch-round-up: true
[2023-07-17 23:01:15] [config] mini-batch-track-lr: false
[2023-07-17 23:01:15] [config] mini-batch-warmup: 0
[2023-07-17 23:01:15] [config] mini-batch-words: 0
[2023-07-17 23:01:15] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:15] [config] multi-loss-type: sum
[2023-07-17 23:01:15] [config] n-best: false
[2023-07-17 23:01:15] [config] no-nccl: false
[2023-07-17 23:01:15] [config] no-reload: false
[2023-07-17 23:01:15] [config] no-restore-corpus: false
[2023-07-17 23:01:15] [config] normalize: 0
[2023-07-17 23:01:15] [config] normalize-gradient: false
[2023-07-17 23:01:15] [config] num-devices: 0
[2023-07-17 23:01:15] [config] optimizer: adam
[2023-07-17 23:01:15] [config] optimizer-delay: 1
[2023-07-17 23:01:15] [config] optimizer-params:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] output-omit-bias: false
[2023-07-17 23:01:15] [config] overwrite: true
[2023-07-17 23:01:15] [config] precision:
[2023-07-17 23:01:15] [config]   - float16
[2023-07-17 23:01:15] [config]   - float32
[2023-07-17 23:01:15] [config] pretrained-model: ""
[2023-07-17 23:01:15] [config] quantize-biases: false
[2023-07-17 23:01:15] [config] quantize-bits: 0
[2023-07-17 23:01:15] [config] quantize-log-based: false
[2023-07-17 23:01:15] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:15] [config] quiet: false
[2023-07-17 23:01:15] [config] quiet-translation: true
[2023-07-17 23:01:15] [config] relative-paths: false
[2023-07-17 23:01:15] [config] right-left: false
[2023-07-17 23:01:15] [config] save-freq: 10000u
[2023-07-17 23:01:15] [config] seed: 1234
[2023-07-17 23:01:15] [config] sentencepiece-alphas:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:15] [config] sentencepiece-options: ""
[2023-07-17 23:01:15] [config] sharding: global
[2023-07-17 23:01:15] [config] shuffle: data
[2023-07-17 23:01:15] [config] shuffle-in-ram: false
[2023-07-17 23:01:15] [config] sigterm: save-and-exit
[2023-07-17 23:01:15] [config] skip: false
[2023-07-17 23:01:15] [config] sqlite: ""
[2023-07-17 23:01:15] [config] sqlite-drop: false
[2023-07-17 23:01:15] [config] sync-freq: 200u
[2023-07-17 23:01:15] [config] sync-sgd: false
[2023-07-17 23:01:15] [config] tempdir: /tmp
[2023-07-17 23:01:15] [config] tied-embeddings: false
[2023-07-17 23:01:15] [config] tied-embeddings-all: true
[2023-07-17 23:01:15] [config] tied-embeddings-src: false
[2023-07-17 23:01:15] [config] train-embedder-rank:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] train-sets:
[2023-07-17 23:01:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:15] [config] transformer-aan-activation: swish
[2023-07-17 23:01:15] [config] transformer-aan-depth: 2
[2023-07-17 23:01:15] [config] transformer-aan-nogate: false
[2023-07-17 23:01:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:15] [config] transformer-depth-scaling: false
[2023-07-17 23:01:15] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:15] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:15] [config] transformer-dropout: 0
[2023-07-17 23:01:15] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:15] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:15] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:15] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:15] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:15] [config] transformer-heads: 8
[2023-07-17 23:01:15] [config] transformer-no-projection: false
[2023-07-17 23:01:15] [config] transformer-pool: false
[2023-07-17 23:01:15] [config] transformer-postprocess: dan
[2023-07-17 23:01:15] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:15] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:15] [config] transformer-preprocess: ""
[2023-07-17 23:01:15] [config] transformer-tied-layers:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:15] [config] tsv: false
[2023-07-17 23:01:15] [config] tsv-fields: 0
[2023-07-17 23:01:15] [config] type: amun
[2023-07-17 23:01:15] [config] ulr: false
[2023-07-17 23:01:15] [config] ulr-dim-emb: 0
[2023-07-17 23:01:15] [config] ulr-dropout: 0
[2023-07-17 23:01:15] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:15] [config] ulr-query-vectors: ""
[2023-07-17 23:01:15] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:15] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:15] [config] unlikelihood-loss: false
[2023-07-17 23:01:15] [config] valid-freq: 50000000
[2023-07-17 23:01:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:15] [config] valid-max-length: 1000
[2023-07-17 23:01:15] [config] valid-metrics:
[2023-07-17 23:01:15] [config]   - cross-entropy
[2023-07-17 23:01:15] [config]   - translation
[2023-07-17 23:01:15] [config] valid-mini-batch: 32
[2023-07-17 23:01:15] [config] valid-reset-stalled: false
[2023-07-17 23:01:15] [config] valid-script-args:
[2023-07-17 23:01:15] [config]   []
[2023-07-17 23:01:15] [config] valid-script-path: ""
[2023-07-17 23:01:15] [config] valid-sets:
[2023-07-17 23:01:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:15] [config] vocabs:
[2023-07-17 23:01:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:15] [config] word-penalty: 0
[2023-07-17 23:01:15] [config] word-scores: false
[2023-07-17 23:01:15] [config] workspace: 5500
[2023-07-17 23:01:15] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:15] [training] Using single-device training
[2023-07-17 23:01:16] Synced seed 1234
[2023-07-17 23:01:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:16] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:16] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55df7f07e177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55df7f07e699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55df7f08192f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55df7f0707da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55df7f0710f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55df7f0be82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55df7f0d179d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55df7ef9bb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55df7eebc2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55df7ee73b9c]    main                                               + 0x3c
[0x7efef43340b3]    __libc_start_main                                  + 0xf3
[0x55df7eebacbe]    _start                                             + 0x2e

[2023-07-17 23:01:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:18] [marian] Running on node22.datos.cluster.uy as process 3755 with command line:
[2023-07-17 23:01:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:18] [config] after: 0e
[2023-07-17 23:01:18] [config] after-batches: 0
[2023-07-17 23:01:18] [config] after-epochs: 140
[2023-07-17 23:01:18] [config] all-caps-every: 0
[2023-07-17 23:01:18] [config] allow-unk: false
[2023-07-17 23:01:18] [config] authors: false
[2023-07-17 23:01:18] [config] beam-size: 12
[2023-07-17 23:01:18] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:18] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:18] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:18] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:18] [config] build-info: ""
[2023-07-17 23:01:18] [config] check-gradient-nan: false
[2023-07-17 23:01:18] [config] check-nan: false
[2023-07-17 23:01:18] [config] cite: false
[2023-07-17 23:01:18] [config] clip-norm: 1
[2023-07-17 23:01:18] [config] cost-scaling:
[2023-07-17 23:01:18] [config]   - 256.f
[2023-07-17 23:01:18] [config]   - 1000
[2023-07-17 23:01:18] [config]   - 2.f
[2023-07-17 23:01:18] [config]   - 256.f
[2023-07-17 23:01:18] [config] cost-type: ce-sum
[2023-07-17 23:01:18] [config] cpu-threads: 0
[2023-07-17 23:01:18] [config] data-threads: 8
[2023-07-17 23:01:18] [config] data-weighting: ""
[2023-07-17 23:01:18] [config] data-weighting-type: sentence
[2023-07-17 23:01:18] [config] dec-cell: gru
[2023-07-17 23:01:18] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:18] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:18] [config] dec-depth: 1
[2023-07-17 23:01:18] [config] devices:
[2023-07-17 23:01:18] [config]   - 0
[2023-07-17 23:01:18] [config] dim-emb: 512
[2023-07-17 23:01:18] [config] dim-rnn: 1024
[2023-07-17 23:01:18] [config] dim-vocabs:
[2023-07-17 23:01:18] [config]   - 16384
[2023-07-17 23:01:18] [config]   - 16384
[2023-07-17 23:01:18] [config] disp-first: 0
[2023-07-17 23:01:18] [config] disp-freq: 1000u
[2023-07-17 23:01:18] [config] disp-label-counts: true
[2023-07-17 23:01:18] [config] dropout-rnn: 0
[2023-07-17 23:01:18] [config] dropout-src: 0
[2023-07-17 23:01:18] [config] dropout-trg: 0
[2023-07-17 23:01:18] [config] dump-config: ""
[2023-07-17 23:01:18] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] early-stopping: 5
[2023-07-17 23:01:18] [config] early-stopping-on: first
[2023-07-17 23:01:18] [config] embedding-fix-src: false
[2023-07-17 23:01:18] [config] embedding-fix-trg: false
[2023-07-17 23:01:18] [config] embedding-normalization: false
[2023-07-17 23:01:18] [config] embedding-vectors:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] enc-cell: gru
[2023-07-17 23:01:18] [config] enc-cell-depth: 1
[2023-07-17 23:01:18] [config] enc-depth: 1
[2023-07-17 23:01:18] [config] enc-type: bidirectional
[2023-07-17 23:01:18] [config] english-title-case-every: 0
[2023-07-17 23:01:18] [config] exponential-smoothing: 0
[2023-07-17 23:01:18] [config] factor-weight: 1
[2023-07-17 23:01:18] [config] factors-combine: sum
[2023-07-17 23:01:18] [config] factors-dim-emb: 0
[2023-07-17 23:01:18] [config] gradient-checkpointing: false
[2023-07-17 23:01:18] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:18] [config] guided-alignment: none
[2023-07-17 23:01:18] [config] guided-alignment-cost: mse
[2023-07-17 23:01:18] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:18] [config] ignore-model-config: false
[2023-07-17 23:01:18] [config] input-types:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] interpolate-env-vars: false
[2023-07-17 23:01:18] [config] keep-best: false
[2023-07-17 23:01:18] [config] label-smoothing: 0
[2023-07-17 23:01:18] [config] layer-normalization: false
[2023-07-17 23:01:18] [config] learn-rate: 0.0001
[2023-07-17 23:01:18] [config] lemma-dependency: ""
[2023-07-17 23:01:18] [config] lemma-dim-emb: 0
[2023-07-17 23:01:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:18] [config] log-level: info
[2023-07-17 23:01:18] [config] log-time-zone: ""
[2023-07-17 23:01:18] [config] logical-epoch:
[2023-07-17 23:01:18] [config]   - 1e
[2023-07-17 23:01:18] [config]   - 0
[2023-07-17 23:01:18] [config] lr-decay: 0
[2023-07-17 23:01:18] [config] lr-decay-freq: 50000
[2023-07-17 23:01:18] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:18] [config]   - 0
[2023-07-17 23:01:18] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:18] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:18] [config] lr-decay-start:
[2023-07-17 23:01:18] [config]   - 10
[2023-07-17 23:01:18] [config]   - 1
[2023-07-17 23:01:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:18] [config] lr-report: false
[2023-07-17 23:01:18] [config] lr-warmup: 0
[2023-07-17 23:01:18] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:18] [config] lr-warmup-cycle: false
[2023-07-17 23:01:18] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:18] [config] max-length: 150
[2023-07-17 23:01:18] [config] max-length-crop: true
[2023-07-17 23:01:18] [config] max-length-factor: 3
[2023-07-17 23:01:18] [config] maxi-batch: 100
[2023-07-17 23:01:18] [config] maxi-batch-sort: trg
[2023-07-17 23:01:18] [config] mini-batch: 64
[2023-07-17 23:01:18] [config] mini-batch-fit: true
[2023-07-17 23:01:18] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:18] [config] mini-batch-round-up: true
[2023-07-17 23:01:18] [config] mini-batch-track-lr: false
[2023-07-17 23:01:18] [config] mini-batch-warmup: 0
[2023-07-17 23:01:18] [config] mini-batch-words: 0
[2023-07-17 23:01:18] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:18] [config] multi-loss-type: sum
[2023-07-17 23:01:18] [config] n-best: false
[2023-07-17 23:01:18] [config] no-nccl: false
[2023-07-17 23:01:18] [config] no-reload: false
[2023-07-17 23:01:18] [config] no-restore-corpus: false
[2023-07-17 23:01:18] [config] normalize: 0
[2023-07-17 23:01:18] [config] normalize-gradient: false
[2023-07-17 23:01:18] [config] num-devices: 0
[2023-07-17 23:01:18] [config] optimizer: adam
[2023-07-17 23:01:18] [config] optimizer-delay: 1
[2023-07-17 23:01:18] [config] optimizer-params:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] output-omit-bias: false
[2023-07-17 23:01:18] [config] overwrite: true
[2023-07-17 23:01:18] [config] precision:
[2023-07-17 23:01:18] [config]   - float16
[2023-07-17 23:01:18] [config]   - float32
[2023-07-17 23:01:18] [config] pretrained-model: ""
[2023-07-17 23:01:18] [config] quantize-biases: false
[2023-07-17 23:01:18] [config] quantize-bits: 0
[2023-07-17 23:01:18] [config] quantize-log-based: false
[2023-07-17 23:01:18] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:18] [config] quiet: false
[2023-07-17 23:01:18] [config] quiet-translation: true
[2023-07-17 23:01:18] [config] relative-paths: false
[2023-07-17 23:01:18] [config] right-left: false
[2023-07-17 23:01:18] [config] save-freq: 10000u
[2023-07-17 23:01:18] [config] seed: 1234
[2023-07-17 23:01:18] [config] sentencepiece-alphas:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:18] [config] sentencepiece-options: ""
[2023-07-17 23:01:18] [config] sharding: global
[2023-07-17 23:01:18] [config] shuffle: data
[2023-07-17 23:01:18] [config] shuffle-in-ram: false
[2023-07-17 23:01:18] [config] sigterm: save-and-exit
[2023-07-17 23:01:18] [config] skip: false
[2023-07-17 23:01:18] [config] sqlite: ""
[2023-07-17 23:01:18] [config] sqlite-drop: false
[2023-07-17 23:01:18] [config] sync-freq: 200u
[2023-07-17 23:01:18] [config] sync-sgd: false
[2023-07-17 23:01:18] [config] tempdir: /tmp
[2023-07-17 23:01:18] [config] tied-embeddings: false
[2023-07-17 23:01:18] [config] tied-embeddings-all: true
[2023-07-17 23:01:18] [config] tied-embeddings-src: false
[2023-07-17 23:01:18] [config] train-embedder-rank:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] train-sets:
[2023-07-17 23:01:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:18] [config] transformer-aan-activation: swish
[2023-07-17 23:01:18] [config] transformer-aan-depth: 2
[2023-07-17 23:01:18] [config] transformer-aan-nogate: false
[2023-07-17 23:01:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:18] [config] transformer-depth-scaling: false
[2023-07-17 23:01:18] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:18] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:18] [config] transformer-dropout: 0
[2023-07-17 23:01:18] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:18] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:18] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:18] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:18] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:18] [config] transformer-heads: 8
[2023-07-17 23:01:18] [config] transformer-no-projection: false
[2023-07-17 23:01:18] [config] transformer-pool: false
[2023-07-17 23:01:18] [config] transformer-postprocess: dan
[2023-07-17 23:01:18] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:18] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:18] [config] transformer-preprocess: ""
[2023-07-17 23:01:18] [config] transformer-tied-layers:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:18] [config] tsv: false
[2023-07-17 23:01:18] [config] tsv-fields: 0
[2023-07-17 23:01:18] [config] type: amun
[2023-07-17 23:01:18] [config] ulr: false
[2023-07-17 23:01:18] [config] ulr-dim-emb: 0
[2023-07-17 23:01:18] [config] ulr-dropout: 0
[2023-07-17 23:01:18] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:18] [config] ulr-query-vectors: ""
[2023-07-17 23:01:18] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:18] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:18] [config] unlikelihood-loss: false
[2023-07-17 23:01:18] [config] valid-freq: 50000000
[2023-07-17 23:01:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:18] [config] valid-max-length: 1000
[2023-07-17 23:01:18] [config] valid-metrics:
[2023-07-17 23:01:18] [config]   - cross-entropy
[2023-07-17 23:01:18] [config]   - translation
[2023-07-17 23:01:18] [config] valid-mini-batch: 32
[2023-07-17 23:01:18] [config] valid-reset-stalled: false
[2023-07-17 23:01:18] [config] valid-script-args:
[2023-07-17 23:01:18] [config]   []
[2023-07-17 23:01:18] [config] valid-script-path: ""
[2023-07-17 23:01:18] [config] valid-sets:
[2023-07-17 23:01:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:18] [config] vocabs:
[2023-07-17 23:01:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:18] [config] word-penalty: 0
[2023-07-17 23:01:18] [config] word-scores: false
[2023-07-17 23:01:18] [config] workspace: 5500
[2023-07-17 23:01:18] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:18] [training] Using single-device training
[2023-07-17 23:01:18] Synced seed 1234
[2023-07-17 23:01:18] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:18] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:18] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x558f81fa9177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x558f81fa9699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x558f81fac92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x558f81f9b7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x558f81f9c0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x558f81fe982e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x558f81ffc79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x558f81ec6b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x558f81de72c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x558f81d9eb9c]    main                                               + 0x3c
[0x7f7fdf6ac0b3]    __libc_start_main                                  + 0xf3
[0x558f81de5cbe]    _start                                             + 0x2e

[2023-07-17 23:01:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:20] [marian] Running on node22.datos.cluster.uy as process 3760 with command line:
[2023-07-17 23:01:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:20] [config] after: 0e
[2023-07-17 23:01:20] [config] after-batches: 0
[2023-07-17 23:01:20] [config] after-epochs: 150
[2023-07-17 23:01:20] [config] all-caps-every: 0
[2023-07-17 23:01:20] [config] allow-unk: false
[2023-07-17 23:01:20] [config] authors: false
[2023-07-17 23:01:20] [config] beam-size: 12
[2023-07-17 23:01:20] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:20] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:20] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:20] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:20] [config] build-info: ""
[2023-07-17 23:01:20] [config] check-gradient-nan: false
[2023-07-17 23:01:20] [config] check-nan: false
[2023-07-17 23:01:20] [config] cite: false
[2023-07-17 23:01:20] [config] clip-norm: 1
[2023-07-17 23:01:20] [config] cost-scaling:
[2023-07-17 23:01:20] [config]   - 256.f
[2023-07-17 23:01:20] [config]   - 1000
[2023-07-17 23:01:20] [config]   - 2.f
[2023-07-17 23:01:20] [config]   - 256.f
[2023-07-17 23:01:20] [config] cost-type: ce-sum
[2023-07-17 23:01:20] [config] cpu-threads: 0
[2023-07-17 23:01:20] [config] data-threads: 8
[2023-07-17 23:01:20] [config] data-weighting: ""
[2023-07-17 23:01:20] [config] data-weighting-type: sentence
[2023-07-17 23:01:20] [config] dec-cell: gru
[2023-07-17 23:01:20] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:20] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:20] [config] dec-depth: 1
[2023-07-17 23:01:20] [config] devices:
[2023-07-17 23:01:20] [config]   - 0
[2023-07-17 23:01:20] [config] dim-emb: 512
[2023-07-17 23:01:20] [config] dim-rnn: 1024
[2023-07-17 23:01:20] [config] dim-vocabs:
[2023-07-17 23:01:20] [config]   - 16384
[2023-07-17 23:01:20] [config]   - 16384
[2023-07-17 23:01:20] [config] disp-first: 0
[2023-07-17 23:01:20] [config] disp-freq: 1000u
[2023-07-17 23:01:20] [config] disp-label-counts: true
[2023-07-17 23:01:20] [config] dropout-rnn: 0
[2023-07-17 23:01:20] [config] dropout-src: 0
[2023-07-17 23:01:20] [config] dropout-trg: 0
[2023-07-17 23:01:20] [config] dump-config: ""
[2023-07-17 23:01:20] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] early-stopping: 5
[2023-07-17 23:01:20] [config] early-stopping-on: first
[2023-07-17 23:01:20] [config] embedding-fix-src: false
[2023-07-17 23:01:20] [config] embedding-fix-trg: false
[2023-07-17 23:01:20] [config] embedding-normalization: false
[2023-07-17 23:01:20] [config] embedding-vectors:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] enc-cell: gru
[2023-07-17 23:01:20] [config] enc-cell-depth: 1
[2023-07-17 23:01:20] [config] enc-depth: 1
[2023-07-17 23:01:20] [config] enc-type: bidirectional
[2023-07-17 23:01:20] [config] english-title-case-every: 0
[2023-07-17 23:01:20] [config] exponential-smoothing: 0
[2023-07-17 23:01:20] [config] factor-weight: 1
[2023-07-17 23:01:20] [config] factors-combine: sum
[2023-07-17 23:01:20] [config] factors-dim-emb: 0
[2023-07-17 23:01:20] [config] gradient-checkpointing: false
[2023-07-17 23:01:20] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:20] [config] guided-alignment: none
[2023-07-17 23:01:20] [config] guided-alignment-cost: mse
[2023-07-17 23:01:20] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:20] [config] ignore-model-config: false
[2023-07-17 23:01:20] [config] input-types:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] interpolate-env-vars: false
[2023-07-17 23:01:20] [config] keep-best: false
[2023-07-17 23:01:20] [config] label-smoothing: 0
[2023-07-17 23:01:20] [config] layer-normalization: false
[2023-07-17 23:01:20] [config] learn-rate: 0.0001
[2023-07-17 23:01:20] [config] lemma-dependency: ""
[2023-07-17 23:01:20] [config] lemma-dim-emb: 0
[2023-07-17 23:01:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:20] [config] log-level: info
[2023-07-17 23:01:20] [config] log-time-zone: ""
[2023-07-17 23:01:20] [config] logical-epoch:
[2023-07-17 23:01:20] [config]   - 1e
[2023-07-17 23:01:20] [config]   - 0
[2023-07-17 23:01:20] [config] lr-decay: 0
[2023-07-17 23:01:20] [config] lr-decay-freq: 50000
[2023-07-17 23:01:20] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:20] [config]   - 0
[2023-07-17 23:01:20] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:20] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:20] [config] lr-decay-start:
[2023-07-17 23:01:20] [config]   - 10
[2023-07-17 23:01:20] [config]   - 1
[2023-07-17 23:01:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:20] [config] lr-report: false
[2023-07-17 23:01:20] [config] lr-warmup: 0
[2023-07-17 23:01:20] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:20] [config] lr-warmup-cycle: false
[2023-07-17 23:01:20] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:20] [config] max-length: 150
[2023-07-17 23:01:20] [config] max-length-crop: true
[2023-07-17 23:01:20] [config] max-length-factor: 3
[2023-07-17 23:01:20] [config] maxi-batch: 100
[2023-07-17 23:01:20] [config] maxi-batch-sort: trg
[2023-07-17 23:01:20] [config] mini-batch: 64
[2023-07-17 23:01:20] [config] mini-batch-fit: true
[2023-07-17 23:01:20] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:20] [config] mini-batch-round-up: true
[2023-07-17 23:01:20] [config] mini-batch-track-lr: false
[2023-07-17 23:01:20] [config] mini-batch-warmup: 0
[2023-07-17 23:01:20] [config] mini-batch-words: 0
[2023-07-17 23:01:20] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:20] [config] multi-loss-type: sum
[2023-07-17 23:01:20] [config] n-best: false
[2023-07-17 23:01:20] [config] no-nccl: false
[2023-07-17 23:01:20] [config] no-reload: false
[2023-07-17 23:01:20] [config] no-restore-corpus: false
[2023-07-17 23:01:20] [config] normalize: 0
[2023-07-17 23:01:20] [config] normalize-gradient: false
[2023-07-17 23:01:20] [config] num-devices: 0
[2023-07-17 23:01:20] [config] optimizer: adam
[2023-07-17 23:01:20] [config] optimizer-delay: 1
[2023-07-17 23:01:20] [config] optimizer-params:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] output-omit-bias: false
[2023-07-17 23:01:20] [config] overwrite: true
[2023-07-17 23:01:20] [config] precision:
[2023-07-17 23:01:20] [config]   - float16
[2023-07-17 23:01:20] [config]   - float32
[2023-07-17 23:01:20] [config] pretrained-model: ""
[2023-07-17 23:01:20] [config] quantize-biases: false
[2023-07-17 23:01:20] [config] quantize-bits: 0
[2023-07-17 23:01:20] [config] quantize-log-based: false
[2023-07-17 23:01:20] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:20] [config] quiet: false
[2023-07-17 23:01:20] [config] quiet-translation: true
[2023-07-17 23:01:20] [config] relative-paths: false
[2023-07-17 23:01:20] [config] right-left: false
[2023-07-17 23:01:20] [config] save-freq: 10000u
[2023-07-17 23:01:20] [config] seed: 1234
[2023-07-17 23:01:20] [config] sentencepiece-alphas:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:20] [config] sentencepiece-options: ""
[2023-07-17 23:01:20] [config] sharding: global
[2023-07-17 23:01:20] [config] shuffle: data
[2023-07-17 23:01:20] [config] shuffle-in-ram: false
[2023-07-17 23:01:20] [config] sigterm: save-and-exit
[2023-07-17 23:01:20] [config] skip: false
[2023-07-17 23:01:20] [config] sqlite: ""
[2023-07-17 23:01:20] [config] sqlite-drop: false
[2023-07-17 23:01:20] [config] sync-freq: 200u
[2023-07-17 23:01:20] [config] sync-sgd: false
[2023-07-17 23:01:20] [config] tempdir: /tmp
[2023-07-17 23:01:20] [config] tied-embeddings: false
[2023-07-17 23:01:20] [config] tied-embeddings-all: true
[2023-07-17 23:01:20] [config] tied-embeddings-src: false
[2023-07-17 23:01:20] [config] train-embedder-rank:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] train-sets:
[2023-07-17 23:01:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:20] [config] transformer-aan-activation: swish
[2023-07-17 23:01:20] [config] transformer-aan-depth: 2
[2023-07-17 23:01:20] [config] transformer-aan-nogate: false
[2023-07-17 23:01:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:20] [config] transformer-depth-scaling: false
[2023-07-17 23:01:20] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:20] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:20] [config] transformer-dropout: 0
[2023-07-17 23:01:20] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:20] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:20] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:20] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:20] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:20] [config] transformer-heads: 8
[2023-07-17 23:01:20] [config] transformer-no-projection: false
[2023-07-17 23:01:20] [config] transformer-pool: false
[2023-07-17 23:01:20] [config] transformer-postprocess: dan
[2023-07-17 23:01:20] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:20] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:20] [config] transformer-preprocess: ""
[2023-07-17 23:01:20] [config] transformer-tied-layers:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:20] [config] tsv: false
[2023-07-17 23:01:20] [config] tsv-fields: 0
[2023-07-17 23:01:20] [config] type: amun
[2023-07-17 23:01:20] [config] ulr: false
[2023-07-17 23:01:20] [config] ulr-dim-emb: 0
[2023-07-17 23:01:20] [config] ulr-dropout: 0
[2023-07-17 23:01:20] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:20] [config] ulr-query-vectors: ""
[2023-07-17 23:01:20] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:20] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:20] [config] unlikelihood-loss: false
[2023-07-17 23:01:20] [config] valid-freq: 50000000
[2023-07-17 23:01:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:20] [config] valid-max-length: 1000
[2023-07-17 23:01:20] [config] valid-metrics:
[2023-07-17 23:01:20] [config]   - cross-entropy
[2023-07-17 23:01:20] [config]   - translation
[2023-07-17 23:01:20] [config] valid-mini-batch: 32
[2023-07-17 23:01:20] [config] valid-reset-stalled: false
[2023-07-17 23:01:20] [config] valid-script-args:
[2023-07-17 23:01:20] [config]   []
[2023-07-17 23:01:20] [config] valid-script-path: ""
[2023-07-17 23:01:20] [config] valid-sets:
[2023-07-17 23:01:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:20] [config] vocabs:
[2023-07-17 23:01:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:20] [config] word-penalty: 0
[2023-07-17 23:01:20] [config] word-scores: false
[2023-07-17 23:01:20] [config] workspace: 5500
[2023-07-17 23:01:20] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:20] [training] Using single-device training
[2023-07-17 23:01:21] Synced seed 1234
[2023-07-17 23:01:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:21] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:21] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55c4517fe177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55c4517fe699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55c45180192f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55c4517f07da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55c4517f10f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55c45183e82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55c45185179d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55c45171bb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55c45163c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55c4515f3b9c]    main                                               + 0x3c
[0x7f14936b50b3]    __libc_start_main                                  + 0xf3
[0x55c45163acbe]    _start                                             + 0x2e

[2023-07-17 23:01:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:23] [marian] Running on node22.datos.cluster.uy as process 3766 with command line:
[2023-07-17 23:01:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:23] [config] after: 0e
[2023-07-17 23:01:23] [config] after-batches: 0
[2023-07-17 23:01:23] [config] after-epochs: 160
[2023-07-17 23:01:23] [config] all-caps-every: 0
[2023-07-17 23:01:23] [config] allow-unk: false
[2023-07-17 23:01:23] [config] authors: false
[2023-07-17 23:01:23] [config] beam-size: 12
[2023-07-17 23:01:23] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:23] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:23] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:23] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:23] [config] build-info: ""
[2023-07-17 23:01:23] [config] check-gradient-nan: false
[2023-07-17 23:01:23] [config] check-nan: false
[2023-07-17 23:01:23] [config] cite: false
[2023-07-17 23:01:23] [config] clip-norm: 1
[2023-07-17 23:01:23] [config] cost-scaling:
[2023-07-17 23:01:23] [config]   - 256.f
[2023-07-17 23:01:23] [config]   - 1000
[2023-07-17 23:01:23] [config]   - 2.f
[2023-07-17 23:01:23] [config]   - 256.f
[2023-07-17 23:01:23] [config] cost-type: ce-sum
[2023-07-17 23:01:23] [config] cpu-threads: 0
[2023-07-17 23:01:23] [config] data-threads: 8
[2023-07-17 23:01:23] [config] data-weighting: ""
[2023-07-17 23:01:23] [config] data-weighting-type: sentence
[2023-07-17 23:01:23] [config] dec-cell: gru
[2023-07-17 23:01:23] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:23] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:23] [config] dec-depth: 1
[2023-07-17 23:01:23] [config] devices:
[2023-07-17 23:01:23] [config]   - 0
[2023-07-17 23:01:23] [config] dim-emb: 512
[2023-07-17 23:01:23] [config] dim-rnn: 1024
[2023-07-17 23:01:23] [config] dim-vocabs:
[2023-07-17 23:01:23] [config]   - 16384
[2023-07-17 23:01:23] [config]   - 16384
[2023-07-17 23:01:23] [config] disp-first: 0
[2023-07-17 23:01:23] [config] disp-freq: 1000u
[2023-07-17 23:01:23] [config] disp-label-counts: true
[2023-07-17 23:01:23] [config] dropout-rnn: 0
[2023-07-17 23:01:23] [config] dropout-src: 0
[2023-07-17 23:01:23] [config] dropout-trg: 0
[2023-07-17 23:01:23] [config] dump-config: ""
[2023-07-17 23:01:23] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] early-stopping: 5
[2023-07-17 23:01:23] [config] early-stopping-on: first
[2023-07-17 23:01:23] [config] embedding-fix-src: false
[2023-07-17 23:01:23] [config] embedding-fix-trg: false
[2023-07-17 23:01:23] [config] embedding-normalization: false
[2023-07-17 23:01:23] [config] embedding-vectors:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] enc-cell: gru
[2023-07-17 23:01:23] [config] enc-cell-depth: 1
[2023-07-17 23:01:23] [config] enc-depth: 1
[2023-07-17 23:01:23] [config] enc-type: bidirectional
[2023-07-17 23:01:23] [config] english-title-case-every: 0
[2023-07-17 23:01:23] [config] exponential-smoothing: 0
[2023-07-17 23:01:23] [config] factor-weight: 1
[2023-07-17 23:01:23] [config] factors-combine: sum
[2023-07-17 23:01:23] [config] factors-dim-emb: 0
[2023-07-17 23:01:23] [config] gradient-checkpointing: false
[2023-07-17 23:01:23] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:23] [config] guided-alignment: none
[2023-07-17 23:01:23] [config] guided-alignment-cost: mse
[2023-07-17 23:01:23] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:23] [config] ignore-model-config: false
[2023-07-17 23:01:23] [config] input-types:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] interpolate-env-vars: false
[2023-07-17 23:01:23] [config] keep-best: false
[2023-07-17 23:01:23] [config] label-smoothing: 0
[2023-07-17 23:01:23] [config] layer-normalization: false
[2023-07-17 23:01:23] [config] learn-rate: 0.0001
[2023-07-17 23:01:23] [config] lemma-dependency: ""
[2023-07-17 23:01:23] [config] lemma-dim-emb: 0
[2023-07-17 23:01:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:23] [config] log-level: info
[2023-07-17 23:01:23] [config] log-time-zone: ""
[2023-07-17 23:01:23] [config] logical-epoch:
[2023-07-17 23:01:23] [config]   - 1e
[2023-07-17 23:01:23] [config]   - 0
[2023-07-17 23:01:23] [config] lr-decay: 0
[2023-07-17 23:01:23] [config] lr-decay-freq: 50000
[2023-07-17 23:01:23] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:23] [config]   - 0
[2023-07-17 23:01:23] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:23] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:23] [config] lr-decay-start:
[2023-07-17 23:01:23] [config]   - 10
[2023-07-17 23:01:23] [config]   - 1
[2023-07-17 23:01:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:23] [config] lr-report: false
[2023-07-17 23:01:23] [config] lr-warmup: 0
[2023-07-17 23:01:23] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:23] [config] lr-warmup-cycle: false
[2023-07-17 23:01:23] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:23] [config] max-length: 150
[2023-07-17 23:01:23] [config] max-length-crop: true
[2023-07-17 23:01:23] [config] max-length-factor: 3
[2023-07-17 23:01:23] [config] maxi-batch: 100
[2023-07-17 23:01:23] [config] maxi-batch-sort: trg
[2023-07-17 23:01:23] [config] mini-batch: 64
[2023-07-17 23:01:23] [config] mini-batch-fit: true
[2023-07-17 23:01:23] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:23] [config] mini-batch-round-up: true
[2023-07-17 23:01:23] [config] mini-batch-track-lr: false
[2023-07-17 23:01:23] [config] mini-batch-warmup: 0
[2023-07-17 23:01:23] [config] mini-batch-words: 0
[2023-07-17 23:01:23] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:23] [config] multi-loss-type: sum
[2023-07-17 23:01:23] [config] n-best: false
[2023-07-17 23:01:23] [config] no-nccl: false
[2023-07-17 23:01:23] [config] no-reload: false
[2023-07-17 23:01:23] [config] no-restore-corpus: false
[2023-07-17 23:01:23] [config] normalize: 0
[2023-07-17 23:01:23] [config] normalize-gradient: false
[2023-07-17 23:01:23] [config] num-devices: 0
[2023-07-17 23:01:23] [config] optimizer: adam
[2023-07-17 23:01:23] [config] optimizer-delay: 1
[2023-07-17 23:01:23] [config] optimizer-params:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] output-omit-bias: false
[2023-07-17 23:01:23] [config] overwrite: true
[2023-07-17 23:01:23] [config] precision:
[2023-07-17 23:01:23] [config]   - float16
[2023-07-17 23:01:23] [config]   - float32
[2023-07-17 23:01:23] [config] pretrained-model: ""
[2023-07-17 23:01:23] [config] quantize-biases: false
[2023-07-17 23:01:23] [config] quantize-bits: 0
[2023-07-17 23:01:23] [config] quantize-log-based: false
[2023-07-17 23:01:23] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:23] [config] quiet: false
[2023-07-17 23:01:23] [config] quiet-translation: true
[2023-07-17 23:01:23] [config] relative-paths: false
[2023-07-17 23:01:23] [config] right-left: false
[2023-07-17 23:01:23] [config] save-freq: 10000u
[2023-07-17 23:01:23] [config] seed: 1234
[2023-07-17 23:01:23] [config] sentencepiece-alphas:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:23] [config] sentencepiece-options: ""
[2023-07-17 23:01:23] [config] sharding: global
[2023-07-17 23:01:23] [config] shuffle: data
[2023-07-17 23:01:23] [config] shuffle-in-ram: false
[2023-07-17 23:01:23] [config] sigterm: save-and-exit
[2023-07-17 23:01:23] [config] skip: false
[2023-07-17 23:01:23] [config] sqlite: ""
[2023-07-17 23:01:23] [config] sqlite-drop: false
[2023-07-17 23:01:23] [config] sync-freq: 200u
[2023-07-17 23:01:23] [config] sync-sgd: false
[2023-07-17 23:01:23] [config] tempdir: /tmp
[2023-07-17 23:01:23] [config] tied-embeddings: false
[2023-07-17 23:01:23] [config] tied-embeddings-all: true
[2023-07-17 23:01:23] [config] tied-embeddings-src: false
[2023-07-17 23:01:23] [config] train-embedder-rank:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] train-sets:
[2023-07-17 23:01:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:23] [config] transformer-aan-activation: swish
[2023-07-17 23:01:23] [config] transformer-aan-depth: 2
[2023-07-17 23:01:23] [config] transformer-aan-nogate: false
[2023-07-17 23:01:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:23] [config] transformer-depth-scaling: false
[2023-07-17 23:01:23] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:23] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:23] [config] transformer-dropout: 0
[2023-07-17 23:01:23] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:23] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:23] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:23] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:23] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:23] [config] transformer-heads: 8
[2023-07-17 23:01:23] [config] transformer-no-projection: false
[2023-07-17 23:01:23] [config] transformer-pool: false
[2023-07-17 23:01:23] [config] transformer-postprocess: dan
[2023-07-17 23:01:23] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:23] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:23] [config] transformer-preprocess: ""
[2023-07-17 23:01:23] [config] transformer-tied-layers:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:23] [config] tsv: false
[2023-07-17 23:01:23] [config] tsv-fields: 0
[2023-07-17 23:01:23] [config] type: amun
[2023-07-17 23:01:23] [config] ulr: false
[2023-07-17 23:01:23] [config] ulr-dim-emb: 0
[2023-07-17 23:01:23] [config] ulr-dropout: 0
[2023-07-17 23:01:23] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:23] [config] ulr-query-vectors: ""
[2023-07-17 23:01:23] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:23] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:23] [config] unlikelihood-loss: false
[2023-07-17 23:01:23] [config] valid-freq: 50000000
[2023-07-17 23:01:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:23] [config] valid-max-length: 1000
[2023-07-17 23:01:23] [config] valid-metrics:
[2023-07-17 23:01:23] [config]   - cross-entropy
[2023-07-17 23:01:23] [config]   - translation
[2023-07-17 23:01:23] [config] valid-mini-batch: 32
[2023-07-17 23:01:23] [config] valid-reset-stalled: false
[2023-07-17 23:01:23] [config] valid-script-args:
[2023-07-17 23:01:23] [config]   []
[2023-07-17 23:01:23] [config] valid-script-path: ""
[2023-07-17 23:01:23] [config] valid-sets:
[2023-07-17 23:01:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:23] [config] vocabs:
[2023-07-17 23:01:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:23] [config] word-penalty: 0
[2023-07-17 23:01:23] [config] word-scores: false
[2023-07-17 23:01:23] [config] workspace: 5500
[2023-07-17 23:01:23] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:23] [training] Using single-device training
[2023-07-17 23:01:23] Synced seed 1234
[2023-07-17 23:01:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:23] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:23] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x562d70e25177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x562d70e25699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x562d70e2892f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x562d70e177da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x562d70e180f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x562d70e6582e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x562d70e7879d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x562d70d42b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x562d70c632c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x562d70c1ab9c]    main                                               + 0x3c
[0x7fa56a9e00b3]    __libc_start_main                                  + 0xf3
[0x562d70c61cbe]    _start                                             + 0x2e

[2023-07-17 23:01:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:26] [marian] Running on node22.datos.cluster.uy as process 3771 with command line:
[2023-07-17 23:01:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:26] [config] after: 0e
[2023-07-17 23:01:26] [config] after-batches: 0
[2023-07-17 23:01:26] [config] after-epochs: 170
[2023-07-17 23:01:26] [config] all-caps-every: 0
[2023-07-17 23:01:26] [config] allow-unk: false
[2023-07-17 23:01:26] [config] authors: false
[2023-07-17 23:01:26] [config] beam-size: 12
[2023-07-17 23:01:26] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:26] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:26] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:26] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:26] [config] build-info: ""
[2023-07-17 23:01:26] [config] check-gradient-nan: false
[2023-07-17 23:01:26] [config] check-nan: false
[2023-07-17 23:01:26] [config] cite: false
[2023-07-17 23:01:26] [config] clip-norm: 1
[2023-07-17 23:01:26] [config] cost-scaling:
[2023-07-17 23:01:26] [config]   - 256.f
[2023-07-17 23:01:26] [config]   - 1000
[2023-07-17 23:01:26] [config]   - 2.f
[2023-07-17 23:01:26] [config]   - 256.f
[2023-07-17 23:01:26] [config] cost-type: ce-sum
[2023-07-17 23:01:26] [config] cpu-threads: 0
[2023-07-17 23:01:26] [config] data-threads: 8
[2023-07-17 23:01:26] [config] data-weighting: ""
[2023-07-17 23:01:26] [config] data-weighting-type: sentence
[2023-07-17 23:01:26] [config] dec-cell: gru
[2023-07-17 23:01:26] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:26] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:26] [config] dec-depth: 1
[2023-07-17 23:01:26] [config] devices:
[2023-07-17 23:01:26] [config]   - 0
[2023-07-17 23:01:26] [config] dim-emb: 512
[2023-07-17 23:01:26] [config] dim-rnn: 1024
[2023-07-17 23:01:26] [config] dim-vocabs:
[2023-07-17 23:01:26] [config]   - 16384
[2023-07-17 23:01:26] [config]   - 16384
[2023-07-17 23:01:26] [config] disp-first: 0
[2023-07-17 23:01:26] [config] disp-freq: 1000u
[2023-07-17 23:01:26] [config] disp-label-counts: true
[2023-07-17 23:01:26] [config] dropout-rnn: 0
[2023-07-17 23:01:26] [config] dropout-src: 0
[2023-07-17 23:01:26] [config] dropout-trg: 0
[2023-07-17 23:01:26] [config] dump-config: ""
[2023-07-17 23:01:26] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] early-stopping: 5
[2023-07-17 23:01:26] [config] early-stopping-on: first
[2023-07-17 23:01:26] [config] embedding-fix-src: false
[2023-07-17 23:01:26] [config] embedding-fix-trg: false
[2023-07-17 23:01:26] [config] embedding-normalization: false
[2023-07-17 23:01:26] [config] embedding-vectors:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] enc-cell: gru
[2023-07-17 23:01:26] [config] enc-cell-depth: 1
[2023-07-17 23:01:26] [config] enc-depth: 1
[2023-07-17 23:01:26] [config] enc-type: bidirectional
[2023-07-17 23:01:26] [config] english-title-case-every: 0
[2023-07-17 23:01:26] [config] exponential-smoothing: 0
[2023-07-17 23:01:26] [config] factor-weight: 1
[2023-07-17 23:01:26] [config] factors-combine: sum
[2023-07-17 23:01:26] [config] factors-dim-emb: 0
[2023-07-17 23:01:26] [config] gradient-checkpointing: false
[2023-07-17 23:01:26] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:26] [config] guided-alignment: none
[2023-07-17 23:01:26] [config] guided-alignment-cost: mse
[2023-07-17 23:01:26] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:26] [config] ignore-model-config: false
[2023-07-17 23:01:26] [config] input-types:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] interpolate-env-vars: false
[2023-07-17 23:01:26] [config] keep-best: false
[2023-07-17 23:01:26] [config] label-smoothing: 0
[2023-07-17 23:01:26] [config] layer-normalization: false
[2023-07-17 23:01:26] [config] learn-rate: 0.0001
[2023-07-17 23:01:26] [config] lemma-dependency: ""
[2023-07-17 23:01:26] [config] lemma-dim-emb: 0
[2023-07-17 23:01:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:26] [config] log-level: info
[2023-07-17 23:01:26] [config] log-time-zone: ""
[2023-07-17 23:01:26] [config] logical-epoch:
[2023-07-17 23:01:26] [config]   - 1e
[2023-07-17 23:01:26] [config]   - 0
[2023-07-17 23:01:26] [config] lr-decay: 0
[2023-07-17 23:01:26] [config] lr-decay-freq: 50000
[2023-07-17 23:01:26] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:26] [config]   - 0
[2023-07-17 23:01:26] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:26] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:26] [config] lr-decay-start:
[2023-07-17 23:01:26] [config]   - 10
[2023-07-17 23:01:26] [config]   - 1
[2023-07-17 23:01:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:26] [config] lr-report: false
[2023-07-17 23:01:26] [config] lr-warmup: 0
[2023-07-17 23:01:26] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:26] [config] lr-warmup-cycle: false
[2023-07-17 23:01:26] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:26] [config] max-length: 150
[2023-07-17 23:01:26] [config] max-length-crop: true
[2023-07-17 23:01:26] [config] max-length-factor: 3
[2023-07-17 23:01:26] [config] maxi-batch: 100
[2023-07-17 23:01:26] [config] maxi-batch-sort: trg
[2023-07-17 23:01:26] [config] mini-batch: 64
[2023-07-17 23:01:26] [config] mini-batch-fit: true
[2023-07-17 23:01:26] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:26] [config] mini-batch-round-up: true
[2023-07-17 23:01:26] [config] mini-batch-track-lr: false
[2023-07-17 23:01:26] [config] mini-batch-warmup: 0
[2023-07-17 23:01:26] [config] mini-batch-words: 0
[2023-07-17 23:01:26] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:26] [config] multi-loss-type: sum
[2023-07-17 23:01:26] [config] n-best: false
[2023-07-17 23:01:26] [config] no-nccl: false
[2023-07-17 23:01:26] [config] no-reload: false
[2023-07-17 23:01:26] [config] no-restore-corpus: false
[2023-07-17 23:01:26] [config] normalize: 0
[2023-07-17 23:01:26] [config] normalize-gradient: false
[2023-07-17 23:01:26] [config] num-devices: 0
[2023-07-17 23:01:26] [config] optimizer: adam
[2023-07-17 23:01:26] [config] optimizer-delay: 1
[2023-07-17 23:01:26] [config] optimizer-params:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] output-omit-bias: false
[2023-07-17 23:01:26] [config] overwrite: true
[2023-07-17 23:01:26] [config] precision:
[2023-07-17 23:01:26] [config]   - float16
[2023-07-17 23:01:26] [config]   - float32
[2023-07-17 23:01:26] [config] pretrained-model: ""
[2023-07-17 23:01:26] [config] quantize-biases: false
[2023-07-17 23:01:26] [config] quantize-bits: 0
[2023-07-17 23:01:26] [config] quantize-log-based: false
[2023-07-17 23:01:26] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:26] [config] quiet: false
[2023-07-17 23:01:26] [config] quiet-translation: true
[2023-07-17 23:01:26] [config] relative-paths: false
[2023-07-17 23:01:26] [config] right-left: false
[2023-07-17 23:01:26] [config] save-freq: 10000u
[2023-07-17 23:01:26] [config] seed: 1234
[2023-07-17 23:01:26] [config] sentencepiece-alphas:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:26] [config] sentencepiece-options: ""
[2023-07-17 23:01:26] [config] sharding: global
[2023-07-17 23:01:26] [config] shuffle: data
[2023-07-17 23:01:26] [config] shuffle-in-ram: false
[2023-07-17 23:01:26] [config] sigterm: save-and-exit
[2023-07-17 23:01:26] [config] skip: false
[2023-07-17 23:01:26] [config] sqlite: ""
[2023-07-17 23:01:26] [config] sqlite-drop: false
[2023-07-17 23:01:26] [config] sync-freq: 200u
[2023-07-17 23:01:26] [config] sync-sgd: false
[2023-07-17 23:01:26] [config] tempdir: /tmp
[2023-07-17 23:01:26] [config] tied-embeddings: false
[2023-07-17 23:01:26] [config] tied-embeddings-all: true
[2023-07-17 23:01:26] [config] tied-embeddings-src: false
[2023-07-17 23:01:26] [config] train-embedder-rank:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] train-sets:
[2023-07-17 23:01:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:26] [config] transformer-aan-activation: swish
[2023-07-17 23:01:26] [config] transformer-aan-depth: 2
[2023-07-17 23:01:26] [config] transformer-aan-nogate: false
[2023-07-17 23:01:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:26] [config] transformer-depth-scaling: false
[2023-07-17 23:01:26] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:26] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:26] [config] transformer-dropout: 0
[2023-07-17 23:01:26] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:26] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:26] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:26] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:26] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:26] [config] transformer-heads: 8
[2023-07-17 23:01:26] [config] transformer-no-projection: false
[2023-07-17 23:01:26] [config] transformer-pool: false
[2023-07-17 23:01:26] [config] transformer-postprocess: dan
[2023-07-17 23:01:26] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:26] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:26] [config] transformer-preprocess: ""
[2023-07-17 23:01:26] [config] transformer-tied-layers:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:26] [config] tsv: false
[2023-07-17 23:01:26] [config] tsv-fields: 0
[2023-07-17 23:01:26] [config] type: amun
[2023-07-17 23:01:26] [config] ulr: false
[2023-07-17 23:01:26] [config] ulr-dim-emb: 0
[2023-07-17 23:01:26] [config] ulr-dropout: 0
[2023-07-17 23:01:26] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:26] [config] ulr-query-vectors: ""
[2023-07-17 23:01:26] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:26] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:26] [config] unlikelihood-loss: false
[2023-07-17 23:01:26] [config] valid-freq: 50000000
[2023-07-17 23:01:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:26] [config] valid-max-length: 1000
[2023-07-17 23:01:26] [config] valid-metrics:
[2023-07-17 23:01:26] [config]   - cross-entropy
[2023-07-17 23:01:26] [config]   - translation
[2023-07-17 23:01:26] [config] valid-mini-batch: 32
[2023-07-17 23:01:26] [config] valid-reset-stalled: false
[2023-07-17 23:01:26] [config] valid-script-args:
[2023-07-17 23:01:26] [config]   []
[2023-07-17 23:01:26] [config] valid-script-path: ""
[2023-07-17 23:01:26] [config] valid-sets:
[2023-07-17 23:01:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:26] [config] vocabs:
[2023-07-17 23:01:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:26] [config] word-penalty: 0
[2023-07-17 23:01:26] [config] word-scores: false
[2023-07-17 23:01:26] [config] workspace: 5500
[2023-07-17 23:01:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:26] [training] Using single-device training
[2023-07-17 23:01:26] Synced seed 1234
[2023-07-17 23:01:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:26] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:26] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55699c643177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55699c643699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55699c64692f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55699c6357da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55699c6360f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55699c68382e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55699c69679d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55699c560b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55699c4812c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55699c438b9c]    main                                               + 0x3c
[0x7f029478a0b3]    __libc_start_main                                  + 0xf3
[0x55699c47fcbe]    _start                                             + 0x2e

[2023-07-17 23:01:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:28] [marian] Running on node22.datos.cluster.uy as process 3776 with command line:
[2023-07-17 23:01:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:28] [config] after: 0e
[2023-07-17 23:01:28] [config] after-batches: 0
[2023-07-17 23:01:28] [config] after-epochs: 180
[2023-07-17 23:01:28] [config] all-caps-every: 0
[2023-07-17 23:01:28] [config] allow-unk: false
[2023-07-17 23:01:28] [config] authors: false
[2023-07-17 23:01:28] [config] beam-size: 12
[2023-07-17 23:01:28] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:28] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:28] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:28] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:28] [config] build-info: ""
[2023-07-17 23:01:28] [config] check-gradient-nan: false
[2023-07-17 23:01:28] [config] check-nan: false
[2023-07-17 23:01:28] [config] cite: false
[2023-07-17 23:01:28] [config] clip-norm: 1
[2023-07-17 23:01:28] [config] cost-scaling:
[2023-07-17 23:01:28] [config]   - 256.f
[2023-07-17 23:01:28] [config]   - 1000
[2023-07-17 23:01:28] [config]   - 2.f
[2023-07-17 23:01:28] [config]   - 256.f
[2023-07-17 23:01:28] [config] cost-type: ce-sum
[2023-07-17 23:01:28] [config] cpu-threads: 0
[2023-07-17 23:01:28] [config] data-threads: 8
[2023-07-17 23:01:28] [config] data-weighting: ""
[2023-07-17 23:01:28] [config] data-weighting-type: sentence
[2023-07-17 23:01:28] [config] dec-cell: gru
[2023-07-17 23:01:28] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:28] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:28] [config] dec-depth: 1
[2023-07-17 23:01:28] [config] devices:
[2023-07-17 23:01:28] [config]   - 0
[2023-07-17 23:01:28] [config] dim-emb: 512
[2023-07-17 23:01:28] [config] dim-rnn: 1024
[2023-07-17 23:01:28] [config] dim-vocabs:
[2023-07-17 23:01:28] [config]   - 16384
[2023-07-17 23:01:28] [config]   - 16384
[2023-07-17 23:01:28] [config] disp-first: 0
[2023-07-17 23:01:28] [config] disp-freq: 1000u
[2023-07-17 23:01:28] [config] disp-label-counts: true
[2023-07-17 23:01:28] [config] dropout-rnn: 0
[2023-07-17 23:01:28] [config] dropout-src: 0
[2023-07-17 23:01:28] [config] dropout-trg: 0
[2023-07-17 23:01:28] [config] dump-config: ""
[2023-07-17 23:01:28] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] early-stopping: 5
[2023-07-17 23:01:28] [config] early-stopping-on: first
[2023-07-17 23:01:28] [config] embedding-fix-src: false
[2023-07-17 23:01:28] [config] embedding-fix-trg: false
[2023-07-17 23:01:28] [config] embedding-normalization: false
[2023-07-17 23:01:28] [config] embedding-vectors:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] enc-cell: gru
[2023-07-17 23:01:28] [config] enc-cell-depth: 1
[2023-07-17 23:01:28] [config] enc-depth: 1
[2023-07-17 23:01:28] [config] enc-type: bidirectional
[2023-07-17 23:01:28] [config] english-title-case-every: 0
[2023-07-17 23:01:28] [config] exponential-smoothing: 0
[2023-07-17 23:01:28] [config] factor-weight: 1
[2023-07-17 23:01:28] [config] factors-combine: sum
[2023-07-17 23:01:28] [config] factors-dim-emb: 0
[2023-07-17 23:01:28] [config] gradient-checkpointing: false
[2023-07-17 23:01:28] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:28] [config] guided-alignment: none
[2023-07-17 23:01:28] [config] guided-alignment-cost: mse
[2023-07-17 23:01:28] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:28] [config] ignore-model-config: false
[2023-07-17 23:01:28] [config] input-types:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] interpolate-env-vars: false
[2023-07-17 23:01:28] [config] keep-best: false
[2023-07-17 23:01:28] [config] label-smoothing: 0
[2023-07-17 23:01:28] [config] layer-normalization: false
[2023-07-17 23:01:28] [config] learn-rate: 0.0001
[2023-07-17 23:01:28] [config] lemma-dependency: ""
[2023-07-17 23:01:28] [config] lemma-dim-emb: 0
[2023-07-17 23:01:28] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:28] [config] log-level: info
[2023-07-17 23:01:28] [config] log-time-zone: ""
[2023-07-17 23:01:28] [config] logical-epoch:
[2023-07-17 23:01:28] [config]   - 1e
[2023-07-17 23:01:28] [config]   - 0
[2023-07-17 23:01:28] [config] lr-decay: 0
[2023-07-17 23:01:28] [config] lr-decay-freq: 50000
[2023-07-17 23:01:28] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:28] [config]   - 0
[2023-07-17 23:01:28] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:28] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:28] [config] lr-decay-start:
[2023-07-17 23:01:28] [config]   - 10
[2023-07-17 23:01:28] [config]   - 1
[2023-07-17 23:01:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:28] [config] lr-report: false
[2023-07-17 23:01:28] [config] lr-warmup: 0
[2023-07-17 23:01:28] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:28] [config] lr-warmup-cycle: false
[2023-07-17 23:01:28] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:28] [config] max-length: 150
[2023-07-17 23:01:28] [config] max-length-crop: true
[2023-07-17 23:01:28] [config] max-length-factor: 3
[2023-07-17 23:01:28] [config] maxi-batch: 100
[2023-07-17 23:01:28] [config] maxi-batch-sort: trg
[2023-07-17 23:01:28] [config] mini-batch: 64
[2023-07-17 23:01:28] [config] mini-batch-fit: true
[2023-07-17 23:01:28] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:28] [config] mini-batch-round-up: true
[2023-07-17 23:01:28] [config] mini-batch-track-lr: false
[2023-07-17 23:01:28] [config] mini-batch-warmup: 0
[2023-07-17 23:01:28] [config] mini-batch-words: 0
[2023-07-17 23:01:28] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:28] [config] multi-loss-type: sum
[2023-07-17 23:01:28] [config] n-best: false
[2023-07-17 23:01:28] [config] no-nccl: false
[2023-07-17 23:01:28] [config] no-reload: false
[2023-07-17 23:01:28] [config] no-restore-corpus: false
[2023-07-17 23:01:28] [config] normalize: 0
[2023-07-17 23:01:28] [config] normalize-gradient: false
[2023-07-17 23:01:28] [config] num-devices: 0
[2023-07-17 23:01:28] [config] optimizer: adam
[2023-07-17 23:01:28] [config] optimizer-delay: 1
[2023-07-17 23:01:28] [config] optimizer-params:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] output-omit-bias: false
[2023-07-17 23:01:28] [config] overwrite: true
[2023-07-17 23:01:28] [config] precision:
[2023-07-17 23:01:28] [config]   - float16
[2023-07-17 23:01:28] [config]   - float32
[2023-07-17 23:01:28] [config] pretrained-model: ""
[2023-07-17 23:01:28] [config] quantize-biases: false
[2023-07-17 23:01:28] [config] quantize-bits: 0
[2023-07-17 23:01:28] [config] quantize-log-based: false
[2023-07-17 23:01:28] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:28] [config] quiet: false
[2023-07-17 23:01:28] [config] quiet-translation: true
[2023-07-17 23:01:28] [config] relative-paths: false
[2023-07-17 23:01:28] [config] right-left: false
[2023-07-17 23:01:28] [config] save-freq: 10000u
[2023-07-17 23:01:28] [config] seed: 1234
[2023-07-17 23:01:28] [config] sentencepiece-alphas:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:28] [config] sentencepiece-options: ""
[2023-07-17 23:01:28] [config] sharding: global
[2023-07-17 23:01:28] [config] shuffle: data
[2023-07-17 23:01:28] [config] shuffle-in-ram: false
[2023-07-17 23:01:28] [config] sigterm: save-and-exit
[2023-07-17 23:01:28] [config] skip: false
[2023-07-17 23:01:28] [config] sqlite: ""
[2023-07-17 23:01:28] [config] sqlite-drop: false
[2023-07-17 23:01:28] [config] sync-freq: 200u
[2023-07-17 23:01:28] [config] sync-sgd: false
[2023-07-17 23:01:28] [config] tempdir: /tmp
[2023-07-17 23:01:28] [config] tied-embeddings: false
[2023-07-17 23:01:28] [config] tied-embeddings-all: true
[2023-07-17 23:01:28] [config] tied-embeddings-src: false
[2023-07-17 23:01:28] [config] train-embedder-rank:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] train-sets:
[2023-07-17 23:01:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:28] [config] transformer-aan-activation: swish
[2023-07-17 23:01:28] [config] transformer-aan-depth: 2
[2023-07-17 23:01:28] [config] transformer-aan-nogate: false
[2023-07-17 23:01:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:28] [config] transformer-depth-scaling: false
[2023-07-17 23:01:28] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:28] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:28] [config] transformer-dropout: 0
[2023-07-17 23:01:28] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:28] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:28] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:28] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:28] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:28] [config] transformer-heads: 8
[2023-07-17 23:01:28] [config] transformer-no-projection: false
[2023-07-17 23:01:28] [config] transformer-pool: false
[2023-07-17 23:01:28] [config] transformer-postprocess: dan
[2023-07-17 23:01:28] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:28] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:28] [config] transformer-preprocess: ""
[2023-07-17 23:01:28] [config] transformer-tied-layers:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:28] [config] tsv: false
[2023-07-17 23:01:28] [config] tsv-fields: 0
[2023-07-17 23:01:28] [config] type: amun
[2023-07-17 23:01:28] [config] ulr: false
[2023-07-17 23:01:28] [config] ulr-dim-emb: 0
[2023-07-17 23:01:28] [config] ulr-dropout: 0
[2023-07-17 23:01:28] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:28] [config] ulr-query-vectors: ""
[2023-07-17 23:01:28] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:28] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:28] [config] unlikelihood-loss: false
[2023-07-17 23:01:28] [config] valid-freq: 50000000
[2023-07-17 23:01:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:28] [config] valid-max-length: 1000
[2023-07-17 23:01:28] [config] valid-metrics:
[2023-07-17 23:01:28] [config]   - cross-entropy
[2023-07-17 23:01:28] [config]   - translation
[2023-07-17 23:01:28] [config] valid-mini-batch: 32
[2023-07-17 23:01:28] [config] valid-reset-stalled: false
[2023-07-17 23:01:28] [config] valid-script-args:
[2023-07-17 23:01:28] [config]   []
[2023-07-17 23:01:28] [config] valid-script-path: ""
[2023-07-17 23:01:28] [config] valid-sets:
[2023-07-17 23:01:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:28] [config] vocabs:
[2023-07-17 23:01:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:28] [config] word-penalty: 0
[2023-07-17 23:01:28] [config] word-scores: false
[2023-07-17 23:01:28] [config] workspace: 5500
[2023-07-17 23:01:28] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:28] [training] Using single-device training
[2023-07-17 23:01:28] Synced seed 1234
[2023-07-17 23:01:28] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:28] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:28] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x5556d19fc177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x5556d19fc699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x5556d19ff92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5556d19ee7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5556d19ef0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x5556d1a3c82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x5556d1a4f79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x5556d1919b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5556d183a2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5556d17f1b9c]    main                                               + 0x3c
[0x7fd3fd2ec0b3]    __libc_start_main                                  + 0xf3
[0x5556d1838cbe]    _start                                             + 0x2e

[2023-07-17 23:01:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:31] [marian] Running on node22.datos.cluster.uy as process 3782 with command line:
[2023-07-17 23:01:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:31] [config] after: 0e
[2023-07-17 23:01:31] [config] after-batches: 0
[2023-07-17 23:01:31] [config] after-epochs: 190
[2023-07-17 23:01:31] [config] all-caps-every: 0
[2023-07-17 23:01:31] [config] allow-unk: false
[2023-07-17 23:01:31] [config] authors: false
[2023-07-17 23:01:31] [config] beam-size: 12
[2023-07-17 23:01:31] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:31] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:31] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:31] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:31] [config] build-info: ""
[2023-07-17 23:01:31] [config] check-gradient-nan: false
[2023-07-17 23:01:31] [config] check-nan: false
[2023-07-17 23:01:31] [config] cite: false
[2023-07-17 23:01:31] [config] clip-norm: 1
[2023-07-17 23:01:31] [config] cost-scaling:
[2023-07-17 23:01:31] [config]   - 256.f
[2023-07-17 23:01:31] [config]   - 1000
[2023-07-17 23:01:31] [config]   - 2.f
[2023-07-17 23:01:31] [config]   - 256.f
[2023-07-17 23:01:31] [config] cost-type: ce-sum
[2023-07-17 23:01:31] [config] cpu-threads: 0
[2023-07-17 23:01:31] [config] data-threads: 8
[2023-07-17 23:01:31] [config] data-weighting: ""
[2023-07-17 23:01:31] [config] data-weighting-type: sentence
[2023-07-17 23:01:31] [config] dec-cell: gru
[2023-07-17 23:01:31] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:31] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:31] [config] dec-depth: 1
[2023-07-17 23:01:31] [config] devices:
[2023-07-17 23:01:31] [config]   - 0
[2023-07-17 23:01:31] [config] dim-emb: 512
[2023-07-17 23:01:31] [config] dim-rnn: 1024
[2023-07-17 23:01:31] [config] dim-vocabs:
[2023-07-17 23:01:31] [config]   - 16384
[2023-07-17 23:01:31] [config]   - 16384
[2023-07-17 23:01:31] [config] disp-first: 0
[2023-07-17 23:01:31] [config] disp-freq: 1000u
[2023-07-17 23:01:31] [config] disp-label-counts: true
[2023-07-17 23:01:31] [config] dropout-rnn: 0
[2023-07-17 23:01:31] [config] dropout-src: 0
[2023-07-17 23:01:31] [config] dropout-trg: 0
[2023-07-17 23:01:31] [config] dump-config: ""
[2023-07-17 23:01:31] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] early-stopping: 5
[2023-07-17 23:01:31] [config] early-stopping-on: first
[2023-07-17 23:01:31] [config] embedding-fix-src: false
[2023-07-17 23:01:31] [config] embedding-fix-trg: false
[2023-07-17 23:01:31] [config] embedding-normalization: false
[2023-07-17 23:01:31] [config] embedding-vectors:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] enc-cell: gru
[2023-07-17 23:01:31] [config] enc-cell-depth: 1
[2023-07-17 23:01:31] [config] enc-depth: 1
[2023-07-17 23:01:31] [config] enc-type: bidirectional
[2023-07-17 23:01:31] [config] english-title-case-every: 0
[2023-07-17 23:01:31] [config] exponential-smoothing: 0
[2023-07-17 23:01:31] [config] factor-weight: 1
[2023-07-17 23:01:31] [config] factors-combine: sum
[2023-07-17 23:01:31] [config] factors-dim-emb: 0
[2023-07-17 23:01:31] [config] gradient-checkpointing: false
[2023-07-17 23:01:31] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:31] [config] guided-alignment: none
[2023-07-17 23:01:31] [config] guided-alignment-cost: mse
[2023-07-17 23:01:31] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:31] [config] ignore-model-config: false
[2023-07-17 23:01:31] [config] input-types:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] interpolate-env-vars: false
[2023-07-17 23:01:31] [config] keep-best: false
[2023-07-17 23:01:31] [config] label-smoothing: 0
[2023-07-17 23:01:31] [config] layer-normalization: false
[2023-07-17 23:01:31] [config] learn-rate: 0.0001
[2023-07-17 23:01:31] [config] lemma-dependency: ""
[2023-07-17 23:01:31] [config] lemma-dim-emb: 0
[2023-07-17 23:01:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:31] [config] log-level: info
[2023-07-17 23:01:31] [config] log-time-zone: ""
[2023-07-17 23:01:31] [config] logical-epoch:
[2023-07-17 23:01:31] [config]   - 1e
[2023-07-17 23:01:31] [config]   - 0
[2023-07-17 23:01:31] [config] lr-decay: 0
[2023-07-17 23:01:31] [config] lr-decay-freq: 50000
[2023-07-17 23:01:31] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:31] [config]   - 0
[2023-07-17 23:01:31] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:31] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:31] [config] lr-decay-start:
[2023-07-17 23:01:31] [config]   - 10
[2023-07-17 23:01:31] [config]   - 1
[2023-07-17 23:01:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:31] [config] lr-report: false
[2023-07-17 23:01:31] [config] lr-warmup: 0
[2023-07-17 23:01:31] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:31] [config] lr-warmup-cycle: false
[2023-07-17 23:01:31] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:31] [config] max-length: 150
[2023-07-17 23:01:31] [config] max-length-crop: true
[2023-07-17 23:01:31] [config] max-length-factor: 3
[2023-07-17 23:01:31] [config] maxi-batch: 100
[2023-07-17 23:01:31] [config] maxi-batch-sort: trg
[2023-07-17 23:01:31] [config] mini-batch: 64
[2023-07-17 23:01:31] [config] mini-batch-fit: true
[2023-07-17 23:01:31] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:31] [config] mini-batch-round-up: true
[2023-07-17 23:01:31] [config] mini-batch-track-lr: false
[2023-07-17 23:01:31] [config] mini-batch-warmup: 0
[2023-07-17 23:01:31] [config] mini-batch-words: 0
[2023-07-17 23:01:31] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:31] [config] multi-loss-type: sum
[2023-07-17 23:01:31] [config] n-best: false
[2023-07-17 23:01:31] [config] no-nccl: false
[2023-07-17 23:01:31] [config] no-reload: false
[2023-07-17 23:01:31] [config] no-restore-corpus: false
[2023-07-17 23:01:31] [config] normalize: 0
[2023-07-17 23:01:31] [config] normalize-gradient: false
[2023-07-17 23:01:31] [config] num-devices: 0
[2023-07-17 23:01:31] [config] optimizer: adam
[2023-07-17 23:01:31] [config] optimizer-delay: 1
[2023-07-17 23:01:31] [config] optimizer-params:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] output-omit-bias: false
[2023-07-17 23:01:31] [config] overwrite: true
[2023-07-17 23:01:31] [config] precision:
[2023-07-17 23:01:31] [config]   - float16
[2023-07-17 23:01:31] [config]   - float32
[2023-07-17 23:01:31] [config] pretrained-model: ""
[2023-07-17 23:01:31] [config] quantize-biases: false
[2023-07-17 23:01:31] [config] quantize-bits: 0
[2023-07-17 23:01:31] [config] quantize-log-based: false
[2023-07-17 23:01:31] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:31] [config] quiet: false
[2023-07-17 23:01:31] [config] quiet-translation: true
[2023-07-17 23:01:31] [config] relative-paths: false
[2023-07-17 23:01:31] [config] right-left: false
[2023-07-17 23:01:31] [config] save-freq: 10000u
[2023-07-17 23:01:31] [config] seed: 1234
[2023-07-17 23:01:31] [config] sentencepiece-alphas:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:31] [config] sentencepiece-options: ""
[2023-07-17 23:01:31] [config] sharding: global
[2023-07-17 23:01:31] [config] shuffle: data
[2023-07-17 23:01:31] [config] shuffle-in-ram: false
[2023-07-17 23:01:31] [config] sigterm: save-and-exit
[2023-07-17 23:01:31] [config] skip: false
[2023-07-17 23:01:31] [config] sqlite: ""
[2023-07-17 23:01:31] [config] sqlite-drop: false
[2023-07-17 23:01:31] [config] sync-freq: 200u
[2023-07-17 23:01:31] [config] sync-sgd: false
[2023-07-17 23:01:31] [config] tempdir: /tmp
[2023-07-17 23:01:31] [config] tied-embeddings: false
[2023-07-17 23:01:31] [config] tied-embeddings-all: true
[2023-07-17 23:01:31] [config] tied-embeddings-src: false
[2023-07-17 23:01:31] [config] train-embedder-rank:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] train-sets:
[2023-07-17 23:01:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:31] [config] transformer-aan-activation: swish
[2023-07-17 23:01:31] [config] transformer-aan-depth: 2
[2023-07-17 23:01:31] [config] transformer-aan-nogate: false
[2023-07-17 23:01:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:31] [config] transformer-depth-scaling: false
[2023-07-17 23:01:31] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:31] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:31] [config] transformer-dropout: 0
[2023-07-17 23:01:31] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:31] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:31] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:31] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:31] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:31] [config] transformer-heads: 8
[2023-07-17 23:01:31] [config] transformer-no-projection: false
[2023-07-17 23:01:31] [config] transformer-pool: false
[2023-07-17 23:01:31] [config] transformer-postprocess: dan
[2023-07-17 23:01:31] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:31] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:31] [config] transformer-preprocess: ""
[2023-07-17 23:01:31] [config] transformer-tied-layers:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:31] [config] tsv: false
[2023-07-17 23:01:31] [config] tsv-fields: 0
[2023-07-17 23:01:31] [config] type: amun
[2023-07-17 23:01:31] [config] ulr: false
[2023-07-17 23:01:31] [config] ulr-dim-emb: 0
[2023-07-17 23:01:31] [config] ulr-dropout: 0
[2023-07-17 23:01:31] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:31] [config] ulr-query-vectors: ""
[2023-07-17 23:01:31] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:31] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:31] [config] unlikelihood-loss: false
[2023-07-17 23:01:31] [config] valid-freq: 50000000
[2023-07-17 23:01:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:31] [config] valid-max-length: 1000
[2023-07-17 23:01:31] [config] valid-metrics:
[2023-07-17 23:01:31] [config]   - cross-entropy
[2023-07-17 23:01:31] [config]   - translation
[2023-07-17 23:01:31] [config] valid-mini-batch: 32
[2023-07-17 23:01:31] [config] valid-reset-stalled: false
[2023-07-17 23:01:31] [config] valid-script-args:
[2023-07-17 23:01:31] [config]   []
[2023-07-17 23:01:31] [config] valid-script-path: ""
[2023-07-17 23:01:31] [config] valid-sets:
[2023-07-17 23:01:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:31] [config] vocabs:
[2023-07-17 23:01:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:31] [config] word-penalty: 0
[2023-07-17 23:01:31] [config] word-scores: false
[2023-07-17 23:01:31] [config] workspace: 5500
[2023-07-17 23:01:31] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:31] [training] Using single-device training
[2023-07-17 23:01:31] Synced seed 1234
[2023-07-17 23:01:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:31] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:31] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55994f9db177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55994f9db699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55994f9de92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55994f9cd7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55994f9ce0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55994fa1b82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55994fa2e79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55994f8f8b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55994f8192c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55994f7d0b9c]    main                                               + 0x3c
[0x7f2bc59c50b3]    __libc_start_main                                  + 0xf3
[0x55994f817cbe]    _start                                             + 0x2e

[2023-07-17 23:01:33] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:33] [marian] Running on node22.datos.cluster.uy as process 3787 with command line:
[2023-07-17 23:01:33] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-17 23:01:33] [config] after: 0e
[2023-07-17 23:01:33] [config] after-batches: 0
[2023-07-17 23:01:33] [config] after-epochs: 200
[2023-07-17 23:01:33] [config] all-caps-every: 0
[2023-07-17 23:01:33] [config] allow-unk: false
[2023-07-17 23:01:33] [config] authors: false
[2023-07-17 23:01:33] [config] beam-size: 12
[2023-07-17 23:01:33] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:33] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:33] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:33] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:33] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:33] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:33] [config] build-info: ""
[2023-07-17 23:01:33] [config] check-gradient-nan: false
[2023-07-17 23:01:33] [config] check-nan: false
[2023-07-17 23:01:33] [config] cite: false
[2023-07-17 23:01:33] [config] clip-norm: 1
[2023-07-17 23:01:33] [config] cost-scaling:
[2023-07-17 23:01:33] [config]   - 256.f
[2023-07-17 23:01:33] [config]   - 1000
[2023-07-17 23:01:33] [config]   - 2.f
[2023-07-17 23:01:33] [config]   - 256.f
[2023-07-17 23:01:33] [config] cost-type: ce-sum
[2023-07-17 23:01:33] [config] cpu-threads: 0
[2023-07-17 23:01:33] [config] data-threads: 8
[2023-07-17 23:01:33] [config] data-weighting: ""
[2023-07-17 23:01:33] [config] data-weighting-type: sentence
[2023-07-17 23:01:33] [config] dec-cell: gru
[2023-07-17 23:01:33] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:33] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:33] [config] dec-depth: 1
[2023-07-17 23:01:33] [config] devices:
[2023-07-17 23:01:33] [config]   - 0
[2023-07-17 23:01:33] [config] dim-emb: 512
[2023-07-17 23:01:33] [config] dim-rnn: 1024
[2023-07-17 23:01:33] [config] dim-vocabs:
[2023-07-17 23:01:33] [config]   - 16384
[2023-07-17 23:01:33] [config]   - 16384
[2023-07-17 23:01:33] [config] disp-first: 0
[2023-07-17 23:01:33] [config] disp-freq: 1000u
[2023-07-17 23:01:33] [config] disp-label-counts: true
[2023-07-17 23:01:33] [config] dropout-rnn: 0
[2023-07-17 23:01:33] [config] dropout-src: 0
[2023-07-17 23:01:33] [config] dropout-trg: 0
[2023-07-17 23:01:33] [config] dump-config: ""
[2023-07-17 23:01:33] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] early-stopping: 5
[2023-07-17 23:01:33] [config] early-stopping-on: first
[2023-07-17 23:01:33] [config] embedding-fix-src: false
[2023-07-17 23:01:33] [config] embedding-fix-trg: false
[2023-07-17 23:01:33] [config] embedding-normalization: false
[2023-07-17 23:01:33] [config] embedding-vectors:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] enc-cell: gru
[2023-07-17 23:01:33] [config] enc-cell-depth: 1
[2023-07-17 23:01:33] [config] enc-depth: 1
[2023-07-17 23:01:33] [config] enc-type: bidirectional
[2023-07-17 23:01:33] [config] english-title-case-every: 0
[2023-07-17 23:01:33] [config] exponential-smoothing: 0
[2023-07-17 23:01:33] [config] factor-weight: 1
[2023-07-17 23:01:33] [config] factors-combine: sum
[2023-07-17 23:01:33] [config] factors-dim-emb: 0
[2023-07-17 23:01:33] [config] gradient-checkpointing: false
[2023-07-17 23:01:33] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:33] [config] guided-alignment: none
[2023-07-17 23:01:33] [config] guided-alignment-cost: mse
[2023-07-17 23:01:33] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:33] [config] ignore-model-config: false
[2023-07-17 23:01:33] [config] input-types:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] interpolate-env-vars: false
[2023-07-17 23:01:33] [config] keep-best: false
[2023-07-17 23:01:33] [config] label-smoothing: 0
[2023-07-17 23:01:33] [config] layer-normalization: false
[2023-07-17 23:01:33] [config] learn-rate: 0.0001
[2023-07-17 23:01:33] [config] lemma-dependency: ""
[2023-07-17 23:01:33] [config] lemma-dim-emb: 0
[2023-07-17 23:01:33] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:33] [config] log-level: info
[2023-07-17 23:01:33] [config] log-time-zone: ""
[2023-07-17 23:01:33] [config] logical-epoch:
[2023-07-17 23:01:33] [config]   - 1e
[2023-07-17 23:01:33] [config]   - 0
[2023-07-17 23:01:33] [config] lr-decay: 0
[2023-07-17 23:01:33] [config] lr-decay-freq: 50000
[2023-07-17 23:01:33] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:33] [config]   - 0
[2023-07-17 23:01:33] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:33] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:33] [config] lr-decay-start:
[2023-07-17 23:01:33] [config]   - 10
[2023-07-17 23:01:33] [config]   - 1
[2023-07-17 23:01:33] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:33] [config] lr-report: false
[2023-07-17 23:01:33] [config] lr-warmup: 0
[2023-07-17 23:01:33] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:33] [config] lr-warmup-cycle: false
[2023-07-17 23:01:33] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:33] [config] max-length: 150
[2023-07-17 23:01:33] [config] max-length-crop: true
[2023-07-17 23:01:33] [config] max-length-factor: 3
[2023-07-17 23:01:33] [config] maxi-batch: 100
[2023-07-17 23:01:33] [config] maxi-batch-sort: trg
[2023-07-17 23:01:33] [config] mini-batch: 64
[2023-07-17 23:01:33] [config] mini-batch-fit: true
[2023-07-17 23:01:33] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:33] [config] mini-batch-round-up: true
[2023-07-17 23:01:33] [config] mini-batch-track-lr: false
[2023-07-17 23:01:33] [config] mini-batch-warmup: 0
[2023-07-17 23:01:33] [config] mini-batch-words: 0
[2023-07-17 23:01:33] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:33] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-17 23:01:33] [config] multi-loss-type: sum
[2023-07-17 23:01:33] [config] n-best: false
[2023-07-17 23:01:33] [config] no-nccl: false
[2023-07-17 23:01:33] [config] no-reload: false
[2023-07-17 23:01:33] [config] no-restore-corpus: false
[2023-07-17 23:01:33] [config] normalize: 0
[2023-07-17 23:01:33] [config] normalize-gradient: false
[2023-07-17 23:01:33] [config] num-devices: 0
[2023-07-17 23:01:33] [config] optimizer: adam
[2023-07-17 23:01:33] [config] optimizer-delay: 1
[2023-07-17 23:01:33] [config] optimizer-params:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] output-omit-bias: false
[2023-07-17 23:01:33] [config] overwrite: true
[2023-07-17 23:01:33] [config] precision:
[2023-07-17 23:01:33] [config]   - float16
[2023-07-17 23:01:33] [config]   - float32
[2023-07-17 23:01:33] [config] pretrained-model: ""
[2023-07-17 23:01:33] [config] quantize-biases: false
[2023-07-17 23:01:33] [config] quantize-bits: 0
[2023-07-17 23:01:33] [config] quantize-log-based: false
[2023-07-17 23:01:33] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:33] [config] quiet: false
[2023-07-17 23:01:33] [config] quiet-translation: true
[2023-07-17 23:01:33] [config] relative-paths: false
[2023-07-17 23:01:33] [config] right-left: false
[2023-07-17 23:01:33] [config] save-freq: 10000u
[2023-07-17 23:01:33] [config] seed: 1234
[2023-07-17 23:01:33] [config] sentencepiece-alphas:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:33] [config] sentencepiece-options: ""
[2023-07-17 23:01:33] [config] sharding: global
[2023-07-17 23:01:33] [config] shuffle: data
[2023-07-17 23:01:33] [config] shuffle-in-ram: false
[2023-07-17 23:01:33] [config] sigterm: save-and-exit
[2023-07-17 23:01:33] [config] skip: false
[2023-07-17 23:01:33] [config] sqlite: ""
[2023-07-17 23:01:33] [config] sqlite-drop: false
[2023-07-17 23:01:33] [config] sync-freq: 200u
[2023-07-17 23:01:33] [config] sync-sgd: false
[2023-07-17 23:01:33] [config] tempdir: /tmp
[2023-07-17 23:01:33] [config] tied-embeddings: false
[2023-07-17 23:01:33] [config] tied-embeddings-all: true
[2023-07-17 23:01:33] [config] tied-embeddings-src: false
[2023-07-17 23:01:33] [config] train-embedder-rank:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] train-sets:
[2023-07-17 23:01:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:33] [config] transformer-aan-activation: swish
[2023-07-17 23:01:33] [config] transformer-aan-depth: 2
[2023-07-17 23:01:33] [config] transformer-aan-nogate: false
[2023-07-17 23:01:33] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:33] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:33] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:33] [config] transformer-depth-scaling: false
[2023-07-17 23:01:33] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:33] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:33] [config] transformer-dropout: 0
[2023-07-17 23:01:33] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:33] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:33] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:33] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:33] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:33] [config] transformer-heads: 8
[2023-07-17 23:01:33] [config] transformer-no-projection: false
[2023-07-17 23:01:33] [config] transformer-pool: false
[2023-07-17 23:01:33] [config] transformer-postprocess: dan
[2023-07-17 23:01:33] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:33] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:33] [config] transformer-preprocess: ""
[2023-07-17 23:01:33] [config] transformer-tied-layers:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:33] [config] tsv: false
[2023-07-17 23:01:33] [config] tsv-fields: 0
[2023-07-17 23:01:33] [config] type: amun
[2023-07-17 23:01:33] [config] ulr: false
[2023-07-17 23:01:33] [config] ulr-dim-emb: 0
[2023-07-17 23:01:33] [config] ulr-dropout: 0
[2023-07-17 23:01:33] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:33] [config] ulr-query-vectors: ""
[2023-07-17 23:01:33] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:33] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:33] [config] unlikelihood-loss: false
[2023-07-17 23:01:33] [config] valid-freq: 50000000
[2023-07-17 23:01:33] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:33] [config] valid-max-length: 1000
[2023-07-17 23:01:33] [config] valid-metrics:
[2023-07-17 23:01:33] [config]   - cross-entropy
[2023-07-17 23:01:33] [config]   - translation
[2023-07-17 23:01:33] [config] valid-mini-batch: 32
[2023-07-17 23:01:33] [config] valid-reset-stalled: false
[2023-07-17 23:01:33] [config] valid-script-args:
[2023-07-17 23:01:33] [config]   []
[2023-07-17 23:01:33] [config] valid-script-path: ""
[2023-07-17 23:01:33] [config] valid-sets:
[2023-07-17 23:01:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:33] [config] vocabs:
[2023-07-17 23:01:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:33] [config] word-penalty: 0
[2023-07-17 23:01:33] [config] word-scores: false
[2023-07-17 23:01:33] [config] workspace: 5500
[2023-07-17 23:01:33] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:33] [training] Using single-device training
[2023-07-17 23:01:33] Synced seed 1234
[2023-07-17 23:01:33] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:33] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:33] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x563090053177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x563090053699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x56309005692f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5630900457da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5630900460f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x56309009382e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x5630900a679d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x56308ff70b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x56308fe912c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56308fe48b9c]    main                                               + 0x3c
[0x7fbbb67520b3]    __libc_start_main                                  + 0xf3
[0x56308fe8fcbe]    _start                                             + 0x2e

[2023-07-17 23:01:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:36] [marian] Running on node22.datos.cluster.uy as process 3792 with command line:
[2023-07-17 23:01:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:36] [config] after: 0e
[2023-07-17 23:01:36] [config] after-batches: 0
[2023-07-17 23:01:36] [config] after-epochs: 10
[2023-07-17 23:01:36] [config] all-caps-every: 0
[2023-07-17 23:01:36] [config] allow-unk: false
[2023-07-17 23:01:36] [config] authors: false
[2023-07-17 23:01:36] [config] beam-size: 12
[2023-07-17 23:01:36] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:36] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:36] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:36] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:36] [config] build-info: ""
[2023-07-17 23:01:36] [config] check-gradient-nan: false
[2023-07-17 23:01:36] [config] check-nan: false
[2023-07-17 23:01:36] [config] cite: false
[2023-07-17 23:01:36] [config] clip-norm: 1
[2023-07-17 23:01:36] [config] cost-scaling:
[2023-07-17 23:01:36] [config]   - 256.f
[2023-07-17 23:01:36] [config]   - 1000
[2023-07-17 23:01:36] [config]   - 2.f
[2023-07-17 23:01:36] [config]   - 256.f
[2023-07-17 23:01:36] [config] cost-type: ce-sum
[2023-07-17 23:01:36] [config] cpu-threads: 0
[2023-07-17 23:01:36] [config] data-threads: 8
[2023-07-17 23:01:36] [config] data-weighting: ""
[2023-07-17 23:01:36] [config] data-weighting-type: sentence
[2023-07-17 23:01:36] [config] dec-cell: gru
[2023-07-17 23:01:36] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:36] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:36] [config] dec-depth: 1
[2023-07-17 23:01:36] [config] devices:
[2023-07-17 23:01:36] [config]   - 0
[2023-07-17 23:01:36] [config] dim-emb: 512
[2023-07-17 23:01:36] [config] dim-rnn: 1024
[2023-07-17 23:01:36] [config] dim-vocabs:
[2023-07-17 23:01:36] [config]   - 16384
[2023-07-17 23:01:36] [config]   - 16384
[2023-07-17 23:01:36] [config] disp-first: 0
[2023-07-17 23:01:36] [config] disp-freq: 1000u
[2023-07-17 23:01:36] [config] disp-label-counts: true
[2023-07-17 23:01:36] [config] dropout-rnn: 0
[2023-07-17 23:01:36] [config] dropout-src: 0
[2023-07-17 23:01:36] [config] dropout-trg: 0
[2023-07-17 23:01:36] [config] dump-config: ""
[2023-07-17 23:01:36] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] early-stopping: 5
[2023-07-17 23:01:36] [config] early-stopping-on: first
[2023-07-17 23:01:36] [config] embedding-fix-src: false
[2023-07-17 23:01:36] [config] embedding-fix-trg: false
[2023-07-17 23:01:36] [config] embedding-normalization: false
[2023-07-17 23:01:36] [config] embedding-vectors:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] enc-cell: gru
[2023-07-17 23:01:36] [config] enc-cell-depth: 1
[2023-07-17 23:01:36] [config] enc-depth: 1
[2023-07-17 23:01:36] [config] enc-type: bidirectional
[2023-07-17 23:01:36] [config] english-title-case-every: 0
[2023-07-17 23:01:36] [config] exponential-smoothing: 0
[2023-07-17 23:01:36] [config] factor-weight: 1
[2023-07-17 23:01:36] [config] factors-combine: sum
[2023-07-17 23:01:36] [config] factors-dim-emb: 0
[2023-07-17 23:01:36] [config] gradient-checkpointing: false
[2023-07-17 23:01:36] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:36] [config] guided-alignment: none
[2023-07-17 23:01:36] [config] guided-alignment-cost: mse
[2023-07-17 23:01:36] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:36] [config] ignore-model-config: false
[2023-07-17 23:01:36] [config] input-types:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] interpolate-env-vars: false
[2023-07-17 23:01:36] [config] keep-best: false
[2023-07-17 23:01:36] [config] label-smoothing: 0
[2023-07-17 23:01:36] [config] layer-normalization: false
[2023-07-17 23:01:36] [config] learn-rate: 0.0001
[2023-07-17 23:01:36] [config] lemma-dependency: ""
[2023-07-17 23:01:36] [config] lemma-dim-emb: 0
[2023-07-17 23:01:36] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:36] [config] log-level: info
[2023-07-17 23:01:36] [config] log-time-zone: ""
[2023-07-17 23:01:36] [config] logical-epoch:
[2023-07-17 23:01:36] [config]   - 1e
[2023-07-17 23:01:36] [config]   - 0
[2023-07-17 23:01:36] [config] lr-decay: 0
[2023-07-17 23:01:36] [config] lr-decay-freq: 50000
[2023-07-17 23:01:36] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:36] [config]   - 0
[2023-07-17 23:01:36] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:36] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:36] [config] lr-decay-start:
[2023-07-17 23:01:36] [config]   - 10
[2023-07-17 23:01:36] [config]   - 1
[2023-07-17 23:01:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:36] [config] lr-report: false
[2023-07-17 23:01:36] [config] lr-warmup: 0
[2023-07-17 23:01:36] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:36] [config] lr-warmup-cycle: false
[2023-07-17 23:01:36] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:36] [config] max-length: 200
[2023-07-17 23:01:36] [config] max-length-crop: true
[2023-07-17 23:01:36] [config] max-length-factor: 3
[2023-07-17 23:01:36] [config] maxi-batch: 100
[2023-07-17 23:01:36] [config] maxi-batch-sort: trg
[2023-07-17 23:01:36] [config] mini-batch: 64
[2023-07-17 23:01:36] [config] mini-batch-fit: true
[2023-07-17 23:01:36] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:36] [config] mini-batch-round-up: true
[2023-07-17 23:01:36] [config] mini-batch-track-lr: false
[2023-07-17 23:01:36] [config] mini-batch-warmup: 0
[2023-07-17 23:01:36] [config] mini-batch-words: 0
[2023-07-17 23:01:36] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:36] [config] multi-loss-type: sum
[2023-07-17 23:01:36] [config] n-best: false
[2023-07-17 23:01:36] [config] no-nccl: false
[2023-07-17 23:01:36] [config] no-reload: false
[2023-07-17 23:01:36] [config] no-restore-corpus: false
[2023-07-17 23:01:36] [config] normalize: 0
[2023-07-17 23:01:36] [config] normalize-gradient: false
[2023-07-17 23:01:36] [config] num-devices: 0
[2023-07-17 23:01:36] [config] optimizer: adam
[2023-07-17 23:01:36] [config] optimizer-delay: 1
[2023-07-17 23:01:36] [config] optimizer-params:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] output-omit-bias: false
[2023-07-17 23:01:36] [config] overwrite: true
[2023-07-17 23:01:36] [config] precision:
[2023-07-17 23:01:36] [config]   - float16
[2023-07-17 23:01:36] [config]   - float32
[2023-07-17 23:01:36] [config] pretrained-model: ""
[2023-07-17 23:01:36] [config] quantize-biases: false
[2023-07-17 23:01:36] [config] quantize-bits: 0
[2023-07-17 23:01:36] [config] quantize-log-based: false
[2023-07-17 23:01:36] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:36] [config] quiet: false
[2023-07-17 23:01:36] [config] quiet-translation: true
[2023-07-17 23:01:36] [config] relative-paths: false
[2023-07-17 23:01:36] [config] right-left: false
[2023-07-17 23:01:36] [config] save-freq: 10000u
[2023-07-17 23:01:36] [config] seed: 1234
[2023-07-17 23:01:36] [config] sentencepiece-alphas:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:36] [config] sentencepiece-options: ""
[2023-07-17 23:01:36] [config] sharding: global
[2023-07-17 23:01:36] [config] shuffle: data
[2023-07-17 23:01:36] [config] shuffle-in-ram: false
[2023-07-17 23:01:36] [config] sigterm: save-and-exit
[2023-07-17 23:01:36] [config] skip: false
[2023-07-17 23:01:36] [config] sqlite: ""
[2023-07-17 23:01:36] [config] sqlite-drop: false
[2023-07-17 23:01:36] [config] sync-freq: 200u
[2023-07-17 23:01:36] [config] sync-sgd: false
[2023-07-17 23:01:36] [config] tempdir: /tmp
[2023-07-17 23:01:36] [config] tied-embeddings: false
[2023-07-17 23:01:36] [config] tied-embeddings-all: true
[2023-07-17 23:01:36] [config] tied-embeddings-src: false
[2023-07-17 23:01:36] [config] train-embedder-rank:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] train-sets:
[2023-07-17 23:01:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:36] [config] transformer-aan-activation: swish
[2023-07-17 23:01:36] [config] transformer-aan-depth: 2
[2023-07-17 23:01:36] [config] transformer-aan-nogate: false
[2023-07-17 23:01:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:36] [config] transformer-depth-scaling: false
[2023-07-17 23:01:36] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:36] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:36] [config] transformer-dropout: 0
[2023-07-17 23:01:36] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:36] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:36] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:36] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:36] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:36] [config] transformer-heads: 8
[2023-07-17 23:01:36] [config] transformer-no-projection: false
[2023-07-17 23:01:36] [config] transformer-pool: false
[2023-07-17 23:01:36] [config] transformer-postprocess: dan
[2023-07-17 23:01:36] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:36] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:36] [config] transformer-preprocess: ""
[2023-07-17 23:01:36] [config] transformer-tied-layers:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:36] [config] tsv: false
[2023-07-17 23:01:36] [config] tsv-fields: 0
[2023-07-17 23:01:36] [config] type: amun
[2023-07-17 23:01:36] [config] ulr: false
[2023-07-17 23:01:36] [config] ulr-dim-emb: 0
[2023-07-17 23:01:36] [config] ulr-dropout: 0
[2023-07-17 23:01:36] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:36] [config] ulr-query-vectors: ""
[2023-07-17 23:01:36] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:36] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:36] [config] unlikelihood-loss: false
[2023-07-17 23:01:36] [config] valid-freq: 50000000
[2023-07-17 23:01:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:36] [config] valid-max-length: 1000
[2023-07-17 23:01:36] [config] valid-metrics:
[2023-07-17 23:01:36] [config]   - cross-entropy
[2023-07-17 23:01:36] [config]   - translation
[2023-07-17 23:01:36] [config] valid-mini-batch: 32
[2023-07-17 23:01:36] [config] valid-reset-stalled: false
[2023-07-17 23:01:36] [config] valid-script-args:
[2023-07-17 23:01:36] [config]   []
[2023-07-17 23:01:36] [config] valid-script-path: ""
[2023-07-17 23:01:36] [config] valid-sets:
[2023-07-17 23:01:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:36] [config] vocabs:
[2023-07-17 23:01:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:36] [config] word-penalty: 0
[2023-07-17 23:01:36] [config] word-scores: false
[2023-07-17 23:01:36] [config] workspace: 5500
[2023-07-17 23:01:36] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:36] [training] Using single-device training
[2023-07-17 23:01:36] Synced seed 1234
[2023-07-17 23:01:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:36] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:36] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55cfc3eb6177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55cfc3eb6699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55cfc3eb992f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55cfc3ea87da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55cfc3ea90f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55cfc3ef682e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55cfc3f0979d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55cfc3dd3b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55cfc3cf42c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55cfc3cabb9c]    main                                               + 0x3c
[0x7f4562bd50b3]    __libc_start_main                                  + 0xf3
[0x55cfc3cf2cbe]    _start                                             + 0x2e

[2023-07-17 23:01:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:38] [marian] Running on node22.datos.cluster.uy as process 3797 with command line:
[2023-07-17 23:01:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:38] [config] after: 0e
[2023-07-17 23:01:38] [config] after-batches: 0
[2023-07-17 23:01:38] [config] after-epochs: 20
[2023-07-17 23:01:38] [config] all-caps-every: 0
[2023-07-17 23:01:38] [config] allow-unk: false
[2023-07-17 23:01:38] [config] authors: false
[2023-07-17 23:01:38] [config] beam-size: 12
[2023-07-17 23:01:38] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:38] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:38] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:38] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:38] [config] build-info: ""
[2023-07-17 23:01:38] [config] check-gradient-nan: false
[2023-07-17 23:01:38] [config] check-nan: false
[2023-07-17 23:01:38] [config] cite: false
[2023-07-17 23:01:38] [config] clip-norm: 1
[2023-07-17 23:01:38] [config] cost-scaling:
[2023-07-17 23:01:38] [config]   - 256.f
[2023-07-17 23:01:38] [config]   - 1000
[2023-07-17 23:01:38] [config]   - 2.f
[2023-07-17 23:01:38] [config]   - 256.f
[2023-07-17 23:01:38] [config] cost-type: ce-sum
[2023-07-17 23:01:38] [config] cpu-threads: 0
[2023-07-17 23:01:38] [config] data-threads: 8
[2023-07-17 23:01:38] [config] data-weighting: ""
[2023-07-17 23:01:38] [config] data-weighting-type: sentence
[2023-07-17 23:01:38] [config] dec-cell: gru
[2023-07-17 23:01:38] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:38] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:38] [config] dec-depth: 1
[2023-07-17 23:01:38] [config] devices:
[2023-07-17 23:01:38] [config]   - 0
[2023-07-17 23:01:38] [config] dim-emb: 512
[2023-07-17 23:01:38] [config] dim-rnn: 1024
[2023-07-17 23:01:38] [config] dim-vocabs:
[2023-07-17 23:01:38] [config]   - 16384
[2023-07-17 23:01:38] [config]   - 16384
[2023-07-17 23:01:38] [config] disp-first: 0
[2023-07-17 23:01:38] [config] disp-freq: 1000u
[2023-07-17 23:01:38] [config] disp-label-counts: true
[2023-07-17 23:01:38] [config] dropout-rnn: 0
[2023-07-17 23:01:38] [config] dropout-src: 0
[2023-07-17 23:01:38] [config] dropout-trg: 0
[2023-07-17 23:01:38] [config] dump-config: ""
[2023-07-17 23:01:38] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] early-stopping: 5
[2023-07-17 23:01:38] [config] early-stopping-on: first
[2023-07-17 23:01:38] [config] embedding-fix-src: false
[2023-07-17 23:01:38] [config] embedding-fix-trg: false
[2023-07-17 23:01:38] [config] embedding-normalization: false
[2023-07-17 23:01:38] [config] embedding-vectors:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] enc-cell: gru
[2023-07-17 23:01:38] [config] enc-cell-depth: 1
[2023-07-17 23:01:38] [config] enc-depth: 1
[2023-07-17 23:01:38] [config] enc-type: bidirectional
[2023-07-17 23:01:38] [config] english-title-case-every: 0
[2023-07-17 23:01:38] [config] exponential-smoothing: 0
[2023-07-17 23:01:38] [config] factor-weight: 1
[2023-07-17 23:01:38] [config] factors-combine: sum
[2023-07-17 23:01:38] [config] factors-dim-emb: 0
[2023-07-17 23:01:38] [config] gradient-checkpointing: false
[2023-07-17 23:01:38] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:38] [config] guided-alignment: none
[2023-07-17 23:01:38] [config] guided-alignment-cost: mse
[2023-07-17 23:01:38] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:38] [config] ignore-model-config: false
[2023-07-17 23:01:38] [config] input-types:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] interpolate-env-vars: false
[2023-07-17 23:01:38] [config] keep-best: false
[2023-07-17 23:01:38] [config] label-smoothing: 0
[2023-07-17 23:01:38] [config] layer-normalization: false
[2023-07-17 23:01:38] [config] learn-rate: 0.0001
[2023-07-17 23:01:38] [config] lemma-dependency: ""
[2023-07-17 23:01:38] [config] lemma-dim-emb: 0
[2023-07-17 23:01:38] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:38] [config] log-level: info
[2023-07-17 23:01:38] [config] log-time-zone: ""
[2023-07-17 23:01:38] [config] logical-epoch:
[2023-07-17 23:01:38] [config]   - 1e
[2023-07-17 23:01:38] [config]   - 0
[2023-07-17 23:01:38] [config] lr-decay: 0
[2023-07-17 23:01:38] [config] lr-decay-freq: 50000
[2023-07-17 23:01:38] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:38] [config]   - 0
[2023-07-17 23:01:38] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:38] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:38] [config] lr-decay-start:
[2023-07-17 23:01:38] [config]   - 10
[2023-07-17 23:01:38] [config]   - 1
[2023-07-17 23:01:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:38] [config] lr-report: false
[2023-07-17 23:01:38] [config] lr-warmup: 0
[2023-07-17 23:01:38] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:38] [config] lr-warmup-cycle: false
[2023-07-17 23:01:38] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:38] [config] max-length: 200
[2023-07-17 23:01:38] [config] max-length-crop: true
[2023-07-17 23:01:38] [config] max-length-factor: 3
[2023-07-17 23:01:38] [config] maxi-batch: 100
[2023-07-17 23:01:38] [config] maxi-batch-sort: trg
[2023-07-17 23:01:38] [config] mini-batch: 64
[2023-07-17 23:01:38] [config] mini-batch-fit: true
[2023-07-17 23:01:38] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:38] [config] mini-batch-round-up: true
[2023-07-17 23:01:38] [config] mini-batch-track-lr: false
[2023-07-17 23:01:38] [config] mini-batch-warmup: 0
[2023-07-17 23:01:38] [config] mini-batch-words: 0
[2023-07-17 23:01:38] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:38] [config] multi-loss-type: sum
[2023-07-17 23:01:38] [config] n-best: false
[2023-07-17 23:01:38] [config] no-nccl: false
[2023-07-17 23:01:38] [config] no-reload: false
[2023-07-17 23:01:38] [config] no-restore-corpus: false
[2023-07-17 23:01:38] [config] normalize: 0
[2023-07-17 23:01:38] [config] normalize-gradient: false
[2023-07-17 23:01:38] [config] num-devices: 0
[2023-07-17 23:01:38] [config] optimizer: adam
[2023-07-17 23:01:38] [config] optimizer-delay: 1
[2023-07-17 23:01:38] [config] optimizer-params:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] output-omit-bias: false
[2023-07-17 23:01:38] [config] overwrite: true
[2023-07-17 23:01:38] [config] precision:
[2023-07-17 23:01:38] [config]   - float16
[2023-07-17 23:01:38] [config]   - float32
[2023-07-17 23:01:38] [config] pretrained-model: ""
[2023-07-17 23:01:38] [config] quantize-biases: false
[2023-07-17 23:01:38] [config] quantize-bits: 0
[2023-07-17 23:01:38] [config] quantize-log-based: false
[2023-07-17 23:01:38] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:38] [config] quiet: false
[2023-07-17 23:01:38] [config] quiet-translation: true
[2023-07-17 23:01:38] [config] relative-paths: false
[2023-07-17 23:01:38] [config] right-left: false
[2023-07-17 23:01:38] [config] save-freq: 10000u
[2023-07-17 23:01:38] [config] seed: 1234
[2023-07-17 23:01:38] [config] sentencepiece-alphas:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:38] [config] sentencepiece-options: ""
[2023-07-17 23:01:38] [config] sharding: global
[2023-07-17 23:01:38] [config] shuffle: data
[2023-07-17 23:01:38] [config] shuffle-in-ram: false
[2023-07-17 23:01:38] [config] sigterm: save-and-exit
[2023-07-17 23:01:38] [config] skip: false
[2023-07-17 23:01:38] [config] sqlite: ""
[2023-07-17 23:01:38] [config] sqlite-drop: false
[2023-07-17 23:01:38] [config] sync-freq: 200u
[2023-07-17 23:01:38] [config] sync-sgd: false
[2023-07-17 23:01:38] [config] tempdir: /tmp
[2023-07-17 23:01:38] [config] tied-embeddings: false
[2023-07-17 23:01:38] [config] tied-embeddings-all: true
[2023-07-17 23:01:38] [config] tied-embeddings-src: false
[2023-07-17 23:01:38] [config] train-embedder-rank:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] train-sets:
[2023-07-17 23:01:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:38] [config] transformer-aan-activation: swish
[2023-07-17 23:01:38] [config] transformer-aan-depth: 2
[2023-07-17 23:01:38] [config] transformer-aan-nogate: false
[2023-07-17 23:01:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:38] [config] transformer-depth-scaling: false
[2023-07-17 23:01:38] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:38] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:38] [config] transformer-dropout: 0
[2023-07-17 23:01:38] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:38] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:38] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:38] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:38] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:38] [config] transformer-heads: 8
[2023-07-17 23:01:38] [config] transformer-no-projection: false
[2023-07-17 23:01:38] [config] transformer-pool: false
[2023-07-17 23:01:38] [config] transformer-postprocess: dan
[2023-07-17 23:01:38] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:38] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:38] [config] transformer-preprocess: ""
[2023-07-17 23:01:38] [config] transformer-tied-layers:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:38] [config] tsv: false
[2023-07-17 23:01:38] [config] tsv-fields: 0
[2023-07-17 23:01:38] [config] type: amun
[2023-07-17 23:01:38] [config] ulr: false
[2023-07-17 23:01:38] [config] ulr-dim-emb: 0
[2023-07-17 23:01:38] [config] ulr-dropout: 0
[2023-07-17 23:01:38] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:38] [config] ulr-query-vectors: ""
[2023-07-17 23:01:38] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:38] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:38] [config] unlikelihood-loss: false
[2023-07-17 23:01:38] [config] valid-freq: 50000000
[2023-07-17 23:01:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:38] [config] valid-max-length: 1000
[2023-07-17 23:01:38] [config] valid-metrics:
[2023-07-17 23:01:38] [config]   - cross-entropy
[2023-07-17 23:01:38] [config]   - translation
[2023-07-17 23:01:38] [config] valid-mini-batch: 32
[2023-07-17 23:01:38] [config] valid-reset-stalled: false
[2023-07-17 23:01:38] [config] valid-script-args:
[2023-07-17 23:01:38] [config]   []
[2023-07-17 23:01:38] [config] valid-script-path: ""
[2023-07-17 23:01:38] [config] valid-sets:
[2023-07-17 23:01:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:38] [config] vocabs:
[2023-07-17 23:01:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:38] [config] word-penalty: 0
[2023-07-17 23:01:38] [config] word-scores: false
[2023-07-17 23:01:38] [config] workspace: 5500
[2023-07-17 23:01:38] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:38] [training] Using single-device training
[2023-07-17 23:01:38] Synced seed 1234
[2023-07-17 23:01:38] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:39] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:39] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x5607183c6177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x5607183c6699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x5607183c992f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5607183b87da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5607183b90f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x56071840682e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x56071841979d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x5607182e3b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5607182042c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5607181bbb9c]    main                                               + 0x3c
[0x7f065f2990b3]    __libc_start_main                                  + 0xf3
[0x560718202cbe]    _start                                             + 0x2e

[2023-07-17 23:01:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:41] [marian] Running on node22.datos.cluster.uy as process 3802 with command line:
[2023-07-17 23:01:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:41] [config] after: 0e
[2023-07-17 23:01:41] [config] after-batches: 0
[2023-07-17 23:01:41] [config] after-epochs: 30
[2023-07-17 23:01:41] [config] all-caps-every: 0
[2023-07-17 23:01:41] [config] allow-unk: false
[2023-07-17 23:01:41] [config] authors: false
[2023-07-17 23:01:41] [config] beam-size: 12
[2023-07-17 23:01:41] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:41] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:41] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:41] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:41] [config] build-info: ""
[2023-07-17 23:01:41] [config] check-gradient-nan: false
[2023-07-17 23:01:41] [config] check-nan: false
[2023-07-17 23:01:41] [config] cite: false
[2023-07-17 23:01:41] [config] clip-norm: 1
[2023-07-17 23:01:41] [config] cost-scaling:
[2023-07-17 23:01:41] [config]   - 256.f
[2023-07-17 23:01:41] [config]   - 1000
[2023-07-17 23:01:41] [config]   - 2.f
[2023-07-17 23:01:41] [config]   - 256.f
[2023-07-17 23:01:41] [config] cost-type: ce-sum
[2023-07-17 23:01:41] [config] cpu-threads: 0
[2023-07-17 23:01:41] [config] data-threads: 8
[2023-07-17 23:01:41] [config] data-weighting: ""
[2023-07-17 23:01:41] [config] data-weighting-type: sentence
[2023-07-17 23:01:41] [config] dec-cell: gru
[2023-07-17 23:01:41] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:41] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:41] [config] dec-depth: 1
[2023-07-17 23:01:41] [config] devices:
[2023-07-17 23:01:41] [config]   - 0
[2023-07-17 23:01:41] [config] dim-emb: 512
[2023-07-17 23:01:41] [config] dim-rnn: 1024
[2023-07-17 23:01:41] [config] dim-vocabs:
[2023-07-17 23:01:41] [config]   - 16384
[2023-07-17 23:01:41] [config]   - 16384
[2023-07-17 23:01:41] [config] disp-first: 0
[2023-07-17 23:01:41] [config] disp-freq: 1000u
[2023-07-17 23:01:41] [config] disp-label-counts: true
[2023-07-17 23:01:41] [config] dropout-rnn: 0
[2023-07-17 23:01:41] [config] dropout-src: 0
[2023-07-17 23:01:41] [config] dropout-trg: 0
[2023-07-17 23:01:41] [config] dump-config: ""
[2023-07-17 23:01:41] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] early-stopping: 5
[2023-07-17 23:01:41] [config] early-stopping-on: first
[2023-07-17 23:01:41] [config] embedding-fix-src: false
[2023-07-17 23:01:41] [config] embedding-fix-trg: false
[2023-07-17 23:01:41] [config] embedding-normalization: false
[2023-07-17 23:01:41] [config] embedding-vectors:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] enc-cell: gru
[2023-07-17 23:01:41] [config] enc-cell-depth: 1
[2023-07-17 23:01:41] [config] enc-depth: 1
[2023-07-17 23:01:41] [config] enc-type: bidirectional
[2023-07-17 23:01:41] [config] english-title-case-every: 0
[2023-07-17 23:01:41] [config] exponential-smoothing: 0
[2023-07-17 23:01:41] [config] factor-weight: 1
[2023-07-17 23:01:41] [config] factors-combine: sum
[2023-07-17 23:01:41] [config] factors-dim-emb: 0
[2023-07-17 23:01:41] [config] gradient-checkpointing: false
[2023-07-17 23:01:41] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:41] [config] guided-alignment: none
[2023-07-17 23:01:41] [config] guided-alignment-cost: mse
[2023-07-17 23:01:41] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:41] [config] ignore-model-config: false
[2023-07-17 23:01:41] [config] input-types:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] interpolate-env-vars: false
[2023-07-17 23:01:41] [config] keep-best: false
[2023-07-17 23:01:41] [config] label-smoothing: 0
[2023-07-17 23:01:41] [config] layer-normalization: false
[2023-07-17 23:01:41] [config] learn-rate: 0.0001
[2023-07-17 23:01:41] [config] lemma-dependency: ""
[2023-07-17 23:01:41] [config] lemma-dim-emb: 0
[2023-07-17 23:01:41] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:41] [config] log-level: info
[2023-07-17 23:01:41] [config] log-time-zone: ""
[2023-07-17 23:01:41] [config] logical-epoch:
[2023-07-17 23:01:41] [config]   - 1e
[2023-07-17 23:01:41] [config]   - 0
[2023-07-17 23:01:41] [config] lr-decay: 0
[2023-07-17 23:01:41] [config] lr-decay-freq: 50000
[2023-07-17 23:01:41] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:41] [config]   - 0
[2023-07-17 23:01:41] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:41] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:41] [config] lr-decay-start:
[2023-07-17 23:01:41] [config]   - 10
[2023-07-17 23:01:41] [config]   - 1
[2023-07-17 23:01:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:41] [config] lr-report: false
[2023-07-17 23:01:41] [config] lr-warmup: 0
[2023-07-17 23:01:41] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:41] [config] lr-warmup-cycle: false
[2023-07-17 23:01:41] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:41] [config] max-length: 200
[2023-07-17 23:01:41] [config] max-length-crop: true
[2023-07-17 23:01:41] [config] max-length-factor: 3
[2023-07-17 23:01:41] [config] maxi-batch: 100
[2023-07-17 23:01:41] [config] maxi-batch-sort: trg
[2023-07-17 23:01:41] [config] mini-batch: 64
[2023-07-17 23:01:41] [config] mini-batch-fit: true
[2023-07-17 23:01:41] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:41] [config] mini-batch-round-up: true
[2023-07-17 23:01:41] [config] mini-batch-track-lr: false
[2023-07-17 23:01:41] [config] mini-batch-warmup: 0
[2023-07-17 23:01:41] [config] mini-batch-words: 0
[2023-07-17 23:01:41] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:41] [config] multi-loss-type: sum
[2023-07-17 23:01:41] [config] n-best: false
[2023-07-17 23:01:41] [config] no-nccl: false
[2023-07-17 23:01:41] [config] no-reload: false
[2023-07-17 23:01:41] [config] no-restore-corpus: false
[2023-07-17 23:01:41] [config] normalize: 0
[2023-07-17 23:01:41] [config] normalize-gradient: false
[2023-07-17 23:01:41] [config] num-devices: 0
[2023-07-17 23:01:41] [config] optimizer: adam
[2023-07-17 23:01:41] [config] optimizer-delay: 1
[2023-07-17 23:01:41] [config] optimizer-params:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] output-omit-bias: false
[2023-07-17 23:01:41] [config] overwrite: true
[2023-07-17 23:01:41] [config] precision:
[2023-07-17 23:01:41] [config]   - float16
[2023-07-17 23:01:41] [config]   - float32
[2023-07-17 23:01:41] [config] pretrained-model: ""
[2023-07-17 23:01:41] [config] quantize-biases: false
[2023-07-17 23:01:41] [config] quantize-bits: 0
[2023-07-17 23:01:41] [config] quantize-log-based: false
[2023-07-17 23:01:41] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:41] [config] quiet: false
[2023-07-17 23:01:41] [config] quiet-translation: true
[2023-07-17 23:01:41] [config] relative-paths: false
[2023-07-17 23:01:41] [config] right-left: false
[2023-07-17 23:01:41] [config] save-freq: 10000u
[2023-07-17 23:01:41] [config] seed: 1234
[2023-07-17 23:01:41] [config] sentencepiece-alphas:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:41] [config] sentencepiece-options: ""
[2023-07-17 23:01:41] [config] sharding: global
[2023-07-17 23:01:41] [config] shuffle: data
[2023-07-17 23:01:41] [config] shuffle-in-ram: false
[2023-07-17 23:01:41] [config] sigterm: save-and-exit
[2023-07-17 23:01:41] [config] skip: false
[2023-07-17 23:01:41] [config] sqlite: ""
[2023-07-17 23:01:41] [config] sqlite-drop: false
[2023-07-17 23:01:41] [config] sync-freq: 200u
[2023-07-17 23:01:41] [config] sync-sgd: false
[2023-07-17 23:01:41] [config] tempdir: /tmp
[2023-07-17 23:01:41] [config] tied-embeddings: false
[2023-07-17 23:01:41] [config] tied-embeddings-all: true
[2023-07-17 23:01:41] [config] tied-embeddings-src: false
[2023-07-17 23:01:41] [config] train-embedder-rank:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] train-sets:
[2023-07-17 23:01:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:41] [config] transformer-aan-activation: swish
[2023-07-17 23:01:41] [config] transformer-aan-depth: 2
[2023-07-17 23:01:41] [config] transformer-aan-nogate: false
[2023-07-17 23:01:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:41] [config] transformer-depth-scaling: false
[2023-07-17 23:01:41] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:41] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:41] [config] transformer-dropout: 0
[2023-07-17 23:01:41] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:41] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:41] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:41] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:41] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:41] [config] transformer-heads: 8
[2023-07-17 23:01:41] [config] transformer-no-projection: false
[2023-07-17 23:01:41] [config] transformer-pool: false
[2023-07-17 23:01:41] [config] transformer-postprocess: dan
[2023-07-17 23:01:41] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:41] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:41] [config] transformer-preprocess: ""
[2023-07-17 23:01:41] [config] transformer-tied-layers:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:41] [config] tsv: false
[2023-07-17 23:01:41] [config] tsv-fields: 0
[2023-07-17 23:01:41] [config] type: amun
[2023-07-17 23:01:41] [config] ulr: false
[2023-07-17 23:01:41] [config] ulr-dim-emb: 0
[2023-07-17 23:01:41] [config] ulr-dropout: 0
[2023-07-17 23:01:41] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:41] [config] ulr-query-vectors: ""
[2023-07-17 23:01:41] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:41] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:41] [config] unlikelihood-loss: false
[2023-07-17 23:01:41] [config] valid-freq: 50000000
[2023-07-17 23:01:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:41] [config] valid-max-length: 1000
[2023-07-17 23:01:41] [config] valid-metrics:
[2023-07-17 23:01:41] [config]   - cross-entropy
[2023-07-17 23:01:41] [config]   - translation
[2023-07-17 23:01:41] [config] valid-mini-batch: 32
[2023-07-17 23:01:41] [config] valid-reset-stalled: false
[2023-07-17 23:01:41] [config] valid-script-args:
[2023-07-17 23:01:41] [config]   []
[2023-07-17 23:01:41] [config] valid-script-path: ""
[2023-07-17 23:01:41] [config] valid-sets:
[2023-07-17 23:01:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:41] [config] vocabs:
[2023-07-17 23:01:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:41] [config] word-penalty: 0
[2023-07-17 23:01:41] [config] word-scores: false
[2023-07-17 23:01:41] [config] workspace: 5500
[2023-07-17 23:01:41] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:41] [training] Using single-device training
[2023-07-17 23:01:41] Synced seed 1234
[2023-07-17 23:01:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:41] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:41] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x555abcb52177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x555abcb52699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x555abcb5592f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x555abcb447da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x555abcb450f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x555abcb9282e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x555abcba579d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x555abca6fb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x555abc9902c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x555abc947b9c]    main                                               + 0x3c
[0x7fe0824870b3]    __libc_start_main                                  + 0xf3
[0x555abc98ecbe]    _start                                             + 0x2e

[2023-07-17 23:01:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:43] [marian] Running on node22.datos.cluster.uy as process 3809 with command line:
[2023-07-17 23:01:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:43] [config] after: 0e
[2023-07-17 23:01:43] [config] after-batches: 0
[2023-07-17 23:01:43] [config] after-epochs: 40
[2023-07-17 23:01:43] [config] all-caps-every: 0
[2023-07-17 23:01:43] [config] allow-unk: false
[2023-07-17 23:01:43] [config] authors: false
[2023-07-17 23:01:43] [config] beam-size: 12
[2023-07-17 23:01:43] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:43] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:43] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:43] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:43] [config] build-info: ""
[2023-07-17 23:01:43] [config] check-gradient-nan: false
[2023-07-17 23:01:43] [config] check-nan: false
[2023-07-17 23:01:43] [config] cite: false
[2023-07-17 23:01:43] [config] clip-norm: 1
[2023-07-17 23:01:43] [config] cost-scaling:
[2023-07-17 23:01:43] [config]   - 256.f
[2023-07-17 23:01:43] [config]   - 1000
[2023-07-17 23:01:43] [config]   - 2.f
[2023-07-17 23:01:43] [config]   - 256.f
[2023-07-17 23:01:43] [config] cost-type: ce-sum
[2023-07-17 23:01:43] [config] cpu-threads: 0
[2023-07-17 23:01:43] [config] data-threads: 8
[2023-07-17 23:01:43] [config] data-weighting: ""
[2023-07-17 23:01:43] [config] data-weighting-type: sentence
[2023-07-17 23:01:43] [config] dec-cell: gru
[2023-07-17 23:01:43] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:43] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:43] [config] dec-depth: 1
[2023-07-17 23:01:43] [config] devices:
[2023-07-17 23:01:43] [config]   - 0
[2023-07-17 23:01:43] [config] dim-emb: 512
[2023-07-17 23:01:43] [config] dim-rnn: 1024
[2023-07-17 23:01:43] [config] dim-vocabs:
[2023-07-17 23:01:43] [config]   - 16384
[2023-07-17 23:01:43] [config]   - 16384
[2023-07-17 23:01:43] [config] disp-first: 0
[2023-07-17 23:01:43] [config] disp-freq: 1000u
[2023-07-17 23:01:43] [config] disp-label-counts: true
[2023-07-17 23:01:43] [config] dropout-rnn: 0
[2023-07-17 23:01:43] [config] dropout-src: 0
[2023-07-17 23:01:43] [config] dropout-trg: 0
[2023-07-17 23:01:43] [config] dump-config: ""
[2023-07-17 23:01:43] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] early-stopping: 5
[2023-07-17 23:01:43] [config] early-stopping-on: first
[2023-07-17 23:01:43] [config] embedding-fix-src: false
[2023-07-17 23:01:43] [config] embedding-fix-trg: false
[2023-07-17 23:01:43] [config] embedding-normalization: false
[2023-07-17 23:01:43] [config] embedding-vectors:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] enc-cell: gru
[2023-07-17 23:01:43] [config] enc-cell-depth: 1
[2023-07-17 23:01:43] [config] enc-depth: 1
[2023-07-17 23:01:43] [config] enc-type: bidirectional
[2023-07-17 23:01:43] [config] english-title-case-every: 0
[2023-07-17 23:01:43] [config] exponential-smoothing: 0
[2023-07-17 23:01:43] [config] factor-weight: 1
[2023-07-17 23:01:43] [config] factors-combine: sum
[2023-07-17 23:01:43] [config] factors-dim-emb: 0
[2023-07-17 23:01:43] [config] gradient-checkpointing: false
[2023-07-17 23:01:43] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:43] [config] guided-alignment: none
[2023-07-17 23:01:43] [config] guided-alignment-cost: mse
[2023-07-17 23:01:43] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:43] [config] ignore-model-config: false
[2023-07-17 23:01:43] [config] input-types:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] interpolate-env-vars: false
[2023-07-17 23:01:43] [config] keep-best: false
[2023-07-17 23:01:43] [config] label-smoothing: 0
[2023-07-17 23:01:43] [config] layer-normalization: false
[2023-07-17 23:01:43] [config] learn-rate: 0.0001
[2023-07-17 23:01:43] [config] lemma-dependency: ""
[2023-07-17 23:01:43] [config] lemma-dim-emb: 0
[2023-07-17 23:01:43] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:43] [config] log-level: info
[2023-07-17 23:01:43] [config] log-time-zone: ""
[2023-07-17 23:01:43] [config] logical-epoch:
[2023-07-17 23:01:43] [config]   - 1e
[2023-07-17 23:01:43] [config]   - 0
[2023-07-17 23:01:43] [config] lr-decay: 0
[2023-07-17 23:01:43] [config] lr-decay-freq: 50000
[2023-07-17 23:01:43] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:43] [config]   - 0
[2023-07-17 23:01:43] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:43] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:43] [config] lr-decay-start:
[2023-07-17 23:01:43] [config]   - 10
[2023-07-17 23:01:43] [config]   - 1
[2023-07-17 23:01:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:43] [config] lr-report: false
[2023-07-17 23:01:43] [config] lr-warmup: 0
[2023-07-17 23:01:43] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:43] [config] lr-warmup-cycle: false
[2023-07-17 23:01:43] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:43] [config] max-length: 200
[2023-07-17 23:01:43] [config] max-length-crop: true
[2023-07-17 23:01:43] [config] max-length-factor: 3
[2023-07-17 23:01:43] [config] maxi-batch: 100
[2023-07-17 23:01:43] [config] maxi-batch-sort: trg
[2023-07-17 23:01:43] [config] mini-batch: 64
[2023-07-17 23:01:43] [config] mini-batch-fit: true
[2023-07-17 23:01:43] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:43] [config] mini-batch-round-up: true
[2023-07-17 23:01:43] [config] mini-batch-track-lr: false
[2023-07-17 23:01:43] [config] mini-batch-warmup: 0
[2023-07-17 23:01:43] [config] mini-batch-words: 0
[2023-07-17 23:01:43] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:43] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:43] [config] multi-loss-type: sum
[2023-07-17 23:01:43] [config] n-best: false
[2023-07-17 23:01:43] [config] no-nccl: false
[2023-07-17 23:01:43] [config] no-reload: false
[2023-07-17 23:01:43] [config] no-restore-corpus: false
[2023-07-17 23:01:43] [config] normalize: 0
[2023-07-17 23:01:43] [config] normalize-gradient: false
[2023-07-17 23:01:43] [config] num-devices: 0
[2023-07-17 23:01:43] [config] optimizer: adam
[2023-07-17 23:01:43] [config] optimizer-delay: 1
[2023-07-17 23:01:43] [config] optimizer-params:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] output-omit-bias: false
[2023-07-17 23:01:43] [config] overwrite: true
[2023-07-17 23:01:43] [config] precision:
[2023-07-17 23:01:43] [config]   - float16
[2023-07-17 23:01:43] [config]   - float32
[2023-07-17 23:01:43] [config] pretrained-model: ""
[2023-07-17 23:01:43] [config] quantize-biases: false
[2023-07-17 23:01:43] [config] quantize-bits: 0
[2023-07-17 23:01:43] [config] quantize-log-based: false
[2023-07-17 23:01:43] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:43] [config] quiet: false
[2023-07-17 23:01:43] [config] quiet-translation: true
[2023-07-17 23:01:43] [config] relative-paths: false
[2023-07-17 23:01:43] [config] right-left: false
[2023-07-17 23:01:43] [config] save-freq: 10000u
[2023-07-17 23:01:43] [config] seed: 1234
[2023-07-17 23:01:43] [config] sentencepiece-alphas:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:43] [config] sentencepiece-options: ""
[2023-07-17 23:01:43] [config] sharding: global
[2023-07-17 23:01:43] [config] shuffle: data
[2023-07-17 23:01:43] [config] shuffle-in-ram: false
[2023-07-17 23:01:43] [config] sigterm: save-and-exit
[2023-07-17 23:01:43] [config] skip: false
[2023-07-17 23:01:43] [config] sqlite: ""
[2023-07-17 23:01:43] [config] sqlite-drop: false
[2023-07-17 23:01:43] [config] sync-freq: 200u
[2023-07-17 23:01:43] [config] sync-sgd: false
[2023-07-17 23:01:43] [config] tempdir: /tmp
[2023-07-17 23:01:43] [config] tied-embeddings: false
[2023-07-17 23:01:43] [config] tied-embeddings-all: true
[2023-07-17 23:01:43] [config] tied-embeddings-src: false
[2023-07-17 23:01:43] [config] train-embedder-rank:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] train-sets:
[2023-07-17 23:01:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:43] [config] transformer-aan-activation: swish
[2023-07-17 23:01:43] [config] transformer-aan-depth: 2
[2023-07-17 23:01:43] [config] transformer-aan-nogate: false
[2023-07-17 23:01:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:43] [config] transformer-depth-scaling: false
[2023-07-17 23:01:43] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:43] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:43] [config] transformer-dropout: 0
[2023-07-17 23:01:43] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:43] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:43] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:43] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:43] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:43] [config] transformer-heads: 8
[2023-07-17 23:01:43] [config] transformer-no-projection: false
[2023-07-17 23:01:43] [config] transformer-pool: false
[2023-07-17 23:01:43] [config] transformer-postprocess: dan
[2023-07-17 23:01:43] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:43] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:43] [config] transformer-preprocess: ""
[2023-07-17 23:01:43] [config] transformer-tied-layers:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:43] [config] tsv: false
[2023-07-17 23:01:43] [config] tsv-fields: 0
[2023-07-17 23:01:43] [config] type: amun
[2023-07-17 23:01:43] [config] ulr: false
[2023-07-17 23:01:43] [config] ulr-dim-emb: 0
[2023-07-17 23:01:43] [config] ulr-dropout: 0
[2023-07-17 23:01:43] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:43] [config] ulr-query-vectors: ""
[2023-07-17 23:01:43] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:43] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:43] [config] unlikelihood-loss: false
[2023-07-17 23:01:43] [config] valid-freq: 50000000
[2023-07-17 23:01:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:43] [config] valid-max-length: 1000
[2023-07-17 23:01:43] [config] valid-metrics:
[2023-07-17 23:01:43] [config]   - cross-entropy
[2023-07-17 23:01:43] [config]   - translation
[2023-07-17 23:01:43] [config] valid-mini-batch: 32
[2023-07-17 23:01:43] [config] valid-reset-stalled: false
[2023-07-17 23:01:43] [config] valid-script-args:
[2023-07-17 23:01:43] [config]   []
[2023-07-17 23:01:43] [config] valid-script-path: ""
[2023-07-17 23:01:43] [config] valid-sets:
[2023-07-17 23:01:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:43] [config] vocabs:
[2023-07-17 23:01:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:43] [config] word-penalty: 0
[2023-07-17 23:01:43] [config] word-scores: false
[2023-07-17 23:01:43] [config] workspace: 5500
[2023-07-17 23:01:43] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:43] [training] Using single-device training
[2023-07-17 23:01:44] Synced seed 1234
[2023-07-17 23:01:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:44] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:44] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55839e39e177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55839e39e699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55839e3a192f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55839e3907da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55839e3910f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55839e3de82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55839e3f179d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55839e2bbb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55839e1dc2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55839e193b9c]    main                                               + 0x3c
[0x7faea2ca90b3]    __libc_start_main                                  + 0xf3
[0x55839e1dacbe]    _start                                             + 0x2e

[2023-07-17 23:01:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:46] [marian] Running on node22.datos.cluster.uy as process 3815 with command line:
[2023-07-17 23:01:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:46] [config] after: 0e
[2023-07-17 23:01:46] [config] after-batches: 0
[2023-07-17 23:01:46] [config] after-epochs: 50
[2023-07-17 23:01:46] [config] all-caps-every: 0
[2023-07-17 23:01:46] [config] allow-unk: false
[2023-07-17 23:01:46] [config] authors: false
[2023-07-17 23:01:46] [config] beam-size: 12
[2023-07-17 23:01:46] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:46] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:46] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:46] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:46] [config] build-info: ""
[2023-07-17 23:01:46] [config] check-gradient-nan: false
[2023-07-17 23:01:46] [config] check-nan: false
[2023-07-17 23:01:46] [config] cite: false
[2023-07-17 23:01:46] [config] clip-norm: 1
[2023-07-17 23:01:46] [config] cost-scaling:
[2023-07-17 23:01:46] [config]   - 256.f
[2023-07-17 23:01:46] [config]   - 1000
[2023-07-17 23:01:46] [config]   - 2.f
[2023-07-17 23:01:46] [config]   - 256.f
[2023-07-17 23:01:46] [config] cost-type: ce-sum
[2023-07-17 23:01:46] [config] cpu-threads: 0
[2023-07-17 23:01:46] [config] data-threads: 8
[2023-07-17 23:01:46] [config] data-weighting: ""
[2023-07-17 23:01:46] [config] data-weighting-type: sentence
[2023-07-17 23:01:46] [config] dec-cell: gru
[2023-07-17 23:01:46] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:46] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:46] [config] dec-depth: 1
[2023-07-17 23:01:46] [config] devices:
[2023-07-17 23:01:46] [config]   - 0
[2023-07-17 23:01:46] [config] dim-emb: 512
[2023-07-17 23:01:46] [config] dim-rnn: 1024
[2023-07-17 23:01:46] [config] dim-vocabs:
[2023-07-17 23:01:46] [config]   - 16384
[2023-07-17 23:01:46] [config]   - 16384
[2023-07-17 23:01:46] [config] disp-first: 0
[2023-07-17 23:01:46] [config] disp-freq: 1000u
[2023-07-17 23:01:46] [config] disp-label-counts: true
[2023-07-17 23:01:46] [config] dropout-rnn: 0
[2023-07-17 23:01:46] [config] dropout-src: 0
[2023-07-17 23:01:46] [config] dropout-trg: 0
[2023-07-17 23:01:46] [config] dump-config: ""
[2023-07-17 23:01:46] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] early-stopping: 5
[2023-07-17 23:01:46] [config] early-stopping-on: first
[2023-07-17 23:01:46] [config] embedding-fix-src: false
[2023-07-17 23:01:46] [config] embedding-fix-trg: false
[2023-07-17 23:01:46] [config] embedding-normalization: false
[2023-07-17 23:01:46] [config] embedding-vectors:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] enc-cell: gru
[2023-07-17 23:01:46] [config] enc-cell-depth: 1
[2023-07-17 23:01:46] [config] enc-depth: 1
[2023-07-17 23:01:46] [config] enc-type: bidirectional
[2023-07-17 23:01:46] [config] english-title-case-every: 0
[2023-07-17 23:01:46] [config] exponential-smoothing: 0
[2023-07-17 23:01:46] [config] factor-weight: 1
[2023-07-17 23:01:46] [config] factors-combine: sum
[2023-07-17 23:01:46] [config] factors-dim-emb: 0
[2023-07-17 23:01:46] [config] gradient-checkpointing: false
[2023-07-17 23:01:46] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:46] [config] guided-alignment: none
[2023-07-17 23:01:46] [config] guided-alignment-cost: mse
[2023-07-17 23:01:46] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:46] [config] ignore-model-config: false
[2023-07-17 23:01:46] [config] input-types:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] interpolate-env-vars: false
[2023-07-17 23:01:46] [config] keep-best: false
[2023-07-17 23:01:46] [config] label-smoothing: 0
[2023-07-17 23:01:46] [config] layer-normalization: false
[2023-07-17 23:01:46] [config] learn-rate: 0.0001
[2023-07-17 23:01:46] [config] lemma-dependency: ""
[2023-07-17 23:01:46] [config] lemma-dim-emb: 0
[2023-07-17 23:01:46] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:46] [config] log-level: info
[2023-07-17 23:01:46] [config] log-time-zone: ""
[2023-07-17 23:01:46] [config] logical-epoch:
[2023-07-17 23:01:46] [config]   - 1e
[2023-07-17 23:01:46] [config]   - 0
[2023-07-17 23:01:46] [config] lr-decay: 0
[2023-07-17 23:01:46] [config] lr-decay-freq: 50000
[2023-07-17 23:01:46] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:46] [config]   - 0
[2023-07-17 23:01:46] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:46] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:46] [config] lr-decay-start:
[2023-07-17 23:01:46] [config]   - 10
[2023-07-17 23:01:46] [config]   - 1
[2023-07-17 23:01:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:46] [config] lr-report: false
[2023-07-17 23:01:46] [config] lr-warmup: 0
[2023-07-17 23:01:46] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:46] [config] lr-warmup-cycle: false
[2023-07-17 23:01:46] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:46] [config] max-length: 200
[2023-07-17 23:01:46] [config] max-length-crop: true
[2023-07-17 23:01:46] [config] max-length-factor: 3
[2023-07-17 23:01:46] [config] maxi-batch: 100
[2023-07-17 23:01:46] [config] maxi-batch-sort: trg
[2023-07-17 23:01:46] [config] mini-batch: 64
[2023-07-17 23:01:46] [config] mini-batch-fit: true
[2023-07-17 23:01:46] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:46] [config] mini-batch-round-up: true
[2023-07-17 23:01:46] [config] mini-batch-track-lr: false
[2023-07-17 23:01:46] [config] mini-batch-warmup: 0
[2023-07-17 23:01:46] [config] mini-batch-words: 0
[2023-07-17 23:01:46] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:46] [config] multi-loss-type: sum
[2023-07-17 23:01:46] [config] n-best: false
[2023-07-17 23:01:46] [config] no-nccl: false
[2023-07-17 23:01:46] [config] no-reload: false
[2023-07-17 23:01:46] [config] no-restore-corpus: false
[2023-07-17 23:01:46] [config] normalize: 0
[2023-07-17 23:01:46] [config] normalize-gradient: false
[2023-07-17 23:01:46] [config] num-devices: 0
[2023-07-17 23:01:46] [config] optimizer: adam
[2023-07-17 23:01:46] [config] optimizer-delay: 1
[2023-07-17 23:01:46] [config] optimizer-params:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] output-omit-bias: false
[2023-07-17 23:01:46] [config] overwrite: true
[2023-07-17 23:01:46] [config] precision:
[2023-07-17 23:01:46] [config]   - float16
[2023-07-17 23:01:46] [config]   - float32
[2023-07-17 23:01:46] [config] pretrained-model: ""
[2023-07-17 23:01:46] [config] quantize-biases: false
[2023-07-17 23:01:46] [config] quantize-bits: 0
[2023-07-17 23:01:46] [config] quantize-log-based: false
[2023-07-17 23:01:46] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:46] [config] quiet: false
[2023-07-17 23:01:46] [config] quiet-translation: true
[2023-07-17 23:01:46] [config] relative-paths: false
[2023-07-17 23:01:46] [config] right-left: false
[2023-07-17 23:01:46] [config] save-freq: 10000u
[2023-07-17 23:01:46] [config] seed: 1234
[2023-07-17 23:01:46] [config] sentencepiece-alphas:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:46] [config] sentencepiece-options: ""
[2023-07-17 23:01:46] [config] sharding: global
[2023-07-17 23:01:46] [config] shuffle: data
[2023-07-17 23:01:46] [config] shuffle-in-ram: false
[2023-07-17 23:01:46] [config] sigterm: save-and-exit
[2023-07-17 23:01:46] [config] skip: false
[2023-07-17 23:01:46] [config] sqlite: ""
[2023-07-17 23:01:46] [config] sqlite-drop: false
[2023-07-17 23:01:46] [config] sync-freq: 200u
[2023-07-17 23:01:46] [config] sync-sgd: false
[2023-07-17 23:01:46] [config] tempdir: /tmp
[2023-07-17 23:01:46] [config] tied-embeddings: false
[2023-07-17 23:01:46] [config] tied-embeddings-all: true
[2023-07-17 23:01:46] [config] tied-embeddings-src: false
[2023-07-17 23:01:46] [config] train-embedder-rank:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] train-sets:
[2023-07-17 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:46] [config] transformer-aan-activation: swish
[2023-07-17 23:01:46] [config] transformer-aan-depth: 2
[2023-07-17 23:01:46] [config] transformer-aan-nogate: false
[2023-07-17 23:01:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:46] [config] transformer-depth-scaling: false
[2023-07-17 23:01:46] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:46] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:46] [config] transformer-dropout: 0
[2023-07-17 23:01:46] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:46] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:46] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:46] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:46] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:46] [config] transformer-heads: 8
[2023-07-17 23:01:46] [config] transformer-no-projection: false
[2023-07-17 23:01:46] [config] transformer-pool: false
[2023-07-17 23:01:46] [config] transformer-postprocess: dan
[2023-07-17 23:01:46] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:46] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:46] [config] transformer-preprocess: ""
[2023-07-17 23:01:46] [config] transformer-tied-layers:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:46] [config] tsv: false
[2023-07-17 23:01:46] [config] tsv-fields: 0
[2023-07-17 23:01:46] [config] type: amun
[2023-07-17 23:01:46] [config] ulr: false
[2023-07-17 23:01:46] [config] ulr-dim-emb: 0
[2023-07-17 23:01:46] [config] ulr-dropout: 0
[2023-07-17 23:01:46] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:46] [config] ulr-query-vectors: ""
[2023-07-17 23:01:46] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:46] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:46] [config] unlikelihood-loss: false
[2023-07-17 23:01:46] [config] valid-freq: 50000000
[2023-07-17 23:01:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:46] [config] valid-max-length: 1000
[2023-07-17 23:01:46] [config] valid-metrics:
[2023-07-17 23:01:46] [config]   - cross-entropy
[2023-07-17 23:01:46] [config]   - translation
[2023-07-17 23:01:46] [config] valid-mini-batch: 32
[2023-07-17 23:01:46] [config] valid-reset-stalled: false
[2023-07-17 23:01:46] [config] valid-script-args:
[2023-07-17 23:01:46] [config]   []
[2023-07-17 23:01:46] [config] valid-script-path: ""
[2023-07-17 23:01:46] [config] valid-sets:
[2023-07-17 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:46] [config] vocabs:
[2023-07-17 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:46] [config] word-penalty: 0
[2023-07-17 23:01:46] [config] word-scores: false
[2023-07-17 23:01:46] [config] workspace: 5500
[2023-07-17 23:01:46] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:46] [training] Using single-device training
[2023-07-17 23:01:46] Synced seed 1234
[2023-07-17 23:01:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:46] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:46] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x56523f5c7177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x56523f5c7699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x56523f5ca92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x56523f5b97da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x56523f5ba0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x56523f60782e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x56523f61a79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x56523f4e4b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x56523f4052c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56523f3bcb9c]    main                                               + 0x3c
[0x7fbd195170b3]    __libc_start_main                                  + 0xf3
[0x56523f403cbe]    _start                                             + 0x2e

[2023-07-17 23:01:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:49] [marian] Running on node22.datos.cluster.uy as process 3822 with command line:
[2023-07-17 23:01:49] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:49] [config] after: 0e
[2023-07-17 23:01:49] [config] after-batches: 0
[2023-07-17 23:01:49] [config] after-epochs: 60
[2023-07-17 23:01:49] [config] all-caps-every: 0
[2023-07-17 23:01:49] [config] allow-unk: false
[2023-07-17 23:01:49] [config] authors: false
[2023-07-17 23:01:49] [config] beam-size: 12
[2023-07-17 23:01:49] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:49] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:49] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:49] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:49] [config] build-info: ""
[2023-07-17 23:01:49] [config] check-gradient-nan: false
[2023-07-17 23:01:49] [config] check-nan: false
[2023-07-17 23:01:49] [config] cite: false
[2023-07-17 23:01:49] [config] clip-norm: 1
[2023-07-17 23:01:49] [config] cost-scaling:
[2023-07-17 23:01:49] [config]   - 256.f
[2023-07-17 23:01:49] [config]   - 1000
[2023-07-17 23:01:49] [config]   - 2.f
[2023-07-17 23:01:49] [config]   - 256.f
[2023-07-17 23:01:49] [config] cost-type: ce-sum
[2023-07-17 23:01:49] [config] cpu-threads: 0
[2023-07-17 23:01:49] [config] data-threads: 8
[2023-07-17 23:01:49] [config] data-weighting: ""
[2023-07-17 23:01:49] [config] data-weighting-type: sentence
[2023-07-17 23:01:49] [config] dec-cell: gru
[2023-07-17 23:01:49] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:49] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:49] [config] dec-depth: 1
[2023-07-17 23:01:49] [config] devices:
[2023-07-17 23:01:49] [config]   - 0
[2023-07-17 23:01:49] [config] dim-emb: 512
[2023-07-17 23:01:49] [config] dim-rnn: 1024
[2023-07-17 23:01:49] [config] dim-vocabs:
[2023-07-17 23:01:49] [config]   - 16384
[2023-07-17 23:01:49] [config]   - 16384
[2023-07-17 23:01:49] [config] disp-first: 0
[2023-07-17 23:01:49] [config] disp-freq: 1000u
[2023-07-17 23:01:49] [config] disp-label-counts: true
[2023-07-17 23:01:49] [config] dropout-rnn: 0
[2023-07-17 23:01:49] [config] dropout-src: 0
[2023-07-17 23:01:49] [config] dropout-trg: 0
[2023-07-17 23:01:49] [config] dump-config: ""
[2023-07-17 23:01:49] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] early-stopping: 5
[2023-07-17 23:01:49] [config] early-stopping-on: first
[2023-07-17 23:01:49] [config] embedding-fix-src: false
[2023-07-17 23:01:49] [config] embedding-fix-trg: false
[2023-07-17 23:01:49] [config] embedding-normalization: false
[2023-07-17 23:01:49] [config] embedding-vectors:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] enc-cell: gru
[2023-07-17 23:01:49] [config] enc-cell-depth: 1
[2023-07-17 23:01:49] [config] enc-depth: 1
[2023-07-17 23:01:49] [config] enc-type: bidirectional
[2023-07-17 23:01:49] [config] english-title-case-every: 0
[2023-07-17 23:01:49] [config] exponential-smoothing: 0
[2023-07-17 23:01:49] [config] factor-weight: 1
[2023-07-17 23:01:49] [config] factors-combine: sum
[2023-07-17 23:01:49] [config] factors-dim-emb: 0
[2023-07-17 23:01:49] [config] gradient-checkpointing: false
[2023-07-17 23:01:49] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:49] [config] guided-alignment: none
[2023-07-17 23:01:49] [config] guided-alignment-cost: mse
[2023-07-17 23:01:49] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:49] [config] ignore-model-config: false
[2023-07-17 23:01:49] [config] input-types:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] interpolate-env-vars: false
[2023-07-17 23:01:49] [config] keep-best: false
[2023-07-17 23:01:49] [config] label-smoothing: 0
[2023-07-17 23:01:49] [config] layer-normalization: false
[2023-07-17 23:01:49] [config] learn-rate: 0.0001
[2023-07-17 23:01:49] [config] lemma-dependency: ""
[2023-07-17 23:01:49] [config] lemma-dim-emb: 0
[2023-07-17 23:01:49] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:49] [config] log-level: info
[2023-07-17 23:01:49] [config] log-time-zone: ""
[2023-07-17 23:01:49] [config] logical-epoch:
[2023-07-17 23:01:49] [config]   - 1e
[2023-07-17 23:01:49] [config]   - 0
[2023-07-17 23:01:49] [config] lr-decay: 0
[2023-07-17 23:01:49] [config] lr-decay-freq: 50000
[2023-07-17 23:01:49] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:49] [config]   - 0
[2023-07-17 23:01:49] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:49] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:49] [config] lr-decay-start:
[2023-07-17 23:01:49] [config]   - 10
[2023-07-17 23:01:49] [config]   - 1
[2023-07-17 23:01:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:49] [config] lr-report: false
[2023-07-17 23:01:49] [config] lr-warmup: 0
[2023-07-17 23:01:49] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:49] [config] lr-warmup-cycle: false
[2023-07-17 23:01:49] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:49] [config] max-length: 200
[2023-07-17 23:01:49] [config] max-length-crop: true
[2023-07-17 23:01:49] [config] max-length-factor: 3
[2023-07-17 23:01:49] [config] maxi-batch: 100
[2023-07-17 23:01:49] [config] maxi-batch-sort: trg
[2023-07-17 23:01:49] [config] mini-batch: 64
[2023-07-17 23:01:49] [config] mini-batch-fit: true
[2023-07-17 23:01:49] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:49] [config] mini-batch-round-up: true
[2023-07-17 23:01:49] [config] mini-batch-track-lr: false
[2023-07-17 23:01:49] [config] mini-batch-warmup: 0
[2023-07-17 23:01:49] [config] mini-batch-words: 0
[2023-07-17 23:01:49] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:49] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:49] [config] multi-loss-type: sum
[2023-07-17 23:01:49] [config] n-best: false
[2023-07-17 23:01:49] [config] no-nccl: false
[2023-07-17 23:01:49] [config] no-reload: false
[2023-07-17 23:01:49] [config] no-restore-corpus: false
[2023-07-17 23:01:49] [config] normalize: 0
[2023-07-17 23:01:49] [config] normalize-gradient: false
[2023-07-17 23:01:49] [config] num-devices: 0
[2023-07-17 23:01:49] [config] optimizer: adam
[2023-07-17 23:01:49] [config] optimizer-delay: 1
[2023-07-17 23:01:49] [config] optimizer-params:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] output-omit-bias: false
[2023-07-17 23:01:49] [config] overwrite: true
[2023-07-17 23:01:49] [config] precision:
[2023-07-17 23:01:49] [config]   - float16
[2023-07-17 23:01:49] [config]   - float32
[2023-07-17 23:01:49] [config] pretrained-model: ""
[2023-07-17 23:01:49] [config] quantize-biases: false
[2023-07-17 23:01:49] [config] quantize-bits: 0
[2023-07-17 23:01:49] [config] quantize-log-based: false
[2023-07-17 23:01:49] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:49] [config] quiet: false
[2023-07-17 23:01:49] [config] quiet-translation: true
[2023-07-17 23:01:49] [config] relative-paths: false
[2023-07-17 23:01:49] [config] right-left: false
[2023-07-17 23:01:49] [config] save-freq: 10000u
[2023-07-17 23:01:49] [config] seed: 1234
[2023-07-17 23:01:49] [config] sentencepiece-alphas:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:49] [config] sentencepiece-options: ""
[2023-07-17 23:01:49] [config] sharding: global
[2023-07-17 23:01:49] [config] shuffle: data
[2023-07-17 23:01:49] [config] shuffle-in-ram: false
[2023-07-17 23:01:49] [config] sigterm: save-and-exit
[2023-07-17 23:01:49] [config] skip: false
[2023-07-17 23:01:49] [config] sqlite: ""
[2023-07-17 23:01:49] [config] sqlite-drop: false
[2023-07-17 23:01:49] [config] sync-freq: 200u
[2023-07-17 23:01:49] [config] sync-sgd: false
[2023-07-17 23:01:49] [config] tempdir: /tmp
[2023-07-17 23:01:49] [config] tied-embeddings: false
[2023-07-17 23:01:49] [config] tied-embeddings-all: true
[2023-07-17 23:01:49] [config] tied-embeddings-src: false
[2023-07-17 23:01:49] [config] train-embedder-rank:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] train-sets:
[2023-07-17 23:01:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:49] [config] transformer-aan-activation: swish
[2023-07-17 23:01:49] [config] transformer-aan-depth: 2
[2023-07-17 23:01:49] [config] transformer-aan-nogate: false
[2023-07-17 23:01:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:49] [config] transformer-depth-scaling: false
[2023-07-17 23:01:49] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:49] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:49] [config] transformer-dropout: 0
[2023-07-17 23:01:49] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:49] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:49] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:49] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:49] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:49] [config] transformer-heads: 8
[2023-07-17 23:01:49] [config] transformer-no-projection: false
[2023-07-17 23:01:49] [config] transformer-pool: false
[2023-07-17 23:01:49] [config] transformer-postprocess: dan
[2023-07-17 23:01:49] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:49] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:49] [config] transformer-preprocess: ""
[2023-07-17 23:01:49] [config] transformer-tied-layers:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:49] [config] tsv: false
[2023-07-17 23:01:49] [config] tsv-fields: 0
[2023-07-17 23:01:49] [config] type: amun
[2023-07-17 23:01:49] [config] ulr: false
[2023-07-17 23:01:49] [config] ulr-dim-emb: 0
[2023-07-17 23:01:49] [config] ulr-dropout: 0
[2023-07-17 23:01:49] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:49] [config] ulr-query-vectors: ""
[2023-07-17 23:01:49] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:49] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:49] [config] unlikelihood-loss: false
[2023-07-17 23:01:49] [config] valid-freq: 50000000
[2023-07-17 23:01:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:49] [config] valid-max-length: 1000
[2023-07-17 23:01:49] [config] valid-metrics:
[2023-07-17 23:01:49] [config]   - cross-entropy
[2023-07-17 23:01:49] [config]   - translation
[2023-07-17 23:01:49] [config] valid-mini-batch: 32
[2023-07-17 23:01:49] [config] valid-reset-stalled: false
[2023-07-17 23:01:49] [config] valid-script-args:
[2023-07-17 23:01:49] [config]   []
[2023-07-17 23:01:49] [config] valid-script-path: ""
[2023-07-17 23:01:49] [config] valid-sets:
[2023-07-17 23:01:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:49] [config] vocabs:
[2023-07-17 23:01:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:49] [config] word-penalty: 0
[2023-07-17 23:01:49] [config] word-scores: false
[2023-07-17 23:01:49] [config] workspace: 5500
[2023-07-17 23:01:49] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:49] [training] Using single-device training
[2023-07-17 23:01:49] Synced seed 1234
[2023-07-17 23:01:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:49] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:49] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55ca68bee177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55ca68bee699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55ca68bf192f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55ca68be07da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55ca68be10f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55ca68c2e82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55ca68c4179d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55ca68b0bb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55ca68a2c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55ca689e3b9c]    main                                               + 0x3c
[0x7efc1aad20b3]    __libc_start_main                                  + 0xf3
[0x55ca68a2acbe]    _start                                             + 0x2e

[2023-07-17 23:01:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:51] [marian] Running on node22.datos.cluster.uy as process 3827 with command line:
[2023-07-17 23:01:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:51] [config] after: 0e
[2023-07-17 23:01:51] [config] after-batches: 0
[2023-07-17 23:01:51] [config] after-epochs: 70
[2023-07-17 23:01:51] [config] all-caps-every: 0
[2023-07-17 23:01:51] [config] allow-unk: false
[2023-07-17 23:01:51] [config] authors: false
[2023-07-17 23:01:51] [config] beam-size: 12
[2023-07-17 23:01:51] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:51] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:51] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:51] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:51] [config] build-info: ""
[2023-07-17 23:01:51] [config] check-gradient-nan: false
[2023-07-17 23:01:51] [config] check-nan: false
[2023-07-17 23:01:51] [config] cite: false
[2023-07-17 23:01:51] [config] clip-norm: 1
[2023-07-17 23:01:51] [config] cost-scaling:
[2023-07-17 23:01:51] [config]   - 256.f
[2023-07-17 23:01:51] [config]   - 1000
[2023-07-17 23:01:51] [config]   - 2.f
[2023-07-17 23:01:51] [config]   - 256.f
[2023-07-17 23:01:51] [config] cost-type: ce-sum
[2023-07-17 23:01:51] [config] cpu-threads: 0
[2023-07-17 23:01:51] [config] data-threads: 8
[2023-07-17 23:01:51] [config] data-weighting: ""
[2023-07-17 23:01:51] [config] data-weighting-type: sentence
[2023-07-17 23:01:51] [config] dec-cell: gru
[2023-07-17 23:01:51] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:51] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:51] [config] dec-depth: 1
[2023-07-17 23:01:51] [config] devices:
[2023-07-17 23:01:51] [config]   - 0
[2023-07-17 23:01:51] [config] dim-emb: 512
[2023-07-17 23:01:51] [config] dim-rnn: 1024
[2023-07-17 23:01:51] [config] dim-vocabs:
[2023-07-17 23:01:51] [config]   - 16384
[2023-07-17 23:01:51] [config]   - 16384
[2023-07-17 23:01:51] [config] disp-first: 0
[2023-07-17 23:01:51] [config] disp-freq: 1000u
[2023-07-17 23:01:51] [config] disp-label-counts: true
[2023-07-17 23:01:51] [config] dropout-rnn: 0
[2023-07-17 23:01:51] [config] dropout-src: 0
[2023-07-17 23:01:51] [config] dropout-trg: 0
[2023-07-17 23:01:51] [config] dump-config: ""
[2023-07-17 23:01:51] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] early-stopping: 5
[2023-07-17 23:01:51] [config] early-stopping-on: first
[2023-07-17 23:01:51] [config] embedding-fix-src: false
[2023-07-17 23:01:51] [config] embedding-fix-trg: false
[2023-07-17 23:01:51] [config] embedding-normalization: false
[2023-07-17 23:01:51] [config] embedding-vectors:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] enc-cell: gru
[2023-07-17 23:01:51] [config] enc-cell-depth: 1
[2023-07-17 23:01:51] [config] enc-depth: 1
[2023-07-17 23:01:51] [config] enc-type: bidirectional
[2023-07-17 23:01:51] [config] english-title-case-every: 0
[2023-07-17 23:01:51] [config] exponential-smoothing: 0
[2023-07-17 23:01:51] [config] factor-weight: 1
[2023-07-17 23:01:51] [config] factors-combine: sum
[2023-07-17 23:01:51] [config] factors-dim-emb: 0
[2023-07-17 23:01:51] [config] gradient-checkpointing: false
[2023-07-17 23:01:51] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:51] [config] guided-alignment: none
[2023-07-17 23:01:51] [config] guided-alignment-cost: mse
[2023-07-17 23:01:51] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:51] [config] ignore-model-config: false
[2023-07-17 23:01:51] [config] input-types:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] interpolate-env-vars: false
[2023-07-17 23:01:51] [config] keep-best: false
[2023-07-17 23:01:51] [config] label-smoothing: 0
[2023-07-17 23:01:51] [config] layer-normalization: false
[2023-07-17 23:01:51] [config] learn-rate: 0.0001
[2023-07-17 23:01:51] [config] lemma-dependency: ""
[2023-07-17 23:01:51] [config] lemma-dim-emb: 0
[2023-07-17 23:01:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:51] [config] log-level: info
[2023-07-17 23:01:51] [config] log-time-zone: ""
[2023-07-17 23:01:51] [config] logical-epoch:
[2023-07-17 23:01:51] [config]   - 1e
[2023-07-17 23:01:51] [config]   - 0
[2023-07-17 23:01:51] [config] lr-decay: 0
[2023-07-17 23:01:51] [config] lr-decay-freq: 50000
[2023-07-17 23:01:51] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:51] [config]   - 0
[2023-07-17 23:01:51] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:51] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:51] [config] lr-decay-start:
[2023-07-17 23:01:51] [config]   - 10
[2023-07-17 23:01:51] [config]   - 1
[2023-07-17 23:01:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:51] [config] lr-report: false
[2023-07-17 23:01:51] [config] lr-warmup: 0
[2023-07-17 23:01:51] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:51] [config] lr-warmup-cycle: false
[2023-07-17 23:01:51] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:51] [config] max-length: 200
[2023-07-17 23:01:51] [config] max-length-crop: true
[2023-07-17 23:01:51] [config] max-length-factor: 3
[2023-07-17 23:01:51] [config] maxi-batch: 100
[2023-07-17 23:01:51] [config] maxi-batch-sort: trg
[2023-07-17 23:01:51] [config] mini-batch: 64
[2023-07-17 23:01:51] [config] mini-batch-fit: true
[2023-07-17 23:01:51] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:51] [config] mini-batch-round-up: true
[2023-07-17 23:01:51] [config] mini-batch-track-lr: false
[2023-07-17 23:01:51] [config] mini-batch-warmup: 0
[2023-07-17 23:01:51] [config] mini-batch-words: 0
[2023-07-17 23:01:51] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:51] [config] multi-loss-type: sum
[2023-07-17 23:01:51] [config] n-best: false
[2023-07-17 23:01:51] [config] no-nccl: false
[2023-07-17 23:01:51] [config] no-reload: false
[2023-07-17 23:01:51] [config] no-restore-corpus: false
[2023-07-17 23:01:51] [config] normalize: 0
[2023-07-17 23:01:51] [config] normalize-gradient: false
[2023-07-17 23:01:51] [config] num-devices: 0
[2023-07-17 23:01:51] [config] optimizer: adam
[2023-07-17 23:01:51] [config] optimizer-delay: 1
[2023-07-17 23:01:51] [config] optimizer-params:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] output-omit-bias: false
[2023-07-17 23:01:51] [config] overwrite: true
[2023-07-17 23:01:51] [config] precision:
[2023-07-17 23:01:51] [config]   - float16
[2023-07-17 23:01:51] [config]   - float32
[2023-07-17 23:01:51] [config] pretrained-model: ""
[2023-07-17 23:01:51] [config] quantize-biases: false
[2023-07-17 23:01:51] [config] quantize-bits: 0
[2023-07-17 23:01:51] [config] quantize-log-based: false
[2023-07-17 23:01:51] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:51] [config] quiet: false
[2023-07-17 23:01:51] [config] quiet-translation: true
[2023-07-17 23:01:51] [config] relative-paths: false
[2023-07-17 23:01:51] [config] right-left: false
[2023-07-17 23:01:51] [config] save-freq: 10000u
[2023-07-17 23:01:51] [config] seed: 1234
[2023-07-17 23:01:51] [config] sentencepiece-alphas:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:51] [config] sentencepiece-options: ""
[2023-07-17 23:01:51] [config] sharding: global
[2023-07-17 23:01:51] [config] shuffle: data
[2023-07-17 23:01:51] [config] shuffle-in-ram: false
[2023-07-17 23:01:51] [config] sigterm: save-and-exit
[2023-07-17 23:01:51] [config] skip: false
[2023-07-17 23:01:51] [config] sqlite: ""
[2023-07-17 23:01:51] [config] sqlite-drop: false
[2023-07-17 23:01:51] [config] sync-freq: 200u
[2023-07-17 23:01:51] [config] sync-sgd: false
[2023-07-17 23:01:51] [config] tempdir: /tmp
[2023-07-17 23:01:51] [config] tied-embeddings: false
[2023-07-17 23:01:51] [config] tied-embeddings-all: true
[2023-07-17 23:01:51] [config] tied-embeddings-src: false
[2023-07-17 23:01:51] [config] train-embedder-rank:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] train-sets:
[2023-07-17 23:01:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:51] [config] transformer-aan-activation: swish
[2023-07-17 23:01:51] [config] transformer-aan-depth: 2
[2023-07-17 23:01:51] [config] transformer-aan-nogate: false
[2023-07-17 23:01:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:51] [config] transformer-depth-scaling: false
[2023-07-17 23:01:51] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:51] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:51] [config] transformer-dropout: 0
[2023-07-17 23:01:51] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:51] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:51] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:51] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:51] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:51] [config] transformer-heads: 8
[2023-07-17 23:01:51] [config] transformer-no-projection: false
[2023-07-17 23:01:51] [config] transformer-pool: false
[2023-07-17 23:01:51] [config] transformer-postprocess: dan
[2023-07-17 23:01:51] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:51] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:51] [config] transformer-preprocess: ""
[2023-07-17 23:01:51] [config] transformer-tied-layers:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:51] [config] tsv: false
[2023-07-17 23:01:51] [config] tsv-fields: 0
[2023-07-17 23:01:51] [config] type: amun
[2023-07-17 23:01:51] [config] ulr: false
[2023-07-17 23:01:51] [config] ulr-dim-emb: 0
[2023-07-17 23:01:51] [config] ulr-dropout: 0
[2023-07-17 23:01:51] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:51] [config] ulr-query-vectors: ""
[2023-07-17 23:01:51] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:51] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:51] [config] unlikelihood-loss: false
[2023-07-17 23:01:51] [config] valid-freq: 50000000
[2023-07-17 23:01:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:51] [config] valid-max-length: 1000
[2023-07-17 23:01:51] [config] valid-metrics:
[2023-07-17 23:01:51] [config]   - cross-entropy
[2023-07-17 23:01:51] [config]   - translation
[2023-07-17 23:01:51] [config] valid-mini-batch: 32
[2023-07-17 23:01:51] [config] valid-reset-stalled: false
[2023-07-17 23:01:51] [config] valid-script-args:
[2023-07-17 23:01:51] [config]   []
[2023-07-17 23:01:51] [config] valid-script-path: ""
[2023-07-17 23:01:51] [config] valid-sets:
[2023-07-17 23:01:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:51] [config] vocabs:
[2023-07-17 23:01:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:51] [config] word-penalty: 0
[2023-07-17 23:01:51] [config] word-scores: false
[2023-07-17 23:01:51] [config] workspace: 5500
[2023-07-17 23:01:51] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:51] [training] Using single-device training
[2023-07-17 23:01:51] Synced seed 1234
[2023-07-17 23:01:51] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:51] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:51] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x5558a514c177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x5558a514c699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x5558a514f92f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5558a513e7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5558a513f0f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x5558a518c82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x5558a519f79d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x5558a5069b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5558a4f8a2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5558a4f41b9c]    main                                               + 0x3c
[0x7fd7307230b3]    __libc_start_main                                  + 0xf3
[0x5558a4f88cbe]    _start                                             + 0x2e

[2023-07-17 23:01:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:54] [marian] Running on node22.datos.cluster.uy as process 3832 with command line:
[2023-07-17 23:01:54] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:54] [config] after: 0e
[2023-07-17 23:01:54] [config] after-batches: 0
[2023-07-17 23:01:54] [config] after-epochs: 80
[2023-07-17 23:01:54] [config] all-caps-every: 0
[2023-07-17 23:01:54] [config] allow-unk: false
[2023-07-17 23:01:54] [config] authors: false
[2023-07-17 23:01:54] [config] beam-size: 12
[2023-07-17 23:01:54] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:54] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:54] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:54] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:54] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:54] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:54] [config] build-info: ""
[2023-07-17 23:01:54] [config] check-gradient-nan: false
[2023-07-17 23:01:54] [config] check-nan: false
[2023-07-17 23:01:54] [config] cite: false
[2023-07-17 23:01:54] [config] clip-norm: 1
[2023-07-17 23:01:54] [config] cost-scaling:
[2023-07-17 23:01:54] [config]   - 256.f
[2023-07-17 23:01:54] [config]   - 1000
[2023-07-17 23:01:54] [config]   - 2.f
[2023-07-17 23:01:54] [config]   - 256.f
[2023-07-17 23:01:54] [config] cost-type: ce-sum
[2023-07-17 23:01:54] [config] cpu-threads: 0
[2023-07-17 23:01:54] [config] data-threads: 8
[2023-07-17 23:01:54] [config] data-weighting: ""
[2023-07-17 23:01:54] [config] data-weighting-type: sentence
[2023-07-17 23:01:54] [config] dec-cell: gru
[2023-07-17 23:01:54] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:54] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:54] [config] dec-depth: 1
[2023-07-17 23:01:54] [config] devices:
[2023-07-17 23:01:54] [config]   - 0
[2023-07-17 23:01:54] [config] dim-emb: 512
[2023-07-17 23:01:54] [config] dim-rnn: 1024
[2023-07-17 23:01:54] [config] dim-vocabs:
[2023-07-17 23:01:54] [config]   - 16384
[2023-07-17 23:01:54] [config]   - 16384
[2023-07-17 23:01:54] [config] disp-first: 0
[2023-07-17 23:01:54] [config] disp-freq: 1000u
[2023-07-17 23:01:54] [config] disp-label-counts: true
[2023-07-17 23:01:54] [config] dropout-rnn: 0
[2023-07-17 23:01:54] [config] dropout-src: 0
[2023-07-17 23:01:54] [config] dropout-trg: 0
[2023-07-17 23:01:54] [config] dump-config: ""
[2023-07-17 23:01:54] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] early-stopping: 5
[2023-07-17 23:01:54] [config] early-stopping-on: first
[2023-07-17 23:01:54] [config] embedding-fix-src: false
[2023-07-17 23:01:54] [config] embedding-fix-trg: false
[2023-07-17 23:01:54] [config] embedding-normalization: false
[2023-07-17 23:01:54] [config] embedding-vectors:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] enc-cell: gru
[2023-07-17 23:01:54] [config] enc-cell-depth: 1
[2023-07-17 23:01:54] [config] enc-depth: 1
[2023-07-17 23:01:54] [config] enc-type: bidirectional
[2023-07-17 23:01:54] [config] english-title-case-every: 0
[2023-07-17 23:01:54] [config] exponential-smoothing: 0
[2023-07-17 23:01:54] [config] factor-weight: 1
[2023-07-17 23:01:54] [config] factors-combine: sum
[2023-07-17 23:01:54] [config] factors-dim-emb: 0
[2023-07-17 23:01:54] [config] gradient-checkpointing: false
[2023-07-17 23:01:54] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:54] [config] guided-alignment: none
[2023-07-17 23:01:54] [config] guided-alignment-cost: mse
[2023-07-17 23:01:54] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:54] [config] ignore-model-config: false
[2023-07-17 23:01:54] [config] input-types:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] interpolate-env-vars: false
[2023-07-17 23:01:54] [config] keep-best: false
[2023-07-17 23:01:54] [config] label-smoothing: 0
[2023-07-17 23:01:54] [config] layer-normalization: false
[2023-07-17 23:01:54] [config] learn-rate: 0.0001
[2023-07-17 23:01:54] [config] lemma-dependency: ""
[2023-07-17 23:01:54] [config] lemma-dim-emb: 0
[2023-07-17 23:01:54] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:54] [config] log-level: info
[2023-07-17 23:01:54] [config] log-time-zone: ""
[2023-07-17 23:01:54] [config] logical-epoch:
[2023-07-17 23:01:54] [config]   - 1e
[2023-07-17 23:01:54] [config]   - 0
[2023-07-17 23:01:54] [config] lr-decay: 0
[2023-07-17 23:01:54] [config] lr-decay-freq: 50000
[2023-07-17 23:01:54] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:54] [config]   - 0
[2023-07-17 23:01:54] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:54] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:54] [config] lr-decay-start:
[2023-07-17 23:01:54] [config]   - 10
[2023-07-17 23:01:54] [config]   - 1
[2023-07-17 23:01:54] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:54] [config] lr-report: false
[2023-07-17 23:01:54] [config] lr-warmup: 0
[2023-07-17 23:01:54] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:54] [config] lr-warmup-cycle: false
[2023-07-17 23:01:54] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:54] [config] max-length: 200
[2023-07-17 23:01:54] [config] max-length-crop: true
[2023-07-17 23:01:54] [config] max-length-factor: 3
[2023-07-17 23:01:54] [config] maxi-batch: 100
[2023-07-17 23:01:54] [config] maxi-batch-sort: trg
[2023-07-17 23:01:54] [config] mini-batch: 64
[2023-07-17 23:01:54] [config] mini-batch-fit: true
[2023-07-17 23:01:54] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:54] [config] mini-batch-round-up: true
[2023-07-17 23:01:54] [config] mini-batch-track-lr: false
[2023-07-17 23:01:54] [config] mini-batch-warmup: 0
[2023-07-17 23:01:54] [config] mini-batch-words: 0
[2023-07-17 23:01:54] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:54] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:54] [config] multi-loss-type: sum
[2023-07-17 23:01:54] [config] n-best: false
[2023-07-17 23:01:54] [config] no-nccl: false
[2023-07-17 23:01:54] [config] no-reload: false
[2023-07-17 23:01:54] [config] no-restore-corpus: false
[2023-07-17 23:01:54] [config] normalize: 0
[2023-07-17 23:01:54] [config] normalize-gradient: false
[2023-07-17 23:01:54] [config] num-devices: 0
[2023-07-17 23:01:54] [config] optimizer: adam
[2023-07-17 23:01:54] [config] optimizer-delay: 1
[2023-07-17 23:01:54] [config] optimizer-params:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] output-omit-bias: false
[2023-07-17 23:01:54] [config] overwrite: true
[2023-07-17 23:01:54] [config] precision:
[2023-07-17 23:01:54] [config]   - float16
[2023-07-17 23:01:54] [config]   - float32
[2023-07-17 23:01:54] [config] pretrained-model: ""
[2023-07-17 23:01:54] [config] quantize-biases: false
[2023-07-17 23:01:54] [config] quantize-bits: 0
[2023-07-17 23:01:54] [config] quantize-log-based: false
[2023-07-17 23:01:54] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:54] [config] quiet: false
[2023-07-17 23:01:54] [config] quiet-translation: true
[2023-07-17 23:01:54] [config] relative-paths: false
[2023-07-17 23:01:54] [config] right-left: false
[2023-07-17 23:01:54] [config] save-freq: 10000u
[2023-07-17 23:01:54] [config] seed: 1234
[2023-07-17 23:01:54] [config] sentencepiece-alphas:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:54] [config] sentencepiece-options: ""
[2023-07-17 23:01:54] [config] sharding: global
[2023-07-17 23:01:54] [config] shuffle: data
[2023-07-17 23:01:54] [config] shuffle-in-ram: false
[2023-07-17 23:01:54] [config] sigterm: save-and-exit
[2023-07-17 23:01:54] [config] skip: false
[2023-07-17 23:01:54] [config] sqlite: ""
[2023-07-17 23:01:54] [config] sqlite-drop: false
[2023-07-17 23:01:54] [config] sync-freq: 200u
[2023-07-17 23:01:54] [config] sync-sgd: false
[2023-07-17 23:01:54] [config] tempdir: /tmp
[2023-07-17 23:01:54] [config] tied-embeddings: false
[2023-07-17 23:01:54] [config] tied-embeddings-all: true
[2023-07-17 23:01:54] [config] tied-embeddings-src: false
[2023-07-17 23:01:54] [config] train-embedder-rank:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] train-sets:
[2023-07-17 23:01:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:54] [config] transformer-aan-activation: swish
[2023-07-17 23:01:54] [config] transformer-aan-depth: 2
[2023-07-17 23:01:54] [config] transformer-aan-nogate: false
[2023-07-17 23:01:54] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:54] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:54] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:54] [config] transformer-depth-scaling: false
[2023-07-17 23:01:54] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:54] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:54] [config] transformer-dropout: 0
[2023-07-17 23:01:54] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:54] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:54] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:54] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:54] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:54] [config] transformer-heads: 8
[2023-07-17 23:01:54] [config] transformer-no-projection: false
[2023-07-17 23:01:54] [config] transformer-pool: false
[2023-07-17 23:01:54] [config] transformer-postprocess: dan
[2023-07-17 23:01:54] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:54] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:54] [config] transformer-preprocess: ""
[2023-07-17 23:01:54] [config] transformer-tied-layers:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:54] [config] tsv: false
[2023-07-17 23:01:54] [config] tsv-fields: 0
[2023-07-17 23:01:54] [config] type: amun
[2023-07-17 23:01:54] [config] ulr: false
[2023-07-17 23:01:54] [config] ulr-dim-emb: 0
[2023-07-17 23:01:54] [config] ulr-dropout: 0
[2023-07-17 23:01:54] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:54] [config] ulr-query-vectors: ""
[2023-07-17 23:01:54] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:54] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:54] [config] unlikelihood-loss: false
[2023-07-17 23:01:54] [config] valid-freq: 50000000
[2023-07-17 23:01:54] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:54] [config] valid-max-length: 1000
[2023-07-17 23:01:54] [config] valid-metrics:
[2023-07-17 23:01:54] [config]   - cross-entropy
[2023-07-17 23:01:54] [config]   - translation
[2023-07-17 23:01:54] [config] valid-mini-batch: 32
[2023-07-17 23:01:54] [config] valid-reset-stalled: false
[2023-07-17 23:01:54] [config] valid-script-args:
[2023-07-17 23:01:54] [config]   []
[2023-07-17 23:01:54] [config] valid-script-path: ""
[2023-07-17 23:01:54] [config] valid-sets:
[2023-07-17 23:01:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:54] [config] vocabs:
[2023-07-17 23:01:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:54] [config] word-penalty: 0
[2023-07-17 23:01:54] [config] word-scores: false
[2023-07-17 23:01:54] [config] workspace: 5500
[2023-07-17 23:01:54] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:54] [training] Using single-device training
[2023-07-17 23:01:54] Synced seed 1234
[2023-07-17 23:01:54] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:54] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:54] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x5625983e6177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x5625983e6699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x5625983e992f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5625983d87da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5625983d90f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x56259842682e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x56259843979d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x562598303b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5625982242c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5625981dbb9c]    main                                               + 0x3c
[0x7ff983a030b3]    __libc_start_main                                  + 0xf3
[0x562598222cbe]    _start                                             + 0x2e

[2023-07-17 23:01:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:56] [marian] Running on node22.datos.cluster.uy as process 3838 with command line:
[2023-07-17 23:01:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:56] [config] after: 0e
[2023-07-17 23:01:56] [config] after-batches: 0
[2023-07-17 23:01:56] [config] after-epochs: 90
[2023-07-17 23:01:56] [config] all-caps-every: 0
[2023-07-17 23:01:56] [config] allow-unk: false
[2023-07-17 23:01:56] [config] authors: false
[2023-07-17 23:01:56] [config] beam-size: 12
[2023-07-17 23:01:56] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:56] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:56] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:56] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:56] [config] build-info: ""
[2023-07-17 23:01:56] [config] check-gradient-nan: false
[2023-07-17 23:01:56] [config] check-nan: false
[2023-07-17 23:01:56] [config] cite: false
[2023-07-17 23:01:56] [config] clip-norm: 1
[2023-07-17 23:01:56] [config] cost-scaling:
[2023-07-17 23:01:56] [config]   - 256.f
[2023-07-17 23:01:56] [config]   - 1000
[2023-07-17 23:01:56] [config]   - 2.f
[2023-07-17 23:01:56] [config]   - 256.f
[2023-07-17 23:01:56] [config] cost-type: ce-sum
[2023-07-17 23:01:56] [config] cpu-threads: 0
[2023-07-17 23:01:56] [config] data-threads: 8
[2023-07-17 23:01:56] [config] data-weighting: ""
[2023-07-17 23:01:56] [config] data-weighting-type: sentence
[2023-07-17 23:01:56] [config] dec-cell: gru
[2023-07-17 23:01:56] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:56] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:56] [config] dec-depth: 1
[2023-07-17 23:01:56] [config] devices:
[2023-07-17 23:01:56] [config]   - 0
[2023-07-17 23:01:56] [config] dim-emb: 512
[2023-07-17 23:01:56] [config] dim-rnn: 1024
[2023-07-17 23:01:56] [config] dim-vocabs:
[2023-07-17 23:01:56] [config]   - 16384
[2023-07-17 23:01:56] [config]   - 16384
[2023-07-17 23:01:56] [config] disp-first: 0
[2023-07-17 23:01:56] [config] disp-freq: 1000u
[2023-07-17 23:01:56] [config] disp-label-counts: true
[2023-07-17 23:01:56] [config] dropout-rnn: 0
[2023-07-17 23:01:56] [config] dropout-src: 0
[2023-07-17 23:01:56] [config] dropout-trg: 0
[2023-07-17 23:01:56] [config] dump-config: ""
[2023-07-17 23:01:56] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] early-stopping: 5
[2023-07-17 23:01:56] [config] early-stopping-on: first
[2023-07-17 23:01:56] [config] embedding-fix-src: false
[2023-07-17 23:01:56] [config] embedding-fix-trg: false
[2023-07-17 23:01:56] [config] embedding-normalization: false
[2023-07-17 23:01:56] [config] embedding-vectors:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] enc-cell: gru
[2023-07-17 23:01:56] [config] enc-cell-depth: 1
[2023-07-17 23:01:56] [config] enc-depth: 1
[2023-07-17 23:01:56] [config] enc-type: bidirectional
[2023-07-17 23:01:56] [config] english-title-case-every: 0
[2023-07-17 23:01:56] [config] exponential-smoothing: 0
[2023-07-17 23:01:56] [config] factor-weight: 1
[2023-07-17 23:01:56] [config] factors-combine: sum
[2023-07-17 23:01:56] [config] factors-dim-emb: 0
[2023-07-17 23:01:56] [config] gradient-checkpointing: false
[2023-07-17 23:01:56] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:56] [config] guided-alignment: none
[2023-07-17 23:01:56] [config] guided-alignment-cost: mse
[2023-07-17 23:01:56] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:56] [config] ignore-model-config: false
[2023-07-17 23:01:56] [config] input-types:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] interpolate-env-vars: false
[2023-07-17 23:01:56] [config] keep-best: false
[2023-07-17 23:01:56] [config] label-smoothing: 0
[2023-07-17 23:01:56] [config] layer-normalization: false
[2023-07-17 23:01:56] [config] learn-rate: 0.0001
[2023-07-17 23:01:56] [config] lemma-dependency: ""
[2023-07-17 23:01:56] [config] lemma-dim-emb: 0
[2023-07-17 23:01:56] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:56] [config] log-level: info
[2023-07-17 23:01:56] [config] log-time-zone: ""
[2023-07-17 23:01:56] [config] logical-epoch:
[2023-07-17 23:01:56] [config]   - 1e
[2023-07-17 23:01:56] [config]   - 0
[2023-07-17 23:01:56] [config] lr-decay: 0
[2023-07-17 23:01:56] [config] lr-decay-freq: 50000
[2023-07-17 23:01:56] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:56] [config]   - 0
[2023-07-17 23:01:56] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:56] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:56] [config] lr-decay-start:
[2023-07-17 23:01:56] [config]   - 10
[2023-07-17 23:01:56] [config]   - 1
[2023-07-17 23:01:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:56] [config] lr-report: false
[2023-07-17 23:01:56] [config] lr-warmup: 0
[2023-07-17 23:01:56] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:56] [config] lr-warmup-cycle: false
[2023-07-17 23:01:56] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:56] [config] max-length: 200
[2023-07-17 23:01:56] [config] max-length-crop: true
[2023-07-17 23:01:56] [config] max-length-factor: 3
[2023-07-17 23:01:56] [config] maxi-batch: 100
[2023-07-17 23:01:56] [config] maxi-batch-sort: trg
[2023-07-17 23:01:56] [config] mini-batch: 64
[2023-07-17 23:01:56] [config] mini-batch-fit: true
[2023-07-17 23:01:56] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:56] [config] mini-batch-round-up: true
[2023-07-17 23:01:56] [config] mini-batch-track-lr: false
[2023-07-17 23:01:56] [config] mini-batch-warmup: 0
[2023-07-17 23:01:56] [config] mini-batch-words: 0
[2023-07-17 23:01:56] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:56] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:56] [config] multi-loss-type: sum
[2023-07-17 23:01:56] [config] n-best: false
[2023-07-17 23:01:56] [config] no-nccl: false
[2023-07-17 23:01:56] [config] no-reload: false
[2023-07-17 23:01:56] [config] no-restore-corpus: false
[2023-07-17 23:01:56] [config] normalize: 0
[2023-07-17 23:01:56] [config] normalize-gradient: false
[2023-07-17 23:01:56] [config] num-devices: 0
[2023-07-17 23:01:56] [config] optimizer: adam
[2023-07-17 23:01:56] [config] optimizer-delay: 1
[2023-07-17 23:01:56] [config] optimizer-params:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] output-omit-bias: false
[2023-07-17 23:01:56] [config] overwrite: true
[2023-07-17 23:01:56] [config] precision:
[2023-07-17 23:01:56] [config]   - float16
[2023-07-17 23:01:56] [config]   - float32
[2023-07-17 23:01:56] [config] pretrained-model: ""
[2023-07-17 23:01:56] [config] quantize-biases: false
[2023-07-17 23:01:56] [config] quantize-bits: 0
[2023-07-17 23:01:56] [config] quantize-log-based: false
[2023-07-17 23:01:56] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:56] [config] quiet: false
[2023-07-17 23:01:56] [config] quiet-translation: true
[2023-07-17 23:01:56] [config] relative-paths: false
[2023-07-17 23:01:56] [config] right-left: false
[2023-07-17 23:01:56] [config] save-freq: 10000u
[2023-07-17 23:01:56] [config] seed: 1234
[2023-07-17 23:01:56] [config] sentencepiece-alphas:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:56] [config] sentencepiece-options: ""
[2023-07-17 23:01:56] [config] sharding: global
[2023-07-17 23:01:56] [config] shuffle: data
[2023-07-17 23:01:56] [config] shuffle-in-ram: false
[2023-07-17 23:01:56] [config] sigterm: save-and-exit
[2023-07-17 23:01:56] [config] skip: false
[2023-07-17 23:01:56] [config] sqlite: ""
[2023-07-17 23:01:56] [config] sqlite-drop: false
[2023-07-17 23:01:56] [config] sync-freq: 200u
[2023-07-17 23:01:56] [config] sync-sgd: false
[2023-07-17 23:01:56] [config] tempdir: /tmp
[2023-07-17 23:01:56] [config] tied-embeddings: false
[2023-07-17 23:01:56] [config] tied-embeddings-all: true
[2023-07-17 23:01:56] [config] tied-embeddings-src: false
[2023-07-17 23:01:56] [config] train-embedder-rank:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] train-sets:
[2023-07-17 23:01:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:56] [config] transformer-aan-activation: swish
[2023-07-17 23:01:56] [config] transformer-aan-depth: 2
[2023-07-17 23:01:56] [config] transformer-aan-nogate: false
[2023-07-17 23:01:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:56] [config] transformer-depth-scaling: false
[2023-07-17 23:01:56] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:56] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:56] [config] transformer-dropout: 0
[2023-07-17 23:01:56] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:56] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:56] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:56] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:56] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:56] [config] transformer-heads: 8
[2023-07-17 23:01:56] [config] transformer-no-projection: false
[2023-07-17 23:01:56] [config] transformer-pool: false
[2023-07-17 23:01:56] [config] transformer-postprocess: dan
[2023-07-17 23:01:56] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:56] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:56] [config] transformer-preprocess: ""
[2023-07-17 23:01:56] [config] transformer-tied-layers:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:56] [config] tsv: false
[2023-07-17 23:01:56] [config] tsv-fields: 0
[2023-07-17 23:01:56] [config] type: amun
[2023-07-17 23:01:56] [config] ulr: false
[2023-07-17 23:01:56] [config] ulr-dim-emb: 0
[2023-07-17 23:01:56] [config] ulr-dropout: 0
[2023-07-17 23:01:56] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:56] [config] ulr-query-vectors: ""
[2023-07-17 23:01:56] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:56] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:56] [config] unlikelihood-loss: false
[2023-07-17 23:01:56] [config] valid-freq: 50000000
[2023-07-17 23:01:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:56] [config] valid-max-length: 1000
[2023-07-17 23:01:56] [config] valid-metrics:
[2023-07-17 23:01:56] [config]   - cross-entropy
[2023-07-17 23:01:56] [config]   - translation
[2023-07-17 23:01:56] [config] valid-mini-batch: 32
[2023-07-17 23:01:56] [config] valid-reset-stalled: false
[2023-07-17 23:01:56] [config] valid-script-args:
[2023-07-17 23:01:56] [config]   []
[2023-07-17 23:01:56] [config] valid-script-path: ""
[2023-07-17 23:01:56] [config] valid-sets:
[2023-07-17 23:01:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:56] [config] vocabs:
[2023-07-17 23:01:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:56] [config] word-penalty: 0
[2023-07-17 23:01:56] [config] word-scores: false
[2023-07-17 23:01:56] [config] workspace: 5500
[2023-07-17 23:01:56] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:56] [training] Using single-device training
[2023-07-17 23:01:57] Synced seed 1234
[2023-07-17 23:01:57] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:57] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:57] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x5632917a0177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x5632917a0699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x5632917a392f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x5632917927da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x5632917930f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x5632917e082e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x5632917f379d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x5632916bdb7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x5632915de2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563291595b9c]    main                                               + 0x3c
[0x7efdbaaa10b3]    __libc_start_main                                  + 0xf3
[0x5632915dccbe]    _start                                             + 0x2e

[2023-07-17 23:01:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:59] [marian] Running on node22.datos.cluster.uy as process 3843 with command line:
[2023-07-17 23:01:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:01:59] [config] after: 0e
[2023-07-17 23:01:59] [config] after-batches: 0
[2023-07-17 23:01:59] [config] after-epochs: 100
[2023-07-17 23:01:59] [config] all-caps-every: 0
[2023-07-17 23:01:59] [config] allow-unk: false
[2023-07-17 23:01:59] [config] authors: false
[2023-07-17 23:01:59] [config] beam-size: 12
[2023-07-17 23:01:59] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:01:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:01:59] [config] bert-masking-fraction: 0.15
[2023-07-17 23:01:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:01:59] [config] bert-train-type-embeddings: true
[2023-07-17 23:01:59] [config] bert-type-vocab-size: 2
[2023-07-17 23:01:59] [config] build-info: ""
[2023-07-17 23:01:59] [config] check-gradient-nan: false
[2023-07-17 23:01:59] [config] check-nan: false
[2023-07-17 23:01:59] [config] cite: false
[2023-07-17 23:01:59] [config] clip-norm: 1
[2023-07-17 23:01:59] [config] cost-scaling:
[2023-07-17 23:01:59] [config]   - 256.f
[2023-07-17 23:01:59] [config]   - 1000
[2023-07-17 23:01:59] [config]   - 2.f
[2023-07-17 23:01:59] [config]   - 256.f
[2023-07-17 23:01:59] [config] cost-type: ce-sum
[2023-07-17 23:01:59] [config] cpu-threads: 0
[2023-07-17 23:01:59] [config] data-threads: 8
[2023-07-17 23:01:59] [config] data-weighting: ""
[2023-07-17 23:01:59] [config] data-weighting-type: sentence
[2023-07-17 23:01:59] [config] dec-cell: gru
[2023-07-17 23:01:59] [config] dec-cell-base-depth: 2
[2023-07-17 23:01:59] [config] dec-cell-high-depth: 1
[2023-07-17 23:01:59] [config] dec-depth: 1
[2023-07-17 23:01:59] [config] devices:
[2023-07-17 23:01:59] [config]   - 0
[2023-07-17 23:01:59] [config] dim-emb: 512
[2023-07-17 23:01:59] [config] dim-rnn: 1024
[2023-07-17 23:01:59] [config] dim-vocabs:
[2023-07-17 23:01:59] [config]   - 16384
[2023-07-17 23:01:59] [config]   - 16384
[2023-07-17 23:01:59] [config] disp-first: 0
[2023-07-17 23:01:59] [config] disp-freq: 1000u
[2023-07-17 23:01:59] [config] disp-label-counts: true
[2023-07-17 23:01:59] [config] dropout-rnn: 0
[2023-07-17 23:01:59] [config] dropout-src: 0
[2023-07-17 23:01:59] [config] dropout-trg: 0
[2023-07-17 23:01:59] [config] dump-config: ""
[2023-07-17 23:01:59] [config] dynamic-gradient-scaling:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] early-stopping: 5
[2023-07-17 23:01:59] [config] early-stopping-on: first
[2023-07-17 23:01:59] [config] embedding-fix-src: false
[2023-07-17 23:01:59] [config] embedding-fix-trg: false
[2023-07-17 23:01:59] [config] embedding-normalization: false
[2023-07-17 23:01:59] [config] embedding-vectors:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] enc-cell: gru
[2023-07-17 23:01:59] [config] enc-cell-depth: 1
[2023-07-17 23:01:59] [config] enc-depth: 1
[2023-07-17 23:01:59] [config] enc-type: bidirectional
[2023-07-17 23:01:59] [config] english-title-case-every: 0
[2023-07-17 23:01:59] [config] exponential-smoothing: 0
[2023-07-17 23:01:59] [config] factor-weight: 1
[2023-07-17 23:01:59] [config] factors-combine: sum
[2023-07-17 23:01:59] [config] factors-dim-emb: 0
[2023-07-17 23:01:59] [config] gradient-checkpointing: false
[2023-07-17 23:01:59] [config] gradient-norm-average-window: 100
[2023-07-17 23:01:59] [config] guided-alignment: none
[2023-07-17 23:01:59] [config] guided-alignment-cost: mse
[2023-07-17 23:01:59] [config] guided-alignment-weight: 0.1
[2023-07-17 23:01:59] [config] ignore-model-config: false
[2023-07-17 23:01:59] [config] input-types:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] interpolate-env-vars: false
[2023-07-17 23:01:59] [config] keep-best: false
[2023-07-17 23:01:59] [config] label-smoothing: 0
[2023-07-17 23:01:59] [config] layer-normalization: false
[2023-07-17 23:01:59] [config] learn-rate: 0.0001
[2023-07-17 23:01:59] [config] lemma-dependency: ""
[2023-07-17 23:01:59] [config] lemma-dim-emb: 0
[2023-07-17 23:01:59] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:59] [config] log-level: info
[2023-07-17 23:01:59] [config] log-time-zone: ""
[2023-07-17 23:01:59] [config] logical-epoch:
[2023-07-17 23:01:59] [config]   - 1e
[2023-07-17 23:01:59] [config]   - 0
[2023-07-17 23:01:59] [config] lr-decay: 0
[2023-07-17 23:01:59] [config] lr-decay-freq: 50000
[2023-07-17 23:01:59] [config] lr-decay-inv-sqrt:
[2023-07-17 23:01:59] [config]   - 0
[2023-07-17 23:01:59] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:01:59] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:01:59] [config] lr-decay-start:
[2023-07-17 23:01:59] [config]   - 10
[2023-07-17 23:01:59] [config]   - 1
[2023-07-17 23:01:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:01:59] [config] lr-report: false
[2023-07-17 23:01:59] [config] lr-warmup: 0
[2023-07-17 23:01:59] [config] lr-warmup-at-reload: false
[2023-07-17 23:01:59] [config] lr-warmup-cycle: false
[2023-07-17 23:01:59] [config] lr-warmup-start-rate: 0
[2023-07-17 23:01:59] [config] max-length: 200
[2023-07-17 23:01:59] [config] max-length-crop: true
[2023-07-17 23:01:59] [config] max-length-factor: 3
[2023-07-17 23:01:59] [config] maxi-batch: 100
[2023-07-17 23:01:59] [config] maxi-batch-sort: trg
[2023-07-17 23:01:59] [config] mini-batch: 64
[2023-07-17 23:01:59] [config] mini-batch-fit: true
[2023-07-17 23:01:59] [config] mini-batch-fit-step: 10
[2023-07-17 23:01:59] [config] mini-batch-round-up: true
[2023-07-17 23:01:59] [config] mini-batch-track-lr: false
[2023-07-17 23:01:59] [config] mini-batch-warmup: 0
[2023-07-17 23:01:59] [config] mini-batch-words: 0
[2023-07-17 23:01:59] [config] mini-batch-words-ref: 0
[2023-07-17 23:01:59] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:01:59] [config] multi-loss-type: sum
[2023-07-17 23:01:59] [config] n-best: false
[2023-07-17 23:01:59] [config] no-nccl: false
[2023-07-17 23:01:59] [config] no-reload: false
[2023-07-17 23:01:59] [config] no-restore-corpus: false
[2023-07-17 23:01:59] [config] normalize: 0
[2023-07-17 23:01:59] [config] normalize-gradient: false
[2023-07-17 23:01:59] [config] num-devices: 0
[2023-07-17 23:01:59] [config] optimizer: adam
[2023-07-17 23:01:59] [config] optimizer-delay: 1
[2023-07-17 23:01:59] [config] optimizer-params:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] output-omit-bias: false
[2023-07-17 23:01:59] [config] overwrite: true
[2023-07-17 23:01:59] [config] precision:
[2023-07-17 23:01:59] [config]   - float16
[2023-07-17 23:01:59] [config]   - float32
[2023-07-17 23:01:59] [config] pretrained-model: ""
[2023-07-17 23:01:59] [config] quantize-biases: false
[2023-07-17 23:01:59] [config] quantize-bits: 0
[2023-07-17 23:01:59] [config] quantize-log-based: false
[2023-07-17 23:01:59] [config] quantize-optimization-steps: 0
[2023-07-17 23:01:59] [config] quiet: false
[2023-07-17 23:01:59] [config] quiet-translation: true
[2023-07-17 23:01:59] [config] relative-paths: false
[2023-07-17 23:01:59] [config] right-left: false
[2023-07-17 23:01:59] [config] save-freq: 10000u
[2023-07-17 23:01:59] [config] seed: 1234
[2023-07-17 23:01:59] [config] sentencepiece-alphas:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:01:59] [config] sentencepiece-options: ""
[2023-07-17 23:01:59] [config] sharding: global
[2023-07-17 23:01:59] [config] shuffle: data
[2023-07-17 23:01:59] [config] shuffle-in-ram: false
[2023-07-17 23:01:59] [config] sigterm: save-and-exit
[2023-07-17 23:01:59] [config] skip: false
[2023-07-17 23:01:59] [config] sqlite: ""
[2023-07-17 23:01:59] [config] sqlite-drop: false
[2023-07-17 23:01:59] [config] sync-freq: 200u
[2023-07-17 23:01:59] [config] sync-sgd: false
[2023-07-17 23:01:59] [config] tempdir: /tmp
[2023-07-17 23:01:59] [config] tied-embeddings: false
[2023-07-17 23:01:59] [config] tied-embeddings-all: true
[2023-07-17 23:01:59] [config] tied-embeddings-src: false
[2023-07-17 23:01:59] [config] train-embedder-rank:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] train-sets:
[2023-07-17 23:01:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:01:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:01:59] [config] transformer-aan-activation: swish
[2023-07-17 23:01:59] [config] transformer-aan-depth: 2
[2023-07-17 23:01:59] [config] transformer-aan-nogate: false
[2023-07-17 23:01:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:01:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:01:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:01:59] [config] transformer-depth-scaling: false
[2023-07-17 23:01:59] [config] transformer-dim-aan: 2048
[2023-07-17 23:01:59] [config] transformer-dim-ffn: 2048
[2023-07-17 23:01:59] [config] transformer-dropout: 0
[2023-07-17 23:01:59] [config] transformer-dropout-attention: 0
[2023-07-17 23:01:59] [config] transformer-dropout-ffn: 0
[2023-07-17 23:01:59] [config] transformer-ffn-activation: swish
[2023-07-17 23:01:59] [config] transformer-ffn-depth: 2
[2023-07-17 23:01:59] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:01:59] [config] transformer-heads: 8
[2023-07-17 23:01:59] [config] transformer-no-projection: false
[2023-07-17 23:01:59] [config] transformer-pool: false
[2023-07-17 23:01:59] [config] transformer-postprocess: dan
[2023-07-17 23:01:59] [config] transformer-postprocess-emb: d
[2023-07-17 23:01:59] [config] transformer-postprocess-top: ""
[2023-07-17 23:01:59] [config] transformer-preprocess: ""
[2023-07-17 23:01:59] [config] transformer-tied-layers:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] transformer-train-position-embeddings: false
[2023-07-17 23:01:59] [config] tsv: false
[2023-07-17 23:01:59] [config] tsv-fields: 0
[2023-07-17 23:01:59] [config] type: amun
[2023-07-17 23:01:59] [config] ulr: false
[2023-07-17 23:01:59] [config] ulr-dim-emb: 0
[2023-07-17 23:01:59] [config] ulr-dropout: 0
[2023-07-17 23:01:59] [config] ulr-keys-vectors: ""
[2023-07-17 23:01:59] [config] ulr-query-vectors: ""
[2023-07-17 23:01:59] [config] ulr-softmax-temperature: 1
[2023-07-17 23:01:59] [config] ulr-trainable-transformation: false
[2023-07-17 23:01:59] [config] unlikelihood-loss: false
[2023-07-17 23:01:59] [config] valid-freq: 50000000
[2023-07-17 23:01:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:01:59] [config] valid-max-length: 1000
[2023-07-17 23:01:59] [config] valid-metrics:
[2023-07-17 23:01:59] [config]   - cross-entropy
[2023-07-17 23:01:59] [config]   - translation
[2023-07-17 23:01:59] [config] valid-mini-batch: 32
[2023-07-17 23:01:59] [config] valid-reset-stalled: false
[2023-07-17 23:01:59] [config] valid-script-args:
[2023-07-17 23:01:59] [config]   []
[2023-07-17 23:01:59] [config] valid-script-path: ""
[2023-07-17 23:01:59] [config] valid-sets:
[2023-07-17 23:01:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:01:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:01:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:01:59] [config] vocabs:
[2023-07-17 23:01:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:01:59] [config] word-penalty: 0
[2023-07-17 23:01:59] [config] word-scores: false
[2023-07-17 23:01:59] [config] workspace: 5500
[2023-07-17 23:01:59] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:01:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:01:59] [training] Using single-device training
[2023-07-17 23:01:59] Synced seed 1234
[2023-07-17 23:01:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:01:59] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:01:59] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x55ad5292d177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x55ad5292d699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x55ad5293092f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x55ad5291f7da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x55ad529200f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x55ad5296d82e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x55ad5298079d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x55ad5284ab7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x55ad5276b2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55ad52722b9c]    main                                               + 0x3c
[0x7f6cca70d0b3]    __libc_start_main                                  + 0xf3
[0x55ad52769cbe]    _start                                             + 0x2e

[2023-07-17 23:02:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:02:02] [marian] Running on node22.datos.cluster.uy as process 3848 with command line:
[2023-07-17 23:02:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:02:02] [config] after: 0e
[2023-07-17 23:02:02] [config] after-batches: 0
[2023-07-17 23:02:02] [config] after-epochs: 110
[2023-07-17 23:02:02] [config] all-caps-every: 0
[2023-07-17 23:02:02] [config] allow-unk: false
[2023-07-17 23:02:02] [config] authors: false
[2023-07-17 23:02:02] [config] beam-size: 12
[2023-07-17 23:02:02] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:02:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:02:02] [config] bert-masking-fraction: 0.15
[2023-07-17 23:02:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:02:02] [config] bert-train-type-embeddings: true
[2023-07-17 23:02:02] [config] bert-type-vocab-size: 2
[2023-07-17 23:02:02] [config] build-info: ""
[2023-07-17 23:02:02] [config] check-gradient-nan: false
[2023-07-17 23:02:02] [config] check-nan: false
[2023-07-17 23:02:02] [config] cite: false
[2023-07-17 23:02:02] [config] clip-norm: 1
[2023-07-17 23:02:02] [config] cost-scaling:
[2023-07-17 23:02:02] [config]   - 256.f
[2023-07-17 23:02:02] [config]   - 1000
[2023-07-17 23:02:02] [config]   - 2.f
[2023-07-17 23:02:02] [config]   - 256.f
[2023-07-17 23:02:02] [config] cost-type: ce-sum
[2023-07-17 23:02:02] [config] cpu-threads: 0
[2023-07-17 23:02:02] [config] data-threads: 8
[2023-07-17 23:02:02] [config] data-weighting: ""
[2023-07-17 23:02:02] [config] data-weighting-type: sentence
[2023-07-17 23:02:02] [config] dec-cell: gru
[2023-07-17 23:02:02] [config] dec-cell-base-depth: 2
[2023-07-17 23:02:02] [config] dec-cell-high-depth: 1
[2023-07-17 23:02:02] [config] dec-depth: 1
[2023-07-17 23:02:02] [config] devices:
[2023-07-17 23:02:02] [config]   - 0
[2023-07-17 23:02:02] [config] dim-emb: 512
[2023-07-17 23:02:02] [config] dim-rnn: 1024
[2023-07-17 23:02:02] [config] dim-vocabs:
[2023-07-17 23:02:02] [config]   - 16384
[2023-07-17 23:02:02] [config]   - 16384
[2023-07-17 23:02:02] [config] disp-first: 0
[2023-07-17 23:02:02] [config] disp-freq: 1000u
[2023-07-17 23:02:02] [config] disp-label-counts: true
[2023-07-17 23:02:02] [config] dropout-rnn: 0
[2023-07-17 23:02:02] [config] dropout-src: 0
[2023-07-17 23:02:02] [config] dropout-trg: 0
[2023-07-17 23:02:02] [config] dump-config: ""
[2023-07-17 23:02:02] [config] dynamic-gradient-scaling:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] early-stopping: 5
[2023-07-17 23:02:02] [config] early-stopping-on: first
[2023-07-17 23:02:02] [config] embedding-fix-src: false
[2023-07-17 23:02:02] [config] embedding-fix-trg: false
[2023-07-17 23:02:02] [config] embedding-normalization: false
[2023-07-17 23:02:02] [config] embedding-vectors:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] enc-cell: gru
[2023-07-17 23:02:02] [config] enc-cell-depth: 1
[2023-07-17 23:02:02] [config] enc-depth: 1
[2023-07-17 23:02:02] [config] enc-type: bidirectional
[2023-07-17 23:02:02] [config] english-title-case-every: 0
[2023-07-17 23:02:02] [config] exponential-smoothing: 0
[2023-07-17 23:02:02] [config] factor-weight: 1
[2023-07-17 23:02:02] [config] factors-combine: sum
[2023-07-17 23:02:02] [config] factors-dim-emb: 0
[2023-07-17 23:02:02] [config] gradient-checkpointing: false
[2023-07-17 23:02:02] [config] gradient-norm-average-window: 100
[2023-07-17 23:02:02] [config] guided-alignment: none
[2023-07-17 23:02:02] [config] guided-alignment-cost: mse
[2023-07-17 23:02:02] [config] guided-alignment-weight: 0.1
[2023-07-17 23:02:02] [config] ignore-model-config: false
[2023-07-17 23:02:02] [config] input-types:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] interpolate-env-vars: false
[2023-07-17 23:02:02] [config] keep-best: false
[2023-07-17 23:02:02] [config] label-smoothing: 0
[2023-07-17 23:02:02] [config] layer-normalization: false
[2023-07-17 23:02:02] [config] learn-rate: 0.0001
[2023-07-17 23:02:02] [config] lemma-dependency: ""
[2023-07-17 23:02:02] [config] lemma-dim-emb: 0
[2023-07-17 23:02:02] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:02:02] [config] log-level: info
[2023-07-17 23:02:02] [config] log-time-zone: ""
[2023-07-17 23:02:02] [config] logical-epoch:
[2023-07-17 23:02:02] [config]   - 1e
[2023-07-17 23:02:02] [config]   - 0
[2023-07-17 23:02:02] [config] lr-decay: 0
[2023-07-17 23:02:02] [config] lr-decay-freq: 50000
[2023-07-17 23:02:02] [config] lr-decay-inv-sqrt:
[2023-07-17 23:02:02] [config]   - 0
[2023-07-17 23:02:02] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:02:02] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:02:02] [config] lr-decay-start:
[2023-07-17 23:02:02] [config]   - 10
[2023-07-17 23:02:02] [config]   - 1
[2023-07-17 23:02:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:02:02] [config] lr-report: false
[2023-07-17 23:02:02] [config] lr-warmup: 0
[2023-07-17 23:02:02] [config] lr-warmup-at-reload: false
[2023-07-17 23:02:02] [config] lr-warmup-cycle: false
[2023-07-17 23:02:02] [config] lr-warmup-start-rate: 0
[2023-07-17 23:02:02] [config] max-length: 200
[2023-07-17 23:02:02] [config] max-length-crop: true
[2023-07-17 23:02:02] [config] max-length-factor: 3
[2023-07-17 23:02:02] [config] maxi-batch: 100
[2023-07-17 23:02:02] [config] maxi-batch-sort: trg
[2023-07-17 23:02:02] [config] mini-batch: 64
[2023-07-17 23:02:02] [config] mini-batch-fit: true
[2023-07-17 23:02:02] [config] mini-batch-fit-step: 10
[2023-07-17 23:02:02] [config] mini-batch-round-up: true
[2023-07-17 23:02:02] [config] mini-batch-track-lr: false
[2023-07-17 23:02:02] [config] mini-batch-warmup: 0
[2023-07-17 23:02:02] [config] mini-batch-words: 0
[2023-07-17 23:02:02] [config] mini-batch-words-ref: 0
[2023-07-17 23:02:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:02:02] [config] multi-loss-type: sum
[2023-07-17 23:02:02] [config] n-best: false
[2023-07-17 23:02:02] [config] no-nccl: false
[2023-07-17 23:02:02] [config] no-reload: false
[2023-07-17 23:02:02] [config] no-restore-corpus: false
[2023-07-17 23:02:02] [config] normalize: 0
[2023-07-17 23:02:02] [config] normalize-gradient: false
[2023-07-17 23:02:02] [config] num-devices: 0
[2023-07-17 23:02:02] [config] optimizer: adam
[2023-07-17 23:02:02] [config] optimizer-delay: 1
[2023-07-17 23:02:02] [config] optimizer-params:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] output-omit-bias: false
[2023-07-17 23:02:02] [config] overwrite: true
[2023-07-17 23:02:02] [config] precision:
[2023-07-17 23:02:02] [config]   - float16
[2023-07-17 23:02:02] [config]   - float32
[2023-07-17 23:02:02] [config] pretrained-model: ""
[2023-07-17 23:02:02] [config] quantize-biases: false
[2023-07-17 23:02:02] [config] quantize-bits: 0
[2023-07-17 23:02:02] [config] quantize-log-based: false
[2023-07-17 23:02:02] [config] quantize-optimization-steps: 0
[2023-07-17 23:02:02] [config] quiet: false
[2023-07-17 23:02:02] [config] quiet-translation: true
[2023-07-17 23:02:02] [config] relative-paths: false
[2023-07-17 23:02:02] [config] right-left: false
[2023-07-17 23:02:02] [config] save-freq: 10000u
[2023-07-17 23:02:02] [config] seed: 1234
[2023-07-17 23:02:02] [config] sentencepiece-alphas:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:02:02] [config] sentencepiece-options: ""
[2023-07-17 23:02:02] [config] sharding: global
[2023-07-17 23:02:02] [config] shuffle: data
[2023-07-17 23:02:02] [config] shuffle-in-ram: false
[2023-07-17 23:02:02] [config] sigterm: save-and-exit
[2023-07-17 23:02:02] [config] skip: false
[2023-07-17 23:02:02] [config] sqlite: ""
[2023-07-17 23:02:02] [config] sqlite-drop: false
[2023-07-17 23:02:02] [config] sync-freq: 200u
[2023-07-17 23:02:02] [config] sync-sgd: false
[2023-07-17 23:02:02] [config] tempdir: /tmp
[2023-07-17 23:02:02] [config] tied-embeddings: false
[2023-07-17 23:02:02] [config] tied-embeddings-all: true
[2023-07-17 23:02:02] [config] tied-embeddings-src: false
[2023-07-17 23:02:02] [config] train-embedder-rank:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] train-sets:
[2023-07-17 23:02:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:02:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:02:02] [config] transformer-aan-activation: swish
[2023-07-17 23:02:02] [config] transformer-aan-depth: 2
[2023-07-17 23:02:02] [config] transformer-aan-nogate: false
[2023-07-17 23:02:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:02:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:02:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:02:02] [config] transformer-depth-scaling: false
[2023-07-17 23:02:02] [config] transformer-dim-aan: 2048
[2023-07-17 23:02:02] [config] transformer-dim-ffn: 2048
[2023-07-17 23:02:02] [config] transformer-dropout: 0
[2023-07-17 23:02:02] [config] transformer-dropout-attention: 0
[2023-07-17 23:02:02] [config] transformer-dropout-ffn: 0
[2023-07-17 23:02:02] [config] transformer-ffn-activation: swish
[2023-07-17 23:02:02] [config] transformer-ffn-depth: 2
[2023-07-17 23:02:02] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:02:02] [config] transformer-heads: 8
[2023-07-17 23:02:02] [config] transformer-no-projection: false
[2023-07-17 23:02:02] [config] transformer-pool: false
[2023-07-17 23:02:02] [config] transformer-postprocess: dan
[2023-07-17 23:02:02] [config] transformer-postprocess-emb: d
[2023-07-17 23:02:02] [config] transformer-postprocess-top: ""
[2023-07-17 23:02:02] [config] transformer-preprocess: ""
[2023-07-17 23:02:02] [config] transformer-tied-layers:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] transformer-train-position-embeddings: false
[2023-07-17 23:02:02] [config] tsv: false
[2023-07-17 23:02:02] [config] tsv-fields: 0
[2023-07-17 23:02:02] [config] type: amun
[2023-07-17 23:02:02] [config] ulr: false
[2023-07-17 23:02:02] [config] ulr-dim-emb: 0
[2023-07-17 23:02:02] [config] ulr-dropout: 0
[2023-07-17 23:02:02] [config] ulr-keys-vectors: ""
[2023-07-17 23:02:02] [config] ulr-query-vectors: ""
[2023-07-17 23:02:02] [config] ulr-softmax-temperature: 1
[2023-07-17 23:02:02] [config] ulr-trainable-transformation: false
[2023-07-17 23:02:02] [config] unlikelihood-loss: false
[2023-07-17 23:02:02] [config] valid-freq: 50000000
[2023-07-17 23:02:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:02:02] [config] valid-max-length: 1000
[2023-07-17 23:02:02] [config] valid-metrics:
[2023-07-17 23:02:02] [config]   - cross-entropy
[2023-07-17 23:02:02] [config]   - translation
[2023-07-17 23:02:02] [config] valid-mini-batch: 32
[2023-07-17 23:02:02] [config] valid-reset-stalled: false
[2023-07-17 23:02:02] [config] valid-script-args:
[2023-07-17 23:02:02] [config]   []
[2023-07-17 23:02:02] [config] valid-script-path: ""
[2023-07-17 23:02:02] [config] valid-sets:
[2023-07-17 23:02:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:02:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:02:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:02:02] [config] vocabs:
[2023-07-17 23:02:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:02:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:02:02] [config] word-penalty: 0
[2023-07-17 23:02:02] [config] word-scores: false
[2023-07-17 23:02:02] [config] workspace: 5500
[2023-07-17 23:02:02] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:02:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:02:02] [training] Using single-device training
[2023-07-17 23:02:02] Synced seed 1234
[2023-07-17 23:02:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn
[2023-07-17 23:02:02] Error: DefaultVocabulary file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn is expected to contain an entry for </s>
[2023-07-17 23:02:02] Error: Aborted from marian::DefaultVocab::addRequiredVocabulary(const string&, bool)::<lambda(const string&, const string&, marian::Word)> in /marian/src/data/default_vocab.cpp:225

[CALL STACK]
[0x555a71485177]    marian::DefaultVocab::addRequiredVocabulary(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,bool)::{lambda(std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,marian::Word)#1}::  operator()  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  marian::Word) const + 0x4a7
[0x555a71485699]    marian::DefaultVocab::  addRequiredVocabulary  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  bool) + 0x59
[0x555a7148892f]    marian::DefaultVocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0xd3f
[0x555a714777da]    marian::Vocab::  load  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  unsigned long) + 0x3a
[0x555a714780f0]    marian::Vocab::  loadOrCreate  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>> const&,  std::vector<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,std::allocator<std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>>> const&,  unsigned long) + 0x520
[0x555a714c582e]    marian::data::CorpusBase::  CorpusBase  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x1f4e
[0x555a714d879d]    marian::data::Corpus::  Corpus  (std::shared_ptr<marian::Options>,  bool,  unsigned long) + 0x6d
[0x555a713a2b7b]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x1dab
[0x555a712c32c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x555a7127ab9c]    main                                               + 0x3c
[0x7f2db33480b3]    __libc_start_main                                  + 0xf3
[0x555a712c1cbe]    _start                                             + 0x2e

[2023-07-17 23:02:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:02:12] [marian] Running on node22.datos.cluster.uy as process 3954 with command line:
[2023-07-17 23:02:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-17 23:02:12] [config] after: 0e
[2023-07-17 23:02:12] [config] after-batches: 0
[2023-07-17 23:02:12] [config] after-epochs: 10
[2023-07-17 23:02:12] [config] all-caps-every: 0
[2023-07-17 23:02:12] [config] allow-unk: false
[2023-07-17 23:02:12] [config] authors: false
[2023-07-17 23:02:12] [config] beam-size: 12
[2023-07-17 23:02:12] [config] bert-class-symbol: "[CLS]"
[2023-07-17 23:02:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-17 23:02:12] [config] bert-masking-fraction: 0.15
[2023-07-17 23:02:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-17 23:02:12] [config] bert-train-type-embeddings: true
[2023-07-17 23:02:12] [config] bert-type-vocab-size: 2
[2023-07-17 23:02:12] [config] build-info: ""
[2023-07-17 23:02:12] [config] check-gradient-nan: false
[2023-07-17 23:02:12] [config] check-nan: false
[2023-07-17 23:02:12] [config] cite: false
[2023-07-17 23:02:12] [config] clip-norm: 1
[2023-07-17 23:02:12] [config] cost-scaling:
[2023-07-17 23:02:12] [config]   - 256.f
[2023-07-17 23:02:12] [config]   - 1000
[2023-07-17 23:02:12] [config]   - 2.f
[2023-07-17 23:02:12] [config]   - 256.f
[2023-07-17 23:02:12] [config] cost-type: ce-sum
[2023-07-17 23:02:12] [config] cpu-threads: 0
[2023-07-17 23:02:12] [config] data-threads: 8
[2023-07-17 23:02:12] [config] data-weighting: ""
[2023-07-17 23:02:12] [config] data-weighting-type: sentence
[2023-07-17 23:02:12] [config] dec-cell: gru
[2023-07-17 23:02:12] [config] dec-cell-base-depth: 2
[2023-07-17 23:02:12] [config] dec-cell-high-depth: 1
[2023-07-17 23:02:12] [config] dec-depth: 1
[2023-07-17 23:02:12] [config] devices:
[2023-07-17 23:02:12] [config]   - 0
[2023-07-17 23:02:12] [config] dim-emb: 512
[2023-07-17 23:02:12] [config] dim-rnn: 1024
[2023-07-17 23:02:12] [config] dim-vocabs:
[2023-07-17 23:02:12] [config]   - 16384
[2023-07-17 23:02:12] [config]   - 16384
[2023-07-17 23:02:12] [config] disp-first: 0
[2023-07-17 23:02:12] [config] disp-freq: 1000u
[2023-07-17 23:02:12] [config] disp-label-counts: true
[2023-07-17 23:02:12] [config] dropout-rnn: 0
[2023-07-17 23:02:12] [config] dropout-src: 0
[2023-07-17 23:02:12] [config] dropout-trg: 0
[2023-07-17 23:02:12] [config] dump-config: ""
[2023-07-17 23:02:12] [config] dynamic-gradient-scaling:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] early-stopping: 5
[2023-07-17 23:02:12] [config] early-stopping-on: first
[2023-07-17 23:02:12] [config] embedding-fix-src: false
[2023-07-17 23:02:12] [config] embedding-fix-trg: false
[2023-07-17 23:02:12] [config] embedding-normalization: false
[2023-07-17 23:02:12] [config] embedding-vectors:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] enc-cell: gru
[2023-07-17 23:02:12] [config] enc-cell-depth: 1
[2023-07-17 23:02:12] [config] enc-depth: 1
[2023-07-17 23:02:12] [config] enc-type: bidirectional
[2023-07-17 23:02:12] [config] english-title-case-every: 0
[2023-07-17 23:02:12] [config] exponential-smoothing: 0
[2023-07-17 23:02:12] [config] factor-weight: 1
[2023-07-17 23:02:12] [config] factors-combine: sum
[2023-07-17 23:02:12] [config] factors-dim-emb: 0
[2023-07-17 23:02:12] [config] gradient-checkpointing: false
[2023-07-17 23:02:12] [config] gradient-norm-average-window: 100
[2023-07-17 23:02:12] [config] guided-alignment: none
[2023-07-17 23:02:12] [config] guided-alignment-cost: mse
[2023-07-17 23:02:12] [config] guided-alignment-weight: 0.1
[2023-07-17 23:02:12] [config] ignore-model-config: false
[2023-07-17 23:02:12] [config] input-types:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] interpolate-env-vars: false
[2023-07-17 23:02:12] [config] keep-best: false
[2023-07-17 23:02:12] [config] label-smoothing: 0
[2023-07-17 23:02:12] [config] layer-normalization: false
[2023-07-17 23:02:12] [config] learn-rate: 0.0001
[2023-07-17 23:02:12] [config] lemma-dependency: ""
[2023-07-17 23:02:12] [config] lemma-dim-emb: 0
[2023-07-17 23:02:12] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:02:12] [config] log-level: info
[2023-07-17 23:02:12] [config] log-time-zone: ""
[2023-07-17 23:02:12] [config] logical-epoch:
[2023-07-17 23:02:12] [config]   - 1e
[2023-07-17 23:02:12] [config]   - 0
[2023-07-17 23:02:12] [config] lr-decay: 0
[2023-07-17 23:02:12] [config] lr-decay-freq: 50000
[2023-07-17 23:02:12] [config] lr-decay-inv-sqrt:
[2023-07-17 23:02:12] [config]   - 0
[2023-07-17 23:02:12] [config] lr-decay-repeat-warmup: false
[2023-07-17 23:02:12] [config] lr-decay-reset-optimizer: false
[2023-07-17 23:02:12] [config] lr-decay-start:
[2023-07-17 23:02:12] [config]   - 10
[2023-07-17 23:02:12] [config]   - 1
[2023-07-17 23:02:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-17 23:02:12] [config] lr-report: false
[2023-07-17 23:02:12] [config] lr-warmup: 0
[2023-07-17 23:02:12] [config] lr-warmup-at-reload: false
[2023-07-17 23:02:12] [config] lr-warmup-cycle: false
[2023-07-17 23:02:12] [config] lr-warmup-start-rate: 0
[2023-07-17 23:02:12] [config] max-length: 200
[2023-07-17 23:02:12] [config] max-length-crop: true
[2023-07-17 23:02:12] [config] max-length-factor: 3
[2023-07-17 23:02:12] [config] maxi-batch: 100
[2023-07-17 23:02:12] [config] maxi-batch-sort: trg
[2023-07-17 23:02:12] [config] mini-batch: 64
[2023-07-17 23:02:12] [config] mini-batch-fit: true
[2023-07-17 23:02:12] [config] mini-batch-fit-step: 10
[2023-07-17 23:02:12] [config] mini-batch-round-up: true
[2023-07-17 23:02:12] [config] mini-batch-track-lr: false
[2023-07-17 23:02:12] [config] mini-batch-warmup: 0
[2023-07-17 23:02:12] [config] mini-batch-words: 0
[2023-07-17 23:02:12] [config] mini-batch-words-ref: 0
[2023-07-17 23:02:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-17 23:02:12] [config] multi-loss-type: sum
[2023-07-17 23:02:12] [config] n-best: false
[2023-07-17 23:02:12] [config] no-nccl: false
[2023-07-17 23:02:12] [config] no-reload: false
[2023-07-17 23:02:12] [config] no-restore-corpus: false
[2023-07-17 23:02:12] [config] normalize: 0
[2023-07-17 23:02:12] [config] normalize-gradient: false
[2023-07-17 23:02:12] [config] num-devices: 0
[2023-07-17 23:02:12] [config] optimizer: adam
[2023-07-17 23:02:12] [config] optimizer-delay: 1
[2023-07-17 23:02:12] [config] optimizer-params:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] output-omit-bias: false
[2023-07-17 23:02:12] [config] overwrite: true
[2023-07-17 23:02:12] [config] precision:
[2023-07-17 23:02:12] [config]   - float16
[2023-07-17 23:02:12] [config]   - float32
[2023-07-17 23:02:12] [config] pretrained-model: ""
[2023-07-17 23:02:12] [config] quantize-biases: false
[2023-07-17 23:02:12] [config] quantize-bits: 0
[2023-07-17 23:02:12] [config] quantize-log-based: false
[2023-07-17 23:02:12] [config] quantize-optimization-steps: 0
[2023-07-17 23:02:12] [config] quiet: false
[2023-07-17 23:02:12] [config] quiet-translation: true
[2023-07-17 23:02:12] [config] relative-paths: false
[2023-07-17 23:02:12] [config] right-left: false
[2023-07-17 23:02:12] [config] save-freq: 10000u
[2023-07-17 23:02:12] [config] seed: 1234
[2023-07-17 23:02:12] [config] sentencepiece-alphas:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] sentencepiece-max-lines: 2000000
[2023-07-17 23:02:12] [config] sentencepiece-options: ""
[2023-07-17 23:02:12] [config] sharding: global
[2023-07-17 23:02:12] [config] shuffle: data
[2023-07-17 23:02:12] [config] shuffle-in-ram: false
[2023-07-17 23:02:12] [config] sigterm: save-and-exit
[2023-07-17 23:02:12] [config] skip: false
[2023-07-17 23:02:12] [config] sqlite: ""
[2023-07-17 23:02:12] [config] sqlite-drop: false
[2023-07-17 23:02:12] [config] sync-freq: 200u
[2023-07-17 23:02:12] [config] sync-sgd: false
[2023-07-17 23:02:12] [config] tempdir: /tmp
[2023-07-17 23:02:12] [config] tied-embeddings: false
[2023-07-17 23:02:12] [config] tied-embeddings-all: true
[2023-07-17 23:02:12] [config] tied-embeddings-src: false
[2023-07-17 23:02:12] [config] train-embedder-rank:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] train-sets:
[2023-07-17 23:02:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:02:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:02:12] [config] transformer-aan-activation: swish
[2023-07-17 23:02:12] [config] transformer-aan-depth: 2
[2023-07-17 23:02:12] [config] transformer-aan-nogate: false
[2023-07-17 23:02:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-17 23:02:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-17 23:02:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-17 23:02:12] [config] transformer-depth-scaling: false
[2023-07-17 23:02:12] [config] transformer-dim-aan: 2048
[2023-07-17 23:02:12] [config] transformer-dim-ffn: 2048
[2023-07-17 23:02:12] [config] transformer-dropout: 0
[2023-07-17 23:02:12] [config] transformer-dropout-attention: 0
[2023-07-17 23:02:12] [config] transformer-dropout-ffn: 0
[2023-07-17 23:02:12] [config] transformer-ffn-activation: swish
[2023-07-17 23:02:12] [config] transformer-ffn-depth: 2
[2023-07-17 23:02:12] [config] transformer-guided-alignment-layer: last
[2023-07-17 23:02:12] [config] transformer-heads: 8
[2023-07-17 23:02:12] [config] transformer-no-projection: false
[2023-07-17 23:02:12] [config] transformer-pool: false
[2023-07-17 23:02:12] [config] transformer-postprocess: dan
[2023-07-17 23:02:12] [config] transformer-postprocess-emb: d
[2023-07-17 23:02:12] [config] transformer-postprocess-top: ""
[2023-07-17 23:02:12] [config] transformer-preprocess: ""
[2023-07-17 23:02:12] [config] transformer-tied-layers:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] transformer-train-position-embeddings: false
[2023-07-17 23:02:12] [config] tsv: false
[2023-07-17 23:02:12] [config] tsv-fields: 0
[2023-07-17 23:02:12] [config] type: amun
[2023-07-17 23:02:12] [config] ulr: false
[2023-07-17 23:02:12] [config] ulr-dim-emb: 0
[2023-07-17 23:02:12] [config] ulr-dropout: 0
[2023-07-17 23:02:12] [config] ulr-keys-vectors: ""
[2023-07-17 23:02:12] [config] ulr-query-vectors: ""
[2023-07-17 23:02:12] [config] ulr-softmax-temperature: 1
[2023-07-17 23:02:12] [config] ulr-trainable-transformation: false
[2023-07-17 23:02:12] [config] unlikelihood-loss: false
[2023-07-17 23:02:12] [config] valid-freq: 50000000
[2023-07-17 23:02:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-17 23:02:12] [config] valid-max-length: 1000
[2023-07-17 23:02:12] [config] valid-metrics:
[2023-07-17 23:02:12] [config]   - cross-entropy
[2023-07-17 23:02:12] [config]   - translation
[2023-07-17 23:02:12] [config] valid-mini-batch: 32
[2023-07-17 23:02:12] [config] valid-reset-stalled: false
[2023-07-17 23:02:12] [config] valid-script-args:
[2023-07-17 23:02:12] [config]   []
[2023-07-17 23:02:12] [config] valid-script-path: ""
[2023-07-17 23:02:12] [config] valid-sets:
[2023-07-17 23:02:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-17 23:02:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-17 23:02:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-17 23:02:12] [config] vocabs:
[2023-07-17 23:02:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-17 23:02:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:02:12] [config] word-penalty: 0
[2023-07-17 23:02:12] [config] word-scores: false
[2023-07-17 23:02:12] [config] workspace: 5500
[2023-07-17 23:02:12] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-17 23:02:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:02:12] [training] Using single-device training
[2023-07-17 23:02:13] Synced seed 1234
[2023-07-17 23:02:13] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-17 23:02:13] [SentencePiece] Creating temporary file /tmp/marian.oSHpGc 
[2023-07-17 23:02:13] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-17 23:02:13] [SentencePiece] Selected 20193 lines
[2023-07-17 23:02:15] [SentencePiece] Removing /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm.vocab
[2023-07-17 23:02:15] [SentencePiece] Renaming /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm.model to /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-17 23:02:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-17 23:02:15] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-17 23:02:15] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:02:15] [SentencePiece] Creating temporary file /tmp/marian.UX1sYc 
[2023-07-17 23:02:15] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-17 23:02:15] [SentencePiece] Selected 20193 lines
[2023-07-17 23:02:17] [SentencePiece] Removing /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm.vocab
[2023-07-17 23:02:17] [SentencePiece] Renaming /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm.model to /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:02:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-17 23:02:17] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-17 23:02:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-17 23:02:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:02:17] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-17 23:02:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 23:02:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 23:02:18] [comm] Using global sharding
[2023-07-17 23:02:18] [comm] NCCLCommunicators constructed successfully
[2023-07-17 23:02:18] [training] Using 1 GPUs
[2023-07-17 23:02:18] [logits] Applying loss function for 1 factor(s)
[2023-07-17 23:02:18] [memory] Reserving 80 MB, device gpu0
[2023-07-17 23:02:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-17 23:02:20] [memory] Reserving 80 MB, device gpu0
[2023-07-17 23:35:38] [batching] Done. Typical MB size is 35,936 target words
[2023-07-17 23:35:38] [valid] No post-processing script given for validating translator
[2023-07-17 23:35:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-17 23:35:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-17 23:35:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-17 23:35:38] [comm] Using global sharding
[2023-07-17 23:35:38] [comm] NCCLCommunicators constructed successfully
[2023-07-17 23:35:38] [training] Using 1 GPUs
[2023-07-17 23:35:38] Training started
[2023-07-17 23:35:38] [data] Shuffling data
[2023-07-17 23:35:38] [data] Done reading 20,192 sentences
[2023-07-17 23:35:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-17 23:35:38] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-17 23:35:38] [memory] Reserving 80 MB, device gpu0
[2023-07-17 23:35:40] [memory] Reserving 80 MB, device gpu0
[2023-07-17 23:35:49] Parameter type float16, optimization type float32, casting types true
[2023-07-17 23:35:49] Allocating memory for general optimizer shards
[2023-07-17 23:35:49] [memory] Reserving 322 MB, device gpu0
[2023-07-17 23:35:49] Allocating memory for Adam-specific shards
[2023-07-17 23:35:49] [memory] Reserving 322 MB, device gpu0
[2023-07-17 23:39:31] Seen 20,192 samples
[2023-07-17 23:39:31] Starting data epoch 2 in logical epoch 2
[2023-07-17 23:39:31] [data] Shuffling data
[2023-07-17 23:39:31] [data] Done reading 20,192 sentences
[2023-07-17 23:39:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-17 23:43:58] Seen 20,192 samples
[2023-07-17 23:43:58] Starting data epoch 3 in logical epoch 3
[2023-07-17 23:43:58] [data] Shuffling data
[2023-07-17 23:43:58] [data] Done reading 20,192 sentences
[2023-07-17 23:43:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-17 23:48:22] Seen 20,192 samples
[2023-07-17 23:48:22] Starting data epoch 4 in logical epoch 4
[2023-07-17 23:48:22] [data] Shuffling data
[2023-07-17 23:48:22] [data] Done reading 20,192 sentences
[2023-07-17 23:48:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-17 23:52:19] Seen 20,192 samples
[2023-07-17 23:52:19] Starting data epoch 5 in logical epoch 5
[2023-07-17 23:52:19] [data] Shuffling data
[2023-07-17 23:52:19] [data] Done reading 20,192 sentences
[2023-07-17 23:52:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-17 23:56:36] Seen 20,192 samples
[2023-07-17 23:56:36] Starting data epoch 6 in logical epoch 6
[2023-07-17 23:56:36] [data] Shuffling data
[2023-07-17 23:56:36] [data] Done reading 20,192 sentences
[2023-07-17 23:56:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 00:00:46] Seen 20,192 samples
[2023-07-18 00:00:46] Starting data epoch 7 in logical epoch 7
[2023-07-18 00:00:46] [data] Shuffling data
[2023-07-18 00:00:46] [data] Done reading 20,192 sentences
[2023-07-18 00:00:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 00:04:53] Seen 20,192 samples
[2023-07-18 00:04:53] Starting data epoch 8 in logical epoch 8
[2023-07-18 00:04:53] [data] Shuffling data
[2023-07-18 00:04:53] [data] Done reading 20,192 sentences
[2023-07-18 00:04:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 00:08:56] Seen 20,192 samples
[2023-07-18 00:08:56] Starting data epoch 9 in logical epoch 9
[2023-07-18 00:08:56] [data] Shuffling data
[2023-07-18 00:08:56] [data] Done reading 20,192 sentences
[2023-07-18 00:08:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 00:13:16] Seen 20,192 samples
[2023-07-18 00:13:16] Starting data epoch 10 in logical epoch 10
[2023-07-18 00:13:16] [data] Shuffling data
[2023-07-18 00:13:16] [data] Done reading 20,192 sentences
[2023-07-18 00:13:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 00:17:50] Seen 20,192 samples
[2023-07-18 00:17:50] Starting data epoch 11 in logical epoch 11
[2023-07-18 00:17:50] Training finished
[2023-07-18 00:18:01] [valid] Ep. 11 : Up. 385 : cross-entropy : 187.274 : new best
[2023-07-18 00:19:43] [valid] Ep. 11 : Up. 385 : translation : 0 : new best
[2023-07-18 00:19:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 00:19:44] Saving Adam parameters
[2023-07-18 00:19:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 00:19:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 00:19:51] [marian] Running on node22.datos.cluster.uy as process 9049 with command line:
[2023-07-18 00:19:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-18 00:19:51] [config] after: 0e
[2023-07-18 00:19:51] [config] after-batches: 0
[2023-07-18 00:19:51] [config] after-epochs: 20
[2023-07-18 00:19:51] [config] all-caps-every: 0
[2023-07-18 00:19:51] [config] allow-unk: false
[2023-07-18 00:19:51] [config] authors: false
[2023-07-18 00:19:51] [config] beam-size: 12
[2023-07-18 00:19:51] [config] bert-class-symbol: "[CLS]"
[2023-07-18 00:19:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 00:19:51] [config] bert-masking-fraction: 0.15
[2023-07-18 00:19:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 00:19:51] [config] bert-train-type-embeddings: true
[2023-07-18 00:19:51] [config] bert-type-vocab-size: 2
[2023-07-18 00:19:51] [config] build-info: ""
[2023-07-18 00:19:51] [config] check-gradient-nan: false
[2023-07-18 00:19:51] [config] check-nan: false
[2023-07-18 00:19:51] [config] cite: false
[2023-07-18 00:19:51] [config] clip-norm: 1
[2023-07-18 00:19:51] [config] cost-scaling:
[2023-07-18 00:19:51] [config]   - 256.f
[2023-07-18 00:19:51] [config]   - 1000
[2023-07-18 00:19:51] [config]   - 2.f
[2023-07-18 00:19:51] [config]   - 256.f
[2023-07-18 00:19:51] [config] cost-type: ce-sum
[2023-07-18 00:19:51] [config] cpu-threads: 0
[2023-07-18 00:19:51] [config] data-threads: 8
[2023-07-18 00:19:51] [config] data-weighting: ""
[2023-07-18 00:19:51] [config] data-weighting-type: sentence
[2023-07-18 00:19:51] [config] dec-cell: gru
[2023-07-18 00:19:51] [config] dec-cell-base-depth: 2
[2023-07-18 00:19:51] [config] dec-cell-high-depth: 1
[2023-07-18 00:19:51] [config] dec-depth: 1
[2023-07-18 00:19:51] [config] devices:
[2023-07-18 00:19:51] [config]   - 0
[2023-07-18 00:19:51] [config] dim-emb: 512
[2023-07-18 00:19:51] [config] dim-rnn: 1024
[2023-07-18 00:19:51] [config] dim-vocabs:
[2023-07-18 00:19:51] [config]   - 16384
[2023-07-18 00:19:51] [config]   - 16384
[2023-07-18 00:19:51] [config] disp-first: 0
[2023-07-18 00:19:51] [config] disp-freq: 1000u
[2023-07-18 00:19:51] [config] disp-label-counts: true
[2023-07-18 00:19:51] [config] dropout-rnn: 0
[2023-07-18 00:19:51] [config] dropout-src: 0
[2023-07-18 00:19:51] [config] dropout-trg: 0
[2023-07-18 00:19:51] [config] dump-config: ""
[2023-07-18 00:19:51] [config] dynamic-gradient-scaling:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] early-stopping: 5
[2023-07-18 00:19:51] [config] early-stopping-on: first
[2023-07-18 00:19:51] [config] embedding-fix-src: false
[2023-07-18 00:19:51] [config] embedding-fix-trg: false
[2023-07-18 00:19:51] [config] embedding-normalization: false
[2023-07-18 00:19:51] [config] embedding-vectors:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] enc-cell: gru
[2023-07-18 00:19:51] [config] enc-cell-depth: 1
[2023-07-18 00:19:51] [config] enc-depth: 1
[2023-07-18 00:19:51] [config] enc-type: bidirectional
[2023-07-18 00:19:51] [config] english-title-case-every: 0
[2023-07-18 00:19:51] [config] exponential-smoothing: 0
[2023-07-18 00:19:51] [config] factor-weight: 1
[2023-07-18 00:19:51] [config] factors-combine: sum
[2023-07-18 00:19:51] [config] factors-dim-emb: 0
[2023-07-18 00:19:51] [config] gradient-checkpointing: false
[2023-07-18 00:19:51] [config] gradient-norm-average-window: 100
[2023-07-18 00:19:51] [config] guided-alignment: none
[2023-07-18 00:19:51] [config] guided-alignment-cost: mse
[2023-07-18 00:19:51] [config] guided-alignment-weight: 0.1
[2023-07-18 00:19:51] [config] ignore-model-config: false
[2023-07-18 00:19:51] [config] input-types:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] interpolate-env-vars: false
[2023-07-18 00:19:51] [config] keep-best: false
[2023-07-18 00:19:51] [config] label-smoothing: 0
[2023-07-18 00:19:51] [config] layer-normalization: false
[2023-07-18 00:19:51] [config] learn-rate: 0.0001
[2023-07-18 00:19:51] [config] lemma-dependency: ""
[2023-07-18 00:19:51] [config] lemma-dim-emb: 0
[2023-07-18 00:19:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 00:19:51] [config] log-level: info
[2023-07-18 00:19:51] [config] log-time-zone: ""
[2023-07-18 00:19:51] [config] logical-epoch:
[2023-07-18 00:19:51] [config]   - 1e
[2023-07-18 00:19:51] [config]   - 0
[2023-07-18 00:19:51] [config] lr-decay: 0
[2023-07-18 00:19:51] [config] lr-decay-freq: 50000
[2023-07-18 00:19:51] [config] lr-decay-inv-sqrt:
[2023-07-18 00:19:51] [config]   - 0
[2023-07-18 00:19:51] [config] lr-decay-repeat-warmup: false
[2023-07-18 00:19:51] [config] lr-decay-reset-optimizer: false
[2023-07-18 00:19:51] [config] lr-decay-start:
[2023-07-18 00:19:51] [config]   - 10
[2023-07-18 00:19:51] [config]   - 1
[2023-07-18 00:19:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 00:19:51] [config] lr-report: false
[2023-07-18 00:19:51] [config] lr-warmup: 0
[2023-07-18 00:19:51] [config] lr-warmup-at-reload: false
[2023-07-18 00:19:51] [config] lr-warmup-cycle: false
[2023-07-18 00:19:51] [config] lr-warmup-start-rate: 0
[2023-07-18 00:19:51] [config] max-length: 200
[2023-07-18 00:19:51] [config] max-length-crop: true
[2023-07-18 00:19:51] [config] max-length-factor: 3
[2023-07-18 00:19:51] [config] maxi-batch: 100
[2023-07-18 00:19:51] [config] maxi-batch-sort: trg
[2023-07-18 00:19:51] [config] mini-batch: 64
[2023-07-18 00:19:51] [config] mini-batch-fit: true
[2023-07-18 00:19:51] [config] mini-batch-fit-step: 10
[2023-07-18 00:19:51] [config] mini-batch-round-up: true
[2023-07-18 00:19:51] [config] mini-batch-track-lr: false
[2023-07-18 00:19:51] [config] mini-batch-warmup: 0
[2023-07-18 00:19:51] [config] mini-batch-words: 0
[2023-07-18 00:19:51] [config] mini-batch-words-ref: 0
[2023-07-18 00:19:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 00:19:51] [config] multi-loss-type: sum
[2023-07-18 00:19:51] [config] n-best: false
[2023-07-18 00:19:51] [config] no-nccl: false
[2023-07-18 00:19:51] [config] no-reload: false
[2023-07-18 00:19:51] [config] no-restore-corpus: false
[2023-07-18 00:19:51] [config] normalize: 0
[2023-07-18 00:19:51] [config] normalize-gradient: false
[2023-07-18 00:19:51] [config] num-devices: 0
[2023-07-18 00:19:51] [config] optimizer: adam
[2023-07-18 00:19:51] [config] optimizer-delay: 1
[2023-07-18 00:19:51] [config] optimizer-params:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] output-omit-bias: false
[2023-07-18 00:19:51] [config] overwrite: true
[2023-07-18 00:19:51] [config] precision:
[2023-07-18 00:19:51] [config]   - float16
[2023-07-18 00:19:51] [config]   - float32
[2023-07-18 00:19:51] [config] pretrained-model: ""
[2023-07-18 00:19:51] [config] quantize-biases: false
[2023-07-18 00:19:51] [config] quantize-bits: 0
[2023-07-18 00:19:51] [config] quantize-log-based: false
[2023-07-18 00:19:51] [config] quantize-optimization-steps: 0
[2023-07-18 00:19:51] [config] quiet: false
[2023-07-18 00:19:51] [config] quiet-translation: true
[2023-07-18 00:19:51] [config] relative-paths: false
[2023-07-18 00:19:51] [config] right-left: false
[2023-07-18 00:19:51] [config] save-freq: 10000u
[2023-07-18 00:19:51] [config] seed: 1234
[2023-07-18 00:19:51] [config] sentencepiece-alphas:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] sentencepiece-max-lines: 2000000
[2023-07-18 00:19:51] [config] sentencepiece-options: ""
[2023-07-18 00:19:51] [config] sharding: global
[2023-07-18 00:19:51] [config] shuffle: data
[2023-07-18 00:19:51] [config] shuffle-in-ram: false
[2023-07-18 00:19:51] [config] sigterm: save-and-exit
[2023-07-18 00:19:51] [config] skip: false
[2023-07-18 00:19:51] [config] sqlite: ""
[2023-07-18 00:19:51] [config] sqlite-drop: false
[2023-07-18 00:19:51] [config] sync-freq: 200u
[2023-07-18 00:19:51] [config] sync-sgd: false
[2023-07-18 00:19:51] [config] tempdir: /tmp
[2023-07-18 00:19:51] [config] tied-embeddings: false
[2023-07-18 00:19:51] [config] tied-embeddings-all: true
[2023-07-18 00:19:51] [config] tied-embeddings-src: false
[2023-07-18 00:19:51] [config] train-embedder-rank:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] train-sets:
[2023-07-18 00:19:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 00:19:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 00:19:51] [config] transformer-aan-activation: swish
[2023-07-18 00:19:51] [config] transformer-aan-depth: 2
[2023-07-18 00:19:51] [config] transformer-aan-nogate: false
[2023-07-18 00:19:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 00:19:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 00:19:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 00:19:51] [config] transformer-depth-scaling: false
[2023-07-18 00:19:51] [config] transformer-dim-aan: 2048
[2023-07-18 00:19:51] [config] transformer-dim-ffn: 2048
[2023-07-18 00:19:51] [config] transformer-dropout: 0
[2023-07-18 00:19:51] [config] transformer-dropout-attention: 0
[2023-07-18 00:19:51] [config] transformer-dropout-ffn: 0
[2023-07-18 00:19:51] [config] transformer-ffn-activation: swish
[2023-07-18 00:19:51] [config] transformer-ffn-depth: 2
[2023-07-18 00:19:51] [config] transformer-guided-alignment-layer: last
[2023-07-18 00:19:51] [config] transformer-heads: 8
[2023-07-18 00:19:51] [config] transformer-no-projection: false
[2023-07-18 00:19:51] [config] transformer-pool: false
[2023-07-18 00:19:51] [config] transformer-postprocess: dan
[2023-07-18 00:19:51] [config] transformer-postprocess-emb: d
[2023-07-18 00:19:51] [config] transformer-postprocess-top: ""
[2023-07-18 00:19:51] [config] transformer-preprocess: ""
[2023-07-18 00:19:51] [config] transformer-tied-layers:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] transformer-train-position-embeddings: false
[2023-07-18 00:19:51] [config] tsv: false
[2023-07-18 00:19:51] [config] tsv-fields: 0
[2023-07-18 00:19:51] [config] type: amun
[2023-07-18 00:19:51] [config] ulr: false
[2023-07-18 00:19:51] [config] ulr-dim-emb: 0
[2023-07-18 00:19:51] [config] ulr-dropout: 0
[2023-07-18 00:19:51] [config] ulr-keys-vectors: ""
[2023-07-18 00:19:51] [config] ulr-query-vectors: ""
[2023-07-18 00:19:51] [config] ulr-softmax-temperature: 1
[2023-07-18 00:19:51] [config] ulr-trainable-transformation: false
[2023-07-18 00:19:51] [config] unlikelihood-loss: false
[2023-07-18 00:19:51] [config] valid-freq: 50000000
[2023-07-18 00:19:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 00:19:51] [config] valid-max-length: 1000
[2023-07-18 00:19:51] [config] valid-metrics:
[2023-07-18 00:19:51] [config]   - cross-entropy
[2023-07-18 00:19:51] [config]   - translation
[2023-07-18 00:19:51] [config] valid-mini-batch: 32
[2023-07-18 00:19:51] [config] valid-reset-stalled: false
[2023-07-18 00:19:51] [config] valid-script-args:
[2023-07-18 00:19:51] [config]   []
[2023-07-18 00:19:51] [config] valid-script-path: ""
[2023-07-18 00:19:51] [config] valid-sets:
[2023-07-18 00:19:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 00:19:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 00:19:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 00:19:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 00:19:51] [config] vocabs:
[2023-07-18 00:19:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 00:19:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 00:19:51] [config] word-penalty: 0
[2023-07-18 00:19:51] [config] word-scores: false
[2023-07-18 00:19:51] [config] workspace: 5500
[2023-07-18 00:19:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 00:19:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 00:19:51] [training] Using single-device training
[2023-07-18 00:19:51] Synced seed 1234
[2023-07-18 00:19:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 00:19:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 00:19:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 00:19:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 00:19:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 00:19:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 00:19:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 00:19:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 00:19:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 00:19:53] [comm] Using global sharding
[2023-07-18 00:19:53] [comm] NCCLCommunicators constructed successfully
[2023-07-18 00:19:53] [training] Using 1 GPUs
[2023-07-18 00:19:53] [logits] Applying loss function for 1 factor(s)
[2023-07-18 00:19:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 00:19:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 00:19:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 00:56:02] [batching] Done. Typical MB size is 35,936 target words
[2023-07-18 00:56:02] [valid] No post-processing script given for validating translator
[2023-07-18 00:56:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 00:56:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 00:56:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 00:56:02] [comm] Using global sharding
[2023-07-18 00:56:02] [comm] NCCLCommunicators constructed successfully
[2023-07-18 00:56:02] [training] Using 1 GPUs
[2023-07-18 00:56:02] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 00:56:08] Allocating memory for general optimizer shards
[2023-07-18 00:56:08] [memory] Reserving 322 MB, device gpu0
[2023-07-18 00:56:08] Loading Adam parameters
[2023-07-18 00:56:08] [memory] Reserving 322 MB, device gpu0
[2023-07-18 00:56:08] [memory] Reserving 80 MB, device gpu0
[2023-07-18 00:56:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 00:56:08] [data] Restoring the corpus state to epoch 11, batch 385
[2023-07-18 00:56:08] [data] Shuffling data
[2023-07-18 00:56:08] [data] Done reading 20,192 sentences
[2023-07-18 00:56:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 00:56:08] Training started
[2023-07-18 00:56:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 00:56:09] [memory] Reserving 80 MB, device gpu0
[2023-07-18 00:56:14] Parameter type float16, optimization type float32, casting types true
[2023-07-18 01:00:29] Seen 20,192 samples
[2023-07-18 01:00:29] Starting data epoch 12 in logical epoch 12
[2023-07-18 01:00:29] [data] Shuffling data
[2023-07-18 01:00:29] [data] Done reading 20,192 sentences
[2023-07-18 01:00:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:05:20] Seen 20,192 samples
[2023-07-18 01:05:20] Starting data epoch 13 in logical epoch 13
[2023-07-18 01:05:20] [data] Shuffling data
[2023-07-18 01:05:20] [data] Done reading 20,192 sentences
[2023-07-18 01:05:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:10:04] Seen 20,192 samples
[2023-07-18 01:10:04] Starting data epoch 14 in logical epoch 14
[2023-07-18 01:10:04] [data] Shuffling data
[2023-07-18 01:10:04] [data] Done reading 20,192 sentences
[2023-07-18 01:10:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:14:51] Seen 20,192 samples
[2023-07-18 01:14:51] Starting data epoch 15 in logical epoch 15
[2023-07-18 01:14:51] [data] Shuffling data
[2023-07-18 01:14:51] [data] Done reading 20,192 sentences
[2023-07-18 01:14:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:19:31] Seen 20,192 samples
[2023-07-18 01:19:31] Starting data epoch 16 in logical epoch 16
[2023-07-18 01:19:31] [data] Shuffling data
[2023-07-18 01:19:31] [data] Done reading 20,192 sentences
[2023-07-18 01:19:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:24:05] Seen 20,192 samples
[2023-07-18 01:24:05] Starting data epoch 17 in logical epoch 17
[2023-07-18 01:24:05] [data] Shuffling data
[2023-07-18 01:24:05] [data] Done reading 20,192 sentences
[2023-07-18 01:24:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:28:37] Seen 20,192 samples
[2023-07-18 01:28:37] Starting data epoch 18 in logical epoch 18
[2023-07-18 01:28:37] [data] Shuffling data
[2023-07-18 01:28:37] [data] Done reading 20,192 sentences
[2023-07-18 01:28:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:33:20] Seen 20,192 samples
[2023-07-18 01:33:20] Starting data epoch 19 in logical epoch 19
[2023-07-18 01:33:20] [data] Shuffling data
[2023-07-18 01:33:20] [data] Done reading 20,192 sentences
[2023-07-18 01:33:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:37:55] Seen 20,192 samples
[2023-07-18 01:37:55] Starting data epoch 20 in logical epoch 20
[2023-07-18 01:37:55] [data] Shuffling data
[2023-07-18 01:37:55] [data] Done reading 20,192 sentences
[2023-07-18 01:37:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 01:42:30] Seen 20,192 samples
[2023-07-18 01:42:30] Starting data epoch 21 in logical epoch 21
[2023-07-18 01:42:30] Training finished
[2023-07-18 01:42:40] [valid] Ep. 21 : Up. 769 : cross-entropy : 171.673 : new best
[2023-07-18 01:45:52] [valid] Ep. 21 : Up. 769 : translation : 0 : new best
[2023-07-18 01:45:52] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 01:45:54] Saving Adam parameters
[2023-07-18 01:45:54] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 01:46:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 01:46:01] [marian] Running on node22.datos.cluster.uy as process 14596 with command line:
[2023-07-18 01:46:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-18 01:46:01] [config] after: 0e
[2023-07-18 01:46:01] [config] after-batches: 0
[2023-07-18 01:46:01] [config] after-epochs: 30
[2023-07-18 01:46:01] [config] all-caps-every: 0
[2023-07-18 01:46:01] [config] allow-unk: false
[2023-07-18 01:46:01] [config] authors: false
[2023-07-18 01:46:01] [config] beam-size: 12
[2023-07-18 01:46:01] [config] bert-class-symbol: "[CLS]"
[2023-07-18 01:46:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 01:46:01] [config] bert-masking-fraction: 0.15
[2023-07-18 01:46:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 01:46:01] [config] bert-train-type-embeddings: true
[2023-07-18 01:46:01] [config] bert-type-vocab-size: 2
[2023-07-18 01:46:01] [config] build-info: ""
[2023-07-18 01:46:01] [config] check-gradient-nan: false
[2023-07-18 01:46:01] [config] check-nan: false
[2023-07-18 01:46:01] [config] cite: false
[2023-07-18 01:46:01] [config] clip-norm: 1
[2023-07-18 01:46:01] [config] cost-scaling:
[2023-07-18 01:46:01] [config]   - 256.f
[2023-07-18 01:46:01] [config]   - 1000
[2023-07-18 01:46:01] [config]   - 2.f
[2023-07-18 01:46:01] [config]   - 256.f
[2023-07-18 01:46:01] [config] cost-type: ce-sum
[2023-07-18 01:46:01] [config] cpu-threads: 0
[2023-07-18 01:46:01] [config] data-threads: 8
[2023-07-18 01:46:01] [config] data-weighting: ""
[2023-07-18 01:46:01] [config] data-weighting-type: sentence
[2023-07-18 01:46:01] [config] dec-cell: gru
[2023-07-18 01:46:01] [config] dec-cell-base-depth: 2
[2023-07-18 01:46:01] [config] dec-cell-high-depth: 1
[2023-07-18 01:46:01] [config] dec-depth: 1
[2023-07-18 01:46:01] [config] devices:
[2023-07-18 01:46:01] [config]   - 0
[2023-07-18 01:46:01] [config] dim-emb: 512
[2023-07-18 01:46:01] [config] dim-rnn: 1024
[2023-07-18 01:46:01] [config] dim-vocabs:
[2023-07-18 01:46:01] [config]   - 16384
[2023-07-18 01:46:01] [config]   - 16384
[2023-07-18 01:46:01] [config] disp-first: 0
[2023-07-18 01:46:01] [config] disp-freq: 1000u
[2023-07-18 01:46:01] [config] disp-label-counts: true
[2023-07-18 01:46:01] [config] dropout-rnn: 0
[2023-07-18 01:46:01] [config] dropout-src: 0
[2023-07-18 01:46:01] [config] dropout-trg: 0
[2023-07-18 01:46:01] [config] dump-config: ""
[2023-07-18 01:46:01] [config] dynamic-gradient-scaling:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] early-stopping: 5
[2023-07-18 01:46:01] [config] early-stopping-on: first
[2023-07-18 01:46:01] [config] embedding-fix-src: false
[2023-07-18 01:46:01] [config] embedding-fix-trg: false
[2023-07-18 01:46:01] [config] embedding-normalization: false
[2023-07-18 01:46:01] [config] embedding-vectors:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] enc-cell: gru
[2023-07-18 01:46:01] [config] enc-cell-depth: 1
[2023-07-18 01:46:01] [config] enc-depth: 1
[2023-07-18 01:46:01] [config] enc-type: bidirectional
[2023-07-18 01:46:01] [config] english-title-case-every: 0
[2023-07-18 01:46:01] [config] exponential-smoothing: 0
[2023-07-18 01:46:01] [config] factor-weight: 1
[2023-07-18 01:46:01] [config] factors-combine: sum
[2023-07-18 01:46:01] [config] factors-dim-emb: 0
[2023-07-18 01:46:01] [config] gradient-checkpointing: false
[2023-07-18 01:46:01] [config] gradient-norm-average-window: 100
[2023-07-18 01:46:01] [config] guided-alignment: none
[2023-07-18 01:46:01] [config] guided-alignment-cost: mse
[2023-07-18 01:46:01] [config] guided-alignment-weight: 0.1
[2023-07-18 01:46:01] [config] ignore-model-config: false
[2023-07-18 01:46:01] [config] input-types:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] interpolate-env-vars: false
[2023-07-18 01:46:01] [config] keep-best: false
[2023-07-18 01:46:01] [config] label-smoothing: 0
[2023-07-18 01:46:01] [config] layer-normalization: false
[2023-07-18 01:46:01] [config] learn-rate: 0.0001
[2023-07-18 01:46:01] [config] lemma-dependency: ""
[2023-07-18 01:46:01] [config] lemma-dim-emb: 0
[2023-07-18 01:46:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 01:46:01] [config] log-level: info
[2023-07-18 01:46:01] [config] log-time-zone: ""
[2023-07-18 01:46:01] [config] logical-epoch:
[2023-07-18 01:46:01] [config]   - 1e
[2023-07-18 01:46:01] [config]   - 0
[2023-07-18 01:46:01] [config] lr-decay: 0
[2023-07-18 01:46:01] [config] lr-decay-freq: 50000
[2023-07-18 01:46:01] [config] lr-decay-inv-sqrt:
[2023-07-18 01:46:01] [config]   - 0
[2023-07-18 01:46:01] [config] lr-decay-repeat-warmup: false
[2023-07-18 01:46:01] [config] lr-decay-reset-optimizer: false
[2023-07-18 01:46:01] [config] lr-decay-start:
[2023-07-18 01:46:01] [config]   - 10
[2023-07-18 01:46:01] [config]   - 1
[2023-07-18 01:46:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 01:46:01] [config] lr-report: false
[2023-07-18 01:46:01] [config] lr-warmup: 0
[2023-07-18 01:46:01] [config] lr-warmup-at-reload: false
[2023-07-18 01:46:01] [config] lr-warmup-cycle: false
[2023-07-18 01:46:01] [config] lr-warmup-start-rate: 0
[2023-07-18 01:46:01] [config] max-length: 200
[2023-07-18 01:46:01] [config] max-length-crop: true
[2023-07-18 01:46:01] [config] max-length-factor: 3
[2023-07-18 01:46:01] [config] maxi-batch: 100
[2023-07-18 01:46:01] [config] maxi-batch-sort: trg
[2023-07-18 01:46:01] [config] mini-batch: 64
[2023-07-18 01:46:01] [config] mini-batch-fit: true
[2023-07-18 01:46:01] [config] mini-batch-fit-step: 10
[2023-07-18 01:46:01] [config] mini-batch-round-up: true
[2023-07-18 01:46:01] [config] mini-batch-track-lr: false
[2023-07-18 01:46:01] [config] mini-batch-warmup: 0
[2023-07-18 01:46:01] [config] mini-batch-words: 0
[2023-07-18 01:46:01] [config] mini-batch-words-ref: 0
[2023-07-18 01:46:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 01:46:01] [config] multi-loss-type: sum
[2023-07-18 01:46:01] [config] n-best: false
[2023-07-18 01:46:01] [config] no-nccl: false
[2023-07-18 01:46:01] [config] no-reload: false
[2023-07-18 01:46:01] [config] no-restore-corpus: false
[2023-07-18 01:46:01] [config] normalize: 0
[2023-07-18 01:46:01] [config] normalize-gradient: false
[2023-07-18 01:46:01] [config] num-devices: 0
[2023-07-18 01:46:01] [config] optimizer: adam
[2023-07-18 01:46:01] [config] optimizer-delay: 1
[2023-07-18 01:46:01] [config] optimizer-params:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] output-omit-bias: false
[2023-07-18 01:46:01] [config] overwrite: true
[2023-07-18 01:46:01] [config] precision:
[2023-07-18 01:46:01] [config]   - float16
[2023-07-18 01:46:01] [config]   - float32
[2023-07-18 01:46:01] [config] pretrained-model: ""
[2023-07-18 01:46:01] [config] quantize-biases: false
[2023-07-18 01:46:01] [config] quantize-bits: 0
[2023-07-18 01:46:01] [config] quantize-log-based: false
[2023-07-18 01:46:01] [config] quantize-optimization-steps: 0
[2023-07-18 01:46:01] [config] quiet: false
[2023-07-18 01:46:01] [config] quiet-translation: true
[2023-07-18 01:46:01] [config] relative-paths: false
[2023-07-18 01:46:01] [config] right-left: false
[2023-07-18 01:46:01] [config] save-freq: 10000u
[2023-07-18 01:46:01] [config] seed: 1234
[2023-07-18 01:46:01] [config] sentencepiece-alphas:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] sentencepiece-max-lines: 2000000
[2023-07-18 01:46:01] [config] sentencepiece-options: ""
[2023-07-18 01:46:01] [config] sharding: global
[2023-07-18 01:46:01] [config] shuffle: data
[2023-07-18 01:46:01] [config] shuffle-in-ram: false
[2023-07-18 01:46:01] [config] sigterm: save-and-exit
[2023-07-18 01:46:01] [config] skip: false
[2023-07-18 01:46:01] [config] sqlite: ""
[2023-07-18 01:46:01] [config] sqlite-drop: false
[2023-07-18 01:46:01] [config] sync-freq: 200u
[2023-07-18 01:46:01] [config] sync-sgd: false
[2023-07-18 01:46:01] [config] tempdir: /tmp
[2023-07-18 01:46:01] [config] tied-embeddings: false
[2023-07-18 01:46:01] [config] tied-embeddings-all: true
[2023-07-18 01:46:01] [config] tied-embeddings-src: false
[2023-07-18 01:46:01] [config] train-embedder-rank:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] train-sets:
[2023-07-18 01:46:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 01:46:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 01:46:01] [config] transformer-aan-activation: swish
[2023-07-18 01:46:01] [config] transformer-aan-depth: 2
[2023-07-18 01:46:01] [config] transformer-aan-nogate: false
[2023-07-18 01:46:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 01:46:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 01:46:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 01:46:01] [config] transformer-depth-scaling: false
[2023-07-18 01:46:01] [config] transformer-dim-aan: 2048
[2023-07-18 01:46:01] [config] transformer-dim-ffn: 2048
[2023-07-18 01:46:01] [config] transformer-dropout: 0
[2023-07-18 01:46:01] [config] transformer-dropout-attention: 0
[2023-07-18 01:46:01] [config] transformer-dropout-ffn: 0
[2023-07-18 01:46:01] [config] transformer-ffn-activation: swish
[2023-07-18 01:46:01] [config] transformer-ffn-depth: 2
[2023-07-18 01:46:01] [config] transformer-guided-alignment-layer: last
[2023-07-18 01:46:01] [config] transformer-heads: 8
[2023-07-18 01:46:01] [config] transformer-no-projection: false
[2023-07-18 01:46:01] [config] transformer-pool: false
[2023-07-18 01:46:01] [config] transformer-postprocess: dan
[2023-07-18 01:46:01] [config] transformer-postprocess-emb: d
[2023-07-18 01:46:01] [config] transformer-postprocess-top: ""
[2023-07-18 01:46:01] [config] transformer-preprocess: ""
[2023-07-18 01:46:01] [config] transformer-tied-layers:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] transformer-train-position-embeddings: false
[2023-07-18 01:46:01] [config] tsv: false
[2023-07-18 01:46:01] [config] tsv-fields: 0
[2023-07-18 01:46:01] [config] type: amun
[2023-07-18 01:46:01] [config] ulr: false
[2023-07-18 01:46:01] [config] ulr-dim-emb: 0
[2023-07-18 01:46:01] [config] ulr-dropout: 0
[2023-07-18 01:46:01] [config] ulr-keys-vectors: ""
[2023-07-18 01:46:01] [config] ulr-query-vectors: ""
[2023-07-18 01:46:01] [config] ulr-softmax-temperature: 1
[2023-07-18 01:46:01] [config] ulr-trainable-transformation: false
[2023-07-18 01:46:01] [config] unlikelihood-loss: false
[2023-07-18 01:46:01] [config] valid-freq: 50000000
[2023-07-18 01:46:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 01:46:01] [config] valid-max-length: 1000
[2023-07-18 01:46:01] [config] valid-metrics:
[2023-07-18 01:46:01] [config]   - cross-entropy
[2023-07-18 01:46:01] [config]   - translation
[2023-07-18 01:46:01] [config] valid-mini-batch: 32
[2023-07-18 01:46:01] [config] valid-reset-stalled: false
[2023-07-18 01:46:01] [config] valid-script-args:
[2023-07-18 01:46:01] [config]   []
[2023-07-18 01:46:01] [config] valid-script-path: ""
[2023-07-18 01:46:01] [config] valid-sets:
[2023-07-18 01:46:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 01:46:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 01:46:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 01:46:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 01:46:01] [config] vocabs:
[2023-07-18 01:46:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 01:46:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 01:46:01] [config] word-penalty: 0
[2023-07-18 01:46:01] [config] word-scores: false
[2023-07-18 01:46:01] [config] workspace: 5500
[2023-07-18 01:46:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 01:46:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 01:46:01] [training] Using single-device training
[2023-07-18 01:46:01] Synced seed 1234
[2023-07-18 01:46:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 01:46:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 01:46:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 01:46:02] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 01:46:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 01:46:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 01:46:02] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 01:46:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 01:46:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 01:46:03] [comm] Using global sharding
[2023-07-18 01:46:03] [comm] NCCLCommunicators constructed successfully
[2023-07-18 01:46:03] [training] Using 1 GPUs
[2023-07-18 01:46:03] [logits] Applying loss function for 1 factor(s)
[2023-07-18 01:46:03] [memory] Reserving 80 MB, device gpu0
[2023-07-18 01:46:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 01:46:03] [memory] Reserving 80 MB, device gpu0
[2023-07-18 02:21:50] [batching] Done. Typical MB size is 35,936 target words
[2023-07-18 02:21:50] [valid] No post-processing script given for validating translator
[2023-07-18 02:21:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 02:21:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 02:21:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 02:21:50] [comm] Using global sharding
[2023-07-18 02:21:51] [comm] NCCLCommunicators constructed successfully
[2023-07-18 02:21:51] [training] Using 1 GPUs
[2023-07-18 02:21:51] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 02:21:52] Allocating memory for general optimizer shards
[2023-07-18 02:21:52] [memory] Reserving 322 MB, device gpu0
[2023-07-18 02:21:52] Loading Adam parameters
[2023-07-18 02:21:52] [memory] Reserving 322 MB, device gpu0
[2023-07-18 02:21:52] [memory] Reserving 80 MB, device gpu0
[2023-07-18 02:21:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 02:21:52] [data] Restoring the corpus state to epoch 21, batch 769
[2023-07-18 02:21:52] [data] Shuffling data
[2023-07-18 02:21:52] [data] Done reading 20,192 sentences
[2023-07-18 02:21:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:21:52] Training started
[2023-07-18 02:21:52] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 02:21:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 02:21:58] Parameter type float16, optimization type float32, casting types true
[2023-07-18 02:26:32] Seen 20,192 samples
[2023-07-18 02:26:32] Starting data epoch 22 in logical epoch 22
[2023-07-18 02:26:32] [data] Shuffling data
[2023-07-18 02:26:32] [data] Done reading 20,192 sentences
[2023-07-18 02:26:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:30:58] Seen 20,192 samples
[2023-07-18 02:30:58] Starting data epoch 23 in logical epoch 23
[2023-07-18 02:30:58] [data] Shuffling data
[2023-07-18 02:30:58] [data] Done reading 20,192 sentences
[2023-07-18 02:30:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:35:34] Seen 20,192 samples
[2023-07-18 02:35:34] Starting data epoch 24 in logical epoch 24
[2023-07-18 02:35:34] [data] Shuffling data
[2023-07-18 02:35:34] [data] Done reading 20,192 sentences
[2023-07-18 02:35:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:40:17] Seen 20,192 samples
[2023-07-18 02:40:17] Starting data epoch 25 in logical epoch 25
[2023-07-18 02:40:17] [data] Shuffling data
[2023-07-18 02:40:17] [data] Done reading 20,192 sentences
[2023-07-18 02:40:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:44:43] Seen 20,192 samples
[2023-07-18 02:44:43] Starting data epoch 26 in logical epoch 26
[2023-07-18 02:44:43] [data] Shuffling data
[2023-07-18 02:44:43] [data] Done reading 20,192 sentences
[2023-07-18 02:44:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:49:10] Ep. 26 : Up. 1000 : Sen. 19,715 : Cost 6.27438784 * 16,112,045 @ 14,730 after 16,112,045 : Time 1639.61s : 9826.73 words/s : gNorm 0.9602
[2023-07-18 02:49:24] Seen 20,192 samples
[2023-07-18 02:49:24] Starting data epoch 27 in logical epoch 27
[2023-07-18 02:49:24] [data] Shuffling data
[2023-07-18 02:49:24] [data] Done reading 20,192 sentences
[2023-07-18 02:49:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:54:01] Seen 20,192 samples
[2023-07-18 02:54:01] Starting data epoch 28 in logical epoch 28
[2023-07-18 02:54:01] [data] Shuffling data
[2023-07-18 02:54:01] [data] Done reading 20,192 sentences
[2023-07-18 02:54:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 02:58:37] Seen 20,192 samples
[2023-07-18 02:58:37] Starting data epoch 29 in logical epoch 29
[2023-07-18 02:58:37] [data] Shuffling data
[2023-07-18 02:58:37] [data] Done reading 20,192 sentences
[2023-07-18 02:58:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 03:03:15] Seen 20,192 samples
[2023-07-18 03:03:15] Starting data epoch 30 in logical epoch 30
[2023-07-18 03:03:15] [data] Shuffling data
[2023-07-18 03:03:15] [data] Done reading 20,192 sentences
[2023-07-18 03:03:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 03:07:57] Seen 20,192 samples
[2023-07-18 03:07:57] Starting data epoch 31 in logical epoch 31
[2023-07-18 03:07:57] Training finished
[2023-07-18 03:08:07] [valid] Ep. 31 : Up. 1158 : cross-entropy : 158.048 : new best
[2023-07-18 03:10:41] [valid] Ep. 31 : Up. 1158 : translation : 0 : new best
[2023-07-18 03:10:41] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 03:10:43] Saving Adam parameters
[2023-07-18 03:10:43] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 03:10:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 03:10:51] [marian] Running on node22.datos.cluster.uy as process 20118 with command line:
[2023-07-18 03:10:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-18 03:10:51] [config] after: 0e
[2023-07-18 03:10:51] [config] after-batches: 0
[2023-07-18 03:10:51] [config] after-epochs: 40
[2023-07-18 03:10:51] [config] all-caps-every: 0
[2023-07-18 03:10:51] [config] allow-unk: false
[2023-07-18 03:10:51] [config] authors: false
[2023-07-18 03:10:51] [config] beam-size: 12
[2023-07-18 03:10:51] [config] bert-class-symbol: "[CLS]"
[2023-07-18 03:10:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 03:10:51] [config] bert-masking-fraction: 0.15
[2023-07-18 03:10:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 03:10:51] [config] bert-train-type-embeddings: true
[2023-07-18 03:10:51] [config] bert-type-vocab-size: 2
[2023-07-18 03:10:51] [config] build-info: ""
[2023-07-18 03:10:51] [config] check-gradient-nan: false
[2023-07-18 03:10:51] [config] check-nan: false
[2023-07-18 03:10:51] [config] cite: false
[2023-07-18 03:10:51] [config] clip-norm: 1
[2023-07-18 03:10:51] [config] cost-scaling:
[2023-07-18 03:10:51] [config]   - 256.f
[2023-07-18 03:10:51] [config]   - 1000
[2023-07-18 03:10:51] [config]   - 2.f
[2023-07-18 03:10:51] [config]   - 256.f
[2023-07-18 03:10:51] [config] cost-type: ce-sum
[2023-07-18 03:10:51] [config] cpu-threads: 0
[2023-07-18 03:10:51] [config] data-threads: 8
[2023-07-18 03:10:51] [config] data-weighting: ""
[2023-07-18 03:10:51] [config] data-weighting-type: sentence
[2023-07-18 03:10:51] [config] dec-cell: gru
[2023-07-18 03:10:51] [config] dec-cell-base-depth: 2
[2023-07-18 03:10:51] [config] dec-cell-high-depth: 1
[2023-07-18 03:10:51] [config] dec-depth: 1
[2023-07-18 03:10:51] [config] devices:
[2023-07-18 03:10:51] [config]   - 0
[2023-07-18 03:10:51] [config] dim-emb: 512
[2023-07-18 03:10:51] [config] dim-rnn: 1024
[2023-07-18 03:10:51] [config] dim-vocabs:
[2023-07-18 03:10:51] [config]   - 16384
[2023-07-18 03:10:51] [config]   - 16384
[2023-07-18 03:10:51] [config] disp-first: 0
[2023-07-18 03:10:51] [config] disp-freq: 1000u
[2023-07-18 03:10:51] [config] disp-label-counts: true
[2023-07-18 03:10:51] [config] dropout-rnn: 0
[2023-07-18 03:10:51] [config] dropout-src: 0
[2023-07-18 03:10:51] [config] dropout-trg: 0
[2023-07-18 03:10:51] [config] dump-config: ""
[2023-07-18 03:10:51] [config] dynamic-gradient-scaling:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] early-stopping: 5
[2023-07-18 03:10:51] [config] early-stopping-on: first
[2023-07-18 03:10:51] [config] embedding-fix-src: false
[2023-07-18 03:10:51] [config] embedding-fix-trg: false
[2023-07-18 03:10:51] [config] embedding-normalization: false
[2023-07-18 03:10:51] [config] embedding-vectors:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] enc-cell: gru
[2023-07-18 03:10:51] [config] enc-cell-depth: 1
[2023-07-18 03:10:51] [config] enc-depth: 1
[2023-07-18 03:10:51] [config] enc-type: bidirectional
[2023-07-18 03:10:51] [config] english-title-case-every: 0
[2023-07-18 03:10:51] [config] exponential-smoothing: 0
[2023-07-18 03:10:51] [config] factor-weight: 1
[2023-07-18 03:10:51] [config] factors-combine: sum
[2023-07-18 03:10:51] [config] factors-dim-emb: 0
[2023-07-18 03:10:51] [config] gradient-checkpointing: false
[2023-07-18 03:10:51] [config] gradient-norm-average-window: 100
[2023-07-18 03:10:51] [config] guided-alignment: none
[2023-07-18 03:10:51] [config] guided-alignment-cost: mse
[2023-07-18 03:10:51] [config] guided-alignment-weight: 0.1
[2023-07-18 03:10:51] [config] ignore-model-config: false
[2023-07-18 03:10:51] [config] input-types:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] interpolate-env-vars: false
[2023-07-18 03:10:51] [config] keep-best: false
[2023-07-18 03:10:51] [config] label-smoothing: 0
[2023-07-18 03:10:51] [config] layer-normalization: false
[2023-07-18 03:10:51] [config] learn-rate: 0.0001
[2023-07-18 03:10:51] [config] lemma-dependency: ""
[2023-07-18 03:10:51] [config] lemma-dim-emb: 0
[2023-07-18 03:10:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 03:10:51] [config] log-level: info
[2023-07-18 03:10:51] [config] log-time-zone: ""
[2023-07-18 03:10:51] [config] logical-epoch:
[2023-07-18 03:10:51] [config]   - 1e
[2023-07-18 03:10:51] [config]   - 0
[2023-07-18 03:10:51] [config] lr-decay: 0
[2023-07-18 03:10:51] [config] lr-decay-freq: 50000
[2023-07-18 03:10:51] [config] lr-decay-inv-sqrt:
[2023-07-18 03:10:51] [config]   - 0
[2023-07-18 03:10:51] [config] lr-decay-repeat-warmup: false
[2023-07-18 03:10:51] [config] lr-decay-reset-optimizer: false
[2023-07-18 03:10:51] [config] lr-decay-start:
[2023-07-18 03:10:51] [config]   - 10
[2023-07-18 03:10:51] [config]   - 1
[2023-07-18 03:10:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 03:10:51] [config] lr-report: false
[2023-07-18 03:10:51] [config] lr-warmup: 0
[2023-07-18 03:10:51] [config] lr-warmup-at-reload: false
[2023-07-18 03:10:51] [config] lr-warmup-cycle: false
[2023-07-18 03:10:51] [config] lr-warmup-start-rate: 0
[2023-07-18 03:10:51] [config] max-length: 200
[2023-07-18 03:10:51] [config] max-length-crop: true
[2023-07-18 03:10:51] [config] max-length-factor: 3
[2023-07-18 03:10:51] [config] maxi-batch: 100
[2023-07-18 03:10:51] [config] maxi-batch-sort: trg
[2023-07-18 03:10:51] [config] mini-batch: 64
[2023-07-18 03:10:51] [config] mini-batch-fit: true
[2023-07-18 03:10:51] [config] mini-batch-fit-step: 10
[2023-07-18 03:10:51] [config] mini-batch-round-up: true
[2023-07-18 03:10:51] [config] mini-batch-track-lr: false
[2023-07-18 03:10:51] [config] mini-batch-warmup: 0
[2023-07-18 03:10:51] [config] mini-batch-words: 0
[2023-07-18 03:10:51] [config] mini-batch-words-ref: 0
[2023-07-18 03:10:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 03:10:51] [config] multi-loss-type: sum
[2023-07-18 03:10:51] [config] n-best: false
[2023-07-18 03:10:51] [config] no-nccl: false
[2023-07-18 03:10:51] [config] no-reload: false
[2023-07-18 03:10:51] [config] no-restore-corpus: false
[2023-07-18 03:10:51] [config] normalize: 0
[2023-07-18 03:10:51] [config] normalize-gradient: false
[2023-07-18 03:10:51] [config] num-devices: 0
[2023-07-18 03:10:51] [config] optimizer: adam
[2023-07-18 03:10:51] [config] optimizer-delay: 1
[2023-07-18 03:10:51] [config] optimizer-params:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] output-omit-bias: false
[2023-07-18 03:10:51] [config] overwrite: true
[2023-07-18 03:10:51] [config] precision:
[2023-07-18 03:10:51] [config]   - float16
[2023-07-18 03:10:51] [config]   - float32
[2023-07-18 03:10:51] [config] pretrained-model: ""
[2023-07-18 03:10:51] [config] quantize-biases: false
[2023-07-18 03:10:51] [config] quantize-bits: 0
[2023-07-18 03:10:51] [config] quantize-log-based: false
[2023-07-18 03:10:51] [config] quantize-optimization-steps: 0
[2023-07-18 03:10:51] [config] quiet: false
[2023-07-18 03:10:51] [config] quiet-translation: true
[2023-07-18 03:10:51] [config] relative-paths: false
[2023-07-18 03:10:51] [config] right-left: false
[2023-07-18 03:10:51] [config] save-freq: 10000u
[2023-07-18 03:10:51] [config] seed: 1234
[2023-07-18 03:10:51] [config] sentencepiece-alphas:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] sentencepiece-max-lines: 2000000
[2023-07-18 03:10:51] [config] sentencepiece-options: ""
[2023-07-18 03:10:51] [config] sharding: global
[2023-07-18 03:10:51] [config] shuffle: data
[2023-07-18 03:10:51] [config] shuffle-in-ram: false
[2023-07-18 03:10:51] [config] sigterm: save-and-exit
[2023-07-18 03:10:51] [config] skip: false
[2023-07-18 03:10:51] [config] sqlite: ""
[2023-07-18 03:10:51] [config] sqlite-drop: false
[2023-07-18 03:10:51] [config] sync-freq: 200u
[2023-07-18 03:10:51] [config] sync-sgd: false
[2023-07-18 03:10:51] [config] tempdir: /tmp
[2023-07-18 03:10:51] [config] tied-embeddings: false
[2023-07-18 03:10:51] [config] tied-embeddings-all: true
[2023-07-18 03:10:51] [config] tied-embeddings-src: false
[2023-07-18 03:10:51] [config] train-embedder-rank:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] train-sets:
[2023-07-18 03:10:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 03:10:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 03:10:51] [config] transformer-aan-activation: swish
[2023-07-18 03:10:51] [config] transformer-aan-depth: 2
[2023-07-18 03:10:51] [config] transformer-aan-nogate: false
[2023-07-18 03:10:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 03:10:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 03:10:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 03:10:51] [config] transformer-depth-scaling: false
[2023-07-18 03:10:51] [config] transformer-dim-aan: 2048
[2023-07-18 03:10:51] [config] transformer-dim-ffn: 2048
[2023-07-18 03:10:51] [config] transformer-dropout: 0
[2023-07-18 03:10:51] [config] transformer-dropout-attention: 0
[2023-07-18 03:10:51] [config] transformer-dropout-ffn: 0
[2023-07-18 03:10:51] [config] transformer-ffn-activation: swish
[2023-07-18 03:10:51] [config] transformer-ffn-depth: 2
[2023-07-18 03:10:51] [config] transformer-guided-alignment-layer: last
[2023-07-18 03:10:51] [config] transformer-heads: 8
[2023-07-18 03:10:51] [config] transformer-no-projection: false
[2023-07-18 03:10:51] [config] transformer-pool: false
[2023-07-18 03:10:51] [config] transformer-postprocess: dan
[2023-07-18 03:10:51] [config] transformer-postprocess-emb: d
[2023-07-18 03:10:51] [config] transformer-postprocess-top: ""
[2023-07-18 03:10:51] [config] transformer-preprocess: ""
[2023-07-18 03:10:51] [config] transformer-tied-layers:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] transformer-train-position-embeddings: false
[2023-07-18 03:10:51] [config] tsv: false
[2023-07-18 03:10:51] [config] tsv-fields: 0
[2023-07-18 03:10:51] [config] type: amun
[2023-07-18 03:10:51] [config] ulr: false
[2023-07-18 03:10:51] [config] ulr-dim-emb: 0
[2023-07-18 03:10:51] [config] ulr-dropout: 0
[2023-07-18 03:10:51] [config] ulr-keys-vectors: ""
[2023-07-18 03:10:51] [config] ulr-query-vectors: ""
[2023-07-18 03:10:51] [config] ulr-softmax-temperature: 1
[2023-07-18 03:10:51] [config] ulr-trainable-transformation: false
[2023-07-18 03:10:51] [config] unlikelihood-loss: false
[2023-07-18 03:10:51] [config] valid-freq: 50000000
[2023-07-18 03:10:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 03:10:51] [config] valid-max-length: 1000
[2023-07-18 03:10:51] [config] valid-metrics:
[2023-07-18 03:10:51] [config]   - cross-entropy
[2023-07-18 03:10:51] [config]   - translation
[2023-07-18 03:10:51] [config] valid-mini-batch: 32
[2023-07-18 03:10:51] [config] valid-reset-stalled: false
[2023-07-18 03:10:51] [config] valid-script-args:
[2023-07-18 03:10:51] [config]   []
[2023-07-18 03:10:51] [config] valid-script-path: ""
[2023-07-18 03:10:51] [config] valid-sets:
[2023-07-18 03:10:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 03:10:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 03:10:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 03:10:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 03:10:51] [config] vocabs:
[2023-07-18 03:10:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 03:10:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 03:10:51] [config] word-penalty: 0
[2023-07-18 03:10:51] [config] word-scores: false
[2023-07-18 03:10:51] [config] workspace: 5500
[2023-07-18 03:10:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 03:10:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 03:10:51] [training] Using single-device training
[2023-07-18 03:10:51] Synced seed 1234
[2023-07-18 03:10:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 03:10:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 03:10:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 03:10:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 03:10:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 03:10:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 03:10:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 03:10:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 03:10:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 03:10:53] [comm] Using global sharding
[2023-07-18 03:10:53] [comm] NCCLCommunicators constructed successfully
[2023-07-18 03:10:53] [training] Using 1 GPUs
[2023-07-18 03:10:53] [logits] Applying loss function for 1 factor(s)
[2023-07-18 03:10:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 03:10:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 03:10:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 03:46:45] [batching] Done. Typical MB size is 35,936 target words
[2023-07-18 03:46:45] [valid] No post-processing script given for validating translator
[2023-07-18 03:46:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 03:46:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 03:46:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 03:46:45] [comm] Using global sharding
[2023-07-18 03:46:45] [comm] NCCLCommunicators constructed successfully
[2023-07-18 03:46:45] [training] Using 1 GPUs
[2023-07-18 03:46:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 03:46:47] Allocating memory for general optimizer shards
[2023-07-18 03:46:47] [memory] Reserving 322 MB, device gpu0
[2023-07-18 03:46:47] Loading Adam parameters
[2023-07-18 03:46:47] [memory] Reserving 322 MB, device gpu0
[2023-07-18 03:46:47] [memory] Reserving 80 MB, device gpu0
[2023-07-18 03:46:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 03:46:47] [data] Restoring the corpus state to epoch 31, batch 1158
[2023-07-18 03:46:47] [data] Shuffling data
[2023-07-18 03:46:47] [data] Done reading 20,192 sentences
[2023-07-18 03:46:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 03:46:47] Training started
[2023-07-18 03:46:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 03:46:48] [memory] Reserving 80 MB, device gpu0
[2023-07-18 03:46:52] Parameter type float16, optimization type float32, casting types true
[2023-07-18 03:51:34] Seen 20,192 samples
[2023-07-18 03:51:34] Starting data epoch 32 in logical epoch 32
[2023-07-18 03:51:34] [data] Shuffling data
[2023-07-18 03:51:34] [data] Done reading 20,192 sentences
[2023-07-18 03:51:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 03:55:58] Seen 20,192 samples
[2023-07-18 03:55:58] Starting data epoch 33 in logical epoch 33
[2023-07-18 03:55:58] [data] Shuffling data
[2023-07-18 03:55:58] [data] Done reading 20,192 sentences
[2023-07-18 03:55:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:00:35] Seen 20,192 samples
[2023-07-18 04:00:35] Starting data epoch 34 in logical epoch 34
[2023-07-18 04:00:35] [data] Shuffling data
[2023-07-18 04:00:35] [data] Done reading 20,192 sentences
[2023-07-18 04:00:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:05:14] Seen 20,192 samples
[2023-07-18 04:05:14] Starting data epoch 35 in logical epoch 35
[2023-07-18 04:05:14] [data] Shuffling data
[2023-07-18 04:05:14] [data] Done reading 20,192 sentences
[2023-07-18 04:05:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:09:42] Seen 20,192 samples
[2023-07-18 04:09:42] Starting data epoch 36 in logical epoch 36
[2023-07-18 04:09:42] [data] Shuffling data
[2023-07-18 04:09:42] [data] Done reading 20,192 sentences
[2023-07-18 04:09:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:14:22] Seen 20,192 samples
[2023-07-18 04:14:22] Starting data epoch 37 in logical epoch 37
[2023-07-18 04:14:22] [data] Shuffling data
[2023-07-18 04:14:22] [data] Done reading 20,192 sentences
[2023-07-18 04:14:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:19:06] Seen 20,192 samples
[2023-07-18 04:19:06] Starting data epoch 38 in logical epoch 38
[2023-07-18 04:19:06] [data] Shuffling data
[2023-07-18 04:19:06] [data] Done reading 20,192 sentences
[2023-07-18 04:19:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:23:48] Seen 20,192 samples
[2023-07-18 04:23:48] Starting data epoch 39 in logical epoch 39
[2023-07-18 04:23:48] [data] Shuffling data
[2023-07-18 04:23:48] [data] Done reading 20,192 sentences
[2023-07-18 04:23:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:28:21] Seen 20,192 samples
[2023-07-18 04:28:21] Starting data epoch 40 in logical epoch 40
[2023-07-18 04:28:21] [data] Shuffling data
[2023-07-18 04:28:21] [data] Done reading 20,192 sentences
[2023-07-18 04:28:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 04:32:53] Seen 20,192 samples
[2023-07-18 04:32:53] Starting data epoch 41 in logical epoch 41
[2023-07-18 04:32:53] Training finished
[2023-07-18 04:33:03] [valid] Ep. 41 : Up. 1545 : cross-entropy : 149.481 : new best
[2023-07-18 04:35:13] [valid] Ep. 41 : Up. 1545 : translation : 0 : new best
[2023-07-18 04:35:13] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 04:35:15] Saving Adam parameters
[2023-07-18 04:35:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 04:35:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 04:35:22] [marian] Running on node22.datos.cluster.uy as process 25600 with command line:
[2023-07-18 04:35:22] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-18 04:35:22] [config] after: 0e
[2023-07-18 04:35:22] [config] after-batches: 0
[2023-07-18 04:35:22] [config] after-epochs: 50
[2023-07-18 04:35:22] [config] all-caps-every: 0
[2023-07-18 04:35:22] [config] allow-unk: false
[2023-07-18 04:35:22] [config] authors: false
[2023-07-18 04:35:22] [config] beam-size: 12
[2023-07-18 04:35:22] [config] bert-class-symbol: "[CLS]"
[2023-07-18 04:35:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 04:35:22] [config] bert-masking-fraction: 0.15
[2023-07-18 04:35:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 04:35:22] [config] bert-train-type-embeddings: true
[2023-07-18 04:35:22] [config] bert-type-vocab-size: 2
[2023-07-18 04:35:22] [config] build-info: ""
[2023-07-18 04:35:22] [config] check-gradient-nan: false
[2023-07-18 04:35:22] [config] check-nan: false
[2023-07-18 04:35:22] [config] cite: false
[2023-07-18 04:35:22] [config] clip-norm: 1
[2023-07-18 04:35:22] [config] cost-scaling:
[2023-07-18 04:35:22] [config]   - 256.f
[2023-07-18 04:35:22] [config]   - 1000
[2023-07-18 04:35:22] [config]   - 2.f
[2023-07-18 04:35:22] [config]   - 256.f
[2023-07-18 04:35:22] [config] cost-type: ce-sum
[2023-07-18 04:35:22] [config] cpu-threads: 0
[2023-07-18 04:35:22] [config] data-threads: 8
[2023-07-18 04:35:22] [config] data-weighting: ""
[2023-07-18 04:35:22] [config] data-weighting-type: sentence
[2023-07-18 04:35:22] [config] dec-cell: gru
[2023-07-18 04:35:22] [config] dec-cell-base-depth: 2
[2023-07-18 04:35:22] [config] dec-cell-high-depth: 1
[2023-07-18 04:35:22] [config] dec-depth: 1
[2023-07-18 04:35:22] [config] devices:
[2023-07-18 04:35:22] [config]   - 0
[2023-07-18 04:35:22] [config] dim-emb: 512
[2023-07-18 04:35:22] [config] dim-rnn: 1024
[2023-07-18 04:35:22] [config] dim-vocabs:
[2023-07-18 04:35:22] [config]   - 16384
[2023-07-18 04:35:22] [config]   - 16384
[2023-07-18 04:35:22] [config] disp-first: 0
[2023-07-18 04:35:22] [config] disp-freq: 1000u
[2023-07-18 04:35:22] [config] disp-label-counts: true
[2023-07-18 04:35:22] [config] dropout-rnn: 0
[2023-07-18 04:35:22] [config] dropout-src: 0
[2023-07-18 04:35:22] [config] dropout-trg: 0
[2023-07-18 04:35:22] [config] dump-config: ""
[2023-07-18 04:35:22] [config] dynamic-gradient-scaling:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] early-stopping: 5
[2023-07-18 04:35:22] [config] early-stopping-on: first
[2023-07-18 04:35:22] [config] embedding-fix-src: false
[2023-07-18 04:35:22] [config] embedding-fix-trg: false
[2023-07-18 04:35:22] [config] embedding-normalization: false
[2023-07-18 04:35:22] [config] embedding-vectors:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] enc-cell: gru
[2023-07-18 04:35:22] [config] enc-cell-depth: 1
[2023-07-18 04:35:22] [config] enc-depth: 1
[2023-07-18 04:35:22] [config] enc-type: bidirectional
[2023-07-18 04:35:22] [config] english-title-case-every: 0
[2023-07-18 04:35:22] [config] exponential-smoothing: 0
[2023-07-18 04:35:22] [config] factor-weight: 1
[2023-07-18 04:35:22] [config] factors-combine: sum
[2023-07-18 04:35:22] [config] factors-dim-emb: 0
[2023-07-18 04:35:22] [config] gradient-checkpointing: false
[2023-07-18 04:35:22] [config] gradient-norm-average-window: 100
[2023-07-18 04:35:22] [config] guided-alignment: none
[2023-07-18 04:35:22] [config] guided-alignment-cost: mse
[2023-07-18 04:35:22] [config] guided-alignment-weight: 0.1
[2023-07-18 04:35:22] [config] ignore-model-config: false
[2023-07-18 04:35:22] [config] input-types:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] interpolate-env-vars: false
[2023-07-18 04:35:22] [config] keep-best: false
[2023-07-18 04:35:22] [config] label-smoothing: 0
[2023-07-18 04:35:22] [config] layer-normalization: false
[2023-07-18 04:35:22] [config] learn-rate: 0.0001
[2023-07-18 04:35:22] [config] lemma-dependency: ""
[2023-07-18 04:35:22] [config] lemma-dim-emb: 0
[2023-07-18 04:35:22] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 04:35:22] [config] log-level: info
[2023-07-18 04:35:22] [config] log-time-zone: ""
[2023-07-18 04:35:22] [config] logical-epoch:
[2023-07-18 04:35:22] [config]   - 1e
[2023-07-18 04:35:22] [config]   - 0
[2023-07-18 04:35:22] [config] lr-decay: 0
[2023-07-18 04:35:22] [config] lr-decay-freq: 50000
[2023-07-18 04:35:22] [config] lr-decay-inv-sqrt:
[2023-07-18 04:35:22] [config]   - 0
[2023-07-18 04:35:22] [config] lr-decay-repeat-warmup: false
[2023-07-18 04:35:22] [config] lr-decay-reset-optimizer: false
[2023-07-18 04:35:22] [config] lr-decay-start:
[2023-07-18 04:35:22] [config]   - 10
[2023-07-18 04:35:22] [config]   - 1
[2023-07-18 04:35:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 04:35:22] [config] lr-report: false
[2023-07-18 04:35:22] [config] lr-warmup: 0
[2023-07-18 04:35:22] [config] lr-warmup-at-reload: false
[2023-07-18 04:35:22] [config] lr-warmup-cycle: false
[2023-07-18 04:35:22] [config] lr-warmup-start-rate: 0
[2023-07-18 04:35:22] [config] max-length: 200
[2023-07-18 04:35:22] [config] max-length-crop: true
[2023-07-18 04:35:22] [config] max-length-factor: 3
[2023-07-18 04:35:22] [config] maxi-batch: 100
[2023-07-18 04:35:22] [config] maxi-batch-sort: trg
[2023-07-18 04:35:22] [config] mini-batch: 64
[2023-07-18 04:35:22] [config] mini-batch-fit: true
[2023-07-18 04:35:22] [config] mini-batch-fit-step: 10
[2023-07-18 04:35:22] [config] mini-batch-round-up: true
[2023-07-18 04:35:22] [config] mini-batch-track-lr: false
[2023-07-18 04:35:22] [config] mini-batch-warmup: 0
[2023-07-18 04:35:22] [config] mini-batch-words: 0
[2023-07-18 04:35:22] [config] mini-batch-words-ref: 0
[2023-07-18 04:35:22] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 04:35:22] [config] multi-loss-type: sum
[2023-07-18 04:35:22] [config] n-best: false
[2023-07-18 04:35:22] [config] no-nccl: false
[2023-07-18 04:35:22] [config] no-reload: false
[2023-07-18 04:35:22] [config] no-restore-corpus: false
[2023-07-18 04:35:22] [config] normalize: 0
[2023-07-18 04:35:22] [config] normalize-gradient: false
[2023-07-18 04:35:22] [config] num-devices: 0
[2023-07-18 04:35:22] [config] optimizer: adam
[2023-07-18 04:35:22] [config] optimizer-delay: 1
[2023-07-18 04:35:22] [config] optimizer-params:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] output-omit-bias: false
[2023-07-18 04:35:22] [config] overwrite: true
[2023-07-18 04:35:22] [config] precision:
[2023-07-18 04:35:22] [config]   - float16
[2023-07-18 04:35:22] [config]   - float32
[2023-07-18 04:35:22] [config] pretrained-model: ""
[2023-07-18 04:35:22] [config] quantize-biases: false
[2023-07-18 04:35:22] [config] quantize-bits: 0
[2023-07-18 04:35:22] [config] quantize-log-based: false
[2023-07-18 04:35:22] [config] quantize-optimization-steps: 0
[2023-07-18 04:35:22] [config] quiet: false
[2023-07-18 04:35:22] [config] quiet-translation: true
[2023-07-18 04:35:22] [config] relative-paths: false
[2023-07-18 04:35:22] [config] right-left: false
[2023-07-18 04:35:22] [config] save-freq: 10000u
[2023-07-18 04:35:22] [config] seed: 1234
[2023-07-18 04:35:22] [config] sentencepiece-alphas:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] sentencepiece-max-lines: 2000000
[2023-07-18 04:35:22] [config] sentencepiece-options: ""
[2023-07-18 04:35:22] [config] sharding: global
[2023-07-18 04:35:22] [config] shuffle: data
[2023-07-18 04:35:22] [config] shuffle-in-ram: false
[2023-07-18 04:35:22] [config] sigterm: save-and-exit
[2023-07-18 04:35:22] [config] skip: false
[2023-07-18 04:35:22] [config] sqlite: ""
[2023-07-18 04:35:22] [config] sqlite-drop: false
[2023-07-18 04:35:22] [config] sync-freq: 200u
[2023-07-18 04:35:22] [config] sync-sgd: false
[2023-07-18 04:35:22] [config] tempdir: /tmp
[2023-07-18 04:35:22] [config] tied-embeddings: false
[2023-07-18 04:35:22] [config] tied-embeddings-all: true
[2023-07-18 04:35:22] [config] tied-embeddings-src: false
[2023-07-18 04:35:22] [config] train-embedder-rank:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] train-sets:
[2023-07-18 04:35:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 04:35:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 04:35:22] [config] transformer-aan-activation: swish
[2023-07-18 04:35:22] [config] transformer-aan-depth: 2
[2023-07-18 04:35:22] [config] transformer-aan-nogate: false
[2023-07-18 04:35:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 04:35:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 04:35:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 04:35:22] [config] transformer-depth-scaling: false
[2023-07-18 04:35:22] [config] transformer-dim-aan: 2048
[2023-07-18 04:35:22] [config] transformer-dim-ffn: 2048
[2023-07-18 04:35:22] [config] transformer-dropout: 0
[2023-07-18 04:35:22] [config] transformer-dropout-attention: 0
[2023-07-18 04:35:22] [config] transformer-dropout-ffn: 0
[2023-07-18 04:35:22] [config] transformer-ffn-activation: swish
[2023-07-18 04:35:22] [config] transformer-ffn-depth: 2
[2023-07-18 04:35:22] [config] transformer-guided-alignment-layer: last
[2023-07-18 04:35:22] [config] transformer-heads: 8
[2023-07-18 04:35:22] [config] transformer-no-projection: false
[2023-07-18 04:35:22] [config] transformer-pool: false
[2023-07-18 04:35:22] [config] transformer-postprocess: dan
[2023-07-18 04:35:22] [config] transformer-postprocess-emb: d
[2023-07-18 04:35:22] [config] transformer-postprocess-top: ""
[2023-07-18 04:35:22] [config] transformer-preprocess: ""
[2023-07-18 04:35:22] [config] transformer-tied-layers:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] transformer-train-position-embeddings: false
[2023-07-18 04:35:22] [config] tsv: false
[2023-07-18 04:35:22] [config] tsv-fields: 0
[2023-07-18 04:35:22] [config] type: amun
[2023-07-18 04:35:22] [config] ulr: false
[2023-07-18 04:35:22] [config] ulr-dim-emb: 0
[2023-07-18 04:35:22] [config] ulr-dropout: 0
[2023-07-18 04:35:22] [config] ulr-keys-vectors: ""
[2023-07-18 04:35:22] [config] ulr-query-vectors: ""
[2023-07-18 04:35:22] [config] ulr-softmax-temperature: 1
[2023-07-18 04:35:22] [config] ulr-trainable-transformation: false
[2023-07-18 04:35:22] [config] unlikelihood-loss: false
[2023-07-18 04:35:22] [config] valid-freq: 50000000
[2023-07-18 04:35:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 04:35:22] [config] valid-max-length: 1000
[2023-07-18 04:35:22] [config] valid-metrics:
[2023-07-18 04:35:22] [config]   - cross-entropy
[2023-07-18 04:35:22] [config]   - translation
[2023-07-18 04:35:22] [config] valid-mini-batch: 32
[2023-07-18 04:35:22] [config] valid-reset-stalled: false
[2023-07-18 04:35:22] [config] valid-script-args:
[2023-07-18 04:35:22] [config]   []
[2023-07-18 04:35:22] [config] valid-script-path: ""
[2023-07-18 04:35:22] [config] valid-sets:
[2023-07-18 04:35:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 04:35:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 04:35:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 04:35:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 04:35:22] [config] vocabs:
[2023-07-18 04:35:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 04:35:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 04:35:22] [config] word-penalty: 0
[2023-07-18 04:35:22] [config] word-scores: false
[2023-07-18 04:35:22] [config] workspace: 5500
[2023-07-18 04:35:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 04:35:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 04:35:22] [training] Using single-device training
[2023-07-18 04:35:22] Synced seed 1234
[2023-07-18 04:35:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 04:35:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 04:35:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 04:35:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 04:35:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 04:35:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 04:35:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 04:35:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 04:35:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 04:35:23] [comm] Using global sharding
[2023-07-18 04:35:24] [comm] NCCLCommunicators constructed successfully
[2023-07-18 04:35:24] [training] Using 1 GPUs
[2023-07-18 04:35:24] [logits] Applying loss function for 1 factor(s)
[2023-07-18 04:35:24] [memory] Reserving 80 MB, device gpu0
[2023-07-18 04:35:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 04:35:24] [memory] Reserving 80 MB, device gpu0
[2023-07-18 05:11:33] [batching] Done. Typical MB size is 35,936 target words
[2023-07-18 05:11:33] [valid] No post-processing script given for validating translator
[2023-07-18 05:11:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 05:11:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 05:11:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 05:11:33] [comm] Using global sharding
[2023-07-18 05:11:33] [comm] NCCLCommunicators constructed successfully
[2023-07-18 05:11:33] [training] Using 1 GPUs
[2023-07-18 05:11:33] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 05:11:34] Allocating memory for general optimizer shards
[2023-07-18 05:11:34] [memory] Reserving 322 MB, device gpu0
[2023-07-18 05:11:34] Loading Adam parameters
[2023-07-18 05:11:34] [memory] Reserving 322 MB, device gpu0
[2023-07-18 05:11:35] [memory] Reserving 80 MB, device gpu0
[2023-07-18 05:11:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 05:11:35] [data] Restoring the corpus state to epoch 41, batch 1545
[2023-07-18 05:11:35] [data] Shuffling data
[2023-07-18 05:11:35] [data] Done reading 20,192 sentences
[2023-07-18 05:11:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:11:35] Training started
[2023-07-18 05:11:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 05:11:36] [memory] Reserving 80 MB, device gpu0
[2023-07-18 05:11:43] Parameter type float16, optimization type float32, casting types true
[2023-07-18 05:15:49] Seen 20,192 samples
[2023-07-18 05:15:49] Starting data epoch 42 in logical epoch 42
[2023-07-18 05:15:49] [data] Shuffling data
[2023-07-18 05:15:49] [data] Done reading 20,192 sentences
[2023-07-18 05:15:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:20:13] Seen 20,192 samples
[2023-07-18 05:20:13] Starting data epoch 43 in logical epoch 43
[2023-07-18 05:20:13] [data] Shuffling data
[2023-07-18 05:20:13] [data] Done reading 20,192 sentences
[2023-07-18 05:20:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:24:38] Seen 20,192 samples
[2023-07-18 05:24:38] Starting data epoch 44 in logical epoch 44
[2023-07-18 05:24:38] [data] Shuffling data
[2023-07-18 05:24:38] [data] Done reading 20,192 sentences
[2023-07-18 05:24:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:28:54] Seen 20,192 samples
[2023-07-18 05:28:54] Starting data epoch 45 in logical epoch 45
[2023-07-18 05:28:54] [data] Shuffling data
[2023-07-18 05:28:54] [data] Done reading 20,192 sentences
[2023-07-18 05:28:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:33:23] Seen 20,192 samples
[2023-07-18 05:33:23] Starting data epoch 46 in logical epoch 46
[2023-07-18 05:33:23] [data] Shuffling data
[2023-07-18 05:33:23] [data] Done reading 20,192 sentences
[2023-07-18 05:33:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:37:54] Seen 20,192 samples
[2023-07-18 05:37:54] Starting data epoch 47 in logical epoch 47
[2023-07-18 05:37:54] [data] Shuffling data
[2023-07-18 05:37:54] [data] Done reading 20,192 sentences
[2023-07-18 05:37:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:42:22] Seen 20,192 samples
[2023-07-18 05:42:22] Starting data epoch 48 in logical epoch 48
[2023-07-18 05:42:22] [data] Shuffling data
[2023-07-18 05:42:22] [data] Done reading 20,192 sentences
[2023-07-18 05:42:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:46:46] Seen 20,192 samples
[2023-07-18 05:46:46] Starting data epoch 49 in logical epoch 49
[2023-07-18 05:46:46] [data] Shuffling data
[2023-07-18 05:46:46] [data] Done reading 20,192 sentences
[2023-07-18 05:46:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:51:14] Seen 20,192 samples
[2023-07-18 05:51:14] Starting data epoch 50 in logical epoch 50
[2023-07-18 05:51:14] [data] Shuffling data
[2023-07-18 05:51:14] [data] Done reading 20,192 sentences
[2023-07-18 05:51:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 05:55:36] Seen 20,192 samples
[2023-07-18 05:55:36] Starting data epoch 51 in logical epoch 51
[2023-07-18 05:55:36] Training finished
[2023-07-18 05:55:47] [valid] Ep. 51 : Up. 1930 : cross-entropy : 143.884 : new best
[2023-07-18 05:58:02] [valid] Ep. 51 : Up. 1930 : translation : 0 : new best
[2023-07-18 05:58:02] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 05:58:04] Saving Adam parameters
[2023-07-18 05:58:04] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 05:58:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 05:58:11] [marian] Running on node22.datos.cluster.uy as process 30963 with command line:
[2023-07-18 05:58:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 5 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-18 05:58:11] [config] after: 0e
[2023-07-18 05:58:11] [config] after-batches: 0
[2023-07-18 05:58:11] [config] after-epochs: 60
[2023-07-18 05:58:11] [config] all-caps-every: 0
[2023-07-18 05:58:11] [config] allow-unk: false
[2023-07-18 05:58:11] [config] authors: false
[2023-07-18 05:58:11] [config] beam-size: 12
[2023-07-18 05:58:11] [config] bert-class-symbol: "[CLS]"
[2023-07-18 05:58:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 05:58:11] [config] bert-masking-fraction: 0.15
[2023-07-18 05:58:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 05:58:11] [config] bert-train-type-embeddings: true
[2023-07-18 05:58:11] [config] bert-type-vocab-size: 2
[2023-07-18 05:58:11] [config] build-info: ""
[2023-07-18 05:58:11] [config] check-gradient-nan: false
[2023-07-18 05:58:11] [config] check-nan: false
[2023-07-18 05:58:11] [config] cite: false
[2023-07-18 05:58:11] [config] clip-norm: 1
[2023-07-18 05:58:11] [config] cost-scaling:
[2023-07-18 05:58:11] [config]   - 256.f
[2023-07-18 05:58:11] [config]   - 1000
[2023-07-18 05:58:11] [config]   - 2.f
[2023-07-18 05:58:11] [config]   - 256.f
[2023-07-18 05:58:11] [config] cost-type: ce-sum
[2023-07-18 05:58:11] [config] cpu-threads: 0
[2023-07-18 05:58:11] [config] data-threads: 8
[2023-07-18 05:58:11] [config] data-weighting: ""
[2023-07-18 05:58:11] [config] data-weighting-type: sentence
[2023-07-18 05:58:11] [config] dec-cell: gru
[2023-07-18 05:58:11] [config] dec-cell-base-depth: 2
[2023-07-18 05:58:11] [config] dec-cell-high-depth: 1
[2023-07-18 05:58:11] [config] dec-depth: 1
[2023-07-18 05:58:11] [config] devices:
[2023-07-18 05:58:11] [config]   - 0
[2023-07-18 05:58:11] [config] dim-emb: 512
[2023-07-18 05:58:11] [config] dim-rnn: 1024
[2023-07-18 05:58:11] [config] dim-vocabs:
[2023-07-18 05:58:11] [config]   - 16384
[2023-07-18 05:58:11] [config]   - 16384
[2023-07-18 05:58:11] [config] disp-first: 0
[2023-07-18 05:58:11] [config] disp-freq: 1000u
[2023-07-18 05:58:11] [config] disp-label-counts: true
[2023-07-18 05:58:11] [config] dropout-rnn: 0
[2023-07-18 05:58:11] [config] dropout-src: 0
[2023-07-18 05:58:11] [config] dropout-trg: 0
[2023-07-18 05:58:11] [config] dump-config: ""
[2023-07-18 05:58:11] [config] dynamic-gradient-scaling:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] early-stopping: 5
[2023-07-18 05:58:11] [config] early-stopping-on: first
[2023-07-18 05:58:11] [config] embedding-fix-src: false
[2023-07-18 05:58:11] [config] embedding-fix-trg: false
[2023-07-18 05:58:11] [config] embedding-normalization: false
[2023-07-18 05:58:11] [config] embedding-vectors:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] enc-cell: gru
[2023-07-18 05:58:11] [config] enc-cell-depth: 1
[2023-07-18 05:58:11] [config] enc-depth: 1
[2023-07-18 05:58:11] [config] enc-type: bidirectional
[2023-07-18 05:58:11] [config] english-title-case-every: 0
[2023-07-18 05:58:11] [config] exponential-smoothing: 0
[2023-07-18 05:58:11] [config] factor-weight: 1
[2023-07-18 05:58:11] [config] factors-combine: sum
[2023-07-18 05:58:11] [config] factors-dim-emb: 0
[2023-07-18 05:58:11] [config] gradient-checkpointing: false
[2023-07-18 05:58:11] [config] gradient-norm-average-window: 100
[2023-07-18 05:58:11] [config] guided-alignment: none
[2023-07-18 05:58:11] [config] guided-alignment-cost: mse
[2023-07-18 05:58:11] [config] guided-alignment-weight: 0.1
[2023-07-18 05:58:11] [config] ignore-model-config: false
[2023-07-18 05:58:11] [config] input-types:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] interpolate-env-vars: false
[2023-07-18 05:58:11] [config] keep-best: false
[2023-07-18 05:58:11] [config] label-smoothing: 0
[2023-07-18 05:58:11] [config] layer-normalization: false
[2023-07-18 05:58:11] [config] learn-rate: 0.0001
[2023-07-18 05:58:11] [config] lemma-dependency: ""
[2023-07-18 05:58:11] [config] lemma-dim-emb: 0
[2023-07-18 05:58:11] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 05:58:11] [config] log-level: info
[2023-07-18 05:58:11] [config] log-time-zone: ""
[2023-07-18 05:58:11] [config] logical-epoch:
[2023-07-18 05:58:11] [config]   - 1e
[2023-07-18 05:58:11] [config]   - 0
[2023-07-18 05:58:11] [config] lr-decay: 0
[2023-07-18 05:58:11] [config] lr-decay-freq: 50000
[2023-07-18 05:58:11] [config] lr-decay-inv-sqrt:
[2023-07-18 05:58:11] [config]   - 0
[2023-07-18 05:58:11] [config] lr-decay-repeat-warmup: false
[2023-07-18 05:58:11] [config] lr-decay-reset-optimizer: false
[2023-07-18 05:58:11] [config] lr-decay-start:
[2023-07-18 05:58:11] [config]   - 10
[2023-07-18 05:58:11] [config]   - 1
[2023-07-18 05:58:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 05:58:11] [config] lr-report: false
[2023-07-18 05:58:11] [config] lr-warmup: 0
[2023-07-18 05:58:11] [config] lr-warmup-at-reload: false
[2023-07-18 05:58:11] [config] lr-warmup-cycle: false
[2023-07-18 05:58:11] [config] lr-warmup-start-rate: 0
[2023-07-18 05:58:11] [config] max-length: 200
[2023-07-18 05:58:11] [config] max-length-crop: true
[2023-07-18 05:58:11] [config] max-length-factor: 3
[2023-07-18 05:58:11] [config] maxi-batch: 100
[2023-07-18 05:58:11] [config] maxi-batch-sort: trg
[2023-07-18 05:58:11] [config] mini-batch: 64
[2023-07-18 05:58:11] [config] mini-batch-fit: true
[2023-07-18 05:58:11] [config] mini-batch-fit-step: 10
[2023-07-18 05:58:11] [config] mini-batch-round-up: true
[2023-07-18 05:58:11] [config] mini-batch-track-lr: false
[2023-07-18 05:58:11] [config] mini-batch-warmup: 0
[2023-07-18 05:58:11] [config] mini-batch-words: 0
[2023-07-18 05:58:11] [config] mini-batch-words-ref: 0
[2023-07-18 05:58:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 05:58:11] [config] multi-loss-type: sum
[2023-07-18 05:58:11] [config] n-best: false
[2023-07-18 05:58:11] [config] no-nccl: false
[2023-07-18 05:58:11] [config] no-reload: false
[2023-07-18 05:58:11] [config] no-restore-corpus: false
[2023-07-18 05:58:11] [config] normalize: 0
[2023-07-18 05:58:11] [config] normalize-gradient: false
[2023-07-18 05:58:11] [config] num-devices: 0
[2023-07-18 05:58:11] [config] optimizer: adam
[2023-07-18 05:58:11] [config] optimizer-delay: 1
[2023-07-18 05:58:11] [config] optimizer-params:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] output-omit-bias: false
[2023-07-18 05:58:11] [config] overwrite: true
[2023-07-18 05:58:11] [config] precision:
[2023-07-18 05:58:11] [config]   - float16
[2023-07-18 05:58:11] [config]   - float32
[2023-07-18 05:58:11] [config] pretrained-model: ""
[2023-07-18 05:58:11] [config] quantize-biases: false
[2023-07-18 05:58:11] [config] quantize-bits: 0
[2023-07-18 05:58:11] [config] quantize-log-based: false
[2023-07-18 05:58:11] [config] quantize-optimization-steps: 0
[2023-07-18 05:58:11] [config] quiet: false
[2023-07-18 05:58:11] [config] quiet-translation: true
[2023-07-18 05:58:11] [config] relative-paths: false
[2023-07-18 05:58:11] [config] right-left: false
[2023-07-18 05:58:11] [config] save-freq: 10000u
[2023-07-18 05:58:11] [config] seed: 1234
[2023-07-18 05:58:11] [config] sentencepiece-alphas:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] sentencepiece-max-lines: 2000000
[2023-07-18 05:58:11] [config] sentencepiece-options: ""
[2023-07-18 05:58:11] [config] sharding: global
[2023-07-18 05:58:11] [config] shuffle: data
[2023-07-18 05:58:11] [config] shuffle-in-ram: false
[2023-07-18 05:58:11] [config] sigterm: save-and-exit
[2023-07-18 05:58:11] [config] skip: false
[2023-07-18 05:58:11] [config] sqlite: ""
[2023-07-18 05:58:11] [config] sqlite-drop: false
[2023-07-18 05:58:11] [config] sync-freq: 200u
[2023-07-18 05:58:11] [config] sync-sgd: false
[2023-07-18 05:58:11] [config] tempdir: /tmp
[2023-07-18 05:58:11] [config] tied-embeddings: false
[2023-07-18 05:58:11] [config] tied-embeddings-all: true
[2023-07-18 05:58:11] [config] tied-embeddings-src: false
[2023-07-18 05:58:11] [config] train-embedder-rank:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] train-sets:
[2023-07-18 05:58:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 05:58:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 05:58:11] [config] transformer-aan-activation: swish
[2023-07-18 05:58:11] [config] transformer-aan-depth: 2
[2023-07-18 05:58:11] [config] transformer-aan-nogate: false
[2023-07-18 05:58:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 05:58:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 05:58:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 05:58:11] [config] transformer-depth-scaling: false
[2023-07-18 05:58:11] [config] transformer-dim-aan: 2048
[2023-07-18 05:58:11] [config] transformer-dim-ffn: 2048
[2023-07-18 05:58:11] [config] transformer-dropout: 0
[2023-07-18 05:58:11] [config] transformer-dropout-attention: 0
[2023-07-18 05:58:11] [config] transformer-dropout-ffn: 0
[2023-07-18 05:58:11] [config] transformer-ffn-activation: swish
[2023-07-18 05:58:11] [config] transformer-ffn-depth: 2
[2023-07-18 05:58:11] [config] transformer-guided-alignment-layer: last
[2023-07-18 05:58:11] [config] transformer-heads: 8
[2023-07-18 05:58:11] [config] transformer-no-projection: false
[2023-07-18 05:58:11] [config] transformer-pool: false
[2023-07-18 05:58:11] [config] transformer-postprocess: dan
[2023-07-18 05:58:11] [config] transformer-postprocess-emb: d
[2023-07-18 05:58:11] [config] transformer-postprocess-top: ""
[2023-07-18 05:58:11] [config] transformer-preprocess: ""
[2023-07-18 05:58:11] [config] transformer-tied-layers:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] transformer-train-position-embeddings: false
[2023-07-18 05:58:11] [config] tsv: false
[2023-07-18 05:58:11] [config] tsv-fields: 0
[2023-07-18 05:58:11] [config] type: amun
[2023-07-18 05:58:11] [config] ulr: false
[2023-07-18 05:58:11] [config] ulr-dim-emb: 0
[2023-07-18 05:58:11] [config] ulr-dropout: 0
[2023-07-18 05:58:11] [config] ulr-keys-vectors: ""
[2023-07-18 05:58:11] [config] ulr-query-vectors: ""
[2023-07-18 05:58:11] [config] ulr-softmax-temperature: 1
[2023-07-18 05:58:11] [config] ulr-trainable-transformation: false
[2023-07-18 05:58:11] [config] unlikelihood-loss: false
[2023-07-18 05:58:11] [config] valid-freq: 50000000
[2023-07-18 05:58:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 05:58:11] [config] valid-max-length: 1000
[2023-07-18 05:58:11] [config] valid-metrics:
[2023-07-18 05:58:11] [config]   - cross-entropy
[2023-07-18 05:58:11] [config]   - translation
[2023-07-18 05:58:11] [config] valid-mini-batch: 32
[2023-07-18 05:58:11] [config] valid-reset-stalled: false
[2023-07-18 05:58:11] [config] valid-script-args:
[2023-07-18 05:58:11] [config]   []
[2023-07-18 05:58:11] [config] valid-script-path: ""
[2023-07-18 05:58:11] [config] valid-sets:
[2023-07-18 05:58:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 05:58:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 05:58:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 05:58:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 05:58:11] [config] vocabs:
[2023-07-18 05:58:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 05:58:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 05:58:11] [config] word-penalty: 0
[2023-07-18 05:58:11] [config] word-scores: false
[2023-07-18 05:58:11] [config] workspace: 5500
[2023-07-18 05:58:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 05:58:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 05:58:11] [training] Using single-device training
[2023-07-18 05:58:11] Synced seed 1234
[2023-07-18 05:58:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 05:58:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 05:58:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 05:58:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 05:58:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 05:58:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 05:58:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 05:58:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 05:58:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 05:58:13] [comm] Using global sharding
[2023-07-18 05:58:13] [comm] NCCLCommunicators constructed successfully
[2023-07-18 05:58:13] [training] Using 1 GPUs
[2023-07-18 05:58:13] [logits] Applying loss function for 1 factor(s)
[2023-07-18 05:58:13] [memory] Reserving 80 MB, device gpu0
[2023-07-18 05:58:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 05:58:13] [memory] Reserving 80 MB, device gpu0
[2023-07-18 06:33:53] [batching] Done. Typical MB size is 35,936 target words
[2023-07-18 06:33:53] [valid] No post-processing script given for validating translator
[2023-07-18 06:33:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 06:33:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 06:33:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 06:33:53] [comm] Using global sharding
[2023-07-18 06:33:54] [comm] NCCLCommunicators constructed successfully
[2023-07-18 06:33:54] [training] Using 1 GPUs
[2023-07-18 06:33:54] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-18 06:33:55] Allocating memory for general optimizer shards
[2023-07-18 06:33:55] [memory] Reserving 322 MB, device gpu0
[2023-07-18 06:33:55] Loading Adam parameters
[2023-07-18 06:33:55] [memory] Reserving 322 MB, device gpu0
[2023-07-18 06:33:55] [memory] Reserving 80 MB, device gpu0
[2023-07-18 06:33:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-18 06:33:55] [data] Restoring the corpus state to epoch 51, batch 1930
[2023-07-18 06:33:55] [data] Shuffling data
[2023-07-18 06:33:55] [data] Done reading 20,192 sentences
[2023-07-18 06:33:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 06:33:55] Training started
[2023-07-18 06:33:55] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 06:33:57] [memory] Reserving 80 MB, device gpu0
[2023-07-18 06:34:09] Parameter type float16, optimization type float32, casting types true
[2023-07-18 06:38:09] Seen 20,192 samples
[2023-07-18 06:38:09] Starting data epoch 52 in logical epoch 52
[2023-07-18 06:38:09] [data] Shuffling data
[2023-07-18 06:38:09] [data] Done reading 20,192 sentences
[2023-07-18 06:38:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 06:42:01] Ep. 52 : Up. 2000 : Sen. 17,785 : Cost 4.87624311 * 16,062,262 @ 24,690 after 32,174,302 : Time 487.76s : 32930.40 words/s : gNorm 0.9076
[2023-07-18 06:42:39] Seen 20,192 samples
[2023-07-18 06:42:39] Starting data epoch 53 in logical epoch 53
[2023-07-18 06:42:39] [data] Shuffling data
[2023-07-18 06:42:39] [data] Done reading 20,192 sentences
[2023-07-18 06:42:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 06:46:43] Seen 20,192 samples
[2023-07-18 06:46:43] Starting data epoch 54 in logical epoch 54
[2023-07-18 06:46:43] [data] Shuffling data
[2023-07-18 06:46:43] [data] Done reading 20,192 sentences
[2023-07-18 06:46:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 06:48:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 06:48:37] [marian] Running on node22.datos.cluster.uy as process 34086 with command line:
[2023-07-18 06:48:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 06:48:37] [config] after: 0e
[2023-07-18 06:48:37] [config] after-batches: 0
[2023-07-18 06:48:37] [config] after-epochs: 10
[2023-07-18 06:48:37] [config] all-caps-every: 0
[2023-07-18 06:48:37] [config] allow-unk: false
[2023-07-18 06:48:37] [config] authors: false
[2023-07-18 06:48:37] [config] beam-size: 12
[2023-07-18 06:48:37] [config] bert-class-symbol: "[CLS]"
[2023-07-18 06:48:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 06:48:37] [config] bert-masking-fraction: 0.15
[2023-07-18 06:48:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 06:48:37] [config] bert-train-type-embeddings: true
[2023-07-18 06:48:37] [config] bert-type-vocab-size: 2
[2023-07-18 06:48:37] [config] build-info: ""
[2023-07-18 06:48:37] [config] check-gradient-nan: false
[2023-07-18 06:48:37] [config] check-nan: false
[2023-07-18 06:48:37] [config] cite: false
[2023-07-18 06:48:37] [config] clip-norm: 1
[2023-07-18 06:48:37] [config] cost-scaling:
[2023-07-18 06:48:37] [config]   - 256.f
[2023-07-18 06:48:37] [config]   - 1000
[2023-07-18 06:48:37] [config]   - 2.f
[2023-07-18 06:48:37] [config]   - 256.f
[2023-07-18 06:48:37] [config] cost-type: ce-sum
[2023-07-18 06:48:37] [config] cpu-threads: 0
[2023-07-18 06:48:37] [config] data-threads: 8
[2023-07-18 06:48:37] [config] data-weighting: ""
[2023-07-18 06:48:37] [config] data-weighting-type: sentence
[2023-07-18 06:48:37] [config] dec-cell: gru
[2023-07-18 06:48:37] [config] dec-cell-base-depth: 2
[2023-07-18 06:48:37] [config] dec-cell-high-depth: 1
[2023-07-18 06:48:37] [config] dec-depth: 1
[2023-07-18 06:48:37] [config] devices:
[2023-07-18 06:48:37] [config]   - 0
[2023-07-18 06:48:37] [config] dim-emb: 512
[2023-07-18 06:48:37] [config] dim-rnn: 1024
[2023-07-18 06:48:37] [config] dim-vocabs:
[2023-07-18 06:48:37] [config]   - 16384
[2023-07-18 06:48:37] [config]   - 16384
[2023-07-18 06:48:37] [config] disp-first: 0
[2023-07-18 06:48:37] [config] disp-freq: 1000u
[2023-07-18 06:48:37] [config] disp-label-counts: true
[2023-07-18 06:48:37] [config] dropout-rnn: 0
[2023-07-18 06:48:37] [config] dropout-src: 0
[2023-07-18 06:48:37] [config] dropout-trg: 0
[2023-07-18 06:48:37] [config] dump-config: ""
[2023-07-18 06:48:37] [config] dynamic-gradient-scaling:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] early-stopping: 200
[2023-07-18 06:48:37] [config] early-stopping-on: first
[2023-07-18 06:48:37] [config] embedding-fix-src: false
[2023-07-18 06:48:37] [config] embedding-fix-trg: false
[2023-07-18 06:48:37] [config] embedding-normalization: false
[2023-07-18 06:48:37] [config] embedding-vectors:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] enc-cell: gru
[2023-07-18 06:48:37] [config] enc-cell-depth: 1
[2023-07-18 06:48:37] [config] enc-depth: 1
[2023-07-18 06:48:37] [config] enc-type: bidirectional
[2023-07-18 06:48:37] [config] english-title-case-every: 0
[2023-07-18 06:48:37] [config] exponential-smoothing: 0
[2023-07-18 06:48:37] [config] factor-weight: 1
[2023-07-18 06:48:37] [config] factors-combine: sum
[2023-07-18 06:48:37] [config] factors-dim-emb: 0
[2023-07-18 06:48:37] [config] gradient-checkpointing: false
[2023-07-18 06:48:37] [config] gradient-norm-average-window: 100
[2023-07-18 06:48:37] [config] guided-alignment: none
[2023-07-18 06:48:37] [config] guided-alignment-cost: mse
[2023-07-18 06:48:37] [config] guided-alignment-weight: 0.1
[2023-07-18 06:48:37] [config] ignore-model-config: false
[2023-07-18 06:48:37] [config] input-types:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] interpolate-env-vars: false
[2023-07-18 06:48:37] [config] keep-best: false
[2023-07-18 06:48:37] [config] label-smoothing: 0
[2023-07-18 06:48:37] [config] layer-normalization: false
[2023-07-18 06:48:37] [config] learn-rate: 0.0001
[2023-07-18 06:48:37] [config] lemma-dependency: ""
[2023-07-18 06:48:37] [config] lemma-dim-emb: 0
[2023-07-18 06:48:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 06:48:37] [config] log-level: info
[2023-07-18 06:48:37] [config] log-time-zone: ""
[2023-07-18 06:48:37] [config] logical-epoch:
[2023-07-18 06:48:37] [config]   - 1e
[2023-07-18 06:48:37] [config]   - 0
[2023-07-18 06:48:37] [config] lr-decay: 0
[2023-07-18 06:48:37] [config] lr-decay-freq: 50000
[2023-07-18 06:48:37] [config] lr-decay-inv-sqrt:
[2023-07-18 06:48:37] [config]   - 0
[2023-07-18 06:48:37] [config] lr-decay-repeat-warmup: false
[2023-07-18 06:48:37] [config] lr-decay-reset-optimizer: false
[2023-07-18 06:48:37] [config] lr-decay-start:
[2023-07-18 06:48:37] [config]   - 10
[2023-07-18 06:48:37] [config]   - 1
[2023-07-18 06:48:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 06:48:37] [config] lr-report: false
[2023-07-18 06:48:37] [config] lr-warmup: 0
[2023-07-18 06:48:37] [config] lr-warmup-at-reload: false
[2023-07-18 06:48:37] [config] lr-warmup-cycle: false
[2023-07-18 06:48:37] [config] lr-warmup-start-rate: 0
[2023-07-18 06:48:37] [config] max-length: 150
[2023-07-18 06:48:37] [config] max-length-crop: true
[2023-07-18 06:48:37] [config] max-length-factor: 3
[2023-07-18 06:48:37] [config] maxi-batch: 100
[2023-07-18 06:48:37] [config] maxi-batch-sort: trg
[2023-07-18 06:48:37] [config] mini-batch: 64
[2023-07-18 06:48:37] [config] mini-batch-fit: true
[2023-07-18 06:48:37] [config] mini-batch-fit-step: 10
[2023-07-18 06:48:37] [config] mini-batch-round-up: true
[2023-07-18 06:48:37] [config] mini-batch-track-lr: false
[2023-07-18 06:48:37] [config] mini-batch-warmup: 0
[2023-07-18 06:48:37] [config] mini-batch-words: 0
[2023-07-18 06:48:37] [config] mini-batch-words-ref: 0
[2023-07-18 06:48:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 06:48:37] [config] multi-loss-type: sum
[2023-07-18 06:48:37] [config] n-best: false
[2023-07-18 06:48:37] [config] no-nccl: false
[2023-07-18 06:48:37] [config] no-reload: false
[2023-07-18 06:48:37] [config] no-restore-corpus: false
[2023-07-18 06:48:37] [config] normalize: 0
[2023-07-18 06:48:37] [config] normalize-gradient: false
[2023-07-18 06:48:37] [config] num-devices: 0
[2023-07-18 06:48:37] [config] optimizer: adam
[2023-07-18 06:48:37] [config] optimizer-delay: 1
[2023-07-18 06:48:37] [config] optimizer-params:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] output-omit-bias: false
[2023-07-18 06:48:37] [config] overwrite: true
[2023-07-18 06:48:37] [config] precision:
[2023-07-18 06:48:37] [config]   - float16
[2023-07-18 06:48:37] [config]   - float32
[2023-07-18 06:48:37] [config] pretrained-model: ""
[2023-07-18 06:48:37] [config] quantize-biases: false
[2023-07-18 06:48:37] [config] quantize-bits: 0
[2023-07-18 06:48:37] [config] quantize-log-based: false
[2023-07-18 06:48:37] [config] quantize-optimization-steps: 0
[2023-07-18 06:48:37] [config] quiet: false
[2023-07-18 06:48:37] [config] quiet-translation: true
[2023-07-18 06:48:37] [config] relative-paths: false
[2023-07-18 06:48:37] [config] right-left: false
[2023-07-18 06:48:37] [config] save-freq: 10000u
[2023-07-18 06:48:37] [config] seed: 1234
[2023-07-18 06:48:37] [config] sentencepiece-alphas:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] sentencepiece-max-lines: 2000000
[2023-07-18 06:48:37] [config] sentencepiece-options: ""
[2023-07-18 06:48:37] [config] sharding: global
[2023-07-18 06:48:37] [config] shuffle: data
[2023-07-18 06:48:37] [config] shuffle-in-ram: false
[2023-07-18 06:48:37] [config] sigterm: save-and-exit
[2023-07-18 06:48:37] [config] skip: false
[2023-07-18 06:48:37] [config] sqlite: ""
[2023-07-18 06:48:37] [config] sqlite-drop: false
[2023-07-18 06:48:37] [config] sync-freq: 200u
[2023-07-18 06:48:37] [config] sync-sgd: false
[2023-07-18 06:48:37] [config] tempdir: /tmp
[2023-07-18 06:48:37] [config] tied-embeddings: false
[2023-07-18 06:48:37] [config] tied-embeddings-all: true
[2023-07-18 06:48:37] [config] tied-embeddings-src: false
[2023-07-18 06:48:37] [config] train-embedder-rank:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] train-sets:
[2023-07-18 06:48:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 06:48:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 06:48:37] [config] transformer-aan-activation: swish
[2023-07-18 06:48:37] [config] transformer-aan-depth: 2
[2023-07-18 06:48:37] [config] transformer-aan-nogate: false
[2023-07-18 06:48:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 06:48:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 06:48:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 06:48:37] [config] transformer-depth-scaling: false
[2023-07-18 06:48:37] [config] transformer-dim-aan: 2048
[2023-07-18 06:48:37] [config] transformer-dim-ffn: 2048
[2023-07-18 06:48:37] [config] transformer-dropout: 0
[2023-07-18 06:48:37] [config] transformer-dropout-attention: 0
[2023-07-18 06:48:37] [config] transformer-dropout-ffn: 0
[2023-07-18 06:48:37] [config] transformer-ffn-activation: swish
[2023-07-18 06:48:37] [config] transformer-ffn-depth: 2
[2023-07-18 06:48:37] [config] transformer-guided-alignment-layer: last
[2023-07-18 06:48:37] [config] transformer-heads: 8
[2023-07-18 06:48:37] [config] transformer-no-projection: false
[2023-07-18 06:48:37] [config] transformer-pool: false
[2023-07-18 06:48:37] [config] transformer-postprocess: dan
[2023-07-18 06:48:37] [config] transformer-postprocess-emb: d
[2023-07-18 06:48:37] [config] transformer-postprocess-top: ""
[2023-07-18 06:48:37] [config] transformer-preprocess: ""
[2023-07-18 06:48:37] [config] transformer-tied-layers:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] transformer-train-position-embeddings: false
[2023-07-18 06:48:37] [config] tsv: false
[2023-07-18 06:48:37] [config] tsv-fields: 0
[2023-07-18 06:48:37] [config] type: amun
[2023-07-18 06:48:37] [config] ulr: false
[2023-07-18 06:48:37] [config] ulr-dim-emb: 0
[2023-07-18 06:48:37] [config] ulr-dropout: 0
[2023-07-18 06:48:37] [config] ulr-keys-vectors: ""
[2023-07-18 06:48:37] [config] ulr-query-vectors: ""
[2023-07-18 06:48:37] [config] ulr-softmax-temperature: 1
[2023-07-18 06:48:37] [config] ulr-trainable-transformation: false
[2023-07-18 06:48:37] [config] unlikelihood-loss: false
[2023-07-18 06:48:37] [config] valid-freq: 50000000
[2023-07-18 06:48:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 06:48:37] [config] valid-max-length: 1000
[2023-07-18 06:48:37] [config] valid-metrics:
[2023-07-18 06:48:37] [config]   - cross-entropy
[2023-07-18 06:48:37] [config]   - translation
[2023-07-18 06:48:37] [config] valid-mini-batch: 32
[2023-07-18 06:48:37] [config] valid-reset-stalled: false
[2023-07-18 06:48:37] [config] valid-script-args:
[2023-07-18 06:48:37] [config]   []
[2023-07-18 06:48:37] [config] valid-script-path: ""
[2023-07-18 06:48:37] [config] valid-sets:
[2023-07-18 06:48:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 06:48:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 06:48:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 06:48:37] [config] vocabs:
[2023-07-18 06:48:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 06:48:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 06:48:37] [config] word-penalty: 0
[2023-07-18 06:48:37] [config] word-scores: false
[2023-07-18 06:48:37] [config] workspace: 5500
[2023-07-18 06:48:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 06:48:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 06:48:37] [training] Using single-device training
[2023-07-18 06:48:38] Synced seed 1234
[2023-07-18 06:48:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 06:48:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 06:48:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 06:48:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 06:48:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 06:48:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 06:48:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 06:48:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 06:48:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 06:48:40] [comm] Using global sharding
[2023-07-18 06:48:40] [comm] NCCLCommunicators constructed successfully
[2023-07-18 06:48:40] [training] Using 1 GPUs
[2023-07-18 06:48:40] [logits] Applying loss function for 1 factor(s)
[2023-07-18 06:48:40] [memory] Reserving 80 MB, device gpu0
[2023-07-18 06:48:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 06:48:43] [memory] Reserving 80 MB, device gpu0
[2023-07-18 07:14:01] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 07:14:01] [valid] No post-processing script given for validating translator
[2023-07-18 07:14:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 07:14:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 07:14:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 07:14:01] [comm] Using global sharding
[2023-07-18 07:14:01] [comm] NCCLCommunicators constructed successfully
[2023-07-18 07:14:01] [training] Using 1 GPUs
[2023-07-18 07:14:01] Training started
[2023-07-18 07:14:01] [data] Shuffling data
[2023-07-18 07:14:01] [data] Done reading 20,192 sentences
[2023-07-18 07:14:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:14:01] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 07:14:01] [memory] Reserving 80 MB, device gpu0
[2023-07-18 07:14:02] [memory] Reserving 80 MB, device gpu0
[2023-07-18 07:14:11] Parameter type float16, optimization type float32, casting types true
[2023-07-18 07:14:11] Allocating memory for general optimizer shards
[2023-07-18 07:14:11] [memory] Reserving 322 MB, device gpu0
[2023-07-18 07:14:11] Allocating memory for Adam-specific shards
[2023-07-18 07:14:11] [memory] Reserving 322 MB, device gpu0
[2023-07-18 07:17:35] Seen 20,192 samples
[2023-07-18 07:17:35] Starting data epoch 2 in logical epoch 2
[2023-07-18 07:17:35] [data] Shuffling data
[2023-07-18 07:17:35] [data] Done reading 20,192 sentences
[2023-07-18 07:17:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:22:05] Seen 20,192 samples
[2023-07-18 07:22:05] Starting data epoch 3 in logical epoch 3
[2023-07-18 07:22:05] [data] Shuffling data
[2023-07-18 07:22:05] [data] Done reading 20,192 sentences
[2023-07-18 07:22:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:26:28] Seen 20,192 samples
[2023-07-18 07:26:28] Starting data epoch 4 in logical epoch 4
[2023-07-18 07:26:28] [data] Shuffling data
[2023-07-18 07:26:28] [data] Done reading 20,192 sentences
[2023-07-18 07:26:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:30:27] Seen 20,192 samples
[2023-07-18 07:30:27] Starting data epoch 5 in logical epoch 5
[2023-07-18 07:30:27] [data] Shuffling data
[2023-07-18 07:30:27] [data] Done reading 20,192 sentences
[2023-07-18 07:30:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:34:27] Seen 20,192 samples
[2023-07-18 07:34:27] Starting data epoch 6 in logical epoch 6
[2023-07-18 07:34:27] [data] Shuffling data
[2023-07-18 07:34:27] [data] Done reading 20,192 sentences
[2023-07-18 07:34:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:38:20] Seen 20,192 samples
[2023-07-18 07:38:20] Starting data epoch 7 in logical epoch 7
[2023-07-18 07:38:20] [data] Shuffling data
[2023-07-18 07:38:20] [data] Done reading 20,192 sentences
[2023-07-18 07:38:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:42:21] Seen 20,192 samples
[2023-07-18 07:42:21] Starting data epoch 8 in logical epoch 8
[2023-07-18 07:42:21] [data] Shuffling data
[2023-07-18 07:42:21] [data] Done reading 20,192 sentences
[2023-07-18 07:42:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:46:25] Seen 20,192 samples
[2023-07-18 07:46:25] Starting data epoch 9 in logical epoch 9
[2023-07-18 07:46:25] [data] Shuffling data
[2023-07-18 07:46:25] [data] Done reading 20,192 sentences
[2023-07-18 07:46:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:50:30] Seen 20,192 samples
[2023-07-18 07:50:30] Starting data epoch 10 in logical epoch 10
[2023-07-18 07:50:30] [data] Shuffling data
[2023-07-18 07:50:30] [data] Done reading 20,192 sentences
[2023-07-18 07:50:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 07:54:57] Seen 20,192 samples
[2023-07-18 07:54:57] Starting data epoch 11 in logical epoch 11
[2023-07-18 07:54:57] Training finished
[2023-07-18 07:55:07] [valid] Ep. 11 : Up. 384 : cross-entropy : 187.628 : new best
[2023-07-18 07:56:57] [valid] Ep. 11 : Up. 384 : translation : 0 : new best
[2023-07-18 07:56:57] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 07:56:59] Saving Adam parameters
[2023-07-18 07:56:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 07:57:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 07:57:05] [marian] Running on node22.datos.cluster.uy as process 38708 with command line:
[2023-07-18 07:57:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 07:57:06] [config] after: 0e
[2023-07-18 07:57:06] [config] after-batches: 0
[2023-07-18 07:57:06] [config] after-epochs: 20
[2023-07-18 07:57:06] [config] all-caps-every: 0
[2023-07-18 07:57:06] [config] allow-unk: false
[2023-07-18 07:57:06] [config] authors: false
[2023-07-18 07:57:06] [config] beam-size: 12
[2023-07-18 07:57:06] [config] bert-class-symbol: "[CLS]"
[2023-07-18 07:57:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 07:57:06] [config] bert-masking-fraction: 0.15
[2023-07-18 07:57:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 07:57:06] [config] bert-train-type-embeddings: true
[2023-07-18 07:57:06] [config] bert-type-vocab-size: 2
[2023-07-18 07:57:06] [config] build-info: ""
[2023-07-18 07:57:06] [config] check-gradient-nan: false
[2023-07-18 07:57:06] [config] check-nan: false
[2023-07-18 07:57:06] [config] cite: false
[2023-07-18 07:57:06] [config] clip-norm: 1
[2023-07-18 07:57:06] [config] cost-scaling:
[2023-07-18 07:57:06] [config]   - 256.f
[2023-07-18 07:57:06] [config]   - 1000
[2023-07-18 07:57:06] [config]   - 2.f
[2023-07-18 07:57:06] [config]   - 256.f
[2023-07-18 07:57:06] [config] cost-type: ce-sum
[2023-07-18 07:57:06] [config] cpu-threads: 0
[2023-07-18 07:57:06] [config] data-threads: 8
[2023-07-18 07:57:06] [config] data-weighting: ""
[2023-07-18 07:57:06] [config] data-weighting-type: sentence
[2023-07-18 07:57:06] [config] dec-cell: gru
[2023-07-18 07:57:06] [config] dec-cell-base-depth: 2
[2023-07-18 07:57:06] [config] dec-cell-high-depth: 1
[2023-07-18 07:57:06] [config] dec-depth: 1
[2023-07-18 07:57:06] [config] devices:
[2023-07-18 07:57:06] [config]   - 0
[2023-07-18 07:57:06] [config] dim-emb: 512
[2023-07-18 07:57:06] [config] dim-rnn: 1024
[2023-07-18 07:57:06] [config] dim-vocabs:
[2023-07-18 07:57:06] [config]   - 16384
[2023-07-18 07:57:06] [config]   - 16384
[2023-07-18 07:57:06] [config] disp-first: 0
[2023-07-18 07:57:06] [config] disp-freq: 1000u
[2023-07-18 07:57:06] [config] disp-label-counts: true
[2023-07-18 07:57:06] [config] dropout-rnn: 0
[2023-07-18 07:57:06] [config] dropout-src: 0
[2023-07-18 07:57:06] [config] dropout-trg: 0
[2023-07-18 07:57:06] [config] dump-config: ""
[2023-07-18 07:57:06] [config] dynamic-gradient-scaling:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] early-stopping: 200
[2023-07-18 07:57:06] [config] early-stopping-on: first
[2023-07-18 07:57:06] [config] embedding-fix-src: false
[2023-07-18 07:57:06] [config] embedding-fix-trg: false
[2023-07-18 07:57:06] [config] embedding-normalization: false
[2023-07-18 07:57:06] [config] embedding-vectors:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] enc-cell: gru
[2023-07-18 07:57:06] [config] enc-cell-depth: 1
[2023-07-18 07:57:06] [config] enc-depth: 1
[2023-07-18 07:57:06] [config] enc-type: bidirectional
[2023-07-18 07:57:06] [config] english-title-case-every: 0
[2023-07-18 07:57:06] [config] exponential-smoothing: 0
[2023-07-18 07:57:06] [config] factor-weight: 1
[2023-07-18 07:57:06] [config] factors-combine: sum
[2023-07-18 07:57:06] [config] factors-dim-emb: 0
[2023-07-18 07:57:06] [config] gradient-checkpointing: false
[2023-07-18 07:57:06] [config] gradient-norm-average-window: 100
[2023-07-18 07:57:06] [config] guided-alignment: none
[2023-07-18 07:57:06] [config] guided-alignment-cost: mse
[2023-07-18 07:57:06] [config] guided-alignment-weight: 0.1
[2023-07-18 07:57:06] [config] ignore-model-config: false
[2023-07-18 07:57:06] [config] input-types:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] interpolate-env-vars: false
[2023-07-18 07:57:06] [config] keep-best: false
[2023-07-18 07:57:06] [config] label-smoothing: 0
[2023-07-18 07:57:06] [config] layer-normalization: false
[2023-07-18 07:57:06] [config] learn-rate: 0.0001
[2023-07-18 07:57:06] [config] lemma-dependency: ""
[2023-07-18 07:57:06] [config] lemma-dim-emb: 0
[2023-07-18 07:57:06] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 07:57:06] [config] log-level: info
[2023-07-18 07:57:06] [config] log-time-zone: ""
[2023-07-18 07:57:06] [config] logical-epoch:
[2023-07-18 07:57:06] [config]   - 1e
[2023-07-18 07:57:06] [config]   - 0
[2023-07-18 07:57:06] [config] lr-decay: 0
[2023-07-18 07:57:06] [config] lr-decay-freq: 50000
[2023-07-18 07:57:06] [config] lr-decay-inv-sqrt:
[2023-07-18 07:57:06] [config]   - 0
[2023-07-18 07:57:06] [config] lr-decay-repeat-warmup: false
[2023-07-18 07:57:06] [config] lr-decay-reset-optimizer: false
[2023-07-18 07:57:06] [config] lr-decay-start:
[2023-07-18 07:57:06] [config]   - 10
[2023-07-18 07:57:06] [config]   - 1
[2023-07-18 07:57:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 07:57:06] [config] lr-report: false
[2023-07-18 07:57:06] [config] lr-warmup: 0
[2023-07-18 07:57:06] [config] lr-warmup-at-reload: false
[2023-07-18 07:57:06] [config] lr-warmup-cycle: false
[2023-07-18 07:57:06] [config] lr-warmup-start-rate: 0
[2023-07-18 07:57:06] [config] max-length: 150
[2023-07-18 07:57:06] [config] max-length-crop: true
[2023-07-18 07:57:06] [config] max-length-factor: 3
[2023-07-18 07:57:06] [config] maxi-batch: 100
[2023-07-18 07:57:06] [config] maxi-batch-sort: trg
[2023-07-18 07:57:06] [config] mini-batch: 64
[2023-07-18 07:57:06] [config] mini-batch-fit: true
[2023-07-18 07:57:06] [config] mini-batch-fit-step: 10
[2023-07-18 07:57:06] [config] mini-batch-round-up: true
[2023-07-18 07:57:06] [config] mini-batch-track-lr: false
[2023-07-18 07:57:06] [config] mini-batch-warmup: 0
[2023-07-18 07:57:06] [config] mini-batch-words: 0
[2023-07-18 07:57:06] [config] mini-batch-words-ref: 0
[2023-07-18 07:57:06] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 07:57:06] [config] multi-loss-type: sum
[2023-07-18 07:57:06] [config] n-best: false
[2023-07-18 07:57:06] [config] no-nccl: false
[2023-07-18 07:57:06] [config] no-reload: false
[2023-07-18 07:57:06] [config] no-restore-corpus: false
[2023-07-18 07:57:06] [config] normalize: 0
[2023-07-18 07:57:06] [config] normalize-gradient: false
[2023-07-18 07:57:06] [config] num-devices: 0
[2023-07-18 07:57:06] [config] optimizer: adam
[2023-07-18 07:57:06] [config] optimizer-delay: 1
[2023-07-18 07:57:06] [config] optimizer-params:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] output-omit-bias: false
[2023-07-18 07:57:06] [config] overwrite: true
[2023-07-18 07:57:06] [config] precision:
[2023-07-18 07:57:06] [config]   - float16
[2023-07-18 07:57:06] [config]   - float32
[2023-07-18 07:57:06] [config] pretrained-model: ""
[2023-07-18 07:57:06] [config] quantize-biases: false
[2023-07-18 07:57:06] [config] quantize-bits: 0
[2023-07-18 07:57:06] [config] quantize-log-based: false
[2023-07-18 07:57:06] [config] quantize-optimization-steps: 0
[2023-07-18 07:57:06] [config] quiet: false
[2023-07-18 07:57:06] [config] quiet-translation: true
[2023-07-18 07:57:06] [config] relative-paths: false
[2023-07-18 07:57:06] [config] right-left: false
[2023-07-18 07:57:06] [config] save-freq: 10000u
[2023-07-18 07:57:06] [config] seed: 1234
[2023-07-18 07:57:06] [config] sentencepiece-alphas:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] sentencepiece-max-lines: 2000000
[2023-07-18 07:57:06] [config] sentencepiece-options: ""
[2023-07-18 07:57:06] [config] sharding: global
[2023-07-18 07:57:06] [config] shuffle: data
[2023-07-18 07:57:06] [config] shuffle-in-ram: false
[2023-07-18 07:57:06] [config] sigterm: save-and-exit
[2023-07-18 07:57:06] [config] skip: false
[2023-07-18 07:57:06] [config] sqlite: ""
[2023-07-18 07:57:06] [config] sqlite-drop: false
[2023-07-18 07:57:06] [config] sync-freq: 200u
[2023-07-18 07:57:06] [config] sync-sgd: false
[2023-07-18 07:57:06] [config] tempdir: /tmp
[2023-07-18 07:57:06] [config] tied-embeddings: false
[2023-07-18 07:57:06] [config] tied-embeddings-all: true
[2023-07-18 07:57:06] [config] tied-embeddings-src: false
[2023-07-18 07:57:06] [config] train-embedder-rank:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] train-sets:
[2023-07-18 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 07:57:06] [config] transformer-aan-activation: swish
[2023-07-18 07:57:06] [config] transformer-aan-depth: 2
[2023-07-18 07:57:06] [config] transformer-aan-nogate: false
[2023-07-18 07:57:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 07:57:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 07:57:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 07:57:06] [config] transformer-depth-scaling: false
[2023-07-18 07:57:06] [config] transformer-dim-aan: 2048
[2023-07-18 07:57:06] [config] transformer-dim-ffn: 2048
[2023-07-18 07:57:06] [config] transformer-dropout: 0
[2023-07-18 07:57:06] [config] transformer-dropout-attention: 0
[2023-07-18 07:57:06] [config] transformer-dropout-ffn: 0
[2023-07-18 07:57:06] [config] transformer-ffn-activation: swish
[2023-07-18 07:57:06] [config] transformer-ffn-depth: 2
[2023-07-18 07:57:06] [config] transformer-guided-alignment-layer: last
[2023-07-18 07:57:06] [config] transformer-heads: 8
[2023-07-18 07:57:06] [config] transformer-no-projection: false
[2023-07-18 07:57:06] [config] transformer-pool: false
[2023-07-18 07:57:06] [config] transformer-postprocess: dan
[2023-07-18 07:57:06] [config] transformer-postprocess-emb: d
[2023-07-18 07:57:06] [config] transformer-postprocess-top: ""
[2023-07-18 07:57:06] [config] transformer-preprocess: ""
[2023-07-18 07:57:06] [config] transformer-tied-layers:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] transformer-train-position-embeddings: false
[2023-07-18 07:57:06] [config] tsv: false
[2023-07-18 07:57:06] [config] tsv-fields: 0
[2023-07-18 07:57:06] [config] type: amun
[2023-07-18 07:57:06] [config] ulr: false
[2023-07-18 07:57:06] [config] ulr-dim-emb: 0
[2023-07-18 07:57:06] [config] ulr-dropout: 0
[2023-07-18 07:57:06] [config] ulr-keys-vectors: ""
[2023-07-18 07:57:06] [config] ulr-query-vectors: ""
[2023-07-18 07:57:06] [config] ulr-softmax-temperature: 1
[2023-07-18 07:57:06] [config] ulr-trainable-transformation: false
[2023-07-18 07:57:06] [config] unlikelihood-loss: false
[2023-07-18 07:57:06] [config] valid-freq: 50000000
[2023-07-18 07:57:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 07:57:06] [config] valid-max-length: 1000
[2023-07-18 07:57:06] [config] valid-metrics:
[2023-07-18 07:57:06] [config]   - cross-entropy
[2023-07-18 07:57:06] [config]   - translation
[2023-07-18 07:57:06] [config] valid-mini-batch: 32
[2023-07-18 07:57:06] [config] valid-reset-stalled: false
[2023-07-18 07:57:06] [config] valid-script-args:
[2023-07-18 07:57:06] [config]   []
[2023-07-18 07:57:06] [config] valid-script-path: ""
[2023-07-18 07:57:06] [config] valid-sets:
[2023-07-18 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 07:57:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 07:57:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 07:57:06] [config] vocabs:
[2023-07-18 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 07:57:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 07:57:06] [config] word-penalty: 0
[2023-07-18 07:57:06] [config] word-scores: false
[2023-07-18 07:57:06] [config] workspace: 5500
[2023-07-18 07:57:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 07:57:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 07:57:06] [training] Using single-device training
[2023-07-18 07:57:06] Synced seed 1234
[2023-07-18 07:57:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 07:57:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 07:57:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 07:57:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 07:57:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 07:57:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 07:57:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 07:57:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 07:57:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 07:57:07] [comm] Using global sharding
[2023-07-18 07:57:07] [comm] NCCLCommunicators constructed successfully
[2023-07-18 07:57:07] [training] Using 1 GPUs
[2023-07-18 07:57:07] [logits] Applying loss function for 1 factor(s)
[2023-07-18 07:57:07] [memory] Reserving 80 MB, device gpu0
[2023-07-18 07:57:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 07:57:08] [memory] Reserving 80 MB, device gpu0
[2023-07-18 08:23:22] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 08:23:22] [valid] No post-processing script given for validating translator
[2023-07-18 08:23:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 08:23:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 08:23:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 08:23:22] [comm] Using global sharding
[2023-07-18 08:23:22] [comm] NCCLCommunicators constructed successfully
[2023-07-18 08:23:22] [training] Using 1 GPUs
[2023-07-18 08:23:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 08:23:24] Allocating memory for general optimizer shards
[2023-07-18 08:23:24] [memory] Reserving 322 MB, device gpu0
[2023-07-18 08:23:24] Loading Adam parameters
[2023-07-18 08:23:24] [memory] Reserving 322 MB, device gpu0
[2023-07-18 08:23:24] [memory] Reserving 80 MB, device gpu0
[2023-07-18 08:23:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 08:23:24] [data] Restoring the corpus state to epoch 11, batch 384
[2023-07-18 08:23:24] [data] Shuffling data
[2023-07-18 08:23:24] [data] Done reading 20,192 sentences
[2023-07-18 08:23:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:23:24] Training started
[2023-07-18 08:23:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 08:23:25] [memory] Reserving 80 MB, device gpu0
[2023-07-18 08:23:31] Parameter type float16, optimization type float32, casting types true
[2023-07-18 08:27:08] Seen 20,192 samples
[2023-07-18 08:27:08] Starting data epoch 12 in logical epoch 12
[2023-07-18 08:27:08] [data] Shuffling data
[2023-07-18 08:27:08] [data] Done reading 20,192 sentences
[2023-07-18 08:27:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:31:14] Seen 20,192 samples
[2023-07-18 08:31:14] Starting data epoch 13 in logical epoch 13
[2023-07-18 08:31:14] [data] Shuffling data
[2023-07-18 08:31:14] [data] Done reading 20,192 sentences
[2023-07-18 08:31:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:35:17] Seen 20,192 samples
[2023-07-18 08:35:17] Starting data epoch 14 in logical epoch 14
[2023-07-18 08:35:17] [data] Shuffling data
[2023-07-18 08:35:17] [data] Done reading 20,192 sentences
[2023-07-18 08:35:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:39:23] Seen 20,192 samples
[2023-07-18 08:39:23] Starting data epoch 15 in logical epoch 15
[2023-07-18 08:39:23] [data] Shuffling data
[2023-07-18 08:39:23] [data] Done reading 20,192 sentences
[2023-07-18 08:39:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:43:35] Seen 20,192 samples
[2023-07-18 08:43:35] Starting data epoch 16 in logical epoch 16
[2023-07-18 08:43:35] [data] Shuffling data
[2023-07-18 08:43:35] [data] Done reading 20,192 sentences
[2023-07-18 08:43:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:47:53] Seen 20,192 samples
[2023-07-18 08:47:53] Starting data epoch 17 in logical epoch 17
[2023-07-18 08:47:53] [data] Shuffling data
[2023-07-18 08:47:53] [data] Done reading 20,192 sentences
[2023-07-18 08:47:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:52:14] Seen 20,192 samples
[2023-07-18 08:52:14] Starting data epoch 18 in logical epoch 18
[2023-07-18 08:52:14] [data] Shuffling data
[2023-07-18 08:52:14] [data] Done reading 20,192 sentences
[2023-07-18 08:52:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 08:56:34] Seen 20,192 samples
[2023-07-18 08:56:34] Starting data epoch 19 in logical epoch 19
[2023-07-18 08:56:34] [data] Shuffling data
[2023-07-18 08:56:34] [data] Done reading 20,192 sentences
[2023-07-18 08:56:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 09:00:52] Seen 20,192 samples
[2023-07-18 09:00:52] Starting data epoch 20 in logical epoch 20
[2023-07-18 09:00:52] [data] Shuffling data
[2023-07-18 09:00:52] [data] Done reading 20,192 sentences
[2023-07-18 09:00:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 09:05:16] Seen 20,192 samples
[2023-07-18 09:05:16] Starting data epoch 21 in logical epoch 21
[2023-07-18 09:05:16] Training finished
[2023-07-18 09:05:26] [valid] Ep. 21 : Up. 765 : cross-entropy : 172.563 : new best
[2023-07-18 09:09:01] [valid] Ep. 21 : Up. 765 : translation : 0 : new best
[2023-07-18 09:09:01] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 09:09:03] Saving Adam parameters
[2023-07-18 09:09:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 09:09:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 09:09:11] [marian] Running on node22.datos.cluster.uy as process 2738 with command line:
[2023-07-18 09:09:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 09:09:11] [config] after: 0e
[2023-07-18 09:09:11] [config] after-batches: 0
[2023-07-18 09:09:11] [config] after-epochs: 30
[2023-07-18 09:09:11] [config] all-caps-every: 0
[2023-07-18 09:09:11] [config] allow-unk: false
[2023-07-18 09:09:11] [config] authors: false
[2023-07-18 09:09:11] [config] beam-size: 12
[2023-07-18 09:09:11] [config] bert-class-symbol: "[CLS]"
[2023-07-18 09:09:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 09:09:11] [config] bert-masking-fraction: 0.15
[2023-07-18 09:09:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 09:09:11] [config] bert-train-type-embeddings: true
[2023-07-18 09:09:11] [config] bert-type-vocab-size: 2
[2023-07-18 09:09:11] [config] build-info: ""
[2023-07-18 09:09:11] [config] check-gradient-nan: false
[2023-07-18 09:09:11] [config] check-nan: false
[2023-07-18 09:09:11] [config] cite: false
[2023-07-18 09:09:11] [config] clip-norm: 1
[2023-07-18 09:09:11] [config] cost-scaling:
[2023-07-18 09:09:11] [config]   - 256.f
[2023-07-18 09:09:11] [config]   - 1000
[2023-07-18 09:09:11] [config]   - 2.f
[2023-07-18 09:09:11] [config]   - 256.f
[2023-07-18 09:09:11] [config] cost-type: ce-sum
[2023-07-18 09:09:11] [config] cpu-threads: 0
[2023-07-18 09:09:11] [config] data-threads: 8
[2023-07-18 09:09:11] [config] data-weighting: ""
[2023-07-18 09:09:11] [config] data-weighting-type: sentence
[2023-07-18 09:09:11] [config] dec-cell: gru
[2023-07-18 09:09:11] [config] dec-cell-base-depth: 2
[2023-07-18 09:09:11] [config] dec-cell-high-depth: 1
[2023-07-18 09:09:11] [config] dec-depth: 1
[2023-07-18 09:09:11] [config] devices:
[2023-07-18 09:09:11] [config]   - 0
[2023-07-18 09:09:11] [config] dim-emb: 512
[2023-07-18 09:09:11] [config] dim-rnn: 1024
[2023-07-18 09:09:11] [config] dim-vocabs:
[2023-07-18 09:09:11] [config]   - 16384
[2023-07-18 09:09:11] [config]   - 16384
[2023-07-18 09:09:11] [config] disp-first: 0
[2023-07-18 09:09:11] [config] disp-freq: 1000u
[2023-07-18 09:09:11] [config] disp-label-counts: true
[2023-07-18 09:09:11] [config] dropout-rnn: 0
[2023-07-18 09:09:11] [config] dropout-src: 0
[2023-07-18 09:09:11] [config] dropout-trg: 0
[2023-07-18 09:09:11] [config] dump-config: ""
[2023-07-18 09:09:11] [config] dynamic-gradient-scaling:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] early-stopping: 200
[2023-07-18 09:09:11] [config] early-stopping-on: first
[2023-07-18 09:09:11] [config] embedding-fix-src: false
[2023-07-18 09:09:11] [config] embedding-fix-trg: false
[2023-07-18 09:09:11] [config] embedding-normalization: false
[2023-07-18 09:09:11] [config] embedding-vectors:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] enc-cell: gru
[2023-07-18 09:09:11] [config] enc-cell-depth: 1
[2023-07-18 09:09:11] [config] enc-depth: 1
[2023-07-18 09:09:11] [config] enc-type: bidirectional
[2023-07-18 09:09:11] [config] english-title-case-every: 0
[2023-07-18 09:09:11] [config] exponential-smoothing: 0
[2023-07-18 09:09:11] [config] factor-weight: 1
[2023-07-18 09:09:11] [config] factors-combine: sum
[2023-07-18 09:09:11] [config] factors-dim-emb: 0
[2023-07-18 09:09:11] [config] gradient-checkpointing: false
[2023-07-18 09:09:11] [config] gradient-norm-average-window: 100
[2023-07-18 09:09:11] [config] guided-alignment: none
[2023-07-18 09:09:11] [config] guided-alignment-cost: mse
[2023-07-18 09:09:11] [config] guided-alignment-weight: 0.1
[2023-07-18 09:09:11] [config] ignore-model-config: false
[2023-07-18 09:09:11] [config] input-types:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] interpolate-env-vars: false
[2023-07-18 09:09:11] [config] keep-best: false
[2023-07-18 09:09:11] [config] label-smoothing: 0
[2023-07-18 09:09:11] [config] layer-normalization: false
[2023-07-18 09:09:11] [config] learn-rate: 0.0001
[2023-07-18 09:09:11] [config] lemma-dependency: ""
[2023-07-18 09:09:11] [config] lemma-dim-emb: 0
[2023-07-18 09:09:11] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 09:09:11] [config] log-level: info
[2023-07-18 09:09:11] [config] log-time-zone: ""
[2023-07-18 09:09:11] [config] logical-epoch:
[2023-07-18 09:09:11] [config]   - 1e
[2023-07-18 09:09:11] [config]   - 0
[2023-07-18 09:09:11] [config] lr-decay: 0
[2023-07-18 09:09:11] [config] lr-decay-freq: 50000
[2023-07-18 09:09:11] [config] lr-decay-inv-sqrt:
[2023-07-18 09:09:11] [config]   - 0
[2023-07-18 09:09:11] [config] lr-decay-repeat-warmup: false
[2023-07-18 09:09:11] [config] lr-decay-reset-optimizer: false
[2023-07-18 09:09:11] [config] lr-decay-start:
[2023-07-18 09:09:11] [config]   - 10
[2023-07-18 09:09:11] [config]   - 1
[2023-07-18 09:09:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 09:09:11] [config] lr-report: false
[2023-07-18 09:09:11] [config] lr-warmup: 0
[2023-07-18 09:09:11] [config] lr-warmup-at-reload: false
[2023-07-18 09:09:11] [config] lr-warmup-cycle: false
[2023-07-18 09:09:11] [config] lr-warmup-start-rate: 0
[2023-07-18 09:09:11] [config] max-length: 150
[2023-07-18 09:09:11] [config] max-length-crop: true
[2023-07-18 09:09:11] [config] max-length-factor: 3
[2023-07-18 09:09:11] [config] maxi-batch: 100
[2023-07-18 09:09:11] [config] maxi-batch-sort: trg
[2023-07-18 09:09:11] [config] mini-batch: 64
[2023-07-18 09:09:11] [config] mini-batch-fit: true
[2023-07-18 09:09:11] [config] mini-batch-fit-step: 10
[2023-07-18 09:09:11] [config] mini-batch-round-up: true
[2023-07-18 09:09:11] [config] mini-batch-track-lr: false
[2023-07-18 09:09:11] [config] mini-batch-warmup: 0
[2023-07-18 09:09:11] [config] mini-batch-words: 0
[2023-07-18 09:09:11] [config] mini-batch-words-ref: 0
[2023-07-18 09:09:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 09:09:11] [config] multi-loss-type: sum
[2023-07-18 09:09:11] [config] n-best: false
[2023-07-18 09:09:11] [config] no-nccl: false
[2023-07-18 09:09:11] [config] no-reload: false
[2023-07-18 09:09:11] [config] no-restore-corpus: false
[2023-07-18 09:09:11] [config] normalize: 0
[2023-07-18 09:09:11] [config] normalize-gradient: false
[2023-07-18 09:09:11] [config] num-devices: 0
[2023-07-18 09:09:11] [config] optimizer: adam
[2023-07-18 09:09:11] [config] optimizer-delay: 1
[2023-07-18 09:09:11] [config] optimizer-params:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] output-omit-bias: false
[2023-07-18 09:09:11] [config] overwrite: true
[2023-07-18 09:09:11] [config] precision:
[2023-07-18 09:09:11] [config]   - float16
[2023-07-18 09:09:11] [config]   - float32
[2023-07-18 09:09:11] [config] pretrained-model: ""
[2023-07-18 09:09:11] [config] quantize-biases: false
[2023-07-18 09:09:11] [config] quantize-bits: 0
[2023-07-18 09:09:11] [config] quantize-log-based: false
[2023-07-18 09:09:11] [config] quantize-optimization-steps: 0
[2023-07-18 09:09:11] [config] quiet: false
[2023-07-18 09:09:11] [config] quiet-translation: true
[2023-07-18 09:09:11] [config] relative-paths: false
[2023-07-18 09:09:11] [config] right-left: false
[2023-07-18 09:09:11] [config] save-freq: 10000u
[2023-07-18 09:09:11] [config] seed: 1234
[2023-07-18 09:09:11] [config] sentencepiece-alphas:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] sentencepiece-max-lines: 2000000
[2023-07-18 09:09:11] [config] sentencepiece-options: ""
[2023-07-18 09:09:11] [config] sharding: global
[2023-07-18 09:09:11] [config] shuffle: data
[2023-07-18 09:09:11] [config] shuffle-in-ram: false
[2023-07-18 09:09:11] [config] sigterm: save-and-exit
[2023-07-18 09:09:11] [config] skip: false
[2023-07-18 09:09:11] [config] sqlite: ""
[2023-07-18 09:09:11] [config] sqlite-drop: false
[2023-07-18 09:09:11] [config] sync-freq: 200u
[2023-07-18 09:09:11] [config] sync-sgd: false
[2023-07-18 09:09:11] [config] tempdir: /tmp
[2023-07-18 09:09:11] [config] tied-embeddings: false
[2023-07-18 09:09:11] [config] tied-embeddings-all: true
[2023-07-18 09:09:11] [config] tied-embeddings-src: false
[2023-07-18 09:09:11] [config] train-embedder-rank:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] train-sets:
[2023-07-18 09:09:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 09:09:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 09:09:11] [config] transformer-aan-activation: swish
[2023-07-18 09:09:11] [config] transformer-aan-depth: 2
[2023-07-18 09:09:11] [config] transformer-aan-nogate: false
[2023-07-18 09:09:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 09:09:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 09:09:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 09:09:11] [config] transformer-depth-scaling: false
[2023-07-18 09:09:11] [config] transformer-dim-aan: 2048
[2023-07-18 09:09:11] [config] transformer-dim-ffn: 2048
[2023-07-18 09:09:11] [config] transformer-dropout: 0
[2023-07-18 09:09:11] [config] transformer-dropout-attention: 0
[2023-07-18 09:09:11] [config] transformer-dropout-ffn: 0
[2023-07-18 09:09:11] [config] transformer-ffn-activation: swish
[2023-07-18 09:09:11] [config] transformer-ffn-depth: 2
[2023-07-18 09:09:11] [config] transformer-guided-alignment-layer: last
[2023-07-18 09:09:11] [config] transformer-heads: 8
[2023-07-18 09:09:11] [config] transformer-no-projection: false
[2023-07-18 09:09:11] [config] transformer-pool: false
[2023-07-18 09:09:11] [config] transformer-postprocess: dan
[2023-07-18 09:09:11] [config] transformer-postprocess-emb: d
[2023-07-18 09:09:11] [config] transformer-postprocess-top: ""
[2023-07-18 09:09:11] [config] transformer-preprocess: ""
[2023-07-18 09:09:11] [config] transformer-tied-layers:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] transformer-train-position-embeddings: false
[2023-07-18 09:09:11] [config] tsv: false
[2023-07-18 09:09:11] [config] tsv-fields: 0
[2023-07-18 09:09:11] [config] type: amun
[2023-07-18 09:09:11] [config] ulr: false
[2023-07-18 09:09:11] [config] ulr-dim-emb: 0
[2023-07-18 09:09:11] [config] ulr-dropout: 0
[2023-07-18 09:09:11] [config] ulr-keys-vectors: ""
[2023-07-18 09:09:11] [config] ulr-query-vectors: ""
[2023-07-18 09:09:11] [config] ulr-softmax-temperature: 1
[2023-07-18 09:09:11] [config] ulr-trainable-transformation: false
[2023-07-18 09:09:11] [config] unlikelihood-loss: false
[2023-07-18 09:09:11] [config] valid-freq: 50000000
[2023-07-18 09:09:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 09:09:11] [config] valid-max-length: 1000
[2023-07-18 09:09:11] [config] valid-metrics:
[2023-07-18 09:09:11] [config]   - cross-entropy
[2023-07-18 09:09:11] [config]   - translation
[2023-07-18 09:09:11] [config] valid-mini-batch: 32
[2023-07-18 09:09:11] [config] valid-reset-stalled: false
[2023-07-18 09:09:11] [config] valid-script-args:
[2023-07-18 09:09:11] [config]   []
[2023-07-18 09:09:11] [config] valid-script-path: ""
[2023-07-18 09:09:11] [config] valid-sets:
[2023-07-18 09:09:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 09:09:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 09:09:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 09:09:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 09:09:11] [config] vocabs:
[2023-07-18 09:09:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 09:09:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 09:09:11] [config] word-penalty: 0
[2023-07-18 09:09:11] [config] word-scores: false
[2023-07-18 09:09:11] [config] workspace: 5500
[2023-07-18 09:09:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 09:09:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 09:09:11] [training] Using single-device training
[2023-07-18 09:09:11] Synced seed 1234
[2023-07-18 09:09:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 09:09:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 09:09:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 09:09:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 09:09:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 09:09:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 09:09:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 09:09:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 09:09:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 09:09:12] [comm] Using global sharding
[2023-07-18 09:09:12] [comm] NCCLCommunicators constructed successfully
[2023-07-18 09:09:12] [training] Using 1 GPUs
[2023-07-18 09:09:12] [logits] Applying loss function for 1 factor(s)
[2023-07-18 09:09:12] [memory] Reserving 80 MB, device gpu0
[2023-07-18 09:09:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 09:09:13] [memory] Reserving 80 MB, device gpu0
[2023-07-18 09:34:41] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 09:34:41] [valid] No post-processing script given for validating translator
[2023-07-18 09:34:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 09:34:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 09:34:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 09:34:41] [comm] Using global sharding
[2023-07-18 09:34:42] [comm] NCCLCommunicators constructed successfully
[2023-07-18 09:34:42] [training] Using 1 GPUs
[2023-07-18 09:34:42] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 09:34:43] Allocating memory for general optimizer shards
[2023-07-18 09:34:43] [memory] Reserving 322 MB, device gpu0
[2023-07-18 09:34:43] Loading Adam parameters
[2023-07-18 09:34:43] [memory] Reserving 322 MB, device gpu0
[2023-07-18 09:34:43] [memory] Reserving 80 MB, device gpu0
[2023-07-18 09:34:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 09:34:43] [data] Restoring the corpus state to epoch 21, batch 765
[2023-07-18 09:34:43] [data] Shuffling data
[2023-07-18 09:34:43] [data] Done reading 20,192 sentences
[2023-07-18 09:34:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 09:34:43] Training started
[2023-07-18 09:34:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 09:34:44] [memory] Reserving 80 MB, device gpu0
[2023-07-18 09:34:54] Parameter type float16, optimization type float32, casting types true
[2023-07-18 09:39:01] Seen 20,192 samples
[2023-07-18 09:39:01] Starting data epoch 22 in logical epoch 22
[2023-07-18 09:39:01] [data] Shuffling data
[2023-07-18 09:39:01] [data] Done reading 20,192 sentences
[2023-07-18 09:39:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 09:43:25] Seen 20,192 samples
[2023-07-18 09:43:25] Starting data epoch 23 in logical epoch 23
[2023-07-18 09:43:25] [data] Shuffling data
[2023-07-18 09:43:25] [data] Done reading 20,192 sentences
[2023-07-18 09:43:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 09:47:58] Seen 20,192 samples
[2023-07-18 09:47:58] Starting data epoch 24 in logical epoch 24
[2023-07-18 09:47:58] [data] Shuffling data
[2023-07-18 09:47:58] [data] Done reading 20,192 sentences
[2023-07-18 09:47:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 09:52:47] Seen 20,192 samples
[2023-07-18 09:52:47] Starting data epoch 25 in logical epoch 25
[2023-07-18 09:52:47] [data] Shuffling data
[2023-07-18 09:52:47] [data] Done reading 20,192 sentences
[2023-07-18 09:52:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 09:57:40] Seen 20,192 samples
[2023-07-18 09:57:40] Starting data epoch 26 in logical epoch 26
[2023-07-18 09:57:40] [data] Shuffling data
[2023-07-18 09:57:40] [data] Done reading 20,192 sentences
[2023-07-18 09:57:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 10:02:30] Seen 20,192 samples
[2023-07-18 10:02:30] Starting data epoch 27 in logical epoch 27
[2023-07-18 10:02:30] [data] Shuffling data
[2023-07-18 10:02:30] [data] Done reading 20,192 sentences
[2023-07-18 10:02:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 10:03:28] Ep. 27 : Up. 1000 : Sen. 4,405 : Cost 6.29883385 * 16,239,189 @ 19,232 after 16,239,189 : Time 1726.89s : 9403.73 words/s : gNorm 0.8707
[2023-07-18 10:07:17] Seen 20,192 samples
[2023-07-18 10:07:17] Starting data epoch 28 in logical epoch 28
[2023-07-18 10:07:17] [data] Shuffling data
[2023-07-18 10:07:17] [data] Done reading 20,192 sentences
[2023-07-18 10:07:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 10:11:58] Seen 20,192 samples
[2023-07-18 10:11:58] Starting data epoch 29 in logical epoch 29
[2023-07-18 10:11:58] [data] Shuffling data
[2023-07-18 10:11:58] [data] Done reading 20,192 sentences
[2023-07-18 10:11:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 10:16:33] Seen 20,192 samples
[2023-07-18 10:16:33] Starting data epoch 30 in logical epoch 30
[2023-07-18 10:16:33] [data] Shuffling data
[2023-07-18 10:16:33] [data] Done reading 20,192 sentences
[2023-07-18 10:16:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 10:21:17] Seen 20,192 samples
[2023-07-18 10:21:17] Starting data epoch 31 in logical epoch 31
[2023-07-18 10:21:17] Training finished
[2023-07-18 10:21:28] [valid] Ep. 31 : Up. 1144 : cross-entropy : 159.571 : new best
[2023-07-18 10:23:55] [valid] Ep. 31 : Up. 1144 : translation : 0 : new best
[2023-07-18 10:23:55] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 10:23:57] Saving Adam parameters
[2023-07-18 10:23:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 10:24:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 10:24:04] [marian] Running on node22.datos.cluster.uy as process 7406 with command line:
[2023-07-18 10:24:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 10:24:04] [config] after: 0e
[2023-07-18 10:24:04] [config] after-batches: 0
[2023-07-18 10:24:04] [config] after-epochs: 40
[2023-07-18 10:24:04] [config] all-caps-every: 0
[2023-07-18 10:24:04] [config] allow-unk: false
[2023-07-18 10:24:04] [config] authors: false
[2023-07-18 10:24:04] [config] beam-size: 12
[2023-07-18 10:24:04] [config] bert-class-symbol: "[CLS]"
[2023-07-18 10:24:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 10:24:04] [config] bert-masking-fraction: 0.15
[2023-07-18 10:24:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 10:24:04] [config] bert-train-type-embeddings: true
[2023-07-18 10:24:04] [config] bert-type-vocab-size: 2
[2023-07-18 10:24:04] [config] build-info: ""
[2023-07-18 10:24:04] [config] check-gradient-nan: false
[2023-07-18 10:24:04] [config] check-nan: false
[2023-07-18 10:24:04] [config] cite: false
[2023-07-18 10:24:04] [config] clip-norm: 1
[2023-07-18 10:24:04] [config] cost-scaling:
[2023-07-18 10:24:04] [config]   - 256.f
[2023-07-18 10:24:04] [config]   - 1000
[2023-07-18 10:24:04] [config]   - 2.f
[2023-07-18 10:24:04] [config]   - 256.f
[2023-07-18 10:24:04] [config] cost-type: ce-sum
[2023-07-18 10:24:04] [config] cpu-threads: 0
[2023-07-18 10:24:04] [config] data-threads: 8
[2023-07-18 10:24:04] [config] data-weighting: ""
[2023-07-18 10:24:04] [config] data-weighting-type: sentence
[2023-07-18 10:24:04] [config] dec-cell: gru
[2023-07-18 10:24:04] [config] dec-cell-base-depth: 2
[2023-07-18 10:24:04] [config] dec-cell-high-depth: 1
[2023-07-18 10:24:04] [config] dec-depth: 1
[2023-07-18 10:24:04] [config] devices:
[2023-07-18 10:24:04] [config]   - 0
[2023-07-18 10:24:04] [config] dim-emb: 512
[2023-07-18 10:24:04] [config] dim-rnn: 1024
[2023-07-18 10:24:04] [config] dim-vocabs:
[2023-07-18 10:24:04] [config]   - 16384
[2023-07-18 10:24:04] [config]   - 16384
[2023-07-18 10:24:04] [config] disp-first: 0
[2023-07-18 10:24:04] [config] disp-freq: 1000u
[2023-07-18 10:24:04] [config] disp-label-counts: true
[2023-07-18 10:24:04] [config] dropout-rnn: 0
[2023-07-18 10:24:04] [config] dropout-src: 0
[2023-07-18 10:24:04] [config] dropout-trg: 0
[2023-07-18 10:24:04] [config] dump-config: ""
[2023-07-18 10:24:04] [config] dynamic-gradient-scaling:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] early-stopping: 200
[2023-07-18 10:24:04] [config] early-stopping-on: first
[2023-07-18 10:24:04] [config] embedding-fix-src: false
[2023-07-18 10:24:04] [config] embedding-fix-trg: false
[2023-07-18 10:24:04] [config] embedding-normalization: false
[2023-07-18 10:24:04] [config] embedding-vectors:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] enc-cell: gru
[2023-07-18 10:24:04] [config] enc-cell-depth: 1
[2023-07-18 10:24:04] [config] enc-depth: 1
[2023-07-18 10:24:04] [config] enc-type: bidirectional
[2023-07-18 10:24:04] [config] english-title-case-every: 0
[2023-07-18 10:24:04] [config] exponential-smoothing: 0
[2023-07-18 10:24:04] [config] factor-weight: 1
[2023-07-18 10:24:04] [config] factors-combine: sum
[2023-07-18 10:24:04] [config] factors-dim-emb: 0
[2023-07-18 10:24:04] [config] gradient-checkpointing: false
[2023-07-18 10:24:04] [config] gradient-norm-average-window: 100
[2023-07-18 10:24:04] [config] guided-alignment: none
[2023-07-18 10:24:04] [config] guided-alignment-cost: mse
[2023-07-18 10:24:04] [config] guided-alignment-weight: 0.1
[2023-07-18 10:24:04] [config] ignore-model-config: false
[2023-07-18 10:24:04] [config] input-types:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] interpolate-env-vars: false
[2023-07-18 10:24:04] [config] keep-best: false
[2023-07-18 10:24:04] [config] label-smoothing: 0
[2023-07-18 10:24:04] [config] layer-normalization: false
[2023-07-18 10:24:04] [config] learn-rate: 0.0001
[2023-07-18 10:24:04] [config] lemma-dependency: ""
[2023-07-18 10:24:04] [config] lemma-dim-emb: 0
[2023-07-18 10:24:04] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 10:24:04] [config] log-level: info
[2023-07-18 10:24:04] [config] log-time-zone: ""
[2023-07-18 10:24:04] [config] logical-epoch:
[2023-07-18 10:24:04] [config]   - 1e
[2023-07-18 10:24:04] [config]   - 0
[2023-07-18 10:24:04] [config] lr-decay: 0
[2023-07-18 10:24:04] [config] lr-decay-freq: 50000
[2023-07-18 10:24:04] [config] lr-decay-inv-sqrt:
[2023-07-18 10:24:04] [config]   - 0
[2023-07-18 10:24:04] [config] lr-decay-repeat-warmup: false
[2023-07-18 10:24:04] [config] lr-decay-reset-optimizer: false
[2023-07-18 10:24:04] [config] lr-decay-start:
[2023-07-18 10:24:04] [config]   - 10
[2023-07-18 10:24:04] [config]   - 1
[2023-07-18 10:24:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 10:24:04] [config] lr-report: false
[2023-07-18 10:24:04] [config] lr-warmup: 0
[2023-07-18 10:24:04] [config] lr-warmup-at-reload: false
[2023-07-18 10:24:04] [config] lr-warmup-cycle: false
[2023-07-18 10:24:04] [config] lr-warmup-start-rate: 0
[2023-07-18 10:24:04] [config] max-length: 150
[2023-07-18 10:24:04] [config] max-length-crop: true
[2023-07-18 10:24:04] [config] max-length-factor: 3
[2023-07-18 10:24:04] [config] maxi-batch: 100
[2023-07-18 10:24:04] [config] maxi-batch-sort: trg
[2023-07-18 10:24:04] [config] mini-batch: 64
[2023-07-18 10:24:04] [config] mini-batch-fit: true
[2023-07-18 10:24:04] [config] mini-batch-fit-step: 10
[2023-07-18 10:24:04] [config] mini-batch-round-up: true
[2023-07-18 10:24:04] [config] mini-batch-track-lr: false
[2023-07-18 10:24:04] [config] mini-batch-warmup: 0
[2023-07-18 10:24:04] [config] mini-batch-words: 0
[2023-07-18 10:24:04] [config] mini-batch-words-ref: 0
[2023-07-18 10:24:04] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 10:24:04] [config] multi-loss-type: sum
[2023-07-18 10:24:04] [config] n-best: false
[2023-07-18 10:24:04] [config] no-nccl: false
[2023-07-18 10:24:04] [config] no-reload: false
[2023-07-18 10:24:04] [config] no-restore-corpus: false
[2023-07-18 10:24:04] [config] normalize: 0
[2023-07-18 10:24:04] [config] normalize-gradient: false
[2023-07-18 10:24:04] [config] num-devices: 0
[2023-07-18 10:24:04] [config] optimizer: adam
[2023-07-18 10:24:04] [config] optimizer-delay: 1
[2023-07-18 10:24:04] [config] optimizer-params:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] output-omit-bias: false
[2023-07-18 10:24:04] [config] overwrite: true
[2023-07-18 10:24:04] [config] precision:
[2023-07-18 10:24:04] [config]   - float16
[2023-07-18 10:24:04] [config]   - float32
[2023-07-18 10:24:04] [config] pretrained-model: ""
[2023-07-18 10:24:04] [config] quantize-biases: false
[2023-07-18 10:24:04] [config] quantize-bits: 0
[2023-07-18 10:24:04] [config] quantize-log-based: false
[2023-07-18 10:24:04] [config] quantize-optimization-steps: 0
[2023-07-18 10:24:04] [config] quiet: false
[2023-07-18 10:24:04] [config] quiet-translation: true
[2023-07-18 10:24:04] [config] relative-paths: false
[2023-07-18 10:24:04] [config] right-left: false
[2023-07-18 10:24:04] [config] save-freq: 10000u
[2023-07-18 10:24:04] [config] seed: 1234
[2023-07-18 10:24:04] [config] sentencepiece-alphas:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] sentencepiece-max-lines: 2000000
[2023-07-18 10:24:04] [config] sentencepiece-options: ""
[2023-07-18 10:24:04] [config] sharding: global
[2023-07-18 10:24:04] [config] shuffle: data
[2023-07-18 10:24:04] [config] shuffle-in-ram: false
[2023-07-18 10:24:04] [config] sigterm: save-and-exit
[2023-07-18 10:24:04] [config] skip: false
[2023-07-18 10:24:04] [config] sqlite: ""
[2023-07-18 10:24:04] [config] sqlite-drop: false
[2023-07-18 10:24:04] [config] sync-freq: 200u
[2023-07-18 10:24:04] [config] sync-sgd: false
[2023-07-18 10:24:04] [config] tempdir: /tmp
[2023-07-18 10:24:04] [config] tied-embeddings: false
[2023-07-18 10:24:04] [config] tied-embeddings-all: true
[2023-07-18 10:24:04] [config] tied-embeddings-src: false
[2023-07-18 10:24:04] [config] train-embedder-rank:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] train-sets:
[2023-07-18 10:24:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 10:24:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 10:24:04] [config] transformer-aan-activation: swish
[2023-07-18 10:24:04] [config] transformer-aan-depth: 2
[2023-07-18 10:24:04] [config] transformer-aan-nogate: false
[2023-07-18 10:24:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 10:24:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 10:24:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 10:24:04] [config] transformer-depth-scaling: false
[2023-07-18 10:24:04] [config] transformer-dim-aan: 2048
[2023-07-18 10:24:04] [config] transformer-dim-ffn: 2048
[2023-07-18 10:24:04] [config] transformer-dropout: 0
[2023-07-18 10:24:04] [config] transformer-dropout-attention: 0
[2023-07-18 10:24:04] [config] transformer-dropout-ffn: 0
[2023-07-18 10:24:04] [config] transformer-ffn-activation: swish
[2023-07-18 10:24:04] [config] transformer-ffn-depth: 2
[2023-07-18 10:24:04] [config] transformer-guided-alignment-layer: last
[2023-07-18 10:24:04] [config] transformer-heads: 8
[2023-07-18 10:24:04] [config] transformer-no-projection: false
[2023-07-18 10:24:04] [config] transformer-pool: false
[2023-07-18 10:24:04] [config] transformer-postprocess: dan
[2023-07-18 10:24:04] [config] transformer-postprocess-emb: d
[2023-07-18 10:24:04] [config] transformer-postprocess-top: ""
[2023-07-18 10:24:04] [config] transformer-preprocess: ""
[2023-07-18 10:24:04] [config] transformer-tied-layers:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] transformer-train-position-embeddings: false
[2023-07-18 10:24:04] [config] tsv: false
[2023-07-18 10:24:04] [config] tsv-fields: 0
[2023-07-18 10:24:04] [config] type: amun
[2023-07-18 10:24:04] [config] ulr: false
[2023-07-18 10:24:04] [config] ulr-dim-emb: 0
[2023-07-18 10:24:04] [config] ulr-dropout: 0
[2023-07-18 10:24:04] [config] ulr-keys-vectors: ""
[2023-07-18 10:24:04] [config] ulr-query-vectors: ""
[2023-07-18 10:24:04] [config] ulr-softmax-temperature: 1
[2023-07-18 10:24:04] [config] ulr-trainable-transformation: false
[2023-07-18 10:24:04] [config] unlikelihood-loss: false
[2023-07-18 10:24:04] [config] valid-freq: 50000000
[2023-07-18 10:24:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 10:24:04] [config] valid-max-length: 1000
[2023-07-18 10:24:04] [config] valid-metrics:
[2023-07-18 10:24:04] [config]   - cross-entropy
[2023-07-18 10:24:04] [config]   - translation
[2023-07-18 10:24:04] [config] valid-mini-batch: 32
[2023-07-18 10:24:04] [config] valid-reset-stalled: false
[2023-07-18 10:24:04] [config] valid-script-args:
[2023-07-18 10:24:04] [config]   []
[2023-07-18 10:24:04] [config] valid-script-path: ""
[2023-07-18 10:24:04] [config] valid-sets:
[2023-07-18 10:24:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 10:24:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 10:24:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 10:24:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 10:24:04] [config] vocabs:
[2023-07-18 10:24:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 10:24:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 10:24:04] [config] word-penalty: 0
[2023-07-18 10:24:04] [config] word-scores: false
[2023-07-18 10:24:04] [config] workspace: 5500
[2023-07-18 10:24:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 10:24:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 10:24:04] [training] Using single-device training
[2023-07-18 10:24:04] Synced seed 1234
[2023-07-18 10:24:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 10:24:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 10:24:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 10:24:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 10:24:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 10:24:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 10:24:04] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 10:24:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 10:24:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 10:24:05] [comm] Using global sharding
[2023-07-18 10:24:05] [comm] NCCLCommunicators constructed successfully
[2023-07-18 10:24:05] [training] Using 1 GPUs
[2023-07-18 10:24:05] [logits] Applying loss function for 1 factor(s)
[2023-07-18 10:24:05] [memory] Reserving 80 MB, device gpu0
[2023-07-18 10:24:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 10:24:06] [memory] Reserving 80 MB, device gpu0
[2023-07-18 10:50:12] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 10:50:13] [valid] No post-processing script given for validating translator
[2023-07-18 10:50:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 10:50:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 10:50:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 10:50:13] [comm] Using global sharding
[2023-07-18 10:50:13] [comm] NCCLCommunicators constructed successfully
[2023-07-18 10:50:13] [training] Using 1 GPUs
[2023-07-18 10:50:13] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 10:50:14] Allocating memory for general optimizer shards
[2023-07-18 10:50:14] [memory] Reserving 322 MB, device gpu0
[2023-07-18 10:50:14] Loading Adam parameters
[2023-07-18 10:50:14] [memory] Reserving 322 MB, device gpu0
[2023-07-18 10:50:14] [memory] Reserving 80 MB, device gpu0
[2023-07-18 10:50:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 10:50:15] [data] Restoring the corpus state to epoch 31, batch 1144
[2023-07-18 10:50:15] [data] Shuffling data
[2023-07-18 10:50:15] [data] Done reading 20,192 sentences
[2023-07-18 10:50:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 10:50:15] Training started
[2023-07-18 10:50:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 10:50:15] [memory] Reserving 80 MB, device gpu0
[2023-07-18 10:50:22] Parameter type float16, optimization type float32, casting types true
[2023-07-18 10:54:52] Seen 20,192 samples
[2023-07-18 10:54:52] Starting data epoch 32 in logical epoch 32
[2023-07-18 10:54:52] [data] Shuffling data
[2023-07-18 10:54:52] [data] Done reading 20,192 sentences
[2023-07-18 10:54:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 10:59:25] Seen 20,192 samples
[2023-07-18 10:59:25] Starting data epoch 33 in logical epoch 33
[2023-07-18 10:59:25] [data] Shuffling data
[2023-07-18 10:59:25] [data] Done reading 20,192 sentences
[2023-07-18 10:59:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:04:03] Seen 20,192 samples
[2023-07-18 11:04:03] Starting data epoch 34 in logical epoch 34
[2023-07-18 11:04:03] [data] Shuffling data
[2023-07-18 11:04:03] [data] Done reading 20,192 sentences
[2023-07-18 11:04:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:08:42] Seen 20,192 samples
[2023-07-18 11:08:42] Starting data epoch 35 in logical epoch 35
[2023-07-18 11:08:42] [data] Shuffling data
[2023-07-18 11:08:42] [data] Done reading 20,192 sentences
[2023-07-18 11:08:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:13:28] Seen 20,192 samples
[2023-07-18 11:13:28] Starting data epoch 36 in logical epoch 36
[2023-07-18 11:13:28] [data] Shuffling data
[2023-07-18 11:13:28] [data] Done reading 20,192 sentences
[2023-07-18 11:13:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:18:11] Seen 20,192 samples
[2023-07-18 11:18:11] Starting data epoch 37 in logical epoch 37
[2023-07-18 11:18:11] [data] Shuffling data
[2023-07-18 11:18:11] [data] Done reading 20,192 sentences
[2023-07-18 11:18:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:22:55] Seen 20,192 samples
[2023-07-18 11:22:55] Starting data epoch 38 in logical epoch 38
[2023-07-18 11:22:55] [data] Shuffling data
[2023-07-18 11:22:55] [data] Done reading 20,192 sentences
[2023-07-18 11:22:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:27:40] Seen 20,192 samples
[2023-07-18 11:27:40] Starting data epoch 39 in logical epoch 39
[2023-07-18 11:27:40] [data] Shuffling data
[2023-07-18 11:27:40] [data] Done reading 20,192 sentences
[2023-07-18 11:27:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:32:23] Seen 20,192 samples
[2023-07-18 11:32:23] Starting data epoch 40 in logical epoch 40
[2023-07-18 11:32:23] [data] Shuffling data
[2023-07-18 11:32:23] [data] Done reading 20,192 sentences
[2023-07-18 11:32:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 11:37:07] Seen 20,192 samples
[2023-07-18 11:37:07] Starting data epoch 41 in logical epoch 41
[2023-07-18 11:37:07] Training finished
[2023-07-18 11:37:18] [valid] Ep. 41 : Up. 1528 : cross-entropy : 151.215 : new best
[2023-07-18 11:39:13] [valid] Ep. 41 : Up. 1528 : translation : 0 : new best
[2023-07-18 11:39:13] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 11:39:14] Saving Adam parameters
[2023-07-18 11:39:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 11:39:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 11:39:21] [marian] Running on node22.datos.cluster.uy as process 12397 with command line:
[2023-07-18 11:39:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 11:39:21] [config] after: 0e
[2023-07-18 11:39:21] [config] after-batches: 0
[2023-07-18 11:39:21] [config] after-epochs: 50
[2023-07-18 11:39:21] [config] all-caps-every: 0
[2023-07-18 11:39:21] [config] allow-unk: false
[2023-07-18 11:39:21] [config] authors: false
[2023-07-18 11:39:21] [config] beam-size: 12
[2023-07-18 11:39:21] [config] bert-class-symbol: "[CLS]"
[2023-07-18 11:39:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 11:39:21] [config] bert-masking-fraction: 0.15
[2023-07-18 11:39:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 11:39:21] [config] bert-train-type-embeddings: true
[2023-07-18 11:39:21] [config] bert-type-vocab-size: 2
[2023-07-18 11:39:21] [config] build-info: ""
[2023-07-18 11:39:21] [config] check-gradient-nan: false
[2023-07-18 11:39:21] [config] check-nan: false
[2023-07-18 11:39:21] [config] cite: false
[2023-07-18 11:39:21] [config] clip-norm: 1
[2023-07-18 11:39:21] [config] cost-scaling:
[2023-07-18 11:39:21] [config]   - 256.f
[2023-07-18 11:39:21] [config]   - 1000
[2023-07-18 11:39:21] [config]   - 2.f
[2023-07-18 11:39:21] [config]   - 256.f
[2023-07-18 11:39:21] [config] cost-type: ce-sum
[2023-07-18 11:39:21] [config] cpu-threads: 0
[2023-07-18 11:39:21] [config] data-threads: 8
[2023-07-18 11:39:21] [config] data-weighting: ""
[2023-07-18 11:39:21] [config] data-weighting-type: sentence
[2023-07-18 11:39:21] [config] dec-cell: gru
[2023-07-18 11:39:21] [config] dec-cell-base-depth: 2
[2023-07-18 11:39:21] [config] dec-cell-high-depth: 1
[2023-07-18 11:39:21] [config] dec-depth: 1
[2023-07-18 11:39:21] [config] devices:
[2023-07-18 11:39:21] [config]   - 0
[2023-07-18 11:39:21] [config] dim-emb: 512
[2023-07-18 11:39:21] [config] dim-rnn: 1024
[2023-07-18 11:39:21] [config] dim-vocabs:
[2023-07-18 11:39:21] [config]   - 16384
[2023-07-18 11:39:21] [config]   - 16384
[2023-07-18 11:39:21] [config] disp-first: 0
[2023-07-18 11:39:21] [config] disp-freq: 1000u
[2023-07-18 11:39:21] [config] disp-label-counts: true
[2023-07-18 11:39:21] [config] dropout-rnn: 0
[2023-07-18 11:39:21] [config] dropout-src: 0
[2023-07-18 11:39:21] [config] dropout-trg: 0
[2023-07-18 11:39:21] [config] dump-config: ""
[2023-07-18 11:39:21] [config] dynamic-gradient-scaling:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] early-stopping: 200
[2023-07-18 11:39:21] [config] early-stopping-on: first
[2023-07-18 11:39:21] [config] embedding-fix-src: false
[2023-07-18 11:39:21] [config] embedding-fix-trg: false
[2023-07-18 11:39:21] [config] embedding-normalization: false
[2023-07-18 11:39:21] [config] embedding-vectors:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] enc-cell: gru
[2023-07-18 11:39:21] [config] enc-cell-depth: 1
[2023-07-18 11:39:21] [config] enc-depth: 1
[2023-07-18 11:39:21] [config] enc-type: bidirectional
[2023-07-18 11:39:21] [config] english-title-case-every: 0
[2023-07-18 11:39:21] [config] exponential-smoothing: 0
[2023-07-18 11:39:21] [config] factor-weight: 1
[2023-07-18 11:39:21] [config] factors-combine: sum
[2023-07-18 11:39:21] [config] factors-dim-emb: 0
[2023-07-18 11:39:21] [config] gradient-checkpointing: false
[2023-07-18 11:39:21] [config] gradient-norm-average-window: 100
[2023-07-18 11:39:21] [config] guided-alignment: none
[2023-07-18 11:39:21] [config] guided-alignment-cost: mse
[2023-07-18 11:39:21] [config] guided-alignment-weight: 0.1
[2023-07-18 11:39:21] [config] ignore-model-config: false
[2023-07-18 11:39:21] [config] input-types:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] interpolate-env-vars: false
[2023-07-18 11:39:21] [config] keep-best: false
[2023-07-18 11:39:21] [config] label-smoothing: 0
[2023-07-18 11:39:21] [config] layer-normalization: false
[2023-07-18 11:39:21] [config] learn-rate: 0.0001
[2023-07-18 11:39:21] [config] lemma-dependency: ""
[2023-07-18 11:39:21] [config] lemma-dim-emb: 0
[2023-07-18 11:39:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 11:39:21] [config] log-level: info
[2023-07-18 11:39:21] [config] log-time-zone: ""
[2023-07-18 11:39:21] [config] logical-epoch:
[2023-07-18 11:39:21] [config]   - 1e
[2023-07-18 11:39:21] [config]   - 0
[2023-07-18 11:39:21] [config] lr-decay: 0
[2023-07-18 11:39:21] [config] lr-decay-freq: 50000
[2023-07-18 11:39:21] [config] lr-decay-inv-sqrt:
[2023-07-18 11:39:21] [config]   - 0
[2023-07-18 11:39:21] [config] lr-decay-repeat-warmup: false
[2023-07-18 11:39:21] [config] lr-decay-reset-optimizer: false
[2023-07-18 11:39:21] [config] lr-decay-start:
[2023-07-18 11:39:21] [config]   - 10
[2023-07-18 11:39:21] [config]   - 1
[2023-07-18 11:39:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 11:39:21] [config] lr-report: false
[2023-07-18 11:39:21] [config] lr-warmup: 0
[2023-07-18 11:39:21] [config] lr-warmup-at-reload: false
[2023-07-18 11:39:21] [config] lr-warmup-cycle: false
[2023-07-18 11:39:21] [config] lr-warmup-start-rate: 0
[2023-07-18 11:39:21] [config] max-length: 150
[2023-07-18 11:39:21] [config] max-length-crop: true
[2023-07-18 11:39:21] [config] max-length-factor: 3
[2023-07-18 11:39:21] [config] maxi-batch: 100
[2023-07-18 11:39:21] [config] maxi-batch-sort: trg
[2023-07-18 11:39:21] [config] mini-batch: 64
[2023-07-18 11:39:21] [config] mini-batch-fit: true
[2023-07-18 11:39:21] [config] mini-batch-fit-step: 10
[2023-07-18 11:39:21] [config] mini-batch-round-up: true
[2023-07-18 11:39:21] [config] mini-batch-track-lr: false
[2023-07-18 11:39:21] [config] mini-batch-warmup: 0
[2023-07-18 11:39:21] [config] mini-batch-words: 0
[2023-07-18 11:39:21] [config] mini-batch-words-ref: 0
[2023-07-18 11:39:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 11:39:21] [config] multi-loss-type: sum
[2023-07-18 11:39:21] [config] n-best: false
[2023-07-18 11:39:21] [config] no-nccl: false
[2023-07-18 11:39:21] [config] no-reload: false
[2023-07-18 11:39:21] [config] no-restore-corpus: false
[2023-07-18 11:39:21] [config] normalize: 0
[2023-07-18 11:39:21] [config] normalize-gradient: false
[2023-07-18 11:39:21] [config] num-devices: 0
[2023-07-18 11:39:21] [config] optimizer: adam
[2023-07-18 11:39:21] [config] optimizer-delay: 1
[2023-07-18 11:39:21] [config] optimizer-params:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] output-omit-bias: false
[2023-07-18 11:39:21] [config] overwrite: true
[2023-07-18 11:39:21] [config] precision:
[2023-07-18 11:39:21] [config]   - float16
[2023-07-18 11:39:21] [config]   - float32
[2023-07-18 11:39:21] [config] pretrained-model: ""
[2023-07-18 11:39:21] [config] quantize-biases: false
[2023-07-18 11:39:21] [config] quantize-bits: 0
[2023-07-18 11:39:21] [config] quantize-log-based: false
[2023-07-18 11:39:21] [config] quantize-optimization-steps: 0
[2023-07-18 11:39:21] [config] quiet: false
[2023-07-18 11:39:21] [config] quiet-translation: true
[2023-07-18 11:39:21] [config] relative-paths: false
[2023-07-18 11:39:21] [config] right-left: false
[2023-07-18 11:39:21] [config] save-freq: 10000u
[2023-07-18 11:39:21] [config] seed: 1234
[2023-07-18 11:39:21] [config] sentencepiece-alphas:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] sentencepiece-max-lines: 2000000
[2023-07-18 11:39:21] [config] sentencepiece-options: ""
[2023-07-18 11:39:21] [config] sharding: global
[2023-07-18 11:39:21] [config] shuffle: data
[2023-07-18 11:39:21] [config] shuffle-in-ram: false
[2023-07-18 11:39:21] [config] sigterm: save-and-exit
[2023-07-18 11:39:21] [config] skip: false
[2023-07-18 11:39:21] [config] sqlite: ""
[2023-07-18 11:39:21] [config] sqlite-drop: false
[2023-07-18 11:39:21] [config] sync-freq: 200u
[2023-07-18 11:39:21] [config] sync-sgd: false
[2023-07-18 11:39:21] [config] tempdir: /tmp
[2023-07-18 11:39:21] [config] tied-embeddings: false
[2023-07-18 11:39:21] [config] tied-embeddings-all: true
[2023-07-18 11:39:21] [config] tied-embeddings-src: false
[2023-07-18 11:39:21] [config] train-embedder-rank:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] train-sets:
[2023-07-18 11:39:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 11:39:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 11:39:21] [config] transformer-aan-activation: swish
[2023-07-18 11:39:21] [config] transformer-aan-depth: 2
[2023-07-18 11:39:21] [config] transformer-aan-nogate: false
[2023-07-18 11:39:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 11:39:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 11:39:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 11:39:21] [config] transformer-depth-scaling: false
[2023-07-18 11:39:21] [config] transformer-dim-aan: 2048
[2023-07-18 11:39:21] [config] transformer-dim-ffn: 2048
[2023-07-18 11:39:21] [config] transformer-dropout: 0
[2023-07-18 11:39:21] [config] transformer-dropout-attention: 0
[2023-07-18 11:39:21] [config] transformer-dropout-ffn: 0
[2023-07-18 11:39:21] [config] transformer-ffn-activation: swish
[2023-07-18 11:39:21] [config] transformer-ffn-depth: 2
[2023-07-18 11:39:21] [config] transformer-guided-alignment-layer: last
[2023-07-18 11:39:21] [config] transformer-heads: 8
[2023-07-18 11:39:21] [config] transformer-no-projection: false
[2023-07-18 11:39:21] [config] transformer-pool: false
[2023-07-18 11:39:21] [config] transformer-postprocess: dan
[2023-07-18 11:39:21] [config] transformer-postprocess-emb: d
[2023-07-18 11:39:21] [config] transformer-postprocess-top: ""
[2023-07-18 11:39:21] [config] transformer-preprocess: ""
[2023-07-18 11:39:21] [config] transformer-tied-layers:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] transformer-train-position-embeddings: false
[2023-07-18 11:39:21] [config] tsv: false
[2023-07-18 11:39:21] [config] tsv-fields: 0
[2023-07-18 11:39:21] [config] type: amun
[2023-07-18 11:39:21] [config] ulr: false
[2023-07-18 11:39:21] [config] ulr-dim-emb: 0
[2023-07-18 11:39:21] [config] ulr-dropout: 0
[2023-07-18 11:39:21] [config] ulr-keys-vectors: ""
[2023-07-18 11:39:21] [config] ulr-query-vectors: ""
[2023-07-18 11:39:21] [config] ulr-softmax-temperature: 1
[2023-07-18 11:39:21] [config] ulr-trainable-transformation: false
[2023-07-18 11:39:21] [config] unlikelihood-loss: false
[2023-07-18 11:39:21] [config] valid-freq: 50000000
[2023-07-18 11:39:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 11:39:21] [config] valid-max-length: 1000
[2023-07-18 11:39:21] [config] valid-metrics:
[2023-07-18 11:39:21] [config]   - cross-entropy
[2023-07-18 11:39:21] [config]   - translation
[2023-07-18 11:39:21] [config] valid-mini-batch: 32
[2023-07-18 11:39:21] [config] valid-reset-stalled: false
[2023-07-18 11:39:21] [config] valid-script-args:
[2023-07-18 11:39:21] [config]   []
[2023-07-18 11:39:21] [config] valid-script-path: ""
[2023-07-18 11:39:21] [config] valid-sets:
[2023-07-18 11:39:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 11:39:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 11:39:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 11:39:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 11:39:21] [config] vocabs:
[2023-07-18 11:39:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 11:39:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 11:39:21] [config] word-penalty: 0
[2023-07-18 11:39:21] [config] word-scores: false
[2023-07-18 11:39:21] [config] workspace: 5500
[2023-07-18 11:39:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 11:39:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 11:39:21] [training] Using single-device training
[2023-07-18 11:39:22] Synced seed 1234
[2023-07-18 11:39:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 11:39:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 11:39:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 11:39:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 11:39:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 11:39:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 11:39:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 11:39:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 11:39:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 11:39:23] [comm] Using global sharding
[2023-07-18 11:39:23] [comm] NCCLCommunicators constructed successfully
[2023-07-18 11:39:23] [training] Using 1 GPUs
[2023-07-18 11:39:23] [logits] Applying loss function for 1 factor(s)
[2023-07-18 11:39:23] [memory] Reserving 80 MB, device gpu0
[2023-07-18 11:39:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 11:39:23] [memory] Reserving 80 MB, device gpu0
[2023-07-18 12:04:23] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 12:04:23] [valid] No post-processing script given for validating translator
[2023-07-18 12:04:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 12:04:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 12:04:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 12:04:23] [comm] Using global sharding
[2023-07-18 12:04:23] [comm] NCCLCommunicators constructed successfully
[2023-07-18 12:04:23] [training] Using 1 GPUs
[2023-07-18 12:04:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 12:04:24] Allocating memory for general optimizer shards
[2023-07-18 12:04:24] [memory] Reserving 322 MB, device gpu0
[2023-07-18 12:04:24] Loading Adam parameters
[2023-07-18 12:04:24] [memory] Reserving 322 MB, device gpu0
[2023-07-18 12:04:24] [memory] Reserving 80 MB, device gpu0
[2023-07-18 12:04:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 12:04:25] [data] Restoring the corpus state to epoch 41, batch 1528
[2023-07-18 12:04:25] [data] Shuffling data
[2023-07-18 12:04:25] [data] Done reading 20,192 sentences
[2023-07-18 12:04:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:04:25] Training started
[2023-07-18 12:04:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 12:04:25] [memory] Reserving 80 MB, device gpu0
[2023-07-18 12:04:29] Parameter type float16, optimization type float32, casting types true
[2023-07-18 12:09:01] Seen 20,192 samples
[2023-07-18 12:09:01] Starting data epoch 42 in logical epoch 42
[2023-07-18 12:09:01] [data] Shuffling data
[2023-07-18 12:09:01] [data] Done reading 20,192 sentences
[2023-07-18 12:09:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:13:41] Seen 20,192 samples
[2023-07-18 12:13:41] Starting data epoch 43 in logical epoch 43
[2023-07-18 12:13:41] [data] Shuffling data
[2023-07-18 12:13:41] [data] Done reading 20,192 sentences
[2023-07-18 12:13:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:18:14] Seen 20,192 samples
[2023-07-18 12:18:14] Starting data epoch 44 in logical epoch 44
[2023-07-18 12:18:14] [data] Shuffling data
[2023-07-18 12:18:14] [data] Done reading 20,192 sentences
[2023-07-18 12:18:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:22:55] Seen 20,192 samples
[2023-07-18 12:22:55] Starting data epoch 45 in logical epoch 45
[2023-07-18 12:22:55] [data] Shuffling data
[2023-07-18 12:22:55] [data] Done reading 20,192 sentences
[2023-07-18 12:22:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:27:19] Seen 20,192 samples
[2023-07-18 12:27:19] Starting data epoch 46 in logical epoch 46
[2023-07-18 12:27:19] [data] Shuffling data
[2023-07-18 12:27:19] [data] Done reading 20,192 sentences
[2023-07-18 12:27:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:31:55] Seen 20,192 samples
[2023-07-18 12:31:55] Starting data epoch 47 in logical epoch 47
[2023-07-18 12:31:55] [data] Shuffling data
[2023-07-18 12:31:55] [data] Done reading 20,192 sentences
[2023-07-18 12:31:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:36:31] Seen 20,192 samples
[2023-07-18 12:36:31] Starting data epoch 48 in logical epoch 48
[2023-07-18 12:36:31] [data] Shuffling data
[2023-07-18 12:36:31] [data] Done reading 20,192 sentences
[2023-07-18 12:36:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:41:09] Seen 20,192 samples
[2023-07-18 12:41:09] Starting data epoch 49 in logical epoch 49
[2023-07-18 12:41:09] [data] Shuffling data
[2023-07-18 12:41:09] [data] Done reading 20,192 sentences
[2023-07-18 12:41:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:45:48] Seen 20,192 samples
[2023-07-18 12:45:48] Starting data epoch 50 in logical epoch 50
[2023-07-18 12:45:48] [data] Shuffling data
[2023-07-18 12:45:48] [data] Done reading 20,192 sentences
[2023-07-18 12:45:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 12:50:24] Seen 20,192 samples
[2023-07-18 12:50:24] Starting data epoch 51 in logical epoch 51
[2023-07-18 12:50:24] Training finished
[2023-07-18 12:50:34] [valid] Ep. 51 : Up. 1908 : cross-entropy : 145.855 : new best
[2023-07-18 12:52:27] [valid] Ep. 51 : Up. 1908 : translation : 0 : new best
[2023-07-18 12:52:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 12:52:29] Saving Adam parameters
[2023-07-18 12:52:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 12:52:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 12:52:38] [marian] Running on node22.datos.cluster.uy as process 16941 with command line:
[2023-07-18 12:52:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 12:52:38] [config] after: 0e
[2023-07-18 12:52:38] [config] after-batches: 0
[2023-07-18 12:52:38] [config] after-epochs: 60
[2023-07-18 12:52:38] [config] all-caps-every: 0
[2023-07-18 12:52:38] [config] allow-unk: false
[2023-07-18 12:52:38] [config] authors: false
[2023-07-18 12:52:38] [config] beam-size: 12
[2023-07-18 12:52:38] [config] bert-class-symbol: "[CLS]"
[2023-07-18 12:52:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 12:52:38] [config] bert-masking-fraction: 0.15
[2023-07-18 12:52:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 12:52:38] [config] bert-train-type-embeddings: true
[2023-07-18 12:52:38] [config] bert-type-vocab-size: 2
[2023-07-18 12:52:38] [config] build-info: ""
[2023-07-18 12:52:38] [config] check-gradient-nan: false
[2023-07-18 12:52:38] [config] check-nan: false
[2023-07-18 12:52:38] [config] cite: false
[2023-07-18 12:52:38] [config] clip-norm: 1
[2023-07-18 12:52:38] [config] cost-scaling:
[2023-07-18 12:52:38] [config]   - 256.f
[2023-07-18 12:52:38] [config]   - 1000
[2023-07-18 12:52:38] [config]   - 2.f
[2023-07-18 12:52:38] [config]   - 256.f
[2023-07-18 12:52:38] [config] cost-type: ce-sum
[2023-07-18 12:52:38] [config] cpu-threads: 0
[2023-07-18 12:52:38] [config] data-threads: 8
[2023-07-18 12:52:38] [config] data-weighting: ""
[2023-07-18 12:52:38] [config] data-weighting-type: sentence
[2023-07-18 12:52:38] [config] dec-cell: gru
[2023-07-18 12:52:38] [config] dec-cell-base-depth: 2
[2023-07-18 12:52:38] [config] dec-cell-high-depth: 1
[2023-07-18 12:52:38] [config] dec-depth: 1
[2023-07-18 12:52:38] [config] devices:
[2023-07-18 12:52:38] [config]   - 0
[2023-07-18 12:52:38] [config] dim-emb: 512
[2023-07-18 12:52:38] [config] dim-rnn: 1024
[2023-07-18 12:52:38] [config] dim-vocabs:
[2023-07-18 12:52:38] [config]   - 16384
[2023-07-18 12:52:38] [config]   - 16384
[2023-07-18 12:52:38] [config] disp-first: 0
[2023-07-18 12:52:38] [config] disp-freq: 1000u
[2023-07-18 12:52:38] [config] disp-label-counts: true
[2023-07-18 12:52:38] [config] dropout-rnn: 0
[2023-07-18 12:52:38] [config] dropout-src: 0
[2023-07-18 12:52:38] [config] dropout-trg: 0
[2023-07-18 12:52:38] [config] dump-config: ""
[2023-07-18 12:52:38] [config] dynamic-gradient-scaling:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] early-stopping: 200
[2023-07-18 12:52:38] [config] early-stopping-on: first
[2023-07-18 12:52:38] [config] embedding-fix-src: false
[2023-07-18 12:52:38] [config] embedding-fix-trg: false
[2023-07-18 12:52:38] [config] embedding-normalization: false
[2023-07-18 12:52:38] [config] embedding-vectors:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] enc-cell: gru
[2023-07-18 12:52:38] [config] enc-cell-depth: 1
[2023-07-18 12:52:38] [config] enc-depth: 1
[2023-07-18 12:52:38] [config] enc-type: bidirectional
[2023-07-18 12:52:38] [config] english-title-case-every: 0
[2023-07-18 12:52:38] [config] exponential-smoothing: 0
[2023-07-18 12:52:38] [config] factor-weight: 1
[2023-07-18 12:52:38] [config] factors-combine: sum
[2023-07-18 12:52:38] [config] factors-dim-emb: 0
[2023-07-18 12:52:38] [config] gradient-checkpointing: false
[2023-07-18 12:52:38] [config] gradient-norm-average-window: 100
[2023-07-18 12:52:38] [config] guided-alignment: none
[2023-07-18 12:52:38] [config] guided-alignment-cost: mse
[2023-07-18 12:52:38] [config] guided-alignment-weight: 0.1
[2023-07-18 12:52:38] [config] ignore-model-config: false
[2023-07-18 12:52:38] [config] input-types:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] interpolate-env-vars: false
[2023-07-18 12:52:38] [config] keep-best: false
[2023-07-18 12:52:38] [config] label-smoothing: 0
[2023-07-18 12:52:38] [config] layer-normalization: false
[2023-07-18 12:52:38] [config] learn-rate: 0.0001
[2023-07-18 12:52:38] [config] lemma-dependency: ""
[2023-07-18 12:52:38] [config] lemma-dim-emb: 0
[2023-07-18 12:52:38] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 12:52:38] [config] log-level: info
[2023-07-18 12:52:38] [config] log-time-zone: ""
[2023-07-18 12:52:38] [config] logical-epoch:
[2023-07-18 12:52:38] [config]   - 1e
[2023-07-18 12:52:38] [config]   - 0
[2023-07-18 12:52:38] [config] lr-decay: 0
[2023-07-18 12:52:38] [config] lr-decay-freq: 50000
[2023-07-18 12:52:38] [config] lr-decay-inv-sqrt:
[2023-07-18 12:52:38] [config]   - 0
[2023-07-18 12:52:38] [config] lr-decay-repeat-warmup: false
[2023-07-18 12:52:38] [config] lr-decay-reset-optimizer: false
[2023-07-18 12:52:38] [config] lr-decay-start:
[2023-07-18 12:52:38] [config]   - 10
[2023-07-18 12:52:38] [config]   - 1
[2023-07-18 12:52:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 12:52:38] [config] lr-report: false
[2023-07-18 12:52:38] [config] lr-warmup: 0
[2023-07-18 12:52:38] [config] lr-warmup-at-reload: false
[2023-07-18 12:52:38] [config] lr-warmup-cycle: false
[2023-07-18 12:52:38] [config] lr-warmup-start-rate: 0
[2023-07-18 12:52:38] [config] max-length: 150
[2023-07-18 12:52:38] [config] max-length-crop: true
[2023-07-18 12:52:38] [config] max-length-factor: 3
[2023-07-18 12:52:38] [config] maxi-batch: 100
[2023-07-18 12:52:38] [config] maxi-batch-sort: trg
[2023-07-18 12:52:38] [config] mini-batch: 64
[2023-07-18 12:52:38] [config] mini-batch-fit: true
[2023-07-18 12:52:38] [config] mini-batch-fit-step: 10
[2023-07-18 12:52:38] [config] mini-batch-round-up: true
[2023-07-18 12:52:38] [config] mini-batch-track-lr: false
[2023-07-18 12:52:38] [config] mini-batch-warmup: 0
[2023-07-18 12:52:38] [config] mini-batch-words: 0
[2023-07-18 12:52:38] [config] mini-batch-words-ref: 0
[2023-07-18 12:52:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 12:52:38] [config] multi-loss-type: sum
[2023-07-18 12:52:38] [config] n-best: false
[2023-07-18 12:52:38] [config] no-nccl: false
[2023-07-18 12:52:38] [config] no-reload: false
[2023-07-18 12:52:38] [config] no-restore-corpus: false
[2023-07-18 12:52:38] [config] normalize: 0
[2023-07-18 12:52:38] [config] normalize-gradient: false
[2023-07-18 12:52:38] [config] num-devices: 0
[2023-07-18 12:52:38] [config] optimizer: adam
[2023-07-18 12:52:38] [config] optimizer-delay: 1
[2023-07-18 12:52:38] [config] optimizer-params:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] output-omit-bias: false
[2023-07-18 12:52:38] [config] overwrite: true
[2023-07-18 12:52:38] [config] precision:
[2023-07-18 12:52:38] [config]   - float16
[2023-07-18 12:52:38] [config]   - float32
[2023-07-18 12:52:38] [config] pretrained-model: ""
[2023-07-18 12:52:38] [config] quantize-biases: false
[2023-07-18 12:52:38] [config] quantize-bits: 0
[2023-07-18 12:52:38] [config] quantize-log-based: false
[2023-07-18 12:52:38] [config] quantize-optimization-steps: 0
[2023-07-18 12:52:38] [config] quiet: false
[2023-07-18 12:52:38] [config] quiet-translation: true
[2023-07-18 12:52:38] [config] relative-paths: false
[2023-07-18 12:52:38] [config] right-left: false
[2023-07-18 12:52:38] [config] save-freq: 10000u
[2023-07-18 12:52:38] [config] seed: 1234
[2023-07-18 12:52:38] [config] sentencepiece-alphas:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] sentencepiece-max-lines: 2000000
[2023-07-18 12:52:38] [config] sentencepiece-options: ""
[2023-07-18 12:52:38] [config] sharding: global
[2023-07-18 12:52:38] [config] shuffle: data
[2023-07-18 12:52:38] [config] shuffle-in-ram: false
[2023-07-18 12:52:38] [config] sigterm: save-and-exit
[2023-07-18 12:52:38] [config] skip: false
[2023-07-18 12:52:38] [config] sqlite: ""
[2023-07-18 12:52:38] [config] sqlite-drop: false
[2023-07-18 12:52:38] [config] sync-freq: 200u
[2023-07-18 12:52:38] [config] sync-sgd: false
[2023-07-18 12:52:38] [config] tempdir: /tmp
[2023-07-18 12:52:38] [config] tied-embeddings: false
[2023-07-18 12:52:38] [config] tied-embeddings-all: true
[2023-07-18 12:52:38] [config] tied-embeddings-src: false
[2023-07-18 12:52:38] [config] train-embedder-rank:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] train-sets:
[2023-07-18 12:52:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 12:52:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 12:52:38] [config] transformer-aan-activation: swish
[2023-07-18 12:52:38] [config] transformer-aan-depth: 2
[2023-07-18 12:52:38] [config] transformer-aan-nogate: false
[2023-07-18 12:52:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 12:52:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 12:52:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 12:52:38] [config] transformer-depth-scaling: false
[2023-07-18 12:52:38] [config] transformer-dim-aan: 2048
[2023-07-18 12:52:38] [config] transformer-dim-ffn: 2048
[2023-07-18 12:52:38] [config] transformer-dropout: 0
[2023-07-18 12:52:38] [config] transformer-dropout-attention: 0
[2023-07-18 12:52:38] [config] transformer-dropout-ffn: 0
[2023-07-18 12:52:38] [config] transformer-ffn-activation: swish
[2023-07-18 12:52:38] [config] transformer-ffn-depth: 2
[2023-07-18 12:52:38] [config] transformer-guided-alignment-layer: last
[2023-07-18 12:52:38] [config] transformer-heads: 8
[2023-07-18 12:52:38] [config] transformer-no-projection: false
[2023-07-18 12:52:38] [config] transformer-pool: false
[2023-07-18 12:52:38] [config] transformer-postprocess: dan
[2023-07-18 12:52:38] [config] transformer-postprocess-emb: d
[2023-07-18 12:52:38] [config] transformer-postprocess-top: ""
[2023-07-18 12:52:38] [config] transformer-preprocess: ""
[2023-07-18 12:52:38] [config] transformer-tied-layers:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] transformer-train-position-embeddings: false
[2023-07-18 12:52:38] [config] tsv: false
[2023-07-18 12:52:38] [config] tsv-fields: 0
[2023-07-18 12:52:38] [config] type: amun
[2023-07-18 12:52:38] [config] ulr: false
[2023-07-18 12:52:38] [config] ulr-dim-emb: 0
[2023-07-18 12:52:38] [config] ulr-dropout: 0
[2023-07-18 12:52:38] [config] ulr-keys-vectors: ""
[2023-07-18 12:52:38] [config] ulr-query-vectors: ""
[2023-07-18 12:52:38] [config] ulr-softmax-temperature: 1
[2023-07-18 12:52:38] [config] ulr-trainable-transformation: false
[2023-07-18 12:52:38] [config] unlikelihood-loss: false
[2023-07-18 12:52:38] [config] valid-freq: 50000000
[2023-07-18 12:52:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 12:52:38] [config] valid-max-length: 1000
[2023-07-18 12:52:38] [config] valid-metrics:
[2023-07-18 12:52:38] [config]   - cross-entropy
[2023-07-18 12:52:38] [config]   - translation
[2023-07-18 12:52:38] [config] valid-mini-batch: 32
[2023-07-18 12:52:38] [config] valid-reset-stalled: false
[2023-07-18 12:52:38] [config] valid-script-args:
[2023-07-18 12:52:38] [config]   []
[2023-07-18 12:52:38] [config] valid-script-path: ""
[2023-07-18 12:52:38] [config] valid-sets:
[2023-07-18 12:52:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 12:52:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 12:52:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 12:52:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 12:52:38] [config] vocabs:
[2023-07-18 12:52:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 12:52:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 12:52:38] [config] word-penalty: 0
[2023-07-18 12:52:38] [config] word-scores: false
[2023-07-18 12:52:38] [config] workspace: 5500
[2023-07-18 12:52:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 12:52:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 12:52:38] [training] Using single-device training
[2023-07-18 12:52:39] Synced seed 1234
[2023-07-18 12:52:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 12:52:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 12:52:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 12:52:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 12:52:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 12:52:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 12:52:39] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 12:52:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 12:52:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 12:52:40] [comm] Using global sharding
[2023-07-18 12:52:40] [comm] NCCLCommunicators constructed successfully
[2023-07-18 12:52:40] [training] Using 1 GPUs
[2023-07-18 12:52:40] [logits] Applying loss function for 1 factor(s)
[2023-07-18 12:52:40] [memory] Reserving 80 MB, device gpu0
[2023-07-18 12:52:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 12:52:40] [memory] Reserving 80 MB, device gpu0
[2023-07-18 13:18:15] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 13:18:15] [valid] No post-processing script given for validating translator
[2023-07-18 13:18:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 13:18:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 13:18:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 13:18:15] [comm] Using global sharding
[2023-07-18 13:18:15] [comm] NCCLCommunicators constructed successfully
[2023-07-18 13:18:15] [training] Using 1 GPUs
[2023-07-18 13:18:15] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 13:18:18] Allocating memory for general optimizer shards
[2023-07-18 13:18:18] [memory] Reserving 322 MB, device gpu0
[2023-07-18 13:18:18] Loading Adam parameters
[2023-07-18 13:18:18] [memory] Reserving 322 MB, device gpu0
[2023-07-18 13:18:18] [memory] Reserving 80 MB, device gpu0
[2023-07-18 13:18:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 13:18:19] [data] Restoring the corpus state to epoch 51, batch 1908
[2023-07-18 13:18:19] [data] Shuffling data
[2023-07-18 13:18:19] [data] Done reading 20,192 sentences
[2023-07-18 13:18:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:18:19] Training started
[2023-07-18 13:18:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 13:18:19] [memory] Reserving 80 MB, device gpu0
[2023-07-18 13:18:27] Parameter type float16, optimization type float32, casting types true
[2023-07-18 13:22:44] Seen 20,192 samples
[2023-07-18 13:22:44] Starting data epoch 52 in logical epoch 52
[2023-07-18 13:22:44] [data] Shuffling data
[2023-07-18 13:22:44] [data] Done reading 20,192 sentences
[2023-07-18 13:22:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:27:14] Seen 20,192 samples
[2023-07-18 13:27:14] Starting data epoch 53 in logical epoch 53
[2023-07-18 13:27:14] [data] Shuffling data
[2023-07-18 13:27:14] [data] Done reading 20,192 sentences
[2023-07-18 13:27:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:29:05] Ep. 53 : Up. 2000 : Sen. 9,789 : Cost 4.94885349 * 16,270,132 @ 1,153 after 32,509,322 : Time 650.89s : 24996.75 words/s : gNorm 0.8552
[2023-07-18 13:31:41] Seen 20,192 samples
[2023-07-18 13:31:41] Starting data epoch 54 in logical epoch 54
[2023-07-18 13:31:41] [data] Shuffling data
[2023-07-18 13:31:41] [data] Done reading 20,192 sentences
[2023-07-18 13:31:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:36:09] Seen 20,192 samples
[2023-07-18 13:36:09] Starting data epoch 55 in logical epoch 55
[2023-07-18 13:36:09] [data] Shuffling data
[2023-07-18 13:36:09] [data] Done reading 20,192 sentences
[2023-07-18 13:36:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:40:37] Seen 20,192 samples
[2023-07-18 13:40:37] Starting data epoch 56 in logical epoch 56
[2023-07-18 13:40:37] [data] Shuffling data
[2023-07-18 13:40:37] [data] Done reading 20,192 sentences
[2023-07-18 13:40:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:45:04] Seen 20,192 samples
[2023-07-18 13:45:04] Starting data epoch 57 in logical epoch 57
[2023-07-18 13:45:04] [data] Shuffling data
[2023-07-18 13:45:04] [data] Done reading 20,192 sentences
[2023-07-18 13:45:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:49:36] Seen 20,192 samples
[2023-07-18 13:49:36] Starting data epoch 58 in logical epoch 58
[2023-07-18 13:49:36] [data] Shuffling data
[2023-07-18 13:49:36] [data] Done reading 20,192 sentences
[2023-07-18 13:49:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:54:06] Seen 20,192 samples
[2023-07-18 13:54:06] Starting data epoch 59 in logical epoch 59
[2023-07-18 13:54:06] [data] Shuffling data
[2023-07-18 13:54:06] [data] Done reading 20,192 sentences
[2023-07-18 13:54:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 13:58:39] Seen 20,192 samples
[2023-07-18 13:58:39] Starting data epoch 60 in logical epoch 60
[2023-07-18 13:58:39] [data] Shuffling data
[2023-07-18 13:58:39] [data] Done reading 20,192 sentences
[2023-07-18 13:58:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 14:03:05] Seen 20,192 samples
[2023-07-18 14:03:05] Starting data epoch 61 in logical epoch 61
[2023-07-18 14:03:05] Training finished
[2023-07-18 14:03:15] [valid] Ep. 61 : Up. 2287 : cross-entropy : 141.009 : new best
[2023-07-18 14:05:25] [valid] Ep. 61 : Up. 2287 : translation : 0 : new best
[2023-07-18 14:05:25] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 14:05:28] Saving Adam parameters
[2023-07-18 14:05:28] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 14:05:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 14:05:36] [marian] Running on node22.datos.cluster.uy as process 21819 with command line:
[2023-07-18 14:05:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 14:05:36] [config] after: 0e
[2023-07-18 14:05:36] [config] after-batches: 0
[2023-07-18 14:05:36] [config] after-epochs: 70
[2023-07-18 14:05:36] [config] all-caps-every: 0
[2023-07-18 14:05:36] [config] allow-unk: false
[2023-07-18 14:05:36] [config] authors: false
[2023-07-18 14:05:36] [config] beam-size: 12
[2023-07-18 14:05:36] [config] bert-class-symbol: "[CLS]"
[2023-07-18 14:05:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 14:05:36] [config] bert-masking-fraction: 0.15
[2023-07-18 14:05:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 14:05:36] [config] bert-train-type-embeddings: true
[2023-07-18 14:05:36] [config] bert-type-vocab-size: 2
[2023-07-18 14:05:36] [config] build-info: ""
[2023-07-18 14:05:36] [config] check-gradient-nan: false
[2023-07-18 14:05:36] [config] check-nan: false
[2023-07-18 14:05:36] [config] cite: false
[2023-07-18 14:05:36] [config] clip-norm: 1
[2023-07-18 14:05:36] [config] cost-scaling:
[2023-07-18 14:05:36] [config]   - 256.f
[2023-07-18 14:05:36] [config]   - 1000
[2023-07-18 14:05:36] [config]   - 2.f
[2023-07-18 14:05:36] [config]   - 256.f
[2023-07-18 14:05:36] [config] cost-type: ce-sum
[2023-07-18 14:05:36] [config] cpu-threads: 0
[2023-07-18 14:05:36] [config] data-threads: 8
[2023-07-18 14:05:36] [config] data-weighting: ""
[2023-07-18 14:05:36] [config] data-weighting-type: sentence
[2023-07-18 14:05:36] [config] dec-cell: gru
[2023-07-18 14:05:36] [config] dec-cell-base-depth: 2
[2023-07-18 14:05:36] [config] dec-cell-high-depth: 1
[2023-07-18 14:05:36] [config] dec-depth: 1
[2023-07-18 14:05:36] [config] devices:
[2023-07-18 14:05:36] [config]   - 0
[2023-07-18 14:05:36] [config] dim-emb: 512
[2023-07-18 14:05:36] [config] dim-rnn: 1024
[2023-07-18 14:05:36] [config] dim-vocabs:
[2023-07-18 14:05:36] [config]   - 16384
[2023-07-18 14:05:36] [config]   - 16384
[2023-07-18 14:05:36] [config] disp-first: 0
[2023-07-18 14:05:36] [config] disp-freq: 1000u
[2023-07-18 14:05:36] [config] disp-label-counts: true
[2023-07-18 14:05:36] [config] dropout-rnn: 0
[2023-07-18 14:05:36] [config] dropout-src: 0
[2023-07-18 14:05:36] [config] dropout-trg: 0
[2023-07-18 14:05:36] [config] dump-config: ""
[2023-07-18 14:05:36] [config] dynamic-gradient-scaling:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] early-stopping: 200
[2023-07-18 14:05:36] [config] early-stopping-on: first
[2023-07-18 14:05:36] [config] embedding-fix-src: false
[2023-07-18 14:05:36] [config] embedding-fix-trg: false
[2023-07-18 14:05:36] [config] embedding-normalization: false
[2023-07-18 14:05:36] [config] embedding-vectors:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] enc-cell: gru
[2023-07-18 14:05:36] [config] enc-cell-depth: 1
[2023-07-18 14:05:36] [config] enc-depth: 1
[2023-07-18 14:05:36] [config] enc-type: bidirectional
[2023-07-18 14:05:36] [config] english-title-case-every: 0
[2023-07-18 14:05:36] [config] exponential-smoothing: 0
[2023-07-18 14:05:36] [config] factor-weight: 1
[2023-07-18 14:05:36] [config] factors-combine: sum
[2023-07-18 14:05:36] [config] factors-dim-emb: 0
[2023-07-18 14:05:36] [config] gradient-checkpointing: false
[2023-07-18 14:05:36] [config] gradient-norm-average-window: 100
[2023-07-18 14:05:36] [config] guided-alignment: none
[2023-07-18 14:05:36] [config] guided-alignment-cost: mse
[2023-07-18 14:05:36] [config] guided-alignment-weight: 0.1
[2023-07-18 14:05:36] [config] ignore-model-config: false
[2023-07-18 14:05:36] [config] input-types:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] interpolate-env-vars: false
[2023-07-18 14:05:36] [config] keep-best: false
[2023-07-18 14:05:36] [config] label-smoothing: 0
[2023-07-18 14:05:36] [config] layer-normalization: false
[2023-07-18 14:05:36] [config] learn-rate: 0.0001
[2023-07-18 14:05:36] [config] lemma-dependency: ""
[2023-07-18 14:05:36] [config] lemma-dim-emb: 0
[2023-07-18 14:05:36] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 14:05:36] [config] log-level: info
[2023-07-18 14:05:36] [config] log-time-zone: ""
[2023-07-18 14:05:36] [config] logical-epoch:
[2023-07-18 14:05:36] [config]   - 1e
[2023-07-18 14:05:36] [config]   - 0
[2023-07-18 14:05:36] [config] lr-decay: 0
[2023-07-18 14:05:36] [config] lr-decay-freq: 50000
[2023-07-18 14:05:36] [config] lr-decay-inv-sqrt:
[2023-07-18 14:05:36] [config]   - 0
[2023-07-18 14:05:36] [config] lr-decay-repeat-warmup: false
[2023-07-18 14:05:36] [config] lr-decay-reset-optimizer: false
[2023-07-18 14:05:36] [config] lr-decay-start:
[2023-07-18 14:05:36] [config]   - 10
[2023-07-18 14:05:36] [config]   - 1
[2023-07-18 14:05:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 14:05:36] [config] lr-report: false
[2023-07-18 14:05:36] [config] lr-warmup: 0
[2023-07-18 14:05:36] [config] lr-warmup-at-reload: false
[2023-07-18 14:05:36] [config] lr-warmup-cycle: false
[2023-07-18 14:05:36] [config] lr-warmup-start-rate: 0
[2023-07-18 14:05:36] [config] max-length: 150
[2023-07-18 14:05:36] [config] max-length-crop: true
[2023-07-18 14:05:36] [config] max-length-factor: 3
[2023-07-18 14:05:36] [config] maxi-batch: 100
[2023-07-18 14:05:36] [config] maxi-batch-sort: trg
[2023-07-18 14:05:36] [config] mini-batch: 64
[2023-07-18 14:05:36] [config] mini-batch-fit: true
[2023-07-18 14:05:36] [config] mini-batch-fit-step: 10
[2023-07-18 14:05:36] [config] mini-batch-round-up: true
[2023-07-18 14:05:36] [config] mini-batch-track-lr: false
[2023-07-18 14:05:36] [config] mini-batch-warmup: 0
[2023-07-18 14:05:36] [config] mini-batch-words: 0
[2023-07-18 14:05:36] [config] mini-batch-words-ref: 0
[2023-07-18 14:05:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 14:05:36] [config] multi-loss-type: sum
[2023-07-18 14:05:36] [config] n-best: false
[2023-07-18 14:05:36] [config] no-nccl: false
[2023-07-18 14:05:36] [config] no-reload: false
[2023-07-18 14:05:36] [config] no-restore-corpus: false
[2023-07-18 14:05:36] [config] normalize: 0
[2023-07-18 14:05:36] [config] normalize-gradient: false
[2023-07-18 14:05:36] [config] num-devices: 0
[2023-07-18 14:05:36] [config] optimizer: adam
[2023-07-18 14:05:36] [config] optimizer-delay: 1
[2023-07-18 14:05:36] [config] optimizer-params:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] output-omit-bias: false
[2023-07-18 14:05:36] [config] overwrite: true
[2023-07-18 14:05:36] [config] precision:
[2023-07-18 14:05:36] [config]   - float16
[2023-07-18 14:05:36] [config]   - float32
[2023-07-18 14:05:36] [config] pretrained-model: ""
[2023-07-18 14:05:36] [config] quantize-biases: false
[2023-07-18 14:05:36] [config] quantize-bits: 0
[2023-07-18 14:05:36] [config] quantize-log-based: false
[2023-07-18 14:05:36] [config] quantize-optimization-steps: 0
[2023-07-18 14:05:36] [config] quiet: false
[2023-07-18 14:05:36] [config] quiet-translation: true
[2023-07-18 14:05:36] [config] relative-paths: false
[2023-07-18 14:05:36] [config] right-left: false
[2023-07-18 14:05:36] [config] save-freq: 10000u
[2023-07-18 14:05:36] [config] seed: 1234
[2023-07-18 14:05:36] [config] sentencepiece-alphas:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] sentencepiece-max-lines: 2000000
[2023-07-18 14:05:36] [config] sentencepiece-options: ""
[2023-07-18 14:05:36] [config] sharding: global
[2023-07-18 14:05:36] [config] shuffle: data
[2023-07-18 14:05:36] [config] shuffle-in-ram: false
[2023-07-18 14:05:36] [config] sigterm: save-and-exit
[2023-07-18 14:05:36] [config] skip: false
[2023-07-18 14:05:36] [config] sqlite: ""
[2023-07-18 14:05:36] [config] sqlite-drop: false
[2023-07-18 14:05:36] [config] sync-freq: 200u
[2023-07-18 14:05:36] [config] sync-sgd: false
[2023-07-18 14:05:36] [config] tempdir: /tmp
[2023-07-18 14:05:36] [config] tied-embeddings: false
[2023-07-18 14:05:36] [config] tied-embeddings-all: true
[2023-07-18 14:05:36] [config] tied-embeddings-src: false
[2023-07-18 14:05:36] [config] train-embedder-rank:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] train-sets:
[2023-07-18 14:05:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 14:05:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 14:05:36] [config] transformer-aan-activation: swish
[2023-07-18 14:05:36] [config] transformer-aan-depth: 2
[2023-07-18 14:05:36] [config] transformer-aan-nogate: false
[2023-07-18 14:05:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 14:05:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 14:05:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 14:05:36] [config] transformer-depth-scaling: false
[2023-07-18 14:05:36] [config] transformer-dim-aan: 2048
[2023-07-18 14:05:36] [config] transformer-dim-ffn: 2048
[2023-07-18 14:05:36] [config] transformer-dropout: 0
[2023-07-18 14:05:36] [config] transformer-dropout-attention: 0
[2023-07-18 14:05:36] [config] transformer-dropout-ffn: 0
[2023-07-18 14:05:36] [config] transformer-ffn-activation: swish
[2023-07-18 14:05:36] [config] transformer-ffn-depth: 2
[2023-07-18 14:05:36] [config] transformer-guided-alignment-layer: last
[2023-07-18 14:05:36] [config] transformer-heads: 8
[2023-07-18 14:05:36] [config] transformer-no-projection: false
[2023-07-18 14:05:36] [config] transformer-pool: false
[2023-07-18 14:05:36] [config] transformer-postprocess: dan
[2023-07-18 14:05:36] [config] transformer-postprocess-emb: d
[2023-07-18 14:05:36] [config] transformer-postprocess-top: ""
[2023-07-18 14:05:36] [config] transformer-preprocess: ""
[2023-07-18 14:05:36] [config] transformer-tied-layers:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] transformer-train-position-embeddings: false
[2023-07-18 14:05:36] [config] tsv: false
[2023-07-18 14:05:36] [config] tsv-fields: 0
[2023-07-18 14:05:36] [config] type: amun
[2023-07-18 14:05:36] [config] ulr: false
[2023-07-18 14:05:36] [config] ulr-dim-emb: 0
[2023-07-18 14:05:36] [config] ulr-dropout: 0
[2023-07-18 14:05:36] [config] ulr-keys-vectors: ""
[2023-07-18 14:05:36] [config] ulr-query-vectors: ""
[2023-07-18 14:05:36] [config] ulr-softmax-temperature: 1
[2023-07-18 14:05:36] [config] ulr-trainable-transformation: false
[2023-07-18 14:05:36] [config] unlikelihood-loss: false
[2023-07-18 14:05:36] [config] valid-freq: 50000000
[2023-07-18 14:05:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 14:05:36] [config] valid-max-length: 1000
[2023-07-18 14:05:36] [config] valid-metrics:
[2023-07-18 14:05:36] [config]   - cross-entropy
[2023-07-18 14:05:36] [config]   - translation
[2023-07-18 14:05:36] [config] valid-mini-batch: 32
[2023-07-18 14:05:36] [config] valid-reset-stalled: false
[2023-07-18 14:05:36] [config] valid-script-args:
[2023-07-18 14:05:36] [config]   []
[2023-07-18 14:05:36] [config] valid-script-path: ""
[2023-07-18 14:05:36] [config] valid-sets:
[2023-07-18 14:05:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 14:05:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 14:05:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 14:05:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 14:05:36] [config] vocabs:
[2023-07-18 14:05:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 14:05:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 14:05:36] [config] word-penalty: 0
[2023-07-18 14:05:36] [config] word-scores: false
[2023-07-18 14:05:36] [config] workspace: 5500
[2023-07-18 14:05:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 14:05:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 14:05:36] [training] Using single-device training
[2023-07-18 14:05:36] Synced seed 1234
[2023-07-18 14:05:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 14:05:36] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 14:05:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 14:05:36] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 14:05:36] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 14:05:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 14:05:36] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 14:05:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 14:05:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 14:05:37] [comm] Using global sharding
[2023-07-18 14:05:38] [comm] NCCLCommunicators constructed successfully
[2023-07-18 14:05:38] [training] Using 1 GPUs
[2023-07-18 14:05:38] [logits] Applying loss function for 1 factor(s)
[2023-07-18 14:05:38] [memory] Reserving 80 MB, device gpu0
[2023-07-18 14:05:38] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 14:05:38] [memory] Reserving 80 MB, device gpu0
[2023-07-18 14:31:20] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 14:31:20] [valid] No post-processing script given for validating translator
[2023-07-18 14:31:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 14:31:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 14:31:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 14:31:20] [comm] Using global sharding
[2023-07-18 14:31:20] [comm] NCCLCommunicators constructed successfully
[2023-07-18 14:31:20] [training] Using 1 GPUs
[2023-07-18 14:31:20] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 14:31:22] Allocating memory for general optimizer shards
[2023-07-18 14:31:22] [memory] Reserving 322 MB, device gpu0
[2023-07-18 14:31:22] Loading Adam parameters
[2023-07-18 14:31:22] [memory] Reserving 322 MB, device gpu0
[2023-07-18 14:31:22] [memory] Reserving 80 MB, device gpu0
[2023-07-18 14:31:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 14:31:23] [data] Restoring the corpus state to epoch 61, batch 2287
[2023-07-18 14:31:23] [data] Shuffling data
[2023-07-18 14:31:23] [data] Done reading 20,192 sentences
[2023-07-18 14:31:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 14:31:23] Training started
[2023-07-18 14:31:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 14:31:23] [memory] Reserving 80 MB, device gpu0
[2023-07-18 14:31:26] Parameter type float16, optimization type float32, casting types true
[2023-07-18 14:35:54] Seen 20,192 samples
[2023-07-18 14:35:54] Starting data epoch 62 in logical epoch 62
[2023-07-18 14:35:54] [data] Shuffling data
[2023-07-18 14:35:54] [data] Done reading 20,192 sentences
[2023-07-18 14:35:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 14:40:23] Seen 20,192 samples
[2023-07-18 14:40:23] Starting data epoch 63 in logical epoch 63
[2023-07-18 14:40:23] [data] Shuffling data
[2023-07-18 14:40:23] [data] Done reading 20,192 sentences
[2023-07-18 14:40:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 14:44:35] Seen 20,192 samples
[2023-07-18 14:44:35] Starting data epoch 64 in logical epoch 64
[2023-07-18 14:44:35] [data] Shuffling data
[2023-07-18 14:44:35] [data] Done reading 20,192 sentences
[2023-07-18 14:44:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 14:49:07] Seen 20,192 samples
[2023-07-18 14:49:07] Starting data epoch 65 in logical epoch 65
[2023-07-18 14:49:07] [data] Shuffling data
[2023-07-18 14:49:07] [data] Done reading 20,192 sentences
[2023-07-18 14:49:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 14:53:21] Seen 20,192 samples
[2023-07-18 14:53:21] Starting data epoch 66 in logical epoch 66
[2023-07-18 14:53:21] [data] Shuffling data
[2023-07-18 14:53:21] [data] Done reading 20,192 sentences
[2023-07-18 14:53:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 14:57:46] Seen 20,192 samples
[2023-07-18 14:57:46] Starting data epoch 67 in logical epoch 67
[2023-07-18 14:57:46] [data] Shuffling data
[2023-07-18 14:57:46] [data] Done reading 20,192 sentences
[2023-07-18 14:57:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 15:02:10] Seen 20,192 samples
[2023-07-18 15:02:10] Starting data epoch 68 in logical epoch 68
[2023-07-18 15:02:10] [data] Shuffling data
[2023-07-18 15:02:10] [data] Done reading 20,192 sentences
[2023-07-18 15:02:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 15:06:42] Seen 20,192 samples
[2023-07-18 15:06:42] Starting data epoch 69 in logical epoch 69
[2023-07-18 15:06:42] [data] Shuffling data
[2023-07-18 15:06:42] [data] Done reading 20,192 sentences
[2023-07-18 15:06:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 15:11:01] Seen 20,192 samples
[2023-07-18 15:11:01] Starting data epoch 70 in logical epoch 70
[2023-07-18 15:11:01] [data] Shuffling data
[2023-07-18 15:11:01] [data] Done reading 20,192 sentences
[2023-07-18 15:11:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 15:15:31] Seen 20,192 samples
[2023-07-18 15:15:31] Starting data epoch 71 in logical epoch 71
[2023-07-18 15:15:31] Training finished
[2023-07-18 15:15:42] [valid] Ep. 71 : Up. 2669 : cross-entropy : 138.64 : new best
[2023-07-18 15:17:40] [valid] Ep. 71 : Up. 2669 : translation : 0 : new best
[2023-07-18 15:17:40] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 15:17:42] Saving Adam parameters
[2023-07-18 15:17:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 15:17:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 15:17:51] [marian] Running on node22.datos.cluster.uy as process 26331 with command line:
[2023-07-18 15:17:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 15:17:51] [config] after: 0e
[2023-07-18 15:17:51] [config] after-batches: 0
[2023-07-18 15:17:51] [config] after-epochs: 80
[2023-07-18 15:17:51] [config] all-caps-every: 0
[2023-07-18 15:17:51] [config] allow-unk: false
[2023-07-18 15:17:51] [config] authors: false
[2023-07-18 15:17:51] [config] beam-size: 12
[2023-07-18 15:17:51] [config] bert-class-symbol: "[CLS]"
[2023-07-18 15:17:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 15:17:51] [config] bert-masking-fraction: 0.15
[2023-07-18 15:17:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 15:17:51] [config] bert-train-type-embeddings: true
[2023-07-18 15:17:51] [config] bert-type-vocab-size: 2
[2023-07-18 15:17:51] [config] build-info: ""
[2023-07-18 15:17:51] [config] check-gradient-nan: false
[2023-07-18 15:17:51] [config] check-nan: false
[2023-07-18 15:17:51] [config] cite: false
[2023-07-18 15:17:51] [config] clip-norm: 1
[2023-07-18 15:17:51] [config] cost-scaling:
[2023-07-18 15:17:51] [config]   - 256.f
[2023-07-18 15:17:51] [config]   - 1000
[2023-07-18 15:17:51] [config]   - 2.f
[2023-07-18 15:17:51] [config]   - 256.f
[2023-07-18 15:17:51] [config] cost-type: ce-sum
[2023-07-18 15:17:51] [config] cpu-threads: 0
[2023-07-18 15:17:51] [config] data-threads: 8
[2023-07-18 15:17:51] [config] data-weighting: ""
[2023-07-18 15:17:51] [config] data-weighting-type: sentence
[2023-07-18 15:17:51] [config] dec-cell: gru
[2023-07-18 15:17:51] [config] dec-cell-base-depth: 2
[2023-07-18 15:17:51] [config] dec-cell-high-depth: 1
[2023-07-18 15:17:51] [config] dec-depth: 1
[2023-07-18 15:17:51] [config] devices:
[2023-07-18 15:17:51] [config]   - 0
[2023-07-18 15:17:51] [config] dim-emb: 512
[2023-07-18 15:17:51] [config] dim-rnn: 1024
[2023-07-18 15:17:51] [config] dim-vocabs:
[2023-07-18 15:17:51] [config]   - 16384
[2023-07-18 15:17:51] [config]   - 16384
[2023-07-18 15:17:51] [config] disp-first: 0
[2023-07-18 15:17:51] [config] disp-freq: 1000u
[2023-07-18 15:17:51] [config] disp-label-counts: true
[2023-07-18 15:17:51] [config] dropout-rnn: 0
[2023-07-18 15:17:51] [config] dropout-src: 0
[2023-07-18 15:17:51] [config] dropout-trg: 0
[2023-07-18 15:17:51] [config] dump-config: ""
[2023-07-18 15:17:51] [config] dynamic-gradient-scaling:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] early-stopping: 200
[2023-07-18 15:17:51] [config] early-stopping-on: first
[2023-07-18 15:17:51] [config] embedding-fix-src: false
[2023-07-18 15:17:51] [config] embedding-fix-trg: false
[2023-07-18 15:17:51] [config] embedding-normalization: false
[2023-07-18 15:17:51] [config] embedding-vectors:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] enc-cell: gru
[2023-07-18 15:17:51] [config] enc-cell-depth: 1
[2023-07-18 15:17:51] [config] enc-depth: 1
[2023-07-18 15:17:51] [config] enc-type: bidirectional
[2023-07-18 15:17:51] [config] english-title-case-every: 0
[2023-07-18 15:17:51] [config] exponential-smoothing: 0
[2023-07-18 15:17:51] [config] factor-weight: 1
[2023-07-18 15:17:51] [config] factors-combine: sum
[2023-07-18 15:17:51] [config] factors-dim-emb: 0
[2023-07-18 15:17:51] [config] gradient-checkpointing: false
[2023-07-18 15:17:51] [config] gradient-norm-average-window: 100
[2023-07-18 15:17:51] [config] guided-alignment: none
[2023-07-18 15:17:51] [config] guided-alignment-cost: mse
[2023-07-18 15:17:51] [config] guided-alignment-weight: 0.1
[2023-07-18 15:17:51] [config] ignore-model-config: false
[2023-07-18 15:17:51] [config] input-types:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] interpolate-env-vars: false
[2023-07-18 15:17:51] [config] keep-best: false
[2023-07-18 15:17:51] [config] label-smoothing: 0
[2023-07-18 15:17:51] [config] layer-normalization: false
[2023-07-18 15:17:51] [config] learn-rate: 0.0001
[2023-07-18 15:17:51] [config] lemma-dependency: ""
[2023-07-18 15:17:51] [config] lemma-dim-emb: 0
[2023-07-18 15:17:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 15:17:51] [config] log-level: info
[2023-07-18 15:17:51] [config] log-time-zone: ""
[2023-07-18 15:17:51] [config] logical-epoch:
[2023-07-18 15:17:51] [config]   - 1e
[2023-07-18 15:17:51] [config]   - 0
[2023-07-18 15:17:51] [config] lr-decay: 0
[2023-07-18 15:17:51] [config] lr-decay-freq: 50000
[2023-07-18 15:17:51] [config] lr-decay-inv-sqrt:
[2023-07-18 15:17:51] [config]   - 0
[2023-07-18 15:17:51] [config] lr-decay-repeat-warmup: false
[2023-07-18 15:17:51] [config] lr-decay-reset-optimizer: false
[2023-07-18 15:17:51] [config] lr-decay-start:
[2023-07-18 15:17:51] [config]   - 10
[2023-07-18 15:17:51] [config]   - 1
[2023-07-18 15:17:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 15:17:51] [config] lr-report: false
[2023-07-18 15:17:51] [config] lr-warmup: 0
[2023-07-18 15:17:51] [config] lr-warmup-at-reload: false
[2023-07-18 15:17:51] [config] lr-warmup-cycle: false
[2023-07-18 15:17:51] [config] lr-warmup-start-rate: 0
[2023-07-18 15:17:51] [config] max-length: 150
[2023-07-18 15:17:51] [config] max-length-crop: true
[2023-07-18 15:17:51] [config] max-length-factor: 3
[2023-07-18 15:17:51] [config] maxi-batch: 100
[2023-07-18 15:17:51] [config] maxi-batch-sort: trg
[2023-07-18 15:17:51] [config] mini-batch: 64
[2023-07-18 15:17:51] [config] mini-batch-fit: true
[2023-07-18 15:17:51] [config] mini-batch-fit-step: 10
[2023-07-18 15:17:51] [config] mini-batch-round-up: true
[2023-07-18 15:17:51] [config] mini-batch-track-lr: false
[2023-07-18 15:17:51] [config] mini-batch-warmup: 0
[2023-07-18 15:17:51] [config] mini-batch-words: 0
[2023-07-18 15:17:51] [config] mini-batch-words-ref: 0
[2023-07-18 15:17:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 15:17:51] [config] multi-loss-type: sum
[2023-07-18 15:17:51] [config] n-best: false
[2023-07-18 15:17:51] [config] no-nccl: false
[2023-07-18 15:17:51] [config] no-reload: false
[2023-07-18 15:17:51] [config] no-restore-corpus: false
[2023-07-18 15:17:51] [config] normalize: 0
[2023-07-18 15:17:51] [config] normalize-gradient: false
[2023-07-18 15:17:51] [config] num-devices: 0
[2023-07-18 15:17:51] [config] optimizer: adam
[2023-07-18 15:17:51] [config] optimizer-delay: 1
[2023-07-18 15:17:51] [config] optimizer-params:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] output-omit-bias: false
[2023-07-18 15:17:51] [config] overwrite: true
[2023-07-18 15:17:51] [config] precision:
[2023-07-18 15:17:51] [config]   - float16
[2023-07-18 15:17:51] [config]   - float32
[2023-07-18 15:17:51] [config] pretrained-model: ""
[2023-07-18 15:17:51] [config] quantize-biases: false
[2023-07-18 15:17:51] [config] quantize-bits: 0
[2023-07-18 15:17:51] [config] quantize-log-based: false
[2023-07-18 15:17:51] [config] quantize-optimization-steps: 0
[2023-07-18 15:17:51] [config] quiet: false
[2023-07-18 15:17:51] [config] quiet-translation: true
[2023-07-18 15:17:51] [config] relative-paths: false
[2023-07-18 15:17:51] [config] right-left: false
[2023-07-18 15:17:51] [config] save-freq: 10000u
[2023-07-18 15:17:51] [config] seed: 1234
[2023-07-18 15:17:51] [config] sentencepiece-alphas:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] sentencepiece-max-lines: 2000000
[2023-07-18 15:17:51] [config] sentencepiece-options: ""
[2023-07-18 15:17:51] [config] sharding: global
[2023-07-18 15:17:51] [config] shuffle: data
[2023-07-18 15:17:51] [config] shuffle-in-ram: false
[2023-07-18 15:17:51] [config] sigterm: save-and-exit
[2023-07-18 15:17:51] [config] skip: false
[2023-07-18 15:17:51] [config] sqlite: ""
[2023-07-18 15:17:51] [config] sqlite-drop: false
[2023-07-18 15:17:51] [config] sync-freq: 200u
[2023-07-18 15:17:51] [config] sync-sgd: false
[2023-07-18 15:17:51] [config] tempdir: /tmp
[2023-07-18 15:17:51] [config] tied-embeddings: false
[2023-07-18 15:17:51] [config] tied-embeddings-all: true
[2023-07-18 15:17:51] [config] tied-embeddings-src: false
[2023-07-18 15:17:51] [config] train-embedder-rank:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] train-sets:
[2023-07-18 15:17:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 15:17:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 15:17:51] [config] transformer-aan-activation: swish
[2023-07-18 15:17:51] [config] transformer-aan-depth: 2
[2023-07-18 15:17:51] [config] transformer-aan-nogate: false
[2023-07-18 15:17:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 15:17:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 15:17:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 15:17:51] [config] transformer-depth-scaling: false
[2023-07-18 15:17:51] [config] transformer-dim-aan: 2048
[2023-07-18 15:17:51] [config] transformer-dim-ffn: 2048
[2023-07-18 15:17:51] [config] transformer-dropout: 0
[2023-07-18 15:17:51] [config] transformer-dropout-attention: 0
[2023-07-18 15:17:51] [config] transformer-dropout-ffn: 0
[2023-07-18 15:17:51] [config] transformer-ffn-activation: swish
[2023-07-18 15:17:51] [config] transformer-ffn-depth: 2
[2023-07-18 15:17:51] [config] transformer-guided-alignment-layer: last
[2023-07-18 15:17:51] [config] transformer-heads: 8
[2023-07-18 15:17:51] [config] transformer-no-projection: false
[2023-07-18 15:17:51] [config] transformer-pool: false
[2023-07-18 15:17:51] [config] transformer-postprocess: dan
[2023-07-18 15:17:51] [config] transformer-postprocess-emb: d
[2023-07-18 15:17:51] [config] transformer-postprocess-top: ""
[2023-07-18 15:17:51] [config] transformer-preprocess: ""
[2023-07-18 15:17:51] [config] transformer-tied-layers:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] transformer-train-position-embeddings: false
[2023-07-18 15:17:51] [config] tsv: false
[2023-07-18 15:17:51] [config] tsv-fields: 0
[2023-07-18 15:17:51] [config] type: amun
[2023-07-18 15:17:51] [config] ulr: false
[2023-07-18 15:17:51] [config] ulr-dim-emb: 0
[2023-07-18 15:17:51] [config] ulr-dropout: 0
[2023-07-18 15:17:51] [config] ulr-keys-vectors: ""
[2023-07-18 15:17:51] [config] ulr-query-vectors: ""
[2023-07-18 15:17:51] [config] ulr-softmax-temperature: 1
[2023-07-18 15:17:51] [config] ulr-trainable-transformation: false
[2023-07-18 15:17:51] [config] unlikelihood-loss: false
[2023-07-18 15:17:51] [config] valid-freq: 50000000
[2023-07-18 15:17:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 15:17:51] [config] valid-max-length: 1000
[2023-07-18 15:17:51] [config] valid-metrics:
[2023-07-18 15:17:51] [config]   - cross-entropy
[2023-07-18 15:17:51] [config]   - translation
[2023-07-18 15:17:51] [config] valid-mini-batch: 32
[2023-07-18 15:17:51] [config] valid-reset-stalled: false
[2023-07-18 15:17:51] [config] valid-script-args:
[2023-07-18 15:17:51] [config]   []
[2023-07-18 15:17:51] [config] valid-script-path: ""
[2023-07-18 15:17:51] [config] valid-sets:
[2023-07-18 15:17:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 15:17:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 15:17:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 15:17:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 15:17:51] [config] vocabs:
[2023-07-18 15:17:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 15:17:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 15:17:51] [config] word-penalty: 0
[2023-07-18 15:17:51] [config] word-scores: false
[2023-07-18 15:17:51] [config] workspace: 5500
[2023-07-18 15:17:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 15:17:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 15:17:51] [training] Using single-device training
[2023-07-18 15:17:52] Synced seed 1234
[2023-07-18 15:17:52] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 15:17:52] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 15:17:52] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 15:17:52] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 15:17:52] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 15:17:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 15:17:52] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 15:17:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 15:17:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 15:17:53] [comm] Using global sharding
[2023-07-18 15:17:53] [comm] NCCLCommunicators constructed successfully
[2023-07-18 15:17:53] [training] Using 1 GPUs
[2023-07-18 15:17:53] [logits] Applying loss function for 1 factor(s)
[2023-07-18 15:17:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 15:17:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 15:17:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 15:44:01] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 15:44:01] [valid] No post-processing script given for validating translator
[2023-07-18 15:44:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 15:44:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 15:44:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 15:44:01] [comm] Using global sharding
[2023-07-18 15:44:01] [comm] NCCLCommunicators constructed successfully
[2023-07-18 15:44:01] [training] Using 1 GPUs
[2023-07-18 15:44:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 15:44:03] Allocating memory for general optimizer shards
[2023-07-18 15:44:03] [memory] Reserving 322 MB, device gpu0
[2023-07-18 15:44:03] Loading Adam parameters
[2023-07-18 15:44:04] [memory] Reserving 322 MB, device gpu0
[2023-07-18 15:44:04] [memory] Reserving 80 MB, device gpu0
[2023-07-18 15:44:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 15:44:04] [data] Restoring the corpus state to epoch 71, batch 2669
[2023-07-18 15:44:04] [data] Shuffling data
[2023-07-18 15:44:04] [data] Done reading 20,192 sentences
[2023-07-18 15:44:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 15:44:04] Training started
[2023-07-18 15:44:04] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 15:44:05] [memory] Reserving 80 MB, device gpu0
[2023-07-18 15:44:20] Parameter type float16, optimization type float32, casting types true
[2023-07-18 15:48:13] Seen 20,192 samples
[2023-07-18 15:48:13] Starting data epoch 72 in logical epoch 72
[2023-07-18 15:48:13] [data] Shuffling data
[2023-07-18 15:48:13] [data] Done reading 20,192 sentences
[2023-07-18 15:48:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 15:52:32] Seen 20,192 samples
[2023-07-18 15:52:32] Starting data epoch 73 in logical epoch 73
[2023-07-18 15:52:32] [data] Shuffling data
[2023-07-18 15:52:33] [data] Done reading 20,192 sentences
[2023-07-18 15:52:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 15:56:52] Seen 20,192 samples
[2023-07-18 15:56:52] Starting data epoch 74 in logical epoch 74
[2023-07-18 15:56:52] [data] Shuffling data
[2023-07-18 15:56:52] [data] Done reading 20,192 sentences
[2023-07-18 15:56:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:01:11] Seen 20,192 samples
[2023-07-18 16:01:11] Starting data epoch 75 in logical epoch 75
[2023-07-18 16:01:11] [data] Shuffling data
[2023-07-18 16:01:11] [data] Done reading 20,192 sentences
[2023-07-18 16:01:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:05:30] Seen 20,192 samples
[2023-07-18 16:05:30] Starting data epoch 76 in logical epoch 76
[2023-07-18 16:05:30] [data] Shuffling data
[2023-07-18 16:05:30] [data] Done reading 20,192 sentences
[2023-07-18 16:05:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:09:47] Seen 20,192 samples
[2023-07-18 16:09:47] Starting data epoch 77 in logical epoch 77
[2023-07-18 16:09:47] [data] Shuffling data
[2023-07-18 16:09:47] [data] Done reading 20,192 sentences
[2023-07-18 16:09:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:14:08] Seen 20,192 samples
[2023-07-18 16:14:08] Starting data epoch 78 in logical epoch 78
[2023-07-18 16:14:08] [data] Shuffling data
[2023-07-18 16:14:08] [data] Done reading 20,192 sentences
[2023-07-18 16:14:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:18:18] Seen 20,192 samples
[2023-07-18 16:18:18] Starting data epoch 79 in logical epoch 79
[2023-07-18 16:18:18] [data] Shuffling data
[2023-07-18 16:18:18] [data] Done reading 20,192 sentences
[2023-07-18 16:18:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:20:59] Ep. 79 : Up. 3000 : Sen. 14,003 : Cost 4.26508951 * 16,259,238 @ 10,750 after 48,768,558 : Time 2218.45s : 7329.08 words/s : gNorm 1.1483
[2023-07-18 16:22:32] Seen 20,192 samples
[2023-07-18 16:22:32] Starting data epoch 80 in logical epoch 80
[2023-07-18 16:22:32] [data] Shuffling data
[2023-07-18 16:22:32] [data] Done reading 20,192 sentences
[2023-07-18 16:22:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:26:36] Seen 20,192 samples
[2023-07-18 16:26:37] Starting data epoch 81 in logical epoch 81
[2023-07-18 16:26:37] Training finished
[2023-07-18 16:26:46] [valid] Ep. 81 : Up. 3053 : cross-entropy : 135.193 : new best
[2023-07-18 16:29:00] [valid] Ep. 81 : Up. 3053 : translation : 0 : new best
[2023-07-18 16:29:00] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 16:29:02] Saving Adam parameters
[2023-07-18 16:29:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 16:29:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 16:29:10] [marian] Running on node22.datos.cluster.uy as process 31096 with command line:
[2023-07-18 16:29:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 16:29:10] [config] after: 0e
[2023-07-18 16:29:10] [config] after-batches: 0
[2023-07-18 16:29:10] [config] after-epochs: 90
[2023-07-18 16:29:10] [config] all-caps-every: 0
[2023-07-18 16:29:10] [config] allow-unk: false
[2023-07-18 16:29:10] [config] authors: false
[2023-07-18 16:29:10] [config] beam-size: 12
[2023-07-18 16:29:10] [config] bert-class-symbol: "[CLS]"
[2023-07-18 16:29:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 16:29:10] [config] bert-masking-fraction: 0.15
[2023-07-18 16:29:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 16:29:10] [config] bert-train-type-embeddings: true
[2023-07-18 16:29:10] [config] bert-type-vocab-size: 2
[2023-07-18 16:29:10] [config] build-info: ""
[2023-07-18 16:29:10] [config] check-gradient-nan: false
[2023-07-18 16:29:10] [config] check-nan: false
[2023-07-18 16:29:10] [config] cite: false
[2023-07-18 16:29:10] [config] clip-norm: 1
[2023-07-18 16:29:10] [config] cost-scaling:
[2023-07-18 16:29:10] [config]   - 256.f
[2023-07-18 16:29:10] [config]   - 1000
[2023-07-18 16:29:10] [config]   - 2.f
[2023-07-18 16:29:10] [config]   - 256.f
[2023-07-18 16:29:10] [config] cost-type: ce-sum
[2023-07-18 16:29:10] [config] cpu-threads: 0
[2023-07-18 16:29:10] [config] data-threads: 8
[2023-07-18 16:29:10] [config] data-weighting: ""
[2023-07-18 16:29:10] [config] data-weighting-type: sentence
[2023-07-18 16:29:10] [config] dec-cell: gru
[2023-07-18 16:29:10] [config] dec-cell-base-depth: 2
[2023-07-18 16:29:10] [config] dec-cell-high-depth: 1
[2023-07-18 16:29:10] [config] dec-depth: 1
[2023-07-18 16:29:10] [config] devices:
[2023-07-18 16:29:10] [config]   - 0
[2023-07-18 16:29:10] [config] dim-emb: 512
[2023-07-18 16:29:10] [config] dim-rnn: 1024
[2023-07-18 16:29:10] [config] dim-vocabs:
[2023-07-18 16:29:10] [config]   - 16384
[2023-07-18 16:29:10] [config]   - 16384
[2023-07-18 16:29:10] [config] disp-first: 0
[2023-07-18 16:29:10] [config] disp-freq: 1000u
[2023-07-18 16:29:10] [config] disp-label-counts: true
[2023-07-18 16:29:10] [config] dropout-rnn: 0
[2023-07-18 16:29:10] [config] dropout-src: 0
[2023-07-18 16:29:10] [config] dropout-trg: 0
[2023-07-18 16:29:10] [config] dump-config: ""
[2023-07-18 16:29:10] [config] dynamic-gradient-scaling:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] early-stopping: 200
[2023-07-18 16:29:10] [config] early-stopping-on: first
[2023-07-18 16:29:10] [config] embedding-fix-src: false
[2023-07-18 16:29:10] [config] embedding-fix-trg: false
[2023-07-18 16:29:10] [config] embedding-normalization: false
[2023-07-18 16:29:10] [config] embedding-vectors:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] enc-cell: gru
[2023-07-18 16:29:10] [config] enc-cell-depth: 1
[2023-07-18 16:29:10] [config] enc-depth: 1
[2023-07-18 16:29:10] [config] enc-type: bidirectional
[2023-07-18 16:29:10] [config] english-title-case-every: 0
[2023-07-18 16:29:10] [config] exponential-smoothing: 0
[2023-07-18 16:29:10] [config] factor-weight: 1
[2023-07-18 16:29:10] [config] factors-combine: sum
[2023-07-18 16:29:10] [config] factors-dim-emb: 0
[2023-07-18 16:29:10] [config] gradient-checkpointing: false
[2023-07-18 16:29:10] [config] gradient-norm-average-window: 100
[2023-07-18 16:29:10] [config] guided-alignment: none
[2023-07-18 16:29:10] [config] guided-alignment-cost: mse
[2023-07-18 16:29:10] [config] guided-alignment-weight: 0.1
[2023-07-18 16:29:10] [config] ignore-model-config: false
[2023-07-18 16:29:10] [config] input-types:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] interpolate-env-vars: false
[2023-07-18 16:29:10] [config] keep-best: false
[2023-07-18 16:29:10] [config] label-smoothing: 0
[2023-07-18 16:29:10] [config] layer-normalization: false
[2023-07-18 16:29:10] [config] learn-rate: 0.0001
[2023-07-18 16:29:10] [config] lemma-dependency: ""
[2023-07-18 16:29:10] [config] lemma-dim-emb: 0
[2023-07-18 16:29:10] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 16:29:10] [config] log-level: info
[2023-07-18 16:29:10] [config] log-time-zone: ""
[2023-07-18 16:29:10] [config] logical-epoch:
[2023-07-18 16:29:10] [config]   - 1e
[2023-07-18 16:29:10] [config]   - 0
[2023-07-18 16:29:10] [config] lr-decay: 0
[2023-07-18 16:29:10] [config] lr-decay-freq: 50000
[2023-07-18 16:29:10] [config] lr-decay-inv-sqrt:
[2023-07-18 16:29:10] [config]   - 0
[2023-07-18 16:29:10] [config] lr-decay-repeat-warmup: false
[2023-07-18 16:29:10] [config] lr-decay-reset-optimizer: false
[2023-07-18 16:29:10] [config] lr-decay-start:
[2023-07-18 16:29:10] [config]   - 10
[2023-07-18 16:29:10] [config]   - 1
[2023-07-18 16:29:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 16:29:10] [config] lr-report: false
[2023-07-18 16:29:10] [config] lr-warmup: 0
[2023-07-18 16:29:10] [config] lr-warmup-at-reload: false
[2023-07-18 16:29:10] [config] lr-warmup-cycle: false
[2023-07-18 16:29:10] [config] lr-warmup-start-rate: 0
[2023-07-18 16:29:10] [config] max-length: 150
[2023-07-18 16:29:10] [config] max-length-crop: true
[2023-07-18 16:29:10] [config] max-length-factor: 3
[2023-07-18 16:29:10] [config] maxi-batch: 100
[2023-07-18 16:29:10] [config] maxi-batch-sort: trg
[2023-07-18 16:29:10] [config] mini-batch: 64
[2023-07-18 16:29:10] [config] mini-batch-fit: true
[2023-07-18 16:29:10] [config] mini-batch-fit-step: 10
[2023-07-18 16:29:10] [config] mini-batch-round-up: true
[2023-07-18 16:29:10] [config] mini-batch-track-lr: false
[2023-07-18 16:29:10] [config] mini-batch-warmup: 0
[2023-07-18 16:29:10] [config] mini-batch-words: 0
[2023-07-18 16:29:10] [config] mini-batch-words-ref: 0
[2023-07-18 16:29:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 16:29:10] [config] multi-loss-type: sum
[2023-07-18 16:29:10] [config] n-best: false
[2023-07-18 16:29:10] [config] no-nccl: false
[2023-07-18 16:29:10] [config] no-reload: false
[2023-07-18 16:29:10] [config] no-restore-corpus: false
[2023-07-18 16:29:10] [config] normalize: 0
[2023-07-18 16:29:10] [config] normalize-gradient: false
[2023-07-18 16:29:10] [config] num-devices: 0
[2023-07-18 16:29:10] [config] optimizer: adam
[2023-07-18 16:29:10] [config] optimizer-delay: 1
[2023-07-18 16:29:10] [config] optimizer-params:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] output-omit-bias: false
[2023-07-18 16:29:10] [config] overwrite: true
[2023-07-18 16:29:10] [config] precision:
[2023-07-18 16:29:10] [config]   - float16
[2023-07-18 16:29:10] [config]   - float32
[2023-07-18 16:29:10] [config] pretrained-model: ""
[2023-07-18 16:29:10] [config] quantize-biases: false
[2023-07-18 16:29:10] [config] quantize-bits: 0
[2023-07-18 16:29:10] [config] quantize-log-based: false
[2023-07-18 16:29:10] [config] quantize-optimization-steps: 0
[2023-07-18 16:29:10] [config] quiet: false
[2023-07-18 16:29:10] [config] quiet-translation: true
[2023-07-18 16:29:10] [config] relative-paths: false
[2023-07-18 16:29:10] [config] right-left: false
[2023-07-18 16:29:10] [config] save-freq: 10000u
[2023-07-18 16:29:10] [config] seed: 1234
[2023-07-18 16:29:10] [config] sentencepiece-alphas:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] sentencepiece-max-lines: 2000000
[2023-07-18 16:29:10] [config] sentencepiece-options: ""
[2023-07-18 16:29:10] [config] sharding: global
[2023-07-18 16:29:10] [config] shuffle: data
[2023-07-18 16:29:10] [config] shuffle-in-ram: false
[2023-07-18 16:29:10] [config] sigterm: save-and-exit
[2023-07-18 16:29:10] [config] skip: false
[2023-07-18 16:29:10] [config] sqlite: ""
[2023-07-18 16:29:10] [config] sqlite-drop: false
[2023-07-18 16:29:10] [config] sync-freq: 200u
[2023-07-18 16:29:10] [config] sync-sgd: false
[2023-07-18 16:29:10] [config] tempdir: /tmp
[2023-07-18 16:29:10] [config] tied-embeddings: false
[2023-07-18 16:29:10] [config] tied-embeddings-all: true
[2023-07-18 16:29:10] [config] tied-embeddings-src: false
[2023-07-18 16:29:10] [config] train-embedder-rank:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] train-sets:
[2023-07-18 16:29:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 16:29:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 16:29:10] [config] transformer-aan-activation: swish
[2023-07-18 16:29:10] [config] transformer-aan-depth: 2
[2023-07-18 16:29:10] [config] transformer-aan-nogate: false
[2023-07-18 16:29:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 16:29:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 16:29:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 16:29:10] [config] transformer-depth-scaling: false
[2023-07-18 16:29:10] [config] transformer-dim-aan: 2048
[2023-07-18 16:29:10] [config] transformer-dim-ffn: 2048
[2023-07-18 16:29:10] [config] transformer-dropout: 0
[2023-07-18 16:29:10] [config] transformer-dropout-attention: 0
[2023-07-18 16:29:10] [config] transformer-dropout-ffn: 0
[2023-07-18 16:29:10] [config] transformer-ffn-activation: swish
[2023-07-18 16:29:10] [config] transformer-ffn-depth: 2
[2023-07-18 16:29:10] [config] transformer-guided-alignment-layer: last
[2023-07-18 16:29:10] [config] transformer-heads: 8
[2023-07-18 16:29:10] [config] transformer-no-projection: false
[2023-07-18 16:29:10] [config] transformer-pool: false
[2023-07-18 16:29:10] [config] transformer-postprocess: dan
[2023-07-18 16:29:10] [config] transformer-postprocess-emb: d
[2023-07-18 16:29:10] [config] transformer-postprocess-top: ""
[2023-07-18 16:29:10] [config] transformer-preprocess: ""
[2023-07-18 16:29:10] [config] transformer-tied-layers:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] transformer-train-position-embeddings: false
[2023-07-18 16:29:10] [config] tsv: false
[2023-07-18 16:29:10] [config] tsv-fields: 0
[2023-07-18 16:29:10] [config] type: amun
[2023-07-18 16:29:10] [config] ulr: false
[2023-07-18 16:29:10] [config] ulr-dim-emb: 0
[2023-07-18 16:29:10] [config] ulr-dropout: 0
[2023-07-18 16:29:10] [config] ulr-keys-vectors: ""
[2023-07-18 16:29:10] [config] ulr-query-vectors: ""
[2023-07-18 16:29:10] [config] ulr-softmax-temperature: 1
[2023-07-18 16:29:10] [config] ulr-trainable-transformation: false
[2023-07-18 16:29:10] [config] unlikelihood-loss: false
[2023-07-18 16:29:10] [config] valid-freq: 50000000
[2023-07-18 16:29:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 16:29:10] [config] valid-max-length: 1000
[2023-07-18 16:29:10] [config] valid-metrics:
[2023-07-18 16:29:10] [config]   - cross-entropy
[2023-07-18 16:29:10] [config]   - translation
[2023-07-18 16:29:10] [config] valid-mini-batch: 32
[2023-07-18 16:29:10] [config] valid-reset-stalled: false
[2023-07-18 16:29:10] [config] valid-script-args:
[2023-07-18 16:29:10] [config]   []
[2023-07-18 16:29:10] [config] valid-script-path: ""
[2023-07-18 16:29:10] [config] valid-sets:
[2023-07-18 16:29:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 16:29:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 16:29:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 16:29:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 16:29:10] [config] vocabs:
[2023-07-18 16:29:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 16:29:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 16:29:10] [config] word-penalty: 0
[2023-07-18 16:29:10] [config] word-scores: false
[2023-07-18 16:29:10] [config] workspace: 5500
[2023-07-18 16:29:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 16:29:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 16:29:10] [training] Using single-device training
[2023-07-18 16:29:11] Synced seed 1234
[2023-07-18 16:29:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 16:29:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 16:29:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 16:29:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 16:29:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 16:29:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 16:29:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 16:29:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 16:29:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 16:29:12] [comm] Using global sharding
[2023-07-18 16:29:12] [comm] NCCLCommunicators constructed successfully
[2023-07-18 16:29:12] [training] Using 1 GPUs
[2023-07-18 16:29:12] [logits] Applying loss function for 1 factor(s)
[2023-07-18 16:29:12] [memory] Reserving 80 MB, device gpu0
[2023-07-18 16:29:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 16:29:13] [memory] Reserving 80 MB, device gpu0
[2023-07-18 16:55:24] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 16:55:24] [valid] No post-processing script given for validating translator
[2023-07-18 16:55:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 16:55:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 16:55:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 16:55:24] [comm] Using global sharding
[2023-07-18 16:55:25] [comm] NCCLCommunicators constructed successfully
[2023-07-18 16:55:25] [training] Using 1 GPUs
[2023-07-18 16:55:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 16:55:26] Allocating memory for general optimizer shards
[2023-07-18 16:55:26] [memory] Reserving 322 MB, device gpu0
[2023-07-18 16:55:26] Loading Adam parameters
[2023-07-18 16:55:26] [memory] Reserving 322 MB, device gpu0
[2023-07-18 16:55:26] [memory] Reserving 80 MB, device gpu0
[2023-07-18 16:55:26] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 16:55:26] [data] Restoring the corpus state to epoch 81, batch 3053
[2023-07-18 16:55:26] [data] Shuffling data
[2023-07-18 16:55:26] [data] Done reading 20,192 sentences
[2023-07-18 16:55:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 16:55:27] Training started
[2023-07-18 16:55:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 16:55:27] [memory] Reserving 80 MB, device gpu0
[2023-07-18 16:55:34] Parameter type float16, optimization type float32, casting types true
[2023-07-18 16:59:12] Seen 20,192 samples
[2023-07-18 16:59:12] Starting data epoch 82 in logical epoch 82
[2023-07-18 16:59:12] [data] Shuffling data
[2023-07-18 16:59:12] [data] Done reading 20,192 sentences
[2023-07-18 16:59:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:03:13] Seen 20,192 samples
[2023-07-18 17:03:13] Starting data epoch 83 in logical epoch 83
[2023-07-18 17:03:13] [data] Shuffling data
[2023-07-18 17:03:13] [data] Done reading 20,192 sentences
[2023-07-18 17:03:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:07:24] Seen 20,192 samples
[2023-07-18 17:07:24] Starting data epoch 84 in logical epoch 84
[2023-07-18 17:07:24] [data] Shuffling data
[2023-07-18 17:07:24] [data] Done reading 20,192 sentences
[2023-07-18 17:07:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:11:32] Seen 20,192 samples
[2023-07-18 17:11:32] Starting data epoch 85 in logical epoch 85
[2023-07-18 17:11:32] [data] Shuffling data
[2023-07-18 17:11:32] [data] Done reading 20,192 sentences
[2023-07-18 17:11:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:15:37] Seen 20,192 samples
[2023-07-18 17:15:37] Starting data epoch 86 in logical epoch 86
[2023-07-18 17:15:37] [data] Shuffling data
[2023-07-18 17:15:37] [data] Done reading 20,192 sentences
[2023-07-18 17:15:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:19:42] Seen 20,192 samples
[2023-07-18 17:19:42] Starting data epoch 87 in logical epoch 87
[2023-07-18 17:19:42] [data] Shuffling data
[2023-07-18 17:19:42] [data] Done reading 20,192 sentences
[2023-07-18 17:19:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:23:44] Seen 20,192 samples
[2023-07-18 17:23:44] Starting data epoch 88 in logical epoch 88
[2023-07-18 17:23:44] [data] Shuffling data
[2023-07-18 17:23:44] [data] Done reading 20,192 sentences
[2023-07-18 17:23:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:27:41] Seen 20,192 samples
[2023-07-18 17:27:41] Starting data epoch 89 in logical epoch 89
[2023-07-18 17:27:41] [data] Shuffling data
[2023-07-18 17:27:41] [data] Done reading 20,192 sentences
[2023-07-18 17:27:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:31:40] Seen 20,192 samples
[2023-07-18 17:31:40] Starting data epoch 90 in logical epoch 90
[2023-07-18 17:31:40] [data] Shuffling data
[2023-07-18 17:31:40] [data] Done reading 20,192 sentences
[2023-07-18 17:31:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 17:35:40] Seen 20,192 samples
[2023-07-18 17:35:40] Starting data epoch 91 in logical epoch 91
[2023-07-18 17:35:40] Training finished
[2023-07-18 17:35:52] [valid] Ep. 91 : Up. 3437 : cross-entropy : 133.437 : new best
[2023-07-18 17:37:33] [valid] Ep. 91 : Up. 3437 : translation : 0 : new best
[2023-07-18 17:37:33] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 17:37:36] Saving Adam parameters
[2023-07-18 17:37:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 17:37:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 17:37:46] [marian] Running on node22.datos.cluster.uy as process 35425 with command line:
[2023-07-18 17:37:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 17:37:46] [config] after: 0e
[2023-07-18 17:37:46] [config] after-batches: 0
[2023-07-18 17:37:46] [config] after-epochs: 100
[2023-07-18 17:37:46] [config] all-caps-every: 0
[2023-07-18 17:37:46] [config] allow-unk: false
[2023-07-18 17:37:46] [config] authors: false
[2023-07-18 17:37:46] [config] beam-size: 12
[2023-07-18 17:37:46] [config] bert-class-symbol: "[CLS]"
[2023-07-18 17:37:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 17:37:46] [config] bert-masking-fraction: 0.15
[2023-07-18 17:37:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 17:37:46] [config] bert-train-type-embeddings: true
[2023-07-18 17:37:46] [config] bert-type-vocab-size: 2
[2023-07-18 17:37:46] [config] build-info: ""
[2023-07-18 17:37:46] [config] check-gradient-nan: false
[2023-07-18 17:37:46] [config] check-nan: false
[2023-07-18 17:37:46] [config] cite: false
[2023-07-18 17:37:46] [config] clip-norm: 1
[2023-07-18 17:37:46] [config] cost-scaling:
[2023-07-18 17:37:46] [config]   - 256.f
[2023-07-18 17:37:46] [config]   - 1000
[2023-07-18 17:37:46] [config]   - 2.f
[2023-07-18 17:37:46] [config]   - 256.f
[2023-07-18 17:37:46] [config] cost-type: ce-sum
[2023-07-18 17:37:46] [config] cpu-threads: 0
[2023-07-18 17:37:46] [config] data-threads: 8
[2023-07-18 17:37:46] [config] data-weighting: ""
[2023-07-18 17:37:46] [config] data-weighting-type: sentence
[2023-07-18 17:37:46] [config] dec-cell: gru
[2023-07-18 17:37:46] [config] dec-cell-base-depth: 2
[2023-07-18 17:37:46] [config] dec-cell-high-depth: 1
[2023-07-18 17:37:46] [config] dec-depth: 1
[2023-07-18 17:37:46] [config] devices:
[2023-07-18 17:37:46] [config]   - 0
[2023-07-18 17:37:46] [config] dim-emb: 512
[2023-07-18 17:37:46] [config] dim-rnn: 1024
[2023-07-18 17:37:46] [config] dim-vocabs:
[2023-07-18 17:37:46] [config]   - 16384
[2023-07-18 17:37:46] [config]   - 16384
[2023-07-18 17:37:46] [config] disp-first: 0
[2023-07-18 17:37:46] [config] disp-freq: 1000u
[2023-07-18 17:37:46] [config] disp-label-counts: true
[2023-07-18 17:37:46] [config] dropout-rnn: 0
[2023-07-18 17:37:46] [config] dropout-src: 0
[2023-07-18 17:37:46] [config] dropout-trg: 0
[2023-07-18 17:37:46] [config] dump-config: ""
[2023-07-18 17:37:46] [config] dynamic-gradient-scaling:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] early-stopping: 200
[2023-07-18 17:37:46] [config] early-stopping-on: first
[2023-07-18 17:37:46] [config] embedding-fix-src: false
[2023-07-18 17:37:46] [config] embedding-fix-trg: false
[2023-07-18 17:37:46] [config] embedding-normalization: false
[2023-07-18 17:37:46] [config] embedding-vectors:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] enc-cell: gru
[2023-07-18 17:37:46] [config] enc-cell-depth: 1
[2023-07-18 17:37:46] [config] enc-depth: 1
[2023-07-18 17:37:46] [config] enc-type: bidirectional
[2023-07-18 17:37:46] [config] english-title-case-every: 0
[2023-07-18 17:37:46] [config] exponential-smoothing: 0
[2023-07-18 17:37:46] [config] factor-weight: 1
[2023-07-18 17:37:46] [config] factors-combine: sum
[2023-07-18 17:37:46] [config] factors-dim-emb: 0
[2023-07-18 17:37:46] [config] gradient-checkpointing: false
[2023-07-18 17:37:46] [config] gradient-norm-average-window: 100
[2023-07-18 17:37:46] [config] guided-alignment: none
[2023-07-18 17:37:46] [config] guided-alignment-cost: mse
[2023-07-18 17:37:46] [config] guided-alignment-weight: 0.1
[2023-07-18 17:37:46] [config] ignore-model-config: false
[2023-07-18 17:37:46] [config] input-types:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] interpolate-env-vars: false
[2023-07-18 17:37:46] [config] keep-best: false
[2023-07-18 17:37:46] [config] label-smoothing: 0
[2023-07-18 17:37:46] [config] layer-normalization: false
[2023-07-18 17:37:46] [config] learn-rate: 0.0001
[2023-07-18 17:37:46] [config] lemma-dependency: ""
[2023-07-18 17:37:46] [config] lemma-dim-emb: 0
[2023-07-18 17:37:46] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 17:37:46] [config] log-level: info
[2023-07-18 17:37:46] [config] log-time-zone: ""
[2023-07-18 17:37:46] [config] logical-epoch:
[2023-07-18 17:37:46] [config]   - 1e
[2023-07-18 17:37:46] [config]   - 0
[2023-07-18 17:37:46] [config] lr-decay: 0
[2023-07-18 17:37:46] [config] lr-decay-freq: 50000
[2023-07-18 17:37:46] [config] lr-decay-inv-sqrt:
[2023-07-18 17:37:46] [config]   - 0
[2023-07-18 17:37:46] [config] lr-decay-repeat-warmup: false
[2023-07-18 17:37:46] [config] lr-decay-reset-optimizer: false
[2023-07-18 17:37:46] [config] lr-decay-start:
[2023-07-18 17:37:46] [config]   - 10
[2023-07-18 17:37:46] [config]   - 1
[2023-07-18 17:37:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 17:37:46] [config] lr-report: false
[2023-07-18 17:37:46] [config] lr-warmup: 0
[2023-07-18 17:37:46] [config] lr-warmup-at-reload: false
[2023-07-18 17:37:46] [config] lr-warmup-cycle: false
[2023-07-18 17:37:46] [config] lr-warmup-start-rate: 0
[2023-07-18 17:37:46] [config] max-length: 150
[2023-07-18 17:37:46] [config] max-length-crop: true
[2023-07-18 17:37:46] [config] max-length-factor: 3
[2023-07-18 17:37:46] [config] maxi-batch: 100
[2023-07-18 17:37:46] [config] maxi-batch-sort: trg
[2023-07-18 17:37:46] [config] mini-batch: 64
[2023-07-18 17:37:46] [config] mini-batch-fit: true
[2023-07-18 17:37:46] [config] mini-batch-fit-step: 10
[2023-07-18 17:37:46] [config] mini-batch-round-up: true
[2023-07-18 17:37:46] [config] mini-batch-track-lr: false
[2023-07-18 17:37:46] [config] mini-batch-warmup: 0
[2023-07-18 17:37:46] [config] mini-batch-words: 0
[2023-07-18 17:37:46] [config] mini-batch-words-ref: 0
[2023-07-18 17:37:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 17:37:46] [config] multi-loss-type: sum
[2023-07-18 17:37:46] [config] n-best: false
[2023-07-18 17:37:46] [config] no-nccl: false
[2023-07-18 17:37:46] [config] no-reload: false
[2023-07-18 17:37:46] [config] no-restore-corpus: false
[2023-07-18 17:37:46] [config] normalize: 0
[2023-07-18 17:37:46] [config] normalize-gradient: false
[2023-07-18 17:37:46] [config] num-devices: 0
[2023-07-18 17:37:46] [config] optimizer: adam
[2023-07-18 17:37:46] [config] optimizer-delay: 1
[2023-07-18 17:37:46] [config] optimizer-params:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] output-omit-bias: false
[2023-07-18 17:37:46] [config] overwrite: true
[2023-07-18 17:37:46] [config] precision:
[2023-07-18 17:37:46] [config]   - float16
[2023-07-18 17:37:46] [config]   - float32
[2023-07-18 17:37:46] [config] pretrained-model: ""
[2023-07-18 17:37:46] [config] quantize-biases: false
[2023-07-18 17:37:46] [config] quantize-bits: 0
[2023-07-18 17:37:46] [config] quantize-log-based: false
[2023-07-18 17:37:46] [config] quantize-optimization-steps: 0
[2023-07-18 17:37:46] [config] quiet: false
[2023-07-18 17:37:46] [config] quiet-translation: true
[2023-07-18 17:37:46] [config] relative-paths: false
[2023-07-18 17:37:46] [config] right-left: false
[2023-07-18 17:37:46] [config] save-freq: 10000u
[2023-07-18 17:37:46] [config] seed: 1234
[2023-07-18 17:37:46] [config] sentencepiece-alphas:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] sentencepiece-max-lines: 2000000
[2023-07-18 17:37:46] [config] sentencepiece-options: ""
[2023-07-18 17:37:46] [config] sharding: global
[2023-07-18 17:37:46] [config] shuffle: data
[2023-07-18 17:37:46] [config] shuffle-in-ram: false
[2023-07-18 17:37:46] [config] sigterm: save-and-exit
[2023-07-18 17:37:46] [config] skip: false
[2023-07-18 17:37:46] [config] sqlite: ""
[2023-07-18 17:37:46] [config] sqlite-drop: false
[2023-07-18 17:37:46] [config] sync-freq: 200u
[2023-07-18 17:37:46] [config] sync-sgd: false
[2023-07-18 17:37:46] [config] tempdir: /tmp
[2023-07-18 17:37:46] [config] tied-embeddings: false
[2023-07-18 17:37:46] [config] tied-embeddings-all: true
[2023-07-18 17:37:46] [config] tied-embeddings-src: false
[2023-07-18 17:37:46] [config] train-embedder-rank:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] train-sets:
[2023-07-18 17:37:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 17:37:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 17:37:46] [config] transformer-aan-activation: swish
[2023-07-18 17:37:46] [config] transformer-aan-depth: 2
[2023-07-18 17:37:46] [config] transformer-aan-nogate: false
[2023-07-18 17:37:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 17:37:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 17:37:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 17:37:46] [config] transformer-depth-scaling: false
[2023-07-18 17:37:46] [config] transformer-dim-aan: 2048
[2023-07-18 17:37:46] [config] transformer-dim-ffn: 2048
[2023-07-18 17:37:46] [config] transformer-dropout: 0
[2023-07-18 17:37:46] [config] transformer-dropout-attention: 0
[2023-07-18 17:37:46] [config] transformer-dropout-ffn: 0
[2023-07-18 17:37:46] [config] transformer-ffn-activation: swish
[2023-07-18 17:37:46] [config] transformer-ffn-depth: 2
[2023-07-18 17:37:46] [config] transformer-guided-alignment-layer: last
[2023-07-18 17:37:46] [config] transformer-heads: 8
[2023-07-18 17:37:46] [config] transformer-no-projection: false
[2023-07-18 17:37:46] [config] transformer-pool: false
[2023-07-18 17:37:46] [config] transformer-postprocess: dan
[2023-07-18 17:37:46] [config] transformer-postprocess-emb: d
[2023-07-18 17:37:46] [config] transformer-postprocess-top: ""
[2023-07-18 17:37:46] [config] transformer-preprocess: ""
[2023-07-18 17:37:46] [config] transformer-tied-layers:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] transformer-train-position-embeddings: false
[2023-07-18 17:37:46] [config] tsv: false
[2023-07-18 17:37:46] [config] tsv-fields: 0
[2023-07-18 17:37:46] [config] type: amun
[2023-07-18 17:37:46] [config] ulr: false
[2023-07-18 17:37:46] [config] ulr-dim-emb: 0
[2023-07-18 17:37:46] [config] ulr-dropout: 0
[2023-07-18 17:37:46] [config] ulr-keys-vectors: ""
[2023-07-18 17:37:46] [config] ulr-query-vectors: ""
[2023-07-18 17:37:46] [config] ulr-softmax-temperature: 1
[2023-07-18 17:37:46] [config] ulr-trainable-transformation: false
[2023-07-18 17:37:46] [config] unlikelihood-loss: false
[2023-07-18 17:37:46] [config] valid-freq: 50000000
[2023-07-18 17:37:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 17:37:46] [config] valid-max-length: 1000
[2023-07-18 17:37:46] [config] valid-metrics:
[2023-07-18 17:37:46] [config]   - cross-entropy
[2023-07-18 17:37:46] [config]   - translation
[2023-07-18 17:37:46] [config] valid-mini-batch: 32
[2023-07-18 17:37:46] [config] valid-reset-stalled: false
[2023-07-18 17:37:46] [config] valid-script-args:
[2023-07-18 17:37:46] [config]   []
[2023-07-18 17:37:46] [config] valid-script-path: ""
[2023-07-18 17:37:46] [config] valid-sets:
[2023-07-18 17:37:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 17:37:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 17:37:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 17:37:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 17:37:46] [config] vocabs:
[2023-07-18 17:37:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 17:37:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 17:37:46] [config] word-penalty: 0
[2023-07-18 17:37:46] [config] word-scores: false
[2023-07-18 17:37:46] [config] workspace: 5500
[2023-07-18 17:37:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 17:37:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 17:37:46] [training] Using single-device training
[2023-07-18 17:37:47] Synced seed 1234
[2023-07-18 17:37:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 17:37:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 17:37:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 17:37:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 17:37:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 17:37:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 17:37:47] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 17:37:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 17:37:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 17:37:48] [comm] Using global sharding
[2023-07-18 17:37:49] [comm] NCCLCommunicators constructed successfully
[2023-07-18 17:37:49] [training] Using 1 GPUs
[2023-07-18 17:37:49] [logits] Applying loss function for 1 factor(s)
[2023-07-18 17:37:49] [memory] Reserving 80 MB, device gpu0
[2023-07-18 17:37:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 17:37:49] [memory] Reserving 80 MB, device gpu0
[2023-07-18 18:03:10] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 18:03:10] [valid] No post-processing script given for validating translator
[2023-07-18 18:03:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 18:03:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 18:03:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 18:03:10] [comm] Using global sharding
[2023-07-18 18:03:10] [comm] NCCLCommunicators constructed successfully
[2023-07-18 18:03:10] [training] Using 1 GPUs
[2023-07-18 18:03:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 18:03:13] Allocating memory for general optimizer shards
[2023-07-18 18:03:13] [memory] Reserving 322 MB, device gpu0
[2023-07-18 18:03:13] Loading Adam parameters
[2023-07-18 18:03:13] [memory] Reserving 322 MB, device gpu0
[2023-07-18 18:03:13] [memory] Reserving 80 MB, device gpu0
[2023-07-18 18:03:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 18:03:13] [data] Restoring the corpus state to epoch 91, batch 3437
[2023-07-18 18:03:13] [data] Shuffling data
[2023-07-18 18:03:13] [data] Done reading 20,192 sentences
[2023-07-18 18:03:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:03:13] Training started
[2023-07-18 18:03:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 18:03:14] [memory] Reserving 80 MB, device gpu0
[2023-07-18 18:03:19] Parameter type float16, optimization type float32, casting types true
[2023-07-18 18:07:09] Seen 20,192 samples
[2023-07-18 18:07:09] Starting data epoch 92 in logical epoch 92
[2023-07-18 18:07:09] [data] Shuffling data
[2023-07-18 18:07:09] [data] Done reading 20,192 sentences
[2023-07-18 18:07:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:11:04] Seen 20,192 samples
[2023-07-18 18:11:04] Starting data epoch 93 in logical epoch 93
[2023-07-18 18:11:04] [data] Shuffling data
[2023-07-18 18:11:04] [data] Done reading 20,192 sentences
[2023-07-18 18:11:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:15:14] Seen 20,192 samples
[2023-07-18 18:15:14] Starting data epoch 94 in logical epoch 94
[2023-07-18 18:15:14] [data] Shuffling data
[2023-07-18 18:15:14] [data] Done reading 20,192 sentences
[2023-07-18 18:15:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:19:08] Seen 20,192 samples
[2023-07-18 18:19:08] Starting data epoch 95 in logical epoch 95
[2023-07-18 18:19:08] [data] Shuffling data
[2023-07-18 18:19:08] [data] Done reading 20,192 sentences
[2023-07-18 18:19:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:23:02] Seen 20,192 samples
[2023-07-18 18:23:02] Starting data epoch 96 in logical epoch 96
[2023-07-18 18:23:02] [data] Shuffling data
[2023-07-18 18:23:02] [data] Done reading 20,192 sentences
[2023-07-18 18:23:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:26:56] Seen 20,192 samples
[2023-07-18 18:26:56] Starting data epoch 97 in logical epoch 97
[2023-07-18 18:26:56] [data] Shuffling data
[2023-07-18 18:26:56] [data] Done reading 20,192 sentences
[2023-07-18 18:26:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:30:58] Seen 20,192 samples
[2023-07-18 18:30:58] Starting data epoch 98 in logical epoch 98
[2023-07-18 18:30:58] [data] Shuffling data
[2023-07-18 18:30:58] [data] Done reading 20,192 sentences
[2023-07-18 18:30:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:35:06] Seen 20,192 samples
[2023-07-18 18:35:06] Starting data epoch 99 in logical epoch 99
[2023-07-18 18:35:06] [data] Shuffling data
[2023-07-18 18:35:06] [data] Done reading 20,192 sentences
[2023-07-18 18:35:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:38:58] Seen 20,192 samples
[2023-07-18 18:38:58] Starting data epoch 100 in logical epoch 100
[2023-07-18 18:38:58] [data] Shuffling data
[2023-07-18 18:38:58] [data] Done reading 20,192 sentences
[2023-07-18 18:38:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 18:42:58] Seen 20,192 samples
[2023-07-18 18:42:58] Starting data epoch 101 in logical epoch 101
[2023-07-18 18:42:58] Training finished
[2023-07-18 18:43:10] [valid] Ep. 101 : Up. 3818 : cross-entropy : 130.462 : new best
[2023-07-18 18:45:17] [valid] Ep. 101 : Up. 3818 : translation : 0 : new best
[2023-07-18 18:45:17] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 18:45:20] Saving Adam parameters
[2023-07-18 18:45:21] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 18:45:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 18:45:28] [marian] Running on node22.datos.cluster.uy as process 39680 with command line:
[2023-07-18 18:45:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 18:45:28] [config] after: 0e
[2023-07-18 18:45:28] [config] after-batches: 0
[2023-07-18 18:45:28] [config] after-epochs: 110
[2023-07-18 18:45:28] [config] all-caps-every: 0
[2023-07-18 18:45:28] [config] allow-unk: false
[2023-07-18 18:45:28] [config] authors: false
[2023-07-18 18:45:28] [config] beam-size: 12
[2023-07-18 18:45:28] [config] bert-class-symbol: "[CLS]"
[2023-07-18 18:45:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 18:45:28] [config] bert-masking-fraction: 0.15
[2023-07-18 18:45:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 18:45:28] [config] bert-train-type-embeddings: true
[2023-07-18 18:45:28] [config] bert-type-vocab-size: 2
[2023-07-18 18:45:28] [config] build-info: ""
[2023-07-18 18:45:28] [config] check-gradient-nan: false
[2023-07-18 18:45:28] [config] check-nan: false
[2023-07-18 18:45:28] [config] cite: false
[2023-07-18 18:45:28] [config] clip-norm: 1
[2023-07-18 18:45:28] [config] cost-scaling:
[2023-07-18 18:45:28] [config]   - 256.f
[2023-07-18 18:45:28] [config]   - 1000
[2023-07-18 18:45:28] [config]   - 2.f
[2023-07-18 18:45:28] [config]   - 256.f
[2023-07-18 18:45:28] [config] cost-type: ce-sum
[2023-07-18 18:45:28] [config] cpu-threads: 0
[2023-07-18 18:45:28] [config] data-threads: 8
[2023-07-18 18:45:28] [config] data-weighting: ""
[2023-07-18 18:45:28] [config] data-weighting-type: sentence
[2023-07-18 18:45:28] [config] dec-cell: gru
[2023-07-18 18:45:28] [config] dec-cell-base-depth: 2
[2023-07-18 18:45:28] [config] dec-cell-high-depth: 1
[2023-07-18 18:45:28] [config] dec-depth: 1
[2023-07-18 18:45:28] [config] devices:
[2023-07-18 18:45:28] [config]   - 0
[2023-07-18 18:45:28] [config] dim-emb: 512
[2023-07-18 18:45:28] [config] dim-rnn: 1024
[2023-07-18 18:45:28] [config] dim-vocabs:
[2023-07-18 18:45:28] [config]   - 16384
[2023-07-18 18:45:28] [config]   - 16384
[2023-07-18 18:45:28] [config] disp-first: 0
[2023-07-18 18:45:28] [config] disp-freq: 1000u
[2023-07-18 18:45:28] [config] disp-label-counts: true
[2023-07-18 18:45:28] [config] dropout-rnn: 0
[2023-07-18 18:45:28] [config] dropout-src: 0
[2023-07-18 18:45:28] [config] dropout-trg: 0
[2023-07-18 18:45:28] [config] dump-config: ""
[2023-07-18 18:45:28] [config] dynamic-gradient-scaling:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] early-stopping: 200
[2023-07-18 18:45:28] [config] early-stopping-on: first
[2023-07-18 18:45:28] [config] embedding-fix-src: false
[2023-07-18 18:45:28] [config] embedding-fix-trg: false
[2023-07-18 18:45:28] [config] embedding-normalization: false
[2023-07-18 18:45:28] [config] embedding-vectors:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] enc-cell: gru
[2023-07-18 18:45:28] [config] enc-cell-depth: 1
[2023-07-18 18:45:28] [config] enc-depth: 1
[2023-07-18 18:45:28] [config] enc-type: bidirectional
[2023-07-18 18:45:28] [config] english-title-case-every: 0
[2023-07-18 18:45:28] [config] exponential-smoothing: 0
[2023-07-18 18:45:28] [config] factor-weight: 1
[2023-07-18 18:45:28] [config] factors-combine: sum
[2023-07-18 18:45:28] [config] factors-dim-emb: 0
[2023-07-18 18:45:28] [config] gradient-checkpointing: false
[2023-07-18 18:45:28] [config] gradient-norm-average-window: 100
[2023-07-18 18:45:28] [config] guided-alignment: none
[2023-07-18 18:45:28] [config] guided-alignment-cost: mse
[2023-07-18 18:45:28] [config] guided-alignment-weight: 0.1
[2023-07-18 18:45:28] [config] ignore-model-config: false
[2023-07-18 18:45:28] [config] input-types:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] interpolate-env-vars: false
[2023-07-18 18:45:28] [config] keep-best: false
[2023-07-18 18:45:28] [config] label-smoothing: 0
[2023-07-18 18:45:28] [config] layer-normalization: false
[2023-07-18 18:45:28] [config] learn-rate: 0.0001
[2023-07-18 18:45:28] [config] lemma-dependency: ""
[2023-07-18 18:45:28] [config] lemma-dim-emb: 0
[2023-07-18 18:45:28] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 18:45:28] [config] log-level: info
[2023-07-18 18:45:28] [config] log-time-zone: ""
[2023-07-18 18:45:28] [config] logical-epoch:
[2023-07-18 18:45:28] [config]   - 1e
[2023-07-18 18:45:28] [config]   - 0
[2023-07-18 18:45:28] [config] lr-decay: 0
[2023-07-18 18:45:28] [config] lr-decay-freq: 50000
[2023-07-18 18:45:28] [config] lr-decay-inv-sqrt:
[2023-07-18 18:45:28] [config]   - 0
[2023-07-18 18:45:28] [config] lr-decay-repeat-warmup: false
[2023-07-18 18:45:28] [config] lr-decay-reset-optimizer: false
[2023-07-18 18:45:28] [config] lr-decay-start:
[2023-07-18 18:45:28] [config]   - 10
[2023-07-18 18:45:28] [config]   - 1
[2023-07-18 18:45:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 18:45:28] [config] lr-report: false
[2023-07-18 18:45:28] [config] lr-warmup: 0
[2023-07-18 18:45:28] [config] lr-warmup-at-reload: false
[2023-07-18 18:45:28] [config] lr-warmup-cycle: false
[2023-07-18 18:45:28] [config] lr-warmup-start-rate: 0
[2023-07-18 18:45:28] [config] max-length: 150
[2023-07-18 18:45:28] [config] max-length-crop: true
[2023-07-18 18:45:28] [config] max-length-factor: 3
[2023-07-18 18:45:28] [config] maxi-batch: 100
[2023-07-18 18:45:28] [config] maxi-batch-sort: trg
[2023-07-18 18:45:28] [config] mini-batch: 64
[2023-07-18 18:45:28] [config] mini-batch-fit: true
[2023-07-18 18:45:28] [config] mini-batch-fit-step: 10
[2023-07-18 18:45:28] [config] mini-batch-round-up: true
[2023-07-18 18:45:28] [config] mini-batch-track-lr: false
[2023-07-18 18:45:28] [config] mini-batch-warmup: 0
[2023-07-18 18:45:28] [config] mini-batch-words: 0
[2023-07-18 18:45:28] [config] mini-batch-words-ref: 0
[2023-07-18 18:45:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 18:45:28] [config] multi-loss-type: sum
[2023-07-18 18:45:28] [config] n-best: false
[2023-07-18 18:45:28] [config] no-nccl: false
[2023-07-18 18:45:28] [config] no-reload: false
[2023-07-18 18:45:28] [config] no-restore-corpus: false
[2023-07-18 18:45:28] [config] normalize: 0
[2023-07-18 18:45:28] [config] normalize-gradient: false
[2023-07-18 18:45:28] [config] num-devices: 0
[2023-07-18 18:45:28] [config] optimizer: adam
[2023-07-18 18:45:28] [config] optimizer-delay: 1
[2023-07-18 18:45:28] [config] optimizer-params:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] output-omit-bias: false
[2023-07-18 18:45:28] [config] overwrite: true
[2023-07-18 18:45:28] [config] precision:
[2023-07-18 18:45:28] [config]   - float16
[2023-07-18 18:45:28] [config]   - float32
[2023-07-18 18:45:28] [config] pretrained-model: ""
[2023-07-18 18:45:28] [config] quantize-biases: false
[2023-07-18 18:45:28] [config] quantize-bits: 0
[2023-07-18 18:45:28] [config] quantize-log-based: false
[2023-07-18 18:45:28] [config] quantize-optimization-steps: 0
[2023-07-18 18:45:28] [config] quiet: false
[2023-07-18 18:45:28] [config] quiet-translation: true
[2023-07-18 18:45:28] [config] relative-paths: false
[2023-07-18 18:45:28] [config] right-left: false
[2023-07-18 18:45:28] [config] save-freq: 10000u
[2023-07-18 18:45:28] [config] seed: 1234
[2023-07-18 18:45:28] [config] sentencepiece-alphas:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] sentencepiece-max-lines: 2000000
[2023-07-18 18:45:28] [config] sentencepiece-options: ""
[2023-07-18 18:45:28] [config] sharding: global
[2023-07-18 18:45:28] [config] shuffle: data
[2023-07-18 18:45:28] [config] shuffle-in-ram: false
[2023-07-18 18:45:28] [config] sigterm: save-and-exit
[2023-07-18 18:45:28] [config] skip: false
[2023-07-18 18:45:28] [config] sqlite: ""
[2023-07-18 18:45:28] [config] sqlite-drop: false
[2023-07-18 18:45:28] [config] sync-freq: 200u
[2023-07-18 18:45:28] [config] sync-sgd: false
[2023-07-18 18:45:28] [config] tempdir: /tmp
[2023-07-18 18:45:28] [config] tied-embeddings: false
[2023-07-18 18:45:28] [config] tied-embeddings-all: true
[2023-07-18 18:45:28] [config] tied-embeddings-src: false
[2023-07-18 18:45:28] [config] train-embedder-rank:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] train-sets:
[2023-07-18 18:45:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 18:45:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 18:45:28] [config] transformer-aan-activation: swish
[2023-07-18 18:45:28] [config] transformer-aan-depth: 2
[2023-07-18 18:45:28] [config] transformer-aan-nogate: false
[2023-07-18 18:45:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 18:45:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 18:45:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 18:45:28] [config] transformer-depth-scaling: false
[2023-07-18 18:45:28] [config] transformer-dim-aan: 2048
[2023-07-18 18:45:28] [config] transformer-dim-ffn: 2048
[2023-07-18 18:45:28] [config] transformer-dropout: 0
[2023-07-18 18:45:28] [config] transformer-dropout-attention: 0
[2023-07-18 18:45:28] [config] transformer-dropout-ffn: 0
[2023-07-18 18:45:28] [config] transformer-ffn-activation: swish
[2023-07-18 18:45:28] [config] transformer-ffn-depth: 2
[2023-07-18 18:45:28] [config] transformer-guided-alignment-layer: last
[2023-07-18 18:45:28] [config] transformer-heads: 8
[2023-07-18 18:45:28] [config] transformer-no-projection: false
[2023-07-18 18:45:28] [config] transformer-pool: false
[2023-07-18 18:45:28] [config] transformer-postprocess: dan
[2023-07-18 18:45:28] [config] transformer-postprocess-emb: d
[2023-07-18 18:45:28] [config] transformer-postprocess-top: ""
[2023-07-18 18:45:28] [config] transformer-preprocess: ""
[2023-07-18 18:45:28] [config] transformer-tied-layers:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] transformer-train-position-embeddings: false
[2023-07-18 18:45:28] [config] tsv: false
[2023-07-18 18:45:28] [config] tsv-fields: 0
[2023-07-18 18:45:28] [config] type: amun
[2023-07-18 18:45:28] [config] ulr: false
[2023-07-18 18:45:28] [config] ulr-dim-emb: 0
[2023-07-18 18:45:28] [config] ulr-dropout: 0
[2023-07-18 18:45:28] [config] ulr-keys-vectors: ""
[2023-07-18 18:45:28] [config] ulr-query-vectors: ""
[2023-07-18 18:45:28] [config] ulr-softmax-temperature: 1
[2023-07-18 18:45:28] [config] ulr-trainable-transformation: false
[2023-07-18 18:45:28] [config] unlikelihood-loss: false
[2023-07-18 18:45:28] [config] valid-freq: 50000000
[2023-07-18 18:45:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 18:45:28] [config] valid-max-length: 1000
[2023-07-18 18:45:28] [config] valid-metrics:
[2023-07-18 18:45:28] [config]   - cross-entropy
[2023-07-18 18:45:28] [config]   - translation
[2023-07-18 18:45:28] [config] valid-mini-batch: 32
[2023-07-18 18:45:28] [config] valid-reset-stalled: false
[2023-07-18 18:45:28] [config] valid-script-args:
[2023-07-18 18:45:28] [config]   []
[2023-07-18 18:45:28] [config] valid-script-path: ""
[2023-07-18 18:45:28] [config] valid-sets:
[2023-07-18 18:45:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 18:45:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 18:45:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 18:45:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 18:45:28] [config] vocabs:
[2023-07-18 18:45:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 18:45:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 18:45:28] [config] word-penalty: 0
[2023-07-18 18:45:28] [config] word-scores: false
[2023-07-18 18:45:28] [config] workspace: 5500
[2023-07-18 18:45:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 18:45:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 18:45:28] [training] Using single-device training
[2023-07-18 18:45:32] Synced seed 1234
[2023-07-18 18:45:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 18:45:32] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 18:45:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 18:45:32] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 18:45:32] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 18:45:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 18:45:32] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 18:45:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 18:45:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 18:45:33] [comm] Using global sharding
[2023-07-18 18:45:33] [comm] NCCLCommunicators constructed successfully
[2023-07-18 18:45:33] [training] Using 1 GPUs
[2023-07-18 18:45:33] [logits] Applying loss function for 1 factor(s)
[2023-07-18 18:45:33] [memory] Reserving 80 MB, device gpu0
[2023-07-18 18:45:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 18:45:34] [memory] Reserving 80 MB, device gpu0
[2023-07-18 19:10:24] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 19:10:24] [valid] No post-processing script given for validating translator
[2023-07-18 19:10:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 19:10:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 19:10:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 19:10:24] [comm] Using global sharding
[2023-07-18 19:10:24] [comm] NCCLCommunicators constructed successfully
[2023-07-18 19:10:24] [training] Using 1 GPUs
[2023-07-18 19:10:24] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 19:10:25] Allocating memory for general optimizer shards
[2023-07-18 19:10:25] [memory] Reserving 322 MB, device gpu0
[2023-07-18 19:10:25] Loading Adam parameters
[2023-07-18 19:10:25] [memory] Reserving 322 MB, device gpu0
[2023-07-18 19:10:25] [memory] Reserving 80 MB, device gpu0
[2023-07-18 19:10:26] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 19:10:26] [data] Restoring the corpus state to epoch 101, batch 3818
[2023-07-18 19:10:26] [data] Shuffling data
[2023-07-18 19:10:26] [data] Done reading 20,192 sentences
[2023-07-18 19:10:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:10:26] Training started
[2023-07-18 19:10:26] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 19:10:26] [memory] Reserving 80 MB, device gpu0
[2023-07-18 19:10:30] Parameter type float16, optimization type float32, casting types true
[2023-07-18 19:14:04] Seen 20,192 samples
[2023-07-18 19:14:04] Starting data epoch 102 in logical epoch 102
[2023-07-18 19:14:04] [data] Shuffling data
[2023-07-18 19:14:04] [data] Done reading 20,192 sentences
[2023-07-18 19:14:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:17:44] Seen 20,192 samples
[2023-07-18 19:17:44] Starting data epoch 103 in logical epoch 103
[2023-07-18 19:17:44] [data] Shuffling data
[2023-07-18 19:17:44] [data] Done reading 20,192 sentences
[2023-07-18 19:17:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:21:41] Seen 20,192 samples
[2023-07-18 19:21:41] Starting data epoch 104 in logical epoch 104
[2023-07-18 19:21:41] [data] Shuffling data
[2023-07-18 19:21:41] [data] Done reading 20,192 sentences
[2023-07-18 19:21:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:25:38] Seen 20,192 samples
[2023-07-18 19:25:38] Starting data epoch 105 in logical epoch 105
[2023-07-18 19:25:38] [data] Shuffling data
[2023-07-18 19:25:38] [data] Done reading 20,192 sentences
[2023-07-18 19:25:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:28:35] Ep. 105 : Up. 4000 : Sen. 16,374 : Cost 3.75971293 * 16,212,366 @ 21,569 after 64,980,926 : Time 1090.95s : 14860.80 words/s : gNorm 1.0953
[2023-07-18 19:29:29] Seen 20,192 samples
[2023-07-18 19:29:29] Starting data epoch 106 in logical epoch 106
[2023-07-18 19:29:29] [data] Shuffling data
[2023-07-18 19:29:29] [data] Done reading 20,192 sentences
[2023-07-18 19:29:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:33:34] Seen 20,192 samples
[2023-07-18 19:33:34] Starting data epoch 107 in logical epoch 107
[2023-07-18 19:33:34] [data] Shuffling data
[2023-07-18 19:33:34] [data] Done reading 20,192 sentences
[2023-07-18 19:33:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:37:31] Seen 20,192 samples
[2023-07-18 19:37:31] Starting data epoch 108 in logical epoch 108
[2023-07-18 19:37:31] [data] Shuffling data
[2023-07-18 19:37:31] [data] Done reading 20,192 sentences
[2023-07-18 19:37:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:41:30] Seen 20,192 samples
[2023-07-18 19:41:30] Starting data epoch 109 in logical epoch 109
[2023-07-18 19:41:30] [data] Shuffling data
[2023-07-18 19:41:30] [data] Done reading 20,192 sentences
[2023-07-18 19:41:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:45:26] Seen 20,192 samples
[2023-07-18 19:45:26] Starting data epoch 110 in logical epoch 110
[2023-07-18 19:45:26] [data] Shuffling data
[2023-07-18 19:45:26] [data] Done reading 20,192 sentences
[2023-07-18 19:45:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 19:49:26] Seen 20,192 samples
[2023-07-18 19:49:26] Starting data epoch 111 in logical epoch 111
[2023-07-18 19:49:26] Training finished
[2023-07-18 19:49:36] [valid] Ep. 111 : Up. 4198 : cross-entropy : 129.677 : new best
[2023-07-18 19:51:17] [valid] Ep. 111 : Up. 4198 : translation : 0 : new best
[2023-07-18 19:51:17] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 19:51:20] Saving Adam parameters
[2023-07-18 19:51:21] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 19:51:33] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 19:51:33] [marian] Running on node22.datos.cluster.uy as process 3408 with command line:
[2023-07-18 19:51:33] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 19:51:33] [config] after: 0e
[2023-07-18 19:51:33] [config] after-batches: 0
[2023-07-18 19:51:33] [config] after-epochs: 120
[2023-07-18 19:51:33] [config] all-caps-every: 0
[2023-07-18 19:51:33] [config] allow-unk: false
[2023-07-18 19:51:33] [config] authors: false
[2023-07-18 19:51:33] [config] beam-size: 12
[2023-07-18 19:51:33] [config] bert-class-symbol: "[CLS]"
[2023-07-18 19:51:33] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 19:51:33] [config] bert-masking-fraction: 0.15
[2023-07-18 19:51:33] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 19:51:33] [config] bert-train-type-embeddings: true
[2023-07-18 19:51:33] [config] bert-type-vocab-size: 2
[2023-07-18 19:51:33] [config] build-info: ""
[2023-07-18 19:51:33] [config] check-gradient-nan: false
[2023-07-18 19:51:33] [config] check-nan: false
[2023-07-18 19:51:33] [config] cite: false
[2023-07-18 19:51:33] [config] clip-norm: 1
[2023-07-18 19:51:33] [config] cost-scaling:
[2023-07-18 19:51:33] [config]   - 256.f
[2023-07-18 19:51:33] [config]   - 1000
[2023-07-18 19:51:33] [config]   - 2.f
[2023-07-18 19:51:33] [config]   - 256.f
[2023-07-18 19:51:33] [config] cost-type: ce-sum
[2023-07-18 19:51:33] [config] cpu-threads: 0
[2023-07-18 19:51:33] [config] data-threads: 8
[2023-07-18 19:51:33] [config] data-weighting: ""
[2023-07-18 19:51:33] [config] data-weighting-type: sentence
[2023-07-18 19:51:33] [config] dec-cell: gru
[2023-07-18 19:51:33] [config] dec-cell-base-depth: 2
[2023-07-18 19:51:33] [config] dec-cell-high-depth: 1
[2023-07-18 19:51:33] [config] dec-depth: 1
[2023-07-18 19:51:33] [config] devices:
[2023-07-18 19:51:33] [config]   - 0
[2023-07-18 19:51:33] [config] dim-emb: 512
[2023-07-18 19:51:33] [config] dim-rnn: 1024
[2023-07-18 19:51:33] [config] dim-vocabs:
[2023-07-18 19:51:33] [config]   - 16384
[2023-07-18 19:51:33] [config]   - 16384
[2023-07-18 19:51:33] [config] disp-first: 0
[2023-07-18 19:51:33] [config] disp-freq: 1000u
[2023-07-18 19:51:33] [config] disp-label-counts: true
[2023-07-18 19:51:33] [config] dropout-rnn: 0
[2023-07-18 19:51:33] [config] dropout-src: 0
[2023-07-18 19:51:33] [config] dropout-trg: 0
[2023-07-18 19:51:33] [config] dump-config: ""
[2023-07-18 19:51:33] [config] dynamic-gradient-scaling:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] early-stopping: 200
[2023-07-18 19:51:33] [config] early-stopping-on: first
[2023-07-18 19:51:33] [config] embedding-fix-src: false
[2023-07-18 19:51:33] [config] embedding-fix-trg: false
[2023-07-18 19:51:33] [config] embedding-normalization: false
[2023-07-18 19:51:33] [config] embedding-vectors:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] enc-cell: gru
[2023-07-18 19:51:33] [config] enc-cell-depth: 1
[2023-07-18 19:51:33] [config] enc-depth: 1
[2023-07-18 19:51:33] [config] enc-type: bidirectional
[2023-07-18 19:51:33] [config] english-title-case-every: 0
[2023-07-18 19:51:33] [config] exponential-smoothing: 0
[2023-07-18 19:51:33] [config] factor-weight: 1
[2023-07-18 19:51:33] [config] factors-combine: sum
[2023-07-18 19:51:33] [config] factors-dim-emb: 0
[2023-07-18 19:51:33] [config] gradient-checkpointing: false
[2023-07-18 19:51:33] [config] gradient-norm-average-window: 100
[2023-07-18 19:51:33] [config] guided-alignment: none
[2023-07-18 19:51:33] [config] guided-alignment-cost: mse
[2023-07-18 19:51:33] [config] guided-alignment-weight: 0.1
[2023-07-18 19:51:33] [config] ignore-model-config: false
[2023-07-18 19:51:33] [config] input-types:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] interpolate-env-vars: false
[2023-07-18 19:51:33] [config] keep-best: false
[2023-07-18 19:51:33] [config] label-smoothing: 0
[2023-07-18 19:51:33] [config] layer-normalization: false
[2023-07-18 19:51:33] [config] learn-rate: 0.0001
[2023-07-18 19:51:33] [config] lemma-dependency: ""
[2023-07-18 19:51:33] [config] lemma-dim-emb: 0
[2023-07-18 19:51:33] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 19:51:33] [config] log-level: info
[2023-07-18 19:51:33] [config] log-time-zone: ""
[2023-07-18 19:51:33] [config] logical-epoch:
[2023-07-18 19:51:33] [config]   - 1e
[2023-07-18 19:51:33] [config]   - 0
[2023-07-18 19:51:33] [config] lr-decay: 0
[2023-07-18 19:51:33] [config] lr-decay-freq: 50000
[2023-07-18 19:51:33] [config] lr-decay-inv-sqrt:
[2023-07-18 19:51:33] [config]   - 0
[2023-07-18 19:51:33] [config] lr-decay-repeat-warmup: false
[2023-07-18 19:51:33] [config] lr-decay-reset-optimizer: false
[2023-07-18 19:51:33] [config] lr-decay-start:
[2023-07-18 19:51:33] [config]   - 10
[2023-07-18 19:51:33] [config]   - 1
[2023-07-18 19:51:33] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 19:51:33] [config] lr-report: false
[2023-07-18 19:51:33] [config] lr-warmup: 0
[2023-07-18 19:51:33] [config] lr-warmup-at-reload: false
[2023-07-18 19:51:33] [config] lr-warmup-cycle: false
[2023-07-18 19:51:33] [config] lr-warmup-start-rate: 0
[2023-07-18 19:51:33] [config] max-length: 150
[2023-07-18 19:51:33] [config] max-length-crop: true
[2023-07-18 19:51:33] [config] max-length-factor: 3
[2023-07-18 19:51:33] [config] maxi-batch: 100
[2023-07-18 19:51:33] [config] maxi-batch-sort: trg
[2023-07-18 19:51:33] [config] mini-batch: 64
[2023-07-18 19:51:33] [config] mini-batch-fit: true
[2023-07-18 19:51:33] [config] mini-batch-fit-step: 10
[2023-07-18 19:51:33] [config] mini-batch-round-up: true
[2023-07-18 19:51:33] [config] mini-batch-track-lr: false
[2023-07-18 19:51:33] [config] mini-batch-warmup: 0
[2023-07-18 19:51:33] [config] mini-batch-words: 0
[2023-07-18 19:51:33] [config] mini-batch-words-ref: 0
[2023-07-18 19:51:33] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 19:51:33] [config] multi-loss-type: sum
[2023-07-18 19:51:33] [config] n-best: false
[2023-07-18 19:51:33] [config] no-nccl: false
[2023-07-18 19:51:33] [config] no-reload: false
[2023-07-18 19:51:33] [config] no-restore-corpus: false
[2023-07-18 19:51:33] [config] normalize: 0
[2023-07-18 19:51:33] [config] normalize-gradient: false
[2023-07-18 19:51:33] [config] num-devices: 0
[2023-07-18 19:51:33] [config] optimizer: adam
[2023-07-18 19:51:33] [config] optimizer-delay: 1
[2023-07-18 19:51:33] [config] optimizer-params:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] output-omit-bias: false
[2023-07-18 19:51:33] [config] overwrite: true
[2023-07-18 19:51:33] [config] precision:
[2023-07-18 19:51:33] [config]   - float16
[2023-07-18 19:51:33] [config]   - float32
[2023-07-18 19:51:33] [config] pretrained-model: ""
[2023-07-18 19:51:33] [config] quantize-biases: false
[2023-07-18 19:51:33] [config] quantize-bits: 0
[2023-07-18 19:51:33] [config] quantize-log-based: false
[2023-07-18 19:51:33] [config] quantize-optimization-steps: 0
[2023-07-18 19:51:33] [config] quiet: false
[2023-07-18 19:51:33] [config] quiet-translation: true
[2023-07-18 19:51:33] [config] relative-paths: false
[2023-07-18 19:51:33] [config] right-left: false
[2023-07-18 19:51:33] [config] save-freq: 10000u
[2023-07-18 19:51:33] [config] seed: 1234
[2023-07-18 19:51:33] [config] sentencepiece-alphas:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] sentencepiece-max-lines: 2000000
[2023-07-18 19:51:33] [config] sentencepiece-options: ""
[2023-07-18 19:51:33] [config] sharding: global
[2023-07-18 19:51:33] [config] shuffle: data
[2023-07-18 19:51:33] [config] shuffle-in-ram: false
[2023-07-18 19:51:33] [config] sigterm: save-and-exit
[2023-07-18 19:51:33] [config] skip: false
[2023-07-18 19:51:33] [config] sqlite: ""
[2023-07-18 19:51:33] [config] sqlite-drop: false
[2023-07-18 19:51:33] [config] sync-freq: 200u
[2023-07-18 19:51:33] [config] sync-sgd: false
[2023-07-18 19:51:33] [config] tempdir: /tmp
[2023-07-18 19:51:33] [config] tied-embeddings: false
[2023-07-18 19:51:33] [config] tied-embeddings-all: true
[2023-07-18 19:51:33] [config] tied-embeddings-src: false
[2023-07-18 19:51:33] [config] train-embedder-rank:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] train-sets:
[2023-07-18 19:51:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 19:51:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 19:51:33] [config] transformer-aan-activation: swish
[2023-07-18 19:51:33] [config] transformer-aan-depth: 2
[2023-07-18 19:51:33] [config] transformer-aan-nogate: false
[2023-07-18 19:51:33] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 19:51:33] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 19:51:33] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 19:51:33] [config] transformer-depth-scaling: false
[2023-07-18 19:51:33] [config] transformer-dim-aan: 2048
[2023-07-18 19:51:33] [config] transformer-dim-ffn: 2048
[2023-07-18 19:51:33] [config] transformer-dropout: 0
[2023-07-18 19:51:33] [config] transformer-dropout-attention: 0
[2023-07-18 19:51:33] [config] transformer-dropout-ffn: 0
[2023-07-18 19:51:33] [config] transformer-ffn-activation: swish
[2023-07-18 19:51:33] [config] transformer-ffn-depth: 2
[2023-07-18 19:51:33] [config] transformer-guided-alignment-layer: last
[2023-07-18 19:51:33] [config] transformer-heads: 8
[2023-07-18 19:51:33] [config] transformer-no-projection: false
[2023-07-18 19:51:33] [config] transformer-pool: false
[2023-07-18 19:51:33] [config] transformer-postprocess: dan
[2023-07-18 19:51:33] [config] transformer-postprocess-emb: d
[2023-07-18 19:51:33] [config] transformer-postprocess-top: ""
[2023-07-18 19:51:33] [config] transformer-preprocess: ""
[2023-07-18 19:51:33] [config] transformer-tied-layers:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] transformer-train-position-embeddings: false
[2023-07-18 19:51:33] [config] tsv: false
[2023-07-18 19:51:33] [config] tsv-fields: 0
[2023-07-18 19:51:33] [config] type: amun
[2023-07-18 19:51:33] [config] ulr: false
[2023-07-18 19:51:33] [config] ulr-dim-emb: 0
[2023-07-18 19:51:33] [config] ulr-dropout: 0
[2023-07-18 19:51:33] [config] ulr-keys-vectors: ""
[2023-07-18 19:51:33] [config] ulr-query-vectors: ""
[2023-07-18 19:51:33] [config] ulr-softmax-temperature: 1
[2023-07-18 19:51:33] [config] ulr-trainable-transformation: false
[2023-07-18 19:51:33] [config] unlikelihood-loss: false
[2023-07-18 19:51:33] [config] valid-freq: 50000000
[2023-07-18 19:51:33] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 19:51:33] [config] valid-max-length: 1000
[2023-07-18 19:51:33] [config] valid-metrics:
[2023-07-18 19:51:33] [config]   - cross-entropy
[2023-07-18 19:51:33] [config]   - translation
[2023-07-18 19:51:33] [config] valid-mini-batch: 32
[2023-07-18 19:51:33] [config] valid-reset-stalled: false
[2023-07-18 19:51:33] [config] valid-script-args:
[2023-07-18 19:51:33] [config]   []
[2023-07-18 19:51:33] [config] valid-script-path: ""
[2023-07-18 19:51:33] [config] valid-sets:
[2023-07-18 19:51:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 19:51:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 19:51:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 19:51:33] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 19:51:33] [config] vocabs:
[2023-07-18 19:51:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 19:51:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 19:51:33] [config] word-penalty: 0
[2023-07-18 19:51:33] [config] word-scores: false
[2023-07-18 19:51:33] [config] workspace: 5500
[2023-07-18 19:51:33] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 19:51:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 19:51:33] [training] Using single-device training
[2023-07-18 19:51:40] Synced seed 1234
[2023-07-18 19:51:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 19:51:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 19:51:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 19:51:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 19:51:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 19:51:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 19:51:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 19:51:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 19:51:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 19:51:42] [comm] Using global sharding
[2023-07-18 19:51:42] [comm] NCCLCommunicators constructed successfully
[2023-07-18 19:51:42] [training] Using 1 GPUs
[2023-07-18 19:51:42] [logits] Applying loss function for 1 factor(s)
[2023-07-18 19:51:42] [memory] Reserving 80 MB, device gpu0
[2023-07-18 19:51:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 19:51:43] [memory] Reserving 80 MB, device gpu0
[2023-07-18 20:16:43] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 20:16:43] [valid] No post-processing script given for validating translator
[2023-07-18 20:16:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 20:16:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 20:16:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 20:16:43] [comm] Using global sharding
[2023-07-18 20:16:44] [comm] NCCLCommunicators constructed successfully
[2023-07-18 20:16:44] [training] Using 1 GPUs
[2023-07-18 20:16:44] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 20:16:48] Allocating memory for general optimizer shards
[2023-07-18 20:16:48] [memory] Reserving 322 MB, device gpu0
[2023-07-18 20:16:48] Loading Adam parameters
[2023-07-18 20:16:48] [memory] Reserving 322 MB, device gpu0
[2023-07-18 20:16:48] [memory] Reserving 80 MB, device gpu0
[2023-07-18 20:16:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 20:16:49] [data] Restoring the corpus state to epoch 111, batch 4198
[2023-07-18 20:16:49] [data] Shuffling data
[2023-07-18 20:16:49] [data] Done reading 20,192 sentences
[2023-07-18 20:16:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:16:49] Training started
[2023-07-18 20:16:49] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 20:16:49] [memory] Reserving 80 MB, device gpu0
[2023-07-18 20:16:53] Parameter type float16, optimization type float32, casting types true
[2023-07-18 20:20:28] Seen 20,192 samples
[2023-07-18 20:20:28] Starting data epoch 112 in logical epoch 112
[2023-07-18 20:20:28] [data] Shuffling data
[2023-07-18 20:20:28] [data] Done reading 20,192 sentences
[2023-07-18 20:20:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:24:18] Seen 20,192 samples
[2023-07-18 20:24:18] Starting data epoch 113 in logical epoch 113
[2023-07-18 20:24:18] [data] Shuffling data
[2023-07-18 20:24:18] [data] Done reading 20,192 sentences
[2023-07-18 20:24:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:28:09] Seen 20,192 samples
[2023-07-18 20:28:09] Starting data epoch 114 in logical epoch 114
[2023-07-18 20:28:09] [data] Shuffling data
[2023-07-18 20:28:09] [data] Done reading 20,192 sentences
[2023-07-18 20:28:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:32:05] Seen 20,192 samples
[2023-07-18 20:32:05] Starting data epoch 115 in logical epoch 115
[2023-07-18 20:32:05] [data] Shuffling data
[2023-07-18 20:32:05] [data] Done reading 20,192 sentences
[2023-07-18 20:32:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:35:57] Seen 20,192 samples
[2023-07-18 20:35:57] Starting data epoch 116 in logical epoch 116
[2023-07-18 20:35:57] [data] Shuffling data
[2023-07-18 20:35:57] [data] Done reading 20,192 sentences
[2023-07-18 20:35:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:39:48] Seen 20,192 samples
[2023-07-18 20:39:48] Starting data epoch 117 in logical epoch 117
[2023-07-18 20:39:48] [data] Shuffling data
[2023-07-18 20:39:48] [data] Done reading 20,192 sentences
[2023-07-18 20:39:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:43:47] Seen 20,192 samples
[2023-07-18 20:43:47] Starting data epoch 118 in logical epoch 118
[2023-07-18 20:43:47] [data] Shuffling data
[2023-07-18 20:43:47] [data] Done reading 20,192 sentences
[2023-07-18 20:43:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:47:47] Seen 20,192 samples
[2023-07-18 20:47:47] Starting data epoch 119 in logical epoch 119
[2023-07-18 20:47:47] [data] Shuffling data
[2023-07-18 20:47:47] [data] Done reading 20,192 sentences
[2023-07-18 20:47:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:51:40] Seen 20,192 samples
[2023-07-18 20:51:40] Starting data epoch 120 in logical epoch 120
[2023-07-18 20:51:40] [data] Shuffling data
[2023-07-18 20:51:40] [data] Done reading 20,192 sentences
[2023-07-18 20:51:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 20:55:31] Seen 20,192 samples
[2023-07-18 20:55:31] Starting data epoch 121 in logical epoch 121
[2023-07-18 20:55:31] Training finished
[2023-07-18 20:55:42] [valid] Ep. 121 : Up. 4578 : cross-entropy : 127.123 : new best
[2023-07-18 20:57:36] [valid] Ep. 121 : Up. 4578 : translation : 0 : new best
[2023-07-18 20:57:36] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 20:57:38] Saving Adam parameters
[2023-07-18 20:57:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 20:57:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 20:57:47] [marian] Running on node22.datos.cluster.uy as process 7935 with command line:
[2023-07-18 20:57:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 20:57:47] [config] after: 0e
[2023-07-18 20:57:47] [config] after-batches: 0
[2023-07-18 20:57:47] [config] after-epochs: 130
[2023-07-18 20:57:47] [config] all-caps-every: 0
[2023-07-18 20:57:47] [config] allow-unk: false
[2023-07-18 20:57:47] [config] authors: false
[2023-07-18 20:57:47] [config] beam-size: 12
[2023-07-18 20:57:47] [config] bert-class-symbol: "[CLS]"
[2023-07-18 20:57:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 20:57:47] [config] bert-masking-fraction: 0.15
[2023-07-18 20:57:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 20:57:47] [config] bert-train-type-embeddings: true
[2023-07-18 20:57:47] [config] bert-type-vocab-size: 2
[2023-07-18 20:57:47] [config] build-info: ""
[2023-07-18 20:57:47] [config] check-gradient-nan: false
[2023-07-18 20:57:47] [config] check-nan: false
[2023-07-18 20:57:47] [config] cite: false
[2023-07-18 20:57:47] [config] clip-norm: 1
[2023-07-18 20:57:47] [config] cost-scaling:
[2023-07-18 20:57:47] [config]   - 256.f
[2023-07-18 20:57:47] [config]   - 1000
[2023-07-18 20:57:47] [config]   - 2.f
[2023-07-18 20:57:47] [config]   - 256.f
[2023-07-18 20:57:47] [config] cost-type: ce-sum
[2023-07-18 20:57:47] [config] cpu-threads: 0
[2023-07-18 20:57:47] [config] data-threads: 8
[2023-07-18 20:57:47] [config] data-weighting: ""
[2023-07-18 20:57:47] [config] data-weighting-type: sentence
[2023-07-18 20:57:47] [config] dec-cell: gru
[2023-07-18 20:57:47] [config] dec-cell-base-depth: 2
[2023-07-18 20:57:47] [config] dec-cell-high-depth: 1
[2023-07-18 20:57:47] [config] dec-depth: 1
[2023-07-18 20:57:47] [config] devices:
[2023-07-18 20:57:47] [config]   - 0
[2023-07-18 20:57:47] [config] dim-emb: 512
[2023-07-18 20:57:47] [config] dim-rnn: 1024
[2023-07-18 20:57:47] [config] dim-vocabs:
[2023-07-18 20:57:47] [config]   - 16384
[2023-07-18 20:57:47] [config]   - 16384
[2023-07-18 20:57:47] [config] disp-first: 0
[2023-07-18 20:57:47] [config] disp-freq: 1000u
[2023-07-18 20:57:47] [config] disp-label-counts: true
[2023-07-18 20:57:47] [config] dropout-rnn: 0
[2023-07-18 20:57:47] [config] dropout-src: 0
[2023-07-18 20:57:47] [config] dropout-trg: 0
[2023-07-18 20:57:47] [config] dump-config: ""
[2023-07-18 20:57:47] [config] dynamic-gradient-scaling:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] early-stopping: 200
[2023-07-18 20:57:47] [config] early-stopping-on: first
[2023-07-18 20:57:47] [config] embedding-fix-src: false
[2023-07-18 20:57:47] [config] embedding-fix-trg: false
[2023-07-18 20:57:47] [config] embedding-normalization: false
[2023-07-18 20:57:47] [config] embedding-vectors:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] enc-cell: gru
[2023-07-18 20:57:47] [config] enc-cell-depth: 1
[2023-07-18 20:57:47] [config] enc-depth: 1
[2023-07-18 20:57:47] [config] enc-type: bidirectional
[2023-07-18 20:57:47] [config] english-title-case-every: 0
[2023-07-18 20:57:47] [config] exponential-smoothing: 0
[2023-07-18 20:57:47] [config] factor-weight: 1
[2023-07-18 20:57:47] [config] factors-combine: sum
[2023-07-18 20:57:47] [config] factors-dim-emb: 0
[2023-07-18 20:57:47] [config] gradient-checkpointing: false
[2023-07-18 20:57:47] [config] gradient-norm-average-window: 100
[2023-07-18 20:57:47] [config] guided-alignment: none
[2023-07-18 20:57:47] [config] guided-alignment-cost: mse
[2023-07-18 20:57:47] [config] guided-alignment-weight: 0.1
[2023-07-18 20:57:47] [config] ignore-model-config: false
[2023-07-18 20:57:47] [config] input-types:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] interpolate-env-vars: false
[2023-07-18 20:57:47] [config] keep-best: false
[2023-07-18 20:57:47] [config] label-smoothing: 0
[2023-07-18 20:57:47] [config] layer-normalization: false
[2023-07-18 20:57:47] [config] learn-rate: 0.0001
[2023-07-18 20:57:47] [config] lemma-dependency: ""
[2023-07-18 20:57:47] [config] lemma-dim-emb: 0
[2023-07-18 20:57:47] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 20:57:47] [config] log-level: info
[2023-07-18 20:57:47] [config] log-time-zone: ""
[2023-07-18 20:57:47] [config] logical-epoch:
[2023-07-18 20:57:47] [config]   - 1e
[2023-07-18 20:57:47] [config]   - 0
[2023-07-18 20:57:47] [config] lr-decay: 0
[2023-07-18 20:57:47] [config] lr-decay-freq: 50000
[2023-07-18 20:57:47] [config] lr-decay-inv-sqrt:
[2023-07-18 20:57:47] [config]   - 0
[2023-07-18 20:57:47] [config] lr-decay-repeat-warmup: false
[2023-07-18 20:57:47] [config] lr-decay-reset-optimizer: false
[2023-07-18 20:57:47] [config] lr-decay-start:
[2023-07-18 20:57:47] [config]   - 10
[2023-07-18 20:57:47] [config]   - 1
[2023-07-18 20:57:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 20:57:47] [config] lr-report: false
[2023-07-18 20:57:47] [config] lr-warmup: 0
[2023-07-18 20:57:47] [config] lr-warmup-at-reload: false
[2023-07-18 20:57:47] [config] lr-warmup-cycle: false
[2023-07-18 20:57:47] [config] lr-warmup-start-rate: 0
[2023-07-18 20:57:47] [config] max-length: 150
[2023-07-18 20:57:47] [config] max-length-crop: true
[2023-07-18 20:57:47] [config] max-length-factor: 3
[2023-07-18 20:57:47] [config] maxi-batch: 100
[2023-07-18 20:57:47] [config] maxi-batch-sort: trg
[2023-07-18 20:57:47] [config] mini-batch: 64
[2023-07-18 20:57:47] [config] mini-batch-fit: true
[2023-07-18 20:57:47] [config] mini-batch-fit-step: 10
[2023-07-18 20:57:47] [config] mini-batch-round-up: true
[2023-07-18 20:57:47] [config] mini-batch-track-lr: false
[2023-07-18 20:57:47] [config] mini-batch-warmup: 0
[2023-07-18 20:57:47] [config] mini-batch-words: 0
[2023-07-18 20:57:47] [config] mini-batch-words-ref: 0
[2023-07-18 20:57:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 20:57:47] [config] multi-loss-type: sum
[2023-07-18 20:57:47] [config] n-best: false
[2023-07-18 20:57:47] [config] no-nccl: false
[2023-07-18 20:57:47] [config] no-reload: false
[2023-07-18 20:57:47] [config] no-restore-corpus: false
[2023-07-18 20:57:47] [config] normalize: 0
[2023-07-18 20:57:47] [config] normalize-gradient: false
[2023-07-18 20:57:47] [config] num-devices: 0
[2023-07-18 20:57:47] [config] optimizer: adam
[2023-07-18 20:57:47] [config] optimizer-delay: 1
[2023-07-18 20:57:47] [config] optimizer-params:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] output-omit-bias: false
[2023-07-18 20:57:47] [config] overwrite: true
[2023-07-18 20:57:47] [config] precision:
[2023-07-18 20:57:47] [config]   - float16
[2023-07-18 20:57:47] [config]   - float32
[2023-07-18 20:57:47] [config] pretrained-model: ""
[2023-07-18 20:57:47] [config] quantize-biases: false
[2023-07-18 20:57:47] [config] quantize-bits: 0
[2023-07-18 20:57:47] [config] quantize-log-based: false
[2023-07-18 20:57:47] [config] quantize-optimization-steps: 0
[2023-07-18 20:57:47] [config] quiet: false
[2023-07-18 20:57:47] [config] quiet-translation: true
[2023-07-18 20:57:47] [config] relative-paths: false
[2023-07-18 20:57:47] [config] right-left: false
[2023-07-18 20:57:47] [config] save-freq: 10000u
[2023-07-18 20:57:47] [config] seed: 1234
[2023-07-18 20:57:47] [config] sentencepiece-alphas:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] sentencepiece-max-lines: 2000000
[2023-07-18 20:57:47] [config] sentencepiece-options: ""
[2023-07-18 20:57:47] [config] sharding: global
[2023-07-18 20:57:47] [config] shuffle: data
[2023-07-18 20:57:47] [config] shuffle-in-ram: false
[2023-07-18 20:57:47] [config] sigterm: save-and-exit
[2023-07-18 20:57:47] [config] skip: false
[2023-07-18 20:57:47] [config] sqlite: ""
[2023-07-18 20:57:47] [config] sqlite-drop: false
[2023-07-18 20:57:47] [config] sync-freq: 200u
[2023-07-18 20:57:47] [config] sync-sgd: false
[2023-07-18 20:57:47] [config] tempdir: /tmp
[2023-07-18 20:57:47] [config] tied-embeddings: false
[2023-07-18 20:57:47] [config] tied-embeddings-all: true
[2023-07-18 20:57:47] [config] tied-embeddings-src: false
[2023-07-18 20:57:47] [config] train-embedder-rank:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] train-sets:
[2023-07-18 20:57:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 20:57:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 20:57:47] [config] transformer-aan-activation: swish
[2023-07-18 20:57:47] [config] transformer-aan-depth: 2
[2023-07-18 20:57:47] [config] transformer-aan-nogate: false
[2023-07-18 20:57:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 20:57:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 20:57:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 20:57:47] [config] transformer-depth-scaling: false
[2023-07-18 20:57:47] [config] transformer-dim-aan: 2048
[2023-07-18 20:57:47] [config] transformer-dim-ffn: 2048
[2023-07-18 20:57:47] [config] transformer-dropout: 0
[2023-07-18 20:57:47] [config] transformer-dropout-attention: 0
[2023-07-18 20:57:47] [config] transformer-dropout-ffn: 0
[2023-07-18 20:57:47] [config] transformer-ffn-activation: swish
[2023-07-18 20:57:47] [config] transformer-ffn-depth: 2
[2023-07-18 20:57:47] [config] transformer-guided-alignment-layer: last
[2023-07-18 20:57:47] [config] transformer-heads: 8
[2023-07-18 20:57:47] [config] transformer-no-projection: false
[2023-07-18 20:57:47] [config] transformer-pool: false
[2023-07-18 20:57:47] [config] transformer-postprocess: dan
[2023-07-18 20:57:47] [config] transformer-postprocess-emb: d
[2023-07-18 20:57:47] [config] transformer-postprocess-top: ""
[2023-07-18 20:57:47] [config] transformer-preprocess: ""
[2023-07-18 20:57:47] [config] transformer-tied-layers:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] transformer-train-position-embeddings: false
[2023-07-18 20:57:47] [config] tsv: false
[2023-07-18 20:57:47] [config] tsv-fields: 0
[2023-07-18 20:57:47] [config] type: amun
[2023-07-18 20:57:47] [config] ulr: false
[2023-07-18 20:57:47] [config] ulr-dim-emb: 0
[2023-07-18 20:57:47] [config] ulr-dropout: 0
[2023-07-18 20:57:47] [config] ulr-keys-vectors: ""
[2023-07-18 20:57:47] [config] ulr-query-vectors: ""
[2023-07-18 20:57:47] [config] ulr-softmax-temperature: 1
[2023-07-18 20:57:47] [config] ulr-trainable-transformation: false
[2023-07-18 20:57:47] [config] unlikelihood-loss: false
[2023-07-18 20:57:47] [config] valid-freq: 50000000
[2023-07-18 20:57:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 20:57:47] [config] valid-max-length: 1000
[2023-07-18 20:57:47] [config] valid-metrics:
[2023-07-18 20:57:47] [config]   - cross-entropy
[2023-07-18 20:57:47] [config]   - translation
[2023-07-18 20:57:47] [config] valid-mini-batch: 32
[2023-07-18 20:57:47] [config] valid-reset-stalled: false
[2023-07-18 20:57:47] [config] valid-script-args:
[2023-07-18 20:57:47] [config]   []
[2023-07-18 20:57:47] [config] valid-script-path: ""
[2023-07-18 20:57:47] [config] valid-sets:
[2023-07-18 20:57:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 20:57:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 20:57:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 20:57:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 20:57:47] [config] vocabs:
[2023-07-18 20:57:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 20:57:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 20:57:47] [config] word-penalty: 0
[2023-07-18 20:57:47] [config] word-scores: false
[2023-07-18 20:57:47] [config] workspace: 5500
[2023-07-18 20:57:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 20:57:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 20:57:47] [training] Using single-device training
[2023-07-18 20:57:52] Synced seed 1234
[2023-07-18 20:57:52] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 20:57:52] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 20:57:52] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 20:57:52] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 20:57:52] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 20:57:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 20:57:52] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 20:57:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 20:57:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 20:57:53] [comm] Using global sharding
[2023-07-18 20:57:53] [comm] NCCLCommunicators constructed successfully
[2023-07-18 20:57:53] [training] Using 1 GPUs
[2023-07-18 20:57:53] [logits] Applying loss function for 1 factor(s)
[2023-07-18 20:57:53] [memory] Reserving 80 MB, device gpu0
[2023-07-18 20:57:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 20:57:54] [memory] Reserving 80 MB, device gpu0
[2023-07-18 21:23:43] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 21:23:43] [valid] No post-processing script given for validating translator
[2023-07-18 21:23:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 21:23:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 21:23:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 21:23:43] [comm] Using global sharding
[2023-07-18 21:23:43] [comm] NCCLCommunicators constructed successfully
[2023-07-18 21:23:43] [training] Using 1 GPUs
[2023-07-18 21:23:43] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 21:23:49] Allocating memory for general optimizer shards
[2023-07-18 21:23:49] [memory] Reserving 322 MB, device gpu0
[2023-07-18 21:23:49] Loading Adam parameters
[2023-07-18 21:23:50] [memory] Reserving 322 MB, device gpu0
[2023-07-18 21:23:50] [memory] Reserving 80 MB, device gpu0
[2023-07-18 21:23:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 21:23:50] [data] Restoring the corpus state to epoch 121, batch 4578
[2023-07-18 21:23:50] [data] Shuffling data
[2023-07-18 21:23:50] [data] Done reading 20,192 sentences
[2023-07-18 21:23:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:23:50] Training started
[2023-07-18 21:23:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 21:23:51] [memory] Reserving 80 MB, device gpu0
[2023-07-18 21:23:57] Parameter type float16, optimization type float32, casting types true
[2023-07-18 21:27:36] Seen 20,192 samples
[2023-07-18 21:27:36] Starting data epoch 122 in logical epoch 122
[2023-07-18 21:27:36] [data] Shuffling data
[2023-07-18 21:27:36] [data] Done reading 20,192 sentences
[2023-07-18 21:27:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:31:31] Seen 20,192 samples
[2023-07-18 21:31:31] Starting data epoch 123 in logical epoch 123
[2023-07-18 21:31:31] [data] Shuffling data
[2023-07-18 21:31:31] [data] Done reading 20,192 sentences
[2023-07-18 21:31:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:35:23] Seen 20,192 samples
[2023-07-18 21:35:23] Starting data epoch 124 in logical epoch 124
[2023-07-18 21:35:23] [data] Shuffling data
[2023-07-18 21:35:23] [data] Done reading 20,192 sentences
[2023-07-18 21:35:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:39:18] Seen 20,192 samples
[2023-07-18 21:39:18] Starting data epoch 125 in logical epoch 125
[2023-07-18 21:39:18] [data] Shuffling data
[2023-07-18 21:39:18] [data] Done reading 20,192 sentences
[2023-07-18 21:39:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:43:15] Seen 20,192 samples
[2023-07-18 21:43:15] Starting data epoch 126 in logical epoch 126
[2023-07-18 21:43:15] [data] Shuffling data
[2023-07-18 21:43:15] [data] Done reading 20,192 sentences
[2023-07-18 21:43:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:47:07] Seen 20,192 samples
[2023-07-18 21:47:07] Starting data epoch 127 in logical epoch 127
[2023-07-18 21:47:07] [data] Shuffling data
[2023-07-18 21:47:07] [data] Done reading 20,192 sentences
[2023-07-18 21:47:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:51:01] Seen 20,192 samples
[2023-07-18 21:51:01] Starting data epoch 128 in logical epoch 128
[2023-07-18 21:51:01] [data] Shuffling data
[2023-07-18 21:51:01] [data] Done reading 20,192 sentences
[2023-07-18 21:51:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:54:58] Seen 20,192 samples
[2023-07-18 21:54:58] Starting data epoch 129 in logical epoch 129
[2023-07-18 21:54:58] [data] Shuffling data
[2023-07-18 21:54:58] [data] Done reading 20,192 sentences
[2023-07-18 21:54:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 21:58:48] Seen 20,192 samples
[2023-07-18 21:58:48] Starting data epoch 130 in logical epoch 130
[2023-07-18 21:58:48] [data] Shuffling data
[2023-07-18 21:58:48] [data] Done reading 20,192 sentences
[2023-07-18 21:58:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:02:46] Seen 20,192 samples
[2023-07-18 22:02:46] Starting data epoch 131 in logical epoch 131
[2023-07-18 22:02:46] Training finished
[2023-07-18 22:02:57] [valid] Ep. 131 : Up. 4961 : cross-entropy : 125.728 : new best
[2023-07-18 22:04:55] [valid] Ep. 131 : Up. 4961 : translation : 0 : new best
[2023-07-18 22:04:55] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 22:04:58] Saving Adam parameters
[2023-07-18 22:04:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 22:05:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 22:05:07] [marian] Running on node22.datos.cluster.uy as process 12199 with command line:
[2023-07-18 22:05:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 22:05:07] [config] after: 0e
[2023-07-18 22:05:07] [config] after-batches: 0
[2023-07-18 22:05:07] [config] after-epochs: 140
[2023-07-18 22:05:07] [config] all-caps-every: 0
[2023-07-18 22:05:07] [config] allow-unk: false
[2023-07-18 22:05:07] [config] authors: false
[2023-07-18 22:05:07] [config] beam-size: 12
[2023-07-18 22:05:07] [config] bert-class-symbol: "[CLS]"
[2023-07-18 22:05:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 22:05:07] [config] bert-masking-fraction: 0.15
[2023-07-18 22:05:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 22:05:07] [config] bert-train-type-embeddings: true
[2023-07-18 22:05:07] [config] bert-type-vocab-size: 2
[2023-07-18 22:05:07] [config] build-info: ""
[2023-07-18 22:05:07] [config] check-gradient-nan: false
[2023-07-18 22:05:07] [config] check-nan: false
[2023-07-18 22:05:07] [config] cite: false
[2023-07-18 22:05:07] [config] clip-norm: 1
[2023-07-18 22:05:07] [config] cost-scaling:
[2023-07-18 22:05:07] [config]   - 256.f
[2023-07-18 22:05:07] [config]   - 1000
[2023-07-18 22:05:07] [config]   - 2.f
[2023-07-18 22:05:07] [config]   - 256.f
[2023-07-18 22:05:07] [config] cost-type: ce-sum
[2023-07-18 22:05:07] [config] cpu-threads: 0
[2023-07-18 22:05:07] [config] data-threads: 8
[2023-07-18 22:05:07] [config] data-weighting: ""
[2023-07-18 22:05:07] [config] data-weighting-type: sentence
[2023-07-18 22:05:07] [config] dec-cell: gru
[2023-07-18 22:05:07] [config] dec-cell-base-depth: 2
[2023-07-18 22:05:07] [config] dec-cell-high-depth: 1
[2023-07-18 22:05:07] [config] dec-depth: 1
[2023-07-18 22:05:07] [config] devices:
[2023-07-18 22:05:07] [config]   - 0
[2023-07-18 22:05:07] [config] dim-emb: 512
[2023-07-18 22:05:07] [config] dim-rnn: 1024
[2023-07-18 22:05:07] [config] dim-vocabs:
[2023-07-18 22:05:07] [config]   - 16384
[2023-07-18 22:05:07] [config]   - 16384
[2023-07-18 22:05:07] [config] disp-first: 0
[2023-07-18 22:05:07] [config] disp-freq: 1000u
[2023-07-18 22:05:07] [config] disp-label-counts: true
[2023-07-18 22:05:07] [config] dropout-rnn: 0
[2023-07-18 22:05:07] [config] dropout-src: 0
[2023-07-18 22:05:07] [config] dropout-trg: 0
[2023-07-18 22:05:07] [config] dump-config: ""
[2023-07-18 22:05:07] [config] dynamic-gradient-scaling:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] early-stopping: 200
[2023-07-18 22:05:07] [config] early-stopping-on: first
[2023-07-18 22:05:07] [config] embedding-fix-src: false
[2023-07-18 22:05:07] [config] embedding-fix-trg: false
[2023-07-18 22:05:07] [config] embedding-normalization: false
[2023-07-18 22:05:07] [config] embedding-vectors:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] enc-cell: gru
[2023-07-18 22:05:07] [config] enc-cell-depth: 1
[2023-07-18 22:05:07] [config] enc-depth: 1
[2023-07-18 22:05:07] [config] enc-type: bidirectional
[2023-07-18 22:05:07] [config] english-title-case-every: 0
[2023-07-18 22:05:07] [config] exponential-smoothing: 0
[2023-07-18 22:05:07] [config] factor-weight: 1
[2023-07-18 22:05:07] [config] factors-combine: sum
[2023-07-18 22:05:07] [config] factors-dim-emb: 0
[2023-07-18 22:05:07] [config] gradient-checkpointing: false
[2023-07-18 22:05:07] [config] gradient-norm-average-window: 100
[2023-07-18 22:05:07] [config] guided-alignment: none
[2023-07-18 22:05:07] [config] guided-alignment-cost: mse
[2023-07-18 22:05:07] [config] guided-alignment-weight: 0.1
[2023-07-18 22:05:07] [config] ignore-model-config: false
[2023-07-18 22:05:07] [config] input-types:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] interpolate-env-vars: false
[2023-07-18 22:05:07] [config] keep-best: false
[2023-07-18 22:05:07] [config] label-smoothing: 0
[2023-07-18 22:05:07] [config] layer-normalization: false
[2023-07-18 22:05:07] [config] learn-rate: 0.0001
[2023-07-18 22:05:07] [config] lemma-dependency: ""
[2023-07-18 22:05:07] [config] lemma-dim-emb: 0
[2023-07-18 22:05:07] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 22:05:07] [config] log-level: info
[2023-07-18 22:05:07] [config] log-time-zone: ""
[2023-07-18 22:05:07] [config] logical-epoch:
[2023-07-18 22:05:07] [config]   - 1e
[2023-07-18 22:05:07] [config]   - 0
[2023-07-18 22:05:07] [config] lr-decay: 0
[2023-07-18 22:05:07] [config] lr-decay-freq: 50000
[2023-07-18 22:05:07] [config] lr-decay-inv-sqrt:
[2023-07-18 22:05:07] [config]   - 0
[2023-07-18 22:05:07] [config] lr-decay-repeat-warmup: false
[2023-07-18 22:05:07] [config] lr-decay-reset-optimizer: false
[2023-07-18 22:05:07] [config] lr-decay-start:
[2023-07-18 22:05:07] [config]   - 10
[2023-07-18 22:05:07] [config]   - 1
[2023-07-18 22:05:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 22:05:07] [config] lr-report: false
[2023-07-18 22:05:07] [config] lr-warmup: 0
[2023-07-18 22:05:07] [config] lr-warmup-at-reload: false
[2023-07-18 22:05:07] [config] lr-warmup-cycle: false
[2023-07-18 22:05:07] [config] lr-warmup-start-rate: 0
[2023-07-18 22:05:07] [config] max-length: 150
[2023-07-18 22:05:07] [config] max-length-crop: true
[2023-07-18 22:05:07] [config] max-length-factor: 3
[2023-07-18 22:05:07] [config] maxi-batch: 100
[2023-07-18 22:05:07] [config] maxi-batch-sort: trg
[2023-07-18 22:05:07] [config] mini-batch: 64
[2023-07-18 22:05:07] [config] mini-batch-fit: true
[2023-07-18 22:05:07] [config] mini-batch-fit-step: 10
[2023-07-18 22:05:07] [config] mini-batch-round-up: true
[2023-07-18 22:05:07] [config] mini-batch-track-lr: false
[2023-07-18 22:05:07] [config] mini-batch-warmup: 0
[2023-07-18 22:05:07] [config] mini-batch-words: 0
[2023-07-18 22:05:07] [config] mini-batch-words-ref: 0
[2023-07-18 22:05:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 22:05:07] [config] multi-loss-type: sum
[2023-07-18 22:05:07] [config] n-best: false
[2023-07-18 22:05:07] [config] no-nccl: false
[2023-07-18 22:05:07] [config] no-reload: false
[2023-07-18 22:05:07] [config] no-restore-corpus: false
[2023-07-18 22:05:07] [config] normalize: 0
[2023-07-18 22:05:07] [config] normalize-gradient: false
[2023-07-18 22:05:07] [config] num-devices: 0
[2023-07-18 22:05:07] [config] optimizer: adam
[2023-07-18 22:05:07] [config] optimizer-delay: 1
[2023-07-18 22:05:07] [config] optimizer-params:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] output-omit-bias: false
[2023-07-18 22:05:07] [config] overwrite: true
[2023-07-18 22:05:07] [config] precision:
[2023-07-18 22:05:07] [config]   - float16
[2023-07-18 22:05:07] [config]   - float32
[2023-07-18 22:05:07] [config] pretrained-model: ""
[2023-07-18 22:05:07] [config] quantize-biases: false
[2023-07-18 22:05:07] [config] quantize-bits: 0
[2023-07-18 22:05:07] [config] quantize-log-based: false
[2023-07-18 22:05:07] [config] quantize-optimization-steps: 0
[2023-07-18 22:05:07] [config] quiet: false
[2023-07-18 22:05:07] [config] quiet-translation: true
[2023-07-18 22:05:07] [config] relative-paths: false
[2023-07-18 22:05:07] [config] right-left: false
[2023-07-18 22:05:07] [config] save-freq: 10000u
[2023-07-18 22:05:07] [config] seed: 1234
[2023-07-18 22:05:07] [config] sentencepiece-alphas:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] sentencepiece-max-lines: 2000000
[2023-07-18 22:05:07] [config] sentencepiece-options: ""
[2023-07-18 22:05:07] [config] sharding: global
[2023-07-18 22:05:07] [config] shuffle: data
[2023-07-18 22:05:07] [config] shuffle-in-ram: false
[2023-07-18 22:05:07] [config] sigterm: save-and-exit
[2023-07-18 22:05:07] [config] skip: false
[2023-07-18 22:05:07] [config] sqlite: ""
[2023-07-18 22:05:07] [config] sqlite-drop: false
[2023-07-18 22:05:07] [config] sync-freq: 200u
[2023-07-18 22:05:07] [config] sync-sgd: false
[2023-07-18 22:05:07] [config] tempdir: /tmp
[2023-07-18 22:05:07] [config] tied-embeddings: false
[2023-07-18 22:05:07] [config] tied-embeddings-all: true
[2023-07-18 22:05:07] [config] tied-embeddings-src: false
[2023-07-18 22:05:07] [config] train-embedder-rank:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] train-sets:
[2023-07-18 22:05:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 22:05:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 22:05:07] [config] transformer-aan-activation: swish
[2023-07-18 22:05:07] [config] transformer-aan-depth: 2
[2023-07-18 22:05:07] [config] transformer-aan-nogate: false
[2023-07-18 22:05:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 22:05:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 22:05:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 22:05:07] [config] transformer-depth-scaling: false
[2023-07-18 22:05:07] [config] transformer-dim-aan: 2048
[2023-07-18 22:05:07] [config] transformer-dim-ffn: 2048
[2023-07-18 22:05:07] [config] transformer-dropout: 0
[2023-07-18 22:05:07] [config] transformer-dropout-attention: 0
[2023-07-18 22:05:07] [config] transformer-dropout-ffn: 0
[2023-07-18 22:05:07] [config] transformer-ffn-activation: swish
[2023-07-18 22:05:07] [config] transformer-ffn-depth: 2
[2023-07-18 22:05:07] [config] transformer-guided-alignment-layer: last
[2023-07-18 22:05:07] [config] transformer-heads: 8
[2023-07-18 22:05:07] [config] transformer-no-projection: false
[2023-07-18 22:05:07] [config] transformer-pool: false
[2023-07-18 22:05:07] [config] transformer-postprocess: dan
[2023-07-18 22:05:07] [config] transformer-postprocess-emb: d
[2023-07-18 22:05:07] [config] transformer-postprocess-top: ""
[2023-07-18 22:05:07] [config] transformer-preprocess: ""
[2023-07-18 22:05:07] [config] transformer-tied-layers:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] transformer-train-position-embeddings: false
[2023-07-18 22:05:07] [config] tsv: false
[2023-07-18 22:05:07] [config] tsv-fields: 0
[2023-07-18 22:05:07] [config] type: amun
[2023-07-18 22:05:07] [config] ulr: false
[2023-07-18 22:05:07] [config] ulr-dim-emb: 0
[2023-07-18 22:05:07] [config] ulr-dropout: 0
[2023-07-18 22:05:07] [config] ulr-keys-vectors: ""
[2023-07-18 22:05:07] [config] ulr-query-vectors: ""
[2023-07-18 22:05:07] [config] ulr-softmax-temperature: 1
[2023-07-18 22:05:07] [config] ulr-trainable-transformation: false
[2023-07-18 22:05:07] [config] unlikelihood-loss: false
[2023-07-18 22:05:07] [config] valid-freq: 50000000
[2023-07-18 22:05:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 22:05:07] [config] valid-max-length: 1000
[2023-07-18 22:05:07] [config] valid-metrics:
[2023-07-18 22:05:07] [config]   - cross-entropy
[2023-07-18 22:05:07] [config]   - translation
[2023-07-18 22:05:07] [config] valid-mini-batch: 32
[2023-07-18 22:05:07] [config] valid-reset-stalled: false
[2023-07-18 22:05:07] [config] valid-script-args:
[2023-07-18 22:05:07] [config]   []
[2023-07-18 22:05:07] [config] valid-script-path: ""
[2023-07-18 22:05:07] [config] valid-sets:
[2023-07-18 22:05:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 22:05:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 22:05:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 22:05:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 22:05:07] [config] vocabs:
[2023-07-18 22:05:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 22:05:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 22:05:07] [config] word-penalty: 0
[2023-07-18 22:05:07] [config] word-scores: false
[2023-07-18 22:05:07] [config] workspace: 5500
[2023-07-18 22:05:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 22:05:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 22:05:07] [training] Using single-device training
[2023-07-18 22:05:11] Synced seed 1234
[2023-07-18 22:05:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 22:05:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 22:05:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 22:05:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 22:05:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 22:05:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 22:05:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 22:05:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 22:05:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 22:05:12] [comm] Using global sharding
[2023-07-18 22:05:13] [comm] NCCLCommunicators constructed successfully
[2023-07-18 22:05:13] [training] Using 1 GPUs
[2023-07-18 22:05:13] [logits] Applying loss function for 1 factor(s)
[2023-07-18 22:05:13] [memory] Reserving 80 MB, device gpu0
[2023-07-18 22:05:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 22:05:13] [memory] Reserving 80 MB, device gpu0
[2023-07-18 22:30:33] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 22:30:33] [valid] No post-processing script given for validating translator
[2023-07-18 22:30:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 22:30:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 22:30:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 22:30:33] [comm] Using global sharding
[2023-07-18 22:30:33] [comm] NCCLCommunicators constructed successfully
[2023-07-18 22:30:33] [training] Using 1 GPUs
[2023-07-18 22:30:33] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 22:30:40] Allocating memory for general optimizer shards
[2023-07-18 22:30:40] [memory] Reserving 322 MB, device gpu0
[2023-07-18 22:30:40] Loading Adam parameters
[2023-07-18 22:30:40] [memory] Reserving 322 MB, device gpu0
[2023-07-18 22:30:40] [memory] Reserving 80 MB, device gpu0
[2023-07-18 22:30:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 22:30:40] [data] Restoring the corpus state to epoch 131, batch 4961
[2023-07-18 22:30:40] [data] Shuffling data
[2023-07-18 22:30:40] [data] Done reading 20,192 sentences
[2023-07-18 22:30:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:30:41] Training started
[2023-07-18 22:30:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 22:30:41] [memory] Reserving 80 MB, device gpu0
[2023-07-18 22:30:46] Parameter type float16, optimization type float32, casting types true
[2023-07-18 22:34:06] Seen 20,192 samples
[2023-07-18 22:34:06] Starting data epoch 132 in logical epoch 132
[2023-07-18 22:34:06] [data] Shuffling data
[2023-07-18 22:34:06] [data] Done reading 20,192 sentences
[2023-07-18 22:34:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:34:19] Ep. 132 : Up. 5000 : Sen. 239 : Cost 3.27235603 * 16,264,419 @ 20,764 after 81,245,349 : Time 226.47s : 71818.57 words/s : gNorm 1.2959
[2023-07-18 22:37:47] Seen 20,192 samples
[2023-07-18 22:37:47] Starting data epoch 133 in logical epoch 133
[2023-07-18 22:37:47] [data] Shuffling data
[2023-07-18 22:37:47] [data] Done reading 20,192 sentences
[2023-07-18 22:37:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:41:34] Seen 20,192 samples
[2023-07-18 22:41:34] Starting data epoch 134 in logical epoch 134
[2023-07-18 22:41:34] [data] Shuffling data
[2023-07-18 22:41:34] [data] Done reading 20,192 sentences
[2023-07-18 22:41:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:45:28] Seen 20,192 samples
[2023-07-18 22:45:28] Starting data epoch 135 in logical epoch 135
[2023-07-18 22:45:28] [data] Shuffling data
[2023-07-18 22:45:29] [data] Done reading 20,192 sentences
[2023-07-18 22:45:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:49:16] Seen 20,192 samples
[2023-07-18 22:49:16] Starting data epoch 136 in logical epoch 136
[2023-07-18 22:49:16] [data] Shuffling data
[2023-07-18 22:49:16] [data] Done reading 20,192 sentences
[2023-07-18 22:49:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:53:08] Seen 20,192 samples
[2023-07-18 22:53:08] Starting data epoch 137 in logical epoch 137
[2023-07-18 22:53:08] [data] Shuffling data
[2023-07-18 22:53:08] [data] Done reading 20,192 sentences
[2023-07-18 22:53:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 22:56:55] Seen 20,192 samples
[2023-07-18 22:56:55] Starting data epoch 138 in logical epoch 138
[2023-07-18 22:56:55] [data] Shuffling data
[2023-07-18 22:56:55] [data] Done reading 20,192 sentences
[2023-07-18 22:56:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:00:37] Seen 20,192 samples
[2023-07-18 23:00:37] Starting data epoch 139 in logical epoch 139
[2023-07-18 23:00:37] [data] Shuffling data
[2023-07-18 23:00:37] [data] Done reading 20,192 sentences
[2023-07-18 23:00:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:04:26] Seen 20,192 samples
[2023-07-18 23:04:26] Starting data epoch 140 in logical epoch 140
[2023-07-18 23:04:26] [data] Shuffling data
[2023-07-18 23:04:26] [data] Done reading 20,192 sentences
[2023-07-18 23:04:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:08:15] Seen 20,192 samples
[2023-07-18 23:08:15] Starting data epoch 141 in logical epoch 141
[2023-07-18 23:08:15] Training finished
[2023-07-18 23:08:26] [valid] Ep. 141 : Up. 5340 : cross-entropy : 125.066 : new best
[2023-07-18 23:10:19] [valid] Ep. 141 : Up. 5340 : translation : 0 : new best
[2023-07-18 23:10:19] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 23:10:22] Saving Adam parameters
[2023-07-18 23:10:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 23:10:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 23:10:31] [marian] Running on node22.datos.cluster.uy as process 16338 with command line:
[2023-07-18 23:10:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-18 23:10:31] [config] after: 0e
[2023-07-18 23:10:31] [config] after-batches: 0
[2023-07-18 23:10:31] [config] after-epochs: 150
[2023-07-18 23:10:31] [config] all-caps-every: 0
[2023-07-18 23:10:31] [config] allow-unk: false
[2023-07-18 23:10:31] [config] authors: false
[2023-07-18 23:10:31] [config] beam-size: 12
[2023-07-18 23:10:31] [config] bert-class-symbol: "[CLS]"
[2023-07-18 23:10:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-18 23:10:31] [config] bert-masking-fraction: 0.15
[2023-07-18 23:10:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-18 23:10:31] [config] bert-train-type-embeddings: true
[2023-07-18 23:10:31] [config] bert-type-vocab-size: 2
[2023-07-18 23:10:31] [config] build-info: ""
[2023-07-18 23:10:31] [config] check-gradient-nan: false
[2023-07-18 23:10:31] [config] check-nan: false
[2023-07-18 23:10:31] [config] cite: false
[2023-07-18 23:10:31] [config] clip-norm: 1
[2023-07-18 23:10:31] [config] cost-scaling:
[2023-07-18 23:10:31] [config]   - 256.f
[2023-07-18 23:10:31] [config]   - 1000
[2023-07-18 23:10:31] [config]   - 2.f
[2023-07-18 23:10:31] [config]   - 256.f
[2023-07-18 23:10:31] [config] cost-type: ce-sum
[2023-07-18 23:10:31] [config] cpu-threads: 0
[2023-07-18 23:10:31] [config] data-threads: 8
[2023-07-18 23:10:31] [config] data-weighting: ""
[2023-07-18 23:10:31] [config] data-weighting-type: sentence
[2023-07-18 23:10:31] [config] dec-cell: gru
[2023-07-18 23:10:31] [config] dec-cell-base-depth: 2
[2023-07-18 23:10:31] [config] dec-cell-high-depth: 1
[2023-07-18 23:10:31] [config] dec-depth: 1
[2023-07-18 23:10:31] [config] devices:
[2023-07-18 23:10:31] [config]   - 0
[2023-07-18 23:10:31] [config] dim-emb: 512
[2023-07-18 23:10:31] [config] dim-rnn: 1024
[2023-07-18 23:10:31] [config] dim-vocabs:
[2023-07-18 23:10:31] [config]   - 16384
[2023-07-18 23:10:31] [config]   - 16384
[2023-07-18 23:10:31] [config] disp-first: 0
[2023-07-18 23:10:31] [config] disp-freq: 1000u
[2023-07-18 23:10:31] [config] disp-label-counts: true
[2023-07-18 23:10:31] [config] dropout-rnn: 0
[2023-07-18 23:10:31] [config] dropout-src: 0
[2023-07-18 23:10:31] [config] dropout-trg: 0
[2023-07-18 23:10:31] [config] dump-config: ""
[2023-07-18 23:10:31] [config] dynamic-gradient-scaling:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] early-stopping: 200
[2023-07-18 23:10:31] [config] early-stopping-on: first
[2023-07-18 23:10:31] [config] embedding-fix-src: false
[2023-07-18 23:10:31] [config] embedding-fix-trg: false
[2023-07-18 23:10:31] [config] embedding-normalization: false
[2023-07-18 23:10:31] [config] embedding-vectors:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] enc-cell: gru
[2023-07-18 23:10:31] [config] enc-cell-depth: 1
[2023-07-18 23:10:31] [config] enc-depth: 1
[2023-07-18 23:10:31] [config] enc-type: bidirectional
[2023-07-18 23:10:31] [config] english-title-case-every: 0
[2023-07-18 23:10:31] [config] exponential-smoothing: 0
[2023-07-18 23:10:31] [config] factor-weight: 1
[2023-07-18 23:10:31] [config] factors-combine: sum
[2023-07-18 23:10:31] [config] factors-dim-emb: 0
[2023-07-18 23:10:31] [config] gradient-checkpointing: false
[2023-07-18 23:10:31] [config] gradient-norm-average-window: 100
[2023-07-18 23:10:31] [config] guided-alignment: none
[2023-07-18 23:10:31] [config] guided-alignment-cost: mse
[2023-07-18 23:10:31] [config] guided-alignment-weight: 0.1
[2023-07-18 23:10:31] [config] ignore-model-config: false
[2023-07-18 23:10:31] [config] input-types:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] interpolate-env-vars: false
[2023-07-18 23:10:31] [config] keep-best: false
[2023-07-18 23:10:31] [config] label-smoothing: 0
[2023-07-18 23:10:31] [config] layer-normalization: false
[2023-07-18 23:10:31] [config] learn-rate: 0.0001
[2023-07-18 23:10:31] [config] lemma-dependency: ""
[2023-07-18 23:10:31] [config] lemma-dim-emb: 0
[2023-07-18 23:10:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 23:10:31] [config] log-level: info
[2023-07-18 23:10:31] [config] log-time-zone: ""
[2023-07-18 23:10:31] [config] logical-epoch:
[2023-07-18 23:10:31] [config]   - 1e
[2023-07-18 23:10:31] [config]   - 0
[2023-07-18 23:10:31] [config] lr-decay: 0
[2023-07-18 23:10:31] [config] lr-decay-freq: 50000
[2023-07-18 23:10:31] [config] lr-decay-inv-sqrt:
[2023-07-18 23:10:31] [config]   - 0
[2023-07-18 23:10:31] [config] lr-decay-repeat-warmup: false
[2023-07-18 23:10:31] [config] lr-decay-reset-optimizer: false
[2023-07-18 23:10:31] [config] lr-decay-start:
[2023-07-18 23:10:31] [config]   - 10
[2023-07-18 23:10:31] [config]   - 1
[2023-07-18 23:10:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-18 23:10:31] [config] lr-report: false
[2023-07-18 23:10:31] [config] lr-warmup: 0
[2023-07-18 23:10:31] [config] lr-warmup-at-reload: false
[2023-07-18 23:10:31] [config] lr-warmup-cycle: false
[2023-07-18 23:10:31] [config] lr-warmup-start-rate: 0
[2023-07-18 23:10:31] [config] max-length: 150
[2023-07-18 23:10:31] [config] max-length-crop: true
[2023-07-18 23:10:31] [config] max-length-factor: 3
[2023-07-18 23:10:31] [config] maxi-batch: 100
[2023-07-18 23:10:31] [config] maxi-batch-sort: trg
[2023-07-18 23:10:31] [config] mini-batch: 64
[2023-07-18 23:10:31] [config] mini-batch-fit: true
[2023-07-18 23:10:31] [config] mini-batch-fit-step: 10
[2023-07-18 23:10:31] [config] mini-batch-round-up: true
[2023-07-18 23:10:31] [config] mini-batch-track-lr: false
[2023-07-18 23:10:31] [config] mini-batch-warmup: 0
[2023-07-18 23:10:31] [config] mini-batch-words: 0
[2023-07-18 23:10:31] [config] mini-batch-words-ref: 0
[2023-07-18 23:10:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 23:10:31] [config] multi-loss-type: sum
[2023-07-18 23:10:31] [config] n-best: false
[2023-07-18 23:10:31] [config] no-nccl: false
[2023-07-18 23:10:31] [config] no-reload: false
[2023-07-18 23:10:31] [config] no-restore-corpus: false
[2023-07-18 23:10:31] [config] normalize: 0
[2023-07-18 23:10:31] [config] normalize-gradient: false
[2023-07-18 23:10:31] [config] num-devices: 0
[2023-07-18 23:10:31] [config] optimizer: adam
[2023-07-18 23:10:31] [config] optimizer-delay: 1
[2023-07-18 23:10:31] [config] optimizer-params:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] output-omit-bias: false
[2023-07-18 23:10:31] [config] overwrite: true
[2023-07-18 23:10:31] [config] precision:
[2023-07-18 23:10:31] [config]   - float16
[2023-07-18 23:10:31] [config]   - float32
[2023-07-18 23:10:31] [config] pretrained-model: ""
[2023-07-18 23:10:31] [config] quantize-biases: false
[2023-07-18 23:10:31] [config] quantize-bits: 0
[2023-07-18 23:10:31] [config] quantize-log-based: false
[2023-07-18 23:10:31] [config] quantize-optimization-steps: 0
[2023-07-18 23:10:31] [config] quiet: false
[2023-07-18 23:10:31] [config] quiet-translation: true
[2023-07-18 23:10:31] [config] relative-paths: false
[2023-07-18 23:10:31] [config] right-left: false
[2023-07-18 23:10:31] [config] save-freq: 10000u
[2023-07-18 23:10:31] [config] seed: 1234
[2023-07-18 23:10:31] [config] sentencepiece-alphas:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] sentencepiece-max-lines: 2000000
[2023-07-18 23:10:31] [config] sentencepiece-options: ""
[2023-07-18 23:10:31] [config] sharding: global
[2023-07-18 23:10:31] [config] shuffle: data
[2023-07-18 23:10:31] [config] shuffle-in-ram: false
[2023-07-18 23:10:31] [config] sigterm: save-and-exit
[2023-07-18 23:10:31] [config] skip: false
[2023-07-18 23:10:31] [config] sqlite: ""
[2023-07-18 23:10:31] [config] sqlite-drop: false
[2023-07-18 23:10:31] [config] sync-freq: 200u
[2023-07-18 23:10:31] [config] sync-sgd: false
[2023-07-18 23:10:31] [config] tempdir: /tmp
[2023-07-18 23:10:31] [config] tied-embeddings: false
[2023-07-18 23:10:31] [config] tied-embeddings-all: true
[2023-07-18 23:10:31] [config] tied-embeddings-src: false
[2023-07-18 23:10:31] [config] train-embedder-rank:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] train-sets:
[2023-07-18 23:10:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-18 23:10:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-18 23:10:31] [config] transformer-aan-activation: swish
[2023-07-18 23:10:31] [config] transformer-aan-depth: 2
[2023-07-18 23:10:31] [config] transformer-aan-nogate: false
[2023-07-18 23:10:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-18 23:10:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-18 23:10:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-18 23:10:31] [config] transformer-depth-scaling: false
[2023-07-18 23:10:31] [config] transformer-dim-aan: 2048
[2023-07-18 23:10:31] [config] transformer-dim-ffn: 2048
[2023-07-18 23:10:31] [config] transformer-dropout: 0
[2023-07-18 23:10:31] [config] transformer-dropout-attention: 0
[2023-07-18 23:10:31] [config] transformer-dropout-ffn: 0
[2023-07-18 23:10:31] [config] transformer-ffn-activation: swish
[2023-07-18 23:10:31] [config] transformer-ffn-depth: 2
[2023-07-18 23:10:31] [config] transformer-guided-alignment-layer: last
[2023-07-18 23:10:31] [config] transformer-heads: 8
[2023-07-18 23:10:31] [config] transformer-no-projection: false
[2023-07-18 23:10:31] [config] transformer-pool: false
[2023-07-18 23:10:31] [config] transformer-postprocess: dan
[2023-07-18 23:10:31] [config] transformer-postprocess-emb: d
[2023-07-18 23:10:31] [config] transformer-postprocess-top: ""
[2023-07-18 23:10:31] [config] transformer-preprocess: ""
[2023-07-18 23:10:31] [config] transformer-tied-layers:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] transformer-train-position-embeddings: false
[2023-07-18 23:10:31] [config] tsv: false
[2023-07-18 23:10:31] [config] tsv-fields: 0
[2023-07-18 23:10:31] [config] type: amun
[2023-07-18 23:10:31] [config] ulr: false
[2023-07-18 23:10:31] [config] ulr-dim-emb: 0
[2023-07-18 23:10:31] [config] ulr-dropout: 0
[2023-07-18 23:10:31] [config] ulr-keys-vectors: ""
[2023-07-18 23:10:31] [config] ulr-query-vectors: ""
[2023-07-18 23:10:31] [config] ulr-softmax-temperature: 1
[2023-07-18 23:10:31] [config] ulr-trainable-transformation: false
[2023-07-18 23:10:31] [config] unlikelihood-loss: false
[2023-07-18 23:10:31] [config] valid-freq: 50000000
[2023-07-18 23:10:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-18 23:10:31] [config] valid-max-length: 1000
[2023-07-18 23:10:31] [config] valid-metrics:
[2023-07-18 23:10:31] [config]   - cross-entropy
[2023-07-18 23:10:31] [config]   - translation
[2023-07-18 23:10:31] [config] valid-mini-batch: 32
[2023-07-18 23:10:31] [config] valid-reset-stalled: false
[2023-07-18 23:10:31] [config] valid-script-args:
[2023-07-18 23:10:31] [config]   []
[2023-07-18 23:10:31] [config] valid-script-path: ""
[2023-07-18 23:10:31] [config] valid-sets:
[2023-07-18 23:10:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-18 23:10:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-18 23:10:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-18 23:10:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 23:10:31] [config] vocabs:
[2023-07-18 23:10:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 23:10:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 23:10:31] [config] word-penalty: 0
[2023-07-18 23:10:31] [config] word-scores: false
[2023-07-18 23:10:31] [config] workspace: 5500
[2023-07-18 23:10:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-18 23:10:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 23:10:31] [training] Using single-device training
[2023-07-18 23:10:33] Synced seed 1234
[2023-07-18 23:10:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-18 23:10:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-18 23:10:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-18 23:10:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-18 23:10:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-18 23:10:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 23:10:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-18 23:10:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 23:10:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 23:10:35] [comm] Using global sharding
[2023-07-18 23:10:35] [comm] NCCLCommunicators constructed successfully
[2023-07-18 23:10:35] [training] Using 1 GPUs
[2023-07-18 23:10:35] [logits] Applying loss function for 1 factor(s)
[2023-07-18 23:10:35] [memory] Reserving 80 MB, device gpu0
[2023-07-18 23:10:35] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-18 23:10:35] [memory] Reserving 80 MB, device gpu0
[2023-07-18 23:36:36] [batching] Done. Typical MB size is 35,978 target words
[2023-07-18 23:36:36] [valid] No post-processing script given for validating translator
[2023-07-18 23:36:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-18 23:36:36] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-18 23:36:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-18 23:36:36] [comm] Using global sharding
[2023-07-18 23:36:36] [comm] NCCLCommunicators constructed successfully
[2023-07-18 23:36:36] [training] Using 1 GPUs
[2023-07-18 23:36:36] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-18 23:36:41] Allocating memory for general optimizer shards
[2023-07-18 23:36:41] [memory] Reserving 322 MB, device gpu0
[2023-07-18 23:36:42] Loading Adam parameters
[2023-07-18 23:36:42] [memory] Reserving 322 MB, device gpu0
[2023-07-18 23:36:42] [memory] Reserving 80 MB, device gpu0
[2023-07-18 23:36:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-18 23:36:42] [data] Restoring the corpus state to epoch 141, batch 5340
[2023-07-18 23:36:42] [data] Shuffling data
[2023-07-18 23:36:42] [data] Done reading 20,192 sentences
[2023-07-18 23:36:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:36:42] Training started
[2023-07-18 23:36:42] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-18 23:36:43] [memory] Reserving 80 MB, device gpu0
[2023-07-18 23:36:46] Parameter type float16, optimization type float32, casting types true
[2023-07-18 23:40:34] Seen 20,192 samples
[2023-07-18 23:40:34] Starting data epoch 142 in logical epoch 142
[2023-07-18 23:40:34] [data] Shuffling data
[2023-07-18 23:40:34] [data] Done reading 20,192 sentences
[2023-07-18 23:40:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:44:25] Seen 20,192 samples
[2023-07-18 23:44:25] Starting data epoch 143 in logical epoch 143
[2023-07-18 23:44:25] [data] Shuffling data
[2023-07-18 23:44:25] [data] Done reading 20,192 sentences
[2023-07-18 23:44:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:48:15] Seen 20,192 samples
[2023-07-18 23:48:15] Starting data epoch 144 in logical epoch 144
[2023-07-18 23:48:15] [data] Shuffling data
[2023-07-18 23:48:15] [data] Done reading 20,192 sentences
[2023-07-18 23:48:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:52:07] Seen 20,192 samples
[2023-07-18 23:52:07] Starting data epoch 145 in logical epoch 145
[2023-07-18 23:52:07] [data] Shuffling data
[2023-07-18 23:52:07] [data] Done reading 20,192 sentences
[2023-07-18 23:52:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-18 23:56:09] Seen 20,192 samples
[2023-07-18 23:56:09] Starting data epoch 146 in logical epoch 146
[2023-07-18 23:56:09] [data] Shuffling data
[2023-07-18 23:56:09] [data] Done reading 20,192 sentences
[2023-07-18 23:56:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:00:03] Seen 20,192 samples
[2023-07-19 00:00:03] Starting data epoch 147 in logical epoch 147
[2023-07-19 00:00:03] [data] Shuffling data
[2023-07-19 00:00:03] [data] Done reading 20,192 sentences
[2023-07-19 00:00:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:03:49] Seen 20,192 samples
[2023-07-19 00:03:49] Starting data epoch 148 in logical epoch 148
[2023-07-19 00:03:49] [data] Shuffling data
[2023-07-19 00:03:49] [data] Done reading 20,192 sentences
[2023-07-19 00:03:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:07:42] Seen 20,192 samples
[2023-07-19 00:07:42] Starting data epoch 149 in logical epoch 149
[2023-07-19 00:07:42] [data] Shuffling data
[2023-07-19 00:07:42] [data] Done reading 20,192 sentences
[2023-07-19 00:07:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:11:39] Seen 20,192 samples
[2023-07-19 00:11:39] Starting data epoch 150 in logical epoch 150
[2023-07-19 00:11:39] [data] Shuffling data
[2023-07-19 00:11:39] [data] Done reading 20,192 sentences
[2023-07-19 00:11:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:15:31] Seen 20,192 samples
[2023-07-19 00:15:31] Starting data epoch 151 in logical epoch 151
[2023-07-19 00:15:31] Training finished
[2023-07-19 00:15:41] [valid] Ep. 151 : Up. 5718 : cross-entropy : 124.182 : new best
[2023-07-19 00:17:43] [valid] Ep. 151 : Up. 5718 : translation : 0 : new best
[2023-07-19 00:17:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 00:17:45] Saving Adam parameters
[2023-07-19 00:17:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 00:17:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 00:17:53] [marian] Running on node22.datos.cluster.uy as process 20583 with command line:
[2023-07-19 00:17:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-19 00:17:53] [config] after: 0e
[2023-07-19 00:17:53] [config] after-batches: 0
[2023-07-19 00:17:53] [config] after-epochs: 160
[2023-07-19 00:17:53] [config] all-caps-every: 0
[2023-07-19 00:17:53] [config] allow-unk: false
[2023-07-19 00:17:53] [config] authors: false
[2023-07-19 00:17:53] [config] beam-size: 12
[2023-07-19 00:17:53] [config] bert-class-symbol: "[CLS]"
[2023-07-19 00:17:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 00:17:53] [config] bert-masking-fraction: 0.15
[2023-07-19 00:17:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 00:17:53] [config] bert-train-type-embeddings: true
[2023-07-19 00:17:53] [config] bert-type-vocab-size: 2
[2023-07-19 00:17:53] [config] build-info: ""
[2023-07-19 00:17:53] [config] check-gradient-nan: false
[2023-07-19 00:17:53] [config] check-nan: false
[2023-07-19 00:17:53] [config] cite: false
[2023-07-19 00:17:53] [config] clip-norm: 1
[2023-07-19 00:17:53] [config] cost-scaling:
[2023-07-19 00:17:53] [config]   - 256.f
[2023-07-19 00:17:53] [config]   - 1000
[2023-07-19 00:17:53] [config]   - 2.f
[2023-07-19 00:17:53] [config]   - 256.f
[2023-07-19 00:17:53] [config] cost-type: ce-sum
[2023-07-19 00:17:53] [config] cpu-threads: 0
[2023-07-19 00:17:53] [config] data-threads: 8
[2023-07-19 00:17:53] [config] data-weighting: ""
[2023-07-19 00:17:53] [config] data-weighting-type: sentence
[2023-07-19 00:17:53] [config] dec-cell: gru
[2023-07-19 00:17:53] [config] dec-cell-base-depth: 2
[2023-07-19 00:17:53] [config] dec-cell-high-depth: 1
[2023-07-19 00:17:53] [config] dec-depth: 1
[2023-07-19 00:17:53] [config] devices:
[2023-07-19 00:17:53] [config]   - 0
[2023-07-19 00:17:53] [config] dim-emb: 512
[2023-07-19 00:17:53] [config] dim-rnn: 1024
[2023-07-19 00:17:53] [config] dim-vocabs:
[2023-07-19 00:17:53] [config]   - 16384
[2023-07-19 00:17:53] [config]   - 16384
[2023-07-19 00:17:53] [config] disp-first: 0
[2023-07-19 00:17:53] [config] disp-freq: 1000u
[2023-07-19 00:17:53] [config] disp-label-counts: true
[2023-07-19 00:17:53] [config] dropout-rnn: 0
[2023-07-19 00:17:53] [config] dropout-src: 0
[2023-07-19 00:17:53] [config] dropout-trg: 0
[2023-07-19 00:17:53] [config] dump-config: ""
[2023-07-19 00:17:53] [config] dynamic-gradient-scaling:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] early-stopping: 200
[2023-07-19 00:17:53] [config] early-stopping-on: first
[2023-07-19 00:17:53] [config] embedding-fix-src: false
[2023-07-19 00:17:53] [config] embedding-fix-trg: false
[2023-07-19 00:17:53] [config] embedding-normalization: false
[2023-07-19 00:17:53] [config] embedding-vectors:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] enc-cell: gru
[2023-07-19 00:17:53] [config] enc-cell-depth: 1
[2023-07-19 00:17:53] [config] enc-depth: 1
[2023-07-19 00:17:53] [config] enc-type: bidirectional
[2023-07-19 00:17:53] [config] english-title-case-every: 0
[2023-07-19 00:17:53] [config] exponential-smoothing: 0
[2023-07-19 00:17:53] [config] factor-weight: 1
[2023-07-19 00:17:53] [config] factors-combine: sum
[2023-07-19 00:17:53] [config] factors-dim-emb: 0
[2023-07-19 00:17:53] [config] gradient-checkpointing: false
[2023-07-19 00:17:53] [config] gradient-norm-average-window: 100
[2023-07-19 00:17:53] [config] guided-alignment: none
[2023-07-19 00:17:53] [config] guided-alignment-cost: mse
[2023-07-19 00:17:53] [config] guided-alignment-weight: 0.1
[2023-07-19 00:17:53] [config] ignore-model-config: false
[2023-07-19 00:17:53] [config] input-types:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] interpolate-env-vars: false
[2023-07-19 00:17:53] [config] keep-best: false
[2023-07-19 00:17:53] [config] label-smoothing: 0
[2023-07-19 00:17:53] [config] layer-normalization: false
[2023-07-19 00:17:53] [config] learn-rate: 0.0001
[2023-07-19 00:17:53] [config] lemma-dependency: ""
[2023-07-19 00:17:53] [config] lemma-dim-emb: 0
[2023-07-19 00:17:53] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 00:17:53] [config] log-level: info
[2023-07-19 00:17:53] [config] log-time-zone: ""
[2023-07-19 00:17:53] [config] logical-epoch:
[2023-07-19 00:17:53] [config]   - 1e
[2023-07-19 00:17:53] [config]   - 0
[2023-07-19 00:17:53] [config] lr-decay: 0
[2023-07-19 00:17:53] [config] lr-decay-freq: 50000
[2023-07-19 00:17:53] [config] lr-decay-inv-sqrt:
[2023-07-19 00:17:53] [config]   - 0
[2023-07-19 00:17:53] [config] lr-decay-repeat-warmup: false
[2023-07-19 00:17:53] [config] lr-decay-reset-optimizer: false
[2023-07-19 00:17:53] [config] lr-decay-start:
[2023-07-19 00:17:53] [config]   - 10
[2023-07-19 00:17:53] [config]   - 1
[2023-07-19 00:17:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 00:17:53] [config] lr-report: false
[2023-07-19 00:17:53] [config] lr-warmup: 0
[2023-07-19 00:17:53] [config] lr-warmup-at-reload: false
[2023-07-19 00:17:53] [config] lr-warmup-cycle: false
[2023-07-19 00:17:53] [config] lr-warmup-start-rate: 0
[2023-07-19 00:17:53] [config] max-length: 150
[2023-07-19 00:17:53] [config] max-length-crop: true
[2023-07-19 00:17:53] [config] max-length-factor: 3
[2023-07-19 00:17:53] [config] maxi-batch: 100
[2023-07-19 00:17:53] [config] maxi-batch-sort: trg
[2023-07-19 00:17:53] [config] mini-batch: 64
[2023-07-19 00:17:53] [config] mini-batch-fit: true
[2023-07-19 00:17:53] [config] mini-batch-fit-step: 10
[2023-07-19 00:17:53] [config] mini-batch-round-up: true
[2023-07-19 00:17:53] [config] mini-batch-track-lr: false
[2023-07-19 00:17:53] [config] mini-batch-warmup: 0
[2023-07-19 00:17:53] [config] mini-batch-words: 0
[2023-07-19 00:17:53] [config] mini-batch-words-ref: 0
[2023-07-19 00:17:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 00:17:53] [config] multi-loss-type: sum
[2023-07-19 00:17:53] [config] n-best: false
[2023-07-19 00:17:53] [config] no-nccl: false
[2023-07-19 00:17:53] [config] no-reload: false
[2023-07-19 00:17:53] [config] no-restore-corpus: false
[2023-07-19 00:17:53] [config] normalize: 0
[2023-07-19 00:17:53] [config] normalize-gradient: false
[2023-07-19 00:17:53] [config] num-devices: 0
[2023-07-19 00:17:53] [config] optimizer: adam
[2023-07-19 00:17:53] [config] optimizer-delay: 1
[2023-07-19 00:17:53] [config] optimizer-params:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] output-omit-bias: false
[2023-07-19 00:17:53] [config] overwrite: true
[2023-07-19 00:17:53] [config] precision:
[2023-07-19 00:17:53] [config]   - float16
[2023-07-19 00:17:53] [config]   - float32
[2023-07-19 00:17:53] [config] pretrained-model: ""
[2023-07-19 00:17:53] [config] quantize-biases: false
[2023-07-19 00:17:53] [config] quantize-bits: 0
[2023-07-19 00:17:53] [config] quantize-log-based: false
[2023-07-19 00:17:53] [config] quantize-optimization-steps: 0
[2023-07-19 00:17:53] [config] quiet: false
[2023-07-19 00:17:53] [config] quiet-translation: true
[2023-07-19 00:17:53] [config] relative-paths: false
[2023-07-19 00:17:53] [config] right-left: false
[2023-07-19 00:17:53] [config] save-freq: 10000u
[2023-07-19 00:17:53] [config] seed: 1234
[2023-07-19 00:17:53] [config] sentencepiece-alphas:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] sentencepiece-max-lines: 2000000
[2023-07-19 00:17:53] [config] sentencepiece-options: ""
[2023-07-19 00:17:53] [config] sharding: global
[2023-07-19 00:17:53] [config] shuffle: data
[2023-07-19 00:17:53] [config] shuffle-in-ram: false
[2023-07-19 00:17:53] [config] sigterm: save-and-exit
[2023-07-19 00:17:53] [config] skip: false
[2023-07-19 00:17:53] [config] sqlite: ""
[2023-07-19 00:17:53] [config] sqlite-drop: false
[2023-07-19 00:17:53] [config] sync-freq: 200u
[2023-07-19 00:17:53] [config] sync-sgd: false
[2023-07-19 00:17:53] [config] tempdir: /tmp
[2023-07-19 00:17:53] [config] tied-embeddings: false
[2023-07-19 00:17:53] [config] tied-embeddings-all: true
[2023-07-19 00:17:53] [config] tied-embeddings-src: false
[2023-07-19 00:17:53] [config] train-embedder-rank:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] train-sets:
[2023-07-19 00:17:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 00:17:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 00:17:53] [config] transformer-aan-activation: swish
[2023-07-19 00:17:53] [config] transformer-aan-depth: 2
[2023-07-19 00:17:53] [config] transformer-aan-nogate: false
[2023-07-19 00:17:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 00:17:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 00:17:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 00:17:53] [config] transformer-depth-scaling: false
[2023-07-19 00:17:53] [config] transformer-dim-aan: 2048
[2023-07-19 00:17:53] [config] transformer-dim-ffn: 2048
[2023-07-19 00:17:53] [config] transformer-dropout: 0
[2023-07-19 00:17:53] [config] transformer-dropout-attention: 0
[2023-07-19 00:17:53] [config] transformer-dropout-ffn: 0
[2023-07-19 00:17:53] [config] transformer-ffn-activation: swish
[2023-07-19 00:17:53] [config] transformer-ffn-depth: 2
[2023-07-19 00:17:53] [config] transformer-guided-alignment-layer: last
[2023-07-19 00:17:53] [config] transformer-heads: 8
[2023-07-19 00:17:53] [config] transformer-no-projection: false
[2023-07-19 00:17:53] [config] transformer-pool: false
[2023-07-19 00:17:53] [config] transformer-postprocess: dan
[2023-07-19 00:17:53] [config] transformer-postprocess-emb: d
[2023-07-19 00:17:53] [config] transformer-postprocess-top: ""
[2023-07-19 00:17:53] [config] transformer-preprocess: ""
[2023-07-19 00:17:53] [config] transformer-tied-layers:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] transformer-train-position-embeddings: false
[2023-07-19 00:17:53] [config] tsv: false
[2023-07-19 00:17:53] [config] tsv-fields: 0
[2023-07-19 00:17:53] [config] type: amun
[2023-07-19 00:17:53] [config] ulr: false
[2023-07-19 00:17:53] [config] ulr-dim-emb: 0
[2023-07-19 00:17:53] [config] ulr-dropout: 0
[2023-07-19 00:17:53] [config] ulr-keys-vectors: ""
[2023-07-19 00:17:53] [config] ulr-query-vectors: ""
[2023-07-19 00:17:53] [config] ulr-softmax-temperature: 1
[2023-07-19 00:17:53] [config] ulr-trainable-transformation: false
[2023-07-19 00:17:53] [config] unlikelihood-loss: false
[2023-07-19 00:17:53] [config] valid-freq: 50000000
[2023-07-19 00:17:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 00:17:53] [config] valid-max-length: 1000
[2023-07-19 00:17:53] [config] valid-metrics:
[2023-07-19 00:17:53] [config]   - cross-entropy
[2023-07-19 00:17:53] [config]   - translation
[2023-07-19 00:17:53] [config] valid-mini-batch: 32
[2023-07-19 00:17:53] [config] valid-reset-stalled: false
[2023-07-19 00:17:53] [config] valid-script-args:
[2023-07-19 00:17:53] [config]   []
[2023-07-19 00:17:53] [config] valid-script-path: ""
[2023-07-19 00:17:53] [config] valid-sets:
[2023-07-19 00:17:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 00:17:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 00:17:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 00:17:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 00:17:53] [config] vocabs:
[2023-07-19 00:17:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 00:17:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 00:17:53] [config] word-penalty: 0
[2023-07-19 00:17:53] [config] word-scores: false
[2023-07-19 00:17:53] [config] workspace: 5500
[2023-07-19 00:17:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 00:17:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 00:17:53] [training] Using single-device training
[2023-07-19 00:17:54] Synced seed 1234
[2023-07-19 00:17:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 00:17:54] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 00:17:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 00:17:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 00:17:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 00:17:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 00:17:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 00:17:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 00:17:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 00:17:56] [comm] Using global sharding
[2023-07-19 00:17:56] [comm] NCCLCommunicators constructed successfully
[2023-07-19 00:17:56] [training] Using 1 GPUs
[2023-07-19 00:17:56] [logits] Applying loss function for 1 factor(s)
[2023-07-19 00:17:56] [memory] Reserving 80 MB, device gpu0
[2023-07-19 00:17:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 00:17:56] [memory] Reserving 80 MB, device gpu0
[2023-07-19 00:43:37] [batching] Done. Typical MB size is 35,978 target words
[2023-07-19 00:43:37] [valid] No post-processing script given for validating translator
[2023-07-19 00:43:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 00:43:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 00:43:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 00:43:37] [comm] Using global sharding
[2023-07-19 00:43:37] [comm] NCCLCommunicators constructed successfully
[2023-07-19 00:43:37] [training] Using 1 GPUs
[2023-07-19 00:43:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 00:43:38] Allocating memory for general optimizer shards
[2023-07-19 00:43:38] [memory] Reserving 322 MB, device gpu0
[2023-07-19 00:43:38] Loading Adam parameters
[2023-07-19 00:43:38] [memory] Reserving 322 MB, device gpu0
[2023-07-19 00:43:38] [memory] Reserving 80 MB, device gpu0
[2023-07-19 00:43:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 00:43:39] [data] Restoring the corpus state to epoch 151, batch 5718
[2023-07-19 00:43:39] [data] Shuffling data
[2023-07-19 00:43:39] [data] Done reading 20,192 sentences
[2023-07-19 00:43:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:43:39] Training started
[2023-07-19 00:43:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 00:43:40] [memory] Reserving 80 MB, device gpu0
[2023-07-19 00:43:45] Parameter type float16, optimization type float32, casting types true
[2023-07-19 00:47:24] Seen 20,192 samples
[2023-07-19 00:47:24] Starting data epoch 152 in logical epoch 152
[2023-07-19 00:47:24] [data] Shuffling data
[2023-07-19 00:47:24] [data] Done reading 20,192 sentences
[2023-07-19 00:47:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:51:09] Seen 20,192 samples
[2023-07-19 00:51:09] Starting data epoch 153 in logical epoch 153
[2023-07-19 00:51:09] [data] Shuffling data
[2023-07-19 00:51:09] [data] Done reading 20,192 sentences
[2023-07-19 00:51:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:54:55] Seen 20,192 samples
[2023-07-19 00:54:55] Starting data epoch 154 in logical epoch 154
[2023-07-19 00:54:55] [data] Shuffling data
[2023-07-19 00:54:55] [data] Done reading 20,192 sentences
[2023-07-19 00:54:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 00:58:40] Seen 20,192 samples
[2023-07-19 00:58:40] Starting data epoch 155 in logical epoch 155
[2023-07-19 00:58:40] [data] Shuffling data
[2023-07-19 00:58:40] [data] Done reading 20,192 sentences
[2023-07-19 00:58:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:02:26] Seen 20,192 samples
[2023-07-19 01:02:26] Starting data epoch 156 in logical epoch 156
[2023-07-19 01:02:26] [data] Shuffling data
[2023-07-19 01:02:26] [data] Done reading 20,192 sentences
[2023-07-19 01:02:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:06:04] Seen 20,192 samples
[2023-07-19 01:06:04] Starting data epoch 157 in logical epoch 157
[2023-07-19 01:06:04] [data] Shuffling data
[2023-07-19 01:06:04] [data] Done reading 20,192 sentences
[2023-07-19 01:06:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:09:43] Seen 20,192 samples
[2023-07-19 01:09:43] Starting data epoch 158 in logical epoch 158
[2023-07-19 01:09:43] [data] Shuffling data
[2023-07-19 01:09:43] [data] Done reading 20,192 sentences
[2023-07-19 01:09:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:11:38] Ep. 158 : Up. 6000 : Sen. 9,842 : Cost 2.77227640 * 16,430,879 @ 18,524 after 97,676,229 : Time 1681.24s : 9773.04 words/s : gNorm 1.4417
[2023-07-19 01:13:25] Seen 20,192 samples
[2023-07-19 01:13:25] Starting data epoch 159 in logical epoch 159
[2023-07-19 01:13:25] [data] Shuffling data
[2023-07-19 01:13:25] [data] Done reading 20,192 sentences
[2023-07-19 01:13:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:17:09] Seen 20,192 samples
[2023-07-19 01:17:09] Starting data epoch 160 in logical epoch 160
[2023-07-19 01:17:09] [data] Shuffling data
[2023-07-19 01:17:09] [data] Done reading 20,192 sentences
[2023-07-19 01:17:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:21:01] Seen 20,192 samples
[2023-07-19 01:21:01] Starting data epoch 161 in logical epoch 161
[2023-07-19 01:21:01] Training finished
[2023-07-19 01:21:11] [valid] Ep. 161 : Up. 6095 : cross-entropy : 123.71 : new best
[2023-07-19 01:23:06] [valid] Ep. 161 : Up. 6095 : translation : 0 : new best
[2023-07-19 01:23:06] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 01:23:09] Saving Adam parameters
[2023-07-19 01:23:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 01:23:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 01:23:16] [marian] Running on node22.datos.cluster.uy as process 24752 with command line:
[2023-07-19 01:23:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-19 01:23:16] [config] after: 0e
[2023-07-19 01:23:16] [config] after-batches: 0
[2023-07-19 01:23:16] [config] after-epochs: 170
[2023-07-19 01:23:16] [config] all-caps-every: 0
[2023-07-19 01:23:16] [config] allow-unk: false
[2023-07-19 01:23:16] [config] authors: false
[2023-07-19 01:23:16] [config] beam-size: 12
[2023-07-19 01:23:16] [config] bert-class-symbol: "[CLS]"
[2023-07-19 01:23:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 01:23:16] [config] bert-masking-fraction: 0.15
[2023-07-19 01:23:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 01:23:16] [config] bert-train-type-embeddings: true
[2023-07-19 01:23:16] [config] bert-type-vocab-size: 2
[2023-07-19 01:23:16] [config] build-info: ""
[2023-07-19 01:23:16] [config] check-gradient-nan: false
[2023-07-19 01:23:16] [config] check-nan: false
[2023-07-19 01:23:16] [config] cite: false
[2023-07-19 01:23:16] [config] clip-norm: 1
[2023-07-19 01:23:16] [config] cost-scaling:
[2023-07-19 01:23:16] [config]   - 256.f
[2023-07-19 01:23:16] [config]   - 1000
[2023-07-19 01:23:16] [config]   - 2.f
[2023-07-19 01:23:16] [config]   - 256.f
[2023-07-19 01:23:16] [config] cost-type: ce-sum
[2023-07-19 01:23:16] [config] cpu-threads: 0
[2023-07-19 01:23:16] [config] data-threads: 8
[2023-07-19 01:23:16] [config] data-weighting: ""
[2023-07-19 01:23:16] [config] data-weighting-type: sentence
[2023-07-19 01:23:16] [config] dec-cell: gru
[2023-07-19 01:23:16] [config] dec-cell-base-depth: 2
[2023-07-19 01:23:16] [config] dec-cell-high-depth: 1
[2023-07-19 01:23:16] [config] dec-depth: 1
[2023-07-19 01:23:16] [config] devices:
[2023-07-19 01:23:16] [config]   - 0
[2023-07-19 01:23:16] [config] dim-emb: 512
[2023-07-19 01:23:16] [config] dim-rnn: 1024
[2023-07-19 01:23:16] [config] dim-vocabs:
[2023-07-19 01:23:16] [config]   - 16384
[2023-07-19 01:23:16] [config]   - 16384
[2023-07-19 01:23:16] [config] disp-first: 0
[2023-07-19 01:23:16] [config] disp-freq: 1000u
[2023-07-19 01:23:16] [config] disp-label-counts: true
[2023-07-19 01:23:16] [config] dropout-rnn: 0
[2023-07-19 01:23:16] [config] dropout-src: 0
[2023-07-19 01:23:16] [config] dropout-trg: 0
[2023-07-19 01:23:16] [config] dump-config: ""
[2023-07-19 01:23:16] [config] dynamic-gradient-scaling:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] early-stopping: 200
[2023-07-19 01:23:16] [config] early-stopping-on: first
[2023-07-19 01:23:16] [config] embedding-fix-src: false
[2023-07-19 01:23:16] [config] embedding-fix-trg: false
[2023-07-19 01:23:16] [config] embedding-normalization: false
[2023-07-19 01:23:16] [config] embedding-vectors:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] enc-cell: gru
[2023-07-19 01:23:16] [config] enc-cell-depth: 1
[2023-07-19 01:23:16] [config] enc-depth: 1
[2023-07-19 01:23:16] [config] enc-type: bidirectional
[2023-07-19 01:23:16] [config] english-title-case-every: 0
[2023-07-19 01:23:16] [config] exponential-smoothing: 0
[2023-07-19 01:23:16] [config] factor-weight: 1
[2023-07-19 01:23:16] [config] factors-combine: sum
[2023-07-19 01:23:16] [config] factors-dim-emb: 0
[2023-07-19 01:23:16] [config] gradient-checkpointing: false
[2023-07-19 01:23:16] [config] gradient-norm-average-window: 100
[2023-07-19 01:23:16] [config] guided-alignment: none
[2023-07-19 01:23:16] [config] guided-alignment-cost: mse
[2023-07-19 01:23:16] [config] guided-alignment-weight: 0.1
[2023-07-19 01:23:16] [config] ignore-model-config: false
[2023-07-19 01:23:16] [config] input-types:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] interpolate-env-vars: false
[2023-07-19 01:23:16] [config] keep-best: false
[2023-07-19 01:23:16] [config] label-smoothing: 0
[2023-07-19 01:23:16] [config] layer-normalization: false
[2023-07-19 01:23:16] [config] learn-rate: 0.0001
[2023-07-19 01:23:16] [config] lemma-dependency: ""
[2023-07-19 01:23:16] [config] lemma-dim-emb: 0
[2023-07-19 01:23:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 01:23:16] [config] log-level: info
[2023-07-19 01:23:16] [config] log-time-zone: ""
[2023-07-19 01:23:16] [config] logical-epoch:
[2023-07-19 01:23:16] [config]   - 1e
[2023-07-19 01:23:16] [config]   - 0
[2023-07-19 01:23:16] [config] lr-decay: 0
[2023-07-19 01:23:16] [config] lr-decay-freq: 50000
[2023-07-19 01:23:16] [config] lr-decay-inv-sqrt:
[2023-07-19 01:23:16] [config]   - 0
[2023-07-19 01:23:16] [config] lr-decay-repeat-warmup: false
[2023-07-19 01:23:16] [config] lr-decay-reset-optimizer: false
[2023-07-19 01:23:16] [config] lr-decay-start:
[2023-07-19 01:23:16] [config]   - 10
[2023-07-19 01:23:16] [config]   - 1
[2023-07-19 01:23:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 01:23:16] [config] lr-report: false
[2023-07-19 01:23:16] [config] lr-warmup: 0
[2023-07-19 01:23:16] [config] lr-warmup-at-reload: false
[2023-07-19 01:23:16] [config] lr-warmup-cycle: false
[2023-07-19 01:23:16] [config] lr-warmup-start-rate: 0
[2023-07-19 01:23:16] [config] max-length: 150
[2023-07-19 01:23:16] [config] max-length-crop: true
[2023-07-19 01:23:16] [config] max-length-factor: 3
[2023-07-19 01:23:16] [config] maxi-batch: 100
[2023-07-19 01:23:16] [config] maxi-batch-sort: trg
[2023-07-19 01:23:16] [config] mini-batch: 64
[2023-07-19 01:23:16] [config] mini-batch-fit: true
[2023-07-19 01:23:16] [config] mini-batch-fit-step: 10
[2023-07-19 01:23:16] [config] mini-batch-round-up: true
[2023-07-19 01:23:16] [config] mini-batch-track-lr: false
[2023-07-19 01:23:16] [config] mini-batch-warmup: 0
[2023-07-19 01:23:16] [config] mini-batch-words: 0
[2023-07-19 01:23:16] [config] mini-batch-words-ref: 0
[2023-07-19 01:23:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 01:23:16] [config] multi-loss-type: sum
[2023-07-19 01:23:16] [config] n-best: false
[2023-07-19 01:23:16] [config] no-nccl: false
[2023-07-19 01:23:16] [config] no-reload: false
[2023-07-19 01:23:16] [config] no-restore-corpus: false
[2023-07-19 01:23:16] [config] normalize: 0
[2023-07-19 01:23:16] [config] normalize-gradient: false
[2023-07-19 01:23:16] [config] num-devices: 0
[2023-07-19 01:23:16] [config] optimizer: adam
[2023-07-19 01:23:16] [config] optimizer-delay: 1
[2023-07-19 01:23:16] [config] optimizer-params:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] output-omit-bias: false
[2023-07-19 01:23:16] [config] overwrite: true
[2023-07-19 01:23:16] [config] precision:
[2023-07-19 01:23:16] [config]   - float16
[2023-07-19 01:23:16] [config]   - float32
[2023-07-19 01:23:16] [config] pretrained-model: ""
[2023-07-19 01:23:16] [config] quantize-biases: false
[2023-07-19 01:23:16] [config] quantize-bits: 0
[2023-07-19 01:23:16] [config] quantize-log-based: false
[2023-07-19 01:23:16] [config] quantize-optimization-steps: 0
[2023-07-19 01:23:16] [config] quiet: false
[2023-07-19 01:23:16] [config] quiet-translation: true
[2023-07-19 01:23:16] [config] relative-paths: false
[2023-07-19 01:23:16] [config] right-left: false
[2023-07-19 01:23:16] [config] save-freq: 10000u
[2023-07-19 01:23:16] [config] seed: 1234
[2023-07-19 01:23:16] [config] sentencepiece-alphas:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] sentencepiece-max-lines: 2000000
[2023-07-19 01:23:16] [config] sentencepiece-options: ""
[2023-07-19 01:23:16] [config] sharding: global
[2023-07-19 01:23:16] [config] shuffle: data
[2023-07-19 01:23:16] [config] shuffle-in-ram: false
[2023-07-19 01:23:16] [config] sigterm: save-and-exit
[2023-07-19 01:23:16] [config] skip: false
[2023-07-19 01:23:16] [config] sqlite: ""
[2023-07-19 01:23:16] [config] sqlite-drop: false
[2023-07-19 01:23:16] [config] sync-freq: 200u
[2023-07-19 01:23:16] [config] sync-sgd: false
[2023-07-19 01:23:16] [config] tempdir: /tmp
[2023-07-19 01:23:16] [config] tied-embeddings: false
[2023-07-19 01:23:16] [config] tied-embeddings-all: true
[2023-07-19 01:23:16] [config] tied-embeddings-src: false
[2023-07-19 01:23:16] [config] train-embedder-rank:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] train-sets:
[2023-07-19 01:23:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 01:23:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 01:23:16] [config] transformer-aan-activation: swish
[2023-07-19 01:23:16] [config] transformer-aan-depth: 2
[2023-07-19 01:23:16] [config] transformer-aan-nogate: false
[2023-07-19 01:23:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 01:23:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 01:23:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 01:23:16] [config] transformer-depth-scaling: false
[2023-07-19 01:23:16] [config] transformer-dim-aan: 2048
[2023-07-19 01:23:16] [config] transformer-dim-ffn: 2048
[2023-07-19 01:23:16] [config] transformer-dropout: 0
[2023-07-19 01:23:16] [config] transformer-dropout-attention: 0
[2023-07-19 01:23:16] [config] transformer-dropout-ffn: 0
[2023-07-19 01:23:16] [config] transformer-ffn-activation: swish
[2023-07-19 01:23:16] [config] transformer-ffn-depth: 2
[2023-07-19 01:23:16] [config] transformer-guided-alignment-layer: last
[2023-07-19 01:23:16] [config] transformer-heads: 8
[2023-07-19 01:23:16] [config] transformer-no-projection: false
[2023-07-19 01:23:16] [config] transformer-pool: false
[2023-07-19 01:23:16] [config] transformer-postprocess: dan
[2023-07-19 01:23:16] [config] transformer-postprocess-emb: d
[2023-07-19 01:23:16] [config] transformer-postprocess-top: ""
[2023-07-19 01:23:16] [config] transformer-preprocess: ""
[2023-07-19 01:23:16] [config] transformer-tied-layers:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] transformer-train-position-embeddings: false
[2023-07-19 01:23:16] [config] tsv: false
[2023-07-19 01:23:16] [config] tsv-fields: 0
[2023-07-19 01:23:16] [config] type: amun
[2023-07-19 01:23:16] [config] ulr: false
[2023-07-19 01:23:16] [config] ulr-dim-emb: 0
[2023-07-19 01:23:16] [config] ulr-dropout: 0
[2023-07-19 01:23:16] [config] ulr-keys-vectors: ""
[2023-07-19 01:23:16] [config] ulr-query-vectors: ""
[2023-07-19 01:23:16] [config] ulr-softmax-temperature: 1
[2023-07-19 01:23:16] [config] ulr-trainable-transformation: false
[2023-07-19 01:23:16] [config] unlikelihood-loss: false
[2023-07-19 01:23:16] [config] valid-freq: 50000000
[2023-07-19 01:23:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 01:23:16] [config] valid-max-length: 1000
[2023-07-19 01:23:16] [config] valid-metrics:
[2023-07-19 01:23:16] [config]   - cross-entropy
[2023-07-19 01:23:16] [config]   - translation
[2023-07-19 01:23:16] [config] valid-mini-batch: 32
[2023-07-19 01:23:16] [config] valid-reset-stalled: false
[2023-07-19 01:23:16] [config] valid-script-args:
[2023-07-19 01:23:16] [config]   []
[2023-07-19 01:23:16] [config] valid-script-path: ""
[2023-07-19 01:23:16] [config] valid-sets:
[2023-07-19 01:23:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 01:23:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 01:23:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 01:23:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 01:23:16] [config] vocabs:
[2023-07-19 01:23:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 01:23:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 01:23:16] [config] word-penalty: 0
[2023-07-19 01:23:16] [config] word-scores: false
[2023-07-19 01:23:16] [config] workspace: 5500
[2023-07-19 01:23:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 01:23:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 01:23:16] [training] Using single-device training
[2023-07-19 01:23:17] Synced seed 1234
[2023-07-19 01:23:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 01:23:17] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 01:23:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 01:23:17] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 01:23:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 01:23:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 01:23:17] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 01:23:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 01:23:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 01:23:18] [comm] Using global sharding
[2023-07-19 01:23:18] [comm] NCCLCommunicators constructed successfully
[2023-07-19 01:23:18] [training] Using 1 GPUs
[2023-07-19 01:23:18] [logits] Applying loss function for 1 factor(s)
[2023-07-19 01:23:18] [memory] Reserving 80 MB, device gpu0
[2023-07-19 01:23:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 01:23:18] [memory] Reserving 80 MB, device gpu0
[2023-07-19 01:49:20] [batching] Done. Typical MB size is 35,978 target words
[2023-07-19 01:49:20] [valid] No post-processing script given for validating translator
[2023-07-19 01:49:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 01:49:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 01:49:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 01:49:20] [comm] Using global sharding
[2023-07-19 01:49:21] [comm] NCCLCommunicators constructed successfully
[2023-07-19 01:49:21] [training] Using 1 GPUs
[2023-07-19 01:49:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 01:49:22] Allocating memory for general optimizer shards
[2023-07-19 01:49:22] [memory] Reserving 322 MB, device gpu0
[2023-07-19 01:49:22] Loading Adam parameters
[2023-07-19 01:49:22] [memory] Reserving 322 MB, device gpu0
[2023-07-19 01:49:22] [memory] Reserving 80 MB, device gpu0
[2023-07-19 01:49:22] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 01:49:22] [data] Restoring the corpus state to epoch 161, batch 6095
[2023-07-19 01:49:22] [data] Shuffling data
[2023-07-19 01:49:22] [data] Done reading 20,192 sentences
[2023-07-19 01:49:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:49:22] Training started
[2023-07-19 01:49:22] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 01:49:23] [memory] Reserving 80 MB, device gpu0
[2023-07-19 01:49:23] Parameter type float16, optimization type float32, casting types true
[2023-07-19 01:53:11] Seen 20,192 samples
[2023-07-19 01:53:11] Starting data epoch 162 in logical epoch 162
[2023-07-19 01:53:11] [data] Shuffling data
[2023-07-19 01:53:11] [data] Done reading 20,192 sentences
[2023-07-19 01:53:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 01:56:38] Seen 20,192 samples
[2023-07-19 01:56:38] Starting data epoch 163 in logical epoch 163
[2023-07-19 01:56:38] [data] Shuffling data
[2023-07-19 01:56:38] [data] Done reading 20,192 sentences
[2023-07-19 01:56:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:00:18] Seen 20,192 samples
[2023-07-19 02:00:18] Starting data epoch 164 in logical epoch 164
[2023-07-19 02:00:18] [data] Shuffling data
[2023-07-19 02:00:18] [data] Done reading 20,192 sentences
[2023-07-19 02:00:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:04:01] Seen 20,192 samples
[2023-07-19 02:04:01] Starting data epoch 165 in logical epoch 165
[2023-07-19 02:04:01] [data] Shuffling data
[2023-07-19 02:04:01] [data] Done reading 20,192 sentences
[2023-07-19 02:04:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:07:42] Seen 20,192 samples
[2023-07-19 02:07:42] Starting data epoch 166 in logical epoch 166
[2023-07-19 02:07:42] [data] Shuffling data
[2023-07-19 02:07:42] [data] Done reading 20,192 sentences
[2023-07-19 02:07:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:11:29] Seen 20,192 samples
[2023-07-19 02:11:29] Starting data epoch 167 in logical epoch 167
[2023-07-19 02:11:29] [data] Shuffling data
[2023-07-19 02:11:29] [data] Done reading 20,192 sentences
[2023-07-19 02:11:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:15:14] Seen 20,192 samples
[2023-07-19 02:15:14] Starting data epoch 168 in logical epoch 168
[2023-07-19 02:15:14] [data] Shuffling data
[2023-07-19 02:15:14] [data] Done reading 20,192 sentences
[2023-07-19 02:15:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:19:00] Seen 20,192 samples
[2023-07-19 02:19:00] Starting data epoch 169 in logical epoch 169
[2023-07-19 02:19:00] [data] Shuffling data
[2023-07-19 02:19:00] [data] Done reading 20,192 sentences
[2023-07-19 02:19:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:22:49] Seen 20,192 samples
[2023-07-19 02:22:49] Starting data epoch 170 in logical epoch 170
[2023-07-19 02:22:49] [data] Shuffling data
[2023-07-19 02:22:49] [data] Done reading 20,192 sentences
[2023-07-19 02:22:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:26:38] Seen 20,192 samples
[2023-07-19 02:26:38] Starting data epoch 171 in logical epoch 171
[2023-07-19 02:26:38] Training finished
[2023-07-19 02:26:50] [valid] Ep. 171 : Up. 6478 : cross-entropy : 124.328 : stalled 1 times (last best: 123.71)
[2023-07-19 02:28:30] [valid] Ep. 171 : Up. 6478 : translation : 0 : new best
[2023-07-19 02:28:30] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 02:28:31] Saving Adam parameters
[2023-07-19 02:28:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 02:28:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 02:28:39] [marian] Running on node22.datos.cluster.uy as process 29228 with command line:
[2023-07-19 02:28:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-19 02:28:39] [config] after: 0e
[2023-07-19 02:28:39] [config] after-batches: 0
[2023-07-19 02:28:39] [config] after-epochs: 180
[2023-07-19 02:28:39] [config] all-caps-every: 0
[2023-07-19 02:28:39] [config] allow-unk: false
[2023-07-19 02:28:39] [config] authors: false
[2023-07-19 02:28:39] [config] beam-size: 12
[2023-07-19 02:28:39] [config] bert-class-symbol: "[CLS]"
[2023-07-19 02:28:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 02:28:39] [config] bert-masking-fraction: 0.15
[2023-07-19 02:28:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 02:28:39] [config] bert-train-type-embeddings: true
[2023-07-19 02:28:39] [config] bert-type-vocab-size: 2
[2023-07-19 02:28:39] [config] build-info: ""
[2023-07-19 02:28:39] [config] check-gradient-nan: false
[2023-07-19 02:28:39] [config] check-nan: false
[2023-07-19 02:28:39] [config] cite: false
[2023-07-19 02:28:39] [config] clip-norm: 1
[2023-07-19 02:28:39] [config] cost-scaling:
[2023-07-19 02:28:39] [config]   - 256.f
[2023-07-19 02:28:39] [config]   - 1000
[2023-07-19 02:28:39] [config]   - 2.f
[2023-07-19 02:28:39] [config]   - 256.f
[2023-07-19 02:28:39] [config] cost-type: ce-sum
[2023-07-19 02:28:39] [config] cpu-threads: 0
[2023-07-19 02:28:39] [config] data-threads: 8
[2023-07-19 02:28:39] [config] data-weighting: ""
[2023-07-19 02:28:39] [config] data-weighting-type: sentence
[2023-07-19 02:28:39] [config] dec-cell: gru
[2023-07-19 02:28:39] [config] dec-cell-base-depth: 2
[2023-07-19 02:28:39] [config] dec-cell-high-depth: 1
[2023-07-19 02:28:39] [config] dec-depth: 1
[2023-07-19 02:28:39] [config] devices:
[2023-07-19 02:28:39] [config]   - 0
[2023-07-19 02:28:39] [config] dim-emb: 512
[2023-07-19 02:28:39] [config] dim-rnn: 1024
[2023-07-19 02:28:39] [config] dim-vocabs:
[2023-07-19 02:28:39] [config]   - 16384
[2023-07-19 02:28:39] [config]   - 16384
[2023-07-19 02:28:39] [config] disp-first: 0
[2023-07-19 02:28:39] [config] disp-freq: 1000u
[2023-07-19 02:28:39] [config] disp-label-counts: true
[2023-07-19 02:28:39] [config] dropout-rnn: 0
[2023-07-19 02:28:39] [config] dropout-src: 0
[2023-07-19 02:28:39] [config] dropout-trg: 0
[2023-07-19 02:28:39] [config] dump-config: ""
[2023-07-19 02:28:39] [config] dynamic-gradient-scaling:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] early-stopping: 200
[2023-07-19 02:28:39] [config] early-stopping-on: first
[2023-07-19 02:28:39] [config] embedding-fix-src: false
[2023-07-19 02:28:39] [config] embedding-fix-trg: false
[2023-07-19 02:28:39] [config] embedding-normalization: false
[2023-07-19 02:28:39] [config] embedding-vectors:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] enc-cell: gru
[2023-07-19 02:28:39] [config] enc-cell-depth: 1
[2023-07-19 02:28:39] [config] enc-depth: 1
[2023-07-19 02:28:39] [config] enc-type: bidirectional
[2023-07-19 02:28:39] [config] english-title-case-every: 0
[2023-07-19 02:28:39] [config] exponential-smoothing: 0
[2023-07-19 02:28:39] [config] factor-weight: 1
[2023-07-19 02:28:39] [config] factors-combine: sum
[2023-07-19 02:28:39] [config] factors-dim-emb: 0
[2023-07-19 02:28:39] [config] gradient-checkpointing: false
[2023-07-19 02:28:39] [config] gradient-norm-average-window: 100
[2023-07-19 02:28:39] [config] guided-alignment: none
[2023-07-19 02:28:39] [config] guided-alignment-cost: mse
[2023-07-19 02:28:39] [config] guided-alignment-weight: 0.1
[2023-07-19 02:28:39] [config] ignore-model-config: false
[2023-07-19 02:28:39] [config] input-types:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] interpolate-env-vars: false
[2023-07-19 02:28:39] [config] keep-best: false
[2023-07-19 02:28:39] [config] label-smoothing: 0
[2023-07-19 02:28:39] [config] layer-normalization: false
[2023-07-19 02:28:39] [config] learn-rate: 0.0001
[2023-07-19 02:28:39] [config] lemma-dependency: ""
[2023-07-19 02:28:39] [config] lemma-dim-emb: 0
[2023-07-19 02:28:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 02:28:39] [config] log-level: info
[2023-07-19 02:28:39] [config] log-time-zone: ""
[2023-07-19 02:28:39] [config] logical-epoch:
[2023-07-19 02:28:39] [config]   - 1e
[2023-07-19 02:28:39] [config]   - 0
[2023-07-19 02:28:39] [config] lr-decay: 0
[2023-07-19 02:28:39] [config] lr-decay-freq: 50000
[2023-07-19 02:28:39] [config] lr-decay-inv-sqrt:
[2023-07-19 02:28:39] [config]   - 0
[2023-07-19 02:28:39] [config] lr-decay-repeat-warmup: false
[2023-07-19 02:28:39] [config] lr-decay-reset-optimizer: false
[2023-07-19 02:28:39] [config] lr-decay-start:
[2023-07-19 02:28:39] [config]   - 10
[2023-07-19 02:28:39] [config]   - 1
[2023-07-19 02:28:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 02:28:39] [config] lr-report: false
[2023-07-19 02:28:39] [config] lr-warmup: 0
[2023-07-19 02:28:39] [config] lr-warmup-at-reload: false
[2023-07-19 02:28:39] [config] lr-warmup-cycle: false
[2023-07-19 02:28:39] [config] lr-warmup-start-rate: 0
[2023-07-19 02:28:39] [config] max-length: 150
[2023-07-19 02:28:39] [config] max-length-crop: true
[2023-07-19 02:28:39] [config] max-length-factor: 3
[2023-07-19 02:28:39] [config] maxi-batch: 100
[2023-07-19 02:28:39] [config] maxi-batch-sort: trg
[2023-07-19 02:28:39] [config] mini-batch: 64
[2023-07-19 02:28:39] [config] mini-batch-fit: true
[2023-07-19 02:28:39] [config] mini-batch-fit-step: 10
[2023-07-19 02:28:39] [config] mini-batch-round-up: true
[2023-07-19 02:28:39] [config] mini-batch-track-lr: false
[2023-07-19 02:28:39] [config] mini-batch-warmup: 0
[2023-07-19 02:28:39] [config] mini-batch-words: 0
[2023-07-19 02:28:39] [config] mini-batch-words-ref: 0
[2023-07-19 02:28:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 02:28:39] [config] multi-loss-type: sum
[2023-07-19 02:28:39] [config] n-best: false
[2023-07-19 02:28:39] [config] no-nccl: false
[2023-07-19 02:28:39] [config] no-reload: false
[2023-07-19 02:28:39] [config] no-restore-corpus: false
[2023-07-19 02:28:39] [config] normalize: 0
[2023-07-19 02:28:39] [config] normalize-gradient: false
[2023-07-19 02:28:39] [config] num-devices: 0
[2023-07-19 02:28:39] [config] optimizer: adam
[2023-07-19 02:28:39] [config] optimizer-delay: 1
[2023-07-19 02:28:39] [config] optimizer-params:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] output-omit-bias: false
[2023-07-19 02:28:39] [config] overwrite: true
[2023-07-19 02:28:39] [config] precision:
[2023-07-19 02:28:39] [config]   - float16
[2023-07-19 02:28:39] [config]   - float32
[2023-07-19 02:28:39] [config] pretrained-model: ""
[2023-07-19 02:28:39] [config] quantize-biases: false
[2023-07-19 02:28:39] [config] quantize-bits: 0
[2023-07-19 02:28:39] [config] quantize-log-based: false
[2023-07-19 02:28:39] [config] quantize-optimization-steps: 0
[2023-07-19 02:28:39] [config] quiet: false
[2023-07-19 02:28:39] [config] quiet-translation: true
[2023-07-19 02:28:39] [config] relative-paths: false
[2023-07-19 02:28:39] [config] right-left: false
[2023-07-19 02:28:39] [config] save-freq: 10000u
[2023-07-19 02:28:39] [config] seed: 1234
[2023-07-19 02:28:39] [config] sentencepiece-alphas:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] sentencepiece-max-lines: 2000000
[2023-07-19 02:28:39] [config] sentencepiece-options: ""
[2023-07-19 02:28:39] [config] sharding: global
[2023-07-19 02:28:39] [config] shuffle: data
[2023-07-19 02:28:39] [config] shuffle-in-ram: false
[2023-07-19 02:28:39] [config] sigterm: save-and-exit
[2023-07-19 02:28:39] [config] skip: false
[2023-07-19 02:28:39] [config] sqlite: ""
[2023-07-19 02:28:39] [config] sqlite-drop: false
[2023-07-19 02:28:39] [config] sync-freq: 200u
[2023-07-19 02:28:39] [config] sync-sgd: false
[2023-07-19 02:28:39] [config] tempdir: /tmp
[2023-07-19 02:28:39] [config] tied-embeddings: false
[2023-07-19 02:28:39] [config] tied-embeddings-all: true
[2023-07-19 02:28:39] [config] tied-embeddings-src: false
[2023-07-19 02:28:39] [config] train-embedder-rank:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] train-sets:
[2023-07-19 02:28:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 02:28:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 02:28:39] [config] transformer-aan-activation: swish
[2023-07-19 02:28:39] [config] transformer-aan-depth: 2
[2023-07-19 02:28:39] [config] transformer-aan-nogate: false
[2023-07-19 02:28:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 02:28:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 02:28:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 02:28:39] [config] transformer-depth-scaling: false
[2023-07-19 02:28:39] [config] transformer-dim-aan: 2048
[2023-07-19 02:28:39] [config] transformer-dim-ffn: 2048
[2023-07-19 02:28:39] [config] transformer-dropout: 0
[2023-07-19 02:28:39] [config] transformer-dropout-attention: 0
[2023-07-19 02:28:39] [config] transformer-dropout-ffn: 0
[2023-07-19 02:28:39] [config] transformer-ffn-activation: swish
[2023-07-19 02:28:39] [config] transformer-ffn-depth: 2
[2023-07-19 02:28:39] [config] transformer-guided-alignment-layer: last
[2023-07-19 02:28:39] [config] transformer-heads: 8
[2023-07-19 02:28:39] [config] transformer-no-projection: false
[2023-07-19 02:28:39] [config] transformer-pool: false
[2023-07-19 02:28:39] [config] transformer-postprocess: dan
[2023-07-19 02:28:39] [config] transformer-postprocess-emb: d
[2023-07-19 02:28:39] [config] transformer-postprocess-top: ""
[2023-07-19 02:28:39] [config] transformer-preprocess: ""
[2023-07-19 02:28:39] [config] transformer-tied-layers:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] transformer-train-position-embeddings: false
[2023-07-19 02:28:39] [config] tsv: false
[2023-07-19 02:28:39] [config] tsv-fields: 0
[2023-07-19 02:28:39] [config] type: amun
[2023-07-19 02:28:39] [config] ulr: false
[2023-07-19 02:28:39] [config] ulr-dim-emb: 0
[2023-07-19 02:28:39] [config] ulr-dropout: 0
[2023-07-19 02:28:39] [config] ulr-keys-vectors: ""
[2023-07-19 02:28:39] [config] ulr-query-vectors: ""
[2023-07-19 02:28:39] [config] ulr-softmax-temperature: 1
[2023-07-19 02:28:39] [config] ulr-trainable-transformation: false
[2023-07-19 02:28:39] [config] unlikelihood-loss: false
[2023-07-19 02:28:39] [config] valid-freq: 50000000
[2023-07-19 02:28:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 02:28:39] [config] valid-max-length: 1000
[2023-07-19 02:28:39] [config] valid-metrics:
[2023-07-19 02:28:39] [config]   - cross-entropy
[2023-07-19 02:28:39] [config]   - translation
[2023-07-19 02:28:39] [config] valid-mini-batch: 32
[2023-07-19 02:28:39] [config] valid-reset-stalled: false
[2023-07-19 02:28:39] [config] valid-script-args:
[2023-07-19 02:28:39] [config]   []
[2023-07-19 02:28:39] [config] valid-script-path: ""
[2023-07-19 02:28:39] [config] valid-sets:
[2023-07-19 02:28:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 02:28:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 02:28:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 02:28:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 02:28:39] [config] vocabs:
[2023-07-19 02:28:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 02:28:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 02:28:39] [config] word-penalty: 0
[2023-07-19 02:28:39] [config] word-scores: false
[2023-07-19 02:28:39] [config] workspace: 5500
[2023-07-19 02:28:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 02:28:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 02:28:39] [training] Using single-device training
[2023-07-19 02:28:39] Synced seed 1234
[2023-07-19 02:28:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 02:28:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 02:28:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 02:28:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 02:28:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 02:28:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 02:28:39] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 02:28:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 02:28:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 02:28:40] [comm] Using global sharding
[2023-07-19 02:28:40] [comm] NCCLCommunicators constructed successfully
[2023-07-19 02:28:40] [training] Using 1 GPUs
[2023-07-19 02:28:40] [logits] Applying loss function for 1 factor(s)
[2023-07-19 02:28:40] [memory] Reserving 80 MB, device gpu0
[2023-07-19 02:28:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 02:28:41] [memory] Reserving 80 MB, device gpu0
[2023-07-19 02:54:46] [batching] Done. Typical MB size is 35,978 target words
[2023-07-19 02:54:46] [valid] No post-processing script given for validating translator
[2023-07-19 02:54:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 02:54:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 02:54:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 02:54:46] [comm] Using global sharding
[2023-07-19 02:54:46] [comm] NCCLCommunicators constructed successfully
[2023-07-19 02:54:46] [training] Using 1 GPUs
[2023-07-19 02:54:46] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 02:54:48] Allocating memory for general optimizer shards
[2023-07-19 02:54:48] [memory] Reserving 322 MB, device gpu0
[2023-07-19 02:54:48] Loading Adam parameters
[2023-07-19 02:54:48] [memory] Reserving 322 MB, device gpu0
[2023-07-19 02:54:48] [memory] Reserving 80 MB, device gpu0
[2023-07-19 02:54:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 02:54:48] [data] Restoring the corpus state to epoch 171, batch 6478
[2023-07-19 02:54:48] [data] Shuffling data
[2023-07-19 02:54:48] [data] Done reading 20,192 sentences
[2023-07-19 02:54:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 02:54:48] Training started
[2023-07-19 02:54:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 02:54:49] [memory] Reserving 80 MB, device gpu0
[2023-07-19 02:54:55] Parameter type float16, optimization type float32, casting types true
[2023-07-19 02:58:24] Seen 20,192 samples
[2023-07-19 02:58:24] Starting data epoch 172 in logical epoch 172
[2023-07-19 02:58:24] [data] Shuffling data
[2023-07-19 02:58:24] [data] Done reading 20,192 sentences
[2023-07-19 02:58:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:02:12] Seen 20,192 samples
[2023-07-19 03:02:12] Starting data epoch 173 in logical epoch 173
[2023-07-19 03:02:12] [data] Shuffling data
[2023-07-19 03:02:12] [data] Done reading 20,192 sentences
[2023-07-19 03:02:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:05:59] Seen 20,192 samples
[2023-07-19 03:05:59] Starting data epoch 174 in logical epoch 174
[2023-07-19 03:05:59] [data] Shuffling data
[2023-07-19 03:05:59] [data] Done reading 20,192 sentences
[2023-07-19 03:05:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:09:46] Seen 20,192 samples
[2023-07-19 03:09:46] Starting data epoch 175 in logical epoch 175
[2023-07-19 03:09:46] [data] Shuffling data
[2023-07-19 03:09:46] [data] Done reading 20,192 sentences
[2023-07-19 03:09:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:13:28] Seen 20,192 samples
[2023-07-19 03:13:28] Starting data epoch 176 in logical epoch 176
[2023-07-19 03:13:28] [data] Shuffling data
[2023-07-19 03:13:28] [data] Done reading 20,192 sentences
[2023-07-19 03:13:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:17:16] Seen 20,192 samples
[2023-07-19 03:17:16] Starting data epoch 177 in logical epoch 177
[2023-07-19 03:17:16] [data] Shuffling data
[2023-07-19 03:17:16] [data] Done reading 20,192 sentences
[2023-07-19 03:17:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:21:04] Seen 20,192 samples
[2023-07-19 03:21:04] Starting data epoch 178 in logical epoch 178
[2023-07-19 03:21:04] [data] Shuffling data
[2023-07-19 03:21:04] [data] Done reading 20,192 sentences
[2023-07-19 03:21:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:24:46] Seen 20,192 samples
[2023-07-19 03:24:46] Starting data epoch 179 in logical epoch 179
[2023-07-19 03:24:46] [data] Shuffling data
[2023-07-19 03:24:46] [data] Done reading 20,192 sentences
[2023-07-19 03:24:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:28:21] Seen 20,192 samples
[2023-07-19 03:28:21] Starting data epoch 180 in logical epoch 180
[2023-07-19 03:28:21] [data] Shuffling data
[2023-07-19 03:28:21] [data] Done reading 20,192 sentences
[2023-07-19 03:28:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 03:32:00] Seen 20,192 samples
[2023-07-19 03:32:00] Starting data epoch 181 in logical epoch 181
[2023-07-19 03:32:00] Training finished
[2023-07-19 03:32:11] [valid] Ep. 181 : Up. 6862 : cross-entropy : 125.63 : stalled 2 times (last best: 123.71)
[2023-07-19 03:33:59] [valid] Ep. 181 : Up. 6862 : translation : 0 : new best
[2023-07-19 03:33:59] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 03:34:00] Saving Adam parameters
[2023-07-19 03:34:01] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 03:34:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 03:34:08] [marian] Running on node22.datos.cluster.uy as process 33393 with command line:
[2023-07-19 03:34:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-19 03:34:08] [config] after: 0e
[2023-07-19 03:34:08] [config] after-batches: 0
[2023-07-19 03:34:08] [config] after-epochs: 190
[2023-07-19 03:34:08] [config] all-caps-every: 0
[2023-07-19 03:34:08] [config] allow-unk: false
[2023-07-19 03:34:08] [config] authors: false
[2023-07-19 03:34:08] [config] beam-size: 12
[2023-07-19 03:34:08] [config] bert-class-symbol: "[CLS]"
[2023-07-19 03:34:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 03:34:08] [config] bert-masking-fraction: 0.15
[2023-07-19 03:34:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 03:34:08] [config] bert-train-type-embeddings: true
[2023-07-19 03:34:08] [config] bert-type-vocab-size: 2
[2023-07-19 03:34:08] [config] build-info: ""
[2023-07-19 03:34:08] [config] check-gradient-nan: false
[2023-07-19 03:34:08] [config] check-nan: false
[2023-07-19 03:34:08] [config] cite: false
[2023-07-19 03:34:08] [config] clip-norm: 1
[2023-07-19 03:34:08] [config] cost-scaling:
[2023-07-19 03:34:08] [config]   - 256.f
[2023-07-19 03:34:08] [config]   - 1000
[2023-07-19 03:34:08] [config]   - 2.f
[2023-07-19 03:34:08] [config]   - 256.f
[2023-07-19 03:34:08] [config] cost-type: ce-sum
[2023-07-19 03:34:08] [config] cpu-threads: 0
[2023-07-19 03:34:08] [config] data-threads: 8
[2023-07-19 03:34:08] [config] data-weighting: ""
[2023-07-19 03:34:08] [config] data-weighting-type: sentence
[2023-07-19 03:34:08] [config] dec-cell: gru
[2023-07-19 03:34:08] [config] dec-cell-base-depth: 2
[2023-07-19 03:34:08] [config] dec-cell-high-depth: 1
[2023-07-19 03:34:08] [config] dec-depth: 1
[2023-07-19 03:34:08] [config] devices:
[2023-07-19 03:34:08] [config]   - 0
[2023-07-19 03:34:08] [config] dim-emb: 512
[2023-07-19 03:34:08] [config] dim-rnn: 1024
[2023-07-19 03:34:08] [config] dim-vocabs:
[2023-07-19 03:34:08] [config]   - 16384
[2023-07-19 03:34:08] [config]   - 16384
[2023-07-19 03:34:08] [config] disp-first: 0
[2023-07-19 03:34:08] [config] disp-freq: 1000u
[2023-07-19 03:34:08] [config] disp-label-counts: true
[2023-07-19 03:34:08] [config] dropout-rnn: 0
[2023-07-19 03:34:08] [config] dropout-src: 0
[2023-07-19 03:34:08] [config] dropout-trg: 0
[2023-07-19 03:34:08] [config] dump-config: ""
[2023-07-19 03:34:08] [config] dynamic-gradient-scaling:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] early-stopping: 200
[2023-07-19 03:34:08] [config] early-stopping-on: first
[2023-07-19 03:34:08] [config] embedding-fix-src: false
[2023-07-19 03:34:08] [config] embedding-fix-trg: false
[2023-07-19 03:34:08] [config] embedding-normalization: false
[2023-07-19 03:34:08] [config] embedding-vectors:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] enc-cell: gru
[2023-07-19 03:34:08] [config] enc-cell-depth: 1
[2023-07-19 03:34:08] [config] enc-depth: 1
[2023-07-19 03:34:08] [config] enc-type: bidirectional
[2023-07-19 03:34:08] [config] english-title-case-every: 0
[2023-07-19 03:34:08] [config] exponential-smoothing: 0
[2023-07-19 03:34:08] [config] factor-weight: 1
[2023-07-19 03:34:08] [config] factors-combine: sum
[2023-07-19 03:34:08] [config] factors-dim-emb: 0
[2023-07-19 03:34:08] [config] gradient-checkpointing: false
[2023-07-19 03:34:08] [config] gradient-norm-average-window: 100
[2023-07-19 03:34:08] [config] guided-alignment: none
[2023-07-19 03:34:08] [config] guided-alignment-cost: mse
[2023-07-19 03:34:08] [config] guided-alignment-weight: 0.1
[2023-07-19 03:34:08] [config] ignore-model-config: false
[2023-07-19 03:34:08] [config] input-types:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] interpolate-env-vars: false
[2023-07-19 03:34:08] [config] keep-best: false
[2023-07-19 03:34:08] [config] label-smoothing: 0
[2023-07-19 03:34:08] [config] layer-normalization: false
[2023-07-19 03:34:08] [config] learn-rate: 0.0001
[2023-07-19 03:34:08] [config] lemma-dependency: ""
[2023-07-19 03:34:08] [config] lemma-dim-emb: 0
[2023-07-19 03:34:08] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 03:34:08] [config] log-level: info
[2023-07-19 03:34:08] [config] log-time-zone: ""
[2023-07-19 03:34:08] [config] logical-epoch:
[2023-07-19 03:34:08] [config]   - 1e
[2023-07-19 03:34:08] [config]   - 0
[2023-07-19 03:34:08] [config] lr-decay: 0
[2023-07-19 03:34:08] [config] lr-decay-freq: 50000
[2023-07-19 03:34:08] [config] lr-decay-inv-sqrt:
[2023-07-19 03:34:08] [config]   - 0
[2023-07-19 03:34:08] [config] lr-decay-repeat-warmup: false
[2023-07-19 03:34:08] [config] lr-decay-reset-optimizer: false
[2023-07-19 03:34:08] [config] lr-decay-start:
[2023-07-19 03:34:08] [config]   - 10
[2023-07-19 03:34:08] [config]   - 1
[2023-07-19 03:34:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 03:34:08] [config] lr-report: false
[2023-07-19 03:34:08] [config] lr-warmup: 0
[2023-07-19 03:34:08] [config] lr-warmup-at-reload: false
[2023-07-19 03:34:08] [config] lr-warmup-cycle: false
[2023-07-19 03:34:08] [config] lr-warmup-start-rate: 0
[2023-07-19 03:34:08] [config] max-length: 150
[2023-07-19 03:34:08] [config] max-length-crop: true
[2023-07-19 03:34:08] [config] max-length-factor: 3
[2023-07-19 03:34:08] [config] maxi-batch: 100
[2023-07-19 03:34:08] [config] maxi-batch-sort: trg
[2023-07-19 03:34:08] [config] mini-batch: 64
[2023-07-19 03:34:08] [config] mini-batch-fit: true
[2023-07-19 03:34:08] [config] mini-batch-fit-step: 10
[2023-07-19 03:34:08] [config] mini-batch-round-up: true
[2023-07-19 03:34:08] [config] mini-batch-track-lr: false
[2023-07-19 03:34:08] [config] mini-batch-warmup: 0
[2023-07-19 03:34:08] [config] mini-batch-words: 0
[2023-07-19 03:34:08] [config] mini-batch-words-ref: 0
[2023-07-19 03:34:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 03:34:08] [config] multi-loss-type: sum
[2023-07-19 03:34:08] [config] n-best: false
[2023-07-19 03:34:08] [config] no-nccl: false
[2023-07-19 03:34:08] [config] no-reload: false
[2023-07-19 03:34:08] [config] no-restore-corpus: false
[2023-07-19 03:34:08] [config] normalize: 0
[2023-07-19 03:34:08] [config] normalize-gradient: false
[2023-07-19 03:34:08] [config] num-devices: 0
[2023-07-19 03:34:08] [config] optimizer: adam
[2023-07-19 03:34:08] [config] optimizer-delay: 1
[2023-07-19 03:34:08] [config] optimizer-params:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] output-omit-bias: false
[2023-07-19 03:34:08] [config] overwrite: true
[2023-07-19 03:34:08] [config] precision:
[2023-07-19 03:34:08] [config]   - float16
[2023-07-19 03:34:08] [config]   - float32
[2023-07-19 03:34:08] [config] pretrained-model: ""
[2023-07-19 03:34:08] [config] quantize-biases: false
[2023-07-19 03:34:08] [config] quantize-bits: 0
[2023-07-19 03:34:08] [config] quantize-log-based: false
[2023-07-19 03:34:08] [config] quantize-optimization-steps: 0
[2023-07-19 03:34:08] [config] quiet: false
[2023-07-19 03:34:08] [config] quiet-translation: true
[2023-07-19 03:34:08] [config] relative-paths: false
[2023-07-19 03:34:08] [config] right-left: false
[2023-07-19 03:34:08] [config] save-freq: 10000u
[2023-07-19 03:34:08] [config] seed: 1234
[2023-07-19 03:34:08] [config] sentencepiece-alphas:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] sentencepiece-max-lines: 2000000
[2023-07-19 03:34:08] [config] sentencepiece-options: ""
[2023-07-19 03:34:08] [config] sharding: global
[2023-07-19 03:34:08] [config] shuffle: data
[2023-07-19 03:34:08] [config] shuffle-in-ram: false
[2023-07-19 03:34:08] [config] sigterm: save-and-exit
[2023-07-19 03:34:08] [config] skip: false
[2023-07-19 03:34:08] [config] sqlite: ""
[2023-07-19 03:34:08] [config] sqlite-drop: false
[2023-07-19 03:34:08] [config] sync-freq: 200u
[2023-07-19 03:34:08] [config] sync-sgd: false
[2023-07-19 03:34:08] [config] tempdir: /tmp
[2023-07-19 03:34:08] [config] tied-embeddings: false
[2023-07-19 03:34:08] [config] tied-embeddings-all: true
[2023-07-19 03:34:08] [config] tied-embeddings-src: false
[2023-07-19 03:34:08] [config] train-embedder-rank:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] train-sets:
[2023-07-19 03:34:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 03:34:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 03:34:08] [config] transformer-aan-activation: swish
[2023-07-19 03:34:08] [config] transformer-aan-depth: 2
[2023-07-19 03:34:08] [config] transformer-aan-nogate: false
[2023-07-19 03:34:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 03:34:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 03:34:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 03:34:08] [config] transformer-depth-scaling: false
[2023-07-19 03:34:08] [config] transformer-dim-aan: 2048
[2023-07-19 03:34:08] [config] transformer-dim-ffn: 2048
[2023-07-19 03:34:08] [config] transformer-dropout: 0
[2023-07-19 03:34:08] [config] transformer-dropout-attention: 0
[2023-07-19 03:34:08] [config] transformer-dropout-ffn: 0
[2023-07-19 03:34:08] [config] transformer-ffn-activation: swish
[2023-07-19 03:34:08] [config] transformer-ffn-depth: 2
[2023-07-19 03:34:08] [config] transformer-guided-alignment-layer: last
[2023-07-19 03:34:08] [config] transformer-heads: 8
[2023-07-19 03:34:08] [config] transformer-no-projection: false
[2023-07-19 03:34:08] [config] transformer-pool: false
[2023-07-19 03:34:08] [config] transformer-postprocess: dan
[2023-07-19 03:34:08] [config] transformer-postprocess-emb: d
[2023-07-19 03:34:08] [config] transformer-postprocess-top: ""
[2023-07-19 03:34:08] [config] transformer-preprocess: ""
[2023-07-19 03:34:08] [config] transformer-tied-layers:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] transformer-train-position-embeddings: false
[2023-07-19 03:34:08] [config] tsv: false
[2023-07-19 03:34:08] [config] tsv-fields: 0
[2023-07-19 03:34:08] [config] type: amun
[2023-07-19 03:34:08] [config] ulr: false
[2023-07-19 03:34:08] [config] ulr-dim-emb: 0
[2023-07-19 03:34:08] [config] ulr-dropout: 0
[2023-07-19 03:34:08] [config] ulr-keys-vectors: ""
[2023-07-19 03:34:08] [config] ulr-query-vectors: ""
[2023-07-19 03:34:08] [config] ulr-softmax-temperature: 1
[2023-07-19 03:34:08] [config] ulr-trainable-transformation: false
[2023-07-19 03:34:08] [config] unlikelihood-loss: false
[2023-07-19 03:34:08] [config] valid-freq: 50000000
[2023-07-19 03:34:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 03:34:08] [config] valid-max-length: 1000
[2023-07-19 03:34:08] [config] valid-metrics:
[2023-07-19 03:34:08] [config]   - cross-entropy
[2023-07-19 03:34:08] [config]   - translation
[2023-07-19 03:34:08] [config] valid-mini-batch: 32
[2023-07-19 03:34:08] [config] valid-reset-stalled: false
[2023-07-19 03:34:08] [config] valid-script-args:
[2023-07-19 03:34:08] [config]   []
[2023-07-19 03:34:08] [config] valid-script-path: ""
[2023-07-19 03:34:08] [config] valid-sets:
[2023-07-19 03:34:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 03:34:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 03:34:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 03:34:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 03:34:08] [config] vocabs:
[2023-07-19 03:34:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 03:34:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 03:34:08] [config] word-penalty: 0
[2023-07-19 03:34:08] [config] word-scores: false
[2023-07-19 03:34:08] [config] workspace: 5500
[2023-07-19 03:34:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 03:34:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 03:34:08] [training] Using single-device training
[2023-07-19 03:34:11] Synced seed 1234
[2023-07-19 03:34:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 03:34:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 03:34:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 03:34:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 03:34:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 03:34:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 03:34:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 03:34:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 03:34:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 03:34:12] [comm] Using global sharding
[2023-07-19 03:34:12] [comm] NCCLCommunicators constructed successfully
[2023-07-19 03:34:12] [training] Using 1 GPUs
[2023-07-19 03:34:12] [logits] Applying loss function for 1 factor(s)
[2023-07-19 03:34:12] [memory] Reserving 80 MB, device gpu0
[2023-07-19 03:34:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 03:34:12] [memory] Reserving 80 MB, device gpu0
[2023-07-19 03:59:58] [batching] Done. Typical MB size is 35,978 target words
[2023-07-19 03:59:58] [valid] No post-processing script given for validating translator
[2023-07-19 03:59:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 03:59:58] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 03:59:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 03:59:59] [comm] Using global sharding
[2023-07-19 03:59:59] [comm] NCCLCommunicators constructed successfully
[2023-07-19 03:59:59] [training] Using 1 GPUs
[2023-07-19 03:59:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 04:00:00] Allocating memory for general optimizer shards
[2023-07-19 04:00:00] [memory] Reserving 322 MB, device gpu0
[2023-07-19 04:00:00] Loading Adam parameters
[2023-07-19 04:00:00] [memory] Reserving 322 MB, device gpu0
[2023-07-19 04:00:00] [memory] Reserving 80 MB, device gpu0
[2023-07-19 04:00:00] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 04:00:00] [data] Restoring the corpus state to epoch 181, batch 6862
[2023-07-19 04:00:00] [data] Shuffling data
[2023-07-19 04:00:00] [data] Done reading 20,192 sentences
[2023-07-19 04:00:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:00:00] Training started
[2023-07-19 04:00:00] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 04:00:02] [memory] Reserving 80 MB, device gpu0
[2023-07-19 04:00:09] Parameter type float16, optimization type float32, casting types true
[2023-07-19 04:03:50] Seen 20,192 samples
[2023-07-19 04:03:50] Starting data epoch 182 in logical epoch 182
[2023-07-19 04:03:50] [data] Shuffling data
[2023-07-19 04:03:50] [data] Done reading 20,192 sentences
[2023-07-19 04:03:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:07:35] Seen 20,192 samples
[2023-07-19 04:07:35] Starting data epoch 183 in logical epoch 183
[2023-07-19 04:07:35] [data] Shuffling data
[2023-07-19 04:07:35] [data] Done reading 20,192 sentences
[2023-07-19 04:07:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:11:21] Seen 20,192 samples
[2023-07-19 04:11:21] Starting data epoch 184 in logical epoch 184
[2023-07-19 04:11:21] [data] Shuffling data
[2023-07-19 04:11:21] [data] Done reading 20,192 sentences
[2023-07-19 04:11:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:13:40] Ep. 184 : Up. 7000 : Sen. 12,800 : Cost 2.28669167 * 16,181,814 @ 12,921 after 113,858,044 : Time 821.35s : 19701.37 words/s : gNorm 1.4669
[2023-07-19 04:15:08] Seen 20,192 samples
[2023-07-19 04:15:08] Starting data epoch 185 in logical epoch 185
[2023-07-19 04:15:08] [data] Shuffling data
[2023-07-19 04:15:08] [data] Done reading 20,192 sentences
[2023-07-19 04:15:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:18:53] Seen 20,192 samples
[2023-07-19 04:18:53] Starting data epoch 186 in logical epoch 186
[2023-07-19 04:18:53] [data] Shuffling data
[2023-07-19 04:18:53] [data] Done reading 20,192 sentences
[2023-07-19 04:18:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:22:32] Seen 20,192 samples
[2023-07-19 04:22:32] Starting data epoch 187 in logical epoch 187
[2023-07-19 04:22:32] [data] Shuffling data
[2023-07-19 04:22:32] [data] Done reading 20,192 sentences
[2023-07-19 04:22:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:26:10] Seen 20,192 samples
[2023-07-19 04:26:10] Starting data epoch 188 in logical epoch 188
[2023-07-19 04:26:10] [data] Shuffling data
[2023-07-19 04:26:10] [data] Done reading 20,192 sentences
[2023-07-19 04:26:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:29:46] Seen 20,192 samples
[2023-07-19 04:29:46] Starting data epoch 189 in logical epoch 189
[2023-07-19 04:29:46] [data] Shuffling data
[2023-07-19 04:29:46] [data] Done reading 20,192 sentences
[2023-07-19 04:29:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:33:33] Seen 20,192 samples
[2023-07-19 04:33:33] Starting data epoch 190 in logical epoch 190
[2023-07-19 04:33:33] [data] Shuffling data
[2023-07-19 04:33:33] [data] Done reading 20,192 sentences
[2023-07-19 04:33:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 04:37:21] Seen 20,192 samples
[2023-07-19 04:37:21] Starting data epoch 191 in logical epoch 191
[2023-07-19 04:37:21] Training finished
[2023-07-19 04:37:32] [valid] Ep. 191 : Up. 7242 : cross-entropy : 127.952 : stalled 3 times (last best: 123.71)
[2023-07-19 04:39:23] [valid] Ep. 191 : Up. 7242 : translation : 0 : new best
[2023-07-19 04:39:23] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 04:39:25] Saving Adam parameters
[2023-07-19 04:39:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 04:39:33] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 04:39:33] [marian] Running on node22.datos.cluster.uy as process 37565 with command line:
[2023-07-19 04:39:33] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-19 04:39:33] [config] after: 0e
[2023-07-19 04:39:33] [config] after-batches: 0
[2023-07-19 04:39:33] [config] after-epochs: 200
[2023-07-19 04:39:33] [config] all-caps-every: 0
[2023-07-19 04:39:33] [config] allow-unk: false
[2023-07-19 04:39:33] [config] authors: false
[2023-07-19 04:39:33] [config] beam-size: 12
[2023-07-19 04:39:33] [config] bert-class-symbol: "[CLS]"
[2023-07-19 04:39:33] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 04:39:33] [config] bert-masking-fraction: 0.15
[2023-07-19 04:39:33] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 04:39:33] [config] bert-train-type-embeddings: true
[2023-07-19 04:39:33] [config] bert-type-vocab-size: 2
[2023-07-19 04:39:33] [config] build-info: ""
[2023-07-19 04:39:33] [config] check-gradient-nan: false
[2023-07-19 04:39:33] [config] check-nan: false
[2023-07-19 04:39:33] [config] cite: false
[2023-07-19 04:39:33] [config] clip-norm: 1
[2023-07-19 04:39:33] [config] cost-scaling:
[2023-07-19 04:39:33] [config]   - 256.f
[2023-07-19 04:39:33] [config]   - 1000
[2023-07-19 04:39:33] [config]   - 2.f
[2023-07-19 04:39:33] [config]   - 256.f
[2023-07-19 04:39:33] [config] cost-type: ce-sum
[2023-07-19 04:39:33] [config] cpu-threads: 0
[2023-07-19 04:39:33] [config] data-threads: 8
[2023-07-19 04:39:33] [config] data-weighting: ""
[2023-07-19 04:39:33] [config] data-weighting-type: sentence
[2023-07-19 04:39:33] [config] dec-cell: gru
[2023-07-19 04:39:33] [config] dec-cell-base-depth: 2
[2023-07-19 04:39:33] [config] dec-cell-high-depth: 1
[2023-07-19 04:39:33] [config] dec-depth: 1
[2023-07-19 04:39:33] [config] devices:
[2023-07-19 04:39:33] [config]   - 0
[2023-07-19 04:39:33] [config] dim-emb: 512
[2023-07-19 04:39:33] [config] dim-rnn: 1024
[2023-07-19 04:39:33] [config] dim-vocabs:
[2023-07-19 04:39:33] [config]   - 16384
[2023-07-19 04:39:33] [config]   - 16384
[2023-07-19 04:39:33] [config] disp-first: 0
[2023-07-19 04:39:33] [config] disp-freq: 1000u
[2023-07-19 04:39:33] [config] disp-label-counts: true
[2023-07-19 04:39:33] [config] dropout-rnn: 0
[2023-07-19 04:39:33] [config] dropout-src: 0
[2023-07-19 04:39:33] [config] dropout-trg: 0
[2023-07-19 04:39:33] [config] dump-config: ""
[2023-07-19 04:39:33] [config] dynamic-gradient-scaling:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] early-stopping: 200
[2023-07-19 04:39:33] [config] early-stopping-on: first
[2023-07-19 04:39:33] [config] embedding-fix-src: false
[2023-07-19 04:39:33] [config] embedding-fix-trg: false
[2023-07-19 04:39:33] [config] embedding-normalization: false
[2023-07-19 04:39:33] [config] embedding-vectors:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] enc-cell: gru
[2023-07-19 04:39:33] [config] enc-cell-depth: 1
[2023-07-19 04:39:33] [config] enc-depth: 1
[2023-07-19 04:39:33] [config] enc-type: bidirectional
[2023-07-19 04:39:33] [config] english-title-case-every: 0
[2023-07-19 04:39:33] [config] exponential-smoothing: 0
[2023-07-19 04:39:33] [config] factor-weight: 1
[2023-07-19 04:39:33] [config] factors-combine: sum
[2023-07-19 04:39:33] [config] factors-dim-emb: 0
[2023-07-19 04:39:33] [config] gradient-checkpointing: false
[2023-07-19 04:39:33] [config] gradient-norm-average-window: 100
[2023-07-19 04:39:33] [config] guided-alignment: none
[2023-07-19 04:39:33] [config] guided-alignment-cost: mse
[2023-07-19 04:39:33] [config] guided-alignment-weight: 0.1
[2023-07-19 04:39:33] [config] ignore-model-config: false
[2023-07-19 04:39:33] [config] input-types:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] interpolate-env-vars: false
[2023-07-19 04:39:33] [config] keep-best: false
[2023-07-19 04:39:33] [config] label-smoothing: 0
[2023-07-19 04:39:33] [config] layer-normalization: false
[2023-07-19 04:39:33] [config] learn-rate: 0.0001
[2023-07-19 04:39:33] [config] lemma-dependency: ""
[2023-07-19 04:39:33] [config] lemma-dim-emb: 0
[2023-07-19 04:39:33] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 04:39:33] [config] log-level: info
[2023-07-19 04:39:33] [config] log-time-zone: ""
[2023-07-19 04:39:33] [config] logical-epoch:
[2023-07-19 04:39:33] [config]   - 1e
[2023-07-19 04:39:33] [config]   - 0
[2023-07-19 04:39:33] [config] lr-decay: 0
[2023-07-19 04:39:33] [config] lr-decay-freq: 50000
[2023-07-19 04:39:33] [config] lr-decay-inv-sqrt:
[2023-07-19 04:39:33] [config]   - 0
[2023-07-19 04:39:33] [config] lr-decay-repeat-warmup: false
[2023-07-19 04:39:33] [config] lr-decay-reset-optimizer: false
[2023-07-19 04:39:33] [config] lr-decay-start:
[2023-07-19 04:39:33] [config]   - 10
[2023-07-19 04:39:33] [config]   - 1
[2023-07-19 04:39:33] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 04:39:33] [config] lr-report: false
[2023-07-19 04:39:33] [config] lr-warmup: 0
[2023-07-19 04:39:33] [config] lr-warmup-at-reload: false
[2023-07-19 04:39:33] [config] lr-warmup-cycle: false
[2023-07-19 04:39:33] [config] lr-warmup-start-rate: 0
[2023-07-19 04:39:33] [config] max-length: 150
[2023-07-19 04:39:33] [config] max-length-crop: true
[2023-07-19 04:39:33] [config] max-length-factor: 3
[2023-07-19 04:39:33] [config] maxi-batch: 100
[2023-07-19 04:39:33] [config] maxi-batch-sort: trg
[2023-07-19 04:39:33] [config] mini-batch: 64
[2023-07-19 04:39:33] [config] mini-batch-fit: true
[2023-07-19 04:39:33] [config] mini-batch-fit-step: 10
[2023-07-19 04:39:33] [config] mini-batch-round-up: true
[2023-07-19 04:39:33] [config] mini-batch-track-lr: false
[2023-07-19 04:39:33] [config] mini-batch-warmup: 0
[2023-07-19 04:39:33] [config] mini-batch-words: 0
[2023-07-19 04:39:33] [config] mini-batch-words-ref: 0
[2023-07-19 04:39:33] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 04:39:33] [config] multi-loss-type: sum
[2023-07-19 04:39:33] [config] n-best: false
[2023-07-19 04:39:33] [config] no-nccl: false
[2023-07-19 04:39:33] [config] no-reload: false
[2023-07-19 04:39:33] [config] no-restore-corpus: false
[2023-07-19 04:39:33] [config] normalize: 0
[2023-07-19 04:39:33] [config] normalize-gradient: false
[2023-07-19 04:39:33] [config] num-devices: 0
[2023-07-19 04:39:33] [config] optimizer: adam
[2023-07-19 04:39:33] [config] optimizer-delay: 1
[2023-07-19 04:39:33] [config] optimizer-params:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] output-omit-bias: false
[2023-07-19 04:39:33] [config] overwrite: true
[2023-07-19 04:39:33] [config] precision:
[2023-07-19 04:39:33] [config]   - float16
[2023-07-19 04:39:33] [config]   - float32
[2023-07-19 04:39:33] [config] pretrained-model: ""
[2023-07-19 04:39:33] [config] quantize-biases: false
[2023-07-19 04:39:33] [config] quantize-bits: 0
[2023-07-19 04:39:33] [config] quantize-log-based: false
[2023-07-19 04:39:33] [config] quantize-optimization-steps: 0
[2023-07-19 04:39:33] [config] quiet: false
[2023-07-19 04:39:33] [config] quiet-translation: true
[2023-07-19 04:39:33] [config] relative-paths: false
[2023-07-19 04:39:33] [config] right-left: false
[2023-07-19 04:39:33] [config] save-freq: 10000u
[2023-07-19 04:39:33] [config] seed: 1234
[2023-07-19 04:39:33] [config] sentencepiece-alphas:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] sentencepiece-max-lines: 2000000
[2023-07-19 04:39:33] [config] sentencepiece-options: ""
[2023-07-19 04:39:33] [config] sharding: global
[2023-07-19 04:39:33] [config] shuffle: data
[2023-07-19 04:39:33] [config] shuffle-in-ram: false
[2023-07-19 04:39:33] [config] sigterm: save-and-exit
[2023-07-19 04:39:33] [config] skip: false
[2023-07-19 04:39:33] [config] sqlite: ""
[2023-07-19 04:39:33] [config] sqlite-drop: false
[2023-07-19 04:39:33] [config] sync-freq: 200u
[2023-07-19 04:39:33] [config] sync-sgd: false
[2023-07-19 04:39:33] [config] tempdir: /tmp
[2023-07-19 04:39:33] [config] tied-embeddings: false
[2023-07-19 04:39:33] [config] tied-embeddings-all: true
[2023-07-19 04:39:33] [config] tied-embeddings-src: false
[2023-07-19 04:39:33] [config] train-embedder-rank:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] train-sets:
[2023-07-19 04:39:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 04:39:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 04:39:33] [config] transformer-aan-activation: swish
[2023-07-19 04:39:33] [config] transformer-aan-depth: 2
[2023-07-19 04:39:33] [config] transformer-aan-nogate: false
[2023-07-19 04:39:33] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 04:39:33] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 04:39:33] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 04:39:33] [config] transformer-depth-scaling: false
[2023-07-19 04:39:33] [config] transformer-dim-aan: 2048
[2023-07-19 04:39:33] [config] transformer-dim-ffn: 2048
[2023-07-19 04:39:33] [config] transformer-dropout: 0
[2023-07-19 04:39:33] [config] transformer-dropout-attention: 0
[2023-07-19 04:39:33] [config] transformer-dropout-ffn: 0
[2023-07-19 04:39:33] [config] transformer-ffn-activation: swish
[2023-07-19 04:39:33] [config] transformer-ffn-depth: 2
[2023-07-19 04:39:33] [config] transformer-guided-alignment-layer: last
[2023-07-19 04:39:33] [config] transformer-heads: 8
[2023-07-19 04:39:33] [config] transformer-no-projection: false
[2023-07-19 04:39:33] [config] transformer-pool: false
[2023-07-19 04:39:33] [config] transformer-postprocess: dan
[2023-07-19 04:39:33] [config] transformer-postprocess-emb: d
[2023-07-19 04:39:33] [config] transformer-postprocess-top: ""
[2023-07-19 04:39:33] [config] transformer-preprocess: ""
[2023-07-19 04:39:33] [config] transformer-tied-layers:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] transformer-train-position-embeddings: false
[2023-07-19 04:39:33] [config] tsv: false
[2023-07-19 04:39:33] [config] tsv-fields: 0
[2023-07-19 04:39:33] [config] type: amun
[2023-07-19 04:39:33] [config] ulr: false
[2023-07-19 04:39:33] [config] ulr-dim-emb: 0
[2023-07-19 04:39:33] [config] ulr-dropout: 0
[2023-07-19 04:39:33] [config] ulr-keys-vectors: ""
[2023-07-19 04:39:33] [config] ulr-query-vectors: ""
[2023-07-19 04:39:33] [config] ulr-softmax-temperature: 1
[2023-07-19 04:39:33] [config] ulr-trainable-transformation: false
[2023-07-19 04:39:33] [config] unlikelihood-loss: false
[2023-07-19 04:39:33] [config] valid-freq: 50000000
[2023-07-19 04:39:33] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 04:39:33] [config] valid-max-length: 1000
[2023-07-19 04:39:33] [config] valid-metrics:
[2023-07-19 04:39:33] [config]   - cross-entropy
[2023-07-19 04:39:33] [config]   - translation
[2023-07-19 04:39:33] [config] valid-mini-batch: 32
[2023-07-19 04:39:33] [config] valid-reset-stalled: false
[2023-07-19 04:39:33] [config] valid-script-args:
[2023-07-19 04:39:33] [config]   []
[2023-07-19 04:39:33] [config] valid-script-path: ""
[2023-07-19 04:39:33] [config] valid-sets:
[2023-07-19 04:39:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 04:39:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 04:39:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 04:39:33] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 04:39:33] [config] vocabs:
[2023-07-19 04:39:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 04:39:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 04:39:33] [config] word-penalty: 0
[2023-07-19 04:39:33] [config] word-scores: false
[2023-07-19 04:39:33] [config] workspace: 5500
[2023-07-19 04:39:33] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 04:39:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 04:39:33] [training] Using single-device training
[2023-07-19 04:39:33] Synced seed 1234
[2023-07-19 04:39:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 04:39:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 04:39:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 04:39:34] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 04:39:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 04:39:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 04:39:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 04:39:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 04:39:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 04:39:35] [comm] Using global sharding
[2023-07-19 04:39:35] [comm] NCCLCommunicators constructed successfully
[2023-07-19 04:39:35] [training] Using 1 GPUs
[2023-07-19 04:39:35] [logits] Applying loss function for 1 factor(s)
[2023-07-19 04:39:35] [memory] Reserving 80 MB, device gpu0
[2023-07-19 04:39:35] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 04:39:35] [memory] Reserving 80 MB, device gpu0
[2023-07-19 05:06:10] [batching] Done. Typical MB size is 35,978 target words
[2023-07-19 05:06:10] [valid] No post-processing script given for validating translator
[2023-07-19 05:06:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 05:06:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 05:06:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 05:06:10] [comm] Using global sharding
[2023-07-19 05:06:10] [comm] NCCLCommunicators constructed successfully
[2023-07-19 05:06:10] [training] Using 1 GPUs
[2023-07-19 05:06:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 05:06:11] Allocating memory for general optimizer shards
[2023-07-19 05:06:11] [memory] Reserving 322 MB, device gpu0
[2023-07-19 05:06:11] Loading Adam parameters
[2023-07-19 05:06:11] [memory] Reserving 322 MB, device gpu0
[2023-07-19 05:06:11] [memory] Reserving 80 MB, device gpu0
[2023-07-19 05:06:12] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 05:06:12] [data] Restoring the corpus state to epoch 191, batch 7242
[2023-07-19 05:06:12] [data] Shuffling data
[2023-07-19 05:06:12] [data] Done reading 20,192 sentences
[2023-07-19 05:06:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:06:12] Training started
[2023-07-19 05:06:12] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 05:06:13] [memory] Reserving 80 MB, device gpu0
[2023-07-19 05:06:17] Parameter type float16, optimization type float32, casting types true
[2023-07-19 05:09:57] Seen 20,192 samples
[2023-07-19 05:09:57] Starting data epoch 192 in logical epoch 192
[2023-07-19 05:09:57] [data] Shuffling data
[2023-07-19 05:09:57] [data] Done reading 20,192 sentences
[2023-07-19 05:09:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:13:47] Seen 20,192 samples
[2023-07-19 05:13:47] Starting data epoch 193 in logical epoch 193
[2023-07-19 05:13:47] [data] Shuffling data
[2023-07-19 05:13:47] [data] Done reading 20,192 sentences
[2023-07-19 05:13:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:17:40] Seen 20,192 samples
[2023-07-19 05:17:40] Starting data epoch 194 in logical epoch 194
[2023-07-19 05:17:40] [data] Shuffling data
[2023-07-19 05:17:40] [data] Done reading 20,192 sentences
[2023-07-19 05:17:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:21:23] Seen 20,192 samples
[2023-07-19 05:21:23] Starting data epoch 195 in logical epoch 195
[2023-07-19 05:21:23] [data] Shuffling data
[2023-07-19 05:21:23] [data] Done reading 20,192 sentences
[2023-07-19 05:21:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:25:15] Seen 20,192 samples
[2023-07-19 05:25:15] Starting data epoch 196 in logical epoch 196
[2023-07-19 05:25:15] [data] Shuffling data
[2023-07-19 05:25:15] [data] Done reading 20,192 sentences
[2023-07-19 05:25:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:28:55] Seen 20,192 samples
[2023-07-19 05:28:55] Starting data epoch 197 in logical epoch 197
[2023-07-19 05:28:55] [data] Shuffling data
[2023-07-19 05:28:55] [data] Done reading 20,192 sentences
[2023-07-19 05:28:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:32:42] Seen 20,192 samples
[2023-07-19 05:32:42] Starting data epoch 198 in logical epoch 198
[2023-07-19 05:32:42] [data] Shuffling data
[2023-07-19 05:32:42] [data] Done reading 20,192 sentences
[2023-07-19 05:32:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:36:28] Seen 20,192 samples
[2023-07-19 05:36:28] Starting data epoch 199 in logical epoch 199
[2023-07-19 05:36:28] [data] Shuffling data
[2023-07-19 05:36:28] [data] Done reading 20,192 sentences
[2023-07-19 05:36:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:40:14] Seen 20,192 samples
[2023-07-19 05:40:14] Starting data epoch 200 in logical epoch 200
[2023-07-19 05:40:14] [data] Shuffling data
[2023-07-19 05:40:14] [data] Done reading 20,192 sentences
[2023-07-19 05:40:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 05:43:52] Seen 20,192 samples
[2023-07-19 05:43:52] Starting data epoch 201 in logical epoch 201
[2023-07-19 05:43:52] Training finished
[2023-07-19 05:44:03] [valid] Ep. 201 : Up. 7624 : cross-entropy : 129.336 : stalled 4 times (last best: 123.71)
[2023-07-19 05:45:50] [valid] Ep. 201 : Up. 7624 : translation : 0 : new best
[2023-07-19 05:45:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz
[2023-07-19 05:45:52] Saving Adam parameters
[2023-07-19 05:45:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_150.npz.optimizer.npz
[2023-07-19 05:46:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 05:46:00] [marian] Running on node22.datos.cluster.uy as process 1198 with command line:
[2023-07-19 05:46:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 05:46:00] [config] after: 0e
[2023-07-19 05:46:00] [config] after-batches: 0
[2023-07-19 05:46:00] [config] after-epochs: 10
[2023-07-19 05:46:00] [config] all-caps-every: 0
[2023-07-19 05:46:00] [config] allow-unk: false
[2023-07-19 05:46:00] [config] authors: false
[2023-07-19 05:46:00] [config] beam-size: 12
[2023-07-19 05:46:00] [config] bert-class-symbol: "[CLS]"
[2023-07-19 05:46:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 05:46:00] [config] bert-masking-fraction: 0.15
[2023-07-19 05:46:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 05:46:00] [config] bert-train-type-embeddings: true
[2023-07-19 05:46:00] [config] bert-type-vocab-size: 2
[2023-07-19 05:46:00] [config] build-info: ""
[2023-07-19 05:46:00] [config] check-gradient-nan: false
[2023-07-19 05:46:00] [config] check-nan: false
[2023-07-19 05:46:00] [config] cite: false
[2023-07-19 05:46:00] [config] clip-norm: 1
[2023-07-19 05:46:00] [config] cost-scaling:
[2023-07-19 05:46:00] [config]   - 256.f
[2023-07-19 05:46:00] [config]   - 1000
[2023-07-19 05:46:00] [config]   - 2.f
[2023-07-19 05:46:00] [config]   - 256.f
[2023-07-19 05:46:00] [config] cost-type: ce-sum
[2023-07-19 05:46:00] [config] cpu-threads: 0
[2023-07-19 05:46:00] [config] data-threads: 8
[2023-07-19 05:46:00] [config] data-weighting: ""
[2023-07-19 05:46:00] [config] data-weighting-type: sentence
[2023-07-19 05:46:00] [config] dec-cell: gru
[2023-07-19 05:46:00] [config] dec-cell-base-depth: 2
[2023-07-19 05:46:00] [config] dec-cell-high-depth: 1
[2023-07-19 05:46:00] [config] dec-depth: 1
[2023-07-19 05:46:00] [config] devices:
[2023-07-19 05:46:00] [config]   - 0
[2023-07-19 05:46:00] [config] dim-emb: 512
[2023-07-19 05:46:00] [config] dim-rnn: 1024
[2023-07-19 05:46:00] [config] dim-vocabs:
[2023-07-19 05:46:00] [config]   - 16384
[2023-07-19 05:46:00] [config]   - 16384
[2023-07-19 05:46:00] [config] disp-first: 0
[2023-07-19 05:46:00] [config] disp-freq: 1000u
[2023-07-19 05:46:00] [config] disp-label-counts: true
[2023-07-19 05:46:00] [config] dropout-rnn: 0
[2023-07-19 05:46:00] [config] dropout-src: 0
[2023-07-19 05:46:00] [config] dropout-trg: 0
[2023-07-19 05:46:00] [config] dump-config: ""
[2023-07-19 05:46:00] [config] dynamic-gradient-scaling:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] early-stopping: 200
[2023-07-19 05:46:00] [config] early-stopping-on: first
[2023-07-19 05:46:00] [config] embedding-fix-src: false
[2023-07-19 05:46:00] [config] embedding-fix-trg: false
[2023-07-19 05:46:00] [config] embedding-normalization: false
[2023-07-19 05:46:00] [config] embedding-vectors:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] enc-cell: gru
[2023-07-19 05:46:00] [config] enc-cell-depth: 1
[2023-07-19 05:46:00] [config] enc-depth: 1
[2023-07-19 05:46:00] [config] enc-type: bidirectional
[2023-07-19 05:46:00] [config] english-title-case-every: 0
[2023-07-19 05:46:00] [config] exponential-smoothing: 0
[2023-07-19 05:46:00] [config] factor-weight: 1
[2023-07-19 05:46:00] [config] factors-combine: sum
[2023-07-19 05:46:00] [config] factors-dim-emb: 0
[2023-07-19 05:46:00] [config] gradient-checkpointing: false
[2023-07-19 05:46:00] [config] gradient-norm-average-window: 100
[2023-07-19 05:46:00] [config] guided-alignment: none
[2023-07-19 05:46:00] [config] guided-alignment-cost: mse
[2023-07-19 05:46:00] [config] guided-alignment-weight: 0.1
[2023-07-19 05:46:00] [config] ignore-model-config: false
[2023-07-19 05:46:00] [config] input-types:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] interpolate-env-vars: false
[2023-07-19 05:46:00] [config] keep-best: false
[2023-07-19 05:46:00] [config] label-smoothing: 0
[2023-07-19 05:46:00] [config] layer-normalization: false
[2023-07-19 05:46:00] [config] learn-rate: 0.0001
[2023-07-19 05:46:00] [config] lemma-dependency: ""
[2023-07-19 05:46:00] [config] lemma-dim-emb: 0
[2023-07-19 05:46:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 05:46:00] [config] log-level: info
[2023-07-19 05:46:00] [config] log-time-zone: ""
[2023-07-19 05:46:00] [config] logical-epoch:
[2023-07-19 05:46:00] [config]   - 1e
[2023-07-19 05:46:00] [config]   - 0
[2023-07-19 05:46:00] [config] lr-decay: 0
[2023-07-19 05:46:00] [config] lr-decay-freq: 50000
[2023-07-19 05:46:00] [config] lr-decay-inv-sqrt:
[2023-07-19 05:46:00] [config]   - 0
[2023-07-19 05:46:00] [config] lr-decay-repeat-warmup: false
[2023-07-19 05:46:00] [config] lr-decay-reset-optimizer: false
[2023-07-19 05:46:00] [config] lr-decay-start:
[2023-07-19 05:46:00] [config]   - 10
[2023-07-19 05:46:00] [config]   - 1
[2023-07-19 05:46:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 05:46:00] [config] lr-report: false
[2023-07-19 05:46:00] [config] lr-warmup: 0
[2023-07-19 05:46:00] [config] lr-warmup-at-reload: false
[2023-07-19 05:46:00] [config] lr-warmup-cycle: false
[2023-07-19 05:46:00] [config] lr-warmup-start-rate: 0
[2023-07-19 05:46:00] [config] max-length: 200
[2023-07-19 05:46:00] [config] max-length-crop: true
[2023-07-19 05:46:00] [config] max-length-factor: 3
[2023-07-19 05:46:00] [config] maxi-batch: 100
[2023-07-19 05:46:00] [config] maxi-batch-sort: trg
[2023-07-19 05:46:00] [config] mini-batch: 64
[2023-07-19 05:46:00] [config] mini-batch-fit: true
[2023-07-19 05:46:00] [config] mini-batch-fit-step: 10
[2023-07-19 05:46:00] [config] mini-batch-round-up: true
[2023-07-19 05:46:00] [config] mini-batch-track-lr: false
[2023-07-19 05:46:00] [config] mini-batch-warmup: 0
[2023-07-19 05:46:00] [config] mini-batch-words: 0
[2023-07-19 05:46:00] [config] mini-batch-words-ref: 0
[2023-07-19 05:46:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-19 05:46:00] [config] multi-loss-type: sum
[2023-07-19 05:46:00] [config] n-best: false
[2023-07-19 05:46:00] [config] no-nccl: false
[2023-07-19 05:46:00] [config] no-reload: false
[2023-07-19 05:46:00] [config] no-restore-corpus: false
[2023-07-19 05:46:00] [config] normalize: 0
[2023-07-19 05:46:00] [config] normalize-gradient: false
[2023-07-19 05:46:00] [config] num-devices: 0
[2023-07-19 05:46:00] [config] optimizer: adam
[2023-07-19 05:46:00] [config] optimizer-delay: 1
[2023-07-19 05:46:00] [config] optimizer-params:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] output-omit-bias: false
[2023-07-19 05:46:00] [config] overwrite: true
[2023-07-19 05:46:00] [config] precision:
[2023-07-19 05:46:00] [config]   - float16
[2023-07-19 05:46:00] [config]   - float32
[2023-07-19 05:46:00] [config] pretrained-model: ""
[2023-07-19 05:46:00] [config] quantize-biases: false
[2023-07-19 05:46:00] [config] quantize-bits: 0
[2023-07-19 05:46:00] [config] quantize-log-based: false
[2023-07-19 05:46:00] [config] quantize-optimization-steps: 0
[2023-07-19 05:46:00] [config] quiet: false
[2023-07-19 05:46:00] [config] quiet-translation: true
[2023-07-19 05:46:00] [config] relative-paths: false
[2023-07-19 05:46:00] [config] right-left: false
[2023-07-19 05:46:00] [config] save-freq: 10000u
[2023-07-19 05:46:00] [config] seed: 1234
[2023-07-19 05:46:00] [config] sentencepiece-alphas:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] sentencepiece-max-lines: 2000000
[2023-07-19 05:46:00] [config] sentencepiece-options: ""
[2023-07-19 05:46:00] [config] sharding: global
[2023-07-19 05:46:00] [config] shuffle: data
[2023-07-19 05:46:00] [config] shuffle-in-ram: false
[2023-07-19 05:46:00] [config] sigterm: save-and-exit
[2023-07-19 05:46:00] [config] skip: false
[2023-07-19 05:46:00] [config] sqlite: ""
[2023-07-19 05:46:00] [config] sqlite-drop: false
[2023-07-19 05:46:00] [config] sync-freq: 200u
[2023-07-19 05:46:00] [config] sync-sgd: false
[2023-07-19 05:46:00] [config] tempdir: /tmp
[2023-07-19 05:46:00] [config] tied-embeddings: false
[2023-07-19 05:46:00] [config] tied-embeddings-all: true
[2023-07-19 05:46:00] [config] tied-embeddings-src: false
[2023-07-19 05:46:00] [config] train-embedder-rank:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] train-sets:
[2023-07-19 05:46:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 05:46:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 05:46:00] [config] transformer-aan-activation: swish
[2023-07-19 05:46:00] [config] transformer-aan-depth: 2
[2023-07-19 05:46:00] [config] transformer-aan-nogate: false
[2023-07-19 05:46:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 05:46:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 05:46:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 05:46:00] [config] transformer-depth-scaling: false
[2023-07-19 05:46:00] [config] transformer-dim-aan: 2048
[2023-07-19 05:46:00] [config] transformer-dim-ffn: 2048
[2023-07-19 05:46:00] [config] transformer-dropout: 0
[2023-07-19 05:46:00] [config] transformer-dropout-attention: 0
[2023-07-19 05:46:00] [config] transformer-dropout-ffn: 0
[2023-07-19 05:46:00] [config] transformer-ffn-activation: swish
[2023-07-19 05:46:00] [config] transformer-ffn-depth: 2
[2023-07-19 05:46:00] [config] transformer-guided-alignment-layer: last
[2023-07-19 05:46:00] [config] transformer-heads: 8
[2023-07-19 05:46:00] [config] transformer-no-projection: false
[2023-07-19 05:46:00] [config] transformer-pool: false
[2023-07-19 05:46:00] [config] transformer-postprocess: dan
[2023-07-19 05:46:00] [config] transformer-postprocess-emb: d
[2023-07-19 05:46:00] [config] transformer-postprocess-top: ""
[2023-07-19 05:46:00] [config] transformer-preprocess: ""
[2023-07-19 05:46:00] [config] transformer-tied-layers:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] transformer-train-position-embeddings: false
[2023-07-19 05:46:00] [config] tsv: false
[2023-07-19 05:46:00] [config] tsv-fields: 0
[2023-07-19 05:46:00] [config] type: amun
[2023-07-19 05:46:00] [config] ulr: false
[2023-07-19 05:46:00] [config] ulr-dim-emb: 0
[2023-07-19 05:46:00] [config] ulr-dropout: 0
[2023-07-19 05:46:00] [config] ulr-keys-vectors: ""
[2023-07-19 05:46:00] [config] ulr-query-vectors: ""
[2023-07-19 05:46:00] [config] ulr-softmax-temperature: 1
[2023-07-19 05:46:00] [config] ulr-trainable-transformation: false
[2023-07-19 05:46:00] [config] unlikelihood-loss: false
[2023-07-19 05:46:00] [config] valid-freq: 50000000
[2023-07-19 05:46:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 05:46:00] [config] valid-max-length: 1000
[2023-07-19 05:46:00] [config] valid-metrics:
[2023-07-19 05:46:00] [config]   - cross-entropy
[2023-07-19 05:46:00] [config]   - translation
[2023-07-19 05:46:00] [config] valid-mini-batch: 32
[2023-07-19 05:46:00] [config] valid-reset-stalled: false
[2023-07-19 05:46:00] [config] valid-script-args:
[2023-07-19 05:46:00] [config]   []
[2023-07-19 05:46:00] [config] valid-script-path: ""
[2023-07-19 05:46:00] [config] valid-sets:
[2023-07-19 05:46:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 05:46:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 05:46:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 05:46:00] [config] vocabs:
[2023-07-19 05:46:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 05:46:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 05:46:00] [config] word-penalty: 0
[2023-07-19 05:46:00] [config] word-scores: false
[2023-07-19 05:46:00] [config] workspace: 5500
[2023-07-19 05:46:00] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 05:46:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 05:46:00] [training] Using single-device training
[2023-07-19 05:46:01] Synced seed 1234
[2023-07-19 05:46:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 05:46:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 05:46:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 05:46:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 05:46:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 05:46:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 05:46:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 05:46:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 05:46:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 05:46:02] [comm] Using global sharding
[2023-07-19 05:46:02] [comm] NCCLCommunicators constructed successfully
[2023-07-19 05:46:02] [training] Using 1 GPUs
[2023-07-19 05:46:02] [logits] Applying loss function for 1 factor(s)
[2023-07-19 05:46:02] [memory] Reserving 80 MB, device gpu0
[2023-07-19 05:46:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 05:46:03] [memory] Reserving 80 MB, device gpu0
[2023-07-19 06:21:54] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 06:21:54] [valid] No post-processing script given for validating translator
[2023-07-19 06:21:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 06:21:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 06:21:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 06:21:54] [comm] Using global sharding
[2023-07-19 06:21:54] [comm] NCCLCommunicators constructed successfully
[2023-07-19 06:21:54] [training] Using 1 GPUs
[2023-07-19 06:21:54] Training started
[2023-07-19 06:21:54] [data] Shuffling data
[2023-07-19 06:21:54] [data] Done reading 20,192 sentences
[2023-07-19 06:21:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:21:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 06:21:54] [memory] Reserving 80 MB, device gpu0
[2023-07-19 06:21:56] [memory] Reserving 80 MB, device gpu0
[2023-07-19 06:22:04] Parameter type float16, optimization type float32, casting types true
[2023-07-19 06:22:04] Allocating memory for general optimizer shards
[2023-07-19 06:22:04] [memory] Reserving 322 MB, device gpu0
[2023-07-19 06:22:04] Allocating memory for Adam-specific shards
[2023-07-19 06:22:04] [memory] Reserving 322 MB, device gpu0
[2023-07-19 06:25:33] Seen 20,192 samples
[2023-07-19 06:25:33] Starting data epoch 2 in logical epoch 2
[2023-07-19 06:25:33] [data] Shuffling data
[2023-07-19 06:25:33] [data] Done reading 20,192 sentences
[2023-07-19 06:25:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:30:10] Seen 20,192 samples
[2023-07-19 06:30:10] Starting data epoch 3 in logical epoch 3
[2023-07-19 06:30:10] [data] Shuffling data
[2023-07-19 06:30:10] [data] Done reading 20,192 sentences
[2023-07-19 06:30:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:34:28] Seen 20,192 samples
[2023-07-19 06:34:28] Starting data epoch 4 in logical epoch 4
[2023-07-19 06:34:28] [data] Shuffling data
[2023-07-19 06:34:28] [data] Done reading 20,192 sentences
[2023-07-19 06:34:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:38:26] Seen 20,192 samples
[2023-07-19 06:38:26] Starting data epoch 5 in logical epoch 5
[2023-07-19 06:38:26] [data] Shuffling data
[2023-07-19 06:38:26] [data] Done reading 20,192 sentences
[2023-07-19 06:38:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:42:38] Seen 20,192 samples
[2023-07-19 06:42:38] Starting data epoch 6 in logical epoch 6
[2023-07-19 06:42:38] [data] Shuffling data
[2023-07-19 06:42:38] [data] Done reading 20,192 sentences
[2023-07-19 06:42:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:46:33] Seen 20,192 samples
[2023-07-19 06:46:33] Starting data epoch 7 in logical epoch 7
[2023-07-19 06:46:33] [data] Shuffling data
[2023-07-19 06:46:33] [data] Done reading 20,192 sentences
[2023-07-19 06:46:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:50:54] Seen 20,192 samples
[2023-07-19 06:50:54] Starting data epoch 8 in logical epoch 8
[2023-07-19 06:50:54] [data] Shuffling data
[2023-07-19 06:50:54] [data] Done reading 20,192 sentences
[2023-07-19 06:50:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:55:20] Seen 20,192 samples
[2023-07-19 06:55:20] Starting data epoch 9 in logical epoch 9
[2023-07-19 06:55:20] [data] Shuffling data
[2023-07-19 06:55:20] [data] Done reading 20,192 sentences
[2023-07-19 06:55:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 06:59:40] Seen 20,192 samples
[2023-07-19 06:59:40] Starting data epoch 10 in logical epoch 10
[2023-07-19 06:59:40] [data] Shuffling data
[2023-07-19 06:59:40] [data] Done reading 20,192 sentences
[2023-07-19 06:59:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 07:04:10] Seen 20,192 samples
[2023-07-19 07:04:10] Starting data epoch 11 in logical epoch 11
[2023-07-19 07:04:10] Training finished
[2023-07-19 07:04:21] [valid] Ep. 11 : Up. 385 : cross-entropy : 187.223 : new best
[2023-07-19 07:06:06] [valid] Ep. 11 : Up. 385 : translation : 0 : new best
[2023-07-19 07:06:06] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-19 07:06:08] Saving Adam parameters
[2023-07-19 07:06:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-19 07:06:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 07:06:15] [marian] Running on node22.datos.cluster.uy as process 6547 with command line:
[2023-07-19 07:06:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 07:06:15] [config] after: 0e
[2023-07-19 07:06:15] [config] after-batches: 0
[2023-07-19 07:06:15] [config] after-epochs: 20
[2023-07-19 07:06:15] [config] all-caps-every: 0
[2023-07-19 07:06:15] [config] allow-unk: false
[2023-07-19 07:06:15] [config] authors: false
[2023-07-19 07:06:15] [config] beam-size: 12
[2023-07-19 07:06:15] [config] bert-class-symbol: "[CLS]"
[2023-07-19 07:06:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 07:06:15] [config] bert-masking-fraction: 0.15
[2023-07-19 07:06:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 07:06:15] [config] bert-train-type-embeddings: true
[2023-07-19 07:06:15] [config] bert-type-vocab-size: 2
[2023-07-19 07:06:15] [config] build-info: ""
[2023-07-19 07:06:15] [config] check-gradient-nan: false
[2023-07-19 07:06:15] [config] check-nan: false
[2023-07-19 07:06:15] [config] cite: false
[2023-07-19 07:06:15] [config] clip-norm: 1
[2023-07-19 07:06:15] [config] cost-scaling:
[2023-07-19 07:06:15] [config]   - 256.f
[2023-07-19 07:06:15] [config]   - 1000
[2023-07-19 07:06:15] [config]   - 2.f
[2023-07-19 07:06:15] [config]   - 256.f
[2023-07-19 07:06:15] [config] cost-type: ce-sum
[2023-07-19 07:06:15] [config] cpu-threads: 0
[2023-07-19 07:06:15] [config] data-threads: 8
[2023-07-19 07:06:15] [config] data-weighting: ""
[2023-07-19 07:06:15] [config] data-weighting-type: sentence
[2023-07-19 07:06:15] [config] dec-cell: gru
[2023-07-19 07:06:15] [config] dec-cell-base-depth: 2
[2023-07-19 07:06:15] [config] dec-cell-high-depth: 1
[2023-07-19 07:06:15] [config] dec-depth: 1
[2023-07-19 07:06:15] [config] devices:
[2023-07-19 07:06:15] [config]   - 0
[2023-07-19 07:06:15] [config] dim-emb: 512
[2023-07-19 07:06:15] [config] dim-rnn: 1024
[2023-07-19 07:06:15] [config] dim-vocabs:
[2023-07-19 07:06:15] [config]   - 16384
[2023-07-19 07:06:15] [config]   - 16384
[2023-07-19 07:06:15] [config] disp-first: 0
[2023-07-19 07:06:15] [config] disp-freq: 1000u
[2023-07-19 07:06:15] [config] disp-label-counts: true
[2023-07-19 07:06:15] [config] dropout-rnn: 0
[2023-07-19 07:06:15] [config] dropout-src: 0
[2023-07-19 07:06:15] [config] dropout-trg: 0
[2023-07-19 07:06:15] [config] dump-config: ""
[2023-07-19 07:06:15] [config] dynamic-gradient-scaling:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] early-stopping: 200
[2023-07-19 07:06:15] [config] early-stopping-on: first
[2023-07-19 07:06:15] [config] embedding-fix-src: false
[2023-07-19 07:06:15] [config] embedding-fix-trg: false
[2023-07-19 07:06:15] [config] embedding-normalization: false
[2023-07-19 07:06:15] [config] embedding-vectors:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] enc-cell: gru
[2023-07-19 07:06:15] [config] enc-cell-depth: 1
[2023-07-19 07:06:15] [config] enc-depth: 1
[2023-07-19 07:06:15] [config] enc-type: bidirectional
[2023-07-19 07:06:15] [config] english-title-case-every: 0
[2023-07-19 07:06:15] [config] exponential-smoothing: 0
[2023-07-19 07:06:15] [config] factor-weight: 1
[2023-07-19 07:06:15] [config] factors-combine: sum
[2023-07-19 07:06:15] [config] factors-dim-emb: 0
[2023-07-19 07:06:15] [config] gradient-checkpointing: false
[2023-07-19 07:06:15] [config] gradient-norm-average-window: 100
[2023-07-19 07:06:15] [config] guided-alignment: none
[2023-07-19 07:06:15] [config] guided-alignment-cost: mse
[2023-07-19 07:06:15] [config] guided-alignment-weight: 0.1
[2023-07-19 07:06:15] [config] ignore-model-config: false
[2023-07-19 07:06:15] [config] input-types:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] interpolate-env-vars: false
[2023-07-19 07:06:15] [config] keep-best: false
[2023-07-19 07:06:15] [config] label-smoothing: 0
[2023-07-19 07:06:15] [config] layer-normalization: false
[2023-07-19 07:06:15] [config] learn-rate: 0.0001
[2023-07-19 07:06:15] [config] lemma-dependency: ""
[2023-07-19 07:06:15] [config] lemma-dim-emb: 0
[2023-07-19 07:06:15] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 07:06:15] [config] log-level: info
[2023-07-19 07:06:15] [config] log-time-zone: ""
[2023-07-19 07:06:15] [config] logical-epoch:
[2023-07-19 07:06:15] [config]   - 1e
[2023-07-19 07:06:15] [config]   - 0
[2023-07-19 07:06:15] [config] lr-decay: 0
[2023-07-19 07:06:15] [config] lr-decay-freq: 50000
[2023-07-19 07:06:15] [config] lr-decay-inv-sqrt:
[2023-07-19 07:06:15] [config]   - 0
[2023-07-19 07:06:15] [config] lr-decay-repeat-warmup: false
[2023-07-19 07:06:15] [config] lr-decay-reset-optimizer: false
[2023-07-19 07:06:15] [config] lr-decay-start:
[2023-07-19 07:06:15] [config]   - 10
[2023-07-19 07:06:15] [config]   - 1
[2023-07-19 07:06:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 07:06:15] [config] lr-report: false
[2023-07-19 07:06:15] [config] lr-warmup: 0
[2023-07-19 07:06:15] [config] lr-warmup-at-reload: false
[2023-07-19 07:06:15] [config] lr-warmup-cycle: false
[2023-07-19 07:06:15] [config] lr-warmup-start-rate: 0
[2023-07-19 07:06:15] [config] max-length: 200
[2023-07-19 07:06:15] [config] max-length-crop: true
[2023-07-19 07:06:15] [config] max-length-factor: 3
[2023-07-19 07:06:15] [config] maxi-batch: 100
[2023-07-19 07:06:15] [config] maxi-batch-sort: trg
[2023-07-19 07:06:15] [config] mini-batch: 64
[2023-07-19 07:06:15] [config] mini-batch-fit: true
[2023-07-19 07:06:15] [config] mini-batch-fit-step: 10
[2023-07-19 07:06:15] [config] mini-batch-round-up: true
[2023-07-19 07:06:15] [config] mini-batch-track-lr: false
[2023-07-19 07:06:15] [config] mini-batch-warmup: 0
[2023-07-19 07:06:15] [config] mini-batch-words: 0
[2023-07-19 07:06:15] [config] mini-batch-words-ref: 0
[2023-07-19 07:06:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-19 07:06:15] [config] multi-loss-type: sum
[2023-07-19 07:06:15] [config] n-best: false
[2023-07-19 07:06:15] [config] no-nccl: false
[2023-07-19 07:06:15] [config] no-reload: false
[2023-07-19 07:06:15] [config] no-restore-corpus: false
[2023-07-19 07:06:15] [config] normalize: 0
[2023-07-19 07:06:15] [config] normalize-gradient: false
[2023-07-19 07:06:15] [config] num-devices: 0
[2023-07-19 07:06:15] [config] optimizer: adam
[2023-07-19 07:06:15] [config] optimizer-delay: 1
[2023-07-19 07:06:15] [config] optimizer-params:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] output-omit-bias: false
[2023-07-19 07:06:15] [config] overwrite: true
[2023-07-19 07:06:15] [config] precision:
[2023-07-19 07:06:15] [config]   - float16
[2023-07-19 07:06:15] [config]   - float32
[2023-07-19 07:06:15] [config] pretrained-model: ""
[2023-07-19 07:06:15] [config] quantize-biases: false
[2023-07-19 07:06:15] [config] quantize-bits: 0
[2023-07-19 07:06:15] [config] quantize-log-based: false
[2023-07-19 07:06:15] [config] quantize-optimization-steps: 0
[2023-07-19 07:06:15] [config] quiet: false
[2023-07-19 07:06:15] [config] quiet-translation: true
[2023-07-19 07:06:15] [config] relative-paths: false
[2023-07-19 07:06:15] [config] right-left: false
[2023-07-19 07:06:15] [config] save-freq: 10000u
[2023-07-19 07:06:15] [config] seed: 1234
[2023-07-19 07:06:15] [config] sentencepiece-alphas:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] sentencepiece-max-lines: 2000000
[2023-07-19 07:06:15] [config] sentencepiece-options: ""
[2023-07-19 07:06:15] [config] sharding: global
[2023-07-19 07:06:15] [config] shuffle: data
[2023-07-19 07:06:15] [config] shuffle-in-ram: false
[2023-07-19 07:06:15] [config] sigterm: save-and-exit
[2023-07-19 07:06:15] [config] skip: false
[2023-07-19 07:06:15] [config] sqlite: ""
[2023-07-19 07:06:15] [config] sqlite-drop: false
[2023-07-19 07:06:15] [config] sync-freq: 200u
[2023-07-19 07:06:15] [config] sync-sgd: false
[2023-07-19 07:06:15] [config] tempdir: /tmp
[2023-07-19 07:06:15] [config] tied-embeddings: false
[2023-07-19 07:06:15] [config] tied-embeddings-all: true
[2023-07-19 07:06:15] [config] tied-embeddings-src: false
[2023-07-19 07:06:15] [config] train-embedder-rank:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] train-sets:
[2023-07-19 07:06:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 07:06:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 07:06:15] [config] transformer-aan-activation: swish
[2023-07-19 07:06:15] [config] transformer-aan-depth: 2
[2023-07-19 07:06:15] [config] transformer-aan-nogate: false
[2023-07-19 07:06:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 07:06:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 07:06:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 07:06:15] [config] transformer-depth-scaling: false
[2023-07-19 07:06:15] [config] transformer-dim-aan: 2048
[2023-07-19 07:06:15] [config] transformer-dim-ffn: 2048
[2023-07-19 07:06:15] [config] transformer-dropout: 0
[2023-07-19 07:06:15] [config] transformer-dropout-attention: 0
[2023-07-19 07:06:15] [config] transformer-dropout-ffn: 0
[2023-07-19 07:06:15] [config] transformer-ffn-activation: swish
[2023-07-19 07:06:15] [config] transformer-ffn-depth: 2
[2023-07-19 07:06:15] [config] transformer-guided-alignment-layer: last
[2023-07-19 07:06:15] [config] transformer-heads: 8
[2023-07-19 07:06:15] [config] transformer-no-projection: false
[2023-07-19 07:06:15] [config] transformer-pool: false
[2023-07-19 07:06:15] [config] transformer-postprocess: dan
[2023-07-19 07:06:15] [config] transformer-postprocess-emb: d
[2023-07-19 07:06:15] [config] transformer-postprocess-top: ""
[2023-07-19 07:06:15] [config] transformer-preprocess: ""
[2023-07-19 07:06:15] [config] transformer-tied-layers:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] transformer-train-position-embeddings: false
[2023-07-19 07:06:15] [config] tsv: false
[2023-07-19 07:06:15] [config] tsv-fields: 0
[2023-07-19 07:06:15] [config] type: amun
[2023-07-19 07:06:15] [config] ulr: false
[2023-07-19 07:06:15] [config] ulr-dim-emb: 0
[2023-07-19 07:06:15] [config] ulr-dropout: 0
[2023-07-19 07:06:15] [config] ulr-keys-vectors: ""
[2023-07-19 07:06:15] [config] ulr-query-vectors: ""
[2023-07-19 07:06:15] [config] ulr-softmax-temperature: 1
[2023-07-19 07:06:15] [config] ulr-trainable-transformation: false
[2023-07-19 07:06:15] [config] unlikelihood-loss: false
[2023-07-19 07:06:15] [config] valid-freq: 50000000
[2023-07-19 07:06:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 07:06:15] [config] valid-max-length: 1000
[2023-07-19 07:06:15] [config] valid-metrics:
[2023-07-19 07:06:15] [config]   - cross-entropy
[2023-07-19 07:06:15] [config]   - translation
[2023-07-19 07:06:15] [config] valid-mini-batch: 32
[2023-07-19 07:06:15] [config] valid-reset-stalled: false
[2023-07-19 07:06:15] [config] valid-script-args:
[2023-07-19 07:06:15] [config]   []
[2023-07-19 07:06:15] [config] valid-script-path: ""
[2023-07-19 07:06:15] [config] valid-sets:
[2023-07-19 07:06:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 07:06:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 07:06:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 07:06:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 07:06:15] [config] vocabs:
[2023-07-19 07:06:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 07:06:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 07:06:15] [config] word-penalty: 0
[2023-07-19 07:06:15] [config] word-scores: false
[2023-07-19 07:06:15] [config] workspace: 5500
[2023-07-19 07:06:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 07:06:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 07:06:15] [training] Using single-device training
[2023-07-19 07:06:16] Synced seed 1234
[2023-07-19 07:06:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 07:06:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 07:06:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 07:06:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 07:06:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 07:06:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 07:06:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 07:06:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 07:06:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 07:06:17] [comm] Using global sharding
[2023-07-19 07:06:17] [comm] NCCLCommunicators constructed successfully
[2023-07-19 07:06:17] [training] Using 1 GPUs
[2023-07-19 07:06:17] [logits] Applying loss function for 1 factor(s)
[2023-07-19 07:06:17] [memory] Reserving 80 MB, device gpu0
[2023-07-19 07:06:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 07:06:18] [memory] Reserving 80 MB, device gpu0
[2023-07-19 07:42:29] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 07:42:30] [valid] No post-processing script given for validating translator
[2023-07-19 07:42:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 07:42:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 07:42:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 07:42:30] [comm] Using global sharding
[2023-07-19 07:42:30] [comm] NCCLCommunicators constructed successfully
[2023-07-19 07:42:30] [training] Using 1 GPUs
[2023-07-19 07:42:30] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-19 07:42:31] Allocating memory for general optimizer shards
[2023-07-19 07:42:31] [memory] Reserving 322 MB, device gpu0
[2023-07-19 07:42:31] Loading Adam parameters
[2023-07-19 07:42:31] [memory] Reserving 322 MB, device gpu0
[2023-07-19 07:42:31] [memory] Reserving 80 MB, device gpu0
[2023-07-19 07:42:32] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-19 07:42:32] [data] Restoring the corpus state to epoch 11, batch 385
[2023-07-19 07:42:32] [data] Shuffling data
[2023-07-19 07:42:32] [data] Done reading 20,192 sentences
[2023-07-19 07:42:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 07:42:32] Training started
[2023-07-19 07:42:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 07:42:32] [memory] Reserving 80 MB, device gpu0
[2023-07-19 07:42:39] Parameter type float16, optimization type float32, casting types true
[2023-07-19 07:46:42] Seen 20,192 samples
[2023-07-19 07:46:42] Starting data epoch 12 in logical epoch 12
[2023-07-19 07:46:42] [data] Shuffling data
[2023-07-19 07:46:42] [data] Done reading 20,192 sentences
[2023-07-19 07:46:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 07:51:17] Seen 20,192 samples
[2023-07-19 07:51:17] Starting data epoch 13 in logical epoch 13
[2023-07-19 07:51:17] [data] Shuffling data
[2023-07-19 07:51:17] [data] Done reading 20,192 sentences
[2023-07-19 07:51:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 07:56:00] Seen 20,192 samples
[2023-07-19 07:56:00] Starting data epoch 14 in logical epoch 14
[2023-07-19 07:56:00] [data] Shuffling data
[2023-07-19 07:56:00] [data] Done reading 20,192 sentences
[2023-07-19 07:56:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 08:00:36] Seen 20,192 samples
[2023-07-19 08:00:36] Starting data epoch 15 in logical epoch 15
[2023-07-19 08:00:36] [data] Shuffling data
[2023-07-19 08:00:36] [data] Done reading 20,192 sentences
[2023-07-19 08:00:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 08:05:00] Seen 20,192 samples
[2023-07-19 08:05:00] Starting data epoch 16 in logical epoch 16
[2023-07-19 08:05:00] [data] Shuffling data
[2023-07-19 08:05:00] [data] Done reading 20,192 sentences
[2023-07-19 08:05:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 08:09:28] Seen 20,192 samples
[2023-07-19 08:09:28] Starting data epoch 17 in logical epoch 17
[2023-07-19 08:09:28] [data] Shuffling data
[2023-07-19 08:09:28] [data] Done reading 20,192 sentences
[2023-07-19 08:09:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 08:13:59] Seen 20,192 samples
[2023-07-19 08:13:59] Starting data epoch 18 in logical epoch 18
[2023-07-19 08:13:59] [data] Shuffling data
[2023-07-19 08:13:59] [data] Done reading 20,192 sentences
[2023-07-19 08:13:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 08:18:34] Seen 20,192 samples
[2023-07-19 08:18:34] Starting data epoch 19 in logical epoch 19
[2023-07-19 08:18:34] [data] Shuffling data
[2023-07-19 08:18:34] [data] Done reading 20,192 sentences
[2023-07-19 08:18:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 08:23:04] Seen 20,192 samples
[2023-07-19 08:23:04] Starting data epoch 20 in logical epoch 20
[2023-07-19 08:23:04] [data] Shuffling data
[2023-07-19 08:23:04] [data] Done reading 20,192 sentences
[2023-07-19 08:23:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 08:27:39] Seen 20,192 samples
[2023-07-19 08:27:39] Starting data epoch 21 in logical epoch 21
[2023-07-19 08:27:39] Training finished
[2023-07-19 08:27:51] [valid] Ep. 21 : Up. 769 : cross-entropy : 170.742 : new best
[2023-07-19 08:30:55] [valid] Ep. 21 : Up. 769 : translation : 0 : new best
[2023-07-19 08:30:55] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-19 08:30:57] Saving Adam parameters
[2023-07-19 08:30:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz.optimizer.npz
[2023-07-19 08:31:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 08:31:04] [marian] Running on node22.datos.cluster.uy as process 12049 with command line:
[2023-07-19 08:31:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 08:31:04] [config] after: 0e
[2023-07-19 08:31:04] [config] after-batches: 0
[2023-07-19 08:31:04] [config] after-epochs: 30
[2023-07-19 08:31:04] [config] all-caps-every: 0
[2023-07-19 08:31:04] [config] allow-unk: false
[2023-07-19 08:31:04] [config] authors: false
[2023-07-19 08:31:04] [config] beam-size: 12
[2023-07-19 08:31:04] [config] bert-class-symbol: "[CLS]"
[2023-07-19 08:31:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 08:31:04] [config] bert-masking-fraction: 0.15
[2023-07-19 08:31:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 08:31:04] [config] bert-train-type-embeddings: true
[2023-07-19 08:31:04] [config] bert-type-vocab-size: 2
[2023-07-19 08:31:04] [config] build-info: ""
[2023-07-19 08:31:04] [config] check-gradient-nan: false
[2023-07-19 08:31:04] [config] check-nan: false
[2023-07-19 08:31:04] [config] cite: false
[2023-07-19 08:31:04] [config] clip-norm: 1
[2023-07-19 08:31:04] [config] cost-scaling:
[2023-07-19 08:31:04] [config]   - 256.f
[2023-07-19 08:31:04] [config]   - 1000
[2023-07-19 08:31:04] [config]   - 2.f
[2023-07-19 08:31:04] [config]   - 256.f
[2023-07-19 08:31:04] [config] cost-type: ce-sum
[2023-07-19 08:31:04] [config] cpu-threads: 0
[2023-07-19 08:31:04] [config] data-threads: 8
[2023-07-19 08:31:04] [config] data-weighting: ""
[2023-07-19 08:31:04] [config] data-weighting-type: sentence
[2023-07-19 08:31:04] [config] dec-cell: gru
[2023-07-19 08:31:04] [config] dec-cell-base-depth: 2
[2023-07-19 08:31:04] [config] dec-cell-high-depth: 1
[2023-07-19 08:31:04] [config] dec-depth: 1
[2023-07-19 08:31:04] [config] devices:
[2023-07-19 08:31:04] [config]   - 0
[2023-07-19 08:31:04] [config] dim-emb: 512
[2023-07-19 08:31:04] [config] dim-rnn: 1024
[2023-07-19 08:31:04] [config] dim-vocabs:
[2023-07-19 08:31:04] [config]   - 16384
[2023-07-19 08:31:04] [config]   - 16384
[2023-07-19 08:31:04] [config] disp-first: 0
[2023-07-19 08:31:04] [config] disp-freq: 1000u
[2023-07-19 08:31:04] [config] disp-label-counts: true
[2023-07-19 08:31:04] [config] dropout-rnn: 0
[2023-07-19 08:31:04] [config] dropout-src: 0
[2023-07-19 08:31:04] [config] dropout-trg: 0
[2023-07-19 08:31:04] [config] dump-config: ""
[2023-07-19 08:31:04] [config] dynamic-gradient-scaling:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] early-stopping: 200
[2023-07-19 08:31:04] [config] early-stopping-on: first
[2023-07-19 08:31:04] [config] embedding-fix-src: false
[2023-07-19 08:31:04] [config] embedding-fix-trg: false
[2023-07-19 08:31:04] [config] embedding-normalization: false
[2023-07-19 08:31:04] [config] embedding-vectors:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] enc-cell: gru
[2023-07-19 08:31:04] [config] enc-cell-depth: 1
[2023-07-19 08:31:04] [config] enc-depth: 1
[2023-07-19 08:31:04] [config] enc-type: bidirectional
[2023-07-19 08:31:04] [config] english-title-case-every: 0
[2023-07-19 08:31:04] [config] exponential-smoothing: 0
[2023-07-19 08:31:04] [config] factor-weight: 1
[2023-07-19 08:31:04] [config] factors-combine: sum
[2023-07-19 08:31:04] [config] factors-dim-emb: 0
[2023-07-19 08:31:04] [config] gradient-checkpointing: false
[2023-07-19 08:31:04] [config] gradient-norm-average-window: 100
[2023-07-19 08:31:04] [config] guided-alignment: none
[2023-07-19 08:31:04] [config] guided-alignment-cost: mse
[2023-07-19 08:31:04] [config] guided-alignment-weight: 0.1
[2023-07-19 08:31:04] [config] ignore-model-config: false
[2023-07-19 08:31:04] [config] input-types:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] interpolate-env-vars: false
[2023-07-19 08:31:04] [config] keep-best: false
[2023-07-19 08:31:04] [config] label-smoothing: 0
[2023-07-19 08:31:04] [config] layer-normalization: false
[2023-07-19 08:31:04] [config] learn-rate: 0.0001
[2023-07-19 08:31:04] [config] lemma-dependency: ""
[2023-07-19 08:31:04] [config] lemma-dim-emb: 0
[2023-07-19 08:31:04] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 08:31:04] [config] log-level: info
[2023-07-19 08:31:04] [config] log-time-zone: ""
[2023-07-19 08:31:04] [config] logical-epoch:
[2023-07-19 08:31:04] [config]   - 1e
[2023-07-19 08:31:04] [config]   - 0
[2023-07-19 08:31:04] [config] lr-decay: 0
[2023-07-19 08:31:04] [config] lr-decay-freq: 50000
[2023-07-19 08:31:04] [config] lr-decay-inv-sqrt:
[2023-07-19 08:31:04] [config]   - 0
[2023-07-19 08:31:04] [config] lr-decay-repeat-warmup: false
[2023-07-19 08:31:04] [config] lr-decay-reset-optimizer: false
[2023-07-19 08:31:04] [config] lr-decay-start:
[2023-07-19 08:31:04] [config]   - 10
[2023-07-19 08:31:04] [config]   - 1
[2023-07-19 08:31:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 08:31:04] [config] lr-report: false
[2023-07-19 08:31:04] [config] lr-warmup: 0
[2023-07-19 08:31:04] [config] lr-warmup-at-reload: false
[2023-07-19 08:31:04] [config] lr-warmup-cycle: false
[2023-07-19 08:31:04] [config] lr-warmup-start-rate: 0
[2023-07-19 08:31:04] [config] max-length: 200
[2023-07-19 08:31:04] [config] max-length-crop: true
[2023-07-19 08:31:04] [config] max-length-factor: 3
[2023-07-19 08:31:04] [config] maxi-batch: 100
[2023-07-19 08:31:04] [config] maxi-batch-sort: trg
[2023-07-19 08:31:04] [config] mini-batch: 64
[2023-07-19 08:31:04] [config] mini-batch-fit: true
[2023-07-19 08:31:04] [config] mini-batch-fit-step: 10
[2023-07-19 08:31:04] [config] mini-batch-round-up: true
[2023-07-19 08:31:04] [config] mini-batch-track-lr: false
[2023-07-19 08:31:04] [config] mini-batch-warmup: 0
[2023-07-19 08:31:04] [config] mini-batch-words: 0
[2023-07-19 08:31:04] [config] mini-batch-words-ref: 0
[2023-07-19 08:31:04] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node22/gn_es_test_grid_lvl2_july_node22_max-length_200.npz
[2023-07-19 08:31:04] [config] multi-loss-type: sum
[2023-07-19 08:31:04] [config] n-best: false
[2023-07-19 08:31:04] [config] no-nccl: false
[2023-07-19 08:31:04] [config] no-reload: false
[2023-07-19 08:31:04] [config] no-restore-corpus: false
[2023-07-19 08:31:04] [config] normalize: 0
[2023-07-19 08:31:04] [config] normalize-gradient: false
[2023-07-19 08:31:04] [config] num-devices: 0
[2023-07-19 08:31:04] [config] optimizer: adam
[2023-07-19 08:31:04] [config] optimizer-delay: 1
[2023-07-19 08:31:04] [config] optimizer-params:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] output-omit-bias: false
[2023-07-19 08:31:04] [config] overwrite: true
[2023-07-19 08:31:04] [config] precision:
[2023-07-19 08:31:04] [config]   - float16
[2023-07-19 08:31:04] [config]   - float32
[2023-07-19 08:31:04] [config] pretrained-model: ""
[2023-07-19 08:31:04] [config] quantize-biases: false
[2023-07-19 08:31:04] [config] quantize-bits: 0
[2023-07-19 08:31:04] [config] quantize-log-based: false
[2023-07-19 08:31:04] [config] quantize-optimization-steps: 0
[2023-07-19 08:31:04] [config] quiet: false
[2023-07-19 08:31:04] [config] quiet-translation: true
[2023-07-19 08:31:04] [config] relative-paths: false
[2023-07-19 08:31:04] [config] right-left: false
[2023-07-19 08:31:04] [config] save-freq: 10000u
[2023-07-19 08:31:04] [config] seed: 1234
[2023-07-19 08:31:04] [config] sentencepiece-alphas:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] sentencepiece-max-lines: 2000000
[2023-07-19 08:31:04] [config] sentencepiece-options: ""
[2023-07-19 08:31:04] [config] sharding: global
[2023-07-19 08:31:04] [config] shuffle: data
[2023-07-19 08:31:04] [config] shuffle-in-ram: false
[2023-07-19 08:31:04] [config] sigterm: save-and-exit
[2023-07-19 08:31:04] [config] skip: false
[2023-07-19 08:31:04] [config] sqlite: ""
[2023-07-19 08:31:04] [config] sqlite-drop: false
[2023-07-19 08:31:04] [config] sync-freq: 200u
[2023-07-19 08:31:04] [config] sync-sgd: false
[2023-07-19 08:31:04] [config] tempdir: /tmp
[2023-07-19 08:31:04] [config] tied-embeddings: false
[2023-07-19 08:31:04] [config] tied-embeddings-all: true
[2023-07-19 08:31:04] [config] tied-embeddings-src: false
[2023-07-19 08:31:04] [config] train-embedder-rank:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] train-sets:
[2023-07-19 08:31:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 08:31:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 08:31:04] [config] transformer-aan-activation: swish
[2023-07-19 08:31:04] [config] transformer-aan-depth: 2
[2023-07-19 08:31:04] [config] transformer-aan-nogate: false
[2023-07-19 08:31:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 08:31:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 08:31:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 08:31:04] [config] transformer-depth-scaling: false
[2023-07-19 08:31:04] [config] transformer-dim-aan: 2048
[2023-07-19 08:31:04] [config] transformer-dim-ffn: 2048
[2023-07-19 08:31:04] [config] transformer-dropout: 0
[2023-07-19 08:31:04] [config] transformer-dropout-attention: 0
[2023-07-19 08:31:04] [config] transformer-dropout-ffn: 0
[2023-07-19 08:31:04] [config] transformer-ffn-activation: swish
[2023-07-19 08:31:04] [config] transformer-ffn-depth: 2
[2023-07-19 08:31:04] [config] transformer-guided-alignment-layer: last
[2023-07-19 08:31:04] [config] transformer-heads: 8
[2023-07-19 08:31:04] [config] transformer-no-projection: false
[2023-07-19 08:31:04] [config] transformer-pool: false
[2023-07-19 08:31:04] [config] transformer-postprocess: dan
[2023-07-19 08:31:04] [config] transformer-postprocess-emb: d
[2023-07-19 08:31:04] [config] transformer-postprocess-top: ""
[2023-07-19 08:31:04] [config] transformer-preprocess: ""
[2023-07-19 08:31:04] [config] transformer-tied-layers:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] transformer-train-position-embeddings: false
[2023-07-19 08:31:04] [config] tsv: false
[2023-07-19 08:31:04] [config] tsv-fields: 0
[2023-07-19 08:31:04] [config] type: amun
[2023-07-19 08:31:04] [config] ulr: false
[2023-07-19 08:31:04] [config] ulr-dim-emb: 0
[2023-07-19 08:31:04] [config] ulr-dropout: 0
[2023-07-19 08:31:04] [config] ulr-keys-vectors: ""
[2023-07-19 08:31:04] [config] ulr-query-vectors: ""
[2023-07-19 08:31:04] [config] ulr-softmax-temperature: 1
[2023-07-19 08:31:04] [config] ulr-trainable-transformation: false
[2023-07-19 08:31:04] [config] unlikelihood-loss: false
[2023-07-19 08:31:04] [config] valid-freq: 50000000
[2023-07-19 08:31:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node22.log
[2023-07-19 08:31:04] [config] valid-max-length: 1000
[2023-07-19 08:31:04] [config] valid-metrics:
[2023-07-19 08:31:04] [config]   - cross-entropy
[2023-07-19 08:31:04] [config]   - translation
[2023-07-19 08:31:04] [config] valid-mini-batch: 32
[2023-07-19 08:31:04] [config] valid-reset-stalled: false
[2023-07-19 08:31:04] [config] valid-script-args:
[2023-07-19 08:31:04] [config]   []
[2023-07-19 08:31:04] [config] valid-script-path: ""
[2023-07-19 08:31:04] [config] valid-sets:
[2023-07-19 08:31:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 08:31:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 08:31:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 08:31:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 08:31:04] [config] vocabs:
[2023-07-19 08:31:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 08:31:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 08:31:04] [config] word-penalty: 0
[2023-07-19 08:31:04] [config] word-scores: false
[2023-07-19 08:31:04] [config] workspace: 5500
[2023-07-19 08:31:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 08:31:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 08:31:04] [training] Using single-device training
[2023-07-19 08:31:04] Synced seed 1234
[2023-07-19 08:31:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 08:31:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 08:31:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 08:31:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 08:31:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 08:31:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 08:31:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 08:31:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 08:31:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 08:31:06] [comm] Using global sharding
[2023-07-19 08:31:06] [comm] NCCLCommunicators constructed successfully
[2023-07-19 08:31:06] [training] Using 1 GPUs
[2023-07-19 08:31:06] [logits] Applying loss function for 1 factor(s)
[2023-07-19 08:31:06] [memory] Reserving 80 MB, device gpu0
[2023-07-19 08:31:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 08:31:06] [memory] Reserving 80 MB, device gpu0
