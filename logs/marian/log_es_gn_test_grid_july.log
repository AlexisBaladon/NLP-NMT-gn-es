[2023-07-05 10:19:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:19:35] [marian] Running on node22.datos.cluster.uy as process 29577 with command line:
[2023-07-05 10:19:35] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 10:19:35] [config] after: 0e
[2023-07-05 10:19:35] [config] after-batches: 0
[2023-07-05 10:19:35] [config] after-epochs: 10
[2023-07-05 10:19:35] [config] all-caps-every: 0
[2023-07-05 10:19:35] [config] allow-unk: false
[2023-07-05 10:19:35] [config] authors: false
[2023-07-05 10:19:35] [config] beam-size: 12
[2023-07-05 10:19:35] [config] bert-class-symbol: "[CLS]"
[2023-07-05 10:19:35] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 10:19:35] [config] bert-masking-fraction: 0.15
[2023-07-05 10:19:35] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 10:19:35] [config] bert-train-type-embeddings: true
[2023-07-05 10:19:35] [config] bert-type-vocab-size: 2
[2023-07-05 10:19:35] [config] build-info: ""
[2023-07-05 10:19:35] [config] check-gradient-nan: false
[2023-07-05 10:19:35] [config] check-nan: false
[2023-07-05 10:19:35] [config] cite: false
[2023-07-05 10:19:35] [config] clip-norm: 1
[2023-07-05 10:19:35] [config] cost-scaling:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] cost-type: ce-sum
[2023-07-05 10:19:35] [config] cpu-threads: 0
[2023-07-05 10:19:35] [config] data-threads: 8
[2023-07-05 10:19:35] [config] data-weighting: ""
[2023-07-05 10:19:35] [config] data-weighting-type: sentence
[2023-07-05 10:19:35] [config] dec-cell: gru
[2023-07-05 10:19:35] [config] dec-cell-base-depth: 2
[2023-07-05 10:19:35] [config] dec-cell-high-depth: 1
[2023-07-05 10:19:35] [config] dec-depth: 1
[2023-07-05 10:19:35] [config] devices:
[2023-07-05 10:19:35] [config]   - 0
[2023-07-05 10:19:35] [config] dim-emb: 512
[2023-07-05 10:19:35] [config] dim-rnn: 1024
[2023-07-05 10:19:35] [config] dim-vocabs:
[2023-07-05 10:19:35] [config]   - 0
[2023-07-05 10:19:35] [config]   - 0
[2023-07-05 10:19:35] [config] disp-first: 0
[2023-07-05 10:19:35] [config] disp-freq: 1000u
[2023-07-05 10:19:35] [config] disp-label-counts: true
[2023-07-05 10:19:35] [config] dropout-rnn: 0
[2023-07-05 10:19:35] [config] dropout-src: 0
[2023-07-05 10:19:35] [config] dropout-trg: 0
[2023-07-05 10:19:35] [config] dump-config: ""
[2023-07-05 10:19:35] [config] dynamic-gradient-scaling:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] early-stopping: 10
[2023-07-05 10:19:35] [config] early-stopping-on: first
[2023-07-05 10:19:35] [config] embedding-fix-src: false
[2023-07-05 10:19:35] [config] embedding-fix-trg: false
[2023-07-05 10:19:35] [config] embedding-normalization: false
[2023-07-05 10:19:35] [config] embedding-vectors:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] enc-cell: gru
[2023-07-05 10:19:35] [config] enc-cell-depth: 1
[2023-07-05 10:19:35] [config] enc-depth: 1
[2023-07-05 10:19:35] [config] enc-type: bidirectional
[2023-07-05 10:19:35] [config] english-title-case-every: 0
[2023-07-05 10:19:35] [config] exponential-smoothing: 0
[2023-07-05 10:19:35] [config] factor-weight: 1
[2023-07-05 10:19:35] [config] factors-combine: sum
[2023-07-05 10:19:35] [config] factors-dim-emb: 0
[2023-07-05 10:19:35] [config] gradient-checkpointing: false
[2023-07-05 10:19:35] [config] gradient-norm-average-window: 100
[2023-07-05 10:19:35] [config] guided-alignment: none
[2023-07-05 10:19:35] [config] guided-alignment-cost: mse
[2023-07-05 10:19:35] [config] guided-alignment-weight: 0.1
[2023-07-05 10:19:35] [config] ignore-model-config: false
[2023-07-05 10:19:35] [config] input-types:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] interpolate-env-vars: false
[2023-07-05 10:19:35] [config] keep-best: false
[2023-07-05 10:19:35] [config] label-smoothing: 0
[2023-07-05 10:19:35] [config] layer-normalization: false
[2023-07-05 10:19:35] [config] learn-rate: 0.0001
[2023-07-05 10:19:35] [config] lemma-dependency: ""
[2023-07-05 10:19:35] [config] lemma-dim-emb: 0
[2023-07-05 10:19:35] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 10:19:35] [config] log-level: info
[2023-07-05 10:19:35] [config] log-time-zone: ""
[2023-07-05 10:19:35] [config] logical-epoch:
[2023-07-05 10:19:35] [config]   - 1e
[2023-07-05 10:19:35] [config]   - 0
[2023-07-05 10:19:35] [config] lr-decay: 0
[2023-07-05 10:19:35] [config] lr-decay-freq: 50000
[2023-07-05 10:19:35] [config] lr-decay-inv-sqrt:
[2023-07-05 10:19:35] [config]   - 0
[2023-07-05 10:19:35] [config] lr-decay-repeat-warmup: false
[2023-07-05 10:19:35] [config] lr-decay-reset-optimizer: false
[2023-07-05 10:19:35] [config] lr-decay-start:
[2023-07-05 10:19:35] [config]   - 10
[2023-07-05 10:19:35] [config]   - 1
[2023-07-05 10:19:35] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 10:19:35] [config] lr-report: false
[2023-07-05 10:19:35] [config] lr-warmup: 0
[2023-07-05 10:19:35] [config] lr-warmup-at-reload: false
[2023-07-05 10:19:35] [config] lr-warmup-cycle: false
[2023-07-05 10:19:35] [config] lr-warmup-start-rate: 0
[2023-07-05 10:19:35] [config] max-length: 50
[2023-07-05 10:19:35] [config] max-length-crop: false
[2023-07-05 10:19:35] [config] max-length-factor: 3
[2023-07-05 10:19:35] [config] maxi-batch: 100
[2023-07-05 10:19:35] [config] maxi-batch-sort: trg
[2023-07-05 10:19:35] [config] mini-batch: 64
[2023-07-05 10:19:35] [config] mini-batch-fit: false
[2023-07-05 10:19:35] [config] mini-batch-fit-step: 10
[2023-07-05 10:19:35] [config] mini-batch-round-up: true
[2023-07-05 10:19:35] [config] mini-batch-track-lr: false
[2023-07-05 10:19:35] [config] mini-batch-warmup: 0
[2023-07-05 10:19:35] [config] mini-batch-words: 0
[2023-07-05 10:19:35] [config] mini-batch-words-ref: 0
[2023-07-05 10:19:35] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 10:19:35] [config] multi-loss-type: sum
[2023-07-05 10:19:35] [config] n-best: false
[2023-07-05 10:19:35] [config] no-nccl: false
[2023-07-05 10:19:35] [config] no-reload: false
[2023-07-05 10:19:35] [config] no-restore-corpus: false
[2023-07-05 10:19:35] [config] normalize: 0
[2023-07-05 10:19:35] [config] normalize-gradient: false
[2023-07-05 10:19:35] [config] num-devices: 0
[2023-07-05 10:19:35] [config] optimizer: adam
[2023-07-05 10:19:35] [config] optimizer-delay: 1
[2023-07-05 10:19:35] [config] optimizer-params:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] output-omit-bias: false
[2023-07-05 10:19:35] [config] overwrite: true
[2023-07-05 10:19:35] [config] precision:
[2023-07-05 10:19:35] [config]   - float32
[2023-07-05 10:19:35] [config]   - float32
[2023-07-05 10:19:35] [config] pretrained-model: ""
[2023-07-05 10:19:35] [config] quantize-biases: false
[2023-07-05 10:19:35] [config] quantize-bits: 0
[2023-07-05 10:19:35] [config] quantize-log-based: false
[2023-07-05 10:19:35] [config] quantize-optimization-steps: 0
[2023-07-05 10:19:35] [config] quiet: false
[2023-07-05 10:19:35] [config] quiet-translation: true
[2023-07-05 10:19:35] [config] relative-paths: false
[2023-07-05 10:19:35] [config] right-left: false
[2023-07-05 10:19:35] [config] save-freq: 10000u
[2023-07-05 10:19:35] [config] seed: 1234
[2023-07-05 10:19:35] [config] sentencepiece-alphas:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] sentencepiece-max-lines: 2000000
[2023-07-05 10:19:35] [config] sentencepiece-options: ""
[2023-07-05 10:19:35] [config] sharding: global
[2023-07-05 10:19:35] [config] shuffle: data
[2023-07-05 10:19:35] [config] shuffle-in-ram: false
[2023-07-05 10:19:35] [config] sigterm: save-and-exit
[2023-07-05 10:19:35] [config] skip: false
[2023-07-05 10:19:35] [config] sqlite: ""
[2023-07-05 10:19:35] [config] sqlite-drop: false
[2023-07-05 10:19:35] [config] sync-freq: 200u
[2023-07-05 10:19:35] [config] sync-sgd: false
[2023-07-05 10:19:35] [config] tempdir: /tmp
[2023-07-05 10:19:35] [config] tied-embeddings: false
[2023-07-05 10:19:35] [config] tied-embeddings-all: false
[2023-07-05 10:19:35] [config] tied-embeddings-src: false
[2023-07-05 10:19:35] [config] train-embedder-rank:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] train-sets:
[2023-07-05 10:19:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 10:19:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 10:19:35] [config] transformer-aan-activation: swish
[2023-07-05 10:19:35] [config] transformer-aan-depth: 2
[2023-07-05 10:19:35] [config] transformer-aan-nogate: false
[2023-07-05 10:19:35] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 10:19:35] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 10:19:35] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 10:19:35] [config] transformer-depth-scaling: false
[2023-07-05 10:19:35] [config] transformer-dim-aan: 2048
[2023-07-05 10:19:35] [config] transformer-dim-ffn: 2048
[2023-07-05 10:19:35] [config] transformer-dropout: 0
[2023-07-05 10:19:35] [config] transformer-dropout-attention: 0
[2023-07-05 10:19:35] [config] transformer-dropout-ffn: 0
[2023-07-05 10:19:35] [config] transformer-ffn-activation: swish
[2023-07-05 10:19:35] [config] transformer-ffn-depth: 2
[2023-07-05 10:19:35] [config] transformer-guided-alignment-layer: last
[2023-07-05 10:19:35] [config] transformer-heads: 8
[2023-07-05 10:19:35] [config] transformer-no-projection: false
[2023-07-05 10:19:35] [config] transformer-pool: false
[2023-07-05 10:19:35] [config] transformer-postprocess: dan
[2023-07-05 10:19:35] [config] transformer-postprocess-emb: d
[2023-07-05 10:19:35] [config] transformer-postprocess-top: ""
[2023-07-05 10:19:35] [config] transformer-preprocess: ""
[2023-07-05 10:19:35] [config] transformer-tied-layers:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] transformer-train-position-embeddings: false
[2023-07-05 10:19:35] [config] tsv: false
[2023-07-05 10:19:35] [config] tsv-fields: 0
[2023-07-05 10:19:35] [config] type: amun
[2023-07-05 10:19:35] [config] ulr: false
[2023-07-05 10:19:35] [config] ulr-dim-emb: 0
[2023-07-05 10:19:35] [config] ulr-dropout: 0
[2023-07-05 10:19:35] [config] ulr-keys-vectors: ""
[2023-07-05 10:19:35] [config] ulr-query-vectors: ""
[2023-07-05 10:19:35] [config] ulr-softmax-temperature: 1
[2023-07-05 10:19:35] [config] ulr-trainable-transformation: false
[2023-07-05 10:19:35] [config] unlikelihood-loss: false
[2023-07-05 10:19:35] [config] valid-freq: 50000000
[2023-07-05 10:19:35] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 10:19:35] [config] valid-max-length: 1000
[2023-07-05 10:19:35] [config] valid-metrics:
[2023-07-05 10:19:35] [config]   - cross-entropy
[2023-07-05 10:19:35] [config]   - translation
[2023-07-05 10:19:35] [config] valid-mini-batch: 32
[2023-07-05 10:19:35] [config] valid-reset-stalled: false
[2023-07-05 10:19:35] [config] valid-script-args:
[2023-07-05 10:19:35] [config]   []
[2023-07-05 10:19:35] [config] valid-script-path: ""
[2023-07-05 10:19:35] [config] valid-sets:
[2023-07-05 10:19:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 10:19:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 10:19:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 10:19:35] [config] vocabs:
[2023-07-05 10:19:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 10:19:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 10:19:35] [config] word-penalty: 0
[2023-07-05 10:19:35] [config] word-scores: false
[2023-07-05 10:19:35] [config] workspace: 2048
[2023-07-05 10:19:35] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:19:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 10:19:35] [training] Using single-device training
[2023-07-05 10:19:37] Synced seed 1234
[2023-07-05 10:19:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 10:19:38] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 10:19:38] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 10:19:38] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 10:19:39] [valid] No post-processing script given for validating translator
[2023-07-05 10:19:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 10:19:41] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 10:19:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 10:19:42] [comm] Using global sharding
[2023-07-05 10:19:42] [comm] NCCLCommunicators constructed successfully
[2023-07-05 10:19:42] [training] Using 1 GPUs
[2023-07-05 10:19:42] Training started
[2023-07-05 10:19:42] [data] Shuffling data
[2023-07-05 10:19:43] [data] Done reading 20,192 sentences
[2023-07-05 10:19:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:19:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 10:19:43] [logits] Applying loss function for 1 factor(s)
[2023-07-05 10:19:43] [memory] Reserving 411 MB, device gpu0
[2023-07-05 10:19:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 10:19:54] [memory] Reserving 411 MB, device gpu0
[2023-07-05 10:19:54] Parameter type float32, optimization type float32, casting types false
[2023-07-05 10:19:54] Allocating memory for Adam-specific shards
[2023-07-05 10:19:54] [memory] Reserving 823 MB, device gpu0
[2023-07-05 10:20:32] Seen 18,843 samples
[2023-07-05 10:20:32] Starting data epoch 2 in logical epoch 2
[2023-07-05 10:20:32] [data] Shuffling data
[2023-07-05 10:20:32] [data] Done reading 20,192 sentences
[2023-07-05 10:20:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:21:11] Seen 18,843 samples
[2023-07-05 10:21:11] Starting data epoch 3 in logical epoch 3
[2023-07-05 10:21:11] [data] Shuffling data
[2023-07-05 10:21:11] [data] Done reading 20,192 sentences
[2023-07-05 10:21:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:22:05] Seen 18,843 samples
[2023-07-05 10:22:05] Starting data epoch 4 in logical epoch 4
[2023-07-05 10:22:05] [data] Shuffling data
[2023-07-05 10:22:05] [data] Done reading 20,192 sentences
[2023-07-05 10:22:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:22:33] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 7.39923954 * 933,288 @ 570 after 933,288 : Time 174.79s : 5339.59 words/s : gNorm 1.1873
[2023-07-05 10:23:26] Seen 18,843 samples
[2023-07-05 10:23:27] Starting data epoch 5 in logical epoch 5
[2023-07-05 10:23:27] [data] Shuffling data
[2023-07-05 10:23:33] [data] Done reading 20,192 sentences
[2023-07-05 10:23:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:24:49] Seen 18,843 samples
[2023-07-05 10:24:49] Starting data epoch 6 in logical epoch 6
[2023-07-05 10:24:49] [data] Shuffling data
[2023-07-05 10:24:49] [data] Done reading 20,192 sentences
[2023-07-05 10:24:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:26:02] Seen 18,843 samples
[2023-07-05 10:26:02] Starting data epoch 7 in logical epoch 7
[2023-07-05 10:26:02] [data] Shuffling data
[2023-07-05 10:26:02] [data] Done reading 20,192 sentences
[2023-07-05 10:26:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:26:52] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 6.38114738 * 926,551 @ 2,125 after 1,859,839 : Time 259.08s : 3576.35 words/s : gNorm 1.2583
[2023-07-05 10:27:12] Seen 18,843 samples
[2023-07-05 10:27:12] Starting data epoch 8 in logical epoch 8
[2023-07-05 10:27:12] [data] Shuffling data
[2023-07-05 10:27:13] [data] Done reading 20,192 sentences
[2023-07-05 10:27:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:28:26] Seen 18,843 samples
[2023-07-05 10:28:26] Starting data epoch 9 in logical epoch 9
[2023-07-05 10:28:26] [data] Shuffling data
[2023-07-05 10:28:26] [data] Done reading 20,192 sentences
[2023-07-05 10:28:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:29:41] Seen 18,843 samples
[2023-07-05 10:29:41] Starting data epoch 10 in logical epoch 10
[2023-07-05 10:29:41] [data] Shuffling data
[2023-07-05 10:29:41] [data] Done reading 20,192 sentences
[2023-07-05 10:29:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:30:54] Seen 18,843 samples
[2023-07-05 10:30:54] Starting data epoch 11 in logical epoch 11
[2023-07-05 10:30:54] Training finished
[2023-07-05 10:31:03] [valid] Ep. 11 : Up. 2968 : cross-entropy : 87.4293 : new best
[2023-07-05 10:34:59] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-05 10:34:59] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 10:35:15] Saving Adam parameters
[2023-07-05 10:35:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 10:35:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:35:50] [marian] Running on node22.datos.cluster.uy as process 3309 with command line:
[2023-07-05 10:35:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 10:35:51] [config] after: 0e
[2023-07-05 10:35:51] [config] after-batches: 0
[2023-07-05 10:35:51] [config] after-epochs: 20
[2023-07-05 10:35:51] [config] all-caps-every: 0
[2023-07-05 10:35:51] [config] allow-unk: false
[2023-07-05 10:35:51] [config] authors: false
[2023-07-05 10:35:51] [config] beam-size: 12
[2023-07-05 10:35:51] [config] bert-class-symbol: "[CLS]"
[2023-07-05 10:35:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 10:35:51] [config] bert-masking-fraction: 0.15
[2023-07-05 10:35:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 10:35:51] [config] bert-train-type-embeddings: true
[2023-07-05 10:35:51] [config] bert-type-vocab-size: 2
[2023-07-05 10:35:51] [config] build-info: ""
[2023-07-05 10:35:51] [config] check-gradient-nan: false
[2023-07-05 10:35:51] [config] check-nan: false
[2023-07-05 10:35:51] [config] cite: false
[2023-07-05 10:35:51] [config] clip-norm: 1
[2023-07-05 10:35:51] [config] cost-scaling:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] cost-type: ce-sum
[2023-07-05 10:35:51] [config] cpu-threads: 0
[2023-07-05 10:35:51] [config] data-threads: 8
[2023-07-05 10:35:51] [config] data-weighting: ""
[2023-07-05 10:35:51] [config] data-weighting-type: sentence
[2023-07-05 10:35:51] [config] dec-cell: gru
[2023-07-05 10:35:51] [config] dec-cell-base-depth: 2
[2023-07-05 10:35:51] [config] dec-cell-high-depth: 1
[2023-07-05 10:35:51] [config] dec-depth: 1
[2023-07-05 10:35:51] [config] devices:
[2023-07-05 10:35:51] [config]   - 0
[2023-07-05 10:35:51] [config] dim-emb: 512
[2023-07-05 10:35:51] [config] dim-rnn: 1024
[2023-07-05 10:35:51] [config] dim-vocabs:
[2023-07-05 10:35:51] [config]   - 36507
[2023-07-05 10:35:51] [config]   - 54042
[2023-07-05 10:35:51] [config] disp-first: 0
[2023-07-05 10:35:51] [config] disp-freq: 1000u
[2023-07-05 10:35:51] [config] disp-label-counts: true
[2023-07-05 10:35:51] [config] dropout-rnn: 0
[2023-07-05 10:35:51] [config] dropout-src: 0
[2023-07-05 10:35:51] [config] dropout-trg: 0
[2023-07-05 10:35:51] [config] dump-config: ""
[2023-07-05 10:35:51] [config] dynamic-gradient-scaling:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] early-stopping: 10
[2023-07-05 10:35:51] [config] early-stopping-on: first
[2023-07-05 10:35:51] [config] embedding-fix-src: false
[2023-07-05 10:35:51] [config] embedding-fix-trg: false
[2023-07-05 10:35:51] [config] embedding-normalization: false
[2023-07-05 10:35:51] [config] embedding-vectors:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] enc-cell: gru
[2023-07-05 10:35:51] [config] enc-cell-depth: 1
[2023-07-05 10:35:51] [config] enc-depth: 1
[2023-07-05 10:35:51] [config] enc-type: bidirectional
[2023-07-05 10:35:51] [config] english-title-case-every: 0
[2023-07-05 10:35:51] [config] exponential-smoothing: 0
[2023-07-05 10:35:51] [config] factor-weight: 1
[2023-07-05 10:35:51] [config] factors-combine: sum
[2023-07-05 10:35:51] [config] factors-dim-emb: 0
[2023-07-05 10:35:51] [config] gradient-checkpointing: false
[2023-07-05 10:35:51] [config] gradient-norm-average-window: 100
[2023-07-05 10:35:51] [config] guided-alignment: none
[2023-07-05 10:35:51] [config] guided-alignment-cost: mse
[2023-07-05 10:35:51] [config] guided-alignment-weight: 0.1
[2023-07-05 10:35:51] [config] ignore-model-config: false
[2023-07-05 10:35:51] [config] input-types:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] interpolate-env-vars: false
[2023-07-05 10:35:51] [config] keep-best: false
[2023-07-05 10:35:51] [config] label-smoothing: 0
[2023-07-05 10:35:51] [config] layer-normalization: false
[2023-07-05 10:35:51] [config] learn-rate: 0.0001
[2023-07-05 10:35:51] [config] lemma-dependency: ""
[2023-07-05 10:35:51] [config] lemma-dim-emb: 0
[2023-07-05 10:35:51] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 10:35:51] [config] log-level: info
[2023-07-05 10:35:51] [config] log-time-zone: ""
[2023-07-05 10:35:51] [config] logical-epoch:
[2023-07-05 10:35:51] [config]   - 1e
[2023-07-05 10:35:51] [config]   - 0
[2023-07-05 10:35:51] [config] lr-decay: 0
[2023-07-05 10:35:51] [config] lr-decay-freq: 50000
[2023-07-05 10:35:51] [config] lr-decay-inv-sqrt:
[2023-07-05 10:35:51] [config]   - 0
[2023-07-05 10:35:51] [config] lr-decay-repeat-warmup: false
[2023-07-05 10:35:51] [config] lr-decay-reset-optimizer: false
[2023-07-05 10:35:51] [config] lr-decay-start:
[2023-07-05 10:35:51] [config]   - 10
[2023-07-05 10:35:51] [config]   - 1
[2023-07-05 10:35:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 10:35:51] [config] lr-report: false
[2023-07-05 10:35:51] [config] lr-warmup: 0
[2023-07-05 10:35:51] [config] lr-warmup-at-reload: false
[2023-07-05 10:35:51] [config] lr-warmup-cycle: false
[2023-07-05 10:35:51] [config] lr-warmup-start-rate: 0
[2023-07-05 10:35:51] [config] max-length: 50
[2023-07-05 10:35:51] [config] max-length-crop: false
[2023-07-05 10:35:51] [config] max-length-factor: 3
[2023-07-05 10:35:51] [config] maxi-batch: 100
[2023-07-05 10:35:51] [config] maxi-batch-sort: trg
[2023-07-05 10:35:51] [config] mini-batch: 64
[2023-07-05 10:35:51] [config] mini-batch-fit: false
[2023-07-05 10:35:51] [config] mini-batch-fit-step: 10
[2023-07-05 10:35:51] [config] mini-batch-round-up: true
[2023-07-05 10:35:51] [config] mini-batch-track-lr: false
[2023-07-05 10:35:51] [config] mini-batch-warmup: 0
[2023-07-05 10:35:51] [config] mini-batch-words: 0
[2023-07-05 10:35:51] [config] mini-batch-words-ref: 0
[2023-07-05 10:35:51] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 10:35:51] [config] multi-loss-type: sum
[2023-07-05 10:35:51] [config] n-best: false
[2023-07-05 10:35:51] [config] no-nccl: false
[2023-07-05 10:35:51] [config] no-reload: false
[2023-07-05 10:35:51] [config] no-restore-corpus: false
[2023-07-05 10:35:51] [config] normalize: 0
[2023-07-05 10:35:51] [config] normalize-gradient: false
[2023-07-05 10:35:51] [config] num-devices: 0
[2023-07-05 10:35:51] [config] optimizer: adam
[2023-07-05 10:35:51] [config] optimizer-delay: 1
[2023-07-05 10:35:51] [config] optimizer-params:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] output-omit-bias: false
[2023-07-05 10:35:51] [config] overwrite: true
[2023-07-05 10:35:51] [config] precision:
[2023-07-05 10:35:51] [config]   - float32
[2023-07-05 10:35:51] [config]   - float32
[2023-07-05 10:35:51] [config] pretrained-model: ""
[2023-07-05 10:35:51] [config] quantize-biases: false
[2023-07-05 10:35:51] [config] quantize-bits: 0
[2023-07-05 10:35:51] [config] quantize-log-based: false
[2023-07-05 10:35:51] [config] quantize-optimization-steps: 0
[2023-07-05 10:35:51] [config] quiet: false
[2023-07-05 10:35:51] [config] quiet-translation: true
[2023-07-05 10:35:51] [config] relative-paths: false
[2023-07-05 10:35:51] [config] right-left: false
[2023-07-05 10:35:51] [config] save-freq: 10000u
[2023-07-05 10:35:51] [config] seed: 1234
[2023-07-05 10:35:51] [config] sentencepiece-alphas:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] sentencepiece-max-lines: 2000000
[2023-07-05 10:35:51] [config] sentencepiece-options: ""
[2023-07-05 10:35:51] [config] sharding: global
[2023-07-05 10:35:51] [config] shuffle: data
[2023-07-05 10:35:51] [config] shuffle-in-ram: false
[2023-07-05 10:35:51] [config] sigterm: save-and-exit
[2023-07-05 10:35:51] [config] skip: false
[2023-07-05 10:35:51] [config] sqlite: ""
[2023-07-05 10:35:51] [config] sqlite-drop: false
[2023-07-05 10:35:51] [config] sync-freq: 200u
[2023-07-05 10:35:51] [config] sync-sgd: false
[2023-07-05 10:35:51] [config] tempdir: /tmp
[2023-07-05 10:35:51] [config] tied-embeddings: false
[2023-07-05 10:35:51] [config] tied-embeddings-all: false
[2023-07-05 10:35:51] [config] tied-embeddings-src: false
[2023-07-05 10:35:51] [config] train-embedder-rank:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] train-sets:
[2023-07-05 10:35:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 10:35:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 10:35:51] [config] transformer-aan-activation: swish
[2023-07-05 10:35:51] [config] transformer-aan-depth: 2
[2023-07-05 10:35:51] [config] transformer-aan-nogate: false
[2023-07-05 10:35:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 10:35:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 10:35:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 10:35:51] [config] transformer-depth-scaling: false
[2023-07-05 10:35:51] [config] transformer-dim-aan: 2048
[2023-07-05 10:35:51] [config] transformer-dim-ffn: 2048
[2023-07-05 10:35:51] [config] transformer-dropout: 0
[2023-07-05 10:35:51] [config] transformer-dropout-attention: 0
[2023-07-05 10:35:51] [config] transformer-dropout-ffn: 0
[2023-07-05 10:35:51] [config] transformer-ffn-activation: swish
[2023-07-05 10:35:51] [config] transformer-ffn-depth: 2
[2023-07-05 10:35:51] [config] transformer-guided-alignment-layer: last
[2023-07-05 10:35:51] [config] transformer-heads: 8
[2023-07-05 10:35:51] [config] transformer-no-projection: false
[2023-07-05 10:35:51] [config] transformer-pool: false
[2023-07-05 10:35:51] [config] transformer-postprocess: dan
[2023-07-05 10:35:51] [config] transformer-postprocess-emb: d
[2023-07-05 10:35:51] [config] transformer-postprocess-top: ""
[2023-07-05 10:35:51] [config] transformer-preprocess: ""
[2023-07-05 10:35:51] [config] transformer-tied-layers:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] transformer-train-position-embeddings: false
[2023-07-05 10:35:51] [config] tsv: false
[2023-07-05 10:35:51] [config] tsv-fields: 0
[2023-07-05 10:35:51] [config] type: amun
[2023-07-05 10:35:51] [config] ulr: false
[2023-07-05 10:35:51] [config] ulr-dim-emb: 0
[2023-07-05 10:35:51] [config] ulr-dropout: 0
[2023-07-05 10:35:51] [config] ulr-keys-vectors: ""
[2023-07-05 10:35:51] [config] ulr-query-vectors: ""
[2023-07-05 10:35:51] [config] ulr-softmax-temperature: 1
[2023-07-05 10:35:51] [config] ulr-trainable-transformation: false
[2023-07-05 10:35:51] [config] unlikelihood-loss: false
[2023-07-05 10:35:51] [config] valid-freq: 50000000
[2023-07-05 10:35:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 10:35:51] [config] valid-max-length: 1000
[2023-07-05 10:35:51] [config] valid-metrics:
[2023-07-05 10:35:51] [config]   - cross-entropy
[2023-07-05 10:35:51] [config]   - translation
[2023-07-05 10:35:51] [config] valid-mini-batch: 32
[2023-07-05 10:35:51] [config] valid-reset-stalled: false
[2023-07-05 10:35:51] [config] valid-script-args:
[2023-07-05 10:35:51] [config]   []
[2023-07-05 10:35:51] [config] valid-script-path: ""
[2023-07-05 10:35:51] [config] valid-sets:
[2023-07-05 10:35:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 10:35:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 10:35:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 10:35:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:35:51] [config] vocabs:
[2023-07-05 10:35:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 10:35:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 10:35:51] [config] word-penalty: 0
[2023-07-05 10:35:51] [config] word-scores: false
[2023-07-05 10:35:51] [config] workspace: 2048
[2023-07-05 10:35:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:35:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 10:35:51] [training] Using single-device training
[2023-07-05 10:35:52] Synced seed 1234
[2023-07-05 10:35:52] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 10:35:52] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 10:35:52] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 10:35:52] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 10:35:52] [valid] No post-processing script given for validating translator
[2023-07-05 10:35:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 10:35:53] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 10:35:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 10:35:53] [comm] Using global sharding
[2023-07-05 10:35:53] [comm] NCCLCommunicators constructed successfully
[2023-07-05 10:35:53] [training] Using 1 GPUs
[2023-07-05 10:35:53] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 10:36:08] Loading Adam parameters
[2023-07-05 10:36:08] [memory] Reserving 823 MB, device gpu0
[2023-07-05 10:36:09] [memory] Reserving 411 MB, device gpu0
[2023-07-05 10:36:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 10:36:09] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-05 10:36:09] [data] Shuffling data
[2023-07-05 10:36:09] [data] Done reading 20,192 sentences
[2023-07-05 10:36:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:36:09] Training started
[2023-07-05 10:36:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 10:36:09] [logits] Applying loss function for 1 factor(s)
[2023-07-05 10:36:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 10:36:09] [memory] Reserving 411 MB, device gpu0
[2023-07-05 10:36:09] Parameter type float32, optimization type float32, casting types false
[2023-07-05 10:36:13] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 5.65115833 * 933,583 @ 1,024 after 2,793,422 : Time 21.25s : 43941.37 words/s : gNorm 1.4117
[2023-07-05 10:36:54] Seen 18,843 samples
[2023-07-05 10:36:54] Starting data epoch 12 in logical epoch 12
[2023-07-05 10:36:54] [data] Shuffling data
[2023-07-05 10:36:54] [data] Done reading 20,192 sentences
[2023-07-05 10:36:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:38:09] Seen 18,843 samples
[2023-07-05 10:38:09] Starting data epoch 13 in logical epoch 13
[2023-07-05 10:38:09] [data] Shuffling data
[2023-07-05 10:38:09] [data] Done reading 20,192 sentences
[2023-07-05 10:38:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:39:26] Seen 18,843 samples
[2023-07-05 10:39:26] Starting data epoch 14 in logical epoch 14
[2023-07-05 10:39:26] [data] Shuffling data
[2023-07-05 10:39:26] [data] Done reading 20,192 sentences
[2023-07-05 10:39:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:40:04] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 5.04683018 * 941,038 @ 1,472 after 3,734,460 : Time 231.19s : 4070.44 words/s : gNorm 1.5852
[2023-07-05 10:40:42] Seen 18,843 samples
[2023-07-05 10:40:42] Starting data epoch 15 in logical epoch 15
[2023-07-05 10:40:42] [data] Shuffling data
[2023-07-05 10:40:42] [data] Done reading 20,192 sentences
[2023-07-05 10:40:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:41:58] Seen 18,843 samples
[2023-07-05 10:41:58] Starting data epoch 16 in logical epoch 16
[2023-07-05 10:41:58] [data] Shuffling data
[2023-07-05 10:41:58] [data] Done reading 20,192 sentences
[2023-07-05 10:41:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:43:12] Seen 18,843 samples
[2023-07-05 10:43:12] Starting data epoch 17 in logical epoch 17
[2023-07-05 10:43:12] [data] Shuffling data
[2023-07-05 10:43:12] [data] Done reading 20,192 sentences
[2023-07-05 10:43:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:44:17] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 4.50715065 * 924,840 @ 832 after 4,659,300 : Time 252.98s : 3655.82 words/s : gNorm 1.5876
[2023-07-05 10:44:28] Seen 18,843 samples
[2023-07-05 10:44:28] Starting data epoch 18 in logical epoch 18
[2023-07-05 10:44:28] [data] Shuffling data
[2023-07-05 10:44:28] [data] Done reading 20,192 sentences
[2023-07-05 10:44:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:45:42] Seen 18,843 samples
[2023-07-05 10:45:42] Starting data epoch 19 in logical epoch 19
[2023-07-05 10:45:42] [data] Shuffling data
[2023-07-05 10:45:42] [data] Done reading 20,192 sentences
[2023-07-05 10:45:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:46:58] Seen 18,843 samples
[2023-07-05 10:46:58] Starting data epoch 20 in logical epoch 20
[2023-07-05 10:46:58] [data] Shuffling data
[2023-07-05 10:46:58] [data] Done reading 20,192 sentences
[2023-07-05 10:46:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:48:16] Seen 18,843 samples
[2023-07-05 10:48:16] Starting data epoch 21 in logical epoch 21
[2023-07-05 10:48:16] Training finished
[2023-07-05 10:48:24] [valid] Ep. 21 : Up. 5933 : cross-entropy : 89.1119 : stalled 1 times (last best: 87.4293)
[2023-07-05 10:51:09] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-07-05 10:51:09] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 10:51:14] Saving Adam parameters
[2023-07-05 10:51:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 10:51:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:51:28] [marian] Running on node22.datos.cluster.uy as process 17777 with command line:
[2023-07-05 10:51:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 10:51:28] [config] after: 0e
[2023-07-05 10:51:28] [config] after-batches: 0
[2023-07-05 10:51:28] [config] after-epochs: 30
[2023-07-05 10:51:28] [config] all-caps-every: 0
[2023-07-05 10:51:28] [config] allow-unk: false
[2023-07-05 10:51:28] [config] authors: false
[2023-07-05 10:51:28] [config] beam-size: 12
[2023-07-05 10:51:28] [config] bert-class-symbol: "[CLS]"
[2023-07-05 10:51:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 10:51:28] [config] bert-masking-fraction: 0.15
[2023-07-05 10:51:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 10:51:28] [config] bert-train-type-embeddings: true
[2023-07-05 10:51:28] [config] bert-type-vocab-size: 2
[2023-07-05 10:51:28] [config] build-info: ""
[2023-07-05 10:51:28] [config] check-gradient-nan: false
[2023-07-05 10:51:28] [config] check-nan: false
[2023-07-05 10:51:28] [config] cite: false
[2023-07-05 10:51:28] [config] clip-norm: 1
[2023-07-05 10:51:28] [config] cost-scaling:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] cost-type: ce-sum
[2023-07-05 10:51:28] [config] cpu-threads: 0
[2023-07-05 10:51:28] [config] data-threads: 8
[2023-07-05 10:51:28] [config] data-weighting: ""
[2023-07-05 10:51:28] [config] data-weighting-type: sentence
[2023-07-05 10:51:28] [config] dec-cell: gru
[2023-07-05 10:51:28] [config] dec-cell-base-depth: 2
[2023-07-05 10:51:28] [config] dec-cell-high-depth: 1
[2023-07-05 10:51:28] [config] dec-depth: 1
[2023-07-05 10:51:28] [config] devices:
[2023-07-05 10:51:28] [config]   - 0
[2023-07-05 10:51:28] [config] dim-emb: 512
[2023-07-05 10:51:28] [config] dim-rnn: 1024
[2023-07-05 10:51:28] [config] dim-vocabs:
[2023-07-05 10:51:28] [config]   - 36507
[2023-07-05 10:51:28] [config]   - 54042
[2023-07-05 10:51:28] [config] disp-first: 0
[2023-07-05 10:51:28] [config] disp-freq: 1000u
[2023-07-05 10:51:28] [config] disp-label-counts: true
[2023-07-05 10:51:28] [config] dropout-rnn: 0
[2023-07-05 10:51:28] [config] dropout-src: 0
[2023-07-05 10:51:28] [config] dropout-trg: 0
[2023-07-05 10:51:28] [config] dump-config: ""
[2023-07-05 10:51:28] [config] dynamic-gradient-scaling:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] early-stopping: 10
[2023-07-05 10:51:28] [config] early-stopping-on: first
[2023-07-05 10:51:28] [config] embedding-fix-src: false
[2023-07-05 10:51:28] [config] embedding-fix-trg: false
[2023-07-05 10:51:28] [config] embedding-normalization: false
[2023-07-05 10:51:28] [config] embedding-vectors:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] enc-cell: gru
[2023-07-05 10:51:28] [config] enc-cell-depth: 1
[2023-07-05 10:51:28] [config] enc-depth: 1
[2023-07-05 10:51:28] [config] enc-type: bidirectional
[2023-07-05 10:51:28] [config] english-title-case-every: 0
[2023-07-05 10:51:28] [config] exponential-smoothing: 0
[2023-07-05 10:51:28] [config] factor-weight: 1
[2023-07-05 10:51:28] [config] factors-combine: sum
[2023-07-05 10:51:28] [config] factors-dim-emb: 0
[2023-07-05 10:51:28] [config] gradient-checkpointing: false
[2023-07-05 10:51:28] [config] gradient-norm-average-window: 100
[2023-07-05 10:51:28] [config] guided-alignment: none
[2023-07-05 10:51:28] [config] guided-alignment-cost: mse
[2023-07-05 10:51:28] [config] guided-alignment-weight: 0.1
[2023-07-05 10:51:28] [config] ignore-model-config: false
[2023-07-05 10:51:28] [config] input-types:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] interpolate-env-vars: false
[2023-07-05 10:51:28] [config] keep-best: false
[2023-07-05 10:51:28] [config] label-smoothing: 0
[2023-07-05 10:51:28] [config] layer-normalization: false
[2023-07-05 10:51:28] [config] learn-rate: 0.0001
[2023-07-05 10:51:28] [config] lemma-dependency: ""
[2023-07-05 10:51:28] [config] lemma-dim-emb: 0
[2023-07-05 10:51:28] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 10:51:28] [config] log-level: info
[2023-07-05 10:51:28] [config] log-time-zone: ""
[2023-07-05 10:51:28] [config] logical-epoch:
[2023-07-05 10:51:28] [config]   - 1e
[2023-07-05 10:51:28] [config]   - 0
[2023-07-05 10:51:28] [config] lr-decay: 0
[2023-07-05 10:51:28] [config] lr-decay-freq: 50000
[2023-07-05 10:51:28] [config] lr-decay-inv-sqrt:
[2023-07-05 10:51:28] [config]   - 0
[2023-07-05 10:51:28] [config] lr-decay-repeat-warmup: false
[2023-07-05 10:51:28] [config] lr-decay-reset-optimizer: false
[2023-07-05 10:51:28] [config] lr-decay-start:
[2023-07-05 10:51:28] [config]   - 10
[2023-07-05 10:51:28] [config]   - 1
[2023-07-05 10:51:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 10:51:28] [config] lr-report: false
[2023-07-05 10:51:28] [config] lr-warmup: 0
[2023-07-05 10:51:28] [config] lr-warmup-at-reload: false
[2023-07-05 10:51:28] [config] lr-warmup-cycle: false
[2023-07-05 10:51:28] [config] lr-warmup-start-rate: 0
[2023-07-05 10:51:28] [config] max-length: 50
[2023-07-05 10:51:28] [config] max-length-crop: false
[2023-07-05 10:51:28] [config] max-length-factor: 3
[2023-07-05 10:51:28] [config] maxi-batch: 100
[2023-07-05 10:51:28] [config] maxi-batch-sort: trg
[2023-07-05 10:51:28] [config] mini-batch: 64
[2023-07-05 10:51:28] [config] mini-batch-fit: false
[2023-07-05 10:51:28] [config] mini-batch-fit-step: 10
[2023-07-05 10:51:28] [config] mini-batch-round-up: true
[2023-07-05 10:51:28] [config] mini-batch-track-lr: false
[2023-07-05 10:51:28] [config] mini-batch-warmup: 0
[2023-07-05 10:51:28] [config] mini-batch-words: 0
[2023-07-05 10:51:28] [config] mini-batch-words-ref: 0
[2023-07-05 10:51:28] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 10:51:28] [config] multi-loss-type: sum
[2023-07-05 10:51:28] [config] n-best: false
[2023-07-05 10:51:28] [config] no-nccl: false
[2023-07-05 10:51:28] [config] no-reload: false
[2023-07-05 10:51:28] [config] no-restore-corpus: false
[2023-07-05 10:51:28] [config] normalize: 0
[2023-07-05 10:51:28] [config] normalize-gradient: false
[2023-07-05 10:51:28] [config] num-devices: 0
[2023-07-05 10:51:28] [config] optimizer: adam
[2023-07-05 10:51:28] [config] optimizer-delay: 1
[2023-07-05 10:51:28] [config] optimizer-params:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] output-omit-bias: false
[2023-07-05 10:51:28] [config] overwrite: true
[2023-07-05 10:51:28] [config] precision:
[2023-07-05 10:51:28] [config]   - float32
[2023-07-05 10:51:28] [config]   - float32
[2023-07-05 10:51:28] [config] pretrained-model: ""
[2023-07-05 10:51:28] [config] quantize-biases: false
[2023-07-05 10:51:28] [config] quantize-bits: 0
[2023-07-05 10:51:28] [config] quantize-log-based: false
[2023-07-05 10:51:28] [config] quantize-optimization-steps: 0
[2023-07-05 10:51:28] [config] quiet: false
[2023-07-05 10:51:28] [config] quiet-translation: true
[2023-07-05 10:51:28] [config] relative-paths: false
[2023-07-05 10:51:28] [config] right-left: false
[2023-07-05 10:51:28] [config] save-freq: 10000u
[2023-07-05 10:51:28] [config] seed: 1234
[2023-07-05 10:51:28] [config] sentencepiece-alphas:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] sentencepiece-max-lines: 2000000
[2023-07-05 10:51:28] [config] sentencepiece-options: ""
[2023-07-05 10:51:28] [config] sharding: global
[2023-07-05 10:51:28] [config] shuffle: data
[2023-07-05 10:51:28] [config] shuffle-in-ram: false
[2023-07-05 10:51:28] [config] sigterm: save-and-exit
[2023-07-05 10:51:28] [config] skip: false
[2023-07-05 10:51:28] [config] sqlite: ""
[2023-07-05 10:51:28] [config] sqlite-drop: false
[2023-07-05 10:51:28] [config] sync-freq: 200u
[2023-07-05 10:51:28] [config] sync-sgd: false
[2023-07-05 10:51:28] [config] tempdir: /tmp
[2023-07-05 10:51:28] [config] tied-embeddings: false
[2023-07-05 10:51:28] [config] tied-embeddings-all: false
[2023-07-05 10:51:28] [config] tied-embeddings-src: false
[2023-07-05 10:51:28] [config] train-embedder-rank:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] train-sets:
[2023-07-05 10:51:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 10:51:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 10:51:28] [config] transformer-aan-activation: swish
[2023-07-05 10:51:28] [config] transformer-aan-depth: 2
[2023-07-05 10:51:28] [config] transformer-aan-nogate: false
[2023-07-05 10:51:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 10:51:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 10:51:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 10:51:28] [config] transformer-depth-scaling: false
[2023-07-05 10:51:28] [config] transformer-dim-aan: 2048
[2023-07-05 10:51:28] [config] transformer-dim-ffn: 2048
[2023-07-05 10:51:28] [config] transformer-dropout: 0
[2023-07-05 10:51:28] [config] transformer-dropout-attention: 0
[2023-07-05 10:51:28] [config] transformer-dropout-ffn: 0
[2023-07-05 10:51:28] [config] transformer-ffn-activation: swish
[2023-07-05 10:51:28] [config] transformer-ffn-depth: 2
[2023-07-05 10:51:28] [config] transformer-guided-alignment-layer: last
[2023-07-05 10:51:28] [config] transformer-heads: 8
[2023-07-05 10:51:28] [config] transformer-no-projection: false
[2023-07-05 10:51:28] [config] transformer-pool: false
[2023-07-05 10:51:28] [config] transformer-postprocess: dan
[2023-07-05 10:51:28] [config] transformer-postprocess-emb: d
[2023-07-05 10:51:28] [config] transformer-postprocess-top: ""
[2023-07-05 10:51:28] [config] transformer-preprocess: ""
[2023-07-05 10:51:28] [config] transformer-tied-layers:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] transformer-train-position-embeddings: false
[2023-07-05 10:51:28] [config] tsv: false
[2023-07-05 10:51:28] [config] tsv-fields: 0
[2023-07-05 10:51:28] [config] type: amun
[2023-07-05 10:51:28] [config] ulr: false
[2023-07-05 10:51:28] [config] ulr-dim-emb: 0
[2023-07-05 10:51:28] [config] ulr-dropout: 0
[2023-07-05 10:51:28] [config] ulr-keys-vectors: ""
[2023-07-05 10:51:28] [config] ulr-query-vectors: ""
[2023-07-05 10:51:28] [config] ulr-softmax-temperature: 1
[2023-07-05 10:51:28] [config] ulr-trainable-transformation: false
[2023-07-05 10:51:28] [config] unlikelihood-loss: false
[2023-07-05 10:51:28] [config] valid-freq: 50000000
[2023-07-05 10:51:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 10:51:28] [config] valid-max-length: 1000
[2023-07-05 10:51:28] [config] valid-metrics:
[2023-07-05 10:51:28] [config]   - cross-entropy
[2023-07-05 10:51:28] [config]   - translation
[2023-07-05 10:51:28] [config] valid-mini-batch: 32
[2023-07-05 10:51:28] [config] valid-reset-stalled: false
[2023-07-05 10:51:28] [config] valid-script-args:
[2023-07-05 10:51:28] [config]   []
[2023-07-05 10:51:28] [config] valid-script-path: ""
[2023-07-05 10:51:28] [config] valid-sets:
[2023-07-05 10:51:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 10:51:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 10:51:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 10:51:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:51:28] [config] vocabs:
[2023-07-05 10:51:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 10:51:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 10:51:28] [config] word-penalty: 0
[2023-07-05 10:51:28] [config] word-scores: false
[2023-07-05 10:51:28] [config] workspace: 2048
[2023-07-05 10:51:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 10:51:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 10:51:28] [training] Using single-device training
[2023-07-05 10:51:29] Synced seed 1234
[2023-07-05 10:51:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 10:51:29] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 10:51:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 10:51:29] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 10:51:29] [valid] No post-processing script given for validating translator
[2023-07-05 10:51:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 10:51:30] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 10:51:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 10:51:30] [comm] Using global sharding
[2023-07-05 10:51:30] [comm] NCCLCommunicators constructed successfully
[2023-07-05 10:51:30] [training] Using 1 GPUs
[2023-07-05 10:51:30] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 10:51:33] Loading Adam parameters
[2023-07-05 10:51:33] [memory] Reserving 823 MB, device gpu0
[2023-07-05 10:51:33] [memory] Reserving 411 MB, device gpu0
[2023-07-05 10:51:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 10:51:33] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-07-05 10:51:33] [data] Shuffling data
[2023-07-05 10:51:33] [data] Done reading 20,192 sentences
[2023-07-05 10:51:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:51:33] Training started
[2023-07-05 10:51:33] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 10:51:33] [logits] Applying loss function for 1 factor(s)
[2023-07-05 10:51:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 10:51:34] [memory] Reserving 411 MB, device gpu0
[2023-07-05 10:51:34] Parameter type float32, optimization type float32, casting types false
[2023-07-05 10:51:44] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 4.03220463 * 933,651 @ 832 after 5,592,951 : Time 15.06s : 61983.00 words/s : gNorm 1.5996
[2023-07-05 10:52:34] Seen 18,843 samples
[2023-07-05 10:52:34] Starting data epoch 22 in logical epoch 22
[2023-07-05 10:52:34] [data] Shuffling data
[2023-07-05 10:52:34] [data] Done reading 20,192 sentences
[2023-07-05 10:52:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:53:48] Seen 18,843 samples
[2023-07-05 10:53:48] Starting data epoch 23 in logical epoch 23
[2023-07-05 10:53:48] [data] Shuffling data
[2023-07-05 10:53:48] [data] Done reading 20,192 sentences
[2023-07-05 10:53:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:55:05] Seen 18,843 samples
[2023-07-05 10:55:05] Starting data epoch 24 in logical epoch 24
[2023-07-05 10:55:05] [data] Shuffling data
[2023-07-05 10:55:05] [data] Done reading 20,192 sentences
[2023-07-05 10:55:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:55:50] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 3.57212639 * 930,552 @ 512 after 6,523,503 : Time 246.01s : 3782.50 words/s : gNorm 1.6672
[2023-07-05 10:56:31] Seen 18,843 samples
[2023-07-05 10:56:31] Starting data epoch 25 in logical epoch 25
[2023-07-05 10:56:31] [data] Shuffling data
[2023-07-05 10:56:31] [data] Done reading 20,192 sentences
[2023-07-05 10:56:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 10:58:24] Seen 18,843 samples
[2023-07-05 10:58:24] Starting data epoch 26 in logical epoch 26
[2023-07-05 10:58:24] [data] Shuffling data
[2023-07-05 10:58:25] [data] Done reading 20,192 sentences
[2023-07-05 10:58:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:00:16] Seen 18,843 samples
[2023-07-05 11:00:16] Starting data epoch 27 in logical epoch 27
[2023-07-05 11:00:16] [data] Shuffling data
[2023-07-05 11:00:16] [data] Done reading 20,192 sentences
[2023-07-05 11:00:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:02:06] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 3.15666890 * 930,047 @ 730 after 7,453,550 : Time 376.46s : 2470.48 words/s : gNorm 1.6580
[2023-07-05 11:02:11] Seen 18,843 samples
[2023-07-05 11:02:11] Starting data epoch 28 in logical epoch 28
[2023-07-05 11:02:11] [data] Shuffling data
[2023-07-05 11:02:11] [data] Done reading 20,192 sentences
[2023-07-05 11:02:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:04:04] Seen 18,843 samples
[2023-07-05 11:04:04] Starting data epoch 29 in logical epoch 29
[2023-07-05 11:04:04] [data] Shuffling data
[2023-07-05 11:04:04] [data] Done reading 20,192 sentences
[2023-07-05 11:04:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:05:54] Seen 18,843 samples
[2023-07-05 11:05:54] Starting data epoch 30 in logical epoch 30
[2023-07-05 11:05:54] [data] Shuffling data
[2023-07-05 11:05:54] [data] Done reading 20,192 sentences
[2023-07-05 11:05:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:07:50] Seen 18,843 samples
[2023-07-05 11:07:50] Starting data epoch 31 in logical epoch 31
[2023-07-05 11:07:50] Training finished
[2023-07-05 11:08:04] [valid] Ep. 31 : Up. 8898 : cross-entropy : 94.543 : stalled 2 times (last best: 87.4293)
[2023-07-05 11:11:37] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-07-05 11:11:37] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:11:43] Saving Adam parameters
[2023-07-05 11:11:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 11:12:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:12:01] [marian] Running on node22.datos.cluster.uy as process 31828 with command line:
[2023-07-05 11:12:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 11:12:01] [config] after: 0e
[2023-07-05 11:12:01] [config] after-batches: 0
[2023-07-05 11:12:01] [config] after-epochs: 40
[2023-07-05 11:12:01] [config] all-caps-every: 0
[2023-07-05 11:12:01] [config] allow-unk: false
[2023-07-05 11:12:01] [config] authors: false
[2023-07-05 11:12:01] [config] beam-size: 12
[2023-07-05 11:12:01] [config] bert-class-symbol: "[CLS]"
[2023-07-05 11:12:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 11:12:01] [config] bert-masking-fraction: 0.15
[2023-07-05 11:12:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 11:12:01] [config] bert-train-type-embeddings: true
[2023-07-05 11:12:01] [config] bert-type-vocab-size: 2
[2023-07-05 11:12:01] [config] build-info: ""
[2023-07-05 11:12:01] [config] check-gradient-nan: false
[2023-07-05 11:12:01] [config] check-nan: false
[2023-07-05 11:12:01] [config] cite: false
[2023-07-05 11:12:01] [config] clip-norm: 1
[2023-07-05 11:12:01] [config] cost-scaling:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] cost-type: ce-sum
[2023-07-05 11:12:01] [config] cpu-threads: 0
[2023-07-05 11:12:01] [config] data-threads: 8
[2023-07-05 11:12:01] [config] data-weighting: ""
[2023-07-05 11:12:01] [config] data-weighting-type: sentence
[2023-07-05 11:12:01] [config] dec-cell: gru
[2023-07-05 11:12:01] [config] dec-cell-base-depth: 2
[2023-07-05 11:12:01] [config] dec-cell-high-depth: 1
[2023-07-05 11:12:01] [config] dec-depth: 1
[2023-07-05 11:12:01] [config] devices:
[2023-07-05 11:12:01] [config]   - 0
[2023-07-05 11:12:01] [config] dim-emb: 512
[2023-07-05 11:12:01] [config] dim-rnn: 1024
[2023-07-05 11:12:01] [config] dim-vocabs:
[2023-07-05 11:12:01] [config]   - 36507
[2023-07-05 11:12:01] [config]   - 54042
[2023-07-05 11:12:01] [config] disp-first: 0
[2023-07-05 11:12:01] [config] disp-freq: 1000u
[2023-07-05 11:12:01] [config] disp-label-counts: true
[2023-07-05 11:12:01] [config] dropout-rnn: 0
[2023-07-05 11:12:01] [config] dropout-src: 0
[2023-07-05 11:12:01] [config] dropout-trg: 0
[2023-07-05 11:12:01] [config] dump-config: ""
[2023-07-05 11:12:01] [config] dynamic-gradient-scaling:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] early-stopping: 10
[2023-07-05 11:12:01] [config] early-stopping-on: first
[2023-07-05 11:12:01] [config] embedding-fix-src: false
[2023-07-05 11:12:01] [config] embedding-fix-trg: false
[2023-07-05 11:12:01] [config] embedding-normalization: false
[2023-07-05 11:12:01] [config] embedding-vectors:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] enc-cell: gru
[2023-07-05 11:12:01] [config] enc-cell-depth: 1
[2023-07-05 11:12:01] [config] enc-depth: 1
[2023-07-05 11:12:01] [config] enc-type: bidirectional
[2023-07-05 11:12:01] [config] english-title-case-every: 0
[2023-07-05 11:12:01] [config] exponential-smoothing: 0
[2023-07-05 11:12:01] [config] factor-weight: 1
[2023-07-05 11:12:01] [config] factors-combine: sum
[2023-07-05 11:12:01] [config] factors-dim-emb: 0
[2023-07-05 11:12:01] [config] gradient-checkpointing: false
[2023-07-05 11:12:01] [config] gradient-norm-average-window: 100
[2023-07-05 11:12:01] [config] guided-alignment: none
[2023-07-05 11:12:01] [config] guided-alignment-cost: mse
[2023-07-05 11:12:01] [config] guided-alignment-weight: 0.1
[2023-07-05 11:12:01] [config] ignore-model-config: false
[2023-07-05 11:12:01] [config] input-types:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] interpolate-env-vars: false
[2023-07-05 11:12:01] [config] keep-best: false
[2023-07-05 11:12:01] [config] label-smoothing: 0
[2023-07-05 11:12:01] [config] layer-normalization: false
[2023-07-05 11:12:01] [config] learn-rate: 0.0001
[2023-07-05 11:12:01] [config] lemma-dependency: ""
[2023-07-05 11:12:01] [config] lemma-dim-emb: 0
[2023-07-05 11:12:01] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 11:12:01] [config] log-level: info
[2023-07-05 11:12:01] [config] log-time-zone: ""
[2023-07-05 11:12:01] [config] logical-epoch:
[2023-07-05 11:12:01] [config]   - 1e
[2023-07-05 11:12:01] [config]   - 0
[2023-07-05 11:12:01] [config] lr-decay: 0
[2023-07-05 11:12:01] [config] lr-decay-freq: 50000
[2023-07-05 11:12:01] [config] lr-decay-inv-sqrt:
[2023-07-05 11:12:01] [config]   - 0
[2023-07-05 11:12:01] [config] lr-decay-repeat-warmup: false
[2023-07-05 11:12:01] [config] lr-decay-reset-optimizer: false
[2023-07-05 11:12:01] [config] lr-decay-start:
[2023-07-05 11:12:01] [config]   - 10
[2023-07-05 11:12:01] [config]   - 1
[2023-07-05 11:12:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 11:12:01] [config] lr-report: false
[2023-07-05 11:12:01] [config] lr-warmup: 0
[2023-07-05 11:12:01] [config] lr-warmup-at-reload: false
[2023-07-05 11:12:01] [config] lr-warmup-cycle: false
[2023-07-05 11:12:01] [config] lr-warmup-start-rate: 0
[2023-07-05 11:12:01] [config] max-length: 50
[2023-07-05 11:12:01] [config] max-length-crop: false
[2023-07-05 11:12:01] [config] max-length-factor: 3
[2023-07-05 11:12:01] [config] maxi-batch: 100
[2023-07-05 11:12:01] [config] maxi-batch-sort: trg
[2023-07-05 11:12:01] [config] mini-batch: 64
[2023-07-05 11:12:01] [config] mini-batch-fit: false
[2023-07-05 11:12:01] [config] mini-batch-fit-step: 10
[2023-07-05 11:12:01] [config] mini-batch-round-up: true
[2023-07-05 11:12:01] [config] mini-batch-track-lr: false
[2023-07-05 11:12:01] [config] mini-batch-warmup: 0
[2023-07-05 11:12:01] [config] mini-batch-words: 0
[2023-07-05 11:12:01] [config] mini-batch-words-ref: 0
[2023-07-05 11:12:01] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:12:01] [config] multi-loss-type: sum
[2023-07-05 11:12:01] [config] n-best: false
[2023-07-05 11:12:01] [config] no-nccl: false
[2023-07-05 11:12:01] [config] no-reload: false
[2023-07-05 11:12:01] [config] no-restore-corpus: false
[2023-07-05 11:12:01] [config] normalize: 0
[2023-07-05 11:12:01] [config] normalize-gradient: false
[2023-07-05 11:12:01] [config] num-devices: 0
[2023-07-05 11:12:01] [config] optimizer: adam
[2023-07-05 11:12:01] [config] optimizer-delay: 1
[2023-07-05 11:12:01] [config] optimizer-params:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] output-omit-bias: false
[2023-07-05 11:12:01] [config] overwrite: true
[2023-07-05 11:12:01] [config] precision:
[2023-07-05 11:12:01] [config]   - float32
[2023-07-05 11:12:01] [config]   - float32
[2023-07-05 11:12:01] [config] pretrained-model: ""
[2023-07-05 11:12:01] [config] quantize-biases: false
[2023-07-05 11:12:01] [config] quantize-bits: 0
[2023-07-05 11:12:01] [config] quantize-log-based: false
[2023-07-05 11:12:01] [config] quantize-optimization-steps: 0
[2023-07-05 11:12:01] [config] quiet: false
[2023-07-05 11:12:01] [config] quiet-translation: true
[2023-07-05 11:12:01] [config] relative-paths: false
[2023-07-05 11:12:01] [config] right-left: false
[2023-07-05 11:12:01] [config] save-freq: 10000u
[2023-07-05 11:12:01] [config] seed: 1234
[2023-07-05 11:12:01] [config] sentencepiece-alphas:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] sentencepiece-max-lines: 2000000
[2023-07-05 11:12:01] [config] sentencepiece-options: ""
[2023-07-05 11:12:01] [config] sharding: global
[2023-07-05 11:12:01] [config] shuffle: data
[2023-07-05 11:12:01] [config] shuffle-in-ram: false
[2023-07-05 11:12:01] [config] sigterm: save-and-exit
[2023-07-05 11:12:01] [config] skip: false
[2023-07-05 11:12:01] [config] sqlite: ""
[2023-07-05 11:12:01] [config] sqlite-drop: false
[2023-07-05 11:12:01] [config] sync-freq: 200u
[2023-07-05 11:12:01] [config] sync-sgd: false
[2023-07-05 11:12:01] [config] tempdir: /tmp
[2023-07-05 11:12:01] [config] tied-embeddings: false
[2023-07-05 11:12:01] [config] tied-embeddings-all: false
[2023-07-05 11:12:01] [config] tied-embeddings-src: false
[2023-07-05 11:12:01] [config] train-embedder-rank:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] train-sets:
[2023-07-05 11:12:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 11:12:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 11:12:01] [config] transformer-aan-activation: swish
[2023-07-05 11:12:01] [config] transformer-aan-depth: 2
[2023-07-05 11:12:01] [config] transformer-aan-nogate: false
[2023-07-05 11:12:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 11:12:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 11:12:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 11:12:01] [config] transformer-depth-scaling: false
[2023-07-05 11:12:01] [config] transformer-dim-aan: 2048
[2023-07-05 11:12:01] [config] transformer-dim-ffn: 2048
[2023-07-05 11:12:01] [config] transformer-dropout: 0
[2023-07-05 11:12:01] [config] transformer-dropout-attention: 0
[2023-07-05 11:12:01] [config] transformer-dropout-ffn: 0
[2023-07-05 11:12:01] [config] transformer-ffn-activation: swish
[2023-07-05 11:12:01] [config] transformer-ffn-depth: 2
[2023-07-05 11:12:01] [config] transformer-guided-alignment-layer: last
[2023-07-05 11:12:01] [config] transformer-heads: 8
[2023-07-05 11:12:01] [config] transformer-no-projection: false
[2023-07-05 11:12:01] [config] transformer-pool: false
[2023-07-05 11:12:01] [config] transformer-postprocess: dan
[2023-07-05 11:12:01] [config] transformer-postprocess-emb: d
[2023-07-05 11:12:01] [config] transformer-postprocess-top: ""
[2023-07-05 11:12:01] [config] transformer-preprocess: ""
[2023-07-05 11:12:01] [config] transformer-tied-layers:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] transformer-train-position-embeddings: false
[2023-07-05 11:12:01] [config] tsv: false
[2023-07-05 11:12:01] [config] tsv-fields: 0
[2023-07-05 11:12:01] [config] type: amun
[2023-07-05 11:12:01] [config] ulr: false
[2023-07-05 11:12:01] [config] ulr-dim-emb: 0
[2023-07-05 11:12:01] [config] ulr-dropout: 0
[2023-07-05 11:12:01] [config] ulr-keys-vectors: ""
[2023-07-05 11:12:01] [config] ulr-query-vectors: ""
[2023-07-05 11:12:01] [config] ulr-softmax-temperature: 1
[2023-07-05 11:12:01] [config] ulr-trainable-transformation: false
[2023-07-05 11:12:01] [config] unlikelihood-loss: false
[2023-07-05 11:12:01] [config] valid-freq: 50000000
[2023-07-05 11:12:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 11:12:01] [config] valid-max-length: 1000
[2023-07-05 11:12:01] [config] valid-metrics:
[2023-07-05 11:12:01] [config]   - cross-entropy
[2023-07-05 11:12:01] [config]   - translation
[2023-07-05 11:12:01] [config] valid-mini-batch: 32
[2023-07-05 11:12:01] [config] valid-reset-stalled: false
[2023-07-05 11:12:01] [config] valid-script-args:
[2023-07-05 11:12:01] [config]   []
[2023-07-05 11:12:01] [config] valid-script-path: ""
[2023-07-05 11:12:01] [config] valid-sets:
[2023-07-05 11:12:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 11:12:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 11:12:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 11:12:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:12:01] [config] vocabs:
[2023-07-05 11:12:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 11:12:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 11:12:01] [config] word-penalty: 0
[2023-07-05 11:12:01] [config] word-scores: false
[2023-07-05 11:12:01] [config] workspace: 2048
[2023-07-05 11:12:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:12:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 11:12:01] [training] Using single-device training
[2023-07-05 11:12:04] Synced seed 1234
[2023-07-05 11:12:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 11:12:04] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 11:12:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 11:12:04] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 11:12:05] [valid] No post-processing script given for validating translator
[2023-07-05 11:12:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 11:12:05] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 11:12:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 11:12:05] [comm] Using global sharding
[2023-07-05 11:12:06] [comm] NCCLCommunicators constructed successfully
[2023-07-05 11:12:06] [training] Using 1 GPUs
[2023-07-05 11:12:06] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:12:08] Loading Adam parameters
[2023-07-05 11:12:09] [memory] Reserving 823 MB, device gpu0
[2023-07-05 11:12:09] [memory] Reserving 411 MB, device gpu0
[2023-07-05 11:12:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 11:12:09] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-07-05 11:12:09] [data] Shuffling data
[2023-07-05 11:12:09] [data] Done reading 20,192 sentences
[2023-07-05 11:12:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:12:09] Training started
[2023-07-05 11:12:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 11:12:09] [logits] Applying loss function for 1 factor(s)
[2023-07-05 11:12:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 11:12:09] [memory] Reserving 411 MB, device gpu0
[2023-07-05 11:12:10] Parameter type float32, optimization type float32, casting types false
[2023-07-05 11:12:27] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 2.75268912 * 931,518 @ 256 after 8,385,068 : Time 22.61s : 41207.35 words/s : gNorm 1.6490
[2023-07-05 11:13:37] Seen 18,843 samples
[2023-07-05 11:13:37] Starting data epoch 32 in logical epoch 32
[2023-07-05 11:13:37] [data] Shuffling data
[2023-07-05 11:13:37] [data] Done reading 20,192 sentences
[2023-07-05 11:13:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:15:28] Seen 18,843 samples
[2023-07-05 11:15:28] Starting data epoch 33 in logical epoch 33
[2023-07-05 11:15:28] [data] Shuffling data
[2023-07-05 11:15:28] [data] Done reading 20,192 sentences
[2023-07-05 11:15:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:17:23] Seen 18,843 samples
[2023-07-05 11:17:23] Starting data epoch 34 in logical epoch 34
[2023-07-05 11:17:23] [data] Shuffling data
[2023-07-05 11:17:23] [data] Done reading 20,192 sentences
[2023-07-05 11:17:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:18:43] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 2.40487003 * 936,399 @ 637 after 9,321,467 : Time 376.38s : 2487.90 words/s : gNorm 1.6593
[2023-07-05 11:18:43] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:18:48] Saving Adam parameters
[2023-07-05 11:18:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 11:19:20] Seen 18,843 samples
[2023-07-05 11:19:20] Starting data epoch 35 in logical epoch 35
[2023-07-05 11:19:20] [data] Shuffling data
[2023-07-05 11:19:20] [data] Done reading 20,192 sentences
[2023-07-05 11:19:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:21:12] Seen 18,843 samples
[2023-07-05 11:21:12] Starting data epoch 36 in logical epoch 36
[2023-07-05 11:21:12] [data] Shuffling data
[2023-07-05 11:21:12] [data] Done reading 20,192 sentences
[2023-07-05 11:21:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:23:06] Seen 18,843 samples
[2023-07-05 11:23:06] Starting data epoch 37 in logical epoch 37
[2023-07-05 11:23:06] [data] Shuffling data
[2023-07-05 11:23:06] [data] Done reading 20,192 sentences
[2023-07-05 11:23:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:24:59] Seen 18,843 samples
[2023-07-05 11:24:59] Starting data epoch 38 in logical epoch 38
[2023-07-05 11:24:59] [data] Shuffling data
[2023-07-05 11:24:59] [data] Done reading 20,192 sentences
[2023-07-05 11:24:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:25:11] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 2.07882500 * 933,298 @ 960 after 10,254,765 : Time 387.04s : 2411.37 words/s : gNorm 1.5763
[2023-07-05 11:26:51] Seen 18,843 samples
[2023-07-05 11:26:51] Starting data epoch 39 in logical epoch 39
[2023-07-05 11:26:51] [data] Shuffling data
[2023-07-05 11:26:51] [data] Done reading 20,192 sentences
[2023-07-05 11:26:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:28:44] Seen 18,843 samples
[2023-07-05 11:28:44] Starting data epoch 40 in logical epoch 40
[2023-07-05 11:28:44] [data] Shuffling data
[2023-07-05 11:28:44] [data] Done reading 20,192 sentences
[2023-07-05 11:28:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:30:34] Seen 18,843 samples
[2023-07-05 11:30:34] Starting data epoch 41 in logical epoch 41
[2023-07-05 11:30:34] Training finished
[2023-07-05 11:30:48] [valid] Ep. 41 : Up. 11864 : cross-entropy : 100.281 : stalled 3 times (last best: 87.4293)
[2023-07-05 11:34:11] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-07-05 11:34:11] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:34:15] Saving Adam parameters
[2023-07-05 11:34:17] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 11:34:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:34:32] [marian] Running on node22.datos.cluster.uy as process 4620 with command line:
[2023-07-05 11:34:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 11:34:32] [config] after: 0e
[2023-07-05 11:34:32] [config] after-batches: 0
[2023-07-05 11:34:32] [config] after-epochs: 50
[2023-07-05 11:34:32] [config] all-caps-every: 0
[2023-07-05 11:34:32] [config] allow-unk: false
[2023-07-05 11:34:32] [config] authors: false
[2023-07-05 11:34:32] [config] beam-size: 12
[2023-07-05 11:34:32] [config] bert-class-symbol: "[CLS]"
[2023-07-05 11:34:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 11:34:32] [config] bert-masking-fraction: 0.15
[2023-07-05 11:34:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 11:34:32] [config] bert-train-type-embeddings: true
[2023-07-05 11:34:32] [config] bert-type-vocab-size: 2
[2023-07-05 11:34:32] [config] build-info: ""
[2023-07-05 11:34:32] [config] check-gradient-nan: false
[2023-07-05 11:34:32] [config] check-nan: false
[2023-07-05 11:34:32] [config] cite: false
[2023-07-05 11:34:32] [config] clip-norm: 1
[2023-07-05 11:34:32] [config] cost-scaling:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] cost-type: ce-sum
[2023-07-05 11:34:32] [config] cpu-threads: 0
[2023-07-05 11:34:32] [config] data-threads: 8
[2023-07-05 11:34:32] [config] data-weighting: ""
[2023-07-05 11:34:32] [config] data-weighting-type: sentence
[2023-07-05 11:34:32] [config] dec-cell: gru
[2023-07-05 11:34:32] [config] dec-cell-base-depth: 2
[2023-07-05 11:34:32] [config] dec-cell-high-depth: 1
[2023-07-05 11:34:32] [config] dec-depth: 1
[2023-07-05 11:34:32] [config] devices:
[2023-07-05 11:34:32] [config]   - 0
[2023-07-05 11:34:32] [config] dim-emb: 512
[2023-07-05 11:34:32] [config] dim-rnn: 1024
[2023-07-05 11:34:32] [config] dim-vocabs:
[2023-07-05 11:34:32] [config]   - 36507
[2023-07-05 11:34:32] [config]   - 54042
[2023-07-05 11:34:32] [config] disp-first: 0
[2023-07-05 11:34:32] [config] disp-freq: 1000u
[2023-07-05 11:34:32] [config] disp-label-counts: true
[2023-07-05 11:34:32] [config] dropout-rnn: 0
[2023-07-05 11:34:32] [config] dropout-src: 0
[2023-07-05 11:34:32] [config] dropout-trg: 0
[2023-07-05 11:34:32] [config] dump-config: ""
[2023-07-05 11:34:32] [config] dynamic-gradient-scaling:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] early-stopping: 10
[2023-07-05 11:34:32] [config] early-stopping-on: first
[2023-07-05 11:34:32] [config] embedding-fix-src: false
[2023-07-05 11:34:32] [config] embedding-fix-trg: false
[2023-07-05 11:34:32] [config] embedding-normalization: false
[2023-07-05 11:34:32] [config] embedding-vectors:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] enc-cell: gru
[2023-07-05 11:34:32] [config] enc-cell-depth: 1
[2023-07-05 11:34:32] [config] enc-depth: 1
[2023-07-05 11:34:32] [config] enc-type: bidirectional
[2023-07-05 11:34:32] [config] english-title-case-every: 0
[2023-07-05 11:34:32] [config] exponential-smoothing: 0
[2023-07-05 11:34:32] [config] factor-weight: 1
[2023-07-05 11:34:32] [config] factors-combine: sum
[2023-07-05 11:34:32] [config] factors-dim-emb: 0
[2023-07-05 11:34:32] [config] gradient-checkpointing: false
[2023-07-05 11:34:32] [config] gradient-norm-average-window: 100
[2023-07-05 11:34:32] [config] guided-alignment: none
[2023-07-05 11:34:32] [config] guided-alignment-cost: mse
[2023-07-05 11:34:32] [config] guided-alignment-weight: 0.1
[2023-07-05 11:34:32] [config] ignore-model-config: false
[2023-07-05 11:34:32] [config] input-types:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] interpolate-env-vars: false
[2023-07-05 11:34:32] [config] keep-best: false
[2023-07-05 11:34:32] [config] label-smoothing: 0
[2023-07-05 11:34:32] [config] layer-normalization: false
[2023-07-05 11:34:32] [config] learn-rate: 0.0001
[2023-07-05 11:34:32] [config] lemma-dependency: ""
[2023-07-05 11:34:32] [config] lemma-dim-emb: 0
[2023-07-05 11:34:32] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 11:34:32] [config] log-level: info
[2023-07-05 11:34:32] [config] log-time-zone: ""
[2023-07-05 11:34:32] [config] logical-epoch:
[2023-07-05 11:34:32] [config]   - 1e
[2023-07-05 11:34:32] [config]   - 0
[2023-07-05 11:34:32] [config] lr-decay: 0
[2023-07-05 11:34:32] [config] lr-decay-freq: 50000
[2023-07-05 11:34:32] [config] lr-decay-inv-sqrt:
[2023-07-05 11:34:32] [config]   - 0
[2023-07-05 11:34:32] [config] lr-decay-repeat-warmup: false
[2023-07-05 11:34:32] [config] lr-decay-reset-optimizer: false
[2023-07-05 11:34:32] [config] lr-decay-start:
[2023-07-05 11:34:32] [config]   - 10
[2023-07-05 11:34:32] [config]   - 1
[2023-07-05 11:34:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 11:34:32] [config] lr-report: false
[2023-07-05 11:34:32] [config] lr-warmup: 0
[2023-07-05 11:34:32] [config] lr-warmup-at-reload: false
[2023-07-05 11:34:32] [config] lr-warmup-cycle: false
[2023-07-05 11:34:32] [config] lr-warmup-start-rate: 0
[2023-07-05 11:34:32] [config] max-length: 50
[2023-07-05 11:34:32] [config] max-length-crop: false
[2023-07-05 11:34:32] [config] max-length-factor: 3
[2023-07-05 11:34:32] [config] maxi-batch: 100
[2023-07-05 11:34:32] [config] maxi-batch-sort: trg
[2023-07-05 11:34:32] [config] mini-batch: 64
[2023-07-05 11:34:32] [config] mini-batch-fit: false
[2023-07-05 11:34:32] [config] mini-batch-fit-step: 10
[2023-07-05 11:34:32] [config] mini-batch-round-up: true
[2023-07-05 11:34:32] [config] mini-batch-track-lr: false
[2023-07-05 11:34:32] [config] mini-batch-warmup: 0
[2023-07-05 11:34:32] [config] mini-batch-words: 0
[2023-07-05 11:34:32] [config] mini-batch-words-ref: 0
[2023-07-05 11:34:32] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:34:32] [config] multi-loss-type: sum
[2023-07-05 11:34:32] [config] n-best: false
[2023-07-05 11:34:32] [config] no-nccl: false
[2023-07-05 11:34:32] [config] no-reload: false
[2023-07-05 11:34:32] [config] no-restore-corpus: false
[2023-07-05 11:34:32] [config] normalize: 0
[2023-07-05 11:34:32] [config] normalize-gradient: false
[2023-07-05 11:34:32] [config] num-devices: 0
[2023-07-05 11:34:32] [config] optimizer: adam
[2023-07-05 11:34:32] [config] optimizer-delay: 1
[2023-07-05 11:34:32] [config] optimizer-params:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] output-omit-bias: false
[2023-07-05 11:34:32] [config] overwrite: true
[2023-07-05 11:34:32] [config] precision:
[2023-07-05 11:34:32] [config]   - float32
[2023-07-05 11:34:32] [config]   - float32
[2023-07-05 11:34:32] [config] pretrained-model: ""
[2023-07-05 11:34:32] [config] quantize-biases: false
[2023-07-05 11:34:32] [config] quantize-bits: 0
[2023-07-05 11:34:32] [config] quantize-log-based: false
[2023-07-05 11:34:32] [config] quantize-optimization-steps: 0
[2023-07-05 11:34:32] [config] quiet: false
[2023-07-05 11:34:32] [config] quiet-translation: true
[2023-07-05 11:34:32] [config] relative-paths: false
[2023-07-05 11:34:32] [config] right-left: false
[2023-07-05 11:34:32] [config] save-freq: 10000u
[2023-07-05 11:34:32] [config] seed: 1234
[2023-07-05 11:34:32] [config] sentencepiece-alphas:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] sentencepiece-max-lines: 2000000
[2023-07-05 11:34:32] [config] sentencepiece-options: ""
[2023-07-05 11:34:32] [config] sharding: global
[2023-07-05 11:34:32] [config] shuffle: data
[2023-07-05 11:34:32] [config] shuffle-in-ram: false
[2023-07-05 11:34:32] [config] sigterm: save-and-exit
[2023-07-05 11:34:32] [config] skip: false
[2023-07-05 11:34:32] [config] sqlite: ""
[2023-07-05 11:34:32] [config] sqlite-drop: false
[2023-07-05 11:34:32] [config] sync-freq: 200u
[2023-07-05 11:34:32] [config] sync-sgd: false
[2023-07-05 11:34:32] [config] tempdir: /tmp
[2023-07-05 11:34:32] [config] tied-embeddings: false
[2023-07-05 11:34:32] [config] tied-embeddings-all: false
[2023-07-05 11:34:32] [config] tied-embeddings-src: false
[2023-07-05 11:34:32] [config] train-embedder-rank:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] train-sets:
[2023-07-05 11:34:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 11:34:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 11:34:32] [config] transformer-aan-activation: swish
[2023-07-05 11:34:32] [config] transformer-aan-depth: 2
[2023-07-05 11:34:32] [config] transformer-aan-nogate: false
[2023-07-05 11:34:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 11:34:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 11:34:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 11:34:32] [config] transformer-depth-scaling: false
[2023-07-05 11:34:32] [config] transformer-dim-aan: 2048
[2023-07-05 11:34:32] [config] transformer-dim-ffn: 2048
[2023-07-05 11:34:32] [config] transformer-dropout: 0
[2023-07-05 11:34:32] [config] transformer-dropout-attention: 0
[2023-07-05 11:34:32] [config] transformer-dropout-ffn: 0
[2023-07-05 11:34:32] [config] transformer-ffn-activation: swish
[2023-07-05 11:34:32] [config] transformer-ffn-depth: 2
[2023-07-05 11:34:32] [config] transformer-guided-alignment-layer: last
[2023-07-05 11:34:32] [config] transformer-heads: 8
[2023-07-05 11:34:32] [config] transformer-no-projection: false
[2023-07-05 11:34:32] [config] transformer-pool: false
[2023-07-05 11:34:32] [config] transformer-postprocess: dan
[2023-07-05 11:34:32] [config] transformer-postprocess-emb: d
[2023-07-05 11:34:32] [config] transformer-postprocess-top: ""
[2023-07-05 11:34:32] [config] transformer-preprocess: ""
[2023-07-05 11:34:32] [config] transformer-tied-layers:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] transformer-train-position-embeddings: false
[2023-07-05 11:34:32] [config] tsv: false
[2023-07-05 11:34:32] [config] tsv-fields: 0
[2023-07-05 11:34:32] [config] type: amun
[2023-07-05 11:34:32] [config] ulr: false
[2023-07-05 11:34:32] [config] ulr-dim-emb: 0
[2023-07-05 11:34:32] [config] ulr-dropout: 0
[2023-07-05 11:34:32] [config] ulr-keys-vectors: ""
[2023-07-05 11:34:32] [config] ulr-query-vectors: ""
[2023-07-05 11:34:32] [config] ulr-softmax-temperature: 1
[2023-07-05 11:34:32] [config] ulr-trainable-transformation: false
[2023-07-05 11:34:32] [config] unlikelihood-loss: false
[2023-07-05 11:34:32] [config] valid-freq: 50000000
[2023-07-05 11:34:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 11:34:32] [config] valid-max-length: 1000
[2023-07-05 11:34:32] [config] valid-metrics:
[2023-07-05 11:34:32] [config]   - cross-entropy
[2023-07-05 11:34:32] [config]   - translation
[2023-07-05 11:34:32] [config] valid-mini-batch: 32
[2023-07-05 11:34:32] [config] valid-reset-stalled: false
[2023-07-05 11:34:32] [config] valid-script-args:
[2023-07-05 11:34:32] [config]   []
[2023-07-05 11:34:32] [config] valid-script-path: ""
[2023-07-05 11:34:32] [config] valid-sets:
[2023-07-05 11:34:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 11:34:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 11:34:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 11:34:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:34:32] [config] vocabs:
[2023-07-05 11:34:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 11:34:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 11:34:32] [config] word-penalty: 0
[2023-07-05 11:34:32] [config] word-scores: false
[2023-07-05 11:34:32] [config] workspace: 2048
[2023-07-05 11:34:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:34:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 11:34:32] [training] Using single-device training
[2023-07-05 11:34:32] Synced seed 1234
[2023-07-05 11:34:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 11:34:32] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 11:34:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 11:34:32] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 11:34:32] [valid] No post-processing script given for validating translator
[2023-07-05 11:34:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 11:34:33] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 11:34:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 11:34:33] [comm] Using global sharding
[2023-07-05 11:34:33] [comm] NCCLCommunicators constructed successfully
[2023-07-05 11:34:33] [training] Using 1 GPUs
[2023-07-05 11:34:33] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:34:36] Loading Adam parameters
[2023-07-05 11:34:37] [memory] Reserving 823 MB, device gpu0
[2023-07-05 11:34:37] [memory] Reserving 411 MB, device gpu0
[2023-07-05 11:34:37] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 11:34:37] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-07-05 11:34:37] [data] Shuffling data
[2023-07-05 11:34:37] [data] Done reading 20,192 sentences
[2023-07-05 11:34:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:34:37] Training started
[2023-07-05 11:34:37] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 11:34:37] [logits] Applying loss function for 1 factor(s)
[2023-07-05 11:34:37] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 11:34:37] [memory] Reserving 411 MB, device gpu0
[2023-07-05 11:34:37] Parameter type float32, optimization type float32, casting types false
[2023-07-05 11:35:12] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 1.75467694 * 928,175 @ 688 after 11,182,940 : Time 39.48s : 23508.29 words/s : gNorm 1.5817
[2023-07-05 11:36:09] Seen 18,843 samples
[2023-07-05 11:36:09] Starting data epoch 42 in logical epoch 42
[2023-07-05 11:36:09] [data] Shuffling data
[2023-07-05 11:36:09] [data] Done reading 20,192 sentences
[2023-07-05 11:36:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:38:03] Seen 18,843 samples
[2023-07-05 11:38:03] Starting data epoch 43 in logical epoch 43
[2023-07-05 11:38:03] [data] Shuffling data
[2023-07-05 11:38:03] [data] Done reading 20,192 sentences
[2023-07-05 11:38:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:39:22] Seen 18,843 samples
[2023-07-05 11:39:22] Starting data epoch 44 in logical epoch 44
[2023-07-05 11:39:22] [data] Shuffling data
[2023-07-05 11:39:22] [data] Done reading 20,192 sentences
[2023-07-05 11:39:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:40:20] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 1.49277496 * 929,114 @ 512 after 12,112,054 : Time 307.87s : 3017.92 words/s : gNorm 1.4111
[2023-07-05 11:40:32] Seen 18,843 samples
[2023-07-05 11:40:32] Starting data epoch 45 in logical epoch 45
[2023-07-05 11:40:32] [data] Shuffling data
[2023-07-05 11:40:32] [data] Done reading 20,192 sentences
[2023-07-05 11:40:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:41:43] Seen 18,843 samples
[2023-07-05 11:41:43] Starting data epoch 46 in logical epoch 46
[2023-07-05 11:41:43] [data] Shuffling data
[2023-07-05 11:41:43] [data] Done reading 20,192 sentences
[2023-07-05 11:41:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:42:54] Seen 18,843 samples
[2023-07-05 11:42:54] Starting data epoch 47 in logical epoch 47
[2023-07-05 11:42:54] [data] Shuffling data
[2023-07-05 11:42:54] [data] Done reading 20,192 sentences
[2023-07-05 11:42:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:43:59] Seen 18,843 samples
[2023-07-05 11:43:59] Starting data epoch 48 in logical epoch 48
[2023-07-05 11:43:59] [data] Shuffling data
[2023-07-05 11:43:59] [data] Done reading 20,192 sentences
[2023-07-05 11:43:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:44:14] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 1.26453519 * 936,624 @ 960 after 13,048,678 : Time 234.00s : 4002.65 words/s : gNorm 1.3460
[2023-07-05 11:45:13] Seen 18,843 samples
[2023-07-05 11:45:13] Starting data epoch 49 in logical epoch 49
[2023-07-05 11:45:13] [data] Shuffling data
[2023-07-05 11:45:13] [data] Done reading 20,192 sentences
[2023-07-05 11:45:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:46:26] Seen 18,843 samples
[2023-07-05 11:46:26] Starting data epoch 50 in logical epoch 50
[2023-07-05 11:46:26] [data] Shuffling data
[2023-07-05 11:46:26] [data] Done reading 20,192 sentences
[2023-07-05 11:46:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:47:36] Seen 18,843 samples
[2023-07-05 11:47:36] Starting data epoch 51 in logical epoch 51
[2023-07-05 11:47:36] Training finished
[2023-07-05 11:47:44] [valid] Ep. 51 : Up. 14829 : cross-entropy : 107.916 : stalled 4 times (last best: 87.4293)
[2023-07-05 11:49:42] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-07-05 11:49:42] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:49:51] Saving Adam parameters
[2023-07-05 11:49:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 11:50:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:50:10] [marian] Running on node22.datos.cluster.uy as process 17787 with command line:
[2023-07-05 11:50:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 11:50:10] [config] after: 0e
[2023-07-05 11:50:10] [config] after-batches: 0
[2023-07-05 11:50:10] [config] after-epochs: 60
[2023-07-05 11:50:10] [config] all-caps-every: 0
[2023-07-05 11:50:10] [config] allow-unk: false
[2023-07-05 11:50:10] [config] authors: false
[2023-07-05 11:50:10] [config] beam-size: 12
[2023-07-05 11:50:10] [config] bert-class-symbol: "[CLS]"
[2023-07-05 11:50:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 11:50:10] [config] bert-masking-fraction: 0.15
[2023-07-05 11:50:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 11:50:10] [config] bert-train-type-embeddings: true
[2023-07-05 11:50:10] [config] bert-type-vocab-size: 2
[2023-07-05 11:50:10] [config] build-info: ""
[2023-07-05 11:50:10] [config] check-gradient-nan: false
[2023-07-05 11:50:10] [config] check-nan: false
[2023-07-05 11:50:10] [config] cite: false
[2023-07-05 11:50:10] [config] clip-norm: 1
[2023-07-05 11:50:10] [config] cost-scaling:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] cost-type: ce-sum
[2023-07-05 11:50:10] [config] cpu-threads: 0
[2023-07-05 11:50:10] [config] data-threads: 8
[2023-07-05 11:50:10] [config] data-weighting: ""
[2023-07-05 11:50:10] [config] data-weighting-type: sentence
[2023-07-05 11:50:10] [config] dec-cell: gru
[2023-07-05 11:50:10] [config] dec-cell-base-depth: 2
[2023-07-05 11:50:10] [config] dec-cell-high-depth: 1
[2023-07-05 11:50:10] [config] dec-depth: 1
[2023-07-05 11:50:10] [config] devices:
[2023-07-05 11:50:10] [config]   - 0
[2023-07-05 11:50:10] [config] dim-emb: 512
[2023-07-05 11:50:10] [config] dim-rnn: 1024
[2023-07-05 11:50:10] [config] dim-vocabs:
[2023-07-05 11:50:10] [config]   - 36507
[2023-07-05 11:50:10] [config]   - 54042
[2023-07-05 11:50:10] [config] disp-first: 0
[2023-07-05 11:50:10] [config] disp-freq: 1000u
[2023-07-05 11:50:10] [config] disp-label-counts: true
[2023-07-05 11:50:10] [config] dropout-rnn: 0
[2023-07-05 11:50:10] [config] dropout-src: 0
[2023-07-05 11:50:10] [config] dropout-trg: 0
[2023-07-05 11:50:10] [config] dump-config: ""
[2023-07-05 11:50:10] [config] dynamic-gradient-scaling:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] early-stopping: 10
[2023-07-05 11:50:10] [config] early-stopping-on: first
[2023-07-05 11:50:10] [config] embedding-fix-src: false
[2023-07-05 11:50:10] [config] embedding-fix-trg: false
[2023-07-05 11:50:10] [config] embedding-normalization: false
[2023-07-05 11:50:10] [config] embedding-vectors:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] enc-cell: gru
[2023-07-05 11:50:10] [config] enc-cell-depth: 1
[2023-07-05 11:50:10] [config] enc-depth: 1
[2023-07-05 11:50:10] [config] enc-type: bidirectional
[2023-07-05 11:50:10] [config] english-title-case-every: 0
[2023-07-05 11:50:10] [config] exponential-smoothing: 0
[2023-07-05 11:50:10] [config] factor-weight: 1
[2023-07-05 11:50:10] [config] factors-combine: sum
[2023-07-05 11:50:10] [config] factors-dim-emb: 0
[2023-07-05 11:50:10] [config] gradient-checkpointing: false
[2023-07-05 11:50:10] [config] gradient-norm-average-window: 100
[2023-07-05 11:50:10] [config] guided-alignment: none
[2023-07-05 11:50:10] [config] guided-alignment-cost: mse
[2023-07-05 11:50:10] [config] guided-alignment-weight: 0.1
[2023-07-05 11:50:10] [config] ignore-model-config: false
[2023-07-05 11:50:10] [config] input-types:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] interpolate-env-vars: false
[2023-07-05 11:50:10] [config] keep-best: false
[2023-07-05 11:50:10] [config] label-smoothing: 0
[2023-07-05 11:50:10] [config] layer-normalization: false
[2023-07-05 11:50:10] [config] learn-rate: 0.0001
[2023-07-05 11:50:10] [config] lemma-dependency: ""
[2023-07-05 11:50:10] [config] lemma-dim-emb: 0
[2023-07-05 11:50:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 11:50:10] [config] log-level: info
[2023-07-05 11:50:10] [config] log-time-zone: ""
[2023-07-05 11:50:10] [config] logical-epoch:
[2023-07-05 11:50:10] [config]   - 1e
[2023-07-05 11:50:10] [config]   - 0
[2023-07-05 11:50:10] [config] lr-decay: 0
[2023-07-05 11:50:10] [config] lr-decay-freq: 50000
[2023-07-05 11:50:10] [config] lr-decay-inv-sqrt:
[2023-07-05 11:50:10] [config]   - 0
[2023-07-05 11:50:10] [config] lr-decay-repeat-warmup: false
[2023-07-05 11:50:10] [config] lr-decay-reset-optimizer: false
[2023-07-05 11:50:10] [config] lr-decay-start:
[2023-07-05 11:50:10] [config]   - 10
[2023-07-05 11:50:10] [config]   - 1
[2023-07-05 11:50:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 11:50:10] [config] lr-report: false
[2023-07-05 11:50:10] [config] lr-warmup: 0
[2023-07-05 11:50:10] [config] lr-warmup-at-reload: false
[2023-07-05 11:50:10] [config] lr-warmup-cycle: false
[2023-07-05 11:50:10] [config] lr-warmup-start-rate: 0
[2023-07-05 11:50:10] [config] max-length: 50
[2023-07-05 11:50:10] [config] max-length-crop: false
[2023-07-05 11:50:10] [config] max-length-factor: 3
[2023-07-05 11:50:10] [config] maxi-batch: 100
[2023-07-05 11:50:10] [config] maxi-batch-sort: trg
[2023-07-05 11:50:10] [config] mini-batch: 64
[2023-07-05 11:50:10] [config] mini-batch-fit: false
[2023-07-05 11:50:10] [config] mini-batch-fit-step: 10
[2023-07-05 11:50:10] [config] mini-batch-round-up: true
[2023-07-05 11:50:10] [config] mini-batch-track-lr: false
[2023-07-05 11:50:10] [config] mini-batch-warmup: 0
[2023-07-05 11:50:10] [config] mini-batch-words: 0
[2023-07-05 11:50:10] [config] mini-batch-words-ref: 0
[2023-07-05 11:50:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:50:10] [config] multi-loss-type: sum
[2023-07-05 11:50:10] [config] n-best: false
[2023-07-05 11:50:10] [config] no-nccl: false
[2023-07-05 11:50:10] [config] no-reload: false
[2023-07-05 11:50:10] [config] no-restore-corpus: false
[2023-07-05 11:50:10] [config] normalize: 0
[2023-07-05 11:50:10] [config] normalize-gradient: false
[2023-07-05 11:50:10] [config] num-devices: 0
[2023-07-05 11:50:10] [config] optimizer: adam
[2023-07-05 11:50:10] [config] optimizer-delay: 1
[2023-07-05 11:50:10] [config] optimizer-params:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] output-omit-bias: false
[2023-07-05 11:50:10] [config] overwrite: true
[2023-07-05 11:50:10] [config] precision:
[2023-07-05 11:50:10] [config]   - float32
[2023-07-05 11:50:10] [config]   - float32
[2023-07-05 11:50:10] [config] pretrained-model: ""
[2023-07-05 11:50:10] [config] quantize-biases: false
[2023-07-05 11:50:10] [config] quantize-bits: 0
[2023-07-05 11:50:10] [config] quantize-log-based: false
[2023-07-05 11:50:10] [config] quantize-optimization-steps: 0
[2023-07-05 11:50:10] [config] quiet: false
[2023-07-05 11:50:10] [config] quiet-translation: true
[2023-07-05 11:50:10] [config] relative-paths: false
[2023-07-05 11:50:10] [config] right-left: false
[2023-07-05 11:50:10] [config] save-freq: 10000u
[2023-07-05 11:50:10] [config] seed: 1234
[2023-07-05 11:50:10] [config] sentencepiece-alphas:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] sentencepiece-max-lines: 2000000
[2023-07-05 11:50:10] [config] sentencepiece-options: ""
[2023-07-05 11:50:10] [config] sharding: global
[2023-07-05 11:50:10] [config] shuffle: data
[2023-07-05 11:50:10] [config] shuffle-in-ram: false
[2023-07-05 11:50:10] [config] sigterm: save-and-exit
[2023-07-05 11:50:10] [config] skip: false
[2023-07-05 11:50:10] [config] sqlite: ""
[2023-07-05 11:50:10] [config] sqlite-drop: false
[2023-07-05 11:50:10] [config] sync-freq: 200u
[2023-07-05 11:50:10] [config] sync-sgd: false
[2023-07-05 11:50:10] [config] tempdir: /tmp
[2023-07-05 11:50:10] [config] tied-embeddings: false
[2023-07-05 11:50:10] [config] tied-embeddings-all: false
[2023-07-05 11:50:10] [config] tied-embeddings-src: false
[2023-07-05 11:50:10] [config] train-embedder-rank:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] train-sets:
[2023-07-05 11:50:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 11:50:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 11:50:10] [config] transformer-aan-activation: swish
[2023-07-05 11:50:10] [config] transformer-aan-depth: 2
[2023-07-05 11:50:10] [config] transformer-aan-nogate: false
[2023-07-05 11:50:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 11:50:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 11:50:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 11:50:10] [config] transformer-depth-scaling: false
[2023-07-05 11:50:10] [config] transformer-dim-aan: 2048
[2023-07-05 11:50:10] [config] transformer-dim-ffn: 2048
[2023-07-05 11:50:10] [config] transformer-dropout: 0
[2023-07-05 11:50:10] [config] transformer-dropout-attention: 0
[2023-07-05 11:50:10] [config] transformer-dropout-ffn: 0
[2023-07-05 11:50:10] [config] transformer-ffn-activation: swish
[2023-07-05 11:50:10] [config] transformer-ffn-depth: 2
[2023-07-05 11:50:10] [config] transformer-guided-alignment-layer: last
[2023-07-05 11:50:10] [config] transformer-heads: 8
[2023-07-05 11:50:10] [config] transformer-no-projection: false
[2023-07-05 11:50:10] [config] transformer-pool: false
[2023-07-05 11:50:10] [config] transformer-postprocess: dan
[2023-07-05 11:50:10] [config] transformer-postprocess-emb: d
[2023-07-05 11:50:10] [config] transformer-postprocess-top: ""
[2023-07-05 11:50:10] [config] transformer-preprocess: ""
[2023-07-05 11:50:10] [config] transformer-tied-layers:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] transformer-train-position-embeddings: false
[2023-07-05 11:50:10] [config] tsv: false
[2023-07-05 11:50:10] [config] tsv-fields: 0
[2023-07-05 11:50:10] [config] type: amun
[2023-07-05 11:50:10] [config] ulr: false
[2023-07-05 11:50:10] [config] ulr-dim-emb: 0
[2023-07-05 11:50:10] [config] ulr-dropout: 0
[2023-07-05 11:50:10] [config] ulr-keys-vectors: ""
[2023-07-05 11:50:10] [config] ulr-query-vectors: ""
[2023-07-05 11:50:10] [config] ulr-softmax-temperature: 1
[2023-07-05 11:50:10] [config] ulr-trainable-transformation: false
[2023-07-05 11:50:10] [config] unlikelihood-loss: false
[2023-07-05 11:50:10] [config] valid-freq: 50000000
[2023-07-05 11:50:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 11:50:10] [config] valid-max-length: 1000
[2023-07-05 11:50:10] [config] valid-metrics:
[2023-07-05 11:50:10] [config]   - cross-entropy
[2023-07-05 11:50:10] [config]   - translation
[2023-07-05 11:50:10] [config] valid-mini-batch: 32
[2023-07-05 11:50:10] [config] valid-reset-stalled: false
[2023-07-05 11:50:10] [config] valid-script-args:
[2023-07-05 11:50:10] [config]   []
[2023-07-05 11:50:10] [config] valid-script-path: ""
[2023-07-05 11:50:10] [config] valid-sets:
[2023-07-05 11:50:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 11:50:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 11:50:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 11:50:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:50:10] [config] vocabs:
[2023-07-05 11:50:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 11:50:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 11:50:10] [config] word-penalty: 0
[2023-07-05 11:50:10] [config] word-scores: false
[2023-07-05 11:50:10] [config] workspace: 2048
[2023-07-05 11:50:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 11:50:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 11:50:10] [training] Using single-device training
[2023-07-05 11:50:13] Synced seed 1234
[2023-07-05 11:50:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 11:50:13] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 11:50:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 11:50:13] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 11:50:13] [valid] No post-processing script given for validating translator
[2023-07-05 11:50:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 11:50:14] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 11:50:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 11:50:14] [comm] Using global sharding
[2023-07-05 11:50:14] [comm] NCCLCommunicators constructed successfully
[2023-07-05 11:50:14] [training] Using 1 GPUs
[2023-07-05 11:50:14] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 11:50:18] Loading Adam parameters
[2023-07-05 11:50:18] [memory] Reserving 823 MB, device gpu0
[2023-07-05 11:50:18] [memory] Reserving 411 MB, device gpu0
[2023-07-05 11:50:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 11:50:19] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-07-05 11:50:19] [data] Shuffling data
[2023-07-05 11:50:19] [data] Done reading 20,192 sentences
[2023-07-05 11:50:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:50:19] Training started
[2023-07-05 11:50:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 11:50:19] [logits] Applying loss function for 1 factor(s)
[2023-07-05 11:50:19] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 11:50:19] [memory] Reserving 411 MB, device gpu0
[2023-07-05 11:50:19] Parameter type float32, optimization type float32, casting types false
[2023-07-05 11:50:44] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 1.05087042 * 926,408 @ 428 after 13,975,086 : Time 30.80s : 30079.13 words/s : gNorm 1.0529
[2023-07-05 11:51:12] Seen 18,843 samples
[2023-07-05 11:51:12] Starting data epoch 52 in logical epoch 52
[2023-07-05 11:51:12] [data] Shuffling data
[2023-07-05 11:51:12] [data] Done reading 20,192 sentences
[2023-07-05 11:51:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:52:23] Seen 18,843 samples
[2023-07-05 11:52:23] Starting data epoch 53 in logical epoch 53
[2023-07-05 11:52:23] [data] Shuffling data
[2023-07-05 11:52:23] [data] Done reading 20,192 sentences
[2023-07-05 11:52:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:53:37] Seen 18,843 samples
[2023-07-05 11:53:37] Starting data epoch 54 in logical epoch 54
[2023-07-05 11:53:37] [data] Shuffling data
[2023-07-05 11:53:37] [data] Done reading 20,192 sentences
[2023-07-05 11:53:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:54:45] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 0.88867515 * 932,781 @ 128 after 14,907,867 : Time 240.59s : 3877.14 words/s : gNorm 1.0925
[2023-07-05 11:54:49] Seen 18,843 samples
[2023-07-05 11:54:49] Starting data epoch 55 in logical epoch 55
[2023-07-05 11:54:49] [data] Shuffling data
[2023-07-05 11:54:49] [data] Done reading 20,192 sentences
[2023-07-05 11:54:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:56:01] Seen 18,843 samples
[2023-07-05 11:56:01] Starting data epoch 56 in logical epoch 56
[2023-07-05 11:56:01] [data] Shuffling data
[2023-07-05 11:56:01] [data] Done reading 20,192 sentences
[2023-07-05 11:56:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:57:14] Seen 18,843 samples
[2023-07-05 11:57:14] Starting data epoch 57 in logical epoch 57
[2023-07-05 11:57:14] [data] Shuffling data
[2023-07-05 11:57:14] [data] Done reading 20,192 sentences
[2023-07-05 11:57:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:58:20] Seen 18,843 samples
[2023-07-05 11:58:20] Starting data epoch 58 in logical epoch 58
[2023-07-05 11:58:20] [data] Shuffling data
[2023-07-05 11:58:20] [data] Done reading 20,192 sentences
[2023-07-05 11:58:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 11:58:42] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 0.73174447 * 935,840 @ 1,399 after 15,843,707 : Time 237.54s : 3939.66 words/s : gNorm 1.0095
[2023-07-05 11:59:29] Seen 18,843 samples
[2023-07-05 11:59:29] Starting data epoch 59 in logical epoch 59
[2023-07-05 11:59:29] [data] Shuffling data
[2023-07-05 11:59:29] [data] Done reading 20,192 sentences
[2023-07-05 11:59:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:00:44] Seen 18,843 samples
[2023-07-05 12:00:44] Starting data epoch 60 in logical epoch 60
[2023-07-05 12:00:44] [data] Shuffling data
[2023-07-05 12:00:44] [data] Done reading 20,192 sentences
[2023-07-05 12:00:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:01:54] Seen 18,843 samples
[2023-07-05 12:01:54] Starting data epoch 61 in logical epoch 61
[2023-07-05 12:01:54] Training finished
[2023-07-05 12:02:03] [valid] Ep. 61 : Up. 17795 : cross-entropy : 115.677 : stalled 5 times (last best: 87.4293)
[2023-07-05 12:03:57] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-07-05 12:03:57] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:04:04] Saving Adam parameters
[2023-07-05 12:04:05] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:04:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:04:24] [marian] Running on node22.datos.cluster.uy as process 31902 with command line:
[2023-07-05 12:04:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 12:04:24] [config] after: 0e
[2023-07-05 12:04:24] [config] after-batches: 0
[2023-07-05 12:04:24] [config] after-epochs: 70
[2023-07-05 12:04:24] [config] all-caps-every: 0
[2023-07-05 12:04:24] [config] allow-unk: false
[2023-07-05 12:04:24] [config] authors: false
[2023-07-05 12:04:24] [config] beam-size: 12
[2023-07-05 12:04:24] [config] bert-class-symbol: "[CLS]"
[2023-07-05 12:04:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 12:04:24] [config] bert-masking-fraction: 0.15
[2023-07-05 12:04:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 12:04:24] [config] bert-train-type-embeddings: true
[2023-07-05 12:04:24] [config] bert-type-vocab-size: 2
[2023-07-05 12:04:24] [config] build-info: ""
[2023-07-05 12:04:24] [config] check-gradient-nan: false
[2023-07-05 12:04:24] [config] check-nan: false
[2023-07-05 12:04:24] [config] cite: false
[2023-07-05 12:04:24] [config] clip-norm: 1
[2023-07-05 12:04:24] [config] cost-scaling:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] cost-type: ce-sum
[2023-07-05 12:04:24] [config] cpu-threads: 0
[2023-07-05 12:04:24] [config] data-threads: 8
[2023-07-05 12:04:24] [config] data-weighting: ""
[2023-07-05 12:04:24] [config] data-weighting-type: sentence
[2023-07-05 12:04:24] [config] dec-cell: gru
[2023-07-05 12:04:24] [config] dec-cell-base-depth: 2
[2023-07-05 12:04:24] [config] dec-cell-high-depth: 1
[2023-07-05 12:04:24] [config] dec-depth: 1
[2023-07-05 12:04:24] [config] devices:
[2023-07-05 12:04:24] [config]   - 0
[2023-07-05 12:04:24] [config] dim-emb: 512
[2023-07-05 12:04:24] [config] dim-rnn: 1024
[2023-07-05 12:04:24] [config] dim-vocabs:
[2023-07-05 12:04:24] [config]   - 36507
[2023-07-05 12:04:24] [config]   - 54042
[2023-07-05 12:04:24] [config] disp-first: 0
[2023-07-05 12:04:24] [config] disp-freq: 1000u
[2023-07-05 12:04:24] [config] disp-label-counts: true
[2023-07-05 12:04:24] [config] dropout-rnn: 0
[2023-07-05 12:04:24] [config] dropout-src: 0
[2023-07-05 12:04:24] [config] dropout-trg: 0
[2023-07-05 12:04:24] [config] dump-config: ""
[2023-07-05 12:04:24] [config] dynamic-gradient-scaling:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] early-stopping: 10
[2023-07-05 12:04:24] [config] early-stopping-on: first
[2023-07-05 12:04:24] [config] embedding-fix-src: false
[2023-07-05 12:04:24] [config] embedding-fix-trg: false
[2023-07-05 12:04:24] [config] embedding-normalization: false
[2023-07-05 12:04:24] [config] embedding-vectors:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] enc-cell: gru
[2023-07-05 12:04:24] [config] enc-cell-depth: 1
[2023-07-05 12:04:24] [config] enc-depth: 1
[2023-07-05 12:04:24] [config] enc-type: bidirectional
[2023-07-05 12:04:24] [config] english-title-case-every: 0
[2023-07-05 12:04:24] [config] exponential-smoothing: 0
[2023-07-05 12:04:24] [config] factor-weight: 1
[2023-07-05 12:04:24] [config] factors-combine: sum
[2023-07-05 12:04:24] [config] factors-dim-emb: 0
[2023-07-05 12:04:24] [config] gradient-checkpointing: false
[2023-07-05 12:04:24] [config] gradient-norm-average-window: 100
[2023-07-05 12:04:24] [config] guided-alignment: none
[2023-07-05 12:04:24] [config] guided-alignment-cost: mse
[2023-07-05 12:04:24] [config] guided-alignment-weight: 0.1
[2023-07-05 12:04:24] [config] ignore-model-config: false
[2023-07-05 12:04:24] [config] input-types:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] interpolate-env-vars: false
[2023-07-05 12:04:24] [config] keep-best: false
[2023-07-05 12:04:24] [config] label-smoothing: 0
[2023-07-05 12:04:24] [config] layer-normalization: false
[2023-07-05 12:04:24] [config] learn-rate: 0.0001
[2023-07-05 12:04:24] [config] lemma-dependency: ""
[2023-07-05 12:04:24] [config] lemma-dim-emb: 0
[2023-07-05 12:04:24] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 12:04:24] [config] log-level: info
[2023-07-05 12:04:24] [config] log-time-zone: ""
[2023-07-05 12:04:24] [config] logical-epoch:
[2023-07-05 12:04:24] [config]   - 1e
[2023-07-05 12:04:24] [config]   - 0
[2023-07-05 12:04:24] [config] lr-decay: 0
[2023-07-05 12:04:24] [config] lr-decay-freq: 50000
[2023-07-05 12:04:24] [config] lr-decay-inv-sqrt:
[2023-07-05 12:04:24] [config]   - 0
[2023-07-05 12:04:24] [config] lr-decay-repeat-warmup: false
[2023-07-05 12:04:24] [config] lr-decay-reset-optimizer: false
[2023-07-05 12:04:24] [config] lr-decay-start:
[2023-07-05 12:04:24] [config]   - 10
[2023-07-05 12:04:24] [config]   - 1
[2023-07-05 12:04:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 12:04:24] [config] lr-report: false
[2023-07-05 12:04:24] [config] lr-warmup: 0
[2023-07-05 12:04:24] [config] lr-warmup-at-reload: false
[2023-07-05 12:04:24] [config] lr-warmup-cycle: false
[2023-07-05 12:04:24] [config] lr-warmup-start-rate: 0
[2023-07-05 12:04:24] [config] max-length: 50
[2023-07-05 12:04:24] [config] max-length-crop: false
[2023-07-05 12:04:24] [config] max-length-factor: 3
[2023-07-05 12:04:24] [config] maxi-batch: 100
[2023-07-05 12:04:24] [config] maxi-batch-sort: trg
[2023-07-05 12:04:24] [config] mini-batch: 64
[2023-07-05 12:04:24] [config] mini-batch-fit: false
[2023-07-05 12:04:24] [config] mini-batch-fit-step: 10
[2023-07-05 12:04:24] [config] mini-batch-round-up: true
[2023-07-05 12:04:24] [config] mini-batch-track-lr: false
[2023-07-05 12:04:24] [config] mini-batch-warmup: 0
[2023-07-05 12:04:24] [config] mini-batch-words: 0
[2023-07-05 12:04:24] [config] mini-batch-words-ref: 0
[2023-07-05 12:04:24] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:04:24] [config] multi-loss-type: sum
[2023-07-05 12:04:24] [config] n-best: false
[2023-07-05 12:04:24] [config] no-nccl: false
[2023-07-05 12:04:24] [config] no-reload: false
[2023-07-05 12:04:24] [config] no-restore-corpus: false
[2023-07-05 12:04:24] [config] normalize: 0
[2023-07-05 12:04:24] [config] normalize-gradient: false
[2023-07-05 12:04:24] [config] num-devices: 0
[2023-07-05 12:04:24] [config] optimizer: adam
[2023-07-05 12:04:24] [config] optimizer-delay: 1
[2023-07-05 12:04:24] [config] optimizer-params:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] output-omit-bias: false
[2023-07-05 12:04:24] [config] overwrite: true
[2023-07-05 12:04:24] [config] precision:
[2023-07-05 12:04:24] [config]   - float32
[2023-07-05 12:04:24] [config]   - float32
[2023-07-05 12:04:24] [config] pretrained-model: ""
[2023-07-05 12:04:24] [config] quantize-biases: false
[2023-07-05 12:04:24] [config] quantize-bits: 0
[2023-07-05 12:04:24] [config] quantize-log-based: false
[2023-07-05 12:04:24] [config] quantize-optimization-steps: 0
[2023-07-05 12:04:24] [config] quiet: false
[2023-07-05 12:04:24] [config] quiet-translation: true
[2023-07-05 12:04:24] [config] relative-paths: false
[2023-07-05 12:04:24] [config] right-left: false
[2023-07-05 12:04:24] [config] save-freq: 10000u
[2023-07-05 12:04:24] [config] seed: 1234
[2023-07-05 12:04:24] [config] sentencepiece-alphas:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] sentencepiece-max-lines: 2000000
[2023-07-05 12:04:24] [config] sentencepiece-options: ""
[2023-07-05 12:04:24] [config] sharding: global
[2023-07-05 12:04:24] [config] shuffle: data
[2023-07-05 12:04:24] [config] shuffle-in-ram: false
[2023-07-05 12:04:24] [config] sigterm: save-and-exit
[2023-07-05 12:04:24] [config] skip: false
[2023-07-05 12:04:24] [config] sqlite: ""
[2023-07-05 12:04:24] [config] sqlite-drop: false
[2023-07-05 12:04:24] [config] sync-freq: 200u
[2023-07-05 12:04:24] [config] sync-sgd: false
[2023-07-05 12:04:24] [config] tempdir: /tmp
[2023-07-05 12:04:24] [config] tied-embeddings: false
[2023-07-05 12:04:24] [config] tied-embeddings-all: false
[2023-07-05 12:04:24] [config] tied-embeddings-src: false
[2023-07-05 12:04:24] [config] train-embedder-rank:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] train-sets:
[2023-07-05 12:04:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 12:04:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 12:04:24] [config] transformer-aan-activation: swish
[2023-07-05 12:04:24] [config] transformer-aan-depth: 2
[2023-07-05 12:04:24] [config] transformer-aan-nogate: false
[2023-07-05 12:04:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 12:04:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 12:04:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 12:04:24] [config] transformer-depth-scaling: false
[2023-07-05 12:04:24] [config] transformer-dim-aan: 2048
[2023-07-05 12:04:24] [config] transformer-dim-ffn: 2048
[2023-07-05 12:04:24] [config] transformer-dropout: 0
[2023-07-05 12:04:24] [config] transformer-dropout-attention: 0
[2023-07-05 12:04:24] [config] transformer-dropout-ffn: 0
[2023-07-05 12:04:24] [config] transformer-ffn-activation: swish
[2023-07-05 12:04:24] [config] transformer-ffn-depth: 2
[2023-07-05 12:04:24] [config] transformer-guided-alignment-layer: last
[2023-07-05 12:04:24] [config] transformer-heads: 8
[2023-07-05 12:04:24] [config] transformer-no-projection: false
[2023-07-05 12:04:24] [config] transformer-pool: false
[2023-07-05 12:04:24] [config] transformer-postprocess: dan
[2023-07-05 12:04:24] [config] transformer-postprocess-emb: d
[2023-07-05 12:04:24] [config] transformer-postprocess-top: ""
[2023-07-05 12:04:24] [config] transformer-preprocess: ""
[2023-07-05 12:04:24] [config] transformer-tied-layers:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] transformer-train-position-embeddings: false
[2023-07-05 12:04:24] [config] tsv: false
[2023-07-05 12:04:24] [config] tsv-fields: 0
[2023-07-05 12:04:24] [config] type: amun
[2023-07-05 12:04:24] [config] ulr: false
[2023-07-05 12:04:24] [config] ulr-dim-emb: 0
[2023-07-05 12:04:24] [config] ulr-dropout: 0
[2023-07-05 12:04:24] [config] ulr-keys-vectors: ""
[2023-07-05 12:04:24] [config] ulr-query-vectors: ""
[2023-07-05 12:04:24] [config] ulr-softmax-temperature: 1
[2023-07-05 12:04:24] [config] ulr-trainable-transformation: false
[2023-07-05 12:04:24] [config] unlikelihood-loss: false
[2023-07-05 12:04:24] [config] valid-freq: 50000000
[2023-07-05 12:04:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 12:04:24] [config] valid-max-length: 1000
[2023-07-05 12:04:24] [config] valid-metrics:
[2023-07-05 12:04:24] [config]   - cross-entropy
[2023-07-05 12:04:24] [config]   - translation
[2023-07-05 12:04:24] [config] valid-mini-batch: 32
[2023-07-05 12:04:24] [config] valid-reset-stalled: false
[2023-07-05 12:04:24] [config] valid-script-args:
[2023-07-05 12:04:24] [config]   []
[2023-07-05 12:04:24] [config] valid-script-path: ""
[2023-07-05 12:04:24] [config] valid-sets:
[2023-07-05 12:04:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 12:04:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 12:04:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 12:04:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:04:24] [config] vocabs:
[2023-07-05 12:04:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:04:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:04:24] [config] word-penalty: 0
[2023-07-05 12:04:24] [config] word-scores: false
[2023-07-05 12:04:24] [config] workspace: 2048
[2023-07-05 12:04:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:04:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:04:24] [training] Using single-device training
[2023-07-05 12:04:26] Synced seed 1234
[2023-07-05 12:04:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:04:26] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 12:04:26] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:04:26] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 12:04:26] [valid] No post-processing script given for validating translator
[2023-07-05 12:04:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:04:27] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 12:04:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 12:04:27] [comm] Using global sharding
[2023-07-05 12:04:27] [comm] NCCLCommunicators constructed successfully
[2023-07-05 12:04:27] [training] Using 1 GPUs
[2023-07-05 12:04:27] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:04:30] Loading Adam parameters
[2023-07-05 12:04:31] [memory] Reserving 823 MB, device gpu0
[2023-07-05 12:04:31] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:04:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:04:31] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-07-05 12:04:31] [data] Shuffling data
[2023-07-05 12:04:31] [data] Done reading 20,192 sentences
[2023-07-05 12:04:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:04:31] Training started
[2023-07-05 12:04:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 12:04:31] [logits] Applying loss function for 1 factor(s)
[2023-07-05 12:04:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 12:04:31] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:04:31] Parameter type float32, optimization type float32, casting types false
[2023-07-05 12:05:05] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 0.59789383 * 927,911 @ 960 after 16,771,618 : Time 38.72s : 23964.03 words/s : gNorm 0.8665
[2023-07-05 12:05:25] Seen 18,843 samples
[2023-07-05 12:05:25] Starting data epoch 62 in logical epoch 62
[2023-07-05 12:05:25] [data] Shuffling data
[2023-07-05 12:05:25] [data] Done reading 20,192 sentences
[2023-07-05 12:05:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:06:37] Seen 18,843 samples
[2023-07-05 12:06:37] Starting data epoch 63 in logical epoch 63
[2023-07-05 12:06:37] [data] Shuffling data
[2023-07-05 12:06:37] [data] Done reading 20,192 sentences
[2023-07-05 12:06:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:07:49] Seen 18,843 samples
[2023-07-05 12:07:49] Starting data epoch 64 in logical epoch 64
[2023-07-05 12:07:49] [data] Shuffling data
[2023-07-05 12:07:49] [data] Done reading 20,192 sentences
[2023-07-05 12:07:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:09:02] Seen 18,843 samples
[2023-07-05 12:09:02] Starting data epoch 65 in logical epoch 65
[2023-07-05 12:09:02] [data] Shuffling data
[2023-07-05 12:09:02] [data] Done reading 20,192 sentences
[2023-07-05 12:09:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:09:05] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 0.49324122 * 929,328 @ 384 after 17,700,946 : Time 240.30s : 3867.42 words/s : gNorm 0.8206
[2023-07-05 12:10:12] Seen 18,843 samples
[2023-07-05 12:10:12] Starting data epoch 66 in logical epoch 66
[2023-07-05 12:10:12] [data] Shuffling data
[2023-07-05 12:10:12] [data] Done reading 20,192 sentences
[2023-07-05 12:10:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:11:23] Seen 18,843 samples
[2023-07-05 12:11:23] Starting data epoch 67 in logical epoch 67
[2023-07-05 12:11:23] [data] Shuffling data
[2023-07-05 12:11:23] [data] Done reading 20,192 sentences
[2023-07-05 12:11:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:12:37] Seen 18,843 samples
[2023-07-05 12:12:37] Starting data epoch 68 in logical epoch 68
[2023-07-05 12:12:37] [data] Shuffling data
[2023-07-05 12:12:37] [data] Done reading 20,192 sentences
[2023-07-05 12:12:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:13:10] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 0.39742714 * 941,249 @ 1,088 after 18,642,195 : Time 244.70s : 3846.54 words/s : gNorm 0.7032
[2023-07-05 12:13:10] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:13:15] Saving Adam parameters
[2023-07-05 12:13:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:13:57] Seen 18,843 samples
[2023-07-05 12:13:57] Starting data epoch 69 in logical epoch 69
[2023-07-05 12:13:57] [data] Shuffling data
[2023-07-05 12:13:57] [data] Done reading 20,192 sentences
[2023-07-05 12:13:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:15:09] Seen 18,843 samples
[2023-07-05 12:15:09] Starting data epoch 70 in logical epoch 70
[2023-07-05 12:15:09] [data] Shuffling data
[2023-07-05 12:15:09] [data] Done reading 20,192 sentences
[2023-07-05 12:15:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:16:22] Seen 18,843 samples
[2023-07-05 12:16:22] Starting data epoch 71 in logical epoch 71
[2023-07-05 12:16:22] Training finished
[2023-07-05 12:16:30] [valid] Ep. 71 : Up. 20760 : cross-entropy : 123.295 : stalled 6 times (last best: 87.4293)
[2023-07-05 12:18:22] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-07-05 12:18:22] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:18:28] Saving Adam parameters
[2023-07-05 12:18:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:18:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:18:48] [marian] Running on node22.datos.cluster.uy as process 5412 with command line:
[2023-07-05 12:18:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 12:18:48] [config] after: 0e
[2023-07-05 12:18:48] [config] after-batches: 0
[2023-07-05 12:18:48] [config] after-epochs: 80
[2023-07-05 12:18:48] [config] all-caps-every: 0
[2023-07-05 12:18:48] [config] allow-unk: false
[2023-07-05 12:18:48] [config] authors: false
[2023-07-05 12:18:48] [config] beam-size: 12
[2023-07-05 12:18:48] [config] bert-class-symbol: "[CLS]"
[2023-07-05 12:18:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 12:18:48] [config] bert-masking-fraction: 0.15
[2023-07-05 12:18:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 12:18:48] [config] bert-train-type-embeddings: true
[2023-07-05 12:18:48] [config] bert-type-vocab-size: 2
[2023-07-05 12:18:48] [config] build-info: ""
[2023-07-05 12:18:48] [config] check-gradient-nan: false
[2023-07-05 12:18:48] [config] check-nan: false
[2023-07-05 12:18:48] [config] cite: false
[2023-07-05 12:18:48] [config] clip-norm: 1
[2023-07-05 12:18:48] [config] cost-scaling:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] cost-type: ce-sum
[2023-07-05 12:18:48] [config] cpu-threads: 0
[2023-07-05 12:18:48] [config] data-threads: 8
[2023-07-05 12:18:48] [config] data-weighting: ""
[2023-07-05 12:18:48] [config] data-weighting-type: sentence
[2023-07-05 12:18:48] [config] dec-cell: gru
[2023-07-05 12:18:48] [config] dec-cell-base-depth: 2
[2023-07-05 12:18:48] [config] dec-cell-high-depth: 1
[2023-07-05 12:18:48] [config] dec-depth: 1
[2023-07-05 12:18:48] [config] devices:
[2023-07-05 12:18:48] [config]   - 0
[2023-07-05 12:18:48] [config] dim-emb: 512
[2023-07-05 12:18:48] [config] dim-rnn: 1024
[2023-07-05 12:18:48] [config] dim-vocabs:
[2023-07-05 12:18:48] [config]   - 36507
[2023-07-05 12:18:48] [config]   - 54042
[2023-07-05 12:18:48] [config] disp-first: 0
[2023-07-05 12:18:48] [config] disp-freq: 1000u
[2023-07-05 12:18:48] [config] disp-label-counts: true
[2023-07-05 12:18:48] [config] dropout-rnn: 0
[2023-07-05 12:18:48] [config] dropout-src: 0
[2023-07-05 12:18:48] [config] dropout-trg: 0
[2023-07-05 12:18:48] [config] dump-config: ""
[2023-07-05 12:18:48] [config] dynamic-gradient-scaling:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] early-stopping: 10
[2023-07-05 12:18:48] [config] early-stopping-on: first
[2023-07-05 12:18:48] [config] embedding-fix-src: false
[2023-07-05 12:18:48] [config] embedding-fix-trg: false
[2023-07-05 12:18:48] [config] embedding-normalization: false
[2023-07-05 12:18:48] [config] embedding-vectors:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] enc-cell: gru
[2023-07-05 12:18:48] [config] enc-cell-depth: 1
[2023-07-05 12:18:48] [config] enc-depth: 1
[2023-07-05 12:18:48] [config] enc-type: bidirectional
[2023-07-05 12:18:48] [config] english-title-case-every: 0
[2023-07-05 12:18:48] [config] exponential-smoothing: 0
[2023-07-05 12:18:48] [config] factor-weight: 1
[2023-07-05 12:18:48] [config] factors-combine: sum
[2023-07-05 12:18:48] [config] factors-dim-emb: 0
[2023-07-05 12:18:48] [config] gradient-checkpointing: false
[2023-07-05 12:18:48] [config] gradient-norm-average-window: 100
[2023-07-05 12:18:48] [config] guided-alignment: none
[2023-07-05 12:18:48] [config] guided-alignment-cost: mse
[2023-07-05 12:18:48] [config] guided-alignment-weight: 0.1
[2023-07-05 12:18:48] [config] ignore-model-config: false
[2023-07-05 12:18:48] [config] input-types:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] interpolate-env-vars: false
[2023-07-05 12:18:48] [config] keep-best: false
[2023-07-05 12:18:48] [config] label-smoothing: 0
[2023-07-05 12:18:48] [config] layer-normalization: false
[2023-07-05 12:18:48] [config] learn-rate: 0.0001
[2023-07-05 12:18:48] [config] lemma-dependency: ""
[2023-07-05 12:18:48] [config] lemma-dim-emb: 0
[2023-07-05 12:18:48] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 12:18:48] [config] log-level: info
[2023-07-05 12:18:48] [config] log-time-zone: ""
[2023-07-05 12:18:48] [config] logical-epoch:
[2023-07-05 12:18:48] [config]   - 1e
[2023-07-05 12:18:48] [config]   - 0
[2023-07-05 12:18:48] [config] lr-decay: 0
[2023-07-05 12:18:48] [config] lr-decay-freq: 50000
[2023-07-05 12:18:48] [config] lr-decay-inv-sqrt:
[2023-07-05 12:18:48] [config]   - 0
[2023-07-05 12:18:48] [config] lr-decay-repeat-warmup: false
[2023-07-05 12:18:48] [config] lr-decay-reset-optimizer: false
[2023-07-05 12:18:48] [config] lr-decay-start:
[2023-07-05 12:18:48] [config]   - 10
[2023-07-05 12:18:48] [config]   - 1
[2023-07-05 12:18:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 12:18:48] [config] lr-report: false
[2023-07-05 12:18:48] [config] lr-warmup: 0
[2023-07-05 12:18:48] [config] lr-warmup-at-reload: false
[2023-07-05 12:18:48] [config] lr-warmup-cycle: false
[2023-07-05 12:18:48] [config] lr-warmup-start-rate: 0
[2023-07-05 12:18:48] [config] max-length: 50
[2023-07-05 12:18:48] [config] max-length-crop: false
[2023-07-05 12:18:48] [config] max-length-factor: 3
[2023-07-05 12:18:48] [config] maxi-batch: 100
[2023-07-05 12:18:48] [config] maxi-batch-sort: trg
[2023-07-05 12:18:48] [config] mini-batch: 64
[2023-07-05 12:18:48] [config] mini-batch-fit: false
[2023-07-05 12:18:48] [config] mini-batch-fit-step: 10
[2023-07-05 12:18:48] [config] mini-batch-round-up: true
[2023-07-05 12:18:48] [config] mini-batch-track-lr: false
[2023-07-05 12:18:48] [config] mini-batch-warmup: 0
[2023-07-05 12:18:48] [config] mini-batch-words: 0
[2023-07-05 12:18:48] [config] mini-batch-words-ref: 0
[2023-07-05 12:18:48] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:18:48] [config] multi-loss-type: sum
[2023-07-05 12:18:48] [config] n-best: false
[2023-07-05 12:18:48] [config] no-nccl: false
[2023-07-05 12:18:48] [config] no-reload: false
[2023-07-05 12:18:48] [config] no-restore-corpus: false
[2023-07-05 12:18:48] [config] normalize: 0
[2023-07-05 12:18:48] [config] normalize-gradient: false
[2023-07-05 12:18:48] [config] num-devices: 0
[2023-07-05 12:18:48] [config] optimizer: adam
[2023-07-05 12:18:48] [config] optimizer-delay: 1
[2023-07-05 12:18:48] [config] optimizer-params:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] output-omit-bias: false
[2023-07-05 12:18:48] [config] overwrite: true
[2023-07-05 12:18:48] [config] precision:
[2023-07-05 12:18:48] [config]   - float32
[2023-07-05 12:18:48] [config]   - float32
[2023-07-05 12:18:48] [config] pretrained-model: ""
[2023-07-05 12:18:48] [config] quantize-biases: false
[2023-07-05 12:18:48] [config] quantize-bits: 0
[2023-07-05 12:18:48] [config] quantize-log-based: false
[2023-07-05 12:18:48] [config] quantize-optimization-steps: 0
[2023-07-05 12:18:48] [config] quiet: false
[2023-07-05 12:18:48] [config] quiet-translation: true
[2023-07-05 12:18:48] [config] relative-paths: false
[2023-07-05 12:18:48] [config] right-left: false
[2023-07-05 12:18:48] [config] save-freq: 10000u
[2023-07-05 12:18:48] [config] seed: 1234
[2023-07-05 12:18:48] [config] sentencepiece-alphas:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] sentencepiece-max-lines: 2000000
[2023-07-05 12:18:48] [config] sentencepiece-options: ""
[2023-07-05 12:18:48] [config] sharding: global
[2023-07-05 12:18:48] [config] shuffle: data
[2023-07-05 12:18:48] [config] shuffle-in-ram: false
[2023-07-05 12:18:48] [config] sigterm: save-and-exit
[2023-07-05 12:18:48] [config] skip: false
[2023-07-05 12:18:48] [config] sqlite: ""
[2023-07-05 12:18:48] [config] sqlite-drop: false
[2023-07-05 12:18:48] [config] sync-freq: 200u
[2023-07-05 12:18:48] [config] sync-sgd: false
[2023-07-05 12:18:48] [config] tempdir: /tmp
[2023-07-05 12:18:48] [config] tied-embeddings: false
[2023-07-05 12:18:48] [config] tied-embeddings-all: false
[2023-07-05 12:18:48] [config] tied-embeddings-src: false
[2023-07-05 12:18:48] [config] train-embedder-rank:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] train-sets:
[2023-07-05 12:18:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 12:18:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 12:18:48] [config] transformer-aan-activation: swish
[2023-07-05 12:18:48] [config] transformer-aan-depth: 2
[2023-07-05 12:18:48] [config] transformer-aan-nogate: false
[2023-07-05 12:18:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 12:18:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 12:18:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 12:18:48] [config] transformer-depth-scaling: false
[2023-07-05 12:18:48] [config] transformer-dim-aan: 2048
[2023-07-05 12:18:48] [config] transformer-dim-ffn: 2048
[2023-07-05 12:18:48] [config] transformer-dropout: 0
[2023-07-05 12:18:48] [config] transformer-dropout-attention: 0
[2023-07-05 12:18:48] [config] transformer-dropout-ffn: 0
[2023-07-05 12:18:48] [config] transformer-ffn-activation: swish
[2023-07-05 12:18:48] [config] transformer-ffn-depth: 2
[2023-07-05 12:18:48] [config] transformer-guided-alignment-layer: last
[2023-07-05 12:18:48] [config] transformer-heads: 8
[2023-07-05 12:18:48] [config] transformer-no-projection: false
[2023-07-05 12:18:48] [config] transformer-pool: false
[2023-07-05 12:18:48] [config] transformer-postprocess: dan
[2023-07-05 12:18:48] [config] transformer-postprocess-emb: d
[2023-07-05 12:18:48] [config] transformer-postprocess-top: ""
[2023-07-05 12:18:48] [config] transformer-preprocess: ""
[2023-07-05 12:18:48] [config] transformer-tied-layers:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] transformer-train-position-embeddings: false
[2023-07-05 12:18:48] [config] tsv: false
[2023-07-05 12:18:48] [config] tsv-fields: 0
[2023-07-05 12:18:48] [config] type: amun
[2023-07-05 12:18:48] [config] ulr: false
[2023-07-05 12:18:48] [config] ulr-dim-emb: 0
[2023-07-05 12:18:48] [config] ulr-dropout: 0
[2023-07-05 12:18:48] [config] ulr-keys-vectors: ""
[2023-07-05 12:18:48] [config] ulr-query-vectors: ""
[2023-07-05 12:18:48] [config] ulr-softmax-temperature: 1
[2023-07-05 12:18:48] [config] ulr-trainable-transformation: false
[2023-07-05 12:18:48] [config] unlikelihood-loss: false
[2023-07-05 12:18:48] [config] valid-freq: 50000000
[2023-07-05 12:18:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 12:18:48] [config] valid-max-length: 1000
[2023-07-05 12:18:48] [config] valid-metrics:
[2023-07-05 12:18:48] [config]   - cross-entropy
[2023-07-05 12:18:48] [config]   - translation
[2023-07-05 12:18:48] [config] valid-mini-batch: 32
[2023-07-05 12:18:48] [config] valid-reset-stalled: false
[2023-07-05 12:18:48] [config] valid-script-args:
[2023-07-05 12:18:48] [config]   []
[2023-07-05 12:18:48] [config] valid-script-path: ""
[2023-07-05 12:18:48] [config] valid-sets:
[2023-07-05 12:18:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 12:18:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 12:18:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 12:18:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:18:48] [config] vocabs:
[2023-07-05 12:18:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:18:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:18:48] [config] word-penalty: 0
[2023-07-05 12:18:48] [config] word-scores: false
[2023-07-05 12:18:48] [config] workspace: 2048
[2023-07-05 12:18:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:18:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:18:48] [training] Using single-device training
[2023-07-05 12:18:49] Synced seed 1234
[2023-07-05 12:18:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:18:49] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 12:18:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:18:49] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 12:18:49] [valid] No post-processing script given for validating translator
[2023-07-05 12:18:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:18:50] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 12:18:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 12:18:50] [comm] Using global sharding
[2023-07-05 12:18:50] [comm] NCCLCommunicators constructed successfully
[2023-07-05 12:18:50] [training] Using 1 GPUs
[2023-07-05 12:18:50] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:18:53] Loading Adam parameters
[2023-07-05 12:18:53] [memory] Reserving 823 MB, device gpu0
[2023-07-05 12:18:54] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:18:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:18:54] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-07-05 12:18:54] [data] Shuffling data
[2023-07-05 12:18:54] [data] Done reading 20,192 sentences
[2023-07-05 12:18:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:18:54] Training started
[2023-07-05 12:18:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 12:18:54] [logits] Applying loss function for 1 factor(s)
[2023-07-05 12:18:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 12:18:54] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:18:54] Parameter type float32, optimization type float32, casting types false
[2023-07-05 12:19:37] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.31166297 * 923,944 @ 1,048 after 19,566,139 : Time 48.19s : 19172.13 words/s : gNorm 0.7143
[2023-07-05 12:19:52] Seen 18,843 samples
[2023-07-05 12:19:52] Starting data epoch 72 in logical epoch 72
[2023-07-05 12:19:52] [data] Shuffling data
[2023-07-05 12:19:52] [data] Done reading 20,192 sentences
[2023-07-05 12:19:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:21:02] Seen 18,843 samples
[2023-07-05 12:21:02] Starting data epoch 73 in logical epoch 73
[2023-07-05 12:21:02] [data] Shuffling data
[2023-07-05 12:21:02] [data] Done reading 20,192 sentences
[2023-07-05 12:21:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:22:17] Seen 18,843 samples
[2023-07-05 12:22:17] Starting data epoch 74 in logical epoch 74
[2023-07-05 12:22:17] [data] Shuffling data
[2023-07-05 12:22:17] [data] Done reading 20,192 sentences
[2023-07-05 12:22:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:23:30] Seen 18,843 samples
[2023-07-05 12:23:30] Starting data epoch 75 in logical epoch 75
[2023-07-05 12:23:30] [data] Shuffling data
[2023-07-05 12:23:30] [data] Done reading 20,192 sentences
[2023-07-05 12:23:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:23:42] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.25199738 * 934,356 @ 1,902 after 20,500,495 : Time 244.87s : 3815.70 words/s : gNorm 0.5452
[2023-07-05 12:24:41] Seen 18,843 samples
[2023-07-05 12:24:41] Starting data epoch 76 in logical epoch 76
[2023-07-05 12:24:41] [data] Shuffling data
[2023-07-05 12:24:41] [data] Done reading 20,192 sentences
[2023-07-05 12:24:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:25:53] Seen 18,843 samples
[2023-07-05 12:25:53] Starting data epoch 77 in logical epoch 77
[2023-07-05 12:25:53] [data] Shuffling data
[2023-07-05 12:25:53] [data] Done reading 20,192 sentences
[2023-07-05 12:25:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:27:07] Seen 18,843 samples
[2023-07-05 12:27:07] Starting data epoch 78 in logical epoch 78
[2023-07-05 12:27:07] [data] Shuffling data
[2023-07-05 12:27:07] [data] Done reading 20,192 sentences
[2023-07-05 12:27:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:27:45] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.20006174 * 931,815 @ 407 after 21,432,310 : Time 242.87s : 3836.66 words/s : gNorm 0.4613
[2023-07-05 12:28:14] Seen 18,843 samples
[2023-07-05 12:28:14] Starting data epoch 79 in logical epoch 79
[2023-07-05 12:28:14] [data] Shuffling data
[2023-07-05 12:28:14] [data] Done reading 20,192 sentences
[2023-07-05 12:28:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:29:29] Seen 18,843 samples
[2023-07-05 12:29:29] Starting data epoch 80 in logical epoch 80
[2023-07-05 12:29:29] [data] Shuffling data
[2023-07-05 12:29:29] [data] Done reading 20,192 sentences
[2023-07-05 12:29:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:30:39] Seen 18,843 samples
[2023-07-05 12:30:39] Starting data epoch 81 in logical epoch 81
[2023-07-05 12:30:39] Training finished
[2023-07-05 12:30:48] [valid] Ep. 81 : Up. 23727 : cross-entropy : 129.622 : stalled 7 times (last best: 87.4293)
[2023-07-05 12:32:41] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-07-05 12:32:41] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:32:47] Saving Adam parameters
[2023-07-05 12:32:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:33:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:33:05] [marian] Running on node22.datos.cluster.uy as process 19756 with command line:
[2023-07-05 12:33:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 12:33:06] [config] after: 0e
[2023-07-05 12:33:06] [config] after-batches: 0
[2023-07-05 12:33:06] [config] after-epochs: 90
[2023-07-05 12:33:06] [config] all-caps-every: 0
[2023-07-05 12:33:06] [config] allow-unk: false
[2023-07-05 12:33:06] [config] authors: false
[2023-07-05 12:33:06] [config] beam-size: 12
[2023-07-05 12:33:06] [config] bert-class-symbol: "[CLS]"
[2023-07-05 12:33:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 12:33:06] [config] bert-masking-fraction: 0.15
[2023-07-05 12:33:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 12:33:06] [config] bert-train-type-embeddings: true
[2023-07-05 12:33:06] [config] bert-type-vocab-size: 2
[2023-07-05 12:33:06] [config] build-info: ""
[2023-07-05 12:33:06] [config] check-gradient-nan: false
[2023-07-05 12:33:06] [config] check-nan: false
[2023-07-05 12:33:06] [config] cite: false
[2023-07-05 12:33:06] [config] clip-norm: 1
[2023-07-05 12:33:06] [config] cost-scaling:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] cost-type: ce-sum
[2023-07-05 12:33:06] [config] cpu-threads: 0
[2023-07-05 12:33:06] [config] data-threads: 8
[2023-07-05 12:33:06] [config] data-weighting: ""
[2023-07-05 12:33:06] [config] data-weighting-type: sentence
[2023-07-05 12:33:06] [config] dec-cell: gru
[2023-07-05 12:33:06] [config] dec-cell-base-depth: 2
[2023-07-05 12:33:06] [config] dec-cell-high-depth: 1
[2023-07-05 12:33:06] [config] dec-depth: 1
[2023-07-05 12:33:06] [config] devices:
[2023-07-05 12:33:06] [config]   - 0
[2023-07-05 12:33:06] [config] dim-emb: 512
[2023-07-05 12:33:06] [config] dim-rnn: 1024
[2023-07-05 12:33:06] [config] dim-vocabs:
[2023-07-05 12:33:06] [config]   - 36507
[2023-07-05 12:33:06] [config]   - 54042
[2023-07-05 12:33:06] [config] disp-first: 0
[2023-07-05 12:33:06] [config] disp-freq: 1000u
[2023-07-05 12:33:06] [config] disp-label-counts: true
[2023-07-05 12:33:06] [config] dropout-rnn: 0
[2023-07-05 12:33:06] [config] dropout-src: 0
[2023-07-05 12:33:06] [config] dropout-trg: 0
[2023-07-05 12:33:06] [config] dump-config: ""
[2023-07-05 12:33:06] [config] dynamic-gradient-scaling:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] early-stopping: 10
[2023-07-05 12:33:06] [config] early-stopping-on: first
[2023-07-05 12:33:06] [config] embedding-fix-src: false
[2023-07-05 12:33:06] [config] embedding-fix-trg: false
[2023-07-05 12:33:06] [config] embedding-normalization: false
[2023-07-05 12:33:06] [config] embedding-vectors:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] enc-cell: gru
[2023-07-05 12:33:06] [config] enc-cell-depth: 1
[2023-07-05 12:33:06] [config] enc-depth: 1
[2023-07-05 12:33:06] [config] enc-type: bidirectional
[2023-07-05 12:33:06] [config] english-title-case-every: 0
[2023-07-05 12:33:06] [config] exponential-smoothing: 0
[2023-07-05 12:33:06] [config] factor-weight: 1
[2023-07-05 12:33:06] [config] factors-combine: sum
[2023-07-05 12:33:06] [config] factors-dim-emb: 0
[2023-07-05 12:33:06] [config] gradient-checkpointing: false
[2023-07-05 12:33:06] [config] gradient-norm-average-window: 100
[2023-07-05 12:33:06] [config] guided-alignment: none
[2023-07-05 12:33:06] [config] guided-alignment-cost: mse
[2023-07-05 12:33:06] [config] guided-alignment-weight: 0.1
[2023-07-05 12:33:06] [config] ignore-model-config: false
[2023-07-05 12:33:06] [config] input-types:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] interpolate-env-vars: false
[2023-07-05 12:33:06] [config] keep-best: false
[2023-07-05 12:33:06] [config] label-smoothing: 0
[2023-07-05 12:33:06] [config] layer-normalization: false
[2023-07-05 12:33:06] [config] learn-rate: 0.0001
[2023-07-05 12:33:06] [config] lemma-dependency: ""
[2023-07-05 12:33:06] [config] lemma-dim-emb: 0
[2023-07-05 12:33:06] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 12:33:06] [config] log-level: info
[2023-07-05 12:33:06] [config] log-time-zone: ""
[2023-07-05 12:33:06] [config] logical-epoch:
[2023-07-05 12:33:06] [config]   - 1e
[2023-07-05 12:33:06] [config]   - 0
[2023-07-05 12:33:06] [config] lr-decay: 0
[2023-07-05 12:33:06] [config] lr-decay-freq: 50000
[2023-07-05 12:33:06] [config] lr-decay-inv-sqrt:
[2023-07-05 12:33:06] [config]   - 0
[2023-07-05 12:33:06] [config] lr-decay-repeat-warmup: false
[2023-07-05 12:33:06] [config] lr-decay-reset-optimizer: false
[2023-07-05 12:33:06] [config] lr-decay-start:
[2023-07-05 12:33:06] [config]   - 10
[2023-07-05 12:33:06] [config]   - 1
[2023-07-05 12:33:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 12:33:06] [config] lr-report: false
[2023-07-05 12:33:06] [config] lr-warmup: 0
[2023-07-05 12:33:06] [config] lr-warmup-at-reload: false
[2023-07-05 12:33:06] [config] lr-warmup-cycle: false
[2023-07-05 12:33:06] [config] lr-warmup-start-rate: 0
[2023-07-05 12:33:06] [config] max-length: 50
[2023-07-05 12:33:06] [config] max-length-crop: false
[2023-07-05 12:33:06] [config] max-length-factor: 3
[2023-07-05 12:33:06] [config] maxi-batch: 100
[2023-07-05 12:33:06] [config] maxi-batch-sort: trg
[2023-07-05 12:33:06] [config] mini-batch: 64
[2023-07-05 12:33:06] [config] mini-batch-fit: false
[2023-07-05 12:33:06] [config] mini-batch-fit-step: 10
[2023-07-05 12:33:06] [config] mini-batch-round-up: true
[2023-07-05 12:33:06] [config] mini-batch-track-lr: false
[2023-07-05 12:33:06] [config] mini-batch-warmup: 0
[2023-07-05 12:33:06] [config] mini-batch-words: 0
[2023-07-05 12:33:06] [config] mini-batch-words-ref: 0
[2023-07-05 12:33:06] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:33:06] [config] multi-loss-type: sum
[2023-07-05 12:33:06] [config] n-best: false
[2023-07-05 12:33:06] [config] no-nccl: false
[2023-07-05 12:33:06] [config] no-reload: false
[2023-07-05 12:33:06] [config] no-restore-corpus: false
[2023-07-05 12:33:06] [config] normalize: 0
[2023-07-05 12:33:06] [config] normalize-gradient: false
[2023-07-05 12:33:06] [config] num-devices: 0
[2023-07-05 12:33:06] [config] optimizer: adam
[2023-07-05 12:33:06] [config] optimizer-delay: 1
[2023-07-05 12:33:06] [config] optimizer-params:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] output-omit-bias: false
[2023-07-05 12:33:06] [config] overwrite: true
[2023-07-05 12:33:06] [config] precision:
[2023-07-05 12:33:06] [config]   - float32
[2023-07-05 12:33:06] [config]   - float32
[2023-07-05 12:33:06] [config] pretrained-model: ""
[2023-07-05 12:33:06] [config] quantize-biases: false
[2023-07-05 12:33:06] [config] quantize-bits: 0
[2023-07-05 12:33:06] [config] quantize-log-based: false
[2023-07-05 12:33:06] [config] quantize-optimization-steps: 0
[2023-07-05 12:33:06] [config] quiet: false
[2023-07-05 12:33:06] [config] quiet-translation: true
[2023-07-05 12:33:06] [config] relative-paths: false
[2023-07-05 12:33:06] [config] right-left: false
[2023-07-05 12:33:06] [config] save-freq: 10000u
[2023-07-05 12:33:06] [config] seed: 1234
[2023-07-05 12:33:06] [config] sentencepiece-alphas:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] sentencepiece-max-lines: 2000000
[2023-07-05 12:33:06] [config] sentencepiece-options: ""
[2023-07-05 12:33:06] [config] sharding: global
[2023-07-05 12:33:06] [config] shuffle: data
[2023-07-05 12:33:06] [config] shuffle-in-ram: false
[2023-07-05 12:33:06] [config] sigterm: save-and-exit
[2023-07-05 12:33:06] [config] skip: false
[2023-07-05 12:33:06] [config] sqlite: ""
[2023-07-05 12:33:06] [config] sqlite-drop: false
[2023-07-05 12:33:06] [config] sync-freq: 200u
[2023-07-05 12:33:06] [config] sync-sgd: false
[2023-07-05 12:33:06] [config] tempdir: /tmp
[2023-07-05 12:33:06] [config] tied-embeddings: false
[2023-07-05 12:33:06] [config] tied-embeddings-all: false
[2023-07-05 12:33:06] [config] tied-embeddings-src: false
[2023-07-05 12:33:06] [config] train-embedder-rank:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] train-sets:
[2023-07-05 12:33:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 12:33:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 12:33:06] [config] transformer-aan-activation: swish
[2023-07-05 12:33:06] [config] transformer-aan-depth: 2
[2023-07-05 12:33:06] [config] transformer-aan-nogate: false
[2023-07-05 12:33:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 12:33:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 12:33:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 12:33:06] [config] transformer-depth-scaling: false
[2023-07-05 12:33:06] [config] transformer-dim-aan: 2048
[2023-07-05 12:33:06] [config] transformer-dim-ffn: 2048
[2023-07-05 12:33:06] [config] transformer-dropout: 0
[2023-07-05 12:33:06] [config] transformer-dropout-attention: 0
[2023-07-05 12:33:06] [config] transformer-dropout-ffn: 0
[2023-07-05 12:33:06] [config] transformer-ffn-activation: swish
[2023-07-05 12:33:06] [config] transformer-ffn-depth: 2
[2023-07-05 12:33:06] [config] transformer-guided-alignment-layer: last
[2023-07-05 12:33:06] [config] transformer-heads: 8
[2023-07-05 12:33:06] [config] transformer-no-projection: false
[2023-07-05 12:33:06] [config] transformer-pool: false
[2023-07-05 12:33:06] [config] transformer-postprocess: dan
[2023-07-05 12:33:06] [config] transformer-postprocess-emb: d
[2023-07-05 12:33:06] [config] transformer-postprocess-top: ""
[2023-07-05 12:33:06] [config] transformer-preprocess: ""
[2023-07-05 12:33:06] [config] transformer-tied-layers:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] transformer-train-position-embeddings: false
[2023-07-05 12:33:06] [config] tsv: false
[2023-07-05 12:33:06] [config] tsv-fields: 0
[2023-07-05 12:33:06] [config] type: amun
[2023-07-05 12:33:06] [config] ulr: false
[2023-07-05 12:33:06] [config] ulr-dim-emb: 0
[2023-07-05 12:33:06] [config] ulr-dropout: 0
[2023-07-05 12:33:06] [config] ulr-keys-vectors: ""
[2023-07-05 12:33:06] [config] ulr-query-vectors: ""
[2023-07-05 12:33:06] [config] ulr-softmax-temperature: 1
[2023-07-05 12:33:06] [config] ulr-trainable-transformation: false
[2023-07-05 12:33:06] [config] unlikelihood-loss: false
[2023-07-05 12:33:06] [config] valid-freq: 50000000
[2023-07-05 12:33:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 12:33:06] [config] valid-max-length: 1000
[2023-07-05 12:33:06] [config] valid-metrics:
[2023-07-05 12:33:06] [config]   - cross-entropy
[2023-07-05 12:33:06] [config]   - translation
[2023-07-05 12:33:06] [config] valid-mini-batch: 32
[2023-07-05 12:33:06] [config] valid-reset-stalled: false
[2023-07-05 12:33:06] [config] valid-script-args:
[2023-07-05 12:33:06] [config]   []
[2023-07-05 12:33:06] [config] valid-script-path: ""
[2023-07-05 12:33:06] [config] valid-sets:
[2023-07-05 12:33:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 12:33:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 12:33:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 12:33:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:33:06] [config] vocabs:
[2023-07-05 12:33:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:33:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:33:06] [config] word-penalty: 0
[2023-07-05 12:33:06] [config] word-scores: false
[2023-07-05 12:33:06] [config] workspace: 2048
[2023-07-05 12:33:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:33:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:33:06] [training] Using single-device training
[2023-07-05 12:33:07] Synced seed 1234
[2023-07-05 12:33:07] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:33:07] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 12:33:07] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:33:07] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 12:33:07] [valid] No post-processing script given for validating translator
[2023-07-05 12:33:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:33:08] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 12:33:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 12:33:08] [comm] Using global sharding
[2023-07-05 12:33:08] [comm] NCCLCommunicators constructed successfully
[2023-07-05 12:33:08] [training] Using 1 GPUs
[2023-07-05 12:33:08] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:33:11] Loading Adam parameters
[2023-07-05 12:33:11] [memory] Reserving 823 MB, device gpu0
[2023-07-05 12:33:11] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:33:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:33:11] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-07-05 12:33:11] [data] Shuffling data
[2023-07-05 12:33:11] [data] Done reading 20,192 sentences
[2023-07-05 12:33:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:33:11] Training started
[2023-07-05 12:33:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 12:33:11] [logits] Applying loss function for 1 factor(s)
[2023-07-05 12:33:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 12:33:12] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:33:12] Parameter type float32, optimization type float32, casting types false
[2023-07-05 12:34:01] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.15638818 * 932,566 @ 576 after 22,364,876 : Time 54.36s : 17154.89 words/s : gNorm 0.5048
[2023-07-05 12:34:07] Seen 18,843 samples
[2023-07-05 12:34:07] Starting data epoch 82 in logical epoch 82
[2023-07-05 12:34:07] [data] Shuffling data
[2023-07-05 12:34:07] [data] Done reading 20,192 sentences
[2023-07-05 12:34:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:35:18] Seen 18,843 samples
[2023-07-05 12:35:18] Starting data epoch 83 in logical epoch 83
[2023-07-05 12:35:18] [data] Shuffling data
[2023-07-05 12:35:18] [data] Done reading 20,192 sentences
[2023-07-05 12:35:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:36:30] Seen 18,843 samples
[2023-07-05 12:36:30] Starting data epoch 84 in logical epoch 84
[2023-07-05 12:36:30] [data] Shuffling data
[2023-07-05 12:36:30] [data] Done reading 20,192 sentences
[2023-07-05 12:36:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:37:41] Seen 18,843 samples
[2023-07-05 12:37:41] Starting data epoch 85 in logical epoch 85
[2023-07-05 12:37:41] [data] Shuffling data
[2023-07-05 12:37:41] [data] Done reading 20,192 sentences
[2023-07-05 12:37:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:38:01] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.12524089 * 930,417 @ 896 after 23,295,293 : Time 240.38s : 3870.67 words/s : gNorm 0.4555
[2023-07-05 12:38:50] Seen 18,843 samples
[2023-07-05 12:38:50] Starting data epoch 86 in logical epoch 86
[2023-07-05 12:38:50] [data] Shuffling data
[2023-07-05 12:38:50] [data] Done reading 20,192 sentences
[2023-07-05 12:38:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:39:58] Seen 18,843 samples
[2023-07-05 12:39:58] Starting data epoch 87 in logical epoch 87
[2023-07-05 12:39:58] [data] Shuffling data
[2023-07-05 12:39:58] [data] Done reading 20,192 sentences
[2023-07-05 12:39:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:41:09] Seen 18,843 samples
[2023-07-05 12:41:09] Starting data epoch 88 in logical epoch 88
[2023-07-05 12:41:09] [data] Shuffling data
[2023-07-05 12:41:09] [data] Done reading 20,192 sentences
[2023-07-05 12:41:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:41:53] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.09908135 * 934,924 @ 640 after 24,230,217 : Time 231.22s : 4043.37 words/s : gNorm 0.3476
[2023-07-05 12:42:14] Seen 18,843 samples
[2023-07-05 12:42:14] Starting data epoch 89 in logical epoch 89
[2023-07-05 12:42:14] [data] Shuffling data
[2023-07-05 12:42:14] [data] Done reading 20,192 sentences
[2023-07-05 12:42:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:43:26] Seen 18,843 samples
[2023-07-05 12:43:26] Starting data epoch 90 in logical epoch 90
[2023-07-05 12:43:26] [data] Shuffling data
[2023-07-05 12:43:26] [data] Done reading 20,192 sentences
[2023-07-05 12:43:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:44:37] Seen 18,843 samples
[2023-07-05 12:44:37] Starting data epoch 91 in logical epoch 91
[2023-07-05 12:44:37] Training finished
[2023-07-05 12:44:44] [valid] Ep. 91 : Up. 26693 : cross-entropy : 134.965 : stalled 8 times (last best: 87.4293)
[2023-07-05 12:46:27] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-07-05 12:46:27] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:46:34] Saving Adam parameters
[2023-07-05 12:46:35] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:46:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:46:56] [marian] Running on node22.datos.cluster.uy as process 32703 with command line:
[2023-07-05 12:46:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 12:46:56] [config] after: 0e
[2023-07-05 12:46:56] [config] after-batches: 0
[2023-07-05 12:46:56] [config] after-epochs: 100
[2023-07-05 12:46:56] [config] all-caps-every: 0
[2023-07-05 12:46:56] [config] allow-unk: false
[2023-07-05 12:46:56] [config] authors: false
[2023-07-05 12:46:56] [config] beam-size: 12
[2023-07-05 12:46:56] [config] bert-class-symbol: "[CLS]"
[2023-07-05 12:46:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 12:46:56] [config] bert-masking-fraction: 0.15
[2023-07-05 12:46:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 12:46:56] [config] bert-train-type-embeddings: true
[2023-07-05 12:46:56] [config] bert-type-vocab-size: 2
[2023-07-05 12:46:56] [config] build-info: ""
[2023-07-05 12:46:56] [config] check-gradient-nan: false
[2023-07-05 12:46:56] [config] check-nan: false
[2023-07-05 12:46:56] [config] cite: false
[2023-07-05 12:46:56] [config] clip-norm: 1
[2023-07-05 12:46:56] [config] cost-scaling:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] cost-type: ce-sum
[2023-07-05 12:46:56] [config] cpu-threads: 0
[2023-07-05 12:46:56] [config] data-threads: 8
[2023-07-05 12:46:56] [config] data-weighting: ""
[2023-07-05 12:46:56] [config] data-weighting-type: sentence
[2023-07-05 12:46:56] [config] dec-cell: gru
[2023-07-05 12:46:56] [config] dec-cell-base-depth: 2
[2023-07-05 12:46:56] [config] dec-cell-high-depth: 1
[2023-07-05 12:46:56] [config] dec-depth: 1
[2023-07-05 12:46:56] [config] devices:
[2023-07-05 12:46:56] [config]   - 0
[2023-07-05 12:46:56] [config] dim-emb: 512
[2023-07-05 12:46:56] [config] dim-rnn: 1024
[2023-07-05 12:46:56] [config] dim-vocabs:
[2023-07-05 12:46:56] [config]   - 36507
[2023-07-05 12:46:56] [config]   - 54042
[2023-07-05 12:46:56] [config] disp-first: 0
[2023-07-05 12:46:56] [config] disp-freq: 1000u
[2023-07-05 12:46:56] [config] disp-label-counts: true
[2023-07-05 12:46:56] [config] dropout-rnn: 0
[2023-07-05 12:46:56] [config] dropout-src: 0
[2023-07-05 12:46:56] [config] dropout-trg: 0
[2023-07-05 12:46:56] [config] dump-config: ""
[2023-07-05 12:46:56] [config] dynamic-gradient-scaling:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] early-stopping: 10
[2023-07-05 12:46:56] [config] early-stopping-on: first
[2023-07-05 12:46:56] [config] embedding-fix-src: false
[2023-07-05 12:46:56] [config] embedding-fix-trg: false
[2023-07-05 12:46:56] [config] embedding-normalization: false
[2023-07-05 12:46:56] [config] embedding-vectors:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] enc-cell: gru
[2023-07-05 12:46:56] [config] enc-cell-depth: 1
[2023-07-05 12:46:56] [config] enc-depth: 1
[2023-07-05 12:46:56] [config] enc-type: bidirectional
[2023-07-05 12:46:56] [config] english-title-case-every: 0
[2023-07-05 12:46:56] [config] exponential-smoothing: 0
[2023-07-05 12:46:56] [config] factor-weight: 1
[2023-07-05 12:46:56] [config] factors-combine: sum
[2023-07-05 12:46:56] [config] factors-dim-emb: 0
[2023-07-05 12:46:56] [config] gradient-checkpointing: false
[2023-07-05 12:46:56] [config] gradient-norm-average-window: 100
[2023-07-05 12:46:56] [config] guided-alignment: none
[2023-07-05 12:46:56] [config] guided-alignment-cost: mse
[2023-07-05 12:46:56] [config] guided-alignment-weight: 0.1
[2023-07-05 12:46:56] [config] ignore-model-config: false
[2023-07-05 12:46:56] [config] input-types:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] interpolate-env-vars: false
[2023-07-05 12:46:56] [config] keep-best: false
[2023-07-05 12:46:56] [config] label-smoothing: 0
[2023-07-05 12:46:56] [config] layer-normalization: false
[2023-07-05 12:46:56] [config] learn-rate: 0.0001
[2023-07-05 12:46:56] [config] lemma-dependency: ""
[2023-07-05 12:46:56] [config] lemma-dim-emb: 0
[2023-07-05 12:46:56] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 12:46:56] [config] log-level: info
[2023-07-05 12:46:56] [config] log-time-zone: ""
[2023-07-05 12:46:56] [config] logical-epoch:
[2023-07-05 12:46:56] [config]   - 1e
[2023-07-05 12:46:56] [config]   - 0
[2023-07-05 12:46:56] [config] lr-decay: 0
[2023-07-05 12:46:56] [config] lr-decay-freq: 50000
[2023-07-05 12:46:56] [config] lr-decay-inv-sqrt:
[2023-07-05 12:46:56] [config]   - 0
[2023-07-05 12:46:56] [config] lr-decay-repeat-warmup: false
[2023-07-05 12:46:56] [config] lr-decay-reset-optimizer: false
[2023-07-05 12:46:56] [config] lr-decay-start:
[2023-07-05 12:46:56] [config]   - 10
[2023-07-05 12:46:56] [config]   - 1
[2023-07-05 12:46:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 12:46:56] [config] lr-report: false
[2023-07-05 12:46:56] [config] lr-warmup: 0
[2023-07-05 12:46:56] [config] lr-warmup-at-reload: false
[2023-07-05 12:46:56] [config] lr-warmup-cycle: false
[2023-07-05 12:46:56] [config] lr-warmup-start-rate: 0
[2023-07-05 12:46:56] [config] max-length: 50
[2023-07-05 12:46:56] [config] max-length-crop: false
[2023-07-05 12:46:56] [config] max-length-factor: 3
[2023-07-05 12:46:56] [config] maxi-batch: 100
[2023-07-05 12:46:56] [config] maxi-batch-sort: trg
[2023-07-05 12:46:56] [config] mini-batch: 64
[2023-07-05 12:46:56] [config] mini-batch-fit: false
[2023-07-05 12:46:56] [config] mini-batch-fit-step: 10
[2023-07-05 12:46:56] [config] mini-batch-round-up: true
[2023-07-05 12:46:56] [config] mini-batch-track-lr: false
[2023-07-05 12:46:56] [config] mini-batch-warmup: 0
[2023-07-05 12:46:56] [config] mini-batch-words: 0
[2023-07-05 12:46:56] [config] mini-batch-words-ref: 0
[2023-07-05 12:46:56] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:46:56] [config] multi-loss-type: sum
[2023-07-05 12:46:56] [config] n-best: false
[2023-07-05 12:46:56] [config] no-nccl: false
[2023-07-05 12:46:56] [config] no-reload: false
[2023-07-05 12:46:56] [config] no-restore-corpus: false
[2023-07-05 12:46:56] [config] normalize: 0
[2023-07-05 12:46:56] [config] normalize-gradient: false
[2023-07-05 12:46:56] [config] num-devices: 0
[2023-07-05 12:46:56] [config] optimizer: adam
[2023-07-05 12:46:56] [config] optimizer-delay: 1
[2023-07-05 12:46:56] [config] optimizer-params:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] output-omit-bias: false
[2023-07-05 12:46:56] [config] overwrite: true
[2023-07-05 12:46:56] [config] precision:
[2023-07-05 12:46:56] [config]   - float32
[2023-07-05 12:46:56] [config]   - float32
[2023-07-05 12:46:56] [config] pretrained-model: ""
[2023-07-05 12:46:56] [config] quantize-biases: false
[2023-07-05 12:46:56] [config] quantize-bits: 0
[2023-07-05 12:46:56] [config] quantize-log-based: false
[2023-07-05 12:46:56] [config] quantize-optimization-steps: 0
[2023-07-05 12:46:56] [config] quiet: false
[2023-07-05 12:46:56] [config] quiet-translation: true
[2023-07-05 12:46:56] [config] relative-paths: false
[2023-07-05 12:46:56] [config] right-left: false
[2023-07-05 12:46:56] [config] save-freq: 10000u
[2023-07-05 12:46:56] [config] seed: 1234
[2023-07-05 12:46:56] [config] sentencepiece-alphas:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] sentencepiece-max-lines: 2000000
[2023-07-05 12:46:56] [config] sentencepiece-options: ""
[2023-07-05 12:46:56] [config] sharding: global
[2023-07-05 12:46:56] [config] shuffle: data
[2023-07-05 12:46:56] [config] shuffle-in-ram: false
[2023-07-05 12:46:56] [config] sigterm: save-and-exit
[2023-07-05 12:46:56] [config] skip: false
[2023-07-05 12:46:56] [config] sqlite: ""
[2023-07-05 12:46:56] [config] sqlite-drop: false
[2023-07-05 12:46:56] [config] sync-freq: 200u
[2023-07-05 12:46:56] [config] sync-sgd: false
[2023-07-05 12:46:56] [config] tempdir: /tmp
[2023-07-05 12:46:56] [config] tied-embeddings: false
[2023-07-05 12:46:56] [config] tied-embeddings-all: false
[2023-07-05 12:46:56] [config] tied-embeddings-src: false
[2023-07-05 12:46:56] [config] train-embedder-rank:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] train-sets:
[2023-07-05 12:46:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 12:46:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 12:46:56] [config] transformer-aan-activation: swish
[2023-07-05 12:46:56] [config] transformer-aan-depth: 2
[2023-07-05 12:46:56] [config] transformer-aan-nogate: false
[2023-07-05 12:46:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 12:46:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 12:46:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 12:46:56] [config] transformer-depth-scaling: false
[2023-07-05 12:46:56] [config] transformer-dim-aan: 2048
[2023-07-05 12:46:56] [config] transformer-dim-ffn: 2048
[2023-07-05 12:46:56] [config] transformer-dropout: 0
[2023-07-05 12:46:56] [config] transformer-dropout-attention: 0
[2023-07-05 12:46:56] [config] transformer-dropout-ffn: 0
[2023-07-05 12:46:56] [config] transformer-ffn-activation: swish
[2023-07-05 12:46:56] [config] transformer-ffn-depth: 2
[2023-07-05 12:46:56] [config] transformer-guided-alignment-layer: last
[2023-07-05 12:46:56] [config] transformer-heads: 8
[2023-07-05 12:46:56] [config] transformer-no-projection: false
[2023-07-05 12:46:56] [config] transformer-pool: false
[2023-07-05 12:46:56] [config] transformer-postprocess: dan
[2023-07-05 12:46:56] [config] transformer-postprocess-emb: d
[2023-07-05 12:46:56] [config] transformer-postprocess-top: ""
[2023-07-05 12:46:56] [config] transformer-preprocess: ""
[2023-07-05 12:46:56] [config] transformer-tied-layers:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] transformer-train-position-embeddings: false
[2023-07-05 12:46:56] [config] tsv: false
[2023-07-05 12:46:56] [config] tsv-fields: 0
[2023-07-05 12:46:56] [config] type: amun
[2023-07-05 12:46:56] [config] ulr: false
[2023-07-05 12:46:56] [config] ulr-dim-emb: 0
[2023-07-05 12:46:56] [config] ulr-dropout: 0
[2023-07-05 12:46:56] [config] ulr-keys-vectors: ""
[2023-07-05 12:46:56] [config] ulr-query-vectors: ""
[2023-07-05 12:46:56] [config] ulr-softmax-temperature: 1
[2023-07-05 12:46:56] [config] ulr-trainable-transformation: false
[2023-07-05 12:46:56] [config] unlikelihood-loss: false
[2023-07-05 12:46:56] [config] valid-freq: 50000000
[2023-07-05 12:46:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 12:46:56] [config] valid-max-length: 1000
[2023-07-05 12:46:56] [config] valid-metrics:
[2023-07-05 12:46:56] [config]   - cross-entropy
[2023-07-05 12:46:56] [config]   - translation
[2023-07-05 12:46:56] [config] valid-mini-batch: 32
[2023-07-05 12:46:56] [config] valid-reset-stalled: false
[2023-07-05 12:46:56] [config] valid-script-args:
[2023-07-05 12:46:56] [config]   []
[2023-07-05 12:46:56] [config] valid-script-path: ""
[2023-07-05 12:46:56] [config] valid-sets:
[2023-07-05 12:46:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 12:46:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 12:46:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 12:46:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:46:56] [config] vocabs:
[2023-07-05 12:46:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:46:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:46:56] [config] word-penalty: 0
[2023-07-05 12:46:56] [config] word-scores: false
[2023-07-05 12:46:56] [config] workspace: 2048
[2023-07-05 12:46:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 12:46:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:46:56] [training] Using single-device training
[2023-07-05 12:46:58] Synced seed 1234
[2023-07-05 12:46:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 12:46:58] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 12:46:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 12:46:58] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 12:46:58] [valid] No post-processing script given for validating translator
[2023-07-05 12:46:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 12:46:59] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 12:46:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 12:46:59] [comm] Using global sharding
[2023-07-05 12:46:59] [comm] NCCLCommunicators constructed successfully
[2023-07-05 12:46:59] [training] Using 1 GPUs
[2023-07-05 12:46:59] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 12:47:02] Loading Adam parameters
[2023-07-05 12:47:02] [memory] Reserving 823 MB, device gpu0
[2023-07-05 12:47:03] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:47:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 12:47:03] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-07-05 12:47:03] [data] Shuffling data
[2023-07-05 12:47:03] [data] Done reading 20,192 sentences
[2023-07-05 12:47:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:47:03] Training started
[2023-07-05 12:47:03] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 12:47:03] [logits] Applying loss function for 1 factor(s)
[2023-07-05 12:47:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 12:47:03] [memory] Reserving 411 MB, device gpu0
[2023-07-05 12:47:03] Parameter type float32, optimization type float32, casting types false
[2023-07-05 12:47:54] Seen 18,843 samples
[2023-07-05 12:47:54] Starting data epoch 92 in logical epoch 92
[2023-07-05 12:47:54] [data] Shuffling data
[2023-07-05 12:47:54] [data] Done reading 20,192 sentences
[2023-07-05 12:47:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:47:56] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.07935652 * 926,263 @ 384 after 25,156,480 : Time 57.59s : 16084.65 words/s : gNorm 0.3706
[2023-07-05 12:49:03] Seen 18,843 samples
[2023-07-05 12:49:03] Starting data epoch 93 in logical epoch 93
[2023-07-05 12:49:03] [data] Shuffling data
[2023-07-05 12:49:03] [data] Done reading 20,192 sentences
[2023-07-05 12:49:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:50:14] Seen 18,843 samples
[2023-07-05 12:50:14] Starting data epoch 94 in logical epoch 94
[2023-07-05 12:50:14] [data] Shuffling data
[2023-07-05 12:50:14] [data] Done reading 20,192 sentences
[2023-07-05 12:50:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:51:23] Seen 18,843 samples
[2023-07-05 12:51:23] Starting data epoch 95 in logical epoch 95
[2023-07-05 12:51:23] [data] Shuffling data
[2023-07-05 12:51:23] [data] Done reading 20,192 sentences
[2023-07-05 12:51:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:51:52] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.06567881 * 936,745 @ 1,372 after 26,093,225 : Time 236.38s : 3962.80 words/s : gNorm 0.3277
[2023-07-05 12:52:28] Seen 18,843 samples
[2023-07-05 12:52:28] Starting data epoch 96 in logical epoch 96
[2023-07-05 12:52:28] [data] Shuffling data
[2023-07-05 12:52:28] [data] Done reading 20,192 sentences
[2023-07-05 12:52:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:53:38] Seen 18,843 samples
[2023-07-05 12:53:38] Starting data epoch 97 in logical epoch 97
[2023-07-05 12:53:38] [data] Shuffling data
[2023-07-05 12:53:38] [data] Done reading 20,192 sentences
[2023-07-05 12:53:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:54:49] Seen 18,843 samples
[2023-07-05 12:54:49] Starting data epoch 98 in logical epoch 98
[2023-07-05 12:54:49] [data] Shuffling data
[2023-07-05 12:54:49] [data] Done reading 20,192 sentences
[2023-07-05 12:54:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:55:44] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.05130875 * 930,226 @ 1,766 after 27,023,451 : Time 232.45s : 4001.75 words/s : gNorm 0.2838
[2023-07-05 12:56:01] Seen 18,843 samples
[2023-07-05 12:56:01] Starting data epoch 99 in logical epoch 99
[2023-07-05 12:56:01] [data] Shuffling data
[2023-07-05 12:56:01] [data] Done reading 20,192 sentences
[2023-07-05 12:56:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:57:14] Seen 18,843 samples
[2023-07-05 12:57:15] Starting data epoch 100 in logical epoch 100
[2023-07-05 12:57:15] [data] Shuffling data
[2023-07-05 12:57:15] [data] Done reading 20,192 sentences
[2023-07-05 12:57:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 12:58:19] Seen 18,843 samples
[2023-07-05 12:58:19] Starting data epoch 101 in logical epoch 101
[2023-07-05 12:58:19] Training finished
[2023-07-05 12:58:27] [valid] Ep. 101 : Up. 29659 : cross-entropy : 139.929 : stalled 9 times (last best: 87.4293)
[2023-07-05 13:00:21] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-07-05 13:00:21] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:00:27] Saving Adam parameters
[2023-07-05 13:00:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:00:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:00:46] [marian] Running on node22.datos.cluster.uy as process 6071 with command line:
[2023-07-05 13:00:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:00:46] [config] after: 0e
[2023-07-05 13:00:46] [config] after-batches: 0
[2023-07-05 13:00:46] [config] after-epochs: 110
[2023-07-05 13:00:46] [config] all-caps-every: 0
[2023-07-05 13:00:46] [config] allow-unk: false
[2023-07-05 13:00:46] [config] authors: false
[2023-07-05 13:00:46] [config] beam-size: 12
[2023-07-05 13:00:46] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:00:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:00:46] [config] bert-masking-fraction: 0.15
[2023-07-05 13:00:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:00:46] [config] bert-train-type-embeddings: true
[2023-07-05 13:00:46] [config] bert-type-vocab-size: 2
[2023-07-05 13:00:46] [config] build-info: ""
[2023-07-05 13:00:46] [config] check-gradient-nan: false
[2023-07-05 13:00:46] [config] check-nan: false
[2023-07-05 13:00:46] [config] cite: false
[2023-07-05 13:00:46] [config] clip-norm: 1
[2023-07-05 13:00:46] [config] cost-scaling:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] cost-type: ce-sum
[2023-07-05 13:00:46] [config] cpu-threads: 0
[2023-07-05 13:00:46] [config] data-threads: 8
[2023-07-05 13:00:46] [config] data-weighting: ""
[2023-07-05 13:00:46] [config] data-weighting-type: sentence
[2023-07-05 13:00:46] [config] dec-cell: gru
[2023-07-05 13:00:46] [config] dec-cell-base-depth: 2
[2023-07-05 13:00:46] [config] dec-cell-high-depth: 1
[2023-07-05 13:00:46] [config] dec-depth: 1
[2023-07-05 13:00:46] [config] devices:
[2023-07-05 13:00:46] [config]   - 0
[2023-07-05 13:00:46] [config] dim-emb: 512
[2023-07-05 13:00:46] [config] dim-rnn: 1024
[2023-07-05 13:00:46] [config] dim-vocabs:
[2023-07-05 13:00:46] [config]   - 36507
[2023-07-05 13:00:46] [config]   - 54042
[2023-07-05 13:00:46] [config] disp-first: 0
[2023-07-05 13:00:46] [config] disp-freq: 1000u
[2023-07-05 13:00:46] [config] disp-label-counts: true
[2023-07-05 13:00:46] [config] dropout-rnn: 0
[2023-07-05 13:00:46] [config] dropout-src: 0
[2023-07-05 13:00:46] [config] dropout-trg: 0
[2023-07-05 13:00:46] [config] dump-config: ""
[2023-07-05 13:00:46] [config] dynamic-gradient-scaling:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] early-stopping: 10
[2023-07-05 13:00:46] [config] early-stopping-on: first
[2023-07-05 13:00:46] [config] embedding-fix-src: false
[2023-07-05 13:00:46] [config] embedding-fix-trg: false
[2023-07-05 13:00:46] [config] embedding-normalization: false
[2023-07-05 13:00:46] [config] embedding-vectors:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] enc-cell: gru
[2023-07-05 13:00:46] [config] enc-cell-depth: 1
[2023-07-05 13:00:46] [config] enc-depth: 1
[2023-07-05 13:00:46] [config] enc-type: bidirectional
[2023-07-05 13:00:46] [config] english-title-case-every: 0
[2023-07-05 13:00:46] [config] exponential-smoothing: 0
[2023-07-05 13:00:46] [config] factor-weight: 1
[2023-07-05 13:00:46] [config] factors-combine: sum
[2023-07-05 13:00:46] [config] factors-dim-emb: 0
[2023-07-05 13:00:46] [config] gradient-checkpointing: false
[2023-07-05 13:00:46] [config] gradient-norm-average-window: 100
[2023-07-05 13:00:46] [config] guided-alignment: none
[2023-07-05 13:00:46] [config] guided-alignment-cost: mse
[2023-07-05 13:00:46] [config] guided-alignment-weight: 0.1
[2023-07-05 13:00:46] [config] ignore-model-config: false
[2023-07-05 13:00:46] [config] input-types:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] interpolate-env-vars: false
[2023-07-05 13:00:46] [config] keep-best: false
[2023-07-05 13:00:46] [config] label-smoothing: 0
[2023-07-05 13:00:46] [config] layer-normalization: false
[2023-07-05 13:00:46] [config] learn-rate: 0.0001
[2023-07-05 13:00:46] [config] lemma-dependency: ""
[2023-07-05 13:00:46] [config] lemma-dim-emb: 0
[2023-07-05 13:00:46] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:00:46] [config] log-level: info
[2023-07-05 13:00:46] [config] log-time-zone: ""
[2023-07-05 13:00:46] [config] logical-epoch:
[2023-07-05 13:00:46] [config]   - 1e
[2023-07-05 13:00:46] [config]   - 0
[2023-07-05 13:00:46] [config] lr-decay: 0
[2023-07-05 13:00:46] [config] lr-decay-freq: 50000
[2023-07-05 13:00:46] [config] lr-decay-inv-sqrt:
[2023-07-05 13:00:46] [config]   - 0
[2023-07-05 13:00:46] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:00:46] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:00:46] [config] lr-decay-start:
[2023-07-05 13:00:46] [config]   - 10
[2023-07-05 13:00:46] [config]   - 1
[2023-07-05 13:00:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:00:46] [config] lr-report: false
[2023-07-05 13:00:46] [config] lr-warmup: 0
[2023-07-05 13:00:46] [config] lr-warmup-at-reload: false
[2023-07-05 13:00:46] [config] lr-warmup-cycle: false
[2023-07-05 13:00:46] [config] lr-warmup-start-rate: 0
[2023-07-05 13:00:46] [config] max-length: 50
[2023-07-05 13:00:46] [config] max-length-crop: false
[2023-07-05 13:00:46] [config] max-length-factor: 3
[2023-07-05 13:00:46] [config] maxi-batch: 100
[2023-07-05 13:00:46] [config] maxi-batch-sort: trg
[2023-07-05 13:00:46] [config] mini-batch: 64
[2023-07-05 13:00:46] [config] mini-batch-fit: false
[2023-07-05 13:00:46] [config] mini-batch-fit-step: 10
[2023-07-05 13:00:46] [config] mini-batch-round-up: true
[2023-07-05 13:00:46] [config] mini-batch-track-lr: false
[2023-07-05 13:00:46] [config] mini-batch-warmup: 0
[2023-07-05 13:00:46] [config] mini-batch-words: 0
[2023-07-05 13:00:46] [config] mini-batch-words-ref: 0
[2023-07-05 13:00:46] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:00:46] [config] multi-loss-type: sum
[2023-07-05 13:00:46] [config] n-best: false
[2023-07-05 13:00:46] [config] no-nccl: false
[2023-07-05 13:00:46] [config] no-reload: false
[2023-07-05 13:00:46] [config] no-restore-corpus: false
[2023-07-05 13:00:46] [config] normalize: 0
[2023-07-05 13:00:46] [config] normalize-gradient: false
[2023-07-05 13:00:46] [config] num-devices: 0
[2023-07-05 13:00:46] [config] optimizer: adam
[2023-07-05 13:00:46] [config] optimizer-delay: 1
[2023-07-05 13:00:46] [config] optimizer-params:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] output-omit-bias: false
[2023-07-05 13:00:46] [config] overwrite: true
[2023-07-05 13:00:46] [config] precision:
[2023-07-05 13:00:46] [config]   - float32
[2023-07-05 13:00:46] [config]   - float32
[2023-07-05 13:00:46] [config] pretrained-model: ""
[2023-07-05 13:00:46] [config] quantize-biases: false
[2023-07-05 13:00:46] [config] quantize-bits: 0
[2023-07-05 13:00:46] [config] quantize-log-based: false
[2023-07-05 13:00:46] [config] quantize-optimization-steps: 0
[2023-07-05 13:00:46] [config] quiet: false
[2023-07-05 13:00:46] [config] quiet-translation: true
[2023-07-05 13:00:46] [config] relative-paths: false
[2023-07-05 13:00:46] [config] right-left: false
[2023-07-05 13:00:46] [config] save-freq: 10000u
[2023-07-05 13:00:46] [config] seed: 1234
[2023-07-05 13:00:46] [config] sentencepiece-alphas:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:00:46] [config] sentencepiece-options: ""
[2023-07-05 13:00:46] [config] sharding: global
[2023-07-05 13:00:46] [config] shuffle: data
[2023-07-05 13:00:46] [config] shuffle-in-ram: false
[2023-07-05 13:00:46] [config] sigterm: save-and-exit
[2023-07-05 13:00:46] [config] skip: false
[2023-07-05 13:00:46] [config] sqlite: ""
[2023-07-05 13:00:46] [config] sqlite-drop: false
[2023-07-05 13:00:46] [config] sync-freq: 200u
[2023-07-05 13:00:46] [config] sync-sgd: false
[2023-07-05 13:00:46] [config] tempdir: /tmp
[2023-07-05 13:00:46] [config] tied-embeddings: false
[2023-07-05 13:00:46] [config] tied-embeddings-all: false
[2023-07-05 13:00:46] [config] tied-embeddings-src: false
[2023-07-05 13:00:46] [config] train-embedder-rank:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] train-sets:
[2023-07-05 13:00:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:00:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:00:46] [config] transformer-aan-activation: swish
[2023-07-05 13:00:46] [config] transformer-aan-depth: 2
[2023-07-05 13:00:46] [config] transformer-aan-nogate: false
[2023-07-05 13:00:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:00:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:00:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:00:46] [config] transformer-depth-scaling: false
[2023-07-05 13:00:46] [config] transformer-dim-aan: 2048
[2023-07-05 13:00:46] [config] transformer-dim-ffn: 2048
[2023-07-05 13:00:46] [config] transformer-dropout: 0
[2023-07-05 13:00:46] [config] transformer-dropout-attention: 0
[2023-07-05 13:00:46] [config] transformer-dropout-ffn: 0
[2023-07-05 13:00:46] [config] transformer-ffn-activation: swish
[2023-07-05 13:00:46] [config] transformer-ffn-depth: 2
[2023-07-05 13:00:46] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:00:46] [config] transformer-heads: 8
[2023-07-05 13:00:46] [config] transformer-no-projection: false
[2023-07-05 13:00:46] [config] transformer-pool: false
[2023-07-05 13:00:46] [config] transformer-postprocess: dan
[2023-07-05 13:00:46] [config] transformer-postprocess-emb: d
[2023-07-05 13:00:46] [config] transformer-postprocess-top: ""
[2023-07-05 13:00:46] [config] transformer-preprocess: ""
[2023-07-05 13:00:46] [config] transformer-tied-layers:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] transformer-train-position-embeddings: false
[2023-07-05 13:00:46] [config] tsv: false
[2023-07-05 13:00:46] [config] tsv-fields: 0
[2023-07-05 13:00:46] [config] type: amun
[2023-07-05 13:00:46] [config] ulr: false
[2023-07-05 13:00:46] [config] ulr-dim-emb: 0
[2023-07-05 13:00:46] [config] ulr-dropout: 0
[2023-07-05 13:00:46] [config] ulr-keys-vectors: ""
[2023-07-05 13:00:46] [config] ulr-query-vectors: ""
[2023-07-05 13:00:46] [config] ulr-softmax-temperature: 1
[2023-07-05 13:00:46] [config] ulr-trainable-transformation: false
[2023-07-05 13:00:46] [config] unlikelihood-loss: false
[2023-07-05 13:00:46] [config] valid-freq: 50000000
[2023-07-05 13:00:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:00:46] [config] valid-max-length: 1000
[2023-07-05 13:00:46] [config] valid-metrics:
[2023-07-05 13:00:46] [config]   - cross-entropy
[2023-07-05 13:00:46] [config]   - translation
[2023-07-05 13:00:46] [config] valid-mini-batch: 32
[2023-07-05 13:00:46] [config] valid-reset-stalled: false
[2023-07-05 13:00:46] [config] valid-script-args:
[2023-07-05 13:00:46] [config]   []
[2023-07-05 13:00:46] [config] valid-script-path: ""
[2023-07-05 13:00:46] [config] valid-sets:
[2023-07-05 13:00:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:00:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:00:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:00:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:00:46] [config] vocabs:
[2023-07-05 13:00:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:00:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:00:46] [config] word-penalty: 0
[2023-07-05 13:00:46] [config] word-scores: false
[2023-07-05 13:00:46] [config] workspace: 2048
[2023-07-05 13:00:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:00:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:00:46] [training] Using single-device training
[2023-07-05 13:00:48] Synced seed 1234
[2023-07-05 13:00:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:00:48] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:00:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:00:48] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:00:48] [valid] No post-processing script given for validating translator
[2023-07-05 13:00:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:00:49] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:00:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:00:49] [comm] Using global sharding
[2023-07-05 13:00:49] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:00:49] [training] Using 1 GPUs
[2023-07-05 13:00:49] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:00:52] Loading Adam parameters
[2023-07-05 13:00:52] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:00:52] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:00:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:00:53] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-07-05 13:00:53] [data] Shuffling data
[2023-07-05 13:00:53] [data] Done reading 20,192 sentences
[2023-07-05 13:00:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:00:53] Training started
[2023-07-05 13:00:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 13:00:53] [logits] Applying loss function for 1 factor(s)
[2023-07-05 13:00:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 13:00:53] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:00:53] Parameter type float32, optimization type float32, casting types false
[2023-07-05 13:01:45] Seen 18,843 samples
[2023-07-05 13:01:45] Starting data epoch 102 in logical epoch 102
[2023-07-05 13:01:45] [data] Shuffling data
[2023-07-05 13:01:45] [data] Done reading 20,192 sentences
[2023-07-05 13:01:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:01:54] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.04350853 * 931,515 @ 1,519 after 27,954,966 : Time 66.48s : 14012.78 words/s : gNorm 0.3367
[2023-07-05 13:01:54] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:02:01] Saving Adam parameters
[2023-07-05 13:02:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:03:02] Seen 18,843 samples
[2023-07-05 13:03:02] Starting data epoch 103 in logical epoch 103
[2023-07-05 13:03:02] [data] Shuffling data
[2023-07-05 13:03:02] [data] Done reading 20,192 sentences
[2023-07-05 13:03:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:04:14] Seen 18,843 samples
[2023-07-05 13:04:14] Starting data epoch 104 in logical epoch 104
[2023-07-05 13:04:14] [data] Shuffling data
[2023-07-05 13:04:14] [data] Done reading 20,192 sentences
[2023-07-05 13:04:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:05:20] Seen 18,843 samples
[2023-07-05 13:05:20] Starting data epoch 105 in logical epoch 105
[2023-07-05 13:05:20] [data] Shuffling data
[2023-07-05 13:05:20] [data] Done reading 20,192 sentences
[2023-07-05 13:05:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:05:56] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.03486980 * 932,338 @ 1,024 after 28,887,304 : Time 241.31s : 3863.73 words/s : gNorm 0.3308
[2023-07-05 13:06:27] Seen 18,843 samples
[2023-07-05 13:06:27] Starting data epoch 106 in logical epoch 106
[2023-07-05 13:06:27] [data] Shuffling data
[2023-07-05 13:06:27] [data] Done reading 20,192 sentences
[2023-07-05 13:06:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:07:32] Seen 18,843 samples
[2023-07-05 13:07:32] Starting data epoch 107 in logical epoch 107
[2023-07-05 13:07:32] [data] Shuffling data
[2023-07-05 13:07:32] [data] Done reading 20,192 sentences
[2023-07-05 13:07:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:08:43] Seen 18,843 samples
[2023-07-05 13:08:43] Starting data epoch 108 in logical epoch 108
[2023-07-05 13:08:43] [data] Shuffling data
[2023-07-05 13:08:43] [data] Done reading 20,192 sentences
[2023-07-05 13:08:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:09:45] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.02854458 * 924,374 @ 640 after 29,811,678 : Time 229.38s : 4029.82 words/s : gNorm 0.2503
[2023-07-05 13:09:55] Seen 18,843 samples
[2023-07-05 13:09:55] Starting data epoch 109 in logical epoch 109
[2023-07-05 13:09:55] [data] Shuffling data
[2023-07-05 13:09:55] [data] Done reading 20,192 sentences
[2023-07-05 13:09:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:11:04] Seen 18,843 samples
[2023-07-05 13:11:04] Starting data epoch 110 in logical epoch 110
[2023-07-05 13:11:04] [data] Shuffling data
[2023-07-05 13:11:04] [data] Done reading 20,192 sentences
[2023-07-05 13:11:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:12:12] Seen 18,843 samples
[2023-07-05 13:12:12] Starting data epoch 111 in logical epoch 111
[2023-07-05 13:12:12] Training finished
[2023-07-05 13:12:21] [valid] Ep. 111 : Up. 32628 : cross-entropy : 143.974 : stalled 10 times (last best: 87.4293)
[2023-07-05 13:14:13] [valid] Ep. 111 : Up. 32628 : translation : 0 : new best
[2023-07-05 13:14:13] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:14:19] Saving Adam parameters
[2023-07-05 13:14:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:14:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:37] [marian] Running on node22.datos.cluster.uy as process 19862 with command line:
[2023-07-05 13:14:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:14:37] [config] after: 0e
[2023-07-05 13:14:37] [config] after-batches: 0
[2023-07-05 13:14:37] [config] after-epochs: 120
[2023-07-05 13:14:37] [config] all-caps-every: 0
[2023-07-05 13:14:37] [config] allow-unk: false
[2023-07-05 13:14:37] [config] authors: false
[2023-07-05 13:14:37] [config] beam-size: 12
[2023-07-05 13:14:37] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:14:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:14:37] [config] bert-masking-fraction: 0.15
[2023-07-05 13:14:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:14:37] [config] bert-train-type-embeddings: true
[2023-07-05 13:14:37] [config] bert-type-vocab-size: 2
[2023-07-05 13:14:37] [config] build-info: ""
[2023-07-05 13:14:37] [config] check-gradient-nan: false
[2023-07-05 13:14:37] [config] check-nan: false
[2023-07-05 13:14:37] [config] cite: false
[2023-07-05 13:14:37] [config] clip-norm: 1
[2023-07-05 13:14:37] [config] cost-scaling:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] cost-type: ce-sum
[2023-07-05 13:14:37] [config] cpu-threads: 0
[2023-07-05 13:14:37] [config] data-threads: 8
[2023-07-05 13:14:37] [config] data-weighting: ""
[2023-07-05 13:14:37] [config] data-weighting-type: sentence
[2023-07-05 13:14:37] [config] dec-cell: gru
[2023-07-05 13:14:37] [config] dec-cell-base-depth: 2
[2023-07-05 13:14:37] [config] dec-cell-high-depth: 1
[2023-07-05 13:14:37] [config] dec-depth: 1
[2023-07-05 13:14:37] [config] devices:
[2023-07-05 13:14:37] [config]   - 0
[2023-07-05 13:14:37] [config] dim-emb: 512
[2023-07-05 13:14:37] [config] dim-rnn: 1024
[2023-07-05 13:14:37] [config] dim-vocabs:
[2023-07-05 13:14:37] [config]   - 36507
[2023-07-05 13:14:37] [config]   - 54042
[2023-07-05 13:14:37] [config] disp-first: 0
[2023-07-05 13:14:37] [config] disp-freq: 1000u
[2023-07-05 13:14:37] [config] disp-label-counts: true
[2023-07-05 13:14:37] [config] dropout-rnn: 0
[2023-07-05 13:14:37] [config] dropout-src: 0
[2023-07-05 13:14:37] [config] dropout-trg: 0
[2023-07-05 13:14:37] [config] dump-config: ""
[2023-07-05 13:14:37] [config] dynamic-gradient-scaling:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] early-stopping: 10
[2023-07-05 13:14:37] [config] early-stopping-on: first
[2023-07-05 13:14:37] [config] embedding-fix-src: false
[2023-07-05 13:14:37] [config] embedding-fix-trg: false
[2023-07-05 13:14:37] [config] embedding-normalization: false
[2023-07-05 13:14:37] [config] embedding-vectors:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] enc-cell: gru
[2023-07-05 13:14:37] [config] enc-cell-depth: 1
[2023-07-05 13:14:37] [config] enc-depth: 1
[2023-07-05 13:14:37] [config] enc-type: bidirectional
[2023-07-05 13:14:37] [config] english-title-case-every: 0
[2023-07-05 13:14:37] [config] exponential-smoothing: 0
[2023-07-05 13:14:37] [config] factor-weight: 1
[2023-07-05 13:14:37] [config] factors-combine: sum
[2023-07-05 13:14:37] [config] factors-dim-emb: 0
[2023-07-05 13:14:37] [config] gradient-checkpointing: false
[2023-07-05 13:14:37] [config] gradient-norm-average-window: 100
[2023-07-05 13:14:37] [config] guided-alignment: none
[2023-07-05 13:14:37] [config] guided-alignment-cost: mse
[2023-07-05 13:14:37] [config] guided-alignment-weight: 0.1
[2023-07-05 13:14:37] [config] ignore-model-config: false
[2023-07-05 13:14:37] [config] input-types:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] interpolate-env-vars: false
[2023-07-05 13:14:37] [config] keep-best: false
[2023-07-05 13:14:37] [config] label-smoothing: 0
[2023-07-05 13:14:37] [config] layer-normalization: false
[2023-07-05 13:14:37] [config] learn-rate: 0.0001
[2023-07-05 13:14:37] [config] lemma-dependency: ""
[2023-07-05 13:14:37] [config] lemma-dim-emb: 0
[2023-07-05 13:14:37] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:14:37] [config] log-level: info
[2023-07-05 13:14:37] [config] log-time-zone: ""
[2023-07-05 13:14:37] [config] logical-epoch:
[2023-07-05 13:14:37] [config]   - 1e
[2023-07-05 13:14:37] [config]   - 0
[2023-07-05 13:14:37] [config] lr-decay: 0
[2023-07-05 13:14:37] [config] lr-decay-freq: 50000
[2023-07-05 13:14:37] [config] lr-decay-inv-sqrt:
[2023-07-05 13:14:37] [config]   - 0
[2023-07-05 13:14:37] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:14:37] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:14:37] [config] lr-decay-start:
[2023-07-05 13:14:37] [config]   - 10
[2023-07-05 13:14:37] [config]   - 1
[2023-07-05 13:14:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:14:37] [config] lr-report: false
[2023-07-05 13:14:37] [config] lr-warmup: 0
[2023-07-05 13:14:37] [config] lr-warmup-at-reload: false
[2023-07-05 13:14:37] [config] lr-warmup-cycle: false
[2023-07-05 13:14:37] [config] lr-warmup-start-rate: 0
[2023-07-05 13:14:37] [config] max-length: 50
[2023-07-05 13:14:37] [config] max-length-crop: false
[2023-07-05 13:14:37] [config] max-length-factor: 3
[2023-07-05 13:14:37] [config] maxi-batch: 100
[2023-07-05 13:14:37] [config] maxi-batch-sort: trg
[2023-07-05 13:14:37] [config] mini-batch: 64
[2023-07-05 13:14:37] [config] mini-batch-fit: false
[2023-07-05 13:14:37] [config] mini-batch-fit-step: 10
[2023-07-05 13:14:37] [config] mini-batch-round-up: true
[2023-07-05 13:14:37] [config] mini-batch-track-lr: false
[2023-07-05 13:14:37] [config] mini-batch-warmup: 0
[2023-07-05 13:14:37] [config] mini-batch-words: 0
[2023-07-05 13:14:37] [config] mini-batch-words-ref: 0
[2023-07-05 13:14:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:14:37] [config] multi-loss-type: sum
[2023-07-05 13:14:37] [config] n-best: false
[2023-07-05 13:14:37] [config] no-nccl: false
[2023-07-05 13:14:37] [config] no-reload: false
[2023-07-05 13:14:37] [config] no-restore-corpus: false
[2023-07-05 13:14:37] [config] normalize: 0
[2023-07-05 13:14:37] [config] normalize-gradient: false
[2023-07-05 13:14:37] [config] num-devices: 0
[2023-07-05 13:14:37] [config] optimizer: adam
[2023-07-05 13:14:37] [config] optimizer-delay: 1
[2023-07-05 13:14:37] [config] optimizer-params:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] output-omit-bias: false
[2023-07-05 13:14:37] [config] overwrite: true
[2023-07-05 13:14:37] [config] precision:
[2023-07-05 13:14:37] [config]   - float32
[2023-07-05 13:14:37] [config]   - float32
[2023-07-05 13:14:37] [config] pretrained-model: ""
[2023-07-05 13:14:37] [config] quantize-biases: false
[2023-07-05 13:14:37] [config] quantize-bits: 0
[2023-07-05 13:14:37] [config] quantize-log-based: false
[2023-07-05 13:14:37] [config] quantize-optimization-steps: 0
[2023-07-05 13:14:37] [config] quiet: false
[2023-07-05 13:14:37] [config] quiet-translation: true
[2023-07-05 13:14:37] [config] relative-paths: false
[2023-07-05 13:14:37] [config] right-left: false
[2023-07-05 13:14:37] [config] save-freq: 10000u
[2023-07-05 13:14:37] [config] seed: 1234
[2023-07-05 13:14:37] [config] sentencepiece-alphas:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:14:37] [config] sentencepiece-options: ""
[2023-07-05 13:14:37] [config] sharding: global
[2023-07-05 13:14:37] [config] shuffle: data
[2023-07-05 13:14:37] [config] shuffle-in-ram: false
[2023-07-05 13:14:37] [config] sigterm: save-and-exit
[2023-07-05 13:14:37] [config] skip: false
[2023-07-05 13:14:37] [config] sqlite: ""
[2023-07-05 13:14:37] [config] sqlite-drop: false
[2023-07-05 13:14:37] [config] sync-freq: 200u
[2023-07-05 13:14:37] [config] sync-sgd: false
[2023-07-05 13:14:37] [config] tempdir: /tmp
[2023-07-05 13:14:37] [config] tied-embeddings: false
[2023-07-05 13:14:37] [config] tied-embeddings-all: false
[2023-07-05 13:14:37] [config] tied-embeddings-src: false
[2023-07-05 13:14:37] [config] train-embedder-rank:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] train-sets:
[2023-07-05 13:14:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:14:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:14:37] [config] transformer-aan-activation: swish
[2023-07-05 13:14:37] [config] transformer-aan-depth: 2
[2023-07-05 13:14:37] [config] transformer-aan-nogate: false
[2023-07-05 13:14:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:14:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:14:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:14:37] [config] transformer-depth-scaling: false
[2023-07-05 13:14:37] [config] transformer-dim-aan: 2048
[2023-07-05 13:14:37] [config] transformer-dim-ffn: 2048
[2023-07-05 13:14:37] [config] transformer-dropout: 0
[2023-07-05 13:14:37] [config] transformer-dropout-attention: 0
[2023-07-05 13:14:37] [config] transformer-dropout-ffn: 0
[2023-07-05 13:14:37] [config] transformer-ffn-activation: swish
[2023-07-05 13:14:37] [config] transformer-ffn-depth: 2
[2023-07-05 13:14:37] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:14:37] [config] transformer-heads: 8
[2023-07-05 13:14:37] [config] transformer-no-projection: false
[2023-07-05 13:14:37] [config] transformer-pool: false
[2023-07-05 13:14:37] [config] transformer-postprocess: dan
[2023-07-05 13:14:37] [config] transformer-postprocess-emb: d
[2023-07-05 13:14:37] [config] transformer-postprocess-top: ""
[2023-07-05 13:14:37] [config] transformer-preprocess: ""
[2023-07-05 13:14:37] [config] transformer-tied-layers:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] transformer-train-position-embeddings: false
[2023-07-05 13:14:37] [config] tsv: false
[2023-07-05 13:14:37] [config] tsv-fields: 0
[2023-07-05 13:14:37] [config] type: amun
[2023-07-05 13:14:37] [config] ulr: false
[2023-07-05 13:14:37] [config] ulr-dim-emb: 0
[2023-07-05 13:14:37] [config] ulr-dropout: 0
[2023-07-05 13:14:37] [config] ulr-keys-vectors: ""
[2023-07-05 13:14:37] [config] ulr-query-vectors: ""
[2023-07-05 13:14:37] [config] ulr-softmax-temperature: 1
[2023-07-05 13:14:37] [config] ulr-trainable-transformation: false
[2023-07-05 13:14:37] [config] unlikelihood-loss: false
[2023-07-05 13:14:37] [config] valid-freq: 50000000
[2023-07-05 13:14:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:14:37] [config] valid-max-length: 1000
[2023-07-05 13:14:37] [config] valid-metrics:
[2023-07-05 13:14:37] [config]   - cross-entropy
[2023-07-05 13:14:37] [config]   - translation
[2023-07-05 13:14:37] [config] valid-mini-batch: 32
[2023-07-05 13:14:37] [config] valid-reset-stalled: false
[2023-07-05 13:14:37] [config] valid-script-args:
[2023-07-05 13:14:37] [config]   []
[2023-07-05 13:14:37] [config] valid-script-path: ""
[2023-07-05 13:14:37] [config] valid-sets:
[2023-07-05 13:14:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:14:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:14:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:14:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:37] [config] vocabs:
[2023-07-05 13:14:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:14:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:14:37] [config] word-penalty: 0
[2023-07-05 13:14:37] [config] word-scores: false
[2023-07-05 13:14:37] [config] workspace: 2048
[2023-07-05 13:14:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:14:37] [training] Using single-device training
[2023-07-05 13:14:37] Synced seed 1234
[2023-07-05 13:14:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:14:37] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:14:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:14:37] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:14:37] [valid] No post-processing script given for validating translator
[2023-07-05 13:14:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:14:39] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:14:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:14:39] [comm] Using global sharding
[2023-07-05 13:14:39] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:14:39] [training] Using 1 GPUs
[2023-07-05 13:14:39] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:14:42] Loading Adam parameters
[2023-07-05 13:14:42] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:14:42] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:14:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:14:43] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:14:43] [data] Shuffling data
[2023-07-05 13:14:43] [data] Done reading 20,192 sentences
[2023-07-05 13:14:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:14:43] Training started
[2023-07-05 13:14:43] Training finished
[2023-07-05 13:14:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:46] [marian] Running on node22.datos.cluster.uy as process 20049 with command line:
[2023-07-05 13:14:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:14:46] [config] after: 0e
[2023-07-05 13:14:46] [config] after-batches: 0
[2023-07-05 13:14:46] [config] after-epochs: 130
[2023-07-05 13:14:46] [config] all-caps-every: 0
[2023-07-05 13:14:46] [config] allow-unk: false
[2023-07-05 13:14:46] [config] authors: false
[2023-07-05 13:14:46] [config] beam-size: 12
[2023-07-05 13:14:46] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:14:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:14:46] [config] bert-masking-fraction: 0.15
[2023-07-05 13:14:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:14:46] [config] bert-train-type-embeddings: true
[2023-07-05 13:14:46] [config] bert-type-vocab-size: 2
[2023-07-05 13:14:46] [config] build-info: ""
[2023-07-05 13:14:46] [config] check-gradient-nan: false
[2023-07-05 13:14:46] [config] check-nan: false
[2023-07-05 13:14:46] [config] cite: false
[2023-07-05 13:14:46] [config] clip-norm: 1
[2023-07-05 13:14:46] [config] cost-scaling:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] cost-type: ce-sum
[2023-07-05 13:14:46] [config] cpu-threads: 0
[2023-07-05 13:14:46] [config] data-threads: 8
[2023-07-05 13:14:46] [config] data-weighting: ""
[2023-07-05 13:14:46] [config] data-weighting-type: sentence
[2023-07-05 13:14:46] [config] dec-cell: gru
[2023-07-05 13:14:46] [config] dec-cell-base-depth: 2
[2023-07-05 13:14:46] [config] dec-cell-high-depth: 1
[2023-07-05 13:14:46] [config] dec-depth: 1
[2023-07-05 13:14:46] [config] devices:
[2023-07-05 13:14:46] [config]   - 0
[2023-07-05 13:14:46] [config] dim-emb: 512
[2023-07-05 13:14:46] [config] dim-rnn: 1024
[2023-07-05 13:14:46] [config] dim-vocabs:
[2023-07-05 13:14:46] [config]   - 36507
[2023-07-05 13:14:46] [config]   - 54042
[2023-07-05 13:14:46] [config] disp-first: 0
[2023-07-05 13:14:46] [config] disp-freq: 1000u
[2023-07-05 13:14:46] [config] disp-label-counts: true
[2023-07-05 13:14:46] [config] dropout-rnn: 0
[2023-07-05 13:14:46] [config] dropout-src: 0
[2023-07-05 13:14:46] [config] dropout-trg: 0
[2023-07-05 13:14:46] [config] dump-config: ""
[2023-07-05 13:14:46] [config] dynamic-gradient-scaling:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] early-stopping: 10
[2023-07-05 13:14:46] [config] early-stopping-on: first
[2023-07-05 13:14:46] [config] embedding-fix-src: false
[2023-07-05 13:14:46] [config] embedding-fix-trg: false
[2023-07-05 13:14:46] [config] embedding-normalization: false
[2023-07-05 13:14:46] [config] embedding-vectors:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] enc-cell: gru
[2023-07-05 13:14:46] [config] enc-cell-depth: 1
[2023-07-05 13:14:46] [config] enc-depth: 1
[2023-07-05 13:14:46] [config] enc-type: bidirectional
[2023-07-05 13:14:46] [config] english-title-case-every: 0
[2023-07-05 13:14:46] [config] exponential-smoothing: 0
[2023-07-05 13:14:46] [config] factor-weight: 1
[2023-07-05 13:14:46] [config] factors-combine: sum
[2023-07-05 13:14:46] [config] factors-dim-emb: 0
[2023-07-05 13:14:46] [config] gradient-checkpointing: false
[2023-07-05 13:14:46] [config] gradient-norm-average-window: 100
[2023-07-05 13:14:46] [config] guided-alignment: none
[2023-07-05 13:14:46] [config] guided-alignment-cost: mse
[2023-07-05 13:14:46] [config] guided-alignment-weight: 0.1
[2023-07-05 13:14:46] [config] ignore-model-config: false
[2023-07-05 13:14:46] [config] input-types:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] interpolate-env-vars: false
[2023-07-05 13:14:46] [config] keep-best: false
[2023-07-05 13:14:46] [config] label-smoothing: 0
[2023-07-05 13:14:46] [config] layer-normalization: false
[2023-07-05 13:14:46] [config] learn-rate: 0.0001
[2023-07-05 13:14:46] [config] lemma-dependency: ""
[2023-07-05 13:14:46] [config] lemma-dim-emb: 0
[2023-07-05 13:14:46] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:14:46] [config] log-level: info
[2023-07-05 13:14:46] [config] log-time-zone: ""
[2023-07-05 13:14:46] [config] logical-epoch:
[2023-07-05 13:14:46] [config]   - 1e
[2023-07-05 13:14:46] [config]   - 0
[2023-07-05 13:14:46] [config] lr-decay: 0
[2023-07-05 13:14:46] [config] lr-decay-freq: 50000
[2023-07-05 13:14:46] [config] lr-decay-inv-sqrt:
[2023-07-05 13:14:46] [config]   - 0
[2023-07-05 13:14:46] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:14:46] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:14:46] [config] lr-decay-start:
[2023-07-05 13:14:46] [config]   - 10
[2023-07-05 13:14:46] [config]   - 1
[2023-07-05 13:14:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:14:46] [config] lr-report: false
[2023-07-05 13:14:46] [config] lr-warmup: 0
[2023-07-05 13:14:46] [config] lr-warmup-at-reload: false
[2023-07-05 13:14:46] [config] lr-warmup-cycle: false
[2023-07-05 13:14:46] [config] lr-warmup-start-rate: 0
[2023-07-05 13:14:46] [config] max-length: 50
[2023-07-05 13:14:46] [config] max-length-crop: false
[2023-07-05 13:14:46] [config] max-length-factor: 3
[2023-07-05 13:14:46] [config] maxi-batch: 100
[2023-07-05 13:14:46] [config] maxi-batch-sort: trg
[2023-07-05 13:14:46] [config] mini-batch: 64
[2023-07-05 13:14:46] [config] mini-batch-fit: false
[2023-07-05 13:14:46] [config] mini-batch-fit-step: 10
[2023-07-05 13:14:46] [config] mini-batch-round-up: true
[2023-07-05 13:14:46] [config] mini-batch-track-lr: false
[2023-07-05 13:14:46] [config] mini-batch-warmup: 0
[2023-07-05 13:14:46] [config] mini-batch-words: 0
[2023-07-05 13:14:46] [config] mini-batch-words-ref: 0
[2023-07-05 13:14:46] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:14:46] [config] multi-loss-type: sum
[2023-07-05 13:14:46] [config] n-best: false
[2023-07-05 13:14:46] [config] no-nccl: false
[2023-07-05 13:14:46] [config] no-reload: false
[2023-07-05 13:14:46] [config] no-restore-corpus: false
[2023-07-05 13:14:46] [config] normalize: 0
[2023-07-05 13:14:46] [config] normalize-gradient: false
[2023-07-05 13:14:46] [config] num-devices: 0
[2023-07-05 13:14:46] [config] optimizer: adam
[2023-07-05 13:14:46] [config] optimizer-delay: 1
[2023-07-05 13:14:46] [config] optimizer-params:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] output-omit-bias: false
[2023-07-05 13:14:46] [config] overwrite: true
[2023-07-05 13:14:46] [config] precision:
[2023-07-05 13:14:46] [config]   - float32
[2023-07-05 13:14:46] [config]   - float32
[2023-07-05 13:14:46] [config] pretrained-model: ""
[2023-07-05 13:14:46] [config] quantize-biases: false
[2023-07-05 13:14:46] [config] quantize-bits: 0
[2023-07-05 13:14:46] [config] quantize-log-based: false
[2023-07-05 13:14:46] [config] quantize-optimization-steps: 0
[2023-07-05 13:14:46] [config] quiet: false
[2023-07-05 13:14:46] [config] quiet-translation: true
[2023-07-05 13:14:46] [config] relative-paths: false
[2023-07-05 13:14:46] [config] right-left: false
[2023-07-05 13:14:46] [config] save-freq: 10000u
[2023-07-05 13:14:46] [config] seed: 1234
[2023-07-05 13:14:46] [config] sentencepiece-alphas:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:14:46] [config] sentencepiece-options: ""
[2023-07-05 13:14:46] [config] sharding: global
[2023-07-05 13:14:46] [config] shuffle: data
[2023-07-05 13:14:46] [config] shuffle-in-ram: false
[2023-07-05 13:14:46] [config] sigterm: save-and-exit
[2023-07-05 13:14:46] [config] skip: false
[2023-07-05 13:14:46] [config] sqlite: ""
[2023-07-05 13:14:46] [config] sqlite-drop: false
[2023-07-05 13:14:46] [config] sync-freq: 200u
[2023-07-05 13:14:46] [config] sync-sgd: false
[2023-07-05 13:14:46] [config] tempdir: /tmp
[2023-07-05 13:14:46] [config] tied-embeddings: false
[2023-07-05 13:14:46] [config] tied-embeddings-all: false
[2023-07-05 13:14:46] [config] tied-embeddings-src: false
[2023-07-05 13:14:46] [config] train-embedder-rank:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] train-sets:
[2023-07-05 13:14:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:14:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:14:46] [config] transformer-aan-activation: swish
[2023-07-05 13:14:46] [config] transformer-aan-depth: 2
[2023-07-05 13:14:46] [config] transformer-aan-nogate: false
[2023-07-05 13:14:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:14:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:14:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:14:46] [config] transformer-depth-scaling: false
[2023-07-05 13:14:46] [config] transformer-dim-aan: 2048
[2023-07-05 13:14:46] [config] transformer-dim-ffn: 2048
[2023-07-05 13:14:46] [config] transformer-dropout: 0
[2023-07-05 13:14:46] [config] transformer-dropout-attention: 0
[2023-07-05 13:14:46] [config] transformer-dropout-ffn: 0
[2023-07-05 13:14:46] [config] transformer-ffn-activation: swish
[2023-07-05 13:14:46] [config] transformer-ffn-depth: 2
[2023-07-05 13:14:46] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:14:46] [config] transformer-heads: 8
[2023-07-05 13:14:46] [config] transformer-no-projection: false
[2023-07-05 13:14:46] [config] transformer-pool: false
[2023-07-05 13:14:46] [config] transformer-postprocess: dan
[2023-07-05 13:14:46] [config] transformer-postprocess-emb: d
[2023-07-05 13:14:46] [config] transformer-postprocess-top: ""
[2023-07-05 13:14:46] [config] transformer-preprocess: ""
[2023-07-05 13:14:46] [config] transformer-tied-layers:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] transformer-train-position-embeddings: false
[2023-07-05 13:14:46] [config] tsv: false
[2023-07-05 13:14:46] [config] tsv-fields: 0
[2023-07-05 13:14:46] [config] type: amun
[2023-07-05 13:14:46] [config] ulr: false
[2023-07-05 13:14:46] [config] ulr-dim-emb: 0
[2023-07-05 13:14:46] [config] ulr-dropout: 0
[2023-07-05 13:14:46] [config] ulr-keys-vectors: ""
[2023-07-05 13:14:46] [config] ulr-query-vectors: ""
[2023-07-05 13:14:46] [config] ulr-softmax-temperature: 1
[2023-07-05 13:14:46] [config] ulr-trainable-transformation: false
[2023-07-05 13:14:46] [config] unlikelihood-loss: false
[2023-07-05 13:14:46] [config] valid-freq: 50000000
[2023-07-05 13:14:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:14:46] [config] valid-max-length: 1000
[2023-07-05 13:14:46] [config] valid-metrics:
[2023-07-05 13:14:46] [config]   - cross-entropy
[2023-07-05 13:14:46] [config]   - translation
[2023-07-05 13:14:46] [config] valid-mini-batch: 32
[2023-07-05 13:14:46] [config] valid-reset-stalled: false
[2023-07-05 13:14:46] [config] valid-script-args:
[2023-07-05 13:14:46] [config]   []
[2023-07-05 13:14:46] [config] valid-script-path: ""
[2023-07-05 13:14:46] [config] valid-sets:
[2023-07-05 13:14:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:14:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:14:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:14:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:46] [config] vocabs:
[2023-07-05 13:14:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:14:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:14:46] [config] word-penalty: 0
[2023-07-05 13:14:46] [config] word-scores: false
[2023-07-05 13:14:46] [config] workspace: 2048
[2023-07-05 13:14:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:14:46] [training] Using single-device training
[2023-07-05 13:14:47] Synced seed 1234
[2023-07-05 13:14:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:14:47] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:14:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:14:47] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:14:47] [valid] No post-processing script given for validating translator
[2023-07-05 13:14:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:14:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:14:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:14:48] [comm] Using global sharding
[2023-07-05 13:14:48] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:14:48] [training] Using 1 GPUs
[2023-07-05 13:14:48] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:14:50] Loading Adam parameters
[2023-07-05 13:14:50] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:14:51] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:14:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:14:51] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:14:51] [data] Shuffling data
[2023-07-05 13:14:51] [data] Done reading 20,192 sentences
[2023-07-05 13:14:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:14:51] Training started
[2023-07-05 13:14:51] Training finished
[2023-07-05 13:14:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:54] [marian] Running on node22.datos.cluster.uy as process 20205 with command line:
[2023-07-05 13:14:54] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:14:54] [config] after: 0e
[2023-07-05 13:14:54] [config] after-batches: 0
[2023-07-05 13:14:54] [config] after-epochs: 140
[2023-07-05 13:14:54] [config] all-caps-every: 0
[2023-07-05 13:14:54] [config] allow-unk: false
[2023-07-05 13:14:54] [config] authors: false
[2023-07-05 13:14:54] [config] beam-size: 12
[2023-07-05 13:14:54] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:14:54] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:14:54] [config] bert-masking-fraction: 0.15
[2023-07-05 13:14:54] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:14:54] [config] bert-train-type-embeddings: true
[2023-07-05 13:14:54] [config] bert-type-vocab-size: 2
[2023-07-05 13:14:54] [config] build-info: ""
[2023-07-05 13:14:54] [config] check-gradient-nan: false
[2023-07-05 13:14:54] [config] check-nan: false
[2023-07-05 13:14:54] [config] cite: false
[2023-07-05 13:14:54] [config] clip-norm: 1
[2023-07-05 13:14:54] [config] cost-scaling:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] cost-type: ce-sum
[2023-07-05 13:14:54] [config] cpu-threads: 0
[2023-07-05 13:14:54] [config] data-threads: 8
[2023-07-05 13:14:54] [config] data-weighting: ""
[2023-07-05 13:14:54] [config] data-weighting-type: sentence
[2023-07-05 13:14:54] [config] dec-cell: gru
[2023-07-05 13:14:54] [config] dec-cell-base-depth: 2
[2023-07-05 13:14:54] [config] dec-cell-high-depth: 1
[2023-07-05 13:14:54] [config] dec-depth: 1
[2023-07-05 13:14:54] [config] devices:
[2023-07-05 13:14:54] [config]   - 0
[2023-07-05 13:14:54] [config] dim-emb: 512
[2023-07-05 13:14:54] [config] dim-rnn: 1024
[2023-07-05 13:14:54] [config] dim-vocabs:
[2023-07-05 13:14:54] [config]   - 36507
[2023-07-05 13:14:54] [config]   - 54042
[2023-07-05 13:14:54] [config] disp-first: 0
[2023-07-05 13:14:54] [config] disp-freq: 1000u
[2023-07-05 13:14:54] [config] disp-label-counts: true
[2023-07-05 13:14:54] [config] dropout-rnn: 0
[2023-07-05 13:14:54] [config] dropout-src: 0
[2023-07-05 13:14:54] [config] dropout-trg: 0
[2023-07-05 13:14:54] [config] dump-config: ""
[2023-07-05 13:14:54] [config] dynamic-gradient-scaling:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] early-stopping: 10
[2023-07-05 13:14:54] [config] early-stopping-on: first
[2023-07-05 13:14:54] [config] embedding-fix-src: false
[2023-07-05 13:14:54] [config] embedding-fix-trg: false
[2023-07-05 13:14:54] [config] embedding-normalization: false
[2023-07-05 13:14:54] [config] embedding-vectors:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] enc-cell: gru
[2023-07-05 13:14:54] [config] enc-cell-depth: 1
[2023-07-05 13:14:54] [config] enc-depth: 1
[2023-07-05 13:14:54] [config] enc-type: bidirectional
[2023-07-05 13:14:54] [config] english-title-case-every: 0
[2023-07-05 13:14:54] [config] exponential-smoothing: 0
[2023-07-05 13:14:54] [config] factor-weight: 1
[2023-07-05 13:14:54] [config] factors-combine: sum
[2023-07-05 13:14:54] [config] factors-dim-emb: 0
[2023-07-05 13:14:54] [config] gradient-checkpointing: false
[2023-07-05 13:14:54] [config] gradient-norm-average-window: 100
[2023-07-05 13:14:54] [config] guided-alignment: none
[2023-07-05 13:14:54] [config] guided-alignment-cost: mse
[2023-07-05 13:14:54] [config] guided-alignment-weight: 0.1
[2023-07-05 13:14:54] [config] ignore-model-config: false
[2023-07-05 13:14:54] [config] input-types:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] interpolate-env-vars: false
[2023-07-05 13:14:54] [config] keep-best: false
[2023-07-05 13:14:54] [config] label-smoothing: 0
[2023-07-05 13:14:54] [config] layer-normalization: false
[2023-07-05 13:14:54] [config] learn-rate: 0.0001
[2023-07-05 13:14:54] [config] lemma-dependency: ""
[2023-07-05 13:14:54] [config] lemma-dim-emb: 0
[2023-07-05 13:14:54] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:14:54] [config] log-level: info
[2023-07-05 13:14:54] [config] log-time-zone: ""
[2023-07-05 13:14:54] [config] logical-epoch:
[2023-07-05 13:14:54] [config]   - 1e
[2023-07-05 13:14:54] [config]   - 0
[2023-07-05 13:14:54] [config] lr-decay: 0
[2023-07-05 13:14:54] [config] lr-decay-freq: 50000
[2023-07-05 13:14:54] [config] lr-decay-inv-sqrt:
[2023-07-05 13:14:54] [config]   - 0
[2023-07-05 13:14:54] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:14:54] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:14:54] [config] lr-decay-start:
[2023-07-05 13:14:54] [config]   - 10
[2023-07-05 13:14:54] [config]   - 1
[2023-07-05 13:14:54] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:14:54] [config] lr-report: false
[2023-07-05 13:14:54] [config] lr-warmup: 0
[2023-07-05 13:14:54] [config] lr-warmup-at-reload: false
[2023-07-05 13:14:54] [config] lr-warmup-cycle: false
[2023-07-05 13:14:54] [config] lr-warmup-start-rate: 0
[2023-07-05 13:14:54] [config] max-length: 50
[2023-07-05 13:14:54] [config] max-length-crop: false
[2023-07-05 13:14:54] [config] max-length-factor: 3
[2023-07-05 13:14:54] [config] maxi-batch: 100
[2023-07-05 13:14:54] [config] maxi-batch-sort: trg
[2023-07-05 13:14:54] [config] mini-batch: 64
[2023-07-05 13:14:54] [config] mini-batch-fit: false
[2023-07-05 13:14:54] [config] mini-batch-fit-step: 10
[2023-07-05 13:14:54] [config] mini-batch-round-up: true
[2023-07-05 13:14:54] [config] mini-batch-track-lr: false
[2023-07-05 13:14:54] [config] mini-batch-warmup: 0
[2023-07-05 13:14:54] [config] mini-batch-words: 0
[2023-07-05 13:14:54] [config] mini-batch-words-ref: 0
[2023-07-05 13:14:54] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:14:54] [config] multi-loss-type: sum
[2023-07-05 13:14:54] [config] n-best: false
[2023-07-05 13:14:54] [config] no-nccl: false
[2023-07-05 13:14:54] [config] no-reload: false
[2023-07-05 13:14:54] [config] no-restore-corpus: false
[2023-07-05 13:14:54] [config] normalize: 0
[2023-07-05 13:14:54] [config] normalize-gradient: false
[2023-07-05 13:14:54] [config] num-devices: 0
[2023-07-05 13:14:54] [config] optimizer: adam
[2023-07-05 13:14:54] [config] optimizer-delay: 1
[2023-07-05 13:14:54] [config] optimizer-params:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] output-omit-bias: false
[2023-07-05 13:14:54] [config] overwrite: true
[2023-07-05 13:14:54] [config] precision:
[2023-07-05 13:14:54] [config]   - float32
[2023-07-05 13:14:54] [config]   - float32
[2023-07-05 13:14:54] [config] pretrained-model: ""
[2023-07-05 13:14:54] [config] quantize-biases: false
[2023-07-05 13:14:54] [config] quantize-bits: 0
[2023-07-05 13:14:54] [config] quantize-log-based: false
[2023-07-05 13:14:54] [config] quantize-optimization-steps: 0
[2023-07-05 13:14:54] [config] quiet: false
[2023-07-05 13:14:54] [config] quiet-translation: true
[2023-07-05 13:14:54] [config] relative-paths: false
[2023-07-05 13:14:54] [config] right-left: false
[2023-07-05 13:14:54] [config] save-freq: 10000u
[2023-07-05 13:14:54] [config] seed: 1234
[2023-07-05 13:14:54] [config] sentencepiece-alphas:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:14:54] [config] sentencepiece-options: ""
[2023-07-05 13:14:54] [config] sharding: global
[2023-07-05 13:14:54] [config] shuffle: data
[2023-07-05 13:14:54] [config] shuffle-in-ram: false
[2023-07-05 13:14:54] [config] sigterm: save-and-exit
[2023-07-05 13:14:54] [config] skip: false
[2023-07-05 13:14:54] [config] sqlite: ""
[2023-07-05 13:14:54] [config] sqlite-drop: false
[2023-07-05 13:14:54] [config] sync-freq: 200u
[2023-07-05 13:14:54] [config] sync-sgd: false
[2023-07-05 13:14:54] [config] tempdir: /tmp
[2023-07-05 13:14:54] [config] tied-embeddings: false
[2023-07-05 13:14:54] [config] tied-embeddings-all: false
[2023-07-05 13:14:54] [config] tied-embeddings-src: false
[2023-07-05 13:14:54] [config] train-embedder-rank:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] train-sets:
[2023-07-05 13:14:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:14:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:14:54] [config] transformer-aan-activation: swish
[2023-07-05 13:14:54] [config] transformer-aan-depth: 2
[2023-07-05 13:14:54] [config] transformer-aan-nogate: false
[2023-07-05 13:14:54] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:14:54] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:14:54] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:14:54] [config] transformer-depth-scaling: false
[2023-07-05 13:14:54] [config] transformer-dim-aan: 2048
[2023-07-05 13:14:54] [config] transformer-dim-ffn: 2048
[2023-07-05 13:14:54] [config] transformer-dropout: 0
[2023-07-05 13:14:54] [config] transformer-dropout-attention: 0
[2023-07-05 13:14:54] [config] transformer-dropout-ffn: 0
[2023-07-05 13:14:54] [config] transformer-ffn-activation: swish
[2023-07-05 13:14:54] [config] transformer-ffn-depth: 2
[2023-07-05 13:14:54] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:14:54] [config] transformer-heads: 8
[2023-07-05 13:14:54] [config] transformer-no-projection: false
[2023-07-05 13:14:54] [config] transformer-pool: false
[2023-07-05 13:14:54] [config] transformer-postprocess: dan
[2023-07-05 13:14:54] [config] transformer-postprocess-emb: d
[2023-07-05 13:14:54] [config] transformer-postprocess-top: ""
[2023-07-05 13:14:54] [config] transformer-preprocess: ""
[2023-07-05 13:14:54] [config] transformer-tied-layers:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] transformer-train-position-embeddings: false
[2023-07-05 13:14:54] [config] tsv: false
[2023-07-05 13:14:54] [config] tsv-fields: 0
[2023-07-05 13:14:54] [config] type: amun
[2023-07-05 13:14:54] [config] ulr: false
[2023-07-05 13:14:54] [config] ulr-dim-emb: 0
[2023-07-05 13:14:54] [config] ulr-dropout: 0
[2023-07-05 13:14:54] [config] ulr-keys-vectors: ""
[2023-07-05 13:14:54] [config] ulr-query-vectors: ""
[2023-07-05 13:14:54] [config] ulr-softmax-temperature: 1
[2023-07-05 13:14:54] [config] ulr-trainable-transformation: false
[2023-07-05 13:14:54] [config] unlikelihood-loss: false
[2023-07-05 13:14:54] [config] valid-freq: 50000000
[2023-07-05 13:14:54] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:14:54] [config] valid-max-length: 1000
[2023-07-05 13:14:54] [config] valid-metrics:
[2023-07-05 13:14:54] [config]   - cross-entropy
[2023-07-05 13:14:54] [config]   - translation
[2023-07-05 13:14:54] [config] valid-mini-batch: 32
[2023-07-05 13:14:54] [config] valid-reset-stalled: false
[2023-07-05 13:14:54] [config] valid-script-args:
[2023-07-05 13:14:54] [config]   []
[2023-07-05 13:14:54] [config] valid-script-path: ""
[2023-07-05 13:14:54] [config] valid-sets:
[2023-07-05 13:14:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:14:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:14:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:14:54] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:54] [config] vocabs:
[2023-07-05 13:14:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:14:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:14:54] [config] word-penalty: 0
[2023-07-05 13:14:54] [config] word-scores: false
[2023-07-05 13:14:54] [config] workspace: 2048
[2023-07-05 13:14:54] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:14:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:14:54] [training] Using single-device training
[2023-07-05 13:14:56] Synced seed 1234
[2023-07-05 13:14:56] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:14:56] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:14:56] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:14:56] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:14:56] [valid] No post-processing script given for validating translator
[2023-07-05 13:14:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:14:57] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:14:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:14:57] [comm] Using global sharding
[2023-07-05 13:14:57] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:14:57] [training] Using 1 GPUs
[2023-07-05 13:14:57] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:14:59] Loading Adam parameters
[2023-07-05 13:14:59] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:15:00] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:00] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:15:00] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:15:00] [data] Shuffling data
[2023-07-05 13:15:00] [data] Done reading 20,192 sentences
[2023-07-05 13:15:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:00] Training started
[2023-07-05 13:15:00] Training finished
[2023-07-05 13:15:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:03] [marian] Running on node22.datos.cluster.uy as process 20388 with command line:
[2023-07-05 13:15:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:15:03] [config] after: 0e
[2023-07-05 13:15:03] [config] after-batches: 0
[2023-07-05 13:15:03] [config] after-epochs: 150
[2023-07-05 13:15:03] [config] all-caps-every: 0
[2023-07-05 13:15:03] [config] allow-unk: false
[2023-07-05 13:15:03] [config] authors: false
[2023-07-05 13:15:03] [config] beam-size: 12
[2023-07-05 13:15:03] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:15:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:15:03] [config] bert-masking-fraction: 0.15
[2023-07-05 13:15:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:15:03] [config] bert-train-type-embeddings: true
[2023-07-05 13:15:03] [config] bert-type-vocab-size: 2
[2023-07-05 13:15:03] [config] build-info: ""
[2023-07-05 13:15:03] [config] check-gradient-nan: false
[2023-07-05 13:15:03] [config] check-nan: false
[2023-07-05 13:15:03] [config] cite: false
[2023-07-05 13:15:03] [config] clip-norm: 1
[2023-07-05 13:15:03] [config] cost-scaling:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] cost-type: ce-sum
[2023-07-05 13:15:03] [config] cpu-threads: 0
[2023-07-05 13:15:03] [config] data-threads: 8
[2023-07-05 13:15:03] [config] data-weighting: ""
[2023-07-05 13:15:03] [config] data-weighting-type: sentence
[2023-07-05 13:15:03] [config] dec-cell: gru
[2023-07-05 13:15:03] [config] dec-cell-base-depth: 2
[2023-07-05 13:15:03] [config] dec-cell-high-depth: 1
[2023-07-05 13:15:03] [config] dec-depth: 1
[2023-07-05 13:15:03] [config] devices:
[2023-07-05 13:15:03] [config]   - 0
[2023-07-05 13:15:03] [config] dim-emb: 512
[2023-07-05 13:15:03] [config] dim-rnn: 1024
[2023-07-05 13:15:03] [config] dim-vocabs:
[2023-07-05 13:15:03] [config]   - 36507
[2023-07-05 13:15:03] [config]   - 54042
[2023-07-05 13:15:03] [config] disp-first: 0
[2023-07-05 13:15:03] [config] disp-freq: 1000u
[2023-07-05 13:15:03] [config] disp-label-counts: true
[2023-07-05 13:15:03] [config] dropout-rnn: 0
[2023-07-05 13:15:03] [config] dropout-src: 0
[2023-07-05 13:15:03] [config] dropout-trg: 0
[2023-07-05 13:15:03] [config] dump-config: ""
[2023-07-05 13:15:03] [config] dynamic-gradient-scaling:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] early-stopping: 10
[2023-07-05 13:15:03] [config] early-stopping-on: first
[2023-07-05 13:15:03] [config] embedding-fix-src: false
[2023-07-05 13:15:03] [config] embedding-fix-trg: false
[2023-07-05 13:15:03] [config] embedding-normalization: false
[2023-07-05 13:15:03] [config] embedding-vectors:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] enc-cell: gru
[2023-07-05 13:15:03] [config] enc-cell-depth: 1
[2023-07-05 13:15:03] [config] enc-depth: 1
[2023-07-05 13:15:03] [config] enc-type: bidirectional
[2023-07-05 13:15:03] [config] english-title-case-every: 0
[2023-07-05 13:15:03] [config] exponential-smoothing: 0
[2023-07-05 13:15:03] [config] factor-weight: 1
[2023-07-05 13:15:03] [config] factors-combine: sum
[2023-07-05 13:15:03] [config] factors-dim-emb: 0
[2023-07-05 13:15:03] [config] gradient-checkpointing: false
[2023-07-05 13:15:03] [config] gradient-norm-average-window: 100
[2023-07-05 13:15:03] [config] guided-alignment: none
[2023-07-05 13:15:03] [config] guided-alignment-cost: mse
[2023-07-05 13:15:03] [config] guided-alignment-weight: 0.1
[2023-07-05 13:15:03] [config] ignore-model-config: false
[2023-07-05 13:15:03] [config] input-types:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] interpolate-env-vars: false
[2023-07-05 13:15:03] [config] keep-best: false
[2023-07-05 13:15:03] [config] label-smoothing: 0
[2023-07-05 13:15:03] [config] layer-normalization: false
[2023-07-05 13:15:03] [config] learn-rate: 0.0001
[2023-07-05 13:15:03] [config] lemma-dependency: ""
[2023-07-05 13:15:03] [config] lemma-dim-emb: 0
[2023-07-05 13:15:03] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:15:03] [config] log-level: info
[2023-07-05 13:15:03] [config] log-time-zone: ""
[2023-07-05 13:15:03] [config] logical-epoch:
[2023-07-05 13:15:03] [config]   - 1e
[2023-07-05 13:15:03] [config]   - 0
[2023-07-05 13:15:03] [config] lr-decay: 0
[2023-07-05 13:15:03] [config] lr-decay-freq: 50000
[2023-07-05 13:15:03] [config] lr-decay-inv-sqrt:
[2023-07-05 13:15:03] [config]   - 0
[2023-07-05 13:15:03] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:15:03] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:15:03] [config] lr-decay-start:
[2023-07-05 13:15:03] [config]   - 10
[2023-07-05 13:15:03] [config]   - 1
[2023-07-05 13:15:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:15:03] [config] lr-report: false
[2023-07-05 13:15:03] [config] lr-warmup: 0
[2023-07-05 13:15:03] [config] lr-warmup-at-reload: false
[2023-07-05 13:15:03] [config] lr-warmup-cycle: false
[2023-07-05 13:15:03] [config] lr-warmup-start-rate: 0
[2023-07-05 13:15:03] [config] max-length: 50
[2023-07-05 13:15:03] [config] max-length-crop: false
[2023-07-05 13:15:03] [config] max-length-factor: 3
[2023-07-05 13:15:03] [config] maxi-batch: 100
[2023-07-05 13:15:03] [config] maxi-batch-sort: trg
[2023-07-05 13:15:03] [config] mini-batch: 64
[2023-07-05 13:15:03] [config] mini-batch-fit: false
[2023-07-05 13:15:03] [config] mini-batch-fit-step: 10
[2023-07-05 13:15:03] [config] mini-batch-round-up: true
[2023-07-05 13:15:03] [config] mini-batch-track-lr: false
[2023-07-05 13:15:03] [config] mini-batch-warmup: 0
[2023-07-05 13:15:03] [config] mini-batch-words: 0
[2023-07-05 13:15:03] [config] mini-batch-words-ref: 0
[2023-07-05 13:15:03] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:03] [config] multi-loss-type: sum
[2023-07-05 13:15:03] [config] n-best: false
[2023-07-05 13:15:03] [config] no-nccl: false
[2023-07-05 13:15:03] [config] no-reload: false
[2023-07-05 13:15:03] [config] no-restore-corpus: false
[2023-07-05 13:15:03] [config] normalize: 0
[2023-07-05 13:15:03] [config] normalize-gradient: false
[2023-07-05 13:15:03] [config] num-devices: 0
[2023-07-05 13:15:03] [config] optimizer: adam
[2023-07-05 13:15:03] [config] optimizer-delay: 1
[2023-07-05 13:15:03] [config] optimizer-params:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] output-omit-bias: false
[2023-07-05 13:15:03] [config] overwrite: true
[2023-07-05 13:15:03] [config] precision:
[2023-07-05 13:15:03] [config]   - float32
[2023-07-05 13:15:03] [config]   - float32
[2023-07-05 13:15:03] [config] pretrained-model: ""
[2023-07-05 13:15:03] [config] quantize-biases: false
[2023-07-05 13:15:03] [config] quantize-bits: 0
[2023-07-05 13:15:03] [config] quantize-log-based: false
[2023-07-05 13:15:03] [config] quantize-optimization-steps: 0
[2023-07-05 13:15:03] [config] quiet: false
[2023-07-05 13:15:03] [config] quiet-translation: true
[2023-07-05 13:15:03] [config] relative-paths: false
[2023-07-05 13:15:03] [config] right-left: false
[2023-07-05 13:15:03] [config] save-freq: 10000u
[2023-07-05 13:15:03] [config] seed: 1234
[2023-07-05 13:15:03] [config] sentencepiece-alphas:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:15:03] [config] sentencepiece-options: ""
[2023-07-05 13:15:03] [config] sharding: global
[2023-07-05 13:15:03] [config] shuffle: data
[2023-07-05 13:15:03] [config] shuffle-in-ram: false
[2023-07-05 13:15:03] [config] sigterm: save-and-exit
[2023-07-05 13:15:03] [config] skip: false
[2023-07-05 13:15:03] [config] sqlite: ""
[2023-07-05 13:15:03] [config] sqlite-drop: false
[2023-07-05 13:15:03] [config] sync-freq: 200u
[2023-07-05 13:15:03] [config] sync-sgd: false
[2023-07-05 13:15:03] [config] tempdir: /tmp
[2023-07-05 13:15:03] [config] tied-embeddings: false
[2023-07-05 13:15:03] [config] tied-embeddings-all: false
[2023-07-05 13:15:03] [config] tied-embeddings-src: false
[2023-07-05 13:15:03] [config] train-embedder-rank:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] train-sets:
[2023-07-05 13:15:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:15:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:15:03] [config] transformer-aan-activation: swish
[2023-07-05 13:15:03] [config] transformer-aan-depth: 2
[2023-07-05 13:15:03] [config] transformer-aan-nogate: false
[2023-07-05 13:15:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:15:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:15:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:15:03] [config] transformer-depth-scaling: false
[2023-07-05 13:15:03] [config] transformer-dim-aan: 2048
[2023-07-05 13:15:03] [config] transformer-dim-ffn: 2048
[2023-07-05 13:15:03] [config] transformer-dropout: 0
[2023-07-05 13:15:03] [config] transformer-dropout-attention: 0
[2023-07-05 13:15:03] [config] transformer-dropout-ffn: 0
[2023-07-05 13:15:03] [config] transformer-ffn-activation: swish
[2023-07-05 13:15:03] [config] transformer-ffn-depth: 2
[2023-07-05 13:15:03] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:15:03] [config] transformer-heads: 8
[2023-07-05 13:15:03] [config] transformer-no-projection: false
[2023-07-05 13:15:03] [config] transformer-pool: false
[2023-07-05 13:15:03] [config] transformer-postprocess: dan
[2023-07-05 13:15:03] [config] transformer-postprocess-emb: d
[2023-07-05 13:15:03] [config] transformer-postprocess-top: ""
[2023-07-05 13:15:03] [config] transformer-preprocess: ""
[2023-07-05 13:15:03] [config] transformer-tied-layers:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] transformer-train-position-embeddings: false
[2023-07-05 13:15:03] [config] tsv: false
[2023-07-05 13:15:03] [config] tsv-fields: 0
[2023-07-05 13:15:03] [config] type: amun
[2023-07-05 13:15:03] [config] ulr: false
[2023-07-05 13:15:03] [config] ulr-dim-emb: 0
[2023-07-05 13:15:03] [config] ulr-dropout: 0
[2023-07-05 13:15:03] [config] ulr-keys-vectors: ""
[2023-07-05 13:15:03] [config] ulr-query-vectors: ""
[2023-07-05 13:15:03] [config] ulr-softmax-temperature: 1
[2023-07-05 13:15:03] [config] ulr-trainable-transformation: false
[2023-07-05 13:15:03] [config] unlikelihood-loss: false
[2023-07-05 13:15:03] [config] valid-freq: 50000000
[2023-07-05 13:15:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:15:03] [config] valid-max-length: 1000
[2023-07-05 13:15:03] [config] valid-metrics:
[2023-07-05 13:15:03] [config]   - cross-entropy
[2023-07-05 13:15:03] [config]   - translation
[2023-07-05 13:15:03] [config] valid-mini-batch: 32
[2023-07-05 13:15:03] [config] valid-reset-stalled: false
[2023-07-05 13:15:03] [config] valid-script-args:
[2023-07-05 13:15:03] [config]   []
[2023-07-05 13:15:03] [config] valid-script-path: ""
[2023-07-05 13:15:03] [config] valid-sets:
[2023-07-05 13:15:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:15:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:15:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:15:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:03] [config] vocabs:
[2023-07-05 13:15:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:03] [config] word-penalty: 0
[2023-07-05 13:15:03] [config] word-scores: false
[2023-07-05 13:15:03] [config] workspace: 2048
[2023-07-05 13:15:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:03] [training] Using single-device training
[2023-07-05 13:15:05] Synced seed 1234
[2023-07-05 13:15:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:05] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:15:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:05] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:15:05] [valid] No post-processing script given for validating translator
[2023-07-05 13:15:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:06] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:15:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:15:06] [comm] Using global sharding
[2023-07-05 13:15:06] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:15:06] [training] Using 1 GPUs
[2023-07-05 13:15:06] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:08] Loading Adam parameters
[2023-07-05 13:15:08] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:15:08] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:15:09] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:15:09] [data] Shuffling data
[2023-07-05 13:15:09] [data] Done reading 20,192 sentences
[2023-07-05 13:15:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:09] Training started
[2023-07-05 13:15:09] Training finished
[2023-07-05 13:15:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:12] [marian] Running on node22.datos.cluster.uy as process 20557 with command line:
[2023-07-05 13:15:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:15:12] [config] after: 0e
[2023-07-05 13:15:12] [config] after-batches: 0
[2023-07-05 13:15:12] [config] after-epochs: 160
[2023-07-05 13:15:12] [config] all-caps-every: 0
[2023-07-05 13:15:12] [config] allow-unk: false
[2023-07-05 13:15:12] [config] authors: false
[2023-07-05 13:15:12] [config] beam-size: 12
[2023-07-05 13:15:12] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:15:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:15:12] [config] bert-masking-fraction: 0.15
[2023-07-05 13:15:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:15:12] [config] bert-train-type-embeddings: true
[2023-07-05 13:15:12] [config] bert-type-vocab-size: 2
[2023-07-05 13:15:12] [config] build-info: ""
[2023-07-05 13:15:12] [config] check-gradient-nan: false
[2023-07-05 13:15:12] [config] check-nan: false
[2023-07-05 13:15:12] [config] cite: false
[2023-07-05 13:15:12] [config] clip-norm: 1
[2023-07-05 13:15:12] [config] cost-scaling:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] cost-type: ce-sum
[2023-07-05 13:15:12] [config] cpu-threads: 0
[2023-07-05 13:15:12] [config] data-threads: 8
[2023-07-05 13:15:12] [config] data-weighting: ""
[2023-07-05 13:15:12] [config] data-weighting-type: sentence
[2023-07-05 13:15:12] [config] dec-cell: gru
[2023-07-05 13:15:12] [config] dec-cell-base-depth: 2
[2023-07-05 13:15:12] [config] dec-cell-high-depth: 1
[2023-07-05 13:15:12] [config] dec-depth: 1
[2023-07-05 13:15:12] [config] devices:
[2023-07-05 13:15:12] [config]   - 0
[2023-07-05 13:15:12] [config] dim-emb: 512
[2023-07-05 13:15:12] [config] dim-rnn: 1024
[2023-07-05 13:15:12] [config] dim-vocabs:
[2023-07-05 13:15:12] [config]   - 36507
[2023-07-05 13:15:12] [config]   - 54042
[2023-07-05 13:15:12] [config] disp-first: 0
[2023-07-05 13:15:12] [config] disp-freq: 1000u
[2023-07-05 13:15:12] [config] disp-label-counts: true
[2023-07-05 13:15:12] [config] dropout-rnn: 0
[2023-07-05 13:15:12] [config] dropout-src: 0
[2023-07-05 13:15:12] [config] dropout-trg: 0
[2023-07-05 13:15:12] [config] dump-config: ""
[2023-07-05 13:15:12] [config] dynamic-gradient-scaling:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] early-stopping: 10
[2023-07-05 13:15:12] [config] early-stopping-on: first
[2023-07-05 13:15:12] [config] embedding-fix-src: false
[2023-07-05 13:15:12] [config] embedding-fix-trg: false
[2023-07-05 13:15:12] [config] embedding-normalization: false
[2023-07-05 13:15:12] [config] embedding-vectors:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] enc-cell: gru
[2023-07-05 13:15:12] [config] enc-cell-depth: 1
[2023-07-05 13:15:12] [config] enc-depth: 1
[2023-07-05 13:15:12] [config] enc-type: bidirectional
[2023-07-05 13:15:12] [config] english-title-case-every: 0
[2023-07-05 13:15:12] [config] exponential-smoothing: 0
[2023-07-05 13:15:12] [config] factor-weight: 1
[2023-07-05 13:15:12] [config] factors-combine: sum
[2023-07-05 13:15:12] [config] factors-dim-emb: 0
[2023-07-05 13:15:12] [config] gradient-checkpointing: false
[2023-07-05 13:15:12] [config] gradient-norm-average-window: 100
[2023-07-05 13:15:12] [config] guided-alignment: none
[2023-07-05 13:15:12] [config] guided-alignment-cost: mse
[2023-07-05 13:15:12] [config] guided-alignment-weight: 0.1
[2023-07-05 13:15:12] [config] ignore-model-config: false
[2023-07-05 13:15:12] [config] input-types:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] interpolate-env-vars: false
[2023-07-05 13:15:12] [config] keep-best: false
[2023-07-05 13:15:12] [config] label-smoothing: 0
[2023-07-05 13:15:12] [config] layer-normalization: false
[2023-07-05 13:15:12] [config] learn-rate: 0.0001
[2023-07-05 13:15:12] [config] lemma-dependency: ""
[2023-07-05 13:15:12] [config] lemma-dim-emb: 0
[2023-07-05 13:15:12] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:15:12] [config] log-level: info
[2023-07-05 13:15:12] [config] log-time-zone: ""
[2023-07-05 13:15:12] [config] logical-epoch:
[2023-07-05 13:15:12] [config]   - 1e
[2023-07-05 13:15:12] [config]   - 0
[2023-07-05 13:15:12] [config] lr-decay: 0
[2023-07-05 13:15:12] [config] lr-decay-freq: 50000
[2023-07-05 13:15:12] [config] lr-decay-inv-sqrt:
[2023-07-05 13:15:12] [config]   - 0
[2023-07-05 13:15:12] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:15:12] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:15:12] [config] lr-decay-start:
[2023-07-05 13:15:12] [config]   - 10
[2023-07-05 13:15:12] [config]   - 1
[2023-07-05 13:15:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:15:12] [config] lr-report: false
[2023-07-05 13:15:12] [config] lr-warmup: 0
[2023-07-05 13:15:12] [config] lr-warmup-at-reload: false
[2023-07-05 13:15:12] [config] lr-warmup-cycle: false
[2023-07-05 13:15:12] [config] lr-warmup-start-rate: 0
[2023-07-05 13:15:12] [config] max-length: 50
[2023-07-05 13:15:12] [config] max-length-crop: false
[2023-07-05 13:15:12] [config] max-length-factor: 3
[2023-07-05 13:15:12] [config] maxi-batch: 100
[2023-07-05 13:15:12] [config] maxi-batch-sort: trg
[2023-07-05 13:15:12] [config] mini-batch: 64
[2023-07-05 13:15:12] [config] mini-batch-fit: false
[2023-07-05 13:15:12] [config] mini-batch-fit-step: 10
[2023-07-05 13:15:12] [config] mini-batch-round-up: true
[2023-07-05 13:15:12] [config] mini-batch-track-lr: false
[2023-07-05 13:15:12] [config] mini-batch-warmup: 0
[2023-07-05 13:15:12] [config] mini-batch-words: 0
[2023-07-05 13:15:12] [config] mini-batch-words-ref: 0
[2023-07-05 13:15:12] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:12] [config] multi-loss-type: sum
[2023-07-05 13:15:12] [config] n-best: false
[2023-07-05 13:15:12] [config] no-nccl: false
[2023-07-05 13:15:12] [config] no-reload: false
[2023-07-05 13:15:12] [config] no-restore-corpus: false
[2023-07-05 13:15:12] [config] normalize: 0
[2023-07-05 13:15:12] [config] normalize-gradient: false
[2023-07-05 13:15:12] [config] num-devices: 0
[2023-07-05 13:15:12] [config] optimizer: adam
[2023-07-05 13:15:12] [config] optimizer-delay: 1
[2023-07-05 13:15:12] [config] optimizer-params:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] output-omit-bias: false
[2023-07-05 13:15:12] [config] overwrite: true
[2023-07-05 13:15:12] [config] precision:
[2023-07-05 13:15:12] [config]   - float32
[2023-07-05 13:15:12] [config]   - float32
[2023-07-05 13:15:12] [config] pretrained-model: ""
[2023-07-05 13:15:12] [config] quantize-biases: false
[2023-07-05 13:15:12] [config] quantize-bits: 0
[2023-07-05 13:15:12] [config] quantize-log-based: false
[2023-07-05 13:15:12] [config] quantize-optimization-steps: 0
[2023-07-05 13:15:12] [config] quiet: false
[2023-07-05 13:15:12] [config] quiet-translation: true
[2023-07-05 13:15:12] [config] relative-paths: false
[2023-07-05 13:15:12] [config] right-left: false
[2023-07-05 13:15:12] [config] save-freq: 10000u
[2023-07-05 13:15:12] [config] seed: 1234
[2023-07-05 13:15:12] [config] sentencepiece-alphas:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:15:12] [config] sentencepiece-options: ""
[2023-07-05 13:15:12] [config] sharding: global
[2023-07-05 13:15:12] [config] shuffle: data
[2023-07-05 13:15:12] [config] shuffle-in-ram: false
[2023-07-05 13:15:12] [config] sigterm: save-and-exit
[2023-07-05 13:15:12] [config] skip: false
[2023-07-05 13:15:12] [config] sqlite: ""
[2023-07-05 13:15:12] [config] sqlite-drop: false
[2023-07-05 13:15:12] [config] sync-freq: 200u
[2023-07-05 13:15:12] [config] sync-sgd: false
[2023-07-05 13:15:12] [config] tempdir: /tmp
[2023-07-05 13:15:12] [config] tied-embeddings: false
[2023-07-05 13:15:12] [config] tied-embeddings-all: false
[2023-07-05 13:15:12] [config] tied-embeddings-src: false
[2023-07-05 13:15:12] [config] train-embedder-rank:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] train-sets:
[2023-07-05 13:15:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:15:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:15:12] [config] transformer-aan-activation: swish
[2023-07-05 13:15:12] [config] transformer-aan-depth: 2
[2023-07-05 13:15:12] [config] transformer-aan-nogate: false
[2023-07-05 13:15:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:15:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:15:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:15:12] [config] transformer-depth-scaling: false
[2023-07-05 13:15:12] [config] transformer-dim-aan: 2048
[2023-07-05 13:15:12] [config] transformer-dim-ffn: 2048
[2023-07-05 13:15:12] [config] transformer-dropout: 0
[2023-07-05 13:15:12] [config] transformer-dropout-attention: 0
[2023-07-05 13:15:12] [config] transformer-dropout-ffn: 0
[2023-07-05 13:15:12] [config] transformer-ffn-activation: swish
[2023-07-05 13:15:12] [config] transformer-ffn-depth: 2
[2023-07-05 13:15:12] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:15:12] [config] transformer-heads: 8
[2023-07-05 13:15:12] [config] transformer-no-projection: false
[2023-07-05 13:15:12] [config] transformer-pool: false
[2023-07-05 13:15:12] [config] transformer-postprocess: dan
[2023-07-05 13:15:12] [config] transformer-postprocess-emb: d
[2023-07-05 13:15:12] [config] transformer-postprocess-top: ""
[2023-07-05 13:15:12] [config] transformer-preprocess: ""
[2023-07-05 13:15:12] [config] transformer-tied-layers:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] transformer-train-position-embeddings: false
[2023-07-05 13:15:12] [config] tsv: false
[2023-07-05 13:15:12] [config] tsv-fields: 0
[2023-07-05 13:15:12] [config] type: amun
[2023-07-05 13:15:12] [config] ulr: false
[2023-07-05 13:15:12] [config] ulr-dim-emb: 0
[2023-07-05 13:15:12] [config] ulr-dropout: 0
[2023-07-05 13:15:12] [config] ulr-keys-vectors: ""
[2023-07-05 13:15:12] [config] ulr-query-vectors: ""
[2023-07-05 13:15:12] [config] ulr-softmax-temperature: 1
[2023-07-05 13:15:12] [config] ulr-trainable-transformation: false
[2023-07-05 13:15:12] [config] unlikelihood-loss: false
[2023-07-05 13:15:12] [config] valid-freq: 50000000
[2023-07-05 13:15:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:15:12] [config] valid-max-length: 1000
[2023-07-05 13:15:12] [config] valid-metrics:
[2023-07-05 13:15:12] [config]   - cross-entropy
[2023-07-05 13:15:12] [config]   - translation
[2023-07-05 13:15:12] [config] valid-mini-batch: 32
[2023-07-05 13:15:12] [config] valid-reset-stalled: false
[2023-07-05 13:15:12] [config] valid-script-args:
[2023-07-05 13:15:12] [config]   []
[2023-07-05 13:15:12] [config] valid-script-path: ""
[2023-07-05 13:15:12] [config] valid-sets:
[2023-07-05 13:15:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:15:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:15:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:15:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:12] [config] vocabs:
[2023-07-05 13:15:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:12] [config] word-penalty: 0
[2023-07-05 13:15:12] [config] word-scores: false
[2023-07-05 13:15:12] [config] workspace: 2048
[2023-07-05 13:15:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:12] [training] Using single-device training
[2023-07-05 13:15:13] Synced seed 1234
[2023-07-05 13:15:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:13] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:15:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:13] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:15:13] [valid] No post-processing script given for validating translator
[2023-07-05 13:15:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:14] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:15:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:15:14] [comm] Using global sharding
[2023-07-05 13:15:14] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:15:14] [training] Using 1 GPUs
[2023-07-05 13:15:14] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:16] Loading Adam parameters
[2023-07-05 13:15:16] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:15:17] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:15:17] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:15:17] [data] Shuffling data
[2023-07-05 13:15:17] [data] Done reading 20,192 sentences
[2023-07-05 13:15:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:17] Training started
[2023-07-05 13:15:17] Training finished
[2023-07-05 13:15:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:21] [marian] Running on node22.datos.cluster.uy as process 20741 with command line:
[2023-07-05 13:15:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:15:21] [config] after: 0e
[2023-07-05 13:15:21] [config] after-batches: 0
[2023-07-05 13:15:21] [config] after-epochs: 170
[2023-07-05 13:15:21] [config] all-caps-every: 0
[2023-07-05 13:15:21] [config] allow-unk: false
[2023-07-05 13:15:21] [config] authors: false
[2023-07-05 13:15:21] [config] beam-size: 12
[2023-07-05 13:15:21] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:15:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:15:21] [config] bert-masking-fraction: 0.15
[2023-07-05 13:15:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:15:21] [config] bert-train-type-embeddings: true
[2023-07-05 13:15:21] [config] bert-type-vocab-size: 2
[2023-07-05 13:15:21] [config] build-info: ""
[2023-07-05 13:15:21] [config] check-gradient-nan: false
[2023-07-05 13:15:21] [config] check-nan: false
[2023-07-05 13:15:21] [config] cite: false
[2023-07-05 13:15:21] [config] clip-norm: 1
[2023-07-05 13:15:21] [config] cost-scaling:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] cost-type: ce-sum
[2023-07-05 13:15:21] [config] cpu-threads: 0
[2023-07-05 13:15:21] [config] data-threads: 8
[2023-07-05 13:15:21] [config] data-weighting: ""
[2023-07-05 13:15:21] [config] data-weighting-type: sentence
[2023-07-05 13:15:21] [config] dec-cell: gru
[2023-07-05 13:15:21] [config] dec-cell-base-depth: 2
[2023-07-05 13:15:21] [config] dec-cell-high-depth: 1
[2023-07-05 13:15:21] [config] dec-depth: 1
[2023-07-05 13:15:21] [config] devices:
[2023-07-05 13:15:21] [config]   - 0
[2023-07-05 13:15:21] [config] dim-emb: 512
[2023-07-05 13:15:21] [config] dim-rnn: 1024
[2023-07-05 13:15:21] [config] dim-vocabs:
[2023-07-05 13:15:21] [config]   - 36507
[2023-07-05 13:15:21] [config]   - 54042
[2023-07-05 13:15:21] [config] disp-first: 0
[2023-07-05 13:15:21] [config] disp-freq: 1000u
[2023-07-05 13:15:21] [config] disp-label-counts: true
[2023-07-05 13:15:21] [config] dropout-rnn: 0
[2023-07-05 13:15:21] [config] dropout-src: 0
[2023-07-05 13:15:21] [config] dropout-trg: 0
[2023-07-05 13:15:21] [config] dump-config: ""
[2023-07-05 13:15:21] [config] dynamic-gradient-scaling:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] early-stopping: 10
[2023-07-05 13:15:21] [config] early-stopping-on: first
[2023-07-05 13:15:21] [config] embedding-fix-src: false
[2023-07-05 13:15:21] [config] embedding-fix-trg: false
[2023-07-05 13:15:21] [config] embedding-normalization: false
[2023-07-05 13:15:21] [config] embedding-vectors:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] enc-cell: gru
[2023-07-05 13:15:21] [config] enc-cell-depth: 1
[2023-07-05 13:15:21] [config] enc-depth: 1
[2023-07-05 13:15:21] [config] enc-type: bidirectional
[2023-07-05 13:15:21] [config] english-title-case-every: 0
[2023-07-05 13:15:21] [config] exponential-smoothing: 0
[2023-07-05 13:15:21] [config] factor-weight: 1
[2023-07-05 13:15:21] [config] factors-combine: sum
[2023-07-05 13:15:21] [config] factors-dim-emb: 0
[2023-07-05 13:15:21] [config] gradient-checkpointing: false
[2023-07-05 13:15:21] [config] gradient-norm-average-window: 100
[2023-07-05 13:15:21] [config] guided-alignment: none
[2023-07-05 13:15:21] [config] guided-alignment-cost: mse
[2023-07-05 13:15:21] [config] guided-alignment-weight: 0.1
[2023-07-05 13:15:21] [config] ignore-model-config: false
[2023-07-05 13:15:21] [config] input-types:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] interpolate-env-vars: false
[2023-07-05 13:15:21] [config] keep-best: false
[2023-07-05 13:15:21] [config] label-smoothing: 0
[2023-07-05 13:15:21] [config] layer-normalization: false
[2023-07-05 13:15:21] [config] learn-rate: 0.0001
[2023-07-05 13:15:21] [config] lemma-dependency: ""
[2023-07-05 13:15:21] [config] lemma-dim-emb: 0
[2023-07-05 13:15:21] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:15:21] [config] log-level: info
[2023-07-05 13:15:21] [config] log-time-zone: ""
[2023-07-05 13:15:21] [config] logical-epoch:
[2023-07-05 13:15:21] [config]   - 1e
[2023-07-05 13:15:21] [config]   - 0
[2023-07-05 13:15:21] [config] lr-decay: 0
[2023-07-05 13:15:21] [config] lr-decay-freq: 50000
[2023-07-05 13:15:21] [config] lr-decay-inv-sqrt:
[2023-07-05 13:15:21] [config]   - 0
[2023-07-05 13:15:21] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:15:21] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:15:21] [config] lr-decay-start:
[2023-07-05 13:15:21] [config]   - 10
[2023-07-05 13:15:21] [config]   - 1
[2023-07-05 13:15:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:15:21] [config] lr-report: false
[2023-07-05 13:15:21] [config] lr-warmup: 0
[2023-07-05 13:15:21] [config] lr-warmup-at-reload: false
[2023-07-05 13:15:21] [config] lr-warmup-cycle: false
[2023-07-05 13:15:21] [config] lr-warmup-start-rate: 0
[2023-07-05 13:15:21] [config] max-length: 50
[2023-07-05 13:15:21] [config] max-length-crop: false
[2023-07-05 13:15:21] [config] max-length-factor: 3
[2023-07-05 13:15:21] [config] maxi-batch: 100
[2023-07-05 13:15:21] [config] maxi-batch-sort: trg
[2023-07-05 13:15:21] [config] mini-batch: 64
[2023-07-05 13:15:21] [config] mini-batch-fit: false
[2023-07-05 13:15:21] [config] mini-batch-fit-step: 10
[2023-07-05 13:15:21] [config] mini-batch-round-up: true
[2023-07-05 13:15:21] [config] mini-batch-track-lr: false
[2023-07-05 13:15:21] [config] mini-batch-warmup: 0
[2023-07-05 13:15:21] [config] mini-batch-words: 0
[2023-07-05 13:15:21] [config] mini-batch-words-ref: 0
[2023-07-05 13:15:21] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:21] [config] multi-loss-type: sum
[2023-07-05 13:15:21] [config] n-best: false
[2023-07-05 13:15:21] [config] no-nccl: false
[2023-07-05 13:15:21] [config] no-reload: false
[2023-07-05 13:15:21] [config] no-restore-corpus: false
[2023-07-05 13:15:21] [config] normalize: 0
[2023-07-05 13:15:21] [config] normalize-gradient: false
[2023-07-05 13:15:21] [config] num-devices: 0
[2023-07-05 13:15:21] [config] optimizer: adam
[2023-07-05 13:15:21] [config] optimizer-delay: 1
[2023-07-05 13:15:21] [config] optimizer-params:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] output-omit-bias: false
[2023-07-05 13:15:21] [config] overwrite: true
[2023-07-05 13:15:21] [config] precision:
[2023-07-05 13:15:21] [config]   - float32
[2023-07-05 13:15:21] [config]   - float32
[2023-07-05 13:15:21] [config] pretrained-model: ""
[2023-07-05 13:15:21] [config] quantize-biases: false
[2023-07-05 13:15:21] [config] quantize-bits: 0
[2023-07-05 13:15:21] [config] quantize-log-based: false
[2023-07-05 13:15:21] [config] quantize-optimization-steps: 0
[2023-07-05 13:15:21] [config] quiet: false
[2023-07-05 13:15:21] [config] quiet-translation: true
[2023-07-05 13:15:21] [config] relative-paths: false
[2023-07-05 13:15:21] [config] right-left: false
[2023-07-05 13:15:21] [config] save-freq: 10000u
[2023-07-05 13:15:21] [config] seed: 1234
[2023-07-05 13:15:21] [config] sentencepiece-alphas:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:15:21] [config] sentencepiece-options: ""
[2023-07-05 13:15:21] [config] sharding: global
[2023-07-05 13:15:21] [config] shuffle: data
[2023-07-05 13:15:21] [config] shuffle-in-ram: false
[2023-07-05 13:15:21] [config] sigterm: save-and-exit
[2023-07-05 13:15:21] [config] skip: false
[2023-07-05 13:15:21] [config] sqlite: ""
[2023-07-05 13:15:21] [config] sqlite-drop: false
[2023-07-05 13:15:21] [config] sync-freq: 200u
[2023-07-05 13:15:21] [config] sync-sgd: false
[2023-07-05 13:15:21] [config] tempdir: /tmp
[2023-07-05 13:15:21] [config] tied-embeddings: false
[2023-07-05 13:15:21] [config] tied-embeddings-all: false
[2023-07-05 13:15:21] [config] tied-embeddings-src: false
[2023-07-05 13:15:21] [config] train-embedder-rank:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] train-sets:
[2023-07-05 13:15:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:15:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:15:21] [config] transformer-aan-activation: swish
[2023-07-05 13:15:21] [config] transformer-aan-depth: 2
[2023-07-05 13:15:21] [config] transformer-aan-nogate: false
[2023-07-05 13:15:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:15:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:15:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:15:21] [config] transformer-depth-scaling: false
[2023-07-05 13:15:21] [config] transformer-dim-aan: 2048
[2023-07-05 13:15:21] [config] transformer-dim-ffn: 2048
[2023-07-05 13:15:21] [config] transformer-dropout: 0
[2023-07-05 13:15:21] [config] transformer-dropout-attention: 0
[2023-07-05 13:15:21] [config] transformer-dropout-ffn: 0
[2023-07-05 13:15:21] [config] transformer-ffn-activation: swish
[2023-07-05 13:15:21] [config] transformer-ffn-depth: 2
[2023-07-05 13:15:21] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:15:21] [config] transformer-heads: 8
[2023-07-05 13:15:21] [config] transformer-no-projection: false
[2023-07-05 13:15:21] [config] transformer-pool: false
[2023-07-05 13:15:21] [config] transformer-postprocess: dan
[2023-07-05 13:15:21] [config] transformer-postprocess-emb: d
[2023-07-05 13:15:21] [config] transformer-postprocess-top: ""
[2023-07-05 13:15:21] [config] transformer-preprocess: ""
[2023-07-05 13:15:21] [config] transformer-tied-layers:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] transformer-train-position-embeddings: false
[2023-07-05 13:15:21] [config] tsv: false
[2023-07-05 13:15:21] [config] tsv-fields: 0
[2023-07-05 13:15:21] [config] type: amun
[2023-07-05 13:15:21] [config] ulr: false
[2023-07-05 13:15:21] [config] ulr-dim-emb: 0
[2023-07-05 13:15:21] [config] ulr-dropout: 0
[2023-07-05 13:15:21] [config] ulr-keys-vectors: ""
[2023-07-05 13:15:21] [config] ulr-query-vectors: ""
[2023-07-05 13:15:21] [config] ulr-softmax-temperature: 1
[2023-07-05 13:15:21] [config] ulr-trainable-transformation: false
[2023-07-05 13:15:21] [config] unlikelihood-loss: false
[2023-07-05 13:15:21] [config] valid-freq: 50000000
[2023-07-05 13:15:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:15:21] [config] valid-max-length: 1000
[2023-07-05 13:15:21] [config] valid-metrics:
[2023-07-05 13:15:21] [config]   - cross-entropy
[2023-07-05 13:15:21] [config]   - translation
[2023-07-05 13:15:21] [config] valid-mini-batch: 32
[2023-07-05 13:15:21] [config] valid-reset-stalled: false
[2023-07-05 13:15:21] [config] valid-script-args:
[2023-07-05 13:15:21] [config]   []
[2023-07-05 13:15:21] [config] valid-script-path: ""
[2023-07-05 13:15:21] [config] valid-sets:
[2023-07-05 13:15:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:15:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:15:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:15:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:21] [config] vocabs:
[2023-07-05 13:15:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:21] [config] word-penalty: 0
[2023-07-05 13:15:21] [config] word-scores: false
[2023-07-05 13:15:21] [config] workspace: 2048
[2023-07-05 13:15:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:21] [training] Using single-device training
[2023-07-05 13:15:24] Synced seed 1234
[2023-07-05 13:15:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:24] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:15:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:24] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:15:24] [valid] No post-processing script given for validating translator
[2023-07-05 13:15:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:24] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:15:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:15:25] [comm] Using global sharding
[2023-07-05 13:15:25] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:15:25] [training] Using 1 GPUs
[2023-07-05 13:15:25] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:26] Loading Adam parameters
[2023-07-05 13:15:27] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:15:27] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:15:27] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:15:27] [data] Shuffling data
[2023-07-05 13:15:27] [data] Done reading 20,192 sentences
[2023-07-05 13:15:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:27] Training started
[2023-07-05 13:15:27] Training finished
[2023-07-05 13:15:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:31] [marian] Running on node22.datos.cluster.uy as process 20907 with command line:
[2023-07-05 13:15:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:15:31] [config] after: 0e
[2023-07-05 13:15:31] [config] after-batches: 0
[2023-07-05 13:15:31] [config] after-epochs: 180
[2023-07-05 13:15:31] [config] all-caps-every: 0
[2023-07-05 13:15:31] [config] allow-unk: false
[2023-07-05 13:15:31] [config] authors: false
[2023-07-05 13:15:31] [config] beam-size: 12
[2023-07-05 13:15:31] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:15:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:15:31] [config] bert-masking-fraction: 0.15
[2023-07-05 13:15:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:15:31] [config] bert-train-type-embeddings: true
[2023-07-05 13:15:31] [config] bert-type-vocab-size: 2
[2023-07-05 13:15:31] [config] build-info: ""
[2023-07-05 13:15:31] [config] check-gradient-nan: false
[2023-07-05 13:15:31] [config] check-nan: false
[2023-07-05 13:15:31] [config] cite: false
[2023-07-05 13:15:31] [config] clip-norm: 1
[2023-07-05 13:15:31] [config] cost-scaling:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] cost-type: ce-sum
[2023-07-05 13:15:31] [config] cpu-threads: 0
[2023-07-05 13:15:31] [config] data-threads: 8
[2023-07-05 13:15:31] [config] data-weighting: ""
[2023-07-05 13:15:31] [config] data-weighting-type: sentence
[2023-07-05 13:15:31] [config] dec-cell: gru
[2023-07-05 13:15:31] [config] dec-cell-base-depth: 2
[2023-07-05 13:15:31] [config] dec-cell-high-depth: 1
[2023-07-05 13:15:31] [config] dec-depth: 1
[2023-07-05 13:15:31] [config] devices:
[2023-07-05 13:15:31] [config]   - 0
[2023-07-05 13:15:31] [config] dim-emb: 512
[2023-07-05 13:15:31] [config] dim-rnn: 1024
[2023-07-05 13:15:31] [config] dim-vocabs:
[2023-07-05 13:15:31] [config]   - 36507
[2023-07-05 13:15:31] [config]   - 54042
[2023-07-05 13:15:31] [config] disp-first: 0
[2023-07-05 13:15:31] [config] disp-freq: 1000u
[2023-07-05 13:15:31] [config] disp-label-counts: true
[2023-07-05 13:15:31] [config] dropout-rnn: 0
[2023-07-05 13:15:31] [config] dropout-src: 0
[2023-07-05 13:15:31] [config] dropout-trg: 0
[2023-07-05 13:15:31] [config] dump-config: ""
[2023-07-05 13:15:31] [config] dynamic-gradient-scaling:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] early-stopping: 10
[2023-07-05 13:15:31] [config] early-stopping-on: first
[2023-07-05 13:15:31] [config] embedding-fix-src: false
[2023-07-05 13:15:31] [config] embedding-fix-trg: false
[2023-07-05 13:15:31] [config] embedding-normalization: false
[2023-07-05 13:15:31] [config] embedding-vectors:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] enc-cell: gru
[2023-07-05 13:15:31] [config] enc-cell-depth: 1
[2023-07-05 13:15:31] [config] enc-depth: 1
[2023-07-05 13:15:31] [config] enc-type: bidirectional
[2023-07-05 13:15:31] [config] english-title-case-every: 0
[2023-07-05 13:15:31] [config] exponential-smoothing: 0
[2023-07-05 13:15:31] [config] factor-weight: 1
[2023-07-05 13:15:31] [config] factors-combine: sum
[2023-07-05 13:15:31] [config] factors-dim-emb: 0
[2023-07-05 13:15:31] [config] gradient-checkpointing: false
[2023-07-05 13:15:31] [config] gradient-norm-average-window: 100
[2023-07-05 13:15:31] [config] guided-alignment: none
[2023-07-05 13:15:31] [config] guided-alignment-cost: mse
[2023-07-05 13:15:31] [config] guided-alignment-weight: 0.1
[2023-07-05 13:15:31] [config] ignore-model-config: false
[2023-07-05 13:15:31] [config] input-types:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] interpolate-env-vars: false
[2023-07-05 13:15:31] [config] keep-best: false
[2023-07-05 13:15:31] [config] label-smoothing: 0
[2023-07-05 13:15:31] [config] layer-normalization: false
[2023-07-05 13:15:31] [config] learn-rate: 0.0001
[2023-07-05 13:15:31] [config] lemma-dependency: ""
[2023-07-05 13:15:31] [config] lemma-dim-emb: 0
[2023-07-05 13:15:31] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:15:31] [config] log-level: info
[2023-07-05 13:15:31] [config] log-time-zone: ""
[2023-07-05 13:15:31] [config] logical-epoch:
[2023-07-05 13:15:31] [config]   - 1e
[2023-07-05 13:15:31] [config]   - 0
[2023-07-05 13:15:31] [config] lr-decay: 0
[2023-07-05 13:15:31] [config] lr-decay-freq: 50000
[2023-07-05 13:15:31] [config] lr-decay-inv-sqrt:
[2023-07-05 13:15:31] [config]   - 0
[2023-07-05 13:15:31] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:15:31] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:15:31] [config] lr-decay-start:
[2023-07-05 13:15:31] [config]   - 10
[2023-07-05 13:15:31] [config]   - 1
[2023-07-05 13:15:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:15:31] [config] lr-report: false
[2023-07-05 13:15:31] [config] lr-warmup: 0
[2023-07-05 13:15:31] [config] lr-warmup-at-reload: false
[2023-07-05 13:15:31] [config] lr-warmup-cycle: false
[2023-07-05 13:15:31] [config] lr-warmup-start-rate: 0
[2023-07-05 13:15:31] [config] max-length: 50
[2023-07-05 13:15:31] [config] max-length-crop: false
[2023-07-05 13:15:31] [config] max-length-factor: 3
[2023-07-05 13:15:31] [config] maxi-batch: 100
[2023-07-05 13:15:31] [config] maxi-batch-sort: trg
[2023-07-05 13:15:31] [config] mini-batch: 64
[2023-07-05 13:15:31] [config] mini-batch-fit: false
[2023-07-05 13:15:31] [config] mini-batch-fit-step: 10
[2023-07-05 13:15:31] [config] mini-batch-round-up: true
[2023-07-05 13:15:31] [config] mini-batch-track-lr: false
[2023-07-05 13:15:31] [config] mini-batch-warmup: 0
[2023-07-05 13:15:31] [config] mini-batch-words: 0
[2023-07-05 13:15:31] [config] mini-batch-words-ref: 0
[2023-07-05 13:15:31] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:31] [config] multi-loss-type: sum
[2023-07-05 13:15:31] [config] n-best: false
[2023-07-05 13:15:31] [config] no-nccl: false
[2023-07-05 13:15:31] [config] no-reload: false
[2023-07-05 13:15:31] [config] no-restore-corpus: false
[2023-07-05 13:15:31] [config] normalize: 0
[2023-07-05 13:15:31] [config] normalize-gradient: false
[2023-07-05 13:15:31] [config] num-devices: 0
[2023-07-05 13:15:31] [config] optimizer: adam
[2023-07-05 13:15:31] [config] optimizer-delay: 1
[2023-07-05 13:15:31] [config] optimizer-params:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] output-omit-bias: false
[2023-07-05 13:15:31] [config] overwrite: true
[2023-07-05 13:15:31] [config] precision:
[2023-07-05 13:15:31] [config]   - float32
[2023-07-05 13:15:31] [config]   - float32
[2023-07-05 13:15:31] [config] pretrained-model: ""
[2023-07-05 13:15:31] [config] quantize-biases: false
[2023-07-05 13:15:31] [config] quantize-bits: 0
[2023-07-05 13:15:31] [config] quantize-log-based: false
[2023-07-05 13:15:31] [config] quantize-optimization-steps: 0
[2023-07-05 13:15:31] [config] quiet: false
[2023-07-05 13:15:31] [config] quiet-translation: true
[2023-07-05 13:15:31] [config] relative-paths: false
[2023-07-05 13:15:31] [config] right-left: false
[2023-07-05 13:15:31] [config] save-freq: 10000u
[2023-07-05 13:15:31] [config] seed: 1234
[2023-07-05 13:15:31] [config] sentencepiece-alphas:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:15:31] [config] sentencepiece-options: ""
[2023-07-05 13:15:31] [config] sharding: global
[2023-07-05 13:15:31] [config] shuffle: data
[2023-07-05 13:15:31] [config] shuffle-in-ram: false
[2023-07-05 13:15:31] [config] sigterm: save-and-exit
[2023-07-05 13:15:31] [config] skip: false
[2023-07-05 13:15:31] [config] sqlite: ""
[2023-07-05 13:15:31] [config] sqlite-drop: false
[2023-07-05 13:15:31] [config] sync-freq: 200u
[2023-07-05 13:15:31] [config] sync-sgd: false
[2023-07-05 13:15:31] [config] tempdir: /tmp
[2023-07-05 13:15:31] [config] tied-embeddings: false
[2023-07-05 13:15:31] [config] tied-embeddings-all: false
[2023-07-05 13:15:31] [config] tied-embeddings-src: false
[2023-07-05 13:15:31] [config] train-embedder-rank:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] train-sets:
[2023-07-05 13:15:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:15:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:15:31] [config] transformer-aan-activation: swish
[2023-07-05 13:15:31] [config] transformer-aan-depth: 2
[2023-07-05 13:15:31] [config] transformer-aan-nogate: false
[2023-07-05 13:15:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:15:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:15:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:15:31] [config] transformer-depth-scaling: false
[2023-07-05 13:15:31] [config] transformer-dim-aan: 2048
[2023-07-05 13:15:31] [config] transformer-dim-ffn: 2048
[2023-07-05 13:15:31] [config] transformer-dropout: 0
[2023-07-05 13:15:31] [config] transformer-dropout-attention: 0
[2023-07-05 13:15:31] [config] transformer-dropout-ffn: 0
[2023-07-05 13:15:31] [config] transformer-ffn-activation: swish
[2023-07-05 13:15:31] [config] transformer-ffn-depth: 2
[2023-07-05 13:15:31] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:15:31] [config] transformer-heads: 8
[2023-07-05 13:15:31] [config] transformer-no-projection: false
[2023-07-05 13:15:31] [config] transformer-pool: false
[2023-07-05 13:15:31] [config] transformer-postprocess: dan
[2023-07-05 13:15:31] [config] transformer-postprocess-emb: d
[2023-07-05 13:15:31] [config] transformer-postprocess-top: ""
[2023-07-05 13:15:31] [config] transformer-preprocess: ""
[2023-07-05 13:15:31] [config] transformer-tied-layers:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] transformer-train-position-embeddings: false
[2023-07-05 13:15:31] [config] tsv: false
[2023-07-05 13:15:31] [config] tsv-fields: 0
[2023-07-05 13:15:31] [config] type: amun
[2023-07-05 13:15:31] [config] ulr: false
[2023-07-05 13:15:31] [config] ulr-dim-emb: 0
[2023-07-05 13:15:31] [config] ulr-dropout: 0
[2023-07-05 13:15:31] [config] ulr-keys-vectors: ""
[2023-07-05 13:15:31] [config] ulr-query-vectors: ""
[2023-07-05 13:15:31] [config] ulr-softmax-temperature: 1
[2023-07-05 13:15:31] [config] ulr-trainable-transformation: false
[2023-07-05 13:15:31] [config] unlikelihood-loss: false
[2023-07-05 13:15:31] [config] valid-freq: 50000000
[2023-07-05 13:15:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:15:31] [config] valid-max-length: 1000
[2023-07-05 13:15:31] [config] valid-metrics:
[2023-07-05 13:15:31] [config]   - cross-entropy
[2023-07-05 13:15:31] [config]   - translation
[2023-07-05 13:15:31] [config] valid-mini-batch: 32
[2023-07-05 13:15:31] [config] valid-reset-stalled: false
[2023-07-05 13:15:31] [config] valid-script-args:
[2023-07-05 13:15:31] [config]   []
[2023-07-05 13:15:31] [config] valid-script-path: ""
[2023-07-05 13:15:31] [config] valid-sets:
[2023-07-05 13:15:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:15:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:15:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:15:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:31] [config] vocabs:
[2023-07-05 13:15:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:31] [config] word-penalty: 0
[2023-07-05 13:15:31] [config] word-scores: false
[2023-07-05 13:15:31] [config] workspace: 2048
[2023-07-05 13:15:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:31] [training] Using single-device training
[2023-07-05 13:15:31] Synced seed 1234
[2023-07-05 13:15:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:31] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:15:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:31] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:15:32] [valid] No post-processing script given for validating translator
[2023-07-05 13:15:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:32] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:15:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:15:32] [comm] Using global sharding
[2023-07-05 13:15:32] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:15:32] [training] Using 1 GPUs
[2023-07-05 13:15:32] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:34] Loading Adam parameters
[2023-07-05 13:15:35] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:15:35] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:15:35] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:15:35] [data] Shuffling data
[2023-07-05 13:15:35] [data] Done reading 20,192 sentences
[2023-07-05 13:15:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:35] Training started
[2023-07-05 13:15:35] Training finished
[2023-07-05 13:15:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:39] [marian] Running on node22.datos.cluster.uy as process 21076 with command line:
[2023-07-05 13:15:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:15:39] [config] after: 0e
[2023-07-05 13:15:39] [config] after-batches: 0
[2023-07-05 13:15:39] [config] after-epochs: 190
[2023-07-05 13:15:39] [config] all-caps-every: 0
[2023-07-05 13:15:39] [config] allow-unk: false
[2023-07-05 13:15:39] [config] authors: false
[2023-07-05 13:15:39] [config] beam-size: 12
[2023-07-05 13:15:39] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:15:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:15:39] [config] bert-masking-fraction: 0.15
[2023-07-05 13:15:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:15:39] [config] bert-train-type-embeddings: true
[2023-07-05 13:15:39] [config] bert-type-vocab-size: 2
[2023-07-05 13:15:39] [config] build-info: ""
[2023-07-05 13:15:39] [config] check-gradient-nan: false
[2023-07-05 13:15:39] [config] check-nan: false
[2023-07-05 13:15:39] [config] cite: false
[2023-07-05 13:15:39] [config] clip-norm: 1
[2023-07-05 13:15:39] [config] cost-scaling:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] cost-type: ce-sum
[2023-07-05 13:15:39] [config] cpu-threads: 0
[2023-07-05 13:15:39] [config] data-threads: 8
[2023-07-05 13:15:39] [config] data-weighting: ""
[2023-07-05 13:15:39] [config] data-weighting-type: sentence
[2023-07-05 13:15:39] [config] dec-cell: gru
[2023-07-05 13:15:39] [config] dec-cell-base-depth: 2
[2023-07-05 13:15:39] [config] dec-cell-high-depth: 1
[2023-07-05 13:15:39] [config] dec-depth: 1
[2023-07-05 13:15:39] [config] devices:
[2023-07-05 13:15:39] [config]   - 0
[2023-07-05 13:15:39] [config] dim-emb: 512
[2023-07-05 13:15:39] [config] dim-rnn: 1024
[2023-07-05 13:15:39] [config] dim-vocabs:
[2023-07-05 13:15:39] [config]   - 36507
[2023-07-05 13:15:39] [config]   - 54042
[2023-07-05 13:15:39] [config] disp-first: 0
[2023-07-05 13:15:39] [config] disp-freq: 1000u
[2023-07-05 13:15:39] [config] disp-label-counts: true
[2023-07-05 13:15:39] [config] dropout-rnn: 0
[2023-07-05 13:15:39] [config] dropout-src: 0
[2023-07-05 13:15:39] [config] dropout-trg: 0
[2023-07-05 13:15:39] [config] dump-config: ""
[2023-07-05 13:15:39] [config] dynamic-gradient-scaling:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] early-stopping: 10
[2023-07-05 13:15:39] [config] early-stopping-on: first
[2023-07-05 13:15:39] [config] embedding-fix-src: false
[2023-07-05 13:15:39] [config] embedding-fix-trg: false
[2023-07-05 13:15:39] [config] embedding-normalization: false
[2023-07-05 13:15:39] [config] embedding-vectors:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] enc-cell: gru
[2023-07-05 13:15:39] [config] enc-cell-depth: 1
[2023-07-05 13:15:39] [config] enc-depth: 1
[2023-07-05 13:15:39] [config] enc-type: bidirectional
[2023-07-05 13:15:39] [config] english-title-case-every: 0
[2023-07-05 13:15:39] [config] exponential-smoothing: 0
[2023-07-05 13:15:39] [config] factor-weight: 1
[2023-07-05 13:15:39] [config] factors-combine: sum
[2023-07-05 13:15:39] [config] factors-dim-emb: 0
[2023-07-05 13:15:39] [config] gradient-checkpointing: false
[2023-07-05 13:15:39] [config] gradient-norm-average-window: 100
[2023-07-05 13:15:39] [config] guided-alignment: none
[2023-07-05 13:15:39] [config] guided-alignment-cost: mse
[2023-07-05 13:15:39] [config] guided-alignment-weight: 0.1
[2023-07-05 13:15:39] [config] ignore-model-config: false
[2023-07-05 13:15:39] [config] input-types:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] interpolate-env-vars: false
[2023-07-05 13:15:39] [config] keep-best: false
[2023-07-05 13:15:39] [config] label-smoothing: 0
[2023-07-05 13:15:39] [config] layer-normalization: false
[2023-07-05 13:15:39] [config] learn-rate: 0.0001
[2023-07-05 13:15:39] [config] lemma-dependency: ""
[2023-07-05 13:15:39] [config] lemma-dim-emb: 0
[2023-07-05 13:15:39] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:15:39] [config] log-level: info
[2023-07-05 13:15:39] [config] log-time-zone: ""
[2023-07-05 13:15:39] [config] logical-epoch:
[2023-07-05 13:15:39] [config]   - 1e
[2023-07-05 13:15:39] [config]   - 0
[2023-07-05 13:15:39] [config] lr-decay: 0
[2023-07-05 13:15:39] [config] lr-decay-freq: 50000
[2023-07-05 13:15:39] [config] lr-decay-inv-sqrt:
[2023-07-05 13:15:39] [config]   - 0
[2023-07-05 13:15:39] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:15:39] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:15:39] [config] lr-decay-start:
[2023-07-05 13:15:39] [config]   - 10
[2023-07-05 13:15:39] [config]   - 1
[2023-07-05 13:15:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:15:39] [config] lr-report: false
[2023-07-05 13:15:39] [config] lr-warmup: 0
[2023-07-05 13:15:39] [config] lr-warmup-at-reload: false
[2023-07-05 13:15:39] [config] lr-warmup-cycle: false
[2023-07-05 13:15:39] [config] lr-warmup-start-rate: 0
[2023-07-05 13:15:39] [config] max-length: 50
[2023-07-05 13:15:39] [config] max-length-crop: false
[2023-07-05 13:15:39] [config] max-length-factor: 3
[2023-07-05 13:15:39] [config] maxi-batch: 100
[2023-07-05 13:15:39] [config] maxi-batch-sort: trg
[2023-07-05 13:15:39] [config] mini-batch: 64
[2023-07-05 13:15:39] [config] mini-batch-fit: false
[2023-07-05 13:15:39] [config] mini-batch-fit-step: 10
[2023-07-05 13:15:39] [config] mini-batch-round-up: true
[2023-07-05 13:15:39] [config] mini-batch-track-lr: false
[2023-07-05 13:15:39] [config] mini-batch-warmup: 0
[2023-07-05 13:15:39] [config] mini-batch-words: 0
[2023-07-05 13:15:39] [config] mini-batch-words-ref: 0
[2023-07-05 13:15:39] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:39] [config] multi-loss-type: sum
[2023-07-05 13:15:39] [config] n-best: false
[2023-07-05 13:15:39] [config] no-nccl: false
[2023-07-05 13:15:39] [config] no-reload: false
[2023-07-05 13:15:39] [config] no-restore-corpus: false
[2023-07-05 13:15:39] [config] normalize: 0
[2023-07-05 13:15:39] [config] normalize-gradient: false
[2023-07-05 13:15:39] [config] num-devices: 0
[2023-07-05 13:15:39] [config] optimizer: adam
[2023-07-05 13:15:39] [config] optimizer-delay: 1
[2023-07-05 13:15:39] [config] optimizer-params:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] output-omit-bias: false
[2023-07-05 13:15:39] [config] overwrite: true
[2023-07-05 13:15:39] [config] precision:
[2023-07-05 13:15:39] [config]   - float32
[2023-07-05 13:15:39] [config]   - float32
[2023-07-05 13:15:39] [config] pretrained-model: ""
[2023-07-05 13:15:39] [config] quantize-biases: false
[2023-07-05 13:15:39] [config] quantize-bits: 0
[2023-07-05 13:15:39] [config] quantize-log-based: false
[2023-07-05 13:15:39] [config] quantize-optimization-steps: 0
[2023-07-05 13:15:39] [config] quiet: false
[2023-07-05 13:15:39] [config] quiet-translation: true
[2023-07-05 13:15:39] [config] relative-paths: false
[2023-07-05 13:15:39] [config] right-left: false
[2023-07-05 13:15:39] [config] save-freq: 10000u
[2023-07-05 13:15:39] [config] seed: 1234
[2023-07-05 13:15:39] [config] sentencepiece-alphas:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:15:39] [config] sentencepiece-options: ""
[2023-07-05 13:15:39] [config] sharding: global
[2023-07-05 13:15:39] [config] shuffle: data
[2023-07-05 13:15:39] [config] shuffle-in-ram: false
[2023-07-05 13:15:39] [config] sigterm: save-and-exit
[2023-07-05 13:15:39] [config] skip: false
[2023-07-05 13:15:39] [config] sqlite: ""
[2023-07-05 13:15:39] [config] sqlite-drop: false
[2023-07-05 13:15:39] [config] sync-freq: 200u
[2023-07-05 13:15:39] [config] sync-sgd: false
[2023-07-05 13:15:39] [config] tempdir: /tmp
[2023-07-05 13:15:39] [config] tied-embeddings: false
[2023-07-05 13:15:39] [config] tied-embeddings-all: false
[2023-07-05 13:15:39] [config] tied-embeddings-src: false
[2023-07-05 13:15:39] [config] train-embedder-rank:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] train-sets:
[2023-07-05 13:15:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:15:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:15:39] [config] transformer-aan-activation: swish
[2023-07-05 13:15:39] [config] transformer-aan-depth: 2
[2023-07-05 13:15:39] [config] transformer-aan-nogate: false
[2023-07-05 13:15:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:15:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:15:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:15:39] [config] transformer-depth-scaling: false
[2023-07-05 13:15:39] [config] transformer-dim-aan: 2048
[2023-07-05 13:15:39] [config] transformer-dim-ffn: 2048
[2023-07-05 13:15:39] [config] transformer-dropout: 0
[2023-07-05 13:15:39] [config] transformer-dropout-attention: 0
[2023-07-05 13:15:39] [config] transformer-dropout-ffn: 0
[2023-07-05 13:15:39] [config] transformer-ffn-activation: swish
[2023-07-05 13:15:39] [config] transformer-ffn-depth: 2
[2023-07-05 13:15:39] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:15:39] [config] transformer-heads: 8
[2023-07-05 13:15:39] [config] transformer-no-projection: false
[2023-07-05 13:15:39] [config] transformer-pool: false
[2023-07-05 13:15:39] [config] transformer-postprocess: dan
[2023-07-05 13:15:39] [config] transformer-postprocess-emb: d
[2023-07-05 13:15:39] [config] transformer-postprocess-top: ""
[2023-07-05 13:15:39] [config] transformer-preprocess: ""
[2023-07-05 13:15:39] [config] transformer-tied-layers:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] transformer-train-position-embeddings: false
[2023-07-05 13:15:39] [config] tsv: false
[2023-07-05 13:15:39] [config] tsv-fields: 0
[2023-07-05 13:15:39] [config] type: amun
[2023-07-05 13:15:39] [config] ulr: false
[2023-07-05 13:15:39] [config] ulr-dim-emb: 0
[2023-07-05 13:15:39] [config] ulr-dropout: 0
[2023-07-05 13:15:39] [config] ulr-keys-vectors: ""
[2023-07-05 13:15:39] [config] ulr-query-vectors: ""
[2023-07-05 13:15:39] [config] ulr-softmax-temperature: 1
[2023-07-05 13:15:39] [config] ulr-trainable-transformation: false
[2023-07-05 13:15:39] [config] unlikelihood-loss: false
[2023-07-05 13:15:39] [config] valid-freq: 50000000
[2023-07-05 13:15:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:15:39] [config] valid-max-length: 1000
[2023-07-05 13:15:39] [config] valid-metrics:
[2023-07-05 13:15:39] [config]   - cross-entropy
[2023-07-05 13:15:39] [config]   - translation
[2023-07-05 13:15:39] [config] valid-mini-batch: 32
[2023-07-05 13:15:39] [config] valid-reset-stalled: false
[2023-07-05 13:15:39] [config] valid-script-args:
[2023-07-05 13:15:39] [config]   []
[2023-07-05 13:15:39] [config] valid-script-path: ""
[2023-07-05 13:15:39] [config] valid-sets:
[2023-07-05 13:15:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:15:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:15:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:15:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:39] [config] vocabs:
[2023-07-05 13:15:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:39] [config] word-penalty: 0
[2023-07-05 13:15:39] [config] word-scores: false
[2023-07-05 13:15:39] [config] workspace: 2048
[2023-07-05 13:15:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:39] [training] Using single-device training
[2023-07-05 13:15:39] Synced seed 1234
[2023-07-05 13:15:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:39] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:15:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:39] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:15:39] [valid] No post-processing script given for validating translator
[2023-07-05 13:15:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:40] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:15:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:15:40] [comm] Using global sharding
[2023-07-05 13:15:40] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:15:40] [training] Using 1 GPUs
[2023-07-05 13:15:40] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:42] Loading Adam parameters
[2023-07-05 13:15:42] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:15:42] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:15:43] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:15:43] [data] Shuffling data
[2023-07-05 13:15:43] [data] Done reading 20,192 sentences
[2023-07-05 13:15:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:43] Training started
[2023-07-05 13:15:43] Training finished
[2023-07-05 13:15:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:46] [marian] Running on node22.datos.cluster.uy as process 21234 with command line:
[2023-07-05 13:15:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type amun
[2023-07-05 13:15:46] [config] after: 0e
[2023-07-05 13:15:46] [config] after-batches: 0
[2023-07-05 13:15:46] [config] after-epochs: 200
[2023-07-05 13:15:46] [config] all-caps-every: 0
[2023-07-05 13:15:46] [config] allow-unk: false
[2023-07-05 13:15:46] [config] authors: false
[2023-07-05 13:15:46] [config] beam-size: 12
[2023-07-05 13:15:46] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:15:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:15:46] [config] bert-masking-fraction: 0.15
[2023-07-05 13:15:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:15:46] [config] bert-train-type-embeddings: true
[2023-07-05 13:15:46] [config] bert-type-vocab-size: 2
[2023-07-05 13:15:46] [config] build-info: ""
[2023-07-05 13:15:46] [config] check-gradient-nan: false
[2023-07-05 13:15:46] [config] check-nan: false
[2023-07-05 13:15:46] [config] cite: false
[2023-07-05 13:15:46] [config] clip-norm: 1
[2023-07-05 13:15:46] [config] cost-scaling:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] cost-type: ce-sum
[2023-07-05 13:15:46] [config] cpu-threads: 0
[2023-07-05 13:15:46] [config] data-threads: 8
[2023-07-05 13:15:46] [config] data-weighting: ""
[2023-07-05 13:15:46] [config] data-weighting-type: sentence
[2023-07-05 13:15:46] [config] dec-cell: gru
[2023-07-05 13:15:46] [config] dec-cell-base-depth: 2
[2023-07-05 13:15:46] [config] dec-cell-high-depth: 1
[2023-07-05 13:15:46] [config] dec-depth: 1
[2023-07-05 13:15:46] [config] devices:
[2023-07-05 13:15:46] [config]   - 0
[2023-07-05 13:15:46] [config] dim-emb: 512
[2023-07-05 13:15:46] [config] dim-rnn: 1024
[2023-07-05 13:15:46] [config] dim-vocabs:
[2023-07-05 13:15:46] [config]   - 36507
[2023-07-05 13:15:46] [config]   - 54042
[2023-07-05 13:15:46] [config] disp-first: 0
[2023-07-05 13:15:46] [config] disp-freq: 1000u
[2023-07-05 13:15:46] [config] disp-label-counts: true
[2023-07-05 13:15:46] [config] dropout-rnn: 0
[2023-07-05 13:15:46] [config] dropout-src: 0
[2023-07-05 13:15:46] [config] dropout-trg: 0
[2023-07-05 13:15:46] [config] dump-config: ""
[2023-07-05 13:15:46] [config] dynamic-gradient-scaling:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] early-stopping: 10
[2023-07-05 13:15:46] [config] early-stopping-on: first
[2023-07-05 13:15:46] [config] embedding-fix-src: false
[2023-07-05 13:15:46] [config] embedding-fix-trg: false
[2023-07-05 13:15:46] [config] embedding-normalization: false
[2023-07-05 13:15:46] [config] embedding-vectors:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] enc-cell: gru
[2023-07-05 13:15:46] [config] enc-cell-depth: 1
[2023-07-05 13:15:46] [config] enc-depth: 1
[2023-07-05 13:15:46] [config] enc-type: bidirectional
[2023-07-05 13:15:46] [config] english-title-case-every: 0
[2023-07-05 13:15:46] [config] exponential-smoothing: 0
[2023-07-05 13:15:46] [config] factor-weight: 1
[2023-07-05 13:15:46] [config] factors-combine: sum
[2023-07-05 13:15:46] [config] factors-dim-emb: 0
[2023-07-05 13:15:46] [config] gradient-checkpointing: false
[2023-07-05 13:15:46] [config] gradient-norm-average-window: 100
[2023-07-05 13:15:46] [config] guided-alignment: none
[2023-07-05 13:15:46] [config] guided-alignment-cost: mse
[2023-07-05 13:15:46] [config] guided-alignment-weight: 0.1
[2023-07-05 13:15:46] [config] ignore-model-config: false
[2023-07-05 13:15:46] [config] input-types:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] interpolate-env-vars: false
[2023-07-05 13:15:46] [config] keep-best: false
[2023-07-05 13:15:46] [config] label-smoothing: 0
[2023-07-05 13:15:46] [config] layer-normalization: false
[2023-07-05 13:15:46] [config] learn-rate: 0.0001
[2023-07-05 13:15:46] [config] lemma-dependency: ""
[2023-07-05 13:15:46] [config] lemma-dim-emb: 0
[2023-07-05 13:15:46] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:15:46] [config] log-level: info
[2023-07-05 13:15:46] [config] log-time-zone: ""
[2023-07-05 13:15:46] [config] logical-epoch:
[2023-07-05 13:15:46] [config]   - 1e
[2023-07-05 13:15:46] [config]   - 0
[2023-07-05 13:15:46] [config] lr-decay: 0
[2023-07-05 13:15:46] [config] lr-decay-freq: 50000
[2023-07-05 13:15:46] [config] lr-decay-inv-sqrt:
[2023-07-05 13:15:46] [config]   - 0
[2023-07-05 13:15:46] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:15:46] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:15:46] [config] lr-decay-start:
[2023-07-05 13:15:46] [config]   - 10
[2023-07-05 13:15:46] [config]   - 1
[2023-07-05 13:15:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:15:46] [config] lr-report: false
[2023-07-05 13:15:46] [config] lr-warmup: 0
[2023-07-05 13:15:46] [config] lr-warmup-at-reload: false
[2023-07-05 13:15:46] [config] lr-warmup-cycle: false
[2023-07-05 13:15:46] [config] lr-warmup-start-rate: 0
[2023-07-05 13:15:46] [config] max-length: 50
[2023-07-05 13:15:46] [config] max-length-crop: false
[2023-07-05 13:15:46] [config] max-length-factor: 3
[2023-07-05 13:15:46] [config] maxi-batch: 100
[2023-07-05 13:15:46] [config] maxi-batch-sort: trg
[2023-07-05 13:15:46] [config] mini-batch: 64
[2023-07-05 13:15:46] [config] mini-batch-fit: false
[2023-07-05 13:15:46] [config] mini-batch-fit-step: 10
[2023-07-05 13:15:46] [config] mini-batch-round-up: true
[2023-07-05 13:15:46] [config] mini-batch-track-lr: false
[2023-07-05 13:15:46] [config] mini-batch-warmup: 0
[2023-07-05 13:15:46] [config] mini-batch-words: 0
[2023-07-05 13:15:46] [config] mini-batch-words-ref: 0
[2023-07-05 13:15:46] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:46] [config] multi-loss-type: sum
[2023-07-05 13:15:46] [config] n-best: false
[2023-07-05 13:15:46] [config] no-nccl: false
[2023-07-05 13:15:46] [config] no-reload: false
[2023-07-05 13:15:46] [config] no-restore-corpus: false
[2023-07-05 13:15:46] [config] normalize: 0
[2023-07-05 13:15:46] [config] normalize-gradient: false
[2023-07-05 13:15:46] [config] num-devices: 0
[2023-07-05 13:15:46] [config] optimizer: adam
[2023-07-05 13:15:46] [config] optimizer-delay: 1
[2023-07-05 13:15:46] [config] optimizer-params:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] output-omit-bias: false
[2023-07-05 13:15:46] [config] overwrite: true
[2023-07-05 13:15:46] [config] precision:
[2023-07-05 13:15:46] [config]   - float32
[2023-07-05 13:15:46] [config]   - float32
[2023-07-05 13:15:46] [config] pretrained-model: ""
[2023-07-05 13:15:46] [config] quantize-biases: false
[2023-07-05 13:15:46] [config] quantize-bits: 0
[2023-07-05 13:15:46] [config] quantize-log-based: false
[2023-07-05 13:15:46] [config] quantize-optimization-steps: 0
[2023-07-05 13:15:46] [config] quiet: false
[2023-07-05 13:15:46] [config] quiet-translation: true
[2023-07-05 13:15:46] [config] relative-paths: false
[2023-07-05 13:15:46] [config] right-left: false
[2023-07-05 13:15:46] [config] save-freq: 10000u
[2023-07-05 13:15:46] [config] seed: 1234
[2023-07-05 13:15:46] [config] sentencepiece-alphas:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:15:46] [config] sentencepiece-options: ""
[2023-07-05 13:15:46] [config] sharding: global
[2023-07-05 13:15:46] [config] shuffle: data
[2023-07-05 13:15:46] [config] shuffle-in-ram: false
[2023-07-05 13:15:46] [config] sigterm: save-and-exit
[2023-07-05 13:15:46] [config] skip: false
[2023-07-05 13:15:46] [config] sqlite: ""
[2023-07-05 13:15:46] [config] sqlite-drop: false
[2023-07-05 13:15:46] [config] sync-freq: 200u
[2023-07-05 13:15:46] [config] sync-sgd: false
[2023-07-05 13:15:46] [config] tempdir: /tmp
[2023-07-05 13:15:46] [config] tied-embeddings: false
[2023-07-05 13:15:46] [config] tied-embeddings-all: false
[2023-07-05 13:15:46] [config] tied-embeddings-src: false
[2023-07-05 13:15:46] [config] train-embedder-rank:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] train-sets:
[2023-07-05 13:15:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:15:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:15:46] [config] transformer-aan-activation: swish
[2023-07-05 13:15:46] [config] transformer-aan-depth: 2
[2023-07-05 13:15:46] [config] transformer-aan-nogate: false
[2023-07-05 13:15:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:15:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:15:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:15:46] [config] transformer-depth-scaling: false
[2023-07-05 13:15:46] [config] transformer-dim-aan: 2048
[2023-07-05 13:15:46] [config] transformer-dim-ffn: 2048
[2023-07-05 13:15:46] [config] transformer-dropout: 0
[2023-07-05 13:15:46] [config] transformer-dropout-attention: 0
[2023-07-05 13:15:46] [config] transformer-dropout-ffn: 0
[2023-07-05 13:15:46] [config] transformer-ffn-activation: swish
[2023-07-05 13:15:46] [config] transformer-ffn-depth: 2
[2023-07-05 13:15:46] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:15:46] [config] transformer-heads: 8
[2023-07-05 13:15:46] [config] transformer-no-projection: false
[2023-07-05 13:15:46] [config] transformer-pool: false
[2023-07-05 13:15:46] [config] transformer-postprocess: dan
[2023-07-05 13:15:46] [config] transformer-postprocess-emb: d
[2023-07-05 13:15:46] [config] transformer-postprocess-top: ""
[2023-07-05 13:15:46] [config] transformer-preprocess: ""
[2023-07-05 13:15:46] [config] transformer-tied-layers:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] transformer-train-position-embeddings: false
[2023-07-05 13:15:46] [config] tsv: false
[2023-07-05 13:15:46] [config] tsv-fields: 0
[2023-07-05 13:15:46] [config] type: amun
[2023-07-05 13:15:46] [config] ulr: false
[2023-07-05 13:15:46] [config] ulr-dim-emb: 0
[2023-07-05 13:15:46] [config] ulr-dropout: 0
[2023-07-05 13:15:46] [config] ulr-keys-vectors: ""
[2023-07-05 13:15:46] [config] ulr-query-vectors: ""
[2023-07-05 13:15:46] [config] ulr-softmax-temperature: 1
[2023-07-05 13:15:46] [config] ulr-trainable-transformation: false
[2023-07-05 13:15:46] [config] unlikelihood-loss: false
[2023-07-05 13:15:46] [config] valid-freq: 50000000
[2023-07-05 13:15:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:15:46] [config] valid-max-length: 1000
[2023-07-05 13:15:46] [config] valid-metrics:
[2023-07-05 13:15:46] [config]   - cross-entropy
[2023-07-05 13:15:46] [config]   - translation
[2023-07-05 13:15:46] [config] valid-mini-batch: 32
[2023-07-05 13:15:46] [config] valid-reset-stalled: false
[2023-07-05 13:15:46] [config] valid-script-args:
[2023-07-05 13:15:46] [config]   []
[2023-07-05 13:15:46] [config] valid-script-path: ""
[2023-07-05 13:15:46] [config] valid-sets:
[2023-07-05 13:15:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:15:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:15:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:15:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:46] [config] vocabs:
[2023-07-05 13:15:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:46] [config] word-penalty: 0
[2023-07-05 13:15:46] [config] word-scores: false
[2023-07-05 13:15:46] [config] workspace: 2048
[2023-07-05 13:15:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:46] [training] Using single-device training
[2023-07-05 13:15:47] Synced seed 1234
[2023-07-05 13:15:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:47] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:15:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:47] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:15:47] [valid] No post-processing script given for validating translator
[2023-07-05 13:15:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:15:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:15:48] [comm] Using global sharding
[2023-07-05 13:15:48] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:15:48] [training] Using 1 GPUs
[2023-07-05 13:15:48] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz
[2023-07-05 13:15:50] Loading Adam parameters
[2023-07-05 13:15:50] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:15:50] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_amun.npz.optimizer.npz
[2023-07-05 13:15:50] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 13:15:50] [data] Shuffling data
[2023-07-05 13:15:50] [data] Done reading 20,192 sentences
[2023-07-05 13:15:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:50] Training started
[2023-07-05 13:15:50] Training finished
[2023-07-05 13:15:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:55] [marian] Running on node22.datos.cluster.uy as process 21421 with command line:
[2023-07-05 13:15:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 13:15:55] [config] after: 0e
[2023-07-05 13:15:55] [config] after-batches: 0
[2023-07-05 13:15:55] [config] after-epochs: 10
[2023-07-05 13:15:55] [config] all-caps-every: 0
[2023-07-05 13:15:55] [config] allow-unk: false
[2023-07-05 13:15:55] [config] authors: false
[2023-07-05 13:15:55] [config] beam-size: 12
[2023-07-05 13:15:55] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:15:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:15:55] [config] bert-masking-fraction: 0.15
[2023-07-05 13:15:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:15:55] [config] bert-train-type-embeddings: true
[2023-07-05 13:15:55] [config] bert-type-vocab-size: 2
[2023-07-05 13:15:55] [config] build-info: ""
[2023-07-05 13:15:55] [config] check-gradient-nan: false
[2023-07-05 13:15:55] [config] check-nan: false
[2023-07-05 13:15:55] [config] cite: false
[2023-07-05 13:15:55] [config] clip-norm: 1
[2023-07-05 13:15:55] [config] cost-scaling:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] cost-type: ce-sum
[2023-07-05 13:15:55] [config] cpu-threads: 0
[2023-07-05 13:15:55] [config] data-threads: 8
[2023-07-05 13:15:55] [config] data-weighting: ""
[2023-07-05 13:15:55] [config] data-weighting-type: sentence
[2023-07-05 13:15:55] [config] dec-cell: gru
[2023-07-05 13:15:55] [config] dec-cell-base-depth: 2
[2023-07-05 13:15:55] [config] dec-cell-high-depth: 1
[2023-07-05 13:15:55] [config] dec-depth: 1
[2023-07-05 13:15:55] [config] devices:
[2023-07-05 13:15:55] [config]   - 0
[2023-07-05 13:15:55] [config] dim-emb: 512
[2023-07-05 13:15:55] [config] dim-rnn: 1024
[2023-07-05 13:15:55] [config] dim-vocabs:
[2023-07-05 13:15:55] [config]   - 0
[2023-07-05 13:15:55] [config]   - 0
[2023-07-05 13:15:55] [config] disp-first: 0
[2023-07-05 13:15:55] [config] disp-freq: 1000u
[2023-07-05 13:15:55] [config] disp-label-counts: true
[2023-07-05 13:15:55] [config] dropout-rnn: 0
[2023-07-05 13:15:55] [config] dropout-src: 0
[2023-07-05 13:15:55] [config] dropout-trg: 0
[2023-07-05 13:15:55] [config] dump-config: ""
[2023-07-05 13:15:55] [config] dynamic-gradient-scaling:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] early-stopping: 10
[2023-07-05 13:15:55] [config] early-stopping-on: first
[2023-07-05 13:15:55] [config] embedding-fix-src: false
[2023-07-05 13:15:55] [config] embedding-fix-trg: false
[2023-07-05 13:15:55] [config] embedding-normalization: false
[2023-07-05 13:15:55] [config] embedding-vectors:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] enc-cell: gru
[2023-07-05 13:15:55] [config] enc-cell-depth: 1
[2023-07-05 13:15:55] [config] enc-depth: 1
[2023-07-05 13:15:55] [config] enc-type: bidirectional
[2023-07-05 13:15:55] [config] english-title-case-every: 0
[2023-07-05 13:15:55] [config] exponential-smoothing: 0
[2023-07-05 13:15:55] [config] factor-weight: 1
[2023-07-05 13:15:55] [config] factors-combine: sum
[2023-07-05 13:15:55] [config] factors-dim-emb: 0
[2023-07-05 13:15:55] [config] gradient-checkpointing: false
[2023-07-05 13:15:55] [config] gradient-norm-average-window: 100
[2023-07-05 13:15:55] [config] guided-alignment: none
[2023-07-05 13:15:55] [config] guided-alignment-cost: mse
[2023-07-05 13:15:55] [config] guided-alignment-weight: 0.1
[2023-07-05 13:15:55] [config] ignore-model-config: false
[2023-07-05 13:15:55] [config] input-types:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] interpolate-env-vars: false
[2023-07-05 13:15:55] [config] keep-best: false
[2023-07-05 13:15:55] [config] label-smoothing: 0
[2023-07-05 13:15:55] [config] layer-normalization: false
[2023-07-05 13:15:55] [config] learn-rate: 0.0001
[2023-07-05 13:15:55] [config] lemma-dependency: ""
[2023-07-05 13:15:55] [config] lemma-dim-emb: 0
[2023-07-05 13:15:55] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:15:55] [config] log-level: info
[2023-07-05 13:15:55] [config] log-time-zone: ""
[2023-07-05 13:15:55] [config] logical-epoch:
[2023-07-05 13:15:55] [config]   - 1e
[2023-07-05 13:15:55] [config]   - 0
[2023-07-05 13:15:55] [config] lr-decay: 0
[2023-07-05 13:15:55] [config] lr-decay-freq: 50000
[2023-07-05 13:15:55] [config] lr-decay-inv-sqrt:
[2023-07-05 13:15:55] [config]   - 0
[2023-07-05 13:15:55] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:15:55] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:15:55] [config] lr-decay-start:
[2023-07-05 13:15:55] [config]   - 10
[2023-07-05 13:15:55] [config]   - 1
[2023-07-05 13:15:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:15:55] [config] lr-report: false
[2023-07-05 13:15:55] [config] lr-warmup: 0
[2023-07-05 13:15:55] [config] lr-warmup-at-reload: false
[2023-07-05 13:15:55] [config] lr-warmup-cycle: false
[2023-07-05 13:15:55] [config] lr-warmup-start-rate: 0
[2023-07-05 13:15:55] [config] max-length: 50
[2023-07-05 13:15:55] [config] max-length-crop: false
[2023-07-05 13:15:55] [config] max-length-factor: 3
[2023-07-05 13:15:55] [config] maxi-batch: 100
[2023-07-05 13:15:55] [config] maxi-batch-sort: trg
[2023-07-05 13:15:55] [config] mini-batch: 64
[2023-07-05 13:15:55] [config] mini-batch-fit: false
[2023-07-05 13:15:55] [config] mini-batch-fit-step: 10
[2023-07-05 13:15:55] [config] mini-batch-round-up: true
[2023-07-05 13:15:55] [config] mini-batch-track-lr: false
[2023-07-05 13:15:55] [config] mini-batch-warmup: 0
[2023-07-05 13:15:55] [config] mini-batch-words: 0
[2023-07-05 13:15:55] [config] mini-batch-words-ref: 0
[2023-07-05 13:15:55] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:15:55] [config] multi-loss-type: sum
[2023-07-05 13:15:55] [config] n-best: false
[2023-07-05 13:15:55] [config] no-nccl: false
[2023-07-05 13:15:55] [config] no-reload: false
[2023-07-05 13:15:55] [config] no-restore-corpus: false
[2023-07-05 13:15:55] [config] normalize: 0
[2023-07-05 13:15:55] [config] normalize-gradient: false
[2023-07-05 13:15:55] [config] num-devices: 0
[2023-07-05 13:15:55] [config] optimizer: adam
[2023-07-05 13:15:55] [config] optimizer-delay: 1
[2023-07-05 13:15:55] [config] optimizer-params:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] output-omit-bias: false
[2023-07-05 13:15:55] [config] overwrite: true
[2023-07-05 13:15:55] [config] precision:
[2023-07-05 13:15:55] [config]   - float32
[2023-07-05 13:15:55] [config]   - float32
[2023-07-05 13:15:55] [config] pretrained-model: ""
[2023-07-05 13:15:55] [config] quantize-biases: false
[2023-07-05 13:15:55] [config] quantize-bits: 0
[2023-07-05 13:15:55] [config] quantize-log-based: false
[2023-07-05 13:15:55] [config] quantize-optimization-steps: 0
[2023-07-05 13:15:55] [config] quiet: false
[2023-07-05 13:15:55] [config] quiet-translation: true
[2023-07-05 13:15:55] [config] relative-paths: false
[2023-07-05 13:15:55] [config] right-left: false
[2023-07-05 13:15:55] [config] save-freq: 10000u
[2023-07-05 13:15:55] [config] seed: 1234
[2023-07-05 13:15:55] [config] sentencepiece-alphas:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:15:55] [config] sentencepiece-options: ""
[2023-07-05 13:15:55] [config] sharding: global
[2023-07-05 13:15:55] [config] shuffle: data
[2023-07-05 13:15:55] [config] shuffle-in-ram: false
[2023-07-05 13:15:55] [config] sigterm: save-and-exit
[2023-07-05 13:15:55] [config] skip: false
[2023-07-05 13:15:55] [config] sqlite: ""
[2023-07-05 13:15:55] [config] sqlite-drop: false
[2023-07-05 13:15:55] [config] sync-freq: 200u
[2023-07-05 13:15:55] [config] sync-sgd: false
[2023-07-05 13:15:55] [config] tempdir: /tmp
[2023-07-05 13:15:55] [config] tied-embeddings: false
[2023-07-05 13:15:55] [config] tied-embeddings-all: false
[2023-07-05 13:15:55] [config] tied-embeddings-src: false
[2023-07-05 13:15:55] [config] train-embedder-rank:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] train-sets:
[2023-07-05 13:15:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:15:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:15:55] [config] transformer-aan-activation: swish
[2023-07-05 13:15:55] [config] transformer-aan-depth: 2
[2023-07-05 13:15:55] [config] transformer-aan-nogate: false
[2023-07-05 13:15:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:15:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:15:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:15:55] [config] transformer-depth-scaling: false
[2023-07-05 13:15:55] [config] transformer-dim-aan: 2048
[2023-07-05 13:15:55] [config] transformer-dim-ffn: 2048
[2023-07-05 13:15:55] [config] transformer-dropout: 0
[2023-07-05 13:15:55] [config] transformer-dropout-attention: 0
[2023-07-05 13:15:55] [config] transformer-dropout-ffn: 0
[2023-07-05 13:15:55] [config] transformer-ffn-activation: swish
[2023-07-05 13:15:55] [config] transformer-ffn-depth: 2
[2023-07-05 13:15:55] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:15:55] [config] transformer-heads: 8
[2023-07-05 13:15:55] [config] transformer-no-projection: false
[2023-07-05 13:15:55] [config] transformer-pool: false
[2023-07-05 13:15:55] [config] transformer-postprocess: dan
[2023-07-05 13:15:55] [config] transformer-postprocess-emb: d
[2023-07-05 13:15:55] [config] transformer-postprocess-top: ""
[2023-07-05 13:15:55] [config] transformer-preprocess: ""
[2023-07-05 13:15:55] [config] transformer-tied-layers:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] transformer-train-position-embeddings: false
[2023-07-05 13:15:55] [config] tsv: false
[2023-07-05 13:15:55] [config] tsv-fields: 0
[2023-07-05 13:15:55] [config] type: s2s
[2023-07-05 13:15:55] [config] ulr: false
[2023-07-05 13:15:55] [config] ulr-dim-emb: 0
[2023-07-05 13:15:55] [config] ulr-dropout: 0
[2023-07-05 13:15:55] [config] ulr-keys-vectors: ""
[2023-07-05 13:15:55] [config] ulr-query-vectors: ""
[2023-07-05 13:15:55] [config] ulr-softmax-temperature: 1
[2023-07-05 13:15:55] [config] ulr-trainable-transformation: false
[2023-07-05 13:15:55] [config] unlikelihood-loss: false
[2023-07-05 13:15:55] [config] valid-freq: 50000000
[2023-07-05 13:15:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:15:55] [config] valid-max-length: 1000
[2023-07-05 13:15:55] [config] valid-metrics:
[2023-07-05 13:15:55] [config]   - cross-entropy
[2023-07-05 13:15:55] [config]   - translation
[2023-07-05 13:15:55] [config] valid-mini-batch: 32
[2023-07-05 13:15:55] [config] valid-reset-stalled: false
[2023-07-05 13:15:55] [config] valid-script-args:
[2023-07-05 13:15:55] [config]   []
[2023-07-05 13:15:55] [config] valid-script-path: ""
[2023-07-05 13:15:55] [config] valid-sets:
[2023-07-05 13:15:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:15:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:15:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:15:55] [config] vocabs:
[2023-07-05 13:15:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:55] [config] word-penalty: 0
[2023-07-05 13:15:55] [config] word-scores: false
[2023-07-05 13:15:55] [config] workspace: 2048
[2023-07-05 13:15:55] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:15:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:55] [training] Using single-device training
[2023-07-05 13:15:55] Synced seed 1234
[2023-07-05 13:15:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:15:55] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:15:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:15:56] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:15:56] [valid] No post-processing script given for validating translator
[2023-07-05 13:15:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:15:56] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:15:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:15:56] [comm] Using global sharding
[2023-07-05 13:15:56] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:15:56] [training] Using 1 GPUs
[2023-07-05 13:15:56] Training started
[2023-07-05 13:15:56] [data] Shuffling data
[2023-07-05 13:15:56] [data] Done reading 20,192 sentences
[2023-07-05 13:15:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:15:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 13:15:57] [logits] Applying loss function for 1 factor(s)
[2023-07-05 13:15:57] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 13:15:57] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:15:57] Parameter type float32, optimization type float32, casting types false
[2023-07-05 13:15:57] Allocating memory for Adam-specific shards
[2023-07-05 13:15:57] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:16:36] Seen 18,843 samples
[2023-07-05 13:16:36] Starting data epoch 2 in logical epoch 2
[2023-07-05 13:16:36] [data] Shuffling data
[2023-07-05 13:16:36] [data] Done reading 20,192 sentences
[2023-07-05 13:16:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:17:31] Seen 18,843 samples
[2023-07-05 13:17:31] Starting data epoch 3 in logical epoch 3
[2023-07-05 13:17:31] [data] Shuffling data
[2023-07-05 13:17:31] [data] Done reading 20,192 sentences
[2023-07-05 13:17:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:18:35] Seen 18,843 samples
[2023-07-05 13:18:35] Starting data epoch 4 in logical epoch 4
[2023-07-05 13:18:35] [data] Shuffling data
[2023-07-05 13:18:35] [data] Done reading 20,192 sentences
[2023-07-05 13:18:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:19:00] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 7.39924383 * 933,288 @ 570 after 933,288 : Time 184.86s : 5048.58 words/s : gNorm 1.1873
[2023-07-05 13:19:42] Seen 18,843 samples
[2023-07-05 13:19:42] Starting data epoch 5 in logical epoch 5
[2023-07-05 13:19:42] [data] Shuffling data
[2023-07-05 13:19:42] [data] Done reading 20,192 sentences
[2023-07-05 13:19:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:20:47] Seen 18,843 samples
[2023-07-05 13:20:47] Starting data epoch 6 in logical epoch 6
[2023-07-05 13:20:47] [data] Shuffling data
[2023-07-05 13:20:47] [data] Done reading 20,192 sentences
[2023-07-05 13:20:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:21:50] Seen 18,843 samples
[2023-07-05 13:21:50] Starting data epoch 7 in logical epoch 7
[2023-07-05 13:21:50] [data] Shuffling data
[2023-07-05 13:21:50] [data] Done reading 20,192 sentences
[2023-07-05 13:21:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:22:38] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 6.38114262 * 926,551 @ 2,125 after 1,859,839 : Time 217.40s : 4261.93 words/s : gNorm 1.2584
[2023-07-05 13:22:55] Seen 18,843 samples
[2023-07-05 13:22:55] Starting data epoch 8 in logical epoch 8
[2023-07-05 13:22:55] [data] Shuffling data
[2023-07-05 13:22:55] [data] Done reading 20,192 sentences
[2023-07-05 13:22:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:24:04] Seen 18,843 samples
[2023-07-05 13:24:04] Starting data epoch 9 in logical epoch 9
[2023-07-05 13:24:04] [data] Shuffling data
[2023-07-05 13:24:04] [data] Done reading 20,192 sentences
[2023-07-05 13:24:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:25:11] Seen 18,843 samples
[2023-07-05 13:25:11] Starting data epoch 10 in logical epoch 10
[2023-07-05 13:25:11] [data] Shuffling data
[2023-07-05 13:25:11] [data] Done reading 20,192 sentences
[2023-07-05 13:25:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:26:22] Seen 18,843 samples
[2023-07-05 13:26:22] Starting data epoch 11 in logical epoch 11
[2023-07-05 13:26:22] Training finished
[2023-07-05 13:26:30] [valid] Ep. 11 : Up. 2968 : cross-entropy : 87.4287 : new best
[2023-07-05 13:30:00] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-05 13:30:00] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:30:05] Saving Adam parameters
[2023-07-05 13:30:07] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 13:30:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:30:23] [marian] Running on node22.datos.cluster.uy as process 35983 with command line:
[2023-07-05 13:30:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 13:30:23] [config] after: 0e
[2023-07-05 13:30:23] [config] after-batches: 0
[2023-07-05 13:30:23] [config] after-epochs: 20
[2023-07-05 13:30:23] [config] all-caps-every: 0
[2023-07-05 13:30:23] [config] allow-unk: false
[2023-07-05 13:30:23] [config] authors: false
[2023-07-05 13:30:23] [config] beam-size: 12
[2023-07-05 13:30:23] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:30:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:30:23] [config] bert-masking-fraction: 0.15
[2023-07-05 13:30:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:30:23] [config] bert-train-type-embeddings: true
[2023-07-05 13:30:23] [config] bert-type-vocab-size: 2
[2023-07-05 13:30:23] [config] build-info: ""
[2023-07-05 13:30:23] [config] check-gradient-nan: false
[2023-07-05 13:30:23] [config] check-nan: false
[2023-07-05 13:30:23] [config] cite: false
[2023-07-05 13:30:23] [config] clip-norm: 1
[2023-07-05 13:30:23] [config] cost-scaling:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] cost-type: ce-sum
[2023-07-05 13:30:23] [config] cpu-threads: 0
[2023-07-05 13:30:23] [config] data-threads: 8
[2023-07-05 13:30:23] [config] data-weighting: ""
[2023-07-05 13:30:23] [config] data-weighting-type: sentence
[2023-07-05 13:30:23] [config] dec-cell: gru
[2023-07-05 13:30:23] [config] dec-cell-base-depth: 2
[2023-07-05 13:30:23] [config] dec-cell-high-depth: 1
[2023-07-05 13:30:23] [config] dec-depth: 1
[2023-07-05 13:30:23] [config] devices:
[2023-07-05 13:30:23] [config]   - 0
[2023-07-05 13:30:23] [config] dim-emb: 512
[2023-07-05 13:30:23] [config] dim-rnn: 1024
[2023-07-05 13:30:23] [config] dim-vocabs:
[2023-07-05 13:30:23] [config]   - 36507
[2023-07-05 13:30:23] [config]   - 54042
[2023-07-05 13:30:23] [config] disp-first: 0
[2023-07-05 13:30:23] [config] disp-freq: 1000u
[2023-07-05 13:30:23] [config] disp-label-counts: true
[2023-07-05 13:30:23] [config] dropout-rnn: 0
[2023-07-05 13:30:23] [config] dropout-src: 0
[2023-07-05 13:30:23] [config] dropout-trg: 0
[2023-07-05 13:30:23] [config] dump-config: ""
[2023-07-05 13:30:23] [config] dynamic-gradient-scaling:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] early-stopping: 10
[2023-07-05 13:30:23] [config] early-stopping-on: first
[2023-07-05 13:30:23] [config] embedding-fix-src: false
[2023-07-05 13:30:23] [config] embedding-fix-trg: false
[2023-07-05 13:30:23] [config] embedding-normalization: false
[2023-07-05 13:30:23] [config] embedding-vectors:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] enc-cell: gru
[2023-07-05 13:30:23] [config] enc-cell-depth: 1
[2023-07-05 13:30:23] [config] enc-depth: 1
[2023-07-05 13:30:23] [config] enc-type: bidirectional
[2023-07-05 13:30:23] [config] english-title-case-every: 0
[2023-07-05 13:30:23] [config] exponential-smoothing: 0
[2023-07-05 13:30:23] [config] factor-weight: 1
[2023-07-05 13:30:23] [config] factors-combine: sum
[2023-07-05 13:30:23] [config] factors-dim-emb: 0
[2023-07-05 13:30:23] [config] gradient-checkpointing: false
[2023-07-05 13:30:23] [config] gradient-norm-average-window: 100
[2023-07-05 13:30:23] [config] guided-alignment: none
[2023-07-05 13:30:23] [config] guided-alignment-cost: mse
[2023-07-05 13:30:23] [config] guided-alignment-weight: 0.1
[2023-07-05 13:30:23] [config] ignore-model-config: false
[2023-07-05 13:30:23] [config] input-types:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] interpolate-env-vars: false
[2023-07-05 13:30:23] [config] keep-best: false
[2023-07-05 13:30:23] [config] label-smoothing: 0
[2023-07-05 13:30:23] [config] layer-normalization: false
[2023-07-05 13:30:23] [config] learn-rate: 0.0001
[2023-07-05 13:30:23] [config] lemma-dependency: ""
[2023-07-05 13:30:23] [config] lemma-dim-emb: 0
[2023-07-05 13:30:23] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:30:23] [config] log-level: info
[2023-07-05 13:30:23] [config] log-time-zone: ""
[2023-07-05 13:30:23] [config] logical-epoch:
[2023-07-05 13:30:23] [config]   - 1e
[2023-07-05 13:30:23] [config]   - 0
[2023-07-05 13:30:23] [config] lr-decay: 0
[2023-07-05 13:30:23] [config] lr-decay-freq: 50000
[2023-07-05 13:30:23] [config] lr-decay-inv-sqrt:
[2023-07-05 13:30:23] [config]   - 0
[2023-07-05 13:30:23] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:30:23] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:30:23] [config] lr-decay-start:
[2023-07-05 13:30:23] [config]   - 10
[2023-07-05 13:30:23] [config]   - 1
[2023-07-05 13:30:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:30:23] [config] lr-report: false
[2023-07-05 13:30:23] [config] lr-warmup: 0
[2023-07-05 13:30:23] [config] lr-warmup-at-reload: false
[2023-07-05 13:30:23] [config] lr-warmup-cycle: false
[2023-07-05 13:30:23] [config] lr-warmup-start-rate: 0
[2023-07-05 13:30:23] [config] max-length: 50
[2023-07-05 13:30:23] [config] max-length-crop: false
[2023-07-05 13:30:23] [config] max-length-factor: 3
[2023-07-05 13:30:23] [config] maxi-batch: 100
[2023-07-05 13:30:23] [config] maxi-batch-sort: trg
[2023-07-05 13:30:23] [config] mini-batch: 64
[2023-07-05 13:30:23] [config] mini-batch-fit: false
[2023-07-05 13:30:23] [config] mini-batch-fit-step: 10
[2023-07-05 13:30:23] [config] mini-batch-round-up: true
[2023-07-05 13:30:23] [config] mini-batch-track-lr: false
[2023-07-05 13:30:23] [config] mini-batch-warmup: 0
[2023-07-05 13:30:23] [config] mini-batch-words: 0
[2023-07-05 13:30:23] [config] mini-batch-words-ref: 0
[2023-07-05 13:30:23] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:30:23] [config] multi-loss-type: sum
[2023-07-05 13:30:23] [config] n-best: false
[2023-07-05 13:30:23] [config] no-nccl: false
[2023-07-05 13:30:23] [config] no-reload: false
[2023-07-05 13:30:23] [config] no-restore-corpus: false
[2023-07-05 13:30:23] [config] normalize: 0
[2023-07-05 13:30:23] [config] normalize-gradient: false
[2023-07-05 13:30:23] [config] num-devices: 0
[2023-07-05 13:30:23] [config] optimizer: adam
[2023-07-05 13:30:23] [config] optimizer-delay: 1
[2023-07-05 13:30:23] [config] optimizer-params:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] output-omit-bias: false
[2023-07-05 13:30:23] [config] overwrite: true
[2023-07-05 13:30:23] [config] precision:
[2023-07-05 13:30:23] [config]   - float32
[2023-07-05 13:30:23] [config]   - float32
[2023-07-05 13:30:23] [config] pretrained-model: ""
[2023-07-05 13:30:23] [config] quantize-biases: false
[2023-07-05 13:30:23] [config] quantize-bits: 0
[2023-07-05 13:30:23] [config] quantize-log-based: false
[2023-07-05 13:30:23] [config] quantize-optimization-steps: 0
[2023-07-05 13:30:23] [config] quiet: false
[2023-07-05 13:30:23] [config] quiet-translation: true
[2023-07-05 13:30:23] [config] relative-paths: false
[2023-07-05 13:30:23] [config] right-left: false
[2023-07-05 13:30:23] [config] save-freq: 10000u
[2023-07-05 13:30:23] [config] seed: 1234
[2023-07-05 13:30:23] [config] sentencepiece-alphas:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:30:23] [config] sentencepiece-options: ""
[2023-07-05 13:30:23] [config] sharding: global
[2023-07-05 13:30:23] [config] shuffle: data
[2023-07-05 13:30:23] [config] shuffle-in-ram: false
[2023-07-05 13:30:23] [config] sigterm: save-and-exit
[2023-07-05 13:30:23] [config] skip: false
[2023-07-05 13:30:23] [config] sqlite: ""
[2023-07-05 13:30:23] [config] sqlite-drop: false
[2023-07-05 13:30:23] [config] sync-freq: 200u
[2023-07-05 13:30:23] [config] sync-sgd: false
[2023-07-05 13:30:23] [config] tempdir: /tmp
[2023-07-05 13:30:23] [config] tied-embeddings: false
[2023-07-05 13:30:23] [config] tied-embeddings-all: false
[2023-07-05 13:30:23] [config] tied-embeddings-src: false
[2023-07-05 13:30:23] [config] train-embedder-rank:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] train-sets:
[2023-07-05 13:30:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:30:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:30:23] [config] transformer-aan-activation: swish
[2023-07-05 13:30:23] [config] transformer-aan-depth: 2
[2023-07-05 13:30:23] [config] transformer-aan-nogate: false
[2023-07-05 13:30:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:30:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:30:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:30:23] [config] transformer-depth-scaling: false
[2023-07-05 13:30:23] [config] transformer-dim-aan: 2048
[2023-07-05 13:30:23] [config] transformer-dim-ffn: 2048
[2023-07-05 13:30:23] [config] transformer-dropout: 0
[2023-07-05 13:30:23] [config] transformer-dropout-attention: 0
[2023-07-05 13:30:23] [config] transformer-dropout-ffn: 0
[2023-07-05 13:30:23] [config] transformer-ffn-activation: swish
[2023-07-05 13:30:23] [config] transformer-ffn-depth: 2
[2023-07-05 13:30:23] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:30:23] [config] transformer-heads: 8
[2023-07-05 13:30:23] [config] transformer-no-projection: false
[2023-07-05 13:30:23] [config] transformer-pool: false
[2023-07-05 13:30:23] [config] transformer-postprocess: dan
[2023-07-05 13:30:23] [config] transformer-postprocess-emb: d
[2023-07-05 13:30:23] [config] transformer-postprocess-top: ""
[2023-07-05 13:30:23] [config] transformer-preprocess: ""
[2023-07-05 13:30:23] [config] transformer-tied-layers:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] transformer-train-position-embeddings: false
[2023-07-05 13:30:23] [config] tsv: false
[2023-07-05 13:30:23] [config] tsv-fields: 0
[2023-07-05 13:30:23] [config] type: s2s
[2023-07-05 13:30:23] [config] ulr: false
[2023-07-05 13:30:23] [config] ulr-dim-emb: 0
[2023-07-05 13:30:23] [config] ulr-dropout: 0
[2023-07-05 13:30:23] [config] ulr-keys-vectors: ""
[2023-07-05 13:30:23] [config] ulr-query-vectors: ""
[2023-07-05 13:30:23] [config] ulr-softmax-temperature: 1
[2023-07-05 13:30:23] [config] ulr-trainable-transformation: false
[2023-07-05 13:30:23] [config] unlikelihood-loss: false
[2023-07-05 13:30:23] [config] valid-freq: 50000000
[2023-07-05 13:30:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:30:23] [config] valid-max-length: 1000
[2023-07-05 13:30:23] [config] valid-metrics:
[2023-07-05 13:30:23] [config]   - cross-entropy
[2023-07-05 13:30:23] [config]   - translation
[2023-07-05 13:30:23] [config] valid-mini-batch: 32
[2023-07-05 13:30:23] [config] valid-reset-stalled: false
[2023-07-05 13:30:23] [config] valid-script-args:
[2023-07-05 13:30:23] [config]   []
[2023-07-05 13:30:23] [config] valid-script-path: ""
[2023-07-05 13:30:23] [config] valid-sets:
[2023-07-05 13:30:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:30:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:30:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:30:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:30:23] [config] vocabs:
[2023-07-05 13:30:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:30:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:30:23] [config] word-penalty: 0
[2023-07-05 13:30:23] [config] word-scores: false
[2023-07-05 13:30:23] [config] workspace: 2048
[2023-07-05 13:30:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:30:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:30:23] [training] Using single-device training
[2023-07-05 13:30:23] Synced seed 1234
[2023-07-05 13:30:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:30:24] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:30:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:30:24] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:30:24] [valid] No post-processing script given for validating translator
[2023-07-05 13:30:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:30:24] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:30:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:30:25] [comm] Using global sharding
[2023-07-05 13:30:25] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:30:25] [training] Using 1 GPUs
[2023-07-05 13:30:25] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:30:27] Loading Adam parameters
[2023-07-05 13:30:28] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:30:28] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:30:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 13:30:28] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-05 13:30:28] [data] Shuffling data
[2023-07-05 13:30:28] [data] Done reading 20,192 sentences
[2023-07-05 13:30:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:30:28] Training started
[2023-07-05 13:30:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 13:30:28] [logits] Applying loss function for 1 factor(s)
[2023-07-05 13:30:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 13:30:28] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:30:28] Parameter type float32, optimization type float32, casting types false
[2023-07-05 13:30:33] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 5.65114927 * 933,583 @ 1,024 after 2,793,422 : Time 8.97s : 104043.60 words/s : gNorm 1.4116
[2023-07-05 13:31:22] Seen 18,843 samples
[2023-07-05 13:31:22] Starting data epoch 12 in logical epoch 12
[2023-07-05 13:31:22] [data] Shuffling data
[2023-07-05 13:31:22] [data] Done reading 20,192 sentences
[2023-07-05 13:31:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:32:31] Seen 18,843 samples
[2023-07-05 13:32:31] Starting data epoch 13 in logical epoch 13
[2023-07-05 13:32:31] [data] Shuffling data
[2023-07-05 13:32:31] [data] Done reading 20,192 sentences
[2023-07-05 13:32:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:33:37] Seen 18,843 samples
[2023-07-05 13:33:37] Starting data epoch 14 in logical epoch 14
[2023-07-05 13:33:37] [data] Shuffling data
[2023-07-05 13:33:37] [data] Done reading 20,192 sentences
[2023-07-05 13:33:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:34:12] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 5.04687500 * 941,038 @ 1,472 after 3,734,460 : Time 219.47s : 4287.86 words/s : gNorm 1.5884
[2023-07-05 13:34:46] Seen 18,843 samples
[2023-07-05 13:34:46] Starting data epoch 15 in logical epoch 15
[2023-07-05 13:34:46] [data] Shuffling data
[2023-07-05 13:34:46] [data] Done reading 20,192 sentences
[2023-07-05 13:34:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:35:51] Seen 18,843 samples
[2023-07-05 13:35:51] Starting data epoch 16 in logical epoch 16
[2023-07-05 13:35:51] [data] Shuffling data
[2023-07-05 13:35:51] [data] Done reading 20,192 sentences
[2023-07-05 13:35:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:36:59] Seen 18,843 samples
[2023-07-05 13:36:59] Starting data epoch 17 in logical epoch 17
[2023-07-05 13:36:59] [data] Shuffling data
[2023-07-05 13:36:59] [data] Done reading 20,192 sentences
[2023-07-05 13:37:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:38:02] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 4.50727224 * 924,840 @ 832 after 4,659,300 : Time 230.16s : 4018.22 words/s : gNorm 1.5979
[2023-07-05 13:38:12] Seen 18,843 samples
[2023-07-05 13:38:12] Starting data epoch 18 in logical epoch 18
[2023-07-05 13:38:12] [data] Shuffling data
[2023-07-05 13:38:12] [data] Done reading 20,192 sentences
[2023-07-05 13:38:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:39:20] Seen 18,843 samples
[2023-07-05 13:39:20] Starting data epoch 19 in logical epoch 19
[2023-07-05 13:39:20] [data] Shuffling data
[2023-07-05 13:39:20] [data] Done reading 20,192 sentences
[2023-07-05 13:39:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:40:26] Seen 18,843 samples
[2023-07-05 13:40:26] Starting data epoch 20 in logical epoch 20
[2023-07-05 13:40:26] [data] Shuffling data
[2023-07-05 13:40:26] [data] Done reading 20,192 sentences
[2023-07-05 13:40:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:41:32] Seen 18,843 samples
[2023-07-05 13:41:32] Starting data epoch 21 in logical epoch 21
[2023-07-05 13:41:32] Training finished
[2023-07-05 13:41:41] [valid] Ep. 21 : Up. 5933 : cross-entropy : 89.2495 : stalled 1 times (last best: 87.4287)
[2023-07-05 13:44:09] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-07-05 13:44:09] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:44:14] Saving Adam parameters
[2023-07-05 13:44:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 13:44:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:44:31] [marian] Running on node22.datos.cluster.uy as process 8937 with command line:
[2023-07-05 13:44:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 13:44:31] [config] after: 0e
[2023-07-05 13:44:31] [config] after-batches: 0
[2023-07-05 13:44:31] [config] after-epochs: 30
[2023-07-05 13:44:31] [config] all-caps-every: 0
[2023-07-05 13:44:31] [config] allow-unk: false
[2023-07-05 13:44:31] [config] authors: false
[2023-07-05 13:44:31] [config] beam-size: 12
[2023-07-05 13:44:31] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:44:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:44:31] [config] bert-masking-fraction: 0.15
[2023-07-05 13:44:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:44:31] [config] bert-train-type-embeddings: true
[2023-07-05 13:44:31] [config] bert-type-vocab-size: 2
[2023-07-05 13:44:31] [config] build-info: ""
[2023-07-05 13:44:31] [config] check-gradient-nan: false
[2023-07-05 13:44:31] [config] check-nan: false
[2023-07-05 13:44:31] [config] cite: false
[2023-07-05 13:44:31] [config] clip-norm: 1
[2023-07-05 13:44:31] [config] cost-scaling:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] cost-type: ce-sum
[2023-07-05 13:44:31] [config] cpu-threads: 0
[2023-07-05 13:44:31] [config] data-threads: 8
[2023-07-05 13:44:31] [config] data-weighting: ""
[2023-07-05 13:44:31] [config] data-weighting-type: sentence
[2023-07-05 13:44:31] [config] dec-cell: gru
[2023-07-05 13:44:31] [config] dec-cell-base-depth: 2
[2023-07-05 13:44:31] [config] dec-cell-high-depth: 1
[2023-07-05 13:44:31] [config] dec-depth: 1
[2023-07-05 13:44:31] [config] devices:
[2023-07-05 13:44:31] [config]   - 0
[2023-07-05 13:44:31] [config] dim-emb: 512
[2023-07-05 13:44:31] [config] dim-rnn: 1024
[2023-07-05 13:44:31] [config] dim-vocabs:
[2023-07-05 13:44:31] [config]   - 36507
[2023-07-05 13:44:31] [config]   - 54042
[2023-07-05 13:44:31] [config] disp-first: 0
[2023-07-05 13:44:31] [config] disp-freq: 1000u
[2023-07-05 13:44:31] [config] disp-label-counts: true
[2023-07-05 13:44:31] [config] dropout-rnn: 0
[2023-07-05 13:44:31] [config] dropout-src: 0
[2023-07-05 13:44:31] [config] dropout-trg: 0
[2023-07-05 13:44:31] [config] dump-config: ""
[2023-07-05 13:44:31] [config] dynamic-gradient-scaling:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] early-stopping: 10
[2023-07-05 13:44:31] [config] early-stopping-on: first
[2023-07-05 13:44:31] [config] embedding-fix-src: false
[2023-07-05 13:44:31] [config] embedding-fix-trg: false
[2023-07-05 13:44:31] [config] embedding-normalization: false
[2023-07-05 13:44:31] [config] embedding-vectors:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] enc-cell: gru
[2023-07-05 13:44:31] [config] enc-cell-depth: 1
[2023-07-05 13:44:31] [config] enc-depth: 1
[2023-07-05 13:44:31] [config] enc-type: bidirectional
[2023-07-05 13:44:31] [config] english-title-case-every: 0
[2023-07-05 13:44:31] [config] exponential-smoothing: 0
[2023-07-05 13:44:31] [config] factor-weight: 1
[2023-07-05 13:44:31] [config] factors-combine: sum
[2023-07-05 13:44:31] [config] factors-dim-emb: 0
[2023-07-05 13:44:31] [config] gradient-checkpointing: false
[2023-07-05 13:44:31] [config] gradient-norm-average-window: 100
[2023-07-05 13:44:31] [config] guided-alignment: none
[2023-07-05 13:44:31] [config] guided-alignment-cost: mse
[2023-07-05 13:44:31] [config] guided-alignment-weight: 0.1
[2023-07-05 13:44:31] [config] ignore-model-config: false
[2023-07-05 13:44:31] [config] input-types:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] interpolate-env-vars: false
[2023-07-05 13:44:31] [config] keep-best: false
[2023-07-05 13:44:31] [config] label-smoothing: 0
[2023-07-05 13:44:31] [config] layer-normalization: false
[2023-07-05 13:44:31] [config] learn-rate: 0.0001
[2023-07-05 13:44:31] [config] lemma-dependency: ""
[2023-07-05 13:44:31] [config] lemma-dim-emb: 0
[2023-07-05 13:44:31] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:44:31] [config] log-level: info
[2023-07-05 13:44:31] [config] log-time-zone: ""
[2023-07-05 13:44:31] [config] logical-epoch:
[2023-07-05 13:44:31] [config]   - 1e
[2023-07-05 13:44:31] [config]   - 0
[2023-07-05 13:44:31] [config] lr-decay: 0
[2023-07-05 13:44:31] [config] lr-decay-freq: 50000
[2023-07-05 13:44:31] [config] lr-decay-inv-sqrt:
[2023-07-05 13:44:31] [config]   - 0
[2023-07-05 13:44:31] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:44:31] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:44:31] [config] lr-decay-start:
[2023-07-05 13:44:31] [config]   - 10
[2023-07-05 13:44:31] [config]   - 1
[2023-07-05 13:44:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:44:31] [config] lr-report: false
[2023-07-05 13:44:31] [config] lr-warmup: 0
[2023-07-05 13:44:31] [config] lr-warmup-at-reload: false
[2023-07-05 13:44:31] [config] lr-warmup-cycle: false
[2023-07-05 13:44:31] [config] lr-warmup-start-rate: 0
[2023-07-05 13:44:31] [config] max-length: 50
[2023-07-05 13:44:31] [config] max-length-crop: false
[2023-07-05 13:44:31] [config] max-length-factor: 3
[2023-07-05 13:44:31] [config] maxi-batch: 100
[2023-07-05 13:44:31] [config] maxi-batch-sort: trg
[2023-07-05 13:44:31] [config] mini-batch: 64
[2023-07-05 13:44:31] [config] mini-batch-fit: false
[2023-07-05 13:44:31] [config] mini-batch-fit-step: 10
[2023-07-05 13:44:31] [config] mini-batch-round-up: true
[2023-07-05 13:44:31] [config] mini-batch-track-lr: false
[2023-07-05 13:44:31] [config] mini-batch-warmup: 0
[2023-07-05 13:44:31] [config] mini-batch-words: 0
[2023-07-05 13:44:31] [config] mini-batch-words-ref: 0
[2023-07-05 13:44:31] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:44:31] [config] multi-loss-type: sum
[2023-07-05 13:44:31] [config] n-best: false
[2023-07-05 13:44:31] [config] no-nccl: false
[2023-07-05 13:44:31] [config] no-reload: false
[2023-07-05 13:44:31] [config] no-restore-corpus: false
[2023-07-05 13:44:31] [config] normalize: 0
[2023-07-05 13:44:31] [config] normalize-gradient: false
[2023-07-05 13:44:31] [config] num-devices: 0
[2023-07-05 13:44:31] [config] optimizer: adam
[2023-07-05 13:44:31] [config] optimizer-delay: 1
[2023-07-05 13:44:31] [config] optimizer-params:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] output-omit-bias: false
[2023-07-05 13:44:31] [config] overwrite: true
[2023-07-05 13:44:31] [config] precision:
[2023-07-05 13:44:31] [config]   - float32
[2023-07-05 13:44:31] [config]   - float32
[2023-07-05 13:44:31] [config] pretrained-model: ""
[2023-07-05 13:44:31] [config] quantize-biases: false
[2023-07-05 13:44:31] [config] quantize-bits: 0
[2023-07-05 13:44:31] [config] quantize-log-based: false
[2023-07-05 13:44:31] [config] quantize-optimization-steps: 0
[2023-07-05 13:44:31] [config] quiet: false
[2023-07-05 13:44:31] [config] quiet-translation: true
[2023-07-05 13:44:31] [config] relative-paths: false
[2023-07-05 13:44:31] [config] right-left: false
[2023-07-05 13:44:31] [config] save-freq: 10000u
[2023-07-05 13:44:31] [config] seed: 1234
[2023-07-05 13:44:31] [config] sentencepiece-alphas:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:44:31] [config] sentencepiece-options: ""
[2023-07-05 13:44:31] [config] sharding: global
[2023-07-05 13:44:31] [config] shuffle: data
[2023-07-05 13:44:31] [config] shuffle-in-ram: false
[2023-07-05 13:44:31] [config] sigterm: save-and-exit
[2023-07-05 13:44:31] [config] skip: false
[2023-07-05 13:44:31] [config] sqlite: ""
[2023-07-05 13:44:31] [config] sqlite-drop: false
[2023-07-05 13:44:31] [config] sync-freq: 200u
[2023-07-05 13:44:31] [config] sync-sgd: false
[2023-07-05 13:44:31] [config] tempdir: /tmp
[2023-07-05 13:44:31] [config] tied-embeddings: false
[2023-07-05 13:44:31] [config] tied-embeddings-all: false
[2023-07-05 13:44:31] [config] tied-embeddings-src: false
[2023-07-05 13:44:31] [config] train-embedder-rank:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] train-sets:
[2023-07-05 13:44:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:44:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:44:31] [config] transformer-aan-activation: swish
[2023-07-05 13:44:31] [config] transformer-aan-depth: 2
[2023-07-05 13:44:31] [config] transformer-aan-nogate: false
[2023-07-05 13:44:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:44:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:44:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:44:31] [config] transformer-depth-scaling: false
[2023-07-05 13:44:31] [config] transformer-dim-aan: 2048
[2023-07-05 13:44:31] [config] transformer-dim-ffn: 2048
[2023-07-05 13:44:31] [config] transformer-dropout: 0
[2023-07-05 13:44:31] [config] transformer-dropout-attention: 0
[2023-07-05 13:44:31] [config] transformer-dropout-ffn: 0
[2023-07-05 13:44:31] [config] transformer-ffn-activation: swish
[2023-07-05 13:44:31] [config] transformer-ffn-depth: 2
[2023-07-05 13:44:31] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:44:31] [config] transformer-heads: 8
[2023-07-05 13:44:31] [config] transformer-no-projection: false
[2023-07-05 13:44:31] [config] transformer-pool: false
[2023-07-05 13:44:31] [config] transformer-postprocess: dan
[2023-07-05 13:44:31] [config] transformer-postprocess-emb: d
[2023-07-05 13:44:31] [config] transformer-postprocess-top: ""
[2023-07-05 13:44:31] [config] transformer-preprocess: ""
[2023-07-05 13:44:31] [config] transformer-tied-layers:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] transformer-train-position-embeddings: false
[2023-07-05 13:44:31] [config] tsv: false
[2023-07-05 13:44:31] [config] tsv-fields: 0
[2023-07-05 13:44:31] [config] type: s2s
[2023-07-05 13:44:31] [config] ulr: false
[2023-07-05 13:44:31] [config] ulr-dim-emb: 0
[2023-07-05 13:44:31] [config] ulr-dropout: 0
[2023-07-05 13:44:31] [config] ulr-keys-vectors: ""
[2023-07-05 13:44:31] [config] ulr-query-vectors: ""
[2023-07-05 13:44:31] [config] ulr-softmax-temperature: 1
[2023-07-05 13:44:31] [config] ulr-trainable-transformation: false
[2023-07-05 13:44:31] [config] unlikelihood-loss: false
[2023-07-05 13:44:31] [config] valid-freq: 50000000
[2023-07-05 13:44:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:44:31] [config] valid-max-length: 1000
[2023-07-05 13:44:31] [config] valid-metrics:
[2023-07-05 13:44:31] [config]   - cross-entropy
[2023-07-05 13:44:31] [config]   - translation
[2023-07-05 13:44:31] [config] valid-mini-batch: 32
[2023-07-05 13:44:31] [config] valid-reset-stalled: false
[2023-07-05 13:44:31] [config] valid-script-args:
[2023-07-05 13:44:31] [config]   []
[2023-07-05 13:44:31] [config] valid-script-path: ""
[2023-07-05 13:44:31] [config] valid-sets:
[2023-07-05 13:44:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:44:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:44:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:44:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:44:31] [config] vocabs:
[2023-07-05 13:44:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:44:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:44:31] [config] word-penalty: 0
[2023-07-05 13:44:31] [config] word-scores: false
[2023-07-05 13:44:31] [config] workspace: 2048
[2023-07-05 13:44:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:44:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:44:31] [training] Using single-device training
[2023-07-05 13:44:32] Synced seed 1234
[2023-07-05 13:44:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:44:32] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:44:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:44:32] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:44:32] [valid] No post-processing script given for validating translator
[2023-07-05 13:44:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:44:33] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:44:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:44:33] [comm] Using global sharding
[2023-07-05 13:44:33] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:44:33] [training] Using 1 GPUs
[2023-07-05 13:44:33] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:44:35] Loading Adam parameters
[2023-07-05 13:44:36] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:44:36] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:44:36] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 13:44:36] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-07-05 13:44:36] [data] Shuffling data
[2023-07-05 13:44:36] [data] Done reading 20,192 sentences
[2023-07-05 13:44:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:44:36] Training started
[2023-07-05 13:44:36] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 13:44:36] [logits] Applying loss function for 1 factor(s)
[2023-07-05 13:44:37] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 13:44:37] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:44:37] Parameter type float32, optimization type float32, casting types false
[2023-07-05 13:44:46] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 4.03080225 * 933,651 @ 832 after 5,592,951 : Time 14.52s : 64285.82 words/s : gNorm 1.5721
[2023-07-05 13:45:32] Seen 18,843 samples
[2023-07-05 13:45:32] Starting data epoch 22 in logical epoch 22
[2023-07-05 13:45:32] [data] Shuffling data
[2023-07-05 13:45:32] [data] Done reading 20,192 sentences
[2023-07-05 13:45:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:46:37] Seen 18,843 samples
[2023-07-05 13:46:37] Starting data epoch 23 in logical epoch 23
[2023-07-05 13:46:37] [data] Shuffling data
[2023-07-05 13:46:37] [data] Done reading 20,192 sentences
[2023-07-05 13:46:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:47:43] Seen 18,843 samples
[2023-07-05 13:47:43] Starting data epoch 24 in logical epoch 24
[2023-07-05 13:47:43] [data] Shuffling data
[2023-07-05 13:47:44] [data] Done reading 20,192 sentences
[2023-07-05 13:47:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:48:27] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 3.57891560 * 930,552 @ 512 after 6,523,503 : Time 220.40s : 4222.01 words/s : gNorm 1.7135
[2023-07-05 13:48:55] Seen 18,843 samples
[2023-07-05 13:48:55] Starting data epoch 25 in logical epoch 25
[2023-07-05 13:48:55] [data] Shuffling data
[2023-07-05 13:48:55] [data] Done reading 20,192 sentences
[2023-07-05 13:48:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:50:04] Seen 18,843 samples
[2023-07-05 13:50:04] Starting data epoch 26 in logical epoch 26
[2023-07-05 13:50:04] [data] Shuffling data
[2023-07-05 13:50:04] [data] Done reading 20,192 sentences
[2023-07-05 13:50:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:51:11] Seen 18,843 samples
[2023-07-05 13:51:11] Starting data epoch 27 in logical epoch 27
[2023-07-05 13:51:11] [data] Shuffling data
[2023-07-05 13:51:11] [data] Done reading 20,192 sentences
[2023-07-05 13:51:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:52:16] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 3.16023254 * 930,047 @ 730 after 7,453,550 : Time 229.38s : 4054.53 words/s : gNorm 1.7588
[2023-07-05 13:52:18] Seen 18,843 samples
[2023-07-05 13:52:18] Starting data epoch 28 in logical epoch 28
[2023-07-05 13:52:18] [data] Shuffling data
[2023-07-05 13:52:18] [data] Done reading 20,192 sentences
[2023-07-05 13:52:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:53:27] Seen 18,843 samples
[2023-07-05 13:53:27] Starting data epoch 29 in logical epoch 29
[2023-07-05 13:53:27] [data] Shuffling data
[2023-07-05 13:53:27] [data] Done reading 20,192 sentences
[2023-07-05 13:53:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:54:36] Seen 18,843 samples
[2023-07-05 13:54:36] Starting data epoch 30 in logical epoch 30
[2023-07-05 13:54:36] [data] Shuffling data
[2023-07-05 13:54:36] [data] Done reading 20,192 sentences
[2023-07-05 13:54:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:55:48] Seen 18,843 samples
[2023-07-05 13:55:48] Starting data epoch 31 in logical epoch 31
[2023-07-05 13:55:48] Training finished
[2023-07-05 13:55:57] [valid] Ep. 31 : Up. 8898 : cross-entropy : 94.307 : stalled 2 times (last best: 87.4287)
[2023-07-05 13:58:11] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-07-05 13:58:11] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:58:16] Saving Adam parameters
[2023-07-05 13:58:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 13:58:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:58:34] [marian] Running on node22.datos.cluster.uy as process 22886 with command line:
[2023-07-05 13:58:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 13:58:34] [config] after: 0e
[2023-07-05 13:58:34] [config] after-batches: 0
[2023-07-05 13:58:34] [config] after-epochs: 40
[2023-07-05 13:58:34] [config] all-caps-every: 0
[2023-07-05 13:58:34] [config] allow-unk: false
[2023-07-05 13:58:34] [config] authors: false
[2023-07-05 13:58:34] [config] beam-size: 12
[2023-07-05 13:58:34] [config] bert-class-symbol: "[CLS]"
[2023-07-05 13:58:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 13:58:34] [config] bert-masking-fraction: 0.15
[2023-07-05 13:58:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 13:58:34] [config] bert-train-type-embeddings: true
[2023-07-05 13:58:34] [config] bert-type-vocab-size: 2
[2023-07-05 13:58:34] [config] build-info: ""
[2023-07-05 13:58:34] [config] check-gradient-nan: false
[2023-07-05 13:58:34] [config] check-nan: false
[2023-07-05 13:58:34] [config] cite: false
[2023-07-05 13:58:34] [config] clip-norm: 1
[2023-07-05 13:58:34] [config] cost-scaling:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] cost-type: ce-sum
[2023-07-05 13:58:34] [config] cpu-threads: 0
[2023-07-05 13:58:34] [config] data-threads: 8
[2023-07-05 13:58:34] [config] data-weighting: ""
[2023-07-05 13:58:34] [config] data-weighting-type: sentence
[2023-07-05 13:58:34] [config] dec-cell: gru
[2023-07-05 13:58:34] [config] dec-cell-base-depth: 2
[2023-07-05 13:58:34] [config] dec-cell-high-depth: 1
[2023-07-05 13:58:34] [config] dec-depth: 1
[2023-07-05 13:58:34] [config] devices:
[2023-07-05 13:58:34] [config]   - 0
[2023-07-05 13:58:34] [config] dim-emb: 512
[2023-07-05 13:58:34] [config] dim-rnn: 1024
[2023-07-05 13:58:34] [config] dim-vocabs:
[2023-07-05 13:58:34] [config]   - 36507
[2023-07-05 13:58:34] [config]   - 54042
[2023-07-05 13:58:34] [config] disp-first: 0
[2023-07-05 13:58:34] [config] disp-freq: 1000u
[2023-07-05 13:58:34] [config] disp-label-counts: true
[2023-07-05 13:58:34] [config] dropout-rnn: 0
[2023-07-05 13:58:34] [config] dropout-src: 0
[2023-07-05 13:58:34] [config] dropout-trg: 0
[2023-07-05 13:58:34] [config] dump-config: ""
[2023-07-05 13:58:34] [config] dynamic-gradient-scaling:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] early-stopping: 10
[2023-07-05 13:58:34] [config] early-stopping-on: first
[2023-07-05 13:58:34] [config] embedding-fix-src: false
[2023-07-05 13:58:34] [config] embedding-fix-trg: false
[2023-07-05 13:58:34] [config] embedding-normalization: false
[2023-07-05 13:58:34] [config] embedding-vectors:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] enc-cell: gru
[2023-07-05 13:58:34] [config] enc-cell-depth: 1
[2023-07-05 13:58:34] [config] enc-depth: 1
[2023-07-05 13:58:34] [config] enc-type: bidirectional
[2023-07-05 13:58:34] [config] english-title-case-every: 0
[2023-07-05 13:58:34] [config] exponential-smoothing: 0
[2023-07-05 13:58:34] [config] factor-weight: 1
[2023-07-05 13:58:34] [config] factors-combine: sum
[2023-07-05 13:58:34] [config] factors-dim-emb: 0
[2023-07-05 13:58:34] [config] gradient-checkpointing: false
[2023-07-05 13:58:34] [config] gradient-norm-average-window: 100
[2023-07-05 13:58:34] [config] guided-alignment: none
[2023-07-05 13:58:34] [config] guided-alignment-cost: mse
[2023-07-05 13:58:34] [config] guided-alignment-weight: 0.1
[2023-07-05 13:58:34] [config] ignore-model-config: false
[2023-07-05 13:58:34] [config] input-types:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] interpolate-env-vars: false
[2023-07-05 13:58:34] [config] keep-best: false
[2023-07-05 13:58:34] [config] label-smoothing: 0
[2023-07-05 13:58:34] [config] layer-normalization: false
[2023-07-05 13:58:34] [config] learn-rate: 0.0001
[2023-07-05 13:58:34] [config] lemma-dependency: ""
[2023-07-05 13:58:34] [config] lemma-dim-emb: 0
[2023-07-05 13:58:34] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 13:58:34] [config] log-level: info
[2023-07-05 13:58:34] [config] log-time-zone: ""
[2023-07-05 13:58:34] [config] logical-epoch:
[2023-07-05 13:58:34] [config]   - 1e
[2023-07-05 13:58:34] [config]   - 0
[2023-07-05 13:58:34] [config] lr-decay: 0
[2023-07-05 13:58:34] [config] lr-decay-freq: 50000
[2023-07-05 13:58:34] [config] lr-decay-inv-sqrt:
[2023-07-05 13:58:34] [config]   - 0
[2023-07-05 13:58:34] [config] lr-decay-repeat-warmup: false
[2023-07-05 13:58:34] [config] lr-decay-reset-optimizer: false
[2023-07-05 13:58:34] [config] lr-decay-start:
[2023-07-05 13:58:34] [config]   - 10
[2023-07-05 13:58:34] [config]   - 1
[2023-07-05 13:58:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 13:58:34] [config] lr-report: false
[2023-07-05 13:58:34] [config] lr-warmup: 0
[2023-07-05 13:58:34] [config] lr-warmup-at-reload: false
[2023-07-05 13:58:34] [config] lr-warmup-cycle: false
[2023-07-05 13:58:34] [config] lr-warmup-start-rate: 0
[2023-07-05 13:58:34] [config] max-length: 50
[2023-07-05 13:58:34] [config] max-length-crop: false
[2023-07-05 13:58:34] [config] max-length-factor: 3
[2023-07-05 13:58:34] [config] maxi-batch: 100
[2023-07-05 13:58:34] [config] maxi-batch-sort: trg
[2023-07-05 13:58:34] [config] mini-batch: 64
[2023-07-05 13:58:34] [config] mini-batch-fit: false
[2023-07-05 13:58:34] [config] mini-batch-fit-step: 10
[2023-07-05 13:58:34] [config] mini-batch-round-up: true
[2023-07-05 13:58:34] [config] mini-batch-track-lr: false
[2023-07-05 13:58:34] [config] mini-batch-warmup: 0
[2023-07-05 13:58:34] [config] mini-batch-words: 0
[2023-07-05 13:58:34] [config] mini-batch-words-ref: 0
[2023-07-05 13:58:34] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:58:34] [config] multi-loss-type: sum
[2023-07-05 13:58:34] [config] n-best: false
[2023-07-05 13:58:34] [config] no-nccl: false
[2023-07-05 13:58:34] [config] no-reload: false
[2023-07-05 13:58:34] [config] no-restore-corpus: false
[2023-07-05 13:58:34] [config] normalize: 0
[2023-07-05 13:58:34] [config] normalize-gradient: false
[2023-07-05 13:58:34] [config] num-devices: 0
[2023-07-05 13:58:34] [config] optimizer: adam
[2023-07-05 13:58:34] [config] optimizer-delay: 1
[2023-07-05 13:58:34] [config] optimizer-params:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] output-omit-bias: false
[2023-07-05 13:58:34] [config] overwrite: true
[2023-07-05 13:58:34] [config] precision:
[2023-07-05 13:58:34] [config]   - float32
[2023-07-05 13:58:34] [config]   - float32
[2023-07-05 13:58:34] [config] pretrained-model: ""
[2023-07-05 13:58:34] [config] quantize-biases: false
[2023-07-05 13:58:34] [config] quantize-bits: 0
[2023-07-05 13:58:34] [config] quantize-log-based: false
[2023-07-05 13:58:34] [config] quantize-optimization-steps: 0
[2023-07-05 13:58:34] [config] quiet: false
[2023-07-05 13:58:34] [config] quiet-translation: true
[2023-07-05 13:58:34] [config] relative-paths: false
[2023-07-05 13:58:34] [config] right-left: false
[2023-07-05 13:58:34] [config] save-freq: 10000u
[2023-07-05 13:58:34] [config] seed: 1234
[2023-07-05 13:58:34] [config] sentencepiece-alphas:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] sentencepiece-max-lines: 2000000
[2023-07-05 13:58:34] [config] sentencepiece-options: ""
[2023-07-05 13:58:34] [config] sharding: global
[2023-07-05 13:58:34] [config] shuffle: data
[2023-07-05 13:58:34] [config] shuffle-in-ram: false
[2023-07-05 13:58:34] [config] sigterm: save-and-exit
[2023-07-05 13:58:34] [config] skip: false
[2023-07-05 13:58:34] [config] sqlite: ""
[2023-07-05 13:58:34] [config] sqlite-drop: false
[2023-07-05 13:58:34] [config] sync-freq: 200u
[2023-07-05 13:58:34] [config] sync-sgd: false
[2023-07-05 13:58:34] [config] tempdir: /tmp
[2023-07-05 13:58:34] [config] tied-embeddings: false
[2023-07-05 13:58:34] [config] tied-embeddings-all: false
[2023-07-05 13:58:34] [config] tied-embeddings-src: false
[2023-07-05 13:58:34] [config] train-embedder-rank:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] train-sets:
[2023-07-05 13:58:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 13:58:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 13:58:34] [config] transformer-aan-activation: swish
[2023-07-05 13:58:34] [config] transformer-aan-depth: 2
[2023-07-05 13:58:34] [config] transformer-aan-nogate: false
[2023-07-05 13:58:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 13:58:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 13:58:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 13:58:34] [config] transformer-depth-scaling: false
[2023-07-05 13:58:34] [config] transformer-dim-aan: 2048
[2023-07-05 13:58:34] [config] transformer-dim-ffn: 2048
[2023-07-05 13:58:34] [config] transformer-dropout: 0
[2023-07-05 13:58:34] [config] transformer-dropout-attention: 0
[2023-07-05 13:58:34] [config] transformer-dropout-ffn: 0
[2023-07-05 13:58:34] [config] transformer-ffn-activation: swish
[2023-07-05 13:58:34] [config] transformer-ffn-depth: 2
[2023-07-05 13:58:34] [config] transformer-guided-alignment-layer: last
[2023-07-05 13:58:34] [config] transformer-heads: 8
[2023-07-05 13:58:34] [config] transformer-no-projection: false
[2023-07-05 13:58:34] [config] transformer-pool: false
[2023-07-05 13:58:34] [config] transformer-postprocess: dan
[2023-07-05 13:58:34] [config] transformer-postprocess-emb: d
[2023-07-05 13:58:34] [config] transformer-postprocess-top: ""
[2023-07-05 13:58:34] [config] transformer-preprocess: ""
[2023-07-05 13:58:34] [config] transformer-tied-layers:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] transformer-train-position-embeddings: false
[2023-07-05 13:58:34] [config] tsv: false
[2023-07-05 13:58:34] [config] tsv-fields: 0
[2023-07-05 13:58:34] [config] type: s2s
[2023-07-05 13:58:34] [config] ulr: false
[2023-07-05 13:58:34] [config] ulr-dim-emb: 0
[2023-07-05 13:58:34] [config] ulr-dropout: 0
[2023-07-05 13:58:34] [config] ulr-keys-vectors: ""
[2023-07-05 13:58:34] [config] ulr-query-vectors: ""
[2023-07-05 13:58:34] [config] ulr-softmax-temperature: 1
[2023-07-05 13:58:34] [config] ulr-trainable-transformation: false
[2023-07-05 13:58:34] [config] unlikelihood-loss: false
[2023-07-05 13:58:34] [config] valid-freq: 50000000
[2023-07-05 13:58:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 13:58:34] [config] valid-max-length: 1000
[2023-07-05 13:58:34] [config] valid-metrics:
[2023-07-05 13:58:34] [config]   - cross-entropy
[2023-07-05 13:58:34] [config]   - translation
[2023-07-05 13:58:34] [config] valid-mini-batch: 32
[2023-07-05 13:58:34] [config] valid-reset-stalled: false
[2023-07-05 13:58:34] [config] valid-script-args:
[2023-07-05 13:58:34] [config]   []
[2023-07-05 13:58:34] [config] valid-script-path: ""
[2023-07-05 13:58:34] [config] valid-sets:
[2023-07-05 13:58:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 13:58:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 13:58:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 13:58:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:58:34] [config] vocabs:
[2023-07-05 13:58:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:58:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:58:34] [config] word-penalty: 0
[2023-07-05 13:58:34] [config] word-scores: false
[2023-07-05 13:58:34] [config] workspace: 2048
[2023-07-05 13:58:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 13:58:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:58:34] [training] Using single-device training
[2023-07-05 13:58:34] Synced seed 1234
[2023-07-05 13:58:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 13:58:35] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 13:58:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 13:58:35] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 13:58:35] [valid] No post-processing script given for validating translator
[2023-07-05 13:58:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 13:58:35] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 13:58:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 13:58:36] [comm] Using global sharding
[2023-07-05 13:58:36] [comm] NCCLCommunicators constructed successfully
[2023-07-05 13:58:36] [training] Using 1 GPUs
[2023-07-05 13:58:36] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 13:58:38] Loading Adam parameters
[2023-07-05 13:58:39] [memory] Reserving 823 MB, device gpu0
[2023-07-05 13:58:39] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:58:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 13:58:39] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-07-05 13:58:39] [data] Shuffling data
[2023-07-05 13:58:39] [data] Done reading 20,192 sentences
[2023-07-05 13:58:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 13:58:39] Training started
[2023-07-05 13:58:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 13:58:39] [logits] Applying loss function for 1 factor(s)
[2023-07-05 13:58:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 13:58:39] [memory] Reserving 411 MB, device gpu0
[2023-07-05 13:58:40] Parameter type float32, optimization type float32, casting types false
[2023-07-05 13:58:54] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 2.75246119 * 931,518 @ 256 after 8,385,068 : Time 19.06s : 48869.28 words/s : gNorm 1.8120
[2023-07-05 13:59:31] Seen 18,843 samples
[2023-07-05 13:59:31] Starting data epoch 32 in logical epoch 32
[2023-07-05 13:59:31] [data] Shuffling data
[2023-07-05 13:59:31] [data] Done reading 20,192 sentences
[2023-07-05 13:59:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:00:37] Seen 18,843 samples
[2023-07-05 14:00:37] Starting data epoch 33 in logical epoch 33
[2023-07-05 14:00:37] [data] Shuffling data
[2023-07-05 14:00:37] [data] Done reading 20,192 sentences
[2023-07-05 14:00:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:01:44] Seen 18,843 samples
[2023-07-05 14:01:44] Starting data epoch 34 in logical epoch 34
[2023-07-05 14:01:44] [data] Shuffling data
[2023-07-05 14:01:44] [data] Done reading 20,192 sentences
[2023-07-05 14:01:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:02:35] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 2.39941144 * 936,399 @ 637 after 9,321,467 : Time 221.48s : 4227.94 words/s : gNorm 1.5185
[2023-07-05 14:02:35] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:02:41] Saving Adam parameters
[2023-07-05 14:02:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:03:05] Seen 18,843 samples
[2023-07-05 14:03:05] Starting data epoch 35 in logical epoch 35
[2023-07-05 14:03:05] [data] Shuffling data
[2023-07-05 14:03:05] [data] Done reading 20,192 sentences
[2023-07-05 14:03:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:04:07] Seen 18,843 samples
[2023-07-05 14:04:07] Starting data epoch 36 in logical epoch 36
[2023-07-05 14:04:07] [data] Shuffling data
[2023-07-05 14:04:07] [data] Done reading 20,192 sentences
[2023-07-05 14:04:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:05:21] Seen 18,843 samples
[2023-07-05 14:05:21] Starting data epoch 37 in logical epoch 37
[2023-07-05 14:05:21] [data] Shuffling data
[2023-07-05 14:05:21] [data] Done reading 20,192 sentences
[2023-07-05 14:05:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:06:30] Seen 18,843 samples
[2023-07-05 14:06:30] Starting data epoch 38 in logical epoch 38
[2023-07-05 14:06:30] [data] Shuffling data
[2023-07-05 14:06:30] [data] Done reading 20,192 sentences
[2023-07-05 14:06:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:06:38] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 2.05335832 * 933,298 @ 960 after 10,254,765 : Time 242.54s : 3848.00 words/s : gNorm 1.5393
[2023-07-05 14:07:43] Seen 18,843 samples
[2023-07-05 14:07:43] Starting data epoch 39 in logical epoch 39
[2023-07-05 14:07:43] [data] Shuffling data
[2023-07-05 14:07:44] [data] Done reading 20,192 sentences
[2023-07-05 14:07:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:08:50] Seen 18,843 samples
[2023-07-05 14:08:50] Starting data epoch 40 in logical epoch 40
[2023-07-05 14:08:50] [data] Shuffling data
[2023-07-05 14:08:50] [data] Done reading 20,192 sentences
[2023-07-05 14:08:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:10:00] Seen 18,843 samples
[2023-07-05 14:10:00] Starting data epoch 41 in logical epoch 41
[2023-07-05 14:10:00] Training finished
[2023-07-05 14:10:09] [valid] Ep. 41 : Up. 11864 : cross-entropy : 100.495 : stalled 3 times (last best: 87.4287)
[2023-07-05 14:12:05] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-07-05 14:12:05] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:12:23] Saving Adam parameters
[2023-07-05 14:12:24] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:13:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:13:00] [marian] Running on node22.datos.cluster.uy as process 37047 with command line:
[2023-07-05 14:13:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 14:13:01] [config] after: 0e
[2023-07-05 14:13:01] [config] after-batches: 0
[2023-07-05 14:13:01] [config] after-epochs: 50
[2023-07-05 14:13:01] [config] all-caps-every: 0
[2023-07-05 14:13:01] [config] allow-unk: false
[2023-07-05 14:13:01] [config] authors: false
[2023-07-05 14:13:01] [config] beam-size: 12
[2023-07-05 14:13:01] [config] bert-class-symbol: "[CLS]"
[2023-07-05 14:13:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 14:13:01] [config] bert-masking-fraction: 0.15
[2023-07-05 14:13:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 14:13:01] [config] bert-train-type-embeddings: true
[2023-07-05 14:13:01] [config] bert-type-vocab-size: 2
[2023-07-05 14:13:01] [config] build-info: ""
[2023-07-05 14:13:01] [config] check-gradient-nan: false
[2023-07-05 14:13:01] [config] check-nan: false
[2023-07-05 14:13:01] [config] cite: false
[2023-07-05 14:13:01] [config] clip-norm: 1
[2023-07-05 14:13:01] [config] cost-scaling:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] cost-type: ce-sum
[2023-07-05 14:13:01] [config] cpu-threads: 0
[2023-07-05 14:13:01] [config] data-threads: 8
[2023-07-05 14:13:01] [config] data-weighting: ""
[2023-07-05 14:13:01] [config] data-weighting-type: sentence
[2023-07-05 14:13:01] [config] dec-cell: gru
[2023-07-05 14:13:01] [config] dec-cell-base-depth: 2
[2023-07-05 14:13:01] [config] dec-cell-high-depth: 1
[2023-07-05 14:13:01] [config] dec-depth: 1
[2023-07-05 14:13:01] [config] devices:
[2023-07-05 14:13:01] [config]   - 0
[2023-07-05 14:13:01] [config] dim-emb: 512
[2023-07-05 14:13:01] [config] dim-rnn: 1024
[2023-07-05 14:13:01] [config] dim-vocabs:
[2023-07-05 14:13:01] [config]   - 36507
[2023-07-05 14:13:01] [config]   - 54042
[2023-07-05 14:13:01] [config] disp-first: 0
[2023-07-05 14:13:01] [config] disp-freq: 1000u
[2023-07-05 14:13:01] [config] disp-label-counts: true
[2023-07-05 14:13:01] [config] dropout-rnn: 0
[2023-07-05 14:13:01] [config] dropout-src: 0
[2023-07-05 14:13:01] [config] dropout-trg: 0
[2023-07-05 14:13:01] [config] dump-config: ""
[2023-07-05 14:13:01] [config] dynamic-gradient-scaling:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] early-stopping: 10
[2023-07-05 14:13:01] [config] early-stopping-on: first
[2023-07-05 14:13:01] [config] embedding-fix-src: false
[2023-07-05 14:13:01] [config] embedding-fix-trg: false
[2023-07-05 14:13:01] [config] embedding-normalization: false
[2023-07-05 14:13:01] [config] embedding-vectors:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] enc-cell: gru
[2023-07-05 14:13:01] [config] enc-cell-depth: 1
[2023-07-05 14:13:01] [config] enc-depth: 1
[2023-07-05 14:13:01] [config] enc-type: bidirectional
[2023-07-05 14:13:01] [config] english-title-case-every: 0
[2023-07-05 14:13:01] [config] exponential-smoothing: 0
[2023-07-05 14:13:01] [config] factor-weight: 1
[2023-07-05 14:13:01] [config] factors-combine: sum
[2023-07-05 14:13:01] [config] factors-dim-emb: 0
[2023-07-05 14:13:01] [config] gradient-checkpointing: false
[2023-07-05 14:13:01] [config] gradient-norm-average-window: 100
[2023-07-05 14:13:01] [config] guided-alignment: none
[2023-07-05 14:13:01] [config] guided-alignment-cost: mse
[2023-07-05 14:13:01] [config] guided-alignment-weight: 0.1
[2023-07-05 14:13:01] [config] ignore-model-config: false
[2023-07-05 14:13:01] [config] input-types:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] interpolate-env-vars: false
[2023-07-05 14:13:01] [config] keep-best: false
[2023-07-05 14:13:01] [config] label-smoothing: 0
[2023-07-05 14:13:01] [config] layer-normalization: false
[2023-07-05 14:13:01] [config] learn-rate: 0.0001
[2023-07-05 14:13:01] [config] lemma-dependency: ""
[2023-07-05 14:13:01] [config] lemma-dim-emb: 0
[2023-07-05 14:13:01] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 14:13:01] [config] log-level: info
[2023-07-05 14:13:01] [config] log-time-zone: ""
[2023-07-05 14:13:01] [config] logical-epoch:
[2023-07-05 14:13:01] [config]   - 1e
[2023-07-05 14:13:01] [config]   - 0
[2023-07-05 14:13:01] [config] lr-decay: 0
[2023-07-05 14:13:01] [config] lr-decay-freq: 50000
[2023-07-05 14:13:01] [config] lr-decay-inv-sqrt:
[2023-07-05 14:13:01] [config]   - 0
[2023-07-05 14:13:01] [config] lr-decay-repeat-warmup: false
[2023-07-05 14:13:01] [config] lr-decay-reset-optimizer: false
[2023-07-05 14:13:01] [config] lr-decay-start:
[2023-07-05 14:13:01] [config]   - 10
[2023-07-05 14:13:01] [config]   - 1
[2023-07-05 14:13:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 14:13:01] [config] lr-report: false
[2023-07-05 14:13:01] [config] lr-warmup: 0
[2023-07-05 14:13:01] [config] lr-warmup-at-reload: false
[2023-07-05 14:13:01] [config] lr-warmup-cycle: false
[2023-07-05 14:13:01] [config] lr-warmup-start-rate: 0
[2023-07-05 14:13:01] [config] max-length: 50
[2023-07-05 14:13:01] [config] max-length-crop: false
[2023-07-05 14:13:01] [config] max-length-factor: 3
[2023-07-05 14:13:01] [config] maxi-batch: 100
[2023-07-05 14:13:01] [config] maxi-batch-sort: trg
[2023-07-05 14:13:01] [config] mini-batch: 64
[2023-07-05 14:13:01] [config] mini-batch-fit: false
[2023-07-05 14:13:01] [config] mini-batch-fit-step: 10
[2023-07-05 14:13:01] [config] mini-batch-round-up: true
[2023-07-05 14:13:01] [config] mini-batch-track-lr: false
[2023-07-05 14:13:01] [config] mini-batch-warmup: 0
[2023-07-05 14:13:01] [config] mini-batch-words: 0
[2023-07-05 14:13:01] [config] mini-batch-words-ref: 0
[2023-07-05 14:13:01] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:13:01] [config] multi-loss-type: sum
[2023-07-05 14:13:01] [config] n-best: false
[2023-07-05 14:13:01] [config] no-nccl: false
[2023-07-05 14:13:01] [config] no-reload: false
[2023-07-05 14:13:01] [config] no-restore-corpus: false
[2023-07-05 14:13:01] [config] normalize: 0
[2023-07-05 14:13:01] [config] normalize-gradient: false
[2023-07-05 14:13:01] [config] num-devices: 0
[2023-07-05 14:13:01] [config] optimizer: adam
[2023-07-05 14:13:01] [config] optimizer-delay: 1
[2023-07-05 14:13:01] [config] optimizer-params:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] output-omit-bias: false
[2023-07-05 14:13:01] [config] overwrite: true
[2023-07-05 14:13:01] [config] precision:
[2023-07-05 14:13:01] [config]   - float32
[2023-07-05 14:13:01] [config]   - float32
[2023-07-05 14:13:01] [config] pretrained-model: ""
[2023-07-05 14:13:01] [config] quantize-biases: false
[2023-07-05 14:13:01] [config] quantize-bits: 0
[2023-07-05 14:13:01] [config] quantize-log-based: false
[2023-07-05 14:13:01] [config] quantize-optimization-steps: 0
[2023-07-05 14:13:01] [config] quiet: false
[2023-07-05 14:13:01] [config] quiet-translation: true
[2023-07-05 14:13:01] [config] relative-paths: false
[2023-07-05 14:13:01] [config] right-left: false
[2023-07-05 14:13:01] [config] save-freq: 10000u
[2023-07-05 14:13:01] [config] seed: 1234
[2023-07-05 14:13:01] [config] sentencepiece-alphas:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] sentencepiece-max-lines: 2000000
[2023-07-05 14:13:01] [config] sentencepiece-options: ""
[2023-07-05 14:13:01] [config] sharding: global
[2023-07-05 14:13:01] [config] shuffle: data
[2023-07-05 14:13:01] [config] shuffle-in-ram: false
[2023-07-05 14:13:01] [config] sigterm: save-and-exit
[2023-07-05 14:13:01] [config] skip: false
[2023-07-05 14:13:01] [config] sqlite: ""
[2023-07-05 14:13:01] [config] sqlite-drop: false
[2023-07-05 14:13:01] [config] sync-freq: 200u
[2023-07-05 14:13:01] [config] sync-sgd: false
[2023-07-05 14:13:01] [config] tempdir: /tmp
[2023-07-05 14:13:01] [config] tied-embeddings: false
[2023-07-05 14:13:01] [config] tied-embeddings-all: false
[2023-07-05 14:13:01] [config] tied-embeddings-src: false
[2023-07-05 14:13:01] [config] train-embedder-rank:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] train-sets:
[2023-07-05 14:13:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 14:13:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 14:13:01] [config] transformer-aan-activation: swish
[2023-07-05 14:13:01] [config] transformer-aan-depth: 2
[2023-07-05 14:13:01] [config] transformer-aan-nogate: false
[2023-07-05 14:13:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 14:13:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 14:13:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 14:13:01] [config] transformer-depth-scaling: false
[2023-07-05 14:13:01] [config] transformer-dim-aan: 2048
[2023-07-05 14:13:01] [config] transformer-dim-ffn: 2048
[2023-07-05 14:13:01] [config] transformer-dropout: 0
[2023-07-05 14:13:01] [config] transformer-dropout-attention: 0
[2023-07-05 14:13:01] [config] transformer-dropout-ffn: 0
[2023-07-05 14:13:01] [config] transformer-ffn-activation: swish
[2023-07-05 14:13:01] [config] transformer-ffn-depth: 2
[2023-07-05 14:13:01] [config] transformer-guided-alignment-layer: last
[2023-07-05 14:13:01] [config] transformer-heads: 8
[2023-07-05 14:13:01] [config] transformer-no-projection: false
[2023-07-05 14:13:01] [config] transformer-pool: false
[2023-07-05 14:13:01] [config] transformer-postprocess: dan
[2023-07-05 14:13:01] [config] transformer-postprocess-emb: d
[2023-07-05 14:13:01] [config] transformer-postprocess-top: ""
[2023-07-05 14:13:01] [config] transformer-preprocess: ""
[2023-07-05 14:13:01] [config] transformer-tied-layers:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] transformer-train-position-embeddings: false
[2023-07-05 14:13:01] [config] tsv: false
[2023-07-05 14:13:01] [config] tsv-fields: 0
[2023-07-05 14:13:01] [config] type: s2s
[2023-07-05 14:13:01] [config] ulr: false
[2023-07-05 14:13:01] [config] ulr-dim-emb: 0
[2023-07-05 14:13:01] [config] ulr-dropout: 0
[2023-07-05 14:13:01] [config] ulr-keys-vectors: ""
[2023-07-05 14:13:01] [config] ulr-query-vectors: ""
[2023-07-05 14:13:01] [config] ulr-softmax-temperature: 1
[2023-07-05 14:13:01] [config] ulr-trainable-transformation: false
[2023-07-05 14:13:01] [config] unlikelihood-loss: false
[2023-07-05 14:13:01] [config] valid-freq: 50000000
[2023-07-05 14:13:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 14:13:01] [config] valid-max-length: 1000
[2023-07-05 14:13:01] [config] valid-metrics:
[2023-07-05 14:13:01] [config]   - cross-entropy
[2023-07-05 14:13:01] [config]   - translation
[2023-07-05 14:13:01] [config] valid-mini-batch: 32
[2023-07-05 14:13:01] [config] valid-reset-stalled: false
[2023-07-05 14:13:01] [config] valid-script-args:
[2023-07-05 14:13:01] [config]   []
[2023-07-05 14:13:01] [config] valid-script-path: ""
[2023-07-05 14:13:01] [config] valid-sets:
[2023-07-05 14:13:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 14:13:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 14:13:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 14:13:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:13:01] [config] vocabs:
[2023-07-05 14:13:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:13:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:13:01] [config] word-penalty: 0
[2023-07-05 14:13:01] [config] word-scores: false
[2023-07-05 14:13:01] [config] workspace: 2048
[2023-07-05 14:13:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:13:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:13:01] [training] Using single-device training
[2023-07-05 14:13:01] Synced seed 1234
[2023-07-05 14:13:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:13:01] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 14:13:01] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:13:01] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 14:13:02] [valid] No post-processing script given for validating translator
[2023-07-05 14:13:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:13:02] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 14:13:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 14:13:03] [comm] Using global sharding
[2023-07-05 14:13:03] [comm] NCCLCommunicators constructed successfully
[2023-07-05 14:13:03] [training] Using 1 GPUs
[2023-07-05 14:13:03] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:13:22] Loading Adam parameters
[2023-07-05 14:13:23] [memory] Reserving 823 MB, device gpu0
[2023-07-05 14:13:23] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:13:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:13:23] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-07-05 14:13:23] [data] Shuffling data
[2023-07-05 14:13:23] [data] Done reading 20,192 sentences
[2023-07-05 14:13:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:13:23] Training started
[2023-07-05 14:13:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 14:13:23] [logits] Applying loss function for 1 factor(s)
[2023-07-05 14:13:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 14:13:24] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:13:24] Parameter type float32, optimization type float32, casting types false
[2023-07-05 14:13:41] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 1.74772930 * 928,175 @ 688 after 11,182,940 : Time 39.89s : 23270.13 words/s : gNorm 1.5358
[2023-07-05 14:14:06] Seen 18,843 samples
[2023-07-05 14:14:06] Starting data epoch 42 in logical epoch 42
[2023-07-05 14:14:06] [data] Shuffling data
[2023-07-05 14:14:06] [data] Done reading 20,192 sentences
[2023-07-05 14:14:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:15:10] Seen 18,843 samples
[2023-07-05 14:15:10] Starting data epoch 43 in logical epoch 43
[2023-07-05 14:15:10] [data] Shuffling data
[2023-07-05 14:15:11] [data] Done reading 20,192 sentences
[2023-07-05 14:15:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:16:19] Seen 18,843 samples
[2023-07-05 14:16:19] Starting data epoch 44 in logical epoch 44
[2023-07-05 14:16:19] [data] Shuffling data
[2023-07-05 14:16:19] [data] Done reading 20,192 sentences
[2023-07-05 14:16:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:17:16] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 1.49141002 * 929,114 @ 512 after 12,112,054 : Time 214.43s : 4332.85 words/s : gNorm 1.4430
[2023-07-05 14:17:27] Seen 18,843 samples
[2023-07-05 14:17:27] Starting data epoch 45 in logical epoch 45
[2023-07-05 14:17:27] [data] Shuffling data
[2023-07-05 14:17:27] [data] Done reading 20,192 sentences
[2023-07-05 14:17:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:18:37] Seen 18,843 samples
[2023-07-05 14:18:37] Starting data epoch 46 in logical epoch 46
[2023-07-05 14:18:37] [data] Shuffling data
[2023-07-05 14:18:37] [data] Done reading 20,192 sentences
[2023-07-05 14:18:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:19:48] Seen 18,843 samples
[2023-07-05 14:19:48] Starting data epoch 47 in logical epoch 47
[2023-07-05 14:19:48] [data] Shuffling data
[2023-07-05 14:19:48] [data] Done reading 20,192 sentences
[2023-07-05 14:19:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:20:59] Seen 18,843 samples
[2023-07-05 14:20:59] Starting data epoch 48 in logical epoch 48
[2023-07-05 14:20:59] [data] Shuffling data
[2023-07-05 14:20:59] [data] Done reading 20,192 sentences
[2023-07-05 14:20:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:21:12] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 1.27121317 * 936,624 @ 960 after 13,048,678 : Time 236.32s : 3963.35 words/s : gNorm 1.3602
[2023-07-05 14:22:01] Seen 18,843 samples
[2023-07-05 14:22:02] Starting data epoch 49 in logical epoch 49
[2023-07-05 14:22:02] [data] Shuffling data
[2023-07-05 14:22:02] [data] Done reading 20,192 sentences
[2023-07-05 14:22:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:23:10] Seen 18,843 samples
[2023-07-05 14:23:10] Starting data epoch 50 in logical epoch 50
[2023-07-05 14:23:10] [data] Shuffling data
[2023-07-05 14:23:10] [data] Done reading 20,192 sentences
[2023-07-05 14:23:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:24:20] Seen 18,843 samples
[2023-07-05 14:24:20] Starting data epoch 51 in logical epoch 51
[2023-07-05 14:24:20] Training finished
[2023-07-05 14:24:29] [valid] Ep. 51 : Up. 14829 : cross-entropy : 108.392 : stalled 4 times (last best: 87.4287)
[2023-07-05 14:26:20] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-07-05 14:26:20] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:26:31] Saving Adam parameters
[2023-07-05 14:26:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:27:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:27:08] [marian] Running on node22.datos.cluster.uy as process 10029 with command line:
[2023-07-05 14:27:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 14:27:08] [config] after: 0e
[2023-07-05 14:27:08] [config] after-batches: 0
[2023-07-05 14:27:08] [config] after-epochs: 60
[2023-07-05 14:27:08] [config] all-caps-every: 0
[2023-07-05 14:27:08] [config] allow-unk: false
[2023-07-05 14:27:08] [config] authors: false
[2023-07-05 14:27:08] [config] beam-size: 12
[2023-07-05 14:27:08] [config] bert-class-symbol: "[CLS]"
[2023-07-05 14:27:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 14:27:08] [config] bert-masking-fraction: 0.15
[2023-07-05 14:27:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 14:27:08] [config] bert-train-type-embeddings: true
[2023-07-05 14:27:08] [config] bert-type-vocab-size: 2
[2023-07-05 14:27:08] [config] build-info: ""
[2023-07-05 14:27:08] [config] check-gradient-nan: false
[2023-07-05 14:27:08] [config] check-nan: false
[2023-07-05 14:27:08] [config] cite: false
[2023-07-05 14:27:08] [config] clip-norm: 1
[2023-07-05 14:27:08] [config] cost-scaling:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] cost-type: ce-sum
[2023-07-05 14:27:08] [config] cpu-threads: 0
[2023-07-05 14:27:08] [config] data-threads: 8
[2023-07-05 14:27:08] [config] data-weighting: ""
[2023-07-05 14:27:08] [config] data-weighting-type: sentence
[2023-07-05 14:27:08] [config] dec-cell: gru
[2023-07-05 14:27:08] [config] dec-cell-base-depth: 2
[2023-07-05 14:27:08] [config] dec-cell-high-depth: 1
[2023-07-05 14:27:08] [config] dec-depth: 1
[2023-07-05 14:27:08] [config] devices:
[2023-07-05 14:27:08] [config]   - 0
[2023-07-05 14:27:08] [config] dim-emb: 512
[2023-07-05 14:27:08] [config] dim-rnn: 1024
[2023-07-05 14:27:08] [config] dim-vocabs:
[2023-07-05 14:27:08] [config]   - 36507
[2023-07-05 14:27:08] [config]   - 54042
[2023-07-05 14:27:08] [config] disp-first: 0
[2023-07-05 14:27:08] [config] disp-freq: 1000u
[2023-07-05 14:27:08] [config] disp-label-counts: true
[2023-07-05 14:27:08] [config] dropout-rnn: 0
[2023-07-05 14:27:08] [config] dropout-src: 0
[2023-07-05 14:27:08] [config] dropout-trg: 0
[2023-07-05 14:27:08] [config] dump-config: ""
[2023-07-05 14:27:08] [config] dynamic-gradient-scaling:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] early-stopping: 10
[2023-07-05 14:27:08] [config] early-stopping-on: first
[2023-07-05 14:27:08] [config] embedding-fix-src: false
[2023-07-05 14:27:08] [config] embedding-fix-trg: false
[2023-07-05 14:27:08] [config] embedding-normalization: false
[2023-07-05 14:27:08] [config] embedding-vectors:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] enc-cell: gru
[2023-07-05 14:27:08] [config] enc-cell-depth: 1
[2023-07-05 14:27:08] [config] enc-depth: 1
[2023-07-05 14:27:08] [config] enc-type: bidirectional
[2023-07-05 14:27:08] [config] english-title-case-every: 0
[2023-07-05 14:27:08] [config] exponential-smoothing: 0
[2023-07-05 14:27:08] [config] factor-weight: 1
[2023-07-05 14:27:08] [config] factors-combine: sum
[2023-07-05 14:27:08] [config] factors-dim-emb: 0
[2023-07-05 14:27:08] [config] gradient-checkpointing: false
[2023-07-05 14:27:08] [config] gradient-norm-average-window: 100
[2023-07-05 14:27:08] [config] guided-alignment: none
[2023-07-05 14:27:08] [config] guided-alignment-cost: mse
[2023-07-05 14:27:08] [config] guided-alignment-weight: 0.1
[2023-07-05 14:27:08] [config] ignore-model-config: false
[2023-07-05 14:27:08] [config] input-types:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] interpolate-env-vars: false
[2023-07-05 14:27:08] [config] keep-best: false
[2023-07-05 14:27:08] [config] label-smoothing: 0
[2023-07-05 14:27:08] [config] layer-normalization: false
[2023-07-05 14:27:08] [config] learn-rate: 0.0001
[2023-07-05 14:27:08] [config] lemma-dependency: ""
[2023-07-05 14:27:08] [config] lemma-dim-emb: 0
[2023-07-05 14:27:08] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 14:27:08] [config] log-level: info
[2023-07-05 14:27:08] [config] log-time-zone: ""
[2023-07-05 14:27:08] [config] logical-epoch:
[2023-07-05 14:27:08] [config]   - 1e
[2023-07-05 14:27:08] [config]   - 0
[2023-07-05 14:27:08] [config] lr-decay: 0
[2023-07-05 14:27:08] [config] lr-decay-freq: 50000
[2023-07-05 14:27:08] [config] lr-decay-inv-sqrt:
[2023-07-05 14:27:08] [config]   - 0
[2023-07-05 14:27:08] [config] lr-decay-repeat-warmup: false
[2023-07-05 14:27:08] [config] lr-decay-reset-optimizer: false
[2023-07-05 14:27:08] [config] lr-decay-start:
[2023-07-05 14:27:08] [config]   - 10
[2023-07-05 14:27:08] [config]   - 1
[2023-07-05 14:27:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 14:27:08] [config] lr-report: false
[2023-07-05 14:27:08] [config] lr-warmup: 0
[2023-07-05 14:27:08] [config] lr-warmup-at-reload: false
[2023-07-05 14:27:08] [config] lr-warmup-cycle: false
[2023-07-05 14:27:08] [config] lr-warmup-start-rate: 0
[2023-07-05 14:27:08] [config] max-length: 50
[2023-07-05 14:27:08] [config] max-length-crop: false
[2023-07-05 14:27:08] [config] max-length-factor: 3
[2023-07-05 14:27:08] [config] maxi-batch: 100
[2023-07-05 14:27:08] [config] maxi-batch-sort: trg
[2023-07-05 14:27:08] [config] mini-batch: 64
[2023-07-05 14:27:08] [config] mini-batch-fit: false
[2023-07-05 14:27:08] [config] mini-batch-fit-step: 10
[2023-07-05 14:27:08] [config] mini-batch-round-up: true
[2023-07-05 14:27:08] [config] mini-batch-track-lr: false
[2023-07-05 14:27:08] [config] mini-batch-warmup: 0
[2023-07-05 14:27:08] [config] mini-batch-words: 0
[2023-07-05 14:27:08] [config] mini-batch-words-ref: 0
[2023-07-05 14:27:08] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:27:08] [config] multi-loss-type: sum
[2023-07-05 14:27:08] [config] n-best: false
[2023-07-05 14:27:08] [config] no-nccl: false
[2023-07-05 14:27:08] [config] no-reload: false
[2023-07-05 14:27:08] [config] no-restore-corpus: false
[2023-07-05 14:27:08] [config] normalize: 0
[2023-07-05 14:27:08] [config] normalize-gradient: false
[2023-07-05 14:27:08] [config] num-devices: 0
[2023-07-05 14:27:08] [config] optimizer: adam
[2023-07-05 14:27:08] [config] optimizer-delay: 1
[2023-07-05 14:27:08] [config] optimizer-params:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] output-omit-bias: false
[2023-07-05 14:27:08] [config] overwrite: true
[2023-07-05 14:27:08] [config] precision:
[2023-07-05 14:27:08] [config]   - float32
[2023-07-05 14:27:08] [config]   - float32
[2023-07-05 14:27:08] [config] pretrained-model: ""
[2023-07-05 14:27:08] [config] quantize-biases: false
[2023-07-05 14:27:08] [config] quantize-bits: 0
[2023-07-05 14:27:08] [config] quantize-log-based: false
[2023-07-05 14:27:08] [config] quantize-optimization-steps: 0
[2023-07-05 14:27:08] [config] quiet: false
[2023-07-05 14:27:08] [config] quiet-translation: true
[2023-07-05 14:27:08] [config] relative-paths: false
[2023-07-05 14:27:08] [config] right-left: false
[2023-07-05 14:27:08] [config] save-freq: 10000u
[2023-07-05 14:27:08] [config] seed: 1234
[2023-07-05 14:27:08] [config] sentencepiece-alphas:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] sentencepiece-max-lines: 2000000
[2023-07-05 14:27:08] [config] sentencepiece-options: ""
[2023-07-05 14:27:08] [config] sharding: global
[2023-07-05 14:27:08] [config] shuffle: data
[2023-07-05 14:27:08] [config] shuffle-in-ram: false
[2023-07-05 14:27:08] [config] sigterm: save-and-exit
[2023-07-05 14:27:08] [config] skip: false
[2023-07-05 14:27:08] [config] sqlite: ""
[2023-07-05 14:27:08] [config] sqlite-drop: false
[2023-07-05 14:27:08] [config] sync-freq: 200u
[2023-07-05 14:27:08] [config] sync-sgd: false
[2023-07-05 14:27:08] [config] tempdir: /tmp
[2023-07-05 14:27:08] [config] tied-embeddings: false
[2023-07-05 14:27:08] [config] tied-embeddings-all: false
[2023-07-05 14:27:08] [config] tied-embeddings-src: false
[2023-07-05 14:27:08] [config] train-embedder-rank:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] train-sets:
[2023-07-05 14:27:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 14:27:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 14:27:08] [config] transformer-aan-activation: swish
[2023-07-05 14:27:08] [config] transformer-aan-depth: 2
[2023-07-05 14:27:08] [config] transformer-aan-nogate: false
[2023-07-05 14:27:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 14:27:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 14:27:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 14:27:08] [config] transformer-depth-scaling: false
[2023-07-05 14:27:08] [config] transformer-dim-aan: 2048
[2023-07-05 14:27:08] [config] transformer-dim-ffn: 2048
[2023-07-05 14:27:08] [config] transformer-dropout: 0
[2023-07-05 14:27:08] [config] transformer-dropout-attention: 0
[2023-07-05 14:27:08] [config] transformer-dropout-ffn: 0
[2023-07-05 14:27:08] [config] transformer-ffn-activation: swish
[2023-07-05 14:27:08] [config] transformer-ffn-depth: 2
[2023-07-05 14:27:08] [config] transformer-guided-alignment-layer: last
[2023-07-05 14:27:08] [config] transformer-heads: 8
[2023-07-05 14:27:08] [config] transformer-no-projection: false
[2023-07-05 14:27:08] [config] transformer-pool: false
[2023-07-05 14:27:08] [config] transformer-postprocess: dan
[2023-07-05 14:27:08] [config] transformer-postprocess-emb: d
[2023-07-05 14:27:08] [config] transformer-postprocess-top: ""
[2023-07-05 14:27:08] [config] transformer-preprocess: ""
[2023-07-05 14:27:08] [config] transformer-tied-layers:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] transformer-train-position-embeddings: false
[2023-07-05 14:27:08] [config] tsv: false
[2023-07-05 14:27:08] [config] tsv-fields: 0
[2023-07-05 14:27:08] [config] type: s2s
[2023-07-05 14:27:08] [config] ulr: false
[2023-07-05 14:27:08] [config] ulr-dim-emb: 0
[2023-07-05 14:27:08] [config] ulr-dropout: 0
[2023-07-05 14:27:08] [config] ulr-keys-vectors: ""
[2023-07-05 14:27:08] [config] ulr-query-vectors: ""
[2023-07-05 14:27:08] [config] ulr-softmax-temperature: 1
[2023-07-05 14:27:08] [config] ulr-trainable-transformation: false
[2023-07-05 14:27:08] [config] unlikelihood-loss: false
[2023-07-05 14:27:08] [config] valid-freq: 50000000
[2023-07-05 14:27:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 14:27:08] [config] valid-max-length: 1000
[2023-07-05 14:27:08] [config] valid-metrics:
[2023-07-05 14:27:08] [config]   - cross-entropy
[2023-07-05 14:27:08] [config]   - translation
[2023-07-05 14:27:08] [config] valid-mini-batch: 32
[2023-07-05 14:27:08] [config] valid-reset-stalled: false
[2023-07-05 14:27:08] [config] valid-script-args:
[2023-07-05 14:27:08] [config]   []
[2023-07-05 14:27:08] [config] valid-script-path: ""
[2023-07-05 14:27:08] [config] valid-sets:
[2023-07-05 14:27:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 14:27:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 14:27:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 14:27:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:27:08] [config] vocabs:
[2023-07-05 14:27:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:27:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:27:08] [config] word-penalty: 0
[2023-07-05 14:27:08] [config] word-scores: false
[2023-07-05 14:27:08] [config] workspace: 2048
[2023-07-05 14:27:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:27:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:27:08] [training] Using single-device training
[2023-07-05 14:27:09] Synced seed 1234
[2023-07-05 14:27:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:27:09] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 14:27:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:27:09] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 14:27:10] [valid] No post-processing script given for validating translator
[2023-07-05 14:27:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:27:10] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 14:27:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 14:27:11] [comm] Using global sharding
[2023-07-05 14:27:11] [comm] NCCLCommunicators constructed successfully
[2023-07-05 14:27:11] [training] Using 1 GPUs
[2023-07-05 14:27:11] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:27:29] Loading Adam parameters
[2023-07-05 14:27:29] [memory] Reserving 823 MB, device gpu0
[2023-07-05 14:27:29] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:27:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:27:29] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-07-05 14:27:29] [data] Shuffling data
[2023-07-05 14:27:29] [data] Done reading 20,192 sentences
[2023-07-05 14:27:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:27:29] Training started
[2023-07-05 14:27:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 14:27:30] [logits] Applying loss function for 1 factor(s)
[2023-07-05 14:27:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 14:27:30] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:27:30] Parameter type float32, optimization type float32, casting types false
[2023-07-05 14:27:52] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 1.05336440 * 926,408 @ 428 after 13,975,086 : Time 42.24s : 21933.16 words/s : gNorm 1.1650
[2023-07-05 14:28:13] Seen 18,843 samples
[2023-07-05 14:28:13] Starting data epoch 52 in logical epoch 52
[2023-07-05 14:28:13] [data] Shuffling data
[2023-07-05 14:28:13] [data] Done reading 20,192 sentences
[2023-07-05 14:28:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:29:16] Seen 18,843 samples
[2023-07-05 14:29:16] Starting data epoch 53 in logical epoch 53
[2023-07-05 14:29:16] [data] Shuffling data
[2023-07-05 14:29:16] [data] Done reading 20,192 sentences
[2023-07-05 14:29:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:30:26] Seen 18,843 samples
[2023-07-05 14:30:26] Starting data epoch 54 in logical epoch 54
[2023-07-05 14:30:26] [data] Shuffling data
[2023-07-05 14:30:26] [data] Done reading 20,192 sentences
[2023-07-05 14:30:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:31:32] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 0.89047176 * 932,781 @ 128 after 14,907,867 : Time 220.03s : 4239.33 words/s : gNorm 1.1073
[2023-07-05 14:31:36] Seen 18,843 samples
[2023-07-05 14:31:36] Starting data epoch 55 in logical epoch 55
[2023-07-05 14:31:36] [data] Shuffling data
[2023-07-05 14:31:36] [data] Done reading 20,192 sentences
[2023-07-05 14:31:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:32:45] Seen 18,843 samples
[2023-07-05 14:32:46] Starting data epoch 56 in logical epoch 56
[2023-07-05 14:32:46] [data] Shuffling data
[2023-07-05 14:32:46] [data] Done reading 20,192 sentences
[2023-07-05 14:32:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:33:53] Seen 18,843 samples
[2023-07-05 14:33:53] Starting data epoch 57 in logical epoch 57
[2023-07-05 14:33:53] [data] Shuffling data
[2023-07-05 14:33:53] [data] Done reading 20,192 sentences
[2023-07-05 14:33:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:35:00] Seen 18,843 samples
[2023-07-05 14:35:00] Starting data epoch 58 in logical epoch 58
[2023-07-05 14:35:00] [data] Shuffling data
[2023-07-05 14:35:00] [data] Done reading 20,192 sentences
[2023-07-05 14:35:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:35:23] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 0.73375332 * 935,840 @ 1,399 after 15,843,707 : Time 230.93s : 4052.44 words/s : gNorm 0.9491
[2023-07-05 14:36:13] Seen 18,843 samples
[2023-07-05 14:36:13] Starting data epoch 59 in logical epoch 59
[2023-07-05 14:36:13] [data] Shuffling data
[2023-07-05 14:36:13] [data] Done reading 20,192 sentences
[2023-07-05 14:36:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:37:24] Seen 18,843 samples
[2023-07-05 14:37:24] Starting data epoch 60 in logical epoch 60
[2023-07-05 14:37:24] [data] Shuffling data
[2023-07-05 14:37:24] [data] Done reading 20,192 sentences
[2023-07-05 14:37:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:38:34] Seen 18,843 samples
[2023-07-05 14:38:34] Starting data epoch 61 in logical epoch 61
[2023-07-05 14:38:34] Training finished
[2023-07-05 14:38:42] [valid] Ep. 61 : Up. 17795 : cross-entropy : 116.169 : stalled 5 times (last best: 87.4287)
[2023-07-05 14:40:29] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-07-05 14:40:29] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:40:39] Saving Adam parameters
[2023-07-05 14:40:41] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:41:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:41:04] [marian] Running on node22.datos.cluster.uy as process 23900 with command line:
[2023-07-05 14:41:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 14:41:04] [config] after: 0e
[2023-07-05 14:41:04] [config] after-batches: 0
[2023-07-05 14:41:04] [config] after-epochs: 70
[2023-07-05 14:41:04] [config] all-caps-every: 0
[2023-07-05 14:41:04] [config] allow-unk: false
[2023-07-05 14:41:04] [config] authors: false
[2023-07-05 14:41:04] [config] beam-size: 12
[2023-07-05 14:41:04] [config] bert-class-symbol: "[CLS]"
[2023-07-05 14:41:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 14:41:04] [config] bert-masking-fraction: 0.15
[2023-07-05 14:41:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 14:41:04] [config] bert-train-type-embeddings: true
[2023-07-05 14:41:04] [config] bert-type-vocab-size: 2
[2023-07-05 14:41:04] [config] build-info: ""
[2023-07-05 14:41:04] [config] check-gradient-nan: false
[2023-07-05 14:41:04] [config] check-nan: false
[2023-07-05 14:41:04] [config] cite: false
[2023-07-05 14:41:04] [config] clip-norm: 1
[2023-07-05 14:41:04] [config] cost-scaling:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] cost-type: ce-sum
[2023-07-05 14:41:04] [config] cpu-threads: 0
[2023-07-05 14:41:04] [config] data-threads: 8
[2023-07-05 14:41:04] [config] data-weighting: ""
[2023-07-05 14:41:04] [config] data-weighting-type: sentence
[2023-07-05 14:41:04] [config] dec-cell: gru
[2023-07-05 14:41:04] [config] dec-cell-base-depth: 2
[2023-07-05 14:41:04] [config] dec-cell-high-depth: 1
[2023-07-05 14:41:04] [config] dec-depth: 1
[2023-07-05 14:41:04] [config] devices:
[2023-07-05 14:41:04] [config]   - 0
[2023-07-05 14:41:04] [config] dim-emb: 512
[2023-07-05 14:41:04] [config] dim-rnn: 1024
[2023-07-05 14:41:04] [config] dim-vocabs:
[2023-07-05 14:41:04] [config]   - 36507
[2023-07-05 14:41:04] [config]   - 54042
[2023-07-05 14:41:04] [config] disp-first: 0
[2023-07-05 14:41:04] [config] disp-freq: 1000u
[2023-07-05 14:41:04] [config] disp-label-counts: true
[2023-07-05 14:41:04] [config] dropout-rnn: 0
[2023-07-05 14:41:04] [config] dropout-src: 0
[2023-07-05 14:41:04] [config] dropout-trg: 0
[2023-07-05 14:41:04] [config] dump-config: ""
[2023-07-05 14:41:04] [config] dynamic-gradient-scaling:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] early-stopping: 10
[2023-07-05 14:41:04] [config] early-stopping-on: first
[2023-07-05 14:41:04] [config] embedding-fix-src: false
[2023-07-05 14:41:04] [config] embedding-fix-trg: false
[2023-07-05 14:41:04] [config] embedding-normalization: false
[2023-07-05 14:41:04] [config] embedding-vectors:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] enc-cell: gru
[2023-07-05 14:41:04] [config] enc-cell-depth: 1
[2023-07-05 14:41:04] [config] enc-depth: 1
[2023-07-05 14:41:04] [config] enc-type: bidirectional
[2023-07-05 14:41:04] [config] english-title-case-every: 0
[2023-07-05 14:41:04] [config] exponential-smoothing: 0
[2023-07-05 14:41:04] [config] factor-weight: 1
[2023-07-05 14:41:04] [config] factors-combine: sum
[2023-07-05 14:41:04] [config] factors-dim-emb: 0
[2023-07-05 14:41:04] [config] gradient-checkpointing: false
[2023-07-05 14:41:04] [config] gradient-norm-average-window: 100
[2023-07-05 14:41:04] [config] guided-alignment: none
[2023-07-05 14:41:04] [config] guided-alignment-cost: mse
[2023-07-05 14:41:04] [config] guided-alignment-weight: 0.1
[2023-07-05 14:41:04] [config] ignore-model-config: false
[2023-07-05 14:41:04] [config] input-types:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] interpolate-env-vars: false
[2023-07-05 14:41:04] [config] keep-best: false
[2023-07-05 14:41:04] [config] label-smoothing: 0
[2023-07-05 14:41:04] [config] layer-normalization: false
[2023-07-05 14:41:04] [config] learn-rate: 0.0001
[2023-07-05 14:41:04] [config] lemma-dependency: ""
[2023-07-05 14:41:04] [config] lemma-dim-emb: 0
[2023-07-05 14:41:04] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 14:41:04] [config] log-level: info
[2023-07-05 14:41:04] [config] log-time-zone: ""
[2023-07-05 14:41:04] [config] logical-epoch:
[2023-07-05 14:41:04] [config]   - 1e
[2023-07-05 14:41:04] [config]   - 0
[2023-07-05 14:41:04] [config] lr-decay: 0
[2023-07-05 14:41:04] [config] lr-decay-freq: 50000
[2023-07-05 14:41:04] [config] lr-decay-inv-sqrt:
[2023-07-05 14:41:04] [config]   - 0
[2023-07-05 14:41:04] [config] lr-decay-repeat-warmup: false
[2023-07-05 14:41:04] [config] lr-decay-reset-optimizer: false
[2023-07-05 14:41:04] [config] lr-decay-start:
[2023-07-05 14:41:04] [config]   - 10
[2023-07-05 14:41:04] [config]   - 1
[2023-07-05 14:41:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 14:41:04] [config] lr-report: false
[2023-07-05 14:41:04] [config] lr-warmup: 0
[2023-07-05 14:41:04] [config] lr-warmup-at-reload: false
[2023-07-05 14:41:04] [config] lr-warmup-cycle: false
[2023-07-05 14:41:04] [config] lr-warmup-start-rate: 0
[2023-07-05 14:41:04] [config] max-length: 50
[2023-07-05 14:41:04] [config] max-length-crop: false
[2023-07-05 14:41:04] [config] max-length-factor: 3
[2023-07-05 14:41:04] [config] maxi-batch: 100
[2023-07-05 14:41:04] [config] maxi-batch-sort: trg
[2023-07-05 14:41:04] [config] mini-batch: 64
[2023-07-05 14:41:04] [config] mini-batch-fit: false
[2023-07-05 14:41:04] [config] mini-batch-fit-step: 10
[2023-07-05 14:41:04] [config] mini-batch-round-up: true
[2023-07-05 14:41:04] [config] mini-batch-track-lr: false
[2023-07-05 14:41:04] [config] mini-batch-warmup: 0
[2023-07-05 14:41:04] [config] mini-batch-words: 0
[2023-07-05 14:41:04] [config] mini-batch-words-ref: 0
[2023-07-05 14:41:04] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:41:04] [config] multi-loss-type: sum
[2023-07-05 14:41:04] [config] n-best: false
[2023-07-05 14:41:04] [config] no-nccl: false
[2023-07-05 14:41:04] [config] no-reload: false
[2023-07-05 14:41:04] [config] no-restore-corpus: false
[2023-07-05 14:41:04] [config] normalize: 0
[2023-07-05 14:41:04] [config] normalize-gradient: false
[2023-07-05 14:41:04] [config] num-devices: 0
[2023-07-05 14:41:04] [config] optimizer: adam
[2023-07-05 14:41:04] [config] optimizer-delay: 1
[2023-07-05 14:41:04] [config] optimizer-params:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] output-omit-bias: false
[2023-07-05 14:41:04] [config] overwrite: true
[2023-07-05 14:41:04] [config] precision:
[2023-07-05 14:41:04] [config]   - float32
[2023-07-05 14:41:04] [config]   - float32
[2023-07-05 14:41:04] [config] pretrained-model: ""
[2023-07-05 14:41:04] [config] quantize-biases: false
[2023-07-05 14:41:04] [config] quantize-bits: 0
[2023-07-05 14:41:04] [config] quantize-log-based: false
[2023-07-05 14:41:04] [config] quantize-optimization-steps: 0
[2023-07-05 14:41:04] [config] quiet: false
[2023-07-05 14:41:04] [config] quiet-translation: true
[2023-07-05 14:41:04] [config] relative-paths: false
[2023-07-05 14:41:04] [config] right-left: false
[2023-07-05 14:41:04] [config] save-freq: 10000u
[2023-07-05 14:41:04] [config] seed: 1234
[2023-07-05 14:41:04] [config] sentencepiece-alphas:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] sentencepiece-max-lines: 2000000
[2023-07-05 14:41:04] [config] sentencepiece-options: ""
[2023-07-05 14:41:04] [config] sharding: global
[2023-07-05 14:41:04] [config] shuffle: data
[2023-07-05 14:41:04] [config] shuffle-in-ram: false
[2023-07-05 14:41:04] [config] sigterm: save-and-exit
[2023-07-05 14:41:04] [config] skip: false
[2023-07-05 14:41:04] [config] sqlite: ""
[2023-07-05 14:41:04] [config] sqlite-drop: false
[2023-07-05 14:41:04] [config] sync-freq: 200u
[2023-07-05 14:41:04] [config] sync-sgd: false
[2023-07-05 14:41:04] [config] tempdir: /tmp
[2023-07-05 14:41:04] [config] tied-embeddings: false
[2023-07-05 14:41:04] [config] tied-embeddings-all: false
[2023-07-05 14:41:04] [config] tied-embeddings-src: false
[2023-07-05 14:41:04] [config] train-embedder-rank:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] train-sets:
[2023-07-05 14:41:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 14:41:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 14:41:04] [config] transformer-aan-activation: swish
[2023-07-05 14:41:04] [config] transformer-aan-depth: 2
[2023-07-05 14:41:04] [config] transformer-aan-nogate: false
[2023-07-05 14:41:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 14:41:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 14:41:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 14:41:04] [config] transformer-depth-scaling: false
[2023-07-05 14:41:04] [config] transformer-dim-aan: 2048
[2023-07-05 14:41:04] [config] transformer-dim-ffn: 2048
[2023-07-05 14:41:04] [config] transformer-dropout: 0
[2023-07-05 14:41:04] [config] transformer-dropout-attention: 0
[2023-07-05 14:41:04] [config] transformer-dropout-ffn: 0
[2023-07-05 14:41:04] [config] transformer-ffn-activation: swish
[2023-07-05 14:41:04] [config] transformer-ffn-depth: 2
[2023-07-05 14:41:04] [config] transformer-guided-alignment-layer: last
[2023-07-05 14:41:04] [config] transformer-heads: 8
[2023-07-05 14:41:04] [config] transformer-no-projection: false
[2023-07-05 14:41:04] [config] transformer-pool: false
[2023-07-05 14:41:04] [config] transformer-postprocess: dan
[2023-07-05 14:41:04] [config] transformer-postprocess-emb: d
[2023-07-05 14:41:04] [config] transformer-postprocess-top: ""
[2023-07-05 14:41:04] [config] transformer-preprocess: ""
[2023-07-05 14:41:04] [config] transformer-tied-layers:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] transformer-train-position-embeddings: false
[2023-07-05 14:41:04] [config] tsv: false
[2023-07-05 14:41:04] [config] tsv-fields: 0
[2023-07-05 14:41:04] [config] type: s2s
[2023-07-05 14:41:04] [config] ulr: false
[2023-07-05 14:41:04] [config] ulr-dim-emb: 0
[2023-07-05 14:41:04] [config] ulr-dropout: 0
[2023-07-05 14:41:04] [config] ulr-keys-vectors: ""
[2023-07-05 14:41:04] [config] ulr-query-vectors: ""
[2023-07-05 14:41:04] [config] ulr-softmax-temperature: 1
[2023-07-05 14:41:04] [config] ulr-trainable-transformation: false
[2023-07-05 14:41:04] [config] unlikelihood-loss: false
[2023-07-05 14:41:04] [config] valid-freq: 50000000
[2023-07-05 14:41:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 14:41:04] [config] valid-max-length: 1000
[2023-07-05 14:41:04] [config] valid-metrics:
[2023-07-05 14:41:04] [config]   - cross-entropy
[2023-07-05 14:41:04] [config]   - translation
[2023-07-05 14:41:04] [config] valid-mini-batch: 32
[2023-07-05 14:41:04] [config] valid-reset-stalled: false
[2023-07-05 14:41:04] [config] valid-script-args:
[2023-07-05 14:41:04] [config]   []
[2023-07-05 14:41:04] [config] valid-script-path: ""
[2023-07-05 14:41:04] [config] valid-sets:
[2023-07-05 14:41:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 14:41:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 14:41:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 14:41:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:41:04] [config] vocabs:
[2023-07-05 14:41:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:41:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:41:04] [config] word-penalty: 0
[2023-07-05 14:41:04] [config] word-scores: false
[2023-07-05 14:41:04] [config] workspace: 2048
[2023-07-05 14:41:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:41:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:41:04] [training] Using single-device training
[2023-07-05 14:41:05] Synced seed 1234
[2023-07-05 14:41:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:41:05] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 14:41:05] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:41:05] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 14:41:05] [valid] No post-processing script given for validating translator
[2023-07-05 14:41:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:41:06] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 14:41:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 14:41:06] [comm] Using global sharding
[2023-07-05 14:41:06] [comm] NCCLCommunicators constructed successfully
[2023-07-05 14:41:06] [training] Using 1 GPUs
[2023-07-05 14:41:06] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:41:16] Loading Adam parameters
[2023-07-05 14:41:16] [memory] Reserving 823 MB, device gpu0
[2023-07-05 14:41:17] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:41:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:41:17] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-07-05 14:41:17] [data] Shuffling data
[2023-07-05 14:41:17] [data] Done reading 20,192 sentences
[2023-07-05 14:41:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:41:17] Training started
[2023-07-05 14:41:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 14:41:17] [logits] Applying loss function for 1 factor(s)
[2023-07-05 14:41:17] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 14:41:17] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:41:17] Parameter type float32, optimization type float32, casting types false
[2023-07-05 14:41:46] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 0.59679765 * 927,911 @ 960 after 16,771,618 : Time 40.51s : 22905.07 words/s : gNorm 0.8998
[2023-07-05 14:42:05] Seen 18,843 samples
[2023-07-05 14:42:05] Starting data epoch 62 in logical epoch 62
[2023-07-05 14:42:05] [data] Shuffling data
[2023-07-05 14:42:05] [data] Done reading 20,192 sentences
[2023-07-05 14:42:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:43:12] Seen 18,843 samples
[2023-07-05 14:43:12] Starting data epoch 63 in logical epoch 63
[2023-07-05 14:43:12] [data] Shuffling data
[2023-07-05 14:43:12] [data] Done reading 20,192 sentences
[2023-07-05 14:43:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:44:20] Seen 18,843 samples
[2023-07-05 14:44:20] Starting data epoch 64 in logical epoch 64
[2023-07-05 14:44:20] [data] Shuffling data
[2023-07-05 14:44:20] [data] Done reading 20,192 sentences
[2023-07-05 14:44:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:45:33] Seen 18,843 samples
[2023-07-05 14:45:33] Starting data epoch 65 in logical epoch 65
[2023-07-05 14:45:33] [data] Shuffling data
[2023-07-05 14:45:33] [data] Done reading 20,192 sentences
[2023-07-05 14:45:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:45:36] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 0.49175599 * 929,328 @ 384 after 17,700,946 : Time 230.63s : 4029.54 words/s : gNorm 0.8080
[2023-07-05 14:46:45] Seen 18,843 samples
[2023-07-05 14:46:45] Starting data epoch 66 in logical epoch 66
[2023-07-05 14:46:45] [data] Shuffling data
[2023-07-05 14:46:45] [data] Done reading 20,192 sentences
[2023-07-05 14:46:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:47:54] Seen 18,843 samples
[2023-07-05 14:47:54] Starting data epoch 67 in logical epoch 67
[2023-07-05 14:47:54] [data] Shuffling data
[2023-07-05 14:47:54] [data] Done reading 20,192 sentences
[2023-07-05 14:47:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:49:03] Seen 18,843 samples
[2023-07-05 14:49:03] Starting data epoch 68 in logical epoch 68
[2023-07-05 14:49:03] [data] Shuffling data
[2023-07-05 14:49:03] [data] Done reading 20,192 sentences
[2023-07-05 14:49:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:49:35] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 0.39747107 * 941,249 @ 1,088 after 18,642,195 : Time 238.32s : 3949.54 words/s : gNorm 0.8065
[2023-07-05 14:49:35] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:49:46] Saving Adam parameters
[2023-07-05 14:49:47] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:50:34] Seen 18,843 samples
[2023-07-05 14:50:34] Starting data epoch 69 in logical epoch 69
[2023-07-05 14:50:34] [data] Shuffling data
[2023-07-05 14:50:34] [data] Done reading 20,192 sentences
[2023-07-05 14:50:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:51:38] Seen 18,843 samples
[2023-07-05 14:51:38] Starting data epoch 70 in logical epoch 70
[2023-07-05 14:51:38] [data] Shuffling data
[2023-07-05 14:51:38] [data] Done reading 20,192 sentences
[2023-07-05 14:51:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:52:50] Seen 18,843 samples
[2023-07-05 14:52:50] Starting data epoch 71 in logical epoch 71
[2023-07-05 14:52:50] Training finished
[2023-07-05 14:52:59] [valid] Ep. 71 : Up. 20760 : cross-entropy : 123.231 : stalled 6 times (last best: 87.4287)
[2023-07-05 14:54:43] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-07-05 14:54:43] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:54:56] Saving Adam parameters
[2023-07-05 14:54:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:55:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:55:30] [marian] Running on node22.datos.cluster.uy as process 37378 with command line:
[2023-07-05 14:55:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 14:55:31] [config] after: 0e
[2023-07-05 14:55:31] [config] after-batches: 0
[2023-07-05 14:55:31] [config] after-epochs: 80
[2023-07-05 14:55:31] [config] all-caps-every: 0
[2023-07-05 14:55:31] [config] allow-unk: false
[2023-07-05 14:55:31] [config] authors: false
[2023-07-05 14:55:31] [config] beam-size: 12
[2023-07-05 14:55:31] [config] bert-class-symbol: "[CLS]"
[2023-07-05 14:55:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 14:55:31] [config] bert-masking-fraction: 0.15
[2023-07-05 14:55:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 14:55:31] [config] bert-train-type-embeddings: true
[2023-07-05 14:55:31] [config] bert-type-vocab-size: 2
[2023-07-05 14:55:31] [config] build-info: ""
[2023-07-05 14:55:31] [config] check-gradient-nan: false
[2023-07-05 14:55:31] [config] check-nan: false
[2023-07-05 14:55:31] [config] cite: false
[2023-07-05 14:55:31] [config] clip-norm: 1
[2023-07-05 14:55:31] [config] cost-scaling:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] cost-type: ce-sum
[2023-07-05 14:55:31] [config] cpu-threads: 0
[2023-07-05 14:55:31] [config] data-threads: 8
[2023-07-05 14:55:31] [config] data-weighting: ""
[2023-07-05 14:55:31] [config] data-weighting-type: sentence
[2023-07-05 14:55:31] [config] dec-cell: gru
[2023-07-05 14:55:31] [config] dec-cell-base-depth: 2
[2023-07-05 14:55:31] [config] dec-cell-high-depth: 1
[2023-07-05 14:55:31] [config] dec-depth: 1
[2023-07-05 14:55:31] [config] devices:
[2023-07-05 14:55:31] [config]   - 0
[2023-07-05 14:55:31] [config] dim-emb: 512
[2023-07-05 14:55:31] [config] dim-rnn: 1024
[2023-07-05 14:55:31] [config] dim-vocabs:
[2023-07-05 14:55:31] [config]   - 36507
[2023-07-05 14:55:31] [config]   - 54042
[2023-07-05 14:55:31] [config] disp-first: 0
[2023-07-05 14:55:31] [config] disp-freq: 1000u
[2023-07-05 14:55:31] [config] disp-label-counts: true
[2023-07-05 14:55:31] [config] dropout-rnn: 0
[2023-07-05 14:55:31] [config] dropout-src: 0
[2023-07-05 14:55:31] [config] dropout-trg: 0
[2023-07-05 14:55:31] [config] dump-config: ""
[2023-07-05 14:55:31] [config] dynamic-gradient-scaling:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] early-stopping: 10
[2023-07-05 14:55:31] [config] early-stopping-on: first
[2023-07-05 14:55:31] [config] embedding-fix-src: false
[2023-07-05 14:55:31] [config] embedding-fix-trg: false
[2023-07-05 14:55:31] [config] embedding-normalization: false
[2023-07-05 14:55:31] [config] embedding-vectors:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] enc-cell: gru
[2023-07-05 14:55:31] [config] enc-cell-depth: 1
[2023-07-05 14:55:31] [config] enc-depth: 1
[2023-07-05 14:55:31] [config] enc-type: bidirectional
[2023-07-05 14:55:31] [config] english-title-case-every: 0
[2023-07-05 14:55:31] [config] exponential-smoothing: 0
[2023-07-05 14:55:31] [config] factor-weight: 1
[2023-07-05 14:55:31] [config] factors-combine: sum
[2023-07-05 14:55:31] [config] factors-dim-emb: 0
[2023-07-05 14:55:31] [config] gradient-checkpointing: false
[2023-07-05 14:55:31] [config] gradient-norm-average-window: 100
[2023-07-05 14:55:31] [config] guided-alignment: none
[2023-07-05 14:55:31] [config] guided-alignment-cost: mse
[2023-07-05 14:55:31] [config] guided-alignment-weight: 0.1
[2023-07-05 14:55:31] [config] ignore-model-config: false
[2023-07-05 14:55:31] [config] input-types:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] interpolate-env-vars: false
[2023-07-05 14:55:31] [config] keep-best: false
[2023-07-05 14:55:31] [config] label-smoothing: 0
[2023-07-05 14:55:31] [config] layer-normalization: false
[2023-07-05 14:55:31] [config] learn-rate: 0.0001
[2023-07-05 14:55:31] [config] lemma-dependency: ""
[2023-07-05 14:55:31] [config] lemma-dim-emb: 0
[2023-07-05 14:55:31] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 14:55:31] [config] log-level: info
[2023-07-05 14:55:31] [config] log-time-zone: ""
[2023-07-05 14:55:31] [config] logical-epoch:
[2023-07-05 14:55:31] [config]   - 1e
[2023-07-05 14:55:31] [config]   - 0
[2023-07-05 14:55:31] [config] lr-decay: 0
[2023-07-05 14:55:31] [config] lr-decay-freq: 50000
[2023-07-05 14:55:31] [config] lr-decay-inv-sqrt:
[2023-07-05 14:55:31] [config]   - 0
[2023-07-05 14:55:31] [config] lr-decay-repeat-warmup: false
[2023-07-05 14:55:31] [config] lr-decay-reset-optimizer: false
[2023-07-05 14:55:31] [config] lr-decay-start:
[2023-07-05 14:55:31] [config]   - 10
[2023-07-05 14:55:31] [config]   - 1
[2023-07-05 14:55:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 14:55:31] [config] lr-report: false
[2023-07-05 14:55:31] [config] lr-warmup: 0
[2023-07-05 14:55:31] [config] lr-warmup-at-reload: false
[2023-07-05 14:55:31] [config] lr-warmup-cycle: false
[2023-07-05 14:55:31] [config] lr-warmup-start-rate: 0
[2023-07-05 14:55:31] [config] max-length: 50
[2023-07-05 14:55:31] [config] max-length-crop: false
[2023-07-05 14:55:31] [config] max-length-factor: 3
[2023-07-05 14:55:31] [config] maxi-batch: 100
[2023-07-05 14:55:31] [config] maxi-batch-sort: trg
[2023-07-05 14:55:31] [config] mini-batch: 64
[2023-07-05 14:55:31] [config] mini-batch-fit: false
[2023-07-05 14:55:31] [config] mini-batch-fit-step: 10
[2023-07-05 14:55:31] [config] mini-batch-round-up: true
[2023-07-05 14:55:31] [config] mini-batch-track-lr: false
[2023-07-05 14:55:31] [config] mini-batch-warmup: 0
[2023-07-05 14:55:31] [config] mini-batch-words: 0
[2023-07-05 14:55:31] [config] mini-batch-words-ref: 0
[2023-07-05 14:55:31] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:55:31] [config] multi-loss-type: sum
[2023-07-05 14:55:31] [config] n-best: false
[2023-07-05 14:55:31] [config] no-nccl: false
[2023-07-05 14:55:31] [config] no-reload: false
[2023-07-05 14:55:31] [config] no-restore-corpus: false
[2023-07-05 14:55:31] [config] normalize: 0
[2023-07-05 14:55:31] [config] normalize-gradient: false
[2023-07-05 14:55:31] [config] num-devices: 0
[2023-07-05 14:55:31] [config] optimizer: adam
[2023-07-05 14:55:31] [config] optimizer-delay: 1
[2023-07-05 14:55:31] [config] optimizer-params:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] output-omit-bias: false
[2023-07-05 14:55:31] [config] overwrite: true
[2023-07-05 14:55:31] [config] precision:
[2023-07-05 14:55:31] [config]   - float32
[2023-07-05 14:55:31] [config]   - float32
[2023-07-05 14:55:31] [config] pretrained-model: ""
[2023-07-05 14:55:31] [config] quantize-biases: false
[2023-07-05 14:55:31] [config] quantize-bits: 0
[2023-07-05 14:55:31] [config] quantize-log-based: false
[2023-07-05 14:55:31] [config] quantize-optimization-steps: 0
[2023-07-05 14:55:31] [config] quiet: false
[2023-07-05 14:55:31] [config] quiet-translation: true
[2023-07-05 14:55:31] [config] relative-paths: false
[2023-07-05 14:55:31] [config] right-left: false
[2023-07-05 14:55:31] [config] save-freq: 10000u
[2023-07-05 14:55:31] [config] seed: 1234
[2023-07-05 14:55:31] [config] sentencepiece-alphas:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] sentencepiece-max-lines: 2000000
[2023-07-05 14:55:31] [config] sentencepiece-options: ""
[2023-07-05 14:55:31] [config] sharding: global
[2023-07-05 14:55:31] [config] shuffle: data
[2023-07-05 14:55:31] [config] shuffle-in-ram: false
[2023-07-05 14:55:31] [config] sigterm: save-and-exit
[2023-07-05 14:55:31] [config] skip: false
[2023-07-05 14:55:31] [config] sqlite: ""
[2023-07-05 14:55:31] [config] sqlite-drop: false
[2023-07-05 14:55:31] [config] sync-freq: 200u
[2023-07-05 14:55:31] [config] sync-sgd: false
[2023-07-05 14:55:31] [config] tempdir: /tmp
[2023-07-05 14:55:31] [config] tied-embeddings: false
[2023-07-05 14:55:31] [config] tied-embeddings-all: false
[2023-07-05 14:55:31] [config] tied-embeddings-src: false
[2023-07-05 14:55:31] [config] train-embedder-rank:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] train-sets:
[2023-07-05 14:55:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 14:55:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 14:55:31] [config] transformer-aan-activation: swish
[2023-07-05 14:55:31] [config] transformer-aan-depth: 2
[2023-07-05 14:55:31] [config] transformer-aan-nogate: false
[2023-07-05 14:55:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 14:55:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 14:55:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 14:55:31] [config] transformer-depth-scaling: false
[2023-07-05 14:55:31] [config] transformer-dim-aan: 2048
[2023-07-05 14:55:31] [config] transformer-dim-ffn: 2048
[2023-07-05 14:55:31] [config] transformer-dropout: 0
[2023-07-05 14:55:31] [config] transformer-dropout-attention: 0
[2023-07-05 14:55:31] [config] transformer-dropout-ffn: 0
[2023-07-05 14:55:31] [config] transformer-ffn-activation: swish
[2023-07-05 14:55:31] [config] transformer-ffn-depth: 2
[2023-07-05 14:55:31] [config] transformer-guided-alignment-layer: last
[2023-07-05 14:55:31] [config] transformer-heads: 8
[2023-07-05 14:55:31] [config] transformer-no-projection: false
[2023-07-05 14:55:31] [config] transformer-pool: false
[2023-07-05 14:55:31] [config] transformer-postprocess: dan
[2023-07-05 14:55:31] [config] transformer-postprocess-emb: d
[2023-07-05 14:55:31] [config] transformer-postprocess-top: ""
[2023-07-05 14:55:31] [config] transformer-preprocess: ""
[2023-07-05 14:55:31] [config] transformer-tied-layers:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] transformer-train-position-embeddings: false
[2023-07-05 14:55:31] [config] tsv: false
[2023-07-05 14:55:31] [config] tsv-fields: 0
[2023-07-05 14:55:31] [config] type: s2s
[2023-07-05 14:55:31] [config] ulr: false
[2023-07-05 14:55:31] [config] ulr-dim-emb: 0
[2023-07-05 14:55:31] [config] ulr-dropout: 0
[2023-07-05 14:55:31] [config] ulr-keys-vectors: ""
[2023-07-05 14:55:31] [config] ulr-query-vectors: ""
[2023-07-05 14:55:31] [config] ulr-softmax-temperature: 1
[2023-07-05 14:55:31] [config] ulr-trainable-transformation: false
[2023-07-05 14:55:31] [config] unlikelihood-loss: false
[2023-07-05 14:55:31] [config] valid-freq: 50000000
[2023-07-05 14:55:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 14:55:31] [config] valid-max-length: 1000
[2023-07-05 14:55:31] [config] valid-metrics:
[2023-07-05 14:55:31] [config]   - cross-entropy
[2023-07-05 14:55:31] [config]   - translation
[2023-07-05 14:55:31] [config] valid-mini-batch: 32
[2023-07-05 14:55:31] [config] valid-reset-stalled: false
[2023-07-05 14:55:31] [config] valid-script-args:
[2023-07-05 14:55:31] [config]   []
[2023-07-05 14:55:31] [config] valid-script-path: ""
[2023-07-05 14:55:31] [config] valid-sets:
[2023-07-05 14:55:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 14:55:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 14:55:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 14:55:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:55:31] [config] vocabs:
[2023-07-05 14:55:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:55:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:55:31] [config] word-penalty: 0
[2023-07-05 14:55:31] [config] word-scores: false
[2023-07-05 14:55:31] [config] workspace: 2048
[2023-07-05 14:55:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 14:55:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:55:31] [training] Using single-device training
[2023-07-05 14:55:31] Synced seed 1234
[2023-07-05 14:55:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 14:55:32] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 14:55:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 14:55:32] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 14:55:32] [valid] No post-processing script given for validating translator
[2023-07-05 14:55:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 14:55:32] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 14:55:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 14:55:33] [comm] Using global sharding
[2023-07-05 14:55:33] [comm] NCCLCommunicators constructed successfully
[2023-07-05 14:55:33] [training] Using 1 GPUs
[2023-07-05 14:55:33] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 14:55:49] Loading Adam parameters
[2023-07-05 14:55:49] [memory] Reserving 823 MB, device gpu0
[2023-07-05 14:55:49] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:55:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 14:55:49] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-07-05 14:55:49] [data] Shuffling data
[2023-07-05 14:55:50] [data] Done reading 20,192 sentences
[2023-07-05 14:55:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:55:50] Training started
[2023-07-05 14:55:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 14:55:50] [logits] Applying loss function for 1 factor(s)
[2023-07-05 14:55:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 14:55:50] [memory] Reserving 411 MB, device gpu0
[2023-07-05 14:55:50] Parameter type float32, optimization type float32, casting types false
[2023-07-05 14:56:23] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.31459168 * 923,944 @ 1,048 after 19,566,139 : Time 51.33s : 18001.35 words/s : gNorm 0.7205
[2023-07-05 14:56:34] Seen 18,843 samples
[2023-07-05 14:56:34] Starting data epoch 72 in logical epoch 72
[2023-07-05 14:56:34] [data] Shuffling data
[2023-07-05 14:56:34] [data] Done reading 20,192 sentences
[2023-07-05 14:56:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:57:43] Seen 18,843 samples
[2023-07-05 14:57:43] Starting data epoch 73 in logical epoch 73
[2023-07-05 14:57:43] [data] Shuffling data
[2023-07-05 14:57:43] [data] Done reading 20,192 sentences
[2023-07-05 14:57:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:58:51] Seen 18,843 samples
[2023-07-05 14:58:51] Starting data epoch 74 in logical epoch 74
[2023-07-05 14:58:51] [data] Shuffling data
[2023-07-05 14:58:51] [data] Done reading 20,192 sentences
[2023-07-05 14:58:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 14:59:59] Seen 18,843 samples
[2023-07-05 14:59:59] Starting data epoch 75 in logical epoch 75
[2023-07-05 14:59:59] [data] Shuffling data
[2023-07-05 14:59:59] [data] Done reading 20,192 sentences
[2023-07-05 14:59:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:00:10] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.25651684 * 934,356 @ 1,902 after 20,500,495 : Time 227.06s : 4115.03 words/s : gNorm 0.5596
[2023-07-05 15:01:05] Seen 18,843 samples
[2023-07-05 15:01:06] Starting data epoch 76 in logical epoch 76
[2023-07-05 15:01:06] [data] Shuffling data
[2023-07-05 15:01:06] [data] Done reading 20,192 sentences
[2023-07-05 15:01:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:02:15] Seen 18,843 samples
[2023-07-05 15:02:15] Starting data epoch 77 in logical epoch 77
[2023-07-05 15:02:15] [data] Shuffling data
[2023-07-05 15:02:15] [data] Done reading 20,192 sentences
[2023-07-05 15:02:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:03:25] Seen 18,843 samples
[2023-07-05 15:03:25] Starting data epoch 78 in logical epoch 78
[2023-07-05 15:03:25] [data] Shuffling data
[2023-07-05 15:03:25] [data] Done reading 20,192 sentences
[2023-07-05 15:03:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:04:03] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.20159940 * 931,815 @ 407 after 21,432,310 : Time 233.38s : 3992.75 words/s : gNorm 0.4961
[2023-07-05 15:04:35] Seen 18,843 samples
[2023-07-05 15:04:35] Starting data epoch 79 in logical epoch 79
[2023-07-05 15:04:35] [data] Shuffling data
[2023-07-05 15:04:35] [data] Done reading 20,192 sentences
[2023-07-05 15:04:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:05:48] Seen 18,843 samples
[2023-07-05 15:05:48] Starting data epoch 80 in logical epoch 80
[2023-07-05 15:05:48] [data] Shuffling data
[2023-07-05 15:05:48] [data] Done reading 20,192 sentences
[2023-07-05 15:05:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:07:02] Seen 18,843 samples
[2023-07-05 15:07:02] Starting data epoch 81 in logical epoch 81
[2023-07-05 15:07:02] Training finished
[2023-07-05 15:07:11] [valid] Ep. 81 : Up. 23727 : cross-entropy : 128.727 : stalled 7 times (last best: 87.4287)
[2023-07-05 15:09:02] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-07-05 15:09:02] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:09:12] Saving Adam parameters
[2023-07-05 15:09:13] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:09:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:09:32] [marian] Running on node22.datos.cluster.uy as process 11099 with command line:
[2023-07-05 15:09:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:09:33] [config] after: 0e
[2023-07-05 15:09:33] [config] after-batches: 0
[2023-07-05 15:09:33] [config] after-epochs: 90
[2023-07-05 15:09:33] [config] all-caps-every: 0
[2023-07-05 15:09:33] [config] allow-unk: false
[2023-07-05 15:09:33] [config] authors: false
[2023-07-05 15:09:33] [config] beam-size: 12
[2023-07-05 15:09:33] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:09:33] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:09:33] [config] bert-masking-fraction: 0.15
[2023-07-05 15:09:33] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:09:33] [config] bert-train-type-embeddings: true
[2023-07-05 15:09:33] [config] bert-type-vocab-size: 2
[2023-07-05 15:09:33] [config] build-info: ""
[2023-07-05 15:09:33] [config] check-gradient-nan: false
[2023-07-05 15:09:33] [config] check-nan: false
[2023-07-05 15:09:33] [config] cite: false
[2023-07-05 15:09:33] [config] clip-norm: 1
[2023-07-05 15:09:33] [config] cost-scaling:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] cost-type: ce-sum
[2023-07-05 15:09:33] [config] cpu-threads: 0
[2023-07-05 15:09:33] [config] data-threads: 8
[2023-07-05 15:09:33] [config] data-weighting: ""
[2023-07-05 15:09:33] [config] data-weighting-type: sentence
[2023-07-05 15:09:33] [config] dec-cell: gru
[2023-07-05 15:09:33] [config] dec-cell-base-depth: 2
[2023-07-05 15:09:33] [config] dec-cell-high-depth: 1
[2023-07-05 15:09:33] [config] dec-depth: 1
[2023-07-05 15:09:33] [config] devices:
[2023-07-05 15:09:33] [config]   - 0
[2023-07-05 15:09:33] [config] dim-emb: 512
[2023-07-05 15:09:33] [config] dim-rnn: 1024
[2023-07-05 15:09:33] [config] dim-vocabs:
[2023-07-05 15:09:33] [config]   - 36507
[2023-07-05 15:09:33] [config]   - 54042
[2023-07-05 15:09:33] [config] disp-first: 0
[2023-07-05 15:09:33] [config] disp-freq: 1000u
[2023-07-05 15:09:33] [config] disp-label-counts: true
[2023-07-05 15:09:33] [config] dropout-rnn: 0
[2023-07-05 15:09:33] [config] dropout-src: 0
[2023-07-05 15:09:33] [config] dropout-trg: 0
[2023-07-05 15:09:33] [config] dump-config: ""
[2023-07-05 15:09:33] [config] dynamic-gradient-scaling:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] early-stopping: 10
[2023-07-05 15:09:33] [config] early-stopping-on: first
[2023-07-05 15:09:33] [config] embedding-fix-src: false
[2023-07-05 15:09:33] [config] embedding-fix-trg: false
[2023-07-05 15:09:33] [config] embedding-normalization: false
[2023-07-05 15:09:33] [config] embedding-vectors:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] enc-cell: gru
[2023-07-05 15:09:33] [config] enc-cell-depth: 1
[2023-07-05 15:09:33] [config] enc-depth: 1
[2023-07-05 15:09:33] [config] enc-type: bidirectional
[2023-07-05 15:09:33] [config] english-title-case-every: 0
[2023-07-05 15:09:33] [config] exponential-smoothing: 0
[2023-07-05 15:09:33] [config] factor-weight: 1
[2023-07-05 15:09:33] [config] factors-combine: sum
[2023-07-05 15:09:33] [config] factors-dim-emb: 0
[2023-07-05 15:09:33] [config] gradient-checkpointing: false
[2023-07-05 15:09:33] [config] gradient-norm-average-window: 100
[2023-07-05 15:09:33] [config] guided-alignment: none
[2023-07-05 15:09:33] [config] guided-alignment-cost: mse
[2023-07-05 15:09:33] [config] guided-alignment-weight: 0.1
[2023-07-05 15:09:33] [config] ignore-model-config: false
[2023-07-05 15:09:33] [config] input-types:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] interpolate-env-vars: false
[2023-07-05 15:09:33] [config] keep-best: false
[2023-07-05 15:09:33] [config] label-smoothing: 0
[2023-07-05 15:09:33] [config] layer-normalization: false
[2023-07-05 15:09:33] [config] learn-rate: 0.0001
[2023-07-05 15:09:33] [config] lemma-dependency: ""
[2023-07-05 15:09:33] [config] lemma-dim-emb: 0
[2023-07-05 15:09:33] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:09:33] [config] log-level: info
[2023-07-05 15:09:33] [config] log-time-zone: ""
[2023-07-05 15:09:33] [config] logical-epoch:
[2023-07-05 15:09:33] [config]   - 1e
[2023-07-05 15:09:33] [config]   - 0
[2023-07-05 15:09:33] [config] lr-decay: 0
[2023-07-05 15:09:33] [config] lr-decay-freq: 50000
[2023-07-05 15:09:33] [config] lr-decay-inv-sqrt:
[2023-07-05 15:09:33] [config]   - 0
[2023-07-05 15:09:33] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:09:33] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:09:33] [config] lr-decay-start:
[2023-07-05 15:09:33] [config]   - 10
[2023-07-05 15:09:33] [config]   - 1
[2023-07-05 15:09:33] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:09:33] [config] lr-report: false
[2023-07-05 15:09:33] [config] lr-warmup: 0
[2023-07-05 15:09:33] [config] lr-warmup-at-reload: false
[2023-07-05 15:09:33] [config] lr-warmup-cycle: false
[2023-07-05 15:09:33] [config] lr-warmup-start-rate: 0
[2023-07-05 15:09:33] [config] max-length: 50
[2023-07-05 15:09:33] [config] max-length-crop: false
[2023-07-05 15:09:33] [config] max-length-factor: 3
[2023-07-05 15:09:33] [config] maxi-batch: 100
[2023-07-05 15:09:33] [config] maxi-batch-sort: trg
[2023-07-05 15:09:33] [config] mini-batch: 64
[2023-07-05 15:09:33] [config] mini-batch-fit: false
[2023-07-05 15:09:33] [config] mini-batch-fit-step: 10
[2023-07-05 15:09:33] [config] mini-batch-round-up: true
[2023-07-05 15:09:33] [config] mini-batch-track-lr: false
[2023-07-05 15:09:33] [config] mini-batch-warmup: 0
[2023-07-05 15:09:33] [config] mini-batch-words: 0
[2023-07-05 15:09:33] [config] mini-batch-words-ref: 0
[2023-07-05 15:09:33] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:09:33] [config] multi-loss-type: sum
[2023-07-05 15:09:33] [config] n-best: false
[2023-07-05 15:09:33] [config] no-nccl: false
[2023-07-05 15:09:33] [config] no-reload: false
[2023-07-05 15:09:33] [config] no-restore-corpus: false
[2023-07-05 15:09:33] [config] normalize: 0
[2023-07-05 15:09:33] [config] normalize-gradient: false
[2023-07-05 15:09:33] [config] num-devices: 0
[2023-07-05 15:09:33] [config] optimizer: adam
[2023-07-05 15:09:33] [config] optimizer-delay: 1
[2023-07-05 15:09:33] [config] optimizer-params:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] output-omit-bias: false
[2023-07-05 15:09:33] [config] overwrite: true
[2023-07-05 15:09:33] [config] precision:
[2023-07-05 15:09:33] [config]   - float32
[2023-07-05 15:09:33] [config]   - float32
[2023-07-05 15:09:33] [config] pretrained-model: ""
[2023-07-05 15:09:33] [config] quantize-biases: false
[2023-07-05 15:09:33] [config] quantize-bits: 0
[2023-07-05 15:09:33] [config] quantize-log-based: false
[2023-07-05 15:09:33] [config] quantize-optimization-steps: 0
[2023-07-05 15:09:33] [config] quiet: false
[2023-07-05 15:09:33] [config] quiet-translation: true
[2023-07-05 15:09:33] [config] relative-paths: false
[2023-07-05 15:09:33] [config] right-left: false
[2023-07-05 15:09:33] [config] save-freq: 10000u
[2023-07-05 15:09:33] [config] seed: 1234
[2023-07-05 15:09:33] [config] sentencepiece-alphas:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:09:33] [config] sentencepiece-options: ""
[2023-07-05 15:09:33] [config] sharding: global
[2023-07-05 15:09:33] [config] shuffle: data
[2023-07-05 15:09:33] [config] shuffle-in-ram: false
[2023-07-05 15:09:33] [config] sigterm: save-and-exit
[2023-07-05 15:09:33] [config] skip: false
[2023-07-05 15:09:33] [config] sqlite: ""
[2023-07-05 15:09:33] [config] sqlite-drop: false
[2023-07-05 15:09:33] [config] sync-freq: 200u
[2023-07-05 15:09:33] [config] sync-sgd: false
[2023-07-05 15:09:33] [config] tempdir: /tmp
[2023-07-05 15:09:33] [config] tied-embeddings: false
[2023-07-05 15:09:33] [config] tied-embeddings-all: false
[2023-07-05 15:09:33] [config] tied-embeddings-src: false
[2023-07-05 15:09:33] [config] train-embedder-rank:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] train-sets:
[2023-07-05 15:09:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:09:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:09:33] [config] transformer-aan-activation: swish
[2023-07-05 15:09:33] [config] transformer-aan-depth: 2
[2023-07-05 15:09:33] [config] transformer-aan-nogate: false
[2023-07-05 15:09:33] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:09:33] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:09:33] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:09:33] [config] transformer-depth-scaling: false
[2023-07-05 15:09:33] [config] transformer-dim-aan: 2048
[2023-07-05 15:09:33] [config] transformer-dim-ffn: 2048
[2023-07-05 15:09:33] [config] transformer-dropout: 0
[2023-07-05 15:09:33] [config] transformer-dropout-attention: 0
[2023-07-05 15:09:33] [config] transformer-dropout-ffn: 0
[2023-07-05 15:09:33] [config] transformer-ffn-activation: swish
[2023-07-05 15:09:33] [config] transformer-ffn-depth: 2
[2023-07-05 15:09:33] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:09:33] [config] transformer-heads: 8
[2023-07-05 15:09:33] [config] transformer-no-projection: false
[2023-07-05 15:09:33] [config] transformer-pool: false
[2023-07-05 15:09:33] [config] transformer-postprocess: dan
[2023-07-05 15:09:33] [config] transformer-postprocess-emb: d
[2023-07-05 15:09:33] [config] transformer-postprocess-top: ""
[2023-07-05 15:09:33] [config] transformer-preprocess: ""
[2023-07-05 15:09:33] [config] transformer-tied-layers:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] transformer-train-position-embeddings: false
[2023-07-05 15:09:33] [config] tsv: false
[2023-07-05 15:09:33] [config] tsv-fields: 0
[2023-07-05 15:09:33] [config] type: s2s
[2023-07-05 15:09:33] [config] ulr: false
[2023-07-05 15:09:33] [config] ulr-dim-emb: 0
[2023-07-05 15:09:33] [config] ulr-dropout: 0
[2023-07-05 15:09:33] [config] ulr-keys-vectors: ""
[2023-07-05 15:09:33] [config] ulr-query-vectors: ""
[2023-07-05 15:09:33] [config] ulr-softmax-temperature: 1
[2023-07-05 15:09:33] [config] ulr-trainable-transformation: false
[2023-07-05 15:09:33] [config] unlikelihood-loss: false
[2023-07-05 15:09:33] [config] valid-freq: 50000000
[2023-07-05 15:09:33] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:09:33] [config] valid-max-length: 1000
[2023-07-05 15:09:33] [config] valid-metrics:
[2023-07-05 15:09:33] [config]   - cross-entropy
[2023-07-05 15:09:33] [config]   - translation
[2023-07-05 15:09:33] [config] valid-mini-batch: 32
[2023-07-05 15:09:33] [config] valid-reset-stalled: false
[2023-07-05 15:09:33] [config] valid-script-args:
[2023-07-05 15:09:33] [config]   []
[2023-07-05 15:09:33] [config] valid-script-path: ""
[2023-07-05 15:09:33] [config] valid-sets:
[2023-07-05 15:09:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:09:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:09:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:09:33] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:09:33] [config] vocabs:
[2023-07-05 15:09:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:09:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:09:33] [config] word-penalty: 0
[2023-07-05 15:09:33] [config] word-scores: false
[2023-07-05 15:09:33] [config] workspace: 2048
[2023-07-05 15:09:33] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:09:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:09:33] [training] Using single-device training
[2023-07-05 15:09:33] Synced seed 1234
[2023-07-05 15:09:33] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:09:33] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:09:33] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:09:33] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:09:33] [valid] No post-processing script given for validating translator
[2023-07-05 15:09:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:09:34] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:09:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:09:34] [comm] Using global sharding
[2023-07-05 15:09:34] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:09:34] [training] Using 1 GPUs
[2023-07-05 15:09:34] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:09:39] Loading Adam parameters
[2023-07-05 15:09:39] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:09:39] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:09:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:09:39] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-07-05 15:09:39] [data] Shuffling data
[2023-07-05 15:09:39] [data] Done reading 20,192 sentences
[2023-07-05 15:09:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:09:39] Training started
[2023-07-05 15:09:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 15:09:40] [logits] Applying loss function for 1 factor(s)
[2023-07-05 15:09:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 15:09:40] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:09:40] Parameter type float32, optimization type float32, casting types false
[2023-07-05 15:10:24] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.15757218 * 932,566 @ 576 after 22,364,876 : Time 51.34s : 18164.36 words/s : gNorm 0.4934
[2023-07-05 15:10:29] Seen 18,843 samples
[2023-07-05 15:10:29] Starting data epoch 82 in logical epoch 82
[2023-07-05 15:10:29] [data] Shuffling data
[2023-07-05 15:10:29] [data] Done reading 20,192 sentences
[2023-07-05 15:10:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:11:37] Seen 18,843 samples
[2023-07-05 15:11:37] Starting data epoch 83 in logical epoch 83
[2023-07-05 15:11:37] [data] Shuffling data
[2023-07-05 15:11:37] [data] Done reading 20,192 sentences
[2023-07-05 15:11:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:12:46] Seen 18,843 samples
[2023-07-05 15:12:46] Starting data epoch 84 in logical epoch 84
[2023-07-05 15:12:46] [data] Shuffling data
[2023-07-05 15:12:47] [data] Done reading 20,192 sentences
[2023-07-05 15:12:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:13:57] Seen 18,843 samples
[2023-07-05 15:13:57] Starting data epoch 85 in logical epoch 85
[2023-07-05 15:13:57] [data] Shuffling data
[2023-07-05 15:13:58] [data] Done reading 20,192 sentences
[2023-07-05 15:13:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:14:16] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.12545897 * 930,417 @ 896 after 23,295,293 : Time 231.12s : 4025.60 words/s : gNorm 0.4374
[2023-07-05 15:15:01] Seen 18,843 samples
[2023-07-05 15:15:01] Starting data epoch 86 in logical epoch 86
[2023-07-05 15:15:01] [data] Shuffling data
[2023-07-05 15:15:01] [data] Done reading 20,192 sentences
[2023-07-05 15:15:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:16:06] Seen 18,843 samples
[2023-07-05 15:16:06] Starting data epoch 87 in logical epoch 87
[2023-07-05 15:16:06] [data] Shuffling data
[2023-07-05 15:16:06] [data] Done reading 20,192 sentences
[2023-07-05 15:16:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:17:17] Seen 18,843 samples
[2023-07-05 15:17:17] Starting data epoch 88 in logical epoch 88
[2023-07-05 15:17:17] [data] Shuffling data
[2023-07-05 15:17:17] [data] Done reading 20,192 sentences
[2023-07-05 15:17:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:18:04] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.10012312 * 934,924 @ 640 after 24,230,217 : Time 228.62s : 4089.41 words/s : gNorm 0.4548
[2023-07-05 15:18:26] Seen 18,843 samples
[2023-07-05 15:18:26] Starting data epoch 89 in logical epoch 89
[2023-07-05 15:18:26] [data] Shuffling data
[2023-07-05 15:18:27] [data] Done reading 20,192 sentences
[2023-07-05 15:18:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:19:37] Seen 18,843 samples
[2023-07-05 15:19:37] Starting data epoch 90 in logical epoch 90
[2023-07-05 15:19:37] [data] Shuffling data
[2023-07-05 15:19:37] [data] Done reading 20,192 sentences
[2023-07-05 15:19:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:20:43] Seen 18,843 samples
[2023-07-05 15:20:43] Starting data epoch 91 in logical epoch 91
[2023-07-05 15:20:43] Training finished
[2023-07-05 15:20:52] [valid] Ep. 91 : Up. 26693 : cross-entropy : 135.422 : stalled 8 times (last best: 87.4287)
[2023-07-05 15:22:37] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-07-05 15:22:37] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:22:49] Saving Adam parameters
[2023-07-05 15:22:50] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:23:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:23:15] [marian] Running on node22.datos.cluster.uy as process 24496 with command line:
[2023-07-05 15:23:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:23:16] [config] after: 0e
[2023-07-05 15:23:16] [config] after-batches: 0
[2023-07-05 15:23:16] [config] after-epochs: 100
[2023-07-05 15:23:16] [config] all-caps-every: 0
[2023-07-05 15:23:16] [config] allow-unk: false
[2023-07-05 15:23:16] [config] authors: false
[2023-07-05 15:23:16] [config] beam-size: 12
[2023-07-05 15:23:16] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:23:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:23:16] [config] bert-masking-fraction: 0.15
[2023-07-05 15:23:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:23:16] [config] bert-train-type-embeddings: true
[2023-07-05 15:23:16] [config] bert-type-vocab-size: 2
[2023-07-05 15:23:16] [config] build-info: ""
[2023-07-05 15:23:16] [config] check-gradient-nan: false
[2023-07-05 15:23:16] [config] check-nan: false
[2023-07-05 15:23:16] [config] cite: false
[2023-07-05 15:23:16] [config] clip-norm: 1
[2023-07-05 15:23:16] [config] cost-scaling:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] cost-type: ce-sum
[2023-07-05 15:23:16] [config] cpu-threads: 0
[2023-07-05 15:23:16] [config] data-threads: 8
[2023-07-05 15:23:16] [config] data-weighting: ""
[2023-07-05 15:23:16] [config] data-weighting-type: sentence
[2023-07-05 15:23:16] [config] dec-cell: gru
[2023-07-05 15:23:16] [config] dec-cell-base-depth: 2
[2023-07-05 15:23:16] [config] dec-cell-high-depth: 1
[2023-07-05 15:23:16] [config] dec-depth: 1
[2023-07-05 15:23:16] [config] devices:
[2023-07-05 15:23:16] [config]   - 0
[2023-07-05 15:23:16] [config] dim-emb: 512
[2023-07-05 15:23:16] [config] dim-rnn: 1024
[2023-07-05 15:23:16] [config] dim-vocabs:
[2023-07-05 15:23:16] [config]   - 36507
[2023-07-05 15:23:16] [config]   - 54042
[2023-07-05 15:23:16] [config] disp-first: 0
[2023-07-05 15:23:16] [config] disp-freq: 1000u
[2023-07-05 15:23:16] [config] disp-label-counts: true
[2023-07-05 15:23:16] [config] dropout-rnn: 0
[2023-07-05 15:23:16] [config] dropout-src: 0
[2023-07-05 15:23:16] [config] dropout-trg: 0
[2023-07-05 15:23:16] [config] dump-config: ""
[2023-07-05 15:23:16] [config] dynamic-gradient-scaling:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] early-stopping: 10
[2023-07-05 15:23:16] [config] early-stopping-on: first
[2023-07-05 15:23:16] [config] embedding-fix-src: false
[2023-07-05 15:23:16] [config] embedding-fix-trg: false
[2023-07-05 15:23:16] [config] embedding-normalization: false
[2023-07-05 15:23:16] [config] embedding-vectors:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] enc-cell: gru
[2023-07-05 15:23:16] [config] enc-cell-depth: 1
[2023-07-05 15:23:16] [config] enc-depth: 1
[2023-07-05 15:23:16] [config] enc-type: bidirectional
[2023-07-05 15:23:16] [config] english-title-case-every: 0
[2023-07-05 15:23:16] [config] exponential-smoothing: 0
[2023-07-05 15:23:16] [config] factor-weight: 1
[2023-07-05 15:23:16] [config] factors-combine: sum
[2023-07-05 15:23:16] [config] factors-dim-emb: 0
[2023-07-05 15:23:16] [config] gradient-checkpointing: false
[2023-07-05 15:23:16] [config] gradient-norm-average-window: 100
[2023-07-05 15:23:16] [config] guided-alignment: none
[2023-07-05 15:23:16] [config] guided-alignment-cost: mse
[2023-07-05 15:23:16] [config] guided-alignment-weight: 0.1
[2023-07-05 15:23:16] [config] ignore-model-config: false
[2023-07-05 15:23:16] [config] input-types:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] interpolate-env-vars: false
[2023-07-05 15:23:16] [config] keep-best: false
[2023-07-05 15:23:16] [config] label-smoothing: 0
[2023-07-05 15:23:16] [config] layer-normalization: false
[2023-07-05 15:23:16] [config] learn-rate: 0.0001
[2023-07-05 15:23:16] [config] lemma-dependency: ""
[2023-07-05 15:23:16] [config] lemma-dim-emb: 0
[2023-07-05 15:23:16] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:23:16] [config] log-level: info
[2023-07-05 15:23:16] [config] log-time-zone: ""
[2023-07-05 15:23:16] [config] logical-epoch:
[2023-07-05 15:23:16] [config]   - 1e
[2023-07-05 15:23:16] [config]   - 0
[2023-07-05 15:23:16] [config] lr-decay: 0
[2023-07-05 15:23:16] [config] lr-decay-freq: 50000
[2023-07-05 15:23:16] [config] lr-decay-inv-sqrt:
[2023-07-05 15:23:16] [config]   - 0
[2023-07-05 15:23:16] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:23:16] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:23:16] [config] lr-decay-start:
[2023-07-05 15:23:16] [config]   - 10
[2023-07-05 15:23:16] [config]   - 1
[2023-07-05 15:23:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:23:16] [config] lr-report: false
[2023-07-05 15:23:16] [config] lr-warmup: 0
[2023-07-05 15:23:16] [config] lr-warmup-at-reload: false
[2023-07-05 15:23:16] [config] lr-warmup-cycle: false
[2023-07-05 15:23:16] [config] lr-warmup-start-rate: 0
[2023-07-05 15:23:16] [config] max-length: 50
[2023-07-05 15:23:16] [config] max-length-crop: false
[2023-07-05 15:23:16] [config] max-length-factor: 3
[2023-07-05 15:23:16] [config] maxi-batch: 100
[2023-07-05 15:23:16] [config] maxi-batch-sort: trg
[2023-07-05 15:23:16] [config] mini-batch: 64
[2023-07-05 15:23:16] [config] mini-batch-fit: false
[2023-07-05 15:23:16] [config] mini-batch-fit-step: 10
[2023-07-05 15:23:16] [config] mini-batch-round-up: true
[2023-07-05 15:23:16] [config] mini-batch-track-lr: false
[2023-07-05 15:23:16] [config] mini-batch-warmup: 0
[2023-07-05 15:23:16] [config] mini-batch-words: 0
[2023-07-05 15:23:16] [config] mini-batch-words-ref: 0
[2023-07-05 15:23:16] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:23:16] [config] multi-loss-type: sum
[2023-07-05 15:23:16] [config] n-best: false
[2023-07-05 15:23:16] [config] no-nccl: false
[2023-07-05 15:23:16] [config] no-reload: false
[2023-07-05 15:23:16] [config] no-restore-corpus: false
[2023-07-05 15:23:16] [config] normalize: 0
[2023-07-05 15:23:16] [config] normalize-gradient: false
[2023-07-05 15:23:16] [config] num-devices: 0
[2023-07-05 15:23:16] [config] optimizer: adam
[2023-07-05 15:23:16] [config] optimizer-delay: 1
[2023-07-05 15:23:16] [config] optimizer-params:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] output-omit-bias: false
[2023-07-05 15:23:16] [config] overwrite: true
[2023-07-05 15:23:16] [config] precision:
[2023-07-05 15:23:16] [config]   - float32
[2023-07-05 15:23:16] [config]   - float32
[2023-07-05 15:23:16] [config] pretrained-model: ""
[2023-07-05 15:23:16] [config] quantize-biases: false
[2023-07-05 15:23:16] [config] quantize-bits: 0
[2023-07-05 15:23:16] [config] quantize-log-based: false
[2023-07-05 15:23:16] [config] quantize-optimization-steps: 0
[2023-07-05 15:23:16] [config] quiet: false
[2023-07-05 15:23:16] [config] quiet-translation: true
[2023-07-05 15:23:16] [config] relative-paths: false
[2023-07-05 15:23:16] [config] right-left: false
[2023-07-05 15:23:16] [config] save-freq: 10000u
[2023-07-05 15:23:16] [config] seed: 1234
[2023-07-05 15:23:16] [config] sentencepiece-alphas:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:23:16] [config] sentencepiece-options: ""
[2023-07-05 15:23:16] [config] sharding: global
[2023-07-05 15:23:16] [config] shuffle: data
[2023-07-05 15:23:16] [config] shuffle-in-ram: false
[2023-07-05 15:23:16] [config] sigterm: save-and-exit
[2023-07-05 15:23:16] [config] skip: false
[2023-07-05 15:23:16] [config] sqlite: ""
[2023-07-05 15:23:16] [config] sqlite-drop: false
[2023-07-05 15:23:16] [config] sync-freq: 200u
[2023-07-05 15:23:16] [config] sync-sgd: false
[2023-07-05 15:23:16] [config] tempdir: /tmp
[2023-07-05 15:23:16] [config] tied-embeddings: false
[2023-07-05 15:23:16] [config] tied-embeddings-all: false
[2023-07-05 15:23:16] [config] tied-embeddings-src: false
[2023-07-05 15:23:16] [config] train-embedder-rank:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] train-sets:
[2023-07-05 15:23:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:23:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:23:16] [config] transformer-aan-activation: swish
[2023-07-05 15:23:16] [config] transformer-aan-depth: 2
[2023-07-05 15:23:16] [config] transformer-aan-nogate: false
[2023-07-05 15:23:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:23:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:23:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:23:16] [config] transformer-depth-scaling: false
[2023-07-05 15:23:16] [config] transformer-dim-aan: 2048
[2023-07-05 15:23:16] [config] transformer-dim-ffn: 2048
[2023-07-05 15:23:16] [config] transformer-dropout: 0
[2023-07-05 15:23:16] [config] transformer-dropout-attention: 0
[2023-07-05 15:23:16] [config] transformer-dropout-ffn: 0
[2023-07-05 15:23:16] [config] transformer-ffn-activation: swish
[2023-07-05 15:23:16] [config] transformer-ffn-depth: 2
[2023-07-05 15:23:16] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:23:16] [config] transformer-heads: 8
[2023-07-05 15:23:16] [config] transformer-no-projection: false
[2023-07-05 15:23:16] [config] transformer-pool: false
[2023-07-05 15:23:16] [config] transformer-postprocess: dan
[2023-07-05 15:23:16] [config] transformer-postprocess-emb: d
[2023-07-05 15:23:16] [config] transformer-postprocess-top: ""
[2023-07-05 15:23:16] [config] transformer-preprocess: ""
[2023-07-05 15:23:16] [config] transformer-tied-layers:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] transformer-train-position-embeddings: false
[2023-07-05 15:23:16] [config] tsv: false
[2023-07-05 15:23:16] [config] tsv-fields: 0
[2023-07-05 15:23:16] [config] type: s2s
[2023-07-05 15:23:16] [config] ulr: false
[2023-07-05 15:23:16] [config] ulr-dim-emb: 0
[2023-07-05 15:23:16] [config] ulr-dropout: 0
[2023-07-05 15:23:16] [config] ulr-keys-vectors: ""
[2023-07-05 15:23:16] [config] ulr-query-vectors: ""
[2023-07-05 15:23:16] [config] ulr-softmax-temperature: 1
[2023-07-05 15:23:16] [config] ulr-trainable-transformation: false
[2023-07-05 15:23:16] [config] unlikelihood-loss: false
[2023-07-05 15:23:16] [config] valid-freq: 50000000
[2023-07-05 15:23:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:23:16] [config] valid-max-length: 1000
[2023-07-05 15:23:16] [config] valid-metrics:
[2023-07-05 15:23:16] [config]   - cross-entropy
[2023-07-05 15:23:16] [config]   - translation
[2023-07-05 15:23:16] [config] valid-mini-batch: 32
[2023-07-05 15:23:16] [config] valid-reset-stalled: false
[2023-07-05 15:23:16] [config] valid-script-args:
[2023-07-05 15:23:16] [config]   []
[2023-07-05 15:23:16] [config] valid-script-path: ""
[2023-07-05 15:23:16] [config] valid-sets:
[2023-07-05 15:23:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:23:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:23:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:23:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:23:16] [config] vocabs:
[2023-07-05 15:23:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:23:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:23:16] [config] word-penalty: 0
[2023-07-05 15:23:16] [config] word-scores: false
[2023-07-05 15:23:16] [config] workspace: 2048
[2023-07-05 15:23:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:23:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:23:16] [training] Using single-device training
[2023-07-05 15:23:16] Synced seed 1234
[2023-07-05 15:23:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:23:16] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:23:16] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:23:16] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:23:16] [valid] No post-processing script given for validating translator
[2023-07-05 15:23:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:23:17] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:23:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:23:17] [comm] Using global sharding
[2023-07-05 15:23:17] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:23:17] [training] Using 1 GPUs
[2023-07-05 15:23:17] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:23:31] Loading Adam parameters
[2023-07-05 15:23:32] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:23:32] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:23:32] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:23:32] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-07-05 15:23:32] [data] Shuffling data
[2023-07-05 15:23:32] [data] Done reading 20,192 sentences
[2023-07-05 15:23:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:23:32] Training started
[2023-07-05 15:23:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 15:23:32] [logits] Applying loss function for 1 factor(s)
[2023-07-05 15:23:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 15:23:32] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:23:33] Parameter type float32, optimization type float32, casting types false
[2023-07-05 15:24:20] Seen 18,843 samples
[2023-07-05 15:24:20] Starting data epoch 92 in logical epoch 92
[2023-07-05 15:24:20] [data] Shuffling data
[2023-07-05 15:24:20] [data] Done reading 20,192 sentences
[2023-07-05 15:24:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:24:21] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.08021517 * 926,263 @ 384 after 25,156,480 : Time 65.10s : 14227.52 words/s : gNorm 0.3736
[2023-07-05 15:25:26] Seen 18,843 samples
[2023-07-05 15:25:26] Starting data epoch 93 in logical epoch 93
[2023-07-05 15:25:26] [data] Shuffling data
[2023-07-05 15:25:26] [data] Done reading 20,192 sentences
[2023-07-05 15:25:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:26:35] Seen 18,843 samples
[2023-07-05 15:26:35] Starting data epoch 94 in logical epoch 94
[2023-07-05 15:26:35] [data] Shuffling data
[2023-07-05 15:26:35] [data] Done reading 20,192 sentences
[2023-07-05 15:26:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:27:43] Seen 18,843 samples
[2023-07-05 15:27:43] Starting data epoch 95 in logical epoch 95
[2023-07-05 15:27:43] [data] Shuffling data
[2023-07-05 15:27:43] [data] Done reading 20,192 sentences
[2023-07-05 15:27:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:28:10] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.06380129 * 936,745 @ 1,372 after 26,093,225 : Time 228.39s : 4101.56 words/s : gNorm 0.2989
[2023-07-05 15:28:48] Seen 18,843 samples
[2023-07-05 15:28:48] Starting data epoch 96 in logical epoch 96
[2023-07-05 15:28:48] [data] Shuffling data
[2023-07-05 15:28:48] [data] Done reading 20,192 sentences
[2023-07-05 15:28:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:29:56] Seen 18,843 samples
[2023-07-05 15:29:56] Starting data epoch 97 in logical epoch 97
[2023-07-05 15:29:56] [data] Shuffling data
[2023-07-05 15:29:57] [data] Done reading 20,192 sentences
[2023-07-05 15:29:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:31:06] Seen 18,843 samples
[2023-07-05 15:31:06] Starting data epoch 98 in logical epoch 98
[2023-07-05 15:31:06] [data] Shuffling data
[2023-07-05 15:31:06] [data] Done reading 20,192 sentences
[2023-07-05 15:31:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:32:00] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.05123913 * 930,226 @ 1,766 after 27,023,451 : Time 230.31s : 4038.99 words/s : gNorm 0.3456
[2023-07-05 15:32:15] Seen 18,843 samples
[2023-07-05 15:32:15] Starting data epoch 99 in logical epoch 99
[2023-07-05 15:32:15] [data] Shuffling data
[2023-07-05 15:32:15] [data] Done reading 20,192 sentences
[2023-07-05 15:32:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:33:25] Seen 18,843 samples
[2023-07-05 15:33:25] Starting data epoch 100 in logical epoch 100
[2023-07-05 15:33:25] [data] Shuffling data
[2023-07-05 15:33:25] [data] Done reading 20,192 sentences
[2023-07-05 15:33:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:34:34] Seen 18,843 samples
[2023-07-05 15:34:34] Starting data epoch 101 in logical epoch 101
[2023-07-05 15:34:34] Training finished
[2023-07-05 15:34:42] [valid] Ep. 101 : Up. 29659 : cross-entropy : 140.384 : stalled 9 times (last best: 87.4287)
[2023-07-05 15:36:32] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-07-05 15:36:32] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:36:43] Saving Adam parameters
[2023-07-05 15:36:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:37:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:37:11] [marian] Running on node22.datos.cluster.uy as process 38435 with command line:
[2023-07-05 15:37:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:37:12] [config] after: 0e
[2023-07-05 15:37:12] [config] after-batches: 0
[2023-07-05 15:37:12] [config] after-epochs: 110
[2023-07-05 15:37:12] [config] all-caps-every: 0
[2023-07-05 15:37:12] [config] allow-unk: false
[2023-07-05 15:37:12] [config] authors: false
[2023-07-05 15:37:12] [config] beam-size: 12
[2023-07-05 15:37:12] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:37:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:37:12] [config] bert-masking-fraction: 0.15
[2023-07-05 15:37:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:37:12] [config] bert-train-type-embeddings: true
[2023-07-05 15:37:12] [config] bert-type-vocab-size: 2
[2023-07-05 15:37:12] [config] build-info: ""
[2023-07-05 15:37:12] [config] check-gradient-nan: false
[2023-07-05 15:37:12] [config] check-nan: false
[2023-07-05 15:37:12] [config] cite: false
[2023-07-05 15:37:12] [config] clip-norm: 1
[2023-07-05 15:37:12] [config] cost-scaling:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] cost-type: ce-sum
[2023-07-05 15:37:12] [config] cpu-threads: 0
[2023-07-05 15:37:12] [config] data-threads: 8
[2023-07-05 15:37:12] [config] data-weighting: ""
[2023-07-05 15:37:12] [config] data-weighting-type: sentence
[2023-07-05 15:37:12] [config] dec-cell: gru
[2023-07-05 15:37:12] [config] dec-cell-base-depth: 2
[2023-07-05 15:37:12] [config] dec-cell-high-depth: 1
[2023-07-05 15:37:12] [config] dec-depth: 1
[2023-07-05 15:37:12] [config] devices:
[2023-07-05 15:37:12] [config]   - 0
[2023-07-05 15:37:12] [config] dim-emb: 512
[2023-07-05 15:37:12] [config] dim-rnn: 1024
[2023-07-05 15:37:12] [config] dim-vocabs:
[2023-07-05 15:37:12] [config]   - 36507
[2023-07-05 15:37:12] [config]   - 54042
[2023-07-05 15:37:12] [config] disp-first: 0
[2023-07-05 15:37:12] [config] disp-freq: 1000u
[2023-07-05 15:37:12] [config] disp-label-counts: true
[2023-07-05 15:37:12] [config] dropout-rnn: 0
[2023-07-05 15:37:12] [config] dropout-src: 0
[2023-07-05 15:37:12] [config] dropout-trg: 0
[2023-07-05 15:37:12] [config] dump-config: ""
[2023-07-05 15:37:12] [config] dynamic-gradient-scaling:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] early-stopping: 10
[2023-07-05 15:37:12] [config] early-stopping-on: first
[2023-07-05 15:37:12] [config] embedding-fix-src: false
[2023-07-05 15:37:12] [config] embedding-fix-trg: false
[2023-07-05 15:37:12] [config] embedding-normalization: false
[2023-07-05 15:37:12] [config] embedding-vectors:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] enc-cell: gru
[2023-07-05 15:37:12] [config] enc-cell-depth: 1
[2023-07-05 15:37:12] [config] enc-depth: 1
[2023-07-05 15:37:12] [config] enc-type: bidirectional
[2023-07-05 15:37:12] [config] english-title-case-every: 0
[2023-07-05 15:37:12] [config] exponential-smoothing: 0
[2023-07-05 15:37:12] [config] factor-weight: 1
[2023-07-05 15:37:12] [config] factors-combine: sum
[2023-07-05 15:37:12] [config] factors-dim-emb: 0
[2023-07-05 15:37:12] [config] gradient-checkpointing: false
[2023-07-05 15:37:12] [config] gradient-norm-average-window: 100
[2023-07-05 15:37:12] [config] guided-alignment: none
[2023-07-05 15:37:12] [config] guided-alignment-cost: mse
[2023-07-05 15:37:12] [config] guided-alignment-weight: 0.1
[2023-07-05 15:37:12] [config] ignore-model-config: false
[2023-07-05 15:37:12] [config] input-types:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] interpolate-env-vars: false
[2023-07-05 15:37:12] [config] keep-best: false
[2023-07-05 15:37:12] [config] label-smoothing: 0
[2023-07-05 15:37:12] [config] layer-normalization: false
[2023-07-05 15:37:12] [config] learn-rate: 0.0001
[2023-07-05 15:37:12] [config] lemma-dependency: ""
[2023-07-05 15:37:12] [config] lemma-dim-emb: 0
[2023-07-05 15:37:12] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:37:12] [config] log-level: info
[2023-07-05 15:37:12] [config] log-time-zone: ""
[2023-07-05 15:37:12] [config] logical-epoch:
[2023-07-05 15:37:12] [config]   - 1e
[2023-07-05 15:37:12] [config]   - 0
[2023-07-05 15:37:12] [config] lr-decay: 0
[2023-07-05 15:37:12] [config] lr-decay-freq: 50000
[2023-07-05 15:37:12] [config] lr-decay-inv-sqrt:
[2023-07-05 15:37:12] [config]   - 0
[2023-07-05 15:37:12] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:37:12] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:37:12] [config] lr-decay-start:
[2023-07-05 15:37:12] [config]   - 10
[2023-07-05 15:37:12] [config]   - 1
[2023-07-05 15:37:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:37:12] [config] lr-report: false
[2023-07-05 15:37:12] [config] lr-warmup: 0
[2023-07-05 15:37:12] [config] lr-warmup-at-reload: false
[2023-07-05 15:37:12] [config] lr-warmup-cycle: false
[2023-07-05 15:37:12] [config] lr-warmup-start-rate: 0
[2023-07-05 15:37:12] [config] max-length: 50
[2023-07-05 15:37:12] [config] max-length-crop: false
[2023-07-05 15:37:12] [config] max-length-factor: 3
[2023-07-05 15:37:12] [config] maxi-batch: 100
[2023-07-05 15:37:12] [config] maxi-batch-sort: trg
[2023-07-05 15:37:12] [config] mini-batch: 64
[2023-07-05 15:37:12] [config] mini-batch-fit: false
[2023-07-05 15:37:12] [config] mini-batch-fit-step: 10
[2023-07-05 15:37:12] [config] mini-batch-round-up: true
[2023-07-05 15:37:12] [config] mini-batch-track-lr: false
[2023-07-05 15:37:12] [config] mini-batch-warmup: 0
[2023-07-05 15:37:12] [config] mini-batch-words: 0
[2023-07-05 15:37:12] [config] mini-batch-words-ref: 0
[2023-07-05 15:37:12] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:37:12] [config] multi-loss-type: sum
[2023-07-05 15:37:12] [config] n-best: false
[2023-07-05 15:37:12] [config] no-nccl: false
[2023-07-05 15:37:12] [config] no-reload: false
[2023-07-05 15:37:12] [config] no-restore-corpus: false
[2023-07-05 15:37:12] [config] normalize: 0
[2023-07-05 15:37:12] [config] normalize-gradient: false
[2023-07-05 15:37:12] [config] num-devices: 0
[2023-07-05 15:37:12] [config] optimizer: adam
[2023-07-05 15:37:12] [config] optimizer-delay: 1
[2023-07-05 15:37:12] [config] optimizer-params:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] output-omit-bias: false
[2023-07-05 15:37:12] [config] overwrite: true
[2023-07-05 15:37:12] [config] precision:
[2023-07-05 15:37:12] [config]   - float32
[2023-07-05 15:37:12] [config]   - float32
[2023-07-05 15:37:12] [config] pretrained-model: ""
[2023-07-05 15:37:12] [config] quantize-biases: false
[2023-07-05 15:37:12] [config] quantize-bits: 0
[2023-07-05 15:37:12] [config] quantize-log-based: false
[2023-07-05 15:37:12] [config] quantize-optimization-steps: 0
[2023-07-05 15:37:12] [config] quiet: false
[2023-07-05 15:37:12] [config] quiet-translation: true
[2023-07-05 15:37:12] [config] relative-paths: false
[2023-07-05 15:37:12] [config] right-left: false
[2023-07-05 15:37:12] [config] save-freq: 10000u
[2023-07-05 15:37:12] [config] seed: 1234
[2023-07-05 15:37:12] [config] sentencepiece-alphas:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:37:12] [config] sentencepiece-options: ""
[2023-07-05 15:37:12] [config] sharding: global
[2023-07-05 15:37:12] [config] shuffle: data
[2023-07-05 15:37:12] [config] shuffle-in-ram: false
[2023-07-05 15:37:12] [config] sigterm: save-and-exit
[2023-07-05 15:37:12] [config] skip: false
[2023-07-05 15:37:12] [config] sqlite: ""
[2023-07-05 15:37:12] [config] sqlite-drop: false
[2023-07-05 15:37:12] [config] sync-freq: 200u
[2023-07-05 15:37:12] [config] sync-sgd: false
[2023-07-05 15:37:12] [config] tempdir: /tmp
[2023-07-05 15:37:12] [config] tied-embeddings: false
[2023-07-05 15:37:12] [config] tied-embeddings-all: false
[2023-07-05 15:37:12] [config] tied-embeddings-src: false
[2023-07-05 15:37:12] [config] train-embedder-rank:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] train-sets:
[2023-07-05 15:37:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:37:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:37:12] [config] transformer-aan-activation: swish
[2023-07-05 15:37:12] [config] transformer-aan-depth: 2
[2023-07-05 15:37:12] [config] transformer-aan-nogate: false
[2023-07-05 15:37:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:37:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:37:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:37:12] [config] transformer-depth-scaling: false
[2023-07-05 15:37:12] [config] transformer-dim-aan: 2048
[2023-07-05 15:37:12] [config] transformer-dim-ffn: 2048
[2023-07-05 15:37:12] [config] transformer-dropout: 0
[2023-07-05 15:37:12] [config] transformer-dropout-attention: 0
[2023-07-05 15:37:12] [config] transformer-dropout-ffn: 0
[2023-07-05 15:37:12] [config] transformer-ffn-activation: swish
[2023-07-05 15:37:12] [config] transformer-ffn-depth: 2
[2023-07-05 15:37:12] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:37:12] [config] transformer-heads: 8
[2023-07-05 15:37:12] [config] transformer-no-projection: false
[2023-07-05 15:37:12] [config] transformer-pool: false
[2023-07-05 15:37:12] [config] transformer-postprocess: dan
[2023-07-05 15:37:12] [config] transformer-postprocess-emb: d
[2023-07-05 15:37:12] [config] transformer-postprocess-top: ""
[2023-07-05 15:37:12] [config] transformer-preprocess: ""
[2023-07-05 15:37:12] [config] transformer-tied-layers:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] transformer-train-position-embeddings: false
[2023-07-05 15:37:12] [config] tsv: false
[2023-07-05 15:37:12] [config] tsv-fields: 0
[2023-07-05 15:37:12] [config] type: s2s
[2023-07-05 15:37:12] [config] ulr: false
[2023-07-05 15:37:12] [config] ulr-dim-emb: 0
[2023-07-05 15:37:12] [config] ulr-dropout: 0
[2023-07-05 15:37:12] [config] ulr-keys-vectors: ""
[2023-07-05 15:37:12] [config] ulr-query-vectors: ""
[2023-07-05 15:37:12] [config] ulr-softmax-temperature: 1
[2023-07-05 15:37:12] [config] ulr-trainable-transformation: false
[2023-07-05 15:37:12] [config] unlikelihood-loss: false
[2023-07-05 15:37:12] [config] valid-freq: 50000000
[2023-07-05 15:37:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:37:12] [config] valid-max-length: 1000
[2023-07-05 15:37:12] [config] valid-metrics:
[2023-07-05 15:37:12] [config]   - cross-entropy
[2023-07-05 15:37:12] [config]   - translation
[2023-07-05 15:37:12] [config] valid-mini-batch: 32
[2023-07-05 15:37:12] [config] valid-reset-stalled: false
[2023-07-05 15:37:12] [config] valid-script-args:
[2023-07-05 15:37:12] [config]   []
[2023-07-05 15:37:12] [config] valid-script-path: ""
[2023-07-05 15:37:12] [config] valid-sets:
[2023-07-05 15:37:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:37:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:37:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:37:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:37:12] [config] vocabs:
[2023-07-05 15:37:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:37:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:37:12] [config] word-penalty: 0
[2023-07-05 15:37:12] [config] word-scores: false
[2023-07-05 15:37:12] [config] workspace: 2048
[2023-07-05 15:37:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:37:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:37:12] [training] Using single-device training
[2023-07-05 15:37:12] Synced seed 1234
[2023-07-05 15:37:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:37:13] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:37:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:37:13] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:37:13] [valid] No post-processing script given for validating translator
[2023-07-05 15:37:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:37:14] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:37:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:37:14] [comm] Using global sharding
[2023-07-05 15:37:14] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:37:14] [training] Using 1 GPUs
[2023-07-05 15:37:14] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:37:22] Loading Adam parameters
[2023-07-05 15:37:22] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:37:23] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:37:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:37:23] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-07-05 15:37:23] [data] Shuffling data
[2023-07-05 15:37:23] [data] Done reading 20,192 sentences
[2023-07-05 15:37:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:37:23] Training started
[2023-07-05 15:37:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 15:37:23] [logits] Applying loss function for 1 factor(s)
[2023-07-05 15:37:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 15:37:23] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:37:23] Parameter type float32, optimization type float32, casting types false
[2023-07-05 15:38:11] Seen 18,843 samples
[2023-07-05 15:38:11] Starting data epoch 102 in logical epoch 102
[2023-07-05 15:38:11] [data] Shuffling data
[2023-07-05 15:38:11] [data] Done reading 20,192 sentences
[2023-07-05 15:38:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:38:19] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.04162692 * 931,515 @ 1,519 after 27,954,966 : Time 66.81s : 13942.38 words/s : gNorm 0.3103
[2023-07-05 15:38:19] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:38:28] Saving Adam parameters
[2023-07-05 15:38:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:39:36] Seen 18,843 samples
[2023-07-05 15:39:36] Starting data epoch 103 in logical epoch 103
[2023-07-05 15:39:36] [data] Shuffling data
[2023-07-05 15:39:36] [data] Done reading 20,192 sentences
[2023-07-05 15:39:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:40:45] Seen 18,843 samples
[2023-07-05 15:40:45] Starting data epoch 104 in logical epoch 104
[2023-07-05 15:40:45] [data] Shuffling data
[2023-07-05 15:40:45] [data] Done reading 20,192 sentences
[2023-07-05 15:40:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:41:56] Seen 18,843 samples
[2023-07-05 15:41:56] Starting data epoch 105 in logical epoch 105
[2023-07-05 15:41:56] [data] Shuffling data
[2023-07-05 15:41:56] [data] Done reading 20,192 sentences
[2023-07-05 15:41:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:42:31] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.03559090 * 932,338 @ 1,024 after 28,887,304 : Time 251.55s : 3706.45 words/s : gNorm 0.3737
[2023-07-05 15:43:03] Seen 18,843 samples
[2023-07-05 15:43:03] Starting data epoch 106 in logical epoch 106
[2023-07-05 15:43:03] [data] Shuffling data
[2023-07-05 15:43:03] [data] Done reading 20,192 sentences
[2023-07-05 15:43:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:44:11] Seen 18,843 samples
[2023-07-05 15:44:11] Starting data epoch 107 in logical epoch 107
[2023-07-05 15:44:11] [data] Shuffling data
[2023-07-05 15:44:11] [data] Done reading 20,192 sentences
[2023-07-05 15:44:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:45:20] Seen 18,843 samples
[2023-07-05 15:45:20] Starting data epoch 108 in logical epoch 108
[2023-07-05 15:45:20] [data] Shuffling data
[2023-07-05 15:45:20] [data] Done reading 20,192 sentences
[2023-07-05 15:45:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:46:18] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.02864036 * 924,374 @ 640 after 29,811,678 : Time 226.54s : 4080.43 words/s : gNorm 0.2668
[2023-07-05 15:46:26] Seen 18,843 samples
[2023-07-05 15:46:26] Starting data epoch 109 in logical epoch 109
[2023-07-05 15:46:26] [data] Shuffling data
[2023-07-05 15:46:26] [data] Done reading 20,192 sentences
[2023-07-05 15:46:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:47:37] Seen 18,843 samples
[2023-07-05 15:47:37] Starting data epoch 110 in logical epoch 110
[2023-07-05 15:47:37] [data] Shuffling data
[2023-07-05 15:47:38] [data] Done reading 20,192 sentences
[2023-07-05 15:47:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:48:44] Seen 18,843 samples
[2023-07-05 15:48:44] Starting data epoch 111 in logical epoch 111
[2023-07-05 15:48:44] Training finished
[2023-07-05 15:48:53] [valid] Ep. 111 : Up. 32628 : cross-entropy : 143.601 : stalled 10 times (last best: 87.4287)
[2023-07-05 15:50:43] [valid] Ep. 111 : Up. 32628 : translation : 0 : new best
[2023-07-05 15:50:43] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:50:48] Saving Adam parameters
[2023-07-05 15:50:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:04] [marian] Running on node22.datos.cluster.uy as process 11041 with command line:
[2023-07-05 15:51:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:04] [config] after: 0e
[2023-07-05 15:51:04] [config] after-batches: 0
[2023-07-05 15:51:04] [config] after-epochs: 120
[2023-07-05 15:51:04] [config] all-caps-every: 0
[2023-07-05 15:51:04] [config] allow-unk: false
[2023-07-05 15:51:04] [config] authors: false
[2023-07-05 15:51:04] [config] beam-size: 12
[2023-07-05 15:51:04] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:04] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:04] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:04] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:04] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:04] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:04] [config] build-info: ""
[2023-07-05 15:51:04] [config] check-gradient-nan: false
[2023-07-05 15:51:04] [config] check-nan: false
[2023-07-05 15:51:04] [config] cite: false
[2023-07-05 15:51:04] [config] clip-norm: 1
[2023-07-05 15:51:04] [config] cost-scaling:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] cost-type: ce-sum
[2023-07-05 15:51:04] [config] cpu-threads: 0
[2023-07-05 15:51:04] [config] data-threads: 8
[2023-07-05 15:51:04] [config] data-weighting: ""
[2023-07-05 15:51:04] [config] data-weighting-type: sentence
[2023-07-05 15:51:04] [config] dec-cell: gru
[2023-07-05 15:51:04] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:04] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:04] [config] dec-depth: 1
[2023-07-05 15:51:04] [config] devices:
[2023-07-05 15:51:04] [config]   - 0
[2023-07-05 15:51:04] [config] dim-emb: 512
[2023-07-05 15:51:04] [config] dim-rnn: 1024
[2023-07-05 15:51:04] [config] dim-vocabs:
[2023-07-05 15:51:04] [config]   - 36507
[2023-07-05 15:51:04] [config]   - 54042
[2023-07-05 15:51:04] [config] disp-first: 0
[2023-07-05 15:51:04] [config] disp-freq: 1000u
[2023-07-05 15:51:04] [config] disp-label-counts: true
[2023-07-05 15:51:04] [config] dropout-rnn: 0
[2023-07-05 15:51:04] [config] dropout-src: 0
[2023-07-05 15:51:04] [config] dropout-trg: 0
[2023-07-05 15:51:04] [config] dump-config: ""
[2023-07-05 15:51:04] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] early-stopping: 10
[2023-07-05 15:51:04] [config] early-stopping-on: first
[2023-07-05 15:51:04] [config] embedding-fix-src: false
[2023-07-05 15:51:04] [config] embedding-fix-trg: false
[2023-07-05 15:51:04] [config] embedding-normalization: false
[2023-07-05 15:51:04] [config] embedding-vectors:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] enc-cell: gru
[2023-07-05 15:51:04] [config] enc-cell-depth: 1
[2023-07-05 15:51:04] [config] enc-depth: 1
[2023-07-05 15:51:04] [config] enc-type: bidirectional
[2023-07-05 15:51:04] [config] english-title-case-every: 0
[2023-07-05 15:51:04] [config] exponential-smoothing: 0
[2023-07-05 15:51:04] [config] factor-weight: 1
[2023-07-05 15:51:04] [config] factors-combine: sum
[2023-07-05 15:51:04] [config] factors-dim-emb: 0
[2023-07-05 15:51:04] [config] gradient-checkpointing: false
[2023-07-05 15:51:04] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:04] [config] guided-alignment: none
[2023-07-05 15:51:04] [config] guided-alignment-cost: mse
[2023-07-05 15:51:04] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:04] [config] ignore-model-config: false
[2023-07-05 15:51:04] [config] input-types:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] interpolate-env-vars: false
[2023-07-05 15:51:04] [config] keep-best: false
[2023-07-05 15:51:04] [config] label-smoothing: 0
[2023-07-05 15:51:04] [config] layer-normalization: false
[2023-07-05 15:51:04] [config] learn-rate: 0.0001
[2023-07-05 15:51:04] [config] lemma-dependency: ""
[2023-07-05 15:51:04] [config] lemma-dim-emb: 0
[2023-07-05 15:51:04] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:04] [config] log-level: info
[2023-07-05 15:51:04] [config] log-time-zone: ""
[2023-07-05 15:51:04] [config] logical-epoch:
[2023-07-05 15:51:04] [config]   - 1e
[2023-07-05 15:51:04] [config]   - 0
[2023-07-05 15:51:04] [config] lr-decay: 0
[2023-07-05 15:51:04] [config] lr-decay-freq: 50000
[2023-07-05 15:51:04] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:04] [config]   - 0
[2023-07-05 15:51:04] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:04] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:04] [config] lr-decay-start:
[2023-07-05 15:51:04] [config]   - 10
[2023-07-05 15:51:04] [config]   - 1
[2023-07-05 15:51:04] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:04] [config] lr-report: false
[2023-07-05 15:51:04] [config] lr-warmup: 0
[2023-07-05 15:51:04] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:04] [config] lr-warmup-cycle: false
[2023-07-05 15:51:04] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:04] [config] max-length: 50
[2023-07-05 15:51:04] [config] max-length-crop: false
[2023-07-05 15:51:04] [config] max-length-factor: 3
[2023-07-05 15:51:04] [config] maxi-batch: 100
[2023-07-05 15:51:04] [config] maxi-batch-sort: trg
[2023-07-05 15:51:04] [config] mini-batch: 64
[2023-07-05 15:51:04] [config] mini-batch-fit: false
[2023-07-05 15:51:04] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:04] [config] mini-batch-round-up: true
[2023-07-05 15:51:04] [config] mini-batch-track-lr: false
[2023-07-05 15:51:04] [config] mini-batch-warmup: 0
[2023-07-05 15:51:04] [config] mini-batch-words: 0
[2023-07-05 15:51:04] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:04] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:04] [config] multi-loss-type: sum
[2023-07-05 15:51:04] [config] n-best: false
[2023-07-05 15:51:04] [config] no-nccl: false
[2023-07-05 15:51:04] [config] no-reload: false
[2023-07-05 15:51:04] [config] no-restore-corpus: false
[2023-07-05 15:51:04] [config] normalize: 0
[2023-07-05 15:51:04] [config] normalize-gradient: false
[2023-07-05 15:51:04] [config] num-devices: 0
[2023-07-05 15:51:04] [config] optimizer: adam
[2023-07-05 15:51:04] [config] optimizer-delay: 1
[2023-07-05 15:51:04] [config] optimizer-params:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] output-omit-bias: false
[2023-07-05 15:51:04] [config] overwrite: true
[2023-07-05 15:51:04] [config] precision:
[2023-07-05 15:51:04] [config]   - float32
[2023-07-05 15:51:04] [config]   - float32
[2023-07-05 15:51:04] [config] pretrained-model: ""
[2023-07-05 15:51:04] [config] quantize-biases: false
[2023-07-05 15:51:04] [config] quantize-bits: 0
[2023-07-05 15:51:04] [config] quantize-log-based: false
[2023-07-05 15:51:04] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:04] [config] quiet: false
[2023-07-05 15:51:04] [config] quiet-translation: true
[2023-07-05 15:51:04] [config] relative-paths: false
[2023-07-05 15:51:04] [config] right-left: false
[2023-07-05 15:51:04] [config] save-freq: 10000u
[2023-07-05 15:51:04] [config] seed: 1234
[2023-07-05 15:51:04] [config] sentencepiece-alphas:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:04] [config] sentencepiece-options: ""
[2023-07-05 15:51:04] [config] sharding: global
[2023-07-05 15:51:04] [config] shuffle: data
[2023-07-05 15:51:04] [config] shuffle-in-ram: false
[2023-07-05 15:51:04] [config] sigterm: save-and-exit
[2023-07-05 15:51:04] [config] skip: false
[2023-07-05 15:51:04] [config] sqlite: ""
[2023-07-05 15:51:04] [config] sqlite-drop: false
[2023-07-05 15:51:04] [config] sync-freq: 200u
[2023-07-05 15:51:04] [config] sync-sgd: false
[2023-07-05 15:51:04] [config] tempdir: /tmp
[2023-07-05 15:51:04] [config] tied-embeddings: false
[2023-07-05 15:51:04] [config] tied-embeddings-all: false
[2023-07-05 15:51:04] [config] tied-embeddings-src: false
[2023-07-05 15:51:04] [config] train-embedder-rank:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] train-sets:
[2023-07-05 15:51:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:04] [config] transformer-aan-activation: swish
[2023-07-05 15:51:04] [config] transformer-aan-depth: 2
[2023-07-05 15:51:04] [config] transformer-aan-nogate: false
[2023-07-05 15:51:04] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:04] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:04] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:04] [config] transformer-depth-scaling: false
[2023-07-05 15:51:04] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:04] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:04] [config] transformer-dropout: 0
[2023-07-05 15:51:04] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:04] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:04] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:04] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:04] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:04] [config] transformer-heads: 8
[2023-07-05 15:51:04] [config] transformer-no-projection: false
[2023-07-05 15:51:04] [config] transformer-pool: false
[2023-07-05 15:51:04] [config] transformer-postprocess: dan
[2023-07-05 15:51:04] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:04] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:04] [config] transformer-preprocess: ""
[2023-07-05 15:51:04] [config] transformer-tied-layers:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:04] [config] tsv: false
[2023-07-05 15:51:04] [config] tsv-fields: 0
[2023-07-05 15:51:04] [config] type: s2s
[2023-07-05 15:51:04] [config] ulr: false
[2023-07-05 15:51:04] [config] ulr-dim-emb: 0
[2023-07-05 15:51:04] [config] ulr-dropout: 0
[2023-07-05 15:51:04] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:04] [config] ulr-query-vectors: ""
[2023-07-05 15:51:04] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:04] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:04] [config] unlikelihood-loss: false
[2023-07-05 15:51:04] [config] valid-freq: 50000000
[2023-07-05 15:51:04] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:04] [config] valid-max-length: 1000
[2023-07-05 15:51:04] [config] valid-metrics:
[2023-07-05 15:51:04] [config]   - cross-entropy
[2023-07-05 15:51:04] [config]   - translation
[2023-07-05 15:51:04] [config] valid-mini-batch: 32
[2023-07-05 15:51:04] [config] valid-reset-stalled: false
[2023-07-05 15:51:04] [config] valid-script-args:
[2023-07-05 15:51:04] [config]   []
[2023-07-05 15:51:04] [config] valid-script-path: ""
[2023-07-05 15:51:04] [config] valid-sets:
[2023-07-05 15:51:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:04] [config] vocabs:
[2023-07-05 15:51:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:04] [config] word-penalty: 0
[2023-07-05 15:51:04] [config] word-scores: false
[2023-07-05 15:51:04] [config] workspace: 2048
[2023-07-05 15:51:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:04] [training] Using single-device training
[2023-07-05 15:51:04] Synced seed 1234
[2023-07-05 15:51:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:04] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:04] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:04] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:05] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:05] [comm] Using global sharding
[2023-07-05 15:51:05] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:05] [training] Using 1 GPUs
[2023-07-05 15:51:05] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:08] Loading Adam parameters
[2023-07-05 15:51:08] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:08] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:09] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:09] [data] Shuffling data
[2023-07-05 15:51:09] [data] Done reading 20,192 sentences
[2023-07-05 15:51:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:09] Training started
[2023-07-05 15:51:09] Training finished
[2023-07-05 15:51:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:13] [marian] Running on node22.datos.cluster.uy as process 11224 with command line:
[2023-07-05 15:51:13] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:13] [config] after: 0e
[2023-07-05 15:51:13] [config] after-batches: 0
[2023-07-05 15:51:13] [config] after-epochs: 130
[2023-07-05 15:51:13] [config] all-caps-every: 0
[2023-07-05 15:51:13] [config] allow-unk: false
[2023-07-05 15:51:13] [config] authors: false
[2023-07-05 15:51:13] [config] beam-size: 12
[2023-07-05 15:51:13] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:13] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:13] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:13] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:13] [config] build-info: ""
[2023-07-05 15:51:13] [config] check-gradient-nan: false
[2023-07-05 15:51:13] [config] check-nan: false
[2023-07-05 15:51:13] [config] cite: false
[2023-07-05 15:51:13] [config] clip-norm: 1
[2023-07-05 15:51:13] [config] cost-scaling:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] cost-type: ce-sum
[2023-07-05 15:51:13] [config] cpu-threads: 0
[2023-07-05 15:51:13] [config] data-threads: 8
[2023-07-05 15:51:13] [config] data-weighting: ""
[2023-07-05 15:51:13] [config] data-weighting-type: sentence
[2023-07-05 15:51:13] [config] dec-cell: gru
[2023-07-05 15:51:13] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:13] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:13] [config] dec-depth: 1
[2023-07-05 15:51:13] [config] devices:
[2023-07-05 15:51:13] [config]   - 0
[2023-07-05 15:51:13] [config] dim-emb: 512
[2023-07-05 15:51:13] [config] dim-rnn: 1024
[2023-07-05 15:51:13] [config] dim-vocabs:
[2023-07-05 15:51:13] [config]   - 36507
[2023-07-05 15:51:13] [config]   - 54042
[2023-07-05 15:51:13] [config] disp-first: 0
[2023-07-05 15:51:13] [config] disp-freq: 1000u
[2023-07-05 15:51:13] [config] disp-label-counts: true
[2023-07-05 15:51:13] [config] dropout-rnn: 0
[2023-07-05 15:51:13] [config] dropout-src: 0
[2023-07-05 15:51:13] [config] dropout-trg: 0
[2023-07-05 15:51:13] [config] dump-config: ""
[2023-07-05 15:51:13] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] early-stopping: 10
[2023-07-05 15:51:13] [config] early-stopping-on: first
[2023-07-05 15:51:13] [config] embedding-fix-src: false
[2023-07-05 15:51:13] [config] embedding-fix-trg: false
[2023-07-05 15:51:13] [config] embedding-normalization: false
[2023-07-05 15:51:13] [config] embedding-vectors:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] enc-cell: gru
[2023-07-05 15:51:13] [config] enc-cell-depth: 1
[2023-07-05 15:51:13] [config] enc-depth: 1
[2023-07-05 15:51:13] [config] enc-type: bidirectional
[2023-07-05 15:51:13] [config] english-title-case-every: 0
[2023-07-05 15:51:13] [config] exponential-smoothing: 0
[2023-07-05 15:51:13] [config] factor-weight: 1
[2023-07-05 15:51:13] [config] factors-combine: sum
[2023-07-05 15:51:13] [config] factors-dim-emb: 0
[2023-07-05 15:51:13] [config] gradient-checkpointing: false
[2023-07-05 15:51:13] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:13] [config] guided-alignment: none
[2023-07-05 15:51:13] [config] guided-alignment-cost: mse
[2023-07-05 15:51:13] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:13] [config] ignore-model-config: false
[2023-07-05 15:51:13] [config] input-types:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] interpolate-env-vars: false
[2023-07-05 15:51:13] [config] keep-best: false
[2023-07-05 15:51:13] [config] label-smoothing: 0
[2023-07-05 15:51:13] [config] layer-normalization: false
[2023-07-05 15:51:13] [config] learn-rate: 0.0001
[2023-07-05 15:51:13] [config] lemma-dependency: ""
[2023-07-05 15:51:13] [config] lemma-dim-emb: 0
[2023-07-05 15:51:13] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:13] [config] log-level: info
[2023-07-05 15:51:13] [config] log-time-zone: ""
[2023-07-05 15:51:13] [config] logical-epoch:
[2023-07-05 15:51:13] [config]   - 1e
[2023-07-05 15:51:13] [config]   - 0
[2023-07-05 15:51:13] [config] lr-decay: 0
[2023-07-05 15:51:13] [config] lr-decay-freq: 50000
[2023-07-05 15:51:13] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:13] [config]   - 0
[2023-07-05 15:51:13] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:13] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:13] [config] lr-decay-start:
[2023-07-05 15:51:13] [config]   - 10
[2023-07-05 15:51:13] [config]   - 1
[2023-07-05 15:51:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:13] [config] lr-report: false
[2023-07-05 15:51:13] [config] lr-warmup: 0
[2023-07-05 15:51:13] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:13] [config] lr-warmup-cycle: false
[2023-07-05 15:51:13] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:13] [config] max-length: 50
[2023-07-05 15:51:13] [config] max-length-crop: false
[2023-07-05 15:51:13] [config] max-length-factor: 3
[2023-07-05 15:51:13] [config] maxi-batch: 100
[2023-07-05 15:51:13] [config] maxi-batch-sort: trg
[2023-07-05 15:51:13] [config] mini-batch: 64
[2023-07-05 15:51:13] [config] mini-batch-fit: false
[2023-07-05 15:51:13] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:13] [config] mini-batch-round-up: true
[2023-07-05 15:51:13] [config] mini-batch-track-lr: false
[2023-07-05 15:51:13] [config] mini-batch-warmup: 0
[2023-07-05 15:51:13] [config] mini-batch-words: 0
[2023-07-05 15:51:13] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:13] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:13] [config] multi-loss-type: sum
[2023-07-05 15:51:13] [config] n-best: false
[2023-07-05 15:51:13] [config] no-nccl: false
[2023-07-05 15:51:13] [config] no-reload: false
[2023-07-05 15:51:13] [config] no-restore-corpus: false
[2023-07-05 15:51:13] [config] normalize: 0
[2023-07-05 15:51:13] [config] normalize-gradient: false
[2023-07-05 15:51:13] [config] num-devices: 0
[2023-07-05 15:51:13] [config] optimizer: adam
[2023-07-05 15:51:13] [config] optimizer-delay: 1
[2023-07-05 15:51:13] [config] optimizer-params:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] output-omit-bias: false
[2023-07-05 15:51:13] [config] overwrite: true
[2023-07-05 15:51:13] [config] precision:
[2023-07-05 15:51:13] [config]   - float32
[2023-07-05 15:51:13] [config]   - float32
[2023-07-05 15:51:13] [config] pretrained-model: ""
[2023-07-05 15:51:13] [config] quantize-biases: false
[2023-07-05 15:51:13] [config] quantize-bits: 0
[2023-07-05 15:51:13] [config] quantize-log-based: false
[2023-07-05 15:51:13] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:13] [config] quiet: false
[2023-07-05 15:51:13] [config] quiet-translation: true
[2023-07-05 15:51:13] [config] relative-paths: false
[2023-07-05 15:51:13] [config] right-left: false
[2023-07-05 15:51:13] [config] save-freq: 10000u
[2023-07-05 15:51:13] [config] seed: 1234
[2023-07-05 15:51:13] [config] sentencepiece-alphas:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:13] [config] sentencepiece-options: ""
[2023-07-05 15:51:13] [config] sharding: global
[2023-07-05 15:51:13] [config] shuffle: data
[2023-07-05 15:51:13] [config] shuffle-in-ram: false
[2023-07-05 15:51:13] [config] sigterm: save-and-exit
[2023-07-05 15:51:13] [config] skip: false
[2023-07-05 15:51:13] [config] sqlite: ""
[2023-07-05 15:51:13] [config] sqlite-drop: false
[2023-07-05 15:51:13] [config] sync-freq: 200u
[2023-07-05 15:51:13] [config] sync-sgd: false
[2023-07-05 15:51:13] [config] tempdir: /tmp
[2023-07-05 15:51:13] [config] tied-embeddings: false
[2023-07-05 15:51:13] [config] tied-embeddings-all: false
[2023-07-05 15:51:13] [config] tied-embeddings-src: false
[2023-07-05 15:51:13] [config] train-embedder-rank:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] train-sets:
[2023-07-05 15:51:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:13] [config] transformer-aan-activation: swish
[2023-07-05 15:51:13] [config] transformer-aan-depth: 2
[2023-07-05 15:51:13] [config] transformer-aan-nogate: false
[2023-07-05 15:51:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:13] [config] transformer-depth-scaling: false
[2023-07-05 15:51:13] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:13] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:13] [config] transformer-dropout: 0
[2023-07-05 15:51:13] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:13] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:13] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:13] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:13] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:13] [config] transformer-heads: 8
[2023-07-05 15:51:13] [config] transformer-no-projection: false
[2023-07-05 15:51:13] [config] transformer-pool: false
[2023-07-05 15:51:13] [config] transformer-postprocess: dan
[2023-07-05 15:51:13] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:13] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:13] [config] transformer-preprocess: ""
[2023-07-05 15:51:13] [config] transformer-tied-layers:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:13] [config] tsv: false
[2023-07-05 15:51:13] [config] tsv-fields: 0
[2023-07-05 15:51:13] [config] type: s2s
[2023-07-05 15:51:13] [config] ulr: false
[2023-07-05 15:51:13] [config] ulr-dim-emb: 0
[2023-07-05 15:51:13] [config] ulr-dropout: 0
[2023-07-05 15:51:13] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:13] [config] ulr-query-vectors: ""
[2023-07-05 15:51:13] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:13] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:13] [config] unlikelihood-loss: false
[2023-07-05 15:51:13] [config] valid-freq: 50000000
[2023-07-05 15:51:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:13] [config] valid-max-length: 1000
[2023-07-05 15:51:13] [config] valid-metrics:
[2023-07-05 15:51:13] [config]   - cross-entropy
[2023-07-05 15:51:13] [config]   - translation
[2023-07-05 15:51:13] [config] valid-mini-batch: 32
[2023-07-05 15:51:13] [config] valid-reset-stalled: false
[2023-07-05 15:51:13] [config] valid-script-args:
[2023-07-05 15:51:13] [config]   []
[2023-07-05 15:51:13] [config] valid-script-path: ""
[2023-07-05 15:51:13] [config] valid-sets:
[2023-07-05 15:51:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:13] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:13] [config] vocabs:
[2023-07-05 15:51:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:13] [config] word-penalty: 0
[2023-07-05 15:51:13] [config] word-scores: false
[2023-07-05 15:51:13] [config] workspace: 2048
[2023-07-05 15:51:13] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:13] [training] Using single-device training
[2023-07-05 15:51:13] Synced seed 1234
[2023-07-05 15:51:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:13] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:13] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:13] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:14] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:14] [comm] Using global sharding
[2023-07-05 15:51:14] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:14] [training] Using 1 GPUs
[2023-07-05 15:51:14] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:16] Loading Adam parameters
[2023-07-05 15:51:16] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:16] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:16] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:16] [data] Shuffling data
[2023-07-05 15:51:16] [data] Done reading 20,192 sentences
[2023-07-05 15:51:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:16] Training started
[2023-07-05 15:51:16] Training finished
[2023-07-05 15:51:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:20] [marian] Running on node22.datos.cluster.uy as process 11371 with command line:
[2023-07-05 15:51:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:20] [config] after: 0e
[2023-07-05 15:51:20] [config] after-batches: 0
[2023-07-05 15:51:20] [config] after-epochs: 140
[2023-07-05 15:51:20] [config] all-caps-every: 0
[2023-07-05 15:51:20] [config] allow-unk: false
[2023-07-05 15:51:20] [config] authors: false
[2023-07-05 15:51:20] [config] beam-size: 12
[2023-07-05 15:51:20] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:20] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:20] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:20] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:20] [config] build-info: ""
[2023-07-05 15:51:20] [config] check-gradient-nan: false
[2023-07-05 15:51:20] [config] check-nan: false
[2023-07-05 15:51:20] [config] cite: false
[2023-07-05 15:51:20] [config] clip-norm: 1
[2023-07-05 15:51:20] [config] cost-scaling:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] cost-type: ce-sum
[2023-07-05 15:51:20] [config] cpu-threads: 0
[2023-07-05 15:51:20] [config] data-threads: 8
[2023-07-05 15:51:20] [config] data-weighting: ""
[2023-07-05 15:51:20] [config] data-weighting-type: sentence
[2023-07-05 15:51:20] [config] dec-cell: gru
[2023-07-05 15:51:20] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:20] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:20] [config] dec-depth: 1
[2023-07-05 15:51:20] [config] devices:
[2023-07-05 15:51:20] [config]   - 0
[2023-07-05 15:51:20] [config] dim-emb: 512
[2023-07-05 15:51:20] [config] dim-rnn: 1024
[2023-07-05 15:51:20] [config] dim-vocabs:
[2023-07-05 15:51:20] [config]   - 36507
[2023-07-05 15:51:20] [config]   - 54042
[2023-07-05 15:51:20] [config] disp-first: 0
[2023-07-05 15:51:20] [config] disp-freq: 1000u
[2023-07-05 15:51:20] [config] disp-label-counts: true
[2023-07-05 15:51:20] [config] dropout-rnn: 0
[2023-07-05 15:51:20] [config] dropout-src: 0
[2023-07-05 15:51:20] [config] dropout-trg: 0
[2023-07-05 15:51:20] [config] dump-config: ""
[2023-07-05 15:51:20] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] early-stopping: 10
[2023-07-05 15:51:20] [config] early-stopping-on: first
[2023-07-05 15:51:20] [config] embedding-fix-src: false
[2023-07-05 15:51:20] [config] embedding-fix-trg: false
[2023-07-05 15:51:20] [config] embedding-normalization: false
[2023-07-05 15:51:20] [config] embedding-vectors:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] enc-cell: gru
[2023-07-05 15:51:20] [config] enc-cell-depth: 1
[2023-07-05 15:51:20] [config] enc-depth: 1
[2023-07-05 15:51:20] [config] enc-type: bidirectional
[2023-07-05 15:51:20] [config] english-title-case-every: 0
[2023-07-05 15:51:20] [config] exponential-smoothing: 0
[2023-07-05 15:51:20] [config] factor-weight: 1
[2023-07-05 15:51:20] [config] factors-combine: sum
[2023-07-05 15:51:20] [config] factors-dim-emb: 0
[2023-07-05 15:51:20] [config] gradient-checkpointing: false
[2023-07-05 15:51:20] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:20] [config] guided-alignment: none
[2023-07-05 15:51:20] [config] guided-alignment-cost: mse
[2023-07-05 15:51:20] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:20] [config] ignore-model-config: false
[2023-07-05 15:51:20] [config] input-types:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] interpolate-env-vars: false
[2023-07-05 15:51:20] [config] keep-best: false
[2023-07-05 15:51:20] [config] label-smoothing: 0
[2023-07-05 15:51:20] [config] layer-normalization: false
[2023-07-05 15:51:20] [config] learn-rate: 0.0001
[2023-07-05 15:51:20] [config] lemma-dependency: ""
[2023-07-05 15:51:20] [config] lemma-dim-emb: 0
[2023-07-05 15:51:20] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:20] [config] log-level: info
[2023-07-05 15:51:20] [config] log-time-zone: ""
[2023-07-05 15:51:20] [config] logical-epoch:
[2023-07-05 15:51:20] [config]   - 1e
[2023-07-05 15:51:20] [config]   - 0
[2023-07-05 15:51:20] [config] lr-decay: 0
[2023-07-05 15:51:20] [config] lr-decay-freq: 50000
[2023-07-05 15:51:20] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:20] [config]   - 0
[2023-07-05 15:51:20] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:20] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:20] [config] lr-decay-start:
[2023-07-05 15:51:20] [config]   - 10
[2023-07-05 15:51:20] [config]   - 1
[2023-07-05 15:51:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:20] [config] lr-report: false
[2023-07-05 15:51:20] [config] lr-warmup: 0
[2023-07-05 15:51:20] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:20] [config] lr-warmup-cycle: false
[2023-07-05 15:51:20] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:20] [config] max-length: 50
[2023-07-05 15:51:20] [config] max-length-crop: false
[2023-07-05 15:51:20] [config] max-length-factor: 3
[2023-07-05 15:51:20] [config] maxi-batch: 100
[2023-07-05 15:51:20] [config] maxi-batch-sort: trg
[2023-07-05 15:51:20] [config] mini-batch: 64
[2023-07-05 15:51:20] [config] mini-batch-fit: false
[2023-07-05 15:51:20] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:20] [config] mini-batch-round-up: true
[2023-07-05 15:51:20] [config] mini-batch-track-lr: false
[2023-07-05 15:51:20] [config] mini-batch-warmup: 0
[2023-07-05 15:51:20] [config] mini-batch-words: 0
[2023-07-05 15:51:20] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:20] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:20] [config] multi-loss-type: sum
[2023-07-05 15:51:20] [config] n-best: false
[2023-07-05 15:51:20] [config] no-nccl: false
[2023-07-05 15:51:20] [config] no-reload: false
[2023-07-05 15:51:20] [config] no-restore-corpus: false
[2023-07-05 15:51:20] [config] normalize: 0
[2023-07-05 15:51:20] [config] normalize-gradient: false
[2023-07-05 15:51:20] [config] num-devices: 0
[2023-07-05 15:51:20] [config] optimizer: adam
[2023-07-05 15:51:20] [config] optimizer-delay: 1
[2023-07-05 15:51:20] [config] optimizer-params:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] output-omit-bias: false
[2023-07-05 15:51:20] [config] overwrite: true
[2023-07-05 15:51:20] [config] precision:
[2023-07-05 15:51:20] [config]   - float32
[2023-07-05 15:51:20] [config]   - float32
[2023-07-05 15:51:20] [config] pretrained-model: ""
[2023-07-05 15:51:20] [config] quantize-biases: false
[2023-07-05 15:51:20] [config] quantize-bits: 0
[2023-07-05 15:51:20] [config] quantize-log-based: false
[2023-07-05 15:51:20] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:20] [config] quiet: false
[2023-07-05 15:51:20] [config] quiet-translation: true
[2023-07-05 15:51:20] [config] relative-paths: false
[2023-07-05 15:51:20] [config] right-left: false
[2023-07-05 15:51:20] [config] save-freq: 10000u
[2023-07-05 15:51:20] [config] seed: 1234
[2023-07-05 15:51:20] [config] sentencepiece-alphas:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:20] [config] sentencepiece-options: ""
[2023-07-05 15:51:20] [config] sharding: global
[2023-07-05 15:51:20] [config] shuffle: data
[2023-07-05 15:51:20] [config] shuffle-in-ram: false
[2023-07-05 15:51:20] [config] sigterm: save-and-exit
[2023-07-05 15:51:20] [config] skip: false
[2023-07-05 15:51:20] [config] sqlite: ""
[2023-07-05 15:51:20] [config] sqlite-drop: false
[2023-07-05 15:51:20] [config] sync-freq: 200u
[2023-07-05 15:51:20] [config] sync-sgd: false
[2023-07-05 15:51:20] [config] tempdir: /tmp
[2023-07-05 15:51:20] [config] tied-embeddings: false
[2023-07-05 15:51:20] [config] tied-embeddings-all: false
[2023-07-05 15:51:20] [config] tied-embeddings-src: false
[2023-07-05 15:51:20] [config] train-embedder-rank:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] train-sets:
[2023-07-05 15:51:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:20] [config] transformer-aan-activation: swish
[2023-07-05 15:51:20] [config] transformer-aan-depth: 2
[2023-07-05 15:51:20] [config] transformer-aan-nogate: false
[2023-07-05 15:51:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:20] [config] transformer-depth-scaling: false
[2023-07-05 15:51:20] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:20] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:20] [config] transformer-dropout: 0
[2023-07-05 15:51:20] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:20] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:20] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:20] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:20] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:20] [config] transformer-heads: 8
[2023-07-05 15:51:20] [config] transformer-no-projection: false
[2023-07-05 15:51:20] [config] transformer-pool: false
[2023-07-05 15:51:20] [config] transformer-postprocess: dan
[2023-07-05 15:51:20] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:20] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:20] [config] transformer-preprocess: ""
[2023-07-05 15:51:20] [config] transformer-tied-layers:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:20] [config] tsv: false
[2023-07-05 15:51:20] [config] tsv-fields: 0
[2023-07-05 15:51:20] [config] type: s2s
[2023-07-05 15:51:20] [config] ulr: false
[2023-07-05 15:51:20] [config] ulr-dim-emb: 0
[2023-07-05 15:51:20] [config] ulr-dropout: 0
[2023-07-05 15:51:20] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:20] [config] ulr-query-vectors: ""
[2023-07-05 15:51:20] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:20] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:20] [config] unlikelihood-loss: false
[2023-07-05 15:51:20] [config] valid-freq: 50000000
[2023-07-05 15:51:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:20] [config] valid-max-length: 1000
[2023-07-05 15:51:20] [config] valid-metrics:
[2023-07-05 15:51:20] [config]   - cross-entropy
[2023-07-05 15:51:20] [config]   - translation
[2023-07-05 15:51:20] [config] valid-mini-batch: 32
[2023-07-05 15:51:20] [config] valid-reset-stalled: false
[2023-07-05 15:51:20] [config] valid-script-args:
[2023-07-05 15:51:20] [config]   []
[2023-07-05 15:51:20] [config] valid-script-path: ""
[2023-07-05 15:51:20] [config] valid-sets:
[2023-07-05 15:51:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:20] [config] vocabs:
[2023-07-05 15:51:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:20] [config] word-penalty: 0
[2023-07-05 15:51:20] [config] word-scores: false
[2023-07-05 15:51:20] [config] workspace: 2048
[2023-07-05 15:51:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:20] [training] Using single-device training
[2023-07-05 15:51:20] Synced seed 1234
[2023-07-05 15:51:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:20] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:20] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:20] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:21] [comm] Using global sharding
[2023-07-05 15:51:21] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:21] [training] Using 1 GPUs
[2023-07-05 15:51:21] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:23] Loading Adam parameters
[2023-07-05 15:51:23] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:23] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:23] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:23] [data] Shuffling data
[2023-07-05 15:51:23] [data] Done reading 20,192 sentences
[2023-07-05 15:51:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:23] Training started
[2023-07-05 15:51:23] Training finished
[2023-07-05 15:51:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:27] [marian] Running on node22.datos.cluster.uy as process 11522 with command line:
[2023-07-05 15:51:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:27] [config] after: 0e
[2023-07-05 15:51:27] [config] after-batches: 0
[2023-07-05 15:51:27] [config] after-epochs: 150
[2023-07-05 15:51:27] [config] all-caps-every: 0
[2023-07-05 15:51:27] [config] allow-unk: false
[2023-07-05 15:51:27] [config] authors: false
[2023-07-05 15:51:27] [config] beam-size: 12
[2023-07-05 15:51:27] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:27] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:27] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:27] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:27] [config] build-info: ""
[2023-07-05 15:51:27] [config] check-gradient-nan: false
[2023-07-05 15:51:27] [config] check-nan: false
[2023-07-05 15:51:27] [config] cite: false
[2023-07-05 15:51:27] [config] clip-norm: 1
[2023-07-05 15:51:27] [config] cost-scaling:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] cost-type: ce-sum
[2023-07-05 15:51:27] [config] cpu-threads: 0
[2023-07-05 15:51:27] [config] data-threads: 8
[2023-07-05 15:51:27] [config] data-weighting: ""
[2023-07-05 15:51:27] [config] data-weighting-type: sentence
[2023-07-05 15:51:27] [config] dec-cell: gru
[2023-07-05 15:51:27] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:27] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:27] [config] dec-depth: 1
[2023-07-05 15:51:27] [config] devices:
[2023-07-05 15:51:27] [config]   - 0
[2023-07-05 15:51:27] [config] dim-emb: 512
[2023-07-05 15:51:27] [config] dim-rnn: 1024
[2023-07-05 15:51:27] [config] dim-vocabs:
[2023-07-05 15:51:27] [config]   - 36507
[2023-07-05 15:51:27] [config]   - 54042
[2023-07-05 15:51:27] [config] disp-first: 0
[2023-07-05 15:51:27] [config] disp-freq: 1000u
[2023-07-05 15:51:27] [config] disp-label-counts: true
[2023-07-05 15:51:27] [config] dropout-rnn: 0
[2023-07-05 15:51:27] [config] dropout-src: 0
[2023-07-05 15:51:27] [config] dropout-trg: 0
[2023-07-05 15:51:27] [config] dump-config: ""
[2023-07-05 15:51:27] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] early-stopping: 10
[2023-07-05 15:51:27] [config] early-stopping-on: first
[2023-07-05 15:51:27] [config] embedding-fix-src: false
[2023-07-05 15:51:27] [config] embedding-fix-trg: false
[2023-07-05 15:51:27] [config] embedding-normalization: false
[2023-07-05 15:51:27] [config] embedding-vectors:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] enc-cell: gru
[2023-07-05 15:51:27] [config] enc-cell-depth: 1
[2023-07-05 15:51:27] [config] enc-depth: 1
[2023-07-05 15:51:27] [config] enc-type: bidirectional
[2023-07-05 15:51:27] [config] english-title-case-every: 0
[2023-07-05 15:51:27] [config] exponential-smoothing: 0
[2023-07-05 15:51:27] [config] factor-weight: 1
[2023-07-05 15:51:27] [config] factors-combine: sum
[2023-07-05 15:51:27] [config] factors-dim-emb: 0
[2023-07-05 15:51:27] [config] gradient-checkpointing: false
[2023-07-05 15:51:27] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:27] [config] guided-alignment: none
[2023-07-05 15:51:27] [config] guided-alignment-cost: mse
[2023-07-05 15:51:27] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:27] [config] ignore-model-config: false
[2023-07-05 15:51:27] [config] input-types:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] interpolate-env-vars: false
[2023-07-05 15:51:27] [config] keep-best: false
[2023-07-05 15:51:27] [config] label-smoothing: 0
[2023-07-05 15:51:27] [config] layer-normalization: false
[2023-07-05 15:51:27] [config] learn-rate: 0.0001
[2023-07-05 15:51:27] [config] lemma-dependency: ""
[2023-07-05 15:51:27] [config] lemma-dim-emb: 0
[2023-07-05 15:51:27] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:27] [config] log-level: info
[2023-07-05 15:51:27] [config] log-time-zone: ""
[2023-07-05 15:51:27] [config] logical-epoch:
[2023-07-05 15:51:27] [config]   - 1e
[2023-07-05 15:51:27] [config]   - 0
[2023-07-05 15:51:27] [config] lr-decay: 0
[2023-07-05 15:51:27] [config] lr-decay-freq: 50000
[2023-07-05 15:51:27] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:27] [config]   - 0
[2023-07-05 15:51:27] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:27] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:27] [config] lr-decay-start:
[2023-07-05 15:51:27] [config]   - 10
[2023-07-05 15:51:27] [config]   - 1
[2023-07-05 15:51:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:27] [config] lr-report: false
[2023-07-05 15:51:27] [config] lr-warmup: 0
[2023-07-05 15:51:27] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:27] [config] lr-warmup-cycle: false
[2023-07-05 15:51:27] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:27] [config] max-length: 50
[2023-07-05 15:51:27] [config] max-length-crop: false
[2023-07-05 15:51:27] [config] max-length-factor: 3
[2023-07-05 15:51:27] [config] maxi-batch: 100
[2023-07-05 15:51:27] [config] maxi-batch-sort: trg
[2023-07-05 15:51:27] [config] mini-batch: 64
[2023-07-05 15:51:27] [config] mini-batch-fit: false
[2023-07-05 15:51:27] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:27] [config] mini-batch-round-up: true
[2023-07-05 15:51:27] [config] mini-batch-track-lr: false
[2023-07-05 15:51:27] [config] mini-batch-warmup: 0
[2023-07-05 15:51:27] [config] mini-batch-words: 0
[2023-07-05 15:51:27] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:27] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:27] [config] multi-loss-type: sum
[2023-07-05 15:51:27] [config] n-best: false
[2023-07-05 15:51:27] [config] no-nccl: false
[2023-07-05 15:51:27] [config] no-reload: false
[2023-07-05 15:51:27] [config] no-restore-corpus: false
[2023-07-05 15:51:27] [config] normalize: 0
[2023-07-05 15:51:27] [config] normalize-gradient: false
[2023-07-05 15:51:27] [config] num-devices: 0
[2023-07-05 15:51:27] [config] optimizer: adam
[2023-07-05 15:51:27] [config] optimizer-delay: 1
[2023-07-05 15:51:27] [config] optimizer-params:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] output-omit-bias: false
[2023-07-05 15:51:27] [config] overwrite: true
[2023-07-05 15:51:27] [config] precision:
[2023-07-05 15:51:27] [config]   - float32
[2023-07-05 15:51:27] [config]   - float32
[2023-07-05 15:51:27] [config] pretrained-model: ""
[2023-07-05 15:51:27] [config] quantize-biases: false
[2023-07-05 15:51:27] [config] quantize-bits: 0
[2023-07-05 15:51:27] [config] quantize-log-based: false
[2023-07-05 15:51:27] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:27] [config] quiet: false
[2023-07-05 15:51:27] [config] quiet-translation: true
[2023-07-05 15:51:27] [config] relative-paths: false
[2023-07-05 15:51:27] [config] right-left: false
[2023-07-05 15:51:27] [config] save-freq: 10000u
[2023-07-05 15:51:27] [config] seed: 1234
[2023-07-05 15:51:27] [config] sentencepiece-alphas:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:27] [config] sentencepiece-options: ""
[2023-07-05 15:51:27] [config] sharding: global
[2023-07-05 15:51:27] [config] shuffle: data
[2023-07-05 15:51:27] [config] shuffle-in-ram: false
[2023-07-05 15:51:27] [config] sigterm: save-and-exit
[2023-07-05 15:51:27] [config] skip: false
[2023-07-05 15:51:27] [config] sqlite: ""
[2023-07-05 15:51:27] [config] sqlite-drop: false
[2023-07-05 15:51:27] [config] sync-freq: 200u
[2023-07-05 15:51:27] [config] sync-sgd: false
[2023-07-05 15:51:27] [config] tempdir: /tmp
[2023-07-05 15:51:27] [config] tied-embeddings: false
[2023-07-05 15:51:27] [config] tied-embeddings-all: false
[2023-07-05 15:51:27] [config] tied-embeddings-src: false
[2023-07-05 15:51:27] [config] train-embedder-rank:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] train-sets:
[2023-07-05 15:51:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:27] [config] transformer-aan-activation: swish
[2023-07-05 15:51:27] [config] transformer-aan-depth: 2
[2023-07-05 15:51:27] [config] transformer-aan-nogate: false
[2023-07-05 15:51:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:27] [config] transformer-depth-scaling: false
[2023-07-05 15:51:27] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:27] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:27] [config] transformer-dropout: 0
[2023-07-05 15:51:27] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:27] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:27] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:27] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:27] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:27] [config] transformer-heads: 8
[2023-07-05 15:51:27] [config] transformer-no-projection: false
[2023-07-05 15:51:27] [config] transformer-pool: false
[2023-07-05 15:51:27] [config] transformer-postprocess: dan
[2023-07-05 15:51:27] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:27] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:27] [config] transformer-preprocess: ""
[2023-07-05 15:51:27] [config] transformer-tied-layers:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:27] [config] tsv: false
[2023-07-05 15:51:27] [config] tsv-fields: 0
[2023-07-05 15:51:27] [config] type: s2s
[2023-07-05 15:51:27] [config] ulr: false
[2023-07-05 15:51:27] [config] ulr-dim-emb: 0
[2023-07-05 15:51:27] [config] ulr-dropout: 0
[2023-07-05 15:51:27] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:27] [config] ulr-query-vectors: ""
[2023-07-05 15:51:27] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:27] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:27] [config] unlikelihood-loss: false
[2023-07-05 15:51:27] [config] valid-freq: 50000000
[2023-07-05 15:51:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:27] [config] valid-max-length: 1000
[2023-07-05 15:51:27] [config] valid-metrics:
[2023-07-05 15:51:27] [config]   - cross-entropy
[2023-07-05 15:51:27] [config]   - translation
[2023-07-05 15:51:27] [config] valid-mini-batch: 32
[2023-07-05 15:51:27] [config] valid-reset-stalled: false
[2023-07-05 15:51:27] [config] valid-script-args:
[2023-07-05 15:51:27] [config]   []
[2023-07-05 15:51:27] [config] valid-script-path: ""
[2023-07-05 15:51:27] [config] valid-sets:
[2023-07-05 15:51:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:27] [config] vocabs:
[2023-07-05 15:51:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:27] [config] word-penalty: 0
[2023-07-05 15:51:27] [config] word-scores: false
[2023-07-05 15:51:27] [config] workspace: 2048
[2023-07-05 15:51:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:27] [training] Using single-device training
[2023-07-05 15:51:27] Synced seed 1234
[2023-07-05 15:51:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:27] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:27] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:27] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:28] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:28] [comm] Using global sharding
[2023-07-05 15:51:28] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:28] [training] Using 1 GPUs
[2023-07-05 15:51:28] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:30] Loading Adam parameters
[2023-07-05 15:51:30] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:30] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:30] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:30] [data] Shuffling data
[2023-07-05 15:51:31] [data] Done reading 20,192 sentences
[2023-07-05 15:51:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:31] Training started
[2023-07-05 15:51:31] Training finished
[2023-07-05 15:51:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:34] [marian] Running on node22.datos.cluster.uy as process 11672 with command line:
[2023-07-05 15:51:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:34] [config] after: 0e
[2023-07-05 15:51:34] [config] after-batches: 0
[2023-07-05 15:51:34] [config] after-epochs: 160
[2023-07-05 15:51:34] [config] all-caps-every: 0
[2023-07-05 15:51:34] [config] allow-unk: false
[2023-07-05 15:51:34] [config] authors: false
[2023-07-05 15:51:34] [config] beam-size: 12
[2023-07-05 15:51:34] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:34] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:34] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:34] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:34] [config] build-info: ""
[2023-07-05 15:51:34] [config] check-gradient-nan: false
[2023-07-05 15:51:34] [config] check-nan: false
[2023-07-05 15:51:34] [config] cite: false
[2023-07-05 15:51:34] [config] clip-norm: 1
[2023-07-05 15:51:34] [config] cost-scaling:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] cost-type: ce-sum
[2023-07-05 15:51:34] [config] cpu-threads: 0
[2023-07-05 15:51:34] [config] data-threads: 8
[2023-07-05 15:51:34] [config] data-weighting: ""
[2023-07-05 15:51:34] [config] data-weighting-type: sentence
[2023-07-05 15:51:34] [config] dec-cell: gru
[2023-07-05 15:51:34] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:34] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:34] [config] dec-depth: 1
[2023-07-05 15:51:34] [config] devices:
[2023-07-05 15:51:34] [config]   - 0
[2023-07-05 15:51:34] [config] dim-emb: 512
[2023-07-05 15:51:34] [config] dim-rnn: 1024
[2023-07-05 15:51:34] [config] dim-vocabs:
[2023-07-05 15:51:34] [config]   - 36507
[2023-07-05 15:51:34] [config]   - 54042
[2023-07-05 15:51:34] [config] disp-first: 0
[2023-07-05 15:51:34] [config] disp-freq: 1000u
[2023-07-05 15:51:34] [config] disp-label-counts: true
[2023-07-05 15:51:34] [config] dropout-rnn: 0
[2023-07-05 15:51:34] [config] dropout-src: 0
[2023-07-05 15:51:34] [config] dropout-trg: 0
[2023-07-05 15:51:34] [config] dump-config: ""
[2023-07-05 15:51:34] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] early-stopping: 10
[2023-07-05 15:51:34] [config] early-stopping-on: first
[2023-07-05 15:51:34] [config] embedding-fix-src: false
[2023-07-05 15:51:34] [config] embedding-fix-trg: false
[2023-07-05 15:51:34] [config] embedding-normalization: false
[2023-07-05 15:51:34] [config] embedding-vectors:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] enc-cell: gru
[2023-07-05 15:51:34] [config] enc-cell-depth: 1
[2023-07-05 15:51:34] [config] enc-depth: 1
[2023-07-05 15:51:34] [config] enc-type: bidirectional
[2023-07-05 15:51:34] [config] english-title-case-every: 0
[2023-07-05 15:51:34] [config] exponential-smoothing: 0
[2023-07-05 15:51:34] [config] factor-weight: 1
[2023-07-05 15:51:34] [config] factors-combine: sum
[2023-07-05 15:51:34] [config] factors-dim-emb: 0
[2023-07-05 15:51:34] [config] gradient-checkpointing: false
[2023-07-05 15:51:34] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:34] [config] guided-alignment: none
[2023-07-05 15:51:34] [config] guided-alignment-cost: mse
[2023-07-05 15:51:34] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:34] [config] ignore-model-config: false
[2023-07-05 15:51:34] [config] input-types:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] interpolate-env-vars: false
[2023-07-05 15:51:34] [config] keep-best: false
[2023-07-05 15:51:34] [config] label-smoothing: 0
[2023-07-05 15:51:34] [config] layer-normalization: false
[2023-07-05 15:51:34] [config] learn-rate: 0.0001
[2023-07-05 15:51:34] [config] lemma-dependency: ""
[2023-07-05 15:51:34] [config] lemma-dim-emb: 0
[2023-07-05 15:51:34] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:34] [config] log-level: info
[2023-07-05 15:51:34] [config] log-time-zone: ""
[2023-07-05 15:51:34] [config] logical-epoch:
[2023-07-05 15:51:34] [config]   - 1e
[2023-07-05 15:51:34] [config]   - 0
[2023-07-05 15:51:34] [config] lr-decay: 0
[2023-07-05 15:51:34] [config] lr-decay-freq: 50000
[2023-07-05 15:51:34] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:34] [config]   - 0
[2023-07-05 15:51:34] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:34] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:34] [config] lr-decay-start:
[2023-07-05 15:51:34] [config]   - 10
[2023-07-05 15:51:34] [config]   - 1
[2023-07-05 15:51:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:34] [config] lr-report: false
[2023-07-05 15:51:34] [config] lr-warmup: 0
[2023-07-05 15:51:34] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:34] [config] lr-warmup-cycle: false
[2023-07-05 15:51:34] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:34] [config] max-length: 50
[2023-07-05 15:51:34] [config] max-length-crop: false
[2023-07-05 15:51:34] [config] max-length-factor: 3
[2023-07-05 15:51:34] [config] maxi-batch: 100
[2023-07-05 15:51:34] [config] maxi-batch-sort: trg
[2023-07-05 15:51:34] [config] mini-batch: 64
[2023-07-05 15:51:34] [config] mini-batch-fit: false
[2023-07-05 15:51:34] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:34] [config] mini-batch-round-up: true
[2023-07-05 15:51:34] [config] mini-batch-track-lr: false
[2023-07-05 15:51:34] [config] mini-batch-warmup: 0
[2023-07-05 15:51:34] [config] mini-batch-words: 0
[2023-07-05 15:51:34] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:34] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:34] [config] multi-loss-type: sum
[2023-07-05 15:51:34] [config] n-best: false
[2023-07-05 15:51:34] [config] no-nccl: false
[2023-07-05 15:51:34] [config] no-reload: false
[2023-07-05 15:51:34] [config] no-restore-corpus: false
[2023-07-05 15:51:34] [config] normalize: 0
[2023-07-05 15:51:34] [config] normalize-gradient: false
[2023-07-05 15:51:34] [config] num-devices: 0
[2023-07-05 15:51:34] [config] optimizer: adam
[2023-07-05 15:51:34] [config] optimizer-delay: 1
[2023-07-05 15:51:34] [config] optimizer-params:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] output-omit-bias: false
[2023-07-05 15:51:34] [config] overwrite: true
[2023-07-05 15:51:34] [config] precision:
[2023-07-05 15:51:34] [config]   - float32
[2023-07-05 15:51:34] [config]   - float32
[2023-07-05 15:51:34] [config] pretrained-model: ""
[2023-07-05 15:51:34] [config] quantize-biases: false
[2023-07-05 15:51:34] [config] quantize-bits: 0
[2023-07-05 15:51:34] [config] quantize-log-based: false
[2023-07-05 15:51:34] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:34] [config] quiet: false
[2023-07-05 15:51:34] [config] quiet-translation: true
[2023-07-05 15:51:34] [config] relative-paths: false
[2023-07-05 15:51:34] [config] right-left: false
[2023-07-05 15:51:34] [config] save-freq: 10000u
[2023-07-05 15:51:34] [config] seed: 1234
[2023-07-05 15:51:34] [config] sentencepiece-alphas:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:34] [config] sentencepiece-options: ""
[2023-07-05 15:51:34] [config] sharding: global
[2023-07-05 15:51:34] [config] shuffle: data
[2023-07-05 15:51:34] [config] shuffle-in-ram: false
[2023-07-05 15:51:34] [config] sigterm: save-and-exit
[2023-07-05 15:51:34] [config] skip: false
[2023-07-05 15:51:34] [config] sqlite: ""
[2023-07-05 15:51:34] [config] sqlite-drop: false
[2023-07-05 15:51:34] [config] sync-freq: 200u
[2023-07-05 15:51:34] [config] sync-sgd: false
[2023-07-05 15:51:34] [config] tempdir: /tmp
[2023-07-05 15:51:34] [config] tied-embeddings: false
[2023-07-05 15:51:34] [config] tied-embeddings-all: false
[2023-07-05 15:51:34] [config] tied-embeddings-src: false
[2023-07-05 15:51:34] [config] train-embedder-rank:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] train-sets:
[2023-07-05 15:51:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:34] [config] transformer-aan-activation: swish
[2023-07-05 15:51:34] [config] transformer-aan-depth: 2
[2023-07-05 15:51:34] [config] transformer-aan-nogate: false
[2023-07-05 15:51:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:34] [config] transformer-depth-scaling: false
[2023-07-05 15:51:34] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:34] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:34] [config] transformer-dropout: 0
[2023-07-05 15:51:34] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:34] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:34] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:34] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:34] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:34] [config] transformer-heads: 8
[2023-07-05 15:51:34] [config] transformer-no-projection: false
[2023-07-05 15:51:34] [config] transformer-pool: false
[2023-07-05 15:51:34] [config] transformer-postprocess: dan
[2023-07-05 15:51:34] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:34] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:34] [config] transformer-preprocess: ""
[2023-07-05 15:51:34] [config] transformer-tied-layers:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:34] [config] tsv: false
[2023-07-05 15:51:34] [config] tsv-fields: 0
[2023-07-05 15:51:34] [config] type: s2s
[2023-07-05 15:51:34] [config] ulr: false
[2023-07-05 15:51:34] [config] ulr-dim-emb: 0
[2023-07-05 15:51:34] [config] ulr-dropout: 0
[2023-07-05 15:51:34] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:34] [config] ulr-query-vectors: ""
[2023-07-05 15:51:34] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:34] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:34] [config] unlikelihood-loss: false
[2023-07-05 15:51:34] [config] valid-freq: 50000000
[2023-07-05 15:51:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:34] [config] valid-max-length: 1000
[2023-07-05 15:51:34] [config] valid-metrics:
[2023-07-05 15:51:34] [config]   - cross-entropy
[2023-07-05 15:51:34] [config]   - translation
[2023-07-05 15:51:34] [config] valid-mini-batch: 32
[2023-07-05 15:51:34] [config] valid-reset-stalled: false
[2023-07-05 15:51:34] [config] valid-script-args:
[2023-07-05 15:51:34] [config]   []
[2023-07-05 15:51:34] [config] valid-script-path: ""
[2023-07-05 15:51:34] [config] valid-sets:
[2023-07-05 15:51:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:34] [config] vocabs:
[2023-07-05 15:51:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:34] [config] word-penalty: 0
[2023-07-05 15:51:34] [config] word-scores: false
[2023-07-05 15:51:34] [config] workspace: 2048
[2023-07-05 15:51:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:34] [training] Using single-device training
[2023-07-05 15:51:35] Synced seed 1234
[2023-07-05 15:51:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:35] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:35] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:35] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:35] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:36] [comm] Using global sharding
[2023-07-05 15:51:36] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:36] [training] Using 1 GPUs
[2023-07-05 15:51:36] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:37] Loading Adam parameters
[2023-07-05 15:51:37] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:38] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:38] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:38] [data] Shuffling data
[2023-07-05 15:51:38] [data] Done reading 20,192 sentences
[2023-07-05 15:51:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:38] Training started
[2023-07-05 15:51:38] Training finished
[2023-07-05 15:51:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:41] [marian] Running on node22.datos.cluster.uy as process 11820 with command line:
[2023-07-05 15:51:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:41] [config] after: 0e
[2023-07-05 15:51:41] [config] after-batches: 0
[2023-07-05 15:51:41] [config] after-epochs: 170
[2023-07-05 15:51:41] [config] all-caps-every: 0
[2023-07-05 15:51:41] [config] allow-unk: false
[2023-07-05 15:51:41] [config] authors: false
[2023-07-05 15:51:41] [config] beam-size: 12
[2023-07-05 15:51:41] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:41] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:41] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:41] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:41] [config] build-info: ""
[2023-07-05 15:51:41] [config] check-gradient-nan: false
[2023-07-05 15:51:41] [config] check-nan: false
[2023-07-05 15:51:41] [config] cite: false
[2023-07-05 15:51:41] [config] clip-norm: 1
[2023-07-05 15:51:41] [config] cost-scaling:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] cost-type: ce-sum
[2023-07-05 15:51:41] [config] cpu-threads: 0
[2023-07-05 15:51:41] [config] data-threads: 8
[2023-07-05 15:51:41] [config] data-weighting: ""
[2023-07-05 15:51:41] [config] data-weighting-type: sentence
[2023-07-05 15:51:41] [config] dec-cell: gru
[2023-07-05 15:51:41] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:41] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:41] [config] dec-depth: 1
[2023-07-05 15:51:41] [config] devices:
[2023-07-05 15:51:41] [config]   - 0
[2023-07-05 15:51:41] [config] dim-emb: 512
[2023-07-05 15:51:41] [config] dim-rnn: 1024
[2023-07-05 15:51:41] [config] dim-vocabs:
[2023-07-05 15:51:41] [config]   - 36507
[2023-07-05 15:51:41] [config]   - 54042
[2023-07-05 15:51:41] [config] disp-first: 0
[2023-07-05 15:51:41] [config] disp-freq: 1000u
[2023-07-05 15:51:41] [config] disp-label-counts: true
[2023-07-05 15:51:41] [config] dropout-rnn: 0
[2023-07-05 15:51:41] [config] dropout-src: 0
[2023-07-05 15:51:41] [config] dropout-trg: 0
[2023-07-05 15:51:41] [config] dump-config: ""
[2023-07-05 15:51:41] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] early-stopping: 10
[2023-07-05 15:51:41] [config] early-stopping-on: first
[2023-07-05 15:51:41] [config] embedding-fix-src: false
[2023-07-05 15:51:41] [config] embedding-fix-trg: false
[2023-07-05 15:51:41] [config] embedding-normalization: false
[2023-07-05 15:51:41] [config] embedding-vectors:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] enc-cell: gru
[2023-07-05 15:51:41] [config] enc-cell-depth: 1
[2023-07-05 15:51:41] [config] enc-depth: 1
[2023-07-05 15:51:41] [config] enc-type: bidirectional
[2023-07-05 15:51:41] [config] english-title-case-every: 0
[2023-07-05 15:51:41] [config] exponential-smoothing: 0
[2023-07-05 15:51:41] [config] factor-weight: 1
[2023-07-05 15:51:41] [config] factors-combine: sum
[2023-07-05 15:51:41] [config] factors-dim-emb: 0
[2023-07-05 15:51:41] [config] gradient-checkpointing: false
[2023-07-05 15:51:41] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:41] [config] guided-alignment: none
[2023-07-05 15:51:41] [config] guided-alignment-cost: mse
[2023-07-05 15:51:41] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:41] [config] ignore-model-config: false
[2023-07-05 15:51:41] [config] input-types:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] interpolate-env-vars: false
[2023-07-05 15:51:41] [config] keep-best: false
[2023-07-05 15:51:41] [config] label-smoothing: 0
[2023-07-05 15:51:41] [config] layer-normalization: false
[2023-07-05 15:51:41] [config] learn-rate: 0.0001
[2023-07-05 15:51:41] [config] lemma-dependency: ""
[2023-07-05 15:51:41] [config] lemma-dim-emb: 0
[2023-07-05 15:51:41] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:41] [config] log-level: info
[2023-07-05 15:51:41] [config] log-time-zone: ""
[2023-07-05 15:51:41] [config] logical-epoch:
[2023-07-05 15:51:41] [config]   - 1e
[2023-07-05 15:51:41] [config]   - 0
[2023-07-05 15:51:41] [config] lr-decay: 0
[2023-07-05 15:51:41] [config] lr-decay-freq: 50000
[2023-07-05 15:51:41] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:41] [config]   - 0
[2023-07-05 15:51:41] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:41] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:41] [config] lr-decay-start:
[2023-07-05 15:51:41] [config]   - 10
[2023-07-05 15:51:41] [config]   - 1
[2023-07-05 15:51:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:41] [config] lr-report: false
[2023-07-05 15:51:41] [config] lr-warmup: 0
[2023-07-05 15:51:41] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:41] [config] lr-warmup-cycle: false
[2023-07-05 15:51:41] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:41] [config] max-length: 50
[2023-07-05 15:51:41] [config] max-length-crop: false
[2023-07-05 15:51:41] [config] max-length-factor: 3
[2023-07-05 15:51:41] [config] maxi-batch: 100
[2023-07-05 15:51:41] [config] maxi-batch-sort: trg
[2023-07-05 15:51:41] [config] mini-batch: 64
[2023-07-05 15:51:41] [config] mini-batch-fit: false
[2023-07-05 15:51:41] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:41] [config] mini-batch-round-up: true
[2023-07-05 15:51:41] [config] mini-batch-track-lr: false
[2023-07-05 15:51:41] [config] mini-batch-warmup: 0
[2023-07-05 15:51:41] [config] mini-batch-words: 0
[2023-07-05 15:51:41] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:41] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:41] [config] multi-loss-type: sum
[2023-07-05 15:51:41] [config] n-best: false
[2023-07-05 15:51:41] [config] no-nccl: false
[2023-07-05 15:51:41] [config] no-reload: false
[2023-07-05 15:51:41] [config] no-restore-corpus: false
[2023-07-05 15:51:41] [config] normalize: 0
[2023-07-05 15:51:41] [config] normalize-gradient: false
[2023-07-05 15:51:41] [config] num-devices: 0
[2023-07-05 15:51:41] [config] optimizer: adam
[2023-07-05 15:51:41] [config] optimizer-delay: 1
[2023-07-05 15:51:41] [config] optimizer-params:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] output-omit-bias: false
[2023-07-05 15:51:41] [config] overwrite: true
[2023-07-05 15:51:41] [config] precision:
[2023-07-05 15:51:41] [config]   - float32
[2023-07-05 15:51:41] [config]   - float32
[2023-07-05 15:51:41] [config] pretrained-model: ""
[2023-07-05 15:51:41] [config] quantize-biases: false
[2023-07-05 15:51:41] [config] quantize-bits: 0
[2023-07-05 15:51:41] [config] quantize-log-based: false
[2023-07-05 15:51:41] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:41] [config] quiet: false
[2023-07-05 15:51:41] [config] quiet-translation: true
[2023-07-05 15:51:41] [config] relative-paths: false
[2023-07-05 15:51:41] [config] right-left: false
[2023-07-05 15:51:41] [config] save-freq: 10000u
[2023-07-05 15:51:41] [config] seed: 1234
[2023-07-05 15:51:41] [config] sentencepiece-alphas:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:41] [config] sentencepiece-options: ""
[2023-07-05 15:51:41] [config] sharding: global
[2023-07-05 15:51:41] [config] shuffle: data
[2023-07-05 15:51:41] [config] shuffle-in-ram: false
[2023-07-05 15:51:41] [config] sigterm: save-and-exit
[2023-07-05 15:51:41] [config] skip: false
[2023-07-05 15:51:41] [config] sqlite: ""
[2023-07-05 15:51:41] [config] sqlite-drop: false
[2023-07-05 15:51:41] [config] sync-freq: 200u
[2023-07-05 15:51:41] [config] sync-sgd: false
[2023-07-05 15:51:41] [config] tempdir: /tmp
[2023-07-05 15:51:41] [config] tied-embeddings: false
[2023-07-05 15:51:41] [config] tied-embeddings-all: false
[2023-07-05 15:51:41] [config] tied-embeddings-src: false
[2023-07-05 15:51:41] [config] train-embedder-rank:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] train-sets:
[2023-07-05 15:51:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:41] [config] transformer-aan-activation: swish
[2023-07-05 15:51:41] [config] transformer-aan-depth: 2
[2023-07-05 15:51:41] [config] transformer-aan-nogate: false
[2023-07-05 15:51:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:41] [config] transformer-depth-scaling: false
[2023-07-05 15:51:41] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:41] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:41] [config] transformer-dropout: 0
[2023-07-05 15:51:41] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:41] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:41] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:41] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:41] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:41] [config] transformer-heads: 8
[2023-07-05 15:51:41] [config] transformer-no-projection: false
[2023-07-05 15:51:41] [config] transformer-pool: false
[2023-07-05 15:51:41] [config] transformer-postprocess: dan
[2023-07-05 15:51:41] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:41] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:41] [config] transformer-preprocess: ""
[2023-07-05 15:51:41] [config] transformer-tied-layers:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:41] [config] tsv: false
[2023-07-05 15:51:41] [config] tsv-fields: 0
[2023-07-05 15:51:41] [config] type: s2s
[2023-07-05 15:51:41] [config] ulr: false
[2023-07-05 15:51:41] [config] ulr-dim-emb: 0
[2023-07-05 15:51:41] [config] ulr-dropout: 0
[2023-07-05 15:51:41] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:41] [config] ulr-query-vectors: ""
[2023-07-05 15:51:41] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:41] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:41] [config] unlikelihood-loss: false
[2023-07-05 15:51:41] [config] valid-freq: 50000000
[2023-07-05 15:51:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:41] [config] valid-max-length: 1000
[2023-07-05 15:51:41] [config] valid-metrics:
[2023-07-05 15:51:41] [config]   - cross-entropy
[2023-07-05 15:51:41] [config]   - translation
[2023-07-05 15:51:41] [config] valid-mini-batch: 32
[2023-07-05 15:51:41] [config] valid-reset-stalled: false
[2023-07-05 15:51:41] [config] valid-script-args:
[2023-07-05 15:51:41] [config]   []
[2023-07-05 15:51:41] [config] valid-script-path: ""
[2023-07-05 15:51:41] [config] valid-sets:
[2023-07-05 15:51:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:41] [config] vocabs:
[2023-07-05 15:51:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:41] [config] word-penalty: 0
[2023-07-05 15:51:41] [config] word-scores: false
[2023-07-05 15:51:41] [config] workspace: 2048
[2023-07-05 15:51:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:41] [training] Using single-device training
[2023-07-05 15:51:42] Synced seed 1234
[2023-07-05 15:51:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:42] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:42] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:42] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:43] [comm] Using global sharding
[2023-07-05 15:51:43] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:43] [training] Using 1 GPUs
[2023-07-05 15:51:43] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:44] Loading Adam parameters
[2023-07-05 15:51:45] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:45] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:45] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:45] [data] Shuffling data
[2023-07-05 15:51:45] [data] Done reading 20,192 sentences
[2023-07-05 15:51:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:45] Training started
[2023-07-05 15:51:45] Training finished
[2023-07-05 15:51:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:48] [marian] Running on node22.datos.cluster.uy as process 11972 with command line:
[2023-07-05 15:51:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:48] [config] after: 0e
[2023-07-05 15:51:48] [config] after-batches: 0
[2023-07-05 15:51:48] [config] after-epochs: 180
[2023-07-05 15:51:48] [config] all-caps-every: 0
[2023-07-05 15:51:48] [config] allow-unk: false
[2023-07-05 15:51:48] [config] authors: false
[2023-07-05 15:51:48] [config] beam-size: 12
[2023-07-05 15:51:48] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:48] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:48] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:48] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:48] [config] build-info: ""
[2023-07-05 15:51:48] [config] check-gradient-nan: false
[2023-07-05 15:51:48] [config] check-nan: false
[2023-07-05 15:51:48] [config] cite: false
[2023-07-05 15:51:48] [config] clip-norm: 1
[2023-07-05 15:51:48] [config] cost-scaling:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] cost-type: ce-sum
[2023-07-05 15:51:48] [config] cpu-threads: 0
[2023-07-05 15:51:48] [config] data-threads: 8
[2023-07-05 15:51:48] [config] data-weighting: ""
[2023-07-05 15:51:48] [config] data-weighting-type: sentence
[2023-07-05 15:51:48] [config] dec-cell: gru
[2023-07-05 15:51:48] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:48] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:48] [config] dec-depth: 1
[2023-07-05 15:51:48] [config] devices:
[2023-07-05 15:51:48] [config]   - 0
[2023-07-05 15:51:48] [config] dim-emb: 512
[2023-07-05 15:51:48] [config] dim-rnn: 1024
[2023-07-05 15:51:48] [config] dim-vocabs:
[2023-07-05 15:51:48] [config]   - 36507
[2023-07-05 15:51:48] [config]   - 54042
[2023-07-05 15:51:48] [config] disp-first: 0
[2023-07-05 15:51:48] [config] disp-freq: 1000u
[2023-07-05 15:51:48] [config] disp-label-counts: true
[2023-07-05 15:51:48] [config] dropout-rnn: 0
[2023-07-05 15:51:48] [config] dropout-src: 0
[2023-07-05 15:51:48] [config] dropout-trg: 0
[2023-07-05 15:51:48] [config] dump-config: ""
[2023-07-05 15:51:48] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] early-stopping: 10
[2023-07-05 15:51:48] [config] early-stopping-on: first
[2023-07-05 15:51:48] [config] embedding-fix-src: false
[2023-07-05 15:51:48] [config] embedding-fix-trg: false
[2023-07-05 15:51:48] [config] embedding-normalization: false
[2023-07-05 15:51:48] [config] embedding-vectors:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] enc-cell: gru
[2023-07-05 15:51:48] [config] enc-cell-depth: 1
[2023-07-05 15:51:48] [config] enc-depth: 1
[2023-07-05 15:51:48] [config] enc-type: bidirectional
[2023-07-05 15:51:48] [config] english-title-case-every: 0
[2023-07-05 15:51:48] [config] exponential-smoothing: 0
[2023-07-05 15:51:48] [config] factor-weight: 1
[2023-07-05 15:51:48] [config] factors-combine: sum
[2023-07-05 15:51:48] [config] factors-dim-emb: 0
[2023-07-05 15:51:48] [config] gradient-checkpointing: false
[2023-07-05 15:51:48] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:48] [config] guided-alignment: none
[2023-07-05 15:51:48] [config] guided-alignment-cost: mse
[2023-07-05 15:51:48] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:48] [config] ignore-model-config: false
[2023-07-05 15:51:48] [config] input-types:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] interpolate-env-vars: false
[2023-07-05 15:51:48] [config] keep-best: false
[2023-07-05 15:51:48] [config] label-smoothing: 0
[2023-07-05 15:51:48] [config] layer-normalization: false
[2023-07-05 15:51:48] [config] learn-rate: 0.0001
[2023-07-05 15:51:48] [config] lemma-dependency: ""
[2023-07-05 15:51:48] [config] lemma-dim-emb: 0
[2023-07-05 15:51:48] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:48] [config] log-level: info
[2023-07-05 15:51:48] [config] log-time-zone: ""
[2023-07-05 15:51:48] [config] logical-epoch:
[2023-07-05 15:51:48] [config]   - 1e
[2023-07-05 15:51:48] [config]   - 0
[2023-07-05 15:51:48] [config] lr-decay: 0
[2023-07-05 15:51:48] [config] lr-decay-freq: 50000
[2023-07-05 15:51:48] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:48] [config]   - 0
[2023-07-05 15:51:48] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:48] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:48] [config] lr-decay-start:
[2023-07-05 15:51:48] [config]   - 10
[2023-07-05 15:51:48] [config]   - 1
[2023-07-05 15:51:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:48] [config] lr-report: false
[2023-07-05 15:51:48] [config] lr-warmup: 0
[2023-07-05 15:51:48] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:48] [config] lr-warmup-cycle: false
[2023-07-05 15:51:48] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:48] [config] max-length: 50
[2023-07-05 15:51:48] [config] max-length-crop: false
[2023-07-05 15:51:48] [config] max-length-factor: 3
[2023-07-05 15:51:48] [config] maxi-batch: 100
[2023-07-05 15:51:48] [config] maxi-batch-sort: trg
[2023-07-05 15:51:48] [config] mini-batch: 64
[2023-07-05 15:51:48] [config] mini-batch-fit: false
[2023-07-05 15:51:48] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:48] [config] mini-batch-round-up: true
[2023-07-05 15:51:48] [config] mini-batch-track-lr: false
[2023-07-05 15:51:48] [config] mini-batch-warmup: 0
[2023-07-05 15:51:48] [config] mini-batch-words: 0
[2023-07-05 15:51:48] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:48] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:48] [config] multi-loss-type: sum
[2023-07-05 15:51:48] [config] n-best: false
[2023-07-05 15:51:48] [config] no-nccl: false
[2023-07-05 15:51:48] [config] no-reload: false
[2023-07-05 15:51:48] [config] no-restore-corpus: false
[2023-07-05 15:51:48] [config] normalize: 0
[2023-07-05 15:51:48] [config] normalize-gradient: false
[2023-07-05 15:51:48] [config] num-devices: 0
[2023-07-05 15:51:48] [config] optimizer: adam
[2023-07-05 15:51:48] [config] optimizer-delay: 1
[2023-07-05 15:51:48] [config] optimizer-params:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] output-omit-bias: false
[2023-07-05 15:51:48] [config] overwrite: true
[2023-07-05 15:51:48] [config] precision:
[2023-07-05 15:51:48] [config]   - float32
[2023-07-05 15:51:48] [config]   - float32
[2023-07-05 15:51:48] [config] pretrained-model: ""
[2023-07-05 15:51:48] [config] quantize-biases: false
[2023-07-05 15:51:48] [config] quantize-bits: 0
[2023-07-05 15:51:48] [config] quantize-log-based: false
[2023-07-05 15:51:48] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:48] [config] quiet: false
[2023-07-05 15:51:48] [config] quiet-translation: true
[2023-07-05 15:51:48] [config] relative-paths: false
[2023-07-05 15:51:48] [config] right-left: false
[2023-07-05 15:51:48] [config] save-freq: 10000u
[2023-07-05 15:51:48] [config] seed: 1234
[2023-07-05 15:51:48] [config] sentencepiece-alphas:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:48] [config] sentencepiece-options: ""
[2023-07-05 15:51:48] [config] sharding: global
[2023-07-05 15:51:48] [config] shuffle: data
[2023-07-05 15:51:48] [config] shuffle-in-ram: false
[2023-07-05 15:51:48] [config] sigterm: save-and-exit
[2023-07-05 15:51:48] [config] skip: false
[2023-07-05 15:51:48] [config] sqlite: ""
[2023-07-05 15:51:48] [config] sqlite-drop: false
[2023-07-05 15:51:48] [config] sync-freq: 200u
[2023-07-05 15:51:48] [config] sync-sgd: false
[2023-07-05 15:51:48] [config] tempdir: /tmp
[2023-07-05 15:51:48] [config] tied-embeddings: false
[2023-07-05 15:51:48] [config] tied-embeddings-all: false
[2023-07-05 15:51:48] [config] tied-embeddings-src: false
[2023-07-05 15:51:48] [config] train-embedder-rank:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] train-sets:
[2023-07-05 15:51:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:48] [config] transformer-aan-activation: swish
[2023-07-05 15:51:48] [config] transformer-aan-depth: 2
[2023-07-05 15:51:48] [config] transformer-aan-nogate: false
[2023-07-05 15:51:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:48] [config] transformer-depth-scaling: false
[2023-07-05 15:51:48] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:48] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:48] [config] transformer-dropout: 0
[2023-07-05 15:51:48] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:48] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:48] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:48] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:48] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:48] [config] transformer-heads: 8
[2023-07-05 15:51:48] [config] transformer-no-projection: false
[2023-07-05 15:51:48] [config] transformer-pool: false
[2023-07-05 15:51:48] [config] transformer-postprocess: dan
[2023-07-05 15:51:48] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:48] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:48] [config] transformer-preprocess: ""
[2023-07-05 15:51:48] [config] transformer-tied-layers:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:48] [config] tsv: false
[2023-07-05 15:51:48] [config] tsv-fields: 0
[2023-07-05 15:51:48] [config] type: s2s
[2023-07-05 15:51:48] [config] ulr: false
[2023-07-05 15:51:48] [config] ulr-dim-emb: 0
[2023-07-05 15:51:48] [config] ulr-dropout: 0
[2023-07-05 15:51:48] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:48] [config] ulr-query-vectors: ""
[2023-07-05 15:51:48] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:48] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:48] [config] unlikelihood-loss: false
[2023-07-05 15:51:48] [config] valid-freq: 50000000
[2023-07-05 15:51:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:48] [config] valid-max-length: 1000
[2023-07-05 15:51:48] [config] valid-metrics:
[2023-07-05 15:51:48] [config]   - cross-entropy
[2023-07-05 15:51:48] [config]   - translation
[2023-07-05 15:51:48] [config] valid-mini-batch: 32
[2023-07-05 15:51:48] [config] valid-reset-stalled: false
[2023-07-05 15:51:48] [config] valid-script-args:
[2023-07-05 15:51:48] [config]   []
[2023-07-05 15:51:48] [config] valid-script-path: ""
[2023-07-05 15:51:48] [config] valid-sets:
[2023-07-05 15:51:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:48] [config] vocabs:
[2023-07-05 15:51:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:48] [config] word-penalty: 0
[2023-07-05 15:51:48] [config] word-scores: false
[2023-07-05 15:51:48] [config] workspace: 2048
[2023-07-05 15:51:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:48] [training] Using single-device training
[2023-07-05 15:51:49] Synced seed 1234
[2023-07-05 15:51:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:49] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:49] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:49] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:49] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:50] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:50] [comm] Using global sharding
[2023-07-05 15:51:50] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:50] [training] Using 1 GPUs
[2023-07-05 15:51:50] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:51] Loading Adam parameters
[2023-07-05 15:51:52] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:52] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:52] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:52] [data] Shuffling data
[2023-07-05 15:51:52] [data] Done reading 20,192 sentences
[2023-07-05 15:51:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:52] Training started
[2023-07-05 15:51:52] Training finished
[2023-07-05 15:51:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:56] [marian] Running on node22.datos.cluster.uy as process 12114 with command line:
[2023-07-05 15:51:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:51:56] [config] after: 0e
[2023-07-05 15:51:56] [config] after-batches: 0
[2023-07-05 15:51:56] [config] after-epochs: 190
[2023-07-05 15:51:56] [config] all-caps-every: 0
[2023-07-05 15:51:56] [config] allow-unk: false
[2023-07-05 15:51:56] [config] authors: false
[2023-07-05 15:51:56] [config] beam-size: 12
[2023-07-05 15:51:56] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:51:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:51:56] [config] bert-masking-fraction: 0.15
[2023-07-05 15:51:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:51:56] [config] bert-train-type-embeddings: true
[2023-07-05 15:51:56] [config] bert-type-vocab-size: 2
[2023-07-05 15:51:56] [config] build-info: ""
[2023-07-05 15:51:56] [config] check-gradient-nan: false
[2023-07-05 15:51:56] [config] check-nan: false
[2023-07-05 15:51:56] [config] cite: false
[2023-07-05 15:51:56] [config] clip-norm: 1
[2023-07-05 15:51:56] [config] cost-scaling:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] cost-type: ce-sum
[2023-07-05 15:51:56] [config] cpu-threads: 0
[2023-07-05 15:51:56] [config] data-threads: 8
[2023-07-05 15:51:56] [config] data-weighting: ""
[2023-07-05 15:51:56] [config] data-weighting-type: sentence
[2023-07-05 15:51:56] [config] dec-cell: gru
[2023-07-05 15:51:56] [config] dec-cell-base-depth: 2
[2023-07-05 15:51:56] [config] dec-cell-high-depth: 1
[2023-07-05 15:51:56] [config] dec-depth: 1
[2023-07-05 15:51:56] [config] devices:
[2023-07-05 15:51:56] [config]   - 0
[2023-07-05 15:51:56] [config] dim-emb: 512
[2023-07-05 15:51:56] [config] dim-rnn: 1024
[2023-07-05 15:51:56] [config] dim-vocabs:
[2023-07-05 15:51:56] [config]   - 36507
[2023-07-05 15:51:56] [config]   - 54042
[2023-07-05 15:51:56] [config] disp-first: 0
[2023-07-05 15:51:56] [config] disp-freq: 1000u
[2023-07-05 15:51:56] [config] disp-label-counts: true
[2023-07-05 15:51:56] [config] dropout-rnn: 0
[2023-07-05 15:51:56] [config] dropout-src: 0
[2023-07-05 15:51:56] [config] dropout-trg: 0
[2023-07-05 15:51:56] [config] dump-config: ""
[2023-07-05 15:51:56] [config] dynamic-gradient-scaling:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] early-stopping: 10
[2023-07-05 15:51:56] [config] early-stopping-on: first
[2023-07-05 15:51:56] [config] embedding-fix-src: false
[2023-07-05 15:51:56] [config] embedding-fix-trg: false
[2023-07-05 15:51:56] [config] embedding-normalization: false
[2023-07-05 15:51:56] [config] embedding-vectors:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] enc-cell: gru
[2023-07-05 15:51:56] [config] enc-cell-depth: 1
[2023-07-05 15:51:56] [config] enc-depth: 1
[2023-07-05 15:51:56] [config] enc-type: bidirectional
[2023-07-05 15:51:56] [config] english-title-case-every: 0
[2023-07-05 15:51:56] [config] exponential-smoothing: 0
[2023-07-05 15:51:56] [config] factor-weight: 1
[2023-07-05 15:51:56] [config] factors-combine: sum
[2023-07-05 15:51:56] [config] factors-dim-emb: 0
[2023-07-05 15:51:56] [config] gradient-checkpointing: false
[2023-07-05 15:51:56] [config] gradient-norm-average-window: 100
[2023-07-05 15:51:56] [config] guided-alignment: none
[2023-07-05 15:51:56] [config] guided-alignment-cost: mse
[2023-07-05 15:51:56] [config] guided-alignment-weight: 0.1
[2023-07-05 15:51:56] [config] ignore-model-config: false
[2023-07-05 15:51:56] [config] input-types:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] interpolate-env-vars: false
[2023-07-05 15:51:56] [config] keep-best: false
[2023-07-05 15:51:56] [config] label-smoothing: 0
[2023-07-05 15:51:56] [config] layer-normalization: false
[2023-07-05 15:51:56] [config] learn-rate: 0.0001
[2023-07-05 15:51:56] [config] lemma-dependency: ""
[2023-07-05 15:51:56] [config] lemma-dim-emb: 0
[2023-07-05 15:51:56] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:51:56] [config] log-level: info
[2023-07-05 15:51:56] [config] log-time-zone: ""
[2023-07-05 15:51:56] [config] logical-epoch:
[2023-07-05 15:51:56] [config]   - 1e
[2023-07-05 15:51:56] [config]   - 0
[2023-07-05 15:51:56] [config] lr-decay: 0
[2023-07-05 15:51:56] [config] lr-decay-freq: 50000
[2023-07-05 15:51:56] [config] lr-decay-inv-sqrt:
[2023-07-05 15:51:56] [config]   - 0
[2023-07-05 15:51:56] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:51:56] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:51:56] [config] lr-decay-start:
[2023-07-05 15:51:56] [config]   - 10
[2023-07-05 15:51:56] [config]   - 1
[2023-07-05 15:51:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:51:56] [config] lr-report: false
[2023-07-05 15:51:56] [config] lr-warmup: 0
[2023-07-05 15:51:56] [config] lr-warmup-at-reload: false
[2023-07-05 15:51:56] [config] lr-warmup-cycle: false
[2023-07-05 15:51:56] [config] lr-warmup-start-rate: 0
[2023-07-05 15:51:56] [config] max-length: 50
[2023-07-05 15:51:56] [config] max-length-crop: false
[2023-07-05 15:51:56] [config] max-length-factor: 3
[2023-07-05 15:51:56] [config] maxi-batch: 100
[2023-07-05 15:51:56] [config] maxi-batch-sort: trg
[2023-07-05 15:51:56] [config] mini-batch: 64
[2023-07-05 15:51:56] [config] mini-batch-fit: false
[2023-07-05 15:51:56] [config] mini-batch-fit-step: 10
[2023-07-05 15:51:56] [config] mini-batch-round-up: true
[2023-07-05 15:51:56] [config] mini-batch-track-lr: false
[2023-07-05 15:51:56] [config] mini-batch-warmup: 0
[2023-07-05 15:51:56] [config] mini-batch-words: 0
[2023-07-05 15:51:56] [config] mini-batch-words-ref: 0
[2023-07-05 15:51:56] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:56] [config] multi-loss-type: sum
[2023-07-05 15:51:56] [config] n-best: false
[2023-07-05 15:51:56] [config] no-nccl: false
[2023-07-05 15:51:56] [config] no-reload: false
[2023-07-05 15:51:56] [config] no-restore-corpus: false
[2023-07-05 15:51:56] [config] normalize: 0
[2023-07-05 15:51:56] [config] normalize-gradient: false
[2023-07-05 15:51:56] [config] num-devices: 0
[2023-07-05 15:51:56] [config] optimizer: adam
[2023-07-05 15:51:56] [config] optimizer-delay: 1
[2023-07-05 15:51:56] [config] optimizer-params:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] output-omit-bias: false
[2023-07-05 15:51:56] [config] overwrite: true
[2023-07-05 15:51:56] [config] precision:
[2023-07-05 15:51:56] [config]   - float32
[2023-07-05 15:51:56] [config]   - float32
[2023-07-05 15:51:56] [config] pretrained-model: ""
[2023-07-05 15:51:56] [config] quantize-biases: false
[2023-07-05 15:51:56] [config] quantize-bits: 0
[2023-07-05 15:51:56] [config] quantize-log-based: false
[2023-07-05 15:51:56] [config] quantize-optimization-steps: 0
[2023-07-05 15:51:56] [config] quiet: false
[2023-07-05 15:51:56] [config] quiet-translation: true
[2023-07-05 15:51:56] [config] relative-paths: false
[2023-07-05 15:51:56] [config] right-left: false
[2023-07-05 15:51:56] [config] save-freq: 10000u
[2023-07-05 15:51:56] [config] seed: 1234
[2023-07-05 15:51:56] [config] sentencepiece-alphas:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:51:56] [config] sentencepiece-options: ""
[2023-07-05 15:51:56] [config] sharding: global
[2023-07-05 15:51:56] [config] shuffle: data
[2023-07-05 15:51:56] [config] shuffle-in-ram: false
[2023-07-05 15:51:56] [config] sigterm: save-and-exit
[2023-07-05 15:51:56] [config] skip: false
[2023-07-05 15:51:56] [config] sqlite: ""
[2023-07-05 15:51:56] [config] sqlite-drop: false
[2023-07-05 15:51:56] [config] sync-freq: 200u
[2023-07-05 15:51:56] [config] sync-sgd: false
[2023-07-05 15:51:56] [config] tempdir: /tmp
[2023-07-05 15:51:56] [config] tied-embeddings: false
[2023-07-05 15:51:56] [config] tied-embeddings-all: false
[2023-07-05 15:51:56] [config] tied-embeddings-src: false
[2023-07-05 15:51:56] [config] train-embedder-rank:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] train-sets:
[2023-07-05 15:51:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:51:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:51:56] [config] transformer-aan-activation: swish
[2023-07-05 15:51:56] [config] transformer-aan-depth: 2
[2023-07-05 15:51:56] [config] transformer-aan-nogate: false
[2023-07-05 15:51:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:51:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:51:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:51:56] [config] transformer-depth-scaling: false
[2023-07-05 15:51:56] [config] transformer-dim-aan: 2048
[2023-07-05 15:51:56] [config] transformer-dim-ffn: 2048
[2023-07-05 15:51:56] [config] transformer-dropout: 0
[2023-07-05 15:51:56] [config] transformer-dropout-attention: 0
[2023-07-05 15:51:56] [config] transformer-dropout-ffn: 0
[2023-07-05 15:51:56] [config] transformer-ffn-activation: swish
[2023-07-05 15:51:56] [config] transformer-ffn-depth: 2
[2023-07-05 15:51:56] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:51:56] [config] transformer-heads: 8
[2023-07-05 15:51:56] [config] transformer-no-projection: false
[2023-07-05 15:51:56] [config] transformer-pool: false
[2023-07-05 15:51:56] [config] transformer-postprocess: dan
[2023-07-05 15:51:56] [config] transformer-postprocess-emb: d
[2023-07-05 15:51:56] [config] transformer-postprocess-top: ""
[2023-07-05 15:51:56] [config] transformer-preprocess: ""
[2023-07-05 15:51:56] [config] transformer-tied-layers:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] transformer-train-position-embeddings: false
[2023-07-05 15:51:56] [config] tsv: false
[2023-07-05 15:51:56] [config] tsv-fields: 0
[2023-07-05 15:51:56] [config] type: s2s
[2023-07-05 15:51:56] [config] ulr: false
[2023-07-05 15:51:56] [config] ulr-dim-emb: 0
[2023-07-05 15:51:56] [config] ulr-dropout: 0
[2023-07-05 15:51:56] [config] ulr-keys-vectors: ""
[2023-07-05 15:51:56] [config] ulr-query-vectors: ""
[2023-07-05 15:51:56] [config] ulr-softmax-temperature: 1
[2023-07-05 15:51:56] [config] ulr-trainable-transformation: false
[2023-07-05 15:51:56] [config] unlikelihood-loss: false
[2023-07-05 15:51:56] [config] valid-freq: 50000000
[2023-07-05 15:51:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:51:56] [config] valid-max-length: 1000
[2023-07-05 15:51:56] [config] valid-metrics:
[2023-07-05 15:51:56] [config]   - cross-entropy
[2023-07-05 15:51:56] [config]   - translation
[2023-07-05 15:51:56] [config] valid-mini-batch: 32
[2023-07-05 15:51:56] [config] valid-reset-stalled: false
[2023-07-05 15:51:56] [config] valid-script-args:
[2023-07-05 15:51:56] [config]   []
[2023-07-05 15:51:56] [config] valid-script-path: ""
[2023-07-05 15:51:56] [config] valid-sets:
[2023-07-05 15:51:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:51:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:51:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:51:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:56] [config] vocabs:
[2023-07-05 15:51:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:56] [config] word-penalty: 0
[2023-07-05 15:51:56] [config] word-scores: false
[2023-07-05 15:51:56] [config] workspace: 2048
[2023-07-05 15:51:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:51:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:56] [training] Using single-device training
[2023-07-05 15:51:56] Synced seed 1234
[2023-07-05 15:51:56] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:51:56] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:51:56] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:51:56] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:51:56] [valid] No post-processing script given for validating translator
[2023-07-05 15:51:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:51:57] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:51:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:51:57] [comm] Using global sharding
[2023-07-05 15:51:57] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:51:57] [training] Using 1 GPUs
[2023-07-05 15:51:57] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:51:58] Loading Adam parameters
[2023-07-05 15:51:59] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:51:59] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:51:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:51:59] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:51:59] [data] Shuffling data
[2023-07-05 15:51:59] [data] Done reading 20,192 sentences
[2023-07-05 15:51:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:51:59] Training started
[2023-07-05 15:51:59] Training finished
[2023-07-05 15:52:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:52:03] [marian] Running on node22.datos.cluster.uy as process 12268 with command line:
[2023-07-05 15:52:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type s2s
[2023-07-05 15:52:03] [config] after: 0e
[2023-07-05 15:52:03] [config] after-batches: 0
[2023-07-05 15:52:03] [config] after-epochs: 200
[2023-07-05 15:52:03] [config] all-caps-every: 0
[2023-07-05 15:52:03] [config] allow-unk: false
[2023-07-05 15:52:03] [config] authors: false
[2023-07-05 15:52:03] [config] beam-size: 12
[2023-07-05 15:52:03] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:52:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:52:03] [config] bert-masking-fraction: 0.15
[2023-07-05 15:52:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:52:03] [config] bert-train-type-embeddings: true
[2023-07-05 15:52:03] [config] bert-type-vocab-size: 2
[2023-07-05 15:52:03] [config] build-info: ""
[2023-07-05 15:52:03] [config] check-gradient-nan: false
[2023-07-05 15:52:03] [config] check-nan: false
[2023-07-05 15:52:03] [config] cite: false
[2023-07-05 15:52:03] [config] clip-norm: 1
[2023-07-05 15:52:03] [config] cost-scaling:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] cost-type: ce-sum
[2023-07-05 15:52:03] [config] cpu-threads: 0
[2023-07-05 15:52:03] [config] data-threads: 8
[2023-07-05 15:52:03] [config] data-weighting: ""
[2023-07-05 15:52:03] [config] data-weighting-type: sentence
[2023-07-05 15:52:03] [config] dec-cell: gru
[2023-07-05 15:52:03] [config] dec-cell-base-depth: 2
[2023-07-05 15:52:03] [config] dec-cell-high-depth: 1
[2023-07-05 15:52:03] [config] dec-depth: 1
[2023-07-05 15:52:03] [config] devices:
[2023-07-05 15:52:03] [config]   - 0
[2023-07-05 15:52:03] [config] dim-emb: 512
[2023-07-05 15:52:03] [config] dim-rnn: 1024
[2023-07-05 15:52:03] [config] dim-vocabs:
[2023-07-05 15:52:03] [config]   - 36507
[2023-07-05 15:52:03] [config]   - 54042
[2023-07-05 15:52:03] [config] disp-first: 0
[2023-07-05 15:52:03] [config] disp-freq: 1000u
[2023-07-05 15:52:03] [config] disp-label-counts: true
[2023-07-05 15:52:03] [config] dropout-rnn: 0
[2023-07-05 15:52:03] [config] dropout-src: 0
[2023-07-05 15:52:03] [config] dropout-trg: 0
[2023-07-05 15:52:03] [config] dump-config: ""
[2023-07-05 15:52:03] [config] dynamic-gradient-scaling:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] early-stopping: 10
[2023-07-05 15:52:03] [config] early-stopping-on: first
[2023-07-05 15:52:03] [config] embedding-fix-src: false
[2023-07-05 15:52:03] [config] embedding-fix-trg: false
[2023-07-05 15:52:03] [config] embedding-normalization: false
[2023-07-05 15:52:03] [config] embedding-vectors:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] enc-cell: gru
[2023-07-05 15:52:03] [config] enc-cell-depth: 1
[2023-07-05 15:52:03] [config] enc-depth: 1
[2023-07-05 15:52:03] [config] enc-type: bidirectional
[2023-07-05 15:52:03] [config] english-title-case-every: 0
[2023-07-05 15:52:03] [config] exponential-smoothing: 0
[2023-07-05 15:52:03] [config] factor-weight: 1
[2023-07-05 15:52:03] [config] factors-combine: sum
[2023-07-05 15:52:03] [config] factors-dim-emb: 0
[2023-07-05 15:52:03] [config] gradient-checkpointing: false
[2023-07-05 15:52:03] [config] gradient-norm-average-window: 100
[2023-07-05 15:52:03] [config] guided-alignment: none
[2023-07-05 15:52:03] [config] guided-alignment-cost: mse
[2023-07-05 15:52:03] [config] guided-alignment-weight: 0.1
[2023-07-05 15:52:03] [config] ignore-model-config: false
[2023-07-05 15:52:03] [config] input-types:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] interpolate-env-vars: false
[2023-07-05 15:52:03] [config] keep-best: false
[2023-07-05 15:52:03] [config] label-smoothing: 0
[2023-07-05 15:52:03] [config] layer-normalization: false
[2023-07-05 15:52:03] [config] learn-rate: 0.0001
[2023-07-05 15:52:03] [config] lemma-dependency: ""
[2023-07-05 15:52:03] [config] lemma-dim-emb: 0
[2023-07-05 15:52:03] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:52:03] [config] log-level: info
[2023-07-05 15:52:03] [config] log-time-zone: ""
[2023-07-05 15:52:03] [config] logical-epoch:
[2023-07-05 15:52:03] [config]   - 1e
[2023-07-05 15:52:03] [config]   - 0
[2023-07-05 15:52:03] [config] lr-decay: 0
[2023-07-05 15:52:03] [config] lr-decay-freq: 50000
[2023-07-05 15:52:03] [config] lr-decay-inv-sqrt:
[2023-07-05 15:52:03] [config]   - 0
[2023-07-05 15:52:03] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:52:03] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:52:03] [config] lr-decay-start:
[2023-07-05 15:52:03] [config]   - 10
[2023-07-05 15:52:03] [config]   - 1
[2023-07-05 15:52:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:52:03] [config] lr-report: false
[2023-07-05 15:52:03] [config] lr-warmup: 0
[2023-07-05 15:52:03] [config] lr-warmup-at-reload: false
[2023-07-05 15:52:03] [config] lr-warmup-cycle: false
[2023-07-05 15:52:03] [config] lr-warmup-start-rate: 0
[2023-07-05 15:52:03] [config] max-length: 50
[2023-07-05 15:52:03] [config] max-length-crop: false
[2023-07-05 15:52:03] [config] max-length-factor: 3
[2023-07-05 15:52:03] [config] maxi-batch: 100
[2023-07-05 15:52:03] [config] maxi-batch-sort: trg
[2023-07-05 15:52:03] [config] mini-batch: 64
[2023-07-05 15:52:03] [config] mini-batch-fit: false
[2023-07-05 15:52:03] [config] mini-batch-fit-step: 10
[2023-07-05 15:52:03] [config] mini-batch-round-up: true
[2023-07-05 15:52:03] [config] mini-batch-track-lr: false
[2023-07-05 15:52:03] [config] mini-batch-warmup: 0
[2023-07-05 15:52:03] [config] mini-batch-words: 0
[2023-07-05 15:52:03] [config] mini-batch-words-ref: 0
[2023-07-05 15:52:03] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:52:03] [config] multi-loss-type: sum
[2023-07-05 15:52:03] [config] n-best: false
[2023-07-05 15:52:03] [config] no-nccl: false
[2023-07-05 15:52:03] [config] no-reload: false
[2023-07-05 15:52:03] [config] no-restore-corpus: false
[2023-07-05 15:52:03] [config] normalize: 0
[2023-07-05 15:52:03] [config] normalize-gradient: false
[2023-07-05 15:52:03] [config] num-devices: 0
[2023-07-05 15:52:03] [config] optimizer: adam
[2023-07-05 15:52:03] [config] optimizer-delay: 1
[2023-07-05 15:52:03] [config] optimizer-params:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] output-omit-bias: false
[2023-07-05 15:52:03] [config] overwrite: true
[2023-07-05 15:52:03] [config] precision:
[2023-07-05 15:52:03] [config]   - float32
[2023-07-05 15:52:03] [config]   - float32
[2023-07-05 15:52:03] [config] pretrained-model: ""
[2023-07-05 15:52:03] [config] quantize-biases: false
[2023-07-05 15:52:03] [config] quantize-bits: 0
[2023-07-05 15:52:03] [config] quantize-log-based: false
[2023-07-05 15:52:03] [config] quantize-optimization-steps: 0
[2023-07-05 15:52:03] [config] quiet: false
[2023-07-05 15:52:03] [config] quiet-translation: true
[2023-07-05 15:52:03] [config] relative-paths: false
[2023-07-05 15:52:03] [config] right-left: false
[2023-07-05 15:52:03] [config] save-freq: 10000u
[2023-07-05 15:52:03] [config] seed: 1234
[2023-07-05 15:52:03] [config] sentencepiece-alphas:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:52:03] [config] sentencepiece-options: ""
[2023-07-05 15:52:03] [config] sharding: global
[2023-07-05 15:52:03] [config] shuffle: data
[2023-07-05 15:52:03] [config] shuffle-in-ram: false
[2023-07-05 15:52:03] [config] sigterm: save-and-exit
[2023-07-05 15:52:03] [config] skip: false
[2023-07-05 15:52:03] [config] sqlite: ""
[2023-07-05 15:52:03] [config] sqlite-drop: false
[2023-07-05 15:52:03] [config] sync-freq: 200u
[2023-07-05 15:52:03] [config] sync-sgd: false
[2023-07-05 15:52:03] [config] tempdir: /tmp
[2023-07-05 15:52:03] [config] tied-embeddings: false
[2023-07-05 15:52:03] [config] tied-embeddings-all: false
[2023-07-05 15:52:03] [config] tied-embeddings-src: false
[2023-07-05 15:52:03] [config] train-embedder-rank:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] train-sets:
[2023-07-05 15:52:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:52:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:52:03] [config] transformer-aan-activation: swish
[2023-07-05 15:52:03] [config] transformer-aan-depth: 2
[2023-07-05 15:52:03] [config] transformer-aan-nogate: false
[2023-07-05 15:52:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:52:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:52:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:52:03] [config] transformer-depth-scaling: false
[2023-07-05 15:52:03] [config] transformer-dim-aan: 2048
[2023-07-05 15:52:03] [config] transformer-dim-ffn: 2048
[2023-07-05 15:52:03] [config] transformer-dropout: 0
[2023-07-05 15:52:03] [config] transformer-dropout-attention: 0
[2023-07-05 15:52:03] [config] transformer-dropout-ffn: 0
[2023-07-05 15:52:03] [config] transformer-ffn-activation: swish
[2023-07-05 15:52:03] [config] transformer-ffn-depth: 2
[2023-07-05 15:52:03] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:52:03] [config] transformer-heads: 8
[2023-07-05 15:52:03] [config] transformer-no-projection: false
[2023-07-05 15:52:03] [config] transformer-pool: false
[2023-07-05 15:52:03] [config] transformer-postprocess: dan
[2023-07-05 15:52:03] [config] transformer-postprocess-emb: d
[2023-07-05 15:52:03] [config] transformer-postprocess-top: ""
[2023-07-05 15:52:03] [config] transformer-preprocess: ""
[2023-07-05 15:52:03] [config] transformer-tied-layers:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] transformer-train-position-embeddings: false
[2023-07-05 15:52:03] [config] tsv: false
[2023-07-05 15:52:03] [config] tsv-fields: 0
[2023-07-05 15:52:03] [config] type: s2s
[2023-07-05 15:52:03] [config] ulr: false
[2023-07-05 15:52:03] [config] ulr-dim-emb: 0
[2023-07-05 15:52:03] [config] ulr-dropout: 0
[2023-07-05 15:52:03] [config] ulr-keys-vectors: ""
[2023-07-05 15:52:03] [config] ulr-query-vectors: ""
[2023-07-05 15:52:03] [config] ulr-softmax-temperature: 1
[2023-07-05 15:52:03] [config] ulr-trainable-transformation: false
[2023-07-05 15:52:03] [config] unlikelihood-loss: false
[2023-07-05 15:52:03] [config] valid-freq: 50000000
[2023-07-05 15:52:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:52:03] [config] valid-max-length: 1000
[2023-07-05 15:52:03] [config] valid-metrics:
[2023-07-05 15:52:03] [config]   - cross-entropy
[2023-07-05 15:52:03] [config]   - translation
[2023-07-05 15:52:03] [config] valid-mini-batch: 32
[2023-07-05 15:52:03] [config] valid-reset-stalled: false
[2023-07-05 15:52:03] [config] valid-script-args:
[2023-07-05 15:52:03] [config]   []
[2023-07-05 15:52:03] [config] valid-script-path: ""
[2023-07-05 15:52:03] [config] valid-sets:
[2023-07-05 15:52:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:52:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:52:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:52:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:52:03] [config] vocabs:
[2023-07-05 15:52:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:52:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:52:03] [config] word-penalty: 0
[2023-07-05 15:52:03] [config] word-scores: false
[2023-07-05 15:52:03] [config] workspace: 2048
[2023-07-05 15:52:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:52:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:52:03] [training] Using single-device training
[2023-07-05 15:52:04] Synced seed 1234
[2023-07-05 15:52:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:52:04] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:52:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:52:04] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:52:04] [valid] No post-processing script given for validating translator
[2023-07-05 15:52:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:52:05] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:52:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:52:05] [comm] Using global sharding
[2023-07-05 15:52:05] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:52:05] [training] Using 1 GPUs
[2023-07-05 15:52:05] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz
[2023-07-05 15:52:06] Loading Adam parameters
[2023-07-05 15:52:07] [memory] Reserving 823 MB, device gpu0
[2023-07-05 15:52:07] [memory] Reserving 411 MB, device gpu0
[2023-07-05 15:52:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_s2s.npz.optimizer.npz
[2023-07-05 15:52:07] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 15:52:07] [data] Shuffling data
[2023-07-05 15:52:07] [data] Done reading 20,192 sentences
[2023-07-05 15:52:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:52:07] Training started
[2023-07-05 15:52:07] Training finished
[2023-07-05 15:52:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:52:12] [marian] Running on node22.datos.cluster.uy as process 12453 with command line:
[2023-07-05 15:52:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 15:52:12] [config] after: 0e
[2023-07-05 15:52:12] [config] after-batches: 0
[2023-07-05 15:52:12] [config] after-epochs: 10
[2023-07-05 15:52:12] [config] all-caps-every: 0
[2023-07-05 15:52:12] [config] allow-unk: false
[2023-07-05 15:52:12] [config] authors: false
[2023-07-05 15:52:12] [config] beam-size: 12
[2023-07-05 15:52:12] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:52:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:52:12] [config] bert-masking-fraction: 0.15
[2023-07-05 15:52:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:52:12] [config] bert-train-type-embeddings: true
[2023-07-05 15:52:12] [config] bert-type-vocab-size: 2
[2023-07-05 15:52:12] [config] build-info: ""
[2023-07-05 15:52:12] [config] check-gradient-nan: false
[2023-07-05 15:52:12] [config] check-nan: false
[2023-07-05 15:52:12] [config] cite: false
[2023-07-05 15:52:12] [config] clip-norm: 1
[2023-07-05 15:52:12] [config] cost-scaling:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] cost-type: ce-sum
[2023-07-05 15:52:12] [config] cpu-threads: 0
[2023-07-05 15:52:12] [config] data-threads: 8
[2023-07-05 15:52:12] [config] data-weighting: ""
[2023-07-05 15:52:12] [config] data-weighting-type: sentence
[2023-07-05 15:52:12] [config] dec-cell: gru
[2023-07-05 15:52:12] [config] dec-cell-base-depth: 2
[2023-07-05 15:52:12] [config] dec-cell-high-depth: 1
[2023-07-05 15:52:12] [config] dec-depth: 1
[2023-07-05 15:52:12] [config] devices:
[2023-07-05 15:52:12] [config]   - 0
[2023-07-05 15:52:12] [config] dim-emb: 512
[2023-07-05 15:52:12] [config] dim-rnn: 1024
[2023-07-05 15:52:12] [config] dim-vocabs:
[2023-07-05 15:52:12] [config]   - 0
[2023-07-05 15:52:12] [config]   - 0
[2023-07-05 15:52:12] [config] disp-first: 0
[2023-07-05 15:52:12] [config] disp-freq: 1000u
[2023-07-05 15:52:12] [config] disp-label-counts: true
[2023-07-05 15:52:12] [config] dropout-rnn: 0
[2023-07-05 15:52:12] [config] dropout-src: 0
[2023-07-05 15:52:12] [config] dropout-trg: 0
[2023-07-05 15:52:12] [config] dump-config: ""
[2023-07-05 15:52:12] [config] dynamic-gradient-scaling:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] early-stopping: 10
[2023-07-05 15:52:12] [config] early-stopping-on: first
[2023-07-05 15:52:12] [config] embedding-fix-src: false
[2023-07-05 15:52:12] [config] embedding-fix-trg: false
[2023-07-05 15:52:12] [config] embedding-normalization: false
[2023-07-05 15:52:12] [config] embedding-vectors:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] enc-cell: gru
[2023-07-05 15:52:12] [config] enc-cell-depth: 1
[2023-07-05 15:52:12] [config] enc-depth: 1
[2023-07-05 15:52:12] [config] enc-type: bidirectional
[2023-07-05 15:52:12] [config] english-title-case-every: 0
[2023-07-05 15:52:12] [config] exponential-smoothing: 0
[2023-07-05 15:52:12] [config] factor-weight: 1
[2023-07-05 15:52:12] [config] factors-combine: sum
[2023-07-05 15:52:12] [config] factors-dim-emb: 0
[2023-07-05 15:52:12] [config] gradient-checkpointing: false
[2023-07-05 15:52:12] [config] gradient-norm-average-window: 100
[2023-07-05 15:52:12] [config] guided-alignment: none
[2023-07-05 15:52:12] [config] guided-alignment-cost: mse
[2023-07-05 15:52:12] [config] guided-alignment-weight: 0.1
[2023-07-05 15:52:12] [config] ignore-model-config: false
[2023-07-05 15:52:12] [config] input-types:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] interpolate-env-vars: false
[2023-07-05 15:52:12] [config] keep-best: false
[2023-07-05 15:52:12] [config] label-smoothing: 0
[2023-07-05 15:52:12] [config] layer-normalization: false
[2023-07-05 15:52:12] [config] learn-rate: 0.0001
[2023-07-05 15:52:12] [config] lemma-dependency: ""
[2023-07-05 15:52:12] [config] lemma-dim-emb: 0
[2023-07-05 15:52:12] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:52:12] [config] log-level: info
[2023-07-05 15:52:12] [config] log-time-zone: ""
[2023-07-05 15:52:12] [config] logical-epoch:
[2023-07-05 15:52:12] [config]   - 1e
[2023-07-05 15:52:12] [config]   - 0
[2023-07-05 15:52:12] [config] lr-decay: 0
[2023-07-05 15:52:12] [config] lr-decay-freq: 50000
[2023-07-05 15:52:12] [config] lr-decay-inv-sqrt:
[2023-07-05 15:52:12] [config]   - 0
[2023-07-05 15:52:12] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:52:12] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:52:12] [config] lr-decay-start:
[2023-07-05 15:52:12] [config]   - 10
[2023-07-05 15:52:12] [config]   - 1
[2023-07-05 15:52:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:52:12] [config] lr-report: false
[2023-07-05 15:52:12] [config] lr-warmup: 0
[2023-07-05 15:52:12] [config] lr-warmup-at-reload: false
[2023-07-05 15:52:12] [config] lr-warmup-cycle: false
[2023-07-05 15:52:12] [config] lr-warmup-start-rate: 0
[2023-07-05 15:52:12] [config] max-length: 50
[2023-07-05 15:52:12] [config] max-length-crop: false
[2023-07-05 15:52:12] [config] max-length-factor: 3
[2023-07-05 15:52:12] [config] maxi-batch: 100
[2023-07-05 15:52:12] [config] maxi-batch-sort: trg
[2023-07-05 15:52:12] [config] mini-batch: 64
[2023-07-05 15:52:12] [config] mini-batch-fit: false
[2023-07-05 15:52:12] [config] mini-batch-fit-step: 10
[2023-07-05 15:52:12] [config] mini-batch-round-up: true
[2023-07-05 15:52:12] [config] mini-batch-track-lr: false
[2023-07-05 15:52:12] [config] mini-batch-warmup: 0
[2023-07-05 15:52:12] [config] mini-batch-words: 0
[2023-07-05 15:52:12] [config] mini-batch-words-ref: 0
[2023-07-05 15:52:12] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 15:52:12] [config] multi-loss-type: sum
[2023-07-05 15:52:12] [config] n-best: false
[2023-07-05 15:52:12] [config] no-nccl: false
[2023-07-05 15:52:12] [config] no-reload: false
[2023-07-05 15:52:12] [config] no-restore-corpus: false
[2023-07-05 15:52:12] [config] normalize: 0
[2023-07-05 15:52:12] [config] normalize-gradient: false
[2023-07-05 15:52:12] [config] num-devices: 0
[2023-07-05 15:52:12] [config] optimizer: adam
[2023-07-05 15:52:12] [config] optimizer-delay: 1
[2023-07-05 15:52:12] [config] optimizer-params:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] output-omit-bias: false
[2023-07-05 15:52:12] [config] overwrite: true
[2023-07-05 15:52:12] [config] precision:
[2023-07-05 15:52:12] [config]   - float32
[2023-07-05 15:52:12] [config]   - float32
[2023-07-05 15:52:12] [config] pretrained-model: ""
[2023-07-05 15:52:12] [config] quantize-biases: false
[2023-07-05 15:52:12] [config] quantize-bits: 0
[2023-07-05 15:52:12] [config] quantize-log-based: false
[2023-07-05 15:52:12] [config] quantize-optimization-steps: 0
[2023-07-05 15:52:12] [config] quiet: false
[2023-07-05 15:52:12] [config] quiet-translation: true
[2023-07-05 15:52:12] [config] relative-paths: false
[2023-07-05 15:52:12] [config] right-left: false
[2023-07-05 15:52:12] [config] save-freq: 10000u
[2023-07-05 15:52:12] [config] seed: 1234
[2023-07-05 15:52:12] [config] sentencepiece-alphas:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:52:12] [config] sentencepiece-options: ""
[2023-07-05 15:52:12] [config] sharding: global
[2023-07-05 15:52:12] [config] shuffle: data
[2023-07-05 15:52:12] [config] shuffle-in-ram: false
[2023-07-05 15:52:12] [config] sigterm: save-and-exit
[2023-07-05 15:52:12] [config] skip: false
[2023-07-05 15:52:12] [config] sqlite: ""
[2023-07-05 15:52:12] [config] sqlite-drop: false
[2023-07-05 15:52:12] [config] sync-freq: 200u
[2023-07-05 15:52:12] [config] sync-sgd: false
[2023-07-05 15:52:12] [config] tempdir: /tmp
[2023-07-05 15:52:12] [config] tied-embeddings: false
[2023-07-05 15:52:12] [config] tied-embeddings-all: false
[2023-07-05 15:52:12] [config] tied-embeddings-src: false
[2023-07-05 15:52:12] [config] train-embedder-rank:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] train-sets:
[2023-07-05 15:52:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:52:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:52:12] [config] transformer-aan-activation: swish
[2023-07-05 15:52:12] [config] transformer-aan-depth: 2
[2023-07-05 15:52:12] [config] transformer-aan-nogate: false
[2023-07-05 15:52:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:52:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:52:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:52:12] [config] transformer-depth-scaling: false
[2023-07-05 15:52:12] [config] transformer-dim-aan: 2048
[2023-07-05 15:52:12] [config] transformer-dim-ffn: 2048
[2023-07-05 15:52:12] [config] transformer-dropout: 0
[2023-07-05 15:52:12] [config] transformer-dropout-attention: 0
[2023-07-05 15:52:12] [config] transformer-dropout-ffn: 0
[2023-07-05 15:52:12] [config] transformer-ffn-activation: swish
[2023-07-05 15:52:12] [config] transformer-ffn-depth: 2
[2023-07-05 15:52:12] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:52:12] [config] transformer-heads: 8
[2023-07-05 15:52:12] [config] transformer-no-projection: false
[2023-07-05 15:52:12] [config] transformer-pool: false
[2023-07-05 15:52:12] [config] transformer-postprocess: dan
[2023-07-05 15:52:12] [config] transformer-postprocess-emb: d
[2023-07-05 15:52:12] [config] transformer-postprocess-top: ""
[2023-07-05 15:52:12] [config] transformer-preprocess: ""
[2023-07-05 15:52:12] [config] transformer-tied-layers:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] transformer-train-position-embeddings: false
[2023-07-05 15:52:12] [config] tsv: false
[2023-07-05 15:52:12] [config] tsv-fields: 0
[2023-07-05 15:52:12] [config] type: transformer
[2023-07-05 15:52:12] [config] ulr: false
[2023-07-05 15:52:12] [config] ulr-dim-emb: 0
[2023-07-05 15:52:12] [config] ulr-dropout: 0
[2023-07-05 15:52:12] [config] ulr-keys-vectors: ""
[2023-07-05 15:52:12] [config] ulr-query-vectors: ""
[2023-07-05 15:52:12] [config] ulr-softmax-temperature: 1
[2023-07-05 15:52:12] [config] ulr-trainable-transformation: false
[2023-07-05 15:52:12] [config] unlikelihood-loss: false
[2023-07-05 15:52:12] [config] valid-freq: 50000000
[2023-07-05 15:52:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:52:12] [config] valid-max-length: 1000
[2023-07-05 15:52:12] [config] valid-metrics:
[2023-07-05 15:52:12] [config]   - cross-entropy
[2023-07-05 15:52:12] [config]   - translation
[2023-07-05 15:52:12] [config] valid-mini-batch: 32
[2023-07-05 15:52:12] [config] valid-reset-stalled: false
[2023-07-05 15:52:12] [config] valid-script-args:
[2023-07-05 15:52:12] [config]   []
[2023-07-05 15:52:12] [config] valid-script-path: ""
[2023-07-05 15:52:12] [config] valid-sets:
[2023-07-05 15:52:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:52:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:52:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:52:12] [config] vocabs:
[2023-07-05 15:52:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:52:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:52:12] [config] word-penalty: 0
[2023-07-05 15:52:12] [config] word-scores: false
[2023-07-05 15:52:12] [config] workspace: 2048
[2023-07-05 15:52:12] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:52:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:52:12] [training] Using single-device training
[2023-07-05 15:52:12] Synced seed 1234
[2023-07-05 15:52:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:52:12] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:52:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:52:12] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:52:12] [valid] No post-processing script given for validating translator
[2023-07-05 15:52:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:52:13] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 15:52:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 15:52:13] [comm] Using global sharding
[2023-07-05 15:52:13] [comm] NCCLCommunicators constructed successfully
[2023-07-05 15:52:13] [training] Using 1 GPUs
[2023-07-05 15:52:13] Training started
[2023-07-05 15:52:13] [data] Shuffling data
[2023-07-05 15:52:13] [data] Done reading 20,192 sentences
[2023-07-05 15:52:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:52:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 15:52:13] [logits] Applying loss function for 1 factor(s)
[2023-07-05 15:52:13] [memory] Reserving 310 MB, device gpu0
[2023-07-05 15:52:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 15:52:13] [memory] Reserving 310 MB, device gpu0
[2023-07-05 15:52:13] Parameter type float32, optimization type float32, casting types false
[2023-07-05 15:52:13] Allocating memory for Adam-specific shards
[2023-07-05 15:52:13] [memory] Reserving 621 MB, device gpu0
[2023-07-05 15:52:31] Seen 18,843 samples
[2023-07-05 15:52:31] Starting data epoch 2 in logical epoch 2
[2023-07-05 15:52:31] [data] Shuffling data
[2023-07-05 15:52:31] [data] Done reading 20,192 sentences
[2023-07-05 15:52:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:52:53] Seen 18,843 samples
[2023-07-05 15:52:53] Starting data epoch 3 in logical epoch 3
[2023-07-05 15:52:53] [data] Shuffling data
[2023-07-05 15:52:53] [data] Done reading 20,192 sentences
[2023-07-05 15:52:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:53:24] Seen 18,843 samples
[2023-07-05 15:53:24] Starting data epoch 4 in logical epoch 4
[2023-07-05 15:53:24] [data] Shuffling data
[2023-07-05 15:53:24] [data] Done reading 20,192 sentences
[2023-07-05 15:53:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:53:36] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 6.71267176 * 933,288 @ 570 after 933,288 : Time 84.10s : 11097.53 words/s : gNorm 2.6105
[2023-07-05 15:53:55] Seen 18,843 samples
[2023-07-05 15:53:55] Starting data epoch 5 in logical epoch 5
[2023-07-05 15:53:55] [data] Shuffling data
[2023-07-05 15:53:55] [data] Done reading 20,192 sentences
[2023-07-05 15:53:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:54:30] Seen 18,843 samples
[2023-07-05 15:54:30] Starting data epoch 6 in logical epoch 6
[2023-07-05 15:54:30] [data] Shuffling data
[2023-07-05 15:54:30] [data] Done reading 20,192 sentences
[2023-07-05 15:54:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:55:06] Seen 18,843 samples
[2023-07-05 15:55:06] Starting data epoch 7 in logical epoch 7
[2023-07-05 15:55:06] [data] Shuffling data
[2023-07-05 15:55:06] [data] Done reading 20,192 sentences
[2023-07-05 15:55:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:55:32] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 4.08865166 * 926,551 @ 2,125 after 1,859,839 : Time 115.85s : 7998.02 words/s : gNorm 3.0210
[2023-07-05 15:55:41] Seen 18,843 samples
[2023-07-05 15:55:41] Starting data epoch 8 in logical epoch 8
[2023-07-05 15:55:41] [data] Shuffling data
[2023-07-05 15:55:41] [data] Done reading 20,192 sentences
[2023-07-05 15:55:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:56:18] Seen 18,843 samples
[2023-07-05 15:56:18] Starting data epoch 9 in logical epoch 9
[2023-07-05 15:56:18] [data] Shuffling data
[2023-07-05 15:56:18] [data] Done reading 20,192 sentences
[2023-07-05 15:56:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:56:56] Seen 18,843 samples
[2023-07-05 15:56:56] Starting data epoch 10 in logical epoch 10
[2023-07-05 15:56:56] [data] Shuffling data
[2023-07-05 15:56:56] [data] Done reading 20,192 sentences
[2023-07-05 15:56:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 15:57:33] Seen 18,843 samples
[2023-07-05 15:57:33] Starting data epoch 11 in logical epoch 11
[2023-07-05 15:57:33] Training finished
[2023-07-05 15:57:38] [valid] Ep. 11 : Up. 2968 : cross-entropy : 99.3721 : new best
[2023-07-05 15:59:44] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-05 15:59:44] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 15:59:47] Saving Adam parameters
[2023-07-05 15:59:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 15:59:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:59:59] [marian] Running on node22.datos.cluster.uy as process 20377 with command line:
[2023-07-05 15:59:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 15:59:59] [config] after: 0e
[2023-07-05 15:59:59] [config] after-batches: 0
[2023-07-05 15:59:59] [config] after-epochs: 20
[2023-07-05 15:59:59] [config] all-caps-every: 0
[2023-07-05 15:59:59] [config] allow-unk: false
[2023-07-05 15:59:59] [config] authors: false
[2023-07-05 15:59:59] [config] beam-size: 12
[2023-07-05 15:59:59] [config] bert-class-symbol: "[CLS]"
[2023-07-05 15:59:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 15:59:59] [config] bert-masking-fraction: 0.15
[2023-07-05 15:59:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 15:59:59] [config] bert-train-type-embeddings: true
[2023-07-05 15:59:59] [config] bert-type-vocab-size: 2
[2023-07-05 15:59:59] [config] build-info: ""
[2023-07-05 15:59:59] [config] check-gradient-nan: false
[2023-07-05 15:59:59] [config] check-nan: false
[2023-07-05 15:59:59] [config] cite: false
[2023-07-05 15:59:59] [config] clip-norm: 1
[2023-07-05 15:59:59] [config] cost-scaling:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] cost-type: ce-sum
[2023-07-05 15:59:59] [config] cpu-threads: 0
[2023-07-05 15:59:59] [config] data-threads: 8
[2023-07-05 15:59:59] [config] data-weighting: ""
[2023-07-05 15:59:59] [config] data-weighting-type: sentence
[2023-07-05 15:59:59] [config] dec-cell: gru
[2023-07-05 15:59:59] [config] dec-cell-base-depth: 2
[2023-07-05 15:59:59] [config] dec-cell-high-depth: 1
[2023-07-05 15:59:59] [config] dec-depth: 1
[2023-07-05 15:59:59] [config] devices:
[2023-07-05 15:59:59] [config]   - 0
[2023-07-05 15:59:59] [config] dim-emb: 512
[2023-07-05 15:59:59] [config] dim-rnn: 1024
[2023-07-05 15:59:59] [config] dim-vocabs:
[2023-07-05 15:59:59] [config]   - 36507
[2023-07-05 15:59:59] [config]   - 54042
[2023-07-05 15:59:59] [config] disp-first: 0
[2023-07-05 15:59:59] [config] disp-freq: 1000u
[2023-07-05 15:59:59] [config] disp-label-counts: true
[2023-07-05 15:59:59] [config] dropout-rnn: 0
[2023-07-05 15:59:59] [config] dropout-src: 0
[2023-07-05 15:59:59] [config] dropout-trg: 0
[2023-07-05 15:59:59] [config] dump-config: ""
[2023-07-05 15:59:59] [config] dynamic-gradient-scaling:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] early-stopping: 10
[2023-07-05 15:59:59] [config] early-stopping-on: first
[2023-07-05 15:59:59] [config] embedding-fix-src: false
[2023-07-05 15:59:59] [config] embedding-fix-trg: false
[2023-07-05 15:59:59] [config] embedding-normalization: false
[2023-07-05 15:59:59] [config] embedding-vectors:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] enc-cell: gru
[2023-07-05 15:59:59] [config] enc-cell-depth: 1
[2023-07-05 15:59:59] [config] enc-depth: 1
[2023-07-05 15:59:59] [config] enc-type: bidirectional
[2023-07-05 15:59:59] [config] english-title-case-every: 0
[2023-07-05 15:59:59] [config] exponential-smoothing: 0
[2023-07-05 15:59:59] [config] factor-weight: 1
[2023-07-05 15:59:59] [config] factors-combine: sum
[2023-07-05 15:59:59] [config] factors-dim-emb: 0
[2023-07-05 15:59:59] [config] gradient-checkpointing: false
[2023-07-05 15:59:59] [config] gradient-norm-average-window: 100
[2023-07-05 15:59:59] [config] guided-alignment: none
[2023-07-05 15:59:59] [config] guided-alignment-cost: mse
[2023-07-05 15:59:59] [config] guided-alignment-weight: 0.1
[2023-07-05 15:59:59] [config] ignore-model-config: false
[2023-07-05 15:59:59] [config] input-types:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] interpolate-env-vars: false
[2023-07-05 15:59:59] [config] keep-best: false
[2023-07-05 15:59:59] [config] label-smoothing: 0
[2023-07-05 15:59:59] [config] layer-normalization: false
[2023-07-05 15:59:59] [config] learn-rate: 0.0001
[2023-07-05 15:59:59] [config] lemma-dependency: ""
[2023-07-05 15:59:59] [config] lemma-dim-emb: 0
[2023-07-05 15:59:59] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 15:59:59] [config] log-level: info
[2023-07-05 15:59:59] [config] log-time-zone: ""
[2023-07-05 15:59:59] [config] logical-epoch:
[2023-07-05 15:59:59] [config]   - 1e
[2023-07-05 15:59:59] [config]   - 0
[2023-07-05 15:59:59] [config] lr-decay: 0
[2023-07-05 15:59:59] [config] lr-decay-freq: 50000
[2023-07-05 15:59:59] [config] lr-decay-inv-sqrt:
[2023-07-05 15:59:59] [config]   - 0
[2023-07-05 15:59:59] [config] lr-decay-repeat-warmup: false
[2023-07-05 15:59:59] [config] lr-decay-reset-optimizer: false
[2023-07-05 15:59:59] [config] lr-decay-start:
[2023-07-05 15:59:59] [config]   - 10
[2023-07-05 15:59:59] [config]   - 1
[2023-07-05 15:59:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 15:59:59] [config] lr-report: false
[2023-07-05 15:59:59] [config] lr-warmup: 0
[2023-07-05 15:59:59] [config] lr-warmup-at-reload: false
[2023-07-05 15:59:59] [config] lr-warmup-cycle: false
[2023-07-05 15:59:59] [config] lr-warmup-start-rate: 0
[2023-07-05 15:59:59] [config] max-length: 50
[2023-07-05 15:59:59] [config] max-length-crop: false
[2023-07-05 15:59:59] [config] max-length-factor: 3
[2023-07-05 15:59:59] [config] maxi-batch: 100
[2023-07-05 15:59:59] [config] maxi-batch-sort: trg
[2023-07-05 15:59:59] [config] mini-batch: 64
[2023-07-05 15:59:59] [config] mini-batch-fit: false
[2023-07-05 15:59:59] [config] mini-batch-fit-step: 10
[2023-07-05 15:59:59] [config] mini-batch-round-up: true
[2023-07-05 15:59:59] [config] mini-batch-track-lr: false
[2023-07-05 15:59:59] [config] mini-batch-warmup: 0
[2023-07-05 15:59:59] [config] mini-batch-words: 0
[2023-07-05 15:59:59] [config] mini-batch-words-ref: 0
[2023-07-05 15:59:59] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 15:59:59] [config] multi-loss-type: sum
[2023-07-05 15:59:59] [config] n-best: false
[2023-07-05 15:59:59] [config] no-nccl: false
[2023-07-05 15:59:59] [config] no-reload: false
[2023-07-05 15:59:59] [config] no-restore-corpus: false
[2023-07-05 15:59:59] [config] normalize: 0
[2023-07-05 15:59:59] [config] normalize-gradient: false
[2023-07-05 15:59:59] [config] num-devices: 0
[2023-07-05 15:59:59] [config] optimizer: adam
[2023-07-05 15:59:59] [config] optimizer-delay: 1
[2023-07-05 15:59:59] [config] optimizer-params:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] output-omit-bias: false
[2023-07-05 15:59:59] [config] overwrite: true
[2023-07-05 15:59:59] [config] precision:
[2023-07-05 15:59:59] [config]   - float32
[2023-07-05 15:59:59] [config]   - float32
[2023-07-05 15:59:59] [config] pretrained-model: ""
[2023-07-05 15:59:59] [config] quantize-biases: false
[2023-07-05 15:59:59] [config] quantize-bits: 0
[2023-07-05 15:59:59] [config] quantize-log-based: false
[2023-07-05 15:59:59] [config] quantize-optimization-steps: 0
[2023-07-05 15:59:59] [config] quiet: false
[2023-07-05 15:59:59] [config] quiet-translation: true
[2023-07-05 15:59:59] [config] relative-paths: false
[2023-07-05 15:59:59] [config] right-left: false
[2023-07-05 15:59:59] [config] save-freq: 10000u
[2023-07-05 15:59:59] [config] seed: 1234
[2023-07-05 15:59:59] [config] sentencepiece-alphas:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] sentencepiece-max-lines: 2000000
[2023-07-05 15:59:59] [config] sentencepiece-options: ""
[2023-07-05 15:59:59] [config] sharding: global
[2023-07-05 15:59:59] [config] shuffle: data
[2023-07-05 15:59:59] [config] shuffle-in-ram: false
[2023-07-05 15:59:59] [config] sigterm: save-and-exit
[2023-07-05 15:59:59] [config] skip: false
[2023-07-05 15:59:59] [config] sqlite: ""
[2023-07-05 15:59:59] [config] sqlite-drop: false
[2023-07-05 15:59:59] [config] sync-freq: 200u
[2023-07-05 15:59:59] [config] sync-sgd: false
[2023-07-05 15:59:59] [config] tempdir: /tmp
[2023-07-05 15:59:59] [config] tied-embeddings: false
[2023-07-05 15:59:59] [config] tied-embeddings-all: false
[2023-07-05 15:59:59] [config] tied-embeddings-src: false
[2023-07-05 15:59:59] [config] train-embedder-rank:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] train-sets:
[2023-07-05 15:59:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 15:59:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 15:59:59] [config] transformer-aan-activation: swish
[2023-07-05 15:59:59] [config] transformer-aan-depth: 2
[2023-07-05 15:59:59] [config] transformer-aan-nogate: false
[2023-07-05 15:59:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 15:59:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 15:59:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 15:59:59] [config] transformer-depth-scaling: false
[2023-07-05 15:59:59] [config] transformer-dim-aan: 2048
[2023-07-05 15:59:59] [config] transformer-dim-ffn: 2048
[2023-07-05 15:59:59] [config] transformer-dropout: 0
[2023-07-05 15:59:59] [config] transformer-dropout-attention: 0
[2023-07-05 15:59:59] [config] transformer-dropout-ffn: 0
[2023-07-05 15:59:59] [config] transformer-ffn-activation: swish
[2023-07-05 15:59:59] [config] transformer-ffn-depth: 2
[2023-07-05 15:59:59] [config] transformer-guided-alignment-layer: last
[2023-07-05 15:59:59] [config] transformer-heads: 8
[2023-07-05 15:59:59] [config] transformer-no-projection: false
[2023-07-05 15:59:59] [config] transformer-pool: false
[2023-07-05 15:59:59] [config] transformer-postprocess: dan
[2023-07-05 15:59:59] [config] transformer-postprocess-emb: d
[2023-07-05 15:59:59] [config] transformer-postprocess-top: ""
[2023-07-05 15:59:59] [config] transformer-preprocess: ""
[2023-07-05 15:59:59] [config] transformer-tied-layers:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] transformer-train-position-embeddings: false
[2023-07-05 15:59:59] [config] tsv: false
[2023-07-05 15:59:59] [config] tsv-fields: 0
[2023-07-05 15:59:59] [config] type: transformer
[2023-07-05 15:59:59] [config] ulr: false
[2023-07-05 15:59:59] [config] ulr-dim-emb: 0
[2023-07-05 15:59:59] [config] ulr-dropout: 0
[2023-07-05 15:59:59] [config] ulr-keys-vectors: ""
[2023-07-05 15:59:59] [config] ulr-query-vectors: ""
[2023-07-05 15:59:59] [config] ulr-softmax-temperature: 1
[2023-07-05 15:59:59] [config] ulr-trainable-transformation: false
[2023-07-05 15:59:59] [config] unlikelihood-loss: false
[2023-07-05 15:59:59] [config] valid-freq: 50000000
[2023-07-05 15:59:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 15:59:59] [config] valid-max-length: 1000
[2023-07-05 15:59:59] [config] valid-metrics:
[2023-07-05 15:59:59] [config]   - cross-entropy
[2023-07-05 15:59:59] [config]   - translation
[2023-07-05 15:59:59] [config] valid-mini-batch: 32
[2023-07-05 15:59:59] [config] valid-reset-stalled: false
[2023-07-05 15:59:59] [config] valid-script-args:
[2023-07-05 15:59:59] [config]   []
[2023-07-05 15:59:59] [config] valid-script-path: ""
[2023-07-05 15:59:59] [config] valid-sets:
[2023-07-05 15:59:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 15:59:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 15:59:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 15:59:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:59:59] [config] vocabs:
[2023-07-05 15:59:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:59:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:59:59] [config] word-penalty: 0
[2023-07-05 15:59:59] [config] word-scores: false
[2023-07-05 15:59:59] [config] workspace: 2048
[2023-07-05 15:59:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 15:59:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 15:59:59] [training] Using single-device training
[2023-07-05 15:59:59] Synced seed 1234
[2023-07-05 15:59:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 15:59:59] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 15:59:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 15:59:59] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 15:59:59] [valid] No post-processing script given for validating translator
[2023-07-05 16:00:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:00:00] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:00:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:00:00] [comm] Using global sharding
[2023-07-05 16:00:00] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:00:00] [training] Using 1 GPUs
[2023-07-05 16:00:00] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:00:03] Loading Adam parameters
[2023-07-05 16:00:03] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:00:03] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:00:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:00:03] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-05 16:00:03] [data] Shuffling data
[2023-07-05 16:00:03] [data] Done reading 20,192 sentences
[2023-07-05 16:00:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:00:03] Training started
[2023-07-05 16:00:03] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:00:03] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:00:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:00:04] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:00:04] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:00:05] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 2.00367069 * 933,583 @ 1,024 after 2,793,422 : Time 6.02s : 155148.00 words/s : gNorm 2.1932
[2023-07-05 16:00:29] Seen 18,843 samples
[2023-07-05 16:00:29] Starting data epoch 12 in logical epoch 12
[2023-07-05 16:00:29] [data] Shuffling data
[2023-07-05 16:00:29] [data] Done reading 20,192 sentences
[2023-07-05 16:00:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:01:03] Seen 18,843 samples
[2023-07-05 16:01:03] Starting data epoch 13 in logical epoch 13
[2023-07-05 16:01:03] [data] Shuffling data
[2023-07-05 16:01:03] [data] Done reading 20,192 sentences
[2023-07-05 16:01:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:01:39] Seen 18,843 samples
[2023-07-05 16:01:39] Starting data epoch 14 in logical epoch 14
[2023-07-05 16:01:39] [data] Shuffling data
[2023-07-05 16:01:39] [data] Done reading 20,192 sentences
[2023-07-05 16:01:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:01:57] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 0.67871761 * 941,038 @ 1,472 after 3,734,460 : Time 111.43s : 8444.78 words/s : gNorm 1.5290
[2023-07-05 16:02:15] Seen 18,843 samples
[2023-07-05 16:02:15] Starting data epoch 15 in logical epoch 15
[2023-07-05 16:02:15] [data] Shuffling data
[2023-07-05 16:02:15] [data] Done reading 20,192 sentences
[2023-07-05 16:02:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:02:50] Seen 18,843 samples
[2023-07-05 16:02:50] Starting data epoch 16 in logical epoch 16
[2023-07-05 16:02:50] [data] Shuffling data
[2023-07-05 16:02:50] [data] Done reading 20,192 sentences
[2023-07-05 16:02:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:03:23] Seen 18,843 samples
[2023-07-05 16:03:23] Starting data epoch 17 in logical epoch 17
[2023-07-05 16:03:23] [data] Shuffling data
[2023-07-05 16:03:24] [data] Done reading 20,192 sentences
[2023-07-05 16:03:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:03:54] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 0.18621942 * 924,840 @ 832 after 4,659,300 : Time 116.70s : 7925.27 words/s : gNorm 1.1339
[2023-07-05 16:03:58] Seen 18,843 samples
[2023-07-05 16:03:58] Starting data epoch 18 in logical epoch 18
[2023-07-05 16:03:58] [data] Shuffling data
[2023-07-05 16:03:58] [data] Done reading 20,192 sentences
[2023-07-05 16:03:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:04:37] Seen 18,843 samples
[2023-07-05 16:04:37] Starting data epoch 19 in logical epoch 19
[2023-07-05 16:04:37] [data] Shuffling data
[2023-07-05 16:04:37] [data] Done reading 20,192 sentences
[2023-07-05 16:04:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:05:11] Seen 18,843 samples
[2023-07-05 16:05:11] Starting data epoch 20 in logical epoch 20
[2023-07-05 16:05:11] [data] Shuffling data
[2023-07-05 16:05:11] [data] Done reading 20,192 sentences
[2023-07-05 16:05:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:05:48] Seen 18,843 samples
[2023-07-05 16:05:48] Starting data epoch 21 in logical epoch 21
[2023-07-05 16:05:48] Training finished
[2023-07-05 16:05:52] [valid] Ep. 21 : Up. 5933 : cross-entropy : 114.134 : stalled 1 times (last best: 99.3721)
[2023-07-05 16:07:27] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-07-05 16:07:27] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:07:30] Saving Adam parameters
[2023-07-05 16:07:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:07:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:07:43] [marian] Running on node22.datos.cluster.uy as process 27940 with command line:
[2023-07-05 16:07:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 16:07:43] [config] after: 0e
[2023-07-05 16:07:43] [config] after-batches: 0
[2023-07-05 16:07:43] [config] after-epochs: 30
[2023-07-05 16:07:43] [config] all-caps-every: 0
[2023-07-05 16:07:43] [config] allow-unk: false
[2023-07-05 16:07:43] [config] authors: false
[2023-07-05 16:07:43] [config] beam-size: 12
[2023-07-05 16:07:43] [config] bert-class-symbol: "[CLS]"
[2023-07-05 16:07:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 16:07:43] [config] bert-masking-fraction: 0.15
[2023-07-05 16:07:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 16:07:43] [config] bert-train-type-embeddings: true
[2023-07-05 16:07:43] [config] bert-type-vocab-size: 2
[2023-07-05 16:07:43] [config] build-info: ""
[2023-07-05 16:07:43] [config] check-gradient-nan: false
[2023-07-05 16:07:43] [config] check-nan: false
[2023-07-05 16:07:43] [config] cite: false
[2023-07-05 16:07:43] [config] clip-norm: 1
[2023-07-05 16:07:43] [config] cost-scaling:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] cost-type: ce-sum
[2023-07-05 16:07:43] [config] cpu-threads: 0
[2023-07-05 16:07:43] [config] data-threads: 8
[2023-07-05 16:07:43] [config] data-weighting: ""
[2023-07-05 16:07:43] [config] data-weighting-type: sentence
[2023-07-05 16:07:43] [config] dec-cell: gru
[2023-07-05 16:07:43] [config] dec-cell-base-depth: 2
[2023-07-05 16:07:43] [config] dec-cell-high-depth: 1
[2023-07-05 16:07:43] [config] dec-depth: 1
[2023-07-05 16:07:43] [config] devices:
[2023-07-05 16:07:43] [config]   - 0
[2023-07-05 16:07:43] [config] dim-emb: 512
[2023-07-05 16:07:43] [config] dim-rnn: 1024
[2023-07-05 16:07:43] [config] dim-vocabs:
[2023-07-05 16:07:43] [config]   - 36507
[2023-07-05 16:07:43] [config]   - 54042
[2023-07-05 16:07:43] [config] disp-first: 0
[2023-07-05 16:07:43] [config] disp-freq: 1000u
[2023-07-05 16:07:43] [config] disp-label-counts: true
[2023-07-05 16:07:43] [config] dropout-rnn: 0
[2023-07-05 16:07:43] [config] dropout-src: 0
[2023-07-05 16:07:43] [config] dropout-trg: 0
[2023-07-05 16:07:43] [config] dump-config: ""
[2023-07-05 16:07:43] [config] dynamic-gradient-scaling:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] early-stopping: 10
[2023-07-05 16:07:43] [config] early-stopping-on: first
[2023-07-05 16:07:43] [config] embedding-fix-src: false
[2023-07-05 16:07:43] [config] embedding-fix-trg: false
[2023-07-05 16:07:43] [config] embedding-normalization: false
[2023-07-05 16:07:43] [config] embedding-vectors:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] enc-cell: gru
[2023-07-05 16:07:43] [config] enc-cell-depth: 1
[2023-07-05 16:07:43] [config] enc-depth: 1
[2023-07-05 16:07:43] [config] enc-type: bidirectional
[2023-07-05 16:07:43] [config] english-title-case-every: 0
[2023-07-05 16:07:43] [config] exponential-smoothing: 0
[2023-07-05 16:07:43] [config] factor-weight: 1
[2023-07-05 16:07:43] [config] factors-combine: sum
[2023-07-05 16:07:43] [config] factors-dim-emb: 0
[2023-07-05 16:07:43] [config] gradient-checkpointing: false
[2023-07-05 16:07:43] [config] gradient-norm-average-window: 100
[2023-07-05 16:07:43] [config] guided-alignment: none
[2023-07-05 16:07:43] [config] guided-alignment-cost: mse
[2023-07-05 16:07:43] [config] guided-alignment-weight: 0.1
[2023-07-05 16:07:43] [config] ignore-model-config: false
[2023-07-05 16:07:43] [config] input-types:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] interpolate-env-vars: false
[2023-07-05 16:07:43] [config] keep-best: false
[2023-07-05 16:07:43] [config] label-smoothing: 0
[2023-07-05 16:07:43] [config] layer-normalization: false
[2023-07-05 16:07:43] [config] learn-rate: 0.0001
[2023-07-05 16:07:43] [config] lemma-dependency: ""
[2023-07-05 16:07:43] [config] lemma-dim-emb: 0
[2023-07-05 16:07:43] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 16:07:43] [config] log-level: info
[2023-07-05 16:07:43] [config] log-time-zone: ""
[2023-07-05 16:07:43] [config] logical-epoch:
[2023-07-05 16:07:43] [config]   - 1e
[2023-07-05 16:07:43] [config]   - 0
[2023-07-05 16:07:43] [config] lr-decay: 0
[2023-07-05 16:07:43] [config] lr-decay-freq: 50000
[2023-07-05 16:07:43] [config] lr-decay-inv-sqrt:
[2023-07-05 16:07:43] [config]   - 0
[2023-07-05 16:07:43] [config] lr-decay-repeat-warmup: false
[2023-07-05 16:07:43] [config] lr-decay-reset-optimizer: false
[2023-07-05 16:07:43] [config] lr-decay-start:
[2023-07-05 16:07:43] [config]   - 10
[2023-07-05 16:07:43] [config]   - 1
[2023-07-05 16:07:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 16:07:43] [config] lr-report: false
[2023-07-05 16:07:43] [config] lr-warmup: 0
[2023-07-05 16:07:43] [config] lr-warmup-at-reload: false
[2023-07-05 16:07:43] [config] lr-warmup-cycle: false
[2023-07-05 16:07:43] [config] lr-warmup-start-rate: 0
[2023-07-05 16:07:43] [config] max-length: 50
[2023-07-05 16:07:43] [config] max-length-crop: false
[2023-07-05 16:07:43] [config] max-length-factor: 3
[2023-07-05 16:07:43] [config] maxi-batch: 100
[2023-07-05 16:07:43] [config] maxi-batch-sort: trg
[2023-07-05 16:07:43] [config] mini-batch: 64
[2023-07-05 16:07:43] [config] mini-batch-fit: false
[2023-07-05 16:07:43] [config] mini-batch-fit-step: 10
[2023-07-05 16:07:43] [config] mini-batch-round-up: true
[2023-07-05 16:07:43] [config] mini-batch-track-lr: false
[2023-07-05 16:07:43] [config] mini-batch-warmup: 0
[2023-07-05 16:07:43] [config] mini-batch-words: 0
[2023-07-05 16:07:43] [config] mini-batch-words-ref: 0
[2023-07-05 16:07:43] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:07:43] [config] multi-loss-type: sum
[2023-07-05 16:07:43] [config] n-best: false
[2023-07-05 16:07:43] [config] no-nccl: false
[2023-07-05 16:07:43] [config] no-reload: false
[2023-07-05 16:07:43] [config] no-restore-corpus: false
[2023-07-05 16:07:43] [config] normalize: 0
[2023-07-05 16:07:43] [config] normalize-gradient: false
[2023-07-05 16:07:43] [config] num-devices: 0
[2023-07-05 16:07:43] [config] optimizer: adam
[2023-07-05 16:07:43] [config] optimizer-delay: 1
[2023-07-05 16:07:43] [config] optimizer-params:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] output-omit-bias: false
[2023-07-05 16:07:43] [config] overwrite: true
[2023-07-05 16:07:43] [config] precision:
[2023-07-05 16:07:43] [config]   - float32
[2023-07-05 16:07:43] [config]   - float32
[2023-07-05 16:07:43] [config] pretrained-model: ""
[2023-07-05 16:07:43] [config] quantize-biases: false
[2023-07-05 16:07:43] [config] quantize-bits: 0
[2023-07-05 16:07:43] [config] quantize-log-based: false
[2023-07-05 16:07:43] [config] quantize-optimization-steps: 0
[2023-07-05 16:07:43] [config] quiet: false
[2023-07-05 16:07:43] [config] quiet-translation: true
[2023-07-05 16:07:43] [config] relative-paths: false
[2023-07-05 16:07:43] [config] right-left: false
[2023-07-05 16:07:43] [config] save-freq: 10000u
[2023-07-05 16:07:43] [config] seed: 1234
[2023-07-05 16:07:43] [config] sentencepiece-alphas:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] sentencepiece-max-lines: 2000000
[2023-07-05 16:07:43] [config] sentencepiece-options: ""
[2023-07-05 16:07:43] [config] sharding: global
[2023-07-05 16:07:43] [config] shuffle: data
[2023-07-05 16:07:43] [config] shuffle-in-ram: false
[2023-07-05 16:07:43] [config] sigterm: save-and-exit
[2023-07-05 16:07:43] [config] skip: false
[2023-07-05 16:07:43] [config] sqlite: ""
[2023-07-05 16:07:43] [config] sqlite-drop: false
[2023-07-05 16:07:43] [config] sync-freq: 200u
[2023-07-05 16:07:43] [config] sync-sgd: false
[2023-07-05 16:07:43] [config] tempdir: /tmp
[2023-07-05 16:07:43] [config] tied-embeddings: false
[2023-07-05 16:07:43] [config] tied-embeddings-all: false
[2023-07-05 16:07:43] [config] tied-embeddings-src: false
[2023-07-05 16:07:43] [config] train-embedder-rank:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] train-sets:
[2023-07-05 16:07:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 16:07:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 16:07:43] [config] transformer-aan-activation: swish
[2023-07-05 16:07:43] [config] transformer-aan-depth: 2
[2023-07-05 16:07:43] [config] transformer-aan-nogate: false
[2023-07-05 16:07:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 16:07:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 16:07:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 16:07:43] [config] transformer-depth-scaling: false
[2023-07-05 16:07:43] [config] transformer-dim-aan: 2048
[2023-07-05 16:07:43] [config] transformer-dim-ffn: 2048
[2023-07-05 16:07:43] [config] transformer-dropout: 0
[2023-07-05 16:07:43] [config] transformer-dropout-attention: 0
[2023-07-05 16:07:43] [config] transformer-dropout-ffn: 0
[2023-07-05 16:07:43] [config] transformer-ffn-activation: swish
[2023-07-05 16:07:43] [config] transformer-ffn-depth: 2
[2023-07-05 16:07:43] [config] transformer-guided-alignment-layer: last
[2023-07-05 16:07:43] [config] transformer-heads: 8
[2023-07-05 16:07:43] [config] transformer-no-projection: false
[2023-07-05 16:07:43] [config] transformer-pool: false
[2023-07-05 16:07:43] [config] transformer-postprocess: dan
[2023-07-05 16:07:43] [config] transformer-postprocess-emb: d
[2023-07-05 16:07:43] [config] transformer-postprocess-top: ""
[2023-07-05 16:07:43] [config] transformer-preprocess: ""
[2023-07-05 16:07:43] [config] transformer-tied-layers:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] transformer-train-position-embeddings: false
[2023-07-05 16:07:43] [config] tsv: false
[2023-07-05 16:07:43] [config] tsv-fields: 0
[2023-07-05 16:07:43] [config] type: transformer
[2023-07-05 16:07:43] [config] ulr: false
[2023-07-05 16:07:43] [config] ulr-dim-emb: 0
[2023-07-05 16:07:43] [config] ulr-dropout: 0
[2023-07-05 16:07:43] [config] ulr-keys-vectors: ""
[2023-07-05 16:07:43] [config] ulr-query-vectors: ""
[2023-07-05 16:07:43] [config] ulr-softmax-temperature: 1
[2023-07-05 16:07:43] [config] ulr-trainable-transformation: false
[2023-07-05 16:07:43] [config] unlikelihood-loss: false
[2023-07-05 16:07:43] [config] valid-freq: 50000000
[2023-07-05 16:07:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 16:07:43] [config] valid-max-length: 1000
[2023-07-05 16:07:43] [config] valid-metrics:
[2023-07-05 16:07:43] [config]   - cross-entropy
[2023-07-05 16:07:43] [config]   - translation
[2023-07-05 16:07:43] [config] valid-mini-batch: 32
[2023-07-05 16:07:43] [config] valid-reset-stalled: false
[2023-07-05 16:07:43] [config] valid-script-args:
[2023-07-05 16:07:43] [config]   []
[2023-07-05 16:07:43] [config] valid-script-path: ""
[2023-07-05 16:07:43] [config] valid-sets:
[2023-07-05 16:07:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 16:07:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 16:07:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 16:07:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:07:43] [config] vocabs:
[2023-07-05 16:07:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:07:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:07:43] [config] word-penalty: 0
[2023-07-05 16:07:43] [config] word-scores: false
[2023-07-05 16:07:43] [config] workspace: 2048
[2023-07-05 16:07:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:07:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:07:43] [training] Using single-device training
[2023-07-05 16:07:43] Synced seed 1234
[2023-07-05 16:07:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:07:43] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 16:07:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:07:43] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 16:07:43] [valid] No post-processing script given for validating translator
[2023-07-05 16:07:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:07:44] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:07:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:07:44] [comm] Using global sharding
[2023-07-05 16:07:44] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:07:44] [training] Using 1 GPUs
[2023-07-05 16:07:44] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:07:46] Loading Adam parameters
[2023-07-05 16:07:47] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:07:47] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:07:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:07:47] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-07-05 16:07:47] [data] Shuffling data
[2023-07-05 16:07:47] [data] Done reading 20,192 sentences
[2023-07-05 16:07:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:07:47] Training started
[2023-07-05 16:07:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:07:47] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:07:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:07:47] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:07:47] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:07:52] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 0.07494858 * 933,651 @ 832 after 5,592,951 : Time 8.83s : 105735.45 words/s : gNorm 0.9032
[2023-07-05 16:08:13] Seen 18,843 samples
[2023-07-05 16:08:13] Starting data epoch 22 in logical epoch 22
[2023-07-05 16:08:13] [data] Shuffling data
[2023-07-05 16:08:13] [data] Done reading 20,192 sentences
[2023-07-05 16:08:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:08:46] Seen 18,843 samples
[2023-07-05 16:08:46] Starting data epoch 23 in logical epoch 23
[2023-07-05 16:08:46] [data] Shuffling data
[2023-07-05 16:08:47] [data] Done reading 20,192 sentences
[2023-07-05 16:08:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:09:18] Seen 18,843 samples
[2023-07-05 16:09:18] Starting data epoch 24 in logical epoch 24
[2023-07-05 16:09:18] [data] Shuffling data
[2023-07-05 16:09:18] [data] Done reading 20,192 sentences
[2023-07-05 16:09:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:09:41] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 0.04371897 * 930,552 @ 512 after 6,523,503 : Time 109.28s : 8515.11 words/s : gNorm 0.8320
[2023-07-05 16:09:56] Seen 18,843 samples
[2023-07-05 16:09:56] Starting data epoch 25 in logical epoch 25
[2023-07-05 16:09:56] [data] Shuffling data
[2023-07-05 16:09:56] [data] Done reading 20,192 sentences
[2023-07-05 16:09:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:10:29] Seen 18,843 samples
[2023-07-05 16:10:29] Starting data epoch 26 in logical epoch 26
[2023-07-05 16:10:29] [data] Shuffling data
[2023-07-05 16:10:29] [data] Done reading 20,192 sentences
[2023-07-05 16:10:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:11:07] Seen 18,843 samples
[2023-07-05 16:11:07] Starting data epoch 27 in logical epoch 27
[2023-07-05 16:11:07] [data] Shuffling data
[2023-07-05 16:11:07] [data] Done reading 20,192 sentences
[2023-07-05 16:11:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:11:43] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 0.03100414 * 930,047 @ 730 after 7,453,550 : Time 121.61s : 7647.49 words/s : gNorm 0.7079
[2023-07-05 16:11:44] Seen 18,843 samples
[2023-07-05 16:11:44] Starting data epoch 28 in logical epoch 28
[2023-07-05 16:11:44] [data] Shuffling data
[2023-07-05 16:11:44] [data] Done reading 20,192 sentences
[2023-07-05 16:11:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:12:16] Seen 18,843 samples
[2023-07-05 16:12:16] Starting data epoch 29 in logical epoch 29
[2023-07-05 16:12:16] [data] Shuffling data
[2023-07-05 16:12:16] [data] Done reading 20,192 sentences
[2023-07-05 16:12:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:12:51] Seen 18,843 samples
[2023-07-05 16:12:51] Starting data epoch 30 in logical epoch 30
[2023-07-05 16:12:51] [data] Shuffling data
[2023-07-05 16:12:51] [data] Done reading 20,192 sentences
[2023-07-05 16:12:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:13:25] Seen 18,843 samples
[2023-07-05 16:13:25] Starting data epoch 31 in logical epoch 31
[2023-07-05 16:13:25] Training finished
[2023-07-05 16:13:29] [valid] Ep. 31 : Up. 8898 : cross-entropy : 119.998 : stalled 2 times (last best: 99.3721)
[2023-07-05 16:15:18] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-07-05 16:15:18] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:15:22] Saving Adam parameters
[2023-07-05 16:15:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:15:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:15:35] [marian] Running on node22.datos.cluster.uy as process 35637 with command line:
[2023-07-05 16:15:35] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 16:15:35] [config] after: 0e
[2023-07-05 16:15:35] [config] after-batches: 0
[2023-07-05 16:15:35] [config] after-epochs: 40
[2023-07-05 16:15:35] [config] all-caps-every: 0
[2023-07-05 16:15:35] [config] allow-unk: false
[2023-07-05 16:15:35] [config] authors: false
[2023-07-05 16:15:35] [config] beam-size: 12
[2023-07-05 16:15:35] [config] bert-class-symbol: "[CLS]"
[2023-07-05 16:15:35] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 16:15:35] [config] bert-masking-fraction: 0.15
[2023-07-05 16:15:35] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 16:15:35] [config] bert-train-type-embeddings: true
[2023-07-05 16:15:35] [config] bert-type-vocab-size: 2
[2023-07-05 16:15:35] [config] build-info: ""
[2023-07-05 16:15:35] [config] check-gradient-nan: false
[2023-07-05 16:15:35] [config] check-nan: false
[2023-07-05 16:15:35] [config] cite: false
[2023-07-05 16:15:35] [config] clip-norm: 1
[2023-07-05 16:15:35] [config] cost-scaling:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] cost-type: ce-sum
[2023-07-05 16:15:35] [config] cpu-threads: 0
[2023-07-05 16:15:35] [config] data-threads: 8
[2023-07-05 16:15:35] [config] data-weighting: ""
[2023-07-05 16:15:35] [config] data-weighting-type: sentence
[2023-07-05 16:15:35] [config] dec-cell: gru
[2023-07-05 16:15:35] [config] dec-cell-base-depth: 2
[2023-07-05 16:15:35] [config] dec-cell-high-depth: 1
[2023-07-05 16:15:35] [config] dec-depth: 1
[2023-07-05 16:15:35] [config] devices:
[2023-07-05 16:15:35] [config]   - 0
[2023-07-05 16:15:35] [config] dim-emb: 512
[2023-07-05 16:15:35] [config] dim-rnn: 1024
[2023-07-05 16:15:35] [config] dim-vocabs:
[2023-07-05 16:15:35] [config]   - 36507
[2023-07-05 16:15:35] [config]   - 54042
[2023-07-05 16:15:35] [config] disp-first: 0
[2023-07-05 16:15:35] [config] disp-freq: 1000u
[2023-07-05 16:15:35] [config] disp-label-counts: true
[2023-07-05 16:15:35] [config] dropout-rnn: 0
[2023-07-05 16:15:35] [config] dropout-src: 0
[2023-07-05 16:15:35] [config] dropout-trg: 0
[2023-07-05 16:15:35] [config] dump-config: ""
[2023-07-05 16:15:35] [config] dynamic-gradient-scaling:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] early-stopping: 10
[2023-07-05 16:15:35] [config] early-stopping-on: first
[2023-07-05 16:15:35] [config] embedding-fix-src: false
[2023-07-05 16:15:35] [config] embedding-fix-trg: false
[2023-07-05 16:15:35] [config] embedding-normalization: false
[2023-07-05 16:15:35] [config] embedding-vectors:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] enc-cell: gru
[2023-07-05 16:15:35] [config] enc-cell-depth: 1
[2023-07-05 16:15:35] [config] enc-depth: 1
[2023-07-05 16:15:35] [config] enc-type: bidirectional
[2023-07-05 16:15:35] [config] english-title-case-every: 0
[2023-07-05 16:15:35] [config] exponential-smoothing: 0
[2023-07-05 16:15:35] [config] factor-weight: 1
[2023-07-05 16:15:35] [config] factors-combine: sum
[2023-07-05 16:15:35] [config] factors-dim-emb: 0
[2023-07-05 16:15:35] [config] gradient-checkpointing: false
[2023-07-05 16:15:35] [config] gradient-norm-average-window: 100
[2023-07-05 16:15:35] [config] guided-alignment: none
[2023-07-05 16:15:35] [config] guided-alignment-cost: mse
[2023-07-05 16:15:35] [config] guided-alignment-weight: 0.1
[2023-07-05 16:15:35] [config] ignore-model-config: false
[2023-07-05 16:15:35] [config] input-types:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] interpolate-env-vars: false
[2023-07-05 16:15:35] [config] keep-best: false
[2023-07-05 16:15:35] [config] label-smoothing: 0
[2023-07-05 16:15:35] [config] layer-normalization: false
[2023-07-05 16:15:35] [config] learn-rate: 0.0001
[2023-07-05 16:15:35] [config] lemma-dependency: ""
[2023-07-05 16:15:35] [config] lemma-dim-emb: 0
[2023-07-05 16:15:35] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 16:15:35] [config] log-level: info
[2023-07-05 16:15:35] [config] log-time-zone: ""
[2023-07-05 16:15:35] [config] logical-epoch:
[2023-07-05 16:15:35] [config]   - 1e
[2023-07-05 16:15:35] [config]   - 0
[2023-07-05 16:15:35] [config] lr-decay: 0
[2023-07-05 16:15:35] [config] lr-decay-freq: 50000
[2023-07-05 16:15:35] [config] lr-decay-inv-sqrt:
[2023-07-05 16:15:35] [config]   - 0
[2023-07-05 16:15:35] [config] lr-decay-repeat-warmup: false
[2023-07-05 16:15:35] [config] lr-decay-reset-optimizer: false
[2023-07-05 16:15:35] [config] lr-decay-start:
[2023-07-05 16:15:35] [config]   - 10
[2023-07-05 16:15:35] [config]   - 1
[2023-07-05 16:15:35] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 16:15:35] [config] lr-report: false
[2023-07-05 16:15:35] [config] lr-warmup: 0
[2023-07-05 16:15:35] [config] lr-warmup-at-reload: false
[2023-07-05 16:15:35] [config] lr-warmup-cycle: false
[2023-07-05 16:15:35] [config] lr-warmup-start-rate: 0
[2023-07-05 16:15:35] [config] max-length: 50
[2023-07-05 16:15:35] [config] max-length-crop: false
[2023-07-05 16:15:35] [config] max-length-factor: 3
[2023-07-05 16:15:35] [config] maxi-batch: 100
[2023-07-05 16:15:35] [config] maxi-batch-sort: trg
[2023-07-05 16:15:35] [config] mini-batch: 64
[2023-07-05 16:15:35] [config] mini-batch-fit: false
[2023-07-05 16:15:35] [config] mini-batch-fit-step: 10
[2023-07-05 16:15:35] [config] mini-batch-round-up: true
[2023-07-05 16:15:35] [config] mini-batch-track-lr: false
[2023-07-05 16:15:35] [config] mini-batch-warmup: 0
[2023-07-05 16:15:35] [config] mini-batch-words: 0
[2023-07-05 16:15:35] [config] mini-batch-words-ref: 0
[2023-07-05 16:15:35] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:15:35] [config] multi-loss-type: sum
[2023-07-05 16:15:35] [config] n-best: false
[2023-07-05 16:15:35] [config] no-nccl: false
[2023-07-05 16:15:35] [config] no-reload: false
[2023-07-05 16:15:35] [config] no-restore-corpus: false
[2023-07-05 16:15:35] [config] normalize: 0
[2023-07-05 16:15:35] [config] normalize-gradient: false
[2023-07-05 16:15:35] [config] num-devices: 0
[2023-07-05 16:15:35] [config] optimizer: adam
[2023-07-05 16:15:35] [config] optimizer-delay: 1
[2023-07-05 16:15:35] [config] optimizer-params:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] output-omit-bias: false
[2023-07-05 16:15:35] [config] overwrite: true
[2023-07-05 16:15:35] [config] precision:
[2023-07-05 16:15:35] [config]   - float32
[2023-07-05 16:15:35] [config]   - float32
[2023-07-05 16:15:35] [config] pretrained-model: ""
[2023-07-05 16:15:35] [config] quantize-biases: false
[2023-07-05 16:15:35] [config] quantize-bits: 0
[2023-07-05 16:15:35] [config] quantize-log-based: false
[2023-07-05 16:15:35] [config] quantize-optimization-steps: 0
[2023-07-05 16:15:35] [config] quiet: false
[2023-07-05 16:15:35] [config] quiet-translation: true
[2023-07-05 16:15:35] [config] relative-paths: false
[2023-07-05 16:15:35] [config] right-left: false
[2023-07-05 16:15:35] [config] save-freq: 10000u
[2023-07-05 16:15:35] [config] seed: 1234
[2023-07-05 16:15:35] [config] sentencepiece-alphas:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] sentencepiece-max-lines: 2000000
[2023-07-05 16:15:35] [config] sentencepiece-options: ""
[2023-07-05 16:15:35] [config] sharding: global
[2023-07-05 16:15:35] [config] shuffle: data
[2023-07-05 16:15:35] [config] shuffle-in-ram: false
[2023-07-05 16:15:35] [config] sigterm: save-and-exit
[2023-07-05 16:15:35] [config] skip: false
[2023-07-05 16:15:35] [config] sqlite: ""
[2023-07-05 16:15:35] [config] sqlite-drop: false
[2023-07-05 16:15:35] [config] sync-freq: 200u
[2023-07-05 16:15:35] [config] sync-sgd: false
[2023-07-05 16:15:35] [config] tempdir: /tmp
[2023-07-05 16:15:35] [config] tied-embeddings: false
[2023-07-05 16:15:35] [config] tied-embeddings-all: false
[2023-07-05 16:15:35] [config] tied-embeddings-src: false
[2023-07-05 16:15:35] [config] train-embedder-rank:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] train-sets:
[2023-07-05 16:15:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 16:15:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 16:15:35] [config] transformer-aan-activation: swish
[2023-07-05 16:15:35] [config] transformer-aan-depth: 2
[2023-07-05 16:15:35] [config] transformer-aan-nogate: false
[2023-07-05 16:15:35] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 16:15:35] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 16:15:35] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 16:15:35] [config] transformer-depth-scaling: false
[2023-07-05 16:15:35] [config] transformer-dim-aan: 2048
[2023-07-05 16:15:35] [config] transformer-dim-ffn: 2048
[2023-07-05 16:15:35] [config] transformer-dropout: 0
[2023-07-05 16:15:35] [config] transformer-dropout-attention: 0
[2023-07-05 16:15:35] [config] transformer-dropout-ffn: 0
[2023-07-05 16:15:35] [config] transformer-ffn-activation: swish
[2023-07-05 16:15:35] [config] transformer-ffn-depth: 2
[2023-07-05 16:15:35] [config] transformer-guided-alignment-layer: last
[2023-07-05 16:15:35] [config] transformer-heads: 8
[2023-07-05 16:15:35] [config] transformer-no-projection: false
[2023-07-05 16:15:35] [config] transformer-pool: false
[2023-07-05 16:15:35] [config] transformer-postprocess: dan
[2023-07-05 16:15:35] [config] transformer-postprocess-emb: d
[2023-07-05 16:15:35] [config] transformer-postprocess-top: ""
[2023-07-05 16:15:35] [config] transformer-preprocess: ""
[2023-07-05 16:15:35] [config] transformer-tied-layers:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] transformer-train-position-embeddings: false
[2023-07-05 16:15:35] [config] tsv: false
[2023-07-05 16:15:35] [config] tsv-fields: 0
[2023-07-05 16:15:35] [config] type: transformer
[2023-07-05 16:15:35] [config] ulr: false
[2023-07-05 16:15:35] [config] ulr-dim-emb: 0
[2023-07-05 16:15:35] [config] ulr-dropout: 0
[2023-07-05 16:15:35] [config] ulr-keys-vectors: ""
[2023-07-05 16:15:35] [config] ulr-query-vectors: ""
[2023-07-05 16:15:35] [config] ulr-softmax-temperature: 1
[2023-07-05 16:15:35] [config] ulr-trainable-transformation: false
[2023-07-05 16:15:35] [config] unlikelihood-loss: false
[2023-07-05 16:15:35] [config] valid-freq: 50000000
[2023-07-05 16:15:35] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 16:15:35] [config] valid-max-length: 1000
[2023-07-05 16:15:35] [config] valid-metrics:
[2023-07-05 16:15:35] [config]   - cross-entropy
[2023-07-05 16:15:35] [config]   - translation
[2023-07-05 16:15:35] [config] valid-mini-batch: 32
[2023-07-05 16:15:35] [config] valid-reset-stalled: false
[2023-07-05 16:15:35] [config] valid-script-args:
[2023-07-05 16:15:35] [config]   []
[2023-07-05 16:15:35] [config] valid-script-path: ""
[2023-07-05 16:15:35] [config] valid-sets:
[2023-07-05 16:15:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 16:15:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 16:15:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 16:15:35] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:15:35] [config] vocabs:
[2023-07-05 16:15:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:15:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:15:35] [config] word-penalty: 0
[2023-07-05 16:15:35] [config] word-scores: false
[2023-07-05 16:15:35] [config] workspace: 2048
[2023-07-05 16:15:35] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:15:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:15:35] [training] Using single-device training
[2023-07-05 16:15:35] Synced seed 1234
[2023-07-05 16:15:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:15:35] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 16:15:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:15:35] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 16:15:35] [valid] No post-processing script given for validating translator
[2023-07-05 16:15:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:15:36] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:15:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:15:36] [comm] Using global sharding
[2023-07-05 16:15:36] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:15:36] [training] Using 1 GPUs
[2023-07-05 16:15:36] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:15:38] Loading Adam parameters
[2023-07-05 16:15:38] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:15:39] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:15:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:15:39] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-07-05 16:15:39] [data] Shuffling data
[2023-07-05 16:15:39] [data] Done reading 20,192 sentences
[2023-07-05 16:15:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:15:39] Training started
[2023-07-05 16:15:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:15:39] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:15:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:15:39] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:15:39] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:15:46] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 0.02382570 * 931,518 @ 256 after 8,385,068 : Time 10.41s : 89448.28 words/s : gNorm 0.6288
[2023-07-05 16:15:59] Seen 18,843 samples
[2023-07-05 16:15:59] Starting data epoch 32 in logical epoch 32
[2023-07-05 16:15:59] [data] Shuffling data
[2023-07-05 16:15:59] [data] Done reading 20,192 sentences
[2023-07-05 16:15:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:16:26] Seen 18,843 samples
[2023-07-05 16:16:26] Starting data epoch 33 in logical epoch 33
[2023-07-05 16:16:26] [data] Shuffling data
[2023-07-05 16:16:26] [data] Done reading 20,192 sentences
[2023-07-05 16:16:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:17:00] Seen 18,843 samples
[2023-07-05 16:17:00] Starting data epoch 34 in logical epoch 34
[2023-07-05 16:17:00] [data] Shuffling data
[2023-07-05 16:17:00] [data] Done reading 20,192 sentences
[2023-07-05 16:17:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:17:27] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 0.01917423 * 936,399 @ 637 after 9,321,467 : Time 101.55s : 9221.39 words/s : gNorm 0.6123
[2023-07-05 16:17:27] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:17:30] Saving Adam parameters
[2023-07-05 16:17:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:17:45] Seen 18,843 samples
[2023-07-05 16:17:45] Starting data epoch 35 in logical epoch 35
[2023-07-05 16:17:45] [data] Shuffling data
[2023-07-05 16:17:45] [data] Done reading 20,192 sentences
[2023-07-05 16:17:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:18:16] Seen 18,843 samples
[2023-07-05 16:18:16] Starting data epoch 36 in logical epoch 36
[2023-07-05 16:18:16] [data] Shuffling data
[2023-07-05 16:18:16] [data] Done reading 20,192 sentences
[2023-07-05 16:18:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:18:52] Seen 18,843 samples
[2023-07-05 16:18:52] Starting data epoch 37 in logical epoch 37
[2023-07-05 16:18:52] [data] Shuffling data
[2023-07-05 16:18:52] [data] Done reading 20,192 sentences
[2023-07-05 16:18:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:19:28] Seen 18,843 samples
[2023-07-05 16:19:28] Starting data epoch 38 in logical epoch 38
[2023-07-05 16:19:28] [data] Shuffling data
[2023-07-05 16:19:28] [data] Done reading 20,192 sentences
[2023-07-05 16:19:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:19:31] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 0.01694695 * 933,298 @ 960 after 10,254,765 : Time 123.60s : 7550.81 words/s : gNorm 0.5861
[2023-07-05 16:20:06] Seen 18,843 samples
[2023-07-05 16:20:06] Starting data epoch 39 in logical epoch 39
[2023-07-05 16:20:06] [data] Shuffling data
[2023-07-05 16:20:06] [data] Done reading 20,192 sentences
[2023-07-05 16:20:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:20:41] Seen 18,843 samples
[2023-07-05 16:20:41] Starting data epoch 40 in logical epoch 40
[2023-07-05 16:20:41] [data] Shuffling data
[2023-07-05 16:20:41] [data] Done reading 20,192 sentences
[2023-07-05 16:20:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:21:18] Seen 18,843 samples
[2023-07-05 16:21:18] Starting data epoch 41 in logical epoch 41
[2023-07-05 16:21:18] Training finished
[2023-07-05 16:21:23] [valid] Ep. 41 : Up. 11864 : cross-entropy : 128.699 : stalled 3 times (last best: 99.3721)
[2023-07-05 16:22:56] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-07-05 16:22:56] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:23:00] Saving Adam parameters
[2023-07-05 16:23:01] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:23:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:23:11] [marian] Running on node22.datos.cluster.uy as process 2588 with command line:
[2023-07-05 16:23:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 16:23:11] [config] after: 0e
[2023-07-05 16:23:11] [config] after-batches: 0
[2023-07-05 16:23:11] [config] after-epochs: 50
[2023-07-05 16:23:11] [config] all-caps-every: 0
[2023-07-05 16:23:11] [config] allow-unk: false
[2023-07-05 16:23:11] [config] authors: false
[2023-07-05 16:23:11] [config] beam-size: 12
[2023-07-05 16:23:11] [config] bert-class-symbol: "[CLS]"
[2023-07-05 16:23:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 16:23:11] [config] bert-masking-fraction: 0.15
[2023-07-05 16:23:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 16:23:11] [config] bert-train-type-embeddings: true
[2023-07-05 16:23:11] [config] bert-type-vocab-size: 2
[2023-07-05 16:23:11] [config] build-info: ""
[2023-07-05 16:23:11] [config] check-gradient-nan: false
[2023-07-05 16:23:11] [config] check-nan: false
[2023-07-05 16:23:11] [config] cite: false
[2023-07-05 16:23:11] [config] clip-norm: 1
[2023-07-05 16:23:11] [config] cost-scaling:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] cost-type: ce-sum
[2023-07-05 16:23:11] [config] cpu-threads: 0
[2023-07-05 16:23:11] [config] data-threads: 8
[2023-07-05 16:23:11] [config] data-weighting: ""
[2023-07-05 16:23:11] [config] data-weighting-type: sentence
[2023-07-05 16:23:11] [config] dec-cell: gru
[2023-07-05 16:23:11] [config] dec-cell-base-depth: 2
[2023-07-05 16:23:11] [config] dec-cell-high-depth: 1
[2023-07-05 16:23:11] [config] dec-depth: 1
[2023-07-05 16:23:11] [config] devices:
[2023-07-05 16:23:11] [config]   - 0
[2023-07-05 16:23:11] [config] dim-emb: 512
[2023-07-05 16:23:11] [config] dim-rnn: 1024
[2023-07-05 16:23:11] [config] dim-vocabs:
[2023-07-05 16:23:11] [config]   - 36507
[2023-07-05 16:23:11] [config]   - 54042
[2023-07-05 16:23:11] [config] disp-first: 0
[2023-07-05 16:23:11] [config] disp-freq: 1000u
[2023-07-05 16:23:11] [config] disp-label-counts: true
[2023-07-05 16:23:11] [config] dropout-rnn: 0
[2023-07-05 16:23:11] [config] dropout-src: 0
[2023-07-05 16:23:11] [config] dropout-trg: 0
[2023-07-05 16:23:11] [config] dump-config: ""
[2023-07-05 16:23:11] [config] dynamic-gradient-scaling:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] early-stopping: 10
[2023-07-05 16:23:11] [config] early-stopping-on: first
[2023-07-05 16:23:11] [config] embedding-fix-src: false
[2023-07-05 16:23:11] [config] embedding-fix-trg: false
[2023-07-05 16:23:11] [config] embedding-normalization: false
[2023-07-05 16:23:11] [config] embedding-vectors:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] enc-cell: gru
[2023-07-05 16:23:11] [config] enc-cell-depth: 1
[2023-07-05 16:23:11] [config] enc-depth: 1
[2023-07-05 16:23:11] [config] enc-type: bidirectional
[2023-07-05 16:23:11] [config] english-title-case-every: 0
[2023-07-05 16:23:11] [config] exponential-smoothing: 0
[2023-07-05 16:23:11] [config] factor-weight: 1
[2023-07-05 16:23:11] [config] factors-combine: sum
[2023-07-05 16:23:11] [config] factors-dim-emb: 0
[2023-07-05 16:23:11] [config] gradient-checkpointing: false
[2023-07-05 16:23:11] [config] gradient-norm-average-window: 100
[2023-07-05 16:23:11] [config] guided-alignment: none
[2023-07-05 16:23:11] [config] guided-alignment-cost: mse
[2023-07-05 16:23:11] [config] guided-alignment-weight: 0.1
[2023-07-05 16:23:11] [config] ignore-model-config: false
[2023-07-05 16:23:11] [config] input-types:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] interpolate-env-vars: false
[2023-07-05 16:23:11] [config] keep-best: false
[2023-07-05 16:23:11] [config] label-smoothing: 0
[2023-07-05 16:23:11] [config] layer-normalization: false
[2023-07-05 16:23:11] [config] learn-rate: 0.0001
[2023-07-05 16:23:11] [config] lemma-dependency: ""
[2023-07-05 16:23:11] [config] lemma-dim-emb: 0
[2023-07-05 16:23:11] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 16:23:11] [config] log-level: info
[2023-07-05 16:23:11] [config] log-time-zone: ""
[2023-07-05 16:23:11] [config] logical-epoch:
[2023-07-05 16:23:11] [config]   - 1e
[2023-07-05 16:23:11] [config]   - 0
[2023-07-05 16:23:11] [config] lr-decay: 0
[2023-07-05 16:23:11] [config] lr-decay-freq: 50000
[2023-07-05 16:23:11] [config] lr-decay-inv-sqrt:
[2023-07-05 16:23:11] [config]   - 0
[2023-07-05 16:23:11] [config] lr-decay-repeat-warmup: false
[2023-07-05 16:23:11] [config] lr-decay-reset-optimizer: false
[2023-07-05 16:23:11] [config] lr-decay-start:
[2023-07-05 16:23:11] [config]   - 10
[2023-07-05 16:23:11] [config]   - 1
[2023-07-05 16:23:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 16:23:11] [config] lr-report: false
[2023-07-05 16:23:11] [config] lr-warmup: 0
[2023-07-05 16:23:11] [config] lr-warmup-at-reload: false
[2023-07-05 16:23:11] [config] lr-warmup-cycle: false
[2023-07-05 16:23:11] [config] lr-warmup-start-rate: 0
[2023-07-05 16:23:11] [config] max-length: 50
[2023-07-05 16:23:11] [config] max-length-crop: false
[2023-07-05 16:23:11] [config] max-length-factor: 3
[2023-07-05 16:23:11] [config] maxi-batch: 100
[2023-07-05 16:23:11] [config] maxi-batch-sort: trg
[2023-07-05 16:23:11] [config] mini-batch: 64
[2023-07-05 16:23:11] [config] mini-batch-fit: false
[2023-07-05 16:23:11] [config] mini-batch-fit-step: 10
[2023-07-05 16:23:11] [config] mini-batch-round-up: true
[2023-07-05 16:23:11] [config] mini-batch-track-lr: false
[2023-07-05 16:23:11] [config] mini-batch-warmup: 0
[2023-07-05 16:23:11] [config] mini-batch-words: 0
[2023-07-05 16:23:11] [config] mini-batch-words-ref: 0
[2023-07-05 16:23:11] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:23:11] [config] multi-loss-type: sum
[2023-07-05 16:23:11] [config] n-best: false
[2023-07-05 16:23:11] [config] no-nccl: false
[2023-07-05 16:23:11] [config] no-reload: false
[2023-07-05 16:23:11] [config] no-restore-corpus: false
[2023-07-05 16:23:11] [config] normalize: 0
[2023-07-05 16:23:11] [config] normalize-gradient: false
[2023-07-05 16:23:11] [config] num-devices: 0
[2023-07-05 16:23:11] [config] optimizer: adam
[2023-07-05 16:23:11] [config] optimizer-delay: 1
[2023-07-05 16:23:11] [config] optimizer-params:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] output-omit-bias: false
[2023-07-05 16:23:11] [config] overwrite: true
[2023-07-05 16:23:11] [config] precision:
[2023-07-05 16:23:11] [config]   - float32
[2023-07-05 16:23:11] [config]   - float32
[2023-07-05 16:23:11] [config] pretrained-model: ""
[2023-07-05 16:23:11] [config] quantize-biases: false
[2023-07-05 16:23:11] [config] quantize-bits: 0
[2023-07-05 16:23:11] [config] quantize-log-based: false
[2023-07-05 16:23:11] [config] quantize-optimization-steps: 0
[2023-07-05 16:23:11] [config] quiet: false
[2023-07-05 16:23:11] [config] quiet-translation: true
[2023-07-05 16:23:11] [config] relative-paths: false
[2023-07-05 16:23:11] [config] right-left: false
[2023-07-05 16:23:11] [config] save-freq: 10000u
[2023-07-05 16:23:11] [config] seed: 1234
[2023-07-05 16:23:11] [config] sentencepiece-alphas:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] sentencepiece-max-lines: 2000000
[2023-07-05 16:23:11] [config] sentencepiece-options: ""
[2023-07-05 16:23:11] [config] sharding: global
[2023-07-05 16:23:11] [config] shuffle: data
[2023-07-05 16:23:11] [config] shuffle-in-ram: false
[2023-07-05 16:23:11] [config] sigterm: save-and-exit
[2023-07-05 16:23:11] [config] skip: false
[2023-07-05 16:23:11] [config] sqlite: ""
[2023-07-05 16:23:11] [config] sqlite-drop: false
[2023-07-05 16:23:11] [config] sync-freq: 200u
[2023-07-05 16:23:11] [config] sync-sgd: false
[2023-07-05 16:23:11] [config] tempdir: /tmp
[2023-07-05 16:23:11] [config] tied-embeddings: false
[2023-07-05 16:23:11] [config] tied-embeddings-all: false
[2023-07-05 16:23:11] [config] tied-embeddings-src: false
[2023-07-05 16:23:11] [config] train-embedder-rank:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] train-sets:
[2023-07-05 16:23:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 16:23:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 16:23:11] [config] transformer-aan-activation: swish
[2023-07-05 16:23:11] [config] transformer-aan-depth: 2
[2023-07-05 16:23:11] [config] transformer-aan-nogate: false
[2023-07-05 16:23:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 16:23:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 16:23:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 16:23:11] [config] transformer-depth-scaling: false
[2023-07-05 16:23:11] [config] transformer-dim-aan: 2048
[2023-07-05 16:23:11] [config] transformer-dim-ffn: 2048
[2023-07-05 16:23:11] [config] transformer-dropout: 0
[2023-07-05 16:23:11] [config] transformer-dropout-attention: 0
[2023-07-05 16:23:11] [config] transformer-dropout-ffn: 0
[2023-07-05 16:23:11] [config] transformer-ffn-activation: swish
[2023-07-05 16:23:11] [config] transformer-ffn-depth: 2
[2023-07-05 16:23:11] [config] transformer-guided-alignment-layer: last
[2023-07-05 16:23:11] [config] transformer-heads: 8
[2023-07-05 16:23:11] [config] transformer-no-projection: false
[2023-07-05 16:23:11] [config] transformer-pool: false
[2023-07-05 16:23:11] [config] transformer-postprocess: dan
[2023-07-05 16:23:11] [config] transformer-postprocess-emb: d
[2023-07-05 16:23:11] [config] transformer-postprocess-top: ""
[2023-07-05 16:23:11] [config] transformer-preprocess: ""
[2023-07-05 16:23:11] [config] transformer-tied-layers:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] transformer-train-position-embeddings: false
[2023-07-05 16:23:11] [config] tsv: false
[2023-07-05 16:23:11] [config] tsv-fields: 0
[2023-07-05 16:23:11] [config] type: transformer
[2023-07-05 16:23:11] [config] ulr: false
[2023-07-05 16:23:11] [config] ulr-dim-emb: 0
[2023-07-05 16:23:11] [config] ulr-dropout: 0
[2023-07-05 16:23:11] [config] ulr-keys-vectors: ""
[2023-07-05 16:23:11] [config] ulr-query-vectors: ""
[2023-07-05 16:23:11] [config] ulr-softmax-temperature: 1
[2023-07-05 16:23:11] [config] ulr-trainable-transformation: false
[2023-07-05 16:23:11] [config] unlikelihood-loss: false
[2023-07-05 16:23:11] [config] valid-freq: 50000000
[2023-07-05 16:23:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 16:23:11] [config] valid-max-length: 1000
[2023-07-05 16:23:11] [config] valid-metrics:
[2023-07-05 16:23:11] [config]   - cross-entropy
[2023-07-05 16:23:11] [config]   - translation
[2023-07-05 16:23:11] [config] valid-mini-batch: 32
[2023-07-05 16:23:11] [config] valid-reset-stalled: false
[2023-07-05 16:23:11] [config] valid-script-args:
[2023-07-05 16:23:11] [config]   []
[2023-07-05 16:23:11] [config] valid-script-path: ""
[2023-07-05 16:23:11] [config] valid-sets:
[2023-07-05 16:23:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 16:23:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 16:23:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 16:23:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:23:11] [config] vocabs:
[2023-07-05 16:23:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:23:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:23:11] [config] word-penalty: 0
[2023-07-05 16:23:11] [config] word-scores: false
[2023-07-05 16:23:11] [config] workspace: 2048
[2023-07-05 16:23:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:23:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:23:11] [training] Using single-device training
[2023-07-05 16:23:12] Synced seed 1234
[2023-07-05 16:23:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:23:12] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 16:23:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:23:12] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 16:23:12] [valid] No post-processing script given for validating translator
[2023-07-05 16:23:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:23:12] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:23:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:23:12] [comm] Using global sharding
[2023-07-05 16:23:13] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:23:13] [training] Using 1 GPUs
[2023-07-05 16:23:13] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:23:15] Loading Adam parameters
[2023-07-05 16:23:15] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:23:15] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:23:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:23:15] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-07-05 16:23:15] [data] Shuffling data
[2023-07-05 16:23:15] [data] Done reading 20,192 sentences
[2023-07-05 16:23:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:23:15] Training started
[2023-07-05 16:23:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:23:15] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:23:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:23:15] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:23:16] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:23:26] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 0.01399804 * 928,175 @ 688 after 11,182,940 : Time 14.43s : 64340.78 words/s : gNorm 0.5626
[2023-07-05 16:23:41] Seen 18,843 samples
[2023-07-05 16:23:41] Starting data epoch 42 in logical epoch 42
[2023-07-05 16:23:41] [data] Shuffling data
[2023-07-05 16:23:41] [data] Done reading 20,192 sentences
[2023-07-05 16:23:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:24:17] Seen 18,843 samples
[2023-07-05 16:24:17] Starting data epoch 43 in logical epoch 43
[2023-07-05 16:24:17] [data] Shuffling data
[2023-07-05 16:24:17] [data] Done reading 20,192 sentences
[2023-07-05 16:24:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:24:53] Seen 18,843 samples
[2023-07-05 16:24:53] Starting data epoch 44 in logical epoch 44
[2023-07-05 16:24:53] [data] Shuffling data
[2023-07-05 16:24:53] [data] Done reading 20,192 sentences
[2023-07-05 16:24:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:25:20] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 0.01290325 * 929,114 @ 512 after 12,112,054 : Time 113.73s : 8169.37 words/s : gNorm 0.5423
[2023-07-05 16:25:26] Seen 18,843 samples
[2023-07-05 16:25:26] Starting data epoch 45 in logical epoch 45
[2023-07-05 16:25:26] [data] Shuffling data
[2023-07-05 16:25:26] [data] Done reading 20,192 sentences
[2023-07-05 16:25:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:26:02] Seen 18,843 samples
[2023-07-05 16:26:02] Starting data epoch 46 in logical epoch 46
[2023-07-05 16:26:02] [data] Shuffling data
[2023-07-05 16:26:02] [data] Done reading 20,192 sentences
[2023-07-05 16:26:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:26:38] Seen 18,843 samples
[2023-07-05 16:26:38] Starting data epoch 47 in logical epoch 47
[2023-07-05 16:26:38] [data] Shuffling data
[2023-07-05 16:26:38] [data] Done reading 20,192 sentences
[2023-07-05 16:26:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:27:17] Seen 18,843 samples
[2023-07-05 16:27:17] Starting data epoch 48 in logical epoch 48
[2023-07-05 16:27:17] [data] Shuffling data
[2023-07-05 16:27:17] [data] Done reading 20,192 sentences
[2023-07-05 16:27:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:27:24] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 0.01161069 * 936,624 @ 960 after 13,048,678 : Time 124.26s : 7537.59 words/s : gNorm 0.4719
[2023-07-05 16:27:50] Seen 18,843 samples
[2023-07-05 16:27:50] Starting data epoch 49 in logical epoch 49
[2023-07-05 16:27:50] [data] Shuffling data
[2023-07-05 16:27:50] [data] Done reading 20,192 sentences
[2023-07-05 16:27:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:28:26] Seen 18,843 samples
[2023-07-05 16:28:26] Starting data epoch 50 in logical epoch 50
[2023-07-05 16:28:26] [data] Shuffling data
[2023-07-05 16:28:26] [data] Done reading 20,192 sentences
[2023-07-05 16:28:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:29:00] Seen 18,843 samples
[2023-07-05 16:29:00] Starting data epoch 51 in logical epoch 51
[2023-07-05 16:29:00] Training finished
[2023-07-05 16:29:04] [valid] Ep. 51 : Up. 14829 : cross-entropy : 132.434 : stalled 4 times (last best: 99.3721)
[2023-07-05 16:31:06] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-07-05 16:31:06] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:31:09] Saving Adam parameters
[2023-07-05 16:31:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:31:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:31:19] [marian] Running on node22.datos.cluster.uy as process 11020 with command line:
[2023-07-05 16:31:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 16:31:19] [config] after: 0e
[2023-07-05 16:31:19] [config] after-batches: 0
[2023-07-05 16:31:19] [config] after-epochs: 60
[2023-07-05 16:31:19] [config] all-caps-every: 0
[2023-07-05 16:31:19] [config] allow-unk: false
[2023-07-05 16:31:19] [config] authors: false
[2023-07-05 16:31:19] [config] beam-size: 12
[2023-07-05 16:31:19] [config] bert-class-symbol: "[CLS]"
[2023-07-05 16:31:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 16:31:19] [config] bert-masking-fraction: 0.15
[2023-07-05 16:31:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 16:31:19] [config] bert-train-type-embeddings: true
[2023-07-05 16:31:19] [config] bert-type-vocab-size: 2
[2023-07-05 16:31:19] [config] build-info: ""
[2023-07-05 16:31:19] [config] check-gradient-nan: false
[2023-07-05 16:31:19] [config] check-nan: false
[2023-07-05 16:31:19] [config] cite: false
[2023-07-05 16:31:19] [config] clip-norm: 1
[2023-07-05 16:31:19] [config] cost-scaling:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] cost-type: ce-sum
[2023-07-05 16:31:19] [config] cpu-threads: 0
[2023-07-05 16:31:19] [config] data-threads: 8
[2023-07-05 16:31:19] [config] data-weighting: ""
[2023-07-05 16:31:19] [config] data-weighting-type: sentence
[2023-07-05 16:31:19] [config] dec-cell: gru
[2023-07-05 16:31:19] [config] dec-cell-base-depth: 2
[2023-07-05 16:31:19] [config] dec-cell-high-depth: 1
[2023-07-05 16:31:19] [config] dec-depth: 1
[2023-07-05 16:31:19] [config] devices:
[2023-07-05 16:31:19] [config]   - 0
[2023-07-05 16:31:19] [config] dim-emb: 512
[2023-07-05 16:31:19] [config] dim-rnn: 1024
[2023-07-05 16:31:19] [config] dim-vocabs:
[2023-07-05 16:31:19] [config]   - 36507
[2023-07-05 16:31:19] [config]   - 54042
[2023-07-05 16:31:19] [config] disp-first: 0
[2023-07-05 16:31:19] [config] disp-freq: 1000u
[2023-07-05 16:31:19] [config] disp-label-counts: true
[2023-07-05 16:31:19] [config] dropout-rnn: 0
[2023-07-05 16:31:19] [config] dropout-src: 0
[2023-07-05 16:31:19] [config] dropout-trg: 0
[2023-07-05 16:31:19] [config] dump-config: ""
[2023-07-05 16:31:19] [config] dynamic-gradient-scaling:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] early-stopping: 10
[2023-07-05 16:31:19] [config] early-stopping-on: first
[2023-07-05 16:31:19] [config] embedding-fix-src: false
[2023-07-05 16:31:19] [config] embedding-fix-trg: false
[2023-07-05 16:31:19] [config] embedding-normalization: false
[2023-07-05 16:31:19] [config] embedding-vectors:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] enc-cell: gru
[2023-07-05 16:31:19] [config] enc-cell-depth: 1
[2023-07-05 16:31:19] [config] enc-depth: 1
[2023-07-05 16:31:19] [config] enc-type: bidirectional
[2023-07-05 16:31:19] [config] english-title-case-every: 0
[2023-07-05 16:31:19] [config] exponential-smoothing: 0
[2023-07-05 16:31:19] [config] factor-weight: 1
[2023-07-05 16:31:19] [config] factors-combine: sum
[2023-07-05 16:31:19] [config] factors-dim-emb: 0
[2023-07-05 16:31:19] [config] gradient-checkpointing: false
[2023-07-05 16:31:19] [config] gradient-norm-average-window: 100
[2023-07-05 16:31:19] [config] guided-alignment: none
[2023-07-05 16:31:19] [config] guided-alignment-cost: mse
[2023-07-05 16:31:19] [config] guided-alignment-weight: 0.1
[2023-07-05 16:31:19] [config] ignore-model-config: false
[2023-07-05 16:31:19] [config] input-types:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] interpolate-env-vars: false
[2023-07-05 16:31:19] [config] keep-best: false
[2023-07-05 16:31:19] [config] label-smoothing: 0
[2023-07-05 16:31:19] [config] layer-normalization: false
[2023-07-05 16:31:19] [config] learn-rate: 0.0001
[2023-07-05 16:31:19] [config] lemma-dependency: ""
[2023-07-05 16:31:19] [config] lemma-dim-emb: 0
[2023-07-05 16:31:19] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 16:31:19] [config] log-level: info
[2023-07-05 16:31:19] [config] log-time-zone: ""
[2023-07-05 16:31:19] [config] logical-epoch:
[2023-07-05 16:31:19] [config]   - 1e
[2023-07-05 16:31:19] [config]   - 0
[2023-07-05 16:31:19] [config] lr-decay: 0
[2023-07-05 16:31:19] [config] lr-decay-freq: 50000
[2023-07-05 16:31:19] [config] lr-decay-inv-sqrt:
[2023-07-05 16:31:19] [config]   - 0
[2023-07-05 16:31:19] [config] lr-decay-repeat-warmup: false
[2023-07-05 16:31:19] [config] lr-decay-reset-optimizer: false
[2023-07-05 16:31:19] [config] lr-decay-start:
[2023-07-05 16:31:19] [config]   - 10
[2023-07-05 16:31:19] [config]   - 1
[2023-07-05 16:31:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 16:31:19] [config] lr-report: false
[2023-07-05 16:31:19] [config] lr-warmup: 0
[2023-07-05 16:31:19] [config] lr-warmup-at-reload: false
[2023-07-05 16:31:19] [config] lr-warmup-cycle: false
[2023-07-05 16:31:19] [config] lr-warmup-start-rate: 0
[2023-07-05 16:31:19] [config] max-length: 50
[2023-07-05 16:31:19] [config] max-length-crop: false
[2023-07-05 16:31:19] [config] max-length-factor: 3
[2023-07-05 16:31:19] [config] maxi-batch: 100
[2023-07-05 16:31:19] [config] maxi-batch-sort: trg
[2023-07-05 16:31:19] [config] mini-batch: 64
[2023-07-05 16:31:19] [config] mini-batch-fit: false
[2023-07-05 16:31:19] [config] mini-batch-fit-step: 10
[2023-07-05 16:31:19] [config] mini-batch-round-up: true
[2023-07-05 16:31:19] [config] mini-batch-track-lr: false
[2023-07-05 16:31:19] [config] mini-batch-warmup: 0
[2023-07-05 16:31:19] [config] mini-batch-words: 0
[2023-07-05 16:31:19] [config] mini-batch-words-ref: 0
[2023-07-05 16:31:19] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:31:19] [config] multi-loss-type: sum
[2023-07-05 16:31:19] [config] n-best: false
[2023-07-05 16:31:19] [config] no-nccl: false
[2023-07-05 16:31:19] [config] no-reload: false
[2023-07-05 16:31:19] [config] no-restore-corpus: false
[2023-07-05 16:31:19] [config] normalize: 0
[2023-07-05 16:31:19] [config] normalize-gradient: false
[2023-07-05 16:31:19] [config] num-devices: 0
[2023-07-05 16:31:19] [config] optimizer: adam
[2023-07-05 16:31:19] [config] optimizer-delay: 1
[2023-07-05 16:31:19] [config] optimizer-params:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] output-omit-bias: false
[2023-07-05 16:31:19] [config] overwrite: true
[2023-07-05 16:31:19] [config] precision:
[2023-07-05 16:31:19] [config]   - float32
[2023-07-05 16:31:19] [config]   - float32
[2023-07-05 16:31:19] [config] pretrained-model: ""
[2023-07-05 16:31:19] [config] quantize-biases: false
[2023-07-05 16:31:19] [config] quantize-bits: 0
[2023-07-05 16:31:19] [config] quantize-log-based: false
[2023-07-05 16:31:19] [config] quantize-optimization-steps: 0
[2023-07-05 16:31:19] [config] quiet: false
[2023-07-05 16:31:19] [config] quiet-translation: true
[2023-07-05 16:31:19] [config] relative-paths: false
[2023-07-05 16:31:19] [config] right-left: false
[2023-07-05 16:31:19] [config] save-freq: 10000u
[2023-07-05 16:31:19] [config] seed: 1234
[2023-07-05 16:31:19] [config] sentencepiece-alphas:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] sentencepiece-max-lines: 2000000
[2023-07-05 16:31:19] [config] sentencepiece-options: ""
[2023-07-05 16:31:19] [config] sharding: global
[2023-07-05 16:31:19] [config] shuffle: data
[2023-07-05 16:31:19] [config] shuffle-in-ram: false
[2023-07-05 16:31:19] [config] sigterm: save-and-exit
[2023-07-05 16:31:19] [config] skip: false
[2023-07-05 16:31:19] [config] sqlite: ""
[2023-07-05 16:31:19] [config] sqlite-drop: false
[2023-07-05 16:31:19] [config] sync-freq: 200u
[2023-07-05 16:31:19] [config] sync-sgd: false
[2023-07-05 16:31:19] [config] tempdir: /tmp
[2023-07-05 16:31:19] [config] tied-embeddings: false
[2023-07-05 16:31:19] [config] tied-embeddings-all: false
[2023-07-05 16:31:19] [config] tied-embeddings-src: false
[2023-07-05 16:31:19] [config] train-embedder-rank:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] train-sets:
[2023-07-05 16:31:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 16:31:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 16:31:19] [config] transformer-aan-activation: swish
[2023-07-05 16:31:19] [config] transformer-aan-depth: 2
[2023-07-05 16:31:19] [config] transformer-aan-nogate: false
[2023-07-05 16:31:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 16:31:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 16:31:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 16:31:19] [config] transformer-depth-scaling: false
[2023-07-05 16:31:19] [config] transformer-dim-aan: 2048
[2023-07-05 16:31:19] [config] transformer-dim-ffn: 2048
[2023-07-05 16:31:19] [config] transformer-dropout: 0
[2023-07-05 16:31:19] [config] transformer-dropout-attention: 0
[2023-07-05 16:31:19] [config] transformer-dropout-ffn: 0
[2023-07-05 16:31:19] [config] transformer-ffn-activation: swish
[2023-07-05 16:31:19] [config] transformer-ffn-depth: 2
[2023-07-05 16:31:19] [config] transformer-guided-alignment-layer: last
[2023-07-05 16:31:19] [config] transformer-heads: 8
[2023-07-05 16:31:19] [config] transformer-no-projection: false
[2023-07-05 16:31:19] [config] transformer-pool: false
[2023-07-05 16:31:19] [config] transformer-postprocess: dan
[2023-07-05 16:31:19] [config] transformer-postprocess-emb: d
[2023-07-05 16:31:19] [config] transformer-postprocess-top: ""
[2023-07-05 16:31:19] [config] transformer-preprocess: ""
[2023-07-05 16:31:19] [config] transformer-tied-layers:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] transformer-train-position-embeddings: false
[2023-07-05 16:31:19] [config] tsv: false
[2023-07-05 16:31:19] [config] tsv-fields: 0
[2023-07-05 16:31:19] [config] type: transformer
[2023-07-05 16:31:19] [config] ulr: false
[2023-07-05 16:31:19] [config] ulr-dim-emb: 0
[2023-07-05 16:31:19] [config] ulr-dropout: 0
[2023-07-05 16:31:19] [config] ulr-keys-vectors: ""
[2023-07-05 16:31:19] [config] ulr-query-vectors: ""
[2023-07-05 16:31:19] [config] ulr-softmax-temperature: 1
[2023-07-05 16:31:19] [config] ulr-trainable-transformation: false
[2023-07-05 16:31:19] [config] unlikelihood-loss: false
[2023-07-05 16:31:19] [config] valid-freq: 50000000
[2023-07-05 16:31:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 16:31:19] [config] valid-max-length: 1000
[2023-07-05 16:31:19] [config] valid-metrics:
[2023-07-05 16:31:19] [config]   - cross-entropy
[2023-07-05 16:31:19] [config]   - translation
[2023-07-05 16:31:19] [config] valid-mini-batch: 32
[2023-07-05 16:31:19] [config] valid-reset-stalled: false
[2023-07-05 16:31:19] [config] valid-script-args:
[2023-07-05 16:31:19] [config]   []
[2023-07-05 16:31:19] [config] valid-script-path: ""
[2023-07-05 16:31:19] [config] valid-sets:
[2023-07-05 16:31:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 16:31:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 16:31:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 16:31:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:31:19] [config] vocabs:
[2023-07-05 16:31:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:31:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:31:19] [config] word-penalty: 0
[2023-07-05 16:31:19] [config] word-scores: false
[2023-07-05 16:31:19] [config] workspace: 2048
[2023-07-05 16:31:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:31:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:31:19] [training] Using single-device training
[2023-07-05 16:31:20] Synced seed 1234
[2023-07-05 16:31:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:31:20] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 16:31:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:31:20] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 16:31:20] [valid] No post-processing script given for validating translator
[2023-07-05 16:31:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:31:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:31:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:31:21] [comm] Using global sharding
[2023-07-05 16:31:21] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:31:21] [training] Using 1 GPUs
[2023-07-05 16:31:21] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:31:23] Loading Adam parameters
[2023-07-05 16:31:23] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:31:23] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:31:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:31:23] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-07-05 16:31:23] [data] Shuffling data
[2023-07-05 16:31:23] [data] Done reading 20,192 sentences
[2023-07-05 16:31:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:31:23] Training started
[2023-07-05 16:31:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:31:23] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:31:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:31:24] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:31:24] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:31:35] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 0.01003589 * 926,408 @ 428 after 13,975,086 : Time 15.12s : 61256.86 words/s : gNorm 0.4693
[2023-07-05 16:31:43] Seen 18,843 samples
[2023-07-05 16:31:43] Starting data epoch 52 in logical epoch 52
[2023-07-05 16:31:43] [data] Shuffling data
[2023-07-05 16:31:43] [data] Done reading 20,192 sentences
[2023-07-05 16:31:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:32:07] Seen 18,843 samples
[2023-07-05 16:32:07] Starting data epoch 53 in logical epoch 53
[2023-07-05 16:32:07] [data] Shuffling data
[2023-07-05 16:32:07] [data] Done reading 20,192 sentences
[2023-07-05 16:32:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:32:39] Seen 18,843 samples
[2023-07-05 16:32:39] Starting data epoch 54 in logical epoch 54
[2023-07-05 16:32:39] [data] Shuffling data
[2023-07-05 16:32:39] [data] Done reading 20,192 sentences
[2023-07-05 16:32:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:33:10] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 0.01014777 * 932,781 @ 128 after 14,907,867 : Time 95.57s : 9760.32 words/s : gNorm 0.5509
[2023-07-05 16:33:12] Seen 18,843 samples
[2023-07-05 16:33:12] Starting data epoch 55 in logical epoch 55
[2023-07-05 16:33:12] [data] Shuffling data
[2023-07-05 16:33:12] [data] Done reading 20,192 sentences
[2023-07-05 16:33:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:33:45] Seen 18,843 samples
[2023-07-05 16:33:45] Starting data epoch 56 in logical epoch 56
[2023-07-05 16:33:45] [data] Shuffling data
[2023-07-05 16:33:45] [data] Done reading 20,192 sentences
[2023-07-05 16:33:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:34:18] Seen 18,843 samples
[2023-07-05 16:34:18] Starting data epoch 57 in logical epoch 57
[2023-07-05 16:34:18] [data] Shuffling data
[2023-07-05 16:34:18] [data] Done reading 20,192 sentences
[2023-07-05 16:34:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:34:54] Seen 18,843 samples
[2023-07-05 16:34:54] Starting data epoch 58 in logical epoch 58
[2023-07-05 16:34:54] [data] Shuffling data
[2023-07-05 16:34:54] [data] Done reading 20,192 sentences
[2023-07-05 16:34:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:35:05] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 0.00925422 * 935,840 @ 1,399 after 15,843,707 : Time 114.78s : 8153.04 words/s : gNorm 0.4138
[2023-07-05 16:35:28] Seen 18,843 samples
[2023-07-05 16:35:28] Starting data epoch 59 in logical epoch 59
[2023-07-05 16:35:28] [data] Shuffling data
[2023-07-05 16:35:28] [data] Done reading 20,192 sentences
[2023-07-05 16:35:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:36:00] Seen 18,843 samples
[2023-07-05 16:36:00] Starting data epoch 60 in logical epoch 60
[2023-07-05 16:36:00] [data] Shuffling data
[2023-07-05 16:36:00] [data] Done reading 20,192 sentences
[2023-07-05 16:36:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:36:34] Seen 18,843 samples
[2023-07-05 16:36:34] Starting data epoch 61 in logical epoch 61
[2023-07-05 16:36:34] Training finished
[2023-07-05 16:36:37] [valid] Ep. 61 : Up. 17795 : cross-entropy : 138.776 : stalled 5 times (last best: 99.3721)
[2023-07-05 16:38:05] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-07-05 16:38:05] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:38:09] Saving Adam parameters
[2023-07-05 16:38:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:38:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:38:21] [marian] Running on node22.datos.cluster.uy as process 18020 with command line:
[2023-07-05 16:38:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 16:38:21] [config] after: 0e
[2023-07-05 16:38:21] [config] after-batches: 0
[2023-07-05 16:38:21] [config] after-epochs: 70
[2023-07-05 16:38:21] [config] all-caps-every: 0
[2023-07-05 16:38:21] [config] allow-unk: false
[2023-07-05 16:38:21] [config] authors: false
[2023-07-05 16:38:21] [config] beam-size: 12
[2023-07-05 16:38:21] [config] bert-class-symbol: "[CLS]"
[2023-07-05 16:38:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 16:38:21] [config] bert-masking-fraction: 0.15
[2023-07-05 16:38:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 16:38:21] [config] bert-train-type-embeddings: true
[2023-07-05 16:38:21] [config] bert-type-vocab-size: 2
[2023-07-05 16:38:21] [config] build-info: ""
[2023-07-05 16:38:21] [config] check-gradient-nan: false
[2023-07-05 16:38:21] [config] check-nan: false
[2023-07-05 16:38:21] [config] cite: false
[2023-07-05 16:38:21] [config] clip-norm: 1
[2023-07-05 16:38:21] [config] cost-scaling:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] cost-type: ce-sum
[2023-07-05 16:38:21] [config] cpu-threads: 0
[2023-07-05 16:38:21] [config] data-threads: 8
[2023-07-05 16:38:21] [config] data-weighting: ""
[2023-07-05 16:38:21] [config] data-weighting-type: sentence
[2023-07-05 16:38:21] [config] dec-cell: gru
[2023-07-05 16:38:21] [config] dec-cell-base-depth: 2
[2023-07-05 16:38:21] [config] dec-cell-high-depth: 1
[2023-07-05 16:38:21] [config] dec-depth: 1
[2023-07-05 16:38:21] [config] devices:
[2023-07-05 16:38:21] [config]   - 0
[2023-07-05 16:38:21] [config] dim-emb: 512
[2023-07-05 16:38:21] [config] dim-rnn: 1024
[2023-07-05 16:38:21] [config] dim-vocabs:
[2023-07-05 16:38:21] [config]   - 36507
[2023-07-05 16:38:21] [config]   - 54042
[2023-07-05 16:38:21] [config] disp-first: 0
[2023-07-05 16:38:21] [config] disp-freq: 1000u
[2023-07-05 16:38:21] [config] disp-label-counts: true
[2023-07-05 16:38:21] [config] dropout-rnn: 0
[2023-07-05 16:38:21] [config] dropout-src: 0
[2023-07-05 16:38:21] [config] dropout-trg: 0
[2023-07-05 16:38:21] [config] dump-config: ""
[2023-07-05 16:38:21] [config] dynamic-gradient-scaling:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] early-stopping: 10
[2023-07-05 16:38:21] [config] early-stopping-on: first
[2023-07-05 16:38:21] [config] embedding-fix-src: false
[2023-07-05 16:38:21] [config] embedding-fix-trg: false
[2023-07-05 16:38:21] [config] embedding-normalization: false
[2023-07-05 16:38:21] [config] embedding-vectors:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] enc-cell: gru
[2023-07-05 16:38:21] [config] enc-cell-depth: 1
[2023-07-05 16:38:21] [config] enc-depth: 1
[2023-07-05 16:38:21] [config] enc-type: bidirectional
[2023-07-05 16:38:21] [config] english-title-case-every: 0
[2023-07-05 16:38:21] [config] exponential-smoothing: 0
[2023-07-05 16:38:21] [config] factor-weight: 1
[2023-07-05 16:38:21] [config] factors-combine: sum
[2023-07-05 16:38:21] [config] factors-dim-emb: 0
[2023-07-05 16:38:21] [config] gradient-checkpointing: false
[2023-07-05 16:38:21] [config] gradient-norm-average-window: 100
[2023-07-05 16:38:21] [config] guided-alignment: none
[2023-07-05 16:38:21] [config] guided-alignment-cost: mse
[2023-07-05 16:38:21] [config] guided-alignment-weight: 0.1
[2023-07-05 16:38:21] [config] ignore-model-config: false
[2023-07-05 16:38:21] [config] input-types:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] interpolate-env-vars: false
[2023-07-05 16:38:21] [config] keep-best: false
[2023-07-05 16:38:21] [config] label-smoothing: 0
[2023-07-05 16:38:21] [config] layer-normalization: false
[2023-07-05 16:38:21] [config] learn-rate: 0.0001
[2023-07-05 16:38:21] [config] lemma-dependency: ""
[2023-07-05 16:38:21] [config] lemma-dim-emb: 0
[2023-07-05 16:38:21] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 16:38:21] [config] log-level: info
[2023-07-05 16:38:21] [config] log-time-zone: ""
[2023-07-05 16:38:21] [config] logical-epoch:
[2023-07-05 16:38:21] [config]   - 1e
[2023-07-05 16:38:21] [config]   - 0
[2023-07-05 16:38:21] [config] lr-decay: 0
[2023-07-05 16:38:21] [config] lr-decay-freq: 50000
[2023-07-05 16:38:21] [config] lr-decay-inv-sqrt:
[2023-07-05 16:38:21] [config]   - 0
[2023-07-05 16:38:21] [config] lr-decay-repeat-warmup: false
[2023-07-05 16:38:21] [config] lr-decay-reset-optimizer: false
[2023-07-05 16:38:21] [config] lr-decay-start:
[2023-07-05 16:38:21] [config]   - 10
[2023-07-05 16:38:21] [config]   - 1
[2023-07-05 16:38:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 16:38:21] [config] lr-report: false
[2023-07-05 16:38:21] [config] lr-warmup: 0
[2023-07-05 16:38:21] [config] lr-warmup-at-reload: false
[2023-07-05 16:38:21] [config] lr-warmup-cycle: false
[2023-07-05 16:38:21] [config] lr-warmup-start-rate: 0
[2023-07-05 16:38:21] [config] max-length: 50
[2023-07-05 16:38:21] [config] max-length-crop: false
[2023-07-05 16:38:21] [config] max-length-factor: 3
[2023-07-05 16:38:21] [config] maxi-batch: 100
[2023-07-05 16:38:21] [config] maxi-batch-sort: trg
[2023-07-05 16:38:21] [config] mini-batch: 64
[2023-07-05 16:38:21] [config] mini-batch-fit: false
[2023-07-05 16:38:21] [config] mini-batch-fit-step: 10
[2023-07-05 16:38:21] [config] mini-batch-round-up: true
[2023-07-05 16:38:21] [config] mini-batch-track-lr: false
[2023-07-05 16:38:21] [config] mini-batch-warmup: 0
[2023-07-05 16:38:21] [config] mini-batch-words: 0
[2023-07-05 16:38:21] [config] mini-batch-words-ref: 0
[2023-07-05 16:38:21] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:38:21] [config] multi-loss-type: sum
[2023-07-05 16:38:21] [config] n-best: false
[2023-07-05 16:38:21] [config] no-nccl: false
[2023-07-05 16:38:21] [config] no-reload: false
[2023-07-05 16:38:21] [config] no-restore-corpus: false
[2023-07-05 16:38:21] [config] normalize: 0
[2023-07-05 16:38:21] [config] normalize-gradient: false
[2023-07-05 16:38:21] [config] num-devices: 0
[2023-07-05 16:38:21] [config] optimizer: adam
[2023-07-05 16:38:21] [config] optimizer-delay: 1
[2023-07-05 16:38:21] [config] optimizer-params:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] output-omit-bias: false
[2023-07-05 16:38:21] [config] overwrite: true
[2023-07-05 16:38:21] [config] precision:
[2023-07-05 16:38:21] [config]   - float32
[2023-07-05 16:38:21] [config]   - float32
[2023-07-05 16:38:21] [config] pretrained-model: ""
[2023-07-05 16:38:21] [config] quantize-biases: false
[2023-07-05 16:38:21] [config] quantize-bits: 0
[2023-07-05 16:38:21] [config] quantize-log-based: false
[2023-07-05 16:38:21] [config] quantize-optimization-steps: 0
[2023-07-05 16:38:21] [config] quiet: false
[2023-07-05 16:38:21] [config] quiet-translation: true
[2023-07-05 16:38:21] [config] relative-paths: false
[2023-07-05 16:38:21] [config] right-left: false
[2023-07-05 16:38:21] [config] save-freq: 10000u
[2023-07-05 16:38:21] [config] seed: 1234
[2023-07-05 16:38:21] [config] sentencepiece-alphas:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] sentencepiece-max-lines: 2000000
[2023-07-05 16:38:21] [config] sentencepiece-options: ""
[2023-07-05 16:38:21] [config] sharding: global
[2023-07-05 16:38:21] [config] shuffle: data
[2023-07-05 16:38:21] [config] shuffle-in-ram: false
[2023-07-05 16:38:21] [config] sigterm: save-and-exit
[2023-07-05 16:38:21] [config] skip: false
[2023-07-05 16:38:21] [config] sqlite: ""
[2023-07-05 16:38:21] [config] sqlite-drop: false
[2023-07-05 16:38:21] [config] sync-freq: 200u
[2023-07-05 16:38:21] [config] sync-sgd: false
[2023-07-05 16:38:21] [config] tempdir: /tmp
[2023-07-05 16:38:21] [config] tied-embeddings: false
[2023-07-05 16:38:21] [config] tied-embeddings-all: false
[2023-07-05 16:38:21] [config] tied-embeddings-src: false
[2023-07-05 16:38:21] [config] train-embedder-rank:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] train-sets:
[2023-07-05 16:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 16:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 16:38:21] [config] transformer-aan-activation: swish
[2023-07-05 16:38:21] [config] transformer-aan-depth: 2
[2023-07-05 16:38:21] [config] transformer-aan-nogate: false
[2023-07-05 16:38:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 16:38:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 16:38:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 16:38:21] [config] transformer-depth-scaling: false
[2023-07-05 16:38:21] [config] transformer-dim-aan: 2048
[2023-07-05 16:38:21] [config] transformer-dim-ffn: 2048
[2023-07-05 16:38:21] [config] transformer-dropout: 0
[2023-07-05 16:38:21] [config] transformer-dropout-attention: 0
[2023-07-05 16:38:21] [config] transformer-dropout-ffn: 0
[2023-07-05 16:38:21] [config] transformer-ffn-activation: swish
[2023-07-05 16:38:21] [config] transformer-ffn-depth: 2
[2023-07-05 16:38:21] [config] transformer-guided-alignment-layer: last
[2023-07-05 16:38:21] [config] transformer-heads: 8
[2023-07-05 16:38:21] [config] transformer-no-projection: false
[2023-07-05 16:38:21] [config] transformer-pool: false
[2023-07-05 16:38:21] [config] transformer-postprocess: dan
[2023-07-05 16:38:21] [config] transformer-postprocess-emb: d
[2023-07-05 16:38:21] [config] transformer-postprocess-top: ""
[2023-07-05 16:38:21] [config] transformer-preprocess: ""
[2023-07-05 16:38:21] [config] transformer-tied-layers:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] transformer-train-position-embeddings: false
[2023-07-05 16:38:21] [config] tsv: false
[2023-07-05 16:38:21] [config] tsv-fields: 0
[2023-07-05 16:38:21] [config] type: transformer
[2023-07-05 16:38:21] [config] ulr: false
[2023-07-05 16:38:21] [config] ulr-dim-emb: 0
[2023-07-05 16:38:21] [config] ulr-dropout: 0
[2023-07-05 16:38:21] [config] ulr-keys-vectors: ""
[2023-07-05 16:38:21] [config] ulr-query-vectors: ""
[2023-07-05 16:38:21] [config] ulr-softmax-temperature: 1
[2023-07-05 16:38:21] [config] ulr-trainable-transformation: false
[2023-07-05 16:38:21] [config] unlikelihood-loss: false
[2023-07-05 16:38:21] [config] valid-freq: 50000000
[2023-07-05 16:38:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 16:38:21] [config] valid-max-length: 1000
[2023-07-05 16:38:21] [config] valid-metrics:
[2023-07-05 16:38:21] [config]   - cross-entropy
[2023-07-05 16:38:21] [config]   - translation
[2023-07-05 16:38:21] [config] valid-mini-batch: 32
[2023-07-05 16:38:21] [config] valid-reset-stalled: false
[2023-07-05 16:38:21] [config] valid-script-args:
[2023-07-05 16:38:21] [config]   []
[2023-07-05 16:38:21] [config] valid-script-path: ""
[2023-07-05 16:38:21] [config] valid-sets:
[2023-07-05 16:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 16:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 16:38:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 16:38:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:38:21] [config] vocabs:
[2023-07-05 16:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:38:21] [config] word-penalty: 0
[2023-07-05 16:38:21] [config] word-scores: false
[2023-07-05 16:38:21] [config] workspace: 2048
[2023-07-05 16:38:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:38:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:38:21] [training] Using single-device training
[2023-07-05 16:38:21] Synced seed 1234
[2023-07-05 16:38:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:38:21] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 16:38:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:38:21] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 16:38:21] [valid] No post-processing script given for validating translator
[2023-07-05 16:38:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:38:22] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:38:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:38:22] [comm] Using global sharding
[2023-07-05 16:38:22] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:38:22] [training] Using 1 GPUs
[2023-07-05 16:38:22] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:38:24] Loading Adam parameters
[2023-07-05 16:38:25] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:38:25] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:38:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:38:25] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-07-05 16:38:25] [data] Shuffling data
[2023-07-05 16:38:25] [data] Done reading 20,192 sentences
[2023-07-05 16:38:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:38:25] Training started
[2023-07-05 16:38:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:38:25] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:38:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:38:25] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:38:25] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:38:40] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 0.00845946 * 927,911 @ 960 after 16,771,618 : Time 18.57s : 49962.66 words/s : gNorm 0.4025
[2023-07-05 16:38:49] Seen 18,843 samples
[2023-07-05 16:38:49] Starting data epoch 62 in logical epoch 62
[2023-07-05 16:38:49] [data] Shuffling data
[2023-07-05 16:38:49] [data] Done reading 20,192 sentences
[2023-07-05 16:38:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:39:22] Seen 18,843 samples
[2023-07-05 16:39:22] Starting data epoch 63 in logical epoch 63
[2023-07-05 16:39:22] [data] Shuffling data
[2023-07-05 16:39:22] [data] Done reading 20,192 sentences
[2023-07-05 16:39:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:39:58] Seen 18,843 samples
[2023-07-05 16:39:58] Starting data epoch 64 in logical epoch 64
[2023-07-05 16:39:58] [data] Shuffling data
[2023-07-05 16:39:58] [data] Done reading 20,192 sentences
[2023-07-05 16:39:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:40:31] Seen 18,843 samples
[2023-07-05 16:40:31] Starting data epoch 65 in logical epoch 65
[2023-07-05 16:40:31] [data] Shuffling data
[2023-07-05 16:40:31] [data] Done reading 20,192 sentences
[2023-07-05 16:40:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:40:33] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 0.00771709 * 929,328 @ 384 after 17,700,946 : Time 112.91s : 8230.47 words/s : gNorm 0.4308
[2023-07-05 16:41:05] Seen 18,843 samples
[2023-07-05 16:41:05] Starting data epoch 66 in logical epoch 66
[2023-07-05 16:41:05] [data] Shuffling data
[2023-07-05 16:41:05] [data] Done reading 20,192 sentences
[2023-07-05 16:41:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:41:41] Seen 18,843 samples
[2023-07-05 16:41:41] Starting data epoch 67 in logical epoch 67
[2023-07-05 16:41:41] [data] Shuffling data
[2023-07-05 16:41:41] [data] Done reading 20,192 sentences
[2023-07-05 16:41:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:42:17] Seen 18,843 samples
[2023-07-05 16:42:17] Starting data epoch 68 in logical epoch 68
[2023-07-05 16:42:17] [data] Shuffling data
[2023-07-05 16:42:17] [data] Done reading 20,192 sentences
[2023-07-05 16:42:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:42:34] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 0.00780816 * 941,249 @ 1,088 after 18,642,195 : Time 121.11s : 7771.65 words/s : gNorm 0.3748
[2023-07-05 16:42:34] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:42:37] Saving Adam parameters
[2023-07-05 16:42:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:43:01] Seen 18,843 samples
[2023-07-05 16:43:01] Starting data epoch 69 in logical epoch 69
[2023-07-05 16:43:01] [data] Shuffling data
[2023-07-05 16:43:01] [data] Done reading 20,192 sentences
[2023-07-05 16:43:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:43:32] Seen 18,843 samples
[2023-07-05 16:43:32] Starting data epoch 70 in logical epoch 70
[2023-07-05 16:43:32] [data] Shuffling data
[2023-07-05 16:43:32] [data] Done reading 20,192 sentences
[2023-07-05 16:43:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:44:08] Seen 18,843 samples
[2023-07-05 16:44:08] Starting data epoch 71 in logical epoch 71
[2023-07-05 16:44:08] Training finished
[2023-07-05 16:44:13] [valid] Ep. 71 : Up. 20760 : cross-entropy : 135.557 : stalled 6 times (last best: 99.3721)
[2023-07-05 16:46:10] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-07-05 16:46:10] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:46:13] Saving Adam parameters
[2023-07-05 16:46:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:46:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:46:24] [marian] Running on node22.datos.cluster.uy as process 25379 with command line:
[2023-07-05 16:46:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 16:46:24] [config] after: 0e
[2023-07-05 16:46:24] [config] after-batches: 0
[2023-07-05 16:46:24] [config] after-epochs: 80
[2023-07-05 16:46:24] [config] all-caps-every: 0
[2023-07-05 16:46:24] [config] allow-unk: false
[2023-07-05 16:46:24] [config] authors: false
[2023-07-05 16:46:24] [config] beam-size: 12
[2023-07-05 16:46:24] [config] bert-class-symbol: "[CLS]"
[2023-07-05 16:46:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 16:46:24] [config] bert-masking-fraction: 0.15
[2023-07-05 16:46:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 16:46:24] [config] bert-train-type-embeddings: true
[2023-07-05 16:46:24] [config] bert-type-vocab-size: 2
[2023-07-05 16:46:24] [config] build-info: ""
[2023-07-05 16:46:24] [config] check-gradient-nan: false
[2023-07-05 16:46:24] [config] check-nan: false
[2023-07-05 16:46:24] [config] cite: false
[2023-07-05 16:46:24] [config] clip-norm: 1
[2023-07-05 16:46:24] [config] cost-scaling:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] cost-type: ce-sum
[2023-07-05 16:46:24] [config] cpu-threads: 0
[2023-07-05 16:46:24] [config] data-threads: 8
[2023-07-05 16:46:24] [config] data-weighting: ""
[2023-07-05 16:46:24] [config] data-weighting-type: sentence
[2023-07-05 16:46:24] [config] dec-cell: gru
[2023-07-05 16:46:24] [config] dec-cell-base-depth: 2
[2023-07-05 16:46:24] [config] dec-cell-high-depth: 1
[2023-07-05 16:46:24] [config] dec-depth: 1
[2023-07-05 16:46:24] [config] devices:
[2023-07-05 16:46:24] [config]   - 0
[2023-07-05 16:46:24] [config] dim-emb: 512
[2023-07-05 16:46:24] [config] dim-rnn: 1024
[2023-07-05 16:46:24] [config] dim-vocabs:
[2023-07-05 16:46:24] [config]   - 36507
[2023-07-05 16:46:24] [config]   - 54042
[2023-07-05 16:46:24] [config] disp-first: 0
[2023-07-05 16:46:24] [config] disp-freq: 1000u
[2023-07-05 16:46:24] [config] disp-label-counts: true
[2023-07-05 16:46:24] [config] dropout-rnn: 0
[2023-07-05 16:46:24] [config] dropout-src: 0
[2023-07-05 16:46:24] [config] dropout-trg: 0
[2023-07-05 16:46:24] [config] dump-config: ""
[2023-07-05 16:46:24] [config] dynamic-gradient-scaling:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] early-stopping: 10
[2023-07-05 16:46:24] [config] early-stopping-on: first
[2023-07-05 16:46:24] [config] embedding-fix-src: false
[2023-07-05 16:46:24] [config] embedding-fix-trg: false
[2023-07-05 16:46:24] [config] embedding-normalization: false
[2023-07-05 16:46:24] [config] embedding-vectors:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] enc-cell: gru
[2023-07-05 16:46:24] [config] enc-cell-depth: 1
[2023-07-05 16:46:24] [config] enc-depth: 1
[2023-07-05 16:46:24] [config] enc-type: bidirectional
[2023-07-05 16:46:24] [config] english-title-case-every: 0
[2023-07-05 16:46:24] [config] exponential-smoothing: 0
[2023-07-05 16:46:24] [config] factor-weight: 1
[2023-07-05 16:46:24] [config] factors-combine: sum
[2023-07-05 16:46:24] [config] factors-dim-emb: 0
[2023-07-05 16:46:24] [config] gradient-checkpointing: false
[2023-07-05 16:46:24] [config] gradient-norm-average-window: 100
[2023-07-05 16:46:24] [config] guided-alignment: none
[2023-07-05 16:46:24] [config] guided-alignment-cost: mse
[2023-07-05 16:46:24] [config] guided-alignment-weight: 0.1
[2023-07-05 16:46:24] [config] ignore-model-config: false
[2023-07-05 16:46:24] [config] input-types:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] interpolate-env-vars: false
[2023-07-05 16:46:24] [config] keep-best: false
[2023-07-05 16:46:24] [config] label-smoothing: 0
[2023-07-05 16:46:24] [config] layer-normalization: false
[2023-07-05 16:46:24] [config] learn-rate: 0.0001
[2023-07-05 16:46:24] [config] lemma-dependency: ""
[2023-07-05 16:46:24] [config] lemma-dim-emb: 0
[2023-07-05 16:46:24] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 16:46:24] [config] log-level: info
[2023-07-05 16:46:24] [config] log-time-zone: ""
[2023-07-05 16:46:24] [config] logical-epoch:
[2023-07-05 16:46:24] [config]   - 1e
[2023-07-05 16:46:24] [config]   - 0
[2023-07-05 16:46:24] [config] lr-decay: 0
[2023-07-05 16:46:24] [config] lr-decay-freq: 50000
[2023-07-05 16:46:24] [config] lr-decay-inv-sqrt:
[2023-07-05 16:46:24] [config]   - 0
[2023-07-05 16:46:24] [config] lr-decay-repeat-warmup: false
[2023-07-05 16:46:24] [config] lr-decay-reset-optimizer: false
[2023-07-05 16:46:24] [config] lr-decay-start:
[2023-07-05 16:46:24] [config]   - 10
[2023-07-05 16:46:24] [config]   - 1
[2023-07-05 16:46:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 16:46:24] [config] lr-report: false
[2023-07-05 16:46:24] [config] lr-warmup: 0
[2023-07-05 16:46:24] [config] lr-warmup-at-reload: false
[2023-07-05 16:46:24] [config] lr-warmup-cycle: false
[2023-07-05 16:46:24] [config] lr-warmup-start-rate: 0
[2023-07-05 16:46:24] [config] max-length: 50
[2023-07-05 16:46:24] [config] max-length-crop: false
[2023-07-05 16:46:24] [config] max-length-factor: 3
[2023-07-05 16:46:24] [config] maxi-batch: 100
[2023-07-05 16:46:24] [config] maxi-batch-sort: trg
[2023-07-05 16:46:24] [config] mini-batch: 64
[2023-07-05 16:46:24] [config] mini-batch-fit: false
[2023-07-05 16:46:24] [config] mini-batch-fit-step: 10
[2023-07-05 16:46:24] [config] mini-batch-round-up: true
[2023-07-05 16:46:24] [config] mini-batch-track-lr: false
[2023-07-05 16:46:24] [config] mini-batch-warmup: 0
[2023-07-05 16:46:24] [config] mini-batch-words: 0
[2023-07-05 16:46:24] [config] mini-batch-words-ref: 0
[2023-07-05 16:46:24] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:46:24] [config] multi-loss-type: sum
[2023-07-05 16:46:24] [config] n-best: false
[2023-07-05 16:46:24] [config] no-nccl: false
[2023-07-05 16:46:24] [config] no-reload: false
[2023-07-05 16:46:24] [config] no-restore-corpus: false
[2023-07-05 16:46:24] [config] normalize: 0
[2023-07-05 16:46:24] [config] normalize-gradient: false
[2023-07-05 16:46:24] [config] num-devices: 0
[2023-07-05 16:46:24] [config] optimizer: adam
[2023-07-05 16:46:24] [config] optimizer-delay: 1
[2023-07-05 16:46:24] [config] optimizer-params:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] output-omit-bias: false
[2023-07-05 16:46:24] [config] overwrite: true
[2023-07-05 16:46:24] [config] precision:
[2023-07-05 16:46:24] [config]   - float32
[2023-07-05 16:46:24] [config]   - float32
[2023-07-05 16:46:24] [config] pretrained-model: ""
[2023-07-05 16:46:24] [config] quantize-biases: false
[2023-07-05 16:46:24] [config] quantize-bits: 0
[2023-07-05 16:46:24] [config] quantize-log-based: false
[2023-07-05 16:46:24] [config] quantize-optimization-steps: 0
[2023-07-05 16:46:24] [config] quiet: false
[2023-07-05 16:46:24] [config] quiet-translation: true
[2023-07-05 16:46:24] [config] relative-paths: false
[2023-07-05 16:46:24] [config] right-left: false
[2023-07-05 16:46:24] [config] save-freq: 10000u
[2023-07-05 16:46:24] [config] seed: 1234
[2023-07-05 16:46:24] [config] sentencepiece-alphas:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] sentencepiece-max-lines: 2000000
[2023-07-05 16:46:24] [config] sentencepiece-options: ""
[2023-07-05 16:46:24] [config] sharding: global
[2023-07-05 16:46:24] [config] shuffle: data
[2023-07-05 16:46:24] [config] shuffle-in-ram: false
[2023-07-05 16:46:24] [config] sigterm: save-and-exit
[2023-07-05 16:46:24] [config] skip: false
[2023-07-05 16:46:24] [config] sqlite: ""
[2023-07-05 16:46:24] [config] sqlite-drop: false
[2023-07-05 16:46:24] [config] sync-freq: 200u
[2023-07-05 16:46:24] [config] sync-sgd: false
[2023-07-05 16:46:24] [config] tempdir: /tmp
[2023-07-05 16:46:24] [config] tied-embeddings: false
[2023-07-05 16:46:24] [config] tied-embeddings-all: false
[2023-07-05 16:46:24] [config] tied-embeddings-src: false
[2023-07-05 16:46:24] [config] train-embedder-rank:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] train-sets:
[2023-07-05 16:46:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 16:46:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 16:46:24] [config] transformer-aan-activation: swish
[2023-07-05 16:46:24] [config] transformer-aan-depth: 2
[2023-07-05 16:46:24] [config] transformer-aan-nogate: false
[2023-07-05 16:46:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 16:46:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 16:46:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 16:46:24] [config] transformer-depth-scaling: false
[2023-07-05 16:46:24] [config] transformer-dim-aan: 2048
[2023-07-05 16:46:24] [config] transformer-dim-ffn: 2048
[2023-07-05 16:46:24] [config] transformer-dropout: 0
[2023-07-05 16:46:24] [config] transformer-dropout-attention: 0
[2023-07-05 16:46:24] [config] transformer-dropout-ffn: 0
[2023-07-05 16:46:24] [config] transformer-ffn-activation: swish
[2023-07-05 16:46:24] [config] transformer-ffn-depth: 2
[2023-07-05 16:46:24] [config] transformer-guided-alignment-layer: last
[2023-07-05 16:46:24] [config] transformer-heads: 8
[2023-07-05 16:46:24] [config] transformer-no-projection: false
[2023-07-05 16:46:24] [config] transformer-pool: false
[2023-07-05 16:46:24] [config] transformer-postprocess: dan
[2023-07-05 16:46:24] [config] transformer-postprocess-emb: d
[2023-07-05 16:46:24] [config] transformer-postprocess-top: ""
[2023-07-05 16:46:24] [config] transformer-preprocess: ""
[2023-07-05 16:46:24] [config] transformer-tied-layers:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] transformer-train-position-embeddings: false
[2023-07-05 16:46:24] [config] tsv: false
[2023-07-05 16:46:24] [config] tsv-fields: 0
[2023-07-05 16:46:24] [config] type: transformer
[2023-07-05 16:46:24] [config] ulr: false
[2023-07-05 16:46:24] [config] ulr-dim-emb: 0
[2023-07-05 16:46:24] [config] ulr-dropout: 0
[2023-07-05 16:46:24] [config] ulr-keys-vectors: ""
[2023-07-05 16:46:24] [config] ulr-query-vectors: ""
[2023-07-05 16:46:24] [config] ulr-softmax-temperature: 1
[2023-07-05 16:46:24] [config] ulr-trainable-transformation: false
[2023-07-05 16:46:24] [config] unlikelihood-loss: false
[2023-07-05 16:46:24] [config] valid-freq: 50000000
[2023-07-05 16:46:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 16:46:24] [config] valid-max-length: 1000
[2023-07-05 16:46:24] [config] valid-metrics:
[2023-07-05 16:46:24] [config]   - cross-entropy
[2023-07-05 16:46:24] [config]   - translation
[2023-07-05 16:46:24] [config] valid-mini-batch: 32
[2023-07-05 16:46:24] [config] valid-reset-stalled: false
[2023-07-05 16:46:24] [config] valid-script-args:
[2023-07-05 16:46:24] [config]   []
[2023-07-05 16:46:24] [config] valid-script-path: ""
[2023-07-05 16:46:24] [config] valid-sets:
[2023-07-05 16:46:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 16:46:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 16:46:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 16:46:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:46:24] [config] vocabs:
[2023-07-05 16:46:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:46:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:46:24] [config] word-penalty: 0
[2023-07-05 16:46:24] [config] word-scores: false
[2023-07-05 16:46:24] [config] workspace: 2048
[2023-07-05 16:46:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:46:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:46:24] [training] Using single-device training
[2023-07-05 16:46:25] Synced seed 1234
[2023-07-05 16:46:25] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:46:25] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 16:46:25] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:46:25] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 16:46:25] [valid] No post-processing script given for validating translator
[2023-07-05 16:46:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:46:25] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:46:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:46:26] [comm] Using global sharding
[2023-07-05 16:46:26] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:46:26] [training] Using 1 GPUs
[2023-07-05 16:46:26] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:46:28] Loading Adam parameters
[2023-07-05 16:46:28] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:46:28] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:46:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:46:28] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-07-05 16:46:28] [data] Shuffling data
[2023-07-05 16:46:28] [data] Done reading 20,192 sentences
[2023-07-05 16:46:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:46:28] Training started
[2023-07-05 16:46:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:46:28] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:46:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:46:29] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:46:29] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:46:48] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.00770911 * 923,944 @ 1,048 after 19,566,139 : Time 23.77s : 38877.09 words/s : gNorm 0.5171
[2023-07-05 16:46:55] Seen 18,843 samples
[2023-07-05 16:46:55] Starting data epoch 72 in logical epoch 72
[2023-07-05 16:46:55] [data] Shuffling data
[2023-07-05 16:46:55] [data] Done reading 20,192 sentences
[2023-07-05 16:46:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:47:30] Seen 18,843 samples
[2023-07-05 16:47:30] Starting data epoch 73 in logical epoch 73
[2023-07-05 16:47:30] [data] Shuffling data
[2023-07-05 16:47:30] [data] Done reading 20,192 sentences
[2023-07-05 16:47:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:48:04] Seen 18,843 samples
[2023-07-05 16:48:04] Starting data epoch 74 in logical epoch 74
[2023-07-05 16:48:04] [data] Shuffling data
[2023-07-05 16:48:04] [data] Done reading 20,192 sentences
[2023-07-05 16:48:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:48:40] Seen 18,843 samples
[2023-07-05 16:48:40] Starting data epoch 75 in logical epoch 75
[2023-07-05 16:48:40] [data] Shuffling data
[2023-07-05 16:48:40] [data] Done reading 20,192 sentences
[2023-07-05 16:48:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:48:47] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.00685920 * 934,356 @ 1,902 after 20,500,495 : Time 118.86s : 7861.05 words/s : gNorm 0.3481
[2023-07-05 16:49:16] Seen 18,843 samples
[2023-07-05 16:49:16] Starting data epoch 76 in logical epoch 76
[2023-07-05 16:49:16] [data] Shuffling data
[2023-07-05 16:49:16] [data] Done reading 20,192 sentences
[2023-07-05 16:49:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:49:49] Seen 18,843 samples
[2023-07-05 16:49:49] Starting data epoch 77 in logical epoch 77
[2023-07-05 16:49:49] [data] Shuffling data
[2023-07-05 16:49:50] [data] Done reading 20,192 sentences
[2023-07-05 16:49:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:50:24] Seen 18,843 samples
[2023-07-05 16:50:24] Starting data epoch 78 in logical epoch 78
[2023-07-05 16:50:24] [data] Shuffling data
[2023-07-05 16:50:24] [data] Done reading 20,192 sentences
[2023-07-05 16:50:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:50:43] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.00666180 * 931,815 @ 407 after 21,432,310 : Time 115.84s : 8044.11 words/s : gNorm 0.3748
[2023-07-05 16:50:59] Seen 18,843 samples
[2023-07-05 16:50:59] Starting data epoch 79 in logical epoch 79
[2023-07-05 16:50:59] [data] Shuffling data
[2023-07-05 16:50:59] [data] Done reading 20,192 sentences
[2023-07-05 16:50:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:51:36] Seen 18,843 samples
[2023-07-05 16:51:36] Starting data epoch 80 in logical epoch 80
[2023-07-05 16:51:36] [data] Shuffling data
[2023-07-05 16:51:36] [data] Done reading 20,192 sentences
[2023-07-05 16:51:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:52:11] Seen 18,843 samples
[2023-07-05 16:52:11] Starting data epoch 81 in logical epoch 81
[2023-07-05 16:52:11] Training finished
[2023-07-05 16:52:16] [valid] Ep. 81 : Up. 23727 : cross-entropy : 145.078 : stalled 7 times (last best: 99.3721)
[2023-07-05 16:53:55] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-07-05 16:53:55] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:53:57] Saving Adam parameters
[2023-07-05 16:53:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:54:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:54:09] [marian] Running on node22.datos.cluster.uy as process 32836 with command line:
[2023-07-05 16:54:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 16:54:09] [config] after: 0e
[2023-07-05 16:54:09] [config] after-batches: 0
[2023-07-05 16:54:09] [config] after-epochs: 90
[2023-07-05 16:54:09] [config] all-caps-every: 0
[2023-07-05 16:54:09] [config] allow-unk: false
[2023-07-05 16:54:09] [config] authors: false
[2023-07-05 16:54:09] [config] beam-size: 12
[2023-07-05 16:54:09] [config] bert-class-symbol: "[CLS]"
[2023-07-05 16:54:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 16:54:09] [config] bert-masking-fraction: 0.15
[2023-07-05 16:54:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 16:54:09] [config] bert-train-type-embeddings: true
[2023-07-05 16:54:09] [config] bert-type-vocab-size: 2
[2023-07-05 16:54:09] [config] build-info: ""
[2023-07-05 16:54:09] [config] check-gradient-nan: false
[2023-07-05 16:54:09] [config] check-nan: false
[2023-07-05 16:54:09] [config] cite: false
[2023-07-05 16:54:09] [config] clip-norm: 1
[2023-07-05 16:54:09] [config] cost-scaling:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] cost-type: ce-sum
[2023-07-05 16:54:09] [config] cpu-threads: 0
[2023-07-05 16:54:09] [config] data-threads: 8
[2023-07-05 16:54:09] [config] data-weighting: ""
[2023-07-05 16:54:09] [config] data-weighting-type: sentence
[2023-07-05 16:54:09] [config] dec-cell: gru
[2023-07-05 16:54:09] [config] dec-cell-base-depth: 2
[2023-07-05 16:54:09] [config] dec-cell-high-depth: 1
[2023-07-05 16:54:09] [config] dec-depth: 1
[2023-07-05 16:54:09] [config] devices:
[2023-07-05 16:54:09] [config]   - 0
[2023-07-05 16:54:09] [config] dim-emb: 512
[2023-07-05 16:54:09] [config] dim-rnn: 1024
[2023-07-05 16:54:09] [config] dim-vocabs:
[2023-07-05 16:54:09] [config]   - 36507
[2023-07-05 16:54:09] [config]   - 54042
[2023-07-05 16:54:09] [config] disp-first: 0
[2023-07-05 16:54:09] [config] disp-freq: 1000u
[2023-07-05 16:54:09] [config] disp-label-counts: true
[2023-07-05 16:54:09] [config] dropout-rnn: 0
[2023-07-05 16:54:09] [config] dropout-src: 0
[2023-07-05 16:54:09] [config] dropout-trg: 0
[2023-07-05 16:54:09] [config] dump-config: ""
[2023-07-05 16:54:09] [config] dynamic-gradient-scaling:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] early-stopping: 10
[2023-07-05 16:54:09] [config] early-stopping-on: first
[2023-07-05 16:54:09] [config] embedding-fix-src: false
[2023-07-05 16:54:09] [config] embedding-fix-trg: false
[2023-07-05 16:54:09] [config] embedding-normalization: false
[2023-07-05 16:54:09] [config] embedding-vectors:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] enc-cell: gru
[2023-07-05 16:54:09] [config] enc-cell-depth: 1
[2023-07-05 16:54:09] [config] enc-depth: 1
[2023-07-05 16:54:09] [config] enc-type: bidirectional
[2023-07-05 16:54:09] [config] english-title-case-every: 0
[2023-07-05 16:54:09] [config] exponential-smoothing: 0
[2023-07-05 16:54:09] [config] factor-weight: 1
[2023-07-05 16:54:09] [config] factors-combine: sum
[2023-07-05 16:54:09] [config] factors-dim-emb: 0
[2023-07-05 16:54:09] [config] gradient-checkpointing: false
[2023-07-05 16:54:09] [config] gradient-norm-average-window: 100
[2023-07-05 16:54:09] [config] guided-alignment: none
[2023-07-05 16:54:09] [config] guided-alignment-cost: mse
[2023-07-05 16:54:09] [config] guided-alignment-weight: 0.1
[2023-07-05 16:54:09] [config] ignore-model-config: false
[2023-07-05 16:54:09] [config] input-types:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] interpolate-env-vars: false
[2023-07-05 16:54:09] [config] keep-best: false
[2023-07-05 16:54:09] [config] label-smoothing: 0
[2023-07-05 16:54:09] [config] layer-normalization: false
[2023-07-05 16:54:09] [config] learn-rate: 0.0001
[2023-07-05 16:54:09] [config] lemma-dependency: ""
[2023-07-05 16:54:09] [config] lemma-dim-emb: 0
[2023-07-05 16:54:09] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 16:54:09] [config] log-level: info
[2023-07-05 16:54:09] [config] log-time-zone: ""
[2023-07-05 16:54:09] [config] logical-epoch:
[2023-07-05 16:54:09] [config]   - 1e
[2023-07-05 16:54:09] [config]   - 0
[2023-07-05 16:54:09] [config] lr-decay: 0
[2023-07-05 16:54:09] [config] lr-decay-freq: 50000
[2023-07-05 16:54:09] [config] lr-decay-inv-sqrt:
[2023-07-05 16:54:09] [config]   - 0
[2023-07-05 16:54:09] [config] lr-decay-repeat-warmup: false
[2023-07-05 16:54:09] [config] lr-decay-reset-optimizer: false
[2023-07-05 16:54:09] [config] lr-decay-start:
[2023-07-05 16:54:09] [config]   - 10
[2023-07-05 16:54:09] [config]   - 1
[2023-07-05 16:54:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 16:54:09] [config] lr-report: false
[2023-07-05 16:54:09] [config] lr-warmup: 0
[2023-07-05 16:54:09] [config] lr-warmup-at-reload: false
[2023-07-05 16:54:09] [config] lr-warmup-cycle: false
[2023-07-05 16:54:09] [config] lr-warmup-start-rate: 0
[2023-07-05 16:54:09] [config] max-length: 50
[2023-07-05 16:54:09] [config] max-length-crop: false
[2023-07-05 16:54:09] [config] max-length-factor: 3
[2023-07-05 16:54:09] [config] maxi-batch: 100
[2023-07-05 16:54:09] [config] maxi-batch-sort: trg
[2023-07-05 16:54:09] [config] mini-batch: 64
[2023-07-05 16:54:09] [config] mini-batch-fit: false
[2023-07-05 16:54:09] [config] mini-batch-fit-step: 10
[2023-07-05 16:54:09] [config] mini-batch-round-up: true
[2023-07-05 16:54:09] [config] mini-batch-track-lr: false
[2023-07-05 16:54:09] [config] mini-batch-warmup: 0
[2023-07-05 16:54:09] [config] mini-batch-words: 0
[2023-07-05 16:54:09] [config] mini-batch-words-ref: 0
[2023-07-05 16:54:09] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:54:09] [config] multi-loss-type: sum
[2023-07-05 16:54:09] [config] n-best: false
[2023-07-05 16:54:09] [config] no-nccl: false
[2023-07-05 16:54:09] [config] no-reload: false
[2023-07-05 16:54:09] [config] no-restore-corpus: false
[2023-07-05 16:54:09] [config] normalize: 0
[2023-07-05 16:54:09] [config] normalize-gradient: false
[2023-07-05 16:54:09] [config] num-devices: 0
[2023-07-05 16:54:09] [config] optimizer: adam
[2023-07-05 16:54:09] [config] optimizer-delay: 1
[2023-07-05 16:54:09] [config] optimizer-params:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] output-omit-bias: false
[2023-07-05 16:54:09] [config] overwrite: true
[2023-07-05 16:54:09] [config] precision:
[2023-07-05 16:54:09] [config]   - float32
[2023-07-05 16:54:09] [config]   - float32
[2023-07-05 16:54:09] [config] pretrained-model: ""
[2023-07-05 16:54:09] [config] quantize-biases: false
[2023-07-05 16:54:09] [config] quantize-bits: 0
[2023-07-05 16:54:09] [config] quantize-log-based: false
[2023-07-05 16:54:09] [config] quantize-optimization-steps: 0
[2023-07-05 16:54:09] [config] quiet: false
[2023-07-05 16:54:09] [config] quiet-translation: true
[2023-07-05 16:54:09] [config] relative-paths: false
[2023-07-05 16:54:09] [config] right-left: false
[2023-07-05 16:54:09] [config] save-freq: 10000u
[2023-07-05 16:54:09] [config] seed: 1234
[2023-07-05 16:54:09] [config] sentencepiece-alphas:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] sentencepiece-max-lines: 2000000
[2023-07-05 16:54:09] [config] sentencepiece-options: ""
[2023-07-05 16:54:09] [config] sharding: global
[2023-07-05 16:54:09] [config] shuffle: data
[2023-07-05 16:54:09] [config] shuffle-in-ram: false
[2023-07-05 16:54:09] [config] sigterm: save-and-exit
[2023-07-05 16:54:09] [config] skip: false
[2023-07-05 16:54:09] [config] sqlite: ""
[2023-07-05 16:54:09] [config] sqlite-drop: false
[2023-07-05 16:54:09] [config] sync-freq: 200u
[2023-07-05 16:54:09] [config] sync-sgd: false
[2023-07-05 16:54:09] [config] tempdir: /tmp
[2023-07-05 16:54:09] [config] tied-embeddings: false
[2023-07-05 16:54:09] [config] tied-embeddings-all: false
[2023-07-05 16:54:09] [config] tied-embeddings-src: false
[2023-07-05 16:54:09] [config] train-embedder-rank:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] train-sets:
[2023-07-05 16:54:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 16:54:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 16:54:09] [config] transformer-aan-activation: swish
[2023-07-05 16:54:09] [config] transformer-aan-depth: 2
[2023-07-05 16:54:09] [config] transformer-aan-nogate: false
[2023-07-05 16:54:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 16:54:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 16:54:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 16:54:09] [config] transformer-depth-scaling: false
[2023-07-05 16:54:09] [config] transformer-dim-aan: 2048
[2023-07-05 16:54:09] [config] transformer-dim-ffn: 2048
[2023-07-05 16:54:09] [config] transformer-dropout: 0
[2023-07-05 16:54:09] [config] transformer-dropout-attention: 0
[2023-07-05 16:54:09] [config] transformer-dropout-ffn: 0
[2023-07-05 16:54:09] [config] transformer-ffn-activation: swish
[2023-07-05 16:54:09] [config] transformer-ffn-depth: 2
[2023-07-05 16:54:09] [config] transformer-guided-alignment-layer: last
[2023-07-05 16:54:09] [config] transformer-heads: 8
[2023-07-05 16:54:09] [config] transformer-no-projection: false
[2023-07-05 16:54:09] [config] transformer-pool: false
[2023-07-05 16:54:09] [config] transformer-postprocess: dan
[2023-07-05 16:54:09] [config] transformer-postprocess-emb: d
[2023-07-05 16:54:09] [config] transformer-postprocess-top: ""
[2023-07-05 16:54:09] [config] transformer-preprocess: ""
[2023-07-05 16:54:09] [config] transformer-tied-layers:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] transformer-train-position-embeddings: false
[2023-07-05 16:54:09] [config] tsv: false
[2023-07-05 16:54:09] [config] tsv-fields: 0
[2023-07-05 16:54:09] [config] type: transformer
[2023-07-05 16:54:09] [config] ulr: false
[2023-07-05 16:54:09] [config] ulr-dim-emb: 0
[2023-07-05 16:54:09] [config] ulr-dropout: 0
[2023-07-05 16:54:09] [config] ulr-keys-vectors: ""
[2023-07-05 16:54:09] [config] ulr-query-vectors: ""
[2023-07-05 16:54:09] [config] ulr-softmax-temperature: 1
[2023-07-05 16:54:09] [config] ulr-trainable-transformation: false
[2023-07-05 16:54:09] [config] unlikelihood-loss: false
[2023-07-05 16:54:09] [config] valid-freq: 50000000
[2023-07-05 16:54:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 16:54:09] [config] valid-max-length: 1000
[2023-07-05 16:54:09] [config] valid-metrics:
[2023-07-05 16:54:09] [config]   - cross-entropy
[2023-07-05 16:54:09] [config]   - translation
[2023-07-05 16:54:09] [config] valid-mini-batch: 32
[2023-07-05 16:54:09] [config] valid-reset-stalled: false
[2023-07-05 16:54:09] [config] valid-script-args:
[2023-07-05 16:54:09] [config]   []
[2023-07-05 16:54:09] [config] valid-script-path: ""
[2023-07-05 16:54:09] [config] valid-sets:
[2023-07-05 16:54:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 16:54:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 16:54:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 16:54:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:54:09] [config] vocabs:
[2023-07-05 16:54:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:54:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:54:09] [config] word-penalty: 0
[2023-07-05 16:54:09] [config] word-scores: false
[2023-07-05 16:54:09] [config] workspace: 2048
[2023-07-05 16:54:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 16:54:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:54:09] [training] Using single-device training
[2023-07-05 16:54:11] Synced seed 1234
[2023-07-05 16:54:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 16:54:11] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 16:54:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 16:54:11] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 16:54:11] [valid] No post-processing script given for validating translator
[2023-07-05 16:54:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 16:54:12] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 16:54:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 16:54:12] [comm] Using global sharding
[2023-07-05 16:54:12] [comm] NCCLCommunicators constructed successfully
[2023-07-05 16:54:12] [training] Using 1 GPUs
[2023-07-05 16:54:12] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 16:54:14] Loading Adam parameters
[2023-07-05 16:54:14] [memory] Reserving 621 MB, device gpu0
[2023-07-05 16:54:14] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:54:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 16:54:15] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-07-05 16:54:15] [data] Shuffling data
[2023-07-05 16:54:15] [data] Done reading 20,192 sentences
[2023-07-05 16:54:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:54:15] Training started
[2023-07-05 16:54:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 16:54:15] [logits] Applying loss function for 1 factor(s)
[2023-07-05 16:54:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 16:54:15] [memory] Reserving 310 MB, device gpu0
[2023-07-05 16:54:15] Parameter type float32, optimization type float32, casting types false
[2023-07-05 16:54:37] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.00635507 * 932,566 @ 576 after 22,364,876 : Time 26.44s : 35275.63 words/s : gNorm 0.4011
[2023-07-05 16:54:40] Seen 18,843 samples
[2023-07-05 16:54:40] Starting data epoch 82 in logical epoch 82
[2023-07-05 16:54:40] [data] Shuffling data
[2023-07-05 16:54:40] [data] Done reading 20,192 sentences
[2023-07-05 16:54:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:55:15] Seen 18,843 samples
[2023-07-05 16:55:15] Starting data epoch 83 in logical epoch 83
[2023-07-05 16:55:15] [data] Shuffling data
[2023-07-05 16:55:15] [data] Done reading 20,192 sentences
[2023-07-05 16:55:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:55:53] Seen 18,843 samples
[2023-07-05 16:55:53] Starting data epoch 84 in logical epoch 84
[2023-07-05 16:55:53] [data] Shuffling data
[2023-07-05 16:55:53] [data] Done reading 20,192 sentences
[2023-07-05 16:55:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:56:25] Seen 18,843 samples
[2023-07-05 16:56:25] Starting data epoch 85 in logical epoch 85
[2023-07-05 16:56:25] [data] Shuffling data
[2023-07-05 16:56:25] [data] Done reading 20,192 sentences
[2023-07-05 16:56:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:56:36] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.00601232 * 930,417 @ 896 after 23,295,293 : Time 118.24s : 7869.11 words/s : gNorm 0.4845
[2023-07-05 16:57:00] Seen 18,843 samples
[2023-07-05 16:57:00] Starting data epoch 86 in logical epoch 86
[2023-07-05 16:57:00] [data] Shuffling data
[2023-07-05 16:57:00] [data] Done reading 20,192 sentences
[2023-07-05 16:57:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:57:36] Seen 18,843 samples
[2023-07-05 16:57:36] Starting data epoch 87 in logical epoch 87
[2023-07-05 16:57:36] [data] Shuffling data
[2023-07-05 16:57:36] [data] Done reading 20,192 sentences
[2023-07-05 16:57:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:58:11] Seen 18,843 samples
[2023-07-05 16:58:11] Starting data epoch 88 in logical epoch 88
[2023-07-05 16:58:11] [data] Shuffling data
[2023-07-05 16:58:11] [data] Done reading 20,192 sentences
[2023-07-05 16:58:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:58:36] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.00590267 * 934,924 @ 640 after 24,230,217 : Time 120.72s : 7744.29 words/s : gNorm 0.3061
[2023-07-05 16:58:47] Seen 18,843 samples
[2023-07-05 16:58:47] Starting data epoch 89 in logical epoch 89
[2023-07-05 16:58:47] [data] Shuffling data
[2023-07-05 16:58:47] [data] Done reading 20,192 sentences
[2023-07-05 16:58:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:59:20] Seen 18,843 samples
[2023-07-05 16:59:20] Starting data epoch 90 in logical epoch 90
[2023-07-05 16:59:20] [data] Shuffling data
[2023-07-05 16:59:20] [data] Done reading 20,192 sentences
[2023-07-05 16:59:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 16:59:57] Seen 18,843 samples
[2023-07-05 16:59:57] Starting data epoch 91 in logical epoch 91
[2023-07-05 16:59:57] Training finished
[2023-07-05 17:00:02] [valid] Ep. 91 : Up. 26693 : cross-entropy : 151.74 : stalled 8 times (last best: 99.3721)
[2023-07-05 17:01:30] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-07-05 17:01:30] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:01:33] Saving Adam parameters
[2023-07-05 17:01:34] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:01:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:01:45] [marian] Running on node22.datos.cluster.uy as process 40609 with command line:
[2023-07-05 17:01:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:01:45] [config] after: 0e
[2023-07-05 17:01:45] [config] after-batches: 0
[2023-07-05 17:01:45] [config] after-epochs: 100
[2023-07-05 17:01:45] [config] all-caps-every: 0
[2023-07-05 17:01:45] [config] allow-unk: false
[2023-07-05 17:01:45] [config] authors: false
[2023-07-05 17:01:45] [config] beam-size: 12
[2023-07-05 17:01:45] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:01:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:01:45] [config] bert-masking-fraction: 0.15
[2023-07-05 17:01:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:01:45] [config] bert-train-type-embeddings: true
[2023-07-05 17:01:45] [config] bert-type-vocab-size: 2
[2023-07-05 17:01:45] [config] build-info: ""
[2023-07-05 17:01:45] [config] check-gradient-nan: false
[2023-07-05 17:01:45] [config] check-nan: false
[2023-07-05 17:01:45] [config] cite: false
[2023-07-05 17:01:45] [config] clip-norm: 1
[2023-07-05 17:01:45] [config] cost-scaling:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] cost-type: ce-sum
[2023-07-05 17:01:45] [config] cpu-threads: 0
[2023-07-05 17:01:45] [config] data-threads: 8
[2023-07-05 17:01:45] [config] data-weighting: ""
[2023-07-05 17:01:45] [config] data-weighting-type: sentence
[2023-07-05 17:01:45] [config] dec-cell: gru
[2023-07-05 17:01:45] [config] dec-cell-base-depth: 2
[2023-07-05 17:01:45] [config] dec-cell-high-depth: 1
[2023-07-05 17:01:45] [config] dec-depth: 1
[2023-07-05 17:01:45] [config] devices:
[2023-07-05 17:01:45] [config]   - 0
[2023-07-05 17:01:45] [config] dim-emb: 512
[2023-07-05 17:01:45] [config] dim-rnn: 1024
[2023-07-05 17:01:45] [config] dim-vocabs:
[2023-07-05 17:01:45] [config]   - 36507
[2023-07-05 17:01:45] [config]   - 54042
[2023-07-05 17:01:45] [config] disp-first: 0
[2023-07-05 17:01:45] [config] disp-freq: 1000u
[2023-07-05 17:01:45] [config] disp-label-counts: true
[2023-07-05 17:01:45] [config] dropout-rnn: 0
[2023-07-05 17:01:45] [config] dropout-src: 0
[2023-07-05 17:01:45] [config] dropout-trg: 0
[2023-07-05 17:01:45] [config] dump-config: ""
[2023-07-05 17:01:45] [config] dynamic-gradient-scaling:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] early-stopping: 10
[2023-07-05 17:01:45] [config] early-stopping-on: first
[2023-07-05 17:01:45] [config] embedding-fix-src: false
[2023-07-05 17:01:45] [config] embedding-fix-trg: false
[2023-07-05 17:01:45] [config] embedding-normalization: false
[2023-07-05 17:01:45] [config] embedding-vectors:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] enc-cell: gru
[2023-07-05 17:01:45] [config] enc-cell-depth: 1
[2023-07-05 17:01:45] [config] enc-depth: 1
[2023-07-05 17:01:45] [config] enc-type: bidirectional
[2023-07-05 17:01:45] [config] english-title-case-every: 0
[2023-07-05 17:01:45] [config] exponential-smoothing: 0
[2023-07-05 17:01:45] [config] factor-weight: 1
[2023-07-05 17:01:45] [config] factors-combine: sum
[2023-07-05 17:01:45] [config] factors-dim-emb: 0
[2023-07-05 17:01:45] [config] gradient-checkpointing: false
[2023-07-05 17:01:45] [config] gradient-norm-average-window: 100
[2023-07-05 17:01:45] [config] guided-alignment: none
[2023-07-05 17:01:45] [config] guided-alignment-cost: mse
[2023-07-05 17:01:45] [config] guided-alignment-weight: 0.1
[2023-07-05 17:01:45] [config] ignore-model-config: false
[2023-07-05 17:01:45] [config] input-types:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] interpolate-env-vars: false
[2023-07-05 17:01:45] [config] keep-best: false
[2023-07-05 17:01:45] [config] label-smoothing: 0
[2023-07-05 17:01:45] [config] layer-normalization: false
[2023-07-05 17:01:45] [config] learn-rate: 0.0001
[2023-07-05 17:01:45] [config] lemma-dependency: ""
[2023-07-05 17:01:45] [config] lemma-dim-emb: 0
[2023-07-05 17:01:45] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:01:45] [config] log-level: info
[2023-07-05 17:01:45] [config] log-time-zone: ""
[2023-07-05 17:01:45] [config] logical-epoch:
[2023-07-05 17:01:45] [config]   - 1e
[2023-07-05 17:01:45] [config]   - 0
[2023-07-05 17:01:45] [config] lr-decay: 0
[2023-07-05 17:01:45] [config] lr-decay-freq: 50000
[2023-07-05 17:01:45] [config] lr-decay-inv-sqrt:
[2023-07-05 17:01:45] [config]   - 0
[2023-07-05 17:01:45] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:01:45] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:01:45] [config] lr-decay-start:
[2023-07-05 17:01:45] [config]   - 10
[2023-07-05 17:01:45] [config]   - 1
[2023-07-05 17:01:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:01:45] [config] lr-report: false
[2023-07-05 17:01:45] [config] lr-warmup: 0
[2023-07-05 17:01:45] [config] lr-warmup-at-reload: false
[2023-07-05 17:01:45] [config] lr-warmup-cycle: false
[2023-07-05 17:01:45] [config] lr-warmup-start-rate: 0
[2023-07-05 17:01:45] [config] max-length: 50
[2023-07-05 17:01:45] [config] max-length-crop: false
[2023-07-05 17:01:45] [config] max-length-factor: 3
[2023-07-05 17:01:45] [config] maxi-batch: 100
[2023-07-05 17:01:45] [config] maxi-batch-sort: trg
[2023-07-05 17:01:45] [config] mini-batch: 64
[2023-07-05 17:01:45] [config] mini-batch-fit: false
[2023-07-05 17:01:45] [config] mini-batch-fit-step: 10
[2023-07-05 17:01:45] [config] mini-batch-round-up: true
[2023-07-05 17:01:45] [config] mini-batch-track-lr: false
[2023-07-05 17:01:45] [config] mini-batch-warmup: 0
[2023-07-05 17:01:45] [config] mini-batch-words: 0
[2023-07-05 17:01:45] [config] mini-batch-words-ref: 0
[2023-07-05 17:01:45] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:01:45] [config] multi-loss-type: sum
[2023-07-05 17:01:45] [config] n-best: false
[2023-07-05 17:01:45] [config] no-nccl: false
[2023-07-05 17:01:45] [config] no-reload: false
[2023-07-05 17:01:45] [config] no-restore-corpus: false
[2023-07-05 17:01:45] [config] normalize: 0
[2023-07-05 17:01:45] [config] normalize-gradient: false
[2023-07-05 17:01:45] [config] num-devices: 0
[2023-07-05 17:01:45] [config] optimizer: adam
[2023-07-05 17:01:45] [config] optimizer-delay: 1
[2023-07-05 17:01:45] [config] optimizer-params:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] output-omit-bias: false
[2023-07-05 17:01:45] [config] overwrite: true
[2023-07-05 17:01:45] [config] precision:
[2023-07-05 17:01:45] [config]   - float32
[2023-07-05 17:01:45] [config]   - float32
[2023-07-05 17:01:45] [config] pretrained-model: ""
[2023-07-05 17:01:45] [config] quantize-biases: false
[2023-07-05 17:01:45] [config] quantize-bits: 0
[2023-07-05 17:01:45] [config] quantize-log-based: false
[2023-07-05 17:01:45] [config] quantize-optimization-steps: 0
[2023-07-05 17:01:45] [config] quiet: false
[2023-07-05 17:01:45] [config] quiet-translation: true
[2023-07-05 17:01:45] [config] relative-paths: false
[2023-07-05 17:01:45] [config] right-left: false
[2023-07-05 17:01:45] [config] save-freq: 10000u
[2023-07-05 17:01:45] [config] seed: 1234
[2023-07-05 17:01:45] [config] sentencepiece-alphas:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:01:45] [config] sentencepiece-options: ""
[2023-07-05 17:01:45] [config] sharding: global
[2023-07-05 17:01:45] [config] shuffle: data
[2023-07-05 17:01:45] [config] shuffle-in-ram: false
[2023-07-05 17:01:45] [config] sigterm: save-and-exit
[2023-07-05 17:01:45] [config] skip: false
[2023-07-05 17:01:45] [config] sqlite: ""
[2023-07-05 17:01:45] [config] sqlite-drop: false
[2023-07-05 17:01:45] [config] sync-freq: 200u
[2023-07-05 17:01:45] [config] sync-sgd: false
[2023-07-05 17:01:45] [config] tempdir: /tmp
[2023-07-05 17:01:45] [config] tied-embeddings: false
[2023-07-05 17:01:45] [config] tied-embeddings-all: false
[2023-07-05 17:01:45] [config] tied-embeddings-src: false
[2023-07-05 17:01:45] [config] train-embedder-rank:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] train-sets:
[2023-07-05 17:01:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:01:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:01:45] [config] transformer-aan-activation: swish
[2023-07-05 17:01:45] [config] transformer-aan-depth: 2
[2023-07-05 17:01:45] [config] transformer-aan-nogate: false
[2023-07-05 17:01:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:01:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:01:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:01:45] [config] transformer-depth-scaling: false
[2023-07-05 17:01:45] [config] transformer-dim-aan: 2048
[2023-07-05 17:01:45] [config] transformer-dim-ffn: 2048
[2023-07-05 17:01:45] [config] transformer-dropout: 0
[2023-07-05 17:01:45] [config] transformer-dropout-attention: 0
[2023-07-05 17:01:45] [config] transformer-dropout-ffn: 0
[2023-07-05 17:01:45] [config] transformer-ffn-activation: swish
[2023-07-05 17:01:45] [config] transformer-ffn-depth: 2
[2023-07-05 17:01:45] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:01:45] [config] transformer-heads: 8
[2023-07-05 17:01:45] [config] transformer-no-projection: false
[2023-07-05 17:01:45] [config] transformer-pool: false
[2023-07-05 17:01:45] [config] transformer-postprocess: dan
[2023-07-05 17:01:45] [config] transformer-postprocess-emb: d
[2023-07-05 17:01:45] [config] transformer-postprocess-top: ""
[2023-07-05 17:01:45] [config] transformer-preprocess: ""
[2023-07-05 17:01:45] [config] transformer-tied-layers:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] transformer-train-position-embeddings: false
[2023-07-05 17:01:45] [config] tsv: false
[2023-07-05 17:01:45] [config] tsv-fields: 0
[2023-07-05 17:01:45] [config] type: transformer
[2023-07-05 17:01:45] [config] ulr: false
[2023-07-05 17:01:45] [config] ulr-dim-emb: 0
[2023-07-05 17:01:45] [config] ulr-dropout: 0
[2023-07-05 17:01:45] [config] ulr-keys-vectors: ""
[2023-07-05 17:01:45] [config] ulr-query-vectors: ""
[2023-07-05 17:01:45] [config] ulr-softmax-temperature: 1
[2023-07-05 17:01:45] [config] ulr-trainable-transformation: false
[2023-07-05 17:01:45] [config] unlikelihood-loss: false
[2023-07-05 17:01:45] [config] valid-freq: 50000000
[2023-07-05 17:01:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:01:45] [config] valid-max-length: 1000
[2023-07-05 17:01:45] [config] valid-metrics:
[2023-07-05 17:01:45] [config]   - cross-entropy
[2023-07-05 17:01:45] [config]   - translation
[2023-07-05 17:01:45] [config] valid-mini-batch: 32
[2023-07-05 17:01:45] [config] valid-reset-stalled: false
[2023-07-05 17:01:45] [config] valid-script-args:
[2023-07-05 17:01:45] [config]   []
[2023-07-05 17:01:45] [config] valid-script-path: ""
[2023-07-05 17:01:45] [config] valid-sets:
[2023-07-05 17:01:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:01:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:01:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:01:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:01:45] [config] vocabs:
[2023-07-05 17:01:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:01:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:01:45] [config] word-penalty: 0
[2023-07-05 17:01:45] [config] word-scores: false
[2023-07-05 17:01:45] [config] workspace: 2048
[2023-07-05 17:01:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:01:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:01:45] [training] Using single-device training
[2023-07-05 17:01:46] Synced seed 1234
[2023-07-05 17:01:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:01:46] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:01:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:01:46] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:01:46] [valid] No post-processing script given for validating translator
[2023-07-05 17:01:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:01:47] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:01:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:01:47] [comm] Using global sharding
[2023-07-05 17:01:47] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:01:47] [training] Using 1 GPUs
[2023-07-05 17:01:47] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:01:49] Loading Adam parameters
[2023-07-05 17:01:50] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:01:50] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:01:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:01:50] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-07-05 17:01:50] [data] Shuffling data
[2023-07-05 17:01:50] [data] Done reading 20,192 sentences
[2023-07-05 17:01:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:01:50] Training started
[2023-07-05 17:01:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 17:01:50] [logits] Applying loss function for 1 factor(s)
[2023-07-05 17:01:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 17:01:50] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:01:50] Parameter type float32, optimization type float32, casting types false
[2023-07-05 17:02:16] Seen 18,843 samples
[2023-07-05 17:02:16] Starting data epoch 92 in logical epoch 92
[2023-07-05 17:02:16] [data] Shuffling data
[2023-07-05 17:02:16] [data] Done reading 20,192 sentences
[2023-07-05 17:02:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:02:17] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.00613269 * 926,263 @ 384 after 25,156,480 : Time 30.18s : 30691.15 words/s : gNorm 0.3513
[2023-07-05 17:02:51] Seen 18,843 samples
[2023-07-05 17:02:51] Starting data epoch 93 in logical epoch 93
[2023-07-05 17:02:51] [data] Shuffling data
[2023-07-05 17:02:51] [data] Done reading 20,192 sentences
[2023-07-05 17:02:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:03:26] Seen 18,843 samples
[2023-07-05 17:03:26] Starting data epoch 94 in logical epoch 94
[2023-07-05 17:03:26] [data] Shuffling data
[2023-07-05 17:03:26] [data] Done reading 20,192 sentences
[2023-07-05 17:03:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:04:00] Seen 18,843 samples
[2023-07-05 17:04:00] Starting data epoch 95 in logical epoch 95
[2023-07-05 17:04:00] [data] Shuffling data
[2023-07-05 17:04:00] [data] Done reading 20,192 sentences
[2023-07-05 17:04:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:04:16] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.00528444 * 936,745 @ 1,372 after 26,093,225 : Time 119.27s : 7854.28 words/s : gNorm 0.3733
[2023-07-05 17:04:37] Seen 18,843 samples
[2023-07-05 17:04:37] Starting data epoch 96 in logical epoch 96
[2023-07-05 17:04:37] [data] Shuffling data
[2023-07-05 17:04:37] [data] Done reading 20,192 sentences
[2023-07-05 17:04:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:05:11] Seen 18,843 samples
[2023-07-05 17:05:11] Starting data epoch 97 in logical epoch 97
[2023-07-05 17:05:11] [data] Shuffling data
[2023-07-05 17:05:11] [data] Done reading 20,192 sentences
[2023-07-05 17:05:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:05:46] Seen 18,843 samples
[2023-07-05 17:05:46] Starting data epoch 98 in logical epoch 98
[2023-07-05 17:05:46] [data] Shuffling data
[2023-07-05 17:05:46] [data] Done reading 20,192 sentences
[2023-07-05 17:05:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:06:13] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.00500031 * 930,226 @ 1,766 after 27,023,451 : Time 116.66s : 7974.06 words/s : gNorm 0.3337
[2023-07-05 17:06:20] Seen 18,843 samples
[2023-07-05 17:06:20] Starting data epoch 99 in logical epoch 99
[2023-07-05 17:06:20] [data] Shuffling data
[2023-07-05 17:06:20] [data] Done reading 20,192 sentences
[2023-07-05 17:06:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:06:58] Seen 18,843 samples
[2023-07-05 17:06:58] Starting data epoch 100 in logical epoch 100
[2023-07-05 17:06:58] [data] Shuffling data
[2023-07-05 17:06:58] [data] Done reading 20,192 sentences
[2023-07-05 17:06:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:07:34] Seen 18,843 samples
[2023-07-05 17:07:34] Starting data epoch 101 in logical epoch 101
[2023-07-05 17:07:34] Training finished
[2023-07-05 17:07:38] [valid] Ep. 101 : Up. 29659 : cross-entropy : 151.263 : stalled 9 times (last best: 99.3721)
[2023-07-05 17:09:01] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-07-05 17:09:01] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:09:04] Saving Adam parameters
[2023-07-05 17:09:05] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:09:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:09:15] [marian] Running on node22.datos.cluster.uy as process 7666 with command line:
[2023-07-05 17:09:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:09:15] [config] after: 0e
[2023-07-05 17:09:15] [config] after-batches: 0
[2023-07-05 17:09:15] [config] after-epochs: 110
[2023-07-05 17:09:15] [config] all-caps-every: 0
[2023-07-05 17:09:15] [config] allow-unk: false
[2023-07-05 17:09:15] [config] authors: false
[2023-07-05 17:09:15] [config] beam-size: 12
[2023-07-05 17:09:15] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:09:15] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:09:15] [config] bert-masking-fraction: 0.15
[2023-07-05 17:09:15] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:09:15] [config] bert-train-type-embeddings: true
[2023-07-05 17:09:15] [config] bert-type-vocab-size: 2
[2023-07-05 17:09:15] [config] build-info: ""
[2023-07-05 17:09:15] [config] check-gradient-nan: false
[2023-07-05 17:09:15] [config] check-nan: false
[2023-07-05 17:09:15] [config] cite: false
[2023-07-05 17:09:15] [config] clip-norm: 1
[2023-07-05 17:09:15] [config] cost-scaling:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] cost-type: ce-sum
[2023-07-05 17:09:15] [config] cpu-threads: 0
[2023-07-05 17:09:15] [config] data-threads: 8
[2023-07-05 17:09:15] [config] data-weighting: ""
[2023-07-05 17:09:15] [config] data-weighting-type: sentence
[2023-07-05 17:09:15] [config] dec-cell: gru
[2023-07-05 17:09:15] [config] dec-cell-base-depth: 2
[2023-07-05 17:09:15] [config] dec-cell-high-depth: 1
[2023-07-05 17:09:15] [config] dec-depth: 1
[2023-07-05 17:09:15] [config] devices:
[2023-07-05 17:09:15] [config]   - 0
[2023-07-05 17:09:15] [config] dim-emb: 512
[2023-07-05 17:09:15] [config] dim-rnn: 1024
[2023-07-05 17:09:15] [config] dim-vocabs:
[2023-07-05 17:09:15] [config]   - 36507
[2023-07-05 17:09:15] [config]   - 54042
[2023-07-05 17:09:15] [config] disp-first: 0
[2023-07-05 17:09:15] [config] disp-freq: 1000u
[2023-07-05 17:09:15] [config] disp-label-counts: true
[2023-07-05 17:09:15] [config] dropout-rnn: 0
[2023-07-05 17:09:15] [config] dropout-src: 0
[2023-07-05 17:09:15] [config] dropout-trg: 0
[2023-07-05 17:09:15] [config] dump-config: ""
[2023-07-05 17:09:15] [config] dynamic-gradient-scaling:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] early-stopping: 10
[2023-07-05 17:09:15] [config] early-stopping-on: first
[2023-07-05 17:09:15] [config] embedding-fix-src: false
[2023-07-05 17:09:15] [config] embedding-fix-trg: false
[2023-07-05 17:09:15] [config] embedding-normalization: false
[2023-07-05 17:09:15] [config] embedding-vectors:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] enc-cell: gru
[2023-07-05 17:09:15] [config] enc-cell-depth: 1
[2023-07-05 17:09:15] [config] enc-depth: 1
[2023-07-05 17:09:15] [config] enc-type: bidirectional
[2023-07-05 17:09:15] [config] english-title-case-every: 0
[2023-07-05 17:09:15] [config] exponential-smoothing: 0
[2023-07-05 17:09:15] [config] factor-weight: 1
[2023-07-05 17:09:15] [config] factors-combine: sum
[2023-07-05 17:09:15] [config] factors-dim-emb: 0
[2023-07-05 17:09:15] [config] gradient-checkpointing: false
[2023-07-05 17:09:15] [config] gradient-norm-average-window: 100
[2023-07-05 17:09:15] [config] guided-alignment: none
[2023-07-05 17:09:15] [config] guided-alignment-cost: mse
[2023-07-05 17:09:15] [config] guided-alignment-weight: 0.1
[2023-07-05 17:09:15] [config] ignore-model-config: false
[2023-07-05 17:09:15] [config] input-types:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] interpolate-env-vars: false
[2023-07-05 17:09:15] [config] keep-best: false
[2023-07-05 17:09:15] [config] label-smoothing: 0
[2023-07-05 17:09:15] [config] layer-normalization: false
[2023-07-05 17:09:15] [config] learn-rate: 0.0001
[2023-07-05 17:09:15] [config] lemma-dependency: ""
[2023-07-05 17:09:15] [config] lemma-dim-emb: 0
[2023-07-05 17:09:15] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:09:15] [config] log-level: info
[2023-07-05 17:09:15] [config] log-time-zone: ""
[2023-07-05 17:09:15] [config] logical-epoch:
[2023-07-05 17:09:15] [config]   - 1e
[2023-07-05 17:09:15] [config]   - 0
[2023-07-05 17:09:15] [config] lr-decay: 0
[2023-07-05 17:09:15] [config] lr-decay-freq: 50000
[2023-07-05 17:09:15] [config] lr-decay-inv-sqrt:
[2023-07-05 17:09:15] [config]   - 0
[2023-07-05 17:09:15] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:09:15] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:09:15] [config] lr-decay-start:
[2023-07-05 17:09:15] [config]   - 10
[2023-07-05 17:09:15] [config]   - 1
[2023-07-05 17:09:15] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:09:15] [config] lr-report: false
[2023-07-05 17:09:15] [config] lr-warmup: 0
[2023-07-05 17:09:15] [config] lr-warmup-at-reload: false
[2023-07-05 17:09:15] [config] lr-warmup-cycle: false
[2023-07-05 17:09:15] [config] lr-warmup-start-rate: 0
[2023-07-05 17:09:15] [config] max-length: 50
[2023-07-05 17:09:15] [config] max-length-crop: false
[2023-07-05 17:09:15] [config] max-length-factor: 3
[2023-07-05 17:09:15] [config] maxi-batch: 100
[2023-07-05 17:09:15] [config] maxi-batch-sort: trg
[2023-07-05 17:09:15] [config] mini-batch: 64
[2023-07-05 17:09:15] [config] mini-batch-fit: false
[2023-07-05 17:09:15] [config] mini-batch-fit-step: 10
[2023-07-05 17:09:15] [config] mini-batch-round-up: true
[2023-07-05 17:09:15] [config] mini-batch-track-lr: false
[2023-07-05 17:09:15] [config] mini-batch-warmup: 0
[2023-07-05 17:09:15] [config] mini-batch-words: 0
[2023-07-05 17:09:15] [config] mini-batch-words-ref: 0
[2023-07-05 17:09:15] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:09:15] [config] multi-loss-type: sum
[2023-07-05 17:09:15] [config] n-best: false
[2023-07-05 17:09:15] [config] no-nccl: false
[2023-07-05 17:09:15] [config] no-reload: false
[2023-07-05 17:09:15] [config] no-restore-corpus: false
[2023-07-05 17:09:15] [config] normalize: 0
[2023-07-05 17:09:15] [config] normalize-gradient: false
[2023-07-05 17:09:15] [config] num-devices: 0
[2023-07-05 17:09:15] [config] optimizer: adam
[2023-07-05 17:09:15] [config] optimizer-delay: 1
[2023-07-05 17:09:15] [config] optimizer-params:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] output-omit-bias: false
[2023-07-05 17:09:15] [config] overwrite: true
[2023-07-05 17:09:15] [config] precision:
[2023-07-05 17:09:15] [config]   - float32
[2023-07-05 17:09:15] [config]   - float32
[2023-07-05 17:09:15] [config] pretrained-model: ""
[2023-07-05 17:09:15] [config] quantize-biases: false
[2023-07-05 17:09:15] [config] quantize-bits: 0
[2023-07-05 17:09:15] [config] quantize-log-based: false
[2023-07-05 17:09:15] [config] quantize-optimization-steps: 0
[2023-07-05 17:09:15] [config] quiet: false
[2023-07-05 17:09:15] [config] quiet-translation: true
[2023-07-05 17:09:15] [config] relative-paths: false
[2023-07-05 17:09:15] [config] right-left: false
[2023-07-05 17:09:15] [config] save-freq: 10000u
[2023-07-05 17:09:15] [config] seed: 1234
[2023-07-05 17:09:15] [config] sentencepiece-alphas:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:09:15] [config] sentencepiece-options: ""
[2023-07-05 17:09:15] [config] sharding: global
[2023-07-05 17:09:15] [config] shuffle: data
[2023-07-05 17:09:15] [config] shuffle-in-ram: false
[2023-07-05 17:09:15] [config] sigterm: save-and-exit
[2023-07-05 17:09:15] [config] skip: false
[2023-07-05 17:09:15] [config] sqlite: ""
[2023-07-05 17:09:15] [config] sqlite-drop: false
[2023-07-05 17:09:15] [config] sync-freq: 200u
[2023-07-05 17:09:15] [config] sync-sgd: false
[2023-07-05 17:09:15] [config] tempdir: /tmp
[2023-07-05 17:09:15] [config] tied-embeddings: false
[2023-07-05 17:09:15] [config] tied-embeddings-all: false
[2023-07-05 17:09:15] [config] tied-embeddings-src: false
[2023-07-05 17:09:15] [config] train-embedder-rank:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] train-sets:
[2023-07-05 17:09:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:09:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:09:15] [config] transformer-aan-activation: swish
[2023-07-05 17:09:15] [config] transformer-aan-depth: 2
[2023-07-05 17:09:15] [config] transformer-aan-nogate: false
[2023-07-05 17:09:15] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:09:15] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:09:15] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:09:15] [config] transformer-depth-scaling: false
[2023-07-05 17:09:15] [config] transformer-dim-aan: 2048
[2023-07-05 17:09:15] [config] transformer-dim-ffn: 2048
[2023-07-05 17:09:15] [config] transformer-dropout: 0
[2023-07-05 17:09:15] [config] transformer-dropout-attention: 0
[2023-07-05 17:09:15] [config] transformer-dropout-ffn: 0
[2023-07-05 17:09:15] [config] transformer-ffn-activation: swish
[2023-07-05 17:09:15] [config] transformer-ffn-depth: 2
[2023-07-05 17:09:15] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:09:15] [config] transformer-heads: 8
[2023-07-05 17:09:15] [config] transformer-no-projection: false
[2023-07-05 17:09:15] [config] transformer-pool: false
[2023-07-05 17:09:15] [config] transformer-postprocess: dan
[2023-07-05 17:09:15] [config] transformer-postprocess-emb: d
[2023-07-05 17:09:15] [config] transformer-postprocess-top: ""
[2023-07-05 17:09:15] [config] transformer-preprocess: ""
[2023-07-05 17:09:15] [config] transformer-tied-layers:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] transformer-train-position-embeddings: false
[2023-07-05 17:09:15] [config] tsv: false
[2023-07-05 17:09:15] [config] tsv-fields: 0
[2023-07-05 17:09:15] [config] type: transformer
[2023-07-05 17:09:15] [config] ulr: false
[2023-07-05 17:09:15] [config] ulr-dim-emb: 0
[2023-07-05 17:09:15] [config] ulr-dropout: 0
[2023-07-05 17:09:15] [config] ulr-keys-vectors: ""
[2023-07-05 17:09:15] [config] ulr-query-vectors: ""
[2023-07-05 17:09:15] [config] ulr-softmax-temperature: 1
[2023-07-05 17:09:15] [config] ulr-trainable-transformation: false
[2023-07-05 17:09:15] [config] unlikelihood-loss: false
[2023-07-05 17:09:15] [config] valid-freq: 50000000
[2023-07-05 17:09:15] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:09:15] [config] valid-max-length: 1000
[2023-07-05 17:09:15] [config] valid-metrics:
[2023-07-05 17:09:15] [config]   - cross-entropy
[2023-07-05 17:09:15] [config]   - translation
[2023-07-05 17:09:15] [config] valid-mini-batch: 32
[2023-07-05 17:09:15] [config] valid-reset-stalled: false
[2023-07-05 17:09:15] [config] valid-script-args:
[2023-07-05 17:09:15] [config]   []
[2023-07-05 17:09:15] [config] valid-script-path: ""
[2023-07-05 17:09:15] [config] valid-sets:
[2023-07-05 17:09:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:09:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:09:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:09:15] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:09:15] [config] vocabs:
[2023-07-05 17:09:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:09:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:09:15] [config] word-penalty: 0
[2023-07-05 17:09:15] [config] word-scores: false
[2023-07-05 17:09:15] [config] workspace: 2048
[2023-07-05 17:09:15] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:09:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:09:15] [training] Using single-device training
[2023-07-05 17:09:18] Synced seed 1234
[2023-07-05 17:09:18] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:09:18] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:09:18] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:09:18] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:09:18] [valid] No post-processing script given for validating translator
[2023-07-05 17:09:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:09:19] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:09:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:09:19] [comm] Using global sharding
[2023-07-05 17:09:19] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:09:19] [training] Using 1 GPUs
[2023-07-05 17:09:19] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:09:21] Loading Adam parameters
[2023-07-05 17:09:21] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:09:21] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:09:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:09:21] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-07-05 17:09:21] [data] Shuffling data
[2023-07-05 17:09:21] [data] Done reading 20,192 sentences
[2023-07-05 17:09:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:09:21] Training started
[2023-07-05 17:09:22] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-05 17:09:22] [logits] Applying loss function for 1 factor(s)
[2023-07-05 17:09:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-05 17:09:22] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:09:22] Parameter type float32, optimization type float32, casting types false
[2023-07-05 17:09:45] Seen 18,843 samples
[2023-07-05 17:09:45] Starting data epoch 102 in logical epoch 102
[2023-07-05 17:09:45] [data] Shuffling data
[2023-07-05 17:09:45] [data] Done reading 20,192 sentences
[2023-07-05 17:09:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:09:49] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.00509088 * 931,515 @ 1,519 after 27,954,966 : Time 31.35s : 29714.40 words/s : gNorm 0.2851
[2023-07-05 17:09:49] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:09:52] Saving Adam parameters
[2023-07-05 17:09:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:10:24] Seen 18,843 samples
[2023-07-05 17:10:24] Starting data epoch 103 in logical epoch 103
[2023-07-05 17:10:24] [data] Shuffling data
[2023-07-05 17:10:24] [data] Done reading 20,192 sentences
[2023-07-05 17:10:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:10:59] Seen 18,843 samples
[2023-07-05 17:10:59] Starting data epoch 104 in logical epoch 104
[2023-07-05 17:10:59] [data] Shuffling data
[2023-07-05 17:10:59] [data] Done reading 20,192 sentences
[2023-07-05 17:10:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:11:32] Seen 18,843 samples
[2023-07-05 17:11:32] Starting data epoch 105 in logical epoch 105
[2023-07-05 17:11:32] [data] Shuffling data
[2023-07-05 17:11:32] [data] Done reading 20,192 sentences
[2023-07-05 17:11:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:11:50] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.00537061 * 932,338 @ 1,024 after 28,887,304 : Time 120.70s : 7724.55 words/s : gNorm 0.3342
[2023-07-05 17:12:06] Seen 18,843 samples
[2023-07-05 17:12:06] Starting data epoch 106 in logical epoch 106
[2023-07-05 17:12:06] [data] Shuffling data
[2023-07-05 17:12:06] [data] Done reading 20,192 sentences
[2023-07-05 17:12:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:12:44] Seen 18,843 samples
[2023-07-05 17:12:44] Starting data epoch 107 in logical epoch 107
[2023-07-05 17:12:44] [data] Shuffling data
[2023-07-05 17:12:44] [data] Done reading 20,192 sentences
[2023-07-05 17:12:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:13:20] Seen 18,843 samples
[2023-07-05 17:13:20] Starting data epoch 108 in logical epoch 108
[2023-07-05 17:13:20] [data] Shuffling data
[2023-07-05 17:13:20] [data] Done reading 20,192 sentences
[2023-07-05 17:13:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:13:50] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.00512118 * 924,374 @ 640 after 29,811,678 : Time 120.16s : 7693.02 words/s : gNorm 0.3084
[2023-07-05 17:13:54] Seen 18,843 samples
[2023-07-05 17:13:54] Starting data epoch 109 in logical epoch 109
[2023-07-05 17:13:54] [data] Shuffling data
[2023-07-05 17:13:54] [data] Done reading 20,192 sentences
[2023-07-05 17:13:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:14:32] Seen 18,843 samples
[2023-07-05 17:14:32] Starting data epoch 110 in logical epoch 110
[2023-07-05 17:14:32] [data] Shuffling data
[2023-07-05 17:14:32] [data] Done reading 20,192 sentences
[2023-07-05 17:14:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:15:08] Seen 18,843 samples
[2023-07-05 17:15:08] Starting data epoch 111 in logical epoch 111
[2023-07-05 17:15:08] Training finished
[2023-07-05 17:15:12] [valid] Ep. 111 : Up. 32628 : cross-entropy : 149.714 : stalled 10 times (last best: 99.3721)
[2023-07-05 17:17:04] [valid] Ep. 111 : Up. 32628 : translation : 0 : new best
[2023-07-05 17:17:04] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:09] Saving Adam parameters
[2023-07-05 17:17:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:17:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:22] [marian] Running on node22.datos.cluster.uy as process 15573 with command line:
[2023-07-05 17:17:22] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:17:22] [config] after: 0e
[2023-07-05 17:17:22] [config] after-batches: 0
[2023-07-05 17:17:22] [config] after-epochs: 120
[2023-07-05 17:17:22] [config] all-caps-every: 0
[2023-07-05 17:17:22] [config] allow-unk: false
[2023-07-05 17:17:22] [config] authors: false
[2023-07-05 17:17:22] [config] beam-size: 12
[2023-07-05 17:17:22] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:17:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:17:22] [config] bert-masking-fraction: 0.15
[2023-07-05 17:17:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:17:22] [config] bert-train-type-embeddings: true
[2023-07-05 17:17:22] [config] bert-type-vocab-size: 2
[2023-07-05 17:17:22] [config] build-info: ""
[2023-07-05 17:17:22] [config] check-gradient-nan: false
[2023-07-05 17:17:22] [config] check-nan: false
[2023-07-05 17:17:22] [config] cite: false
[2023-07-05 17:17:22] [config] clip-norm: 1
[2023-07-05 17:17:22] [config] cost-scaling:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] cost-type: ce-sum
[2023-07-05 17:17:22] [config] cpu-threads: 0
[2023-07-05 17:17:22] [config] data-threads: 8
[2023-07-05 17:17:22] [config] data-weighting: ""
[2023-07-05 17:17:22] [config] data-weighting-type: sentence
[2023-07-05 17:17:22] [config] dec-cell: gru
[2023-07-05 17:17:22] [config] dec-cell-base-depth: 2
[2023-07-05 17:17:22] [config] dec-cell-high-depth: 1
[2023-07-05 17:17:22] [config] dec-depth: 1
[2023-07-05 17:17:22] [config] devices:
[2023-07-05 17:17:22] [config]   - 0
[2023-07-05 17:17:22] [config] dim-emb: 512
[2023-07-05 17:17:22] [config] dim-rnn: 1024
[2023-07-05 17:17:22] [config] dim-vocabs:
[2023-07-05 17:17:22] [config]   - 36507
[2023-07-05 17:17:22] [config]   - 54042
[2023-07-05 17:17:22] [config] disp-first: 0
[2023-07-05 17:17:22] [config] disp-freq: 1000u
[2023-07-05 17:17:22] [config] disp-label-counts: true
[2023-07-05 17:17:22] [config] dropout-rnn: 0
[2023-07-05 17:17:22] [config] dropout-src: 0
[2023-07-05 17:17:22] [config] dropout-trg: 0
[2023-07-05 17:17:22] [config] dump-config: ""
[2023-07-05 17:17:22] [config] dynamic-gradient-scaling:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] early-stopping: 10
[2023-07-05 17:17:22] [config] early-stopping-on: first
[2023-07-05 17:17:22] [config] embedding-fix-src: false
[2023-07-05 17:17:22] [config] embedding-fix-trg: false
[2023-07-05 17:17:22] [config] embedding-normalization: false
[2023-07-05 17:17:22] [config] embedding-vectors:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] enc-cell: gru
[2023-07-05 17:17:22] [config] enc-cell-depth: 1
[2023-07-05 17:17:22] [config] enc-depth: 1
[2023-07-05 17:17:22] [config] enc-type: bidirectional
[2023-07-05 17:17:22] [config] english-title-case-every: 0
[2023-07-05 17:17:22] [config] exponential-smoothing: 0
[2023-07-05 17:17:22] [config] factor-weight: 1
[2023-07-05 17:17:22] [config] factors-combine: sum
[2023-07-05 17:17:22] [config] factors-dim-emb: 0
[2023-07-05 17:17:22] [config] gradient-checkpointing: false
[2023-07-05 17:17:22] [config] gradient-norm-average-window: 100
[2023-07-05 17:17:22] [config] guided-alignment: none
[2023-07-05 17:17:22] [config] guided-alignment-cost: mse
[2023-07-05 17:17:22] [config] guided-alignment-weight: 0.1
[2023-07-05 17:17:22] [config] ignore-model-config: false
[2023-07-05 17:17:22] [config] input-types:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] interpolate-env-vars: false
[2023-07-05 17:17:22] [config] keep-best: false
[2023-07-05 17:17:22] [config] label-smoothing: 0
[2023-07-05 17:17:22] [config] layer-normalization: false
[2023-07-05 17:17:22] [config] learn-rate: 0.0001
[2023-07-05 17:17:22] [config] lemma-dependency: ""
[2023-07-05 17:17:22] [config] lemma-dim-emb: 0
[2023-07-05 17:17:22] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:17:22] [config] log-level: info
[2023-07-05 17:17:22] [config] log-time-zone: ""
[2023-07-05 17:17:22] [config] logical-epoch:
[2023-07-05 17:17:22] [config]   - 1e
[2023-07-05 17:17:22] [config]   - 0
[2023-07-05 17:17:22] [config] lr-decay: 0
[2023-07-05 17:17:22] [config] lr-decay-freq: 50000
[2023-07-05 17:17:22] [config] lr-decay-inv-sqrt:
[2023-07-05 17:17:22] [config]   - 0
[2023-07-05 17:17:22] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:17:22] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:17:22] [config] lr-decay-start:
[2023-07-05 17:17:22] [config]   - 10
[2023-07-05 17:17:22] [config]   - 1
[2023-07-05 17:17:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:17:22] [config] lr-report: false
[2023-07-05 17:17:22] [config] lr-warmup: 0
[2023-07-05 17:17:22] [config] lr-warmup-at-reload: false
[2023-07-05 17:17:22] [config] lr-warmup-cycle: false
[2023-07-05 17:17:22] [config] lr-warmup-start-rate: 0
[2023-07-05 17:17:22] [config] max-length: 50
[2023-07-05 17:17:22] [config] max-length-crop: false
[2023-07-05 17:17:22] [config] max-length-factor: 3
[2023-07-05 17:17:22] [config] maxi-batch: 100
[2023-07-05 17:17:22] [config] maxi-batch-sort: trg
[2023-07-05 17:17:22] [config] mini-batch: 64
[2023-07-05 17:17:22] [config] mini-batch-fit: false
[2023-07-05 17:17:22] [config] mini-batch-fit-step: 10
[2023-07-05 17:17:22] [config] mini-batch-round-up: true
[2023-07-05 17:17:22] [config] mini-batch-track-lr: false
[2023-07-05 17:17:22] [config] mini-batch-warmup: 0
[2023-07-05 17:17:22] [config] mini-batch-words: 0
[2023-07-05 17:17:22] [config] mini-batch-words-ref: 0
[2023-07-05 17:17:22] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:22] [config] multi-loss-type: sum
[2023-07-05 17:17:22] [config] n-best: false
[2023-07-05 17:17:22] [config] no-nccl: false
[2023-07-05 17:17:22] [config] no-reload: false
[2023-07-05 17:17:22] [config] no-restore-corpus: false
[2023-07-05 17:17:22] [config] normalize: 0
[2023-07-05 17:17:22] [config] normalize-gradient: false
[2023-07-05 17:17:22] [config] num-devices: 0
[2023-07-05 17:17:22] [config] optimizer: adam
[2023-07-05 17:17:22] [config] optimizer-delay: 1
[2023-07-05 17:17:22] [config] optimizer-params:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] output-omit-bias: false
[2023-07-05 17:17:22] [config] overwrite: true
[2023-07-05 17:17:22] [config] precision:
[2023-07-05 17:17:22] [config]   - float32
[2023-07-05 17:17:22] [config]   - float32
[2023-07-05 17:17:22] [config] pretrained-model: ""
[2023-07-05 17:17:22] [config] quantize-biases: false
[2023-07-05 17:17:22] [config] quantize-bits: 0
[2023-07-05 17:17:22] [config] quantize-log-based: false
[2023-07-05 17:17:22] [config] quantize-optimization-steps: 0
[2023-07-05 17:17:22] [config] quiet: false
[2023-07-05 17:17:22] [config] quiet-translation: true
[2023-07-05 17:17:22] [config] relative-paths: false
[2023-07-05 17:17:22] [config] right-left: false
[2023-07-05 17:17:22] [config] save-freq: 10000u
[2023-07-05 17:17:22] [config] seed: 1234
[2023-07-05 17:17:22] [config] sentencepiece-alphas:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:17:22] [config] sentencepiece-options: ""
[2023-07-05 17:17:22] [config] sharding: global
[2023-07-05 17:17:22] [config] shuffle: data
[2023-07-05 17:17:22] [config] shuffle-in-ram: false
[2023-07-05 17:17:22] [config] sigterm: save-and-exit
[2023-07-05 17:17:22] [config] skip: false
[2023-07-05 17:17:22] [config] sqlite: ""
[2023-07-05 17:17:22] [config] sqlite-drop: false
[2023-07-05 17:17:22] [config] sync-freq: 200u
[2023-07-05 17:17:22] [config] sync-sgd: false
[2023-07-05 17:17:22] [config] tempdir: /tmp
[2023-07-05 17:17:22] [config] tied-embeddings: false
[2023-07-05 17:17:22] [config] tied-embeddings-all: false
[2023-07-05 17:17:22] [config] tied-embeddings-src: false
[2023-07-05 17:17:22] [config] train-embedder-rank:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] train-sets:
[2023-07-05 17:17:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:17:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:17:22] [config] transformer-aan-activation: swish
[2023-07-05 17:17:22] [config] transformer-aan-depth: 2
[2023-07-05 17:17:22] [config] transformer-aan-nogate: false
[2023-07-05 17:17:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:17:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:17:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:17:22] [config] transformer-depth-scaling: false
[2023-07-05 17:17:22] [config] transformer-dim-aan: 2048
[2023-07-05 17:17:22] [config] transformer-dim-ffn: 2048
[2023-07-05 17:17:22] [config] transformer-dropout: 0
[2023-07-05 17:17:22] [config] transformer-dropout-attention: 0
[2023-07-05 17:17:22] [config] transformer-dropout-ffn: 0
[2023-07-05 17:17:22] [config] transformer-ffn-activation: swish
[2023-07-05 17:17:22] [config] transformer-ffn-depth: 2
[2023-07-05 17:17:22] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:17:22] [config] transformer-heads: 8
[2023-07-05 17:17:22] [config] transformer-no-projection: false
[2023-07-05 17:17:22] [config] transformer-pool: false
[2023-07-05 17:17:22] [config] transformer-postprocess: dan
[2023-07-05 17:17:22] [config] transformer-postprocess-emb: d
[2023-07-05 17:17:22] [config] transformer-postprocess-top: ""
[2023-07-05 17:17:22] [config] transformer-preprocess: ""
[2023-07-05 17:17:22] [config] transformer-tied-layers:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] transformer-train-position-embeddings: false
[2023-07-05 17:17:22] [config] tsv: false
[2023-07-05 17:17:22] [config] tsv-fields: 0
[2023-07-05 17:17:22] [config] type: transformer
[2023-07-05 17:17:22] [config] ulr: false
[2023-07-05 17:17:22] [config] ulr-dim-emb: 0
[2023-07-05 17:17:22] [config] ulr-dropout: 0
[2023-07-05 17:17:22] [config] ulr-keys-vectors: ""
[2023-07-05 17:17:22] [config] ulr-query-vectors: ""
[2023-07-05 17:17:22] [config] ulr-softmax-temperature: 1
[2023-07-05 17:17:22] [config] ulr-trainable-transformation: false
[2023-07-05 17:17:22] [config] unlikelihood-loss: false
[2023-07-05 17:17:22] [config] valid-freq: 50000000
[2023-07-05 17:17:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:17:22] [config] valid-max-length: 1000
[2023-07-05 17:17:22] [config] valid-metrics:
[2023-07-05 17:17:22] [config]   - cross-entropy
[2023-07-05 17:17:22] [config]   - translation
[2023-07-05 17:17:22] [config] valid-mini-batch: 32
[2023-07-05 17:17:22] [config] valid-reset-stalled: false
[2023-07-05 17:17:22] [config] valid-script-args:
[2023-07-05 17:17:22] [config]   []
[2023-07-05 17:17:22] [config] valid-script-path: ""
[2023-07-05 17:17:22] [config] valid-sets:
[2023-07-05 17:17:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:17:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:17:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:17:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:22] [config] vocabs:
[2023-07-05 17:17:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:22] [config] word-penalty: 0
[2023-07-05 17:17:22] [config] word-scores: false
[2023-07-05 17:17:22] [config] workspace: 2048
[2023-07-05 17:17:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:22] [training] Using single-device training
[2023-07-05 17:17:23] Synced seed 1234
[2023-07-05 17:17:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:23] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:17:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:23] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:17:23] [valid] No post-processing script given for validating translator
[2023-07-05 17:17:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:24] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:17:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:17:24] [comm] Using global sharding
[2023-07-05 17:17:24] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:17:24] [training] Using 1 GPUs
[2023-07-05 17:17:24] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:27] Loading Adam parameters
[2023-07-05 17:17:27] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:17:27] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:17:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:17:27] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:17:27] [data] Shuffling data
[2023-07-05 17:17:27] [data] Done reading 20,192 sentences
[2023-07-05 17:17:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:17:27] Training started
[2023-07-05 17:17:27] Training finished
[2023-07-05 17:17:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:30] [marian] Running on node22.datos.cluster.uy as process 15735 with command line:
[2023-07-05 17:17:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:17:30] [config] after: 0e
[2023-07-05 17:17:30] [config] after-batches: 0
[2023-07-05 17:17:30] [config] after-epochs: 130
[2023-07-05 17:17:30] [config] all-caps-every: 0
[2023-07-05 17:17:30] [config] allow-unk: false
[2023-07-05 17:17:30] [config] authors: false
[2023-07-05 17:17:30] [config] beam-size: 12
[2023-07-05 17:17:30] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:17:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:17:30] [config] bert-masking-fraction: 0.15
[2023-07-05 17:17:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:17:30] [config] bert-train-type-embeddings: true
[2023-07-05 17:17:30] [config] bert-type-vocab-size: 2
[2023-07-05 17:17:30] [config] build-info: ""
[2023-07-05 17:17:30] [config] check-gradient-nan: false
[2023-07-05 17:17:30] [config] check-nan: false
[2023-07-05 17:17:30] [config] cite: false
[2023-07-05 17:17:30] [config] clip-norm: 1
[2023-07-05 17:17:30] [config] cost-scaling:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] cost-type: ce-sum
[2023-07-05 17:17:30] [config] cpu-threads: 0
[2023-07-05 17:17:30] [config] data-threads: 8
[2023-07-05 17:17:30] [config] data-weighting: ""
[2023-07-05 17:17:30] [config] data-weighting-type: sentence
[2023-07-05 17:17:30] [config] dec-cell: gru
[2023-07-05 17:17:30] [config] dec-cell-base-depth: 2
[2023-07-05 17:17:30] [config] dec-cell-high-depth: 1
[2023-07-05 17:17:30] [config] dec-depth: 1
[2023-07-05 17:17:30] [config] devices:
[2023-07-05 17:17:30] [config]   - 0
[2023-07-05 17:17:30] [config] dim-emb: 512
[2023-07-05 17:17:30] [config] dim-rnn: 1024
[2023-07-05 17:17:30] [config] dim-vocabs:
[2023-07-05 17:17:30] [config]   - 36507
[2023-07-05 17:17:30] [config]   - 54042
[2023-07-05 17:17:30] [config] disp-first: 0
[2023-07-05 17:17:30] [config] disp-freq: 1000u
[2023-07-05 17:17:30] [config] disp-label-counts: true
[2023-07-05 17:17:30] [config] dropout-rnn: 0
[2023-07-05 17:17:30] [config] dropout-src: 0
[2023-07-05 17:17:30] [config] dropout-trg: 0
[2023-07-05 17:17:30] [config] dump-config: ""
[2023-07-05 17:17:30] [config] dynamic-gradient-scaling:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] early-stopping: 10
[2023-07-05 17:17:30] [config] early-stopping-on: first
[2023-07-05 17:17:30] [config] embedding-fix-src: false
[2023-07-05 17:17:30] [config] embedding-fix-trg: false
[2023-07-05 17:17:30] [config] embedding-normalization: false
[2023-07-05 17:17:30] [config] embedding-vectors:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] enc-cell: gru
[2023-07-05 17:17:30] [config] enc-cell-depth: 1
[2023-07-05 17:17:30] [config] enc-depth: 1
[2023-07-05 17:17:30] [config] enc-type: bidirectional
[2023-07-05 17:17:30] [config] english-title-case-every: 0
[2023-07-05 17:17:30] [config] exponential-smoothing: 0
[2023-07-05 17:17:30] [config] factor-weight: 1
[2023-07-05 17:17:30] [config] factors-combine: sum
[2023-07-05 17:17:30] [config] factors-dim-emb: 0
[2023-07-05 17:17:30] [config] gradient-checkpointing: false
[2023-07-05 17:17:30] [config] gradient-norm-average-window: 100
[2023-07-05 17:17:30] [config] guided-alignment: none
[2023-07-05 17:17:30] [config] guided-alignment-cost: mse
[2023-07-05 17:17:30] [config] guided-alignment-weight: 0.1
[2023-07-05 17:17:30] [config] ignore-model-config: false
[2023-07-05 17:17:30] [config] input-types:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] interpolate-env-vars: false
[2023-07-05 17:17:30] [config] keep-best: false
[2023-07-05 17:17:30] [config] label-smoothing: 0
[2023-07-05 17:17:30] [config] layer-normalization: false
[2023-07-05 17:17:30] [config] learn-rate: 0.0001
[2023-07-05 17:17:30] [config] lemma-dependency: ""
[2023-07-05 17:17:30] [config] lemma-dim-emb: 0
[2023-07-05 17:17:30] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:17:30] [config] log-level: info
[2023-07-05 17:17:30] [config] log-time-zone: ""
[2023-07-05 17:17:30] [config] logical-epoch:
[2023-07-05 17:17:30] [config]   - 1e
[2023-07-05 17:17:30] [config]   - 0
[2023-07-05 17:17:30] [config] lr-decay: 0
[2023-07-05 17:17:30] [config] lr-decay-freq: 50000
[2023-07-05 17:17:30] [config] lr-decay-inv-sqrt:
[2023-07-05 17:17:30] [config]   - 0
[2023-07-05 17:17:30] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:17:30] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:17:30] [config] lr-decay-start:
[2023-07-05 17:17:30] [config]   - 10
[2023-07-05 17:17:30] [config]   - 1
[2023-07-05 17:17:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:17:30] [config] lr-report: false
[2023-07-05 17:17:30] [config] lr-warmup: 0
[2023-07-05 17:17:30] [config] lr-warmup-at-reload: false
[2023-07-05 17:17:30] [config] lr-warmup-cycle: false
[2023-07-05 17:17:30] [config] lr-warmup-start-rate: 0
[2023-07-05 17:17:30] [config] max-length: 50
[2023-07-05 17:17:30] [config] max-length-crop: false
[2023-07-05 17:17:30] [config] max-length-factor: 3
[2023-07-05 17:17:30] [config] maxi-batch: 100
[2023-07-05 17:17:30] [config] maxi-batch-sort: trg
[2023-07-05 17:17:30] [config] mini-batch: 64
[2023-07-05 17:17:30] [config] mini-batch-fit: false
[2023-07-05 17:17:30] [config] mini-batch-fit-step: 10
[2023-07-05 17:17:30] [config] mini-batch-round-up: true
[2023-07-05 17:17:30] [config] mini-batch-track-lr: false
[2023-07-05 17:17:30] [config] mini-batch-warmup: 0
[2023-07-05 17:17:30] [config] mini-batch-words: 0
[2023-07-05 17:17:30] [config] mini-batch-words-ref: 0
[2023-07-05 17:17:30] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:30] [config] multi-loss-type: sum
[2023-07-05 17:17:30] [config] n-best: false
[2023-07-05 17:17:30] [config] no-nccl: false
[2023-07-05 17:17:30] [config] no-reload: false
[2023-07-05 17:17:30] [config] no-restore-corpus: false
[2023-07-05 17:17:30] [config] normalize: 0
[2023-07-05 17:17:30] [config] normalize-gradient: false
[2023-07-05 17:17:30] [config] num-devices: 0
[2023-07-05 17:17:30] [config] optimizer: adam
[2023-07-05 17:17:30] [config] optimizer-delay: 1
[2023-07-05 17:17:30] [config] optimizer-params:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] output-omit-bias: false
[2023-07-05 17:17:30] [config] overwrite: true
[2023-07-05 17:17:30] [config] precision:
[2023-07-05 17:17:30] [config]   - float32
[2023-07-05 17:17:30] [config]   - float32
[2023-07-05 17:17:30] [config] pretrained-model: ""
[2023-07-05 17:17:30] [config] quantize-biases: false
[2023-07-05 17:17:30] [config] quantize-bits: 0
[2023-07-05 17:17:30] [config] quantize-log-based: false
[2023-07-05 17:17:30] [config] quantize-optimization-steps: 0
[2023-07-05 17:17:30] [config] quiet: false
[2023-07-05 17:17:30] [config] quiet-translation: true
[2023-07-05 17:17:30] [config] relative-paths: false
[2023-07-05 17:17:30] [config] right-left: false
[2023-07-05 17:17:30] [config] save-freq: 10000u
[2023-07-05 17:17:30] [config] seed: 1234
[2023-07-05 17:17:30] [config] sentencepiece-alphas:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:17:30] [config] sentencepiece-options: ""
[2023-07-05 17:17:30] [config] sharding: global
[2023-07-05 17:17:30] [config] shuffle: data
[2023-07-05 17:17:30] [config] shuffle-in-ram: false
[2023-07-05 17:17:30] [config] sigterm: save-and-exit
[2023-07-05 17:17:30] [config] skip: false
[2023-07-05 17:17:30] [config] sqlite: ""
[2023-07-05 17:17:30] [config] sqlite-drop: false
[2023-07-05 17:17:30] [config] sync-freq: 200u
[2023-07-05 17:17:30] [config] sync-sgd: false
[2023-07-05 17:17:30] [config] tempdir: /tmp
[2023-07-05 17:17:30] [config] tied-embeddings: false
[2023-07-05 17:17:30] [config] tied-embeddings-all: false
[2023-07-05 17:17:30] [config] tied-embeddings-src: false
[2023-07-05 17:17:30] [config] train-embedder-rank:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] train-sets:
[2023-07-05 17:17:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:17:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:17:30] [config] transformer-aan-activation: swish
[2023-07-05 17:17:30] [config] transformer-aan-depth: 2
[2023-07-05 17:17:30] [config] transformer-aan-nogate: false
[2023-07-05 17:17:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:17:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:17:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:17:30] [config] transformer-depth-scaling: false
[2023-07-05 17:17:30] [config] transformer-dim-aan: 2048
[2023-07-05 17:17:30] [config] transformer-dim-ffn: 2048
[2023-07-05 17:17:30] [config] transformer-dropout: 0
[2023-07-05 17:17:30] [config] transformer-dropout-attention: 0
[2023-07-05 17:17:30] [config] transformer-dropout-ffn: 0
[2023-07-05 17:17:30] [config] transformer-ffn-activation: swish
[2023-07-05 17:17:30] [config] transformer-ffn-depth: 2
[2023-07-05 17:17:30] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:17:30] [config] transformer-heads: 8
[2023-07-05 17:17:30] [config] transformer-no-projection: false
[2023-07-05 17:17:30] [config] transformer-pool: false
[2023-07-05 17:17:30] [config] transformer-postprocess: dan
[2023-07-05 17:17:30] [config] transformer-postprocess-emb: d
[2023-07-05 17:17:30] [config] transformer-postprocess-top: ""
[2023-07-05 17:17:30] [config] transformer-preprocess: ""
[2023-07-05 17:17:30] [config] transformer-tied-layers:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] transformer-train-position-embeddings: false
[2023-07-05 17:17:30] [config] tsv: false
[2023-07-05 17:17:30] [config] tsv-fields: 0
[2023-07-05 17:17:30] [config] type: transformer
[2023-07-05 17:17:30] [config] ulr: false
[2023-07-05 17:17:30] [config] ulr-dim-emb: 0
[2023-07-05 17:17:30] [config] ulr-dropout: 0
[2023-07-05 17:17:30] [config] ulr-keys-vectors: ""
[2023-07-05 17:17:30] [config] ulr-query-vectors: ""
[2023-07-05 17:17:30] [config] ulr-softmax-temperature: 1
[2023-07-05 17:17:30] [config] ulr-trainable-transformation: false
[2023-07-05 17:17:30] [config] unlikelihood-loss: false
[2023-07-05 17:17:30] [config] valid-freq: 50000000
[2023-07-05 17:17:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:17:30] [config] valid-max-length: 1000
[2023-07-05 17:17:30] [config] valid-metrics:
[2023-07-05 17:17:30] [config]   - cross-entropy
[2023-07-05 17:17:30] [config]   - translation
[2023-07-05 17:17:30] [config] valid-mini-batch: 32
[2023-07-05 17:17:30] [config] valid-reset-stalled: false
[2023-07-05 17:17:30] [config] valid-script-args:
[2023-07-05 17:17:30] [config]   []
[2023-07-05 17:17:30] [config] valid-script-path: ""
[2023-07-05 17:17:30] [config] valid-sets:
[2023-07-05 17:17:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:17:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:17:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:17:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:30] [config] vocabs:
[2023-07-05 17:17:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:30] [config] word-penalty: 0
[2023-07-05 17:17:30] [config] word-scores: false
[2023-07-05 17:17:30] [config] workspace: 2048
[2023-07-05 17:17:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:30] [training] Using single-device training
[2023-07-05 17:17:32] Synced seed 1234
[2023-07-05 17:17:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:32] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:17:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:32] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:17:32] [valid] No post-processing script given for validating translator
[2023-07-05 17:17:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:33] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:17:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:17:33] [comm] Using global sharding
[2023-07-05 17:17:33] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:17:33] [training] Using 1 GPUs
[2023-07-05 17:17:33] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:34] Loading Adam parameters
[2023-07-05 17:17:35] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:17:35] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:17:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:17:35] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:17:35] [data] Shuffling data
[2023-07-05 17:17:35] [data] Done reading 20,192 sentences
[2023-07-05 17:17:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:17:35] Training started
[2023-07-05 17:17:35] Training finished
[2023-07-05 17:17:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:38] [marian] Running on node22.datos.cluster.uy as process 15905 with command line:
[2023-07-05 17:17:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:17:38] [config] after: 0e
[2023-07-05 17:17:38] [config] after-batches: 0
[2023-07-05 17:17:38] [config] after-epochs: 140
[2023-07-05 17:17:38] [config] all-caps-every: 0
[2023-07-05 17:17:38] [config] allow-unk: false
[2023-07-05 17:17:38] [config] authors: false
[2023-07-05 17:17:38] [config] beam-size: 12
[2023-07-05 17:17:38] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:17:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:17:38] [config] bert-masking-fraction: 0.15
[2023-07-05 17:17:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:17:38] [config] bert-train-type-embeddings: true
[2023-07-05 17:17:38] [config] bert-type-vocab-size: 2
[2023-07-05 17:17:38] [config] build-info: ""
[2023-07-05 17:17:38] [config] check-gradient-nan: false
[2023-07-05 17:17:38] [config] check-nan: false
[2023-07-05 17:17:38] [config] cite: false
[2023-07-05 17:17:38] [config] clip-norm: 1
[2023-07-05 17:17:38] [config] cost-scaling:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] cost-type: ce-sum
[2023-07-05 17:17:38] [config] cpu-threads: 0
[2023-07-05 17:17:38] [config] data-threads: 8
[2023-07-05 17:17:38] [config] data-weighting: ""
[2023-07-05 17:17:38] [config] data-weighting-type: sentence
[2023-07-05 17:17:38] [config] dec-cell: gru
[2023-07-05 17:17:38] [config] dec-cell-base-depth: 2
[2023-07-05 17:17:38] [config] dec-cell-high-depth: 1
[2023-07-05 17:17:38] [config] dec-depth: 1
[2023-07-05 17:17:38] [config] devices:
[2023-07-05 17:17:38] [config]   - 0
[2023-07-05 17:17:38] [config] dim-emb: 512
[2023-07-05 17:17:38] [config] dim-rnn: 1024
[2023-07-05 17:17:38] [config] dim-vocabs:
[2023-07-05 17:17:38] [config]   - 36507
[2023-07-05 17:17:38] [config]   - 54042
[2023-07-05 17:17:38] [config] disp-first: 0
[2023-07-05 17:17:38] [config] disp-freq: 1000u
[2023-07-05 17:17:38] [config] disp-label-counts: true
[2023-07-05 17:17:38] [config] dropout-rnn: 0
[2023-07-05 17:17:38] [config] dropout-src: 0
[2023-07-05 17:17:38] [config] dropout-trg: 0
[2023-07-05 17:17:38] [config] dump-config: ""
[2023-07-05 17:17:38] [config] dynamic-gradient-scaling:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] early-stopping: 10
[2023-07-05 17:17:38] [config] early-stopping-on: first
[2023-07-05 17:17:38] [config] embedding-fix-src: false
[2023-07-05 17:17:38] [config] embedding-fix-trg: false
[2023-07-05 17:17:38] [config] embedding-normalization: false
[2023-07-05 17:17:38] [config] embedding-vectors:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] enc-cell: gru
[2023-07-05 17:17:38] [config] enc-cell-depth: 1
[2023-07-05 17:17:38] [config] enc-depth: 1
[2023-07-05 17:17:38] [config] enc-type: bidirectional
[2023-07-05 17:17:38] [config] english-title-case-every: 0
[2023-07-05 17:17:38] [config] exponential-smoothing: 0
[2023-07-05 17:17:38] [config] factor-weight: 1
[2023-07-05 17:17:38] [config] factors-combine: sum
[2023-07-05 17:17:38] [config] factors-dim-emb: 0
[2023-07-05 17:17:38] [config] gradient-checkpointing: false
[2023-07-05 17:17:38] [config] gradient-norm-average-window: 100
[2023-07-05 17:17:38] [config] guided-alignment: none
[2023-07-05 17:17:38] [config] guided-alignment-cost: mse
[2023-07-05 17:17:38] [config] guided-alignment-weight: 0.1
[2023-07-05 17:17:38] [config] ignore-model-config: false
[2023-07-05 17:17:38] [config] input-types:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] interpolate-env-vars: false
[2023-07-05 17:17:38] [config] keep-best: false
[2023-07-05 17:17:38] [config] label-smoothing: 0
[2023-07-05 17:17:38] [config] layer-normalization: false
[2023-07-05 17:17:38] [config] learn-rate: 0.0001
[2023-07-05 17:17:38] [config] lemma-dependency: ""
[2023-07-05 17:17:38] [config] lemma-dim-emb: 0
[2023-07-05 17:17:38] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:17:38] [config] log-level: info
[2023-07-05 17:17:38] [config] log-time-zone: ""
[2023-07-05 17:17:38] [config] logical-epoch:
[2023-07-05 17:17:38] [config]   - 1e
[2023-07-05 17:17:38] [config]   - 0
[2023-07-05 17:17:38] [config] lr-decay: 0
[2023-07-05 17:17:38] [config] lr-decay-freq: 50000
[2023-07-05 17:17:38] [config] lr-decay-inv-sqrt:
[2023-07-05 17:17:38] [config]   - 0
[2023-07-05 17:17:38] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:17:38] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:17:38] [config] lr-decay-start:
[2023-07-05 17:17:38] [config]   - 10
[2023-07-05 17:17:38] [config]   - 1
[2023-07-05 17:17:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:17:38] [config] lr-report: false
[2023-07-05 17:17:38] [config] lr-warmup: 0
[2023-07-05 17:17:38] [config] lr-warmup-at-reload: false
[2023-07-05 17:17:38] [config] lr-warmup-cycle: false
[2023-07-05 17:17:38] [config] lr-warmup-start-rate: 0
[2023-07-05 17:17:38] [config] max-length: 50
[2023-07-05 17:17:38] [config] max-length-crop: false
[2023-07-05 17:17:38] [config] max-length-factor: 3
[2023-07-05 17:17:38] [config] maxi-batch: 100
[2023-07-05 17:17:38] [config] maxi-batch-sort: trg
[2023-07-05 17:17:38] [config] mini-batch: 64
[2023-07-05 17:17:38] [config] mini-batch-fit: false
[2023-07-05 17:17:38] [config] mini-batch-fit-step: 10
[2023-07-05 17:17:38] [config] mini-batch-round-up: true
[2023-07-05 17:17:38] [config] mini-batch-track-lr: false
[2023-07-05 17:17:38] [config] mini-batch-warmup: 0
[2023-07-05 17:17:38] [config] mini-batch-words: 0
[2023-07-05 17:17:38] [config] mini-batch-words-ref: 0
[2023-07-05 17:17:38] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:38] [config] multi-loss-type: sum
[2023-07-05 17:17:38] [config] n-best: false
[2023-07-05 17:17:38] [config] no-nccl: false
[2023-07-05 17:17:38] [config] no-reload: false
[2023-07-05 17:17:38] [config] no-restore-corpus: false
[2023-07-05 17:17:38] [config] normalize: 0
[2023-07-05 17:17:38] [config] normalize-gradient: false
[2023-07-05 17:17:38] [config] num-devices: 0
[2023-07-05 17:17:38] [config] optimizer: adam
[2023-07-05 17:17:38] [config] optimizer-delay: 1
[2023-07-05 17:17:38] [config] optimizer-params:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] output-omit-bias: false
[2023-07-05 17:17:38] [config] overwrite: true
[2023-07-05 17:17:38] [config] precision:
[2023-07-05 17:17:38] [config]   - float32
[2023-07-05 17:17:38] [config]   - float32
[2023-07-05 17:17:38] [config] pretrained-model: ""
[2023-07-05 17:17:38] [config] quantize-biases: false
[2023-07-05 17:17:38] [config] quantize-bits: 0
[2023-07-05 17:17:38] [config] quantize-log-based: false
[2023-07-05 17:17:38] [config] quantize-optimization-steps: 0
[2023-07-05 17:17:38] [config] quiet: false
[2023-07-05 17:17:38] [config] quiet-translation: true
[2023-07-05 17:17:38] [config] relative-paths: false
[2023-07-05 17:17:38] [config] right-left: false
[2023-07-05 17:17:38] [config] save-freq: 10000u
[2023-07-05 17:17:38] [config] seed: 1234
[2023-07-05 17:17:38] [config] sentencepiece-alphas:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:17:38] [config] sentencepiece-options: ""
[2023-07-05 17:17:38] [config] sharding: global
[2023-07-05 17:17:38] [config] shuffle: data
[2023-07-05 17:17:38] [config] shuffle-in-ram: false
[2023-07-05 17:17:38] [config] sigterm: save-and-exit
[2023-07-05 17:17:38] [config] skip: false
[2023-07-05 17:17:38] [config] sqlite: ""
[2023-07-05 17:17:38] [config] sqlite-drop: false
[2023-07-05 17:17:38] [config] sync-freq: 200u
[2023-07-05 17:17:38] [config] sync-sgd: false
[2023-07-05 17:17:38] [config] tempdir: /tmp
[2023-07-05 17:17:38] [config] tied-embeddings: false
[2023-07-05 17:17:38] [config] tied-embeddings-all: false
[2023-07-05 17:17:38] [config] tied-embeddings-src: false
[2023-07-05 17:17:38] [config] train-embedder-rank:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] train-sets:
[2023-07-05 17:17:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:17:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:17:38] [config] transformer-aan-activation: swish
[2023-07-05 17:17:38] [config] transformer-aan-depth: 2
[2023-07-05 17:17:38] [config] transformer-aan-nogate: false
[2023-07-05 17:17:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:17:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:17:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:17:38] [config] transformer-depth-scaling: false
[2023-07-05 17:17:38] [config] transformer-dim-aan: 2048
[2023-07-05 17:17:38] [config] transformer-dim-ffn: 2048
[2023-07-05 17:17:38] [config] transformer-dropout: 0
[2023-07-05 17:17:38] [config] transformer-dropout-attention: 0
[2023-07-05 17:17:38] [config] transformer-dropout-ffn: 0
[2023-07-05 17:17:38] [config] transformer-ffn-activation: swish
[2023-07-05 17:17:38] [config] transformer-ffn-depth: 2
[2023-07-05 17:17:38] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:17:38] [config] transformer-heads: 8
[2023-07-05 17:17:38] [config] transformer-no-projection: false
[2023-07-05 17:17:38] [config] transformer-pool: false
[2023-07-05 17:17:38] [config] transformer-postprocess: dan
[2023-07-05 17:17:38] [config] transformer-postprocess-emb: d
[2023-07-05 17:17:38] [config] transformer-postprocess-top: ""
[2023-07-05 17:17:38] [config] transformer-preprocess: ""
[2023-07-05 17:17:38] [config] transformer-tied-layers:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] transformer-train-position-embeddings: false
[2023-07-05 17:17:38] [config] tsv: false
[2023-07-05 17:17:38] [config] tsv-fields: 0
[2023-07-05 17:17:38] [config] type: transformer
[2023-07-05 17:17:38] [config] ulr: false
[2023-07-05 17:17:38] [config] ulr-dim-emb: 0
[2023-07-05 17:17:38] [config] ulr-dropout: 0
[2023-07-05 17:17:38] [config] ulr-keys-vectors: ""
[2023-07-05 17:17:38] [config] ulr-query-vectors: ""
[2023-07-05 17:17:38] [config] ulr-softmax-temperature: 1
[2023-07-05 17:17:38] [config] ulr-trainable-transformation: false
[2023-07-05 17:17:38] [config] unlikelihood-loss: false
[2023-07-05 17:17:38] [config] valid-freq: 50000000
[2023-07-05 17:17:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:17:38] [config] valid-max-length: 1000
[2023-07-05 17:17:38] [config] valid-metrics:
[2023-07-05 17:17:38] [config]   - cross-entropy
[2023-07-05 17:17:38] [config]   - translation
[2023-07-05 17:17:38] [config] valid-mini-batch: 32
[2023-07-05 17:17:38] [config] valid-reset-stalled: false
[2023-07-05 17:17:38] [config] valid-script-args:
[2023-07-05 17:17:38] [config]   []
[2023-07-05 17:17:38] [config] valid-script-path: ""
[2023-07-05 17:17:38] [config] valid-sets:
[2023-07-05 17:17:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:17:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:17:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:17:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:38] [config] vocabs:
[2023-07-05 17:17:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:38] [config] word-penalty: 0
[2023-07-05 17:17:38] [config] word-scores: false
[2023-07-05 17:17:38] [config] workspace: 2048
[2023-07-05 17:17:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:38] [training] Using single-device training
[2023-07-05 17:17:39] Synced seed 1234
[2023-07-05 17:17:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:39] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:17:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:39] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:17:39] [valid] No post-processing script given for validating translator
[2023-07-05 17:17:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:40] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:17:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:17:40] [comm] Using global sharding
[2023-07-05 17:17:40] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:17:40] [training] Using 1 GPUs
[2023-07-05 17:17:40] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:41] Loading Adam parameters
[2023-07-05 17:17:42] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:17:42] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:17:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:17:42] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:17:42] [data] Shuffling data
[2023-07-05 17:17:42] [data] Done reading 20,192 sentences
[2023-07-05 17:17:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:17:42] Training started
[2023-07-05 17:17:42] Training finished
[2023-07-05 17:17:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:45] [marian] Running on node22.datos.cluster.uy as process 16062 with command line:
[2023-07-05 17:17:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:17:45] [config] after: 0e
[2023-07-05 17:17:45] [config] after-batches: 0
[2023-07-05 17:17:45] [config] after-epochs: 150
[2023-07-05 17:17:45] [config] all-caps-every: 0
[2023-07-05 17:17:45] [config] allow-unk: false
[2023-07-05 17:17:45] [config] authors: false
[2023-07-05 17:17:45] [config] beam-size: 12
[2023-07-05 17:17:45] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:17:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:17:45] [config] bert-masking-fraction: 0.15
[2023-07-05 17:17:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:17:45] [config] bert-train-type-embeddings: true
[2023-07-05 17:17:45] [config] bert-type-vocab-size: 2
[2023-07-05 17:17:45] [config] build-info: ""
[2023-07-05 17:17:45] [config] check-gradient-nan: false
[2023-07-05 17:17:45] [config] check-nan: false
[2023-07-05 17:17:45] [config] cite: false
[2023-07-05 17:17:45] [config] clip-norm: 1
[2023-07-05 17:17:45] [config] cost-scaling:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] cost-type: ce-sum
[2023-07-05 17:17:45] [config] cpu-threads: 0
[2023-07-05 17:17:45] [config] data-threads: 8
[2023-07-05 17:17:45] [config] data-weighting: ""
[2023-07-05 17:17:45] [config] data-weighting-type: sentence
[2023-07-05 17:17:45] [config] dec-cell: gru
[2023-07-05 17:17:45] [config] dec-cell-base-depth: 2
[2023-07-05 17:17:45] [config] dec-cell-high-depth: 1
[2023-07-05 17:17:45] [config] dec-depth: 1
[2023-07-05 17:17:45] [config] devices:
[2023-07-05 17:17:45] [config]   - 0
[2023-07-05 17:17:45] [config] dim-emb: 512
[2023-07-05 17:17:45] [config] dim-rnn: 1024
[2023-07-05 17:17:45] [config] dim-vocabs:
[2023-07-05 17:17:45] [config]   - 36507
[2023-07-05 17:17:45] [config]   - 54042
[2023-07-05 17:17:45] [config] disp-first: 0
[2023-07-05 17:17:45] [config] disp-freq: 1000u
[2023-07-05 17:17:45] [config] disp-label-counts: true
[2023-07-05 17:17:45] [config] dropout-rnn: 0
[2023-07-05 17:17:45] [config] dropout-src: 0
[2023-07-05 17:17:45] [config] dropout-trg: 0
[2023-07-05 17:17:45] [config] dump-config: ""
[2023-07-05 17:17:45] [config] dynamic-gradient-scaling:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] early-stopping: 10
[2023-07-05 17:17:45] [config] early-stopping-on: first
[2023-07-05 17:17:45] [config] embedding-fix-src: false
[2023-07-05 17:17:45] [config] embedding-fix-trg: false
[2023-07-05 17:17:45] [config] embedding-normalization: false
[2023-07-05 17:17:45] [config] embedding-vectors:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] enc-cell: gru
[2023-07-05 17:17:45] [config] enc-cell-depth: 1
[2023-07-05 17:17:45] [config] enc-depth: 1
[2023-07-05 17:17:45] [config] enc-type: bidirectional
[2023-07-05 17:17:45] [config] english-title-case-every: 0
[2023-07-05 17:17:45] [config] exponential-smoothing: 0
[2023-07-05 17:17:45] [config] factor-weight: 1
[2023-07-05 17:17:45] [config] factors-combine: sum
[2023-07-05 17:17:45] [config] factors-dim-emb: 0
[2023-07-05 17:17:45] [config] gradient-checkpointing: false
[2023-07-05 17:17:45] [config] gradient-norm-average-window: 100
[2023-07-05 17:17:45] [config] guided-alignment: none
[2023-07-05 17:17:45] [config] guided-alignment-cost: mse
[2023-07-05 17:17:45] [config] guided-alignment-weight: 0.1
[2023-07-05 17:17:45] [config] ignore-model-config: false
[2023-07-05 17:17:45] [config] input-types:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] interpolate-env-vars: false
[2023-07-05 17:17:45] [config] keep-best: false
[2023-07-05 17:17:45] [config] label-smoothing: 0
[2023-07-05 17:17:45] [config] layer-normalization: false
[2023-07-05 17:17:45] [config] learn-rate: 0.0001
[2023-07-05 17:17:45] [config] lemma-dependency: ""
[2023-07-05 17:17:45] [config] lemma-dim-emb: 0
[2023-07-05 17:17:45] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:17:45] [config] log-level: info
[2023-07-05 17:17:45] [config] log-time-zone: ""
[2023-07-05 17:17:45] [config] logical-epoch:
[2023-07-05 17:17:45] [config]   - 1e
[2023-07-05 17:17:45] [config]   - 0
[2023-07-05 17:17:45] [config] lr-decay: 0
[2023-07-05 17:17:45] [config] lr-decay-freq: 50000
[2023-07-05 17:17:45] [config] lr-decay-inv-sqrt:
[2023-07-05 17:17:45] [config]   - 0
[2023-07-05 17:17:45] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:17:45] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:17:45] [config] lr-decay-start:
[2023-07-05 17:17:45] [config]   - 10
[2023-07-05 17:17:45] [config]   - 1
[2023-07-05 17:17:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:17:45] [config] lr-report: false
[2023-07-05 17:17:45] [config] lr-warmup: 0
[2023-07-05 17:17:45] [config] lr-warmup-at-reload: false
[2023-07-05 17:17:45] [config] lr-warmup-cycle: false
[2023-07-05 17:17:45] [config] lr-warmup-start-rate: 0
[2023-07-05 17:17:45] [config] max-length: 50
[2023-07-05 17:17:45] [config] max-length-crop: false
[2023-07-05 17:17:45] [config] max-length-factor: 3
[2023-07-05 17:17:45] [config] maxi-batch: 100
[2023-07-05 17:17:45] [config] maxi-batch-sort: trg
[2023-07-05 17:17:45] [config] mini-batch: 64
[2023-07-05 17:17:45] [config] mini-batch-fit: false
[2023-07-05 17:17:45] [config] mini-batch-fit-step: 10
[2023-07-05 17:17:45] [config] mini-batch-round-up: true
[2023-07-05 17:17:45] [config] mini-batch-track-lr: false
[2023-07-05 17:17:45] [config] mini-batch-warmup: 0
[2023-07-05 17:17:45] [config] mini-batch-words: 0
[2023-07-05 17:17:45] [config] mini-batch-words-ref: 0
[2023-07-05 17:17:45] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:45] [config] multi-loss-type: sum
[2023-07-05 17:17:45] [config] n-best: false
[2023-07-05 17:17:45] [config] no-nccl: false
[2023-07-05 17:17:45] [config] no-reload: false
[2023-07-05 17:17:45] [config] no-restore-corpus: false
[2023-07-05 17:17:45] [config] normalize: 0
[2023-07-05 17:17:45] [config] normalize-gradient: false
[2023-07-05 17:17:45] [config] num-devices: 0
[2023-07-05 17:17:45] [config] optimizer: adam
[2023-07-05 17:17:45] [config] optimizer-delay: 1
[2023-07-05 17:17:45] [config] optimizer-params:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] output-omit-bias: false
[2023-07-05 17:17:45] [config] overwrite: true
[2023-07-05 17:17:45] [config] precision:
[2023-07-05 17:17:45] [config]   - float32
[2023-07-05 17:17:45] [config]   - float32
[2023-07-05 17:17:45] [config] pretrained-model: ""
[2023-07-05 17:17:45] [config] quantize-biases: false
[2023-07-05 17:17:45] [config] quantize-bits: 0
[2023-07-05 17:17:45] [config] quantize-log-based: false
[2023-07-05 17:17:45] [config] quantize-optimization-steps: 0
[2023-07-05 17:17:45] [config] quiet: false
[2023-07-05 17:17:45] [config] quiet-translation: true
[2023-07-05 17:17:45] [config] relative-paths: false
[2023-07-05 17:17:45] [config] right-left: false
[2023-07-05 17:17:45] [config] save-freq: 10000u
[2023-07-05 17:17:45] [config] seed: 1234
[2023-07-05 17:17:45] [config] sentencepiece-alphas:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:17:45] [config] sentencepiece-options: ""
[2023-07-05 17:17:45] [config] sharding: global
[2023-07-05 17:17:45] [config] shuffle: data
[2023-07-05 17:17:45] [config] shuffle-in-ram: false
[2023-07-05 17:17:45] [config] sigterm: save-and-exit
[2023-07-05 17:17:45] [config] skip: false
[2023-07-05 17:17:45] [config] sqlite: ""
[2023-07-05 17:17:45] [config] sqlite-drop: false
[2023-07-05 17:17:45] [config] sync-freq: 200u
[2023-07-05 17:17:45] [config] sync-sgd: false
[2023-07-05 17:17:45] [config] tempdir: /tmp
[2023-07-05 17:17:45] [config] tied-embeddings: false
[2023-07-05 17:17:45] [config] tied-embeddings-all: false
[2023-07-05 17:17:45] [config] tied-embeddings-src: false
[2023-07-05 17:17:45] [config] train-embedder-rank:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] train-sets:
[2023-07-05 17:17:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:17:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:17:45] [config] transformer-aan-activation: swish
[2023-07-05 17:17:45] [config] transformer-aan-depth: 2
[2023-07-05 17:17:45] [config] transformer-aan-nogate: false
[2023-07-05 17:17:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:17:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:17:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:17:45] [config] transformer-depth-scaling: false
[2023-07-05 17:17:45] [config] transformer-dim-aan: 2048
[2023-07-05 17:17:45] [config] transformer-dim-ffn: 2048
[2023-07-05 17:17:45] [config] transformer-dropout: 0
[2023-07-05 17:17:45] [config] transformer-dropout-attention: 0
[2023-07-05 17:17:45] [config] transformer-dropout-ffn: 0
[2023-07-05 17:17:45] [config] transformer-ffn-activation: swish
[2023-07-05 17:17:45] [config] transformer-ffn-depth: 2
[2023-07-05 17:17:45] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:17:45] [config] transformer-heads: 8
[2023-07-05 17:17:45] [config] transformer-no-projection: false
[2023-07-05 17:17:45] [config] transformer-pool: false
[2023-07-05 17:17:45] [config] transformer-postprocess: dan
[2023-07-05 17:17:45] [config] transformer-postprocess-emb: d
[2023-07-05 17:17:45] [config] transformer-postprocess-top: ""
[2023-07-05 17:17:45] [config] transformer-preprocess: ""
[2023-07-05 17:17:45] [config] transformer-tied-layers:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] transformer-train-position-embeddings: false
[2023-07-05 17:17:45] [config] tsv: false
[2023-07-05 17:17:45] [config] tsv-fields: 0
[2023-07-05 17:17:45] [config] type: transformer
[2023-07-05 17:17:45] [config] ulr: false
[2023-07-05 17:17:45] [config] ulr-dim-emb: 0
[2023-07-05 17:17:45] [config] ulr-dropout: 0
[2023-07-05 17:17:45] [config] ulr-keys-vectors: ""
[2023-07-05 17:17:45] [config] ulr-query-vectors: ""
[2023-07-05 17:17:45] [config] ulr-softmax-temperature: 1
[2023-07-05 17:17:45] [config] ulr-trainable-transformation: false
[2023-07-05 17:17:45] [config] unlikelihood-loss: false
[2023-07-05 17:17:45] [config] valid-freq: 50000000
[2023-07-05 17:17:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:17:45] [config] valid-max-length: 1000
[2023-07-05 17:17:45] [config] valid-metrics:
[2023-07-05 17:17:45] [config]   - cross-entropy
[2023-07-05 17:17:45] [config]   - translation
[2023-07-05 17:17:45] [config] valid-mini-batch: 32
[2023-07-05 17:17:45] [config] valid-reset-stalled: false
[2023-07-05 17:17:45] [config] valid-script-args:
[2023-07-05 17:17:45] [config]   []
[2023-07-05 17:17:45] [config] valid-script-path: ""
[2023-07-05 17:17:45] [config] valid-sets:
[2023-07-05 17:17:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:17:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:17:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:17:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:45] [config] vocabs:
[2023-07-05 17:17:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:45] [config] word-penalty: 0
[2023-07-05 17:17:45] [config] word-scores: false
[2023-07-05 17:17:45] [config] workspace: 2048
[2023-07-05 17:17:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:45] [training] Using single-device training
[2023-07-05 17:17:46] Synced seed 1234
[2023-07-05 17:17:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:46] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:17:46] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:46] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:17:46] [valid] No post-processing script given for validating translator
[2023-07-05 17:17:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:47] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:17:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:17:47] [comm] Using global sharding
[2023-07-05 17:17:47] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:17:47] [training] Using 1 GPUs
[2023-07-05 17:17:47] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:48] Loading Adam parameters
[2023-07-05 17:17:48] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:17:49] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:17:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:17:49] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:17:49] [data] Shuffling data
[2023-07-05 17:17:49] [data] Done reading 20,192 sentences
[2023-07-05 17:17:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:17:49] Training started
[2023-07-05 17:17:49] Training finished
[2023-07-05 17:17:52] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:52] [marian] Running on node22.datos.cluster.uy as process 16216 with command line:
[2023-07-05 17:17:52] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:17:52] [config] after: 0e
[2023-07-05 17:17:52] [config] after-batches: 0
[2023-07-05 17:17:52] [config] after-epochs: 160
[2023-07-05 17:17:52] [config] all-caps-every: 0
[2023-07-05 17:17:52] [config] allow-unk: false
[2023-07-05 17:17:52] [config] authors: false
[2023-07-05 17:17:52] [config] beam-size: 12
[2023-07-05 17:17:52] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:17:52] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:17:52] [config] bert-masking-fraction: 0.15
[2023-07-05 17:17:52] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:17:52] [config] bert-train-type-embeddings: true
[2023-07-05 17:17:52] [config] bert-type-vocab-size: 2
[2023-07-05 17:17:52] [config] build-info: ""
[2023-07-05 17:17:52] [config] check-gradient-nan: false
[2023-07-05 17:17:52] [config] check-nan: false
[2023-07-05 17:17:52] [config] cite: false
[2023-07-05 17:17:52] [config] clip-norm: 1
[2023-07-05 17:17:52] [config] cost-scaling:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] cost-type: ce-sum
[2023-07-05 17:17:52] [config] cpu-threads: 0
[2023-07-05 17:17:52] [config] data-threads: 8
[2023-07-05 17:17:52] [config] data-weighting: ""
[2023-07-05 17:17:52] [config] data-weighting-type: sentence
[2023-07-05 17:17:52] [config] dec-cell: gru
[2023-07-05 17:17:52] [config] dec-cell-base-depth: 2
[2023-07-05 17:17:52] [config] dec-cell-high-depth: 1
[2023-07-05 17:17:52] [config] dec-depth: 1
[2023-07-05 17:17:52] [config] devices:
[2023-07-05 17:17:52] [config]   - 0
[2023-07-05 17:17:52] [config] dim-emb: 512
[2023-07-05 17:17:52] [config] dim-rnn: 1024
[2023-07-05 17:17:52] [config] dim-vocabs:
[2023-07-05 17:17:52] [config]   - 36507
[2023-07-05 17:17:52] [config]   - 54042
[2023-07-05 17:17:52] [config] disp-first: 0
[2023-07-05 17:17:52] [config] disp-freq: 1000u
[2023-07-05 17:17:52] [config] disp-label-counts: true
[2023-07-05 17:17:52] [config] dropout-rnn: 0
[2023-07-05 17:17:52] [config] dropout-src: 0
[2023-07-05 17:17:52] [config] dropout-trg: 0
[2023-07-05 17:17:52] [config] dump-config: ""
[2023-07-05 17:17:52] [config] dynamic-gradient-scaling:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] early-stopping: 10
[2023-07-05 17:17:52] [config] early-stopping-on: first
[2023-07-05 17:17:52] [config] embedding-fix-src: false
[2023-07-05 17:17:52] [config] embedding-fix-trg: false
[2023-07-05 17:17:52] [config] embedding-normalization: false
[2023-07-05 17:17:52] [config] embedding-vectors:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] enc-cell: gru
[2023-07-05 17:17:52] [config] enc-cell-depth: 1
[2023-07-05 17:17:52] [config] enc-depth: 1
[2023-07-05 17:17:52] [config] enc-type: bidirectional
[2023-07-05 17:17:52] [config] english-title-case-every: 0
[2023-07-05 17:17:52] [config] exponential-smoothing: 0
[2023-07-05 17:17:52] [config] factor-weight: 1
[2023-07-05 17:17:52] [config] factors-combine: sum
[2023-07-05 17:17:52] [config] factors-dim-emb: 0
[2023-07-05 17:17:52] [config] gradient-checkpointing: false
[2023-07-05 17:17:52] [config] gradient-norm-average-window: 100
[2023-07-05 17:17:52] [config] guided-alignment: none
[2023-07-05 17:17:52] [config] guided-alignment-cost: mse
[2023-07-05 17:17:52] [config] guided-alignment-weight: 0.1
[2023-07-05 17:17:52] [config] ignore-model-config: false
[2023-07-05 17:17:52] [config] input-types:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] interpolate-env-vars: false
[2023-07-05 17:17:52] [config] keep-best: false
[2023-07-05 17:17:52] [config] label-smoothing: 0
[2023-07-05 17:17:52] [config] layer-normalization: false
[2023-07-05 17:17:52] [config] learn-rate: 0.0001
[2023-07-05 17:17:52] [config] lemma-dependency: ""
[2023-07-05 17:17:52] [config] lemma-dim-emb: 0
[2023-07-05 17:17:52] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:17:52] [config] log-level: info
[2023-07-05 17:17:52] [config] log-time-zone: ""
[2023-07-05 17:17:52] [config] logical-epoch:
[2023-07-05 17:17:52] [config]   - 1e
[2023-07-05 17:17:52] [config]   - 0
[2023-07-05 17:17:52] [config] lr-decay: 0
[2023-07-05 17:17:52] [config] lr-decay-freq: 50000
[2023-07-05 17:17:52] [config] lr-decay-inv-sqrt:
[2023-07-05 17:17:52] [config]   - 0
[2023-07-05 17:17:52] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:17:52] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:17:52] [config] lr-decay-start:
[2023-07-05 17:17:52] [config]   - 10
[2023-07-05 17:17:52] [config]   - 1
[2023-07-05 17:17:52] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:17:52] [config] lr-report: false
[2023-07-05 17:17:52] [config] lr-warmup: 0
[2023-07-05 17:17:52] [config] lr-warmup-at-reload: false
[2023-07-05 17:17:52] [config] lr-warmup-cycle: false
[2023-07-05 17:17:52] [config] lr-warmup-start-rate: 0
[2023-07-05 17:17:52] [config] max-length: 50
[2023-07-05 17:17:52] [config] max-length-crop: false
[2023-07-05 17:17:52] [config] max-length-factor: 3
[2023-07-05 17:17:52] [config] maxi-batch: 100
[2023-07-05 17:17:52] [config] maxi-batch-sort: trg
[2023-07-05 17:17:52] [config] mini-batch: 64
[2023-07-05 17:17:52] [config] mini-batch-fit: false
[2023-07-05 17:17:52] [config] mini-batch-fit-step: 10
[2023-07-05 17:17:52] [config] mini-batch-round-up: true
[2023-07-05 17:17:52] [config] mini-batch-track-lr: false
[2023-07-05 17:17:52] [config] mini-batch-warmup: 0
[2023-07-05 17:17:52] [config] mini-batch-words: 0
[2023-07-05 17:17:52] [config] mini-batch-words-ref: 0
[2023-07-05 17:17:52] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:52] [config] multi-loss-type: sum
[2023-07-05 17:17:52] [config] n-best: false
[2023-07-05 17:17:52] [config] no-nccl: false
[2023-07-05 17:17:52] [config] no-reload: false
[2023-07-05 17:17:52] [config] no-restore-corpus: false
[2023-07-05 17:17:52] [config] normalize: 0
[2023-07-05 17:17:52] [config] normalize-gradient: false
[2023-07-05 17:17:52] [config] num-devices: 0
[2023-07-05 17:17:52] [config] optimizer: adam
[2023-07-05 17:17:52] [config] optimizer-delay: 1
[2023-07-05 17:17:52] [config] optimizer-params:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] output-omit-bias: false
[2023-07-05 17:17:52] [config] overwrite: true
[2023-07-05 17:17:52] [config] precision:
[2023-07-05 17:17:52] [config]   - float32
[2023-07-05 17:17:52] [config]   - float32
[2023-07-05 17:17:52] [config] pretrained-model: ""
[2023-07-05 17:17:52] [config] quantize-biases: false
[2023-07-05 17:17:52] [config] quantize-bits: 0
[2023-07-05 17:17:52] [config] quantize-log-based: false
[2023-07-05 17:17:52] [config] quantize-optimization-steps: 0
[2023-07-05 17:17:52] [config] quiet: false
[2023-07-05 17:17:52] [config] quiet-translation: true
[2023-07-05 17:17:52] [config] relative-paths: false
[2023-07-05 17:17:52] [config] right-left: false
[2023-07-05 17:17:52] [config] save-freq: 10000u
[2023-07-05 17:17:52] [config] seed: 1234
[2023-07-05 17:17:52] [config] sentencepiece-alphas:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:17:52] [config] sentencepiece-options: ""
[2023-07-05 17:17:52] [config] sharding: global
[2023-07-05 17:17:52] [config] shuffle: data
[2023-07-05 17:17:52] [config] shuffle-in-ram: false
[2023-07-05 17:17:52] [config] sigterm: save-and-exit
[2023-07-05 17:17:52] [config] skip: false
[2023-07-05 17:17:52] [config] sqlite: ""
[2023-07-05 17:17:52] [config] sqlite-drop: false
[2023-07-05 17:17:52] [config] sync-freq: 200u
[2023-07-05 17:17:52] [config] sync-sgd: false
[2023-07-05 17:17:52] [config] tempdir: /tmp
[2023-07-05 17:17:52] [config] tied-embeddings: false
[2023-07-05 17:17:52] [config] tied-embeddings-all: false
[2023-07-05 17:17:52] [config] tied-embeddings-src: false
[2023-07-05 17:17:52] [config] train-embedder-rank:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] train-sets:
[2023-07-05 17:17:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:17:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:17:52] [config] transformer-aan-activation: swish
[2023-07-05 17:17:52] [config] transformer-aan-depth: 2
[2023-07-05 17:17:52] [config] transformer-aan-nogate: false
[2023-07-05 17:17:52] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:17:52] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:17:52] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:17:52] [config] transformer-depth-scaling: false
[2023-07-05 17:17:52] [config] transformer-dim-aan: 2048
[2023-07-05 17:17:52] [config] transformer-dim-ffn: 2048
[2023-07-05 17:17:52] [config] transformer-dropout: 0
[2023-07-05 17:17:52] [config] transformer-dropout-attention: 0
[2023-07-05 17:17:52] [config] transformer-dropout-ffn: 0
[2023-07-05 17:17:52] [config] transformer-ffn-activation: swish
[2023-07-05 17:17:52] [config] transformer-ffn-depth: 2
[2023-07-05 17:17:52] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:17:52] [config] transformer-heads: 8
[2023-07-05 17:17:52] [config] transformer-no-projection: false
[2023-07-05 17:17:52] [config] transformer-pool: false
[2023-07-05 17:17:52] [config] transformer-postprocess: dan
[2023-07-05 17:17:52] [config] transformer-postprocess-emb: d
[2023-07-05 17:17:52] [config] transformer-postprocess-top: ""
[2023-07-05 17:17:52] [config] transformer-preprocess: ""
[2023-07-05 17:17:52] [config] transformer-tied-layers:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] transformer-train-position-embeddings: false
[2023-07-05 17:17:52] [config] tsv: false
[2023-07-05 17:17:52] [config] tsv-fields: 0
[2023-07-05 17:17:52] [config] type: transformer
[2023-07-05 17:17:52] [config] ulr: false
[2023-07-05 17:17:52] [config] ulr-dim-emb: 0
[2023-07-05 17:17:52] [config] ulr-dropout: 0
[2023-07-05 17:17:52] [config] ulr-keys-vectors: ""
[2023-07-05 17:17:52] [config] ulr-query-vectors: ""
[2023-07-05 17:17:52] [config] ulr-softmax-temperature: 1
[2023-07-05 17:17:52] [config] ulr-trainable-transformation: false
[2023-07-05 17:17:52] [config] unlikelihood-loss: false
[2023-07-05 17:17:52] [config] valid-freq: 50000000
[2023-07-05 17:17:52] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:17:52] [config] valid-max-length: 1000
[2023-07-05 17:17:52] [config] valid-metrics:
[2023-07-05 17:17:52] [config]   - cross-entropy
[2023-07-05 17:17:52] [config]   - translation
[2023-07-05 17:17:52] [config] valid-mini-batch: 32
[2023-07-05 17:17:52] [config] valid-reset-stalled: false
[2023-07-05 17:17:52] [config] valid-script-args:
[2023-07-05 17:17:52] [config]   []
[2023-07-05 17:17:52] [config] valid-script-path: ""
[2023-07-05 17:17:52] [config] valid-sets:
[2023-07-05 17:17:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:17:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:17:52] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:17:52] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:52] [config] vocabs:
[2023-07-05 17:17:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:52] [config] word-penalty: 0
[2023-07-05 17:17:52] [config] word-scores: false
[2023-07-05 17:17:52] [config] workspace: 2048
[2023-07-05 17:17:52] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:52] [training] Using single-device training
[2023-07-05 17:17:53] Synced seed 1234
[2023-07-05 17:17:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:53] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:17:53] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:53] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:17:53] [valid] No post-processing script given for validating translator
[2023-07-05 17:17:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:54] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:17:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:17:54] [comm] Using global sharding
[2023-07-05 17:17:54] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:17:54] [training] Using 1 GPUs
[2023-07-05 17:17:54] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:55] Loading Adam parameters
[2023-07-05 17:17:56] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:17:56] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:17:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:17:56] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:17:56] [data] Shuffling data
[2023-07-05 17:17:56] [data] Done reading 20,192 sentences
[2023-07-05 17:17:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:17:56] Training started
[2023-07-05 17:17:56] Training finished
[2023-07-05 17:17:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:59] [marian] Running on node22.datos.cluster.uy as process 16380 with command line:
[2023-07-05 17:17:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:17:59] [config] after: 0e
[2023-07-05 17:17:59] [config] after-batches: 0
[2023-07-05 17:17:59] [config] after-epochs: 170
[2023-07-05 17:17:59] [config] all-caps-every: 0
[2023-07-05 17:17:59] [config] allow-unk: false
[2023-07-05 17:17:59] [config] authors: false
[2023-07-05 17:17:59] [config] beam-size: 12
[2023-07-05 17:17:59] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:17:59] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:17:59] [config] bert-masking-fraction: 0.15
[2023-07-05 17:17:59] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:17:59] [config] bert-train-type-embeddings: true
[2023-07-05 17:17:59] [config] bert-type-vocab-size: 2
[2023-07-05 17:17:59] [config] build-info: ""
[2023-07-05 17:17:59] [config] check-gradient-nan: false
[2023-07-05 17:17:59] [config] check-nan: false
[2023-07-05 17:17:59] [config] cite: false
[2023-07-05 17:17:59] [config] clip-norm: 1
[2023-07-05 17:17:59] [config] cost-scaling:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] cost-type: ce-sum
[2023-07-05 17:17:59] [config] cpu-threads: 0
[2023-07-05 17:17:59] [config] data-threads: 8
[2023-07-05 17:17:59] [config] data-weighting: ""
[2023-07-05 17:17:59] [config] data-weighting-type: sentence
[2023-07-05 17:17:59] [config] dec-cell: gru
[2023-07-05 17:17:59] [config] dec-cell-base-depth: 2
[2023-07-05 17:17:59] [config] dec-cell-high-depth: 1
[2023-07-05 17:17:59] [config] dec-depth: 1
[2023-07-05 17:17:59] [config] devices:
[2023-07-05 17:17:59] [config]   - 0
[2023-07-05 17:17:59] [config] dim-emb: 512
[2023-07-05 17:17:59] [config] dim-rnn: 1024
[2023-07-05 17:17:59] [config] dim-vocabs:
[2023-07-05 17:17:59] [config]   - 36507
[2023-07-05 17:17:59] [config]   - 54042
[2023-07-05 17:17:59] [config] disp-first: 0
[2023-07-05 17:17:59] [config] disp-freq: 1000u
[2023-07-05 17:17:59] [config] disp-label-counts: true
[2023-07-05 17:17:59] [config] dropout-rnn: 0
[2023-07-05 17:17:59] [config] dropout-src: 0
[2023-07-05 17:17:59] [config] dropout-trg: 0
[2023-07-05 17:17:59] [config] dump-config: ""
[2023-07-05 17:17:59] [config] dynamic-gradient-scaling:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] early-stopping: 10
[2023-07-05 17:17:59] [config] early-stopping-on: first
[2023-07-05 17:17:59] [config] embedding-fix-src: false
[2023-07-05 17:17:59] [config] embedding-fix-trg: false
[2023-07-05 17:17:59] [config] embedding-normalization: false
[2023-07-05 17:17:59] [config] embedding-vectors:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] enc-cell: gru
[2023-07-05 17:17:59] [config] enc-cell-depth: 1
[2023-07-05 17:17:59] [config] enc-depth: 1
[2023-07-05 17:17:59] [config] enc-type: bidirectional
[2023-07-05 17:17:59] [config] english-title-case-every: 0
[2023-07-05 17:17:59] [config] exponential-smoothing: 0
[2023-07-05 17:17:59] [config] factor-weight: 1
[2023-07-05 17:17:59] [config] factors-combine: sum
[2023-07-05 17:17:59] [config] factors-dim-emb: 0
[2023-07-05 17:17:59] [config] gradient-checkpointing: false
[2023-07-05 17:17:59] [config] gradient-norm-average-window: 100
[2023-07-05 17:17:59] [config] guided-alignment: none
[2023-07-05 17:17:59] [config] guided-alignment-cost: mse
[2023-07-05 17:17:59] [config] guided-alignment-weight: 0.1
[2023-07-05 17:17:59] [config] ignore-model-config: false
[2023-07-05 17:17:59] [config] input-types:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] interpolate-env-vars: false
[2023-07-05 17:17:59] [config] keep-best: false
[2023-07-05 17:17:59] [config] label-smoothing: 0
[2023-07-05 17:17:59] [config] layer-normalization: false
[2023-07-05 17:17:59] [config] learn-rate: 0.0001
[2023-07-05 17:17:59] [config] lemma-dependency: ""
[2023-07-05 17:17:59] [config] lemma-dim-emb: 0
[2023-07-05 17:17:59] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:17:59] [config] log-level: info
[2023-07-05 17:17:59] [config] log-time-zone: ""
[2023-07-05 17:17:59] [config] logical-epoch:
[2023-07-05 17:17:59] [config]   - 1e
[2023-07-05 17:17:59] [config]   - 0
[2023-07-05 17:17:59] [config] lr-decay: 0
[2023-07-05 17:17:59] [config] lr-decay-freq: 50000
[2023-07-05 17:17:59] [config] lr-decay-inv-sqrt:
[2023-07-05 17:17:59] [config]   - 0
[2023-07-05 17:17:59] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:17:59] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:17:59] [config] lr-decay-start:
[2023-07-05 17:17:59] [config]   - 10
[2023-07-05 17:17:59] [config]   - 1
[2023-07-05 17:17:59] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:17:59] [config] lr-report: false
[2023-07-05 17:17:59] [config] lr-warmup: 0
[2023-07-05 17:17:59] [config] lr-warmup-at-reload: false
[2023-07-05 17:17:59] [config] lr-warmup-cycle: false
[2023-07-05 17:17:59] [config] lr-warmup-start-rate: 0
[2023-07-05 17:17:59] [config] max-length: 50
[2023-07-05 17:17:59] [config] max-length-crop: false
[2023-07-05 17:17:59] [config] max-length-factor: 3
[2023-07-05 17:17:59] [config] maxi-batch: 100
[2023-07-05 17:17:59] [config] maxi-batch-sort: trg
[2023-07-05 17:17:59] [config] mini-batch: 64
[2023-07-05 17:17:59] [config] mini-batch-fit: false
[2023-07-05 17:17:59] [config] mini-batch-fit-step: 10
[2023-07-05 17:17:59] [config] mini-batch-round-up: true
[2023-07-05 17:17:59] [config] mini-batch-track-lr: false
[2023-07-05 17:17:59] [config] mini-batch-warmup: 0
[2023-07-05 17:17:59] [config] mini-batch-words: 0
[2023-07-05 17:17:59] [config] mini-batch-words-ref: 0
[2023-07-05 17:17:59] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:17:59] [config] multi-loss-type: sum
[2023-07-05 17:17:59] [config] n-best: false
[2023-07-05 17:17:59] [config] no-nccl: false
[2023-07-05 17:17:59] [config] no-reload: false
[2023-07-05 17:17:59] [config] no-restore-corpus: false
[2023-07-05 17:17:59] [config] normalize: 0
[2023-07-05 17:17:59] [config] normalize-gradient: false
[2023-07-05 17:17:59] [config] num-devices: 0
[2023-07-05 17:17:59] [config] optimizer: adam
[2023-07-05 17:17:59] [config] optimizer-delay: 1
[2023-07-05 17:17:59] [config] optimizer-params:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] output-omit-bias: false
[2023-07-05 17:17:59] [config] overwrite: true
[2023-07-05 17:17:59] [config] precision:
[2023-07-05 17:17:59] [config]   - float32
[2023-07-05 17:17:59] [config]   - float32
[2023-07-05 17:17:59] [config] pretrained-model: ""
[2023-07-05 17:17:59] [config] quantize-biases: false
[2023-07-05 17:17:59] [config] quantize-bits: 0
[2023-07-05 17:17:59] [config] quantize-log-based: false
[2023-07-05 17:17:59] [config] quantize-optimization-steps: 0
[2023-07-05 17:17:59] [config] quiet: false
[2023-07-05 17:17:59] [config] quiet-translation: true
[2023-07-05 17:17:59] [config] relative-paths: false
[2023-07-05 17:17:59] [config] right-left: false
[2023-07-05 17:17:59] [config] save-freq: 10000u
[2023-07-05 17:17:59] [config] seed: 1234
[2023-07-05 17:17:59] [config] sentencepiece-alphas:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:17:59] [config] sentencepiece-options: ""
[2023-07-05 17:17:59] [config] sharding: global
[2023-07-05 17:17:59] [config] shuffle: data
[2023-07-05 17:17:59] [config] shuffle-in-ram: false
[2023-07-05 17:17:59] [config] sigterm: save-and-exit
[2023-07-05 17:17:59] [config] skip: false
[2023-07-05 17:17:59] [config] sqlite: ""
[2023-07-05 17:17:59] [config] sqlite-drop: false
[2023-07-05 17:17:59] [config] sync-freq: 200u
[2023-07-05 17:17:59] [config] sync-sgd: false
[2023-07-05 17:17:59] [config] tempdir: /tmp
[2023-07-05 17:17:59] [config] tied-embeddings: false
[2023-07-05 17:17:59] [config] tied-embeddings-all: false
[2023-07-05 17:17:59] [config] tied-embeddings-src: false
[2023-07-05 17:17:59] [config] train-embedder-rank:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] train-sets:
[2023-07-05 17:17:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:17:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:17:59] [config] transformer-aan-activation: swish
[2023-07-05 17:17:59] [config] transformer-aan-depth: 2
[2023-07-05 17:17:59] [config] transformer-aan-nogate: false
[2023-07-05 17:17:59] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:17:59] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:17:59] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:17:59] [config] transformer-depth-scaling: false
[2023-07-05 17:17:59] [config] transformer-dim-aan: 2048
[2023-07-05 17:17:59] [config] transformer-dim-ffn: 2048
[2023-07-05 17:17:59] [config] transformer-dropout: 0
[2023-07-05 17:17:59] [config] transformer-dropout-attention: 0
[2023-07-05 17:17:59] [config] transformer-dropout-ffn: 0
[2023-07-05 17:17:59] [config] transformer-ffn-activation: swish
[2023-07-05 17:17:59] [config] transformer-ffn-depth: 2
[2023-07-05 17:17:59] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:17:59] [config] transformer-heads: 8
[2023-07-05 17:17:59] [config] transformer-no-projection: false
[2023-07-05 17:17:59] [config] transformer-pool: false
[2023-07-05 17:17:59] [config] transformer-postprocess: dan
[2023-07-05 17:17:59] [config] transformer-postprocess-emb: d
[2023-07-05 17:17:59] [config] transformer-postprocess-top: ""
[2023-07-05 17:17:59] [config] transformer-preprocess: ""
[2023-07-05 17:17:59] [config] transformer-tied-layers:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] transformer-train-position-embeddings: false
[2023-07-05 17:17:59] [config] tsv: false
[2023-07-05 17:17:59] [config] tsv-fields: 0
[2023-07-05 17:17:59] [config] type: transformer
[2023-07-05 17:17:59] [config] ulr: false
[2023-07-05 17:17:59] [config] ulr-dim-emb: 0
[2023-07-05 17:17:59] [config] ulr-dropout: 0
[2023-07-05 17:17:59] [config] ulr-keys-vectors: ""
[2023-07-05 17:17:59] [config] ulr-query-vectors: ""
[2023-07-05 17:17:59] [config] ulr-softmax-temperature: 1
[2023-07-05 17:17:59] [config] ulr-trainable-transformation: false
[2023-07-05 17:17:59] [config] unlikelihood-loss: false
[2023-07-05 17:17:59] [config] valid-freq: 50000000
[2023-07-05 17:17:59] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:17:59] [config] valid-max-length: 1000
[2023-07-05 17:17:59] [config] valid-metrics:
[2023-07-05 17:17:59] [config]   - cross-entropy
[2023-07-05 17:17:59] [config]   - translation
[2023-07-05 17:17:59] [config] valid-mini-batch: 32
[2023-07-05 17:17:59] [config] valid-reset-stalled: false
[2023-07-05 17:17:59] [config] valid-script-args:
[2023-07-05 17:17:59] [config]   []
[2023-07-05 17:17:59] [config] valid-script-path: ""
[2023-07-05 17:17:59] [config] valid-sets:
[2023-07-05 17:17:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:17:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:17:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:17:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:59] [config] vocabs:
[2023-07-05 17:17:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:17:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:17:59] [config] word-penalty: 0
[2023-07-05 17:17:59] [config] word-scores: false
[2023-07-05 17:17:59] [config] workspace: 2048
[2023-07-05 17:17:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:17:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:17:59] [training] Using single-device training
[2023-07-05 17:18:00] Synced seed 1234
[2023-07-05 17:18:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:18:00] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:18:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:18:00] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:18:00] [valid] No post-processing script given for validating translator
[2023-07-05 17:18:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:18:01] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:18:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:18:01] [comm] Using global sharding
[2023-07-05 17:18:01] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:18:01] [training] Using 1 GPUs
[2023-07-05 17:18:01] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:18:02] Loading Adam parameters
[2023-07-05 17:18:03] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:18:03] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:18:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:18:03] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:18:03] [data] Shuffling data
[2023-07-05 17:18:03] [data] Done reading 20,192 sentences
[2023-07-05 17:18:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:18:03] Training started
[2023-07-05 17:18:03] Training finished
[2023-07-05 17:18:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:06] [marian] Running on node22.datos.cluster.uy as process 16540 with command line:
[2023-07-05 17:18:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:18:06] [config] after: 0e
[2023-07-05 17:18:06] [config] after-batches: 0
[2023-07-05 17:18:06] [config] after-epochs: 180
[2023-07-05 17:18:06] [config] all-caps-every: 0
[2023-07-05 17:18:06] [config] allow-unk: false
[2023-07-05 17:18:06] [config] authors: false
[2023-07-05 17:18:06] [config] beam-size: 12
[2023-07-05 17:18:06] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:18:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:18:06] [config] bert-masking-fraction: 0.15
[2023-07-05 17:18:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:18:06] [config] bert-train-type-embeddings: true
[2023-07-05 17:18:06] [config] bert-type-vocab-size: 2
[2023-07-05 17:18:06] [config] build-info: ""
[2023-07-05 17:18:06] [config] check-gradient-nan: false
[2023-07-05 17:18:06] [config] check-nan: false
[2023-07-05 17:18:06] [config] cite: false
[2023-07-05 17:18:06] [config] clip-norm: 1
[2023-07-05 17:18:06] [config] cost-scaling:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] cost-type: ce-sum
[2023-07-05 17:18:06] [config] cpu-threads: 0
[2023-07-05 17:18:06] [config] data-threads: 8
[2023-07-05 17:18:06] [config] data-weighting: ""
[2023-07-05 17:18:06] [config] data-weighting-type: sentence
[2023-07-05 17:18:06] [config] dec-cell: gru
[2023-07-05 17:18:06] [config] dec-cell-base-depth: 2
[2023-07-05 17:18:06] [config] dec-cell-high-depth: 1
[2023-07-05 17:18:06] [config] dec-depth: 1
[2023-07-05 17:18:06] [config] devices:
[2023-07-05 17:18:06] [config]   - 0
[2023-07-05 17:18:06] [config] dim-emb: 512
[2023-07-05 17:18:06] [config] dim-rnn: 1024
[2023-07-05 17:18:06] [config] dim-vocabs:
[2023-07-05 17:18:06] [config]   - 36507
[2023-07-05 17:18:06] [config]   - 54042
[2023-07-05 17:18:06] [config] disp-first: 0
[2023-07-05 17:18:06] [config] disp-freq: 1000u
[2023-07-05 17:18:06] [config] disp-label-counts: true
[2023-07-05 17:18:06] [config] dropout-rnn: 0
[2023-07-05 17:18:06] [config] dropout-src: 0
[2023-07-05 17:18:06] [config] dropout-trg: 0
[2023-07-05 17:18:06] [config] dump-config: ""
[2023-07-05 17:18:06] [config] dynamic-gradient-scaling:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] early-stopping: 10
[2023-07-05 17:18:06] [config] early-stopping-on: first
[2023-07-05 17:18:06] [config] embedding-fix-src: false
[2023-07-05 17:18:06] [config] embedding-fix-trg: false
[2023-07-05 17:18:06] [config] embedding-normalization: false
[2023-07-05 17:18:06] [config] embedding-vectors:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] enc-cell: gru
[2023-07-05 17:18:06] [config] enc-cell-depth: 1
[2023-07-05 17:18:06] [config] enc-depth: 1
[2023-07-05 17:18:06] [config] enc-type: bidirectional
[2023-07-05 17:18:06] [config] english-title-case-every: 0
[2023-07-05 17:18:06] [config] exponential-smoothing: 0
[2023-07-05 17:18:06] [config] factor-weight: 1
[2023-07-05 17:18:06] [config] factors-combine: sum
[2023-07-05 17:18:06] [config] factors-dim-emb: 0
[2023-07-05 17:18:06] [config] gradient-checkpointing: false
[2023-07-05 17:18:06] [config] gradient-norm-average-window: 100
[2023-07-05 17:18:06] [config] guided-alignment: none
[2023-07-05 17:18:06] [config] guided-alignment-cost: mse
[2023-07-05 17:18:06] [config] guided-alignment-weight: 0.1
[2023-07-05 17:18:06] [config] ignore-model-config: false
[2023-07-05 17:18:06] [config] input-types:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] interpolate-env-vars: false
[2023-07-05 17:18:06] [config] keep-best: false
[2023-07-05 17:18:06] [config] label-smoothing: 0
[2023-07-05 17:18:06] [config] layer-normalization: false
[2023-07-05 17:18:06] [config] learn-rate: 0.0001
[2023-07-05 17:18:06] [config] lemma-dependency: ""
[2023-07-05 17:18:06] [config] lemma-dim-emb: 0
[2023-07-05 17:18:06] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:18:06] [config] log-level: info
[2023-07-05 17:18:06] [config] log-time-zone: ""
[2023-07-05 17:18:06] [config] logical-epoch:
[2023-07-05 17:18:06] [config]   - 1e
[2023-07-05 17:18:06] [config]   - 0
[2023-07-05 17:18:06] [config] lr-decay: 0
[2023-07-05 17:18:06] [config] lr-decay-freq: 50000
[2023-07-05 17:18:06] [config] lr-decay-inv-sqrt:
[2023-07-05 17:18:06] [config]   - 0
[2023-07-05 17:18:06] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:18:06] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:18:06] [config] lr-decay-start:
[2023-07-05 17:18:06] [config]   - 10
[2023-07-05 17:18:06] [config]   - 1
[2023-07-05 17:18:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:18:06] [config] lr-report: false
[2023-07-05 17:18:06] [config] lr-warmup: 0
[2023-07-05 17:18:06] [config] lr-warmup-at-reload: false
[2023-07-05 17:18:06] [config] lr-warmup-cycle: false
[2023-07-05 17:18:06] [config] lr-warmup-start-rate: 0
[2023-07-05 17:18:06] [config] max-length: 50
[2023-07-05 17:18:06] [config] max-length-crop: false
[2023-07-05 17:18:06] [config] max-length-factor: 3
[2023-07-05 17:18:06] [config] maxi-batch: 100
[2023-07-05 17:18:06] [config] maxi-batch-sort: trg
[2023-07-05 17:18:06] [config] mini-batch: 64
[2023-07-05 17:18:06] [config] mini-batch-fit: false
[2023-07-05 17:18:06] [config] mini-batch-fit-step: 10
[2023-07-05 17:18:06] [config] mini-batch-round-up: true
[2023-07-05 17:18:06] [config] mini-batch-track-lr: false
[2023-07-05 17:18:06] [config] mini-batch-warmup: 0
[2023-07-05 17:18:06] [config] mini-batch-words: 0
[2023-07-05 17:18:06] [config] mini-batch-words-ref: 0
[2023-07-05 17:18:06] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:18:06] [config] multi-loss-type: sum
[2023-07-05 17:18:06] [config] n-best: false
[2023-07-05 17:18:06] [config] no-nccl: false
[2023-07-05 17:18:06] [config] no-reload: false
[2023-07-05 17:18:06] [config] no-restore-corpus: false
[2023-07-05 17:18:06] [config] normalize: 0
[2023-07-05 17:18:06] [config] normalize-gradient: false
[2023-07-05 17:18:06] [config] num-devices: 0
[2023-07-05 17:18:06] [config] optimizer: adam
[2023-07-05 17:18:06] [config] optimizer-delay: 1
[2023-07-05 17:18:06] [config] optimizer-params:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] output-omit-bias: false
[2023-07-05 17:18:06] [config] overwrite: true
[2023-07-05 17:18:06] [config] precision:
[2023-07-05 17:18:06] [config]   - float32
[2023-07-05 17:18:06] [config]   - float32
[2023-07-05 17:18:06] [config] pretrained-model: ""
[2023-07-05 17:18:06] [config] quantize-biases: false
[2023-07-05 17:18:06] [config] quantize-bits: 0
[2023-07-05 17:18:06] [config] quantize-log-based: false
[2023-07-05 17:18:06] [config] quantize-optimization-steps: 0
[2023-07-05 17:18:06] [config] quiet: false
[2023-07-05 17:18:06] [config] quiet-translation: true
[2023-07-05 17:18:06] [config] relative-paths: false
[2023-07-05 17:18:06] [config] right-left: false
[2023-07-05 17:18:06] [config] save-freq: 10000u
[2023-07-05 17:18:06] [config] seed: 1234
[2023-07-05 17:18:06] [config] sentencepiece-alphas:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:18:06] [config] sentencepiece-options: ""
[2023-07-05 17:18:06] [config] sharding: global
[2023-07-05 17:18:06] [config] shuffle: data
[2023-07-05 17:18:06] [config] shuffle-in-ram: false
[2023-07-05 17:18:06] [config] sigterm: save-and-exit
[2023-07-05 17:18:06] [config] skip: false
[2023-07-05 17:18:06] [config] sqlite: ""
[2023-07-05 17:18:06] [config] sqlite-drop: false
[2023-07-05 17:18:06] [config] sync-freq: 200u
[2023-07-05 17:18:06] [config] sync-sgd: false
[2023-07-05 17:18:06] [config] tempdir: /tmp
[2023-07-05 17:18:06] [config] tied-embeddings: false
[2023-07-05 17:18:06] [config] tied-embeddings-all: false
[2023-07-05 17:18:06] [config] tied-embeddings-src: false
[2023-07-05 17:18:06] [config] train-embedder-rank:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] train-sets:
[2023-07-05 17:18:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:18:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:18:06] [config] transformer-aan-activation: swish
[2023-07-05 17:18:06] [config] transformer-aan-depth: 2
[2023-07-05 17:18:06] [config] transformer-aan-nogate: false
[2023-07-05 17:18:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:18:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:18:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:18:06] [config] transformer-depth-scaling: false
[2023-07-05 17:18:06] [config] transformer-dim-aan: 2048
[2023-07-05 17:18:06] [config] transformer-dim-ffn: 2048
[2023-07-05 17:18:06] [config] transformer-dropout: 0
[2023-07-05 17:18:06] [config] transformer-dropout-attention: 0
[2023-07-05 17:18:06] [config] transformer-dropout-ffn: 0
[2023-07-05 17:18:06] [config] transformer-ffn-activation: swish
[2023-07-05 17:18:06] [config] transformer-ffn-depth: 2
[2023-07-05 17:18:06] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:18:06] [config] transformer-heads: 8
[2023-07-05 17:18:06] [config] transformer-no-projection: false
[2023-07-05 17:18:06] [config] transformer-pool: false
[2023-07-05 17:18:06] [config] transformer-postprocess: dan
[2023-07-05 17:18:06] [config] transformer-postprocess-emb: d
[2023-07-05 17:18:06] [config] transformer-postprocess-top: ""
[2023-07-05 17:18:06] [config] transformer-preprocess: ""
[2023-07-05 17:18:06] [config] transformer-tied-layers:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] transformer-train-position-embeddings: false
[2023-07-05 17:18:06] [config] tsv: false
[2023-07-05 17:18:06] [config] tsv-fields: 0
[2023-07-05 17:18:06] [config] type: transformer
[2023-07-05 17:18:06] [config] ulr: false
[2023-07-05 17:18:06] [config] ulr-dim-emb: 0
[2023-07-05 17:18:06] [config] ulr-dropout: 0
[2023-07-05 17:18:06] [config] ulr-keys-vectors: ""
[2023-07-05 17:18:06] [config] ulr-query-vectors: ""
[2023-07-05 17:18:06] [config] ulr-softmax-temperature: 1
[2023-07-05 17:18:06] [config] ulr-trainable-transformation: false
[2023-07-05 17:18:06] [config] unlikelihood-loss: false
[2023-07-05 17:18:06] [config] valid-freq: 50000000
[2023-07-05 17:18:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:18:06] [config] valid-max-length: 1000
[2023-07-05 17:18:06] [config] valid-metrics:
[2023-07-05 17:18:06] [config]   - cross-entropy
[2023-07-05 17:18:06] [config]   - translation
[2023-07-05 17:18:06] [config] valid-mini-batch: 32
[2023-07-05 17:18:06] [config] valid-reset-stalled: false
[2023-07-05 17:18:06] [config] valid-script-args:
[2023-07-05 17:18:06] [config]   []
[2023-07-05 17:18:06] [config] valid-script-path: ""
[2023-07-05 17:18:06] [config] valid-sets:
[2023-07-05 17:18:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:18:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:18:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:18:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:06] [config] vocabs:
[2023-07-05 17:18:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:18:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:18:06] [config] word-penalty: 0
[2023-07-05 17:18:06] [config] word-scores: false
[2023-07-05 17:18:06] [config] workspace: 2048
[2023-07-05 17:18:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:18:06] [training] Using single-device training
[2023-07-05 17:18:06] Synced seed 1234
[2023-07-05 17:18:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:18:06] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:18:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:18:06] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:18:06] [valid] No post-processing script given for validating translator
[2023-07-05 17:18:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:18:07] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:18:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:18:07] [comm] Using global sharding
[2023-07-05 17:18:07] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:18:07] [training] Using 1 GPUs
[2023-07-05 17:18:07] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:18:08] Loading Adam parameters
[2023-07-05 17:18:09] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:18:09] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:18:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:18:09] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:18:09] [data] Shuffling data
[2023-07-05 17:18:09] [data] Done reading 20,192 sentences
[2023-07-05 17:18:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:18:09] Training started
[2023-07-05 17:18:09] Training finished
[2023-07-05 17:18:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:12] [marian] Running on node22.datos.cluster.uy as process 16677 with command line:
[2023-07-05 17:18:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:18:12] [config] after: 0e
[2023-07-05 17:18:12] [config] after-batches: 0
[2023-07-05 17:18:12] [config] after-epochs: 190
[2023-07-05 17:18:12] [config] all-caps-every: 0
[2023-07-05 17:18:12] [config] allow-unk: false
[2023-07-05 17:18:12] [config] authors: false
[2023-07-05 17:18:12] [config] beam-size: 12
[2023-07-05 17:18:12] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:18:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:18:12] [config] bert-masking-fraction: 0.15
[2023-07-05 17:18:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:18:12] [config] bert-train-type-embeddings: true
[2023-07-05 17:18:12] [config] bert-type-vocab-size: 2
[2023-07-05 17:18:12] [config] build-info: ""
[2023-07-05 17:18:12] [config] check-gradient-nan: false
[2023-07-05 17:18:12] [config] check-nan: false
[2023-07-05 17:18:12] [config] cite: false
[2023-07-05 17:18:12] [config] clip-norm: 1
[2023-07-05 17:18:12] [config] cost-scaling:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] cost-type: ce-sum
[2023-07-05 17:18:12] [config] cpu-threads: 0
[2023-07-05 17:18:12] [config] data-threads: 8
[2023-07-05 17:18:12] [config] data-weighting: ""
[2023-07-05 17:18:12] [config] data-weighting-type: sentence
[2023-07-05 17:18:12] [config] dec-cell: gru
[2023-07-05 17:18:12] [config] dec-cell-base-depth: 2
[2023-07-05 17:18:12] [config] dec-cell-high-depth: 1
[2023-07-05 17:18:12] [config] dec-depth: 1
[2023-07-05 17:18:12] [config] devices:
[2023-07-05 17:18:12] [config]   - 0
[2023-07-05 17:18:12] [config] dim-emb: 512
[2023-07-05 17:18:12] [config] dim-rnn: 1024
[2023-07-05 17:18:12] [config] dim-vocabs:
[2023-07-05 17:18:12] [config]   - 36507
[2023-07-05 17:18:12] [config]   - 54042
[2023-07-05 17:18:12] [config] disp-first: 0
[2023-07-05 17:18:12] [config] disp-freq: 1000u
[2023-07-05 17:18:12] [config] disp-label-counts: true
[2023-07-05 17:18:12] [config] dropout-rnn: 0
[2023-07-05 17:18:12] [config] dropout-src: 0
[2023-07-05 17:18:12] [config] dropout-trg: 0
[2023-07-05 17:18:12] [config] dump-config: ""
[2023-07-05 17:18:12] [config] dynamic-gradient-scaling:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] early-stopping: 10
[2023-07-05 17:18:12] [config] early-stopping-on: first
[2023-07-05 17:18:12] [config] embedding-fix-src: false
[2023-07-05 17:18:12] [config] embedding-fix-trg: false
[2023-07-05 17:18:12] [config] embedding-normalization: false
[2023-07-05 17:18:12] [config] embedding-vectors:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] enc-cell: gru
[2023-07-05 17:18:12] [config] enc-cell-depth: 1
[2023-07-05 17:18:12] [config] enc-depth: 1
[2023-07-05 17:18:12] [config] enc-type: bidirectional
[2023-07-05 17:18:12] [config] english-title-case-every: 0
[2023-07-05 17:18:12] [config] exponential-smoothing: 0
[2023-07-05 17:18:12] [config] factor-weight: 1
[2023-07-05 17:18:12] [config] factors-combine: sum
[2023-07-05 17:18:12] [config] factors-dim-emb: 0
[2023-07-05 17:18:12] [config] gradient-checkpointing: false
[2023-07-05 17:18:12] [config] gradient-norm-average-window: 100
[2023-07-05 17:18:12] [config] guided-alignment: none
[2023-07-05 17:18:12] [config] guided-alignment-cost: mse
[2023-07-05 17:18:12] [config] guided-alignment-weight: 0.1
[2023-07-05 17:18:12] [config] ignore-model-config: false
[2023-07-05 17:18:12] [config] input-types:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] interpolate-env-vars: false
[2023-07-05 17:18:12] [config] keep-best: false
[2023-07-05 17:18:12] [config] label-smoothing: 0
[2023-07-05 17:18:12] [config] layer-normalization: false
[2023-07-05 17:18:12] [config] learn-rate: 0.0001
[2023-07-05 17:18:12] [config] lemma-dependency: ""
[2023-07-05 17:18:12] [config] lemma-dim-emb: 0
[2023-07-05 17:18:12] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:18:12] [config] log-level: info
[2023-07-05 17:18:12] [config] log-time-zone: ""
[2023-07-05 17:18:12] [config] logical-epoch:
[2023-07-05 17:18:12] [config]   - 1e
[2023-07-05 17:18:12] [config]   - 0
[2023-07-05 17:18:12] [config] lr-decay: 0
[2023-07-05 17:18:12] [config] lr-decay-freq: 50000
[2023-07-05 17:18:12] [config] lr-decay-inv-sqrt:
[2023-07-05 17:18:12] [config]   - 0
[2023-07-05 17:18:12] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:18:12] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:18:12] [config] lr-decay-start:
[2023-07-05 17:18:12] [config]   - 10
[2023-07-05 17:18:12] [config]   - 1
[2023-07-05 17:18:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:18:12] [config] lr-report: false
[2023-07-05 17:18:12] [config] lr-warmup: 0
[2023-07-05 17:18:12] [config] lr-warmup-at-reload: false
[2023-07-05 17:18:12] [config] lr-warmup-cycle: false
[2023-07-05 17:18:12] [config] lr-warmup-start-rate: 0
[2023-07-05 17:18:12] [config] max-length: 50
[2023-07-05 17:18:12] [config] max-length-crop: false
[2023-07-05 17:18:12] [config] max-length-factor: 3
[2023-07-05 17:18:12] [config] maxi-batch: 100
[2023-07-05 17:18:12] [config] maxi-batch-sort: trg
[2023-07-05 17:18:12] [config] mini-batch: 64
[2023-07-05 17:18:12] [config] mini-batch-fit: false
[2023-07-05 17:18:12] [config] mini-batch-fit-step: 10
[2023-07-05 17:18:12] [config] mini-batch-round-up: true
[2023-07-05 17:18:12] [config] mini-batch-track-lr: false
[2023-07-05 17:18:12] [config] mini-batch-warmup: 0
[2023-07-05 17:18:12] [config] mini-batch-words: 0
[2023-07-05 17:18:12] [config] mini-batch-words-ref: 0
[2023-07-05 17:18:12] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:18:12] [config] multi-loss-type: sum
[2023-07-05 17:18:12] [config] n-best: false
[2023-07-05 17:18:12] [config] no-nccl: false
[2023-07-05 17:18:12] [config] no-reload: false
[2023-07-05 17:18:12] [config] no-restore-corpus: false
[2023-07-05 17:18:12] [config] normalize: 0
[2023-07-05 17:18:12] [config] normalize-gradient: false
[2023-07-05 17:18:12] [config] num-devices: 0
[2023-07-05 17:18:12] [config] optimizer: adam
[2023-07-05 17:18:12] [config] optimizer-delay: 1
[2023-07-05 17:18:12] [config] optimizer-params:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] output-omit-bias: false
[2023-07-05 17:18:12] [config] overwrite: true
[2023-07-05 17:18:12] [config] precision:
[2023-07-05 17:18:12] [config]   - float32
[2023-07-05 17:18:12] [config]   - float32
[2023-07-05 17:18:12] [config] pretrained-model: ""
[2023-07-05 17:18:12] [config] quantize-biases: false
[2023-07-05 17:18:12] [config] quantize-bits: 0
[2023-07-05 17:18:12] [config] quantize-log-based: false
[2023-07-05 17:18:12] [config] quantize-optimization-steps: 0
[2023-07-05 17:18:12] [config] quiet: false
[2023-07-05 17:18:12] [config] quiet-translation: true
[2023-07-05 17:18:12] [config] relative-paths: false
[2023-07-05 17:18:12] [config] right-left: false
[2023-07-05 17:18:12] [config] save-freq: 10000u
[2023-07-05 17:18:12] [config] seed: 1234
[2023-07-05 17:18:12] [config] sentencepiece-alphas:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:18:12] [config] sentencepiece-options: ""
[2023-07-05 17:18:12] [config] sharding: global
[2023-07-05 17:18:12] [config] shuffle: data
[2023-07-05 17:18:12] [config] shuffle-in-ram: false
[2023-07-05 17:18:12] [config] sigterm: save-and-exit
[2023-07-05 17:18:12] [config] skip: false
[2023-07-05 17:18:12] [config] sqlite: ""
[2023-07-05 17:18:12] [config] sqlite-drop: false
[2023-07-05 17:18:12] [config] sync-freq: 200u
[2023-07-05 17:18:12] [config] sync-sgd: false
[2023-07-05 17:18:12] [config] tempdir: /tmp
[2023-07-05 17:18:12] [config] tied-embeddings: false
[2023-07-05 17:18:12] [config] tied-embeddings-all: false
[2023-07-05 17:18:12] [config] tied-embeddings-src: false
[2023-07-05 17:18:12] [config] train-embedder-rank:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] train-sets:
[2023-07-05 17:18:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:18:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:18:12] [config] transformer-aan-activation: swish
[2023-07-05 17:18:12] [config] transformer-aan-depth: 2
[2023-07-05 17:18:12] [config] transformer-aan-nogate: false
[2023-07-05 17:18:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:18:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:18:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:18:12] [config] transformer-depth-scaling: false
[2023-07-05 17:18:12] [config] transformer-dim-aan: 2048
[2023-07-05 17:18:12] [config] transformer-dim-ffn: 2048
[2023-07-05 17:18:12] [config] transformer-dropout: 0
[2023-07-05 17:18:12] [config] transformer-dropout-attention: 0
[2023-07-05 17:18:12] [config] transformer-dropout-ffn: 0
[2023-07-05 17:18:12] [config] transformer-ffn-activation: swish
[2023-07-05 17:18:12] [config] transformer-ffn-depth: 2
[2023-07-05 17:18:12] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:18:12] [config] transformer-heads: 8
[2023-07-05 17:18:12] [config] transformer-no-projection: false
[2023-07-05 17:18:12] [config] transformer-pool: false
[2023-07-05 17:18:12] [config] transformer-postprocess: dan
[2023-07-05 17:18:12] [config] transformer-postprocess-emb: d
[2023-07-05 17:18:12] [config] transformer-postprocess-top: ""
[2023-07-05 17:18:12] [config] transformer-preprocess: ""
[2023-07-05 17:18:12] [config] transformer-tied-layers:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] transformer-train-position-embeddings: false
[2023-07-05 17:18:12] [config] tsv: false
[2023-07-05 17:18:12] [config] tsv-fields: 0
[2023-07-05 17:18:12] [config] type: transformer
[2023-07-05 17:18:12] [config] ulr: false
[2023-07-05 17:18:12] [config] ulr-dim-emb: 0
[2023-07-05 17:18:12] [config] ulr-dropout: 0
[2023-07-05 17:18:12] [config] ulr-keys-vectors: ""
[2023-07-05 17:18:12] [config] ulr-query-vectors: ""
[2023-07-05 17:18:12] [config] ulr-softmax-temperature: 1
[2023-07-05 17:18:12] [config] ulr-trainable-transformation: false
[2023-07-05 17:18:12] [config] unlikelihood-loss: false
[2023-07-05 17:18:12] [config] valid-freq: 50000000
[2023-07-05 17:18:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:18:12] [config] valid-max-length: 1000
[2023-07-05 17:18:12] [config] valid-metrics:
[2023-07-05 17:18:12] [config]   - cross-entropy
[2023-07-05 17:18:12] [config]   - translation
[2023-07-05 17:18:12] [config] valid-mini-batch: 32
[2023-07-05 17:18:12] [config] valid-reset-stalled: false
[2023-07-05 17:18:12] [config] valid-script-args:
[2023-07-05 17:18:12] [config]   []
[2023-07-05 17:18:12] [config] valid-script-path: ""
[2023-07-05 17:18:12] [config] valid-sets:
[2023-07-05 17:18:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:18:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:18:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:18:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:12] [config] vocabs:
[2023-07-05 17:18:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:18:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:18:12] [config] word-penalty: 0
[2023-07-05 17:18:12] [config] word-scores: false
[2023-07-05 17:18:12] [config] workspace: 2048
[2023-07-05 17:18:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:18:12] [training] Using single-device training
[2023-07-05 17:18:12] Synced seed 1234
[2023-07-05 17:18:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:18:12] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:18:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:18:12] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:18:13] [valid] No post-processing script given for validating translator
[2023-07-05 17:18:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:18:13] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:18:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:18:13] [comm] Using global sharding
[2023-07-05 17:18:13] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:18:13] [training] Using 1 GPUs
[2023-07-05 17:18:13] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:18:15] Loading Adam parameters
[2023-07-05 17:18:15] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:18:15] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:18:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:18:15] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:18:15] [data] Shuffling data
[2023-07-05 17:18:15] [data] Done reading 20,192 sentences
[2023-07-05 17:18:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:18:15] Training started
[2023-07-05 17:18:15] Training finished
[2023-07-05 17:18:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:18] [marian] Running on node22.datos.cluster.uy as process 16820 with command line:
[2023-07-05 17:18:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --type transformer
[2023-07-05 17:18:18] [config] after: 0e
[2023-07-05 17:18:18] [config] after-batches: 0
[2023-07-05 17:18:18] [config] after-epochs: 200
[2023-07-05 17:18:18] [config] all-caps-every: 0
[2023-07-05 17:18:18] [config] allow-unk: false
[2023-07-05 17:18:18] [config] authors: false
[2023-07-05 17:18:18] [config] beam-size: 12
[2023-07-05 17:18:18] [config] bert-class-symbol: "[CLS]"
[2023-07-05 17:18:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-05 17:18:18] [config] bert-masking-fraction: 0.15
[2023-07-05 17:18:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-05 17:18:18] [config] bert-train-type-embeddings: true
[2023-07-05 17:18:18] [config] bert-type-vocab-size: 2
[2023-07-05 17:18:18] [config] build-info: ""
[2023-07-05 17:18:18] [config] check-gradient-nan: false
[2023-07-05 17:18:18] [config] check-nan: false
[2023-07-05 17:18:18] [config] cite: false
[2023-07-05 17:18:18] [config] clip-norm: 1
[2023-07-05 17:18:18] [config] cost-scaling:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] cost-type: ce-sum
[2023-07-05 17:18:18] [config] cpu-threads: 0
[2023-07-05 17:18:18] [config] data-threads: 8
[2023-07-05 17:18:18] [config] data-weighting: ""
[2023-07-05 17:18:18] [config] data-weighting-type: sentence
[2023-07-05 17:18:18] [config] dec-cell: gru
[2023-07-05 17:18:18] [config] dec-cell-base-depth: 2
[2023-07-05 17:18:18] [config] dec-cell-high-depth: 1
[2023-07-05 17:18:18] [config] dec-depth: 1
[2023-07-05 17:18:18] [config] devices:
[2023-07-05 17:18:18] [config]   - 0
[2023-07-05 17:18:18] [config] dim-emb: 512
[2023-07-05 17:18:18] [config] dim-rnn: 1024
[2023-07-05 17:18:18] [config] dim-vocabs:
[2023-07-05 17:18:18] [config]   - 36507
[2023-07-05 17:18:18] [config]   - 54042
[2023-07-05 17:18:18] [config] disp-first: 0
[2023-07-05 17:18:18] [config] disp-freq: 1000u
[2023-07-05 17:18:18] [config] disp-label-counts: true
[2023-07-05 17:18:18] [config] dropout-rnn: 0
[2023-07-05 17:18:18] [config] dropout-src: 0
[2023-07-05 17:18:18] [config] dropout-trg: 0
[2023-07-05 17:18:18] [config] dump-config: ""
[2023-07-05 17:18:18] [config] dynamic-gradient-scaling:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] early-stopping: 10
[2023-07-05 17:18:18] [config] early-stopping-on: first
[2023-07-05 17:18:18] [config] embedding-fix-src: false
[2023-07-05 17:18:18] [config] embedding-fix-trg: false
[2023-07-05 17:18:18] [config] embedding-normalization: false
[2023-07-05 17:18:18] [config] embedding-vectors:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] enc-cell: gru
[2023-07-05 17:18:18] [config] enc-cell-depth: 1
[2023-07-05 17:18:18] [config] enc-depth: 1
[2023-07-05 17:18:18] [config] enc-type: bidirectional
[2023-07-05 17:18:18] [config] english-title-case-every: 0
[2023-07-05 17:18:18] [config] exponential-smoothing: 0
[2023-07-05 17:18:18] [config] factor-weight: 1
[2023-07-05 17:18:18] [config] factors-combine: sum
[2023-07-05 17:18:18] [config] factors-dim-emb: 0
[2023-07-05 17:18:18] [config] gradient-checkpointing: false
[2023-07-05 17:18:18] [config] gradient-norm-average-window: 100
[2023-07-05 17:18:18] [config] guided-alignment: none
[2023-07-05 17:18:18] [config] guided-alignment-cost: mse
[2023-07-05 17:18:18] [config] guided-alignment-weight: 0.1
[2023-07-05 17:18:18] [config] ignore-model-config: false
[2023-07-05 17:18:18] [config] input-types:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] interpolate-env-vars: false
[2023-07-05 17:18:18] [config] keep-best: false
[2023-07-05 17:18:18] [config] label-smoothing: 0
[2023-07-05 17:18:18] [config] layer-normalization: false
[2023-07-05 17:18:18] [config] learn-rate: 0.0001
[2023-07-05 17:18:18] [config] lemma-dependency: ""
[2023-07-05 17:18:18] [config] lemma-dim-emb: 0
[2023-07-05 17:18:18] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_july.log
[2023-07-05 17:18:18] [config] log-level: info
[2023-07-05 17:18:18] [config] log-time-zone: ""
[2023-07-05 17:18:18] [config] logical-epoch:
[2023-07-05 17:18:18] [config]   - 1e
[2023-07-05 17:18:18] [config]   - 0
[2023-07-05 17:18:18] [config] lr-decay: 0
[2023-07-05 17:18:18] [config] lr-decay-freq: 50000
[2023-07-05 17:18:18] [config] lr-decay-inv-sqrt:
[2023-07-05 17:18:18] [config]   - 0
[2023-07-05 17:18:18] [config] lr-decay-repeat-warmup: false
[2023-07-05 17:18:18] [config] lr-decay-reset-optimizer: false
[2023-07-05 17:18:18] [config] lr-decay-start:
[2023-07-05 17:18:18] [config]   - 10
[2023-07-05 17:18:18] [config]   - 1
[2023-07-05 17:18:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-05 17:18:18] [config] lr-report: false
[2023-07-05 17:18:18] [config] lr-warmup: 0
[2023-07-05 17:18:18] [config] lr-warmup-at-reload: false
[2023-07-05 17:18:18] [config] lr-warmup-cycle: false
[2023-07-05 17:18:18] [config] lr-warmup-start-rate: 0
[2023-07-05 17:18:18] [config] max-length: 50
[2023-07-05 17:18:18] [config] max-length-crop: false
[2023-07-05 17:18:18] [config] max-length-factor: 3
[2023-07-05 17:18:18] [config] maxi-batch: 100
[2023-07-05 17:18:18] [config] maxi-batch-sort: trg
[2023-07-05 17:18:18] [config] mini-batch: 64
[2023-07-05 17:18:18] [config] mini-batch-fit: false
[2023-07-05 17:18:18] [config] mini-batch-fit-step: 10
[2023-07-05 17:18:18] [config] mini-batch-round-up: true
[2023-07-05 17:18:18] [config] mini-batch-track-lr: false
[2023-07-05 17:18:18] [config] mini-batch-warmup: 0
[2023-07-05 17:18:18] [config] mini-batch-words: 0
[2023-07-05 17:18:18] [config] mini-batch-words-ref: 0
[2023-07-05 17:18:18] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:18:18] [config] multi-loss-type: sum
[2023-07-05 17:18:18] [config] n-best: false
[2023-07-05 17:18:18] [config] no-nccl: false
[2023-07-05 17:18:18] [config] no-reload: false
[2023-07-05 17:18:18] [config] no-restore-corpus: false
[2023-07-05 17:18:18] [config] normalize: 0
[2023-07-05 17:18:18] [config] normalize-gradient: false
[2023-07-05 17:18:18] [config] num-devices: 0
[2023-07-05 17:18:18] [config] optimizer: adam
[2023-07-05 17:18:18] [config] optimizer-delay: 1
[2023-07-05 17:18:18] [config] optimizer-params:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] output-omit-bias: false
[2023-07-05 17:18:18] [config] overwrite: true
[2023-07-05 17:18:18] [config] precision:
[2023-07-05 17:18:18] [config]   - float32
[2023-07-05 17:18:18] [config]   - float32
[2023-07-05 17:18:18] [config] pretrained-model: ""
[2023-07-05 17:18:18] [config] quantize-biases: false
[2023-07-05 17:18:18] [config] quantize-bits: 0
[2023-07-05 17:18:18] [config] quantize-log-based: false
[2023-07-05 17:18:18] [config] quantize-optimization-steps: 0
[2023-07-05 17:18:18] [config] quiet: false
[2023-07-05 17:18:18] [config] quiet-translation: true
[2023-07-05 17:18:18] [config] relative-paths: false
[2023-07-05 17:18:18] [config] right-left: false
[2023-07-05 17:18:18] [config] save-freq: 10000u
[2023-07-05 17:18:18] [config] seed: 1234
[2023-07-05 17:18:18] [config] sentencepiece-alphas:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] sentencepiece-max-lines: 2000000
[2023-07-05 17:18:18] [config] sentencepiece-options: ""
[2023-07-05 17:18:18] [config] sharding: global
[2023-07-05 17:18:18] [config] shuffle: data
[2023-07-05 17:18:18] [config] shuffle-in-ram: false
[2023-07-05 17:18:18] [config] sigterm: save-and-exit
[2023-07-05 17:18:18] [config] skip: false
[2023-07-05 17:18:18] [config] sqlite: ""
[2023-07-05 17:18:18] [config] sqlite-drop: false
[2023-07-05 17:18:18] [config] sync-freq: 200u
[2023-07-05 17:18:18] [config] sync-sgd: false
[2023-07-05 17:18:18] [config] tempdir: /tmp
[2023-07-05 17:18:18] [config] tied-embeddings: false
[2023-07-05 17:18:18] [config] tied-embeddings-all: false
[2023-07-05 17:18:18] [config] tied-embeddings-src: false
[2023-07-05 17:18:18] [config] train-embedder-rank:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] train-sets:
[2023-07-05 17:18:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-05 17:18:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-05 17:18:18] [config] transformer-aan-activation: swish
[2023-07-05 17:18:18] [config] transformer-aan-depth: 2
[2023-07-05 17:18:18] [config] transformer-aan-nogate: false
[2023-07-05 17:18:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-05 17:18:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-05 17:18:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-05 17:18:18] [config] transformer-depth-scaling: false
[2023-07-05 17:18:18] [config] transformer-dim-aan: 2048
[2023-07-05 17:18:18] [config] transformer-dim-ffn: 2048
[2023-07-05 17:18:18] [config] transformer-dropout: 0
[2023-07-05 17:18:18] [config] transformer-dropout-attention: 0
[2023-07-05 17:18:18] [config] transformer-dropout-ffn: 0
[2023-07-05 17:18:18] [config] transformer-ffn-activation: swish
[2023-07-05 17:18:18] [config] transformer-ffn-depth: 2
[2023-07-05 17:18:18] [config] transformer-guided-alignment-layer: last
[2023-07-05 17:18:18] [config] transformer-heads: 8
[2023-07-05 17:18:18] [config] transformer-no-projection: false
[2023-07-05 17:18:18] [config] transformer-pool: false
[2023-07-05 17:18:18] [config] transformer-postprocess: dan
[2023-07-05 17:18:18] [config] transformer-postprocess-emb: d
[2023-07-05 17:18:18] [config] transformer-postprocess-top: ""
[2023-07-05 17:18:18] [config] transformer-preprocess: ""
[2023-07-05 17:18:18] [config] transformer-tied-layers:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] transformer-train-position-embeddings: false
[2023-07-05 17:18:18] [config] tsv: false
[2023-07-05 17:18:18] [config] tsv-fields: 0
[2023-07-05 17:18:18] [config] type: transformer
[2023-07-05 17:18:18] [config] ulr: false
[2023-07-05 17:18:18] [config] ulr-dim-emb: 0
[2023-07-05 17:18:18] [config] ulr-dropout: 0
[2023-07-05 17:18:18] [config] ulr-keys-vectors: ""
[2023-07-05 17:18:18] [config] ulr-query-vectors: ""
[2023-07-05 17:18:18] [config] ulr-softmax-temperature: 1
[2023-07-05 17:18:18] [config] ulr-trainable-transformation: false
[2023-07-05 17:18:18] [config] unlikelihood-loss: false
[2023-07-05 17:18:18] [config] valid-freq: 50000000
[2023-07-05 17:18:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_july.log
[2023-07-05 17:18:18] [config] valid-max-length: 1000
[2023-07-05 17:18:18] [config] valid-metrics:
[2023-07-05 17:18:18] [config]   - cross-entropy
[2023-07-05 17:18:18] [config]   - translation
[2023-07-05 17:18:18] [config] valid-mini-batch: 32
[2023-07-05 17:18:18] [config] valid-reset-stalled: false
[2023-07-05 17:18:18] [config] valid-script-args:
[2023-07-05 17:18:18] [config]   []
[2023-07-05 17:18:18] [config] valid-script-path: ""
[2023-07-05 17:18:18] [config] valid-sets:
[2023-07-05 17:18:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-05 17:18:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-05 17:18:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-05 17:18:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:18] [config] vocabs:
[2023-07-05 17:18:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:18:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:18:18] [config] word-penalty: 0
[2023-07-05 17:18:18] [config] word-scores: false
[2023-07-05 17:18:18] [config] workspace: 2048
[2023-07-05 17:18:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-05 17:18:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:18:18] [training] Using single-device training
[2023-07-05 17:18:19] Synced seed 1234
[2023-07-05 17:18:19] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-05 17:18:19] [data] Setting vocabulary size for input 0 to 36,507
[2023-07-05 17:18:19] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-05 17:18:19] [data] Setting vocabulary size for input 1 to 54,042
[2023-07-05 17:18:19] [valid] No post-processing script given for validating translator
[2023-07-05 17:18:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-05 17:18:20] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-05 17:18:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-05 17:18:20] [comm] Using global sharding
[2023-07-05 17:18:20] [comm] NCCLCommunicators constructed successfully
[2023-07-05 17:18:20] [training] Using 1 GPUs
[2023-07-05 17:18:20] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz
[2023-07-05 17:18:21] Loading Adam parameters
[2023-07-05 17:18:21] [memory] Reserving 621 MB, device gpu0
[2023-07-05 17:18:21] [memory] Reserving 310 MB, device gpu0
[2023-07-05 17:18:22] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_july/es_gn_test_grid_july_type_transformer.npz.optimizer.npz
[2023-07-05 17:18:22] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-07-05 17:18:22] [data] Shuffling data
[2023-07-05 17:18:22] [data] Done reading 20,192 sentences
[2023-07-05 17:18:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-05 17:18:22] Training started
[2023-07-05 17:18:22] Training finished
